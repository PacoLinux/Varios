VERSION E05

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:1    
        1        1        /*M* ASA$SUPER MAIN ROUTINE FOR SUPER.                  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        /*   ASA$SUPER : Main routine for super consists of procedures:
       11       11                         ASA$SUPER
       12       12                         ASA$ERROR
       13       13                         ASA$KEYCONV
       14       14                                                                          */
       15       15        ASA$SUPER: PROC MAIN ;
       16       16                                                              /**/
       17       17        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:2    
       18       18        /********************************************************************/
       19       19        /*   Include files   include files   include files   include files   */
       20       20        /*********************************************************************/
       21       21                                                              /**/
       22       22        %INCLUDE           AS_ENTRIES_M ;
       23     1072        %INCLUDE           AS_MAC_C     ;
       24     1152        %INCLUDE           AS_SUPER_C   ;
       25     1587        %INCLUDE           XU_MACRO_C   ;
       26     4693        %INCLUDE           XU_FORMAT_C  ;
       27     4855        %INCLUDE           KL_SUPER_C   ;
       28     7757        %INCLUDE           AS_SUBS_C    ;
       29     9171        %INCLUDE           AS_PERR_C    ;
       30     9773        %INCLUDE           B_MACROS_C   ;
       31     9884        %INCLUDE           B_ERRORS_C   ;
       32    11011        %INCLUDE           CP_6         ;
       33    11092        %INCLUDE           CP_6_SUBS    ;
       34    11632        %INCLUDE           JG_GHOSTS_C  ;
       35    11722        %INCLUDE           AS_SUPER_R   ;
       36    14738 S      %INCLUDE            B$JIT_C    ;
       37    14739             %B$JIT0 ;
       38    14828             %U$JIT1 ;
       39    14902             %M$JIT2 ;
       40    14912             %F$JIT3 ;
       41    14917             %S$JIT4 ;
       42    14923             %J$JIT5 ;
       43    15011             %A$JIT6 ;
       44    15021                                                              /**/
       45    15022        %SET LISTSUB = '1'B ;
       46    15023        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:3    
       47    15024        /********************************************************************/
       48    15025        /*   Dcbs            dcbs            dcbs            dcbs            */
       49    15026        /*********************************************************************/
       50    15027        /********************************************************************/
       51    15028        /*   Static data     static data     static data     static data     */
       52    15029        /*********************************************************************/
       53    15030                                                              /**/
       54    15031    1   DCL MORE BIT(1) STATIC ;
       55    15032    1   DCL SIZEC_DREC UBIN CONSTANT INIT( SIZEC(KL_DREC_CNT) );
       56    15033    1   DCL HLP$ PTR STATIC INIT( ADDR(KL_DREC) );
       57    15034    1   DCL 1 ASH_FCG CONSTANT ,
       58    15035    1          2 FCG_MID UBIN(18) INIT(5320) UNAL ;     /*  'ASH' in sixbit  */
       59    15036        %FPT_EXIT( STEPCC=OK );
       60    15051
       61    15052        %FPT_PRIV (PPRIV=YES);
       62    15067
       63    15068        %XUG_GETCMD ( FPT=OPEN_LO_FPT,
       64    15069                      DCB_PARAM = M$LO);
       65    15407
       66    15408        %FPT_OPEN (FPTN = OPEN_LO_FPT,
       67    15409                   DCB = M$LO);
       68    15518
       69    15519                                                              /**/
       70    15520        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:4    
       71    15521        /********************************************************************/
       72    15522        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       73    15523        /*********************************************************************/
       74    15524                                                              /**/
       75    15525    1   DCL X$PARSE ENTRY(1) ALTRET ;
       76    15526        %ASA$B_USERS_HLP ;
       77    15529        %ASB$SET_PROMPT ;
       78    15532        %ASA$CONSOLE ;
       79    15535        %ASA$TERMINAL ;
       80    15538        %ASA$STATION ;
       81    15541        %ASA$DEVICE ;
       82    15544        %ASA$PROJECT ;
       83    15547        %ASA$KEYCONV ;
       84    15550        %ASA$UNTIE_USER ;
       85    15553        %ASA$UNTIE_PROJECT ;
       86    15556        %ASA$TIE_USER ;
       87    15559        %ASA$TIE_PROJECT ;
       88    15562        %ASA$ERROR ;
       89    15565        %ASA$LINK_VIRCIR ;
       90    15568        %ASA$LINE_CONTROLLER ;
       91    15571        %ASB$ACCT_OK ;
       92    15574        %ASB$BREAK ;
       93    15577        %ASB$CLOSE_HLP ;
       94    15580        %ASB$CLOSE_LO ;
       95    15583        %ASB$CLOSE_PROJ ;
       96    15586        %ASB$CLOSE_USERS ;
       97    15589        %ASB$DELREC_PROJ ;
       98    15592        %ASB$DELREC_USERS ;
       99    15595        %ASB$DEQ ;
      100    15598        %ASB$DEQ_HLP ;
      101    15601        %ASB$DEQ_PROJ ;
      102    15604        %ASB$ENQ ;
      103    15607        %ASB$ENQ_HLP ;
      104    15610        %ASB$ENQ_PROJ ;
      105    15613        %ASB$ENQ_USERS ;
      106    15616        %ASB$FIND_NUM ;
      107    15619        %ASB$FLUSH ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:5    
      108    15622        %ASB$FREE_SEG ;
      109    15625        %ASB$GET ;
      110    15628        %ASB$GET_MGRANS ;
      111    15631        %ASB$GET_NEXT ;
      112    15634        %ASB$GETSEG ;
      113    15637        %ASB$INIT_GET_NEXT ;
      114    15640        %ASB$KEYMAKER ;
      115    15643        %ASB$LIST ;
      116    15646        %ASB$OPEN_COMGROUP ;
      117    15649        %ASB$OPEN_HLP_UP ;
      118    15652        %ASB$OPEN_PROJ_CR ;
      119    15655        %ASB$OPEN_PROJ_UP ;
      120    15658        %ASB$OPEN_SI_LO_DO ;
      121    15661        %ASB$OPEN_USERS_UP ;
      122    15664        %ASB$PIG ;
      123    15667        %ASB$PREC_PROJ ;
      124    15670        %ASB$READ_HLP ;
      125    15673        %ASB$READ_PROJ ;
      126    15676        %ASB$READ_PROJ_SEQ ;
      127    15679        %ASB$READ_SI ;
      128    15682        %ASB$READ_USERS ;
      129    15685        %ASB$WRITE_HLP ;
      130    15688        %ASB$WRITE_LO ;
      131    15691        %ASB$WRITE_PROJ ;
      132    15694        %ASB$WRITE_USERS ;
      133    15697        %ASB$WRITE_USERS_KEY ;
      134    15700        %ASC$BUILD_CHARSET ;
      135    15703        %ASC$CHARSET ;
      136    15706        %ASC$CHECK_TIGR_WSN ;
      137    15709        %ASC$CM_OPTS ;
      138    15712        %ASC$CONFIG ;
      139    15715        %ASC$MOD_USER ;
      140    15718        %ASD$CLOSE_PRO ;
      141    15721        %ASD$CREATE_PRO ;
      142    15724        %ASD$OPEN_PRO_UP ;
      143    15727        %ASD$PROFILE ;
      144    15730        %ASD$READ_PRO ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:6    
      145    15733        %ASF$BUILD_FORM ;
      146    15736        %ASF$FORM ;
      147    15739        %ASF$OPEN_FORM_CR ;
      148    15742        %ASF$OPEN_FORM_UP ;
      149    15745        %ASH$DQUEST ;
      150    15748        %ASH$ERROR ;
      151    15751        %ASH$HELP ;
      152    15754        %ASH$INFO ;
      153    15757        %ASH$QUEST ;
      154    15760        %ASH$U_PARSE ;
      155    15763        %ASH$WARN ;
      156    15766        %ASL$LIST ;
      157    15769        %ASR$D_CHARSET_RECS ;
      158    15772        %ASR$D_FORM_RECS ;
      159    15775        %ASR$D_USERS_RECS ;
      160    15778        %ASR$R_DEVICE ;
      161    15781        %ASR$R_CHARSET ;
      162    15784        %ASR$R_CONSOLE ;
      163    15787        %ASR$R_FORM ;
      164    15790        %ASR$R_LINE_CONT ;
      165    15793        %ASR$R_LINK_VIRCIR ;
      166    15796        %ASR$R_PROFILE ;
      167    15799        %ASR$R_PROJECT ;
      168    15802        %ASR$R_STAT_TIGR ;
      169    15805        %ASR$R_STATION ;
      170    15808        %ASR$R_TERMINAL ;
      171    15811        %ASR$R_TPDEVICE ;
      172    15814        %ASR$R_USER ;
      173    15817        %ASR$R_WSN ;
      174    15820        %ASW$WSN ;
      175    15823        %ASW$BUILD_WSN ;
      176    15826        %ASW$OPEN_WSN_UP ;
      177    15829        %ASZ$SCRAMBLE ;
      178    15832    1   DCL XUG$INIT ENTRY(2) ALTRET;
      179    15833    1   DCL XUG$OPENOUT ENTRY(1) ALTRET;
      180    15834        %FPT_INT(FPTN=INTFPT,
      181    15835                   UENTRY=ASB$BREAK);
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:7    
      182    15849                                                              /**/
      183    15850        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:8    
      184    15851        /********************************************************************/
      185    15852        /*   Auto data       auto data       auto data       auto data       */
      186    15853        /*********************************************************************/
      187    15854                                                              /**/
      188    15855    1   DCL ARS SBIN ;
      189    15856    1   DCL ERR_SEV UBIN ;
      190    15857    1   DCL SUBNODES UBIN ;
      191    15858    1   DCL P$ PTR ;
      192    15859    1   DCL BLK$ PTR ;
      193    15860    1   DCL STR$TEXT CHAR(20) BASED ALIGNED ;
      194    15861    1   DCL NO_EXISTS BIT(1) ;
      195    15862    1   DCL 1 ERR_BUF ALIGNED ,
      196    15863    1          2 CNT UBIN(9) UNAL ,
      197    15864    1          2 TEXT CHAR(40) UNAL ;
      198    15865    1   DCL I UBIN ;
      199    15866    1   DCL TEMP_PRIV(0:2) BIT(36) ;
      200    15867    1   DCL DCB$ PTR ;
      201    15868    1   DCL PTR$ PTR ;
      202    15869    1   DCL CNT UBIN WORD ;
      203    15870    1   DCL CERR_CNT CHAR(4) ;
      204    15871    1   DCL 1 VARY$STR BASED UNAL ,
      205    15872    1          2 TXT CHAR(CNT) UNAL ;
      206    15873    1   DCL 1 T_ERR_CODE ,
      207    15874    1          2 FCG UBIN(18) UNAL ,
      208    15875    1          2 CODE UBIN(15) UNAL ,
      209    15876    1          2 SEV UBIN(3) UNAL ;
      210    15877    1   DCL DELETE_FLAG BIT (1);
      211    15878    1   DCL DELETE_PROMPT CHAR (29);
      212    15879    1   DCL FREE_SEG_SIZE UBIN;
      213    15880    1   DCL FREE_SEG_TYPE UBIN;
      214    15881                                                              /**/
      215    15882        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:9    
      216    15883        /********************************************************************/
      217    15884        /*   Local based     local based     local based     local based     */
      218    15885        /*********************************************************************/
      219    15886                                                              /**/
      220    15887        %LIST ;
      221    15888        %SUPER_TO_PIG( STCLASS="BASED(AS_SUPER_TO_PIG$)" );
             15889    1   DCL 1 SUPER_TO_PIG BASED(AS_SUPER_TO_PIG$) ALIGNED ,
             15890    1          2 TYPE UBIN BYTE UNAL ,       /* Type of transaction */
             15891        %IF '1'B='1'B;
             15892        %EQU CREATE_ACCT   = 0;              /* Create an account       */
             15893        %EQU MODIFY_ACCT   = 1;              /* Modify an account       */
             15894        %EQU LIST_ACCT     = 2;              /* List an account         */
             15895        %EQU VALIDATE_ATTR = 3;              /* Validate attribute list */
             15896        %EQU DELETE_ACCT   = 4;              /* Delete an account       */
             15897        %ENDIF;
             15898    1          2 PROJ BIT(1) UNAL,           /* '1'b => project administrator
             15899                                                '0'b => system  adminstrator */
             15900    1          2 WIDTH UBIN(8) UNAL ,       /* Width of output line */
             15901    1          2 SUPER,                      /* Project or system administrator  */
             15902    1             3 ACCT CHAR(8) UNAL ,      /* who is using super. */
             15903    1             3 UNAME CHAR(12) UNAL ,
             15904    1          2 RESUPER REDEF SUPER CHAR(20) ,
             15905    1          2 PROJECT,                    /* Name of project */
             15906    1             3 ACCT CHAR(8) UNAL,
             15907    1             3 UNAME CHAR(12) UNAL,
             15908    1          2 PROJECT_TEXT REDEF PROJECT CHAR(20),
             15909    1          2 PACKSET CHAR(6) UNAL ,      /* Packset name */
             15910    1          2 ACCT CHAR(8) UNAL ,         /* File management account */
             15911    1          2 ATTR,
             15912    1             3 COUNT UBIN HALF UNAL ,   /* Length of attribute list */
             15913        %LSET STR=CONCAT(TEXTCHAR(BASED(AS_SUPER_TO_PIG$)),'     ');
             15914        %IF (((SUBSTR(STR,0,5)='BASED') OR SUBSTR(STR,0,1)=' ') AND '1'B='1'B);
             15915    1             3 LIST CHAR(SUPER_TO_PIG.ATTR.COUNT);/* Attribute list */
             15916        %ELSE;
             15918        %ENDIF;
      222    15920            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      223    15921                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:10   
             15922        /*F*  NAME:     PARSE$OUT
             15923              FUNCTION: a structure built by X$PARSE which corresponds to a "list",
             15924                  "alternative", "reducing alternative", or "koncat" node in
             15925                  the user's parse tree.
             15926        */
             15927    1   DCL 1 P$NODE BASED(NODE$) ALIGNED,
             15928    1         2 TEMP BIT(1) UNAL,
             15929    1         2 * BIT (11) UNAL,
             15930    1         2 TYPE UBIN (6) UNAL,
             15931        /*K* NDTYPE - specifies the type of parse node to which this PARSE$OUT
             15932                  block corresponds.  See the XU_SUBS_C file for the
             15933                  %EQU symbols whose values may appear in this field.
             15934        */
             15935    1         2 CODE UBIN HALF HALIGNED,
             15936        /*K* CODE - Contains the numeric "node code" specified by the user when
             15937                  the corresponding parse-node was defined.
             15938        */
             15939    1         2 SUBNODES UBIN HALF HALIGNED,
             15940        /*K* NSUBLKS - "number of sub-blocks".  This field contains the count of
             15941                  pointers actually available in the PARSE$OUT.SUBLK$ array.
             15942        */
             15943    1         2 SCRITCH UBIN HALF HALIGNED,
             15944        /*K* SCRITCH - an 18-bit scratch field reserved for the user.  X$PARSE
             15945                  initializes this field to zero when the PARSE$OUT structure
             15946                  is allocated, and never sets or examines it thereafter.
             15947                  The name of this field may be changed when the PARSE$OUT macro
             15948                  is invoked by the user (say "SCRITCH=yourname"), and its data
             15949                  type may also be changed (say "SCRMODE=pl6datatype" and
             15950                  "SCRALGN=alignment").  BEWARE: this field MUST be 18-bits long,
             15951                  and be UNALIGNED, CALIGNED, or HALIGNED.
             15952        */
             15953    1         2 CPOS UBIN WORD,
             15954        /*K* CPOS - "character position" of this block.  This field will contain
             15955                  a character index (starting at 0) into the original parse
             15956                  string;  the index identifies the first character of the
             15957                  string which was accepted by this node (or by any of its
             15958                  sub-nodes).
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:11   
             15959        */
             15960    1         2 SUBLK$(0:0) PTR UNAL;
             15961        /*K* SUBLK$ - an array of PL-6 PTRs.  The number of elements in this array
             15962                  is found in OUT$BLK.NSUBLKS;  each PTR will point to another
             15963                  OUT$BLK structure, or to an OUT$SYM structure.
             15964        */
      224    15966              %PARSE$SYM( NAME = OUT$SYM ,
      225    15967                          STCLASS="BASED(BLK$)") ;
             15968        /*F*  NAME:     PARSE$SYM
             15969              FUNCTION: holds "parse symbols".  Structures of this form are created
             15970                  by X$PARSE to hold those portions of the string being parsed
             15971                  which must be returned to the user - quoted strings, decimal
             15972                  or octal numbers, PL-6 identifiers, etc.
             15973        */
             15974    1   DCL 1 OUT$SYM BASED(BLK$) ALIGNED,
             15975    1         2 TEMP BIT(1) UNAL,
             15976    1         2 * BIT (11) UNAL,
             15977    1         2 NDTYPE UBIN (6) UNAL,
             15978        /*K* NDTYPE - see OUT$BLK.NDTYPE for details.
             15979        */
             15980    1         2 CODE UBIN HALF HALIGNED,
             15981        /*K* CODE - see OUT$BLK.CODE for details.
             15982        */
             15983    1         2 NSUBLKS UBIN HALF HALIGNED,
             15984        /*K* NSUBLKS - always contains the value 1.
             15985        */
             15986    1         2 SCRITCH UBIN HALF HALIGNED,
             15987        /*K* SCRITCH - see OUT$BLK.SCRITCH for details.
             15988        */
             15989    1         2 CPOS UBIN WORD,
             15990        /*K* CPOS - see OUT$BLK.CPOS for details.
             15991        */
             15992    1         2 TEXTC$ PTR,
             15993        /*K* TEXTC$ - a pointer to a TEXTC-type string (a 1-byte count field
             15994                  followed by a variable number of characters).  Always
             15995                  points to OUT$SYM.COUNT in the current OUT$SYM block.
             15996        */
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:12   
             15997    1         2 COUNT UBIN BYTE CALIGNED,
             15998        /*K* COUNT - contains the number of characters in OUT$SYM.TEXT.
             15999        */
             16000    1         2 TEXT CHAR(OUT$SYM.COUNT) CALIGNED;
             16001        /*K* TEXT - contains the text of a string, decimal number, PL-6
             16002                  identifier, or some other parser "symbol".
             16003        */
      226    16005        %PLIST ;
      227    16006              %F$DCB( DCBN = F$DCB ) ;
      228    16063    1   DCL UBIN$WORD UBIN BASED;
      229    16064                                                              /**/
      230    16065        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:13   
      231    16066        /********************************************************************/
      232    16067        /*   Procedure       procedure       procedure       procedure       */
      233    16068        /*********************************************************************/
      234    16069                                                              /**/
      235    16070        /*
      236    16071            ***            Begin procedure                    ***
      237    16072        */
      238    16073    1   CALL M$INT(INTFPT);    /*  Est brk control   */
      239    16074    1   CALL ASB$OPEN_SI_LO_DO;
      240    16075    1   CALL CONCAT( AS_LOGON_KEY.TEXT, B$JIT.ACCN, B$JIT.UNAME );
      241    16076    1   CALL INDEX( I, ' ', B$JIT.UNAME );
      242    16077    1   AS_LOGON_KEY.CNT = 8 + I;
      243    16078    1   T_ERR_CODE = '0'B;
      244    16079                                                            /* Check for super ppriv. */
      245    16080    1   FPT_PRIV.V.PRIV# = %PPR_SUPER#;
      246    16081    2   CALL M$SPRIV (FPT_PRIV) WHENRETURN DO;
      247    16082    2      SUPERAUTH = AS_TRUE ;
      248    16083    2      SUPERWSN  = AS_TRUE ;
      249    16084    2      SUPERFORM = AS_TRUE ;
      250    16085    2      FPT_PRIV.V.PRIV# = %PPR_PADMIN#;
      251    16086    3      CALL M$SPRIV (FPT_PRIV) WHENRETURN DO; /* if padmin mode is set */
      252    16087    3         PADMIN = AS_TRUE;
      253    16088    3         END;
      254    16089    2      END;
      255    16090    2   WHENALTRETURN DO; /* From the superall check */
      256    16091                                                   /* Check for superauth ppriv. */
      257    16092    2      FPT_PRIV.V.PRIV# = %PPR_SUPERAUTH#;
      258    16093    3      CALL M$SPRIV (FPT_PRIV) WHENRETURN DO; SUPERAUTH = AS_TRUE; END;
      259    16094                                                  /* Check for superwsn ppriv. */
      260    16095    2      FPT_PRIV.V.PRIV# = %PPR_SUPERWSN#;
      261    16096    3      CALL M$SPRIV (FPT_PRIV) WHENRETURN DO; SUPERWSN = AS_TRUE; END;
      262    16097                                                  /* Check for superform ppriv. */
      263    16098    2      FPT_PRIV.V.PRIV# = %PPR_SUPERFORM#;
      264    16099    3      CALL M$SPRIV (FPT_PRIV) WHENRETURN DO; SUPERFORM = AS_TRUE; END;
      265    16100                                                 /* Check for superd ppriv. */
      266    16101    2      FPT_PRIV.V.PRIV# = %PPR_SUPERD#;
      267    16102    3      CALL M$SPRIV (FPT_PRIV) WHENRETURN DO; SUPERD = AS_TRUE; END;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:14   
      268    16103                                                 /* Check for padmin ppriv. */
      269    16104    2      FPT_PRIV.V.PRIV# = %PPR_PADMIN#;
      270    16105    3      CALL M$SPRIV (FPT_PRIV) WHENRETURN DO; PADMIN = AS_TRUE; END;
      271    16106    2      END;
      272    16107    1   IF NOT SUPERAUTH  AND  NOT SUPERWSN  AND  NOT SUPERFORM  AND  NOT PADMIN  AND  NOT
             16107            SUPERD
      273    16108    2   THEN DO;
      274    16109        /*E*  ERROR:    ASA-E$NOSUPERPRIV-C
      275    16110              MESSAGE0: You do not have the privilege needed to run SUPER.
      276    16111
      277    16112        */
      278    16113           %SCREAM( ERR#=E$NOSUPERPRIV, LEVEL=ERROR, MID='A' );
      279    16128    2      GOTO EXIT_SUPER ;
      280    16129    2      END ; /* Then do */
      281    16130                                                              /*  Check to see if
      282    16131                                                                   :USERS, :HLP, and
      283    16132                                                                   :PRO exist.  */
      284    16133    1   IS_USERS_THERE: ;
      285    16134    1   CALL ASB$OPEN_USERS_UP ALTRET( IS_HLP_THERE ) ;
      286    16135                                                              /*  :USERS exists
      287    16136                                                                   :HLP better.  */
      288    16137    1   CALL ASB$OPEN_HLP_UP ALTRET( USERS_HLP_ERR ) ;
      289    16138                                                              /*  Both exist.  */
      290    16139    1   GOTO IS_PRO_THERE ;
      291    16140                                                              /*  :USERS doesn't
      292    16141                                                                  :HLP better not.  */
      293    16142    1   IS_HLP_THERE: ;
      294    16143    1   IF MERR_CODE.CODE ~= %E$NOFILE
      295    16144    2   THEN DO;
      296    16145    2      CALL ASH$ERROR( ERR_CODE ) ;
      297    16146    2      GOTO EXIT_SUPER ;
      298    16147    2      END ; /* Then do */
      299    16148    1   CALL ASB$OPEN_HLP_UP ALTRET( BUILD_USERS_HLP ) ;
      300    16149                                                              /*   ERROR:
      301    16150                                                                   :USERS doesn't
      302    16151                                                                   :HLP does.  */
      303    16152        /*E*  ERROR:    ASA-E$USER_FILE_INCONSISTENT-C
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:15   
      304    16153              MESSAGE:  User file inconsistency.
      305    16154              MESSAGE1: :USERS does not exist, but :HLP does.
      306    16155              MESSAGE2: User records may exist in :HLP that do not exist
      307    16156                        in :USERS.  Use the D[ELETE] U[SERS] command to
      308    16157                        remove all users records in :HLP.
      309    16158        */
      310    16159        %SCREAM( ERR#=E$USER_FILE_INCONSISTENT, LEVEL=WARN, MID='A' );
      311    16174    1   T_ERR_CODE = ERR_CODE ;
      312    16175    1   GOTO IS_PRO_THERE ;
      313    16176                                                              /*   ERROR:
      314    16177                                                                   :USERS does
      315    16178                                                                   :HLP doesn't.  */
      316    16179    1   USERS_HLP_ERR: ;
      317    16180    1   IF MERR_CODE.CODE ~= %E$NOFILE
      318    16181    2   THEN DO;
      319    16182    2      CALL ASH$ERROR( ERR_CODE ) ;
      320    16183    2      GOTO OUTPUT_ERROR_CNT ;
      321    16184    2      END ; /* Then do */
      322    16185        /*E*  ERROR:    ASA-E$HLP_FILE_INCONSISTENT-C
      323    16186              MESSAGE:  User file inconsistency.
      324    16187              MESSAGE1: :USERS does exist, but :HLP does not.
      325    16188              MESSAGE2: User records may exist in :USERS that do not
      326    16189                        exist in :HLP. Use the D[ELETE] U[SERS] command
      327    16190                        to remove all users records in :HLP.
      328    16191        */
      329    16192        %SCREAM( ERR#=E$HLP_FILE_INCONSISTENT, LEVEL=WARN, MID='A' );
      330    16207    1   T_ERR_CODE = ERR_CODE ;
      331    16208    1   GOTO IS_PRO_THERE ;
      332    16209                                                              /*   Both don't exist.  */
      333    16210    1   BUILD_USERS_HLP: ;
      334    16211    1   CALL ASA$B_USERS_HLP ;
      335    16212                                                              /**/
      336    16213    1   IS_PRO_THERE: ;
      337    16214    1   CALL ASD$OPEN_PRO_UP
      338    16215    2   WHENALTRETURN DO;
      339    16216                                                              /**/
      340    16217    2      CALL ASD$CREATE_PRO ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:16   
      341    16218    2      END ; /* Whenaltreturn do */
      342    16219    1   IS_FORM_THERE: ;
      343    16220    1   CALL ASF$OPEN_FORM_UP
      344    16221    2   WHENALTRETURN DO;
      345    16222    2      CALL ASF$OPEN_FORM_CR
      346    16223    3      WHENALTRETURN DO;
      347    16224    3         END;
      348    16225    2      CALL ASC$BUILD_CHARSET ;
      349    16226    2      CALL ASF$BUILD_FORM ;
      350    16227    2      END ; /* Whenaltreturn do */
      351    16228    1   IS_WSN_THERE: ;
      352    16229    1   CALL ASW$OPEN_WSN_UP
      353    16230    2   WHENALTRETURN DO;
      354    16231    2      CALL ASW$BUILD_WSN ;
      355    16232    2      CALL ASW$OPEN_WSN_UP;
      356    16233    2      END ; /* Whenaltreturn do */
      357    16234    1   IS_PROJ_THERE:
      358    16235    1   CALL ASB$OPEN_PROJ_UP
      359    16236    2   WHENALTRETURN DO;
      360    16237    2      CALL ASB$OPEN_PROJ_CR;
      361    16238    2      CALL ASB$CLOSE_PROJ;
      362    16239    2      END;  /*  Whenaltreturn  */
      363    16240    1   ALL_FILES_EXIST: ;
      364    16241                                                              /*  Set P_PCB.  */
      365    16242    1   P_PCB.U$$ = ENTADDR( ASH$U_PARSE ) ;
      366    16243                                                              /*  Check to see if
      367    16244                                                                   this is system ghost.  */
      368    16245    1   IF B$JIT.MODE = %M_GHOST# AND B$JIT.USER = 14/*JG_SUPER#   */
      369    16246    2   THEN DO;
      370    16247    2      CALL ASC$CONFIG () WHENALTRETURN
      371    16248    3      DO;
      372    16249                /*E*  ERROR:  ASA-E$CONFIG_FAIL-C
      373    16250                      MESSAGE: ALRETURN from configuration routine. Please check
      374    16251                               that the station and WSN you just specified got
      375    16252                               rebuilt! If not notify your system manager.
      376    16253                 */
      377    16254              %SCREAM (ERR# = E$CONFIG_FAIL, LEVEL=ERROR, MID='A');
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:17   
      378    16269    3         RETURN;
      379    16270    3         END; /* Whenaltreturn */
      380    16271    2      CALL M$EXIT ;
      381    16272    2      END ; /* Then do */
      382    16273                                                              /*  All files exist.
      383    16274                                                                   Close them.  */
      384    16275                                                              /*  Open files update.  */
      385    16276    1   CALL ASB$OPEN_USERS_UP ;
      386    16277    1   CALL ASB$OPEN_HLP_UP ;
      387    16278    1   CALL ASD$OPEN_PRO_UP ;
      388    16279    1   CALL ASB$OPEN_PROJ_UP;
      389    16280    1   CALL ASB$OPEN_COMGROUP;
      390    16281    1   BLANK_PASS = ' ';
      391    16282    1   CALL ASZ$SCRAMBLE(BLANK_PASS);  /* To have a blank scrambled password */
      392    16283                                                /* handy for checking for unspecified */
      393    16284                                                /* passwords */
      394    16285    1   MORE = AS_TRUE ;
      395    16286                                                              /*   Output super header.  */
      396    16287    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );
      397    16288    1   CALL CONCAT(OUT_BUF,'*** CP-6 SUPER ',SUBSTR(B_VERSION.TEXT,0,B_VERSION.COUNT),
             16288            ' ***' );
      398    16289    1   CALL ASB$WRITE_LO( OUT_BUF, LENGTHC(OUT_BUF) );
      399    16290    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );
      400    16291    1   IF PADMIN
      401    16292    1   THEN CALL MAKEME( 2 /* MAKEME SYS */ );
      402    16293    1   ELSE AS_PROJECT_ADMIN = AS_NONE ;
      403    16294    1   ERR_CODE = T_ERR_CODE ;
      404    16295                                                              /**/
      405    16296    1   CMD_LOOP: ;
      406    16297    1   ASA_BRKS_LOC_BIT = '0'B;         /* Clear break control
      407    16298                                             list will reset it     */
      408    16299    1   P_PCB.ROOT$ = ADDR( CMD_NODES ) ;
      409    16300    1   ENQDEQ_FLG = AS_FALSE ;
      410    16301                                                              /**/
      411    16302    2   DO WHILE (MORE) ;
      412    16303    2      IF ENQDEQ_FLG
      413    16304    3      THEN DO;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:18   
      414    16305    3         CALL ASB$DEQ ALTRET( DEQ_ERR ) ;
      415    16306    3   DEQ_ERR: ;
      416    16307    3         ENQDEQ_FLG = AS_FALSE ;
      417    16308    3         END ;        /* Then do */
      418    16309    2      REMEMBER CMD_LOOP IN REMEM_VAR ;
      419    16310                                                              /* Set prompt */
      420    16311    2      CALL ASB$SET_PROMPT ( %PROMPT_CMD ) ;
      421    16312    2      CALL ASB$READ_SI(IN_BUF, ARS) ;
      422    16313    2      P_PCB.NCHARS = ARS ;
      423    16314    2      CALL X$PARSE(P_PCB) ALTRET (SUPER_ERR) ;
      424    16315                                                              /**/
      425    16316    2      NODE$ = P_PCB.OUT$ ;
      426    16317                                                              /**/
      427    16318    2      CODE = P$NODE.CODE ;
      428    16319                                                        /* Is the appropriate ppriv. set. */
      429    16320    3      DO SELECT(CODE) ;
      430    16321    3         SELECT (%OUTPUT_VAL);
      431    16322    3         CALL ASB$CLOSE_LO;
      432    16323    3         XUG_GETCMD.UTIL$ = P_PCB.OUT$;
      433    16324    3         CALL XUG$OPENOUT (XUG_GETCMD);
      434    16325    3         GOTO CMD_LOOP;
      435    16326    3         SELECT( 27   /*  CR_MOD_ACCT_VAL */, 43 /* R_USER */,
      436    16327    3              67 /* TIE_USER_VAL */, 65 /* UNTIE_USER_VAL */,
      437    16328    3              69 /* MOD_USER_TO_PROJ_VAL */ );
      438    16329    3         IF NOT SUPERAUTH  AND  NOT PADMIN
      439    16330    4         THEN DO;
      440    16331        /*E*  ERROR:    ASA-E$NOTSUPERAUTH_PADMIN-C
      441    16332              MESSAGE0: You do not have SUPERAUTH or PADMIN pprivilege.
      442    16333        */
      443    16334                 %SCREAM( ERR#=E$NOTSUPERAUTH_PADMIN, LEVEL=ERROR, MID='A' );
      444    16349    4            GOTO CMD_LOOP ;
      445    16350    4            END;    /* Then do */
      446    16351    3         ELSE IF PADMIN AND SUPERD AND (NOT SUPERAUTH)
      447    16352    3                 AND (AS_PROJECT_ADMIN = AS_NONE)
      448    16353    4            THEN DO;
      449    16354        /*E*  ERROR:    ASA-E$NOTSUPERAUTH-C
      450    16355              MESSAGE0: You do not have SUPERAUTH pprivilege.
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:19   
      451    16356        */
      452    16357                    %SCREAM( ERR#=E$NOTSUPERAUTH, LEVEL=ERROR, MID='A' );
      453    16372    4               GOTO CMD_LOOP;
      454    16373    4               END; /* else do */
      455    16374
      456    16375    3         SELECT( 37 /* D_USERS_VAL */ );
      457    16376    3         IF NOT SUPERAUTH
      458    16377    4         THEN DO;
      459    16378                 %SCREAM( ERR#=E$NOTSUPERAUTH, LEVEL=ERROR, MID='A' );
      460    16393    4            GOTO CMD_LOOP ;
      461    16394    4            END ; /* Then do */
      462    16395
      463    16396    3         SELECT( 52 /* CR_MOD_PROJ_VAL */, 50 /* R_PROJ */,
      464    16397    3              68 /* TIE_PROJ_VAL */, 66 /* UNTIE_PROJ_VAL */,
      465    16398    3              70 /* MOD_PROJ_TO_USER_VAL */ );
      466    16399    3         IF NOT PADMIN  AND  NOT SUPERAUTH
      467    16400    4         THEN DO;
      468    16401                 %SCREAM( ERR#=E$NOTSUPERAUTH_PADMIN, LEVEL=ERROR, MID='A' );
      469    16416    4            GOTO CMD_LOOP;
      470    16417    4            END;
      471    16418    3         ELSE IF PADMIN AND SUPERD AND (NOT SUPERAUTH)
      472    16419    3                 AND (AS_PROJECT_ADMIN = AS_NONE)
      473    16420    4            THEN DO;
      474    16421                    %SCREAM( ERR#=E$NOTSUPERAUTH, LEVEL=ERROR, MID='A' );
      475    16436    4               GOTO CMD_LOOP;
      476    16437    4               END; /* else do */
      477    16438    3         SELECT( 40 /* R_TERM */,
      478    16439    3              44 /* REMOVE STATION */,
      479    16440    3              41 /* R_CON */,
      480    16441    3              48 /* REMOVE DEV */,
      481    16442    3              74 /* R_TPDEV_VAL */,
      482    16443    3              47 /* REMOVE WSN */,
      483    16444    3              42 /* R_PRO */,
      484    16445    3              34 /* CR_MOD_PRO_VAL */,
      485    16446    3              36 /* CR_MOD_TERM */,
      486    16447    3              45 /* CREATE STATION */,
      487    16448    3              35 /* CR_MOD_CON_VAL */,
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:20   
      488    16449    3              46 /* CR_MOD_DEV_VAL */,
      489    16450    3              55 /* CR_MOD_VIR_CIR_VAL */,
      490    16451    3              56 /* R_VIR_CIR */,
      491    16452    3              57 /* CR_MOD_LINE_VAL */,
      492    16453    3              58 /* CR_MOD_CONT_VAL */,
      493    16454    3              61 /* CR_MOD_LINE_DEV_VAL */,
      494    16455    3              59 /* R_LINE_VAL */,
      495    16456    3              60 /* R_CONT_VAL */,
      496    16457    3              62 /* R_LINE_DEV_VAL */,
      497    16458    3              63 /* CR_MOD_LINK_VAL */,
      498    16459    3              64 /* R_LINK_VAL */,
      499    16460    3              38 /* CR_MOD_WSN */ ) ;
      500    16461    3         IF NOT SUPERWSN
      501    16462    4         THEN DO;
      502    16463        /*E*  ERROR:    ASA-E$NOTSUPERWSN-C
      503    16464              MESSAGE0: You do not have SUPERWSN ppriv.
      504    16465        */
      505    16466                 %SCREAM( ERR#=E$NOTSUPERWSN, LEVEL=ERROR, MID='A' );
      506    16481    4            GOTO CMD_LOOP ;
      507    16482    4            END ;  /* Then do */
      508    16483    3         SELECT( 49 /* REMOVE FORM*/,
      509    16484    3              51 /* D_FORM_VAL */,
      510    16485    3              71 /* CR_MOD_CHARSET_VAL */ ,
      511    16486    3              72 /* R_CHARSET_VAL */ ,
      512    16487    3              73 /* D_CHARSET_VAL */ ,
      513    16488    3              54  /* CR_MOD_PSEUDO_VAL */ ,
      514    16489    3              39 /* CR_MOD_FORM_VAL */ ) ;
      515    16490    3         IF NOT SUPERFORM
      516    16491    4         THEN DO;
      517    16492        /*E*  ERROR:    ASA-E$NOTSUPERFORM-C
      518    16493              MESSAGE0: You do not have SUPERFORM ppriv.
      519    16494        */
      520    16495                 %SCREAM( ERR#=E$NOTSUPERFORM, LEVEL=ERROR, MID='A' );
      521    16510    4            GOTO CMD_LOOP ;
      522    16511    4            END ; /* Then do */
      523    16512
      524    16513    3         SELECT( 53 /* MAKEME_VAL */ );
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:21   
      525    16514    3         IF  NOT PADMIN  AND  NOT SUPERAUTH
      526    16515    4         THEN DO;
      527    16516        /*E*  ERROR:    ASA-E$NOMAKEME-C
      528    16517        MESSAGE: You do not have SUPERAUTH or PADMIN pprivilege.
      529    16518        MESSAGE1: The SUPERAUTH or PADMIN pprivilege is needed for the MAKEME command.
      530    16519        */
      531    16520                 %SCREAM( ERR#=E$NOMAKEME, LEVEL=ERROR, MID='A' );
      532    16535    4            GOTO CMD_LOOP;
      533    16536    4            END;
      534    16537    3         END ; /* Do case */
      535    16538              /* This case checks if a delete command was input, if it was
      536    16539                 we ask for special confirmation ('YES$'), without
      537    16540                 the input response being exactly 'YES$' with no trailing
      538    16541                 or leading blanks the delete is cancelled.
      539    16542              */
      540    16543    3      DO SELECT (CODE);
      541    16544    3         SELECT ( 77 /* D_TERM_VAL */ );
      542    16545    3         AS_FIELD1.COUNT = 9;
      543    16546    3         AS_FIELD1.TEXT = 'TERMINALS';
      544    16547    3         DELETE_FLAG = AS_TRUE;
      545    16548    3         SELECT ( 78 /* D_CON_VAL */ );
      546    16549    3         AS_FIELD1.COUNT = 8;
      547    16550    3         AS_FIELD1.TEXT = 'CONSOLES';
      548    16551    3         DELETE_FLAG = AS_TRUE;
      549    16552    3         SELECT ( 79 /* D_PRO_VAL */ );
      550    16553    3         AS_FIELD1.COUNT = 8;
      551    16554    3         AS_FIELD1.TEXT = 'PROFILES';
      552    16555    3         DELETE_FLAG = AS_TRUE;
      553    16556    3         SELECT ( 51 /* D_FORM_VAL */ );
      554    16557    3         AS_FIELD1.COUNT = 5;
      555    16558    3         AS_FIELD1.TEXT = 'FORMS';
      556    16559    3         DELETE_FLAG = AS_TRUE;
      557    16560    3         SELECT ( 73 /* D_CHARSET_VAL */ );
      558    16561    3         AS_FIELD1.COUNT = 8;
      559    16562    3         AS_FIELD1.TEXT = 'CHARSETS';
      560    16563    3         DELETE_FLAG = AS_TRUE;
      561    16564    3         SELECT ( 76 /* D_DEV_VAL */ );
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:22   
      562    16565    3         AS_FIELD1.COUNT = 7;
      563    16566    3         AS_FIELD1.TEXT = 'DEVICES';
      564    16567    3         DELETE_FLAG = AS_TRUE;
      565    16568    3         SELECT ( 37 /* D_USERS_VAL */ );
      566    16569    3         AS_FIELD1.COUNT = 5;
      567    16570    3         AS_FIELD1.TEXT = 'USERS';
      568    16571    3         DELETE_FLAG = AS_TRUE;
      569    16572    3         SELECT ( ELSE );
      570    16573    3      DELETE_FLAG = AS_FALSE;
      571    16574    3         END; /* Do case to check delete command */
      572    16575    2   IF (DELETE_FLAG)
      573    16576    3   THEN DO;  /*DELTETE_FLAG -set means a delete command was issued
      574    16577                          and we must ask for confirmation. */
      575    16578    3      CALL CONCAT (DELETE_PROMPT, 'Delete all ',
      576    16579    3           SUBSTR (AS_FIELD1.TEXT, 0, AS_FIELD1.COUNT), ' ?');
      577    16580    3      CALL ASB$SET_PROMPT ( %PROMPT_GENERAL, DELETE_PROMPT, 12+AS_FIELD1.COUNT );
      578    16581    3      CALL ASB$READ_SI (IN_BUF, I);
      579    16582    3      IF ( (I ~= 4) OR
      580    16583    3           (SUBSTR (IN_BUF, 0, 4) ~= 'YES$') AND
      581    16584    3           (SUBSTR (IN_BUF, 0, 4) ~= 'yes$') )
      582    16585    4      THEN DO;
      583    16586    4         CALL ASB$WRITE_LO ('Answer must be ''YES$'', deletion canceled.', 41);
      584    16587    4         GOTO CMD_LOOP;
      585    16588    4         END;
      586    16589                    /* Set prompt back to original */
      587    16590    3      CALL ASB$SET_PROMPT ( %PROMPT_RESTORE );
      588    16591    3      END;
      589    16592                                                              /* Process the command. */
      590    16593    3   DO SELECT (CODE) ;
      591    16594
      592    16595    3      SELECT( 1 /* ILLEGAL USER */ ) ;
      593    16596        /*E*  ERROR:    ASA-E$ILLEGALUSER-C
      594    16597              MESSAGE0: You may not access SUPER.
      595    16598        */
      596    16599           %SCREAM( ERR#=E$ILLEGALUSER, LEVEL=ERROR, MID='A' );
      597    16614    3      GOTO EXIT_SUPER ;
      598    16615
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:23   
      599    16616    3      SELECT(26   /*  BLANK_LINE_VAL */) ;
      600    16617
      601    16618    3      SELECT(27   /*  CR_MOD_ACCT_VAL */) ;
      602    16619    3      CALL CREATE_MOD_USER ;
      603    16620
      604    16621    3      SELECT(52 /* CR_MOD_PROJ_VAL */) ;
      605    16622    3      CALL CREATE_MOD_PROJ;
      606    16623
      607    16624    3      SELECT( 53 /* MAKEME_VAL */ );
      608    16625    3      CODE = P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      609    16626    3      CALL MAKEME( CODE );
      610    16627
      611    16628    3      SELECT ( 31   /*  LIST_VAL */, %DISPLAY_CMD_VAL );
      612    16629    3      CALL ASL$LIST ( CODE ) ;
      613    16630    3      ASA_BRKS_LOC_BIT = '0'B;
      614    16631
      615    16632    3      SELECT( 40 /* R_TERM */ );
      616    16633    3      CALL ASR$R_TERMINAL ;
      617    16634
      618    16635    3      SELECT( 44 /* REMOVE STATION */ );
      619    16636    3      CALL ASR$R_STATION ;
      620    16637
      621    16638    3      SELECT( 41 /* R_CON */ ) ;
      622    16639    3      CALL ASR$R_CONSOLE ;
      623    16640
      624    16641    3      SELECT( 48 /* REMOVE DEV */ );
      625    16642    3      CALL ASR$R_DEVICE;
      626    16643
      627    16644    3      SELECT( 74 /* R_TPDEV_VAL */ );
      628    16645    3      CALL ASR$R_TPDEVICE;
      629    16646
      630    16647    3      SELECT( 49 /* REMOVE FORM*/ );
      631    16648    3      CALL ASR$R_FORM;
      632    16649
      633    16650    3      SELECT( 51 /* D_FORM_VAL */ );
      634    16651    3      CALL ASR$D_FORM_RECS;
      635    16652
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:24   
      636    16653    3      SELECT( 47 /* REMOVE WSN */ ) ;
      637    16654    3      CALL ASR$R_WSN ;
      638    16655
      639    16656    3      SELECT( 42 /* R_PRO */ ) ;
      640    16657    3      CALL ASR$R_PROFILE ;
      641    16658
      642    16659    3      SELECT( 43 /* R_USER */ ) ;
      643    16660    3      CALL REMOVE_USER_PROJECT( AS_FALSE );
      644    16661
      645    16662    3      SELECT( 50 /* R_PROJ */ );
      646    16663    3      CALL REMOVE_USER_PROJECT( AS_TRUE );
      647    16664
      648    16665    3      SELECT(34 /* CR_MOD_PRO_VAL */) ;
      649    16666    3      CALL ASD$PROFILE ;
      650    16667
      651    16668    3      SELECT( 36 /* CR_MOD_TERM */ ) ;
      652    16669    3      CALL ASA$TERMINAL ;
      653    16670
      654    16671    3      SELECT( 45 /* CREATE STATION */ ) ;
      655    16672    3      CALL ASA$STATION ;
      656    16673
      657    16674    3      SELECT( 35 /* CR_MOD_CON_VAL */ ) ;
      658    16675    3      CALL ASA$CONSOLE ;
      659    16676
      660    16677    3      SELECT( 46 /* CR_MOD_DEV_VAL */ );
      661    16678    3      CALL ASA$DEVICE;
      662    16679
      663    16680    3      SELECT( 39 /* CR_MOD_FORM_VAL */ ) ;
      664    16681    3      CALL ASF$FORM( AS_FALSE );
      665    16682
      666    16683    3      SELECT( 54  /* CR_MOD_PSEUDO_VAL */ ) ;
      667    16684    3      CALL ASF$FORM( AS_TRUE );
      668    16685
      669    16686    3      SELECT( 38 /* CR_MOD_WSN */ ) ;
      670    16687    3      CALL ASW$WSN ;
      671    16688
      672    16689    3      SELECT( 37 /* D_USERS_VAL */ ) ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:25   
      673    16690    3      CALL ASR$D_USERS_RECS ;
      674    16691
      675    16692    3      SELECT( 55 /* CR_MOD_VIR_CIR_VAL */ ,
      676    16693    3           63 /* CR_MOD_LINK_VAL */  ,
      677    16694    3           %CR_MOD_LINK_DEV_VAL ) ;
      678    16695
      679    16696    3      CALL ASA$LINK_VIRCIR ;
      680    16697
      681    16698    3      SELECT( 56 /* R_VIR_CIR */  ,
      682    16699    3           64 /* R_LINK_VAL */   ,
      683    16700    3           75 /* R_LINK_DEV_VAL */ ) ;
      684    16701
      685    16702    3      CALL ASR$R_LINK_VIRCIR ;
      686    16703
      687    16704    3      SELECT( 57 /* CR_MOD_LINE_VAL */, 58 /* CR_MOD_CONT_VAL */, 61
             16704               /* CR_MOD_LINE_DEV_VAL */ );
      688    16705    3      CALL ASA$LINE_CONTROLLER;
      689    16706
      690    16707    3      SELECT( 59 /* R_LINE_VAL */, 60 /* R_CONT_VAL */, 62 /* R_LINE_DEV_VAL */ );
      691    16708    3      CALL ASR$R_LINE_CONT;
      692    16709
      693    16710    3      SELECT( 65 /* UNTIE_USER_VAL */ );
      694    16711    3      CALL UNTIE_USER;
      695    16712
      696    16713    3      SELECT( 66 /* UNTIE_PROJ_VAL */ );
      697    16714    3      CALL UNTIE_PROJ;
      698    16715
      699    16716    3      SELECT( 67 /* TIE_USER_VAL */ );
      700    16717    3      CALL TIE_USER;
      701    16718
      702    16719    3      SELECT( 68 /* TIE_PROJ_VAL */ );
      703    16720    3      CALL TIE_PROJ;
      704    16721
      705    16722    3      SELECT( 69 /* MOD_USER_TO_PROJ_VAL */ );
      706    16723    3      CALL MOD_USER_TO_PROJ;
      707    16724
      708    16725    3      SELECT( 70 /* MOD_PROJ_TO_USER_VAL */ );
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:26   
      709    16726    3      CALL MOD_PROJ_TO_USER;
      710    16727
      711    16728    3      SELECT( 71 /* CR_MOD_CHARSET_VAL */ );
      712    16729    3      CALL ASC$CHARSET;
      713    16730
      714    16731    3      SELECT( 72 /* R_CHARSET_VAL */ );
      715    16732    3      CALL ASR$R_CHARSET;
      716    16733
      717    16734    3      SELECT( 73 /* D_CHARSET_VAL */ );
      718    16735    3      CALL ASR$D_CHARSET_RECS;
      719    16736
      720    16737    3      SELECT( 80 /* RECONFIG_TIGR_STAT_VAL */ );
      721    16738    3      CALL RECONFIG_TIGR_STATION;
      722    16739
      723    16740    3      SELECT(12   /*  END_VAL  */) ;
      724    16741    3      MORE = AS_FALSE ;
      725    16742
      726    16743    3      SELECT(302 /* HELP_VAL */) ;
      727    16744    3      CALL ASH$HELP ;
      728    16745
      729    16746    3      SELECT(300 /* DQUESTION_VAL */) ;
      730    16747    3      CALL ASH$DQUEST  ;
      731    16748
      732    16749    3      SELECT(301 /* QUESTION_VAL */) ;
      733    16750    3      CALL ASH$QUEST  ;
      734    16751    3      SELECT (
      735    16752    3           77 /* D_TERM_VAL */,
      736    16753    3           78 /* D_CON_VAL */,
      737    16754    3           79 /* D_PRO_VAL */,
      738    16755    3           76 /* D_DEV_VAL */
      739    16756    3           );
      740    16757        /*E*  ERROR:    ASA-E$NOT_IMPLEMENTED-C
      741    16758              MESSAGE:  That feature is not yet implemented.
      742    16759              MESSAGE1: You have requested an action that SUPER cannot yet perform.
      743    16760        */
      744    16761           %SCREAM( ERR#=E$NOT_IMPLEMENTED, LEVEL=WARN, MID='A' );
      745    16776
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:27   
      746    16777    3      SELECT(ELSE) ;
      747    16778        /*E*  ERROR:    ASA-E$INVALID_COMMAND-C
      748    16779              MESSAGE:  Invalid command.
      749    16780              MESSAGE1: The valid COMMANDs are:
      750    16781                          C[REATE], M[ODIFY], L[IST], R[EMOVE], DEL[ETE]
      751    16782                          H[ELP] [<cmd>], Q[UIT], and E[ND].
      752    16783        */
      753    16784        %SCREAM( ERR#=E$INVALID_COMMAND, LEVEL=ERROR, MID='A' );
      754    16799
      755    16800    3      END ;     /*  Do case  */
      756    16801                                                              /**/
      757    16802    2   P_PCB.ROOT$ = ADDR(CMD_NODES) ;
      758    16803                                                              /**/
      759    16804    3   IF DSEG1SIZE > 3072 THEN DO;
      760    16805    3      FREE_SEG_SIZE = DSEG1SIZE - 3072;
      761    16806    3      FREE_SEG_TYPE = 1;
      762    16807    3      CALL ASB$FREE_SEG (FREE_SEG_TYPE, FREE_SEG_SIZE);
      763    16808    3      END;
      764    16809    3   IF DSEG2SIZE > 3072 THEN DO;
      765    16810    3      FREE_SEG_SIZE = DSEG2SIZE - 3072;
      766    16811    3      FREE_SEG_TYPE = 2;
      767    16812    3      CALL ASB$FREE_SEG (FREE_SEG_TYPE, FREE_SEG_SIZE);
      768    16813    3      END;
      769    16814    3   IF DSEG3SIZE > 1024 THEN DO;
      770    16815    3      FREE_SEG_SIZE = DSEG3SIZE - 1024;
      771    16816    3      FREE_SEG_TYPE = 3;
      772    16817    3      CALL ASB$FREE_SEG (FREE_SEG_TYPE, FREE_SEG_SIZE);
      773    16818    3      END;
      774    16819    2   DSEG_FLG = '0'B;
      775    16820
      776    16821    2      END ;     /*  Do while  */
      777    16822                                                              /**/
      778    16823    1   SUPER_ERR:
      779    16824    1   IF (MORE)
      780    16825    2   THEN DO;
      781    16826           %SCREAM( ERR#=E$INVALID_COMMAND, LEVEL=ERROR, MID='A' );
      782    16841    2      GOTO CMD_LOOP ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:28   
      783    16842    2      END ;   /*  If (more)  */
      784    16843                                                              /**/
      785    16844    1   WRITE_CHAIN_ERR: ;
      786    16845    1   IF ( MORE )
      787    16846    1   THEN
      788    16847    1      CALL ASH$ERROR( ERR_CODE ) ;
      789    16848                                                              /**/
      790    16849    1   CLOSE_FILES: ;
      791    16850    1   CALL ASB$CLOSE_USERS ;
      792    16851    1   CALL ASB$CLOSE_HLP ;
      793    16852    1   CALL ASD$CLOSE_PRO ;
      794    16853                                                              /*  Output error count.  */
      795    16854    1   OUTPUT_ERROR_CNT: ;
      796    16855    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );
      797    16856    1   IF ERR_CNT = 0 THEN CALL ASB$WRITE_LO( '***  NO Errors  ***', 19 );
      798    16857    1   ELSE
      799    16858    1      IF ERR_CNT = 1 THEN CALL ASB$WRITE_LO( '***  1 Error  ***', 17 );
      800    16859    2      ELSE DO;
      801    16860              %NUMBER( NUM1=ERR_CNT );
             16868    2         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, ERR_CNT );
      802    16890    2         CALL CONCAT( OUT_BUF, '***  ',
      803    16891    2              SUBSTR( AS_FIELD1.TEXT, 0, AS_FIELD1.COUNT ),
      804    16892    2              ' Errors  ***' ) ;
      805    16893    2         ARS = 17 + AS_FIELD1.COUNT;
      806    16894    2         CALL ASB$WRITE_LO( OUT_BUF, ARS ) ;
      807    16895    2         END;
      808    16896                                                              /*  Output warning count. */
      809    16897    1   IF WARN_CNT = 0 THEN CALL ASB$WRITE_LO( '***  NO Warnings ***', 20 );
      810    16898    1   ELSE
      811    16899    1      IF WARN_CNT = 1 THEN CALL ASB$WRITE_LO( '***  1 Warning ***', 19 );
      812    16900    2      ELSE DO;
      813    16901              %NUMBER( NUM1=WARN_CNT );
             16909    2         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, WARN_CNT );
      814    16931    2         CALL CONCAT( OUT_BUF, '***  ',
      815    16932    2              SUBSTR( AS_FIELD1.TEXT, 0, AS_FIELD1.COUNT ),
      816    16933    2              ' Warnings  ***' ) ;
      817    16934    2         ARS = 19 + AS_FIELD1.COUNT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:29   
      818    16935    2         CALL ASB$WRITE_LO( OUT_BUF, ARS ) ;
      819    16936    2         END ;   /* Else do */
      820    16937    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );
      821    16938    2   IF ERR_CNT > 0 THEN DO;
      822    16939    2   EXIT_SUPER:
      823    16940    2      FPT_EXIT.V.STEPCC# = 4;
      824    16941    2      END;
      825    16942    1   ELSE
      826    16943    1      IF WARN_CNT > 0 THEN FPT_EXIT.V.STEPCC# = 2;
      827    16944    1   CALL ASB$CLOSE_LO;
      828    16945    1   CALL M$EXIT( FPT_EXIT );
      829    16946        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:30   
      830    16947    1   RECONFIG_TIGR_STATION: PROC;
      831    16948        /*I*   NAME:  RECONFIG_TIGR_STATION
      832    16949
      833    16950               PURPOSE:  To drive the RECONFIGURE STATION command
      834    16951
      835    16952               CALL:  CALL RECONFIG_TIGR_STATION
      836    16953
      837    16954               INPUT:  station name from the input command
      838    16955
      839    16956               OUTPUT:  NONE
      840    16957
      841    16958               DESCRIPTION:
      842    16959                   This routine will read the 'WSN' record from the :CONFIG
      843    16960                   file and search that record for the specified station name.
      844    16961                   If the station name is not found an error will be issued.
      845    16962                   If the station name is found, this routine will ask for
      846    16963                   confirmation of the command.  If anything other than YES$
      847    16964                   or yes$ is given in response to the confirmation request,
      848    16965                   a return is effected.  If the command is confirmed, this
      849    16966                   routine fills in a command buffer with the REMOVE STATION
      850    16967                   stationname command and parses it.  It then calls
      851    16968                   ASR$R_TIGR_STATION, which removes all knowledge of the
      852    16969                   station from SUPER maintained files.
      853    16970                   This routine then fills in a REMOVE
      854    16971                   WSN wsnname command into the command buffer and parses
      855    16972                   that.  It then calls ASR$R_TIGR_WSN, which removes all
      856    16973                   knowledge of the specified wsn from SUPER maintained files.
      857    16974                   If those two routines
      858    16975                   don't altreturn then this routine calls ASC$CONFIG to
      859    16976                   rebuild the removed station and wsn from the :CONFIG file.
      860    16977        */
      861    16978    2   DCL REM_STA CHAR (0) STATIC INIT ('REM STATION ');
      862    16979    2   DCL REM_WSN CHAR (0) STATIC INIT ('REM WSN ');
      863    16980    2   DCL RECON_PROMPT CHAR (0) STATIC INIT ('Reconfigure station          ?');
      864    16981    2   DCL PART1 CHAR (0) STATIC INIT ('Reconfiguring station ');
      865    16982    2   DCL PART2 CHAR (0) STATIC INIT (' will remove STATION and WSN ');
      866    16983    2   DCL PART3 CHAR (0) STATIC INIT (' and then rebuild ');
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:31   
      867    16984    2   DCL PART4 CHAR (0) STATIC INIT ('them with only the IOM connected devices.');
      868    16985    2   DCL PART5 CHAR(0) STATIC INIT ('Answer must be ''YES$'', reconfiguration of ');
      869    16986    2   DCL PART6 CHAR(0) STATIC INIT (' cancelled.');
      870    16987    2   DCL PART7 CHAR (0) STATIC INIT ('Station ');
      871    16988    2   DCL PART8 CHAR (0) STATIC INIT (' has been recreated.');
      872    16989    2   DCL PART9 CHAR (0) STATIC INIT ('WSN ');
      873    16990    2   DCL PART10 CHAR (0) STATIC INIT (' has been recreated from the new STATION ');
      874    16991    2   DCL LINE CHAR(80) CALIGNED;
      875    16992    2   DCL WSN_INDEX  UBIN;
      876    16993
      877    16994        /*
      878    16995          Find the specified station name in the parse nodes
      879    16996          and check for errors
      880    16997        */
      881    16998    2   BLK$ = P$NODE.SUBLK$(0);
      882    16999    2   IF OUT$SYM.COUNT > 8 THEN
      883    17000    3   DO;
      884    17001           %SCREAM ( ERR#=E$SNAMETOOBIG, LEVEL=ERROR, MID='A' );
      885    17016    3      RETURN;
      886    17017    3      END; /*  If count > 8  */
      887    17018    2   CALL ASC$CHECK_TIGR_WSN (OUT$SYM.TEXTC$,WSN_INDEX) WHENALTRETURN
      888    17019    3   DO;
      889    17020        /*E* ERROR:  ASA-E$NOTTIGRWSN-C
      890    17021             MESSAGE:  %U1 is not a TIGR defined WSN.  Only TIGR defined
      891    17022                       wsns can be reconfigured.
      892    17023             MESSAGE1:  I suggest you REMOVE STATION %U1, and then reCREATE it.
      893    17024        */
      894    17025    3      AS_FIELD1.COUNT = OUT$SYM.COUNT;
      895    17026    3      AS_FIELD1.TEXT = OUT$SYM.TEXT;
      896    17027           %SCREAM (ERR#=E$NOTTIGRWSN, LEVEL=ERROR, MID='A');
      897    17042    3      RETURN;
      898    17043    3      END; /*  Whenaltreturn  */
      899    17044
      900    17045    2   CALL CONCAT (LINE,PART1,OUT$SYM.TEXT,PART2,OUT$SYM.TEXT);
      901    17046    2   CALL ASB$WRITE_LO (LINE, SIZEC (LINE));
      902    17047    2   CALL CONCAT (LINE,PART3,PART4);
      903    17048    2   CALL ASB$WRITE_LO (LINE, SIZEC (LINE));
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:32   
      904    17049    2   CALL ASB$WRITE_LO (' ', 1);
      905    17050    2   SUBSTR (RECON_PROMPT,20,8) = OUT$SYM.TEXT;
      906    17051    2   CALL ASB$SET_PROMPT ( %PROMPT_GENERAL, RECON_PROMPT, SIZEC(RECON_PROMPT) );
      907    17052    2   CALL ASB$READ_SI (IN_BUF, I);
      908    17053    2   IF ( (I ~= 4) OR
      909    17054    2        (SUBSTR (IN_BUF, 0, 4) ~= 'YES$') AND
      910    17055    2        (SUBSTR (IN_BUF, 0, 4) ~= 'yes$') )
      911    17056    3   THEN DO;
      912    17057    3      CALL CONCAT (LINE,PART5,OUT$SYM.TEXT,PART6);
      913    17058    3      CALL ASB$WRITE_LO (LINE, SIZEC (LINE));
      914    17059    3      CALL ASB$SET_PROMPT ( %PROMPT_RESTORE );
      915    17060    3      RETURN;
      916    17061    3      END;
      917    17062    2   CALL ASB$SET_PROMPT ( %PROMPT_RESTORE );
      918    17063
      919    17064        /* Delete station local */
      920    17065
      921    17066    2   CALL CONCAT (IN_BUF,REM_STA,OUT$SYM.TEXT);
      922    17067    2   P_PCB.NCHARS = SIZEC (REM_STA) + OUT$SYM.COUNT;
      923    17068    2   CALL X$PARSE (P_PCB);
      924    17069    2   NODE$ = P_PCB.OUT$;
      925    17070    2   CODE = P$NODE.CODE;
      926    17071    2   CALL ASR$R_STAT_TIGR;
      927    17072
      928    17073        /* Remove wsn local */
      929    17074
      930    17075    2   CALL CONCAT (IN_BUF,REM_WSN,OUT$SYM.TEXT);
      931    17076    2   P_PCB.NCHARS = SIZEC (REM_WSN) + OUT$SYM.COUNT;
      932    17077    2   CALL X$PARSE (P_PCB);
      933    17078    2   NODE$ = P_PCB.OUT$;
      934    17079    2   CODE = P$NODE.CODE;
      935    17080    2   CALL ASR$R_WSN;
      936    17081
      937    17082        /* Close hlp before calling ASC$CONFIG or it will altreturn. */
      938    17083
      939    17084    2   CALL ASB$CLOSE_HLP;
      940    17085
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:33   
      941    17086        /* Do the reconfiguration */
      942    17087
      943    17088    2   CALL ASC$CONFIG (WSN_INDEX) WHENALTRETURN
      944    17089    3   DO;
      945    17090    3      AS_FIELD1.COUNT = OUT$SYM.COUNT;
      946    17091    3      AS_FIELD1.TEXT = OUT$SYM.TEXT;
      947    17092           %SCREAM (ERR# = E$CONFIG_FAIL, LEVEL = ERROR, MID = 'A');
      948    17107    3      RETURN;
      949    17108    3      END; /*  Whenaltreturn  */
      950    17109
      951    17110        /* Clean up */
      952    17111
      953    17112    2   CALL ASB$OPEN_HLP_UP;
      954    17113    2   CALL ASB$WRITE_LO (' ',1);
      955    17114    2   CALL CONCAT (LINE,PART7,OUT$SYM.TEXT,PART8);
      956    17115    2   CALL ASB$WRITE_LO (LINE, SIZEC (LINE));
      957    17116    2   CALL CONCAT (LINE,PART9,OUT$SYM.TEXT,PART10);
      958    17117    2   CALL ASB$WRITE_LO (LINE, SIZEC (LINE));
      959    17118
      960    17119    2   RETURN;
      961    17120    2   END RECONFIG_TIGR_STATION;
      962    17121        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:34   
      963    17122    1   CREATE_MOD_USER: PROC ;
      964    17123
      965    17124        /********************************************************************/
      966    17125        /*   Auto data       auto data       auto data       auto data       */
      967    17126        /*********************************************************************/
      968    17127
      969    17128    2   DCL 1 CR_MOD_KEY ,
      970    17129    2          2 CNT UBIN(9) UNAL ,
      971    17130    2          2 TEXT CHAR(21) UNAL ;
      972    17131    2   DCL I SBIN ;
      973    17132    2   DCL J SBIN ;
      974    17133    2   DCL K SBIN ;
      975    17134    2   DCL PTR$ PTR ;
      976    17135    2   DCL PAR$ PTR ;
      977    17136    2   DCL PROJ_ACCT_LIST$ PTR ;
      978    17137    2   DCL CREATE BIT(1) ;
      979    17138    2   DCL PROJ_FLAG BIT(1) ALIGNED;
      980    17139    2   DCL TYPE UBIN WORD ;
      981    17140    2   DCL COUNT UBIN WORD ;
      982    17141    2   DCL PACKSET_COUNT SBIN;
      983    17142    2   DCL ACCT_COUNT SBIN;
      984    17143
      985    17144        /********************************************************************/
      986    17145        /*   Based data      based data      based data      based data      */
      987    17146        /*********************************************************************/
      988    17147
      989    17148        %AS$PROJ_HEADER( NAME="PACKSET$LIST(0:0)" , STCLASS="BASED(DSEG1$)", LAST="," );
      990    17177    2          2 PSN CHAR(8);
      991    17178        %AS$PROJ( STCLASS="BASED(DSEG2$)" );
      992    17212        %AS$PROJ_HEADER( STCLASS="BASED(DSEG2$)" );
      993    17241        %AS$PROJ_ACCT_LIST( NAME=PROJ$LIST, STCLASS="BASED(PROJ_ACCT_LIST$)" );
      994    17246    2   DCL 1 ACCT$LIST(0:0) ALIGNED BASED(DSEG1$),
      995    17247    2          2 PSN CHAR(6),
      996    17248    2          2 ACCT CHAR(8),
      997    17249    2          2 GRANS UBIN;
      998    17250
      999    17251        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:35   
     1000    17252        /********************************************************************/
     1001    17253        /*   Procedure       procedure       procedure       procedure       */
     1002    17254        /*********************************************************************/
     1003    17255
     1004    17256    2   PROJ_FLAG = AS_FALSE;
     1005    17257    2   CALL PARSE_CMD( CR_MOD_CMD ) ALTRET(EXIT#);
     1006    17258    2   IF AS_PROJECT_ADMIN = AS_NONE THEN
     1007    17259    2      AS_CR_MOD_PROJ = 0;
     1008    17260    3   ELSE DO;
     1009    17261                                                   /* Project administrator */
     1010    17262    3      AS_CR_MOD_PROJ = %CR_PROJ_USER;  /* is creating the user */
     1011    17263                                         /* Read default record for project */
     1012    17264    3      CALL CONCAT( USERS_KEY.TXTC, AS_PROJECT_ADMIN.TEXT, 'S' );
     1013    17265    3      USERS_KEY.COUNT = 21;
     1014    17266    3      CALL ASB$GET(AS_FALSE, , AS_DFLT, KL_DFLT$) ALTRET(EXIT#);
     1015    17267    3      END;
     1016    17268
     1017    17269    2   PAR$ = P$NODE.SUBLK$(1) ;
     1018    17270    2   CALL ASB$KEYMAKER(CR_MOD_KEY,PAR$->P$NODE,PROJ_FLAG,TYPE) ALTRET(EXIT#) ;
     1019    17271
     1020    17272                                                              /*   Create or modify
     1021    17273                                                                   an user.      */
     1022    17274    2   CALL INITIALIZATIONS  ALTRET(EXIT#);
     1023    17275    2   USERS_KEY = CR_MOD_KEY ;
     1024    17276    2   IF CREATE THEN CALL CHECK_CREATE_OK(AS_PROJECT_ADMIN) ALTRET(EXIT#);
     1025    17277    2   ELSE                                    /* Modify */
     1026    17278    2      IF AS_WILD_USER THEN CALL GET_FIRST ALTRET(FINISHED);
     1027    17279    2      ELSE                                     /* Get specified user */
     1028    17280    2         CALL ASB$GET( PROJ_FLAG, TYPE, AS_USERS, KL_DREC$ ) ALTRET(EXIT#);
     1029    17281
     1030    17282                                                     /*   Check to see if
     1031    17283                                                          from was input  */
     1032    17284    2   IF P$NODE.SUBNODES = 4
     1033    17285    3   THEN DO;
     1034    17286                                                              /*   Yes.    */
     1035    17287    3      FROM_FLG = AS_TRUE ;
     1036    17288    3      PAR$ = P$NODE.SUBLK$(2) ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:36   
     1037    17289    3      CALL ASB$KEYMAKER(FROM_KEY,PAR$->P$NODE,PROJ_FLAG,21   /*  FROM_VAL */) ALTRET(
             17289               EXIT#) ;
     1038    17290                                           /*   From default or an account. */
     1039    17291    3      USERS_KEY = FROM_KEY ;
     1040    17292    3      IF AS_CR_MOD_PROJ = %CR_PROJ_USER  AND  FROM_KEY.TEXT = 'DEFAULT'
     1041    17293    4      THEN DO;
     1042    17294    4         AS_USERS = AS_DFLT ;
     1043    17295    4         KL_DREC  = KL_DFLT ;
     1044    17296    4         END;
     1045    17297    4      ELSE DO;
     1046    17298    4         CALL ASB$GET( PROJ_FLAG, , AS_USERS, KL_DREC$ ) ALTRET(EXIT#);
     1047    17299    4         END;    /* Else do */
     1048    17300    3      END;        /*Then do */
     1049    17301    3   ELSE DO;                             /*   Default implied.    */
     1050    17302    3      FROM_FLG = '0'B;
     1051    17303    4      IF CREATE THEN DO;
     1052    17304    4         IF AS_CR_MOD_PROJ = %CR_PROJ_USER
     1053    17305    5         THEN DO;
     1054    17306    5            AS_USERS = AS_DFLT;
     1055    17307    5            KL_DREC  = KL_DFLT;
     1056    17308    5            END;
     1057    17309    5         ELSE DO;
     1058    17310    6            IF (SUBSTR(CR_MOD_KEY.TEXT,0,20)) = 'DEFAULT' THEN DO;
     1059    17311    6               AS_USERS = AS_USERS_CONSTANT;
     1060    17312    6               KL_DREC  = KL_DEFAULT;
     1061    17313    6               KL_DREC.PASSWORD = BLANK_PASS;
     1062    17314    6               END;
     1063    17315    6            ELSE DO;
     1064    17316    6               FROM_KEY.CNT = 7 ;
     1065    17317    6               FROM_KEY.TEXT = 'DEFAULT' ;
     1066    17318    6               USERS_KEY = FROM_KEY ;
     1067    17319    6               CALL ASB$GET( PROJ_FLAG,,AS_USERS, KL_DREC$) ALTRET(EXIT#);
     1068    17320    6               END;     /* Else do */
     1069    17321    5            END;
     1070    17322    4         END ;   /* Then do */
     1071    17323    3      END ;   /* Else do */
     1072    17324
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:37   
     1073    17325    3   IF AS_CR_MOD_PROJ = %CR_PROJ_USER AND FROM_FLG THEN DO;
     1074    17326    3      CALL COMPARE_FROM_TO_MAX( AS_USERS, KL_DREC, AS_DFLT, KL_DFLT );
     1075    17327    3      END;
     1076    17328
     1077    17329    2   USERS_KEY = CR_MOD_KEY ;
     1078    17330    3   IF CREATE OR FROM_FLG THEN DO;
     1079    17331    3      AS_USERS.ACCT = SUBSTR( CR_MOD_KEY.TEXT, 0, 8 );
     1080    17332    3      AS_USERS.NAME = SUBSTR( CR_MOD_KEY.TEXT, 8, 12 );
     1081    17333    3      AS_USERS.BUDGET.MACCT = AS_PROJECT_ADMIN;
     1082    17334    3      END;
     1083    17335
     1084    17336    2   GET_USER_OPTIONS:;                               /*   Do options    */
     1085    17337
     1086    17338    2   IF NOT CREATE AND NOT FROM_FLG THEN
     1087    17339         /*  do nothing  */
     1088    17340    3   DO; END;
     1089    17341    3   ELSE DO;
     1090    17342    3      AS_USERS.LAST_LOGON_TIME = '0'B;
     1091    17343    3      AS_USERS.LOGINS = '0'B;
     1092    17344    3      END;
     1093    17345    2   AS_MOD_USER = '0'B;
     1094    17346    2   CALL ASC$CM_OPTS (CR_MOD_KEY) ;
     1095    17347                                                        /*   Write out users
     1096    17348                                                             records    */
     1097    17349    2   USERS_KEY = CR_MOD_KEY;
     1098    17350    2   IF CREATE AND AS_CR_MOD_PROJ > 0 THEN
     1099    17351    2      CALL ASB$ACCT_OK( USERS_KEY.UKEY.ACCT, AS_USERS.HPSN,
     1100    17352    2           AS_PROJECT_ADMIN, AS_FALSE ) ALTRET(EXIT#);
     1101    17353    2   CALL ASB$WRITE_USERS( AS_USERS );
     1102    17354    2   IF KL_DREC.KL_DREC_FEBLK.RESL_CNT = 0
     1103    17355    2   THEN
     1104    17356    2      KL_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) ;
     1105    17357    2   ELSE
     1106    17358    2      KL_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) +
     1107    17359    2           KL_DREC.KL_DREC_FEBLK.RESL_CNT - 1    ;
     1108    17360    2   ARS = SIZEC_DREC + ( KL_DREC.NWINFO * 4 ) ;
     1109    17361    2   CALL ASB$WRITE_HLP( KL_DREC$, ARS );
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:38   
     1110    17362    3   IF AS_CR_MOD_PROJ = %CR_PROJ_USER AND CREATE THEN DO;
     1111    17363                                       /* Increment number of users created */
     1112    17364    3      AS_DFLT.BUDGET.PROJ_CREATED = AS_DFLT.BUDGET.PROJ_CREATED + 1;
     1113    17365    3      CALL CONCAT( USERS_KEY.TXTC, AS_PROJECT_ADMIN.TEXT, 'S' );
     1114    17366    3      USERS_KEY.COUNT = 21;
     1115    17367    3      CALL ASB$WRITE_USERS( AS_DFLT );
     1116    17368    3      IF AS_DFLT.BUDGET.PROJ_CREATED = AS_DFLT.BUDGET.PROJ_ALLOWED
     1117    17369    4      THEN DO;
     1118    17370        /*E* ERROR:   ASA-E$MAX_PROJ_USERS-C
     1119    17371        MESSAGE: The maximum number of users allowed for project "%U1" have
     1120    17372                 now been created.
     1121    17373        */
     1122    17374    4         CALL ASA$KEYCONV( AS_PROJECT_ADMIN, AS_FIELD1 );
     1123    17375              %SCREAM( ERR#=E$MAX_PROJ_USERS, LEVEL=WARN, MID='A' );
     1124    17390    4         END;
     1125    17391                                                       /* Write special key */
     1126    17392    3      USERS_KEY.SKEY.PROJ = 0 ;
     1127    17393    3      USERS_KEY.SKEY.CREATOR = AS_PROJECT_ADMIN.TEXT ;
     1128    17394    3      USERS_KEY.SKEY.USER = (SUBSTR(CR_MOD_KEY.TEXT,0,20)) ;
     1129    17395    3      USERS_KEY.COUNT = CR_MOD_KEY.CNT + 21;
     1130    17396    3      CALL ASB$WRITE_USERS_KEY;
     1131    17397    3      END;
     1132    17398    2   IF NOT AS_WILD_USER THEN RETURN;
     1133    17399    2   AS_WILD_MCH = AS_DFLT.BUDGET.MAXC ;
     1134    17400    2   AS_DFLT = AS_USERS;
     1135    17401    2   KL_DFLT = KL_DREC;
     1136    17402    3   DO WHILE( '1'B );
     1137    17403    3      CALL ASB$GET_NEXT  ALTRET( FINISHED );
     1138    17404    3      CALL ASB$LIST( USERS_KEY );
     1139    17405    3      IF FROM_FLG
     1140    17406    4      THEN DO;
     1141    17407    4         AS_DFLT.ACCT = AS_USERS.ACCT;
     1142    17408    4         AS_DFLT.NAME = AS_USERS.NAME;
     1143    17409    4         AS_DFLT.BUDGET.MACCT = AS_USERS.BUDGET.MACCT;
     1144    17410    4         CALL ASB$WRITE_USERS( AS_DFLT );
     1145    17411    4         IF KL_DFLT.KL_DFLT_FEBLK.RESL_CNT = 0
     1146    17412    4         THEN
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:39   
     1147    17413    4            KL_DFLT.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) ;
     1148    17414    4         ELSE
     1149    17415    4            KL_DFLT.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) +
     1150    17416    4                 KL_DFLT.KL_DFLT_FEBLK.RESL_CNT - 1    ;
     1151    17417    4         ARS = SIZEC_DREC + ( KL_DFLT.NWINFO * 4 ) ;
     1152    17418    4         CALL ASB$WRITE_HLP( KL_DFLT$, ARS );
     1153    17419    4         END;
     1154    17420    4      ELSE DO;
     1155    17421    4         CALL ASC$MOD_USER;
     1156    17422    4         CALL ASB$WRITE_USERS( AS_USERS );
     1157    17423    4         IF KL_DREC.KL_DREC_FEBLK.RESL_CNT = 0
     1158    17424    4         THEN
     1159    17425    4            KL_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) ;
     1160    17426    4         ELSE
     1161    17427    4            KL_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) +
     1162    17428    4                 KL_DREC.KL_DREC_FEBLK.RESL_CNT - 1    ;
     1163    17429    4         ARS = SIZEC_DREC + ( KL_DREC.NWINFO * 4 ) ;
     1164    17430    4         CALL ASB$WRITE_HLP( KL_DREC$, ARS );
     1165    17431    4         END;
     1166    17432    3      COUNT = COUNT + 1;
     1167    17433    3      END;
     1168    17434    2   FINISHED:
     1169    17435    2   IF COUNT = 0
     1170    17436    3   THEN DO;
     1171    17437        /*E* ERROR: ASA-E$NOTHING_TO_MOD-C
     1172    17438             MESSAGE: Nothing to modify.
     1173    17439        */
     1174    17440           %SCREAM( ERR#=E$NOTHING_TO_MOD, LEVEL=ERROR, MID='A' );
     1175    17455    3      END;
     1176    17456    3   ELSE DO;
     1177    17457        /*E* ERROR: AS-E$NUM_USERS_MOD-C
     1178    17458             MESSAGE:.. %U1 users modified.
     1179    17459        */
     1180    17460    3      CALL ASB$FLUSH;
     1181    17461           %NUMBER( NUM1=COUNT );
             17469    3         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, COUNT );
     1182    17491           %SCREAM( ERR#=E$NUM_USERS_MOD, LEVEL=INFO, MID='A' );
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:40   
     1183    17506    3      END;
     1184    17507
     1185    17508                                                        /*   Return to calling
     1186    17509                                                             routine.     */
     1187    17510    2   EXIT#: RETURN ;
     1188    17511                                                              /**/
     1189    17512
     1190    17513        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:41   
     1191    17514    2   CREATE_MOD_PROJ: ENTRY;
     1192    17515
     1193    17516    2   PROJ_FLAG = AS_TRUE;
     1194    17517    2   CALL PARSE_CMD;
     1195    17518    2   IF AS_PROJECT_ADMIN = AS_NONE
     1196    17519    2   THEN                 /* System administrator creating project */
     1197    17520    2      AS_CR_MOD_PROJ = 0;
     1198    17521    3   ELSE DO;
     1199    17522    3      AS_CR_MOD_PROJ = %CR_PROJECT;      /* Proj. admin. creating project */
     1200    17523                                                  /* Read project records */
     1201    17524    3      USERS_KEY = AS_PROJECT_ADMIN;
     1202    17525    3      CALL ASB$GET( AS_TRUE, , AS_PROJ_ADMIN, AS_PROJ_ADMIN_DREC$,
     1203    17526    3           AS_DEFAULT, AS_DEFAULT_DREC$ ) ALTRET( EXIT# );
     1204    17527    3      END;
     1205    17528
     1206    17529
     1207    17530    2   PAR$ = P$NODE.SUBLK$(1) ;
     1208    17531    2   CALL ASB$KEYMAKER(CR_MOD_KEY,PAR$->P$NODE,PROJ_FLAG,TYPE) ALTRET(EXIT#);
     1209    17532
     1210    17533                                                        /*   Create or modify
     1211    17534                                                             a project.   */
     1212    17535    2   CALL INITIALIZATIONS ALTRET(EXIT#);
     1213    17536    2   USERS_KEY = CR_MOD_KEY ;
     1214    17537    2   IF CREATE THEN CALL CHECK_CREATE_OK(AS_PROJECT_ADMIN) ALTRET(EXIT#);
     1215    17538    2   ELSE                                    /* Modify */
     1216    17539    2      IF AS_WILD_USER THEN CALL GET_FIRST;      /* Get first user */
     1217    17540    2      ELSE                                     /* Get specified user */
     1218    17541    2         CALL ASB$GET( PROJ_FLAG, TYPE, AS_PROJECT, AS_PROJECT_DREC$,
     1219    17542    2              AS_PROJECT_DFLT, AS_PROJECT_DFLT_DREC$ ) ALTRET(EXIT#);
     1220    17543
     1221    17544        /*                                Check to see if 'FROM' was specified */
     1222    17545    2   IF P$NODE.SUBNODES = 4
     1223    17546    3   THEN DO;
     1224    17547                                                              /*   Yes.    */
     1225    17548    3      FROM_FLG = AS_TRUE ;
     1226    17549    3      PAR$ = P$NODE.SUBLK$(2) ;
     1227    17550    3      CALL ASB$KEYMAKER(FROM_KEY,PAR$->P$NODE,PROJ_FLAG,21   /*  FROM_VAL */) ALTRET(
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:42   
             17550               EXIT#) ;
     1228    17551
     1229    17552                                            /*   From default or an account */
     1230    17553    3      USERS_KEY = FROM_KEY ;
     1231    17554    3      IF FROM_KEY.TEXT = 'DEFAULTP' THEN GOTO FROM_DEFAULT_PROJECT;
     1232    17555    3      CALL ASB$GET( PROJ_FLAG, ,  AS_PROJECT, AS_PROJECT_DREC$,
     1233    17556    3           AS_PROJECT_DFLT, AS_PROJECT_DFLT_DREC$ ) ALTRET(EXIT#);
     1234    17557    3      END;        /*Then do */
     1235    17558    3   ELSE DO;                             /*   Default implied.    */
     1236    17559    3      FROM_FLG = '0'B;
     1237    17560    4      IF CREATE THEN DO;
     1238    17561    5         IF (SUBSTR(CR_MOD_KEY.TEXT,0,20)) = 'DEFAULTP' THEN DO;
     1239    17562    5            AS_PROJECT = AS_USERS_CONSTANT;
     1240    17563    6            DO I = 0 TO 2;
     1241    17564    6               AS_PROJECT.PPRIV(I) = AS_PROJECT.PPRIV(I) | %PPR_PADMIN# ;
     1242    17565    6               END;
     1243    17566    5            AS_PROJECT_DREC = KL_DEFAULT;
     1244    17567    5            AS_PROJECT_DREC.PASSWORD = BLANK_PASS;
     1245    17568    5            AS_PROJECT_DFLT = AS_USERS_CONSTANT ;
     1246    17569    5            AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED = 0;
     1247    17570    5            AS_PROJECT_DFLT_DREC = AS_PROJECT_DREC ;
     1248    17571    5            END;
     1249    17572    4         ELSE
     1250    17573    5            IF AS_CR_MOD_PROJ > 0 THEN DO;
     1251    17574    5               AS_PROJECT = AS_DEFAULT;
     1252    17575    5               AS_PROJECT.BUDGET.ACCUM = AS_USERS_CONSTANT.BUDGET.ACCUM;
     1253    17576    5               AS_PROJECT.BUDGET.PMAXC = AS_USERS_CONSTANT.BUDGET.PMAXC;
     1254    17577    5               AS_PROJECT.BUDGET.PACCUM = AS_USERS_CONSTANT.BUDGET.PACCUM;
     1255    17578    5               AS_PROJECT.BUDGET.MACCT_ = AS_PROJECT_ADMIN;
     1256    17579    5               AS_PROJECT.BUDGET.MAX_PROJECTS = AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS;
     1257    17580    6               DO I = 0 TO 2;
     1258    17581    6                  AS_PROJECT.PPRIV(I) = AS_PROJECT.PPRIV(I) | %PPR_PADMIN# ;
     1259    17582    6                  END;
     1260    17583    5               AS_PROJECT_DREC = AS_PROJ_ADMIN_DREC;
     1261    17584    5               AS_PROJECT_DREC.PASSWORD = BLANK_PASS;
     1262    17585    5               AS_PROJECT_DFLT = AS_DEFAULT;
     1263    17586    5               AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED = 0;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:43   
     1264    17587    5               AS_PROJECT_DFLT.BUDGET.PROJ_CREATED = 0;
     1265    17588    5               AS_PROJECT_DFLT.BUDGET.SUB_PROJS = AS_USERS_CONSTANT.BUDGET.SUB_PROJS;
     1266    17589    5               AS_PROJECT_DFLT.BUDGET.MACCT_ = CR_MOD_KEY;
     1267    17590    5               AS_PROJECT_DFLT_DREC = AS_DEFAULT_DREC;
     1268    17591    5               AS_PROJECT_DFLT_DREC.PASSWORD = BLANK_PASS;
     1269    17592    5               END;
     1270    17593    5            ELSE DO;
     1271    17594    5               FROM_KEY.CNT = 8 ;
     1272    17595    5               FROM_KEY.TEXT = 'DEFAULTP' ;
     1273    17596    5   FROM_DEFAULT_PROJECT:
     1274    17597    5               FROM_FLG = AS_TRUE;
     1275    17598    5               USERS_KEY = FROM_KEY;
     1276    17599    5               CALL ASB$GET( PROJ_FLAG,,AS_PROJECT, AS_PROJECT_DREC$,
     1277    17600    5                    AS_PROJECT_DFLT, AS_PROJECT_DFLT_DREC$ )
     1278    17601    5                    ALTRET(EXIT#);
     1279    17602    5               END;
     1280    17603    4         END ;   /* Then do */
     1281    17604    3      END;   /* Else do */
     1282    17605
     1283    17606    2   IF AS_PROJECT_DFLT.BUDGET.PMAXC < 0 THEN AS_PROJECT_DFLT.BUDGET.PMAXC = 0;
     1284    17607    3   IF AS_CR_MOD_PROJ > 0 AND FROM_FLG THEN DO;
     1285    17608    3      CALL COMPARE_FROM_TO_MAX( AS_PROJECT, AS_PROJECT_DREC, AS_PROJ_ADMIN,
             17608               AS_PROJ_ADMIN_DREC );
     1286    17609    3      CALL COMPARE_FROM_TO_MAX( AS_PROJECT_DFLT, AS_PROJECT_DFLT_DREC, AS_DEFAULT,
             17609               AS_DEFAULT_DREC );
     1287    17610    3      END;
     1288    17611
     1289    17612    2   USERS_KEY = CR_MOD_KEY ;
     1290    17613    3   IF CREATE OR FROM_FLG THEN DO;
     1291    17614    3      AS_PROJECT.ACCT = SUBSTR( CR_MOD_KEY.TEXT, 0, 8 );
     1292    17615    3      AS_PROJECT.NAME = SUBSTR( CR_MOD_KEY.TEXT, 8, 12 );
     1293    17616    3      AS_PROJECT.BUDGET.MACCT = AS_PROJECT_ADMIN;
     1294    17617    3      AS_PROJECT_DFLT.BUDGET.MACCT = CR_MOD_KEY;
     1295    17618    3      END;
     1296    17619
     1297    17620    2   GET_PROJ_OPTIONS:;                                /*  Process options */
     1298    17621
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:44   
     1299    17622    2   CALL ASA$PROJECT( CR_MOD_KEY );
     1300    17623                                                          /* Write out records
     1301    17624                                                          */
     1302    17625    2   USERS_KEY = CR_MOD_KEY;
     1303    17626    2   IF CREATE AND AS_CR_MOD_PROJ > 0 THEN
     1304    17627    2      CALL ASB$ACCT_OK( USERS_KEY.UKEY.ACCT, AS_PROJECT.HPSN,
     1305    17628    2           AS_PROJECT_ADMIN, AS_FALSE ) ALTRET(EXIT#);
     1306    17629    2   CALL ASB$WRITE_USERS( AS_PROJECT );
     1307    17630    2   IF AS_PROJECT_DREC.AS_PROJECT_DREC_FEBLK.RESL_CNT = 0
     1308    17631    2   THEN
     1309    17632    2      AS_PROJECT_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) ;
     1310    17633    2   ELSE
     1311    17634    2      AS_PROJECT_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) +
     1312    17635    2           AS_PROJECT_DREC.AS_PROJECT_DREC_FEBLK.RESL_CNT - 1    ;
     1313    17636    2   ARS = SIZEC_DREC + ( AS_PROJECT_DREC.NWINFO * 4 ) ;
     1314    17637    2   CALL ASB$WRITE_HLP( AS_PROJECT_DREC$, ARS );
     1315    17638    2   USERS_KEY.COUNT = 21;
     1316    17639    2   USERS_KEY.TEXT(20) = 'S';
     1317    17640    2   CALL ASB$WRITE_USERS( AS_PROJECT_DFLT );
     1318    17641    2   IF AS_PROJECT_DFLT_DREC.AS_PROJECT_DFLT_DREC_FEBLK.RESL_CNT = 0
     1319    17642    2   THEN
     1320    17643    2      AS_PROJECT_DFLT_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) ;
     1321    17644    2   ELSE
     1322    17645    2      AS_PROJECT_DFLT_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) +
     1323    17646    2           AS_PROJECT_DFLT_DREC.AS_PROJECT_DFLT_DREC_FEBLK.RESL_CNT - 1    ;
     1324    17647    2   ARS = SIZEC_DREC + ( AS_PROJECT_DFLT_DREC.NWINFO * 4 ) ;
     1325    17648    2   CALL ASB$WRITE_HLP( AS_PROJECT_DFLT_DREC$, ARS );
     1326    17649    3   IF CREATE THEN DO;
     1327    17650                                                       /* Write special key */
     1328    17651    3      USERS_KEY.SKEY.PROJ = 1;
     1329    17652    3      USERS_KEY.SKEY.CREATOR = AS_PROJECT_ADMIN.TEXT ;
     1330    17653    3      USERS_KEY.SKEY.USER = (SUBSTR(CR_MOD_KEY.TEXT,0,20)) ;
     1331    17654    3      USERS_KEY.COUNT = CR_MOD_KEY.CNT + 21;
     1332    17655    3      CALL ASB$WRITE_USERS_KEY;
     1333    17656    4      IF AS_CR_MOD_PROJ > 0 THEN DO;
     1334    17657    4         IF AS_DEFAULT.BUDGET.SUB_PROJS = AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     1335    17658    5         THEN DO;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:45   
     1336    17659        /*E* ERROR:   ASA-E$MAX_SUB_PROJS-C
     1337    17660        MESSAGE: The maximum number of sub-projects allowed for project "%U1"
     1338    17661                 have now been accumulated.
     1339    17662        */
     1340    17663    5            CALL ASA$KEYCONV( AS_PROJECT_ADMIN, AS_FIELD1 );
     1341    17664                 %SCREAM( ERR#=E$MAX_SUB_PROJS, LEVEL=WARN, MID='A' );
     1342    17679    5            END;
     1343    17680    4         END;
     1344    17681    3      END;
     1345    17682    3   IF AS_CR_MOD_PROJ > 0 THEN DO;
     1346    17683    3      CALL CONCAT( USERS_KEY.TXTC, AS_PROJECT_ADMIN.TEXT, 'S' );
     1347    17684    3      USERS_KEY.COUNT = 21;
     1348    17685    3      CALL ASB$WRITE_USERS( AS_DEFAULT );
     1349    17686    3      END;
     1350    17687    2   RETURN;
     1351    17688        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:46   
     1352    17689    2   MOD_USER_TO_PROJ: ENTRY;
     1353    17690
     1354    17691    2   CREATE = '0'B; CR_MOD_FLG = '1'B;
     1355    17692    2   PROJ_FLAG = '1'B; FROM_FLG = '0'B;
     1356    17693    2   IF AS_PROJECT_ADMIN = AS_NONE THEN
     1357    17694    2      AS_CR_MOD_PROJ = 0;
     1358    17695    3   ELSE DO;
     1359    17696    3      AS_CR_MOD_PROJ = %CR_PROJECT;
     1360    17697    3      USERS_KEY = AS_PROJECT_ADMIN;
     1361    17698    3      CALL ASB$GET( AS_TRUE, , AS_PROJ_ADMIN, AS_PROJ_ADMIN_DREC$,
     1362    17699    3           AS_DEFAULT, AS_DEFAULT_DREC$ ) ALTRET(EXIT#);
     1363    17700    3      END;
     1364    17701
     1365    17702    2   PAR$ = P$NODE.SUBLK$(0);
     1366    17703    2   CALL ASB$KEYMAKER(CR_MOD_KEY, PAR$->P$NODE, AS_FALSE, CODE) ALTRET(EXIT#);
     1367    17704
     1368    17705    2   USERS_KEY = CR_MOD_KEY;
     1369    17706    2   CALL ASB$GET( AS_FALSE, CODE, AS_USERS, KL_DREC$ ) ALTRET(EXIT#);
     1370    17707
     1371    17708    2   CALL CHECK_CREATE_OK(AS_PROJECT_ADMIN) ALTRET(EXIT#);
     1372    17709    2   CALL INITIALIZATIONS  ALTRET(EXIT#);
     1373    17710    2   CALL GET_ACCT_LIST(1) ALTRET(EXIT#);
     1374    17711    2   IF AS_USERS.BUDGET.MACCT ~= AS_NONE THEN
     1375    17712    2      CALL ASA$UNTIE_USER( CR_MOD_KEY, ACCT_COUNT, (AS_PROJECT_ADMIN~=AS_USERS.BUDGET.
             17712               MACCT) );
     1376    17713
     1377    17714    2   AS_PROJECT = AS_USERS;
     1378    17715    2   AS_PROJECT.BUDGET.MACCT = AS_PROJECT_ADMIN;
     1379    17716    2   AS_PROJECT.BUDGET.MAX_PROJECTS = AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS;
     1380    17717    3   DO I = 0 TO SIZEW(AS_PROJECT.PPRIV)-1;
     1381    17718    3      AS_PROJECT.PPRIV(I) = AS_PROJECT.PPRIV(I) | %PPR_PADMIN#;
     1382    17719    3      END;
     1383    17720    2   AS_PROJECT_DFLT = AS_USERS;
     1384    17721    2   AS_PROJECT_DFLT.BUDGET.MACCT = CR_MOD_KEY;
     1385    17722    2   AS_PROJECT_DFLT.BUDGET.ACCUM = 0;
     1386    17723    2   AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED = 0;
     1387    17724    2   AS_PROJECT_DFLT.BUDGET.PROJ_CREATED = 0;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:47   
     1388    17725    2   AS_PROJECT_DFLT.BUDGET.SUB_PROJS = AS_USERS_CONSTANT.BUDGET.SUB_PROJS;
     1389    17726    2   AS_PROJECT_DREC = KL_DREC;
     1390    17727    2   AS_PROJECT_DFLT_DREC = KL_DREC;
     1391    17728    2   USERS_KEY.COUNT = CR_MOD_KEY.CNT + 21;
     1392    17729    2   CALL CONCAT( USERS_KEY.TXTC, BINASC(1), AS_PROJECT_ADMIN.TEXT, (SUBSTR(CR_MOD_KEY.
             17729            TEXT,0,20)) );
     1393    17730    2   CALL ASB$WRITE_USERS_KEY;
     1394    17731    2   AS_PROJECT_DFLT_DREC.PASSWORD = BLANK_PASS;
     1395    17732        /*E*  ERROR:  ASA-E$USER_TO_PROJ-C
     1396    17733              MESSAGE:.. User "%U1" modified to project "%U1".
     1397    17734        */
     1398    17735    2   CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD1 );
     1399    17736        %SCREAM( ERR#=E$USER_TO_PROJ, MID='A', LEVEL=INFO );
     1400    17751
     1401    17752    2   PROJ_KEY = CR_MOD_KEY;
     1402    17753    2   AS$PROJ_HEADER = AS_CONSTANT_PROJ_HEADER;
     1403    17754    2   AS$PROJ.ATTRIBUTES.COUNT = 0;
     1404    17755    2   PROJ_ACCT_LIST$ = PINCRW(DSEG2$, SIZEW(AS$PROJ_HEADER)+1 );
     1405    17756    2   IF AS_PROJECT_ADMIN~=AS_NONE THEN AS$PROJ.CREATOR = AS_PROJECT_ADMIN.TEXT;
     1406    17757    3   IF ACCT_COUNT > 0 THEN DO;
     1407    17758    3      I = 0;
     1408    17759    4      DO WHILE( I < ACCT_COUNT );
     1409    17760    4         PROJ_KEY.TXT.PACKSET = ACCT$LIST.PSN(I);
     1410    17761    4         CALL INDEX( J, AS_BLANK, PROJ_KEY.TEXT, 20 );
     1411    17762    4         PROJ_KEY.COUNT = J;
     1412    17763    4         AS$PROJ.NUM_ACCTS = 0;
     1413    17764    4         AS$PROJ.GRANS_ACCUM = 0;
     1414    17765    5         DO WHILE( I < ACCT_COUNT AND ACCT$LIST.PSN(I) = PROJ_KEY.TXT.PACKSET );
     1415    17766    5            PROJ$LIST.ACCT(AS$PROJ.NUM_ACCTS) = ACCT$LIST.ACCT(I);
     1416    17767    5            PROJ$LIST.GRANS(AS$PROJ.NUM_ACCTS) = ACCT$LIST.GRANS(I);
     1417    17768    5            AS$PROJ.NUM_ACCTS = AS$PROJ.NUM_ACCTS + 1;
     1418    17769    5            AS$PROJ.GRANS_ACCUM = AS$PROJ.GRANS_ACCUM+ACCT$LIST.GRANS(I);
     1419    17770    5            I = I + 1;
     1420    17771    5            END;
     1421    17772    4         AS$PROJ.MAX_NUM_ACCTS = AS$PROJ.NUM_ACCTS;
     1422    17773    4         AS$PROJ.MAX_NUM_GRANS = AS$PROJ.GRANS_ACCUM;
     1423    17774    4         ARS = POFFC(PROJ_ACCT_LIST$,DSEG2$) + SIZEC(PROJ$LIST(0))*AS$PROJ.NUM_ACCTS;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:48   
     1424    17775    4         CALL ASB$WRITE_PROJ( DSEG2$, ARS ) ALTRET(WRITE_ERR1);
     1425    17776    5         DO WHILE( '0'B );
     1426    17777    5   WRITE_ERR1: CALL ASH$ERROR( ERR_CODE );
     1427    17778    5            END;
     1428    17779    4         END;
     1429    17780    3      END;
     1430    17781    3   ELSE DO;
     1431    17782    3      PROJ_KEY.TXT.PACKSET = AS_PROJECT.HPSN;
     1432    17783    3      CALL INDEX( J, AS_BLANK, PROJ_KEY.TEXT, 20 );
     1433    17784    3      PROJ_KEY.COUNT = J;
     1434    17785    3      ARS = POFFC( PROJ_ACCT_LIST$, DSEG2$ );
     1435    17786    3      CALL ASB$WRITE_PROJ( DSEG2$, ARS ) ALTRET( WRITE_ERR2 );
     1436    17787    4      DO WHILE( '0'B );
     1437    17788    4   WRITE_ERR2: CALL ASH$ERROR( ERR_CODE );
     1438    17789    4         END;
     1439    17790    3      END;
     1440    17791
     1441    17792    3   IF AS_PROJECT_ADMIN ~= AS_NONE THEN DO;
     1442    17793    3      CALL GET_PACKSET_LIST  ALTRET(EXIT#);
     1443    17794    3      CALL ASA$TIE_PROJECT( CR_MOD_KEY, AS_PROJECT_ADMIN, PACKSET_COUNT,AS_FALSE );
     1444    17795    3      END;
     1445    17796
     1446    17797    2   GOTO GET_PROJ_OPTIONS;
     1447    17798
     1448    17799        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:49   
     1449    17800    2   MOD_PROJ_TO_USER: ENTRY;
     1450    17801
     1451    17802
     1452    17803    2   CREATE = '0'B; CR_MOD_FLG = '1'B;
     1453    17804    2   PROJ_FLAG = '0'B; FROM_FLG = '0'B;
     1454    17805    2   IF AS_PROJECT_ADMIN = AS_NONE THEN
     1455    17806    2      AS_CR_MOD_PROJ = 0;
     1456    17807    3   ELSE DO;
     1457    17808    3      AS_CR_MOD_PROJ = %CR_PROJ_USER;
     1458    17809    3      USERS_KEY = AS_PROJECT_ADMIN;
     1459    17810    3      CALL ASB$GET( AS_TRUE, , AS_PROJ_ADMIN, AS_PROJ_ADMIN_DREC$,
     1460    17811    3           AS_DEFAULT, AS_DEFAULT_DREC$ ) ALTRET(EXIT#);
     1461    17812    3      END;
     1462    17813
     1463    17814    2   PAR$ = P$NODE.SUBLK$(0);
     1464    17815    2   CALL ASB$KEYMAKER(CR_MOD_KEY, PAR$->P$NODE, PROJ_FLAG, CODE) ALTRET(EXIT#);
     1465    17816
     1466    17817    2   USERS_KEY = CR_MOD_KEY;
     1467    17818    2   CALL ASB$GET( AS_TRUE, CODE, AS_PROJECT, AS_PROJECT_DREC$,
     1468    17819    2        AS_PROJECT_DFLT, AS_PROJECT_DFLT_DREC$ ) ALTRET(EXIT#);
     1469    17820
     1470    17821    3   IF AS_PROJECT_DFLT.BUDGET.PROJ_CREATED > 0 THEN DO;
     1471    17822        /*E*  ERROR:  ASA-E$STILL_USERS-C
     1472    17823              MESSAGE: There are still %U1 users in project "%U2".
     1473    17824              MESSAGE1: Project "%U2" cannot be modified to a user while
     1474    17825                        there are still users remaining in the project.
     1475    17826        */
     1476    17827           %NUMBER( NUM1="AS_PROJECT_DFLT.BUDGET.PROJ_CREATED", SIGN1=YES );
             17837    3         CALL ASB$BINXCHAR( AS_FIELD1.TEXT, 0, -1, AS_PROJECT_DFLT.BUDGET.PROJ_CREATED
             17837                  );
     1477    17857    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD2 );
     1478    17858           %SCREAM( ERR#=E$STILL_USERS, LEVEL=ERROR, MID='A' );
     1479    17873    3      RETURN;
     1480    17874    3      END;
     1481    17875    3   IF AS_PROJECT_DFLT.BUDGET.SUB_PROJS > 0 THEN DO;
     1482    17876        /*E*  ERROR:  ASA-E$STILL_SUB_PROJS-C
     1483    17877              MESSAGE: There are still %U1 sub-projects in project "%U2".
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:50   
     1484    17878              MESSAGE1: Project "%U2" cannot be modified to a user while
     1485    17879                        there are still sub-projects remaining in the project.
     1486    17880        */
     1487    17881    3      I = AS_PROJECT_DFLT.BUDGET.SUB_PROJS;
     1488    17882           %NUMBER( NUM1=I, SIGN1=YES );
             17892    3         CALL ASB$BINXCHAR( AS_FIELD1.TEXT, 0, -1, I );
     1489    17912    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD2 );
     1490    17913           %SCREAM( ERR#=E$STILL_SUB_PROJS, LEVEL=ERROR, MID='A' );
     1491    17928    3      RETURN;
     1492    17929    3      END;
     1493    17930
     1494    17931    2   AS_DFLT = AS_DEFAULT;
     1495    17932    2   CALL CHECK_CREATE_OK(AS_PROJECT_ADMIN) ALTRET(EXIT#);
     1496    17933    2   CALL INITIALIZATIONS  ALTRET(EXIT#);
     1497    17934    2   CALL GET_PACKSET_LIST  ALTRET(EXIT#);
     1498    17935
     1499    17936    2   IF AS_PROJECT.BUDGET.MACCT ~= AS_NONE THEN
     1500    17937    2      CALL ASA$UNTIE_PROJECT( CR_MOD_KEY, PACKSET_COUNT, (AS_PROJECT_ADMIN~=AS_PROJECT.
             17937               BUDGET.MACCT) );
     1501    17938    3   ELSE DO;
     1502    17939    3      USERS_KEY.COUNT = 21 + CR_MOD_KEY.CNT;
     1503    17940    3      CALL CONCAT(USERS_KEY.TXTC, BINASC(1), AS_NONE.TEXT, (SUBSTR(CR_MOD_KEY.TEXT,0,20
             17940               )));
     1504    17941    3      CALL ASB$DELREC_USERS;
     1505    17942    3      END;
     1506    17943
     1507    17944    2   AS_USERS                     = AS_PROJECT;
     1508    17945    2   AS_USERS.BUDGET.MACCT        = AS_PROJECT_ADMIN;
     1509    17946    2   AS_USERS.BUDGET.PMAXC        = AS_USERS_CONSTANT.BUDGET.PMAXC;
     1510    17947    2   AS_USERS.BUDGET.PACCUM       = AS_USERS_CONSTANT.BUDGET.PACCUM;
     1511    17948    2   AS_USERS.BUDGET.MAX_PROJECTS = AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS;
     1512    17949    3   DO I = 0 TO SIZEW(AS_USERS.PPRIV)-1;
     1513    17950    3      AS_USERS.PPRIV(I) = AS_USERS.PPRIV(I) & ~%PPR_PADMIN#;
     1514    17951    3      END;
     1515    17952        /*E*  ERROR:  ASA-E$PROJ_TO_USER-C
     1516    17953              MESSAGE:.. Project "%U1" modified to user "%U1".
     1517    17954        */
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:51   
     1518    17955    2   CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD1 );
     1519    17956        %SCREAM( ERR#=E$PROJ_TO_USER, MID='A', LEVEL=INFO );
     1520    17971
     1521    17972    3   IF AS_PROJECT_ADMIN ~= AS_NONE THEN DO;
     1522    17973    3      PROJ_KEY = CR_MOD_KEY;
     1523    17974    3      CALL ASB$PREC_PROJ;
     1524    17975    3      ACCT_COUNT = 0;
     1525    17976    3      ARS = DSEG2SIZE;
     1526    17977    3      CALL ASB$READ_PROJ_SEQ( DSEG2$, ARS, 2 ) ALTRET(DONE);
     1527    17978    4      DO WHILE( PROJ_KEY.TXT.PROJECT = (SUBSTR(CR_MOD_KEY.TEXT,0,20)) );
     1528    17979    4         PROJ_ACCT_LIST$ = PINCRW( ADDR(AS$PROJ.ATTRIBUTES),
     1529    17980    4              (AS$PROJ.ATTRIBUTES.COUNT+5) / 4 );
     1530    17981    5         DO J = 0 TO AS$PROJ.NUM_ACCTS-1;
     1531    17982    5            ACCT$LIST.PSN(ACCT_COUNT) = SUBSTR(PROJ_KEY.TXT.PACKSET,0,PROJ_KEY.COUNT-20
             17982                     );
     1532    17983    5            ACCT$LIST.ACCT(ACCT_COUNT) = PROJ$LIST.ACCT(J);
     1533    17984    5            ACCT$LIST.GRANS(ACCT_COUNT) = PROJ$LIST.GRANS(J);
     1534    17985    5            ACCT_COUNT = ACCT_COUNT + 1;
     1535    17986    5            END;
     1536    17987    4         ARS = DSEG2SIZE;
     1537    17988    4         CALL ASB$READ_PROJ_SEQ( DSEG2$, ARS, 2 ) ALTRET(DONE);
     1538    17989    4         END;
     1539    17990    3   DONE: AS_DFLT = AS_DEFAULT;
     1540    17991    3      KL_DFLT = AS_DEFAULT_DREC;
     1541    17992    3      CALL ASA$TIE_USER( CR_MOD_KEY, AS_PROJECT_ADMIN, ACCT_COUNT,AS_FALSE);
     1542    17993    3      END;
     1543    17994    3   ELSE DO;
     1544    17995    3      USERS_KEY.COUNT = 21;
     1545    17996    3      CALL CONCAT( USERS_KEY.TXTC, (SUBSTR(CR_MOD_KEY.TEXT,0,20)), 'S' );
     1546    17997    3      CALL ASB$DELREC_USERS;
     1547    17998    3      PROJ_KEY = CR_MOD_KEY;
     1548    17999    4      DO I = 0 TO PACKSET_COUNT-1;
     1549    18000    4         PROJ_KEY.TXT.PACKSET = PACKSET$LIST.PSN(I);
     1550    18001    4         CALL INDEX( J, AS_BLANK, PROJ_KEY.TEXT, 20 );
     1551    18002    4         PROJ_KEY.COUNT = J;
     1552    18003    4         CALL ASB$DELREC_PROJ;
     1553    18004    4         END;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:52   
     1554    18005    3      END;
     1555    18006
     1556    18007    2   GOTO GET_USER_OPTIONS;
     1557    18008
     1558    18009        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:53   
     1559    18010    2   UNTIE_USER: ENTRY;
     1560    18011
     1561    18012
     1562    18013    2   CREATE = '0'B; PROJ_FLAG = '0'B;
     1563    18014    2   PAR$ = P$NODE.SUBLK$(0);
     1564    18015    2   CALL ASB$KEYMAKER(CR_MOD_KEY, PAR$->P$NODE, AS_FALSE, CODE) ALTRET(EXIT#);
     1565    18016    2   USERS_KEY = CR_MOD_KEY;
     1566    18017    2   CALL ASB$GET(AS_FALSE, CODE, AS_USERS) ALTRET(EXIT#);
     1567    18018    3   IF AS_USERS.BUDGET.MACCT = AS_NONE THEN DO;
     1568    18019        /*E*  ERROR:  ASA-E$NOT_PROJ_USER-C
     1569    18020              MESSAGE: "%U1" is not a member of a project.
     1570    18021              MESSAGE1: Only members of a project can be UNTIEd.
     1571    18022                        "%U1" is not a member of a project.
     1572    18023        */
     1573    18024    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD1 );
     1574    18025           %SCREAM( ERR#=E$NOT_PROJ_USER, MID='A', LEVEL=ERROR );
     1575    18040    3      RETURN;
     1576    18041    3      END;
     1577    18042    3   IF AS_USERS.BUDGET.MACCT = AS_PROJECT_ADMIN THEN DO;
     1578    18043    3      CALL ASA$ERROR( CR_MOD_KEY, 392 /* Proj admin cant UNTIE from his proj */,
             18043               AS_FALSE );
     1579    18044    3      RETURN;
     1580    18045    3      END;
     1581    18046    3   IF AS_PROJECT_ADMIN ~= AS_NONE THEN DO;
     1582    18047    3      CALL CONCAT( USERS_KEY.TXTC, AS_PROJECT_ADMIN.TEXT, 'S' );
     1583    18048    3      USERS_KEY.COUNT = 21;
     1584    18049    3      CALL ASB$GET( AS_FALSE, ,AS_DFLT ) ALTRET(EXIT#);
     1585    18050    3      CALL CHECK_CREATE_OK(AS_PROJECT_ADMIN) ALTRET(EXIT#);
     1586    18051    3      END;
     1587    18052    2   CALL INITIALIZATIONS ALTRET( EXIT# );
     1588    18053    2   CALL GET_ACCT_LIST(1) ALTRET(EXIT#);
     1589    18054    2   USERS_KEY = AS_USERS.BUDGET.MACCT;
     1590    18055    2   CALL ASB$GET(AS_TRUE,,AS_PROJ_ADMIN,,AS_DEFAULT) ALTRET(EXIT#);
     1591    18056    2   CALL ASA$UNTIE_USER( CR_MOD_KEY, ACCT_COUNT, AS_TRUE );
     1592    18057    2   IF AS_PROJECT_ADMIN ~= AS_NONE THEN
     1593    18058    2      CALL ASA$TIE_USER( CR_MOD_KEY, AS_PROJECT_ADMIN, ACCT_COUNT, AS_FALSE );
     1594    18059    3   ELSE DO;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:54   
     1595    18060    3      USERS_KEY = CR_MOD_KEY;
     1596    18061    3      CALL ASB$WRITE_USERS( AS_USERS );
     1597    18062    3      END;
     1598    18063    2   IF ACCT_COUNT > 0 THEN CALL ASB$DEQ_PROJ;
     1599    18064    2   RETURN;
     1600    18065
     1601    18066        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:55   
     1602    18067    2   UNTIE_PROJ: ENTRY;
     1603    18068
     1604    18069
     1605    18070    2   CREATE = '0'B; PROJ_FLAG = '1'B;
     1606    18071    2   PAR$ = P$NODE.SUBLK$(0);
     1607    18072    2   CALL ASB$KEYMAKER(CR_MOD_KEY, PAR$->P$NODE, AS_TRUE, CODE) ALTRET(EXIT#);
     1608    18073    2   USERS_KEY = CR_MOD_KEY;
     1609    18074    2   CALL ASB$GET(AS_TRUE,CODE,AS_PROJECT,,AS_PROJECT_DFLT) ALTRET(EXIT#);
     1610    18075    3   IF AS_PROJECT.BUDGET.MACCT = AS_NONE THEN DO;
     1611    18076        /*E*  ERROR:  ASA-E$NOT_SUB_PROJ-C
     1612    18077              MESSAGE: "%U1" is not a sub-project.
     1613    18078              MESSAGE1: Only sub-projects can be UNTIEd.
     1614    18079                        "%U1" is not a sub-project of another project.
     1615    18080        */
     1616    18081    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD1 );
     1617    18082           %SCREAM( ERR#=E$NOT_SUB_PROJ, MID='A', LEVEL=ERROR );
     1618    18097    3      RETURN;
     1619    18098    3      END;
     1620    18099    3   IF AS_PROJECT.BUDGET.MACCT = AS_PROJECT_ADMIN THEN DO;
     1621    18100    3      CALL ASA$ERROR( CR_MOD_KEY, 392 /* Proj admin cant UNTIE from his proj */,
             18100               AS_TRUE );
     1622    18101    3      RETURN;
     1623    18102    3      END;
     1624    18103    3   IF AS_PROJECT_ADMIN ~= AS_NONE THEN DO;
     1625    18104    3      USERS_KEY = AS_PROJECT_ADMIN;
     1626    18105    3      CALL ASB$GET( AS_TRUE, , AS_PROJ_ADMIN, , AS_DEFAULT ) ALTRET(EXIT#);
     1627    18106    3      CALL CHECK_CREATE_OK(AS_PROJECT_ADMIN) ALTRET(EXIT#);
     1628    18107    3      END;
     1629    18108    2   CALL INITIALIZATIONS ALTRET( EXIT# );
     1630    18109    2   CALL GET_PACKSET_LIST  ALTRET(EXIT#);
     1631    18110    2   USERS_KEY = AS_PROJECT.BUDGET.MACCT;
     1632    18111    2   CALL ASB$GET(AS_TRUE,,AS_PROJ_ADMIN,,AS_DEFAULT) ALTRET(EXIT#);
     1633    18112    2   CALL ASA$UNTIE_PROJECT( CR_MOD_KEY, PACKSET_COUNT, AS_TRUE );
     1634    18113    2   IF AS_PROJECT_ADMIN ~= AS_NONE THEN
     1635    18114    2      CALL ASA$TIE_PROJECT( CR_MOD_KEY, AS_PROJECT_ADMIN, PACKSET_COUNT, AS_FALSE );
     1636    18115    3   ELSE DO;
     1637    18116    3      USERS_KEY = CR_MOD_KEY;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:56   
     1638    18117    3      CALL ASB$WRITE_USERS( AS_PROJECT );
     1639    18118    3      USERS_KEY.COUNT = 21;
     1640    18119    3      USERS_KEY.UKEY.S = 'S';
     1641    18120    3      CALL ASB$WRITE_USERS( AS_PROJECT_DFLT );
     1642    18121    3      USERS_KEY.SKEY.PROJ = 1;
     1643    18122    3      USERS_KEY.SKEY.CREATOR = AS_PROJECT_ADMIN.TEXT;
     1644    18123    3      USERS_KEY.SKEY.USER = (SUBSTR(CR_MOD_KEY.TEXT,0,20));
     1645    18124    3      USERS_KEY.COUNT = CR_MOD_KEY.CNT + 21;
     1646    18125    3      CALL ASB$WRITE_USERS_KEY;
     1647    18126    3      END;
     1648    18127    3   IF PACKSET_COUNT > 0 THEN DO;
     1649    18128    3      PROJ_KEY = CR_MOD_KEY;
     1650    18129    3      CALL ASB$PREC_PROJ;
     1651    18130    4      DO I = 1 TO PACKSET_COUNT;
     1652    18131    4         CALL ASB$READ_PROJ_SEQ( DSEG2$, ARS, 2 ) ALTRET(IO_ERR);
     1653    18132    4         IF AS_PROJECT_ADMIN = AS_NONE THEN
     1654    18133    4            AS$PROJ.CREATOR = AS_BLANK;
     1655    18134    4         ELSE
     1656    18135    4            AS$PROJ.CREATOR = AS_PROJECT_ADMIN.TEXT;
     1657    18136    4         CALL ASB$WRITE_PROJ( DSEG2$, ARS ) ALTRET(IO_ERR);
     1658    18137    5         DO WHILE('0'B);
     1659    18138    5   IO_ERR:  CALL ASH$ERROR( ERR_CODE );
     1660    18139    5            END;
     1661    18140    4         END;
     1662    18141    3      CALL ASB$DEQ_PROJ;
     1663    18142    3      END;
     1664    18143    2   RETURN;
     1665    18144
     1666    18145        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:57   
     1667    18146    2   TIE_USER: ENTRY;
     1668    18147
     1669    18148
     1670    18149    2   CREATE = '0'B; PROJ_FLAG = '0'B;
     1671    18150    2   PAR$ = P$NODE.SUBLK$(0);
     1672    18151    2   CALL ASB$KEYMAKER( CR_MOD_KEY, PAR$->P$NODE, AS_FALSE, CODE) ALTRET(EXIT#);
     1673    18152    2   USERS_KEY = CR_MOD_KEY;
     1674    18153    2   CALL ASB$GET( AS_FALSE, CODE, AS_USERS ) ALTRET(EXIT#);
     1675    18154
     1676    18155    2   PAR$ = P$NODE.SUBLK$(1);
     1677    18156    2   CALL ASB$KEYMAKER( FROM_KEY,PAR$->P$NODE,AS_TRUE,21   /*  FROM_VAL */) ALTRET(EXIT#)
             18156            ;
     1678    18157    3   IF AS_USERS.BUDGET.MACCT = FROM_KEY THEN DO;
     1679    18158        /*E*  ERROR:  ASA-E$USER_ALREADY_TIED-C
     1680    18159              MESSAGE: User "%U1" is already tied to project "%U2".
     1681    18160        */
     1682    18161    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD1 );
     1683    18162    3      CALL ASA$KEYCONV( FROM_KEY,   AS_FIELD2 );
     1684    18163           %SCREAM( ERR#=E$USER_ALREADY_TIED, LEVEL=ERROR, MID='A' );
     1685    18178    3      RETURN;
     1686    18179    3      END;
     1687    18180    2   CALL CONCAT( USERS_KEY.TXTC, FROM_KEY.TEXT, 'S' );
     1688    18181    2   USERS_KEY.COUNT = 21;
     1689    18182    2   CALL ASB$GET( AS_FALSE, , AS_DFLT ) ALTRET(EXIT#);
     1690    18183
     1691    18184    2   CALL CHECK_CREATE_OK(FROM_KEY) ALTRET(EXIT#);
     1692    18185    2   PROJ_KEY = FROM_KEY;
     1693    18186    2   PROJ_KEY.TXT.PACKSET = AS_USERS.HPSN;
     1694    18187    2   CALL INDEX( I, AS_BLANK, PROJ_KEY.TEXT, 20 );
     1695    18188    2   PROJ_KEY.COUNT = I;
     1696    18189    2   CALL ASB$PREC_PROJ ALTRET(NO_PROJ_REC);
     1697    18190    3   DO WHILE('0'B);
     1698    18191        /*E*  ERROR:  ASA-E$NO_PROJ_REC_FOR_HSET-C
     1699    18192              MESSAGE: HSET = %U1 for "%U2", but packset DP#%U1 does not exist for
     1700    18193                       project "%U3".
     1701    18194        */
     1702    18195    3   NO_PROJ_REC:
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:58   
     1703    18196    3      AS_FIELD1.COUNT = I - 20;
     1704    18197    3      AS_FIELD1.TEXT = AS_USERS.HPSN;
     1705    18198    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD2 );
     1706    18199    3      CALL ASA$KEYCONV( FROM_KEY, AS_FIELD3 );
     1707    18200           %SCREAM( ERR#=E$NO_PROJ_REC_FOR_HSET, LEVEL=ERROR, MID='A' );
     1708    18215    3      RETURN;
     1709    18216    3      END;
     1710    18217    2   CALL INITIALIZATIONS ALTRET(EXIT#);
     1711    18218    2   IF AS_PROJECT_ADMIN = AS_NONE THEN
     1712    18219    2      CALL ASB$ACCT_OK( AS_USERS.ACCT, AS_USERS.HPSN, FROM_KEY ) ALTRET(EXIT#);
     1713    18220    2   CALL GET_ACCT_LIST(2) ALTRET(EXIT#);
     1714    18221    3   IF AS_USERS.BUDGET.MACCT ~= AS_NONE THEN DO;
     1715    18222    3      USERS_KEY = AS_USERS.BUDGET.MACCT;
     1716    18223    3      CALL ASB$GET(AS_TRUE,,AS_PROJ_ADMIN,,AS_DEFAULT) ALTRET(EXIT#);
     1717    18224    3      CALL ASA$UNTIE_USER( CR_MOD_KEY, ACCT_COUNT, (AS_PROJECT_ADMIN~=AS_USERS.BUDGET.
             18224               MACCT) );
     1718    18225    3      END;
     1719    18226    2   CALL ASA$TIE_USER( CR_MOD_KEY, FROM_KEY, ACCT_COUNT, AS_TRUE );
     1720    18227    2   IF ACCT_COUNT > 0 THEN CALL ASB$DEQ_PROJ;
     1721    18228    2   RETURN;
     1722    18229        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:59   
     1723    18230    2   TIE_PROJ: ENTRY;
     1724    18231
     1725    18232
     1726    18233    2   CREATE = %NO#; PROJ_FLAG = %YES#;
     1727    18234    2   PAR$ = P$NODE.SUBLK$(0);
     1728    18235    2   CALL ASB$KEYMAKER( CR_MOD_KEY, PAR$->P$NODE, AS_TRUE, CODE) ALTRET(EXIT#);
     1729    18236    2   USERS_KEY = CR_MOD_KEY;
     1730    18237    2   CALL ASB$GET( AS_TRUE, CODE, AS_PROJECT,,AS_PROJECT_DFLT ) ALTRET(EXIT#);
     1731    18238
     1732    18239    2   PAR$ = P$NODE.SUBLK$(1);
     1733    18240    2   CALL ASB$KEYMAKER( FROM_KEY,PAR$->P$NODE,AS_TRUE,21   /*  FROM_VAL */) ALTRET(EXIT#)
             18240            ;
     1734    18241    3   IF AS_PROJECT.BUDGET.MACCT = FROM_KEY THEN DO;
     1735    18242        /*E*  ERROR:  ASA-E$PROJ_ALREADY_TIED-C
     1736    18243              MESSAGE: Project "%U1" is already tied to project "%U2".
     1737    18244        */
     1738    18245    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD1 );
     1739    18246    3      CALL ASA$KEYCONV( FROM_KEY,   AS_FIELD2 );
     1740    18247           %SCREAM( ERR#=E$PROJ_ALREADY_TIED, LEVEL=ERROR, MID='A' );
     1741    18262    3      RETURN;
     1742    18263    3      END;
     1743    18264
     1744    18265    2   USERS_KEY = FROM_KEY;
     1745    18266    2   CALL ASB$GET(AS_TRUE,,AS_PROJ_ADMIN,AS_PROJ_ADMIN_DREC$,AS_DEFAULT,
     1746    18267    2        AS_DEFAULT_DREC$ ) ALTRET(EXIT#);
     1747    18268
     1748    18269    2   CALL CHECK_CREATE_OK(FROM_KEY) ALTRET(EXIT#);
     1749    18270    2   CALL INITIALIZATIONS  ALTRET(EXIT#);
     1750    18271    2   CALL GET_PACKSET_LIST ALTRET(EXIT#);
     1751    18272
     1752    18273    3   IF AS_PROJECT.BUDGET.MACCT ~= AS_NONE THEN DO;
     1753    18274    3      AS_USERS = AS_PROJ_ADMIN;
     1754    18275    3      AS_DFLT  = AS_DEFAULT;
     1755    18276    3      USERS_KEY = AS_PROJECT.BUDGET.MACCT;
     1756    18277    3      CALL ASB$GET(AS_TRUE,,AS_PROJ_ADMIN,,AS_DEFAULT) ALTRET(EXIT#);
     1757    18278    3      CALL ASA$UNTIE_PROJECT( CR_MOD_KEY, PACKSET_COUNT, (AS_PROJECT_ADMIN~=AS_PROJECT.
             18278               BUDGET.MACCT) );
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:60   
     1758    18279    3      AS_PROJ_ADMIN = AS_USERS;
     1759    18280    3      AS_DEFAULT    = AS_DFLT;
     1760    18281    3      END;
     1761    18282    3   ELSE DO;
     1762    18283    3      USERS_KEY.COUNT = 21 + CR_MOD_KEY.CNT;
     1763    18284    3      CALL CONCAT(USERS_KEY.TXTC, BINASC(1), AS_NONE.TEXT, (SUBSTR(CR_MOD_KEY.TEXT,0,20
             18284               )));
     1764    18285    3      CALL ASB$DELREC_USERS;
     1765    18286    3      END;
     1766    18287
     1767    18288    2   CALL ASA$TIE_PROJECT( CR_MOD_KEY, FROM_KEY, PACKSET_COUNT, AS_TRUE );
     1768    18289    3   IF PACKSET_COUNT > 0 THEN DO;
     1769    18290    3      PROJ_KEY = CR_MOD_KEY;
     1770    18291    3      CALL ASB$PREC_PROJ;
     1771    18292    4      DO I = 1 TO PACKSET_COUNT;
     1772    18293    4         CALL ASB$READ_PROJ_SEQ( DSEG2$, ARS, 2 ) ALTRET(IO_ERR2);
     1773    18294    4         AS$PROJ.CREATOR = FROM_KEY.TEXT;
     1774    18295    4         CALL ASB$WRITE_PROJ( DSEG2$, ARS ) ALTRET(IO_ERR2);
     1775    18296    5         DO WHILE('0'B);
     1776    18297    5   IO_ERR2: CALL ASH$ERROR( ERR_CODE );
     1777    18298    5            END;
     1778    18299    4         END;
     1779    18300    3      CALL ASB$DEQ_PROJ;
     1780    18301    3      END;
     1781    18302    2   RETURN;
     1782    18303        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:61   
     1783    18304    2   PARSE_CMD: PROC( NODE ) ALTRET;
     1784    18305
     1785    18306    3   DCL NODE UBIN;
     1786    18307
     1787    18308    4   IF ADDR(NODE) ~= ADDR(NIL) THEN DO;
     1788    18309    4      P_PCB.ROOT$ = ADDR( NODE );
     1789    18310    4      CALL X$PARSE( P_PCB )       ALTRET( PARSE_ERR );
     1790    18311    4      END;
     1791    18312    3   NODE$ = P_PCB.OUT$;
     1792    18313    3   TYPE = P$NODE.SUBLK$(0) -> P$NODE.CODE;
     1793    18314    3   CREATE = ( TYPE = 35   /*  CREATE_VAL */ );
     1794    18315    3   CR_MOD_FLG = ~CREATE;         /* Create ='0'b  modify = '1'b */
     1795    18316    3   RETURN;
     1796    18317
     1797    18318    3   PARSE_ERR:
     1798    18319    3   CALL ASH$ERROR( P_PCB.ERROR );
     1799    18320    3   ALTRETURN;
     1800    18321
     1801    18322    3   END PARSE_CMD;
     1802    18323        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:62   
     1803    18324    2   INITIALIZATIONS: PROC ALTRET;
     1804    18325
     1805    18326    3   IF NOT DSEG_FLG THEN
     1806    18327    3      CALL ASB$GETSEG
     1807    18328    4      WHENALTRETURN DO;
     1808    18329              %SCREAM (ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='A');
     1809    18344    4         ALTRETURN;
     1810    18345    4         END;   /*  Whenaltreturn from ASB$GETSEG  */
     1811    18346    4   IF AS_RESOURCE_LIST$ = ADDR(NIL) THEN DO;
     1812    18347    4      AS_RESOURCE_LIST$ = DSEG1$;
     1813    18348    4      AS_FERESOURCE_LIST$ = PINCRW( DSEG1$, 500 );
     1814    18349    4      AS_PSEUDO_LIST$ = PINCRW( DSEG1$, 2000 );
     1815    18350    4      AS_FEPSEUDO_LIST$ = PINCRW( DSEG1$, 2500 );
     1816    18351    4      AS_SUPER_TO_PIG$ = DSEG2$;
     1817    18352    4      AS_PROJ_HEADER$ = PINCRW( DSEG2$, 1500 );
     1818    18353    4      END;
     1819    18354    4   IF CODE = 27   /*  CR_MOD_ACCT_VAL */ OR CODE = 52 /* CR_MOD_PROJ_VAL */ THEN DO;
     1820    18355                                            /* Initialize message to pig */
     1821    18356    4      SUPER_TO_PIG.PROJ = ( AS_CR_MOD_PROJ > 0 );
     1822    18357    4      SUPER_TO_PIG.RESUPER = AS_LOGON_KEY.TEXT;
     1823    18358    4      SUPER_TO_PIG.WIDTH = LO_WIDTH;
     1824    18359    4      SUPER_TO_PIG.PROJECT_TEXT = AS_PROJECT_ADMIN.TEXT;
     1825    18360    4      SUPER_TO_PIG.ACCT = (SUBSTR(CR_MOD_KEY.TEXT,0,20));
     1826    18361    4      SUPER_TO_PIG.ATTR.COUNT = 0;
     1827    18362    4      END;
     1828    18363    3   RETURN;
     1829    18364
     1830    18365
     1831    18366    3   END INITIALIZATIONS;
     1832    18367        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:63   
     1833    18368    2   CHECK_CREATE_OK: PROC(PROJECT) ALTRET;
     1834    18369
     1835    18370    3   DCL 1 PROJECT ALIGNED,
     1836    18371    3          2 COUNT UBIN BYTE UNAL,
     1837    18372    3          2 TEXT CHAR(20) UNAL;
     1838    18373
     1839    18374
     1840    18375
     1841    18376    4   IF CREATE THEN DO;
     1842    18377    4      CALL ASB$READ_USERS(AS_USERS)  ALTRET(CREATE_OK) ;
     1843    18378    4      ARS = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;
     1844    18379    4      CALL ASB$READ_HLP  (KL_DREC$,ARS)  ALTRET(CREATE_OK);
     1845    18380    4      IF PROJ_FLAG  AND  (AS_USERS.PPRIV(0) & %PPR_PADMIN#) = %PPR_PADMIN#
     1846    18381    5      THEN DO;
     1847    18382    5         USERS_KEY.COUNT = 21;
     1848    18383    5         USERS_KEY.TEXT(20) = 'S';
     1849    18384    5         CALL ASB$READ_USERS(AS_PROJECT_DFLT) ALTRET(CREATE_OK);
     1850    18385    5         ARS = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;
     1851    18386    5         CALL ASB$READ_HLP  (AS_PROJECT_DFLT_DREC$,ARS) ALTRET(CREATE_OK);
     1852    18387    5         END;
     1853    18388                                                    /*   Create acct. Exists    */
     1854    18389    4      IF (PROJ_FLAG  \ (AS_USERS.PPRIV(0) & %PPR_PADMIN#) = '0'B)
     1855    18390    4      THEN CALL ASA$ERROR( CR_MOD_KEY, 3 /* RECORD ALREADY EXISTS */, PROJ_FLAG );
     1856    18391    4      ELSE CALL ASA$ERROR( CR_MOD_KEY, 313 /* EXISTS AND IS NOT ? */, PROJ_FLAG );
     1857    18392    4      ALTRETURN ;
     1858    18393    4      END;
     1859    18394    3   CREATE_OK:
     1860    18395    3   IF PROJECT ~= AS_NONE THEN
     1861    18396    3      IF PROJ_FLAG
     1862    18397    4      THEN DO SELECT( CODE );
     1863    18398    4         SELECT( 68 /* TIE_PROJ_VAL */, 66 /* UNTIE_PROJ_VAL */ );
     1864    18399    4         IF (AS_DEFAULT.BUDGET.SUB_PROJS + AS_PROJECT_DFLT.BUDGET.SUB_PROJS + 1)
     1865    18400    4              > AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     1866    18401    5         THEN DO;
     1867    18402        /*E*  ERROR:  ASA-E$PROJ_LIMIT_EXCEEDED-C
     1868    18403              MESSAGE: Sub-project limit exceeded for project "%U1".
     1869    18404        */
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:64   
     1870    18405    5            CALL ASA$KEYCONV( PROJECT, AS_FIELD1 );
     1871    18406                 %SCREAM(ERR#=E$PROJ_LIMIT_EXCEEDED,MID='A',LEVEL=ERROR);
     1872    18421    5            ALTRETURN;
     1873    18422    5            END;
     1874    18423    4         IF (AS_DEFAULT.BUDGET.PROJ_CREATED + AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED)
     1875    18424    4              > AS_DEFAULT.BUDGET.PROJ_ALLOWED
     1876    18425    5         THEN DO;
     1877    18426        /*E*  ERROR:  ASA-E$LOGON_LIMIT_EXCEEDED-C
     1878    18427              MESSAGE: Logon account limit exceeded for project "%U1".
     1879    18428        */
     1880    18429    5            CALL ASA$KEYCONV( PROJECT, AS_FIELD1 );
     1881    18430                 %SCREAM(ERR#=E$LOGON_LIMIT_EXCEEDED,MID='A',LEVEL=ERROR);
     1882    18445    5            ALTRETURN;
     1883    18446    5            END;
     1884    18447    4         SELECT(ELSE);
     1885    18448    4      IF AS_DEFAULT.BUDGET.SUB_PROJS >= AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     1886    18449    5      THEN DO;
     1887    18450        /*E* ERROR:   ASA-E$TOO_MANY_SUB_PROJS-C
     1888    18451        MESSAGE: You are not allowed to create another sub-project for project "%U2".
     1889    18452        MESSAGE1: Project "%U2" can have at most %U1 sub-projects. You cannot
     1890    18453                  create another sub-project for project "%U2".
     1891    18454        */
     1892    18455    5         I = AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS;
     1893    18456              %NUMBER( NUM1=I );
             18464    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, I );
     1894    18486    5         CALL ASA$KEYCONV( PROJECT, AS_FIELD2 );
     1895    18487              %SCREAM( ERR#=E$TOO_MANY_SUB_PROJS, LEVEL=ERROR, MID='A' );
     1896    18502    5         ALTRETURN;
     1897    18503    5         END;
     1898    18504                                    /* Increment number of projects created */
     1899    18505    4      IF CODE ~= 69 /* MOD_USER_TO_PROJ_VAL */
     1900    18506    4      THEN AS_DEFAULT.BUDGET.SUB_PROJS = AS_DEFAULT.BUDGET.SUB_PROJS+1;
     1901    18507    4         END;
     1902    18508    4      ELSE DO;
     1903    18509    4         IF AS_DFLT.BUDGET.PROJ_CREATED >= AS_DFLT.BUDGET.PROJ_ALLOWED
     1904    18510    5         THEN DO;
     1905    18511        /*E* ERROR:   ASA-E$TOO_MANY_PROJ_USERS-C
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:65   
     1906    18512        MESSAGE: You are not allowed to create another user for project "%U2".
     1907    18513        MESSAGE1: Project "%U2" can have at most %U1 users. You cannot create
     1908    18514                  another user for project "%U2".
     1909    18515        */
     1910    18516                 %NUMBER( NUM1=AS_DFLT.BUDGET.PROJ_CREATED, SIGN1 = YES );
             18526    5         CALL ASB$BINXCHAR( AS_FIELD1.TEXT, 0, -1, AS_DFLT.BUDGET.PROJ_CREATED );
     1911    18546    5            CALL ASA$KEYCONV( PROJECT, AS_FIELD2 );
     1912    18547                 %SCREAM( ERR#=E$TOO_MANY_PROJ_USERS, LEVEL=ERROR, MID='A' );
     1913    18562    5            ALTRETURN;
     1914    18563    5            END;
     1915    18564    4         END;
     1916    18565
     1917    18566
     1918    18567    3   END CHECK_CREATE_OK;
     1919    18568        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:66   
     1920    18569    2   GET_FIRST: PROC ALTRET;
     1921    18570
     1922    18571    3   CALL ASB$INIT_GET_NEXT( PROJ_FLAG, TYPE ) ;
     1923    18572    3   COUNT = 0;
     1924    18573    3   CALL ASB$GET_NEXT ALTRET( ALT );
     1925    18574    3   AS_RESOURCE_LIST$ -> UBIN$WORD = 0;
     1926    18575    3   AS_PSEUDO_LIST$ -> UBIN$WORD = 0;
     1927    18576    3   AS_FERESOURCE_LIST$ -> UBIN$WORD = 0;
     1928    18577    3   AS_FEPSEUDO_LIST$ -> UBIN$WORD = 0;
     1929    18578    3   CALL ASB$LIST( USERS_KEY );
     1930    18579    3   COUNT = 1;
     1931    18580    3   CR_MOD_KEY = USERS_KEY;
     1932    18581    3   SUPER_TO_PIG.ACCT = USERS_KEY.TXTC;
     1933    18582    3   RETURN;
     1934    18583
     1935    18584    3   ALT: ALTRETURN;
     1936    18585
     1937    18586    3   END GET_FIRST;
     1938    18587
     1939    18588
     1940    18589
     1941    18590
     1942    18591        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:67   
     1943    18592    2   GET_PACKSET_LIST: PROC  ALTRET;
     1944    18593
     1945    18594    3   DCL ALTRET_FLG BIT(1);
     1946    18595    3   DCL 1 DEST_PROJ ALIGNED,
     1947    18596    3          2 COUNT UBIN BYTE UNAL,
     1948    18597    3          2 TEXT CHAR(20);
     1949    18598
     1950    18599    3   PACKSET_COUNT = 0;
     1951    18600    3   PROJ_KEY = CR_MOD_KEY;
     1952    18601    3   CALL ASB$PREC_PROJ;
     1953    18602    3   ARS = DSEG1SIZE;
     1954    18603    3   PTR$ = DSEG1$;
     1955    18604    3   CALL ASB$READ_PROJ_SEQ( PTR$, ARS ) ALTRET( FINISHED );
     1956    18605    4   DO WHILE( PROJ_KEY.TXT.PROJECT = (SUBSTR(CR_MOD_KEY.TEXT,0,20)) );
     1957    18606    4      CALL  ASB$ENQ_PROJ;
     1958    18607    4      PACKSET$LIST.PSN(PACKSET_COUNT) = SUBSTR(PROJ_KEY.TEXT,20,PROJ_KEY.COUNT-20);
     1959    18608    4      PACKSET_COUNT = PACKSET_COUNT + 1;
     1960    18609    4      PTR$ = PINCRW( PTR$, SIZEW(PACKSET$LIST(0)) );
     1961    18610    4      ARS = DSEG1SIZE - PACKSET_COUNT*SIZEC(PACKSET$LIST(0));
     1962    18611    4      CALL ASB$READ_PROJ_SEQ( PTR$, ARS ) ALTRET( FINISHED );
     1963    18612    4      END;
     1964    18613    3   FINISHED:
     1965    18614    3   IF PACKSET_COUNT>0 AND (CODE=68 /* TIE_PROJ_VAL */ OR AS_PROJECT_ADMIN ~= AS_NONE)
     1966    18615    4   THEN DO;
     1967    18616    4      IF CODE = 68 /* TIE_PROJ_VAL */
     1968    18617    4      THEN DEST_PROJ = FROM_KEY;
     1969    18618    4      ELSE DEST_PROJ = AS_PROJECT_ADMIN;
     1970    18619    4      ALTRET_FLG = '0'B;
     1971    18620    5      DO I = 0 TO PACKSET_COUNT-1;
     1972    18621    5         CALL READ_PROJ_REC(DEST_PROJ,PACKSET$LIST.PSN(I),DSEG3$) ALTRET(ALT);
     1973    18622    5         IF AS_PROJECT_ADMIN = AS_NONE
     1974    18623    5         THEN CALL ASB$ACCT_OK(PACKSET$LIST.SKELETON(I),
     1975    18624    5                 PACKSET$LIST.PSN(I),DEST_PROJ,,DSEG3$) ALTRET(ALT);
     1976    18625    5         IF (PACKSET$LIST.MAX_NUM_GRANS(I)+DSEG3$->AS$PROJ.GRANS_ACCUM)
     1977    18626    5              > DSEG3$->AS$PROJ.MAX_NUM_GRANS
     1978    18627    6         THEN DO;
     1979    18628    6            CALL ASA$KEYCONV( DEST_PROJ, AS_FIELD1 );
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:68   
     1980    18629    6            AS_FIELD2.COUNT = LENGTHC(PACKSET$LIST.PSN(I));
     1981    18630    6            AS_FIELD2.TEXT  = PACKSET$LIST.PSN(I);
     1982    18631                 %SCREAM(ERR#=E$TOO_MANY_GRANS2,MID='A',LEVEL=ERROR);
     1983    18646    6            ALTRET_FLG = '1'B;
     1984    18647    6            END;
     1985    18648    5         IF (PACKSET$LIST.NUM_ACCTS(I)+PACKSET$LIST.SUB_PROJ_ACCTS(I)
     1986    18649    5              +DSEG3$->AS$PROJ.NUM_ACCTS+DSEG3$->AS$PROJ.SUB_PROJ_ACCTS)
     1987    18650    5              > DSEG3$->AS$PROJ.MAX_NUM_ACCTS
     1988    18651    6         THEN DO;
     1989    18652    6            CALL ASA$KEYCONV( DEST_PROJ, AS_FIELD1 );
     1990    18653    6            AS_FIELD2.COUNT = LENGTHC(PACKSET$LIST.PSN(I));
     1991    18654    6            AS_FIELD2.TEXT  = PACKSET$LIST.PSN(I);
     1992    18655                 %SCREAM(ERR#=E$TOO_MANY_F_ACCTS2,MID='A',LEVEL=ERROR);
     1993    18670    6   ALT:     ALTRET_FLG = '1'B;
     1994    18671    6            END;
     1995    18672    5         END;
     1996    18673    5      IF ALTRET_FLG THEN DO;
     1997    18674    5         CALL ASB$DEQ_PROJ;
     1998    18675    5         ALTRETURN;
     1999    18676    5         END;
     2000    18677    4      END;
     2001    18678
     2002    18679    3   END GET_PACKSET_LIST;
     2003    18680        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:69   
     2004    18681        /*I*  NAME:       GET_ACCT_LIST
     2005    18682              PURPOSE:    Process the FACCOUNT list specified for the UNTIE user,
     2006    18683                          TIE user, and MODIFY user TO PROJECT commands.
     2007    18684              CALL:       CALL GET_ACCT_LIST(FACCT_INX) ALTRET(label)
     2008    18685              INPUT:      FACCT_INX -   P$NODE.SUBLK$(FACCT_INX) points to the
     2009    18686                                        FACCOUNT list, if it exists.
     2010    18687              OUTPUT:     ACCT_COUNT is the number of unique accounts in the list
     2011    18688                          ACCT$LIST contains the account list, sorted in ascending order
     2012    18689              DESCRIPTION:
     2013    18690                  The procedure processes the parse tree and builds ACCT$LIST
     2014    18691                  sorted in ascending order.  Then it checks to see if all the
     2015    18692                  accounts really exist.  For the TIE user and MODIFY user TO PROJECT
     2016    18693                  commands, it also verifies that the accounts can be added to the
     2017    18694                  packsets for the specified project and that they are consistent
     2018    18695                  with the account skeletons for the packsets.  If any errors
     2019    18696                  are detected, the altreturn is taken.
     2020    18697        */
     2021    18698    2   GET_ACCT_LIST: PROC( FACCT_INX ) ALTRET;
     2022    18699
     2023    18700    3   DCL FACCT_INX UBIN;
     2024    18701
     2025    18702    3   DCL PACKSET CHAR(6);
     2026    18703    3   DCL GRANS UBIN;
     2027    18704    3   DCL ACCTS UBIN;
     2028    18705    3   DCL 1 DEST_PROJ ALIGNED,
     2029    18706    3          2 COUNT UBIN BYTE UNAL,
     2030    18707    3          2 TEXT CHAR(21);
     2031    18708    3   DCL ACCT_IN_PROJ BIT(1);
     2032    18709    3   DCL ALTRET_FLG BIT(1);
     2033    18710
     2034    18711
     2035    18712    3   ACCT_COUNT = 0;
     2036    18713    3   IF P$NODE.SUBNODES = FACCT_INX THEN RETURN;   /* Faccount not specified */
     2037    18714    3   ALTRET_FLG = '0'B;
     2038    18715    3   PAR$ = P$NODE.SUBLK$(FACCT_INX);
     2039    18716    4   IF PAR$->P$NODE.SUBNODES = 0 THEN DO;
     2040    18717                                           /* Faccount specified, but no account list */
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:70   
     2041    18718    4      ACCT$LIST.PSN(0) = AS_USERS.HPSN;
     2042    18719    4      ACCT$LIST.ACCT(0) = AS_USERS.ACCT;
     2043    18720    4      ACCT_COUNT = 1;
     2044    18721    4      END;
     2045    18722    4   ELSE DO;
     2046    18723                                          /* Build ACCT$LIST, keep in ascending order */
     2047    18724    5      DO I = 0 TO PAR$->P$NODE.SUBNODES-1;
     2048    18725    5         PTR$ = PAR$->P$NODE.SUBLK$(I);
     2049    18726    5         ACCT$LIST(ACCT_COUNT+2) = '0'B;
     2050    18727    6         IF PTR$->P$NODE.SUBNODES = 1 THEN DO;
     2051    18728    6            ACCT$LIST.PSN(ACCT_COUNT+2)  = AS_USERS.HPSN;
     2052    18729    6            ACCT$LIST.ACCT(ACCT_COUNT+2) = PTR$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT;
     2053    18730    6            END;
     2054    18731    6         ELSE DO;
     2055    18732    6            ACCT$LIST.PSN(ACCT_COUNT+2)  = PTR$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT;
     2056    18733    6            ACCT$LIST.ACCT(ACCT_COUNT+2) = PTR$->P$NODE.SUBLK$(1)->OUT$SYM.TEXT;
     2057    18734    6            END;
     2058    18735    5         J = 0;
     2059    18736    6         DO WHILE(J < ACCT_COUNT  AND  ACCT$LIST(J) < ACCT$LIST(ACCT_COUNT+2) );
     2060    18737    6            J = J + 1;
     2061    18738    6            END;
     2062    18739    6         IF ACCT$LIST(J) ~= ACCT$LIST(ACCT_COUNT+2) THEN DO;
     2063    18740    7            DO K = ACCT_COUNT DOWNTO J+1;
     2064    18741    7               ACCT$LIST(K) = ACCT$LIST(K-1);
     2065    18742    7               END;
     2066    18743    6            ACCT$LIST(J) = ACCT$LIST(ACCT_COUNT+2);
     2067    18744    6            ACCT_COUNT = ACCT_COUNT + 1;
     2068    18745    6            END;
     2069    18746    5         END;
     2070    18747    4      END;
     2071    18748        /*
     2072    18749                          Verify that all accounts exist and get max grans for each
     2073    18750        */
     2074    18751    3   IF CODE = 67 /* TIE_USER_VAL */
     2075    18752    3   THEN DEST_PROJ = FROM_KEY;
     2076    18753    3   ELSE IF AS_PROJECT_ADMIN ~= AS_NONE
     2077    18754    3      THEN DEST_PROJ = AS_PROJECT_ADMIN;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:71   
     2078    18755    3      ELSE DEST_PROJ.COUNT = 0;
     2079    18756    3   I = 0;
     2080    18757    4   DO WHILE( I < ACCT_COUNT );
     2081    18758    4      PACKSET = ACCT$LIST.PSN(I);
     2082    18759    4      IF DEST_PROJ.COUNT > 0
     2083    18760    5      THEN DO;
     2084    18761    5         CALL READ_PROJ_REC(DEST_PROJ,PACKSET,DSEG3$) ALTRET(SKIP_PACKSET);
     2085    18762    5         GRANS = 0; ACCTS = 0;
     2086    18763    5         END;
     2087    18764    4      IF AS_PROJECT_ADMIN ~= AS_NONE  OR  CODE = 65 /* UNTIE_USER_VAL */
     2088    18765    5      THEN DO;
     2089    18766    5         CALL READ_PROJ_REC(AS_USERS.BUDGET.MACCT,PACKSET,DSEG2$) ALTRET(SKIP_PACKSET);
     2090    18767    5         ACCT_IN_PROJ = '1'B;
     2091    18768    5         END;
     2092    18769    4      ELSE ACCT_IN_PROJ = '0'B;
     2093    18770    5      DO WHILE( I < ACCT_COUNT  AND  ACCT$LIST.PSN(I) = PACKSET );
     2094    18771    5         IF NOT ACCT_IN_PROJ
     2095    18772    6         THEN DO;            /* Account not in a project */
     2096    18773    6            CALL ASB$GET_MGRANS( ACCT$LIST.ACCT(I), ACCT$LIST.PSN(I), ACCT$LIST.GRANS(I
             18773                     ) ) ALTRET(NO_ACCT);
     2097    18774    6            END;
     2098    18775    6         ELSE DO;        /* Account must be on a packset for the project */
     2099    18776    6            PROJ_ACCT_LIST$ = PINCRW( ADDR(AS$PROJ.ATTRIBUTES),
     2100    18777    6                 (AS$PROJ.ATTRIBUTES.COUNT + 5 ) / 4 );
     2101    18778    6            J = 0;
     2102    18779    7            DO WHILE(J<AS$PROJ.NUM_ACCTS AND PROJ$LIST.ACCT(J)<ACCT$LIST.ACCT(I));
     2103    18780    7               J = J + 1;
     2104    18781    7               END;
     2105    18782    6            IF J < AS$PROJ.NUM_ACCTS AND PROJ$LIST.ACCT(J) = ACCT$LIST.ACCT(I)
     2106    18783    7            THEN DO;
     2107    18784    7               ACCT$LIST.GRANS(I) = PROJ$LIST.GRANS(J);
     2108    18785    7               END;
     2109    18786    7            ELSE DO;
     2110    18787        /*E*  ERROR:  ASA-E$ACCT_NOT_IN_PROJ-C
     2111    18788              MESSAGE: DP#%U1.%U2 is not in project "%U3".
     2112    18789        */
     2113    18790    7               AS_FIELD1.TEXT = ACCT$LIST.PSN(I);
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:72   
     2114    18791    7               CALL INDEX( K, AS_BLANK, AS_FIELD1.TEXT );
     2115    18792    7               AS_FIELD1.COUNT = K;
     2116    18793    7               AS_FIELD2.TEXT = ACCT$LIST.ACCT(I);
     2117    18794    7               CALL INDEX( K, AS_BLANK, AS_FIELD2.TEXT );
     2118    18795    7               AS_FIELD2.COUNT = K;
     2119    18796    7               CALL ASA$KEYCONV( AS_USERS.BUDGET.MACCT, AS_FIELD3 );
     2120    18797                    %SCREAM( ERR#=E$ACCT_NOT_IN_PROJ, MID='A', LEVEL=ERROR );
     2121    18812    7   NO_ACCT:    ALTRET_FLG = '1'B;
     2122    18813    7               GOTO NEXT;
     2123    18814    7               END;
     2124    18815    6            END;
     2125    18816    5         IF DEST_PROJ.COUNT > 0
     2126    18817    6         THEN DO;
     2127    18818    6            PROJ_ACCT_LIST$ = PINCRW(ADDR(DSEG3$->AS$PROJ.ATTRIBUTES),
     2128    18819    6                 (DSEG3$->AS$PROJ.ATTRIBUTES.COUNT+5)/4 );
     2129    18820    6            J = 0;
     2130    18821    7            DO WHILE( J < DSEG3$->AS$PROJ.NUM_ACCTS
     2131    18822    7                 AND  PROJ$LIST.ACCT(J) < ACCT$LIST.ACCT(I) );
     2132    18823    7               J = J + 1;
     2133    18824    7               END;
     2134    18825    6            IF J < DSEG3$->AS$PROJ.NUM_ACCTS
     2135    18826    6                 AND PROJ$LIST.ACCT(J) = ACCT$LIST.ACCT(I)
     2136    18827    6            THEN GOTO NEXT;
     2137    18828    6            CALL ASB$ACCT_OK(ACCT$LIST.ACCT(I),PACKSET,DEST_PROJ,,DSEG3$) ALTRET(
             18828                     NO_MATCH);
     2138    18829    6            GRANS = GRANS + ACCT$LIST.GRANS(I);
     2139    18830    6            ACCTS = ACCTS + 1;
     2140    18831    6            END;
     2141    18832    6         DO WHILE('0'B);
     2142    18833    6   NO_MATCH: ALTRET_FLG = '1'B;
     2143    18834    6            END;
     2144    18835    5   NEXT: I = I + 1;
     2145    18836    5         END;
     2146    18837    4      IF DEST_PROJ.COUNT > 0
     2147    18838    5      THEN DO;
     2148    18839    5         IF (GRANS + DSEG3$->AS$PROJ.GRANS_ACCUM) > DSEG3$->AS$PROJ.MAX_NUM_GRANS
     2149    18840    6         THEN DO;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:73   
     2150    18841        /*E*  ERROR:  ASA-E$TOO_MANY_GRANS2-C
     2151    18842              MESSAGE: Granule limit exceeded for project "%U1" packset DP#%U2
     2152    18843        */
     2153    18844    6            CALL ASA$KEYCONV( DEST_PROJ, AS_FIELD1 );
     2154    18845    6            AS_FIELD2.COUNT = LENGTHC(PACKSET);
     2155    18846    6            AS_FIELD2.TEXT  = PACKSET;
     2156    18847                 %SCREAM(ERR#=E$TOO_MANY_GRANS2,LEVEL=ERROR,MID='A');
     2157    18862    6            ALTRET_FLG = '1'B;
     2158    18863    6            END;
     2159    18864    5         IF ( ACCTS+DSEG3$->AS$PROJ.NUM_ACCTS+DSEG3$->AS$PROJ.SUB_PROJ_ACCTS) > DSEG3$
             18864                  ->AS$PROJ.MAX_NUM_ACCTS
     2160    18865    6         THEN DO;
     2161    18866        /*E*  ERROR:  ASA-E$TOO_MANY_F_ACCTS2-C
     2162    18867              MESSAGE: Account limit exceeded for project "%U1" packset DP#%U2
     2163    18868        */
     2164    18869    6            CALL ASA$KEYCONV( DEST_PROJ, AS_FIELD1 );
     2165    18870    6            AS_FIELD2.COUNT = LENGTHC(PACKSET);
     2166    18871    6            AS_FIELD2.TEXT  = PACKSET;
     2167    18872                 %SCREAM(ERR#=E$TOO_MANY_F_ACCTS2,MID='A',LEVEL=ERROR);
     2168    18887    6            ALTRET_FLG = '1'B;
     2169    18888    6            END;
     2170    18889    5         END;
     2171    18890    5      DO WHILE('0'B);
     2172    18891    6   SKIP_PACKSET: DO WHILE( I < ACCT_COUNT  AND  ACCT$LIST.PSN(I) = PACKSET );
     2173    18892    6            I = I + 1;
     2174    18893    6            END;
     2175    18894    5         ALTRET_FLG = '1'B;
     2176    18895    5         END;
     2177    18896    4      END;
     2178    18897
     2179    18898    4   IF ALTRET_FLG THEN DO;
     2180    18899    4      IF ACCT_COUNT > 0 THEN CALL ASB$DEQ_PROJ;
     2181    18900    4      ALTRETURN;
     2182    18901    4      END;
     2183    18902
     2184    18903    3   END GET_ACCT_LIST;
     2185    18904        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:74   
     2186    18905    2   READ_PROJ_REC: PROC( PROJECT, PACKSET, PROJ$ ) ALTRET;
     2187    18906
     2188    18907    3   DCL 1 PROJECT ALIGNED,
     2189    18908    3          2 COUNT UBIN BYTE UNAL,
     2190    18909    3          2 TEXT CHAR(20);
     2191    18910    3   DCL PACKSET CHAR(6);
     2192    18911    3   DCL PROJ$ PTR;
     2193    18912
     2194    18913    3   DCL I SBIN;
     2195    18914
     2196    18915
     2197    18916    3   PROJ_KEY.TXT.PROJECT = PROJECT.TEXT;
     2198    18917    3   PROJ_KEY.TXT.PACKSET = PACKSET;
     2199    18918    3   CALL INDEX(I,AS_BLANK,PROJ_KEY.TEXT,20);
     2200    18919    3   PROJ_KEY.COUNT = I;
     2201    18920    3   CALL ASB$ENQ_PROJ;
     2202    18921    3   IF PROJ$ = DSEG2$
     2203    18922    4   THEN DO;
     2204    18923    4      I = DSEG2SIZE;
     2205    18924    4      CALL ASB$READ_PROJ(PROJ$,I,2) ALTRET(ALT);
     2206    18925    4      END;
     2207    18926    4   ELSE DO;
     2208    18927    4      I = DSEG3SIZE;
     2209    18928    4      CALL ASB$READ_PROJ(PROJ$,I,3) ALTRET(ALT);
     2210    18929    4      END;
     2211    18930    3   RETURN;
     2212    18931
     2213    18932    3   ALT: IF MERR_CODE.CODE = %E$NOKEY
     2214    18933    4   THEN DO;
     2215    18934    4      AS_FIELD1.COUNT = PROJ_KEY.COUNT - 20;
     2216    18935    4      AS_FIELD1.TEXT  = PACKSET;
     2217    18936    4      CALL ASA$KEYCONV( PROJECT, AS_FIELD2 );
     2218    18937           %SCREAM( ERR#=E$PACK_NO_EXIST_FOR_PROJ, LEVEL=ERROR, MID='A' );
     2219    18952    4      END;
     2220    18953    4   ELSE DO;
     2221    18954    4      CALL ASH$ERROR(MERR_CODE);
     2222    18955    4      END;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:75   
     2223    18956    3   ALTRETURN;
     2224    18957
     2225    18958    3   END READ_PROJ_REC;
     2226    18959        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:76   
     2227    18960    2   END   CREATE_MOD_USER ;
     2228    18961        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:77   
     2229    18962        /*I*  NAME:       REMOVE_USER_PROJECT
     2230    18963              PURPOSE:    Driver routine for removing users and projects
     2231    18964              CALL:       CALL REMOVE_USER_PROJECT( PROJ_FLAG )
     2232    18965              INPUT:      PROJ_FLAG - '1'B => Remove project, '0'B => Remove user.
     2233    18966              INTERFACE:  ASB$KEYMAKER
     2234    18967                          ASB$READ_USER
     2235    18968                          ASB$R_PROJECT
     2236    18969                          ASB$R_USER
     2237    18970                          ERROR
     2238    18971              DESCRIPTION:
     2239    18972                  This routine verifies that the project/user exists and that it
     2240    18973                  can be removed.  It then calls ASB$R_PROJECT to remove projects
     2241    18974                  or calls ASB$R_USER to remove users.
     2242    18975        */
     2243    18976
     2244    18977    1   REMOVE_USER_PROJECT: PROC ( PROJ_FLAG ) ;
     2245    18978
     2246    18979    2   DCL PROJ_FLAG BIT(1) ALIGNED; /* '1'b => remove project, '0'b => remove user */
     2247    18980
     2248    18981    2   DCL 1 KEY,
     2249    18982    2          2 COUNT UBIN BYTE UNAL,
     2250    18983    2          2 TEXT CHAR(41) UNAL,
     2251    18984    2          2 SKEY REDEF TEXT,
     2252    18985    2             3 PROJ UBIN BYTE UNAL,
     2253    18986    2             3 CREATOR CHAR(20) UNAL,
     2254    18987    2             3 USER CHAR(20) UNAL ;
     2255    18988
     2256    18989    2   DCL COUNT UBIN;
     2257    18990    2   DCL PAR$ PTR;
     2258    18991    2   DCL TYPE UBIN ;
     2259    18992    2   DCL FACCOUNT_OPT BIT(1);
     2260    18993
     2261    18994
     2262    18995    2   TYPE = P$NODE.CODE ;
     2263    18996    2   PAR$ = P$NODE.SUBLK$(0) ;
     2264    18997    2   FACCOUNT_OPT = (P$NODE.SUBLK$(1)->P$NODE.CODE = 121 /* FACCOUNT_OPT_VAL */ );
     2265    18998    2   COUNT = 0 ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:78   
     2266    18999    2   CALL ASB$KEYMAKER(USERS_KEY, PAR$->P$NODE, PROJ_FLAG, TYPE ) ALTRET(EXIT#);
     2267    19000    2   IF NOT AS_WILD_USER
     2268    19001    3   THEN DO ;
     2269    19002    4      IF PROJ_FLAG THEN DO;
     2270    19003    4         KEY.COUNT = 21 + USERS_KEY.COUNT ;
     2271    19004    4         KEY.SKEY.USER = USERS_KEY.TXTC ;
     2272    19005    4         CALL ASB$GET( PROJ_FLAG, TYPE, AS_PROJECT, AS_PROJECT_DREC$,
     2273    19006    4              AS_PROJECT_DFLT, AS_PROJECT_DFLT_DREC$ ) ALTRET(EXIT#);
     2274    19007    4         KEY.SKEY.PROJ = 1;
     2275    19008    4         KEY.SKEY.CREATOR = AS_PROJECT.BUDGET.MACCT_.TEXT;
     2276    19009    4         CALL ASR$R_PROJECT( KEY, COUNT, FACCOUNT_OPT ) ;
     2277    19010    4         CALL MOD_PROJ_ADMIN_REC;
     2278    19011    4         END ;
     2279    19012    4      ELSE DO ;
     2280    19013    4         CALL ASB$GET( PROJ_FLAG, TYPE, AS_USERS, KL_DREC$ ) ALTRET(EXIT#);
     2281    19014    5         CALL ASR$R_USER( FACCOUNT_OPT ) WHENRETURN DO;
     2282    19015    5            COUNT = 1;
     2283    19016    5            END; /*Whenreturn*/
     2284    19017    4         END ;
     2285    19018    3      END ;
     2286    19019    3   ELSE DO ;
     2287    19020    3      CALL ASB$INIT_GET_NEXT( PROJ_FLAG, TYPE ) ;
     2288    19021    4      DO WHILE( '1'B );
     2289    19022    4         CALL ASB$GET_NEXT ALTRET( FINISHED ) ;
     2290    19023    5         IF PROJ_FLAG THEN DO ;
     2291    19024    5            KEY = USERS_KEY;
     2292    19025    5            CALL ASR$R_PROJECT( KEY, COUNT, FACCOUNT_OPT ) ;
     2293    19026    5            CALL MOD_PROJ_ADMIN_REC;
     2294    19027    5            END ;
     2295    19028    5         ELSE DO ;
     2296    19029    6            CALL ASR$R_USER( FACCOUNT_OPT ) WHENRETURN DO;
     2297    19030    6               COUNT = COUNT + 1 ;
     2298    19031    6               END; /*Whenreturn*/
     2299    19032    5            END ;
     2300    19033    4         END ;  /* Do forever */
     2301    19034    3      END ;   /* Else do */
     2302    19035    2   FINISHED:
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:79   
     2303    19036    2   CALL ASB$FLUSH;
     2304    19037    3   IF COUNT = 0 THEN DO;
     2305    19038        /*E* ERROR:   ASA-E$NOTHING_TO_REMOVE-C
     2306    19039             MESSAGE: Nothing to remove.
     2307    19040        */
     2308    19041           %SCREAM( ERR#=E$NOTHING_TO_REMOVE, MID='A', LEVEL=ERROR );
     2309    19056    3      END;
     2310    19057    3   ELSE DO;
     2311    19058           %NUMBER( NUM1=COUNT ) ;
             19066    3         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, COUNT );
     2312    19088    4      IF PROJ_FLAG THEN DO;
     2313    19089        /*E* ERROR:   ASA-E$NUM_PROJ_REMOVED-C
     2314    19090             MESSAGE:.. %U1 projects removed.
     2315    19091        */
     2316    19092              %SCREAM( ERR#=E$NUM_PROJ_REMOVED, LEVEL=INFO, MID='A' );
     2317    19107    4         END;
     2318    19108    4      ELSE DO ;
     2319    19109        /*E* ERROR:   ASA-E$USERS_REMOVED-C
     2320    19110             MESSAGE:.. %U1 users removed.
     2321    19111        */
     2322    19112              %SCREAM( ERR#=E$USERS_REMOVED, LEVEL=INFO, MID='A' );
     2323    19127    5         IF AS_PROJECT_ADMIN ~= AS_NONE THEN DO;
     2324    19128    5            USERS_KEY.COUNT = 21;
     2325    19129    5            CALL CONCAT( USERS_KEY.TXTC, AS_PROJECT_ADMIN.TEXT, 'S' );
     2326    19130    5            CALL ASB$ENQ_USERS ALTRET(EXIT#);
     2327    19131    5            CALL ASB$READ_USERS( AS_USERS ) ALTRET(EXIT#);
     2328    19132    5            AS_USERS.BUDGET.PROJ_CREATED = AS_USERS.BUDGET.PROJ_CREATED - COUNT;
     2329    19133    5            CALL ASB$WRITE_USERS( AS_USERS );
     2330    19134    5            END;
     2331    19135    4         END ;
     2332    19136    3      END ;
     2333    19137
     2334    19138    2   EXIT#: RETURN ;
     2335    19139
     2336    19140
     2337    19141    2   MOD_PROJ_ADMIN_REC: PROC;
     2338    19142
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:80   
     2339    19143    3   IF AS_PROJECT.BUDGET.MACCT = AS_NONE THEN RETURN;
     2340    19144    3   USERS_KEY.COUNT = 21;
     2341    19145    3   CALL CONCAT( USERS_KEY.TXTC, AS_PROJECT.BUDGET.MACCT_.TEXT, 'S' );
     2342    19146    3   CALL ASB$ENQ_USERS ALTRET(EXIT#);
     2343    19147    3   CALL ASB$READ_USERS( AS_USERS ) ALTRET(EXIT#);
     2344    19148    3   IF AS_PROJECT_DFLT.BUDGET.PMAXC > 0 THEN
     2345    19149    3      AS_USERS.BUDGET.PROJ_CREATED = AS_USERS.BUDGET.PROJ_CREATED - AS_PROJECT_DFLT.
             19149               BUDGET.PROJ_ALLOWED;
     2346    19150    3   IF AS_PROJECT.BUDGET.MAX_PROJECTS > 0 THEN
     2347    19151    3      AS_USERS.BUDGET.SUB_PROJS = AS_USERS.BUDGET.SUB_PROJS - AS_PROJECT.BUDGET.
             19151               MAX_PROJECTS;
     2348    19152    3   AS_USERS.BUDGET.SUB_PROJS = AS_USERS.BUDGET.SUB_PROJS - 1;
     2349    19153    3   CALL ASB$WRITE_USERS( AS_USERS );
     2350    19154    4   IF FACCOUNT_OPT THEN DO;
     2351    19155    4      DSEG1$->SUPER_TO_PIG.TYPE = %DELETE_ACCT;
     2352    19156    4      DSEG1$->SUPER_TO_PIG.WIDTH = LO_WIDTH;
     2353    19157    4      DSEG1$->SUPER_TO_PIG.PROJ = '1'B;
     2354    19158    4      DSEG1$->SUPER_TO_PIG.RESUPER = AS_LOGON_KEY.TEXT;
     2355    19159    4      DSEG1$->SUPER_TO_PIG.PROJECT_TEXT = AS_PROJECT.BUDGET.MACCT_.TEXT;
     2356    19160    4      DSEG1$->SUPER_TO_PIG.PACKSET = AS_PROJECT.HPSN;
     2357    19161    4      DSEG1$->SUPER_TO_PIG.ACCT    = AS_PROJECT.ACCT;
     2358    19162    4      DSEG1$->SUPER_TO_PIG.ATTR.COUNT = 0;
     2359    19163    4      CALL ASB$PIG(DSEG1$->SUPER_TO_PIG);
     2360    19164    4      END;
     2361    19165    3   EXIT#: RETURN;
     2362    19166
     2363    19167    3   END MOD_PROJ_ADMIN_REC;
     2364    19168
     2365    19169
     2366    19170    2   END REMOVE_USER_PROJECT;
     2367    19171        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:81   
     2368    19172        /*I*  NAME:       MAKEME
     2369    19173              CALL:       CALL MAKEME( CODE )
     2370    19174              INPUT:      CODE - indicates type of MAKEME command to be processed.
     2371    19175                          CODE            COMMAND
     2372    19176                           1              MAKEME
     2373    19177                           2              MAKEME  PROJECT
     2374    19178                           3              MAKEME  RESET
     2375    19179                           4              MAKEME  account,name
     2376    19180              DESCRIPTION:
     2377    19181                  This procedure processes a MAKEME command.
     2378    19182
     2379    19183                  COMMAND                     ACTION
     2380    19184                  -------             ----------------------------------------
     2381    19185                  MAKEME              Lists the current project administrator.
     2382    19186                  MAKEME PROJECT      Makes a SUPER user the project administrator of
     2383    19187                                      the project indicated by the logon
     2384    19188                                      account,name.
     2385    19189                  MAKEME RESET        Resets current project administrator to
     2386    19190                                      initial project adminstrator.
     2387    19191                  MAKEME account,name       Makes a SUPER user the project
     2388    19192                                      administrator of the project account,name.
     2389    19193
     2390    19194                  A system adminstrator can be the project administrator of any
     2391    19195                  project.  A project administrator can issue the MAKEME command
     2392    19196                  only for projects below him in the project hierarcy.
     2393    19197        */
     2394    19198
     2395    19199
     2396    19200    1   MAKEME: PROC( CODE );
     2397    19201
     2398    19202
     2399    19203    2   DCL CODE      UBIN;
     2400    19204
     2401    19205    2   DCL 1 PROJ_ADMIN_KEY,
     2402    19206    2          2 CNT UBIN BYTE UNAL,
     2403    19207    2          2 TEXT CHAR(20);
     2404    19208
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:82   
     2405    19209
     2406    19210
     2407    19211    3   DO SELECT( CODE );
     2408    19212    3      SELECT( 1 /* MAKEME */ );
     2409    19213    3      PROJ_ADMIN_KEY = AS_PROJECT_ADMIN ;
     2410    19214
     2411    19215    3      SELECT( 2 /* MAKEME SYS */ );
     2412    19216    3      PROJ_ADMIN_KEY = AS_LOGON_KEY ;
     2413    19217
     2414    19218    3      SELECT( 3 /* MAKEME RESET */ );
     2415    19219    3      IF PADMIN AND (NOT SUPERD) AND (NOT SUPERAUTH)
     2416    19220    3      THEN PROJ_ADMIN_KEY = AS_LOGON_KEY;
     2417    19221    3      ELSE PROJ_ADMIN_KEY = AS_NONE;
     2418    19222
     2419    19223    3      SELECT( 4 /* MAKEME PROJ */ );
     2420    19224    3      CALL ASB$KEYMAKER( PROJ_ADMIN_KEY,
     2421    19225    3           P$NODE.SUBLK$(0)->P$NODE.SUBLK$(0)->P$NODE,
     2422    19226    3           AS_TRUE, 53 /* MAKEME_VAL */ )  ALTRET( EXIT# );
     2423    19227    3      END;              /* Do case( code ); */
     2424    19228
     2425    19229    2   IF PROJ_ADMIN_KEY ~= AS_PROJECT_ADMIN
     2426    19230    2        AND  PROJ_ADMIN_KEY ~= AS_NONE
     2427    19231    3   THEN DO;
     2428    19232                                                      /*
     2429    19233                                                         Read project record
     2430    19234                                                                         */
     2431    19235    3      USERS_KEY = PROJ_ADMIN_KEY;
     2432    19236    3      CALL ASB$READ_USERS( AS_PROJ_ADMIN ) ALTRET( PROJECT_DOESNT_EXIST );
     2433    19237    3      IF (AS_PROJ_ADMIN.PPRIV(0) & %PPR_PADMIN#) ~= %PPR_PADMIN#
     2434    19238    4      THEN DO;                        /* Its a user not a project */
     2435    19239    4         CALL ASA$ERROR( USERS_KEY, 305 /* USER/PROJECT NOT PROJECT/USER */, AS_TRUE );
     2436    19240    4         RETURN;
     2437    19241    4         END;
     2438    19242    3      IF NOT SUPERAUTH  AND  PROJ_ADMIN_KEY ~= AS_LOGON_KEY
     2439    19243    4      THEN DO;
     2440    19244                                                      /*
     2441    19245                                                         Check if project is
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:83   
     2442    19246                                                         below user in project
     2443    19247                                                         hierarchy.
     2444    19248                                                                          */
     2445    19249    4         AS_USERS = AS_PROJ_ADMIN;
     2446    19250    5         DO WHILE( AS_USERS.BUDGET.MACCT ~= AS_LOGON_KEY
     2447    19251    5              AND  AS_USERS.BUDGET.MACCT ~= AS_NONE );
     2448    19252    5            USERS_KEY = AS_USERS.BUDGET.MACCT;
     2449    19253    5            CALL ASB$READ_USERS( AS_USERS ) ALTRET( INTERNAL_ERROR );
     2450    19254    5            END;
     2451    19255    4         IF AS_USERS.BUDGET.MACCT = AS_NONE
     2452    19256    5         THEN DO;
     2453    19257        /*E* ERROR:   ASA-E$CANT_BE_PROJ-C
     2454    19258             MESSAGE: You cannot be the project administrator of "%U1".
     2455    19259             MESSAGE1: You can issue a MAKEME command only for projects below you in
     2456    19260                       the project hierarchy.
     2457    19261        */
     2458    19262    5            CALL INDEX( I, ' ', SUBSTR( PROJ_ADMIN_KEY.TEXT, 0, 8 ) );
     2459    19263    5            CALL CONCAT( AS_FIELD1.TEXT, SUBSTR( PROJ_ADMIN_KEY.TEXT,0,I),
     2460    19264    5                 ',', SUBSTR( PROJ_ADMIN_KEY.TEXT, 8) );
     2461    19265    5            AS_FIELD1.COUNT = I + PROJ_ADMIN_KEY.CNT - 7;
     2462    19266                 %SCREAM( ERR#=E$CANT_BE_PROJ, LEVEL=ERROR, MID='A' );
     2463    19281    5            RETURN;
     2464    19282    5            END;
     2465    19283    4         END;
     2466    19284    3      END;
     2467    19285    2   AS_PROJECT_ADMIN = PROJ_ADMIN_KEY;
     2468    19286        /*
     2469    19287                              Print current project administrator
     2470    19288        */
     2471    19289    2   IF AS_PROJECT_ADMIN = AS_NONE
     2472    19290    3   THEN DO;
     2473    19291    3      OUT_BUF = '  Project:  NONE' ;
     2474    19292    3      END;
     2475    19293    3   ELSE DO;
     2476    19294    3      CALL INDEX( I, AS_BLANK, SUBSTR(AS_PROJECT_ADMIN.TEXT,0,8) );
     2477    19295    3      CALL CONCAT( OUT_BUF, '  Project:  ',
     2478    19296    3           SUBSTR(AS_PROJECT_ADMIN.TEXT,0,I), ',',
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:84   
     2479    19297    3           SUBSTR(AS_PROJECT_ADMIN.TEXT,8) );
     2480    19298    3      END;
     2481    19299    2   CALL ASB$WRITE_LO( OUT_BUF, LENGTHC(OUT_BUF) );
     2482    19300    2   CALL ASB$WRITE_LO( AS_BLANK, 1 );
     2483    19301        /*
     2484    19302                                                      Error conditions
     2485    19303        */
     2486    19304    3   DO WHILE( AS_FALSE );
     2487    19305    3   PROJECT_DOESNT_EXIST:
     2488    19306    3      CALL ASA$ERROR( PROJ_ADMIN_KEY, 4 /* RECORD DOES NOT EXIST */, AS_TRUE );
     2489    19307    4      DO WHILE( AS_FALSE );
     2490    19308    4   INTERNAL_ERROR:
     2491    19309        /*E* ERROR:   ASA-E$PROJ_ADMIN_NOT_FOUND-C
     2492    19310             MESSAGE: Internal error: project administrator "%U1" record does
     2493    19311                      not exist in :USERS file.
     2494    19312        */
     2495    19313    4         IF MERR_CODE.CODE = %E$NOKEY
     2496    19314    5         THEN DO;
     2497    19315    5            AS_FIELD1 = PROJ_ADMIN_KEY;
     2498    19316                 %SCREAM( ERR#=E$PROJ_ADMIN_NOT_FOUND, LEVEL=ERROR, MID='A' );
     2499    19331    5            END;
     2500    19332    4         ELSE CALL ASH$ERROR( MERR_CODE );
     2501    19333    4         END;
     2502    19334    3      END;
     2503    19335
     2504    19336    2   EXIT#: RETURN;
     2505    19337
     2506    19338    2   END   MAKEME;
     2507    19339
     2508    19340        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:85   
     2509    19341    1   COMPARE_FROM_TO_MAX: PROC( FROM_USERS, FROM_DREC, MAX_USERS, MAX_DREC );
     2510    19342
     2511    19343
     2512    19344        %AS_USERS(STR_NAME=FROM_USERS, STCLASS=" ");
     2513    19522        %KL_DREC( NAME=FROM_DREC, STCLASS=" " , LAST=",");
     2514    19635        %KL_FEBLK( NAME=FROM_BLK, RCNT=31, LVL=2, STCLASS=" " ) ;
     2515    19684        %AS_USERS(STR_NAME=MAX_USERS, STCLASS=" " );
     2516    19862        %KL_DREC( NAME=MAX_DREC, STCLASS=" ", LAST="," );
     2517    19975        %KL_FEBLK( NAME=MAX_BLK, RCNT=31, LVL=2, STCLASS=" " ) ;
     2518    20024
     2519    20025    2   DCL I UBIN;
     2520    20026    2   DCL J UBIN;
     2521    20027    2   DCL TEMP_PRIV BIT(36);
     2522    20028
     2523    20029
     2524    20030        %MACRO COMPARE( MAX=MAX, DEFAULT=DEFAULT );
     2525    20031
     2526    20032        %SET MAX_ = CONCAT( 'FROM_USERS.', TEXTCHAR(MAX) );
     2527    20033        %SET DEFAULT_ = CONCAT( 'FROM_USERS.', TEXTCHAR(DEFAULT) );
     2528    20034        %SET MAXIMUM_ = CONCAT( 'MAX_USERS.', TEXTCHAR(MAX) );
     2529    20035
     2530    20036        IF %CHARTEXT(MAX_) > %CHARTEXT(MAXIMUM_)
     2531    20037        THEN DO;
     2532    20038           %CHARTEXT(MAX_) = %CHARTEXT(MAXIMUM_);
     2533    20039           IF %CHARTEXT(DEFAULT_) > %CHARTEXT(MAXIMUM_)
     2534    20040           THEN %CHARTEXT(DEFAULT_) = %CHARTEXT(MAXIMUM_);
     2535    20041           END;
     2536    20042        %MEND;
     2537    20043
     2538    20044
     2539    20045
     2540    20046        %SET LISTDIR='0'B;
     2544    20050                                                      /*
     2545    20051                                                         Compare accesses
     2546    20052                                                      */
     2547    20053    2   IF FROM_DREC.FLAGS.BATOK  AND  NOT MAX_DREC.FLAGS.BATOK
     2548    20054    3   THEN DO;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:86   
     2549    20055    3      FROM_DREC.FLAGS.BATOK = AS_FALSE;
     2550    20056    3      FROM_USERS.BATOK = AS_FALSE;
     2551    20057    3      END;
     2552    20058    2   IF FROM_DREC.FLAGS.OLOK  AND  NOT MAX_DREC.FLAGS.OLOK
     2553    20059    2   THEN
     2554    20060    2      FROM_DREC.FLAGS.OLOK = AS_FALSE;
     2555    20061    2   IF FROM_DREC.FLAGS.GHOSTOK  AND  NOT MAX_DREC.FLAGS.GHOSTOK
     2556    20062    2   THEN
     2557    20063    2      FROM_DREC.FLAGS.GHOSTOK = AS_FALSE;
     2558    20064    2   IF FROM_DREC.FLAGS.TPOK  AND  NOT MAX_DREC.FLAGS.TPOK
     2559    20065    2   THEN
     2560    20066    2      FROM_DREC.FLAGS.TPOK = AS_FALSE;
     2561    20067    2   IF FROM_DREC.FLAGS.FEOK  AND  NOT MAX_DREC.FLAGS.FEOK
     2562    20068    2   THEN
     2563    20069    2      FROM_DREC.FLAGS.FEOK = AS_FALSE;
     2564    20070                                                      /*
     2565    20071                                                         Compare budget sub-options
     2566    20072                                                      */
     2567    20073    2   IF MAX_USERS.BUDGET.MAXC > 0
     2568    20074    2        AND  FROM_USERS.BUDGET.MAXC > MAX_USERS.BUDGET.MAXC
     2569    20075    2   THEN
     2570    20076    2      FROM_USERS.BUDGET.MAXC = MAX_USERS.BUDGET.MAXC;
     2571    20077
     2572    20078    2   IF NOT SUPERAUTH THEN FROM_USERS.BUDGET.ACCUM = 0;
     2573    20079    2   IF MAX_USERS.BUDGET.PCHARGES  AND  NOT FROM_USERS.BUDGET.PCHARGES
     2574    20080    2   THEN
     2575    20081    2      FROM_USERS.BUDGET.PCHARGES = AS_TRUE;
     2576    20082    2   IF MAX_USERS.BUDGET.ICHARGES  AND  NOT FROM_USERS.BUDGET.ICHARGES
     2577    20083    2   THEN
     2578    20084    2      FROM_USERS.BUDGET.ICHARGES = AS_TRUE;
     2579    20085    2   IF MAX_USERS.BUDGET.BUDLIM  AND  NOT FROM_USERS.BUDGET.BUDLIM
     2580    20086    2   THEN
     2581    20087    2      FROM_USERS.BUDGET.BUDLIM = AS_TRUE;
     2582    20088    2   IF NOT MAX_USERS.BUDGET.BKACC  AND  FROM_USERS.BUDGET.BKACC
     2583    20089    2   THEN
     2584    20090    2      FROM_USERS.BUDGET.BKACC = AS_FALSE;
     2585    20091                                                      /*
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:87   
     2586    20092                                                         Compare outputprio
     2587    20093                                                      */
     2588    20094    2   IF FROM_USERS.OUTPUTPRIO > MAX_USERS.OUTPUTPRIO
     2589    20095    2   THEN
     2590    20096    2      FROM_USERS.OUTPUTPRIO = MAX_USERS.OUTPUTPRIO;
     2591    20097                                                      /*
     2592    20098                                                         Check for all modes
     2593    20099                                                      */
     2594    20100    3   DO I = 0 TO 3;
     2595    20101                                                      /*
     2596    20102                                                         Compare services
     2597    20103                                                      */
             20108    3   IF FROM_USERS.MLO(I) > MAX_USERS.MLO(I)
             20109    4   THEN DO;
             20110    4      FROM_USERS.MLO(I) = MAX_USERS.MLO(I);
             20111    4      IF FROM_USERS.DLO(I) > MAX_USERS.MLO(I)
             20112    4      THEN FROM_USERS.DLO(I) = MAX_USERS.MLO(I);
             20113    4      END;
             20119    3   IF FROM_USERS.MDO(I) > MAX_USERS.MDO(I)
             20120    4   THEN DO;
             20121    4      FROM_USERS.MDO(I) = MAX_USERS.MDO(I);
             20122    4      IF FROM_USERS.DDO(I) > MAX_USERS.MDO(I)
             20123    4      THEN FROM_USERS.DDO(I) = MAX_USERS.MDO(I);
             20124    4      END;
             20130    3   IF FROM_USERS.MPO(I) > MAX_USERS.MPO(I)
             20131    4   THEN DO;
             20132    4      FROM_USERS.MPO(I) = MAX_USERS.MPO(I);
             20133    4      IF FROM_USERS.DPO(I) > MAX_USERS.MPO(I)
             20134    4      THEN FROM_USERS.DPO(I) = MAX_USERS.MPO(I);
             20135    4      END;
             20141    3   IF FROM_USERS.MPDIS(I) > MAX_USERS.MPDIS(I)
             20142    4   THEN DO;
             20143    4      FROM_USERS.MPDIS(I) = MAX_USERS.MPDIS(I);
             20144    4      IF FROM_USERS.DPDIS(I) > MAX_USERS.MPDIS(I)
             20145    4      THEN FROM_USERS.DPDIS(I) = MAX_USERS.MPDIS(I);
             20146    4      END;
             20152    3   IF FROM_USERS.MTDIS(I) > MAX_USERS.MTDIS(I)
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:88   
             20153    4   THEN DO;
             20154    4      FROM_USERS.MTDIS(I) = MAX_USERS.MTDIS(I);
             20155    4      IF FROM_USERS.DTDIS(I) > MAX_USERS.MTDIS(I)
             20156    4      THEN FROM_USERS.DTDIS(I) = MAX_USERS.MTDIS(I);
             20157    4      END;
             20163    3   IF FROM_USERS.MFPOOLS(I) > MAX_USERS.MFPOOLS(I)
             20164    4   THEN DO;
             20165    4      FROM_USERS.MFPOOLS(I) = MAX_USERS.MFPOOLS(I);
             20166    4      IF FROM_USERS.DFPOOLS(I) > MAX_USERS.MFPOOLS(I)
             20167    4      THEN FROM_USERS.DFPOOLS(I) = MAX_USERS.MFPOOLS(I);
             20168    4      END;
             20174    3   IF FROM_USERS.MMPRIO(I) > MAX_USERS.MMPRIO(I)
             20175    4   THEN DO;
             20176    4      FROM_USERS.MMPRIO(I) = MAX_USERS.MMPRIO(I);
             20177    4      IF FROM_USERS.DMPRIO(I) > MAX_USERS.MMPRIO(I)
             20178    4      THEN FROM_USERS.DMPRIO(I) = MAX_USERS.MMPRIO(I);
             20179    4      END;
     2605    20181                                                      /*
     2606    20182                                                         Compare time
     2607    20183                                                      */
             20188    3   IF FROM_USERS.MTIME(I) > MAX_USERS.MTIME(I)
             20189    4   THEN DO;
             20190    4      FROM_USERS.MTIME(I) = MAX_USERS.MTIME(I);
             20191    4      IF FROM_USERS.DTIME(I) > MAX_USERS.MTIME(I)
             20192    4      THEN FROM_USERS.DTIME(I) = MAX_USERS.MTIME(I);
             20193    4      END;
     2609    20195                                                      /*
     2610    20196                                                         Compare memory
     2611    20197                                                      */
             20202    3   IF FROM_USERS.MMEM(I) > MAX_USERS.MMEM(I)
             20203    4   THEN DO;
             20204    4      FROM_USERS.MMEM(I) = MAX_USERS.MMEM(I);
             20205    4      IF FROM_USERS.DMEM(I) > MAX_USERS.MMEM(I)
             20206    4      THEN FROM_USERS.DMEM(I) = MAX_USERS.MMEM(I);
             20207    4      END;
     2613    20209                                                      /*
     2614    20210                                                         Compare privileges
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:89   
     2615    20211                                                      */
     2616    20212    4      DO J = 0 TO SIZEW(AS_PRIVILEGE)-1;
     2617    20213    4         TEMP_PRIV = AS_PRIVILEGE(J);
     2618    20214    4         IF (TEMP_PRIV & FROM_USERS.PRIV(I)) = TEMP_PRIV
     2619    20215    4         THEN
     2620    20216    4            IF (TEMP_PRIV & MAX_USERS.PRIV(I)) ~= TEMP_PRIV
     2621    20217    4            THEN
     2622    20218    4               FROM_USERS.PRIV(I) = FROM_USERS.PRIV(I) & ~(TEMP_PRIV);
     2623    20219    4         END;
     2624    20220                                                      /*
     2625    20221                                                         Compare pprivileges
     2626    20222                                                      */
     2627    20223    4      DO J = 0 TO SIZEW(AS_PPRIVILEGE)-1;
     2628    20224    4         TEMP_PRIV = AS_PPRIVILEGE(J);
     2629    20225    4         IF (TEMP_PRIV & FROM_USERS.PPRIV(I)) = TEMP_PRIV
     2630    20226    4         THEN
     2631    20227    4            IF (TEMP_PRIV & MAX_USERS.PPRIV(I)) ~= TEMP_PRIV
     2632    20228    4            THEN
     2633    20229    4               FROM_USERS.PPRIV(I) = FROM_USERS.PPRIV(I) & ~(TEMP_PRIV);
     2634    20230    4         END;
     2635    20231
     2636    20232                                                      /*
     2637    20233                                                         Compare fe privileges
     2638    20234                                                      */
     2639    20235    4      DO J = 0 TO SIZEW(AS_PRIVILEGE)-1;
     2640    20236    4         TEMP_PRIV = AS_PRIVILEGE(J);
     2641    20237    4         IF (TEMP_PRIV & FROM_DREC.FROM_BLK.PRIV(I) ) = TEMP_PRIV
     2642    20238    4         THEN
     2643    20239    4            IF (TEMP_PRIV & MAX_DREC.MAX_BLK.PRIV(I) ) ~= TEMP_PRIV
     2644    20240    4            THEN
     2645    20241    4               FROM_DREC.FROM_BLK.PRIV(I) = FROM_DREC.FROM_BLK.PRIV(I) & ~(TEMP_PRIV);
     2646    20242    4         END;
     2647    20243                                                      /*
     2648    20244                                                         Compare fe pprivileges
     2649    20245                                                      */
     2650    20246    4      DO J = 0 TO SIZEW(AS_PPRIVILEGE)-1;
     2651    20247    4         TEMP_PRIV = AS_PPRIVILEGE(J);
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:90   
     2652    20248    4         IF (TEMP_PRIV & FROM_DREC.FROM_BLK.PPRIV(I) ) = TEMP_PRIV
     2653    20249    4         THEN
     2654    20250    4            IF (TEMP_PRIV & MAX_DREC.MAX_BLK.PPRIV(I) ) ~= TEMP_PRIV
     2655    20251    4            THEN
     2656    20252    4               FROM_DREC.FROM_BLK.PPRIV(I) = FROM_DREC.FROM_BLK.PPRIV(I) & ~(TEMP_PRIV)
             20252                        ;
     2657    20253    4         END;
     2658    20254    3      END;        /* Do i = 0 to 3 */
     2659    20255
     2660    20256    3   DO J = 0 TO 71;
     2661    20257    3      IF FROM_USERS.KEY(J) AND NOT MAX_USERS.KEY(J) THEN
     2662    20258    3         FROM_USERS.KEY(J) = AS_FALSE;
     2663    20259    3      END;
     2664    20260
     2665    20261    2   END COMPARE_FROM_TO_MAX;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:91   
     2667    20263    1   END   ASA$SUPER ;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:92   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$SUPER.

   Procedure ASA$SUPER requires 5755 words for executable code.
   Procedure ASA$SUPER requires 86 words of local(AUTO) storage.

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:93   

 Object Unit name= ASA$SUPER                                  File name= ASA$SUPER.:E05TOU
 UTS= JUL 29 '97 08:46:23.16 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none   192    300  ASA$SUPER
    3  RoData even  UTS    119    167  ASA$SUPER
    4   Proc  even  none  5755  13173  ASA$SUPER
    5  RoData even  none   180    264  ASA$SUPER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Main       0  ASA$SUPER
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:94   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       0 ASB$OPEN_USERS_UP
 yes     yes           Std       0 ASF$OPEN_FORM_CR
 yes     yes           Std       0 ASB$CLOSE_PROJ
         yes           Std       1 ASH$U_PARSE
         yes           Std       0 ASR$R_TERMINAL
 yes     yes           Std       0 ASB$CLOSE_USERS
         yes           Std       4 ASB$BINCHAR
 yes     yes           Std       0 ASD$OPEN_PRO_UP
         yes           Std       0 ASC$BUILD_CHARSET
 yes     yes           Std       0 ASW$BUILD_WSN
         yes           Std       0 ASA$TERMINAL
         yes           Std       0 ASW$WSN
         yes           Std       0 ASC$CHARSET
         yes           Std       2 ASB$WRITE_LO
 yes     yes           Std       0 ASB$DEQ
 yes     yes           Std       0 ASB$CLOSE_HLP
         yes           Std       2 ASB$READ_SI
 yes     yes           Std       0 ASD$CLOSE_PRO
 yes     yes           Std       0 ASB$OPEN_PROJ_CR
         yes          Async      0 ASB$BREAK
         yes           Std       0 ASD$PROFILE
         yes           Std       0 ASR$R_LINK_VIRCIR
         yes           Std       0 ASB$OPEN_SI_LO_DO
         yes           Std       0 ASA$B_USERS_HLP
         yes           Std       1 ASF$FORM
 yes     yes           Std       0 ASF$OPEN_FORM_UP
         yes           Std       0 ASF$BUILD_FORM
 yes     yes           Std       0 ASB$OPEN_COMGROUP
         yes           Std       0 ASR$R_STATION
         yes           Std       0 ASR$R_CONSOLE
         yes           Std       0 ASA$CONSOLE
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:95   
         yes           Std       0 ASH$HELP
 yes     yes           Std       0 ASW$OPEN_WSN_UP
         yes           Std       1 ASL$LIST
         yes           Std       0 ASA$STATION
         yes           Std       0 ASR$D_CHARSET_RECS
         yes           Std       2 ASH$ERROR
         yes           Std       0 ASD$CREATE_PRO
 yes     yes           Std       0 ASB$OPEN_PROJ_UP
         yes           Std       0 ASR$D_FORM_RECS
         yes           Std       0 ASH$QUEST
         yes           Std       0 ASA$LINE_CONTROLLER
         yes           Std       0 ASR$R_LINE_CONT
         yes           Std       0 ASR$R_CHARSET
         yes           Std       0 ASA$DEVICE
 yes     yes           Std       0 ASB$OPEN_HLP_UP
         yes           Std       2 ASH$WARN
         yes           Std       1 ASZ$SCRAMBLE
 yes     yes           Std       3 ASB$SET_PROMPT
         yes           Std       0 ASR$R_FORM
         yes           Std       0 ASA$LINK_VIRCIR
         yes           Std       0 ASR$R_TPDEVICE
         yes           Std       0 ASR$D_USERS_RECS
 yes     yes           Std       1 ASC$CONFIG
 yes     yes           Std       1 X$PARSE
         yes           Std       0 ASB$CLOSE_LO
         yes           Std       0 ASH$DQUEST
         yes           Std       0 ASR$R_PROFILE
 yes     yes           Std       2 ASB$FREE_SEG
 yes     yes           Std       1 XUG$OPENOUT
         yes           Std       0 ASR$R_WSN
         yes           Std       0 ASR$R_DEVICE
 yes     yes           Std       2 ASC$CHECK_TIGR_WSN
         yes           Std       0 ASR$R_STAT_TIGR
         yes           Std       1 ASC$CM_OPTS
 yes     yes           Std       1 ASB$WRITE_USERS
         yes           Std       1 ASA$PROJECT
         yes           Std       0 ASC$MOD_USER
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:96   
 yes     yes           Std       3 ASA$UNTIE_USER
 yes     yes           Std       6 ASB$GET
 yes     yes           Std       2 ASB$WRITE_HLP
 yes     yes           Std       0 ASB$WRITE_USERS_KEY
 yes     yes           Std       3 ASB$READ_PROJ_SEQ
 yes     yes           Std       0 ASB$PREC_PROJ
 yes     yes           Std       0 ASB$DELREC_PROJ
         yes           Std       1 ASB$LIST
 yes     yes           Std       4 ASB$KEYMAKER
         yes           Std       3 ASA$UNTIE_PROJECT
 yes     yes           Std       0 ASB$DELREC_USERS
         yes           Std       2 ASA$KEYCONV
         yes           Std       2 ASH$INFO
 yes     yes           Std       2 ASB$WRITE_PROJ
 yes     yes           Std       0 ASB$DEQ_PROJ
         yes           Std       4 ASA$TIE_PROJECT
 yes     yes           Std       4 ASA$TIE_USER
 yes     yes           Std       0 ASB$GET_NEXT
         yes           Std       3 ASA$ERROR
 yes     yes           Std       5 ASB$ACCT_OK
         yes           Std       0 ASB$FLUSH
         yes           Std       4 ASB$BINXCHAR
 yes     yes           Std       0 ASB$GETSEG
 yes     yes           Std       1 ASB$READ_USERS
 yes     yes           Std       3 ASB$READ_HLP
 yes     yes           Std       2 ASB$INIT_GET_NEXT
 yes     yes           Std       0 ASB$ENQ_PROJ
 yes     yes           Std       3 ASB$GET_MGRANS
 yes     yes           Std       3 ASB$READ_PROJ
         yes           Std       3 ASR$R_PROJECT
 yes     yes           Std       0 ASB$ENQ_USERS
 yes     yes           Std       1 ASR$R_USER
 yes     yes           Std       1 ASB$PIG
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MAUTO
                       nStd      0 X66_MARET
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:97   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  CMD_NODES                             CR_MOD_CMD
     B$JIT$                           r    AS_BLANK                         r    AS_TRUE
r    AS_FALSE                         r    AS_NONE                          r    AS_PRIVILEGE
r    AS_PPRIVILEGE                    r    AS_MODE                          r    AS_FE_MODE
r    KL_DREC$                         r    KL_DFLT$                         r    AS_DEFAULT_DREC$
r    AS_PROJ_ADMIN_DREC$              r    AS_PROJECT_DREC$                 r    AS_PROJECT_DFLT_DREC$
     M$LO                                  USERS_KEY                             PROJ_KEY
     FROM_KEY                              LO_WIDTH                              BLANK_PASS
     IN_BUF                                OUT_BUF                               NODE$
     CODE                                  SUPERAUTH                             SUPERWSN
     SUPERFORM                             SUPERD                                PADMIN
     ERR_CODE                              AS_FIELD1                             AS_FIELD2
     AS_FIELD3                             B_VERSION                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG_FLG
     DSEG1$                                DSEG1SIZE                             DSEG2$
     DSEG2SIZE                             DSEG3$                                DSEG3SIZE
     ENQDEQ_FLG                            ERR_CNT                               WARN_CNT
     AS_PROJECT_ADMIN                      AS_LOGON_KEY                          AS_WILD_USER
     AS_RESOURCE_LIST$                     AS_FERESOURCE_LIST$                   AS_PSEUDO_LIST$
     AS_FEPSEUDO_LIST$                     AS_PROJ_HEADER$                       AS_SUPER_TO_PIG$
     AS_CR_MOD_PROJ                        FROM_FLG                              CR_MOD_FLG
     AS_WILD_MCH                           P_PCB                                 AS_USERS
     AS_DFLT                               AS_DEFAULT                            AS_PROJ_ADMIN
     AS_PROJECT                            AS_PROJECT_DFLT                  r    AS_USERS_CONSTANT
     KL_DREC_CNT                           KL_DREC                               KL_DFLT
     AS_DEFAULT_DREC                       AS_PROJ_ADMIN_DREC                    AS_PROJECT_DREC
     AS_PROJECT_DFLT_DREC             r    KL_DEFAULT                            AS_MOD_USER
r    AS_CONSTANT_PROJ_HEADER               B_VECTNIL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:98   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:99   


        1        1        /*M* ASA$SUPER MAIN ROUTINE FOR SUPER.                  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        /*   ASA$SUPER : Main routine for super consists of procedures:
       11       11                         ASA$SUPER
       12       12                         ASA$ERROR
       13       13                         ASA$KEYCONV
       14       14                                                                          */
       15       15        ASA$SUPER: PROC MAIN ;

     15  4 000000   000000 700200 xent  ASA$SUPER    TSX0  ! X66_MAUTO
         4 000001   000126 000000                    ZERO    86,0

       16       16                                                              /**/
       17       17        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:100  
       18       18        /********************************************************************/
       19       19        /*   Include files   include files   include files   include files   */
       20       20        /*********************************************************************/
       21       21                                                              /**/
       22       22        %INCLUDE           AS_ENTRIES_M ;
       23     1072        %INCLUDE           AS_MAC_C     ;
       24     1152        %INCLUDE           AS_SUPER_C   ;
       25     1587        %INCLUDE           XU_MACRO_C   ;
       26     4693        %INCLUDE           XU_FORMAT_C  ;
       27     4855        %INCLUDE           KL_SUPER_C   ;
       28     7757        %INCLUDE           AS_SUBS_C    ;
       29     9171        %INCLUDE           AS_PERR_C    ;
       30     9773        %INCLUDE           B_MACROS_C   ;
       31     9884        %INCLUDE           B_ERRORS_C   ;
       32    11011        %INCLUDE           CP_6         ;
       33    11092        %INCLUDE           CP_6_SUBS    ;
       34    11632        %INCLUDE           JG_GHOSTS_C  ;
       35    11722        %INCLUDE           AS_SUPER_R   ;
       36    14738 S      %INCLUDE            B$JIT_C    ;
       37    14739             %B$JIT0 ;
       38    14828             %U$JIT1 ;
       39    14902             %M$JIT2 ;
       40    14912             %F$JIT3 ;
       41    14917             %S$JIT4 ;
       42    14923             %J$JIT5 ;
       43    15011             %A$JIT6 ;
       44    15021                                                              /**/
       45    15022        %SET LISTSUB = '1'B ;
       46    15023        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:101  
       47    15024        /********************************************************************/
       48    15025        /*   Dcbs            dcbs            dcbs            dcbs            */
       49    15026        /*********************************************************************/
       50    15027        /********************************************************************/
       51    15028        /*   Static data     static data     static data     static data     */
       52    15029        /*********************************************************************/
       53    15030                                                              /**/
       54    15031    1   DCL MORE BIT(1) STATIC ;
       55    15032    1   DCL SIZEC_DREC UBIN CONSTANT INIT( SIZEC(KL_DREC_CNT) );
       56    15033    1   DCL HLP$ PTR STATIC INIT( ADDR(KL_DREC) );
       57    15034    1   DCL 1 ASH_FCG CONSTANT ,
       58    15035    1          2 FCG_MID UBIN(18) INIT(5320) UNAL ;     /*  'ASH' in sixbit  */
       59    15036        %FPT_EXIT( STEPCC=OK );
       60    15051
       61    15052        %FPT_PRIV (PPRIV=YES);
       62    15067
       63    15068        %XUG_GETCMD ( FPT=OPEN_LO_FPT,
       64    15069                      DCB_PARAM = M$LO);
       65    15407
       66    15408        %FPT_OPEN (FPTN = OPEN_LO_FPT,
       67    15409                   DCB = M$LO);
       68    15518
       69    15519                                                              /**/
       70    15520        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:102  
       71    15521        /********************************************************************/
       72    15522        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       73    15523        /*********************************************************************/
       74    15524                                                              /**/
       75    15525    1   DCL X$PARSE ENTRY(1) ALTRET ;
       76    15526        %ASA$B_USERS_HLP ;
       77    15529        %ASB$SET_PROMPT ;
       78    15532        %ASA$CONSOLE ;
       79    15535        %ASA$TERMINAL ;
       80    15538        %ASA$STATION ;
       81    15541        %ASA$DEVICE ;
       82    15544        %ASA$PROJECT ;
       83    15547        %ASA$KEYCONV ;
       84    15550        %ASA$UNTIE_USER ;
       85    15553        %ASA$UNTIE_PROJECT ;
       86    15556        %ASA$TIE_USER ;
       87    15559        %ASA$TIE_PROJECT ;
       88    15562        %ASA$ERROR ;
       89    15565        %ASA$LINK_VIRCIR ;
       90    15568        %ASA$LINE_CONTROLLER ;
       91    15571        %ASB$ACCT_OK ;
       92    15574        %ASB$BREAK ;
       93    15577        %ASB$CLOSE_HLP ;
       94    15580        %ASB$CLOSE_LO ;
       95    15583        %ASB$CLOSE_PROJ ;
       96    15586        %ASB$CLOSE_USERS ;
       97    15589        %ASB$DELREC_PROJ ;
       98    15592        %ASB$DELREC_USERS ;
       99    15595        %ASB$DEQ ;
      100    15598        %ASB$DEQ_HLP ;
      101    15601        %ASB$DEQ_PROJ ;
      102    15604        %ASB$ENQ ;
      103    15607        %ASB$ENQ_HLP ;
      104    15610        %ASB$ENQ_PROJ ;
      105    15613        %ASB$ENQ_USERS ;
      106    15616        %ASB$FIND_NUM ;
      107    15619        %ASB$FLUSH ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:103  
      108    15622        %ASB$FREE_SEG ;
      109    15625        %ASB$GET ;
      110    15628        %ASB$GET_MGRANS ;
      111    15631        %ASB$GET_NEXT ;
      112    15634        %ASB$GETSEG ;
      113    15637        %ASB$INIT_GET_NEXT ;
      114    15640        %ASB$KEYMAKER ;
      115    15643        %ASB$LIST ;
      116    15646        %ASB$OPEN_COMGROUP ;
      117    15649        %ASB$OPEN_HLP_UP ;
      118    15652        %ASB$OPEN_PROJ_CR ;
      119    15655        %ASB$OPEN_PROJ_UP ;
      120    15658        %ASB$OPEN_SI_LO_DO ;
      121    15661        %ASB$OPEN_USERS_UP ;
      122    15664        %ASB$PIG ;
      123    15667        %ASB$PREC_PROJ ;
      124    15670        %ASB$READ_HLP ;
      125    15673        %ASB$READ_PROJ ;
      126    15676        %ASB$READ_PROJ_SEQ ;
      127    15679        %ASB$READ_SI ;
      128    15682        %ASB$READ_USERS ;
      129    15685        %ASB$WRITE_HLP ;
      130    15688        %ASB$WRITE_LO ;
      131    15691        %ASB$WRITE_PROJ ;
      132    15694        %ASB$WRITE_USERS ;
      133    15697        %ASB$WRITE_USERS_KEY ;
      134    15700        %ASC$BUILD_CHARSET ;
      135    15703        %ASC$CHARSET ;
      136    15706        %ASC$CHECK_TIGR_WSN ;
      137    15709        %ASC$CM_OPTS ;
      138    15712        %ASC$CONFIG ;
      139    15715        %ASC$MOD_USER ;
      140    15718        %ASD$CLOSE_PRO ;
      141    15721        %ASD$CREATE_PRO ;
      142    15724        %ASD$OPEN_PRO_UP ;
      143    15727        %ASD$PROFILE ;
      144    15730        %ASD$READ_PRO ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:104  
      145    15733        %ASF$BUILD_FORM ;
      146    15736        %ASF$FORM ;
      147    15739        %ASF$OPEN_FORM_CR ;
      148    15742        %ASF$OPEN_FORM_UP ;
      149    15745        %ASH$DQUEST ;
      150    15748        %ASH$ERROR ;
      151    15751        %ASH$HELP ;
      152    15754        %ASH$INFO ;
      153    15757        %ASH$QUEST ;
      154    15760        %ASH$U_PARSE ;
      155    15763        %ASH$WARN ;
      156    15766        %ASL$LIST ;
      157    15769        %ASR$D_CHARSET_RECS ;
      158    15772        %ASR$D_FORM_RECS ;
      159    15775        %ASR$D_USERS_RECS ;
      160    15778        %ASR$R_DEVICE ;
      161    15781        %ASR$R_CHARSET ;
      162    15784        %ASR$R_CONSOLE ;
      163    15787        %ASR$R_FORM ;
      164    15790        %ASR$R_LINE_CONT ;
      165    15793        %ASR$R_LINK_VIRCIR ;
      166    15796        %ASR$R_PROFILE ;
      167    15799        %ASR$R_PROJECT ;
      168    15802        %ASR$R_STAT_TIGR ;
      169    15805        %ASR$R_STATION ;
      170    15808        %ASR$R_TERMINAL ;
      171    15811        %ASR$R_TPDEVICE ;
      172    15814        %ASR$R_USER ;
      173    15817        %ASR$R_WSN ;
      174    15820        %ASW$WSN ;
      175    15823        %ASW$BUILD_WSN ;
      176    15826        %ASW$OPEN_WSN_UP ;
      177    15829        %ASZ$SCRAMBLE ;
      178    15832    1   DCL XUG$INIT ENTRY(2) ALTRET;
      179    15833    1   DCL XUG$OPENOUT ENTRY(1) ALTRET;
      180    15834        %FPT_INT(FPTN=INTFPT,
      181    15835                   UENTRY=ASB$BREAK);
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:105  
      182    15849                                                              /**/
      183    15850        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:106  
      184    15851        /********************************************************************/
      185    15852        /*   Auto data       auto data       auto data       auto data       */
      186    15853        /*********************************************************************/
      187    15854                                                              /**/
      188    15855    1   DCL ARS SBIN ;
      189    15856    1   DCL ERR_SEV UBIN ;
      190    15857    1   DCL SUBNODES UBIN ;
      191    15858    1   DCL P$ PTR ;
      192    15859    1   DCL BLK$ PTR ;
      193    15860    1   DCL STR$TEXT CHAR(20) BASED ALIGNED ;
      194    15861    1   DCL NO_EXISTS BIT(1) ;
      195    15862    1   DCL 1 ERR_BUF ALIGNED ,
      196    15863    1          2 CNT UBIN(9) UNAL ,
      197    15864    1          2 TEXT CHAR(40) UNAL ;
      198    15865    1   DCL I UBIN ;
      199    15866    1   DCL TEMP_PRIV(0:2) BIT(36) ;
      200    15867    1   DCL DCB$ PTR ;
      201    15868    1   DCL PTR$ PTR ;
      202    15869    1   DCL CNT UBIN WORD ;
      203    15870    1   DCL CERR_CNT CHAR(4) ;
      204    15871    1   DCL 1 VARY$STR BASED UNAL ,
      205    15872    1          2 TXT CHAR(CNT) UNAL ;
      206    15873    1   DCL 1 T_ERR_CODE ,
      207    15874    1          2 FCG UBIN(18) UNAL ,
      208    15875    1          2 CODE UBIN(15) UNAL ,
      209    15876    1          2 SEV UBIN(3) UNAL ;
      210    15877    1   DCL DELETE_FLAG BIT (1);
      211    15878    1   DCL DELETE_PROMPT CHAR (29);
      212    15879    1   DCL FREE_SEG_SIZE UBIN;
      213    15880    1   DCL FREE_SEG_TYPE UBIN;
      214    15881                                                              /**/
      215    15882        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:107  
      216    15883        /********************************************************************/
      217    15884        /*   Local based     local based     local based     local based     */
      218    15885        /*********************************************************************/
      219    15886                                                              /**/
      220    15887        %LIST ;
      221    15888        %SUPER_TO_PIG( STCLASS="BASED(AS_SUPER_TO_PIG$)" );
             15889    1   DCL 1 SUPER_TO_PIG BASED(AS_SUPER_TO_PIG$) ALIGNED ,
             15890    1          2 TYPE UBIN BYTE UNAL ,       /* Type of transaction */
             15891        %IF '1'B='1'B;
             15892        %EQU CREATE_ACCT   = 0;              /* Create an account       */
             15893        %EQU MODIFY_ACCT   = 1;              /* Modify an account       */
             15894        %EQU LIST_ACCT     = 2;              /* List an account         */
             15895        %EQU VALIDATE_ATTR = 3;              /* Validate attribute list */
             15896        %EQU DELETE_ACCT   = 4;              /* Delete an account       */
             15897        %ENDIF;
             15898    1          2 PROJ BIT(1) UNAL,           /* '1'b => project administrator
             15899                                                '0'b => system  adminstrator */
             15900    1          2 WIDTH UBIN(8) UNAL ,       /* Width of output line */
             15901    1          2 SUPER,                      /* Project or system administrator  */
             15902    1             3 ACCT CHAR(8) UNAL ,      /* who is using super. */
             15903    1             3 UNAME CHAR(12) UNAL ,
             15904    1          2 RESUPER REDEF SUPER CHAR(20) ,
             15905    1          2 PROJECT,                    /* Name of project */
             15906    1             3 ACCT CHAR(8) UNAL,
             15907    1             3 UNAME CHAR(12) UNAL,
             15908    1          2 PROJECT_TEXT REDEF PROJECT CHAR(20),
             15909    1          2 PACKSET CHAR(6) UNAL ,      /* Packset name */
             15910    1          2 ACCT CHAR(8) UNAL ,         /* File management account */
             15911    1          2 ATTR,
             15912    1             3 COUNT UBIN HALF UNAL ,   /* Length of attribute list */
             15913        %LSET STR=CONCAT(TEXTCHAR(BASED(AS_SUPER_TO_PIG$)),'     ');
             15914        %IF (((SUBSTR(STR,0,5)='BASED') OR SUBSTR(STR,0,1)=' ') AND '1'B='1'B);
             15915    1             3 LIST CHAR(SUPER_TO_PIG.ATTR.COUNT);/* Attribute list */
             15916        %ELSE;
             15918        %ENDIF;
      222    15920            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      223    15921                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:108  
             15922        /*F*  NAME:     PARSE$OUT
             15923              FUNCTION: a structure built by X$PARSE which corresponds to a "list",
             15924                  "alternative", "reducing alternative", or "koncat" node in
             15925                  the user's parse tree.
             15926        */
             15927    1   DCL 1 P$NODE BASED(NODE$) ALIGNED,
             15928    1         2 TEMP BIT(1) UNAL,
             15929    1         2 * BIT (11) UNAL,
             15930    1         2 TYPE UBIN (6) UNAL,
             15931        /*K* NDTYPE - specifies the type of parse node to which this PARSE$OUT
             15932                  block corresponds.  See the XU_SUBS_C file for the
             15933                  %EQU symbols whose values may appear in this field.
             15934        */
             15935    1         2 CODE UBIN HALF HALIGNED,
             15936        /*K* CODE - Contains the numeric "node code" specified by the user when
             15937                  the corresponding parse-node was defined.
             15938        */
             15939    1         2 SUBNODES UBIN HALF HALIGNED,
             15940        /*K* NSUBLKS - "number of sub-blocks".  This field contains the count of
             15941                  pointers actually available in the PARSE$OUT.SUBLK$ array.
             15942        */
             15943    1         2 SCRITCH UBIN HALF HALIGNED,
             15944        /*K* SCRITCH - an 18-bit scratch field reserved for the user.  X$PARSE
             15945                  initializes this field to zero when the PARSE$OUT structure
             15946                  is allocated, and never sets or examines it thereafter.
             15947                  The name of this field may be changed when the PARSE$OUT macro
             15948                  is invoked by the user (say "SCRITCH=yourname"), and its data
             15949                  type may also be changed (say "SCRMODE=pl6datatype" and
             15950                  "SCRALGN=alignment").  BEWARE: this field MUST be 18-bits long,
             15951                  and be UNALIGNED, CALIGNED, or HALIGNED.
             15952        */
             15953    1         2 CPOS UBIN WORD,
             15954        /*K* CPOS - "character position" of this block.  This field will contain
             15955                  a character index (starting at 0) into the original parse
             15956                  string;  the index identifies the first character of the
             15957                  string which was accepted by this node (or by any of its
             15958                  sub-nodes).
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:109  
             15959        */
             15960    1         2 SUBLK$(0:0) PTR UNAL;
             15961        /*K* SUBLK$ - an array of PL-6 PTRs.  The number of elements in this array
             15962                  is found in OUT$BLK.NSUBLKS;  each PTR will point to another
             15963                  OUT$BLK structure, or to an OUT$SYM structure.
             15964        */
      224    15966              %PARSE$SYM( NAME = OUT$SYM ,
      225    15967                          STCLASS="BASED(BLK$)") ;
             15968        /*F*  NAME:     PARSE$SYM
             15969              FUNCTION: holds "parse symbols".  Structures of this form are created
             15970                  by X$PARSE to hold those portions of the string being parsed
             15971                  which must be returned to the user - quoted strings, decimal
             15972                  or octal numbers, PL-6 identifiers, etc.
             15973        */
             15974    1   DCL 1 OUT$SYM BASED(BLK$) ALIGNED,
             15975    1         2 TEMP BIT(1) UNAL,
             15976    1         2 * BIT (11) UNAL,
             15977    1         2 NDTYPE UBIN (6) UNAL,
             15978        /*K* NDTYPE - see OUT$BLK.NDTYPE for details.
             15979        */
             15980    1         2 CODE UBIN HALF HALIGNED,
             15981        /*K* CODE - see OUT$BLK.CODE for details.
             15982        */
             15983    1         2 NSUBLKS UBIN HALF HALIGNED,
             15984        /*K* NSUBLKS - always contains the value 1.
             15985        */
             15986    1         2 SCRITCH UBIN HALF HALIGNED,
             15987        /*K* SCRITCH - see OUT$BLK.SCRITCH for details.
             15988        */
             15989    1         2 CPOS UBIN WORD,
             15990        /*K* CPOS - see OUT$BLK.CPOS for details.
             15991        */
             15992    1         2 TEXTC$ PTR,
             15993        /*K* TEXTC$ - a pointer to a TEXTC-type string (a 1-byte count field
             15994                  followed by a variable number of characters).  Always
             15995                  points to OUT$SYM.COUNT in the current OUT$SYM block.
             15996        */
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:110  
             15997    1         2 COUNT UBIN BYTE CALIGNED,
             15998        /*K* COUNT - contains the number of characters in OUT$SYM.TEXT.
             15999        */
             16000    1         2 TEXT CHAR(OUT$SYM.COUNT) CALIGNED;
             16001        /*K* TEXT - contains the text of a string, decimal number, PL-6
             16002                  identifier, or some other parser "symbol".
             16003        */
      226    16005        %PLIST ;
      227    16006              %F$DCB( DCBN = F$DCB ) ;
      228    16063    1   DCL UBIN$WORD UBIN BASED;
      229    16064                                                              /**/
      230    16065        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:111  
      231    16066        /********************************************************************/
      232    16067        /*   Procedure       procedure       procedure       procedure       */
      233    16068        /*********************************************************************/
      234    16069                                                              /**/
      235    16070        /*
      236    16071            ***            Begin procedure                    ***
      237    16072        */
      238    16073    1   CALL M$INT(INTFPT);    /*  Est brk control   */

  16073  4 000002   000160 630400 2                  EPPR0   INTFPT
         4 000003   010002 713400                    CLIMB   4098
         4 000004   400000 401760                    pmme    nvectors=1

      239    16074    1   CALL ASB$OPEN_SI_LO_DO;

  16074  4 000005   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000006   000000 701000 xent               TSX1    ASB$OPEN_SI_LO_DO
         4 000007   000000 011000                    NOP     0

      240    16075    1   CALL CONCAT( AS_LOGON_KEY.TEXT, B$JIT.ACCN, B$JIT.UNAME );

  16075  4 000010   000000 470400 xsym               LDP0    B$JIT$
         4 000011   040000 100500                    MLR     fill='040'O
         4 000012   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         4 000013   000000 200010 xsym               ADSC9   AS_LOGON_KEY             cn=1,n=8
         4 000014   040000 100500                    MLR     fill='040'O
         4 000015   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         4 000016   000002 200014 xsym               ADSC9   AS_LOGON_KEY+2           cn=1,n=12

      241    16076    1   CALL INDEX( I, ' ', B$JIT.UNAME );

  16076  4 000017   000000 470400 xsym               LDP0    B$JIT$
         4 000020   000000 124500                    SCM     mask='000'O
         4 000021   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         4 000022   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000023   200024 000100                    ARG     I,,AUTO

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:112  
      242    16077    1   AS_LOGON_KEY.CNT = 8 + I;

  16077  4 000024   200024 236100                    LDQ     I,,AUTO
         4 000025   000010 036007                    ADLQ    8,DL
         4 000026   000033 736000                    QLS     27
         4 000027   000000 552040 xsym               STBQ    AS_LOGON_KEY,'40'O

      243    16078    1   T_ERR_CODE = '0'B;

  16078  4 000030   200034 450100                    STZ     T_ERR_CODE,,AUTO

      244    16079                                                            /* Check for super ppriv. */
      245    16080    1   FPT_PRIV.V.PRIV# = %PPR_SUPER#;

  16080  4 000031   000002 236000 3                  LDQ     SIZEC_DREC+2
         4 000032   000012 756000 2                  STQ     FPT_PRIV+2

      246    16081    2   CALL M$SPRIV (FPT_PRIV) WHENRETURN DO;

  16081  4 000033   000010 630400 2                  EPPR0   FPT_PRIV
         4 000034   420012 713400                    CLIMB   alt,+8202
         4 000035   400000 401760                    pmme    nvectors=1
         4 000036   000056 702000 4                  TSX2    s:16092

      247    16082    2      SUPERAUTH = AS_TRUE ;

  16082  4 000037   000000 236000 xsym               LDQ     AS_TRUE
         4 000040   400000 376003                    ANQ     -131072,DU
         4 000041   000000 756000 xsym               STQ     SUPERAUTH

      248    16083    2      SUPERWSN  = AS_TRUE ;

  16083  4 000042   000000 756000 xsym               STQ     SUPERWSN

      249    16084    2      SUPERFORM = AS_TRUE ;

  16084  4 000043   000000 756000 xsym               STQ     SUPERFORM
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:113  

      250    16085    2      FPT_PRIV.V.PRIV# = %PPR_PADMIN#;

  16085  4 000044   000026 236000 xsym               LDQ     B_VECTNIL+22
         4 000045   000012 756000 2                  STQ     FPT_PRIV+2

      251    16086    3      CALL M$SPRIV (FPT_PRIV) WHENRETURN DO; /* if padmin mode is set */

  16086  4 000046   000010 630400 2                  EPPR0   FPT_PRIV
         4 000047   420012 713400                    CLIMB   alt,+8202
         4 000050   400000 401760                    pmme    nvectors=1
         4 000051   000055 702000 4                  TSX2    s:16089

      252    16087    3         PADMIN = AS_TRUE;

  16087  4 000052   000000 236000 xsym               LDQ     AS_TRUE
         4 000053   400000 376003                    ANQ     -131072,DU
         4 000054   000000 756000 xsym               STQ     PADMIN

      253    16088    3         END;

      254    16089    2      END;

  16089  4 000055   000133 710000 4                  TRA     s:16107

      255    16090    2   WHENALTRETURN DO; /* From the superall check */

      256    16091                                                   /* Check for superauth ppriv. */
      257    16092    2      FPT_PRIV.V.PRIV# = %PPR_SUPERAUTH#;

  16092  4 000056   000003 236000 3                  LDQ     SIZEC_DREC+3
         4 000057   000012 756000 2                  STQ     FPT_PRIV+2

      258    16093    3      CALL M$SPRIV (FPT_PRIV) WHENRETURN DO; SUPERAUTH = AS_TRUE; END;

  16093  4 000060   000010 630400 2                  EPPR0   FPT_PRIV
         4 000061   420012 713400                    CLIMB   alt,+8202
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:114  
         4 000062   400000 401760                    pmme    nvectors=1
         4 000063   000067 702000 4                  TSX2    s:16095

  16093  4 000064   000000 236000 xsym               LDQ     AS_TRUE
         4 000065   400000 376003                    ANQ     -131072,DU
         4 000066   000000 756000 xsym               STQ     SUPERAUTH

      259    16094                                                  /* Check for superwsn ppriv. */
      260    16095    2      FPT_PRIV.V.PRIV# = %PPR_SUPERWSN#;

  16095  4 000067   000004 236000 3                  LDQ     SIZEC_DREC+4
         4 000070   000012 756000 2                  STQ     FPT_PRIV+2

      261    16096    3      CALL M$SPRIV (FPT_PRIV) WHENRETURN DO; SUPERWSN = AS_TRUE; END;

  16096  4 000071   000010 630400 2                  EPPR0   FPT_PRIV
         4 000072   420012 713400                    CLIMB   alt,+8202
         4 000073   400000 401760                    pmme    nvectors=1
         4 000074   000100 702000 4                  TSX2    s:16098

  16096  4 000075   000000 236000 xsym               LDQ     AS_TRUE
         4 000076   400000 376003                    ANQ     -131072,DU
         4 000077   000000 756000 xsym               STQ     SUPERWSN

      262    16097                                                  /* Check for superform ppriv. */
      263    16098    2      FPT_PRIV.V.PRIV# = %PPR_SUPERFORM#;

  16098  4 000100   000005 236000 3                  LDQ     SIZEC_DREC+5
         4 000101   000012 756000 2                  STQ     FPT_PRIV+2

      264    16099    3      CALL M$SPRIV (FPT_PRIV) WHENRETURN DO; SUPERFORM = AS_TRUE; END;

  16099  4 000102   000010 630400 2                  EPPR0   FPT_PRIV
         4 000103   420012 713400                    CLIMB   alt,+8202
         4 000104   400000 401760                    pmme    nvectors=1
         4 000105   000111 702000 4                  TSX2    s:16101

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:115  
  16099  4 000106   000000 236000 xsym               LDQ     AS_TRUE
         4 000107   400000 376003                    ANQ     -131072,DU
         4 000110   000000 756000 xsym               STQ     SUPERFORM

      265    16100                                                 /* Check for superd ppriv. */
      266    16101    2      FPT_PRIV.V.PRIV# = %PPR_SUPERD#;

  16101  4 000111   000022 236000 xsym               LDQ     B_VECTNIL+18
         4 000112   000012 756000 2                  STQ     FPT_PRIV+2

      267    16102    3      CALL M$SPRIV (FPT_PRIV) WHENRETURN DO; SUPERD = AS_TRUE; END;

  16102  4 000113   000010 630400 2                  EPPR0   FPT_PRIV
         4 000114   420012 713400                    CLIMB   alt,+8202
         4 000115   400000 401760                    pmme    nvectors=1
         4 000116   000122 702000 4                  TSX2    s:16104

  16102  4 000117   000000 236000 xsym               LDQ     AS_TRUE
         4 000120   400000 376003                    ANQ     -131072,DU
         4 000121   000000 756000 xsym               STQ     SUPERD

      268    16103                                                 /* Check for padmin ppriv. */
      269    16104    2      FPT_PRIV.V.PRIV# = %PPR_PADMIN#;

  16104  4 000122   000026 236000 xsym               LDQ     B_VECTNIL+22
         4 000123   000012 756000 2                  STQ     FPT_PRIV+2

      270    16105    3      CALL M$SPRIV (FPT_PRIV) WHENRETURN DO; PADMIN = AS_TRUE; END;

  16105  4 000124   000010 630400 2                  EPPR0   FPT_PRIV
         4 000125   420012 713400                    CLIMB   alt,+8202
         4 000126   400000 401760                    pmme    nvectors=1
         4 000127   000133 702000 4                  TSX2    s:16107

  16105  4 000130   000000 236000 xsym               LDQ     AS_TRUE
         4 000131   400000 376003                    ANQ     -131072,DU
         4 000132   000000 756000 xsym               STQ     PADMIN
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:116  

      271    16106    2      END;

      272    16107    1   IF NOT SUPERAUTH  AND  NOT SUPERWSN  AND  NOT SUPERFORM  AND  NOT PADMIN  AND  NOT
             16107            SUPERD

  16107  4 000133   000000 234000 xsym               SZN     SUPERAUTH
         4 000134   000152 604000 4                  TMI     IS_USERS_THERE
         4 000135   000000 234000 xsym               SZN     SUPERWSN
         4 000136   000152 604000 4                  TMI     IS_USERS_THERE
         4 000137   000000 234000 xsym               SZN     SUPERFORM
         4 000140   000152 604000 4                  TMI     IS_USERS_THERE
         4 000141   000000 234000 xsym               SZN     PADMIN
         4 000142   000152 604000 4                  TMI     IS_USERS_THERE
         4 000143   000000 234000 xsym               SZN     SUPERD
         4 000144   000152 604000 4                  TMI     IS_USERS_THERE

      273    16108    2   THEN DO;

      274    16109        /*E*  ERROR:    ASA-E$NOSUPERPRIV-C
      275    16110              MESSAGE0: You do not have the privilege needed to run SUPER.
      276    16111
      277    16112        */
      278    16113           %SCREAM( ERR#=E$NOSUPERPRIV, LEVEL=ERROR, MID='A' );

  16125  4 000145   000000 630400 5                  EPPR0   0
         4 000146   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000147   000000 701000 xent               TSX1    ASH$ERROR
         4 000150   000000 011000                    NOP     0

      279    16128    2      GOTO EXIT_SUPER ;

  16128  4 000151   002331 710000 4                  TRA     EXIT_SUPER

  16107  4 000152                       IS_USERS_TH* null
      280    16129    2      END ; /* Then do */
      281    16130                                                              /*  Check to see if
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:117  
      282    16131                                                                   :USERS, :HLP, and
      283    16132                                                                   :PRO exist.  */
      284    16133    1   IS_USERS_THERE: ;
      285    16134    1   CALL ASB$OPEN_USERS_UP ALTRET( IS_HLP_THERE ) ;

  16134  4 000152   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000153   000000 701000 xent               TSX1    ASB$OPEN_USERS_UP
         4 000154   000161 702000 4                  TSX2    IS_HLP_THERE

      286    16135                                                              /*  :USERS exists
      287    16136                                                                   :HLP better.  */
      288    16137    1   CALL ASB$OPEN_HLP_UP ALTRET( USERS_HLP_ERR ) ;

  16137  4 000155   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000156   000000 701000 xent               TSX1    ASB$OPEN_HLP_UP
         4 000157   000204 702000 4                  TSX2    USERS_HLP_ERR

      289    16138                                                              /*  Both exist.  */
      290    16139    1   GOTO IS_PRO_THERE ;

  16139  4 000160   000227 710000 4                  TRA     IS_PRO_THERE

  16107  4 000161                       IS_HLP_THERE null
      291    16140                                                              /*  :USERS doesn't
      292    16141                                                                  :HLP better not.  */
      293    16142    1   IS_HLP_THERE: ;
      294    16143    1   IF MERR_CODE.CODE ~= %E$NOFILE

  16143  4 000161   000000 236000 xsym               LDQ     ERR_CODE
         4 000162   377770 376007                    ANQ     131064,DL
         4 000163   001610 116007                    CMPQ    904,DL
         4 000164   000172 600000 4                  TZE     s:16148

      295    16144    2   THEN DO;

      296    16145    2      CALL ASH$ERROR( ERR_CODE ) ;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:118  
  16145  4 000165   000001 630400 5                  EPPR0   1
         4 000166   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000167   000000 701000 xent               TSX1    ASH$ERROR
         4 000170   000000 011000                    NOP     0

      297    16146    2      GOTO EXIT_SUPER ;

  16146  4 000171   002331 710000 4                  TRA     EXIT_SUPER

      298    16147    2      END ; /* Then do */
      299    16148    1   CALL ASB$OPEN_HLP_UP ALTRET( BUILD_USERS_HLP ) ;

  16148  4 000172   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000173   000000 701000 xent               TSX1    ASB$OPEN_HLP_UP
         4 000174   000224 702000 4                  TSX2    BUILD_USERS_HLP

      300    16149                                                              /*   ERROR:
      301    16150                                                                   :USERS doesn't
      302    16151                                                                   :HLP does.  */
      303    16152        /*E*  ERROR:    ASA-E$USER_FILE_INCONSISTENT-C
      304    16153              MESSAGE:  User file inconsistency.
      305    16154              MESSAGE1: :USERS does not exist, but :HLP does.
      306    16155              MESSAGE2: User records may exist in :HLP that do not exist
      307    16156                        in :USERS.  Use the D[ELETE] U[SERS] command to
      308    16157                        remove all users records in :HLP.
      309    16158        */
      310    16159        %SCREAM( ERR#=E$USER_FILE_INCONSISTENT, LEVEL=WARN, MID='A' );

  16169  4 000175   000002 630400 5                  EPPR0   2
         4 000176   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000177   000000 701000 xent               TSX1    ASH$WARN
         4 000200   000000 011000                    NOP     0

      311    16174    1   T_ERR_CODE = ERR_CODE ;

  16174  4 000201   000000 236000 xsym               LDQ     ERR_CODE
         4 000202   200034 756100                    STQ     T_ERR_CODE,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:119  

      312    16175    1   GOTO IS_PRO_THERE ;

  16175  4 000203   000227 710000 4                  TRA     IS_PRO_THERE

  16174  4 000204                       USERS_HLP_E* null
      313    16176                                                              /*   ERROR:
      314    16177                                                                   :USERS does
      315    16178                                                                   :HLP doesn't.  */
      316    16179    1   USERS_HLP_ERR: ;
      317    16180    1   IF MERR_CODE.CODE ~= %E$NOFILE

  16180  4 000204   000000 236000 xsym               LDQ     ERR_CODE
         4 000205   377770 376007                    ANQ     131064,DL
         4 000206   001610 116007                    CMPQ    904,DL
         4 000207   000215 600000 4                  TZE     s:16202

      318    16181    2   THEN DO;

      319    16182    2      CALL ASH$ERROR( ERR_CODE ) ;

  16182  4 000210   000001 630400 5                  EPPR0   1
         4 000211   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000212   000000 701000 xent               TSX1    ASH$ERROR
         4 000213   000000 011000                    NOP     0

      320    16183    2      GOTO OUTPUT_ERROR_CNT ;

  16183  4 000214   002163 710000 4                  TRA     OUTPUT_ERROR_CNT

      321    16184    2      END ; /* Then do */
      322    16185        /*E*  ERROR:    ASA-E$HLP_FILE_INCONSISTENT-C
      323    16186              MESSAGE:  User file inconsistency.
      324    16187              MESSAGE1: :USERS does exist, but :HLP does not.
      325    16188              MESSAGE2: User records may exist in :USERS that do not
      326    16189                        exist in :HLP. Use the D[ELETE] U[SERS] command
      327    16190                        to remove all users records in :HLP.
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:120  
      328    16191        */
      329    16192        %SCREAM( ERR#=E$HLP_FILE_INCONSISTENT, LEVEL=WARN, MID='A' );

  16202  4 000215   000003 630400 5                  EPPR0   3
         4 000216   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000217   000000 701000 xent               TSX1    ASH$WARN
         4 000220   000000 011000                    NOP     0

      330    16207    1   T_ERR_CODE = ERR_CODE ;

  16207  4 000221   000000 236000 xsym               LDQ     ERR_CODE
         4 000222   200034 756100                    STQ     T_ERR_CODE,,AUTO

      331    16208    1   GOTO IS_PRO_THERE ;

  16208  4 000223   000227 710000 4                  TRA     IS_PRO_THERE

  16207  4 000224                       BUILD_USERS* null
      332    16209                                                              /*   Both don't exist.  */
      333    16210    1   BUILD_USERS_HLP: ;
      334    16211    1   CALL ASA$B_USERS_HLP ;

  16211  4 000224   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000225   000000 701000 xent               TSX1    ASA$B_USERS_HLP
         4 000226   000000 011000                    NOP     0

  16207  4 000227                       IS_PRO_THERE null
      335    16212                                                              /**/
      336    16213    1   IS_PRO_THERE: ;
      337    16214    1   CALL ASD$OPEN_PRO_UP

  16214  4 000227   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000230   000000 701000 xent               TSX1    ASD$OPEN_PRO_UP
         4 000231   000233 702000 4                  TSX2    s:16217
         4 000232   000236 710000 4                  TRA     IS_FORM_THERE

      338    16215    2   WHENALTRETURN DO;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:121  

      339    16216                                                              /**/
      340    16217    2      CALL ASD$CREATE_PRO ;

  16217  4 000233   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000234   000000 701000 xent               TSX1    ASD$CREATE_PRO
         4 000235   000000 011000                    NOP     0

      341    16218    2      END ; /* Whenaltreturn do */

  16207  4 000236                       IS_FORM_THE* null
      342    16219    1   IS_FORM_THERE: ;
      343    16220    1   CALL ASF$OPEN_FORM_UP

  16220  4 000236   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000237   000000 701000 xent               TSX1    ASF$OPEN_FORM_UP
         4 000240   000242 702000 4                  TSX2    s:16222
         4 000241   000254 710000 4                  TRA     IS_WSN_THERE

      344    16221    2   WHENALTRETURN DO;

      345    16222    2      CALL ASF$OPEN_FORM_CR

  16222  4 000242   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000243   000000 701000 xent               TSX1    ASF$OPEN_FORM_CR
         4 000244   000246 702000 4                  TSX2    s:16225
         4 000245   000246 710000 4                  TRA     s:16225

      346    16223    3      WHENALTRETURN DO;

      347    16224    3         END;

      348    16225    2      CALL ASC$BUILD_CHARSET ;

  16225  4 000246   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000247   000000 701000 xent               TSX1    ASC$BUILD_CHARSET
         4 000250   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:122  

      349    16226    2      CALL ASF$BUILD_FORM ;

  16226  4 000251   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000252   000000 701000 xent               TSX1    ASF$BUILD_FORM
         4 000253   000000 011000                    NOP     0

      350    16227    2      END ; /* Whenaltreturn do */

  16207  4 000254                       IS_WSN_THERE null
      351    16228    1   IS_WSN_THERE: ;
      352    16229    1   CALL ASW$OPEN_WSN_UP

  16229  4 000254   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000255   000000 701000 xent               TSX1    ASW$OPEN_WSN_UP
         4 000256   000260 702000 4                  TSX2    s:16231
         4 000257   000266 710000 4                  TRA     IS_PROJ_THERE

      353    16230    2   WHENALTRETURN DO;

      354    16231    2      CALL ASW$BUILD_WSN ;

  16231  4 000260   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000261   000000 701000 xent               TSX1    ASW$BUILD_WSN
         4 000262   000000 011000                    NOP     0

      355    16232    2      CALL ASW$OPEN_WSN_UP;

  16232  4 000263   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000264   000000 701000 xent               TSX1    ASW$OPEN_WSN_UP
         4 000265   000000 011000                    NOP     0

      356    16233    2      END ; /* Whenaltreturn do */

      357    16234    1   IS_PROJ_THERE:
      358    16235    1   CALL ASB$OPEN_PROJ_UP

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:123  
  16235  4 000266   000002 631400 xsym  IS_PROJ_THE* EPPR1   B_VECTNIL+2
         4 000267   000000 701000 xent               TSX1    ASB$OPEN_PROJ_UP
         4 000270   000272 702000 4                  TSX2    s:16237
         4 000271   000300 710000 4                  TRA     ALL_FILES_EXIST

      359    16236    2   WHENALTRETURN DO;

      360    16237    2      CALL ASB$OPEN_PROJ_CR;

  16237  4 000272   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000273   000000 701000 xent               TSX1    ASB$OPEN_PROJ_CR
         4 000274   000000 011000                    NOP     0

      361    16238    2      CALL ASB$CLOSE_PROJ;

  16238  4 000275   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000276   000000 701000 xent               TSX1    ASB$CLOSE_PROJ
         4 000277   000000 011000                    NOP     0

      362    16239    2      END;  /*  Whenaltreturn  */

  16229  4 000300                       ALL_FILES_E* null
      363    16240    1   ALL_FILES_EXIST: ;
      364    16241                                                              /*  Set P_PCB.  */
      365    16242    1   P_PCB.U$$ = ENTADDR( ASH$U_PARSE ) ;

  16242  4 000300   000000 636000 xent               EAQ     ASH$U_PARSE
         4 000301   000004 756000 xsym               STQ     P_PCB+4

      366    16243                                                              /*  Check to see if
      367    16244                                                                   this is system ghost. */
      368    16245    1   IF B$JIT.MODE = %M_GHOST# AND B$JIT.USER = 14/*JG_SUPER#   */

  16245  4 000302   000000 470400 xsym               LDP0    B$JIT$
         4 000303   000000 236100                    LDQ     0,,PR0
         4 000304   740000 376003                    ANQ     -16384,DU
         4 000305   100000 116003                    CMPQ    32768,DU
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:124  
         4 000306   000326 601000 4                  TNZ     s:16276
         4 000307   000000 236100                    LDQ     0,,PR0
         4 000310   000777 376003                    ANQ     511,DU
         4 000311   000016 116003                    CMPQ    14,DU
         4 000312   000326 601000 4                  TNZ     s:16276

      369    16246    2   THEN DO;

      370    16247    2      CALL ASC$CONFIG () WHENALTRETURN

  16247  4 000313   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000314   000000 701000 xent               TSX1    ASC$CONFIG
         4 000315   000317 702000 4                  TSX2    s:16266
         4 000316   000324 710000 4                  TRA     s:16271

      371    16248    3      DO;

      372    16249                /*E*  ERROR:  ASA-E$CONFIG_FAIL-C
      373    16250                      MESSAGE: ALRETURN from configuration routine. Please check
      374    16251                               that the station and WSN you just specified got
      375    16252                               rebuilt! If not notify your system manager.
      376    16253                 */
      377    16254              %SCREAM (ERR# = E$CONFIG_FAIL, LEVEL=ERROR, MID='A');

  16266  4 000317   000004 630400 5                  EPPR0   4
         4 000320   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000321   000000 701000 xent               TSX1    ASH$ERROR
         4 000322   000000 011000                    NOP     0

      378    16269    3         RETURN;

  16269  4 000323   000000 702200 xent               TSX2  ! X66_MARET

      379    16270    3         END; /* Whenaltreturn */
      380    16271    2      CALL M$EXIT ;

  16271  4 000324   000001 713400                    CLIMB   exit
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:125  
         4 000325   000000 401760                    pmme    nvectors=0

      381    16272    2      END ; /* Then do */

      382    16273                                                              /*  All files exist.
      383    16274                                                                   Close them.  */
      384    16275                                                              /*  Open files update.  */
      385    16276    1   CALL ASB$OPEN_USERS_UP ;

  16276  4 000326   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000327   000000 701000 xent               TSX1    ASB$OPEN_USERS_UP
         4 000330   000000 011000                    NOP     0

      386    16277    1   CALL ASB$OPEN_HLP_UP ;

  16277  4 000331   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000332   000000 701000 xent               TSX1    ASB$OPEN_HLP_UP
         4 000333   000000 011000                    NOP     0

      387    16278    1   CALL ASD$OPEN_PRO_UP ;

  16278  4 000334   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000335   000000 701000 xent               TSX1    ASD$OPEN_PRO_UP
         4 000336   000000 011000                    NOP     0

      388    16279    1   CALL ASB$OPEN_PROJ_UP;

  16279  4 000337   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000340   000000 701000 xent               TSX1    ASB$OPEN_PROJ_UP
         4 000341   000000 011000                    NOP     0

      389    16280    1   CALL ASB$OPEN_COMGROUP;

  16280  4 000342   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000343   000000 701000 xent               TSX1    ASB$OPEN_COMGROUP
         4 000344   000000 011000                    NOP     0

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:126  
      390    16281    1   BLANK_PASS = ' ';

  16281  4 000345   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000346   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000347   000000 755000 xsym               STA     BLANK_PASS
         4 000350   000001 756000 xsym               STQ     BLANK_PASS+1

      391    16282    1   CALL ASZ$SCRAMBLE(BLANK_PASS);  /* To have a blank scrambled password */

  16282  4 000351   000005 630400 5                  EPPR0   5
         4 000352   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000353   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         4 000354   000000 011000                    NOP     0

      392    16283                                                /* handy for checking for unspecified */
      393    16284                                                /* passwords */
      394    16285    1   MORE = AS_TRUE ;

  16285  4 000355   000000 236000 xsym               LDQ     AS_TRUE
         4 000356   400000 376003                    ANQ     -131072,DU
         4 000357   000000 756000 2                  STQ     MORE

      395    16286                                                              /*   Output super header.  */
      396    16287    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );

  16287  4 000360   000006 630400 5                  EPPR0   6
         4 000361   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000362   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 000363   000000 011000                    NOP     0

      397    16288    1   CALL CONCAT(OUT_BUF,'*** CP-6 SUPER ',SUBSTR(B_VERSION.TEXT,0,B_VERSION.COUNT),
             16288            ' ***' );

  16288  4 000364   000000 236000 xsym               LDQ     B_VERSION
         4 000365   000033 772000                    QRL     27
         4 000366   040000 100400                    MLR     fill='040'O
         4 000367   000012 000017 3                  ADSC9   SIZEC_DREC+10            cn=0,n=15
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:127  
         4 000370   000000 000017 xsym               ADSC9   OUT_BUF                  cn=0,n=15
         4 000371   000000 620006                    EAX0    0,QL
         4 000372   040000 100440                    MLR     fill='040'O
         4 000373   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
         4 000374   000003 600175 xsym               ADSC9   OUT_BUF+3                cn=3,n=125
         4 000375   000175 116007                    CMPQ    125,DL
         4 000376   000404 603000 4                  TRC     s:16289
         4 000377   777602 620006                    EAX0    -126,QL
         4 000400   777777 660003                    ERX0    -1,DU
         4 000401   040046 100400                    MLR     fill='040'O
         4 000402   000016 000004 3                  ADSC9   SIZEC_DREC+14            cn=0,n=4
         4 000403   000003 600010 xsym               ADSC9   OUT_BUF+3,Q              cn=3,n=*X0

      398    16289    1   CALL ASB$WRITE_LO( OUT_BUF, LENGTHC(OUT_BUF) );

  16289  4 000404   000011 630400 5                  EPPR0   9
         4 000405   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000406   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 000407   000000 011000                    NOP     0

      399    16290    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );

  16290  4 000410   000006 630400 5                  EPPR0   6
         4 000411   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000412   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 000413   000000 011000                    NOP     0

      400    16291    1   IF PADMIN

  16291  4 000414   000000 234000 xsym               SZN     PADMIN
         4 000415   000423 605000 4                  TPL     s:16293

      401    16292    1   THEN CALL MAKEME( 2 /* MAKEME SYS */ );

  16292  4 000416   000013 236000 5                  LDQ     11
         4 000417   200051 756100                    STQ     FREE_SEG_TYPE+2,,AUTO
         4 000420   012032 701000 4                  TSX1    MAKEME
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:128  
         4 000421   000000 011000                    NOP     0
         4 000422   000426 710000 4                  TRA     s:16294

      402    16293    1   ELSE AS_PROJECT_ADMIN = AS_NONE ;

  16293  4 000423   000000 100400                    MLR     fill='000'O
         4 000424   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 000425   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21

      403    16294    1   ERR_CODE = T_ERR_CODE ;

  16294  4 000426   200034 236100                    LDQ     T_ERR_CODE,,AUTO
         4 000427   000000 756000 xsym               STQ     ERR_CODE

  16294  4 000430                       CMD_LOOP     null
      404    16295                                                              /**/
      405    16296    1   CMD_LOOP: ;
      406    16297    1   ASA_BRKS_LOC_BIT = '0'B;         /* Clear break control

  16297  4 000430   000000 235003                    LDA     0,DU
         4 000431   000000 236003                    LDQ     0,DU
         4 000432   000000 757000 xsym               STAQ    ASA_BRKS_LOC

      407    16298                                             list will reset it     */
      408    16299    1   P_PCB.ROOT$ = ADDR( CMD_NODES ) ;

  16299  4 000433   000014 236000 5                  LDQ     12
         4 000434   000001 756000 xsym               STQ     P_PCB+1

      409    16300    1   ENQDEQ_FLG = AS_FALSE ;

  16300  4 000435   000000 236000 xsym               LDQ     AS_FALSE
         4 000436   400000 376003                    ANQ     -131072,DU
         4 000437   000000 756000 xsym               STQ     ENQDEQ_FLG

      410    16301                                                              /**/
      411    16302    2   DO WHILE (MORE) ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:129  

  16302  4 000440   000000 234000 2                  SZN     MORE
         4 000441   002136 605000 4                  TPL     SUPER_ERR

      412    16303    2      IF ENQDEQ_FLG

  16303  4 000442   000000 234000 xsym               SZN     ENQDEQ_FLG
         4 000443   000452 605000 4                  TPL     s:16309

      413    16304    3      THEN DO;

      414    16305    3         CALL ASB$DEQ ALTRET( DEQ_ERR ) ;

  16305  4 000444   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000445   000000 701000 xent               TSX1    ASB$DEQ
         4 000446   000447 702000 4                  TSX2    DEQ_ERR

  16305  4 000447                       DEQ_ERR      null
      415    16306    3   DEQ_ERR: ;
      416    16307    3         ENQDEQ_FLG = AS_FALSE ;

  16307  4 000447   000000 236000 xsym               LDQ     AS_FALSE
         4 000450   400000 376003                    ANQ     -131072,DU
         4 000451   000000 756000 xsym               STQ     ENQDEQ_FLG

      417    16308    3         END ;        /* Then do */

      418    16309    2      REMEMBER CMD_LOOP IN REMEM_VAR ;

  16309  4 000452   000430 635000 4                  EAA     CMD_LOOP
         4 000453   000000 452400 xsym               STP2    REMEM_VAR
         4 000454   000001 755000 xsym               STA     REMEM_VAR+1

      419    16310                                                              /* Set prompt */
      420    16311    2      CALL ASB$SET_PROMPT ( %PROMPT_CMD ) ;

  16311  4 000455   000015 630400 5                  EPPR0   13
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:130  
         4 000456   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000457   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 000460   000000 011000                    NOP     0

      421    16312    2      CALL ASB$READ_SI(IN_BUF, ARS) ;

  16312  4 000461   200003 630500                    EPPR0   ARS,,AUTO
         4 000462   200121 450500                    STP0    I+3,,AUTO
         4 000463   000016 236000 5                  LDQ     14
         4 000464   200120 756100                    STQ     I+2,,AUTO
         4 000465   200120 630500                    EPPR0   I+2,,AUTO
         4 000466   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000467   000000 701000 xent               TSX1    ASB$READ_SI
         4 000470   000000 011000                    NOP     0

      422    16313    2      P_PCB.NCHARS = ARS ;

  16313  4 000471   200003 235100                    LDA     ARS,,AUTO
         4 000472   000011 755000 xsym               STA     P_PCB+9

      423    16314    2      CALL X$PARSE(P_PCB) ALTRET (SUPER_ERR) ;

  16314  4 000473   000017 630400 5                  EPPR0   15
         4 000474   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000475   000000 701000 xent               TSX1    X$PARSE
         4 000476   002136 702000 4                  TSX2    SUPER_ERR

      424    16315                                                              /**/
      425    16316    2      NODE$ = P_PCB.OUT$ ;

  16316  4 000477   000003 236000 xsym               LDQ     P_PCB+3
         4 000500   000000 756000 xsym               STQ     NODE$

      426    16317                                                              /**/
      427    16318    2      CODE = P$NODE.CODE ;

  16318  4 000501   000000 470400 xsym               LDP0    NODE$
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:131  
         4 000502   000000 236100                    LDQ     0,,PR0
         4 000503   777777 376007                    ANQ     -1,DL
         4 000504   000000 756000 xsym               STQ     CODE

      428    16319                                                       /* Is the appropriate ppriv. set. */
      429    16320    3      DO SELECT(CODE) ;

  16320  4 000505   000073 116007                    CMPQ    59,DL
         4 000506   000567 602000 4                  TNC     s:16320+50
         4 000507   001013 600000 4                  TZE     s:16461
         4 000510   000101 116007                    CMPQ    65,DL
         4 000511   000550 602000 4                  TNC     s:16320+35
         4 000512   000724 600000 4                  TZE     s:16329
         4 000513   000104 116007                    CMPQ    68,DL
         4 000514   000541 602000 4                  TNC     s:16320+28
         4 000515   000763 600000 4                  TZE     s:16399
         4 000516   000110 116007                    CMPQ    72,DL
         4 000517   000530 602000 4                  TNC     s:16320+19
         4 000520   001022 600000 4                  TZE     s:16490
         4 000521   000112 116007                    CMPQ    74,DL
         4 000522   000525 602000 4                  TNC     s:16320+16
         4 000523   001013 600000 4                  TZE     s:16461
         4 000524   001042 710000 4                  TRA     s:16543
         4 000525   000111 116007                    CMPQ    73,DL
         4 000526   001042 601000 4                  TNZ     s:16543
         4 000527   001022 710000 4                  TRA     s:16490
         4 000530   000106 116007                    CMPQ    70,DL
         4 000531   000536 602000 4                  TNC     s:16320+25
         4 000532   000763 600000 4                  TZE     s:16399
         4 000533   000107 116007                    CMPQ    71,DL
         4 000534   001042 601000 4                  TNZ     s:16543
         4 000535   001022 710000 4                  TRA     s:16490
         4 000536   000105 116007                    CMPQ    69,DL
         4 000537   001042 601000 4                  TNZ     s:16543
         4 000540   000724 710000 4                  TRA     s:16329
         4 000541   000103 116007                    CMPQ    67,DL
         4 000542   000545 602000 4                  TNC     s:16320+32
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:132  
         4 000543   000724 600000 4                  TZE     s:16329
         4 000544   001042 710000 4                  TRA     s:16543
         4 000545   000102 116007                    CMPQ    66,DL
         4 000546   001042 601000 4                  TNZ     s:16543
         4 000547   000763 710000 4                  TRA     s:16399
         4 000550   000075 116007                    CMPQ    61,DL
         4 000551   000564 602000 4                  TNC     s:16320+47
         4 000552   001013 600000 4                  TZE     s:16461
         4 000553   000077 116007                    CMPQ    63,DL
         4 000554   000561 602000 4                  TNC     s:16320+44
         4 000555   001013 600000 4                  TZE     s:16461
         4 000556   000100 116007                    CMPQ    64,DL
         4 000557   001042 601000 4                  TNZ     s:16543
         4 000560   001013 710000 4                  TRA     s:16461
         4 000561   000076 116007                    CMPQ    62,DL
         4 000562   001042 601000 4                  TNZ     s:16543
         4 000563   001013 710000 4                  TRA     s:16461
         4 000564   000074 116007                    CMPQ    60,DL
         4 000565   001042 601000 4                  TNZ     s:16543
         4 000566   001013 710000 4                  TRA     s:16461
         4 000567   000053 116007                    CMPQ    43,DL
         4 000570   000650 602000 4                  TNC     s:16320+99
         4 000571   000724 600000 4                  TZE     s:16329
         4 000572   000062 116007                    CMPQ    50,DL
         4 000573   000626 602000 4                  TNC     s:16320+81
         4 000574   000763 600000 4                  TZE     s:16399
         4 000575   000067 116007                    CMPQ    55,DL
         4 000576   000611 602000 4                  TNC     s:16320+68
         4 000577   001013 600000 4                  TZE     s:16461
         4 000600   000071 116007                    CMPQ    57,DL
         4 000601   000606 602000 4                  TNC     s:16320+65
         4 000602   001013 600000 4                  TZE     s:16461
         4 000603   000072 116007                    CMPQ    58,DL
         4 000604   001042 601000 4                  TNZ     s:16543
         4 000605   001013 710000 4                  TRA     s:16461
         4 000606   000070 116007                    CMPQ    56,DL
         4 000607   001042 601000 4                  TNZ     s:16543
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:133  
         4 000610   001013 710000 4                  TRA     s:16461
         4 000611   000064 116007                    CMPQ    52,DL
         4 000612   000623 602000 4                  TNC     s:16320+78
         4 000613   000763 600000 4                  TZE     s:16399
         4 000614   000066 116007                    CMPQ    54,DL
         4 000615   000620 602000 4                  TNC     s:16320+75
         4 000616   001022 600000 4                  TZE     s:16490
         4 000617   001042 710000 4                  TRA     s:16543
         4 000620   000065 116007                    CMPQ    53,DL
         4 000621   001042 601000 4                  TNZ     s:16543
         4 000622   001031 710000 4                  TRA     s:16514
         4 000623   000063 116007                    CMPQ    51,DL
         4 000624   001042 601000 4                  TNZ     s:16543
         4 000625   001022 710000 4                  TRA     s:16490
         4 000626   000057 116007                    CMPQ    47,DL
         4 000627   000637 602000 4                  TNC     s:16320+90
         4 000630   001013 600000 4                  TZE     s:16461
         4 000631   000060 116007                    CMPQ    48,DL
         4 000632   001042 602000 4                  TNC     s:16543
         4 000633   001013 600000 4                  TZE     s:16461
         4 000634   000061 116007                    CMPQ    49,DL
         4 000635   001042 601000 4                  TNZ     s:16543
         4 000636   001022 710000 4                  TRA     s:16490
         4 000637   000055 116007                    CMPQ    45,DL
         4 000640   000645 602000 4                  TNC     s:16320+96
         4 000641   001013 600000 4                  TZE     s:16461
         4 000642   000056 116007                    CMPQ    46,DL
         4 000643   001042 601000 4                  TNZ     s:16543
         4 000644   001013 710000 4                  TRA     s:16461
         4 000645   000054 116007                    CMPQ    44,DL
         4 000646   001042 601000 4                  TNZ     s:16543
         4 000647   001013 710000 4                  TRA     s:16461
         4 000650   000044 116007                    CMPQ    36,DL
         4 000651   000675 602000 4                  TNC     s:16320+120
         4 000652   001013 600000 4                  TZE     s:16461
         4 000653   000050 116007                    CMPQ    40,DL
         4 000654   000664 602000 4                  TNC     s:16320+111
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:134  
         4 000655   001013 600000 4                  TZE     s:16461
         4 000656   000051 116007                    CMPQ    41,DL
         4 000657   001042 602000 4                  TNC     s:16543
         4 000660   001013 600000 4                  TZE     s:16461
         4 000661   000052 116007                    CMPQ    42,DL
         4 000662   001042 601000 4                  TNZ     s:16543
         4 000663   001013 710000 4                  TRA     s:16461
         4 000664   000046 116007                    CMPQ    38,DL
         4 000665   000672 602000 4                  TNC     s:16320+117
         4 000666   001013 600000 4                  TZE     s:16461
         4 000667   000047 116007                    CMPQ    39,DL
         4 000670   001042 601000 4                  TNZ     s:16543
         4 000671   001022 710000 4                  TRA     s:16490
         4 000672   000045 116007                    CMPQ    37,DL
         4 000673   001042 601000 4                  TNZ     s:16543
         4 000674   000754 710000 4                  TRA     s:16376
         4 000675   000042 116007                    CMPQ    34,DL
         4 000676   000703 602000 4                  TNC     s:16320+126
         4 000677   001013 600000 4                  TZE     s:16461
         4 000700   000043 116007                    CMPQ    35,DL
         4 000701   001042 601000 4                  TNZ     s:16543
         4 000702   001013 710000 4                  TRA     s:16461
         4 000703   000033 116007                    CMPQ    27,DL
         4 000704   000707 602000 4                  TNC     s:16320+130
         4 000705   000724 600000 4                  TZE     s:16329
         4 000706   001042 710000 4                  TRA     s:16543
         4 000707   000030 116007                    CMPQ    24,DL
         4 000710   001042 601000 4                  TNZ     s:16543
         4 000711   000712 710000 4                  TRA     s:16322

      430    16321    3         SELECT (%OUTPUT_VAL);

      431    16322    3         CALL ASB$CLOSE_LO;

  16322  4 000712   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000713   000000 701000 xent               TSX1    ASB$CLOSE_LO
         4 000714   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:135  

      432    16323    3         XUG_GETCMD.UTIL$ = P_PCB.OUT$;

  16323  4 000715   000003 236000 xsym               LDQ     P_PCB+3
         4 000716   000060 756000 2                  STQ     XUG_GETCMD+36

      433    16324    3         CALL XUG$OPENOUT (XUG_GETCMD);

  16324  4 000717   000020 630400 5                  EPPR0   16
         4 000720   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000721   000000 701000 xent               TSX1    XUG$OPENOUT
         4 000722   000000 011000                    NOP     0

      434    16325    3         GOTO CMD_LOOP;

  16325  4 000723   000430 710000 4                  TRA     CMD_LOOP

      435    16326    3         SELECT( 27   /*  CR_MOD_ACCT_VAL */, 43 /* R_USER */,

      436    16327    3              67 /* TIE_USER_VAL */, 65 /* UNTIE_USER_VAL */,
      437    16328    3              69 /* MOD_USER_TO_PROJ_VAL */ );
      438    16329    3         IF NOT SUPERAUTH  AND  NOT PADMIN

  16329  4 000724   000000 234000 xsym               SZN     SUPERAUTH
         4 000725   000735 604000 4                  TMI     s:16351
         4 000726   000000 234000 xsym               SZN     PADMIN
         4 000727   000735 604000 4                  TMI     s:16351

      439    16330    4         THEN DO;

      440    16331        /*E*  ERROR:    ASA-E$NOTSUPERAUTH_PADMIN-C
      441    16332              MESSAGE0: You do not have SUPERAUTH or PADMIN pprivilege.
      442    16333        */
      443    16334                 %SCREAM( ERR#=E$NOTSUPERAUTH_PADMIN, LEVEL=ERROR, MID='A' );

  16346  4 000730   000021 630400 5                  EPPR0   17
         4 000731   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:136  
         4 000732   000000 701000 xent               TSX1    ASH$ERROR
         4 000733   000000 011000                    NOP     0

      444    16349    4            GOTO CMD_LOOP ;

  16349  4 000734   000430 710000 4                  TRA     CMD_LOOP

      445    16350    4            END;    /* Then do */
      446    16351    3         ELSE IF PADMIN AND SUPERD AND (NOT SUPERAUTH)

  16351  4 000735   000000 234000 xsym               SZN     PADMIN
         4 000736   001042 605000 4                  TPL     s:16543
         4 000737   000000 234000 xsym               SZN     SUPERD
         4 000740   001042 605000 4                  TPL     s:16543
         4 000741   000000 234000 xsym               SZN     SUPERAUTH
         4 000742   001042 604000 4                  TMI     s:16543
         4 000743   000000 106400                    CMPC    fill='000'O
         4 000744   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 000745   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 000746   001042 601000 4                  TNZ     s:16543

      447    16352    3                 AND (AS_PROJECT_ADMIN = AS_NONE)
      448    16353    4            THEN DO;

      449    16354        /*E*  ERROR:    ASA-E$NOTSUPERAUTH-C
      450    16355              MESSAGE0: You do not have SUPERAUTH pprivilege.
      451    16356        */
      452    16357                    %SCREAM( ERR#=E$NOTSUPERAUTH, LEVEL=ERROR, MID='A' );

  16369  4 000747   000022 630400 5                  EPPR0   18
         4 000750   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000751   000000 701000 xent               TSX1    ASH$ERROR
         4 000752   000000 011000                    NOP     0

      453    16372    4               GOTO CMD_LOOP;

  16372  4 000753   000430 710000 4                  TRA     CMD_LOOP
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:137  

      454    16373    4               END; /* else do */
      455    16374
      456    16375    3         SELECT( 37 /* D_USERS_VAL */ );

      457    16376    3         IF NOT SUPERAUTH

  16376  4 000754   000000 234000 xsym               SZN     SUPERAUTH
         4 000755   001042 604000 4                  TMI     s:16543

      458    16377    4         THEN DO;

      459    16378                 %SCREAM( ERR#=E$NOTSUPERAUTH, LEVEL=ERROR, MID='A' );

  16390  4 000756   000022 630400 5                  EPPR0   18
         4 000757   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000760   000000 701000 xent               TSX1    ASH$ERROR
         4 000761   000000 011000                    NOP     0

      460    16393    4            GOTO CMD_LOOP ;

  16393  4 000762   000430 710000 4                  TRA     CMD_LOOP

      461    16394    4            END ; /* Then do */
      462    16395
      463    16396    3         SELECT( 52 /* CR_MOD_PROJ_VAL */, 50 /* R_PROJ */,

      464    16397    3              68 /* TIE_PROJ_VAL */, 66 /* UNTIE_PROJ_VAL */,
      465    16398    3              70 /* MOD_PROJ_TO_USER_VAL */ );
      466    16399    3         IF NOT PADMIN  AND  NOT SUPERAUTH

  16399  4 000763   000000 234000 xsym               SZN     PADMIN
         4 000764   000774 604000 4                  TMI     s:16418
         4 000765   000000 234000 xsym               SZN     SUPERAUTH
         4 000766   000774 604000 4                  TMI     s:16418

      467    16400    4         THEN DO;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:138  

      468    16401                 %SCREAM( ERR#=E$NOTSUPERAUTH_PADMIN, LEVEL=ERROR, MID='A' );

  16413  4 000767   000021 630400 5                  EPPR0   17
         4 000770   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000771   000000 701000 xent               TSX1    ASH$ERROR
         4 000772   000000 011000                    NOP     0

      469    16416    4            GOTO CMD_LOOP;

  16416  4 000773   000430 710000 4                  TRA     CMD_LOOP

      470    16417    4            END;
      471    16418    3         ELSE IF PADMIN AND SUPERD AND (NOT SUPERAUTH)

  16418  4 000774   000000 234000 xsym               SZN     PADMIN
         4 000775   001042 605000 4                  TPL     s:16543
         4 000776   000000 234000 xsym               SZN     SUPERD
         4 000777   001042 605000 4                  TPL     s:16543
         4 001000   000000 234000 xsym               SZN     SUPERAUTH
         4 001001   001042 604000 4                  TMI     s:16543
         4 001002   000000 106400                    CMPC    fill='000'O
         4 001003   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 001004   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 001005   001042 601000 4                  TNZ     s:16543

      472    16419    3                 AND (AS_PROJECT_ADMIN = AS_NONE)
      473    16420    4            THEN DO;

      474    16421                    %SCREAM( ERR#=E$NOTSUPERAUTH, LEVEL=ERROR, MID='A' );

  16433  4 001006   000022 630400 5                  EPPR0   18
         4 001007   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001010   000000 701000 xent               TSX1    ASH$ERROR
         4 001011   000000 011000                    NOP     0

      475    16436    4               GOTO CMD_LOOP;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:139  

  16436  4 001012   000430 710000 4                  TRA     CMD_LOOP

      476    16437    4               END; /* else do */
      477    16438    3         SELECT( 40 /* R_TERM */,

      478    16439    3              44 /* REMOVE STATION */,
      479    16440    3              41 /* R_CON */,
      480    16441    3              48 /* REMOVE DEV */,
      481    16442    3              74 /* R_TPDEV_VAL */,
      482    16443    3              47 /* REMOVE WSN */,
      483    16444    3              42 /* R_PRO */,
      484    16445    3              34 /* CR_MOD_PRO_VAL */,
      485    16446    3              36 /* CR_MOD_TERM */,
      486    16447    3              45 /* CREATE STATION */,
      487    16448    3              35 /* CR_MOD_CON_VAL */,
      488    16449    3              46 /* CR_MOD_DEV_VAL */,
      489    16450    3              55 /* CR_MOD_VIR_CIR_VAL */,
      490    16451    3              56 /* R_VIR_CIR */,
      491    16452    3              57 /* CR_MOD_LINE_VAL */,
      492    16453    3              58 /* CR_MOD_CONT_VAL */,
      493    16454    3              61 /* CR_MOD_LINE_DEV_VAL */,
      494    16455    3              59 /* R_LINE_VAL */,
      495    16456    3              60 /* R_CONT_VAL */,
      496    16457    3              62 /* R_LINE_DEV_VAL */,
      497    16458    3              63 /* CR_MOD_LINK_VAL */,
      498    16459    3              64 /* R_LINK_VAL */,
      499    16460    3              38 /* CR_MOD_WSN */ ) ;
      500    16461    3         IF NOT SUPERWSN

  16461  4 001013   000000 234000 xsym               SZN     SUPERWSN
         4 001014   001042 604000 4                  TMI     s:16543

      501    16462    4         THEN DO;

      502    16463        /*E*  ERROR:    ASA-E$NOTSUPERWSN-C
      503    16464              MESSAGE0: You do not have SUPERWSN ppriv.
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:140  
      504    16465        */
      505    16466                 %SCREAM( ERR#=E$NOTSUPERWSN, LEVEL=ERROR, MID='A' );

  16478  4 001015   000023 630400 5                  EPPR0   19
         4 001016   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001017   000000 701000 xent               TSX1    ASH$ERROR
         4 001020   000000 011000                    NOP     0

      506    16481    4            GOTO CMD_LOOP ;

  16481  4 001021   000430 710000 4                  TRA     CMD_LOOP

      507    16482    4            END ;  /* Then do */
      508    16483    3         SELECT( 49 /* REMOVE FORM*/,

      509    16484    3              51 /* D_FORM_VAL */,
      510    16485    3              71 /* CR_MOD_CHARSET_VAL */ ,
      511    16486    3              72 /* R_CHARSET_VAL */ ,
      512    16487    3              73 /* D_CHARSET_VAL */ ,
      513    16488    3              54  /* CR_MOD_PSEUDO_VAL */ ,
      514    16489    3              39 /* CR_MOD_FORM_VAL */ ) ;
      515    16490    3         IF NOT SUPERFORM

  16490  4 001022   000000 234000 xsym               SZN     SUPERFORM
         4 001023   001042 604000 4                  TMI     s:16543

      516    16491    4         THEN DO;

      517    16492        /*E*  ERROR:    ASA-E$NOTSUPERFORM-C
      518    16493              MESSAGE0: You do not have SUPERFORM ppriv.
      519    16494        */
      520    16495                 %SCREAM( ERR#=E$NOTSUPERFORM, LEVEL=ERROR, MID='A' );

  16507  4 001024   000024 630400 5                  EPPR0   20
         4 001025   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001026   000000 701000 xent               TSX1    ASH$ERROR
         4 001027   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:141  

      521    16510    4            GOTO CMD_LOOP ;

  16510  4 001030   000430 710000 4                  TRA     CMD_LOOP

      522    16511    4            END ; /* Then do */
      523    16512
      524    16513    3         SELECT( 53 /* MAKEME_VAL */ );

      525    16514    3         IF  NOT PADMIN  AND  NOT SUPERAUTH

  16514  4 001031   000000 234000 xsym               SZN     PADMIN
         4 001032   001042 604000 4                  TMI     s:16543
         4 001033   000000 234000 xsym               SZN     SUPERAUTH
         4 001034   001042 604000 4                  TMI     s:16543

      526    16515    4         THEN DO;

      527    16516        /*E*  ERROR:    ASA-E$NOMAKEME-C
      528    16517        MESSAGE: You do not have SUPERAUTH or PADMIN pprivilege.
      529    16518        MESSAGE1: The SUPERAUTH or PADMIN pprivilege is needed for the MAKEME command.
      530    16519        */
      531    16520                 %SCREAM( ERR#=E$NOMAKEME, LEVEL=ERROR, MID='A' );

  16532  4 001035   000025 630400 5                  EPPR0   21
         4 001036   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001037   000000 701000 xent               TSX1    ASH$ERROR
         4 001040   000000 011000                    NOP     0

      532    16535    4            GOTO CMD_LOOP;

  16535  4 001041   000430 710000 4                  TRA     CMD_LOOP

      533    16536    4            END;
      534    16537    3         END ; /* Do case */

      535    16538              /* This case checks if a delete command was input, if it was
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:142  
      536    16539                 we ask for special confirmation ('YES$'), without
      537    16540                 the input response being exactly 'YES$' with no trailing
      538    16541                 or leading blanks the delete is cancelled.
      539    16542              */
      540    16543    3      DO SELECT (CODE);

  16543  4 001042   000115 116007                    CMPQ    77,DL
         4 001043   001053 602000 4                  TNC     s:16543+9
         4 001044   001070 600000 4                  TZE     s:16545
         4 001045   000116 116007                    CMPQ    78,DL
         4 001046   001167 602000 4                  TNC     s:16573
         4 001047   001101 600000 4                  TZE     s:16549
         4 001050   000117 116007                    CMPQ    79,DL
         4 001051   001167 601000 4                  TNZ     s:16573
         4 001052   001112 710000 4                  TRA     s:16553
         4 001053   000111 116007                    CMPQ    73,DL
         4 001054   001061 602000 4                  TNC     s:16543+15
         4 001055   001134 600000 4                  TZE     s:16561
         4 001056   000114 116007                    CMPQ    76,DL
         4 001057   001167 601000 4                  TNZ     s:16573
         4 001060   001145 710000 4                  TRA     s:16565
         4 001061   000063 116007                    CMPQ    51,DL
         4 001062   001065 602000 4                  TNC     s:16543+19
         4 001063   001123 600000 4                  TZE     s:16557
         4 001064   001167 710000 4                  TRA     s:16573
         4 001065   000045 116007                    CMPQ    37,DL
         4 001066   001167 601000 4                  TNZ     s:16573
         4 001067   001156 710000 4                  TRA     s:16569

      541    16544    3         SELECT ( 77 /* D_TERM_VAL */ );

      542    16545    3         AS_FIELD1.COUNT = 9;

  16545  4 001070   011000 236003                    LDQ     4608,DU
         4 001071   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      543    16546    3         AS_FIELD1.TEXT = 'TERMINALS';
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:143  

  16546  4 001072   040000 100400                    MLR     fill='040'O
         4 001073   000024 000011 3                  ADSC9   SIZEC_DREC+20            cn=0,n=9
         4 001074   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      544    16547    3         DELETE_FLAG = AS_TRUE;

  16547  4 001075   000000 236000 xsym               LDQ     AS_TRUE
         4 001076   400000 376003                    ANQ     -131072,DU
         4 001077   200035 756100                    STQ     DELETE_FLAG,,AUTO
         4 001100   001172 710000 4                  TRA     s:16575

      545    16548    3         SELECT ( 78 /* D_CON_VAL */ );

      546    16549    3         AS_FIELD1.COUNT = 8;

  16549  4 001101   010000 236003                    LDQ     4096,DU
         4 001102   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      547    16550    3         AS_FIELD1.TEXT = 'CONSOLES';

  16550  4 001103   040000 100400                    MLR     fill='040'O
         4 001104   000027 000010 3                  ADSC9   SIZEC_DREC+23            cn=0,n=8
         4 001105   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      548    16551    3         DELETE_FLAG = AS_TRUE;

  16551  4 001106   000000 236000 xsym               LDQ     AS_TRUE
         4 001107   400000 376003                    ANQ     -131072,DU
         4 001110   200035 756100                    STQ     DELETE_FLAG,,AUTO
         4 001111   001172 710000 4                  TRA     s:16575

      549    16552    3         SELECT ( 79 /* D_PRO_VAL */ );

      550    16553    3         AS_FIELD1.COUNT = 8;

  16553  4 001112   010000 236003                    LDQ     4096,DU
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:144  
         4 001113   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      551    16554    3         AS_FIELD1.TEXT = 'PROFILES';

  16554  4 001114   040000 100400                    MLR     fill='040'O
         4 001115   000031 000010 3                  ADSC9   SIZEC_DREC+25            cn=0,n=8
         4 001116   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      552    16555    3         DELETE_FLAG = AS_TRUE;

  16555  4 001117   000000 236000 xsym               LDQ     AS_TRUE
         4 001120   400000 376003                    ANQ     -131072,DU
         4 001121   200035 756100                    STQ     DELETE_FLAG,,AUTO
         4 001122   001172 710000 4                  TRA     s:16575

      553    16556    3         SELECT ( 51 /* D_FORM_VAL */ );

      554    16557    3         AS_FIELD1.COUNT = 5;

  16557  4 001123   005000 236003                    LDQ     2560,DU
         4 001124   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      555    16558    3         AS_FIELD1.TEXT = 'FORMS';

  16558  4 001125   040000 100400                    MLR     fill='040'O
         4 001126   000033 000005 3                  ADSC9   SIZEC_DREC+27            cn=0,n=5
         4 001127   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      556    16559    3         DELETE_FLAG = AS_TRUE;

  16559  4 001130   000000 236000 xsym               LDQ     AS_TRUE
         4 001131   400000 376003                    ANQ     -131072,DU
         4 001132   200035 756100                    STQ     DELETE_FLAG,,AUTO
         4 001133   001172 710000 4                  TRA     s:16575

      557    16560    3         SELECT ( 73 /* D_CHARSET_VAL */ );

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:145  
      558    16561    3         AS_FIELD1.COUNT = 8;

  16561  4 001134   010000 236003                    LDQ     4096,DU
         4 001135   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      559    16562    3         AS_FIELD1.TEXT = 'CHARSETS';

  16562  4 001136   040000 100400                    MLR     fill='040'O
         4 001137   000035 000010 3                  ADSC9   SIZEC_DREC+29            cn=0,n=8
         4 001140   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      560    16563    3         DELETE_FLAG = AS_TRUE;

  16563  4 001141   000000 236000 xsym               LDQ     AS_TRUE
         4 001142   400000 376003                    ANQ     -131072,DU
         4 001143   200035 756100                    STQ     DELETE_FLAG,,AUTO
         4 001144   001172 710000 4                  TRA     s:16575

      561    16564    3         SELECT ( 76 /* D_DEV_VAL */ );

      562    16565    3         AS_FIELD1.COUNT = 7;

  16565  4 001145   007000 236003                    LDQ     3584,DU
         4 001146   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      563    16566    3         AS_FIELD1.TEXT = 'DEVICES';

  16566  4 001147   040000 100400                    MLR     fill='040'O
         4 001150   000037 000007 3                  ADSC9   SIZEC_DREC+31            cn=0,n=7
         4 001151   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      564    16567    3         DELETE_FLAG = AS_TRUE;

  16567  4 001152   000000 236000 xsym               LDQ     AS_TRUE
         4 001153   400000 376003                    ANQ     -131072,DU
         4 001154   200035 756100                    STQ     DELETE_FLAG,,AUTO
         4 001155   001172 710000 4                  TRA     s:16575
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:146  

      565    16568    3         SELECT ( 37 /* D_USERS_VAL */ );

      566    16569    3         AS_FIELD1.COUNT = 5;

  16569  4 001156   005000 236003                    LDQ     2560,DU
         4 001157   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      567    16570    3         AS_FIELD1.TEXT = 'USERS';

  16570  4 001160   040000 100400                    MLR     fill='040'O
         4 001161   000041 000005 3                  ADSC9   SIZEC_DREC+33            cn=0,n=5
         4 001162   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      568    16571    3         DELETE_FLAG = AS_TRUE;

  16571  4 001163   000000 236000 xsym               LDQ     AS_TRUE
         4 001164   400000 376003                    ANQ     -131072,DU
         4 001165   200035 756100                    STQ     DELETE_FLAG,,AUTO
         4 001166   001172 710000 4                  TRA     s:16575

      569    16572    3         SELECT ( ELSE );

      570    16573    3      DELETE_FLAG = AS_FALSE;

  16573  4 001167   000000 236000 xsym               LDQ     AS_FALSE
         4 001170   400000 376003                    ANQ     -131072,DU
         4 001171   200035 756100                    STQ     DELETE_FLAG,,AUTO

      571    16574    3         END; /* Do case to check delete command */

      572    16575    2   IF (DELETE_FLAG)

  16575  4 001172   200035 234100                    SZN     DELETE_FLAG,,AUTO
         4 001173   001263 605000 4                  TPL     s:16593

      573    16576    3   THEN DO;  /*DELTETE_FLAG -set means a delete command was issued
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:147  

      574    16577                          and we must ask for confirmation. */
      575    16578    3      CALL CONCAT (DELETE_PROMPT, 'Delete all ',

  16578  4 001174   000000 236000 xsym               LDQ     AS_FIELD1
         4 001175   000033 772000                    QRL     27
         4 001176   040100 100400                    MLR     fill='040'O
         4 001177   000043 000013 3                  ADSC9   SIZEC_DREC+35            cn=0,n=11
         4 001200   200036 000013                    ADSC9   DELETE_PROMPT,,AUTO      cn=0,n=11
         4 001201   000000 620006                    EAX0    0,QL
         4 001202   040100 100440                    MLR     fill='040'O
         4 001203   000000 200010 xsym               ADSC9   AS_FIELD1                cn=1,n=*X0
         4 001204   200040 600022                    ADSC9   DELETE_PROMPT+2,,AUTO    cn=3,n=18
         4 001205   000022 116007                    CMPQ    18,DL
         4 001206   001214 603000 4                  TRC     s:16580
         4 001207   777755 620006                    EAX0    -19,QL
         4 001210   777777 660003                    ERX0    -1,DU
         4 001211   040146 100400                    MLR     fill='040'O
         4 001212   000046 000002 3                  ADSC9   SIZEC_DREC+38            cn=0,n=2
         4 001213   200040 600010                    ADSC9   DELETE_PROMPT+2,Q,AUTO   cn=3,n=*X0

      576    16579    3           SUBSTR (AS_FIELD1.TEXT, 0, AS_FIELD1.COUNT), ' ?');
      577    16580    3      CALL ASB$SET_PROMPT ( %PROMPT_GENERAL, DELETE_PROMPT, 12+AS_FIELD1.COUNT );

  16580  4 001214   000000 236000 xsym               LDQ     AS_FIELD1
         4 001215   000033 772000                    QRL     27
         4 001216   000014 036007                    ADLQ    12,DL
         4 001217   200120 756100                    STQ     I+2,,AUTO
         4 001220   200120 631500                    EPPR1   I+2,,AUTO
         4 001221   200123 451500                    STP1    I+5,,AUTO
         4 001222   200036 633500                    EPPR3   DELETE_PROMPT,,AUTO
         4 001223   200122 453500                    STP3    I+4,,AUTO
         4 001224   000026 236000 5                  LDQ     22
         4 001225   200121 756100                    STQ     I+3,,AUTO
         4 001226   200121 630500                    EPPR0   I+3,,AUTO
         4 001227   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001230   000000 701000 xent               TSX1    ASB$SET_PROMPT
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:148  
         4 001231   000000 011000                    NOP     0

      578    16581    3      CALL ASB$READ_SI (IN_BUF, I);

  16581  4 001232   200024 630500                    EPPR0   I,,AUTO
         4 001233   200121 450500                    STP0    I+3,,AUTO
         4 001234   000016 236000 5                  LDQ     14
         4 001235   200120 756100                    STQ     I+2,,AUTO
         4 001236   200120 630500                    EPPR0   I+2,,AUTO
         4 001237   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001240   000000 701000 xent               TSX1    ASB$READ_SI
         4 001241   000000 011000                    NOP     0

      579    16582    3      IF ( (I ~= 4) OR

  16582  4 001242   200024 235100                    LDA     I,,AUTO
         4 001243   000004 115007                    CMPA    4,DL
         4 001244   001252 601000 4                  TNZ     s:16586
         4 001245   000000 236000 xsym               LDQ     IN_BUF
         4 001246   000047 116000 3                  CMPQ    SIZEC_DREC+39
         4 001247   001257 600000 4                  TZE     s:16590
         4 001250   000050 116000 3                  CMPQ    SIZEC_DREC+40
         4 001251   001257 600000 4                  TZE     s:16590

      580    16583    3           (SUBSTR (IN_BUF, 0, 4) ~= 'YES$') AND
      581    16584    3           (SUBSTR (IN_BUF, 0, 4) ~= 'yes$') )
      582    16585    4      THEN DO;

      583    16586    4         CALL ASB$WRITE_LO ('Answer must be ''YES$'', deletion canceled.', 41);

  16586  4 001252   000030 630400 5                  EPPR0   24
         4 001253   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001254   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 001255   000000 011000                    NOP     0

      584    16587    4         GOTO CMD_LOOP;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:149  
  16587  4 001256   000430 710000 4                  TRA     CMD_LOOP

      585    16588    4         END;
      586    16589                    /* Set prompt back to original */
      587    16590    3      CALL ASB$SET_PROMPT ( %PROMPT_RESTORE );

  16590  4 001257   000032 630400 5                  EPPR0   26
         4 001260   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001261   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 001262   000000 011000                    NOP     0

      588    16591    3      END;

      589    16592                                                              /* Process the command. */
      590    16593    3   DO SELECT (CODE) ;

  16593  4 001263   000000 236000 xsym               LDQ     CODE
         4 001264   000067 116007                    CMPQ    55,DL
         4 001265   001422 602000 4                  TNC     s:16593+95
         4 001266   001742 600000 4                  TZE     s:16696
         4 001267   000077 116007                    CMPQ    63,DL
         4 001270   001372 602000 4                  TNC     s:16593+71
         4 001271   001742 600000 4                  TZE     s:16696
         4 001272   000112 116007                    CMPQ    74,DL
         4 001273   001334 602000 4                  TNC     s:16593+41
         4 001274   001636 600000 4                  TZE     s:16645
         4 001275   000454 116007                    CMPQ    300,DL
         4 001276   001307 602000 4                  TNC     s:16593+20
         4 001277   002033 600000 4                  TZE     s:16747
         4 001300   000456 116007                    CMPQ    302,DL
         4 001301   001304 602000 4                  TNC     s:16593+17
         4 001302   002027 600000 4                  TZE     s:16744
         4 001303   002050 710000 4                  TRA     s:16796
         4 001304   000455 116007                    CMPQ    301,DL
         4 001305   002050 601000 4                  TNZ     s:16796
         4 001306   002037 710000 4                  TRA     s:16750
         4 001307   000116 116007                    CMPQ    78,DL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:150  
         4 001310   001323 602000 4                  TNC     s:16593+32
         4 001311   002043 600000 4                  TZE     s:16771
         4 001312   000120 116007                    CMPQ    80,DL
         4 001313   001320 602000 4                  TNC     s:16593+29
         4 001314   002020 600000 4                  TZE     s:16738
         4 001315   000121 116007                    CMPQ    81,DL
         4 001316   002050 601000 4                  TNZ     s:16796
         4 001317   001606 710000 4                  TRA     s:16629
         4 001320   000117 116007                    CMPQ    79,DL
         4 001321   002050 601000 4                  TNZ     s:16796
         4 001322   002043 710000 4                  TRA     s:16771
         4 001323   000114 116007                    CMPQ    76,DL
         4 001324   001331 602000 4                  TNC     s:16593+38
         4 001325   002043 600000 4                  TZE     s:16771
         4 001326   000115 116007                    CMPQ    77,DL
         4 001327   002050 601000 4                  TNZ     s:16796
         4 001330   002043 710000 4                  TRA     s:16771
         4 001331   000113 116007                    CMPQ    75,DL
         4 001332   002050 601000 4                  TNZ     s:16796
         4 001333   001746 710000 4                  TRA     s:16702
         4 001334   000105 116007                    CMPQ    69,DL
         4 001335   001353 602000 4                  TNC     s:16593+56
         4 001336   001776 600000 4                  TZE     s:16723
         4 001337   000107 116007                    CMPQ    71,DL
         4 001340   001350 602000 4                  TNC     s:16593+53
         4 001341   002004 600000 4                  TZE     s:16729
         4 001342   000110 116007                    CMPQ    72,DL
         4 001343   002050 602000 4                  TNC     s:16796
         4 001344   002010 600000 4                  TZE     s:16732
         4 001345   000111 116007                    CMPQ    73,DL
         4 001346   002050 601000 4                  TNZ     s:16796
         4 001347   002014 710000 4                  TRA     s:16735
         4 001350   000106 116007                    CMPQ    70,DL
         4 001351   002050 601000 4                  TNZ     s:16796
         4 001352   002001 710000 4                  TRA     s:16726
         4 001353   000103 116007                    CMPQ    67,DL
         4 001354   001361 602000 4                  TNC     s:16593+62
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:151  
         4 001355   001770 600000 4                  TZE     s:16717
         4 001356   000104 116007                    CMPQ    68,DL
         4 001357   002050 601000 4                  TNZ     s:16796
         4 001360   001773 710000 4                  TRA     s:16720
         4 001361   000101 116007                    CMPQ    65,DL
         4 001362   001367 602000 4                  TNC     s:16593+68
         4 001363   001762 600000 4                  TZE     s:16711
         4 001364   000102 116007                    CMPQ    66,DL
         4 001365   002050 601000 4                  TNZ     s:16796
         4 001366   001765 710000 4                  TRA     s:16714
         4 001367   000100 116007                    CMPQ    64,DL
         4 001370   002050 601000 4                  TNZ     s:16796
         4 001371   001746 710000 4                  TRA     s:16702
         4 001372   000072 116007                    CMPQ    58,DL
         4 001373   001412 602000 4                  TNC     s:16593+87
         4 001374   001752 600000 4                  TZE     s:16705
         4 001375   000074 116007                    CMPQ    60,DL
         4 001376   001406 602000 4                  TNC     s:16593+83
         4 001377   001756 600000 4                  TZE     s:16708
         4 001400   000075 116007                    CMPQ    61,DL
         4 001401   002050 602000 4                  TNC     s:16796
         4 001402   001752 600000 4                  TZE     s:16705
         4 001403   000076 116007                    CMPQ    62,DL
         4 001404   002050 601000 4                  TNZ     s:16796
         4 001405   001756 710000 4                  TRA     s:16708
         4 001406   000000 235000 xsym               LDA     CODE
         4 001407   000073 115007                    CMPA    59,DL
         4 001410   002050 601000 4                  TNZ     s:16796
         4 001411   001756 710000 4                  TRA     s:16708
         4 001412   000000 236000 xsym               LDQ     CODE
         4 001413   000071 116007                    CMPQ    57,DL
         4 001414   001417 602000 4                  TNC     s:16593+92
         4 001415   001752 600000 4                  TZE     s:16705
         4 001416   002050 710000 4                  TRA     s:16796
         4 001417   000070 116007                    CMPQ    56,DL
         4 001420   002050 601000 4                  TNZ     s:16796
         4 001421   001746 710000 4                  TRA     s:16702
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:152  
         4 001422   000050 116007                    CMPQ    40,DL
         4 001423   001506 602000 4                  TNC     s:16593+147
         4 001424   001616 600000 4                  TZE     s:16633
         4 001425   000060 116007                    CMPQ    48,DL
         4 001426   001456 602000 4                  TNC     s:16593+123
         4 001427   001632 600000 4                  TZE     s:16642
         4 001430   000064 116007                    CMPQ    52,DL
         4 001431   001443 602000 4                  TNC     s:16593+112
         4 001432   001571 600000 4                  TZE     s:16622
         4 001433   000066 116007                    CMPQ    54,DL
         4 001434   001437 602000 4                  TNC     s:16593+108
         4 001435   001725 600000 4                  TZE     s:16684
         4 001436   002050 710000 4                  TRA     s:16796
         4 001437   000000 235000 xsym               LDA     CODE
         4 001440   000065 115007                    CMPA    53,DL
         4 001441   002050 601000 4                  TNZ     s:16796
         4 001442   001574 710000 4                  TRA     s:16625
         4 001443   000000 236000 xsym               LDQ     CODE
         4 001444   000062 116007                    CMPQ    50,DL
         4 001445   001452 602000 4                  TNC     s:16593+119
         4 001446   001667 600000 4                  TZE     s:16663
         4 001447   000063 116007                    CMPQ    51,DL
         4 001450   002050 601000 4                  TNZ     s:16796
         4 001451   001646 710000 4                  TRA     s:16651
         4 001452   000000 235000 xsym               LDA     CODE
         4 001453   000061 115007                    CMPA    49,DL
         4 001454   002050 601000 4                  TNZ     s:16796
         4 001455   001642 710000 4                  TRA     s:16648
         4 001456   000000 236000 xsym               LDQ     CODE
         4 001457   000054 116007                    CMPQ    44,DL
         4 001460   001474 602000 4                  TNC     s:16593+137
         4 001461   001622 600000 4                  TZE     s:16636
         4 001462   000056 116007                    CMPQ    46,DL
         4 001463   001470 602000 4                  TNC     s:16593+133
         4 001464   001714 600000 4                  TZE     s:16678
         4 001465   000057 116007                    CMPQ    47,DL
         4 001466   002050 601000 4                  TNZ     s:16796
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:153  
         4 001467   001652 710000 4                  TRA     s:16654
         4 001470   000000 235000 xsym               LDA     CODE
         4 001471   000055 115007                    CMPA    45,DL
         4 001472   002050 601000 4                  TNZ     s:16796
         4 001473   001704 710000 4                  TRA     s:16672
         4 001474   000000 236000 xsym               LDQ     CODE
         4 001475   000052 116007                    CMPQ    42,DL
         4 001476   001503 602000 4                  TNC     s:16593+144
         4 001477   001656 600000 4                  TZE     s:16657
         4 001500   000053 116007                    CMPQ    43,DL
         4 001501   002050 601000 4                  TNZ     s:16796
         4 001502   001662 710000 4                  TRA     s:16660
         4 001503   000051 116007                    CMPQ    41,DL
         4 001504   002050 601000 4                  TNZ     s:16796
         4 001505   001626 710000 4                  TRA     s:16639
         4 001506   000042 116007                    CMPQ    34,DL
         4 001507   001532 602000 4                  TNC     s:16593+167
         4 001510   001674 600000 4                  TZE     s:16666
         4 001511   000044 116007                    CMPQ    36,DL
         4 001512   001526 602000 4                  TNC     s:16593+163
         4 001513   001700 600000 4                  TZE     s:16669
         4 001514   000046 116007                    CMPQ    38,DL
         4 001515   001522 602000 4                  TNC     s:16593+159
         4 001516   001732 600000 4                  TZE     s:16687
         4 001517   000047 116007                    CMPQ    39,DL
         4 001520   002050 601000 4                  TNZ     s:16796
         4 001521   001720 710000 4                  TRA     s:16681
         4 001522   000000 235000 xsym               LDA     CODE
         4 001523   000045 115007                    CMPA    37,DL
         4 001524   002050 601000 4                  TNZ     s:16796
         4 001525   001736 710000 4                  TRA     s:16690
         4 001526   000000 235000 xsym               LDA     CODE
         4 001527   000043 115007                    CMPA    35,DL
         4 001530   002050 601000 4                  TNZ     s:16796
         4 001531   001710 710000 4                  TRA     s:16675
         4 001532   000000 236000 xsym               LDQ     CODE
         4 001533   000033 116007                    CMPQ    27,DL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:154  
         4 001534   001546 602000 4                  TNC     s:16593+179
         4 001535   001566 600000 4                  TZE     s:16619
         4 001536   000037 116007                    CMPQ    31,DL
         4 001537   001542 602000 4                  TNC     s:16593+175
         4 001540   001606 600000 4                  TZE     s:16629
         4 001541   002050 710000 4                  TRA     s:16796
         4 001542   000000 235000 xsym               LDA     CODE
         4 001543   000034 115007                    CMPA    28,DL
         4 001544   002050 601000 4                  TNZ     s:16796
         4 001545   001742 710000 4                  TRA     s:16696
         4 001546   000000 236000 xsym               LDQ     CODE
         4 001547   000014 116007                    CMPQ    12,DL
         4 001550   001555 602000 4                  TNC     s:16593+186
         4 001551   002023 600000 4                  TZE     s:16741
         4 001552   000032 116007                    CMPQ    26,DL
         4 001553   002050 601000 4                  TNZ     s:16796
         4 001554   001565 710000 4                  TRA     s:16616
         4 001555   000001 116007                    CMPQ    1,DL
         4 001556   002050 601000 4                  TNZ     s:16796
         4 001557   001560 710000 4                  TRA     s:16611

      591    16594
      592    16595    3      SELECT( 1 /* ILLEGAL USER */ ) ;

      593    16596        /*E*  ERROR:    ASA-E$ILLEGALUSER-C
      594    16597              MESSAGE0: You may not access SUPER.
      595    16598        */
      596    16599           %SCREAM( ERR#=E$ILLEGALUSER, LEVEL=ERROR, MID='A' );

  16611  4 001560   000033 630400 5                  EPPR0   27
         4 001561   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001562   000000 701000 xent               TSX1    ASH$ERROR
         4 001563   000000 011000                    NOP     0

      597    16614    3      GOTO EXIT_SUPER ;

  16614  4 001564   002331 710000 4                  TRA     EXIT_SUPER
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:155  

      598    16615
      599    16616    3      SELECT(26   /*  BLANK_LINE_VAL */) ;

  16616  4 001565   002054 710000 4                  TRA     s:16802

      600    16617
      601    16618    3      SELECT(27   /*  CR_MOD_ACCT_VAL */) ;

      602    16619    3      CALL CREATE_MOD_USER ;

  16619  4 001566   003020 701000 4                  TSX1    CREATE_MOD_USER
         4 001567   000000 011000                    NOP     0
         4 001570   002054 710000 4                  TRA     s:16802

      603    16620
      604    16621    3      SELECT(52 /* CR_MOD_PROJ_VAL */) ;

      605    16622    3      CALL CREATE_MOD_PROJ;

  16622  4 001571   003651 701000 4                  TSX1    CREATE_MOD_PROJ
         4 001572   000000 011000                    NOP     0
         4 001573   002054 710000 4                  TRA     s:16802

      606    16623
      607    16624    3      SELECT( 53 /* MAKEME_VAL */ );

      608    16625    3      CODE = P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  16625  4 001574   000000 470400 xsym               LDP0    NODE$
         4 001575   000003 471500                    LDP1    3,,PR0
         4 001576   100000 236100                    LDQ     0,,PR1
         4 001577   777777 376007                    ANQ     -1,DL
         4 001600   000000 756000 xsym               STQ     CODE

      609    16626    3      CALL MAKEME( CODE );

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:156  
  16626  4 001601   000034 236000 5                  LDQ     28
         4 001602   200051 756100                    STQ     FREE_SEG_TYPE+2,,AUTO
         4 001603   012032 701000 4                  TSX1    MAKEME
         4 001604   000000 011000                    NOP     0
         4 001605   002054 710000 4                  TRA     s:16802

      610    16627
      611    16628    3      SELECT ( 31   /*  LIST_VAL */, %DISPLAY_CMD_VAL );

      612    16629    3      CALL ASL$LIST ( CODE ) ;

  16629  4 001606   000034 630400 5                  EPPR0   28
         4 001607   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001610   000000 701000 xent               TSX1    ASL$LIST
         4 001611   000000 011000                    NOP     0

      613    16630    3      ASA_BRKS_LOC_BIT = '0'B;

  16630  4 001612   000000 235003                    LDA     0,DU
         4 001613   000000 236003                    LDQ     0,DU
         4 001614   000000 757000 xsym               STAQ    ASA_BRKS_LOC
         4 001615   002054 710000 4                  TRA     s:16802

      614    16631
      615    16632    3      SELECT( 40 /* R_TERM */ );

      616    16633    3      CALL ASR$R_TERMINAL ;

  16633  4 001616   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001617   000000 701000 xent               TSX1    ASR$R_TERMINAL
         4 001620   000000 011000                    NOP     0
         4 001621   002054 710000 4                  TRA     s:16802

      617    16634
      618    16635    3      SELECT( 44 /* REMOVE STATION */ );

      619    16636    3      CALL ASR$R_STATION ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:157  

  16636  4 001622   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001623   000000 701000 xent               TSX1    ASR$R_STATION
         4 001624   000000 011000                    NOP     0
         4 001625   002054 710000 4                  TRA     s:16802

      620    16637
      621    16638    3      SELECT( 41 /* R_CON */ ) ;

      622    16639    3      CALL ASR$R_CONSOLE ;

  16639  4 001626   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001627   000000 701000 xent               TSX1    ASR$R_CONSOLE
         4 001630   000000 011000                    NOP     0
         4 001631   002054 710000 4                  TRA     s:16802

      623    16640
      624    16641    3      SELECT( 48 /* REMOVE DEV */ );

      625    16642    3      CALL ASR$R_DEVICE;

  16642  4 001632   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001633   000000 701000 xent               TSX1    ASR$R_DEVICE
         4 001634   000000 011000                    NOP     0
         4 001635   002054 710000 4                  TRA     s:16802

      626    16643
      627    16644    3      SELECT( 74 /* R_TPDEV_VAL */ );

      628    16645    3      CALL ASR$R_TPDEVICE;

  16645  4 001636   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001637   000000 701000 xent               TSX1    ASR$R_TPDEVICE
         4 001640   000000 011000                    NOP     0
         4 001641   002054 710000 4                  TRA     s:16802

      629    16646
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:158  
      630    16647    3      SELECT( 49 /* REMOVE FORM*/ );

      631    16648    3      CALL ASR$R_FORM;

  16648  4 001642   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001643   000000 701000 xent               TSX1    ASR$R_FORM
         4 001644   000000 011000                    NOP     0
         4 001645   002054 710000 4                  TRA     s:16802

      632    16649
      633    16650    3      SELECT( 51 /* D_FORM_VAL */ );

      634    16651    3      CALL ASR$D_FORM_RECS;

  16651  4 001646   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001647   000000 701000 xent               TSX1    ASR$D_FORM_RECS
         4 001650   000000 011000                    NOP     0
         4 001651   002054 710000 4                  TRA     s:16802

      635    16652
      636    16653    3      SELECT( 47 /* REMOVE WSN */ ) ;

      637    16654    3      CALL ASR$R_WSN ;

  16654  4 001652   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001653   000000 701000 xent               TSX1    ASR$R_WSN
         4 001654   000000 011000                    NOP     0
         4 001655   002054 710000 4                  TRA     s:16802

      638    16655
      639    16656    3      SELECT( 42 /* R_PRO */ ) ;

      640    16657    3      CALL ASR$R_PROFILE ;

  16657  4 001656   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001657   000000 701000 xent               TSX1    ASR$R_PROFILE
         4 001660   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:159  
         4 001661   002054 710000 4                  TRA     s:16802

      641    16658
      642    16659    3      SELECT( 43 /* R_USER */ ) ;

      643    16660    3      CALL REMOVE_USER_PROJECT( AS_FALSE );

  16660  4 001662   000035 236000 5                  LDQ     29
         4 001663   200051 756100                    STQ     FREE_SEG_TYPE+2,,AUTO
         4 001664   011414 701000 4                  TSX1    REMOVE_USER_PROJECT
         4 001665   000000 011000                    NOP     0
         4 001666   002054 710000 4                  TRA     s:16802

      644    16661
      645    16662    3      SELECT( 50 /* R_PROJ */ );

      646    16663    3      CALL REMOVE_USER_PROJECT( AS_TRUE );

  16663  4 001667   000036 236000 5                  LDQ     30
         4 001670   200051 756100                    STQ     FREE_SEG_TYPE+2,,AUTO
         4 001671   011414 701000 4                  TSX1    REMOVE_USER_PROJECT
         4 001672   000000 011000                    NOP     0
         4 001673   002054 710000 4                  TRA     s:16802

      647    16664
      648    16665    3      SELECT(34 /* CR_MOD_PRO_VAL */) ;

      649    16666    3      CALL ASD$PROFILE ;

  16666  4 001674   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001675   000000 701000 xent               TSX1    ASD$PROFILE
         4 001676   000000 011000                    NOP     0
         4 001677   002054 710000 4                  TRA     s:16802

      650    16667
      651    16668    3      SELECT( 36 /* CR_MOD_TERM */ ) ;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:160  
      652    16669    3      CALL ASA$TERMINAL ;

  16669  4 001700   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001701   000000 701000 xent               TSX1    ASA$TERMINAL
         4 001702   000000 011000                    NOP     0
         4 001703   002054 710000 4                  TRA     s:16802

      653    16670
      654    16671    3      SELECT( 45 /* CREATE STATION */ ) ;

      655    16672    3      CALL ASA$STATION ;

  16672  4 001704   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001705   000000 701000 xent               TSX1    ASA$STATION
         4 001706   000000 011000                    NOP     0
         4 001707   002054 710000 4                  TRA     s:16802

      656    16673
      657    16674    3      SELECT( 35 /* CR_MOD_CON_VAL */ ) ;

      658    16675    3      CALL ASA$CONSOLE ;

  16675  4 001710   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001711   000000 701000 xent               TSX1    ASA$CONSOLE
         4 001712   000000 011000                    NOP     0
         4 001713   002054 710000 4                  TRA     s:16802

      659    16676
      660    16677    3      SELECT( 46 /* CR_MOD_DEV_VAL */ );

      661    16678    3      CALL ASA$DEVICE;

  16678  4 001714   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001715   000000 701000 xent               TSX1    ASA$DEVICE
         4 001716   000000 011000                    NOP     0
         4 001717   002054 710000 4                  TRA     s:16802

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:161  
      662    16679
      663    16680    3      SELECT( 39 /* CR_MOD_FORM_VAL */ ) ;

      664    16681    3      CALL ASF$FORM( AS_FALSE );

  16681  4 001720   000035 630400 5                  EPPR0   29
         4 001721   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001722   000000 701000 xent               TSX1    ASF$FORM
         4 001723   000000 011000                    NOP     0
         4 001724   002054 710000 4                  TRA     s:16802

      665    16682
      666    16683    3      SELECT( 54  /* CR_MOD_PSEUDO_VAL */ ) ;

      667    16684    3      CALL ASF$FORM( AS_TRUE );

  16684  4 001725   000036 630400 5                  EPPR0   30
         4 001726   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001727   000000 701000 xent               TSX1    ASF$FORM
         4 001730   000000 011000                    NOP     0
         4 001731   002054 710000 4                  TRA     s:16802

      668    16685
      669    16686    3      SELECT( 38 /* CR_MOD_WSN */ ) ;

      670    16687    3      CALL ASW$WSN ;

  16687  4 001732   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001733   000000 701000 xent               TSX1    ASW$WSN
         4 001734   000000 011000                    NOP     0
         4 001735   002054 710000 4                  TRA     s:16802

      671    16688
      672    16689    3      SELECT( 37 /* D_USERS_VAL */ ) ;

      673    16690    3      CALL ASR$D_USERS_RECS ;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:162  
  16690  4 001736   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001737   000000 701000 xent               TSX1    ASR$D_USERS_RECS
         4 001740   000000 011000                    NOP     0
         4 001741   002054 710000 4                  TRA     s:16802

      674    16691
      675    16692    3      SELECT( 55 /* CR_MOD_VIR_CIR_VAL */ ,

      676    16693    3           63 /* CR_MOD_LINK_VAL */  ,
      677    16694    3           %CR_MOD_LINK_DEV_VAL ) ;
      678    16695
      679    16696    3      CALL ASA$LINK_VIRCIR ;

  16696  4 001742   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001743   000000 701000 xent               TSX1    ASA$LINK_VIRCIR
         4 001744   000000 011000                    NOP     0
         4 001745   002054 710000 4                  TRA     s:16802

      680    16697
      681    16698    3      SELECT( 56 /* R_VIR_CIR */  ,

      682    16699    3           64 /* R_LINK_VAL */   ,
      683    16700    3           75 /* R_LINK_DEV_VAL */ ) ;
      684    16701
      685    16702    3      CALL ASR$R_LINK_VIRCIR ;

  16702  4 001746   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001747   000000 701000 xent               TSX1    ASR$R_LINK_VIRCIR
         4 001750   000000 011000                    NOP     0
         4 001751   002054 710000 4                  TRA     s:16802

      686    16703
      687    16704    3      SELECT( 57 /* CR_MOD_LINE_VAL */, 58 /* CR_MOD_CONT_VAL */, 61
             16704               /* CR_MOD_LINE_DEV_VAL */ );

      688    16705    3      CALL ASA$LINE_CONTROLLER;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:163  
  16705  4 001752   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001753   000000 701000 xent               TSX1    ASA$LINE_CONTROLLER
         4 001754   000000 011000                    NOP     0
         4 001755   002054 710000 4                  TRA     s:16802

      689    16706
      690    16707    3      SELECT( 59 /* R_LINE_VAL */, 60 /* R_CONT_VAL */, 62 /* R_LINE_DEV_VAL */ );

      691    16708    3      CALL ASR$R_LINE_CONT;

  16708  4 001756   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001757   000000 701000 xent               TSX1    ASR$R_LINE_CONT
         4 001760   000000 011000                    NOP     0
         4 001761   002054 710000 4                  TRA     s:16802

      692    16709
      693    16710    3      SELECT( 65 /* UNTIE_USER_VAL */ );

      694    16711    3      CALL UNTIE_USER;

  16711  4 001762   005657 701000 4                  TSX1    UNTIE_USER
         4 001763   000000 011000                    NOP     0
         4 001764   002054 710000 4                  TRA     s:16802

      695    16712
      696    16713    3      SELECT( 66 /* UNTIE_PROJ_VAL */ );

      697    16714    3      CALL UNTIE_PROJ;

  16714  4 001765   006077 701000 4                  TSX1    UNTIE_PROJ
         4 001766   000000 011000                    NOP     0
         4 001767   002054 710000 4                  TRA     s:16802

      698    16715
      699    16716    3      SELECT( 67 /* TIE_USER_VAL */ );

      700    16717    3      CALL TIE_USER;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:164  

  16717  4 001770   006434 701000 4                  TSX1    TIE_USER
         4 001771   000000 011000                    NOP     0
         4 001772   002054 710000 4                  TRA     s:16802

      701    16718
      702    16719    3      SELECT( 68 /* TIE_PROJ_VAL */ );

      703    16720    3      CALL TIE_PROJ;

  16720  4 001773   006736 701000 4                  TSX1    TIE_PROJ
         4 001774   000000 011000                    NOP     0
         4 001775   002054 710000 4                  TRA     s:16802

      704    16721
      705    16722    3      SELECT( 69 /* MOD_USER_TO_PROJ_VAL */ );

      706    16723    3      CALL MOD_USER_TO_PROJ;

  16723  4 001776   004443 701000 4                  TSX1    MOD_USER_TO_PROJ
         4 001777   000000 011000                    NOP     0
         4 002000   002054 710000 4                  TRA     s:16802

      707    16724
      708    16725    3      SELECT( 70 /* MOD_PROJ_TO_USER_VAL */ );

      709    16726    3      CALL MOD_PROJ_TO_USER;

  16726  4 002001   005141 701000 4                  TSX1    MOD_PROJ_TO_USER
         4 002002   000000 011000                    NOP     0
         4 002003   002054 710000 4                  TRA     s:16802

      710    16727
      711    16728    3      SELECT( 71 /* CR_MOD_CHARSET_VAL */ );

      712    16729    3      CALL ASC$CHARSET;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:165  
  16729  4 002004   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002005   000000 701000 xent               TSX1    ASC$CHARSET
         4 002006   000000 011000                    NOP     0
         4 002007   002054 710000 4                  TRA     s:16802

      713    16730
      714    16731    3      SELECT( 72 /* R_CHARSET_VAL */ );

      715    16732    3      CALL ASR$R_CHARSET;

  16732  4 002010   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002011   000000 701000 xent               TSX1    ASR$R_CHARSET
         4 002012   000000 011000                    NOP     0
         4 002013   002054 710000 4                  TRA     s:16802

      716    16733
      717    16734    3      SELECT( 73 /* D_CHARSET_VAL */ );

      718    16735    3      CALL ASR$D_CHARSET_RECS;

  16735  4 002014   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002015   000000 701000 xent               TSX1    ASR$D_CHARSET_RECS
         4 002016   000000 011000                    NOP     0
         4 002017   002054 710000 4                  TRA     s:16802

      719    16736
      720    16737    3      SELECT( 80 /* RECONFIG_TIGR_STAT_VAL */ );

      721    16738    3      CALL RECONFIG_TIGR_STATION;

  16738  4 002020   002347 701000 4                  TSX1    RECONFIG_TIGR_STATION
         4 002021   000000 011000                    NOP     0
         4 002022   002054 710000 4                  TRA     s:16802

      722    16739
      723    16740    3      SELECT(12   /*  END_VAL  */) ;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:166  
      724    16741    3      MORE = AS_FALSE ;

  16741  4 002023   000000 236000 xsym               LDQ     AS_FALSE
         4 002024   400000 376003                    ANQ     -131072,DU
         4 002025   000000 756000 2                  STQ     MORE
         4 002026   002054 710000 4                  TRA     s:16802

      725    16742
      726    16743    3      SELECT(302 /* HELP_VAL */) ;

      727    16744    3      CALL ASH$HELP ;

  16744  4 002027   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002030   000000 701000 xent               TSX1    ASH$HELP
         4 002031   000000 011000                    NOP     0
         4 002032   002054 710000 4                  TRA     s:16802

      728    16745
      729    16746    3      SELECT(300 /* DQUESTION_VAL */) ;

      730    16747    3      CALL ASH$DQUEST  ;

  16747  4 002033   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002034   000000 701000 xent               TSX1    ASH$DQUEST
         4 002035   000000 011000                    NOP     0
         4 002036   002054 710000 4                  TRA     s:16802

      731    16748
      732    16749    3      SELECT(301 /* QUESTION_VAL */) ;

      733    16750    3      CALL ASH$QUEST  ;

  16750  4 002037   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002040   000000 701000 xent               TSX1    ASH$QUEST
         4 002041   000000 011000                    NOP     0
         4 002042   002054 710000 4                  TRA     s:16802

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:167  
      734    16751    3      SELECT (

      735    16752    3           77 /* D_TERM_VAL */,
      736    16753    3           78 /* D_CON_VAL */,
      737    16754    3           79 /* D_PRO_VAL */,
      738    16755    3           76 /* D_DEV_VAL */
      739    16756    3           );
      740    16757        /*E*  ERROR:    ASA-E$NOT_IMPLEMENTED-C
      741    16758              MESSAGE:  That feature is not yet implemented.
      742    16759              MESSAGE1: You have requested an action that SUPER cannot yet perform.
      743    16760        */
      744    16761           %SCREAM( ERR#=E$NOT_IMPLEMENTED, LEVEL=WARN, MID='A' );

  16771  4 002043   000037 630400 5                  EPPR0   31
         4 002044   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002045   000000 701000 xent               TSX1    ASH$WARN
         4 002046   000000 011000                    NOP     0
         4 002047   002054 710000 4                  TRA     s:16802

      745    16776
      746    16777    3      SELECT(ELSE) ;

      747    16778        /*E*  ERROR:    ASA-E$INVALID_COMMAND-C
      748    16779              MESSAGE:  Invalid command.
      749    16780              MESSAGE1: The valid COMMANDs are:
      750    16781                          C[REATE], M[ODIFY], L[IST], R[EMOVE], DEL[ETE]
      751    16782                          H[ELP] [<cmd>], Q[UIT], and E[ND].
      752    16783        */
      753    16784        %SCREAM( ERR#=E$INVALID_COMMAND, LEVEL=ERROR, MID='A' );

  16796  4 002050   000040 630400 5                  EPPR0   32
         4 002051   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002052   000000 701000 xent               TSX1    ASH$ERROR
         4 002053   000000 011000                    NOP     0

      754    16799
      755    16800    3      END ;     /*  Do case  */
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:168  

      756    16801                                                              /**/
      757    16802    2   P_PCB.ROOT$ = ADDR(CMD_NODES) ;

  16802  4 002054   000014 236000 5                  LDQ     12
         4 002055   000001 756000 xsym               STQ     P_PCB+1

      758    16803                                                              /**/
      759    16804    3   IF DSEG1SIZE > 3072 THEN DO;

  16804  4 002056   000000 235000 xsym               LDA     DSEG1SIZE
         4 002057   006001 115007                    CMPA    3073,DL
         4 002060   002075 602000 4                  TNC     s:16809

      760    16805    3      FREE_SEG_SIZE = DSEG1SIZE - 3072;

  16805  4 002061   006000 135007                    SBLA    3072,DL
         4 002062   200046 755100                    STA     FREE_SEG_SIZE,,AUTO

      761    16806    3      FREE_SEG_TYPE = 1;

  16806  4 002063   000001 235007                    LDA     1,DL
         4 002064   200047 755100                    STA     FREE_SEG_TYPE,,AUTO

      762    16807    3      CALL ASB$FREE_SEG (FREE_SEG_TYPE, FREE_SEG_SIZE);

  16807  4 002065   200046 630500                    EPPR0   FREE_SEG_SIZE,,AUTO
         4 002066   200121 450500                    STP0    I+3,,AUTO
         4 002067   200047 631500                    EPPR1   FREE_SEG_TYPE,,AUTO
         4 002070   200120 451500                    STP1    I+2,,AUTO
         4 002071   200120 630500                    EPPR0   I+2,,AUTO
         4 002072   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002073   000000 701000 xent               TSX1    ASB$FREE_SEG
         4 002074   000000 011000                    NOP     0

      763    16808    3      END;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:169  
      764    16809    3   IF DSEG2SIZE > 3072 THEN DO;

  16809  4 002075   000000 235000 xsym               LDA     DSEG2SIZE
         4 002076   006001 115007                    CMPA    3073,DL
         4 002077   002114 602000 4                  TNC     s:16814

      765    16810    3      FREE_SEG_SIZE = DSEG2SIZE - 3072;

  16810  4 002100   006000 135007                    SBLA    3072,DL
         4 002101   200046 755100                    STA     FREE_SEG_SIZE,,AUTO

      766    16811    3      FREE_SEG_TYPE = 2;

  16811  4 002102   000002 236007                    LDQ     2,DL
         4 002103   200047 756100                    STQ     FREE_SEG_TYPE,,AUTO

      767    16812    3      CALL ASB$FREE_SEG (FREE_SEG_TYPE, FREE_SEG_SIZE);

  16812  4 002104   200046 630500                    EPPR0   FREE_SEG_SIZE,,AUTO
         4 002105   200121 450500                    STP0    I+3,,AUTO
         4 002106   200047 631500                    EPPR1   FREE_SEG_TYPE,,AUTO
         4 002107   200120 451500                    STP1    I+2,,AUTO
         4 002110   200120 630500                    EPPR0   I+2,,AUTO
         4 002111   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002112   000000 701000 xent               TSX1    ASB$FREE_SEG
         4 002113   000000 011000                    NOP     0

      768    16813    3      END;

      769    16814    3   IF DSEG3SIZE > 1024 THEN DO;

  16814  4 002114   000000 235000 xsym               LDA     DSEG3SIZE
         4 002115   002001 115007                    CMPA    1025,DL
         4 002116   002133 602000 4                  TNC     s:16819

      770    16815    3      FREE_SEG_SIZE = DSEG3SIZE - 1024;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:170  
  16815  4 002117   002000 135007                    SBLA    1024,DL
         4 002120   200046 755100                    STA     FREE_SEG_SIZE,,AUTO

      771    16816    3      FREE_SEG_TYPE = 3;

  16816  4 002121   000003 236007                    LDQ     3,DL
         4 002122   200047 756100                    STQ     FREE_SEG_TYPE,,AUTO

      772    16817    3      CALL ASB$FREE_SEG (FREE_SEG_TYPE, FREE_SEG_SIZE);

  16817  4 002123   200046 630500                    EPPR0   FREE_SEG_SIZE,,AUTO
         4 002124   200121 450500                    STP0    I+3,,AUTO
         4 002125   200047 631500                    EPPR1   FREE_SEG_TYPE,,AUTO
         4 002126   200120 451500                    STP1    I+2,,AUTO
         4 002127   200120 630500                    EPPR0   I+2,,AUTO
         4 002130   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002131   000000 701000 xent               TSX1    ASB$FREE_SEG
         4 002132   000000 011000                    NOP     0

      773    16818    3      END;

      774    16819    2   DSEG_FLG = '0'B;

  16819  4 002133   000000 450000 xsym               STZ     DSEG_FLG

      775    16820
      776    16821    2      END ;     /*  Do while  */

  16821  4 002134   000000 234000 2                  SZN     MORE
         4 002135   000442 604000 4                  TMI     s:16303

      777    16822                                                              /**/
      778    16823    1   SUPER_ERR:
      779    16824    1   IF (MORE)

  16824  4 002136   000000 234000 2     SUPER_ERR    SZN     MORE
         4 002137   002145 605000 4                  TPL     WRITE_CHAIN_ERR
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:171  

      780    16825    2   THEN DO;

      781    16826           %SCREAM( ERR#=E$INVALID_COMMAND, LEVEL=ERROR, MID='A' );

  16838  4 002140   000040 630400 5                  EPPR0   32
         4 002141   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002142   000000 701000 xent               TSX1    ASH$ERROR
         4 002143   000000 011000                    NOP     0

      782    16841    2      GOTO CMD_LOOP ;

  16841  4 002144   000430 710000 4                  TRA     CMD_LOOP

  16824  4 002145                       WRITE_CHAIN* null
      783    16842    2      END ;   /*  If (more)  */
      784    16843                                                              /**/
      785    16844    1   WRITE_CHAIN_ERR: ;
      786    16845    1   IF ( MORE )

  16845  4 002145   002152 605000 4                  TPL     CLOSE_FILES

      787    16846    1   THEN
      788    16847    1      CALL ASH$ERROR( ERR_CODE ) ;

  16847  4 002146   000001 630400 5                  EPPR0   1
         4 002147   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002150   000000 701000 xent               TSX1    ASH$ERROR
         4 002151   000000 011000                    NOP     0

  16845  4 002152                       CLOSE_FILES  null
      789    16848                                                              /**/
      790    16849    1   CLOSE_FILES: ;
      791    16850    1   CALL ASB$CLOSE_USERS ;

  16850  4 002152   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002153   000000 701000 xent               TSX1    ASB$CLOSE_USERS
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:172  
         4 002154   000000 011000                    NOP     0

      792    16851    1   CALL ASB$CLOSE_HLP ;

  16851  4 002155   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002156   000000 701000 xent               TSX1    ASB$CLOSE_HLP
         4 002157   000000 011000                    NOP     0

      793    16852    1   CALL ASD$CLOSE_PRO ;

  16852  4 002160   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002161   000000 701000 xent               TSX1    ASD$CLOSE_PRO
         4 002162   000000 011000                    NOP     0

  16845  4 002163                       OUTPUT_ERRO* null
      794    16853                                                              /*  Output error count.  */
      795    16854    1   OUTPUT_ERROR_CNT: ;
      796    16855    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );

  16855  4 002163   000006 630400 5                  EPPR0   6
         4 002164   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002165   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002166   000000 011000                    NOP     0

      797    16856    1   IF ERR_CNT = 0 THEN CALL ASB$WRITE_LO( '***  NO Errors  ***', 19 );

  16856  4 002167   000000 235000 xsym               LDA     ERR_CNT
         4 002170   002176 601000 4                  TNZ     s:16858

  16856  4 002171   000042 630400 5                  EPPR0   34
         4 002172   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002173   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002174   000000 011000                    NOP     0
         4 002175   002245 710000 4                  TRA     s:16897

      798    16857    1   ELSE
      799    16858    1      IF ERR_CNT = 1 THEN CALL ASB$WRITE_LO( '***  1 Error  ***', 17 );
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:173  

  16858  4 002176   000001 115007                    CMPA    1,DL
         4 002177   002205 601000 4                  TNZ     s:16868

  16858  4 002200   000045 630400 5                  EPPR0   37
         4 002201   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002202   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002203   000000 011000                    NOP     0
         4 002204   002245 710000 4                  TRA     s:16897

      800    16859    2      ELSE DO;

      801    16860              %NUMBER( NUM1=ERR_CNT );
             16868    2         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, ERR_CNT );

  16868  4 002205   000047 630400 5                  EPPR0   39
         4 002206   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 002207   000000 701000 xent               TSX1    ASB$BINCHAR
         4 002210   000000 011000                    NOP     0

      802    16890    2         CALL CONCAT( OUT_BUF, '***  ',

  16890  4 002211   000000 236000 xsym               LDQ     AS_FIELD1
         4 002212   000033 772000                    QRL     27
         4 002213   040000 100400                    MLR     fill='040'O
         4 002214   000067 000005 3                  ADSC9   SIZEC_DREC+55            cn=0,n=5
         4 002215   000000 000005 xsym               ADSC9   OUT_BUF                  cn=0,n=5
         4 002216   000000 620006                    EAX0    0,QL
         4 002217   040000 100440                    MLR     fill='040'O
         4 002220   000000 200010 xsym               ADSC9   AS_FIELD1                cn=1,n=*X0
         4 002221   000001 200207 xsym               ADSC9   OUT_BUF+1                cn=1,n=135
         4 002222   000207 116007                    CMPQ    135,DL
         4 002223   002231 603000 4                  TRC     s:16893
         4 002224   777570 620006                    EAX0    -136,QL
         4 002225   777777 660003                    ERX0    -1,DU
         4 002226   040046 100400                    MLR     fill='040'O
         4 002227   000101 000014 3                  ADSC9   SIZEC_DREC+65            cn=0,n=12
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:174  
         4 002230   000001 200010 xsym               ADSC9   OUT_BUF+1,Q              cn=1,n=*X0

      803    16891    2              SUBSTR( AS_FIELD1.TEXT, 0, AS_FIELD1.COUNT ),
      804    16892    2              ' Errors  ***' ) ;
      805    16893    2         ARS = 17 + AS_FIELD1.COUNT;

  16893  4 002231   000000 236000 xsym               LDQ     AS_FIELD1
         4 002232   000033 772000                    QRL     27
         4 002233   000021 036007                    ADLQ    17,DL
         4 002234   200003 756100                    STQ     ARS,,AUTO

      806    16894    2         CALL ASB$WRITE_LO( OUT_BUF, ARS ) ;

  16894  4 002235   200003 630500                    EPPR0   ARS,,AUTO
         4 002236   200121 450500                    STP0    I+3,,AUTO
         4 002237   000011 236000 5                  LDQ     9
         4 002240   200120 756100                    STQ     I+2,,AUTO
         4 002241   200120 630500                    EPPR0   I+2,,AUTO
         4 002242   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002243   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002244   000000 011000                    NOP     0

      807    16895    2         END;

      808    16896                                                              /*  Output warning count. */
      809    16897    1   IF WARN_CNT = 0 THEN CALL ASB$WRITE_LO( '***  NO Warnings ***', 20 );

  16897  4 002245   000000 235000 xsym               LDA     WARN_CNT
         4 002246   002254 601000 4                  TNZ     s:16899

  16897  4 002247   000054 630400 5                  EPPR0   44
         4 002250   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002251   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002252   000000 011000                    NOP     0
         4 002253   002323 710000 4                  TRA     s:16937

      810    16898    1   ELSE
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:175  
      811    16899    1      IF WARN_CNT = 1 THEN CALL ASB$WRITE_LO( '***  1 Warning ***', 19 );

  16899  4 002254   000001 115007                    CMPA    1,DL
         4 002255   002263 601000 4                  TNZ     s:16909

  16899  4 002256   000056 630400 5                  EPPR0   46
         4 002257   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002260   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002261   000000 011000                    NOP     0
         4 002262   002323 710000 4                  TRA     s:16937

      812    16900    2      ELSE DO;

      813    16901              %NUMBER( NUM1=WARN_CNT );
             16909    2         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, WARN_CNT );

  16909  4 002263   000060 630400 5                  EPPR0   48
         4 002264   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 002265   000000 701000 xent               TSX1    ASB$BINCHAR
         4 002266   000000 011000                    NOP     0

      814    16931    2         CALL CONCAT( OUT_BUF, '***  ',

  16931  4 002267   000000 236000 xsym               LDQ     AS_FIELD1
         4 002270   000033 772000                    QRL     27
         4 002271   040000 100400                    MLR     fill='040'O
         4 002272   000067 000005 3                  ADSC9   SIZEC_DREC+55            cn=0,n=5
         4 002273   000000 000005 xsym               ADSC9   OUT_BUF                  cn=0,n=5
         4 002274   000000 620006                    EAX0    0,QL
         4 002275   040000 100440                    MLR     fill='040'O
         4 002276   000000 200010 xsym               ADSC9   AS_FIELD1                cn=1,n=*X0
         4 002277   000001 200207 xsym               ADSC9   OUT_BUF+1                cn=1,n=135
         4 002300   000207 116007                    CMPQ    135,DL
         4 002301   002307 603000 4                  TRC     s:16934
         4 002302   777570 620006                    EAX0    -136,QL
         4 002303   777777 660003                    ERX0    -1,DU
         4 002304   040046 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:176  
         4 002305   000116 000016 3                  ADSC9   SIZEC_DREC+78            cn=0,n=14
         4 002306   000001 200010 xsym               ADSC9   OUT_BUF+1,Q              cn=1,n=*X0

      815    16932    2              SUBSTR( AS_FIELD1.TEXT, 0, AS_FIELD1.COUNT ),
      816    16933    2              ' Warnings  ***' ) ;
      817    16934    2         ARS = 19 + AS_FIELD1.COUNT ;

  16934  4 002307   000000 236000 xsym               LDQ     AS_FIELD1
         4 002310   000033 772000                    QRL     27
         4 002311   000023 036007                    ADLQ    19,DL
         4 002312   200003 756100                    STQ     ARS,,AUTO

      818    16935    2         CALL ASB$WRITE_LO( OUT_BUF, ARS ) ;

  16935  4 002313   200003 630500                    EPPR0   ARS,,AUTO
         4 002314   200121 450500                    STP0    I+3,,AUTO
         4 002315   000011 236000 5                  LDQ     9
         4 002316   200120 756100                    STQ     I+2,,AUTO
         4 002317   200120 630500                    EPPR0   I+2,,AUTO
         4 002320   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002321   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002322   000000 011000                    NOP     0

      819    16936    2         END ;   /* Else do */

      820    16937    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );

  16937  4 002323   000006 630400 5                  EPPR0   6
         4 002324   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002325   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002326   000000 011000                    NOP     0

      821    16938    2   IF ERR_CNT > 0 THEN DO;

  16938  4 002327   000000 235000 xsym               LDA     ERR_CNT
         4 002330   002334 600000 4                  TZE     s:16943

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:177  
      822    16939    2   EXIT_SUPER:
      823    16940    2      FPT_EXIT.V.STEPCC# = 4;

  16940  4 002331   004000 236003       EXIT_SUPER   LDQ     2048,DU
         4 002332   000006 552040 2                  STBQ    FPT_EXIT+4,'40'O

      824    16941    2      END;

  16941  4 002333   002340 710000 4                  TRA     s:16944

      825    16942    1   ELSE
      826    16943    1      IF WARN_CNT > 0 THEN FPT_EXIT.V.STEPCC# = 2;

  16943  4 002334   000000 236000 xsym               LDQ     WARN_CNT
         4 002335   002340 600000 4                  TZE     s:16944

  16943  4 002336   002000 236003                    LDQ     1024,DU
         4 002337   000006 552040 2                  STBQ    FPT_EXIT+4,'40'O

      827    16944    1   CALL ASB$CLOSE_LO;

  16944  4 002340   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002341   000000 701000 xent               TSX1    ASB$CLOSE_LO
         4 002342   000000 011000                    NOP     0

      828    16945    1   CALL M$EXIT( FPT_EXIT );

  16945  4 002343   000002 630400 2                  EPPR0   FPT_EXIT
         4 002344   000001 713400                    CLIMB   exit
         4 002345   400400 401760                    pmme    nvectors=2
         4 002346   013172 710000 4                  TRA     s:20263

      829    16946        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:178  
      830    16947    1   RECONFIG_TIGR_STATION: PROC;

  16947  4 002347   200050 741300       RECONFIG_TI* STX1  ! FREE_SEG_TYPE+1,,AUTO

      831    16948        /*I*   NAME:  RECONFIG_TIGR_STATION
      832    16949
      833    16950               PURPOSE:  To drive the RECONFIGURE STATION command
      834    16951
      835    16952               CALL:  CALL RECONFIG_TIGR_STATION
      836    16953
      837    16954               INPUT:  station name from the input command
      838    16955
      839    16956               OUTPUT:  NONE
      840    16957
      841    16958               DESCRIPTION:
      842    16959                   This routine will read the 'WSN' record from the :CONFIG
      843    16960                   file and search that record for the specified station name.
      844    16961                   If the station name is not found an error will be issued.
      845    16962                   If the station name is found, this routine will ask for
      846    16963                   confirmation of the command.  If anything other than YES$
      847    16964                   or yes$ is given in response to the confirmation request,
      848    16965                   a return is effected.  If the command is confirmed, this
      849    16966                   routine fills in a command buffer with the REMOVE STATION
      850    16967                   stationname command and parses it.  It then calls
      851    16968                   ASR$R_TIGR_STATION, which removes all knowledge of the
      852    16969                   station from SUPER maintained files.
      853    16970                   This routine then fills in a REMOVE
      854    16971                   WSN wsnname command into the command buffer and parses
      855    16972                   that.  It then calls ASR$R_TIGR_WSN, which removes all
      856    16973                   knowledge of the specified wsn from SUPER maintained files.
      857    16974                   If those two routines
      858    16975                   don't altreturn then this routine calls ASC$CONFIG to
      859    16976                   rebuild the removed station and wsn from the :CONFIG file.
      860    16977        */
      861    16978    2   DCL REM_STA CHAR (0) STATIC INIT ('REM STATION ');
      862    16979    2   DCL REM_WSN CHAR (0) STATIC INIT ('REM WSN ');
      863    16980    2   DCL RECON_PROMPT CHAR (0) STATIC INIT ('Reconfigure station          ?');
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:179  
      864    16981    2   DCL PART1 CHAR (0) STATIC INIT ('Reconfiguring station ');
      865    16982    2   DCL PART2 CHAR (0) STATIC INIT (' will remove STATION and WSN ');
      866    16983    2   DCL PART3 CHAR (0) STATIC INIT (' and then rebuild ');
      867    16984    2   DCL PART4 CHAR (0) STATIC INIT ('them with only the IOM connected devices.');
      868    16985    2   DCL PART5 CHAR(0) STATIC INIT ('Answer must be ''YES$'', reconfiguration of ');
      869    16986    2   DCL PART6 CHAR(0) STATIC INIT (' cancelled.');
      870    16987    2   DCL PART7 CHAR (0) STATIC INIT ('Station ');
      871    16988    2   DCL PART8 CHAR (0) STATIC INIT (' has been recreated.');
      872    16989    2   DCL PART9 CHAR (0) STATIC INIT ('WSN ');
      873    16990    2   DCL PART10 CHAR (0) STATIC INIT (' has been recreated from the new STATION ');
      874    16991    2   DCL LINE CHAR(80) CALIGNED;
      875    16992    2   DCL WSN_INDEX  UBIN;
      876    16993
      877    16994        /*
      878    16995          Find the specified station name in the parse nodes
      879    16996          and check for errors
      880    16997        */
      881    16998    2   BLK$ = P$NODE.SUBLK$(0);

  16998  4 002350   000000 470400 xsym               LDP0    NODE$
         4 002351   000003 236100                    LDQ     3,,PR0
         4 002352   200007 756100                    STQ     BLK$,,AUTO

      882    16999    2   IF OUT$SYM.COUNT > 8 THEN

  16999  4 002353   200007 471500                    LDP1    BLK$,,AUTO
         4 002354   100004 236100                    LDQ     4,,PR1
         4 002355   777000 376003                    ANQ     -512,DU
         4 002356   011000 116003                    CMPQ    4608,DU
         4 002357   002366 602000 4                  TNC     s:17018

      883    17000    3   DO;

      884    17001           %SCREAM ( ERR#=E$SNAMETOOBIG, LEVEL=ERROR, MID='A' );

  17013  4 002360   000064 630400 5                  EPPR0   52
         4 002361   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:180  
         4 002362   000000 701000 xent               TSX1    ASH$ERROR
         4 002363   000000 011000                    NOP     0

      885    17016    3      RETURN;

  17016  4 002364   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 002365   000001 702211                    TSX2  ! 1,X1

      886    17017    3      END; /*  If count > 8  */
      887    17018    2   CALL ASC$CHECK_TIGR_WSN (OUT$SYM.TEXTC$,WSN_INDEX) WHENALTRETURN

  17018  4 002366   200075 633500                    EPPR3   WSN_INDEX,,AUTO
         4 002367   200121 453500                    STP3    I+3,,AUTO
         4 002370   200007 236100                    LDQ     BLK$,,AUTO
         4 002371   000003 036003                    ADLQ    3,DU
         4 002372   200120 756100                    STQ     I+2,,AUTO
         4 002373   200120 630500                    EPPR0   I+2,,AUTO
         4 002374   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002375   000000 701000 xent               TSX1    ASC$CHECK_TIGR_WSN
         4 002376   002400 702000 4                  TSX2    s:17025
         4 002377   002417 710000 4                  TRA     s:17045

      888    17019    3   DO;

      889    17020        /*E* ERROR:  ASA-E$NOTTIGRWSN-C
      890    17021             MESSAGE:  %U1 is not a TIGR defined WSN.  Only TIGR defined
      891    17022                       wsns can be reconfigured.
      892    17023             MESSAGE1:  I suggest you REMOVE STATION %U1, and then reCREATE it.
      893    17024        */
      894    17025    3      AS_FIELD1.COUNT = OUT$SYM.COUNT;

  17025  4 002400   200007 470500                    LDP0    BLK$,,AUTO
         4 002401   000004 236100                    LDQ     4,,PR0
         4 002402   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      895    17026    3      AS_FIELD1.TEXT = OUT$SYM.TEXT;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:181  
  17026  4 002403   000004 236100                    LDQ     4,,PR0
         4 002404   000033 772000                    QRL     27
         4 002405   000000 620006                    EAX0    0,QL
         4 002406   040000 100540                    MLR     fill='040'O
         4 002407   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002410   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      896    17027           %SCREAM (ERR#=E$NOTTIGRWSN, LEVEL=ERROR, MID='A');

  17039  4 002411   000065 630400 5                  EPPR0   53
         4 002412   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002413   000000 701000 xent               TSX1    ASH$ERROR
         4 002414   000000 011000                    NOP     0

      897    17042    3      RETURN;

  17042  4 002415   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 002416   000001 702211                    TSX2  ! 1,X1

      898    17043    3      END; /*  Whenaltreturn  */
      899    17044
      900    17045    2   CALL CONCAT (LINE,PART1,OUT$SYM.TEXT,PART2,OUT$SYM.TEXT);

  17045  4 002417   200007 470500                    LDP0    BLK$,,AUTO
         4 002420   000004 236100                    LDQ     4,,PR0
         4 002421   000033 772000                    QRL     27
         4 002422   040100 100400                    MLR     fill='040'O
         4 002423   000201 000026 2                  ADSC9   PART1                    cn=0,n=22
         4 002424   200051 000026                    ADSC9   LINE,,AUTO               cn=0,n=22
         4 002425   000000 620006                    EAX0    0,QL
         4 002426   040100 100540                    MLR     fill='040'O
         4 002427   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002430   200056 400072                    ADSC9   PROJ_ADMIN_KEY+4,,AUTO   cn=2,n=58
         4 002431   000072 116007                    CMPQ    58,DL
         4 002432   002450 603000 4                  TRC     s:17046
         4 002433   777705 620006                    EAX0    -59,QL
         4 002434   777777 660003                    ERX0    -1,DU
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:182  
         4 002435   040146 100400                    MLR     fill='040'O
         4 002436   000207 000035 2                  ADSC9   PART2                    cn=0,n=29
         4 002437   200056 400010                    ADSC9   PROJ_ADMIN_KEY+4,Q,AUTO  cn=2,n=*X0
         4 002440   000035 116007                    CMPQ    29,DL
         4 002441   002450 603000 4                  TRC     s:17046
         4 002442   777742 620006                    EAX0    -30,QL
         4 002443   777777 660003                    ERX0    -1,DU
         4 002444   000000 621006                    EAX1    0,QL
         4 002445   040146 100540                    MLR     fill='040'O
         4 002446   000004 200011                    ADSC9   4,,PR0                   cn=1,n=*X1
         4 002447   200065 600010                    ADSC9   PROJ_ACCT_LIST$+1,Q,AUTO cn=3,n=*X0

      901    17046    2   CALL ASB$WRITE_LO (LINE, SIZEC (LINE));

  17046  4 002450   000067 236000 5                  LDQ     55
         4 002451   200121 756100                    STQ     I+3,,AUTO
         4 002452   200051 631500                    EPPR1   LINE,,AUTO
         4 002453   200120 451500                    STP1    I+2,,AUTO
         4 002454   200120 630500                    EPPR0   I+2,,AUTO
         4 002455   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002456   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002457   000000 011000                    NOP     0

      902    17047    2   CALL CONCAT (LINE,PART3,PART4);

  17047  4 002460   040100 100400                    MLR     fill='040'O
         4 002461   000217 000022 2                  ADSC9   PART3                    cn=0,n=18
         4 002462   200051 000022                    ADSC9   LINE,,AUTO               cn=0,n=18
         4 002463   040100 100400                    MLR     fill='040'O
         4 002464   000224 000051 2                  ADSC9   PART4                    cn=0,n=41
         4 002465   200055 400076                    ADSC9   PROJ_ADMIN_KEY+3,,AUTO   cn=2,n=62

      903    17048    2   CALL ASB$WRITE_LO (LINE, SIZEC (LINE));

  17048  4 002466   000067 236000 5                  LDQ     55
         4 002467   200121 756100                    STQ     I+3,,AUTO
         4 002470   200051 630500                    EPPR0   LINE,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:183  
         4 002471   200120 450500                    STP0    I+2,,AUTO
         4 002472   200120 630500                    EPPR0   I+2,,AUTO
         4 002473   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002474   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002475   000000 011000                    NOP     0

      904    17049    2   CALL ASB$WRITE_LO (' ', 1);

  17049  4 002476   000070 630400 5                  EPPR0   56
         4 002477   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002500   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002501   000000 011000                    NOP     0

      905    17050    2   SUBSTR (RECON_PROMPT,20,8) = OUT$SYM.TEXT;

  17050  4 002502   200007 470500                    LDP0    BLK$,,AUTO
         4 002503   000004 236100                    LDQ     4,,PR0
         4 002504   000033 772000                    QRL     27
         4 002505   000000 620006                    EAX0    0,QL
         4 002506   040000 100540                    MLR     fill='040'O
         4 002507   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002510   000176 000010 2                  ADSC9   RECON_PROMPT+5           cn=0,n=8

      906    17051    2   CALL ASB$SET_PROMPT ( %PROMPT_GENERAL, RECON_PROMPT, SIZEC(RECON_PROMPT) );

  17051  4 002511   000073 630400 5                  EPPR0   59
         4 002512   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002513   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 002514   000000 011000                    NOP     0

      907    17052    2   CALL ASB$READ_SI (IN_BUF, I);

  17052  4 002515   200024 630500                    EPPR0   I,,AUTO
         4 002516   200121 450500                    STP0    I+3,,AUTO
         4 002517   000016 236000 5                  LDQ     14
         4 002520   200120 756100                    STQ     I+2,,AUTO
         4 002521   200120 630500                    EPPR0   I+2,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:184  
         4 002522   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002523   000000 701000 xent               TSX1    ASB$READ_SI
         4 002524   000000 011000                    NOP     0

      908    17053    2   IF ( (I ~= 4) OR

  17053  4 002525   200024 235100                    LDA     I,,AUTO
         4 002526   000004 115007                    CMPA    4,DL
         4 002527   002535 601000 4                  TNZ     s:17057
         4 002530   000000 236000 xsym               LDQ     IN_BUF
         4 002531   000047 116000 3                  CMPQ    SIZEC_DREC+39
         4 002532   002574 600000 4                  TZE     s:17062
         4 002533   000050 116000 3                  CMPQ    SIZEC_DREC+40
         4 002534   002574 600000 4                  TZE     s:17062

      909    17054    2        (SUBSTR (IN_BUF, 0, 4) ~= 'YES$') AND
      910    17055    2        (SUBSTR (IN_BUF, 0, 4) ~= 'yes$') )
      911    17056    3   THEN DO;

      912    17057    3      CALL CONCAT (LINE,PART5,OUT$SYM.TEXT,PART6);

  17057  4 002535   200007 470500                    LDP0    BLK$,,AUTO
         4 002536   000004 236100                    LDQ     4,,PR0
         4 002537   000033 772000                    QRL     27
         4 002540   040100 100400                    MLR     fill='040'O
         4 002541   000237 000052 2                  ADSC9   PART5                    cn=0,n=42
         4 002542   200051 000052                    ADSC9   LINE,,AUTO               cn=0,n=42
         4 002543   000000 620006                    EAX0    0,QL
         4 002544   040100 100540                    MLR     fill='040'O
         4 002545   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002546   200063 400046                    ADSC9   PTR$+1,,AUTO             cn=2,n=38
         4 002547   000046 116007                    CMPQ    38,DL
         4 002550   002556 603000 4                  TRC     s:17058
         4 002551   777731 620006                    EAX0    -39,QL
         4 002552   777777 660003                    ERX0    -1,DU
         4 002553   040146 100400                    MLR     fill='040'O
         4 002554   000252 000013 2                  ADSC9   PART6                    cn=0,n=11
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:185  
         4 002555   200063 400010                    ADSC9   PTR$+1,Q,AUTO            cn=2,n=*X0

      913    17058    3      CALL ASB$WRITE_LO (LINE, SIZEC (LINE));

  17058  4 002556   000067 236000 5                  LDQ     55
         4 002557   200121 756100                    STQ     I+3,,AUTO
         4 002560   200051 631500                    EPPR1   LINE,,AUTO
         4 002561   200120 451500                    STP1    I+2,,AUTO
         4 002562   200120 630500                    EPPR0   I+2,,AUTO
         4 002563   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002564   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002565   000000 011000                    NOP     0

      914    17059    3      CALL ASB$SET_PROMPT ( %PROMPT_RESTORE );

  17059  4 002566   000032 630400 5                  EPPR0   26
         4 002567   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002570   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 002571   000000 011000                    NOP     0

      915    17060    3      RETURN;

  17060  4 002572   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 002573   000001 702211                    TSX2  ! 1,X1

      916    17061    3      END;
      917    17062    2   CALL ASB$SET_PROMPT ( %PROMPT_RESTORE );

  17062  4 002574   000032 630400 5                  EPPR0   26
         4 002575   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002576   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 002577   000000 011000                    NOP     0

      918    17063
      919    17064        /* Delete station local */
      920    17065
      921    17066    2   CALL CONCAT (IN_BUF,REM_STA,OUT$SYM.TEXT);
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:186  

  17066  4 002600   200007 470500                    LDP0    BLK$,,AUTO
         4 002601   000004 236100                    LDQ     4,,PR0
         4 002602   000033 772000                    QRL     27
         4 002603   040000 100400                    MLR     fill='040'O
         4 002604   000164 000014 2                  ADSC9   REM_STA                  cn=0,n=12
         4 002605   000000 000014 xsym               ADSC9   IN_BUF                   cn=0,n=12
         4 002606   000000 620006                    EAX0    0,QL
         4 002607   040000 100540                    MLR     fill='040'O
         4 002610   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002611   000003 000363 xsym               ADSC9   IN_BUF+3                 cn=0,n=243

      922    17067    2   P_PCB.NCHARS = SIZEC (REM_STA) + OUT$SYM.COUNT;

  17067  4 002612   200007 470500                    LDP0    BLK$,,AUTO
         4 002613   000004 236100                    LDQ     4,,PR0
         4 002614   000033 772000                    QRL     27
         4 002615   000014 036007                    ADLQ    12,DL
         4 002616   000011 756000 xsym               STQ     P_PCB+9

      923    17068    2   CALL X$PARSE (P_PCB);

  17068  4 002617   000017 630400 5                  EPPR0   15
         4 002620   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002621   000000 701000 xent               TSX1    X$PARSE
         4 002622   000000 011000                    NOP     0

      924    17069    2   NODE$ = P_PCB.OUT$;

  17069  4 002623   000003 236000 xsym               LDQ     P_PCB+3
         4 002624   000000 756000 xsym               STQ     NODE$

      925    17070    2   CODE = P$NODE.CODE;

  17070  4 002625   000000 470400 xsym               LDP0    NODE$
         4 002626   000000 236100                    LDQ     0,,PR0
         4 002627   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:187  
         4 002630   000000 756000 xsym               STQ     CODE

      926    17071    2   CALL ASR$R_STAT_TIGR;

  17071  4 002631   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002632   000000 701000 xent               TSX1    ASR$R_STAT_TIGR
         4 002633   000000 011000                    NOP     0

      927    17072
      928    17073        /* Remove wsn local */
      929    17074
      930    17075    2   CALL CONCAT (IN_BUF,REM_WSN,OUT$SYM.TEXT);

  17075  4 002634   200007 470500                    LDP0    BLK$,,AUTO
         4 002635   000004 236100                    LDQ     4,,PR0
         4 002636   000033 772000                    QRL     27
         4 002637   040000 100400                    MLR     fill='040'O
         4 002640   000167 000010 2                  ADSC9   REM_WSN                  cn=0,n=8
         4 002641   000000 000010 xsym               ADSC9   IN_BUF                   cn=0,n=8
         4 002642   000000 620006                    EAX0    0,QL
         4 002643   040000 100540                    MLR     fill='040'O
         4 002644   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002645   000002 000367 xsym               ADSC9   IN_BUF+2                 cn=0,n=247

      931    17076    2   P_PCB.NCHARS = SIZEC (REM_WSN) + OUT$SYM.COUNT;

  17076  4 002646   200007 470500                    LDP0    BLK$,,AUTO
         4 002647   000004 236100                    LDQ     4,,PR0
         4 002650   000033 772000                    QRL     27
         4 002651   000010 036007                    ADLQ    8,DL
         4 002652   000011 756000 xsym               STQ     P_PCB+9

      932    17077    2   CALL X$PARSE (P_PCB);

  17077  4 002653   000017 630400 5                  EPPR0   15
         4 002654   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002655   000000 701000 xent               TSX1    X$PARSE
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:188  
         4 002656   000000 011000                    NOP     0

      933    17078    2   NODE$ = P_PCB.OUT$;

  17078  4 002657   000003 236000 xsym               LDQ     P_PCB+3
         4 002660   000000 756000 xsym               STQ     NODE$

      934    17079    2   CODE = P$NODE.CODE;

  17079  4 002661   000000 470400 xsym               LDP0    NODE$
         4 002662   000000 236100                    LDQ     0,,PR0
         4 002663   777777 376007                    ANQ     -1,DL
         4 002664   000000 756000 xsym               STQ     CODE

      935    17080    2   CALL ASR$R_WSN;

  17080  4 002665   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002666   000000 701000 xent               TSX1    ASR$R_WSN
         4 002667   000000 011000                    NOP     0

      936    17081
      937    17082        /* Close hlp before calling ASC$CONFIG or it will altreturn. */
      938    17083
      939    17084    2   CALL ASB$CLOSE_HLP;

  17084  4 002670   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002671   000000 701000 xent               TSX1    ASB$CLOSE_HLP
         4 002672   000000 011000                    NOP     0

      940    17085
      941    17086        /* Do the reconfiguration */
      942    17087
      943    17088    2   CALL ASC$CONFIG (WSN_INDEX) WHENALTRETURN

  17088  4 002673   200075 630500                    EPPR0   WSN_INDEX,,AUTO
         4 002674   200120 450500                    STP0    I+2,,AUTO
         4 002675   200120 630500                    EPPR0   I+2,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:189  
         4 002676   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002677   000000 701000 xent               TSX1    ASC$CONFIG
         4 002700   002702 702000 4                  TSX2    s:17090
         4 002701   002721 710000 4                  TRA     s:17112

      944    17089    3   DO;

      945    17090    3      AS_FIELD1.COUNT = OUT$SYM.COUNT;

  17090  4 002702   200007 470500                    LDP0    BLK$,,AUTO
         4 002703   000004 236100                    LDQ     4,,PR0
         4 002704   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      946    17091    3      AS_FIELD1.TEXT = OUT$SYM.TEXT;

  17091  4 002705   000004 236100                    LDQ     4,,PR0
         4 002706   000033 772000                    QRL     27
         4 002707   000000 620006                    EAX0    0,QL
         4 002710   040000 100540                    MLR     fill='040'O
         4 002711   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002712   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      947    17092           %SCREAM (ERR# = E$CONFIG_FAIL, LEVEL = ERROR, MID = 'A');

  17104  4 002713   000004 630400 5                  EPPR0   4
         4 002714   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002715   000000 701000 xent               TSX1    ASH$ERROR
         4 002716   000000 011000                    NOP     0

      948    17107    3      RETURN;

  17107  4 002717   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 002720   000001 702211                    TSX2  ! 1,X1

      949    17108    3      END; /*  Whenaltreturn  */
      950    17109
      951    17110        /* Clean up */
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:190  
      952    17111
      953    17112    2   CALL ASB$OPEN_HLP_UP;

  17112  4 002721   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002722   000000 701000 xent               TSX1    ASB$OPEN_HLP_UP
         4 002723   000000 011000                    NOP     0

      954    17113    2   CALL ASB$WRITE_LO (' ',1);

  17113  4 002724   000070 630400 5                  EPPR0   56
         4 002725   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002726   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002727   000000 011000                    NOP     0

      955    17114    2   CALL CONCAT (LINE,PART7,OUT$SYM.TEXT,PART8);

  17114  4 002730   200007 470500                    LDP0    BLK$,,AUTO
         4 002731   000004 236100                    LDQ     4,,PR0
         4 002732   000033 772000                    QRL     27
         4 002733   040100 100400                    MLR     fill='040'O
         4 002734   000255 000010 2                  ADSC9   PART7                    cn=0,n=8
         4 002735   200051 000010                    ADSC9   LINE,,AUTO               cn=0,n=8
         4 002736   000000 620006                    EAX0    0,QL
         4 002737   040100 100540                    MLR     fill='040'O
         4 002740   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002741   200053 000110                    ADSC9   PROJ_ADMIN_KEY+1,,AUTO   cn=0,n=72
         4 002742   000110 116007                    CMPQ    72,DL
         4 002743   002751 603000 4                  TRC     s:17115
         4 002744   777667 620006                    EAX0    -73,QL
         4 002745   777777 660003                    ERX0    -1,DU
         4 002746   040146 100400                    MLR     fill='040'O
         4 002747   000257 000024 2                  ADSC9   PART8                    cn=0,n=20
         4 002750   200053 000010                    ADSC9   PROJ_ADMIN_KEY+1,Q,AUTO  cn=0,n=*X0

      956    17115    2   CALL ASB$WRITE_LO (LINE, SIZEC (LINE));

  17115  4 002751   000067 236000 5                  LDQ     55
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:191  
         4 002752   200121 756100                    STQ     I+3,,AUTO
         4 002753   200051 631500                    EPPR1   LINE,,AUTO
         4 002754   200120 451500                    STP1    I+2,,AUTO
         4 002755   200120 630500                    EPPR0   I+2,,AUTO
         4 002756   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002757   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002760   000000 011000                    NOP     0

      957    17116    2   CALL CONCAT (LINE,PART9,OUT$SYM.TEXT,PART10);

  17116  4 002761   200007 470500                    LDP0    BLK$,,AUTO
         4 002762   000004 236100                    LDQ     4,,PR0
         4 002763   000033 772000                    QRL     27
         4 002764   000000 620006                    EAX0    0,QL
         4 002765   000264 236000 2                  LDQ     PART9
         4 002766   200051 756100                    STQ     LINE,,AUTO
         4 002767   040100 100540                    MLR     fill='040'O
         4 002770   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002771   200052 000114                    ADSC9   @CODE+1,,AUTO            cn=0,n=76
         4 002772   000000 636010                    EAQ     0,X0
         4 002773   000022 772000                    QRL     18
         4 002774   000114 116007                    CMPQ    76,DL
         4 002775   003006 603000 4                  TRC     s:17117
         4 002776   200120 740100                    STX0    I+2,,AUTO
         4 002777   777663 620010                    EAX0    -77,X0
         4 003000   777777 660003                    ERX0    -1,DU
         4 003001   200120 235100                    LDA     I+2,,AUTO
         4 003002   000022 771000                    ARL     18
         4 003003   040145 100400                    MLR     fill='040'O
         4 003004   000265 000051 2                  ADSC9   PART10                   cn=0,n=41
         4 003005   200052 000010                    ADSC9   @CODE+1,A,AUTO           cn=0,n=*X0

      958    17117    2   CALL ASB$WRITE_LO (LINE, SIZEC (LINE));

  17117  4 003006   000067 236000 5                  LDQ     55
         4 003007   200121 756100                    STQ     I+3,,AUTO
         4 003010   200051 631500                    EPPR1   LINE,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:192  
         4 003011   200120 451500                    STP1    I+2,,AUTO
         4 003012   200120 630500                    EPPR0   I+2,,AUTO
         4 003013   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003014   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 003015   000000 011000                    NOP     0

      959    17118
      960    17119    2   RETURN;

  17119  4 003016   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 003017   000001 702211                    TSX2  ! 1,X1

      961    17120    2   END RECONFIG_TIGR_STATION;
      962    17121        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:193  
      963    17122    1   CREATE_MOD_USER: PROC ;

  17122  4 003020   200050 741300       CREATE_MOD_* STX1  ! FREE_SEG_TYPE+1,,AUTO

      964    17123
      965    17124        /********************************************************************/
      966    17125        /*   Auto data       auto data       auto data       auto data       */
      967    17126        /*********************************************************************/
      968    17127
      969    17128    2   DCL 1 CR_MOD_KEY ,
      970    17129    2          2 CNT UBIN(9) UNAL ,
      971    17130    2          2 TEXT CHAR(21) UNAL ;
      972    17131    2   DCL I SBIN ;
      973    17132    2   DCL J SBIN ;
      974    17133    2   DCL K SBIN ;
      975    17134    2   DCL PTR$ PTR ;
      976    17135    2   DCL PAR$ PTR ;
      977    17136    2   DCL PROJ_ACCT_LIST$ PTR ;
      978    17137    2   DCL CREATE BIT(1) ;
      979    17138    2   DCL PROJ_FLAG BIT(1) ALIGNED;
      980    17139    2   DCL TYPE UBIN WORD ;
      981    17140    2   DCL COUNT UBIN WORD ;
      982    17141    2   DCL PACKSET_COUNT SBIN;
      983    17142    2   DCL ACCT_COUNT SBIN;
      984    17143
      985    17144        /********************************************************************/
      986    17145        /*   Based data      based data      based data      based data      */
      987    17146        /*********************************************************************/
      988    17147
      989    17148        %AS$PROJ_HEADER( NAME="PACKSET$LIST(0:0)" , STCLASS="BASED(DSEG1$)", LAST="," );
      990    17177    2          2 PSN CHAR(8);
      991    17178        %AS$PROJ( STCLASS="BASED(DSEG2$)" );
      992    17212        %AS$PROJ_HEADER( STCLASS="BASED(DSEG2$)" );
      993    17241        %AS$PROJ_ACCT_LIST( NAME=PROJ$LIST, STCLASS="BASED(PROJ_ACCT_LIST$)" );
      994    17246    2   DCL 1 ACCT$LIST(0:0) ALIGNED BASED(DSEG1$),
      995    17247    2          2 PSN CHAR(6),
      996    17248    2          2 ACCT CHAR(8),
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:194  
      997    17249    2          2 GRANS UBIN;
      998    17250
      999    17251        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:195  
     1000    17252        /********************************************************************/
     1001    17253        /*   Procedure       procedure       procedure       procedure       */
     1002    17254        /*********************************************************************/
     1003    17255
     1004    17256    2   PROJ_FLAG = AS_FALSE;

  17256  4 003021   000000 236000 xsym               LDQ     AS_FALSE
         4 003022   400000 376003                    ANQ     -131072,DU
         4 003023   200066 756100                    STQ     PROJ_FLAG,,AUTO

     1005    17257    2   CALL PARSE_CMD( CR_MOD_CMD ) ALTRET(EXIT#);

  17257  4 003024   000076 236000 5                  LDQ     62
         4 003025   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 003026   007264 701000 4                  TSX1    PARSE_CMD
         4 003027   003647 702000 4                  TSX2    EXIT#

     1006    17258    2   IF AS_PROJECT_ADMIN = AS_NONE THEN

  17258  4 003030   000000 106400                    CMPC    fill='000'O
         4 003031   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 003032   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 003033   003036 601000 4                  TNZ     s:17262

     1007    17259    2      AS_CR_MOD_PROJ = 0;

  17259  4 003034   000000 450000 xsym               STZ     AS_CR_MOD_PROJ
         4 003035   003061 710000 4                  TRA     s:17269

     1008    17260    3   ELSE DO;

     1009    17261                                                   /* Project administrator */
     1010    17262    3      AS_CR_MOD_PROJ = %CR_PROJ_USER;  /* is creating the user */

  17262  4 003036   000001 235007                    LDA     1,DL
         4 003037   000000 755000 xsym               STA     AS_CR_MOD_PROJ

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:196  
     1011    17263                                         /* Read default record for project */
     1012    17264    3      CALL CONCAT( USERS_KEY.TXTC, AS_PROJECT_ADMIN.TEXT, 'S' );

  17264  4 003040   040000 100400                    MLR     fill='040'O
         4 003041   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 003042   000000 200024 xsym               ADSC9   USERS_KEY                cn=1,n=20
         4 003043   040000 100400                    MLR     fill='040'O
         4 003044   000077 000001 5                  ADSC9   63                       cn=0,n=1
         4 003045   000005 200025 xsym               ADSC9   USERS_KEY+5              cn=1,n=21

     1013    17265    3      USERS_KEY.COUNT = 21;

  17265  4 003046   025000 236003                    LDQ     10752,DU
         4 003047   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1014    17266    3      CALL ASB$GET(AS_FALSE, , AS_DFLT, KL_DFLT$) ALTRET(EXIT#);

  17266  4 003050   000100 237000 5                  LDAQ    64
         4 003051   200122 757100                    STAQ    I+4,,AUTO
         4 003052   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 003053   000035 235000 5                  LDA     29
         4 003054   200120 757100                    STAQ    I+2,,AUTO
         4 003055   200120 630500                    EPPR0   I+2,,AUTO
         4 003056   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003057   000000 701000 xent               TSX1    ASB$GET
         4 003060   003647 702000 4                  TSX2    EXIT#

     1015    17267    3      END;

     1016    17268
     1017    17269    2   PAR$ = P$NODE.SUBLK$(1) ;

  17269  4 003061   000000 470400 xsym               LDP0    NODE$
         4 003062   000004 236100                    LDQ     4,,PR0
         4 003063   200063 756100                    STQ     PAR$,,AUTO

     1018    17270    2   CALL ASB$KEYMAKER(CR_MOD_KEY,PAR$->P$NODE,PROJ_FLAG,TYPE) ALTRET(EXIT#) ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:197  

  17270  4 003064   200067 631500                    EPPR1   TYPE,,AUTO
         4 003065   200123 451500                    STP1    I+5,,AUTO
         4 003066   200066 633500                    EPPR3   PROJ_FLAG,,AUTO
         4 003067   200122 453500                    STP3    I+4,,AUTO
         4 003070   200121 756100                    STQ     I+3,,AUTO
         4 003071   200051 634500                    EPPR4   CR_MOD_KEY,,AUTO
         4 003072   200120 454500                    STP4    I+2,,AUTO
         4 003073   200120 630500                    EPPR0   I+2,,AUTO
         4 003074   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003075   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 003076   003647 702000 4                  TSX2    EXIT#

     1019    17271
     1020    17272                                                              /*   Create or modify
     1021    17273                                                                   an user.      */
     1022    17274    2   CALL INITIALIZATIONS  ALTRET(EXIT#);

  17274  4 003077   007326 701000 4                  TSX1    INITIALIZATIONS
         4 003100   003647 702000 4                  TSX2    EXIT#

     1023    17275    2   USERS_KEY = CR_MOD_KEY ;

  17275  4 003101   000000 100500                    MLR     fill='000'O
         4 003102   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 003103   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1024    17276    2   IF CREATE THEN CALL CHECK_CREATE_OK(AS_PROJECT_ADMIN) ALTRET(EXIT#);

  17276  4 003104   200065 234100                    SZN     CREATE,,AUTO
         4 003105   003113 605000 4                  TPL     s:17278

  17276  4 003106   000102 236000 5                  LDQ     66
         4 003107   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 003110   007430 701000 4                  TSX1    CHECK_CREATE_OK
         4 003111   003647 702000 4                  TSX2    EXIT#
         4 003112   003132 710000 4                  TRA     s:17284
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:198  

     1025    17277    2   ELSE                                    /* Modify */
     1026    17278    2      IF AS_WILD_USER THEN CALL GET_FIRST ALTRET(FINISHED);

  17278  4 003113   000000 234000 xsym               SZN     AS_WILD_USER
         4 003114   003120 605000 4                  TPL     s:17280

  17278  4 003115   007744 701000 4                  TSX1    GET_FIRST
         4 003116   003617 702000 4                  TSX2    FINISHED
         4 003117   003132 710000 4                  TRA     s:17284

     1027    17279    2      ELSE                                     /* Get specified user */
     1028    17280    2         CALL ASB$GET( PROJ_FLAG, TYPE, AS_USERS, KL_DREC$ ) ALTRET(EXIT#);

  17280  4 003120   000104 237000 5                  LDAQ    68
         4 003121   200122 757100                    STAQ    I+4,,AUTO
         4 003122   200067 630500                    EPPR0   TYPE,,AUTO
         4 003123   200121 450500                    STP0    I+3,,AUTO
         4 003124   200066 631500                    EPPR1   PROJ_FLAG,,AUTO
         4 003125   200120 451500                    STP1    I+2,,AUTO
         4 003126   200120 630500                    EPPR0   I+2,,AUTO
         4 003127   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003130   000000 701000 xent               TSX1    ASB$GET
         4 003131   003647 702000 4                  TSX2    EXIT#

     1029    17281
     1030    17282                                                     /*   Check to see if
     1031    17283                                                          from was input  */
     1032    17284    2   IF P$NODE.SUBNODES = 4

  17284  4 003132   000000 470400 xsym               LDP0    NODE$
         4 003133   000001 220100                    LDX0    1,,PR0
         4 003134   000004 100003                    CMPX0   4,DU
         4 003135   003212 601000 4                  TNZ     s:17302

     1033    17285    3   THEN DO;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:199  
     1034    17286                                                              /*   Yes.    */
     1035    17287    3      FROM_FLG = AS_TRUE ;

  17287  4 003136   000000 236000 xsym               LDQ     AS_TRUE
         4 003137   400000 376003                    ANQ     -131072,DU
         4 003140   000000 756000 xsym               STQ     FROM_FLG

     1036    17288    3      PAR$ = P$NODE.SUBLK$(2) ;

  17288  4 003141   000005 236100                    LDQ     5,,PR0
         4 003142   200063 756100                    STQ     PAR$,,AUTO

     1037    17289    3      CALL ASB$KEYMAKER(FROM_KEY,PAR$->P$NODE,PROJ_FLAG,21   /*  FROM_VAL */) ALTRET(
             17289               EXIT#) ;

  17289  4 003143   000107 236000 5                  LDQ     71
         4 003144   200123 756100                    STQ     I+5,,AUTO
         4 003145   200066 631500                    EPPR1   PROJ_FLAG,,AUTO
         4 003146   200122 451500                    STP1    I+4,,AUTO
         4 003147   200063 236100                    LDQ     PAR$,,AUTO
         4 003150   000110 235000 5                  LDA     72
         4 003151   200120 757100                    STAQ    I+2,,AUTO
         4 003152   200120 630500                    EPPR0   I+2,,AUTO
         4 003153   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003154   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 003155   003647 702000 4                  TSX2    EXIT#

     1038    17290                                           /*   From default or an account. */
     1039    17291    3      USERS_KEY = FROM_KEY ;

  17291  4 003156   000000 100400                    MLR     fill='000'O
         4 003157   000000 000025 xsym               ADSC9   FROM_KEY                 cn=0,n=21
         4 003160   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1040    17292    3      IF AS_CR_MOD_PROJ = %CR_PROJ_USER  AND  FROM_KEY.TEXT = 'DEFAULT'

  17292  4 003161   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:200  
         4 003162   000001 115007                    CMPA    1,DL
         4 003163   003177 601000 4                  TNZ     s:17298
         4 003164   040000 106400                    CMPC    fill='040'O
         4 003165   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20
         4 003166   000124 000007 3                  ADSC9   SIZEC_DREC+84            cn=0,n=7
         4 003167   003177 601000 4                  TNZ     s:17298

     1041    17293    4      THEN DO;

     1042    17294    4         AS_USERS = AS_DFLT ;

  17294  4 003170   000000 100400                    MLR     fill='000'O
         4 003171   000000 004020 xsym               ADSC9   AS_DFLT                  cn=0,n=2064
         4 003172   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064

     1043    17295    4         KL_DREC  = KL_DFLT ;

  17295  4 003173   000000 100400                    MLR     fill='000'O
         4 003174   000000 001244 xsym               ADSC9   KL_DFLT                  cn=0,n=676
         4 003175   000000 001244 xsym               ADSC9   KL_DREC                  cn=0,n=676

     1044    17296    4         END;

  17296  4 003176   003267 710000 4                  TRA     s:17325

     1045    17297    4      ELSE DO;

     1046    17298    4         CALL ASB$GET( PROJ_FLAG, , AS_USERS, KL_DREC$ ) ALTRET(EXIT#);

  17298  4 003177   000104 237000 5                  LDAQ    68
         4 003200   200122 757100                    STAQ    I+4,,AUTO
         4 003201   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 003202   200121 756100                    STQ     I+3,,AUTO
         4 003203   200066 630500                    EPPR0   PROJ_FLAG,,AUTO
         4 003204   200120 450500                    STP0    I+2,,AUTO
         4 003205   200120 630500                    EPPR0   I+2,,AUTO
         4 003206   000022 631400 xsym               EPPR1   B_VECTNIL+18
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:201  
         4 003207   000000 701000 xent               TSX1    ASB$GET
         4 003210   003647 702000 4                  TSX2    EXIT#

     1047    17299    4         END;    /* Else do */

     1048    17300    3      END;        /*Then do */

  17300  4 003211   003267 710000 4                  TRA     s:17325

     1049    17301    3   ELSE DO;                             /*   Default implied.    */

     1050    17302    3      FROM_FLG = '0'B;

  17302  4 003212   000000 450000 xsym               STZ     FROM_FLG

     1051    17303    4      IF CREATE THEN DO;

  17303  4 003213   200065 234100                    SZN     CREATE,,AUTO
         4 003214   003267 605000 4                  TPL     s:17325

     1052    17304    4         IF AS_CR_MOD_PROJ = %CR_PROJ_USER

  17304  4 003215   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 003216   000001 115007                    CMPA    1,DL
         4 003217   003227 601000 4                  TNZ     s:17310

     1053    17305    5         THEN DO;

     1054    17306    5            AS_USERS = AS_DFLT;

  17306  4 003220   000000 100400                    MLR     fill='000'O
         4 003221   000000 004020 xsym               ADSC9   AS_DFLT                  cn=0,n=2064
         4 003222   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064

     1055    17307    5            KL_DREC  = KL_DFLT;

  17307  4 003223   000000 100400                    MLR     fill='000'O
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:202  
         4 003224   000000 001244 xsym               ADSC9   KL_DFLT                  cn=0,n=676
         4 003225   000000 001244 xsym               ADSC9   KL_DREC                  cn=0,n=676

     1056    17308    5            END;

  17308  4 003226   003267 710000 4                  TRA     s:17325

     1057    17309    5         ELSE DO;

     1058    17310    6            IF (SUBSTR(CR_MOD_KEY.TEXT,0,20)) = 'DEFAULT' THEN DO;

  17310  4 003227   040000 106500                    CMPC    fill='040'O
         4 003230   200051 200024                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=20
         4 003231   000124 000007 3                  ADSC9   SIZEC_DREC+84            cn=0,n=7
         4 003232   003245 601000 4                  TNZ     s:17316

     1059    17311    6               AS_USERS = AS_USERS_CONSTANT;

  17311  4 003233   000000 100400                    MLR     fill='000'O
         4 003234   000000 004020 xsym               ADSC9   AS_USERS_CONSTANT        cn=0,n=2064
         4 003235   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064

     1060    17312    6               KL_DREC  = KL_DEFAULT;

  17312  4 003236   000000 100400                    MLR     fill='000'O
         4 003237   000000 000554 xsym               ADSC9   KL_DEFAULT               cn=0,n=364
         4 003240   000000 001244 xsym               ADSC9   KL_DREC                  cn=0,n=676

     1061    17313    6               KL_DREC.PASSWORD = BLANK_PASS;

  17313  4 003241   040000 100400                    MLR     fill='040'O
         4 003242   000000 000010 xsym               ADSC9   BLANK_PASS               cn=0,n=8
         4 003243   000002 000010 xsym               ADSC9   KL_DREC+2                cn=0,n=8

     1062    17314    6               END;

  17314  4 003244   003267 710000 4                  TRA     s:17325
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:203  

     1063    17315    6            ELSE DO;

     1064    17316    6               FROM_KEY.CNT = 7 ;

  17316  4 003245   007000 236003                    LDQ     3584,DU
         4 003246   000000 552040 xsym               STBQ    FROM_KEY,'40'O

     1065    17317    6               FROM_KEY.TEXT = 'DEFAULT' ;

  17317  4 003247   040000 100400                    MLR     fill='040'O
         4 003250   000124 000007 3                  ADSC9   SIZEC_DREC+84            cn=0,n=7
         4 003251   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20

     1066    17318    6               USERS_KEY = FROM_KEY ;

  17318  4 003252   000000 100400                    MLR     fill='000'O
         4 003253   000000 000025 xsym               ADSC9   FROM_KEY                 cn=0,n=21
         4 003254   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1067    17319    6               CALL ASB$GET( PROJ_FLAG,,AS_USERS, KL_DREC$) ALTRET(EXIT#);

  17319  4 003255   000104 237000 5                  LDAQ    68
         4 003256   200122 757100                    STAQ    I+4,,AUTO
         4 003257   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 003260   200121 756100                    STQ     I+3,,AUTO
         4 003261   200066 631500                    EPPR1   PROJ_FLAG,,AUTO
         4 003262   200120 451500                    STP1    I+2,,AUTO
         4 003263   200120 630500                    EPPR0   I+2,,AUTO
         4 003264   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003265   000000 701000 xent               TSX1    ASB$GET
         4 003266   003647 702000 4                  TSX2    EXIT#

     1068    17320    6               END;     /* Else do */

     1069    17321    5            END;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:204  
     1070    17322    4         END ;   /* Then do */

     1071    17323    3      END ;   /* Else do */

     1072    17324
     1073    17325    3   IF AS_CR_MOD_PROJ = %CR_PROJ_USER AND FROM_FLG THEN DO;

  17325  4 003267   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 003270   000001 115007                    CMPA    1,DL
         4 003271   003304 601000 4                  TNZ     s:17329
         4 003272   000000 234000 xsym               SZN     FROM_FLG
         4 003273   003304 605000 4                  TPL     s:17329

     1074    17326    3      CALL COMPARE_FROM_TO_MAX( AS_USERS, KL_DREC, AS_DFLT, KL_DFLT );

  17326  4 003274   000111 236000 5                  LDQ     73
         4 003275   200100 756100                    STQ     @MAX_USERS+1,,AUTO
         4 003276   000112 237000 5                  LDAQ    74
         4 003277   200076 757100                    STAQ    @FROM_USERS+1,,AUTO
         4 003300   000104 236000 5                  LDQ     68
         4 003301   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 003302   012364 701000 4                  TSX1    COMPARE_FROM_TO_MAX
         4 003303   000000 011000                    NOP     0

     1075    17327    3      END;

     1076    17328
     1077    17329    2   USERS_KEY = CR_MOD_KEY ;

  17329  4 003304   000000 100500                    MLR     fill='000'O
         4 003305   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 003306   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1078    17330    3   IF CREATE OR FROM_FLG THEN DO;

  17330  4 003307   200065 234100                    SZN     CREATE,,AUTO
         4 003310   003313 604000 4                  TMI     s:17331
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:205  
         4 003311   000000 234000 xsym               SZN     FROM_FLG
         4 003312   003324 605000 4                  TPL     GET_USER_OPTIONS

     1079    17331    3      AS_USERS.ACCT = SUBSTR( CR_MOD_KEY.TEXT, 0, 8 );

  17331  4 003313   040000 100500                    MLR     fill='040'O
         4 003314   200051 200010                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=8
         4 003315   000000 000010 xsym               ADSC9   AS_USERS                 cn=0,n=8

     1080    17332    3      AS_USERS.NAME = SUBSTR( CR_MOD_KEY.TEXT, 8, 12 );

  17332  4 003316   040000 100500                    MLR     fill='040'O
         4 003317   200053 200014                    ADSC9   PROJ_ADMIN_KEY+1,,AUTO   cn=1,n=12
         4 003320   000002 000014 xsym               ADSC9   AS_USERS+2               cn=0,n=12

     1081    17333    3      AS_USERS.BUDGET.MACCT = AS_PROJECT_ADMIN;

  17333  4 003321   000000 100400                    MLR     fill='000'O
         4 003322   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 003323   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21

     1082    17334    3      END;

  17330  4 003324                       GET_USER_OP* null
     1083    17335
     1084    17336    2   GET_USER_OPTIONS:;                               /*   Do options    */
     1085    17337
     1086    17338    2   IF NOT CREATE AND NOT FROM_FLG THEN

  17338  4 003324   200065 234100                    SZN     CREATE,,AUTO
         4 003325   003331 604000 4                  TMI     s:17342
         4 003326   000000 234000 xsym               SZN     FROM_FLG
         4 003327   003331 604000 4                  TMI     s:17342

     1087    17339         /*  do nothing  */
     1088    17340    3   DO; END;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:206  
  17340  4 003330   003335 710000 4                  TRA     s:17345

     1089    17341    3   ELSE DO;

     1090    17342    3      AS_USERS.LAST_LOGON_TIME = '0'B;

  17342  4 003331   000762 450000 xsym               STZ     AS_USERS+498

     1091    17343    3      AS_USERS.LOGINS = '0'B;

  17343  4 003332   000000 100400                    MLR     fill='000'O
         4 003333   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 003334   000764 000040 xsym               ADSC9   AS_USERS+500             cn=0,n=32

     1092    17344    3      END;

     1093    17345    2   AS_MOD_USER = '0'B;

  17345  4 003335   003000 060400                    CSL     bolr='003'O
         4 003336   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         4 003337   000000 002713 xsym               BDSC    AS_MOD_USER              by=0,bit=0,n=1483

     1094    17346    2   CALL ASC$CM_OPTS (CR_MOD_KEY) ;

  17346  4 003340   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 003341   200120 450500                    STP0    I+2,,AUTO
         4 003342   200120 630500                    EPPR0   I+2,,AUTO
         4 003343   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003344   000000 701000 xent               TSX1    ASC$CM_OPTS
         4 003345   000000 011000                    NOP     0

     1095    17347                                                        /*   Write out users
     1096    17348                                                             records    */
     1097    17349    2   USERS_KEY = CR_MOD_KEY;

  17349  4 003346   000000 100500                    MLR     fill='000'O
         4 003347   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:207  
         4 003350   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1098    17350    2   IF CREATE AND AS_CR_MOD_PROJ > 0 THEN

  17350  4 003351   200065 234100                    SZN     CREATE,,AUTO
         4 003352   003361 605000 4                  TPL     s:17353
         4 003353   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 003354   003361 604400 4                  TMOZ    s:17353

     1099    17351    2      CALL ASB$ACCT_OK( USERS_KEY.UKEY.ACCT, AS_USERS.HPSN,

  17351  4 003355   000114 630400 5                  EPPR0   76
         4 003356   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003357   000000 701000 xent               TSX1    ASB$ACCT_OK
         4 003360   003647 702000 4                  TSX2    EXIT#

     1100    17352    2           AS_PROJECT_ADMIN, AS_FALSE ) ALTRET(EXIT#);
     1101    17353    2   CALL ASB$WRITE_USERS( AS_USERS );

  17353  4 003361   000104 630400 5                  EPPR0   68
         4 003362   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003363   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 003364   000000 011000                    NOP     0

     1102    17354    2   IF KL_DREC.KL_DREC_FEBLK.RESL_CNT = 0

  17354  4 003365   000130 220000 xsym               LDX0    KL_DREC+88
         4 003366   003372 601000 4                  TNZ     s:17358

     1103    17355    2   THEN
     1104    17356    2      KL_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) ;

  17356  4 003367   000113 235007                    LDA     75,DL
         4 003370   000017 755000 xsym               STA     KL_DREC+15
         4 003371   003376 710000 4                  TRA     s:17360

     1105    17357    2   ELSE
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:208  
     1106    17358    2      KL_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) +

  17358  4 003372   000130 235000 xsym               LDA     KL_DREC+88
         4 003373   000022 771000                    ARL     18
         4 003374   000112 035007                    ADLA    74,DL
         4 003375   000017 755000 xsym               STA     KL_DREC+15

     1107    17359    2           KL_DREC.KL_DREC_FEBLK.RESL_CNT - 1    ;
     1108    17360    2   ARS = SIZEC_DREC + ( KL_DREC.NWINFO * 4 ) ;

  17360  4 003376   000017 236000 xsym               LDQ     KL_DREC+15
         4 003377   000002 736000                    QLS     2
         4 003400   000000 036000 3                  ADLQ    SIZEC_DREC
         4 003401   200003 756100                    STQ     ARS,,AUTO

     1109    17361    2   CALL ASB$WRITE_HLP( KL_DREC$, ARS );

  17361  4 003402   200003 630500                    EPPR0   ARS,,AUTO
         4 003403   200121 450500                    STP0    I+3,,AUTO
         4 003404   000105 236000 5                  LDQ     69
         4 003405   200120 756100                    STQ     I+2,,AUTO
         4 003406   200120 630500                    EPPR0   I+2,,AUTO
         4 003407   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003410   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 003411   000000 011000                    NOP     0

     1110    17362    3   IF AS_CR_MOD_PROJ = %CR_PROJ_USER AND CREATE THEN DO;

  17362  4 003412   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 003413   000001 115007                    CMPA    1,DL
         4 003414   003467 601000 4                  TNZ     s:17398
         4 003415   200065 234100                    SZN     CREATE,,AUTO
         4 003416   003467 605000 4                  TPL     s:17398

     1111    17363                                       /* Increment number of users created */
     1112    17364    3      AS_DFLT.BUDGET.PROJ_CREATED = AS_DFLT.BUDGET.PROJ_CREATED + 1;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:209  
  17364  4 003417   000011 054000 xsym               AOS     AS_DFLT+9

     1113    17365    3      CALL CONCAT( USERS_KEY.TXTC, AS_PROJECT_ADMIN.TEXT, 'S' );

  17365  4 003420   040000 100400                    MLR     fill='040'O
         4 003421   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 003422   000000 200024 xsym               ADSC9   USERS_KEY                cn=1,n=20
         4 003423   040000 100400                    MLR     fill='040'O
         4 003424   000077 000001 5                  ADSC9   63                       cn=0,n=1
         4 003425   000005 200025 xsym               ADSC9   USERS_KEY+5              cn=1,n=21

     1114    17366    3      USERS_KEY.COUNT = 21;

  17366  4 003426   025000 236003                    LDQ     10752,DU
         4 003427   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1115    17367    3      CALL ASB$WRITE_USERS( AS_DFLT );

  17367  4 003430   000100 630400 5                  EPPR0   64
         4 003431   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003432   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 003433   000000 011000                    NOP     0

     1116    17368    3      IF AS_DFLT.BUDGET.PROJ_CREATED = AS_DFLT.BUDGET.PROJ_ALLOWED

  17368  4 003434   000011 236000 xsym               LDQ     AS_DFLT+9
         4 003435   000010 116000 xsym               CMPQ    AS_DFLT+8
         4 003436   003447 601000 4                  TNZ     s:17392

     1117    17369    4      THEN DO;

     1118    17370        /*E* ERROR:   ASA-E$MAX_PROJ_USERS-C
     1119    17371        MESSAGE: The maximum number of users allowed for project "%U1" have
     1120    17372                 now been created.
     1121    17373        */
     1122    17374    4         CALL ASA$KEYCONV( AS_PROJECT_ADMIN, AS_FIELD1 );

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:210  
  17374  4 003437   000102 630400 5                  EPPR0   66
         4 003440   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003441   000000 701000 xent               TSX1    ASA$KEYCONV
         4 003442   000000 011000                    NOP     0

     1123    17375              %SCREAM( ERR#=E$MAX_PROJ_USERS, LEVEL=WARN, MID='A' );

  17385  4 003443   000120 630400 5                  EPPR0   80
         4 003444   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003445   000000 701000 xent               TSX1    ASH$WARN
         4 003446   000000 011000                    NOP     0

     1124    17390    4         END;

     1125    17391                                                       /* Write special key */
     1126    17392    3      USERS_KEY.SKEY.PROJ = 0 ;

  17392  4 003447   000000 236003                    LDQ     0,DU
         4 003450   000000 552020 xsym               STBQ    USERS_KEY,'20'O

     1127    17393    3      USERS_KEY.SKEY.CREATOR = AS_PROJECT_ADMIN.TEXT ;

  17393  4 003451   040000 100400                    MLR     fill='040'O
         4 003452   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 003453   000000 400024 xsym               ADSC9   USERS_KEY                cn=2,n=20

     1128    17394    3      USERS_KEY.SKEY.USER = (SUBSTR(CR_MOD_KEY.TEXT,0,20)) ;

  17394  4 003454   040000 100500                    MLR     fill='040'O
         4 003455   200051 200024                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=20
         4 003456   000005 400024 xsym               ADSC9   USERS_KEY+5              cn=2,n=20

     1129    17395    3      USERS_KEY.COUNT = CR_MOD_KEY.CNT + 21;

  17395  4 003457   200051 236100                    LDQ     CR_MOD_KEY,,AUTO
         4 003460   000033 772000                    QRL     27
         4 003461   000025 036007                    ADLQ    21,DL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:211  
         4 003462   000033 736000                    QLS     27
         4 003463   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1130    17396    3      CALL ASB$WRITE_USERS_KEY;

  17396  4 003464   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003465   000000 701000 xent               TSX1    ASB$WRITE_USERS_KEY
         4 003466   000000 011000                    NOP     0

     1131    17397    3      END;

     1132    17398    2   IF NOT AS_WILD_USER THEN RETURN;

  17398  4 003467   000000 234000 xsym               SZN     AS_WILD_USER
         4 003470   003473 604000 4                  TMI     s:17399

  17398  4 003471   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 003472   000001 702211                    TSX2  ! 1,X1

     1133    17399    2   AS_WILD_MCH = AS_DFLT.BUDGET.MAXC ;

  17399  4 003473   000006 235000 xsym               LDA     AS_DFLT+6
         4 003474   000000 755000 xsym               STA     AS_WILD_MCH

     1134    17400    2   AS_DFLT = AS_USERS;

  17400  4 003475   000000 100400                    MLR     fill='000'O
         4 003476   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064
         4 003477   000000 004020 xsym               ADSC9   AS_DFLT                  cn=0,n=2064

     1135    17401    2   KL_DFLT = KL_DREC;

  17401  4 003500   000000 100400                    MLR     fill='000'O
         4 003501   000000 001244 xsym               ADSC9   KL_DREC                  cn=0,n=676
         4 003502   000000 001244 xsym               ADSC9   KL_DFLT                  cn=0,n=676

     1136    17402    3   DO WHILE( '1'B );
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:212  

     1137    17403    3      CALL ASB$GET_NEXT  ALTRET( FINISHED );

  17403  4 003503   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003504   000000 701000 xent               TSX1    ASB$GET_NEXT
         4 003505   003617 702000 4                  TSX2    FINISHED

     1138    17404    3      CALL ASB$LIST( USERS_KEY );

  17404  4 003506   000121 630400 5                  EPPR0   81
         4 003507   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003510   000000 701000 xent               TSX1    ASB$LIST
         4 003511   000000 011000                    NOP     0

     1139    17405    3      IF FROM_FLG

  17405  4 003512   000000 234000 xsym               SZN     FROM_FLG
         4 003513   003557 605000 4                  TPL     s:17421

     1140    17406    4      THEN DO;

     1141    17407    4         AS_DFLT.ACCT = AS_USERS.ACCT;

  17407  4 003514   040000 100400                    MLR     fill='040'O
         4 003515   000000 000010 xsym               ADSC9   AS_USERS                 cn=0,n=8
         4 003516   000000 000010 xsym               ADSC9   AS_DFLT                  cn=0,n=8

     1142    17408    4         AS_DFLT.NAME = AS_USERS.NAME;

  17408  4 003517   040000 100400                    MLR     fill='040'O
         4 003520   000002 000014 xsym               ADSC9   AS_USERS+2               cn=0,n=12
         4 003521   000002 000014 xsym               ADSC9   AS_DFLT+2                cn=0,n=12

     1143    17409    4         AS_DFLT.BUDGET.MACCT = AS_USERS.BUDGET.MACCT;

  17409  4 003522   000000 100400                    MLR     fill='000'O
         4 003523   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:213  
         4 003524   000012 000025 xsym               ADSC9   AS_DFLT+10               cn=0,n=21

     1144    17410    4         CALL ASB$WRITE_USERS( AS_DFLT );

  17410  4 003525   000100 630400 5                  EPPR0   64
         4 003526   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003527   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 003530   000000 011000                    NOP     0

     1145    17411    4         IF KL_DFLT.KL_DFLT_FEBLK.RESL_CNT = 0

  17411  4 003531   000130 220000 xsym               LDX0    KL_DFLT+88
         4 003532   003536 601000 4                  TNZ     s:17415

     1146    17412    4         THEN
     1147    17413    4            KL_DFLT.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) ;

  17413  4 003533   000113 235007                    LDA     75,DL
         4 003534   000017 755000 xsym               STA     KL_DFLT+15
         4 003535   003542 710000 4                  TRA     s:17417

     1148    17414    4         ELSE
     1149    17415    4            KL_DFLT.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) +

  17415  4 003536   000130 235000 xsym               LDA     KL_DFLT+88
         4 003537   000022 771000                    ARL     18
         4 003540   000112 035007                    ADLA    74,DL
         4 003541   000017 755000 xsym               STA     KL_DFLT+15

     1150    17416    4                 KL_DFLT.KL_DFLT_FEBLK.RESL_CNT - 1    ;
     1151    17417    4         ARS = SIZEC_DREC + ( KL_DFLT.NWINFO * 4 ) ;

  17417  4 003542   000017 236000 xsym               LDQ     KL_DFLT+15
         4 003543   000002 736000                    QLS     2
         4 003544   000000 036000 3                  ADLQ    SIZEC_DREC
         4 003545   200003 756100                    STQ     ARS,,AUTO

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:214  
     1152    17418    4         CALL ASB$WRITE_HLP( KL_DFLT$, ARS );

  17418  4 003546   200003 630500                    EPPR0   ARS,,AUTO
         4 003547   200121 450500                    STP0    I+3,,AUTO
         4 003550   000101 236000 5                  LDQ     65
         4 003551   200120 756100                    STQ     I+2,,AUTO
         4 003552   200120 630500                    EPPR0   I+2,,AUTO
         4 003553   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003554   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 003555   000000 011000                    NOP     0

     1153    17419    4         END;

  17419  4 003556   003613 710000 4                  TRA     s:17432

     1154    17420    4      ELSE DO;

     1155    17421    4         CALL ASC$MOD_USER;

  17421  4 003557   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003560   000000 701000 xent               TSX1    ASC$MOD_USER
         4 003561   000000 011000                    NOP     0

     1156    17422    4         CALL ASB$WRITE_USERS( AS_USERS );

  17422  4 003562   000104 630400 5                  EPPR0   68
         4 003563   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003564   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 003565   000000 011000                    NOP     0

     1157    17423    4         IF KL_DREC.KL_DREC_FEBLK.RESL_CNT = 0

  17423  4 003566   000130 220000 xsym               LDX0    KL_DREC+88
         4 003567   003573 601000 4                  TNZ     s:17427

     1158    17424    4         THEN
     1159    17425    4            KL_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:215  

  17425  4 003570   000113 235007                    LDA     75,DL
         4 003571   000017 755000 xsym               STA     KL_DREC+15
         4 003572   003577 710000 4                  TRA     s:17429

     1160    17426    4         ELSE
     1161    17427    4            KL_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) +

  17427  4 003573   000130 235000 xsym               LDA     KL_DREC+88
         4 003574   000022 771000                    ARL     18
         4 003575   000112 035007                    ADLA    74,DL
         4 003576   000017 755000 xsym               STA     KL_DREC+15

     1162    17428    4                 KL_DREC.KL_DREC_FEBLK.RESL_CNT - 1    ;
     1163    17429    4         ARS = SIZEC_DREC + ( KL_DREC.NWINFO * 4 ) ;

  17429  4 003577   000017 236000 xsym               LDQ     KL_DREC+15
         4 003600   000002 736000                    QLS     2
         4 003601   000000 036000 3                  ADLQ    SIZEC_DREC
         4 003602   200003 756100                    STQ     ARS,,AUTO

     1164    17430    4         CALL ASB$WRITE_HLP( KL_DREC$, ARS );

  17430  4 003603   200003 630500                    EPPR0   ARS,,AUTO
         4 003604   200121 450500                    STP0    I+3,,AUTO
         4 003605   000105 236000 5                  LDQ     69
         4 003606   200120 756100                    STQ     I+2,,AUTO
         4 003607   200120 630500                    EPPR0   I+2,,AUTO
         4 003610   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003611   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 003612   000000 011000                    NOP     0

     1165    17431    4         END;

     1166    17432    3      COUNT = COUNT + 1;

  17432  4 003613   200070 235100                    LDA     COUNT,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:216  
         4 003614   000001 035007                    ADLA    1,DL
         4 003615   200070 755100                    STA     COUNT,,AUTO

     1167    17433    3      END;

  17433  4 003616   003503 710000 4                  TRA     s:17403

     1168    17434    2   FINISHED:
     1169    17435    2   IF COUNT = 0

  17435  4 003617   200070 235100       FINISHED     LDA     COUNT,,AUTO
         4 003620   003626 601000 4                  TNZ     s:17460

     1170    17436    3   THEN DO;

     1171    17437        /*E* ERROR: ASA-E$NOTHING_TO_MOD-C
     1172    17438             MESSAGE: Nothing to modify.
     1173    17439        */
     1174    17440           %SCREAM( ERR#=E$NOTHING_TO_MOD, LEVEL=ERROR, MID='A' );

  17452  4 003621   000122 630400 5                  EPPR0   82
         4 003622   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003623   000000 701000 xent               TSX1    ASH$ERROR
         4 003624   000000 011000                    NOP     0

     1175    17455    3      END;

  17455  4 003625   003647 710000 4                  TRA     EXIT#

     1176    17456    3   ELSE DO;

     1177    17457        /*E* ERROR: AS-E$NUM_USERS_MOD-C
     1178    17458             MESSAGE:.. %U1 users modified.
     1179    17459        */
     1180    17460    3      CALL ASB$FLUSH;

  17460  4 003626   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:217  
         4 003627   000000 701000 xent               TSX1    ASB$FLUSH
         4 003630   000000 011000                    NOP     0

     1181    17461           %NUMBER( NUM1=COUNT );
             17469    3         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, COUNT );

  17469  4 003631   200070 630500                    EPPR0   COUNT,,AUTO
         4 003632   200123 450500                    STP0    I+5,,AUTO
         4 003633   000051 236000 5                  LDQ     41
         4 003634   200122 756100                    STQ     I+4,,AUTO
         4 003635   000060 237000 5                  LDAQ    48
         4 003636   200120 757100                    STAQ    I+2,,AUTO
         4 003637   200120 630500                    EPPR0   I+2,,AUTO
         4 003640   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003641   000000 701000 xent               TSX1    ASB$BINCHAR
         4 003642   000000 011000                    NOP     0

     1182    17491           %SCREAM( ERR#=E$NUM_USERS_MOD, LEVEL=INFO, MID='A' );

  17499  4 003643   000123 630400 5                  EPPR0   83
         4 003644   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003645   000000 701000 xent               TSX1    ASH$INFO
         4 003646   000000 011000                    NOP     0

     1183    17506    3      END;

     1184    17507
     1185    17508                                                        /*   Return to calling
     1186    17509                                                             routine.     */
     1187    17510    2   EXIT#: RETURN ;

  17510  4 003647   200050 221300       EXIT#        LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 003650   000001 702211                    TSX2  ! 1,X1

     1188    17511                                                              /**/
     1189    17512
     1190    17513        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:218  
     1191    17514    2   CREATE_MOD_PROJ: ENTRY;

  17514  4 003651   200050 741300       CREATE_MOD_* STX1  ! FREE_SEG_TYPE+1,,AUTO

     1192    17515
     1193    17516    2   PROJ_FLAG = AS_TRUE;

  17516  4 003652   000000 236000 xsym               LDQ     AS_TRUE
         4 003653   400000 376003                    ANQ     -131072,DU
         4 003654   200066 756100                    STQ     PROJ_FLAG,,AUTO

     1194    17517    2   CALL PARSE_CMD;

  17517  4 003655   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 003656   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 003657   007264 701000 4                  TSX1    PARSE_CMD
         4 003660   000000 011000                    NOP     0

     1195    17518    2   IF AS_PROJECT_ADMIN = AS_NONE

  17518  4 003661   000000 106400                    CMPC    fill='000'O
         4 003662   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 003663   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 003664   003667 601000 4                  TNZ     s:17522

     1196    17519    2   THEN                 /* System administrator creating project */
     1197    17520    2      AS_CR_MOD_PROJ = 0;

  17520  4 003665   000000 450000 xsym               STZ     AS_CR_MOD_PROJ
         4 003666   003707 710000 4                  TRA     s:17530

     1198    17521    3   ELSE DO;

     1199    17522    3      AS_CR_MOD_PROJ = %CR_PROJECT;      /* Proj. admin. creating project */

  17522  4 003667   000002 235007                    LDA     2,DL
         4 003670   000000 755000 xsym               STA     AS_CR_MOD_PROJ
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:219  

     1200    17523                                                  /* Read project records */
     1201    17524    3      USERS_KEY = AS_PROJECT_ADMIN;

  17524  4 003671   000000 100400                    MLR     fill='000'O
         4 003672   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 003673   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1202    17525    3      CALL ASB$GET( AS_TRUE, , AS_PROJ_ADMIN, AS_PROJ_ADMIN_DREC$,

  17525  4 003674   000124 237000 5                  LDAQ    84
         4 003675   200124 757100                    STAQ    I+6,,AUTO
         4 003676   000126 237000 5                  LDAQ    86
         4 003677   200122 757100                    STAQ    I+4,,AUTO
         4 003700   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 003701   000036 235000 5                  LDA     30
         4 003702   200120 757100                    STAQ    I+2,,AUTO
         4 003703   200120 630500                    EPPR0   I+2,,AUTO
         4 003704   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 003705   000000 701000 xent               TSX1    ASB$GET
         4 003706   003647 702000 4                  TSX2    EXIT#

     1203    17526    3           AS_DEFAULT, AS_DEFAULT_DREC$ ) ALTRET( EXIT# );
     1204    17527    3      END;

     1205    17528
     1206    17529
     1207    17530    2   PAR$ = P$NODE.SUBLK$(1) ;

  17530  4 003707   000000 470400 xsym               LDP0    NODE$
         4 003710   000004 236100                    LDQ     4,,PR0
         4 003711   200063 756100                    STQ     PAR$,,AUTO

     1208    17531    2   CALL ASB$KEYMAKER(CR_MOD_KEY,PAR$->P$NODE,PROJ_FLAG,TYPE) ALTRET(EXIT#);

  17531  4 003712   200067 631500                    EPPR1   TYPE,,AUTO
         4 003713   200123 451500                    STP1    I+5,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:220  
         4 003714   200066 633500                    EPPR3   PROJ_FLAG,,AUTO
         4 003715   200122 453500                    STP3    I+4,,AUTO
         4 003716   200121 756100                    STQ     I+3,,AUTO
         4 003717   200051 634500                    EPPR4   CR_MOD_KEY,,AUTO
         4 003720   200120 454500                    STP4    I+2,,AUTO
         4 003721   200120 630500                    EPPR0   I+2,,AUTO
         4 003722   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003723   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 003724   003647 702000 4                  TSX2    EXIT#

     1209    17532
     1210    17533                                                        /*   Create or modify
     1211    17534                                                             a project.   */
     1212    17535    2   CALL INITIALIZATIONS ALTRET(EXIT#);

  17535  4 003725   007326 701000 4                  TSX1    INITIALIZATIONS
         4 003726   003647 702000 4                  TSX2    EXIT#

     1213    17536    2   USERS_KEY = CR_MOD_KEY ;

  17536  4 003727   000000 100500                    MLR     fill='000'O
         4 003730   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 003731   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1214    17537    2   IF CREATE THEN CALL CHECK_CREATE_OK(AS_PROJECT_ADMIN) ALTRET(EXIT#);

  17537  4 003732   200065 234100                    SZN     CREATE,,AUTO
         4 003733   003741 605000 4                  TPL     s:17539

  17537  4 003734   000102 236000 5                  LDQ     66
         4 003735   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 003736   007430 701000 4                  TSX1    CHECK_CREATE_OK
         4 003737   003647 702000 4                  TSX2    EXIT#
         4 003740   003762 710000 4                  TRA     s:17545

     1215    17538    2   ELSE                                    /* Modify */
     1216    17539    2      IF AS_WILD_USER THEN CALL GET_FIRST;      /* Get first user */
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:221  

  17539  4 003741   000000 234000 xsym               SZN     AS_WILD_USER
         4 003742   003746 605000 4                  TPL     s:17541

  17539  4 003743   007744 701000 4                  TSX1    GET_FIRST
         4 003744   000000 011000                    NOP     0
         4 003745   003762 710000 4                  TRA     s:17545

     1217    17540    2      ELSE                                     /* Get specified user */
     1218    17541    2         CALL ASB$GET( PROJ_FLAG, TYPE, AS_PROJECT, AS_PROJECT_DREC$,

  17541  4 003746   000130 237000 5                  LDAQ    88
         4 003747   200124 757100                    STAQ    I+6,,AUTO
         4 003750   000132 237000 5                  LDAQ    90
         4 003751   200122 757100                    STAQ    I+4,,AUTO
         4 003752   200067 630500                    EPPR0   TYPE,,AUTO
         4 003753   200121 450500                    STP0    I+3,,AUTO
         4 003754   200066 631500                    EPPR1   PROJ_FLAG,,AUTO
         4 003755   200120 451500                    STP1    I+2,,AUTO
         4 003756   200120 630500                    EPPR0   I+2,,AUTO
         4 003757   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 003760   000000 701000 xent               TSX1    ASB$GET
         4 003761   003647 702000 4                  TSX2    EXIT#

     1219    17542    2              AS_PROJECT_DFLT, AS_PROJECT_DFLT_DREC$ ) ALTRET(EXIT#);
     1220    17543
     1221    17544        /*                                Check to see if 'FROM' was specified */
     1222    17545    2   IF P$NODE.SUBNODES = 4

  17545  4 003762   000000 470400 xsym               LDP0    NODE$
         4 003763   000001 220100                    LDX0    1,,PR0
         4 003764   000004 100003                    CMPX0   4,DU
         4 003765   004032 601000 4                  TNZ     s:17559

     1223    17546    3   THEN DO;

     1224    17547                                                              /*   Yes.    */
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:222  
     1225    17548    3      FROM_FLG = AS_TRUE ;

  17548  4 003766   000000 236000 xsym               LDQ     AS_TRUE
         4 003767   400000 376003                    ANQ     -131072,DU
         4 003770   000000 756000 xsym               STQ     FROM_FLG

     1226    17549    3      PAR$ = P$NODE.SUBLK$(2) ;

  17549  4 003771   000005 236100                    LDQ     5,,PR0
         4 003772   200063 756100                    STQ     PAR$,,AUTO

     1227    17550    3      CALL ASB$KEYMAKER(FROM_KEY,PAR$->P$NODE,PROJ_FLAG,21   /*  FROM_VAL */) ALTRET(
             17550               EXIT#) ;

  17550  4 003773   000107 236000 5                  LDQ     71
         4 003774   200123 756100                    STQ     I+5,,AUTO
         4 003775   200066 631500                    EPPR1   PROJ_FLAG,,AUTO
         4 003776   200122 451500                    STP1    I+4,,AUTO
         4 003777   200063 236100                    LDQ     PAR$,,AUTO
         4 004000   000110 235000 5                  LDA     72
         4 004001   200120 757100                    STAQ    I+2,,AUTO
         4 004002   200120 630500                    EPPR0   I+2,,AUTO
         4 004003   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 004004   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 004005   003647 702000 4                  TSX2    EXIT#

     1228    17551
     1229    17552                                            /*   From default or an account */
     1230    17553    3      USERS_KEY = FROM_KEY ;

  17553  4 004006   000000 100400                    MLR     fill='000'O
         4 004007   000000 000025 xsym               ADSC9   FROM_KEY                 cn=0,n=21
         4 004010   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1231    17554    3      IF FROM_KEY.TEXT = 'DEFAULTP' THEN GOTO FROM_DEFAULT_PROJECT;

  17554  4 004011   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:223  
         4 004012   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20
         4 004013   000131 000010 3                  ADSC9   SIZEC_DREC+89            cn=0,n=8
         4 004014   004160 600000 4                  TZE     FROM_DEFAULT_PROJECT

     1232    17555    3      CALL ASB$GET( PROJ_FLAG, ,  AS_PROJECT, AS_PROJECT_DREC$,

  17555  4 004015   000130 237000 5                  LDAQ    88
         4 004016   200124 757100                    STAQ    I+6,,AUTO
         4 004017   000132 237000 5                  LDAQ    90
         4 004020   200122 757100                    STAQ    I+4,,AUTO
         4 004021   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 004022   200121 756100                    STQ     I+3,,AUTO
         4 004023   200066 630500                    EPPR0   PROJ_FLAG,,AUTO
         4 004024   200120 450500                    STP0    I+2,,AUTO
         4 004025   200120 630500                    EPPR0   I+2,,AUTO
         4 004026   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 004027   000000 701000 xent               TSX1    ASB$GET
         4 004030   003647 702000 4                  TSX2    EXIT#

     1233    17556    3           AS_PROJECT_DFLT, AS_PROJECT_DFLT_DREC$ ) ALTRET(EXIT#);
     1234    17557    3      END;        /*Then do */

  17557  4 004031   004202 710000 4                  TRA     s:17606

     1235    17558    3   ELSE DO;                             /*   Default implied.    */

     1236    17559    3      FROM_FLG = '0'B;

  17559  4 004032   000000 450000 xsym               STZ     FROM_FLG

     1237    17560    4      IF CREATE THEN DO;

  17560  4 004033   200065 234100                    SZN     CREATE,,AUTO
         4 004034   004202 605000 4                  TPL     s:17606

     1238    17561    5         IF (SUBSTR(CR_MOD_KEY.TEXT,0,20)) = 'DEFAULTP' THEN DO;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:224  
  17561  4 004035   040000 106500                    CMPC    fill='040'O
         4 004036   200051 200024                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=20
         4 004037   000131 000010 3                  ADSC9   SIZEC_DREC+89            cn=0,n=8
         4 004040   004073 601000 4                  TNZ     s:17573

     1239    17562    5            AS_PROJECT = AS_USERS_CONSTANT;

  17562  4 004041   000000 100400                    MLR     fill='000'O
         4 004042   000000 004020 xsym               ADSC9   AS_USERS_CONSTANT        cn=0,n=2064
         4 004043   000000 004020 xsym               ADSC9   AS_PROJECT               cn=0,n=2064

     1240    17563    6            DO I = 0 TO 2;

  17563  4 004044   200057 450100                    STZ     I,,AUTO

     1241    17564    6               AS_PROJECT.PPRIV(I) = AS_PROJECT.PPRIV(I) | %PPR_PADMIN# ;

  17564  4 004045   200057 720100                    LXL0    I,,AUTO
         4 004046   000231 236010 xsym               LDQ     AS_PROJECT+153,X0
         4 004047   000026 276000 xsym               ORQ     B_VECTNIL+22
         4 004050   000231 756010 xsym               STQ     AS_PROJECT+153,X0

     1242    17565    6               END;

  17565  4 004051   200057 054100                    AOS     I,,AUTO
         4 004052   200057 235100                    LDA     I,,AUTO
         4 004053   000002 115007                    CMPA    2,DL
         4 004054   004045 604400 4                  TMOZ    s:17564

     1243    17566    5            AS_PROJECT_DREC = KL_DEFAULT;

  17566  4 004055   000000 100400                    MLR     fill='000'O
         4 004056   000000 000554 xsym               ADSC9   KL_DEFAULT               cn=0,n=364
         4 004057   000000 001244 xsym               ADSC9   AS_PROJECT_DREC          cn=0,n=676

     1244    17567    5            AS_PROJECT_DREC.PASSWORD = BLANK_PASS;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:225  
  17567  4 004060   040000 100400                    MLR     fill='040'O
         4 004061   000000 000010 xsym               ADSC9   BLANK_PASS               cn=0,n=8
         4 004062   000002 000010 xsym               ADSC9   AS_PROJECT_DREC+2        cn=0,n=8

     1245    17568    5            AS_PROJECT_DFLT = AS_USERS_CONSTANT ;

  17568  4 004063   000000 100400                    MLR     fill='000'O
         4 004064   000000 004020 xsym               ADSC9   AS_USERS_CONSTANT        cn=0,n=2064
         4 004065   000000 004020 xsym               ADSC9   AS_PROJECT_DFLT          cn=0,n=2064

     1246    17569    5            AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED = 0;

  17569  4 004066   000010 450000 xsym               STZ     AS_PROJECT_DFLT+8

     1247    17570    5            AS_PROJECT_DFLT_DREC = AS_PROJECT_DREC ;

  17570  4 004067   000000 100400                    MLR     fill='000'O
         4 004070   000000 001244 xsym               ADSC9   AS_PROJECT_DREC          cn=0,n=676
         4 004071   000000 001244 xsym               ADSC9   AS_PROJECT_DFLT_DREC     cn=0,n=676

     1248    17571    5            END;

  17571  4 004072   004202 710000 4                  TRA     s:17606

     1249    17572    4         ELSE
     1250    17573    5            IF AS_CR_MOD_PROJ > 0 THEN DO;

  17573  4 004073   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 004074   004153 604400 4                  TMOZ    s:17594

     1251    17574    5               AS_PROJECT = AS_DEFAULT;

  17574  4 004075   000000 100400                    MLR     fill='000'O
         4 004076   000000 004020 xsym               ADSC9   AS_DEFAULT               cn=0,n=2064
         4 004077   000000 004020 xsym               ADSC9   AS_PROJECT               cn=0,n=2064

     1252    17575    5               AS_PROJECT.BUDGET.ACCUM = AS_USERS_CONSTANT.BUDGET.ACCUM;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:226  

  17575  4 004100   000007 236000 xsym               LDQ     AS_USERS_CONSTANT+7
         4 004101   000007 756000 xsym               STQ     AS_PROJECT+7

     1253    17576    5               AS_PROJECT.BUDGET.PMAXC = AS_USERS_CONSTANT.BUDGET.PMAXC;

  17576  4 004102   000010 235000 xsym               LDA     AS_USERS_CONSTANT+8
         4 004103   000010 755000 xsym               STA     AS_PROJECT+8

     1254    17577    5               AS_PROJECT.BUDGET.PACCUM = AS_USERS_CONSTANT.BUDGET.PACCUM;

  17577  4 004104   000011 235000 xsym               LDA     AS_USERS_CONSTANT+9
         4 004105   000011 755000 xsym               STA     AS_PROJECT+9

     1255    17578    5               AS_PROJECT.BUDGET.MACCT_ = AS_PROJECT_ADMIN;

  17578  4 004106   000000 100400                    MLR     fill='000'O
         4 004107   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 004110   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21

     1256    17579    5               AS_PROJECT.BUDGET.MAX_PROJECTS = AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS;

  17579  4 004111   000017 720000 xsym               LXL0    AS_USERS_CONSTANT+15
         4 004112   000017 440000 xsym               SXL0    AS_PROJECT+15

     1257    17580    6               DO I = 0 TO 2;

  17580  4 004113   200057 450100                    STZ     I,,AUTO

     1258    17581    6                  AS_PROJECT.PPRIV(I) = AS_PROJECT.PPRIV(I) | %PPR_PADMIN# ;

  17581  4 004114   200057 720100                    LXL0    I,,AUTO
         4 004115   000231 236010 xsym               LDQ     AS_PROJECT+153,X0
         4 004116   000026 276000 xsym               ORQ     B_VECTNIL+22
         4 004117   000231 756010 xsym               STQ     AS_PROJECT+153,X0

     1259    17582    6                  END;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:227  

  17582  4 004120   200057 054100                    AOS     I,,AUTO
         4 004121   200057 235100                    LDA     I,,AUTO
         4 004122   000002 115007                    CMPA    2,DL
         4 004123   004114 604400 4                  TMOZ    s:17581

     1260    17583    5               AS_PROJECT_DREC = AS_PROJ_ADMIN_DREC;

  17583  4 004124   000000 100400                    MLR     fill='000'O
         4 004125   000000 001244 xsym               ADSC9   AS_PROJ_ADMIN_DREC       cn=0,n=676
         4 004126   000000 001244 xsym               ADSC9   AS_PROJECT_DREC          cn=0,n=676

     1261    17584    5               AS_PROJECT_DREC.PASSWORD = BLANK_PASS;

  17584  4 004127   040000 100400                    MLR     fill='040'O
         4 004130   000000 000010 xsym               ADSC9   BLANK_PASS               cn=0,n=8
         4 004131   000002 000010 xsym               ADSC9   AS_PROJECT_DREC+2        cn=0,n=8

     1262    17585    5               AS_PROJECT_DFLT = AS_DEFAULT;

  17585  4 004132   000000 100400                    MLR     fill='000'O
         4 004133   000000 004020 xsym               ADSC9   AS_DEFAULT               cn=0,n=2064
         4 004134   000000 004020 xsym               ADSC9   AS_PROJECT_DFLT          cn=0,n=2064

     1263    17586    5               AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED = 0;

  17586  4 004135   000010 450000 xsym               STZ     AS_PROJECT_DFLT+8

     1264    17587    5               AS_PROJECT_DFLT.BUDGET.PROJ_CREATED = 0;

  17587  4 004136   000011 450000 xsym               STZ     AS_PROJECT_DFLT+9

     1265    17588    5               AS_PROJECT_DFLT.BUDGET.SUB_PROJS = AS_USERS_CONSTANT.BUDGET.SUB_PROJS;

  17588  4 004137   000017 720000 xsym               LXL0    AS_USERS_CONSTANT+15
         4 004140   000017 440000 xsym               SXL0    AS_PROJECT_DFLT+15

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:228  
     1266    17589    5               AS_PROJECT_DFLT.BUDGET.MACCT_ = CR_MOD_KEY;

  17589  4 004141   000000 100500                    MLR     fill='000'O
         4 004142   200051 000025                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=21
         4 004143   000012 000025 xsym               ADSC9   AS_PROJECT_DFLT+10       cn=0,n=21

     1267    17590    5               AS_PROJECT_DFLT_DREC = AS_DEFAULT_DREC;

  17590  4 004144   000000 100400                    MLR     fill='000'O
         4 004145   000000 001244 xsym               ADSC9   AS_DEFAULT_DREC          cn=0,n=676
         4 004146   000000 001244 xsym               ADSC9   AS_PROJECT_DFLT_DREC     cn=0,n=676

     1268    17591    5               AS_PROJECT_DFLT_DREC.PASSWORD = BLANK_PASS;

  17591  4 004147   040000 100400                    MLR     fill='040'O
         4 004150   000000 000010 xsym               ADSC9   BLANK_PASS               cn=0,n=8
         4 004151   000002 000010 xsym               ADSC9   AS_PROJECT_DFLT_DREC+2   cn=0,n=8

     1269    17592    5               END;

  17592  4 004152   004202 710000 4                  TRA     s:17606

     1270    17593    5            ELSE DO;

     1271    17594    5               FROM_KEY.CNT = 8 ;

  17594  4 004153   010000 236003                    LDQ     4096,DU
         4 004154   000000 552040 xsym               STBQ    FROM_KEY,'40'O

     1272    17595    5               FROM_KEY.TEXT = 'DEFAULTP' ;

  17595  4 004155   040000 100400                    MLR     fill='040'O
         4 004156   000131 000010 3                  ADSC9   SIZEC_DREC+89            cn=0,n=8
         4 004157   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20

     1273    17596    5   FROM_DEFAULT_PROJECT:
     1274    17597    5               FROM_FLG = AS_TRUE;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:229  

  17597  4 004160   000000 236000 xsym  FROM_DEFAUL* LDQ     AS_TRUE
         4 004161   400000 376003                    ANQ     -131072,DU
         4 004162   000000 756000 xsym               STQ     FROM_FLG

     1275    17598    5               USERS_KEY = FROM_KEY;

  17598  4 004163   000000 100400                    MLR     fill='000'O
         4 004164   000000 000025 xsym               ADSC9   FROM_KEY                 cn=0,n=21
         4 004165   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1276    17599    5               CALL ASB$GET( PROJ_FLAG,,AS_PROJECT, AS_PROJECT_DREC$,

  17599  4 004166   000130 237000 5                  LDAQ    88
         4 004167   200124 757100                    STAQ    I+6,,AUTO
         4 004170   000132 237000 5                  LDAQ    90
         4 004171   200122 757100                    STAQ    I+4,,AUTO
         4 004172   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 004173   200121 756100                    STQ     I+3,,AUTO
         4 004174   200066 630500                    EPPR0   PROJ_FLAG,,AUTO
         4 004175   200120 450500                    STP0    I+2,,AUTO
         4 004176   200120 630500                    EPPR0   I+2,,AUTO
         4 004177   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 004200   000000 701000 xent               TSX1    ASB$GET
         4 004201   003647 702000 4                  TSX2    EXIT#

     1277    17600    5                    AS_PROJECT_DFLT, AS_PROJECT_DFLT_DREC$ )
     1278    17601    5                    ALTRET(EXIT#);
     1279    17602    5               END;

     1280    17603    4         END ;   /* Then do */

     1281    17604    3      END;   /* Else do */

     1282    17605
     1283    17606    2   IF AS_PROJECT_DFLT.BUDGET.PMAXC < 0 THEN AS_PROJECT_DFLT.BUDGET.PMAXC = 0;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:230  
  17606  4 004202   000010 235000 xsym               LDA     AS_PROJECT_DFLT+8
         4 004203   004205 605000 4                  TPL     s:17607

  17606  4 004204   000010 450000 xsym               STZ     AS_PROJECT_DFLT+8

     1284    17607    3   IF AS_CR_MOD_PROJ > 0 AND FROM_FLG THEN DO;

  17607  4 004205   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 004206   004231 604400 4                  TMOZ    s:17612
         4 004207   000000 234000 xsym               SZN     FROM_FLG
         4 004210   004231 605000 4                  TPL     s:17612

     1285    17608    3      CALL COMPARE_FROM_TO_MAX( AS_PROJECT, AS_PROJECT_DREC, AS_PROJ_ADMIN,
             17608               AS_PROJ_ADMIN_DREC );

  17608  4 004211   000134 236000 5                  LDQ     92
         4 004212   200100 756100                    STQ     @MAX_USERS+1,,AUTO
         4 004213   000136 237000 5                  LDAQ    94
         4 004214   200076 757100                    STAQ    @FROM_USERS+1,,AUTO
         4 004215   000132 236000 5                  LDQ     90
         4 004216   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 004217   012364 701000 4                  TSX1    COMPARE_FROM_TO_MAX
         4 004220   000000 011000                    NOP     0

     1286    17609    3      CALL COMPARE_FROM_TO_MAX( AS_PROJECT_DFLT, AS_PROJECT_DFLT_DREC, AS_DEFAULT,
             17609               AS_DEFAULT_DREC );

  17609  4 004221   000140 236000 5                  LDQ     96
         4 004222   200100 756100                    STQ     @MAX_USERS+1,,AUTO
         4 004223   000142 237000 5                  LDAQ    98
         4 004224   200076 757100                    STAQ    @FROM_USERS+1,,AUTO
         4 004225   000130 236000 5                  LDQ     88
         4 004226   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 004227   012364 701000 4                  TSX1    COMPARE_FROM_TO_MAX
         4 004230   000000 011000                    NOP     0

     1287    17610    3      END;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:231  

     1288    17611
     1289    17612    2   USERS_KEY = CR_MOD_KEY ;

  17612  4 004231   000000 100500                    MLR     fill='000'O
         4 004232   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 004233   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1290    17613    3   IF CREATE OR FROM_FLG THEN DO;

  17613  4 004234   200065 234100                    SZN     CREATE,,AUTO
         4 004235   004240 604000 4                  TMI     s:17614
         4 004236   000000 234000 xsym               SZN     FROM_FLG
         4 004237   004254 605000 4                  TPL     GET_PROJ_OPTIONS

     1291    17614    3      AS_PROJECT.ACCT = SUBSTR( CR_MOD_KEY.TEXT, 0, 8 );

  17614  4 004240   040000 100500                    MLR     fill='040'O
         4 004241   200051 200010                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=8
         4 004242   000000 000010 xsym               ADSC9   AS_PROJECT               cn=0,n=8

     1292    17615    3      AS_PROJECT.NAME = SUBSTR( CR_MOD_KEY.TEXT, 8, 12 );

  17615  4 004243   040000 100500                    MLR     fill='040'O
         4 004244   200053 200014                    ADSC9   PROJ_ADMIN_KEY+1,,AUTO   cn=1,n=12
         4 004245   000002 000014 xsym               ADSC9   AS_PROJECT+2             cn=0,n=12

     1293    17616    3      AS_PROJECT.BUDGET.MACCT = AS_PROJECT_ADMIN;

  17616  4 004246   000000 100400                    MLR     fill='000'O
         4 004247   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 004250   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21

     1294    17617    3      AS_PROJECT_DFLT.BUDGET.MACCT = CR_MOD_KEY;

  17617  4 004251   000000 100500                    MLR     fill='000'O
         4 004252   200051 000025                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=21
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:232  
         4 004253   000012 000025 xsym               ADSC9   AS_PROJECT_DFLT+10       cn=0,n=21

     1295    17618    3      END;

  17617  4 004254                       GET_PROJ_OP* null
     1296    17619
     1297    17620    2   GET_PROJ_OPTIONS:;                                /*  Process options */
     1298    17621
     1299    17622    2   CALL ASA$PROJECT( CR_MOD_KEY );

  17622  4 004254   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 004255   200120 450500                    STP0    I+2,,AUTO
         4 004256   200120 630500                    EPPR0   I+2,,AUTO
         4 004257   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004260   000000 701000 xent               TSX1    ASA$PROJECT
         4 004261   000000 011000                    NOP     0

     1300    17623                                                          /* Write out records
     1301    17624                                                          */
     1302    17625    2   USERS_KEY = CR_MOD_KEY;

  17625  4 004262   000000 100500                    MLR     fill='000'O
         4 004263   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 004264   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1303    17626    2   IF CREATE AND AS_CR_MOD_PROJ > 0 THEN

  17626  4 004265   200065 234100                    SZN     CREATE,,AUTO
         4 004266   004275 605000 4                  TPL     s:17629
         4 004267   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 004270   004275 604400 4                  TMOZ    s:17629

     1304    17627    2      CALL ASB$ACCT_OK( USERS_KEY.UKEY.ACCT, AS_PROJECT.HPSN,

  17627  4 004271   000144 630400 5                  EPPR0   100
         4 004272   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 004273   000000 701000 xent               TSX1    ASB$ACCT_OK
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:233  
         4 004274   003647 702000 4                  TSX2    EXIT#

     1305    17628    2           AS_PROJECT_ADMIN, AS_FALSE ) ALTRET(EXIT#);
     1306    17629    2   CALL ASB$WRITE_USERS( AS_PROJECT );

  17629  4 004275   000132 630400 5                  EPPR0   90
         4 004276   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004277   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 004300   000000 011000                    NOP     0

     1307    17630    2   IF AS_PROJECT_DREC.AS_PROJECT_DREC_FEBLK.RESL_CNT = 0

  17630  4 004301   000130 220000 xsym               LDX0    AS_PROJECT_DREC+88
         4 004302   004306 601000 4                  TNZ     s:17634

     1308    17631    2   THEN
     1309    17632    2      AS_PROJECT_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) ;

  17632  4 004303   000113 235007                    LDA     75,DL
         4 004304   000017 755000 xsym               STA     AS_PROJECT_DREC+15
         4 004305   004312 710000 4                  TRA     s:17636

     1310    17633    2   ELSE
     1311    17634    2      AS_PROJECT_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) +

  17634  4 004306   000130 235000 xsym               LDA     AS_PROJECT_DREC+88
         4 004307   000022 771000                    ARL     18
         4 004310   000112 035007                    ADLA    74,DL
         4 004311   000017 755000 xsym               STA     AS_PROJECT_DREC+15

     1312    17635    2           AS_PROJECT_DREC.AS_PROJECT_DREC_FEBLK.RESL_CNT - 1    ;
     1313    17636    2   ARS = SIZEC_DREC + ( AS_PROJECT_DREC.NWINFO * 4 ) ;

  17636  4 004312   000017 236000 xsym               LDQ     AS_PROJECT_DREC+15
         4 004313   000002 736000                    QLS     2
         4 004314   000000 036000 3                  ADLQ    SIZEC_DREC
         4 004315   200003 756100                    STQ     ARS,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:234  

     1314    17637    2   CALL ASB$WRITE_HLP( AS_PROJECT_DREC$, ARS );

  17637  4 004316   200003 630500                    EPPR0   ARS,,AUTO
         4 004317   200121 450500                    STP0    I+3,,AUTO
         4 004320   000133 236000 5                  LDQ     91
         4 004321   200120 756100                    STQ     I+2,,AUTO
         4 004322   200120 630500                    EPPR0   I+2,,AUTO
         4 004323   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 004324   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 004325   000000 011000                    NOP     0

     1315    17638    2   USERS_KEY.COUNT = 21;

  17638  4 004326   025000 236003                    LDQ     10752,DU
         4 004327   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1316    17639    2   USERS_KEY.TEXT(20) = 'S';

  17639  4 004330   000123 236003                    LDQ     83,DU
         4 004331   000005 552020 xsym               STBQ    USERS_KEY+5,'20'O

     1317    17640    2   CALL ASB$WRITE_USERS( AS_PROJECT_DFLT );

  17640  4 004332   000130 630400 5                  EPPR0   88
         4 004333   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004334   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 004335   000000 011000                    NOP     0

     1318    17641    2   IF AS_PROJECT_DFLT_DREC.AS_PROJECT_DFLT_DREC_FEBLK.RESL_CNT = 0

  17641  4 004336   000130 220000 xsym               LDX0    AS_PROJECT_DFLT_DREC+88
         4 004337   004343 601000 4                  TNZ     s:17645

     1319    17642    2   THEN
     1320    17643    2      AS_PROJECT_DFLT_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) ;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:235  
  17643  4 004340   000113 235007                    LDA     75,DL
         4 004341   000017 755000 xsym               STA     AS_PROJECT_DFLT_DREC+15
         4 004342   004347 710000 4                  TRA     s:17647

     1321    17644    2   ELSE
     1322    17645    2      AS_PROJECT_DFLT_DREC.NWINFO = SIZEW( KL_DEFAULT.KL_DEFAULT_FEBLK) +

  17645  4 004343   000130 235000 xsym               LDA     AS_PROJECT_DFLT_DREC+88
         4 004344   000022 771000                    ARL     18
         4 004345   000112 035007                    ADLA    74,DL
         4 004346   000017 755000 xsym               STA     AS_PROJECT_DFLT_DREC+15

     1323    17646    2           AS_PROJECT_DFLT_DREC.AS_PROJECT_DFLT_DREC_FEBLK.RESL_CNT - 1    ;
     1324    17647    2   ARS = SIZEC_DREC + ( AS_PROJECT_DFLT_DREC.NWINFO * 4 ) ;

  17647  4 004347   000017 236000 xsym               LDQ     AS_PROJECT_DFLT_DREC+15
         4 004350   000002 736000                    QLS     2
         4 004351   000000 036000 3                  ADLQ    SIZEC_DREC
         4 004352   200003 756100                    STQ     ARS,,AUTO

     1325    17648    2   CALL ASB$WRITE_HLP( AS_PROJECT_DFLT_DREC$, ARS );

  17648  4 004353   200003 630500                    EPPR0   ARS,,AUTO
         4 004354   200121 450500                    STP0    I+3,,AUTO
         4 004355   000131 236000 5                  LDQ     89
         4 004356   200120 756100                    STQ     I+2,,AUTO
         4 004357   200120 630500                    EPPR0   I+2,,AUTO
         4 004360   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 004361   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 004362   000000 011000                    NOP     0

     1326    17649    3   IF CREATE THEN DO;

  17649  4 004363   200065 234100                    SZN     CREATE,,AUTO
         4 004364   004423 605000 4                  TPL     s:17682

     1327    17650                                                       /* Write special key */
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:236  
     1328    17651    3      USERS_KEY.SKEY.PROJ = 1;

  17651  4 004365   000001 236003                    LDQ     1,DU
         4 004366   000000 552020 xsym               STBQ    USERS_KEY,'20'O

     1329    17652    3      USERS_KEY.SKEY.CREATOR = AS_PROJECT_ADMIN.TEXT ;

  17652  4 004367   040000 100400                    MLR     fill='040'O
         4 004370   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 004371   000000 400024 xsym               ADSC9   USERS_KEY                cn=2,n=20

     1330    17653    3      USERS_KEY.SKEY.USER = (SUBSTR(CR_MOD_KEY.TEXT,0,20)) ;

  17653  4 004372   040000 100500                    MLR     fill='040'O
         4 004373   200051 200024                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=20
         4 004374   000005 400024 xsym               ADSC9   USERS_KEY+5              cn=2,n=20

     1331    17654    3      USERS_KEY.COUNT = CR_MOD_KEY.CNT + 21;

  17654  4 004375   200051 236100                    LDQ     CR_MOD_KEY,,AUTO
         4 004376   000033 772000                    QRL     27
         4 004377   000025 036007                    ADLQ    21,DL
         4 004400   000033 736000                    QLS     27
         4 004401   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1332    17655    3      CALL ASB$WRITE_USERS_KEY;

  17655  4 004402   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 004403   000000 701000 xent               TSX1    ASB$WRITE_USERS_KEY
         4 004404   000000 011000                    NOP     0

     1333    17656    4      IF AS_CR_MOD_PROJ > 0 THEN DO;

  17656  4 004405   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 004406   004423 604400 4                  TMOZ    s:17682

     1334    17657    4         IF AS_DEFAULT.BUDGET.SUB_PROJS = AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:237  

  17657  4 004407   000017 236000 xsym               LDQ     AS_DEFAULT+15
         4 004410   000017 676000 xsym               ERQ     AS_PROJ_ADMIN+15
         4 004411   777777 376007                    ANQ     -1,DL
         4 004412   004423 601000 4                  TNZ     s:17682

     1335    17658    5         THEN DO;

     1336    17659        /*E* ERROR:   ASA-E$MAX_SUB_PROJS-C
     1337    17660        MESSAGE: The maximum number of sub-projects allowed for project "%U1"
     1338    17661                 have now been accumulated.
     1339    17662        */
     1340    17663    5            CALL ASA$KEYCONV( AS_PROJECT_ADMIN, AS_FIELD1 );

  17663  4 004413   000102 630400 5                  EPPR0   66
         4 004414   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 004415   000000 701000 xent               TSX1    ASA$KEYCONV
         4 004416   000000 011000                    NOP     0

     1341    17664                 %SCREAM( ERR#=E$MAX_SUB_PROJS, LEVEL=WARN, MID='A' );

  17674  4 004417   000150 630400 5                  EPPR0   104
         4 004420   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004421   000000 701000 xent               TSX1    ASH$WARN
         4 004422   000000 011000                    NOP     0

     1342    17679    5            END;

     1343    17680    4         END;

     1344    17681    3      END;

     1345    17682    3   IF AS_CR_MOD_PROJ > 0 THEN DO;

  17682  4 004423   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 004424   004441 604400 4                  TMOZ    s:17687

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:238  
     1346    17683    3      CALL CONCAT( USERS_KEY.TXTC, AS_PROJECT_ADMIN.TEXT, 'S' );

  17683  4 004425   040000 100400                    MLR     fill='040'O
         4 004426   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 004427   000000 200024 xsym               ADSC9   USERS_KEY                cn=1,n=20
         4 004430   040000 100400                    MLR     fill='040'O
         4 004431   000077 000001 5                  ADSC9   63                       cn=0,n=1
         4 004432   000005 200025 xsym               ADSC9   USERS_KEY+5              cn=1,n=21

     1347    17684    3      USERS_KEY.COUNT = 21;

  17684  4 004433   025000 236003                    LDQ     10752,DU
         4 004434   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1348    17685    3      CALL ASB$WRITE_USERS( AS_DEFAULT );

  17685  4 004435   000124 630400 5                  EPPR0   84
         4 004436   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004437   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 004440   000000 011000                    NOP     0

     1349    17686    3      END;

     1350    17687    2   RETURN;

  17687  4 004441   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 004442   000001 702211                    TSX2  ! 1,X1

     1351    17688        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:239  
     1352    17689    2   MOD_USER_TO_PROJ: ENTRY;

  17689  4 004443   200050 741300       MOD_USER_TO* STX1  ! FREE_SEG_TYPE+1,,AUTO

     1353    17690
     1354    17691    2   CREATE = '0'B; CR_MOD_FLG = '1'B;

  17691  4 004444   200065 450100                    STZ     CREATE,,AUTO

  17691  4 004445   400000 236003                    LDQ     -131072,DU
         4 004446   000000 756000 xsym               STQ     CR_MOD_FLG

     1355    17692    2   PROJ_FLAG = '1'B; FROM_FLG = '0'B;

  17692  4 004447   200066 756100                    STQ     PROJ_FLAG,,AUTO

  17692  4 004450   000000 450000 xsym               STZ     FROM_FLG

     1356    17693    2   IF AS_PROJECT_ADMIN = AS_NONE THEN

  17693  4 004451   000000 106400                    CMPC    fill='000'O
         4 004452   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 004453   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 004454   004457 601000 4                  TNZ     s:17696

     1357    17694    2      AS_CR_MOD_PROJ = 0;

  17694  4 004455   000000 450000 xsym               STZ     AS_CR_MOD_PROJ
         4 004456   004477 710000 4                  TRA     s:17702

     1358    17695    3   ELSE DO;

     1359    17696    3      AS_CR_MOD_PROJ = %CR_PROJECT;

  17696  4 004457   000002 235007                    LDA     2,DL
         4 004460   000000 755000 xsym               STA     AS_CR_MOD_PROJ

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:240  
     1360    17697    3      USERS_KEY = AS_PROJECT_ADMIN;

  17697  4 004461   000000 100400                    MLR     fill='000'O
         4 004462   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 004463   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1361    17698    3      CALL ASB$GET( AS_TRUE, , AS_PROJ_ADMIN, AS_PROJ_ADMIN_DREC$,

  17698  4 004464   000124 237000 5                  LDAQ    84
         4 004465   200124 757100                    STAQ    I+6,,AUTO
         4 004466   000126 237000 5                  LDAQ    86
         4 004467   200122 757100                    STAQ    I+4,,AUTO
         4 004470   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 004471   000036 235000 5                  LDA     30
         4 004472   200120 757100                    STAQ    I+2,,AUTO
         4 004473   200120 630500                    EPPR0   I+2,,AUTO
         4 004474   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 004475   000000 701000 xent               TSX1    ASB$GET
         4 004476   003647 702000 4                  TSX2    EXIT#

     1362    17699    3           AS_DEFAULT, AS_DEFAULT_DREC$ ) ALTRET(EXIT#);
     1363    17700    3      END;

     1364    17701
     1365    17702    2   PAR$ = P$NODE.SUBLK$(0);

  17702  4 004477   000000 470400 xsym               LDP0    NODE$
         4 004500   000003 236100                    LDQ     3,,PR0
         4 004501   200063 756100                    STQ     PAR$,,AUTO

     1366    17703    2   CALL ASB$KEYMAKER(CR_MOD_KEY, PAR$->P$NODE, AS_FALSE, CODE) ALTRET(EXIT#);

  17703  4 004502   000152 237000 5                  LDAQ    106
         4 004503   200122 757100                    STAQ    I+4,,AUTO
         4 004504   200063 236100                    LDQ     PAR$,,AUTO
         4 004505   200121 756100                    STQ     I+3,,AUTO
         4 004506   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:241  
         4 004507   200120 451500                    STP1    I+2,,AUTO
         4 004510   200120 630500                    EPPR0   I+2,,AUTO
         4 004511   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 004512   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 004513   003647 702000 4                  TSX2    EXIT#

     1367    17704
     1368    17705    2   USERS_KEY = CR_MOD_KEY;

  17705  4 004514   000000 100500                    MLR     fill='000'O
         4 004515   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 004516   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1369    17706    2   CALL ASB$GET( AS_FALSE, CODE, AS_USERS, KL_DREC$ ) ALTRET(EXIT#);

  17706  4 004517   000154 630400 5                  EPPR0   108
         4 004520   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 004521   000000 701000 xent               TSX1    ASB$GET
         4 004522   003647 702000 4                  TSX2    EXIT#

     1370    17707
     1371    17708    2   CALL CHECK_CREATE_OK(AS_PROJECT_ADMIN) ALTRET(EXIT#);

  17708  4 004523   000102 236000 5                  LDQ     66
         4 004524   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 004525   007430 701000 4                  TSX1    CHECK_CREATE_OK
         4 004526   003647 702000 4                  TSX2    EXIT#

     1372    17709    2   CALL INITIALIZATIONS  ALTRET(EXIT#);

  17709  4 004527   007326 701000 4                  TSX1    INITIALIZATIONS
         4 004530   003647 702000 4                  TSX2    EXIT#

     1373    17710    2   CALL GET_ACCT_LIST(1) ALTRET(EXIT#);

  17710  4 004531   000007 236000 5                  LDQ     7
         4 004532   200075 756100                    STQ     WSN_INDEX,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:242  
         4 004533   010321 701000 4                  TSX1    GET_ACCT_LIST
         4 004534   003647 702000 4                  TSX2    EXIT#

     1374    17711    2   IF AS_USERS.BUDGET.MACCT ~= AS_NONE THEN

  17711  4 004535   000000 106400                    CMPC    fill='000'O
         4 004536   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 004537   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 004540   004565 600000 4                  TZE     s:17714

     1375    17712    2      CALL ASA$UNTIE_USER( CR_MOD_KEY, ACCT_COUNT, (AS_PROJECT_ADMIN~=AS_USERS.BUDGET.
             17712               MACCT) );

  17712  4 004541   400000 220003                    LDX0    -131072,DU
         4 004542   000000 106400                    CMPC    fill='000'O
         4 004543   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 004544   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 004545   004547 601000 4                  TNZ     s:17712+6
         4 004546   000000 220003                    LDX0    0,DU
         4 004547   000000 636010                    EAQ     0,X0
         4 004550   200120 676100                    ERQ     I+2,,AUTO
         4 004551   400000 376003                    ANQ     -131072,DU
         4 004552   200120 656100                    ERSQ    I+2,,AUTO
         4 004553   200120 630500                    EPPR0   I+2,,AUTO
         4 004554   200124 450500                    STP0    I+6,,AUTO
         4 004555   200072 631500                    EPPR1   ACCT_COUNT,,AUTO
         4 004556   200123 451500                    STP1    I+5,,AUTO
         4 004557   200051 633500                    EPPR3   CR_MOD_KEY,,AUTO
         4 004560   200122 453500                    STP3    I+4,,AUTO
         4 004561   200122 630500                    EPPR0   I+4,,AUTO
         4 004562   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 004563   000000 701000 xent               TSX1    ASA$UNTIE_USER
         4 004564   000000 011000                    NOP     0

     1376    17713
     1377    17714    2   AS_PROJECT = AS_USERS;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:243  
  17714  4 004565   000000 100400                    MLR     fill='000'O
         4 004566   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064
         4 004567   000000 004020 xsym               ADSC9   AS_PROJECT               cn=0,n=2064

     1378    17715    2   AS_PROJECT.BUDGET.MACCT = AS_PROJECT_ADMIN;

  17715  4 004570   000000 100400                    MLR     fill='000'O
         4 004571   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 004572   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21

     1379    17716    2   AS_PROJECT.BUDGET.MAX_PROJECTS = AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS;

  17716  4 004573   000017 720000 xsym               LXL0    AS_USERS_CONSTANT+15
         4 004574   000017 440000 xsym               SXL0    AS_PROJECT+15

     1380    17717    3   DO I = 0 TO SIZEW(AS_PROJECT.PPRIV)-1;

  17717  4 004575   200057 450100                    STZ     I,,AUTO
         4 004576   004604 710000 4                  TRA     s:17719+1

     1381    17718    3      AS_PROJECT.PPRIV(I) = AS_PROJECT.PPRIV(I) | %PPR_PADMIN#;

  17718  4 004577   200057 720100                    LXL0    I,,AUTO
         4 004600   000231 236010 xsym               LDQ     AS_PROJECT+153,X0
         4 004601   000026 276000 xsym               ORQ     B_VECTNIL+22
         4 004602   000231 756010 xsym               STQ     AS_PROJECT+153,X0

     1382    17719    3      END;

  17719  4 004603   200057 054100                    AOS     I,,AUTO
         4 004604   200057 235100                    LDA     I,,AUTO
         4 004605   000003 115007                    CMPA    3,DL
         4 004606   004577 604400 4                  TMOZ    s:17718

     1383    17720    2   AS_PROJECT_DFLT = AS_USERS;

  17720  4 004607   000000 100400                    MLR     fill='000'O
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:244  
         4 004610   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064
         4 004611   000000 004020 xsym               ADSC9   AS_PROJECT_DFLT          cn=0,n=2064

     1384    17721    2   AS_PROJECT_DFLT.BUDGET.MACCT = CR_MOD_KEY;

  17721  4 004612   000000 100500                    MLR     fill='000'O
         4 004613   200051 000025                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=21
         4 004614   000012 000025 xsym               ADSC9   AS_PROJECT_DFLT+10       cn=0,n=21

     1385    17722    2   AS_PROJECT_DFLT.BUDGET.ACCUM = 0;

  17722  4 004615   000007 450000 xsym               STZ     AS_PROJECT_DFLT+7

     1386    17723    2   AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED = 0;

  17723  4 004616   000010 450000 xsym               STZ     AS_PROJECT_DFLT+8

     1387    17724    2   AS_PROJECT_DFLT.BUDGET.PROJ_CREATED = 0;

  17724  4 004617   000011 450000 xsym               STZ     AS_PROJECT_DFLT+9

     1388    17725    2   AS_PROJECT_DFLT.BUDGET.SUB_PROJS = AS_USERS_CONSTANT.BUDGET.SUB_PROJS;

  17725  4 004620   000017 720000 xsym               LXL0    AS_USERS_CONSTANT+15
         4 004621   000017 440000 xsym               SXL0    AS_PROJECT_DFLT+15

     1389    17726    2   AS_PROJECT_DREC = KL_DREC;

  17726  4 004622   000000 100400                    MLR     fill='000'O
         4 004623   000000 001244 xsym               ADSC9   KL_DREC                  cn=0,n=676
         4 004624   000000 001244 xsym               ADSC9   AS_PROJECT_DREC          cn=0,n=676

     1390    17727    2   AS_PROJECT_DFLT_DREC = KL_DREC;

  17727  4 004625   000000 100400                    MLR     fill='000'O
         4 004626   000000 001244 xsym               ADSC9   KL_DREC                  cn=0,n=676
         4 004627   000000 001244 xsym               ADSC9   AS_PROJECT_DFLT_DREC     cn=0,n=676
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:245  

     1391    17728    2   USERS_KEY.COUNT = CR_MOD_KEY.CNT + 21;

  17728  4 004630   200051 236100                    LDQ     CR_MOD_KEY,,AUTO
         4 004631   000033 772000                    QRL     27
         4 004632   000025 036007                    ADLQ    21,DL
         4 004633   000033 736000                    QLS     27
         4 004634   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1392    17729    2   CALL CONCAT( USERS_KEY.TXTC, BINASC(1), AS_PROJECT_ADMIN.TEXT, (SUBSTR(CR_MOD_KEY.
             17729            TEXT,0,20)) );

  17729  4 004635   000001 236003                    LDQ     1,DU
         4 004636   000000 552020 xsym               STBQ    USERS_KEY,'20'O
         4 004637   040000 100400                    MLR     fill='040'O
         4 004640   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 004641   000000 400024 xsym               ADSC9   USERS_KEY                cn=2,n=20
         4 004642   040000 100500                    MLR     fill='040'O
         4 004643   200051 200024                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=20
         4 004644   000005 400024 xsym               ADSC9   USERS_KEY+5              cn=2,n=20

     1393    17730    2   CALL ASB$WRITE_USERS_KEY;

  17730  4 004645   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 004646   000000 701000 xent               TSX1    ASB$WRITE_USERS_KEY
         4 004647   000000 011000                    NOP     0

     1394    17731    2   AS_PROJECT_DFLT_DREC.PASSWORD = BLANK_PASS;

  17731  4 004650   040000 100400                    MLR     fill='040'O
         4 004651   000000 000010 xsym               ADSC9   BLANK_PASS               cn=0,n=8
         4 004652   000002 000010 xsym               ADSC9   AS_PROJECT_DFLT_DREC+2   cn=0,n=8

     1395    17732        /*E*  ERROR:  ASA-E$USER_TO_PROJ-C
     1396    17733              MESSAGE:.. User "%U1" modified to project "%U1".
     1397    17734        */
     1398    17735    2   CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD1 );
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:246  

  17735  4 004653   000103 236000 5                  LDQ     67
         4 004654   200121 756100                    STQ     I+3,,AUTO
         4 004655   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 004656   200120 450500                    STP0    I+2,,AUTO
         4 004657   200120 630500                    EPPR0   I+2,,AUTO
         4 004660   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 004661   000000 701000 xent               TSX1    ASA$KEYCONV
         4 004662   000000 011000                    NOP     0

     1399    17736        %SCREAM( ERR#=E$USER_TO_PROJ, MID='A', LEVEL=INFO );

  17744  4 004663   000160 630400 5                  EPPR0   112
         4 004664   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004665   000000 701000 xent               TSX1    ASH$INFO
         4 004666   000000 011000                    NOP     0

     1400    17751
     1401    17752    2   PROJ_KEY = CR_MOD_KEY;

  17752  4 004667   000000 100500                    MLR     fill='000'O
         4 004670   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 004671   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27

     1402    17753    2   AS$PROJ_HEADER = AS_CONSTANT_PROJ_HEADER;

  17753  4 004672   000000 470400 xsym               LDP0    DSEG2$
         4 004673   000100 100400                    MLR     fill='000'O
         4 004674   000000 000060 xsym               ADSC9   AS_CONSTANT_PROJ_HEADER  cn=0,n=48
         4 004675   000000 000060                    ADSC9   0,,PR0                   cn=0,n=48

     1403    17754    2   AS$PROJ.ATTRIBUTES.COUNT = 0;

  17754  4 004676   000000 220003                    LDX0    0,DU
         4 004677   000000 470400 xsym               LDP0    DSEG2$
         4 004700   000014 740100                    STX0    12,,PR0

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:247  
     1404    17755    2   PROJ_ACCT_LIST$ = PINCRW(DSEG2$, SIZEW(AS$PROJ_HEADER)+1 );

  17755  4 004701   000000 236000 xsym               LDQ     DSEG2$
         4 004702   000015 036003                    ADLQ    13,DU
         4 004703   200064 756100                    STQ     PROJ_ACCT_LIST$,,AUTO

     1405    17756    2   IF AS_PROJECT_ADMIN~=AS_NONE THEN AS$PROJ.CREATOR = AS_PROJECT_ADMIN.TEXT;

  17756  4 004704   000000 106400                    CMPC    fill='000'O
         4 004705   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 004706   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 004707   004713 600000 4                  TZE     s:17757

  17756  4 004710   040100 100400                    MLR     fill='040'O
         4 004711   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 004712   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

     1406    17757    3   IF ACCT_COUNT > 0 THEN DO;

  17757  4 004713   200072 235100                    LDA     ACCT_COUNT,,AUTO
         4 004714   005056 604400 4                  TMOZ    s:17782

     1407    17758    3      I = 0;

  17758  4 004715   200057 450100                    STZ     I,,AUTO

     1408    17759    4      DO WHILE( I < ACCT_COUNT );

  17759  4 004716   200057 236100                    LDQ     I,,AUTO
         4 004717   200072 116100                    CMPQ    ACCT_COUNT,,AUTO
         4 004720   005116 605000 4                  TPL     s:17792

     1409    17760    4         PROJ_KEY.TXT.PACKSET = ACCT$LIST.PSN(I);

  17760  4 004721   200057 236100                    LDQ     I,,AUTO
         4 004722   000024 402007                    MPY     20,DL
         4 004723   000000 470400 xsym               LDP0    DSEG1$
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:248  
         4 004724   040000 100506                    MLR     fill='040'O
         4 004725   000000 000006                    ADSC9   0,Q,PR0                  cn=0,n=6
         4 004726   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

     1410    17761    4         CALL INDEX( J, AS_BLANK, PROJ_KEY.TEXT, 20 );

  17761  4 004727   000000 124400                    SCM     mask='000'O
         4 004730   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         4 004731   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 004732   200060 000100                    ARG     J,,AUTO
         4 004733   000024 236007                    LDQ     20,DL
         4 004734   200060 056100                    ASQ     J,,AUTO

     1411    17762    4         PROJ_KEY.COUNT = J;

  17762  4 004735   200060 236100                    LDQ     J,,AUTO
         4 004736   000033 736000                    QLS     27
         4 004737   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

     1412    17763    4         AS$PROJ.NUM_ACCTS = 0;

  17763  4 004740   000000 471400 xsym               LDP1    DSEG2$
         4 004741   100013 450100                    STZ     11,,PR1

     1413    17764    4         AS$PROJ.GRANS_ACCUM = 0;

  17764  4 004742   100007 450100                    STZ     7,,PR1

     1414    17765    5         DO WHILE( I < ACCT_COUNT AND ACCT$LIST.PSN(I) = PROJ_KEY.TXT.PACKSET );

  17765  4 004743   005004 710000 4                  TRA     s:17771

     1415    17766    5            PROJ$LIST.ACCT(AS$PROJ.NUM_ACCTS) = ACCT$LIST.ACCT(I);

  17766  4 004744   000000 470400 xsym               LDP0    DSEG2$
         4 004745   000013 236100                    LDQ     11,,PR0
         4 004746   000003 402007                    MPY     3,DL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:249  
         4 004747   000000 620006                    EAX0    0,QL
         4 004750   200057 236100                    LDQ     I,,AUTO
         4 004751   000024 402007                    MPY     20,DL
         4 004752   000000 635010                    EAA     0,X0
         4 004753   000020 771000                    ARL     16
         4 004754   000000 471400 xsym               LDP1    DSEG1$
         4 004755   200064 473500                    LDP3    PROJ_ACCT_LIST$,,AUTO
         4 004756   040105 100506                    MLR     fill='040'O
         4 004757   100001 400010                    ADSC9   1,Q,PR1                  cn=2,n=8
         4 004760   300000 000010                    ADSC9   0,A,PR3                  cn=0,n=8

     1416    17767    5            PROJ$LIST.GRANS(AS$PROJ.NUM_ACCTS) = ACCT$LIST.GRANS(I);

  17767  4 004761   000000 470400 xsym               LDP0    DSEG2$
         4 004762   000013 236100                    LDQ     11,,PR0
         4 004763   000003 402007                    MPY     3,DL
         4 004764   200120 756100                    STQ     I+2,,AUTO
         4 004765   200057 236100                    LDQ     I,,AUTO
         4 004766   000005 402007                    MPY     5,DL
         4 004767   000000 471400 xsym               LDP1    DSEG1$
         4 004770   200120 720100                    LXL0    I+2,,AUTO
         4 004771   100004 235106                    LDA     4,QL,PR1
         4 004772   300002 755110                    STA     2,X0,PR3

     1417    17768    5            AS$PROJ.NUM_ACCTS = AS$PROJ.NUM_ACCTS + 1;

  17768  4 004773   000000 470400 xsym               LDP0    DSEG2$
         4 004774   000013 054100                    AOS     11,,PR0

     1418    17769    5            AS$PROJ.GRANS_ACCUM = AS$PROJ.GRANS_ACCUM+ACCT$LIST.GRANS(I);

  17769  4 004775   200057 236100                    LDQ     I,,AUTO
         4 004776   000005 402007                    MPY     5,DL
         4 004777   000000 471400 xsym               LDP1    DSEG1$
         4 005000   100004 236106                    LDQ     4,QL,PR1
         4 005001   000007 036100                    ADLQ    7,,PR0
         4 005002   000007 756100                    STQ     7,,PR0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:250  

     1419    17770    5            I = I + 1;

  17770  4 005003   200057 054100                    AOS     I,,AUTO

     1420    17771    5            END;

  17771  4 005004   200057 236100                    LDQ     I,,AUTO
         4 005005   200072 116100                    CMPQ    ACCT_COUNT,,AUTO
         4 005006   005015 605000 4                  TPL     s:17772
         4 005007   000024 402007                    MPY     20,DL
         4 005010   000000 470400 xsym               LDP0    DSEG1$
         4 005011   040000 106506                    CMPC    fill='040'O
         4 005012   000000 000006                    ADSC9   0,Q,PR0                  cn=0,n=6
         4 005013   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         4 005014   004744 600000 4                  TZE     s:17766

     1421    17772    4         AS$PROJ.MAX_NUM_ACCTS = AS$PROJ.NUM_ACCTS;

  17772  4 005015   000000 470400 xsym               LDP0    DSEG2$
         4 005016   000013 235100                    LDA     11,,PR0
         4 005017   000012 755100                    STA     10,,PR0

     1422    17773    4         AS$PROJ.MAX_NUM_GRANS = AS$PROJ.GRANS_ACCUM;

  17773  4 005020   000007 235100                    LDA     7,,PR0
         4 005021   000006 755100                    STA     6,,PR0

     1423    17774    4         ARS = POFFC(PROJ_ACCT_LIST$,DSEG2$) + SIZEC(PROJ$LIST(0))*AS$PROJ.NUM_ACCTS;

  17774  4 005022   000000 236000 xsym               LDQ     DSEG2$
         4 005023   000020 772000                    QRL     16
         4 005024   200120 756100                    STQ     I+2,,AUTO
         4 005025   200064 236100                    LDQ     PROJ_ACCT_LIST$,,AUTO
         4 005026   000020 772000                    QRL     16
         4 005027   200120 136100                    SBLQ    I+2,,AUTO
         4 005030   200121 756100                    STQ     I+3,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:251  
         4 005031   000013 236100                    LDQ     11,,PR0
         4 005032   000014 402007                    MPY     12,DL
         4 005033   200121 036100                    ADLQ    I+3,,AUTO
         4 005034   200003 756100                    STQ     ARS,,AUTO

     1424    17775    4         CALL ASB$WRITE_PROJ( DSEG2$, ARS ) ALTRET(WRITE_ERR1);

  17775  4 005035   200003 631500                    EPPR1   ARS,,AUTO
         4 005036   200121 451500                    STP1    I+3,,AUTO
         4 005037   000161 236000 5                  LDQ     113
         4 005040   200120 756100                    STQ     I+2,,AUTO
         4 005041   200120 630500                    EPPR0   I+2,,AUTO
         4 005042   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 005043   000000 701000 xent               TSX1    ASB$WRITE_PROJ
         4 005044   005046 702000 4                  TSX2    WRITE_ERR1

     1425    17776    5         DO WHILE( '0'B );

  17776  4 005045   005052 710000 4                  TRA     s:17779

     1426    17777    5   WRITE_ERR1: CALL ASH$ERROR( ERR_CODE );

  17777  4 005046   000001 630400 5     WRITE_ERR1   EPPR0   1
         4 005047   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005050   000000 701000 xent               TSX1    ASH$ERROR
         4 005051   000000 011000                    NOP     0

     1427    17778    5            END;

     1428    17779    4         END;

  17779  4 005052   200057 236100                    LDQ     I,,AUTO
         4 005053   200072 116100                    CMPQ    ACCT_COUNT,,AUTO
         4 005054   004721 604000 4                  TMI     s:17760

     1429    17780    3      END;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:252  
  17780  4 005055   005116 710000 4                  TRA     s:17792

     1430    17781    3   ELSE DO;

     1431    17782    3      PROJ_KEY.TXT.PACKSET = AS_PROJECT.HPSN;

  17782  4 005056   040000 100400                    MLR     fill='040'O
         4 005057   000123 000006 xsym               ADSC9   AS_PROJECT+83            cn=0,n=6
         4 005060   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

     1432    17783    3      CALL INDEX( J, AS_BLANK, PROJ_KEY.TEXT, 20 );

  17783  4 005061   000000 124400                    SCM     mask='000'O
         4 005062   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         4 005063   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 005064   200060 000100                    ARG     J,,AUTO
         4 005065   000024 236007                    LDQ     20,DL
         4 005066   200060 056100                    ASQ     J,,AUTO

     1433    17784    3      PROJ_KEY.COUNT = J;

  17784  4 005067   200060 236100                    LDQ     J,,AUTO
         4 005070   000033 736000                    QLS     27
         4 005071   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

     1434    17785    3      ARS = POFFC( PROJ_ACCT_LIST$, DSEG2$ );

  17785  4 005072   000000 236000 xsym               LDQ     DSEG2$
         4 005073   000020 772000                    QRL     16
         4 005074   200120 756100                    STQ     I+2,,AUTO
         4 005075   200064 236100                    LDQ     PROJ_ACCT_LIST$,,AUTO
         4 005076   000020 772000                    QRL     16
         4 005077   200120 136100                    SBLQ    I+2,,AUTO
         4 005100   200003 756100                    STQ     ARS,,AUTO

     1435    17786    3      CALL ASB$WRITE_PROJ( DSEG2$, ARS ) ALTRET( WRITE_ERR2 );

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:253  
  17786  4 005101   200003 630500                    EPPR0   ARS,,AUTO
         4 005102   200121 450500                    STP0    I+3,,AUTO
         4 005103   000161 236000 5                  LDQ     113
         4 005104   200120 756100                    STQ     I+2,,AUTO
         4 005105   200120 630500                    EPPR0   I+2,,AUTO
         4 005106   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 005107   000000 701000 xent               TSX1    ASB$WRITE_PROJ
         4 005110   005112 702000 4                  TSX2    WRITE_ERR2

     1436    17787    4      DO WHILE( '0'B );

  17787  4 005111   005116 710000 4                  TRA     s:17792

     1437    17788    4   WRITE_ERR2: CALL ASH$ERROR( ERR_CODE );

  17788  4 005112   000001 630400 5     WRITE_ERR2   EPPR0   1
         4 005113   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005114   000000 701000 xent               TSX1    ASH$ERROR
         4 005115   000000 011000                    NOP     0

     1438    17789    4         END;

     1439    17790    3      END;

     1440    17791
     1441    17792    3   IF AS_PROJECT_ADMIN ~= AS_NONE THEN DO;

  17792  4 005116   000000 106400                    CMPC    fill='000'O
         4 005117   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 005120   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 005121   005140 600000 4                  TZE     s:17797

     1442    17793    3      CALL GET_PACKSET_LIST  ALTRET(EXIT#);

  17793  4 005122   010012 701000 4                  TSX1    GET_PACKSET_LIST
         4 005123   003647 702000 4                  TSX2    EXIT#

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:254  
     1443    17794    3      CALL ASA$TIE_PROJECT( CR_MOD_KEY, AS_PROJECT_ADMIN, PACKSET_COUNT,AS_FALSE );

  17794  4 005124   000035 236000 5                  LDQ     29
         4 005125   200123 756100                    STQ     I+5,,AUTO
         4 005126   200071 630500                    EPPR0   PACKSET_COUNT,,AUTO
         4 005127   200122 450500                    STP0    I+4,,AUTO
         4 005130   000102 236000 5                  LDQ     66
         4 005131   200121 756100                    STQ     I+3,,AUTO
         4 005132   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 005133   200120 451500                    STP1    I+2,,AUTO
         4 005134   200120 630500                    EPPR0   I+2,,AUTO
         4 005135   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 005136   000000 701000 xent               TSX1    ASA$TIE_PROJECT
         4 005137   000000 011000                    NOP     0

     1444    17795    3      END;

     1445    17796
     1446    17797    2   GOTO GET_PROJ_OPTIONS;

  17797  4 005140   004254 710000 4                  TRA     GET_PROJ_OPTIONS

     1447    17798
     1448    17799        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:255  
     1449    17800    2   MOD_PROJ_TO_USER: ENTRY;

  17800  4 005141   200050 741300       MOD_PROJ_TO* STX1  ! FREE_SEG_TYPE+1,,AUTO

     1450    17801
     1451    17802
     1452    17803    2   CREATE = '0'B; CR_MOD_FLG = '1'B;

  17803  4 005142   200065 450100                    STZ     CREATE,,AUTO

  17803  4 005143   400000 236003                    LDQ     -131072,DU
         4 005144   000000 756000 xsym               STQ     CR_MOD_FLG

     1453    17804    2   PROJ_FLAG = '0'B; FROM_FLG = '0'B;

  17804  4 005145   200066 450100                    STZ     PROJ_FLAG,,AUTO

  17804  4 005146   000000 450000 xsym               STZ     FROM_FLG

     1454    17805    2   IF AS_PROJECT_ADMIN = AS_NONE THEN

  17805  4 005147   000000 106400                    CMPC    fill='000'O
         4 005150   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 005151   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 005152   005155 601000 4                  TNZ     s:17808

     1455    17806    2      AS_CR_MOD_PROJ = 0;

  17806  4 005153   000000 450000 xsym               STZ     AS_CR_MOD_PROJ
         4 005154   005175 710000 4                  TRA     s:17814

     1456    17807    3   ELSE DO;

     1457    17808    3      AS_CR_MOD_PROJ = %CR_PROJ_USER;

  17808  4 005155   000001 235007                    LDA     1,DL
         4 005156   000000 755000 xsym               STA     AS_CR_MOD_PROJ
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:256  

     1458    17809    3      USERS_KEY = AS_PROJECT_ADMIN;

  17809  4 005157   000000 100400                    MLR     fill='000'O
         4 005160   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 005161   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1459    17810    3      CALL ASB$GET( AS_TRUE, , AS_PROJ_ADMIN, AS_PROJ_ADMIN_DREC$,

  17810  4 005162   000124 237000 5                  LDAQ    84
         4 005163   200124 757100                    STAQ    I+6,,AUTO
         4 005164   000126 237000 5                  LDAQ    86
         4 005165   200122 757100                    STAQ    I+4,,AUTO
         4 005166   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 005167   000036 235000 5                  LDA     30
         4 005170   200120 757100                    STAQ    I+2,,AUTO
         4 005171   200120 630500                    EPPR0   I+2,,AUTO
         4 005172   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 005173   000000 701000 xent               TSX1    ASB$GET
         4 005174   003647 702000 4                  TSX2    EXIT#

     1460    17811    3           AS_DEFAULT, AS_DEFAULT_DREC$ ) ALTRET(EXIT#);
     1461    17812    3      END;

     1462    17813
     1463    17814    2   PAR$ = P$NODE.SUBLK$(0);

  17814  4 005175   000000 470400 xsym               LDP0    NODE$
         4 005176   000003 236100                    LDQ     3,,PR0
         4 005177   200063 756100                    STQ     PAR$,,AUTO

     1464    17815    2   CALL ASB$KEYMAKER(CR_MOD_KEY, PAR$->P$NODE, PROJ_FLAG, CODE) ALTRET(EXIT#);

  17815  4 005200   000034 236000 5                  LDQ     28
         4 005201   200123 756100                    STQ     I+5,,AUTO
         4 005202   200066 631500                    EPPR1   PROJ_FLAG,,AUTO
         4 005203   200122 451500                    STP1    I+4,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:257  
         4 005204   200063 236100                    LDQ     PAR$,,AUTO
         4 005205   200121 756100                    STQ     I+3,,AUTO
         4 005206   200051 633500                    EPPR3   CR_MOD_KEY,,AUTO
         4 005207   200120 453500                    STP3    I+2,,AUTO
         4 005210   200120 630500                    EPPR0   I+2,,AUTO
         4 005211   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 005212   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 005213   003647 702000 4                  TSX2    EXIT#

     1465    17816
     1466    17817    2   USERS_KEY = CR_MOD_KEY;

  17817  4 005214   000000 100500                    MLR     fill='000'O
         4 005215   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 005216   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1467    17818    2   CALL ASB$GET( AS_TRUE, CODE, AS_PROJECT, AS_PROJECT_DREC$,

  17818  4 005217   000162 630400 5                  EPPR0   114
         4 005220   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 005221   000000 701000 xent               TSX1    ASB$GET
         4 005222   003647 702000 4                  TSX2    EXIT#

     1468    17819    2        AS_PROJECT_DFLT, AS_PROJECT_DFLT_DREC$ ) ALTRET(EXIT#);
     1469    17820
     1470    17821    3   IF AS_PROJECT_DFLT.BUDGET.PROJ_CREATED > 0 THEN DO;

  17821  4 005223   000011 235000 xsym               LDA     AS_PROJECT_DFLT+9
         4 005224   005247 604400 4                  TMOZ    s:17875

     1471    17822        /*E*  ERROR:  ASA-E$STILL_USERS-C
     1472    17823              MESSAGE: There are still %U1 users in project "%U2".
     1473    17824              MESSAGE1: Project "%U2" cannot be modified to a user while
     1474    17825                        there are still users remaining in the project.
     1475    17826        */
     1476    17827           %NUMBER( NUM1="AS_PROJECT_DFLT.BUDGET.PROJ_CREATED", SIGN1=YES );
             17837    3         CALL ASB$BINXCHAR( AS_FIELD1.TEXT, 0, -1, AS_PROJECT_DFLT.BUDGET.PROJ_CREATED
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:258  
             17837                  );

  17837  4 005225   000170 630400 5                  EPPR0   120
         4 005226   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 005227   000000 701000 xent               TSX1    ASB$BINXCHAR
         4 005230   000000 011000                    NOP     0

     1477    17857    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD2 );

  17857  4 005231   000174 236000 5                  LDQ     124
         4 005232   200121 756100                    STQ     I+3,,AUTO
         4 005233   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 005234   200120 450500                    STP0    I+2,,AUTO
         4 005235   200120 630500                    EPPR0   I+2,,AUTO
         4 005236   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 005237   000000 701000 xent               TSX1    ASA$KEYCONV
         4 005240   000000 011000                    NOP     0

     1478    17858           %SCREAM( ERR#=E$STILL_USERS, LEVEL=ERROR, MID='A' );

  17870  4 005241   000175 630400 5                  EPPR0   125
         4 005242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005243   000000 701000 xent               TSX1    ASH$ERROR
         4 005244   000000 011000                    NOP     0

     1479    17873    3      RETURN;

  17873  4 005245   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 005246   000001 702211                    TSX2  ! 1,X1

     1480    17874    3      END;
     1481    17875    3   IF AS_PROJECT_DFLT.BUDGET.SUB_PROJS > 0 THEN DO;

  17875  4 005247   000017 720000 xsym               LXL0    AS_PROJECT_DFLT+15
         4 005250   005305 604400 4                  TMOZ    s:17931

     1482    17876        /*E*  ERROR:  ASA-E$STILL_SUB_PROJS-C
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:259  
     1483    17877              MESSAGE: There are still %U1 sub-projects in project "%U2".
     1484    17878              MESSAGE1: Project "%U2" cannot be modified to a user while
     1485    17879                        there are still sub-projects remaining in the project.
     1486    17880        */
     1487    17881    3      I = AS_PROJECT_DFLT.BUDGET.SUB_PROJS;

  17881  4 005251   000017 236000 xsym               LDQ     AS_PROJECT_DFLT+15
         4 005252   000022 736000                    QLS     18
         4 005253   000022 732000                    QRS     18
         4 005254   200057 756100                    STQ     I,,AUTO

     1488    17882           %NUMBER( NUM1=I, SIGN1=YES );
             17892    3         CALL ASB$BINXCHAR( AS_FIELD1.TEXT, 0, -1, I );

  17892  4 005255   200057 630500                    EPPR0   I,,AUTO
         4 005256   200123 450500                    STP0    I+5,,AUTO
         4 005257   000051 236000 5                  LDQ     41
         4 005260   200122 756100                    STQ     I+4,,AUTO
         4 005261   000060 237000 5                  LDAQ    48
         4 005262   200120 757100                    STAQ    I+2,,AUTO
         4 005263   200120 630500                    EPPR0   I+2,,AUTO
         4 005264   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 005265   000000 701000 xent               TSX1    ASB$BINXCHAR
         4 005266   000000 011000                    NOP     0

     1489    17912    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD2 );

  17912  4 005267   000174 236000 5                  LDQ     124
         4 005270   200121 756100                    STQ     I+3,,AUTO
         4 005271   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 005272   200120 450500                    STP0    I+2,,AUTO
         4 005273   200120 630500                    EPPR0   I+2,,AUTO
         4 005274   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 005275   000000 701000 xent               TSX1    ASA$KEYCONV
         4 005276   000000 011000                    NOP     0

     1490    17913           %SCREAM( ERR#=E$STILL_SUB_PROJS, LEVEL=ERROR, MID='A' );
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:260  

  17925  4 005277   000176 630400 5                  EPPR0   126
         4 005300   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005301   000000 701000 xent               TSX1    ASH$ERROR
         4 005302   000000 011000                    NOP     0

     1491    17928    3      RETURN;

  17928  4 005303   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 005304   000001 702211                    TSX2  ! 1,X1

     1492    17929    3      END;
     1493    17930
     1494    17931    2   AS_DFLT = AS_DEFAULT;

  17931  4 005305   000000 100400                    MLR     fill='000'O
         4 005306   000000 004020 xsym               ADSC9   AS_DEFAULT               cn=0,n=2064
         4 005307   000000 004020 xsym               ADSC9   AS_DFLT                  cn=0,n=2064

     1495    17932    2   CALL CHECK_CREATE_OK(AS_PROJECT_ADMIN) ALTRET(EXIT#);

  17932  4 005310   000102 236000 5                  LDQ     66
         4 005311   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 005312   007430 701000 4                  TSX1    CHECK_CREATE_OK
         4 005313   003647 702000 4                  TSX2    EXIT#

     1496    17933    2   CALL INITIALIZATIONS  ALTRET(EXIT#);

  17933  4 005314   007326 701000 4                  TSX1    INITIALIZATIONS
         4 005315   003647 702000 4                  TSX2    EXIT#

     1497    17934    2   CALL GET_PACKSET_LIST  ALTRET(EXIT#);

  17934  4 005316   010012 701000 4                  TSX1    GET_PACKSET_LIST
         4 005317   003647 702000 4                  TSX2    EXIT#

     1498    17935
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:261  
     1499    17936    2   IF AS_PROJECT.BUDGET.MACCT ~= AS_NONE THEN

  17936  4 005320   000000 106400                    CMPC    fill='000'O
         4 005321   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21
         4 005322   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 005323   005351 600000 4                  TZE     s:17939

     1500    17937    2     CALL ASA$UNTIE_PROJECT( CR_MOD_KEY, PACKSET_COUNT, (AS_PROJECT_ADMIN~=AS_PROJECT.
             17937               BUDGET.MACCT) );

  17937  4 005324   400000 220003                    LDX0    -131072,DU
         4 005325   000000 106400                    CMPC    fill='000'O
         4 005326   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 005327   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21
         4 005330   005332 601000 4                  TNZ     s:17937+6
         4 005331   000000 220003                    LDX0    0,DU
         4 005332   000000 636010                    EAQ     0,X0
         4 005333   200120 676100                    ERQ     I+2,,AUTO
         4 005334   400000 376003                    ANQ     -131072,DU
         4 005335   200120 656100                    ERSQ    I+2,,AUTO
         4 005336   200120 630500                    EPPR0   I+2,,AUTO
         4 005337   200124 450500                    STP0    I+6,,AUTO
         4 005340   200071 631500                    EPPR1   PACKSET_COUNT,,AUTO
         4 005341   200123 451500                    STP1    I+5,,AUTO
         4 005342   200051 633500                    EPPR3   CR_MOD_KEY,,AUTO
         4 005343   200122 453500                    STP3    I+4,,AUTO
         4 005344   200122 630500                    EPPR0   I+4,,AUTO
         4 005345   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 005346   000000 701000 xent               TSX1    ASA$UNTIE_PROJECT
         4 005347   000000 011000                    NOP     0
         4 005350   005371 710000 4                  TRA     s:17944

     1501    17938    3   ELSE DO;

     1502    17939    3      USERS_KEY.COUNT = 21 + CR_MOD_KEY.CNT;

  17939  4 005351   200051 236100                    LDQ     CR_MOD_KEY,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:262  
         4 005352   000033 772000                    QRL     27
         4 005353   000025 036007                    ADLQ    21,DL
         4 005354   000033 736000                    QLS     27
         4 005355   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1503    17940    3     CALL CONCAT(USERS_KEY.TXTC, BINASC(1), AS_NONE.TEXT, (SUBSTR(CR_MOD_KEY.TEXT,0,20
             17940               )));

  17940  4 005356   000001 236003                    LDQ     1,DU
         4 005357   000000 552020 xsym               STBQ    USERS_KEY,'20'O
         4 005360   040000 100400                    MLR     fill='040'O
         4 005361   000000 200024 xsym               ADSC9   AS_NONE                  cn=1,n=20
         4 005362   000000 400024 xsym               ADSC9   USERS_KEY                cn=2,n=20
         4 005363   040000 100500                    MLR     fill='040'O
         4 005364   200051 200024                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=20
         4 005365   000005 400024 xsym               ADSC9   USERS_KEY+5              cn=2,n=20

     1504    17941    3      CALL ASB$DELREC_USERS;

  17941  4 005366   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 005367   000000 701000 xent               TSX1    ASB$DELREC_USERS
         4 005370   000000 011000                    NOP     0

     1505    17942    3      END;

     1506    17943
     1507    17944    2   AS_USERS                     = AS_PROJECT;

  17944  4 005371   000000 100400                    MLR     fill='000'O
         4 005372   000000 004020 xsym               ADSC9   AS_PROJECT               cn=0,n=2064
         4 005373   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064

     1508    17945    2   AS_USERS.BUDGET.MACCT        = AS_PROJECT_ADMIN;

  17945  4 005374   000000 100400                    MLR     fill='000'O
         4 005375   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 005376   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:263  

     1509    17946    2   AS_USERS.BUDGET.PMAXC        = AS_USERS_CONSTANT.BUDGET.PMAXC;

  17946  4 005377   000010 235000 xsym               LDA     AS_USERS_CONSTANT+8
         4 005400   000010 755000 xsym               STA     AS_USERS+8

     1510    17947    2   AS_USERS.BUDGET.PACCUM       = AS_USERS_CONSTANT.BUDGET.PACCUM;

  17947  4 005401   000011 236000 xsym               LDQ     AS_USERS_CONSTANT+9
         4 005402   000011 756000 xsym               STQ     AS_USERS+9

     1511    17948    2   AS_USERS.BUDGET.MAX_PROJECTS = AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS;

  17948  4 005403   000017 720000 xsym               LXL0    AS_USERS_CONSTANT+15
         4 005404   000017 440000 xsym               SXL0    AS_USERS+15

     1512    17949    3   DO I = 0 TO SIZEW(AS_USERS.PPRIV)-1;

  17949  4 005405   200057 450100                    STZ     I,,AUTO
         4 005406   005415 710000 4                  TRA     s:17951+1

     1513    17950    3      AS_USERS.PPRIV(I) = AS_USERS.PPRIV(I) & ~%PPR_PADMIN#;

  17950  4 005407   000026 236000 xsym               LDQ     B_VECTNIL+22
         4 005410   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 005411   200057 720100                    LXL0    I,,AUTO
         4 005412   000231 376010 xsym               ANQ     AS_USERS+153,X0
         4 005413   000231 756010 xsym               STQ     AS_USERS+153,X0

     1514    17951    3      END;

  17951  4 005414   200057 054100                    AOS     I,,AUTO
         4 005415   200057 235100                    LDA     I,,AUTO
         4 005416   000003 115007                    CMPA    3,DL
         4 005417   005407 604400 4                  TMOZ    s:17950

     1515    17952        /*E*  ERROR:  ASA-E$PROJ_TO_USER-C
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:264  
     1516    17953              MESSAGE:.. Project "%U1" modified to user "%U1".
     1517    17954        */
     1518    17955    2   CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD1 );

  17955  4 005420   000103 236000 5                  LDQ     67
         4 005421   200121 756100                    STQ     I+3,,AUTO
         4 005422   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 005423   200120 450500                    STP0    I+2,,AUTO
         4 005424   200120 630500                    EPPR0   I+2,,AUTO
         4 005425   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 005426   000000 701000 xent               TSX1    ASA$KEYCONV
         4 005427   000000 011000                    NOP     0

     1519    17956        %SCREAM( ERR#=E$PROJ_TO_USER, MID='A', LEVEL=INFO );

  17964  4 005430   000177 630400 5                  EPPR0   127
         4 005431   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005432   000000 701000 xent               TSX1    ASH$INFO
         4 005433   000000 011000                    NOP     0

     1520    17971
     1521    17972    3   IF AS_PROJECT_ADMIN ~= AS_NONE THEN DO;

  17972  4 005434   000000 106400                    CMPC    fill='000'O
         4 005435   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 005436   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 005437   005610 600000 4                  TZE     s:17995

     1522    17973    3      PROJ_KEY = CR_MOD_KEY;

  17973  4 005440   000000 100500                    MLR     fill='000'O
         4 005441   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 005442   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27

     1523    17974    3      CALL ASB$PREC_PROJ;

  17974  4 005443   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:265  
         4 005444   000000 701000 xent               TSX1    ASB$PREC_PROJ
         4 005445   000000 011000                    NOP     0

     1524    17975    3      ACCT_COUNT = 0;

  17975  4 005446   200072 450100                    STZ     ACCT_COUNT,,AUTO

     1525    17976    3      ARS = DSEG2SIZE;

  17976  4 005447   000000 235000 xsym               LDA     DSEG2SIZE
         4 005450   200003 755100                    STA     ARS,,AUTO

     1526    17977    3      CALL ASB$READ_PROJ_SEQ( DSEG2$, ARS, 2 ) ALTRET(DONE);

  17977  4 005451   000013 236000 5                  LDQ     11
         4 005452   200122 756100                    STQ     I+4,,AUTO
         4 005453   200003 630500                    EPPR0   ARS,,AUTO
         4 005454   200121 450500                    STP0    I+3,,AUTO
         4 005455   000161 236000 5                  LDQ     113
         4 005456   200120 756100                    STQ     I+2,,AUTO
         4 005457   200120 630500                    EPPR0   I+2,,AUTO
         4 005460   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 005461   000000 701000 xent               TSX1    ASB$READ_PROJ_SEQ
         4 005462   005565 702000 4                  TSX2    DONE

     1527    17978    4      DO WHILE( PROJ_KEY.TXT.PROJECT = (SUBSTR(CR_MOD_KEY.TEXT,0,20)) );

  17978  4 005463   005561 710000 4                  TRA     s:17989

     1528    17979    4         PROJ_ACCT_LIST$ = PINCRW( ADDR(AS$PROJ.ATTRIBUTES),

  17979  4 005464   000000 470400 xsym               LDP0    DSEG2$
         4 005465   000014 236100                    LDQ     12,,PR0
         4 005466   000022 772000                    QRL     18
         4 005467   000005 036007                    ADLQ    5,DL
         4 005470   000002 772000                    QRL     2
         4 005471   000022 736000                    QLS     18
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:266  
         4 005472   000014 036003                    ADLQ    12,DU
         4 005473   000000 036000 xsym               ADLQ    DSEG2$
         4 005474   200064 756100                    STQ     PROJ_ACCT_LIST$,,AUTO

     1529    17980    4              (AS$PROJ.ATTRIBUTES.COUNT+5) / 4 );
     1530    17981    5         DO J = 0 TO AS$PROJ.NUM_ACCTS-1;

  17981  4 005475   200060 450100                    STZ     J,,AUTO
         4 005476   005541 710000 4                  TRA     s:17986+1

     1531    17982    5           ACCT$LIST.PSN(ACCT_COUNT) = SUBSTR(PROJ_KEY.TXT.PACKSET,0,PROJ_KEY.COUNT-20
             17982                     );

  17982  4 005477   200072 236100                    LDQ     ACCT_COUNT,,AUTO
         4 005500   000005 402007                    MPY     5,DL
         4 005501   000000 620006                    EAX0    0,QL
         4 005502   000000 236000 xsym               LDQ     PROJ_KEY
         4 005503   000033 772000                    QRL     27
         4 005504   777754 621006                    EAX1    -20,QL
         4 005505   000000 635010                    EAA     0,X0
         4 005506   000020 731000                    ARS     16
         4 005507   000000 470400 xsym               LDP0    DSEG1$
         4 005510   040105 100440                    MLR     fill='040'O
         4 005511   000005 200011 xsym               ADSC9   PROJ_KEY+5               cn=1,n=*X1
         4 005512   000000 000006                    ADSC9   0,A,PR0                  cn=0,n=6

     1532    17983    5            ACCT$LIST.ACCT(ACCT_COUNT) = PROJ$LIST.ACCT(J);

  17983  4 005513   200072 236100                    LDQ     ACCT_COUNT,,AUTO
         4 005514   000005 402007                    MPY     5,DL
         4 005515   000000 620006                    EAX0    0,QL
         4 005516   200060 236100                    LDQ     J,,AUTO
         4 005517   000014 402007                    MPY     12,DL
         4 005520   000000 635010                    EAA     0,X0
         4 005521   000020 731000                    ARS     16
         4 005522   200064 470500                    LDP0    PROJ_ACCT_LIST$,,AUTO
         4 005523   000000 471400 xsym               LDP1    DSEG1$
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:267  
         4 005524   040105 100506                    MLR     fill='040'O
         4 005525   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         4 005526   100001 400010                    ADSC9   1,A,PR1                  cn=2,n=8

     1533    17984    5            ACCT$LIST.GRANS(ACCT_COUNT) = PROJ$LIST.GRANS(J);

  17984  4 005527   200072 236100                    LDQ     ACCT_COUNT,,AUTO
         4 005530   000005 402007                    MPY     5,DL
         4 005531   000000 620006                    EAX0    0,QL
         4 005532   200060 236100                    LDQ     J,,AUTO
         4 005533   000003 402007                    MPY     3,DL
         4 005534   000000 471400 xsym               LDP1    DSEG1$
         4 005535   000002 235106                    LDA     2,QL,PR0
         4 005536   100004 755110                    STA     4,X0,PR1

     1534    17985    5            ACCT_COUNT = ACCT_COUNT + 1;

  17985  4 005537   200072 054100                    AOS     ACCT_COUNT,,AUTO

     1535    17986    5            END;

  17986  4 005540   200060 054100                    AOS     J,,AUTO
         4 005541   000000 470400 xsym               LDP0    DSEG2$
         4 005542   200060 236100                    LDQ     J,,AUTO
         4 005543   000013 116100                    CMPQ    11,,PR0
         4 005544   005477 604000 4                  TMI     s:17982

     1536    17987    4         ARS = DSEG2SIZE;

  17987  4 005545   000000 235000 xsym               LDA     DSEG2SIZE
         4 005546   200003 755100                    STA     ARS,,AUTO

     1537    17988    4         CALL ASB$READ_PROJ_SEQ( DSEG2$, ARS, 2 ) ALTRET(DONE);

  17988  4 005547   000013 236000 5                  LDQ     11
         4 005550   200122 756100                    STQ     I+4,,AUTO
         4 005551   200003 631500                    EPPR1   ARS,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:268  
         4 005552   200121 451500                    STP1    I+3,,AUTO
         4 005553   000161 236000 5                  LDQ     113
         4 005554   200120 756100                    STQ     I+2,,AUTO
         4 005555   200120 630500                    EPPR0   I+2,,AUTO
         4 005556   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 005557   000000 701000 xent               TSX1    ASB$READ_PROJ_SEQ
         4 005560   005565 702000 4                  TSX2    DONE

     1538    17989    4         END;

  17989  4 005561   040100 106400                    CMPC    fill='040'O
         4 005562   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20
         4 005563   200051 200024                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=20
         4 005564   005464 600000 4                  TZE     s:17979

     1539    17990    3   DONE: AS_DFLT = AS_DEFAULT;

  17990  4 005565   000000 100400       DONE         MLR     fill='000'O
         4 005566   000000 004020 xsym               ADSC9   AS_DEFAULT               cn=0,n=2064
         4 005567   000000 004020 xsym               ADSC9   AS_DFLT                  cn=0,n=2064

     1540    17991    3      KL_DFLT = AS_DEFAULT_DREC;

  17991  4 005570   000000 100400                    MLR     fill='000'O
         4 005571   000000 001244 xsym               ADSC9   AS_DEFAULT_DREC          cn=0,n=676
         4 005572   000000 001244 xsym               ADSC9   KL_DFLT                  cn=0,n=676

     1541    17992    3      CALL ASA$TIE_USER( CR_MOD_KEY, AS_PROJECT_ADMIN, ACCT_COUNT,AS_FALSE);

  17992  4 005573   000035 236000 5                  LDQ     29
         4 005574   200123 756100                    STQ     I+5,,AUTO
         4 005575   200072 630500                    EPPR0   ACCT_COUNT,,AUTO
         4 005576   200122 450500                    STP0    I+4,,AUTO
         4 005577   000102 236000 5                  LDQ     66
         4 005600   200121 756100                    STQ     I+3,,AUTO
         4 005601   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 005602   200120 451500                    STP1    I+2,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:269  
         4 005603   200120 630500                    EPPR0   I+2,,AUTO
         4 005604   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 005605   000000 701000 xent               TSX1    ASA$TIE_USER
         4 005606   000000 011000                    NOP     0

     1542    17993    3      END;

  17993  4 005607   005656 710000 4                  TRA     s:18007

     1543    17994    3   ELSE DO;

     1544    17995    3      USERS_KEY.COUNT = 21;

  17995  4 005610   025000 236003                    LDQ     10752,DU
         4 005611   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1545    17996    3      CALL CONCAT( USERS_KEY.TXTC, (SUBSTR(CR_MOD_KEY.TEXT,0,20)), 'S' );

  17996  4 005612   040000 100500                    MLR     fill='040'O
         4 005613   200051 200024                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=20
         4 005614   000000 200024 xsym               ADSC9   USERS_KEY                cn=1,n=20
         4 005615   040000 100400                    MLR     fill='040'O
         4 005616   000077 000001 5                  ADSC9   63                       cn=0,n=1
         4 005617   000005 200025 xsym               ADSC9   USERS_KEY+5              cn=1,n=21

     1546    17997    3      CALL ASB$DELREC_USERS;

  17997  4 005620   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 005621   000000 701000 xent               TSX1    ASB$DELREC_USERS
         4 005622   000000 011000                    NOP     0

     1547    17998    3      PROJ_KEY = CR_MOD_KEY;

  17998  4 005623   000000 100500                    MLR     fill='000'O
         4 005624   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 005625   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:270  
     1548    17999    4      DO I = 0 TO PACKSET_COUNT-1;

  17999  4 005626   200057 450100                    STZ     I,,AUTO
         4 005627   005653 710000 4                  TRA     s:18004+1

     1549    18000    4         PROJ_KEY.TXT.PACKSET = PACKSET$LIST.PSN(I);

  18000  4 005630   200057 236100                    LDQ     I,,AUTO
         4 005631   000070 402007                    MPY     56,DL
         4 005632   000000 470400 xsym               LDP0    DSEG1$
         4 005633   040000 100506                    MLR     fill='040'O
         4 005634   000014 000006                    ADSC9   12,Q,PR0                 cn=0,n=6
         4 005635   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

     1550    18001    4         CALL INDEX( J, AS_BLANK, PROJ_KEY.TEXT, 20 );

  18001  4 005636   000000 124400                    SCM     mask='000'O
         4 005637   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         4 005640   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 005641   200060 000100                    ARG     J,,AUTO
         4 005642   000024 236007                    LDQ     20,DL
         4 005643   200060 056100                    ASQ     J,,AUTO

     1551    18002    4         PROJ_KEY.COUNT = J;

  18002  4 005644   200060 236100                    LDQ     J,,AUTO
         4 005645   000033 736000                    QLS     27
         4 005646   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

     1552    18003    4         CALL ASB$DELREC_PROJ;

  18003  4 005647   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 005650   000000 701000 xent               TSX1    ASB$DELREC_PROJ
         4 005651   000000 011000                    NOP     0

     1553    18004    4         END;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:271  
  18004  4 005652   200057 054100                    AOS     I,,AUTO
         4 005653   200057 236100                    LDQ     I,,AUTO
         4 005654   200071 116100                    CMPQ    PACKSET_COUNT,,AUTO
         4 005655   005630 604000 4                  TMI     s:18000

     1554    18005    3      END;

     1555    18006
     1556    18007    2   GOTO GET_USER_OPTIONS;

  18007  4 005656   003324 710000 4                  TRA     GET_USER_OPTIONS

     1557    18008
     1558    18009        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:272  
     1559    18010    2   UNTIE_USER: ENTRY;

  18010  4 005657   200050 741300       UNTIE_USER   STX1  ! FREE_SEG_TYPE+1,,AUTO

     1560    18011
     1561    18012
     1562    18013    2   CREATE = '0'B; PROJ_FLAG = '0'B;

  18013  4 005660   200065 450100                    STZ     CREATE,,AUTO

  18013  4 005661   200066 450100                    STZ     PROJ_FLAG,,AUTO

     1563    18014    2   PAR$ = P$NODE.SUBLK$(0);

  18014  4 005662   000000 470400 xsym               LDP0    NODE$
         4 005663   000003 236100                    LDQ     3,,PR0
         4 005664   200063 756100                    STQ     PAR$,,AUTO

     1564    18015    2   CALL ASB$KEYMAKER(CR_MOD_KEY, PAR$->P$NODE, AS_FALSE, CODE) ALTRET(EXIT#);

  18015  4 005665   000152 237000 5                  LDAQ    106
         4 005666   200122 757100                    STAQ    I+4,,AUTO
         4 005667   200063 236100                    LDQ     PAR$,,AUTO
         4 005670   200121 756100                    STQ     I+3,,AUTO
         4 005671   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 005672   200120 451500                    STP1    I+2,,AUTO
         4 005673   200120 630500                    EPPR0   I+2,,AUTO
         4 005674   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 005675   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 005676   003647 702000 4                  TSX2    EXIT#

     1565    18016    2   USERS_KEY = CR_MOD_KEY;

  18016  4 005677   000000 100500                    MLR     fill='000'O
         4 005700   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 005701   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:273  
     1566    18017    2   CALL ASB$GET(AS_FALSE, CODE, AS_USERS) ALTRET(EXIT#);

  18017  4 005702   000154 630400 5                  EPPR0   108
         4 005703   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 005704   000000 701000 xent               TSX1    ASB$GET
         4 005705   003647 702000 4                  TSX2    EXIT#

     1567    18018    3   IF AS_USERS.BUDGET.MACCT = AS_NONE THEN DO;

  18018  4 005706   000000 106400                    CMPC    fill='000'O
         4 005707   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 005710   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 005711   005730 601000 4                  TNZ     s:18042

     1568    18019        /*E*  ERROR:  ASA-E$NOT_PROJ_USER-C
     1569    18020              MESSAGE: "%U1" is not a member of a project.
     1570    18021              MESSAGE1: Only members of a project can be UNTIEd.
     1571    18022                        "%U1" is not a member of a project.
     1572    18023        */
     1573    18024    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD1 );

  18024  4 005712   000103 236000 5                  LDQ     67
         4 005713   200121 756100                    STQ     I+3,,AUTO
         4 005714   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 005715   200120 450500                    STP0    I+2,,AUTO
         4 005716   200120 630500                    EPPR0   I+2,,AUTO
         4 005717   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 005720   000000 701000 xent               TSX1    ASA$KEYCONV
         4 005721   000000 011000                    NOP     0

     1574    18025           %SCREAM( ERR#=E$NOT_PROJ_USER, MID='A', LEVEL=ERROR );

  18037  4 005722   000200 630400 5                  EPPR0   128
         4 005723   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005724   000000 701000 xent               TSX1    ASH$ERROR
         4 005725   000000 011000                    NOP     0

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:274  
     1575    18040    3      RETURN;

  18040  4 005726   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 005727   000001 702211                    TSX2  ! 1,X1

     1576    18041    3      END;
     1577    18042    3   IF AS_USERS.BUDGET.MACCT = AS_PROJECT_ADMIN THEN DO;

  18042  4 005730   000000 106400                    CMPC    fill='000'O
         4 005731   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 005732   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 005733   005750 601000 4                  TNZ     s:18046

     1578    18043    3      CALL ASA$ERROR( CR_MOD_KEY, 392 /* Proj admin cant UNTIE from his proj */,
             18043               AS_FALSE );

  18043  4 005734   000035 236000 5                  LDQ     29
         4 005735   200122 756100                    STQ     I+4,,AUTO
         4 005736   000202 236000 5                  LDQ     130
         4 005737   200121 756100                    STQ     I+3,,AUTO
         4 005740   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 005741   200120 450500                    STP0    I+2,,AUTO
         4 005742   200120 630500                    EPPR0   I+2,,AUTO
         4 005743   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 005744   000000 701000 xent               TSX1    ASA$ERROR
         4 005745   000000 011000                    NOP     0

     1579    18044    3      RETURN;

  18044  4 005746   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 005747   000001 702211                    TSX2  ! 1,X1

     1580    18045    3      END;
     1581    18046    3   IF AS_PROJECT_ADMIN ~= AS_NONE THEN DO;

  18046  4 005750   000000 106400                    CMPC    fill='000'O
         4 005751   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:275  
         4 005752   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 005753   006001 600000 4                  TZE     s:18052

     1582    18047    3      CALL CONCAT( USERS_KEY.TXTC, AS_PROJECT_ADMIN.TEXT, 'S' );

  18047  4 005754   040000 100400                    MLR     fill='040'O
         4 005755   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 005756   000000 200024 xsym               ADSC9   USERS_KEY                cn=1,n=20
         4 005757   040000 100400                    MLR     fill='040'O
         4 005760   000077 000001 5                  ADSC9   63                       cn=0,n=1
         4 005761   000005 200025 xsym               ADSC9   USERS_KEY+5              cn=1,n=21

     1583    18048    3      USERS_KEY.COUNT = 21;

  18048  4 005762   025000 236003                    LDQ     10752,DU
         4 005763   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1584    18049    3      CALL ASB$GET( AS_FALSE, ,AS_DFLT ) ALTRET(EXIT#);

  18049  4 005764   000100 236000 5                  LDQ     64
         4 005765   200122 756100                    STQ     I+4,,AUTO
         4 005766   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 005767   000035 235000 5                  LDA     29
         4 005770   200120 757100                    STAQ    I+2,,AUTO
         4 005771   200120 630500                    EPPR0   I+2,,AUTO
         4 005772   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 005773   000000 701000 xent               TSX1    ASB$GET
         4 005774   003647 702000 4                  TSX2    EXIT#

     1585    18050    3      CALL CHECK_CREATE_OK(AS_PROJECT_ADMIN) ALTRET(EXIT#);

  18050  4 005775   000102 236000 5                  LDQ     66
         4 005776   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 005777   007430 701000 4                  TSX1    CHECK_CREATE_OK
         4 006000   003647 702000 4                  TSX2    EXIT#

     1586    18051    3      END;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:276  

     1587    18052    2   CALL INITIALIZATIONS ALTRET( EXIT# );

  18052  4 006001   007326 701000 4                  TSX1    INITIALIZATIONS
         4 006002   003647 702000 4                  TSX2    EXIT#

     1588    18053    2   CALL GET_ACCT_LIST(1) ALTRET(EXIT#);

  18053  4 006003   000007 236000 5                  LDQ     7
         4 006004   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 006005   010321 701000 4                  TSX1    GET_ACCT_LIST
         4 006006   003647 702000 4                  TSX2    EXIT#

     1589    18054    2   USERS_KEY = AS_USERS.BUDGET.MACCT;

  18054  4 006007   000000 100400                    MLR     fill='000'O
         4 006010   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 006011   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1590    18055    2   CALL ASB$GET(AS_TRUE,,AS_PROJ_ADMIN,,AS_DEFAULT) ALTRET(EXIT#);

  18055  4 006012   000124 236000 5                  LDQ     84
         4 006013   200124 756100                    STQ     I+6,,AUTO
         4 006014   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006015   000126 235000 5                  LDA     86
         4 006016   200122 757100                    STAQ    I+4,,AUTO
         4 006017   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006020   000036 235000 5                  LDA     30
         4 006021   200120 757100                    STAQ    I+2,,AUTO
         4 006022   200120 630500                    EPPR0   I+2,,AUTO
         4 006023   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 006024   000000 701000 xent               TSX1    ASB$GET
         4 006025   003647 702000 4                  TSX2    EXIT#

     1591    18056    2   CALL ASA$UNTIE_USER( CR_MOD_KEY, ACCT_COUNT, AS_TRUE );

  18056  4 006026   000036 236000 5                  LDQ     30
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:277  
         4 006027   200122 756100                    STQ     I+4,,AUTO
         4 006030   200072 630500                    EPPR0   ACCT_COUNT,,AUTO
         4 006031   200121 450500                    STP0    I+3,,AUTO
         4 006032   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 006033   200120 451500                    STP1    I+2,,AUTO
         4 006034   200120 630500                    EPPR0   I+2,,AUTO
         4 006035   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 006036   000000 701000 xent               TSX1    ASA$UNTIE_USER
         4 006037   000000 011000                    NOP     0

     1592    18057    2   IF AS_PROJECT_ADMIN ~= AS_NONE THEN

  18057  4 006040   000000 106400                    CMPC    fill='000'O
         4 006041   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 006042   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 006043   006061 600000 4                  TZE     s:18060

     1593    18058    2      CALL ASA$TIE_USER( CR_MOD_KEY, AS_PROJECT_ADMIN, ACCT_COUNT, AS_FALSE );

  18058  4 006044   000035 236000 5                  LDQ     29
         4 006045   200123 756100                    STQ     I+5,,AUTO
         4 006046   200072 630500                    EPPR0   ACCT_COUNT,,AUTO
         4 006047   200122 450500                    STP0    I+4,,AUTO
         4 006050   000102 236000 5                  LDQ     66
         4 006051   200121 756100                    STQ     I+3,,AUTO
         4 006052   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 006053   200120 451500                    STP1    I+2,,AUTO
         4 006054   200120 630500                    EPPR0   I+2,,AUTO
         4 006055   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 006056   000000 701000 xent               TSX1    ASA$TIE_USER
         4 006057   000000 011000                    NOP     0
         4 006060   006070 710000 4                  TRA     s:18063

     1594    18059    3   ELSE DO;

     1595    18060    3      USERS_KEY = CR_MOD_KEY;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:278  
  18060  4 006061   000000 100500                    MLR     fill='000'O
         4 006062   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 006063   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1596    18061    3      CALL ASB$WRITE_USERS( AS_USERS );

  18061  4 006064   000104 630400 5                  EPPR0   68
         4 006065   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 006066   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 006067   000000 011000                    NOP     0

     1597    18062    3      END;

     1598    18063    2   IF ACCT_COUNT > 0 THEN CALL ASB$DEQ_PROJ;

  18063  4 006070   200072 235100                    LDA     ACCT_COUNT,,AUTO
         4 006071   006075 604400 4                  TMOZ    s:18064

  18063  4 006072   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 006073   000000 701000 xent               TSX1    ASB$DEQ_PROJ
         4 006074   000000 011000                    NOP     0

     1599    18064    2   RETURN;

  18064  4 006075   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 006076   000001 702211                    TSX2  ! 1,X1

     1600    18065
     1601    18066        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:279  
     1602    18067    2   UNTIE_PROJ: ENTRY;

  18067  4 006077   200050 741300       UNTIE_PROJ   STX1  ! FREE_SEG_TYPE+1,,AUTO

     1603    18068
     1604    18069
     1605    18070    2   CREATE = '0'B; PROJ_FLAG = '1'B;

  18070  4 006100   200065 450100                    STZ     CREATE,,AUTO

  18070  4 006101   400000 236003                    LDQ     -131072,DU
         4 006102   200066 756100                    STQ     PROJ_FLAG,,AUTO

     1606    18071    2   PAR$ = P$NODE.SUBLK$(0);

  18071  4 006103   000000 470400 xsym               LDP0    NODE$
         4 006104   000003 236100                    LDQ     3,,PR0
         4 006105   200063 756100                    STQ     PAR$,,AUTO

     1607    18072    2   CALL ASB$KEYMAKER(CR_MOD_KEY, PAR$->P$NODE, AS_TRUE, CODE) ALTRET(EXIT#);

  18072  4 006106   000162 237000 5                  LDAQ    114
         4 006107   200122 757100                    STAQ    I+4,,AUTO
         4 006110   200063 236100                    LDQ     PAR$,,AUTO
         4 006111   200121 756100                    STQ     I+3,,AUTO
         4 006112   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 006113   200120 451500                    STP1    I+2,,AUTO
         4 006114   200120 630500                    EPPR0   I+2,,AUTO
         4 006115   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 006116   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 006117   003647 702000 4                  TSX2    EXIT#

     1608    18073    2   USERS_KEY = CR_MOD_KEY;

  18073  4 006120   000000 100500                    MLR     fill='000'O
         4 006121   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 006122   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:280  

     1609    18074    2   CALL ASB$GET(AS_TRUE,CODE,AS_PROJECT,,AS_PROJECT_DFLT) ALTRET(EXIT#);

  18074  4 006123   000130 236000 5                  LDQ     88
         4 006124   200124 756100                    STQ     I+6,,AUTO
         4 006125   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006126   000132 235000 5                  LDA     90
         4 006127   200122 757100                    STAQ    I+4,,AUTO
         4 006130   000162 237000 5                  LDAQ    114
         4 006131   200120 757100                    STAQ    I+2,,AUTO
         4 006132   200120 630500                    EPPR0   I+2,,AUTO
         4 006133   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 006134   000000 701000 xent               TSX1    ASB$GET
         4 006135   003647 702000 4                  TSX2    EXIT#

     1610    18075    3   IF AS_PROJECT.BUDGET.MACCT = AS_NONE THEN DO;

  18075  4 006136   000000 106400                    CMPC    fill='000'O
         4 006137   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21
         4 006140   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 006141   006160 601000 4                  TNZ     s:18099

     1611    18076        /*E*  ERROR:  ASA-E$NOT_SUB_PROJ-C
     1612    18077              MESSAGE: "%U1" is not a sub-project.
     1613    18078              MESSAGE1: Only sub-projects can be UNTIEd.
     1614    18079                        "%U1" is not a sub-project of another project.
     1615    18080        */
     1616    18081    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD1 );

  18081  4 006142   000103 236000 5                  LDQ     67
         4 006143   200121 756100                    STQ     I+3,,AUTO
         4 006144   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 006145   200120 450500                    STP0    I+2,,AUTO
         4 006146   200120 630500                    EPPR0   I+2,,AUTO
         4 006147   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 006150   000000 701000 xent               TSX1    ASA$KEYCONV
         4 006151   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:281  

     1617    18082           %SCREAM( ERR#=E$NOT_SUB_PROJ, MID='A', LEVEL=ERROR );

  18094  4 006152   000203 630400 5                  EPPR0   131
         4 006153   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 006154   000000 701000 xent               TSX1    ASH$ERROR
         4 006155   000000 011000                    NOP     0

     1618    18097    3      RETURN;

  18097  4 006156   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 006157   000001 702211                    TSX2  ! 1,X1

     1619    18098    3      END;
     1620    18099    3   IF AS_PROJECT.BUDGET.MACCT = AS_PROJECT_ADMIN THEN DO;

  18099  4 006160   000000 106400                    CMPC    fill='000'O
         4 006161   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21
         4 006162   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 006163   006200 601000 4                  TNZ     s:18103

     1621    18100    3      CALL ASA$ERROR( CR_MOD_KEY, 392 /* Proj admin cant UNTIE from his proj */,
             18100               AS_TRUE );

  18100  4 006164   000036 236000 5                  LDQ     30
         4 006165   200122 756100                    STQ     I+4,,AUTO
         4 006166   000202 236000 5                  LDQ     130
         4 006167   200121 756100                    STQ     I+3,,AUTO
         4 006170   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 006171   200120 450500                    STP0    I+2,,AUTO
         4 006172   200120 630500                    EPPR0   I+2,,AUTO
         4 006173   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 006174   000000 701000 xent               TSX1    ASA$ERROR
         4 006175   000000 011000                    NOP     0

     1622    18101    3      RETURN;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:282  
  18101  4 006176   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 006177   000001 702211                    TSX2  ! 1,X1

     1623    18102    3      END;
     1624    18103    3   IF AS_PROJECT_ADMIN ~= AS_NONE THEN DO;

  18103  4 006200   000000 106400                    CMPC    fill='000'O
         4 006201   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 006202   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 006203   006227 600000 4                  TZE     s:18108

     1625    18104    3      USERS_KEY = AS_PROJECT_ADMIN;

  18104  4 006204   000000 100400                    MLR     fill='000'O
         4 006205   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 006206   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1626    18105    3      CALL ASB$GET( AS_TRUE, , AS_PROJ_ADMIN, , AS_DEFAULT ) ALTRET(EXIT#);

  18105  4 006207   000124 236000 5                  LDQ     84
         4 006210   200124 756100                    STQ     I+6,,AUTO
         4 006211   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006212   000126 235000 5                  LDA     86
         4 006213   200122 757100                    STAQ    I+4,,AUTO
         4 006214   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006215   000036 235000 5                  LDA     30
         4 006216   200120 757100                    STAQ    I+2,,AUTO
         4 006217   200120 630500                    EPPR0   I+2,,AUTO
         4 006220   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 006221   000000 701000 xent               TSX1    ASB$GET
         4 006222   003647 702000 4                  TSX2    EXIT#

     1627    18106    3      CALL CHECK_CREATE_OK(AS_PROJECT_ADMIN) ALTRET(EXIT#);

  18106  4 006223   000102 236000 5                  LDQ     66
         4 006224   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 006225   007430 701000 4                  TSX1    CHECK_CREATE_OK
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:283  
         4 006226   003647 702000 4                  TSX2    EXIT#

     1628    18107    3      END;

     1629    18108    2   CALL INITIALIZATIONS ALTRET( EXIT# );

  18108  4 006227   007326 701000 4                  TSX1    INITIALIZATIONS
         4 006230   003647 702000 4                  TSX2    EXIT#

     1630    18109    2   CALL GET_PACKSET_LIST  ALTRET(EXIT#);

  18109  4 006231   010012 701000 4                  TSX1    GET_PACKSET_LIST
         4 006232   003647 702000 4                  TSX2    EXIT#

     1631    18110    2   USERS_KEY = AS_PROJECT.BUDGET.MACCT;

  18110  4 006233   000000 100400                    MLR     fill='000'O
         4 006234   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21
         4 006235   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1632    18111    2   CALL ASB$GET(AS_TRUE,,AS_PROJ_ADMIN,,AS_DEFAULT) ALTRET(EXIT#);

  18111  4 006236   000124 236000 5                  LDQ     84
         4 006237   200124 756100                    STQ     I+6,,AUTO
         4 006240   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006241   000126 235000 5                  LDA     86
         4 006242   200122 757100                    STAQ    I+4,,AUTO
         4 006243   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006244   000036 235000 5                  LDA     30
         4 006245   200120 757100                    STAQ    I+2,,AUTO
         4 006246   200120 630500                    EPPR0   I+2,,AUTO
         4 006247   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 006250   000000 701000 xent               TSX1    ASB$GET
         4 006251   003647 702000 4                  TSX2    EXIT#

     1633    18112    2   CALL ASA$UNTIE_PROJECT( CR_MOD_KEY, PACKSET_COUNT, AS_TRUE );

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:284  
  18112  4 006252   000036 236000 5                  LDQ     30
         4 006253   200122 756100                    STQ     I+4,,AUTO
         4 006254   200071 630500                    EPPR0   PACKSET_COUNT,,AUTO
         4 006255   200121 450500                    STP0    I+3,,AUTO
         4 006256   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 006257   200120 451500                    STP1    I+2,,AUTO
         4 006260   200120 630500                    EPPR0   I+2,,AUTO
         4 006261   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 006262   000000 701000 xent               TSX1    ASA$UNTIE_PROJECT
         4 006263   000000 011000                    NOP     0

     1634    18113    2   IF AS_PROJECT_ADMIN ~= AS_NONE THEN

  18113  4 006264   000000 106400                    CMPC    fill='000'O
         4 006265   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 006266   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 006267   006305 600000 4                  TZE     s:18116

     1635    18114    2      CALL ASA$TIE_PROJECT( CR_MOD_KEY, AS_PROJECT_ADMIN, PACKSET_COUNT, AS_FALSE );

  18114  4 006270   000035 236000 5                  LDQ     29
         4 006271   200123 756100                    STQ     I+5,,AUTO
         4 006272   200071 630500                    EPPR0   PACKSET_COUNT,,AUTO
         4 006273   200122 450500                    STP0    I+4,,AUTO
         4 006274   000102 236000 5                  LDQ     66
         4 006275   200121 756100                    STQ     I+3,,AUTO
         4 006276   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 006277   200120 451500                    STP1    I+2,,AUTO
         4 006300   200120 630500                    EPPR0   I+2,,AUTO
         4 006301   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 006302   000000 701000 xent               TSX1    ASA$TIE_PROJECT
         4 006303   000000 011000                    NOP     0
         4 006304   006344 710000 4                  TRA     s:18127

     1636    18115    3   ELSE DO;

     1637    18116    3      USERS_KEY = CR_MOD_KEY;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:285  

  18116  4 006305   000000 100500                    MLR     fill='000'O
         4 006306   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 006307   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1638    18117    3      CALL ASB$WRITE_USERS( AS_PROJECT );

  18117  4 006310   000132 630400 5                  EPPR0   90
         4 006311   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 006312   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 006313   000000 011000                    NOP     0

     1639    18118    3      USERS_KEY.COUNT = 21;

  18118  4 006314   025000 236003                    LDQ     10752,DU
         4 006315   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1640    18119    3      USERS_KEY.UKEY.S = 'S';

  18119  4 006316   000123 236003                    LDQ     83,DU
         4 006317   000005 552020 xsym               STBQ    USERS_KEY+5,'20'O

     1641    18120    3      CALL ASB$WRITE_USERS( AS_PROJECT_DFLT );

  18120  4 006320   000130 630400 5                  EPPR0   88
         4 006321   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 006322   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 006323   000000 011000                    NOP     0

     1642    18121    3      USERS_KEY.SKEY.PROJ = 1;

  18121  4 006324   000001 236003                    LDQ     1,DU
         4 006325   000000 552020 xsym               STBQ    USERS_KEY,'20'O

     1643    18122    3      USERS_KEY.SKEY.CREATOR = AS_PROJECT_ADMIN.TEXT;

  18122  4 006326   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:286  
         4 006327   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 006330   000000 400024 xsym               ADSC9   USERS_KEY                cn=2,n=20

     1644    18123    3      USERS_KEY.SKEY.USER = (SUBSTR(CR_MOD_KEY.TEXT,0,20));

  18123  4 006331   040000 100500                    MLR     fill='040'O
         4 006332   200051 200024                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=20
         4 006333   000005 400024 xsym               ADSC9   USERS_KEY+5              cn=2,n=20

     1645    18124    3      USERS_KEY.COUNT = CR_MOD_KEY.CNT + 21;

  18124  4 006334   200051 236100                    LDQ     CR_MOD_KEY,,AUTO
         4 006335   000033 772000                    QRL     27
         4 006336   000025 036007                    ADLQ    21,DL
         4 006337   000033 736000                    QLS     27
         4 006340   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1646    18125    3      CALL ASB$WRITE_USERS_KEY;

  18125  4 006341   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 006342   000000 701000 xent               TSX1    ASB$WRITE_USERS_KEY
         4 006343   000000 011000                    NOP     0

     1647    18126    3      END;

     1648    18127    3   IF PACKSET_COUNT > 0 THEN DO;

  18127  4 006344   200071 235100                    LDA     PACKSET_COUNT,,AUTO
         4 006345   006432 604400 4                  TMOZ    s:18143

     1649    18128    3      PROJ_KEY = CR_MOD_KEY;

  18128  4 006346   000000 100500                    MLR     fill='000'O
         4 006347   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 006350   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27

     1650    18129    3      CALL ASB$PREC_PROJ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:287  

  18129  4 006351   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 006352   000000 701000 xent               TSX1    ASB$PREC_PROJ
         4 006353   000000 011000                    NOP     0

     1651    18130    4      DO I = 1 TO PACKSET_COUNT;

  18130  4 006354   000001 235007                    LDA     1,DL
         4 006355   200057 755100                    STA     I,,AUTO
         4 006356   006424 710000 4                  TRA     s:18140+1

     1652    18131    4         CALL ASB$READ_PROJ_SEQ( DSEG2$, ARS, 2 ) ALTRET(IO_ERR);

  18131  4 006357   000013 236000 5                  LDQ     11
         4 006360   200122 756100                    STQ     I+4,,AUTO
         4 006361   200003 630500                    EPPR0   ARS,,AUTO
         4 006362   200121 450500                    STP0    I+3,,AUTO
         4 006363   000161 236000 5                  LDQ     113
         4 006364   200120 756100                    STQ     I+2,,AUTO
         4 006365   200120 630500                    EPPR0   I+2,,AUTO
         4 006366   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 006367   000000 701000 xent               TSX1    ASB$READ_PROJ_SEQ
         4 006370   006417 702000 4                  TSX2    IO_ERR

     1653    18132    4         IF AS_PROJECT_ADMIN = AS_NONE THEN

  18132  4 006371   000000 106400                    CMPC    fill='000'O
         4 006372   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 006373   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 006374   006402 601000 4                  TNZ     s:18135

     1654    18133    4            AS$PROJ.CREATOR = AS_BLANK;

  18133  4 006375   000000 470400 xsym               LDP0    DSEG2$
         4 006376   040100 100400                    MLR     fill='040'O
         4 006377   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 006400   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:288  
         4 006401   006406 710000 4                  TRA     s:18136

     1655    18134    4         ELSE
     1656    18135    4            AS$PROJ.CREATOR = AS_PROJECT_ADMIN.TEXT;

  18135  4 006402   000000 470400 xsym               LDP0    DSEG2$
         4 006403   040100 100400                    MLR     fill='040'O
         4 006404   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 006405   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

     1657    18136    4         CALL ASB$WRITE_PROJ( DSEG2$, ARS ) ALTRET(IO_ERR);

  18136  4 006406   200003 630500                    EPPR0   ARS,,AUTO
         4 006407   200121 450500                    STP0    I+3,,AUTO
         4 006410   000161 236000 5                  LDQ     113
         4 006411   200120 756100                    STQ     I+2,,AUTO
         4 006412   200120 630500                    EPPR0   I+2,,AUTO
         4 006413   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 006414   000000 701000 xent               TSX1    ASB$WRITE_PROJ
         4 006415   006417 702000 4                  TSX2    IO_ERR

     1658    18137    5         DO WHILE('0'B);

  18137  4 006416   006423 710000 4                  TRA     s:18140

     1659    18138    5   IO_ERR:  CALL ASH$ERROR( ERR_CODE );

  18138  4 006417   000001 630400 5     IO_ERR       EPPR0   1
         4 006420   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 006421   000000 701000 xent               TSX1    ASH$ERROR
         4 006422   000000 011000                    NOP     0

     1660    18139    5            END;

     1661    18140    4         END;

  18140  4 006423   200057 054100                    AOS     I,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:289  
         4 006424   200057 236100                    LDQ     I,,AUTO
         4 006425   200071 116100                    CMPQ    PACKSET_COUNT,,AUTO
         4 006426   006357 604400 4                  TMOZ    s:18131

     1662    18141    3      CALL ASB$DEQ_PROJ;

  18141  4 006427   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 006430   000000 701000 xent               TSX1    ASB$DEQ_PROJ
         4 006431   000000 011000                    NOP     0

     1663    18142    3      END;

     1664    18143    2   RETURN;

  18143  4 006432   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 006433   000001 702211                    TSX2  ! 1,X1

     1665    18144
     1666    18145        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:290  
     1667    18146    2   TIE_USER: ENTRY;

  18146  4 006434   200050 741300       TIE_USER     STX1  ! FREE_SEG_TYPE+1,,AUTO

     1668    18147
     1669    18148
     1670    18149    2   CREATE = '0'B; PROJ_FLAG = '0'B;

  18149  4 006435   200065 450100                    STZ     CREATE,,AUTO

  18149  4 006436   200066 450100                    STZ     PROJ_FLAG,,AUTO

     1671    18150    2   PAR$ = P$NODE.SUBLK$(0);

  18150  4 006437   000000 470400 xsym               LDP0    NODE$
         4 006440   000003 236100                    LDQ     3,,PR0
         4 006441   200063 756100                    STQ     PAR$,,AUTO

     1672    18151    2   CALL ASB$KEYMAKER( CR_MOD_KEY, PAR$->P$NODE, AS_FALSE, CODE) ALTRET(EXIT#);

  18151  4 006442   000152 237000 5                  LDAQ    106
         4 006443   200122 757100                    STAQ    I+4,,AUTO
         4 006444   200063 236100                    LDQ     PAR$,,AUTO
         4 006445   200121 756100                    STQ     I+3,,AUTO
         4 006446   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 006447   200120 451500                    STP1    I+2,,AUTO
         4 006450   200120 630500                    EPPR0   I+2,,AUTO
         4 006451   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 006452   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 006453   003647 702000 4                  TSX2    EXIT#

     1673    18152    2   USERS_KEY = CR_MOD_KEY;

  18152  4 006454   000000 100500                    MLR     fill='000'O
         4 006455   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 006456   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:291  
     1674    18153    2   CALL ASB$GET( AS_FALSE, CODE, AS_USERS ) ALTRET(EXIT#);

  18153  4 006457   000154 630400 5                  EPPR0   108
         4 006460   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 006461   000000 701000 xent               TSX1    ASB$GET
         4 006462   003647 702000 4                  TSX2    EXIT#

     1675    18154
     1676    18155    2   PAR$ = P$NODE.SUBLK$(1);

  18155  4 006463   000000 470400 xsym               LDP0    NODE$
         4 006464   000004 236100                    LDQ     4,,PR0
         4 006465   200063 756100                    STQ     PAR$,,AUTO

     1677    18156    2   CALL ASB$KEYMAKER( FROM_KEY,PAR$->P$NODE,AS_TRUE,21   /* FROM_VAL */) ALTRET(EXIT#)
             18156            ;

  18156  4 006466   000204 237000 5                  LDAQ    132
         4 006467   200122 757100                    STAQ    I+4,,AUTO
         4 006470   200063 236100                    LDQ     PAR$,,AUTO
         4 006471   000110 235000 5                  LDA     72
         4 006472   200120 757100                    STAQ    I+2,,AUTO
         4 006473   200120 630500                    EPPR0   I+2,,AUTO
         4 006474   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 006475   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 006476   003647 702000 4                  TSX2    EXIT#

     1678    18157    3   IF AS_USERS.BUDGET.MACCT = FROM_KEY THEN DO;

  18157  4 006477   000000 106400                    CMPC    fill='000'O
         4 006500   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 006501   000000 000025 xsym               ADSC9   FROM_KEY                 cn=0,n=21
         4 006502   006525 601000 4                  TNZ     s:18180

     1679    18158        /*E*  ERROR:  ASA-E$USER_ALREADY_TIED-C
     1680    18159              MESSAGE: User "%U1" is already tied to project "%U2".
     1681    18160        */
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:292  
     1682    18161    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD1 );

  18161  4 006503   000103 236000 5                  LDQ     67
         4 006504   200121 756100                    STQ     I+3,,AUTO
         4 006505   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 006506   200120 450500                    STP0    I+2,,AUTO
         4 006507   200120 630500                    EPPR0   I+2,,AUTO
         4 006510   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 006511   000000 701000 xent               TSX1    ASA$KEYCONV
         4 006512   000000 011000                    NOP     0

     1683    18162    3      CALL ASA$KEYCONV( FROM_KEY,   AS_FIELD2 );

  18162  4 006513   000206 630400 5                  EPPR0   134
         4 006514   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 006515   000000 701000 xent               TSX1    ASA$KEYCONV
         4 006516   000000 011000                    NOP     0

     1684    18163           %SCREAM( ERR#=E$USER_ALREADY_TIED, LEVEL=ERROR, MID='A' );

  18175  4 006517   000210 630400 5                  EPPR0   136
         4 006520   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 006521   000000 701000 xent               TSX1    ASH$ERROR
         4 006522   000000 011000                    NOP     0

     1685    18178    3      RETURN;

  18178  4 006523   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 006524   000001 702211                    TSX2  ! 1,X1

     1686    18179    3      END;
     1687    18180    2   CALL CONCAT( USERS_KEY.TXTC, FROM_KEY.TEXT, 'S' );

  18180  4 006525   040000 100400                    MLR     fill='040'O
         4 006526   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20
         4 006527   000000 200024 xsym               ADSC9   USERS_KEY                cn=1,n=20
         4 006530   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:293  
         4 006531   000077 000001 5                  ADSC9   63                       cn=0,n=1
         4 006532   000005 200025 xsym               ADSC9   USERS_KEY+5              cn=1,n=21

     1688    18181    2   USERS_KEY.COUNT = 21;

  18181  4 006533   025000 236003                    LDQ     10752,DU
         4 006534   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1689    18182    2   CALL ASB$GET( AS_FALSE, , AS_DFLT ) ALTRET(EXIT#);

  18182  4 006535   000100 236000 5                  LDQ     64
         4 006536   200122 756100                    STQ     I+4,,AUTO
         4 006537   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006540   000035 235000 5                  LDA     29
         4 006541   200120 757100                    STAQ    I+2,,AUTO
         4 006542   200120 630500                    EPPR0   I+2,,AUTO
         4 006543   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 006544   000000 701000 xent               TSX1    ASB$GET
         4 006545   003647 702000 4                  TSX2    EXIT#

     1690    18183
     1691    18184    2   CALL CHECK_CREATE_OK(FROM_KEY) ALTRET(EXIT#);

  18184  4 006546   000110 236000 5                  LDQ     72
         4 006547   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 006550   007430 701000 4                  TSX1    CHECK_CREATE_OK
         4 006551   003647 702000 4                  TSX2    EXIT#

     1692    18185    2   PROJ_KEY = FROM_KEY;

  18185  4 006552   000000 100400                    MLR     fill='000'O
         4 006553   000000 000025 xsym               ADSC9   FROM_KEY                 cn=0,n=21
         4 006554   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27

     1693    18186    2   PROJ_KEY.TXT.PACKSET = AS_USERS.HPSN;

  18186  4 006555   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:294  
         4 006556   000123 000006 xsym               ADSC9   AS_USERS+83              cn=0,n=6
         4 006557   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

     1694    18187    2   CALL INDEX( I, AS_BLANK, PROJ_KEY.TEXT, 20 );

  18187  4 006560   000000 124400                    SCM     mask='000'O
         4 006561   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         4 006562   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 006563   200057 000100                    ARG     I,,AUTO
         4 006564   000024 236007                    LDQ     20,DL
         4 006565   200057 056100                    ASQ     I,,AUTO

     1695    18188    2   PROJ_KEY.COUNT = I;

  18188  4 006566   200057 236100                    LDQ     I,,AUTO
         4 006567   000033 736000                    QLS     27
         4 006570   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

     1696    18189    2   CALL ASB$PREC_PROJ ALTRET(NO_PROJ_REC);

  18189  4 006571   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 006572   000000 701000 xent               TSX1    ASB$PREC_PROJ
         4 006573   006575 702000 4                  TSX2    NO_PROJ_REC

     1697    18190    3   DO WHILE('0'B);

  18190  4 006574   006626 710000 4                  TRA     s:18217

     1698    18191        /*E*  ERROR:  ASA-E$NO_PROJ_REC_FOR_HSET-C
     1699    18192              MESSAGE: HSET = %U1 for "%U2", but packset DP#%U1 does not exist for
     1700    18193                       project "%U3".
     1701    18194        */
     1702    18195    3   NO_PROJ_REC:
     1703    18196    3      AS_FIELD1.COUNT = I - 20;

  18196  4 006575   200057 236100       NO_PROJ_REC  LDQ     I,,AUTO
         4 006576   000024 136007                    SBLQ    20,DL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:295  
         4 006577   000033 736000                    QLS     27
         4 006600   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     1704    18197    3      AS_FIELD1.TEXT = AS_USERS.HPSN;

  18197  4 006601   040000 100400                    MLR     fill='040'O
         4 006602   000123 000006 xsym               ADSC9   AS_USERS+83              cn=0,n=6
         4 006603   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     1705    18198    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD2 );

  18198  4 006604   000174 236000 5                  LDQ     124
         4 006605   200121 756100                    STQ     I+3,,AUTO
         4 006606   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 006607   200120 450500                    STP0    I+2,,AUTO
         4 006610   200120 630500                    EPPR0   I+2,,AUTO
         4 006611   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 006612   000000 701000 xent               TSX1    ASA$KEYCONV
         4 006613   000000 011000                    NOP     0

     1706    18199    3      CALL ASA$KEYCONV( FROM_KEY, AS_FIELD3 );

  18199  4 006614   000211 630400 5                  EPPR0   137
         4 006615   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 006616   000000 701000 xent               TSX1    ASA$KEYCONV
         4 006617   000000 011000                    NOP     0

     1707    18200           %SCREAM( ERR#=E$NO_PROJ_REC_FOR_HSET, LEVEL=ERROR, MID='A' );

  18212  4 006620   000213 630400 5                  EPPR0   139
         4 006621   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 006622   000000 701000 xent               TSX1    ASH$ERROR
         4 006623   000000 011000                    NOP     0

     1708    18215    3      RETURN;

  18215  4 006624   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:296  
         4 006625   000001 702211                    TSX2  ! 1,X1

     1709    18216    3      END;

     1710    18217    2   CALL INITIALIZATIONS ALTRET(EXIT#);

  18217  4 006626   007326 701000 4                  TSX1    INITIALIZATIONS
         4 006627   003647 702000 4                  TSX2    EXIT#

     1711    18218    2   IF AS_PROJECT_ADMIN = AS_NONE THEN

  18218  4 006630   000000 106400                    CMPC    fill='000'O
         4 006631   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 006632   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 006633   006640 601000 4                  TNZ     s:18220

     1712    18219    2      CALL ASB$ACCT_OK( AS_USERS.ACCT, AS_USERS.HPSN, FROM_KEY ) ALTRET(EXIT#);

  18219  4 006634   000214 630400 5                  EPPR0   140
         4 006635   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 006636   000000 701000 xent               TSX1    ASB$ACCT_OK
         4 006637   003647 702000 4                  TSX2    EXIT#

     1713    18220    2   CALL GET_ACCT_LIST(2) ALTRET(EXIT#);

  18220  4 006640   000013 236000 5                  LDQ     11
         4 006641   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 006642   010321 701000 4                  TSX1    GET_ACCT_LIST
         4 006643   003647 702000 4                  TSX2    EXIT#

     1714    18221    3   IF AS_USERS.BUDGET.MACCT ~= AS_NONE THEN DO;

  18221  4 006644   000000 106400                    CMPC    fill='000'O
         4 006645   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 006646   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 006647   006713 600000 4                  TZE     s:18226

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:297  
     1715    18222    3      USERS_KEY = AS_USERS.BUDGET.MACCT;

  18222  4 006650   000000 100400                    MLR     fill='000'O
         4 006651   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 006652   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1716    18223    3      CALL ASB$GET(AS_TRUE,,AS_PROJ_ADMIN,,AS_DEFAULT) ALTRET(EXIT#);

  18223  4 006653   000124 236000 5                  LDQ     84
         4 006654   200124 756100                    STQ     I+6,,AUTO
         4 006655   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006656   000126 235000 5                  LDA     86
         4 006657   200122 757100                    STAQ    I+4,,AUTO
         4 006660   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006661   000036 235000 5                  LDA     30
         4 006662   200120 757100                    STAQ    I+2,,AUTO
         4 006663   200120 630500                    EPPR0   I+2,,AUTO
         4 006664   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 006665   000000 701000 xent               TSX1    ASB$GET
         4 006666   003647 702000 4                  TSX2    EXIT#

     1717    18224    3      CALL ASA$UNTIE_USER( CR_MOD_KEY, ACCT_COUNT, (AS_PROJECT_ADMIN~=AS_USERS.BUDGET.
             18224               MACCT) );

  18224  4 006667   400000 220003                    LDX0    -131072,DU
         4 006670   000000 106400                    CMPC    fill='000'O
         4 006671   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 006672   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 006673   006675 601000 4                  TNZ     s:18224+6
         4 006674   000000 220003                    LDX0    0,DU
         4 006675   000000 636010                    EAQ     0,X0
         4 006676   200120 676100                    ERQ     I+2,,AUTO
         4 006677   400000 376003                    ANQ     -131072,DU
         4 006700   200120 656100                    ERSQ    I+2,,AUTO
         4 006701   200120 630500                    EPPR0   I+2,,AUTO
         4 006702   200124 450500                    STP0    I+6,,AUTO
         4 006703   200072 631500                    EPPR1   ACCT_COUNT,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:298  
         4 006704   200123 451500                    STP1    I+5,,AUTO
         4 006705   200051 633500                    EPPR3   CR_MOD_KEY,,AUTO
         4 006706   200122 453500                    STP3    I+4,,AUTO
         4 006707   200122 630500                    EPPR0   I+4,,AUTO
         4 006710   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 006711   000000 701000 xent               TSX1    ASA$UNTIE_USER
         4 006712   000000 011000                    NOP     0

     1718    18225    3      END;

     1719    18226    2   CALL ASA$TIE_USER( CR_MOD_KEY, FROM_KEY, ACCT_COUNT, AS_TRUE );

  18226  4 006713   000036 236000 5                  LDQ     30
         4 006714   200123 756100                    STQ     I+5,,AUTO
         4 006715   200072 630500                    EPPR0   ACCT_COUNT,,AUTO
         4 006716   200122 450500                    STP0    I+4,,AUTO
         4 006717   000110 236000 5                  LDQ     72
         4 006720   200121 756100                    STQ     I+3,,AUTO
         4 006721   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 006722   200120 451500                    STP1    I+2,,AUTO
         4 006723   200120 630500                    EPPR0   I+2,,AUTO
         4 006724   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 006725   000000 701000 xent               TSX1    ASA$TIE_USER
         4 006726   000000 011000                    NOP     0

     1720    18227    2   IF ACCT_COUNT > 0 THEN CALL ASB$DEQ_PROJ;

  18227  4 006727   200072 235100                    LDA     ACCT_COUNT,,AUTO
         4 006730   006734 604400 4                  TMOZ    s:18228

  18227  4 006731   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 006732   000000 701000 xent               TSX1    ASB$DEQ_PROJ
         4 006733   000000 011000                    NOP     0

     1721    18228    2   RETURN;

  18228  4 006734   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:299  
         4 006735   000001 702211                    TSX2  ! 1,X1

     1722    18229        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:300  
     1723    18230    2   TIE_PROJ: ENTRY;

  18230  4 006736   200050 741300       TIE_PROJ     STX1  ! FREE_SEG_TYPE+1,,AUTO

     1724    18231
     1725    18232
     1726    18233    2   CREATE = %NO#; PROJ_FLAG = %YES#;

  18233  4 006737   200065 450100                    STZ     CREATE,,AUTO

  18233  4 006740   400000 236003                    LDQ     -131072,DU
         4 006741   200066 756100                    STQ     PROJ_FLAG,,AUTO

     1727    18234    2   PAR$ = P$NODE.SUBLK$(0);

  18234  4 006742   000000 470400 xsym               LDP0    NODE$
         4 006743   000003 236100                    LDQ     3,,PR0
         4 006744   200063 756100                    STQ     PAR$,,AUTO

     1728    18235    2   CALL ASB$KEYMAKER( CR_MOD_KEY, PAR$->P$NODE, AS_TRUE, CODE) ALTRET(EXIT#);

  18235  4 006745   000162 237000 5                  LDAQ    114
         4 006746   200122 757100                    STAQ    I+4,,AUTO
         4 006747   200063 236100                    LDQ     PAR$,,AUTO
         4 006750   200121 756100                    STQ     I+3,,AUTO
         4 006751   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 006752   200120 451500                    STP1    I+2,,AUTO
         4 006753   200120 630500                    EPPR0   I+2,,AUTO
         4 006754   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 006755   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 006756   003647 702000 4                  TSX2    EXIT#

     1729    18236    2   USERS_KEY = CR_MOD_KEY;

  18236  4 006757   000000 100500                    MLR     fill='000'O
         4 006760   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 006761   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:301  

     1730    18237    2   CALL ASB$GET( AS_TRUE, CODE, AS_PROJECT,,AS_PROJECT_DFLT ) ALTRET(EXIT#);

  18237  4 006762   000130 236000 5                  LDQ     88
         4 006763   200124 756100                    STQ     I+6,,AUTO
         4 006764   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 006765   000132 235000 5                  LDA     90
         4 006766   200122 757100                    STAQ    I+4,,AUTO
         4 006767   000162 237000 5                  LDAQ    114
         4 006770   200120 757100                    STAQ    I+2,,AUTO
         4 006771   200120 630500                    EPPR0   I+2,,AUTO
         4 006772   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 006773   000000 701000 xent               TSX1    ASB$GET
         4 006774   003647 702000 4                  TSX2    EXIT#

     1731    18238
     1732    18239    2   PAR$ = P$NODE.SUBLK$(1);

  18239  4 006775   000000 470400 xsym               LDP0    NODE$
         4 006776   000004 236100                    LDQ     4,,PR0
         4 006777   200063 756100                    STQ     PAR$,,AUTO

     1733    18240    2   CALL ASB$KEYMAKER( FROM_KEY,PAR$->P$NODE,AS_TRUE,21   /* FROM_VAL */) ALTRET(EXIT#)
             18240            ;

  18240  4 007000   000204 237000 5                  LDAQ    132
         4 007001   200122 757100                    STAQ    I+4,,AUTO
         4 007002   200063 236100                    LDQ     PAR$,,AUTO
         4 007003   000110 235000 5                  LDA     72
         4 007004   200120 757100                    STAQ    I+2,,AUTO
         4 007005   200120 630500                    EPPR0   I+2,,AUTO
         4 007006   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 007007   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 007010   003647 702000 4                  TSX2    EXIT#

     1734    18241    3   IF AS_PROJECT.BUDGET.MACCT = FROM_KEY THEN DO;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:302  
  18241  4 007011   000000 106400                    CMPC    fill='000'O
         4 007012   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21
         4 007013   000000 000025 xsym               ADSC9   FROM_KEY                 cn=0,n=21
         4 007014   007037 601000 4                  TNZ     s:18265

     1735    18242        /*E*  ERROR:  ASA-E$PROJ_ALREADY_TIED-C
     1736    18243              MESSAGE: Project "%U1" is already tied to project "%U2".
     1737    18244        */
     1738    18245    3      CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD1 );

  18245  4 007015   000103 236000 5                  LDQ     67
         4 007016   200121 756100                    STQ     I+3,,AUTO
         4 007017   200051 630500                    EPPR0   CR_MOD_KEY,,AUTO
         4 007020   200120 450500                    STP0    I+2,,AUTO
         4 007021   200120 630500                    EPPR0   I+2,,AUTO
         4 007022   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 007023   000000 701000 xent               TSX1    ASA$KEYCONV
         4 007024   000000 011000                    NOP     0

     1739    18246    3      CALL ASA$KEYCONV( FROM_KEY,   AS_FIELD2 );

  18246  4 007025   000206 630400 5                  EPPR0   134
         4 007026   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 007027   000000 701000 xent               TSX1    ASA$KEYCONV
         4 007030   000000 011000                    NOP     0

     1740    18247           %SCREAM( ERR#=E$PROJ_ALREADY_TIED, LEVEL=ERROR, MID='A' );

  18259  4 007031   000217 630400 5                  EPPR0   143
         4 007032   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007033   000000 701000 xent               TSX1    ASH$ERROR
         4 007034   000000 011000                    NOP     0

     1741    18262    3      RETURN;

  18262  4 007035   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 007036   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:303  

     1742    18263    3      END;
     1743    18264
     1744    18265    2   USERS_KEY = FROM_KEY;

  18265  4 007037   000000 100400                    MLR     fill='000'O
         4 007040   000000 000025 xsym               ADSC9   FROM_KEY                 cn=0,n=21
         4 007041   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1745    18266    2   CALL ASB$GET(AS_TRUE,,AS_PROJ_ADMIN,AS_PROJ_ADMIN_DREC$,AS_DEFAULT,

  18266  4 007042   000124 237000 5                  LDAQ    84
         4 007043   200124 757100                    STAQ    I+6,,AUTO
         4 007044   000126 237000 5                  LDAQ    86
         4 007045   200122 757100                    STAQ    I+4,,AUTO
         4 007046   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 007047   000036 235000 5                  LDA     30
         4 007050   200120 757100                    STAQ    I+2,,AUTO
         4 007051   200120 630500                    EPPR0   I+2,,AUTO
         4 007052   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 007053   000000 701000 xent               TSX1    ASB$GET
         4 007054   003647 702000 4                  TSX2    EXIT#

     1746    18267    2        AS_DEFAULT_DREC$ ) ALTRET(EXIT#);
     1747    18268
     1748    18269    2   CALL CHECK_CREATE_OK(FROM_KEY) ALTRET(EXIT#);

  18269  4 007055   000110 236000 5                  LDQ     72
         4 007056   200075 756100                    STQ     WSN_INDEX,,AUTO
         4 007057   007430 701000 4                  TSX1    CHECK_CREATE_OK
         4 007060   003647 702000 4                  TSX2    EXIT#

     1749    18270    2   CALL INITIALIZATIONS  ALTRET(EXIT#);

  18270  4 007061   007326 701000 4                  TSX1    INITIALIZATIONS
         4 007062   003647 702000 4                  TSX2    EXIT#

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:304  
     1750    18271    2   CALL GET_PACKSET_LIST ALTRET(EXIT#);

  18271  4 007063   010012 701000 4                  TSX1    GET_PACKSET_LIST
         4 007064   003647 702000 4                  TSX2    EXIT#

     1751    18272
     1752    18273    3   IF AS_PROJECT.BUDGET.MACCT ~= AS_NONE THEN DO;

  18273  4 007065   000000 106400                    CMPC    fill='000'O
         4 007066   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21
         4 007067   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 007070   007151 600000 4                  TZE     s:18283

     1753    18274    3      AS_USERS = AS_PROJ_ADMIN;

  18274  4 007071   000000 100400                    MLR     fill='000'O
         4 007072   000000 004020 xsym               ADSC9   AS_PROJ_ADMIN            cn=0,n=2064
         4 007073   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064

     1754    18275    3      AS_DFLT  = AS_DEFAULT;

  18275  4 007074   000000 100400                    MLR     fill='000'O
         4 007075   000000 004020 xsym               ADSC9   AS_DEFAULT               cn=0,n=2064
         4 007076   000000 004020 xsym               ADSC9   AS_DFLT                  cn=0,n=2064

     1755    18276    3      USERS_KEY = AS_PROJECT.BUDGET.MACCT;

  18276  4 007077   000000 100400                    MLR     fill='000'O
         4 007100   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21
         4 007101   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     1756    18277    3      CALL ASB$GET(AS_TRUE,,AS_PROJ_ADMIN,,AS_DEFAULT) ALTRET(EXIT#);

  18277  4 007102   000124 236000 5                  LDQ     84
         4 007103   200124 756100                    STQ     I+6,,AUTO
         4 007104   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 007105   000126 235000 5                  LDA     86
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:305  
         4 007106   200122 757100                    STAQ    I+4,,AUTO
         4 007107   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 007110   000036 235000 5                  LDA     30
         4 007111   200120 757100                    STAQ    I+2,,AUTO
         4 007112   200120 630500                    EPPR0   I+2,,AUTO
         4 007113   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 007114   000000 701000 xent               TSX1    ASB$GET
         4 007115   003647 702000 4                  TSX2    EXIT#

     1757    18278    3     CALL ASA$UNTIE_PROJECT( CR_MOD_KEY, PACKSET_COUNT, (AS_PROJECT_ADMIN~=AS_PROJECT.
             18278               BUDGET.MACCT) );

  18278  4 007116   400000 220003                    LDX0    -131072,DU
         4 007117   000000 106400                    CMPC    fill='000'O
         4 007120   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 007121   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21
         4 007122   007124 601000 4                  TNZ     s:18278+6
         4 007123   000000 220003                    LDX0    0,DU
         4 007124   000000 636010                    EAQ     0,X0
         4 007125   200120 676100                    ERQ     I+2,,AUTO
         4 007126   400000 376003                    ANQ     -131072,DU
         4 007127   200120 656100                    ERSQ    I+2,,AUTO
         4 007130   200120 630500                    EPPR0   I+2,,AUTO
         4 007131   200124 450500                    STP0    I+6,,AUTO
         4 007132   200071 631500                    EPPR1   PACKSET_COUNT,,AUTO
         4 007133   200123 451500                    STP1    I+5,,AUTO
         4 007134   200051 633500                    EPPR3   CR_MOD_KEY,,AUTO
         4 007135   200122 453500                    STP3    I+4,,AUTO
         4 007136   200122 630500                    EPPR0   I+4,,AUTO
         4 007137   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 007140   000000 701000 xent               TSX1    ASA$UNTIE_PROJECT
         4 007141   000000 011000                    NOP     0

     1758    18279    3      AS_PROJ_ADMIN = AS_USERS;

  18279  4 007142   000000 100400                    MLR     fill='000'O
         4 007143   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:306  
         4 007144   000000 004020 xsym               ADSC9   AS_PROJ_ADMIN            cn=0,n=2064

     1759    18280    3      AS_DEFAULT    = AS_DFLT;

  18280  4 007145   000000 100400                    MLR     fill='000'O
         4 007146   000000 004020 xsym               ADSC9   AS_DFLT                  cn=0,n=2064
         4 007147   000000 004020 xsym               ADSC9   AS_DEFAULT               cn=0,n=2064

     1760    18281    3      END;

  18281  4 007150   007171 710000 4                  TRA     s:18288

     1761    18282    3   ELSE DO;

     1762    18283    3      USERS_KEY.COUNT = 21 + CR_MOD_KEY.CNT;

  18283  4 007151   200051 236100                    LDQ     CR_MOD_KEY,,AUTO
         4 007152   000033 772000                    QRL     27
         4 007153   000025 036007                    ADLQ    21,DL
         4 007154   000033 736000                    QLS     27
         4 007155   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1763    18284    3     CALL CONCAT(USERS_KEY.TXTC, BINASC(1), AS_NONE.TEXT, (SUBSTR(CR_MOD_KEY.TEXT,0,20
             18284               )));

  18284  4 007156   000001 236003                    LDQ     1,DU
         4 007157   000000 552020 xsym               STBQ    USERS_KEY,'20'O
         4 007160   040000 100400                    MLR     fill='040'O
         4 007161   000000 200024 xsym               ADSC9   AS_NONE                  cn=1,n=20
         4 007162   000000 400024 xsym               ADSC9   USERS_KEY                cn=2,n=20
         4 007163   040000 100500                    MLR     fill='040'O
         4 007164   200051 200024                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=20
         4 007165   000005 400024 xsym               ADSC9   USERS_KEY+5              cn=2,n=20

     1764    18285    3      CALL ASB$DELREC_USERS;

  18285  4 007166   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:307  
         4 007167   000000 701000 xent               TSX1    ASB$DELREC_USERS
         4 007170   000000 011000                    NOP     0

     1765    18286    3      END;

     1766    18287
     1767    18288    2   CALL ASA$TIE_PROJECT( CR_MOD_KEY, FROM_KEY, PACKSET_COUNT, AS_TRUE );

  18288  4 007171   000036 236000 5                  LDQ     30
         4 007172   200123 756100                    STQ     I+5,,AUTO
         4 007173   200071 630500                    EPPR0   PACKSET_COUNT,,AUTO
         4 007174   200122 450500                    STP0    I+4,,AUTO
         4 007175   000110 236000 5                  LDQ     72
         4 007176   200121 756100                    STQ     I+3,,AUTO
         4 007177   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 007200   200120 451500                    STP1    I+2,,AUTO
         4 007201   200120 630500                    EPPR0   I+2,,AUTO
         4 007202   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 007203   000000 701000 xent               TSX1    ASA$TIE_PROJECT
         4 007204   000000 011000                    NOP     0

     1768    18289    3   IF PACKSET_COUNT > 0 THEN DO;

  18289  4 007205   200071 235100                    LDA     PACKSET_COUNT,,AUTO
         4 007206   007262 604400 4                  TMOZ    s:18302

     1769    18290    3      PROJ_KEY = CR_MOD_KEY;

  18290  4 007207   000000 100500                    MLR     fill='000'O
         4 007210   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 007211   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27

     1770    18291    3      CALL ASB$PREC_PROJ;

  18291  4 007212   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 007213   000000 701000 xent               TSX1    ASB$PREC_PROJ
         4 007214   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:308  

     1771    18292    4      DO I = 1 TO PACKSET_COUNT;

  18292  4 007215   000001 235007                    LDA     1,DL
         4 007216   200057 755100                    STA     I,,AUTO
         4 007217   007254 710000 4                  TRA     s:18299+1

     1772    18293    4         CALL ASB$READ_PROJ_SEQ( DSEG2$, ARS, 2 ) ALTRET(IO_ERR2);

  18293  4 007220   000013 236000 5                  LDQ     11
         4 007221   200122 756100                    STQ     I+4,,AUTO
         4 007222   200003 630500                    EPPR0   ARS,,AUTO
         4 007223   200121 450500                    STP0    I+3,,AUTO
         4 007224   000161 236000 5                  LDQ     113
         4 007225   200120 756100                    STQ     I+2,,AUTO
         4 007226   200120 630500                    EPPR0   I+2,,AUTO
         4 007227   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 007230   000000 701000 xent               TSX1    ASB$READ_PROJ_SEQ
         4 007231   007247 702000 4                  TSX2    IO_ERR2

     1773    18294    4         AS$PROJ.CREATOR = FROM_KEY.TEXT;

  18294  4 007232   000000 470400 xsym               LDP0    DSEG2$
         4 007233   040100 100400                    MLR     fill='040'O
         4 007234   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20
         4 007235   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

     1774    18295    4         CALL ASB$WRITE_PROJ( DSEG2$, ARS ) ALTRET(IO_ERR2);

  18295  4 007236   200003 630500                    EPPR0   ARS,,AUTO
         4 007237   200121 450500                    STP0    I+3,,AUTO
         4 007240   000161 236000 5                  LDQ     113
         4 007241   200120 756100                    STQ     I+2,,AUTO
         4 007242   200120 630500                    EPPR0   I+2,,AUTO
         4 007243   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 007244   000000 701000 xent               TSX1    ASB$WRITE_PROJ
         4 007245   007247 702000 4                  TSX2    IO_ERR2
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:309  

     1775    18296    5         DO WHILE('0'B);

  18296  4 007246   007253 710000 4                  TRA     s:18299

     1776    18297    5   IO_ERR2: CALL ASH$ERROR( ERR_CODE );

  18297  4 007247   000001 630400 5     IO_ERR2      EPPR0   1
         4 007250   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007251   000000 701000 xent               TSX1    ASH$ERROR
         4 007252   000000 011000                    NOP     0

     1777    18298    5            END;

     1778    18299    4         END;

  18299  4 007253   200057 054100                    AOS     I,,AUTO
         4 007254   200057 236100                    LDQ     I,,AUTO
         4 007255   200071 116100                    CMPQ    PACKSET_COUNT,,AUTO
         4 007256   007220 604400 4                  TMOZ    s:18293

     1779    18300    3      CALL ASB$DEQ_PROJ;

  18300  4 007257   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 007260   000000 701000 xent               TSX1    ASB$DEQ_PROJ
         4 007261   000000 011000                    NOP     0

     1780    18301    3      END;

     1781    18302    2   RETURN;

  18302  4 007262   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 007263   000001 702211                    TSX2  ! 1,X1

     1782    18303        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:310  
     1783    18304    2   PARSE_CMD: PROC( NODE ) ALTRET;

  18304  4 007264   200074 741300       PARSE_CMD    STX1  ! ACCT_COUNT+2,,AUTO

     1784    18305
     1785    18306    3   DCL NODE UBIN;
     1786    18307
     1787    18308    4   IF ADDR(NODE) ~= ADDR(NIL) THEN DO;

  18308  4 007265   200075 236100                    LDQ     @NODE,,AUTO
         4 007266   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 007267   007275 600000 4                  TZE     s:18312

     1788    18309    4      P_PCB.ROOT$ = ADDR( NODE );

  18309  4 007270   000001 756000 xsym               STQ     P_PCB+1

     1789    18310    4      CALL X$PARSE( P_PCB )       ALTRET( PARSE_ERR );

  18310  4 007271   000017 630400 5                  EPPR0   15
         4 007272   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007273   000000 701000 xent               TSX1    X$PARSE
         4 007274   007320 702000 4                  TSX2    PARSE_ERR

     1790    18311    4      END;

     1791    18312    3   NODE$ = P_PCB.OUT$;

  18312  4 007275   000003 236000 xsym               LDQ     P_PCB+3
         4 007276   000000 756000 xsym               STQ     NODE$

     1792    18313    3   TYPE = P$NODE.SUBLK$(0) -> P$NODE.CODE;

  18313  4 007277   000000 470400 xsym               LDP0    NODE$
         4 007300   000003 471500                    LDP1    3,,PR0
         4 007301   100000 236100                    LDQ     0,,PR1
         4 007302   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:311  
         4 007303   200067 756100                    STQ     TYPE,,AUTO

     1793    18314    3   CREATE = ( TYPE = 35   /*  CREATE_VAL */ );

  18314  4 007304   400000 220003                    LDX0    -131072,DU
         4 007305   000043 116007                    CMPQ    35,DL
         4 007306   007310 600000 4                  TZE     s:18314+4
         4 007307   000000 220003                    LDX0    0,DU
         4 007310   000000 636010                    EAQ     0,X0
         4 007311   200065 756100                    STQ     CREATE,,AUTO

     1794    18315    3   CR_MOD_FLG = ~CREATE;         /* Create ='0'b  modify = '1'b */

  18315  4 007312   200065 236100                    LDQ     CREATE,,AUTO
         4 007313   400000 376003                    ANQ     -131072,DU
         4 007314   400000 676003                    ERQ     -131072,DU
         4 007315   000000 756000 xsym               STQ     CR_MOD_FLG

     1795    18316    3   RETURN;

  18316  4 007316   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 007317   000001 702211                    TSX2  ! 1,X1

     1796    18317
     1797    18318    3   PARSE_ERR:
     1798    18319    3   CALL ASH$ERROR( P_PCB.ERROR );

  18319  4 007320   000220 630400 5     PARSE_ERR    EPPR0   144
         4 007321   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007322   000000 701000 xent               TSX1    ASH$ERROR
         4 007323   000000 011000                    NOP     0

     1799    18320    3   ALTRETURN;

  18320  4 007324   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 007325   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:312  
     1800    18321
     1801    18322    3   END PARSE_CMD;
     1802    18323        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:313  
     1803    18324    2   INITIALIZATIONS: PROC ALTRET;

  18324  4 007326   200074 741300       INITIALIZAT* STX1  ! ACCT_COUNT+2,,AUTO

     1804    18325
     1805    18326    3   IF NOT DSEG_FLG THEN

  18326  4 007327   000000 234000 xsym               SZN     DSEG_FLG
         4 007330   007343 604000 4                  TMI     s:18346

     1806    18327    3      CALL ASB$GETSEG

  18327  4 007331   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 007332   000000 701000 xent               TSX1    ASB$GETSEG
         4 007333   007335 702000 4                  TSX2    s:18341
         4 007334   007343 710000 4                  TRA     s:18346

     1807    18328    4      WHENALTRETURN DO;

     1808    18329              %SCREAM (ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='A');

  18341  4 007335   000221 630400 5                  EPPR0   145
         4 007336   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007337   000000 701000 xent               TSX1    ASH$ERROR
         4 007340   000000 011000                    NOP     0

     1809    18344    4         ALTRETURN;

  18344  4 007341   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 007342   000000 702211                    TSX2  ! 0,X1

     1810    18345    4         END;   /*  Whenaltreturn from ASB$GETSEG  */
     1811    18346    4   IF AS_RESOURCE_LIST$ = ADDR(NIL) THEN DO;

  18346  4 007343   000000 236000 xsym               LDQ     AS_RESOURCE_LIST$
         4 007344   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 007345   007364 601000 4                  TNZ     s:18354
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:314  

     1812    18347    4      AS_RESOURCE_LIST$ = DSEG1$;

  18347  4 007346   000000 236000 xsym               LDQ     DSEG1$
         4 007347   000000 756000 xsym               STQ     AS_RESOURCE_LIST$

     1813    18348    4      AS_FERESOURCE_LIST$ = PINCRW( DSEG1$, 500 );

  18348  4 007350   000764 036003                    ADLQ    500,DU
         4 007351   000000 756000 xsym               STQ     AS_FERESOURCE_LIST$

     1814    18349    4      AS_PSEUDO_LIST$ = PINCRW( DSEG1$, 2000 );

  18349  4 007352   000000 236000 xsym               LDQ     DSEG1$
         4 007353   003720 036003                    ADLQ    2000,DU
         4 007354   000000 756000 xsym               STQ     AS_PSEUDO_LIST$

     1815    18350    4      AS_FEPSEUDO_LIST$ = PINCRW( DSEG1$, 2500 );

  18350  4 007355   000000 236000 xsym               LDQ     DSEG1$
         4 007356   004704 036003                    ADLQ    2500,DU
         4 007357   000000 756000 xsym               STQ     AS_FEPSEUDO_LIST$

     1816    18351    4      AS_SUPER_TO_PIG$ = DSEG2$;

  18351  4 007360   000000 236000 xsym               LDQ     DSEG2$
         4 007361   000000 756000 xsym               STQ     AS_SUPER_TO_PIG$

     1817    18352    4      AS_PROJ_HEADER$ = PINCRW( DSEG2$, 1500 );

  18352  4 007362   002734 036003                    ADLQ    1500,DU
         4 007363   000000 756000 xsym               STQ     AS_PROJ_HEADER$

     1818    18353    4      END;

     1819    18354    4   IF CODE = 27   /*  CR_MOD_ACCT_VAL */ OR CODE = 52 /* CR_MOD_PROJ_VAL */ THEN DO;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:315  
  18354  4 007364   000000 235000 xsym               LDA     CODE
         4 007365   000033 115007                    CMPA    27,DL
         4 007366   007371 600000 4                  TZE     s:18356
         4 007367   000064 115007                    CMPA    52,DL
         4 007370   007426 601000 4                  TNZ     s:18363

     1820    18355                                            /* Initialize message to pig */
     1821    18356    4      SUPER_TO_PIG.PROJ = ( AS_CR_MOD_PROJ > 0 );

  18356  4 007371   400000 220003                    LDX0    -131072,DU
         4 007372   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         4 007373   007375 605400 4                  TPNZ    s:18356+4
         4 007374   000000 220003                    LDX0    0,DU
         4 007375   000000 470400 xsym               LDP0    AS_SUPER_TO_PIG$
         4 007376   000000 636010                    EAQ     0,X0
         4 007377   000011 772000                    QRL     9
         4 007400   000000 676100                    ERQ     0,,PR0
         4 007401   000400 376003                    ANQ     256,DU
         4 007402   000000 656100                    ERSQ    0,,PR0

     1822    18357    4      SUPER_TO_PIG.RESUPER = AS_LOGON_KEY.TEXT;

  18357  4 007403   000000 470400 xsym               LDP0    AS_SUPER_TO_PIG$
         4 007404   040100 100400                    MLR     fill='040'O
         4 007405   000000 200024 xsym               ADSC9   AS_LOGON_KEY             cn=1,n=20
         4 007406   000000 400024                    ADSC9   0,,PR0                   cn=2,n=20

     1823    18358    4      SUPER_TO_PIG.WIDTH = LO_WIDTH;

  18358  4 007407   000000 470400 xsym               LDP0    AS_SUPER_TO_PIG$
         4 007410   000000 236000 xsym               LDQ     LO_WIDTH
         4 007411   000022 736000                    QLS     18
         4 007412   000000 676100                    ERQ     0,,PR0
         4 007413   000377 376003                    ANQ     255,DU
         4 007414   000000 656100                    ERSQ    0,,PR0

     1824    18359    4      SUPER_TO_PIG.PROJECT_TEXT = AS_PROJECT_ADMIN.TEXT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:316  

  18359  4 007415   000000 470400 xsym               LDP0    AS_SUPER_TO_PIG$
         4 007416   040100 100400                    MLR     fill='040'O
         4 007417   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 007420   000005 400024                    ADSC9   5,,PR0                   cn=2,n=20

     1825    18360    4      SUPER_TO_PIG.ACCT = (SUBSTR(CR_MOD_KEY.TEXT,0,20));

  18360  4 007421   040100 100500                    MLR     fill='040'O
         4 007422   200051 200010                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=8
         4 007423   000014 000010                    ADSC9   12,,PR0                  cn=0,n=8

     1826    18361    4      SUPER_TO_PIG.ATTR.COUNT = 0;

  18361  4 007424   000000 220003                    LDX0    0,DU
         4 007425   000016 740100                    STX0    14,,PR0

     1827    18362    4      END;

     1828    18363    3   RETURN;

  18363  4 007426   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 007427   000001 702211                    TSX2  ! 1,X1

     1829    18364
     1830    18365
     1831    18366    3   END INITIALIZATIONS;
     1832    18367        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:317  
     1833    18368    2   CHECK_CREATE_OK: PROC(PROJECT) ALTRET;

  18368  4 007430   200074 741300       CHECK_CREAT* STX1  ! ACCT_COUNT+2,,AUTO

     1834    18369
     1835    18370    3   DCL 1 PROJECT ALIGNED,
     1836    18371    3          2 COUNT UBIN BYTE UNAL,
     1837    18372    3          2 TEXT CHAR(20) UNAL;
     1838    18373
     1839    18374
     1840    18375
     1841    18376    4   IF CREATE THEN DO;

  18376  4 007431   200065 234100                    SZN     CREATE,,AUTO
         4 007432   007546 605000 4                  TPL     CREATE_OK

     1842    18377    4      CALL ASB$READ_USERS(AS_USERS)  ALTRET(CREATE_OK) ;

  18377  4 007433   000104 630400 5                  EPPR0   68
         4 007434   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007435   000000 701000 xent               TSX1    ASB$READ_USERS
         4 007436   007546 702000 4                  TSX2    CREATE_OK

     1843    18378    4      ARS = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;

  18378  4 007437   000000 235000 3                  LDA     SIZEC_DREC
         4 007440   001144 035007                    ADLA    612,DL
         4 007441   200003 755100                    STA     ARS,,AUTO

     1844    18379    4      CALL ASB$READ_HLP  (KL_DREC$,ARS)  ALTRET(CREATE_OK);

  18379  4 007442   200003 630500                    EPPR0   ARS,,AUTO
         4 007443   200121 450500                    STP0    I+3,,AUTO
         4 007444   000105 236000 5                  LDQ     69
         4 007445   200120 756100                    STQ     I+2,,AUTO
         4 007446   200120 630500                    EPPR0   I+2,,AUTO
         4 007447   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:318  
         4 007450   000000 701000 xent               TSX1    ASB$READ_HLP
         4 007451   007546 702000 4                  TSX2    CREATE_OK

     1845    18380    4      IF PROJ_FLAG  AND  (AS_USERS.PPRIV(0) & %PPR_PADMIN#) = %PPR_PADMIN#

  18380  4 007452   200066 234100                    SZN     PROJ_FLAG,,AUTO
         4 007453   007503 605000 4                  TPL     s:18389
         4 007454   000231 236000 xsym               LDQ     AS_USERS+153
         4 007455   000026 376000 xsym               ANQ     B_VECTNIL+22
         4 007456   000026 116000 xsym               CMPQ    B_VECTNIL+22
         4 007457   007503 601000 4                  TNZ     s:18389

     1846    18381    5      THEN DO;

     1847    18382    5         USERS_KEY.COUNT = 21;

  18382  4 007460   025000 236003                    LDQ     10752,DU
         4 007461   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1848    18383    5         USERS_KEY.TEXT(20) = 'S';

  18383  4 007462   000123 236003                    LDQ     83,DU
         4 007463   000005 552020 xsym               STBQ    USERS_KEY+5,'20'O

     1849    18384    5         CALL ASB$READ_USERS(AS_PROJECT_DFLT) ALTRET(CREATE_OK);

  18384  4 007464   000130 630400 5                  EPPR0   88
         4 007465   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007466   000000 701000 xent               TSX1    ASB$READ_USERS
         4 007467   007546 702000 4                  TSX2    CREATE_OK

     1850    18385    5         ARS = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;

  18385  4 007470   000000 235000 3                  LDA     SIZEC_DREC
         4 007471   001144 035007                    ADLA    612,DL
         4 007472   200003 755100                    STA     ARS,,AUTO

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:319  
     1851    18386    5         CALL ASB$READ_HLP  (AS_PROJECT_DFLT_DREC$,ARS) ALTRET(CREATE_OK);

  18386  4 007473   200003 630500                    EPPR0   ARS,,AUTO
         4 007474   200121 450500                    STP0    I+3,,AUTO
         4 007475   000131 236000 5                  LDQ     89
         4 007476   200120 756100                    STQ     I+2,,AUTO
         4 007477   200120 630500                    EPPR0   I+2,,AUTO
         4 007500   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 007501   000000 701000 xent               TSX1    ASB$READ_HLP
         4 007502   007546 702000 4                  TSX2    CREATE_OK

     1852    18387    5         END;

     1853    18388                                                    /*   Create acct. Exists    */
     1854    18389    4      IF (PROJ_FLAG  \ (AS_USERS.PPRIV(0) & %PPR_PADMIN#) = '0'B)

  18389  4 007503   000231 236000 xsym               LDQ     AS_USERS+153
         4 007504   000026 376000 xsym               ANQ     B_VECTNIL+22
         4 007505   400000 220003                    LDX0    -131072,DU
         4 007506   000000 116003                    CMPQ    0,DU
         4 007507   007511 600000 4                  TZE     s:18389+6
         4 007510   000000 220003                    LDX0    0,DU
         4 007511   200066 236100                    LDQ     PROJ_FLAG,,AUTO
         4 007512   400000 376003                    ANQ     -131072,DU
         4 007513   200120 756100                    STQ     I+2,,AUTO
         4 007514   000000 636010                    EAQ     0,X0
         4 007515   200120 676100                    ERQ     I+2,,AUTO
         4 007516   007532 600000 4                  TZE     s:18391

     1855    18390    4      THEN CALL ASA$ERROR( CR_MOD_KEY, 3 /* RECORD ALREADY EXISTS */, PROJ_FLAG );

  18390  4 007517   200066 630500                    EPPR0   PROJ_FLAG,,AUTO
         4 007520   200122 450500                    STP0    I+4,,AUTO
         4 007521   000222 236000 5                  LDQ     146
         4 007522   200121 756100                    STQ     I+3,,AUTO
         4 007523   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 007524   200120 451500                    STP1    I+2,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:320  
         4 007525   200120 630500                    EPPR0   I+2,,AUTO
         4 007526   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 007527   000000 701000 xent               TSX1    ASA$ERROR
         4 007530   000000 011000                    NOP     0
         4 007531   007544 710000 4                  TRA     s:18392

     1856    18391    4      ELSE CALL ASA$ERROR( CR_MOD_KEY, 313 /* EXISTS AND IS NOT ? */, PROJ_FLAG );

  18391  4 007532   200066 630500                    EPPR0   PROJ_FLAG,,AUTO
         4 007533   200122 450500                    STP0    I+4,,AUTO
         4 007534   000224 236000 5                  LDQ     148
         4 007535   200121 756100                    STQ     I+3,,AUTO
         4 007536   200051 631500                    EPPR1   CR_MOD_KEY,,AUTO
         4 007537   200120 451500                    STP1    I+2,,AUTO
         4 007540   200120 630500                    EPPR0   I+2,,AUTO
         4 007541   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 007542   000000 701000 xent               TSX1    ASA$ERROR
         4 007543   000000 011000                    NOP     0

     1857    18392    4      ALTRETURN ;

  18392  4 007544   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 007545   000000 702211                    TSX2  ! 0,X1

     1858    18393    4      END;
     1859    18394    3   CREATE_OK:
     1860    18395    3   IF PROJECT ~= AS_NONE THEN

  18395  4 007546   200075 470500       CREATE_OK    LDP0    @PROJECT,,AUTO
         4 007547   000000 106500                    CMPC    fill='000'O
         4 007550   000000 000025                    ADSC9   0,,PR0                   cn=0,n=21
         4 007551   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 007552   007742 600000 4                  TZE     s:18567

     1861    18396    3      IF PROJ_FLAG

  18396  4 007553   200066 234100                    SZN     PROJ_FLAG,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:321  
         4 007554   007716 605000 4                  TPL     s:18509

     1862    18397    4      THEN DO SELECT( CODE );

  18397  4 007555   000000 236000 xsym               LDQ     CODE
         4 007556   000104 116007                    CMPQ    68,DL
         4 007557   007562 602000 4                  TNC     s:18397+5
         4 007560   007565 600000 4                  TZE     s:18399
         4 007561   007643 710000 4                  TRA     s:18448
         4 007562   000102 116007                    CMPQ    66,DL
         4 007563   007643 601000 4                  TNZ     s:18448
         4 007564   007565 710000 4                  TRA     s:18399

     1863    18398    4         SELECT( 68 /* TIE_PROJ_VAL */, 66 /* UNTIE_PROJ_VAL */ );

     1864    18399    4         IF (AS_DEFAULT.BUDGET.SUB_PROJS + AS_PROJECT_DFLT.BUDGET.SUB_PROJS + 1)

  18399  4 007565   000017 236000 xsym               LDQ     AS_PROJECT_DFLT+15
         4 007566   000022 736000                    QLS     18
         4 007567   000022 732000                    QRS     18
         4 007570   200120 756100                    STQ     I+2,,AUTO
         4 007571   000017 236000 xsym               LDQ     AS_DEFAULT+15
         4 007572   000022 736000                    QLS     18
         4 007573   000022 732000                    QRS     18
         4 007574   200120 036100                    ADLQ    I+2,,AUTO
         4 007575   200121 756100                    STQ     I+3,,AUTO
         4 007576   000017 236000 xsym               LDQ     AS_PROJ_ADMIN+15
         4 007577   000022 736000                    QLS     18
         4 007600   000022 732000                    QRS     18
         4 007601   200122 756100                    STQ     I+4,,AUTO
         4 007602   200121 236100                    LDQ     I+3,,AUTO
         4 007603   200122 116100                    CMPQ    I+4,,AUTO
         4 007604   007622 604000 4                  TMI     s:18423

     1865    18400    4              > AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     1866    18401    5         THEN DO;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:322  
     1867    18402        /*E*  ERROR:  ASA-E$PROJ_LIMIT_EXCEEDED-C
     1868    18403              MESSAGE: Sub-project limit exceeded for project "%U1".
     1869    18404        */
     1870    18405    5            CALL ASA$KEYCONV( PROJECT, AS_FIELD1 );

  18405  4 007605   000103 236000 5                  LDQ     67
         4 007606   200075 235100                    LDA     @PROJECT,,AUTO
         4 007607   200120 757100                    STAQ    I+2,,AUTO
         4 007610   200120 630500                    EPPR0   I+2,,AUTO
         4 007611   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 007612   000000 701000 xent               TSX1    ASA$KEYCONV
         4 007613   000000 011000                    NOP     0

     1871    18406                 %SCREAM(ERR#=E$PROJ_LIMIT_EXCEEDED,MID='A',LEVEL=ERROR);

  18418  4 007614   000225 630400 5                  EPPR0   149
         4 007615   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007616   000000 701000 xent               TSX1    ASH$ERROR
         4 007617   000000 011000                    NOP     0

     1872    18421    5            ALTRETURN;

  18421  4 007620   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 007621   000000 702211                    TSX2  ! 0,X1

     1873    18422    5            END;
     1874    18423    4         IF (AS_DEFAULT.BUDGET.PROJ_CREATED + AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED)

  18423  4 007622   000011 236000 xsym               LDQ     AS_DEFAULT+9
         4 007623   000010 036000 xsym               ADLQ    AS_PROJECT_DFLT+8
         4 007624   000010 116000 xsym               CMPQ    AS_DEFAULT+8
         4 007625   007742 604400 4                  TMOZ    s:18567

     1875    18424    4              > AS_DEFAULT.BUDGET.PROJ_ALLOWED
     1876    18425    5         THEN DO;

     1877    18426        /*E*  ERROR:  ASA-E$LOGON_LIMIT_EXCEEDED-C
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:323  
     1878    18427              MESSAGE: Logon account limit exceeded for project "%U1".
     1879    18428        */
     1880    18429    5            CALL ASA$KEYCONV( PROJECT, AS_FIELD1 );

  18429  4 007626   000103 236000 5                  LDQ     67
         4 007627   200075 235100                    LDA     @PROJECT,,AUTO
         4 007630   200120 757100                    STAQ    I+2,,AUTO
         4 007631   200120 630500                    EPPR0   I+2,,AUTO
         4 007632   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 007633   000000 701000 xent               TSX1    ASA$KEYCONV
         4 007634   000000 011000                    NOP     0

     1881    18430                 %SCREAM(ERR#=E$LOGON_LIMIT_EXCEEDED,MID='A',LEVEL=ERROR);

  18442  4 007635   000226 630400 5                  EPPR0   150
         4 007636   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007637   000000 701000 xent               TSX1    ASH$ERROR
         4 007640   000000 011000                    NOP     0

     1882    18445    5            ALTRETURN;

  18445  4 007641   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 007642   000000 702211                    TSX2  ! 0,X1

     1883    18446    5            END;
     1884    18447    4         SELECT(ELSE);

     1885    18448    4      IF AS_DEFAULT.BUDGET.SUB_PROJS >= AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS

  18448  4 007643   000017 236000 xsym               LDQ     AS_PROJ_ADMIN+15
         4 007644   000022 736000                    QLS     18
         4 007645   000022 732000                    QRS     18
         4 007646   200120 756100                    STQ     I+2,,AUTO
         4 007647   000017 236000 xsym               LDQ     AS_DEFAULT+15
         4 007650   000022 736000                    QLS     18
         4 007651   000022 732000                    QRS     18
         4 007652   200120 116100                    CMPQ    I+2,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:324  
         4 007653   007707 604000 4                  TMI     s:18505

     1886    18449    5      THEN DO;

     1887    18450        /*E* ERROR:   ASA-E$TOO_MANY_SUB_PROJS-C
     1888    18451        MESSAGE: You are not allowed to create another sub-project for project "%U2".
     1889    18452        MESSAGE1: Project "%U2" can have at most %U1 sub-projects. You cannot
     1890    18453                  create another sub-project for project "%U2".
     1891    18454        */
     1892    18455    5         I = AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS;

  18455  4 007654   000017 236000 xsym               LDQ     AS_PROJ_ADMIN+15
         4 007655   000022 736000                    QLS     18
         4 007656   000022 732000                    QRS     18
         4 007657   200057 756100                    STQ     I,,AUTO

     1893    18456              %NUMBER( NUM1=I );
             18464    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, I );

  18464  4 007660   200057 631500                    EPPR1   I,,AUTO
         4 007661   200123 451500                    STP1    I+5,,AUTO
         4 007662   000051 236000 5                  LDQ     41
         4 007663   200122 756100                    STQ     I+4,,AUTO
         4 007664   000060 237000 5                  LDAQ    48
         4 007665   200120 757100                    STAQ    I+2,,AUTO
         4 007666   200120 630500                    EPPR0   I+2,,AUTO
         4 007667   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 007670   000000 701000 xent               TSX1    ASB$BINCHAR
         4 007671   000000 011000                    NOP     0

     1894    18486    5         CALL ASA$KEYCONV( PROJECT, AS_FIELD2 );

  18486  4 007672   000174 236000 5                  LDQ     124
         4 007673   200075 235100                    LDA     @PROJECT,,AUTO
         4 007674   200120 757100                    STAQ    I+2,,AUTO
         4 007675   200120 630500                    EPPR0   I+2,,AUTO
         4 007676   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:325  
         4 007677   000000 701000 xent               TSX1    ASA$KEYCONV
         4 007700   000000 011000                    NOP     0

     1895    18487              %SCREAM( ERR#=E$TOO_MANY_SUB_PROJS, LEVEL=ERROR, MID='A' );

  18499  4 007701   000227 630400 5                  EPPR0   151
         4 007702   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007703   000000 701000 xent               TSX1    ASH$ERROR
         4 007704   000000 011000                    NOP     0

     1896    18502    5         ALTRETURN;

  18502  4 007705   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 007706   000000 702211                    TSX2  ! 0,X1

     1897    18503    5         END;
     1898    18504                                    /* Increment number of projects created */
     1899    18505    4      IF CODE ~= 69 /* MOD_USER_TO_PROJ_VAL */

  18505  4 007707   000000 235000 xsym               LDA     CODE
         4 007710   000105 115007                    CMPA    69,DL
         4 007711   007742 600000 4                  TZE     s:18567

     1900    18506    4      THEN AS_DEFAULT.BUDGET.SUB_PROJS = AS_DEFAULT.BUDGET.SUB_PROJS+1;

  18506  4 007712   000017 720000 xsym               LXL0    AS_DEFAULT+15
         4 007713   000001 621010                    EAX1    1,X0
         4 007714   000017 441000 xsym               SXL1    AS_DEFAULT+15

     1901    18507    4         END;

  18507  4 007715   007742 710000 4                  TRA     s:18567

     1902    18508    4      ELSE DO;

     1903    18509    4         IF AS_DFLT.BUDGET.PROJ_CREATED >= AS_DFLT.BUDGET.PROJ_ALLOWED

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:326  
  18509  4 007716   000011 236000 xsym               LDQ     AS_DFLT+9
         4 007717   000010 116000 xsym               CMPQ    AS_DFLT+8
         4 007720   007742 604000 4                  TMI     s:18567

     1904    18510    5         THEN DO;

     1905    18511        /*E* ERROR:   ASA-E$TOO_MANY_PROJ_USERS-C
     1906    18512        MESSAGE: You are not allowed to create another user for project "%U2".
     1907    18513        MESSAGE1: Project "%U2" can have at most %U1 users. You cannot create
     1908    18514                  another user for project "%U2".
     1909    18515        */
     1910    18516                 %NUMBER( NUM1=AS_DFLT.BUDGET.PROJ_CREATED, SIGN1 = YES );
             18526    5         CALL ASB$BINXCHAR( AS_FIELD1.TEXT, 0, -1, AS_DFLT.BUDGET.PROJ_CREATED );

  18526  4 007721   000230 630400 5                  EPPR0   152
         4 007722   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 007723   000000 701000 xent               TSX1    ASB$BINXCHAR
         4 007724   000000 011000                    NOP     0

     1911    18546    5            CALL ASA$KEYCONV( PROJECT, AS_FIELD2 );

  18546  4 007725   000174 236000 5                  LDQ     124
         4 007726   200075 235100                    LDA     @PROJECT,,AUTO
         4 007727   200120 757100                    STAQ    I+2,,AUTO
         4 007730   200120 630500                    EPPR0   I+2,,AUTO
         4 007731   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 007732   000000 701000 xent               TSX1    ASA$KEYCONV
         4 007733   000000 011000                    NOP     0

     1912    18547                 %SCREAM( ERR#=E$TOO_MANY_PROJ_USERS, LEVEL=ERROR, MID='A' );

  18559  4 007734   000234 630400 5                  EPPR0   156
         4 007735   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007736   000000 701000 xent               TSX1    ASH$ERROR
         4 007737   000000 011000                    NOP     0

     1913    18562    5            ALTRETURN;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:327  

  18562  4 007740   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 007741   000000 702211                    TSX2  ! 0,X1

     1914    18563    5            END;
     1915    18564    4         END;
     1916    18565
     1917    18566
     1918    18567    3   END CHECK_CREATE_OK;

  18567  4 007742   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 007743   000001 702211                    TSX2  ! 1,X1

     1919    18568        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:328  
     1920    18569    2   GET_FIRST: PROC ALTRET;

  18569  4 007744   200074 741300       GET_FIRST    STX1  ! ACCT_COUNT+2,,AUTO

     1921    18570
     1922    18571    3   CALL ASB$INIT_GET_NEXT( PROJ_FLAG, TYPE ) ;

  18571  4 007745   200067 630500                    EPPR0   TYPE,,AUTO
         4 007746   200121 450500                    STP0    I+3,,AUTO
         4 007747   200066 631500                    EPPR1   PROJ_FLAG,,AUTO
         4 007750   200120 451500                    STP1    I+2,,AUTO
         4 007751   200120 630500                    EPPR0   I+2,,AUTO
         4 007752   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 007753   000000 701000 xent               TSX1    ASB$INIT_GET_NEXT
         4 007754   000000 011000                    NOP     0

     1923    18572    3   COUNT = 0;

  18572  4 007755   200070 450100                    STZ     COUNT,,AUTO

     1924    18573    3   CALL ASB$GET_NEXT ALTRET( ALT );

  18573  4 007756   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 007757   000000 701000 xent               TSX1    ASB$GET_NEXT
         4 007760   010010 702000 4                  TSX2    ALT

     1925    18574    3   AS_RESOURCE_LIST$ -> UBIN$WORD = 0;

  18574  4 007761   000000 470400 xsym               LDP0    AS_RESOURCE_LIST$
         4 007762   000000 450100                    STZ     0,,PR0

     1926    18575    3   AS_PSEUDO_LIST$ -> UBIN$WORD = 0;

  18575  4 007763   000000 470400 xsym               LDP0    AS_PSEUDO_LIST$
         4 007764   000000 450100                    STZ     0,,PR0

     1927    18576    3   AS_FERESOURCE_LIST$ -> UBIN$WORD = 0;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:329  

  18576  4 007765   000000 470400 xsym               LDP0    AS_FERESOURCE_LIST$
         4 007766   000000 450100                    STZ     0,,PR0

     1928    18577    3   AS_FEPSEUDO_LIST$ -> UBIN$WORD = 0;

  18577  4 007767   000000 470400 xsym               LDP0    AS_FEPSEUDO_LIST$
         4 007770   000000 450100                    STZ     0,,PR0

     1929    18578    3   CALL ASB$LIST( USERS_KEY );

  18578  4 007771   000121 630400 5                  EPPR0   81
         4 007772   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007773   000000 701000 xent               TSX1    ASB$LIST
         4 007774   000000 011000                    NOP     0

     1930    18579    3   COUNT = 1;

  18579  4 007775   000001 235007                    LDA     1,DL
         4 007776   200070 755100                    STA     COUNT,,AUTO

     1931    18580    3   CR_MOD_KEY = USERS_KEY;

  18580  4 007777   000100 100400                    MLR     fill='000'O
         4 010000   000000 000026 xsym               ADSC9   USERS_KEY                cn=0,n=22
         4 010001   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22

     1932    18581    3   SUPER_TO_PIG.ACCT = USERS_KEY.TXTC;

  18581  4 010002   000000 470400 xsym               LDP0    AS_SUPER_TO_PIG$
         4 010003   040100 100400                    MLR     fill='040'O
         4 010004   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 010005   000014 000010                    ADSC9   12,,PR0                  cn=0,n=8

     1933    18582    3   RETURN;

  18582  4 010006   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:330  
         4 010007   000001 702211                    TSX2  ! 1,X1

     1934    18583
     1935    18584    3   ALT: ALTRETURN;

  18584  4 010010   200074 221300       ALT          LDX1  ! ACCT_COUNT+2,,AUTO
         4 010011   000000 702211                    TSX2  ! 0,X1

     1936    18585
     1937    18586    3   END GET_FIRST;
     1938    18587
     1939    18588
     1940    18589
     1941    18590
     1942    18591        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:331  
     1943    18592    2   GET_PACKSET_LIST: PROC  ALTRET;

  18592  4 010012   200074 741300       GET_PACKSET* STX1  ! ACCT_COUNT+2,,AUTO

     1944    18593
     1945    18594    3   DCL ALTRET_FLG BIT(1);
     1946    18595    3   DCL 1 DEST_PROJ ALIGNED,
     1947    18596    3          2 COUNT UBIN BYTE UNAL,
     1948    18597    3          2 TEXT CHAR(20);
     1949    18598
     1950    18599    3   PACKSET_COUNT = 0;

  18599  4 010013   200071 450100                    STZ     PACKSET_COUNT,,AUTO

     1951    18600    3   PROJ_KEY = CR_MOD_KEY;

  18600  4 010014   000000 100500                    MLR     fill='000'O
         4 010015   200051 000026                    ADSC9   CR_MOD_KEY,,AUTO         cn=0,n=22
         4 010016   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27

     1952    18601    3   CALL ASB$PREC_PROJ;

  18601  4 010017   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 010020   000000 701000 xent               TSX1    ASB$PREC_PROJ
         4 010021   000000 011000                    NOP     0

     1953    18602    3   ARS = DSEG1SIZE;

  18602  4 010022   000000 235000 xsym               LDA     DSEG1SIZE
         4 010023   200003 755100                    STA     ARS,,AUTO

     1954    18603    3   PTR$ = DSEG1$;

  18603  4 010024   000000 236000 xsym               LDQ     DSEG1$
         4 010025   200062 756100                    STQ     PTR$,,AUTO

     1955    18604    3   CALL ASB$READ_PROJ_SEQ( PTR$, ARS ) ALTRET( FINISHED );
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:332  

  18604  4 010026   200003 630500                    EPPR0   ARS,,AUTO
         4 010027   200121 450500                    STP0    I+3,,AUTO
         4 010030   200062 631500                    EPPR1   PTR$,,AUTO
         4 010031   200120 451500                    STP1    I+2,,AUTO
         4 010032   200120 630500                    EPPR0   I+2,,AUTO
         4 010033   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010034   000000 701000 xent               TSX1    ASB$READ_PROJ_SEQ
         4 010035   010103 702000 4                  TSX2    FINISHED

     1956    18605    4   DO WHILE( PROJ_KEY.TXT.PROJECT = (SUBSTR(CR_MOD_KEY.TEXT,0,20)) );

  18605  4 010036   010077 710000 4                  TRA     s:18612

     1957    18606    4      CALL  ASB$ENQ_PROJ;

  18606  4 010037   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 010040   000000 701000 xent               TSX1    ASB$ENQ_PROJ
         4 010041   000000 011000                    NOP     0

     1958    18607    4      PACKSET$LIST.PSN(PACKSET_COUNT) = SUBSTR(PROJ_KEY.TEXT,20,PROJ_KEY.COUNT-20);

  18607  4 010042   200071 236100                    LDQ     PACKSET_COUNT,,AUTO
         4 010043   000016 402007                    MPY     14,DL
         4 010044   000000 620006                    EAX0    0,QL
         4 010045   000000 236000 xsym               LDQ     PROJ_KEY
         4 010046   000033 772000                    QRL     27
         4 010047   777754 621006                    EAX1    -20,QL
         4 010050   000000 635010                    EAA     0,X0
         4 010051   000020 731000                    ARS     16
         4 010052   000000 470400 xsym               LDP0    DSEG1$
         4 010053   040105 100440                    MLR     fill='040'O
         4 010054   000005 200011 xsym               ADSC9   PROJ_KEY+5               cn=1,n=*X1
         4 010055   000014 000010                    ADSC9   12,A,PR0                 cn=0,n=8

     1959    18608    4      PACKSET_COUNT = PACKSET_COUNT + 1;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:333  
  18608  4 010056   200071 054100                    AOS     PACKSET_COUNT,,AUTO

     1960    18609    4      PTR$ = PINCRW( PTR$, SIZEW(PACKSET$LIST(0)) );

  18609  4 010057   200062 236100                    LDQ     PTR$,,AUTO
         4 010060   000016 036003                    ADLQ    14,DU
         4 010061   200062 756100                    STQ     PTR$,,AUTO

     1961    18610    4      ARS = DSEG1SIZE - PACKSET_COUNT*SIZEC(PACKSET$LIST(0));

  18610  4 010062   000000 236003                    LDQ     0,DU
         4 010063   200071 136100                    SBLQ    PACKSET_COUNT,,AUTO
         4 010064   000070 402007                    MPY     56,DL
         4 010065   000000 036000 xsym               ADLQ    DSEG1SIZE
         4 010066   200003 756100                    STQ     ARS,,AUTO

     1962    18611    4      CALL ASB$READ_PROJ_SEQ( PTR$, ARS ) ALTRET( FINISHED );

  18611  4 010067   200003 630500                    EPPR0   ARS,,AUTO
         4 010070   200121 450500                    STP0    I+3,,AUTO
         4 010071   200062 631500                    EPPR1   PTR$,,AUTO
         4 010072   200120 451500                    STP1    I+2,,AUTO
         4 010073   200120 630500                    EPPR0   I+2,,AUTO
         4 010074   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010075   000000 701000 xent               TSX1    ASB$READ_PROJ_SEQ
         4 010076   010103 702000 4                  TSX2    FINISHED

     1963    18612    4      END;

  18612  4 010077   040100 106400                    CMPC    fill='040'O
         4 010100   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20
         4 010101   200051 200024                    ADSC9   CR_MOD_KEY,,AUTO         cn=1,n=20
         4 010102   010037 600000 4                  TZE     s:18606

     1964    18613    3   FINISHED:
     1965    18614    3   IF PACKSET_COUNT>0 AND (CODE=68 /* TIE_PROJ_VAL */ OR AS_PROJECT_ADMIN ~= AS_NONE)

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:334  
  18614  4 010103   200071 235100       FINISHED     LDA     PACKSET_COUNT,,AUTO
         4 010104   010317 604400 4                  TMOZ    s:18679
         4 010105   000000 236000 xsym               LDQ     CODE
         4 010106   000104 116007                    CMPQ    68,DL
         4 010107   010114 600000 4                  TZE     s:18616
         4 010110   000000 106400                    CMPC    fill='000'O
         4 010111   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 010112   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 010113   010317 600000 4                  TZE     s:18679

     1966    18615    4   THEN DO;

     1967    18616    4      IF CODE = 68 /* TIE_PROJ_VAL */

  18616  4 010114   000104 116007                    CMPQ    68,DL
         4 010115   010122 601000 4                  TNZ     s:18618

     1968    18617    4      THEN DEST_PROJ = FROM_KEY;

  18617  4 010116   000100 100400                    MLR     fill='000'O
         4 010117   000000 000025 xsym               ADSC9   FROM_KEY                 cn=0,n=21
         4 010120   200076 000025                    ADSC9   DEST_PROJ,,AUTO          cn=0,n=21
         4 010121   010125 710000 4                  TRA     s:18619

     1969    18618    4      ELSE DEST_PROJ = AS_PROJECT_ADMIN;

  18618  4 010122   000100 100400                    MLR     fill='000'O
         4 010123   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 010124   200076 000025                    ADSC9   DEST_PROJ,,AUTO          cn=0,n=21

     1970    18619    4      ALTRET_FLG = '0'B;

  18619  4 010125   200075 450100                    STZ     ALTRET_FLG,,AUTO

     1971    18620    5      DO I = 0 TO PACKSET_COUNT-1;

  18620  4 010126   200057 450100                    STZ     I,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:335  
         4 010127   010305 710000 4                  TRA     s:18672+1

     1972    18621    5         CALL READ_PROJ_REC(DEST_PROJ,PACKSET$LIST.PSN(I),DSEG3$) ALTRET(ALT);

  18621  4 010130   000235 236000 5                  LDQ     157
         4 010131   200115 756100                    STQ     @PACKSET+1,,AUTO
         4 010132   200057 236100                    LDQ     I,,AUTO
         4 010133   000016 402003                    MPY     14,DU
         4 010134   000014 036003                    ADLQ    12,DU
         4 010135   000000 036000 xsym               ADLQ    DSEG1$
         4 010136   200114 756100                    STQ     @PROJECT+1,,AUTO
         4 010137   200076 630500                    EPPR0   DEST_PROJ,,AUTO
         4 010140   200113 450500                    STP0    ALTRET_FLG+2,,AUTO
         4 010141   011271 701000 4                  TSX1    READ_PROJ_REC
         4 010142   010302 702000 4                  TSX2    ALT

     1973    18622    5         IF AS_PROJECT_ADMIN = AS_NONE

  18622  4 010143   000000 106400                    CMPC    fill='000'O
         4 010144   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 010145   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 010146   010173 601000 4                  TNZ     s:18625

     1974    18623    5         THEN CALL ASB$ACCT_OK(PACKSET$LIST.SKELETON(I),

  18623  4 010147   000235 236000 5                  LDQ     157
         4 010150   200124 756100                    STQ     I+6,,AUTO
         4 010151   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 010152   200123 756100                    STQ     I+5,,AUTO
         4 010153   200076 630500                    EPPR0   DEST_PROJ,,AUTO
         4 010154   200122 450500                    STP0    I+4,,AUTO
         4 010155   200057 236100                    LDQ     I,,AUTO
         4 010156   000016 402003                    MPY     14,DU
         4 010157   000014 036003                    ADLQ    12,DU
         4 010160   000000 036000 xsym               ADLQ    DSEG1$
         4 010161   200121 756100                    STQ     I+3,,AUTO
         4 010162   200057 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:336  
         4 010163   000016 402003                    MPY     14,DU
         4 010164   000010 036003                    ADLQ    8,DU
         4 010165   000000 036000 xsym               ADLQ    DSEG1$
         4 010166   200120 756100                    STQ     I+2,,AUTO
         4 010167   200120 630500                    EPPR0   I+2,,AUTO
         4 010170   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 010171   000000 701000 xent               TSX1    ASB$ACCT_OK
         4 010172   010302 702000 4                  TSX2    ALT

     1975    18624    5                 PACKSET$LIST.PSN(I),DEST_PROJ,,DSEG3$) ALTRET(ALT);
     1976    18625    5         IF (PACKSET$LIST.MAX_NUM_GRANS(I)+DSEG3$->AS$PROJ.GRANS_ACCUM)

  18625  4 010173   000000 470400 xsym               LDP0    DSEG3$
         4 010174   200057 236100                    LDQ     I,,AUTO
         4 010175   000016 402007                    MPY     14,DL
         4 010176   000000 471400 xsym               LDP1    DSEG1$
         4 010177   100006 236106                    LDQ     6,QL,PR1
         4 010200   000007 036100                    ADLQ    7,,PR0
         4 010201   010233 604000 4                  TMI     s:18648
         4 010202   000006 116100                    CMPQ    6,,PR0
         4 010203   010233 602000 4                  TNC     s:18648
         4 010204   010233 600000 4                  TZE     s:18648

     1977    18626    5              > DSEG3$->AS$PROJ.MAX_NUM_GRANS
     1978    18627    6         THEN DO;

     1979    18628    6            CALL ASA$KEYCONV( DEST_PROJ, AS_FIELD1 );

  18628  4 010205   000103 236000 5                  LDQ     67
         4 010206   200121 756100                    STQ     I+3,,AUTO
         4 010207   200076 633500                    EPPR3   DEST_PROJ,,AUTO
         4 010210   200120 453500                    STP3    I+2,,AUTO
         4 010211   200120 630500                    EPPR0   I+2,,AUTO
         4 010212   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010213   000000 701000 xent               TSX1    ASA$KEYCONV
         4 010214   000000 011000                    NOP     0

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:337  
     1980    18629    6            AS_FIELD2.COUNT = LENGTHC(PACKSET$LIST.PSN(I));

  18629  4 010215   010000 236003                    LDQ     4096,DU
         4 010216   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

     1981    18630    6            AS_FIELD2.TEXT  = PACKSET$LIST.PSN(I);

  18630  4 010217   200057 236100                    LDQ     I,,AUTO
         4 010220   000070 402007                    MPY     56,DL
         4 010221   000000 470400 xsym               LDP0    DSEG1$
         4 010222   040000 100506                    MLR     fill='040'O
         4 010223   000014 000010                    ADSC9   12,Q,PR0                 cn=0,n=8
         4 010224   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

     1982    18631                 %SCREAM(ERR#=E$TOO_MANY_GRANS2,MID='A',LEVEL=ERROR);

  18643  4 010225   000236 630400 5                  EPPR0   158
         4 010226   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 010227   000000 701000 xent               TSX1    ASH$ERROR
         4 010230   000000 011000                    NOP     0

     1983    18646    6            ALTRET_FLG = '1'B;

  18646  4 010231   400000 236003                    LDQ     -131072,DU
         4 010232   200075 756100                    STQ     ALTRET_FLG,,AUTO

     1984    18647    6            END;

     1985    18648    5         IF (PACKSET$LIST.NUM_ACCTS(I)+PACKSET$LIST.SUB_PROJ_ACCTS(I)

  18648  4 010233   200057 236100                    LDQ     I,,AUTO
         4 010234   000016 402007                    MPY     14,DL
         4 010235   000000 470400 xsym               LDP0    DSEG1$
         4 010236   000000 620006                    EAX0    0,QL
         4 010237   000005 236110                    LDQ     5,X0,PR0
         4 010240   777777 376007                    ANQ     -1,DL
         4 010241   000013 036110                    ADLQ    11,X0,PR0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:338  
         4 010242   000000 471400 xsym               LDP1    DSEG3$
         4 010243   100013 036100                    ADLQ    11,,PR1
         4 010244   200120 756100                    STQ     I+2,,AUTO
         4 010245   100005 236100                    LDQ     5,,PR1
         4 010246   777777 376007                    ANQ     -1,DL
         4 010247   200121 756100                    STQ     I+3,,AUTO
         4 010250   200120 236100                    LDQ     I+2,,AUTO
         4 010251   200121 036100                    ADLQ    I+3,,AUTO
         4 010252   010304 604000 4                  TMI     s:18672
         4 010253   100012 116100                    CMPQ    10,,PR1
         4 010254   010304 602000 4                  TNC     s:18672
         4 010255   010304 600000 4                  TZE     s:18672

     1986    18649    5              +DSEG3$->AS$PROJ.NUM_ACCTS+DSEG3$->AS$PROJ.SUB_PROJ_ACCTS)
     1987    18650    5              > DSEG3$->AS$PROJ.MAX_NUM_ACCTS
     1988    18651    6         THEN DO;

     1989    18652    6            CALL ASA$KEYCONV( DEST_PROJ, AS_FIELD1 );

  18652  4 010256   000103 236000 5                  LDQ     67
         4 010257   200121 756100                    STQ     I+3,,AUTO
         4 010260   200076 633500                    EPPR3   DEST_PROJ,,AUTO
         4 010261   200120 453500                    STP3    I+2,,AUTO
         4 010262   200120 630500                    EPPR0   I+2,,AUTO
         4 010263   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010264   000000 701000 xent               TSX1    ASA$KEYCONV
         4 010265   000000 011000                    NOP     0

     1990    18653    6            AS_FIELD2.COUNT = LENGTHC(PACKSET$LIST.PSN(I));

  18653  4 010266   010000 236003                    LDQ     4096,DU
         4 010267   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

     1991    18654    6            AS_FIELD2.TEXT  = PACKSET$LIST.PSN(I);

  18654  4 010270   200057 236100                    LDQ     I,,AUTO
         4 010271   000070 402007                    MPY     56,DL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:339  
         4 010272   000000 470400 xsym               LDP0    DSEG1$
         4 010273   040000 100506                    MLR     fill='040'O
         4 010274   000014 000010                    ADSC9   12,Q,PR0                 cn=0,n=8
         4 010275   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

     1992    18655                 %SCREAM(ERR#=E$TOO_MANY_F_ACCTS2,MID='A',LEVEL=ERROR);

  18667  4 010276   000237 630400 5                  EPPR0   159
         4 010277   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 010300   000000 701000 xent               TSX1    ASH$ERROR
         4 010301   000000 011000                    NOP     0

     1993    18670    6   ALT:     ALTRET_FLG = '1'B;

  18670  4 010302   400000 236003       ALT          LDQ     -131072,DU
         4 010303   200075 756100                    STQ     ALTRET_FLG,,AUTO

     1994    18671    6            END;

     1995    18672    5         END;

  18672  4 010304   200057 054100                    AOS     I,,AUTO
         4 010305   200057 236100                    LDQ     I,,AUTO
         4 010306   200071 116100                    CMPQ    PACKSET_COUNT,,AUTO
         4 010307   010130 604000 4                  TMI     s:18621

     1996    18673    5      IF ALTRET_FLG THEN DO;

  18673  4 010310   200075 234100                    SZN     ALTRET_FLG,,AUTO
         4 010311   010317 605000 4                  TPL     s:18679

     1997    18674    5         CALL ASB$DEQ_PROJ;

  18674  4 010312   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 010313   000000 701000 xent               TSX1    ASB$DEQ_PROJ
         4 010314   000000 011000                    NOP     0

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:340  
     1998    18675    5         ALTRETURN;

  18675  4 010315   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 010316   000000 702211                    TSX2  ! 0,X1

     1999    18676    5         END;
     2000    18677    4      END;
     2001    18678
     2002    18679    3   END GET_PACKSET_LIST;

  18679  4 010317   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 010320   000001 702211                    TSX2  ! 1,X1

     2003    18680        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:341  
     2004    18681        /*I*  NAME:       GET_ACCT_LIST
     2005    18682              PURPOSE:    Process the FACCOUNT list specified for the UNTIE user,
     2006    18683                          TIE user, and MODIFY user TO PROJECT commands.
     2007    18684              CALL:       CALL GET_ACCT_LIST(FACCT_INX) ALTRET(label)
     2008    18685              INPUT:      FACCT_INX -   P$NODE.SUBLK$(FACCT_INX) points to the
     2009    18686                                        FACCOUNT list, if it exists.
     2010    18687              OUTPUT:     ACCT_COUNT is the number of unique accounts in the list
     2011    18688                          ACCT$LIST contains the account list, sorted in ascending order
     2012    18689              DESCRIPTION:
     2013    18690                  The procedure processes the parse tree and builds ACCT$LIST
     2014    18691                  sorted in ascending order.  Then it checks to see if all the
     2015    18692                  accounts really exist.  For the TIE user and MODIFY user TO PROJECT
     2016    18693                  commands, it also verifies that the accounts can be added to the
     2017    18694                  packsets for the specified project and that they are consistent
     2018    18695                  with the account skeletons for the packsets.  If any errors
     2019    18696                  are detected, the altreturn is taken.
     2020    18697        */
     2021    18698    2   GET_ACCT_LIST: PROC( FACCT_INX ) ALTRET;

  18698  4 010321   200074 741300       GET_ACCT_LI* STX1  ! ACCT_COUNT+2,,AUTO

     2022    18699
     2023    18700    3   DCL FACCT_INX UBIN;
     2024    18701
     2025    18702    3   DCL PACKSET CHAR(6);
     2026    18703    3   DCL GRANS UBIN;
     2027    18704    3   DCL ACCTS UBIN;
     2028    18705    3   DCL 1 DEST_PROJ ALIGNED,
     2029    18706    3          2 COUNT UBIN BYTE UNAL,
     2030    18707    3          2 TEXT CHAR(21);
     2031    18708    3   DCL ACCT_IN_PROJ BIT(1);
     2032    18709    3   DCL ALTRET_FLG BIT(1);
     2033    18710
     2034    18711
     2035    18712    3   ACCT_COUNT = 0;

  18712  4 010322   200072 450100                    STZ     ACCT_COUNT,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:342  

     2036    18713    3   IF P$NODE.SUBNODES = FACCT_INX THEN RETURN;   /* Faccount not specified */

  18713  4 010323   200075 470500                    LDP0    @FACCT_INX,,AUTO
         4 010324   000000 471400 xsym               LDP1    NODE$
         4 010325   100001 236100                    LDQ     1,,PR1
         4 010326   000022 772000                    QRL     18
         4 010327   000000 116100                    CMPQ    0,,PR0
         4 010330   010332 601000 4                  TNZ     s:18714

  18713  4 010331   000001 702211                    TSX2  ! 1,X1

     2037    18714    3   ALTRET_FLG = '0'B;

  18714  4 010332   200111 450100                    STZ     ALTRET_FLG,,AUTO

     2038    18715    3   PAR$ = P$NODE.SUBLK$(FACCT_INX);

  18715  4 010333   000000 720100                    LXL0    0,,PR0
         4 010334   100003 236110                    LDQ     3,X0,PR1
         4 010335   200063 756100                    STQ     PAR$,,AUTO

     2039    18716    4   IF PAR$->P$NODE.SUBNODES = 0 THEN DO;

  18716  4 010336   200063 473500                    LDP3    PAR$,,AUTO
         4 010337   300001 222100                    LDX2    1,,PR3
         4 010340   010354 601000 4                  TNZ     s:18724

     2040    18717                                           /* Faccount specified, but no account list */
     2041    18718    4      ACCT$LIST.PSN(0) = AS_USERS.HPSN;

  18718  4 010341   000000 474400 xsym               LDP4    DSEG1$
         4 010342   040100 100400                    MLR     fill='040'O
         4 010343   000123 000006 xsym               ADSC9   AS_USERS+83              cn=0,n=6
         4 010344   400000 000006                    ADSC9   0,,PR4                   cn=0,n=6

     2042    18719    4      ACCT$LIST.ACCT(0) = AS_USERS.ACCT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:343  

  18719  4 010345   000000 471400 xsym               LDP1    DSEG1$
         4 010346   040100 100400                    MLR     fill='040'O
         4 010347   000000 000010 xsym               ADSC9   AS_USERS                 cn=0,n=8
         4 010350   100001 400010                    ADSC9   1,,PR1                   cn=2,n=8

     2043    18720    4      ACCT_COUNT = 1;

  18720  4 010351   000001 235007                    LDA     1,DL
         4 010352   200072 755100                    STA     ACCT_COUNT,,AUTO

     2044    18721    4      END;

  18721  4 010353   010547 710000 4                  TRA     s:18751

     2045    18722    4   ELSE DO;

     2046    18723                                          /* Build ACCT$LIST, keep in ascending order */
     2047    18724    5      DO I = 0 TO PAR$->P$NODE.SUBNODES-1;

  18724  4 010354   200057 450100                    STZ     I,,AUTO
         4 010355   010542 710000 4                  TRA     s:18746+1

     2048    18725    5         PTR$ = PAR$->P$NODE.SUBLK$(I);

  18725  4 010356   200063 470500                    LDP0    PAR$,,AUTO
         4 010357   200057 720100                    LXL0    I,,AUTO
         4 010360   000003 236110                    LDQ     3,X0,PR0
         4 010361   200062 756100                    STQ     PTR$,,AUTO

     2049    18726    5         ACCT$LIST(ACCT_COUNT+2) = '0'B;

  18726  4 010362   200072 236100                    LDQ     ACCT_COUNT,,AUTO
         4 010363   000024 402007                    MPY     20,DL
         4 010364   000000 471400 xsym               LDP1    DSEG1$
         4 010365   000106 100400                    MLR     fill='000'O
         4 010366   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:344  
         4 010367   100012 000024                    ADSC9   10,Q,PR1                 cn=0,n=20

     2050    18727    6         IF PTR$->P$NODE.SUBNODES = 1 THEN DO;

  18727  4 010370   200062 471500                    LDP1    PTR$,,AUTO
         4 010371   100001 220100                    LDX0    1,,PR1
         4 010372   000001 100003                    CMPX0   1,DU
         4 010373   010422 601000 4                  TNZ     s:18732

     2051    18728    6            ACCT$LIST.PSN(ACCT_COUNT+2)  = AS_USERS.HPSN;

  18728  4 010374   200072 236100                    LDQ     ACCT_COUNT,,AUTO
         4 010375   000005 402007                    MPY     5,DL
         4 010376   000002 736000                    QLS     2
         4 010377   000000 473400 xsym               LDP3    DSEG1$
         4 010400   040106 100400                    MLR     fill='040'O
         4 010401   000123 000006 xsym               ADSC9   AS_USERS+83              cn=0,n=6
         4 010402   300012 000006                    ADSC9   10,Q,PR3                 cn=0,n=6

     2052    18729    6            ACCT$LIST.ACCT(ACCT_COUNT+2) = PTR$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT;

  18729  4 010403   200072 236100                    LDQ     ACCT_COUNT,,AUTO
         4 010404   000005 402007                    MPY     5,DL
         4 010405   200062 471500                    LDP1    PTR$,,AUTO
         4 010406   100003 473500                    LDP3    3,,PR1
         4 010407   000000 620006                    EAX0    0,QL
         4 010410   300004 236100                    LDQ     4,,PR3
         4 010411   000033 772000                    QRL     27
         4 010412   000000 635010                    EAA     0,X0
         4 010413   000020 731000                    ARS     16
         4 010414   000000 621006                    EAX1    0,QL
         4 010415   000000 474400 xsym               LDP4    DSEG1$
         4 010416   040105 100540                    MLR     fill='040'O
         4 010417   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 010420   400013 400010                    ADSC9   11,A,PR4                 cn=2,n=8

     2053    18730    6            END;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:345  

  18730  4 010421   010455 710000 4                  TRA     s:18735

     2054    18731    6         ELSE DO;

     2055    18732    6            ACCT$LIST.PSN(ACCT_COUNT+2)  = PTR$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT;

  18732  4 010422   200072 236100                    LDQ     ACCT_COUNT,,AUTO
         4 010423   000005 402007                    MPY     5,DL
         4 010424   100003 473500                    LDP3    3,,PR1
         4 010425   000000 621006                    EAX1    0,QL
         4 010426   300004 236100                    LDQ     4,,PR3
         4 010427   000033 772000                    QRL     27
         4 010430   000000 635011                    EAA     0,X1
         4 010431   000020 731000                    ARS     16
         4 010432   000000 622006                    EAX2    0,QL
         4 010433   000000 474400 xsym               LDP4    DSEG1$
         4 010434   040105 100540                    MLR     fill='040'O
         4 010435   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         4 010436   400012 000006                    ADSC9   10,A,PR4                 cn=0,n=6

     2056    18733    6            ACCT$LIST.ACCT(ACCT_COUNT+2) = PTR$->P$NODE.SUBLK$(1)->OUT$SYM.TEXT;

  18733  4 010437   200072 236100                    LDQ     ACCT_COUNT,,AUTO
         4 010440   000005 402007                    MPY     5,DL
         4 010441   200062 471500                    LDP1    PTR$,,AUTO
         4 010442   100004 473500                    LDP3    4,,PR1
         4 010443   000000 620006                    EAX0    0,QL
         4 010444   300004 236100                    LDQ     4,,PR3
         4 010445   000033 772000                    QRL     27
         4 010446   000000 635010                    EAA     0,X0
         4 010447   000020 731000                    ARS     16
         4 010450   000000 621006                    EAX1    0,QL
         4 010451   000000 474400 xsym               LDP4    DSEG1$
         4 010452   040105 100540                    MLR     fill='040'O
         4 010453   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 010454   400013 400010                    ADSC9   11,A,PR4                 cn=2,n=8
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:346  

     2057    18734    6            END;

     2058    18735    5         J = 0;

  18735  4 010455   200060 450100                    STZ     J,,AUTO

     2059    18736    6         DO WHILE(J < ACCT_COUNT  AND  ACCT$LIST(J) < ACCT$LIST(ACCT_COUNT+2) );

  18736  4 010456   010460 710000 4                  TRA     s:18738

     2060    18737    6            J = J + 1;

  18737  4 010457   200060 054100                    AOS     J,,AUTO

     2061    18738    6            END;

  18738  4 010460   200060 236100                    LDQ     J,,AUTO
         4 010461   200072 116100                    CMPQ    ACCT_COUNT,,AUTO
         4 010462   010475 605000 4                  TPL     s:18739
         4 010463   000024 402007                    MPY     20,DL
         4 010464   200120 756100                    STQ     I+2,,AUTO
         4 010465   200072 236100                    LDQ     ACCT_COUNT,,AUTO
         4 010466   000024 402007                    MPY     20,DL
         4 010467   000000 470400 xsym               LDP0    DSEG1$
         4 010470   200120 235100                    LDA     I+2,,AUTO
         4 010471   000106 106505                    CMPC    fill='000'O
         4 010472   000000 000024                    ADSC9   0,A,PR0                  cn=0,n=20
         4 010473   000012 000024                    ADSC9   10,Q,PR0                 cn=0,n=20
         4 010474   010457 602000 4                  TNC     s:18737

     2062    18739    6         IF ACCT$LIST(J) ~= ACCT$LIST(ACCT_COUNT+2) THEN DO;

  18739  4 010475   200060 236100                    LDQ     J,,AUTO
         4 010476   000024 402007                    MPY     20,DL
         4 010477   200120 756100                    STQ     I+2,,AUTO
         4 010500   200072 236100                    LDQ     ACCT_COUNT,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:347  
         4 010501   000024 402007                    MPY     20,DL
         4 010502   000000 470400 xsym               LDP0    DSEG1$
         4 010503   200120 235100                    LDA     I+2,,AUTO
         4 010504   000106 106505                    CMPC    fill='000'O
         4 010505   000000 000024                    ADSC9   0,A,PR0                  cn=0,n=20
         4 010506   000012 000024                    ADSC9   10,Q,PR0                 cn=0,n=20
         4 010507   010541 600000 4                  TZE     s:18746

     2063    18740    7            DO K = ACCT_COUNT DOWNTO J+1;

  18740  4 010510   200072 235100                    LDA     ACCT_COUNT,,AUTO
         4 010511   200061 755100                    STA     K,,AUTO
         4 010512   010523 710000 4                  TRA     s:18742+2

     2064    18741    7               ACCT$LIST(K) = ACCT$LIST(K-1);

  18741  4 010513   200061 236100                    LDQ     K,,AUTO
         4 010514   000024 402007                    MPY     20,DL
         4 010515   000000 470400 xsym               LDP0    DSEG1$
         4 010516   000106 100506                    MLR     fill='000'O
         4 010517   077773 000024                    ADSC9   -5,Q,PR0                 cn=0,n=20
         4 010520   000000 000024                    ADSC9   0,Q,PR0                  cn=0,n=20

     2065    18742    7               END;

  18742  4 010521   000001 336007                    LCQ     1,DL
         4 010522   200061 056100                    ASQ     K,,AUTO
         4 010523   200061 236100                    LDQ     K,,AUTO
         4 010524   200060 116100                    CMPQ    J,,AUTO
         4 010525   010513 605400 4                  TPNZ    s:18741

     2066    18743    6            ACCT$LIST(J) = ACCT$LIST(ACCT_COUNT+2);

  18743  4 010526   200072 236100                    LDQ     ACCT_COUNT,,AUTO
         4 010527   000024 402007                    MPY     20,DL
         4 010530   200120 756100                    STQ     I+2,,AUTO
         4 010531   200060 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:348  
         4 010532   000024 402007                    MPY     20,DL
         4 010533   000000 470400 xsym               LDP0    DSEG1$
         4 010534   200120 235100                    LDA     I+2,,AUTO
         4 010535   000106 100505                    MLR     fill='000'O
         4 010536   000012 000024                    ADSC9   10,A,PR0                 cn=0,n=20
         4 010537   000000 000024                    ADSC9   0,Q,PR0                  cn=0,n=20

     2067    18744    6            ACCT_COUNT = ACCT_COUNT + 1;

  18744  4 010540   200072 054100                    AOS     ACCT_COUNT,,AUTO

     2068    18745    6            END;

     2069    18746    5         END;

  18746  4 010541   200057 054100                    AOS     I,,AUTO
         4 010542   200063 470500                    LDP0    PAR$,,AUTO
         4 010543   000001 236100                    LDQ     1,,PR0
         4 010544   000022 772000                    QRL     18
         4 010545   200057 116100                    CMPQ    I,,AUTO
         4 010546   010356 605400 4                  TPNZ    s:18725

     2070    18747    4      END;

     2071    18748        /*
     2072    18749                          Verify that all accounts exist and get max grans for each
     2073    18750        */
     2074    18751    3   IF CODE = 67 /* TIE_USER_VAL */

  18751  4 010547   000000 235000 xsym               LDA     CODE
         4 010550   000103 115007                    CMPA    67,DL
         4 010551   010556 601000 4                  TNZ     s:18753

     2075    18752    3   THEN DEST_PROJ = FROM_KEY;

  18752  4 010552   000100 100400                    MLR     fill='000'O
         4 010553   000000 000025 xsym               ADSC9   FROM_KEY                 cn=0,n=21
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:349  
         4 010554   200102 000026                    ADSC9   DEST_PROJ,,AUTO          cn=0,n=22
         4 010555   010570 710000 4                  TRA     s:18756

     2076    18753    3   ELSE IF AS_PROJECT_ADMIN ~= AS_NONE

  18753  4 010556   000000 106400                    CMPC    fill='000'O
         4 010557   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 010560   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 010561   010566 600000 4                  TZE     s:18755

     2077    18754    3      THEN DEST_PROJ = AS_PROJECT_ADMIN;

  18754  4 010562   000100 100400                    MLR     fill='000'O
         4 010563   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 010564   200102 000026                    ADSC9   DEST_PROJ,,AUTO          cn=0,n=22
         4 010565   010570 710000 4                  TRA     s:18756

     2078    18755    3      ELSE DEST_PROJ.COUNT = 0;

  18755  4 010566   000000 236003                    LDQ     0,DU
         4 010567   200102 552140                    STBQ    DEST_PROJ,'40'O,AUTO

     2079    18756    3   I = 0;

  18756  4 010570   200057 450100                    STZ     I,,AUTO

     2080    18757    4   DO WHILE( I < ACCT_COUNT );

  18757  4 010571   200057 236100                    LDQ     I,,AUTO
         4 010572   200072 116100                    CMPQ    ACCT_COUNT,,AUTO
         4 010573   011256 605000 4                  TPL     s:18898

     2081    18758    4      PACKSET = ACCT$LIST.PSN(I);

  18758  4 010574   200057 236100                    LDQ     I,,AUTO
         4 010575   000024 402007                    MPY     20,DL
         4 010576   000000 470400 xsym               LDP0    DSEG1$
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:350  
         4 010577   040100 100506                    MLR     fill='040'O
         4 010600   000000 000006                    ADSC9   0,Q,PR0                  cn=0,n=6
         4 010601   200076 000006                    ADSC9   PACKSET,,AUTO            cn=0,n=6

     2082    18759    4      IF DEST_PROJ.COUNT > 0

  18759  4 010602   200102 236100                    LDQ     DEST_PROJ,,AUTO
         4 010603   777000 316003                    CANQ    -512,DU
         4 010604   010617 600000 4                  TZE     s:18764

     2083    18760    5      THEN DO;

     2084    18761    5         CALL READ_PROJ_REC(DEST_PROJ,PACKSET,DSEG3$) ALTRET(SKIP_PACKSET);

  18761  4 010605   000235 236000 5                  LDQ     157
         4 010606   200115 756100                    STQ     @PACKSET+1,,AUTO
         4 010607   200076 631500                    EPPR1   PACKSET,,AUTO
         4 010610   200114 451500                    STP1    @PROJECT+1,,AUTO
         4 010611   200102 633500                    EPPR3   DEST_PROJ,,AUTO
         4 010612   200113 453500                    STP3    ALTRET_FLG+2,,AUTO
         4 010613   011271 701000 4                  TSX1    READ_PROJ_REC
         4 010614   011236 702000 4                  TSX2    SKIP_PACKSET

     2085    18762    5         GRANS = 0; ACCTS = 0;

  18762  4 010615   200100 450100                    STZ     GRANS,,AUTO

  18762  4 010616   200101 450100                    STZ     ACCTS,,AUTO

     2086    18763    5         END;

     2087    18764    4      IF AS_PROJECT_ADMIN ~= AS_NONE  OR  CODE = 65 /* UNTIE_USER_VAL */

  18764  4 010617   000000 106400                    CMPC    fill='000'O
         4 010620   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 010621   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 010622   010626 601000 4                  TNZ     s:18766
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:351  
         4 010623   000000 235000 xsym               LDA     CODE
         4 010624   000101 115007                    CMPA    65,DL
         4 010625   010641 601000 4                  TNZ     s:18769

     2088    18765    5      THEN DO;

     2089    18766    5        CALL READ_PROJ_REC(AS_USERS.BUDGET.MACCT,PACKSET,DSEG2$) ALTRET(SKIP_PACKSET);

  18766  4 010626   000161 236000 5                  LDQ     113
         4 010627   200115 756100                    STQ     @PACKSET+1,,AUTO
         4 010630   200076 630500                    EPPR0   PACKSET,,AUTO
         4 010631   200114 450500                    STP0    @PROJECT+1,,AUTO
         4 010632   000240 236000 5                  LDQ     160
         4 010633   200113 756100                    STQ     ALTRET_FLG+2,,AUTO
         4 010634   011271 701000 4                  TSX1    READ_PROJ_REC
         4 010635   011236 702000 4                  TSX2    SKIP_PACKSET

     2090    18767    5         ACCT_IN_PROJ = '1'B;

  18767  4 010636   400000 236003                    LDQ     -131072,DU
         4 010637   200110 756100                    STQ     ACCT_IN_PROJ,,AUTO

     2091    18768    5         END;

  18768  4 010640   010642 710000 4                  TRA     s:18770

     2092    18769    4      ELSE ACCT_IN_PROJ = '0'B;

  18769  4 010641   200110 450100                    STZ     ACCT_IN_PROJ,,AUTO

     2093    18770    5      DO WHILE( I < ACCT_COUNT  AND  ACCT$LIST.PSN(I) = PACKSET );

  18770  4 010642   011127 710000 4                  TRA     s:18836

     2094    18771    5         IF NOT ACCT_IN_PROJ

  18771  4 010643   200110 234100                    SZN     ACCT_IN_PROJ,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:352  
         4 010644   010670 604000 4                  TMI     s:18776

     2095    18772    6         THEN DO;            /* Account not in a project */

     2096    18773    6           CALL ASB$GET_MGRANS( ACCT$LIST.ACCT(I), ACCT$LIST.PSN(I), ACCT$LIST.GRANS(I
             18773                     ) ) ALTRET(NO_ACCT);

  18773  4 010645   200057 236100                    LDQ     I,,AUTO
         4 010646   000005 402003                    MPY     5,DU
         4 010647   000004 036003                    ADLQ    4,DU
         4 010650   000000 036000 xsym               ADLQ    DSEG1$
         4 010651   200122 756100                    STQ     I+4,,AUTO
         4 010652   200057 236100                    LDQ     I,,AUTO
         4 010653   000005 402003                    MPY     5,DU
         4 010654   000000 036000 xsym               ADLQ    DSEG1$
         4 010655   200121 756100                    STQ     I+3,,AUTO
         4 010656   200057 236100                    LDQ     I,,AUTO
         4 010657   000005 402003                    MPY     5,DU
         4 010660   000241 036000 5                  ADLQ    161
         4 010661   000000 036000 xsym               ADLQ    DSEG1$
         4 010662   200120 756100                    STQ     I+2,,AUTO
         4 010663   200120 630500                    EPPR0   I+2,,AUTO
         4 010664   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 010665   000000 701000 xent               TSX1    ASB$GET_MGRANS
         4 010666   011012 702000 4                  TSX2    NO_ACCT

     2097    18774    6            END;

  18774  4 010667   011015 710000 4                  TRA     s:18816

     2098    18775    6         ELSE DO;        /* Account must be on a packset for the project */

     2099    18776    6            PROJ_ACCT_LIST$ = PINCRW( ADDR(AS$PROJ.ATTRIBUTES),

  18776  4 010670   000000 470400 xsym               LDP0    DSEG2$
         4 010671   000014 236100                    LDQ     12,,PR0
         4 010672   000022 772000                    QRL     18
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:353  
         4 010673   000005 036007                    ADLQ    5,DL
         4 010674   000002 772000                    QRL     2
         4 010675   000022 736000                    QLS     18
         4 010676   000014 036003                    ADLQ    12,DU
         4 010677   000000 036000 xsym               ADLQ    DSEG2$
         4 010700   200064 756100                    STQ     PROJ_ACCT_LIST$,,AUTO

     2100    18777    6                 (AS$PROJ.ATTRIBUTES.COUNT + 5 ) / 4 );
     2101    18778    6            J = 0;

  18778  4 010701   200060 450100                    STZ     J,,AUTO

     2102    18779    7            DO WHILE(J<AS$PROJ.NUM_ACCTS AND PROJ$LIST.ACCT(J)<ACCT$LIST.ACCT(I));

  18779  4 010702   010704 710000 4                  TRA     s:18781

     2103    18780    7               J = J + 1;

  18780  4 010703   200060 054100                    AOS     J,,AUTO

     2104    18781    7               END;

  18781  4 010704   000000 470400 xsym               LDP0    DSEG2$
         4 010705   200060 236100                    LDQ     J,,AUTO
         4 010706   000013 116100                    CMPQ    11,,PR0
         4 010707   010723 605000 4                  TPL     s:18782
         4 010710   000014 402007                    MPY     12,DL
         4 010711   200120 756100                    STQ     I+2,,AUTO
         4 010712   200057 236100                    LDQ     I,,AUTO
         4 010713   000024 402007                    MPY     20,DL
         4 010714   200064 471500                    LDP1    PROJ_ACCT_LIST$,,AUTO
         4 010715   200120 235100                    LDA     I+2,,AUTO
         4 010716   000000 473400 xsym               LDP3    DSEG1$
         4 010717   040106 106505                    CMPC    fill='040'O
         4 010720   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=8
         4 010721   300001 400010                    ADSC9   1,Q,PR3                  cn=2,n=8
         4 010722   010703 602000 4                  TNC     s:18780
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:354  

     2105    18782    6            IF J < AS$PROJ.NUM_ACCTS AND PROJ$LIST.ACCT(J) = ACCT$LIST.ACCT(I)

  18782  4 010723   200060 236100                    LDQ     J,,AUTO
         4 010724   000013 116100                    CMPQ    11,,PR0
         4 010725   010751 605000 4                  TPL     s:18790
         4 010726   000014 402007                    MPY     12,DL
         4 010727   200120 756100                    STQ     I+2,,AUTO
         4 010730   200057 236100                    LDQ     I,,AUTO
         4 010731   000024 402007                    MPY     20,DL
         4 010732   200064 471500                    LDP1    PROJ_ACCT_LIST$,,AUTO
         4 010733   200120 235100                    LDA     I+2,,AUTO
         4 010734   000000 473400 xsym               LDP3    DSEG1$
         4 010735   040106 106505                    CMPC    fill='040'O
         4 010736   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=8
         4 010737   300001 400010                    ADSC9   1,Q,PR3                  cn=2,n=8
         4 010740   010751 601000 4                  TNZ     s:18790

     2106    18783    7            THEN DO;

     2107    18784    7               ACCT$LIST.GRANS(I) = PROJ$LIST.GRANS(J);

  18784  4 010741   200057 236100                    LDQ     I,,AUTO
         4 010742   000005 402007                    MPY     5,DL
         4 010743   000000 620006                    EAX0    0,QL
         4 010744   200060 236100                    LDQ     J,,AUTO
         4 010745   000003 402007                    MPY     3,DL
         4 010746   100002 235106                    LDA     2,QL,PR1
         4 010747   300004 755110                    STA     4,X0,PR3

     2108    18785    7               END;

  18785  4 010750   011015 710000 4                  TRA     s:18816

     2109    18786    7            ELSE DO;

     2110    18787        /*E*  ERROR:  ASA-E$ACCT_NOT_IN_PROJ-C
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:355  
     2111    18788              MESSAGE: DP#%U1.%U2 is not in project "%U3".
     2112    18789        */
     2113    18790    7               AS_FIELD1.TEXT = ACCT$LIST.PSN(I);

  18790  4 010751   200057 236100                    LDQ     I,,AUTO
         4 010752   000024 402007                    MPY     20,DL
         4 010753   000000 471400 xsym               LDP1    DSEG1$
         4 010754   040000 100506                    MLR     fill='040'O
         4 010755   100000 000006                    ADSC9   0,Q,PR1                  cn=0,n=6
         4 010756   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     2114    18791    7               CALL INDEX( K, AS_BLANK, AS_FIELD1.TEXT );

  18791  4 010757   000000 124400                    SCM     mask='000'O
         4 010760   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         4 010761   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 010762   200061 000100                    ARG     K,,AUTO

     2115    18792    7               AS_FIELD1.COUNT = K;

  18792  4 010763   200061 236100                    LDQ     K,,AUTO
         4 010764   000033 736000                    QLS     27
         4 010765   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     2116    18793    7               AS_FIELD2.TEXT = ACCT$LIST.ACCT(I);

  18793  4 010766   200057 236100                    LDQ     I,,AUTO
         4 010767   000024 402007                    MPY     20,DL
         4 010770   040000 100506                    MLR     fill='040'O
         4 010771   100001 400010                    ADSC9   1,Q,PR1                  cn=2,n=8
         4 010772   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

     2117    18794    7               CALL INDEX( K, AS_BLANK, AS_FIELD2.TEXT );

  18794  4 010773   000000 124400                    SCM     mask='000'O
         4 010774   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40
         4 010775   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:356  
         4 010776   200061 000100                    ARG     K,,AUTO

     2118    18795    7               AS_FIELD2.COUNT = K;

  18795  4 010777   200061 236100                    LDQ     K,,AUTO
         4 011000   000033 736000                    QLS     27
         4 011001   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

     2119    18796    7               CALL ASA$KEYCONV( AS_USERS.BUDGET.MACCT, AS_FIELD3 );

  18796  4 011002   000242 630400 5                  EPPR0   162
         4 011003   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011004   000000 701000 xent               TSX1    ASA$KEYCONV
         4 011005   000000 011000                    NOP     0

     2120    18797                    %SCREAM( ERR#=E$ACCT_NOT_IN_PROJ, MID='A', LEVEL=ERROR );

  18809  4 011006   000244 630400 5                  EPPR0   164
         4 011007   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011010   000000 701000 xent               TSX1    ASH$ERROR
         4 011011   000000 011000                    NOP     0

     2121    18812    7   NO_ACCT:    ALTRET_FLG = '1'B;

  18812  4 011012   400000 236003       NO_ACCT      LDQ     -131072,DU
         4 011013   200111 756100                    STQ     ALTRET_FLG,,AUTO

     2122    18813    7               GOTO NEXT;

  18813  4 011014   011126 710000 4                  TRA     NEXT

     2123    18814    7               END;
     2124    18815    6            END;
     2125    18816    5         IF DEST_PROJ.COUNT > 0

  18816  4 011015   200102 236100                    LDQ     DEST_PROJ,,AUTO
         4 011016   777000 316003                    CANQ    -512,DU
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:357  
         4 011017   011123 600000 4                  TZE     s:18832

     2126    18817    6         THEN DO;

     2127    18818    6            PROJ_ACCT_LIST$ = PINCRW(ADDR(DSEG3$->AS$PROJ.ATTRIBUTES),

  18818  4 011020   000000 470400 xsym               LDP0    DSEG3$
         4 011021   000014 236100                    LDQ     12,,PR0
         4 011022   000022 772000                    QRL     18
         4 011023   000005 036007                    ADLQ    5,DL
         4 011024   000002 772000                    QRL     2
         4 011025   000022 736000                    QLS     18
         4 011026   000014 036003                    ADLQ    12,DU
         4 011027   000000 036000 xsym               ADLQ    DSEG3$
         4 011030   200064 756100                    STQ     PROJ_ACCT_LIST$,,AUTO

     2128    18819    6                 (DSEG3$->AS$PROJ.ATTRIBUTES.COUNT+5)/4 );
     2129    18820    6            J = 0;

  18820  4 011031   200060 450100                    STZ     J,,AUTO

     2130    18821    7            DO WHILE( J < DSEG3$->AS$PROJ.NUM_ACCTS

  18821  4 011032   011034 710000 4                  TRA     s:18824

     2131    18822    7                 AND  PROJ$LIST.ACCT(J) < ACCT$LIST.ACCT(I) );
     2132    18823    7               J = J + 1;

  18823  4 011033   200060 054100                    AOS     J,,AUTO

     2133    18824    7               END;

  18824  4 011034   000000 470400 xsym               LDP0    DSEG3$
         4 011035   200060 236100                    LDQ     J,,AUTO
         4 011036   000013 116100                    CMPQ    11,,PR0
         4 011037   011053 605000 4                  TPL     s:18825
         4 011040   000014 402007                    MPY     12,DL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:358  
         4 011041   200120 756100                    STQ     I+2,,AUTO
         4 011042   200057 236100                    LDQ     I,,AUTO
         4 011043   000024 402007                    MPY     20,DL
         4 011044   200064 471500                    LDP1    PROJ_ACCT_LIST$,,AUTO
         4 011045   200120 235100                    LDA     I+2,,AUTO
         4 011046   000000 473400 xsym               LDP3    DSEG1$
         4 011047   040106 106505                    CMPC    fill='040'O
         4 011050   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=8
         4 011051   300001 400010                    ADSC9   1,Q,PR3                  cn=2,n=8
         4 011052   011033 602000 4                  TNC     s:18823

     2134    18825    6            IF J < DSEG3$->AS$PROJ.NUM_ACCTS

  18825  4 011053   200060 236100                    LDQ     J,,AUTO
         4 011054   000013 116100                    CMPQ    11,,PR0
         4 011055   011071 605000 4                  TPL     s:18828
         4 011056   000014 402007                    MPY     12,DL
         4 011057   200120 756100                    STQ     I+2,,AUTO
         4 011060   200057 236100                    LDQ     I,,AUTO
         4 011061   000024 402007                    MPY     20,DL
         4 011062   200064 471500                    LDP1    PROJ_ACCT_LIST$,,AUTO
         4 011063   200120 235100                    LDA     I+2,,AUTO
         4 011064   000000 473400 xsym               LDP3    DSEG1$
         4 011065   040106 106505                    CMPC    fill='040'O
         4 011066   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=8
         4 011067   300001 400010                    ADSC9   1,Q,PR3                  cn=2,n=8
         4 011070   011126 600000 4                  TZE     NEXT

     2135    18826    6                 AND PROJ$LIST.ACCT(J) = ACCT$LIST.ACCT(I)
     2136    18827    6            THEN GOTO NEXT;
     2137    18828    6            CALL ASB$ACCT_OK(ACCT$LIST.ACCT(I),PACKSET,DEST_PROJ,,DSEG3$) ALTRET(
             18828                     NO_MATCH);

  18828  4 011071   000235 236000 5                  LDQ     157
         4 011072   200124 756100                    STQ     I+6,,AUTO
         4 011073   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 011074   200123 756100                    STQ     I+5,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:359  
         4 011075   200102 631500                    EPPR1   DEST_PROJ,,AUTO
         4 011076   200122 451500                    STP1    I+4,,AUTO
         4 011077   200076 633500                    EPPR3   PACKSET,,AUTO
         4 011100   200121 453500                    STP3    I+3,,AUTO
         4 011101   200057 236100                    LDQ     I,,AUTO
         4 011102   000005 402003                    MPY     5,DU
         4 011103   000241 036000 5                  ADLQ    161
         4 011104   000000 036000 xsym               ADLQ    DSEG1$
         4 011105   200120 756100                    STQ     I+2,,AUTO
         4 011106   200120 630500                    EPPR0   I+2,,AUTO
         4 011107   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 011110   000000 701000 xent               TSX1    ASB$ACCT_OK
         4 011111   011124 702000 4                  TSX2    NO_MATCH

     2138    18829    6            GRANS = GRANS + ACCT$LIST.GRANS(I);

  18829  4 011112   200057 236100                    LDQ     I,,AUTO
         4 011113   000005 402007                    MPY     5,DL
         4 011114   000000 470400 xsym               LDP0    DSEG1$
         4 011115   000004 236106                    LDQ     4,QL,PR0
         4 011116   200100 036100                    ADLQ    GRANS,,AUTO
         4 011117   200100 756100                    STQ     GRANS,,AUTO

     2139    18830    6            ACCTS = ACCTS + 1;

  18830  4 011120   200101 235100                    LDA     ACCTS,,AUTO
         4 011121   000001 035007                    ADLA    1,DL
         4 011122   200101 755100                    STA     ACCTS,,AUTO

     2140    18831    6            END;

     2141    18832    6         DO WHILE('0'B);

  18832  4 011123   011126 710000 4                  TRA     NEXT

     2142    18833    6   NO_MATCH: ALTRET_FLG = '1'B;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:360  
  18833  4 011124   400000 236003       NO_MATCH     LDQ     -131072,DU
         4 011125   200111 756100                    STQ     ALTRET_FLG,,AUTO

     2143    18834    6            END;

     2144    18835    5   NEXT: I = I + 1;

  18835  4 011126   200057 054100       NEXT         AOS     I,,AUTO

     2145    18836    5         END;

  18836  4 011127   200057 236100                    LDQ     I,,AUTO
         4 011130   200072 116100                    CMPQ    ACCT_COUNT,,AUTO
         4 011131   011140 605000 4                  TPL     s:18837
         4 011132   000024 402007                    MPY     20,DL
         4 011133   000000 470400 xsym               LDP0    DSEG1$
         4 011134   040100 106506                    CMPC    fill='040'O
         4 011135   000000 000006                    ADSC9   0,Q,PR0                  cn=0,n=6
         4 011136   200076 000006                    ADSC9   PACKSET,,AUTO            cn=0,n=6
         4 011137   010643 600000 4                  TZE     s:18771

     2146    18837    4      IF DEST_PROJ.COUNT > 0

  18837  4 011140   200102 236100                    LDQ     DEST_PROJ,,AUTO
         4 011141   777000 316003                    CANQ    -512,DU
         4 011142   011235 600000 4                  TZE     s:18890

     2147    18838    5      THEN DO;

     2148    18839    5         IF (GRANS + DSEG3$->AS$PROJ.GRANS_ACCUM) > DSEG3$->AS$PROJ.MAX_NUM_GRANS

  18839  4 011143   000000 470400 xsym               LDP0    DSEG3$
         4 011144   200100 236100                    LDQ     GRANS,,AUTO
         4 011145   000007 036100                    ADLQ    7,,PR0
         4 011146   011175 604000 4                  TMI     s:18864
         4 011147   000006 116100                    CMPQ    6,,PR0
         4 011150   011175 602000 4                  TNC     s:18864
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:361  
         4 011151   011175 600000 4                  TZE     s:18864

     2149    18840    6         THEN DO;

     2150    18841        /*E*  ERROR:  ASA-E$TOO_MANY_GRANS2-C
     2151    18842              MESSAGE: Granule limit exceeded for project "%U1" packset DP#%U2
     2152    18843        */
     2153    18844    6            CALL ASA$KEYCONV( DEST_PROJ, AS_FIELD1 );

  18844  4 011152   000103 236000 5                  LDQ     67
         4 011153   200121 756100                    STQ     I+3,,AUTO
         4 011154   200102 631500                    EPPR1   DEST_PROJ,,AUTO
         4 011155   200120 451500                    STP1    I+2,,AUTO
         4 011156   200120 630500                    EPPR0   I+2,,AUTO
         4 011157   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011160   000000 701000 xent               TSX1    ASA$KEYCONV
         4 011161   000000 011000                    NOP     0

     2154    18845    6            AS_FIELD2.COUNT = LENGTHC(PACKSET);

  18845  4 011162   006000 236003                    LDQ     3072,DU
         4 011163   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

     2155    18846    6            AS_FIELD2.TEXT  = PACKSET;

  18846  4 011164   040000 100500                    MLR     fill='040'O
         4 011165   200076 000006                    ADSC9   PACKSET,,AUTO            cn=0,n=6
         4 011166   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

     2156    18847                 %SCREAM(ERR#=E$TOO_MANY_GRANS2,LEVEL=ERROR,MID='A');

  18859  4 011167   000236 630400 5                  EPPR0   158
         4 011170   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011171   000000 701000 xent               TSX1    ASH$ERROR
         4 011172   000000 011000                    NOP     0

     2157    18862    6            ALTRET_FLG = '1'B;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:362  

  18862  4 011173   400000 236003                    LDQ     -131072,DU
         4 011174   200111 756100                    STQ     ALTRET_FLG,,AUTO

     2158    18863    6            END;

     2159    18864    5         IF ( ACCTS+DSEG3$->AS$PROJ.NUM_ACCTS+DSEG3$->AS$PROJ.SUB_PROJ_ACCTS) > DSEG3$
             18864                  ->AS$PROJ.MAX_NUM_ACCTS

  18864  4 011175   000000 470400 xsym               LDP0    DSEG3$
         4 011176   200101 236100                    LDQ     ACCTS,,AUTO
         4 011177   000013 036100                    ADLQ    11,,PR0
         4 011200   200120 756100                    STQ     I+2,,AUTO
         4 011201   000005 236100                    LDQ     5,,PR0
         4 011202   777777 376007                    ANQ     -1,DL
         4 011203   200121 756100                    STQ     I+3,,AUTO
         4 011204   200120 236100                    LDQ     I+2,,AUTO
         4 011205   200121 036100                    ADLQ    I+3,,AUTO
         4 011206   011235 604000 4                  TMI     s:18890
         4 011207   000012 116100                    CMPQ    10,,PR0
         4 011210   011235 602000 4                  TNC     s:18890
         4 011211   011235 600000 4                  TZE     s:18890

     2160    18865    6         THEN DO;

     2161    18866        /*E*  ERROR:  ASA-E$TOO_MANY_F_ACCTS2-C
     2162    18867              MESSAGE: Account limit exceeded for project "%U1" packset DP#%U2
     2163    18868        */
     2164    18869    6            CALL ASA$KEYCONV( DEST_PROJ, AS_FIELD1 );

  18869  4 011212   000103 236000 5                  LDQ     67
         4 011213   200121 756100                    STQ     I+3,,AUTO
         4 011214   200102 631500                    EPPR1   DEST_PROJ,,AUTO
         4 011215   200120 451500                    STP1    I+2,,AUTO
         4 011216   200120 630500                    EPPR0   I+2,,AUTO
         4 011217   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011220   000000 701000 xent               TSX1    ASA$KEYCONV
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:363  
         4 011221   000000 011000                    NOP     0

     2165    18870    6            AS_FIELD2.COUNT = LENGTHC(PACKSET);

  18870  4 011222   006000 236003                    LDQ     3072,DU
         4 011223   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

     2166    18871    6            AS_FIELD2.TEXT  = PACKSET;

  18871  4 011224   040000 100500                    MLR     fill='040'O
         4 011225   200076 000006                    ADSC9   PACKSET,,AUTO            cn=0,n=6
         4 011226   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

     2167    18872                 %SCREAM(ERR#=E$TOO_MANY_F_ACCTS2,MID='A',LEVEL=ERROR);

  18884  4 011227   000237 630400 5                  EPPR0   159
         4 011230   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011231   000000 701000 xent               TSX1    ASH$ERROR
         4 011232   000000 011000                    NOP     0

     2168    18887    6            ALTRET_FLG = '1'B;

  18887  4 011233   400000 236003                    LDQ     -131072,DU
         4 011234   200111 756100                    STQ     ALTRET_FLG,,AUTO

     2169    18888    6            END;

     2170    18889    5         END;

     2171    18890    5      DO WHILE('0'B);

  18890  4 011235   011253 710000 4                  TRA     s:18896

     2172    18891    6   SKIP_PACKSET: DO WHILE( I < ACCT_COUNT  AND  ACCT$LIST.PSN(I) = PACKSET );

  18891  4 011236   011240 710000 4     SKIP_PACKSET TRA     s:18893

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:364  
     2173    18892    6            I = I + 1;

  18892  4 011237   200057 054100                    AOS     I,,AUTO

     2174    18893    6            END;

  18893  4 011240   200057 236100                    LDQ     I,,AUTO
         4 011241   200072 116100                    CMPQ    ACCT_COUNT,,AUTO
         4 011242   011251 605000 4                  TPL     s:18894
         4 011243   000024 402007                    MPY     20,DL
         4 011244   000000 470400 xsym               LDP0    DSEG1$
         4 011245   040100 106506                    CMPC    fill='040'O
         4 011246   000000 000006                    ADSC9   0,Q,PR0                  cn=0,n=6
         4 011247   200076 000006                    ADSC9   PACKSET,,AUTO            cn=0,n=6
         4 011250   011237 600000 4                  TZE     s:18892

     2175    18894    5         ALTRET_FLG = '1'B;

  18894  4 011251   400000 236003                    LDQ     -131072,DU
         4 011252   200111 756100                    STQ     ALTRET_FLG,,AUTO

     2176    18895    5         END;

     2177    18896    4      END;

  18896  4 011253   200057 236100                    LDQ     I,,AUTO
         4 011254   200072 116100                    CMPQ    ACCT_COUNT,,AUTO
         4 011255   010574 604000 4                  TMI     s:18758

     2178    18897
     2179    18898    4   IF ALTRET_FLG THEN DO;

  18898  4 011256   200111 234100                    SZN     ALTRET_FLG,,AUTO
         4 011257   011267 605000 4                  TPL     s:18903

     2180    18899    4      IF ACCT_COUNT > 0 THEN CALL ASB$DEQ_PROJ;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:365  
  18899  4 011260   200072 235100                    LDA     ACCT_COUNT,,AUTO
         4 011261   011265 604400 4                  TMOZ    s:18900

  18899  4 011262   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 011263   000000 701000 xent               TSX1    ASB$DEQ_PROJ
         4 011264   000000 011000                    NOP     0

     2181    18900    4      ALTRETURN;

  18900  4 011265   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 011266   000000 702211                    TSX2  ! 0,X1

     2182    18901    4      END;
     2183    18902
     2184    18903    3   END GET_ACCT_LIST;

  18903  4 011267   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 011270   000001 702211                    TSX2  ! 1,X1

     2185    18904        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:366  
     2186    18905    2   READ_PROJ_REC: PROC( PROJECT, PACKSET, PROJ$ ) ALTRET;

  18905  4 011271   200112 741300       READ_PROJ_R* STX1  ! ALTRET_FLG+1,,AUTO

     2187    18906
     2188    18907    3   DCL 1 PROJECT ALIGNED,
     2189    18908    3          2 COUNT UBIN BYTE UNAL,
     2190    18909    3          2 TEXT CHAR(20);
     2191    18910    3   DCL PACKSET CHAR(6);
     2192    18911    3   DCL PROJ$ PTR;
     2193    18912
     2194    18913    3   DCL I SBIN;
     2195    18914
     2196    18915
     2197    18916    3   PROJ_KEY.TXT.PROJECT = PROJECT.TEXT;

  18916  4 011272   200113 470500                    LDP0    @PROJECT,,AUTO
         4 011273   040000 100500                    MLR     fill='040'O
         4 011274   000000 200024                    ADSC9   0,,PR0                   cn=1,n=20
         4 011275   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20

     2198    18917    3   PROJ_KEY.TXT.PACKSET = PACKSET;

  18917  4 011276   200114 471500                    LDP1    @PACKSET,,AUTO
         4 011277   040000 100500                    MLR     fill='040'O
         4 011300   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         4 011301   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

     2199    18918    3   CALL INDEX(I,AS_BLANK,PROJ_KEY.TEXT,20);

  18918  4 011302   000000 124400                    SCM     mask='000'O
         4 011303   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         4 011304   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 011305   200116 000100                    ARG     I,,AUTO
         4 011306   000024 236007                    LDQ     20,DL
         4 011307   200116 056100                    ASQ     I,,AUTO

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:367  
     2200    18919    3   PROJ_KEY.COUNT = I;

  18919  4 011310   200116 236100                    LDQ     I,,AUTO
         4 011311   000033 736000                    QLS     27
         4 011312   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

     2201    18920    3   CALL ASB$ENQ_PROJ;

  18920  4 011313   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 011314   000000 701000 xent               TSX1    ASB$ENQ_PROJ
         4 011315   000000 011000                    NOP     0

     2202    18921    3   IF PROJ$ = DSEG2$

  18921  4 011316   200115 470500                    LDP0    @PROJ$,,AUTO
         4 011317   000000 236100                    LDQ     0,,PR0
         4 011320   000000 116000 xsym               CMPQ    DSEG2$
         4 011321   011337 601000 4                  TNZ     s:18927

     2203    18922    4   THEN DO;

     2204    18923    4      I = DSEG2SIZE;

  18923  4 011322   000000 235000 xsym               LDA     DSEG2SIZE
         4 011323   200116 755100                    STA     I,,AUTO

     2205    18924    4      CALL ASB$READ_PROJ(PROJ$,I,2) ALTRET(ALT);

  18924  4 011324   000013 236000 5                  LDQ     11
         4 011325   200122 756100                    STQ     I+4,,AUTO
         4 011326   200116 631500                    EPPR1   I,,AUTO
         4 011327   200121 451500                    STP1    I+3,,AUTO
         4 011330   200115 236100                    LDQ     @PROJ$,,AUTO
         4 011331   200120 756100                    STQ     I+2,,AUTO
         4 011332   200120 630500                    EPPR0   I+2,,AUTO
         4 011333   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 011334   000000 701000 xent               TSX1    ASB$READ_PROJ
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:368  
         4 011335   011355 702000 4                  TSX2    ALT

     2206    18925    4      END;

  18925  4 011336   011353 710000 4                  TRA     s:18930

     2207    18926    4   ELSE DO;

     2208    18927    4      I = DSEG3SIZE;

  18927  4 011337   000000 235000 xsym               LDA     DSEG3SIZE
         4 011340   200116 755100                    STA     I,,AUTO

     2209    18928    4      CALL ASB$READ_PROJ(PROJ$,I,3) ALTRET(ALT);

  18928  4 011341   000222 236000 5                  LDQ     146
         4 011342   200122 756100                    STQ     I+4,,AUTO
         4 011343   200116 631500                    EPPR1   I,,AUTO
         4 011344   200121 451500                    STP1    I+3,,AUTO
         4 011345   200115 236100                    LDQ     @PROJ$,,AUTO
         4 011346   200120 756100                    STQ     I+2,,AUTO
         4 011347   200120 630500                    EPPR0   I+2,,AUTO
         4 011350   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 011351   000000 701000 xent               TSX1    ASB$READ_PROJ
         4 011352   011355 702000 4                  TSX2    ALT

     2210    18929    4      END;

     2211    18930    3   RETURN;

  18930  4 011353   200112 221300                    LDX1  ! ALTRET_FLG+1,,AUTO
         4 011354   000001 702211                    TSX2  ! 1,X1

     2212    18931
     2213    18932    3   ALT: IF MERR_CODE.CODE = %E$NOKEY

  18932  4 011355   000000 236000 xsym  ALT          LDQ     ERR_CODE
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:369  
         4 011356   377770 376007                    ANQ     131064,DL
         4 011357   001020 116007                    CMPQ    528,DL
         4 011360   011406 601000 4                  TNZ     s:18954

     2214    18933    4   THEN DO;

     2215    18934    4      AS_FIELD1.COUNT = PROJ_KEY.COUNT - 20;

  18934  4 011361   000000 236000 xsym               LDQ     PROJ_KEY
         4 011362   000033 772000                    QRL     27
         4 011363   000024 136007                    SBLQ    20,DL
         4 011364   000033 736000                    QLS     27
         4 011365   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     2216    18935    4      AS_FIELD1.TEXT  = PACKSET;

  18935  4 011366   200114 470500                    LDP0    @PACKSET,,AUTO
         4 011367   040000 100500                    MLR     fill='040'O
         4 011370   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         4 011371   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     2217    18936    4      CALL ASA$KEYCONV( PROJECT, AS_FIELD2 );

  18936  4 011372   000174 236000 5                  LDQ     124
         4 011373   200113 235100                    LDA     @PROJECT,,AUTO
         4 011374   200120 757100                    STAQ    I+2,,AUTO
         4 011375   200120 630500                    EPPR0   I+2,,AUTO
         4 011376   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011377   000000 701000 xent               TSX1    ASA$KEYCONV
         4 011400   000000 011000                    NOP     0

     2218    18937           %SCREAM( ERR#=E$PACK_NO_EXIST_FOR_PROJ, LEVEL=ERROR, MID='A' );

  18949  4 011401   000245 630400 5                  EPPR0   165
         4 011402   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011403   000000 701000 xent               TSX1    ASH$ERROR
         4 011404   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:370  

     2219    18952    4      END;

  18952  4 011405   011412 710000 4                  TRA     s:18956

     2220    18953    4   ELSE DO;

     2221    18954    4      CALL ASH$ERROR(MERR_CODE);

  18954  4 011406   000001 630400 5                  EPPR0   1
         4 011407   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011410   000000 701000 xent               TSX1    ASH$ERROR
         4 011411   000000 011000                    NOP     0

     2222    18955    4      END;

     2223    18956    3   ALTRETURN;

  18956  4 011412   200112 221300                    LDX1  ! ALTRET_FLG+1,,AUTO
         4 011413   000000 702211                    TSX2  ! 0,X1

     2224    18957
     2225    18958    3   END READ_PROJ_REC;
     2226    18959        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:371  
     2227    18960    2   END   CREATE_MOD_USER ;
     2228    18961        %EJECT ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:372  
     2229    18962        /*I*  NAME:       REMOVE_USER_PROJECT
     2230    18963              PURPOSE:    Driver routine for removing users and projects
     2231    18964              CALL:       CALL REMOVE_USER_PROJECT( PROJ_FLAG )
     2232    18965              INPUT:      PROJ_FLAG - '1'B => Remove project, '0'B => Remove user.
     2233    18966              INTERFACE:  ASB$KEYMAKER
     2234    18967                          ASB$READ_USER
     2235    18968                          ASB$R_PROJECT
     2236    18969                          ASB$R_USER
     2237    18970                          ERROR
     2238    18971              DESCRIPTION:
     2239    18972                  This routine verifies that the project/user exists and that it
     2240    18973                  can be removed.  It then calls ASB$R_PROJECT to remove projects
     2241    18974                  or calls ASB$R_USER to remove users.
     2242    18975        */
     2243    18976
     2244    18977    1   REMOVE_USER_PROJECT: PROC ( PROJ_FLAG ) ;

  18977  4 011414   200050 741300       REMOVE_USER* STX1  ! FREE_SEG_TYPE+1,,AUTO

     2245    18978
     2246    18979    2   DCL PROJ_FLAG BIT(1) ALIGNED; /* '1'b => remove project, '0'b => remove user */
     2247    18980
     2248    18981    2   DCL 1 KEY,
     2249    18982    2          2 COUNT UBIN BYTE UNAL,
     2250    18983    2          2 TEXT CHAR(41) UNAL,
     2251    18984    2          2 SKEY REDEF TEXT,
     2252    18985    2             3 PROJ UBIN BYTE UNAL,
     2253    18986    2             3 CREATOR CHAR(20) UNAL,
     2254    18987    2             3 USER CHAR(20) UNAL ;
     2255    18988
     2256    18989    2   DCL COUNT UBIN;
     2257    18990    2   DCL PAR$ PTR;
     2258    18991    2   DCL TYPE UBIN ;
     2259    18992    2   DCL FACCOUNT_OPT BIT(1);
     2260    18993
     2261    18994
     2262    18995    2   TYPE = P$NODE.CODE ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:373  

  18995  4 011415   000000 470400 xsym               LDP0    NODE$
         4 011416   000000 236100                    LDQ     0,,PR0
         4 011417   777777 376007                    ANQ     -1,DL
         4 011420   200067 756100                    STQ     TYPE,,AUTO

     2263    18996    2   PAR$ = P$NODE.SUBLK$(0) ;

  18996  4 011421   000003 236100                    LDQ     3,,PR0
         4 011422   200066 756100                    STQ     PAR$,,AUTO

     2264    18997    2   FACCOUNT_OPT = (P$NODE.SUBLK$(1)->P$NODE.CODE = 121 /* FACCOUNT_OPT_VAL */ );

  18997  4 011423   000004 471500                    LDP1    4,,PR0
         4 011424   400000 220003                    LDX0    -131072,DU
         4 011425   100000 722100                    LXL2    0,,PR1
         4 011426   000171 102003                    CMPX2   121,DU
         4 011427   011431 600000 4                  TZE     s:18997+6
         4 011430   000000 220003                    LDX0    0,DU
         4 011431   000000 636010                    EAQ     0,X0
         4 011432   200070 756100                    STQ     FACCOUNT_OPT,,AUTO

     2265    18998    2   COUNT = 0 ;

  18998  4 011433   200065 450100                    STZ     COUNT,,AUTO

     2266    18999    2   CALL ASB$KEYMAKER(USERS_KEY, PAR$->P$NODE, PROJ_FLAG, TYPE ) ALTRET(EXIT#);

  18999  4 011434   200067 631500                    EPPR1   TYPE,,AUTO
         4 011435   200123 451500                    STP1    I+5,,AUTO
         4 011436   200051 236100                    LDQ     @PROJ_FLAG,,AUTO
         4 011437   200122 756100                    STQ     I+4,,AUTO
         4 011440   200066 236100                    LDQ     PAR$,,AUTO
         4 011441   000121 235000 5                  LDA     81
         4 011442   200120 757100                    STAQ    I+2,,AUTO
         4 011443   200120 630500                    EPPR0   I+2,,AUTO
         4 011444   000022 631400 xsym               EPPR1   B_VECTNIL+18
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:374  
         4 011445   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 011446   011707 702000 4                  TSX2    EXIT#

     2267    19000    2   IF NOT AS_WILD_USER

  19000  4 011447   000000 234000 xsym               SZN     AS_WILD_USER
         4 011450   011545 604000 4                  TMI     s:19020

     2268    19001    3   THEN DO ;

     2269    19002    4      IF PROJ_FLAG THEN DO;

  19002  4 011451   200051 470500                    LDP0    @PROJ_FLAG,,AUTO
         4 011452   000000 234100                    SZN     0,,PR0
         4 011453   011522 605000 4                  TPL     s:19013

     2270    19003    4         KEY.COUNT = 21 + USERS_KEY.COUNT ;

  19003  4 011454   000000 236000 xsym               LDQ     USERS_KEY
         4 011455   000033 772000                    QRL     27
         4 011456   000025 036007                    ADLQ    21,DL
         4 011457   000033 736000                    QLS     27
         4 011460   200052 552140                    STBQ    KEY,'40'O,AUTO

     2271    19004    4         KEY.SKEY.USER = USERS_KEY.TXTC ;

  19004  4 011461   040100 100400                    MLR     fill='040'O
         4 011462   000000 200024 xsym               ADSC9   USERS_KEY                cn=1,n=20
         4 011463   200057 400024                    ADSC9   I,,AUTO                  cn=2,n=20

     2272    19005    4         CALL ASB$GET( PROJ_FLAG, TYPE, AS_PROJECT, AS_PROJECT_DREC$,

  19005  4 011464   000130 237000 5                  LDAQ    88
         4 011465   200124 757100                    STAQ    I+6,,AUTO
         4 011466   000132 237000 5                  LDAQ    90
         4 011467   200122 757100                    STAQ    I+4,,AUTO
         4 011470   200067 631500                    EPPR1   TYPE,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:375  
         4 011471   200121 451500                    STP1    I+3,,AUTO
         4 011472   200051 236100                    LDQ     @PROJ_FLAG,,AUTO
         4 011473   200120 756100                    STQ     I+2,,AUTO
         4 011474   200120 630500                    EPPR0   I+2,,AUTO
         4 011475   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 011476   000000 701000 xent               TSX1    ASB$GET
         4 011477   011707 702000 4                  TSX2    EXIT#

     2273    19006    4              AS_PROJECT_DFLT, AS_PROJECT_DFLT_DREC$ ) ALTRET(EXIT#);
     2274    19007    4         KEY.SKEY.PROJ = 1;

  19007  4 011500   000001 236003                    LDQ     1,DU
         4 011501   200052 552120                    STBQ    KEY,'20'O,AUTO

     2275    19008    4         KEY.SKEY.CREATOR = AS_PROJECT.BUDGET.MACCT_.TEXT;

  19008  4 011502   040100 100400                    MLR     fill='040'O
         4 011503   000012 200024 xsym               ADSC9   AS_PROJECT+10            cn=1,n=20
         4 011504   200052 400024                    ADSC9   KEY,,AUTO                cn=2,n=20

     2276    19009    4         CALL ASR$R_PROJECT( KEY, COUNT, FACCOUNT_OPT ) ;

  19009  4 011505   200070 630500                    EPPR0   FACCOUNT_OPT,,AUTO
         4 011506   200122 450500                    STP0    I+4,,AUTO
         4 011507   200065 631500                    EPPR1   COUNT,,AUTO
         4 011510   200121 451500                    STP1    I+3,,AUTO
         4 011511   200052 633500                    EPPR3   KEY,,AUTO
         4 011512   200120 453500                    STP3    I+2,,AUTO
         4 011513   200120 630500                    EPPR0   I+2,,AUTO
         4 011514   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 011515   000000 701000 xent               TSX1    ASR$R_PROJECT
         4 011516   000000 011000                    NOP     0

     2277    19010    4         CALL MOD_PROJ_ADMIN_REC;

  19010  4 011517   011711 701000 4                  TSX1    MOD_PROJ_ADMIN_REC
         4 011520   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:376  

     2278    19011    4         END ;

  19011  4 011521   011615 710000 4                  TRA     FINISHED

     2279    19012    4      ELSE DO ;

     2280    19013    4         CALL ASB$GET( PROJ_FLAG, TYPE, AS_USERS, KL_DREC$ ) ALTRET(EXIT#);

  19013  4 011522   000104 237000 5                  LDAQ    68
         4 011523   200122 757100                    STAQ    I+4,,AUTO
         4 011524   200067 631500                    EPPR1   TYPE,,AUTO
         4 011525   200121 451500                    STP1    I+3,,AUTO
         4 011526   200051 236100                    LDQ     @PROJ_FLAG,,AUTO
         4 011527   200120 756100                    STQ     I+2,,AUTO
         4 011530   200120 630500                    EPPR0   I+2,,AUTO
         4 011531   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 011532   000000 701000 xent               TSX1    ASB$GET
         4 011533   011707 702000 4                  TSX2    EXIT#

     2281    19014    5         CALL ASR$R_USER( FACCOUNT_OPT ) WHENRETURN DO;

  19014  4 011534   200070 630500                    EPPR0   FACCOUNT_OPT,,AUTO
         4 011535   200120 450500                    STP0    I+2,,AUTO
         4 011536   200120 630500                    EPPR0   I+2,,AUTO
         4 011537   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011540   000000 701000 xent               TSX1    ASR$R_USER
         4 011541   011544 702000 4                  TSX2    s:19018

     2282    19015    5            COUNT = 1;

  19015  4 011542   000001 235007                    LDA     1,DL
         4 011543   200065 755100                    STA     COUNT,,AUTO

     2283    19016    5            END; /*Whenreturn*/

     2284    19017    4         END ;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:377  

     2285    19018    3      END ;

  19018  4 011544   011615 710000 4                  TRA     FINISHED

     2286    19019    3   ELSE DO ;

     2287    19020    3      CALL ASB$INIT_GET_NEXT( PROJ_FLAG, TYPE ) ;

  19020  4 011545   200067 630500                    EPPR0   TYPE,,AUTO
         4 011546   200121 450500                    STP0    I+3,,AUTO
         4 011547   200051 236100                    LDQ     @PROJ_FLAG,,AUTO
         4 011550   200120 756100                    STQ     I+2,,AUTO
         4 011551   200120 630500                    EPPR0   I+2,,AUTO
         4 011552   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011553   000000 701000 xent               TSX1    ASB$INIT_GET_NEXT
         4 011554   000000 011000                    NOP     0

     2288    19021    4      DO WHILE( '1'B );

     2289    19022    4         CALL ASB$GET_NEXT ALTRET( FINISHED ) ;

  19022  4 011555   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 011556   000000 701000 xent               TSX1    ASB$GET_NEXT
         4 011557   011615 702000 4                  TSX2    FINISHED

     2290    19023    5         IF PROJ_FLAG THEN DO ;

  19023  4 011560   200051 470500                    LDP0    @PROJ_FLAG,,AUTO
         4 011561   000000 234100                    SZN     0,,PR0
         4 011562   011603 605000 4                  TPL     s:19029

     2291    19024    5            KEY = USERS_KEY;

  19024  4 011563   000100 100400                    MLR     fill='000'O
         4 011564   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         4 011565   200052 000052                    ADSC9   KEY,,AUTO                cn=0,n=42
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:378  

     2292    19025    5            CALL ASR$R_PROJECT( KEY, COUNT, FACCOUNT_OPT ) ;

  19025  4 011566   200070 631500                    EPPR1   FACCOUNT_OPT,,AUTO
         4 011567   200122 451500                    STP1    I+4,,AUTO
         4 011570   200065 633500                    EPPR3   COUNT,,AUTO
         4 011571   200121 453500                    STP3    I+3,,AUTO
         4 011572   200052 634500                    EPPR4   KEY,,AUTO
         4 011573   200120 454500                    STP4    I+2,,AUTO
         4 011574   200120 630500                    EPPR0   I+2,,AUTO
         4 011575   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 011576   000000 701000 xent               TSX1    ASR$R_PROJECT
         4 011577   000000 011000                    NOP     0

     2293    19026    5            CALL MOD_PROJ_ADMIN_REC;

  19026  4 011600   011711 701000 4                  TSX1    MOD_PROJ_ADMIN_REC
         4 011601   000000 011000                    NOP     0

     2294    19027    5            END ;

  19027  4 011602   011555 710000 4                  TRA     s:19022

     2295    19028    5         ELSE DO ;

     2296    19029    6            CALL ASR$R_USER( FACCOUNT_OPT ) WHENRETURN DO;

  19029  4 011603   200070 631500                    EPPR1   FACCOUNT_OPT,,AUTO
         4 011604   200120 451500                    STP1    I+2,,AUTO
         4 011605   200120 630500                    EPPR0   I+2,,AUTO
         4 011606   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011607   000000 701000 xent               TSX1    ASR$R_USER
         4 011610   011614 702000 4                  TSX2    s:19033

     2297    19030    6               COUNT = COUNT + 1 ;

  19030  4 011611   200065 235100                    LDA     COUNT,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:379  
         4 011612   000001 035007                    ADLA    1,DL
         4 011613   200065 755100                    STA     COUNT,,AUTO

     2298    19031    6               END; /*Whenreturn*/

     2299    19032    5            END ;

     2300    19033    4         END ;  /* Do forever */

  19033  4 011614   011555 710000 4                  TRA     s:19022

     2301    19034    3      END ;   /* Else do */
     2302    19035    2   FINISHED:
     2303    19036    2   CALL ASB$FLUSH;

  19036  4 011615   000002 631400 xsym  FINISHED     EPPR1   B_VECTNIL+2
         4 011616   000000 701000 xent               TSX1    ASB$FLUSH
         4 011617   000000 011000                    NOP     0

     2304    19037    3   IF COUNT = 0 THEN DO;

  19037  4 011620   200065 235100                    LDA     COUNT,,AUTO
         4 011621   011627 601000 4                  TNZ     s:19066

     2305    19038        /*E* ERROR:   ASA-E$NOTHING_TO_REMOVE-C
     2306    19039             MESSAGE: Nothing to remove.
     2307    19040        */
     2308    19041           %SCREAM( ERR#=E$NOTHING_TO_REMOVE, MID='A', LEVEL=ERROR );

  19053  4 011622   000246 630400 5                  EPPR0   166
         4 011623   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011624   000000 701000 xent               TSX1    ASH$ERROR
         4 011625   000000 011000                    NOP     0

     2309    19056    3      END;

  19056  4 011626   011707 710000 4                  TRA     EXIT#
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:380  

     2310    19057    3   ELSE DO;

     2311    19058           %NUMBER( NUM1=COUNT ) ;
             19066    3         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, COUNT );

  19066  4 011627   200065 630500                    EPPR0   COUNT,,AUTO
         4 011630   200123 450500                    STP0    I+5,,AUTO
         4 011631   000051 236000 5                  LDQ     41
         4 011632   200122 756100                    STQ     I+4,,AUTO
         4 011633   000060 237000 5                  LDAQ    48
         4 011634   200120 757100                    STAQ    I+2,,AUTO
         4 011635   200120 630500                    EPPR0   I+2,,AUTO
         4 011636   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 011637   000000 701000 xent               TSX1    ASB$BINCHAR
         4 011640   000000 011000                    NOP     0

     2312    19088    4      IF PROJ_FLAG THEN DO;

  19088  4 011641   200051 470500                    LDP0    @PROJ_FLAG,,AUTO
         4 011642   000000 234100                    SZN     0,,PR0
         4 011643   011651 605000 4                  TPL     s:19120

     2313    19089        /*E* ERROR:   ASA-E$NUM_PROJ_REMOVED-C
     2314    19090             MESSAGE:.. %U1 projects removed.
     2315    19091        */
     2316    19092              %SCREAM( ERR#=E$NUM_PROJ_REMOVED, LEVEL=INFO, MID='A' );

  19100  4 011644   000247 630400 5                  EPPR0   167
         4 011645   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011646   000000 701000 xent               TSX1    ASH$INFO
         4 011647   000000 011000                    NOP     0

     2317    19107    4         END;

  19107  4 011650   011707 710000 4                  TRA     EXIT#

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:381  
     2318    19108    4      ELSE DO ;

     2319    19109        /*E* ERROR:   ASA-E$USERS_REMOVED-C
     2320    19110             MESSAGE:.. %U1 users removed.
     2321    19111        */
     2322    19112              %SCREAM( ERR#=E$USERS_REMOVED, LEVEL=INFO, MID='A' );

  19120  4 011651   000250 630400 5                  EPPR0   168
         4 011652   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011653   000000 701000 xent               TSX1    ASH$INFO
         4 011654   000000 011000                    NOP     0

     2323    19127    5         IF AS_PROJECT_ADMIN ~= AS_NONE THEN DO;

  19127  4 011655   000000 106400                    CMPC    fill='000'O
         4 011656   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 011657   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 011660   011707 600000 4                  TZE     EXIT#

     2324    19128    5            USERS_KEY.COUNT = 21;

  19128  4 011661   025000 236003                    LDQ     10752,DU
         4 011662   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     2325    19129    5            CALL CONCAT( USERS_KEY.TXTC, AS_PROJECT_ADMIN.TEXT, 'S' );

  19129  4 011663   040000 100400                    MLR     fill='040'O
         4 011664   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 011665   000000 200024 xsym               ADSC9   USERS_KEY                cn=1,n=20
         4 011666   040000 100400                    MLR     fill='040'O
         4 011667   000077 000001 5                  ADSC9   63                       cn=0,n=1
         4 011670   000005 200025 xsym               ADSC9   USERS_KEY+5              cn=1,n=21

     2326    19130    5            CALL ASB$ENQ_USERS ALTRET(EXIT#);

  19130  4 011671   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 011672   000000 701000 xent               TSX1    ASB$ENQ_USERS
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:382  
         4 011673   011707 702000 4                  TSX2    EXIT#

     2327    19131    5            CALL ASB$READ_USERS( AS_USERS ) ALTRET(EXIT#);

  19131  4 011674   000104 630400 5                  EPPR0   68
         4 011675   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011676   000000 701000 xent               TSX1    ASB$READ_USERS
         4 011677   011707 702000 4                  TSX2    EXIT#

     2328    19132    5            AS_USERS.BUDGET.PROJ_CREATED = AS_USERS.BUDGET.PROJ_CREATED - COUNT;

  19132  4 011700   000011 236000 xsym               LDQ     AS_USERS+9
         4 011701   200065 136100                    SBLQ    COUNT,,AUTO
         4 011702   000011 756000 xsym               STQ     AS_USERS+9

     2329    19133    5            CALL ASB$WRITE_USERS( AS_USERS );

  19133  4 011703   000104 630400 5                  EPPR0   68
         4 011704   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011705   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 011706   000000 011000                    NOP     0

     2330    19134    5            END;

     2331    19135    4         END ;

     2332    19136    3      END ;

     2333    19137
     2334    19138    2   EXIT#: RETURN ;

  19138  4 011707   200050 221300       EXIT#        LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 011710   000001 702211                    TSX2  ! 1,X1

     2335    19139
     2336    19140
     2337    19141    2   MOD_PROJ_ADMIN_REC: PROC;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:383  

  19141  4 011711   200072 741300       MOD_PROJ_AD* STX1  ! ACCT_COUNT,,AUTO

     2338    19142
     2339    19143    3   IF AS_PROJECT.BUDGET.MACCT = AS_NONE THEN RETURN;

  19143  4 011712   000000 106400                    CMPC    fill='000'O
         4 011713   000012 000025 xsym               ADSC9   AS_PROJECT+10            cn=0,n=21
         4 011714   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 011715   011717 601000 4                  TNZ     s:19144

  19143  4 011716   000001 702211                    TSX2  ! 1,X1

     2340    19144    3   USERS_KEY.COUNT = 21;

  19144  4 011717   025000 236003                    LDQ     10752,DU
         4 011720   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     2341    19145    3   CALL CONCAT( USERS_KEY.TXTC, AS_PROJECT.BUDGET.MACCT_.TEXT, 'S' );

  19145  4 011721   040000 100400                    MLR     fill='040'O
         4 011722   000012 200024 xsym               ADSC9   AS_PROJECT+10            cn=1,n=20
         4 011723   000000 200024 xsym               ADSC9   USERS_KEY                cn=1,n=20
         4 011724   040000 100400                    MLR     fill='040'O
         4 011725   000077 000001 5                  ADSC9   63                       cn=0,n=1
         4 011726   000005 200025 xsym               ADSC9   USERS_KEY+5              cn=1,n=21

     2342    19146    3   CALL ASB$ENQ_USERS ALTRET(EXIT#);

  19146  4 011727   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 011730   000000 701000 xent               TSX1    ASB$ENQ_USERS
         4 011731   012030 702000 4                  TSX2    EXIT#

     2343    19147    3   CALL ASB$READ_USERS( AS_USERS ) ALTRET(EXIT#);

  19147  4 011732   000104 630400 5                  EPPR0   68
         4 011733   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:384  
         4 011734   000000 701000 xent               TSX1    ASB$READ_USERS
         4 011735   012030 702000 4                  TSX2    EXIT#

     2344    19148    3   IF AS_PROJECT_DFLT.BUDGET.PMAXC > 0 THEN

  19148  4 011736   000010 235000 xsym               LDA     AS_PROJECT_DFLT+8
         4 011737   011743 604400 4                  TMOZ    s:19150

     2345    19149    3      AS_USERS.BUDGET.PROJ_CREATED = AS_USERS.BUDGET.PROJ_CREATED - AS_PROJECT_DFLT.
             19149               BUDGET.PROJ_ALLOWED;

  19149  4 011740   000011 236000 xsym               LDQ     AS_USERS+9
         4 011741   000010 136000 xsym               SBLQ    AS_PROJECT_DFLT+8
         4 011742   000011 756000 xsym               STQ     AS_USERS+9

     2346    19150    3   IF AS_PROJECT.BUDGET.MAX_PROJECTS > 0 THEN

  19150  4 011743   000017 720000 xsym               LXL0    AS_PROJECT+15
         4 011744   011757 604400 4                  TMOZ    s:19152

     2347    19151    3      AS_USERS.BUDGET.SUB_PROJS = AS_USERS.BUDGET.SUB_PROJS - AS_PROJECT.BUDGET.
             19151               MAX_PROJECTS;

  19151  4 011745   000017 236000 xsym               LDQ     AS_PROJECT+15
         4 011746   000022 736000                    QLS     18
         4 011747   000022 732000                    QRS     18
         4 011750   200120 756100                    STQ     I+2,,AUTO
         4 011751   000017 236000 xsym               LDQ     AS_USERS+15
         4 011752   000022 736000                    QLS     18
         4 011753   000022 732000                    QRS     18
         4 011754   200120 136100                    SBLQ    I+2,,AUTO
         4 011755   000000 621006                    EAX1    0,QL
         4 011756   000017 441000 xsym               SXL1    AS_USERS+15

     2348    19152    3   AS_USERS.BUDGET.SUB_PROJS = AS_USERS.BUDGET.SUB_PROJS - 1;

  19152  4 011757   000017 721000 xsym               LXL1    AS_USERS+15
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:385  
         4 011760   777777 622011                    EAX2    -1,X1
         4 011761   000017 442000 xsym               SXL2    AS_USERS+15

     2349    19153    3   CALL ASB$WRITE_USERS( AS_USERS );

  19153  4 011762   000104 630400 5                  EPPR0   68
         4 011763   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011764   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 011765   000000 011000                    NOP     0

     2350    19154    4   IF FACCOUNT_OPT THEN DO;

  19154  4 011766   200070 234100                    SZN     FACCOUNT_OPT,,AUTO
         4 011767   012030 605000 4                  TPL     EXIT#

     2351    19155    4      DSEG1$->SUPER_TO_PIG.TYPE = %DELETE_ACCT;

  19155  4 011770   000000 470400 xsym               LDP0    DSEG1$
         4 011771   004000 236003                    LDQ     2048,DU
         4 011772   000000 552140                    STBQ    0,'40'O,PR0

     2352    19156    4      DSEG1$->SUPER_TO_PIG.WIDTH = LO_WIDTH;

  19156  4 011773   000000 470400 xsym               LDP0    DSEG1$
         4 011774   000000 236000 xsym               LDQ     LO_WIDTH
         4 011775   000022 736000                    QLS     18
         4 011776   000000 676100                    ERQ     0,,PR0
         4 011777   000377 376003                    ANQ     255,DU
         4 012000   000000 656100                    ERSQ    0,,PR0

     2353    19157    4      DSEG1$->SUPER_TO_PIG.PROJ = '1'B;

  19157  4 012001   000000 470400 xsym               LDP0    DSEG1$
         4 012002   000400 236003                    LDQ     256,DU
         4 012003   000000 256100                    ORSQ    0,,PR0

     2354    19158    4      DSEG1$->SUPER_TO_PIG.RESUPER = AS_LOGON_KEY.TEXT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:386  

  19158  4 012004   000000 470400 xsym               LDP0    DSEG1$
         4 012005   040100 100400                    MLR     fill='040'O
         4 012006   000000 200024 xsym               ADSC9   AS_LOGON_KEY             cn=1,n=20
         4 012007   000000 400024                    ADSC9   0,,PR0                   cn=2,n=20

     2355    19159    4      DSEG1$->SUPER_TO_PIG.PROJECT_TEXT = AS_PROJECT.BUDGET.MACCT_.TEXT;

  19159  4 012010   000000 470400 xsym               LDP0    DSEG1$
         4 012011   040100 100400                    MLR     fill='040'O
         4 012012   000012 200024 xsym               ADSC9   AS_PROJECT+10            cn=1,n=20
         4 012013   000005 400024                    ADSC9   5,,PR0                   cn=2,n=20

     2356    19160    4      DSEG1$->SUPER_TO_PIG.PACKSET = AS_PROJECT.HPSN;

  19160  4 012014   040100 100400                    MLR     fill='040'O
         4 012015   000123 000006 xsym               ADSC9   AS_PROJECT+83            cn=0,n=6
         4 012016   000012 400006                    ADSC9   10,,PR0                  cn=2,n=6

     2357    19161    4      DSEG1$->SUPER_TO_PIG.ACCT    = AS_PROJECT.ACCT;

  19161  4 012017   040100 100400                    MLR     fill='040'O
         4 012020   000000 000010 xsym               ADSC9   AS_PROJECT               cn=0,n=8
         4 012021   000014 000010                    ADSC9   12,,PR0                  cn=0,n=8

     2358    19162    4      DSEG1$->SUPER_TO_PIG.ATTR.COUNT = 0;

  19162  4 012022   000000 220003                    LDX0    0,DU
         4 012023   000016 740100                    STX0    14,,PR0

     2359    19163    4      CALL ASB$PIG(DSEG1$->SUPER_TO_PIG);

  19163  4 012024   000000 630400 xsym               EPPR0   DSEG1$
         4 012025   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 012026   000000 701000 xent               TSX1    ASB$PIG
         4 012027   000000 011000                    NOP     0

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:387  
     2360    19164    4      END;

     2361    19165    3   EXIT#: RETURN;

  19165  4 012030   200072 221300       EXIT#        LDX1  ! ACCT_COUNT,,AUTO
         4 012031   000001 702211                    TSX2  ! 1,X1

     2362    19166
     2363    19167    3   END MOD_PROJ_ADMIN_REC;
     2364    19168
     2365    19169
     2366    19170    2   END REMOVE_USER_PROJECT;
     2367    19171        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:388  
     2368    19172        /*I*  NAME:       MAKEME
     2369    19173              CALL:       CALL MAKEME( CODE )
     2370    19174              INPUT:      CODE - indicates type of MAKEME command to be processed.
     2371    19175                          CODE            COMMAND
     2372    19176                           1              MAKEME
     2373    19177                           2              MAKEME  PROJECT
     2374    19178                           3              MAKEME  RESET
     2375    19179                           4              MAKEME  account,name
     2376    19180              DESCRIPTION:
     2377    19181                  This procedure processes a MAKEME command.
     2378    19182
     2379    19183                  COMMAND                     ACTION
     2380    19184                  -------             ----------------------------------------
     2381    19185                  MAKEME              Lists the current project administrator.
     2382    19186                  MAKEME PROJECT      Makes a SUPER user the project administrator of
     2383    19187                                      the project indicated by the logon
     2384    19188                                      account,name.
     2385    19189                  MAKEME RESET        Resets current project administrator to
     2386    19190                                      initial project adminstrator.
     2387    19191                  MAKEME account,name       Makes a SUPER user the project
     2388    19192                                      administrator of the project account,name.
     2389    19193
     2390    19194                  A system adminstrator can be the project administrator of any
     2391    19195                  project.  A project administrator can issue the MAKEME command
     2392    19196                  only for projects below him in the project hierarcy.
     2393    19197        */
     2394    19198
     2395    19199
     2396    19200    1   MAKEME: PROC( CODE );

  19200  4 012032   200050 741300       MAKEME       STX1  ! FREE_SEG_TYPE+1,,AUTO

     2397    19201
     2398    19202
     2399    19203    2   DCL CODE      UBIN;
     2400    19204
     2401    19205    2   DCL 1 PROJ_ADMIN_KEY,
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:389  
     2402    19206    2          2 CNT UBIN BYTE UNAL,
     2403    19207    2          2 TEXT CHAR(20);
     2404    19208
     2405    19209
     2406    19210
     2407    19211    3   DO SELECT( CODE );

  19211  4 012033   200051 470500                    LDP0    @CODE,,AUTO
         4 012034   000000 236100                    LDQ     0,,PR0
         4 012035   000002 116007                    CMPQ    2,DL
         4 012036   012046 602000 4                  TNC     s:19211+11
         4 012037   012055 600000 4                  TZE     s:19216
         4 012040   000003 116007                    CMPQ    3,DL
         4 012041   012113 602000 4                  TNC     s:19229
         4 012042   012061 600000 4                  TZE     s:19219
         4 012043   000004 116007                    CMPQ    4,DL
         4 012044   012113 601000 4                  TNZ     s:19229
         4 012045   012077 710000 4                  TRA     s:19224
         4 012046   000001 116007                    CMPQ    1,DL
         4 012047   012113 601000 4                  TNZ     s:19229
         4 012050   012051 710000 4                  TRA     s:19213

     2408    19212    3      SELECT( 1 /* MAKEME */ );

     2409    19213    3      PROJ_ADMIN_KEY = AS_PROJECT_ADMIN ;

  19213  4 012051   000100 100400                    MLR     fill='000'O
         4 012052   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 012053   200052 000025                    ADSC9   PROJ_ADMIN_KEY,,AUTO     cn=0,n=21
         4 012054   012113 710000 4                  TRA     s:19229

     2410    19214
     2411    19215    3      SELECT( 2 /* MAKEME SYS */ );

     2412    19216    3      PROJ_ADMIN_KEY = AS_LOGON_KEY ;

  19216  4 012055   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:390  
         4 012056   000000 000025 xsym               ADSC9   AS_LOGON_KEY             cn=0,n=21
         4 012057   200052 000025                    ADSC9   PROJ_ADMIN_KEY,,AUTO     cn=0,n=21
         4 012060   012113 710000 4                  TRA     s:19229

     2413    19217
     2414    19218    3      SELECT( 3 /* MAKEME RESET */ );

     2415    19219    3      IF PADMIN AND (NOT SUPERD) AND (NOT SUPERAUTH)

  19219  4 012061   000000 234000 xsym               SZN     PADMIN
         4 012062   012073 605000 4                  TPL     s:19221
         4 012063   000000 234000 xsym               SZN     SUPERD
         4 012064   012073 604000 4                  TMI     s:19221
         4 012065   000000 234000 xsym               SZN     SUPERAUTH
         4 012066   012073 604000 4                  TMI     s:19221

     2416    19220    3      THEN PROJ_ADMIN_KEY = AS_LOGON_KEY;

  19220  4 012067   000100 100400                    MLR     fill='000'O
         4 012070   000000 000025 xsym               ADSC9   AS_LOGON_KEY             cn=0,n=21
         4 012071   200052 000025                    ADSC9   PROJ_ADMIN_KEY,,AUTO     cn=0,n=21
         4 012072   012113 710000 4                  TRA     s:19229

     2417    19221    3      ELSE PROJ_ADMIN_KEY = AS_NONE;

  19221  4 012073   000100 100400                    MLR     fill='000'O
         4 012074   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 012075   200052 000025                    ADSC9   PROJ_ADMIN_KEY,,AUTO     cn=0,n=21
         4 012076   012113 710000 4                  TRA     s:19229

     2418    19222
     2419    19223    3      SELECT( 4 /* MAKEME PROJ */ );

     2420    19224    3      CALL ASB$KEYMAKER( PROJ_ADMIN_KEY,

  19224  4 012077   000000 471400 xsym               LDP1    NODE$
         4 012100   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:391  
         4 012101   300003 474500                    LDP4    3,,PR3
         4 012102   000252 237000 5                  LDAQ    170
         4 012103   200122 757100                    STAQ    I+4,,AUTO
         4 012104   200121 454500                    STP4    I+3,,AUTO
         4 012105   200052 633500                    EPPR3   PROJ_ADMIN_KEY,,AUTO
         4 012106   200120 453500                    STP3    I+2,,AUTO
         4 012107   200120 630500                    EPPR0   I+2,,AUTO
         4 012110   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 012111   000000 701000 xent               TSX1    ASB$KEYMAKER
         4 012112   012362 702000 4                  TSX2    EXIT#

     2421    19225    3           P$NODE.SUBLK$(0)->P$NODE.SUBLK$(0)->P$NODE,
     2422    19226    3           AS_TRUE, 53 /* MAKEME_VAL */ )  ALTRET( EXIT# );
     2423    19227    3      END;              /* Do case( code ); */

     2424    19228
     2425    19229    2   IF PROJ_ADMIN_KEY ~= AS_PROJECT_ADMIN

  19229  4 012113   000000 106500                    CMPC    fill='000'O
         4 012114   200052 000025                    ADSC9   PROJ_ADMIN_KEY,,AUTO     cn=0,n=21
         4 012115   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 012116   012244 600000 4                  TZE     s:19285
         4 012117   000000 106500                    CMPC    fill='000'O
         4 012120   200052 000025                    ADSC9   PROJ_ADMIN_KEY,,AUTO     cn=0,n=21
         4 012121   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 012122   012244 600000 4                  TZE     s:19285

     2426    19230    2        AND  PROJ_ADMIN_KEY ~= AS_NONE
     2427    19231    3   THEN DO;

     2428    19232                                                      /*
     2429    19233                                                         Read project record
     2430    19234                                                                         */
     2431    19235    3      USERS_KEY = PROJ_ADMIN_KEY;

  19235  4 012123   000000 100500                    MLR     fill='000'O
         4 012124   200052 000025                    ADSC9   PROJ_ADMIN_KEY,,AUTO     cn=0,n=21
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:392  
         4 012125   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     2432    19236    3      CALL ASB$READ_USERS( AS_PROJ_ADMIN ) ALTRET( PROJECT_DOESNT_EXIST );

  19236  4 012126   000126 630400 5                  EPPR0   86
         4 012127   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 012130   000000 701000 xent               TSX1    ASB$READ_USERS
         4 012131   012323 702000 4                  TSX2    PROJECT_DOESNT_EXIST

     2433    19237    3      IF (AS_PROJ_ADMIN.PPRIV(0) & %PPR_PADMIN#) ~= %PPR_PADMIN#

  19237  4 012132   000231 236000 xsym               LDQ     AS_PROJ_ADMIN+153
         4 012133   000026 376000 xsym               ANQ     B_VECTNIL+22
         4 012134   000026 116000 xsym               CMPQ    B_VECTNIL+22
         4 012135   012144 600000 4                  TZE     s:19242

     2434    19238    4      THEN DO;                        /* Its a user not a project */

     2435    19239    4        CALL ASA$ERROR( USERS_KEY, 305 /* USER/PROJECT NOT PROJECT/USER */, AS_TRUE );

  19239  4 012136   000255 630400 5                  EPPR0   173
         4 012137   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 012140   000000 701000 xent               TSX1    ASA$ERROR
         4 012141   000000 011000                    NOP     0

     2436    19240    4         RETURN;

  19240  4 012142   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 012143   000001 702211                    TSX2  ! 1,X1

     2437    19241    4         END;
     2438    19242    3      IF NOT SUPERAUTH  AND  PROJ_ADMIN_KEY ~= AS_LOGON_KEY

  19242  4 012144   000000 234000 xsym               SZN     SUPERAUTH
         4 012145   012244 604000 4                  TMI     s:19285
         4 012146   000000 106500                    CMPC    fill='000'O
         4 012147   200052 000025                    ADSC9   PROJ_ADMIN_KEY,,AUTO     cn=0,n=21
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:393  
         4 012150   000000 000025 xsym               ADSC9   AS_LOGON_KEY             cn=0,n=21
         4 012151   012244 600000 4                  TZE     s:19285

     2439    19243    4      THEN DO;

     2440    19244                                                      /*
     2441    19245                                                         Check if project is
     2442    19246                                                         below user in project
     2443    19247                                                         hierarchy.
     2444    19248                                                                          */
     2445    19249    4         AS_USERS = AS_PROJ_ADMIN;

  19249  4 012152   000000 100400                    MLR     fill='000'O
         4 012153   000000 004020 xsym               ADSC9   AS_PROJ_ADMIN            cn=0,n=2064
         4 012154   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064

     2446    19250    5         DO WHILE( AS_USERS.BUDGET.MACCT ~= AS_LOGON_KEY

  19250  4 012155   012165 710000 4                  TRA     s:19254

     2447    19251    5              AND  AS_USERS.BUDGET.MACCT ~= AS_NONE );
     2448    19252    5            USERS_KEY = AS_USERS.BUDGET.MACCT;

  19252  4 012156   000000 100400                    MLR     fill='000'O
         4 012157   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 012160   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

     2449    19253    5            CALL ASB$READ_USERS( AS_USERS ) ALTRET( INTERNAL_ERROR );

  19253  4 012161   000104 630400 5                  EPPR0   68
         4 012162   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 012163   000000 701000 xent               TSX1    ASB$READ_USERS
         4 012164   012337 702000 4                  TSX2    INTERNAL_ERROR

     2450    19254    5            END;

  19254  4 012165   000000 106400                    CMPC    fill='000'O
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:394  
         4 012166   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 012167   000000 000025 xsym               ADSC9   AS_LOGON_KEY             cn=0,n=21
         4 012170   012175 600000 4                  TZE     s:19255
         4 012171   000000 106400                    CMPC    fill='000'O
         4 012172   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 012173   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 012174   012156 601000 4                  TNZ     s:19252

     2451    19255    4         IF AS_USERS.BUDGET.MACCT = AS_NONE

  19255  4 012175   000000 106400                    CMPC    fill='000'O
         4 012176   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 012177   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 012200   012244 601000 4                  TNZ     s:19285

     2452    19256    5         THEN DO;

     2453    19257        /*E* ERROR:   ASA-E$CANT_BE_PROJ-C
     2454    19258             MESSAGE: You cannot be the project administrator of "%U1".
     2455    19259             MESSAGE1: You can issue a MAKEME command only for projects below you in
     2456    19260                       the project hierarchy.
     2457    19261        */
     2458    19262    5            CALL INDEX( I, ' ', SUBSTR( PROJ_ADMIN_KEY.TEXT, 0, 8 ) );

  19262  4 012201   000000 124500                    SCM     mask='000'O
         4 012202   200052 200010                    ADSC9   PROJ_ADMIN_KEY,,AUTO     cn=1,n=8
         4 012203   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 012204   200024 000100                    ARG     I,,AUTO

     2459    19263    5            CALL CONCAT( AS_FIELD1.TEXT, SUBSTR( PROJ_ADMIN_KEY.TEXT,0,I),

  19263  4 012205   200024 720100                    LXL0    I,,AUTO
         4 012206   040000 100540                    MLR     fill='040'O
         4 012207   200052 200010                    ADSC9   PROJ_ADMIN_KEY,,AUTO     cn=1,n=*X0
         4 012210   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         4 012211   200024 236100                    LDQ     I,,AUTO
         4 012212   000050 116007                    CMPQ    40,DL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:395  
         4 012213   012230 603000 4                  TRC     s:19265
         4 012214   777727 621006                    EAX1    -41,QL
         4 012215   777777 661003                    ERX1    -1,DU
         4 012216   040046 100400                    MLR     fill='040'O
         4 012217   000260 000001 5                  ADSC9   176                      cn=0,n=1
         4 012220   000000 200011 xsym               ADSC9   AS_FIELD1,Q              cn=1,n=*X1
         4 012221   000047 116007                    CMPQ    39,DL
         4 012222   012230 603000 4                  TRC     s:19265
         4 012223   777730 622006                    EAX2    -40,QL
         4 012224   777777 662003                    ERX2    -1,DU
         4 012225   040046 100500                    MLR     fill='040'O
         4 012226   200054 200014                    ADSC9   PROJ_ADMIN_KEY+2,,AUTO   cn=1,n=12
         4 012227   000000 400012 xsym               ADSC9   AS_FIELD1,Q              cn=2,n=*X2

     2460    19264    5                 ',', SUBSTR( PROJ_ADMIN_KEY.TEXT, 8) );
     2461    19265    5            AS_FIELD1.COUNT = I + PROJ_ADMIN_KEY.CNT - 7;

  19265  4 012230   200052 236100                    LDQ     PROJ_ADMIN_KEY,,AUTO
         4 012231   000033 772000                    QRL     27
         4 012232   200024 036100                    ADLQ    I,,AUTO
         4 012233   000007 136007                    SBLQ    7,DL
         4 012234   000033 736000                    QLS     27
         4 012235   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     2462    19266                 %SCREAM( ERR#=E$CANT_BE_PROJ, LEVEL=ERROR, MID='A' );

  19278  4 012236   000261 630400 5                  EPPR0   177
         4 012237   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 012240   000000 701000 xent               TSX1    ASH$ERROR
         4 012241   000000 011000                    NOP     0

     2463    19281    5            RETURN;

  19281  4 012242   200050 221300                    LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 012243   000001 702211                    TSX2  ! 1,X1

     2464    19282    5            END;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:396  
     2465    19283    4         END;
     2466    19284    3      END;
     2467    19285    2   AS_PROJECT_ADMIN = PROJ_ADMIN_KEY;

  19285  4 012244   000000 100500                    MLR     fill='000'O
         4 012245   200052 000025                    ADSC9   PROJ_ADMIN_KEY,,AUTO     cn=0,n=21
         4 012246   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21

     2468    19286        /*
     2469    19287                              Print current project administrator
     2470    19288        */
     2471    19289    2   IF AS_PROJECT_ADMIN = AS_NONE

  19289  4 012247   000000 106400                    CMPC    fill='000'O
         4 012250   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         4 012251   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 012252   012257 601000 4                  TNZ     s:19294

     2472    19290    3   THEN DO;

     2473    19291    3      OUT_BUF = '  Project:  NONE' ;

  19291  4 012253   040000 100400                    MLR     fill='040'O
         4 012254   000162 000020 3                  ADSC9   SIZEC_DREC+114           cn=0,n=16
         4 012255   000000 000214 xsym               ADSC9   OUT_BUF                  cn=0,n=140

     2474    19292    3      END;

  19292  4 012256   012311 710000 4                  TRA     s:19299

     2475    19293    3   ELSE DO;

     2476    19294    3      CALL INDEX( I, AS_BLANK, SUBSTR(AS_PROJECT_ADMIN.TEXT,0,8) );

  19294  4 012257   000000 124400                    SCM     mask='000'O
         4 012260   000000 200010 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=8
         4 012261   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:397  
         4 012262   200024 000100                    ARG     I,,AUTO

     2477    19295    3      CALL CONCAT( OUT_BUF, '  Project:  ',

  19295  4 012263   040000 100400                    MLR     fill='040'O
         4 012264   000162 000014 3                  ADSC9   SIZEC_DREC+114           cn=0,n=12
         4 012265   000000 000014 xsym               ADSC9   OUT_BUF                  cn=0,n=12
         4 012266   200024 720100                    LXL0    I,,AUTO
         4 012267   040000 100440                    MLR     fill='040'O
         4 012270   000000 200010 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=*X0
         4 012271   000003 000200 xsym               ADSC9   OUT_BUF+3                cn=0,n=128
         4 012272   200024 236100                    LDQ     I,,AUTO
         4 012273   000200 116007                    CMPQ    128,DL
         4 012274   012311 603000 4                  TRC     s:19299
         4 012275   777577 621006                    EAX1    -129,QL
         4 012276   777777 661003                    ERX1    -1,DU
         4 012277   040046 100400                    MLR     fill='040'O
         4 012300   000260 000001 5                  ADSC9   176                      cn=0,n=1
         4 012301   000003 000011 xsym               ADSC9   OUT_BUF+3,Q              cn=0,n=*X1
         4 012302   000177 116007                    CMPQ    127,DL
         4 012303   012311 603000 4                  TRC     s:19299
         4 012304   777600 622006                    EAX2    -128,QL
         4 012305   777777 662003                    ERX2    -1,DU
         4 012306   040046 100400                    MLR     fill='040'O
         4 012307   000002 200014 xsym               ADSC9   AS_PROJECT_ADMIN+2       cn=1,n=12
         4 012310   000003 200012 xsym               ADSC9   OUT_BUF+3,Q              cn=1,n=*X2

     2478    19296    3           SUBSTR(AS_PROJECT_ADMIN.TEXT,0,I), ',',
     2479    19297    3           SUBSTR(AS_PROJECT_ADMIN.TEXT,8) );
     2480    19298    3      END;

     2481    19299    2   CALL ASB$WRITE_LO( OUT_BUF, LENGTHC(OUT_BUF) );

  19299  4 012311   000011 630400 5                  EPPR0   9
         4 012312   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 012313   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 012314   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:398  

     2482    19300    2   CALL ASB$WRITE_LO( AS_BLANK, 1 );

  19300  4 012315   000006 630400 5                  EPPR0   6
         4 012316   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 012317   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 012320   000000 011000                    NOP     0

     2483    19301        /*
     2484    19302                                                      Error conditions
     2485    19303        */
     2486    19304    3   DO WHILE( AS_FALSE );

  19304  4 012321   000000 234000 xsym               SZN     AS_FALSE
         4 012322   012362 605000 4                  TPL     EXIT#

     2487    19305    3   PROJECT_DOESNT_EXIST:
     2488    19306    3      CALL ASA$ERROR( PROJ_ADMIN_KEY, 4 /* RECORD DOES NOT EXIST */, AS_TRUE );

  19306  4 012323   000036 236000 5     PROJECT_DOE* LDQ     30
         4 012324   200122 756100                    STQ     I+4,,AUTO
         4 012325   000262 236000 5                  LDQ     178
         4 012326   200121 756100                    STQ     I+3,,AUTO
         4 012327   200052 630500                    EPPR0   PROJ_ADMIN_KEY,,AUTO
         4 012330   200120 450500                    STP0    I+2,,AUTO
         4 012331   200120 630500                    EPPR0   I+2,,AUTO
         4 012332   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 012333   000000 701000 xent               TSX1    ASA$ERROR
         4 012334   000000 011000                    NOP     0

     2489    19307    4      DO WHILE( AS_FALSE );

  19307  4 012335   000000 234000 xsym               SZN     AS_FALSE
         4 012336   012361 605000 4                  TPL     s:19334

     2490    19308    4   INTERNAL_ERROR:
     2491    19309        /*E* ERROR:   ASA-E$PROJ_ADMIN_NOT_FOUND-C
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:399  
     2492    19310             MESSAGE: Internal error: project administrator "%U1" record does
     2493    19311                      not exist in :USERS file.
     2494    19312        */
     2495    19313    4         IF MERR_CODE.CODE = %E$NOKEY

  19313  4 012337   000000 236000 xsym  INTERNAL_ER* LDQ     ERR_CODE
         4 012340   377770 376007                    ANQ     131064,DL
         4 012341   001020 116007                    CMPQ    528,DL
         4 012342   012353 601000 4                  TNZ     s:19332

     2496    19314    5         THEN DO;

     2497    19315    5            AS_FIELD1 = PROJ_ADMIN_KEY;

  19315  4 012343   000000 100500                    MLR     fill='000'O
         4 012344   200052 000025                    ADSC9   PROJ_ADMIN_KEY,,AUTO     cn=0,n=21
         4 012345   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

     2498    19316                 %SCREAM( ERR#=E$PROJ_ADMIN_NOT_FOUND, LEVEL=ERROR, MID='A' );

  19328  4 012346   000263 630400 5                  EPPR0   179
         4 012347   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 012350   000000 701000 xent               TSX1    ASH$ERROR
         4 012351   000000 011000                    NOP     0

     2499    19331    5            END;

  19331  4 012352   012357 710000 4                  TRA     s:19333

     2500    19332    4         ELSE CALL ASH$ERROR( MERR_CODE );

  19332  4 012353   000001 630400 5                  EPPR0   1
         4 012354   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 012355   000000 701000 xent               TSX1    ASH$ERROR
         4 012356   000000 011000                    NOP     0

     2501    19333    4         END;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:400  

  19333  4 012357   000000 234000 xsym               SZN     AS_FALSE
         4 012360   012337 604000 4                  TMI     INTERNAL_ERROR

     2502    19334    3      END;

  19334  4 012361   012323 604000 4                  TMI     PROJECT_DOESNT_EXIST

     2503    19335
     2504    19336    2   EXIT#: RETURN;

  19336  4 012362   200050 221300       EXIT#        LDX1  ! FREE_SEG_TYPE+1,,AUTO
         4 012363   000001 702211                    TSX2  ! 1,X1

     2505    19337
     2506    19338    2   END   MAKEME;
     2507    19339
     2508    19340        %EJECT;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:401  
     2509    19341    1   COMPARE_FROM_TO_MAX: PROC( FROM_USERS, FROM_DREC, MAX_USERS, MAX_DREC );

  19341  4 012364   200074 741300       COMPARE_FRO* STX1  ! ACCT_COUNT+2,,AUTO

     2510    19342
     2511    19343
     2512    19344        %AS_USERS(STR_NAME=FROM_USERS, STCLASS=" ");
     2513    19522        %KL_DREC( NAME=FROM_DREC, STCLASS=" " , LAST=",");
     2514    19635        %KL_FEBLK( NAME=FROM_BLK, RCNT=31, LVL=2, STCLASS=" " ) ;
     2515    19684        %AS_USERS(STR_NAME=MAX_USERS, STCLASS=" " );
     2516    19862        %KL_DREC( NAME=MAX_DREC, STCLASS=" ", LAST="," );
     2517    19975        %KL_FEBLK( NAME=MAX_BLK, RCNT=31, LVL=2, STCLASS=" " ) ;
     2518    20024
     2519    20025    2   DCL I UBIN;
     2520    20026    2   DCL J UBIN;
     2521    20027    2   DCL TEMP_PRIV BIT(36);
     2522    20028
     2523    20029
     2524    20030        %MACRO COMPARE( MAX=MAX, DEFAULT=DEFAULT );
     2525    20031
     2526    20032        %SET MAX_ = CONCAT( 'FROM_USERS.', TEXTCHAR(MAX) );
     2527    20033        %SET DEFAULT_ = CONCAT( 'FROM_USERS.', TEXTCHAR(DEFAULT) );
     2528    20034        %SET MAXIMUM_ = CONCAT( 'MAX_USERS.', TEXTCHAR(MAX) );
     2529    20035
     2530    20036        IF %CHARTEXT(MAX_) > %CHARTEXT(MAXIMUM_)
     2531    20037        THEN DO;
     2532    20038           %CHARTEXT(MAX_) = %CHARTEXT(MAXIMUM_);
     2533    20039           IF %CHARTEXT(DEFAULT_) > %CHARTEXT(MAXIMUM_)
     2534    20040           THEN %CHARTEXT(DEFAULT_) = %CHARTEXT(MAXIMUM_);
     2535    20041           END;
     2536    20042        %MEND;
     2537    20043
     2538    20044
     2539    20045
     2540    20046        %SET LISTDIR='0'B;
     2544    20050                                                      /*
     2545    20051                                                         Compare accesses
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:402  
     2546    20052                                                      */
     2547    20053    2   IF FROM_DREC.FLAGS.BATOK  AND  NOT MAX_DREC.FLAGS.BATOK

  20053  4 012365   200076 470500                    LDP0    @FROM_DREC,,AUTO
         4 012366   000000 236100                    LDQ     0,,PR0
         4 012367   000040 316003                    CANQ    32,DU
         4 012370   012410 600000 4                  TZE     s:20058
         4 012371   200100 471500                    LDP1    @MAX_DREC,,AUTO
         4 012372   100000 236100                    LDQ     0,,PR1
         4 012373   000040 316003                    CANQ    32,DU
         4 012374   012410 601000 4                  TNZ     s:20058

     2548    20054    3   THEN DO;

     2549    20055    3      FROM_DREC.FLAGS.BATOK = AS_FALSE;

  20055  4 012375   000000 236000 xsym               LDQ     AS_FALSE
         4 012376   000014 772000                    QRL     12
         4 012377   000000 676100                    ERQ     0,,PR0
         4 012400   000040 376003                    ANQ     32,DU
         4 012401   000000 656100                    ERSQ    0,,PR0

     2550    20056    3      FROM_USERS.BATOK = AS_FALSE;

  20056  4 012402   200075 473500                    LDP3    @FROM_USERS,,AUTO
         4 012403   000000 236000 xsym               LDQ     AS_FALSE
         4 012404   000012 772000                    QRL     10
         4 012405   300005 676100                    ERQ     5,,PR3
         4 012406   000200 376003                    ANQ     128,DU
         4 012407   300005 656100                    ERSQ    5,,PR3

     2551    20057    3      END;

     2552    20058    2   IF FROM_DREC.FLAGS.OLOK  AND  NOT MAX_DREC.FLAGS.OLOK

  20058  4 012410   000000 236100                    LDQ     0,,PR0
         4 012411   000100 316003                    CANQ    64,DU
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:403  
         4 012412   012424 600000 4                  TZE     s:20061
         4 012413   200100 471500                    LDP1    @MAX_DREC,,AUTO
         4 012414   100000 236100                    LDQ     0,,PR1
         4 012415   000100 316003                    CANQ    64,DU
         4 012416   012424 601000 4                  TNZ     s:20061

     2553    20059    2   THEN
     2554    20060    2      FROM_DREC.FLAGS.OLOK = AS_FALSE;

  20060  4 012417   000000 236000 xsym               LDQ     AS_FALSE
         4 012420   000013 772000                    QRL     11
         4 012421   000000 676100                    ERQ     0,,PR0
         4 012422   000100 376003                    ANQ     64,DU
         4 012423   000000 656100                    ERSQ    0,,PR0

     2555    20061    2   IF FROM_DREC.FLAGS.GHOSTOK  AND  NOT MAX_DREC.FLAGS.GHOSTOK

  20061  4 012424   000000 236100                    LDQ     0,,PR0
         4 012425   000200 316003                    CANQ    128,DU
         4 012426   012440 600000 4                  TZE     s:20064
         4 012427   200100 471500                    LDP1    @MAX_DREC,,AUTO
         4 012430   100000 236100                    LDQ     0,,PR1
         4 012431   000200 316003                    CANQ    128,DU
         4 012432   012440 601000 4                  TNZ     s:20064

     2556    20062    2   THEN
     2557    20063    2      FROM_DREC.FLAGS.GHOSTOK = AS_FALSE;

  20063  4 012433   000000 236000 xsym               LDQ     AS_FALSE
         4 012434   000012 772000                    QRL     10
         4 012435   000000 676100                    ERQ     0,,PR0
         4 012436   000200 376003                    ANQ     128,DU
         4 012437   000000 656100                    ERSQ    0,,PR0

     2558    20064    2   IF FROM_DREC.FLAGS.TPOK  AND  NOT MAX_DREC.FLAGS.TPOK

  20064  4 012440   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:404  
         4 012441   000001 316003                    CANQ    1,DU
         4 012442   012454 600000 4                  TZE     s:20067
         4 012443   200100 471500                    LDP1    @MAX_DREC,,AUTO
         4 012444   100000 236100                    LDQ     0,,PR1
         4 012445   000001 316003                    CANQ    1,DU
         4 012446   012454 601000 4                  TNZ     s:20067

     2559    20065    2   THEN
     2560    20066    2      FROM_DREC.FLAGS.TPOK = AS_FALSE;

  20066  4 012447   000000 236000 xsym               LDQ     AS_FALSE
         4 012450   000021 772000                    QRL     17
         4 012451   000000 676100                    ERQ     0,,PR0
         4 012452   000001 376003                    ANQ     1,DU
         4 012453   000000 656100                    ERSQ    0,,PR0

     2561    20067    2   IF FROM_DREC.FLAGS.FEOK  AND  NOT MAX_DREC.FLAGS.FEOK

  20067  4 012454   000000 236100                    LDQ     0,,PR0
         4 012455   400000 316007                    CANQ    -131072,DL
         4 012456   012470 600000 4                  TZE     s:20073
         4 012457   200100 471500                    LDP1    @MAX_DREC,,AUTO
         4 012460   100000 236100                    LDQ     0,,PR1
         4 012461   400000 316007                    CANQ    -131072,DL
         4 012462   012470 601000 4                  TNZ     s:20073

     2562    20068    2   THEN
     2563    20069    2      FROM_DREC.FLAGS.FEOK = AS_FALSE;

  20069  4 012463   000000 236000 xsym               LDQ     AS_FALSE
         4 012464   000022 772000                    QRL     18
         4 012465   000000 676100                    ERQ     0,,PR0
         4 012466   400000 376007                    ANQ     -131072,DL
         4 012467   000000 656100                    ERSQ    0,,PR0

     2564    20070                                                      /*
     2565    20071                                                         Compare budget sub-options
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:405  
     2566    20072                                                      */
     2567    20073    2   IF MAX_USERS.BUDGET.MAXC > 0

  20073  4 012470   200077 471500                    LDP1    @MAX_USERS,,AUTO
         4 012471   100006 235100                    LDA     6,,PR1
         4 012472   012500 604400 4                  TMOZ    s:20078
         4 012473   200075 473500                    LDP3    @FROM_USERS,,AUTO
         4 012474   300006 236100                    LDQ     6,,PR3
         4 012475   100006 116100                    CMPQ    6,,PR1
         4 012476   012500 604400 4                  TMOZ    s:20078

     2568    20074    2        AND  FROM_USERS.BUDGET.MAXC > MAX_USERS.BUDGET.MAXC
     2569    20075    2   THEN
     2570    20076    2      FROM_USERS.BUDGET.MAXC = MAX_USERS.BUDGET.MAXC;

  20076  4 012477   300006 755100                    STA     6,,PR3

     2571    20077
     2572    20078    2   IF NOT SUPERAUTH THEN FROM_USERS.BUDGET.ACCUM = 0;

  20078  4 012500   000000 234000 xsym               SZN     SUPERAUTH
         4 012501   012504 604000 4                  TMI     s:20079

  20078  4 012502   200075 473500                    LDP3    @FROM_USERS,,AUTO
         4 012503   300007 450100                    STZ     7,,PR3

     2573    20079    2   IF MAX_USERS.BUDGET.PCHARGES  AND  NOT FROM_USERS.BUDGET.PCHARGES

  20079  4 012504   100017 236100                    LDQ     15,,PR1
         4 012505   000100 316003                    CANQ    64,DU
         4 012506   012520 600000 4                  TZE     s:20082
         4 012507   200075 473500                    LDP3    @FROM_USERS,,AUTO
         4 012510   300017 236100                    LDQ     15,,PR3
         4 012511   000100 316003                    CANQ    64,DU
         4 012512   012520 601000 4                  TNZ     s:20082

     2574    20080    2   THEN
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:406  
     2575    20081    2      FROM_USERS.BUDGET.PCHARGES = AS_TRUE;

  20081  4 012513   000000 236000 xsym               LDQ     AS_TRUE
         4 012514   000013 772000                    QRL     11
         4 012515   300017 676100                    ERQ     15,,PR3
         4 012516   000100 376003                    ANQ     64,DU
         4 012517   300017 656100                    ERSQ    15,,PR3

     2576    20082    2   IF MAX_USERS.BUDGET.ICHARGES  AND  NOT FROM_USERS.BUDGET.ICHARGES

  20082  4 012520   100017 236100                    LDQ     15,,PR1
         4 012521   000040 316003                    CANQ    32,DU
         4 012522   012534 600000 4                  TZE     s:20085
         4 012523   200075 473500                    LDP3    @FROM_USERS,,AUTO
         4 012524   300017 236100                    LDQ     15,,PR3
         4 012525   000040 316003                    CANQ    32,DU
         4 012526   012534 601000 4                  TNZ     s:20085

     2577    20083    2   THEN
     2578    20084    2      FROM_USERS.BUDGET.ICHARGES = AS_TRUE;

  20084  4 012527   000000 236000 xsym               LDQ     AS_TRUE
         4 012530   000014 772000                    QRL     12
         4 012531   300017 676100                    ERQ     15,,PR3
         4 012532   000040 376003                    ANQ     32,DU
         4 012533   300017 656100                    ERSQ    15,,PR3

     2579    20085    2   IF MAX_USERS.BUDGET.BUDLIM  AND  NOT FROM_USERS.BUDGET.BUDLIM

  20085  4 012534   100017 236100                    LDQ     15,,PR1
         4 012535   000200 316003                    CANQ    128,DU
         4 012536   012550 600000 4                  TZE     s:20088
         4 012537   200075 473500                    LDP3    @FROM_USERS,,AUTO
         4 012540   300017 236100                    LDQ     15,,PR3
         4 012541   000200 316003                    CANQ    128,DU
         4 012542   012550 601000 4                  TNZ     s:20088

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:407  
     2580    20086    2   THEN
     2581    20087    2      FROM_USERS.BUDGET.BUDLIM = AS_TRUE;

  20087  4 012543   000000 236000 xsym               LDQ     AS_TRUE
         4 012544   000012 772000                    QRL     10
         4 012545   300017 676100                    ERQ     15,,PR3
         4 012546   000200 376003                    ANQ     128,DU
         4 012547   300017 656100                    ERSQ    15,,PR3

     2582    20088    2   IF NOT MAX_USERS.BUDGET.BKACC  AND  FROM_USERS.BUDGET.BKACC

  20088  4 012550   100017 236100                    LDQ     15,,PR1
         4 012551   000400 316003                    CANQ    256,DU
         4 012552   012564 601000 4                  TNZ     s:20094
         4 012553   200075 473500                    LDP3    @FROM_USERS,,AUTO
         4 012554   300017 236100                    LDQ     15,,PR3
         4 012555   000400 316003                    CANQ    256,DU
         4 012556   012564 600000 4                  TZE     s:20094

     2583    20089    2   THEN
     2584    20090    2      FROM_USERS.BUDGET.BKACC = AS_FALSE;

  20090  4 012557   000000 236000 xsym               LDQ     AS_FALSE
         4 012560   000011 772000                    QRL     9
         4 012561   300017 676100                    ERQ     15,,PR3
         4 012562   000400 376003                    ANQ     256,DU
         4 012563   300017 656100                    ERSQ    15,,PR3

     2585    20091                                                      /*
     2586    20092                                                         Compare outputprio
     2587    20093                                                      */
     2588    20094    2   IF FROM_USERS.OUTPUTPRIO > MAX_USERS.OUTPUTPRIO

  20094  4 012564   200075 473500                    LDP3    @FROM_USERS,,AUTO
         4 012565   300035 236100                    LDQ     29,,PR3
         4 012566   000777 376007                    ANQ     511,DL
         4 012567   200120 756100                    STQ     I+2,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:408  
         4 012570   100035 236100                    LDQ     29,,PR1
         4 012571   000777 376007                    ANQ     511,DL
         4 012572   200120 116100                    CMPQ    I+2,,AUTO
         4 012573   012576 605000 4                  TPL     s:20100

     2589    20095    2   THEN
     2590    20096    2      FROM_USERS.OUTPUTPRIO = MAX_USERS.OUTPUTPRIO;

  20096  4 012574   100035 236100                    LDQ     29,,PR1
         4 012575   300035 552104                    STBQ    29,'04'O,PR3

     2591    20097                                                      /*
     2592    20098                                                         Check for all modes
     2593    20099                                                      */
     2594    20100    3   DO I = 0 TO 3;

  20100  4 012576   200101 450100                    STZ     I,,AUTO

     2595    20101                                                      /*
     2596    20102                                                         Compare services
     2597    20103                                                      */
             20108    3   IF FROM_USERS.MLO(I) > MAX_USERS.MLO(I)

  20108  4 012577   200075 470500                    LDP0    @FROM_USERS,,AUTO
         4 012600   200101 720100                    LXL0    I,,AUTO
         4 012601   200077 471500                    LDP1    @MAX_USERS,,AUTO
         4 012602   100036 236110                    LDQ     30,X0,PR1
         4 012603   000036 116110                    CMPQ    30,X0,PR0
         4 012604   012612 603000 4                  TRC     s:20119

             20109    4   THEN DO;

             20110    4      FROM_USERS.MLO(I) = MAX_USERS.MLO(I);

  20110  4 012605   000036 756110                    STQ     30,X0,PR0

             20111    4      IF FROM_USERS.DLO(I) > MAX_USERS.MLO(I)
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:409  

  20111  4 012606   100036 236110                    LDQ     30,X0,PR1
         4 012607   000042 116110                    CMPQ    34,X0,PR0
         4 012610   012612 603000 4                  TRC     s:20119

             20112    4      THEN FROM_USERS.DLO(I) = MAX_USERS.MLO(I);

  20112  4 012611   000042 756110                    STQ     34,X0,PR0

             20113    4      END;

             20119    3   IF FROM_USERS.MDO(I) > MAX_USERS.MDO(I)

  20119  4 012612   100046 236110                    LDQ     38,X0,PR1
         4 012613   000046 116110                    CMPQ    38,X0,PR0
         4 012614   012622 603000 4                  TRC     s:20130

             20120    4   THEN DO;

             20121    4      FROM_USERS.MDO(I) = MAX_USERS.MDO(I);

  20121  4 012615   000046 756110                    STQ     38,X0,PR0

             20122    4      IF FROM_USERS.DDO(I) > MAX_USERS.MDO(I)

  20122  4 012616   100046 236110                    LDQ     38,X0,PR1
         4 012617   000052 116110                    CMPQ    42,X0,PR0
         4 012620   012622 603000 4                  TRC     s:20130

             20123    4      THEN FROM_USERS.DDO(I) = MAX_USERS.MDO(I);

  20123  4 012621   000052 756110                    STQ     42,X0,PR0

             20124    4      END;

             20130    3   IF FROM_USERS.MPO(I) > MAX_USERS.MPO(I)

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:410  
  20130  4 012622   100056 236110                    LDQ     46,X0,PR1
         4 012623   000056 116110                    CMPQ    46,X0,PR0
         4 012624   012632 603000 4                  TRC     s:20141

             20131    4   THEN DO;

             20132    4      FROM_USERS.MPO(I) = MAX_USERS.MPO(I);

  20132  4 012625   000056 756110                    STQ     46,X0,PR0

             20133    4      IF FROM_USERS.DPO(I) > MAX_USERS.MPO(I)

  20133  4 012626   100056 236110                    LDQ     46,X0,PR1
         4 012627   000062 116110                    CMPQ    50,X0,PR0
         4 012630   012632 603000 4                  TRC     s:20141

             20134    4      THEN FROM_USERS.DPO(I) = MAX_USERS.MPO(I);

  20134  4 012631   000062 756110                    STQ     50,X0,PR0

             20135    4      END;

             20141    3   IF FROM_USERS.MPDIS(I) > MAX_USERS.MPDIS(I)

  20141  4 012632   100066 236110                    LDQ     54,X0,PR1
         4 012633   000066 116110                    CMPQ    54,X0,PR0
         4 012634   012642 603000 4                  TRC     s:20152

             20142    4   THEN DO;

             20143    4      FROM_USERS.MPDIS(I) = MAX_USERS.MPDIS(I);

  20143  4 012635   000066 756110                    STQ     54,X0,PR0

             20144    4      IF FROM_USERS.DPDIS(I) > MAX_USERS.MPDIS(I)

  20144  4 012636   100066 236110                    LDQ     54,X0,PR1
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:411  
         4 012637   000072 116110                    CMPQ    58,X0,PR0
         4 012640   012642 603000 4                  TRC     s:20152

             20145    4      THEN FROM_USERS.DPDIS(I) = MAX_USERS.MPDIS(I);

  20145  4 012641   000072 756110                    STQ     58,X0,PR0

             20146    4      END;

             20152    3   IF FROM_USERS.MTDIS(I) > MAX_USERS.MTDIS(I)

  20152  4 012642   100076 236110                    LDQ     62,X0,PR1
         4 012643   000076 116110                    CMPQ    62,X0,PR0
         4 012644   012652 603000 4                  TRC     s:20163

             20153    4   THEN DO;

             20154    4      FROM_USERS.MTDIS(I) = MAX_USERS.MTDIS(I);

  20154  4 012645   000076 756110                    STQ     62,X0,PR0

             20155    4      IF FROM_USERS.DTDIS(I) > MAX_USERS.MTDIS(I)

  20155  4 012646   100076 236110                    LDQ     62,X0,PR1
         4 012647   000102 116110                    CMPQ    66,X0,PR0
         4 012650   012652 603000 4                  TRC     s:20163

             20156    4      THEN FROM_USERS.DTDIS(I) = MAX_USERS.MTDIS(I);

  20156  4 012651   000102 756110                    STQ     66,X0,PR0

             20157    4      END;

             20163    3   IF FROM_USERS.MFPOOLS(I) > MAX_USERS.MFPOOLS(I)

  20163  4 012652   200101 235100                    LDA     I,,AUTO
         4 012653   000100 101505                    MRL     fill='000'O
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:412  
         4 012654   000106 000001                    ADSC9   70,A,PR0                 cn=0,n=1
         4 012655   200120 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
         4 012656   000100 101505                    MRL     fill='000'O
         4 012657   100106 000001                    ADSC9   70,A,PR1                 cn=0,n=1
         4 012660   200121 000004                    ADSC9   I+3,,AUTO                cn=0,n=4
         4 012661   200121 236100                    LDQ     I+3,,AUTO
         4 012662   200120 116100                    CMPQ    I+2,,AUTO
         4 012663   012703 605000 4                  TPL     s:20174

             20164    4   THEN DO;

             20165    4      FROM_USERS.MFPOOLS(I) = MAX_USERS.MFPOOLS(I);

  20165  4 012664   000105 100505                    MLR     fill='000'O
         4 012665   100106 000001                    ADSC9   70,A,PR1                 cn=0,n=1
         4 012666   000106 000001                    ADSC9   70,A,PR0                 cn=0,n=1

             20166    4      IF FROM_USERS.DFPOOLS(I) > MAX_USERS.MFPOOLS(I)

  20166  4 012667   000100 101505                    MRL     fill='000'O
         4 012670   000107 000001                    ADSC9   71,A,PR0                 cn=0,n=1
         4 012671   200120 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
         4 012672   000100 101505                    MRL     fill='000'O
         4 012673   100106 000001                    ADSC9   70,A,PR1                 cn=0,n=1
         4 012674   200121 000004                    ADSC9   I+3,,AUTO                cn=0,n=4
         4 012675   200121 236100                    LDQ     I+3,,AUTO
         4 012676   200120 116100                    CMPQ    I+2,,AUTO
         4 012677   012703 605000 4                  TPL     s:20174

             20167    4      THEN FROM_USERS.DFPOOLS(I) = MAX_USERS.MFPOOLS(I);

  20167  4 012700   000105 100505                    MLR     fill='000'O
         4 012701   100106 000001                    ADSC9   70,A,PR1                 cn=0,n=1
         4 012702   000107 000001                    ADSC9   71,A,PR0                 cn=0,n=1

             20168    4      END;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:413  
             20174    3   IF FROM_USERS.MMPRIO(I) > MAX_USERS.MMPRIO(I)

  20174  4 012703   000100 101505                    MRL     fill='000'O
         4 012704   000110 000001                    ADSC9   72,A,PR0                 cn=0,n=1
         4 012705   200120 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
         4 012706   000100 101505                    MRL     fill='000'O
         4 012707   100110 000001                    ADSC9   72,A,PR1                 cn=0,n=1
         4 012710   200121 000004                    ADSC9   I+3,,AUTO                cn=0,n=4
         4 012711   200121 236100                    LDQ     I+3,,AUTO
         4 012712   200120 116100                    CMPQ    I+2,,AUTO
         4 012713   012733 605000 4                  TPL     s:20188

             20175    4   THEN DO;

             20176    4      FROM_USERS.MMPRIO(I) = MAX_USERS.MMPRIO(I);

  20176  4 012714   000105 100505                    MLR     fill='000'O
         4 012715   100110 000001                    ADSC9   72,A,PR1                 cn=0,n=1
         4 012716   000110 000001                    ADSC9   72,A,PR0                 cn=0,n=1

             20177    4      IF FROM_USERS.DMPRIO(I) > MAX_USERS.MMPRIO(I)

  20177  4 012717   000100 101505                    MRL     fill='000'O
         4 012720   000111 000001                    ADSC9   73,A,PR0                 cn=0,n=1
         4 012721   200120 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
         4 012722   000100 101505                    MRL     fill='000'O
         4 012723   100110 000001                    ADSC9   72,A,PR1                 cn=0,n=1
         4 012724   200121 000004                    ADSC9   I+3,,AUTO                cn=0,n=4
         4 012725   200121 236100                    LDQ     I+3,,AUTO
         4 012726   200120 116100                    CMPQ    I+2,,AUTO
         4 012727   012733 605000 4                  TPL     s:20188

             20178    4      THEN FROM_USERS.DMPRIO(I) = MAX_USERS.MMPRIO(I);

  20178  4 012730   000105 100505                    MLR     fill='000'O
         4 012731   100110 000001                    ADSC9   72,A,PR1                 cn=0,n=1
         4 012732   000111 000001                    ADSC9   73,A,PR0                 cn=0,n=1
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:414  

             20179    4      END;

     2605    20181                                                      /*
     2606    20182                                                         Compare time
     2607    20183                                                      */
             20188    3   IF FROM_USERS.MTIME(I) > MAX_USERS.MTIME(I)

  20188  4 012733   100251 236110                    LDQ     169,X0,PR1
         4 012734   000251 116110                    CMPQ    169,X0,PR0
         4 012735   012743 603000 4                  TRC     s:20202

             20189    4   THEN DO;

             20190    4      FROM_USERS.MTIME(I) = MAX_USERS.MTIME(I);

  20190  4 012736   000251 756110                    STQ     169,X0,PR0

             20191    4      IF FROM_USERS.DTIME(I) > MAX_USERS.MTIME(I)

  20191  4 012737   100251 236110                    LDQ     169,X0,PR1
         4 012740   000255 116110                    CMPQ    173,X0,PR0
         4 012741   012743 603000 4                  TRC     s:20202

             20192    4      THEN FROM_USERS.DTIME(I) = MAX_USERS.MTIME(I);

  20192  4 012742   000255 756110                    STQ     173,X0,PR0

             20193    4      END;

     2609    20195                                                      /*
     2610    20196                                                         Compare memory
     2611    20197                                                      */
             20202    3   IF FROM_USERS.MMEM(I) > MAX_USERS.MMEM(I)

  20202  4 012743   000001 735000                    ALS     1
         4 012744   000100 101505                    MRL     fill='000'O
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:415  
         4 012745   000261 000002                    ADSC9   177,A,PR0                cn=0,n=2
         4 012746   200120 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
         4 012747   000100 101505                    MRL     fill='000'O
         4 012750   100261 000002                    ADSC9   177,A,PR1                cn=0,n=2
         4 012751   200121 000004                    ADSC9   I+3,,AUTO                cn=0,n=4
         4 012752   200121 236100                    LDQ     I+3,,AUTO
         4 012753   200120 116100                    CMPQ    I+2,,AUTO
         4 012754   012774 605000 4                  TPL     s:20212

             20203    4   THEN DO;

             20204    4      FROM_USERS.MMEM(I) = MAX_USERS.MMEM(I);

  20204  4 012755   000105 100505                    MLR     fill='000'O
         4 012756   100261 000002                    ADSC9   177,A,PR1                cn=0,n=2
         4 012757   000261 000002                    ADSC9   177,A,PR0                cn=0,n=2

             20205    4      IF FROM_USERS.DMEM(I) > MAX_USERS.MMEM(I)

  20205  4 012760   000100 101505                    MRL     fill='000'O
         4 012761   000263 000002                    ADSC9   179,A,PR0                cn=0,n=2
         4 012762   200120 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
         4 012763   000100 101505                    MRL     fill='000'O
         4 012764   100261 000002                    ADSC9   177,A,PR1                cn=0,n=2
         4 012765   200121 000004                    ADSC9   I+3,,AUTO                cn=0,n=4
         4 012766   200121 236100                    LDQ     I+3,,AUTO
         4 012767   200120 116100                    CMPQ    I+2,,AUTO
         4 012770   012774 605000 4                  TPL     s:20212

             20206    4      THEN FROM_USERS.DMEM(I) = MAX_USERS.MMEM(I);

  20206  4 012771   000105 100505                    MLR     fill='000'O
         4 012772   100261 000002                    ADSC9   177,A,PR1                cn=0,n=2
         4 012773   000263 000002                    ADSC9   179,A,PR0                cn=0,n=2

             20207    4      END;

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:416  
     2613    20209                                                      /*
     2614    20210                                                         Compare privileges
     2615    20211                                                      */
     2616    20212    4      DO J = 0 TO SIZEW(AS_PRIVILEGE)-1;

  20212  4 012774   200102 450100                    STZ     J,,AUTO
         4 012775   013022 710000 4                  TRA     s:20219+3

     2617    20213    4         TEMP_PRIV = AS_PRIVILEGE(J);

  20213  4 012776   200102 720100                    LXL0    J,,AUTO
         4 012777   000000 236010 xsym               LDQ     AS_PRIVILEGE,X0
         4 013000   200103 756100                    STQ     TEMP_PRIV,,AUTO

     2618    20214    4         IF (TEMP_PRIV & FROM_USERS.PRIV(I)) = TEMP_PRIV

  20214  4 013001   200075 470500                    LDP0    @FROM_USERS,,AUTO
         4 013002   200101 721100                    LXL1    I,,AUTO
         4 013003   000225 376111                    ANQ     149,X1,PR0
         4 013004   200103 116100                    CMPQ    TEMP_PRIV,,AUTO
         4 013005   013017 601000 4                  TNZ     s:20219

     2619    20215    4         THEN
     2620    20216    4            IF (TEMP_PRIV & MAX_USERS.PRIV(I)) ~= TEMP_PRIV

  20216  4 013006   200077 471500                    LDP1    @MAX_USERS,,AUTO
         4 013007   200103 236100                    LDQ     TEMP_PRIV,,AUTO
         4 013010   100225 376111                    ANQ     149,X1,PR1
         4 013011   200103 116100                    CMPQ    TEMP_PRIV,,AUTO
         4 013012   013017 600000 4                  TZE     s:20219

     2621    20217    4            THEN
     2622    20218    4               FROM_USERS.PRIV(I) = FROM_USERS.PRIV(I) & ~(TEMP_PRIV);

  20218  4 013013   200103 236100                    LDQ     TEMP_PRIV,,AUTO
         4 013014   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 013015   000225 376111                    ANQ     149,X1,PR0
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:417  
         4 013016   000225 756111                    STQ     149,X1,PR0

     2623    20219    4         END;

  20219  4 013017   200102 235100                    LDA     J,,AUTO
         4 013020   000001 035007                    ADLA    1,DL
         4 013021   200102 755100                    STA     J,,AUTO
         4 013022   200102 235100                    LDA     J,,AUTO
         4 013023   000030 115007                    CMPA    24,DL
         4 013024   012776 602000 4                  TNC     s:20213

     2624    20220                                                      /*
     2625    20221                                                         Compare pprivileges
     2626    20222                                                      */
     2627    20223    4      DO J = 0 TO SIZEW(AS_PPRIVILEGE)-1;

  20223  4 013025   200102 450100                    STZ     J,,AUTO
         4 013026   013053 710000 4                  TRA     s:20230+3

     2628    20224    4         TEMP_PRIV = AS_PPRIVILEGE(J);

  20224  4 013027   200102 720100                    LXL0    J,,AUTO
         4 013030   000000 236010 xsym               LDQ     AS_PPRIVILEGE,X0
         4 013031   200103 756100                    STQ     TEMP_PRIV,,AUTO

     2629    20225    4         IF (TEMP_PRIV & FROM_USERS.PPRIV(I)) = TEMP_PRIV

  20225  4 013032   200075 470500                    LDP0    @FROM_USERS,,AUTO
         4 013033   200101 721100                    LXL1    I,,AUTO
         4 013034   000231 376111                    ANQ     153,X1,PR0
         4 013035   200103 116100                    CMPQ    TEMP_PRIV,,AUTO
         4 013036   013050 601000 4                  TNZ     s:20230

     2630    20226    4         THEN
     2631    20227    4            IF (TEMP_PRIV & MAX_USERS.PPRIV(I)) ~= TEMP_PRIV

  20227  4 013037   200077 471500                    LDP1    @MAX_USERS,,AUTO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:418  
         4 013040   200103 236100                    LDQ     TEMP_PRIV,,AUTO
         4 013041   100231 376111                    ANQ     153,X1,PR1
         4 013042   200103 116100                    CMPQ    TEMP_PRIV,,AUTO
         4 013043   013050 600000 4                  TZE     s:20230

     2632    20228    4            THEN
     2633    20229    4               FROM_USERS.PPRIV(I) = FROM_USERS.PPRIV(I) & ~(TEMP_PRIV);

  20229  4 013044   200103 236100                    LDQ     TEMP_PRIV,,AUTO
         4 013045   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 013046   000231 376111                    ANQ     153,X1,PR0
         4 013047   000231 756111                    STQ     153,X1,PR0

     2634    20230    4         END;

  20230  4 013050   200102 235100                    LDA     J,,AUTO
         4 013051   000001 035007                    ADLA    1,DL
         4 013052   200102 755100                    STA     J,,AUTO
         4 013053   200102 235100                    LDA     J,,AUTO
         4 013054   000025 115007                    CMPA    21,DL
         4 013055   013027 602000 4                  TNC     s:20224

     2635    20231
     2636    20232                                                      /*
     2637    20233                                                         Compare fe privileges
     2638    20234                                                      */
     2639    20235    4      DO J = 0 TO SIZEW(AS_PRIVILEGE)-1;

  20235  4 013056   200102 450100                    STZ     J,,AUTO
         4 013057   013104 710000 4                  TRA     s:20242+3

     2640    20236    4         TEMP_PRIV = AS_PRIVILEGE(J);

  20236  4 013060   200102 720100                    LXL0    J,,AUTO
         4 013061   000000 236010 xsym               LDQ     AS_PRIVILEGE,X0
         4 013062   200103 756100                    STQ     TEMP_PRIV,,AUTO

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:419  
     2641    20237    4         IF (TEMP_PRIV & FROM_DREC.FROM_BLK.PRIV(I) ) = TEMP_PRIV

  20237  4 013063   200076 470500                    LDP0    @FROM_DREC,,AUTO
         4 013064   200101 721100                    LXL1    I,,AUTO
         4 013065   000032 376111                    ANQ     26,X1,PR0
         4 013066   200103 116100                    CMPQ    TEMP_PRIV,,AUTO
         4 013067   013101 601000 4                  TNZ     s:20242

     2642    20238    4         THEN
     2643    20239    4            IF (TEMP_PRIV & MAX_DREC.MAX_BLK.PRIV(I) ) ~= TEMP_PRIV

  20239  4 013070   200100 471500                    LDP1    @MAX_DREC,,AUTO
         4 013071   200103 236100                    LDQ     TEMP_PRIV,,AUTO
         4 013072   100032 376111                    ANQ     26,X1,PR1
         4 013073   200103 116100                    CMPQ    TEMP_PRIV,,AUTO
         4 013074   013101 600000 4                  TZE     s:20242

     2644    20240    4            THEN
     2645    20241    4               FROM_DREC.FROM_BLK.PRIV(I) = FROM_DREC.FROM_BLK.PRIV(I) & ~(TEMP_PRIV);

  20241  4 013075   200103 236100                    LDQ     TEMP_PRIV,,AUTO
         4 013076   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 013077   000032 376111                    ANQ     26,X1,PR0
         4 013100   000032 756111                    STQ     26,X1,PR0

     2646    20242    4         END;

  20242  4 013101   200102 235100                    LDA     J,,AUTO
         4 013102   000001 035007                    ADLA    1,DL
         4 013103   200102 755100                    STA     J,,AUTO
         4 013104   200102 235100                    LDA     J,,AUTO
         4 013105   000030 115007                    CMPA    24,DL
         4 013106   013060 602000 4                  TNC     s:20236

     2647    20243                                                      /*
     2648    20244                                                         Compare fe pprivileges
     2649    20245                                                      */
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:420  
     2650    20246    4      DO J = 0 TO SIZEW(AS_PPRIVILEGE)-1;

  20246  4 013107   200102 450100                    STZ     J,,AUTO
         4 013110   013135 710000 4                  TRA     s:20253+3

     2651    20247    4         TEMP_PRIV = AS_PPRIVILEGE(J);

  20247  4 013111   200102 720100                    LXL0    J,,AUTO
         4 013112   000000 236010 xsym               LDQ     AS_PPRIVILEGE,X0
         4 013113   200103 756100                    STQ     TEMP_PRIV,,AUTO

     2652    20248    4         IF (TEMP_PRIV & FROM_DREC.FROM_BLK.PPRIV(I) ) = TEMP_PRIV

  20248  4 013114   200076 470500                    LDP0    @FROM_DREC,,AUTO
         4 013115   200101 721100                    LXL1    I,,AUTO
         4 013116   000036 376111                    ANQ     30,X1,PR0
         4 013117   200103 116100                    CMPQ    TEMP_PRIV,,AUTO
         4 013120   013132 601000 4                  TNZ     s:20253

     2653    20249    4         THEN
     2654    20250    4            IF (TEMP_PRIV & MAX_DREC.MAX_BLK.PPRIV(I) ) ~= TEMP_PRIV

  20250  4 013121   200100 471500                    LDP1    @MAX_DREC,,AUTO
         4 013122   200103 236100                    LDQ     TEMP_PRIV,,AUTO
         4 013123   100036 376111                    ANQ     30,X1,PR1
         4 013124   200103 116100                    CMPQ    TEMP_PRIV,,AUTO
         4 013125   013132 600000 4                  TZE     s:20253

     2655    20251    4            THEN
     2656    20252    4              FROM_DREC.FROM_BLK.PPRIV(I) = FROM_DREC.FROM_BLK.PPRIV(I) & ~(TEMP_PRIV)
             20252                        ;

  20252  4 013126   200103 236100                    LDQ     TEMP_PRIV,,AUTO
         4 013127   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 013130   000036 376111                    ANQ     30,X1,PR0
         4 013131   000036 756111                    STQ     30,X1,PR0

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:421  
     2657    20253    4         END;

  20253  4 013132   200102 235100                    LDA     J,,AUTO
         4 013133   000001 035007                    ADLA    1,DL
         4 013134   200102 755100                    STA     J,,AUTO
         4 013135   200102 235100                    LDA     J,,AUTO
         4 013136   000025 115007                    CMPA    21,DL
         4 013137   013111 602000 4                  TNC     s:20247

     2658    20254    3      END;        /* Do i = 0 to 3 */

  20254  4 013140   200101 236100                    LDQ     I,,AUTO
         4 013141   000001 036007                    ADLQ    1,DL
         4 013142   200101 756100                    STQ     I,,AUTO
         4 013143   000004 116007                    CMPQ    4,DL
         4 013144   012577 602000 4                  TNC     s:20108

     2659    20255
     2660    20256    3   DO J = 0 TO 71;

  20256  4 013145   200102 450100                    STZ     J,,AUTO

     2661    20257    3      IF FROM_USERS.KEY(J) AND NOT MAX_USERS.KEY(J) THEN

  20257  4 013146   200075 470500                    LDP0    @FROM_USERS,,AUTO
         4 013147   200102 235100                    LDA     J,,AUTO
         4 013150   000000 066505                    CMPB    filb='1'B
         4 013151   000026 000001                    BDSC    22,A,PR0                 by=0,bit=0,n=1
         4 013152   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 013153   013164 600000 4                  TZE     s:20259
         4 013154   200077 471500                    LDP1    @MAX_USERS,,AUTO
         4 013155   000000 066505                    CMPB    filb='1'B
         4 013156   100026 000001                    BDSC    22,A,PR1                 by=0,bit=0,n=1
         4 013157   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 013160   013164 601000 4                  TNZ     s:20259

     2662    20258    3         FROM_USERS.KEY(J) = AS_FALSE;
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:422  

  20258  4 013161   003105 060400                    CSL     bolr='003'O
         4 013162   000000 000001 xsym               BDSC    AS_FALSE                 by=0,bit=0,n=1
         4 013163   000026 000001                    BDSC    22,A,PR0                 by=0,bit=0,n=1

     2663    20259    3      END;

  20259  4 013164   000001 035007                    ADLA    1,DL
         4 013165   200102 755100                    STA     J,,AUTO
         4 013166   000110 115007                    CMPA    72,DL
         4 013167   013146 602000 4                  TNC     s:20257

     2664    20260
     2665    20261    2   END COMPARE_FROM_TO_MAX;

  20261  4 013170   200074 221300                    LDX1  ! ACCT_COUNT+2,,AUTO
         4 013171   000001 702211                    TSX2  ! 1,X1


PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:423  
     2667    20263    1   END   ASA$SUPER ;

  20263  4 013172   000000 702200 xent               TSX2  ! X66_MARET

PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:424  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$SUPER.
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:425  

 **** Variables and constants ****

  ****  Section 002  Data  ASA$SUPER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/d STRC(216)   r     1 FPT_EXIT                  10-0-0/d STRC(144)   r     1 FPT_PRIV
   160-0-0/d STRC(144)   r     1 INTFPT                     0-0-0/b BIT         r     1 MORE
    66-0-0/d STRC(2088)  r     1 OPEN_LO_FPT              201-0-0/c CHAR(22)    r     1 PART1
   265-0-0/c CHAR(41)    r     1 PART10                   207-0-0/c CHAR(29)    r     1 PART2
   217-0-0/c CHAR(18)    r     1 PART3                    224-0-0/c CHAR(41)    r     1 PART4
   237-0-0/c CHAR(42)    r     1 PART5                    252-0-0/c CHAR(11)    r     1 PART6
   255-0-0/c CHAR(8)     r     1 PART7                    257-0-0/c CHAR(20)    r     1 PART8
   264-0-0/c CHAR(4)     r     1 PART9                    171-0-0/c CHAR(30)    r     1 RECON_PROMPT
   164-0-0/c CHAR(12)    r     1 REM_STA                  167-0-0/c CHAR(8)     r     1 REM_WSN
    14-0-0/d STRC(1512)  r     1 XUG_GETCMD

  ****  Section 003 RoData ASA$SUPER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 SIZEC_DREC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    51-0-0/w PTR         r     1 @CODE                     75-0-0/w PTR         r     1 @FACCT_INX
    76-0-0/w PTR         r     1 @FROM_DREC                75-0-0/w PTR         r     1 @FROM_USERS
   100-0-0/w PTR         r     1 @MAX_DREC                 77-0-0/w PTR         r     1 @MAX_USERS
    75-0-0/w PTR         r     1 @NODE                    114-0-0/w PTR         r     1 @PACKSET
   115-0-0/w PTR         r     1 @PROJ$                    75-0-0/w PTR         r     1 @PROJECT
   113-0-0/w PTR         r     1 @PROJECT                  51-0-0/w PTR         r     1 @PROJ_FLAG
   101-0-0/w UBIN        r     1 ACCTS                     72-0-0/w SBIN        r     1 ACCT_COUNT
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:426  
   110-0-0/b BIT         r     1 ACCT_IN_PROJ              75-0-0/b BIT         r     1 ALTRET_FLG
   111-0-0/b BIT         r     1 ALTRET_FLG                 3-0-0/w SBIN        r     1 ARS
     7-0-0/w PTR         r     1 BLK$                      32-0-0/w UBIN        r     1 CNT
    *0-0-0/w UBIN        r     1 CODE                      70-0-0/w UBIN        r     1 COUNT
    65-0-0/w UBIN        r     1 COUNT                     65-0-0/b BIT         r     1 CREATE
    51-0-0/c STRC(198)   r     1 CR_MOD_KEY                35-0-0/b BIT         r     1 DELETE_FLAG
    36-0-0/c CHAR(29)    r     1 DELETE_PROMPT             76-0-0/w STRC(189)   r     1 DEST_PROJ
   102-0-0/w STRC(198)   r     1 DEST_PROJ                 70-0-0/b BIT         r     1 FACCOUNT_OPT
    *0-0-0/w UBIN        r     1 FACCT_INX                 46-0-0/w UBIN        r     1 FREE_SEG_SIZE
    47-0-0/w UBIN        r     1 FREE_SEG_TYPE             *0-0-0/w STRC(6084)  r     1 FROM_DREC
    *0-0-0/w STRC(18576) r     1 FROM_USERS               100-0-0/w UBIN        r     1 GRANS
    24-0-0/w UBIN        r     1 I                         57-0-0/w SBIN        r     1 I
   116-0-0/w SBIN        r     1 I                        101-0-0/w UBIN        r     1 I
    60-0-0/w SBIN        r     1 J                        102-0-0/w UBIN        r     1 J
    61-0-0/w SBIN        r     1 K                         52-0-0/c STRC(378)   r     1 KEY
    51-0-0/c CHAR(80)    r     1 LINE                      *0-0-0/w STRC(6084)  r     1 MAX_DREC
    *0-0-0/w STRC(18576) r     1 MAX_USERS                 *0-0-0/w UBIN        r     1 NODE
    76-0-0/c CHAR(6)     r     1 PACKSET                   *0-0-0/c CHAR(6)     r     1 PACKSET
    71-0-0/w SBIN        r     1 PACKSET_COUNT             63-0-0/w PTR         r     1 PAR$
    66-0-0/w PTR         r     1 PAR$                      *0-0-0/w PTR         r     1 PROJ$
    *0-0-0/w STRC(189)   r     1 PROJECT                   *0-0-0/w STRC(189)   r     1 PROJECT
    64-0-0/w PTR         r     1 PROJ_ACCT_LIST$           52-0-0/c STRC(189)   r     1 PROJ_ADMIN_KEY
    66-0-0/w BIT         r     1 PROJ_FLAG                 *0-0-0/w BIT         r     1 PROJ_FLAG
    62-0-0/w PTR         r     1 PTR$                     103-0-0/b BIT         r     1 TEMP_PRIV
    67-0-0/w UBIN        r     1 TYPE                      67-0-0/w UBIN        r     1 TYPE
    34-0-0/b STRC        r     1 T_ERR_CODE                75-0-0/w UBIN        r     1 WSN_INDEX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d REMB        r     1 ASA_BRKS_LOC               0-0-0/d BIT (72)    r     1 ASA_BRKS_LOC_BIT
     0-0-0/c CHAR        r     1 AS_BLANK
     0-0-0/w STRC(432)   r     1 AS_CONSTANT_PROJ_HEADER
     0-0-0/w SBIN        r     1 AS_CR_MOD_PROJ             0-0-0/w STRC(18576) r     1 AS_DEFAULT
     0-0-0/w STRC(6084)  r     1 AS_DEFAULT_DREC            0-0-0/w PTR         r     1 AS_DEFAULT_DREC$
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:427  
     0-0-0/w STRC(18576) r     1 AS_DFLT                    0-0-0/b BIT         r     1 AS_FALSE
     0-0-0/w PTR         r     1 AS_FEPSEUDO_LIST$          0-0-0/w PTR         r     1 AS_FERESOURCE_LIST$
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/w STRC(369)   r     1 AS_FIELD3                  0-0-0/c STRC(189)   r     1 AS_LOGON_KEY
     0-0-0/w STRC(1483)  r     1 AS_MOD_USER                0-0-0/c STRC(189)   r     1 AS_NONE
     0-0-0/w BIT         r     1 AS_PPRIVILEGE(0:20)
     0-0-0/w BIT         r     1 AS_PRIVILEGE(0:23)
     0-0-0/w STRC(18576) r     1 AS_PROJECT                 0-0-0/c STRC(189)   r     1 AS_PROJECT_ADMIN
     0-0-0/w STRC(18576) r     1 AS_PROJECT_DFLT            0-0-0/w STRC(6084)  r     1 AS_PROJECT_DFLT_DREC
     0-0-0/w PTR         r     1 AS_PROJECT_DFLT_DREC$
     0-0-0/w STRC(6084)  r     1 AS_PROJECT_DREC            0-0-0/w PTR         r     1 AS_PROJECT_DREC$
     0-0-0/w STRC(18576) r     1 AS_PROJ_ADMIN              0-0-0/w STRC(6084)  r     1 AS_PROJ_ADMIN_DREC
     0-0-0/w PTR         r     1 AS_PROJ_ADMIN_DREC$        0-0-0/w PTR         r     1 AS_PROJ_HEADER$
     0-0-0/w PTR         r     1 AS_PSEUDO_LIST$            0-0-0/w PTR         r     1 AS_RESOURCE_LIST$
     0-0-0/w PTR         r     1 AS_SUPER_TO_PIG$           0-0-0/b BIT         r     1 AS_TRUE
     0-0-0/w STRC(18576) r     1 AS_USERS                   0-0-0/w STRC(18576) r     1 AS_USERS_CONSTANT
     0-0-0/w SBIN        r     1 AS_WILD_MCH                0-0-0/b BIT         r     1 AS_WILD_USER
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/c CHAR(8)     r     1 BLANK_PASS
     0-0-0/w STRC(63)    r     1 B_VERSION                  0-0-0/w UBIN        r     1 CMD_NODES
     0-0-0/w UBIN        r     1 CODE                       0-0-0/w UBIN        r     1 CR_MOD_CMD
     0-0-0/b BIT         r     1 CR_MOD_FLG                 0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w UBIN        r     1 DSEG1SIZE                  0-0-0/w PTR         r     1 DSEG2$
     0-0-0/w UBIN        r     1 DSEG2SIZE                  0-0-0/w PTR         r     1 DSEG3$
     0-0-0/w UBIN        r     1 DSEG3SIZE                  0-0-0/b BIT         r     1 DSEG_FLG
     0-0-0/b BIT         r     1 ENQDEQ_FLG                 0-0-0/w UBIN        r     1 ERR_CNT
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/b BIT         r     1 FROM_FLG
     0-0-0/c STRC(189)   r     1 FROM_KEY                   0-0-0/c CHAR(255)   r     1 IN_BUF
     0-0-0/w STRC(3276)  r     1 KL_DEFAULT                 0-0-0/w STRC(6084)  r     1 KL_DFLT
     0-0-0/w PTR         r     1 KL_DFLT$                   0-0-0/w STRC(6084)  r     1 KL_DREC
     0-0-0/w PTR         r     1 KL_DREC$                   0-0-0/w STRC(576)   r     1 KL_DREC_CNT
     0-0-0/w UBIN        r     1 LO_WIDTH                   0-0-0/b STRC        r     1 MERR_CODE
     0-0-0/w PTR         r     1 NODE$                      0-0-0/c CHAR(140)   r     1 OUT_BUF
     0-0-0/b BIT         r     1 PADMIN                     0-0-0/c STRC(243)   r     1 PROJ_KEY
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/d REMB        r     1 REMEM_VAR
     0-0-0/b BIT         r     1 SUPERAUTH                  0-0-0/b BIT         r     1 SUPERD
     0-0-0/b BIT         r     1 SUPERFORM                  0-0-0/b BIT         r     1 SUPERWSN
     0-0-0/c STRC(378)   r     1 USERS_KEY                  0-0-0/w UBIN        r     1 WARN_CNT
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:428  

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ACCT$LIST(0:0)
     0-0-0/w ASTR(468)   r     1 AS$PROJ                    0-0-0/w STRC(432)   r     1 AS$PROJ_HEADER
     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$LO                       0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 P$NODE
     0-0-0/w STRC(504)   r     1 PACKSET$LIST(0:0)
     0-0-0/w STRC(108)   r     1 PROJ$LIST(0:0)
     0-0-0/w ASTR(522)   r     1 SUPER_TO_PIG               0-0-0/w UBIN        r     1 UBIN$WORD


   Procedure ASA$SUPER requires 5755 words for executable code.
   Procedure ASA$SUPER requires 86 words of local(AUTO) storage.
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:429  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:430  
          MINI XREF LISTING

ACCT$LIST IN PROCEDURE CREATE_MOD_USER
     17246**DCL     18726<<ASSIGN  18736>>DOWHILE 18736>>DOWHILE 18739>>IF      18739>>IF      18741<<ASSIGN
     18741>>ASSIGN  18743<<ASSIGN  18743>>ASSIGN
ACCT$LIST.ACCT IN PROCEDURE CREATE_MOD_USER
     17248**DCL     17766>>ASSIGN  17983<<ASSIGN  18719<<ASSIGN  18729<<ASSIGN  18733<<ASSIGN  18773<>CALL
     18779>>DOWHILE 18782>>IF      18793>>ASSIGN  18821>>DOWHILE 18825>>IF      18828<>CALL
ACCT$LIST.GRANS IN PROCEDURE CREATE_MOD_USER
     17249**DCL     17767>>ASSIGN  17769>>ASSIGN  17984<<ASSIGN  18773<>CALL    18784<<ASSIGN  18829>>ASSIGN
ACCT$LIST.PSN IN PROCEDURE CREATE_MOD_USER
     17247**DCL     17760>>ASSIGN  17765>>DOWHILE 17982<<ASSIGN  18718<<ASSIGN  18728<<ASSIGN  18732<<ASSIGN
     18758>>ASSIGN  18770>>DOWHILE 18773<>CALL    18790>>ASSIGN  18891>>DOWHILE
ACCTS IN PROCEDURE GET_ACCT_LIST
     18704**DCL     18762<<ASSIGN  18830<<ASSIGN  18830>>ASSIGN  18864>>IF
ACCT_COUNT IN PROCEDURE CREATE_MOD_USER
     17142**DCL     17712<>CALL    17757>>IF      17759>>DOWHILE 17765>>DOWHILE 17975<<ASSIGN  17982>>ASSIGN
     17983>>ASSIGN  17984>>ASSIGN  17985<<ASSIGN  17985>>ASSIGN  17992<>CALL    18056<>CALL    18058<>CALL
     18063>>IF      18224<>CALL    18226<>CALL    18227>>IF      18712<<ASSIGN  18720<<ASSIGN  18726>>ASSIGN
     18728>>ASSIGN  18729>>ASSIGN  18732>>ASSIGN  18733>>ASSIGN  18736>>DOWHILE 18736>>DOWHILE 18739>>IF
     18740>>DOINDEX 18743>>ASSIGN  18744<<ASSIGN  18744>>ASSIGN  18757>>DOWHILE 18770>>DOWHILE 18891>>DOWHILE
     18899>>IF
ACCT_IN_PROJ IN PROCEDURE GET_ACCT_LIST
     18708**DCL     18767<<ASSIGN  18769<<ASSIGN  18771>>IF
ALT IN PROCEDURE GET_FIRST
     18584**LABEL   18573--CALLALT
ALT IN PROCEDURE GET_PACKSET_LIST
     18670**LABEL   18621--CALLALT 18623--CALLALT
ALT IN PROCEDURE READ_PROJ_REC
     18932**LABEL   18924--CALLALT 18928--CALLALT
ALTRET_FLG IN PROCEDURE GET_ACCT_LIST
     18709**DCL     18714<<ASSIGN  18812<<ASSIGN  18833<<ASSIGN  18862<<ASSIGN  18887<<ASSIGN  18894<<ASSIGN
     18898>>IF
ALTRET_FLG IN PROCEDURE GET_PACKSET_LIST
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:431  
     18594**DCL     18619<<ASSIGN  18646<<ASSIGN  18670<<ASSIGN  18673>>IF
ARS
     15855**DCL     16312<>CALL    16313>>ASSIGN  16893<<ASSIGN  16894<>CALL    16934<<ASSIGN  16935<>CALL
     17360<<ASSIGN  17361<>CALL    17417<<ASSIGN  17418<>CALL    17429<<ASSIGN  17430<>CALL    17636<<ASSIGN
     17637<>CALL    17647<<ASSIGN  17648<>CALL    17774<<ASSIGN  17775<>CALL    17785<<ASSIGN  17786<>CALL
     17976<<ASSIGN  17977<>CALL    17987<<ASSIGN  17988<>CALL    18131<>CALL    18136<>CALL    18293<>CALL
     18295<>CALL    18378<<ASSIGN  18379<>CALL    18385<<ASSIGN  18386<>CALL    18602<<ASSIGN  18604<>CALL
     18610<<ASSIGN  18611<>CALL
AS$PROJ.ATTRIBUTES IN PROCEDURE CREATE_MOD_USER
     17208**DCL     17979--ASSIGN  18776--ASSIGN  18818--ASSIGN
AS$PROJ.ATTRIBUTES.COUNT IN PROCEDURE CREATE_MOD_USER
     17209**DCL     17210--IMP-SIZ 17754<<ASSIGN  17979>>ASSIGN  18776>>ASSIGN  18818>>ASSIGN
AS$PROJ.CREATOR IN PROCEDURE CREATE_MOD_USER
     17191**DCL     17756<<ASSIGN  18133<<ASSIGN  18135<<ASSIGN  18294<<ASSIGN
AS$PROJ.GRANS_ACCUM IN PROCEDURE CREATE_MOD_USER
     17200**DCL     17764<<ASSIGN  17769<<ASSIGN  17769>>ASSIGN  17773>>ASSIGN  18625>>IF      18839>>IF
AS$PROJ.MAX_NUM_ACCTS IN PROCEDURE CREATE_MOD_USER
     17204**DCL     17772<<ASSIGN  18648>>IF      18864>>IF
AS$PROJ.MAX_NUM_GRANS IN PROCEDURE CREATE_MOD_USER
     17198**DCL     17773<<ASSIGN  18625>>IF      18839>>IF
AS$PROJ.NUM_ACCTS IN PROCEDURE CREATE_MOD_USER
     17206**DCL     17763<<ASSIGN  17766>>ASSIGN  17767>>ASSIGN  17768<<ASSIGN  17768>>ASSIGN  17772>>ASSIGN
     17774>>ASSIGN  17981>>DOINDEX 18648>>IF      18779>>DOWHILE 18782>>IF      18821>>DOWHILE 18825>>IF
     18864>>IF
AS$PROJ.SUB_PROJ_ACCTS IN PROCEDURE CREATE_MOD_USER
     17196**DCL     18648>>IF      18864>>IF
AS$PROJ_HEADER IN PROCEDURE CREATE_MOD_USER
     17222**DCL     17753<<ASSIGN  17755--ASSIGN
ASA$B_USERS_HLP
     15527**DCL-ENT 16211--CALL
ASA$CONSOLE
     15533**DCL-ENT 16675--CALL
ASA$DEVICE
     15542**DCL-ENT 16678--CALL
ASA$ERROR
     15563**DCL-ENT 18043--CALL    18100--CALL    18390--CALL    18391--CALL    19239--CALL    19306--CALL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:432  
ASA$KEYCONV
     15548**DCL-ENT 17374--CALL    17663--CALL    17735--CALL    17857--CALL    17912--CALL    17955--CALL
     18024--CALL    18081--CALL    18161--CALL    18162--CALL    18198--CALL    18199--CALL    18245--CALL
     18246--CALL    18405--CALL    18429--CALL    18486--CALL    18546--CALL    18628--CALL    18652--CALL
     18796--CALL    18844--CALL    18869--CALL    18936--CALL
ASA$LINE_CONTROLLER
     15569**DCL-ENT 16705--CALL
ASA$LINK_VIRCIR
     15566**DCL-ENT 16696--CALL
ASA$PROJECT
     15545**DCL-ENT 17622--CALL
ASA$STATION
     15539**DCL-ENT 16672--CALL
ASA$TERMINAL
     15536**DCL-ENT 16669--CALL
ASA$TIE_PROJECT
     15560**DCL-ENT 17794--CALL    18114--CALL    18288--CALL
ASA$TIE_USER
     15557**DCL-ENT 17992--CALL    18058--CALL    18226--CALL
ASA$UNTIE_PROJECT
     15554**DCL-ENT 17937--CALL    18112--CALL    18278--CALL
ASA$UNTIE_USER
     15551**DCL-ENT 17712--CALL    18056--CALL    18224--CALL
ASA_BRKS_LOC
     11886**DCL     11886--REDEF
ASA_BRKS_LOC_BIT
     11886**DCL     16297<<ASSIGN  16630<<ASSIGN
ASB$ACCT_OK
     15572**DCL-ENT 17351--CALL    17627--CALL    18219--CALL    18623--CALL    18828--CALL
ASB$BINCHAR
      1150**DCL-ENT 16868--CALL    16909--CALL    17469--CALL    18464--CALL    19066--CALL
ASB$BINXCHAR
      1151**DCL-ENT 17837--CALL    17892--CALL    18526--CALL
ASB$BREAK
     15575**DCL-ENT 15846--DCLINIT
ASB$CLOSE_HLP
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:433  
     15578**DCL-ENT 16851--CALL    17084--CALL
ASB$CLOSE_LO
     15581**DCL-ENT 16322--CALL    16944--CALL
ASB$CLOSE_PROJ
     15584**DCL-ENT 16238--CALL
ASB$CLOSE_USERS
     15587**DCL-ENT 16850--CALL
ASB$DELREC_PROJ
     15590**DCL-ENT 18003--CALL
ASB$DELREC_USERS
     15593**DCL-ENT 17941--CALL    17997--CALL    18285--CALL
ASB$DEQ
     15596**DCL-ENT 16305--CALL
ASB$DEQ_PROJ
     15602**DCL-ENT 18063--CALL    18141--CALL    18227--CALL    18300--CALL    18674--CALL    18899--CALL
ASB$ENQ_PROJ
     15611**DCL-ENT 18606--CALL    18920--CALL
ASB$ENQ_USERS
     15614**DCL-ENT 19130--CALL    19146--CALL
ASB$FLUSH
     15620**DCL-ENT 17460--CALL    19036--CALL
ASB$FREE_SEG
     15623**DCL-ENT 16807--CALL    16812--CALL    16817--CALL
ASB$GET
     15626**DCL-ENT 17266--CALL    17280--CALL    17298--CALL    17319--CALL    17525--CALL    17541--CALL
     17555--CALL    17599--CALL    17698--CALL    17706--CALL    17810--CALL    17818--CALL    18017--CALL
     18049--CALL    18055--CALL    18074--CALL    18105--CALL    18111--CALL    18153--CALL    18182--CALL
     18223--CALL    18237--CALL    18266--CALL    18277--CALL    19005--CALL    19013--CALL
ASB$GETSEG
     15635**DCL-ENT 18327--CALL
ASB$GET_MGRANS
     15629**DCL-ENT 18773--CALL
ASB$GET_NEXT
     15632**DCL-ENT 17403--CALL    18573--CALL    19022--CALL
ASB$INIT_GET_NEXT
     15638**DCL-ENT 18571--CALL    19020--CALL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:434  
ASB$KEYMAKER
     15641**DCL-ENT 17270--CALL    17289--CALL    17531--CALL    17550--CALL    17703--CALL    17815--CALL
     18015--CALL    18072--CALL    18151--CALL    18156--CALL    18235--CALL    18240--CALL    18999--CALL
     19224--CALL
ASB$LIST
     15644**DCL-ENT 17404--CALL    18578--CALL
ASB$OPEN_COMGROUP
     15647**DCL-ENT 16280--CALL
ASB$OPEN_HLP_UP
     15650**DCL-ENT 16137--CALL    16148--CALL    16277--CALL    17112--CALL
ASB$OPEN_PROJ_CR
     15653**DCL-ENT 16237--CALL
ASB$OPEN_PROJ_UP
     15656**DCL-ENT 16235--CALL    16279--CALL
ASB$OPEN_SI_LO_DO
     15659**DCL-ENT 16074--CALL
ASB$OPEN_USERS_UP
     15662**DCL-ENT 16134--CALL    16276--CALL
ASB$PIG
     15665**DCL-ENT 19163--CALL
ASB$PREC_PROJ
     15668**DCL-ENT 17974--CALL    18129--CALL    18189--CALL    18291--CALL    18601--CALL
ASB$READ_HLP
     15671**DCL-ENT 18379--CALL    18386--CALL
ASB$READ_PROJ
     15674**DCL-ENT 18924--CALL    18928--CALL
ASB$READ_PROJ_SEQ
     15677**DCL-ENT 17977--CALL    17988--CALL    18131--CALL    18293--CALL    18604--CALL    18611--CALL
ASB$READ_SI
     15680**DCL-ENT 16312--CALL    16581--CALL    17052--CALL
ASB$READ_USERS
     15683**DCL-ENT 18377--CALL    18384--CALL    19131--CALL    19147--CALL    19236--CALL    19253--CALL
ASB$SET_PROMPT
     15530**DCL-ENT 16311--CALL    16580--CALL    16590--CALL    17051--CALL    17059--CALL    17062--CALL
ASB$WRITE_HLP
     15686**DCL-ENT 17361--CALL    17418--CALL    17430--CALL    17637--CALL    17648--CALL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:435  
ASB$WRITE_LO
     15689**DCL-ENT 16287--CALL    16289--CALL    16290--CALL    16586--CALL    16855--CALL    16856--CALL
     16858--CALL    16894--CALL    16897--CALL    16899--CALL    16935--CALL    16937--CALL    17046--CALL
     17048--CALL    17049--CALL    17058--CALL    17113--CALL    17115--CALL    17117--CALL    19299--CALL
     19300--CALL
ASB$WRITE_PROJ
     15692**DCL-ENT 17775--CALL    17786--CALL    18136--CALL    18295--CALL
ASB$WRITE_USERS
     15695**DCL-ENT 17353--CALL    17367--CALL    17410--CALL    17422--CALL    17629--CALL    17640--CALL
     17685--CALL    18061--CALL    18117--CALL    18120--CALL    19133--CALL    19153--CALL
ASB$WRITE_USERS_KEY
     15698**DCL-ENT 17396--CALL    17655--CALL    17730--CALL    18125--CALL
ASC$BUILD_CHARSET
     15701**DCL-ENT 16225--CALL
ASC$CHARSET
     15704**DCL-ENT 16729--CALL
ASC$CHECK_TIGR_WSN
     15707**DCL-ENT 17018--CALL
ASC$CM_OPTS
     15710**DCL-ENT 17346--CALL
ASC$CONFIG
     15713**DCL-ENT 16247--CALL    17088--CALL
ASC$MOD_USER
     15716**DCL-ENT 17421--CALL
ASD$CLOSE_PRO
     15719**DCL-ENT 16852--CALL
ASD$CREATE_PRO
     15722**DCL-ENT 16217--CALL
ASD$OPEN_PRO_UP
     15725**DCL-ENT 16214--CALL    16278--CALL
ASD$PROFILE
     15728**DCL-ENT 16666--CALL
ASF$BUILD_FORM
     15734**DCL-ENT 16226--CALL
ASF$FORM
     15737**DCL-ENT 16681--CALL    16684--CALL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:436  
ASF$OPEN_FORM_CR
     15740**DCL-ENT 16222--CALL
ASF$OPEN_FORM_UP
     15743**DCL-ENT 16220--CALL
ASH$DQUEST
     15746**DCL-ENT 16747--CALL
ASH$ERROR
     15749**DCL-ENT 16125--CALL    16145--CALL    16182--CALL    16266--CALL    16346--CALL    16369--CALL
     16390--CALL    16413--CALL    16433--CALL    16478--CALL    16507--CALL    16532--CALL    16611--CALL
     16796--CALL    16838--CALL    16847--CALL    17013--CALL    17039--CALL    17104--CALL    17452--CALL
     17777--CALL    17788--CALL    17870--CALL    17925--CALL    18037--CALL    18094--CALL    18138--CALL
     18175--CALL    18212--CALL    18259--CALL    18297--CALL    18319--CALL    18341--CALL    18418--CALL
     18442--CALL    18499--CALL    18559--CALL    18643--CALL    18667--CALL    18809--CALL    18859--CALL
     18884--CALL    18949--CALL    18954--CALL    19053--CALL    19278--CALL    19328--CALL    19332--CALL
ASH$HELP
     15752**DCL-ENT 16744--CALL
ASH$INFO
     15755**DCL-ENT 17499--CALL    17744--CALL    17964--CALL    19100--CALL    19120--CALL
ASH$QUEST
     15758**DCL-ENT 16750--CALL
ASH$U_PARSE
     15761**DCL-ENT 16242--ASSIGN
ASH$WARN
     15764**DCL-ENT 16169--CALL    16202--CALL    16771--CALL    17385--CALL    17674--CALL
ASL$LIST
     15767**DCL-ENT 16629--CALL
ASR$D_CHARSET_RECS
     15770**DCL-ENT 16735--CALL
ASR$D_FORM_RECS
     15773**DCL-ENT 16651--CALL
ASR$D_USERS_RECS
     15776**DCL-ENT 16690--CALL
ASR$R_CHARSET
     15782**DCL-ENT 16732--CALL
ASR$R_CONSOLE
     15785**DCL-ENT 16639--CALL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:437  
ASR$R_DEVICE
     15779**DCL-ENT 16642--CALL
ASR$R_FORM
     15788**DCL-ENT 16648--CALL
ASR$R_LINE_CONT
     15791**DCL-ENT 16708--CALL
ASR$R_LINK_VIRCIR
     15794**DCL-ENT 16702--CALL
ASR$R_PROFILE
     15797**DCL-ENT 16657--CALL
ASR$R_PROJECT
     15800**DCL-ENT 19009--CALL    19025--CALL
ASR$R_STATION
     15806**DCL-ENT 16636--CALL
ASR$R_STAT_TIGR
     15803**DCL-ENT 17071--CALL
ASR$R_TERMINAL
     15809**DCL-ENT 16633--CALL
ASR$R_TPDEVICE
     15812**DCL-ENT 16645--CALL
ASR$R_USER
     15815**DCL-ENT 19014--CALL    19029--CALL
ASR$R_WSN
     15818**DCL-ENT 16654--CALL    17080--CALL
ASW$BUILD_WSN
     15824**DCL-ENT 16231--CALL
ASW$OPEN_WSN_UP
     15827**DCL-ENT 16229--CALL    16232--CALL
ASW$WSN
     15821**DCL-ENT 16687--CALL
ASZ$SCRAMBLE
     15830**DCL-ENT 16282--CALL
AS_BLANK
     11746**DCL     16287<>CALL    16290<>CALL    16855<>CALL    16937<>CALL    17761>>CALLBLT 17783>>CALLBLT
     18001>>CALLBLT 18133>>ASSIGN  18187>>CALLBLT 18791>>CALLBLT 18794>>CALLBLT 18918>>CALLBLT 19294>>CALLBLT
     19300<>CALL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:438  
AS_CONSTANT_PROJ_HEADER
     14719**DCL     17753>>ASSIGN
AS_CR_MOD_PROJ
     11894**DCL     17259<<ASSIGN  17262<<ASSIGN  17292>>IF      17304>>IF      17325>>IF      17350>>IF
     17362>>IF      17520<<ASSIGN  17522<<ASSIGN  17573>>IF      17607>>IF      17626>>IF      17656>>IF
     17682>>IF      17694<<ASSIGN  17696<<ASSIGN  17806<<ASSIGN  17808<<ASSIGN  18356>>ASSIGN
AS_DEFAULT
     12464**DCL     17525<>CALL    17574>>ASSIGN  17585>>ASSIGN  17609<>CALL    17685<>CALL    17698<>CALL
     17810<>CALL    17931>>ASSIGN  17990>>ASSIGN  18055<>CALL    18105<>CALL    18111<>CALL    18223<>CALL
     18266<>CALL    18275>>ASSIGN  18277<>CALL    18280<<ASSIGN
AS_DEFAULT.BANNER_PERM
     12579**DCL     12580--REDEF
AS_DEFAULT.BUDGET.MACCT
     12484**DCL     12488--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12497**DCL     12500--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12480**DCL     12482--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12475**DCL     12477--REDEF
AS_DEFAULT.BUDGET.PROJ_ALLOWED
     12477**DCL     18423>>IF
AS_DEFAULT.BUDGET.PROJ_CREATED
     12482**DCL     18423>>IF
AS_DEFAULT.BUDGET.SUB_PROJS
     12500**DCL     17657>>IF      18399>>IF      18448>>IF      18506<<ASSIGN  18506>>ASSIGN
AS_DEFAULT.SETUP_CHRA.TXT
     12595**DCL     12596--REDEF   12597--REDEF
AS_DEFAULT_DREC
     13791**DCL     17590>>ASSIGN  17609<>CALL    17991>>ASSIGN
AS_DEFAULT_DREC.PASSWORD
     13849**DCL     13853--REDEF
AS_DEFAULT_DREC.RENAME
     13872**DCL     13873--REDEF
AS_DEFAULT_DREC$
     11755**DCL     17525<>CALL    17698<>CALL    17810<>CALL    18266<>CALL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:439  
AS_DFLT
     12286**DCL     17266<>CALL    17294>>ASSIGN  17306>>ASSIGN  17326<>CALL    17367<>CALL    17400<<ASSIGN
     17410<>CALL    17931<<ASSIGN  17990<<ASSIGN  18049<>CALL    18182<>CALL    18275<<ASSIGN  18280>>ASSIGN
AS_DFLT.ACCT
     12287**DCL     17407<<ASSIGN
AS_DFLT.BANNER_PERM
     12401**DCL     12402--REDEF
AS_DFLT.BUDGET.MACCT
     12306**DCL     12310--REDEF   17409<<ASSIGN
AS_DFLT.BUDGET.MAXC
     12295**DCL     17399>>ASSIGN
AS_DFLT.BUDGET.MAX_PROJECTS
     12319**DCL     12322--REDEF
AS_DFLT.BUDGET.PACCUM
     12302**DCL     12304--REDEF
AS_DFLT.BUDGET.PMAXC
     12297**DCL     12299--REDEF
AS_DFLT.BUDGET.PROJ_ALLOWED
     12299**DCL     17368>>IF      18509>>IF
AS_DFLT.BUDGET.PROJ_CREATED
     12304**DCL     17364<<ASSIGN  17364>>ASSIGN  17368>>IF      18509>>IF      18526<>CALL
AS_DFLT.NAME
     12288**DCL     17408<<ASSIGN
AS_DFLT.SETUP_CHRA.TXT
     12417**DCL     12418--REDEF   12419--REDEF
AS_FALSE
     11746**DCL     16300>>ASSIGN  16307>>ASSIGN  16573>>ASSIGN  16660<>CALL    16681<>CALL    16741>>ASSIGN
     17256>>ASSIGN  17266<>CALL    17351<>CALL    17627<>CALL    17703<>CALL    17706<>CALL    17794<>CALL
     17992<>CALL    18015<>CALL    18017<>CALL    18043<>CALL    18049<>CALL    18058<>CALL    18114<>CALL
     18151<>CALL    18153<>CALL    18182<>CALL    19304>>DOWHILE 19307>>DOWHILE 20055>>ASSIGN  20056>>ASSIGN
     20060>>ASSIGN  20063>>ASSIGN  20066>>ASSIGN  20069>>ASSIGN  20090>>ASSIGN  20258>>ASSIGN
AS_FEPSEUDO_LIST$
     11892**DCL     18350<<ASSIGN  18577>>ASSIGN
AS_FERESOURCE_LIST$
     11892**DCL     18348<<ASSIGN  18576>>ASSIGN
AS_FE_MODE
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:440  
     11752**DCL     11753--REDEF
AS_FIELD1
     11882**DCL     17374<>CALL    17663<>CALL    17735<>CALL    17955<>CALL    18024<>CALL    18081<>CALL
     18161<>CALL    18245<>CALL    18405<>CALL    18429<>CALL    18628<>CALL    18652<>CALL    18844<>CALL
     18869<>CALL    19315<<ASSIGN
AS_FIELD1.COUNT
     11883**DCL     16545<<ASSIGN  16549<<ASSIGN  16553<<ASSIGN  16557<<ASSIGN  16561<<ASSIGN  16565<<ASSIGN
     16569<<ASSIGN  16578>>CALLBLT 16580>>CALL    16890>>CALLBLT 16893>>ASSIGN  16931>>CALLBLT 16934>>ASSIGN
     17025<<ASSIGN  17090<<ASSIGN  18196<<ASSIGN  18792<<ASSIGN  18934<<ASSIGN  19265<<ASSIGN
AS_FIELD1.TEXT
     11883**DCL     16546<<ASSIGN  16550<<ASSIGN  16554<<ASSIGN  16558<<ASSIGN  16562<<ASSIGN  16566<<ASSIGN
     16570<<ASSIGN  16578>>CALLBLT 16868<>CALL    16890>>CALLBLT 16909<>CALL    16931>>CALLBLT 17026<<ASSIGN
     17091<<ASSIGN  17469<>CALL    17837<>CALL    17892<>CALL    18197<<ASSIGN  18464<>CALL    18526<>CALL
     18790<<ASSIGN  18791>>CALLBLT 18935<<ASSIGN  19066<>CALL    19263<<CALLBLT
AS_FIELD2
     11883**DCL     17857<>CALL    17912<>CALL    18162<>CALL    18198<>CALL    18246<>CALL    18486<>CALL
     18546<>CALL    18936<>CALL
AS_FIELD2.COUNT
     11883**DCL     18629<<ASSIGN  18653<<ASSIGN  18795<<ASSIGN  18845<<ASSIGN  18870<<ASSIGN
AS_FIELD2.TEXT
     11883**DCL     18630<<ASSIGN  18654<<ASSIGN  18793<<ASSIGN  18794>>CALLBLT 18846<<ASSIGN  18871<<ASSIGN
AS_FIELD3
     11883**DCL     18199<>CALL    18796<>CALL
AS_LOGON_KEY
     11890**DCL     19216>>ASSIGN  19220>>ASSIGN  19242>>IF      19250>>DOWHILE
AS_LOGON_KEY.CNT
     11890**DCL     16077<<ASSIGN
AS_LOGON_KEY.TEXT
     11891**DCL     16075<<CALLBLT 18357>>ASSIGN  19158>>ASSIGN
AS_MODE
     11749**DCL     11751--REDEF
AS_MOD_USER
     14589**DCL     17345<<ASSIGN
AS_MOD_USER.ACCESS
     14614**DCL     14615--REDEF
AS_MOD_USER.BANNER
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:441  
     14601**DCL     14602--REDEF
AS_MOD_USER.BANNER_PERM
     14603**DCL     14604--REDEF
AS_MOD_USER.BILL
     14609**DCL     14610--REDEF
AS_MOD_USER.CPROC
     14605**DCL     14606--REDEF
AS_MOD_USER.FEBILL
     14685**DCL     14686--REDEF
AS_MOD_USER.FECXTMEM
     14702**DCL     14703--REDEF
AS_MOD_USER.FEMINTS
     14687**DCL     14688--REDEF
AS_MOD_USER.FEMMEM
     14698**DCL     14699--REDEF
AS_MOD_USER.FEMTIME
     14696**DCL     14697--REDEF
AS_MOD_USER.FEPPRIV
     14693**DCL     14695--REDEF
AS_MOD_USER.FEPRIV
     14690**DCL     14692--REDEF
AS_MOD_USER.FORCE_BIT
     14599**DCL     14600--REDEF
AS_MOD_USER.KEY
     14681**DCL     14683--REDEF
AS_MOD_USER.LASTCPROC
     14607**DCL     14608--REDEF
AS_MOD_USER.LIMITS.DO_
     14655**DCL     14656--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14671**DCL     14672--REDEF
AS_MOD_USER.LIMITS.LO
     14651**DCL     14652--REDEF
AS_MOD_USER.LIMITS.MEM
     14647**DCL     14648--REDEF
AS_MOD_USER.LIMITS.MPRIO
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:442  
     14675**DCL     14676--REDEF
AS_MOD_USER.LIMITS.PDIS
     14663**DCL     14664--REDEF
AS_MOD_USER.LIMITS.PO
     14659**DCL     14660--REDEF
AS_MOD_USER.LIMITS.TDIS
     14667**DCL     14668--REDEF
AS_MOD_USER.LIMITS.TIME
     14643**DCL     14644--REDEF
AS_MOD_USER.MAXENQ
     14624**DCL     14625--REDEF
AS_MOD_USER.PERM_BIT
     14597**DCL     14598--REDEF
AS_MOD_USER.PPRIV
     14619**DCL     14621--REDEF
AS_MOD_USER.PRIOB
     14626**DCL     14627--REDEF
AS_MOD_USER.PRIV
     14616**DCL     14618--REDEF
AS_MOD_USER.QUAN
     14622**DCL     14623--REDEF
AS_MOD_USER.SETUP
     14595**DCL     14596--REDEF
AS_NONE
     11747**DCL     16293>>ASSIGN  16351>>IF      16418>>IF      17258>>IF      17518>>IF      17693>>IF
     17711>>IF      17756>>IF      17792>>IF      17805>>IF      17936>>IF      17972>>IF      18018>>IF
     18046>>IF      18057>>IF      18075>>IF      18103>>IF      18113>>IF      18132>>IF      18218>>IF
     18221>>IF      18273>>IF      18395>>IF      18614>>IF      18622>>IF      18753>>IF      18764>>IF
     19127>>IF      19143>>IF      19221>>ASSIGN  19229>>IF      19250>>DOWHILE 19255>>IF      19289>>IF
AS_NONE.TEXT
     11747**DCL     17940>>CALLBLT 18284>>CALLBLT
AS_PPRIVILEGE
     11749**DCL     20223--DOINDEX 20224>>ASSIGN  20246--DOINDEX 20247>>ASSIGN
AS_PRIVILEGE
     11749**DCL     20212--DOINDEX 20213>>ASSIGN  20235--DOINDEX 20236>>ASSIGN
AS_PROJECT
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:443  
     12820**DCL     17541<>CALL    17555<>CALL    17562<<ASSIGN  17574<<ASSIGN  17599<>CALL    17608<>CALL
     17629<>CALL    17714<<ASSIGN  17818<>CALL    17944>>ASSIGN  18074<>CALL    18117<>CALL    18237<>CALL
     19005<>CALL
AS_PROJECT.ACCT
     12821**DCL     17614<<ASSIGN  19161>>ASSIGN
AS_PROJECT.BANNER_PERM
     12935**DCL     12936--REDEF
AS_PROJECT.BUDGET.ACCUM
     12830**DCL     17575<<ASSIGN
AS_PROJECT.BUDGET.MACCT
     12840**DCL     12844--REDEF   17616<<ASSIGN  17715<<ASSIGN  17936>>IF      17937>>CALL    18075>>IF
     18099>>IF      18110>>ASSIGN  18241>>IF      18273>>IF      18276>>ASSIGN  18278>>CALL    19143>>IF
AS_PROJECT.BUDGET.MACCT_
     12844**DCL     17578<<ASSIGN
AS_PROJECT.BUDGET.MACCT_.TEXT
     12846**DCL     19008>>ASSIGN  19145>>CALLBLT 19159>>ASSIGN
AS_PROJECT.BUDGET.MAX_PROJECTS
     12853**DCL     12856--REDEF   17579<<ASSIGN  17716<<ASSIGN  19150>>IF      19151>>ASSIGN
AS_PROJECT.BUDGET.PACCUM
     12836**DCL     12838--REDEF   17577<<ASSIGN
AS_PROJECT.BUDGET.PMAXC
     12831**DCL     12833--REDEF   17576<<ASSIGN
AS_PROJECT.HPSN
     12885**DCL     17627<>CALL    17782>>ASSIGN  19160>>ASSIGN
AS_PROJECT.NAME
     12822**DCL     17615<<ASSIGN
AS_PROJECT.PPRIV
     12899**DCL     17564<<ASSIGN  17564>>ASSIGN  17581<<ASSIGN  17581>>ASSIGN  17717--DOINDEX 17718<<ASSIGN
     17718>>ASSIGN
AS_PROJECT.SETUP_CHRA.TXT
     12951**DCL     12952--REDEF   12953--REDEF
AS_PROJECT_ADMIN
     11890**DCL     16293<<ASSIGN  16351>>IF      16418>>IF      17258>>IF      17276<>CALL    17333>>ASSIGN
     17351<>CALL    17374<>CALL    17518>>IF      17524>>ASSIGN  17537<>CALL    17578>>ASSIGN  17616>>ASSIGN
     17627<>CALL    17663<>CALL    17693>>IF      17697>>ASSIGN  17708<>CALL    17712>>CALL    17715>>ASSIGN
     17756>>IF      17792>>IF      17794<>CALL    17805>>IF      17809>>ASSIGN  17932<>CALL    17937>>CALL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:444  
     17945>>ASSIGN  17972>>IF      17992<>CALL    18042>>IF      18046>>IF      18050<>CALL    18057>>IF
     18058<>CALL    18099>>IF      18103>>IF      18104>>ASSIGN  18106<>CALL    18113>>IF      18114<>CALL
     18132>>IF      18218>>IF      18224>>CALL    18278>>CALL    18614>>IF      18618>>ASSIGN  18622>>IF
     18753>>IF      18754>>ASSIGN  18764>>IF      19127>>IF      19213>>ASSIGN  19229>>IF      19285<<ASSIGN
     19289>>IF
AS_PROJECT_ADMIN.TEXT
     11890**DCL     17264>>CALLBLT 17365>>CALLBLT 17393>>ASSIGN  17652>>ASSIGN  17683>>CALLBLT 17729>>CALLBLT
     17756>>ASSIGN  18047>>CALLBLT 18122>>ASSIGN  18135>>ASSIGN  18359>>ASSIGN  19129>>CALLBLT 19294>>CALLBLT
     19295>>CALLBLT 19295>>CALLBLT
AS_PROJECT_DFLT
     12998**DCL     17541<>CALL    17555<>CALL    17568<<ASSIGN  17585<<ASSIGN  17599<>CALL    17609<>CALL
     17640<>CALL    17720<<ASSIGN  17818<>CALL    18074<>CALL    18120<>CALL    18237<>CALL    18384<>CALL
     19005<>CALL
AS_PROJECT_DFLT.BANNER_PERM
     13113**DCL     13114--REDEF
AS_PROJECT_DFLT.BUDGET.ACCUM
     13008**DCL     17722<<ASSIGN
AS_PROJECT_DFLT.BUDGET.MACCT
     13018**DCL     13022--REDEF   17617<<ASSIGN  17721<<ASSIGN
AS_PROJECT_DFLT.BUDGET.MACCT_
     13022**DCL     17589<<ASSIGN
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     13031**DCL     13034--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     13014**DCL     13016--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     13009**DCL     13011--REDEF   17606>>IF      17606<<ASSIGN  19148>>IF
AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED
     13011**DCL     17569<<ASSIGN  17586<<ASSIGN  17723<<ASSIGN  18423>>IF      19149>>ASSIGN
AS_PROJECT_DFLT.BUDGET.PROJ_CREATED
     13016**DCL     17587<<ASSIGN  17724<<ASSIGN  17821>>IF      17837<>CALL
AS_PROJECT_DFLT.BUDGET.SUB_PROJS
     13034**DCL     17588<<ASSIGN  17725<<ASSIGN  17875>>IF      17881>>ASSIGN  18399>>IF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13129**DCL     13130--REDEF   13131--REDEF
AS_PROJECT_DFLT_DREC
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:445  
     14277**DCL     17570<<ASSIGN  17590<<ASSIGN  17609<>CALL    17727<<ASSIGN
AS_PROJECT_DFLT_DREC.AS_PROJECT_DFLT_DREC_FEBLK.RESL_CNT
     14418**DCL     17641>>IF      17645>>ASSIGN
AS_PROJECT_DFLT_DREC.NWINFO
     14375**DCL     17643<<ASSIGN  17645<<ASSIGN  17647>>ASSIGN
AS_PROJECT_DFLT_DREC.PASSWORD
     14335**DCL     14339--REDEF   17591<<ASSIGN  17731<<ASSIGN
AS_PROJECT_DFLT_DREC.RENAME
     14358**DCL     14359--REDEF
AS_PROJECT_DFLT_DREC$
     11756**DCL     17541<>CALL    17555<>CALL    17599<>CALL    17648<>CALL    17818<>CALL    18386<>CALL
     19005<>CALL
AS_PROJECT_DREC
     14115**DCL     17566<<ASSIGN  17570>>ASSIGN  17583<<ASSIGN  17608<>CALL    17726<<ASSIGN
AS_PROJECT_DREC.AS_PROJECT_DREC_FEBLK.RESL_CNT
     14256**DCL     17630>>IF      17634>>ASSIGN
AS_PROJECT_DREC.NWINFO
     14213**DCL     17632<<ASSIGN  17634<<ASSIGN  17636>>ASSIGN
AS_PROJECT_DREC.PASSWORD
     14173**DCL     14177--REDEF   17567<<ASSIGN  17584<<ASSIGN
AS_PROJECT_DREC.RENAME
     14196**DCL     14197--REDEF
AS_PROJECT_DREC$
     11755**DCL     17541<>CALL    17555<>CALL    17599<>CALL    17637<>CALL    17818<>CALL    19005<>CALL
AS_PROJ_ADMIN
     12642**DCL     17525<>CALL    17608<>CALL    17698<>CALL    17810<>CALL    18055<>CALL    18105<>CALL
     18111<>CALL    18223<>CALL    18266<>CALL    18274>>ASSIGN  18277<>CALL    18279<<ASSIGN  19236<>CALL
     19249>>ASSIGN
AS_PROJ_ADMIN.BANNER_PERM
     12757**DCL     12758--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12662**DCL     12666--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12675**DCL     12678--REDEF   17657>>IF      18399>>IF      18448>>IF      18455>>ASSIGN
AS_PROJ_ADMIN.BUDGET.PACCUM
     12658**DCL     12660--REDEF
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:446  
AS_PROJ_ADMIN.BUDGET.PMAXC
     12653**DCL     12655--REDEF
AS_PROJ_ADMIN.PPRIV
     12721**DCL     19237>>IF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12773**DCL     12774--REDEF   12775--REDEF
AS_PROJ_ADMIN_DREC
     13953**DCL     17583>>ASSIGN  17608<>CALL
AS_PROJ_ADMIN_DREC.PASSWORD
     14011**DCL     14015--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     14034**DCL     14035--REDEF
AS_PROJ_ADMIN_DREC$
     11755**DCL     17525<>CALL    17698<>CALL    17810<>CALL    18266<>CALL
AS_PROJ_HEADER$
     11892**DCL     18352<<ASSIGN
AS_PSEUDO_LIST$
     11892**DCL     18349<<ASSIGN  18575>>ASSIGN
AS_RESOURCE_LIST$
     11891**DCL     18346>>IF      18347<<ASSIGN  18574>>ASSIGN
AS_SUPER_TO_PIG$
     11893**DCL     15889--IMP-PTR 18351<<ASSIGN  18356>>ASSIGN  18357>>ASSIGN  18358>>ASSIGN  18359>>ASSIGN
     18360>>ASSIGN  18361>>ASSIGN  18581>>ASSIGN
AS_TRUE
     11746**DCL     16082>>ASSIGN  16083>>ASSIGN  16084>>ASSIGN  16087>>ASSIGN  16093>>ASSIGN  16096>>ASSIGN
     16099>>ASSIGN  16102>>ASSIGN  16105>>ASSIGN  16285>>ASSIGN  16547>>ASSIGN  16551>>ASSIGN  16555>>ASSIGN
     16559>>ASSIGN  16563>>ASSIGN  16567>>ASSIGN  16571>>ASSIGN  16663<>CALL    16684<>CALL    17287>>ASSIGN
     17516>>ASSIGN  17525<>CALL    17548>>ASSIGN  17597>>ASSIGN  17698<>CALL    17810<>CALL    17818<>CALL
     18055<>CALL    18056<>CALL    18072<>CALL    18074<>CALL    18100<>CALL    18105<>CALL    18111<>CALL
     18112<>CALL    18156<>CALL    18223<>CALL    18226<>CALL    18235<>CALL    18237<>CALL    18240<>CALL
     18266<>CALL    18277<>CALL    18288<>CALL    19224<>CALL    19239<>CALL    19306<>CALL    20081>>ASSIGN
     20084>>ASSIGN  20087>>ASSIGN
AS_USERS
     12108**DCL     17280<>CALL    17294<<ASSIGN  17298<>CALL    17306<<ASSIGN  17311<<ASSIGN  17319<>CALL
     17326<>CALL    17353<>CALL    17400>>ASSIGN  17422<>CALL    17706<>CALL    17714>>ASSIGN  17720>>ASSIGN
     17944<<ASSIGN  18017<>CALL    18061<>CALL    18153<>CALL    18274<<ASSIGN  18279>>ASSIGN  18377<>CALL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:447  
     19013<>CALL    19131<>CALL    19133<>CALL    19147<>CALL    19153<>CALL    19249<<ASSIGN  19253<>CALL
AS_USERS.ACCT
     12109**DCL     17331<<ASSIGN  17407>>ASSIGN  18219<>CALL    18719>>ASSIGN
AS_USERS.BANNER_PERM
     12223**DCL     12224--REDEF
AS_USERS.BUDGET.MACCT
     12128**DCL     12132--REDEF   17333<<ASSIGN  17409>>ASSIGN  17711>>IF      17712>>CALL    17945<<ASSIGN
     18018>>IF      18042>>IF      18054>>ASSIGN  18157>>IF      18221>>IF      18222>>ASSIGN  18224>>CALL
     18766<>CALL    18796<>CALL    19250>>DOWHILE 19250>>DOWHILE 19252>>ASSIGN  19255>>IF
AS_USERS.BUDGET.MAX_PROJECTS
     12141**DCL     12144--REDEF   17948<<ASSIGN
AS_USERS.BUDGET.PACCUM
     12124**DCL     12126--REDEF   17947<<ASSIGN
AS_USERS.BUDGET.PMAXC
     12119**DCL     12121--REDEF   17946<<ASSIGN
AS_USERS.BUDGET.PROJ_CREATED
     12126**DCL     19132<<ASSIGN  19132>>ASSIGN  19149<<ASSIGN  19149>>ASSIGN
AS_USERS.BUDGET.SUB_PROJS
     12144**DCL     19151<<ASSIGN  19151>>ASSIGN  19152<<ASSIGN  19152>>ASSIGN
AS_USERS.HPSN
     12173**DCL     17351<>CALL    18186>>ASSIGN  18197>>ASSIGN  18219<>CALL    18718>>ASSIGN  18728>>ASSIGN
AS_USERS.LAST_LOGON_TIME
     12248**DCL     17342<<ASSIGN
AS_USERS.LOGINS
     12255**DCL     17343<<ASSIGN
AS_USERS.NAME
     12110**DCL     17332<<ASSIGN  17408>>ASSIGN
AS_USERS.PPRIV
     12187**DCL     17949--DOINDEX 17950<<ASSIGN  17950>>ASSIGN  18380>>IF      18389>>IF
AS_USERS.SETUP_CHRA.TXT
     12239**DCL     12240--REDEF   12241--REDEF
AS_USERS_CONSTANT
     13176**DCL     17311>>ASSIGN  17562>>ASSIGN  17568>>ASSIGN
AS_USERS_CONSTANT.BANNER_PERM
     13291**DCL     13292--REDEF
AS_USERS_CONSTANT.BUDGET.ACCUM
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:448  
     13186**DCL     17575>>ASSIGN
AS_USERS_CONSTANT.BUDGET.MACCT
     13196**DCL     13200--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13209**DCL     13212--REDEF   17579>>ASSIGN  17716>>ASSIGN  17948>>ASSIGN
AS_USERS_CONSTANT.BUDGET.PACCUM
     13192**DCL     13194--REDEF   17577>>ASSIGN  17947>>ASSIGN
AS_USERS_CONSTANT.BUDGET.PMAXC
     13187**DCL     13189--REDEF   17576>>ASSIGN  17946>>ASSIGN
AS_USERS_CONSTANT.BUDGET.SUB_PROJS
     13212**DCL     17588>>ASSIGN  17725>>ASSIGN
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13307**DCL     13308--REDEF   13309--REDEF
AS_WILD_MCH
     11895**DCL     17399<<ASSIGN
AS_WILD_USER
     11891**DCL     17278>>IF      17398>>IF      17539>>IF      19000>>IF
B$JIT.ACCN
     14745**DCL     16075>>CALLBLT
B$JIT.CPFLAGS1.SLEAZE
     14839**DCL     14839--REDEF
B$JIT.ERR.MID
     14746**DCL     14746--REDEF
B$JIT.JRESPEAK
     14907**DCL     14908--REDEF
B$JIT.MODE
     14740**DCL     16245>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
     15016**DCL     15016--REDEF   15017--REDEF
B$JIT.PNR
     14920**DCL     14920--REDEF
B$JIT.TSLINE
     15014**DCL     15015--REDEF
B$JIT.UNAME
     14745**DCL     16075>>CALLBLT 16076>>CALLBLT
B$JIT.USER
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:449  
     14745**DCL     16245>>IF
B$JIT$
     11741**DCL     14740--IMP-PTR 16075>>CALLBLT 16075>>CALLBLT 16076>>CALLBLT 16245>>IF      16245>>IF
BLANK_PASS
     11877**DCL     16281<<ASSIGN  16282<>CALL    17313>>ASSIGN  17567>>ASSIGN  17584>>ASSIGN  17591>>ASSIGN
     17731>>ASSIGN
BLK$
     15859**DCL     15974--IMP-PTR 16998<<ASSIGN  16999>>IF      17018>>CALL    17025>>ASSIGN  17026>>ASSIGN
     17026>>ASSIGN  17045>>CALLBLT 17045>>CALLBLT 17045>>CALLBLT 17045>>CALLBLT 17050>>ASSIGN  17050>>ASSIGN
     17057>>CALLBLT 17057>>CALLBLT 17066>>CALLBLT 17066>>CALLBLT 17067>>ASSIGN  17075>>CALLBLT 17075>>CALLBLT
     17076>>ASSIGN  17090>>ASSIGN  17091>>ASSIGN  17091>>ASSIGN  17114>>CALLBLT 17114>>CALLBLT 17116>>CALLBLT
     17116>>CALLBLT
BUILD_USERS_HLP
     16207**LABEL   16148--CALLALT
B_VERSION.COUNT
     11884**DCL     16288>>CALLBLT
B_VERSION.TEXT
     11884**DCL     16288>>CALLBLT
CHECK_CREATE_OK IN PROCEDURE CREATE_MOD_USER
     18368**PROC    17276--CALL    17537--CALL    17708--CALL    17932--CALL    18050--CALL    18106--CALL
     18184--CALL    18269--CALL
CMD_LOOP
     16294**LABEL   16309--REMEMBR 16325--GOTO    16349--GOTO    16372--GOTO    16393--GOTO    16416--GOTO
     16436--GOTO    16481--GOTO    16510--GOTO    16535--GOTO    16587--GOTO    16841--GOTO
CMD_NODES
     11737**DCL     16299--ASSIGN  16802--ASSIGN
CNT
     15869**DCL     15872--IMP-SIZ
CODE
     11879**DCL     16318<<ASSIGN  16320>>DOSELCT 16543>>DOSELCT 16593>>DOSELCT 16625<<ASSIGN  16626<>CALL
     16629<>CALL    17070<<ASSIGN  17079<<ASSIGN  17703<>CALL    17706<>CALL    17815<>CALL    17818<>CALL
     18015<>CALL    18017<>CALL    18072<>CALL    18074<>CALL    18151<>CALL    18153<>CALL    18235<>CALL
     18237<>CALL    18354>>IF      18354>>IF      18397>>DOSELCT 18505>>IF      18614>>IF      18616>>IF
     18751>>IF      18764>>IF
CODE IN PROCEDURE MAKEME
     19203**DCL     19200--PROC    19211>>DOSELCT
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:450  
COMPARE_FROM_TO_MAX
     19341**PROC    17326--CALL    17608--CALL    17609--CALL
COUNT IN PROCEDURE CREATE_MOD_USER
     17140**DCL     17432<<ASSIGN  17432>>ASSIGN  17435>>IF      17469<>CALL    18572<<ASSIGN  18579<<ASSIGN
COUNT IN PROCEDURE REMOVE_USER_PROJECT
     18989**DCL     18998<<ASSIGN  19009<>CALL    19015<<ASSIGN  19025<>CALL    19030<<ASSIGN  19030>>ASSIGN
     19037>>IF      19066<>CALL    19132>>ASSIGN
CREATE IN PROCEDURE CREATE_MOD_USER
     17137**DCL     17276>>IF      17303>>IF      17330>>IF      17338>>IF      17350>>IF      17362>>IF
     17537>>IF      17560>>IF      17613>>IF      17626>>IF      17649>>IF      17691<<ASSIGN  17803<<ASSIGN
     18013<<ASSIGN  18070<<ASSIGN  18149<<ASSIGN  18233<<ASSIGN  18314<<ASSIGN  18315>>ASSIGN  18376>>IF
CREATE_MOD_PROJ IN PROCEDURE CREATE_MOD_USER
     17514**ENTRY   16622--CALL
CREATE_MOD_USER
     17122**PROC    16619--CALL
CREATE_OK IN PROCEDURE CHECK_CREATE_OK
     18395**LABEL   18377--CALLALT 18379--CALLALT 18384--CALLALT 18386--CALLALT
CR_MOD_CMD
     11737**DCL     17257<>CALL
CR_MOD_FLG
     11895**DCL     17691<<ASSIGN  17803<<ASSIGN  18315<<ASSIGN
CR_MOD_KEY IN PROCEDURE CREATE_MOD_USER
     17128**DCL     17270<>CALL    17275>>ASSIGN  17329>>ASSIGN  17346<>CALL    17349>>ASSIGN  17531<>CALL
     17536>>ASSIGN  17589>>ASSIGN  17612>>ASSIGN  17617>>ASSIGN  17622<>CALL    17625>>ASSIGN  17703<>CALL
     17705>>ASSIGN  17712<>CALL    17721>>ASSIGN  17735<>CALL    17752>>ASSIGN  17794<>CALL    17815<>CALL
     17817>>ASSIGN  17857<>CALL    17912<>CALL    17937<>CALL    17955<>CALL    17973>>ASSIGN  17992<>CALL
     17998>>ASSIGN  18015<>CALL    18016>>ASSIGN  18024<>CALL    18043<>CALL    18056<>CALL    18058<>CALL
     18060>>ASSIGN  18072<>CALL    18073>>ASSIGN  18081<>CALL    18100<>CALL    18112<>CALL    18114<>CALL
     18116>>ASSIGN  18128>>ASSIGN  18151<>CALL    18152>>ASSIGN  18161<>CALL    18198<>CALL    18224<>CALL
     18226<>CALL    18235<>CALL    18236>>ASSIGN  18245<>CALL    18278<>CALL    18288<>CALL    18290>>ASSIGN
     18390<>CALL    18391<>CALL    18580<<ASSIGN  18600>>ASSIGN
CR_MOD_KEY.CNT IN PROCEDURE CREATE_MOD_USER
     17129**DCL     17395>>ASSIGN  17654>>ASSIGN  17728>>ASSIGN  17939>>ASSIGN  18124>>ASSIGN  18283>>ASSIGN
CR_MOD_KEY.TEXT IN PROCEDURE CREATE_MOD_USER
     17130**DCL     17310>>IF      17331>>ASSIGN  17332>>ASSIGN  17394>>ASSIGN  17561>>IF      17614>>ASSIGN
     17615>>ASSIGN  17653>>ASSIGN  17729>>CALLBLT 17940>>CALLBLT 17978>>DOWHILE 17996>>CALLBLT 18123>>ASSIGN
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:451  
     18284>>CALLBLT 18360>>ASSIGN  18605>>DOWHILE
DELETE_FLAG
     15877**DCL     16547<<ASSIGN  16551<<ASSIGN  16555<<ASSIGN  16559<<ASSIGN  16563<<ASSIGN  16567<<ASSIGN
     16571<<ASSIGN  16573<<ASSIGN  16575>>IF
DELETE_PROMPT
     15878**DCL     16578<<CALLBLT 16580<>CALL
DEQ_ERR
     16305**LABEL   16305--CALLALT
DEST_PROJ IN PROCEDURE GET_ACCT_LIST
     18705**DCL     18752<<ASSIGN  18754<<ASSIGN  18761<>CALL    18828<>CALL    18844<>CALL    18869<>CALL
DEST_PROJ.COUNT IN PROCEDURE GET_ACCT_LIST
     18706**DCL     18755<<ASSIGN  18759>>IF      18816>>IF      18837>>IF
DEST_PROJ IN PROCEDURE GET_PACKSET_LIST
     18595**DCL     18617<<ASSIGN  18618<<ASSIGN  18621<>CALL    18623<>CALL    18628<>CALL    18652<>CALL
DONE IN PROCEDURE CREATE_MOD_USER
     17990**LABEL   17977--CALLALT 17988--CALLALT
DSEG1$
     11887**DCL     17158--IMP-PTR 17246--IMP-PTR 17760>>ASSIGN  17765>>DOWHILE 17766>>ASSIGN  17767>>ASSIGN
     17769>>ASSIGN  17982>>ASSIGN  17983>>ASSIGN  17984>>ASSIGN  18000>>ASSIGN  18347>>ASSIGN  18348>>ASSIGN
     18349>>ASSIGN  18350>>ASSIGN  18603>>ASSIGN  18607>>ASSIGN  18621>>CALL    18623>>CALL    18623>>CALL
     18625>>IF      18630>>ASSIGN  18648>>IF      18648>>IF      18654>>ASSIGN  18718>>ASSIGN  18719>>ASSIGN
     18726>>ASSIGN  18728>>ASSIGN  18729>>ASSIGN  18732>>ASSIGN  18733>>ASSIGN  18736>>DOWHILE 18736>>DOWHILE
     18739>>IF      18739>>IF      18741>>ASSIGN  18741>>ASSIGN  18743>>ASSIGN  18743>>ASSIGN  18758>>ASSIGN
     18770>>DOWHILE 18773>>CALL    18773>>CALL    18773>>CALL    18779>>DOWHILE 18782>>IF      18784>>ASSIGN
     18790>>ASSIGN  18793>>ASSIGN  18821>>DOWHILE 18825>>IF      18828>>CALL    18829>>ASSIGN  18891>>DOWHILE
     19155>>ASSIGN  19156>>ASSIGN  19157>>ASSIGN  19158>>ASSIGN  19159>>ASSIGN  19160>>ASSIGN  19161>>ASSIGN
     19162>>ASSIGN  19163>>CALL    19163>>CALL
DSEG1SIZE
     11888**DCL     16804>>IF      16805>>ASSIGN  18602>>ASSIGN  18610>>ASSIGN
DSEG2$
     11888**DCL     17189--IMP-PTR 17222--IMP-PTR 17753>>ASSIGN  17754>>ASSIGN  17755>>ASSIGN  17756>>ASSIGN
     17763>>ASSIGN  17764>>ASSIGN  17766>>ASSIGN  17767>>ASSIGN  17768>>ASSIGN  17768>>ASSIGN  17769>>ASSIGN
     17769>>ASSIGN  17772>>ASSIGN  17772>>ASSIGN  17773>>ASSIGN  17773>>ASSIGN  17774>>ASSIGN  17774>>ASSIGN
     17775<>CALL    17785>>ASSIGN  17786<>CALL    17977<>CALL    17979>>ASSIGN  17979>>ASSIGN  17981>>DOINDEX
     17988<>CALL    18131<>CALL    18133>>ASSIGN  18135>>ASSIGN  18136<>CALL    18293<>CALL    18294>>ASSIGN
     18295<>CALL    18351>>ASSIGN  18352>>ASSIGN  18766<>CALL    18776>>ASSIGN  18776>>ASSIGN  18779>>DOWHILE
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:452  
     18782>>IF      18921>>IF
DSEG2SIZE
     11888**DCL     16809>>IF      16810>>ASSIGN  17976>>ASSIGN  17987>>ASSIGN  18923>>ASSIGN
DSEG3$
     11888**DCL     18621<>CALL    18623<>CALL    18625>>IF      18625>>IF      18648>>IF      18648>>IF
     18648>>IF      18761<>CALL    18818>>ASSIGN  18818>>ASSIGN  18821>>DOWHILE 18825>>IF      18828<>CALL
     18839>>IF      18839>>IF      18864>>IF      18864>>IF      18864>>IF
DSEG3SIZE
     11888**DCL     16814>>IF      16815>>ASSIGN  18927>>ASSIGN
DSEG_FLG
     11887**DCL     16819<<ASSIGN  18326>>IF
ENQDEQ_FLG
     11889**DCL     16300<<ASSIGN  16303>>IF      16307<<ASSIGN
ERR_CNT
     11889**DCL     16856>>IF      16858>>IF      16868<>CALL    16938>>IF
ERR_CODE
     11881**DCL     11882--REDEF   16145<>CALL    16174>>ASSIGN  16182<>CALL    16207>>ASSIGN  16294<<ASSIGN
     16847<>CALL    17777<>CALL    17788<>CALL    18138<>CALL    18297<>CALL
EXIT# IN PROCEDURE CREATE_MOD_USER
     17510**LABEL   17257--CALLALT 17266--CALLALT 17270--CALLALT 17274--CALLALT 17276--CALLALT 17280--CALLALT
     17289--CALLALT 17298--CALLALT 17319--CALLALT 17351--CALLALT 17525--CALLALT 17531--CALLALT 17535--CALLALT
     17537--CALLALT 17541--CALLALT 17550--CALLALT 17555--CALLALT 17599--CALLALT 17627--CALLALT 17698--CALLALT
     17703--CALLALT 17706--CALLALT 17708--CALLALT 17709--CALLALT 17710--CALLALT 17793--CALLALT 17810--CALLALT
     17815--CALLALT 17818--CALLALT 17932--CALLALT 17933--CALLALT 17934--CALLALT 18015--CALLALT 18017--CALLALT
     18049--CALLALT 18050--CALLALT 18052--CALLALT 18053--CALLALT 18055--CALLALT 18072--CALLALT 18074--CALLALT
     18105--CALLALT 18106--CALLALT 18108--CALLALT 18109--CALLALT 18111--CALLALT 18151--CALLALT 18153--CALLALT
     18156--CALLALT 18182--CALLALT 18184--CALLALT 18217--CALLALT 18219--CALLALT 18220--CALLALT 18223--CALLALT
     18235--CALLALT 18237--CALLALT 18240--CALLALT 18266--CALLALT 18269--CALLALT 18270--CALLALT 18271--CALLALT
     18277--CALLALT
EXIT# IN PROCEDURE MAKEME
     19336**LABEL   19224--CALLALT
EXIT# IN PROCEDURE MOD_PROJ_ADMIN_REC
     19165**LABEL   19146--CALLALT 19147--CALLALT
EXIT# IN PROCEDURE REMOVE_USER_PROJECT
     19138**LABEL   18999--CALLALT 19005--CALLALT 19013--CALLALT 19130--CALLALT 19131--CALLALT
EXIT_SUPER
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:453  
     16940**LABEL   16128--GOTO    16146--GOTO    16614--GOTO
F$DCB.ACTPOS
     16039**DCL     16039--REDEF
F$DCB.ARS#
     16013**DCL     16013--REDEF
F$DCB.ATTR
     16032**DCL     16033--REDEF
F$DCB.BORROW
     16047**DCL     16047--REDEF   16047--REDEF   16047--REDEF
F$DCB.DCBNAME.L
     16061**DCL     16061--IMP-SIZ
F$DCB.EOMCHAR#
     16017**DCL     16017--REDEF
F$DCB.FLDID
     16042**DCL     16042--REDEF
F$DCB.FORM$
     16036**DCL     16036--REDEF
F$DCB.FSECT
     16052**DCL     16052--REDEF
F$DCB.FSN#
     16029**DCL     16029--REDEF   16029--REDEF   16030--REDEF
F$DCB.HEADER$
     16035**DCL     16035--REDEF
F$DCB.IXTNSIZE#
     16033**DCL     16033--REDEF
F$DCB.LASTSTA$
     16022**DCL     16022--REDEF
F$DCB.LVL
     16048**DCL     16048--REDEF
F$DCB.NAME#.C
     16023**DCL     16023--REDEF
F$DCB.NOEOF
     16045**DCL     16045--REDEF
F$DCB.NRECS#
     16034**DCL     16034--REDEF
F$DCB.NRECX
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:454  
     16053**DCL     16053--REDEF
F$DCB.OHDR
     16045**DCL     16045--REDEF
F$DCB.ORG#
     16028**DCL     16028--REDEF
F$DCB.PRECNO
     16051**DCL     16051--REDEF
F$DCB.RCSZ
     16057**DCL     16057--REDEF
F$DCB.RES#
     16024**DCL     16024--REDEF
F$DCB.SETX
     16036**DCL     16036--REDEF
F$DCB.TAB$
     16036**DCL     16036--REDEF
F$DCB.TDA
     16050**DCL     16051--REDEF
F$DCB.WSN#
     16024**DCL     16024--REDEF
FACCOUNT_OPT IN PROCEDURE REMOVE_USER_PROJECT
     18992**DCL     18997<<ASSIGN  19009<>CALL    19014<>CALL    19025<>CALL    19029<>CALL    19154>>IF
FACCT_INX IN PROCEDURE GET_ACCT_LIST
     18700**DCL     18698--PROC    18713>>IF      18715>>ASSIGN
FINISHED IN PROCEDURE CREATE_MOD_USER
     17435**LABEL   17278--CALLALT 17403--CALLALT
FINISHED IN PROCEDURE GET_PACKSET_LIST
     18614**LABEL   18604--CALLALT 18611--CALLALT
FINISHED IN PROCEDURE REMOVE_USER_PROJECT
     19036**LABEL   19022--CALLALT
FPT_EXIT
     15047**DCL     16945<>CALL
FPT_EXIT.V
     15047**DCL     15047--DCLINIT
FPT_EXIT.V.STEPCC#
     15048**DCL     15048--REDEF   16940<<ASSIGN  16943<<ASSIGN
FPT_PRIV
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:455  
     15063**DCL     16081<>CALL    16086<>CALL    16093<>CALL    16096<>CALL    16099<>CALL    16102<>CALL
     16105<>CALL
FPT_PRIV.V
     15063**DCL     15063--DCLINIT
FPT_PRIV.V.PRIV#
     15063**DCL     16080<<ASSIGN  16085<<ASSIGN  16092<<ASSIGN  16095<<ASSIGN  16098<<ASSIGN  16101<<ASSIGN
     16104<<ASSIGN
FREE_SEG_SIZE
     15879**DCL     16805<<ASSIGN  16807<>CALL    16810<<ASSIGN  16812<>CALL    16815<<ASSIGN  16817<>CALL
FREE_SEG_TYPE
     15880**DCL     16806<<ASSIGN  16807<>CALL    16811<<ASSIGN  16812<>CALL    16816<<ASSIGN  16817<>CALL
FROM_DEFAULT_PROJECT IN PROCEDURE CREATE_MOD_USER
     17597**LABEL   17554--GOTO
FROM_DREC IN PROCEDURE COMPARE_FROM_TO_MAX
     19535**DCL     19341--PROC
FROM_DREC.FLAGS.BATOK IN PROCEDURE COMPARE_FROM_TO_MAX
     19557**DCL     20053>>IF      20055<<ASSIGN
FROM_DREC.FLAGS.FEOK IN PROCEDURE COMPARE_FROM_TO_MAX
     19581**DCL     20067>>IF      20069<<ASSIGN
FROM_DREC.FLAGS.GHOSTOK IN PROCEDURE COMPARE_FROM_TO_MAX
     19550**DCL     20061>>IF      20063<<ASSIGN
FROM_DREC.FLAGS.OLOK IN PROCEDURE COMPARE_FROM_TO_MAX
     19553**DCL     20058>>IF      20060<<ASSIGN
FROM_DREC.FLAGS.TPOK IN PROCEDURE COMPARE_FROM_TO_MAX
     19577**DCL     20064>>IF      20066<<ASSIGN
FROM_DREC.FROM_BLK.PPRIV IN PROCEDURE COMPARE_FROM_TO_MAX
     19662**DCL     20248>>IF      20252<<ASSIGN  20252>>ASSIGN
FROM_DREC.FROM_BLK.PRIV IN PROCEDURE COMPARE_FROM_TO_MAX
     19661**DCL     20237>>IF      20241<<ASSIGN  20241>>ASSIGN
FROM_DREC.PASSWORD IN PROCEDURE COMPARE_FROM_TO_MAX
     19593**DCL     19597--REDEF
FROM_DREC.RENAME IN PROCEDURE COMPARE_FROM_TO_MAX
     19616**DCL     19617--REDEF
FROM_FLG
     11895**DCL     17287<<ASSIGN  17302<<ASSIGN  17325>>IF      17330>>IF      17338>>IF      17405>>IF
     17548<<ASSIGN  17559<<ASSIGN  17597<<ASSIGN  17607>>IF      17613>>IF      17692<<ASSIGN  17804<<ASSIGN
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:456  
FROM_KEY
     11760**DCL     17289<>CALL    17291>>ASSIGN  17318>>ASSIGN  17550<>CALL    17553>>ASSIGN  17598>>ASSIGN
     18156<>CALL    18157>>IF      18162<>CALL    18184<>CALL    18185>>ASSIGN  18199<>CALL    18219<>CALL
     18226<>CALL    18240<>CALL    18241>>IF      18246<>CALL    18265>>ASSIGN  18269<>CALL    18288<>CALL
     18617>>ASSIGN  18752>>ASSIGN
FROM_KEY.CNT
     11760**DCL     17316<<ASSIGN  17594<<ASSIGN
FROM_KEY.TEXT
     11760**DCL     17292>>IF      17317<<ASSIGN  17554>>IF      17595<<ASSIGN  18180>>CALLBLT 18294>>ASSIGN
FROM_USERS IN PROCEDURE COMPARE_FROM_TO_MAX
     19357**DCL     19341--PROC
FROM_USERS.BANNER_PERM IN PROCEDURE COMPARE_FROM_TO_MAX
     19472**DCL     19473--REDEF
FROM_USERS.BATOK IN PROCEDURE COMPARE_FROM_TO_MAX
     19362**DCL     20056<<ASSIGN
FROM_USERS.BUDGET.ACCUM IN PROCEDURE COMPARE_FROM_TO_MAX
     19367**DCL     20078<<ASSIGN
FROM_USERS.BUDGET.BKACC IN PROCEDURE COMPARE_FROM_TO_MAX
     19384**DCL     20088>>IF      20090<<ASSIGN
FROM_USERS.BUDGET.BUDLIM IN PROCEDURE COMPARE_FROM_TO_MAX
     19385**DCL     20085>>IF      20087<<ASSIGN
FROM_USERS.BUDGET.ICHARGES IN PROCEDURE COMPARE_FROM_TO_MAX
     19387**DCL     20082>>IF      20084<<ASSIGN
FROM_USERS.BUDGET.MACCT IN PROCEDURE COMPARE_FROM_TO_MAX
     19377**DCL     19381--REDEF
FROM_USERS.BUDGET.MAXC IN PROCEDURE COMPARE_FROM_TO_MAX
     19366**DCL     20073>>IF      20076<<ASSIGN
FROM_USERS.BUDGET.MAX_PROJECTS IN PROCEDURE COMPARE_FROM_TO_MAX
     19390**DCL     19393--REDEF
FROM_USERS.BUDGET.PACCUM IN PROCEDURE COMPARE_FROM_TO_MAX
     19373**DCL     19375--REDEF
FROM_USERS.BUDGET.PCHARGES IN PROCEDURE COMPARE_FROM_TO_MAX
     19386**DCL     20079>>IF      20081<<ASSIGN
FROM_USERS.BUDGET.PMAXC IN PROCEDURE COMPARE_FROM_TO_MAX
     19368**DCL     19370--REDEF
FROM_USERS.DDO IN PROCEDURE COMPARE_FROM_TO_MAX
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:457  
     19409**DCL     20122>>IF      20123<<ASSIGN
FROM_USERS.DFPOOLS IN PROCEDURE COMPARE_FROM_TO_MAX
     19417**DCL     20166>>IF      20167<<ASSIGN
FROM_USERS.DLO IN PROCEDURE COMPARE_FROM_TO_MAX
     19407**DCL     20111>>IF      20112<<ASSIGN
FROM_USERS.DMEM IN PROCEDURE COMPARE_FROM_TO_MAX
     19457**DCL     20205>>IF      20206<<ASSIGN
FROM_USERS.DMPRIO IN PROCEDURE COMPARE_FROM_TO_MAX
     19419**DCL     20177>>IF      20178<<ASSIGN
FROM_USERS.DPDIS IN PROCEDURE COMPARE_FROM_TO_MAX
     19413**DCL     20144>>IF      20145<<ASSIGN
FROM_USERS.DPO IN PROCEDURE COMPARE_FROM_TO_MAX
     19411**DCL     20133>>IF      20134<<ASSIGN
FROM_USERS.DTDIS IN PROCEDURE COMPARE_FROM_TO_MAX
     19415**DCL     20155>>IF      20156<<ASSIGN
FROM_USERS.DTIME IN PROCEDURE COMPARE_FROM_TO_MAX
     19454**DCL     20191>>IF      20192<<ASSIGN
FROM_USERS.KEY IN PROCEDURE COMPARE_FROM_TO_MAX
     19397**DCL     20257>>IF      20258<<ASSIGN
FROM_USERS.MDO IN PROCEDURE COMPARE_FROM_TO_MAX
     19408**DCL     20119>>IF      20121<<ASSIGN
FROM_USERS.MFPOOLS IN PROCEDURE COMPARE_FROM_TO_MAX
     19416**DCL     20163>>IF      20165<<ASSIGN
FROM_USERS.MLO IN PROCEDURE COMPARE_FROM_TO_MAX
     19406**DCL     20108>>IF      20110<<ASSIGN
FROM_USERS.MMEM IN PROCEDURE COMPARE_FROM_TO_MAX
     19456**DCL     20202>>IF      20204<<ASSIGN
FROM_USERS.MMPRIO IN PROCEDURE COMPARE_FROM_TO_MAX
     19418**DCL     20174>>IF      20176<<ASSIGN
FROM_USERS.MPDIS IN PROCEDURE COMPARE_FROM_TO_MAX
     19412**DCL     20141>>IF      20143<<ASSIGN
FROM_USERS.MPO IN PROCEDURE COMPARE_FROM_TO_MAX
     19410**DCL     20130>>IF      20132<<ASSIGN
FROM_USERS.MTDIS IN PROCEDURE COMPARE_FROM_TO_MAX
     19414**DCL     20152>>IF      20154<<ASSIGN
FROM_USERS.MTIME IN PROCEDURE COMPARE_FROM_TO_MAX
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:458  
     19453**DCL     20188>>IF      20190<<ASSIGN
FROM_USERS.OUTPUTPRIO IN PROCEDURE COMPARE_FROM_TO_MAX
     19399**DCL     20094>>IF      20096<<ASSIGN
FROM_USERS.PPRIV IN PROCEDURE COMPARE_FROM_TO_MAX
     19436**DCL     20225>>IF      20229<<ASSIGN  20229>>ASSIGN
FROM_USERS.PRIV IN PROCEDURE COMPARE_FROM_TO_MAX
     19435**DCL     20214>>IF      20218<<ASSIGN  20218>>ASSIGN
FROM_USERS.SETUP_CHRA.TXT IN PROCEDURE COMPARE_FROM_TO_MAX
     19488**DCL     19489--REDEF   19490--REDEF
GET_ACCT_LIST IN PROCEDURE CREATE_MOD_USER
     18698**PROC    17710--CALL    18053--CALL    18220--CALL
GET_FIRST IN PROCEDURE CREATE_MOD_USER
     18569**PROC    17278--CALL    17539--CALL
GET_PACKSET_LIST IN PROCEDURE CREATE_MOD_USER
     18592**PROC    17793--CALL    17934--CALL    18109--CALL    18271--CALL
GET_PROJ_OPTIONS IN PROCEDURE CREATE_MOD_USER
     17617**LABEL   17797--GOTO
GET_USER_OPTIONS IN PROCEDURE CREATE_MOD_USER
     17330**LABEL   18007--GOTO
GRANS IN PROCEDURE GET_ACCT_LIST
     18703**DCL     18762<<ASSIGN  18829<<ASSIGN  18829>>ASSIGN  18839>>IF
I
     15865**DCL     16076<<CALLBLT 16077>>ASSIGN  16581<>CALL    16582>>IF      17052<>CALL    17053>>IF
     19262<<CALLBLT 19263>>CALLBLT 19265>>ASSIGN  19294<<CALLBLT 19295>>CALLBLT
I IN PROCEDURE COMPARE_FROM_TO_MAX
     20025**DCL     20100<<DOINDEX 20108>>IF      20108>>IF      20110>>ASSIGN  20110>>ASSIGN  20111>>IF
     20111>>IF      20112>>ASSIGN  20112>>ASSIGN  20119>>IF      20119>>IF      20121>>ASSIGN  20121>>ASSIGN
     20122>>IF      20122>>IF      20123>>ASSIGN  20123>>ASSIGN  20130>>IF      20130>>IF      20132>>ASSIGN
     20132>>ASSIGN  20133>>IF      20133>>IF      20134>>ASSIGN  20134>>ASSIGN  20141>>IF      20141>>IF
     20143>>ASSIGN  20143>>ASSIGN  20144>>IF      20144>>IF      20145>>ASSIGN  20145>>ASSIGN  20152>>IF
     20152>>IF      20154>>ASSIGN  20154>>ASSIGN  20155>>IF      20155>>IF      20156>>ASSIGN  20156>>ASSIGN
     20163>>IF      20163>>IF      20165>>ASSIGN  20165>>ASSIGN  20166>>IF      20166>>IF      20167>>ASSIGN
     20167>>ASSIGN  20174>>IF      20174>>IF      20176>>ASSIGN  20176>>ASSIGN  20177>>IF      20177>>IF
     20178>>ASSIGN  20178>>ASSIGN  20188>>IF      20188>>IF      20190>>ASSIGN  20190>>ASSIGN  20191>>IF
     20191>>IF      20192>>ASSIGN  20192>>ASSIGN  20202>>IF      20202>>IF      20204>>ASSIGN  20204>>ASSIGN
     20205>>IF      20205>>IF      20206>>ASSIGN  20206>>ASSIGN  20214>>IF      20216>>IF      20218>>ASSIGN
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:459  
     20218>>ASSIGN  20225>>IF      20227>>IF      20229>>ASSIGN  20229>>ASSIGN  20237>>IF      20239>>IF
     20241>>ASSIGN  20241>>ASSIGN  20248>>IF      20250>>IF      20252>>ASSIGN  20252>>ASSIGN
I IN PROCEDURE CREATE_MOD_USER
     17131**DCL     17563<<DOINDEX 17564>>ASSIGN  17564>>ASSIGN  17580<<DOINDEX 17581>>ASSIGN  17581>>ASSIGN
     17717<<DOINDEX 17718>>ASSIGN  17718>>ASSIGN  17758<<ASSIGN  17759>>DOWHILE 17760>>ASSIGN  17765>>DOWHILE
     17765>>DOWHILE 17766>>ASSIGN  17767>>ASSIGN  17769>>ASSIGN  17770<<ASSIGN  17770>>ASSIGN  17881<<ASSIGN
     17892<>CALL    17949<<DOINDEX 17950>>ASSIGN  17950>>ASSIGN  17999<<DOINDEX 18000>>ASSIGN  18130<<DOINDEX
     18187<<CALLBLT 18188>>ASSIGN  18196>>ASSIGN  18292<<DOINDEX 18455<<ASSIGN  18464<>CALL    18620<<DOINDEX
     18621>>CALL    18623>>CALL    18623>>CALL    18625>>IF      18629>>ASSIGN  18630>>ASSIGN  18648>>IF
     18648>>IF      18653>>ASSIGN  18654>>ASSIGN  18724<<DOINDEX 18725>>ASSIGN  18756<<ASSIGN  18757>>DOWHILE
     18758>>ASSIGN  18770>>DOWHILE 18770>>DOWHILE 18773>>CALL    18773>>CALL    18773>>CALL    18779>>DOWHILE
     18782>>IF      18784>>ASSIGN  18790>>ASSIGN  18793>>ASSIGN  18821>>DOWHILE 18825>>IF      18828>>CALL
     18829>>ASSIGN  18835<<ASSIGN  18835>>ASSIGN  18891>>DOWHILE 18891>>DOWHILE 18892<<ASSIGN  18892>>ASSIGN
I IN PROCEDURE READ_PROJ_REC
     18913**DCL     18918<<CALLBLT 18919>>ASSIGN  18923<<ASSIGN  18924<>CALL    18927<<ASSIGN  18928<>CALL
INITIALIZATIONS IN PROCEDURE CREATE_MOD_USER
     18324**PROC    17274--CALL    17535--CALL    17709--CALL    17933--CALL    18052--CALL    18108--CALL
     18217--CALL    18270--CALL
INTERNAL_ERROR IN PROCEDURE MAKEME
     19313**LABEL   19253--CALLALT
INTFPT
     15846**DCL     16073<>CALL
INTFPT.V
     15846**DCL     15846--DCLINIT
IN_BUF
     11877**DCL     16312<>CALL    16581<>CALL    16582>>IF      16582>>IF      17052<>CALL    17053>>IF
     17053>>IF      17066<<CALLBLT 17075<<CALLBLT
IO_ERR IN PROCEDURE CREATE_MOD_USER
     18138**LABEL   18131--CALLALT 18136--CALLALT
IO_ERR2 IN PROCEDURE CREATE_MOD_USER
     18297**LABEL   18293--CALLALT 18295--CALLALT
IS_HLP_THERE
     16107**LABEL   16134--CALLALT
IS_PRO_THERE
     16207**LABEL   16139--GOTO    16175--GOTO    16208--GOTO
J IN PROCEDURE COMPARE_FROM_TO_MAX
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:460  
     20026**DCL     20212<<DOINDEX 20213>>ASSIGN  20223<<DOINDEX 20224>>ASSIGN  20235<<DOINDEX 20236>>ASSIGN
     20246<<DOINDEX 20247>>ASSIGN  20256<<DOINDEX 20257>>IF      20257>>IF      20258>>ASSIGN
J IN PROCEDURE CREATE_MOD_USER
     17132**DCL     17761<<CALLBLT 17762>>ASSIGN  17783<<CALLBLT 17784>>ASSIGN  17981<<DOINDEX 17983>>ASSIGN
     17984>>ASSIGN  18001<<CALLBLT 18002>>ASSIGN  18735<<ASSIGN  18736>>DOWHILE 18736>>DOWHILE 18737<<ASSIGN
     18737>>ASSIGN  18739>>IF      18740>>DOINDEX 18743>>ASSIGN  18778<<ASSIGN  18779>>DOWHILE 18779>>DOWHILE
     18780<<ASSIGN  18780>>ASSIGN  18782>>IF      18782>>IF      18784>>ASSIGN  18820<<ASSIGN  18821>>DOWHILE
     18821>>DOWHILE 18823<<ASSIGN  18823>>ASSIGN  18825>>IF      18825>>IF
K IN PROCEDURE CREATE_MOD_USER
     17133**DCL     18740<<DOINDEX 18741>>ASSIGN  18741>>ASSIGN  18791<<CALLBLT 18792>>ASSIGN  18794<<CALLBLT
     18795>>ASSIGN
KEY IN PROCEDURE REMOVE_USER_PROJECT
     18981**DCL     19009<>CALL    19024<<ASSIGN  19025<>CALL
KEY.COUNT IN PROCEDURE REMOVE_USER_PROJECT
     18982**DCL     19003<<ASSIGN
KEY.SKEY.CREATOR IN PROCEDURE REMOVE_USER_PROJECT
     18986**DCL     19008<<ASSIGN
KEY.SKEY.PROJ IN PROCEDURE REMOVE_USER_PROJECT
     18985**DCL     19007<<ASSIGN
KEY.SKEY.USER IN PROCEDURE REMOVE_USER_PROJECT
     18987**DCL     19004<<ASSIGN
KEY.TEXT IN PROCEDURE REMOVE_USER_PROJECT
     18983**DCL     18984--REDEF
KL_DEFAULT
     14439**DCL     17312>>ASSIGN  17566>>ASSIGN
KL_DEFAULT.KL_DEFAULT_FEBLK
     14555**DCL     17356--ASSIGN  17358--ASSIGN  17413--ASSIGN  17415--ASSIGN  17425--ASSIGN  17427--ASSIGN
     17632--ASSIGN  17634--ASSIGN  17643--ASSIGN  17645--ASSIGN
KL_DEFAULT.PASSWORD
     14497**DCL     14501--REDEF
KL_DEFAULT.RENAME
     14520**DCL     14521--REDEF
KL_DFLT
     13629**DCL     17295>>ASSIGN  17307>>ASSIGN  17326<>CALL    17401<<ASSIGN  17991<<ASSIGN
KL_DFLT.KL_DFLT_FEBLK.RESL_CNT
     13770**DCL     17411>>IF      17415>>ASSIGN
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:461  
KL_DFLT.NWINFO
     13727**DCL     17413<<ASSIGN  17415<<ASSIGN  17417>>ASSIGN
KL_DFLT.PASSWORD
     13687**DCL     13691--REDEF
KL_DFLT.RENAME
     13710**DCL     13711--REDEF
KL_DFLT$
     11754**DCL     17266<>CALL    17418<>CALL
KL_DREC
     13467**DCL     15033--DCLINIT 17295<<ASSIGN  17307<<ASSIGN  17312<<ASSIGN  17326<>CALL    17401>>ASSIGN
     17726>>ASSIGN  17727>>ASSIGN
KL_DREC.KL_DREC_FEBLK
     13583**DCL     18378--ASSIGN  18385--ASSIGN
KL_DREC.KL_DREC_FEBLK.RESL_CNT
     13608**DCL     17354>>IF      17358>>ASSIGN  17423>>IF      17427>>ASSIGN
KL_DREC.NWINFO
     13565**DCL     17356<<ASSIGN  17358<<ASSIGN  17360>>ASSIGN  17425<<ASSIGN  17427<<ASSIGN  17429>>ASSIGN
KL_DREC.PASSWORD
     13525**DCL     13529--REDEF   17313<<ASSIGN
KL_DREC.RENAME
     13548**DCL     13549--REDEF
KL_DREC$
     11754**DCL     17280<>CALL    17298<>CALL    17319<>CALL    17361<>CALL    17430<>CALL    17706<>CALL
     18379<>CALL    19013<>CALL
KL_DREC_CNT
     13354**DCL     15032--DCLINIT
KL_DREC_CNT.PASSWORD
     13412**DCL     13416--REDEF
KL_DREC_CNT.RENAME
     13435**DCL     13436--REDEF
LINE IN PROCEDURE RECONFIG_TIGR_STATION
     16991**DCL     17045<<CALLBLT 17046<>CALL    17046--CALL    17047<<CALLBLT 17048<>CALL    17048--CALL
     17057<<CALLBLT 17058<>CALL    17058--CALL    17114<<CALLBLT 17115<>CALL    17115--CALL    17116<<CALLBLT
     17117<>CALL    17117--CALL
LO_WIDTH
     11763**DCL     18358>>ASSIGN  19156>>ASSIGN
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:462  
M$EXIT
     11032**DCL-ENT 16271--CALL    16945--CALL
M$INT
     11075**DCL-ENT 16073--CALL
M$SPRIV
     11079**DCL-ENT 16081--CALL    16086--CALL    16093--CALL    16096--CALL    16099--CALL    16102--CALL
     16105--CALL
MAKEME
     19200**PROC    16292--CALL    16626--CALL
MAX_DREC IN PROCEDURE COMPARE_FROM_TO_MAX
     19875**DCL     19341--PROC
MAX_DREC.FLAGS.BATOK IN PROCEDURE COMPARE_FROM_TO_MAX
     19897**DCL     20053>>IF
MAX_DREC.FLAGS.FEOK IN PROCEDURE COMPARE_FROM_TO_MAX
     19921**DCL     20067>>IF
MAX_DREC.FLAGS.GHOSTOK IN PROCEDURE COMPARE_FROM_TO_MAX
     19890**DCL     20061>>IF
MAX_DREC.FLAGS.OLOK IN PROCEDURE COMPARE_FROM_TO_MAX
     19893**DCL     20058>>IF
MAX_DREC.FLAGS.TPOK IN PROCEDURE COMPARE_FROM_TO_MAX
     19917**DCL     20064>>IF
MAX_DREC.MAX_BLK.PPRIV IN PROCEDURE COMPARE_FROM_TO_MAX
     20002**DCL     20250>>IF
MAX_DREC.MAX_BLK.PRIV IN PROCEDURE COMPARE_FROM_TO_MAX
     20001**DCL     20239>>IF
MAX_DREC.PASSWORD IN PROCEDURE COMPARE_FROM_TO_MAX
     19933**DCL     19937--REDEF
MAX_DREC.RENAME IN PROCEDURE COMPARE_FROM_TO_MAX
     19956**DCL     19957--REDEF
MAX_USERS IN PROCEDURE COMPARE_FROM_TO_MAX
     19697**DCL     19341--PROC
MAX_USERS.BANNER_PERM IN PROCEDURE COMPARE_FROM_TO_MAX
     19812**DCL     19813--REDEF
MAX_USERS.BUDGET.BKACC IN PROCEDURE COMPARE_FROM_TO_MAX
     19724**DCL     20088>>IF
MAX_USERS.BUDGET.BUDLIM IN PROCEDURE COMPARE_FROM_TO_MAX
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:463  
     19725**DCL     20085>>IF
MAX_USERS.BUDGET.ICHARGES IN PROCEDURE COMPARE_FROM_TO_MAX
     19727**DCL     20082>>IF
MAX_USERS.BUDGET.MACCT IN PROCEDURE COMPARE_FROM_TO_MAX
     19717**DCL     19721--REDEF
MAX_USERS.BUDGET.MAXC IN PROCEDURE COMPARE_FROM_TO_MAX
     19706**DCL     20073>>IF      20073>>IF      20076>>ASSIGN
MAX_USERS.BUDGET.MAX_PROJECTS IN PROCEDURE COMPARE_FROM_TO_MAX
     19730**DCL     19733--REDEF
MAX_USERS.BUDGET.PACCUM IN PROCEDURE COMPARE_FROM_TO_MAX
     19713**DCL     19715--REDEF
MAX_USERS.BUDGET.PCHARGES IN PROCEDURE COMPARE_FROM_TO_MAX
     19726**DCL     20079>>IF
MAX_USERS.BUDGET.PMAXC IN PROCEDURE COMPARE_FROM_TO_MAX
     19708**DCL     19710--REDEF
MAX_USERS.KEY IN PROCEDURE COMPARE_FROM_TO_MAX
     19737**DCL     20257>>IF
MAX_USERS.MDO IN PROCEDURE COMPARE_FROM_TO_MAX
     19748**DCL     20119>>IF      20121>>ASSIGN  20122>>IF      20123>>ASSIGN
MAX_USERS.MFPOOLS IN PROCEDURE COMPARE_FROM_TO_MAX
     19756**DCL     20163>>IF      20165>>ASSIGN  20166>>IF      20167>>ASSIGN
MAX_USERS.MLO IN PROCEDURE COMPARE_FROM_TO_MAX
     19746**DCL     20108>>IF      20110>>ASSIGN  20111>>IF      20112>>ASSIGN
MAX_USERS.MMEM IN PROCEDURE COMPARE_FROM_TO_MAX
     19796**DCL     20202>>IF      20204>>ASSIGN  20205>>IF      20206>>ASSIGN
MAX_USERS.MMPRIO IN PROCEDURE COMPARE_FROM_TO_MAX
     19758**DCL     20174>>IF      20176>>ASSIGN  20177>>IF      20178>>ASSIGN
MAX_USERS.MPDIS IN PROCEDURE COMPARE_FROM_TO_MAX
     19752**DCL     20141>>IF      20143>>ASSIGN  20144>>IF      20145>>ASSIGN
MAX_USERS.MPO IN PROCEDURE COMPARE_FROM_TO_MAX
     19750**DCL     20130>>IF      20132>>ASSIGN  20133>>IF      20134>>ASSIGN
MAX_USERS.MTDIS IN PROCEDURE COMPARE_FROM_TO_MAX
     19754**DCL     20152>>IF      20154>>ASSIGN  20155>>IF      20156>>ASSIGN
MAX_USERS.MTIME IN PROCEDURE COMPARE_FROM_TO_MAX
     19793**DCL     20188>>IF      20190>>ASSIGN  20191>>IF      20192>>ASSIGN
MAX_USERS.OUTPUTPRIO IN PROCEDURE COMPARE_FROM_TO_MAX
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:464  
     19739**DCL     20094>>IF      20096>>ASSIGN
MAX_USERS.PPRIV IN PROCEDURE COMPARE_FROM_TO_MAX
     19776**DCL     20227>>IF
MAX_USERS.PRIV IN PROCEDURE COMPARE_FROM_TO_MAX
     19775**DCL     20216>>IF
MAX_USERS.SETUP_CHRA.TXT IN PROCEDURE COMPARE_FROM_TO_MAX
     19828**DCL     19829--REDEF   19830--REDEF
MERR_CODE
     11882**DCL     18954<>CALL    19332<>CALL
MERR_CODE.CODE
     11882**DCL     16143>>IF      16180>>IF      18932>>IF      19313>>IF
MOD_PROJ_ADMIN_REC IN PROCEDURE REMOVE_USER_PROJECT
     19141**PROC    19010--CALL    19026--CALL
MOD_PROJ_TO_USER IN PROCEDURE CREATE_MOD_USER
     17800**ENTRY   16726--CALL
MOD_USER_TO_PROJ IN PROCEDURE CREATE_MOD_USER
     17689**ENTRY   16723--CALL
MORE
     15031**DCL     16285<<ASSIGN  16302>>DOWHILE 16741<<ASSIGN  16824>>IF      16845>>IF
NEXT IN PROCEDURE GET_ACCT_LIST
     18835**LABEL   18813--GOTO    18827--GOTO
NODE IN PROCEDURE PARSE_CMD
     18306**DCL     18304--PROC    18308--IF      18309--ASSIGN
NODE$
     11879**DCL     15927--IMP-PTR 16316<<ASSIGN  16318>>ASSIGN  16625>>ASSIGN  16998>>ASSIGN  17069<<ASSIGN
     17070>>ASSIGN  17078<<ASSIGN  17079>>ASSIGN  17269>>ASSIGN  17284>>IF      17288>>ASSIGN  17530>>ASSIGN
     17545>>IF      17549>>ASSIGN  17702>>ASSIGN  17814>>ASSIGN  18014>>ASSIGN  18071>>ASSIGN  18150>>ASSIGN
     18155>>ASSIGN  18234>>ASSIGN  18239>>ASSIGN  18312<<ASSIGN  18313>>ASSIGN  18713>>IF      18715>>ASSIGN
     18995>>ASSIGN  18996>>ASSIGN  18997>>ASSIGN  19224>>CALL
NO_ACCT IN PROCEDURE GET_ACCT_LIST
     18812**LABEL   18773--CALLALT
NO_MATCH IN PROCEDURE GET_ACCT_LIST
     18833**LABEL   18828--CALLALT
NO_PROJ_REC IN PROCEDURE CREATE_MOD_USER
     18196**LABEL   18189--CALLALT
OPEN_LO_FPT
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:465  
     15474**DCL     15379--DCLINIT
OPEN_LO_FPT.ACSVEH_
     15476**DCL     15477--REDEF
OPEN_LO_FPT.ALTKEYS_
     15482**DCL     15483--REDEF   15483--REDEF
OPEN_LO_FPT.HDR_
     15481**DCL     15482--REDEF
OPEN_LO_FPT.TAB_
     15480**DCL     15481--REDEF
OPEN_LO_FPT.UHL_
     15474**DCL     15475--REDEF   15475--REDEF
OPEN_LO_FPT.V
     15483**DCL     15474--DCLINIT
OPEN_LO_FPT.V.FSN#
     15514**DCL     15514--REDEF   15514--REDEF
OPEN_LO_FPT.WSN_
     15480**DCL     15480--REDEF
OUT$SYM.COUNT
     15997**DCL     16000--IMP-SIZ 16999>>IF      17025>>ASSIGN  17026>>ASSIGN  17045>>CALLBLT 17045>>CALLBLT
     17050>>ASSIGN  17057>>CALLBLT 17066>>CALLBLT 17067>>ASSIGN  17075>>CALLBLT 17076>>ASSIGN  17090>>ASSIGN
     17091>>ASSIGN  17114>>CALLBLT 17116>>CALLBLT 18729>>ASSIGN  18732>>ASSIGN  18733>>ASSIGN
OUT$SYM.TEXT
     16000**DCL     17026>>ASSIGN  17045>>CALLBLT 17045>>CALLBLT 17050>>ASSIGN  17057>>CALLBLT 17066>>CALLBLT
     17075>>CALLBLT 17091>>ASSIGN  17114>>CALLBLT 17116>>CALLBLT 18729>>ASSIGN  18732>>ASSIGN  18733>>ASSIGN
OUT$SYM.TEXTC$
     15992**DCL     17018<>CALL
OUTPUT_ERROR_CNT
     16845**LABEL   16183--GOTO
OUT_BUF
     11878**DCL     16288<<CALLBLT 16289<>CALL    16289--CALL    16890<<CALLBLT 16894<>CALL    16931<<CALLBLT
     16935<>CALL    19291<<ASSIGN  19295<<CALLBLT 19299<>CALL    19299--CALL
P$NODE
     15927**DCL     17270<>CALL    17289<>CALL    17531<>CALL    17550<>CALL    17703<>CALL    17815<>CALL
     18015<>CALL    18072<>CALL    18151<>CALL    18156<>CALL    18235<>CALL    18240<>CALL    18999<>CALL
     19224<>CALL
P$NODE.CODE
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:466  
     15935**DCL     16318>>ASSIGN  16625>>ASSIGN  17070>>ASSIGN  17079>>ASSIGN  18313>>ASSIGN  18995>>ASSIGN
     18997>>ASSIGN
P$NODE.SUBLK$
     15960**DCL     16625>>ASSIGN  16998>>ASSIGN  17269>>ASSIGN  17288>>ASSIGN  17530>>ASSIGN  17549>>ASSIGN
     17702>>ASSIGN  17814>>ASSIGN  18014>>ASSIGN  18071>>ASSIGN  18150>>ASSIGN  18155>>ASSIGN  18234>>ASSIGN
     18239>>ASSIGN  18313>>ASSIGN  18715>>ASSIGN  18725>>ASSIGN  18729>>ASSIGN  18729>>ASSIGN  18732>>ASSIGN
     18732>>ASSIGN  18733>>ASSIGN  18733>>ASSIGN  18996>>ASSIGN  18997>>ASSIGN  19224>>CALL    19224>>CALL
P$NODE.SUBNODES
     15939**DCL     17284>>IF      17545>>IF      18713>>IF      18716>>IF      18724>>DOINDEX 18727>>IF
PACKSET IN PROCEDURE GET_ACCT_LIST
     18702**DCL     18758<<ASSIGN  18761<>CALL    18766<>CALL    18770>>DOWHILE 18828<>CALL    18845--ASSIGN
     18846>>ASSIGN  18870--ASSIGN  18871>>ASSIGN  18891>>DOWHILE
PACKSET IN PROCEDURE READ_PROJ_REC
     18910**DCL     18905--PROC    18917>>ASSIGN  18935>>ASSIGN
PACKSET$LIST IN PROCEDURE CREATE_MOD_USER
     17158**DCL     18609--ASSIGN  18610--ASSIGN
PACKSET$LIST.MAX_NUM_GRANS IN PROCEDURE CREATE_MOD_USER
     17167**DCL     18625>>IF
PACKSET$LIST.NUM_ACCTS IN PROCEDURE CREATE_MOD_USER
     17175**DCL     18648>>IF
PACKSET$LIST.PSN IN PROCEDURE CREATE_MOD_USER
     17177**DCL     18000>>ASSIGN  18607<<ASSIGN  18621<>CALL    18623<>CALL    18629--ASSIGN  18630>>ASSIGN
     18653--ASSIGN  18654>>ASSIGN
PACKSET$LIST.SKELETON IN PROCEDURE CREATE_MOD_USER
     17171**DCL     18623<>CALL
PACKSET$LIST.SUB_PROJ_ACCTS IN PROCEDURE CREATE_MOD_USER
     17165**DCL     18648>>IF
PACKSET_COUNT IN PROCEDURE CREATE_MOD_USER
     17141**DCL     17794<>CALL    17937<>CALL    17999>>DOINDEX 18112<>CALL    18114<>CALL    18127>>IF
     18130>>DOINDEX 18278<>CALL    18288<>CALL    18289>>IF      18292>>DOINDEX 18599<<ASSIGN  18607>>ASSIGN
     18608<<ASSIGN  18608>>ASSIGN  18610>>ASSIGN  18614>>IF      18620>>DOINDEX
PADMIN
     11881**DCL     16087<<ASSIGN  16105<<ASSIGN  16107>>IF      16291>>IF      16329>>IF      16351>>IF
     16399>>IF      16418>>IF      16514>>IF      19219>>IF
PAR$ IN PROCEDURE CREATE_MOD_USER
     17135**DCL     17269<<ASSIGN  17270>>CALL    17288<<ASSIGN  17289>>CALL    17530<<ASSIGN  17531>>CALL
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:467  
     17549<<ASSIGN  17550>>CALL    17702<<ASSIGN  17703>>CALL    17814<<ASSIGN  17815>>CALL    18014<<ASSIGN
     18015>>CALL    18071<<ASSIGN  18072>>CALL    18150<<ASSIGN  18151>>CALL    18155<<ASSIGN  18156>>CALL
     18234<<ASSIGN  18235>>CALL    18239<<ASSIGN  18240>>CALL    18715<<ASSIGN  18716>>IF      18724>>DOINDEX
     18725>>ASSIGN
PAR$ IN PROCEDURE REMOVE_USER_PROJECT
     18990**DCL     18996<<ASSIGN  18999>>CALL
PARSE_CMD IN PROCEDURE CREATE_MOD_USER
     18304**PROC    17257--CALL    17517--CALL
PARSE_ERR IN PROCEDURE PARSE_CMD
     18319**LABEL   18310--CALLALT
PART1 IN PROCEDURE RECONFIG_TIGR_STATION
     16981**DCL     17045>>CALLBLT
PART10 IN PROCEDURE RECONFIG_TIGR_STATION
     16990**DCL     17116>>CALLBLT
PART2 IN PROCEDURE RECONFIG_TIGR_STATION
     16982**DCL     17045>>CALLBLT
PART3 IN PROCEDURE RECONFIG_TIGR_STATION
     16983**DCL     17047>>CALLBLT
PART4 IN PROCEDURE RECONFIG_TIGR_STATION
     16984**DCL     17047>>CALLBLT
PART5 IN PROCEDURE RECONFIG_TIGR_STATION
     16985**DCL     17057>>CALLBLT
PART6 IN PROCEDURE RECONFIG_TIGR_STATION
     16986**DCL     17057>>CALLBLT
PART7 IN PROCEDURE RECONFIG_TIGR_STATION
     16987**DCL     17114>>CALLBLT
PART8 IN PROCEDURE RECONFIG_TIGR_STATION
     16988**DCL     17114>>CALLBLT
PART9 IN PROCEDURE RECONFIG_TIGR_STATION
     16989**DCL     17116>>CALLBLT
PROJ$ IN PROCEDURE READ_PROJ_REC
     18911**DCL     18905--PROC    18921>>IF      18924<>CALL    18928<>CALL
PROJ$LIST IN PROCEDURE CREATE_MOD_USER
     17242**DCL     17774--ASSIGN
PROJ$LIST.ACCT IN PROCEDURE CREATE_MOD_USER
     17243**DCL     17766<<ASSIGN  17983>>ASSIGN  18779>>DOWHILE 18782>>IF      18821>>DOWHILE 18825>>IF
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:468  
PROJ$LIST.GRANS IN PROCEDURE CREATE_MOD_USER
     17244**DCL     17767<<ASSIGN  17984>>ASSIGN  18784>>ASSIGN
PROJECT IN PROCEDURE CHECK_CREATE_OK
     18370**DCL     18368--PROC    18395>>IF      18405<>CALL    18429<>CALL    18486<>CALL    18546<>CALL
PROJECT IN PROCEDURE READ_PROJ_REC
     18907**DCL     18905--PROC    18936<>CALL
PROJECT.TEXT IN PROCEDURE READ_PROJ_REC
     18909**DCL     18916>>ASSIGN
PROJECT_DOESNT_EXIST IN PROCEDURE MAKEME
     19306**LABEL   19236--CALLALT
PROJ_ACCT_LIST$ IN PROCEDURE CREATE_MOD_USER
     17136**DCL     17242--IMP-PTR 17755<<ASSIGN  17766>>ASSIGN  17767>>ASSIGN  17774>>ASSIGN  17785>>ASSIGN
     17979<<ASSIGN  17983>>ASSIGN  17984>>ASSIGN  18776<<ASSIGN  18779>>DOWHILE 18782>>IF      18784>>ASSIGN
     18818<<ASSIGN  18821>>DOWHILE 18825>>IF
PROJ_ADMIN_KEY IN PROCEDURE MAKEME
     19205**DCL     19213<<ASSIGN  19216<<ASSIGN  19220<<ASSIGN  19221<<ASSIGN  19224<>CALL    19229>>IF
     19229>>IF      19235>>ASSIGN  19242>>IF      19285>>ASSIGN  19306<>CALL    19315>>ASSIGN
PROJ_ADMIN_KEY.CNT IN PROCEDURE MAKEME
     19206**DCL     19265>>ASSIGN
PROJ_ADMIN_KEY.TEXT IN PROCEDURE MAKEME
     19207**DCL     19262>>CALLBLT 19263>>CALLBLT 19263>>CALLBLT
PROJ_FLAG IN PROCEDURE CREATE_MOD_USER
     17138**DCL     17256<<ASSIGN  17270<>CALL    17280<>CALL    17289<>CALL    17298<>CALL    17319<>CALL
     17516<<ASSIGN  17531<>CALL    17541<>CALL    17550<>CALL    17555<>CALL    17599<>CALL    17692<<ASSIGN
     17804<<ASSIGN  17815<>CALL    18013<<ASSIGN  18070<<ASSIGN  18149<<ASSIGN  18233<<ASSIGN  18380>>IF
     18389>>IF      18390<>CALL    18391<>CALL    18396>>IF      18571<>CALL
PROJ_FLAG IN PROCEDURE REMOVE_USER_PROJECT
     18979**DCL     18977--PROC    18999<>CALL    19002>>IF      19005<>CALL    19013<>CALL    19020<>CALL
     19023>>IF      19088>>IF
PROJ_KEY
     11758**DCL     17752<<ASSIGN  17973<<ASSIGN  17998<<ASSIGN  18128<<ASSIGN  18185<<ASSIGN  18290<<ASSIGN
     18600<<ASSIGN
PROJ_KEY.COUNT
     11759**DCL     17762<<ASSIGN  17784<<ASSIGN  17982>>ASSIGN  18002<<ASSIGN  18188<<ASSIGN  18607>>ASSIGN
     18919<<ASSIGN  18934>>ASSIGN
PROJ_KEY.TEXT
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:469  
     11759**DCL     11759--REDEF   17761>>CALLBLT 17783>>CALLBLT 18001>>CALLBLT 18187>>CALLBLT 18607>>ASSIGN
     18918>>CALLBLT
PROJ_KEY.TXT.PACKSET
     11760**DCL     17760<<ASSIGN  17765>>DOWHILE 17782<<ASSIGN  17982>>ASSIGN  18000<<ASSIGN  18186<<ASSIGN
     18917<<ASSIGN
PROJ_KEY.TXT.PROJECT
     11759**DCL     11759--REDEF   17978>>DOWHILE 18605>>DOWHILE 18916<<ASSIGN
PTR$ IN PROCEDURE CREATE_MOD_USER
     17134**DCL     18603<<ASSIGN  18604<>CALL    18609<<ASSIGN  18609>>ASSIGN  18611<>CALL    18725<<ASSIGN
     18727>>IF      18729>>ASSIGN  18729>>ASSIGN  18732>>ASSIGN  18732>>ASSIGN  18733>>ASSIGN  18733>>ASSIGN
P_PCB
     11914**DCL     16314<>CALL    17068<>CALL    17077<>CALL    18310<>CALL
P_PCB.ERROR
     12018**DCL     18319<>CALL
P_PCB.NCHARS
     12061**DCL     16313<<ASSIGN  17067<<ASSIGN  17076<<ASSIGN
P_PCB.OUT$
     11927**DCL     16316>>ASSIGN  16323>>ASSIGN  17069>>ASSIGN  17078>>ASSIGN  18312>>ASSIGN
P_PCB.ROOT$
     11919**DCL     16299<<ASSIGN  16802<<ASSIGN  18309<<ASSIGN
P_PCB.U$$
     11932**DCL     16242<<ASSIGN
READ_PROJ_REC IN PROCEDURE CREATE_MOD_USER
     18905**PROC    18621--CALL    18761--CALL    18766--CALL
RECONFIG_TIGR_STATION
     16947**PROC    16738--CALL
RECON_PROMPT IN PROCEDURE RECONFIG_TIGR_STATION
     16980**DCL     17050<<ASSIGN  17051<>CALL    17051--CALL
REMEM_VAR
     11885**DCL     11885--REDEF   16309<<REMEMBR
REMOVE_USER_PROJECT
     18977**PROC    16660--CALL    16663--CALL
REM_FCMD
     11885**DCL     11886--REDEF
REM_STA IN PROCEDURE RECONFIG_TIGR_STATION
     16978**DCL     17066>>CALLBLT 17067--ASSIGN
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:470  
REM_WSN IN PROCEDURE RECONFIG_TIGR_STATION
     16979**DCL     17075>>CALLBLT 17076--ASSIGN
SIZEC_DREC
     15032**DCL     17360>>ASSIGN  17417>>ASSIGN  17429>>ASSIGN  17636>>ASSIGN  17647>>ASSIGN  18378>>ASSIGN
     18385>>ASSIGN
SKIP_PACKSET IN PROCEDURE GET_ACCT_LIST
     18891**LABEL   18761--CALLALT 18766--CALLALT
SUPERAUTH
     11880**DCL     16082<<ASSIGN  16093<<ASSIGN  16107>>IF      16329>>IF      16351>>IF      16376>>IF
     16399>>IF      16418>>IF      16514>>IF      19219>>IF      19242>>IF      20078>>IF
SUPERD
     11880**DCL     16102<<ASSIGN  16107>>IF      16351>>IF      16418>>IF      19219>>IF
SUPERFORM
     11880**DCL     16084<<ASSIGN  16099<<ASSIGN  16107>>IF      16490>>IF
SUPERWSN
     11880**DCL     16083<<ASSIGN  16096<<ASSIGN  16107>>IF      16461>>IF
SUPER_ERR
     16824**LABEL   16314--CALLALT
SUPER_TO_PIG
     15889**DCL     19163<>CALL
SUPER_TO_PIG.ACCT
     15910**DCL     18360<<ASSIGN  18581<<ASSIGN  19161<<ASSIGN
SUPER_TO_PIG.ATTR.COUNT
     15912**DCL     15915--IMP-SIZ 18361<<ASSIGN  19162<<ASSIGN  19163>>CALL
SUPER_TO_PIG.PACKSET
     15909**DCL     19160<<ASSIGN
SUPER_TO_PIG.PROJ
     15898**DCL     18356<<ASSIGN  19157<<ASSIGN
SUPER_TO_PIG.PROJECT
     15905**DCL     15908--REDEF
SUPER_TO_PIG.PROJECT_TEXT
     15908**DCL     18359<<ASSIGN  19159<<ASSIGN
SUPER_TO_PIG.RESUPER
     15904**DCL     18357<<ASSIGN  19158<<ASSIGN
SUPER_TO_PIG.SUPER
     15901**DCL     15904--REDEF
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:471  
SUPER_TO_PIG.TYPE
     15890**DCL     19155<<ASSIGN
SUPER_TO_PIG.WIDTH
     15900**DCL     18358<<ASSIGN  19156<<ASSIGN
TEMP_PRIV IN PROCEDURE COMPARE_FROM_TO_MAX
     20027**DCL     20213<<ASSIGN  20214>>IF      20214>>IF      20216>>IF      20216>>IF      20218>>ASSIGN
     20224<<ASSIGN  20225>>IF      20225>>IF      20227>>IF      20227>>IF      20229>>ASSIGN  20236<<ASSIGN
     20237>>IF      20237>>IF      20239>>IF      20239>>IF      20241>>ASSIGN  20247<<ASSIGN  20248>>IF
     20248>>IF      20250>>IF      20250>>IF      20252>>ASSIGN
TIE_PROJ IN PROCEDURE CREATE_MOD_USER
     18230**ENTRY   16720--CALL
TIE_USER IN PROCEDURE CREATE_MOD_USER
     18146**ENTRY   16717--CALL
TYPE IN PROCEDURE CREATE_MOD_USER
     17139**DCL     17270<>CALL    17280<>CALL    17531<>CALL    17541<>CALL    18313<<ASSIGN  18314>>ASSIGN
     18571<>CALL
TYPE IN PROCEDURE REMOVE_USER_PROJECT
     18991**DCL     18995<<ASSIGN  18999<>CALL    19005<>CALL    19013<>CALL    19020<>CALL
T_ERR_CODE
     15873**DCL     16078<<ASSIGN  16174<<ASSIGN  16207<<ASSIGN  16294>>ASSIGN
UBIN$WORD
     16063**DCL     18574<<ASSIGN  18575<<ASSIGN  18576<<ASSIGN  18577<<ASSIGN
UNTIE_PROJ IN PROCEDURE CREATE_MOD_USER
     18067**ENTRY   16714--CALL
UNTIE_USER IN PROCEDURE CREATE_MOD_USER
     18010**ENTRY   16711--CALL
USERS_HLP_ERR
     16174**LABEL   16137--CALLALT
USERS_KEY
     11756**DCL     17275<<ASSIGN  17291<<ASSIGN  17318<<ASSIGN  17329<<ASSIGN  17349<<ASSIGN  17404<>CALL
     17524<<ASSIGN  17536<<ASSIGN  17553<<ASSIGN  17598<<ASSIGN  17612<<ASSIGN  17625<<ASSIGN  17697<<ASSIGN
     17705<<ASSIGN  17809<<ASSIGN  17817<<ASSIGN  18016<<ASSIGN  18054<<ASSIGN  18060<<ASSIGN  18073<<ASSIGN
     18104<<ASSIGN  18110<<ASSIGN  18116<<ASSIGN  18152<<ASSIGN  18222<<ASSIGN  18236<<ASSIGN  18265<<ASSIGN
     18276<<ASSIGN  18578<>CALL    18580>>ASSIGN  18999<>CALL    19024>>ASSIGN  19235<<ASSIGN  19239<>CALL
     19252<<ASSIGN
USERS_KEY.COUNT
PL6.E3A0      #001=ASA$SUPER File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:46 Page:472  
     11756**DCL     17265<<ASSIGN  17366<<ASSIGN  17395<<ASSIGN  17638<<ASSIGN  17654<<ASSIGN  17684<<ASSIGN
     17728<<ASSIGN  17939<<ASSIGN  17995<<ASSIGN  18048<<ASSIGN  18118<<ASSIGN  18124<<ASSIGN  18181<<ASSIGN
     18283<<ASSIGN  18382<<ASSIGN  19003>>ASSIGN  19128<<ASSIGN  19144<<ASSIGN
USERS_KEY.SKEY.CREATOR
     11758**DCL     17393<<ASSIGN  17652<<ASSIGN  18122<<ASSIGN
USERS_KEY.SKEY.PROJ
     11758**DCL     17392<<ASSIGN  17651<<ASSIGN  18121<<ASSIGN
USERS_KEY.SKEY.USER
     11758**DCL     17394<<ASSIGN  17653<<ASSIGN  18123<<ASSIGN
USERS_KEY.TEXT
     11756**DCL     11757--REDEF   11757--REDEF   11757--REDEF   11758--REDEF   17639<<ASSIGN  18383<<ASSIGN
USERS_KEY.TXTC
     11757**DCL     17264<<CALLBLT 17365<<CALLBLT 17683<<CALLBLT 17729<<CALLBLT 17940<<CALLBLT 17996<<CALLBLT
     18047<<CALLBLT 18180<<CALLBLT 18284<<CALLBLT 18581>>ASSIGN  19004>>ASSIGN  19129<<CALLBLT 19145<<CALLBLT
USERS_KEY.UKEY.ACCT
     11757**DCL     17351<>CALL    17627<>CALL
USERS_KEY.UKEY.S
     11758**DCL     18119<<ASSIGN
WARN_CNT
     11889**DCL     16897>>IF      16899>>IF      16909<>CALL    16943>>IF
WRITE_ERR1 IN PROCEDURE CREATE_MOD_USER
     17777**LABEL   17775--CALLALT
WRITE_ERR2 IN PROCEDURE CREATE_MOD_USER
     17788**LABEL   17786--CALLALT
WSN_INDEX IN PROCEDURE RECONFIG_TIGR_STATION
     16992**DCL     17018<>CALL    17088<>CALL
X$PARSE
     15525**DCL-ENT 16314--CALL    17068--CALL    17077--CALL    18310--CALL
XUG$OPENOUT
     15833**DCL-ENT 16324--CALL
XUG_GETCMD
     15082**DCL     16324<>CALL
XUG_GETCMD.OUT$
     15087**DCL     15093--REDEF
XUG_GETCMD.UTIL$
     15383**DCL     16323<<ASSIGN

PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:473  
     2669        1        /*M* ASA$ERROR - special purpose error reporting rountine.      */
     2670        2        /*T***********************************************************/
     2671        3        /*T*                                                         */
     2672        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2673        5        /*T*                                                         */
     2674        6        /*T***********************************************************/
     2675        7        ASA$ERROR: PROC ( KEY, ERRCODE, PROJ_FLAG );
     2676        8                                                                   /**/
     2677        9        /********************************************************************/
     2678       10        /*    Parameters      parameters      parameters      parameters    */
     2679       11        /********************************************************************/
     2680       12
     2681       13    1   DCL 1 KEY ALIGNED ,
     2682       14    1          2 CNT UBIN(9) UNAL ,
     2683       15    1          2 TEXT CHAR(20) UNAL ;
     2684       16    1   DCL ERRCODE   UBIN;
     2685       17    1   DCL PROJ_FLAG BIT(1) ALIGNED;
     2686       18                                                                 /**/
     2687       19        /********************************************************************/
     2688       20        /*    Include files   include files   include files   include files */
     2689       21        /********************************************************************/
     2690       22
     2691       23        %INCLUDE           AS_ENTRIES_M ;
     2692     1073        %INCLUDE           AS_MAC_C     ;
     2693     1153        %INCLUDE           AS_SUPER_C   ;
     2694     1588        %INCLUDE           XU_MACRO_C   ;
     2695     4694        %INCLUDE           XU_FORMAT_C  ;
     2696     4856        %INCLUDE           KL_SUPER_C   ;
     2697     7758        %INCLUDE           AS_SUBS_C    ;
     2698     9172        %INCLUDE           AS_PERR_C    ;
     2699     9774        %INCLUDE           B_ERRORS_C   ;
     2700    10901        %INCLUDE           AS_SUPER_R   ;
     2701    13917
     2702    13918        /*******************************************************************/
     2703    13919        /*    Constant data   constant data   constant data   constant data*/
     2704    13920        /*******************************************************************/
     2705    13921
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:474  
     2706    13922    1   DCL ERRORS(0:9) CHAR(1) CONSTANT INIT( BINASC(E$ALREADY_EXISTS),
     2707    13923    1             BINASC(E$DOESNT_EXIST), BINASC(E$WRONG_TYPE),
     2708    13924    1             BINASC(E$FROM_HLP_NO_EXIST), BINASC(E$UNABLE_TO_READ_USERS),
     2709    13925    1             BINASC(E$UNABLE_TO_READ_HLP), BINASC(E$NOT_IN_PROJ),
     2710    13926    1             BINASC(E$EXISTS_AND_NOT), BINASC(E$NOT_BELOW),
     2711    13927    1             BINASC(E$CANT_UNTIE) ) ;
     2712    13928    1   DCL ERROR_CODES REDEF ERRORS CHAR(10) ;
     2713    13929
     2714    13930    1   DCL 1 PROJECT_TEXTC ALIGNED CONSTANT,
     2715    13931    1          2 * UBIN BYTE UNAL INIT( LENGTHC('project') ),
     2716    13932    1          2 * CHAR(0) INIT('project');
     2717    13933    1   DCL 1 USER_TEXTC ALIGNED CONSTANT,
     2718    13934    1          2 * UBIN BYTE UNAL INIT( LENGTHC('user') ),
     2719    13935    1          2 * CHAR(0) INIT('user');
     2720    13936
     2721    13937        /********************************************************************/
     2722    13938        /*    Auto data   auto data   auto data   auto data   auto data     */
     2723    13939        /********************************************************************/
     2724    13940
     2725    13941    1   DCL J SBIN ;
     2726    13942    1   DCL I SBIN;
     2727    13943    1   DCL TYPE UBIN;
     2728    13944    1   DCL T_ERR_CODE BIT(36);
     2729    13945    1   DCL T_DCBNUM#  UBIN;
     2730    13946                                                                   /**/
     2731    13947        /********************************************************************/
     2732    13948        /*    Entry dcls  entry dcls  entry dcls  entry dcls  entry dcls    */
     2733    13949        /********************************************************************/
     2734    13950
     2735    13951        %ASH$ERROR ;
     2736    13954        %ASH$WARN ;
     2737    13957        %ASA$KEYCONV ;
     2738    13960
     2739    13961        /********************************************************************/
     2740    13962        /*    Procedure   procedure   procedure   procedure   procedure     */
     2741    13963        /********************************************************************/
     2742    13964
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:475  
     2743    13965
     2744    13966
     2745    13967    1   CALL INDEX( TYPE, BINASC(ERRCODE), ERROR_CODES ) ;
     2746    13968    2   DO SELECT( TYPE );
     2747    13969    2      SELECT( 1 );
     2748    13970    3      IF MERR_CODE.CODE ~= %E$NOKEY THEN DO;
     2749    13971    3         TYPE = 4;
     2750    13972    3         GOTO SAVE_ERR_CODE;
     2751    13973    3         END;
     2752    13974    2      SELECT( 3 );
     2753    13975    3      IF MERR_CODE.CODE ~= %E$NOKEY THEN DO;
     2754    13976    3         TYPE = 5;
     2755    13977    3         GOTO SAVE_ERR_CODE;
     2756    13978    3         END;
     2757    13979    2      SELECT( 4, 5 );
     2758    13980    2   SAVE_ERR_CODE:
     2759    13981    2      T_ERR_CODE = MERR_CODE;
     2760    13982    2      T_DCBNUM#  = AS_DCBNUM#;
     2761    13983    2      SELECT( 6, 8, 9 );
     2762    13984    2      CALL ASA$KEYCONV( AS_PROJECT_ADMIN, AS_FIELD3 );
     2763    13985    2      END;
     2764    13986
     2765    13987    1   CALL ASA$KEYCONV( KEY, AS_FIELD1 );
     2766    13988    1   IF ADDR(PROJ_FLAG) ~= ADDR(NIL) THEN
     2767    13989    1      IF PROJ_FLAG
     2768    13990    1      THEN AS_FIELD2 = PROJECT_TEXTC;
     2769    13991    1      ELSE AS_FIELD2 = USER_TEXTC;
     2770    13992                                                              /**/
     2771    13993    2   DO SELECT( TYPE );
     2772    13994    2      SELECT( 0 );
     2773    13995        /*E*  ERROR:    ASA-E$ALREADY_EXISTS-C
     2774    13996              MESSAGE:  The %U2 "%U1" already exists.
     2775    13997        */
     2776    13998                                                              /**/
     2777    13999           %SCREAM( ERR#=E$ALREADY_EXISTS, LEVEL=ERROR, MID='A' );
     2778    14014
     2779    14015    2      SELECT( 1 );
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:476  
     2780    14016                                                              /**/
     2781    14017        /*E*  ERROR:    ASA-E$DOESNT_EXIST-C
     2782    14018              MESSAGE:  The %U2 "%U1" does not exist.
     2783    14019        */
     2784    14020           %SCREAM( ERR#=E$DOESNT_EXIST, LEVEL=WARN, MID='A' );
     2785    14035
     2786    14036    2      SELECT( 2 );
     2787    14037        /*E* ERROR:   ASA-E$WRONG_TYPE-C
     2788    14038             MESSAGE: "%U1" is a %U3, not a %U2.
     2789    14039        */
     2790    14040    2      IF PROJ_FLAG
     2791    14041    2      THEN AS_FIELD3 = USER_TEXTC ;
     2792    14042    2      ELSE AS_FIELD3 = PROJECT_TEXTC ;
     2793    14043           %SCREAM( ERR#=E$WRONG_TYPE, LEVEL=ERROR, MID='A' );
     2794    14058
     2795    14059    2      SELECT( 3 );
     2796    14060        /*E*  ERROR:    ASA-E$FROM_HLP_NO_EXIST-C
     2797    14061              MESSAGE:  Record "%U1" does not exist in :HLP.
     2798    14062                        Creating a record from default.
     2799    14063        */
     2800    14064           %SCREAM( ERR#=E$FROM_HLP_NO_EXIST, LEVEL=ERROR, MID='A' );
     2801    14079
     2802    14080
     2803    14081    2      SELECT( 4 );
     2804    14082        /*E*  ERROR:    ASA-E$UNABLE_TO_READ_USERS-C
     2805    14083              MESSAGE: Unable to read the record "%U1" from the :USERS file.
     2806    14084        */
     2807    14085           %SCREAM( ERR#=E$UNABLE_TO_READ_USERS, LEVEL=ERROR, MID='A' );
     2808    14100    2      AS_DCBNUM# = T_DCBNUM#;
     2809    14101    2      CALL ASH$ERROR( T_ERR_CODE );
     2810    14102
     2811    14103    2      SELECT( 5 );
     2812    14104        /*E*  ERROR:    ASA-E$UNABLE_TO_READ_HLP-C
     2813    14105              MESSAGE: Unable to read the record "%U1" from the :HLP file.
     2814    14106        */
     2815    14107           %SCREAM( ERR#=E$UNABLE_TO_READ_HLP, LEVEL=ERROR, MID='A' );
     2816    14122    2      AS_DCBNUM# = T_DCBNUM#;
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:477  
     2817    14123    2      CALL ASH$ERROR( T_ERR_CODE );
     2818    14124
     2819    14125    2      SELECT( 6 );
     2820    14126        /*E*  ERROR:    ASA-E$NOT_IN_PROJ-C
     2821    14127              MESSAGE: The %U2 "%U1" is not a member of project "%U3".
     2822    14128        */
     2823    14129           %SCREAM( ERR#=E$NOT_IN_PROJ, LEVEL=ERROR, MID='A' );
     2824    14144
     2825    14145    2      SELECT( 7 );
     2826    14146        /*E*  ERROR:      ASA-E$EXISTS_AND_NOT-C
     2827    14147              MESSAGE: "%U1" already exists and is a %U3, not a %U2.
     2828    14148        */
     2829    14149    2      IF PROJ_FLAG
     2830    14150    2      THEN AS_FIELD3 = USER_TEXTC;
     2831    14151    2      ELSE AS_FIELD3 = PROJECT_TEXTC;
     2832    14152           %SCREAM( ERR#=E$EXISTS_AND_NOT, LEVEL=ERROR, MID='A' );
     2833    14167
     2834    14168    2      SELECT( 8 );
     2835    14169        /*E*  ERROR:      ASA-E$NOT_BELOW-C
     2836    14170              MESSAGE: The %U2 "%U1" is not a member of project "%U3" or
     2837    14171                       any of its sub-projects.
     2838    14172        */
     2839    14173           %SCREAM( ERR#=E$NOT_BELOW, LEVEL=ERROR, MID='A' );
     2840    14188
     2841    14189    2      SELECT( 9 );
     2842    14190        /*E*  ERROR:      ASA-E$CANT_UNTIE-C
     2843    14191              MESSAGE: Project "%U3" cannot UNTIE a %U2 from project "%U3".
     2844    14192              MESSAGE1: A project administrator can only untie users or projects
     2845    14193                        that are in sub-projects below him. "%U1" is a %U2 in
     2846    14194                        project "%U3".
     2847    14195        */
     2848    14196           %SCREAM( ERR#=E$CANT_UNTIE, LEVEL=ERROR, MID='A' );
     2849    14211
     2850    14212    2      END;
     2851    14213    1   RETURN ;
     2852    14214    1   END ASA$ERROR ;
     2853    14215        %EOD ;
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:478  

PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:479  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASA$ERROR.

   Procedure ASA$ERROR requires 193 words for executable code.
   Procedure ASA$ERROR requires 14 words of local(AUTO) storage.

PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:480  

 Object Unit name= ASA$ERROR                                  File name= ASA$SUPER.:E05TOU
 UTS= JUL 29 '97 08:52:18.32 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     17     21  ASA$ERROR
    2   Proc  even  none   193    301  ASA$ERROR
    3  RoData even  none    14     16  ASA$ERROR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        3  ASA$ERROR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASA$KEYCONV
         yes           Std       2 ASH$ERROR
         yes           Std       2 ASH$WARN
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:481  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     ERR_CODE                              AS_FIELD1                             AS_FIELD2
     AS_FIELD3                             REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          AS_PROJECT_ADMIN                      AS_DCBNUM#
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:482  


     2669        1        /*M* ASA$ERROR - special purpose error reporting rountine.      */
     2670        2        /*T***********************************************************/
     2671        3        /*T*                                                         */
     2672        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2673        5        /*T*                                                         */
     2674        6        /*T***********************************************************/
     2675        7        ASA$ERROR: PROC ( KEY, ERRCODE, PROJ_FLAG );

      7  2 000000   000000 700200 xent  ASA$ERROR    TSX0  ! X66_AUTO_3
         2 000001   000016 000003                    ZERO    14,3

     2676        8                                                                   /**/
     2677        9        /********************************************************************/
     2678       10        /*    Parameters      parameters      parameters      parameters    */
     2679       11        /********************************************************************/
     2680       12
     2681       13    1   DCL 1 KEY ALIGNED ,
     2682       14    1          2 CNT UBIN(9) UNAL ,
     2683       15    1          2 TEXT CHAR(20) UNAL ;
     2684       16    1   DCL ERRCODE   UBIN;
     2685       17    1   DCL PROJ_FLAG BIT(1) ALIGNED;
     2686       18                                                                 /**/
     2687       19        /********************************************************************/
     2688       20        /*    Include files   include files   include files   include files */
     2689       21        /********************************************************************/
     2690       22
     2691       23        %INCLUDE           AS_ENTRIES_M ;
     2692     1073        %INCLUDE           AS_MAC_C     ;
     2693     1153        %INCLUDE           AS_SUPER_C   ;
     2694     1588        %INCLUDE           XU_MACRO_C   ;
     2695     4694        %INCLUDE           XU_FORMAT_C  ;
     2696     4856        %INCLUDE           KL_SUPER_C   ;
     2697     7758        %INCLUDE           AS_SUBS_C    ;
     2698     9172        %INCLUDE           AS_PERR_C    ;
     2699     9774        %INCLUDE           B_ERRORS_C   ;
     2700    10901        %INCLUDE           AS_SUPER_R   ;
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:483  
     2701    13917
     2702    13918        /*******************************************************************/
     2703    13919        /*    Constant data   constant data   constant data   constant data*/
     2704    13920        /*******************************************************************/
     2705    13921
     2706    13922    1   DCL ERRORS(0:9) CHAR(1) CONSTANT INIT( BINASC(E$ALREADY_EXISTS),
     2707    13923    1             BINASC(E$DOESNT_EXIST), BINASC(E$WRONG_TYPE),
     2708    13924    1             BINASC(E$FROM_HLP_NO_EXIST), BINASC(E$UNABLE_TO_READ_USERS),
     2709    13925    1             BINASC(E$UNABLE_TO_READ_HLP), BINASC(E$NOT_IN_PROJ),
     2710    13926    1             BINASC(E$EXISTS_AND_NOT), BINASC(E$NOT_BELOW),
     2711    13927    1             BINASC(E$CANT_UNTIE) ) ;
     2712    13928    1   DCL ERROR_CODES REDEF ERRORS CHAR(10) ;
     2713    13929
     2714    13930    1   DCL 1 PROJECT_TEXTC ALIGNED CONSTANT,
     2715    13931    1          2 * UBIN BYTE UNAL INIT( LENGTHC('project') ),
     2716    13932    1          2 * CHAR(0) INIT('project');
     2717    13933    1   DCL 1 USER_TEXTC ALIGNED CONSTANT,
     2718    13934    1          2 * UBIN BYTE UNAL INIT( LENGTHC('user') ),
     2719    13935    1          2 * CHAR(0) INIT('user');
     2720    13936
     2721    13937        /********************************************************************/
     2722    13938        /*    Auto data   auto data   auto data   auto data   auto data     */
     2723    13939        /********************************************************************/
     2724    13940
     2725    13941    1   DCL J SBIN ;
     2726    13942    1   DCL I SBIN;
     2727    13943    1   DCL TYPE UBIN;
     2728    13944    1   DCL T_ERR_CODE BIT(36);
     2729    13945    1   DCL T_DCBNUM#  UBIN;
     2730    13946                                                                   /**/
     2731    13947        /********************************************************************/
     2732    13948        /*    Entry dcls  entry dcls  entry dcls  entry dcls  entry dcls    */
     2733    13949        /********************************************************************/
     2734    13950
     2735    13951        %ASH$ERROR ;
     2736    13954        %ASH$WARN ;
     2737    13957        %ASA$KEYCONV ;
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:484  
     2738    13960
     2739    13961        /********************************************************************/
     2740    13962        /*    Procedure   procedure   procedure   procedure   procedure     */
     2741    13963        /********************************************************************/
     2742    13964
     2743    13965
     2744    13966
     2745    13967    1   CALL INDEX( TYPE, BINASC(ERRCODE), ERROR_CODES ) ;

  13967  2 000002   200004 470500                    LDP0    @ERRCODE,,AUTO
         2 000003   000000 236100                    LDQ     0,,PR0
         2 000004   000033 736000                    QLS     27
         2 000005   000000 276000 3                  ORQ     0
         2 000006   200014 756100                    STQ     T_DCBNUM#+2,,AUTO
         2 000007   000100 124400                    SCM     mask='000'O
         2 000010   000000 000012 1                  ADSC9   ERRORS                   cn=0,n=10
         2 000011   200014 000001                    ADSC9   T_DCBNUM#+2,,AUTO        cn=0,n=1
         2 000012   200010 000100                    ARG     TYPE,,AUTO

     2746    13968    2   DO SELECT( TYPE );

  13968  2 000013   200010 236100                    LDQ     TYPE,,AUTO
         2 000014   000005 116007                    CMPQ    5,DL
         2 000015   000030 602000 2                  TNC     s:13968+13
         2 000016   000057 600000 2                  TZE     SAVE_ERR_CODE
         2 000017   000010 116007                    CMPQ    8,DL
         2 000020   000025 602000 2                  TNC     s:13968+10
         2 000021   000064 600000 2                  TZE     s:13984
         2 000022   000011 116007                    CMPQ    9,DL
         2 000023   000070 601000 2                  TNZ     s:13987
         2 000024   000064 710000 2                  TRA     s:13984
         2 000025   000006 116007                    CMPQ    6,DL
         2 000026   000070 601000 2                  TNZ     s:13987
         2 000027   000064 710000 2                  TRA     s:13984
         2 000030   000003 116007                    CMPQ    3,DL
         2 000031   000036 602000 2                  TNC     s:13968+19
         2 000032   000050 600000 2                  TZE     s:13975
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:485  
         2 000033   000004 116007                    CMPQ    4,DL
         2 000034   000070 601000 2                  TNZ     s:13987
         2 000035   000057 710000 2                  TRA     SAVE_ERR_CODE
         2 000036   000001 116007                    CMPQ    1,DL
         2 000037   000070 601000 2                  TNZ     s:13987
         2 000040   000041 710000 2                  TRA     s:13970

     2747    13969    2      SELECT( 1 );

     2748    13970    3      IF MERR_CODE.CODE ~= %E$NOKEY THEN DO;

  13970  2 000041   000000 236000 xsym               LDQ     ERR_CODE
         2 000042   377770 376007                    ANQ     131064,DL
         2 000043   001020 116007                    CMPQ    528,DL
         2 000044   000070 600000 2                  TZE     s:13987

     2749    13971    3         TYPE = 4;

  13971  2 000045   000004 235007                    LDA     4,DL
         2 000046   200010 755100                    STA     TYPE,,AUTO

     2750    13972    3         GOTO SAVE_ERR_CODE;

  13972  2 000047   000057 710000 2                  TRA     SAVE_ERR_CODE

     2751    13973    3         END;
     2752    13974    2      SELECT( 3 );

     2753    13975    3      IF MERR_CODE.CODE ~= %E$NOKEY THEN DO;

  13975  2 000050   000000 236000 xsym               LDQ     ERR_CODE
         2 000051   377770 376007                    ANQ     131064,DL
         2 000052   001020 116007                    CMPQ    528,DL
         2 000053   000070 600000 2                  TZE     s:13987

     2754    13976    3         TYPE = 5;

PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:486  
  13976  2 000054   000005 235007                    LDA     5,DL
         2 000055   200010 755100                    STA     TYPE,,AUTO

     2755    13977    3         GOTO SAVE_ERR_CODE;

  13977  2 000056   000057 710000 2                  TRA     SAVE_ERR_CODE

     2756    13978    3         END;
     2757    13979    2      SELECT( 4, 5 );

     2758    13980    2   SAVE_ERR_CODE:
     2759    13981    2      T_ERR_CODE = MERR_CODE;

  13981  2 000057   000000 236000 xsym  SAVE_ERR_CO* LDQ     ERR_CODE
         2 000060   200011 756100                    STQ     T_ERR_CODE,,AUTO

     2760    13982    2      T_DCBNUM#  = AS_DCBNUM#;

  13982  2 000061   000000 235000 xsym               LDA     AS_DCBNUM#
         2 000062   200012 755100                    STA     T_DCBNUM#,,AUTO
         2 000063   000070 710000 2                  TRA     s:13987

     2761    13983    2      SELECT( 6, 8, 9 );

     2762    13984    2      CALL ASA$KEYCONV( AS_PROJECT_ADMIN, AS_FIELD3 );

  13984  2 000064   000001 630400 3                  EPPR0   1
         2 000065   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000066   000000 701000 xent               TSX1    ASA$KEYCONV
         2 000067   000000 011000                    NOP     0

     2763    13985    2      END;

     2764    13986
     2765    13987    1   CALL ASA$KEYCONV( KEY, AS_FIELD1 );

  13987  2 000070   000003 236000 3                  LDQ     3
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:487  
         2 000071   200003 235100                    LDA     @KEY,,AUTO
         2 000072   200014 757100                    STAQ    T_DCBNUM#+2,,AUTO
         2 000073   200014 630500                    EPPR0   T_DCBNUM#+2,,AUTO
         2 000074   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000075   000000 701000 xent               TSX1    ASA$KEYCONV
         2 000076   000000 011000                    NOP     0

     2766    13988    1   IF ADDR(PROJ_FLAG) ~= ADDR(NIL) THEN

  13988  2 000077   200005 236100                    LDQ     @PROJ_FLAG,,AUTO
         2 000100   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000101   000114 600000 2                  TZE     s:13993

     2767    13989    1      IF PROJ_FLAG

  13989  2 000102   200005 470500                    LDP0    @PROJ_FLAG,,AUTO
         2 000103   000000 234100                    SZN     0,,PR0
         2 000104   000111 605000 2                  TPL     s:13991

     2768    13990    1      THEN AS_FIELD2 = PROJECT_TEXTC;

  13990  2 000105   000000 100400                    MLR     fill='000'O
         2 000106   000003 000010 1                  ADSC9   PROJECT_TEXTC            cn=0,n=8
         2 000107   000000 000051 xsym               ADSC9   AS_FIELD2                cn=0,n=41
         2 000110   000114 710000 2                  TRA     s:13993

     2769    13991    1      ELSE AS_FIELD2 = USER_TEXTC;

  13991  2 000111   000000 100400                    MLR     fill='000'O
         2 000112   000005 000005 1                  ADSC9   USER_TEXTC               cn=0,n=5
         2 000113   000000 000051 xsym               ADSC9   AS_FIELD2                cn=0,n=41

     2770    13992                                                              /**/
     2771    13993    2   DO SELECT( TYPE );

  13993  2 000114   200010 236100                    LDQ     TYPE,,AUTO
         2 000115   000003 116007                    CMPQ    3,DL
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:488  
         2 000116   000142 602000 2                  TNC     s:13993+22
         2 000117   000204 600000 2                  TZE     s:14076
         2 000120   000007 116007                    CMPQ    7,DL
         2 000121   000131 602000 2                  TNC     s:13993+13
         2 000122   000250 600000 2                  TZE     s:14149
         2 000123   000010 116007                    CMPQ    8,DL
         2 000124   000300 602000 2                  TNC     s:14213
         2 000125   000267 600000 2                  TZE     s:14185
         2 000126   000011 116007                    CMPQ    9,DL
         2 000127   000300 601000 2                  TNZ     s:14213
         2 000130   000274 710000 2                  TRA     s:14208
         2 000131   000005 116007                    CMPQ    5,DL
         2 000132   000137 602000 2                  TNC     s:13993+19
         2 000133   000226 600000 2                  TZE     s:14119
         2 000134   000006 116007                    CMPQ    6,DL
         2 000135   000300 601000 2                  TNZ     s:14213
         2 000136   000243 710000 2                  TRA     s:14141
         2 000137   000004 116007                    CMPQ    4,DL
         2 000140   000300 601000 2                  TNZ     s:14213
         2 000141   000211 710000 2                  TRA     s:14097
         2 000142   000001 116007                    CMPQ    1,DL
         2 000143   000150 602000 2                  TNC     s:13993+28
         2 000144   000160 600000 2                  TZE     s:14030
         2 000145   000002 116007                    CMPQ    2,DL
         2 000146   000300 601000 2                  TNZ     s:14213
         2 000147   000165 710000 2                  TRA     s:14040
         2 000150   000000 116003                    CMPQ    0,DU
         2 000151   000153 600000 2                  TZE     s:14011
         2 000152   000300 710000 2                  TRA     s:14213

     2772    13994    2      SELECT( 0 );

     2773    13995        /*E*  ERROR:    ASA-E$ALREADY_EXISTS-C
     2774    13996              MESSAGE:  The %U2 "%U1" already exists.
     2775    13997        */
     2776    13998                                                              /**/
     2777    13999           %SCREAM( ERR#=E$ALREADY_EXISTS, LEVEL=ERROR, MID='A' );
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:489  

  14011  2 000153   000004 630400 3                  EPPR0   4
         2 000154   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000155   000000 701000 xent               TSX1    ASH$ERROR
         2 000156   000000 011000                    NOP     0
         2 000157   000300 710000 2                  TRA     s:14213

     2778    14014
     2779    14015    2      SELECT( 1 );

     2780    14016                                                              /**/
     2781    14017        /*E*  ERROR:    ASA-E$DOESNT_EXIST-C
     2782    14018              MESSAGE:  The %U2 "%U1" does not exist.
     2783    14019        */
     2784    14020           %SCREAM( ERR#=E$DOESNT_EXIST, LEVEL=WARN, MID='A' );

  14030  2 000160   000005 630400 3                  EPPR0   5
         2 000161   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000162   000000 701000 xent               TSX1    ASH$WARN
         2 000163   000000 011000                    NOP     0
         2 000164   000300 710000 2                  TRA     s:14213

     2785    14035
     2786    14036    2      SELECT( 2 );

     2787    14037        /*E* ERROR:   ASA-E$WRONG_TYPE-C
     2788    14038             MESSAGE: "%U1" is a %U3, not a %U2.
     2789    14039        */
     2790    14040    2      IF PROJ_FLAG

  14040  2 000165   200005 470500                    LDP0    @PROJ_FLAG,,AUTO
         2 000166   000000 234100                    SZN     0,,PR0
         2 000167   000174 605000 2                  TPL     s:14042

     2791    14041    2      THEN AS_FIELD3 = USER_TEXTC ;

  14041  2 000170   000000 100400                    MLR     fill='000'O
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:490  
         2 000171   000005 000005 1                  ADSC9   USER_TEXTC               cn=0,n=5
         2 000172   000000 000051 xsym               ADSC9   AS_FIELD3                cn=0,n=41
         2 000173   000177 710000 2                  TRA     s:14055

     2792    14042    2      ELSE AS_FIELD3 = PROJECT_TEXTC ;

  14042  2 000174   000000 100400                    MLR     fill='000'O
         2 000175   000003 000010 1                  ADSC9   PROJECT_TEXTC            cn=0,n=8
         2 000176   000000 000051 xsym               ADSC9   AS_FIELD3                cn=0,n=41

     2793    14043           %SCREAM( ERR#=E$WRONG_TYPE, LEVEL=ERROR, MID='A' );

  14055  2 000177   000006 630400 3                  EPPR0   6
         2 000200   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000201   000000 701000 xent               TSX1    ASH$ERROR
         2 000202   000000 011000                    NOP     0
         2 000203   000300 710000 2                  TRA     s:14213

     2794    14058
     2795    14059    2      SELECT( 3 );

     2796    14060        /*E*  ERROR:    ASA-E$FROM_HLP_NO_EXIST-C
     2797    14061              MESSAGE:  Record "%U1" does not exist in :HLP.
     2798    14062                        Creating a record from default.
     2799    14063        */
     2800    14064           %SCREAM( ERR#=E$FROM_HLP_NO_EXIST, LEVEL=ERROR, MID='A' );

  14076  2 000204   000007 630400 3                  EPPR0   7
         2 000205   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000206   000000 701000 xent               TSX1    ASH$ERROR
         2 000207   000000 011000                    NOP     0
         2 000210   000300 710000 2                  TRA     s:14213

     2801    14079
     2802    14080
     2803    14081    2      SELECT( 4 );

PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:491  
     2804    14082        /*E*  ERROR:    ASA-E$UNABLE_TO_READ_USERS-C
     2805    14083              MESSAGE: Unable to read the record "%U1" from the :USERS file.
     2806    14084        */
     2807    14085           %SCREAM( ERR#=E$UNABLE_TO_READ_USERS, LEVEL=ERROR, MID='A' );

  14097  2 000211   000010 630400 3                  EPPR0   8
         2 000212   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000213   000000 701000 xent               TSX1    ASH$ERROR
         2 000214   000000 011000                    NOP     0

     2808    14100    2      AS_DCBNUM# = T_DCBNUM#;

  14100  2 000215   200012 235100                    LDA     T_DCBNUM#,,AUTO
         2 000216   000000 755000 xsym               STA     AS_DCBNUM#

     2809    14101    2      CALL ASH$ERROR( T_ERR_CODE );

  14101  2 000217   200011 630500                    EPPR0   T_ERR_CODE,,AUTO
         2 000220   200014 450500                    STP0    T_DCBNUM#+2,,AUTO
         2 000221   200014 630500                    EPPR0   T_DCBNUM#+2,,AUTO
         2 000222   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000223   000000 701000 xent               TSX1    ASH$ERROR
         2 000224   000000 011000                    NOP     0
         2 000225   000300 710000 2                  TRA     s:14213

     2810    14102
     2811    14103    2      SELECT( 5 );

     2812    14104        /*E*  ERROR:    ASA-E$UNABLE_TO_READ_HLP-C
     2813    14105              MESSAGE: Unable to read the record "%U1" from the :HLP file.
     2814    14106        */
     2815    14107           %SCREAM( ERR#=E$UNABLE_TO_READ_HLP, LEVEL=ERROR, MID='A' );

  14119  2 000226   000011 630400 3                  EPPR0   9
         2 000227   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000230   000000 701000 xent               TSX1    ASH$ERROR
         2 000231   000000 011000                    NOP     0
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:492  

     2816    14122    2      AS_DCBNUM# = T_DCBNUM#;

  14122  2 000232   200012 235100                    LDA     T_DCBNUM#,,AUTO
         2 000233   000000 755000 xsym               STA     AS_DCBNUM#

     2817    14123    2      CALL ASH$ERROR( T_ERR_CODE );

  14123  2 000234   200011 630500                    EPPR0   T_ERR_CODE,,AUTO
         2 000235   200014 450500                    STP0    T_DCBNUM#+2,,AUTO
         2 000236   200014 630500                    EPPR0   T_DCBNUM#+2,,AUTO
         2 000237   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000240   000000 701000 xent               TSX1    ASH$ERROR
         2 000241   000000 011000                    NOP     0
         2 000242   000300 710000 2                  TRA     s:14213

     2818    14124
     2819    14125    2      SELECT( 6 );

     2820    14126        /*E*  ERROR:    ASA-E$NOT_IN_PROJ-C
     2821    14127              MESSAGE: The %U2 "%U1" is not a member of project "%U3".
     2822    14128        */
     2823    14129           %SCREAM( ERR#=E$NOT_IN_PROJ, LEVEL=ERROR, MID='A' );

  14141  2 000243   000012 630400 3                  EPPR0   10
         2 000244   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000245   000000 701000 xent               TSX1    ASH$ERROR
         2 000246   000000 011000                    NOP     0
         2 000247   000300 710000 2                  TRA     s:14213

     2824    14144
     2825    14145    2      SELECT( 7 );

     2826    14146        /*E*  ERROR:      ASA-E$EXISTS_AND_NOT-C
     2827    14147              MESSAGE: "%U1" already exists and is a %U3, not a %U2.
     2828    14148        */
     2829    14149    2      IF PROJ_FLAG
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:493  

  14149  2 000250   200005 470500                    LDP0    @PROJ_FLAG,,AUTO
         2 000251   000000 234100                    SZN     0,,PR0
         2 000252   000257 605000 2                  TPL     s:14151

     2830    14150    2      THEN AS_FIELD3 = USER_TEXTC;

  14150  2 000253   000000 100400                    MLR     fill='000'O
         2 000254   000005 000005 1                  ADSC9   USER_TEXTC               cn=0,n=5
         2 000255   000000 000051 xsym               ADSC9   AS_FIELD3                cn=0,n=41
         2 000256   000262 710000 2                  TRA     s:14164

     2831    14151    2      ELSE AS_FIELD3 = PROJECT_TEXTC;

  14151  2 000257   000000 100400                    MLR     fill='000'O
         2 000260   000003 000010 1                  ADSC9   PROJECT_TEXTC            cn=0,n=8
         2 000261   000000 000051 xsym               ADSC9   AS_FIELD3                cn=0,n=41

     2832    14152           %SCREAM( ERR#=E$EXISTS_AND_NOT, LEVEL=ERROR, MID='A' );

  14164  2 000262   000013 630400 3                  EPPR0   11
         2 000263   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000264   000000 701000 xent               TSX1    ASH$ERROR
         2 000265   000000 011000                    NOP     0
         2 000266   000300 710000 2                  TRA     s:14213

     2833    14167
     2834    14168    2      SELECT( 8 );

     2835    14169        /*E*  ERROR:      ASA-E$NOT_BELOW-C
     2836    14170              MESSAGE: The %U2 "%U1" is not a member of project "%U3" or
     2837    14171                       any of its sub-projects.
     2838    14172        */
     2839    14173           %SCREAM( ERR#=E$NOT_BELOW, LEVEL=ERROR, MID='A' );

  14185  2 000267   000014 630400 3                  EPPR0   12
         2 000270   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:494  
         2 000271   000000 701000 xent               TSX1    ASH$ERROR
         2 000272   000000 011000                    NOP     0
         2 000273   000300 710000 2                  TRA     s:14213

     2840    14188
     2841    14189    2      SELECT( 9 );

     2842    14190        /*E*  ERROR:      ASA-E$CANT_UNTIE-C
     2843    14191              MESSAGE: Project "%U3" cannot UNTIE a %U2 from project "%U3".
     2844    14192              MESSAGE1: A project administrator can only untie users or projects
     2845    14193                        that are in sub-projects below him. "%U1" is a %U2 in
     2846    14194                        project "%U3".
     2847    14195        */
     2848    14196           %SCREAM( ERR#=E$CANT_UNTIE, LEVEL=ERROR, MID='A' );

  14208  2 000274   000015 630400 3                  EPPR0   13
         2 000275   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000276   000000 701000 xent               TSX1    ASH$ERROR
         2 000277   000000 011000                    NOP     0

     2849    14211
     2850    14212    2      END;

     2851    14213    1   RETURN ;

  14213  2 000300   000000 702200 xent               TSX2  ! X66_ARET
     2852    14214    1   END ASA$ERROR ;
     2853    14215        %EOD ;

PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:495  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASA$ERROR.
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:496  

 **** Variables and constants ****

  ****  Section 001 RoData ASA$ERROR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 ERRORS(0:9)                0-0-0/c CHAR(10)    r     1 ERROR_CODES
     3-0-0/w STRC(72)    r     1 PROJECT_TEXTC              5-0-0/w STRC(45)    r     1 USER_TEXTC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ERRCODE                   3-0-0/w PTR         r     1 @KEY
     5-0-0/w PTR         r     1 @PROJ_FLAG                *0-0-0/w UBIN        r     1 ERRCODE
    *0-0-0/w STRC(189)   r     1 KEY                       *0-0-0/w BIT         r     1 PROJ_FLAG
    10-0-0/w UBIN        r     1 TYPE                      12-0-0/w UBIN        r     1 T_DCBNUM#
    11-0-0/b BIT         r     1 T_ERR_CODE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 AS_DCBNUM#                 0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/w STRC(369)   r     1 AS_FIELD2                  0-0-0/w STRC(369)   r     1 AS_FIELD3
     0-0-0/c STRC(189)   r     1 AS_PROJECT_ADMIN           0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/b STRC        r     1 MERR_CODE


   Procedure ASA$ERROR requires 193 words for executable code.
   Procedure ASA$ERROR requires 14 words of local(AUTO) storage.
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:497  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:498  
          MINI XREF LISTING

ASA$KEYCONV
     13958**DCL-ENT 13984--CALL    13987--CALL
ASA_BRKS_LOC
     11065**DCL     11065--REDEF
ASH$ERROR
     13952**DCL-ENT 14011--CALL    14055--CALL    14076--CALL    14097--CALL    14101--CALL    14119--CALL
     14123--CALL    14141--CALL    14164--CALL    14185--CALL    14208--CALL
ASH$WARN
     13955**DCL-ENT 14030--CALL
AS_DCBNUM#
     11072**DCL     13982>>ASSIGN  14100<<ASSIGN  14122<<ASSIGN
AS_DEFAULT.BANNER_PERM
     11758**DCL     11759--REDEF
AS_DEFAULT.BUDGET.MACCT
     11663**DCL     11667--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11676**DCL     11679--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11659**DCL     11661--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11654**DCL     11656--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     11774**DCL     11775--REDEF   11776--REDEF
AS_DEFAULT_DREC.PASSWORD
     13028**DCL     13032--REDEF
AS_DEFAULT_DREC.RENAME
     13051**DCL     13052--REDEF
AS_DFLT.BANNER_PERM
     11580**DCL     11581--REDEF
AS_DFLT.BUDGET.MACCT
     11485**DCL     11489--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:499  
     11498**DCL     11501--REDEF
AS_DFLT.BUDGET.PACCUM
     11481**DCL     11483--REDEF
AS_DFLT.BUDGET.PMAXC
     11476**DCL     11478--REDEF
AS_DFLT.SETUP_CHRA.TXT
     11596**DCL     11597--REDEF   11598--REDEF
AS_FE_MODE
     10931**DCL     10932--REDEF
AS_FIELD1
     11061**DCL     13987<>CALL
AS_FIELD2
     11062**DCL     13990<<ASSIGN  13991<<ASSIGN
AS_FIELD3
     11062**DCL     13984<>CALL    14041<<ASSIGN  14042<<ASSIGN  14150<<ASSIGN  14151<<ASSIGN
AS_MODE
     10928**DCL     10930--REDEF
AS_MOD_USER.ACCESS
     13793**DCL     13794--REDEF
AS_MOD_USER.BANNER
     13780**DCL     13781--REDEF
AS_MOD_USER.BANNER_PERM
     13782**DCL     13783--REDEF
AS_MOD_USER.BILL
     13788**DCL     13789--REDEF
AS_MOD_USER.CPROC
     13784**DCL     13785--REDEF
AS_MOD_USER.FEBILL
     13864**DCL     13865--REDEF
AS_MOD_USER.FECXTMEM
     13881**DCL     13882--REDEF
AS_MOD_USER.FEMINTS
     13866**DCL     13867--REDEF
AS_MOD_USER.FEMMEM
     13877**DCL     13878--REDEF
AS_MOD_USER.FEMTIME
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:500  
     13875**DCL     13876--REDEF
AS_MOD_USER.FEPPRIV
     13872**DCL     13874--REDEF
AS_MOD_USER.FEPRIV
     13869**DCL     13871--REDEF
AS_MOD_USER.FORCE_BIT
     13778**DCL     13779--REDEF
AS_MOD_USER.KEY
     13860**DCL     13862--REDEF
AS_MOD_USER.LASTCPROC
     13786**DCL     13787--REDEF
AS_MOD_USER.LIMITS.DO_
     13834**DCL     13835--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     13850**DCL     13851--REDEF
AS_MOD_USER.LIMITS.LO
     13830**DCL     13831--REDEF
AS_MOD_USER.LIMITS.MEM
     13826**DCL     13827--REDEF
AS_MOD_USER.LIMITS.MPRIO
     13854**DCL     13855--REDEF
AS_MOD_USER.LIMITS.PDIS
     13842**DCL     13843--REDEF
AS_MOD_USER.LIMITS.PO
     13838**DCL     13839--REDEF
AS_MOD_USER.LIMITS.TDIS
     13846**DCL     13847--REDEF
AS_MOD_USER.LIMITS.TIME
     13822**DCL     13823--REDEF
AS_MOD_USER.MAXENQ
     13803**DCL     13804--REDEF
AS_MOD_USER.PERM_BIT
     13776**DCL     13777--REDEF
AS_MOD_USER.PPRIV
     13798**DCL     13800--REDEF
AS_MOD_USER.PRIOB
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:501  
     13805**DCL     13806--REDEF
AS_MOD_USER.PRIV
     13795**DCL     13797--REDEF
AS_MOD_USER.QUAN
     13801**DCL     13802--REDEF
AS_MOD_USER.SETUP
     13774**DCL     13775--REDEF
AS_PROJECT.BANNER_PERM
     12114**DCL     12115--REDEF
AS_PROJECT.BUDGET.MACCT
     12019**DCL     12023--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12032**DCL     12035--REDEF
AS_PROJECT.BUDGET.PACCUM
     12015**DCL     12017--REDEF
AS_PROJECT.BUDGET.PMAXC
     12010**DCL     12012--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12130**DCL     12131--REDEF   12132--REDEF
AS_PROJECT_ADMIN
     11069**DCL     13984<>CALL
AS_PROJECT_DFLT.BANNER_PERM
     12292**DCL     12293--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12197**DCL     12201--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12210**DCL     12213--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12193**DCL     12195--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12188**DCL     12190--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12308**DCL     12309--REDEF   12310--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13514**DCL     13518--REDEF
AS_PROJECT_DFLT_DREC.RENAME
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:502  
     13537**DCL     13538--REDEF
AS_PROJECT_DREC.PASSWORD
     13352**DCL     13356--REDEF
AS_PROJECT_DREC.RENAME
     13375**DCL     13376--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     11936**DCL     11937--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     11841**DCL     11845--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     11854**DCL     11857--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     11837**DCL     11839--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     11832**DCL     11834--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     11952**DCL     11953--REDEF   11954--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13190**DCL     13194--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13213**DCL     13214--REDEF
AS_USERS.BANNER_PERM
     11402**DCL     11403--REDEF
AS_USERS.BUDGET.MACCT
     11307**DCL     11311--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11320**DCL     11323--REDEF
AS_USERS.BUDGET.PACCUM
     11303**DCL     11305--REDEF
AS_USERS.BUDGET.PMAXC
     11298**DCL     11300--REDEF
AS_USERS.SETUP_CHRA.TXT
     11418**DCL     11419--REDEF   11420--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12470**DCL     12471--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:503  
     12375**DCL     12379--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     12388**DCL     12391--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     12371**DCL     12373--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     12366**DCL     12368--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12486**DCL     12487--REDEF   12488--REDEF
ERRCODE
        16**DCL         7--PROC    13967>>CALLBLT
ERRORS
     13922**DCL     13928--REDEF
ERROR_CODES
     13928**DCL     13967>>CALLBLT
ERR_CODE
     11060**DCL     11061--REDEF
KEY
        13**DCL         7--PROC    13987<>CALL
KL_DEFAULT.PASSWORD
     13676**DCL     13680--REDEF
KL_DEFAULT.RENAME
     13699**DCL     13700--REDEF
KL_DFLT.PASSWORD
     12866**DCL     12870--REDEF
KL_DFLT.RENAME
     12889**DCL     12890--REDEF
KL_DREC.PASSWORD
     12704**DCL     12708--REDEF
KL_DREC.RENAME
     12727**DCL     12728--REDEF
KL_DREC_CNT.PASSWORD
     12591**DCL     12595--REDEF
KL_DREC_CNT.RENAME
     12614**DCL     12615--REDEF
MERR_CODE
PL6.E3A0      #002=ASA$ERROR File=ASA$SUPER.:E05TSI                              TUE 07/29/97 08:52 Page:504  
     11061**DCL     13981>>ASSIGN
MERR_CODE.CODE
     11061**DCL     13970>>IF      13975>>IF
PROJECT_TEXTC
     13930**DCL     13990>>ASSIGN  14042>>ASSIGN  14151>>ASSIGN
PROJ_FLAG
        17**DCL         7--PROC    13988--IF      13989>>IF      14040>>IF      14149>>IF
PROJ_KEY.TEXT
     10938**DCL     10938--REDEF
PROJ_KEY.TXT.PROJECT
     10938**DCL     10938--REDEF
REMEM_VAR
     11064**DCL     11064--REDEF
REM_FCMD
     11064**DCL     11065--REDEF
SAVE_ERR_CODE
     13981**LABEL   13972--GOTO    13977--GOTO
TYPE
     13943**DCL     13967<<CALLBLT 13968>>DOSELCT 13971<<ASSIGN  13976<<ASSIGN  13993>>DOSELCT
T_DCBNUM#
     13945**DCL     13982<<ASSIGN  14100>>ASSIGN  14122>>ASSIGN
T_ERR_CODE
     13944**DCL     13981<<ASSIGN  14101<>CALL    14123<>CALL
USERS_KEY.TEXT
     10935**DCL     10936--REDEF   10936--REDEF   10936--REDEF   10937--REDEF
USER_TEXTC
     13933**DCL     13991>>ASSIGN  14041>>ASSIGN  14150>>ASSIGN

PL6.E3A0      #003=ASA$KEYCONV File=ASA$SUPER.:E05TSI                            TUE 07/29/97 08:53 Page:505  
     2854        1        /*T***********************************************************/
     2855        2        /*T*                                                         */
     2856        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2857        4        /*T*                                                         */
     2858        5        /*T***********************************************************/
     2859        6        ASA$KEYCONV: PROC ( KEY, FIELD );
     2860        7
     2861        8
     2862        9    1   DCL 1 KEY ALIGNED ,
     2863       10    1          2 CNT UBIN(9) UNAL ,
     2864       11    1          2 TEXT CHAR(20) UNAL ;
     2865       12    1   DCL 1 FIELD ALIGNED,
     2866       13    1          2 CNT UBIN(9) UNAL ,
     2867       14    1          2 TEXT CHAR(40) UNAL ;
     2868       15
     2869       16    1   DCL I SBIN;
     2870       17
     2871       18
     2872       19    1   IF KEY.CNT <= 8
     2873       20    1   THEN FIELD = KEY;
     2874       21    2   ELSE DO;
     2875       22    2      CALL INDEX( I, ' ', SUBSTR( KEY.TEXT,0,8) );
     2876       23    2      CALL CONCAT(FIELD.TEXT, SUBSTR(KEY.TEXT,0,I), ',',SUBSTR(KEY.TEXT,8));
     2877       24    2      FIELD.CNT = I + KEY.CNT - 7;
     2878       25    2      END;
     2879       26
     2880       27    1   END ASA$KEYCONV;

PL6.E3A0      #003=ASA$KEYCONV File=ASA$SUPER.:E05TSI                            TUE 07/29/97 08:53 Page:506  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASA$KEYCONV.

   Procedure ASA$KEYCONV requires 43 words for executable code.
   Procedure ASA$KEYCONV requires 6 words of local(AUTO) storage.

    No errors detected in file ASA$SUPER.:E05TSI    .

PL6.E3A0      #003=ASA$KEYCONV File=ASA$SUPER.:E05TSI                            TUE 07/29/97 08:53 Page:507  

 Object Unit name= ASA$KEYCONV                                File name= ASA$SUPER.:E05TOU
 UTS= JUL 29 '97 08:53:42.92 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    43     53  ASA$KEYCONV
    1  RoData even  none     1      1  ASA$KEYCONV

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        2  ASA$KEYCONV

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #003=ASA$KEYCONV File=ASA$SUPER.:E05TSI                            TUE 07/29/97 08:53 Page:508  


     2854        1        /*T***********************************************************/
     2855        2        /*T*                                                         */
     2856        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2857        4        /*T*                                                         */
     2858        5        /*T***********************************************************/
     2859        6        ASA$KEYCONV: PROC ( KEY, FIELD );

      6  0 000000   000000 700200 xent  ASA$KEYCONV  TSX0  ! X66_AUTO_2
         0 000001   000006 000002                    ZERO    6,2

     2860        7
     2861        8
     2862        9    1   DCL 1 KEY ALIGNED ,
     2863       10    1          2 CNT UBIN(9) UNAL ,
     2864       11    1          2 TEXT CHAR(20) UNAL ;
     2865       12    1   DCL 1 FIELD ALIGNED,
     2866       13    1          2 CNT UBIN(9) UNAL ,
     2867       14    1          2 TEXT CHAR(40) UNAL ;
     2868       15
     2869       16    1   DCL I SBIN;
     2870       17
     2871       18
     2872       19    1   IF KEY.CNT <= 8

     19  0 000002   200003 470500                    LDP0    @KEY,,AUTO
         0 000003   000000 236100                    LDQ     0,,PR0
         0 000004   777000 376003                    ANQ     -512,DU
         0 000005   011000 116003                    CMPQ    4608,DU
         0 000006   000014 603000 0                  TRC     s:22

     2873       20    1   THEN FIELD = KEY;

     20  0 000007   200004 471500                    LDP1    @FIELD,,AUTO
         0 000010   000100 100500                    MLR     fill='000'O
         0 000011   000000 000025                    ADSC9   0,,PR0                   cn=0,n=21
         0 000012   100000 000051                    ADSC9   0,,PR1                   cn=0,n=41
PL6.E3A0      #003=ASA$KEYCONV File=ASA$SUPER.:E05TSI                            TUE 07/29/97 08:53 Page:509  
         0 000013   000052 710000 0                  TRA     s:27

     2874       21    2   ELSE DO;

     2875       22    2      CALL INDEX( I, ' ', SUBSTR( KEY.TEXT,0,8) );

     22  0 000014   000000 124500                    SCM     mask='000'O
         0 000015   000000 200010                    ADSC9   0,,PR0                   cn=1,n=8
         0 000016   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         0 000017   200005 000100                    ARG     I,,AUTO

     2876       23    2      CALL CONCAT(FIELD.TEXT, SUBSTR(KEY.TEXT,0,I), ',',SUBSTR(KEY.TEXT,8));

     23  0 000020   200005 720100                    LXL0    I,,AUTO
         0 000021   200004 471500                    LDP1    @FIELD,,AUTO
         0 000022   040100 100540                    MLR     fill='040'O
         0 000023   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         0 000024   100000 200050                    ADSC9   0,,PR1                   cn=1,n=40
         0 000025   200005 236100                    LDQ     I,,AUTO
         0 000026   000050 116007                    CMPQ    40,DL
         0 000027   000044 605000 0                  TPL     s:24
         0 000030   777727 621006                    EAX1    -41,QL
         0 000031   777777 661003                    ERX1    -1,DU
         0 000032   040146 100400                    MLR     fill='040'O
         0 000033   000000 000001 1                  ADSC9   0                        cn=0,n=1
         0 000034   100000 200011                    ADSC9   0,Q,PR1                  cn=1,n=*X1
         0 000035   000047 116007                    CMPQ    39,DL
         0 000036   000044 605000 0                  TPL     s:24
         0 000037   777730 622006                    EAX2    -40,QL
         0 000040   777777 662003                    ERX2    -1,DU
         0 000041   040146 100500                    MLR     fill='040'O
         0 000042   000002 200014                    ADSC9   2,,PR0                   cn=1,n=12
         0 000043   100000 400012                    ADSC9   0,Q,PR1                  cn=2,n=*X2

     2877       24    2      FIELD.CNT = I + KEY.CNT - 7;

     24  0 000044   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #003=ASA$KEYCONV File=ASA$SUPER.:E05TSI                            TUE 07/29/97 08:53 Page:510  
         0 000045   000033 772000                    QRL     27
         0 000046   200005 036100                    ADLQ    I,,AUTO
         0 000047   000007 136007                    SBLQ    7,DL
         0 000050   000033 736000                    QLS     27
         0 000051   100000 552140                    STBQ    0,'40'O,PR1

     2878       25    2      END;

     2879       26
     2880       27    1   END ASA$KEYCONV;

     27  0 000052   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #003=ASA$KEYCONV File=ASA$SUPER.:E05TSI                            TUE 07/29/97 08:53 Page:511  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASA$KEYCONV.
PL6.E3A0      #003=ASA$KEYCONV File=ASA$SUPER.:E05TSI                            TUE 07/29/97 08:53 Page:512  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @FIELD                     3-0-0/w PTR         r     1 @KEY
    *0-0-0/w STRC(369)   r     1 FIELD                      5-0-0/w SBIN        r     1 I
    *0-0-0/w STRC(189)   r     1 KEY


   Procedure ASA$KEYCONV requires 43 words for executable code.
   Procedure ASA$KEYCONV requires 6 words of local(AUTO) storage.

    No errors detected in file ASA$SUPER.:E05TSI    .
PL6.E3A0      #003=ASA$KEYCONV File=ASA$SUPER.:E05TSI                            TUE 07/29/97 08:53 Page:513  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ASA$KEYCONV File=ASA$SUPER.:E05TSI                            TUE 07/29/97 08:53 Page:514  
          MINI XREF LISTING

FIELD
        12**DCL         6--PROC       20<<ASSIGN
FIELD.CNT
        13**DCL        24<<ASSIGN
FIELD.TEXT
        14**DCL        23<<CALLBLT
I
        16**DCL        22<<CALLBLT    23>>CALLBLT    24>>ASSIGN
KEY
         9**DCL         6--PROC       20>>ASSIGN
KEY.CNT
        10**DCL        19>>IF         24>>ASSIGN
KEY.TEXT
        11**DCL        22>>CALLBLT    23>>CALLBLT    23>>CALLBLT
