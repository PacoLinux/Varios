VERSION E05

PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:1    
        1        1        /*M*  KPI$IO_SVC - PIGETTE I/O Service Procedure                   */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*F*     NAME:          KPI$IO_SVC
        8        8                 PURPOSE:       All IO functions are done from here.
        9        9                 DESCRIPTIONS:  Opens, closes, reads, and writes are all done
       10       10                                from here rather than sprinkling them about
       11       11                                creation.
       12       12        */
       13       13        KPI$IO_SVC: PROC   (IO_TYPE)   ALTRET;
       14       14        /**/
       15       15        /* Include files */
       16       16        /**/
       17       17            %INCLUDE KP_DATA_R;
       18     1269            %INCLUDE CP_6_SUBS;
       19     1809        /**/
       20     1810        /* Local declarations */
       21     1811        /**/
       22     1812    1   DCL IO_TYPE UBIN WORD;
       23     1813    1   DCL 1 OBUF STATIC,
       24     1814    1         2 VFC CHAR(1) UNAL,
       25     1815    1         2 MESS CHAR(%KP_BUF_SIZE#) UNAL;
       26     1816    1   DCL 1 A_OBUF STATIC,
       27     1817    1         2 VFC CHAR(1) UNAL,
       28     1818    1         2 MESS CHAR(%KP_BUF_SIZE#) UNAL;
       29     1819    1   DCL TRUE BIT(1) CONSTANT INIT( '1'B );
       30     1820    1   DCL FALSE BIT(1) CONSTANT INIT( '0'B );
       31     1821    1   DCL EBUF CHAR(120) STATIC;
       32     1822        /**/
       33     1823        /* Symrefs */
       34     1824        /**/
       35     1825    1   DCL B$TCB$ PTR SYMREF;
       36     1826        %EJECT;
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:2    
       37     1827        /**/
       38     1828        /* Dcb declarations */
       39     1829        /**/
       40     1830    1   DCL M$RU DCB;
       41     1831    1   DCL M$DO DCB;
       42     1832    1   DCL M$PIGLET DCB;
       43     1833    1   DCL M$LL DCB;
       44     1834    1   DCL M$LO DCB;
       45     1835    1   DCL M$SI DCB;
       46     1836        /**/
       47     1837        /* ENTRY DCLS */
       48     1838        /**/
       49     1839        %KP_ENTRIES (OMIT=KPI$IO_SVC);
       50     1945        /**/
       51     1946        /* BASED */
       52     1947        /**/
       53     1948            %B$ALT;
       54     1956            %B$TCB;
       55     1959            %F$DCB (DCBN = F$DCB);
       56     2016        /**/
       57     2017        /* Fpts */
       58     2018        /**/
       59     2019            %FPT_CLOSE (FPTN = CLOSE_M$RU,
       60     2020                        DCB = M$RU,
       61     2021                        DISP = SAVE);
       62     2063            %FPT_CLOSE (FPTN = CLOSE_M$DO,
       63     2064                        DCB = M$DO);
       64     2106            %FPT_CLOSE (FPTN = CLOSE_PIGLET,
       65     2107                        DISP = SAVE,            /* WAIT until FPRG goes away          */
       66     2108                        DCB = M$PIGLET);
       67     2150            %FPT_CLOSE (FPTN = CLOSE_M$LL,
       68     2151                        DCB = M$LL);
       69     2193            %FPT_CLOSE (FPTN = CLOSE_M$LO,
       70     2194                        DCB = M$LO);
       71     2236            %FPT_CLOSE (FPTN = CLOSE_M$SI,
       72     2237                        DCB = M$SI);
       73     2279            %FPT_FID (FPTN = FID_M$RU,
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:3    
       74     2280                      ACCT = M$RU_ACCT,
       75     2281                      ASN = OPEN_M$RU.V.ASN#,
       76     2282                      NAME = M$RU_NAME,
       77     2283                      PASS = M$RU_PASS,
       78     2284                      RES = OPEN_M$RU.V.RES#,
       79     2285                      RESULTS = M$RU_RESULTS,
       80     2286                      SN = M$RU_SN,
       81     2287                      WSN = M$RU_WSN);
       82     2310            %FPT_UNFID (FPTN = UNFID_M$RU,
       83     2311                        DCB = M$RU,
       84     2312                        TEXTFID = KP_FILE_NAME);
       85     2330            %FPT_OPEN (FPTN = OPEN_M$RU,
       86     2331                       FPARAM = KP_FPARAM,
       87     2332                       ACCT = M$RU_ACCT,
       88     2333                       ACS = DIRECT,
       89     2334                       ASN = FILE,
       90     2335                       DCB = M$RU,
       91     2336                       EXIST = ERROR,           /* To be adjusted for DISP            */
       92     2337                       FUN = CREATE,
       93     2338                       CTG = YES,
       94     2339                       NAME = M$RU_NAME,
       95     2340                       ORG = KEYED,
       96     2341                       PASS = M$RU_PASS,
       97     2342                       REASSIGN = NO,
       98     2343                       SCRUB = YES,
       99     2344                       SN = M$RU_SN,
      100     2345                       TYPE = 'Rf',
      101     2346                       WSN = M$RU_WSN);
      102     2455            %FPT_OPEN (FPTN = OPEN_M$DO,
      103     2456                       DCB = M$DO);
      104     2565            %FPT_OPEN (FPTN = OPEN_PIGLET,
      105     2566                       DCB = M$PIGLET,
      106     2567                       ORG = FPRG,
      107     2568                       FPRG = HNDLR_FPRG,
      108     2569                       RES = 'FEnn',            /* To be adjusted for FEX             */
      109     2570                       ASN = DEVICE,
      110     2571                       FUN = CREATE);
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:4    
      111     2680            %FPT_OPEN (FPTN = OPEN_M$LL,
      112     2681                       DCB = M$LL);
      113     2790            %FPT_OPEN (FPTN = OPEN_M$LO,
      114     2791                       DCB = M$LO);
      115     2900            %FPT_OPEN (FPTN = OPEN_M$SI,
      116     2901                       DCB = M$SI);
      117     3010            %FPT_READ (FPTN = READ_M$RU,
      118     3011                       BUF = KP_INBUF,
      119     3012                       DCB = M$RU,
      120     3013                       KEY = KP_RU_KEY,
      121     3014                       KEYS = YES,
      122     3015                       TRANS = YES);
      123     3054            %FPT_READ (FPTN = READ_PIGLET,
      124     3055                       BUF = KP_FECG_IN,
      125     3056                       DCB = M$PIGLET,
      126     3057                       WAIT = YES);
      127     3096            %FPT_READ (FPTN = READ_COMMAND,
      128     3097                       BUF = KP_INBUF);
      129     3136            %FPT_WAIT (FPTN = WAIT_ONE,
      130     3137                       UNITS = 1);
      131     3151            %FPT_WRITE (FPTN = WRITE_M$RU,
      132     3152                        BUF = KP_RU_OUTBUF,
      133     3153                        DCB = M$RU,
      134     3154                        KEY = KP_RU_KEY);
      135     3185                %FPT_WRITE (FPTN = WRITE_M$DO,
      136     3186                  BUF = OBUF,
      137     3187                  DCB = M$DO,
      138     3188                  VFC = YES);
      139     3219                %FPT_WRITE (FPTN = WRITE_A_M$DO,
      140     3220                  BUF = A_OBUF,
      141     3221                  DCB = M$DO,
      142     3222                  VFC = YES);
      143     3253                %FPT_WRITE (FPTN = WRITE_PIGLET,
      144     3254                  BUF = KP_FECG_OUT,
      145     3255                  TRANS = YES,
      146     3256                  DCB = M$PIGLET);
      147     3287                %FPT_WRITE (FPTN = WRITE_M$LL,
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:5    
      148     3288                  BUF = OBUF,
      149     3289                  DCB = M$LL,
      150     3290                  VFC = YES);
      151     3321                %FPT_WRITE (FPTN = WRITE_M$LO,
      152     3322                  BUF = OBUF,
      153     3323                  DCB = M$LO,
      154     3324                  VFC = YES);
      155     3355                %FPT_WRITE (FPTN = WRITE_A_M$LO,
      156     3356                  BUF = A_OBUF,
      157     3357                  DCB = M$LO,
      158     3358                  VFC = YES);
      159     3389        /**/
      160     3390        /* Vlps and vlrs */
      161     3391        /**/
      162     3392                %VLP_ACCT (FPTN = M$RU_ACCT);
      163     3405                %VLP_FPRG (FPTN = HNDLR_FPRG,NAME = 'PIGLET',ACCT = ':SYS');
      164     3426                %VLP_NAME (FPTN = M$RU_NAME);
      165     3453                %VLP_PASS (FPTN = M$RU_PASS);
      166     3466                %VLP_SN (FPTN = M$RU_SN);
      167     3479                %VLP_WSN (FPTN = M$RU_WSN);
      168     3492                %VLP_WSN (FPTN = M$STMNT_WSN);
      169     3505                %VLR_FID (FPTN = M$RU_RESULTS);
      170     3524        %EJECT;
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:6    
      171     3525        /**/
      172     3526        /* Code starts here */
      173     3527        /**/
      174     3528    2             DO CASE (IO_TYPE);
      175     3529    2               CASE (%KP_IO_OPEN#);
      176     3530                                                /* Open M$DO, M$LL, M$LO and M$SI     */
      177     3531    2                 CALL M$OPEN (OPEN_M$DO);
      178     3532    2                 CALL M$OPEN (OPEN_M$LL);
      179     3533    2                 CALL M$OPEN (OPEN_M$LO);
      180     3534    2                 CALL M$OPEN (OPEN_M$SI);
      181     3535    2               CASE (%KP_DO_WRITE#, %KP_LL_WRITE#, %KP_LO_WRITE#);
      182     3536    2                 OBUF.MESS = KP_OUTBUF;
      183     3537    3                   DO CASE (KP_OUTVFC);
      184     3538    3                     CASE (%KP_SSPACE#);
      185     3539                                                /* Single space                       */
      186     3540    3                       OBUF.VFC = 'A';
      187     3541    3                     CASE (%KP_DSPACE#);
      188     3542                                                /* Double space                       */
      189     3543    3                       OBUF.VFC = 'B';
      190     3544    3                     CASE (ELSE);
      191     3545                                                /* Error - use single space           */
      192     3546    3                       OBUF.VFC = 'A';
      193     3547    3                     END;
      194     3548                                                /* Write on the correct dcb           */
      195     3549    3                   DO CASE (IO_TYPE);
      196     3550    3                     CASE (%KP_DO_WRITE#);
      197     3551                                                /* M$DO                               */
      198     3552    3                       CALL M$WRITE (WRITE_M$DO) ALTRET (MONERR);
      199     3553    3                     CASE (%KP_LL_WRITE#);
      200     3554                                                /* M$LL                               */
      201     3555    3                       CALL M$WRITE (WRITE_M$LL) ALTRET (MONERR);
      202     3556    3                     CASE (%KP_LO_WRITE#);
      203     3557                                                /* M$LO                               */
      204     3558    3                       CALL M$WRITE (WRITE_M$LO) ALTRET (MONERR);
      205     3559                                                /* No errors possible so no else case */
      206     3560    3                     END;
      207     3561
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:7    
      208     3562    2               CASE (%KP_SI_READ#);        /* Read from M$SI, at least 1 char.   */
      209     3563    2                 READ_COMMAND.V.DCB# = DCBNUM(M$SI);
      210     3564    2                 KP_INPUT_COUNT = 0;
      211     3565    2                 KP_INBUF = ' ';
      212     3566    3                 DO WHILE (KP_INPUT_COUNT = 0);
      213     3567    3                    CALL M$READ (READ_COMMAND) ALTRET (MONERR);
      214     3568    3                    KP_INPUT_COUNT = DCBADDR (READ_COMMAND.V.DCB#)->F$DCB.ARS#;
      215     3569    3                    END;
      216     3570
      217     3571    2               CASE (%KP_FECG_OPEN#);      /* Open a path to PIGLET              */
      218     3572    2                 CALL BINCHAR(KP_FEP_TEXT,KP_FEP_NO);
      219     3573    2                 CALL CONCAT (OPEN_PIGLET.V.RES#,'FE',KP_FEP_TEXT);
      220     3574    2                 CALL M$OPEN (OPEN_PIGLET) ALTRET (MONERR);
      221     3575
      222     3576    2               CASE (%KP_FECG_READ#);      /* Read something from PIGLET         */
      223     3577    2                 CALL M$READ (READ_PIGLET) ALTRET (MONERR);
      224     3578
      225     3579    2               CASE (%KP_FECG_WRITE#);     /* Write something to PIGLET          */
      226     3580    2                 WRITE_PIGLET.BUF_.BOUND = KP_FECG_OUT_SIZE - 1;
      227     3581    2                 CALL M$WRITE (WRITE_PIGLET) ALTRET (MONERR);
      228     3582
      229     3583    2               CASE (%KP_FECG_CLOSE#);     /* Close path, halt PIGETTE           */
      230     3584    2                 CALL M$CLOSE (CLOSE_PIGLET) ALTRET (MONERR);
      231     3585
      232     3586    2               CASE (%KP_RU_OPEN#);   /* Open M$RU to the file in KP_FILE_NAME   */
      233     3587    2                 OPEN_M$RU.V.EXIST# = %OLDFILE#;
      234     3588    2   COMMON_OPEN_M$RU: ;
      235     3589    2                 FID_M$RU.TEXTFID_ = VECTOR (KP_FILE_NAME);
      236     3590    2                 CALL M$FID (FID_M$RU) ALTRET (MONERR);
      237     3591    2                 CALL M$OPEN (OPEN_M$RU) ALTRET (MONERR);
      238     3592    2                 IF DCBADDR(DCBNUM(M$RU)) -> F$DCB.FFLG.EXEC# THEN
      239     3593    3                    DO;
      240     3594    3                      CALL M$CLOSE (CLOSE_M$RU) ALTRET (MONERR);
      241     3595    3                      CALL KPE$ERROR(%E$OPENED_EXEC);
      242     3596    3                      GOTO BAILOUT;
      243     3597    3                      END;
      244     3598    2                 CALL M$UNFID(UNFID_M$RU) ALTRET( MONERR );
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:8    
      245     3599
      246     3600    2               CASE (%KP_RU_KEYED_READ#); /* Read the run unit file by key       */
      247     3601    2                 KP_INBUF = ' ';
      248     3602    2                 READ_M$RU.V.KEYS# = TRUE;
      249     3603    2                 READ_M$RU.V.KEYR# = FALSE;
      250     3604    2                 CALL M$READ (READ_M$RU)
      251     3605    3                   WHENALTRETURN DO;
      252     3606    3                      IF IN_OPTS.WARN_CODE = 2 /* VIRTUAL */
      253     3607    3                         OR IN_OPTS.WARN_CODE = 0 /* ALL */
      254     3608    3                         THEN
      255     3609    3                           GOTO MONERR;
      256     3610    3                      ELSE
      257     3611    3                           GOTO BAILOUT;
      258     3612    3                      END;
      259     3613    2                 KP_INPUT_COUNT = DCBADDR (DCBNUM(M$RU))->F$DCB.ARS#;
      260     3614
      261     3615    2               CASE (%KP_RU_OPEN_OUT#); /* Open M$RU to KP_FILE_NAME for output  */
      262     3616    2                 OPEN_M$RU.V.EXIST# = KP_OUTPUT_DISP;
      263     3617    2                 GOTO COMMON_OPEN_M$RU;
      264     3618
      265     3619    2               CASE (%KP_RU_WRITE#);       /* Write a ru record                  */
      266     3620    2                 WRITE_M$RU.BUF_.BOUND = KP_RU_RECL - 1;
      267     3621    2                 CALL M$WRITE (WRITE_M$RU) ALTRET (MONERR);
      268     3622
      269     3623    2               CASE (%KP_RU_CLOSE#);       /* Close the M$RU file                */
      270     3624    2                 IF DCBADDR( DCBNUM(M$RU) ) -> F$DCB.FCD# = '1'B THEN
      271     3625    2                      CALL M$CLOSE (CLOSE_M$RU) ALTRET (MONERR);
      272     3626
      273     3627    2               CASE (%KP_A_DO_WRITE#, %KP_A_LO_WRITE#);
      274     3628    2                 A_OBUF.MESS = KP_A_OUTBUF;
      275     3629    3                   DO CASE (KP_A_OUTVFC);
      276     3630    3                     CASE (%KP_SSPACE#);
      277     3631                                                /* Single space                       */
      278     3632    3                       A_OBUF.VFC = 'A';
      279     3633    3                     CASE (%KP_DSPACE#);
      280     3634                                                /* Double space                       */
      281     3635    3                       A_OBUF.VFC = 'B';
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:9    
      282     3636    3                     CASE (ELSE);
      283     3637                                                /* Error - use single space           */
      284     3638    3                       A_OBUF.VFC = 'A';
      285     3639    3                     END;
      286     3640                                                /* Write on the correct dcb           */
      287     3641    3                   DO CASE (IO_TYPE);
      288     3642    3                     CASE (%KP_A_DO_WRITE#);
      289     3643                                                /* M$DO                               */
      290     3644    3                       CALL M$WRITE (WRITE_A_M$DO) ALTRET (MONERR);
      291     3645    3                     CASE (%KP_A_LO_WRITE#);
      292     3646                                                /* M$LO                               */
      293     3647    3                       CALL M$WRITE (WRITE_A_M$LO) ALTRET (MONERR);
      294     3648                                                /* No errors possible so no else case */
      295     3649    3                     END;
      296     3650
      297     3651    2               CASE (%KP_IO_CLOSE#);       /* Close M$DO, M$LL, M$LO and M$SI    */
      298     3652    2                 CALL M$CLOSE (OPEN_M$DO);
      299     3653    2                 CALL M$CLOSE (OPEN_M$LL);
      300     3654    2                 CALL M$CLOSE (OPEN_M$LO);
      301     3655    2                 CALL M$CLOSE (OPEN_M$SI);
      302     3656
      303     3657    2               CASE (%KP_UC_READ#);        /* Read from M$UC, 0 chars is OK      */
      304     3658    2                 READ_COMMAND.V.DCB# = DCBNUM(M$UC);
      305     3659    2                 KP_INBUF = ' ';
      306     3660    2                 CALL M$READ (READ_COMMAND) ALTRET (MONERR);
      307     3661    2                 KP_INPUT_COUNT = DCBADDR (READ_COMMAND.V.DCB#)->F$DCB.ARS#;
      308     3662
      309     3663
      310     3664    2               CASE (ELSE);                /* Unknown i/o request                */
      311     3665    2                 OBUF.VFC = 'B';
      312     3666    2                 OBUF.MESS = ' - - Unknown I/O Request - -';
      313     3667    2                 CALL M$WRITE (WRITE_M$LO) ALTRET (MONERR);
      314     3668    2               END;
      315     3669    1           RETURN;
      316     3670        /**/
      317     3671    1   MONERR: ;
      318     3672    1           KP_ERRDCB = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:10   
      319     3673    1           CALL KPE$ERRMSG (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR);
      320     3674    1   BAILOUT: ;                              /* ERROR ALREADY PRINTED              */
      321     3675    1           ALTRETURN;
      322     3676        /**/
      323     3677    1   END KPI$IO_SVC;

PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:11   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KP_MACRO_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KP_PERR_C.:E05TOU  is referenced.
   KP_SUBS.:E05TOU  is referenced.
   KP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KPI$IO_SVC.

   Procedure KPI$IO_SVC requires 321 words for executable code.
   Procedure KPI$IO_SVC requires 6 words of local(AUTO) storage.

    No errors detected in file KPI$IO_SVC.:E05TSI    .

PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:12   

 Object Unit name= KPI$IO_SVC                                 File name= KPI$IO_SVC.:E05TOU
 UTS= JUL 30 '97 01:19:40.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   846   1516  KPI$IO_SVC
    2  RoData even  UTS     10     12  KPI$IO_SVC
    3   DCB   even  none     0      0  M$RU
    4   DCB   even  none     0      0  M$DO
    5   DCB   even  none     0      0  M$PIGLET
    6   DCB   even  none     0      0  M$LL
    7   DCB   even  none     0      0  M$LO
    8   DCB   even  none     0      0  M$SI
    9   Proc  even  none   321    501  KPI$IO_SVC
   10  RoData even  none     6      6  KPI$IO_SVC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes    yes     yes      Std        1  KPI$IO_SVC
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:13   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KPE$ERROR
 yes     yes           Std       1 KPE$ERRMSG
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  KP_INPUT_COUNT                        KP_INBUF
     KP_OUTVFC                             KP_OUTBUF                             KP_A_OUTVFC
     KP_A_OUTBUF                           KP_RU_OUTBUF                          KP_RU_RECL
     KP_FECG_IN                            KP_FECG_OUT                           KP_FECG_OUT_SIZE
     KP_FEP_NO                             KP_FEP_TEXT                           KP_FILE_NAME
     KP_RU_KEY                             KP_FPARAM                             KP_OUTPUT_DISP
     KP_ERRDCB                             IN_OPTS                               B$TCB$
     M$RU                                  M$DO                                  M$PIGLET
     M$LL                                  M$LO                                  M$SI
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:14   


        1        1        /*M*  KPI$IO_SVC - PIGETTE I/O Service Procedure                   */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*F*     NAME:          KPI$IO_SVC
        8        8                 PURPOSE:       All IO functions are done from here.
        9        9                 DESCRIPTIONS:  Opens, closes, reads, and writes are all done
       10       10                                from here rather than sprinkling them about
       11       11                                creation.
       12       12        */
       13       13        KPI$IO_SVC: PROC   (IO_TYPE)   ALTRET;

     13  9 000000   000000 700200 xent  KPI$IO_SVC   TSX0  ! X66_AUTO_1
         9 000001   000006 000001                    ZERO    6,1

       14       14        /**/
       15       15        /* Include files */
       16       16        /**/
       17       17            %INCLUDE KP_DATA_R;
       18     1269            %INCLUDE CP_6_SUBS;
       19     1809        /**/
       20     1810        /* Local declarations */
       21     1811        /**/
       22     1812    1   DCL IO_TYPE UBIN WORD;
       23     1813    1   DCL 1 OBUF STATIC,
       24     1814    1         2 VFC CHAR(1) UNAL,
       25     1815    1         2 MESS CHAR(%KP_BUF_SIZE#) UNAL;
       26     1816    1   DCL 1 A_OBUF STATIC,
       27     1817    1         2 VFC CHAR(1) UNAL,
       28     1818    1         2 MESS CHAR(%KP_BUF_SIZE#) UNAL;
       29     1819    1   DCL TRUE BIT(1) CONSTANT INIT( '1'B );
       30     1820    1   DCL FALSE BIT(1) CONSTANT INIT( '0'B );
       31     1821    1   DCL EBUF CHAR(120) STATIC;
       32     1822        /**/
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:15   
       33     1823        /* Symrefs */
       34     1824        /**/
       35     1825    1   DCL B$TCB$ PTR SYMREF;
       36     1826        %EJECT;
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:16   
       37     1827        /**/
       38     1828        /* Dcb declarations */
       39     1829        /**/
       40     1830    1   DCL M$RU DCB;
       41     1831    1   DCL M$DO DCB;
       42     1832    1   DCL M$PIGLET DCB;
       43     1833    1   DCL M$LL DCB;
       44     1834    1   DCL M$LO DCB;
       45     1835    1   DCL M$SI DCB;
       46     1836        /**/
       47     1837        /* ENTRY DCLS */
       48     1838        /**/
       49     1839        %KP_ENTRIES (OMIT=KPI$IO_SVC);
       50     1945        /**/
       51     1946        /* BASED */
       52     1947        /**/
       53     1948            %B$ALT;
       54     1956            %B$TCB;
       55     1959            %F$DCB (DCBN = F$DCB);
       56     2016        /**/
       57     2017        /* Fpts */
       58     2018        /**/
       59     2019            %FPT_CLOSE (FPTN = CLOSE_M$RU,
       60     2020                        DCB = M$RU,
       61     2021                        DISP = SAVE);
       62     2063            %FPT_CLOSE (FPTN = CLOSE_M$DO,
       63     2064                        DCB = M$DO);
       64     2106            %FPT_CLOSE (FPTN = CLOSE_PIGLET,
       65     2107                        DISP = SAVE,            /* WAIT until FPRG goes away          */
       66     2108                        DCB = M$PIGLET);
       67     2150            %FPT_CLOSE (FPTN = CLOSE_M$LL,
       68     2151                        DCB = M$LL);
       69     2193            %FPT_CLOSE (FPTN = CLOSE_M$LO,
       70     2194                        DCB = M$LO);
       71     2236            %FPT_CLOSE (FPTN = CLOSE_M$SI,
       72     2237                        DCB = M$SI);
       73     2279            %FPT_FID (FPTN = FID_M$RU,
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:17   
       74     2280                      ACCT = M$RU_ACCT,
       75     2281                      ASN = OPEN_M$RU.V.ASN#,
       76     2282                      NAME = M$RU_NAME,
       77     2283                      PASS = M$RU_PASS,
       78     2284                      RES = OPEN_M$RU.V.RES#,
       79     2285                      RESULTS = M$RU_RESULTS,
       80     2286                      SN = M$RU_SN,
       81     2287                      WSN = M$RU_WSN);
       82     2310            %FPT_UNFID (FPTN = UNFID_M$RU,
       83     2311                        DCB = M$RU,
       84     2312                        TEXTFID = KP_FILE_NAME);
       85     2330            %FPT_OPEN (FPTN = OPEN_M$RU,
       86     2331                       FPARAM = KP_FPARAM,
       87     2332                       ACCT = M$RU_ACCT,
       88     2333                       ACS = DIRECT,
       89     2334                       ASN = FILE,
       90     2335                       DCB = M$RU,
       91     2336                       EXIST = ERROR,           /* To be adjusted for DISP            */
       92     2337                       FUN = CREATE,
       93     2338                       CTG = YES,
       94     2339                       NAME = M$RU_NAME,
       95     2340                       ORG = KEYED,
       96     2341                       PASS = M$RU_PASS,
       97     2342                       REASSIGN = NO,
       98     2343                       SCRUB = YES,
       99     2344                       SN = M$RU_SN,
      100     2345                       TYPE = 'Rf',
      101     2346                       WSN = M$RU_WSN);
      102     2455            %FPT_OPEN (FPTN = OPEN_M$DO,
      103     2456                       DCB = M$DO);
      104     2565            %FPT_OPEN (FPTN = OPEN_PIGLET,
      105     2566                       DCB = M$PIGLET,
      106     2567                       ORG = FPRG,
      107     2568                       FPRG = HNDLR_FPRG,
      108     2569                       RES = 'FEnn',            /* To be adjusted for FEX             */
      109     2570                       ASN = DEVICE,
      110     2571                       FUN = CREATE);
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:18   
      111     2680            %FPT_OPEN (FPTN = OPEN_M$LL,
      112     2681                       DCB = M$LL);
      113     2790            %FPT_OPEN (FPTN = OPEN_M$LO,
      114     2791                       DCB = M$LO);
      115     2900            %FPT_OPEN (FPTN = OPEN_M$SI,
      116     2901                       DCB = M$SI);
      117     3010            %FPT_READ (FPTN = READ_M$RU,
      118     3011                       BUF = KP_INBUF,
      119     3012                       DCB = M$RU,
      120     3013                       KEY = KP_RU_KEY,
      121     3014                       KEYS = YES,
      122     3015                       TRANS = YES);
      123     3054            %FPT_READ (FPTN = READ_PIGLET,
      124     3055                       BUF = KP_FECG_IN,
      125     3056                       DCB = M$PIGLET,
      126     3057                       WAIT = YES);
      127     3096            %FPT_READ (FPTN = READ_COMMAND,
      128     3097                       BUF = KP_INBUF);
      129     3136            %FPT_WAIT (FPTN = WAIT_ONE,
      130     3137                       UNITS = 1);
      131     3151            %FPT_WRITE (FPTN = WRITE_M$RU,
      132     3152                        BUF = KP_RU_OUTBUF,
      133     3153                        DCB = M$RU,
      134     3154                        KEY = KP_RU_KEY);
      135     3185                %FPT_WRITE (FPTN = WRITE_M$DO,
      136     3186                  BUF = OBUF,
      137     3187                  DCB = M$DO,
      138     3188                  VFC = YES);
      139     3219                %FPT_WRITE (FPTN = WRITE_A_M$DO,
      140     3220                  BUF = A_OBUF,
      141     3221                  DCB = M$DO,
      142     3222                  VFC = YES);
      143     3253                %FPT_WRITE (FPTN = WRITE_PIGLET,
      144     3254                  BUF = KP_FECG_OUT,
      145     3255                  TRANS = YES,
      146     3256                  DCB = M$PIGLET);
      147     3287                %FPT_WRITE (FPTN = WRITE_M$LL,
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:19   
      148     3288                  BUF = OBUF,
      149     3289                  DCB = M$LL,
      150     3290                  VFC = YES);
      151     3321                %FPT_WRITE (FPTN = WRITE_M$LO,
      152     3322                  BUF = OBUF,
      153     3323                  DCB = M$LO,
      154     3324                  VFC = YES);
      155     3355                %FPT_WRITE (FPTN = WRITE_A_M$LO,
      156     3356                  BUF = A_OBUF,
      157     3357                  DCB = M$LO,
      158     3358                  VFC = YES);
      159     3389        /**/
      160     3390        /* Vlps and vlrs */
      161     3391        /**/
      162     3392                %VLP_ACCT (FPTN = M$RU_ACCT);
      163     3405                %VLP_FPRG (FPTN = HNDLR_FPRG,NAME = 'PIGLET',ACCT = ':SYS');
      164     3426                %VLP_NAME (FPTN = M$RU_NAME);
      165     3453                %VLP_PASS (FPTN = M$RU_PASS);
      166     3466                %VLP_SN (FPTN = M$RU_SN);
      167     3479                %VLP_WSN (FPTN = M$RU_WSN);
      168     3492                %VLP_WSN (FPTN = M$STMNT_WSN);
      169     3505                %VLR_FID (FPTN = M$RU_RESULTS);
      170     3524        %EJECT;
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:20   
      171     3525        /**/
      172     3526        /* Code starts here */
      173     3527        /**/
      174     3528    2             DO CASE (IO_TYPE);

   3528  9 000002   200003 470500                    LDP0    @IO_TYPE,,AUTO
         9 000003   000000 235100                    LDA     0,,PR0
         9 000004   000030 115007                    CMPA    24,DL
         9 000005   000007 602005 9                  TNC     s:3528+5,AL
         9 000006   000453 710000 9                  TRA     s:3665
         9 000007   000037 710000 9                  TRA     s:3531
         9 000010   000054 710000 9                  TRA     s:3536
         9 000011   000054 710000 9                  TRA     s:3536
         9 000012   000054 710000 9                  TRA     s:3536
         9 000013   000125 710000 9                  TRA     s:3563
         9 000014   000453 710000 9                  TRA     s:3665
         9 000015   000453 710000 9                  TRA     s:3665
         9 000016   000453 710000 9                  TRA     s:3665
         9 000017   000152 710000 9                  TRA     s:3572
         9 000020   000166 710000 9                  TRA     s:3577
         9 000021   000173 710000 9                  TRA     s:3580
         9 000022   000453 710000 9                  TRA     s:3665
         9 000023   000206 710000 9                  TRA     s:3584
         9 000024   000213 710000 9                  TRA     s:3587
         9 000025   000256 710000 9                  TRA     s:3601
         9 000026   000336 710000 9                  TRA     s:3624
         9 000027   000352 710000 9                  TRA     s:3628
         9 000030   000352 710000 9                  TRA     s:3628
         9 000031   000415 710000 9                  TRA     s:3652
         9 000032   000453 710000 9                  TRA     s:3665
         9 000033   000315 710000 9                  TRA     s:3616
         9 000034   000453 710000 9                  TRA     s:3665
         9 000035   000323 710000 9                  TRA     s:3620
         9 000036   000432 710000 9                  TRA     s:3658

      175     3529    2               CASE (%KP_IO_OPEN#);

PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:21   
      176     3530                                                /* Open M$DO, M$LL, M$LO and M$SI     */
      177     3531    2                 CALL M$OPEN (OPEN_M$DO);

   3531  9 000037   000570 630400 1                  EPPR0   OPEN_M$DO
         9 000040   050000 713400                    CLIMB   open
         9 000041   410400 401760                    pmme    nvectors=18

      178     3532    2                 CALL M$OPEN (OPEN_M$LL);

   3532  9 000042   000754 630400 1                  EPPR0   OPEN_M$LL
         9 000043   050000 713400                    CLIMB   open
         9 000044   410400 401760                    pmme    nvectors=18

      179     3533    2                 CALL M$OPEN (OPEN_M$LO);

   3533  9 000045   001046 630400 1                  EPPR0   OPEN_M$LO
         9 000046   050000 713400                    CLIMB   open
         9 000047   410400 401760                    pmme    nvectors=18

      180     3534    2                 CALL M$OPEN (OPEN_M$SI);

   3534  9 000050   001140 630400 1                  EPPR0   OPEN_M$SI
         9 000051   050000 713400                    CLIMB   open
         9 000052   410400 401760                    pmme    nvectors=18
         9 000053   000464 710000 9                  TRA     s:3669

      181     3535    2               CASE (%KP_DO_WRITE#, %KP_LL_WRITE#, %KP_LO_WRITE#);

      182     3536    2                 OBUF.MESS = KP_OUTBUF;

   3536  9 000054   040000 100400                    MLR     fill='040'O
         9 000055   000000 000170 xsym               ADSC9   KP_OUTBUF                cn=0,n=120
         9 000056   000000 200170 1                  ADSC9   OBUF                     cn=1,n=120

      183     3537    3                   DO CASE (KP_OUTVFC);

   3537  9 000057   000000 236000 xsym               LDQ     KP_OUTVFC
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:22   
         9 000060   000033 772000                    QRL     27
         9 000061   000002 116007                    CMPQ    2,DL
         9 000062   000064 602006 9                  TNC     s:3537+5,QL
         9 000063   000074 710000 9                  TRA     s:3546
         9 000064   000066 710000 9                  TRA     s:3540
         9 000065   000071 710000 9                  TRA     s:3543

      184     3538    3                     CASE (%KP_SSPACE#);

      185     3539                                                /* Single space                       */
      186     3540    3                       OBUF.VFC = 'A';

   3540  9 000066   101000 236003                    LDQ     33280,DU
         9 000067   000000 552040 1                  STBQ    OBUF,'40'O
         9 000070   000076 710000 9                  TRA     s:3549

      187     3541    3                     CASE (%KP_DSPACE#);

      188     3542                                                /* Double space                       */
      189     3543    3                       OBUF.VFC = 'B';

   3543  9 000071   102000 236003                    LDQ     33792,DU
         9 000072   000000 552040 1                  STBQ    OBUF,'40'O
         9 000073   000076 710000 9                  TRA     s:3549

      190     3544    3                     CASE (ELSE);

      191     3545                                                /* Error - use single space           */
      192     3546    3                       OBUF.VFC = 'A';

   3546  9 000074   101000 236003                    LDQ     33280,DU
         9 000075   000000 552040 1                  STBQ    OBUF,'40'O

      193     3547    3                     END;

      194     3548                                                /* Write on the correct dcb           */
      195     3549    3                   DO CASE (IO_TYPE);
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:23   

   3549  9 000076   000000 235100                    LDA     0,,PR0
         9 000077   000004 115007                    CMPA    4,DL
         9 000100   000102 602005 9                  TNC     s:3549+4,AL
         9 000101   000464 710000 9                  TRA     s:3669
         9 000102   000124 710000 9                  TRA     s:3560
         9 000103   000106 710000 9                  TRA     s:3552
         9 000104   000113 710000 9                  TRA     s:3555
         9 000105   000120 710000 9                  TRA     s:3558

      196     3550    3                     CASE (%KP_DO_WRITE#);

      197     3551                                                /* M$DO                               */
      198     3552    3                       CALL M$WRITE (WRITE_M$DO) ALTRET (MONERR);

   3552  9 000106   001326 630400 1                  EPPR0   WRITE_M$DO
         9 000107   440001 713400                    CLIMB   alt,write
         9 000110   401400 401760                    pmme    nvectors=4
         9 000111   000465 702000 9                  TSX2    MONERR
         9 000112   000464 710000 9                  TRA     s:3669

      199     3553    3                     CASE (%KP_LL_WRITE#);

      200     3554                                                /* M$LL                               */
      201     3555    3                       CALL M$WRITE (WRITE_M$LL) ALTRET (MONERR);

   3555  9 000113   001372 630400 1                  EPPR0   WRITE_M$LL
         9 000114   440001 713400                    CLIMB   alt,write
         9 000115   401400 401760                    pmme    nvectors=4
         9 000116   000465 702000 9                  TSX2    MONERR
         9 000117   000464 710000 9                  TRA     s:3669

      202     3556    3                     CASE (%KP_LO_WRITE#);

      203     3557                                                /* M$LO                               */
      204     3558    3                       CALL M$WRITE (WRITE_M$LO) ALTRET (MONERR);

PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:24   
   3558  9 000120   001406 630400 1                  EPPR0   WRITE_M$LO
         9 000121   440001 713400                    CLIMB   alt,write
         9 000122   401400 401760                    pmme    nvectors=4
         9 000123   000465 702000 9                  TSX2    MONERR

      205     3559                                                /* No errors possible so no else case */
      206     3560    3                     END;

   3560  9 000124   000464 710000 9                  TRA     s:3669

      207     3561
      208     3562    2               CASE (%KP_SI_READ#);        /* Read from M$SI, at least 1 char.   */

      209     3563    2                 READ_COMMAND.V.DCB# = DCBNUM(M$SI);

   3563  9 000125   000000 236007 xsym               LDQ     M$SI,DL
         9 000126   000000 620006                    EAX0    0,QL
         9 000127   001276 740000 1                  STX0    READ_COMMAND+8

      210     3564    2                 KP_INPUT_COUNT = 0;

   3564  9 000130   000000 450000 xsym               STZ     KP_INPUT_COUNT

      211     3565    2                 KP_INBUF = ' ';

   3565  9 000131   040000 100400                    MLR     fill='040'O
         9 000132   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000133   000000 001000 xsym               ADSC9   KP_INBUF                 cn=0,n=512

      212     3566    3                 DO WHILE (KP_INPUT_COUNT = 0);

   3566  9 000134   000000 235000 xsym               LDA     KP_INPUT_COUNT
         9 000135   000464 601000 9                  TNZ     s:3669

      213     3567    3                    CALL M$READ (READ_COMMAND) ALTRET (MONERR);

   3567  9 000136   001266 630400 1                  EPPR0   READ_COMMAND
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:25   
         9 000137   440000 713400                    CLIMB   alt,read
         9 000140   401400 401760                    pmme    nvectors=4
         9 000141   000465 702000 9                  TSX2    MONERR

      214     3568    3                    KP_INPUT_COUNT = DCBADDR (READ_COMMAND.V.DCB#)->F$DCB.ARS#;

   3568  9 000142   000000 470400 10                 LDP0    0
         9 000143   000000 471500                    LDP1    0,,PR0
         9 000144   001276 220000 1                  LDX0    READ_COMMAND+8
         9 000145   100000 473510                    LDP3    0,X0,PR1
         9 000146   300000 235100                    LDA     0,,PR3
         9 000147   000000 755000 xsym               STA     KP_INPUT_COUNT

      215     3569    3                    END;

   3569  9 000150   000136 600000 9                  TZE     s:3567
         9 000151   000464 710000 9                  TRA     s:3669

      216     3570
      217     3571    2               CASE (%KP_FECG_OPEN#);      /* Open a path to PIGLET              */

      218     3572    2                 CALL BINCHAR(KP_FEP_TEXT,KP_FEP_NO);

   3572  9 000152   000000 301400                    BTD
         9 000153   000000 000004 xsym               NDSC9   KP_FEP_NO                cn=0,s=lsgnf,sf=0,n=4
         9 000154   000000 030002 xsym               NDSC9   KP_FEP_TEXT              cn=0,s=nosgn,sf=0,n=2

      219     3573    2                 CALL CONCAT (OPEN_PIGLET.V.RES#,'FE',KP_FEP_TEXT);

   3573  9 000155   000002 220000 2                  LDX0    FALSE+1
         9 000156   000732 740000 1                  STX0    OPEN_PIGLET+40
         9 000157   000000 221000 xsym               LDX1    KP_FEP_TEXT
         9 000160   000732 441000 1                  SXL1    OPEN_PIGLET+40

      220     3574    2                 CALL M$OPEN (OPEN_PIGLET) ALTRET (MONERR);

   3574  9 000161   000662 630400 1                  EPPR0   OPEN_PIGLET
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:26   
         9 000162   450000 713400                    CLIMB   alt,open
         9 000163   410400 401760                    pmme    nvectors=18
         9 000164   000465 702000 9                  TSX2    MONERR
         9 000165   000464 710000 9                  TRA     s:3669

      221     3575
      222     3576    2               CASE (%KP_FECG_READ#);      /* Read something from PIGLET         */

      223     3577    2                 CALL M$READ (READ_PIGLET) ALTRET (MONERR);

   3577  9 000166   001250 630400 1                  EPPR0   READ_PIGLET
         9 000167   440000 713400                    CLIMB   alt,read
         9 000170   401400 401760                    pmme    nvectors=4
         9 000171   000465 702000 9                  TSX2    MONERR
         9 000172   000464 710000 9                  TRA     s:3669

      224     3578
      225     3579    2               CASE (%KP_FECG_WRITE#);     /* Write something to PIGLET          */

      226     3580    2                 WRITE_PIGLET.BUF_.BOUND = KP_FECG_OUT_SIZE - 1;

   3580  9 000173   000000 236000 xsym               LDQ     KP_FECG_OUT_SIZE
         9 000174   000001 136007                    SBLQ    1,DL
         9 000175   000020 736000                    QLS     16
         9 000176   001362 676000 1                  ERQ     WRITE_PIGLET+4
         9 000177   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 000200   001362 656000 1                  ERSQ    WRITE_PIGLET+4

      227     3581    2                 CALL M$WRITE (WRITE_PIGLET) ALTRET (MONERR);

   3581  9 000201   001356 630400 1                  EPPR0   WRITE_PIGLET
         9 000202   440001 713400                    CLIMB   alt,write
         9 000203   401400 401760                    pmme    nvectors=4
         9 000204   000465 702000 9                  TSX2    MONERR
         9 000205   000464 710000 9                  TRA     s:3669

      228     3582
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:27   
      229     3583    2               CASE (%KP_FECG_CLOSE#);     /* Close path, halt PIGETTE           */

      230     3584    2                 CALL M$CLOSE (CLOSE_PIGLET) ALTRET (MONERR);

   3584  9 000206   000230 630400 1                  EPPR0   CLOSE_PIGLET
         9 000207   450001 713400                    CLIMB   alt,close
         9 000210   406000 401760                    pmme    nvectors=13
         9 000211   000465 702000 9                  TSX2    MONERR
         9 000212   000464 710000 9                  TRA     s:3669

      231     3585
      232     3586    2               CASE (%KP_RU_OPEN#);   /* Open M$RU to the file in KP_FILE_NAME   */

      233     3587    2                 OPEN_M$RU.V.EXIST# = %OLDFILE#;

   3587  9 000213   000542 236000 1                  LDQ     OPEN_M$RU+36
         9 000214   000001 376000 10                 ANQ     1
         9 000215   000400 276007                    ORQ     256,DL
         9 000216   000542 756000 1                  STQ     OPEN_M$RU+36

   3587  9 000217                       COMMON_OPEN* null
      234     3588    2   COMMON_OPEN_M$RU: ;
      235     3589    2                 FID_M$RU.TEXTFID_ = VECTOR (KP_FILE_NAME);

   3589  9 000217   000002 237000 10                 LDAQ    2
         9 000220   000422 757000 1                  STAQ    FID_M$RU+2

      236     3590    2                 CALL M$FID (FID_M$RU) ALTRET (MONERR);

   3590  9 000221   000420 630400 1                  EPPR0   FID_M$RU
         9 000222   420001 713400                    CLIMB   alt,+8193
         9 000223   404400 401760                    pmme    nvectors=10
         9 000224   000465 702000 9                  TSX2    MONERR

      237     3591    2                 CALL M$OPEN (OPEN_M$RU) ALTRET (MONERR);

   3591  9 000225   000476 630400 1                  EPPR0   OPEN_M$RU
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:28   
         9 000226   450000 713400                    CLIMB   alt,open
         9 000227   410400 401760                    pmme    nvectors=18
         9 000230   000465 702000 9                  TSX2    MONERR

      238     3592    2                 IF DCBADDR(DCBNUM(M$RU)) -> F$DCB.FFLG.EXEC# THEN

   3592  9 000231   000000 236007 xsym               LDQ     M$RU,DL
         9 000232   000000 470400 10                 LDP0    0
         9 000233   000000 471500                    LDP1    0,,PR0
         9 000234   100000 473506                    LDP3    0,QL,PR1
         9 000235   300004 236100                    LDQ     4,,PR3
         9 000236   002000 316003                    CANQ    1024,DU
         9 000237   000251 600000 9                  TZE     s:3598

      239     3593    3                    DO;

      240     3594    3                      CALL M$CLOSE (CLOSE_M$RU) ALTRET (MONERR);

   3594  9 000240   000134 630400 1                  EPPR0   CLOSE_M$RU
         9 000241   450001 713400                    CLIMB   alt,close
         9 000242   406000 401760                    pmme    nvectors=13
         9 000243   000465 702000 9                  TSX2    MONERR

      241     3595    3                      CALL KPE$ERROR(%E$OPENED_EXEC);

   3595  9 000244   000005 630400 10                 EPPR0   5
         9 000245   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000246   000000 701000 xent               TSX1    KPE$ERROR
         9 000247   000000 011000                    NOP     0

      242     3596    3                      GOTO BAILOUT;

   3596  9 000250   000500 710000 9                  TRA     BAILOUT

      243     3597    3                      END;
      244     3598    2                 CALL M$UNFID(UNFID_M$RU) ALTRET( MONERR );

PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:29   
   3598  9 000251   000450 630400 1                  EPPR0   UNFID_M$RU
         9 000252   420021 713400                    CLIMB   alt,+8209
         9 000253   404400 401760                    pmme    nvectors=10
         9 000254   000465 702000 9                  TSX2    MONERR
         9 000255   000464 710000 9                  TRA     s:3669

      245     3599
      246     3600    2               CASE (%KP_RU_KEYED_READ#); /* Read the run unit file by key       */

      247     3601    2                 KP_INBUF = ' ';

   3601  9 000256   040000 100400                    MLR     fill='040'O
         9 000257   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000260   000000 001000 xsym               ADSC9   KP_INBUF                 cn=0,n=512

      248     3602    2                 READ_M$RU.V.KEYS# = TRUE;

   3602  9 000261   000000 236000 2                  LDQ     TRUE
         9 000262   000023 772000                    QRL     19
         9 000263   001242 676000 1                  ERQ     READ_M$RU+8
         9 000264   200000 376007                    ANQ     65536,DL
         9 000265   001242 656000 1                  ERSQ    READ_M$RU+8

      249     3603    2                 READ_M$RU.V.KEYR# = FALSE;

   3603  9 000266   000001 236000 2                  LDQ     FALSE
         9 000267   000024 772000                    QRL     20
         9 000270   001242 676000 1                  ERQ     READ_M$RU+8
         9 000271   100000 376007                    ANQ     32768,DL
         9 000272   001242 656000 1                  ERSQ    READ_M$RU+8

      250     3604    2                 CALL M$READ (READ_M$RU)

   3604  9 000273   001232 630400 1                  EPPR0   READ_M$RU
         9 000274   440000 713400                    CLIMB   alt,read
         9 000275   401400 401760                    pmme    nvectors=4
         9 000276   000300 702000 9                  TSX2    s:3606
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:30   
         9 000277   000306 710000 9                  TRA     s:3613

      251     3605    3                   WHENALTRETURN DO;

      252     3606    3                      IF IN_OPTS.WARN_CODE = 2 /* VIRTUAL */

   3606  9 000300   000012 235000 xsym               LDA     IN_OPTS+10
         9 000301   000002 115007                    CMPA    2,DL
         9 000302   000465 600000 9                  TZE     MONERR
         9 000303   000000 115003                    CMPA    0,DU
         9 000304   000465 600000 9                  TZE     MONERR

      253     3607    3                         OR IN_OPTS.WARN_CODE = 0 /* ALL */
      254     3608    3                         THEN
      255     3609    3                           GOTO MONERR;
      256     3610    3                      ELSE
      257     3611    3                           GOTO BAILOUT;

   3611  9 000305   000500 710000 9                  TRA     BAILOUT

      258     3612    3                      END;
      259     3613    2                 KP_INPUT_COUNT = DCBADDR (DCBNUM(M$RU))->F$DCB.ARS#;

   3613  9 000306   000000 236007 xsym               LDQ     M$RU,DL
         9 000307   000000 470400 10                 LDP0    0
         9 000310   000000 471500                    LDP1    0,,PR0
         9 000311   100000 473506                    LDP3    0,QL,PR1
         9 000312   300000 235100                    LDA     0,,PR3
         9 000313   000000 755000 xsym               STA     KP_INPUT_COUNT
         9 000314   000464 710000 9                  TRA     s:3669

      260     3614
      261     3615    2               CASE (%KP_RU_OPEN_OUT#); /* Open M$RU to KP_FILE_NAME for output  */

      262     3616    2                 OPEN_M$RU.V.EXIST# = KP_OUTPUT_DISP;

   3616  9 000315   000000 236000 xsym               LDQ     KP_OUTPUT_DISP
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:31   
         9 000316   000007 736000                    QLS     7
         9 000317   000542 676000 1                  ERQ     OPEN_M$RU+36
         9 000320   000600 376007                    ANQ     384,DL
         9 000321   000542 656000 1                  ERSQ    OPEN_M$RU+36

      263     3617    2                 GOTO COMMON_OPEN_M$RU;

   3617  9 000322   000217 710000 9                  TRA     COMMON_OPEN_M$RU

      264     3618
      265     3619    2               CASE (%KP_RU_WRITE#);       /* Write a ru record                  */

      266     3620    2                 WRITE_M$RU.BUF_.BOUND = KP_RU_RECL - 1;

   3620  9 000323   000000 236000 xsym               LDQ     KP_RU_RECL
         9 000324   000001 136007                    SBLQ    1,DL
         9 000325   000020 736000                    QLS     16
         9 000326   001316 676000 1                  ERQ     WRITE_M$RU+4
         9 000327   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 000330   001316 656000 1                  ERSQ    WRITE_M$RU+4

      267     3621    2                 CALL M$WRITE (WRITE_M$RU) ALTRET (MONERR);

   3621  9 000331   001312 630400 1                  EPPR0   WRITE_M$RU
         9 000332   440001 713400                    CLIMB   alt,write
         9 000333   401400 401760                    pmme    nvectors=4
         9 000334   000465 702000 9                  TSX2    MONERR
         9 000335   000464 710000 9                  TRA     s:3669

      268     3622
      269     3623    2               CASE (%KP_RU_CLOSE#);       /* Close the M$RU file                */

      270     3624    2                 IF DCBADDR( DCBNUM(M$RU) ) -> F$DCB.FCD# = '1'B THEN

   3624  9 000336   000000 236007 xsym               LDQ     M$RU,DL
         9 000337   000000 471400 10                 LDP1    0
         9 000340   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:32   
         9 000341   300000 474506                    LDP4    0,QL,PR3
         9 000342   400031 236100                    LDQ     25,,PR4
         9 000343   020000 316007                    CANQ    8192,DL
         9 000344   000464 600000 9                  TZE     s:3669

      271     3625    2                      CALL M$CLOSE (CLOSE_M$RU) ALTRET (MONERR);

   3625  9 000345   000134 630400 1                  EPPR0   CLOSE_M$RU
         9 000346   450001 713400                    CLIMB   alt,close
         9 000347   406000 401760                    pmme    nvectors=13
         9 000350   000465 702000 9                  TSX2    MONERR
         9 000351   000464 710000 9                  TRA     s:3669

      272     3626
      273     3627    2               CASE (%KP_A_DO_WRITE#, %KP_A_LO_WRITE#);

      274     3628    2                 A_OBUF.MESS = KP_A_OUTBUF;

   3628  9 000352   040000 100400                    MLR     fill='040'O
         9 000353   000000 000170 xsym               ADSC9   KP_A_OUTBUF              cn=0,n=120
         9 000354   000037 200170 1                  ADSC9   A_OBUF                   cn=1,n=120

      275     3629    3                   DO CASE (KP_A_OUTVFC);

   3629  9 000355   000000 236000 xsym               LDQ     KP_A_OUTVFC
         9 000356   000033 772000                    QRL     27
         9 000357   000002 116007                    CMPQ    2,DL
         9 000360   000362 602006 9                  TNC     s:3629+5,QL
         9 000361   000372 710000 9                  TRA     s:3638
         9 000362   000364 710000 9                  TRA     s:3632
         9 000363   000367 710000 9                  TRA     s:3635

      276     3630    3                     CASE (%KP_SSPACE#);

      277     3631                                                /* Single space                       */
      278     3632    3                       A_OBUF.VFC = 'A';

PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:33   
   3632  9 000364   101000 236003                    LDQ     33280,DU
         9 000365   000037 552040 1                  STBQ    A_OBUF,'40'O
         9 000366   000374 710000 9                  TRA     s:3641

      279     3633    3                     CASE (%KP_DSPACE#);

      280     3634                                                /* Double space                       */
      281     3635    3                       A_OBUF.VFC = 'B';

   3635  9 000367   102000 236003                    LDQ     33792,DU
         9 000370   000037 552040 1                  STBQ    A_OBUF,'40'O
         9 000371   000374 710000 9                  TRA     s:3641

      282     3636    3                     CASE (ELSE);

      283     3637                                                /* Error - use single space           */
      284     3638    3                       A_OBUF.VFC = 'A';

   3638  9 000372   101000 236003                    LDQ     33280,DU
         9 000373   000037 552040 1                  STBQ    A_OBUF,'40'O

      285     3639    3                     END;

      286     3640                                                /* Write on the correct dcb           */
      287     3641    3                   DO CASE (IO_TYPE);

   3641  9 000374   000000 235100                    LDA     0,,PR0
         9 000375   000020 135007                    SBLA    16,DL
         9 000376   000002 115007                    CMPA    2,DL
         9 000377   000401 602005 9                  TNC     s:3641+5,AL
         9 000400   000464 710000 9                  TRA     s:3669
         9 000401   000403 710000 9                  TRA     s:3644
         9 000402   000410 710000 9                  TRA     s:3647

      288     3642    3                     CASE (%KP_A_DO_WRITE#);

      289     3643                                                /* M$DO                               */
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:34   
      290     3644    3                       CALL M$WRITE (WRITE_A_M$DO) ALTRET (MONERR);

   3644  9 000403   001342 630400 1                  EPPR0   WRITE_A_M$DO
         9 000404   440001 713400                    CLIMB   alt,write
         9 000405   401400 401760                    pmme    nvectors=4
         9 000406   000465 702000 9                  TSX2    MONERR
         9 000407   000464 710000 9                  TRA     s:3669

      291     3645    3                     CASE (%KP_A_LO_WRITE#);

      292     3646                                                /* M$LO                               */
      293     3647    3                       CALL M$WRITE (WRITE_A_M$LO) ALTRET (MONERR);

   3647  9 000410   001422 630400 1                  EPPR0   WRITE_A_M$LO
         9 000411   440001 713400                    CLIMB   alt,write
         9 000412   401400 401760                    pmme    nvectors=4
         9 000413   000465 702000 9                  TSX2    MONERR

      294     3648                                                /* No errors possible so no else case */
      295     3649    3                     END;

   3649  9 000414   000464 710000 9                  TRA     s:3669

      296     3650
      297     3651    2               CASE (%KP_IO_CLOSE#);       /* Close M$DO, M$LL, M$LO and M$SI    */

      298     3652    2                 CALL M$CLOSE (OPEN_M$DO);

   3652  9 000415   000570 630400 1                  EPPR0   OPEN_M$DO
         9 000416   050001 713400                    CLIMB   close
         9 000417   406000 401760                    pmme    nvectors=13

      299     3653    2                 CALL M$CLOSE (OPEN_M$LL);

   3653  9 000420   000754 630400 1                  EPPR0   OPEN_M$LL
         9 000421   050001 713400                    CLIMB   close
         9 000422   406000 401760                    pmme    nvectors=13
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:35   

      300     3654    2                 CALL M$CLOSE (OPEN_M$LO);

   3654  9 000423   001046 630400 1                  EPPR0   OPEN_M$LO
         9 000424   050001 713400                    CLIMB   close
         9 000425   406000 401760                    pmme    nvectors=13

      301     3655    2                 CALL M$CLOSE (OPEN_M$SI);

   3655  9 000426   001140 630400 1                  EPPR0   OPEN_M$SI
         9 000427   050001 713400                    CLIMB   close
         9 000430   406000 401760                    pmme    nvectors=13
         9 000431   000464 710000 9                  TRA     s:3669

      302     3656
      303     3657    2               CASE (%KP_UC_READ#);        /* Read from M$UC, 0 chars is OK      */

      304     3658    2                 READ_COMMAND.V.DCB# = DCBNUM(M$UC);

   3658  9 000432   000000 236007 xsym               LDQ     M$UC,DL
         9 000433   000000 620006                    EAX0    0,QL
         9 000434   001276 740000 1                  STX0    READ_COMMAND+8

      305     3659    2                 KP_INBUF = ' ';

   3659  9 000435   040000 100400                    MLR     fill='040'O
         9 000436   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000437   000000 001000 xsym               ADSC9   KP_INBUF                 cn=0,n=512

      306     3660    2                 CALL M$READ (READ_COMMAND) ALTRET (MONERR);

   3660  9 000440   001266 630400 1                  EPPR0   READ_COMMAND
         9 000441   440000 713400                    CLIMB   alt,read
         9 000442   401400 401760                    pmme    nvectors=4
         9 000443   000465 702000 9                  TSX2    MONERR

      307     3661    2                 KP_INPUT_COUNT = DCBADDR (READ_COMMAND.V.DCB#)->F$DCB.ARS#;
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:36   

   3661  9 000444   000000 470400 10                 LDP0    0
         9 000445   000000 471500                    LDP1    0,,PR0
         9 000446   001276 220000 1                  LDX0    READ_COMMAND+8
         9 000447   100000 473510                    LDP3    0,X0,PR1
         9 000450   300000 235100                    LDA     0,,PR3
         9 000451   000000 755000 xsym               STA     KP_INPUT_COUNT
         9 000452   000464 710000 9                  TRA     s:3669

      308     3662
      309     3663
      310     3664    2               CASE (ELSE);                /* Unknown i/o request                */

      311     3665    2                 OBUF.VFC = 'B';

   3665  9 000453   102000 236003                    LDQ     33792,DU
         9 000454   000000 552040 1                  STBQ    OBUF,'40'O

      312     3666    2                 OBUF.MESS = ' - - Unknown I/O Request - -';

   3666  9 000455   040000 100400                    MLR     fill='040'O
         9 000456   000003 000034 2                  ADSC9   FALSE+2                  cn=0,n=28
         9 000457   000000 200170 1                  ADSC9   OBUF                     cn=1,n=120

      313     3667    2                 CALL M$WRITE (WRITE_M$LO) ALTRET (MONERR);

   3667  9 000460   001406 630400 1                  EPPR0   WRITE_M$LO
         9 000461   440001 713400                    CLIMB   alt,write
         9 000462   401400 401760                    pmme    nvectors=4
         9 000463   000465 702000 9                  TSX2    MONERR

      314     3668    2               END;

      315     3669    1           RETURN;

   3669  9 000464   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:37   
   3667  9 000465                       MONERR       null
      316     3670        /**/
      317     3671    1   MONERR: ;
      318     3672    1           KP_ERRDCB = B$TCB$ -> B$TCB.ALT$ -> B$ALT.DCB#;

   3672  9 000465   000000 470400 xsym               LDP0    B$TCB$
         9 000466   000000 471500                    LDP1    0,,PR0
         9 000467   100101 235100                    LDA     65,,PR1
         9 000470   000000 755000 xsym               STA     KP_ERRDCB

      319     3673    1           CALL KPE$ERRMSG (B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR);

   3673  9 000471   000000 471500                    LDP1    0,,PR0
         9 000472   100102 633500                    EPPR3   66,,PR1
         9 000473   200004 453500                    STP3    @IO_TYPE+1,,AUTO
         9 000474   200004 630500                    EPPR0   @IO_TYPE+1,,AUTO
         9 000475   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000476   000000 701000 xent               TSX1    KPE$ERRMSG
         9 000477   000000 011000                    NOP     0

   3672  9 000500                       BAILOUT      null
      320     3674    1   BAILOUT: ;                              /* ERROR ALREADY PRINTED              */
      321     3675    1           ALTRETURN;

   3675  9 000500   000000 702200 xent               TSX2  ! X66_AALT
      322     3676        /**/
      323     3677    1   END KPI$IO_SVC;

PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:38   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KP_MACRO_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KP_PERR_C.:E05TOU  is referenced.
   KP_SUBS.:E05TOU  is referenced.
   KP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KPI$IO_SVC.
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:39   

 **** Variables and constants ****

  ****  Section 001  Data  KPI$IO_SVC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    37-0-0/c STRC(1089)  r     1 A_OBUF                   172-0-0/d STRC(1080)  r     1 CLOSE_M$DO
   266-0-0/d STRC(1080)  r     1 CLOSE_M$LL               324-0-0/d STRC(1080)  r     1 CLOSE_M$LO
   134-0-0/d STRC(1080)  r     1 CLOSE_M$RU               362-0-0/d STRC(1080)  r     1 CLOSE_M$SI
   230-0-0/d STRC(1080)  r     1 CLOSE_PIGLET             420-0-0/d STRC(864)   r     1 FID_M$RU
  1440-0-0/d STRC(612)   r     1 HNDLR_FPRG              1436-0-0/c STRC(72)    r     1 M$RU_ACCT
  1462-0-0/c STRC(288)   r     1 M$RU_NAME               1472-0-0/c STRC(72)    r     1 M$RU_PASS
  1504-0-0/d STRC(324)   r     1 M$RU_RESULTS            1474-0-0/d STRC(90)    r     1 M$RU_SN
  1500-0-0/c STRC(72)    r     1 M$RU_WSN                   0-0-0/c STRC(1089)  r     1 OBUF
   570-0-0/d STRC(2088)  r     1 OPEN_M$DO                754-0-0/d STRC(2088)  r     1 OPEN_M$LL
  1046-0-0/d STRC(2088)  r     1 OPEN_M$LO                476-0-0/d STRC(2088)  r     1 OPEN_M$RU
  1140-0-0/d STRC(2088)  r     1 OPEN_M$SI                662-0-0/d STRC(2088)  r     1 OPEN_PIGLET
  1266-0-0/d STRC(504)   r     1 READ_COMMAND            1232-0-0/d STRC(504)   r     1 READ_M$RU
  1250-0-0/d STRC(504)   r     1 READ_PIGLET              450-0-0/d STRC(792)   r     1 UNFID_M$RU
  1304-0-0/d STRC(216)   r     1 WAIT_ONE                1342-0-0/d STRC(432)   r     1 WRITE_A_M$DO
  1422-0-0/d STRC(432)   r     1 WRITE_A_M$LO            1326-0-0/d STRC(432)   r     1 WRITE_M$DO
  1372-0-0/d STRC(432)   r     1 WRITE_M$LL              1406-0-0/d STRC(432)   r     1 WRITE_M$LO
  1312-0-0/d STRC(432)   r     1 WRITE_M$RU              1356-0-0/d STRC(432)   r     1 WRITE_PIGLET

  ****  Section 002 RoData KPI$IO_SVC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/b BIT         r     1 FALSE                      0-0-0/b BIT         r     1 TRUE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:40   
     3-0-0/w PTR         r     1 @IO_TYPE                  *0-0-0/w UBIN        r     1 IO_TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC(468)   r     1 IN_OPTS
     0-0-0/c CHAR(120)   r     1 KP_A_OUTBUF                0-0-0/w UBIN(9)     r     1 KP_A_OUTVFC
     0-0-0/w UBIN        r     1 KP_ERRDCB                  0-0-0/c CHAR(2066)  r     1 KP_FECG_IN
     0-0-0/c CHAR(2066)  r     1 KP_FECG_OUT                0-0-0/w UBIN        r     1 KP_FECG_OUT_SIZE
     0-0-0/w SBIN        r     1 KP_FEP_NO                  0-0-0/c CHAR(2)     r     1 KP_FEP_TEXT
     0-0-0/c CHAR(50)    r     1 KP_FILE_NAME               0-0-0/w UBIN        r     1 KP_FPARAM(0:1023)
     0-0-0/c CHAR(512)   r     1 KP_INBUF                   0-0-0/w UBIN        r     1 KP_INPUT_COUNT
     0-0-0/c CHAR(120)   r     1 KP_OUTBUF                  0-0-0/w SBIN        r     1 KP_OUTPUT_DISP
     0-0-0/w UBIN(9)     r     1 KP_OUTVFC                  0-0-0/b STRC(54)    r     1 KP_RU_KEY
     0-0-0/c CHAR(512)   r     1 KP_RU_OUTBUF               0-0-0/w UBIN        r     1 KP_RU_RECL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LL                       0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$PIGLET                   0-0-0N  NULL        r     1 M$RU
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$UC


   Procedure KPI$IO_SVC requires 321 words for executable code.
   Procedure KPI$IO_SVC requires 6 words of local(AUTO) storage.

    No errors detected in file KPI$IO_SVC.:E05TSI    .
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:41   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:42   
          MINI XREF LISTING

A_OBUF
      1816**DCL      3240--DCLINIT  3241--DCLINIT  3376--DCLINIT  3377--DCLINIT
A_OBUF.MESS
      1818**DCL      3628<<ASSIGN
A_OBUF.VFC
      1817**DCL      3632<<ASSIGN   3635<<ASSIGN   3638<<ASSIGN
B$ALT.CODE
      1950**DCL      1950--REDEF    1951--REDEF    1951--REDEF
B$ALT.DCB#
      1951**DCL      3672>>ASSIGN
B$ALT.ERR
      1951**DCL      3673<>CALL
B$ALT.ERR.ERR#
      1952**DCL      1952--REDEF
B$ALT.EVID
      1951**DCL      1951--REDEF    1951--REDEF
B$TCB.ALT$
      1957**DCL      3672>>ASSIGN   3673>>CALL
B$TCB$
      1825**DCL      3672>>ASSIGN   3673>>CALL
BAILOUT
      3672**LABEL    3596--GOTO     3611--GOTO
CLOSE_M$DO.SN_
      2087**DCL      2087--REDEF
CLOSE_M$DO.UTL_
      2088**DCL      2088--REDEF
CLOSE_M$DO.V
      2092**DCL      2087--DCLINIT
CLOSE_M$DO.V.EXPIRE#
      2102**DCL      2102--REDEF
CLOSE_M$DO.V.TYPE#
      2100**DCL      2100--REDEF
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:43   
CLOSE_M$DO.V.XTNSIZE#
      2097**DCL      2097--REDEF    2099--REDEF
CLOSE_M$LL.SN_
      2174**DCL      2174--REDEF
CLOSE_M$LL.UTL_
      2175**DCL      2175--REDEF
CLOSE_M$LL.V
      2179**DCL      2174--DCLINIT
CLOSE_M$LL.V.EXPIRE#
      2189**DCL      2189--REDEF
CLOSE_M$LL.V.TYPE#
      2187**DCL      2187--REDEF
CLOSE_M$LL.V.XTNSIZE#
      2184**DCL      2184--REDEF    2186--REDEF
CLOSE_M$LO.SN_
      2217**DCL      2217--REDEF
CLOSE_M$LO.UTL_
      2218**DCL      2218--REDEF
CLOSE_M$LO.V
      2222**DCL      2217--DCLINIT
CLOSE_M$LO.V.EXPIRE#
      2232**DCL      2232--REDEF
CLOSE_M$LO.V.TYPE#
      2230**DCL      2230--REDEF
CLOSE_M$LO.V.XTNSIZE#
      2227**DCL      2227--REDEF    2229--REDEF
CLOSE_M$RU
      2044**DCL      3594<>CALL     3625<>CALL
CLOSE_M$RU.SN_
      2044**DCL      2044--REDEF
CLOSE_M$RU.UTL_
      2045**DCL      2045--REDEF
CLOSE_M$RU.V
      2049**DCL      2044--DCLINIT
CLOSE_M$RU.V.EXPIRE#
      2059**DCL      2059--REDEF
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:44   
CLOSE_M$RU.V.TYPE#
      2057**DCL      2057--REDEF
CLOSE_M$RU.V.XTNSIZE#
      2054**DCL      2054--REDEF    2056--REDEF
CLOSE_M$SI.SN_
      2260**DCL      2260--REDEF
CLOSE_M$SI.UTL_
      2261**DCL      2261--REDEF
CLOSE_M$SI.V
      2265**DCL      2260--DCLINIT
CLOSE_M$SI.V.EXPIRE#
      2275**DCL      2275--REDEF
CLOSE_M$SI.V.TYPE#
      2273**DCL      2273--REDEF
CLOSE_M$SI.V.XTNSIZE#
      2270**DCL      2270--REDEF    2272--REDEF
CLOSE_PIGLET
      2131**DCL      3584<>CALL
CLOSE_PIGLET.SN_
      2131**DCL      2131--REDEF
CLOSE_PIGLET.UTL_
      2132**DCL      2132--REDEF
CLOSE_PIGLET.V
      2136**DCL      2131--DCLINIT
CLOSE_PIGLET.V.EXPIRE#
      2146**DCL      2146--REDEF
CLOSE_PIGLET.V.TYPE#
      2144**DCL      2144--REDEF
CLOSE_PIGLET.V.XTNSIZE#
      2141**DCL      2141--REDEF    2143--REDEF
COMMON_OPEN_M$RU
      3587**LABEL    3617--GOTO
F$DCB.ACTPOS
      1992**DCL      1992--REDEF
F$DCB.ARS#
      1966**DCL      1966--REDEF    3568>>ASSIGN   3613>>ASSIGN   3661>>ASSIGN
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:45   
F$DCB.ATTR
      1985**DCL      1986--REDEF
F$DCB.BORROW
      2000**DCL      2000--REDEF    2000--REDEF    2000--REDEF
F$DCB.DCBNAME.L
      2014**DCL      2014--IMP-SIZ
F$DCB.EOMCHAR#
      1970**DCL      1970--REDEF
F$DCB.FCD#
      1979**DCL      3624>>IF
F$DCB.FFLG.EXEC#
      1972**DCL      3592>>IF
F$DCB.FLDID
      1995**DCL      1995--REDEF
F$DCB.FORM$
      1989**DCL      1989--REDEF
F$DCB.FSECT
      2005**DCL      2005--REDEF
F$DCB.FSN#
      1982**DCL      1982--REDEF    1982--REDEF    1983--REDEF
F$DCB.HEADER$
      1988**DCL      1988--REDEF
F$DCB.IXTNSIZE#
      1986**DCL      1986--REDEF
F$DCB.LASTSTA$
      1975**DCL      1975--REDEF
F$DCB.LVL
      2001**DCL      2001--REDEF
F$DCB.NAME#.C
      1976**DCL      1976--REDEF
F$DCB.NOEOF
      1998**DCL      1998--REDEF
F$DCB.NRECS#
      1987**DCL      1987--REDEF
F$DCB.NRECX
      2006**DCL      2006--REDEF
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:46   
F$DCB.OHDR
      1998**DCL      1998--REDEF
F$DCB.ORG#
      1981**DCL      1981--REDEF
F$DCB.PRECNO
      2004**DCL      2004--REDEF
F$DCB.RCSZ
      2010**DCL      2010--REDEF
F$DCB.RES#
      1977**DCL      1977--REDEF
F$DCB.SETX
      1989**DCL      1989--REDEF
F$DCB.TAB$
      1989**DCL      1989--REDEF
F$DCB.TDA
      2003**DCL      2004--REDEF
F$DCB.WSN#
      1977**DCL      1977--REDEF
FALSE
      1820**DCL      3603>>ASSIGN
FID_M$RU
      2298**DCL      3590<>CALL
FID_M$RU.TEXTFID_
      2298**DCL      3589<<ASSIGN
FID_M$RU.V
      2302**DCL      2298--DCLINIT
HNDLR_FPRG
      3416**DCL      2644--DCLINIT
IN_OPTS.WARN_CODE
      1035**DCL      3606>>IF       3606>>IF
IO_TYPE
      1812**DCL        13--PROC     3528>>DOCASE   3549>>DOCASE   3641>>DOCASE
KPE$ERRMSG
      1924**DCL-ENT  3673--CALL
KPE$ERROR
      1862**DCL-ENT  3595--CALL
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:47   
KP_A_OUTBUF
       863**DCL      3628>>ASSIGN
KP_A_OUTVFC
       863**DCL      3629>>DOCASE
KP_ERRDCB
       943**DCL      3672<<ASSIGN
KP_EXIT.V.STEPCC#
       940**DCL       940--REDEF
KP_FECG_IN
       865**DCL      3076--DCLINIT  3077--DCLINIT
KP_FECG_OUT
       866**DCL      3274--DCLINIT  3275--DCLINIT
KP_FECG_OUT_SIZE
       866**DCL      3580>>ASSIGN
KP_FEP_NO
       868**DCL      3572>>CALLBLT
KP_FEP_TEXT
       869**DCL      3572<<CALLBLT  3573>>CALLBLT
KP_FILE_NAME
       869**DCL      2323--DCLINIT  3589--ASSIGN
KP_FPARAM
       872**DCL      2416--DCLINIT
KP_INBUF
       862**DCL       862--REDEF    3034--DCLINIT  3035--DCLINIT  3116--DCLINIT  3117--DCLINIT  3565<<ASSIGN
      3601<<ASSIGN   3659<<ASSIGN
KP_INPUT_COUNT
       862**DCL      3564<<ASSIGN   3566>>DOWHILE  3568<<ASSIGN   3613<<ASSIGN   3661<<ASSIGN
KP_OUTBUF
       863**DCL      3536>>ASSIGN
KP_OUTPUT_DISP
       873**DCL      3616>>ASSIGN
KP_OUTVFC
       863**DCL      3537>>DOCASE
KP_RU_KEY
       870**DCL       871--REDEF    3032--DCLINIT  3033--DCLINIT  3171--DCLINIT
KP_RU_KEY.NODE
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:48   
       870**DCL       870--REDEF
KP_RU_KEY.PAGE
       871**DCL       871--REDEF
KP_RU_OUTBUF
       864**DCL       864--REDEF    3172--DCLINIT  3173--DCLINIT
KP_RU_RECL
       865**DCL      3620>>ASSIGN
M$CLOSE
       628**DCL-ENT  3584--CALL     3594--CALL     3625--CALL     3652--CALL     3653--CALL     3654--CALL
      3655--CALL
M$FID
       691**DCL-ENT  3590--CALL
M$OPEN
       628**DCL-ENT  3531--CALL     3532--CALL     3533--CALL     3534--CALL     3574--CALL     3591--CALL
M$READ
       629**DCL-ENT  3567--CALL     3577--CALL     3604--CALL     3660--CALL
M$RU
      1830**DCL      3592--IF       3613--ASSIGN   3624--IF
M$RU_ACCT
      3403**DCL      2299--DCLINIT  2416--DCLINIT
M$RU_NAME
      3451**DCL      2299--DCLINIT  2412--DCLINIT
M$RU_PASS
      3464**DCL      2300--DCLINIT  2413--DCLINIT
M$RU_RESULTS
      3516**DCL      2302--DCLINIT
M$RU_SN
      3477**DCL      2300--DCLINIT  2411--DCLINIT
M$RU_WSN
      3490**DCL      2300--DCLINIT  2417--DCLINIT
M$SI
      1835**DCL      3563>>ASSIGN
M$UC
       652**DCL      3658>>ASSIGN
M$UNFID
       691**DCL-ENT  3598--CALL
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:49   
M$WRITE
       629**DCL-ENT  3552--CALL     3555--CALL     3558--CALL     3581--CALL     3621--CALL     3644--CALL
      3647--CALL     3667--CALL
MONERR
      3667**LABEL    3552--CALLALT  3555--CALLALT  3558--CALLALT  3567--CALLALT  3574--CALLALT  3577--CALLALT
      3581--CALLALT  3584--CALLALT  3590--CALLALT  3591--CALLALT  3594--CALLALT  3598--CALLALT  3609--GOTO
      3621--CALLALT  3625--CALLALT  3644--CALLALT  3647--CALLALT  3660--CALLALT  3667--CALLALT
OBUF
      1813**DCL      3206--DCLINIT  3207--DCLINIT  3308--DCLINIT  3309--DCLINIT  3342--DCLINIT  3343--DCLINIT
OBUF.MESS
      1815**DCL      3536<<ASSIGN   3666<<ASSIGN
OBUF.VFC
      1814**DCL      3540<<ASSIGN   3543<<ASSIGN   3546<<ASSIGN   3665<<ASSIGN
OPEN_M$DO
      2521**DCL      3531<>CALL     3652<>CALL
OPEN_M$DO.ACSVEH_
      2523**DCL      2524--REDEF
OPEN_M$DO.ALTKEYS_
      2529**DCL      2530--REDEF    2530--REDEF
OPEN_M$DO.HDR_
      2528**DCL      2529--REDEF
OPEN_M$DO.TAB_
      2527**DCL      2528--REDEF
OPEN_M$DO.UHL_
      2521**DCL      2522--REDEF    2522--REDEF
OPEN_M$DO.V
      2530**DCL      2521--DCLINIT
OPEN_M$DO.V.FSN#
      2561**DCL      2561--REDEF    2561--REDEF
OPEN_M$DO.WSN_
      2527**DCL      2527--REDEF
OPEN_M$LL
      2746**DCL      3532<>CALL     3653<>CALL
OPEN_M$LL.ACSVEH_
      2748**DCL      2749--REDEF
OPEN_M$LL.ALTKEYS_
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:50   
      2754**DCL      2755--REDEF    2755--REDEF
OPEN_M$LL.HDR_
      2753**DCL      2754--REDEF
OPEN_M$LL.TAB_
      2752**DCL      2753--REDEF
OPEN_M$LL.UHL_
      2746**DCL      2747--REDEF    2747--REDEF
OPEN_M$LL.V
      2755**DCL      2746--DCLINIT
OPEN_M$LL.V.FSN#
      2786**DCL      2786--REDEF    2786--REDEF
OPEN_M$LL.WSN_
      2752**DCL      2752--REDEF
OPEN_M$LO
      2856**DCL      3533<>CALL     3654<>CALL
OPEN_M$LO.ACSVEH_
      2858**DCL      2859--REDEF
OPEN_M$LO.ALTKEYS_
      2864**DCL      2865--REDEF    2865--REDEF
OPEN_M$LO.HDR_
      2863**DCL      2864--REDEF
OPEN_M$LO.TAB_
      2862**DCL      2863--REDEF
OPEN_M$LO.UHL_
      2856**DCL      2857--REDEF    2857--REDEF
OPEN_M$LO.V
      2865**DCL      2856--DCLINIT
OPEN_M$LO.V.FSN#
      2896**DCL      2896--REDEF    2896--REDEF
OPEN_M$LO.WSN_
      2862**DCL      2862--REDEF
OPEN_M$RU
      2411**DCL      3591<>CALL
OPEN_M$RU.ACSVEH_
      2413**DCL      2414--REDEF
OPEN_M$RU.ALTKEYS_
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:51   
      2419**DCL      2420--REDEF    2420--REDEF
OPEN_M$RU.HDR_
      2418**DCL      2419--REDEF
OPEN_M$RU.TAB_
      2417**DCL      2418--REDEF
OPEN_M$RU.UHL_
      2411**DCL      2412--REDEF    2412--REDEF
OPEN_M$RU.V
      2420**DCL      2411--DCLINIT
OPEN_M$RU.V.ASN#
      2430**DCL      2301--DCLINIT
OPEN_M$RU.V.EXIST#
      2424**DCL      3587<<ASSIGN   3616<<ASSIGN
OPEN_M$RU.V.FSN#
      2451**DCL      2451--REDEF    2451--REDEF
OPEN_M$RU.V.RES#
      2435**DCL      2301--DCLINIT
OPEN_M$RU.WSN_
      2417**DCL      2417--REDEF
OPEN_M$SI
      2966**DCL      3534<>CALL     3655<>CALL
OPEN_M$SI.ACSVEH_
      2968**DCL      2969--REDEF
OPEN_M$SI.ALTKEYS_
      2974**DCL      2975--REDEF    2975--REDEF
OPEN_M$SI.HDR_
      2973**DCL      2974--REDEF
OPEN_M$SI.TAB_
      2972**DCL      2973--REDEF
OPEN_M$SI.UHL_
      2966**DCL      2967--REDEF    2967--REDEF
OPEN_M$SI.V
      2975**DCL      2966--DCLINIT
OPEN_M$SI.V.FSN#
      3006**DCL      3006--REDEF    3006--REDEF
OPEN_M$SI.WSN_
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:52   
      2972**DCL      2972--REDEF
OPEN_PIGLET
      2636**DCL      3574<>CALL
OPEN_PIGLET.ACSVEH_
      2638**DCL      2639--REDEF
OPEN_PIGLET.ALTKEYS_
      2644**DCL      2645--REDEF    2645--REDEF
OPEN_PIGLET.HDR_
      2643**DCL      2644--REDEF
OPEN_PIGLET.TAB_
      2642**DCL      2643--REDEF
OPEN_PIGLET.UHL_
      2636**DCL      2637--REDEF    2637--REDEF
OPEN_PIGLET.V
      2645**DCL      2636--DCLINIT
OPEN_PIGLET.V.FSN#
      2676**DCL      2676--REDEF    2676--REDEF
OPEN_PIGLET.V.RES#
      2660**DCL      3573<<CALLBLT
OPEN_PIGLET.WSN_
      2642**DCL      2642--REDEF
READ_COMMAND
      3114**DCL      3567<>CALL     3660<>CALL
READ_COMMAND.STATION_
      3117**DCL      3118--REDEF
READ_COMMAND.V
      3118**DCL      3114--DCLINIT
READ_COMMAND.V.DCB#
      3118**DCL      3563<<ASSIGN   3568--ASSIGN   3658<<ASSIGN   3661--ASSIGN
READ_COMMAND.V.DVBYTE.REREAD#
      3129**DCL      3129--REDEF
READ_COMMAND.V.INDX#
      3127**DCL      3127--REDEF
READ_M$RU
      3032**DCL      3604<>CALL
READ_M$RU.STATION_
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:53   
      3035**DCL      3036--REDEF
READ_M$RU.V
      3036**DCL      3032--DCLINIT
READ_M$RU.V.DVBYTE.REREAD#
      3047**DCL      3047--REDEF
READ_M$RU.V.INDX#
      3045**DCL      3045--REDEF
READ_M$RU.V.KEYR#
      3037**DCL      3603<<ASSIGN
READ_M$RU.V.KEYS#
      3037**DCL      3602<<ASSIGN
READ_PIGLET
      3074**DCL      3577<>CALL
READ_PIGLET.STATION_
      3077**DCL      3078--REDEF
READ_PIGLET.V
      3078**DCL      3074--DCLINIT
READ_PIGLET.V.DVBYTE.REREAD#
      3089**DCL      3089--REDEF
READ_PIGLET.V.INDX#
      3087**DCL      3087--REDEF
TRUE
      1819**DCL      3602>>ASSIGN
UNFID_M$RU
      2323**DCL      3598<>CALL
UNFID_M$RU.V
      2327**DCL      2323--DCLINIT
WAIT_ONE.V
      3149**DCL      3148--DCLINIT
WRITE_A_M$DO
      3239**DCL      3644<>CALL
WRITE_A_M$DO.STATION_
      3241**DCL      3241--REDEF
WRITE_A_M$DO.V
      3242**DCL      3239--DCLINIT
WRITE_A_M$DO.V.DVBYTE.VFC#
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:54   
      3248**DCL      3248--REDEF
WRITE_A_M$LO
      3375**DCL      3647<>CALL
WRITE_A_M$LO.STATION_
      3377**DCL      3377--REDEF
WRITE_A_M$LO.V
      3378**DCL      3375--DCLINIT
WRITE_A_M$LO.V.DVBYTE.VFC#
      3384**DCL      3384--REDEF
WRITE_M$DO
      3205**DCL      3552<>CALL
WRITE_M$DO.STATION_
      3207**DCL      3207--REDEF
WRITE_M$DO.V
      3208**DCL      3205--DCLINIT
WRITE_M$DO.V.DVBYTE.VFC#
      3214**DCL      3214--REDEF
WRITE_M$LL
      3307**DCL      3555<>CALL
WRITE_M$LL.STATION_
      3309**DCL      3309--REDEF
WRITE_M$LL.V
      3310**DCL      3307--DCLINIT
WRITE_M$LL.V.DVBYTE.VFC#
      3316**DCL      3316--REDEF
WRITE_M$LO
      3341**DCL      3558<>CALL     3667<>CALL
WRITE_M$LO.STATION_
      3343**DCL      3343--REDEF
WRITE_M$LO.V
      3344**DCL      3341--DCLINIT
WRITE_M$LO.V.DVBYTE.VFC#
      3350**DCL      3350--REDEF
WRITE_M$RU
      3171**DCL      3621<>CALL
WRITE_M$RU.BUF_.BOUND
PL6.E3A0      #001=KPI$IO_SVC File=KPI$IO_SVC.:E05TSI                            WED 07/30/97 01:19 Page:55   
      3171**DCL      3620<<ASSIGN
WRITE_M$RU.STATION_
      3173**DCL      3173--REDEF
WRITE_M$RU.V
      3174**DCL      3171--DCLINIT
WRITE_M$RU.V.DVBYTE.VFC#
      3180**DCL      3180--REDEF
WRITE_PIGLET
      3273**DCL      3581<>CALL
WRITE_PIGLET.BUF_.BOUND
      3273**DCL      3580<<ASSIGN
WRITE_PIGLET.STATION_
      3275**DCL      3275--REDEF
WRITE_PIGLET.V
      3276**DCL      3273--DCLINIT
WRITE_PIGLET.V.DVBYTE.VFC#
      3282**DCL      3282--REDEF
