VERSION E05

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:1    
        1        1        /*M* FOO$OUTSYM Main routine for OUTSYM ghost */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         FOO$OUTSYM
       10       10
       11       11             PURPOSE:      To provide the main routine for the OUTSYM ghost
       12       12
       13       13             DESCRIPTION:  FOO$OUTSYM is the main routine for the OUTSYM
       14       14                           ghost, which provides and/or controls all the
       15       15                           CP6 output symbiont functions performed in the
       16       16                           host.
       17       17
       18       18                           Output symbiont files are built by the output
       19       19                           COOP in account :SYMO.  When an output file
       20       20                           is closed, the OUTSYM ghost gets an event telling
       21       21                           him of the file name (SYSID and uniquifying ex-
       22       22                           tension integer).
       23       23
       24       24                           OUTSYM is the administrative user of the OSCG
       25       25                           (OUTSYM COMGROUP), and thus receives events
       26       26                           relative to connect and disconnect of devices
       27       27                           belonging to that comgroup (i.e. output symbiont
       28       28                           devices).
       29       29
       30       30                           OUTSYM is also plugged into the central system
       31       31                           comgroup (CSCG) as an ordinary user, in order
       32       32                           to be able to receive keyins and send messages
       33       33                           to various consoles.
       34       34
       35       35                           The actual reading of symbiont files and the
       36       36                           transmittal of granules to their eventual
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:2    
       37       37                           destinations (i.e. IOQ or FEP) is done by MOOS,
       38       38                           the monitor part of OUTSYM, who bears the same
       39       39                           relationship to the OUTSYM ghost as CP-V OUTSYM
       40       40                           did to RBBAT.  OUTSYM communicates with MOOS
       41       41                           via the M$SYMBIO PMME, and MOOS communicates with
       42       42                           OUTSYM via AU messages on the OSCG.
       43       43        */
       44       44        /**/
       45       45        /**/
       46       46        FOO$OUTSYM: PROC MAIN;
       47       47
       48       48
       49       49
       50       50        /**/
       51       51        /* INCLUDES */
       52       52        /**/
       53       53        %INCLUDE CP_6;
       54      134        %INCLUDE F$DCB;
       55      183        %INCLUDE OC_MESSHD_C;
       56      236        %INCLUDE JG_EVID_C;
       57      461        %INCLUDE F_ERRORS_C;
       58      701        %INCLUDE FOO_SUBS_C;
       59      937        %INCLUDE FO_ERRORS_C;
       60      969        %INCLUDE FOO_MAC_C;
       61     1717        %INCLUDE FS$FIT;
       62     1760        %INCLUDE FOO_DATA_R;
       63     2926        %INCLUDE OC_SUBS_C;
       64     3657        %INCLUDE FOM_SUBS_C;
       65     3720        %INCLUDE FO_SCODE_C;
       66     3748        %INCLUDE KC_ERRORS_C;
       67     3795        %INCLUDE NK_SUBS;
       68     3820        %INCLUDE CP_6_SUBS;
       69     4360        %INCLUDE KC_SUBS_C;
       70     4376        %INCLUDE FOS_SUBS_C;
       71     4393        %INCLUDE B$ROSEG;
       72     4456        %INCLUDE JG_GHOSTS_C;
       73     4546        %INCLUDE JC_MACRO_C;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:3    
       74     4660        %INCLUDE JM$STRUCT;
       75     5405 S      %INCLUDE B$JIT_C;
       76     5406        %INCLUDE KL_SUPER_C;
       77     8308        /* SPECIAL SUBS */
       78     8309        %EQU_CG;
       79     8357
       80     8358
       81     8359
       82     8360        /**/
       83     8361        /*  BASED STRUCTURES */
       84     8362        /**/
       85     8363    1   DCL PTR$ PTR BASED;
       86     8364        %B$TCB (STCLASS="BASED(B$TCB$)");
       87     8367        %B$ALT;
       88     8375        %FS_OSFN (FPTN=FS$OSFN,STCLASS=BASED);
       89     8389        %KL_WSNDEV;
       90     8394        %FO_CONINFO (FPTN=FO$CONINFO,STCLASS=BASED);
       91     8425        %B$CGAURD (FPTN=B$CGAURD,LAST=",");
       92     8444        %B$CGAUCI (FPTN=CONINFO,LVL=2,LAST=",");
       93     8466        %FO_CONINFO (FPTN=FOINFO,LVL=2,STCLASS=BASED);
       94     8497        %FO_CITE (FPTN=FO$JOBEV ,TYP=JOB ,STCLASS=BASED);
       95     8556        %FO_CITE (FPTN=FO$MBSEV ,TYP=MBS ,STCLASS=BASED);
       96     8615        %FO_CITE (FPTN=FO$SYEV  ,TYP=GMSY,STCLASS=BASED);
       97     8674        %B$JIT0;
       98     8763        %A$JIT6X;
       99     8766
      100     8767
      101     8768
      102     8769        /**/
      103     8770        /*  AUTO */
      104     8771        /**/
      105     8772    1   DCL M_FILE1$ PTR;
      106     8773    1   DCL I UBIN WORD;
      107     8774    1   DCL IR REDEF I SBIN;
      108     8775    1   DCL J UBIN WORD;
      109     8776    1   DCL WSN$ PTR;
      110     8777    1   DCL WSNDEV$ PTR;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:4    
      111     8778    1   DCL WSN_LNK$ PTR;
      112     8779    1   DCL OSYMB$ PTR;
      113     8780    1   DCL TALLY UBIN WORD;
      114     8781    1   DCL NUM UBIN WORD;
      115     8782    1   DCL EVNT$ PTR;
      116     8783    1   DCL P$ PTR;
      117     8784    1   DCL KEYIN$ PTR;
      118     8785    1   DCL BATCHFLG UBIN WORD;
      119     8786    1   DCL PRIO UBIN WORD;
      120     8787    1   DCL KERR UBIN WORD;
      121     8788    1   DCL FIL_BOOTID CHAR(3) ALIGNED;
      122     8789    1   DCL FIL_SYSID UBIN WORD;
      123     8790    1   DCL FIL_NUM UBIN WORD;
      124     8791    1   DCL FIL_NUMR REDEF FIL_NUM SBIN WORD;
      125     8792    1   DCL FIL_CNUM UBIN WORD;
      126     8793    1   DCL EXT$ PTR;
      127     8794    1   DCL JOB_SYSID UBIN WORD;
      128     8795    1   DCL GORGO_SYSID UBIN WORD ALIGNED;
      129     8796    1   DCL SPILLDISP UBIN WORD;
      130     8797    1   DCL NXTFIL$ PTR;
      131     8798    1   DCL EVXLATE (0:%CG_MAX#) UBIN WORD;
      132     8799    1   DCL INFO UBIN WORD;
      133     8800    1   DCL 1 INFOB REDEF INFO,
      134     8801    1         2 BLK# UBIN(18) UNAL,
      135     8802    1         2 REC# UBIN(18) UNAL;
      136     8803    1   DCL DEVENT UBIN WORD;
      137     8804    1   DCL NDEV UBIN WORD;
      138     8805    1   DCL BTWSN UBIN WORD;
      139     8806    1   DCL CGAURD$ PTR;
      140     8807    1   DCL CITE$ PTR;
      141     8808    1   DCL BLK# UBIN;
      142     8809    1   DCL BLK#R REDEF BLK# SBIN;
      143     8810    1   DCL PG# UBIN;
      144     8811    1   DCL FILE_ADDED BIT(1);
      145     8812
      146     8813
      147     8814
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:5    
      148     8815        /**/
      149     8816        /*  STATIC */
      150     8817        /**/
      151     8818    1   DCL NOSTART SBIN WORD STATIC ALIGNED INIT(1);
      152     8819    1   DCL UNEXPT SBIN WORD STATIC ALIGNED INIT(0);
      153     8820    1   DCL GOODNGT SBIN WORD STATIC ALIGNED INIT(0);
      154     8821    1   DCL TIMEASLEEP SBIN WORD STATIC ALIGNED INIT(0);
      155     8822    1   DCL HEXPIRE SBIN STATIC INIT(1800);
      156     8823    1   DCL KDEVNAME CHAR(8) STATIC DALIGNED;
      157     8824        %FO_DKEYIN                             (FPTN=LOCKKEYIN,
      158     8825                 IKIN#     = KEY_LOCK#,
      159     8826                 STCLASS   = STATIC);
      160     8858    1   DCL DEVNAME CHAR(8) STATIC DALIGNED;
      161     8859    1   DCL 1 DEVNAMER REDEF DEVNAME DALIGNED,
      162     8860    1         2 TYP CHAR(2) UNAL,
      163     8861    1         2 NUM CHAR(2) UNAL,
      164     8862    1         2 TWSN# CHAR(4) UNAL;
      165     8863        %OC_MESSHD_D       (NAME=OPMSG_KERR,
      166     8864                 NPARMS    = 3,
      167     8865                 ATR       = M_UR,
      168     8866                 MSG       = 0,
      169     8867                 STCLASS   = STATIC);
      170     8880    1         2 * UBIN BYTE UNAL INIT(1),
      171     8881    1         2 * UBIN BYTE UNAL INIT(1),
      172     8882    1         2 * UBIN BYTE UNAL INIT(8),
      173     8883    1         2 SUBC UBIN BYTE UNAL,
      174     8884    1         2 SUBC1 UBIN BYTE UNAL,
      175     8885    1         2 TNAME CHAR(8) UNAL;
      176     8886        %OC_MESSHD_D            (NAME=OPMSG_TDSC,
      177     8887                 NPARMS    = 1,
      178     8888                 ATR       = M_UR,
      179     8889                 MSG       = FO_TDSC_MSG#,
      180     8890                 STCLASS   = STATIC);
      181     8903    1         2 * UBIN BYTE UNAL INIT(1),
      182     8904    1         2 SUBC UBIN BYTE UNAL;
      183     8905        %OC_MESSHD_D            (NAME=OPMSG_UNIMP,
      184     8906                 NPARMS    = 0,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:6    
      185     8907                 MSG       = UNIMP_MSG#,
      186     8908                 DELIM     =";",
      187     8909                 STCLASS   = STATIC);
      188     8922        %OC_MESSHD_D            (NAME=OPMSG_DINFO,
      189     8923                 NPARMS     = 19,
      190     8924                 ATR       = M_UR,
      191     8925                 MSG       = FO_DDSP_MSG#,
      192     8926                 STCLASS   = STATIC);
      193     8939    1         2 * UBIN BYTE UNAL INIT(1),
      194     8940    1         2 * UBIN BYTE UNAL INIT(1),
      195     8941    1         2 * UBIN BYTE UNAL INIT(1),
      196     8942    1         2 * UBIN BYTE UNAL INIT(2),
      197     8943    1         2 * UBIN BYTE UNAL INIT(2),
      198     8944    1         2 * UBIN BYTE UNAL INIT(8),
      199     8945    1         2 * UBIN BYTE UNAL INIT(1),
      200     8946    1         2 * UBIN BYTE UNAL INIT(6),
      201     8947    1         2 * UBIN BYTE UNAL INIT(4),
      202     8948    1         2 * UBIN BYTE UNAL INIT(1),
      203     8949    1         2 * UBIN BYTE UNAL INIT(1),
      204     8950    1         2 * UBIN BYTE UNAL INIT(8),
      205     8951    1         2 * UBIN BYTE UNAL INIT(1),
      206     8952    1         2 * UBIN BYTE UNAL INIT(8),
      207     8953    1         2 * UBIN BYTE UNAL INIT(1),
      208     8954    1         2 * UBIN BYTE UNAL INIT(8),
      209     8955    1         2 * UBIN BYTE UNAL INIT(1),
      210     8956    1         2 * UBIN BYTE UNAL INIT(4),
      211     8957    1         2 * UBIN BYTE UNAL INIT(1),
      212     8958    1         2 STATE UBIN BYTE UNAL,
      213     8959    1         2 SIP UBIN BYTE UNAL,
      214     8960    1         2 LOCK UBIN BYTE UNAL,
      215     8961    1         2 FSYSID UBIN HALF UNAL,
      216     8962    1         2 FNUM UBIN HALF UNAL,
      217     8963    1         2 ACCT CHAR(8) UNAL,
      218     8964    1         2 SUSRSN UBIN BYTE UNAL,
      219     8965    1         2 FORM CHAR(6) UNAL,
      220     8966    1         2 GRANS UBIN WORD UNAL,
      221     8967    1         2 ALG UBIN BYTE UNAL,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:7    
      222     8968    1         2 SUBC UBIN BYTE UNAL,
      223     8969    1         2 TNAME CHAR(8) UNAL,
      224     8970    1         2 RESTRICT UBIN BYTE UNAL,
      225     8971    1         2 RACCT CHAR(8) UNAL,
      226     8972    1         2 RESTRICTW UBIN BYTE UNAL,
      227     8973    1         2 RWSN CHAR(8) UNAL,
      228     8974    1         2 CONCUR UBIN BYTE UNAL,
      229     8975    1         2 PAGES UBIN WORD UNAL,
      230     8976    1         2 PAGES_OR_RECS UBIN BYTE UNAL;
      231     8977
      232     8978        %OC_MESSHD_D          (NAME=OPMSG_RINFO,
      233     8979                 NPARMS      = 2,
      234     8980                 ATR         = M_UR,
      235     8981                 MSG         = FO_WSN_MSG#,
      236     8982                 STCLASS     = STATIC);
      237     8995    1         2 * UBIN BYTE UNAL INIT(1),
      238     8996    1         2 * UBIN BYTE UNAL INIT(8),
      239     8997    1         2 STATUS UBIN BYTE UNAL,
      240     8998    1         2 WSN_NAME CHAR(8) UNAL;
      241     8999        %OC_MESSHD_D          (NAME=OPMSG_TINFO,
      242     9000                 NPARMS      = 2,
      243     9001                 ATR         = M_UR,
      244     9002                 MSG         = FO_TTL_MSG#,
      245     9003                 STCLASS     = STATIC);
      246     9016    1         2 * UBIN BYTE UNAL INIT(4),
      247     9017    1         2 * UBIN BYTE UNAL INIT(11),
      248     9018    1         2 CNT UBIN WORD UNAL,
      249     9019    1         2 TIME CHAR(11) UNAL;
      250     9020        %OC_MESSHD_D           (NAME=OPMSG_TCON,
      251     9021                 NPARMS       = 2,
      252     9022                 ATR          = M_UR,
      253     9023                 MSG          = FO_WSN_MSG#,
      254     9024                 STCLASS      = STATIC);
      255     9037    1         2 * UBIN BYTE UNAL INIT(1),
      256     9038    1         2 * UBIN BYTE UNAL INIT(8),
      257     9039    1         2 SUBC UBIN BYTE UNAL,
      258     9040    1         2 WSN CHAR(8) UNAL;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:8    
      259     9041
      260     9042
      261     9043        /**/
      262     9044        /* CONSTANT */
      263     9045        /**/
      264     9046        %JC_CITE (FPTN=JC_PCMP,TYP=PCMP,COD=JCEV_PCMP#,USR=JG_OUTSYM#,STCLASS=CONSTANT);
      265     9096        %OC_MESSHD_D            (NAME=ZAPRESP,
      266     9097                 STCLASS   = CONSTANT,
      267     9098                 FUNC      = ZAP,
      268     9099                 DELIM     =";");
      269     9112
      270     9113
      271     9114
      272     9115        /**/
      273     9116        /*  DCBS */
      274     9117        /**/
      275     9118    1   DCL M$OSCG DCB;
      276     9119    1   DCL M$CSCG DCB;
      277     9120    1   DCL M$FILE1 DCB;
      278     9121    1   DCL M$OSYMB DCB;
      279     9122    1   DCL M$HLP DCB;
      280     9123    1   DCL M$FPRG DCB;
      281     9124
      282     9125    1   DCL 1 HLP_KEY STATIC SYMDEF ALIGNED,
      283     9126    1         2 * UBIN BYTE UNAL INIT(12),
      284     9127    1         2 DEVLGN CHAR(8) INIT(' '),
      285     9128    1         2 * CHAR(4) INIT('WSNS');
      286     9129
      287     9130    1   DCL THROTTLE_UTS UBIN WORD STATIC ALIGNED INIT(0);
      288     9131    1   DCL 1 TTIME STATIC SYMDEF ALIGNED,
      289     9132    1         2 DATE CHAR(10) UNAL,
      290     9133    1         2 DAY CHAR(3) UNAL,
      291     9134    1         2 TIME CHAR(11) UNAL;
      292     9135
      293     9136
      294     9137
      295     9138        /**/
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:9    
      296     9139        /* REFS */
      297     9140        /**/
      298     9141    1   DCL B$ROS$ PTR SYMREF;
      299     9142    1   DCL B$TCB$ PTR SYMREF;
      300     9143    1   DCL B$JIT$ PTR SYMREF;
      301     9144    1   DCL FOD$EVENT     ENTRY(2) ALTRET;
      302     9145    1   DCL FOD$FSCHK     ENTRY    ALTRET;
      303     9146    1   DCL FOE$EVNT      ENTRY    ASYNC;
      304     9147    1   DCL FOE$XCON      ENTRY    ASYNC;
      305     9148    1   DCL FOF$ADD       ENTRY(5) ALTRET;
      306     9149    1   DCL FOF$CANCEL    ENTRY(3) ALTRET;
      307     9150    1   DCL FOF$CHAIN     ENTRY    ALTRET;
      308     9151    1   DCL FOF$COMPJOB   ENTRY    ALTRET;
      309     9152    1   DCL FOF$ERASE     ENTRY(3) ALTRET;
      310     9153    1   DCL FOF$FILL      ENTRY(5) ALTRET;
      311     9154    1   DCL FOF$FINDJOB   ENTRY(1) ALTRET;
      312     9155    1   DCL FOF$HEXPIRE   ENTRY    ALTRET;
      313     9156    1   DCL FOF$KEYIN     ENTRY(1) ALTRET;
      314     9157    1   DCL FOF$PRIO      ENTRY    ALTRET;
      315     9158    1   DCL FOF$RERUN     ENTRY(3) ALTRET;
      316     9159    1   DCL FOF$SPILLDONE ENTRY(3) ALTRET;
      317     9160    1   DCL FOF$UNCHAIN   ENTRY    ALTRET;
      318     9161    1   DCL FOF$UNHOLD    ENTRY(2) ALTRET;
      319     9162    1   DCL FOI$CRASHGO   ENTRY(3) ALTRET;
      320     9163    1   DCL FOI$GBUF      ENTRY(2) ALTRET;
      321     9164    1   DCL FOI$RBUF      ENTRY(2) ALTRET;
      322     9165    1   DCL FOI$SNAP      ENTRY(4) ALTRET;
      323     9166    1   DCL FOR$CLOSE     ENTRY    ALTRET;
      324     9167    1   DCL FOR$KEYIN     ENTRY(3) ALTRET;
      325     9168    1   DCL FOR$GETMODE   ENTRY(1) ALTRET;
      326     9169    1   DCL FOU$EVENT    ENTRY(2) ALTRET;
      327     9170    1   DCL IGN$SYSID     ENTRY(1);
      328     9171    1   DCL XSF$LOCCODP   ENTRY(2) ALTRET;
      329     9172
      330     9173
      331     9174
      332     9175        /**/
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:10   
      333     9176        /* PMME FPTS */
      334     9177        /**/
      335     9178        %FPT_OPEN                              (FPTN=OPEN_OSCG,
      336     9179                 DCB       = M$OSCG,
      337     9180                 SHARE     = ALL,
      338     9181                 SCRUB     = YES,
      339     9182                 CTG       = YES,
      340     9183                 IXTNSIZE  = %FOMI_CIXT#,
      341     9184                 AU        = YES,
      342     9185                 NAME      = OSCG,
      343     9186                 ACCT      = SYSACCT,
      344     9187                 SETSTA    = OUTSYMNAME,
      345     9188                 ASN       = COMGROUP,
      346     9189                 ORG       = TERMINAL,
      347     9190                 FUN       = CREATE,
      348     9191                 EXIST     = NEWFILE,
      349     9192                 ACCESS    = OSCG_ACCESS,
      350     9193                 STCLASS   = CONSTANT);
      351     9302        %VLP_ATTR                             (FPTN=OSCG_ACCESS);
      352     9316        %VLP_ACCESS                           (STCLASS=CONSTANT,
      353     9317                 READ      = NO,
      354     9318                 UPD       = NO,
      355     9319                 WNEW      = NO,
      356     9320                 DELR      = NO,
      357     9321                 DELF      = NO,
      358     9322                 REATTR    = NO,
      359     9323                 EXEC      = NO,
      360     9324                 ACCT      = '?',
      361     9325                 LAST      =";");
      362     9342        %VLP_CGCP                             (FPTN=OSCGCP,
      363     9343                 TMTYP     = ' ',
      364     9344                 DMTYP     = ' ',
      365     9345                 MAXPG     = %FOMI_CIMP#,
      366     9346                 DISKWARN  = %FOMI_CXMP#,
      367     9347                 MEMWARN   = %FOMI_CXMP#,
      368     9348                 DATAPGS   = 10,
      369     9349                 CONMSG    = YES,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:11   
      370     9350                 DSCREQ    = YES,
      371     9351                 TERMCONAU = NO,
      372     9352                 DCBCONAU  = NO,
      373     9353                 TERMCONNAU= NO,
      374     9354                 DCBCONNAU = NO,
      375     9355                 AUCONTERM = NC,
      376     9356                 AUCONDCB  = NC,
      377     9357                 AUDCONTERM= NC,
      378     9358                 AUDCONDCB = NC,
      379     9359                 XSTALGL   = YES,
      380     9360                 WAS       = NO,
      381     9361                 RAS       = NO,
      382     9362                 SMD       = NO,
      383     9363                 XTYPLGL   = YES,
      384     9364                 MAXMC     = 1024,
      385     9365                 TERMCONLGL= YES,
      386     9366                 DCBCONLGL = YES,
      387     9367                 INPUT     = NO,
      388     9368                 OUTPUT    = YES,
      389     9369                 SECURE    = NO,
      390     9370                 STCLASS   = STATIC);
      391     9413        %FPT_CGCTL                            (FPTN=CTL_OSCG,
      392     9414                 DCB       = M$OSCG,
      393     9415                 CGCP      = OSCGCP,
      394     9416                 STCLASS   = CONSTANT);
      395     9439        %FPT_EXTEND                           (FPTN=EXTEND_OSCG,
      396     9440                 DCB       = M$OSCG,
      397     9441                 SIZ       = %FOMI_CXXT#,
      398     9442                 STCLASS   = CONSTANT);
      399     9456        %VLP_NAME               (FPTN=OSCG,
      400     9457                 STCLASS   = CONSTANT,
      401     9458                 NAME      = 'OSCG');
      402     9485        %VLP_SETSTA                (FPTN=OUTSYMNAME,
      403     9486                 MYSTATION = 'OUTSYM',
      404     9487                 STCLASS   = CONSTANT,
      405     9488                 DIRONLY   = YES,
      406     9489                 WAS       = YES,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:12   
      407     9490                 OSTATION  = 'KEYIN');
      408     9518        %FPT_EVENT                             (FPTN=OSEVENT,
      409     9519                 UENTRY    = FOE$EVNT,
      410     9520                 STCLASS   = CONSTANT);
      411     9534        %FPT_OPEN                              (FPTN=OPEN_CSCG,
      412     9535                 STCLASS   = CONSTANT,
      413     9536                 DCB       = M$CSCG,
      414     9537                 SCRUB     = YES,
      415     9538                 NAME      = CSCG,
      416     9539                 SETSTA    = OUTSYMNAME,
      417     9540                 ASN       = COMGROUP);
      418     9649        %VLP_NAME               (FPTN=CSCG,
      419     9650                 STCLASS   = CONSTANT,
      420     9651                 NAME      = 'CSCG');
      421     9678        %FPT_OPEN                              (FPTN=SCAN_SYMOFD,
      422     9679                 STCLASS   = CONSTANT,
      423     9680                 DCB       = M$FILE1,
      424     9681                 NAME      = NIL,
      425     9682                 ACCT      = SYMOACCT,
      426     9683                 FPARAM    = FO_FITBUF1,
      427     9684                 ASN       = FILE,
      428     9685                 FUN       = IN,
      429     9686                 ACS       = BLOCK,
      430     9687                 NXTF      = YES);
      431     9796        %FPT_OPEN                             (FPTN=OPEN_SYMOFD,
      432     9797                 STCLASS   = CONSTANT,
      433     9798                 DCB       = M$FILE1,
      434     9799                 NAME      = ERASE,
      435     9800                 ACCT      = SYMOACCT,
      436     9801                 FPARAM    = FO_FITBUF1,
      437     9802                 ASN       = FILE,
      438     9803                 FUN       = IN,
      439     9804                 ACS       = BLOCK,
      440     9805                 NXTF      = YES);
      441     9914        %VLP_ACCT               (FPTN=SYMOACCT,
      442     9915                 STCLASS   = CONSTANT,
      443     9916                 ACCT      = ':SYMO');
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:13   
      444     9929        %VLP_ACCT               (FPTN=SYSACCT,
      445     9930                 STCLASS   = CONSTANT,
      446     9931                 ACCT      = ':SYS');
      447     9944        %FPT_CLOSE                             (FPTN=CLOSE_FILE1,
      448     9945                 DCB       = M$FILE1,
      449     9946                 STCLASS   = CONSTANT,
      450     9947                 DISP      = SAVE,
      451     9948                 RELG      = YES);
      452     9990        %FPT_OPEN                           (FPTN=OPEN_HLP,
      453     9991                 NAME=HLP_NAME,
      454     9992                 ASN=FILE,
      455     9993                 ACS=DIRECT,
      456     9994                 DCB=M$HLP,
      457     9995                 FUN=IN,
      458     9996                 SHARE=ALL,
      459     9997                 ACCT=SYSACCT,
      460     9998                 CTG=YES,
      461     9999                 ORG=KEYED);
      462    10108        %VLP_NAME                           (FPTN=HLP_NAME,
      463    10109                 STCLASS=CONSTANT,
      464    10110                 NAME=':HLP');
      465    10137        %FPT_READ                           (FPTN=READ_HLP,
      466    10138                 BUF=FO_FITBUF1,
      467    10139                 DCB=M$HLP,
      468    10140                 KEY=HLP_KEY,
      469    10141                 KEYS=YES,
      470    10142                 WAIT=YES);
      471    10181        %FPT_TRUNC                          (FPTN=TRUNC_HLP,
      472    10182                 DCB=M$HLP,
      473    10183                 STCLASS=CONSTANT);
      474    10197        %FPT_TRUNC                          (FPTN=TRUNC_OSYMB,
      475    10198                 DCB=M$OSYMB,
      476    10199                 STCLASS=CONSTANT);
      477    10213        %FPT_WRITE                          (FPTN=OCMSG_RINFO,
      478    10214                 STCLASS=CONSTANT,
      479    10215                 DCB=M$CSCG,
      480    10216                 BUF=OPMSG_RINFO);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:14   
      481    10247        %FPT_WRITE                          (FPTN=OCMSG_TINFO,
      482    10248                 STCLASS=CONSTANT,
      483    10249                 DCB=M$CSCG,
      484    10250                 BUF=OPMSG_TINFO);
      485    10281        %FPT_WRITE                          (FPTN=OCMSG_TCON,
      486    10282                 STCLASS=STATIC,
      487    10283                 DCB=M$CSCG,
      488    10284                 BUF=OPMSG_TCON);
      489    10315        %FPT_READ                           (FPTN=READ_OSYMB_KEYIN,
      490    10316                 STCLASS=STATIC,
      491    10317                 DCB=M$OSYMB,
      492    10318                 KEYS=YES,
      493    10319                 KEYR=NO,
      494    10320                 KEY=FO_OSYMBKEYROUTE,
      495    10321                 BUF=FO_OSYMBKEYIN);
      496    10360        %FPT_WRITE                          (FPTN=WRITE_OSYMB,
      497    10361                 STCLASS=STATIC,
      498    10362                 DCB=M$OSYMB,
      499    10363                 KEY=FO_OSYMBKEY,
      500    10364                 BUF=FO_OSYMBUF,
      501    10365                 ONEWKEY=YES);
      502    10396        %FPT_WRITE                             (FPTN=OCMSG_TDSC,
      503    10397                 STCLASS   = CONSTANT,
      504    10398                 DCB       = M$CSCG,
      505    10399                 BUF       = OPMSG_TDSC);
      506    10430        %FPT_WRITE                             (FPTN=OCMSG_DINFO,
      507    10431                 STCLASS   = CONSTANT,
      508    10432                 DCB       = M$CSCG,
      509    10433                 BUF       = OPMSG_DINFO);
      510    10464        %FPT_WRITE                             (FPTN=OCMSG_UNIMP,
      511    10465                 STCLASS   = CONSTANT,
      512    10466                 DCB       = M$CSCG,
      513    10467                 BUF       = OPMSG_UNIMP);
      514    10498        %FPT_WRITE                             (FPTN=OCMSG_KERR,
      515    10499                 STCLASS   = CONSTANT,
      516    10500                 DCB       = M$CSCG,
      517    10501                 BUF       = OPMSG_KERR);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:15   
      518    10532        %FPT_ACTIVATE                          (FPTN=DISCT_DEV,
      519    10533                 STCLASS   = CONSTANT,
      520    10534                 DCB       = M$OSCG,
      521    10535                 STATION   = DEVNAME,
      522    10536                 DISCONNECT=YES);
      523    10559        %FPT_ACTIVATE                         (FPTN=DEACT_DEV,
      524    10560                 STCLASS   =CONSTANT,
      525    10561                 DCB       = M$OSCG,
      526    10562                 STATION   = DEVNAME);
      527    10585        %FPT_ACTIVATE                         (FPTN=ACT_FPRG,
      528    10586                 STCLASS   = CONSTANT,
      529    10587                 DCB       = M$OSCG,
      530    10588                 STATION   = MYSTATION);
      531    10611        %VLP_STATION                          (FPTN=MYSTATION,
      532    10612                STCLASS    = CONSTANT,
      533    10613                STATION    = 'OSFPRG');
      534    10640        %FPT_WAIT                              (FPTN=SLEEP,
      535    10641                 STCLASS   = STATIC,
      536    10642                 UETIME    = UNEXPT);
      537    10656        %FPT_WAIT                              (FPTN=SLEEP1,
      538    10657                 STCLASS   = CONSTANT,
      539    10658                 UNITS     = 1);
      540    10672        %FPT_READ                              (FPTN=READ_CSCG,
      541    10673                 STCLASS   = CONSTANT,
      542    10674                 DCB       = M$CSCG,
      543    10675                 WAIT      = NO,
      544    10676                 EVENT     = FO_CSRD#,
      545    10677                 BUF       = FO_CSCGBUF);
      546    10716        %FPT_READ                              (FPTN=READ_OSCG,
      547    10717                 STCLASS   = CONSTANT,
      548    10718                 DCB       = M$OSCG,
      549    10719                 WAIT      = NO,
      550    10720                 EVENT     = FO_OSAU#,
      551    10721                 BUF       = FO_OSCGBUF);
      552    10760        %FPT_XCON                              (FPTN=XCONSET,
      553    10761                 STCLASS   = CONSTANT,
      554    10762                 UENTRY    = FOE$XCON);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:16   
      555    10776        %FPT_JOBSTATS                          (FPTN=MAP_QHDR,
      556    10777                 ORDER     = REMAP,
      557    10778                 STATSEG   = FOSS_SYMHDR#,
      558    10779                 BUF       = FO_Q,
      559    10780                 STCLASS   = CONSTANT);
      560    10800        %FPT_SYMBIO                            (FPTN=INFO_SYMB,
      561    10801                 DCB       = M$OSCG,
      562    10802                 ORDER     = FOMO_INFO#,
      563    10803                 STATION   = KDEVNAME,
      564    10804                 STCLASS   = STATIC);
      565    10828        %FPT_OPEN                              (FPTN=OPEN_OSYMB,
      566    10829                 STCLASS   = STATIC,
      567    10830                 DCB       = M$OSYMB,
      568    10831                 NAME      = OSYMBNAME,
      569    10832                 ACCT      = SYSACCT,
      570    10833                 ASN       = FILE,
      571    10834                 FUN       = CREATE,
      572    10835                 ORG       = KEYED,
      573    10836                 ACS       = DIRECT,
      574    10837                 CTG       = YES,
      575    10838                 SHARE     = ALL,
      576    10839                 EXIST     = OLDFILE);
      577    10948        %VLP_NAME                              (FPTN=OSYMBNAME,
      578    10949                 NAME      = ':OSYMB',
      579    10950                 STCLASS   = CONSTANT);
      580    10977        %FPT_READ                              (FPTN=READ_OSYMB,
      581    10978                 STCLASS   = STATIC,
      582    10979                 DCB       = M$OSYMB,
      583    10980                 KEYS      = YES,
      584    10981                 KEYR      = NO,
      585    10982                 KEY       = FO_OSYMBKEY,
      586    10983                 BUF       = FO_OSYMBUF);
      587    11022        %FPT_SYMBIO                            (FPTN=CHORG_SYMB,
      588    11023                 DCB       = M$OSCG,
      589    11024                 STCLASS   = CONSTANT,
      590    11025                 STATION   = DEVNAME,
      591    11026                 ORDER     = FOMO_CHORG#);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:17   
      592    11050        %FPT_WRITE                             (FPTN=SEND_PCMP,
      593    11051                 STCLASS   = CONSTANT,
      594    11052                 DCB       = M$CSCG,
      595    11053                 BUF       = JC_PCMP,
      596    11054                 STATION   = SLUGNAME);
      597    11085        %VLP_STATION       (FPTN=SLUGNAME,
      598    11086                 STCLASS   = CONSTANT,
      599    11087                 STATION   = 'SLUG  ');
      600    11114        %FPT_CLOSE                             (FPTN=CLOSE_OSYMB,
      601    11115                 DCB       = M$OSYMB,
      602    11116                 STCLASS   = CONSTANT,
      603    11117                 DISP      = SAVE);
      604    11159        %FPT_WRITE                             (FPTN=WRITE_ZAPRESP,
      605    11160                 BUF       = ZAPRESP,
      606    11161                 DCB       = M$CSCG,
      607    11162                 STCLASS   = CONSTANT);
      608    11193        %FPT_PRIV                             (FPTN=EFTPRIV,
      609    11194                 PRIV      = %PR_FMEFT#,
      610    11195                 STCLASS   = CONSTANT);
      611    11210
      612    11211        %FPT_TIME                             (FPTN=THROTTLE_TIME,
      613    11212                 DATE      = TTIME.DATE,
      614    11213                 DAY       = TTIME.DAY,
      615    11214                 DEST      = EXT,
      616    11215                 SOURCE    = UTS,
      617    11216                 TSTAMP    = THROTTLE_UTS,
      618    11217                 TIME      = TTIME.TIME,
      619    11218                 STCLASS   = STATIC);
      620    11237
      621    11238        %FPT_OPEN                             (FPTN=OPEN_FPRG,
      622    11239                 DCB         = M$FPRG,
      623    11240                 SHARE       = ALL,
      624    11241                 FUN         = UPDATE,
      625    11242                 ASN         = COMGROUP,
      626    11243                 SETSTA      = OUTSYMFPRGNAME,
      627    11244                 ACCT        = SYSACCT,
      628    11245                 NAME        = OSCG,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:18   
      629    11246                 ORG         = FPRG,
      630    11247                 STCLASS     = STATIC);
      631    11356
      632    11357        %VLP_SETSTA                           (FPTN=OUTSYMFPRGNAME,
      633    11358                 STCLASS     = CONSTANT,
      634    11359                 MYSTATION   = 'OSFPRG');
      635    11387
      636    11388
      637    11389
      638    11390
      639    11391        /**/
      640    11392        /* SUBS */
      641    11393        /**/
      642    11394        %SUB DEV$=FO_DEV$;
      643    11395        %SUB FIL$=FO_FIL$;
      644    11396        %SUB JOB$=FO_JOB$;
      645    11397        %SUB F_FO='0617'O;
      646    11398        %SUB M_O='17'O;
      647    11399        %SUB B$ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
      648    11400        %SUB FOREVER="WHILE ('1'B)";
      649    11401        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:19   
      650    11402        /*
      651    11403
      652    11404             ###    #   #   #####    ###    #   #   #   #
      653    11405            #   #   #   #     #     #   #   #   #   ## ##
      654    11406            #   #   #   #     #     #        # #    # # #
      655    11407            #   #   #   #     #      ###      #     #   #
      656    11408            #   #   #   #     #         #     #     #   #
      657    11409            #   #   #   #     #     #   #     #     #   #
      658    11410             ###     ###      #      ###      #     #   #
      659    11411
      660    11412
      661    11413                     ###    #   #    ###    #####
      662    11414                      #     #   #     #       #
      663    11415                      #     ##  #     #       #
      664    11416                      #     # # #     #       #
      665    11417                      #     #  ##     #       #
      666    11418                      #     #   #     #       #
      667    11419                     ###    #   #    ###      #
      668    11420
      669    11421        */
      670    11422    1         CALL M$RPRIV (EFTPRIV) ALTRET(NOREFT);
      671    11423    1   NOREFT:;
      672    11424                                /* GET EXIT CONTROL */
      673    11425    1         CALL M$XCON (XCONSET);
      674    11426                                /* SET UP VARIOUS MISCELLANEOUS GOODIES */
      675    11427    1         CALL MISC_SETUP;
      676    11428                                /* SET UP EVENT RECEIVER */
      677    11429    1         CALL M$EVENT (OSEVENT);
      678    11430                                /* CONNECT TO CS COMGROUP */
      679    11431    1         CALL M$OPEN (OPEN_CSCG);
      680    11432    1         CALL M$READ (READ_CSCG);
      681    11433                                /* CONNECT TO OUTSYM COMGROUP */
      682    11434    1         CALL M$OPEN (OPEN_OSCG);
      683    11435    1         CALL M$CGCTL (CTL_OSCG);
      684    11436    1         CALL M$READ (READ_OSCG);
      685    11437
      686    11438    1         CALL M$OPEN (OPEN_FPRG);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:20   
      687    11439                                /* PICK UP EXTANT FILES IN :SYMO */
      688    11440    1         CALL GET_FILES;
      689    11441                                /* Let M$JOBSTATS run */
      690    11442    1         FO_Q.RCVR=0;
      691    11443                           /* Tell SLUG our init is complete */
      692    11444    1         CALL M$WRITE (SEND_PCMP);
      693    11445
      694    11446    1         CALL M$OPEN (OPEN_HLP)
      695    11447    2         WHENALTRETURN DO;
      696    11448        /*N* SNAP */
      697    11449    2           END;
      698    11450        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:21   
      699    11451        /*
      700    11452
      701    11453                    #   #    ###     ###    #   #
      702    11454                    ## ##   #   #     #     #   #
      703    11455                    # # #   #   #     #     ##  #
      704    11456                    #   #   #####     #     # # #
      705    11457                    #   #   #   #     #     #  ##
      706    11458                    #   #   #   #     #     #   #
      707    11459                    #   #   #   #    ###    #   #
      708    11460
      709    11461
      710    11462                    #        ###     ###    ####
      711    11463                    #       #   #   #   #   #   #
      712    11464                    #       #   #   #   #   #   #
      713    11465                    #       #   #   #   #   ####
      714    11466                    #       #   #   #   #   #
      715    11467                    #       #   #   #   #   #
      716    11468                    #####    ###     ###    #
      717    11469
      718    11470        */
      719    11471    2           DO FOREVER;
      720    11472    3             DO INHIBIT;
      721    11473    3             IF FO_EVHD$=ADDR(NIL) THEN
      722    11474    4   NOEVENT:    DO;
      723    11475    4               IF GOODNGT = 0 THEN
      724    11476    4                SLEEP.V.UNITS#=FOMI_DSMI#-TIMEASLEEP;
      725    11477    4               ELSE SLEEP.V.UNITS#=3;
      726    11478    4               CALL M$WAIT(SLEEP);
      727    11479    4               TIMEASLEEP=TIMEASLEEP+SLEEP.V.UNITS#-UNEXPT;
      728    11480    4               HEXPIRE=HEXPIRE-(SLEEP.V.UNITS#-UNEXPT);
      729    11481    4               IF HEXPIRE <= 0 THEN
      730    11482    5                 DO;
      731    11483    5                 HEXPIRE=1800; /* 30 minutes */
      732    11484                                      /* Eliminate "HELD" files */
      733    11485    5                 CALL FOF$HEXPIRE;
      734    11486    5                 END;
      735    11487        /**/
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:22   
      736    11488        /**/
      737    11489    4               IF GOODNGT > 0 THEN
      738    11490    5   ZAPPEND:      DO;
      739    11491    5                 IF TIMEASLEEP > 5 THEN
      740    11492    6   CHKZAP:         DO;
      741    11493    6                   I=0;
      742    11494    6                   DEV$=FO_Q.DEVHD$;
      743    11495    7                     DO WHILE (DEV$ ~= ADDR(NIL));
      744    11496    7                     IF DEV$->FO$DEV.STATE ~= FOS_IDLE# THEN I=1;
      745    11497    7                     DEV$=DEV$->FO$DEV.LNK$;
      746    11498    7                     END;
      747    11499    6                   IF I ~= 0 THEN TIMEASLEEP=0;
      748    11500    6                   ELSE
      749    11501    7   ZAPDUN:           DO;
      750    11502    7                     GOODNGT=-1;
      751    11503    7                     CALL FOR$CLOSE;
      752    11504    7                     CALL M$CLOSE (CLOSE_OSYMB) ALTRET(CA2);
      753    11505    7   CA2:              ;
      754    11506    7                     CALL M$WRITE (WRITE_ZAPRESP);
      755    11507    7                     END ZAPDUN;
      756    11508    6                   END CHKZAP;
      757    11509    5                 END ZAPPEND;
      758    11510        /**/
      759    11511        /**/
      760    11512    4               ELSE
      761    11513    5                 DO;
      762    11514                                      /* See if we have been sleeping for more
      763    11515                                         than 300 seconds (5 minutes). */
      764    11516    5                 IF TIMEASLEEP >= FOMI_DSMI# THEN
      765    11517    6                   DO;
      766    11518                           /* PRINT SETUP SUGGESTIONS FOR DEVICES */
      767    11519    6                   TIMEASLEEP=0;
      768    11520                                      /* Scan :SYMO files. Those queued for
      769    11521                                         idle devices - print message */
      770    11522    6                   CALL FOD$FSCHK;
      771    11523    6                   END;
      772    11524    5                 END;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:23   
      773    11525    4               END NOEVENT;
      774    11526    3             ELSE
      775    11527    4   GOTEVENT:   DO;
      776    11528    4               EVNT$=FO_EVHD$;
      777    11529    4               FO_EVHD$=EVNT$->FO$EVNT.LNK$;
      778    11530    4               IF FO_EVHD$=ADDR(NIL) THEN FO_EVTL$=ADDR(NIL);
      779    11531                                      /* Is there a ZAP in progress? */
      780    11532    4               IF GOODNGT >= 0 THEN
      781    11533    4                CALL EXT_EVENT;
      782    11534    5                 DO CASE (EVNT$->FO$EVNT.ENDAC);
      783    11535    5                   CASE (FOEA_CSCG#);
      784    11536    5                     CALL M$READ (READ_CSCG);
      785    11537    5                   CASE (FOEA_OSCG#);
      786    11538    5                     CALL M$READ (READ_OSCG);
      787    11539    5                 END;
      788    11540                                      /* If NIL then add the event to the end
      789    11541                                         of the circular queue.  Otherwise
      790    11542                                         make the current last event point to
      791    11543                                         new last event. */
      792    11544    4               IF FO_FEVTL$=ADDR(NIL) THEN FO_FEVHD$=EVNT$;
      793    11545    4               ELSE FO_FEVTL$->FO$EVNT.LNK$=EVNT$;
      794    11546                                      /* FO_FEVTL$ is the new last event ptr */
      795    11547    4               FO_FEVTL$=EVNT$;
      796    11548                                      /* Last event on queue points to NIL */
      797    11549    4               EVNT$->FO$EVNT.LNK$=ADDR(NIL);
      798    11550    4               END GOTEVENT;
      799    11551    3             END; /* INHIBIT */
      800    11552    2           END;
      801    11553        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:24   
      802    11554        /*
      803    11555
      804    11556            #####   #   #   #####   #####   ####    #   #    ###    #
      805    11557            #       #   #     #     #       #   #   #   #   #   #   #
      806    11558            #        # #      #     #       #   #   ##  #   #   #   #
      807    11559            ####      #       #     ####    ####    # # #   #####   #
      808    11560            #        # #      #     #       # #     #  ##   #   #   #
      809    11561            #       #   #     #     #       #  #    #   #   #   #   #
      810    11562            #####   #   #     #     #####   #   #   #   #   #   #   #####
      811    11563
      812    11564
      813    11565                    #####   #   #   #####   #   #   #####
      814    11566                    #       #   #   #       #   #     #
      815    11567                    #       #   #   #       ##  #     #
      816    11568                    ####    #   #   ####    # # #     #
      817    11569                    #       #   #   #       #  ##     #
      818    11570                    #        # #    #       #   #     #
      819    11571                    #####     #     #####   #   #     #
      820    11572
      821    11573        */
      822    11574        /*****
      823    11575         *****
      824    11576         *****
      825    11577         *****   PROCESS THE EVENT HERE
      826    11578         *****
      827    11579         *****
      828    11580         *****/
      829    11581        /**/
      830    11582        /*D* NAME:         EXT_EVENT
      831    11583             PURPOSE:      To process an external event
      832    11584             DESCRIPTION:  EVNT$ points to an FO$EVNT frame, in which is a
      833    11585                           code, and a possible CITE$ pointing to an FO$CITE
      834    11586                           frame.
      835    11587        */
      836    11588    1   EXT_EVENT: PROC;
      837    11589    2         FIL$=ADDR(NIL);
      838    11590    2         DEV$=ADDR(NIL);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:25   
      839    11591    2         EXT$=ADDR(NIL);
      840    11592    2         CITE$=EVNT$->FO$EVNT.CITE$;
      841    11593    3           DO CASE (EVNT$->FO$EVNT.CODE);
      842    11594        /***
      843    11595         ***
      844    11596         ***
      845    11597         ***          OSCG ADMIN USER EVENT
      846    11598         ***
      847    11599         ***
      848    11600         ***/
      849    11601                                /* Produced by a read-complete with
      850    11602                                   MSGTYP '*AUEV' */
      851    11603    3             CASE (FOEV_OSAU#);
      852    11604    3               CGAURD$=ADDR(FO_OSCGBUF);
      853    11605    3               DEVNAME=CGAURD$->B$CGAURD.STATION;
      854    11606    4                 DO CASE (CGAURD$->B$CGAURD.EVENT);
      855    11607        /**
      856    11608         **
      857    11609         **      TERMINAL CONNECT
      858    11610         **
      859    11611         **/
      860    11612    4                   CASE (%CG_TCON#);
      861    11613                                                     /**/
      862    11614                                      /* We must deactivate because of the
      863    11615                                         timing window between the open of
      864    11616                                         OSCG and the CGCTL of OSCG.  During
      865    11617                                         this time, stations that connect are
      866    11618                                         ACTIVATED (the default) before we
      867    11619                                         have a chance to turn off this option. */
      868    11620                                                     /**/
      869    11621    4                     CALL M$DEACTIVATE (DEACT_DEV) ALTRET (ALREADY_DEACT);
      870    11622    4   ALREADY_DEACT:
      871    11623    4                     CALL ADD_DEV;
      872    11624    4                     GOTO ENDEVENT;
      873    11625        /**
      874    11626         **
      875    11627         **      COMGROUP LOW-ON-SPACE WARNING
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:26   
      876    11628         **
      877    11629         **/
      878    11630    4                   CASE (%CG_WARN#);
      879    11631    4                     CALL M$EXTEND (EXTEND_OSCG) ALTRET(XTNDALT);
      880    11632    4   XTNDALT:          ;
      881    11633    4                     OSCGCP.MAXPG#=OSCGCP.MAXPG#+%FOMI_CXMP#;
      882    11634    4                     CALL M$CGCTL (CTL_OSCG) ALTRET(XTNDALT0);
      883    11635    4   XTNDALT0:         ;
      884    11636        /**
      885    11637         **
      886    11638         **      M$FPRG DCB OPEN
      887    11639         **
      888    11640         **/
      889    11641    4                   CASE (%CG_DOPN#);
      890    11642    4                     CALL M$ACTIVATE (ACT_FPRG)
      891    11643    5                     WHENALTRETURN DO;
      892    11644    5                       END;
      893    11645
      894    11646    4                     GOTO ENDEVENT;
      895    11647        /**
      896    11648         **
      897    11649         **      FPRG LOAD & TRANSFER CONTROL
      898    11650         **
      899    11651         **/
      900    11652    4                   CASE (%CG_FPLDTRC#);
      901    11653    4                     GOTO ENDEVENT;
      902    11654        /**
      903    11655         **
      904    11656         **      SIMPLE REPORT-EVENT EVENT
      905    11657         **
      906    11658         **/
      907    11659    4                   CASE (%CG_TDSC#,
      908    11660    4                     %CG_TBRK#,
      909    11661    4                     %CG_STDSC#,
      910    11662    4                     %CG_STHLD#,
      911    11663    4                     %CG_SFERR#,
      912    11664    4                     %CG_STERR#,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:27   
      913    11665    4                     %CG_SFEXT#,
      914    11666    4                     %CG_STACK#,
      915    11667    4                     %CG_SFSPA#,
      916    11668    4                     %CG_TDRQ#,
      917    11669    4                     %CG_STOKN#,
      918    11670    4                     %CG_FPABORT#,
      919    11671    4                     %CG_FPEXIT#);
      920    11672                                /* FOR THESE EVENTS WE JUST FIND THE POINTER
      921    11673                                   TO THE DEVICE INVOLVED, AND REPORT THE
      922    11674                                   APPROPRIATE EVENT */
      923    11675
      924    11676    4                     CALL FIND_DEV ALTRET(A11);
      925    11677    4                     INFO=CGAURD$->B$CGAURD.INFO;
      926    11678    4                     DEVENT=EVXLATE(CGAURD$->B$CGAURD.EVENT);
      927    11679    4                     CALL FOD$EVENT(DEVENT,INFO) ALTRET(DEVSCHED);
      928    11680    4                     GOTO ENDEVENT;
      929    11681
      930    11682    4   A11:              IF CGAURD$->B$CGAURD.EVENT = %CG_TDSC#
      931    11683    4                     OR CGAURD$->B$CGAURD.EVENT = %CG_STOKN# THEN GOTO ENDEVENT;
      932    11684    4                     CALL FOI$SNAP (%S$NODEV,F_FO,M_O);
      933    11685        /*S* SCREECH_CODE: FOO-S$NODEV
      934    11686             TYPE:         SNAP
      935    11687             MESSAGE:      Event reported on non-existant device
      936    11688             REMARKS:      A disconnect, break, or similar event has
      937    11689                           been reported, but the named device
      938    11690                           cannot be found.                        */
      939    11691        /**
      940    11692         **
      941    11693         **      ELSE CASE
      942    11694         **
      943    11695         **/
      944    11696    4                   CASE (ELSE);
      945    11697    4                     CALL FOI$SNAP (%S$BADOSAUEV,F_FO,M_O);
      946    11698        /*S* SCREECH_CODE: FOO-S$BADOSAUEV
      947    11699             TYPE:         SNAP
      948    11700             MESSAGE:      Unknown OSAU event passed to OUTSYM
      949    11701             REMARKS:      OUTSYM has received an OUTSYM COMGROUP administrative
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:28   
      950    11702                           user event which he does not recognize.  This sug-
      951    11703                           gests that the path between he and the event issuer
      952    11704                           has been clobbered somewhere, or that someone has
      953    11705                           added a new event OUTSYM does not know about and
      954    11706                           was not expected to get.                */
      955    11707    4                 END; /* CASE OSAU.SUBC */
      956    11708        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:29   
      957    11709        /***
      958    11710         ***
      959    11711         ***
      960    11712         ***          NEW OUTPUT FILE ADDED
      961    11713         ***
      962    11714         ***
      963    11715         ***/
      964    11716    3             CASE (FOEV_NEWF#);
      965    11717    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;
      966    11718    3               FIL_NUM=CITE$->FO$JOBEV.NUM;
      967    11719    3               FIL_CNUM = CITE$->FO$JOBEV.CNUM;
      968    11720                    %JLOCK;
      969    11723    3               CALL FOF$ADD(FIL_SYSID,FIL_NUM,FIL_CNUM,0,FO_BOOTID)
      970    11724    4               WHENRETURN DO;
      971    11725    4                 FILE_ADDED = %YES#;
      972    11726    4                 END;
      973    11727    4               WHENALTRETURN DO;
      974    11728    4                 FILE_ADDED = %NO#;
      975    11729    4                 END;
      976    11730                    %JUNLOCK;
      977    11733                                      /* Check all devices.  If any are IDLE
      978    11734                                         and we have a file to print, change
      979    11735                                         state to busy and start the device */
      980    11736    3               IF FILE_ADDED THEN         /* File added fine, everything is cool */
      981    11737    3   DEVSCHED:    CALL DRIVE_DEVS;                 /* Check for availible devices */
      982    11738        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:30   
      983    11739        /***
      984    11740         ***
      985    11741         ***
      986    11742         ***          KEYIN RECEIVED
      987    11743         ***
      988    11744         ***
      989    11745         ***/
      990    11746    3             CASE (FOEV_KEYIN#);
      991    11747    3               KEYIN$=CITE$;
      992    11748    4                 DO CASE (KEYIN$->FO$DKEYIN.KIN#);
      993    11749        /**
      994    11750         **
      995    11751         ** DEVICE EVENT KEYIN
      996    11752         **
      997    11753         **/
      998    11754    4                   CASE (KEY_SUSPEND#,
      999    11755    4               KEY_ABORT#,
     1000    11756    4               KEY_CONTINUE#,
     1001    11757    4               KEY_SAVE#,
     1002    11758    4               KEY_REPRINT#,
     1003    11759    4               KEY_LOCK#,
     1004    11760    4               KEY_START#,
     1005    11761    4               KEY_ALIGN#,
     1006    11762    4               KEY_RESTRICT#,
     1007    11763    4               KEY_RESTRICTW#,
     1008    11764    4               KEY_SPACE#);
     1009    11765    4                     DEVNAME=KEYIN$->FO$DKEYIN.DEVNM;
     1010    11766    4                     CALL FIND_DEV ALTRET(KEYIN0);
     1011    11767    4                     CALL FOD$EVENT(FODE_KEYN#,KEYIN$) ALTRET(DEVSCHED);
     1012    11768    4                     GOTO ENDEVENT;
     1013    11769    4   KEYIN0:
     1014    11770    4                     OPMSG_KERR.SUBC1 = 0;
     1015    11771    4   KEYIN001:
     1016    11772    4                     OPMSG_KERR.MSG#=FO_KERR_MSG#;
     1017    11773    4                     OPMSG_KERR.SUBC=FOKE_NOTMY#;
     1018    11774    4   KEYIN01:
     1019    11775    4                     OPMSG_KERR.CADDR=KEYIN$->FO$DKEYIN.CADDR;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:31   
     1020    11776    4                     OPMSG_KERR.DEVNM=DEVNAME;
     1021    11777    4                     CALL M$WRITE (OCMSG_KERR);
     1022    11778
     1023    11779    4                   CASE (KEY_ROUTE#,
     1024    11780    4                     KEY_ROUTEADD#,
     1025    11781    4                     KEY_UNROUTE#);
     1026    11782    4                     CALL FOU$EVENT(FODE_KEYN#,KEYIN$)
     1027    11783    5                     WHENRETURN DO;
     1028    11784    5                       GOTO DEVSCHED;
     1029    11785    5                       END;
     1030    11786    5                     WHENALTRETURN DO;
     1031    11787    5                       GOTO ENDEVENT;
     1032    11788    5                       END;
     1033    11789        /**
     1034    11790         **
     1035    11791         ** FILE KEYIN
     1036    11792         **
     1037    11793         **/
     1038    11794    4                   CASE (KEY_PRIOO#,
     1039    11795    4                       KEY_SWITCHO#,
     1040    11796    4                       KEY_DELETEO#,
     1041    11797    4                       KEY_PRIOOACCT#,
     1042    11798    4                       KEY_DELETEOACCT#,
     1043    11799    4                       KEY_SWITCHOACCT#,
     1044    11800    4                       KEY_SWITCHOALL#,
     1045    11801    4                       KEY_SWITCHOFORM#,
     1046    11802    4                       KEY_DELETEOFORM#,
     1047    11803    4                       KEY_PRIOOALL#,
     1048    11804    4                       KEY_DELETEOALL#);
     1049    11805    4                     CALL FOF$KEYIN (KEYIN$);
     1050    11806    4                     GOTO DEVSCHED;
     1051    11807        /**
     1052    11808         **
     1053    11809         ** SYMB KEYINs
     1054    11810         **
     1055    11811         **/
     1056    11812    4                   CASE (KEY_SYMBOTERM#,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:32   
     1057    11813    4                     KEY_SYMBOTERMT#,
     1058    11814    4                     KEY_SYMBOTERMR#);
     1059    11815    4                     OPMSG_DINFO.SUBC=1;
     1060    11816    4                     OPMSG_DINFO.TNAME=KEYIN$->FO$DKEYIN.TNAME;
     1061    11817    4                     GOTO KEYIN1;
     1062    11818    4                   CASE (KEY_SYMBO#,
     1063    11819    4                     KEY_SYMBOT#,
     1064    11820    4                     KEY_SYMBOR#);
     1065    11821    4                     OPMSG_DINFO.SUBC=0;
     1066    11822    4   KEYIN1:           ;
     1067    11823    4                     DEVNAME=KEYIN$->FO$DKEYIN.DEVNM;
     1068    11824    4                     OPMSG_DINFO.CADDR=KEYIN$->FO$DKEYIN.CADDR;
     1069    11825    4                     OPMSG_RINFO.CADDR=KEYIN$->FO$DKEYIN.CADDR;
     1070    11826    4                     OPMSG_TINFO.CADDR=KEYIN$->FO$DKEYIN.CADDR;
     1071    11827                                      /* NDEV is the number of qualified
     1072    11828                                         devices */
     1073    11829    4                     NDEV=0;
     1074    11830
     1075    11831    4                     DEV$=FO_Q.DEVHD$;
     1076    11832    5                       DO WHILE (DEV$ ~= ADDR(NIL));
     1077    11833    5                       IF DEV$->FO$DEV.TNAME = KEYIN$->FO$DKEYIN.TNAME
     1078    11834    5                       OR ( KEYIN$->FO$DKEYIN.TNAME = FOMI_SCTNAME#
     1079    11835    5                       AND DEV$->FO$DEV.TNAME = 'LOCAL') THEN
     1080    11836                                      /* Example of TYP-NUM would be LP01 */
     1081    11837    5                        IF DEVNAMER.TYP = ' '
     1082    11838    5                        OR (DEVNAMER.TYP = DEV$->FO$DEV.NAMER.TYP
     1083    11839    5                        AND DEVNAMER.NUM = DEV$->FO$DEV.NAMER.NUM) THEN
     1084    11840    6                          DO;
     1085    11841                                /* FOUND IT OR ONE OF 'EM */
     1086    11842    6                          NDEV=NDEV+1;
     1087    11843    6                          OPMSG_DINFO.DEVNM=DEV$->FO$DEV.NAME;
     1088    11844    6                          OPMSG_DINFO.STATE=DEV$->FO$DEV.STATE;
     1089    11845    6                          OPMSG_DINFO.SIP=BITBIN(DEV$->FO$DEV.FLG.SIP);
     1090    11846                                      /* See if device is restricted to an
     1091    11847                                         account, and set bit accordingly */
     1092    11848    7                          IF DEV$->FO$DEV.RACCT = ' ' THEN DO;
     1093    11849    7                            OPMSG_DINFO.RESTRICT=0;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:33   
     1094    11850    7                            OPMSG_DINFO.RESTRICTW=0;
     1095    11851    7                            END;
     1096    11852    6                          ELSE
     1097    11853    7                            DO;
     1098    11854    7                            IF DEV$->FO$DEV.RACCTL ~= 0
     1099    11855    8                            THEN DO;
     1100    11856    8                              OPMSG_DINFO.RESTRICT=1;
     1101    11857    8                              OPMSG_DINFO.RACCT=DEV$->FO$DEV.RACCT;
     1102    11858    8                              OPMSG_DINFO.RESTRICTW=0;
     1103    11859    8                              END;
     1104    11860    7                            ELSE
     1105    11861    8                              DO;
     1106    11862    8                              OPMSG_DINFO.RESTRICTW = 1;
     1107    11863    8                              OPMSG_DINFO.RWSN = DEV$ -> FO$DEV.RWSN;
     1108    11864    8                              OPMSG_DINFO.RESTRICT=0;
     1109    11865    8                              END;
     1110    11866    7                            END;
     1111    11867    6                          OPMSG_DINFO.LOCK=BITBIN(DEV$->FO$DEV.FLG.LOCK);
     1112    11868    6                          OPMSG_DINFO.SUSRSN=DEV$->FO$DEV.SUSRSN;
     1113    11869    6                          OPMSG_DINFO.FORM=DEV$->FO$DEV.FORM;
     1114    11870    6                          OPMSG_DINFO.ALG=BITBIN(DEV$->FO$DEV.FLG.ALGNED);
     1115    11871    6                          OPMSG_DINFO.GRANS=0;
     1116    11872    6                          OPMSG_DINFO.PAGES=0;
     1117    11873    6                          IF DEV$->FO$DEV.STATE = FOS_BUSY# THEN
     1118    11874    7                            DO;
     1119    11875    7                            KDEVNAME=DEV$->FO$DEV.NAME;
     1120    11876    7                            CALL M$SYMBIO (INFO_SYMB) ALTRET(KEYIN11);
     1121    11877    7                            BLK#=INFO_SYMB.V.BLKREC.BLK#;
     1122    11878    7                            BLK#=DEV$->FO$DEV.CFIL$->FO$FIL.GRANS-BLK#;
     1123    11879    7                            IF BLK#R > 0 THEN
     1124    11880    7                             OPMSG_DINFO.GRANS=BLK#;
     1125    11881    7                            PG# = INFO_SYMB.V.PGDONE#;
     1126    11882    7                            PG# = DEV$ -> FO$DEV.CFIL$ -> FO$FIL.PAGES
     1127    11883    7                            - PG#;
     1128    11884    7                            IF PG# > 0
     1129    11885    7                            THEN
     1130    11886    7                             OPMSG_DINFO.PAGES=PG#;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:34   
     1131    11887    7                            IF DEV$ -> FO$DEV.CFIL$ -> FO$FIL.FLG.PAGES THEN
     1132    11888    7                             OPMSG_DINFO.PAGES_OR_RECS = 0;
     1133    11889    7                            ELSE
     1134    11890    7                             OPMSG_DINFO.PAGES_OR_RECS = 1;
     1135    11891    7                            END;
     1136    11892    6   KEYIN11:               ;
     1137    11893    6                          IF DEV$->FO$DEV.CFIL$ ~= ADDR(NIL) THEN
     1138    11894    7                            DO;
     1139    11895    7                            FIL$=DEV$->FO$DEV.CFIL$;
     1140    11896    7                            OPMSG_DINFO.FSYSID=FIL$->FO$FIL.SYSID;
     1141    11897    7                            OPMSG_DINFO.FNUM=FIL$->FO$FIL.NUM;
     1142    11898    7                            OPMSG_DINFO.ACCT=FIL$->FO$FIL.OJOB$->FO$JOB.ACCT;
     1143    11899    7                            OPMSG_DINFO.CONCUR = BITBIN(FIL$->FO$FIL.FLG.CONCUR);
     1144    11900    7                            END;
     1145    11901
     1146    11902    6                          CALL M$WRITE (OCMSG_DINFO);
     1147    11903    6                          IF KEYIN$ -> FO$DKEYIN.KIN# = KEY_SYMBOR#
     1148    11904    6                          OR KEYIN$ -> FO$DKEYIN.KIN# = KEY_SYMBOTERMR#
     1149    11905    7                          THEN DO;
     1150    11906    7                            WSN$ = DEV$ -> FO$DEV.WSN$;
     1151    11907    8                              DO WHILE (WSN$ ~= ADDR(NIL));
     1152    11908    9                                DO I = 0 TO (WSN$ -> FO$WSN.NWSNS - 1);
     1153    11909    9                                IF WSN$ -> FO$WSN.WSN.NOT_USED(I) = '0'B
     1154    11910   10                                THEN DO;
     1155    11911   10                                  OPMSG_RINFO.WSN_NAME = WSN$ -> FO$WSN.WSN.WSN_NAME(I)
             11911                                           ;
     1156    11912   10                                  IF WSN$ -> FO$WSN.WSN.ORIGINAL(I) = '1'B
     1157    11913   11                                  THEN DO;
     1158    11914   11                                    IF WSN$ -> FO$WSN.WSN.ROUTED_OUT(I) = '0'B
     1159    11915   12                                    THEN DO;
     1160    11916   12                                      OPMSG_RINFO.STATUS = %FOTC_RTOR#; /* ORIGINAL */
     1161    11917   12                                      END;
     1162    11918   11                                    ELSE
     1163    11919   12                                      DO;
     1164    11920   12                                      OPMSG_RINFO.STATUS = %FOTC_RTOT#;
             11920                                               /* ORIGINAL ROUTED OUT */
     1165    11921   12                                      END;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:35   
     1166    11922   11                                    END;
     1167    11923   10                                  ELSE              /* Not original */
     1168    11924   11                                    DO;
     1169    11925   11                                    OPMSG_RINFO.STATUS = %FOTC_RTAD#; /* ADD_ON */
     1170    11926   11                                    END;
     1171    11927   10                                  CALL M$WRITE (OCMSG_RINFO);
     1172    11928   10                                  END;
     1173    11929    9                                END;
     1174    11930    8                              WSN$ = WSN$ -> FO$WSN.LNK$;
     1175    11931    8                              END;
     1176    11932    7                            END;
     1177    11933
     1178    11934    6                          IF KEYIN$ -> FO$DKEYIN.KIN# = KEY_SYMBOT#
     1179    11935    6                          OR KEYIN$ -> FO$DKEYIN.KIN# = KEY_SYMBOTERMT#
     1180    11936    7                          THEN DO;
     1181    11937    7                            THROTTLE_UTS = INFO_SYMB.V.THROTTLE_TIME#;
     1182    11938    7                            CALL M$TIME (THROTTLE_TIME)
     1183    11939    8                            WHENALTRETURN DO;
     1184    11940    8                              END;
     1185    11941    7                            OPMSG_TINFO.TIME = TTIME.TIME;
     1186    11942    7                            OPMSG_TINFO.CNT = INFO_SYMB.V.THROTTLE_CNT#;
     1187    11943    7                            CALL M$WRITE (OCMSG_TINFO);
     1188    11944    7                            END;
     1189    11945    6                          END;
     1190    11946    5                       DEV$=DEV$->FO$DEV.LNK$;
     1191    11947    5                       END;
     1192    11948                                /* MESSAGE IF NONE FOUND */
     1193    11949    4                     IF NDEV ~= 0 THEN GOTO ENDEVENT;
     1194    11950    4                     IF KEYIN$->FO$DKEYIN.KIN# = KEY_SYMBO# THEN
     1195    11951    4                      OPMSG_KERR.SUBC1=0;
     1196    11952    4                     ELSE
     1197    11953    5                       DO;
     1198    11954    5                       OPMSG_KERR.SUBC1=1;
     1199    11955    5                       OPMSG_KERR.TNAME=KEYIN$->FO$DKEYIN.TNAME;
     1200    11956    5                       END;
     1201    11957    4                     IF DEVNAMER.TYP ~= ' '
     1202    11958    4                     THEN
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:36   
     1203    11959    4                      GOTO KEYIN001;
     1204    11960    4                     OPMSG_KERR.SUBC=FOKE_NSDEV#;
     1205    11961    4                     OPMSG_KERR.MSG#=FO_KERR1_MSG#;
     1206    11962    4                     GOTO KEYIN01;
     1207    11963        /**
     1208    11964         **
     1209    11965         ** FORMS KEYINS
     1210    11966         **
     1211    11967         **/
     1212    11968                                      /* SETUP requests a display of how to
     1213    11969                                         mount a specified form.  FORM re-
     1214    11970                                         quests a form mount on a symbiont
     1215    11971                                         device (if VFU image requires align,
     1216    11972                                         so be it). */
     1217    11973    4                   CASE (KEY_SETUP#,KEY_FORM#);
     1218    11974    4                     DEVNAME=KEYIN$->FO$DKEYIN.DEVNM;
     1219    11975    4                     CALL FIND_DEV ALTRET(KEYIN2);
     1220    11976    4                     GOTO KEYIN21;
     1221    11977    4   KEYIN2:           DEV$=ADDR(NIL);
     1222    11978    4   KEYIN21:          ;
     1223    11979    4                     CALL FOR$KEYIN (,,KEYIN$);
     1224    11980    4                     GOTO DEVSCHED;
     1225    11981        /**
     1226    11982         **
     1227    11983         ** ZAP KEYIN
     1228    11984         **
     1229    11985         **/
     1230    11986    4                   CASE (KEY_ZAP#);
     1231    11987    4                     GOODNGT=1;
     1232    11988    4                     TIMEASLEEP=0;
     1233    11989    4                     DEV$=FO_Q.DEVHD$;
     1234    11990    5                       DO WHILE (DEV$ ~= ADDR(NIL));
     1235    11991    5                       IF DEV$->FO$DEV.FLG.LOCK = '0'B THEN
     1236    11992    6                         DO;
     1237    11993    6                         LOCKKEYIN.DEVNM=DEV$->FO$DEV.NAME;
     1238    11994    6                         CALL FOD$EVENT (FODE_KEYN#,ADDR(LOCKKEYIN));
     1239    11995    6                         END;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:37   
     1240    11996    5                       IF DEV$->FO$DEV.STATE ~= FOS_IDLE#
     1241    11997    5                       AND DEV$->FO$DEV.STATE ~= FOS_IALN#
     1242    11998    5                       THEN
     1243    11999    5                        CALL FOD$EVENT (FODE_QUIT#,FOQR_KZAP#);
     1244    12000    5                       DEV$->FO$DEV.STATE = FOS_IDLE#; /* ALLOW ZAP TO PROCEED */
     1245    12001    5                       DEV$=DEV$->FO$DEV.LNK$;
     1246    12002    5                       END;
     1247    12003
     1248    12004        /**
     1249    12005         **
     1250    12006         ** UNKNOWN
     1251    12007         **
     1252    12008         **/
     1253    12009    4                   CASE (ELSE);
     1254    12010    4                     OPMSG_UNIMP.CADDR=KEYIN$->FO$DKEYIN.CADDR;
     1255    12011    4                     CALL M$WRITE (OCMSG_UNIMP);
     1256    12012    4                 END; /* CASE KIN# */
     1257    12013        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:38   
     1258    12014        /***
     1259    12015         ***
     1260    12016         ***
     1261    12017         ***          SYSTEM OPEN FOR BUSINESS
     1262    12018         ***
     1263    12019         ***
     1264    12020         ***/
     1265    12021    3             CASE (FOEV_OPFB#);
     1266    12022                          /*    This event is sent to us
     1267    12023                           *    when the system is open
     1268    12024                           *    for business.  It causes
     1269    12025                           *    us to start all printers
     1270    12026                           *    and allow file adds to
     1271    12027                           *    start 'em.
     1272    12028                           */
     1273    12029    3               NOSTART=NOSTART-1;
     1274    12030    3               CALL DRIVE_DEVS;
     1275    12031        /**
     1276    12032         **
     1277    12033         ** BATCH JOB OFF EVENT
     1278    12034         **
     1279    12035         **/
     1280    12036    3             CASE (FOEV_JOFF#);
     1281    12037    3               JOB_SYSID = CITE$->FO$JOBEV.SYSID;
     1282    12038    3               CALL FOF$FINDJOB(JOB_SYSID) ALTRET(ENDEVENT);
     1283    12039    3               JOB$->FO$JOB.FLG.JOFF = '1'B;
     1284    12040    3               IF JOB$->FO$JOB.NFIL = JOB$->FO$JOB.NFIL_DONE THEN CALL FOF$COMPJOB;
     1285    12041        /**
     1286    12042         **
     1287    12043         ** CANCEL COMMAND (FROM USER)
     1288    12044         **
     1289    12045         **/
     1290    12046    3             CASE (FOEV_CNCL#);
     1291    12047    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;
     1292    12048    3               BATCHFLG=CITE$->FO$JOBEV.BATCH;
     1293    12049    3               FIL_NUMR=CITE$->FO$JOBEV.NUMR;
     1294    12050    3               CALL FOF$CANCEL (FIL_SYSID,FIL_NUM,BATCHFLG);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:39   
     1295    12051        /**
     1296    12052         **
     1297    12053         ** SPILLDONE (FROM EFT)
     1298    12054         **
     1299    12055         **/
     1300    12056    3             CASE (FOEV_SPLD#);
     1301    12057    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;
     1302    12058    3               FIL_NUM=CITE$->FO$JOBEV.NUM;
     1303    12059    3               SPILLDISP=CITE$->FO$JOBEV.DISP;
     1304    12060    3               CALL FOF$SPILLDONE (FIL_SYSID,FIL_NUM,SPILLDISP);
     1305    12061    3               IF SPILLDISP = %FD_REQUEUE# THEN GOTO DEVSCHED;
     1306    12062        /**
     1307    12063         **
     1308    12064         ** FILL (FROM EFT)
     1309    12065         **
     1310    12066         **/
     1311    12067    3             CASE (FOEV_FILL#);
     1312    12068    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;
     1313    12069    3               FIL_NUM=CITE$->FO$JOBEV.NUM;
     1314    12070    3               CALL FOF$FILL (FIL_SYSID,FIL_NUM,FIL_CNUM,0,FO_BOOTID);
     1315    12071        /**
     1316    12072         **
     1317    12073         ** UNHOLD COMMAND (FROM USER)
     1318    12074         **
     1319    12075         **/
     1320    12076    3             CASE (FOEV_UHLD#);
     1321    12077    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;
     1322    12078    3               FIL_NUMR=CITE$->FO$JOBEV.NUMR;        /* Make sure sign transfers */
     1323    12079    3               CALL FOF$UNHOLD (FIL_SYSID,FIL_NUM);
     1324    12080    3               CALL DRIVE_DEVS;           /* Start these UNHOLDed babies moving! */
     1325    12081        /**
     1326    12082         **
     1327    12083         ** CANCEL OUTPUT DUE TO 'RERUN' KEYIN
     1328    12084         **
     1329    12085         **/
     1330    12086    3             CASE (FOEV_RRUN#);
     1331    12087    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:40   
     1332    12088    3               CALL FOF$RERUN (FIL_SYSID,-1,0);
     1333    12089        /**
     1334    12090         **
     1335    12091         ** CANCEL OUTPUT OF LIST OF JOBS TO BE RERUN
     1336    12092         **
     1337    12093         **/
     1338    12094    3             CASE (FOEV_MBSI#);
     1339    12095    4                 DO IR = 0 TO CITE$->FO$MBSEV.NJOBS-1;
     1340    12096    4                 FIL_SYSID=CITE$->FO$MBSEV.JOBS(I);
     1341    12097    4                 CALL FOF$RERUN (FIL_SYSID,-1,0);
     1342    12098    4                 END;
     1343    12099        /**
     1344    12100         **
     1345    12101         ** COOP DELETE OF FILE (User said ERASE)
     1346    12102         **
     1347    12103         **/
     1348    12104    3             CASE (FOEV_CDEL#);
     1349    12105    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;
     1350    12106    3               FIL_NUM=CITE$->FO$JOBEV.NUM;
     1351    12107    3               CALL FOF$ERASE (FIL_SYSID,FIL_NUM,0);
     1352    12108        /**
     1353    12109         **
     1354    12110         ** GET MORE SYSIDS (from MONKEY)
     1355    12111         **
     1356    12112         **/
     1357    12113    3             CASE (FOEV_GMSY#);
     1358    12114    3               CALL IGN$SYSID (CITE$->FO$SYEV);
     1359    12115        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:41   
     1360    12116        /***
     1361    12117         ***
     1362    12118         ***
     1363    12119         ***          'NOP' EVENT
     1364    12120         ***
     1365    12121         ***
     1366    12122         ***/
     1367    12123
     1368    12124    3             CASE (FOEV_NOP#);
     1369    12125        /***
     1370    12126         ***
     1371    12127         ***
     1372    12128         ***          'ELSE' CASE: UNKNOWN EXTERNAL EVENT CODE FROM FOE$EVNT
     1373    12129         ***
     1374    12130         ***
     1375    12131         ***/
     1376    12132    3             CASE (ELSE);
     1377    12133    3               CALL FOI$CRASHGO (%S$BADEXTEV,F_FO,M_O);
     1378    12134        /*S* SCREECH_CODE: FOO-S$BADEXTEV
     1379    12135             TYPE:         SCREECH
     1380    12136             MESSAGE:      OUTSYM - unknown external event code from FOE$EVNT
     1381    12137             REMARKS:      The event queue used to communicate from FOE$EVNT
     1382    12138                           to the OUTSYM main routine contains an event code
     1383    12139                           unknown to OUTSYM.  This can only occur if one
     1384    12140                           of OUTSYM, FOE$EVNT, and the event queue has been
     1385    12141                           clobbered.                                 */
     1386    12142    3           END; /* CASE EVNT.CODE */
     1387    12143                           /* COME HERE AT END OF ALL EVENTS */
     1388    12144    2   ENDEVENT:;
     1389    12145    2         RETURN;
     1390    12146    2   END EXT_EVENT;
     1391    12147        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:42   
     1392    12148        /*
     1393    12149
     1394    12150
     1395    12151            ####    #####   #   #    ###     ###    #####
     1396    12152            #   #   #       #   #     #     #   #   #
     1397    12153            #   #   #       #   #     #     #       #
     1398    12154            #   #   ####    #   #     #     #       ####
     1399    12155            #   #   #       #   #     #     #       #
     1400    12156            #   #   #        # #      #     #   #   #
     1401    12157            ####    #####     #      ###     ###    #####
     1402    12158
     1403    12159
     1404    12160
     1405    12161
     1406    12162            ####     ###    #   #   #####    ###    #   #   #####    ###
     1407    12163            #   #   #   #   #   #     #       #     #   #   #       #   #
     1408    12164            #   #   #   #   #   #     #       #     ##  #   #       #
     1409    12165            ####    #   #   #   #     #       #     # # #   ####     ###
     1410    12166            # #     #   #   #   #     #       #     #  ##   #           #
     1411    12167            #  #    #   #   #   #     #       #     #   #   #       #   #
     1412    12168            #   #    ###     ###      #      ###    #   #   #####    ###
     1413    12169
     1414    12170
     1415    12171        */
     1416    12172        /**************************************
     1417    12173         **************************************
     1418    12174                    ADD_DEV
     1419    12175         **************************************
     1420    12176         **************************************/
     1421    12177        /*D* NAME:         ADD_DEV
     1422    12178             PURPOSE:      To add a new OUTSYM device
     1423    12179             DESCRIPTION:  DEVNAME is the device name.  CGAURD$ points to
     1424    12180                           a termconnect CGAURD structure.
     1425    12181
     1426    12182                           ADD_DEV obtains a dynamic device frame and
     1427    12183                           initializes it with FO_DEV_INIT.  Then the
     1428    12184                           device locked bit, attributes, and form and terminal
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:43   
     1429    12185                           names are set from the connect params.
     1430    12186
     1431    12187                           Finally, the device's TNAME (terminal name)
     1432    12188                           is calculated via :HLP and the TWSN, and
     1433    12189                           placed in the device context block.  The
     1434    12190                           context block is chained onto the device
     1435    12191                           list, and the connect event is reported
     1436    12192                           to FOD$EVENT.
     1437    12193
     1438    12194                           If any hassle is encountered trying to do
     1439    12195                           all this, the device is disconnected with
     1440    12196                           an appropriate message.
     1441    12197        */
     1442    12198    1   ADD_DEV: PROC ALTRET;
     1443    12199    2         CALL FIND_DEV ALTRET(A9);
     1444    12200                                /* DEVICE ALREADY LISTED */
     1445    12201    2         CALL FOI$SNAP (%S$DBLCON,F_FO,M_O);
     1446    12202        /*S* SCREECH_CODE: FOO-S$DBLCON
     1447    12203             TYPE:         SNAP
     1448    12204             MESSAGE:      Device connected to OS CG twice
     1449    12205             REMARKS:      OUTSYM received a device connect as OSCG
     1450    12206                           admin user, but the named device is already
     1451    12207                           listed in his tables, implying the device
     1452    12208                           connect has been received twice.   */
     1453    12209    2         ALTRETURN;
     1454    12210    2   A9:   ;
     1455    12211                                      /* Get a Segment Control Block (built
     1456    12212                                         by FO_SCB macro) frame from one of
     1457    12213                                         our data segments, and stuff the
     1458    12214                                         standard initialization stuff in it */
     1459    12215    2         CALL FOI$GBUF (FO_DEVSCB, DEV$) ALTRET (NO_DEVSPACE);
     1460    12216    2         DEV$ -> FO$DEV = FO_DEV_INIT;
     1461    12217    2         DEV$ -> FO$DEV.LNK$ = FO_Q.DEVHD$;
     1462    12218    2         FO_Q.DEVHD$ = DEV$;
     1463    12219    2         DEV$ -> FO$DEV.NAME = DEVNAME;
     1464    12220    2         DEV$ -> FO$DEV.NATTR = ~(CGAURD$ -> B$CGAURD.CONINFO.ATTR);
     1465    12221
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:44   
     1466    12222    2         HLP_KEY.DEVLGN = CGAURD$ -> B$CGAURD.CONINFO.WHO.ACCT;
     1467    12223    2         CALL M$READ (READ_HLP)
     1468    12224    3         WHENALTRETURN DO;
     1469    12225             /* SNAP */
     1470    12226    3           GOTO NO_DEVSPACE;
     1471    12227    3           END;
     1472    12228
     1473    12229    2         CALL M$TRUNC (TRUNC_HLP);
     1474    12230    2         WSNDEV$ = ADDR (FO_FITBUF1);
     1475    12231
     1476    12232    2         CALL FOI$GBUF (FO_DEVSCB, WSN$) ALTRET (NO_WSNSPACE);
     1477    12233    2         DEV$ -> FO$DEV.WSN$ = WSN$;
     1478    12234    2         WSN$ -> FO$WSN = FO_WSN_INIT;
     1479    12235    2         J = 0;
     1480    12236    3           DO I = 0 TO (WSNDEV$ -> KL_WSNDEV.NDEV - 1);
     1481    12237    3           IF J > 4
     1482    12238    4           THEN DO;
     1483    12239    4             J = 0;
     1484    12240    4             WSN_LNK$ = WSN$;
     1485    12241    4             CALL FOI$GBUF (FO_DEVSCB, WSN$) ALTRET (NO_WSNSPACE);
     1486    12242    4             WSN_LNK$ -> FO$WSN.LNK$ = WSN$;
     1487    12243    4             WSN$ -> FO$WSN = FO_WSN_INIT;
     1488    12244    4             END;
     1489    12245
     1490    12246    3           WSN$ -> FO$WSN.WSN.WSN_NAME(J) = WSNDEV$ -> KL_WSNDEV.DEV(I);
     1491    12247    3           WSN$ -> FO$WSN.WSN.ORIGINAL(J) = '1'B;
     1492    12248    3           WSN$ -> FO$WSN.WSN.ADD_ON(J) = '0'B;
     1493    12249    3           WSN$ -> FO$WSN.WSN.NOT_USED(J) = '0'B;
     1494    12250    3           WSN$ -> FO$WSN.WSN.ROUTED_OUT(J) = '0'B;
     1495    12251    3           WSN$ -> FO$WSN.NWSNS = WSN$ -> FO$WSN.NWSNS + 1;
     1496    12252    3           J = J + 1;
     1497    12253    3           END;
     1498    12254
     1499    12255    2         FO_OSYMBKEY.LEN = 8;
     1500    12256    2         FO_OSYMBKEY.NAME = DEV$ -> FO$DEV.NAME;
     1501    12257    2         READ_OSYMB.BUF_.BOUND = 256;
     1502    12258    2         CALL M$READ (READ_OSYMB)
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:45   
     1503    12259    3         WHENALTRETURN DO;
     1504    12260    3           IF CGAURD$ -> B$CGAURD.FOINFO.FORMR ~= '0'B
     1505    12261    3           THEN
     1506    12262    3            DEV$ -> FO$DEV.FORM = CGAURD$ -> B$CGAURD.FOINFO.FORM;
     1507    12263    3           ELSE
     1508    12264    3            DEV$ -> FO$DEV.FORM = ' ';
     1509    12265
     1510    12266    3           DEV$ -> FO$DEV.FLG.LOCK = CGAURD$ -> B$CGAURD.FOINFO.UPLOCKED;
     1511    12267        /*N* CALL DO_ROUTE; */
     1512    12268    3           GOTO A10;
     1513    12269    3           END;
     1514    12270
     1515    12271    2         CALL M$TRUNC (TRUNC_OSYMB);
     1516    12272    2         OSYMB$ = ADDR(FO_OSYMBUF);
     1517    12273    2         DEV$ -> FO$DEV.FLG.LOCK = FO_OSYMBUF.FO_OSYMBDEV.FLG.LOCK;
     1518    12274    2         DEV$ -> FO$DEV.FORM = FO_OSYMBUF.FO_OSYMBDEV.FORM;
     1519    12275
     1520    12276                                      /* Check if it's a LOCAL device */
     1521    12277    2         CALL M$SYMBIO (CHORG_SYMB)
     1522    12278    3         WHENRETURN DO;
     1523    12279    3           IF CGAURD$ -> B$CGAURD.FOINFO.FORMR ~= '0'B
     1524    12280    3           THEN
     1525    12281    3            DEV$ -> FO$DEV.FORM = CGAURD$ -> B$CGAURD.FOINFO.FORM;
     1526    12282    3           ELSE
     1527    12283    3            DEV$ -> FO$DEV.FORM = ' ';
     1528    12284
     1529    12285    3           DEV$ -> FO$DEV.FLG.LOCK = CGAURD$ -> B$CGAURD.FOINFO.UPLOCKED;
     1530    12286    3           END;
     1531    12287    3         WHENALTRETURN DO;
     1532    12288    3           IF B$ERRCODE = %E$LOCAL THEN DEV$->FO$DEV.FLG.LOCAL='1'B;
     1533    12289    3           END;
     1534    12290
     1535    12291    2         CALL FOR$GETMODE ( DEV$ -> FO$DEV.FORM );
     1536    12292
     1537    12293    3           DO I = 0 TO FO_OSYMBUF.FO_OSYMBWSN.NWSNS - 1;
     1538    12294
     1539    12295    3           IF FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '1'B
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:46   
     1540    12296    3           THEN
     1541    12297    3            GOTO NEXT_OSYMB;
     1542    12298
     1543    12299    3           WSN$ = DEV$ -> FO$DEV.WSN$;
     1544    12300    4             DO WHILE (WSN$ ~= ADDR(NIL));
     1545    12301    5               DO J = 0 TO (WSN$ -> FO$WSN.NWSNS - 1);
     1546    12302    5               IF (WSN$ -> FO$WSN.WSN.WSN_NAME(J)
     1547    12303    5               = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I))
     1548    12304    6               THEN DO;
     1549    12305    6                 WSN$ -> FO$WSN.WSN(J) = FO_OSYMBUF.FO_OSYMBWSN.WSN(I);
     1550    12306    6                 GOTO NEXT_OSYMB;
     1551    12307    6                 END;
     1552    12308    5               END;
     1553    12309    4             WSN_LNK$ = WSN$;
     1554    12310    4             WSN$ = WSN$ -> FO$WSN.LNK$;
     1555    12311    4             END;
     1556    12312
     1557    12313    3           WSN$ = WSN_LNK$;
     1558    12314    3           IF FO_OSYMBUF.FO_OSYMBWSN.WSN.ADD_ON(I) = '1'B
     1559    12315    4           THEN DO;
     1560    12316    4             IF WSN$ -> FO$WSN.NWSNS < 4
     1561    12317    5             THEN DO;
     1562    12318    5               WSN$ -> FO$WSN.NWSNS = WSN$ -> FO$WSN.NWSNS + 1;
     1563    12319    5               WSN$ -> FO$WSN.WSN(WSN$->FO$WSN.NWSNS-1) = FO_OSYMBUF.FO_OSYMBWSN.WSN(I)
             12319                        ;
     1564    12320    5               END;
     1565    12321    4             ELSE
     1566    12322    5               DO;
     1567    12323    5               WSN_LNK$ = WSN$;
     1568    12324    5               CALL FOI$GBUF (FO_DEVSCB, WSN$) ALTRET (NO_WSNSPACE);
     1569    12325    5               WSN_LNK$ -> FO$WSN.LNK$ = WSN$;
     1570    12326    5               WSN$ -> FO$WSN.LNK$ = ADDR(NIL);
     1571    12327    5               WSN$ -> FO$WSN.NWSNS = 1;
     1572    12328    5               WSN$ -> FO$WSN.WSN(WSN$ -> FO$WSN.NWSNS-1)
     1573    12329    5               = FO_OSYMBUF.FO_OSYMBWSN.WSN(I);
     1574    12330    5               END;
     1575    12331    4             END;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:47   
     1576    12332    3   NEXT_OSYMB:;
     1577    12333    3           END;
     1578    12334        /*N* CHECK ROUTE AND UNROUTE KEYINS HERE */
     1579    12335    2   A10:  ;
     1580    12336    2         DEV$->FO$DEV.TNAME=CGAURD$->B$CGAURD.FOINFO.TNAME;
     1581    12337                                      /* Attempt to start device after the
     1582    12338                                         connect */
     1583    12339    2         CALL FOD$EVENT (FODE_TCON#,NOSTART);
     1584    12340                                           /* Now place all wsn recs into
     1585    12341                                           :OSYMB.  We must do this because
     1586    12342                                           new devices have no :OSYMB record,
     1587    12343                                           and old devices may have new
     1588    12344                                           default WSNs. */
     1589    12345    2         CALL DEV_TO_OSYMB;
     1590    12346    2         CALL DISPLAY_ROUTE;
     1591    12347    2         RETURN;
     1592    12348    2   NO_WSNSPACE:;
     1593    12349    2         WSN$ = DEV$ -> FO$DEV.WSN$;
     1594    12350    3           DO WHILE (WSN$ ~= ADDR(NIL));
     1595    12351    3           WSN_LNK$ = WSN$ -> FO$WSN.LNK$;
     1596    12352    3           CALL FOI$RBUF (FO_DEVSCB,WSN$);
     1597    12353    3           WSN$ = WSN_LNK$;
     1598    12354    3           END;
     1599    12355
     1600    12356    2         CALL FOI$RBUF (FO_DEVSCB,DEV$);
     1601    12357    2   NO_DEVSPACE:;
     1602    12358    2         OPMSG_TDSC.SUBC=FOTD_NTBL#;
     1603    12359    2   DISC: ;
     1604    12360    2         OPMSG_TDSC.DEVNM=DEVNAME;
     1605    12361    2         CALL M$WRITE (OCMSG_TDSC);
     1606    12362    2         CALL M$DEACTIVATE(DISCT_DEV) ALTRET(A4);
     1607    12363    2   A4:
     1608    12364    2         RETURN;
     1609    12365    2   END ADD_DEV;
     1610    12366        /********************************************
     1611    12367         ********************************************
     1612    12368                        DEV_TO_OSYMB
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:48   
     1613    12369         ********************************************
     1614    12370         ********************************************/
     1615    12371        /*D* NAME:           DO_ROUTE
     1616    12372             PURPOSE:        To do previously set routing on devices.
     1617    12373             DESCRIPTION:    Route keyin information is saved and
     1618    12374                             applied to devices that connect after the
     1619    12375                             keyins are issued (i.e. if there's no
     1620    12376                             :OSYMB device record).
     1621    12377                                                          */
     1622    12378    1   DEV_TO_OSYMB: PROC;
     1623    12379
     1624    12380    2         TALLY = 0;
     1625    12381    2         FO_OSYMBUF.FO_OSYMBDEV = DEV$ -> FO$DEV;
     1626    12382    2         J = 0;
     1627    12383    2         WSN$ = DEV$ -> FO$DEV.WSN$;
     1628    12384    3           DO WHILE (WSN$ ~= ADDR(NIL));
     1629    12385    3           TALLY = TALLY + WSN$ -> FO$WSN.NWSNS;
     1630    12386    4             DO I = 0 TO (WSN$ -> FO$WSN.NWSNS - 1);
     1631    12387    4             FO_OSYMBUF.FO_OSYMBWSN.WSN(J) = WSN$ -> FO$WSN.WSN(I);
     1632    12388    4             J = J + 1;
     1633    12389    4             END;
     1634    12390    3           WSN$ = WSN$ -> FO$WSN.LNK$;
     1635    12391    3           END;
     1636    12392    2         FO_OSYMBUF.FO_OSYMBWSN.NWSNS = J;
     1637    12393    2         FO_OSYMBKEY.NAME = DEV$ -> FO$DEV.NAME;
     1638    12394    2         WRITE_OSYMB.BUF_.BOUND = LENGTHC(FO_OSYMBUF.FO_OSYMBDEV)
     1639    12395    2         + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
     1640    12396    2         + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
     1641    12397    2         + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
     1642    12398    2         CALL M$WRITE (WRITE_OSYMB);
     1643    12399    2         CALL M$TRUNC (TRUNC_OSYMB);
     1644    12400    2         RETURN;
     1645    12401    2   END DEV_TO_OSYMB;
     1646    12402        /*************************************************
     1647    12403         *************************************************
     1648    12404                       DISPLAY_ROUTE
     1649    12405         *************************************************
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:49   
     1650    12406         *************************************************/
     1651    12407        /*D* NAME:          DISPLAY_ROUTE
     1652    12408             PURPOSE:       Display route information upon connect.
     1653    12409             DESCRIPTION:   Route recovery information gets displayed
     1654    12410                            here following device connect messages. */
     1655    12411    1   DISPLAY_ROUTE: PROC;
     1656    12412
     1657    12413    2         WSN$ = DEV$ -> FO$DEV.WSN$;
     1658    12414    3           DO WHILE (WSN$ ~= ADDR(NIL));
     1659    12415    4             DO I = 0 TO (WSN$ -> FO$WSN.NWSNS - 1);
     1660    12416    4             OPMSG_TCON.WSN = WSN$ -> FO$WSN.WSN.WSN_NAME(I);
     1661    12417    4             OPMSG_TCON.DEVNM = DEV$ -> FO$DEV.NAME;
     1662    12418
     1663    12419    4             IF WSN$ -> FO$WSN.WSN.ROUTED_OUT (I) = '1'B
     1664    12420    5             THEN DO;
     1665    12421    5               OPMSG_TCON.SUBC = FOTC_RTOT#;
     1666    12422    5               CALL M$WRITE (OCMSG_TCON);
     1667    12423    5               END;
     1668    12424
     1669    12425    4             IF WSN$ -> FO$WSN.WSN.ADD_ON (I) = '1'B
     1670    12426    5             THEN DO;
     1671    12427    5               OPMSG_TCON.SUBC = FOTC_RTAD#;
     1672    12428    5               CALL M$WRITE (OCMSG_TCON);
     1673    12429    5               END;
     1674    12430    4             END;
     1675    12431    3           WSN$ = WSN$ -> FO$WSN.LNK$;
     1676    12432    3           END;
     1677    12433    2         RETURN;
     1678    12434    2   END DISPLAY_ROUTE;
     1679    12435        /**************************************
     1680    12436         **************************************
     1681    12437                    FIND_DEV
     1682    12438         **************************************
     1683    12439         **************************************/
     1684    12440        /*D* NAME:         FIND_DEV
     1685    12441             PURPOSE:      To find a device in OUTSYM's tables
     1686    12442             DESCRIPTION:  The name of the desired device is DEVNAME.  If
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:50   
     1687    12443                           found, the routine returns with DEV$ pointing to
     1688    12444                           the device frame, else it ALTRETs. */
     1689    12445    1   FIND_DEV: PROC ALTRET;
     1690    12446
     1691    12447    2         DEV$=FO_Q.DEVHD$;
     1692    12448    3           DO WHILE (DEV$~=ADDR(NIL));
     1693    12449    3           IF DEVNAME=DEV$->FO$DEV.NAME THEN RETURN;
     1694    12450    3           DEV$=DEV$->FO$DEV.LNK$;
     1695    12451    3           END;
     1696    12452    2         ALTRETURN;
     1697    12453    2   END FIND_DEV;
     1698    12454        /**************************************
     1699    12455         **************************************
     1700    12456                    DRIVE_DEVS
     1701    12457         **************************************
     1702    12458         **************************************/
     1703    12459        /*D* NAME:         DRIVE_DEVS
     1704    12460             PURPOSE:      To drive all devices
     1705    12461             DESCRIPTION:  Reports IDLE event on all idle devices,
     1706    12462                           unless NOSTART is nonzero. */
     1707    12463    1   DRIVE_DEVS: PROC;
     1708    12464
     1709    12465    2         IF NOSTART > 0 THEN RETURN;
     1710    12466    2         DEV$ = FO_Q.DEVHD$;
     1711    12467
     1712    12468    3           DO WHILE (DEV$ ~= ADDR(NIL));
     1713    12469    3           IF DEV$->FO$DEV.STATE = FOS_IDLE# THEN
     1714    12470    3            CALL FOD$EVENT(FODE_IDLE#);
     1715    12471    3           DEV$ = DEV$->FO$DEV.LNK$;
     1716    12472    3           END;
     1717    12473    2         RETURN;
     1718    12474    2   END DRIVE_DEVS;
     1719    12475        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:51   
     1720    12476        /*
     1721    12477
     1722    12478
     1723    12479                            #####    ###    #       #####
     1724    12480                            #         #     #       #
     1725    12481                            #         #     #       #
     1726    12482                            ####      #     #       ####
     1727    12483                            #         #     #       #
     1728    12484                            #         #     #       #
     1729    12485                            #        ###    #####   #####
     1730    12486
     1731    12487
     1732    12488
     1733    12489
     1734    12490            ####     ###    #   #   #####    ###    #   #   #####    ###
     1735    12491            #   #   #   #   #   #     #       #     #   #   #       #   #
     1736    12492            #   #   #   #   #   #     #       #     ##  #   #       #
     1737    12493            ####    #   #   #   #     #       #     # # #   ####     ###
     1738    12494            # #     #   #   #   #     #       #     #  ##   #           #
     1739    12495            #  #    #   #   #   #     #       #     #   #   #       #   #
     1740    12496            #   #    ###     ###      #      ###    #   #   #####    ###
     1741    12497
     1742    12498
     1743    12499        */
     1744    12500        /**************************************
     1745    12501         **************************************
     1746    12502                    GET_FILES
     1747    12503         **************************************
     1748    12504         **************************************/
     1749    12505        /*D* NAME:         GET_FILES
     1750    12506             PURPOSE:      To recover the output symbiont queues
     1751    12507             DESCRIPTION:  When OUTSYM is started after a boot, the output
     1752    12508                           symbiont queues left over from last boot must
     1753    12509                           be recovered.  This is done by opening each file
     1754    12510                           in :SYMO and adding it to the queues.  Some tricks
     1755    12511                           must be played because
     1756    12512
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:52   
     1757    12513                           o these files may have been caught in a crash, and
     1758    12514                             thus may be incomplete commode files
     1759    12515
     1760    12516                           o while this process is ongoing, some users may
     1761    12517                             be building output files, and these we do not
     1762    12518                             want to pick up as they will be added to us
     1763    12519                             later in the normal fashion by the output COOP.
     1764    12520                             This is avoided by means of the BOOTID on the
     1765    12521                             front of every file name. */
     1766    12522    1   GET_FILES: PROC;
     1767    12523        /**/
     1768    12524        %FS_OSFN (FPTN=OSFNAME,STCLASS=AUTO);
     1769    12538        /**/
     1770    12539    2         CALL M$OPEN (OPEN_SYMOFD) ALTRET(GFILE2);
     1771    12540    2         GOTO GFILE11;
     1772    12541    2   GFILE1:
     1773    12542    2         CALL M$OPEN(SCAN_SYMOFD) ALTRET(GFILE2);
     1774    12543    2   GFILE11:;
     1775    12544    2         FIL_BOOTID=ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN.BOOTID;
     1776    12545    2         IF M_FILE1$->F$DCB.NAME.L ~= FO_FILENAME.CNT
     1777    12546    2         OR SUBSTR(ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN.SYSID,0,1) < '0'
     1778    12547    2         OR SUBSTR(ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN.SYSID,0,1) > '9' THEN
     1779    12548    3           DO;
     1780    12549    3           CALL M$CLOSE (CLOSE_FILE1) ALTRET(GFILE1);
     1781    12550    3           GOTO GFILE1;
     1782    12551    3           END;
     1783    12552    2         ELSE IF FIL_BOOTID = FO_BOOTID THEN
     1784    12553    3            DO;
     1785    12554                                      /* New files (from PIG, etc.) are not
     1786    12555                                         "recovered" */
     1787    12556    3            CALL M$CLOSE (CLOSE_FILE1) ALTRET(DONE);
     1788    12557    3            GOTO DONE;
     1789    12558    3            END;
     1790    12559    2         CALL CHARBIN(FIL_SYSID,ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN.SYSID);
     1791    12560    2         CALL CHARBIN(FIL_NUM  ,ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN.NUM);
     1792    12561    2         CALL CHARBIN(FIL_CNUM ,ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN.CNUM);
     1793    12562    2         CALL FOF$ADD(FIL_SYSID,FIL_NUM,FIL_CNUM,1,FIL_BOOTID);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:53   
     1794    12563    2         GOTO GFILE1;
     1795    12564    2   GFILE2:
     1796    12565    2         IF B$ERRCODE ~= %E$FDEOF THEN
     1797    12566    3           DO;
     1798    12567    3           OSFNAME=ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN;
     1799    12568    3           CALL M$OPEN (SCAN_SYMOFD) ALTRET(GFILE3);
     1800    12569    3           GOTO GFILE11;
     1801    12570    3   GFILE3: ;
     1802    12571    3           IF OSFNAME ~= ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN THEN
     1803    12572    4             DO;
     1804    12573    4             OSFNAME=ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN;
     1805    12574    4             GOTO GFILE2;
     1806    12575    4             END;
     1807    12576    3           END;
     1808    12577    2   DONE:
     1809    12578
     1810    12579                                /* FIX UP FILES WHICH MAY HAVE BEEN CAUGHT
     1811    12580                                   IN A CRASH, BY  MAKING SURE THEY DON'T
     1812    12581                                   WAIT FOR A NEXT COMMODE CHUNK WHICH WILL
     1813    12582                                   NEVER ARRIVE.  ALSO MARK ALL JOBS
     1814    12583                                   AS 'OFF'. */
     1815    12584
     1816    12585    2         FIL$ = FO_Q.FILHD$(FOPR_MFW#);
     1817    12586    3           DO WHILE (FIL$ ~= ADDR(NIL));
     1818    12587    3           NXTFIL$ = FIL$->FO$FIL.LNK$;
     1819    12588    3           FIL$->FO$FIL.FLG.GLC = '1'B;
     1820    12589    3           CALL FOF$UNCHAIN;
     1821    12590    3           CALL FOF$PRIO;
     1822    12591    3           CALL FOF$CHAIN;
     1823    12592    3           FIL$ = NXTFIL$;
     1824    12593    3           END;
     1825    12594
     1826    12595                                      /* GLC means Got-Last-Chunk.  JOFF tells
     1827    12596                                         us when to delete the JOB frame */
     1828    12597    3           DO I = 0 TO FOPR_MAX#;
     1829    12598    3           FIL$=FO_Q.FILHD$(I);
     1830    12599    4             DO WHILE (FIL$ ~= ADDR(NIL));
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:54   
     1831    12600    4             FIL$->FO$FIL.FLG.GLC = '1'B;
     1832    12601    4             IF FIL$->FO$FIL.SYSID > JG_MING# THEN
     1833    12602    4              FIL$->FO$FIL.OJOB$->FO$JOB.FLG.JOFF='1'B;
     1834    12603    4             FIL$=FIL$->FO$FIL.LNK$;
     1835    12604    4             END;
     1836    12605    3           END;
     1837    12606    2         RETURN;
     1838    12607    2   END GET_FILES;
     1839    12608        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:55   
     1840    12609        /**************************************
     1841    12610         **************************************
     1842    12611                    MISC_SETUP
     1843    12612         **************************************
     1844    12613         **************************************/
     1845    12614
     1846    12615    1   MISC_SETUP: PROC;
     1847    12616
     1848    12617    2         CALL M$OPEN (OPEN_OSYMB) ALTRET(A1);
     1849    12618    2         GOTO A2;
     1850    12619    2   A1:   ;
     1851    12620    2         OPEN_OSYMB.V.EXIST#=%NEWFILE#;
     1852    12621    2         CALL M$OPEN (OPEN_OSYMB) ALTRET(A2);
     1853    12622    2   A2:   ;
     1854    12623    2         CALL M$MONINFO (GET_SYMBINFO);          /*   Get symbiont information   */
     1855    12624    2         FO_BOOTID=FO_SYMBINFO.STREAMFILEID#;
     1856    12625    2         M_FILE1$=DCBADDR(DCBNUM(M$FILE1));
     1857    12626                                /* MAP Q HEADS & TAILS INTO JOBSTATS WSQ */
     1858    12627    2         CALL M$JOBSTATS (MAP_QHDR);
     1859    12628                                /* SET UP EVENT TRANSLATION TABLE */
     1860    12629    2         EVXLATE(%CG_TCON#)=FODE_TCON#;
     1861    12630    2         EVXLATE(%CG_TDSC#)=FODE_TDSC#;
     1862    12631    2         EVXLATE(%CG_TBRK#)=FODE_TBRK#;
     1863    12632    2         EVXLATE(%CG_STDSC#)=FODE_STDSC#;
     1864    12633    2         EVXLATE(%CG_STHLD#)=FODE_STHLD#;
     1865    12634    2         EVXLATE(%CG_SFERR#)=FODE_SFERR#;
     1866    12635    2         EVXLATE(%CG_STERR#)=FODE_STERR#;
     1867    12636    2         EVXLATE(%CG_SFEXT#)=FODE_SFEXT#;
     1868    12637    2         EVXLATE(%CG_SFSPA#)=FODE_SFSPA#;
     1869    12638    2         EVXLATE(%CG_STOKN#)=FODE_STOKN#;
     1870    12639    2         EVXLATE(%CG_STACK#)=FODE_STACK#;
     1871    12640    2         EVXLATE(%CG_TDRQ#)=FODE_TDRQ#;
     1872    12641    2         EVXLATE(%CG_FPABORT#)=FODE_FPABRT#;
     1873    12642    2         EVXLATE(%CG_FPEXIT#)=FODE_FPEXIT#;
     1874    12643                                /* LINK FREE EVENT FRAMES TOGETHER TO
     1875    12644                                   FORM THE FREE EVENT Q FRAME LIST */
     1876    12645    2         EVNT$=ADDR(FO_EVQ(0));
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:56   
     1877    12646    3           DO I=0 TO FOMI_EVMX#-1;
     1878    12647    3           EVNT$->FO$EVNT.LNK$=PINCRW(EVNT$,LENGTHW(FO$EVNT));
     1879    12648    3           EVNT$=EVNT$->FO$EVNT.LNK$;
     1880    12649    3           END;
     1881    12650    2         RETURN;
     1882    12651    2   END MISC_SETUP;
     1883    12652        /**/
     1884    12653        /**/
     1885    12654        /**/
     1886    12655    1   END FOO$OUTSYM;

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:57   
--  Include file information  --

   KL_SUPER_C.:E05TOU  is referenced.
   JM$STRUCT.:E05TOU  is referenced.
   JC_MACRO_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   FOS_SUBS_C.:E05TOU  is referenced.
   KC_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   FO_SCODE_C.:E05TOU  is referenced.
   FOM_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   FOO_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FS$FIT.:E05TOU  is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   FO_ERRORS_C.:E05TOU  is referenced.
   FOO_SUBS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   JG_EVID_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FOO$OUTSYM.

   Procedure FOO$OUTSYM requires 1691 words for executable code.
   Procedure FOO$OUTSYM requires 80 words of local(AUTO) storage.

    No errors detected in file FOO$OUTSYM.:E05TSI    .

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:58   

 Object Unit name= FOO$OUTSYM                                 File name= FOO$OUTSYM.:E05TOU
 UTS= JUL 29 '97 17:11:52.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   414    636  FOO$OUTSYM
    2  RoData even  UTS    676   1244  FOO$OUTSYM
    3   DCB   even  none     0      0  M$OSCG
    4   DCB   even  none     0      0  M$CSCG
    5   DCB   even  none     0      0  M$FILE1
    6   DCB   even  none     0      0  M$OSYMB
    7   DCB   even  none     0      0  M$HLP
    8   DCB   even  none     0      0  M$FPRG
    9   Proc  even  none  1691   3233  FOO$OUTSYM
   10  RoData even  none    38     46  FOO$OUTSYM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes            yes      Main       0  FOO$OUTSYM

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1    133  HLP_KEY                            1    140  TTIME
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:59   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 FOE$EVNT
         yes          Async      0 FOE$XCON
 yes     yes           Std       0 FOR$CLOSE
 yes     yes           Std       0 FOF$HEXPIRE
 yes     yes           Std       0 FOD$FSCHK
 yes     yes           Std       3 FOI$CRASHGO
 yes     yes           Std       3 FOF$SPILLDONE
 yes     yes           Std       0 FOF$COMPJOB
 yes     yes           Std       2 FOF$UNHOLD
 yes     yes           Std       2 FOD$EVENT
 yes     yes           Std       2 FOU$EVENT
 yes     yes           Std       1 FOF$KEYIN
 yes     yes           Std       3 FOF$RERUN
         yes           Std       1 IGN$SYSID
 yes     yes           Std       3 FOF$ERASE
 yes     yes           Std       4 FOI$SNAP
 yes     yes           Std       3 FOF$CANCEL
 yes     yes           Std       5 FOF$FILL
 yes     yes           Std       5 FOF$ADD
 yes     yes           Std       1 FOF$FINDJOB
 yes     yes           Std       3 FOR$KEYIN
 yes     yes           Std       2 FOI$GBUF
 yes     yes           Std       2 FOI$RBUF
 yes     yes           Std       1 FOR$GETMODE
 yes     yes           Std       0 FOF$PRIO
 yes     yes           Std       0 FOF$CHAIN
 yes     yes           Std       0 FOF$UNCHAIN
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:60   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  FO_CSCGBUF                            FO_OSCGBUF
     FO_FITBUF1                            FO_EVHD$                              FO_EVTL$
     FO_FEVHD$                             FO_FEVTL$                             FO_FIL$
     FO_DEV$                               FO_JOB$                               FO_BOOTID
r    GET_SYMBINFO                          FO_SYMBINFO                           FO_FILENAME
     FO_OSYMBKEY                           FO_OSYMBKEYROUTE                      FO_OSYMBKEYIN
     FO_OSYMBUF                       r    FO_DEV_INIT                      r    FO_WSN_INIT
     FO_EVQ                                FO_Q                                  FO_DEVSCB
     M$OSCG                                M$CSCG                                M$FILE1
     M$OSYMB                               M$HLP                                 M$FPRG
     B$TCB$                                B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:61   


        1        1        /*M* FOO$OUTSYM Main routine for OUTSYM ghost */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         FOO$OUTSYM
       10       10
       11       11             PURPOSE:      To provide the main routine for the OUTSYM ghost
       12       12
       13       13             DESCRIPTION:  FOO$OUTSYM is the main routine for the OUTSYM
       14       14                           ghost, which provides and/or controls all the
       15       15                           CP6 output symbiont functions performed in the
       16       16                           host.
       17       17
       18       18                           Output symbiont files are built by the output
       19       19                           COOP in account :SYMO.  When an output file
       20       20                           is closed, the OUTSYM ghost gets an event telling
       21       21                           him of the file name (SYSID and uniquifying ex-
       22       22                           tension integer).
       23       23
       24       24                           OUTSYM is the administrative user of the OSCG
       25       25                           (OUTSYM COMGROUP), and thus receives events
       26       26                           relative to connect and disconnect of devices
       27       27                           belonging to that comgroup (i.e. output symbiont
       28       28                           devices).
       29       29
       30       30                           OUTSYM is also plugged into the central system
       31       31                           comgroup (CSCG) as an ordinary user, in order
       32       32                           to be able to receive keyins and send messages
       33       33                           to various consoles.
       34       34
       35       35                           The actual reading of symbiont files and the
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:62   
       36       36                           transmittal of granules to their eventual
       37       37                           destinations (i.e. IOQ or FEP) is done by MOOS,
       38       38                           the monitor part of OUTSYM, who bears the same
       39       39                           relationship to the OUTSYM ghost as CP-V OUTSYM
       40       40                           did to RBBAT.  OUTSYM communicates with MOOS
       41       41                           via the M$SYMBIO PMME, and MOOS communicates with
       42       42                           OUTSYM via AU messages on the OSCG.
       43       43        */
       44       44        /**/
       45       45        /**/
       46       46        FOO$OUTSYM: PROC MAIN;

     46  9 000000   000000 700200 xent  FOO$OUTSYM   TSX0  ! X66_MAUTO
         9 000001   000120 000000                    ZERO    80,0

       47       47
       48       48
       49       49
       50       50        /**/
       51       51        /* INCLUDES */
       52       52        /**/
       53       53        %INCLUDE CP_6;
       54      134        %INCLUDE F$DCB;
       55      183        %INCLUDE OC_MESSHD_C;
       56      236        %INCLUDE JG_EVID_C;
       57      461        %INCLUDE F_ERRORS_C;
       58      701        %INCLUDE FOO_SUBS_C;
       59      937        %INCLUDE FO_ERRORS_C;
       60      969        %INCLUDE FOO_MAC_C;
       61     1717        %INCLUDE FS$FIT;
       62     1760        %INCLUDE FOO_DATA_R;
       63     2926        %INCLUDE OC_SUBS_C;
       64     3657        %INCLUDE FOM_SUBS_C;
       65     3720        %INCLUDE FO_SCODE_C;
       66     3748        %INCLUDE KC_ERRORS_C;
       67     3795        %INCLUDE NK_SUBS;
       68     3820        %INCLUDE CP_6_SUBS;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:63   
       69     4360        %INCLUDE KC_SUBS_C;
       70     4376        %INCLUDE FOS_SUBS_C;
       71     4393        %INCLUDE B$ROSEG;
       72     4456        %INCLUDE JG_GHOSTS_C;
       73     4546        %INCLUDE JC_MACRO_C;
       74     4660        %INCLUDE JM$STRUCT;
       75     5405 S      %INCLUDE B$JIT_C;
       76     5406        %INCLUDE KL_SUPER_C;
       77     8308        /* SPECIAL SUBS */
       78     8309        %EQU_CG;
       79     8357
       80     8358
       81     8359
       82     8360        /**/
       83     8361        /*  BASED STRUCTURES */
       84     8362        /**/
       85     8363    1   DCL PTR$ PTR BASED;
       86     8364        %B$TCB (STCLASS="BASED(B$TCB$)");
       87     8367        %B$ALT;
       88     8375        %FS_OSFN (FPTN=FS$OSFN,STCLASS=BASED);
       89     8389        %KL_WSNDEV;
       90     8394        %FO_CONINFO (FPTN=FO$CONINFO,STCLASS=BASED);
       91     8425        %B$CGAURD (FPTN=B$CGAURD,LAST=",");
       92     8444        %B$CGAUCI (FPTN=CONINFO,LVL=2,LAST=",");
       93     8466        %FO_CONINFO (FPTN=FOINFO,LVL=2,STCLASS=BASED);
       94     8497        %FO_CITE (FPTN=FO$JOBEV ,TYP=JOB ,STCLASS=BASED);
       95     8556        %FO_CITE (FPTN=FO$MBSEV ,TYP=MBS ,STCLASS=BASED);
       96     8615        %FO_CITE (FPTN=FO$SYEV  ,TYP=GMSY,STCLASS=BASED);
       97     8674        %B$JIT0;
       98     8763        %A$JIT6X;
       99     8766
      100     8767
      101     8768
      102     8769        /**/
      103     8770        /*  AUTO */
      104     8771        /**/
      105     8772    1   DCL M_FILE1$ PTR;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:64   
      106     8773    1   DCL I UBIN WORD;
      107     8774    1   DCL IR REDEF I SBIN;
      108     8775    1   DCL J UBIN WORD;
      109     8776    1   DCL WSN$ PTR;
      110     8777    1   DCL WSNDEV$ PTR;
      111     8778    1   DCL WSN_LNK$ PTR;
      112     8779    1   DCL OSYMB$ PTR;
      113     8780    1   DCL TALLY UBIN WORD;
      114     8781    1   DCL NUM UBIN WORD;
      115     8782    1   DCL EVNT$ PTR;
      116     8783    1   DCL P$ PTR;
      117     8784    1   DCL KEYIN$ PTR;
      118     8785    1   DCL BATCHFLG UBIN WORD;
      119     8786    1   DCL PRIO UBIN WORD;
      120     8787    1   DCL KERR UBIN WORD;
      121     8788    1   DCL FIL_BOOTID CHAR(3) ALIGNED;
      122     8789    1   DCL FIL_SYSID UBIN WORD;
      123     8790    1   DCL FIL_NUM UBIN WORD;
      124     8791    1   DCL FIL_NUMR REDEF FIL_NUM SBIN WORD;
      125     8792    1   DCL FIL_CNUM UBIN WORD;
      126     8793    1   DCL EXT$ PTR;
      127     8794    1   DCL JOB_SYSID UBIN WORD;
      128     8795    1   DCL GORGO_SYSID UBIN WORD ALIGNED;
      129     8796    1   DCL SPILLDISP UBIN WORD;
      130     8797    1   DCL NXTFIL$ PTR;
      131     8798    1   DCL EVXLATE (0:%CG_MAX#) UBIN WORD;
      132     8799    1   DCL INFO UBIN WORD;
      133     8800    1   DCL 1 INFOB REDEF INFO,
      134     8801    1         2 BLK# UBIN(18) UNAL,
      135     8802    1         2 REC# UBIN(18) UNAL;
      136     8803    1   DCL DEVENT UBIN WORD;
      137     8804    1   DCL NDEV UBIN WORD;
      138     8805    1   DCL BTWSN UBIN WORD;
      139     8806    1   DCL CGAURD$ PTR;
      140     8807    1   DCL CITE$ PTR;
      141     8808    1   DCL BLK# UBIN;
      142     8809    1   DCL BLK#R REDEF BLK# SBIN;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:65   
      143     8810    1   DCL PG# UBIN;
      144     8811    1   DCL FILE_ADDED BIT(1);
      145     8812
      146     8813
      147     8814
      148     8815        /**/
      149     8816        /*  STATIC */
      150     8817        /**/
      151     8818    1   DCL NOSTART SBIN WORD STATIC ALIGNED INIT(1);
      152     8819    1   DCL UNEXPT SBIN WORD STATIC ALIGNED INIT(0);
      153     8820    1   DCL GOODNGT SBIN WORD STATIC ALIGNED INIT(0);
      154     8821    1   DCL TIMEASLEEP SBIN WORD STATIC ALIGNED INIT(0);
      155     8822    1   DCL HEXPIRE SBIN STATIC INIT(1800);
      156     8823    1   DCL KDEVNAME CHAR(8) STATIC DALIGNED;
      157     8824        %FO_DKEYIN                             (FPTN=LOCKKEYIN,
      158     8825                 IKIN#     = KEY_LOCK#,
      159     8826                 STCLASS   = STATIC);
      160     8858    1   DCL DEVNAME CHAR(8) STATIC DALIGNED;
      161     8859    1   DCL 1 DEVNAMER REDEF DEVNAME DALIGNED,
      162     8860    1         2 TYP CHAR(2) UNAL,
      163     8861    1         2 NUM CHAR(2) UNAL,
      164     8862    1         2 TWSN# CHAR(4) UNAL;
      165     8863        %OC_MESSHD_D       (NAME=OPMSG_KERR,
      166     8864                 NPARMS    = 3,
      167     8865                 ATR       = M_UR,
      168     8866                 MSG       = 0,
      169     8867                 STCLASS   = STATIC);
      170     8880    1         2 * UBIN BYTE UNAL INIT(1),
      171     8881    1         2 * UBIN BYTE UNAL INIT(1),
      172     8882    1         2 * UBIN BYTE UNAL INIT(8),
      173     8883    1         2 SUBC UBIN BYTE UNAL,
      174     8884    1         2 SUBC1 UBIN BYTE UNAL,
      175     8885    1         2 TNAME CHAR(8) UNAL;
      176     8886        %OC_MESSHD_D            (NAME=OPMSG_TDSC,
      177     8887                 NPARMS    = 1,
      178     8888                 ATR       = M_UR,
      179     8889                 MSG       = FO_TDSC_MSG#,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:66   
      180     8890                 STCLASS   = STATIC);
      181     8903    1         2 * UBIN BYTE UNAL INIT(1),
      182     8904    1         2 SUBC UBIN BYTE UNAL;
      183     8905        %OC_MESSHD_D            (NAME=OPMSG_UNIMP,
      184     8906                 NPARMS    = 0,
      185     8907                 MSG       = UNIMP_MSG#,
      186     8908                 DELIM     =";",
      187     8909                 STCLASS   = STATIC);
      188     8922        %OC_MESSHD_D            (NAME=OPMSG_DINFO,
      189     8923                 NPARMS     = 19,
      190     8924                 ATR       = M_UR,
      191     8925                 MSG       = FO_DDSP_MSG#,
      192     8926                 STCLASS   = STATIC);
      193     8939    1         2 * UBIN BYTE UNAL INIT(1),
      194     8940    1         2 * UBIN BYTE UNAL INIT(1),
      195     8941    1         2 * UBIN BYTE UNAL INIT(1),
      196     8942    1         2 * UBIN BYTE UNAL INIT(2),
      197     8943    1         2 * UBIN BYTE UNAL INIT(2),
      198     8944    1         2 * UBIN BYTE UNAL INIT(8),
      199     8945    1         2 * UBIN BYTE UNAL INIT(1),
      200     8946    1         2 * UBIN BYTE UNAL INIT(6),
      201     8947    1         2 * UBIN BYTE UNAL INIT(4),
      202     8948    1         2 * UBIN BYTE UNAL INIT(1),
      203     8949    1         2 * UBIN BYTE UNAL INIT(1),
      204     8950    1         2 * UBIN BYTE UNAL INIT(8),
      205     8951    1         2 * UBIN BYTE UNAL INIT(1),
      206     8952    1         2 * UBIN BYTE UNAL INIT(8),
      207     8953    1         2 * UBIN BYTE UNAL INIT(1),
      208     8954    1         2 * UBIN BYTE UNAL INIT(8),
      209     8955    1         2 * UBIN BYTE UNAL INIT(1),
      210     8956    1         2 * UBIN BYTE UNAL INIT(4),
      211     8957    1         2 * UBIN BYTE UNAL INIT(1),
      212     8958    1         2 STATE UBIN BYTE UNAL,
      213     8959    1         2 SIP UBIN BYTE UNAL,
      214     8960    1         2 LOCK UBIN BYTE UNAL,
      215     8961    1         2 FSYSID UBIN HALF UNAL,
      216     8962    1         2 FNUM UBIN HALF UNAL,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:67   
      217     8963    1         2 ACCT CHAR(8) UNAL,
      218     8964    1         2 SUSRSN UBIN BYTE UNAL,
      219     8965    1         2 FORM CHAR(6) UNAL,
      220     8966    1         2 GRANS UBIN WORD UNAL,
      221     8967    1         2 ALG UBIN BYTE UNAL,
      222     8968    1         2 SUBC UBIN BYTE UNAL,
      223     8969    1         2 TNAME CHAR(8) UNAL,
      224     8970    1         2 RESTRICT UBIN BYTE UNAL,
      225     8971    1         2 RACCT CHAR(8) UNAL,
      226     8972    1         2 RESTRICTW UBIN BYTE UNAL,
      227     8973    1         2 RWSN CHAR(8) UNAL,
      228     8974    1         2 CONCUR UBIN BYTE UNAL,
      229     8975    1         2 PAGES UBIN WORD UNAL,
      230     8976    1         2 PAGES_OR_RECS UBIN BYTE UNAL;
      231     8977
      232     8978        %OC_MESSHD_D          (NAME=OPMSG_RINFO,
      233     8979                 NPARMS      = 2,
      234     8980                 ATR         = M_UR,
      235     8981                 MSG         = FO_WSN_MSG#,
      236     8982                 STCLASS     = STATIC);
      237     8995    1         2 * UBIN BYTE UNAL INIT(1),
      238     8996    1         2 * UBIN BYTE UNAL INIT(8),
      239     8997    1         2 STATUS UBIN BYTE UNAL,
      240     8998    1         2 WSN_NAME CHAR(8) UNAL;
      241     8999        %OC_MESSHD_D          (NAME=OPMSG_TINFO,
      242     9000                 NPARMS      = 2,
      243     9001                 ATR         = M_UR,
      244     9002                 MSG         = FO_TTL_MSG#,
      245     9003                 STCLASS     = STATIC);
      246     9016    1         2 * UBIN BYTE UNAL INIT(4),
      247     9017    1         2 * UBIN BYTE UNAL INIT(11),
      248     9018    1         2 CNT UBIN WORD UNAL,
      249     9019    1         2 TIME CHAR(11) UNAL;
      250     9020        %OC_MESSHD_D           (NAME=OPMSG_TCON,
      251     9021                 NPARMS       = 2,
      252     9022                 ATR          = M_UR,
      253     9023                 MSG          = FO_WSN_MSG#,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:68   
      254     9024                 STCLASS      = STATIC);
      255     9037    1         2 * UBIN BYTE UNAL INIT(1),
      256     9038    1         2 * UBIN BYTE UNAL INIT(8),
      257     9039    1         2 SUBC UBIN BYTE UNAL,
      258     9040    1         2 WSN CHAR(8) UNAL;
      259     9041
      260     9042
      261     9043        /**/
      262     9044        /* CONSTANT */
      263     9045        /**/
      264     9046        %JC_CITE (FPTN=JC_PCMP,TYP=PCMP,COD=JCEV_PCMP#,USR=JG_OUTSYM#,STCLASS=CONSTANT);
      265     9096        %OC_MESSHD_D            (NAME=ZAPRESP,
      266     9097                 STCLASS   = CONSTANT,
      267     9098                 FUNC      = ZAP,
      268     9099                 DELIM     =";");
      269     9112
      270     9113
      271     9114
      272     9115        /**/
      273     9116        /*  DCBS */
      274     9117        /**/
      275     9118    1   DCL M$OSCG DCB;
      276     9119    1   DCL M$CSCG DCB;
      277     9120    1   DCL M$FILE1 DCB;
      278     9121    1   DCL M$OSYMB DCB;
      279     9122    1   DCL M$HLP DCB;
      280     9123    1   DCL M$FPRG DCB;
      281     9124
      282     9125    1   DCL 1 HLP_KEY STATIC SYMDEF ALIGNED,
      283     9126    1         2 * UBIN BYTE UNAL INIT(12),
      284     9127    1         2 DEVLGN CHAR(8) INIT(' '),
      285     9128    1         2 * CHAR(4) INIT('WSNS');
      286     9129
      287     9130    1   DCL THROTTLE_UTS UBIN WORD STATIC ALIGNED INIT(0);
      288     9131    1   DCL 1 TTIME STATIC SYMDEF ALIGNED,
      289     9132    1         2 DATE CHAR(10) UNAL,
      290     9133    1         2 DAY CHAR(3) UNAL,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:69   
      291     9134    1         2 TIME CHAR(11) UNAL;
      292     9135
      293     9136
      294     9137
      295     9138        /**/
      296     9139        /* REFS */
      297     9140        /**/
      298     9141    1   DCL B$ROS$ PTR SYMREF;
      299     9142    1   DCL B$TCB$ PTR SYMREF;
      300     9143    1   DCL B$JIT$ PTR SYMREF;
      301     9144    1   DCL FOD$EVENT     ENTRY(2) ALTRET;
      302     9145    1   DCL FOD$FSCHK     ENTRY    ALTRET;
      303     9146    1   DCL FOE$EVNT      ENTRY    ASYNC;
      304     9147    1   DCL FOE$XCON      ENTRY    ASYNC;
      305     9148    1   DCL FOF$ADD       ENTRY(5) ALTRET;
      306     9149    1   DCL FOF$CANCEL    ENTRY(3) ALTRET;
      307     9150    1   DCL FOF$CHAIN     ENTRY    ALTRET;
      308     9151    1   DCL FOF$COMPJOB   ENTRY    ALTRET;
      309     9152    1   DCL FOF$ERASE     ENTRY(3) ALTRET;
      310     9153    1   DCL FOF$FILL      ENTRY(5) ALTRET;
      311     9154    1   DCL FOF$FINDJOB   ENTRY(1) ALTRET;
      312     9155    1   DCL FOF$HEXPIRE   ENTRY    ALTRET;
      313     9156    1   DCL FOF$KEYIN     ENTRY(1) ALTRET;
      314     9157    1   DCL FOF$PRIO      ENTRY    ALTRET;
      315     9158    1   DCL FOF$RERUN     ENTRY(3) ALTRET;
      316     9159    1   DCL FOF$SPILLDONE ENTRY(3) ALTRET;
      317     9160    1   DCL FOF$UNCHAIN   ENTRY    ALTRET;
      318     9161    1   DCL FOF$UNHOLD    ENTRY(2) ALTRET;
      319     9162    1   DCL FOI$CRASHGO   ENTRY(3) ALTRET;
      320     9163    1   DCL FOI$GBUF      ENTRY(2) ALTRET;
      321     9164    1   DCL FOI$RBUF      ENTRY(2) ALTRET;
      322     9165    1   DCL FOI$SNAP      ENTRY(4) ALTRET;
      323     9166    1   DCL FOR$CLOSE     ENTRY    ALTRET;
      324     9167    1   DCL FOR$KEYIN     ENTRY(3) ALTRET;
      325     9168    1   DCL FOR$GETMODE   ENTRY(1) ALTRET;
      326     9169    1   DCL FOU$EVENT    ENTRY(2) ALTRET;
      327     9170    1   DCL IGN$SYSID     ENTRY(1);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:70   
      328     9171    1   DCL XSF$LOCCODP   ENTRY(2) ALTRET;
      329     9172
      330     9173
      331     9174
      332     9175        /**/
      333     9176        /* PMME FPTS */
      334     9177        /**/
      335     9178        %FPT_OPEN                              (FPTN=OPEN_OSCG,
      336     9179                 DCB       = M$OSCG,
      337     9180                 SHARE     = ALL,
      338     9181                 SCRUB     = YES,
      339     9182                 CTG       = YES,
      340     9183                 IXTNSIZE  = %FOMI_CIXT#,
      341     9184                 AU        = YES,
      342     9185                 NAME      = OSCG,
      343     9186                 ACCT      = SYSACCT,
      344     9187                 SETSTA    = OUTSYMNAME,
      345     9188                 ASN       = COMGROUP,
      346     9189                 ORG       = TERMINAL,
      347     9190                 FUN       = CREATE,
      348     9191                 EXIST     = NEWFILE,
      349     9192                 ACCESS    = OSCG_ACCESS,
      350     9193                 STCLASS   = CONSTANT);
      351     9302        %VLP_ATTR                             (FPTN=OSCG_ACCESS);
      352     9316        %VLP_ACCESS                           (STCLASS=CONSTANT,
      353     9317                 READ      = NO,
      354     9318                 UPD       = NO,
      355     9319                 WNEW      = NO,
      356     9320                 DELR      = NO,
      357     9321                 DELF      = NO,
      358     9322                 REATTR    = NO,
      359     9323                 EXEC      = NO,
      360     9324                 ACCT      = '?',
      361     9325                 LAST      =";");
      362     9342        %VLP_CGCP                             (FPTN=OSCGCP,
      363     9343                 TMTYP     = ' ',
      364     9344                 DMTYP     = ' ',
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:71   
      365     9345                 MAXPG     = %FOMI_CIMP#,
      366     9346                 DISKWARN  = %FOMI_CXMP#,
      367     9347                 MEMWARN   = %FOMI_CXMP#,
      368     9348                 DATAPGS   = 10,
      369     9349                 CONMSG    = YES,
      370     9350                 DSCREQ    = YES,
      371     9351                 TERMCONAU = NO,
      372     9352                 DCBCONAU  = NO,
      373     9353                 TERMCONNAU= NO,
      374     9354                 DCBCONNAU = NO,
      375     9355                 AUCONTERM = NC,
      376     9356                 AUCONDCB  = NC,
      377     9357                 AUDCONTERM= NC,
      378     9358                 AUDCONDCB = NC,
      379     9359                 XSTALGL   = YES,
      380     9360                 WAS       = NO,
      381     9361                 RAS       = NO,
      382     9362                 SMD       = NO,
      383     9363                 XTYPLGL   = YES,
      384     9364                 MAXMC     = 1024,
      385     9365                 TERMCONLGL= YES,
      386     9366                 DCBCONLGL = YES,
      387     9367                 INPUT     = NO,
      388     9368                 OUTPUT    = YES,
      389     9369                 SECURE    = NO,
      390     9370                 STCLASS   = STATIC);
      391     9413        %FPT_CGCTL                            (FPTN=CTL_OSCG,
      392     9414                 DCB       = M$OSCG,
      393     9415                 CGCP      = OSCGCP,
      394     9416                 STCLASS   = CONSTANT);
      395     9439        %FPT_EXTEND                           (FPTN=EXTEND_OSCG,
      396     9440                 DCB       = M$OSCG,
      397     9441                 SIZ       = %FOMI_CXXT#,
      398     9442                 STCLASS   = CONSTANT);
      399     9456        %VLP_NAME               (FPTN=OSCG,
      400     9457                 STCLASS   = CONSTANT,
      401     9458                 NAME      = 'OSCG');
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:72   
      402     9485        %VLP_SETSTA                (FPTN=OUTSYMNAME,
      403     9486                 MYSTATION = 'OUTSYM',
      404     9487                 STCLASS   = CONSTANT,
      405     9488                 DIRONLY   = YES,
      406     9489                 WAS       = YES,
      407     9490                 OSTATION  = 'KEYIN');
      408     9518        %FPT_EVENT                             (FPTN=OSEVENT,
      409     9519                 UENTRY    = FOE$EVNT,
      410     9520                 STCLASS   = CONSTANT);
      411     9534        %FPT_OPEN                              (FPTN=OPEN_CSCG,
      412     9535                 STCLASS   = CONSTANT,
      413     9536                 DCB       = M$CSCG,
      414     9537                 SCRUB     = YES,
      415     9538                 NAME      = CSCG,
      416     9539                 SETSTA    = OUTSYMNAME,
      417     9540                 ASN       = COMGROUP);
      418     9649        %VLP_NAME               (FPTN=CSCG,
      419     9650                 STCLASS   = CONSTANT,
      420     9651                 NAME      = 'CSCG');
      421     9678        %FPT_OPEN                              (FPTN=SCAN_SYMOFD,
      422     9679                 STCLASS   = CONSTANT,
      423     9680                 DCB       = M$FILE1,
      424     9681                 NAME      = NIL,
      425     9682                 ACCT      = SYMOACCT,
      426     9683                 FPARAM    = FO_FITBUF1,
      427     9684                 ASN       = FILE,
      428     9685                 FUN       = IN,
      429     9686                 ACS       = BLOCK,
      430     9687                 NXTF      = YES);
      431     9796        %FPT_OPEN                             (FPTN=OPEN_SYMOFD,
      432     9797                 STCLASS   = CONSTANT,
      433     9798                 DCB       = M$FILE1,
      434     9799                 NAME      = ERASE,
      435     9800                 ACCT      = SYMOACCT,
      436     9801                 FPARAM    = FO_FITBUF1,
      437     9802                 ASN       = FILE,
      438     9803                 FUN       = IN,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:73   
      439     9804                 ACS       = BLOCK,
      440     9805                 NXTF      = YES);
      441     9914        %VLP_ACCT               (FPTN=SYMOACCT,
      442     9915                 STCLASS   = CONSTANT,
      443     9916                 ACCT      = ':SYMO');
      444     9929        %VLP_ACCT               (FPTN=SYSACCT,
      445     9930                 STCLASS   = CONSTANT,
      446     9931                 ACCT      = ':SYS');
      447     9944        %FPT_CLOSE                             (FPTN=CLOSE_FILE1,
      448     9945                 DCB       = M$FILE1,
      449     9946                 STCLASS   = CONSTANT,
      450     9947                 DISP      = SAVE,
      451     9948                 RELG      = YES);
      452     9990        %FPT_OPEN                           (FPTN=OPEN_HLP,
      453     9991                 NAME=HLP_NAME,
      454     9992                 ASN=FILE,
      455     9993                 ACS=DIRECT,
      456     9994                 DCB=M$HLP,
      457     9995                 FUN=IN,
      458     9996                 SHARE=ALL,
      459     9997                 ACCT=SYSACCT,
      460     9998                 CTG=YES,
      461     9999                 ORG=KEYED);
      462    10108        %VLP_NAME                           (FPTN=HLP_NAME,
      463    10109                 STCLASS=CONSTANT,
      464    10110                 NAME=':HLP');
      465    10137        %FPT_READ                           (FPTN=READ_HLP,
      466    10138                 BUF=FO_FITBUF1,
      467    10139                 DCB=M$HLP,
      468    10140                 KEY=HLP_KEY,
      469    10141                 KEYS=YES,
      470    10142                 WAIT=YES);
      471    10181        %FPT_TRUNC                          (FPTN=TRUNC_HLP,
      472    10182                 DCB=M$HLP,
      473    10183                 STCLASS=CONSTANT);
      474    10197        %FPT_TRUNC                          (FPTN=TRUNC_OSYMB,
      475    10198                 DCB=M$OSYMB,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:74   
      476    10199                 STCLASS=CONSTANT);
      477    10213        %FPT_WRITE                          (FPTN=OCMSG_RINFO,
      478    10214                 STCLASS=CONSTANT,
      479    10215                 DCB=M$CSCG,
      480    10216                 BUF=OPMSG_RINFO);
      481    10247        %FPT_WRITE                          (FPTN=OCMSG_TINFO,
      482    10248                 STCLASS=CONSTANT,
      483    10249                 DCB=M$CSCG,
      484    10250                 BUF=OPMSG_TINFO);
      485    10281        %FPT_WRITE                          (FPTN=OCMSG_TCON,
      486    10282                 STCLASS=STATIC,
      487    10283                 DCB=M$CSCG,
      488    10284                 BUF=OPMSG_TCON);
      489    10315        %FPT_READ                           (FPTN=READ_OSYMB_KEYIN,
      490    10316                 STCLASS=STATIC,
      491    10317                 DCB=M$OSYMB,
      492    10318                 KEYS=YES,
      493    10319                 KEYR=NO,
      494    10320                 KEY=FO_OSYMBKEYROUTE,
      495    10321                 BUF=FO_OSYMBKEYIN);
      496    10360        %FPT_WRITE                          (FPTN=WRITE_OSYMB,
      497    10361                 STCLASS=STATIC,
      498    10362                 DCB=M$OSYMB,
      499    10363                 KEY=FO_OSYMBKEY,
      500    10364                 BUF=FO_OSYMBUF,
      501    10365                 ONEWKEY=YES);
      502    10396        %FPT_WRITE                             (FPTN=OCMSG_TDSC,
      503    10397                 STCLASS   = CONSTANT,
      504    10398                 DCB       = M$CSCG,
      505    10399                 BUF       = OPMSG_TDSC);
      506    10430        %FPT_WRITE                             (FPTN=OCMSG_DINFO,
      507    10431                 STCLASS   = CONSTANT,
      508    10432                 DCB       = M$CSCG,
      509    10433                 BUF       = OPMSG_DINFO);
      510    10464        %FPT_WRITE                             (FPTN=OCMSG_UNIMP,
      511    10465                 STCLASS   = CONSTANT,
      512    10466                 DCB       = M$CSCG,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:75   
      513    10467                 BUF       = OPMSG_UNIMP);
      514    10498        %FPT_WRITE                             (FPTN=OCMSG_KERR,
      515    10499                 STCLASS   = CONSTANT,
      516    10500                 DCB       = M$CSCG,
      517    10501                 BUF       = OPMSG_KERR);
      518    10532        %FPT_ACTIVATE                          (FPTN=DISCT_DEV,
      519    10533                 STCLASS   = CONSTANT,
      520    10534                 DCB       = M$OSCG,
      521    10535                 STATION   = DEVNAME,
      522    10536                 DISCONNECT=YES);
      523    10559        %FPT_ACTIVATE                         (FPTN=DEACT_DEV,
      524    10560                 STCLASS   =CONSTANT,
      525    10561                 DCB       = M$OSCG,
      526    10562                 STATION   = DEVNAME);
      527    10585        %FPT_ACTIVATE                         (FPTN=ACT_FPRG,
      528    10586                 STCLASS   = CONSTANT,
      529    10587                 DCB       = M$OSCG,
      530    10588                 STATION   = MYSTATION);
      531    10611        %VLP_STATION                          (FPTN=MYSTATION,
      532    10612                STCLASS    = CONSTANT,
      533    10613                STATION    = 'OSFPRG');
      534    10640        %FPT_WAIT                              (FPTN=SLEEP,
      535    10641                 STCLASS   = STATIC,
      536    10642                 UETIME    = UNEXPT);
      537    10656        %FPT_WAIT                              (FPTN=SLEEP1,
      538    10657                 STCLASS   = CONSTANT,
      539    10658                 UNITS     = 1);
      540    10672        %FPT_READ                              (FPTN=READ_CSCG,
      541    10673                 STCLASS   = CONSTANT,
      542    10674                 DCB       = M$CSCG,
      543    10675                 WAIT      = NO,
      544    10676                 EVENT     = FO_CSRD#,
      545    10677                 BUF       = FO_CSCGBUF);
      546    10716        %FPT_READ                              (FPTN=READ_OSCG,
      547    10717                 STCLASS   = CONSTANT,
      548    10718                 DCB       = M$OSCG,
      549    10719                 WAIT      = NO,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:76   
      550    10720                 EVENT     = FO_OSAU#,
      551    10721                 BUF       = FO_OSCGBUF);
      552    10760        %FPT_XCON                              (FPTN=XCONSET,
      553    10761                 STCLASS   = CONSTANT,
      554    10762                 UENTRY    = FOE$XCON);
      555    10776        %FPT_JOBSTATS                          (FPTN=MAP_QHDR,
      556    10777                 ORDER     = REMAP,
      557    10778                 STATSEG   = FOSS_SYMHDR#,
      558    10779                 BUF       = FO_Q,
      559    10780                 STCLASS   = CONSTANT);
      560    10800        %FPT_SYMBIO                            (FPTN=INFO_SYMB,
      561    10801                 DCB       = M$OSCG,
      562    10802                 ORDER     = FOMO_INFO#,
      563    10803                 STATION   = KDEVNAME,
      564    10804                 STCLASS   = STATIC);
      565    10828        %FPT_OPEN                              (FPTN=OPEN_OSYMB,
      566    10829                 STCLASS   = STATIC,
      567    10830                 DCB       = M$OSYMB,
      568    10831                 NAME      = OSYMBNAME,
      569    10832                 ACCT      = SYSACCT,
      570    10833                 ASN       = FILE,
      571    10834                 FUN       = CREATE,
      572    10835                 ORG       = KEYED,
      573    10836                 ACS       = DIRECT,
      574    10837                 CTG       = YES,
      575    10838                 SHARE     = ALL,
      576    10839                 EXIST     = OLDFILE);
      577    10948        %VLP_NAME                              (FPTN=OSYMBNAME,
      578    10949                 NAME      = ':OSYMB',
      579    10950                 STCLASS   = CONSTANT);
      580    10977        %FPT_READ                              (FPTN=READ_OSYMB,
      581    10978                 STCLASS   = STATIC,
      582    10979                 DCB       = M$OSYMB,
      583    10980                 KEYS      = YES,
      584    10981                 KEYR      = NO,
      585    10982                 KEY       = FO_OSYMBKEY,
      586    10983                 BUF       = FO_OSYMBUF);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:77   
      587    11022        %FPT_SYMBIO                            (FPTN=CHORG_SYMB,
      588    11023                 DCB       = M$OSCG,
      589    11024                 STCLASS   = CONSTANT,
      590    11025                 STATION   = DEVNAME,
      591    11026                 ORDER     = FOMO_CHORG#);
      592    11050        %FPT_WRITE                             (FPTN=SEND_PCMP,
      593    11051                 STCLASS   = CONSTANT,
      594    11052                 DCB       = M$CSCG,
      595    11053                 BUF       = JC_PCMP,
      596    11054                 STATION   = SLUGNAME);
      597    11085        %VLP_STATION       (FPTN=SLUGNAME,
      598    11086                 STCLASS   = CONSTANT,
      599    11087                 STATION   = 'SLUG  ');
      600    11114        %FPT_CLOSE                             (FPTN=CLOSE_OSYMB,
      601    11115                 DCB       = M$OSYMB,
      602    11116                 STCLASS   = CONSTANT,
      603    11117                 DISP      = SAVE);
      604    11159        %FPT_WRITE                             (FPTN=WRITE_ZAPRESP,
      605    11160                 BUF       = ZAPRESP,
      606    11161                 DCB       = M$CSCG,
      607    11162                 STCLASS   = CONSTANT);
      608    11193        %FPT_PRIV                             (FPTN=EFTPRIV,
      609    11194                 PRIV      = %PR_FMEFT#,
      610    11195                 STCLASS   = CONSTANT);
      611    11210
      612    11211        %FPT_TIME                             (FPTN=THROTTLE_TIME,
      613    11212                 DATE      = TTIME.DATE,
      614    11213                 DAY       = TTIME.DAY,
      615    11214                 DEST      = EXT,
      616    11215                 SOURCE    = UTS,
      617    11216                 TSTAMP    = THROTTLE_UTS,
      618    11217                 TIME      = TTIME.TIME,
      619    11218                 STCLASS   = STATIC);
      620    11237
      621    11238        %FPT_OPEN                             (FPTN=OPEN_FPRG,
      622    11239                 DCB         = M$FPRG,
      623    11240                 SHARE       = ALL,
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:78   
      624    11241                 FUN         = UPDATE,
      625    11242                 ASN         = COMGROUP,
      626    11243                 SETSTA      = OUTSYMFPRGNAME,
      627    11244                 ACCT        = SYSACCT,
      628    11245                 NAME        = OSCG,
      629    11246                 ORG         = FPRG,
      630    11247                 STCLASS     = STATIC);
      631    11356
      632    11357        %VLP_SETSTA                           (FPTN=OUTSYMFPRGNAME,
      633    11358                 STCLASS     = CONSTANT,
      634    11359                 MYSTATION   = 'OSFPRG');
      635    11387
      636    11388
      637    11389
      638    11390
      639    11391        /**/
      640    11392        /* SUBS */
      641    11393        /**/
      642    11394        %SUB DEV$=FO_DEV$;
      643    11395        %SUB FIL$=FO_FIL$;
      644    11396        %SUB JOB$=FO_JOB$;
      645    11397        %SUB F_FO='0617'O;
      646    11398        %SUB M_O='17'O;
      647    11399        %SUB B$ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
      648    11400        %SUB FOREVER="WHILE ('1'B)";
      649    11401        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:79   
      650    11402        /*
      651    11403
      652    11404             ###    #   #   #####    ###    #   #   #   #
      653    11405            #   #   #   #     #     #   #   #   #   ## ##
      654    11406            #   #   #   #     #     #        # #    # # #
      655    11407            #   #   #   #     #      ###      #     #   #
      656    11408            #   #   #   #     #         #     #     #   #
      657    11409            #   #   #   #     #     #   #     #     #   #
      658    11410             ###     ###      #      ###      #     #   #
      659    11411
      660    11412
      661    11413                     ###    #   #    ###    #####
      662    11414                      #     #   #     #       #
      663    11415                      #     ##  #     #       #
      664    11416                      #     # # #     #       #
      665    11417                      #     #  ##     #       #
      666    11418                      #     #   #     #       #
      667    11419                     ###    #   #    ###      #
      668    11420
      669    11421        */
      670    11422    1         CALL M$RPRIV (EFTPRIV) ALTRET(NOREFT);

  11422  9 000002   001222 630400 2                  EPPR0   EFTPRIV
         9 000003   420013 713400                    CLIMB   alt,+8203
         9 000004   400000 401760                    pmme    nvectors=1
         9 000005   000006 702000 9                  TSX2    NOREFT

  11422  9 000006                       NOREFT       null
      671    11423    1   NOREFT:;
      672    11424                                /* GET EXIT CONTROL */
      673    11425    1         CALL M$XCON (XCONSET);

  11425  9 000006   001012 630400 2                  EPPR0   XCONSET
         9 000007   010003 713400                    CLIMB   4099
         9 000010   400400 401760                    pmme    nvectors=2

      674    11426                                /* SET UP VARIOUS MISCELLANEOUS GOODIES */
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:80   
      675    11427    1         CALL MISC_SETUP;

  11427  9 000011   003123 701000 9                  TSX1    MISC_SETUP
         9 000012   000000 011000                    NOP     0

      676    11428                                /* SET UP EVENT RECEIVER */
      677    11429    1         CALL M$EVENT (OSEVENT);

  11429  9 000013   000210 630400 2                  EPPR0   OSEVENT
         9 000014   010001 713400                    CLIMB   4097
         9 000015   400000 401760                    pmme    nvectors=1

      678    11430                                /* CONNECT TO CS COMGROUP */
      679    11431    1         CALL M$OPEN (OPEN_CSCG);

  11431  9 000016   000214 630400 2                  EPPR0   OPEN_CSCG
         9 000017   050000 713400                    CLIMB   open
         9 000020   410400 401760                    pmme    nvectors=18

      680    11432    1         CALL M$READ (READ_CSCG);

  11432  9 000021   000756 630400 2                  EPPR0   READ_CSCG
         9 000022   040000 713400                    CLIMB   read
         9 000023   401400 401760                    pmme    nvectors=4

      681    11433                                /* CONNECT TO OUTSYM COMGROUP */
      682    11434    1         CALL M$OPEN (OPEN_OSCG);

  11434  9 000024   000010 630400 2                  EPPR0   OPEN_OSCG
         9 000025   050000 713400                    CLIMB   open
         9 000026   410400 401760                    pmme    nvectors=18

      683    11435    1         CALL M$CGCTL (CTL_OSCG);

  11435  9 000027   000102 630400 2                  EPPR0   CTL_OSCG
         9 000030   100003 713400                    CLIMB   32771
         9 000031   411400 401760                    pmme    nvectors=20
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:81   

      684    11436    1         CALL M$READ (READ_OSCG);

  11436  9 000032   000774 630400 2                  EPPR0   READ_OSCG
         9 000033   040000 713400                    CLIMB   read
         9 000034   401400 401760                    pmme    nvectors=4

      685    11437
      686    11438    1         CALL M$OPEN (OPEN_FPRG);

  11438  9 000035   000544 630400 1                  EPPR0   OPEN_FPRG
         9 000036   050000 713400                    CLIMB   open
         9 000037   410400 401760                    pmme    nvectors=18

      687    11439                                /* PICK UP EXTANT FILES IN :SYMO */
      688    11440    1         CALL GET_FILES;

  11440  9 000040   002705 701000 9                  TSX1    GET_FILES
         9 000041   000000 011000                    NOP     0

      689    11441                                /* Let M$JOBSTATS run */
      690    11442    1         FO_Q.RCVR=0;

  11442  9 000042   000001 450000 xsym               STZ     FO_Q+1

      691    11443                           /* Tell SLUG our init is complete */
      692    11444    1         CALL M$WRITE (SEND_PCMP);

  11444  9 000043   001124 630400 2                  EPPR0   SEND_PCMP
         9 000044   040001 713400                    CLIMB   write
         9 000045   401400 401760                    pmme    nvectors=4

      693    11445
      694    11446    1         CALL M$OPEN (OPEN_HLP)

  11446  9 000046   000176 630400 1                  EPPR0   OPEN_HLP
         9 000047   450000 713400                    CLIMB   alt,open
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:82   
         9 000050   410400 401760                    pmme    nvectors=18
         9 000051   000053 702000 9                  TSX2    s:11473
         9 000052   000053 710000 9                  TRA     s:11473

      695    11447    2         WHENALTRETURN DO;

      696    11448        /*N* SNAP */
      697    11449    2           END;

      698    11450        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:83   
      699    11451        /*
      700    11452
      701    11453                    #   #    ###     ###    #   #
      702    11454                    ## ##   #   #     #     #   #
      703    11455                    # # #   #   #     #     ##  #
      704    11456                    #   #   #####     #     # # #
      705    11457                    #   #   #   #     #     #  ##
      706    11458                    #   #   #   #     #     #   #
      707    11459                    #   #   #   #    ###    #   #
      708    11460
      709    11461
      710    11462                    #        ###     ###    ####
      711    11463                    #       #   #   #   #   #   #
      712    11464                    #       #   #   #   #   #   #
      713    11465                    #       #   #   #   #   ####
      714    11466                    #       #   #   #   #   #
      715    11467                    #       #   #   #   #   #
      716    11468                    #####    ###     ###    #
      717    11469
      718    11470        */
      719    11471    2           DO FOREVER;

      720    11472    3             DO INHIBIT;

      721    11473    3             IF FO_EVHD$=ADDR(NIL) THEN

  11473  9 000053   000000 236200 xsym               LDQ   ! FO_EVHD$
         9 000054   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         9 000055   000165 601200 9                  TNZ   ! GOTEVENT

      722    11474    4   NOEVENT:    DO;

  11474  9 000056                       NOEVENT      null
      723    11475    4               IF GOODNGT = 0 THEN

  11475  9 000056   000002 235200 1                  LDA   ! GOODNGT
         9 000057   000064 601200 9                  TNZ   ! s:11477
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:84   

      724    11476    4                SLEEP.V.UNITS#=FOMI_DSMI#-TIMEASLEEP;

  11476  9 000060   000454 235207                    LDA   ! 300,DL
         9 000061   000003 135200 1                  SBLA  ! TIMEASLEEP
         9 000062   000360 755200 1                  STA   ! SLEEP+4
         9 000063   000066 710200 9                  TRA   ! s:11478

      725    11477    4               ELSE SLEEP.V.UNITS#=3;

  11477  9 000064   000003 235207                    LDA   ! 3,DL
         9 000065   000360 755200 1                  STA   ! SLEEP+4

      726    11478    4               CALL M$WAIT(SLEEP);

  11478  9 000066   000354 630600 1                  EPPR0 ! SLEEP
         9 000067   020006 713600                    CLIMB ! 8198
         9 000070   400400 401760                    pmme    nvectors=2

      727    11479    4               TIMEASLEEP=TIMEASLEEP+SLEEP.V.UNITS#-UNEXPT;

  11479  9 000071   000003 236200 1                  LDQ   ! TIMEASLEEP
         9 000072   000360 036200 1                  ADLQ  ! SLEEP+4
         9 000073   000001 136200 1                  SBLQ  ! UNEXPT
         9 000074   000003 756200 1                  STQ   ! TIMEASLEEP

      728    11480    4               HEXPIRE=HEXPIRE-(SLEEP.V.UNITS#-UNEXPT);

  11480  9 000075   000360 236200 1                  LDQ   ! SLEEP+4
         9 000076   000001 136200 1                  SBLQ  ! UNEXPT
         9 000077   200112 756300                    STQ   ! OSFNAME+5,,AUTO
         9 000100   000004 236200 1                  LDQ   ! HEXPIRE
         9 000101   200112 136300                    SBLQ  ! OSFNAME+5,,AUTO
         9 000102   000004 756200 1                  STQ   ! HEXPIRE

      729    11481    4               IF HEXPIRE <= 0 THEN

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:85   
  11481  9 000103   000111 605600 9                  TPNZ  ! s:11489

      730    11482    5                 DO;

      731    11483    5                 HEXPIRE=1800; /* 30 minutes */

  11483  9 000104   003410 235207                    LDA   ! 1800,DL
         9 000105   000004 755200 1                  STA   ! HEXPIRE

      732    11484                                      /* Eliminate "HELD" files */
      733    11485    5                 CALL FOF$HEXPIRE;

  11485  9 000106   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         9 000107   000000 701200 xent               TSX1  ! FOF$HEXPIRE
         9 000110   000000 011200                    NOP   ! 0

      734    11486    5                 END;

      735    11487        /**/
      736    11488        /**/
      737    11489    4               IF GOODNGT > 0 THEN

  11489  9 000111   000002 235200 1                  LDA   ! GOODNGT
         9 000112   000155 604600 9                  TMOZ  ! s:11516

      738    11490    5   ZAPPEND:      DO;

  11490  9 000113                       ZAPPEND      null
      739    11491    5                 IF TIMEASLEEP > 5 THEN

  11491  9 000113   000003 236200 1                  LDQ   ! TIMEASLEEP
         9 000114   000005 116207                    CMPQ  ! 5,DL
         9 000115   000235 604600 9                  TMOZ  ! s:11552

      740    11492    6   CHKZAP:         DO;

  11492  9 000116                       CHKZAP       null
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:86   
      741    11493    6                   I=0;

  11493  9 000116   200004 450300                    STZ   ! I,,AUTO

      742    11494    6                   DEV$=FO_Q.DEVHD$;

  11494  9 000117   000002 236200 xsym               LDQ   ! FO_Q+2
         9 000120   000000 756200 xsym               STQ   ! FO_DEV$

      743    11495    7                     DO WHILE (DEV$ ~= ADDR(NIL));

  11495  9 000121   000132 710200 9                  TRA   ! s:11498

      744    11496    7                     IF DEV$->FO$DEV.STATE ~= FOS_IDLE# THEN I=1;

  11496  9 000122   000000 470600 xsym               LDP0  ! FO_DEV$
         9 000123   000011 236300                    LDQ   ! 9,,PR0
         9 000124   777000 316207                    CANQ  ! -512,DL
         9 000125   000130 600200 9                  TZE   ! s:11497

  11496  9 000126   000001 235207                    LDA   ! 1,DL
         9 000127   200004 755300                    STA   ! I,,AUTO

      745    11497    7                     DEV$=DEV$->FO$DEV.LNK$;

  11497  9 000130   000000 236300                    LDQ   ! 0,,PR0
         9 000131   000000 756200 xsym               STQ   ! FO_DEV$

      746    11498    7                     END;

  11498  9 000132   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         9 000133   000122 601200 9                  TNZ   ! s:11496

      747    11499    6                   IF I ~= 0 THEN TIMEASLEEP=0;

  11499  9 000134   200004 235300                    LDA   ! I,,AUTO
         9 000135   000140 600200 9                  TZE   ! ZAPDUN
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:87   

  11499  9 000136   000003 450200 1                  STZ   ! TIMEASLEEP
         9 000137   000235 710200 9                  TRA   ! s:11552

      748    11500    6                   ELSE
      749    11501    7   ZAPDUN:           DO;

  11501  9 000140                       ZAPDUN       null
      750    11502    7                     GOODNGT=-1;

  11502  9 000140   000001 335207                    LCA   ! 1,DL
         9 000141   000002 755200 1                  STA   ! GOODNGT

      751    11503    7                     CALL FOR$CLOSE;

  11503  9 000142   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         9 000143   000000 701200 xent               TSX1  ! FOR$CLOSE
         9 000144   000000 011200                    NOP   ! 0

      752    11504    7                     CALL M$CLOSE (CLOSE_OSYMB) ALTRET(CA2);

  11504  9 000145   001150 630600 2                  EPPR0 ! CLOSE_OSYMB
         9 000146   450001 713600                    CLIMB ! alt,close
         9 000147   406000 401760                    pmme    nvectors=13
         9 000150   000151 702200 9                  TSX2  ! CA2

  11502  9 000151                       CA2          null
      753    11505    7   CA2:              ;
      754    11506    7                     CALL M$WRITE (WRITE_ZAPRESP);

  11506  9 000151   001206 630600 2                  EPPR0 ! WRITE_ZAPRESP
         9 000152   040001 713600                    CLIMB ! write
         9 000153   401400 401760                    pmme    nvectors=4

      755    11507    7                     END ZAPDUN;

      756    11508    6                   END CHKZAP;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:88   

      757    11509    5                 END ZAPPEND;

  11509  9 000154   000235 710200 9                  TRA   ! s:11552

      758    11510        /**/
      759    11511        /**/
      760    11512    4               ELSE
      761    11513    5                 DO;

      762    11514                                      /* See if we have been sleeping for more
      763    11515                                         than 300 seconds (5 minutes). */
      764    11516    5                 IF TIMEASLEEP >= FOMI_DSMI# THEN

  11516  9 000155   000003 236200 1                  LDQ   ! TIMEASLEEP
         9 000156   000454 116207                    CMPQ  ! 300,DL
         9 000157   000235 604200 9                  TMI   ! s:11552

      765    11517    6                   DO;

      766    11518                           /* PRINT SETUP SUGGESTIONS FOR DEVICES */
      767    11519    6                   TIMEASLEEP=0;

  11519  9 000160   000003 450200 1                  STZ   ! TIMEASLEEP

      768    11520                                      /* Scan :SYMO files. Those queued for
      769    11521                                         idle devices - print message */
      770    11522    6                   CALL FOD$FSCHK;

  11522  9 000161   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         9 000162   000000 701200 xent               TSX1  ! FOD$FSCHK
         9 000163   000000 011200                    NOP   ! 0

      771    11523    6                   END;

      772    11524    5                 END;

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:89   
      773    11525    4               END NOEVENT;

  11525  9 000164   000235 710200 9                  TRA   ! s:11552

      774    11526    3             ELSE
      775    11527    4   GOTEVENT:   DO;

  11527  9 000165                       GOTEVENT     null
      776    11528    4               EVNT$=FO_EVHD$;

  11528  9 000165   200014 756300                    STQ   ! EVNT$,,AUTO

      777    11529    4               FO_EVHD$=EVNT$->FO$EVNT.LNK$;

  11529  9 000166   200014 470700                    LDP0  ! EVNT$,,AUTO
         9 000167   000000 236300                    LDQ   ! 0,,PR0
         9 000170   000000 756200 xsym               STQ   ! FO_EVHD$

      778    11530    4               IF FO_EVHD$=ADDR(NIL) THEN FO_EVTL$=ADDR(NIL);

  11530  9 000171   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         9 000172   000175 601200 9                  TNZ   ! s:11532

  11530  9 000173   000001 236200 xsym               LDQ   ! B_VECTNIL+1
         9 000174   000000 756200 xsym               STQ   ! FO_EVTL$

      779    11531                                      /* Is there a ZAP in progress? */
      780    11532    4               IF GOODNGT >= 0 THEN

  11532  9 000175   000002 235200 1                  LDA   ! GOODNGT
         9 000176   000201 604200 9                  TMI   ! s:11534

      781    11533    4                CALL EXT_EVENT;

  11533  9 000177   000236 701200 9                  TSX1  ! EXT_EVENT
         9 000200   000000 011200                    NOP   ! 0

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:90   
      782    11534    5                 DO CASE (EVNT$->FO$EVNT.ENDAC);

  11534  9 000201   200014 470700                    LDP0  ! EVNT$,,AUTO
         9 000202   000001 720300                    LXL0  ! 1,,PR0
         9 000203   000003 100203                    CMPX0 ! 3,DU
         9 000204   000206 602210 9                  TNC   ! s:11534+5,X0
         9 000205   000220 710200 9                  TRA   ! s:11544
         9 000206   000220 710200 9                  TRA   ! s:11544
         9 000207   000211 710200 9                  TRA   ! s:11536
         9 000210   000215 710200 9                  TRA   ! s:11538

      783    11535    5                   CASE (FOEA_CSCG#);

      784    11536    5                     CALL M$READ (READ_CSCG);

  11536  9 000211   000756 630600 2                  EPPR0 ! READ_CSCG
         9 000212   040000 713600                    CLIMB ! read
         9 000213   401400 401760                    pmme    nvectors=4
         9 000214   000220 710200 9                  TRA   ! s:11544

      785    11537    5                   CASE (FOEA_OSCG#);

      786    11538    5                     CALL M$READ (READ_OSCG);

  11538  9 000215   000774 630600 2                  EPPR0 ! READ_OSCG
         9 000216   040000 713600                    CLIMB ! read
         9 000217   401400 401760                    pmme    nvectors=4

      787    11539    5                 END;

      788    11540                                      /* If NIL then add the event to the end
      789    11541                                         of the circular queue.  Otherwise
      790    11542                                         make the current last event point to
      791    11543                                         new last event. */
      792    11544    4               IF FO_FEVTL$=ADDR(NIL) THEN FO_FEVHD$=EVNT$;

  11544  9 000220   000000 236200 xsym               LDQ   ! FO_FEVTL$
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:91   
         9 000221   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         9 000222   000226 601200 9                  TNZ   ! s:11545

  11544  9 000223   200014 236300                    LDQ   ! EVNT$,,AUTO
         9 000224   000000 756200 xsym               STQ   ! FO_FEVHD$
         9 000225   000231 710200 9                  TRA   ! s:11547

      793    11545    4               ELSE FO_FEVTL$->FO$EVNT.LNK$=EVNT$;

  11545  9 000226   200014 236300                    LDQ   ! EVNT$,,AUTO
         9 000227   000000 470600 xsym               LDP0  ! FO_FEVTL$
         9 000230   000000 756300                    STQ   ! 0,,PR0

      794    11546                                      /* FO_FEVTL$ is the new last event ptr */
      795    11547    4               FO_FEVTL$=EVNT$;

  11547  9 000231   000000 756200 xsym               STQ   ! FO_FEVTL$

      796    11548                                      /* Last event on queue points to NIL */
      797    11549    4               EVNT$->FO$EVNT.LNK$=ADDR(NIL);

  11549  9 000232   000001 236200 xsym               LDQ   ! B_VECTNIL+1
         9 000233   200014 470700                    LDP0  ! EVNT$,,AUTO
         9 000234   000000 756300                    STQ   ! 0,,PR0

      798    11550    4               END GOTEVENT;

      799    11551    3             END; /* INHIBIT */

      800    11552    2           END;

  11552  9 000235   000053 710000 9                  TRA     s:11473

      801    11553        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:92   
      802    11554        /*
      803    11555
      804    11556            #####   #   #   #####   #####   ####    #   #    ###    #
      805    11557            #       #   #     #     #       #   #   #   #   #   #   #
      806    11558            #        # #      #     #       #   #   ##  #   #   #   #
      807    11559            ####      #       #     ####    ####    # # #   #####   #
      808    11560            #        # #      #     #       # #     #  ##   #   #   #
      809    11561            #       #   #     #     #       #  #    #   #   #   #   #
      810    11562            #####   #   #     #     #####   #   #   #   #   #   #   #####
      811    11563
      812    11564
      813    11565                    #####   #   #   #####   #   #   #####
      814    11566                    #       #   #   #       #   #     #
      815    11567                    #       #   #   #       ##  #     #
      816    11568                    ####    #   #   ####    # # #     #
      817    11569                    #       #   #   #       #  ##     #
      818    11570                    #        # #    #       #   #     #
      819    11571                    #####     #     #####   #   #     #
      820    11572
      821    11573        */
      822    11574        /*****
      823    11575         *****
      824    11576         *****
      825    11577         *****   PROCESS THE EVENT HERE
      826    11578         *****
      827    11579         *****
      828    11580         *****/
      829    11581        /**/
      830    11582        /*D* NAME:         EXT_EVENT
      831    11583             PURPOSE:      To process an external event
      832    11584             DESCRIPTION:  EVNT$ points to an FO$EVNT frame, in which is a
      833    11585                           code, and a possible CITE$ pointing to an FO$CITE
      834    11586                           frame.
      835    11587        */
      836    11588    1   EXT_EVENT: PROC;

  11588  9 000236   200104 741300       EXT_EVENT    STX1  ! FILE_ADDED+2,,AUTO
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:93   

      837    11589    2         FIL$=ADDR(NIL);

  11589  9 000237   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000240   000000 756000 xsym               STQ     FO_FIL$

      838    11590    2         DEV$=ADDR(NIL);

  11590  9 000241   000000 756000 xsym               STQ     FO_DEV$

      839    11591    2         EXT$=ADDR(NIL);

  11591  9 000242   200026 756100                    STQ     EXT$,,AUTO

      840    11592    2         CITE$=EVNT$->FO$EVNT.CITE$;

  11592  9 000243   200014 470500                    LDP0    EVNT$,,AUTO
         9 000244   000002 236100                    LDQ     2,,PR0
         9 000245   200077 756100                    STQ     CITE$,,AUTO

      841    11593    3           DO CASE (EVNT$->FO$EVNT.CODE);

  11593  9 000246   000001 220100                    LDX0    1,,PR0
         9 000247   000017 100003                    CMPX0   15,DU
         9 000250   000252 602010 9                  TNC     s:11593+4,X0
         9 000251   001660 710000 9                  TRA     s:12133
         9 000252   001664 710000 9                  TRA     ENDEVENT
         9 000253   000271 710000 9                  TRA     s:11604
         9 000254   000431 710000 9                  TRA     s:11717
         9 000255   000475 710000 9                  TRA     s:11747
         9 000256   001660 710000 9                  TRA     s:12133
         9 000257   001406 710000 9                  TRA     s:12037
         9 000260   001433 710000 9                  TRA     s:12047
         9 000261   001461 710000 9                  TRA     s:12057
         9 000262   001510 710000 9                  TRA     s:12068
         9 000263   001536 710000 9                  TRA     s:12077
         9 000264   001600 710000 9                  TRA     s:12095
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:94   
         9 000265   001561 710000 9                  TRA     s:12087
         9 000266   001631 710000 9                  TRA     s:12105
         9 000267   001653 710000 9                  TRA     s:12114
         9 000270   001401 710000 9                  TRA     s:12029

      842    11594        /***
      843    11595         ***
      844    11596         ***
      845    11597         ***          OSCG ADMIN USER EVENT
      846    11598         ***
      847    11599         ***
      848    11600         ***/
      849    11601                                /* Produced by a read-complete with
      850    11602                                   MSGTYP '*AUEV' */
      851    11603    3             CASE (FOEV_OSAU#);

      852    11604    3               CGAURD$=ADDR(FO_OSCGBUF);

  11604  9 000271   000000 236000 10                 LDQ     0
         9 000272   200076 756100                    STQ     CGAURD$,,AUTO

      853    11605    3               DEVNAME=CGAURD$->B$CGAURD.STATION;

  11605  9 000273   200076 471500                    LDP1    CGAURD$,,AUTO
         9 000274   040000 100500                    MLR     fill='040'O
         9 000275   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         9 000276   000022 000010 1                  ADSC9   DEVNAME                  cn=0,n=8

      854    11606    4                 DO CASE (CGAURD$->B$CGAURD.EVENT);

  11606  9 000277   100000 235100                    LDA     0,,PR1
         9 000300   000033 115007                    CMPA    27,DL
         9 000301   000303 602005 9                  TNC     s:11606+4,AL
         9 000302   000424 710000 9                  TRA     s:11697
         9 000303   000361 710000 9                  TRA     s:11642
         9 000304   000424 710000 9                  TRA     s:11697
         9 000305   000336 710000 9                  TRA     s:11621
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:95   
         9 000306   000370 710000 9                  TRA     s:11676
         9 000307   000370 710000 9                  TRA     s:11676
         9 000310   000424 710000 9                  TRA     s:11697
         9 000311   000424 710000 9                  TRA     s:11697
         9 000312   000424 710000 9                  TRA     s:11697
         9 000313   000424 710000 9                  TRA     s:11697
         9 000314   000345 710000 9                  TRA     s:11631
         9 000315   000370 710000 9                  TRA     s:11676
         9 000316   000370 710000 9                  TRA     s:11676
         9 000317   000370 710000 9                  TRA     s:11676
         9 000320   000370 710000 9                  TRA     s:11676
         9 000321   000370 710000 9                  TRA     s:11676
         9 000322   000370 710000 9                  TRA     s:11676
         9 000323   000370 710000 9                  TRA     s:11676
         9 000324   000370 710000 9                  TRA     s:11676
         9 000325   000424 710000 9                  TRA     s:11697
         9 000326   000424 710000 9                  TRA     s:11697
         9 000327   000424 710000 9                  TRA     s:11697
         9 000330   000424 710000 9                  TRA     s:11697
         9 000331   000370 710000 9                  TRA     s:11676
         9 000332   000424 710000 9                  TRA     s:11697
         9 000333   000370 710000 9                  TRA     s:11676
         9 000334   000370 710000 9                  TRA     s:11676
         9 000335   000367 710000 9                  TRA     s:11653

      855    11607        /**
      856    11608         **
      857    11609         **      TERMINAL CONNECT
      858    11610         **
      859    11611         **/
      860    11612    4                   CASE (%CG_TCON#);

      861    11613                                                     /**/
      862    11614                                      /* We must deactivate because of the
      863    11615                                         timing window between the open of
      864    11616                                         OSCG and the CGCTL of OSCG.  During
      865    11617                                         this time, stations that connect are
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:96   
      866    11618                                         ACTIVATED (the default) before we
      867    11619                                         have a chance to turn off this option. */
      868    11620                                                     /**/
      869    11621    4                     CALL M$DEACTIVATE (DEACT_DEV) ALTRET (ALREADY_DEACT);

  11621  9 000336   000700 630400 2                  EPPR0   DEACT_DEV
         9 000337   500001 713400                    CLIMB   alt,+32769
         9 000340   401400 401760                    pmme    nvectors=4
         9 000341   000342 702000 9                  TSX2    ALREADY_DEACT

      870    11622    4   ALREADY_DEACT:
      871    11623    4                     CALL ADD_DEV;

  11623  9 000342   001666 701000 9     ALREADY_DEA* TSX1    ADD_DEV
         9 000343   000000 011000                    NOP     0

      872    11624    4                     GOTO ENDEVENT;

  11624  9 000344   001664 710000 9                  TRA     ENDEVENT

      873    11625        /**
      874    11626         **
      875    11627         **      COMGROUP LOW-ON-SPACE WARNING
      876    11628         **
      877    11629         **/
      878    11630    4                   CASE (%CG_WARN#);

      879    11631    4                     CALL M$EXTEND (EXTEND_OSCG) ALTRET(XTNDALT);

  11631  9 000345   000166 630400 2                  EPPR0   EXTEND_OSCG
         9 000346   440005 713400                    CLIMB   alt,+16389
         9 000347   400000 401760                    pmme    nvectors=1
         9 000350   000351 702000 9                  TSX2    XTNDALT

  11631  9 000351                       XTNDALT      null
      880    11632    4   XTNDALT:          ;
      881    11633    4                     OSCGCP.MAXPG#=OSCGCP.MAXPG#+%FOMI_CXMP#;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:97   

  11633  9 000351   000160 220000 1                  LDX0    OSCGCP+6
         9 000352   000031 621010                    EAX1    25,X0
         9 000353   000160 741000 1                  STX1    OSCGCP+6

      882    11634    4                     CALL M$CGCTL (CTL_OSCG) ALTRET(XTNDALT0);

  11634  9 000354   000102 630400 2                  EPPR0   CTL_OSCG
         9 000355   500003 713400                    CLIMB   alt,+32771
         9 000356   411400 401760                    pmme    nvectors=20
         9 000357   000360 702000 9                  TSX2    XTNDALT0

  11633  9 000360   001664 710000 9     XTNDALT0     TRA     ENDEVENT

      883    11635    4   XTNDALT0:         ;
      884    11636        /**
      885    11637         **
      886    11638         **      M$FPRG DCB OPEN
      887    11639         **
      888    11640         **/
      889    11641    4                   CASE (%CG_DOPN#);

      890    11642    4                     CALL M$ACTIVATE (ACT_FPRG)

  11642  9 000361   000720 630400 2                  EPPR0   ACT_FPRG
         9 000362   500000 713400                    CLIMB   alt,+32768
         9 000363   401400 401760                    pmme    nvectors=4
         9 000364   000366 702000 9                  TSX2    s:11646
         9 000365   000366 710000 9                  TRA     s:11646

      891    11643    5                     WHENALTRETURN DO;

      892    11644    5                       END;

      893    11645
      894    11646    4                     GOTO ENDEVENT;

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:98   
  11646  9 000366   001664 710000 9                  TRA     ENDEVENT

      895    11647        /**
      896    11648         **
      897    11649         **      FPRG LOAD & TRANSFER CONTROL
      898    11650         **
      899    11651         **/
      900    11652    4                   CASE (%CG_FPLDTRC#);

      901    11653    4                     GOTO ENDEVENT;

  11653  9 000367   001664 710000 9                  TRA     ENDEVENT

      902    11654        /**
      903    11655         **
      904    11656         **      SIMPLE REPORT-EVENT EVENT
      905    11657         **
      906    11658         **/
      907    11659    4                   CASE (%CG_TDSC#,

      908    11660    4                     %CG_TBRK#,
      909    11661    4                     %CG_STDSC#,
      910    11662    4                     %CG_STHLD#,
      911    11663    4                     %CG_SFERR#,
      912    11664    4                     %CG_STERR#,
      913    11665    4                     %CG_SFEXT#,
      914    11666    4                     %CG_STACK#,
      915    11667    4                     %CG_SFSPA#,
      916    11668    4                     %CG_TDRQ#,
      917    11669    4                     %CG_STOKN#,
      918    11670    4                     %CG_FPABORT#,
      919    11671    4                     %CG_FPEXIT#);
      920    11672                                /* FOR THESE EVENTS WE JUST FIND THE POINTER
      921    11673                                   TO THE DEVICE INVOLVED, AND REPORT THE
      922    11674                                   APPROPRIATE EVENT */
      923    11675
      924    11676    4                     CALL FIND_DEV ALTRET(A11);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:99   

  11676  9 000370   002636 701000 9                  TSX1    FIND_DEV
         9 000371   000411 702000 9                  TSX2    A11

      925    11677    4                     INFO=CGAURD$->B$CGAURD.INFO;

  11677  9 000372   200076 470500                    LDP0    CGAURD$,,AUTO
         9 000373   000003 235100                    LDA     3,,PR0
         9 000374   200072 755100                    STA     INFO,,AUTO

      926    11678    4                     DEVENT=EVXLATE(CGAURD$->B$CGAURD.EVENT);

  11678  9 000375   000000 720100                    LXL0    0,,PR0
         9 000376   200033 235110                    LDA     EVXLATE,X0,AUTO
         9 000377   200073 755100                    STA     DEVENT,,AUTO

      927    11679    4                     CALL FOD$EVENT(DEVENT,INFO) ALTRET(DEVSCHED);

  11679  9 000400   200072 631500                    EPPR1   INFO,,AUTO
         9 000401   200113 451500                    STP1    OSFNAME+6,,AUTO
         9 000402   200073 633500                    EPPR3   DEVENT,,AUTO
         9 000403   200112 453500                    STP3    OSFNAME+5,,AUTO
         9 000404   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 000405   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000406   000000 701000 xent               TSX1    FOD$EVENT
         9 000407   000472 702000 9                  TSX2    DEVSCHED

      928    11680    4                     GOTO ENDEVENT;

  11680  9 000410   001664 710000 9                  TRA     ENDEVENT

      929    11681
      930    11682    4   A11:              IF CGAURD$->B$CGAURD.EVENT = %CG_TDSC#

  11682  9 000411   200076 470500       A11          LDP0    CGAURD$,,AUTO
         9 000412   000000 235100                    LDA     0,,PR0
         9 000413   000003 115007                    CMPA    3,DL
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:100  
         9 000414   001664 600000 9                  TZE     ENDEVENT
         9 000415   000020 115007                    CMPA    16,DL
         9 000416   001664 600000 9                  TZE     ENDEVENT

      931    11683    4                     OR CGAURD$->B$CGAURD.EVENT = %CG_STOKN# THEN GOTO ENDEVENT;
      932    11684    4                     CALL FOI$SNAP (%S$NODEV,F_FO,M_O);

  11684  9 000417   000004 630400 10                 EPPR0   4
         9 000420   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000421   000000 701000 xent               TSX1    FOI$SNAP
         9 000422   000000 011000                    NOP     0
         9 000423   001664 710000 9                  TRA     ENDEVENT

      933    11685        /*S* SCREECH_CODE: FOO-S$NODEV
      934    11686             TYPE:         SNAP
      935    11687             MESSAGE:      Event reported on non-existant device
      936    11688             REMARKS:      A disconnect, break, or similar event has
      937    11689                           been reported, but the named device
      938    11690                           cannot be found.                        */
      939    11691        /**
      940    11692         **
      941    11693         **      ELSE CASE
      942    11694         **
      943    11695         **/
      944    11696    4                   CASE (ELSE);

      945    11697    4                     CALL FOI$SNAP (%S$BADOSAUEV,F_FO,M_O);

  11697  9 000424   000010 630400 10                 EPPR0   8
         9 000425   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 000426   000000 701000 xent               TSX1    FOI$SNAP
         9 000427   000000 011000                    NOP     0

      946    11698        /*S* SCREECH_CODE: FOO-S$BADOSAUEV
      947    11699             TYPE:         SNAP
      948    11700             MESSAGE:      Unknown OSAU event passed to OUTSYM
      949    11701             REMARKS:      OUTSYM has received an OUTSYM COMGROUP administrative
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:101  
      950    11702                           user event which he does not recognize.  This sug-
      951    11703                           gests that the path between he and the event issuer
      952    11704                           has been clobbered somewhere, or that someone has
      953    11705                           added a new event OUTSYM does not know about and
      954    11706                           was not expected to get.                */
      955    11707    4                 END; /* CASE OSAU.SUBC */

  11707  9 000430   001664 710000 9                  TRA     ENDEVENT

      956    11708        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:102  
      957    11709        /***
      958    11710         ***
      959    11711         ***
      960    11712         ***          NEW OUTPUT FILE ADDED
      961    11713         ***
      962    11714         ***
      963    11715         ***/
      964    11716    3             CASE (FOEV_NEWF#);

      965    11717    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;

  11717  9 000431   200077 471500                    LDP1    CITE$,,AUTO
         9 000432   100000 236100                    LDQ     0,,PR1
         9 000433   777777 376007                    ANQ     -1,DL
         9 000434   200023 756100                    STQ     FIL_SYSID,,AUTO

      966    11718    3               FIL_NUM=CITE$->FO$JOBEV.NUM;

  11718  9 000435   100001 236100                    LDQ     1,,PR1
         9 000436   777777 376007                    ANQ     -1,DL
         9 000437   200024 756100                    STQ     FIL_NUM,,AUTO

      967    11719    3               FIL_CNUM = CITE$->FO$JOBEV.CNUM;

  11719  9 000440   100002 236100                    LDQ     2,,PR1
         9 000441   000022 772000                    QRL     18
         9 000442   200025 756100                    STQ     FIL_CNUM,,AUTO

      968    11720                    %JLOCK;

  11721  9 000443   000000 054000 xsym               AOS     FO_Q

      969    11723    3               CALL FOF$ADD(FIL_SYSID,FIL_NUM,FIL_CNUM,0,FO_BOOTID)

  11723  9 000444   000013 236000 10                 LDQ     11
         9 000445   200116 756100                    STQ     OSFNAME+9,,AUTO
         9 000446   000014 236000 10                 LDQ     12
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:103  
         9 000447   200115 756100                    STQ     OSFNAME+8,,AUTO
         9 000450   200025 633500                    EPPR3   FIL_CNUM,,AUTO
         9 000451   200114 453500                    STP3    OSFNAME+7,,AUTO
         9 000452   200024 634500                    EPPR4   FIL_NUM,,AUTO
         9 000453   200113 454500                    STP4    OSFNAME+6,,AUTO
         9 000454   200023 635500                    EPPR5   FIL_SYSID,,AUTO
         9 000455   200112 455500                    STP5    OSFNAME+5,,AUTO
         9 000456   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 000457   000023 631400 xsym               EPPR1   B_VECTNIL+19
         9 000460   000000 701000 xent               TSX1    FOF$ADD
         9 000461   000465 702000 9                  TSX2    s:11728

      970    11724    4               WHENRETURN DO;

      971    11725    4                 FILE_ADDED = %YES#;

  11725  9 000462   400000 236003                    LDQ     -131072,DU
         9 000463   200102 756100                    STQ     FILE_ADDED,,AUTO

      972    11726    4                 END;

  11726  9 000464   000466 710000 9                  TRA     s:11731

      973    11727    4               WHENALTRETURN DO;

      974    11728    4                 FILE_ADDED = %NO#;

  11728  9 000465   200102 450100                    STZ     FILE_ADDED,,AUTO

      975    11729    4                 END;

      976    11730                    %JUNLOCK;

  11731  9 000466   000001 336007                    LCQ     1,DL
         9 000467   000000 056000 xsym               ASQ     FO_Q

      977    11733                                      /* Check all devices.  If any are IDLE
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:104  
      978    11734                                         and we have a file to print, change
      979    11735                                         state to busy and start the device */
      980    11736    3               IF FILE_ADDED THEN         /* File added fine, everything is cool */

  11736  9 000470   200102 234100                    SZN     FILE_ADDED,,AUTO
         9 000471   001664 605000 9                  TPL     ENDEVENT

      981    11737    3   DEVSCHED:    CALL DRIVE_DEVS;                 /* Check for availible devices */

  11737  9 000472   002657 701000 9     DEVSCHED     TSX1    DRIVE_DEVS
         9 000473   000000 011000                    NOP     0
         9 000474   001664 710000 9                  TRA     ENDEVENT

      982    11738        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:105  
      983    11739        /***
      984    11740         ***
      985    11741         ***
      986    11742         ***          KEYIN RECEIVED
      987    11743         ***
      988    11744         ***
      989    11745         ***/
      990    11746    3             CASE (FOEV_KEYIN#);

      991    11747    3               KEYIN$=CITE$;

  11747  9 000475   200016 756100                    STQ     KEYIN$,,AUTO

      992    11748    4                 DO CASE (KEYIN$->FO$DKEYIN.KIN#);

  11748  9 000476   200016 471500                    LDP1    KEYIN$,,AUTO
         9 000477   100000 220100                    LDX0    0,,PR1
         9 000500   000070 100003                    CMPX0   56,DU
         9 000501   000503 602010 9                  TNC     s:11748+5,X0
         9 000502   001373 710000 9                  TRA     s:12010
         9 000503   001373 710000 9                  TRA     s:12010
         9 000504   000573 710000 9                  TRA     s:11765
         9 000505   000573 710000 9                  TRA     s:11765
         9 000506   000573 710000 9                  TRA     s:11765
         9 000507   000573 710000 9                  TRA     s:11765
         9 000510   000573 710000 9                  TRA     s:11765
         9 000511   000573 710000 9                  TRA     s:11765
         9 000512   000573 710000 9                  TRA     s:11765
         9 000513   000573 710000 9                  TRA     s:11765
         9 000514   000643 710000 9                  TRA     s:11805
         9 000515   000643 710000 9                  TRA     s:11805
         9 000516   000643 710000 9                  TRA     s:11805
         9 000517   000660 710000 9                  TRA     s:11821
         9 000520   000643 710000 9                  TRA     s:11805
         9 000521   000643 710000 9                  TRA     s:11805
         9 000522   000643 710000 9                  TRA     s:11805
         9 000523   000643 710000 9                  TRA     s:11805
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:106  
         9 000524   000643 710000 9                  TRA     s:11805
         9 000525   001276 710000 9                  TRA     s:11974
         9 000526   001276 710000 9                  TRA     s:11974
         9 000527   000573 710000 9                  TRA     s:11765
         9 000530   000643 710000 9                  TRA     s:11805
         9 000531   000573 710000 9                  TRA     s:11765
         9 000532   000643 710000 9                  TRA     s:11805
         9 000533   000643 710000 9                  TRA     s:11805
         9 000534   000652 710000 9                  TRA     s:11815
         9 000535   000631 710000 9                  TRA     s:11782
         9 000536   000631 710000 9                  TRA     s:11782
         9 000537   000631 710000 9                  TRA     s:11782
         9 000540   000660 710000 9                  TRA     s:11821
         9 000541   000652 710000 9                  TRA     s:11815
         9 000542   000573 710000 9                  TRA     s:11765
         9 000543   000660 710000 9                  TRA     s:11821
         9 000544   000652 710000 9                  TRA     s:11815
         9 000545   001373 710000 9                  TRA     s:12010
         9 000546   001373 710000 9                  TRA     s:12010
         9 000547   001373 710000 9                  TRA     s:12010
         9 000550   001373 710000 9                  TRA     s:12010
         9 000551   001373 710000 9                  TRA     s:12010
         9 000552   001373 710000 9                  TRA     s:12010
         9 000553   001373 710000 9                  TRA     s:12010
         9 000554   001373 710000 9                  TRA     s:12010
         9 000555   001373 710000 9                  TRA     s:12010
         9 000556   001373 710000 9                  TRA     s:12010
         9 000557   001373 710000 9                  TRA     s:12010
         9 000560   001373 710000 9                  TRA     s:12010
         9 000561   001373 710000 9                  TRA     s:12010
         9 000562   001373 710000 9                  TRA     s:12010
         9 000563   001373 710000 9                  TRA     s:12010
         9 000564   001373 710000 9                  TRA     s:12010
         9 000565   001373 710000 9                  TRA     s:12010
         9 000566   001373 710000 9                  TRA     s:12010
         9 000567   001373 710000 9                  TRA     s:12010
         9 000570   001373 710000 9                  TRA     s:12010
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:107  
         9 000571   001373 710000 9                  TRA     s:12010
         9 000572   001320 710000 9                  TRA     s:11987

      993    11749        /**
      994    11750         **
      995    11751         ** DEVICE EVENT KEYIN
      996    11752         **
      997    11753         **/
      998    11754    4                   CASE (KEY_SUSPEND#,

      999    11755    4               KEY_ABORT#,
     1000    11756    4               KEY_CONTINUE#,
     1001    11757    4               KEY_SAVE#,
     1002    11758    4               KEY_REPRINT#,
     1003    11759    4               KEY_LOCK#,
     1004    11760    4               KEY_START#,
     1005    11761    4               KEY_ALIGN#,
     1006    11762    4               KEY_RESTRICT#,
     1007    11763    4               KEY_RESTRICTW#,
     1008    11764    4               KEY_SPACE#);
     1009    11765    4                     DEVNAME=KEYIN$->FO$DKEYIN.DEVNM;

  11765  9 000573   040000 100500                    MLR     fill='040'O
         9 000574   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         9 000575   000022 000010 1                  ADSC9   DEVNAME                  cn=0,n=8

     1010    11766    4                     CALL FIND_DEV ALTRET(KEYIN0);

  11766  9 000576   002636 701000 9                  TSX1    FIND_DEV
         9 000577   000611 702000 9                  TSX2    KEYIN0

     1011    11767    4                     CALL FOD$EVENT(FODE_KEYN#,KEYIN$) ALTRET(DEVSCHED);

  11767  9 000600   200016 630500                    EPPR0   KEYIN$,,AUTO
         9 000601   200113 450500                    STP0    OSFNAME+6,,AUTO
         9 000602   000015 236000 10                 LDQ     13
         9 000603   200112 756100                    STQ     OSFNAME+5,,AUTO
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:108  
         9 000604   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 000605   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000606   000000 701000 xent               TSX1    FOD$EVENT
         9 000607   000472 702000 9                  TSX2    DEVSCHED

     1012    11768    4                     GOTO ENDEVENT;

  11768  9 000610   001664 710000 9                  TRA     ENDEVENT

     1013    11769    4   KEYIN0:
     1014    11770    4                     OPMSG_KERR.SUBC1 = 0;

  11770  9 000611   000000 236003       KEYIN0       LDQ     0,DU
         9 000612   000032 552040 1                  STBQ    OPMSG_KERR+6,'40'O

     1015    11771    4   KEYIN001:
     1016    11772    4                     OPMSG_KERR.MSG#=FO_KERR_MSG#;

  11772  9 000613   000166 220003       KEYIN001     LDX0    118,DU
         9 000614   000024 440000 1                  SXL0    OPMSG_KERR

     1017    11773    4                     OPMSG_KERR.SUBC=FOKE_NOTMY#;

  11773  9 000615   000007 236007                    LDQ     7,DL
         9 000616   000031 552004 1                  STBQ    OPMSG_KERR+5,'04'O

     1018    11774    4   KEYIN01:
     1019    11775    4                     OPMSG_KERR.CADDR=KEYIN$->FO$DKEYIN.CADDR;

  11775  9 000617   200016 470500       KEYIN01      LDP0    KEYIN$,,AUTO
         9 000620   000000 720100                    LXL0    0,,PR0
         9 000621   000024 740000 1                  STX0    OPMSG_KERR

     1020    11776    4                     OPMSG_KERR.DEVNM=DEVNAME;

  11776  9 000622   000022 237000 1                  LDAQ    DEVNAME
         9 000623   000027 755000 1                  STA     OPMSG_KERR+3
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:109  
         9 000624   000030 756000 1                  STQ     OPMSG_KERR+4

     1021    11777    4                     CALL M$WRITE (OCMSG_KERR);

  11777  9 000625   000644 630400 2                  EPPR0   OCMSG_KERR
         9 000626   040001 713400                    CLIMB   write
         9 000627   401400 401760                    pmme    nvectors=4
         9 000630   001664 710000 9                  TRA     ENDEVENT

     1022    11778
     1023    11779    4                   CASE (KEY_ROUTE#,

     1024    11780    4                     KEY_ROUTEADD#,
     1025    11781    4                     KEY_UNROUTE#);
     1026    11782    4                     CALL FOU$EVENT(FODE_KEYN#,KEYIN$)

  11782  9 000631   200016 633500                    EPPR3   KEYIN$,,AUTO
         9 000632   200113 453500                    STP3    OSFNAME+6,,AUTO
         9 000633   000015 236000 10                 LDQ     13
         9 000634   200112 756100                    STQ     OSFNAME+5,,AUTO
         9 000635   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 000636   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000637   000000 701000 xent               TSX1    FOU$EVENT
         9 000640   000642 702000 9                  TSX2    s:11787

     1027    11783    5                     WHENRETURN DO;

     1028    11784    5                       GOTO DEVSCHED;

  11784  9 000641   000472 710000 9                  TRA     DEVSCHED

     1029    11785    5                       END;
     1030    11786    5                     WHENALTRETURN DO;

     1031    11787    5                       GOTO ENDEVENT;

  11787  9 000642   001664 710000 9                  TRA     ENDEVENT
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:110  

     1032    11788    5                       END;
     1033    11789        /**
     1034    11790         **
     1035    11791         ** FILE KEYIN
     1036    11792         **
     1037    11793         **/
     1038    11794    4                   CASE (KEY_PRIOO#,

     1039    11795    4                       KEY_SWITCHO#,
     1040    11796    4                       KEY_DELETEO#,
     1041    11797    4                       KEY_PRIOOACCT#,
     1042    11798    4                       KEY_DELETEOACCT#,
     1043    11799    4                       KEY_SWITCHOACCT#,
     1044    11800    4                       KEY_SWITCHOALL#,
     1045    11801    4                       KEY_SWITCHOFORM#,
     1046    11802    4                       KEY_DELETEOFORM#,
     1047    11803    4                       KEY_PRIOOALL#,
     1048    11804    4                       KEY_DELETEOALL#);
     1049    11805    4                     CALL FOF$KEYIN (KEYIN$);

  11805  9 000643   200016 633500                    EPPR3   KEYIN$,,AUTO
         9 000644   200112 453500                    STP3    OSFNAME+5,,AUTO
         9 000645   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 000646   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000647   000000 701000 xent               TSX1    FOF$KEYIN
         9 000650   000000 011000                    NOP     0

     1050    11806    4                     GOTO DEVSCHED;

  11806  9 000651   000472 710000 9                  TRA     DEVSCHED

     1051    11807        /**
     1052    11808         **
     1053    11809         ** SYMB KEYINs
     1054    11810         **
     1055    11811         **/
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:111  
     1056    11812    4                   CASE (KEY_SYMBOTERM#,

     1057    11813    4                     KEY_SYMBOTERMT#,
     1058    11814    4                     KEY_SYMBOTERMR#);
     1059    11815    4                     OPMSG_DINFO.SUBC=1;

  11815  9 000652   001000 236007                    LDQ     512,DL
         9 000653   000070 552010 1                  STBQ    OPMSG_DINFO+16,'10'O

     1060    11816    4                     OPMSG_DINFO.TNAME=KEYIN$->FO$DKEYIN.TNAME;

  11816  9 000654   040000 100500                    MLR     fill='040'O
         9 000655   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         9 000656   000070 600010 1                  ADSC9   OPMSG_DINFO+16           cn=3,n=8

     1061    11817    4                     GOTO KEYIN1;

  11817  9 000657   000662 710000 9                  TRA     KEYIN1

     1062    11818    4                   CASE (KEY_SYMBO#,

     1063    11819    4                     KEY_SYMBOT#,
     1064    11820    4                     KEY_SYMBOR#);
     1065    11821    4                     OPMSG_DINFO.SUBC=0;

  11821  9 000660   000000 236003                    LDQ     0,DU
         9 000661   000070 552010 1                  STBQ    OPMSG_DINFO+16,'10'O

  11821  9 000662                       KEYIN1       null
     1066    11822    4   KEYIN1:           ;
     1067    11823    4                     DEVNAME=KEYIN$->FO$DKEYIN.DEVNM;

  11823  9 000662   040000 100500                    MLR     fill='040'O
         9 000663   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         9 000664   000022 000010 1                  ADSC9   DEVNAME                  cn=0,n=8

     1068    11824    4                     OPMSG_DINFO.CADDR=KEYIN$->FO$DKEYIN.CADDR;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:112  

  11824  9 000665   100000 720100                    LXL0    0,,PR1
         9 000666   000050 740000 1                  STX0    OPMSG_DINFO

     1069    11825    4                     OPMSG_RINFO.CADDR=KEYIN$->FO$DKEYIN.CADDR;

  11825  9 000667   100000 722100                    LXL2    0,,PR1
         9 000670   000101 742000 1                  STX2    OPMSG_RINFO

     1070    11826    4                     OPMSG_TINFO.CADDR=KEYIN$->FO$DKEYIN.CADDR;

  11826  9 000671   100000 723100                    LXL3    0,,PR1
         9 000672   000111 743000 1                  STX3    OPMSG_TINFO

     1071    11827                                      /* NDEV is the number of qualified
     1072    11828                                         devices */
     1073    11829    4                     NDEV=0;

  11829  9 000673   200074 450100                    STZ     NDEV,,AUTO

     1074    11830
     1075    11831    4                     DEV$=FO_Q.DEVHD$;

  11831  9 000674   000002 236000 xsym               LDQ     FO_Q+2
         9 000675   000000 756000 xsym               STQ     FO_DEV$

     1076    11832    5                       DO WHILE (DEV$ ~= ADDR(NIL));

  11832  9 000676   001246 710000 9                  TRA     s:11947

     1077    11833    5                       IF DEV$->FO$DEV.TNAME = KEYIN$->FO$DKEYIN.TNAME

  11833  9 000677   000000 470400 xsym               LDP0    FO_DEV$
         9 000700   200016 471500                    LDP1    KEYIN$,,AUTO
         9 000701   040100 106500                    CMPC    fill='040'O
         9 000702   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         9 000703   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:113  
         9 000704   000715 600000 9                  TZE     s:11837
         9 000705   040000 106500                    CMPC    fill='040'O
         9 000706   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         9 000707   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000710   001243 601000 9                  TNZ     s:11946
         9 000711   040000 106500                    CMPC    fill='040'O
         9 000712   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         9 000713   001242 000005 2                  ADSC9   OUTSYMFPRGNAME+12        cn=0,n=5
         9 000714   001243 601000 9                  TNZ     s:11946

     1078    11834    5                       OR ( KEYIN$->FO$DKEYIN.TNAME = FOMI_SCTNAME#
     1079    11835    5                       AND DEV$->FO$DEV.TNAME = 'LOCAL') THEN
     1080    11836                                      /* Example of TYP-NUM would be LP01 */
     1081    11837    5                        IF DEVNAMER.TYP = ' '

  11837  9 000715   000022 220000 1                  LDX0    DEVNAME
         9 000716   040040 100003                    CMPX0   16416,DU
         9 000717   000726 600000 9                  TZE     s:11842
         9 000720   000005 100100                    CMPX0   5,,PR0
         9 000721   001243 601000 9                  TNZ     s:11946
         9 000722   000022 236000 1                  LDQ     DEVNAME
         9 000723   000005 676100                    ERQ     5,,PR0
         9 000724   777777 376007                    ANQ     -1,DL
         9 000725   001243 601000 9                  TNZ     s:11946

     1082    11838    5                        OR (DEVNAMER.TYP = DEV$->FO$DEV.NAMER.TYP
     1083    11839    5                        AND DEVNAMER.NUM = DEV$->FO$DEV.NAMER.NUM) THEN
     1084    11840    6                          DO;

     1085    11841                                /* FOUND IT OR ONE OF 'EM */
     1086    11842    6                          NDEV=NDEV+1;

  11842  9 000726   200074 235100                    LDA     NDEV,,AUTO
         9 000727   000001 035007                    ADLA    1,DL
         9 000730   200074 755100                    STA     NDEV,,AUTO

     1087    11843    6                          OPMSG_DINFO.DEVNM=DEV$->FO$DEV.NAME;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:114  

  11843  9 000731   040000 100500                    MLR     fill='040'O
         9 000732   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         9 000733   000053 000010 1                  ADSC9   OPMSG_DINFO+3            cn=0,n=8

     1088    11844    6                          OPMSG_DINFO.STATE=DEV$->FO$DEV.STATE;

  11844  9 000734   000011 236100                    LDQ     9,,PR0
         9 000735   000011 772000                    QRL     9
         9 000736   000061 552004 1                  STBQ    OPMSG_DINFO+9,'04'O

     1089    11845    6                          OPMSG_DINFO.SIP=BITBIN(DEV$->FO$DEV.FLG.SIP);

  11845  9 000737   000012 236100                    LDQ     10,,PR0
         9 000740   000002 772000                    QRL     2
         9 000741   000001 376007                    ANQ     1,DL
         9 000742   000033 736000                    QLS     27
         9 000743   000062 552040 1                  STBQ    OPMSG_DINFO+10,'40'O

     1090    11846                                      /* See if device is restricted to an
     1091    11847                                         account, and set bit accordingly */
     1092    11848    7                          IF DEV$->FO$DEV.RACCT = ' ' THEN DO;

  11848  9 000744   040000 106500                    CMPC    fill='040'O
         9 000745   000020 200010                    ADSC9   16,,PR0                  cn=1,n=8
         9 000746   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 000747   000754 601000 9                  TNZ     s:11854

     1093    11849    7                            OPMSG_DINFO.RESTRICT=0;

  11849  9 000750   000000 236003                    LDQ     0,DU
         9 000751   000072 552004 1                  STBQ    OPMSG_DINFO+18,'04'O

     1094    11850    7                            OPMSG_DINFO.RESTRICTW=0;

  11850  9 000752   000075 552040 1                  STBQ    OPMSG_DINFO+21,'40'O

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:115  
     1095    11851    7                            END;

  11851  9 000753   000776 710000 9                  TRA     s:11867

     1096    11852    6                          ELSE
     1097    11853    7                            DO;

     1098    11854    7                            IF DEV$->FO$DEV.RACCTL ~= 0

  11854  9 000754   000014 236100                    LDQ     12,,PR0
         9 000755   777000 316007                    CANQ    -512,DL
         9 000756   000767 600000 9                  TZE     s:11862

     1099    11855    8                            THEN DO;

     1100    11856    8                              OPMSG_DINFO.RESTRICT=1;

  11856  9 000757   000001 236007                    LDQ     1,DL
         9 000760   000072 552004 1                  STBQ    OPMSG_DINFO+18,'04'O

     1101    11857    8                              OPMSG_DINFO.RACCT=DEV$->FO$DEV.RACCT;

  11857  9 000761   040000 100500                    MLR     fill='040'O
         9 000762   000020 200010                    ADSC9   16,,PR0                  cn=1,n=8
         9 000763   000073 000010 1                  ADSC9   OPMSG_DINFO+19           cn=0,n=8

     1102    11858    8                              OPMSG_DINFO.RESTRICTW=0;

  11858  9 000764   000000 236003                    LDQ     0,DU
         9 000765   000075 552040 1                  STBQ    OPMSG_DINFO+21,'40'O

     1103    11859    8                              END;

  11859  9 000766   000776 710000 9                  TRA     s:11867

     1104    11860    7                            ELSE
     1105    11861    8                              DO;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:116  

     1106    11862    8                              OPMSG_DINFO.RESTRICTW = 1;

  11862  9 000767   001000 236003                    LDQ     512,DU
         9 000770   000075 552040 1                  STBQ    OPMSG_DINFO+21,'40'O

     1107    11863    8                              OPMSG_DINFO.RWSN = DEV$ -> FO$DEV.RWSN;

  11863  9 000771   040000 100500                    MLR     fill='040'O
         9 000772   000020 200010                    ADSC9   16,,PR0                  cn=1,n=8
         9 000773   000075 200010 1                  ADSC9   OPMSG_DINFO+21           cn=1,n=8

     1108    11864    8                              OPMSG_DINFO.RESTRICT=0;

  11864  9 000774   000000 236003                    LDQ     0,DU
         9 000775   000072 552004 1                  STBQ    OPMSG_DINFO+18,'04'O

     1109    11865    8                              END;

     1110    11866    7                            END;

     1111    11867    6                          OPMSG_DINFO.LOCK=BITBIN(DEV$->FO$DEV.FLG.LOCK);

  11867  9 000776   000012 236100                    LDQ     10,,PR0
         9 000777   000001 376007                    ANQ     1,DL
         9 001000   000022 736000                    QLS     18
         9 001001   000062 552020 1                  STBQ    OPMSG_DINFO+10,'20'O

     1112    11868    6                          OPMSG_DINFO.SUSRSN=DEV$->FO$DEV.SUSRSN;

  11868  9 001002   000011 236100                    LDQ     9,,PR0
         9 001003   000011 736000                    QLS     9
         9 001004   000065 552010 1                  STBQ    OPMSG_DINFO+13,'10'O

     1113    11869    6                          OPMSG_DINFO.FORM=DEV$->FO$DEV.FORM;

  11869  9 001005   040000 100500                    MLR     fill='040'O
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:117  
         9 001006   000015 600006                    ADSC9   13,,PR0                  cn=3,n=6
         9 001007   000065 600006 1                  ADSC9   OPMSG_DINFO+13           cn=3,n=6

     1114    11870    6                          OPMSG_DINFO.ALG=BITBIN(DEV$->FO$DEV.FLG.ALGNED);

  11870  9 001010   000012 236100                    LDQ     10,,PR0
         9 001011   000013 772000                    QRL     11
         9 001012   000001 376007                    ANQ     1,DL
         9 001013   000022 736000                    QLS     18
         9 001014   000070 552020 1                  STBQ    OPMSG_DINFO+16,'20'O

     1115    11871    6                          OPMSG_DINFO.GRANS=0;

  11871  9 001015   000000 100400                    MLR     fill='000'O
         9 001016   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         9 001017   000067 200004 1                  ADSC9   OPMSG_DINFO+15           cn=1,n=4

     1116    11872    6                          OPMSG_DINFO.PAGES=0;

  11872  9 001020   000000 100400                    MLR     fill='000'O
         9 001021   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         9 001022   000077 400004 1                  ADSC9   OPMSG_DINFO+23           cn=2,n=4

     1117    11873    6                          IF DEV$->FO$DEV.STATE = FOS_BUSY# THEN

  11873  9 001023   000011 236100                    LDQ     9,,PR0
         9 001024   777000 376007                    ANQ     -512,DL
         9 001025   001000 116007                    CMPQ    512,DL
         9 001026   001077 601000 9                  TNZ     KEYIN11

     1118    11874    7                            DO;

     1119    11875    7                            KDEVNAME=DEV$->FO$DEV.NAME;

  11875  9 001027   040000 100500                    MLR     fill='040'O
         9 001030   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         9 001031   000006 000010 1                  ADSC9   KDEVNAME                 cn=0,n=8
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:118  

     1120    11876    7                            CALL M$SYMBIO (INFO_SYMB) ALTRET(KEYIN11);

  11876  9 001032   000362 630400 1                  EPPR0   INFO_SYMB
         9 001033   570000 713400                    CLIMB   alt,+61440
         9 001034   403400 401760                    pmme    nvectors=8
         9 001035   001077 702000 9                  TSX2    KEYIN11

     1121    11877    7                            BLK#=INFO_SYMB.V.BLKREC.BLK#;

  11877  9 001036   000412 235000 1                  LDA     INFO_SYMB+24
         9 001037   000022 771000                    ARL     18
         9 001040   200100 755100                    STA     BLK#,,AUTO

     1122    11878    7                            BLK#=DEV$->FO$DEV.CFIL$->FO$FIL.GRANS-BLK#;

  11878  9 001041   000000 470400 xsym               LDP0    FO_DEV$
         9 001042   000002 471500                    LDP1    2,,PR0
         9 001043   100015 236100                    LDQ     13,,PR1
         9 001044   000022 772000                    QRL     18
         9 001045   200100 136100                    SBLQ    BLK#,,AUTO
         9 001046   200100 756100                    STQ     BLK#,,AUTO

     1123    11879    7                            IF BLK#R > 0 THEN

  11879  9 001047   200100 235100                    LDA     BLK#,,AUTO
         9 001050   001054 604400 9                  TMOZ    s:11881

     1124    11880    7                             OPMSG_DINFO.GRANS=BLK#;

  11880  9 001051   000000 100500                    MLR     fill='000'O
         9 001052   200100 000004                    ADSC9   BLK#,,AUTO               cn=0,n=4
         9 001053   000067 200004 1                  ADSC9   OPMSG_DINFO+15           cn=1,n=4

     1125    11881    7                            PG# = INFO_SYMB.V.PGDONE#;

  11881  9 001054   000413 235000 1                  LDA     INFO_SYMB+25
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:119  
         9 001055   200101 755100                    STA     PG#,,AUTO

     1126    11882    7                            PG# = DEV$ -> FO$DEV.CFIL$ -> FO$FIL.PAGES

  11882  9 001056   000002 471500                    LDP1    2,,PR0
         9 001057   100023 236100                    LDQ     19,,PR1
         9 001060   200101 136100                    SBLQ    PG#,,AUTO
         9 001061   200101 756100                    STQ     PG#,,AUTO

     1127    11883    7                            - PG#;
     1128    11884    7                            IF PG# > 0

  11884  9 001062   001066 600000 9                  TZE     s:11887

     1129    11885    7                            THEN
     1130    11886    7                             OPMSG_DINFO.PAGES=PG#;

  11886  9 001063   000000 100500                    MLR     fill='000'O
         9 001064   200101 000004                    ADSC9   PG#,,AUTO                cn=0,n=4
         9 001065   000077 400004 1                  ADSC9   OPMSG_DINFO+23           cn=2,n=4

     1131    11887    7                            IF DEV$ -> FO$DEV.CFIL$ -> FO$FIL.FLG.PAGES THEN

  11887  9 001066   000002 471500                    LDP1    2,,PR0
         9 001067   100015 236100                    LDQ     13,,PR1
         9 001070   000200 316007                    CANQ    128,DL
         9 001071   001075 600000 9                  TZE     s:11890

     1132    11888    7                             OPMSG_DINFO.PAGES_OR_RECS = 0;

  11888  9 001072   000000 236003                    LDQ     0,DU
         9 001073   000100 552010 1                  STBQ    OPMSG_DINFO+24,'10'O
         9 001074   001077 710000 9                  TRA     KEYIN11

     1133    11889    7                            ELSE
     1134    11890    7                             OPMSG_DINFO.PAGES_OR_RECS = 1;

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:120  
  11890  9 001075   001000 236007                    LDQ     512,DL
         9 001076   000100 552010 1                  STBQ    OPMSG_DINFO+24,'10'O

     1135    11891    7                            END;

  11887  9 001077                       KEYIN11      null
     1136    11892    6   KEYIN11:               ;
     1137    11893    6                          IF DEV$->FO$DEV.CFIL$ ~= ADDR(NIL) THEN

  11893  9 001077   000000 470400 xsym               LDP0    FO_DEV$
         9 001100   000002 236100                    LDQ     2,,PR0
         9 001101   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 001102   001122 600000 9                  TZE     s:11902

     1138    11894    7                            DO;

     1139    11895    7                            FIL$=DEV$->FO$DEV.CFIL$;

  11895  9 001103   000000 756000 xsym               STQ     FO_FIL$

     1140    11896    7                            OPMSG_DINFO.FSYSID=FIL$->FO$FIL.SYSID;

  11896  9 001104   000000 471400 xsym               LDP1    FO_FIL$
         9 001105   100012 220100                    LDX0    10,,PR1
         9 001106   000062 440000 1                  SXL0    OPMSG_DINFO+10

     1141    11897    7                            OPMSG_DINFO.FNUM=FIL$->FO$FIL.NUM;

  11897  9 001107   100012 721100                    LXL1    10,,PR1
         9 001110   000063 741000 1                  STX1    OPMSG_DINFO+11

     1142    11898    7                            OPMSG_DINFO.ACCT=FIL$->FO$FIL.OJOB$->FO$JOB.ACCT;

  11898  9 001111   100003 473500                    LDP3    3,,PR1
         9 001112   040000 100500                    MLR     fill='040'O
         9 001113   300004 000010                    ADSC9   4,,PR3                   cn=0,n=8
         9 001114   000063 400010 1                  ADSC9   OPMSG_DINFO+11           cn=2,n=8
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:121  

     1143    11899    7                            OPMSG_DINFO.CONCUR = BITBIN(FIL$->FO$FIL.FLG.CONCUR);

  11899  9 001115   100015 236100                    LDQ     13,,PR1
         9 001116   000012 772000                    QRL     10
         9 001117   000001 376007                    ANQ     1,DL
         9 001120   000022 736000                    QLS     18
         9 001121   000077 552020 1                  STBQ    OPMSG_DINFO+23,'20'O

     1144    11900    7                            END;

     1145    11901
     1146    11902    6                          CALL M$WRITE (OCMSG_DINFO);

  11902  9 001122   000614 630400 2                  EPPR0   OCMSG_DINFO
         9 001123   040001 713400                    CLIMB   write
         9 001124   401400 401760                    pmme    nvectors=4

     1147    11903    6                          IF KEYIN$ -> FO$DKEYIN.KIN# = KEY_SYMBOR#

  11903  9 001125   200016 470500                    LDP0    KEYIN$,,AUTO
         9 001126   000000 220100                    LDX0    0,,PR0
         9 001127   000035 100003                    CMPX0   29,DU
         9 001130   001133 600000 9                  TZE     s:11906
         9 001131   000036 100003                    CMPX0   30,DU
         9 001132   001215 601000 9                  TNZ     s:11934

     1148    11904    6                          OR KEYIN$ -> FO$DKEYIN.KIN# = KEY_SYMBOTERMR#
     1149    11905    7                          THEN DO;

     1150    11906    7                            WSN$ = DEV$ -> FO$DEV.WSN$;

  11906  9 001133   000000 471400 xsym               LDP1    FO_DEV$
         9 001134   100004 236100                    LDQ     4,,PR1
         9 001135   200006 756100                    STQ     WSN$,,AUTO

     1151    11907    8                              DO WHILE (WSN$ ~= ADDR(NIL));
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:122  

  11907  9 001136   001213 710000 9                  TRA     s:11931

     1152    11908    9                                DO I = 0 TO (WSN$ -> FO$WSN.NWSNS - 1);

  11908  9 001137   200004 450100                    STZ     I,,AUTO
         9 001140   001205 710000 9                  TRA     s:11929+3

     1153    11909    9                                IF WSN$ -> FO$WSN.WSN.NOT_USED(I) = '0'B

  11909  9 001141   200004 236100                    LDQ     I,,AUTO
         9 001142   000121 402007                    MPY     81,DL
         9 001143   200006 470500                    LDP0    WSN$,,AUTO
         9 001144   000000 066506                    CMPB    filb='0'B
         9 001145   000004 060001                    BDSC    4,Q,PR0                  by=0,bit=6,n=1
         9 001146   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 001147   001202 601000 9                  TNZ     s:11929

     1154    11910   10                                THEN DO;

     1155    11911   10                                 OPMSG_RINFO.WSN_NAME = WSN$ -> FO$WSN.WSN.WSN_NAME(I)
             11911                                           ;

  11911  9 001150   200004 236100                    LDQ     I,,AUTO
         9 001151   000011 402007                    MPY     9,DL
         9 001152   040000 100506                    MLR     fill='040'O
         9 001153   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         9 001154   000106 600010 1                  ADSC9   OPMSG_RINFO+5            cn=3,n=8

     1156    11912   10                                  IF WSN$ -> FO$WSN.WSN.ORIGINAL(I) = '1'B

  11912  9 001155   200004 236100                    LDQ     I,,AUTO
         9 001156   000121 402007                    MPY     81,DL
         9 001157   000000 066506                    CMPB    filb='0'B
         9 001160   000004 050001                    BDSC    4,Q,PR0                  by=0,bit=5,n=1
         9 001161   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 001162   001175 600000 9                  TZE     s:11925
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:123  

     1157    11913   11                                  THEN DO;

     1158    11914   11                                    IF WSN$ -> FO$WSN.WSN.ROUTED_OUT(I) = '0'B

  11914  9 001163   000000 066506                    CMPB    filb='0'B
         9 001164   000004 070001                    BDSC    4,Q,PR0                  by=0,bit=7,n=1
         9 001165   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 001166   001172 601000 9                  TNZ     s:11920

     1159    11915   12                                    THEN DO;

     1160    11916   12                                      OPMSG_RINFO.STATUS = %FOTC_RTOR#; /* ORIGINAL */

  11916  9 001167   000000 236003                    LDQ     0,DU
         9 001170   000106 552010 1                  STBQ    OPMSG_RINFO+5,'10'O

     1161    11917   12                                      END;

  11917  9 001171   001177 710000 9                  TRA     s:11927

     1162    11918   11                                    ELSE
     1163    11919   12                                      DO;

     1164    11920   12                                      OPMSG_RINFO.STATUS = %FOTC_RTOT#;
             11920                                               /* ORIGINAL ROUTED OUT */

  11920  9 001172   001000 236007                    LDQ     512,DL
         9 001173   000106 552010 1                  STBQ    OPMSG_RINFO+5,'10'O

     1165    11921   12                                      END;

     1166    11922   11                                    END;

  11922  9 001174   001177 710000 9                  TRA     s:11927

     1167    11923   10                                  ELSE              /* Not original */
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:124  
     1168    11924   11                                    DO;

     1169    11925   11                                    OPMSG_RINFO.STATUS = %FOTC_RTAD#; /* ADD_ON */

  11925  9 001175   002000 236007                    LDQ     1024,DL
         9 001176   000106 552010 1                  STBQ    OPMSG_RINFO+5,'10'O

     1170    11926   11                                    END;

     1171    11927   10                                  CALL M$WRITE (OCMSG_RINFO);

  11927  9 001177   000550 630400 2                  EPPR0   OCMSG_RINFO
         9 001200   040001 713400                    CLIMB   write
         9 001201   401400 401760                    pmme    nvectors=4

     1172    11928   10                                  END;

     1173    11929    9                                END;

  11929  9 001202   200004 235100                    LDA     I,,AUTO
         9 001203   000001 035007                    ADLA    1,DL
         9 001204   200004 755100                    STA     I,,AUTO
         9 001205   200006 470500                    LDP0    WSN$,,AUTO
         9 001206   200004 236100                    LDQ     I,,AUTO
         9 001207   000001 116100                    CMPQ    1,,PR0
         9 001210   001141 602000 9                  TNC     s:11909

     1174    11930    8                              WSN$ = WSN$ -> FO$WSN.LNK$;

  11930  9 001211   000000 236100                    LDQ     0,,PR0
         9 001212   200006 756100                    STQ     WSN$,,AUTO

     1175    11931    8                              END;

  11931  9 001213   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 001214   001137 601000 9                  TNZ     s:11908

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:125  
     1176    11932    7                            END;

     1177    11933
     1178    11934    6                          IF KEYIN$ -> FO$DKEYIN.KIN# = KEY_SYMBOT#

  11934  9 001215   200016 470500                    LDP0    KEYIN$,,AUTO
         9 001216   000000 220100                    LDX0    0,,PR0
         9 001217   000040 100003                    CMPX0   32,DU
         9 001220   001223 600000 9                  TZE     s:11937
         9 001221   000041 100003                    CMPX0   33,DU
         9 001222   001243 601000 9                  TNZ     s:11946

     1179    11935    6                          OR KEYIN$ -> FO$DKEYIN.KIN# = KEY_SYMBOTERMT#
     1180    11936    7                          THEN DO;

     1181    11937    7                            THROTTLE_UTS = INFO_SYMB.V.THROTTLE_TIME#;

  11937  9 001223   000414 235000 1                  LDA     INFO_SYMB+26
         9 001224   000137 755000 1                  STA     THROTTLE_UTS

     1182    11938    7                            CALL M$TIME (THROTTLE_TIME)

  11938  9 001225   000530 630400 1                  EPPR0   THROTTLE_TIME
         9 001226   420004 713400                    CLIMB   alt,+8196
         9 001227   402000 401760                    pmme    nvectors=5
         9 001230   001232 702000 9                  TSX2    s:11941
         9 001231   001232 710000 9                  TRA     s:11941

     1183    11939    8                            WHENALTRETURN DO;

     1184    11940    8                              END;

     1185    11941    7                            OPMSG_TINFO.TIME = TTIME.TIME;

  11941  9 001232   040000 100400                    MLR     fill='040'O
         9 001233   000143 200013 1                  ADSC9   TTIME+3                  cn=1,n=11
         9 001234   000117 400013 1                  ADSC9   OPMSG_TINFO+6            cn=2,n=11
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:126  

     1186    11942    7                            OPMSG_TINFO.CNT = INFO_SYMB.V.THROTTLE_CNT#;

  11942  9 001235   000000 100400                    MLR     fill='000'O
         9 001236   000415 000004 1                  ADSC9   INFO_SYMB+27             cn=0,n=4
         9 001237   000116 400004 1                  ADSC9   OPMSG_TINFO+5            cn=2,n=4

     1187    11943    7                            CALL M$WRITE (OCMSG_TINFO);

  11943  9 001240   000564 630400 2                  EPPR0   OCMSG_TINFO
         9 001241   040001 713400                    CLIMB   write
         9 001242   401400 401760                    pmme    nvectors=4

     1188    11944    7                            END;

     1189    11945    6                          END;

     1190    11946    5                       DEV$=DEV$->FO$DEV.LNK$;

  11946  9 001243   000000 470400 xsym               LDP0    FO_DEV$
         9 001244   000000 236100                    LDQ     0,,PR0
         9 001245   000000 756000 xsym               STQ     FO_DEV$

     1191    11947    5                       END;

  11947  9 001246   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 001247   000677 601000 9                  TNZ     s:11833

     1192    11948                                /* MESSAGE IF NONE FOUND */
     1193    11949    4                     IF NDEV ~= 0 THEN GOTO ENDEVENT;

  11949  9 001250   200074 235100                    LDA     NDEV,,AUTO
         9 001251   001664 601000 9                  TNZ     ENDEVENT

     1194    11950    4                     IF KEYIN$->FO$DKEYIN.KIN# = KEY_SYMBO# THEN

  11950  9 001252   200016 470500                    LDP0    KEYIN$,,AUTO
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:127  
         9 001253   000000 220100                    LDX0    0,,PR0
         9 001254   000014 100003                    CMPX0   12,DU
         9 001255   001261 601000 9                  TNZ     s:11954

     1195    11951    4                      OPMSG_KERR.SUBC1=0;

  11951  9 001256   000000 236003                    LDQ     0,DU
         9 001257   000032 552040 1                  STBQ    OPMSG_KERR+6,'40'O
         9 001260   001266 710000 9                  TRA     s:11957

     1196    11952    4                     ELSE
     1197    11953    5                       DO;

     1198    11954    5                       OPMSG_KERR.SUBC1=1;

  11954  9 001261   001000 236003                    LDQ     512,DU
         9 001262   000032 552040 1                  STBQ    OPMSG_KERR+6,'40'O

     1199    11955    5                       OPMSG_KERR.TNAME=KEYIN$->FO$DKEYIN.TNAME;

  11955  9 001263   040000 100500                    MLR     fill='040'O
         9 001264   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         9 001265   000032 200010 1                  ADSC9   OPMSG_KERR+6             cn=1,n=8

     1200    11956    5                       END;

     1201    11957    4                     IF DEVNAMER.TYP ~= ' '

  11957  9 001266   000022 220000 1                  LDX0    DEVNAME
         9 001267   040040 100003                    CMPX0   16416,DU
         9 001270   000613 601000 9                  TNZ     KEYIN001

     1202    11958    4                     THEN
     1203    11959    4                      GOTO KEYIN001;
     1204    11960    4                     OPMSG_KERR.SUBC=FOKE_NSDEV#;

  11960  9 001271   000000 236003                    LDQ     0,DU
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:128  
         9 001272   000031 552004 1                  STBQ    OPMSG_KERR+5,'04'O

     1205    11961    4                     OPMSG_KERR.MSG#=FO_KERR1_MSG#;

  11961  9 001273   000201 221003                    LDX1    129,DU
         9 001274   000024 441000 1                  SXL1    OPMSG_KERR

     1206    11962    4                     GOTO KEYIN01;

  11962  9 001275   000617 710000 9                  TRA     KEYIN01

     1207    11963        /**
     1208    11964         **
     1209    11965         ** FORMS KEYINS
     1210    11966         **
     1211    11967         **/
     1212    11968                                      /* SETUP requests a display of how to
     1213    11969                                         mount a specified form.  FORM re-
     1214    11970                                         quests a form mount on a symbiont
     1215    11971                                         device (if VFU image requires align,
     1216    11972                                         so be it). */
     1217    11973    4                   CASE (KEY_SETUP#,KEY_FORM#);

     1218    11974    4                     DEVNAME=KEYIN$->FO$DKEYIN.DEVNM;

  11974  9 001276   040000 100500                    MLR     fill='040'O
         9 001277   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         9 001300   000022 000010 1                  ADSC9   DEVNAME                  cn=0,n=8

     1219    11975    4                     CALL FIND_DEV ALTRET(KEYIN2);

  11975  9 001301   002636 701000 9                  TSX1    FIND_DEV
         9 001302   001304 702000 9                  TSX2    KEYIN2

     1220    11976    4                     GOTO KEYIN21;

  11976  9 001303   001306 710000 9                  TRA     KEYIN21
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:129  

     1221    11977    4   KEYIN2:           DEV$=ADDR(NIL);

  11977  9 001304   000001 236000 xsym  KEYIN2       LDQ     B_VECTNIL+1
         9 001305   000000 756000 xsym               STQ     FO_DEV$

  11974  9 001306                       KEYIN21      null
     1222    11978    4   KEYIN21:          ;
     1223    11979    4                     CALL FOR$KEYIN (,,KEYIN$);

  11979  9 001306   200016 630500                    EPPR0   KEYIN$,,AUTO
         9 001307   200114 450500                    STP0    OSFNAME+7,,AUTO
         9 001310   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 001311   000001 235000 xsym               LDA     B_VECTNIL+1
         9 001312   200112 757100                    STAQ    OSFNAME+5,,AUTO
         9 001313   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 001314   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001315   000000 701000 xent               TSX1    FOR$KEYIN
         9 001316   000000 011000                    NOP     0

     1224    11980    4                     GOTO DEVSCHED;

  11980  9 001317   000472 710000 9                  TRA     DEVSCHED

     1225    11981        /**
     1226    11982         **
     1227    11983         ** ZAP KEYIN
     1228    11984         **
     1229    11985         **/
     1230    11986    4                   CASE (KEY_ZAP#);

     1231    11987    4                     GOODNGT=1;

  11987  9 001320   000001 235007                    LDA     1,DL
         9 001321   000002 755000 1                  STA     GOODNGT

     1232    11988    4                     TIMEASLEEP=0;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:130  

  11988  9 001322   000003 450000 1                  STZ     TIMEASLEEP

     1233    11989    4                     DEV$=FO_Q.DEVHD$;

  11989  9 001323   000002 236000 xsym               LDQ     FO_Q+2
         9 001324   000000 756000 xsym               STQ     FO_DEV$

     1234    11990    5                       DO WHILE (DEV$ ~= ADDR(NIL));

  11990  9 001325   001370 710000 9                  TRA     s:12002

     1235    11991    5                       IF DEV$->FO$DEV.FLG.LOCK = '0'B THEN

  11991  9 001326   000000 470400 xsym               LDP0    FO_DEV$
         9 001327   000012 236100                    LDQ     10,,PR0
         9 001330   000001 316007                    CANQ    1,DL
         9 001331   001347 601000 9                  TNZ     s:11996

     1236    11992    6                         DO;

     1237    11993    6                         LOCKKEYIN.DEVNM=DEV$->FO$DEV.NAME;

  11993  9 001332   040000 100500                    MLR     fill='040'O
         9 001333   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         9 001334   000011 000010 1                  ADSC9   LOCKKEYIN+1              cn=0,n=8

     1238    11994    6                         CALL FOD$EVENT (FODE_KEYN#,ADDR(LOCKKEYIN));

  11994  9 001335   000016 236000 10                 LDQ     14
         9 001336   200112 756100                    STQ     OSFNAME+5,,AUTO
         9 001337   200112 631500                    EPPR1   OSFNAME+5,,AUTO
         9 001340   200115 451500                    STP1    OSFNAME+8,,AUTO
         9 001341   000015 236000 10                 LDQ     13
         9 001342   200114 756100                    STQ     OSFNAME+7,,AUTO
         9 001343   200114 630500                    EPPR0   OSFNAME+7,,AUTO
         9 001344   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:131  
         9 001345   000000 701000 xent               TSX1    FOD$EVENT
         9 001346   000000 011000                    NOP     0

     1239    11995    6                         END;

     1240    11996    5                       IF DEV$->FO$DEV.STATE ~= FOS_IDLE#

  11996  9 001347   000000 470400 xsym               LDP0    FO_DEV$
         9 001350   000011 236100                    LDQ     9,,PR0
         9 001351   777000 316007                    CANQ    -512,DL
         9 001352   001363 600000 9                  TZE     s:12000
         9 001353   000011 236100                    LDQ     9,,PR0
         9 001354   777000 376007                    ANQ     -512,DL
         9 001355   004000 116007                    CMPQ    2048,DL
         9 001356   001363 600000 9                  TZE     s:12000

     1241    11997    5                       AND DEV$->FO$DEV.STATE ~= FOS_IALN#
     1242    11998    5                       THEN
     1243    11999    5                        CALL FOD$EVENT (FODE_QUIT#,FOQR_KZAP#);

  11999  9 001357   000020 630400 10                 EPPR0   16
         9 001360   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001361   000000 701000 xent               TSX1    FOD$EVENT
         9 001362   000000 011000                    NOP     0

     1244    12000    5                       DEV$->FO$DEV.STATE = FOS_IDLE#; /* ALLOW ZAP TO PROCEED */

  12000  9 001363   000000 470400 xsym               LDP0    FO_DEV$
         9 001364   000000 236003                    LDQ     0,DU
         9 001365   000011 552110                    STBQ    9,'10'O,PR0

     1245    12001    5                       DEV$=DEV$->FO$DEV.LNK$;

  12001  9 001366   000000 236100                    LDQ     0,,PR0
         9 001367   000000 756000 xsym               STQ     FO_DEV$

     1246    12002    5                       END;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:132  

  12002  9 001370   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 001371   001326 601000 9                  TNZ     s:11991
         9 001372   001664 710000 9                  TRA     ENDEVENT

     1247    12003
     1248    12004        /**
     1249    12005         **
     1250    12006         ** UNKNOWN
     1251    12007         **
     1252    12008         **/
     1253    12009    4                   CASE (ELSE);

     1254    12010    4                     OPMSG_UNIMP.CADDR=KEYIN$->FO$DKEYIN.CADDR;

  12010  9 001373   100000 722100                    LXL2    0,,PR1
         9 001374   000043 742000 1                  STX2    OPMSG_UNIMP

     1255    12011    4                     CALL M$WRITE (OCMSG_UNIMP);

  12011  9 001375   000630 630400 2                  EPPR0   OCMSG_UNIMP
         9 001376   040001 713400                    CLIMB   write
         9 001377   401400 401760                    pmme    nvectors=4

     1256    12012    4                 END; /* CASE KIN# */

  12012  9 001400   001664 710000 9                  TRA     ENDEVENT

     1257    12013        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:133  
     1258    12014        /***
     1259    12015         ***
     1260    12016         ***
     1261    12017         ***          SYSTEM OPEN FOR BUSINESS
     1262    12018         ***
     1263    12019         ***
     1264    12020         ***/
     1265    12021    3             CASE (FOEV_OPFB#);

     1266    12022                          /*    This event is sent to us
     1267    12023                           *    when the system is open
     1268    12024                           *    for business.  It causes
     1269    12025                           *    us to start all printers
     1270    12026                           *    and allow file adds to
     1271    12027                           *    start 'em.
     1272    12028                           */
     1273    12029    3               NOSTART=NOSTART-1;

  12029  9 001401   000001 336007                    LCQ     1,DL
         9 001402   000000 056000 1                  ASQ     NOSTART

     1274    12030    3               CALL DRIVE_DEVS;

  12030  9 001403   002657 701000 9                  TSX1    DRIVE_DEVS
         9 001404   000000 011000                    NOP     0
         9 001405   001664 710000 9                  TRA     ENDEVENT

     1275    12031        /**
     1276    12032         **
     1277    12033         ** BATCH JOB OFF EVENT
     1278    12034         **
     1279    12035         **/
     1280    12036    3             CASE (FOEV_JOFF#);

     1281    12037    3               JOB_SYSID = CITE$->FO$JOBEV.SYSID;

  12037  9 001406   200077 471500                    LDP1    CITE$,,AUTO
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:134  
         9 001407   100000 236100                    LDQ     0,,PR1
         9 001410   777777 376007                    ANQ     -1,DL
         9 001411   200027 756100                    STQ     JOB_SYSID,,AUTO

     1282    12038    3               CALL FOF$FINDJOB(JOB_SYSID) ALTRET(ENDEVENT);

  12038  9 001412   200027 633500                    EPPR3   JOB_SYSID,,AUTO
         9 001413   200112 453500                    STP3    OSFNAME+5,,AUTO
         9 001414   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 001415   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001416   000000 701000 xent               TSX1    FOF$FINDJOB
         9 001417   001664 702000 9                  TSX2    ENDEVENT

     1283    12039    3               JOB$->FO$JOB.FLG.JOFF = '1'B;

  12039  9 001420   000000 470400 xsym               LDP0    FO_JOB$
         9 001421   400000 236003                    LDQ     -131072,DU
         9 001422   000003 256100                    ORSQ    3,,PR0

     1284    12040    3               IF JOB$->FO$JOB.NFIL = JOB$->FO$JOB.NFIL_DONE THEN CALL FOF$COMPJOB;

  12040  9 001423   000002 236100                    LDQ     2,,PR0
         9 001424   000003 676100                    ERQ     3,,PR0
         9 001425   777777 376007                    ANQ     -1,DL
         9 001426   001664 601000 9                  TNZ     ENDEVENT

  12040  9 001427   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 001430   000000 701000 xent               TSX1    FOF$COMPJOB
         9 001431   000000 011000                    NOP     0
         9 001432   001664 710000 9                  TRA     ENDEVENT

     1285    12041        /**
     1286    12042         **
     1287    12043         ** CANCEL COMMAND (FROM USER)
     1288    12044         **
     1289    12045         **/
     1290    12046    3             CASE (FOEV_CNCL#);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:135  

     1291    12047    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;

  12047  9 001433   200077 471500                    LDP1    CITE$,,AUTO
         9 001434   100000 236100                    LDQ     0,,PR1
         9 001435   777777 376007                    ANQ     -1,DL
         9 001436   200023 756100                    STQ     FIL_SYSID,,AUTO

     1292    12048    3               BATCHFLG=CITE$->FO$JOBEV.BATCH;

  12048  9 001437   100001 236100                    LDQ     1,,PR1
         9 001440   000022 772000                    QRL     18
         9 001441   200017 756100                    STQ     BATCHFLG,,AUTO

     1293    12049    3               FIL_NUMR=CITE$->FO$JOBEV.NUMR;

  12049  9 001442   100001 236100                    LDQ     1,,PR1
         9 001443   000022 736000                    QLS     18
         9 001444   000022 732000                    QRS     18
         9 001445   200024 756100                    STQ     FIL_NUM,,AUTO

     1294    12050    3               CALL FOF$CANCEL (FIL_SYSID,FIL_NUM,BATCHFLG);

  12050  9 001446   200017 633500                    EPPR3   BATCHFLG,,AUTO
         9 001447   200114 453500                    STP3    OSFNAME+7,,AUTO
         9 001450   200024 634500                    EPPR4   FIL_NUM,,AUTO
         9 001451   200113 454500                    STP4    OSFNAME+6,,AUTO
         9 001452   200023 635500                    EPPR5   FIL_SYSID,,AUTO
         9 001453   200112 455500                    STP5    OSFNAME+5,,AUTO
         9 001454   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 001455   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001456   000000 701000 xent               TSX1    FOF$CANCEL
         9 001457   000000 011000                    NOP     0
         9 001460   001664 710000 9                  TRA     ENDEVENT

     1295    12051        /**
     1296    12052         **
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:136  
     1297    12053         ** SPILLDONE (FROM EFT)
     1298    12054         **
     1299    12055         **/
     1300    12056    3             CASE (FOEV_SPLD#);

     1301    12057    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;

  12057  9 001461   200077 471500                    LDP1    CITE$,,AUTO
         9 001462   100000 236100                    LDQ     0,,PR1
         9 001463   777777 376007                    ANQ     -1,DL
         9 001464   200023 756100                    STQ     FIL_SYSID,,AUTO

     1302    12058    3               FIL_NUM=CITE$->FO$JOBEV.NUM;

  12058  9 001465   100001 236100                    LDQ     1,,PR1
         9 001466   777777 376007                    ANQ     -1,DL
         9 001467   200024 756100                    STQ     FIL_NUM,,AUTO

     1303    12059    3               SPILLDISP=CITE$->FO$JOBEV.DISP;

  12059  9 001470   100001 236100                    LDQ     1,,PR1
         9 001471   000022 772000                    QRL     18
         9 001472   200031 756100                    STQ     SPILLDISP,,AUTO

     1304    12060    3               CALL FOF$SPILLDONE (FIL_SYSID,FIL_NUM,SPILLDISP);

  12060  9 001473   200031 633500                    EPPR3   SPILLDISP,,AUTO
         9 001474   200114 453500                    STP3    OSFNAME+7,,AUTO
         9 001475   200024 634500                    EPPR4   FIL_NUM,,AUTO
         9 001476   200113 454500                    STP4    OSFNAME+6,,AUTO
         9 001477   200023 635500                    EPPR5   FIL_SYSID,,AUTO
         9 001500   200112 455500                    STP5    OSFNAME+5,,AUTO
         9 001501   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 001502   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001503   000000 701000 xent               TSX1    FOF$SPILLDONE
         9 001504   000000 011000                    NOP     0

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:137  
     1305    12061    3               IF SPILLDISP = %FD_REQUEUE# THEN GOTO DEVSCHED;

  12061  9 001505   200031 235100                    LDA     SPILLDISP,,AUTO
         9 001506   000472 600000 9                  TZE     DEVSCHED
         9 001507   001664 710000 9                  TRA     ENDEVENT

     1306    12062        /**
     1307    12063         **
     1308    12064         ** FILL (FROM EFT)
     1309    12065         **
     1310    12066         **/
     1311    12067    3             CASE (FOEV_FILL#);

     1312    12068    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;

  12068  9 001510   200077 471500                    LDP1    CITE$,,AUTO
         9 001511   100000 236100                    LDQ     0,,PR1
         9 001512   777777 376007                    ANQ     -1,DL
         9 001513   200023 756100                    STQ     FIL_SYSID,,AUTO

     1313    12069    3               FIL_NUM=CITE$->FO$JOBEV.NUM;

  12069  9 001514   100001 236100                    LDQ     1,,PR1
         9 001515   777777 376007                    ANQ     -1,DL
         9 001516   200024 756100                    STQ     FIL_NUM,,AUTO

     1314    12070    3               CALL FOF$FILL (FIL_SYSID,FIL_NUM,FIL_CNUM,0,FO_BOOTID);

  12070  9 001517   000013 236000 10                 LDQ     11
         9 001520   200116 756100                    STQ     OSFNAME+9,,AUTO
         9 001521   000014 236000 10                 LDQ     12
         9 001522   200115 756100                    STQ     OSFNAME+8,,AUTO
         9 001523   200025 633500                    EPPR3   FIL_CNUM,,AUTO
         9 001524   200114 453500                    STP3    OSFNAME+7,,AUTO
         9 001525   200024 634500                    EPPR4   FIL_NUM,,AUTO
         9 001526   200113 454500                    STP4    OSFNAME+6,,AUTO
         9 001527   200023 635500                    EPPR5   FIL_SYSID,,AUTO
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:138  
         9 001530   200112 455500                    STP5    OSFNAME+5,,AUTO
         9 001531   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 001532   000023 631400 xsym               EPPR1   B_VECTNIL+19
         9 001533   000000 701000 xent               TSX1    FOF$FILL
         9 001534   000000 011000                    NOP     0
         9 001535   001664 710000 9                  TRA     ENDEVENT

     1315    12071        /**
     1316    12072         **
     1317    12073         ** UNHOLD COMMAND (FROM USER)
     1318    12074         **
     1319    12075         **/
     1320    12076    3             CASE (FOEV_UHLD#);

     1321    12077    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;

  12077  9 001536   200077 471500                    LDP1    CITE$,,AUTO
         9 001537   100000 236100                    LDQ     0,,PR1
         9 001540   777777 376007                    ANQ     -1,DL
         9 001541   200023 756100                    STQ     FIL_SYSID,,AUTO

     1322    12078    3               FIL_NUMR=CITE$->FO$JOBEV.NUMR;        /* Make sure sign transfers */

  12078  9 001542   100001 236100                    LDQ     1,,PR1
         9 001543   000022 736000                    QLS     18
         9 001544   000022 732000                    QRS     18
         9 001545   200024 756100                    STQ     FIL_NUM,,AUTO

     1323    12079    3               CALL FOF$UNHOLD (FIL_SYSID,FIL_NUM);

  12079  9 001546   200024 633500                    EPPR3   FIL_NUM,,AUTO
         9 001547   200113 453500                    STP3    OSFNAME+6,,AUTO
         9 001550   200023 634500                    EPPR4   FIL_SYSID,,AUTO
         9 001551   200112 454500                    STP4    OSFNAME+5,,AUTO
         9 001552   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 001553   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001554   000000 701000 xent               TSX1    FOF$UNHOLD
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:139  
         9 001555   000000 011000                    NOP     0

     1324    12080    3               CALL DRIVE_DEVS;           /* Start these UNHOLDed babies moving! */

  12080  9 001556   002657 701000 9                  TSX1    DRIVE_DEVS
         9 001557   000000 011000                    NOP     0
         9 001560   001664 710000 9                  TRA     ENDEVENT

     1325    12081        /**
     1326    12082         **
     1327    12083         ** CANCEL OUTPUT DUE TO 'RERUN' KEYIN
     1328    12084         **
     1329    12085         **/
     1330    12086    3             CASE (FOEV_RRUN#);

     1331    12087    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;

  12087  9 001561   200077 471500                    LDP1    CITE$,,AUTO
         9 001562   100000 236100                    LDQ     0,,PR1
         9 001563   777777 376007                    ANQ     -1,DL
         9 001564   200023 756100                    STQ     FIL_SYSID,,AUTO

     1332    12088    3               CALL FOF$RERUN (FIL_SYSID,-1,0);

  12088  9 001565   000014 236000 10                 LDQ     12
         9 001566   200114 756100                    STQ     OSFNAME+7,,AUTO
         9 001567   000022 236000 10                 LDQ     18
         9 001570   200113 756100                    STQ     OSFNAME+6,,AUTO
         9 001571   200023 633500                    EPPR3   FIL_SYSID,,AUTO
         9 001572   200112 453500                    STP3    OSFNAME+5,,AUTO
         9 001573   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 001574   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001575   000000 701000 xent               TSX1    FOF$RERUN
         9 001576   000000 011000                    NOP     0
         9 001577   001664 710000 9                  TRA     ENDEVENT

     1333    12089        /**
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:140  
     1334    12090         **
     1335    12091         ** CANCEL OUTPUT OF LIST OF JOBS TO BE RERUN
     1336    12092         **
     1337    12093         **/
     1338    12094    3             CASE (FOEV_MBSI#);

     1339    12095    4                 DO IR = 0 TO CITE$->FO$MBSEV.NJOBS-1;

  12095  9 001600   200004 450100                    STZ     I,,AUTO
         9 001601   001623 710000 9                  TRA     s:12098+1

     1340    12096    4                 FIL_SYSID=CITE$->FO$MBSEV.JOBS(I);

  12096  9 001602   200004 235100                    LDA     I,,AUTO
         9 001603   000001 735000                    ALS     1
         9 001604   200077 470500                    LDP0    CITE$,,AUTO
         9 001605   000100 101505                    MRL     fill='000'O
         9 001606   000002 000002                    ADSC9   2,A,PR0                  cn=0,n=2
         9 001607   200023 000004                    ADSC9   FIL_SYSID,,AUTO          cn=0,n=4

     1341    12097    4                 CALL FOF$RERUN (FIL_SYSID,-1,0);

  12097  9 001610   000014 236000 10                 LDQ     12
         9 001611   200114 756100                    STQ     OSFNAME+7,,AUTO
         9 001612   000022 236000 10                 LDQ     18
         9 001613   200113 756100                    STQ     OSFNAME+6,,AUTO
         9 001614   200023 631500                    EPPR1   FIL_SYSID,,AUTO
         9 001615   200112 451500                    STP1    OSFNAME+5,,AUTO
         9 001616   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 001617   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001620   000000 701000 xent               TSX1    FOF$RERUN
         9 001621   000000 011000                    NOP     0

     1342    12098    4                 END;

  12098  9 001622   200004 054100                    AOS     I,,AUTO
         9 001623   200077 470500                    LDP0    CITE$,,AUTO
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:141  
         9 001624   200004 236100                    LDQ     I,,AUTO
         9 001625   001602 604000 9                  TMI     s:12096
         9 001626   000001 116100                    CMPQ    1,,PR0
         9 001627   001602 602000 9                  TNC     s:12096
         9 001630   001664 710000 9                  TRA     ENDEVENT

     1343    12099        /**
     1344    12100         **
     1345    12101         ** COOP DELETE OF FILE (User said ERASE)
     1346    12102         **
     1347    12103         **/
     1348    12104    3             CASE (FOEV_CDEL#);

     1349    12105    3               FIL_SYSID=CITE$->FO$JOBEV.SYSID;

  12105  9 001631   200077 471500                    LDP1    CITE$,,AUTO
         9 001632   100000 236100                    LDQ     0,,PR1
         9 001633   777777 376007                    ANQ     -1,DL
         9 001634   200023 756100                    STQ     FIL_SYSID,,AUTO

     1350    12106    3               FIL_NUM=CITE$->FO$JOBEV.NUM;

  12106  9 001635   100001 236100                    LDQ     1,,PR1
         9 001636   777777 376007                    ANQ     -1,DL
         9 001637   200024 756100                    STQ     FIL_NUM,,AUTO

     1351    12107    3               CALL FOF$ERASE (FIL_SYSID,FIL_NUM,0);

  12107  9 001640   000014 236000 10                 LDQ     12
         9 001641   200114 756100                    STQ     OSFNAME+7,,AUTO
         9 001642   200024 633500                    EPPR3   FIL_NUM,,AUTO
         9 001643   200113 453500                    STP3    OSFNAME+6,,AUTO
         9 001644   200023 634500                    EPPR4   FIL_SYSID,,AUTO
         9 001645   200112 454500                    STP4    OSFNAME+5,,AUTO
         9 001646   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 001647   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001650   000000 701000 xent               TSX1    FOF$ERASE
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:142  
         9 001651   000000 011000                    NOP     0
         9 001652   001664 710000 9                  TRA     ENDEVENT

     1352    12108        /**
     1353    12109         **
     1354    12110         ** GET MORE SYSIDS (from MONKEY)
     1355    12111         **
     1356    12112         **/
     1357    12113    3             CASE (FOEV_GMSY#);

     1358    12114    3               CALL IGN$SYSID (CITE$->FO$SYEV);

  12114  9 001653   200077 630500                    EPPR0   CITE$,,AUTO
         9 001654   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 001655   000000 701000 xent               TSX1    IGN$SYSID
         9 001656   000000 011000                    NOP     0
         9 001657   001664 710000 9                  TRA     ENDEVENT

     1359    12115        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:143  
     1360    12116        /***
     1361    12117         ***
     1362    12118         ***
     1363    12119         ***          'NOP' EVENT
     1364    12120         ***
     1365    12121         ***
     1366    12122         ***/
     1367    12123
     1368    12124    3             CASE (FOEV_NOP#);

     1369    12125        /***
     1370    12126         ***
     1371    12127         ***
     1372    12128         ***          'ELSE' CASE: UNKNOWN EXTERNAL EVENT CODE FROM FOE$EVNT
     1373    12129         ***
     1374    12130         ***
     1375    12131         ***/
     1376    12132    3             CASE (ELSE);

     1377    12133    3               CALL FOI$CRASHGO (%S$BADEXTEV,F_FO,M_O);

  12133  9 001660   000024 630400 10                 EPPR0   20
         9 001661   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001662   000000 701000 xent               TSX1    FOI$CRASHGO
         9 001663   000000 011000                    NOP     0

     1378    12134        /*S* SCREECH_CODE: FOO-S$BADEXTEV
     1379    12135             TYPE:         SCREECH
     1380    12136             MESSAGE:      OUTSYM - unknown external event code from FOE$EVNT
     1381    12137             REMARKS:      The event queue used to communicate from FOE$EVNT
     1382    12138                           to the OUTSYM main routine contains an event code
     1383    12139                           unknown to OUTSYM.  This can only occur if one
     1384    12140                           of OUTSYM, FOE$EVNT, and the event queue has been
     1385    12141                           clobbered.                                 */
     1386    12142    3           END; /* CASE EVNT.CODE */

     1387    12143                           /* COME HERE AT END OF ALL EVENTS */
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:144  
     1388    12144    2   ENDEVENT:;

  12144  9 001664                       ENDEVENT     null
     1389    12145    2         RETURN;

  12145  9 001664   200104 221300                    LDX1  ! FILE_ADDED+2,,AUTO
         9 001665   000001 702211                    TSX2  ! 1,X1

     1390    12146    2   END EXT_EVENT;
     1391    12147        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:145  
     1392    12148        /*
     1393    12149
     1394    12150
     1395    12151            ####    #####   #   #    ###     ###    #####
     1396    12152            #   #   #       #   #     #     #   #   #
     1397    12153            #   #   #       #   #     #     #       #
     1398    12154            #   #   ####    #   #     #     #       ####
     1399    12155            #   #   #       #   #     #     #       #
     1400    12156            #   #   #        # #      #     #   #   #
     1401    12157            ####    #####     #      ###     ###    #####
     1402    12158
     1403    12159
     1404    12160
     1405    12161
     1406    12162            ####     ###    #   #   #####    ###    #   #   #####    ###
     1407    12163            #   #   #   #   #   #     #       #     #   #   #       #   #
     1408    12164            #   #   #   #   #   #     #       #     ##  #   #       #
     1409    12165            ####    #   #   #   #     #       #     # # #   ####     ###
     1410    12166            # #     #   #   #   #     #       #     #  ##   #           #
     1411    12167            #  #    #   #   #   #     #       #     #   #   #       #   #
     1412    12168            #   #    ###     ###      #      ###    #   #   #####    ###
     1413    12169
     1414    12170
     1415    12171        */
     1416    12172        /**************************************
     1417    12173         **************************************
     1418    12174                    ADD_DEV
     1419    12175         **************************************
     1420    12176         **************************************/
     1421    12177        /*D* NAME:         ADD_DEV
     1422    12178             PURPOSE:      To add a new OUTSYM device
     1423    12179             DESCRIPTION:  DEVNAME is the device name.  CGAURD$ points to
     1424    12180                           a termconnect CGAURD structure.
     1425    12181
     1426    12182                           ADD_DEV obtains a dynamic device frame and
     1427    12183                           initializes it with FO_DEV_INIT.  Then the
     1428    12184                           device locked bit, attributes, and form and terminal
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:146  
     1429    12185                           names are set from the connect params.
     1430    12186
     1431    12187                           Finally, the device's TNAME (terminal name)
     1432    12188                           is calculated via :HLP and the TWSN, and
     1433    12189                           placed in the device context block.  The
     1434    12190                           context block is chained onto the device
     1435    12191                           list, and the connect event is reported
     1436    12192                           to FOD$EVENT.
     1437    12193
     1438    12194                           If any hassle is encountered trying to do
     1439    12195                           all this, the device is disconnected with
     1440    12196                           an appropriate message.
     1441    12197        */
     1442    12198    1   ADD_DEV: PROC ALTRET;

  12198  9 001666   200106 741300       ADD_DEV      STX1  ! OSFNAME+1,,AUTO

     1443    12199    2         CALL FIND_DEV ALTRET(A9);

  12199  9 001667   002636 701000 9                  TSX1    FIND_DEV
         9 001670   001677 702000 9                  TSX2    A9

     1444    12200                                /* DEVICE ALREADY LISTED */
     1445    12201    2         CALL FOI$SNAP (%S$DBLCON,F_FO,M_O);

  12201  9 001671   000030 630400 10                 EPPR0   24
         9 001672   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001673   000000 701000 xent               TSX1    FOI$SNAP
         9 001674   000000 011000                    NOP     0

     1446    12202        /*S* SCREECH_CODE: FOO-S$DBLCON
     1447    12203             TYPE:         SNAP
     1448    12204             MESSAGE:      Device connected to OS CG twice
     1449    12205             REMARKS:      OUTSYM received a device connect as OSCG
     1450    12206                           admin user, but the named device is already
     1451    12207                           listed in his tables, implying the device
     1452    12208                           connect has been received twice.   */
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:147  
     1453    12209    2         ALTRETURN;

  12209  9 001675   200106 221300                    LDX1  ! OSFNAME+1,,AUTO
         9 001676   000000 702211                    TSX2  ! 0,X1

  12199  9 001677                       A9           null
     1454    12210    2   A9:   ;
     1455    12211                                      /* Get a Segment Control Block (built
     1456    12212                                         by FO_SCB macro) frame from one of
     1457    12213                                         our data segments, and stuff the
     1458    12214                                         standard initialization stuff in it */
     1459    12215    2         CALL FOI$GBUF (FO_DEVSCB, DEV$) ALTRET (NO_DEVSPACE);

  12215  9 001677   000033 630400 10                 EPPR0   27
         9 001700   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001701   000000 701000 xent               TSX1    FOI$GBUF
         9 001702   002440 702000 9                  TSX2    NO_DEVSPACE

     1460    12216    2         DEV$ -> FO$DEV = FO_DEV_INIT;

  12216  9 001703   000000 470400 xsym               LDP0    FO_DEV$
         9 001704   000100 100400                    MLR     fill='000'O
         9 001705   000000 000111 xsym               ADSC9   FO_DEV_INIT              cn=0,n=73
         9 001706   000000 000111                    ADSC9   0,,PR0                   cn=0,n=73

     1461    12217    2         DEV$ -> FO$DEV.LNK$ = FO_Q.DEVHD$;

  12217  9 001707   000002 236000 xsym               LDQ     FO_Q+2
         9 001710   000000 470400 xsym               LDP0    FO_DEV$
         9 001711   000000 756100                    STQ     0,,PR0

     1462    12218    2         FO_Q.DEVHD$ = DEV$;

  12218  9 001712   000000 236000 xsym               LDQ     FO_DEV$
         9 001713   000002 756000 xsym               STQ     FO_Q+2

     1463    12219    2         DEV$ -> FO$DEV.NAME = DEVNAME;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:148  

  12219  9 001714   000000 470400 xsym               LDP0    FO_DEV$
         9 001715   000022 237000 1                  LDAQ    DEVNAME
         9 001716   000005 755100                    STA     5,,PR0
         9 001717   000006 756100                    STQ     6,,PR0

     1464    12220    2         DEV$ -> FO$DEV.NATTR = ~(CGAURD$ -> B$CGAURD.CONINFO.ATTR);

  12220  9 001720   200076 471500                    LDP1    CGAURD$,,AUTO
         9 001721   100014 236100                    LDQ     12,,PR1
         9 001722   000011 736000                    QLS     9
         9 001723   777777 376003                    ANQ     -1,DU
         9 001724   777777 676003                    ERQ     -1,DU
         9 001725   000022 772000                    QRL     18
         9 001726   000000 620006                    EAX0    0,QL
         9 001727   000011 740100                    STX0    9,,PR0

     1465    12221
     1466    12222    2         HLP_KEY.DEVLGN = CGAURD$ -> B$CGAURD.CONINFO.WHO.ACCT;

  12222  9 001730   040000 100500                    MLR     fill='040'O
         9 001731   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         9 001732   000133 200010 1                  ADSC9   HLP_KEY                  cn=1,n=8

     1467    12223    2         CALL M$READ (READ_HLP)

  12223  9 001733   000270 630400 1                  EPPR0   READ_HLP
         9 001734   440000 713400                    CLIMB   alt,read
         9 001735   401400 401760                    pmme    nvectors=4
         9 001736   001740 702000 9                  TSX2    s:12226
         9 001737   001741 710000 9                  TRA     s:12229

     1468    12224    3         WHENALTRETURN DO;

     1469    12225             /* SNAP */
     1470    12226    3           GOTO NO_DEVSPACE;

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:149  
  12226  9 001740   002440 710000 9                  TRA     NO_DEVSPACE

     1471    12227    3           END;
     1472    12228
     1473    12229    2         CALL M$TRUNC (TRUNC_HLP);

  12229  9 001741   000540 630400 2                  EPPR0   TRUNC_HLP
         9 001742   050003 713400                    CLIMB   20483
         9 001743   400000 401760                    pmme    nvectors=1

     1474    12230    2         WSNDEV$ = ADDR (FO_FITBUF1);

  12230  9 001744   000035 236000 10                 LDQ     29
         9 001745   200007 756100                    STQ     WSNDEV$,,AUTO

     1475    12231
     1476    12232    2         CALL FOI$GBUF (FO_DEVSCB, WSN$) ALTRET (NO_WSNSPACE);

  12232  9 001746   200006 630500                    EPPR0   WSN$,,AUTO
         9 001747   200113 450500                    STP0    OSFNAME+6,,AUTO
         9 001750   000033 236000 10                 LDQ     27
         9 001751   200112 756100                    STQ     OSFNAME+5,,AUTO
         9 001752   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 001753   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001754   000000 701000 xent               TSX1    FOI$GBUF
         9 001755   002411 702000 9                  TSX2    NO_WSNSPACE

     1477    12233    2         DEV$ -> FO$DEV.WSN$ = WSN$;

  12233  9 001756   200006 236100                    LDQ     WSN$,,AUTO
         9 001757   000000 470400 xsym               LDP0    FO_DEV$
         9 001760   000004 756100                    STQ     4,,PR0

     1478    12234    2         WSN$ -> FO$WSN = FO_WSN_INIT;

  12234  9 001761   200006 471500                    LDP1    WSN$,,AUTO
         9 001762   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:150  
         9 001763   000000 000054 xsym               ADSC9   FO_WSN_INIT              cn=0,n=44
         9 001764   100000 000054                    ADSC9   0,,PR1                   cn=0,n=44

     1479    12235    2         J = 0;

  12235  9 001765   200005 450100                    STZ     J,,AUTO

     1480    12236    3           DO I = 0 TO (WSNDEV$ -> KL_WSNDEV.NDEV - 1);

  12236  9 001766   200004 450100                    STZ     I,,AUTO
         9 001767   002064 710000 9                  TRA     s:12253+3

     1481    12237    3           IF J > 4

  12237  9 001770   200005 235100                    LDA     J,,AUTO
         9 001771   000005 115007                    CMPA    5,DL
         9 001772   002015 602000 9                  TNC     s:12246

     1482    12238    4           THEN DO;

     1483    12239    4             J = 0;

  12239  9 001773   200005 450100                    STZ     J,,AUTO

     1484    12240    4             WSN_LNK$ = WSN$;

  12240  9 001774   200006 236100                    LDQ     WSN$,,AUTO
         9 001775   200010 756100                    STQ     WSN_LNK$,,AUTO

     1485    12241    4             CALL FOI$GBUF (FO_DEVSCB, WSN$) ALTRET (NO_WSNSPACE);

  12241  9 001776   200006 630500                    EPPR0   WSN$,,AUTO
         9 001777   200113 450500                    STP0    OSFNAME+6,,AUTO
         9 002000   000033 236000 10                 LDQ     27
         9 002001   200112 756100                    STQ     OSFNAME+5,,AUTO
         9 002002   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 002003   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:151  
         9 002004   000000 701000 xent               TSX1    FOI$GBUF
         9 002005   002411 702000 9                  TSX2    NO_WSNSPACE

     1486    12242    4             WSN_LNK$ -> FO$WSN.LNK$ = WSN$;

  12242  9 002006   200006 236100                    LDQ     WSN$,,AUTO
         9 002007   200010 470500                    LDP0    WSN_LNK$,,AUTO
         9 002010   000000 756100                    STQ     0,,PR0

     1487    12243    4             WSN$ -> FO$WSN = FO_WSN_INIT;

  12243  9 002011   200006 471500                    LDP1    WSN$,,AUTO
         9 002012   000100 100400                    MLR     fill='000'O
         9 002013   000000 000054 xsym               ADSC9   FO_WSN_INIT              cn=0,n=44
         9 002014   100000 000054                    ADSC9   0,,PR1                   cn=0,n=44

     1488    12244    4             END;

     1489    12245
     1490    12246    3           WSN$ -> FO$WSN.WSN.WSN_NAME(J) = WSNDEV$ -> KL_WSNDEV.DEV(I);

  12246  9 002015   200004 235100                    LDA     I,,AUTO
         9 002016   000003 735000                    ALS     3
         9 002017   200005 236100                    LDQ     J,,AUTO
         9 002020   200112 755100                    STA     OSFNAME+5,,AUTO
         9 002021   000011 402007                    MPY     9,DL
         9 002022   200007 470500                    LDP0    WSNDEV$,,AUTO
         9 002023   200112 235100                    LDA     OSFNAME+5,,AUTO
         9 002024   200006 471500                    LDP1    WSN$,,AUTO
         9 002025   040106 100505                    MLR     fill='040'O
         9 002026   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8
         9 002027   100002 000010                    ADSC9   2,Q,PR1                  cn=0,n=8

     1491    12247    3           WSN$ -> FO$WSN.WSN.ORIGINAL(J) = '1'B;

  12247  9 002030   200005 236100                    LDQ     J,,AUTO
         9 002031   000121 402007                    MPY     81,DL
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:152  
         9 002032   200006 471500                    LDP1    WSN$,,AUTO
         9 002033   003106 060400                    CSL     bolr='003'O
         9 002034   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         9 002035   100004 050001                    BDSC    4,Q,PR1                  by=0,bit=5,n=1

     1492    12248    3           WSN$ -> FO$WSN.WSN.ADD_ON(J) = '0'B;

  12248  9 002036   200006 471500                    LDP1    WSN$,,AUTO
         9 002037   003106 060400                    CSL     bolr='003'O
         9 002040   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         9 002041   100004 100001                    BDSC    4,Q,PR1                  by=0,bit=8,n=1

     1493    12249    3           WSN$ -> FO$WSN.WSN.NOT_USED(J) = '0'B;

  12249  9 002042   200006 471500                    LDP1    WSN$,,AUTO
         9 002043   003106 060400                    CSL     bolr='003'O
         9 002044   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         9 002045   100004 060001                    BDSC    4,Q,PR1                  by=0,bit=6,n=1

     1494    12250    3           WSN$ -> FO$WSN.WSN.ROUTED_OUT(J) = '0'B;

  12250  9 002046   200006 471500                    LDP1    WSN$,,AUTO
         9 002047   003106 060400                    CSL     bolr='003'O
         9 002050   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         9 002051   100004 070001                    BDSC    4,Q,PR1                  by=0,bit=7,n=1

     1495    12251    3           WSN$ -> FO$WSN.NWSNS = WSN$ -> FO$WSN.NWSNS + 1;

  12251  9 002052   200006 471500                    LDP1    WSN$,,AUTO
         9 002053   100001 235100                    LDA     1,,PR1
         9 002054   000001 035007                    ADLA    1,DL
         9 002055   100001 755100                    STA     1,,PR1

     1496    12252    3           J = J + 1;

  12252  9 002056   200005 235100                    LDA     J,,AUTO
         9 002057   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:153  
         9 002060   200005 755100                    STA     J,,AUTO

     1497    12253    3           END;

  12253  9 002061   200004 236100                    LDQ     I,,AUTO
         9 002062   000001 036007                    ADLQ    1,DL
         9 002063   200004 756100                    STQ     I,,AUTO
         9 002064   200007 470500                    LDP0    WSNDEV$,,AUTO
         9 002065   200004 236100                    LDQ     I,,AUTO
         9 002066   000000 116100                    CMPQ    0,,PR0
         9 002067   001770 602000 9                  TNC     s:12237

     1498    12254
     1499    12255    2         FO_OSYMBKEY.LEN = 8;

  12255  9 002070   010000 236003                    LDQ     4096,DU
         9 002071   000000 552040 xsym               STBQ    FO_OSYMBKEY,'40'O

     1500    12256    2         FO_OSYMBKEY.NAME = DEV$ -> FO$DEV.NAME;

  12256  9 002072   000000 471400 xsym               LDP1    FO_DEV$
         9 002073   040000 100500                    MLR     fill='040'O
         9 002074   100005 000010                    ADSC9   5,,PR1                   cn=0,n=8
         9 002075   000000 200010 xsym               ADSC9   FO_OSYMBKEY              cn=1,n=8

     1501    12257    2         READ_OSYMB.BUF_.BOUND = 256;

  12257  9 002076   000516 236000 1                  LDQ     READ_OSYMB+4
         9 002077   177777 376007                    ANQ     65535,DL
         9 002100   000100 276003                    ORQ     64,DU
         9 002101   000516 756000 1                  STQ     READ_OSYMB+4

     1502    12258    2         CALL M$READ (READ_OSYMB)

  12258  9 002102   000512 630400 1                  EPPR0   READ_OSYMB
         9 002103   440000 713400                    CLIMB   alt,read
         9 002104   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:154  
         9 002105   002107 702000 9                  TSX2    s:12260
         9 002106   002133 710000 9                  TRA     s:12271

     1503    12259    3         WHENALTRETURN DO;

     1504    12260    3           IF CGAURD$ -> B$CGAURD.FOINFO.FORMR ~= '0'B

  12260  9 002107   200076 470500                    LDP0    CGAURD$,,AUTO
         9 002110   000000 106500                    CMPC    fill='000'O
         9 002111   000016 000006                    ADSC9   14,,PR0                  cn=0,n=6
         9 002112   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         9 002113   002121 600000 9                  TZE     s:12264

     1505    12261    3           THEN
     1506    12262    3            DEV$ -> FO$DEV.FORM = CGAURD$ -> B$CGAURD.FOINFO.FORM;

  12262  9 002114   000000 471400 xsym               LDP1    FO_DEV$
         9 002115   040100 100500                    MLR     fill='040'O
         9 002116   000016 000006                    ADSC9   14,,PR0                  cn=0,n=6
         9 002117   100015 600006                    ADSC9   13,,PR1                  cn=3,n=6
         9 002120   002125 710000 9                  TRA     s:12266

     1507    12263    3           ELSE
     1508    12264    3            DEV$ -> FO$DEV.FORM = ' ';

  12264  9 002121   000000 471400 xsym               LDP1    FO_DEV$
         9 002122   040100 100400                    MLR     fill='040'O
         9 002123   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 002124   100015 600006                    ADSC9   13,,PR1                  cn=3,n=6

     1509    12265
     1510    12266    3           DEV$ -> FO$DEV.FLG.LOCK = CGAURD$ -> B$CGAURD.FOINFO.UPLOCKED;

  12266  9 002125   000015 236100                    LDQ     13,,PR0
         9 002126   000043 772000                    QRL     35
         9 002127   100012 676100                    ERQ     10,,PR1
         9 002130   000001 376007                    ANQ     1,DL
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:155  
         9 002131   100012 656100                    ERSQ    10,,PR1

     1511    12267        /*N* CALL DO_ROUTE; */
     1512    12268    3           GOTO A10;

  12268  9 002132   002372 710000 9                  TRA     A10

     1513    12269    3           END;
     1514    12270
     1515    12271    2         CALL M$TRUNC (TRUNC_OSYMB);

  12271  9 002133   000544 630400 2                  EPPR0   TRUNC_OSYMB
         9 002134   050003 713400                    CLIMB   20483
         9 002135   400000 401760                    pmme    nvectors=1

     1516    12272    2         OSYMB$ = ADDR(FO_OSYMBUF);

  12272  9 002136   000036 236000 10                 LDQ     30
         9 002137   200011 756100                    STQ     OSYMB$,,AUTO

     1517    12273    2         DEV$ -> FO$DEV.FLG.LOCK = FO_OSYMBUF.FO_OSYMBDEV.FLG.LOCK;

  12273  9 002140   000000 470400 xsym               LDP0    FO_DEV$
         9 002141   000012 236000 xsym               LDQ     FO_OSYMBUF+10
         9 002142   000012 676100                    ERQ     10,,PR0
         9 002143   000001 376007                    ANQ     1,DL
         9 002144   000012 656100                    ERSQ    10,,PR0

     1518    12274    2         DEV$ -> FO$DEV.FORM = FO_OSYMBUF.FO_OSYMBDEV.FORM;

  12274  9 002145   040100 100400                    MLR     fill='040'O
         9 002146   000015 600006 xsym               ADSC9   FO_OSYMBUF+13            cn=3,n=6
         9 002147   000015 600006                    ADSC9   13,,PR0                  cn=3,n=6

     1519    12275
     1520    12276                                      /* Check if it's a LOCAL device */
     1521    12277    2         CALL M$SYMBIO (CHORG_SYMB)
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:156  

  12277  9 002150   001066 630400 2                  EPPR0   CHORG_SYMB
         9 002151   570000 713400                    CLIMB   alt,+61440
         9 002152   403400 401760                    pmme    nvectors=8
         9 002153   002200 702000 9                  TSX2    s:12288

     1522    12278    3         WHENRETURN DO;

     1523    12279    3           IF CGAURD$ -> B$CGAURD.FOINFO.FORMR ~= '0'B

  12279  9 002154   200076 470500                    LDP0    CGAURD$,,AUTO
         9 002155   000000 106500                    CMPC    fill='000'O
         9 002156   000016 000006                    ADSC9   14,,PR0                  cn=0,n=6
         9 002157   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         9 002160   002166 600000 9                  TZE     s:12283

     1524    12280    3           THEN
     1525    12281    3            DEV$ -> FO$DEV.FORM = CGAURD$ -> B$CGAURD.FOINFO.FORM;

  12281  9 002161   000000 471400 xsym               LDP1    FO_DEV$
         9 002162   040100 100500                    MLR     fill='040'O
         9 002163   000016 000006                    ADSC9   14,,PR0                  cn=0,n=6
         9 002164   100015 600006                    ADSC9   13,,PR1                  cn=3,n=6
         9 002165   002172 710000 9                  TRA     s:12285

     1526    12282    3           ELSE
     1527    12283    3            DEV$ -> FO$DEV.FORM = ' ';

  12283  9 002166   000000 471400 xsym               LDP1    FO_DEV$
         9 002167   040100 100400                    MLR     fill='040'O
         9 002170   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 002171   100015 600006                    ADSC9   13,,PR1                  cn=3,n=6

     1528    12284
     1529    12285    3           DEV$ -> FO$DEV.FLG.LOCK = CGAURD$ -> B$CGAURD.FOINFO.UPLOCKED;

  12285  9 002172   000015 236100                    LDQ     13,,PR0
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:157  
         9 002173   000043 772000                    QRL     35
         9 002174   100012 676100                    ERQ     10,,PR1
         9 002175   000001 376007                    ANQ     1,DL
         9 002176   100012 656100                    ERSQ    10,,PR1

     1530    12286    3           END;

  12286  9 002177   002211 710000 9                  TRA     s:12291

     1531    12287    3         WHENALTRETURN DO;

     1532    12288    3           IF B$ERRCODE = %E$LOCAL THEN DEV$->FO$DEV.FLG.LOCAL='1'B;

  12288  9 002200   000000 470400 xsym               LDP0    B$TCB$
         9 002201   000000 471500                    LDP1    0,,PR0
         9 002202   100102 236100                    LDQ     66,,PR1
         9 002203   377770 376007                    ANQ     131064,DL
         9 002204   021240 116007                    CMPQ    8864,DL
         9 002205   002211 601000 9                  TNZ     s:12291

  12288  9 002206   000000 473400 xsym               LDP3    FO_DEV$
         9 002207   040000 236007                    LDQ     16384,DL
         9 002210   300012 256100                    ORSQ    10,,PR3

     1533    12289    3           END;

     1534    12290
     1535    12291    2         CALL FOR$GETMODE ( DEV$ -> FO$DEV.FORM );

  12291  9 002211   000000 236000 xsym               LDQ     FO_DEV$
         9 002212   000037 036000 10                 ADLQ    31
         9 002213   200112 756100                    STQ     OSFNAME+5,,AUTO
         9 002214   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 002215   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002216   000000 701000 xent               TSX1    FOR$GETMODE
         9 002217   000000 011000                    NOP     0

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:158  
     1536    12292
     1537    12293    3           DO I = 0 TO FO_OSYMBUF.FO_OSYMBWSN.NWSNS - 1;

  12293  9 002220   200004 450100                    STZ     I,,AUTO
         9 002221   002367 710000 9                  TRA     NEXT_OSYMB+3

     1538    12294
     1539    12295    3           IF FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED(I) = '1'B

  12295  9 002222   200004 236100                    LDQ     I,,AUTO
         9 002223   000121 402007                    MPY     81,DL
         9 002224   000000 066406                    CMPB    filb='0'B
         9 002225   000027 060001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=6,n=1
         9 002226   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 002227   002364 601000 9                  TNZ     NEXT_OSYMB

     1540    12296    3           THEN
     1541    12297    3            GOTO NEXT_OSYMB;
     1542    12298
     1543    12299    3           WSN$ = DEV$ -> FO$DEV.WSN$;

  12299  9 002230   000000 470400 xsym               LDP0    FO_DEV$
         9 002231   000004 236100                    LDQ     4,,PR0
         9 002232   200006 756100                    STQ     WSN$,,AUTO

     1544    12300    4             DO WHILE (WSN$ ~= ADDR(NIL));

  12300  9 002233   002274 710000 9                  TRA     s:12311

     1545    12301    5               DO J = 0 TO (WSN$ -> FO$WSN.NWSNS - 1);

  12301  9 002234   200005 450100                    STZ     J,,AUTO
         9 002235   002264 710000 9                  TRA     s:12308+3

     1546    12302    5               IF (WSN$ -> FO$WSN.WSN.WSN_NAME(J)

  12302  9 002236   200005 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:159  
         9 002237   000011 402007                    MPY     9,DL
         9 002240   200112 756100                    STQ     OSFNAME+5,,AUTO
         9 002241   200004 236100                    LDQ     I,,AUTO
         9 002242   000011 402007                    MPY     9,DL
         9 002243   200006 470500                    LDP0    WSN$,,AUTO
         9 002244   200112 235100                    LDA     OSFNAME+5,,AUTO
         9 002245   040006 106505                    CMPC    fill='040'O
         9 002246   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=8
         9 002247   000025 000010 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=8
         9 002250   002261 601000 9                  TNZ     s:12308

     1547    12303    5               = FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME(I))
     1548    12304    6               THEN DO;

     1549    12305    6                 WSN$ -> FO$WSN.WSN(J) = FO_OSYMBUF.FO_OSYMBWSN.WSN(I);

  12305  9 002251   200112 756100                    STQ     OSFNAME+5,,AUTO
         9 002252   200005 236100                    LDQ     J,,AUTO
         9 002253   000011 402007                    MPY     9,DL
         9 002254   200112 235100                    LDA     OSFNAME+5,,AUTO
         9 002255   000106 100405                    MLR     fill='000'O
         9 002256   000025 000011 xsym               ADSC9   FO_OSYMBUF+21,A          cn=0,n=9
         9 002257   000002 000011                    ADSC9   2,Q,PR0                  cn=0,n=9

     1550    12306    6                 GOTO NEXT_OSYMB;

  12306  9 002260   002364 710000 9                  TRA     NEXT_OSYMB

     1551    12307    6                 END;
     1552    12308    5               END;

  12308  9 002261   200005 235100                    LDA     J,,AUTO
         9 002262   000001 035007                    ADLA    1,DL
         9 002263   200005 755100                    STA     J,,AUTO
         9 002264   200006 470500                    LDP0    WSN$,,AUTO
         9 002265   200005 236100                    LDQ     J,,AUTO
         9 002266   000001 116100                    CMPQ    1,,PR0
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:160  
         9 002267   002236 602000 9                  TNC     s:12302

     1553    12309    4             WSN_LNK$ = WSN$;

  12309  9 002270   200006 236100                    LDQ     WSN$,,AUTO
         9 002271   200010 756100                    STQ     WSN_LNK$,,AUTO

     1554    12310    4             WSN$ = WSN$ -> FO$WSN.LNK$;

  12310  9 002272   000000 236100                    LDQ     0,,PR0
         9 002273   200006 756100                    STQ     WSN$,,AUTO

     1555    12311    4             END;

  12311  9 002274   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 002275   002234 601000 9                  TNZ     s:12301

     1556    12312
     1557    12313    3           WSN$ = WSN_LNK$;

  12313  9 002276   200010 236100                    LDQ     WSN_LNK$,,AUTO
         9 002277   200006 756100                    STQ     WSN$,,AUTO

     1558    12314    3           IF FO_OSYMBUF.FO_OSYMBWSN.WSN.ADD_ON(I) = '1'B

  12314  9 002300   200004 236100                    LDQ     I,,AUTO
         9 002301   000121 402007                    MPY     81,DL
         9 002302   000000 066406                    CMPB    filb='0'B
         9 002303   000027 100001 xsym               BDSC    FO_OSYMBUF+23,Q          by=0,bit=8,n=1
         9 002304   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 002305   002364 600000 9                  TZE     NEXT_OSYMB

     1559    12315    4           THEN DO;

     1560    12316    4             IF WSN$ -> FO$WSN.NWSNS < 4

  12316  9 002306   200006 470500                    LDP0    WSN$,,AUTO
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:161  
         9 002307   000001 235100                    LDA     1,,PR0
         9 002310   000004 115007                    CMPA    4,DL
         9 002311   002327 603000 9                  TRC     s:12323

     1561    12317    5             THEN DO;

     1562    12318    5               WSN$ -> FO$WSN.NWSNS = WSN$ -> FO$WSN.NWSNS + 1;

  12318  9 002312   000001 035007                    ADLA    1,DL
         9 002313   000001 755100                    STA     1,,PR0

     1563    12319    5              WSN$ -> FO$WSN.WSN(WSN$->FO$WSN.NWSNS-1) = FO_OSYMBUF.FO_OSYMBWSN.WSN(I)
             12319                        ;

  12319  9 002314   200006 470500                    LDP0    WSN$,,AUTO
         9 002315   000001 236100                    LDQ     1,,PR0
         9 002316   000011 402007                    MPY     9,DL
         9 002317   200112 756100                    STQ     OSFNAME+5,,AUTO
         9 002320   200004 236100                    LDQ     I,,AUTO
         9 002321   000011 402007                    MPY     9,DL
         9 002322   200112 235100                    LDA     OSFNAME+5,,AUTO
         9 002323   000105 100406                    MLR     fill='000'O
         9 002324   000025 000011 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=9
         9 002325   077777 600011                    ADSC9   -1,A,PR0                 cn=3,n=9

     1564    12320    5               END;

  12320  9 002326   002364 710000 9                  TRA     NEXT_OSYMB

     1565    12321    4             ELSE
     1566    12322    5               DO;

     1567    12323    5               WSN_LNK$ = WSN$;

  12323  9 002327   200006 236100                    LDQ     WSN$,,AUTO
         9 002330   200010 756100                    STQ     WSN_LNK$,,AUTO

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:162  
     1568    12324    5               CALL FOI$GBUF (FO_DEVSCB, WSN$) ALTRET (NO_WSNSPACE);

  12324  9 002331   200006 631500                    EPPR1   WSN$,,AUTO
         9 002332   200113 451500                    STP1    OSFNAME+6,,AUTO
         9 002333   000033 236000 10                 LDQ     27
         9 002334   200112 756100                    STQ     OSFNAME+5,,AUTO
         9 002335   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 002336   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002337   000000 701000 xent               TSX1    FOI$GBUF
         9 002340   002411 702000 9                  TSX2    NO_WSNSPACE

     1569    12325    5               WSN_LNK$ -> FO$WSN.LNK$ = WSN$;

  12325  9 002341   200006 236100                    LDQ     WSN$,,AUTO
         9 002342   200010 470500                    LDP0    WSN_LNK$,,AUTO
         9 002343   000000 756100                    STQ     0,,PR0

     1570    12326    5               WSN$ -> FO$WSN.LNK$ = ADDR(NIL);

  12326  9 002344   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 002345   200006 471500                    LDP1    WSN$,,AUTO
         9 002346   100000 756100                    STQ     0,,PR1

     1571    12327    5               WSN$ -> FO$WSN.NWSNS = 1;

  12327  9 002347   000001 235007                    LDA     1,DL
         9 002350   200006 471500                    LDP1    WSN$,,AUTO
         9 002351   100001 755100                    STA     1,,PR1

     1572    12328    5               WSN$ -> FO$WSN.WSN(WSN$ -> FO$WSN.NWSNS-1)

  12328  9 002352   200006 471500                    LDP1    WSN$,,AUTO
         9 002353   100001 236100                    LDQ     1,,PR1
         9 002354   000011 402007                    MPY     9,DL
         9 002355   200112 756100                    STQ     OSFNAME+5,,AUTO
         9 002356   200004 236100                    LDQ     I,,AUTO
         9 002357   000011 402007                    MPY     9,DL
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:163  
         9 002360   200112 235100                    LDA     OSFNAME+5,,AUTO
         9 002361   000105 100406                    MLR     fill='000'O
         9 002362   000025 000011 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=9
         9 002363   177777 600011                    ADSC9   -1,A,PR1                 cn=3,n=9

     1573    12329    5               = FO_OSYMBUF.FO_OSYMBWSN.WSN(I);
     1574    12330    5               END;

     1575    12331    4             END;

  12326  9 002364                       NEXT_OSYMB   null
     1576    12332    3   NEXT_OSYMB:;
     1577    12333    3           END;

  12333  9 002364   200004 235100                    LDA     I,,AUTO
         9 002365   000001 035007                    ADLA    1,DL
         9 002366   200004 755100                    STA     I,,AUTO
         9 002367   200004 236100                    LDQ     I,,AUTO
         9 002370   000024 116000 xsym               CMPQ    FO_OSYMBUF+20
         9 002371   002222 602000 9                  TNC     s:12295

  12328  9 002372                       A10          null
     1578    12334        /*N* CHECK ROUTE AND UNROUTE KEYINS HERE */
     1579    12335    2   A10:  ;
     1580    12336    2         DEV$->FO$DEV.TNAME=CGAURD$->B$CGAURD.FOINFO.TNAME;

  12336  9 002372   200076 470500                    LDP0    CGAURD$,,AUTO
         9 002373   000000 471400 xsym               LDP1    FO_DEV$
         9 002374   040100 100500                    MLR     fill='040'O
         9 002375   000020 000010                    ADSC9   16,,PR0                  cn=0,n=8
         9 002376   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8

     1581    12337                                      /* Attempt to start device after the
     1582    12338                                         connect */
     1583    12339    2         CALL FOD$EVENT (FODE_TCON#,NOSTART);

  12339  9 002377   000040 630400 10                 EPPR0   32
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:164  
         9 002400   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002401   000000 701000 xent               TSX1    FOD$EVENT
         9 002402   000000 011000                    NOP     0

     1584    12340                                           /* Now place all wsn recs into
     1585    12341                                           :OSYMB.  We must do this because
     1586    12342                                           new devices have no :OSYMB record,
     1587    12343                                           and old devices may have new
     1588    12344                                           default WSNs. */
     1589    12345    2         CALL DEV_TO_OSYMB;

  12345  9 002403   002455 701000 9                  TSX1    DEV_TO_OSYMB
         9 002404   000000 011000                    NOP     0

     1590    12346    2         CALL DISPLAY_ROUTE;

  12346  9 002405   002551 701000 9                  TSX1    DISPLAY_ROUTE
         9 002406   000000 011000                    NOP     0

     1591    12347    2         RETURN;

  12347  9 002407   200106 221300                    LDX1  ! OSFNAME+1,,AUTO
         9 002410   000001 702211                    TSX2  ! 1,X1

  12336  9 002411                       NO_WSNSPACE  null
     1592    12348    2   NO_WSNSPACE:;
     1593    12349    2         WSN$ = DEV$ -> FO$DEV.WSN$;

  12349  9 002411   000000 470400 xsym               LDP0    FO_DEV$
         9 002412   000004 236100                    LDQ     4,,PR0
         9 002413   200006 756100                    STQ     WSN$,,AUTO

     1594    12350    3           DO WHILE (WSN$ ~= ADDR(NIL));

  12350  9 002414   002432 710000 9                  TRA     s:12354

     1595    12351    3           WSN_LNK$ = WSN$ -> FO$WSN.LNK$;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:165  

  12351  9 002415   200006 470500                    LDP0    WSN$,,AUTO
         9 002416   000000 236100                    LDQ     0,,PR0
         9 002417   200010 756100                    STQ     WSN_LNK$,,AUTO

     1596    12352    3           CALL FOI$RBUF (FO_DEVSCB,WSN$);

  12352  9 002420   200006 631500                    EPPR1   WSN$,,AUTO
         9 002421   200113 451500                    STP1    OSFNAME+6,,AUTO
         9 002422   000033 236000 10                 LDQ     27
         9 002423   200112 756100                    STQ     OSFNAME+5,,AUTO
         9 002424   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 002425   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002426   000000 701000 xent               TSX1    FOI$RBUF
         9 002427   000000 011000                    NOP     0

     1597    12353    3           WSN$ = WSN_LNK$;

  12353  9 002430   200010 236100                    LDQ     WSN_LNK$,,AUTO
         9 002431   200006 756100                    STQ     WSN$,,AUTO

     1598    12354    3           END;

  12354  9 002432   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 002433   002415 601000 9                  TNZ     s:12351

     1599    12355
     1600    12356    2         CALL FOI$RBUF (FO_DEVSCB,DEV$);

  12356  9 002434   000033 630400 10                 EPPR0   27
         9 002435   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 002436   000000 701000 xent               TSX1    FOI$RBUF
         9 002437   000000 011000                    NOP     0

  12351  9 002440                       NO_DEVSPACE  null
     1601    12357    2   NO_DEVSPACE:;
     1602    12358    2         OPMSG_TDSC.SUBC=FOTD_NTBL#;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:166  

  12358  9 002440   000001 236003                    LDQ     1,DU
         9 002441   000042 552020 1                  STBQ    OPMSG_TDSC+5,'20'O

  12358  9 002442                       DISC         null
     1603    12359    2   DISC: ;
     1604    12360    2         OPMSG_TDSC.DEVNM=DEVNAME;

  12360  9 002442   000022 237000 1                  LDAQ    DEVNAME
         9 002443   000040 757000 1                  STAQ    OPMSG_TDSC+3

     1605    12361    2         CALL M$WRITE (OCMSG_TDSC);

  12361  9 002444   000600 630400 2                  EPPR0   OCMSG_TDSC
         9 002445   040001 713400                    CLIMB   write
         9 002446   401400 401760                    pmme    nvectors=4

     1606    12362    2         CALL M$DEACTIVATE(DISCT_DEV) ALTRET(A4);

  12362  9 002447   000660 630400 2                  EPPR0   DISCT_DEV
         9 002450   500001 713400                    CLIMB   alt,+32769
         9 002451   401400 401760                    pmme    nvectors=4
         9 002452   002453 702000 9                  TSX2    A4

     1607    12363    2   A4:
     1608    12364    2         RETURN;

  12364  9 002453   200106 221300       A4           LDX1  ! OSFNAME+1,,AUTO
         9 002454   000001 702211                    TSX2  ! 1,X1

     1609    12365    2   END ADD_DEV;
     1610    12366        /********************************************
     1611    12367         ********************************************
     1612    12368                        DEV_TO_OSYMB
     1613    12369         ********************************************
     1614    12370         ********************************************/
     1615    12371        /*D* NAME:           DO_ROUTE
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:167  
     1616    12372             PURPOSE:        To do previously set routing on devices.
     1617    12373             DESCRIPTION:    Route keyin information is saved and
     1618    12374                             applied to devices that connect after the
     1619    12375                             keyins are issued (i.e. if there's no
     1620    12376                             :OSYMB device record).
     1621    12377                                                          */
     1622    12378    1   DEV_TO_OSYMB: PROC;

  12378  9 002455   200110 741300       DEV_TO_OSYMB STX1  ! OSFNAME+3,,AUTO

     1623    12379
     1624    12380    2         TALLY = 0;

  12380  9 002456   200012 450100                    STZ     TALLY,,AUTO

     1625    12381    2         FO_OSYMBUF.FO_OSYMBDEV = DEV$ -> FO$DEV;

  12381  9 002457   000000 470400 xsym               LDP0    FO_DEV$
         9 002460   000000 100500                    MLR     fill='000'O
         9 002461   000000 000111                    ADSC9   0,,PR0                   cn=0,n=73
         9 002462   000000 000111 xsym               ADSC9   FO_OSYMBUF               cn=0,n=73

     1626    12382    2         J = 0;

  12382  9 002463   200005 450100                    STZ     J,,AUTO

     1627    12383    2         WSN$ = DEV$ -> FO$DEV.WSN$;

  12383  9 002464   000004 236100                    LDQ     4,,PR0
         9 002465   200006 756100                    STQ     WSN$,,AUTO

     1628    12384    3           DO WHILE (WSN$ ~= ADDR(NIL));

  12384  9 002466   002522 710000 9                  TRA     s:12391

     1629    12385    3           TALLY = TALLY + WSN$ -> FO$WSN.NWSNS;

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:168  
  12385  9 002467   200006 470500                    LDP0    WSN$,,AUTO
         9 002470   200012 236100                    LDQ     TALLY,,AUTO
         9 002471   000001 036100                    ADLQ    1,,PR0
         9 002472   200012 756100                    STQ     TALLY,,AUTO

     1630    12386    4             DO I = 0 TO (WSN$ -> FO$WSN.NWSNS - 1);

  12386  9 002473   200004 450100                    STZ     I,,AUTO
         9 002474   002515 710000 9                  TRA     s:12389+3

     1631    12387    4             FO_OSYMBUF.FO_OSYMBWSN.WSN(J) = WSN$ -> FO$WSN.WSN(I);

  12387  9 002475   200004 236100                    LDQ     I,,AUTO
         9 002476   000011 402007                    MPY     9,DL
         9 002477   200112 756100                    STQ     OSFNAME+5,,AUTO
         9 002500   200005 236100                    LDQ     J,,AUTO
         9 002501   000011 402007                    MPY     9,DL
         9 002502   200006 470500                    LDP0    WSN$,,AUTO
         9 002503   200112 235100                    LDA     OSFNAME+5,,AUTO
         9 002504   000006 100505                    MLR     fill='000'O
         9 002505   000002 000011                    ADSC9   2,A,PR0                  cn=0,n=9
         9 002506   000025 000011 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=9

     1632    12388    4             J = J + 1;

  12388  9 002507   200005 235100                    LDA     J,,AUTO
         9 002510   000001 035007                    ADLA    1,DL
         9 002511   200005 755100                    STA     J,,AUTO

     1633    12389    4             END;

  12389  9 002512   200004 236100                    LDQ     I,,AUTO
         9 002513   000001 036007                    ADLQ    1,DL
         9 002514   200004 756100                    STQ     I,,AUTO
         9 002515   200004 236100                    LDQ     I,,AUTO
         9 002516   000001 116100                    CMPQ    1,,PR0
         9 002517   002475 602000 9                  TNC     s:12387
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:169  

     1634    12390    3           WSN$ = WSN$ -> FO$WSN.LNK$;

  12390  9 002520   000000 236100                    LDQ     0,,PR0
         9 002521   200006 756100                    STQ     WSN$,,AUTO

     1635    12391    3           END;

  12391  9 002522   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 002523   002467 601000 9                  TNZ     s:12385

     1636    12392    2         FO_OSYMBUF.FO_OSYMBWSN.NWSNS = J;

  12392  9 002524   200005 235100                    LDA     J,,AUTO
         9 002525   000024 755000 xsym               STA     FO_OSYMBUF+20

     1637    12393    2         FO_OSYMBKEY.NAME = DEV$ -> FO$DEV.NAME;

  12393  9 002526   000000 470400 xsym               LDP0    FO_DEV$
         9 002527   040000 100500                    MLR     fill='040'O
         9 002530   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         9 002531   000000 200010 xsym               ADSC9   FO_OSYMBKEY              cn=1,n=8

     1638    12394    2         WRITE_OSYMB.BUF_.BOUND = LENGTHC(FO_OSYMBUF.FO_OSYMBDEV)

  12394  9 002532   000024 236000 xsym               LDQ     FO_OSYMBUF+20
         9 002533   000012 402007                    MPY     10,DL
         9 002534   000133 036007                    ADLQ    91,DL
         9 002535   000020 736000                    QLS     16
         9 002536   000344 676000 1                  ERQ     WRITE_OSYMB+4
         9 002537   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 002540   000344 656000 1                  ERSQ    WRITE_OSYMB+4

     1639    12395    2         + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
     1640    12396    2         + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
     1641    12397    2         + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
     1642    12398    2         CALL M$WRITE (WRITE_OSYMB);
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:170  

  12398  9 002541   000340 630400 1                  EPPR0   WRITE_OSYMB
         9 002542   040001 713400                    CLIMB   write
         9 002543   401400 401760                    pmme    nvectors=4

     1643    12399    2         CALL M$TRUNC (TRUNC_OSYMB);

  12399  9 002544   000544 630400 2                  EPPR0   TRUNC_OSYMB
         9 002545   050003 713400                    CLIMB   20483
         9 002546   400000 401760                    pmme    nvectors=1

     1644    12400    2         RETURN;

  12400  9 002547   200110 221300                    LDX1  ! OSFNAME+3,,AUTO
         9 002550   000001 702211                    TSX2  ! 1,X1

     1645    12401    2   END DEV_TO_OSYMB;
     1646    12402        /*************************************************
     1647    12403         *************************************************
     1648    12404                       DISPLAY_ROUTE
     1649    12405         *************************************************
     1650    12406         *************************************************/
     1651    12407        /*D* NAME:          DISPLAY_ROUTE
     1652    12408             PURPOSE:       Display route information upon connect.
     1653    12409             DESCRIPTION:   Route recovery information gets displayed
     1654    12410                            here following device connect messages. */
     1655    12411    1   DISPLAY_ROUTE: PROC;

  12411  9 002551   200110 741300       DISPLAY_ROU* STX1  ! OSFNAME+3,,AUTO

     1656    12412
     1657    12413    2         WSN$ = DEV$ -> FO$DEV.WSN$;

  12413  9 002552   000000 470400 xsym               LDP0    FO_DEV$
         9 002553   000004 236100                    LDQ     4,,PR0
         9 002554   200006 756100                    STQ     WSN$,,AUTO

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:171  
     1658    12414    3           DO WHILE (WSN$ ~= ADDR(NIL));

  12414  9 002555   002632 710000 9                  TRA     s:12432

     1659    12415    4             DO I = 0 TO (WSN$ -> FO$WSN.NWSNS - 1);

  12415  9 002556   200004 450100                    STZ     I,,AUTO
         9 002557   002624 710000 9                  TRA     s:12430+3

     1660    12416    4             OPMSG_TCON.WSN = WSN$ -> FO$WSN.WSN.WSN_NAME(I);

  12416  9 002560   200004 236100                    LDQ     I,,AUTO
         9 002561   000011 402007                    MPY     9,DL
         9 002562   200006 470500                    LDP0    WSN$,,AUTO
         9 002563   040000 100506                    MLR     fill='040'O
         9 002564   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         9 002565   000130 600010 1                  ADSC9   OPMSG_TCON+5             cn=3,n=8

     1661    12417    4             OPMSG_TCON.DEVNM = DEV$ -> FO$DEV.NAME;

  12417  9 002566   000000 471400 xsym               LDP1    FO_DEV$
         9 002567   040000 100500                    MLR     fill='040'O
         9 002570   100005 000010                    ADSC9   5,,PR1                   cn=0,n=8
         9 002571   000126 000010 1                  ADSC9   OPMSG_TCON+3             cn=0,n=8

     1662    12418
     1663    12419    4             IF WSN$ -> FO$WSN.WSN.ROUTED_OUT (I) = '1'B

  12419  9 002572   200004 236100                    LDQ     I,,AUTO
         9 002573   000121 402007                    MPY     81,DL
         9 002574   000000 066506                    CMPB    filb='0'B
         9 002575   000004 070001                    BDSC    4,Q,PR0                  by=0,bit=7,n=1
         9 002576   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 002577   002605 600000 9                  TZE     s:12425

     1664    12420    5             THEN DO;

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:172  
     1665    12421    5               OPMSG_TCON.SUBC = FOTC_RTOT#;

  12421  9 002600   001000 236007                    LDQ     512,DL
         9 002601   000130 552010 1                  STBQ    OPMSG_TCON+5,'10'O

     1666    12422    5               CALL M$WRITE (OCMSG_TCON);

  12422  9 002602   000306 630400 1                  EPPR0   OCMSG_TCON
         9 002603   040001 713400                    CLIMB   write
         9 002604   401400 401760                    pmme    nvectors=4

     1667    12423    5               END;

     1668    12424
     1669    12425    4             IF WSN$ -> FO$WSN.WSN.ADD_ON (I) = '1'B

  12425  9 002605   200004 236100                    LDQ     I,,AUTO
         9 002606   000121 402007                    MPY     81,DL
         9 002607   200006 470500                    LDP0    WSN$,,AUTO
         9 002610   000000 066506                    CMPB    filb='0'B
         9 002611   000004 100001                    BDSC    4,Q,PR0                  by=0,bit=8,n=1
         9 002612   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 002613   002621 600000 9                  TZE     s:12430

     1670    12426    5             THEN DO;

     1671    12427    5               OPMSG_TCON.SUBC = FOTC_RTAD#;

  12427  9 002614   002000 236007                    LDQ     1024,DL
         9 002615   000130 552010 1                  STBQ    OPMSG_TCON+5,'10'O

     1672    12428    5               CALL M$WRITE (OCMSG_TCON);

  12428  9 002616   000306 630400 1                  EPPR0   OCMSG_TCON
         9 002617   040001 713400                    CLIMB   write
         9 002620   401400 401760                    pmme    nvectors=4

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:173  
     1673    12429    5               END;

     1674    12430    4             END;

  12430  9 002621   200004 235100                    LDA     I,,AUTO
         9 002622   000001 035007                    ADLA    1,DL
         9 002623   200004 755100                    STA     I,,AUTO
         9 002624   200006 470500                    LDP0    WSN$,,AUTO
         9 002625   200004 236100                    LDQ     I,,AUTO
         9 002626   000001 116100                    CMPQ    1,,PR0
         9 002627   002560 602000 9                  TNC     s:12416

     1675    12431    3           WSN$ = WSN$ -> FO$WSN.LNK$;

  12431  9 002630   000000 236100                    LDQ     0,,PR0
         9 002631   200006 756100                    STQ     WSN$,,AUTO

     1676    12432    3           END;

  12432  9 002632   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 002633   002556 601000 9                  TNZ     s:12415

     1677    12433    2         RETURN;

  12433  9 002634   200110 221300                    LDX1  ! OSFNAME+3,,AUTO
         9 002635   000001 702211                    TSX2  ! 1,X1

     1678    12434    2   END DISPLAY_ROUTE;
     1679    12435        /**************************************
     1680    12436         **************************************
     1681    12437                    FIND_DEV
     1682    12438         **************************************
     1683    12439         **************************************/
     1684    12440        /*D* NAME:         FIND_DEV
     1685    12441             PURPOSE:      To find a device in OUTSYM's tables
     1686    12442             DESCRIPTION:  The name of the desired device is DEVNAME.  If
     1687    12443                           found, the routine returns with DEV$ pointing to
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:174  
     1688    12444                           the device frame, else it ALTRETs. */
     1689    12445    1   FIND_DEV: PROC ALTRET;

  12445  9 002636   200110 741300       FIND_DEV     STX1  ! OSFNAME+3,,AUTO

     1690    12446
     1691    12447    2         DEV$=FO_Q.DEVHD$;

  12447  9 002637   000002 236000 xsym               LDQ     FO_Q+2
         9 002640   000000 756000 xsym               STQ     FO_DEV$

     1692    12448    3           DO WHILE (DEV$~=ADDR(NIL));

  12448  9 002641   002653 710000 9                  TRA     s:12451

     1693    12449    3           IF DEVNAME=DEV$->FO$DEV.NAME THEN RETURN;

  12449  9 002642   000000 470400 xsym               LDP0    FO_DEV$
         9 002643   040100 106400                    CMPC    fill='040'O
         9 002644   000022 000010 1                  ADSC9   DEVNAME                  cn=0,n=8
         9 002645   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         9 002646   002651 601000 9                  TNZ     s:12450

  12449  9 002647   200110 221300                    LDX1  ! OSFNAME+3,,AUTO
         9 002650   000001 702211                    TSX2  ! 1,X1

     1694    12450    3           DEV$=DEV$->FO$DEV.LNK$;

  12450  9 002651   000000 236100                    LDQ     0,,PR0
         9 002652   000000 756000 xsym               STQ     FO_DEV$

     1695    12451    3           END;

  12451  9 002653   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 002654   002642 601000 9                  TNZ     s:12449

     1696    12452    2         ALTRETURN;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:175  

  12452  9 002655   200110 221300                    LDX1  ! OSFNAME+3,,AUTO
         9 002656   000000 702211                    TSX2  ! 0,X1

     1697    12453    2   END FIND_DEV;
     1698    12454        /**************************************
     1699    12455         **************************************
     1700    12456                    DRIVE_DEVS
     1701    12457         **************************************
     1702    12458         **************************************/
     1703    12459        /*D* NAME:         DRIVE_DEVS
     1704    12460             PURPOSE:      To drive all devices
     1705    12461             DESCRIPTION:  Reports IDLE event on all idle devices,
     1706    12462                           unless NOSTART is nonzero. */
     1707    12463    1   DRIVE_DEVS: PROC;

  12463  9 002657   200106 741300       DRIVE_DEVS   STX1  ! OSFNAME+1,,AUTO

     1708    12464
     1709    12465    2         IF NOSTART > 0 THEN RETURN;

  12465  9 002660   000000 235000 1                  LDA     NOSTART
         9 002661   002663 604400 9                  TMOZ    s:12466

  12465  9 002662   000001 702211                    TSX2  ! 1,X1

     1710    12466    2         DEV$ = FO_Q.DEVHD$;

  12466  9 002663   000002 236000 xsym               LDQ     FO_Q+2
         9 002664   000000 756000 xsym               STQ     FO_DEV$

     1711    12467
     1712    12468    3           DO WHILE (DEV$ ~= ADDR(NIL));

  12468  9 002665   002701 710000 9                  TRA     s:12472

     1713    12469    3           IF DEV$->FO$DEV.STATE = FOS_IDLE# THEN
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:176  

  12469  9 002666   000000 470400 xsym               LDP0    FO_DEV$
         9 002667   000011 236100                    LDQ     9,,PR0
         9 002670   777000 316007                    CANQ    -512,DL
         9 002671   002676 601000 9                  TNZ     s:12471

     1714    12470    3            CALL FOD$EVENT(FODE_IDLE#);

  12470  9 002672   000042 630400 10                 EPPR0   34
         9 002673   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 002674   000000 701000 xent               TSX1    FOD$EVENT
         9 002675   000000 011000                    NOP     0

     1715    12471    3           DEV$ = DEV$->FO$DEV.LNK$;

  12471  9 002676   000000 470400 xsym               LDP0    FO_DEV$
         9 002677   000000 236100                    LDQ     0,,PR0
         9 002700   000000 756000 xsym               STQ     FO_DEV$

     1716    12472    3           END;

  12472  9 002701   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 002702   002666 601000 9                  TNZ     s:12469

     1717    12473    2         RETURN;

  12473  9 002703   200106 221300                    LDX1  ! OSFNAME+1,,AUTO
         9 002704   000001 702211                    TSX2  ! 1,X1

     1718    12474    2   END DRIVE_DEVS;
     1719    12475        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:177  
     1720    12476        /*
     1721    12477
     1722    12478
     1723    12479                            #####    ###    #       #####
     1724    12480                            #         #     #       #
     1725    12481                            #         #     #       #
     1726    12482                            ####      #     #       ####
     1727    12483                            #         #     #       #
     1728    12484                            #         #     #       #
     1729    12485                            #        ###    #####   #####
     1730    12486
     1731    12487
     1732    12488
     1733    12489
     1734    12490            ####     ###    #   #   #####    ###    #   #   #####    ###
     1735    12491            #   #   #   #   #   #     #       #     #   #   #       #   #
     1736    12492            #   #   #   #   #   #     #       #     ##  #   #       #
     1737    12493            ####    #   #   #   #     #       #     # # #   ####     ###
     1738    12494            # #     #   #   #   #     #       #     #  ##   #           #
     1739    12495            #  #    #   #   #   #     #       #     #   #   #       #   #
     1740    12496            #   #    ###     ###      #      ###    #   #   #####    ###
     1741    12497
     1742    12498
     1743    12499        */
     1744    12500        /**************************************
     1745    12501         **************************************
     1746    12502                    GET_FILES
     1747    12503         **************************************
     1748    12504         **************************************/
     1749    12505        /*D* NAME:         GET_FILES
     1750    12506             PURPOSE:      To recover the output symbiont queues
     1751    12507             DESCRIPTION:  When OUTSYM is started after a boot, the output
     1752    12508                           symbiont queues left over from last boot must
     1753    12509                           be recovered.  This is done by opening each file
     1754    12510                           in :SYMO and adding it to the queues.  Some tricks
     1755    12511                           must be played because
     1756    12512
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:178  
     1757    12513                           o these files may have been caught in a crash, and
     1758    12514                             thus may be incomplete commode files
     1759    12515
     1760    12516                           o while this process is ongoing, some users may
     1761    12517                             be building output files, and these we do not
     1762    12518                             want to pick up as they will be added to us
     1763    12519                             later in the normal fashion by the output COOP.
     1764    12520                             This is avoided by means of the BOOTID on the
     1765    12521                             front of every file name. */
     1766    12522    1   GET_FILES: PROC;

  12522  9 002705   200104 741300       GET_FILES    STX1  ! FILE_ADDED+2,,AUTO

     1767    12523        /**/
     1768    12524        %FS_OSFN (FPTN=OSFNAME,STCLASS=AUTO);
     1769    12538        /**/
     1770    12539    2         CALL M$OPEN (OPEN_SYMOFD) ALTRET(GFILE2);

  12539  9 002706   000402 630400 2                  EPPR0   OPEN_SYMOFD
         9 002707   450000 713400                    CLIMB   alt,open
         9 002710   410400 401760                    pmme    nvectors=18
         9 002711   003015 702000 9                  TSX2    GFILE2

     1771    12540    2         GOTO GFILE11;

  12540  9 002712   002717 710000 9                  TRA     GFILE11

     1772    12541    2   GFILE1:
     1773    12542    2         CALL M$OPEN(SCAN_SYMOFD) ALTRET(GFILE2);

  12542  9 002713   000310 630400 2     GFILE1       EPPR0   SCAN_SYMOFD
         9 002714   450000 713400                    CLIMB   alt,open
         9 002715   410400 401760                    pmme    nvectors=18
         9 002716   003015 702000 9                  TSX2    GFILE2

  12539  9 002717                       GFILE11      null
     1774    12543    2   GFILE11:;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:179  
     1775    12544    2         FIL_BOOTID=ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN.BOOTID;

  12544  9 002717   200003 470500                    LDP0    M_FILE1$,,AUTO
         9 002720   000010 236100                    LDQ     8,,PR0
         9 002721   000011 736000                    QLS     9
         9 002722   000040 276007                    ORQ     32,DL
         9 002723   200022 756100                    STQ     FIL_BOOTID,,AUTO

     1776    12545    2         IF M_FILE1$->F$DCB.NAME.L ~= FO_FILENAME.CNT

  12545  9 002724   000010 236100                    LDQ     8,,PR0
         9 002725   000000 676000 xsym               ERQ     FO_FILENAME
         9 002726   777000 376003                    ANQ     -512,DU
         9 002727   002741 601000 9                  TNZ     s:12549
         9 002730   000011 236100                    LDQ     9,,PR0
         9 002731   777000 376003                    ANQ     -512,DU
         9 002732   060000 116003                    CMPQ    24576,DU
         9 002733   002741 602000 9                  TNC     s:12549
         9 002734   000011 236100                    LDQ     9,,PR0
         9 002735   777000 376003                    ANQ     -512,DU
         9 002736   071000 116003                    CMPQ    29184,DU
         9 002737   002746 602000 9                  TNC     s:12552
         9 002740   002746 600000 9                  TZE     s:12552

     1777    12546    2         OR SUBSTR(ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN.SYSID,0,1) < '0'
     1778    12547    2         OR SUBSTR(ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN.SYSID,0,1) > '9' THEN
     1779    12548    3           DO;

     1780    12549    3           CALL M$CLOSE (CLOSE_FILE1) ALTRET(GFILE1);

  12549  9 002741   000500 630400 2                  EPPR0   CLOSE_FILE1
         9 002742   450001 713400                    CLIMB   alt,close
         9 002743   406000 401760                    pmme    nvectors=13
         9 002744   002713 702000 9                  TSX2    GFILE1

     1781    12550    3           GOTO GFILE1;

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:180  
  12550  9 002745   002713 710000 9                  TRA     GFILE1

     1782    12551    3           END;
     1783    12552    2         ELSE IF FIL_BOOTID = FO_BOOTID THEN

  12552  9 002746   200022 236100                    LDQ     FIL_BOOTID,,AUTO
         9 002747   000000 676000 xsym               ERQ     FO_BOOTID
         9 002750   000043 376000 10                 ANQ     35
         9 002751   002757 601000 9                  TNZ     s:12559

     1784    12553    3            DO;

     1785    12554                                      /* New files (from PIG, etc.) are not
     1786    12555                                         "recovered" */
     1787    12556    3            CALL M$CLOSE (CLOSE_FILE1) ALTRET(DONE);

  12556  9 002752   000500 630400 2                  EPPR0   CLOSE_FILE1
         9 002753   450001 713400                    CLIMB   alt,close
         9 002754   406000 401760                    pmme    nvectors=13
         9 002755   003045 702000 9                  TSX2    DONE

     1788    12557    3            GOTO DONE;

  12557  9 002756   003045 710000 9                  TRA     DONE

     1789    12558    3            END;
     1790    12559    2         CALL CHARBIN(FIL_SYSID,ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN.SYSID);

  12559  9 002757   000100 305500                    DTB
         9 002760   000011 030006                    NDSC9   9,,PR0                   cn=0,s=nosgn,sf=0,n=6
         9 002761   200112 000010                    NDSC9   OSFNAME+5,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         9 002762   200113 235100                    LDA     OSFNAME+6,,AUTO
         9 002763   200023 755100                    STA     FIL_SYSID,,AUTO

     1791    12560    2         CALL CHARBIN(FIL_NUM  ,ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN.NUM);

  12560  9 002764   000100 305500                    DTB
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:181  
         9 002765   000012 430006                    NDSC9   10,,PR0                  cn=2,s=nosgn,sf=0,n=6
         9 002766   200112 000010                    NDSC9   OSFNAME+5,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         9 002767   200113 236100                    LDQ     OSFNAME+6,,AUTO
         9 002770   200024 756100                    STQ     FIL_NUM,,AUTO

     1792    12561    2         CALL CHARBIN(FIL_CNUM ,ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN.CNUM);

  12561  9 002771   000100 305500                    DTB
         9 002772   000014 030003                    NDSC9   12,,PR0                  cn=0,s=nosgn,sf=0,n=3
         9 002773   200112 000010                    NDSC9   OSFNAME+5,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         9 002774   200113 235100                    LDA     OSFNAME+6,,AUTO
         9 002775   200025 755100                    STA     FIL_CNUM,,AUTO

     1793    12562    2         CALL FOF$ADD(FIL_SYSID,FIL_NUM,FIL_CNUM,1,FIL_BOOTID);

  12562  9 002776   200022 631500                    EPPR1   FIL_BOOTID,,AUTO
         9 002777   200116 451500                    STP1    OSFNAME+9,,AUTO
         9 003000   000040 236000 10                 LDQ     32
         9 003001   200115 756100                    STQ     OSFNAME+8,,AUTO
         9 003002   200025 633500                    EPPR3   FIL_CNUM,,AUTO
         9 003003   200114 453500                    STP3    OSFNAME+7,,AUTO
         9 003004   200024 634500                    EPPR4   FIL_NUM,,AUTO
         9 003005   200113 454500                    STP4    OSFNAME+6,,AUTO
         9 003006   200023 635500                    EPPR5   FIL_SYSID,,AUTO
         9 003007   200112 455500                    STP5    OSFNAME+5,,AUTO
         9 003010   200112 630500                    EPPR0   OSFNAME+5,,AUTO
         9 003011   000023 631400 xsym               EPPR1   B_VECTNIL+19
         9 003012   000000 701000 xent               TSX1    FOF$ADD
         9 003013   000000 011000                    NOP     0

     1794    12563    2         GOTO GFILE1;

  12563  9 003014   002713 710000 9                  TRA     GFILE1

     1795    12564    2   GFILE2:
     1796    12565    2         IF B$ERRCODE ~= %E$FDEOF THEN

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:182  
  12565  9 003015   000000 470400 xsym  GFILE2       LDP0    B$TCB$
         9 003016   000000 471500                    LDP1    0,,PR0
         9 003017   100102 236100                    LDQ     66,,PR1
         9 003020   377770 376007                    ANQ     131064,DL
         9 003021   001540 116007                    CMPQ    864,DL
         9 003022   003045 600000 9                  TZE     DONE

     1797    12566    3           DO;

     1798    12567    3           OSFNAME=ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN;

  12567  9 003023   200003 473500                    LDP3    M_FILE1$,,AUTO
         9 003024   000100 100500                    MLR     fill='000'O
         9 003025   300010 000023                    ADSC9   8,,PR3                   cn=0,n=19
         9 003026   200105 000023                    ADSC9   OSFNAME,,AUTO            cn=0,n=19

     1799    12568    3           CALL M$OPEN (SCAN_SYMOFD) ALTRET(GFILE3);

  12568  9 003027   000310 630400 2                  EPPR0   SCAN_SYMOFD
         9 003030   450000 713400                    CLIMB   alt,open
         9 003031   410400 401760                    pmme    nvectors=18
         9 003032   003034 702000 9                  TSX2    GFILE3

     1800    12569    3           GOTO GFILE11;

  12569  9 003033   002717 710000 9                  TRA     GFILE11

  12567  9 003034                       GFILE3       null
     1801    12570    3   GFILE3: ;
     1802    12571    3           IF OSFNAME ~= ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN THEN

  12571  9 003034   200003 470500                    LDP0    M_FILE1$,,AUTO
         9 003035   000100 106500                    CMPC    fill='000'O
         9 003036   200105 000023                    ADSC9   OSFNAME,,AUTO            cn=0,n=19
         9 003037   000010 000023                    ADSC9   8,,PR0                   cn=0,n=19
         9 003040   003045 600000 9                  TZE     DONE

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:183  
     1803    12572    4             DO;

     1804    12573    4             OSFNAME=ADDR(M_FILE1$->F$DCB.NAME)->FS$OSFN;

  12573  9 003041   000100 100500                    MLR     fill='000'O
         9 003042   000010 000023                    ADSC9   8,,PR0                   cn=0,n=19
         9 003043   200105 000023                    ADSC9   OSFNAME,,AUTO            cn=0,n=19

     1805    12574    4             GOTO GFILE2;

  12574  9 003044   003015 710000 9                  TRA     GFILE2

     1806    12575    4             END;
     1807    12576    3           END;
     1808    12577    2   DONE:
     1809    12578
     1810    12579                                /* FIX UP FILES WHICH MAY HAVE BEEN CAUGHT
     1811    12580                                   IN A CRASH, BY  MAKING SURE THEY DON'T
     1812    12581                                   WAIT FOR A NEXT COMMODE CHUNK WHICH WILL
     1813    12582                                   NEVER ARRIVE.  ALSO MARK ALL JOBS
     1814    12583                                   AS 'OFF'. */
     1815    12584
     1816    12585    2         FIL$ = FO_Q.FILHD$(FOPR_MFW#);

  12585  9 003045   000005 236000 xsym  DONE         LDQ     FO_Q+5
         9 003046   000000 756000 xsym               STQ     FO_FIL$

     1817    12586    3           DO WHILE (FIL$ ~= ADDR(NIL));

  12586  9 003047   003070 710000 9                  TRA     s:12593

     1818    12587    3           NXTFIL$ = FIL$->FO$FIL.LNK$;

  12587  9 003050   000000 470400 xsym               LDP0    FO_FIL$
         9 003051   000000 236100                    LDQ     0,,PR0
         9 003052   200032 756100                    STQ     NXTFIL$,,AUTO

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:184  
     1819    12588    3           FIL$->FO$FIL.FLG.GLC = '1'B;

  12588  9 003053   000100 236007                    LDQ     64,DL
         9 003054   000015 256100                    ORSQ    13,,PR0

     1820    12589    3           CALL FOF$UNCHAIN;

  12589  9 003055   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003056   000000 701000 xent               TSX1    FOF$UNCHAIN
         9 003057   000000 011000                    NOP     0

     1821    12590    3           CALL FOF$PRIO;

  12590  9 003060   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003061   000000 701000 xent               TSX1    FOF$PRIO
         9 003062   000000 011000                    NOP     0

     1822    12591    3           CALL FOF$CHAIN;

  12591  9 003063   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 003064   000000 701000 xent               TSX1    FOF$CHAIN
         9 003065   000000 011000                    NOP     0

     1823    12592    3           FIL$ = NXTFIL$;

  12592  9 003066   200032 236100                    LDQ     NXTFIL$,,AUTO
         9 003067   000000 756000 xsym               STQ     FO_FIL$

     1824    12593    3           END;

  12593  9 003070   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 003071   003050 601000 9                  TNZ     s:12587

     1825    12594
     1826    12595                                      /* GLC means Got-Last-Chunk.  JOFF tells
     1827    12596                                         us when to delete the JOB frame */
     1828    12597    3           DO I = 0 TO FOPR_MAX#;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:185  

  12597  9 003072   200004 450100                    STZ     I,,AUTO

     1829    12598    3           FIL$=FO_Q.FILHD$(I);

  12598  9 003073   200004 720100                    LXL0    I,,AUTO
         9 003074   000004 236010 xsym               LDQ     FO_Q+4,X0
         9 003075   000000 756000 xsym               STQ     FO_FIL$

     1830    12599    4             DO WHILE (FIL$ ~= ADDR(NIL));

  12599  9 003076   003112 710000 9                  TRA     s:12604

     1831    12600    4             FIL$->FO$FIL.FLG.GLC = '1'B;

  12600  9 003077   000000 470400 xsym               LDP0    FO_FIL$
         9 003100   000100 236007                    LDQ     64,DL
         9 003101   000015 256100                    ORSQ    13,,PR0

     1832    12601    4             IF FIL$->FO$FIL.SYSID > JG_MING# THEN

  12601  9 003102   000012 220100                    LDX0    10,,PR0
         9 003103   000020 100003                    CMPX0   16,DU
         9 003104   003110 602000 9                  TNC     s:12603

     1833    12602    4              FIL$->FO$FIL.OJOB$->FO$JOB.FLG.JOFF='1'B;

  12602  9 003105   000003 471500                    LDP1    3,,PR0
         9 003106   400000 236003                    LDQ     -131072,DU
         9 003107   100003 256100                    ORSQ    3,,PR1

     1834    12603    4             FIL$=FIL$->FO$FIL.LNK$;

  12603  9 003110   000000 236100                    LDQ     0,,PR0
         9 003111   000000 756000 xsym               STQ     FO_FIL$

     1835    12604    4             END;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:186  

  12604  9 003112   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 003113   003077 601000 9                  TNZ     s:12600

     1836    12605    3           END;

  12605  9 003114   200004 235100                    LDA     I,,AUTO
         9 003115   000001 035007                    ADLA    1,DL
         9 003116   200004 755100                    STA     I,,AUTO
         9 003117   000023 115007                    CMPA    19,DL
         9 003120   003073 602000 9                  TNC     s:12598

     1837    12606    2         RETURN;

  12606  9 003121   200104 221300                    LDX1  ! FILE_ADDED+2,,AUTO
         9 003122   000001 702211                    TSX2  ! 1,X1

     1838    12607    2   END GET_FILES;
     1839    12608        %EJECT;
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:187  
     1840    12609        /**************************************
     1841    12610         **************************************
     1842    12611                    MISC_SETUP
     1843    12612         **************************************
     1844    12613         **************************************/
     1845    12614
     1846    12615    1   MISC_SETUP: PROC;

  12615  9 003123   200104 741300       MISC_SETUP   STX1  ! FILE_ADDED+2,,AUTO

     1847    12616
     1848    12617    2         CALL M$OPEN (OPEN_OSYMB) ALTRET(A1);

  12617  9 003124   000420 630400 1                  EPPR0   OPEN_OSYMB
         9 003125   450000 713400                    CLIMB   alt,open
         9 003126   410400 401760                    pmme    nvectors=18
         9 003127   003131 702000 9                  TSX2    A1

     1849    12618    2         GOTO A2;

  12618  9 003130   003137 710000 9                  TRA     A2

  12617  9 003131                       A1           null
     1850    12619    2   A1:   ;
     1851    12620    2         OPEN_OSYMB.V.EXIST#=%NEWFILE#;

  12620  9 003131   000600 236007                    LDQ     384,DL
         9 003132   000464 256000 1                  ORSQ    OPEN_OSYMB+36

     1852    12621    2         CALL M$OPEN (OPEN_OSYMB) ALTRET(A2);

  12621  9 003133   000420 630400 1                  EPPR0   OPEN_OSYMB
         9 003134   450000 713400                    CLIMB   alt,open
         9 003135   410400 401760                    pmme    nvectors=18
         9 003136   003137 702000 9                  TSX2    A2

  12620  9 003137                       A2           null
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:188  
     1853    12622    2   A2:   ;
     1854    12623    2         CALL M$MONINFO (GET_SYMBINFO);          /*   Get symbiont information   */

  12623  9 003137   000000 630400 xsym               EPPR0   GET_SYMBINFO
         9 003140   020023 713400                    CLIMB   8211
         9 003141   402400 401760                    pmme    nvectors=6

     1855    12624    2         FO_BOOTID=FO_SYMBINFO.STREAMFILEID#;

  12624  9 003142   000020 236000 xsym               LDQ     FO_SYMBINFO+16
         9 003143   000043 376000 10                 ANQ     35
         9 003144   000040 276007                    ORQ     32,DL
         9 003145   000000 756000 xsym               STQ     FO_BOOTID

     1856    12625    2         M_FILE1$=DCBADDR(DCBNUM(M$FILE1));

  12625  9 003146   000000 236007 xsym               LDQ     M$FILE1,DL
         9 003147   000044 470400 10                 LDP0    36
         9 003150   000000 471500                    LDP1    0,,PR0
         9 003151   100000 236106                    LDQ     0,QL,PR1
         9 003152   200003 756100                    STQ     M_FILE1$,,AUTO

     1857    12626                                /* MAP Q HEADS & TAILS INTO JOBSTATS WSQ */
     1858    12627    2         CALL M$JOBSTATS (MAP_QHDR);

  12627  9 003153   001020 630400 2                  EPPR0   MAP_QHDR
         9 003154   170001 713400                    CLIMB   61441
         9 003155   405400 401760                    pmme    nvectors=12

     1859    12628                                /* SET UP EVENT TRANSLATION TABLE */
     1860    12629    2         EVXLATE(%CG_TCON#)=FODE_TCON#;

  12629  9 003156   000001 235007                    LDA     1,DL
         9 003157   200035 755100                    STA     EVXLATE+2,,AUTO

     1861    12630    2         EVXLATE(%CG_TDSC#)=FODE_TDSC#;

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:189  
  12630  9 003160   000004 236007                    LDQ     4,DL
         9 003161   200036 756100                    STQ     EVXLATE+3,,AUTO

     1862    12631    2         EVXLATE(%CG_TBRK#)=FODE_TBRK#;

  12631  9 003162   000005 235007                    LDA     5,DL
         9 003163   200037 755100                    STA     EVXLATE+4,,AUTO

     1863    12632    2         EVXLATE(%CG_STDSC#)=FODE_STDSC#;

  12632  9 003164   000007 235007                    LDA     7,DL
         9 003165   200045 755100                    STA     EVXLATE+10,,AUTO

     1864    12633    2         EVXLATE(%CG_STHLD#)=FODE_STHLD#;

  12633  9 003166   000010 235007                    LDA     8,DL
         9 003167   200046 755100                    STA     EVXLATE+11,,AUTO

     1865    12634    2         EVXLATE(%CG_SFERR#)=FODE_SFERR#;

  12634  9 003170   000011 235007                    LDA     9,DL
         9 003171   200047 755100                    STA     EVXLATE+12,,AUTO

     1866    12635    2         EVXLATE(%CG_STERR#)=FODE_STERR#;

  12635  9 003172   000012 235007                    LDA     10,DL
         9 003173   200050 755100                    STA     EVXLATE+13,,AUTO

     1867    12636    2         EVXLATE(%CG_SFEXT#)=FODE_SFEXT#;

  12636  9 003174   000013 235007                    LDA     11,DL
         9 003175   200051 755100                    STA     EVXLATE+14,,AUTO

     1868    12637    2         EVXLATE(%CG_SFSPA#)=FODE_SFSPA#;

  12637  9 003176   000014 235007                    LDA     12,DL
         9 003177   200052 755100                    STA     EVXLATE+15,,AUTO
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:190  

     1869    12638    2         EVXLATE(%CG_STOKN#)=FODE_STOKN#;

  12638  9 003200   000006 235007                    LDA     6,DL
         9 003201   200053 755100                    STA     EVXLATE+16,,AUTO

     1870    12639    2         EVXLATE(%CG_STACK#)=FODE_STACK#;

  12639  9 003202   000017 235007                    LDA     15,DL
         9 003203   200054 755100                    STA     EVXLATE+17,,AUTO

     1871    12640    2         EVXLATE(%CG_TDRQ#)=FODE_TDRQ#;

  12640  9 003204   000021 235007                    LDA     17,DL
         9 003205   200061 755100                    STA     EVXLATE+22,,AUTO

     1872    12641    2         EVXLATE(%CG_FPABORT#)=FODE_FPABRT#;

  12641  9 003206   000022 235007                    LDA     18,DL
         9 003207   200064 755100                    STA     EVXLATE+25,,AUTO

     1873    12642    2         EVXLATE(%CG_FPEXIT#)=FODE_FPEXIT#;

  12642  9 003210   000023 235007                    LDA     19,DL
         9 003211   200063 755100                    STA     EVXLATE+24,,AUTO

     1874    12643                                /* LINK FREE EVENT FRAMES TOGETHER TO
     1875    12644                                   FORM THE FREE EVENT Q FRAME LIST */
     1876    12645    2         EVNT$=ADDR(FO_EVQ(0));

  12645  9 003212   000045 236000 10                 LDQ     37
         9 003213   200014 756100                    STQ     EVNT$,,AUTO

     1877    12646    3           DO I=0 TO FOMI_EVMX#-1;

  12646  9 003214   200004 450100                    STZ     I,,AUTO
         9 003215   003226 710000 9                  TRA     s:12649+3
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:191  

     1878    12647    3           EVNT$->FO$EVNT.LNK$=PINCRW(EVNT$,LENGTHW(FO$EVNT));

  12647  9 003216   200014 236100                    LDQ     EVNT$,,AUTO
         9 003217   000003 036003                    ADLQ    3,DU
         9 003220   200014 470500                    LDP0    EVNT$,,AUTO
         9 003221   000000 756100                    STQ     0,,PR0

     1879    12648    3           EVNT$=EVNT$->FO$EVNT.LNK$;

  12648  9 003222   200014 756100                    STQ     EVNT$,,AUTO

     1880    12649    3           END;

  12649  9 003223   200004 235100                    LDA     I,,AUTO
         9 003224   000001 035007                    ADLA    1,DL
         9 003225   200004 755100                    STA     I,,AUTO
         9 003226   200004 235100                    LDA     I,,AUTO
         9 003227   000012 115007                    CMPA    10,DL
         9 003230   003216 602000 9                  TNC     s:12647

     1881    12650    2         RETURN;

  12650  9 003231   200104 221300                    LDX1  ! FILE_ADDED+2,,AUTO
         9 003232   000001 702211                    TSX2  ! 1,X1
     1882    12651    2   END MISC_SETUP;
     1883    12652        /**/
     1884    12653        /**/
     1885    12654        /**/
     1886    12655    1   END FOO$OUTSYM;

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:192  
--  Include file information  --

   KL_SUPER_C.:E05TOU  is referenced.
   JM$STRUCT.:E05TOU  is referenced.
   JC_MACRO_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   FOS_SUBS_C.:E05TOU  is referenced.
   KC_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   FO_SCODE_C.:E05TOU  is referenced.
   FOM_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   FOO_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FS$FIT.:E05TOU  is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   FO_ERRORS_C.:E05TOU  is referenced.
   FOO_SUBS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   JG_EVID_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FOO$OUTSYM.
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:193  

 **** Variables and constants ****

  ****  Section 001  Data  FOO$OUTSYM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    22-0-0/d CHAR(8)     r     1 DEVNAME                   22-0-0/d STRC(72)    r     1 DEVNAMER
     2-0-0/w SBIN        r     1 GOODNGT                    4-0-0/w SBIN        r     1 HEXPIRE
   133-0-0/w STRC(117)   r     1 HLP_KEY                  362-0-0/d STRC(1080)  r     1 INFO_SYMB
     6-0-0/d CHAR(8)     r     1 KDEVNAME                  10-0-0/w STRC(324)   r     1 LOCKKEYIN
     0-0-0/w SBIN        r     1 NOSTART                  306-0-0/d STRC(432)   r     1 OCMSG_TCON
   544-0-0/d STRC(2088)  r     1 OPEN_FPRG                176-0-0/d STRC(2088)  r     1 OPEN_HLP
   420-0-0/d STRC(2088)  r     1 OPEN_OSYMB                50-0-0/c STRC(891)   r     1 OPMSG_DINFO
    24-0-0/c STRC(297)   r     1 OPMSG_KERR               101-0-0/c STRC(279)   r     1 OPMSG_RINFO
   123-0-0/c STRC(279)   r     1 OPMSG_TCON                35-0-0/c STRC(198)   r     1 OPMSG_TDSC
   111-0-0/c STRC(333)   r     1 OPMSG_TINFO               43-0-0/c STRC(180)   r     1 OPMSG_UNIMP
   152-0-0/d STRC(720)   r     1 OSCGCP                   146-0-0/w STRC(126)   r     1 OSCG_ACCESS
   270-0-0/d STRC(504)   r     1 READ_HLP                 512-0-0/d STRC(504)   r     1 READ_OSYMB
   322-0-0/d STRC(504)   r     1 READ_OSYMB_KEYIN         354-0-0/d STRC(216)   r     1 SLEEP
   530-0-0/d STRC(432)   r     1 THROTTLE_TIME            137-0-0/w UBIN        r     1 THROTTLE_UTS
     3-0-0/w SBIN        r     1 TIMEASLEEP               140-0-0/w STRC(216)   r     1 TTIME
     1-0-0/w SBIN        r     1 UNEXPT                   340-0-0/d STRC(432)   r     1 WRITE_OSYMB

  ****  Section 002 RoData FOO$OUTSYM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   720-0-0/d STRC(576)   r     1 ACT_FPRG                1066-0-0/d STRC(1080)  r     1 CHORG_SYMB
   500-0-0/d STRC(1080)  r     1 CLOSE_FILE1             1150-0-0/d STRC(1080)  r     1 CLOSE_OSYMB
   306-0-0/c STRC(45)    r     1 CSCG                     102-0-0/d STRC(1872)  r     1 CTL_OSCG
   700-0-0/d STRC(576)   r     1 DEACT_DEV                660-0-0/d STRC(576)   r     1 DISCT_DEV
  1222-0-0/d STRC(144)   r     1 EFTPRIV                  166-0-0/d STRC(144)   r     1 EXTEND_OSCG
   536-0-0/c STRC(45)    r     1 HLP_NAME                   0-0-0/w STRC(54)    r     1 JC_PCMP
  1020-0-0/d STRC(1296)  r     1 MAP_QHDR                 740-0-0/w STRC(288)   r     1 MYSTATION
   614-0-0/d STRC(432)   r     1 OCMSG_DINFO              644-0-0/d STRC(432)   r     1 OCMSG_KERR
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:194  
   550-0-0/d STRC(432)   r     1 OCMSG_RINFO              600-0-0/d STRC(432)   r     1 OCMSG_TDSC
   564-0-0/d STRC(432)   r     1 OCMSG_TINFO              630-0-0/d STRC(432)   r     1 OCMSG_UNIMP
   214-0-0/d STRC(2088)  r     1 OPEN_CSCG                 10-0-0/d STRC(2088)  r     1 OPEN_OSCG
   402-0-0/d STRC(2088)  r     1 OPEN_SYMOFD              172-0-0/c STRC(45)    r     1 OSCG
   210-0-0/d STRC(144)   r     1 OSEVENT                 1064-0-0/c STRC(63)    r     1 OSYMBNAME
  1226-0-0/w STRC(432)   r     1 OUTSYMFPRGNAME           174-0-0/w STRC(432)   r     1 OUTSYMNAME
   756-0-0/d STRC(504)   r     1 READ_CSCG                774-0-0/d STRC(504)   r     1 READ_OSCG
   310-0-0/d STRC(2088)  r     1 SCAN_SYMOFD             1124-0-0/d STRC(432)   r     1 SEND_PCMP
   750-0-0/d STRC(216)   r     1 SLEEP1                  1140-0-0/w STRC(288)   r     1 SLUGNAME
   474-0-0/c STRC(72)    r     1 SYMOACCT                 476-0-0/c STRC(72)    r     1 SYSACCT
   540-0-0/d STRC(144)   r     1 TRUNC_HLP                544-0-0/d STRC(144)   r     1 TRUNC_OSYMB
  1206-0-0/d STRC(432)   r     1 WRITE_ZAPRESP           1012-0-0/d STRC(216)   r     1 XCONSET
     2-0-0/c STRC(180)   r     1 ZAPRESP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    17-0-0/w UBIN        r     1 BATCHFLG                 100-0-0/w UBIN        r     1 BLK#
   100-0-0/w SBIN        r     1 BLK#R                     76-0-0/w PTR         r     1 CGAURD$
    77-0-0/w PTR         r     1 CITE$                     73-0-0/w UBIN        r     1 DEVENT
    14-0-0/w PTR         r     1 EVNT$                     33-0-0/w UBIN        r     1 EVXLATE(0:30)
    26-0-0/w PTR         r     1 EXT$                     102-0-0/b BIT         r     1 FILE_ADDED
    22-0-0/w CHAR(3)     r     1 FIL_BOOTID                25-0-0/w UBIN        r     1 FIL_CNUM
    24-0-0/w UBIN        r     1 FIL_NUM                   24-0-0/w SBIN        r     1 FIL_NUMR
    23-0-0/w UBIN        r     1 FIL_SYSID                  4-0-0/w UBIN        r     1 I
    72-0-0/w UBIN        r     1 INFO                       4-0-0/w SBIN        r     1 IR
     5-0-0/w UBIN        r     1 J                         27-0-0/w UBIN        r     1 JOB_SYSID
    16-0-0/w PTR         r     1 KEYIN$                     3-0-0/w PTR         r     1 M_FILE1$
    74-0-0/w UBIN        r     1 NDEV                      32-0-0/w PTR         r     1 NXTFIL$
   105-0-0/w STRC(171)   r     1 OSFNAME                   11-0-0/w PTR         r     1 OSYMB$
   101-0-0/w UBIN        r     1 PG#                       31-0-0/w UBIN        r     1 SPILLDISP
    12-0-0/w UBIN        r     1 TALLY                      6-0-0/w PTR         r     1 WSN$
     7-0-0/w PTR         r     1 WSNDEV$                   10-0-0/w PTR         r     1 WSN_LNK$

  ****  SYMREF variables  ****
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:195  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w CHAR(3)     r     1 FO_BOOTID                  0-0-0/d CHAR(140)   r     1 FO_CSCGBUF
     0-0-0/w PTR         r     1 FO_DEV$                    0-0-0/w STRC(288)   r     1 FO_DEVSCB
     0-0-0/w STRC(657)   r     1 FO_DEV_INIT                0-0-0/w PTR         r     1 FO_EVHD$
     0-0-0/w STRC(108)   r     1 FO_EVQ(0:10)               0-0-0/w PTR         r     1 FO_EVTL$
     0-0-0/w PTR         r     1 FO_FEVHD$                  0-0-0/w PTR         r     1 FO_FEVTL$
     0-0-0/w PTR         r     1 FO_FIL$                    0-0-0/w STRC(171)   r     1 FO_FILENAME
     0-0-0/w UBIN        r     1 FO_FITBUF1(0:2047)
     0-0-0/w PTR         r     1 FO_JOB$                    0-0-0/d CHAR(100)   r     1 FO_OSCGBUF
     0-0-0/w STRC(81)    r     1 FO_OSYMBKEY                0-0-0/w STRC(333)   r     1 FO_OSYMBKEYIN
     0-0-0/w STRC        r     1 FO_OSYMBKEYROUTE           0-0-0/w STRC(21600) r     1 FO_OSYMBUF
     0-0-0/d STRC(1512)  r     1 FO_Q                       0-0-0/w STRC(1152)  r     1 FO_SYMBINFO
     0-0-0/w STRC(396)   r     1 FO_WSN_INIT                0-0-0/d STRC(432)   r     1 GET_SYMBINFO

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(648)   r     1 B$CGAURD
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(657)   r     1 FO$DEV                     0-0-0/w STRC(324)   r     1 FO$DKEYIN
     0-0-0/w STRC(108)   r     1 FO$EVNT                    0-0-0/w STRC(1332)  r     1 FO$FIL
     0-0-0/w ASTR(351)   r     1 FO$JOB                     0-0-0/w STRC(90)    r     1 FO$JOBEV
     0-0-0/w STRC(972)   r     1 FO$MBSEV                   0-0-0/w STRC(144)   r     1 FO$SYEV
     0-0-0/w STRC(396)   r     1 FO$WSN                     0-0-0/w STRC(171)   r     1 FS$OSFN
     0-0-0/w STRC(108)   r     1 KL_WSNDEV                  0-0-0N  NULL        r     1 M$CSCG
     0-0-0N  NULL        r     1 M$FILE1                    0-0-0N  NULL        r     1 M$FPRG
     0-0-0N  NULL        r     1 M$HLP                      0-0-0N  NULL        r     1 M$OSCG
     0-0-0N  NULL        r     1 M$OSYMB

PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:196  

   Procedure FOO$OUTSYM requires 1691 words for executable code.
   Procedure FOO$OUTSYM requires 80 words of local(AUTO) storage.

    No errors detected in file FOO$OUTSYM.:E05TSI    .
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:197  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:198  
          MINI XREF LISTING

A1 IN PROCEDURE MISC_SETUP
     12617**LABEL   12617--CALLALT
A10 IN PROCEDURE ADD_DEV
     12328**LABEL   12268--GOTO
A11 IN PROCEDURE EXT_EVENT
     11682**LABEL   11676--CALLALT
A2 IN PROCEDURE MISC_SETUP
     12620**LABEL   12618--GOTO    12621--CALLALT
A4 IN PROCEDURE ADD_DEV
     12364**LABEL   12362--CALLALT
A9 IN PROCEDURE ADD_DEV
     12199**LABEL   12199--CALLALT
ACT_FPRG
     10599**DCL     11642<>CALL
ACT_FPRG.V
     10600**DCL     10599--DCLINIT
ACT_FPRG.V.DVBYTE.REREAD#
     10602**DCL     10602--REDEF
ADD_DEV
     12198**PROC    11623--CALL
ALREADY_DEACT IN PROCEDURE EXT_EVENT
     11623**LABEL   11621--CALLALT
B$ALT.CODE
      8369**DCL      8369--REDEF    8370--REDEF    8370--REDEF
B$ALT.ERR.CODE
      8371**DCL     12288>>IF      12565>>IF
B$ALT.ERR.ERR#
      8371**DCL      8371--REDEF
B$ALT.EVID
      8370**DCL      8370--REDEF    8370--REDEF
B$CGAURD.CONINFO.ATTR
      8463**DCL      8463--REDEF   12220>>ASSIGN
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:199  
B$CGAURD.CONINFO.WHO.ACCT
      8461**DCL     12222>>ASSIGN
B$CGAURD.EVENT
      8441**DCL     11606>>DOCASE  11678>>ASSIGN  11682>>IF      11682>>IF
B$CGAURD.FOINFO.FNAME
      8489**DCL      8492--REDEF    8493--REDEF
B$CGAURD.FOINFO.FORM
      8492**DCL     12262>>ASSIGN  12281>>ASSIGN
B$CGAURD.FOINFO.FORMR
      8493**DCL     12260>>IF      12279>>IF
B$CGAURD.FOINFO.TNAME
      8495**DCL     12336>>ASSIGN
B$CGAURD.FOINFO.UPLOCKED
      8486**DCL     12266>>ASSIGN  12285>>ASSIGN
B$CGAURD.INFO
      8442**DCL     11677>>ASSIGN
B$CGAURD.STATION
      8441**DCL      8441--REDEF   11605>>ASSIGN
B$JIT.ERR.MID
      8681**DCL      8681--REDEF
B$JIT$
      9143**DCL      8675--IMP-PTR
B$TCB.ALT$
      8365**DCL     12288>>IF      12565>>IF
B$TCB$
      9142**DCL      8365--IMP-PTR 12288>>IF      12565>>IF
BATCHFLG
      8785**DCL     12048<<ASSIGN  12050<>CALL
BLK#
      8808**DCL      8809--REDEF   11877<<ASSIGN  11878<<ASSIGN  11878>>ASSIGN  11880>>ASSIGN
BLK#R
      8809**DCL     11879>>IF
CA2
     11502**LABEL   11504--CALLALT
CGAURD$
      8806**DCL     11604<<ASSIGN  11605>>ASSIGN  11606>>DOCASE  11677>>ASSIGN  11678>>ASSIGN  11682>>IF
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:200  
     11682>>IF      12220>>ASSIGN  12222>>ASSIGN  12260>>IF      12262>>ASSIGN  12266>>ASSIGN  12279>>IF
     12281>>ASSIGN  12285>>ASSIGN  12336>>ASSIGN
CHORG_SYMB
     11037**DCL     12277<>CALL
CHORG_SYMB.V
     11041**DCL     11037--DCLINIT
CITE$
      8807**DCL     11592<<ASSIGN  11717>>ASSIGN  11718>>ASSIGN  11719>>ASSIGN  11747>>ASSIGN  12037>>ASSIGN
     12047>>ASSIGN  12048>>ASSIGN  12049>>ASSIGN  12057>>ASSIGN  12058>>ASSIGN  12059>>ASSIGN  12068>>ASSIGN
     12069>>ASSIGN  12077>>ASSIGN  12078>>ASSIGN  12087>>ASSIGN  12095>>DOINDEX 12096>>ASSIGN  12105>>ASSIGN
     12106>>ASSIGN  12114>>CALL
CLOSE_FILE1
      9971**DCL     12549<>CALL    12556<>CALL
CLOSE_FILE1.SN_
      9971**DCL      9971--REDEF
CLOSE_FILE1.UTL_
      9972**DCL      9972--REDEF
CLOSE_FILE1.V
      9976**DCL      9971--DCLINIT
CLOSE_FILE1.V.EXPIRE#
      9986**DCL      9986--REDEF
CLOSE_FILE1.V.TYPE#
      9984**DCL      9984--REDEF
CLOSE_FILE1.V.XTNSIZE#
      9981**DCL      9981--REDEF    9983--REDEF
CLOSE_OSYMB
     11140**DCL     11504<>CALL
CLOSE_OSYMB.SN_
     11140**DCL     11140--REDEF
CLOSE_OSYMB.UTL_
     11141**DCL     11141--REDEF
CLOSE_OSYMB.V
     11145**DCL     11140--DCLINIT
CLOSE_OSYMB.V.EXPIRE#
     11155**DCL     11155--REDEF
CLOSE_OSYMB.V.TYPE#
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:201  
     11153**DCL     11153--REDEF
CLOSE_OSYMB.V.XTNSIZE#
     11150**DCL     11150--REDEF   11152--REDEF
CSCG
      9676**DCL      9606--DCLINIT
CTL_OSCG
      9427**DCL     11435<>CALL    11634<>CALL
CTL_OSCG.V
      9432**DCL      9427--DCLINIT
DEACT_DEV
     10573**DCL     11621<>CALL
DEACT_DEV.V
     10574**DCL     10573--DCLINIT
DEACT_DEV.V.DVBYTE.REREAD#
     10576**DCL     10576--REDEF
DEVENT
      8803**DCL     11678<<ASSIGN  11679<>CALL
DEVNAME
      8858**DCL      8859--REDEF   10547--DCLINIT 10573--DCLINIT 11039--DCLINIT 11605<<ASSIGN  11765<<ASSIGN
     11776>>ASSIGN  11823<<ASSIGN  11974<<ASSIGN  12219>>ASSIGN  12360>>ASSIGN  12449>>IF
DEVNAMER.NUM
      8861**DCL     11837>>IF
DEVNAMER.TYP
      8860**DCL     11837>>IF      11837>>IF      11957>>IF
DEVSCHED IN PROCEDURE EXT_EVENT
     11737**LABEL   11679--CALLALT 11767--CALLALT 11784--GOTO    11806--GOTO    11980--GOTO    12061--GOTO
DEV_TO_OSYMB
     12378**PROC    12345--CALL
DISCT_DEV
     10547**DCL     12362<>CALL
DISCT_DEV.V
     10548**DCL     10547--DCLINIT
DISCT_DEV.V.DVBYTE.REREAD#
     10550**DCL     10550--REDEF
DISPLAY_ROUTE
     12411**PROC    12346--CALL
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:202  
DONE IN PROCEDURE GET_FILES
     12585**LABEL   12556--CALLALT 12557--GOTO
DRIVE_DEVS
     12463**PROC    11737--CALL    12030--CALL    12080--CALL
EFTPRIV
     11206**DCL     11422<>CALL
EFTPRIV.V
     11206**DCL     11206--DCLINIT
ENDEVENT IN PROCEDURE EXT_EVENT
     12144**LABEL   11624--GOTO    11646--GOTO    11653--GOTO    11680--GOTO    11683--GOTO    11768--GOTO
     11787--GOTO    11949--GOTO    12038--CALLALT
EVNT$
      8782**DCL     11528<<ASSIGN  11529>>ASSIGN  11534>>DOCASE  11544>>ASSIGN  11545>>ASSIGN  11547>>ASSIGN
     11549>>ASSIGN  11592>>ASSIGN  11593>>DOCASE  12645<<ASSIGN  12647>>ASSIGN  12647>>ASSIGN  12648<<ASSIGN
     12648>>ASSIGN
EVXLATE
      8798**DCL     11678>>ASSIGN  12629<<ASSIGN  12630<<ASSIGN  12631<<ASSIGN  12632<<ASSIGN  12633<<ASSIGN
     12634<<ASSIGN  12635<<ASSIGN  12636<<ASSIGN  12637<<ASSIGN  12638<<ASSIGN  12639<<ASSIGN  12640<<ASSIGN
     12641<<ASSIGN  12642<<ASSIGN
EXT$
      8793**DCL     11591<<ASSIGN
EXTEND_OSCG
      9453**DCL     11631<>CALL
EXTEND_OSCG.V
      9453**DCL      9453--DCLINIT
EXT_EVENT
     11588**PROC    11533--CALL
F$DCB.ACTPOS
       160**DCL       160--REDEF
F$DCB.ARS
       135**DCL       135--REDEF
F$DCB.ATTR
       153**DCL       154--REDEF
F$DCB.BORROW
       168**DCL       168--REDEF     168--REDEF     168--REDEF
F$DCB.DCBNAME.L
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:203  
       182**DCL       182--IMP-SIZ
F$DCB.EOMCHAR
       139**DCL       139--REDEF
F$DCB.FLDID
       163**DCL       163--REDEF
F$DCB.FORM$
       157**DCL       157--REDEF
F$DCB.FSECT
       173**DCL       173--REDEF
F$DCB.FSN
       150**DCL       150--REDEF     150--REDEF     151--REDEF
F$DCB.HEADER$
       156**DCL       156--REDEF
F$DCB.IXTNSIZE
       154**DCL       154--REDEF
F$DCB.LASTSTA$
       144**DCL       144--REDEF
F$DCB.LVL
       169**DCL       169--REDEF
F$DCB.NAME
       144**DCL     12544--ASSIGN  12545--IF      12545--IF      12559--CALLBLT 12560--CALLBLT 12561--CALLBLT
     12567--ASSIGN  12571--IF      12573--ASSIGN
F$DCB.NAME.C
       144**DCL       144--REDEF
F$DCB.NAME.L
       144**DCL     12545>>IF
F$DCB.NOEOF
       165**DCL       165--REDEF
F$DCB.NRECS
       155**DCL       155--REDEF
F$DCB.NRECX
       174**DCL       174--REDEF
F$DCB.OHDR
       166**DCL       166--REDEF
F$DCB.ORG
       149**DCL       149--REDEF
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:204  
F$DCB.PRECNO
       172**DCL       172--REDEF
F$DCB.RCSZ
       177**DCL       177--REDEF
F$DCB.RES
       145**DCL       145--REDEF
F$DCB.SETX
       157**DCL       157--REDEF
F$DCB.TAB$
       156**DCL       157--REDEF
F$DCB.TDA
       171**DCL       171--REDEF
F$DCB.WSN
       146**DCL       146--REDEF
FILE_ADDED
      8811**DCL     11725<<ASSIGN  11728<<ASSIGN  11736>>IF
FIL_BOOTID
      8788**DCL     12544<<ASSIGN  12552>>IF      12562<>CALL
FIL_CNUM
      8792**DCL     11719<<ASSIGN  11723<>CALL    12070<>CALL    12561<<CALLBLT 12562<>CALL
FIL_NUM
      8790**DCL      8791--REDEF   11718<<ASSIGN  11723<>CALL    12050<>CALL    12058<<ASSIGN  12060<>CALL
     12069<<ASSIGN  12070<>CALL    12079<>CALL    12106<<ASSIGN  12107<>CALL    12560<<CALLBLT 12562<>CALL
FIL_NUMR
      8791**DCL     12049<<ASSIGN  12078<<ASSIGN
FIL_SYSID
      8789**DCL     11717<<ASSIGN  11723<>CALL    12047<<ASSIGN  12050<>CALL    12057<<ASSIGN  12060<>CALL
     12068<<ASSIGN  12070<>CALL    12077<<ASSIGN  12079<>CALL    12087<<ASSIGN  12088<>CALL    12096<<ASSIGN
     12097<>CALL    12105<<ASSIGN  12107<>CALL    12559<<CALLBLT 12562<>CALL
FIND_DEV
     12445**PROC    11676--CALL    11766--CALL    11975--CALL    12199--CALL
FO$CONINFO.FNAME
      8417**DCL      8420--REDEF    8421--REDEF
FO$DEV
      1870**DCL     12216<<ASSIGN  12381>>ASSIGN
FO$DEV.CFIL$
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:205  
      1880**DCL     11878>>ASSIGN  11882>>ASSIGN  11887>>IF      11893>>IF      11895>>ASSIGN
FO$DEV.FLG.ALGNED
      1916**DCL     11870>>ASSIGN
FO$DEV.FLG.LOCAL
      1908**DCL     12288<<ASSIGN
FO$DEV.FLG.LOCK
      1933**DCL     11867>>ASSIGN  11991>>IF      12266<<ASSIGN  12273<<ASSIGN  12285<<ASSIGN
FO$DEV.FLG.SIP
      1929**DCL     11845>>ASSIGN
FO$DEV.FORM
      1946**DCL     11869>>ASSIGN  12262<<ASSIGN  12264<<ASSIGN  12274<<ASSIGN  12281<<ASSIGN  12283<<ASSIGN
     12291<>CALL
FO$DEV.LNK$
      1876**DCL     11497>>ASSIGN  11946>>ASSIGN  12001>>ASSIGN  12217<<ASSIGN  12450>>ASSIGN  12471>>ASSIGN
FO$DEV.NAME
      1884**DCL      1885--REDEF   11843>>ASSIGN  11875>>ASSIGN  11993>>ASSIGN  12219<<ASSIGN  12256>>ASSIGN
     12393>>ASSIGN  12417>>ASSIGN  12449>>IF
FO$DEV.NAMER.NUM
      1887**DCL     11837>>IF
FO$DEV.NAMER.TYP
      1886**DCL     11837>>IF
FO$DEV.NATTR
      1891**DCL     12220<<ASSIGN
FO$DEV.RACCT
      1952**DCL      1953--REDEF   11848>>IF      11857>>ASSIGN
FO$DEV.RACCTL
      1940**DCL     11854>>IF
FO$DEV.RWSN
      1953**DCL     11863>>ASSIGN
FO$DEV.STATE
      1893**DCL     11496>>IF      11844>>ASSIGN  11873>>IF      11996>>IF      11996>>IF      12000<<ASSIGN
     12469>>IF
FO$DEV.SUSRSN
      1895**DCL     11868>>ASSIGN
FO$DEV.TNAME
      1890**DCL     11833>>IF      11833>>IF      12336<<ASSIGN
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:206  
FO$DEV.WSN$
      1883**DCL     11906>>ASSIGN  12233<<ASSIGN  12299>>ASSIGN  12349>>ASSIGN  12383>>ASSIGN  12413>>ASSIGN
FO$DKEYIN.CADDR
      1783**DCL     11775>>ASSIGN  11824>>ASSIGN  11825>>ASSIGN  11826>>ASSIGN  12010>>ASSIGN
FO$DKEYIN.CHKP
      1791**DCL      1792--REDEF
FO$DKEYIN.DEVNM
      1784**DCL      1785--REDEF   11765>>ASSIGN  11823>>ASSIGN  11974>>ASSIGN
FO$DKEYIN.KIN#
      1782**DCL     11748>>DOCASE  11903>>IF      11903>>IF      11934>>IF      11934>>IF      11950>>IF
FO$DKEYIN.TNAME
      1796**DCL      1797--REDEF    1798--REDEF   11816>>ASSIGN  11833>>IF      11833>>IF      11955>>ASSIGN
FO$EVNT
      1968**DCL     12647--ASSIGN
FO$EVNT.CITE$
      1972**DCL     11592>>ASSIGN
FO$EVNT.CODE
      1970**DCL     11593>>DOCASE
FO$EVNT.ENDAC
      1971**DCL     11534>>DOCASE
FO$EVNT.LNK$
      1969**DCL     11529>>ASSIGN  11545<<ASSIGN  11549<<ASSIGN  12647<<ASSIGN  12648>>ASSIGN
FO$FIL.DEST
      2020**DCL      2021--REDEF
FO$FIL.FLG.CONCUR
      2041**DCL     11899>>ASSIGN
FO$FIL.FLG.GLC
      2046**DCL     12588<<ASSIGN  12600<<ASSIGN
FO$FIL.FLG.PAGES
      2044**DCL     11887>>IF
FO$FIL.GRANS
      2038**DCL     11878>>ASSIGN
FO$FIL.LNK$
      2010**DCL     12587>>ASSIGN  12603>>ASSIGN
FO$FIL.NUM
      2034**DCL     11897>>ASSIGN
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:207  
FO$FIL.OJOB$
      2016**DCL     11898>>ASSIGN  12602>>ASSIGN
FO$FIL.PAGES
      2072**DCL     11882>>ASSIGN
FO$FIL.SYSID
      2032**DCL     11896>>ASSIGN  12601>>IF
FO$FKEYIN.ACCT
      1825**DCL      1826--REDEF
FO$FKEYIN.NOTFORM
      1821**DCL      1822--REDEF
FO$JOB.ACCT
      2126**DCL     11898>>ASSIGN
FO$JOB.FLG.JOFF
      2118**DCL     12039<<ASSIGN  12602<<ASSIGN
FO$JOB.JNL
      2132**DCL      2139--IMP-SIZ
FO$JOB.NFIL
      2115**DCL     12040>>IF
FO$JOB.NFIL_DONE
      2125**DCL     12040>>IF
FO$JOBEV.BATCH
      8521**DCL      8524--REDEF    8528--REDEF   12048>>ASSIGN
FO$JOBEV.CNUM
      8536**DCL     11719>>ASSIGN
FO$JOBEV.DISP
      8524**DCL     12059>>ASSIGN
FO$JOBEV.NUM
      8530**DCL      8533--REDEF   11718>>ASSIGN  12058>>ASSIGN  12069>>ASSIGN  12106>>ASSIGN
FO$JOBEV.NUMR
      8533**DCL     12049>>ASSIGN  12078>>ASSIGN
FO$JOBEV.SYSID
      8519**DCL     11717>>ASSIGN  12037>>ASSIGN  12047>>ASSIGN  12057>>ASSIGN  12068>>ASSIGN  12077>>ASSIGN
     12087>>ASSIGN  12105>>ASSIGN
FO$MBSEV.JOBS
      8599**DCL     12096>>ASSIGN
FO$MBSEV.NJOBS
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:208  
      8597**DCL     12095>>DOINDEX
FO$RKEYIN.DEVNM
      1848**DCL      1849--REDEF
FO$SYEV
      8629**DCL     12114<>CALL
FO$WSN
      2156**DCL     12234<<ASSIGN  12243<<ASSIGN
FO$WSN.LNK$
      2163**DCL     11930>>ASSIGN  12242<<ASSIGN  12310>>ASSIGN  12325<<ASSIGN  12326<<ASSIGN  12351>>ASSIGN
     12390>>ASSIGN  12431>>ASSIGN
FO$WSN.NWSNS
      2165**DCL     11908>>DOINDEX 12251<<ASSIGN  12251>>ASSIGN  12301>>DOINDEX 12316>>IF      12318<<ASSIGN
     12318>>ASSIGN  12319>>ASSIGN  12327<<ASSIGN  12328>>ASSIGN  12385>>ASSIGN  12386>>DOINDEX 12415>>DOINDEX
FO$WSN.WSN
      2167**DCL     12305<<ASSIGN  12319<<ASSIGN  12328<<ASSIGN  12387>>ASSIGN
FO$WSN.WSN.ADD_ON
      2178**DCL     12248<<ASSIGN  12425>>IF
FO$WSN.WSN.NOT_USED
      2174**DCL     11909>>IF      12249<<ASSIGN
FO$WSN.WSN.ORIGINAL
      2172**DCL     11912>>IF      12247<<ASSIGN
FO$WSN.WSN.ROUTED_OUT
      2176**DCL     11914>>IF      12250<<ASSIGN  12419>>IF
FO$WSN.WSN.WSN_NAME
      2169**DCL     11911>>ASSIGN  12246<<ASSIGN  12302>>IF      12416>>ASSIGN
FOD$EVENT
      9144**DCL-ENT 11679--CALL    11767--CALL    11994--CALL    11999--CALL    12339--CALL    12470--CALL
FOD$FSCHK
      9145**DCL-ENT 11522--CALL
FOE$EVNT
      9146**DCL-ENT  9531--DCLINIT
FOE$XCON
      9147**DCL-ENT 10774--DCLINIT
FOF$ADD
      9148**DCL-ENT 11723--CALL    12562--CALL
FOF$CANCEL
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:209  
      9149**DCL-ENT 12050--CALL
FOF$CHAIN
      9150**DCL-ENT 12591--CALL
FOF$COMPJOB
      9151**DCL-ENT 12040--CALL
FOF$ERASE
      9152**DCL-ENT 12107--CALL
FOF$FILL
      9153**DCL-ENT 12070--CALL
FOF$FINDJOB
      9154**DCL-ENT 12038--CALL
FOF$HEXPIRE
      9155**DCL-ENT 11485--CALL
FOF$KEYIN
      9156**DCL-ENT 11805--CALL
FOF$PRIO
      9157**DCL-ENT 12590--CALL
FOF$RERUN
      9158**DCL-ENT 12088--CALL    12097--CALL
FOF$SPILLDONE
      9159**DCL-ENT 12060--CALL
FOF$UNCHAIN
      9160**DCL-ENT 12589--CALL
FOF$UNHOLD
      9161**DCL-ENT 12079--CALL
FOI$CRASHGO
      9162**DCL-ENT 12133--CALL
FOI$GBUF
      9163**DCL-ENT 12215--CALL    12232--CALL    12241--CALL    12324--CALL
FOI$RBUF
      9164**DCL-ENT 12352--CALL    12356--CALL
FOI$SNAP
      9165**DCL-ENT 11684--CALL    11697--CALL    12201--CALL
FOR$CLOSE
      9166**DCL-ENT 11503--CALL
FOR$GETMODE
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:210  
      9168**DCL-ENT 12291--CALL
FOR$KEYIN
      9167**DCL-ENT 11979--CALL
FOU$EVENT
      9169**DCL-ENT 11782--CALL
FO_BOOTID
      2203**DCL     11723<>CALL    12070<>CALL    12552>>IF      12624<<ASSIGN
FO_CSCGBUF
      2201**DCL     10696--DCLINIT 10697--DCLINIT
FO_DEV$
      2203**DCL     11494<<ASSIGN  11495>>DOWHILE 11496>>IF      11497<<ASSIGN  11497>>ASSIGN  11590<<ASSIGN
     11831<<ASSIGN  11832>>DOWHILE 11833>>IF      11833>>IF      11837>>IF      11837>>IF      11843>>ASSIGN
     11844>>ASSIGN  11845>>ASSIGN  11848>>IF      11854>>IF      11857>>ASSIGN  11863>>ASSIGN  11867>>ASSIGN
     11868>>ASSIGN  11869>>ASSIGN  11870>>ASSIGN  11873>>IF      11875>>ASSIGN  11878>>ASSIGN  11882>>ASSIGN
     11887>>IF      11893>>IF      11895>>ASSIGN  11906>>ASSIGN  11946<<ASSIGN  11946>>ASSIGN  11977<<ASSIGN
     11989<<ASSIGN  11990>>DOWHILE 11991>>IF      11993>>ASSIGN  11996>>IF      11996>>IF      12000>>ASSIGN
     12001<<ASSIGN  12001>>ASSIGN  12215<>CALL    12216>>ASSIGN  12217>>ASSIGN  12218>>ASSIGN  12219>>ASSIGN
     12220>>ASSIGN  12233>>ASSIGN  12256>>ASSIGN  12262>>ASSIGN  12264>>ASSIGN  12266>>ASSIGN  12273>>ASSIGN
     12274>>ASSIGN  12281>>ASSIGN  12283>>ASSIGN  12285>>ASSIGN  12288>>ASSIGN  12291>>CALL    12299>>ASSIGN
     12336>>ASSIGN  12349>>ASSIGN  12356<>CALL    12381>>ASSIGN  12383>>ASSIGN  12393>>ASSIGN  12413>>ASSIGN
     12417>>ASSIGN  12447<<ASSIGN  12448>>DOWHILE 12449>>IF      12450<<ASSIGN  12450>>ASSIGN  12466<<ASSIGN
     12468>>DOWHILE 12469>>IF      12471<<ASSIGN  12471>>ASSIGN
FO_DEVSCB
      2789**DCL     12215<>CALL    12232<>CALL    12241<>CALL    12324<>CALL    12352<>CALL    12356<>CALL
FO_DEV_INIT
      2536**DCL     12216>>ASSIGN
FO_DEV_INIT.NAME
      2550**DCL      2551--REDEF
FO_DEV_INIT.RACCT
      2618**DCL      2619--REDEF
FO_EVHD$
      2201**DCL     11473>>IF      11528>>ASSIGN  11529<<ASSIGN  11530>>IF
FO_EVQ
      2719**DCL     12645--ASSIGN
FO_EVTL$
      2202**DCL     11530<<ASSIGN
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:211  
FO_FEVHD$
      2202**DCL     11544<<ASSIGN
FO_FEVTL$
      2202**DCL     11544>>IF      11545>>ASSIGN  11547<<ASSIGN
FO_FIL$
      2202**DCL     11589<<ASSIGN  11895<<ASSIGN  11896>>ASSIGN  11897>>ASSIGN  11898>>ASSIGN  11899>>ASSIGN
     12585<<ASSIGN  12586>>DOWHILE 12587>>ASSIGN  12588>>ASSIGN  12592<<ASSIGN  12598<<ASSIGN  12599>>DOWHILE
     12600>>ASSIGN  12601>>IF      12602>>ASSIGN  12603<<ASSIGN  12603>>ASSIGN
FO_FILENAME.CNT
      2246**DCL     12545>>IF
FO_FIL_INIT.DEST
      2447**DCL      2448--REDEF
FO_FITBUF1
      2201**DCL      9757--DCLINIT  9875--DCLINIT 10161--DCLINIT 10162--DCLINIT 12230--ASSIGN
FO_JOB$
      2203**DCL     12039>>ASSIGN  12040>>IF      12040>>IF
FO_OSCGBUF
      2201**DCL     10740--DCLINIT 10741--DCLINIT 11604--ASSIGN
FO_OSYMBKEY
      2249**DCL     10382--DCLINIT 11000--DCLINIT 11001--DCLINIT
FO_OSYMBKEY.LEN
      2249**DCL     12255<<ASSIGN
FO_OSYMBKEY.NAME
      2249**DCL     12256<<ASSIGN  12393<<ASSIGN
FO_OSYMBKEYIN
      2263**DCL     10340--DCLINIT 10341--DCLINIT
FO_OSYMBKEYIN.DEVNM
      2268**DCL      2269--REDEF
FO_OSYMBKEYROUTE
      2249**DCL     10338--DCLINIT 10339--DCLINIT
FO_OSYMBUF
      2281**DCL     10383--DCLINIT 10384--DCLINIT 11002--DCLINIT 11003--DCLINIT 12272--ASSIGN
FO_OSYMBUF.FO_OSYMBDEV
      2299**DCL     12381<<ASSIGN  12394--ASSIGN
FO_OSYMBUF.FO_OSYMBDEV.FLG.LOCK
      2359**DCL     12273>>ASSIGN
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:212  
FO_OSYMBUF.FO_OSYMBDEV.FORM
      2372**DCL     12274>>ASSIGN
FO_OSYMBUF.FO_OSYMBDEV.NAME
      2310**DCL      2311--REDEF
FO_OSYMBUF.FO_OSYMBDEV.RACCT
      2378**DCL      2379--REDEF
FO_OSYMBUF.FO_OSYMBWSN.LNK$
      2402**DCL     12394--ASSIGN
FO_OSYMBUF.FO_OSYMBWSN.NWSNS
      2404**DCL     12293>>DOINDEX 12392<<ASSIGN  12394--ASSIGN  12394>>ASSIGN
FO_OSYMBUF.FO_OSYMBWSN.WSN
      2406**DCL     12305>>ASSIGN  12319>>ASSIGN  12328>>ASSIGN  12387<<ASSIGN
FO_OSYMBUF.FO_OSYMBWSN.WSN.ADD_ON
      2417**DCL     12314>>IF
FO_OSYMBUF.FO_OSYMBWSN.WSN.NOT_USED
      2413**DCL     12295>>IF
FO_OSYMBUF.FO_OSYMBWSN.WSN.WSN_NAME
      2408**DCL     12302>>IF
FO_Q
      2738**DCL     10791--DCLINIT
FO_Q.DEVHD$
      2741**DCL     11494>>ASSIGN  11831>>ASSIGN  11989>>ASSIGN  12217>>ASSIGN  12218<<ASSIGN  12447>>ASSIGN
     12466>>ASSIGN
FO_Q.FILHD$
      2743**DCL     12585>>ASSIGN  12598>>ASSIGN
FO_Q.LOCK
      2739**DCL     11721<<ASSIGN  11721>>ASSIGN  11731<<ASSIGN  11731>>ASSIGN
FO_Q.RCVR
      2740**DCL     11442<<ASSIGN
FO_SYMBINFO.STREAMFILEID#
      2231**DCL     12624>>ASSIGN
FO_WSN_INIT
      2635**DCL     12234>>ASSIGN  12243>>ASSIGN
FS$OSFN
      8386**DCL     12567>>ASSIGN  12571>>IF      12573>>ASSIGN
FS$OSFN.BOOTID
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:213  
      8386**DCL     12544>>ASSIGN
FS$OSFN.CNUM
      8387**DCL     12561>>CALLBLT
FS$OSFN.NUM
      8387**DCL     12560>>CALLBLT
FS$OSFN.SYSID
      8386**DCL     12545>>IF      12545>>IF      12559>>CALLBLT
GET_FILES
     12522**PROC    11440--CALL
GET_SYMBINFO
      2215**DCL     12623<>CALL
GFILE1 IN PROCEDURE GET_FILES
     12542**LABEL   12549--CALLALT 12550--GOTO    12563--GOTO
GFILE11 IN PROCEDURE GET_FILES
     12539**LABEL   12540--GOTO    12569--GOTO
GFILE2 IN PROCEDURE GET_FILES
     12565**LABEL   12539--CALLALT 12542--CALLALT 12574--GOTO
GFILE3 IN PROCEDURE GET_FILES
     12567**LABEL   12568--CALLALT
GOODNGT
      8820**DCL     11475>>IF      11489>>IF      11502<<ASSIGN  11532>>IF      11987<<ASSIGN
HEXPIRE
      8822**DCL     11480<<ASSIGN  11480>>ASSIGN  11481>>IF      11483<<ASSIGN
HLP_KEY
      9125**DCL     10159--DCLINIT 10160--DCLINIT
HLP_KEY.DEVLGN
      9127**DCL     12222<<ASSIGN
HLP_NAME
     10135**DCL     10065--DCLINIT
I
      8773**DCL      8774--REDEF   11493<<ASSIGN  11496<<ASSIGN  11499>>IF      11908<<DOINDEX 11909>>IF
     11911>>ASSIGN  11912>>IF      11914>>IF      12096>>ASSIGN  12236<<DOINDEX 12246>>ASSIGN  12293<<DOINDEX
     12295>>IF      12302>>IF      12305>>ASSIGN  12314>>IF      12319>>ASSIGN  12328>>ASSIGN  12386<<DOINDEX
     12387>>ASSIGN  12415<<DOINDEX 12416>>ASSIGN  12419>>IF      12425>>IF      12597<<DOINDEX 12598>>ASSIGN
     12646<<DOINDEX
IGN$SYSID
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:214  
      9170**DCL-ENT 12114--CALL
INFO
      8799**DCL      8800--REDEF   11677<<ASSIGN  11679<>CALL
INFO_SYMB
     10815**DCL     11876<>CALL
INFO_SYMB.V
     10819**DCL     10815--DCLINIT
INFO_SYMB.V.BLKREC.BLK#
     10823**DCL     11877>>ASSIGN
INFO_SYMB.V.PGDONE#
     10824**DCL     11881>>ASSIGN
INFO_SYMB.V.THROTTLE_CNT#
     10825**DCL     11942>>ASSIGN
INFO_SYMB.V.THROTTLE_TIME#
     10824**DCL     11937>>ASSIGN
IR
      8774**DCL     12095<<DOINDEX
J
      8775**DCL     12235<<ASSIGN  12237>>IF      12239<<ASSIGN  12246>>ASSIGN  12247>>ASSIGN  12248>>ASSIGN
     12249>>ASSIGN  12250>>ASSIGN  12252<<ASSIGN  12252>>ASSIGN  12301<<DOINDEX 12302>>IF      12305>>ASSIGN
     12382<<ASSIGN  12387>>ASSIGN  12388<<ASSIGN  12388>>ASSIGN  12392>>ASSIGN
JC_PCMP
      9059**DCL     11072--DCLINIT 11073--DCLINIT
JOB_SYSID
      8794**DCL     12037<<ASSIGN  12038<>CALL
KDEVNAME
      8823**DCL     10817--DCLINIT 11875<<ASSIGN
KEYIN$
      8784**DCL     11747<<ASSIGN  11748>>DOCASE  11765>>ASSIGN  11767<>CALL    11775>>ASSIGN  11782<>CALL
     11805<>CALL    11816>>ASSIGN  11823>>ASSIGN  11824>>ASSIGN  11825>>ASSIGN  11826>>ASSIGN  11833>>IF
     11833>>IF      11903>>IF      11903>>IF      11934>>IF      11934>>IF      11950>>IF      11955>>ASSIGN
     11974>>ASSIGN  11979<>CALL    12010>>ASSIGN
KEYIN0 IN PROCEDURE EXT_EVENT
     11770**LABEL   11766--CALLALT
KEYIN001 IN PROCEDURE EXT_EVENT
     11772**LABEL   11959--GOTO
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:215  
KEYIN01 IN PROCEDURE EXT_EVENT
     11775**LABEL   11962--GOTO
KEYIN1 IN PROCEDURE EXT_EVENT
     11821**LABEL   11817--GOTO
KEYIN11 IN PROCEDURE EXT_EVENT
     11887**LABEL   11876--CALLALT
KEYIN2 IN PROCEDURE EXT_EVENT
     11977**LABEL   11975--CALLALT
KEYIN21 IN PROCEDURE EXT_EVENT
     11974**LABEL   11976--GOTO
KL_WSNDEV.DEV
      8392**DCL     12246>>ASSIGN
KL_WSNDEV.NDEV
      8391**DCL     12236>>DOINDEX
LOCKKEYIN
      8839**DCL     11994--CALL
LOCKKEYIN.CHKP
      8849**DCL      8850--REDEF
LOCKKEYIN.DEVNM
      8842**DCL      8843--REDEF   11993<<ASSIGN
LOCKKEYIN.TNAME
      8854**DCL      8855--REDEF    8856--REDEF
M$ACTIVATE
        82**DCL-ENT 11642--CALL
M$CGCTL
        83**DCL-ENT 11435--CALL    11634--CALL
M$CLOSE
        62**DCL-ENT 11504--CALL    12549--CALL    12556--CALL
M$DEACTIVATE
        82**DCL-ENT 11621--CALL    12362--CALL
M$EVENT
       117**DCL-ENT 11429--CALL
M$EXTEND
        66**DCL-ENT 11631--CALL
M$FILE1
      9120**DCL     12625--ASSIGN
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:216  
M$JOBSTATS
       127**DCL-ENT 12627--CALL
M$MONINFO
       130**DCL-ENT 12623--CALL
M$OPEN
        62**DCL-ENT 11431--CALL    11434--CALL    11438--CALL    11446--CALL    12539--CALL    12542--CALL
     12568--CALL    12617--CALL    12621--CALL
M$READ
        63**DCL-ENT 11432--CALL    11436--CALL    11536--CALL    11538--CALL    12223--CALL    12258--CALL
M$RPRIV
       121**DCL-ENT 11422--CALL
M$SYMBIO
       127**DCL-ENT 11876--CALL    12277--CALL
M$TIME
       129**DCL-ENT 11938--CALL
M$TRUNC
        63**DCL-ENT 12229--CALL    12271--CALL    12399--CALL
M$WAIT
       120**DCL-ENT 11478--CALL
M$WRITE
        63**DCL-ENT 11444--CALL    11506--CALL    11777--CALL    11902--CALL    11927--CALL    11943--CALL
     12011--CALL    12361--CALL    12398--CALL    12422--CALL    12428--CALL
M$XCON
       117**DCL-ENT 11425--CALL
MAP_QHDR
     10791**DCL     12627<>CALL
MAP_QHDR.V
     10795**DCL     10791--DCLINIT
MISC_SETUP
     12615**PROC    11427--CALL
MYSTATION
     10625**DCL     10599--DCLINIT
MYSTATION.MSGIDXT
     10635**DCL     10638--REDEF
M_FILE1$
      8772**DCL     12544>>ASSIGN  12545>>IF      12545>>IF      12545>>IF      12559>>CALLBLT 12560>>CALLBLT
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:217  
     12561>>CALLBLT 12567>>ASSIGN  12571>>IF      12573>>ASSIGN  12625<<ASSIGN
NDEV
      8804**DCL     11829<<ASSIGN  11842<<ASSIGN  11842>>ASSIGN  11949>>IF
NEXT_OSYMB IN PROCEDURE ADD_DEV
     12326**LABEL   12297--GOTO    12306--GOTO
NOREFT
     11422**LABEL   11422--CALLALT
NOSTART
      8818**DCL     12029<<ASSIGN  12029>>ASSIGN  12339<>CALL    12465>>IF
NO_DEVSPACE IN PROCEDURE ADD_DEV
     12351**LABEL   12215--CALLALT 12226--GOTO
NO_WSNSPACE IN PROCEDURE ADD_DEV
     12336**LABEL   12232--CALLALT 12241--CALLALT 12324--CALLALT
NXTFIL$
      8797**DCL     12587<<ASSIGN  12592>>ASSIGN
OCMSG_DINFO
     10450**DCL     11902<>CALL
OCMSG_DINFO.STATION_
     10452**DCL     10452--REDEF
OCMSG_DINFO.V
     10453**DCL     10450--DCLINIT
OCMSG_DINFO.V.DVBYTE.VFC#
     10459**DCL     10459--REDEF
OCMSG_KERR
     10518**DCL     11777<>CALL
OCMSG_KERR.STATION_
     10520**DCL     10520--REDEF
OCMSG_KERR.V
     10521**DCL     10518--DCLINIT
OCMSG_KERR.V.DVBYTE.VFC#
     10527**DCL     10527--REDEF
OCMSG_RINFO
     10233**DCL     11927<>CALL
OCMSG_RINFO.STATION_
     10235**DCL     10235--REDEF
OCMSG_RINFO.V
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:218  
     10236**DCL     10233--DCLINIT
OCMSG_RINFO.V.DVBYTE.VFC#
     10242**DCL     10242--REDEF
OCMSG_TCON
     10301**DCL     12422<>CALL    12428<>CALL
OCMSG_TCON.STATION_
     10303**DCL     10303--REDEF
OCMSG_TCON.V
     10304**DCL     10301--DCLINIT
OCMSG_TCON.V.DVBYTE.VFC#
     10310**DCL     10310--REDEF
OCMSG_TDSC
     10416**DCL     12361<>CALL
OCMSG_TDSC.STATION_
     10418**DCL     10418--REDEF
OCMSG_TDSC.V
     10419**DCL     10416--DCLINIT
OCMSG_TDSC.V.DVBYTE.VFC#
     10425**DCL     10425--REDEF
OCMSG_TINFO
     10267**DCL     11943<>CALL
OCMSG_TINFO.STATION_
     10269**DCL     10269--REDEF
OCMSG_TINFO.V
     10270**DCL     10267--DCLINIT
OCMSG_TINFO.V.DVBYTE.VFC#
     10276**DCL     10276--REDEF
OCMSG_UNIMP
     10484**DCL     12011<>CALL
OCMSG_UNIMP.STATION_
     10486**DCL     10486--REDEF
OCMSG_UNIMP.V
     10487**DCL     10484--DCLINIT
OCMSG_UNIMP.V.DVBYTE.VFC#
     10493**DCL     10493--REDEF
OPEN_CSCG
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:219  
      9605**DCL     11431<>CALL
OPEN_CSCG.ACSVEH_
      9607**DCL      9608--REDEF
OPEN_CSCG.ALTKEYS_
      9613**DCL      9614--REDEF    9614--REDEF
OPEN_CSCG.HDR_
      9612**DCL      9613--REDEF
OPEN_CSCG.TAB_
      9611**DCL      9612--REDEF
OPEN_CSCG.UHL_
      9605**DCL      9606--REDEF    9606--REDEF
OPEN_CSCG.V
      9614**DCL      9605--DCLINIT
OPEN_CSCG.V.FSN#
      9645**DCL      9645--REDEF    9645--REDEF
OPEN_CSCG.WSN_
      9611**DCL      9611--REDEF
OPEN_FPRG
     11312**DCL     11438<>CALL
OPEN_FPRG.ACSVEH_
     11314**DCL     11315--REDEF
OPEN_FPRG.ALTKEYS_
     11320**DCL     11321--REDEF   11321--REDEF
OPEN_FPRG.HDR_
     11319**DCL     11320--REDEF
OPEN_FPRG.TAB_
     11318**DCL     11319--REDEF
OPEN_FPRG.UHL_
     11312**DCL     11313--REDEF   11313--REDEF
OPEN_FPRG.V
     11321**DCL     11312--DCLINIT
OPEN_FPRG.V.FSN#
     11352**DCL     11352--REDEF   11352--REDEF
OPEN_FPRG.WSN_
     11318**DCL     11318--REDEF
OPEN_HLP
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:220  
     10064**DCL     11446<>CALL
OPEN_HLP.ACSVEH_
     10066**DCL     10067--REDEF
OPEN_HLP.ALTKEYS_
     10072**DCL     10073--REDEF   10073--REDEF
OPEN_HLP.HDR_
     10071**DCL     10072--REDEF
OPEN_HLP.TAB_
     10070**DCL     10071--REDEF
OPEN_HLP.UHL_
     10064**DCL     10065--REDEF   10065--REDEF
OPEN_HLP.V
     10073**DCL     10064--DCLINIT
OPEN_HLP.V.FSN#
     10104**DCL     10104--REDEF   10104--REDEF
OPEN_HLP.WSN_
     10070**DCL     10070--REDEF
OPEN_OSCG
      9258**DCL     11434<>CALL
OPEN_OSCG.ACSVEH_
      9260**DCL      9261--REDEF
OPEN_OSCG.ALTKEYS_
      9266**DCL      9267--REDEF    9267--REDEF
OPEN_OSCG.HDR_
      9265**DCL      9266--REDEF
OPEN_OSCG.TAB_
      9264**DCL      9265--REDEF
OPEN_OSCG.UHL_
      9258**DCL      9259--REDEF    9259--REDEF
OPEN_OSCG.V
      9267**DCL      9258--DCLINIT
OPEN_OSCG.V.FSN#
      9298**DCL      9298--REDEF    9298--REDEF
OPEN_OSCG.WSN_
      9264**DCL      9264--REDEF
OPEN_OSYMB
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:221  
     10904**DCL     12617<>CALL    12621<>CALL
OPEN_OSYMB.ACSVEH_
     10906**DCL     10907--REDEF
OPEN_OSYMB.ALTKEYS_
     10912**DCL     10913--REDEF   10913--REDEF
OPEN_OSYMB.HDR_
     10911**DCL     10912--REDEF
OPEN_OSYMB.TAB_
     10910**DCL     10911--REDEF
OPEN_OSYMB.UHL_
     10904**DCL     10905--REDEF   10905--REDEF
OPEN_OSYMB.V
     10913**DCL     10904--DCLINIT
OPEN_OSYMB.V.EXIST#
     10917**DCL     12620<<ASSIGN
OPEN_OSYMB.V.FSN#
     10944**DCL     10944--REDEF   10944--REDEF
OPEN_OSYMB.WSN_
     10910**DCL     10910--REDEF
OPEN_SYMOFD
      9870**DCL     12539<>CALL
OPEN_SYMOFD.ACSVEH_
      9872**DCL      9873--REDEF
OPEN_SYMOFD.ALTKEYS_
      9878**DCL      9879--REDEF    9879--REDEF
OPEN_SYMOFD.HDR_
      9877**DCL      9878--REDEF
OPEN_SYMOFD.TAB_
      9876**DCL      9877--REDEF
OPEN_SYMOFD.UHL_
      9870**DCL      9871--REDEF    9871--REDEF
OPEN_SYMOFD.V
      9879**DCL      9870--DCLINIT
OPEN_SYMOFD.V.FSN#
      9910**DCL      9910--REDEF    9910--REDEF
OPEN_SYMOFD.WSN_
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:222  
      9876**DCL      9876--REDEF
OPMSG_DINFO
      8927**DCL     10451--DCLINIT 10452--DCLINIT
OPMSG_DINFO.ACCT
      8963**DCL     11898<<ASSIGN
OPMSG_DINFO.ALG
      8967**DCL     11870<<ASSIGN
OPMSG_DINFO.CADDR
      8928**DCL     11824<<ASSIGN
OPMSG_DINFO.CONCUR
      8974**DCL     11899<<ASSIGN
OPMSG_DINFO.DEVNM
      8937**DCL     11843<<ASSIGN
OPMSG_DINFO.FLAGS
      8934**DCL      8935--REDEF
OPMSG_DINFO.FNUM
      8962**DCL     11897<<ASSIGN
OPMSG_DINFO.FORM
      8965**DCL     11869<<ASSIGN
OPMSG_DINFO.FSYSID
      8961**DCL     11896<<ASSIGN
OPMSG_DINFO.GRANS
      8966**DCL     11871<<ASSIGN  11880<<ASSIGN
OPMSG_DINFO.LOCK
      8960**DCL     11867<<ASSIGN
OPMSG_DINFO.MSGID
      8930**DCL      8931--REDEF
OPMSG_DINFO.PAGES
      8975**DCL     11872<<ASSIGN  11886<<ASSIGN
OPMSG_DINFO.PAGES_OR_RECS
      8976**DCL     11888<<ASSIGN  11890<<ASSIGN
OPMSG_DINFO.RACCT
      8971**DCL     11857<<ASSIGN
OPMSG_DINFO.RESTRICT
      8970**DCL     11849<<ASSIGN  11856<<ASSIGN  11864<<ASSIGN
OPMSG_DINFO.RESTRICTW
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:223  
      8972**DCL     11850<<ASSIGN  11858<<ASSIGN  11862<<ASSIGN
OPMSG_DINFO.RWSN
      8973**DCL     11863<<ASSIGN
OPMSG_DINFO.SIP
      8959**DCL     11845<<ASSIGN
OPMSG_DINFO.STATE
      8958**DCL     11844<<ASSIGN
OPMSG_DINFO.SUBC
      8968**DCL     11815<<ASSIGN  11821<<ASSIGN
OPMSG_DINFO.SUSRSN
      8964**DCL     11868<<ASSIGN
OPMSG_DINFO.TNAME
      8969**DCL     11816<<ASSIGN
OPMSG_KERR
      8868**DCL     10519--DCLINIT 10520--DCLINIT
OPMSG_KERR.CADDR
      8869**DCL     11775<<ASSIGN
OPMSG_KERR.DEVNM
      8878**DCL     11776<<ASSIGN
OPMSG_KERR.FLAGS
      8875**DCL      8876--REDEF
OPMSG_KERR.MSG#
      8870**DCL     11772<<ASSIGN  11961<<ASSIGN
OPMSG_KERR.MSGID
      8871**DCL      8872--REDEF
OPMSG_KERR.SUBC
      8883**DCL     11773<<ASSIGN  11960<<ASSIGN
OPMSG_KERR.SUBC1
      8884**DCL     11770<<ASSIGN  11951<<ASSIGN  11954<<ASSIGN
OPMSG_KERR.TNAME
      8885**DCL     11955<<ASSIGN
OPMSG_RINFO
      8983**DCL     10234--DCLINIT 10235--DCLINIT
OPMSG_RINFO.CADDR
      8984**DCL     11825<<ASSIGN
OPMSG_RINFO.FLAGS
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:224  
      8990**DCL      8991--REDEF
OPMSG_RINFO.MSGID
      8986**DCL      8987--REDEF
OPMSG_RINFO.STATUS
      8997**DCL     11916<<ASSIGN  11920<<ASSIGN  11925<<ASSIGN
OPMSG_RINFO.WSN_NAME
      8998**DCL     11911<<ASSIGN
OPMSG_TCON
      9025**DCL     10302--DCLINIT 10303--DCLINIT
OPMSG_TCON.DEVNM
      9035**DCL     12417<<ASSIGN
OPMSG_TCON.FLAGS
      9032**DCL      9033--REDEF
OPMSG_TCON.MSGID
      9028**DCL      9029--REDEF
OPMSG_TCON.SUBC
      9039**DCL     12421<<ASSIGN  12427<<ASSIGN
OPMSG_TCON.WSN
      9040**DCL     12416<<ASSIGN
OPMSG_TDSC
      8891**DCL     10417--DCLINIT 10418--DCLINIT
OPMSG_TDSC.DEVNM
      8901**DCL     12360<<ASSIGN
OPMSG_TDSC.FLAGS
      8898**DCL      8899--REDEF
OPMSG_TDSC.MSGID
      8894**DCL      8895--REDEF
OPMSG_TDSC.SUBC
      8904**DCL     12358<<ASSIGN
OPMSG_TINFO
      9004**DCL     10268--DCLINIT 10269--DCLINIT
OPMSG_TINFO.CADDR
      9005**DCL     11826<<ASSIGN
OPMSG_TINFO.CNT
      9018**DCL     11942<<ASSIGN
OPMSG_TINFO.FLAGS
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:225  
      9011**DCL      9012--REDEF
OPMSG_TINFO.MSGID
      9007**DCL      9008--REDEF
OPMSG_TINFO.TIME
      9019**DCL     11941<<ASSIGN
OPMSG_UNIMP
      8910**DCL     10485--DCLINIT 10486--DCLINIT
OPMSG_UNIMP.CADDR
      8911**DCL     12010<<ASSIGN
OPMSG_UNIMP.FLAGS
      8917**DCL      8918--REDEF
OPMSG_UNIMP.MSGID
      8913**DCL      8914--REDEF
OSCG
      9483**DCL      9259--DCLINIT 11313--DCLINIT
OSCGCP
      9382**DCL      9428--DCLINIT
OSCGCP.DVBYTE.REREAD#
      9396**DCL      9397--REDEF
OSCGCP.MAXPG#
      9388**DCL     11633<<ASSIGN  11633>>ASSIGN
OSCG_ACCESS
      9313**DCL      9260--DCLINIT
OSCG_ACCESS.Q
      9314**DCL      9313--DCLINIT
OSEVENT
      9531**DCL     11429<>CALL
OSEVENT.V
      9531**DCL      9531--DCLINIT
OSFNAME IN PROCEDURE GET_FILES
     12535**DCL     12567<<ASSIGN  12571>>IF      12573<<ASSIGN
OSYMB$
      8779**DCL     12272<<ASSIGN
OSYMBNAME
     10975**DCL     10905--DCLINIT
OUTSYMFPRGNAME
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:226  
     11371**DCL     11313--DCLINIT
OUTSYMNAME
      9502**DCL      9259--DCLINIT  9606--DCLINIT
PG#
      8810**DCL     11881<<ASSIGN  11882<<ASSIGN  11882>>ASSIGN  11884>>IF      11886>>ASSIGN
READ_CSCG
     10694**DCL     11432<>CALL    11536<>CALL
READ_CSCG.STATION_
     10697**DCL     10698--REDEF
READ_CSCG.V
     10698**DCL     10694--DCLINIT
READ_CSCG.V.DVBYTE.REREAD#
     10709**DCL     10709--REDEF
READ_CSCG.V.INDX#
     10707**DCL     10707--REDEF
READ_HLP
     10159**DCL     12223<>CALL
READ_HLP.STATION_
     10162**DCL     10163--REDEF
READ_HLP.V
     10163**DCL     10159--DCLINIT
READ_HLP.V.DVBYTE.REREAD#
     10174**DCL     10174--REDEF
READ_HLP.V.INDX#
     10172**DCL     10172--REDEF
READ_OSCG
     10738**DCL     11436<>CALL    11538<>CALL
READ_OSCG.STATION_
     10741**DCL     10742--REDEF
READ_OSCG.V
     10742**DCL     10738--DCLINIT
READ_OSCG.V.DVBYTE.REREAD#
     10753**DCL     10753--REDEF
READ_OSCG.V.INDX#
     10751**DCL     10751--REDEF
READ_OSYMB
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:227  
     11000**DCL     12258<>CALL
READ_OSYMB.BUF_.BOUND
     11002**DCL     12257<<ASSIGN
READ_OSYMB.STATION_
     11003**DCL     11004--REDEF
READ_OSYMB.V
     11004**DCL     11000--DCLINIT
READ_OSYMB.V.DVBYTE.REREAD#
     11015**DCL     11015--REDEF
READ_OSYMB.V.INDX#
     11013**DCL     11013--REDEF
READ_OSYMB_KEYIN.STATION_
     10341**DCL     10342--REDEF
READ_OSYMB_KEYIN.V
     10342**DCL     10338--DCLINIT
READ_OSYMB_KEYIN.V.DVBYTE.REREAD#
     10353**DCL     10353--REDEF
READ_OSYMB_KEYIN.V.INDX#
     10351**DCL     10351--REDEF
SCAN_SYMOFD
      9752**DCL     12542<>CALL    12568<>CALL
SCAN_SYMOFD.ACSVEH_
      9754**DCL      9755--REDEF
SCAN_SYMOFD.ALTKEYS_
      9760**DCL      9761--REDEF    9761--REDEF
SCAN_SYMOFD.HDR_
      9759**DCL      9760--REDEF
SCAN_SYMOFD.TAB_
      9758**DCL      9759--REDEF
SCAN_SYMOFD.UHL_
      9752**DCL      9753--REDEF    9753--REDEF
SCAN_SYMOFD.V
      9761**DCL      9752--DCLINIT
SCAN_SYMOFD.V.FSN#
      9792**DCL      9792--REDEF    9792--REDEF
SCAN_SYMOFD.WSN_
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:228  
      9758**DCL      9758--REDEF
SEND_PCMP
     11071**DCL     11444<>CALL
SEND_PCMP.STATION_
     11073**DCL     11073--REDEF
SEND_PCMP.V
     11074**DCL     11071--DCLINIT
SEND_PCMP.V.DVBYTE.VFC#
     11080**DCL     11080--REDEF
SLEEP
     10653**DCL     11478<>CALL
SLEEP.V
     10654**DCL     10653--DCLINIT
SLEEP.V.UNITS#
     10654**DCL     11476<<ASSIGN  11477<<ASSIGN  11479>>ASSIGN  11480>>ASSIGN
SLEEP1.V
     10670**DCL     10669--DCLINIT
SLUGNAME
     11099**DCL     11073--DCLINIT
SLUGNAME.MSGIDXT
     11109**DCL     11112--REDEF
SPILLDISP
      8796**DCL     12059<<ASSIGN  12060<>CALL    12061>>IF
SYMOACCT
      9927**DCL      9757--DCLINIT  9875--DCLINIT
SYSACCT
      9942**DCL      9263--DCLINIT 10069--DCLINIT 10909--DCLINIT 11317--DCLINIT
TALLY
      8780**DCL     12380<<ASSIGN  12385<<ASSIGN  12385>>ASSIGN
THROTTLE_TIME
     11229**DCL     11938<>CALL
THROTTLE_TIME.V
     11233**DCL     11229--DCLINIT
THROTTLE_UTS
      9130**DCL     11233--DCLINIT 11937<<ASSIGN
TIMEASLEEP
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:229  
      8821**DCL     11476>>ASSIGN  11479<<ASSIGN  11479>>ASSIGN  11491>>IF      11499<<ASSIGN  11516>>IF
     11519<<ASSIGN  11988<<ASSIGN
TRUNC_HLP
     10194**DCL     12229<>CALL
TRUNC_HLP.V
     10194**DCL     10194--DCLINIT
TRUNC_OSYMB
     10210**DCL     12271<>CALL    12399<>CALL
TRUNC_OSYMB.V
     10210**DCL     10210--DCLINIT
TTIME.DATE
      9132**DCL     11229--DCLINIT 11230--DCLINIT
TTIME.DAY
      9133**DCL     11232--DCLINIT
TTIME.TIME
      9134**DCL     11231--DCLINIT 11232--DCLINIT 11941>>ASSIGN
UNEXPT
      8819**DCL     10653--DCLINIT 11479>>ASSIGN  11480>>ASSIGN
WRITE_OSYMB
     10382**DCL     12398<>CALL
WRITE_OSYMB.BUF_.BOUND
     10382**DCL     12394<<ASSIGN
WRITE_OSYMB.STATION_
     10384**DCL     10384--REDEF
WRITE_OSYMB.V
     10385**DCL     10382--DCLINIT
WRITE_OSYMB.V.DVBYTE.VFC#
     10391**DCL     10391--REDEF
WRITE_ZAPRESP
     11179**DCL     11506<>CALL
WRITE_ZAPRESP.STATION_
     11181**DCL     11181--REDEF
WRITE_ZAPRESP.V
     11182**DCL     11179--DCLINIT
WRITE_ZAPRESP.V.DVBYTE.VFC#
     11188**DCL     11188--REDEF
PL6.E3A0      #001=FOO$OUTSYM File=FOO$OUTSYM.:E05TSI                            TUE 07/29/97 17:11 Page:230  
WSN$
      8776**DCL     11906<<ASSIGN  11907>>DOWHILE 11908>>DOINDEX 11909>>IF      11911>>ASSIGN  11912>>IF
     11914>>IF      11930<<ASSIGN  11930>>ASSIGN  12232<>CALL    12233>>ASSIGN  12234>>ASSIGN  12240>>ASSIGN
     12241<>CALL    12242>>ASSIGN  12243>>ASSIGN  12246>>ASSIGN  12247>>ASSIGN  12248>>ASSIGN  12249>>ASSIGN
     12250>>ASSIGN  12251>>ASSIGN  12251>>ASSIGN  12299<<ASSIGN  12300>>DOWHILE 12301>>DOINDEX 12302>>IF
     12305>>ASSIGN  12309>>ASSIGN  12310<<ASSIGN  12310>>ASSIGN  12313<<ASSIGN  12316>>IF      12318>>ASSIGN
     12318>>ASSIGN  12319>>ASSIGN  12319>>ASSIGN  12323>>ASSIGN  12324<>CALL    12325>>ASSIGN  12326>>ASSIGN
     12327>>ASSIGN  12328>>ASSIGN  12328>>ASSIGN  12349<<ASSIGN  12350>>DOWHILE 12351>>ASSIGN  12352<>CALL
     12353<<ASSIGN  12383<<ASSIGN  12384>>DOWHILE 12385>>ASSIGN  12386>>DOINDEX 12387>>ASSIGN  12390<<ASSIGN
     12390>>ASSIGN  12413<<ASSIGN  12414>>DOWHILE 12415>>DOINDEX 12416>>ASSIGN  12419>>IF      12425>>IF
     12431<<ASSIGN  12431>>ASSIGN
WSNDEV$
      8777**DCL     12230<<ASSIGN  12236>>DOINDEX 12246>>ASSIGN
WSN_LNK$
      8778**DCL     12240<<ASSIGN  12242>>ASSIGN  12309<<ASSIGN  12313>>ASSIGN  12323<<ASSIGN  12325>>ASSIGN
     12351<<ASSIGN  12353>>ASSIGN
XCONSET
     10773**DCL     11425<>CALL
XCONSET.V
     10774**DCL     10773--DCLINIT
XTNDALT IN PROCEDURE EXT_EVENT
     11631**LABEL   11631--CALLALT
XTNDALT0 IN PROCEDURE EXT_EVENT
     11633**LABEL   11634--CALLALT
ZAPRESP
      9100**DCL     11180--DCLINIT 11181--DCLINIT
ZAPRESP.FLAGS
      9107**DCL      9108--REDEF
ZAPRESP.MSGID
      9103**DCL      9104--REDEF
