VERSION E05

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:1    
        1        1        /*M*      FMO$OBSE     OPEN/CLOSE SUBROUTINES               */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* NSO,MCL=0,MOC,MEC,CLM=12,EXM=12,CRT=6,DMR,PLM=3,IND=3,ENU=0,DCI=3,
        8        8        CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9                    /**/
       10       10                    /*F*  NAME:             FMO$BLDFIT
       11       11                    *     PURPOSE:          BUILD A FIT FROM THE OPEN FPT ITEMS.
       12       12                    *
       13       13                    */
       14       14                    /**/
       15       15                    /*D*  NAME:             FMO$BLDFIT
       16       16                    *     CALL:             CALL FMO$BLDFIT(PN$) ALTRET(ADDR);
       17       17                    *
       18       18                    *     INPUT:            PN$ IS THE ARRAY OF POINTERS CORRESPONDING
       19       19                    *                       TO THE OPEN VLP AREAS CONTAINING FIT
       20       20                    *                       PARAMETERS.
       21       21                    *
       22       22                    *
       23       23                    *                       B$JIT.DCB$ -> CURRENT DCB
       24       24                    *
       25       25                    *     OUTPUT:           A FIT RECORD WITH THE PROPER GRANULE
       26       26                    *                       HEADER INFORMATION IN WORDS 0-5 OF THE
       27       27                    *                       BUFFER WILL HAVE BEEN BUILT IN THE DCB
       28       28                    *                       BUFX(1) SLOT. CODE(1) IN THE DESCRIPTOR
       29       29                    *                       AREA POINTS TO AN EMPTY 16 WORD EXTENT
       30       30                    *                       LIST SPACE.
       31       31                    *
       32       32                    *     NOTE:             IF EFT AUTHORIZATION IS SPECIFIED, THEN
       33       33                    *                       FIT CODES 4, 5, AND 6 ARE LOCATED IN THE
       34       34                    *                       IFPARAM BUFFER AND MOVED INTACT TO THE
       35       35                    *                       NEW FIT. OTHERWISE (OR IF THE CODES ARE
       36       36                    *                       NOT LOCATED FOR EFT) THESE CODES ARE
       37       37                    *                       INITIALIZED NORMALLY.
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:2    
       38       38                    *
       39       39                    *     DESCRIPTION:      INFORMATION FROM THE DCB AND THE OPEN
       40       40                    *                       PARAMETERS ARE USED TO CONSTRUCT THE GRANULE
       41       41                    *                       HEADER AND THE FIT. NAVX AND AVAIL IN THE
       42       42                    *                       GRANULE HEADER ARE SET WITH THE CORRECT VALUES
       43       43                    *                       AFTER THE FIT IS CONSTRUCTED.  THE ZERO
       44       44                    *                       ENTRY OF FM$FIT.CODES CONTAINS THE NO. OF CODES
       45       45                    *                       DEFINED, THE NAW OF THE FIT, AND THE NDW OF
       46       46                    *                       THE FIT.
       47       47                    */
       48       48        FMO$BLDFIT: PROC(DUMMY) ALTRET;
       49       49    1   DCL DUMMY CHAR(I);
       50       50                    /**/
       51       51                    /* PARAMETER DATA */
       52       52                    /**/
       53       53        %INCLUDE F_CP6;
       54     1078        %INCLUDE F$CP6P_C;
       55     1089        %INCLUDE FM_FIELD_C;
       56     1130        %INCLUDE B$OBJECT_C;
       57     4560        %VREBL_DATATYPES;
       58     4635        %FPT$OPEN_P(FPTN=PN$,PFMT=PTR,STCLASS="REDEF DUMMY");
       59     4641        %FPT$CLOSE_P(FPTN=CPN$,PFMT=PTR,STCLASS="REDEF DUMMY");
       60     4645    1   DCL RELG_BUFNO REDEF DUMMY UBIN; /* Used by FMO$RELG for ALTKEY */
       61     4646                    /* VLP$ALTKEYS, VLP$RECFIELD, and VLP$IRREC are only used on a
       62     4647                       close.                                                         */
       63     4648        %VLP_ALTKEYS(STCLASS="BASED(B$PS12$)", FPTN=VLP$ALTKEYS);
       64     4663        %VLP_RECFIELD(FPTN=VLP$RECFIELD,STCLASS="BASED(B$PS2$)");
       65     4707        %VLP_IRREC(FPTN=VLP$IRREC,STCLASS="BASED(B$PS1$)");
       66     4721        %VLP_SN(FPTN=VLP$SN,STCLASS="BASED(PN$.SN_)");
       67     4734        %INCLUDE F$CP6V_C;
       68     4960        %INCLUDE B$P;
       69     5044        %INCLUDE B$USER;
       70     5260        %B$USERREFS;
       71     5264        %FPT$CLOSE_V(BASED="BASED(PN$.V_)");
       72     5273    1   DCL 1 O BASED ALIGNED, /* PARAMETER FOR XTNTOFIT IS AN EXTENT */
       73     5274    1         2 ADR UBIN, /* IN THE TWO WORD FORM */
       74     5275    1         2 SIZ UBIN;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:3    
       75     5276    1   DCL 1 OS REDEF O,
       76     5277    1         2 SIZ UBIN BYTE UNAL,
       77     5278    1         2 ADR UBIN(27) UNAL,
       78     5279    1         2 * SBIN;
       79     5280                    /**/
       80     5281                    /* SYMREF DATA */
       81     5282                    /**/
       82     5283    1   DCL B$JIT$ PTR SYMREF READONLY;
       83     5284    1   DCL B$ROSEG$ PTR SYMREF READONLY;
       84     5285    1   DCL B$PS1$ PTR SYMREF;
       85     5286    1   DCL B$PS2$ PTR SYMREF;
       86     5287    1   DCL B$PS12$ PTR SYMREF;
       87     5288    1   DCL F$CFU$ PTR SYMREF;
       88     5289    1   DCL B_TICSDAY UBIN(36) SYMREF; /* TICS IN ONE DAY */
       89     5290    1   DCL FM_FRZERO UBIN SYMREF;
       90     5291    1   DCL FM_SRZERO UBIN SYMREF;
       91     5292    1   DCL FM_SYSACCTX UBIN SYMREF;
       92     5293    1   DCL FM$BUF$(0:0)PTR SYMREF;
       93     5294                    /**/
       94     5295                    /* EXTERNAL ROUTINES */
       95     5296                    /**/
       96     5297    1   DCL FAG$GAFIT ENTRY(1) ALTRET;
       97     5298    1   DCL FAG$REXT ENTRY(1) ALTRET; /* RELEASE EXTRA SPACE */
       98     5299    1   DCL FMB$LOGERR ENTRY(3); /* LOG BAD FIT ERRORS */
       99     5300    1   DCL FMD$FLSHBUF ENTRY(1); /* FLUSH BUFFER ROUTINE */
      100     5301    1   DCL FMD$GETBUF ENTRY(3); /* GET BUFFER ROUTINE */
      101     5302    1   DCL FMD$WRTBUF ENTRY(1); /* SHOVEL BUFFER */
      102     5303    1   DCL FMD$WRTSV ENTRY(1); /* UPDATE GRANULE */
      103     5304    1   DCL FMD$REDBUFBC ENTRY(6) ALTRET;
      104     5305    1   DCL FMG$ADDSEG ENTRY(2) ALTRET;
      105     5306    1   DCL FMG$CURKEY ENTRY(3) ALTRET;
      106     5307    1   DCL FMG$KEYSQZ ENTRY(1) ALTRET;
      107     5308    1   DCL FMG$MOVKEYS ENTRY(1)ALTRET;
      108     5309    1   DCL FMG$REMKEY ENTRY ALTRET;
      109     5310    1   DCL FMG$IRSETUP ENTRY(1) ALTRET;
      110     5311    1   DCL FMH$MAPJRNL ENTRY(2);
      111     5312    1   DCL FMM$IFPARAM ENTRY(1) ALTRET;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:4    
      112     5313    1   DCL FMM$NSTAMP ENTRY(1); /* NAME STAMP BUILDER */
      113     5314    1   DCL FMM$SCRAMBLE ENTRY(1); /* SCRAMBLE THE PASSWORD */
      114     5315    1   DCL FMN$GETFIT ENTRY(2)ALTRET;
      115     5316    1   DCL FMO$LOCCODE ENTRY(2) ALTRET; /* LOCATE FIT CODE */
      116     5317    1   DCL FMO$LOCCODP ENTRY(2) ALTRET; /* LOCATE FIT CODE */
      117     5318    1   DCL FMO$LOCCODX ENTRY(2) ALTRET;
      118     5319    1   DCL FMO$FIELD_START_SETUP ENTRY ALTRET; /* Init FM$FIELD_START */
      119     5320    1   DCL FMP$AFITCTG ENTRY ALTRET;
      120     5321    1   DCL FMP$RENAME ENTRY(1)ALTRET;
      121     5322    1   DCL FMQ$CTG ENTRY(2) ALTRET; /* UPDATE DIRECTORY TO POINT TO AFIT */
      122     5323    1   DCL FMQ$SRCHFD ENTRY(5) ALTRET; /* FIND ENTRY IN FD */
      123     5324    1   DCL FMR$FN ENTRY(1);
      124     5325    1   DCL FMR$SLIDE ENTRY(3); /* SHUFFLE THE FIT */
      125     5326    1   DCL FMR$G8 ENTRY(2) ALTRET; /* GET CFU SPACE FOR EXTENTS */
      126     5327    1   DCL FMR$L8 ENTRY;
      127     5328    1   DCL FMR$U8 ENTRY;
      128     5329    1   DCL FMR$Z8 ENTRY(1);
      129     5330    1   DCL FMU$BLD ENTRY;
      130     5331    1   DCL FSA$GSP ENTRY(2)ALTRET; /* GET SPACE FOR CODE16 */
      131     5332    1   DCL FSA$FSP ENTRY(2) ALTRET;
      132     5333    1   DCL FMR$UPDGAC ENTRY(2);
      133     5334    1   DCL HFF$DSIZ ENTRY(2); /* GET BYTE SIZE FROM DESCRIPTOR */
      134     5335    1   DCL SSS$SYSTIME ENTRY(1); /* GET CURRENT TIME */
      135     5336    1   DCL UQB$MENQX ENTRY(1)ALTRET;
      136     5337    1   DCL UQB$MDEQ ENTRY(1)ALTRET;
      137     5338                    /**/
      138     5339                    /* AUTOMATIC DATA */
      139     5340                    /**/
      140     5341    1   DCL JDCB$ PTR; /* CURRENT DCB POINTER */
      141     5342    1   DCL LOC$ PTR; /* CURRENT FIT ITEM POINTER */
      142     5343    1   DCL P1$ PTR; /* INTERNAL POINTER */
      143     5344    1   DCL 1 P1$PTR REDEF P1$,
      144     5345    1         2 COFF UBIN(20)UNAL,
      145     5346    1         2 SEGID UBIN(16)UNAL;
      146     5347    1   DCL 1 P1 REDEF P1$,
      147     5348    1         2 WOFF UBIN HALF UNAL,
      148     5349    1         2 * BIT(18);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:5    
      149     5350    1   DCL FIT$ PTR; /* FIT POINTER */
      150     5351    1   DCL CFU$ PTR; /* POINTER TO THE CFU */
      151     5352    1   DCL BUF$ PTR; /* BUFFER POINTER */
      152     5353                    /* NOTE!!! I,J,AND K MUST BE TOGTHER AND IN ORDER FOR ISTOW */
      153     5354    1   DCL I UBIN;
      154     5355    1   DCL ICHAR REDEF I CHAR(4);
      155     5356    1   DCL IBIT REDEF I BIT(36);
      156     5357    1   DCL J UBIN;
      157     5358    1   DCL JCHAR REDEF J CHAR(4);
      158     5359    1   DCL JSBIN REDEF J SBIN;
      159     5360    1   DCL K UBIN; /* MUST FOLLOW J */
      160     5361    1   DCL BUFNO SBIN; /* BUFFER NUMBER OF FIT */
      161     5362    1   DCL T$ PTR; /* FOR USE IN CALLS */
      162     5363    1   DCL T$$ PTR; /* FOR USE IN USING T$ IN CALLS */
      163     5364    1   DCL XT$ PTR BASED(T$$); /* DITTO */
      164     5365    1   DCL LOCCODX SBIN; /* PARAMETER TO LOCCODP */
      165     5366    1   DCL FIELD$ PTR;
      166     5367    1   DCL START$ PTR;
      167     5368    1   DCL IRREC$ PTR;
      168     5369    1   DCL KFIELD$ PTR;
      169     5370    1   DCL ALTKEY$ PTR;
      170     5371    1   DCL CODE19$ PTR;
      171     5372    1   DCL TFLEN SBIN;
      172     5373    1   DCL SAVE_FIELDX UBIN;
      173     5374    1   DCL SAVE_STARTX UBIN;
      174     5375    1   DCL NEW_RECFIELD BIT(1) ALIGNED;
      175     5376    1   DCL NKEYS UBIN;
      176     5377    1   DCL NEWSIZE SBIN;
      177     5378    1   DCL CODE SBIN; /* CURRENT FIT CODE */
      178     5379    1   DCL REC CHAR(I) BASED; /* FORM TO MOVE FIT ITEMS */
      179     5380    1   DCL 1 ZAP_I BASED,
      180     5381    1         2 * CHAR(I) CALIGNED;
      181     5382    1   DCL MOVEJ CHAR(J) BASED;
      182     5383    1   DCL 1 ZAPJ BASED,
      183     5384    1         2 * CHAR(J) CALIGNED;
      184     5385    1   DCL REC4 CHAR(4) BASED; /* TO MOVE ONE WORD W/CHAR MOVE */
      185     5386    1   DCL GRAN CHAR(4096) BASED; /* TO MOVE A FULL PAGE */
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:6    
      186     5387                    /**/
      187     5388        %INCLUDE F$JIT_C;
      188     5818        %INCLUDE FM$MACROS;
      189     6193        %INCLUDE KI$CP6V_C;
      190     6632        %FM$SET(BASED="BASED(F$CFU$)");
      191     6637        %FM$GRAN(BASED="BASED(BUF$)");
      192     6641        %FM$FDSEG(BASED="BASED(FIT$)");
      193     6645        %FM$FDSTOW(BASED="BASED(FIT$)");
      194     6648        %FM$FIT(BASED="BASED(FIT$)");
      195     6651        %CODE01(BASED="BASED(LOC$)");
      196     6655        %CODE02(BASED="BASED(LOC$)");
      197     6659        %CODE03(BASED="BASED(LOC$)");
      198     6666        %CODE04(BASED="BASED(LOC$)");
      199     6674        %CODE05(BASED="BASED(LOC$)");
      200     6677        %CODE06(BASED="BASED(LOC$)");
      201     6681        %CODE07(BASED="BASED(LOC$)");
      202     6684        %FITALTKEYS (BASED="BASED(LOC$)");
      203     6690        %CODE09(BASED="BASED(LOC$)");
      204     6694        %CODE15(BASED="BASED(LOC$)");
      205     6697        %CODE16(BASED="BASED(LOC$)");
      206     6705        %VLP$FPRG_V (FPTN=CODE17);
      207     6716        %CODE18(BASED="BASED(LOC$)");
      208     6720        %CODE19(BASED="BASED(CODE19$)");
      209     6723        %CODE20(BASED="BASED(LOC$)");
      210     6728        %CODE21(BASED="BASED(LOC$)");
      211     6731        %FMG$IRKEYS(FPTN=IRKEYS, STCLASS="BASED(ALTKEY$)");
      212     6738        %FMG$KFIELD(FPTN=KFIELD, STCLASS="BASED(KFIELD$)");
      213     6741        %FM$FIELD_START(FPTN=FIELD_START,STCLASS="BASED(START$)");
      214     6763        %VLP$RECFIELD_V(FPTN=RECFIELD, BASED="BASED(FIELD$)");
      215     6800        %VLP$IRREC_V(FPTN=IRREC,BASED="BASED(IRREC$)");
      216     6803        %FM$CFU(BASED="BASED(CFU$)");
      217     6809        %FM$CFUF(BASED="BASED(CFU$)");
      218     6812        %FM$CFUJ(BASED="BASED(CFU$)");
      219     6817        %FM$CFUEXT(BASED="BASED(P1$)");
      220     6821        %FM$CFUA(BASED="BASED(P1$)");
      221     6827        %MACRO F$DCB#(BASED=BASED);
      222     6828        %INCLUDE F$DCB;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:7    
      223     6877        %MEND;
      224     6878        %F$DCB#(BASED="BASED(JDCB$)");
      225     6928        %FM_GRAN (NAVX=13,FCEX=13,HDR=1,AVAIL=1011,NAME=FITHDR);
      226     6932        %FM$KEYTBL;
      227     6935    1   DCL 1 INITKEYTBL CONSTANT,
      228     6936    1         2 * UBIN(9) UNAL INIT(280);
      229     6937        %FM_FITCODE(NAME=FCODE0,CODE=1,NAW=8,NDW=8);
      230     6940        %FM_FITCODE(NAME=FCODE1,CODE=1,NDW=1,ITEMX=8);
      231     6943    1   DCL ANYFOPN BIT(72) CONSTANT INIT('0000000060000004'O);
      232     6944        %INCLUDE CP_6_SUBS;
      233     7484        %INCLUDE F_ERRORS_C;
      234     7724        %INCLUDE UD_ERRORS_C;
      235     7766        %SUB FCG#='0615'O;
      236     7767        %SUB MID#='17'O;
      237     7768        %ERRCODE(NAME=FMO$E$RENAME,COD#=%E$RENAME);
      238     7772        %ERRCODE(NAME=FMO$E$VLPERR,COD#=%E$VLPERR);
      239     7776        %ERRCODE(NAME=FMO$E$REATTR,COD#=%E$REATTR);
      240     7780        %ERRCODE(NAME=FMO$E$BADFIT,COD#=%E$BADFIT);
      241     7784        %ERRCODE(NAME=FMO$E$NOCFUS,COD#=%E$NOCFUS);
      242     7788        %ERRCODE(NAME=FMO$E$CLSREL,COD#=%E$CLSREL);
      243     7792        %ERRCODE(NAME=FMO$E$BADVECT0,COD#=%E$BADVECT0);
      244     7796        %ERRCODE(NAME=FMO$E$BADALT,COD#=%E$BADALT);
      245     7800        %ERRCODE(NAME=FMO$E$BADLEN,COD#=%E$BADLEN);
      246     7804        %ERRCODE(NAME=FMO$E$BADFTYPE,COD#=%E$BADFTYPE);
      247     7808        %ERRCODE(NAME=FMO$E$BADIKEY,COD#=%E$BADIKEY);
      248     7812        %ERRCODE(NAME=FMO$E$BADKEYLEN,COD#=%E$BADKEYLEN);
      249     7816        %ERRCODE(NAME=FMO$E$NOFLD,COD#=%E$NOFLD);
      250     7820        %ERRCODE(NAME=FMO$E$BIGKEY,COD#=%E$BIGKEY);
      251     7824        %ERRCODE(NAME=FMO$E$TOOMANYF,COD#=%E$TOOMANYF);
      252     7828        %ERRCODE(NAME=FMO$E$BADVECT12,COD#=%E$BADVECT12);
      253     7832        %ERRCODE(NAME=FMO$E$BADSTART,COD#=%E$BADSTART);
      254     7836        %ERRCODE(NAME=FMO$E$NOIREL,COD#=%E$NOIREL);
      255     7840        %ERRCODE(NAME=FMO$E$TOOMANYL,COD#=%E$TOOMANYL);
      256     7844        %ERRCODE(NAME=FMO$E$BADSCALE,COD#=%E$BADSCALE);
      257     7848        %ERRCODE(NAME=FMO$E$BADFLDTYPE,COD#=%E$BADFLDTYPE);
      258     7852        %ERRCODE(NAME=FMO$E$BADARRAY,COD#=%E$BADARRAY);
      259     7856        %ERRCODE(NAME=FMO$E$BADALIGN,COD#=%E$BADALIGN);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:8    
      260     7860        %ERRCODE(NAME=FMO$E$BADVECT1,COD#=%E$BADVECT1);
      261     7864        %ERRCODE(NAME=FMO$E$BADVECT2,COD#=%E$BADVECT2);
      262     7868        %ERRCODE(NAME=FMO$E$BADCNTFLD,COD#=%E$BADCNTFLD);
      263     7872        %ERRCODE(NAME=FMO$E$BADIFLD,COD#=%E$BADIFLD);
      264     7876        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:9    
      265     7877                    /*
      266     7878                    *  INITIALIZE AND GET A BUFFER FOR THE FIT
      267     7879                    */
      268     7880    1      JDCB$=B$JIT$->B$JIT.DCB$;
      269     7881    1      CFU$=F$DCB.CFU$;
      270     7882    1      T$$=ADDR(T$);
      271     7883    1      CALL FMD$FLSHBUF(1);
      272     7884    1      CALL FMD$GETBUF(1,1,BUF$);
      273     7885    1      BUFNO=1;
      274     7886    1      CALL SSS$SYSTIME(I); /* COMPUTE FILE NAME.ACCT HASH */
      275     7887    1      JDCB$->F$DCB.HASH=I;
      276     7888    1      F$DCB.FFLG=%FFLG_OWNER#;
      277     7889    2      IF F$DCB.STARX>2 THEN DO;
      278     7890    2         F$DCB.FFLG.EXEC='1'B;
      279     7891    2         IF F$DCB.WSR=1 THEN F$DCB.WSR=0;
      280     7892    2         END;
      281     7893                    /*
      282     7894                    *  FOR BLOCK ACCESS, THE FIT GRANULE ITSELF IS CONTAINED
      283     7895                    *  IN THE IFPARAM BUFFER.
      284     7896                    */
      285     7897    2      IF F$DCB.ACS=%BLOCK# THEN DO;
      286     7898    2         CALL HFF$DSIZ(POFFW(ADDR(PN$.IFPARAM_),ADDR(PN$.V_)),K);
      287     7899    2         IF K~=4096 THEN GOTO FMOE$VLPERR;
      288     7900    2         BUF$->GRAN=PN$.IFPARAM_->GRAN;
      289     7901    2         IF F$DCB.IASN=%FILE# THEN
      290     7902    2            IF FM$GRAN.LVL=6 /* AFIT */ THEN
      291     7903    2               F$DCB.CRECNO=0;
      292     7904    2            ELSE F$DCB.CRECNO=1;
      293     7905                    /*
      294     7906                    *  NOW CLEAR OUT THE EXTENT LIST
      295     7907                    */
      296     7908    2         FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));
      297     7909    2         IF FM$FIT.CODES.CODE(1) ~= 1 THEN GOTO FMOE$VLPERR;
      298     7910    2         FM$FIT.CODES.NDW(1)=1;
      299     7911    2         LOCCODX=3;
      300     7912    2         CALL LOCCODP ALTRET(FMOE$VLPERR);
      301     7913    2         JDCB$->F$DCB.IXTNSIZE=CODE03.UGRANS+CODE03.NGAVAL;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:10   
      302     7914    2         IF F$DCB.ASN~=%TAPE# THEN CODE03.UGRANS=-CODE03.NGAVAL;
      303     7915    2         F$DCB.DESC=CODE03.DESC;
      304     7916    2         CALL FMM$NSTAMP(CODE03.NSTAMP);
      305     7917    3         IF F$DCB.STARF OR F$DCB.DISP=%SCRATCH# THEN DO CODE=4 TO 6;
      306     7918    3            K=CODE;
      307     7919    3            T$=FIT$;
      308     7920    3            CALL FMO$LOCCODX(XT$,K) ALTRET(NOFIX);
      309     7921    3            FM$FIT.CODES(K)='0'B;
      310     7922    3   NOFIX:   END;
      311     7923    3         ELSE IF NOT B$JIT.PRIV.ACTIVE.FMEFT THEN DO CODE=4 TO 6;
      312     7924    3               CALL FMO$BLDCODE ALTRET(FMOE$VLPERR);
      313     7925    3               END;
      314     7926    2         LOC$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(1));
      315     7927    2         GOTO BLDFITX;
      316     7928    2         END;
      317     7929                    /*
      318     7930                    *  SET UP THE FIT GRANULE HEADER
      319     7931                    */
      320     7932    1      FM$GRAN=FITHDR;
      321     7933    1      FM$GRAN.ORG=JDCB$->F$DCB.ORG;
      322     7934    1      IF F$DCB.IORG=%RANDOM# OR F$DCB.IORG=%RELATIVE# OR F$DCB.ASN=%TAPE#
      323     7935    1        OR F$DCB.ACS=%UBLOCK# AND F$DCB.ORG=%CONSEC# AND NOT F$DCB.CTG
      324     7936    1      THEN FM$GRAN.LVL=6; /* THIS IS AN AFIT */
      325     7937                    /*
      326     7938                    *  INITIALIZE THE FIT CONTROL WORDS
      327     7939                    */
      328     7940    1      FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));
      329     7941    1      FM$FIT='0'B;
      330     7942    1      FM$FIT.CODES(1)=FCODE1; /* KEEP EXTENTS AT INDEX ONE */
      331     7943    1      FM$FIT.CODES(0)=FCODE0; /* NO. CODES */
      332     7944    2      IF F$DCB.IORG=%KEYED# THEN DO;
      333     7945    2         FM$GRAN.NAVX=FM$GRAN.NAVX+SIZEW(FM$KEYTBL);
      334     7946    2         FM$GRAN.AVAIL=FM$GRAN.AVAIL-SIZEW(FM$KEYTBL);
      335     7947    2         PINCRW(BUF$,FM$GRAN.FCEX)->FM$KEYTBL=INITKEYTBL;
      336     7948    2         END;
      337     7949                    /*
      338     7950                    *  If this is an Indexed or IREL file, clear out leftover
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:11   
      339     7951                    *  info from a previous open which can't be right anymore.
      340     7952                    */
      341     7953    2      IF F$DCB.ALTKEYX ~= 0 THEN DO;
      342     7954    2         P1$=PINCRW(B$ROSEG$,F$DCB.ALTKEYX);
      343     7955    3         IF F$DCB.ORG=%INDEXED# AND P1$->FITALTKEYS.K.FDA(0)~=0 THEN DO;
      344     7956    3            P1$->FITALTKEYS.ALTBLD='0'B;
      345     7957    3            P1$->FITALTKEYS.UNIQUEBLD='0'B;
      346     7958    4            DO NKEYS=0 TO P1$->FITALTKEYS.NUMENTS-1;
      347     7959    4               P1$->FITALTKEYS.K.FDA(NKEYS)=0;
      348     7960    4               P1$->FITALTKEYS.K.LDA(NKEYS)=0;
      349     7961    4               P1$->FITALTKEYS.K.TDA(NKEYS)=0;
      350     7962    4               P1$->FITALTKEYS.K.TDALVL(NKEYS)=0;
      351     7963    4               P1$->FITALTKEYS.K.DUPKEY(NKEYS)='0'B;
      352     7964    4               END;
      353     7965    3            END; /* Indexed */
      354     7966    3         ELSE IF F$DCB.ORG=%IREL# AND P1$->IRKEYS.K.FDA(0)~=0 THEN DO;
      355     7967    3               P1$->IRKEYS.ALTBLD='0'B;
      356     7968    3               P1$->IRKEYS.UNIQUEBLD='0'B;
      357     7969    4               DO NKEYS=0 TO P1$->IRKEYS.NKEYS-1;
      358     7970    4                  P1$->IRKEYS.K.FDA(0)=0;
      359     7971    4                  P1$->IRKEYS.K.LDA(0)=0;
      360     7972    4                  P1$->IRKEYS.K.TDA(0)=0;
      361     7973    4                  P1$->IRKEYS.K.TDALVL(0)=0;
      362     7974    4                  END;
      363     7975    3               END; /* IREL */
      364     7976    2         END;
      365     7977
      366     7978    1      CODE=2;  /* SET CURRENT CODE */
      367     7979                    /*
      368     7980                    *  LOOP THROUGH BUILDING FIT CODE ENTRIES
      369     7981                    */
      370     7982    2      DO WHILE (CODE<32);
      371     7983    2         CALL FMO$BLDCODE ALTRET(FMOALTRET);
      372     7984    2         CODE=CODE+1;
      373     7985    2         END;
      374     7986                    /*
      375     7987                    *  CODES ARE IN FIT, SET UP CODE01 OFFSET (ITEMX) AND
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:12   
      376     7988                    *  GRANULE HEADER INFORMATION.
      377     7989                    */
      378     7990    1      CODE=1;
      379     7991    1      I=16;    /* GET 16 WORDS FOR EXTENTS */
      380     7992    1      CALL FMO$FITSPACE(I)ALTRET(FMOE$VLPERR);
      381     7993    1   BLDFITX:;
      382     7994    1      CODE01='0'B;
      383     7995    1      CODE01.HASH=JDCB$->F$DCB.HASH;
      384     7996    1      FM$GRAN.STAMP=BINBIT(F$DCB.HASH,27);
      385     7997                    /**/
      386     7998    1      F$DCB.BFR.SCRUB(1)='1'B;
      387     7999    1      RETURN;
      388     8000                    /*E*     ERROR:   FMO-E$VLPERR-E
      389     8001                    *        MESSAGE:The FIT% for %FN% won't fit in a granule.
      390     8002                    */
      391     8003    1   FMOE$VLPERR: B$JIT$->B$JIT.ERR=FMO$E$VLPERR;
      392     8004    1      ALTRETURN;
      393     8005        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:13   
      394     8006                    /*I*  NAME: FMO$BLDCODE
      395     8007                    *
      396     8008                    *     PURPOSE:  TO ADD CODES TO THE FIT RECORD
      397     8009                    */
      398     8010    1   FMO$BLDCODE: PROC ALTRET;
      399     8011    2      IF B$JIT.PRIV.ACTIVE.FMEFT AND PN$.IFPARAM_~=ADDR(NIL)
      400     8012    3      THEN DO;
      401     8013    3         T$=PN$.IFPARAM_;
      402     8014    3         I=CODE;
      403     8015    3         CALL FMO$LOCCODE(XT$,I)ALTRET(RET123);
      404     8016    3         P1$=T$;
      405     8017    3         IBIT=PN$.IFPARAM_->FM$FIT.CODES(I);
      406     8018    3         END;
      407     8019    2      ELSE RET123: P1$=ADDR(NIL);
      408     8020    3      DO CASE(CODE);
      409     8021                    /**/
      410     8022    3      CASE(2); /* KEYED-INDEXED FPARAM DATA */
      411     8023                    /**/
      412     8024    3         IF F$DCB.IORG~=%KEYED# THEN RETURN;
      413     8025    3         CALL     FMO$FITSPACE(SIZEW(CODE02)) ALTRET(FMOE$VLPERR);
      414     8026    3         CODE02='0'B;
      415     8027    3         IF F$DCB.KEYL=0 THEN F$DCB.KEYL=1;
      416     8028    3         IF F$DCB.KEYL>255 THEN GOTO FMOE$BADALT;
      417     8029    3         CODE02.LSLIDE=JDCB$->F$DCB.LSLIDE;
      418     8030    3         CODE02.LRDL0=JDCB$->F$DCB.LRDL0;
      419     8031    3         CODE02.SPARE=JDCB$->F$DCB.SPARE;
      420     8032    3         CODE02.KEYX=JDCB$->F$DCB.KEYX;
      421     8033    3         CODE02.KEYL=JDCB$->F$DCB.KEYL;
      422     8034    3         IF F$DCB.IASN=%FILE# THEN FM$CFU.SLIDE=1;
      423     8035                    /**/
      424     8036    3      CASE(3); /* FPARAM DATA */
      425     8037                    /**/
      426     8038    3         CALL     FMO$FITSPACE(SIZEW(CODE03)) ALTRET(FMOE$VLPERR);
      427     8039    3         IF P1$~=ADDR(NIL) THEN CODE03=P1$->CODE03;
      428     8040    4         ELSE DO;
      429     8041    4            IF SUBSTR(F$DCB.TYPE,0,1)='*' AND F$DCB.WSR~=0 THEN F$DCB.TYPE=' ';
      430     8042    4            CODE03='0'B;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:14   
      431     8043    4            CODE03.ORG=JDCB$->F$DCB.ORG;
      432     8044    4            CODE03.TYPE=JDCB$->F$DCB.TYPE;
      433     8045    4            CODE03.DESC=JDCB$->F$DCB.DESC;
      434     8046    5            IF F$DCB.IORG~=%RANDOM# THEN DO;
      435     8047    5               CODE03.LDA=FM_FRZERO;
      436     8048    5               CODE03.XTNSIZE=JDCB$->F$DCB.XTNSIZE;
      437     8049    5               CODE03.COMP=JDCB$->F$DCB.COMP;
      438     8050    6               IF F$DCB.IORG=%RELATIVE# THEN DO;
      439     8051    6                  CODE03.RECL=JDCB$->F$DCB.RECL;
      440     8052    6                  CODE03.RCSZ=JDCB$->F$DCB.RECL/4096;
      441     8053    6                  CODE03.NRECS=F$DCB.NRECS;
      442     8054    6                  END;
      443     8055    5               END;
      444     8056    4            ELSE CODE03.NRECS=JDCB$->F$DCB.IXTNSIZE;
      445     8057    4            IF F$DCB.GHSTACS~=%NONE# THEN CODE03.GHSTACS=F$DCB.GHSTACS;
      446     8058    4            ELSE F$DCB.GHSTACS=0;
      447     8059    4            END;
      448     8060    3         F$DCB.DESC=CODE03.DESC;
      449     8061    3         IF F$DCB.IASN=%FILE# THEN CODE03.UGRANS=0;
      450     8062    3         ELSE CODE03.UGRANS=F$DCB.IXTNSIZE;
      451     8063    3         CALL FMM$NSTAMP(CODE03.NSTAMP);
      452     8064    4         IF NOT B$JIT.PRIV.ACTIVE.FMEFT THEN DO;
      453     8065    4            IF (F$DCB.EXPIRE>B$JIT.MAXEXP OR F$DCB.EXPIRE<0)
      454     8066    4              AND B$JIT.MAXEXP>=0 THEN F$DCB.EXPIRE=B$JIT.MAXEXP;
      455     8067    4            IF F$DCB.EXPIRE=0 THEN F$DCB.EXPIRE=B$JIT.DEFEXP;
      456     8068    4            END;
      457     8069    3         CODE03.EXPIRE=F$DCB.EXPIRE;
      458     8070                    /* NO DATES,BACKUP, OR STOW FOR TEMP FILES */
      459     8071    3         IF F$DCB.STARF OR F$DCB.DISP=%SCRATCH# THEN CODE=6;
      460     8072                    /**/
      461     8073    3      CASE(4); /* DATES RECORD */
      462     8074                    /**/
      463     8075    3         CALL     FMO$FITSPACE(SIZEW(CODE04)) ALTRET(FMOE$VLPERR);
      464     8076    3         IF P1$ ~= ADDR(NIL) THEN CODE04=P1$->CODE04;
      465     8077    4         ELSE DO;
      466     8078    4            CODE04.CREATOR.NAME=B$JIT$->B$JIT.UNAME;
      467     8079    4            CODE04.CREATOR.ACCT=B$JIT$->B$JIT.ACCN;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:15   
      468     8080    4            IF F$DCB.WSR~=1 THEN F$DCB.OWNER='1'B;
      469     8081    4            CODE04.ACCESS.TIME=I;
      470     8082    4            CODE04.MODIFY.TIME=I;
      471     8083    4            IF F$DCB.ACS=%BLOCK# THEN CODE04.SVMODIFY.TIME=0;
      472     8084    4            ELSE CODE04.SVMODIFY.TIME=I;
      473     8085    4            CODE04.GAC.TIME=I;
      474     8086    4            CODE04.GAC.N=0;
      475     8087    4            CODE04.CREATION.TIME=I;
      476     8088    4            END;
      477     8089                    /**/
      478     8090    3      CASE(5,6); /* BACKUP/STOW TIME AND REEL/DATE */
      479     8091                    /**/
      480     8092    3         IF P1$=ADDR(NIL) THEN I=SIZEW(CODE05);
      481     8093    3         CALL FMO$FITSPACE(I)ALTRET(FMOE$VLPERR);
      482     8094    3         IF P1$ ~= ADDR(NIL) THEN CODE05=P1$->CODE05;
      483     8095    4         ELSE DO;
      484     8096    4            CODE05='0'B;
      485     8097    4            FM$FIT.CODES.NDW(J)=0;
      486     8098    4            END;
      487     8099                    /**/
      488     8100    3      CASE(7); /* PASSWORD */
      489     8101                    /**/
      490     8102    4         IF P1$ ~= ADDR(NIL) THEN DO;
      491     8103    4            CALL FMO$FITSPACE(I)ALTRET(FMOE$VLPERR);
      492     8104    4            CODE07=P1$->CODE07;
      493     8105    4            END;
      494     8106    4         ELSE IF F$DCB.PASSF THEN DO;
      495     8107    4               CALL     FMO$FITSPACE(SIZEW(CODE07)) ALTRET(FMOE$VLPERR);
      496     8108    4               CODE07.PASS=JDCB$->F$DCB.PASS;
      497     8109    4               END;
      498     8110                    /**/
      499     8111    3      CASE(8); /* ALTERNATE INDEX */
      500     8112    3         IF F$DCB.ORG~=%INDEXED# THEN RETURN;
      501     8113    3         IF F$DCB.KEYX+F$DCB.KEYL>%FMG_KEYLEN_MAX OR
      502     8114    3           F$DCB.KEYL=0 OR
      503     8115    3           F$DCB.KEYL>255 THEN
      504     8116    3            GOTO FMOE$BADALT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:16   
      505     8117
      506     8118    4         IF P1$=ADDR(NIL) AND F$DCB.ALTKEYX~=0 THEN DO;
      507     8119    4            P1$=PINCRW(B$ROSEG$, F$DCB.ALTKEYX);
      508     8120    4            I=P1$->FITALTKEYS.NUMWRDS;
      509     8121    4            END;
      510     8122
      511     8123    4         IF P1$~=ADDR(NIL) THEN DO;
      512     8124    5            DO J=1 TO P1$->FITALTKEYS.NUMENTS-1;
      513     8125    5               IF P1$->FITALTKEYS.K.KEYX(J)+P1$->FITALTKEYS.K.KEYL(J)>%FMG_KEYLEN_MAX
              8125                        OR
      514     8126    5                 P1$->FITALTKEYS.K.KEYL(J)=0 OR
      515     8127    5                 P1$->FITALTKEYS.K.KEYL(J)>255 THEN
      516     8128    5                  GOTO FMOE$BADALT;
      517     8129    5               END; /* DO J */
      518     8130    4            END;
      519     8131    3   ALTKFPRG: ;
      520     8132    4         IF P1$~=ADDR(NIL) THEN DO;
      521     8133    4            CALL FMO$FITSPACE(I) ALTRET(FMOE$VLPERR);
      522     8134    4            I=I*4;
      523     8135    4            LOC$->REC=P1$->REC;
      524     8136    4            END;
      525     8137                    /**/
      526     8138    3      CASE(17); /* FPRG */
      527     8139                    /**/
      528     8140    4         IF P1$=ADDR(NIL) AND F$DCB.FPRGX~=0 THEN DO;
      529     8141    4            P1$=PINCRW(B$ROSEG$,F$DCB.FPRGX);
      530     8142    4            I=SIZEW(CODE17);
      531     8143    4            END;
      532     8144    3         GOTO ALTKFPRG;
      533     8145                    /**/
      534     8146    3      CASE(15);
      535     8147                    /**/
      536     8148    3         IF F$DCB.ORG~=%CG# THEN RETURN;
      537     8149    3         CALL FMO$FITSPACE(SIZEW(CODE15)) ALTRET(FMOE$VLPERR);
      538     8150    4         IF P1$=ADDR(NIL) THEN DO;
      539     8151    4            CODE15='0'B;
      540     8152    4            CODE15.CGORG=F$DCB.TDA;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:17   
      541     8153    4            CODE15.QISS=F$DCB.QISS;
      542     8154    4            END;
      543     8155    3         ELSE
      544     8156    3            CODE15=P1$->CODE15;
      545     8157                    /**/
      546     8158    3      CASE(16); /* DEVICE ATTRIBUTES */
      547     8159                    /**/
      548     8160    3         IF F$DCB.IORG~=%UR# THEN RETURN;
      549     8161    3         CALL     FMO$FITSPACE(SIZEW(CODE16)) ALTRET(FMOE$VLPERR);
      550     8162    4         IF F$DCB.FORM$=ADDR(NIL) THEN DO;
      551     8163    4            CALL FSA$GSP(SIZEW(CODE16),F$DCB.FORM$)ALTRET(RETALT);
      552     8164    4            F$DCB.FORM$->CODE16='0'B;
      553     8165    4            END;
      554     8166    3         CODE16=F$DCB.FORM$->CODE16;
      555     8167                    /**/
      556     8168    3      CASE(18);
      557     8169                    /* Remember that tape file mgmt will have IORG of consec
      558     8170                       for a tape IREL file.                              */
      559     8171    3         IF F$DCB.ORG~=%KEYED# AND F$DCB.ORG~=%INDEXED# AND
      560     8172    3           F$DCB.ORG~=%IREL#  AND F$DCB.ORG~=%CONSEC#  AND
      561     8173    3           F$DCB.ORG~=%RELATIVE#
      562     8174    3         THEN RETURN;
      563     8175    3         IF F$DCB.ORG = %IREL# AND P1$=ADDR(NIL) AND
      564     8176    4           F$DCB.FIELDX = 0 THEN DO;
      565     8177    4            B$JIT.ERR=FMO$E$NOIREL;
      566     8178                    /*E*   ERROR: FMO-E$NOIREL-E
      567     8179                           MESSAGE:VLP_RECFIELD or VLP_IRKEYS missing.
      568     8180                           MESSAGE1:A create open of an IREL file must specify both
      569     8181                                    a VLP_RECFIELD and VLP_IRKEYS.
      570     8182                    */
      571     8183    4            GOTO FMOE$VLPERR;
      572     8184    4            END;
      573     8185    4         IF P1$=ADDR(NIL) AND F$DCB.FIELDX>0 THEN DO;
      574     8186    4            FIELD$=PINCRW(B$ROSEG$, F$DCB.FIELDX);
      575     8187    4            IF RECFIELD.NFIELDS > 511 THEN GOTO FMOE$TOOMANYF;
      576     8188    4            CALL FMO$CHKRECFIELD ALTRET(RETALT);
      577     8189    4            P1$=FIELD$;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:18   
      578     8190    4            I=(RECFIELD.NFIELDS+1)/2 + 1;
      579     8191    4            END;
      580     8192    3         IF F$DCB.FIELDX > 0 THEN
      581     8193    3            CALL FMO$FIELD_START_SETUP ALTRET(RETALT);
      582     8194
      583     8195    4         IF P1$~=ADDR(NIL) THEN DO;
      584     8196    4            CALL FMO$FITSPACE(I) ALTRET(FMOE$VLPERR);
      585     8197    4            I=I*4;
      586     8198    4            LOC$->REC=P1$->REC;
      587     8199    4            END;
      588     8200                    /* */
      589     8201    3      CASE(19);
      590     8202    3         IF P1$=ADDR(NIL) AND F$DCB.ALTKEYX = 0 AND
      591     8203    4           F$DCB.ORG=%IREL# THEN DO;
      592     8204    4            B$JIT.ERR=FMO$E$NOIREL;
      593     8205    4            GOTO FMOE$VLPERR;
      594     8206    4            END;
      595     8207    4         IF P1$=ADDR(NIL) AND F$DCB.ALTKEYX>0 AND F$DCB.ORG=%IREL# THEN DO;
      596     8208    4            CALL FMO$CHKIKEYS ALTRET(RETALT);
      597     8209    4            CALL FMO$BLDIKEYS ALTRET(FMOE$VLPERR);
      598     8210    4            END;
      599     8211    4         ELSE IF P1$~=ADDR(NIL) AND F$DCB.ORG=%IREL# THEN DO;
      600     8212    4               CALL FMO$FITSPACE(I) ALTRET(FMOE$VLPERR);
      601     8213    4               I=I*4;
      602     8214    4               LOC$->REC=P1$->REC;
      603     8215    4               END;
      604     8216                    /* */
      605     8217    3      CASE(20);
      606     8218    4         IF P1$~=ADDR(NIL) AND F$DCB.ORG=%IREL# THEN DO;
      607     8219    4            CALL FMO$FITSPACE(I) ALTRET(FMOE$VLPERR);
      608     8220    4            I=I*4;
      609     8221    4            LOC$->REC=P1$->REC;
      610     8222    4            END;
      611     8223                    /* */
      612     8224    3      CASE(21); /* Irrec - definition of logical field order */
      613     8225                    /* Remember that tape file mgmt will have IORG of consec for
      614     8226                       a tape IREL file.                                      */
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:19   
      615     8227    3         IF F$DCB.ORG~=%KEYED# AND F$DCB.ORG~=%INDEXED# AND
      616     8228    3           F$DCB.ORG~=%IREL#  AND F$DCB.ORG~=%CONSEC#  AND
      617     8229    3           F$DCB.ORG~=%RELATIVE#
      618     8230    3         THEN RETURN;
      619     8231    4         IF P1$=ADDR(NIL) AND F$DCB.IRRECX > 0 THEN DO;
      620     8232    5            IF F$DCB.FIELDX=0 THEN DO;
      621     8233    5               B$JIT.ERR=FMO$E$NOFLD;
      622     8234    5               GOTO RETALT;
      623     8235    5               END;
      624     8236    4            IRREC$=PINCRW(B$ROSEG$,F$DCB.IRRECX);
      625     8237    4            FIELD$=PINCRW(B$ROSEG$,F$DCB.FIELDX);
      626     8238    4            IF IRREC.NFIELDS > 511 OR IRREC.NFIELDS > RECFIELD.NFIELDS
      627     8239    4            THEN GOTO FMOE$TOOMANYL;
      628     8240    4            CALL FMO$CHKIRREC(IRREC$) ALTRET(FMOE$BADIFLD);
      629     8241    4            P1$=IRREC$;
      630     8242    4            I=(IRREC.NFIELDS+3)/4 + 1;
      631     8243    4            END;
      632     8244
      633     8245    4         IF P1$~=ADDR(NIL) THEN DO;
      634     8246    4            CALL FMO$FITSPACE(I) ALTRET(FMOE$VLPERR);
      635     8247    4            I=I*4;
      636     8248    4            LOC$->REC=P1$->REC;
      637     8249    4            END;
      638     8250                    /**/
      639     8251    3      CASE(9); /* ACCESS CONTROL LIST */
      640     8252    3         P1$=PN$.ACCESS_;
      641     8253    3         GOTO BLDATTR0;
      642     8254    3      CASE(10); /* ACCESS VEHICLE LIST */
      643     8255    3         P1$=PN$.ACSVEH_;
      644     8256    3   BLDATTR0:;
      645     8257    3         IF P1$~=ADDR(NIL) THEN IF NOT F$DCB.FFLG.DELF THEN GOTO FMOE$CLSREL;
      646     8258                    /*E*     ERROR: FMO-E$CLSREL-E
      647     8259                   *        MESSAGE:You may not control access, or release NGAVAL%, for %FN%
      648     8260                    *        MESSAGE1:An attempt to close with RELG, ACCESS, or ACSVEH
      649     8261                    *        failed because you do not have DELF access% to %UF%
      650     8262                    */
      651     8263    3            ELSE GOTO BLDATTR;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:20   
      652     8264    3      CASE(11); /* USER INFO           */
      653     8265    3         P1$=PN$.UATTR_;
      654     8266    3         GOTO BLDATTR1;
      655     8267    3      CASE(12); /* INSTALLATION INFO   */
      656     8268    3         P1$=PN$.INSTATTR_;
      657     8269    3         GOTO BLDATTR1;
      658     8270    3      CASE(13); /* PROCESSOR INFO      */
      659     8271    3         P1$=PN$.PROCATTR_;
      660     8272    4         IF F$DCB.STARX=7 THEN DO; /* *I, PUT ASL NAME HERE */
      661     8273    4            CALL FMO$FITSPACE(8)ALTRET(FMOE$VLPERR);
      662     8274    4            I=32;
      663     8275    4            LOC$->REC=ADDR(B$P$->B$P.NAME(S$CU$->B$U.ASL))->REC;
      664     8276    4            END;
      665     8277    3   BLDATTR1: IF P1$=ADDR(NIL) THEN RETURN;
      666     8278    3         IF NOT F$DCB.FFLG.REATTR THEN GOTO FMOE$REATTR;
      667     8279    3   BLDATTR:;
      668     8280    3         ADDR(I)->REC4=P1$->REC4; /* MOVE WD CNT IF FROM FPT */
      669     8281    4         IF P1$=PN$.IFPARAM_ THEN DO; /* IF FROM IFPARAM, FIND THE DATA */
      670     8282    4            I=CODE;
      671     8283    4            T$=P1$;
      672     8284    4            CALL FMO$LOCCODE(XT$,I) ALTRET(FMOE$VLPERR);
      673     8285    4            P1$=T$;
      674     8286    4            IBIT=PN$.IFPARAM_->FM$FIT.CODES(I);
      675     8287    4            END;
      676     8288    3         ELSE P1$=PINCRW(P1$,1);/* DONT MOVE SIZE WORD */
      677     8289    3         CALL FMO$FITSPACE(I) ALTRET(FMOE$VLPERR);
      678     8290    3         I=I*4;
      679     8291    4         IF P1$PTR.SEGID<100 THEN DO; /* IF FROM PARAMETER, CHECK SIZE */
      680     8292    4            K=P1$PTR.SEGID;
      681     8293    4            CALL HFF$DSIZ(K,K);
      682     8294    4            IF K<P1$PTR.COFF+I THEN GOTO FMOE$PSERR;
      683     8295                    /*E*     ERROR: FMO-E$BADVECT5-E
      684     8296                    *        MESSAGE:Access control list inaccessible% for %UF%
      685     8297                    */
      686     8298                    /*E*     ERROR: FMO-E$BADVECT6-E
      687     8299                    *        MESSAGE:Access vehicle list inaccessible% for %UF%
      688     8300                    */
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:21   
      689     8301                    /*E*     ERROR: FMO-E$BADVECT7-E
      690     8302                    *        MESSAGE:UATTR area inaccessible% for %UF%
      691     8303                    */
      692     8304                    /*E*     ERROR: FMO-E$BADVECT8-E
      693     8305                    *        MESSAGE:INSTATTR area inaccessible% for %UF%
      694     8306                    */
      695     8307                    /*E*     ERROR: FMO-E$BADVECT9-E
      696     8308                    *        MESSAGE:PROCATTR area inaccessible% for %UF%
      697     8309                    */
      698     8310    4            END;
      699     8311    3         LOC$->REC=P1$->REC; /* MOVE WITH CHAR MOVE */
      700     8312    4         IF CODE=9 THEN DO;
      701     8313    4            F$DCB.DESC.NOLIST='0'B;
      702     8314    5            DO WHILE (I>9);
      703     8315    5               IF CODE09.FFLG.NOLIST THEN F$DCB.DESC.NOLIST='1'B;
      704     8316    5               LOC$=PINCRC(LOC$,10);
      705     8317    5               I=I-10;
      706     8318    5               END;
      707     8319    4            LOCCODX=3;
      708     8320    4            CALL LOCCODP ALTRET(RETALT);
      709     8321    4            CODE03.DESC=F$DCB.DESC;
      710     8322    4            END;
      711     8323    3         LOC$=FIT$;/* SET INDICATION THAT FILE IS CHANGED */
      712     8324                    /**/
      713     8325    3      END;
      714     8326    2   RETRET:;
      715     8327    2      RETURN;
      716     8328    2   FMOE$VLPERR: IF B$JIT.ERR='0'B THEN B$JIT.ERR=FMO$E$VLPERR;
      717     8329    2      ALTRETURN;
      718     8330                    /*E*     ERROR:   FMO-E$REATTR-E
      719     8331                    *        MESSAGE: You cannot change the attributes of %UF.
      720     8332                    */
      721     8333    2   FMOE$TOOMANYF: ;
      722     8334    2      B$JIT.ERR=FMO$E$TOOMANYF;
      723     8335                    /*E*   ERROR:   FMO-E$TOOMANYF-E
      724     8336                           MESSAGE: VLP_RECFIELD specified more than 511 fields
      725     8337                                    %for %UF%
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:22   
      726     8338                    */
      727     8339    2      ALTRETURN;
      728     8340    2   FMOE$TOOMANYL: ;
      729     8341    2      B$JIT.ERR=FMO$E$TOOMANYL;
      730     8342                    /*E*  ERROR:   FMO-E$TOOMANYL-E
      731     8343                          MESSAGE: VLP_IRREC specified too many fields% for %UF%
      732     8344                          MESSAGE1: VLP_IRREC either specified more than 511
      733     8345                                    fields or more fields than were specified
      734     8346                                    in the corresponding VLP_RECFIELD or CODE18.
      735     8347                    */
      736     8348    2      ALTRETURN;
      737     8349    2   FMOE$BADIFLD:;
      738     8350    2      B$JIT.ERR=FMO$E$BADIFLD;
      739     8351    2      F$DCB.ARS=J;
      740     8352    2      ALTRETURN;
      741     8353                    /*E*  ERROR:    FMO-E$BADIFLD-E
      742     8354                          MESSAGE:  VLP_IRREC specified a bad field index% for %UF%
      743     8355                          MESSAGE1: One or more field indexes in VLP_IRREC% for %UF%
      744     8356                                    was either greater than the maximum possible
      745     8357                                    field index in the corresponding RECFIELD field
      746     8358                                    array or specified a field which is defined to
      747     8359                                    be an element of a fixed or variable length
      748     8360                                    list.  F$DCB.ARS# contains the index into the
      749     8361                                    IRREC array of the first bad entry.
      750     8362                    */
      751     8363    2   FMOE$PSERR:;
      752     8364    2      B$JIT.ERR=FMO$E$BADVECT0;
      753     8365    2      B$JIT.ERR.CODE=B$JIT.ERR.CODE+P1$PTR.SEGID;
      754     8366    2      ALTRETURN;
      755     8367    2   FMOE$REATTR: B$JIT$->B$JIT.ERR=FMO$E$REATTR;
      756     8368    2      ALTRETURN;
      757     8369    2   FMOE$BADALT: B$JIT.ERR=FMO$E$BADALT;
      758     8370    2      ALTRETURN;
      759     8371                    /*E*   ERROR:   FMO-E$BADALT-E
      760     8372                           MESSAGE: Bad KEYX or KEYL% for %UF%.
      761     8373                           MESSAGE1:Either KEYX+KEYL exceeds 4000, or KEYL=0,
      762     8374                                    or KEYL > 255% for %UF%.
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:23   
      763     8375                    */
      764     8376    2   FMOE$CLSREL: B$JIT.ERR=FMO$E$CLSREL;
      765     8377    2   RETALT:;
      766     8378    2      ALTRETURN;
      767     8379        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:24   
      768     8380    2   MODIFIED: ENTRY ALTRET;
      769     8381    2      FM$CFU.FMOD='1'B;
      770     8382    2      F$DCB.BFR.BUFUP(BUFNO)='1'B;
      771     8383    2      FM$CFU.MODCNT=FM$CFU.MODCNT+1;
      772     8384    2      RETURN;
      773     8385    2   UPDGAC: ENTRY ALTRET;
      774     8386    2      LOCCODX=4;
      775     8387    2      CALL LOCCODP ALTRET(RETALT);
      776     8388    3      IF FM$SET.GACTIME(F$DCB.SETX)>CODE04.GAC.TIME THEN DO;
      777     8389    3         CODE04.GAC.TIME=FM$SET.GACTIME(F$DCB.SETX);
      778     8390    3         CODE04.GAC.N=0;
      779     8391    3         END;
      780     8392    2      CALL FMR$UPDGAC(CODE04.GAC,I);
      781     8393    2      RETURN;
      782     8394    2   END FMO$BLDCODE;
      783     8395        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:25   
      784     8396    1   LOCCODP: PROC ALTRET;
      785     8397    2      T$=FIT$;
      786     8398    3      CALL FMO$LOCCODP(XT$,LOCCODX) WHENRETURN DO;
      787     8399    3         LOC$=T$;
      788     8400    3         RETURN;
      789     8401    3         END;
      790     8402    2      ALTRETURN;
      791     8403    2   END LOCCODP;
      792     8404        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:26   
      793     8405    1   FMO$CHKRECFIELD: PROC ALTRET;
      794     8406                    /**/
      795     8407                    /* RECFIELD is based on FIELD$, which must be set up for this call.*/
      796     8408                    /**/
      797     8409
      798     8410    3      DO J=0 TO RECFIELD.NFIELDS-1;
      799     8411    4         DO CASE(RECFIELD.FIELD.TYPE(J));
      800     8412
      801     8413    4         CASE(%NO_DATATYPE, %CHAR_DATATYPE, %LIST_DATATYPE);
      802     8414    4            IF RECFIELD.FIELD.LEN(J) < 1 THEN
      803     8415    4               GOTO FMOE$BADLEN;
      804     8416    5            IF RECFIELD.FIELD.TYPE(J)=%LIST_DATATYPE THEN DO;
      805     8417    5               IF J=RECFIELD.NFIELDS-1 THEN /* Last field */
      806     8418    5                  GOTO FMOE$BADARRAY;
      807     8419    5               IF RECFIELD.FIELD.TYPE(J+1)=%LIST_DATATYPE OR
      808     8420    5                 RECFIELD.FIELD.TYPE(J+1)=%VLIST_DATATYPE OR
      809     8421    5                 RECFIELD.FIELD.TYPE(J+1)=%TEXTC_DATATYPE  OR
      810     8422    5                 RECFIELD.FIELD.TYPE(J+1)=%TEXTH_DATATYPE THEN
      811     8423    5                  GOTO FMOE$BADARRAY;
      812     8424    5               END;
      813     8425
      814     8426    4         CASE(%TEXTC_DATATYPE, %TEXTH_DATATYPE);
      815     8427                    /* No length checks are meaningful here, but need to
      816     8428                       verify legal data type.                           */
      817     8429
      818     8430    4         CASE(%VLIST_DATATYPE);
      819     8431    4            IF J=RECFIELD.NFIELDS-1 THEN
      820     8432    4               GOTO FMOE$BADARRAY;
      821     8433    4            IF RECFIELD.FIELD.TYPE(J+1)=%LIST_DATATYPE OR
      822     8434    4              RECFIELD.FIELD.TYPE(J+1)=%VLIST_DATATYPE OR
      823     8435    4              RECFIELD.FIELD.TYPE(J+1)=%TEXTC_DATATYPE OR
      824     8436    4              RECFIELD.FIELD.TYPE(J+1)=%TEXTH_DATATYPE THEN
      825     8437    4               GOTO FMOE$BADARRAY;
      826     8438    4            IF RECFIELD.FIELD.LEN(J) >= J THEN
      827     8439    4               GOTO FMOE$BADCNTFLD;
      828     8440    4            K=RECFIELD.FIELD.LEN(J);
      829     8441    4            IF K > 0 THEN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:27   
      830     8442    4               IF RECFIELD.FIELD.TYPE(K-1)=%LIST_DATATYPE OR
      831     8443    4                 RECFIELD.FIELD.TYPE(K-1)=%VLIST_DATATYPE THEN
      832     8444    4                  GOTO FMOE$BADCNTFLD;
      833     8445    4            IF RECFIELD.FIELD.TYPE(K)=%NO_DATATYPE OR
      834     8446    4              RECFIELD.FIELD.TYPE(K)=%LIST_DATATYPE OR
      835     8447    4              RECFIELD.FIELD.TYPE(K)=%VLIST_DATATYPE OR
      836     8448    4              RECFIELD.FIELD.TYPE(K)=%DATE_DATATYPE OR
      837     8449    4              RECFIELD.FIELD.TYPE(K)=%TIME_DATATYPE OR
      838     8450    4              RECFIELD.FIELD.TYPE(K)=%UTS_DATATYPE THEN
      839     8451    4               GOTO FMOE$BADCNTFLD;
      840     8452
      841     8453    4         CASE(%PDLA_DATATYPE, %PDTA_DATATYPE, %UDLS_DATATYPE,
      842     8454    4                 %UDTS_DATATYPE, %PDLE_DATATYPE, %PDTE_DATATYPE);
      843     8455    4            IF RECFIELD.DECFIELD.LEN(J) < 2 THEN
      844     8456    4               GOTO FMOE$BADLEN;
      845     8457
      846     8458    4         CASE(%PDNS_DATATYPE, %UDNS_DATATYPE, %UDLO_DATATYPE,
      847     8459    4                 %UDTO_DATATYPE);
      848     8460    4            IF RECFIELD.DECFIELD.LEN(J) < 1 THEN
      849     8461    4               GOTO FMOE$BADLEN;
      850     8462
      851     8463    4         CASE(%DATE_DATATYPE, %TIME_DATATYPE);
      852     8464    4            IF RECFIELD.DECFIELD.LEN(J)~=16 THEN
      853     8465    4               GOTO FMOE$BADLEN;
      854     8466    4            IF RECFIELD.DECFIELD.SCALE(J)~=0 THEN
      855     8467    4               GOTO FMOE$BADSCALE;
      856     8468
      857     8469    4         CASE(%SBIN_DATATYPE, %UBIN_DATATYPE);
      858     8470    4            IF RECFIELD.FIELD.LEN(J) < 1 OR
      859     8471    4              RECFIELD.FIELD.LEN(J) > 36 THEN
      860     8472    4               GOTO FMOE$BADLEN;
      861     8473
      862     8474    4         CASE(%UTS_DATATYPE);
      863     8475    4            IF RECFIELD.FIELD.LEN(J)~=36 THEN
      864     8476    4               GOTO FMOE$BADLEN;
      865     8477
      866     8478    4         CASE(%SFLT_DATATYPE);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:28   
      867     8479    4            IF RECFIELD.FIELD.LEN(J)~=4 THEN
      868     8480    4               GOTO FMOE$BADLEN;
      869     8481
      870     8482    4         CASE(%DFLT_DATATYPE);
      871     8483    4            IF RECFIELD.FIELD.LEN(J)~=8 THEN
      872     8484    4               GOTO FMOE$BADLEN;
      873     8485
      874     8486    4         CASE(%PDFLT_DATATYPE);
      875     8487    4            IF RECFIELD.DECFIELD.LEN(J) < 4 THEN
      876     8488    4               GOTO FMOE$BADLEN;
      877     8489
      878     8490    4         CASE(%UDFLT_DATATYPE);
      879     8491    4            IF RECFIELD.DECFIELD.LEN(J) < 3 THEN
      880     8492    4               GOTO FMOE$BADLEN;
      881     8493
      882     8494    4         CASE(ELSE);
      883     8495    4            GOTO FMOE$BADFLDTYPE;
      884     8496
      885     8497    4         END;  /* CASE */
      886     8498    3         END;  /* DO J */
      887     8499
      888     8500    2      RETURN;
      889     8501
      890     8502    2   FMOE$BADLEN:;
      891     8503    2      B$JIT.ERR=FMO$E$BADLEN;
      892     8504    2      GOTO RECALT;
      893     8505                    /*E*  ERROR:    FMO-E$BADLEN-E
      894     8506                          MESSAGE:  Illegal field length in field definition% for %UF%
      895     8507                          MESSAGE1: One or more field definitions% for %UF% has an
      896     8508                                    illegal length. F$DCB.ARS# contains the index
      897     8509                                    into the RECFIELD field array of the first bad
      898     8510                                    field.
      899     8511                    */
      900     8512    2   FMOE$BADSCALE:;
      901     8513    2      B$JIT.ERR=FMO$E$BADSCALE;
      902     8514    2      GOTO RECALT;
      903     8515                    /*E*  ERROR:    FMO-E$BADSCALE-E
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:29   
      904     8516                          MESSAGE:  Illegal scale value in field definition% for %UF%
      905     8517                          MESSAGE1: One or more field definitions% for %UF% has an
      906     8518                                    illegal scale value. F$DCB.ARS# contains the
      907     8519                                    index into the RECFIELD field array of the first
      908     8520                                    bad field.
      909     8521                    */
      910     8522    2   FMOE$BADFLDTYPE:;
      911     8523    2      B$JIT.ERR=FMO$E$BADFLDTYPE;
      912     8524    2      GOTO RECALT;
      913     8525                    /*E*  ERROR:    FMO-E$BADFLDTYPE-E
      914     8526                          MESSAGE:  Illegal data type in field definition% for %UF%
      915     8527                          MESSAGE1: One or more field definitions% for %UF% has an
      916     8528                                    illegal data type. F$DCB.ARS# contains the index
      917     8529                                    into the RECFIELD field array of the first bad
      918     8530                                    field.
      919     8531                    */
      920     8532    2   FMOE$BADARRAY:;
      921     8533    2      B$JIT.ERR=FMO$E$BADARRAY;
      922     8534    2      GOTO RECALT;
      923     8535                    /*E*  ERROR:    FMO-E$BADARRAY-E
      924     8536                          MESSAGE:  Bad list field in field definition% for %UF%
      925     8537                          MESSAGE1: One or more LIST or VLIST fields% in %UF%
      926     8538                                    are illegally defined. The field may not be the
      927     8539                                    last defined field or may not have elements of
      928     8540                                    type TEXTC, TEXTH, LIST, or VLIST.
      929     8541                                    F$DCB.ARS# contains the index into the RECFIELD
      930     8542                                    field array of the first bad list field.
      931     8543                    */
      932     8544    2   FMOE$BADCNTFLD:;
      933     8545    2      B$JIT.ERR=FMO$E$BADCNTFLD;
      934     8546                    /*E*  ERROR:    FMO-E$BADCNTFLD-E
      935     8547                          MESSAGE:  Bad count field for VLIST% in %UF%
      936     8548                          MESSAGE1: One or more VLIST fields% in %UF%
      937     8549                                    has a bad count field. A count field must
      938     8550                                    precede the VLIST field, may not be a
      939     8551                                    list element, and may not have a type of NO,
      940     8552                                    DATE, TIME, UTS, LIST, or VLIST.
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:30   
      941     8553                                    F$DCB.ARS# contains the index into the RECFIELD
      942     8554                                    field array of the first bad VLIST field.
      943     8555                    */
      944     8556    2   RECALT:;
      945     8557    2      F$DCB.ARS=J;
      946     8558    2      ALTRETURN;
      947     8559
      948     8560    2   END FMO$CHKRECFIELD;
      949     8561        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:31   
      950     8562    1   FMO$CHKIRREC: PROC(IR$) ALTRET;
      951     8563                    /**/
      952     8564                    /* An IRREC structure may not have more elements than its associated
      953     8565                       RECFIELD structure, although it may have fewer. An IRREC element
      954     8566                       must contain a possible index into the associated RECFIELD
      955     8567                       structure, but this index may not reference a field which defines
      956     8568                       a list element. These checks are done only for the convenience of
      957     8569                       processors like ARGENT.                                        */
      958     8570                    /**/
      959     8571    2   DCL IR$ PTR;
      960     8572                    /**/
      961     8573    2      FIELD$=PINCRW(B$ROSEG$,F$DCB.FIELDX);
      962     8574    2      IF IR$->IRREC.NFIELDS > RECFIELD.NFIELDS THEN
      963     8575    2         ALTRETURN;
      964     8576
      965     8577    3      DO J=0 TO IR$->IRREC.NFIELDS-1;
      966     8578    3         K=IR$->IRREC.FIELDN(J);
      967     8579    3         IF K > RECFIELD.NFIELDS-1 THEN
      968     8580    3            ALTRETURN;
      969     8581    3         IF K > 0 THEN
      970     8582    3            IF RECFIELD.FIELD.TYPE(K-1)=%LIST_DATATYPE OR
      971     8583    3              RECFIELD.FIELD.TYPE(K-1)=%VLIST_DATATYPE THEN
      972     8584    3               ALTRETURN;
      973     8585    3         END;
      974     8586
      975     8587    2      RETURN;
      976     8588    2   END FMO$CHKIRREC;
      977     8589        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:32   
      978     8590    1   FMO$CHKIKEYS: PROC ALTRET;
      979     8591                    /**/
      980     8592    2   DCL VAR_FIELD_INDX UBIN;
      981     8593    2   DCL TOT_NIBS UBIN;
      982     8594                    /**/
      983     8595
      984     8596    2      IF F$DCB.FIELDX=0 THEN
      985     8597    2         GOTO FMOE$NOFLD;
      986     8598    2      FIELD$=PINCRW(B$ROSEG$, F$DCB.FIELDX);
      987     8599    2      ALTKEY$=PINCRW(B$ROSEG$, F$DCB.ALTKEYX);
      988     8600    2      KFIELD$=PINCRW(B$ROSEG$, F$DCB.KFIELDX);
      989     8601    2      START$=PINCRW(B$ROSEG$, F$DCB.STARTX);
      990     8602    2      VAR_FIELD_INDX=RECFIELD.NFIELDS+1;
      991     8603    2   FIND_VAR:
      992     8604    3      DO I=0 TO RECFIELD.NFIELDS-1;
      993     8605    3         IF RECFIELD.FIELD.TYPE(I)=%TEXTC_DATATYPE OR
      994     8606    3           RECFIELD.FIELD.TYPE(I)=%TEXTH_DATATYPE OR
      995     8607    3           RECFIELD.FIELD.TYPE(I)=%VLIST_DATATYPE
      996     8608    4         THEN DO;
      997     8609    4            VAR_FIELD_INDX=I;
      998     8610    4            EXIT FIND_VAR;
      999     8611    4            END;
     1000     8612    3         END;
     1001     8613    3      DO I=0 TO IRKEYS.NKEYS-1;
     1002     8614    3         TFLEN=0;
     1003     8615    3         DO J=IRKEYS.K.FIRSTFIELD(I) TO
     1004     8616    4           IRKEYS.K.FIRSTFIELD(I)+IRKEYS.K.NFIELDS(I)-1;
     1005     8617    4            K=KFIELD.FIELD(J);
     1006     8618    4            IF K > RECFIELD.NFIELDS THEN
     1007     8619    4               GOTO FMOE$BADIKEY;
     1008     8620    4            IF K > VAR_FIELD_INDX THEN
     1009     8621    4               GOTO FMOE$BADSTART;
     1010     8622    4            IF K~=0 THEN
     1011     8623    4               IF RECFIELD.FIELD.TYPE(K-1)=%LIST_DATATYPE OR
     1012     8624    4                 RECFIELD.FIELD.TYPE(K-1)=%VLIST_DATATYPE THEN
     1013     8625    4                  GOTO FMOE$BADFTYPE;
     1014     8626
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:33   
     1015     8627    5            DO CASE(RECFIELD.FIELD.TYPE(K));
     1016     8628    5            CASE(%NO_DATATYPE, %TEXTC_DATATYPE, %TEXTH_DATATYPE,
     1017     8629    5              %LIST_DATATYPE, %VLIST_DATATYPE);
     1018     8630    5               GOTO FMOE$BADFTYPE;
     1019     8631    5            CASE(%SBIN_DATATYPE, %UBIN_DATATYPE, %UTS_DATATYPE);
     1020     8632    5               IF MOD(FIELD_START.OFFSET(K),9)~=0 OR
     1021     8633    5                 MOD(RECFIELD.FIELD.LEN(K),9)~=0 THEN
     1022     8634    5                  GOTO FMOE$BADALIGN;
     1023     8635    5               IF FIELD_START.OFFSET(K)+RECFIELD.FIELD.LEN(K) >
     1024     8636    5                 %FMG_KEYLEN_MAX*9
     1025     8637    5               THEN GOTO FMOE$BADKEYLEN;
     1026     8638    5               TFLEN=TFLEN+RECFIELD.FIELD.LEN(K)/9;
     1027     8639
     1028     8640    5            CASE(%SFLT_DATATYPE, %CHAR_DATATYPE, %DFLT_DATATYPE);
     1029     8641    5               IF FIELD_START.OFFSET(K)+(RECFIELD.FIELD.LEN(K)*9) >
     1030     8642    5                 %FMG_KEYLEN_MAX*9
     1031     8643    5               THEN GOTO FMOE$BADKEYLEN;
     1032     8644    5               TFLEN=TFLEN+RECFIELD.FIELD.LEN(K);
     1033     8645
     1034     8646    5            CASE(%UDNS_DATATYPE, %UDLS_DATATYPE, %UDTS_DATATYPE,
     1035     8647    5                 %UDLO_DATATYPE, %UDTO_DATATYPE, %UDFLT_DATATYPE);
     1036     8648    5               IF FIELD_START.OFFSET(K)+(RECFIELD.DECFIELD.LEN(K)*9) >
     1037     8649    5                 %FMG_KEYLEN_MAX*9
     1038     8650    5               THEN GOTO FMOE$BADKEYLEN;
     1039     8651    5               TFLEN=TFLEN+RECFIELD.DECFIELD.LEN(K);
     1040     8652
     1041     8653    5            CASE(%PDLA_DATATYPE, %PDTA_DATATYPE, %PDLE_DATATYPE,
     1042     8654    5                 %PDTE_DATATYPE, %PDNS_DATATYPE, %PDFLT_DATATYPE,
     1043     8655    5                 %DATE_DATATYPE, %TIME_DATATYPE);
     1044     8656    5               IF MOD(FIELD_START.OFFSET(K),9)=0 THEN
     1045     8657    5                  TOT_NIBS=(FIELD_START.OFFSET(K)/9)*2;
     1046     8658    5               ELSE TOT_NIBS=(FIELD_START.OFFSET(K)/9)*2 + 1;
     1047     8659    5               IF TOT_NIBS+RECFIELD.DECFIELD.LEN(K) >
     1048     8660    5                 %FMG_KEYLEN_MAX*2
     1049     8661    5               THEN GOTO FMOE$BADKEYLEN;
     1050     8662    5               TFLEN=TFLEN+(RECFIELD.DECFIELD.LEN(K)+1)/2;
     1051     8663
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:34   
     1052     8664    5            CASE(ELSE);
     1053     8665    5               GOTO FMOE$BADFTYPE;
     1054     8666
     1055     8667    5            END; /* Do Case */
     1056     8668    4            END; /* Do J */
     1057     8669    3         IF TFLEN > 511 THEN
     1058     8670    3            GOTO FMOE$BIGKEY;
     1059     8671    3         END;  /* Do I */
     1060     8672
     1061     8673    2      RETURN;
     1062     8674    2   FMOE$BADFTYPE: ;
     1063     8675    2      B$JIT.ERR=FMO$E$BADFTYPE;
     1064     8676    2      F$DCB.ARS=I;
     1065     8677    2      ALTRETURN;
     1066     8678                    /*E*   ERROR:   FMO-E$BADFTYPE-E
     1067     8679                           MESSAGE:Bad field type for IREL key% in %UF%
     1068     8680                           MESSAGE1:An IREL key% in %UF% uses a field
     1069     8681                                    which either has a type illegal for a key
     1070     8682                                    field or defines the elements of a LIST.
     1071     8683                                    F$DCB.ARS# contains the key number of the
     1072     8684                                    bad key (INDX - 1).
     1073     8685                    */
     1074     8686    2   FMOE$NOFLD: ;
     1075     8687    2      B$JIT.ERR=FMO$E$NOFLD;
     1076     8688    2      ALTRETURN;
     1077     8689                    /*E*   ERROR:   FMO-E$NOFLD-E
     1078     8690                           MESSAGE:No fields defined% for %UF%.
     1079     8691                           MESSAGE1:IREL files or files specifying VLP_IRREC
     1080     8692                                    must specify field definitions. See
     1081     8693                                    VLP_RECFIELD %for %UF%.
     1082     8694                    */
     1083     8695    2   FMOE$BADIKEY: ;
     1084     8696    2      B$JIT.ERR=FMO$E$BADIKEY;
     1085     8697    2      F$DCB.ARS=I;
     1086     8698    2      ALTRETURN;
     1087     8699                    /*E*   ERROR:   FMO-E$BADIKEY-E
     1088     8700                           MESSAGE:No such field for IREL key% of %UF%.
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:35   
     1089     8701                           MESSAGE1: No such field for IREL key% in %UF%.
     1090     8702                                     F$DCB.ARS# contains the key number
     1091     8703                                     (INDX - 1) of the bad key.
     1092     8704                    */
     1093     8705    2   FMOE$BADKEYLEN: ;
     1094     8706    2      B$JIT.ERR=FMO$E$BADKEYLEN;
     1095     8707    2      F$DCB.ARS=I;
     1096     8708    2      ALTRETURN;
     1097     8709                    /*E*   ERROR:   FMO-E$BADKEYLEN-E
     1098     8710                           MESSAGE:Key field after byte 4000% for %UF%.
     1099     8711                           MESSAGE1: Key field after byte 4000% for %UF%.
     1100     8712                                     F$DCB.ARS# contains the key number
     1101     8713                                     (INDX - 1) of the bad key.
     1102     8714                    */
     1103     8715    2   FMOE$BIGKEY: ;
     1104     8716    2      B$JIT.ERR=FMO$E$BIGKEY;
     1105     8717    2      F$DCB.ARS=I;
     1106     8718    2      ALTRETURN;
     1107     8719                    /*E*   ERROR:   FMO-E$BIGKEY-E
     1108     8720                           MESSAGE:IREL key too long% for %UF%.
     1109     8721                           MESSAGE1:The total size of the IREL key plus slack
     1110     8722                                    bits required to byte align fields when
     1111     8723                                    forming keys exceeds 511 bytes% for %UF%.
     1112     8724                                    F$DCB.ARS# contains the key number
     1113     8725                                    (INDX - 1) of the bad key.
     1114     8726                    */
     1115     8727    2   FMOE$BADSTART:;
     1116     8728    2      B$JIT.ERR=FMO$E$BADSTART;
     1117     8729    2      F$DCB.ARS=I;
     1118     8730    2      ALTRETURN;
     1119     8731                    /*E*  ERROR:    FMO-E$BADSTART-E
     1120     8732                          MESSAGE:  Key field after variable length field% for %UF%
     1121     8733                          MESSAGE1: A field in an IREL key may not follow a variable
     1122     8734                                    length field% for %UF%. F$DCB.ARS# contains the
     1123     8735                                    key number of the bad key (INDX - 1).
     1124     8736                    */
     1125     8737    2   FMOE$BADALIGN:;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:36   
     1126     8738    2      B$JIT.ERR=FMO$E$BADALIGN;
     1127     8739    2      F$DCB.ARS=I;
     1128     8740    2      ALTRETURN;
     1129     8741                    /*E*  ERROR:    FMO-E$BADALIGN-E
     1130     8742                          MESSAGE:  Integer field in IREL key not byte aligned% for %UF%
     1131     8743                          MESSAGE1: An SBIN or UBIN field used in an IREL key must
     1132     8744                                    be byte aligned and have a bit length evenly
     1133     8745                                    divisible by 9. F$DCB.ARS# contains the key
     1134     8746                                    number (INDX - 1) of the bad key for% %UF%.
     1135     8747                    */
     1136     8748
     1137     8749    2   END FMO$CHKIKEYS;
     1138     8750        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:37   
     1139     8751    1   FMO$BLDIKEYS: PROC ALTRET;
     1140     8752
     1141     8753    2   DCL N SBIN;
     1142     8754    2   DCL FN SBIN;
     1143     8755
     1144     8756    2      I=(KFIELD.NFIELDS+1)/2+1;
     1145     8757    2      CALL FMO$FITSPACE(I) ALTRET(ERR);
     1146     8758    2      I=I*4;
     1147     8759    2      LOC$->ZAP_I='0'B; /* Init CODE19 to zeroes */
     1148     8760    2      I=SIZEW(CODE20.K(0))*IRKEYS.NKEYS+2;
     1149     8761    2      CODE=20;
     1150     8762    2      CALL FMO$FITSPACE(I) ALTRET(ERR);
     1151     8763    2      I=I*4;
     1152     8764    2      LOC$->ZAP_I='0'B; /* Init CODE20 to zeroes */
     1153     8765    2      CODE19$=FIT$;
     1154     8766    2      CALL FMO$LOCCODP(CODE19$, 19);
     1155     8767    2      CODE=19;
     1156     8768
     1157     8769    2      CODE19.NKEYS=IRKEYS.NKEYS;
     1158     8770    2      CODE20.NKEYS=IRKEYS.NKEYS;
     1159     8771    2      CODE20.ALTBLD=IRKEYS.ALTBLD;
     1160     8772    2      CODE20.UNIQUEBLD=IRKEYS.UNIQUEBLD;
     1161     8773
     1162     8774    3      DO I=0 TO IRKEYS.NKEYS-1;
     1163     8775    3         K=IRKEYS.K.FIRSTFIELD(I);
     1164     8776    3         CODE19.K.UNIQUE(K)=IRKEYS.K.UNIQUE(I);
     1165     8777    3         K=K+IRKEYS.K.NFIELDS(I)-1;
     1166     8778    3         CODE19.K.KEYEND(K)='1'B;
     1167     8779
     1168     8780    3         CODE20.K.TDALVL(I)=IRKEYS.K.TDALVL(I);
     1169     8781    3         CODE20.K.TDA(I)=IRKEYS.K.TDA(I);
     1170     8782    3         CODE20.K.FDA(I)=IRKEYS.K.FDA(I);
     1171     8783    3         CODE20.K.LDA(I)=IRKEYS.K.LDA(I);
     1172     8784
     1173     8785    3         IRKEYS.K.DEGENERATE(I) = '1'B; /* Assume it's a degenerate key. */
     1174     8786    3         IRKEYS.K.CONTIGUOUS(I) = '1'B; /* Also assume the fields are contiguous */
     1175     8787    3         FN = -1;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:38   
     1176     8788    4         DO N = IRKEYS.K.FIRSTFIELD(I) TO K;
     1177     8789    4            IF FN > -1 THEN /* Past the first field of the key? */
     1178     8790    4               IF FN+1 ~= KFIELD.FIELD(N) THEN /* The next field in the record? */
     1179     8791    4                  IRKEYS.K.CONTIGUOUS(I) = '0'B; /* No.  Not contiguous. */
     1180     8792    4            CODE19.K.FIELDN(N) = KFIELD.FIELD(N);
     1181     8793    4            FN = CODE19.K.FIELDN(N);
     1182     8794    4            IF   RECFIELD.FIELD.TYPE(FN) ~= %CHAR_DATATYPE AND
     1183     8795    4              RECFIELD.FIELD.TYPE(FN) ~= %UBIN_DATATYPE AND
     1184     8796    4              RECFIELD.FIELD.TYPE(FN) ~= %UTS_DATATYPE  AND
     1185     8797    4              RECFIELD.FIELD.TYPE(FN) ~= %UDNS_DATATYPE THEN
     1186     8798    4               IRKEYS.K.DEGENERATE(I) = '0'B; /* Not degenerate. */
     1187     8799    4            END;
     1188     8800
     1189     8801    3         CODE20.K.DEGENERATE(I) = IRKEYS.K.DEGENERATE(I);
     1190     8802    3         CODE20.K.CONTIGUOUS(I) = IRKEYS.K.CONTIGUOUS(I);
     1191     8803    3         END;
     1192     8804    2      RETURN;
     1193     8805    2   ERR: ALTRETURN;
     1194     8806    2   END FMO$BLDIKEYS;
     1195     8807        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:39   
     1196     8808                    /*I*     NAME:    FMO$FITSPACE
     1197     8809                     PURPOSE: To insure that there is enough space to add or replace
     1198     8810                     an entry in the FIT granule.
     1199     8811                     DESCRIPTION: The single parameter is the words needed.
     1200     8812                     CODE is the entry to be added/replaced. If the current entry is
     1201     8813                     O.K. LOC$ is set to point to it. Else if there is enough room
     1202     8814                     in the FIT granule, it is shuffled and LOC$ points to the hole.
     1203     8815                     If there is no CODE entry, one is made and LOC$ points to its
     1204     8816                     space. In any case, all NAVX,FCEX,AVAIL,NAW,NDW, etc. values
     1205     8817                     are left in a state consistent with the new structure.  If
     1206     8818                     the existing FIT granule is too small and is not already one,
     1207     8819                     it becomes an AFIT and the FIT information is removed from the
     1208     8820                     first file granule.
     1209     8821                    */
     1210     8822    1   FMO$FITSPDIR: ENTRY(DUMMY)ALTRET;
     1211     8823    1      JDCB$=B$JIT.DCB$;
     1212     8824    1      T$$=ADDR(T$);
     1213     8825    1      BUFNO=1;
     1214     8826    1      IBIT=PN$;
     1215     8827    1      CODE=ADDR(I)->FM$FIT.CODES.CODE(0);
     1216     8828    1      BUF$=FM$BUF$(F$DCB.BFR.BUFX(1));
     1217     8829    1      FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));
     1218     8830    1      CFU$=ADDR(BUFNO); /* FOR AFIT TEST AFTER CALL TO MOVKEYS */
     1219     8831    1      CALL FMO$FITSPACE(I)ALTRET(FMOE$VLPERR);
     1220     8832    1      RETURN;
     1221     8833    1   FMO$FITSPACE: PROC(SIZE) ALTRET;
     1222     8834    2   DCL SIZE UBIN ALIGNED;
     1223     8835    2   DCL 1 SZ1 REDEF SIZE ALIGNED,
     1224     8836    2         2 NAW UBIN HALF UNAL,
     1225     8837    2         2 NDW UBIN HALF UNAL;
     1226     8838    2   DCL TMP UBIN;
     1227     8839    2   DCL INDX UBIN;
     1228     8840    2   FITSP0:;
     1229     8841    2      K=SZ1.NDW;
     1230     8842    2      IF K<SZ1.NAW THEN K=SZ1.NAW;
     1231     8843    3      IF ADDR(SIZE)->FM$FIT.CODES.CODE(0)~=0 THEN DO;
     1232     8844    3         K=ADDR(SIZE)->FM$FIT.CODES.NAW(0);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:40   
     1233     8845    3         IF K<ADDR(SIZE)->FM$FIT.CODES.NDW(0)
     1234     8846    3         THEN K=ADDR(SIZE)->FM$FIT.CODES.NDW(0);
     1235     8847    3         END;
     1236     8848    2      J=1;     /* FIRST TRY TO FIND THE ENTRY */
     1237     8849    3      DO WHILE (J<=FM$FIT.CODES.CODE(0));
     1238     8850    3         IF FM$FIT.CODES.CODE(J)=CODE THEN GOTO FITSP1;
     1239     8851    3         J=J+1;
     1240     8852    3         END;
     1241     8853    2      LOC$=PINCRW(FIT$,J);
     1242     8854    2      IF SIZE=0 THEN RETURN;
     1243     8855    3      IF J>=FM$FIT.CODES.NAW(0) THEN DO;
     1244     8856    3         K=K+1; /* GET SPACE FOR CONTROL WORD TOO */
     1245     8857    3         GOTO FITSP9;
     1246     8858    3         END;
     1247     8859    2      FM$FIT.CODES(J)='0'B;
     1248     8860    2      FM$FIT.CODES.CODE(J)=CODE;
     1249     8861    2      FM$FIT.CODES.CODE(0)=J;
     1250     8862    2   FITSP1:;
     1251     8863    2      IF FM$FIT.CODES.NAW(J)=0
     1252     8864    2      THEN FM$FIT.CODES.ITEMX(J)=FM$FIT.CODES.ITEMX(1);
     1253     8865    2      LOC$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(J)); /* POINT TO DATA */
     1254     8866    3      IF FM$FIT.CODES.NAW(J)>=K THEN DO;
     1255     8867    3         IF ADDR(SIZE)->FM$FIT.CODES.CODE(0)~=0
     1256     8868    3         THEN SIZE=ADDR(SIZE)->FM$FIT.CODES.NDW(0);
     1257     8869    3         IF SZ1.NAW>0 THEN SIZE=SZ1.NDW;
     1258     8870    3         IF CODE~=1 THEN FM$FIT.CODES.NDW(J)=SIZE;
     1259     8871    3         RETURN;
     1260     8872    3         END;
     1261     8873    2      K=K-FM$FIT.CODES.NAW(J);
     1262     8874    2      LOC$=PINCRW(LOC$,FM$FIT.CODES.NAW(J)); /* DONT CLOBBER EXISTING DATA */
     1263     8875    2      IF CODE=1 AND K<FM$GRAN.AVAIL
     1264     8876    2      THEN IF FM$GRAN.AVAIL<16 THEN K=FM$GRAN.AVAIL;
     1265     8877    2         ELSE K=16;
     1266     8878    2   FITSP9:;
     1267     8879    2      IF FM$GRAN.NAVX+FM$GRAN.AVAIL~=1024 THEN GOTO FITSP$AFIT;
     1268     8880    2      IF FM$GRAN.KEYCNT~=0 AND BUFNO=1 AND CODE~=1
     1269     8881    3        AND K+FM$GRAN.FCEX<=1024-SIZEW(FM$KEYTBL) THEN DO;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:41   
     1270     8882    3         CALL FMG$MOVKEYS(K) ALTRET(FITSP$GOTAFIT);
     1271     8883    3         IF FM$GRAN.NAVX+FM$GRAN.AVAIL~=1024 THEN GOTO FITSP$AFIT;
     1272     8884    3         IF FM$CFU.AFIT~=0 THEN GOTO FITSP$GOTAFIT;
     1273     8885                    /* THE MOVE ALLOCATED SPACE, AND MADE AN AFIT */
     1274     8886    3         T$=LOC$;
     1275     8887    3         CALL FMR$SLIDE(XT$,K,FM$GRAN.FCEX-POFFW(LOC$,BUF$)-K);
     1276     8888    3         END;
     1277     8889    3      ELSE DO;
     1278     8890    3         IF K>FM$GRAN.AVAIL THEN GOTO FITSP$AFIT;
     1279     8891    3         T$=LOC$;
     1280     8892    3         CALL FMR$SLIDE(XT$,K,FM$GRAN.NAVX-POFFW(LOC$,BUF$));
     1281     8893    3         FM$GRAN.NAVX=FM$GRAN.NAVX+K;
     1282     8894    3         FM$GRAN.AVAIL=FM$GRAN.AVAIL-K;
     1283     8895    3         FM$GRAN.FCEX=FM$GRAN.FCEX+K;
     1284     8896    3         END;
     1285     8897    3      IF J>FM$FIT.CODES.CODE(0) THEN DO;
     1286     8898    3         FM$FIT.CODES.CODE(0)=J;
     1287     8899    3         FM$FIT.CODES.NAW(0)=J+1;
     1288     8900    3         FM$FIT.CODES(J)=BINBIT(-1,36);
     1289     8901    3         FM$FIT.CODES.ITEMX(J)=J+1;
     1290     8902    3         FM$FIT.CODES.CODE(J)=CODE;
     1291     8903    3         END;
     1292     8904    2      FM$FIT.CODES.NDW(0)=FM$FIT.CODES.NDW(0)+K;
     1293     8905    2      FM$FIT.CODES.NAW(J)=FM$FIT.CODES.NAW(J)+K;
     1294     8906    2      J=0;
     1295     8907    3      DO WHILE (J<=FM$FIT.CODES.CODE(0));
     1296     8908    3         IF FM$FIT.CODES.ITEMX(J)>=POFFW(LOC$,FIT$) AND
     1297     8909    3           FM$FIT.CODES.CODE(J)~=CODE THEN
     1298     8910    3            FM$FIT.CODES.ITEMX(J)=FM$FIT.CODES.ITEMX(J)+K;
     1299     8911    3         J=J+1;
     1300     8912    3         END;
     1301     8913    2      LOC$=PINCRW(BUF$,FM$GRAN.FCEX); /* POINT TO KEYTBL */
     1302     8914    3      IF (BUFNO~=1 OR CODE=1) AND FM$GRAN.KEYCNT~=0 THEN DO;
     1303     8915    4         DO INDX=1 TO FM$GRAN.KEYCNT;
     1304     8916    4            TMP=LOC$->FM$KEYTBL(INDX)+K; /* NEW VALUE */
     1305     8917    4            IF INDX>=LOC$->FM$KEYTBL(0) THEN
     1306     8918    4               TMP=TMP+512;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:42   
     1307     8919    4            IF TMP>=512 AND INDX<LOC$->FM$KEYTBL(0) THEN
     1308     8920    4               LOC$->FM$KEYTBL(0)=INDX; /* SET NEW BOUNDARY */
     1309     8921    4            LOC$->FM$KEYTBL(INDX)=TMP;
     1310     8922    4            END;
     1311     8923    3         F$DCB.MOVED=K;
     1312     8924    3         END;
     1313     8925    2      GOTO FITSP0; /* REESTABLISH J,LOC$ */
     1314     8926        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:43   
     1315     8927    2   FITSP$AFIT:; /* NO ROOM HERE, TRY FOR AN AFIT */
     1316     8928    2      IF FM$GRAN.LVL=6
     1317     8929    2        OR F$DCB.IASN~=%FILE#
     1318     8930    2        OR FM$CFU.XTX=0
     1319     8931    2        OR FM$GRAN.FCEX+K>1024 THEN
     1320     8932    3      DO;      /* Already been here */
     1321     8933    3         IF B$JIT.ERR='0'B THEN
     1322     8934    3            B$JIT.ERR=FMO$E$VLPERR;
     1323     8935    3         ALTRETURN;
     1324     8936    3         END;
     1325     8937    2      CALL FAG$GAFIT(K)ALTRET(FITSP$GOTAFIT);
     1326     8938    2      CALL FMN$GETFIT(BUF$,BUFNO);
     1327     8939    2      FIT$=BUF$; /* USE TWO BUFFERS IF WE'RE IN CLOSE */
     1328     8940    3      IF BUFNO~=4 THEN DO;
     1329     8941    3         CALL FMD$GETBUF(4,1,XT$);
     1330     8942    3         FIT$=T$;
     1331     8943    3         FIT$->GRAN=BUF$->GRAN;
     1332     8944    3         END;
     1333     8945    3      ELSE DO;
     1334     8946    3         CALL FMD$FLSHBUF(BUFNO);
     1335     8947    3         J=FM$CFU.FITSDA;
     1336     8948    3         F$DCB.GTYP=FMGTFIT;
     1337     8949    3         CALL FMD$REDBUFBC(XT$, BUFNO, J);
     1338     8950    3         FIT$=T$;
     1339     8951    3         END;
     1340     8952    2      JDCB$->F$DCB.BFR.DA(4)=K;
     1341     8953    2      FIT$->FM$GRAN.LVL=6;
     1342     8954    2      FIT$->FM$GRAN.STAMP.GMOD=K;
     1343     8955    2      FIT$->FM$GRAN.NAVX=FIT$->FM$GRAN.FCEX;
     1344     8956    2      FIT$->FM$GRAN.AVAIL=1024-FIT$->FM$GRAN.FCEX;
     1345     8957    2      FIT$->FM$GRAN.KEYCNT=0;
     1346     8958    2      FIT$->FM$GRAN.FLINK=0;
     1347     8959    2      CALL FMD$WRTSV(4);
     1348     8960    3      IF MOD(FM$CFU.FUN,4)~=%CREATE# THEN DO;
     1349     8961    3         J=FM$CFU.FITSDA;
     1350     8962    3         FM$CFU.FITSDA=K;
     1351     8963    3         CALL FMP$AFITCTG;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:44   
     1352     8964    3         FM$CFU.FITSDA=J;
     1353     8965    3         END;
     1354     8966    2      IF F$DCB.IORG=%KEYED# OR (F$DCB.ACS=%BLOCK# AND (F$DCB.ORG=%KEYED#
     1355     8967    2        OR F$DCB.ORG=%INDEXED# OR F$DCB.ORG=%IREL#)) THEN
     1356     8968    3      DO;
     1357     8969    3         CALL FMN$GETFIT(BUF$,BUFNO);
     1358     8970    3         J=SIZEW(FM$GRAN)-FM$GRAN.FCEX; /* SQUEEZE FIT OUT OF FRZERO */
     1359     8971    3         FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));
     1360     8972    3         T$=FIT$;
     1361     8973    3         CALL FMR$SLIDE(XT$,J,FM$GRAN.NAVX-FM$GRAN.FCEX);
     1362     8974    3         FM$GRAN.NAVX=FM$GRAN.NAVX+J;
     1363     8975    3         FM$GRAN.AVAIL=FM$GRAN.AVAIL-J;
     1364     8976    3         FM$GRAN.FCEX=SIZEW(FM$GRAN);
     1365     8977    3         INDX=FM$GRAN.KEYCNT;
     1366     8978    4         DO WHILE(INDX>0);
     1367     8979    4            TMP=FIT$->FM$KEYTBL(INDX)+J;
     1368     8980    4            IF INDX>=FIT$->FM$KEYTBL(0) THEN
     1369     8981    4               TMP=TMP+512;
     1370     8982    4            IF TMP<512 AND INDX>=FIT$->FM$KEYTBL(0) THEN
     1371     8983    4               FIT$->FM$KEYTBL(0)=INDX+1;
     1372     8984    4            FIT$->FM$KEYTBL(INDX)=TMP;
     1373     8985    4            INDX=INDX-1;
     1374     8986    4            END;
     1375     8987    3         F$DCB.MOVED=J;
     1376     8988    3         IF FIT$->FM$KEYTBL(0)>FM$GRAN.KEYCNT THEN
     1377     8989    3            FIT$->FM$KEYTBL(0)=SIZEC(FM$KEYTBL);
     1378     8990    3         F$DCB.BFR.SCRUB(BUFNO)='1'B;
     1379     8991    4         IF BUFNO=1 THEN DO;
     1380     8992    4            CALL FMD$WRTSV(BUFNO);
     1381     8993    4            END;
     1382     8994    3         ELSE CALL FMD$WRTBUF(BUFNO);
     1383     8995    3         END;
     1384     8996    2      FM$CFU.AFIT=1;
     1385     8997    2      FM$CFU.FITSDA=K; /* SET THE NEW FITDA */
     1386     8998    2   FITSP$GOTAFIT:;
     1387     8999    2      IF F$DCB.IASN=%FILE# THEN CALL FMN$GETFIT(BUF$,BUFNO);
     1388     9000    2      FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:45   
     1389     9001    2      IF B$JIT.ERR='0'B THEN GOTO FITSP0; /* AT LAST..TRY AGAIN */
     1390     9002    2      ALTRETURN;
     1391     9003    2   END FMO$FITSPACE;
     1392     9004        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:46   
     1393     9005                    /*F*
     1394     9006                    *     NAME:   FMO$MODFIT
     1395     9007                    *
     1396     9008                    *     PURPOSE:  TO MODIFY THE FIT AT CLOSE TIME FROM THE INFORMATION
     1397     9009                    *             IN THE CFU AND THE DCB.
     1398     9010                    */
     1399     9011    1   FMO$MODFIT: ENTRY(DUMMY) ALTRET;
     1400     9012    1      JDCB$=B$JIT$->B$JIT.DCB$;
     1401     9013    1      CFU$=JDCB$->F$DCB.CFU$;
     1402     9014    1      T$$=ADDR(T$);
     1403     9015    1      BUFNO=0;
     1404     9016    1      J=0;     /* INDICATE NO EXTENT TO RELEASE */
     1405     9017    1      IF FM$CFU.XTX=0 THEN GOTO ALLDONE;
     1406     9018    1      CALL FMR$L8; /* MAKE SURE CFU IS FILLED IN */
     1407     9019    1      CALL FMR$U8;
     1408     9020    2      IF JDCB$->F$DCB.SHARED THEN DO; /* THERE MAY BE A RACE TO DO THIS */
     1409     9021    2         CALL UQB$MENQX(F$DCB.CFU$);
     1410     9022    3         IF FM$CFU.FUN=%JRNL# AND FM$CFUJ.PAGE#~=0 THEN DO;
     1411     9023    3            F$DCB.BFR.DA(1)=FM$CFU.LDA;
     1412     9024    3            CALL FMH$MAPJRNL(1);
     1413     9025    3            CALL FMD$FLSHBUF(4);
     1414     9026    3            END;
     1415     9027    3         ELSE DO;
     1416     9028    3            CALL FMU$BLD; /* Try again in case the last two closers tied */
     1417     9029    3            IF FM$CFU.MODCNT=F$DCB.MODCNT THEN EXIT;
     1418     9030    3            BUFNO=5;
     1419     9031    4            DO UNTIL(BUFNO=1);
     1420     9032    4               BUFNO=BUFNO-1;
     1421     9033    4               IF F$DCB.BFR1.CX(BUFNO)=0 THEN CALL FMD$FLSHBUF(BUFNO);
     1422     9034    4               END;
     1423     9035    3            END;
     1424     9036    2         END;
     1425     9037    1      IF F$DCB.FUN=%IN#
     1426     9038    1        AND (FM$CFU.USECNT>1
     1427     9039    1        OR B$JIT.PRIV.ACTIVE.FMEFT)
     1428     9040    1        OR FM$CFU.FITSDA=0
     1429     9041    1        OR F$DCB.STARF
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:47   
     1430     9042    1        AND NOT FM$CFU.FMOD
     1431     9043    1        AND NOT FPT$CLOSE_V.OPER
     1432     9044    1      THEN GOTO ALLDONE;
     1433     9045    1      CALL FMN$GETFIT(BUF$,BUFNO)ALTRET(FMOALTRET);
     1434     9046    1      CALL FMD$FLSHBUF(2-BUFNO/2); /* DONT USE ALL FIVE BUFFERS */
     1435     9047    1      FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));
     1436     9048    1      LOCCODX=3;
     1437     9049    1      CALL LOCCODP ALTRET(DONE);
     1438     9050    1      F$DCB.XTNSIZE=CODE03.XTNSIZE; /* M$EXTEND TRASHES THIS */
     1439     9051    2      IF FPT$CLOSE_V.OPER.CHGATT THEN DO;
     1440     9052    2         F$DCB.GHSTACS=CODE03.GHSTACS;
     1441     9053    2         IF PN$.IFPARAM_~=ADDR(NIL) THEN CALL FMM$IFPARAM(PN$);
     1442     9054    2         IF FPT$CLOSE_V.TYPE~=BINASC(0)
     1443     9055    2           AND (SUBSTR(FPT$CLOSE_V.TYPE,0,1)~='*'
     1444     9056    2           AND SUBSTR(CODE03.TYPE,0,1)~='*'
     1445     9057    2           OR F$DCB.WSR<2
     1446     9058    2           OR B$JIT.PRIV.ACTIVE.FMSEC)
     1447     9059    2         THEN F$DCB.TYPE=FPT$CLOSE_V.TYPE;
     1448     9060    2         IF FPT$CLOSE_V.XTNSIZE~=0 THEN F$DCB.XTNSIZE=FPT$CLOSE_V.XTNSIZE;
     1449     9061    2         F$DCB.DESC=CODE03.DESC;
     1450     9062    2         IF NOT FPT$CLOSE_V.BUPM&'01'B THEN F$DCB.DESC.BUPM=FPT$CLOSE_V.BUPM;
     1451     9063    2         F$DCB.DESC.BUF=F$DCB.DESC.BUPM;
     1452     9064    2         IF FPT$CLOSE_V.EXPIRE~=0 THEN F$DCB.EXPIRE=FPT$CLOSE_V.EXPIRE;
     1453     9065    2         IF (F$DCB.EXPIRE>B$JIT.MAXEXP OR F$DCB.EXPIRE<0) AND B$JIT.MAXEXP>=0
     1454     9066    2         THEN F$DCB.EXPIRE=CODE03.EXPIRE;
     1455     9067    2         IF FPT$CLOSE_V.GHSTACS~=0 THEN F$DCB.GHSTACS=FPT$CLOSE_V.GHSTACS;
     1456     9068    2         IF F$DCB.GHSTACS=%NONE# THEN F$DCB.GHSTACS=0;
     1457     9069    2         IF F$DCB.DESC.BUPM~=CODE03.DESC.BUPM
     1458     9070    2           OR F$DCB.TYPE~=CODE03.TYPE
     1459     9071    2           OR F$DCB.EXPIRE~=CODE03.EXPIRE
     1460     9072    2           OR F$DCB.GHSTACS~=CODE03.GHSTACS
     1461     9073    2           OR F$DCB.XTNSIZE~=CODE03.XTNSIZE
     1462     9074    3         THEN IF NOT F$DCB.FFLG.REATTR THEN DO;
     1463     9075    3               B$JIT.ERR=FMO$E$REATTR;
     1464     9076    3               F$DCB.DESC=CODE03.DESC;
     1465     9077    3               END;
     1466     9078    3            ELSE DO;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:48   
     1467     9079    3               CALL MODIFIED;
     1468     9080    3               CODE03.TYPE=F$DCB.TYPE;
     1469     9081    3               CODE03.XTNSIZE=F$DCB.XTNSIZE;
     1470     9082    3               CODE03.GHSTACS=F$DCB.GHSTACS;
     1471     9083    3               CODE=3;
     1472     9084    3               IF F$DCB.EXPIRE~=CODE03.EXPIRE
     1473     9085    3               THEN CALL FMO$FITSPACE(SIZEW(CODE03))ALTRET(NOXPIRE);
     1474     9086    3               CODE03.EXPIRE=F$DCB.EXPIRE;
     1475     9087    3   NOXPIRE:    ;
     1476     9088    3               CODE03.DESC=F$DCB.DESC;
     1477     9089    3               END;
     1478     9090    3         IF F$DCB.IORG=%KEYED# THEN DO;
     1479     9091    3            T$=FIT$;
     1480     9092    3            CALL FMO$LOCCODP(XT$,2)ALTRET(DONE);
     1481     9093    3            P1$=T$;
     1482     9094    3            IF FPT$CLOSE_V.SPARE~=0 THEN F$DCB.SPARE=FPT$CLOSE_V.SPARE;
     1483     9095    3            IF FPT$CLOSE_V.LSLIDE~=0 THEN F$DCB.LSLIDE=FPT$CLOSE_V.LSLIDE;
     1484     9096    3            IF FPT$CLOSE_V.LRDL0~=0 THEN F$DCB.LRDL0=FPT$CLOSE_V.LRDL0;
     1485     9097    3            IF F$DCB.SPARE~=P1$->CODE02.SPARE
     1486     9098    3              OR F$DCB.LSLIDE~=P1$->CODE02.LSLIDE
     1487     9099    3              OR F$DCB.LRDL0~=P1$->CODE02.LRDL0
     1488     9100    3            THEN IF NOT F$DCB.FFLG.REATTR THEN B$JIT.ERR=FMO$E$REATTR;
     1489     9101    4               ELSE DO;
     1490     9102    4                  P1$->CODE02.SPARE=F$DCB.SPARE;
     1491     9103    4                  P1$->CODE02.LSLIDE=F$DCB.LSLIDE;
     1492     9104    4                  P1$->CODE02.LRDL0=F$DCB.LRDL0;
     1493     9105    4                  CALL MODIFIED;
     1494     9106    4                  END;
     1495     9107    3            END;
     1496     9108    2         LOC$=ADDR(NIL);/* CLEAR MODIFIED FLAG */
     1497     9109    3         DO CODE=9 TO 13; /* FITMOD FOR MODABLE ONES */
     1498     9110    3            CALL FMO$BLDCODE;
     1499     9111    3            IF LOC$=FIT$ THEN CALL MODIFIED;
     1500     9112    3            END;
     1501     9113    2         IF PN$.PASS_~=ADDR(NIL)
     1502     9114    2         THEN IF NOT F$DCB.FFLG.DELF THEN B$JIT.ERR=FMO$E$RENAME;
     1503     9115                    /*E*     ERROR: FMO-E$RENAME-E
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:49   
     1504     9116                             MESSAGE: You cannot change the name or password% of %UF%
     1505     9117                    */
     1506     9118    3            ELSE DO;
     1507     9119    3               I=8;
     1508     9120    3               F$DCB.PASS=PN$.PASS_->REC;
     1509     9121    3               CODE=7;
     1510     9122    4               IF F$DCB.PASS=' ' THEN DO;
     1511     9123    4                  F$DCB.PASSF='0'B;
     1512     9124    4                  T$=FIT$;
     1513     9125    4                  CALL FMO$LOCCODX(XT$,CODE)ALTRET(NOMOD);
     1514     9126    4                  IF FM$FIT.CODES.NDW(CODE)=0 THEN GOTO NOMOD;
     1515     9127    4                  FM$FIT.CODES.NDW(CODE)=0;
     1516     9128    4                  END;
     1517     9129    4               ELSE DO;
     1518     9130    4                  CALL FMM$SCRAMBLE(F$DCB.PASS);
     1519     9131    4                  F$DCB.PASSF='1'B;
     1520     9132    4                  CALL FMO$BLDCODE;
     1521     9133    4                  END;
     1522     9134    3               CALL MODIFIED;
     1523     9135    3               END;
     1524     9136    2   NOMOD: ;
     1525     9137    2         J=0;
     1526     9138    2         LOCCODX=3;
     1527     9139    2         CALL LOCCODP ALTRET(DONE);
     1528     9140    2         END;
     1529     9141    1      IF FM$CFU.USECNT>1 AND FM$CFU.FUN~=%JRNL#
     1530     9142    1        OR F$DCB.ACS=%BLOCK# AND F$DCB.FUN=%CREATE#
     1531     9143    1      THEN GOTO DONE;
     1532     9144                    /* */
     1533     9145    2      IF (F$DCB.ASN=%FILE# OR F$DCB.ASN=%TAPE#) THEN DO;
     1534     9146                    /* Don't replace IRREC if RECFIELD is specified, but not used */
     1535     9147    2         NEW_RECFIELD='0'B;
     1536     9148    2         IF NOT FPT$CLOSE_V.OPER.CHGATT THEN
     1537     9149    2            GOTO NO_IRREC;
     1538     9150    2         IF CPN$.RECFIELD_~=B$PS2$ THEN
     1539     9151    2            GOTO NO_RECFIELD;
     1540     9152    2         CALL HFF$DSIZ(B$PS2$,I);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:50   
     1541     9153    2         IF I=0 THEN
     1542     9154    2            GOTO NO_RECFIELD;
     1543     9155    2         IF VLP$RECFIELD.VLPID# ~= 511 THEN
     1544     9156    2            GOTO NO_RECFIELD;
     1545     9157                    /* If this is an IREL file, RECFIELD can't be altered since keys
     1546     9158                       can't be changed, and altering the physical fields may alter
     1547     9159                       the keys. Since we won't use RECFIELD, we can't use IRREC
     1548     9160                       either since we must assume that the two are intended to be a
     1549     9161                       matched set. (If the user didn't specify a new RECFIELD for
     1550     9162                       an IREL file, it's OK for him to change IRREC.)           */
     1551     9163    2         IF F$DCB.ORG=%IREL# THEN
     1552     9164    2            GOTO NO_IRREC;
     1553     9165    3         IF NOT F$DCB.FFLG.REATTR THEN DO;
     1554     9166    3            B$JIT.ERR=FMO$E$REATTR;
     1555     9167    3            GOTO NO_IRREC;
     1556     9168    3            END;
     1557     9169    2         IF I/2-2 < VLP$RECFIELD.NFIELDS# OR VLP$RECFIELD.NFIELDS# > 511
     1558     9170    3         THEN DO;
     1559     9171    3            B$JIT.ERR=FMO$E$BADVECT2;
     1560     9172    3            GOTO NO_IRREC;
     1561     9173    3            END;
     1562     9174                    /*E*  ERROR:    FMO-E$BADVECT2-E
     1563     9175                          MESSAGE:  Bad RECFIELD vector on close% of %UF%
     1564     9176                          MESSAGE1: On close% of %UF%, the RECFIELD vector
     1565     9177                                    was bad because it either (1) framed an area
     1566     9178                                    too small to hold all specified fields, (2)
     1567     9179                                    specified more than 511 fields, or (3)
     1568     9180                                    invalidated existing IRREC information and no
     1569     9181                                    new IRREC vector was specified. Previous
     1570     9182                                    values for RECFIELD and IRREC retained.
     1571     9183                    */
     1572     9184    2         NEWSIZE=(B$PS2$->VLP$RECFIELD.NFIELDS#+1)/2 + 1;
     1573     9185    2         CALL FSA$GSP(NEWSIZE,XT$) ALTRET(NO_IRREC);
     1574     9186    2         P1$=T$;
     1575     9187    2         J=NEWSIZE*4;
     1576     9188    2         P1$->ZAPJ=B$PS2$->ZAPJ;
     1577     9189    2         SAVE_FIELDX=F$DCB.FIELDX;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:51   
     1578     9190    2         F$DCB.FIELDX=POFFW(P1$,B$ROSEG$);
     1579     9191    2         SAVE_STARTX=F$DCB.STARTX;
     1580     9192    2         F$DCB.STARTX=0;
     1581     9193    2         FIELD$=P1$; /* FIELD$ must be set for FMO$CHKRECFIELD */
     1582     9194    2         CALL FMO$CHKRECFIELD ALTRET(RSTR_RECFIELD_ROSEG);
     1583     9195    2         CALL FMO$FIELD_START_SETUP ALTRET(RSTR_RECFIELD_ROSEG);
     1584     9196    2         NEWSIZE=(P1$->RECFIELD.NFIELDS+1)/2 + 1;
     1585     9197    2         CODE=18;
     1586     9198    2         CALL FMO$FITSPACE(NEWSIZE) ALTRET(RSTR_RECFIELD_ROSEG);
     1587     9199    2         J=NEWSIZE*4;
     1588     9200    2         LOC$->MOVEJ=P1$->MOVEJ;
     1589     9201    2         NEW_RECFIELD='1'B;
     1590     9202    3         IF '0'B THEN DO;
     1591     9203    3   RSTR_OLD_RECFIELD:;
     1592     9204    4            IF NEW_RECFIELD THEN DO;
     1593     9205    5               IF SAVE_FIELDX~=0 THEN DO;
     1594     9206    5                  FIELD$=PINCRW(B$ROSEG$,SAVE_FIELDX);
     1595     9207    5                  NEWSIZE=(RECFIELD.NFIELDS+1)/2 + 1;
     1596     9208    5                  CODE=18;
     1597     9209    5                  CALL FMO$FITSPACE(NEWSIZE) ALTRET(NO_IRREC);/* shouldn't altret */
     1598     9210    5                  J=NEWSIZE*4;
     1599     9211    5                  LOC$->MOVEJ=FIELD$->MOVEJ;
     1600     9212    5                  END;
     1601     9213    4               ELSE GOTO NO_IRREC; /* Leave the new RECFIELD since no
     1602     9214                    RECFIELD or IRREC existed before
     1603     9215                    and it would be painful to delete
     1604     9216                    the new RECFIELD.              */
     1605     9217    4   RSTR_RECFIELD_ROSEG:;
     1606     9218    5               IF F$DCB.FIELDX~=0 THEN DO;
     1607     9219    5                  FIELD$=PINCRW(B$ROSEG$,F$DCB.FIELDX);
     1608     9220    5                  K=(RECFIELD.NFIELDS+1)/2 + 1;
     1609     9221    5                  CALL FSA$FSP(K,FIELD$);
     1610     9222    5                  END;
     1611     9223    4               F$DCB.FIELDX=SAVE_FIELDX;
     1612     9224    5               IF F$DCB.STARTX~=0 THEN DO;
     1613     9225    5                  START$=PINCRW(B$ROSEG$,F$DCB.STARTX);
     1614     9226    5                  K=START$->FIELD_START.NWORDS;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:52   
     1615     9227    5                  CALL FSA$FSP(K,START$);
     1616     9228    5                  END;
     1617     9229    4               F$DCB.STARTX=SAVE_STARTX;
     1618     9230    4               NEW_RECFIELD='0'B;
     1619     9231    4               END;
     1620     9232    3            GOTO NO_IRREC;
     1621     9233    3            END;
     1622     9234    2   NO_RECFIELD:;
     1623     9235    3         IF CPN$.IRREC_~=B$PS1$ THEN DO;
     1624     9236    3   CHK_OLD_IRREC:;
     1625     9237    4            IF NEW_RECFIELD AND F$DCB.IRRECX > 0 THEN DO;
     1626     9238    4               IRREC$=PINCRW(B$ROSEG$,F$DCB.IRRECX);
     1627     9239    5               CALL FMO$CHKIRREC(IRREC$) WHENALTRETURN DO;
     1628     9240    5                  B$JIT.ERR=FMO$E$BADVECT2;
     1629     9241    5                  GOTO RSTR_OLD_RECFIELD;
     1630     9242    5                  END;
     1631     9243    4               END;
     1632     9244    3            GOTO NO_IRREC;
     1633     9245    3            END;
     1634     9246    2         CALL HFF$DSIZ(B$PS1$,I);
     1635     9247    2         IF I=0 THEN
     1636     9248    2            GOTO CHK_OLD_IRREC;
     1637     9249    2         IF VLP$IRREC.VLPID# ~= 511 THEN
     1638     9250    2            GOTO NO_IRREC;
     1639     9251    3         IF NOT F$DCB.FFLG.REATTR THEN DO;
     1640     9252    3            B$JIT.ERR=FMO$E$REATTR;
     1641     9253    3            GOTO NO_IRREC;
     1642     9254    3            END;
     1643     9255    3         IF F$DCB.FIELDX=0 THEN DO;
     1644     9256    3            B$JIT.ERR=FMO$E$BADVECT1;
     1645     9257    3            GOTO NO_IRREC;
     1646     9258    3            END;
     1647     9259    3         IF I-4 < VLP$IRREC.NFIELDS# OR VLP$IRREC.NFIELDS# > 511 THEN DO;
     1648     9260    3            B$JIT.ERR=FMO$E$BADVECT1;
     1649     9261    3            GOTO RSTR_OLD_RECFIELD;
     1650     9262    3            END;
     1651     9263    3         CALL FMO$CHKIRREC(B$PS1$) WHENALTRETURN DO;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:53   
     1652     9264    3            B$JIT.ERR=FMO$E$BADVECT1;
     1653     9265    3            GOTO RSTR_OLD_RECFIELD;
     1654     9266    3            END;
     1655     9267                    /*E*  ERROR:    FMO-E$BADVECT1-E
     1656     9268                          MESSAGE:  Bad IRREC vector on close% of %UF%
     1657     9269                          MESSAGE1: IRREC_ on close% of %UF% was bad
     1658     9270                                    for one of the following reasons:
     1659     9271                                    (1) the area framed was too small to hold all
     1660     9272                                    the specified fields; (2) NFIELDS was greater
     1661     9273                                    than the number of fields defined in the
     1662     9274                                    file or greater than 511; (3) it referenced
     1663     9275                                    one or more fields not defined in the file
     1664     9276                                    or defined as list elements; (4) no fields
     1665     9277                                    were defined for the file. Previous values for
     1666     9278                                    RECFIELD and IRREC retained if they existed.
     1667     9279                    */
     1668     9280    2         NEWSIZE=(B$PS1$->VLP$IRREC.NFIELDS#+3)/4 + 1;
     1669     9281    2         CALL FSA$GSP(NEWSIZE,XT$) ALTRET(RSTR_OLD_RECFIELD);
     1670     9282    2         P1$=T$;
     1671     9283    2         J=NEWSIZE*4;
     1672     9284    2         P1$->ZAPJ=B$PS1$->ZAPJ;
     1673     9285    2         NEWSIZE=(P1$->IRREC.NFIELDS+3)/4 + 1;
     1674     9286    2         CODE=21;
     1675     9287    3         CALL FMO$FITSPACE(NEWSIZE) WHENALTRETURN DO;
     1676     9288    3            K=(P1$->IRREC.NFIELDS+3)/4 + 1;
     1677     9289    3            CALL FSA$FSP(K,P1$);
     1678     9290    3            GOTO RSTR_OLD_RECFIELD;
     1679     9291    3            END;
     1680     9292    2         J=NEWSIZE*4;
     1681     9293    2         LOC$->MOVEJ=P1$->MOVEJ;
     1682     9294    3         IF F$DCB.IRRECX~=0 THEN DO;
     1683     9295    3            IRREC$=PINCRW(B$ROSEG$,F$DCB.IRRECX);
     1684     9296    3            K=(IRREC$->IRREC.NFIELDS+3)/4 + 1;
     1685     9297    3            CALL FSA$FSP(K,IRREC$);
     1686     9298    3            END;
     1687     9299    2         F$DCB.IRRECX=POFFW(P1$,B$ROSEG$);
     1688     9300    2   NO_IRREC:;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:54   
     1689     9301    3         IF NEW_RECFIELD THEN DO;
     1690     9302    4            IF SAVE_FIELDX~=0 THEN DO;
     1691     9303    4               FIELD$=PINCRW(B$ROSEG$,SAVE_FIELDX);
     1692     9304    4               K=(RECFIELD.NFIELDS+1)/2 + 1;
     1693     9305    4               CALL FSA$FSP(K,FIELD$);
     1694     9306    4               END;
     1695     9307    4            IF SAVE_STARTX~=0 THEN DO;
     1696     9308    4               START$=PINCRW(B$ROSEG$,SAVE_STARTX);
     1697     9309    4               K=START$->FIELD_START.NWORDS;
     1698     9310    4               CALL FSA$FSP(K,START$);
     1699     9311    4               END;
     1700     9312    3            END;
     1701     9313    2         J=0;
     1702     9314    2         LOCCODX=3;
     1703     9315    2         CALL LOCCODP ALTRET(DONE);
     1704     9316    2         END;
     1705     9317                    /* */
     1706     9318    2      IF F$DCB.ALTKEYX~=0 THEN DO;
     1707     9319    2         ALTKEY$=PINCRW(B$ROSEG$, F$DCB.ALTKEYX);
     1708     9320    3         IF F$DCB.ORG=%INDEXED# THEN DO;
     1709     9321    3            LOCCODX=8;
     1710     9322    3            CALL LOCCODP ALTRET(NOALT);
     1711     9323    3            I=FITALTKEYS.NUMWRDS*4;
     1712     9324    3            LOC$->REC=ALTKEY$->REC;
     1713     9325    3            FITALTKEYS.ALTBLD=FM$CFU.ALTBLD;
     1714     9326    3            END;
     1715     9327    3         ELSE IF F$DCB.ORG=%IREL# THEN DO;
     1716     9328    3               LOCCODX=20;
     1717     9329    3               CALL LOCCODP ALTRET(NOALT);
     1718     9330    3               CODE20.ALTBLD=FM$CFU.ALTBLD;
     1719     9331
     1720     9332    4               DO I=0 TO IRKEYS.NKEYS-1;
     1721     9333    4                  CODE20.K.TDALVL(I)=IRKEYS.K.TDALVL(I);
     1722     9334    4                  CODE20.K.TDA(I)=IRKEYS.K.TDA(I);
     1723     9335    4                  CODE20.K.FDA(I)=IRKEYS.K.FDA(I);
     1724     9336    4                  CODE20.K.LDA(I)=IRKEYS.K.LDA(I);
     1725     9337    4                  END;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:55   
     1726     9338    3               END;
     1727     9339    2            ELSE EXIT;
     1728     9340
     1729     9341    2         IF CPN$.ALTKEYS_~=B$PS12$ THEN GOTO NOALT;
     1730     9342    2         CALL HFF$DSIZ(B$PS12$, I);
     1731     9343    2         IF I=0 THEN GOTO NOALT;
     1732     9344    2         IF NOT FPT$CLOSE_V.OPER.CHGATT THEN GOTO NOALT;
     1733     9345    3         IF NOT F$DCB.FFLG.REATTR THEN DO;
     1734     9346    3            B$JIT.ERR=FMO$E$REATTR;
     1735     9347    3            GOTO NOALT;
     1736     9348    3            END;
     1737     9349
     1738     9350    3         IF F$DCB.ORG=%INDEXED# THEN DO;
     1739     9351    3            I=(I-1)/4;
     1740     9352    3            IF I>80 THEN I=80;
     1741     9353
     1742     9354    3            IF VLP$ALTKEYS.SIZ#<=I THEN I=VLP$ALTKEYS.SIZ#;
     1743     9355    4            ELSE DO;
     1744     9356    4               B$JIT.ERR=FMO$E$BADVECT12;
     1745     9357    4               GOTO NOALT;
     1746     9358                    /*E*   ERROR:   FMO-E$BADVECT12-E
     1747     9359                           MESSAGE: Bad ALTKEY vector on close% of %UF%
     1748     9360                           MESSAGE1:The ALTKEY vector on close% of %UF%
     1749     9361                                    was bad because it was not large enough
     1750     9362                                    to hold all the keys specified or the
     1751     9363                                    specified keys extend beyond the minimum
     1752     9364                                    record size.
     1753     9365                    */
     1754     9366    4               END;
     1755     9367
     1756     9368    3            NEWSIZE=((I+1)*SIZEW(FITALTKEYS.K(0)))+1;
     1757     9369    3            CALL FSA$GSP(NEWSIZE, XT$) ALTRET(NOALT);
     1758     9370    3            P1$=T$;
     1759     9371
     1760     9372    3            J=NEWSIZE*4;
     1761     9373    3            P1$->ZAPJ='0'B;
     1762     9374    3            IF NEWSIZE > ALTKEY$->FITALTKEYS.NUMWRDS THEN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:56   
     1763     9375    3               J=ALTKEY$->FITALTKEYS.NUMWRDS*4;
     1764     9376    3            P1$->MOVEJ=ALTKEY$->MOVEJ;
     1765     9377    3            P1$->FITALTKEYS.NUMWRDS=NEWSIZE;
     1766     9378
     1767     9379    4            DO K=1 TO I;
     1768     9380    4               P1$->FITALTKEYS.K.KEYL(K)=VLP$ALTKEYS.K.KEYL#(K-1);
     1769     9381    4               P1$->FITALTKEYS.K.KEYX(K)=VLP$ALTKEYS.K.KEYX#(K-1);
     1770     9382    4               P1$->FITALTKEYS.K.UNIQUE(K)=VLP$ALTKEYS.K.UNIQUE#(K-1);
     1771     9383    4               IF VLP$ALTKEYS.K.KEYX#(K-1)+VLP$ALTKEYS.K.KEYL#(K-1) >
     1772     9384    4                 ALTKEY$->FITALTKEYS.MINWRSIZ THEN
     1773     9385    5               DO;
     1774     9386    5                  B$JIT.ERR=FMO$E$BADVECT12;
     1775     9387    5                  GOTO BADVECT12;
     1776     9388    5                  END;
     1777     9389    4               END;
     1778     9390    3            FM$CFU.ALTBLD='1'B;
     1779     9391    3            F$DCB.UNIQUEBLD='1'B;
     1780     9392    3            P1$->FITALTKEYS.ALTBLD='1'B;
     1781     9393    3            P1$->FITALTKEYS.UNIQUEBLD='1'B;
     1782     9394    3            P1$->FITALTKEYS.NUMENTS=I+1;
     1783     9395
     1784     9396    3            CODE=8;
     1785     9397    3            CALL FMO$FITSPACE(NEWSIZE) ALTRET(BADVECT12);
     1786     9398    3            J=NEWSIZE*4;
     1787     9399    3            LOC$->MOVEJ=P1$->MOVEJ;
     1788     9400    3            K=FITALTKEYS.NUMWRDS;
     1789     9401    3            CALL FSA$FSP(K, ALTKEY$);
     1790     9402    3            F$DCB.ALTKEYX=POFFW(P1$, B$ROSEG$);
     1791     9403    4            IF '0'B THEN DO;
     1792     9404    4   BADVECT12:  ;
     1793     9405    4               K=P1$->FITALTKEYS.NUMWRDS;
     1794     9406    4               T$=P1$;
     1795     9407    4               CALL FSA$FSP(K, XT$);
     1796     9408    4               END;
     1797     9409    3            END; /* If F$DCB.ORG=%INDEXED# */
     1798     9410    2   NOALT: ;
     1799     9411    2         J=0;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:57   
     1800     9412    2         LOCCODX=3;
     1801     9413    2         CALL LOCCODP ALTRET(DONE);
     1802     9414    2         END;  /* If F$DCB.ALTKEYX~=0 */
     1803     9415
     1804     9416                    /* */
     1805     9417    1      IF F$DCB.SPAN OR (FPT$CLOSE_V.OPER.RELG AND F$DCB.FFLG.DELF)
     1806     9418    1      THEN IF BUFNO=1 THEN CALL FMG$KEYSQZ(J); /* MAKE 1 GRAN FILE IF POSS */
     1807     9419    1      CODE03.UGRANS=FM$CFU.UGRANS;
     1808     9420    1      CODE03.LDA=FM$CFU.LDA;
     1809     9421    1      CODE03.NGAVAL=FM$CFU.NGAVAL;
     1810     9422    1      IF F$DCB.ORG=%RANDOM# OR F$DCB.ORG=%IDS#
     1811     9423    1      THEN CODE03.NRECS=FM$CFU.UGRANS;
     1812     9424    1      ELSE CODE03.NRECS=FM$CFU.NRECS;
     1813     9425    1      IF CODE03.RCSZ<FM$CFU.RCSZ
     1814     9426    1      THEN CODE03.RCSZ=FM$CFU.RCSZ;
     1815     9427    1      IF NOT FM$CFU.FMOD THEN F$DCB.DESC=CODE03.DESC;
     1816     9428    1      ELSE CODE03.DESC=F$DCB.DESC;
     1817     9429    1      F$DCB.BFR.BUFUP(BUFNO)='1'B;
     1818     9430    1      IF (FPT$CLOSE_V.OPER.RELG AND F$DCB.FUN~=%IN#
     1819     9431    1        OR J~=0)
     1820     9432    1        AND CODE03.NGAVAL~=0
     1821     9433    1      THEN IF NOT F$DCB.FFLG.DELF AND J=0 THEN B$JIT.ERR=FMO$E$CLSREL;
     1822     9434    1         ELSE CALL RELG;
     1823     9435                    /*
     1824     9436                       IMPORTANT CONSIDERATION !!..
     1825     9437                       The RELG routine will leave an extent in J and K to
     1826     9438                       be released at the label "DONE". J-K MUST NOT be
     1827     9439                       altered prior to that.
     1828     9440                    */
     1829     9441    1      ELSE J=0;
     1830     9442                    /**/
     1831     9443                    /*
     1832     9444                    *  NOW UPDATE KEYED FILE INFORMATION
     1833     9445                    */
     1834     9446    1      LOCCODX=2;
     1835     9447    1      CALL LOCCODP ALTRET(NXTCODE);
     1836     9448    1      CODE02.SLIDE=FM$CFU.SLIDE;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:58   
     1837     9449    1      CODE02.GDA=FM$CFU.GDA;
     1838     9450                    /*
     1839     9451                      If it's an alt key file, the TDA left in the DCB may be for a
     1840     9452                      secondary key, so stuff in the TDA for the primary key just
     1841     9453                      in case.
     1842     9454                    */
     1843     9455    2      IF F$DCB.ALTKEYX>0 THEN DO;
     1844     9456    2         ALTKEY$=PINCRW(B$ROSEG$, F$DCB.ALTKEYX);
     1845     9457    3         IF F$DCB.ORG=%INDEXED# THEN DO;
     1846     9458    3            F$DCB.TDA=ALTKEY$->FITALTKEYS.K.TDA(0);
     1847     9459    3            F$DCB.TDALVL=ALTKEY$->FITALTKEYS.K.TDALVL(0);
     1848     9460    3            END;
     1849     9461    3         ELSE DO;
     1850     9462    3            F$DCB.TDA=IRKEYS.K.TDA(0);
     1851     9463    3            F$DCB.TDALVL=IRKEYS.K.TDALVL(0);
     1852     9464    3            END;
     1853     9465    2         END;
     1854     9466    1      CODE02.TDALVL=F$DCB.TDALVL;
     1855     9467    1      CODE02.TDA=JDCB$->F$DCB.TDA;
     1856     9468                    /**/
     1857     9469                    /*
     1858     9470                    *  NOW UPDATE THE DATES RECORD
     1859     9471                    */
     1860     9472    1   NXTCODE:
     1861     9473    1      LOCCODX=16;
     1862     9474    1      CALL LOCCODP ALTRET(NXTCODE1);
     1863     9475                    /* NOW UPDATE THE UR INFO */
     1864     9476    1      F$DCB.FORM$->CODE16.IWL=F$DCB.IWL;
     1865     9477    1      CODE16=F$DCB.FORM$->CODE16;
     1866     9478    1   NXTCODE1:;
     1867     9479    1      LOCCODX=4;
     1868     9480    1      CALL LOCCODP ALTRET(DONE);
     1869     9481    1      IF CODE04.SVMODIFY
     1870     9482    1      THEN IF FM$CFU.SHARED AND NOT FM$CFU.FMOD
     1871     9483    1         THEN CODE04.MODIFY.TIME=CODE04.SVMODIFY.TIME;
     1872     9484    1         ELSE CALL SSS$SYSTIME(CODE04.MODIFY);
     1873     9485    1      CODE04.SVMODIFY.TIME=0;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:59   
     1874     9486        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:60   
     1875     9487    1   DONE:;
     1876     9488                    /* RELEASE THE NGAVAL EXTENT NOW, IF REQUIRED */
     1877     9489                    /* SAVE THE NEW FIT IF NEW UPPER LEVEL JUST BUILT */
     1878     9490    2      IF J~=0 OR FM$CFU.FUN>4 THEN DO;
     1879     9491    2         CALL FMD$WRTSV(BUFNO);
     1880     9492    2         IF J~=0 THEN CALL FAG$REXT(J);
     1881     9493    2         IF FM$CFU.FUN>4 THEN FM$CFU.FUN=FM$CFU.FUN-4;
     1882     9494    2         END;
     1883     9495    2      IF FPT$CLOSE_V.OPER.CHGATT AND F$DCB.FUN~=%IN# THEN DO;
     1884     9496    2         IF PN$.NAME_~=ADDR(NIL) THEN
     1885     9497    2            IF NOT F$DCB.FFLG.DELF THEN B$JIT.ERR=FMO$E$RENAME;
     1886     9498    2            ELSE IF F$DCB.ACS=%JRNL#
     1887     9499    2                 OR FM$CFU.SHARE=%NONE#
     1888     9500    2               THEN CALL FMP$RENAME(PN$.NAME_)ALTRET(FMOALTRET);
     1889     9501    2               ELSE B$JIT.ERR=FMO$E$RENAME;
     1890     9502    2         END;
     1891     9503        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:61   
     1892     9504    1   ALLDONE:;
     1893     9505    1      IF B$JIT.PRIV.ACTIVE.FMEFT
     1894     9506    2        AND FPT$CLOSE_V.EFTOPER THEN DO;
     1895     9507                    /* EFT WANTS TO MUCK WITH THE FILES STATE */
     1896     9508    2         IF FM$CFU.FITSDA=0 THEN GOTO MEBBEDELF; /* NOT MUCH POSSIBLE IF NO FIT */
     1897     9509    2         CALL FMN$GETFIT(BUF$,BUFNO)ALTRET(MEBBEDELF);
     1898     9510    2         CALL SSS$SYSTIME(I);
     1899     9511    2         FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));
     1900     9512    2         IF FPT$CLOSE_V.EFTOPER.UPDDESC AND NOT FPT$CLOSE_V.OPER.CHGATT
     1901     9513    2         THEN F$DCB.DESC=FPT$CLOSE_V.DESC;
     1902     9514    2         J=0;
     1903     9515    2         IF FPT$CLOSE_V.EFTOPER.ASTOW THEN J=6;
     1904     9516    2         IF FPT$CLOSE_V.EFTOPER.BACKUP THEN J=5;
     1905     9517    3         IF J~=0 THEN DO;
     1906     9518    3            IF J=5 THEN F$DCB.DESC.BUF='0'B;
     1907     9519    4            ELSE DO;
     1908     9520    4               F$DCB.DESC.QS='0'B;
     1909     9521    4               F$DCB.DESC.ARCHIVE='1'B;
     1910     9522    4               END;
     1911     9523    3            T$=FIT$;
     1912     9524    3            CALL FMO$LOCCODE(XT$,J)ALTRET(EFTDESC);
     1913     9525    3            LOC$=T$;
     1914     9526    3            FM$FIT.CODES.NDW(J)=3;
     1915     9527    3            CODE05.BACKUP.TIME=I;
     1916     9528    3            CODE05.BACKUP.REEL=VLP$SN.SN#(0);
     1917     9529    3            CODE05.BACKUP.EFT=BINBIT(FPT$CLOSE_V.EXPIRE,LENGTHB(CODE05.BACKUP.EFT));
     1918     9530    3            END;
     1919     9531    2   EFTDESC:;
     1920     9532    3         IF PN$.IFPARAM_~=ADDR(NIL) THEN DO CODE=4 TO 6;
     1921     9533    3            T$=PN$.IFPARAM_;
     1922     9534    3            CALL FMO$LOCCODP(XT$,CODE)ALTRET(NOEFTUP);
     1923     9535    3            P1$=T$;
     1924     9536    3            CALL FMO$BLDCODE;
     1925     9537    3   NOEFTUP: ;
     1926     9538    3            END;
     1927     9539    2         LOCCODX=3;
     1928     9540    2         CALL LOCCODP ALTRET(FMOE$BADFIT);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:62   
     1929     9541    2         CODE03.DESC=F$DCB.DESC;
     1930     9542    3         IF FM$CFU.SHARED AND F$DCB.DESC.BUPM AND FM$CFU.USECNT>1 THEN DO;
     1931     9543                    /* Keep the directory BUF descriptor on for the last closer */
     1932     9544    3            F$DCB.DESC.BUF='1'B;
     1933     9545    4            IF FM$CFU.FMOD THEN DO;
     1934     9546                    /* File is not modified anymore, sort of.  Fix previous mod date */
     1935     9547    4               FM$CFU.FMOD='0'B;
     1936     9548    4               LOCCODX=4;
     1937     9549    5               CALL LOCCODP WHENRETURN DO;
     1938     9550    5                  CALL SSS$SYSTIME(CODE04.SVMODIFY);
     1939     9551    5                  END;
     1940     9552    4               END;
     1941     9553    3            END;
     1942     9554    2         F$DCB.BFR.BUFUP(BUFNO)='1'B;
     1943     9555    2   MEBBEDELF:;
     1944     9556    2         CALL FMR$L8;
     1945     9557    2         IF (FPT$CLOSE_V.EFTOPER.DELFDE
     1946     9558    2           OR FPT$CLOSE_V.EFTOPER.ISTOW)
     1947     9559    2           AND FM$CFU.FUN<%CREATE#
     1948     9560    2           AND FM$CFU.NAMEX~=0
     1949     9561    2           AND FM$CFU.ACFU=0
     1950     9562    2           AND (FM$CFU.ACCTX~=FM_SYSACCTX
     1951     9563    2           OR F$DCB.FFLG.DELF OR FM$CFU.FITSDA=0
     1952     9564    3           OR SUBSTR(F$DCB.NAME.C,0,7)~=':SECLOG') THEN DO;
     1953     9565    3            FM$CFU.FUN=FM$CFU.FUN+4; /* MAKE IT STAY THAT WAY */
     1954     9566    3            CALL FMR$U8;
     1955     9567    3            F$DCB.BFR.BUFUP(BUFNO)='0'B;
     1956     9568    4            IF FPT$CLOSE_V.EFTOPER.ISTOW THEN DO;
     1957     9569    4               LOC$=FIT$;
     1958     9570    4               CALL FMO$LOCCODP(LOC$,6)ALTRET(FMOE$BADFIT);
     1959     9571    4               ADDR(I)->CODE06=CODE06;
     1960     9572    4               END;
     1961     9573    3            P1$=PINCRW(F$CFU$,FM$CFU.ACCTX);
     1962     9574    3            T$=P1$;
     1963     9575    3            CALL UQB$MENQX(XT$)ALTRET(FMOALTRET);
     1964     9576    3            CALL FMQ$SRCHFD(ADDR(F$DCB.NAME),CODE,CODE,XT$,ADDR(ANYFOPN))
     1965     9577    4            WHENALTRETURN DO;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:63   
     1966     9578    4   EFTFDERR:   ;
     1967     9579    4               I=1;
     1968     9580    4               GOTO EFTFDQ;
     1969     9581    4               END;
     1970     9582    4            IF FPT$CLOSE_V.EFTOPER.DELFDE THEN DO;
     1971     9583    4               CALL FMG$REMKEY;
     1972     9584    4               END;
     1973     9585    4            ELSE DO;
     1974     9586    4               CALL FMG$CURKEY(XT$,CODE) ALTRET(EFTFDERR);
     1975     9587    5               IF CODE<SIZEW(CODE06)+SIZEW(FM$FDSEG) THEN DO;
     1976     9588    5                  CALL FMG$ADDSEG(CODE,SIZEW(CODE06)) ALTRET(EFTFDERR);
     1977     9589    5                  CALL FMG$CURKEY(XT$,CODE,CODE) ALTRET(EFTFDERR);
     1978     9590    5                  END;
     1979     9591    4               FIT$=T$;
     1980     9592    4               F$DCB.BFR.BUFUP(1)='1'B;
     1981     9593    4               FM$FDSEG.DESC='0'B;
     1982     9594    4               FM$FDSEG.DESC.ARCHIVE='1'B;
     1983     9595    4               FM$FDSEG.DESC.DELF='1'B;
     1984     9596    4               FM$FDSEG.DESC.ODSTOW = F$DCB.DESC.ODSTOW;
     1985     9597    4               ADDR(FM$FDSTOW.CODE06)->CODE06=ADDR(I)->CODE06;
     1986     9598    4               END;
     1987     9599    3            I=0; /* Flag saying we did something - the file went away */
     1988     9600    3   EFTFDQ:  ;
     1989     9601    3            CALL FMD$FLSHBUF(1);
     1990     9602    3            T$=P1$;
     1991     9603    3            CALL UQB$MDEQ(XT$);
     1992     9604    3            IF I~=0 THEN RETURN;
     1993     9605    3            CALL FMR$L8;
     1994     9606    3            I=MOD(FM$CFU.UGRANS+FM$CFU.NGAVAL,%BITBIN('1000000000'O));
     1995     9607    4            IF I>0 THEN DO;
     1996     9608    4               FM$CFUA.GRANS=FM$CFUA.GRANS+I;
     1997     9609    4               FM$CFUA.GMOD=1;
     1998     9610    4               END;
     1999     9611    3            CALL FMR$FN(F$DCB.CFU$);
     2000     9612    3            CALL FMR$U8;
     2001     9613    3            RETURN;
     2002     9614    3            END;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:64   
     2003     9615    2         CALL FMR$U8;
     2004     9616    2         END;
     2005     9617        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:65   
     2006     9618    1      IF F$DCB.BFR.BUFUP(BUFNO) THEN CALL FMD$WRTSV(BUFNO);
     2007     9619    2      IF F$DCB.UPDCNT AND FM$CFU.FUN=%UPDATE# THEN DO;
     2008     9620                    /* This is shared-update. Let's see if it's not update anymore. */
     2009     9621    2         CALL FMR$L8;
     2010     9622    2         PINCRW(F$CFU$,FM$CFU.XTX)->FM$CFUEXT.UPDCNT=
     2011     9623    2           PINCRW(F$CFU$,FM$CFU.XTX)->FM$CFUEXT.UPDCNT-1;
     2012     9624    2         IF PINCRW(F$CFU$,FM$CFU.XTX)->FM$CFUEXT.UPDCNT=0 THEN FM$CFU.FUN=%IN#;
     2013     9625    2         FM$CFU.SHARE=%ALL#;
     2014     9626    2         CALL FMR$U8;
     2015     9627    2         END;
     2016     9628    1      RETURN;
     2017     9629                    /**/
     2018     9630    1   FMOE$BADFIT:
     2019     9631    1      B$JIT$->B$JIT.ERR=FMO$E$BADFIT; /* FIT HAS BEEN CLOBBERED */
     2020     9632    1      ALTRETURN;
     2021     9633        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:66   
     2022     9634    1   RELG: PROC;
     2023     9635                    /*I* NAME:         RELG
     2024     9636
     2025     9637                         PURPOSE:      RELG releases unused extents during a file
     2026     9638                                       close.
     2027     9639
     2028     9640                         CALL:         CALL RELG;
     2029     9641
     2030     9642                         DESCRIPTION:  RELG works backwards through the extent list
     2031     9643                                       in the CFU in order to release FM$CFU.NGAVAL
     2032     9644                                       extents. If an entire extent must be released
     2033     9645                                       and there's still more to give back after that,
     2034     9646                                       the extent is released by calling FAG$REXT.
     2035     9647                                       The CODE01 is kept current and the FIT written
     2036     9648                                       out as each extent is released.
     2037     9649
     2038     9650                                       IMPORTANT CONSIDERATION:  The very last extent
     2039     9651                                       or partial extent to be released is not released
     2040     9652                                       here. Instead, the extent is set up in the
     2041     9653                                       J and K variables to be released later
     2042     9654                                       (probably at the label DONE in FMO$MODFIT).
     2043     9655                                       Ergo, the values in J and K MUST NOT BE ALTERED
     2044     9656                                       prior to that time. This appears to be done in
     2045     9657                                       order to save a call to write out the FIT.
     2046     9658                    */
     2047     9659    2      K=CODE03.NGAVAL;
     2048     9660    2      CODE03.NGAVAL=0;
     2049     9661    3      IF F$DCB.STARF THEN DO;
     2050     9662    3         CALL FMR$UPDGAC(B$JIT.TMPGAC,B$JIT.CURTMPDP);
     2051     9663    3         B$JIT.CURTMPDP=B$JIT.CURTMPDP-K;
     2052     9664    3         END;
     2053     9665    3      ELSE DO;
     2054     9666    3         P1$=CFU$;
     2055     9667    3         CALL FMR$L8;
     2056     9668    3         IF FM$CFU.ACCTX=0 THEN P1$=PINCRW(F$CFU$,FM$CFU.NAMEX);
     2057     9669    3         P1$=PINCRW(F$CFU$,P1$->FM$CFU.ACCTX);
     2058     9670    3         IF F$DCB.WSR~=1 AND P1.WOFF~=FM_SYSACCTX
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:67   
     2059     9671    3         THEN B$JIT.PRDPRM=B$JIT.PRDPRM+K;
     2060     9672    3         FM$CFUA.GRANS=FM$CFUA.GRANS+K;
     2061     9673    3         FM$CFUA.GMOD=1;
     2062     9674    3         I=K+FM$CFU.UGRANS;
     2063     9675    3         CALL FMR$U8;
     2064     9676    3         CALL UPDGAC;
     2065     9677    3         END;
     2066     9678    3      DO WHILE(FM$CFU.NGAVAL~=0);
     2067     9679    3         FM$CFU.NGAVAL=0;
     2068     9680    3         P1$=PINCRW(F$CFU$,FM$CFU.XTX);
     2069     9681    4         DO WHILE (FM$CFUEXT.LINKX~=0);
     2070     9682    4            P1$=PINCRW(F$CFU$,FM$CFUEXT.LINKX);
     2071     9683    4            END;
     2072     9684    3         LOC$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(1)+FM$FIT.CODES.NDW(1)-1);
     2073     9685    3         I=FM$CFUEXT.NUM;
     2074     9686    4         IF LOC$->OS.SIZ=0 THEN DO;
     2075     9687    4            LOC$=PINCRW(LOC$,-1);
     2076     9688    4            J=LOC$->O.SIZ-K;
     2077     9689    4            LOC$->O.SIZ=J;
     2078     9690    4            I=I-1;
     2079     9691    4            PINCRW(P1$,I)->O.SIZ=J;
     2080     9692    4            END;
     2081     9693    4         ELSE DO;
     2082     9694    4            J=LOC$->OS.SIZ-K;
     2083     9695    4            LOC$->OS.SIZ=J;
     2084     9696    4            PINCRW(P1$,I)->OS.SIZ=J;
     2085     9697    4            END;
     2086     9698    4         IF JSBIN<=0 THEN DO;
     2087     9699    4            K=K+J;
     2088     9700    4            FM$CFU.NGAVAL=FM$CFU.NGAVAL-J;
     2089     9701    4            J=LOC$->OS.ADR;
     2090     9702    4            FM$CFUEXT.NUM=I-1;
     2091     9703    4            PINCRW(P1$,I)->O.ADR=1;/* WORD 3 MUST! BE NONZERO */
     2092     9704    4            IF I=2 THEN PINCRW(P1$,I)->O.SIZ=1;
     2093     9705    5            IF I=1 THEN DO;
     2094     9706    5               T$=P1$;
     2095     9707    5               CALL FMR$Z8(XT$);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:68   
     2096     9708    5               I=FM$CFU.XTX;
     2097     9709    6               DO WHILE(PINCRW(F$CFU$,I)->FM$CFUEXT.LINKX~=P1.WOFF);
     2098     9710    6                  I=PINCRW(F$CFU$,I)->FM$CFUEXT.LINKX;
     2099     9711    6                  END;
     2100     9712    5               PINCRW(F$CFU$,I)->FM$CFUEXT.LINKX=0;
     2101     9713    5               END;
     2102     9714    4            LOC$->O.ADR=0;
     2103     9715    4            P1$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(1));
     2104     9716    4            I=POFFW(LOC$,P1$);
     2105     9717    4            FM$FIT.CODES.NDW(1)=I;
     2106     9718    4            P1$->CODE01.NXTNTS=I-1;
     2107     9719    5            IF FM$CFU.NGAVAL~=0 THEN DO;
     2108     9720    6               IF BUFNO>1 THEN DO;
     2109     9721                    /* Get the FIT out of FAG$REXT's way. (It uses 4,3,and 2). */
     2110     9722
     2111     9723    6                  IBIT=F$DCB.BFR(0);
     2112     9724    6                  F$DCB.BFR(0)=F$DCB.BFR(BUFNO);
     2113     9725    6                  F$DCB.BFR(BUFNO)=IBIT;
     2114     9726    6                  IBIT=F$DCB.BFR1(0);
     2115     9727    6                  F$DCB.BFR1(0)=F$DCB.BFR1(BUFNO);
     2116     9728    6                  F$DCB.BFR1(BUFNO)=IBIT;
     2117     9729    6                  BUFNO=0;
     2118     9730    6                  END;
     2119     9731    5               CALL FMD$WRTSV(BUFNO);
     2120     9732    5               CALL FAG$REXT(J);
     2121     9733    5               K=FM$CFU.NGAVAL;
     2122     9734    5               END;
     2123     9735    4            END;
     2124     9736    3         ELSE J=J+LOC$->OS.ADR;
     2125     9737    3         END;
     2126     9738    2      RETURN;
     2127     9739    2   END RELG;
     2128     9740        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:69   
     2129     9741    1   FMO$RELG: ENTRY(DUMMY) ALTRET;
     2130     9742
     2131     9743                    /*F* NAME:         FMO$RELG
     2132     9744
     2133     9745                         PURPOSE:      FMO$RELG causes the unused extents of a file
     2134     9746                                       (FM$CFU.NGAVAL) to be released and updates the
     2135     9747                                       FIT, CFU, and granule accounting accordingly.
     2136     9748                    */
     2137     9749                    /*D* NAME:         FMO$RELG
     2138     9750
     2139     9751                         CALL:         CALL FMO$RELG(BUFNO) ALTRET(LBL);
     2140     9752
     2141     9753                         INPUT:        The buffer number of the pool buffer into which
     2142     9754                                       the FIT will be read.
     2143     9755
     2144     9756                         OUTPUT:       An updated FIT, CFU, etc. indicating that the
     2145     9757                                       NGAVAL granules have been released.
     2146     9758
     2147     9759                         DESCRIPTION:  FMO$RELG is called from the ALTKEY close routine
     2148     9760                                       in FMQ$RELSTARF. If ALTKEY was M$MLINKed to from
     2149     9761                                       M$CLOSE and it needed to allocate extents in order
     2150     9762                                       to build the alternate keys for an indexed or IREL
     2151     9763                                       file, there may be unused granules left when it's
     2152     9764                                       done. However, the user may have set RELG=YES in
     2153     9765                                       his close fpt and want these unused granules to
     2154     9766                                       go away. In a normal close, this is done in
     2155     9767                                       FMO$MODFIT. However, in our case, FMO$MODFIT was
     2156     9768                                       called before ALTKEY was invoked. So, we have to
     2157     9769                                       get rid of them again when ALTKEY is wrapping up.
     2158     9770                                       The checks to see whether this user asked to RELG,
     2159     9771                                       is allowed to RELG, or even has anything to RELG
     2160     9772                                       have already been done by M$RELSTARF. So, if
     2161     9773                                       FMO$RELG is called, we really do want to RELG.
     2162     9774
     2163     9775                                       First, set up our DCB and CFU pointers. If the
     2164     9776                                       file doesn't have any extents (unlikely), we're
     2165     9777                                       done. Ditto if there's no FIT disk address. Then
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:70   
     2166     9778                                       read the FIT into a buffer and update UGRANS and
     2167     9779                                       NGAVAL in the CODE03 from what's in the CFU.
     2168     9780                                       Call the RELG subroutine to release all but the
     2169     9781                                       last extent. RELG does most of the real work for
     2170     9782                                       this routine. However, although it sets up the
     2171     9783                                       final extent to be released, it doesn't actually
     2172     9784                                       release it. So, finally, we write out the FIT one
     2173     9785                                       more time and release the last extent.
     2174     9786
     2175     9787                                       This routine only altreturns if FMN$GETFIT found
     2176     9788                                       something wrong with the FIT.
     2177     9789                       */
     2178     9790           %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:71   
     2179     9791    1      JDCB$=B$JIT.DCB$;
     2180     9792    1      CFU$=JDCB$->F$DCB.CFU$;
     2181     9793    1      T$$=ADDR(T$);
     2182     9794    1      IF FM$CFU.XTX=0 THEN
     2183     9795    1         RETURN; /* No extents */
     2184     9796    1      CALL FMR$L8;
     2185     9797    1      CALL FMR$U8;
     2186     9798    1      IF FM$CFU.FITSDA=0 THEN
     2187     9799    1         RETURN;
     2188     9800    1      BUFNO=RELG_BUFNO;
     2189     9801    1      CALL FMN$GETFIT(BUF$,BUFNO) ALTRET(RELG_ALT);
     2190     9802    1      FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));
     2191     9803    1      LOCCODX=3;
     2192     9804    1      CALL LOCCODP;
     2193     9805    1      CODE03.UGRANS=FM$CFU.UGRANS;
     2194     9806    1      CODE03.NGAVAL=FM$CFU.NGAVAL;
     2195     9807    1      F$DCB.BFR.BUFUP(BUFNO)='1'B;
     2196     9808    1      CALL RELG;
     2197     9809    1      IF J~=0 OR F$DCB.BFR.BUFUP(BUFNO) THEN
     2198     9810    2      DO;
     2199     9811    2         CALL FMD$WRTSV(BUFNO);
     2200     9812    2         IF J~=0 THEN
     2201     9813    2            CALL FAG$REXT(J);
     2202     9814    2         END;
     2203     9815    1      RETURN;
     2204     9816    1   RELG_ALT:;
     2205     9817    1      ALTRETURN;
     2206     9818
     2207     9819        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:72   
     2208     9820                    /*F* NAME:FMO$XTNTOFIT
     2209     9821                    *
     2210     9822                  PURPOSE: This routine takes a raw extent allocated by FAG$GEXT and updates
     2211     9823                    the file's CFU and FIT to reflect the extension.
     2212     9824                    *
     2213     9825              DESCRIPTION: This routine takes a raw extent allocated by FAG$GEXT and updates
     2214     9826              the file's CFU and FIT to reflect the extension.  It ALTRETs if
     2215     9827              either the CFU area or FIT is too small to accommodate the new
     2216     9828              extent.  If an AFIT is required, an ALTRET may occur if one cannot
     2217     9829              be obtained.  Otherwise FIT and CFU extent list, UGRANS, and
     2218     9830              NGAVAL are updated.
     2219     9831              */
     2220     9832    1   FMO$XTNTOFIT: ENTRY(DUMMY) ALTRET;
     2221     9833    1      JDCB$=B$JIT$->B$JIT.DCB$;
     2222     9834    1      CFU$=JDCB$->F$DCB.CFU$;
     2223     9835    1      T$$=ADDR(T$);
     2224     9836    1      BUFNO=4;
     2225     9837    1      I=2;
     2226     9838    2      IF ADDR(PN$)->O.SIZ<512 THEN DO;
     2227     9839    2         ADDR(PN$)->OS.SIZ=ADDR(PN$)->O.SIZ;
     2228     9840    2         I=1;
     2229     9841    2         END;
     2230     9842                    /* FIND THE CFU SPOT FOR IT */
     2231     9843    1      P1$=PINCRW(F$CFU$,FM$CFU.XTX);
     2232     9844    2      DO WHILE (FM$CFUEXT.LINKX~=0);
     2233     9845    2         P1$=PINCRW(F$CFU$,FM$CFUEXT.LINKX);
     2234     9846    2         END;
     2235     9847    1      J=FM$CFUEXT.XTNT.XTNSIZE(FM$CFUEXT.NUM-1);
     2236     9848    1      IF I=1   /* MERGE TWO EXTENTS IF THEY ARE CONTIGUOUS */
     2237     9849    1        AND J~=0
     2238     9850    1        AND ADDR(PN$)->O.SIZ+J<512
     2239     9851    1        AND J+FM$CFUEXT.XTNT.XTNSDA(FM$CFUEXT.NUM-1)=ADDR(PN$)->OS.ADR
     2240     9852    2      THEN DO;
     2241     9853    2         I=0;
     2242     9854    2         FM$CFUEXT.XTNT.XTNSIZE(FM$CFUEXT.NUM-1)=J+ADDR(PN$)->O.SIZ;
     2243     9855    2         END;
     2244     9856    2      IF FM$CFUEXT.NUM+I>7 THEN DO; /* GET A BLOCK IF WE NEED ONE */
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:73   
     2245     9857    2         CALL FMR$G8(BUF$,J) ALTRET(FMOE$NOCFUS);
     2246     9858    2         FM$CFUEXT.LINKX=J;
     2247     9859    2         P1$=BUF$;
     2248     9860    2         END;
     2249     9861    1      CALL FMN$GETFIT(BUF$,BUFNO)ALTRET(FMOALTRET);
     2250     9862    1      CODE=1;
     2251     9863    1      FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));
     2252     9864    1      CALL FMO$FITSPACE(I+FM$FIT.CODES.NDW(1)) ALTRET(FMOALTRET);
     2253     9865    1      BUF$=PINCRW(LOC$,FM$FIT.CODES.NDW(1));
     2254     9866    2      IF I~=0 THEN DO;
     2255     9867    2         BUF$->O.ADR=ADDR(PN$)->O.ADR; /* MOVE IN THE EXTENT */
     2256     9868    2         IF I=2 THEN BUF$->O.SIZ=ADDR(PN$)->O.SIZ;
     2257     9869    2         BUF$=PINCRW(P1$,FM$CFUEXT.NUM+1);
     2258     9870    2         BUF$->O.ADR=ADDR(PN$)->O.ADR; /* MOVE IN THE EXTENT */
     2259     9871    2         IF I=2 THEN BUF$->O.SIZ=ADDR(PN$)->O.SIZ;
     2260     9872    2         CODE01.NXTNTS=CODE01.NXTNTS+I;
     2261     9873    2         FM$FIT.CODES.NDW(1)=FM$FIT.CODES.NDW(1)+I;
     2262     9874    2         FM$CFUEXT.NUM=FM$CFUEXT.NUM+I;
     2263     9875    2         END;
     2264     9876    2      ELSE DO;
     2265     9877    2         BUF$=PINCRW(BUF$,-1);
     2266     9878    2         BUF$->OS.SIZ=BUF$->OS.SIZ+ADDR(PN$)->O.SIZ;
     2267     9879    2         END;
     2268     9880    1      I=FM$CFU.UGRANS;
     2269     9881    1      CALL UPDGAC;
     2270     9882    1      LOCCODX=3;
     2271     9883    1      CALL LOCCODP ALTRET(FMOE$BADFIT);
     2272     9884    1      CODE03.UGRANS=CODE03.UGRANS+ADDR(PN$)->O.SIZ;
     2273     9885    2      IF F$DCB.IORG=%RANDOM# OR F$DCB.IORG=%RELATIVE# THEN DO;
     2274     9886    2         FM$CFU.UGRANS=CODE03.UGRANS;
     2275     9887    2         END;
     2276     9888    2      ELSE DO;
     2277     9889    2         FM$CFU.NGAVAL=ADDR(PN$)->O.SIZ;
     2278     9890    2         CODE03.NRECS=FM$CFU.NRECS;
     2279     9891    2         CODE03.LDA=FM$CFU.LDA;
     2280     9892    2         END;
     2281     9893    1      F$DCB.BFR.BUFUP(BUFNO)='1'B;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:74   
     2282     9894    1      RETURN;
     2283     9895        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:75   
     2284     9896    1   FMOE$NOCFUS: B$JIT$->B$JIT.ERR=FMO$E$NOCFUS;
     2285     9897    1   FMOALTRET: ALTRETURN;
     2286     9898    1   END FMO$BLDFIT;
     2287     9899        %EOD;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:76   
--  Include file information  --

   UD_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   KI$CP6V_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   B$P.:E05TOU  cannot be made into a system file and is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   FM_FIELD_C.:E05TOU  is referenced.
   F$CP6P_C.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
      No diagnostics issued in procedure FMO$BLDFIT.

   Procedure FMO$BLDFIT requires 5719 words for executable code.
   Procedure FMO$BLDFIT requires 50 words of local(AUTO) storage.

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:77   

 Object Unit name= FMO$BLDFIT                                 File name= FMO$OBSE.:E05TOU
 UTS= JUL 29 '97 16:55:10.24 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     39     47  FMO$BLDFIT
    1   Proc  even  none  5719  13127  FMO$BLDFIT
    2  RoData even  none    43     53  FMO$BLDFIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  FMO$BLDFIT
     1   4661          yes     yes      Std        1  FMO$FITSPDIR
     1   6207          yes     yes      Std        1  FMO$MODFIT
     1  12442          yes     yes      Std        1  FMO$RELG
     1  12560          yes     yes      Std        1  FMO$XTNTOFIT
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:78   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 FMD$FLSHBUF
         yes           Std       1 SSS$SYSTIME
 yes     yes           Std       2 FMG$ADDSEG
 yes     yes           Std       2 FMO$LOCCODX
         yes           Std       2 FMH$MAPJRNL
 yes     yes           Std       2 FMO$LOCCODP
         yes           Std       1 FMD$WRTSV
         yes           Std       3 FMD$GETBUF
         yes           Std       2 HFF$DSIZ
         yes           Std       1 FMR$FN
         yes           Std       1 FMM$NSTAMP
 yes     yes           Std       1 FMM$IFPARAM
 yes     yes           Std       2 FSA$GSP
 yes     yes           Std       2 FMR$G8
         yes           Std       0 FMR$L8
         yes           Std       0 FMU$BLD
 yes     yes           Std       2 FSA$FSP
 yes     yes           Std       1 FAG$REXT
 yes     yes           Std       1 UQB$MDEQ
 yes     yes           Std       5 FMQ$SRCHFD
 yes     yes           Std       1 FMG$KEYSQZ
 yes     yes           Std       1 FMP$RENAME
 yes     yes           Std       3 FMG$CURKEY
         yes           Std       0 FMR$U8
 yes     yes           Std       1 UQB$MENQX
 yes     yes           Std       2 FMN$GETFIT
 yes     yes           Std       0 FMO$FIELD_START_SETUP
 yes     yes           Std       2 FMO$LOCCODE
 yes     yes           Std       0 FMG$REMKEY
         yes           Std       1 FMM$SCRAMBLE
         yes           Std       2 FMR$UPDGAC
 yes     yes           Std       1 FMG$MOVKEYS
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:79   
         yes           Std       3 FMR$SLIDE
 yes     yes           Std       0 FMP$AFITCTG
         yes           Std       1 FMD$WRTBUF
 yes     yes           Std       1 FAG$GAFIT
 yes     yes           Std       6 FMD$REDBUFBC
         yes           Std       1 FMR$Z8
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$P$                                  S$CU$                            r    B$JIT$
r    B$ROSEG$                              B$PS1$                                B$PS2$
     B$PS12$                               F$CFU$                                FM_FRZERO
     FM_SYSACCTX                           FM$BUF$                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:80   


        1        1        /*M*      FMO$OBSE     OPEN/CLOSE SUBROUTINES               */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* NSO,MCL=0,MOC,MEC,CLM=12,EXM=12,CRT=6,DMR,PLM=3,IND=3,ENU=0,DCI=3,
        8        8        CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9                    /**/
       10       10                    /*F*  NAME:             FMO$BLDFIT
       11       11                    *     PURPOSE:          BUILD A FIT FROM THE OPEN FPT ITEMS.
       12       12                    *
       13       13                    */
       14       14                    /**/
       15       15                    /*D*  NAME:             FMO$BLDFIT
       16       16                    *     CALL:             CALL FMO$BLDFIT(PN$) ALTRET(ADDR);
       17       17                    *
       18       18                    *     INPUT:            PN$ IS THE ARRAY OF POINTERS CORRESPONDING
       19       19                    *                       TO THE OPEN VLP AREAS CONTAINING FIT
       20       20                    *                       PARAMETERS.
       21       21                    *
       22       22                    *
       23       23                    *                       B$JIT.DCB$ -> CURRENT DCB
       24       24                    *
       25       25                    *     OUTPUT:           A FIT RECORD WITH THE PROPER GRANULE
       26       26                    *                       HEADER INFORMATION IN WORDS 0-5 OF THE
       27       27                    *                       BUFFER WILL HAVE BEEN BUILT IN THE DCB
       28       28                    *                       BUFX(1) SLOT. CODE(1) IN THE DESCRIPTOR
       29       29                    *                       AREA POINTS TO AN EMPTY 16 WORD EXTENT
       30       30                    *                       LIST SPACE.
       31       31                    *
       32       32                    *     NOTE:             IF EFT AUTHORIZATION IS SPECIFIED, THEN
       33       33                    *                       FIT CODES 4, 5, AND 6 ARE LOCATED IN THE
       34       34                    *                       IFPARAM BUFFER AND MOVED INTACT TO THE
       35       35                    *                       NEW FIT. OTHERWISE (OR IF THE CODES ARE
       36       36                    *                       NOT LOCATED FOR EFT) THESE CODES ARE
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:81   
       37       37                    *                       INITIALIZED NORMALLY.
       38       38                    *
       39       39                    *     DESCRIPTION:      INFORMATION FROM THE DCB AND THE OPEN
       40       40                    *                       PARAMETERS ARE USED TO CONSTRUCT THE GRANULE
       41       41                    *                       HEADER AND THE FIT. NAVX AND AVAIL IN THE
       42       42                    *                       GRANULE HEADER ARE SET WITH THE CORRECT VALUES
       43       43                    *                       AFTER THE FIT IS CONSTRUCTED.  THE ZERO
       44       44                    *                       ENTRY OF FM$FIT.CODES CONTAINS THE NO. OF CODES
       45       45                    *                       DEFINED, THE NAW OF THE FIT, AND THE NDW OF
       46       46                    *                       THE FIT.
       47       47                    */
       48       48        FMO$BLDFIT: PROC(DUMMY) ALTRET;

     48  1 000000   000000 700200 xent  FMO$BLDFIT   TSX0  ! X66_AUTO_1
         1 000001   000062 000001                    ZERO    50,1

       49       49    1   DCL DUMMY CHAR(I);
       50       50                    /**/
       51       51                    /* PARAMETER DATA */
       52       52                    /**/
       53       53        %INCLUDE F_CP6;
       54     1078        %INCLUDE F$CP6P_C;
       55     1089        %INCLUDE FM_FIELD_C;
       56     1130        %INCLUDE B$OBJECT_C;
       57     4560        %VREBL_DATATYPES;
       58     4635        %FPT$OPEN_P(FPTN=PN$,PFMT=PTR,STCLASS="REDEF DUMMY");
       59     4641        %FPT$CLOSE_P(FPTN=CPN$,PFMT=PTR,STCLASS="REDEF DUMMY");
       60     4645    1   DCL RELG_BUFNO REDEF DUMMY UBIN; /* Used by FMO$RELG for ALTKEY */
       61     4646                    /* VLP$ALTKEYS, VLP$RECFIELD, and VLP$IRREC are only used on a
       62     4647                       close.                                                         */
       63     4648        %VLP_ALTKEYS(STCLASS="BASED(B$PS12$)", FPTN=VLP$ALTKEYS);
       64     4663        %VLP_RECFIELD(FPTN=VLP$RECFIELD,STCLASS="BASED(B$PS2$)");
       65     4707        %VLP_IRREC(FPTN=VLP$IRREC,STCLASS="BASED(B$PS1$)");
       66     4721        %VLP_SN(FPTN=VLP$SN,STCLASS="BASED(PN$.SN_)");
       67     4734        %INCLUDE F$CP6V_C;
       68     4960        %INCLUDE B$P;
       69     5044        %INCLUDE B$USER;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:82   
       70     5260        %B$USERREFS;
       71     5264        %FPT$CLOSE_V(BASED="BASED(PN$.V_)");
       72     5273    1   DCL 1 O BASED ALIGNED, /* PARAMETER FOR XTNTOFIT IS AN EXTENT */
       73     5274    1         2 ADR UBIN, /* IN THE TWO WORD FORM */
       74     5275    1         2 SIZ UBIN;
       75     5276    1   DCL 1 OS REDEF O,
       76     5277    1         2 SIZ UBIN BYTE UNAL,
       77     5278    1         2 ADR UBIN(27) UNAL,
       78     5279    1         2 * SBIN;
       79     5280                    /**/
       80     5281                    /* SYMREF DATA */
       81     5282                    /**/
       82     5283    1   DCL B$JIT$ PTR SYMREF READONLY;
       83     5284    1   DCL B$ROSEG$ PTR SYMREF READONLY;
       84     5285    1   DCL B$PS1$ PTR SYMREF;
       85     5286    1   DCL B$PS2$ PTR SYMREF;
       86     5287    1   DCL B$PS12$ PTR SYMREF;
       87     5288    1   DCL F$CFU$ PTR SYMREF;
       88     5289    1   DCL B_TICSDAY UBIN(36) SYMREF; /* TICS IN ONE DAY */
       89     5290    1   DCL FM_FRZERO UBIN SYMREF;
       90     5291    1   DCL FM_SRZERO UBIN SYMREF;
       91     5292    1   DCL FM_SYSACCTX UBIN SYMREF;
       92     5293    1   DCL FM$BUF$(0:0)PTR SYMREF;
       93     5294                    /**/
       94     5295                    /* EXTERNAL ROUTINES */
       95     5296                    /**/
       96     5297    1   DCL FAG$GAFIT ENTRY(1) ALTRET;
       97     5298    1   DCL FAG$REXT ENTRY(1) ALTRET; /* RELEASE EXTRA SPACE */
       98     5299    1   DCL FMB$LOGERR ENTRY(3); /* LOG BAD FIT ERRORS */
       99     5300    1   DCL FMD$FLSHBUF ENTRY(1); /* FLUSH BUFFER ROUTINE */
      100     5301    1   DCL FMD$GETBUF ENTRY(3); /* GET BUFFER ROUTINE */
      101     5302    1   DCL FMD$WRTBUF ENTRY(1); /* SHOVEL BUFFER */
      102     5303    1   DCL FMD$WRTSV ENTRY(1); /* UPDATE GRANULE */
      103     5304    1   DCL FMD$REDBUFBC ENTRY(6) ALTRET;
      104     5305    1   DCL FMG$ADDSEG ENTRY(2) ALTRET;
      105     5306    1   DCL FMG$CURKEY ENTRY(3) ALTRET;
      106     5307    1   DCL FMG$KEYSQZ ENTRY(1) ALTRET;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:83   
      107     5308    1   DCL FMG$MOVKEYS ENTRY(1)ALTRET;
      108     5309    1   DCL FMG$REMKEY ENTRY ALTRET;
      109     5310    1   DCL FMG$IRSETUP ENTRY(1) ALTRET;
      110     5311    1   DCL FMH$MAPJRNL ENTRY(2);
      111     5312    1   DCL FMM$IFPARAM ENTRY(1) ALTRET;
      112     5313    1   DCL FMM$NSTAMP ENTRY(1); /* NAME STAMP BUILDER */
      113     5314    1   DCL FMM$SCRAMBLE ENTRY(1); /* SCRAMBLE THE PASSWORD */
      114     5315    1   DCL FMN$GETFIT ENTRY(2)ALTRET;
      115     5316    1   DCL FMO$LOCCODE ENTRY(2) ALTRET; /* LOCATE FIT CODE */
      116     5317    1   DCL FMO$LOCCODP ENTRY(2) ALTRET; /* LOCATE FIT CODE */
      117     5318    1   DCL FMO$LOCCODX ENTRY(2) ALTRET;
      118     5319    1   DCL FMO$FIELD_START_SETUP ENTRY ALTRET; /* Init FM$FIELD_START */
      119     5320    1   DCL FMP$AFITCTG ENTRY ALTRET;
      120     5321    1   DCL FMP$RENAME ENTRY(1)ALTRET;
      121     5322    1   DCL FMQ$CTG ENTRY(2) ALTRET; /* UPDATE DIRECTORY TO POINT TO AFIT */
      122     5323    1   DCL FMQ$SRCHFD ENTRY(5) ALTRET; /* FIND ENTRY IN FD */
      123     5324    1   DCL FMR$FN ENTRY(1);
      124     5325    1   DCL FMR$SLIDE ENTRY(3); /* SHUFFLE THE FIT */
      125     5326    1   DCL FMR$G8 ENTRY(2) ALTRET; /* GET CFU SPACE FOR EXTENTS */
      126     5327    1   DCL FMR$L8 ENTRY;
      127     5328    1   DCL FMR$U8 ENTRY;
      128     5329    1   DCL FMR$Z8 ENTRY(1);
      129     5330    1   DCL FMU$BLD ENTRY;
      130     5331    1   DCL FSA$GSP ENTRY(2)ALTRET; /* GET SPACE FOR CODE16 */
      131     5332    1   DCL FSA$FSP ENTRY(2) ALTRET;
      132     5333    1   DCL FMR$UPDGAC ENTRY(2);
      133     5334    1   DCL HFF$DSIZ ENTRY(2); /* GET BYTE SIZE FROM DESCRIPTOR */
      134     5335    1   DCL SSS$SYSTIME ENTRY(1); /* GET CURRENT TIME */
      135     5336    1   DCL UQB$MENQX ENTRY(1)ALTRET;
      136     5337    1   DCL UQB$MDEQ ENTRY(1)ALTRET;
      137     5338                    /**/
      138     5339                    /* AUTOMATIC DATA */
      139     5340                    /**/
      140     5341    1   DCL JDCB$ PTR; /* CURRENT DCB POINTER */
      141     5342    1   DCL LOC$ PTR; /* CURRENT FIT ITEM POINTER */
      142     5343    1   DCL P1$ PTR; /* INTERNAL POINTER */
      143     5344    1   DCL 1 P1$PTR REDEF P1$,
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:84   
      144     5345    1         2 COFF UBIN(20)UNAL,
      145     5346    1         2 SEGID UBIN(16)UNAL;
      146     5347    1   DCL 1 P1 REDEF P1$,
      147     5348    1         2 WOFF UBIN HALF UNAL,
      148     5349    1         2 * BIT(18);
      149     5350    1   DCL FIT$ PTR; /* FIT POINTER */
      150     5351    1   DCL CFU$ PTR; /* POINTER TO THE CFU */
      151     5352    1   DCL BUF$ PTR; /* BUFFER POINTER */
      152     5353                    /* NOTE!!! I,J,AND K MUST BE TOGTHER AND IN ORDER FOR ISTOW */
      153     5354    1   DCL I UBIN;
      154     5355    1   DCL ICHAR REDEF I CHAR(4);
      155     5356    1   DCL IBIT REDEF I BIT(36);
      156     5357    1   DCL J UBIN;
      157     5358    1   DCL JCHAR REDEF J CHAR(4);
      158     5359    1   DCL JSBIN REDEF J SBIN;
      159     5360    1   DCL K UBIN; /* MUST FOLLOW J */
      160     5361    1   DCL BUFNO SBIN; /* BUFFER NUMBER OF FIT */
      161     5362    1   DCL T$ PTR; /* FOR USE IN CALLS */
      162     5363    1   DCL T$$ PTR; /* FOR USE IN USING T$ IN CALLS */
      163     5364    1   DCL XT$ PTR BASED(T$$); /* DITTO */
      164     5365    1   DCL LOCCODX SBIN; /* PARAMETER TO LOCCODP */
      165     5366    1   DCL FIELD$ PTR;
      166     5367    1   DCL START$ PTR;
      167     5368    1   DCL IRREC$ PTR;
      168     5369    1   DCL KFIELD$ PTR;
      169     5370    1   DCL ALTKEY$ PTR;
      170     5371    1   DCL CODE19$ PTR;
      171     5372    1   DCL TFLEN SBIN;
      172     5373    1   DCL SAVE_FIELDX UBIN;
      173     5374    1   DCL SAVE_STARTX UBIN;
      174     5375    1   DCL NEW_RECFIELD BIT(1) ALIGNED;
      175     5376    1   DCL NKEYS UBIN;
      176     5377    1   DCL NEWSIZE SBIN;
      177     5378    1   DCL CODE SBIN; /* CURRENT FIT CODE */
      178     5379    1   DCL REC CHAR(I) BASED; /* FORM TO MOVE FIT ITEMS */
      179     5380    1   DCL 1 ZAP_I BASED,
      180     5381    1         2 * CHAR(I) CALIGNED;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:85   
      181     5382    1   DCL MOVEJ CHAR(J) BASED;
      182     5383    1   DCL 1 ZAPJ BASED,
      183     5384    1         2 * CHAR(J) CALIGNED;
      184     5385    1   DCL REC4 CHAR(4) BASED; /* TO MOVE ONE WORD W/CHAR MOVE */
      185     5386    1   DCL GRAN CHAR(4096) BASED; /* TO MOVE A FULL PAGE */
      186     5387                    /**/
      187     5388        %INCLUDE F$JIT_C;
      188     5818        %INCLUDE FM$MACROS;
      189     6193        %INCLUDE KI$CP6V_C;
      190     6632        %FM$SET(BASED="BASED(F$CFU$)");
      191     6637        %FM$GRAN(BASED="BASED(BUF$)");
      192     6641        %FM$FDSEG(BASED="BASED(FIT$)");
      193     6645        %FM$FDSTOW(BASED="BASED(FIT$)");
      194     6648        %FM$FIT(BASED="BASED(FIT$)");
      195     6651        %CODE01(BASED="BASED(LOC$)");
      196     6655        %CODE02(BASED="BASED(LOC$)");
      197     6659        %CODE03(BASED="BASED(LOC$)");
      198     6666        %CODE04(BASED="BASED(LOC$)");
      199     6674        %CODE05(BASED="BASED(LOC$)");
      200     6677        %CODE06(BASED="BASED(LOC$)");
      201     6681        %CODE07(BASED="BASED(LOC$)");
      202     6684        %FITALTKEYS (BASED="BASED(LOC$)");
      203     6690        %CODE09(BASED="BASED(LOC$)");
      204     6694        %CODE15(BASED="BASED(LOC$)");
      205     6697        %CODE16(BASED="BASED(LOC$)");
      206     6705        %VLP$FPRG_V (FPTN=CODE17);
      207     6716        %CODE18(BASED="BASED(LOC$)");
      208     6720        %CODE19(BASED="BASED(CODE19$)");
      209     6723        %CODE20(BASED="BASED(LOC$)");
      210     6728        %CODE21(BASED="BASED(LOC$)");
      211     6731        %FMG$IRKEYS(FPTN=IRKEYS, STCLASS="BASED(ALTKEY$)");
      212     6738        %FMG$KFIELD(FPTN=KFIELD, STCLASS="BASED(KFIELD$)");
      213     6741        %FM$FIELD_START(FPTN=FIELD_START,STCLASS="BASED(START$)");
      214     6763        %VLP$RECFIELD_V(FPTN=RECFIELD, BASED="BASED(FIELD$)");
      215     6800        %VLP$IRREC_V(FPTN=IRREC,BASED="BASED(IRREC$)");
      216     6803        %FM$CFU(BASED="BASED(CFU$)");
      217     6809        %FM$CFUF(BASED="BASED(CFU$)");
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:86   
      218     6812        %FM$CFUJ(BASED="BASED(CFU$)");
      219     6817        %FM$CFUEXT(BASED="BASED(P1$)");
      220     6821        %FM$CFUA(BASED="BASED(P1$)");
      221     6827        %MACRO F$DCB#(BASED=BASED);
      222     6828        %INCLUDE F$DCB;
      223     6877        %MEND;
      224     6878        %F$DCB#(BASED="BASED(JDCB$)");
      225     6928        %FM_GRAN (NAVX=13,FCEX=13,HDR=1,AVAIL=1011,NAME=FITHDR);
      226     6932        %FM$KEYTBL;
      227     6935    1   DCL 1 INITKEYTBL CONSTANT,
      228     6936    1         2 * UBIN(9) UNAL INIT(280);
      229     6937        %FM_FITCODE(NAME=FCODE0,CODE=1,NAW=8,NDW=8);
      230     6940        %FM_FITCODE(NAME=FCODE1,CODE=1,NDW=1,ITEMX=8);
      231     6943    1   DCL ANYFOPN BIT(72) CONSTANT INIT('0000000060000004'O);
      232     6944        %INCLUDE CP_6_SUBS;
      233     7484        %INCLUDE F_ERRORS_C;
      234     7724        %INCLUDE UD_ERRORS_C;
      235     7766        %SUB FCG#='0615'O;
      236     7767        %SUB MID#='17'O;
      237     7768        %ERRCODE(NAME=FMO$E$RENAME,COD#=%E$RENAME);
      238     7772        %ERRCODE(NAME=FMO$E$VLPERR,COD#=%E$VLPERR);
      239     7776        %ERRCODE(NAME=FMO$E$REATTR,COD#=%E$REATTR);
      240     7780        %ERRCODE(NAME=FMO$E$BADFIT,COD#=%E$BADFIT);
      241     7784        %ERRCODE(NAME=FMO$E$NOCFUS,COD#=%E$NOCFUS);
      242     7788        %ERRCODE(NAME=FMO$E$CLSREL,COD#=%E$CLSREL);
      243     7792        %ERRCODE(NAME=FMO$E$BADVECT0,COD#=%E$BADVECT0);
      244     7796        %ERRCODE(NAME=FMO$E$BADALT,COD#=%E$BADALT);
      245     7800        %ERRCODE(NAME=FMO$E$BADLEN,COD#=%E$BADLEN);
      246     7804        %ERRCODE(NAME=FMO$E$BADFTYPE,COD#=%E$BADFTYPE);
      247     7808        %ERRCODE(NAME=FMO$E$BADIKEY,COD#=%E$BADIKEY);
      248     7812        %ERRCODE(NAME=FMO$E$BADKEYLEN,COD#=%E$BADKEYLEN);
      249     7816        %ERRCODE(NAME=FMO$E$NOFLD,COD#=%E$NOFLD);
      250     7820        %ERRCODE(NAME=FMO$E$BIGKEY,COD#=%E$BIGKEY);
      251     7824        %ERRCODE(NAME=FMO$E$TOOMANYF,COD#=%E$TOOMANYF);
      252     7828        %ERRCODE(NAME=FMO$E$BADVECT12,COD#=%E$BADVECT12);
      253     7832        %ERRCODE(NAME=FMO$E$BADSTART,COD#=%E$BADSTART);
      254     7836        %ERRCODE(NAME=FMO$E$NOIREL,COD#=%E$NOIREL);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:87   
      255     7840        %ERRCODE(NAME=FMO$E$TOOMANYL,COD#=%E$TOOMANYL);
      256     7844        %ERRCODE(NAME=FMO$E$BADSCALE,COD#=%E$BADSCALE);
      257     7848        %ERRCODE(NAME=FMO$E$BADFLDTYPE,COD#=%E$BADFLDTYPE);
      258     7852        %ERRCODE(NAME=FMO$E$BADARRAY,COD#=%E$BADARRAY);
      259     7856        %ERRCODE(NAME=FMO$E$BADALIGN,COD#=%E$BADALIGN);
      260     7860        %ERRCODE(NAME=FMO$E$BADVECT1,COD#=%E$BADVECT1);
      261     7864        %ERRCODE(NAME=FMO$E$BADVECT2,COD#=%E$BADVECT2);
      262     7868        %ERRCODE(NAME=FMO$E$BADCNTFLD,COD#=%E$BADCNTFLD);
      263     7872        %ERRCODE(NAME=FMO$E$BADIFLD,COD#=%E$BADIFLD);
      264     7876        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:88   
      265     7877                    /*
      266     7878                    *  INITIALIZE AND GET A BUFFER FOR THE FIT
      267     7879                    */
      268     7880    1      JDCB$=B$JIT$->B$JIT.DCB$;

   7880  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   000232 236100                    LDQ     154,,PR0
         1 000004   200004 756100                    STQ     JDCB$,,AUTO

      269     7881    1      CFU$=F$DCB.CFU$;

   7881  1 000005   200004 471500                    LDP1    JDCB$,,AUTO
         1 000006   100066 236100                    LDQ     54,,PR1
         1 000007   200010 756100                    STQ     CFU$,,AUTO

      270     7882    1      T$$=ADDR(T$);

   7882  1 000010   200016 633500                    EPPR3   T$,,AUTO
         1 000011   200017 453500                    STP3    T$$,,AUTO

      271     7883    1      CALL FMD$FLSHBUF(1);

   7883  1 000012   000000 630400 2                  EPPR0   0
         1 000013   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000014   000000 701000 xent               TSX1    FMD$FLSHBUF
         1 000015   000000 011000                    NOP     0

      272     7884    1      CALL FMD$GETBUF(1,1,BUF$);

   7884  1 000016   200011 630500                    EPPR0   BUF$,,AUTO
         1 000017   200054 450500                    STP0    INDX+3,,AUTO
         1 000020   000002 237000 2                  LDAQ    2
         1 000021   200052 757100                    STAQ    INDX+1,,AUTO
         1 000022   200052 630500                    EPPR0   INDX+1,,AUTO
         1 000023   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000024   000000 701000 xent               TSX1    FMD$GETBUF
         1 000025   000000 011000                    NOP     0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:89   

      273     7885    1      BUFNO=1;

   7885  1 000026   000001 235007                    LDA     1,DL
         1 000027   200015 755100                    STA     BUFNO,,AUTO

      274     7886    1      CALL SSS$SYSTIME(I); /* COMPUTE FILE NAME.ACCT HASH */

   7886  1 000030   200012 630500                    EPPR0   I,,AUTO
         1 000031   200052 450500                    STP0    INDX+1,,AUTO
         1 000032   200052 630500                    EPPR0   INDX+1,,AUTO
         1 000033   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000034   000000 701000 xent               TSX1    SSS$SYSTIME
         1 000035   000000 011000                    NOP     0

      275     7887    1      JDCB$->F$DCB.HASH=I;

   7887  1 000036   200004 470500                    LDP0    JDCB$,,AUTO
         1 000037   200012 236100                    LDQ     I,,AUTO
         1 000040   000011 736000                    QLS     9
         1 000041   000073 552170                    STBQ    59,'70'O,PR0

      276     7888    1      F$DCB.FFLG=%FFLG_OWNER#;

   7888  1 000042   765700 220003                    LDX0    -5184,DU
         1 000043   000004 740100                    STX0    4,,PR0

      277     7889    2      IF F$DCB.STARX>2 THEN DO;

   7889  1 000044   000064 236100                    LDQ     52,,PR0
         1 000045   007000 376007                    ANQ     3584,DL
         1 000046   003000 116007                    CMPQ    1536,DL
         1 000047   000060 602000 1                  TNC     s:7897

      278     7890    2         F$DCB.FFLG.EXEC='1'B;

   7890  1 000050   002000 236003                    LDQ     1024,DU
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:90   
         1 000051   000004 256100                    ORSQ    4,,PR0

      279     7891    2         IF F$DCB.WSR=1 THEN F$DCB.WSR=0;

   7891  1 000052   000040 236100                    LDQ     32,,PR0
         1 000053   000777 376003                    ANQ     511,DU
         1 000054   000001 116003                    CMPQ    1,DU
         1 000055   000060 601000 1                  TNZ     s:7897

   7891  1 000056   000000 236003                    LDQ     0,DU
         1 000057   000040 552120                    STBQ    32,'20'O,PR0

      280     7892    2         END;

      281     7893                    /*
      282     7894                    *  FOR BLOCK ACCESS, THE FIT GRANULE ITSELF IS CONTAINED
      283     7895                    *  IN THE IFPARAM BUFFER.
      284     7896                    */
      285     7897    2      IF F$DCB.ACS=%BLOCK# THEN DO;

   7897  1 000060   000036 236100                    LDQ     30,,PR0
         1 000061   000777 376007                    ANQ     511,DL
         1 000062   000003 116007                    CMPQ    3,DL
         1 000063   000270 601000 1                  TNZ     s:7932

      286     7898    2         CALL HFF$DSIZ(POFFW(ADDR(PN$.IFPARAM_),ADDR(PN$.V_)),K);

   7898  1 000064   200003 236100                    LDQ     @DUMMY,,AUTO
         1 000065   000022 772000                    QRL     18
         1 000066   200052 756100                    STQ     INDX+1,,AUTO
         1 000067   200003 236100                    LDQ     @DUMMY,,AUTO
         1 000070   000013 036003                    ADLQ    11,DU
         1 000071   000022 772000                    QRL     18
         1 000072   200052 136100                    SBLQ    INDX+1,,AUTO
         1 000073   200053 756100                    STQ     INDX+2,,AUTO
         1 000074   200014 631500                    EPPR1   K,,AUTO
         1 000075   200055 451500                    STP1    INDX+4,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:91   
         1 000076   200053 633500                    EPPR3   INDX+2,,AUTO
         1 000077   200054 453500                    STP3    INDX+3,,AUTO
         1 000100   200054 630500                    EPPR0   INDX+3,,AUTO
         1 000101   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000102   000000 701000 xent               TSX1    HFF$DSIZ
         1 000103   000000 011000                    NOP     0

      287     7899    2         IF K~=4096 THEN GOTO FMOE$VLPERR;

   7899  1 000104   200014 235100                    LDA     K,,AUTO
         1 000105   010000 115007                    CMPA    4096,DL
         1 000106   000562 601000 1                  TNZ     FMOE$VLPERR

      288     7900    2         BUF$->GRAN=PN$.IFPARAM_->GRAN;

   7900  1 000107   200003 470500                    LDP0    @DUMMY,,AUTO
         1 000110   000013 471500                    LDP1    11,,PR0
         1 000111   010000 220003                    LDX0    4096,DU
         1 000112   200011 473500                    LDP3    BUF$,,AUTO
         1 000113   040140 100540                    MLR     fill='040'O
         1 000114   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         1 000115   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0

      289     7901    2         IF F$DCB.IASN=%FILE# THEN

   7901  1 000116   200004 471500                    LDP1    JDCB$,,AUTO
         1 000117   100103 236100                    LDQ     67,,PR1
         1 000120   000777 376007                    ANQ     511,DL
         1 000121   000001 116007                    CMPQ    1,DL
         1 000122   000134 601000 1                  TNZ     s:7908

      290     7902    2            IF FM$GRAN.LVL=6 /* AFIT */ THEN

   7902  1 000123   200011 473500                    LDP3    BUF$,,AUTO
         1 000124   300001 236100                    LDQ     1,,PR3
         1 000125   340000 376007                    ANQ     114688,DL
         1 000126   300000 116007                    CMPQ    98304,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:92   
         1 000127   000132 601000 1                  TNZ     s:7904

      291     7903    2               F$DCB.CRECNO=0;

   7903  1 000130   100071 450100                    STZ     57,,PR1
         1 000131   000134 710000 1                  TRA     s:7908

      292     7904    2            ELSE F$DCB.CRECNO=1;

   7904  1 000132   000001 235007                    LDA     1,DL
         1 000133   100071 755100                    STA     57,,PR1

      293     7905                    /*
      294     7906                    *  NOW CLEAR OUT THE EXTENT LIST
      295     7907                    */
      296     7908    2         FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));

   7908  1 000134   200011 236100                    LDQ     BUF$,,AUTO
         1 000135   000005 036003                    ADLQ    5,DU
         1 000136   200007 756100                    STQ     FIT$,,AUTO

      297     7909    2         IF FM$FIT.CODES.CODE(1) ~= 1 THEN GOTO FMOE$VLPERR;

   7909  1 000137   200007 473500                    LDP3    FIT$,,AUTO
         1 000140   300001 236100                    LDQ     1,,PR3
         1 000141   760000 376003                    ANQ     -8192,DU
         1 000142   020000 116003                    CMPQ    8192,DU
         1 000143   000562 601000 1                  TNZ     FMOE$VLPERR

      298     7910    2         FM$FIT.CODES.NDW(1)=1;

   7910  1 000144   300001 236100                    LDQ     1,,PR3
         1 000145   000004 376000 2                  ANQ     4
         1 000146   002000 276007                    ORQ     1024,DL
         1 000147   300001 756100                    STQ     1,,PR3

      299     7911    2         LOCCODX=3;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:93   

   7911  1 000150   000003 235007                    LDA     3,DL
         1 000151   200020 755100                    STA     LOCCODX,,AUTO

      300     7912    2         CALL LOCCODP ALTRET(FMOE$VLPERR);

   7912  1 000152   002543 701000 1                  TSX1    LOCCODP
         1 000153   000562 702000 1                  TSX2    FMOE$VLPERR

      301     7913    2         JDCB$->F$DCB.IXTNSIZE=CODE03.UGRANS+CODE03.NGAVAL;

   7913  1 000154   200005 470500                    LDP0    LOC$,,AUTO
         1 000155   000003 236100                    LDQ     3,,PR0
         1 000156   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 000157   200052 756100                    STQ     INDX+1,,AUTO
         1 000160   000000 236100                    LDQ     0,,PR0
         1 000161   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 000162   200052 036100                    ADLQ    INDX+1,,AUTO
         1 000163   200004 471500                    LDP1    JDCB$,,AUTO
         1 000164   100041 756100                    STQ     33,,PR1

      302     7914    2         IF F$DCB.ASN~=%TAPE# THEN CODE03.UGRANS=-CODE03.NGAVAL;

   7914  1 000165   100032 236100                    LDQ     26,,PR1
         1 000166   777000 376007                    ANQ     -512,DL
         1 000167   002000 116007                    CMPQ    1024,DL
         1 000170   000176 600000 1                  TZE     s:7915

   7914  1 000171   000003 236100                    LDQ     3,,PR0
         1 000172   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 000173   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000174   000001 036007                    ADLQ    1,DL
         1 000175   000000 552134                    STBQ    0,'34'O,PR0

      303     7915    2         F$DCB.DESC=CODE03.DESC;

   7915  1 000176   200005 470500                    LDP0    LOC$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:94   
         1 000177   000001 220100                    LDX0    1,,PR0
         1 000200   100005 440100                    SXL0    5,,PR1

      304     7916    2         CALL FMM$NSTAMP(CODE03.NSTAMP);

   7916  1 000201   200005 236100                    LDQ     LOC$,,AUTO
         1 000202   000006 036003                    ADLQ    6,DU
         1 000203   200052 756100                    STQ     INDX+1,,AUTO
         1 000204   200052 630500                    EPPR0   INDX+1,,AUTO
         1 000205   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000206   000000 701000 xent               TSX1    FMM$NSTAMP
         1 000207   000000 011000                    NOP     0

      305     7917    3         IF F$DCB.STARF OR F$DCB.DISP=%SCRATCH# THEN DO CODE=4 TO 6;

   7917  1 000210   200004 470500                    LDP0    JDCB$,,AUTO
         1 000211   000064 236100                    LDQ     52,,PR0
         1 000212   200000 316003                    CANQ    65536,DU
         1 000213   000220 601000 1                  TNZ     s:7917+8
         1 000214   000032 236100                    LDQ     26,,PR0
         1 000215   000777 376007                    ANQ     511,DL
         1 000216   000001 116007                    CMPQ    1,DL
         1 000217   000246 601000 1                  TNZ     s:7923

   7917  1 000220   000004 235007                    LDA     4,DL
         1 000221   200035 755100                    STA     CODE,,AUTO

      306     7918    3            K=CODE;

   7918  1 000222   200035 235100                    LDA     CODE,,AUTO
         1 000223   200014 755100                    STA     K,,AUTO

      307     7919    3            T$=FIT$;

   7919  1 000224   200007 236100                    LDQ     FIT$,,AUTO
         1 000225   200016 756100                    STQ     T$,,AUTO

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:95   
      308     7920    3            CALL FMO$LOCCODX(XT$,K) ALTRET(NOFIX);

   7920  1 000226   200014 630500                    EPPR0   K,,AUTO
         1 000227   200053 450500                    STP0    INDX+2,,AUTO
         1 000230   200017 236100                    LDQ     T$$,,AUTO
         1 000231   200052 756100                    STQ     INDX+1,,AUTO
         1 000232   200052 630500                    EPPR0   INDX+1,,AUTO
         1 000233   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000234   000000 701000 xent               TSX1    FMO$LOCCODX
         1 000235   000241 702000 1                  TSX2    NOFIX

      309     7921    3            FM$FIT.CODES(K)='0'B;

   7921  1 000236   200007 470500                    LDP0    FIT$,,AUTO
         1 000237   200014 720100                    LXL0    K,,AUTO
         1 000240   000000 450110                    STZ     0,X0,PR0

      310     7922    3   NOFIX:   END;

   7922  1 000241   200035 054100       NOFIX        AOS     CODE,,AUTO
         1 000242   200035 235100                    LDA     CODE,,AUTO
         1 000243   000006 115007                    CMPA    6,DL
         1 000244   000222 604400 1                  TMOZ    s:7918
         1 000245   000261 710000 1                  TRA     s:7926

      311     7923    3         ELSE IF NOT B$JIT.PRIV.ACTIVE.FMEFT THEN DO CODE=4 TO 6;

   7923  1 000246   000000 471400 xsym               LDP1    B$JIT$
         1 000247   100013 234100                    SZN     11,,PR1
         1 000250   000261 604000 1                  TMI     s:7926

   7923  1 000251   000004 235007                    LDA     4,DL
         1 000252   200035 755100                    STA     CODE,,AUTO

      312     7924    3               CALL FMO$BLDCODE ALTRET(FMOE$VLPERR);

   7924  1 000253   000566 701000 1                  TSX1    FMO$BLDCODE
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:96   
         1 000254   000562 702000 1                  TSX2    FMOE$VLPERR

      313     7925    3               END;

   7925  1 000255   200035 054100                    AOS     CODE,,AUTO
         1 000256   200035 235100                    LDA     CODE,,AUTO
         1 000257   000006 115007                    CMPA    6,DL
         1 000260   000253 604400 1                  TMOZ    s:7924

      314     7926    2         LOC$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(1));

   7926  1 000261   200007 470500                    LDP0    FIT$,,AUTO
         1 000262   000001 720100                    LXL0    1,,PR0
         1 000263   001777 360003                    ANX0    1023,DU
         1 000264   000000 636010                    EAQ     0,X0
         1 000265   200007 036100                    ADLQ    FIT$,,AUTO
         1 000266   200005 756100                    STQ     LOC$,,AUTO

      315     7927    2         GOTO BLDFITX;

   7927  1 000267   000542 710000 1                  TRA     BLDFITX

      316     7928    2         END;
      317     7929                    /*
      318     7930                    *  SET UP THE FIT GRANULE HEADER
      319     7931                    */
      320     7932    1      FM$GRAN=FITHDR;

   7932  1 000270   200011 471500                    LDP1    BUF$,,AUTO
         1 000271   000100 100400                    MLR     fill='000'O
         1 000272   000000 000024 0                  ADSC9   FITHDR                   cn=0,n=20
         1 000273   100000 000024                    ADSC9   0,,PR1                   cn=0,n=20

      321     7933    1      FM$GRAN.ORG=JDCB$->F$DCB.ORG;

   7933  1 000274   200011 471500                    LDP1    BUF$,,AUTO
         1 000275   000032 236100                    LDQ     26,,PR0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:97   
         1 000276   000021 772000                    QRL     17
         1 000277   100001 676100                    ERQ     1,,PR1
         1 000300   036000 376007                    ANQ     15360,DL
         1 000301   100001 656100                    ERSQ    1,,PR1

      322     7934    1      IF F$DCB.IORG=%RANDOM# OR F$DCB.IORG=%RELATIVE# OR F$DCB.ASN=%TAPE#

   7934  1 000302   000070 236100                    LDQ     56,,PR0
         1 000303   077000 376003                    ANQ     32256,DU
         1 000304   003000 116003                    CMPQ    1536,DU
         1 000305   000327 600000 1                  TZE     s:7936
         1 000306   005000 116003                    CMPQ    2560,DU
         1 000307   000327 600000 1                  TZE     s:7936
         1 000310   000032 236100                    LDQ     26,,PR0
         1 000311   777000 376007                    ANQ     -512,DL
         1 000312   002000 116007                    CMPQ    1024,DL
         1 000313   000327 600000 1                  TZE     s:7936
         1 000314   000036 236100                    LDQ     30,,PR0
         1 000315   000777 376007                    ANQ     511,DL
         1 000316   000014 116007                    CMPQ    12,DL
         1 000317   000334 601000 1                  TNZ     s:7940
         1 000320   000032 236100                    LDQ     26,,PR0
         1 000321   777000 376003                    ANQ     -512,DU
         1 000322   001000 116003                    CMPQ    512,DU
         1 000323   000334 601000 1                  TNZ     s:7940
         1 000324   000031 236100                    LDQ     25,,PR0
         1 000325   004000 316007                    CANQ    2048,DL
         1 000326   000334 601000 1                  TNZ     s:7940

      323     7935    1        OR F$DCB.ACS=%UBLOCK# AND F$DCB.ORG=%CONSEC# AND NOT F$DCB.CTG
      324     7936    1      THEN FM$GRAN.LVL=6; /* THIS IS AN AFIT */

   7936  1 000327   200011 471500                    LDP1    BUF$,,AUTO
         1 000330   100001 236100                    LDQ     1,,PR1
         1 000331   000005 376000 2                  ANQ     5
         1 000332   300000 276007                    ORQ     98304,DL
         1 000333   100001 756100                    STQ     1,,PR1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:98   

      325     7937                    /*
      326     7938                    *  INITIALIZE THE FIT CONTROL WORDS
      327     7939                    */
      328     7940    1      FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));

   7940  1 000334   200011 236100                    LDQ     BUF$,,AUTO
         1 000335   000005 036003                    ADLQ    5,DU
         1 000336   200007 756100                    STQ     FIT$,,AUTO

      329     7941    1      FM$FIT='0'B;

   7941  1 000337   200007 471500                    LDP1    FIT$,,AUTO
         1 000340   000100 100400                    MLR     fill='000'O
         1 000341   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000342   100000 000174                    ADSC9   0,,PR1                   cn=0,n=124

      330     7942    1      FM$FIT.CODES(1)=FCODE1; /* KEEP EXTENTS AT INDEX ONE */

   7942  1 000343   000007 236000 0                  LDQ     FCODE1
         1 000344   100001 756100                    STQ     1,,PR1

      331     7943    1      FM$FIT.CODES(0)=FCODE0; /* NO. CODES */

   7943  1 000345   000006 236000 0                  LDQ     FCODE0
         1 000346   100000 756100                    STQ     0,,PR1

      332     7944    2      IF F$DCB.IORG=%KEYED# THEN DO;

   7944  1 000347   000070 236100                    LDQ     56,,PR0
         1 000350   077000 376003                    ANQ     32256,DU
         1 000351   002000 116003                    CMPQ    1024,DU
         1 000352   000375 601000 1                  TNZ     s:7953

      333     7945    2         FM$GRAN.NAVX=FM$GRAN.NAVX+SIZEW(FM$KEYTBL);

   7945  1 000353   200011 473500                    LDP3    BUF$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:99   
         1 000354   300001 221100                    LDX1    1,,PR3
         1 000355   000106 622011                    EAX2    70,X1
         1 000356   300001 742100                    STX2    1,,PR3

      334     7946    2         FM$GRAN.AVAIL=FM$GRAN.AVAIL-SIZEW(FM$KEYTBL);

   7946  1 000357   200011 473500                    LDP3    BUF$,,AUTO
         1 000360   300001 236100                    LDQ     1,,PR3
         1 000361   001777 376007                    ANQ     1023,DL
         1 000362   000106 136007                    SBLQ    70,DL
         1 000363   300001 676100                    ERQ     1,,PR3
         1 000364   001777 376007                    ANQ     1023,DL
         1 000365   300001 656100                    ERSQ    1,,PR3

      335     7947    2         PINCRW(BUF$,FM$GRAN.FCEX)->FM$KEYTBL=INITKEYTBL;

   7947  1 000366   200011 473500                    LDP3    BUF$,,AUTO
         1 000367   300002 221100                    LDX1    2,,PR3
         1 000370   000000 635011                    EAA     0,X1
         1 000371   000020 771000                    ARL     16
         1 000372   000105 100400                    MLR     fill='000'O
         1 000373   000005 000001 0                  ADSC9   INITKEYTBL               cn=0,n=1
         1 000374   300000 000430                    ADSC9   0,A,PR3                  cn=0,n=280

      336     7948    2         END;

      337     7949                    /*
      338     7950                    *  If this is an Indexed or IREL file, clear out leftover
      339     7951                    *  info from a previous open which can't be right anymore.
      340     7952                    */
      341     7953    2      IF F$DCB.ALTKEYX ~= 0 THEN DO;

   7953  1 000375   000052 721100                    LXL1    42,,PR0
         1 000376   000520 600000 1                  TZE     s:7978

      342     7954    2         P1$=PINCRW(B$ROSEG$,F$DCB.ALTKEYX);

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:100  
   7954  1 000377   000000 636011                    EAQ     0,X1
         1 000400   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000401   200006 756100                    STQ     P1$,,AUTO

      343     7955    3         IF F$DCB.ORG=%INDEXED# AND P1$->FITALTKEYS.K.FDA(0)~=0 THEN DO;

   7955  1 000402   000032 236100                    LDQ     26,,PR0
         1 000403   777000 376003                    ANQ     -512,DU
         1 000404   006000 116003                    CMPQ    3072,DU
         1 000405   000461 601000 1                  TNZ     s:7966
         1 000406   200006 473500                    LDP3    P1$,,AUTO
         1 000407   300001 236100                    LDQ     1,,PR3
         1 000410   000032 316000 xsym               CANQ    B_VECTNIL+26
         1 000411   000461 600000 1                  TZE     s:7966

      344     7956    3            P1$->FITALTKEYS.ALTBLD='0'B;

   7956  1 000412   000006 236000 2                  LDQ     6
         1 000413   300000 356100                    ANSQ    0,,PR3

      345     7957    3            P1$->FITALTKEYS.UNIQUEBLD='0'B;

   7957  1 000414   200006 473500                    LDP3    P1$,,AUTO
         1 000415   000007 236000 2                  LDQ     7
         1 000416   300000 356100                    ANSQ    0,,PR3

      346     7958    4            DO NKEYS=0 TO P1$->FITALTKEYS.NUMENTS-1;

   7958  1 000417   200033 450100                    STZ     NKEYS,,AUTO
         1 000420   000451 710000 1                  TRA     s:7964+3

      347     7959    4               P1$->FITALTKEYS.K.FDA(NKEYS)=0;

   7959  1 000421   200033 236100                    LDQ     NKEYS,,AUTO
         1 000422   000006 402007                    MPY     6,DL
         1 000423   200006 470500                    LDP0    P1$,,AUTO
         1 000424   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:101  
         1 000425   777000 236003                    LDQ     -512,DU
         1 000426   000001 356110                    ANSQ    1,X0,PR0

      348     7960    4               P1$->FITALTKEYS.K.LDA(NKEYS)=0;

   7960  1 000427   200006 470500                    LDP0    P1$,,AUTO
         1 000430   000777 236007                    LDQ     511,DL
         1 000431   000002 356110                    ANSQ    2,X0,PR0

      349     7961    4               P1$->FITALTKEYS.K.TDA(NKEYS)=0;

   7961  1 000432   000000 635010                    EAA     0,X0
         1 000433   000020 771000                    ARL     16
         1 000434   200006 470500                    LDP0    P1$,,AUTO
         1 000435   000105 101400                    MRL     fill='000'O
         1 000436   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         1 000437   000002 600003                    ADSC9   2,A,PR0                  cn=3,n=3

      350     7962    4               P1$->FITALTKEYS.K.TDALVL(NKEYS)=0;

   7962  1 000440   200006 470500                    LDP0    P1$,,AUTO
         1 000441   000032 236000 xsym               LDQ     B_VECTNIL+26
         1 000442   000004 356110                    ANSQ    4,X0,PR0

      351     7963    4               P1$->FITALTKEYS.K.DUPKEY(NKEYS)='0'B;

   7963  1 000443   200006 470500                    LDP0    P1$,,AUTO
         1 000444   000010 236000 2                  LDQ     8
         1 000445   000004 356110                    ANSQ    4,X0,PR0

      352     7964    4               END;

   7964  1 000446   200033 235100                    LDA     NKEYS,,AUTO
         1 000447   000001 035007                    ADLA    1,DL
         1 000450   200033 755100                    STA     NKEYS,,AUTO
         1 000451   200006 470500                    LDP0    P1$,,AUTO
         1 000452   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:102  
         1 000453   000022 772000                    QRL     18
         1 000454   000377 376007                    ANQ     255,DL
         1 000455   200033 116100                    CMPQ    NKEYS,,AUTO
         1 000456   000460 600000 1                  TZE     s:7965
         1 000457   000421 603000 1                  TRC     s:7959

      353     7965    3            END; /* Indexed */

   7965  1 000460   000520 710000 1                  TRA     s:7978

      354     7966    3         ELSE IF F$DCB.ORG=%IREL# AND P1$->IRKEYS.K.FDA(0)~=0 THEN DO;

   7966  1 000461   000032 236100                    LDQ     26,,PR0
         1 000462   777000 376003                    ANQ     -512,DU
         1 000463   015000 116003                    CMPQ    6656,DU
         1 000464   000520 601000 1                  TNZ     s:7978
         1 000465   200006 473500                    LDP3    P1$,,AUTO
         1 000466   300007 236100                    LDQ     7,,PR3
         1 000467   000032 316000 xsym               CANQ    B_VECTNIL+26
         1 000470   000520 600000 1                  TZE     s:7978

      355     7967    3               P1$->IRKEYS.ALTBLD='0'B;

   7967  1 000471   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 000472   300002 356100                    ANSQ    2,,PR3

      356     7968    3               P1$->IRKEYS.UNIQUEBLD='0'B;

   7968  1 000473   200006 473500                    LDP3    P1$,,AUTO
         1 000474   000011 236000 2                  LDQ     9
         1 000475   300002 356100                    ANSQ    2,,PR3

      357     7969    4               DO NKEYS=0 TO P1$->IRKEYS.NKEYS-1;

   7969  1 000476   200033 450100                    STZ     NKEYS,,AUTO
         1 000477   000512 710000 1                  TRA     s:7974+3

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:103  
      358     7970    4                  P1$->IRKEYS.K.FDA(0)=0;

   7970  1 000500   200006 470500                    LDP0    P1$,,AUTO
         1 000501   000000 236003                    LDQ     0,DU
         1 000502   000007 552134                    STBQ    7,'34'O,PR0

      359     7971    4                  P1$->IRKEYS.K.LDA(0)=0;

   7971  1 000503   000011 552134                    STBQ    9,'34'O,PR0

      360     7972    4                  P1$->IRKEYS.K.TDA(0)=0;

   7972  1 000504   000003 552134                    STBQ    3,'34'O,PR0

      361     7973    4                  P1$->IRKEYS.K.TDALVL(0)=0;

   7973  1 000505   200006 470500                    LDP0    P1$,,AUTO
         1 000506   000003 552140                    STBQ    3,'40'O,PR0

      362     7974    4                  END;

   7974  1 000507   200033 235100                    LDA     NKEYS,,AUTO
         1 000510   000001 035007                    ADLA    1,DL
         1 000511   200033 755100                    STA     NKEYS,,AUTO
         1 000512   200006 470500                    LDP0    P1$,,AUTO
         1 000513   000000 236100                    LDQ     0,,PR0
         1 000514   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 000515   200033 116100                    CMPQ    NKEYS,,AUTO
         1 000516   000520 600000 1                  TZE     s:7978
         1 000517   000500 603000 1                  TRC     s:7970

      363     7975    3               END; /* IREL */

      364     7976    2         END;

      365     7977
      366     7978    1      CODE=2;  /* SET CURRENT CODE */
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:104  

   7978  1 000520   000002 235007                    LDA     2,DL
         1 000521   200035 755100                    STA     CODE,,AUTO

      367     7979                    /*
      368     7980                    *  LOOP THROUGH BUILDING FIT CODE ENTRIES
      369     7981                    */
      370     7982    2      DO WHILE (CODE<32);

   7982  1 000522   000040 115007                    CMPA    32,DL
         1 000523   000532 605000 1                  TPL     s:7990

      371     7983    2         CALL FMO$BLDCODE ALTRET(FMOALTRET);

   7983  1 000524   000566 701000 1                  TSX1    FMO$BLDCODE
         1 000525   013126 702000 1                  TSX2    FMOALTRET

      372     7984    2         CODE=CODE+1;

   7984  1 000526   200035 054100                    AOS     CODE,,AUTO

      373     7985    2         END;

   7985  1 000527   200035 235100                    LDA     CODE,,AUTO
         1 000530   000040 115007                    CMPA    32,DL
         1 000531   000524 604000 1                  TMI     s:7983

      374     7986                    /*
      375     7987                    *  CODES ARE IN FIT, SET UP CODE01 OFFSET (ITEMX) AND
      376     7988                    *  GRANULE HEADER INFORMATION.
      377     7989                    */
      378     7990    1      CODE=1;

   7990  1 000532   000001 236007                    LDQ     1,DL
         1 000533   200035 756100                    STQ     CODE,,AUTO

      379     7991    1      I=16;    /* GET 16 WORDS FOR EXTENTS */
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:105  

   7991  1 000534   000020 235007                    LDA     16,DL
         1 000535   200012 755100                    STA     I,,AUTO

      380     7992    1      CALL FMO$FITSPACE(I)ALTRET(FMOE$VLPERR);

   7992  1 000536   200012 630500                    EPPR0   I,,AUTO
         1 000537   200047 450500                    STP0    FN+3,,AUTO
         1 000540   004717 701000 1                  TSX1    FMO$FITSPACE
         1 000541   000562 702000 1                  TSX2    FMOE$VLPERR

   7991  1 000542                       BLDFITX      null
      381     7993    1   BLDFITX:;
      382     7994    1      CODE01='0'B;

   7994  1 000542   200005 470500                    LDP0    LOC$,,AUTO
         1 000543   000100 100400                    MLR     fill='000'O
         1 000544   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000545   000000 000100                    ADSC9   0,,PR0                   cn=0,n=64

      383     7995    1      CODE01.HASH=JDCB$->F$DCB.HASH;

   7995  1 000546   200004 470500                    LDP0    JDCB$,,AUTO
         1 000547   200005 471500                    LDP1    LOC$,,AUTO
         1 000550   000073 236100                    LDQ     59,,PR0
         1 000551   000011 772000                    QRL     9
         1 000552   100000 552134                    STBQ    0,'34'O,PR1

      384     7996    1      FM$GRAN.STAMP=BINBIT(F$DCB.HASH,27);

   7996  1 000553   000073 236100                    LDQ     59,,PR0
         1 000554   000012 376000 2                  ANQ     10
         1 000555   200011 471500                    LDP1    BUF$,,AUTO
         1 000556   100000 756100                    STQ     0,,PR1

      385     7997                    /**/
      386     7998    1      F$DCB.BFR.SCRUB(1)='1'B;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:106  

   7998  1 000557   200000 236003                    LDQ     65536,DU
         1 000560   000116 256100                    ORSQ    78,,PR0

      387     7999    1      RETURN;

   7999  1 000561   000000 702200 xent               TSX2  ! X66_ARET

      388     8000                    /*E*     ERROR:   FMO-E$VLPERR-E
      389     8001                    *        MESSAGE:The FIT% for %FN% won't fit in a granule.
      390     8002                    */
      391     8003    1   FMOE$VLPERR: B$JIT$->B$JIT.ERR=FMO$E$VLPERR;

   8003  1 000562   000013 236000 0     FMOE$VLPERR  LDQ     FMO$E$VLPERR
         1 000563   000000 470400 xsym               LDP0    B$JIT$
         1 000564   000012 756100                    STQ     10,,PR0

      392     8004    1      ALTRETURN;

   8004  1 000565   000000 702200 xent               TSX2  ! X66_AALT

      393     8005        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:107  
      394     8006                    /*I*  NAME: FMO$BLDCODE
      395     8007                    *
      396     8008                    *     PURPOSE:  TO ADD CODES TO THE FIT RECORD
      397     8009                    */
      398     8010    1   FMO$BLDCODE: PROC ALTRET;

   8010  1 000566   200040 741300       FMO$BLDCODE  STX1  ! CODE+3,,AUTO

      399     8011    2      IF B$JIT.PRIV.ACTIVE.FMEFT AND PN$.IFPARAM_~=ADDR(NIL)

   8011  1 000567   000000 470400 xsym               LDP0    B$JIT$
         1 000570   000013 234100                    SZN     11,,PR0
         1 000571   000621 605000 1                  TPL     RET123
         1 000572   200003 471500                    LDP1    @DUMMY,,AUTO
         1 000573   100013 236100                    LDQ     11,,PR1
         1 000574   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000575   000621 600000 1                  TZE     RET123

      400     8012    3      THEN DO;

      401     8013    3         T$=PN$.IFPARAM_;

   8013  1 000576   200016 756100                    STQ     T$,,AUTO

      402     8014    3         I=CODE;

   8014  1 000577   200035 235100                    LDA     CODE,,AUTO
         1 000600   200012 755100                    STA     I,,AUTO

      403     8015    3         CALL FMO$LOCCODE(XT$,I)ALTRET(RET123);

   8015  1 000601   200012 633500                    EPPR3   I,,AUTO
         1 000602   200053 453500                    STP3    INDX+2,,AUTO
         1 000603   200017 236100                    LDQ     T$$,,AUTO
         1 000604   200052 756100                    STQ     INDX+1,,AUTO
         1 000605   200052 630500                    EPPR0   INDX+1,,AUTO
         1 000606   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:108  
         1 000607   000000 701000 xent               TSX1    FMO$LOCCODE
         1 000610   000621 702000 1                  TSX2    RET123

      404     8016    3         P1$=T$;

   8016  1 000611   200016 236100                    LDQ     T$,,AUTO
         1 000612   200006 756100                    STQ     P1$,,AUTO

      405     8017    3         IBIT=PN$.IFPARAM_->FM$FIT.CODES(I);

   8017  1 000613   200003 470500                    LDP0    @DUMMY,,AUTO
         1 000614   000013 471500                    LDP1    11,,PR0
         1 000615   200012 720100                    LXL0    I,,AUTO
         1 000616   100000 236110                    LDQ     0,X0,PR1
         1 000617   200012 756100                    STQ     I,,AUTO

      406     8018    3         END;

   8018  1 000620   000623 710000 1                  TRA     s:8020

      407     8019    2      ELSE RET123: P1$=ADDR(NIL);

   8019  1 000621   000001 236000 xsym  RET123       LDQ     B_VECTNIL+1
         1 000622   200006 756100                    STQ     P1$,,AUTO

      408     8020    3      DO CASE(CODE);

   8020  1 000623   200035 235100                    LDA     CODE,,AUTO
         1 000624   000026 115007                    CMPA    22,DL
         1 000625   000627 602005 1                  TNC     s:8020+4,AL
         1 000626   002373 710000 1                  TRA     RETRET
         1 000627   002373 710000 1                  TRA     RETRET
         1 000630   002373 710000 1                  TRA     RETRET
         1 000631   000655 710000 1                  TRA     s:8024
         1 000632   000740 710000 1                  TRA     s:8038
         1 000633   001154 710000 1                  TRA     s:8075
         1 000634   001237 710000 1                  TRA     s:8092
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:109  
         1 000635   001237 710000 1                  TRA     s:8092
         1 000636   001272 710000 1                  TRA     s:8102
         1 000637   001325 710000 1                  TRA     s:8112
         1 000640   002143 710000 1                  TRA     s:8252
         1 000641   002147 710000 1                  TRA     s:8255
         1 000642   002161 710000 1                  TRA     s:8265
         1 000643   002165 710000 1                  TRA     s:8268
         1 000644   002171 710000 1                  TRA     s:8271
         1 000645   002373 710000 1                  TRA     RETRET
         1 000646   001476 710000 1                  TRA     s:8148
         1 000647   001542 710000 1                  TRA     s:8160
         1 000650   001462 710000 1                  TRA     s:8140
         1 000651   001604 710000 1                  TRA     s:8171
         1 000652   001716 710000 1                  TRA     s:8202
         1 000653   002002 710000 1                  TRA     s:8218
         1 000654   002031 710000 1                  TRA     s:8227

      409     8021                    /**/
      410     8022    3      CASE(2); /* KEYED-INDEXED FPARAM DATA */

      411     8023                    /**/
      412     8024    3         IF F$DCB.IORG~=%KEYED# THEN RETURN;

   8024  1 000655   200004 470500                    LDP0    JDCB$,,AUTO
         1 000656   000070 236100                    LDQ     56,,PR0
         1 000657   077000 376003                    ANQ     32256,DU
         1 000660   002000 116003                    CMPQ    1024,DU
         1 000661   000664 600000 1                  TZE     s:8025

   8024  1 000662   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 000663   000001 702211                    TSX2  ! 1,X1

      413     8025    3         CALL     FMO$FITSPACE(SIZEW(CODE02)) ALTRET(FMOE$VLPERR);

   8025  1 000664   000013 236000 2                  LDQ     11
         1 000665   200047 756100                    STQ     FN+3,,AUTO
         1 000666   004717 701000 1                  TSX1    FMO$FITSPACE
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:110  
         1 000667   002375 702000 1                  TSX2    FMOE$VLPERR

      414     8026    3         CODE02='0'B;

   8026  1 000670   200005 470500                    LDP0    LOC$,,AUTO
         1 000671   000100 100400                    MLR     fill='000'O
         1 000672   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000673   000000 000017                    ADSC9   0,,PR0                   cn=0,n=15

      415     8027    3         IF F$DCB.KEYL=0 THEN F$DCB.KEYL=1;

   8027  1 000674   200004 470500                    LDP0    JDCB$,,AUTO
         1 000675   000036 236100                    LDQ     30,,PR0
         1 000676   777000 316007                    CANQ    -512,DL
         1 000677   000702 601000 1                  TNZ     s:8028

   8027  1 000700   001000 236007                    LDQ     512,DL
         1 000701   000036 552110                    STBQ    30,'10'O,PR0

      416     8028    3         IF F$DCB.KEYL>255 THEN GOTO FMOE$BADALT;

   8028  1 000702   000036 236100                    LDQ     30,,PR0
         1 000703   777000 376007                    ANQ     -512,DL
         1 000704   400000 116007                    CMPQ    -131072,DL
         1 000705   002453 603000 1                  TRC     FMOE$BADALT

      417     8029    3         CODE02.LSLIDE=JDCB$->F$DCB.LSLIDE;

   8029  1 000706   200005 471500                    LDP1    LOC$,,AUTO
         1 000707   000037 236100                    LDQ     31,,PR0
         1 000710   000022 736000                    QLS     18
         1 000711   100000 552140                    STBQ    0,'40'O,PR1

      418     8030    3         CODE02.LRDL0=JDCB$->F$DCB.LRDL0;

   8030  1 000712   200005 471500                    LDP1    LOC$,,AUTO
         1 000713   000037 236100                    LDQ     31,,PR0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:111  
         1 000714   000022 736000                    QLS     18
         1 000715   100000 552120                    STBQ    0,'20'O,PR1

      419     8031    3         CODE02.SPARE=JDCB$->F$DCB.SPARE;

   8031  1 000716   200005 471500                    LDP1    LOC$,,AUTO
         1 000717   000040 236100                    LDQ     32,,PR0
         1 000720   000022 772000                    QRL     18
         1 000721   100000 552110                    STBQ    0,'10'O,PR1

      420     8032    3         CODE02.KEYX=JDCB$->F$DCB.KEYX;

   8032  1 000722   000036 220100                    LDX0    30,,PR0
         1 000723   200005 471500                    LDP1    LOC$,,AUTO
         1 000724   100003 740100                    STX0    3,,PR1

      421     8033    3         CODE02.KEYL=JDCB$->F$DCB.KEYL;

   8033  1 000725   200005 471500                    LDP1    LOC$,,AUTO
         1 000726   000036 236100                    LDQ     30,,PR0
         1 000727   100003 552110                    STBQ    3,'10'O,PR1

      422     8034    3         IF F$DCB.IASN=%FILE# THEN FM$CFU.SLIDE=1;

   8034  1 000730   000103 236100                    LDQ     67,,PR0
         1 000731   000777 376007                    ANQ     511,DL
         1 000732   000001 116007                    CMPQ    1,DL
         1 000733   002373 601000 1                  TNZ     RETRET

   8034  1 000734   200010 471500                    LDP1    CFU$,,AUTO
         1 000735   001000 236003                    LDQ     512,DU
         1 000736   100005 552140                    STBQ    5,'40'O,PR1
         1 000737   002373 710000 1                  TRA     RETRET

      423     8035                    /**/
      424     8036    3      CASE(3); /* FPARAM DATA */

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:112  
      425     8037                    /**/
      426     8038    3         CALL     FMO$FITSPACE(SIZEW(CODE03)) ALTRET(FMOE$VLPERR);

   8038  1 000740   000014 236000 2                  LDQ     12
         1 000741   200047 756100                    STQ     FN+3,,AUTO
         1 000742   004717 701000 1                  TSX1    FMO$FITSPACE
         1 000743   002375 702000 1                  TSX2    FMOE$VLPERR

      427     8039    3         IF P1$~=ADDR(NIL) THEN CODE03=P1$->CODE03;

   8039  1 000744   200006 236100                    LDQ     P1$,,AUTO
         1 000745   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000746   000755 600000 1                  TZE     s:8041

   8039  1 000747   200006 470500                    LDP0    P1$,,AUTO
         1 000750   200005 471500                    LDP1    LOC$,,AUTO
         1 000751   000100 100500                    MLR     fill='000'O
         1 000752   000000 000044                    ADSC9   0,,PR0                   cn=0,n=36
         1 000753   100000 000044                    ADSC9   0,,PR1                   cn=0,n=36
         1 000754   001065 710000 1                  TRA     s:8060

      428     8040    4         ELSE DO;

      429     8041    4            IF SUBSTR(F$DCB.TYPE,0,1)='*' AND F$DCB.WSR~=0 THEN F$DCB.TYPE=' ';

   8041  1 000755   200004 470500                    LDP0    JDCB$,,AUTO
         1 000756   000025 236100                    LDQ     21,,PR0
         1 000757   777000 376007                    ANQ     -512,DL
         1 000760   052000 116007                    CMPQ    21504,DL
         1 000761   000767 601000 1                  TNZ     s:8042
         1 000762   000040 236100                    LDQ     32,,PR0
         1 000763   000777 316003                    CANQ    511,DU
         1 000764   000767 600000 1                  TZE     s:8042

   8041  1 000765   040040 220003                    LDX0    16416,DU
         1 000766   000025 440100                    SXL0    21,,PR0

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:113  
      430     8042    4            CODE03='0'B;

   8042  1 000767   200005 471500                    LDP1    LOC$,,AUTO
         1 000770   000100 100400                    MLR     fill='000'O
         1 000771   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000772   100000 000044                    ADSC9   0,,PR1                   cn=0,n=36

      431     8043    4            CODE03.ORG=JDCB$->F$DCB.ORG;

   8043  1 000773   200005 471500                    LDP1    LOC$,,AUTO
         1 000774   000032 236100                    LDQ     26,,PR0
         1 000775   100000 552140                    STBQ    0,'40'O,PR1

      432     8044    4            CODE03.TYPE=JDCB$->F$DCB.TYPE;

   8044  1 000776   000025 720100                    LXL0    21,,PR0
         1 000777   200005 471500                    LDP1    LOC$,,AUTO
         1 001000   100001 440100                    SXL0    1,,PR1

      433     8045    4            CODE03.DESC=JDCB$->F$DCB.DESC;

   8045  1 001001   000005 720100                    LXL0    5,,PR0
         1 001002   200005 471500                    LDP1    LOC$,,AUTO
         1 001003   100001 740100                    STX0    1,,PR1

      434     8046    5            IF F$DCB.IORG~=%RANDOM# THEN DO;

   8046  1 001004   000070 236100                    LDQ     56,,PR0
         1 001005   077000 376003                    ANQ     32256,DU
         1 001006   003000 116003                    CMPQ    1536,DU
         1 001007   001045 600000 1                  TZE     s:8056

      435     8047    5               CODE03.LDA=FM_FRZERO;

   8047  1 001010   200005 471500                    LDP1    LOC$,,AUTO
         1 001011   000000 236000 xsym               LDQ     FM_FRZERO
         1 001012   100004 552134                    STBQ    4,'34'O,PR1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:114  

      436     8048    5               CODE03.XTNSIZE=JDCB$->F$DCB.XTNSIZE;

   8048  1 001013   000037 220100                    LDX0    31,,PR0
         1 001014   200005 471500                    LDP1    LOC$,,AUTO
         1 001015   100005 740100                    STX0    5,,PR1

      437     8049    5               CODE03.COMP=JDCB$->F$DCB.COMP;

   8049  1 001016   200005 471500                    LDP1    LOC$,,AUTO
         1 001017   000031 236100                    LDQ     25,,PR0
         1 001020   000035 736000                    QLS     29
         1 001021   100004 676100                    ERQ     4,,PR1
         1 001022   400000 376003                    ANQ     -131072,DU
         1 001023   100004 656100                    ERSQ    4,,PR1

      438     8050    6               IF F$DCB.IORG=%RELATIVE# THEN DO;

   8050  1 001024   000070 236100                    LDQ     56,,PR0
         1 001025   077000 376003                    ANQ     32256,DU
         1 001026   005000 116003                    CMPQ    2560,DU
         1 001027   001050 601000 1                  TNZ     s:8057

      439     8051    6                  CODE03.RECL=JDCB$->F$DCB.RECL;

   8051  1 001030   000033 720100                    LXL0    27,,PR0
         1 001031   200005 471500                    LDP1    LOC$,,AUTO
         1 001032   100005 440100                    SXL0    5,,PR1

      440     8052    6                  CODE03.RCSZ=JDCB$->F$DCB.RECL/4096;

   8052  1 001033   000033 236100                    LDQ     27,,PR0
         1 001034   777777 376007                    ANQ     -1,DL
         1 001035   000014 772000                    QRL     12
         1 001036   200005 471500                    LDP1    LOC$,,AUTO
         1 001037   000033 736000                    QLS     27
         1 001040   100003 552140                    STBQ    3,'40'O,PR1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:115  

      441     8053    6                  CODE03.NRECS=F$DCB.NRECS;

   8053  1 001041   200005 471500                    LDP1    LOC$,,AUTO
         1 001042   000042 235100                    LDA     34,,PR0
         1 001043   100002 755100                    STA     2,,PR1

      442     8054    6                  END;

      443     8055    5               END;

   8055  1 001044   001050 710000 1                  TRA     s:8057

      444     8056    4            ELSE CODE03.NRECS=JDCB$->F$DCB.IXTNSIZE;

   8056  1 001045   200005 471500                    LDP1    LOC$,,AUTO
         1 001046   000041 235100                    LDA     33,,PR0
         1 001047   100002 755100                    STA     2,,PR1

      445     8057    4            IF F$DCB.GHSTACS~=%NONE# THEN CODE03.GHSTACS=F$DCB.GHSTACS;

   8057  1 001050   000052 236100                    LDQ     42,,PR0
         1 001051   000017 376003                    ANQ     15,DU
         1 001052   000003 116003                    CMPQ    3,DU
         1 001053   001063 600000 1                  TZE     s:8058

   8057  1 001054   200005 471500                    LDP1    LOC$,,AUTO
         1 001055   000052 236100                    LDQ     42,,PR0
         1 001056   000011 736000                    QLS     9
         1 001057   100004 676100                    ERQ     4,,PR1
         1 001060   017000 376003                    ANQ     7680,DU
         1 001061   100004 656100                    ERSQ    4,,PR1
         1 001062   001065 710000 1                  TRA     s:8060

      446     8058    4            ELSE F$DCB.GHSTACS=0;

   8058  1 001063   000015 236000 2                  LDQ     13
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:116  
         1 001064   000052 356100                    ANSQ    42,,PR0

      447     8059    4            END;

      448     8060    3         F$DCB.DESC=CODE03.DESC;

   8060  1 001065   200005 470500                    LDP0    LOC$,,AUTO
         1 001066   000001 220100                    LDX0    1,,PR0
         1 001067   200004 471500                    LDP1    JDCB$,,AUTO
         1 001070   100005 440100                    SXL0    5,,PR1

      449     8061    3         IF F$DCB.IASN=%FILE# THEN CODE03.UGRANS=0;

   8061  1 001071   100103 236100                    LDQ     67,,PR1
         1 001072   000777 376007                    ANQ     511,DL
         1 001073   000001 116007                    CMPQ    1,DL
         1 001074   001101 601000 1                  TNZ     s:8062

   8061  1 001075   200005 470500                    LDP0    LOC$,,AUTO
         1 001076   000000 236003                    LDQ     0,DU
         1 001077   000000 552134                    STBQ    0,'34'O,PR0
         1 001100   001104 710000 1                  TRA     s:8063

      450     8062    3         ELSE CODE03.UGRANS=F$DCB.IXTNSIZE;

   8062  1 001101   200005 470500                    LDP0    LOC$,,AUTO
         1 001102   100041 236100                    LDQ     33,,PR1
         1 001103   000000 552134                    STBQ    0,'34'O,PR0

      451     8063    3         CALL FMM$NSTAMP(CODE03.NSTAMP);

   8063  1 001104   200005 236100                    LDQ     LOC$,,AUTO
         1 001105   000006 036003                    ADLQ    6,DU
         1 001106   200052 756100                    STQ     INDX+1,,AUTO
         1 001107   200052 630500                    EPPR0   INDX+1,,AUTO
         1 001110   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001111   000000 701000 xent               TSX1    FMM$NSTAMP
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:117  
         1 001112   000000 011000                    NOP     0

      452     8064    4         IF NOT B$JIT.PRIV.ACTIVE.FMEFT THEN DO;

   8064  1 001113   000000 470400 xsym               LDP0    B$JIT$
         1 001114   000013 234100                    SZN     11,,PR0
         1 001115   001136 604000 1                  TMI     s:8069

      453     8065    4            IF (F$DCB.EXPIRE>B$JIT.MAXEXP OR F$DCB.EXPIRE<0)

   8065  1 001116   200004 471500                    LDP1    JDCB$,,AUTO
         1 001117   000221 236100                    LDQ     145,,PR0
         1 001120   000022 736000                    QLS     18
         1 001121   000022 732000                    QRS     18
         1 001122   100035 116100                    CMPQ    29,,PR1
         1 001123   001126 604000 1                  TMI     s:8065+8
         1 001124   100035 235100                    LDA     29,,PR1
         1 001125   001131 605000 1                  TPL     s:8067
         1 001126   000221 720100                    LXL0    145,,PR0
         1 001127   001131 604000 1                  TMI     s:8067

      454     8066    4              AND B$JIT.MAXEXP>=0 THEN F$DCB.EXPIRE=B$JIT.MAXEXP;

   8066  1 001130   100035 756100                    STQ     29,,PR1

      455     8067    4            IF F$DCB.EXPIRE=0 THEN F$DCB.EXPIRE=B$JIT.DEFEXP;

   8067  1 001131   100035 235100                    LDA     29,,PR1
         1 001132   001136 601000 1                  TNZ     s:8069

   8067  1 001133   000221 236100                    LDQ     145,,PR0
         1 001134   000022 732000                    QRS     18
         1 001135   100035 756100                    STQ     29,,PR1

      456     8068    4            END;

      457     8069    3         CODE03.EXPIRE=F$DCB.EXPIRE;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:118  

   8069  1 001136   200004 471500                    LDP1    JDCB$,,AUTO
         1 001137   100035 720100                    LXL0    29,,PR1
         1 001140   200005 473500                    LDP3    LOC$,,AUTO
         1 001141   300007 740100                    STX0    7,,PR3

      458     8070                    /* NO DATES,BACKUP, OR STOW FOR TEMP FILES */
      459     8071    3         IF F$DCB.STARF OR F$DCB.DISP=%SCRATCH# THEN CODE=6;

   8071  1 001142   100064 236100                    LDQ     52,,PR1
         1 001143   200000 316003                    CANQ    65536,DU
         1 001144   001151 601000 1                  TNZ     s:8071+7
         1 001145   100032 236100                    LDQ     26,,PR1
         1 001146   000777 376007                    ANQ     511,DL
         1 001147   000001 116007                    CMPQ    1,DL
         1 001150   002373 601000 1                  TNZ     RETRET

   8071  1 001151   000006 235007                    LDA     6,DL
         1 001152   200035 755100                    STA     CODE,,AUTO
         1 001153   002373 710000 1                  TRA     RETRET

      460     8072                    /**/
      461     8073    3      CASE(4); /* DATES RECORD */

      462     8074                    /**/
      463     8075    3         CALL     FMO$FITSPACE(SIZEW(CODE04)) ALTRET(FMOE$VLPERR);

   8075  1 001154   000016 236000 2                  LDQ     14
         1 001155   200047 756100                    STQ     FN+3,,AUTO
         1 001156   004717 701000 1                  TSX1    FMO$FITSPACE
         1 001157   002375 702000 1                  TSX2    FMOE$VLPERR

      464     8076    3         IF P1$ ~= ADDR(NIL) THEN CODE04=P1$->CODE04;

   8076  1 001160   200006 236100                    LDQ     P1$,,AUTO
         1 001161   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001162   001171 600000 1                  TZE     s:8078
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:119  

   8076  1 001163   200006 470500                    LDP0    P1$,,AUTO
         1 001164   200005 471500                    LDP1    LOC$,,AUTO
         1 001165   000100 100500                    MLR     fill='000'O
         1 001166   000000 000054                    ADSC9   0,,PR0                   cn=0,n=44
         1 001167   100000 000054                    ADSC9   0,,PR1                   cn=0,n=44
         1 001170   002373 710000 1                  TRA     RETRET

      465     8077    4         ELSE DO;

      466     8078    4            CODE04.CREATOR.NAME=B$JIT$->B$JIT.UNAME;

   8078  1 001171   000000 470400 xsym               LDP0    B$JIT$
         1 001172   200005 471500                    LDP1    LOC$,,AUTO
         1 001173   040100 100500                    MLR     fill='040'O
         1 001174   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         1 001175   100005 000014                    ADSC9   5,,PR1                   cn=0,n=12

      467     8079    4            CODE04.CREATOR.ACCT=B$JIT$->B$JIT.ACCN;

   8079  1 001176   200005 471500                    LDP1    LOC$,,AUTO
         1 001177   040100 100500                    MLR     fill='040'O
         1 001200   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         1 001201   100003 000010                    ADSC9   3,,PR1                   cn=0,n=8

      468     8080    4            IF F$DCB.WSR~=1 THEN F$DCB.OWNER='1'B;

   8080  1 001202   200004 471500                    LDP1    JDCB$,,AUTO
         1 001203   100040 236100                    LDQ     32,,PR1
         1 001204   000777 376003                    ANQ     511,DU
         1 001205   000001 116003                    CMPQ    1,DU
         1 001206   001211 600000 1                  TZE     s:8081

   8080  1 001207   040000 236007                    LDQ     16384,DL
         1 001210   100064 256100                    ORSQ    52,,PR1

      469     8081    4            CODE04.ACCESS.TIME=I;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:120  

   8081  1 001211   200005 473500                    LDP3    LOC$,,AUTO
         1 001212   200012 235100                    LDA     I,,AUTO
         1 001213   300000 755100                    STA     0,,PR3

      470     8082    4            CODE04.MODIFY.TIME=I;

   8082  1 001214   200005 473500                    LDP3    LOC$,,AUTO
         1 001215   200012 235100                    LDA     I,,AUTO
         1 001216   300001 755100                    STA     1,,PR3

      471     8083    4            IF F$DCB.ACS=%BLOCK# THEN CODE04.SVMODIFY.TIME=0;

   8083  1 001217   100036 236100                    LDQ     30,,PR1
         1 001220   000777 376007                    ANQ     511,DL
         1 001221   000003 116007                    CMPQ    3,DL
         1 001222   001226 601000 1                  TNZ     s:8084

   8083  1 001223   200005 473500                    LDP3    LOC$,,AUTO
         1 001224   300010 450100                    STZ     8,,PR3
         1 001225   001231 710000 1                  TRA     s:8085

      472     8084    4            ELSE CODE04.SVMODIFY.TIME=I;

   8084  1 001226   200005 473500                    LDP3    LOC$,,AUTO
         1 001227   200012 235100                    LDA     I,,AUTO
         1 001230   300010 755100                    STA     8,,PR3

      473     8085    4            CODE04.GAC.TIME=I;

   8085  1 001231   200012 235100                    LDA     I,,AUTO
         1 001232   300012 755100                    STA     10,,PR3

      474     8086    4            CODE04.GAC.N=0;

   8086  1 001233   300011 450100                    STZ     9,,PR3

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:121  
      475     8087    4            CODE04.CREATION.TIME=I;

   8087  1 001234   200012 236100                    LDQ     I,,AUTO
         1 001235   300002 756100                    STQ     2,,PR3

      476     8088    4            END;

   8088  1 001236   002373 710000 1                  TRA     RETRET

      477     8089                    /**/
      478     8090    3      CASE(5,6); /* BACKUP/STOW TIME AND REEL/DATE */

      479     8091                    /**/
      480     8092    3         IF P1$=ADDR(NIL) THEN I=SIZEW(CODE05);

   8092  1 001237   200006 236100                    LDQ     P1$,,AUTO
         1 001240   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001241   001244 601000 1                  TNZ     s:8093

   8092  1 001242   000003 235007                    LDA     3,DL
         1 001243   200012 755100                    STA     I,,AUTO

      481     8093    3         CALL FMO$FITSPACE(I)ALTRET(FMOE$VLPERR);

   8093  1 001244   200012 630500                    EPPR0   I,,AUTO
         1 001245   200047 450500                    STP0    FN+3,,AUTO
         1 001246   004717 701000 1                  TSX1    FMO$FITSPACE
         1 001247   002375 702000 1                  TSX2    FMOE$VLPERR

      482     8094    3         IF P1$ ~= ADDR(NIL) THEN CODE05=P1$->CODE05;

   8094  1 001250   200006 236100                    LDQ     P1$,,AUTO
         1 001251   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001252   001261 600000 1                  TZE     s:8096

   8094  1 001253   200006 470500                    LDP0    P1$,,AUTO
         1 001254   200005 471500                    LDP1    LOC$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:122  
         1 001255   000100 100500                    MLR     fill='000'O
         1 001256   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12
         1 001257   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12
         1 001260   002373 710000 1                  TRA     RETRET

      483     8095    4         ELSE DO;

      484     8096    4            CODE05='0'B;

   8096  1 001261   200005 470500                    LDP0    LOC$,,AUTO
         1 001262   000100 100400                    MLR     fill='000'O
         1 001263   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001264   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      485     8097    4            FM$FIT.CODES.NDW(J)=0;

   8097  1 001265   200007 470500                    LDP0    FIT$,,AUTO
         1 001266   200013 720100                    LXL0    J,,AUTO
         1 001267   000004 236000 2                  LDQ     4
         1 001270   000000 356110                    ANSQ    0,X0,PR0

      486     8098    4            END;

   8098  1 001271   002373 710000 1                  TRA     RETRET

      487     8099                    /**/
      488     8100    3      CASE(7); /* PASSWORD */

      489     8101                    /**/
      490     8102    4         IF P1$ ~= ADDR(NIL) THEN DO;

   8102  1 001272   200006 236100                    LDQ     P1$,,AUTO
         1 001273   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001274   001307 600000 1                  TZE     s:8106

      491     8103    4            CALL FMO$FITSPACE(I)ALTRET(FMOE$VLPERR);

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:123  
   8103  1 001275   200012 630500                    EPPR0   I,,AUTO
         1 001276   200047 450500                    STP0    FN+3,,AUTO
         1 001277   004717 701000 1                  TSX1    FMO$FITSPACE
         1 001300   002375 702000 1                  TSX2    FMOE$VLPERR

      492     8104    4            CODE07=P1$->CODE07;

   8104  1 001301   200006 470500                    LDP0    P1$,,AUTO
         1 001302   200005 471500                    LDP1    LOC$,,AUTO
         1 001303   000100 100500                    MLR     fill='000'O
         1 001304   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         1 001305   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8

      493     8105    4            END;

   8105  1 001306   002373 710000 1                  TRA     RETRET

      494     8106    4         ELSE IF F$DCB.PASSF THEN DO;

   8106  1 001307   200004 470500                    LDP0    JDCB$,,AUTO
         1 001310   000031 236100                    LDQ     25,,PR0
         1 001311   400000 316007                    CANQ    -131072,DL
         1 001312   002373 600000 1                  TZE     RETRET

      495     8107    4               CALL     FMO$FITSPACE(SIZEW(CODE07)) ALTRET(FMOE$VLPERR);

   8107  1 001313   000017 236000 2                  LDQ     15
         1 001314   200047 756100                    STQ     FN+3,,AUTO
         1 001315   004717 701000 1                  TSX1    FMO$FITSPACE
         1 001316   002375 702000 1                  TSX2    FMOE$VLPERR

      496     8108    4               CODE07.PASS=JDCB$->F$DCB.PASS;

   8108  1 001317   200005 470500                    LDP0    LOC$,,AUTO
         1 001320   200004 471500                    LDP1    JDCB$,,AUTO
         1 001321   100022 237100                    LDAQ    18,,PR1
         1 001322   000000 755100                    STA     0,,PR0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:124  
         1 001323   000001 756100                    STQ     1,,PR0

      497     8109    4               END;

   8109  1 001324   002373 710000 1                  TRA     RETRET

      498     8110                    /**/
      499     8111    3      CASE(8); /* ALTERNATE INDEX */

      500     8112    3         IF F$DCB.ORG~=%INDEXED# THEN RETURN;

   8112  1 001325   200004 470500                    LDP0    JDCB$,,AUTO
         1 001326   000032 236100                    LDQ     26,,PR0
         1 001327   777000 376003                    ANQ     -512,DU
         1 001330   006000 116003                    CMPQ    3072,DU
         1 001331   001334 600000 1                  TZE     s:8113

   8112  1 001332   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 001333   000001 702211                    TSX2  ! 1,X1

      501     8113    3         IF F$DCB.KEYX+F$DCB.KEYL>%FMG_KEYLEN_MAX OR

   8113  1 001334   000036 236100                    LDQ     30,,PR0
         1 001335   000011 772000                    QRL     9
         1 001336   000777 376007                    ANQ     511,DL
         1 001337   200052 756100                    STQ     INDX+1,,AUTO
         1 001340   000036 236100                    LDQ     30,,PR0
         1 001341   000022 772000                    QRL     18
         1 001342   200052 036100                    ADLQ    INDX+1,,AUTO
         1 001343   007641 116007                    CMPQ    4001,DL
         1 001344   002453 603000 1                  TRC     FMOE$BADALT
         1 001345   000036 236100                    LDQ     30,,PR0
         1 001346   777000 316007                    CANQ    -512,DL
         1 001347   002453 600000 1                  TZE     FMOE$BADALT
         1 001350   000036 236100                    LDQ     30,,PR0
         1 001351   777000 376007                    ANQ     -512,DL
         1 001352   400000 116007                    CMPQ    -131072,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:125  
         1 001353   002453 603000 1                  TRC     FMOE$BADALT

      502     8114    3           F$DCB.KEYL=0 OR
      503     8115    3           F$DCB.KEYL>255 THEN
      504     8116    3            GOTO FMOE$BADALT;
      505     8117
      506     8118    4         IF P1$=ADDR(NIL) AND F$DCB.ALTKEYX~=0 THEN DO;

   8118  1 001354   200006 236100                    LDQ     P1$,,AUTO
         1 001355   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001356   001370 601000 1                  TNZ     s:8123
         1 001357   000052 720100                    LXL0    42,,PR0
         1 001360   001370 600000 1                  TZE     s:8123

      507     8119    4            P1$=PINCRW(B$ROSEG$, F$DCB.ALTKEYX);

   8119  1 001361   000000 636010                    EAQ     0,X0
         1 001362   000000 036000 xsym               ADLQ    B$ROSEG$
         1 001363   200006 756100                    STQ     P1$,,AUTO

      508     8120    4            I=P1$->FITALTKEYS.NUMWRDS;

   8120  1 001364   200006 471500                    LDP1    P1$,,AUTO
         1 001365   100000 236100                    LDQ     0,,PR1
         1 001366   000033 772000                    QRL     27
         1 001367   200012 756100                    STQ     I,,AUTO

      509     8121    4            END;

      510     8122
      511     8123    4         IF P1$~=ADDR(NIL) THEN DO;

   8123  1 001370   200006 236100                    LDQ     P1$,,AUTO
         1 001371   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001372   001440 600000 1                  TZE     ALTKFPRG

      512     8124    5            DO J=1 TO P1$->FITALTKEYS.NUMENTS-1;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:126  

   8124  1 001373   000001 235007                    LDA     1,DL
         1 001374   200013 755100                    STA     J,,AUTO
         1 001375   001431 710000 1                  TRA     s:8129+3

      513     8125    5               IF P1$->FITALTKEYS.K.KEYX(J)+P1$->FITALTKEYS.K.KEYL(J)>%FMG_KEYLEN_MAX
              8125                        OR

   8125  1 001376   200013 236100                    LDQ     J,,AUTO
         1 001377   000006 402007                    MPY     6,DL
         1 001400   200006 470500                    LDP0    P1$,,AUTO
         1 001401   000001 236106                    LDQ     1,QL,PR0
         1 001402   000033 772000                    QRL     27
         1 001403   200052 756100                    STQ     INDX+1,,AUTO
         1 001404   200013 236100                    LDQ     J,,AUTO
         1 001405   000006 402007                    MPY     6,DL
         1 001406   000003 236106                    LDQ     3,QL,PR0
         1 001407   777777 376007                    ANQ     -1,DL
         1 001410   200052 036100                    ADLQ    INDX+1,,AUTO
         1 001411   007641 116007                    CMPQ    4001,DL
         1 001412   002453 603000 1                  TRC     FMOE$BADALT
         1 001413   200013 236100                    LDQ     J,,AUTO
         1 001414   000006 402007                    MPY     6,DL
         1 001415   000001 236106                    LDQ     1,QL,PR0
         1 001416   777000 316003                    CANQ    -512,DU
         1 001417   002453 600000 1                  TZE     FMOE$BADALT
         1 001420   200013 236100                    LDQ     J,,AUTO
         1 001421   000006 402007                    MPY     6,DL
         1 001422   000001 236106                    LDQ     1,QL,PR0
         1 001423   777000 376003                    ANQ     -512,DU
         1 001424   400000 116003                    CMPQ    -131072,DU
         1 001425   002453 603000 1                  TRC     FMOE$BADALT

      514     8126    5                 P1$->FITALTKEYS.K.KEYL(J)=0 OR
      515     8127    5                 P1$->FITALTKEYS.K.KEYL(J)>255 THEN
      516     8128    5                  GOTO FMOE$BADALT;
      517     8129    5               END; /* DO J */
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:127  

   8129  1 001426   200013 235100                    LDA     J,,AUTO
         1 001427   000001 035007                    ADLA    1,DL
         1 001430   200013 755100                    STA     J,,AUTO
         1 001431   200006 470500                    LDP0    P1$,,AUTO
         1 001432   000000 236100                    LDQ     0,,PR0
         1 001433   000022 772000                    QRL     18
         1 001434   000377 376007                    ANQ     255,DL
         1 001435   200013 116100                    CMPQ    J,,AUTO
         1 001436   001440 600000 1                  TZE     ALTKFPRG
         1 001437   001376 603000 1                  TRC     s:8125

      518     8130    4            END;

   8126  1 001440                       ALTKFPRG     null
      519     8131    3   ALTKFPRG: ;
      520     8132    4         IF P1$~=ADDR(NIL) THEN DO;

   8132  1 001440   200006 236100                    LDQ     P1$,,AUTO
         1 001441   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001442   002373 600000 1                  TZE     RETRET

      521     8133    4            CALL FMO$FITSPACE(I) ALTRET(FMOE$VLPERR);

   8133  1 001443   200012 630500                    EPPR0   I,,AUTO
         1 001444   200047 450500                    STP0    FN+3,,AUTO
         1 001445   004717 701000 1                  TSX1    FMO$FITSPACE
         1 001446   002375 702000 1                  TSX2    FMOE$VLPERR

      522     8134    4            I=I*4;

   8134  1 001447   200012 235100                    LDA     I,,AUTO
         1 001450   000002 735000                    ALS     2
         1 001451   200012 755100                    STA     I,,AUTO

      523     8135    4            LOC$->REC=P1$->REC;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:128  
   8135  1 001452   200006 470500                    LDP0    P1$,,AUTO
         1 001453   000000 620005                    EAX0    0,AL
         1 001454   200005 471500                    LDP1    LOC$,,AUTO
         1 001455   200012 721100                    LXL1    I,,AUTO
         1 001456   040140 100540                    MLR     fill='040'O
         1 001457   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 001460   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      524     8136    4            END;

   8136  1 001461   002373 710000 1                  TRA     RETRET

      525     8137                    /**/
      526     8138    3      CASE(17); /* FPRG */

      527     8139                    /**/
      528     8140    4         IF P1$=ADDR(NIL) AND F$DCB.FPRGX~=0 THEN DO;

   8140  1 001462   200006 236100                    LDQ     P1$,,AUTO
         1 001463   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001464   001475 601000 1                  TNZ     s:8144
         1 001465   200004 470500                    LDP0    JDCB$,,AUTO
         1 001466   000054 220100                    LDX0    44,,PR0
         1 001467   001475 600000 1                  TZE     s:8144

      529     8141    4            P1$=PINCRW(B$ROSEG$,F$DCB.FPRGX);

   8141  1 001470   000000 636010                    EAQ     0,X0
         1 001471   000000 036000 xsym               ADLQ    B$ROSEG$
         1 001472   200006 756100                    STQ     P1$,,AUTO

      530     8142    4            I=SIZEW(CODE17);

   8142  1 001473   000022 235007                    LDA     18,DL
         1 001474   200012 755100                    STA     I,,AUTO

      531     8143    4            END;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:129  

      532     8144    3         GOTO ALTKFPRG;

   8144  1 001475   001440 710000 1                  TRA     ALTKFPRG

      533     8145                    /**/
      534     8146    3      CASE(15);

      535     8147                    /**/
      536     8148    3         IF F$DCB.ORG~=%CG# THEN RETURN;

   8148  1 001476   200004 470500                    LDP0    JDCB$,,AUTO
         1 001477   000032 236100                    LDQ     26,,PR0
         1 001500   777000 376003                    ANQ     -512,DU
         1 001501   013000 116003                    CMPQ    5632,DU
         1 001502   001505 600000 1                  TZE     s:8149

   8148  1 001503   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 001504   000001 702211                    TSX2  ! 1,X1

      537     8149    3         CALL FMO$FITSPACE(SIZEW(CODE15)) ALTRET(FMOE$VLPERR);

   8149  1 001505   000013 236000 2                  LDQ     11
         1 001506   200047 756100                    STQ     FN+3,,AUTO
         1 001507   004717 701000 1                  TSX1    FMO$FITSPACE
         1 001510   002375 702000 1                  TSX2    FMOE$VLPERR

      538     8150    4         IF P1$=ADDR(NIL) THEN DO;

   8150  1 001511   200006 236100                    LDQ     P1$,,AUTO
         1 001512   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001513   001534 601000 1                  TNZ     s:8156

      539     8151    4            CODE15='0'B;

   8151  1 001514   200005 470500                    LDP0    LOC$,,AUTO
         1 001515   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:130  
         1 001516   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001517   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      540     8152    4            CODE15.CGORG=F$DCB.TDA;

   8152  1 001520   200004 470500                    LDP0    JDCB$,,AUTO
         1 001521   200005 471500                    LDP1    LOC$,,AUTO
         1 001522   000070 236100                    LDQ     56,,PR0
         1 001523   000033 736000                    QLS     27
         1 001524   100000 552140                    STBQ    0,'40'O,PR1

      541     8153    4            CODE15.QISS=F$DCB.QISS;

   8153  1 001525   200005 471500                    LDP1    LOC$,,AUTO
         1 001526   000031 236100                    LDQ     25,,PR0
         1 001527   000007 772000                    QRL     7
         1 001530   100000 676100                    ERQ     0,,PR1
         1 001531   000400 376003                    ANQ     256,DU
         1 001532   100000 656100                    ERSQ    0,,PR1

      542     8154    4            END;

   8154  1 001533   002373 710000 1                  TRA     RETRET

      543     8155    3         ELSE
      544     8156    3            CODE15=P1$->CODE15;

   8156  1 001534   200006 470500                    LDP0    P1$,,AUTO
         1 001535   200005 471500                    LDP1    LOC$,,AUTO
         1 001536   000100 100500                    MLR     fill='000'O
         1 001537   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16
         1 001540   100000 000020                    ADSC9   0,,PR1                   cn=0,n=16
         1 001541   002373 710000 1                  TRA     RETRET

      545     8157                    /**/
      546     8158    3      CASE(16); /* DEVICE ATTRIBUTES */

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:131  
      547     8159                    /**/
      548     8160    3         IF F$DCB.IORG~=%UR# THEN RETURN;

   8160  1 001542   200004 470500                    LDP0    JDCB$,,AUTO
         1 001543   000070 236100                    LDQ     56,,PR0
         1 001544   077000 376003                    ANQ     32256,DU
         1 001545   004000 116003                    CMPQ    2048,DU
         1 001546   001551 600000 1                  TZE     s:8161

   8160  1 001547   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 001550   000001 702211                    TSX2  ! 1,X1

      549     8161    3         CALL     FMO$FITSPACE(SIZEW(CODE16)) ALTRET(FMOE$VLPERR);

   8161  1 001551   000021 236000 2                  LDQ     17
         1 001552   200047 756100                    STQ     FN+3,,AUTO
         1 001553   004717 701000 1                  TSX1    FMO$FITSPACE
         1 001554   002375 702000 1                  TSX2    FMOE$VLPERR

      550     8162    4         IF F$DCB.FORM$=ADDR(NIL) THEN DO;

   8162  1 001555   200004 470500                    LDP0    JDCB$,,AUTO
         1 001556   000050 236100                    LDQ     40,,PR0
         1 001557   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001560   001576 601000 1                  TNZ     s:8166

      551     8163    4            CALL FSA$GSP(SIZEW(CODE16),F$DCB.FORM$)ALTRET(RETALT);

   8163  1 001561   200004 236100                    LDQ     JDCB$,,AUTO
         1 001562   000050 036003                    ADLQ    40,DU
         1 001563   000021 235000 2                  LDA     17
         1 001564   200052 757100                    STAQ    INDX+1,,AUTO
         1 001565   200052 630500                    EPPR0   INDX+1,,AUTO
         1 001566   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001567   000000 701000 xent               TSX1    FSA$GSP
         1 001570   002463 702000 1                  TSX2    RETALT

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:132  
      552     8164    4            F$DCB.FORM$->CODE16='0'B;

   8164  1 001571   200004 470500                    LDP0    JDCB$,,AUTO
         1 001572   000050 471500                    LDP1    40,,PR0
         1 001573   000100 100400                    MLR     fill='000'O
         1 001574   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001575   100000 000234                    ADSC9   0,,PR1                   cn=0,n=156

      553     8165    4            END;

      554     8166    3         CODE16=F$DCB.FORM$->CODE16;

   8166  1 001576   000050 471500                    LDP1    40,,PR0
         1 001577   200005 473500                    LDP3    LOC$,,AUTO
         1 001600   000100 100500                    MLR     fill='000'O
         1 001601   100000 000234                    ADSC9   0,,PR1                   cn=0,n=156
         1 001602   300000 000234                    ADSC9   0,,PR3                   cn=0,n=156
         1 001603   002373 710000 1                  TRA     RETRET

      555     8167                    /**/
      556     8168    3      CASE(18);

      557     8169                    /* Remember that tape file mgmt will have IORG of consec
      558     8170                       for a tape IREL file.                              */
      559     8171    3         IF F$DCB.ORG~=%KEYED# AND F$DCB.ORG~=%INDEXED# AND

   8171  1 001604   200004 470500                    LDP0    JDCB$,,AUTO
         1 001605   000032 236100                    LDQ     26,,PR0
         1 001606   777000 376003                    ANQ     -512,DU
         1 001607   002000 116003                    CMPQ    1024,DU
         1 001610   001623 600000 1                  TZE     s:8175
         1 001611   006000 116003                    CMPQ    3072,DU
         1 001612   001623 600000 1                  TZE     s:8175
         1 001613   015000 116003                    CMPQ    6656,DU
         1 001614   001623 600000 1                  TZE     s:8175
         1 001615   001000 116003                    CMPQ    512,DU
         1 001616   001623 600000 1                  TZE     s:8175
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:133  
         1 001617   005000 116003                    CMPQ    2560,DU
         1 001620   001623 600000 1                  TZE     s:8175

      560     8172    3           F$DCB.ORG~=%IREL#  AND F$DCB.ORG~=%CONSEC#  AND
      561     8173    3           F$DCB.ORG~=%RELATIVE#
      562     8174    3         THEN RETURN;

   8174  1 001621   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 001622   000001 702211                    TSX2  ! 1,X1

      563     8175    3         IF F$DCB.ORG = %IREL# AND P1$=ADDR(NIL) AND

   8175  1 001623   015000 116003                    CMPQ    6656,DU
         1 001624   001636 601000 1                  TNZ     s:8185
         1 001625   200006 236100                    LDQ     P1$,,AUTO
         1 001626   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001627   001636 601000 1                  TNZ     s:8185
         1 001630   000054 720100                    LXL0    44,,PR0
         1 001631   001636 601000 1                  TNZ     s:8185

      564     8176    4           F$DCB.FIELDX = 0 THEN DO;

      565     8177    4            B$JIT.ERR=FMO$E$NOIREL;

   8177  1 001632   000033 236000 0                  LDQ     FMO$E$NOIREL
         1 001633   000000 471400 xsym               LDP1    B$JIT$
         1 001634   100012 756100                    STQ     10,,PR1

      566     8178                    /*E*   ERROR: FMO-E$NOIREL-E
      567     8179                           MESSAGE:VLP_RECFIELD or VLP_IRKEYS missing.
      568     8180                           MESSAGE1:A create open of an IREL file must specify both
      569     8181                                    a VLP_RECFIELD and VLP_IRKEYS.
      570     8182                    */
      571     8183    4            GOTO FMOE$VLPERR;

   8183  1 001635   002375 710000 1                  TRA     FMOE$VLPERR

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:134  
      572     8184    4            END;
      573     8185    4         IF P1$=ADDR(NIL) AND F$DCB.FIELDX>0 THEN DO;

   8185  1 001636   200006 236100                    LDQ     P1$,,AUTO
         1 001637   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001640   001666 601000 1                  TNZ     s:8192
         1 001641   000054 720100                    LXL0    44,,PR0
         1 001642   001666 600000 1                  TZE     s:8192

      574     8186    4            FIELD$=PINCRW(B$ROSEG$, F$DCB.FIELDX);

   8186  1 001643   000000 636010                    EAQ     0,X0
         1 001644   000000 036000 xsym               ADLQ    B$ROSEG$
         1 001645   200021 756100                    STQ     FIELD$,,AUTO

      575     8187    4            IF RECFIELD.NFIELDS > 511 THEN GOTO FMOE$TOOMANYF;

   8187  1 001646   200021 471500                    LDP1    FIELD$,,AUTO
         1 001647   100000 236100                    LDQ     0,,PR1
         1 001650   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 001651   001000 116007                    CMPQ    512,DL
         1 001652   002404 603000 1                  TRC     FMOE$TOOMANYF

      576     8188    4            CALL FMO$CHKRECFIELD ALTRET(RETALT);

   8188  1 001653   002564 701000 1                  TSX1    FMO$CHKRECFIELD
         1 001654   002463 702000 1                  TSX2    RETALT

      577     8189    4            P1$=FIELD$;

   8189  1 001655   200021 236100                    LDQ     FIELD$,,AUTO
         1 001656   200006 756100                    STQ     P1$,,AUTO

      578     8190    4            I=(RECFIELD.NFIELDS+1)/2 + 1;

   8190  1 001657   200021 470500                    LDP0    FIELD$,,AUTO
         1 001660   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:135  
         1 001661   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 001662   000001 036007                    ADLQ    1,DL
         1 001663   000001 772000                    QRL     1
         1 001664   000001 036007                    ADLQ    1,DL
         1 001665   200012 756100                    STQ     I,,AUTO

      579     8191    4            END;

      580     8192    3         IF F$DCB.FIELDX > 0 THEN

   8192  1 001666   200004 470500                    LDP0    JDCB$,,AUTO
         1 001667   000054 720100                    LXL0    44,,PR0
         1 001670   001674 600000 1                  TZE     s:8195

      581     8193    3            CALL FMO$FIELD_START_SETUP ALTRET(RETALT);

   8193  1 001671   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001672   000000 701000 xent               TSX1    FMO$FIELD_START_SETUP
         1 001673   002463 702000 1                  TSX2    RETALT

      582     8194
      583     8195    4         IF P1$~=ADDR(NIL) THEN DO;

   8195  1 001674   200006 236100                    LDQ     P1$,,AUTO
         1 001675   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001676   002373 600000 1                  TZE     RETRET

      584     8196    4            CALL FMO$FITSPACE(I) ALTRET(FMOE$VLPERR);

   8196  1 001677   200012 630500                    EPPR0   I,,AUTO
         1 001700   200047 450500                    STP0    FN+3,,AUTO
         1 001701   004717 701000 1                  TSX1    FMO$FITSPACE
         1 001702   002375 702000 1                  TSX2    FMOE$VLPERR

      585     8197    4            I=I*4;

   8197  1 001703   200012 235100                    LDA     I,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:136  
         1 001704   000002 735000                    ALS     2
         1 001705   200012 755100                    STA     I,,AUTO

      586     8198    4            LOC$->REC=P1$->REC;

   8198  1 001706   200006 470500                    LDP0    P1$,,AUTO
         1 001707   000000 620005                    EAX0    0,AL
         1 001710   200005 471500                    LDP1    LOC$,,AUTO
         1 001711   200012 721100                    LXL1    I,,AUTO
         1 001712   040140 100540                    MLR     fill='040'O
         1 001713   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 001714   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      587     8199    4            END;

   8199  1 001715   002373 710000 1                  TRA     RETRET

      588     8200                    /* */
      589     8201    3      CASE(19);

      590     8202    3         IF P1$=ADDR(NIL) AND F$DCB.ALTKEYX = 0 AND

   8202  1 001716   200006 236100                    LDQ     P1$,,AUTO
         1 001717   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001720   001734 601000 1                  TNZ     s:8207
         1 001721   200004 470500                    LDP0    JDCB$,,AUTO
         1 001722   000052 720100                    LXL0    42,,PR0
         1 001723   001734 601000 1                  TNZ     s:8207
         1 001724   000032 236100                    LDQ     26,,PR0
         1 001725   777000 376003                    ANQ     -512,DU
         1 001726   015000 116003                    CMPQ    6656,DU
         1 001727   001734 601000 1                  TNZ     s:8207

      591     8203    4           F$DCB.ORG=%IREL# THEN DO;

      592     8204    4            B$JIT.ERR=FMO$E$NOIREL;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:137  
   8204  1 001730   000033 236000 0                  LDQ     FMO$E$NOIREL
         1 001731   000000 471400 xsym               LDP1    B$JIT$
         1 001732   100012 756100                    STQ     10,,PR1

      593     8205    4            GOTO FMOE$VLPERR;

   8205  1 001733   002375 710000 1                  TRA     FMOE$VLPERR

      594     8206    4            END;
      595     8207    4         IF P1$=ADDR(NIL) AND F$DCB.ALTKEYX>0 AND F$DCB.ORG=%IREL# THEN DO;

   8207  1 001734   200006 236100                    LDQ     P1$,,AUTO
         1 001735   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001736   001753 601000 1                  TNZ     s:8211
         1 001737   200004 470500                    LDP0    JDCB$,,AUTO
         1 001740   000052 720100                    LXL0    42,,PR0
         1 001741   001753 600000 1                  TZE     s:8211
         1 001742   000032 236100                    LDQ     26,,PR0
         1 001743   777000 376003                    ANQ     -512,DU
         1 001744   015000 116003                    CMPQ    6656,DU
         1 001745   001753 601000 1                  TNZ     s:8211

      596     8208    4            CALL FMO$CHKIKEYS ALTRET(RETALT);

   8208  1 001746   003433 701000 1                  TSX1    FMO$CHKIKEYS
         1 001747   002463 702000 1                  TSX2    RETALT

      597     8209    4            CALL FMO$BLDIKEYS ALTRET(FMOE$VLPERR);

   8209  1 001750   004213 701000 1                  TSX1    FMO$BLDIKEYS
         1 001751   002375 702000 1                  TSX2    FMOE$VLPERR

      598     8210    4            END;

   8210  1 001752   002373 710000 1                  TRA     RETRET

      599     8211    4         ELSE IF P1$~=ADDR(NIL) AND F$DCB.ORG=%IREL# THEN DO;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:138  

   8211  1 001753   200006 236100                    LDQ     P1$,,AUTO
         1 001754   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001755   002373 600000 1                  TZE     RETRET
         1 001756   200004 470500                    LDP0    JDCB$,,AUTO
         1 001757   000032 236100                    LDQ     26,,PR0
         1 001760   777000 376003                    ANQ     -512,DU
         1 001761   015000 116003                    CMPQ    6656,DU
         1 001762   002373 601000 1                  TNZ     RETRET

      600     8212    4               CALL FMO$FITSPACE(I) ALTRET(FMOE$VLPERR);

   8212  1 001763   200012 631500                    EPPR1   I,,AUTO
         1 001764   200047 451500                    STP1    FN+3,,AUTO
         1 001765   004717 701000 1                  TSX1    FMO$FITSPACE
         1 001766   002375 702000 1                  TSX2    FMOE$VLPERR

      601     8213    4               I=I*4;

   8213  1 001767   200012 235100                    LDA     I,,AUTO
         1 001770   000002 735000                    ALS     2
         1 001771   200012 755100                    STA     I,,AUTO

      602     8214    4               LOC$->REC=P1$->REC;

   8214  1 001772   200006 470500                    LDP0    P1$,,AUTO
         1 001773   000000 620005                    EAX0    0,AL
         1 001774   200005 471500                    LDP1    LOC$,,AUTO
         1 001775   200012 721100                    LXL1    I,,AUTO
         1 001776   040140 100540                    MLR     fill='040'O
         1 001777   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 002000   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      603     8215    4               END;

   8215  1 002001   002373 710000 1                  TRA     RETRET

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:139  
      604     8216                    /* */
      605     8217    3      CASE(20);

      606     8218    4         IF P1$~=ADDR(NIL) AND F$DCB.ORG=%IREL# THEN DO;

   8218  1 002002   200006 236100                    LDQ     P1$,,AUTO
         1 002003   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002004   002373 600000 1                  TZE     RETRET
         1 002005   200004 470500                    LDP0    JDCB$,,AUTO
         1 002006   000032 236100                    LDQ     26,,PR0
         1 002007   777000 376003                    ANQ     -512,DU
         1 002010   015000 116003                    CMPQ    6656,DU
         1 002011   002373 601000 1                  TNZ     RETRET

      607     8219    4            CALL FMO$FITSPACE(I) ALTRET(FMOE$VLPERR);

   8219  1 002012   200012 631500                    EPPR1   I,,AUTO
         1 002013   200047 451500                    STP1    FN+3,,AUTO
         1 002014   004717 701000 1                  TSX1    FMO$FITSPACE
         1 002015   002375 702000 1                  TSX2    FMOE$VLPERR

      608     8220    4            I=I*4;

   8220  1 002016   200012 235100                    LDA     I,,AUTO
         1 002017   000002 735000                    ALS     2
         1 002020   200012 755100                    STA     I,,AUTO

      609     8221    4            LOC$->REC=P1$->REC;

   8221  1 002021   200006 470500                    LDP0    P1$,,AUTO
         1 002022   000000 620005                    EAX0    0,AL
         1 002023   200005 471500                    LDP1    LOC$,,AUTO
         1 002024   200012 721100                    LXL1    I,,AUTO
         1 002025   040140 100540                    MLR     fill='040'O
         1 002026   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 002027   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:140  
      610     8222    4            END;

   8222  1 002030   002373 710000 1                  TRA     RETRET

      611     8223                    /* */
      612     8224    3      CASE(21); /* Irrec - definition of logical field order */

      613     8225                    /* Remember that tape file mgmt will have IORG of consec for
      614     8226                       a tape IREL file.                                      */
      615     8227    3         IF F$DCB.ORG~=%KEYED# AND F$DCB.ORG~=%INDEXED# AND

   8227  1 002031   200004 470500                    LDP0    JDCB$,,AUTO
         1 002032   000032 236100                    LDQ     26,,PR0
         1 002033   777000 376003                    ANQ     -512,DU
         1 002034   002000 116003                    CMPQ    1024,DU
         1 002035   002050 600000 1                  TZE     s:8231
         1 002036   006000 116003                    CMPQ    3072,DU
         1 002037   002050 600000 1                  TZE     s:8231
         1 002040   015000 116003                    CMPQ    6656,DU
         1 002041   002050 600000 1                  TZE     s:8231
         1 002042   001000 116003                    CMPQ    512,DU
         1 002043   002050 600000 1                  TZE     s:8231
         1 002044   005000 116003                    CMPQ    2560,DU
         1 002045   002050 600000 1                  TZE     s:8231

      616     8228    3           F$DCB.ORG~=%IREL#  AND F$DCB.ORG~=%CONSEC#  AND
      617     8229    3           F$DCB.ORG~=%RELATIVE#
      618     8230    3         THEN RETURN;

   8230  1 002046   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002047   000001 702211                    TSX2  ! 1,X1

      619     8231    4         IF P1$=ADDR(NIL) AND F$DCB.IRRECX > 0 THEN DO;

   8231  1 002050   200006 236100                    LDQ     P1$,,AUTO
         1 002051   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002052   002121 601000 1                  TNZ     s:8245
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:141  
         1 002053   000061 220100                    LDX0    49,,PR0
         1 002054   002121 600000 1                  TZE     s:8245

      620     8232    5            IF F$DCB.FIELDX=0 THEN DO;

   8232  1 002055   000054 721100                    LXL1    44,,PR0
         1 002056   002063 601000 1                  TNZ     s:8236

      621     8233    5               B$JIT.ERR=FMO$E$NOFLD;

   8233  1 002057   000026 236000 0                  LDQ     FMO$E$NOFLD
         1 002060   000000 471400 xsym               LDP1    B$JIT$
         1 002061   100012 756100                    STQ     10,,PR1

      622     8234    5               GOTO RETALT;

   8234  1 002062   002463 710000 1                  TRA     RETALT

      623     8235    5               END;
      624     8236    4            IRREC$=PINCRW(B$ROSEG$,F$DCB.IRRECX);

   8236  1 002063   000000 636010                    EAQ     0,X0
         1 002064   000000 036000 xsym               ADLQ    B$ROSEG$
         1 002065   200023 756100                    STQ     IRREC$,,AUTO

      625     8237    4            FIELD$=PINCRW(B$ROSEG$,F$DCB.FIELDX);

   8237  1 002066   000000 636011                    EAQ     0,X1
         1 002067   000000 036000 xsym               ADLQ    B$ROSEG$
         1 002070   200021 756100                    STQ     FIELD$,,AUTO

      626     8238    4            IF IRREC.NFIELDS > 511 OR IRREC.NFIELDS > RECFIELD.NFIELDS

   8238  1 002071   200023 471500                    LDP1    IRREC$,,AUTO
         1 002072   100000 236100                    LDQ     0,,PR1
         1 002073   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 002074   001000 116007                    CMPQ    512,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:142  
         1 002075   002411 603000 1                  TRC     FMOE$TOOMANYL
         1 002076   200052 756100                    STQ     INDX+1,,AUTO
         1 002077   200021 473500                    LDP3    FIELD$,,AUTO
         1 002100   300000 236100                    LDQ     0,,PR3
         1 002101   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 002102   200052 116100                    CMPQ    INDX+1,,AUTO
         1 002103   002411 604000 1                  TMI     FMOE$TOOMANYL

      627     8239    4            THEN GOTO FMOE$TOOMANYL;
      628     8240    4            CALL FMO$CHKIRREC(IRREC$) ALTRET(FMOE$BADIFLD);

   8240  1 002104   200023 634500                    EPPR4   IRREC$,,AUTO
         1 002105   200043 454500                    STP4    CODE+6,,AUTO
         1 002106   003332 701000 1                  TSX1    FMO$CHKIRREC
         1 002107   002416 702000 1                  TSX2    FMOE$BADIFLD

      629     8241    4            P1$=IRREC$;

   8241  1 002110   200023 236100                    LDQ     IRREC$,,AUTO
         1 002111   200006 756100                    STQ     P1$,,AUTO

      630     8242    4            I=(IRREC.NFIELDS+3)/4 + 1;

   8242  1 002112   200023 470500                    LDP0    IRREC$,,AUTO
         1 002113   000000 236100                    LDQ     0,,PR0
         1 002114   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 002115   000003 036007                    ADLQ    3,DL
         1 002116   000002 772000                    QRL     2
         1 002117   000001 036007                    ADLQ    1,DL
         1 002120   200012 756100                    STQ     I,,AUTO

      631     8243    4            END;

      632     8244
      633     8245    4         IF P1$~=ADDR(NIL) THEN DO;

   8245  1 002121   200006 236100                    LDQ     P1$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:143  
         1 002122   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002123   002373 600000 1                  TZE     RETRET

      634     8246    4            CALL FMO$FITSPACE(I) ALTRET(FMOE$VLPERR);

   8246  1 002124   200012 630500                    EPPR0   I,,AUTO
         1 002125   200047 450500                    STP0    FN+3,,AUTO
         1 002126   004717 701000 1                  TSX1    FMO$FITSPACE
         1 002127   002375 702000 1                  TSX2    FMOE$VLPERR

      635     8247    4            I=I*4;

   8247  1 002130   200012 235100                    LDA     I,,AUTO
         1 002131   000002 735000                    ALS     2
         1 002132   200012 755100                    STA     I,,AUTO

      636     8248    4            LOC$->REC=P1$->REC;

   8248  1 002133   200006 470500                    LDP0    P1$,,AUTO
         1 002134   000000 620005                    EAX0    0,AL
         1 002135   200005 471500                    LDP1    LOC$,,AUTO
         1 002136   200012 721100                    LXL1    I,,AUTO
         1 002137   040140 100540                    MLR     fill='040'O
         1 002140   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 002141   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      637     8249    4            END;

   8249  1 002142   002373 710000 1                  TRA     RETRET

      638     8250                    /**/
      639     8251    3      CASE(9); /* ACCESS CONTROL LIST */

      640     8252    3         P1$=PN$.ACCESS_;

   8252  1 002143   200003 470500                    LDP0    @DUMMY,,AUTO
         1 002144   000005 236100                    LDQ     5,,PR0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:144  
         1 002145   200006 756100                    STQ     P1$,,AUTO

      641     8253    3         GOTO BLDATTR0;

   8253  1 002146   002152 710000 1                  TRA     BLDATTR0

      642     8254    3      CASE(10); /* ACCESS VEHICLE LIST */

      643     8255    3         P1$=PN$.ACSVEH_;

   8255  1 002147   200003 470500                    LDP0    @DUMMY,,AUTO
         1 002150   000006 236100                    LDQ     6,,PR0
         1 002151   200006 756100                    STQ     P1$,,AUTO

   8255  1 002152                       BLDATTR0     null
      644     8256    3   BLDATTR0:;
      645     8257    3         IF P1$~=ADDR(NIL) THEN IF NOT F$DCB.FFLG.DELF THEN GOTO FMOE$CLSREL;

   8257  1 002152   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002153   002373 600000 1                  TZE     RETRET

   8257  1 002154   200004 471500                    LDP1    JDCB$,,AUTO
         1 002155   100004 236100                    LDQ     4,,PR1
         1 002156   020000 316003                    CANQ    8192,DU
         1 002157   002460 600000 1                  TZE     FMOE$CLSREL

      646     8258                    /*E*     ERROR: FMO-E$CLSREL-E
      647     8259                   *       MESSAGE:You may not control access, or release NGAVAL%, for %FN%
      648     8260                    *        MESSAGE1:An attempt to close with RELG, ACCESS, or ACSVEH
      649     8261                    *        failed because you do not have DELF access% to %UF%
      650     8262                    */
      651     8263    3            ELSE GOTO BLDATTR;

   8263  1 002160   002233 710000 1                  TRA     BLDATTR

      652     8264    3      CASE(11); /* USER INFO           */

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:145  
      653     8265    3         P1$=PN$.UATTR_;

   8265  1 002161   200003 470500                    LDP0    @DUMMY,,AUTO
         1 002162   000007 236100                    LDQ     7,,PR0
         1 002163   200006 756100                    STQ     P1$,,AUTO

      654     8266    3         GOTO BLDATTR1;

   8266  1 002164   002222 710000 1                  TRA     BLDATTR1

      655     8267    3      CASE(12); /* INSTALLATION INFO   */

      656     8268    3         P1$=PN$.INSTATTR_;

   8268  1 002165   200003 470500                    LDP0    @DUMMY,,AUTO
         1 002166   000010 236100                    LDQ     8,,PR0
         1 002167   200006 756100                    STQ     P1$,,AUTO

      657     8269    3         GOTO BLDATTR1;

   8269  1 002170   002222 710000 1                  TRA     BLDATTR1

      658     8270    3      CASE(13); /* PROCESSOR INFO      */

      659     8271    3         P1$=PN$.PROCATTR_;

   8271  1 002171   200003 470500                    LDP0    @DUMMY,,AUTO
         1 002172   000011 236100                    LDQ     9,,PR0
         1 002173   200006 756100                    STQ     P1$,,AUTO

      660     8272    4         IF F$DCB.STARX=7 THEN DO; /* *I, PUT ASL NAME HERE */

   8272  1 002174   200004 471500                    LDP1    JDCB$,,AUTO
         1 002175   100064 236100                    LDQ     52,,PR1
         1 002176   007000 376007                    ANQ     3584,DL
         1 002177   007000 116007                    CMPQ    3584,DL
         1 002200   002222 601000 1                  TNZ     BLDATTR1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:146  

      661     8273    4            CALL FMO$FITSPACE(8)ALTRET(FMOE$VLPERR);

   8273  1 002201   000022 236000 2                  LDQ     18
         1 002202   200047 756100                    STQ     FN+3,,AUTO
         1 002203   004717 701000 1                  TSX1    FMO$FITSPACE
         1 002204   002375 702000 1                  TSX2    FMOE$VLPERR

      662     8274    4            I=32;

   8274  1 002205   000040 235007                    LDA     32,DL
         1 002206   200012 755100                    STA     I,,AUTO

      663     8275    4            LOC$->REC=ADDR(B$P$->B$P.NAME(S$CU$->B$U.ASL))->REC;

   8275  1 002207   000000 470400 xsym               LDP0    S$CU$
         1 002210   000006 236100                    LDQ     6,,PR0
         1 002211   000777 376007                    ANQ     511,DL
         1 002212   000021 402007                    MPY     17,DL
         1 002213   000003 736000                    QLS     3
         1 002214   000000 471400 xsym               LDP1    B$P$
         1 002215   200012 720100                    LXL0    I,,AUTO
         1 002216   200005 473500                    LDP3    LOC$,,AUTO
         1 002217   040140 100546                    MLR     fill='040'O
         1 002220   100032 000010                    ADSC9   26,Q,PR1                 cn=0,n=*X0
         1 002221   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0

      664     8276    4            END;

      665     8277    3   BLDATTR1: IF P1$=ADDR(NIL) THEN RETURN;

   8277  1 002222   200006 236100       BLDATTR1     LDQ     P1$,,AUTO
         1 002223   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002224   002227 601000 1                  TNZ     s:8278

   8277  1 002225   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002226   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:147  

      666     8278    3         IF NOT F$DCB.FFLG.REATTR THEN GOTO FMOE$REATTR;

   8278  1 002227   200004 470500                    LDP0    JDCB$,,AUTO
         1 002230   000004 236100                    LDQ     4,,PR0
         1 002231   004000 316003                    CANQ    2048,DU
         1 002232   002446 600000 1                  TZE     FMOE$REATTR

   8278  1 002233                       BLDATTR      null
      667     8279    3   BLDATTR:;
      668     8280    3         ADDR(I)->REC4=P1$->REC4; /* MOVE WD CNT IF FROM FPT */

   8280  1 002233   200006 470500                    LDP0    P1$,,AUTO
         1 002234   040100 100500                    MLR     fill='040'O
         1 002235   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         1 002236   200012 000004                    ADSC9   I,,AUTO                  cn=0,n=4

      669     8281    4         IF P1$=PN$.IFPARAM_ THEN DO; /* IF FROM IFPARAM, FIND THE DATA */

   8281  1 002237   200003 471500                    LDP1    @DUMMY,,AUTO
         1 002240   200006 236100                    LDQ     P1$,,AUTO
         1 002241   100013 116100                    CMPQ    11,,PR1
         1 002242   002266 601000 1                  TNZ     s:8288

      670     8282    4            I=CODE;

   8282  1 002243   200035 235100                    LDA     CODE,,AUTO
         1 002244   200012 755100                    STA     I,,AUTO

      671     8283    4            T$=P1$;

   8283  1 002245   200016 756100                    STQ     T$,,AUTO

      672     8284    4            CALL FMO$LOCCODE(XT$,I) ALTRET(FMOE$VLPERR);

   8284  1 002246   200012 633500                    EPPR3   I,,AUTO
         1 002247   200053 453500                    STP3    INDX+2,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:148  
         1 002250   200017 236100                    LDQ     T$$,,AUTO
         1 002251   200052 756100                    STQ     INDX+1,,AUTO
         1 002252   200052 630500                    EPPR0   INDX+1,,AUTO
         1 002253   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002254   000000 701000 xent               TSX1    FMO$LOCCODE
         1 002255   002375 702000 1                  TSX2    FMOE$VLPERR

      673     8285    4            P1$=T$;

   8285  1 002256   200016 236100                    LDQ     T$,,AUTO
         1 002257   200006 756100                    STQ     P1$,,AUTO

      674     8286    4            IBIT=PN$.IFPARAM_->FM$FIT.CODES(I);

   8286  1 002260   200003 470500                    LDP0    @DUMMY,,AUTO
         1 002261   000013 471500                    LDP1    11,,PR0
         1 002262   200012 720100                    LXL0    I,,AUTO
         1 002263   100000 236110                    LDQ     0,X0,PR1
         1 002264   200012 756100                    STQ     I,,AUTO

      675     8287    4            END;

   8287  1 002265   002270 710000 1                  TRA     s:8289

      676     8288    3         ELSE P1$=PINCRW(P1$,1);/* DONT MOVE SIZE WORD */

   8288  1 002266   000001 036003                    ADLQ    1,DU
         1 002267   200006 756100                    STQ     P1$,,AUTO

      677     8289    3         CALL FMO$FITSPACE(I) ALTRET(FMOE$VLPERR);

   8289  1 002270   200012 630500                    EPPR0   I,,AUTO
         1 002271   200047 450500                    STP0    FN+3,,AUTO
         1 002272   004717 701000 1                  TSX1    FMO$FITSPACE
         1 002273   002375 702000 1                  TSX2    FMOE$VLPERR

      678     8290    3         I=I*4;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:149  

   8290  1 002274   200012 235100                    LDA     I,,AUTO
         1 002275   000002 735000                    ALS     2
         1 002276   200012 755100                    STA     I,,AUTO

      679     8291    4         IF P1$PTR.SEGID<100 THEN DO; /* IF FROM PARAMETER, CHECK SIZE */

   8291  1 002277   200006 236100                    LDQ     P1$,,AUTO
         1 002300   177777 376007                    ANQ     65535,DL
         1 002301   000144 116007                    CMPQ    100,DL
         1 002302   002322 603000 1                  TRC     s:8311

      680     8292    4            K=P1$PTR.SEGID;

   8292  1 002303   200014 756100                    STQ     K,,AUTO

      681     8293    4            CALL HFF$DSIZ(K,K);

   8293  1 002304   200014 630500                    EPPR0   K,,AUTO
         1 002305   200053 450500                    STP0    INDX+2,,AUTO
         1 002306   200014 631500                    EPPR1   K,,AUTO
         1 002307   200052 451500                    STP1    INDX+1,,AUTO
         1 002310   200052 630500                    EPPR0   INDX+1,,AUTO
         1 002311   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002312   000000 701000 xent               TSX1    HFF$DSIZ
         1 002313   000000 011000                    NOP     0

      682     8294    4            IF K<P1$PTR.COFF+I THEN GOTO FMOE$PSERR;

   8294  1 002314   200006 236100                    LDQ     P1$,,AUTO
         1 002315   000020 772000                    QRL     16
         1 002316   200012 036100                    ADLQ    I,,AUTO
         1 002317   200014 116100                    CMPQ    K,,AUTO
         1 002320   002322 600000 1                  TZE     s:8311
         1 002321   002426 603000 1                  TRC     FMOE$PSERR

      683     8295                    /*E*     ERROR: FMO-E$BADVECT5-E
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:150  
      684     8296                    *        MESSAGE:Access control list inaccessible% for %UF%
      685     8297                    */
      686     8298                    /*E*     ERROR: FMO-E$BADVECT6-E
      687     8299                    *        MESSAGE:Access vehicle list inaccessible% for %UF%
      688     8300                    */
      689     8301                    /*E*     ERROR: FMO-E$BADVECT7-E
      690     8302                    *        MESSAGE:UATTR area inaccessible% for %UF%
      691     8303                    */
      692     8304                    /*E*     ERROR: FMO-E$BADVECT8-E
      693     8305                    *        MESSAGE:INSTATTR area inaccessible% for %UF%
      694     8306                    */
      695     8307                    /*E*     ERROR: FMO-E$BADVECT9-E
      696     8308                    *        MESSAGE:PROCATTR area inaccessible% for %UF%
      697     8309                    */
      698     8310    4            END;

      699     8311    3         LOC$->REC=P1$->REC; /* MOVE WITH CHAR MOVE */

   8311  1 002322   200006 470500                    LDP0    P1$,,AUTO
         1 002323   200012 720100                    LXL0    I,,AUTO
         1 002324   200005 471500                    LDP1    LOC$,,AUTO
         1 002325   040140 100540                    MLR     fill='040'O
         1 002326   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 002327   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      700     8312    4         IF CODE=9 THEN DO;

   8312  1 002330   200035 235100                    LDA     CODE,,AUTO
         1 002331   000011 115007                    CMPA    9,DL
         1 002332   002371 601000 1                  TNZ     s:8323

      701     8313    4            F$DCB.DESC.NOLIST='0'B;

   8313  1 002333   200004 470500                    LDP0    JDCB$,,AUTO
         1 002334   000023 236000 2                  LDQ     19
         1 002335   000005 356100                    ANSQ    5,,PR0

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:151  
      702     8314    5            DO WHILE (I>9);

   8314  1 002336   200012 235100                    LDA     I,,AUTO
         1 002337   000012 115007                    CMPA    10,DL
         1 002340   002361 602000 1                  TNC     s:8319

      703     8315    5               IF CODE09.FFLG.NOLIST THEN F$DCB.DESC.NOLIST='1'B;

   8315  1 002341   200005 470500                    LDP0    LOC$,,AUTO
         1 002342   000000 066500                    CMPB    filb='0'B
         1 002343   000000 050001                    BDSC    0,,PR0                   by=0,bit=5,n=1
         1 002344   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 002345   002351 600000 1                  TZE     s:8316

   8315  1 002346   200004 471500                    LDP1    JDCB$,,AUTO
         1 002347   200000 236007                    LDQ     65536,DL
         1 002350   100005 256100                    ORSQ    5,,PR1

      704     8316    5               LOC$=PINCRC(LOC$,10);

   8316  1 002351   200005 236100                    LDQ     LOC$,,AUTO
         1 002352   000024 036000 2                  ADLQ    20
         1 002353   200005 756100                    STQ     LOC$,,AUTO

      705     8317    5               I=I-10;

   8317  1 002354   200012 235100                    LDA     I,,AUTO
         1 002355   000012 135007                    SBLA    10,DL
         1 002356   200012 755100                    STA     I,,AUTO

      706     8318    5               END;

   8318  1 002357   000012 115007                    CMPA    10,DL
         1 002360   002341 603000 1                  TRC     s:8315

      707     8319    4            LOCCODX=3;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:152  
   8319  1 002361   000003 236007                    LDQ     3,DL
         1 002362   200020 756100                    STQ     LOCCODX,,AUTO

      708     8320    4            CALL LOCCODP ALTRET(RETALT);

   8320  1 002363   002543 701000 1                  TSX1    LOCCODP
         1 002364   002463 702000 1                  TSX2    RETALT

      709     8321    4            CODE03.DESC=F$DCB.DESC;

   8321  1 002365   200004 470500                    LDP0    JDCB$,,AUTO
         1 002366   000005 720100                    LXL0    5,,PR0
         1 002367   200005 471500                    LDP1    LOC$,,AUTO
         1 002370   100001 740100                    STX0    1,,PR1

      710     8322    4            END;

      711     8323    3         LOC$=FIT$;/* SET INDICATION THAT FILE IS CHANGED */

   8323  1 002371   200007 236100                    LDQ     FIT$,,AUTO
         1 002372   200005 756100                    STQ     LOC$,,AUTO

      712     8324                    /**/
      713     8325    3      END;

   8320  1 002373                       RETRET       null
      714     8326    2   RETRET:;
      715     8327    2      RETURN;

   8327  1 002373   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002374   000001 702211                    TSX2  ! 1,X1

      716     8328    2   FMOE$VLPERR: IF B$JIT.ERR='0'B THEN B$JIT.ERR=FMO$E$VLPERR;

   8328  1 002375   000000 470400 xsym  FMOE$VLPERR  LDP0    B$JIT$
         1 002376   000012 235100                    LDA     10,,PR0
         1 002377   002402 601000 1                  TNZ     s:8329
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:153  

   8328  1 002400   000013 236000 0                  LDQ     FMO$E$VLPERR
         1 002401   000012 756100                    STQ     10,,PR0

      717     8329    2      ALTRETURN;

   8329  1 002402   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002403   000000 702211                    TSX2  ! 0,X1

   8328  1 002404                       FMOE$TOOMAN* null
      718     8330                    /*E*     ERROR:   FMO-E$REATTR-E
      719     8331                    *        MESSAGE: You cannot change the attributes of %UF.
      720     8332                    */
      721     8333    2   FMOE$TOOMANYF: ;
      722     8334    2      B$JIT.ERR=FMO$E$TOOMANYF;

   8334  1 002404   000030 236000 0                  LDQ     FMO$E$TOOMANYF
         1 002405   000000 473400 xsym               LDP3    B$JIT$
         1 002406   300012 756100                    STQ     10,,PR3

      723     8335                    /*E*   ERROR:   FMO-E$TOOMANYF-E
      724     8336                           MESSAGE: VLP_RECFIELD specified more than 511 fields
      725     8337                                    %for %UF%
      726     8338                    */
      727     8339    2      ALTRETURN;

   8339  1 002407   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002410   000000 702211                    TSX2  ! 0,X1

   8334  1 002411                       FMOE$TOOMAN* null
      728     8340    2   FMOE$TOOMANYL: ;
      729     8341    2      B$JIT.ERR=FMO$E$TOOMANYL;

   8341  1 002411   000034 236000 0                  LDQ     FMO$E$TOOMANYL
         1 002412   000000 473400 xsym               LDP3    B$JIT$
         1 002413   300012 756100                    STQ     10,,PR3

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:154  
      730     8342                    /*E*  ERROR:   FMO-E$TOOMANYL-E
      731     8343                          MESSAGE: VLP_IRREC specified too many fields% for %UF%
      732     8344                          MESSAGE1: VLP_IRREC either specified more than 511
      733     8345                                    fields or more fields than were specified
      734     8346                                    in the corresponding VLP_RECFIELD or CODE18.
      735     8347                    */
      736     8348    2      ALTRETURN;

   8348  1 002414   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002415   000000 702211                    TSX2  ! 0,X1

   8341  1 002416                       FMOE$BADIFLD null
      737     8349    2   FMOE$BADIFLD:;
      738     8350    2      B$JIT.ERR=FMO$E$BADIFLD;

   8350  1 002416   000044 236000 0                  LDQ     FMO$E$BADIFLD
         1 002417   000000 470400 xsym               LDP0    B$JIT$
         1 002420   000012 756100                    STQ     10,,PR0

      739     8351    2      F$DCB.ARS=J;

   8351  1 002421   200013 235100                    LDA     J,,AUTO
         1 002422   200004 471500                    LDP1    JDCB$,,AUTO
         1 002423   100000 755100                    STA     0,,PR1

      740     8352    2      ALTRETURN;

   8352  1 002424   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002425   000000 702211                    TSX2  ! 0,X1

   8351  1 002426                       FMOE$PSERR   null
      741     8353                    /*E*  ERROR:    FMO-E$BADIFLD-E
      742     8354                          MESSAGE:  VLP_IRREC specified a bad field index% for %UF%
      743     8355                          MESSAGE1: One or more field indexes in VLP_IRREC% for %UF%
      744     8356                                    was either greater than the maximum possible
      745     8357                                    field index in the corresponding RECFIELD field
      746     8358                                    array or specified a field which is defined to
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:155  
      747     8359                                    be an element of a fixed or variable length
      748     8360                                    list.  F$DCB.ARS# contains the index into the
      749     8361                                    IRREC array of the first bad entry.
      750     8362                    */
      751     8363    2   FMOE$PSERR:;
      752     8364    2      B$JIT.ERR=FMO$E$BADVECT0;

   8364  1 002426   000020 236000 0                  LDQ     FMO$E$BADVECT0
         1 002427   000000 470400 xsym               LDP0    B$JIT$
         1 002430   000012 756100                    STQ     10,,PR0

      753     8365    2      B$JIT.ERR.CODE=B$JIT.ERR.CODE+P1$PTR.SEGID;

   8365  1 002431   200006 236100                    LDQ     P1$,,AUTO
         1 002432   177777 376007                    ANQ     65535,DL
         1 002433   200052 756100                    STQ     INDX+1,,AUTO
         1 002434   000012 236100                    LDQ     10,,PR0
         1 002435   000003 772000                    QRL     3
         1 002436   037777 376007                    ANQ     16383,DL
         1 002437   200052 036100                    ADLQ    INDX+1,,AUTO
         1 002440   000003 736000                    QLS     3
         1 002441   000012 676100                    ERQ     10,,PR0
         1 002442   377770 376007                    ANQ     131064,DL
         1 002443   000012 656100                    ERSQ    10,,PR0

      754     8366    2      ALTRETURN;

   8366  1 002444   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002445   000000 702211                    TSX2  ! 0,X1

      755     8367    2   FMOE$REATTR: B$JIT$->B$JIT.ERR=FMO$E$REATTR;

   8367  1 002446   000014 236000 0     FMOE$REATTR  LDQ     FMO$E$REATTR
         1 002447   000000 471400 xsym               LDP1    B$JIT$
         1 002450   100012 756100                    STQ     10,,PR1

      756     8368    2      ALTRETURN;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:156  

   8368  1 002451   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002452   000000 702211                    TSX2  ! 0,X1

      757     8369    2   FMOE$BADALT: B$JIT.ERR=FMO$E$BADALT;

   8369  1 002453   000021 236000 0     FMOE$BADALT  LDQ     FMO$E$BADALT
         1 002454   000000 470400 xsym               LDP0    B$JIT$
         1 002455   000012 756100                    STQ     10,,PR0

      758     8370    2      ALTRETURN;

   8370  1 002456   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002457   000000 702211                    TSX2  ! 0,X1

      759     8371                    /*E*   ERROR:   FMO-E$BADALT-E
      760     8372                           MESSAGE: Bad KEYX or KEYL% for %UF%.
      761     8373                           MESSAGE1:Either KEYX+KEYL exceeds 4000, or KEYL=0,
      762     8374                                    or KEYL > 255% for %UF%.
      763     8375                    */
      764     8376    2   FMOE$CLSREL: B$JIT.ERR=FMO$E$CLSREL;

   8376  1 002460   000017 236000 0     FMOE$CLSREL  LDQ     FMO$E$CLSREL
         1 002461   000000 473400 xsym               LDP3    B$JIT$
         1 002462   300012 756100                    STQ     10,,PR3

   8365  1 002463                       RETALT       null
      765     8377    2   RETALT:;
      766     8378    2      ALTRETURN;

   8378  1 002463   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002464   000000 702211                    TSX2  ! 0,X1

      767     8379        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:157  
      768     8380    2   MODIFIED: ENTRY ALTRET;

   8380  1 002465   200040 741300       MODIFIED     STX1  ! CODE+3,,AUTO

      769     8381    2      FM$CFU.FMOD='1'B;

   8381  1 002466   200010 470500                    LDP0    CFU$,,AUTO
         1 002467   004000 236003                    LDQ     2048,DU
         1 002470   000000 256100                    ORSQ    0,,PR0

      770     8382    2      F$DCB.BFR.BUFUP(BUFNO)='1'B;

   8382  1 002471   200004 471500                    LDP1    JDCB$,,AUTO
         1 002472   200015 720100                    LXL0    BUFNO,,AUTO
         1 002473   400000 236003                    LDQ     -131072,DU
         1 002474   100115 256110                    ORSQ    77,X0,PR1

      771     8383    2      FM$CFU.MODCNT=FM$CFU.MODCNT+1;

   8383  1 002475   000006 236100                    LDQ     6,,PR0
         1 002476   000025 772000                    QRL     21
         1 002477   000001 036007                    ADLQ    1,DL
         1 002500   000025 736000                    QLS     21
         1 002501   000006 676100                    ERQ     6,,PR0
         1 002502   777770 376003                    ANQ     -8,DU
         1 002503   000006 656100                    ERSQ    6,,PR0

      772     8384    2      RETURN;

   8384  1 002504   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002505   000001 702211                    TSX2  ! 1,X1

      773     8385    2   UPDGAC: ENTRY ALTRET;

   8385  1 002506   200040 741300       UPDGAC       STX1  ! CODE+3,,AUTO

      774     8386    2      LOCCODX=4;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:158  

   8386  1 002507   000004 235007                    LDA     4,DL
         1 002510   200020 755100                    STA     LOCCODX,,AUTO

      775     8387    2      CALL LOCCODP ALTRET(RETALT);

   8387  1 002511   002543 701000 1                  TSX1    LOCCODP
         1 002512   002463 702000 1                  TSX2    RETALT

      776     8388    3      IF FM$SET.GACTIME(F$DCB.SETX)>CODE04.GAC.TIME THEN DO;

   8388  1 002513   200004 470500                    LDP0    JDCB$,,AUTO
         1 002514   000051 236100                    LDQ     41,,PR0
         1 002515   000003 736000                    QLS     3
         1 002516   000025 376000 2                  ANQ     21
         1 002517   200005 471500                    LDP1    LOC$,,AUTO
         1 002520   000000 473400 xsym               LDP3    F$CFU$
         1 002521   000000 620006                    EAX0    0,QL
         1 002522   100012 236100                    LDQ     10,,PR1
         1 002523   300004 116110                    CMPQ    4,X0,PR3
         1 002524   002530 603000 1                  TRC     s:8392

      777     8389    3         CODE04.GAC.TIME=FM$SET.GACTIME(F$DCB.SETX);

   8389  1 002525   300004 235110                    LDA     4,X0,PR3
         1 002526   100012 755100                    STA     10,,PR1

      778     8390    3         CODE04.GAC.N=0;

   8390  1 002527   100011 450100                    STZ     9,,PR1

      779     8391    3         END;

      780     8392    2      CALL FMR$UPDGAC(CODE04.GAC,I);

   8392  1 002530   200012 634500                    EPPR4   I,,AUTO
         1 002531   200053 454500                    STP4    INDX+2,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:159  
         1 002532   200005 236100                    LDQ     LOC$,,AUTO
         1 002533   000011 036003                    ADLQ    9,DU
         1 002534   200052 756100                    STQ     INDX+1,,AUTO
         1 002535   200052 630500                    EPPR0   INDX+1,,AUTO
         1 002536   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002537   000000 701000 xent               TSX1    FMR$UPDGAC
         1 002540   000000 011000                    NOP     0

      781     8393    2      RETURN;

   8393  1 002541   200040 221300                    LDX1  ! CODE+3,,AUTO
         1 002542   000001 702211                    TSX2  ! 1,X1

      782     8394    2   END FMO$BLDCODE;
      783     8395        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:160  
      784     8396    1   LOCCODP: PROC ALTRET;

   8396  1 002543   200042 741300       LOCCODP      STX1  ! CODE+5,,AUTO

      785     8397    2      T$=FIT$;

   8397  1 002544   200007 236100                    LDQ     FIT$,,AUTO
         1 002545   200016 756100                    STQ     T$,,AUTO

      786     8398    3      CALL FMO$LOCCODP(XT$,LOCCODX) WHENRETURN DO;

   8398  1 002546   200020 630500                    EPPR0   LOCCODX,,AUTO
         1 002547   200053 450500                    STP0    INDX+2,,AUTO
         1 002550   200017 236100                    LDQ     T$$,,AUTO
         1 002551   200052 756100                    STQ     INDX+1,,AUTO
         1 002552   200052 630500                    EPPR0   INDX+1,,AUTO
         1 002553   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002554   000000 701000 xent               TSX1    FMO$LOCCODP
         1 002555   002562 702000 1                  TSX2    s:8402

      787     8399    3         LOC$=T$;

   8399  1 002556   200016 236100                    LDQ     T$,,AUTO
         1 002557   200005 756100                    STQ     LOC$,,AUTO

      788     8400    3         RETURN;

   8400  1 002560   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 002561   000001 702211                    TSX2  ! 1,X1

      789     8401    3         END;
      790     8402    2      ALTRETURN;

   8402  1 002562   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 002563   000000 702211                    TSX2  ! 0,X1

      791     8403    2   END LOCCODP;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:161  
      792     8404        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:162  
      793     8405    1   FMO$CHKRECFIELD: PROC ALTRET;

   8405  1 002564   200042 741300       FMO$CHKRECF* STX1  ! CODE+5,,AUTO

      794     8406                    /**/
      795     8407                    /* RECFIELD is based on FIELD$, which must be set up for this call.*/
      796     8408                    /**/
      797     8409
      798     8410    3      DO J=0 TO RECFIELD.NFIELDS-1;

   8410  1 002565   200013 450100                    STZ     J,,AUTO
         1 002566   003272 710000 1                  TRA     s:8498+3

      799     8411    4         DO CASE(RECFIELD.FIELD.TYPE(J));

   8411  1 002567   200013 236100                    LDQ     J,,AUTO
         1 002570   000003 402007                    MPY     3,DL
         1 002571   200021 470500                    LDP0    FIELD$,,AUTO
         1 002572   000100 101506                    MRL     fill='000'O
         1 002573   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
         1 002574   200052 020003                    ADSC6   INDX+1,,AUTO             cn=0,n=3
         1 002575   200052 220100                    LDX0    INDX+1,,AUTO
         1 002576   000072 100003                    CMPX0   58,DU
         1 002577   002601 602010 1                  TNC     s:8411+10,X0
         1 002600   003266 710000 1                  TRA     s:8495
         1 002601   002673 710000 1                  TRA     s:8414
         1 002602   003204 710000 1                  TRA     s:8470
         1 002603   003266 710000 1                  TRA     s:8495
         1 002604   003232 710000 1                  TRA     s:8479
         1 002605   003241 710000 1                  TRA     s:8483
         1 002606   003266 710000 1                  TRA     s:8495
         1 002607   003266 710000 1                  TRA     s:8495
         1 002610   003266 710000 1                  TRA     s:8495
         1 002611   003266 710000 1                  TRA     s:8495
         1 002612   003146 710000 1                  TRA     s:8455
         1 002613   003250 710000 1                  TRA     s:8487
         1 002614   003266 710000 1                  TRA     s:8495
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:163  
         1 002615   003266 710000 1                  TRA     s:8495
         1 002616   003266 710000 1                  TRA     s:8495
         1 002617   003266 710000 1                  TRA     s:8495
         1 002620   003266 710000 1                  TRA     s:8495
         1 002621   003266 710000 1                  TRA     s:8495
         1 002622   003266 710000 1                  TRA     s:8495
         1 002623   003266 710000 1                  TRA     s:8495
         1 002624   003266 710000 1                  TRA     s:8495
         1 002625   003266 710000 1                  TRA     s:8495
         1 002626   002673 710000 1                  TRA     s:8414
         1 002627   003267 710000 1                  TRA     s:8498
         1 002630   003266 710000 1                  TRA     s:8495
         1 002631   003204 710000 1                  TRA     s:8470
         1 002632   003146 710000 1                  TRA     s:8455
         1 002633   003266 710000 1                  TRA     s:8495
         1 002634   003266 710000 1                  TRA     s:8495
         1 002635   003266 710000 1                  TRA     s:8495
         1 002636   003266 710000 1                  TRA     s:8495
         1 002637   003266 710000 1                  TRA     s:8495
         1 002640   003146 710000 1                  TRA     s:8455
         1 002641   003266 710000 1                  TRA     s:8495
         1 002642   003266 710000 1                  TRA     s:8495
         1 002643   003266 710000 1                  TRA     s:8495
         1 002644   003266 710000 1                  TRA     s:8495
         1 002645   003266 710000 1                  TRA     s:8495
         1 002646   003266 710000 1                  TRA     s:8495
         1 002647   003266 710000 1                  TRA     s:8495
         1 002650   003266 710000 1                  TRA     s:8495
         1 002651   003155 710000 1                  TRA     s:8460
         1 002652   003155 710000 1                  TRA     s:8460
         1 002653   003146 710000 1                  TRA     s:8455
         1 002654   003146 710000 1                  TRA     s:8455
         1 002655   003155 710000 1                  TRA     s:8460
         1 002656   003155 710000 1                  TRA     s:8460
         1 002657   003266 710000 1                  TRA     s:8495
         1 002660   002673 710000 1                  TRA     s:8414
         1 002661   002760 710000 1                  TRA     s:8431
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:164  
         1 002662   003266 710000 1                  TRA     s:8495
         1 002663   003257 710000 1                  TRA     s:8491
         1 002664   003146 710000 1                  TRA     s:8455
         1 002665   003266 710000 1                  TRA     s:8495
         1 002666   003266 710000 1                  TRA     s:8495
         1 002667   003164 710000 1                  TRA     s:8464
         1 002670   003223 710000 1                  TRA     s:8475
         1 002671   003267 710000 1                  TRA     s:8498
         1 002672   003164 710000 1                  TRA     s:8464

      800     8412
      801     8413    4         CASE(%NO_DATATYPE, %CHAR_DATATYPE, %LIST_DATATYPE);

      802     8414    4            IF RECFIELD.FIELD.LEN(J) < 1 THEN

   8414  1 002673   000100 101506                    MRL     fill='000'O
         1 002674   000001 120002                    ADSC6   1,Q,PR0                  cn=1,n=2
         1 002675   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 002676   200052 236100                    LDQ     INDX+1,,AUTO
         1 002677   000000 116003                    CMPQ    0,DU
         1 002700   003302 600000 1                  TZE     FMOE$BADLEN

      803     8415    4               GOTO FMOE$BADLEN;
      804     8416    5            IF RECFIELD.FIELD.TYPE(J)=%LIST_DATATYPE THEN DO;

   8416  1 002701   200013 236100                    LDQ     J,,AUTO
         1 002702   000003 402007                    MPY     3,DL
         1 002703   000100 101506                    MRL     fill='000'O
         1 002704   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
         1 002705   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 002706   200052 236100                    LDQ     INDX+1,,AUTO
         1 002707   000057 116007                    CMPQ    47,DL
         1 002710   003267 601000 1                  TNZ     s:8498

      805     8417    5               IF J=RECFIELD.NFIELDS-1 THEN /* Last field */

   8417  1 002711   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:165  
         1 002712   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 002713   000001 136007                    SBLQ    1,DL
         1 002714   002717 604000 1                  TMI     s:8419
         1 002715   200013 116100                    CMPQ    J,,AUTO
         1 002716   003316 600000 1                  TZE     FMOE$BADARRAY

      806     8418    5                  GOTO FMOE$BADARRAY;
      807     8419    5               IF RECFIELD.FIELD.TYPE(J+1)=%LIST_DATATYPE OR

   8419  1 002717   200013 236100                    LDQ     J,,AUTO
         1 002720   000003 402007                    MPY     3,DL
         1 002721   000100 101506                    MRL     fill='000'O
         1 002722   000001 320001                    ADSC6   1,Q,PR0                  cn=3,n=1
         1 002723   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 002724   200052 236100                    LDQ     INDX+1,,AUTO
         1 002725   000057 116007                    CMPQ    47,DL
         1 002726   003316 600000 1                  TZE     FMOE$BADARRAY
         1 002727   200013 236100                    LDQ     J,,AUTO
         1 002730   000003 402007                    MPY     3,DL
         1 002731   000100 101506                    MRL     fill='000'O
         1 002732   000001 320001                    ADSC6   1,Q,PR0                  cn=3,n=1
         1 002733   200053 020006                    ADSC6   INDX+2,,AUTO             cn=0,n=6
         1 002734   200053 236100                    LDQ     INDX+2,,AUTO
         1 002735   000060 116007                    CMPQ    48,DL
         1 002736   003316 600000 1                  TZE     FMOE$BADARRAY
         1 002737   200013 236100                    LDQ     J,,AUTO
         1 002740   000003 402007                    MPY     3,DL
         1 002741   000100 101506                    MRL     fill='000'O
         1 002742   000001 320001                    ADSC6   1,Q,PR0                  cn=3,n=1
         1 002743   200054 020006                    ADSC6   INDX+3,,AUTO             cn=0,n=6
         1 002744   200054 236100                    LDQ     INDX+3,,AUTO
         1 002745   000026 116007                    CMPQ    22,DL
         1 002746   003316 600000 1                  TZE     FMOE$BADARRAY
         1 002747   200013 236100                    LDQ     J,,AUTO
         1 002750   000003 402007                    MPY     3,DL
         1 002751   000100 101506                    MRL     fill='000'O
         1 002752   000001 320001                    ADSC6   1,Q,PR0                  cn=3,n=1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:166  
         1 002753   200055 020006                    ADSC6   INDX+4,,AUTO             cn=0,n=6
         1 002754   200055 236100                    LDQ     INDX+4,,AUTO
         1 002755   000070 116007                    CMPQ    56,DL
         1 002756   003316 600000 1                  TZE     FMOE$BADARRAY

      808     8420    5                 RECFIELD.FIELD.TYPE(J+1)=%VLIST_DATATYPE OR
      809     8421    5                 RECFIELD.FIELD.TYPE(J+1)=%TEXTC_DATATYPE  OR
      810     8422    5                 RECFIELD.FIELD.TYPE(J+1)=%TEXTH_DATATYPE THEN
      811     8423    5                  GOTO FMOE$BADARRAY;
      812     8424    5               END;

   8424  1 002757   003267 710000 1                  TRA     s:8498

      813     8425
      814     8426    4         CASE(%TEXTC_DATATYPE, %TEXTH_DATATYPE);

      815     8427                    /* No length checks are meaningful here, but need to
      816     8428                       verify legal data type.                           */
      817     8429
      818     8430    4         CASE(%VLIST_DATATYPE);

      819     8431    4            IF J=RECFIELD.NFIELDS-1 THEN

   8431  1 002760   000000 236100                    LDQ     0,,PR0
         1 002761   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 002762   000001 136007                    SBLQ    1,DL
         1 002763   002766 604000 1                  TMI     s:8433
         1 002764   200013 116100                    CMPQ    J,,AUTO
         1 002765   003316 600000 1                  TZE     FMOE$BADARRAY

      820     8432    4               GOTO FMOE$BADARRAY;
      821     8433    4            IF RECFIELD.FIELD.TYPE(J+1)=%LIST_DATATYPE OR

   8433  1 002766   200013 236100                    LDQ     J,,AUTO
         1 002767   000003 402007                    MPY     3,DL
         1 002770   000100 101506                    MRL     fill='000'O
         1 002771   000001 320001                    ADSC6   1,Q,PR0                  cn=3,n=1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:167  
         1 002772   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 002773   200052 236100                    LDQ     INDX+1,,AUTO
         1 002774   000057 116007                    CMPQ    47,DL
         1 002775   003316 600000 1                  TZE     FMOE$BADARRAY
         1 002776   200013 236100                    LDQ     J,,AUTO
         1 002777   000003 402007                    MPY     3,DL
         1 003000   000100 101506                    MRL     fill='000'O
         1 003001   000001 320001                    ADSC6   1,Q,PR0                  cn=3,n=1
         1 003002   200053 020006                    ADSC6   INDX+2,,AUTO             cn=0,n=6
         1 003003   200053 236100                    LDQ     INDX+2,,AUTO
         1 003004   000060 116007                    CMPQ    48,DL
         1 003005   003316 600000 1                  TZE     FMOE$BADARRAY
         1 003006   200013 236100                    LDQ     J,,AUTO
         1 003007   000003 402007                    MPY     3,DL
         1 003010   000100 101506                    MRL     fill='000'O
         1 003011   000001 320001                    ADSC6   1,Q,PR0                  cn=3,n=1
         1 003012   200054 020006                    ADSC6   INDX+3,,AUTO             cn=0,n=6
         1 003013   200054 236100                    LDQ     INDX+3,,AUTO
         1 003014   000026 116007                    CMPQ    22,DL
         1 003015   003316 600000 1                  TZE     FMOE$BADARRAY
         1 003016   200013 236100                    LDQ     J,,AUTO
         1 003017   000003 402007                    MPY     3,DL
         1 003020   000100 101506                    MRL     fill='000'O
         1 003021   000001 320001                    ADSC6   1,Q,PR0                  cn=3,n=1
         1 003022   200055 020006                    ADSC6   INDX+4,,AUTO             cn=0,n=6
         1 003023   200055 236100                    LDQ     INDX+4,,AUTO
         1 003024   000070 116007                    CMPQ    56,DL
         1 003025   003316 600000 1                  TZE     FMOE$BADARRAY

      822     8434    4              RECFIELD.FIELD.TYPE(J+1)=%VLIST_DATATYPE OR
      823     8435    4              RECFIELD.FIELD.TYPE(J+1)=%TEXTC_DATATYPE OR
      824     8436    4              RECFIELD.FIELD.TYPE(J+1)=%TEXTH_DATATYPE THEN
      825     8437    4               GOTO FMOE$BADARRAY;
      826     8438    4            IF RECFIELD.FIELD.LEN(J) >= J THEN

   8438  1 003026   200013 236100                    LDQ     J,,AUTO
         1 003027   000003 402007                    MPY     3,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:168  
         1 003030   000100 101506                    MRL     fill='000'O
         1 003031   000001 120002                    ADSC6   1,Q,PR0                  cn=1,n=2
         1 003032   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003033   200052 236100                    LDQ     INDX+1,,AUTO
         1 003034   200013 116100                    CMPQ    J,,AUTO
         1 003035   003322 603000 1                  TRC     FMOE$BADCNTFLD

      827     8439    4               GOTO FMOE$BADCNTFLD;
      828     8440    4            K=RECFIELD.FIELD.LEN(J);

   8440  1 003036   200013 236100                    LDQ     J,,AUTO
         1 003037   000003 402007                    MPY     3,DL
         1 003040   000100 101506                    MRL     fill='000'O
         1 003041   000001 120002                    ADSC6   1,Q,PR0                  cn=1,n=2
         1 003042   200014 020006                    ADSC6   K,,AUTO                  cn=0,n=6

      829     8441    4            IF K > 0 THEN

   8441  1 003043   200014 235100                    LDA     K,,AUTO
         1 003044   003065 600000 1                  TZE     s:8445

      830     8442    4               IF RECFIELD.FIELD.TYPE(K-1)=%LIST_DATATYPE OR

   8442  1 003045   200014 236100                    LDQ     K,,AUTO
         1 003046   000003 402007                    MPY     3,DL
         1 003047   000100 101506                    MRL     fill='000'O
         1 003050   000000 320001                    ADSC6   0,Q,PR0                  cn=3,n=1
         1 003051   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003052   200052 236100                    LDQ     INDX+1,,AUTO
         1 003053   000057 116007                    CMPQ    47,DL
         1 003054   003322 600000 1                  TZE     FMOE$BADCNTFLD
         1 003055   200014 236100                    LDQ     K,,AUTO
         1 003056   000003 402007                    MPY     3,DL
         1 003057   000100 101506                    MRL     fill='000'O
         1 003060   000000 320001                    ADSC6   0,Q,PR0                  cn=3,n=1
         1 003061   200053 020006                    ADSC6   INDX+2,,AUTO             cn=0,n=6
         1 003062   200053 236100                    LDQ     INDX+2,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:169  
         1 003063   000060 116007                    CMPQ    48,DL
         1 003064   003322 600000 1                  TZE     FMOE$BADCNTFLD

      831     8443    4                 RECFIELD.FIELD.TYPE(K-1)=%VLIST_DATATYPE THEN
      832     8444    4                  GOTO FMOE$BADCNTFLD;
      833     8445    4            IF RECFIELD.FIELD.TYPE(K)=%NO_DATATYPE OR

   8445  1 003065   200014 236100                    LDQ     K,,AUTO
         1 003066   000003 402007                    MPY     3,DL
         1 003067   000100 101506                    MRL     fill='000'O
         1 003070   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
         1 003071   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003072   200052 236100                    LDQ     INDX+1,,AUTO
         1 003073   000000 116003                    CMPQ    0,DU
         1 003074   003322 600000 1                  TZE     FMOE$BADCNTFLD
         1 003075   200014 236100                    LDQ     K,,AUTO
         1 003076   000003 402007                    MPY     3,DL
         1 003077   000100 101506                    MRL     fill='000'O
         1 003100   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
         1 003101   200053 020006                    ADSC6   INDX+2,,AUTO             cn=0,n=6
         1 003102   200053 236100                    LDQ     INDX+2,,AUTO
         1 003103   000057 116007                    CMPQ    47,DL
         1 003104   003322 600000 1                  TZE     FMOE$BADCNTFLD
         1 003105   200014 236100                    LDQ     K,,AUTO
         1 003106   000003 402007                    MPY     3,DL
         1 003107   000100 101506                    MRL     fill='000'O
         1 003110   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
         1 003111   200054 020006                    ADSC6   INDX+3,,AUTO             cn=0,n=6
         1 003112   200054 236100                    LDQ     INDX+3,,AUTO
         1 003113   000060 116007                    CMPQ    48,DL
         1 003114   003322 600000 1                  TZE     FMOE$BADCNTFLD
         1 003115   200014 236100                    LDQ     K,,AUTO
         1 003116   000003 402007                    MPY     3,DL
         1 003117   000100 101506                    MRL     fill='000'O
         1 003120   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
         1 003121   200055 020006                    ADSC6   INDX+4,,AUTO             cn=0,n=6
         1 003122   200055 236100                    LDQ     INDX+4,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:170  
         1 003123   000066 116007                    CMPQ    54,DL
         1 003124   003322 600000 1                  TZE     FMOE$BADCNTFLD
         1 003125   200014 236100                    LDQ     K,,AUTO
         1 003126   000003 402007                    MPY     3,DL
         1 003127   000100 101506                    MRL     fill='000'O
         1 003130   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
         1 003131   200056 020006                    ADSC6   INDX+5,,AUTO             cn=0,n=6
         1 003132   200056 236100                    LDQ     INDX+5,,AUTO
         1 003133   000071 116007                    CMPQ    57,DL
         1 003134   003322 600000 1                  TZE     FMOE$BADCNTFLD
         1 003135   200014 236100                    LDQ     K,,AUTO
         1 003136   000003 402007                    MPY     3,DL
         1 003137   000100 101506                    MRL     fill='000'O
         1 003140   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
         1 003141   200057 020006                    ADSC6   INDX+6,,AUTO             cn=0,n=6
         1 003142   200057 236100                    LDQ     INDX+6,,AUTO
         1 003143   000067 116007                    CMPQ    55,DL
         1 003144   003322 600000 1                  TZE     FMOE$BADCNTFLD
         1 003145   003267 710000 1                  TRA     s:8498

      834     8446    4              RECFIELD.FIELD.TYPE(K)=%LIST_DATATYPE OR
      835     8447    4              RECFIELD.FIELD.TYPE(K)=%VLIST_DATATYPE OR
      836     8448    4              RECFIELD.FIELD.TYPE(K)=%DATE_DATATYPE OR
      837     8449    4              RECFIELD.FIELD.TYPE(K)=%TIME_DATATYPE OR
      838     8450    4              RECFIELD.FIELD.TYPE(K)=%UTS_DATATYPE THEN
      839     8451    4               GOTO FMOE$BADCNTFLD;
      840     8452
      841     8453    4         CASE(%PDLA_DATATYPE, %PDTA_DATATYPE, %UDLS_DATATYPE,

      842     8454    4                 %UDTS_DATATYPE, %PDLE_DATATYPE, %PDTE_DATATYPE);
      843     8455    4            IF RECFIELD.DECFIELD.LEN(J) < 2 THEN

   8455  1 003146   000100 101506                    MRL     fill='000'O
         1 003147   000001 120001                    ADSC6   1,Q,PR0                  cn=1,n=1
         1 003150   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003151   200052 236100                    LDQ     INDX+1,,AUTO
         1 003152   000002 116007                    CMPQ    2,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:171  
         1 003153   003302 604000 1                  TMI     FMOE$BADLEN
         1 003154   003267 710000 1                  TRA     s:8498

      844     8456    4               GOTO FMOE$BADLEN;
      845     8457
      846     8458    4         CASE(%PDNS_DATATYPE, %UDNS_DATATYPE, %UDLO_DATATYPE,

      847     8459    4                 %UDTO_DATATYPE);
      848     8460    4            IF RECFIELD.DECFIELD.LEN(J) < 1 THEN

   8460  1 003155   000100 101506                    MRL     fill='000'O
         1 003156   000001 120001                    ADSC6   1,Q,PR0                  cn=1,n=1
         1 003157   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003160   200052 236100                    LDQ     INDX+1,,AUTO
         1 003161   000000 116003                    CMPQ    0,DU
         1 003162   003302 600000 1                  TZE     FMOE$BADLEN
         1 003163   003267 710000 1                  TRA     s:8498

      849     8461    4               GOTO FMOE$BADLEN;
      850     8462
      851     8463    4         CASE(%DATE_DATATYPE, %TIME_DATATYPE);

      852     8464    4            IF RECFIELD.DECFIELD.LEN(J)~=16 THEN

   8464  1 003164   000100 101506                    MRL     fill='000'O
         1 003165   000001 120001                    ADSC6   1,Q,PR0                  cn=1,n=1
         1 003166   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003167   200052 236100                    LDQ     INDX+1,,AUTO
         1 003170   000020 116007                    CMPQ    16,DL
         1 003171   003302 601000 1                  TNZ     FMOE$BADLEN

      853     8465    4               GOTO FMOE$BADLEN;
      854     8466    4            IF RECFIELD.DECFIELD.SCALE(J)~=0 THEN

   8466  1 003172   200013 236100                    LDQ     J,,AUTO
         1 003173   000003 402007                    MPY     3,DL
         1 003174   000100 100506                    MLR     fill='000'O
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:172  
         1 003175   000001 220001                    ADSC6   1,Q,PR0                  cn=2,n=1
         1 003176   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003177   200052 236100                    LDQ     INDX+1,,AUTO
         1 003200   000036 732000                    QRS     30
         1 003201   000000 116003                    CMPQ    0,DU
         1 003202   003306 601000 1                  TNZ     FMOE$BADSCALE
         1 003203   003267 710000 1                  TRA     s:8498

      855     8467    4               GOTO FMOE$BADSCALE;
      856     8468
      857     8469    4         CASE(%SBIN_DATATYPE, %UBIN_DATATYPE);

      858     8470    4            IF RECFIELD.FIELD.LEN(J) < 1 OR

   8470  1 003204   000100 101506                    MRL     fill='000'O
         1 003205   000001 120002                    ADSC6   1,Q,PR0                  cn=1,n=2
         1 003206   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003207   200052 236100                    LDQ     INDX+1,,AUTO
         1 003210   000000 116003                    CMPQ    0,DU
         1 003211   003302 600000 1                  TZE     FMOE$BADLEN
         1 003212   200013 236100                    LDQ     J,,AUTO
         1 003213   000003 402007                    MPY     3,DL
         1 003214   000100 101506                    MRL     fill='000'O
         1 003215   000001 120002                    ADSC6   1,Q,PR0                  cn=1,n=2
         1 003216   200053 020006                    ADSC6   INDX+2,,AUTO             cn=0,n=6
         1 003217   200053 236100                    LDQ     INDX+2,,AUTO
         1 003220   000045 116007                    CMPQ    37,DL
         1 003221   003302 605000 1                  TPL     FMOE$BADLEN
         1 003222   003267 710000 1                  TRA     s:8498

      859     8471    4              RECFIELD.FIELD.LEN(J) > 36 THEN
      860     8472    4               GOTO FMOE$BADLEN;
      861     8473
      862     8474    4         CASE(%UTS_DATATYPE);

      863     8475    4            IF RECFIELD.FIELD.LEN(J)~=36 THEN

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:173  
   8475  1 003223   000100 101506                    MRL     fill='000'O
         1 003224   000001 120002                    ADSC6   1,Q,PR0                  cn=1,n=2
         1 003225   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003226   200052 236100                    LDQ     INDX+1,,AUTO
         1 003227   000044 116007                    CMPQ    36,DL
         1 003230   003302 601000 1                  TNZ     FMOE$BADLEN
         1 003231   003267 710000 1                  TRA     s:8498

      864     8476    4               GOTO FMOE$BADLEN;
      865     8477
      866     8478    4         CASE(%SFLT_DATATYPE);

      867     8479    4            IF RECFIELD.FIELD.LEN(J)~=4 THEN

   8479  1 003232   000100 101506                    MRL     fill='000'O
         1 003233   000001 120002                    ADSC6   1,Q,PR0                  cn=1,n=2
         1 003234   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003235   200052 236100                    LDQ     INDX+1,,AUTO
         1 003236   000004 116007                    CMPQ    4,DL
         1 003237   003302 601000 1                  TNZ     FMOE$BADLEN
         1 003240   003267 710000 1                  TRA     s:8498

      868     8480    4               GOTO FMOE$BADLEN;
      869     8481
      870     8482    4         CASE(%DFLT_DATATYPE);

      871     8483    4            IF RECFIELD.FIELD.LEN(J)~=8 THEN

   8483  1 003241   000100 101506                    MRL     fill='000'O
         1 003242   000001 120002                    ADSC6   1,Q,PR0                  cn=1,n=2
         1 003243   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003244   200052 236100                    LDQ     INDX+1,,AUTO
         1 003245   000010 116007                    CMPQ    8,DL
         1 003246   003302 601000 1                  TNZ     FMOE$BADLEN
         1 003247   003267 710000 1                  TRA     s:8498

      872     8484    4               GOTO FMOE$BADLEN;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:174  
      873     8485
      874     8486    4         CASE(%PDFLT_DATATYPE);

      875     8487    4            IF RECFIELD.DECFIELD.LEN(J) < 4 THEN

   8487  1 003250   000100 101506                    MRL     fill='000'O
         1 003251   000001 120001                    ADSC6   1,Q,PR0                  cn=1,n=1
         1 003252   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003253   200052 236100                    LDQ     INDX+1,,AUTO
         1 003254   000004 116007                    CMPQ    4,DL
         1 003255   003302 604000 1                  TMI     FMOE$BADLEN
         1 003256   003267 710000 1                  TRA     s:8498

      876     8488    4               GOTO FMOE$BADLEN;
      877     8489
      878     8490    4         CASE(%UDFLT_DATATYPE);

      879     8491    4            IF RECFIELD.DECFIELD.LEN(J) < 3 THEN

   8491  1 003257   000100 101506                    MRL     fill='000'O
         1 003260   000001 120001                    ADSC6   1,Q,PR0                  cn=1,n=1
         1 003261   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003262   200052 236100                    LDQ     INDX+1,,AUTO
         1 003263   000003 116007                    CMPQ    3,DL
         1 003264   003302 604000 1                  TMI     FMOE$BADLEN
         1 003265   003267 710000 1                  TRA     s:8498

      880     8492    4               GOTO FMOE$BADLEN;
      881     8493
      882     8494    4         CASE(ELSE);

      883     8495    4            GOTO FMOE$BADFLDTYPE;

   8495  1 003266   003312 710000 1                  TRA     FMOE$BADFLDTYPE

      884     8496
      885     8497    4         END;  /* CASE */
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:175  

      886     8498    3         END;  /* DO J */

   8498  1 003267   200013 235100                    LDA     J,,AUTO
         1 003270   000001 035007                    ADLA    1,DL
         1 003271   200013 755100                    STA     J,,AUTO
         1 003272   200021 470500                    LDP0    FIELD$,,AUTO
         1 003273   000000 236100                    LDQ     0,,PR0
         1 003274   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003275   200013 116100                    CMPQ    J,,AUTO
         1 003276   003300 600000 1                  TZE     s:8500
         1 003277   002567 603000 1                  TRC     s:8411

      887     8499
      888     8500    2      RETURN;

   8500  1 003300   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 003301   000001 702211                    TSX2  ! 1,X1

   8491  1 003302                       FMOE$BADLEN  null
      889     8501
      890     8502    2   FMOE$BADLEN:;
      891     8503    2      B$JIT.ERR=FMO$E$BADLEN;

   8503  1 003302   000022 236000 0                  LDQ     FMO$E$BADLEN
         1 003303   000000 471400 xsym               LDP1    B$JIT$
         1 003304   100012 756100                    STQ     10,,PR1

      892     8504    2      GOTO RECALT;

   8504  1 003305   003325 710000 1                  TRA     RECALT

   8503  1 003306                       FMOE$BADSCA* null
      893     8505                    /*E*  ERROR:    FMO-E$BADLEN-E
      894     8506                          MESSAGE:  Illegal field length in field definition% for %UF%
      895     8507                          MESSAGE1: One or more field definitions% for %UF% has an
      896     8508                                    illegal length. F$DCB.ARS# contains the index
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:176  
      897     8509                                    into the RECFIELD field array of the first bad
      898     8510                                    field.
      899     8511                    */
      900     8512    2   FMOE$BADSCALE:;
      901     8513    2      B$JIT.ERR=FMO$E$BADSCALE;

   8513  1 003306   000035 236000 0                  LDQ     FMO$E$BADSCALE
         1 003307   000000 471400 xsym               LDP1    B$JIT$
         1 003310   100012 756100                    STQ     10,,PR1

      902     8514    2      GOTO RECALT;

   8514  1 003311   003325 710000 1                  TRA     RECALT

   8513  1 003312                       FMOE$BADFLD* null
      903     8515                    /*E*  ERROR:    FMO-E$BADSCALE-E
      904     8516                          MESSAGE:  Illegal scale value in field definition% for %UF%
      905     8517                          MESSAGE1: One or more field definitions% for %UF% has an
      906     8518                                    illegal scale value. F$DCB.ARS# contains the
      907     8519                                    index into the RECFIELD field array of the first
      908     8520                                    bad field.
      909     8521                    */
      910     8522    2   FMOE$BADFLDTYPE:;
      911     8523    2      B$JIT.ERR=FMO$E$BADFLDTYPE;

   8523  1 003312   000036 236000 0                  LDQ     FMO$E$BADFLDTYPE
         1 003313   000000 471400 xsym               LDP1    B$JIT$
         1 003314   100012 756100                    STQ     10,,PR1

      912     8524    2      GOTO RECALT;

   8524  1 003315   003325 710000 1                  TRA     RECALT

   8523  1 003316                       FMOE$BADARR* null
      913     8525                    /*E*  ERROR:    FMO-E$BADFLDTYPE-E
      914     8526                          MESSAGE:  Illegal data type in field definition% for %UF%
      915     8527                          MESSAGE1: One or more field definitions% for %UF% has an
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:177  
      916     8528                                    illegal data type. F$DCB.ARS# contains the index
      917     8529                                    into the RECFIELD field array of the first bad
      918     8530                                    field.
      919     8531                    */
      920     8532    2   FMOE$BADARRAY:;
      921     8533    2      B$JIT.ERR=FMO$E$BADARRAY;

   8533  1 003316   000037 236000 0                  LDQ     FMO$E$BADARRAY
         1 003317   000000 471400 xsym               LDP1    B$JIT$
         1 003320   100012 756100                    STQ     10,,PR1

      922     8534    2      GOTO RECALT;

   8534  1 003321   003325 710000 1                  TRA     RECALT

   8533  1 003322                       FMOE$BADCNT* null
      923     8535                    /*E*  ERROR:    FMO-E$BADARRAY-E
      924     8536                          MESSAGE:  Bad list field in field definition% for %UF%
      925     8537                          MESSAGE1: One or more LIST or VLIST fields% in %UF%
      926     8538                                    are illegally defined. The field may not be the
      927     8539                                    last defined field or may not have elements of
      928     8540                                    type TEXTC, TEXTH, LIST, or VLIST.
      929     8541                                    F$DCB.ARS# contains the index into the RECFIELD
      930     8542                                    field array of the first bad list field.
      931     8543                    */
      932     8544    2   FMOE$BADCNTFLD:;
      933     8545    2      B$JIT.ERR=FMO$E$BADCNTFLD;

   8545  1 003322   000043 236000 0                  LDQ     FMO$E$BADCNTFLD
         1 003323   000000 471400 xsym               LDP1    B$JIT$
         1 003324   100012 756100                    STQ     10,,PR1

   8545  1 003325                       RECALT       null
      934     8546                    /*E*  ERROR:    FMO-E$BADCNTFLD-E
      935     8547                          MESSAGE:  Bad count field for VLIST% in %UF%
      936     8548                          MESSAGE1: One or more VLIST fields% in %UF%
      937     8549                                    has a bad count field. A count field must
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:178  
      938     8550                                    precede the VLIST field, may not be a
      939     8551                                    list element, and may not have a type of NO,
      940     8552                                    DATE, TIME, UTS, LIST, or VLIST.
      941     8553                                    F$DCB.ARS# contains the index into the RECFIELD
      942     8554                                    field array of the first bad VLIST field.
      943     8555                    */
      944     8556    2   RECALT:;
      945     8557    2      F$DCB.ARS=J;

   8557  1 003325   200013 235100                    LDA     J,,AUTO
         1 003326   200004 470500                    LDP0    JDCB$,,AUTO
         1 003327   000000 755100                    STA     0,,PR0

      946     8558    2      ALTRETURN;

   8558  1 003330   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 003331   000000 702211                    TSX2  ! 0,X1

      947     8559
      948     8560    2   END FMO$CHKRECFIELD;
      949     8561        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:179  
      950     8562    1   FMO$CHKIRREC: PROC(IR$) ALTRET;

   8562  1 003332   200042 741300       FMO$CHKIRREC STX1  ! CODE+5,,AUTO

      951     8563                    /**/
      952     8564                    /* An IRREC structure may not have more elements than its associated
      953     8565                       RECFIELD structure, although it may have fewer. An IRREC element
      954     8566                       must contain a possible index into the associated RECFIELD
      955     8567                       structure, but this index may not reference a field which defines
      956     8568                       a list element. These checks are done only for the convenience of
      957     8569                       processors like ARGENT.                                        */
      958     8570                    /**/
      959     8571    2   DCL IR$ PTR;
      960     8572                    /**/
      961     8573    2      FIELD$=PINCRW(B$ROSEG$,F$DCB.FIELDX);

   8573  1 003333   200004 470500                    LDP0    JDCB$,,AUTO
         1 003334   000054 720100                    LXL0    44,,PR0
         1 003335   000000 636010                    EAQ     0,X0
         1 003336   000000 036000 xsym               ADLQ    B$ROSEG$
         1 003337   200021 756100                    STQ     FIELD$,,AUTO

      962     8574    2      IF IR$->IRREC.NFIELDS > RECFIELD.NFIELDS THEN

   8574  1 003340   200043 471500                    LDP1    @IR$,,AUTO
         1 003341   100000 473500                    LDP3    0,,PR1
         1 003342   300000 236100                    LDQ     0,,PR3
         1 003343   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003344   200052 756100                    STQ     INDX+1,,AUTO
         1 003345   200021 473500                    LDP3    FIELD$,,AUTO
         1 003346   300000 236100                    LDQ     0,,PR3
         1 003347   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003350   200052 116100                    CMPQ    INDX+1,,AUTO
         1 003351   003353 605000 1                  TPL     s:8577

      963     8575    2         ALTRETURN;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:180  
   8575  1 003352   000000 702211                    TSX2  ! 0,X1

      964     8576
      965     8577    3      DO J=0 TO IR$->IRREC.NFIELDS-1;

   8577  1 003353   200013 450100                    STZ     J,,AUTO
         1 003354   003422 710000 1                  TRA     s:8585+3

      966     8578    3         K=IR$->IRREC.FIELDN(J);

   8578  1 003355   200043 470500                    LDP0    @IR$,,AUTO
         1 003356   000000 471500                    LDP1    0,,PR0
         1 003357   200013 235100                    LDA     J,,AUTO
         1 003360   000100 101505                    MRL     fill='000'O
         1 003361   100001 000001                    ADSC9   1,A,PR1                  cn=0,n=1
         1 003362   200014 000004                    ADSC9   K,,AUTO                  cn=0,n=4

      967     8579    3         IF K > RECFIELD.NFIELDS-1 THEN

   8579  1 003363   200021 471500                    LDP1    FIELD$,,AUTO
         1 003364   100000 236100                    LDQ     0,,PR1
         1 003365   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003366   200014 116100                    CMPQ    K,,AUTO
         1 003367   003371 600000 1                  TZE     s:8580
         1 003370   003373 603000 1                  TRC     s:8581

      968     8580    3            ALTRETURN;

   8580  1 003371   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 003372   000000 702211                    TSX2  ! 0,X1

      969     8581    3         IF K > 0 THEN

   8581  1 003373   200014 235100                    LDA     K,,AUTO
         1 003374   003417 600000 1                  TZE     s:8585

      970     8582    3            IF RECFIELD.FIELD.TYPE(K-1)=%LIST_DATATYPE OR
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:181  

   8582  1 003375   200014 236100                    LDQ     K,,AUTO
         1 003376   000003 402007                    MPY     3,DL
         1 003377   000100 101506                    MRL     fill='000'O
         1 003400   100000 320001                    ADSC6   0,Q,PR1                  cn=3,n=1
         1 003401   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003402   200052 236100                    LDQ     INDX+1,,AUTO
         1 003403   000057 116007                    CMPQ    47,DL
         1 003404   003415 600000 1                  TZE     s:8584
         1 003405   200014 236100                    LDQ     K,,AUTO
         1 003406   000003 402007                    MPY     3,DL
         1 003407   000100 101506                    MRL     fill='000'O
         1 003410   100000 320001                    ADSC6   0,Q,PR1                  cn=3,n=1
         1 003411   200053 020006                    ADSC6   INDX+2,,AUTO             cn=0,n=6
         1 003412   200053 236100                    LDQ     INDX+2,,AUTO
         1 003413   000060 116007                    CMPQ    48,DL
         1 003414   003417 601000 1                  TNZ     s:8585

      971     8583    3              RECFIELD.FIELD.TYPE(K-1)=%VLIST_DATATYPE THEN
      972     8584    3               ALTRETURN;

   8584  1 003415   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 003416   000000 702211                    TSX2  ! 0,X1

      973     8585    3         END;

   8585  1 003417   200013 235100                    LDA     J,,AUTO
         1 003420   000001 035007                    ADLA    1,DL
         1 003421   200013 755100                    STA     J,,AUTO
         1 003422   200043 470500                    LDP0    @IR$,,AUTO
         1 003423   000000 471500                    LDP1    0,,PR0
         1 003424   100000 236100                    LDQ     0,,PR1
         1 003425   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003426   200013 116100                    CMPQ    J,,AUTO
         1 003427   003431 600000 1                  TZE     s:8587
         1 003430   003355 603000 1                  TRC     s:8578

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:182  
      974     8586
      975     8587    2      RETURN;

   8587  1 003431   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 003432   000001 702211                    TSX2  ! 1,X1

      976     8588    2   END FMO$CHKIRREC;
      977     8589        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:183  
      978     8590    1   FMO$CHKIKEYS: PROC ALTRET;

   8590  1 003433   200042 741300       FMO$CHKIKEYS STX1  ! CODE+5,,AUTO

      979     8591                    /**/
      980     8592    2   DCL VAR_FIELD_INDX UBIN;
      981     8593    2   DCL TOT_NIBS UBIN;
      982     8594                    /**/
      983     8595
      984     8596    2      IF F$DCB.FIELDX=0 THEN

   8596  1 003434   200004 470500                    LDP0    JDCB$,,AUTO
         1 003435   000054 720100                    LXL0    44,,PR0
         1 003436   004136 600000 1                  TZE     FMOE$NOFLD

      985     8597    2         GOTO FMOE$NOFLD;
      986     8598    2      FIELD$=PINCRW(B$ROSEG$, F$DCB.FIELDX);

   8598  1 003437   000000 636010                    EAQ     0,X0
         1 003440   000000 036000 xsym               ADLQ    B$ROSEG$
         1 003441   200021 756100                    STQ     FIELD$,,AUTO

      987     8599    2      ALTKEY$=PINCRW(B$ROSEG$, F$DCB.ALTKEYX);

   8599  1 003442   000052 722100                    LXL2    42,,PR0
         1 003443   000000 636012                    EAQ     0,X2
         1 003444   000000 036000 xsym               ADLQ    B$ROSEG$
         1 003445   200025 756100                    STQ     ALTKEY$,,AUTO

      988     8600    2      KFIELD$=PINCRW(B$ROSEG$, F$DCB.KFIELDX);

   8600  1 003446   000056 723100                    LXL3    46,,PR0
         1 003447   000000 636013                    EAQ     0,X3
         1 003450   000000 036000 xsym               ADLQ    B$ROSEG$
         1 003451   200024 756100                    STQ     KFIELD$,,AUTO

      989     8601    2      START$=PINCRW(B$ROSEG$, F$DCB.STARTX);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:184  

   8601  1 003452   000057 224100                    LDX4    47,,PR0
         1 003453   000000 636014                    EAQ     0,X4
         1 003454   000000 036000 xsym               ADLQ    B$ROSEG$
         1 003455   200022 756100                    STQ     START$,,AUTO

      990     8602    2      VAR_FIELD_INDX=RECFIELD.NFIELDS+1;

   8602  1 003456   200021 471500                    LDP1    FIELD$,,AUTO
         1 003457   100000 236100                    LDQ     0,,PR1
         1 003460   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003461   000001 036007                    ADLQ    1,DL
         1 003462   200043 756100                    STQ     VAR_FIELD_INDX,,AUTO

      991     8603    2   FIND_VAR:
      992     8604    3      DO I=0 TO RECFIELD.NFIELDS-1;

   8604  1 003463   200012 450100       FIND_VAR     STZ     I,,AUTO
         1 003464   003524 710000 1                  TRA     s:8612+3

      993     8605    3         IF RECFIELD.FIELD.TYPE(I)=%TEXTC_DATATYPE OR

   8605  1 003465   200012 236100                    LDQ     I,,AUTO
         1 003466   000003 402007                    MPY     3,DL
         1 003467   200021 470500                    LDP0    FIELD$,,AUTO
         1 003470   000100 101506                    MRL     fill='000'O
         1 003471   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
         1 003472   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003473   200052 236100                    LDQ     INDX+1,,AUTO
         1 003474   000026 116007                    CMPQ    22,DL
         1 003475   003516 600000 1                  TZE     s:8609
         1 003476   200012 236100                    LDQ     I,,AUTO
         1 003477   000003 402007                    MPY     3,DL
         1 003500   000100 101506                    MRL     fill='000'O
         1 003501   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
         1 003502   200053 020006                    ADSC6   INDX+2,,AUTO             cn=0,n=6
         1 003503   200053 236100                    LDQ     INDX+2,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:185  
         1 003504   000070 116007                    CMPQ    56,DL
         1 003505   003516 600000 1                  TZE     s:8609
         1 003506   200012 236100                    LDQ     I,,AUTO
         1 003507   000003 402007                    MPY     3,DL
         1 003510   000100 101506                    MRL     fill='000'O
         1 003511   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
         1 003512   200054 020006                    ADSC6   INDX+3,,AUTO             cn=0,n=6
         1 003513   200054 236100                    LDQ     INDX+3,,AUTO
         1 003514   000060 116007                    CMPQ    48,DL
         1 003515   003521 601000 1                  TNZ     s:8612

      994     8606    3           RECFIELD.FIELD.TYPE(I)=%TEXTH_DATATYPE OR
      995     8607    3           RECFIELD.FIELD.TYPE(I)=%VLIST_DATATYPE
      996     8608    4         THEN DO;

      997     8609    4            VAR_FIELD_INDX=I;

   8609  1 003516   200012 235100                    LDA     I,,AUTO
         1 003517   200043 755100                    STA     VAR_FIELD_INDX,,AUTO

      998     8610    4            EXIT FIND_VAR;

   8610  1 003520   003532 710000 1                  TRA     s:8613

      999     8611    4            END;
     1000     8612    3         END;

   8612  1 003521   200012 235100                    LDA     I,,AUTO
         1 003522   000001 035007                    ADLA    1,DL
         1 003523   200012 755100                    STA     I,,AUTO
         1 003524   200021 470500                    LDP0    FIELD$,,AUTO
         1 003525   000000 236100                    LDQ     0,,PR0
         1 003526   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003527   200012 116100                    CMPQ    I,,AUTO
         1 003530   003532 600000 1                  TZE     s:8613
         1 003531   003465 603000 1                  TRC     s:8605

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:186  
     1001     8613    3      DO I=0 TO IRKEYS.NKEYS-1;

   8613  1 003532   200012 450100                    STZ     I,,AUTO
         1 003533   004116 710000 1                  TRA     s:8671+3

     1002     8614    3         TFLEN=0;

   8614  1 003534   200027 450100                    STZ     TFLEN,,AUTO

     1003     8615    3         DO J=IRKEYS.K.FIRSTFIELD(I) TO

   8615  1 003535   200012 236100                    LDQ     I,,AUTO
         1 003536   000007 402007                    MPY     7,DL
         1 003537   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 003540   000004 236106                    LDQ     4,QL,PR0
         1 003541   000022 772000                    QRL     18
         1 003542   200013 756100                    STQ     J,,AUTO
         1 003543   004072 710000 1                  TRA     s:8668+3

     1004     8616    4           IRKEYS.K.FIRSTFIELD(I)+IRKEYS.K.NFIELDS(I)-1;
     1005     8617    4            K=KFIELD.FIELD(J);

   8617  1 003544   200024 470500                    LDP0    KFIELD$,,AUTO
         1 003545   200013 235100                    LDA     J,,AUTO
         1 003546   000100 101505                    MRL     fill='000'O
         1 003547   000002 000001                    ADSC9   2,A,PR0                  cn=0,n=1
         1 003550   200014 000004                    ADSC9   K,,AUTO                  cn=0,n=4

     1006     8618    4            IF K > RECFIELD.NFIELDS THEN

   8618  1 003551   200021 471500                    LDP1    FIELD$,,AUTO
         1 003552   100000 236100                    LDQ     0,,PR1
         1 003553   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 003554   200014 116100                    CMPQ    K,,AUTO
         1 003555   004143 602000 1                  TNC     FMOE$BADIKEY

     1007     8619    4               GOTO FMOE$BADIKEY;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:187  
     1008     8620    4            IF K > VAR_FIELD_INDX THEN

   8620  1 003556   200043 236100                    LDQ     VAR_FIELD_INDX,,AUTO
         1 003557   200014 116100                    CMPQ    K,,AUTO
         1 003560   004173 602000 1                  TNC     FMOE$BADSTART

     1009     8621    4               GOTO FMOE$BADSTART;
     1010     8622    4            IF K~=0 THEN

   8622  1 003561   200014 235100                    LDA     K,,AUTO
         1 003562   003603 600000 1                  TZE     s:8627

     1011     8623    4               IF RECFIELD.FIELD.TYPE(K-1)=%LIST_DATATYPE OR

   8623  1 003563   200014 236100                    LDQ     K,,AUTO
         1 003564   000003 402007                    MPY     3,DL
         1 003565   000100 101506                    MRL     fill='000'O
         1 003566   100000 320001                    ADSC6   0,Q,PR1                  cn=3,n=1
         1 003567   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003570   200052 236100                    LDQ     INDX+1,,AUTO
         1 003571   000057 116007                    CMPQ    47,DL
         1 003572   004126 600000 1                  TZE     FMOE$BADFTYPE
         1 003573   200014 236100                    LDQ     K,,AUTO
         1 003574   000003 402007                    MPY     3,DL
         1 003575   000100 101506                    MRL     fill='000'O
         1 003576   100000 320001                    ADSC6   0,Q,PR1                  cn=3,n=1
         1 003577   200053 020006                    ADSC6   INDX+2,,AUTO             cn=0,n=6
         1 003600   200053 236100                    LDQ     INDX+2,,AUTO
         1 003601   000060 116007                    CMPQ    48,DL
         1 003602   004126 600000 1                  TZE     FMOE$BADFTYPE

     1012     8624    4                 RECFIELD.FIELD.TYPE(K-1)=%VLIST_DATATYPE THEN
     1013     8625    4                  GOTO FMOE$BADFTYPE;
     1014     8626
     1015     8627    5            DO CASE(RECFIELD.FIELD.TYPE(K));

   8627  1 003603   200014 236100                    LDQ     K,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:188  
         1 003604   000003 402007                    MPY     3,DL
         1 003605   000100 101506                    MRL     fill='000'O
         1 003606   100001 020001                    ADSC6   1,Q,PR1                  cn=0,n=1
         1 003607   200052 020003                    ADSC6   INDX+1,,AUTO             cn=0,n=3
         1 003610   200052 220100                    LDX0    INDX+1,,AUTO
         1 003611   000072 100003                    CMPX0   58,DU
         1 003612   003614 602010 1                  TNC     s:8627+9,X0
         1 003613   004066 710000 1                  TRA     s:8665
         1 003614   003706 710000 1                  TRA     s:8630
         1 003615   003707 710000 1                  TRA     s:8632
         1 003616   004066 710000 1                  TRA     s:8665
         1 003617   003753 710000 1                  TRA     s:8641
         1 003620   003753 710000 1                  TRA     s:8641
         1 003621   004066 710000 1                  TRA     s:8665
         1 003622   004066 710000 1                  TRA     s:8665
         1 003623   004066 710000 1                  TRA     s:8665
         1 003624   004066 710000 1                  TRA     s:8665
         1 003625   004021 710000 1                  TRA     s:8656
         1 003626   004021 710000 1                  TRA     s:8656
         1 003627   004066 710000 1                  TRA     s:8665
         1 003630   004066 710000 1                  TRA     s:8665
         1 003631   004066 710000 1                  TRA     s:8665
         1 003632   004066 710000 1                  TRA     s:8665
         1 003633   004066 710000 1                  TRA     s:8665
         1 003634   004066 710000 1                  TRA     s:8665
         1 003635   004066 710000 1                  TRA     s:8665
         1 003636   004066 710000 1                  TRA     s:8665
         1 003637   004066 710000 1                  TRA     s:8665
         1 003640   004066 710000 1                  TRA     s:8665
         1 003641   003753 710000 1                  TRA     s:8641
         1 003642   003706 710000 1                  TRA     s:8630
         1 003643   004066 710000 1                  TRA     s:8665
         1 003644   003707 710000 1                  TRA     s:8632
         1 003645   004021 710000 1                  TRA     s:8656
         1 003646   004066 710000 1                  TRA     s:8665
         1 003647   004066 710000 1                  TRA     s:8665
         1 003650   004066 710000 1                  TRA     s:8665
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:189  
         1 003651   004066 710000 1                  TRA     s:8665
         1 003652   004066 710000 1                  TRA     s:8665
         1 003653   004021 710000 1                  TRA     s:8656
         1 003654   004066 710000 1                  TRA     s:8665
         1 003655   004066 710000 1                  TRA     s:8665
         1 003656   004066 710000 1                  TRA     s:8665
         1 003657   004066 710000 1                  TRA     s:8665
         1 003660   004066 710000 1                  TRA     s:8665
         1 003661   004066 710000 1                  TRA     s:8665
         1 003662   004066 710000 1                  TRA     s:8665
         1 003663   004066 710000 1                  TRA     s:8665
         1 003664   004021 710000 1                  TRA     s:8656
         1 003665   003776 710000 1                  TRA     s:8648
         1 003666   003776 710000 1                  TRA     s:8648
         1 003667   003776 710000 1                  TRA     s:8648
         1 003670   003776 710000 1                  TRA     s:8648
         1 003671   003776 710000 1                  TRA     s:8648
         1 003672   004066 710000 1                  TRA     s:8665
         1 003673   003706 710000 1                  TRA     s:8630
         1 003674   003706 710000 1                  TRA     s:8630
         1 003675   004066 710000 1                  TRA     s:8665
         1 003676   003776 710000 1                  TRA     s:8648
         1 003677   004021 710000 1                  TRA     s:8656
         1 003700   004066 710000 1                  TRA     s:8665
         1 003701   004066 710000 1                  TRA     s:8665
         1 003702   004021 710000 1                  TRA     s:8656
         1 003703   003707 710000 1                  TRA     s:8632
         1 003704   003706 710000 1                  TRA     s:8630
         1 003705   004021 710000 1                  TRA     s:8656

     1016     8628    5            CASE(%NO_DATATYPE, %TEXTC_DATATYPE, %TEXTH_DATATYPE,

     1017     8629    5              %LIST_DATATYPE, %VLIST_DATATYPE);
     1018     8630    5               GOTO FMOE$BADFTYPE;

   8630  1 003706   004126 710000 1                  TRA     FMOE$BADFTYPE

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:190  
     1019     8631    5            CASE(%SBIN_DATATYPE, %UBIN_DATATYPE, %UTS_DATATYPE);

     1020     8632    5               IF MOD(FIELD_START.OFFSET(K),9)~=0 OR

   8632  1 003707   200022 473500                    LDP3    START$,,AUTO
         1 003710   200014 721100                    LXL1    K,,AUTO
         1 003711   300001 236111                    LDQ     1,X1,PR3
         1 003712   000011 506007                    DIV     9,DL
         1 003713   000044 733000                    LRS     36
         1 003714   000000 116003                    CMPQ    0,DU
         1 003715   004203 601000 1                  TNZ     FMOE$BADALIGN
         1 003716   200014 236100                    LDQ     K,,AUTO
         1 003717   000003 402007                    MPY     3,DL
         1 003720   000100 101506                    MRL     fill='000'O
         1 003721   100001 120002                    ADSC6   1,Q,PR1                  cn=1,n=2
         1 003722   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003723   200052 236100                    LDQ     INDX+1,,AUTO
         1 003724   000011 506007                    DIV     9,DL
         1 003725   000044 733000                    LRS     36
         1 003726   000000 116003                    CMPQ    0,DU
         1 003727   004203 601000 1                  TNZ     FMOE$BADALIGN

     1021     8633    5                 MOD(RECFIELD.FIELD.LEN(K),9)~=0 THEN
     1022     8634    5                  GOTO FMOE$BADALIGN;
     1023     8635    5               IF FIELD_START.OFFSET(K)+RECFIELD.FIELD.LEN(K) >

   8635  1 003730   200014 236100                    LDQ     K,,AUTO
         1 003731   000003 402007                    MPY     3,DL
         1 003732   000100 101506                    MRL     fill='000'O
         1 003733   100001 120002                    ADSC6   1,Q,PR1                  cn=1,n=2
         1 003734   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003735   200052 236100                    LDQ     INDX+1,,AUTO
         1 003736   300001 036111                    ADLQ    1,X1,PR3
         1 003737   106240 116007                    CMPQ    36000,DL
         1 003740   004153 605400 1                  TPNZ    FMOE$BADKEYLEN

     1024     8636    5                 %FMG_KEYLEN_MAX*9
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:191  
     1025     8637    5               THEN GOTO FMOE$BADKEYLEN;
     1026     8638    5               TFLEN=TFLEN+RECFIELD.FIELD.LEN(K)/9;

   8638  1 003741   200014 236100                    LDQ     K,,AUTO
         1 003742   000003 402007                    MPY     3,DL
         1 003743   000100 101506                    MRL     fill='000'O
         1 003744   100001 120002                    ADSC6   1,Q,PR1                  cn=1,n=2
         1 003745   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003746   200052 236100                    LDQ     INDX+1,,AUTO
         1 003747   000011 506007                    DIV     9,DL
         1 003750   200027 036100                    ADLQ    TFLEN,,AUTO
         1 003751   200027 756100                    STQ     TFLEN,,AUTO
         1 003752   004067 710000 1                  TRA     s:8668

     1027     8639
     1028     8640    5            CASE(%SFLT_DATATYPE, %CHAR_DATATYPE, %DFLT_DATATYPE);

     1029     8641    5               IF FIELD_START.OFFSET(K)+(RECFIELD.FIELD.LEN(K)*9) >

   8641  1 003753   200022 473500                    LDP3    START$,,AUTO
         1 003754   200014 721100                    LXL1    K,,AUTO
         1 003755   000100 101506                    MRL     fill='000'O
         1 003756   100001 120002                    ADSC6   1,Q,PR1                  cn=1,n=2
         1 003757   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003760   200052 236100                    LDQ     INDX+1,,AUTO
         1 003761   000011 402007                    MPY     9,DL
         1 003762   300001 036111                    ADLQ    1,X1,PR3
         1 003763   106240 116007                    CMPQ    36000,DL
         1 003764   004153 605400 1                  TPNZ    FMOE$BADKEYLEN

     1030     8642    5                 %FMG_KEYLEN_MAX*9
     1031     8643    5               THEN GOTO FMOE$BADKEYLEN;
     1032     8644    5               TFLEN=TFLEN+RECFIELD.FIELD.LEN(K);

   8644  1 003765   200014 236100                    LDQ     K,,AUTO
         1 003766   000003 402007                    MPY     3,DL
         1 003767   000100 101506                    MRL     fill='000'O
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:192  
         1 003770   100001 120002                    ADSC6   1,Q,PR1                  cn=1,n=2
         1 003771   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 003772   200052 236100                    LDQ     INDX+1,,AUTO
         1 003773   200027 036100                    ADLQ    TFLEN,,AUTO
         1 003774   200027 756100                    STQ     TFLEN,,AUTO
         1 003775   004067 710000 1                  TRA     s:8668

     1033     8645
     1034     8646    5            CASE(%UDNS_DATATYPE, %UDLS_DATATYPE, %UDTS_DATATYPE,

     1035     8647    5                 %UDLO_DATATYPE, %UDTO_DATATYPE, %UDFLT_DATATYPE);
     1036     8648    5               IF FIELD_START.OFFSET(K)+(RECFIELD.DECFIELD.LEN(K)*9) >

   8648  1 003776   200022 473500                    LDP3    START$,,AUTO
         1 003777   200014 721100                    LXL1    K,,AUTO
         1 004000   000100 101506                    MRL     fill='000'O
         1 004001   100001 120001                    ADSC6   1,Q,PR1                  cn=1,n=1
         1 004002   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 004003   200052 236100                    LDQ     INDX+1,,AUTO
         1 004004   000011 402007                    MPY     9,DL
         1 004005   300001 036111                    ADLQ    1,X1,PR3
         1 004006   106240 116007                    CMPQ    36000,DL
         1 004007   004153 605400 1                  TPNZ    FMOE$BADKEYLEN

     1037     8649    5                 %FMG_KEYLEN_MAX*9
     1038     8650    5               THEN GOTO FMOE$BADKEYLEN;
     1039     8651    5               TFLEN=TFLEN+RECFIELD.DECFIELD.LEN(K);

   8651  1 004010   200014 236100                    LDQ     K,,AUTO
         1 004011   000003 402007                    MPY     3,DL
         1 004012   000100 101506                    MRL     fill='000'O
         1 004013   100001 120001                    ADSC6   1,Q,PR1                  cn=1,n=1
         1 004014   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 004015   200052 236100                    LDQ     INDX+1,,AUTO
         1 004016   200027 036100                    ADLQ    TFLEN,,AUTO
         1 004017   200027 756100                    STQ     TFLEN,,AUTO
         1 004020   004067 710000 1                  TRA     s:8668
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:193  

     1040     8652
     1041     8653    5            CASE(%PDLA_DATATYPE, %PDTA_DATATYPE, %PDLE_DATATYPE,

     1042     8654    5                 %PDTE_DATATYPE, %PDNS_DATATYPE, %PDFLT_DATATYPE,
     1043     8655    5                 %DATE_DATATYPE, %TIME_DATATYPE);
     1044     8656    5               IF MOD(FIELD_START.OFFSET(K),9)=0 THEN

   8656  1 004021   200022 473500                    LDP3    START$,,AUTO
         1 004022   200014 721100                    LXL1    K,,AUTO
         1 004023   300001 236111                    LDQ     1,X1,PR3
         1 004024   000011 506007                    DIV     9,DL
         1 004025   000044 733000                    LRS     36
         1 004026   000000 116003                    CMPQ    0,DU
         1 004027   004035 601000 1                  TNZ     s:8658

     1045     8657    5                  TOT_NIBS=(FIELD_START.OFFSET(K)/9)*2;

   8657  1 004030   300001 236111                    LDQ     1,X1,PR3
         1 004031   000011 506007                    DIV     9,DL
         1 004032   000001 736000                    QLS     1
         1 004033   200044 756100                    STQ     TOT_NIBS,,AUTO
         1 004034   004042 710000 1                  TRA     s:8659

     1046     8658    5               ELSE TOT_NIBS=(FIELD_START.OFFSET(K)/9)*2 + 1;

   8658  1 004035   300001 236111                    LDQ     1,X1,PR3
         1 004036   000011 506007                    DIV     9,DL
         1 004037   000001 736000                    QLS     1
         1 004040   000001 036007                    ADLQ    1,DL
         1 004041   200044 756100                    STQ     TOT_NIBS,,AUTO

     1047     8659    5               IF TOT_NIBS+RECFIELD.DECFIELD.LEN(K) >

   8659  1 004042   200014 236100                    LDQ     K,,AUTO
         1 004043   000003 402007                    MPY     3,DL
         1 004044   000100 101506                    MRL     fill='000'O
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:194  
         1 004045   100001 120001                    ADSC6   1,Q,PR1                  cn=1,n=1
         1 004046   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 004047   200052 236100                    LDQ     INDX+1,,AUTO
         1 004050   200044 036100                    ADLQ    TOT_NIBS,,AUTO
         1 004051   017501 116007                    CMPQ    8001,DL
         1 004052   004153 603000 1                  TRC     FMOE$BADKEYLEN

     1048     8660    5                 %FMG_KEYLEN_MAX*2
     1049     8661    5               THEN GOTO FMOE$BADKEYLEN;
     1050     8662    5               TFLEN=TFLEN+(RECFIELD.DECFIELD.LEN(K)+1)/2;

   8662  1 004053   200014 236100                    LDQ     K,,AUTO
         1 004054   000003 402007                    MPY     3,DL
         1 004055   000100 101506                    MRL     fill='000'O
         1 004056   100001 120001                    ADSC6   1,Q,PR1                  cn=1,n=1
         1 004057   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 004060   200052 236100                    LDQ     INDX+1,,AUTO
         1 004061   000001 036007                    ADLQ    1,DL
         1 004062   000001 772000                    QRL     1
         1 004063   200027 036100                    ADLQ    TFLEN,,AUTO
         1 004064   200027 756100                    STQ     TFLEN,,AUTO
         1 004065   004067 710000 1                  TRA     s:8668

     1051     8663
     1052     8664    5            CASE(ELSE);

     1053     8665    5               GOTO FMOE$BADFTYPE;

   8665  1 004066   004126 710000 1                  TRA     FMOE$BADFTYPE

     1054     8666
     1055     8667    5            END; /* Do Case */

     1056     8668    4            END; /* Do J */

   8668  1 004067   200013 235100                    LDA     J,,AUTO
         1 004070   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:195  
         1 004071   200013 755100                    STA     J,,AUTO
         1 004072   200012 236100                    LDQ     I,,AUTO
         1 004073   000007 402007                    MPY     7,DL
         1 004074   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004075   000004 236106                    LDQ     4,QL,PR0
         1 004076   777777 376007                    ANQ     -1,DL
         1 004077   200052 756100                    STQ     INDX+1,,AUTO
         1 004100   200012 236100                    LDQ     I,,AUTO
         1 004101   000007 402007                    MPY     7,DL
         1 004102   000004 236106                    LDQ     4,QL,PR0
         1 004103   000022 772000                    QRL     18
         1 004104   200052 036100                    ADLQ    INDX+1,,AUTO
         1 004105   200013 116100                    CMPQ    J,,AUTO
         1 004106   004110 600000 1                  TZE     s:8669
         1 004107   003544 603000 1                  TRC     s:8617

     1057     8669    3         IF TFLEN > 511 THEN

   8669  1 004110   200027 235100                    LDA     TFLEN,,AUTO
         1 004111   000777 115007                    CMPA    511,DL
         1 004112   004163 605400 1                  TPNZ    FMOE$BIGKEY

     1058     8670    3            GOTO FMOE$BIGKEY;
     1059     8671    3         END;  /* Do I */

   8671  1 004113   200012 236100                    LDQ     I,,AUTO
         1 004114   000001 036007                    ADLQ    1,DL
         1 004115   200012 756100                    STQ     I,,AUTO
         1 004116   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004117   000000 236100                    LDQ     0,,PR0
         1 004120   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 004121   200012 116100                    CMPQ    I,,AUTO
         1 004122   004124 600000 1                  TZE     s:8673
         1 004123   003534 603000 1                  TRC     s:8614

     1060     8672
     1061     8673    2      RETURN;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:196  

   8673  1 004124   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 004125   000001 702211                    TSX2  ! 1,X1

   8662  1 004126                       FMOE$BADFTY* null
     1062     8674    2   FMOE$BADFTYPE: ;
     1063     8675    2      B$JIT.ERR=FMO$E$BADFTYPE;

   8675  1 004126   000023 236000 0                  LDQ     FMO$E$BADFTYPE
         1 004127   000000 473400 xsym               LDP3    B$JIT$
         1 004130   300012 756100                    STQ     10,,PR3

     1064     8676    2      F$DCB.ARS=I;

   8676  1 004131   200012 235100                    LDA     I,,AUTO
         1 004132   200004 471500                    LDP1    JDCB$,,AUTO
         1 004133   100000 755100                    STA     0,,PR1

     1065     8677    2      ALTRETURN;

   8677  1 004134   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 004135   000000 702211                    TSX2  ! 0,X1

   8676  1 004136                       FMOE$NOFLD   null
     1066     8678                    /*E*   ERROR:   FMO-E$BADFTYPE-E
     1067     8679                           MESSAGE:Bad field type for IREL key% in %UF%
     1068     8680                           MESSAGE1:An IREL key% in %UF% uses a field
     1069     8681                                    which either has a type illegal for a key
     1070     8682                                    field or defines the elements of a LIST.
     1071     8683                                    F$DCB.ARS# contains the key number of the
     1072     8684                                    bad key (INDX - 1).
     1073     8685                    */
     1074     8686    2   FMOE$NOFLD: ;
     1075     8687    2      B$JIT.ERR=FMO$E$NOFLD;

   8687  1 004136   000026 236000 0                  LDQ     FMO$E$NOFLD
         1 004137   000000 471400 xsym               LDP1    B$JIT$
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:197  
         1 004140   100012 756100                    STQ     10,,PR1

     1076     8688    2      ALTRETURN;

   8688  1 004141   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 004142   000000 702211                    TSX2  ! 0,X1

   8687  1 004143                       FMOE$BADIKEY null
     1077     8689                    /*E*   ERROR:   FMO-E$NOFLD-E
     1078     8690                           MESSAGE:No fields defined% for %UF%.
     1079     8691                           MESSAGE1:IREL files or files specifying VLP_IRREC
     1080     8692                                    must specify field definitions. See
     1081     8693                                    VLP_RECFIELD %for %UF%.
     1082     8694                    */
     1083     8695    2   FMOE$BADIKEY: ;
     1084     8696    2      B$JIT.ERR=FMO$E$BADIKEY;

   8696  1 004143   000024 236000 0                  LDQ     FMO$E$BADIKEY
         1 004144   000000 473400 xsym               LDP3    B$JIT$
         1 004145   300012 756100                    STQ     10,,PR3

     1085     8697    2      F$DCB.ARS=I;

   8697  1 004146   200012 235100                    LDA     I,,AUTO
         1 004147   200004 471500                    LDP1    JDCB$,,AUTO
         1 004150   100000 755100                    STA     0,,PR1

     1086     8698    2      ALTRETURN;

   8698  1 004151   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 004152   000000 702211                    TSX2  ! 0,X1

   8697  1 004153                       FMOE$BADKEY* null
     1087     8699                    /*E*   ERROR:   FMO-E$BADIKEY-E
     1088     8700                           MESSAGE:No such field for IREL key% of %UF%.
     1089     8701                           MESSAGE1: No such field for IREL key% in %UF%.
     1090     8702                                     F$DCB.ARS# contains the key number
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:198  
     1091     8703                                     (INDX - 1) of the bad key.
     1092     8704                    */
     1093     8705    2   FMOE$BADKEYLEN: ;
     1094     8706    2      B$JIT.ERR=FMO$E$BADKEYLEN;

   8706  1 004153   000025 236000 0                  LDQ     FMO$E$BADKEYLEN
         1 004154   000000 474400 xsym               LDP4    B$JIT$
         1 004155   400012 756100                    STQ     10,,PR4

     1095     8707    2      F$DCB.ARS=I;

   8707  1 004156   200012 235100                    LDA     I,,AUTO
         1 004157   200004 471500                    LDP1    JDCB$,,AUTO
         1 004160   100000 755100                    STA     0,,PR1

     1096     8708    2      ALTRETURN;

   8708  1 004161   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 004162   000000 702211                    TSX2  ! 0,X1

   8707  1 004163                       FMOE$BIGKEY  null
     1097     8709                    /*E*   ERROR:   FMO-E$BADKEYLEN-E
     1098     8710                           MESSAGE:Key field after byte 4000% for %UF%.
     1099     8711                           MESSAGE1: Key field after byte 4000% for %UF%.
     1100     8712                                     F$DCB.ARS# contains the key number
     1101     8713                                     (INDX - 1) of the bad key.
     1102     8714                    */
     1103     8715    2   FMOE$BIGKEY: ;
     1104     8716    2      B$JIT.ERR=FMO$E$BIGKEY;

   8716  1 004163   000027 236000 0                  LDQ     FMO$E$BIGKEY
         1 004164   000000 471400 xsym               LDP1    B$JIT$
         1 004165   100012 756100                    STQ     10,,PR1

     1105     8717    2      F$DCB.ARS=I;

   8717  1 004166   200012 235100                    LDA     I,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:199  
         1 004167   200004 470500                    LDP0    JDCB$,,AUTO
         1 004170   000000 755100                    STA     0,,PR0

     1106     8718    2      ALTRETURN;

   8718  1 004171   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 004172   000000 702211                    TSX2  ! 0,X1

   8717  1 004173                       FMOE$BADSTA* null
     1107     8719                    /*E*   ERROR:   FMO-E$BIGKEY-E
     1108     8720                           MESSAGE:IREL key too long% for %UF%.
     1109     8721                           MESSAGE1:The total size of the IREL key plus slack
     1110     8722                                    bits required to byte align fields when
     1111     8723                                    forming keys exceeds 511 bytes% for %UF%.
     1112     8724                                    F$DCB.ARS# contains the key number
     1113     8725                                    (INDX - 1) of the bad key.
     1114     8726                    */
     1115     8727    2   FMOE$BADSTART:;
     1116     8728    2      B$JIT.ERR=FMO$E$BADSTART;

   8728  1 004173   000032 236000 0                  LDQ     FMO$E$BADSTART
         1 004174   000000 473400 xsym               LDP3    B$JIT$
         1 004175   300012 756100                    STQ     10,,PR3

     1117     8729    2      F$DCB.ARS=I;

   8729  1 004176   200012 235100                    LDA     I,,AUTO
         1 004177   200004 471500                    LDP1    JDCB$,,AUTO
         1 004200   100000 755100                    STA     0,,PR1

     1118     8730    2      ALTRETURN;

   8730  1 004201   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 004202   000000 702211                    TSX2  ! 0,X1

   8729  1 004203                       FMOE$BADALI* null
     1119     8731                    /*E*  ERROR:    FMO-E$BADSTART-E
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:200  
     1120     8732                          MESSAGE:  Key field after variable length field% for %UF%
     1121     8733                          MESSAGE1: A field in an IREL key may not follow a variable
     1122     8734                                    length field% for %UF%. F$DCB.ARS# contains the
     1123     8735                                    key number of the bad key (INDX - 1).
     1124     8736                    */
     1125     8737    2   FMOE$BADALIGN:;
     1126     8738    2      B$JIT.ERR=FMO$E$BADALIGN;

   8738  1 004203   000040 236000 0                  LDQ     FMO$E$BADALIGN
         1 004204   000000 474400 xsym               LDP4    B$JIT$
         1 004205   400012 756100                    STQ     10,,PR4

     1127     8739    2      F$DCB.ARS=I;

   8739  1 004206   200012 235100                    LDA     I,,AUTO
         1 004207   200004 471500                    LDP1    JDCB$,,AUTO
         1 004210   100000 755100                    STA     0,,PR1

     1128     8740    2      ALTRETURN;

   8740  1 004211   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 004212   000000 702211                    TSX2  ! 0,X1

     1129     8741                    /*E*  ERROR:    FMO-E$BADALIGN-E
     1130     8742                          MESSAGE:  Integer field in IREL key not byte aligned% for %UF%
     1131     8743                          MESSAGE1: An SBIN or UBIN field used in an IREL key must
     1132     8744                                    be byte aligned and have a bit length evenly
     1133     8745                                    divisible by 9. F$DCB.ARS# contains the key
     1134     8746                                    number (INDX - 1) of the bad key for% %UF%.
     1135     8747                    */
     1136     8748
     1137     8749    2   END FMO$CHKIKEYS;
     1138     8750        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:201  
     1139     8751    1   FMO$BLDIKEYS: PROC ALTRET;

   8751  1 004213   200042 741300       FMO$BLDIKEYS STX1  ! CODE+5,,AUTO

     1140     8752
     1141     8753    2   DCL N SBIN;
     1142     8754    2   DCL FN SBIN;
     1143     8755
     1144     8756    2      I=(KFIELD.NFIELDS+1)/2+1;

   8756  1 004214   200024 470500                    LDP0    KFIELD$,,AUTO
         1 004215   000001 236100                    LDQ     1,,PR0
         1 004216   000001 036007                    ADLQ    1,DL
         1 004217   000001 772000                    QRL     1
         1 004220   000001 036007                    ADLQ    1,DL
         1 004221   200012 756100                    STQ     I,,AUTO

     1145     8757    2      CALL FMO$FITSPACE(I) ALTRET(ERR);

   8757  1 004222   200012 631500                    EPPR1   I,,AUTO
         1 004223   200047 451500                    STP1    FN+3,,AUTO
         1 004224   004717 701000 1                  TSX1    FMO$FITSPACE
         1 004225   004657 702000 1                  TSX2    ERR

     1146     8758    2      I=I*4;

   8758  1 004226   200012 235100                    LDA     I,,AUTO
         1 004227   000002 735000                    ALS     2
         1 004230   200012 755100                    STA     I,,AUTO

     1147     8759    2      LOC$->ZAP_I='0'B; /* Init CODE19 to zeroes */

   8759  1 004231   200005 470500                    LDP0    LOC$,,AUTO
         1 004232   000000 620005                    EAX0    0,AL
         1 004233   000140 100400                    MLR     fill='000'O
         1 004234   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 004235   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:202  

     1148     8760    2      I=SIZEW(CODE20.K(0))*IRKEYS.NKEYS+2;

   8760  1 004236   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004237   000000 236100                    LDQ     0,,PR0
         1 004240   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 004241   000003 402007                    MPY     3,DL
         1 004242   000002 036007                    ADLQ    2,DL
         1 004243   200012 756100                    STQ     I,,AUTO

     1149     8761    2      CODE=20;

   8761  1 004244   000024 235007                    LDA     20,DL
         1 004245   200035 755100                    STA     CODE,,AUTO

     1150     8762    2      CALL FMO$FITSPACE(I) ALTRET(ERR);

   8762  1 004246   200012 631500                    EPPR1   I,,AUTO
         1 004247   200047 451500                    STP1    FN+3,,AUTO
         1 004250   004717 701000 1                  TSX1    FMO$FITSPACE
         1 004251   004657 702000 1                  TSX2    ERR

     1151     8763    2      I=I*4;

   8763  1 004252   200012 235100                    LDA     I,,AUTO
         1 004253   000002 735000                    ALS     2
         1 004254   200012 755100                    STA     I,,AUTO

     1152     8764    2      LOC$->ZAP_I='0'B; /* Init CODE20 to zeroes */

   8764  1 004255   200005 470500                    LDP0    LOC$,,AUTO
         1 004256   000000 620005                    EAX0    0,AL
         1 004257   000140 100400                    MLR     fill='000'O
         1 004260   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 004261   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1153     8765    2      CODE19$=FIT$;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:203  

   8765  1 004262   200007 236100                    LDQ     FIT$,,AUTO
         1 004263   200026 756100                    STQ     CODE19$,,AUTO

     1154     8766    2      CALL FMO$LOCCODP(CODE19$, 19);

   8766  1 004264   000027 236000 2                  LDQ     23
         1 004265   200053 756100                    STQ     INDX+2,,AUTO
         1 004266   200026 630500                    EPPR0   CODE19$,,AUTO
         1 004267   200052 450500                    STP0    INDX+1,,AUTO
         1 004270   200052 630500                    EPPR0   INDX+1,,AUTO
         1 004271   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004272   000000 701000 xent               TSX1    FMO$LOCCODP
         1 004273   000000 011000                    NOP     0

     1155     8767    2      CODE=19;

   8767  1 004274   000023 235007                    LDA     19,DL
         1 004275   200035 755100                    STA     CODE,,AUTO

     1156     8768
     1157     8769    2      CODE19.NKEYS=IRKEYS.NKEYS;

   8769  1 004276   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004277   200026 471500                    LDP1    CODE19$,,AUTO
         1 004300   000000 236100                    LDQ     0,,PR0
         1 004301   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 004302   100000 756100                    STQ     0,,PR1

     1158     8770    2      CODE20.NKEYS=IRKEYS.NKEYS;

   8770  1 004303   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004304   200005 471500                    LDP1    LOC$,,AUTO
         1 004305   000000 236100                    LDQ     0,,PR0
         1 004306   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 004307   100000 756100                    STQ     0,,PR1

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:204  
     1159     8771    2      CODE20.ALTBLD=IRKEYS.ALTBLD;

   8771  1 004310   200005 470500                    LDP0    LOC$,,AUTO
         1 004311   200025 471500                    LDP1    ALTKEY$,,AUTO
         1 004312   100002 236100                    LDQ     2,,PR1
         1 004313   000001 676100                    ERQ     1,,PR0
         1 004314   400000 376003                    ANQ     -131072,DU
         1 004315   000001 656100                    ERSQ    1,,PR0

     1160     8772    2      CODE20.UNIQUEBLD=IRKEYS.UNIQUEBLD;

   8772  1 004316   200005 470500                    LDP0    LOC$,,AUTO
         1 004317   200025 471500                    LDP1    ALTKEY$,,AUTO
         1 004320   100002 236100                    LDQ     2,,PR1
         1 004321   000001 676100                    ERQ     1,,PR0
         1 004322   200000 376003                    ANQ     65536,DU
         1 004323   000001 656100                    ERSQ    1,,PR0

     1161     8773
     1162     8774    3      DO I=0 TO IRKEYS.NKEYS-1;

   8774  1 004324   200012 450100                    STZ     I,,AUTO
         1 004325   004647 710000 1                  TRA     s:8803+3

     1163     8775    3         K=IRKEYS.K.FIRSTFIELD(I);

   8775  1 004326   200012 236100                    LDQ     I,,AUTO
         1 004327   000007 402007                    MPY     7,DL
         1 004330   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004331   000004 236106                    LDQ     4,QL,PR0
         1 004332   000022 772000                    QRL     18
         1 004333   200014 756100                    STQ     K,,AUTO

     1164     8776    3         CODE19.K.UNIQUE(K)=IRKEYS.K.UNIQUE(I);

   8776  1 004334   200012 236100                    LDQ     I,,AUTO
         1 004335   000374 402007                    MPY     252,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:205  
         1 004336   200052 756100                    STQ     INDX+1,,AUTO
         1 004337   200014 236100                    LDQ     K,,AUTO
         1 004340   000022 402007                    MPY     18,DL
         1 004341   200052 235100                    LDA     INDX+1,,AUTO
         1 004342   200026 471500                    LDP1    CODE19$,,AUTO
         1 004343   003106 060505                    CSL     bolr='003'O
         1 004344   000006 400001                    BDSC    6,A,PR0                  by=2,bit=0,n=1
         1 004345   100001 010001                    BDSC    1,Q,PR1                  by=0,bit=1,n=1

     1165     8777    3         K=K+IRKEYS.K.NFIELDS(I)-1;

   8777  1 004346   200012 236100                    LDQ     I,,AUTO
         1 004347   000007 402007                    MPY     7,DL
         1 004350   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004351   000004 236106                    LDQ     4,QL,PR0
         1 004352   777777 376007                    ANQ     -1,DL
         1 004353   200014 036100                    ADLQ    K,,AUTO
         1 004354   000001 136007                    SBLQ    1,DL
         1 004355   200014 756100                    STQ     K,,AUTO

     1166     8778    3         CODE19.K.KEYEND(K)='1'B;

   8778  1 004356   000022 402007                    MPY     18,DL
         1 004357   200026 471500                    LDP1    CODE19$,,AUTO
         1 004360   003106 060400                    CSL     bolr='003'O
         1 004361   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         1 004362   100001 000001                    BDSC    1,Q,PR1                  by=0,bit=0,n=1

     1167     8779
     1168     8780    3         CODE20.K.TDALVL(I)=IRKEYS.K.TDALVL(I);

   8780  1 004363   200012 236100                    LDQ     I,,AUTO
         1 004364   000003 402007                    MPY     3,DL
         1 004365   000000 620006                    EAX0    0,QL
         1 004366   200012 236100                    LDQ     I,,AUTO
         1 004367   000007 402007                    MPY     7,DL
         1 004370   200025 470500                    LDP0    ALTKEY$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:206  
         1 004371   200005 471500                    LDP1    LOC$,,AUTO
         1 004372   000003 236106                    LDQ     3,QL,PR0
         1 004373   100002 676110                    ERQ     2,X0,PR1
         1 004374   777000 376003                    ANQ     -512,DU
         1 004375   100002 656110                    ERSQ    2,X0,PR1

     1169     8781    3         CODE20.K.TDA(I)=IRKEYS.K.TDA(I);

   8781  1 004376   200012 236100                    LDQ     I,,AUTO
         1 004377   000003 402007                    MPY     3,DL
         1 004400   000000 620006                    EAX0    0,QL
         1 004401   200012 236100                    LDQ     I,,AUTO
         1 004402   000007 402007                    MPY     7,DL
         1 004403   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004404   200005 471500                    LDP1    LOC$,,AUTO
         1 004405   000003 236106                    LDQ     3,QL,PR0
         1 004406   100002 676110                    ERQ     2,X0,PR1
         1 004407   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 004410   100002 656110                    ERSQ    2,X0,PR1

     1170     8782    3         CODE20.K.FDA(I)=IRKEYS.K.FDA(I);

   8782  1 004411   200012 236100                    LDQ     I,,AUTO
         1 004412   000003 402007                    MPY     3,DL
         1 004413   000000 620006                    EAX0    0,QL
         1 004414   200012 236100                    LDQ     I,,AUTO
         1 004415   000007 402007                    MPY     7,DL
         1 004416   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004417   200005 471500                    LDP1    LOC$,,AUTO
         1 004420   000007 236106                    LDQ     7,QL,PR0
         1 004421   000011 736000                    QLS     9
         1 004422   100003 676110                    ERQ     3,X0,PR1
         1 004423   000012 376000 2                  ANQ     10
         1 004424   100003 656110                    ERSQ    3,X0,PR1

     1171     8783    3         CODE20.K.LDA(I)=IRKEYS.K.LDA(I);

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:207  
   8783  1 004425   200012 236100                    LDQ     I,,AUTO
         1 004426   000003 402007                    MPY     3,DL
         1 004427   000000 620006                    EAX0    0,QL
         1 004430   200012 236100                    LDQ     I,,AUTO
         1 004431   000007 402007                    MPY     7,DL
         1 004432   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004433   200005 471500                    LDP1    LOC$,,AUTO
         1 004434   000002 736000                    QLS     2
         1 004435   000000 635010                    EAA     0,X0
         1 004436   000020 771000                    ARL     16
         1 004437   000105 100506                    MLR     fill='000'O
         1 004440   000011 200003                    ADSC9   9,Q,PR0                  cn=1,n=3
         1 004441   100003 600003                    ADSC9   3,A,PR1                  cn=3,n=3

     1172     8784
     1173     8785    3         IRKEYS.K.DEGENERATE(I) = '1'B; /* Assume it's a degenerate key. */

   8785  1 004442   200012 236100                    LDQ     I,,AUTO
         1 004443   000007 402007                    MPY     7,DL
         1 004444   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004445   000000 620006                    EAX0    0,QL
         1 004446   040000 236007                    LDQ     16384,DL
         1 004447   000006 256110                    ORSQ    6,X0,PR0

     1174     8786    3         IRKEYS.K.CONTIGUOUS(I) = '1'B; /* Also assume the fields are contiguous */

   8786  1 004450   200012 236100                    LDQ     I,,AUTO
         1 004451   000007 402007                    MPY     7,DL
         1 004452   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004453   000000 620006                    EAX0    0,QL
         1 004454   020000 236007                    LDQ     8192,DL
         1 004455   000006 256110                    ORSQ    6,X0,PR0

     1175     8787    3         FN = -1;

   8787  1 004456   000001 335007                    LCA     1,DL
         1 004457   200044 755100                    STA     FN,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:208  

     1176     8788    4         DO N = IRKEYS.K.FIRSTFIELD(I) TO K;

   8788  1 004460   200012 236100                    LDQ     I,,AUTO
         1 004461   000007 402007                    MPY     7,DL
         1 004462   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004463   000004 236106                    LDQ     4,QL,PR0
         1 004464   000022 772000                    QRL     18
         1 004465   200043 756100                    STQ     N,,AUTO
         1 004466   004610 710000 1                  TRA     s:8799+1

     1177     8789    4            IF FN > -1 THEN /* Past the first field of the key? */

   8789  1 004467   200044 235100                    LDA     FN,,AUTO
         1 004470   004510 604000 1                  TMI     s:8792

     1178     8790    4               IF FN+1 ~= KFIELD.FIELD(N) THEN /* The next field in the record? */

   8790  1 004471   200024 470500                    LDP0    KFIELD$,,AUTO
         1 004472   200043 236100                    LDQ     N,,AUTO
         1 004473   000100 101506                    MRL     fill='000'O
         1 004474   000002 000001                    ADSC9   2,Q,PR0                  cn=0,n=1
         1 004475   200052 000004                    ADSC9   INDX+1,,AUTO             cn=0,n=4
         1 004476   200044 236100                    LDQ     FN,,AUTO
         1 004477   000001 036007                    ADLQ    1,DL
         1 004500   200052 116100                    CMPQ    INDX+1,,AUTO
         1 004501   004510 600000 1                  TZE     s:8792

     1179     8791    4                  IRKEYS.K.CONTIGUOUS(I) = '0'B; /* No.  Not contiguous. */

   8791  1 004502   200012 236100                    LDQ     I,,AUTO
         1 004503   000007 402007                    MPY     7,DL
         1 004504   200025 471500                    LDP1    ALTKEY$,,AUTO
         1 004505   000000 620006                    EAX0    0,QL
         1 004506   000030 236000 2                  LDQ     24
         1 004507   100006 356110                    ANSQ    6,X0,PR1

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:209  
     1180     8792    4            CODE19.K.FIELDN(N) = KFIELD.FIELD(N);

   8792  1 004510   200043 235100                    LDA     N,,AUTO
         1 004511   000001 735000                    ALS     1
         1 004512   200024 470500                    LDP0    KFIELD$,,AUTO
         1 004513   200043 236100                    LDQ     N,,AUTO
         1 004514   200026 471500                    LDP1    CODE19$,,AUTO
         1 004515   000105 100506                    MLR     fill='000'O
         1 004516   000002 000001                    ADSC9   2,Q,PR0                  cn=0,n=1
         1 004517   100001 200001                    ADSC9   1,A,PR1                  cn=1,n=1

     1181     8793    4            FN = CODE19.K.FIELDN(N);

   8793  1 004520   200026 471500                    LDP1    CODE19$,,AUTO
         1 004521   000100 101505                    MRL     fill='000'O
         1 004522   100001 200001                    ADSC9   1,A,PR1                  cn=1,n=1
         1 004523   200044 000004                    ADSC9   FN,,AUTO                 cn=0,n=4

     1182     8794    4            IF   RECFIELD.FIELD.TYPE(FN) ~= %CHAR_DATATYPE AND

   8794  1 004524   200044 236100                    LDQ     FN,,AUTO
         1 004525   000003 402007                    MPY     3,DL
         1 004526   000000 116003                    CMPQ    0,DU
         1 004527   004531 605000 1                  TPL     s:8794+5
         1 004530   000006 036003                    ADLQ    6,DU
         1 004531   200021 473500                    LDP3    FIELD$,,AUTO
         1 004532   000100 101506                    MRL     fill='000'O
         1 004533   300001 020001                    ADSC6   1,Q,PR3                  cn=0,n=1
         1 004534   200052 020006                    ADSC6   INDX+1,,AUTO             cn=0,n=6
         1 004535   200052 236100                    LDQ     INDX+1,,AUTO
         1 004536   000025 116007                    CMPQ    21,DL
         1 004537   004607 600000 1                  TZE     s:8799
         1 004540   200044 236100                    LDQ     FN,,AUTO
         1 004541   000003 402007                    MPY     3,DL
         1 004542   000000 116003                    CMPQ    0,DU
         1 004543   004545 605000 1                  TPL     s:8794+17
         1 004544   000006 036003                    ADLQ    6,DU
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:210  
         1 004545   000100 101506                    MRL     fill='000'O
         1 004546   300001 020001                    ADSC6   1,Q,PR3                  cn=0,n=1
         1 004547   200053 020006                    ADSC6   INDX+2,,AUTO             cn=0,n=6
         1 004550   200053 236100                    LDQ     INDX+2,,AUTO
         1 004551   000030 116007                    CMPQ    24,DL
         1 004552   004607 600000 1                  TZE     s:8799
         1 004553   200044 236100                    LDQ     FN,,AUTO
         1 004554   000003 402007                    MPY     3,DL
         1 004555   000000 116003                    CMPQ    0,DU
         1 004556   004560 605000 1                  TPL     s:8794+28
         1 004557   000006 036003                    ADLQ    6,DU
         1 004560   000100 101506                    MRL     fill='000'O
         1 004561   300001 020001                    ADSC6   1,Q,PR3                  cn=0,n=1
         1 004562   200054 020006                    ADSC6   INDX+3,,AUTO             cn=0,n=6
         1 004563   200054 236100                    LDQ     INDX+3,,AUTO
         1 004564   000067 116007                    CMPQ    55,DL
         1 004565   004607 600000 1                  TZE     s:8799
         1 004566   200044 236100                    LDQ     FN,,AUTO
         1 004567   000003 402007                    MPY     3,DL
         1 004570   000000 116003                    CMPQ    0,DU
         1 004571   004573 605000 1                  TPL     s:8794+39
         1 004572   000006 036003                    ADLQ    6,DU
         1 004573   000100 101506                    MRL     fill='000'O
         1 004574   300001 020001                    ADSC6   1,Q,PR3                  cn=0,n=1
         1 004575   200055 020006                    ADSC6   INDX+4,,AUTO             cn=0,n=6
         1 004576   200055 236100                    LDQ     INDX+4,,AUTO
         1 004577   000051 116007                    CMPQ    41,DL
         1 004600   004607 600000 1                  TZE     s:8799

     1183     8795    4              RECFIELD.FIELD.TYPE(FN) ~= %UBIN_DATATYPE AND
     1184     8796    4              RECFIELD.FIELD.TYPE(FN) ~= %UTS_DATATYPE  AND
     1185     8797    4              RECFIELD.FIELD.TYPE(FN) ~= %UDNS_DATATYPE THEN
     1186     8798    4               IRKEYS.K.DEGENERATE(I) = '0'B; /* Not degenerate. */

   8798  1 004601   200012 236100                    LDQ     I,,AUTO
         1 004602   000007 402007                    MPY     7,DL
         1 004603   200025 474500                    LDP4    ALTKEY$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:211  
         1 004604   000000 620006                    EAX0    0,QL
         1 004605   000031 236000 2                  LDQ     25
         1 004606   400006 356110                    ANSQ    6,X0,PR4

     1187     8799    4            END;

   8799  1 004607   200043 054100                    AOS     N,,AUTO
         1 004610   200014 236100                    LDQ     K,,AUTO
         1 004611   004467 604000 1                  TMI     s:8789
         1 004612   200043 116100                    CMPQ    N,,AUTO
         1 004613   004467 605000 1                  TPL     s:8789

     1188     8800
     1189     8801    3         CODE20.K.DEGENERATE(I) = IRKEYS.K.DEGENERATE(I);

   8801  1 004614   200012 236100                    LDQ     I,,AUTO
         1 004615   000003 402007                    MPY     3,DL
         1 004616   200005 470500                    LDP0    LOC$,,AUTO
         1 004617   000000 620006                    EAX0    0,QL
         1 004620   200012 236100                    LDQ     I,,AUTO
         1 004621   000007 402007                    MPY     7,DL
         1 004622   200025 471500                    LDP1    ALTKEY$,,AUTO
         1 004623   100006 236106                    LDQ     6,QL,PR1
         1 004624   000003 736000                    QLS     3
         1 004625   000004 676110                    ERQ     4,X0,PR0
         1 004626   400000 376007                    ANQ     -131072,DL
         1 004627   000004 656110                    ERSQ    4,X0,PR0

     1190     8802    3         CODE20.K.CONTIGUOUS(I) = IRKEYS.K.CONTIGUOUS(I);

   8802  1 004630   200012 236100                    LDQ     I,,AUTO
         1 004631   000003 402007                    MPY     3,DL
         1 004632   200005 470500                    LDP0    LOC$,,AUTO
         1 004633   000000 620006                    EAX0    0,QL
         1 004634   200012 236100                    LDQ     I,,AUTO
         1 004635   000007 402007                    MPY     7,DL
         1 004636   200025 471500                    LDP1    ALTKEY$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:212  
         1 004637   100006 236106                    LDQ     6,QL,PR1
         1 004640   000003 736000                    QLS     3
         1 004641   000004 676110                    ERQ     4,X0,PR0
         1 004642   200000 376007                    ANQ     65536,DL
         1 004643   000004 656110                    ERSQ    4,X0,PR0

     1191     8803    3         END;

   8803  1 004644   200012 235100                    LDA     I,,AUTO
         1 004645   000001 035007                    ADLA    1,DL
         1 004646   200012 755100                    STA     I,,AUTO
         1 004647   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 004650   000000 236100                    LDQ     0,,PR0
         1 004651   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 004652   200012 116100                    CMPQ    I,,AUTO
         1 004653   004655 600000 1                  TZE     s:8804
         1 004654   004326 603000 1                  TRC     s:8775

     1192     8804    2      RETURN;

   8804  1 004655   200042 221300                    LDX1  ! CODE+5,,AUTO
         1 004656   000001 702211                    TSX2  ! 1,X1

     1193     8805    2   ERR: ALTRETURN;

   8805  1 004657   200042 221300       ERR          LDX1  ! CODE+5,,AUTO
         1 004660   000000 702211                    TSX2  ! 0,X1

     1194     8806    2   END FMO$BLDIKEYS;
     1195     8807        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:213  
     1196     8808                    /*I*     NAME:    FMO$FITSPACE
     1197     8809                     PURPOSE: To insure that there is enough space to add or replace
     1198     8810                     an entry in the FIT granule.
     1199     8811                     DESCRIPTION: The single parameter is the words needed.
     1200     8812                     CODE is the entry to be added/replaced. If the current entry is
     1201     8813                     O.K. LOC$ is set to point to it. Else if there is enough room
     1202     8814                     in the FIT granule, it is shuffled and LOC$ points to the hole.
     1203     8815                     If there is no CODE entry, one is made and LOC$ points to its
     1204     8816                     space. In any case, all NAVX,FCEX,AVAIL,NAW,NDW, etc. values
     1205     8817                     are left in a state consistent with the new structure.  If
     1206     8818                     the existing FIT granule is too small and is not already one,
     1207     8819                     it becomes an AFIT and the FIT information is removed from the
     1208     8820                     first file granule.
     1209     8821                    */
     1210     8822    1   FMO$FITSPDIR: ENTRY(DUMMY)ALTRET;

   8822  1 004661   000000 700200 xent  FMO$FITSPDIR TSX0  ! X66_AUTO_1
         1 004662   000062 000001                    ZERO    50,1

     1211     8823    1      JDCB$=B$JIT.DCB$;

   8823  1 004663   000000 470400 xsym               LDP0    B$JIT$
         1 004664   000232 236100                    LDQ     154,,PR0
         1 004665   200004 756100                    STQ     JDCB$,,AUTO

     1212     8824    1      T$$=ADDR(T$);

   8824  1 004666   200016 631500                    EPPR1   T$,,AUTO
         1 004667   200017 451500                    STP1    T$$,,AUTO

     1213     8825    1      BUFNO=1;

   8825  1 004670   000001 235007                    LDA     1,DL
         1 004671   200015 755100                    STA     BUFNO,,AUTO

     1214     8826    1      IBIT=PN$;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:214  
   8826  1 004672   200003 473500                    LDP3    @DUMMY,,AUTO
         1 004673   300000 236100                    LDQ     0,,PR3
         1 004674   200012 756100                    STQ     I,,AUTO

     1215     8827    1      CODE=ADDR(I)->FM$FIT.CODES.CODE(0);

   8827  1 004675   200012 236100                    LDQ     I,,AUTO
         1 004676   000037 772000                    QRL     31
         1 004677   200035 756100                    STQ     CODE,,AUTO

     1216     8828    1      BUF$=FM$BUF$(F$DCB.BFR.BUFX(1));

   8828  1 004700   200004 474500                    LDP4    JDCB$,,AUTO
         1 004701   400116 236100                    LDQ     78,,PR4
         1 004702   000033 772000                    QRL     27
         1 004703   000037 376007                    ANQ     31,DL
         1 004704   000000 236006 xsym               LDQ     FM$BUF$,QL
         1 004705   200011 756100                    STQ     BUF$,,AUTO

     1217     8829    1      FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));

   8829  1 004706   000005 036003                    ADLQ    5,DU
         1 004707   200007 756100                    STQ     FIT$,,AUTO

     1218     8830    1      CFU$=ADDR(BUFNO); /* FOR AFIT TEST AFTER CALL TO MOVKEYS */

   8830  1 004710   200015 635500                    EPPR5   BUFNO,,AUTO
         1 004711   200010 455500                    STP5    CFU$,,AUTO

     1219     8831    1      CALL FMO$FITSPACE(I)ALTRET(FMOE$VLPERR);

   8831  1 004712   200012 636500                    EPPR6   I,,AUTO
         1 004713   200047 456500                    STP6    FN+3,,AUTO
         1 004714   004717 701000 1                  TSX1    FMO$FITSPACE
         1 004715   000562 702000 1                  TSX2    FMOE$VLPERR

     1220     8832    1      RETURN;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:215  

   8832  1 004716   000000 702200 xent               TSX2  ! X66_ARET

     1221     8833    1   FMO$FITSPACE: PROC(SIZE) ALTRET;

   8833  1 004717   200046 741300       FMO$FITSPACE STX1  ! FN+2,,AUTO

     1222     8834    2   DCL SIZE UBIN ALIGNED;
     1223     8835    2   DCL 1 SZ1 REDEF SIZE ALIGNED,
     1224     8836    2         2 NAW UBIN HALF UNAL,
     1225     8837    2         2 NDW UBIN HALF UNAL;
     1226     8838    2   DCL TMP UBIN;
     1227     8839    2   DCL INDX UBIN;

   8839  1 004720                       FITSP0       null
     1228     8840    2   FITSP0:;
     1229     8841    2      K=SZ1.NDW;

   8841  1 004720   200047 470500                    LDP0    @SIZE,,AUTO
         1 004721   000000 236100                    LDQ     0,,PR0
         1 004722   777777 376007                    ANQ     -1,DL
         1 004723   200014 756100                    STQ     K,,AUTO

     1230     8842    2      IF K<SZ1.NAW THEN K=SZ1.NAW;

   8842  1 004724   000000 236100                    LDQ     0,,PR0
         1 004725   000022 772000                    QRL     18
         1 004726   200014 116100                    CMPQ    K,,AUTO
         1 004727   004732 602000 1                  TNC     s:8843
         1 004730   004732 600000 1                  TZE     s:8843

   8842  1 004731   200014 756100                    STQ     K,,AUTO

     1231     8843    3      IF ADDR(SIZE)->FM$FIT.CODES.CODE(0)~=0 THEN DO;

   8843  1 004732   000000 236100                    LDQ     0,,PR0
         1 004733   760000 316003                    CANQ    -8192,DU
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:216  
         1 004734   004750 600000 1                  TZE     s:8848

     1232     8844    3         K=ADDR(SIZE)->FM$FIT.CODES.NAW(0);

   8844  1 004735   000000 236100                    LDQ     0,,PR0
         1 004736   000024 772000                    QRL     20
         1 004737   001777 376007                    ANQ     1023,DL
         1 004740   200014 756100                    STQ     K,,AUTO

     1233     8845    3         IF K<ADDR(SIZE)->FM$FIT.CODES.NDW(0)

   8845  1 004741   000000 236100                    LDQ     0,,PR0
         1 004742   000012 772000                    QRL     10
         1 004743   001777 376007                    ANQ     1023,DL
         1 004744   200014 116100                    CMPQ    K,,AUTO
         1 004745   004750 602000 1                  TNC     s:8848
         1 004746   004750 600000 1                  TZE     s:8848

     1234     8846    3         THEN K=ADDR(SIZE)->FM$FIT.CODES.NDW(0);

   8846  1 004747   200014 756100                    STQ     K,,AUTO

     1235     8847    3         END;

     1236     8848    2      J=1;     /* FIRST TRY TO FIND THE ENTRY */

   8848  1 004750   000001 235007                    LDA     1,DL
         1 004751   200013 755100                    STA     J,,AUTO

     1237     8849    3      DO WHILE (J<=FM$FIT.CODES.CODE(0));

   8849  1 004752   200007 471500                    LDP1    FIT$,,AUTO
         1 004753   100000 236100                    LDQ     0,,PR1
         1 004754   000037 772000                    QRL     31
         1 004755   200013 116100                    CMPQ    J,,AUTO
         1 004756   004774 602000 1                  TNC     s:8853

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:217  
     1238     8850    3         IF FM$FIT.CODES.CODE(J)=CODE THEN GOTO FITSP1;

   8850  1 004757   200007 470500                    LDP0    FIT$,,AUTO
         1 004760   200013 720100                    LXL0    J,,AUTO
         1 004761   000000 236110                    LDQ     0,X0,PR0
         1 004762   000037 772000                    QRL     31
         1 004763   200035 116100                    CMPQ    CODE,,AUTO
         1 004764   005035 600000 1                  TZE     FITSP1

     1239     8851    3         J=J+1;

   8851  1 004765   200013 235100                    LDA     J,,AUTO
         1 004766   000001 035007                    ADLA    1,DL
         1 004767   200013 755100                    STA     J,,AUTO

     1240     8852    3         END;

   8852  1 004770   000000 236100                    LDQ     0,,PR0
         1 004771   000037 772000                    QRL     31
         1 004772   200013 116100                    CMPQ    J,,AUTO
         1 004773   004757 603000 1                  TRC     s:8850

     1241     8853    2      LOC$=PINCRW(FIT$,J);

   8853  1 004774   200013 236100                    LDQ     J,,AUTO
         1 004775   000022 736000                    QLS     18
         1 004776   200007 036100                    ADLQ    FIT$,,AUTO
         1 004777   200005 756100                    STQ     LOC$,,AUTO

     1242     8854    2      IF SIZE=0 THEN RETURN;

   8854  1 005000   200047 470500                    LDP0    @SIZE,,AUTO
         1 005001   000000 235100                    LDA     0,,PR0
         1 005002   005005 601000 1                  TNZ     s:8855

   8854  1 005003   200046 221300                    LDX1  ! FN+2,,AUTO
         1 005004   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:218  

     1243     8855    3      IF J>=FM$FIT.CODES.NAW(0) THEN DO;

   8855  1 005005   200007 471500                    LDP1    FIT$,,AUTO
         1 005006   100000 236100                    LDQ     0,,PR1
         1 005007   000024 772000                    QRL     20
         1 005010   001777 376007                    ANQ     1023,DL
         1 005011   200013 116100                    CMPQ    J,,AUTO
         1 005012   005014 600000 1                  TZE     s:8856
         1 005013   005020 603000 1                  TRC     s:8859

     1244     8856    3         K=K+1; /* GET SPACE FOR CONTROL WORD TOO */

   8856  1 005014   200014 235100                    LDA     K,,AUTO
         1 005015   000001 035007                    ADLA    1,DL
         1 005016   200014 755100                    STA     K,,AUTO

     1245     8857    3         GOTO FITSP9;

   8857  1 005017   005142 710000 1                  TRA     FITSP9

     1246     8858    3         END;
     1247     8859    2      FM$FIT.CODES(J)='0'B;

   8859  1 005020   200013 720100                    LXL0    J,,AUTO
         1 005021   100000 450110                    STZ     0,X0,PR1

     1248     8860    2      FM$FIT.CODES.CODE(J)=CODE;

   8860  1 005022   200013 720100                    LXL0    J,,AUTO
         1 005023   200035 236100                    LDQ     CODE,,AUTO
         1 005024   000037 736000                    QLS     31
         1 005025   100000 676110                    ERQ     0,X0,PR1
         1 005026   760000 376003                    ANQ     -8192,DU
         1 005027   100000 656110                    ERSQ    0,X0,PR1

     1249     8861    2      FM$FIT.CODES.CODE(0)=J;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:219  

   8861  1 005030   200013 236100                    LDQ     J,,AUTO
         1 005031   000037 736000                    QLS     31
         1 005032   100000 676100                    ERQ     0,,PR1
         1 005033   760000 376003                    ANQ     -8192,DU
         1 005034   100000 656100                    ERSQ    0,,PR1

   8861  1 005035                       FITSP1       null
     1250     8862    2   FITSP1:;
     1251     8863    2      IF FM$FIT.CODES.NAW(J)=0

   8863  1 005035   200007 470500                    LDP0    FIT$,,AUTO
         1 005036   200013 720100                    LXL0    J,,AUTO
         1 005037   000000 236110                    LDQ     0,X0,PR0
         1 005040   007774 316003                    CANQ    4092,DU
         1 005041   005046 601000 1                  TNZ     s:8865

     1252     8864    2      THEN FM$FIT.CODES.ITEMX(J)=FM$FIT.CODES.ITEMX(1);

   8864  1 005042   000001 236100                    LDQ     1,,PR0
         1 005043   000000 676110                    ERQ     0,X0,PR0
         1 005044   001777 376007                    ANQ     1023,DL
         1 005045   000000 656110                    ERSQ    0,X0,PR0

     1253     8865    2      LOC$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(J)); /* POINT TO DATA */

   8865  1 005046   200013 720100                    LXL0    J,,AUTO
         1 005047   000000 721110                    LXL1    0,X0,PR0
         1 005050   001777 361003                    ANX1    1023,DU
         1 005051   000000 636011                    EAQ     0,X1
         1 005052   200007 036100                    ADLQ    FIT$,,AUTO
         1 005053   200005 756100                    STQ     LOC$,,AUTO

     1254     8866    3      IF FM$FIT.CODES.NAW(J)>=K THEN DO;

   8866  1 005054   000000 236110                    LDQ     0,X0,PR0
         1 005055   000024 772000                    QRL     20
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:220  
         1 005056   001777 376007                    ANQ     1023,DL
         1 005057   200014 116100                    CMPQ    K,,AUTO
         1 005060   005111 602000 1                  TNC     s:8873

     1255     8867    3         IF ADDR(SIZE)->FM$FIT.CODES.CODE(0)~=0

   8867  1 005061   200047 471500                    LDP1    @SIZE,,AUTO
         1 005062   100000 236100                    LDQ     0,,PR1
         1 005063   760000 316003                    CANQ    -8192,DU
         1 005064   005071 600000 1                  TZE     s:8869

     1256     8868    3         THEN SIZE=ADDR(SIZE)->FM$FIT.CODES.NDW(0);

   8868  1 005065   100000 236100                    LDQ     0,,PR1
         1 005066   000012 772000                    QRL     10
         1 005067   001777 376007                    ANQ     1023,DL
         1 005070   100000 756100                    STQ     0,,PR1

     1257     8869    3         IF SZ1.NAW>0 THEN SIZE=SZ1.NDW;

   8869  1 005071   100000 220100                    LDX0    0,,PR1
         1 005072   005076 600000 1                  TZE     s:8870

   8869  1 005073   100000 236100                    LDQ     0,,PR1
         1 005074   777777 376007                    ANQ     -1,DL
         1 005075   100000 756100                    STQ     0,,PR1

     1258     8870    3         IF CODE~=1 THEN FM$FIT.CODES.NDW(J)=SIZE;

   8870  1 005076   200035 235100                    LDA     CODE,,AUTO
         1 005077   000001 115007                    CMPA    1,DL
         1 005100   005107 600000 1                  TZE     s:8871

   8870  1 005101   200013 720100                    LXL0    J,,AUTO
         1 005102   100000 236100                    LDQ     0,,PR1
         1 005103   000012 736000                    QLS     10
         1 005104   000000 676110                    ERQ     0,X0,PR0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:221  
         1 005105   000032 376000 2                  ANQ     26
         1 005106   000000 656110                    ERSQ    0,X0,PR0

     1259     8871    3         RETURN;

   8871  1 005107   200046 221300                    LDX1  ! FN+2,,AUTO
         1 005110   000001 702211                    TSX2  ! 1,X1

     1260     8872    3         END;
     1261     8873    2      K=K-FM$FIT.CODES.NAW(J);

   8873  1 005111   200052 756100                    STQ     INDX+1,,AUTO
         1 005112   200014 236100                    LDQ     K,,AUTO
         1 005113   200052 136100                    SBLQ    INDX+1,,AUTO
         1 005114   200014 756100                    STQ     K,,AUTO

     1262     8874    2      LOC$=PINCRW(LOC$,FM$FIT.CODES.NAW(J)); /* DONT CLOBBER EXISTING DATA */

   8874  1 005115   000000 236110                    LDQ     0,X0,PR0
         1 005116   000024 772000                    QRL     20
         1 005117   001777 376007                    ANQ     1023,DL
         1 005120   000022 736000                    QLS     18
         1 005121   200005 036100                    ADLQ    LOC$,,AUTO
         1 005122   200005 756100                    STQ     LOC$,,AUTO

     1263     8875    2      IF CODE=1 AND K<FM$GRAN.AVAIL

   8875  1 005123   200035 235100                    LDA     CODE,,AUTO
         1 005124   000001 115007                    CMPA    1,DL
         1 005125   005142 601000 1                  TNZ     FITSP9
         1 005126   200011 471500                    LDP1    BUF$,,AUTO
         1 005127   100001 236100                    LDQ     1,,PR1
         1 005130   001777 376007                    ANQ     1023,DL
         1 005131   200014 116100                    CMPQ    K,,AUTO
         1 005132   005142 602000 1                  TNC     FITSP9
         1 005133   005142 600000 1                  TZE     FITSP9

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:222  
     1264     8876    2      THEN IF FM$GRAN.AVAIL<16 THEN K=FM$GRAN.AVAIL;

   8876  1 005134   000020 116007                    CMPQ    16,DL
         1 005135   005140 603000 1                  TRC     s:8877

   8876  1 005136   200014 756100                    STQ     K,,AUTO
         1 005137   005142 710000 1                  TRA     FITSP9

     1265     8877    2         ELSE K=16;

   8877  1 005140   000020 235007                    LDA     16,DL
         1 005141   200014 755100                    STA     K,,AUTO

   8875  1 005142                       FITSP9       null
     1266     8878    2   FITSP9:;
     1267     8879    2      IF FM$GRAN.NAVX+FM$GRAN.AVAIL~=1024 THEN GOTO FITSP$AFIT;

   8879  1 005142   200011 470500                    LDP0    BUF$,,AUTO
         1 005143   000001 236100                    LDQ     1,,PR0
         1 005144   001777 376007                    ANQ     1023,DL
         1 005145   200052 756100                    STQ     INDX+1,,AUTO
         1 005146   000001 236100                    LDQ     1,,PR0
         1 005147   000022 772000                    QRL     18
         1 005150   200052 036100                    ADLQ    INDX+1,,AUTO
         1 005151   002000 116007                    CMPQ    1024,DL
         1 005152   005540 601000 1                  TNZ     FITSP$AFIT

     1268     8880    2      IF FM$GRAN.KEYCNT~=0 AND BUFNO=1 AND CODE~=1

   8880  1 005153   000002 236100                    LDQ     2,,PR0
         1 005154   000777 316007                    CANQ    511,DL
         1 005155   005245 600000 1                  TZE     s:8890
         1 005156   200015 235100                    LDA     BUFNO,,AUTO
         1 005157   000001 115007                    CMPA    1,DL
         1 005160   005245 601000 1                  TNZ     s:8890
         1 005161   200035 235100                    LDA     CODE,,AUTO
         1 005162   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:223  
         1 005163   005245 600000 1                  TZE     s:8890
         1 005164   000002 236100                    LDQ     2,,PR0
         1 005165   000022 772000                    QRL     18
         1 005166   200014 036100                    ADLQ    K,,AUTO
         1 005167   001673 116007                    CMPQ    955,DL
         1 005170   005245 603000 1                  TRC     s:8890

     1269     8881    3        AND K+FM$GRAN.FCEX<=1024-SIZEW(FM$KEYTBL) THEN DO;

     1270     8882    3         CALL FMG$MOVKEYS(K) ALTRET(FITSP$GOTAFIT);

   8882  1 005171   200014 631500                    EPPR1   K,,AUTO
         1 005172   200052 451500                    STP1    INDX+1,,AUTO
         1 005173   200052 630500                    EPPR0   INDX+1,,AUTO
         1 005174   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005175   000000 701000 xent               TSX1    FMG$MOVKEYS
         1 005176   006162 702000 1                  TSX2    FITSP$GOTAFIT

     1271     8883    3         IF FM$GRAN.NAVX+FM$GRAN.AVAIL~=1024 THEN GOTO FITSP$AFIT;

   8883  1 005177   200011 470500                    LDP0    BUF$,,AUTO
         1 005200   000001 236100                    LDQ     1,,PR0
         1 005201   001777 376007                    ANQ     1023,DL
         1 005202   200052 756100                    STQ     INDX+1,,AUTO
         1 005203   000001 236100                    LDQ     1,,PR0
         1 005204   000022 772000                    QRL     18
         1 005205   200052 036100                    ADLQ    INDX+1,,AUTO
         1 005206   002000 116007                    CMPQ    1024,DL
         1 005207   005540 601000 1                  TNZ     FITSP$AFIT

     1272     8884    3         IF FM$CFU.AFIT~=0 THEN GOTO FITSP$GOTAFIT;

   8884  1 005210   200010 471500                    LDP1    CFU$,,AUTO
         1 005211   100000 236100                    LDQ     0,,PR1
         1 005212   001000 316003                    CANQ    512,DU
         1 005213   006162 601000 1                  TNZ     FITSP$GOTAFIT

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:224  
     1273     8885                    /* THE MOVE ALLOCATED SPACE, AND MADE AN AFIT */
     1274     8886    3         T$=LOC$;

   8886  1 005214   200005 236100                    LDQ     LOC$,,AUTO
         1 005215   200016 756100                    STQ     T$,,AUTO

     1275     8887    3         CALL FMR$SLIDE(XT$,K,FM$GRAN.FCEX-POFFW(LOC$,BUF$)-K);

   8887  1 005216   200011 235100                    LDA     BUF$,,AUTO
         1 005217   000022 771000                    ARL     18
         1 005220   200052 755100                    STA     INDX+1,,AUTO
         1 005221   200005 236100                    LDQ     LOC$,,AUTO
         1 005222   000022 772000                    QRL     18
         1 005223   200052 136100                    SBLQ    INDX+1,,AUTO
         1 005224   200053 756100                    STQ     INDX+2,,AUTO
         1 005225   000002 236100                    LDQ     2,,PR0
         1 005226   000022 772000                    QRL     18
         1 005227   200053 136100                    SBLQ    INDX+2,,AUTO
         1 005230   200014 136100                    SBLQ    K,,AUTO
         1 005231   200054 756100                    STQ     INDX+3,,AUTO
         1 005232   200054 633500                    EPPR3   INDX+3,,AUTO
         1 005233   200057 453500                    STP3    INDX+6,,AUTO
         1 005234   200014 634500                    EPPR4   K,,AUTO
         1 005235   200056 454500                    STP4    INDX+5,,AUTO
         1 005236   200017 236100                    LDQ     T$$,,AUTO
         1 005237   200055 756100                    STQ     INDX+4,,AUTO
         1 005240   200055 630500                    EPPR0   INDX+4,,AUTO
         1 005241   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 005242   000000 701000 xent               TSX1    FMR$SLIDE
         1 005243   000000 011000                    NOP     0

     1276     8888    3         END;

   8888  1 005244   005323 710000 1                  TRA     s:8897

     1277     8889    3      ELSE DO;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:225  
     1278     8890    3         IF K>FM$GRAN.AVAIL THEN GOTO FITSP$AFIT;

   8890  1 005245   000001 236100                    LDQ     1,,PR0
         1 005246   001777 376007                    ANQ     1023,DL
         1 005247   200014 116100                    CMPQ    K,,AUTO
         1 005250   005540 602000 1                  TNC     FITSP$AFIT

     1279     8891    3         T$=LOC$;

   8891  1 005251   200005 236100                    LDQ     LOC$,,AUTO
         1 005252   200016 756100                    STQ     T$,,AUTO

     1280     8892    3         CALL FMR$SLIDE(XT$,K,FM$GRAN.NAVX-POFFW(LOC$,BUF$));

   8892  1 005253   200011 235100                    LDA     BUF$,,AUTO
         1 005254   000022 771000                    ARL     18
         1 005255   200052 755100                    STA     INDX+1,,AUTO
         1 005256   200005 236100                    LDQ     LOC$,,AUTO
         1 005257   000022 772000                    QRL     18
         1 005260   200052 136100                    SBLQ    INDX+1,,AUTO
         1 005261   200053 756100                    STQ     INDX+2,,AUTO
         1 005262   000001 236100                    LDQ     1,,PR0
         1 005263   000022 772000                    QRL     18
         1 005264   200053 136100                    SBLQ    INDX+2,,AUTO
         1 005265   200054 756100                    STQ     INDX+3,,AUTO
         1 005266   200054 631500                    EPPR1   INDX+3,,AUTO
         1 005267   200057 451500                    STP1    INDX+6,,AUTO
         1 005270   200014 633500                    EPPR3   K,,AUTO
         1 005271   200056 453500                    STP3    INDX+5,,AUTO
         1 005272   200017 236100                    LDQ     T$$,,AUTO
         1 005273   200055 756100                    STQ     INDX+4,,AUTO
         1 005274   200055 630500                    EPPR0   INDX+4,,AUTO
         1 005275   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 005276   000000 701000 xent               TSX1    FMR$SLIDE
         1 005277   000000 011000                    NOP     0

     1281     8893    3         FM$GRAN.NAVX=FM$GRAN.NAVX+K;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:226  

   8893  1 005300   200011 470500                    LDP0    BUF$,,AUTO
         1 005301   000001 236100                    LDQ     1,,PR0
         1 005302   000022 772000                    QRL     18
         1 005303   200014 036100                    ADLQ    K,,AUTO
         1 005304   000000 620006                    EAX0    0,QL
         1 005305   000001 740100                    STX0    1,,PR0

     1282     8894    3         FM$GRAN.AVAIL=FM$GRAN.AVAIL-K;

   8894  1 005306   200011 470500                    LDP0    BUF$,,AUTO
         1 005307   000001 236100                    LDQ     1,,PR0
         1 005310   001777 376007                    ANQ     1023,DL
         1 005311   200014 136100                    SBLQ    K,,AUTO
         1 005312   000001 676100                    ERQ     1,,PR0
         1 005313   001777 376007                    ANQ     1023,DL
         1 005314   000001 656100                    ERSQ    1,,PR0

     1283     8895    3         FM$GRAN.FCEX=FM$GRAN.FCEX+K;

   8895  1 005315   200011 470500                    LDP0    BUF$,,AUTO
         1 005316   000002 236100                    LDQ     2,,PR0
         1 005317   000022 772000                    QRL     18
         1 005320   200014 036100                    ADLQ    K,,AUTO
         1 005321   000000 620006                    EAX0    0,QL
         1 005322   000002 740100                    STX0    2,,PR0

     1284     8896    3         END;

     1285     8897    3      IF J>FM$FIT.CODES.CODE(0) THEN DO;

   8897  1 005323   200007 470500                    LDP0    FIT$,,AUTO
         1 005324   000000 236100                    LDQ     0,,PR0
         1 005325   000037 772000                    QRL     31
         1 005326   200013 116100                    CMPQ    J,,AUTO
         1 005327   005362 603000 1                  TRC     s:8904

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:227  
     1286     8898    3         FM$FIT.CODES.CODE(0)=J;

   8898  1 005330   200013 236100                    LDQ     J,,AUTO
         1 005331   000037 736000                    QLS     31
         1 005332   000000 676100                    ERQ     0,,PR0
         1 005333   760000 376003                    ANQ     -8192,DU
         1 005334   000000 656100                    ERSQ    0,,PR0

     1287     8899    3         FM$FIT.CODES.NAW(0)=J+1;

   8899  1 005335   200013 236100                    LDQ     J,,AUTO
         1 005336   000001 036007                    ADLQ    1,DL
         1 005337   000024 736000                    QLS     20
         1 005340   000000 676100                    ERQ     0,,PR0
         1 005341   007774 376003                    ANQ     4092,DU
         1 005342   000000 656100                    ERSQ    0,,PR0

     1288     8900    3         FM$FIT.CODES(J)=BINBIT(-1,36);

   8900  1 005343   000001 336007                    LCQ     1,DL
         1 005344   200013 720100                    LXL0    J,,AUTO
         1 005345   000000 756110                    STQ     0,X0,PR0

     1289     8901    3         FM$FIT.CODES.ITEMX(J)=J+1;

   8901  1 005346   200013 720100                    LXL0    J,,AUTO
         1 005347   200013 236100                    LDQ     J,,AUTO
         1 005350   000001 036007                    ADLQ    1,DL
         1 005351   000000 676110                    ERQ     0,X0,PR0
         1 005352   001777 376007                    ANQ     1023,DL
         1 005353   000000 656110                    ERSQ    0,X0,PR0

     1290     8902    3         FM$FIT.CODES.CODE(J)=CODE;

   8902  1 005354   200013 720100                    LXL0    J,,AUTO
         1 005355   200035 236100                    LDQ     CODE,,AUTO
         1 005356   000037 736000                    QLS     31
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:228  
         1 005357   000000 676110                    ERQ     0,X0,PR0
         1 005360   760000 376003                    ANQ     -8192,DU
         1 005361   000000 656110                    ERSQ    0,X0,PR0

     1291     8903    3         END;

     1292     8904    2      FM$FIT.CODES.NDW(0)=FM$FIT.CODES.NDW(0)+K;

   8904  1 005362   000000 236100                    LDQ     0,,PR0
         1 005363   000012 772000                    QRL     10
         1 005364   001777 376007                    ANQ     1023,DL
         1 005365   200014 036100                    ADLQ    K,,AUTO
         1 005366   000012 736000                    QLS     10
         1 005367   000000 676100                    ERQ     0,,PR0
         1 005370   000032 376000 2                  ANQ     26
         1 005371   000000 656100                    ERSQ    0,,PR0

     1293     8905    2      FM$FIT.CODES.NAW(J)=FM$FIT.CODES.NAW(J)+K;

   8905  1 005372   200013 720100                    LXL0    J,,AUTO
         1 005373   000000 236110                    LDQ     0,X0,PR0
         1 005374   000024 772000                    QRL     20
         1 005375   001777 376007                    ANQ     1023,DL
         1 005376   200014 036100                    ADLQ    K,,AUTO
         1 005377   000024 736000                    QLS     20
         1 005400   000000 676110                    ERQ     0,X0,PR0
         1 005401   007774 376003                    ANQ     4092,DU
         1 005402   000000 656110                    ERSQ    0,X0,PR0

     1294     8906    2      J=0;

   8906  1 005403   200013 450100                    STZ     J,,AUTO

     1295     8907    3      DO WHILE (J<=FM$FIT.CODES.CODE(0));

   8907  1 005404   000000 236100                    LDQ     0,,PR0
         1 005405   000037 772000                    QRL     31
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:229  
         1 005406   200013 116100                    CMPQ    J,,AUTO
         1 005407   005446 602000 1                  TNC     s:8913

     1296     8908    3         IF FM$FIT.CODES.ITEMX(J)>=POFFW(LOC$,FIT$) AND

   8908  1 005410   200007 235100                    LDA     FIT$,,AUTO
         1 005411   000022 771000                    ARL     18
         1 005412   200052 755100                    STA     INDX+1,,AUTO
         1 005413   200005 236100                    LDQ     LOC$,,AUTO
         1 005414   000022 772000                    QRL     18
         1 005415   200052 136100                    SBLQ    INDX+1,,AUTO
         1 005416   200053 756100                    STQ     INDX+2,,AUTO
         1 005417   200007 470500                    LDP0    FIT$,,AUTO
         1 005420   200013 720100                    LXL0    J,,AUTO
         1 005421   000000 236110                    LDQ     0,X0,PR0
         1 005422   001777 376007                    ANQ     1023,DL
         1 005423   200053 116100                    CMPQ    INDX+2,,AUTO
         1 005424   005437 604000 1                  TMI     s:8911
         1 005425   000000 236110                    LDQ     0,X0,PR0
         1 005426   000037 772000                    QRL     31
         1 005427   200035 116100                    CMPQ    CODE,,AUTO
         1 005430   005437 600000 1                  TZE     s:8911

     1297     8909    3           FM$FIT.CODES.CODE(J)~=CODE THEN
     1298     8910    3            FM$FIT.CODES.ITEMX(J)=FM$FIT.CODES.ITEMX(J)+K;

   8910  1 005431   000000 236110                    LDQ     0,X0,PR0
         1 005432   001777 376007                    ANQ     1023,DL
         1 005433   200014 036100                    ADLQ    K,,AUTO
         1 005434   000000 676110                    ERQ     0,X0,PR0
         1 005435   001777 376007                    ANQ     1023,DL
         1 005436   000000 656110                    ERSQ    0,X0,PR0

     1299     8911    3         J=J+1;

   8911  1 005437   200013 236100                    LDQ     J,,AUTO
         1 005440   000001 036007                    ADLQ    1,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:230  
         1 005441   200013 756100                    STQ     J,,AUTO

     1300     8912    3         END;

   8912  1 005442   000000 236100                    LDQ     0,,PR0
         1 005443   000037 772000                    QRL     31
         1 005444   200013 116100                    CMPQ    J,,AUTO
         1 005445   005410 603000 1                  TRC     s:8908

     1301     8913    2      LOC$=PINCRW(BUF$,FM$GRAN.FCEX); /* POINT TO KEYTBL */

   8913  1 005446   200011 471500                    LDP1    BUF$,,AUTO
         1 005447   100002 220100                    LDX0    2,,PR1
         1 005450   000000 636010                    EAQ     0,X0
         1 005451   200011 036100                    ADLQ    BUF$,,AUTO
         1 005452   200005 756100                    STQ     LOC$,,AUTO

     1302     8914    3      IF (BUFNO~=1 OR CODE=1) AND FM$GRAN.KEYCNT~=0 THEN DO;

   8914  1 005453   200015 235100                    LDA     BUFNO,,AUTO
         1 005454   000001 115007                    CMPA    1,DL
         1 005455   005461 601000 1                  TNZ     s:8914+6
         1 005456   200035 235100                    LDA     CODE,,AUTO
         1 005457   000001 115007                    CMPA    1,DL
         1 005460   005537 601000 1                  TNZ     s:8925
         1 005461   100002 236100                    LDQ     2,,PR1
         1 005462   000777 316007                    CANQ    511,DL
         1 005463   005537 600000 1                  TZE     s:8925

     1303     8915    4         DO INDX=1 TO FM$GRAN.KEYCNT;

   8915  1 005464   000001 235007                    LDA     1,DL
         1 005465   200051 755100                    STA     INDX,,AUTO
         1 005466   005527 710000 1                  TRA     s:8922+2

     1304     8916    4            TMP=LOC$->FM$KEYTBL(INDX)+K; /* NEW VALUE */

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:231  
   8916  1 005467   200005 470500                    LDP0    LOC$,,AUTO
         1 005470   200051 235100                    LDA     INDX,,AUTO
         1 005471   000100 101505                    MRL     fill='000'O
         1 005472   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         1 005473   200052 000004                    ADSC9   INDX+1,,AUTO             cn=0,n=4
         1 005474   200052 236100                    LDQ     INDX+1,,AUTO
         1 005475   200014 036100                    ADLQ    K,,AUTO
         1 005476   200050 756100                    STQ     TMP,,AUTO

     1305     8917    4            IF INDX>=LOC$->FM$KEYTBL(0) THEN

   8917  1 005477   000000 236100                    LDQ     0,,PR0
         1 005500   000033 772000                    QRL     27
         1 005501   200051 116100                    CMPQ    INDX,,AUTO
         1 005502   005504 600000 1                  TZE     s:8918
         1 005503   005507 603000 1                  TRC     s:8919

     1306     8918    4               TMP=TMP+512;

   8918  1 005504   200050 235100                    LDA     TMP,,AUTO
         1 005505   001000 035007                    ADLA    512,DL
         1 005506   200050 755100                    STA     TMP,,AUTO

     1307     8919    4            IF TMP>=512 AND INDX<LOC$->FM$KEYTBL(0) THEN

   8919  1 005507   200050 235100                    LDA     TMP,,AUTO
         1 005510   001000 115007                    CMPA    512,DL
         1 005511   005520 602000 1                  TNC     s:8921
         1 005512   200051 116100                    CMPQ    INDX,,AUTO
         1 005513   005520 602000 1                  TNC     s:8921
         1 005514   005520 600000 1                  TZE     s:8921

     1308     8920    4               LOC$->FM$KEYTBL(0)=INDX; /* SET NEW BOUNDARY */

   8920  1 005515   200051 236100                    LDQ     INDX,,AUTO
         1 005516   000033 736000                    QLS     27
         1 005517   000000 552140                    STBQ    0,'40'O,PR0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:232  

     1309     8921    4            LOC$->FM$KEYTBL(INDX)=TMP;

   8921  1 005520   200005 470500                    LDP0    LOC$,,AUTO
         1 005521   200051 236100                    LDQ     INDX,,AUTO
         1 005522   000106 101500                    MRL     fill='000'O
         1 005523   200050 000004                    ADSC9   TMP,,AUTO                cn=0,n=4
         1 005524   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1

     1310     8922    4            END;

   8922  1 005525   000001 036007                    ADLQ    1,DL
         1 005526   200051 756100                    STQ     INDX,,AUTO
         1 005527   200011 470500                    LDP0    BUF$,,AUTO
         1 005530   000002 236100                    LDQ     2,,PR0
         1 005531   000777 376007                    ANQ     511,DL
         1 005532   200051 116100                    CMPQ    INDX,,AUTO
         1 005533   005467 603000 1                  TRC     s:8916

     1311     8923    3         F$DCB.MOVED=K;

   8923  1 005534   200014 720100                    LXL0    K,,AUTO
         1 005535   200004 471500                    LDP1    JDCB$,,AUTO
         1 005536   100104 740100                    STX0    68,,PR1

     1312     8924    3         END;

     1313     8925    2      GOTO FITSP0; /* REESTABLISH J,LOC$ */

   8925  1 005537   004720 710000 1                  TRA     FITSP0

   8918  1 005540                       FITSP$AFIT   null
     1314     8926        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:233  
     1315     8927    2   FITSP$AFIT:; /* NO ROOM HERE, TRY FOR AN AFIT */
     1316     8928    2      IF FM$GRAN.LVL=6

   8928  1 005540   000001 236100                    LDQ     1,,PR0
         1 005541   340000 376007                    ANQ     114688,DL
         1 005542   300000 116007                    CMPQ    98304,DL
         1 005543   005561 600000 1                  TZE     s:8933
         1 005544   200004 471500                    LDP1    JDCB$,,AUTO
         1 005545   100103 236100                    LDQ     67,,PR1
         1 005546   000777 376007                    ANQ     511,DL
         1 005547   000001 116007                    CMPQ    1,DL
         1 005550   005561 601000 1                  TNZ     s:8933
         1 005551   200010 473500                    LDP3    CFU$,,AUTO
         1 005552   300003 220100                    LDX0    3,,PR3
         1 005553   005561 600000 1                  TZE     s:8933
         1 005554   000002 236100                    LDQ     2,,PR0
         1 005555   000022 772000                    QRL     18
         1 005556   200014 036100                    ADLQ    K,,AUTO
         1 005557   002001 116007                    CMPQ    1025,DL
         1 005560   005570 602000 1                  TNC     s:8937

     1317     8929    2        OR F$DCB.IASN~=%FILE#
     1318     8930    2        OR FM$CFU.XTX=0
     1319     8931    2        OR FM$GRAN.FCEX+K>1024 THEN
     1320     8932    3      DO;      /* Already been here */

     1321     8933    3         IF B$JIT.ERR='0'B THEN

   8933  1 005561   000000 471400 xsym               LDP1    B$JIT$
         1 005562   100012 235100                    LDA     10,,PR1
         1 005563   005566 601000 1                  TNZ     s:8935

     1322     8934    3            B$JIT.ERR=FMO$E$VLPERR;

   8934  1 005564   000013 236000 0                  LDQ     FMO$E$VLPERR
         1 005565   100012 756100                    STQ     10,,PR1

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:234  
     1323     8935    3         ALTRETURN;

   8935  1 005566   200046 221300                    LDX1  ! FN+2,,AUTO
         1 005567   000000 702211                    TSX2  ! 0,X1

     1324     8936    3         END;
     1325     8937    2      CALL FAG$GAFIT(K)ALTRET(FITSP$GOTAFIT);

   8937  1 005570   200014 634500                    EPPR4   K,,AUTO
         1 005571   200052 454500                    STP4    INDX+1,,AUTO
         1 005572   200052 630500                    EPPR0   INDX+1,,AUTO
         1 005573   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005574   000000 701000 xent               TSX1    FAG$GAFIT
         1 005575   006162 702000 1                  TSX2    FITSP$GOTAFIT

     1326     8938    2      CALL FMN$GETFIT(BUF$,BUFNO);

   8938  1 005576   200015 630500                    EPPR0   BUFNO,,AUTO
         1 005577   200053 450500                    STP0    INDX+2,,AUTO
         1 005600   200011 631500                    EPPR1   BUF$,,AUTO
         1 005601   200052 451500                    STP1    INDX+1,,AUTO
         1 005602   200052 630500                    EPPR0   INDX+1,,AUTO
         1 005603   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005604   000000 701000 xent               TSX1    FMN$GETFIT
         1 005605   000000 011000                    NOP     0

     1327     8939    2      FIT$=BUF$; /* USE TWO BUFFERS IF WE'RE IN CLOSE */

   8939  1 005606   200011 236100                    LDQ     BUF$,,AUTO
         1 005607   200007 756100                    STQ     FIT$,,AUTO

     1328     8940    3      IF BUFNO~=4 THEN DO;

   8940  1 005610   200015 235100                    LDA     BUFNO,,AUTO
         1 005611   000004 115007                    CMPA    4,DL
         1 005612   005634 600000 1                  TZE     s:8946

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:235  
     1329     8941    3         CALL FMD$GETBUF(4,1,XT$);

   8941  1 005613   200017 236100                    LDQ     T$$,,AUTO
         1 005614   200054 756100                    STQ     INDX+3,,AUTO
         1 005615   000034 237000 2                  LDAQ    28
         1 005616   200052 757100                    STAQ    INDX+1,,AUTO
         1 005617   200052 630500                    EPPR0   INDX+1,,AUTO
         1 005620   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 005621   000000 701000 xent               TSX1    FMD$GETBUF
         1 005622   000000 011000                    NOP     0

     1330     8942    3         FIT$=T$;

   8942  1 005623   200016 236100                    LDQ     T$,,AUTO
         1 005624   200007 756100                    STQ     FIT$,,AUTO

     1331     8943    3         FIT$->GRAN=BUF$->GRAN;

   8943  1 005625   200011 470500                    LDP0    BUF$,,AUTO
         1 005626   010000 220003                    LDX0    4096,DU
         1 005627   200007 471500                    LDP1    FIT$,,AUTO
         1 005630   040140 100540                    MLR     fill='040'O
         1 005631   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 005632   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1332     8944    3         END;

   8944  1 005633   005667 710000 1                  TRA     s:8952

     1333     8945    3      ELSE DO;

     1334     8946    3         CALL FMD$FLSHBUF(BUFNO);

   8946  1 005634   200015 630500                    EPPR0   BUFNO,,AUTO
         1 005635   200052 450500                    STP0    INDX+1,,AUTO
         1 005636   200052 630500                    EPPR0   INDX+1,,AUTO
         1 005637   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:236  
         1 005640   000000 701000 xent               TSX1    FMD$FLSHBUF
         1 005641   000000 011000                    NOP     0

     1335     8947    3         J=FM$CFU.FITSDA;

   8947  1 005642   200010 470500                    LDP0    CFU$,,AUTO
         1 005643   000000 236100                    LDQ     0,,PR0
         1 005644   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 005645   200013 756100                    STQ     J,,AUTO

     1336     8948    3         F$DCB.GTYP=FMGTFIT;

   8948  1 005646   200004 471500                    LDP1    JDCB$,,AUTO
         1 005647   100064 236100                    LDQ     52,,PR1
         1 005650   000033 376000 2                  ANQ     27
         1 005651   024000 276003                    ORQ     10240,DU
         1 005652   100064 756100                    STQ     52,,PR1

     1337     8949    3         CALL FMD$REDBUFBC(XT$, BUFNO, J);

   8949  1 005653   200013 633500                    EPPR3   J,,AUTO
         1 005654   200054 453500                    STP3    INDX+3,,AUTO
         1 005655   200015 634500                    EPPR4   BUFNO,,AUTO
         1 005656   200053 454500                    STP4    INDX+2,,AUTO
         1 005657   200017 236100                    LDQ     T$$,,AUTO
         1 005660   200052 756100                    STQ     INDX+1,,AUTO
         1 005661   200052 630500                    EPPR0   INDX+1,,AUTO
         1 005662   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 005663   000000 701000 xent               TSX1    FMD$REDBUFBC
         1 005664   000000 011000                    NOP     0

     1338     8950    3         FIT$=T$;

   8950  1 005665   200016 236100                    LDQ     T$,,AUTO
         1 005666   200007 756100                    STQ     FIT$,,AUTO

     1339     8951    3         END;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:237  

     1340     8952    2      JDCB$->F$DCB.BFR.DA(4)=K;

   8952  1 005667   200004 470500                    LDP0    JDCB$,,AUTO
         1 005670   200014 236100                    LDQ     K,,AUTO
         1 005671   000121 552134                    STBQ    81,'34'O,PR0

     1341     8953    2      FIT$->FM$GRAN.LVL=6;

   8953  1 005672   200007 471500                    LDP1    FIT$,,AUTO
         1 005673   100001 236100                    LDQ     1,,PR1
         1 005674   000005 376000 2                  ANQ     5
         1 005675   300000 276007                    ORQ     98304,DL
         1 005676   100001 756100                    STQ     1,,PR1

     1342     8954    2      FIT$->FM$GRAN.STAMP.GMOD=K;

   8954  1 005677   200014 236100                    LDQ     K,,AUTO
         1 005700   100000 552104                    STBQ    0,'04'O,PR1

     1343     8955    2      FIT$->FM$GRAN.NAVX=FIT$->FM$GRAN.FCEX;

   8955  1 005701   100002 220100                    LDX0    2,,PR1
         1 005702   100001 740100                    STX0    1,,PR1

     1344     8956    2      FIT$->FM$GRAN.AVAIL=1024-FIT$->FM$GRAN.FCEX;

   8956  1 005703   100002 236100                    LDQ     2,,PR1
         1 005704   000022 772000                    QRL     18
         1 005705   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 005706   002001 036007                    ADLQ    1025,DL
         1 005707   100001 676100                    ERQ     1,,PR1
         1 005710   001777 376007                    ANQ     1023,DL
         1 005711   100001 656100                    ERSQ    1,,PR1

     1345     8957    2      FIT$->FM$GRAN.KEYCNT=0;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:238  
   8957  1 005712   000000 236003                    LDQ     0,DU
         1 005713   100002 552104                    STBQ    2,'04'O,PR1

     1346     8958    2      FIT$->FM$GRAN.FLINK=0;

   8958  1 005714   100004 450100                    STZ     4,,PR1

     1347     8959    2      CALL FMD$WRTSV(4);

   8959  1 005715   000013 630400 2                  EPPR0   11
         1 005716   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005717   000000 701000 xent               TSX1    FMD$WRTSV
         1 005720   000000 011000                    NOP     0

     1348     8960    3      IF MOD(FM$CFU.FUN,4)~=%CREATE# THEN DO;

   8960  1 005721   200010 470500                    LDP0    CFU$,,AUTO
         1 005722   000000 236100                    LDQ     0,,PR0
         1 005723   000041 772000                    QRL     33
         1 005724   000003 376007                    ANQ     3,DL
         1 005725   000003 116007                    CMPQ    3,DL
         1 005726   005742 600000 1                  TZE     s:8966

     1349     8961    3         J=FM$CFU.FITSDA;

   8961  1 005727   000000 236100                    LDQ     0,,PR0
         1 005730   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 005731   200013 756100                    STQ     J,,AUTO

     1350     8962    3         FM$CFU.FITSDA=K;

   8962  1 005732   200014 236100                    LDQ     K,,AUTO
         1 005733   000000 552134                    STBQ    0,'34'O,PR0

     1351     8963    3         CALL FMP$AFITCTG;

   8963  1 005734   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:239  
         1 005735   000000 701000 xent               TSX1    FMP$AFITCTG
         1 005736   000000 011000                    NOP     0

     1352     8964    3         FM$CFU.FITSDA=J;

   8964  1 005737   200010 470500                    LDP0    CFU$,,AUTO
         1 005740   200013 236100                    LDQ     J,,AUTO
         1 005741   000000 552134                    STBQ    0,'34'O,PR0

     1353     8965    3         END;

     1354     8966    2      IF F$DCB.IORG=%KEYED# OR (F$DCB.ACS=%BLOCK# AND (F$DCB.ORG=%KEYED#

   8966  1 005742   200004 471500                    LDP1    JDCB$,,AUTO
         1 005743   100070 236100                    LDQ     56,,PR1
         1 005744   077000 376003                    ANQ     32256,DU
         1 005745   002000 116003                    CMPQ    1024,DU
         1 005746   005763 600000 1                  TZE     s:8969
         1 005747   100036 236100                    LDQ     30,,PR1
         1 005750   000777 376007                    ANQ     511,DL
         1 005751   000003 116007                    CMPQ    3,DL
         1 005752   006155 601000 1                  TNZ     s:8996
         1 005753   100032 236100                    LDQ     26,,PR1
         1 005754   777000 376003                    ANQ     -512,DU
         1 005755   002000 116003                    CMPQ    1024,DU
         1 005756   005763 600000 1                  TZE     s:8969
         1 005757   006000 116003                    CMPQ    3072,DU
         1 005760   005763 600000 1                  TZE     s:8969
         1 005761   015000 116003                    CMPQ    6656,DU
         1 005762   006155 601000 1                  TNZ     s:8996

     1355     8967    2        OR F$DCB.ORG=%INDEXED# OR F$DCB.ORG=%IREL#)) THEN
     1356     8968    3      DO;

     1357     8969    3         CALL FMN$GETFIT(BUF$,BUFNO);

   8969  1 005763   200015 633500                    EPPR3   BUFNO,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:240  
         1 005764   200053 453500                    STP3    INDX+2,,AUTO
         1 005765   200011 634500                    EPPR4   BUF$,,AUTO
         1 005766   200052 454500                    STP4    INDX+1,,AUTO
         1 005767   200052 630500                    EPPR0   INDX+1,,AUTO
         1 005770   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005771   000000 701000 xent               TSX1    FMN$GETFIT
         1 005772   000000 011000                    NOP     0

     1358     8970    3         J=SIZEW(FM$GRAN)-FM$GRAN.FCEX; /* SQUEEZE FIT OUT OF FRZERO */

   8970  1 005773   200011 470500                    LDP0    BUF$,,AUTO
         1 005774   000002 236100                    LDQ     2,,PR0
         1 005775   000022 772000                    QRL     18
         1 005776   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 005777   000006 036007                    ADLQ    6,DL
         1 006000   200013 756100                    STQ     J,,AUTO

     1359     8971    3         FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));

   8971  1 006001   200011 236100                    LDQ     BUF$,,AUTO
         1 006002   000005 036003                    ADLQ    5,DU
         1 006003   200007 756100                    STQ     FIT$,,AUTO

     1360     8972    3         T$=FIT$;

   8972  1 006004   200016 756100                    STQ     T$,,AUTO

     1361     8973    3         CALL FMR$SLIDE(XT$,J,FM$GRAN.NAVX-FM$GRAN.FCEX);

   8973  1 006005   000002 236100                    LDQ     2,,PR0
         1 006006   000022 772000                    QRL     18
         1 006007   200052 756100                    STQ     INDX+1,,AUTO
         1 006010   000001 236100                    LDQ     1,,PR0
         1 006011   000022 772000                    QRL     18
         1 006012   200052 136100                    SBLQ    INDX+1,,AUTO
         1 006013   200053 756100                    STQ     INDX+2,,AUTO
         1 006014   200053 631500                    EPPR1   INDX+2,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:241  
         1 006015   200056 451500                    STP1    INDX+5,,AUTO
         1 006016   200013 633500                    EPPR3   J,,AUTO
         1 006017   200055 453500                    STP3    INDX+4,,AUTO
         1 006020   200017 236100                    LDQ     T$$,,AUTO
         1 006021   200054 756100                    STQ     INDX+3,,AUTO
         1 006022   200054 630500                    EPPR0   INDX+3,,AUTO
         1 006023   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 006024   000000 701000 xent               TSX1    FMR$SLIDE
         1 006025   000000 011000                    NOP     0

     1362     8974    3         FM$GRAN.NAVX=FM$GRAN.NAVX+J;

   8974  1 006026   200011 470500                    LDP0    BUF$,,AUTO
         1 006027   000001 236100                    LDQ     1,,PR0
         1 006030   000022 772000                    QRL     18
         1 006031   200013 036100                    ADLQ    J,,AUTO
         1 006032   000000 620006                    EAX0    0,QL
         1 006033   000001 740100                    STX0    1,,PR0

     1363     8975    3         FM$GRAN.AVAIL=FM$GRAN.AVAIL-J;

   8975  1 006034   200011 470500                    LDP0    BUF$,,AUTO
         1 006035   000001 236100                    LDQ     1,,PR0
         1 006036   001777 376007                    ANQ     1023,DL
         1 006037   200013 136100                    SBLQ    J,,AUTO
         1 006040   000001 676100                    ERQ     1,,PR0
         1 006041   001777 376007                    ANQ     1023,DL
         1 006042   000001 656100                    ERSQ    1,,PR0

     1364     8976    3         FM$GRAN.FCEX=SIZEW(FM$GRAN);

   8976  1 006043   000005 220003                    LDX0    5,DU
         1 006044   200011 470500                    LDP0    BUF$,,AUTO
         1 006045   000002 740100                    STX0    2,,PR0

     1365     8977    3         INDX=FM$GRAN.KEYCNT;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:242  
   8977  1 006046   200011 470500                    LDP0    BUF$,,AUTO
         1 006047   000002 236100                    LDQ     2,,PR0
         1 006050   000777 376007                    ANQ     511,DL
         1 006051   200051 756100                    STQ     INDX,,AUTO

     1366     8978    4         DO WHILE(INDX>0);

   8978  1 006052   006114 600000 1                  TZE     s:8987

     1367     8979    4            TMP=FIT$->FM$KEYTBL(INDX)+J;

   8979  1 006053   200007 470500                    LDP0    FIT$,,AUTO
         1 006054   200051 235100                    LDA     INDX,,AUTO
         1 006055   000100 101505                    MRL     fill='000'O
         1 006056   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         1 006057   200052 000004                    ADSC9   INDX+1,,AUTO             cn=0,n=4
         1 006060   200052 236100                    LDQ     INDX+1,,AUTO
         1 006061   200013 036100                    ADLQ    J,,AUTO
         1 006062   200050 756100                    STQ     TMP,,AUTO

     1368     8980    4            IF INDX>=FIT$->FM$KEYTBL(0) THEN

   8980  1 006063   000000 236100                    LDQ     0,,PR0
         1 006064   000033 772000                    QRL     27
         1 006065   200051 116100                    CMPQ    INDX,,AUTO
         1 006066   006070 600000 1                  TZE     s:8981
         1 006067   006073 603000 1                  TRC     s:8982

     1369     8981    4               TMP=TMP+512;

   8981  1 006070   200050 235100                    LDA     TMP,,AUTO
         1 006071   001000 035007                    ADLA    512,DL
         1 006072   200050 755100                    STA     TMP,,AUTO

     1370     8982    4            IF TMP<512 AND INDX>=FIT$->FM$KEYTBL(0) THEN

   8982  1 006073   200050 235100                    LDA     TMP,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:243  
         1 006074   001000 115007                    CMPA    512,DL
         1 006075   006105 603000 1                  TRC     s:8984
         1 006076   200051 116100                    CMPQ    INDX,,AUTO
         1 006077   006101 600000 1                  TZE     s:8983
         1 006100   006105 603000 1                  TRC     s:8984

     1371     8983    4               FIT$->FM$KEYTBL(0)=INDX+1;

   8983  1 006101   200051 236100                    LDQ     INDX,,AUTO
         1 006102   000001 036007                    ADLQ    1,DL
         1 006103   000033 736000                    QLS     27
         1 006104   000000 552140                    STBQ    0,'40'O,PR0

     1372     8984    4            FIT$->FM$KEYTBL(INDX)=TMP;

   8984  1 006105   200051 236100                    LDQ     INDX,,AUTO
         1 006106   000106 101500                    MRL     fill='000'O
         1 006107   200050 000004                    ADSC9   TMP,,AUTO                cn=0,n=4
         1 006110   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1

     1373     8985    4            INDX=INDX-1;

   8985  1 006111   000001 136007                    SBLQ    1,DL
         1 006112   200051 756100                    STQ     INDX,,AUTO

     1374     8986    4            END;

   8986  1 006113   006053 601000 1                  TNZ     s:8979

     1375     8987    3         F$DCB.MOVED=J;

   8987  1 006114   200013 720100                    LXL0    J,,AUTO
         1 006115   200004 470500                    LDP0    JDCB$,,AUTO
         1 006116   000104 740100                    STX0    68,,PR0

     1376     8988    3         IF FIT$->FM$KEYTBL(0)>FM$GRAN.KEYCNT THEN

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:244  
   8988  1 006117   200007 471500                    LDP1    FIT$,,AUTO
         1 006120   100000 236100                    LDQ     0,,PR1
         1 006121   000033 772000                    QRL     27
         1 006122   200052 756100                    STQ     INDX+1,,AUTO
         1 006123   200011 473500                    LDP3    BUF$,,AUTO
         1 006124   300002 236100                    LDQ     2,,PR3
         1 006125   000777 376007                    ANQ     511,DL
         1 006126   200052 116100                    CMPQ    INDX+1,,AUTO
         1 006127   006132 605000 1                  TPL     s:8990

     1377     8989    3            FIT$->FM$KEYTBL(0)=SIZEC(FM$KEYTBL);

   8989  1 006130   430000 236003                    LDQ     -118784,DU
         1 006131   100000 552140                    STBQ    0,'40'O,PR1

     1378     8990    3         F$DCB.BFR.SCRUB(BUFNO)='1'B;

   8990  1 006132   200015 720100                    LXL0    BUFNO,,AUTO
         1 006133   200000 236003                    LDQ     65536,DU
         1 006134   000115 256110                    ORSQ    77,X0,PR0

     1379     8991    4         IF BUFNO=1 THEN DO;

   8991  1 006135   200015 235100                    LDA     BUFNO,,AUTO
         1 006136   000001 115007                    CMPA    1,DL
         1 006137   006147 601000 1                  TNZ     s:8994

     1380     8992    4            CALL FMD$WRTSV(BUFNO);

   8992  1 006140   200015 633500                    EPPR3   BUFNO,,AUTO
         1 006141   200052 453500                    STP3    INDX+1,,AUTO
         1 006142   200052 630500                    EPPR0   INDX+1,,AUTO
         1 006143   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006144   000000 701000 xent               TSX1    FMD$WRTSV
         1 006145   000000 011000                    NOP     0

     1381     8993    4            END;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:245  

   8993  1 006146   006155 710000 1                  TRA     s:8996

     1382     8994    3         ELSE CALL FMD$WRTBUF(BUFNO);

   8994  1 006147   200015 633500                    EPPR3   BUFNO,,AUTO
         1 006150   200052 453500                    STP3    INDX+1,,AUTO
         1 006151   200052 630500                    EPPR0   INDX+1,,AUTO
         1 006152   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006153   000000 701000 xent               TSX1    FMD$WRTBUF
         1 006154   000000 011000                    NOP     0

     1383     8995    3         END;

     1384     8996    2      FM$CFU.AFIT=1;

   8996  1 006155   200010 470500                    LDP0    CFU$,,AUTO
         1 006156   001000 236003                    LDQ     512,DU
         1 006157   000000 256100                    ORSQ    0,,PR0

     1385     8997    2      FM$CFU.FITSDA=K; /* SET THE NEW FITDA */

   8997  1 006160   200014 236100                    LDQ     K,,AUTO
         1 006161   000000 552134                    STBQ    0,'34'O,PR0

   8997  1 006162                       FITSP$GOTAF* null
     1386     8998    2   FITSP$GOTAFIT:;
     1387     8999    2      IF F$DCB.IASN=%FILE# THEN CALL FMN$GETFIT(BUF$,BUFNO);

   8999  1 006162   200004 470500                    LDP0    JDCB$,,AUTO
         1 006163   000103 236100                    LDQ     67,,PR0
         1 006164   000777 376007                    ANQ     511,DL
         1 006165   000001 116007                    CMPQ    1,DL
         1 006166   006177 601000 1                  TNZ     s:9000

   8999  1 006167   200015 631500                    EPPR1   BUFNO,,AUTO
         1 006170   200053 451500                    STP1    INDX+2,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:246  
         1 006171   200011 633500                    EPPR3   BUF$,,AUTO
         1 006172   200052 453500                    STP3    INDX+1,,AUTO
         1 006173   200052 630500                    EPPR0   INDX+1,,AUTO
         1 006174   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006175   000000 701000 xent               TSX1    FMN$GETFIT
         1 006176   000000 011000                    NOP     0

     1388     9000    2      FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));

   9000  1 006177   200011 236100                    LDQ     BUF$,,AUTO
         1 006200   000005 036003                    ADLQ    5,DU
         1 006201   200007 756100                    STQ     FIT$,,AUTO

     1389     9001    2      IF B$JIT.ERR='0'B THEN GOTO FITSP0; /* AT LAST..TRY AGAIN */

   9001  1 006202   000000 470400 xsym               LDP0    B$JIT$
         1 006203   000012 235100                    LDA     10,,PR0
         1 006204   004720 600000 1                  TZE     FITSP0

     1390     9002    2      ALTRETURN;

   9002  1 006205   200046 221300                    LDX1  ! FN+2,,AUTO
         1 006206   000000 702211                    TSX2  ! 0,X1

     1391     9003    2   END FMO$FITSPACE;
     1392     9004        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:247  
     1393     9005                    /*F*
     1394     9006                    *     NAME:   FMO$MODFIT
     1395     9007                    *
     1396     9008                    *     PURPOSE:  TO MODIFY THE FIT AT CLOSE TIME FROM THE INFORMATION
     1397     9009                    *             IN THE CFU AND THE DCB.
     1398     9010                    */
     1399     9011    1   FMO$MODFIT: ENTRY(DUMMY) ALTRET;

   9011  1 006207   000000 700200 xent  FMO$MODFIT   TSX0  ! X66_AUTO_1
         1 006210   000062 000001                    ZERO    50,1

     1400     9012    1      JDCB$=B$JIT$->B$JIT.DCB$;

   9012  1 006211   000000 470400 xsym               LDP0    B$JIT$
         1 006212   000232 236100                    LDQ     154,,PR0
         1 006213   200004 756100                    STQ     JDCB$,,AUTO

     1401     9013    1      CFU$=JDCB$->F$DCB.CFU$;

   9013  1 006214   200004 471500                    LDP1    JDCB$,,AUTO
         1 006215   100066 236100                    LDQ     54,,PR1
         1 006216   200010 756100                    STQ     CFU$,,AUTO

     1402     9014    1      T$$=ADDR(T$);

   9014  1 006217   200016 633500                    EPPR3   T$,,AUTO
         1 006220   200017 453500                    STP3    T$$,,AUTO

     1403     9015    1      BUFNO=0;

   9015  1 006221   200015 450100                    STZ     BUFNO,,AUTO

     1404     9016    1      J=0;     /* INDICATE NO EXTENT TO RELEASE */

   9016  1 006222   200013 450100                    STZ     J,,AUTO

     1405     9017    1      IF FM$CFU.XTX=0 THEN GOTO ALLDONE;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:248  

   9017  1 006223   200010 474500                    LDP4    CFU$,,AUTO
         1 006224   400003 220100                    LDX0    3,,PR4
         1 006225   011150 600000 1                  TZE     ALLDONE

     1406     9018    1      CALL FMR$L8; /* MAKE SURE CFU IS FILLED IN */

   9018  1 006226   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006227   000000 701000 xent               TSX1    FMR$L8
         1 006230   000000 011000                    NOP     0

     1407     9019    1      CALL FMR$U8;

   9019  1 006231   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006232   000000 701000 xent               TSX1    FMR$U8
         1 006233   000000 011000                    NOP     0

     1408     9020    2      IF JDCB$->F$DCB.SHARED THEN DO; /* THERE MAY BE A RACE TO DO THIS */

   9020  1 006234   200004 470500                    LDP0    JDCB$,,AUTO
         1 006235   000064 236100                    LDQ     52,,PR0
         1 006236   100000 316003                    CANQ    32768,DU
         1 006237   006332 600000 1                  TZE     s:9037

     1409     9021    2         CALL UQB$MENQX(F$DCB.CFU$);

   9021  1 006240   200004 236100                    LDQ     JDCB$,,AUTO
         1 006241   000066 036003                    ADLQ    54,DU
         1 006242   200052 756100                    STQ     INDX+1,,AUTO
         1 006243   200052 630500                    EPPR0   INDX+1,,AUTO
         1 006244   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006245   000000 701000 xent               TSX1    UQB$MENQX
         1 006246   000000 011000                    NOP     0

     1410     9022    3         IF FM$CFU.FUN=%JRNL# AND FM$CFUJ.PAGE#~=0 THEN DO;

   9022  1 006247   200010 470500                    LDP0    CFU$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:249  
         1 006250   000000 236100                    LDQ     0,,PR0
         1 006251   700000 376003                    ANQ     -32768,DU
         1 006252   400000 116003                    CMPQ    -131072,DU
         1 006253   006275 601000 1                  TNZ     s:9028
         1 006254   000005 720100                    LXL0    5,,PR0
         1 006255   006275 600000 1                  TZE     s:9028

     1411     9023    3            F$DCB.BFR.DA(1)=FM$CFU.LDA;

   9023  1 006256   200004 471500                    LDP1    JDCB$,,AUTO
         1 006257   000006 235100                    LDA     6,,PR0
         1 006260   000007 236100                    LDQ     7,,PR0
         1 006261   000033 773000                    LRL     27
         1 006262   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 006263   100116 552134                    STBQ    78,'34'O,PR1

     1412     9024    3            CALL FMH$MAPJRNL(1);

   9024  1 006264   000000 630400 2                  EPPR0   0
         1 006265   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006266   000000 701000 xent               TSX1    FMH$MAPJRNL
         1 006267   000000 011000                    NOP     0

     1413     9025    3            CALL FMD$FLSHBUF(4);

   9025  1 006270   000013 630400 2                  EPPR0   11
         1 006271   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006272   000000 701000 xent               TSX1    FMD$FLSHBUF
         1 006273   000000 011000                    NOP     0

     1414     9026    3            END;

   9026  1 006274   006332 710000 1                  TRA     s:9037

     1415     9027    3         ELSE DO;

     1416     9028    3            CALL FMU$BLD; /* Try again in case the last two closers tied */
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:250  

   9028  1 006275   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006276   000000 701000 xent               TSX1    FMU$BLD
         1 006277   000000 011000                    NOP     0

     1417     9029    3            IF FM$CFU.MODCNT=F$DCB.MODCNT THEN EXIT;

   9029  1 006300   200004 470500                    LDP0    JDCB$,,AUTO
         1 006301   000100 236100                    LDQ     64,,PR0
         1 006302   000022 772000                    QRL     18
         1 006303   200052 756100                    STQ     INDX+1,,AUTO
         1 006304   200010 471500                    LDP1    CFU$,,AUTO
         1 006305   100006 236100                    LDQ     6,,PR1
         1 006306   000025 772000                    QRL     21
         1 006307   200052 116100                    CMPQ    INDX+1,,AUTO
         1 006310   006332 600000 1                  TZE     s:9037

     1418     9030    3            BUFNO=5;

   9030  1 006311   000005 235007                    LDA     5,DL
         1 006312   200015 755100                    STA     BUFNO,,AUTO

     1419     9031    4            DO UNTIL(BUFNO=1);

     1420     9032    4               BUFNO=BUFNO-1;

   9032  1 006313   000001 336007                    LCQ     1,DL
         1 006314   200015 056100                    ASQ     BUFNO,,AUTO

     1421     9033    4               IF F$DCB.BFR1.CX(BUFNO)=0 THEN CALL FMD$FLSHBUF(BUFNO);

   9033  1 006315   200004 470500                    LDP0    JDCB$,,AUTO
         1 006316   200015 720100                    LXL0    BUFNO,,AUTO
         1 006317   000122 721110                    LXL1    82,X0,PR0
         1 006320   006327 601000 1                  TNZ     s:9034

   9033  1 006321   200015 631500                    EPPR1   BUFNO,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:251  
         1 006322   200052 451500                    STP1    INDX+1,,AUTO
         1 006323   200052 630500                    EPPR0   INDX+1,,AUTO
         1 006324   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006325   000000 701000 xent               TSX1    FMD$FLSHBUF
         1 006326   000000 011000                    NOP     0

     1422     9034    4               END;

   9034  1 006327   200015 235100                    LDA     BUFNO,,AUTO
         1 006330   000001 115007                    CMPA    1,DL
         1 006331   006313 601000 1                  TNZ     s:9032

     1423     9035    3            END;

     1424     9036    2         END;

     1425     9037    1      IF F$DCB.FUN=%IN#

   9037  1 006332   200004 470500                    LDP0    JDCB$,,AUTO
         1 006333   000032 236100                    LDQ     26,,PR0
         1 006334   000777 376003                    ANQ     511,DU
         1 006335   000002 116003                    CMPQ    2,DU
         1 006336   006346 601000 1                  TNZ     s:9037+12
         1 006337   200010 471500                    LDP1    CFU$,,AUTO
         1 006340   100003 720100                    LXL0    3,,PR1
         1 006341   000002 100003                    CMPX0   2,DU
         1 006342   011150 603000 1                  TRC     ALLDONE
         1 006343   000000 473400 xsym               LDP3    B$JIT$
         1 006344   300013 234100                    SZN     11,,PR3
         1 006345   011150 604000 1                  TMI     ALLDONE
         1 006346   200010 471500                    LDP1    CFU$,,AUTO
         1 006347   100000 236100                    LDQ     0,,PR1
         1 006350   000032 316000 xsym               CANQ    B_VECTNIL+26
         1 006351   011150 600000 1                  TZE     ALLDONE
         1 006352   000064 236100                    LDQ     52,,PR0
         1 006353   200000 316003                    CANQ    65536,DU
         1 006354   006365 600000 1                  TZE     s:9045
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:252  
         1 006355   100000 236100                    LDQ     0,,PR1
         1 006356   004000 316003                    CANQ    2048,DU
         1 006357   006365 601000 1                  TNZ     s:9045
         1 006360   200003 473500                    LDP3    @DUMMY,,AUTO
         1 006361   300000 474500                    LDP4    0,,PR3
         1 006362   400000 236100                    LDQ     0,,PR4
         1 006363   700000 316007                    CANQ    -32768,DL
         1 006364   011150 600000 1                  TZE     ALLDONE

     1426     9038    1        AND (FM$CFU.USECNT>1
     1427     9039    1        OR B$JIT.PRIV.ACTIVE.FMEFT)
     1428     9040    1        OR FM$CFU.FITSDA=0
     1429     9041    1        OR F$DCB.STARF
     1430     9042    1        AND NOT FM$CFU.FMOD
     1431     9043    1        AND NOT FPT$CLOSE_V.OPER
     1432     9044    1      THEN GOTO ALLDONE;
     1433     9045    1      CALL FMN$GETFIT(BUF$,BUFNO)ALTRET(FMOALTRET);

   9045  1 006365   200015 633500                    EPPR3   BUFNO,,AUTO
         1 006366   200053 453500                    STP3    INDX+2,,AUTO
         1 006367   200011 634500                    EPPR4   BUF$,,AUTO
         1 006370   200052 454500                    STP4    INDX+1,,AUTO
         1 006371   200052 630500                    EPPR0   INDX+1,,AUTO
         1 006372   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006373   000000 701000 xent               TSX1    FMN$GETFIT
         1 006374   013126 702000 1                  TSX2    FMOALTRET

     1434     9046    1      CALL FMD$FLSHBUF(2-BUFNO/2); /* DONT USE ALL FIVE BUFFERS */

   9046  1 006375   200015 236100                    LDQ     BUFNO,,AUTO
         1 006376   000002 506007                    DIV     2,DL
         1 006377   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 006400   000003 036007                    ADLQ    3,DL
         1 006401   200052 756100                    STQ     INDX+1,,AUTO
         1 006402   200052 630500                    EPPR0   INDX+1,,AUTO
         1 006403   200053 450500                    STP0    INDX+2,,AUTO
         1 006404   200053 630500                    EPPR0   INDX+2,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:253  
         1 006405   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006406   000000 701000 xent               TSX1    FMD$FLSHBUF
         1 006407   000000 011000                    NOP     0

     1435     9047    1      FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));

   9047  1 006410   200011 236100                    LDQ     BUF$,,AUTO
         1 006411   000005 036003                    ADLQ    5,DU
         1 006412   200007 756100                    STQ     FIT$,,AUTO

     1436     9048    1      LOCCODX=3;

   9048  1 006413   000003 235007                    LDA     3,DL
         1 006414   200020 755100                    STA     LOCCODX,,AUTO

     1437     9049    1      CALL LOCCODP ALTRET(DONE);

   9049  1 006415   002543 701000 1                  TSX1    LOCCODP
         1 006416   011040 702000 1                  TSX2    DONE

     1438     9050    1      F$DCB.XTNSIZE=CODE03.XTNSIZE; /* M$EXTEND TRASHES THIS */

   9050  1 006417   200005 470500                    LDP0    LOC$,,AUTO
         1 006420   000005 220100                    LDX0    5,,PR0
         1 006421   200004 471500                    LDP1    JDCB$,,AUTO
         1 006422   100037 740100                    STX0    31,,PR1

     1439     9051    2      IF FPT$CLOSE_V.OPER.CHGATT THEN DO;

   9051  1 006423   200003 473500                    LDP3    @DUMMY,,AUTO
         1 006424   300000 474500                    LDP4    0,,PR3
         1 006425   400000 236100                    LDQ     0,,PR4
         1 006426   400000 316007                    CANQ    -131072,DL
         1 006427   007135 600000 1                  TZE     s:9141

     1440     9052    2         F$DCB.GHSTACS=CODE03.GHSTACS;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:254  
   9052  1 006430   000004 236100                    LDQ     4,,PR0
         1 006431   000011 772000                    QRL     9
         1 006432   100052 676100                    ERQ     42,,PR1
         1 006433   000017 376003                    ANQ     15,DU
         1 006434   100052 656100                    ERSQ    42,,PR1

     1441     9053    2         IF PN$.IFPARAM_~=ADDR(NIL) THEN CALL FMM$IFPARAM(PN$);

   9053  1 006435   300013 236100                    LDQ     11,,PR3
         1 006436   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 006437   006444 600000 1                  TZE     s:9054

   9053  1 006440   200003 630500                    EPPR0   @DUMMY,,AUTO
         1 006441   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006442   000000 701000 xent               TSX1    FMM$IFPARAM
         1 006443   000000 011000                    NOP     0

     1442     9054    2         IF FPT$CLOSE_V.TYPE~=BINASC(0)

   9054  1 006444   200003 470500                    LDP0    @DUMMY,,AUTO
         1 006445   000000 471500                    LDP1    0,,PR0
         1 006446   100001 720100                    LXL0    1,,PR1
         1 006447   000040 100003                    CMPX0   32,DU
         1 006450   006475 600000 1                  TZE     s:9060
         1 006451   100001 236100                    LDQ     1,,PR1
         1 006452   777000 376007                    ANQ     -512,DL
         1 006453   052000 116007                    CMPQ    21504,DL
         1 006454   006462 600000 1                  TZE     s:9054+14
         1 006455   200005 473500                    LDP3    LOC$,,AUTO
         1 006456   300001 236100                    LDQ     1,,PR3
         1 006457   777000 376007                    ANQ     -512,DL
         1 006460   052000 116007                    CMPQ    21504,DL
         1 006461   006473 601000 1                  TNZ     s:9059
         1 006462   200004 473500                    LDP3    JDCB$,,AUTO
         1 006463   300040 236100                    LDQ     32,,PR3
         1 006464   000777 376003                    ANQ     511,DU
         1 006465   000002 116003                    CMPQ    2,DU
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:255  
         1 006466   006473 602000 1                  TNC     s:9059
         1 006467   000000 474400 xsym               LDP4    B$JIT$
         1 006470   400013 236100                    LDQ     11,,PR4
         1 006471   100000 316003                    CANQ    32768,DU
         1 006472   006475 600000 1                  TZE     s:9060

     1443     9055    2           AND (SUBSTR(FPT$CLOSE_V.TYPE,0,1)~='*'
     1444     9056    2           AND SUBSTR(CODE03.TYPE,0,1)~='*'
     1445     9057    2           OR F$DCB.WSR<2
     1446     9058    2           OR B$JIT.PRIV.ACTIVE.FMSEC)
     1447     9059    2         THEN F$DCB.TYPE=FPT$CLOSE_V.TYPE;

   9059  1 006473   200004 473500                    LDP3    JDCB$,,AUTO
         1 006474   300025 440100                    SXL0    21,,PR3

     1448     9060    2         IF FPT$CLOSE_V.XTNSIZE~=0 THEN F$DCB.XTNSIZE=FPT$CLOSE_V.XTNSIZE;

   9060  1 006475   000000 471500                    LDP1    0,,PR0
         1 006476   100001 220100                    LDX0    1,,PR1
         1 006477   006502 600000 1                  TZE     s:9061

   9060  1 006500   200004 473500                    LDP3    JDCB$,,AUTO
         1 006501   300037 740100                    STX0    31,,PR3

     1449     9061    2         F$DCB.DESC=CODE03.DESC;

   9061  1 006502   200005 471500                    LDP1    LOC$,,AUTO
         1 006503   100001 220100                    LDX0    1,,PR1
         1 006504   200004 473500                    LDP3    JDCB$,,AUTO
         1 006505   300005 440100                    SXL0    5,,PR3

     1450     9062    2         IF NOT FPT$CLOSE_V.BUPM&'01'B THEN F$DCB.DESC.BUPM=FPT$CLOSE_V.BUPM;

   9062  1 006506   000000 471500                    LDP1    0,,PR0
         1 006507   100002 236100                    LDQ     2,,PR1
         1 006510   000011 736000                    QLS     9
         1 006511   600000 376003                    ANQ     -65536,DU
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:256  
         1 006512   200000 376003                    ANQ     65536,DU
         1 006513   006521 601000 1                  TNZ     s:9063

   9062  1 006514   100002 236100                    LDQ     2,,PR1
         1 006515   000022 772000                    QRL     18
         1 006516   300005 676100                    ERQ     5,,PR3
         1 006517   000400 376007                    ANQ     256,DL
         1 006520   300005 656100                    ERSQ    5,,PR3

     1451     9063    2         F$DCB.DESC.BUF=F$DCB.DESC.BUPM;

   9063  1 006521   300005 236100                    LDQ     5,,PR3
         1 006522   000007 736000                    QLS     7
         1 006523   300005 676100                    ERQ     5,,PR3
         1 006524   100000 376007                    ANQ     32768,DL
         1 006525   300005 656100                    ERSQ    5,,PR3

     1452     9064    2         IF FPT$CLOSE_V.EXPIRE~=0 THEN F$DCB.EXPIRE=FPT$CLOSE_V.EXPIRE;

   9064  1 006526   000000 471500                    LDP1    0,,PR0
         1 006527   100002 720100                    LXL0    2,,PR1
         1 006530   006535 600000 1                  TZE     s:9065

   9064  1 006531   100002 236100                    LDQ     2,,PR1
         1 006532   000022 736000                    QLS     18
         1 006533   000022 732000                    QRS     18
         1 006534   300035 756100                    STQ     29,,PR3

     1453     9065    2         IF (F$DCB.EXPIRE>B$JIT.MAXEXP OR F$DCB.EXPIRE<0) AND B$JIT.MAXEXP>=0

   9065  1 006535   000000 471400 xsym               LDP1    B$JIT$
         1 006536   100221 236100                    LDQ     145,,PR1
         1 006537   000022 736000                    QLS     18
         1 006540   000022 732000                    QRS     18
         1 006541   300035 116100                    CMPQ    29,,PR3
         1 006542   006545 604000 1                  TMI     s:9065+8
         1 006543   300035 235100                    LDA     29,,PR3
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:257  
         1 006544   006553 605000 1                  TPL     s:9067
         1 006545   100221 720100                    LXL0    145,,PR1
         1 006546   006553 604000 1                  TMI     s:9067

     1454     9066    2         THEN F$DCB.EXPIRE=CODE03.EXPIRE;

   9066  1 006547   200005 474500                    LDP4    LOC$,,AUTO
         1 006550   400007 236100                    LDQ     7,,PR4
         1 006551   000022 732000                    QRS     18
         1 006552   300035 756100                    STQ     29,,PR3

     1455     9067    2         IF FPT$CLOSE_V.GHSTACS~=0 THEN F$DCB.GHSTACS=FPT$CLOSE_V.GHSTACS;

   9067  1 006553   000000 474500                    LDP4    0,,PR0
         1 006554   400002 236100                    LDQ     2,,PR4
         1 006555   000017 316003                    CANQ    15,DU
         1 006556   006562 600000 1                  TZE     s:9068

   9067  1 006557   300052 676100                    ERQ     42,,PR3
         1 006560   000017 376003                    ANQ     15,DU
         1 006561   300052 656100                    ERSQ    42,,PR3

     1456     9068    2         IF F$DCB.GHSTACS=%NONE# THEN F$DCB.GHSTACS=0;

   9068  1 006562   300052 236100                    LDQ     42,,PR3
         1 006563   000017 376003                    ANQ     15,DU
         1 006564   000003 116003                    CMPQ    3,DU
         1 006565   006570 601000 1                  TNZ     s:9069

   9068  1 006566   000015 236000 2                  LDQ     13
         1 006567   300052 356100                    ANSQ    42,,PR3

     1457     9069    2         IF F$DCB.DESC.BUPM~=CODE03.DESC.BUPM

   9069  1 006570   200005 474500                    LDP4    LOC$,,AUTO
         1 006571   000100 066500                    CMPB    filb='0'B
         1 006572   300005 600001                    BDSC    5,,PR3                   by=3,bit=0,n=1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:258  
         1 006573   400001 200001                    BDSC    1,,PR4                   by=1,bit=0,n=1
         1 006574   006621 601000 1                  TNZ     s:9074
         1 006575   300025 236100                    LDQ     21,,PR3
         1 006576   400001 676100                    ERQ     1,,PR4
         1 006577   777777 376007                    ANQ     -1,DL
         1 006600   006621 601000 1                  TNZ     s:9074
         1 006601   400007 236100                    LDQ     7,,PR4
         1 006602   000022 732000                    QRS     18
         1 006603   300035 116100                    CMPQ    29,,PR3
         1 006604   006621 601000 1                  TNZ     s:9074
         1 006605   400004 236100                    LDQ     4,,PR4
         1 006606   000033 772000                    QRL     27
         1 006607   000017 376007                    ANQ     15,DL
         1 006610   200052 756100                    STQ     INDX+1,,AUTO
         1 006611   300052 236100                    LDQ     42,,PR3
         1 006612   000022 772000                    QRL     18
         1 006613   000017 376007                    ANQ     15,DL
         1 006614   200052 116100                    CMPQ    INDX+1,,AUTO
         1 006615   006621 601000 1                  TNZ     s:9074
         1 006616   300037 220100                    LDX0    31,,PR3
         1 006617   400005 100100                    CMPX0   5,,PR4
         1 006620   006673 600000 1                  TZE     s:9090

     1458     9070    2           OR F$DCB.TYPE~=CODE03.TYPE
     1459     9071    2           OR F$DCB.EXPIRE~=CODE03.EXPIRE
     1460     9072    2           OR F$DCB.GHSTACS~=CODE03.GHSTACS
     1461     9073    2           OR F$DCB.XTNSIZE~=CODE03.XTNSIZE
     1462     9074    3         THEN IF NOT F$DCB.FFLG.REATTR THEN DO;

   9074  1 006621   300004 236100                    LDQ     4,,PR3
         1 006622   004000 316003                    CANQ    2048,DU
         1 006623   006631 601000 1                  TNZ     s:9079

     1463     9075    3               B$JIT.ERR=FMO$E$REATTR;

   9075  1 006624   000014 236000 0                  LDQ     FMO$E$REATTR
         1 006625   100012 756100                    STQ     10,,PR1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:259  

     1464     9076    3               F$DCB.DESC=CODE03.DESC;

   9076  1 006626   400001 220100                    LDX0    1,,PR4
         1 006627   300005 440100                    SXL0    5,,PR3

     1465     9077    3               END;

   9077  1 006630   006673 710000 1                  TRA     s:9090

     1466     9078    3            ELSE DO;

     1467     9079    3               CALL MODIFIED;

   9079  1 006631   002465 701000 1                  TSX1    MODIFIED
         1 006632   000000 011000                    NOP     0

     1468     9080    3               CODE03.TYPE=F$DCB.TYPE;

   9080  1 006633   200004 470500                    LDP0    JDCB$,,AUTO
         1 006634   000025 720100                    LXL0    21,,PR0
         1 006635   200005 471500                    LDP1    LOC$,,AUTO
         1 006636   100001 440100                    SXL0    1,,PR1

     1469     9081    3               CODE03.XTNSIZE=F$DCB.XTNSIZE;

   9081  1 006637   000037 220100                    LDX0    31,,PR0
         1 006640   200005 471500                    LDP1    LOC$,,AUTO
         1 006641   100005 740100                    STX0    5,,PR1

     1470     9082    3               CODE03.GHSTACS=F$DCB.GHSTACS;

   9082  1 006642   200005 471500                    LDP1    LOC$,,AUTO
         1 006643   000052 236100                    LDQ     42,,PR0
         1 006644   000011 736000                    QLS     9
         1 006645   100004 676100                    ERQ     4,,PR1
         1 006646   017000 376003                    ANQ     7680,DU
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:260  
         1 006647   100004 656100                    ERSQ    4,,PR1

     1471     9083    3               CODE=3;

   9083  1 006650   000003 235007                    LDA     3,DL
         1 006651   200035 755100                    STA     CODE,,AUTO

     1472     9084    3               IF F$DCB.EXPIRE~=CODE03.EXPIRE

   9084  1 006652   200005 471500                    LDP1    LOC$,,AUTO
         1 006653   100007 236100                    LDQ     7,,PR1
         1 006654   000022 732000                    QRS     18
         1 006655   000035 116100                    CMPQ    29,,PR0
         1 006656   006663 600000 1                  TZE     s:9086

     1473     9085    3               THEN CALL FMO$FITSPACE(SIZEW(CODE03))ALTRET(NOXPIRE);

   9085  1 006657   000014 236000 2                  LDQ     12
         1 006660   200047 756100                    STQ     FN+3,,AUTO
         1 006661   004717 701000 1                  TSX1    FMO$FITSPACE
         1 006662   006667 702000 1                  TSX2    NOXPIRE

     1474     9086    3               CODE03.EXPIRE=F$DCB.EXPIRE;

   9086  1 006663   200004 470500                    LDP0    JDCB$,,AUTO
         1 006664   000035 720100                    LXL0    29,,PR0
         1 006665   200005 471500                    LDP1    LOC$,,AUTO
         1 006666   100007 740100                    STX0    7,,PR1

   9086  1 006667                       NOXPIRE      null
     1475     9087    3   NOXPIRE:    ;
     1476     9088    3               CODE03.DESC=F$DCB.DESC;

   9088  1 006667   200004 470500                    LDP0    JDCB$,,AUTO
         1 006670   000005 720100                    LXL0    5,,PR0
         1 006671   200005 471500                    LDP1    LOC$,,AUTO
         1 006672   100001 740100                    STX0    1,,PR1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:261  

     1477     9089    3               END;

     1478     9090    3         IF F$DCB.IORG=%KEYED# THEN DO;

   9090  1 006673   200004 470500                    LDP0    JDCB$,,AUTO
         1 006674   000070 236100                    LDQ     56,,PR0
         1 006675   077000 376003                    ANQ     32256,DU
         1 006676   002000 116003                    CMPQ    1024,DU
         1 006677   007017 601000 1                  TNZ     s:9108

     1479     9091    3            T$=FIT$;

   9091  1 006700   200007 236100                    LDQ     FIT$,,AUTO
         1 006701   200016 756100                    STQ     T$,,AUTO

     1480     9092    3            CALL FMO$LOCCODP(XT$,2)ALTRET(DONE);

   9092  1 006702   000017 236000 2                  LDQ     15
         1 006703   200017 235100                    LDA     T$$,,AUTO
         1 006704   200052 757100                    STAQ    INDX+1,,AUTO
         1 006705   200052 630500                    EPPR0   INDX+1,,AUTO
         1 006706   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006707   000000 701000 xent               TSX1    FMO$LOCCODP
         1 006710   011040 702000 1                  TSX2    DONE

     1481     9093    3            P1$=T$;

   9093  1 006711   200016 236100                    LDQ     T$,,AUTO
         1 006712   200006 756100                    STQ     P1$,,AUTO

     1482     9094    3            IF FPT$CLOSE_V.SPARE~=0 THEN F$DCB.SPARE=FPT$CLOSE_V.SPARE;

   9094  1 006713   200003 470500                    LDP0    @DUMMY,,AUTO
         1 006714   000000 471500                    LDP1    0,,PR0
         1 006715   100003 236100                    LDQ     3,,PR1
         1 006716   777000 316007                    CANQ    -512,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:262  
         1 006717   006723 600000 1                  TZE     s:9095

   9094  1 006720   200004 473500                    LDP3    JDCB$,,AUTO
         1 006721   000022 736000                    QLS     18
         1 006722   300040 552140                    STBQ    32,'40'O,PR3

     1483     9095    3            IF FPT$CLOSE_V.LSLIDE~=0 THEN F$DCB.LSLIDE=FPT$CLOSE_V.LSLIDE;

   9095  1 006723   000000 471500                    LDP1    0,,PR0
         1 006724   100003 236100                    LDQ     3,,PR1
         1 006725   777000 316003                    CANQ    -512,DU
         1 006726   006732 600000 1                  TZE     s:9096

   9095  1 006727   200004 473500                    LDP3    JDCB$,,AUTO
         1 006730   000022 772000                    QRL     18
         1 006731   300037 552110                    STBQ    31,'10'O,PR3

     1484     9096    3            IF FPT$CLOSE_V.LRDL0~=0 THEN F$DCB.LRDL0=FPT$CLOSE_V.LRDL0;

   9096  1 006732   000000 471500                    LDP1    0,,PR0
         1 006733   100003 236100                    LDQ     3,,PR1
         1 006734   000777 316003                    CANQ    511,DU
         1 006735   006741 600000 1                  TZE     s:9097

   9096  1 006736   200004 473500                    LDP3    JDCB$,,AUTO
         1 006737   000022 772000                    QRL     18
         1 006740   300037 552104                    STBQ    31,'04'O,PR3

     1485     9097    3            IF F$DCB.SPARE~=P1$->CODE02.SPARE

   9097  1 006741   200006 471500                    LDP1    P1$,,AUTO
         1 006742   100000 236100                    LDQ     0,,PR1
         1 006743   000011 772000                    QRL     9
         1 006744   000777 376007                    ANQ     511,DL
         1 006745   200052 756100                    STQ     INDX+1,,AUTO
         1 006746   200004 473500                    LDP3    JDCB$,,AUTO
         1 006747   300040 236100                    LDQ     32,,PR3
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:263  
         1 006750   000033 772000                    QRL     27
         1 006751   200052 116100                    CMPQ    INDX+1,,AUTO
         1 006752   006773 601000 1                  TNZ     s:9100
         1 006753   100000 236100                    LDQ     0,,PR1
         1 006754   000033 772000                    QRL     27
         1 006755   200053 756100                    STQ     INDX+2,,AUTO
         1 006756   300037 236100                    LDQ     31,,PR3
         1 006757   000011 772000                    QRL     9
         1 006760   000777 376007                    ANQ     511,DL
         1 006761   200053 116100                    CMPQ    INDX+2,,AUTO
         1 006762   006773 601000 1                  TNZ     s:9100
         1 006763   100000 236100                    LDQ     0,,PR1
         1 006764   000022 772000                    QRL     18
         1 006765   000777 376007                    ANQ     511,DL
         1 006766   200054 756100                    STQ     INDX+3,,AUTO
         1 006767   300037 236100                    LDQ     31,,PR3
         1 006770   000777 376007                    ANQ     511,DL
         1 006771   200054 116100                    CMPQ    INDX+3,,AUTO
         1 006772   007017 600000 1                  TZE     s:9108

     1486     9098    3              OR F$DCB.LSLIDE~=P1$->CODE02.LSLIDE
     1487     9099    3              OR F$DCB.LRDL0~=P1$->CODE02.LRDL0
     1488     9100    3            THEN IF NOT F$DCB.FFLG.REATTR THEN B$JIT.ERR=FMO$E$REATTR;

   9100  1 006773   300004 236100                    LDQ     4,,PR3
         1 006774   004000 316003                    CANQ    2048,DU
         1 006775   007002 601000 1                  TNZ     s:9102

   9100  1 006776   000014 236000 0                  LDQ     FMO$E$REATTR
         1 006777   000000 474400 xsym               LDP4    B$JIT$
         1 007000   400012 756100                    STQ     10,,PR4
         1 007001   007017 710000 1                  TRA     s:9108

     1489     9101    4               ELSE DO;

     1490     9102    4                  P1$->CODE02.SPARE=F$DCB.SPARE;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:264  
   9102  1 007002   300040 236100                    LDQ     32,,PR3
         1 007003   000022 772000                    QRL     18
         1 007004   100000 552110                    STBQ    0,'10'O,PR1

     1491     9103    4                  P1$->CODE02.LSLIDE=F$DCB.LSLIDE;

   9103  1 007005   200006 471500                    LDP1    P1$,,AUTO
         1 007006   300037 236100                    LDQ     31,,PR3
         1 007007   000022 736000                    QLS     18
         1 007010   100000 552140                    STBQ    0,'40'O,PR1

     1492     9104    4                  P1$->CODE02.LRDL0=F$DCB.LRDL0;

   9104  1 007011   200006 471500                    LDP1    P1$,,AUTO
         1 007012   300037 236100                    LDQ     31,,PR3
         1 007013   000022 736000                    QLS     18
         1 007014   100000 552120                    STBQ    0,'20'O,PR1

     1493     9105    4                  CALL MODIFIED;

   9105  1 007015   002465 701000 1                  TSX1    MODIFIED
         1 007016   000000 011000                    NOP     0

     1494     9106    4                  END;

     1495     9107    3            END;

     1496     9108    2         LOC$=ADDR(NIL);/* CLEAR MODIFIED FLAG */

   9108  1 007017   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 007020   200005 756100                    STQ     LOC$,,AUTO

     1497     9109    3         DO CODE=9 TO 13; /* FITMOD FOR MODABLE ONES */

   9109  1 007021   000011 235007                    LDA     9,DL
         1 007022   200035 755100                    STA     CODE,,AUTO

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:265  
     1498     9110    3            CALL FMO$BLDCODE;

   9110  1 007023   000566 701000 1                  TSX1    FMO$BLDCODE
         1 007024   000000 011000                    NOP     0

     1499     9111    3            IF LOC$=FIT$ THEN CALL MODIFIED;

   9111  1 007025   200005 236100                    LDQ     LOC$,,AUTO
         1 007026   200007 116100                    CMPQ    FIT$,,AUTO
         1 007027   007032 601000 1                  TNZ     s:9112

   9111  1 007030   002465 701000 1                  TSX1    MODIFIED
         1 007031   000000 011000                    NOP     0

     1500     9112    3            END;

   9112  1 007032   200035 054100                    AOS     CODE,,AUTO
         1 007033   200035 235100                    LDA     CODE,,AUTO
         1 007034   000015 115007                    CMPA    13,DL
         1 007035   007023 604400 1                  TMOZ    s:9110

     1501     9113    2         IF PN$.PASS_~=ADDR(NIL)

   9113  1 007036   200003 470500                    LDP0    @DUMMY,,AUTO
         1 007037   000004 236100                    LDQ     4,,PR0
         1 007040   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 007041   007130 600000 1                  TZE     NOMOD

     1502     9114    2         THEN IF NOT F$DCB.FFLG.DELF THEN B$JIT.ERR=FMO$E$RENAME;

   9114  1 007042   200004 471500                    LDP1    JDCB$,,AUTO
         1 007043   100004 236100                    LDQ     4,,PR1
         1 007044   020000 316003                    CANQ    8192,DU
         1 007045   007052 601000 1                  TNZ     s:9119

   9114  1 007046   000012 236000 0                  LDQ     FMO$E$RENAME
         1 007047   000000 473400 xsym               LDP3    B$JIT$
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:266  
         1 007050   300012 756100                    STQ     10,,PR3
         1 007051   007130 710000 1                  TRA     NOMOD

     1503     9115                    /*E*     ERROR: FMO-E$RENAME-E
     1504     9116                             MESSAGE: You cannot change the name or password% of %UF%
     1505     9117                    */
     1506     9118    3            ELSE DO;

     1507     9119    3               I=8;

   9119  1 007052   000010 235007                    LDA     8,DL
         1 007053   200012 755100                    STA     I,,AUTO

     1508     9120    3               F$DCB.PASS=PN$.PASS_->REC;

   9120  1 007054   000004 473500                    LDP3    4,,PR0
         1 007055   000000 620005                    EAX0    0,AL
         1 007056   040100 100540                    MLR     fill='040'O
         1 007057   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 007060   100022 000010                    ADSC9   18,,PR1                  cn=0,n=8

     1509     9121    3               CODE=7;

   9121  1 007061   000007 235007                    LDA     7,DL
         1 007062   200035 755100                    STA     CODE,,AUTO

     1510     9122    4               IF F$DCB.PASS=' ' THEN DO;

   9122  1 007063   100022 237100                    LDAQ    18,,PR1
         1 007064   000036 117000 2                  CMPAQ   30
         1 007065   007112 601000 1                  TNZ     s:9130

     1511     9123    4                  F$DCB.PASSF='0'B;

   9123  1 007066   000007 236000 2                  LDQ     7
         1 007067   100031 356100                    ANSQ    25,,PR1

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:267  
     1512     9124    4                  T$=FIT$;

   9124  1 007070   200007 236100                    LDQ     FIT$,,AUTO
         1 007071   200016 756100                    STQ     T$,,AUTO

     1513     9125    4                  CALL FMO$LOCCODX(XT$,CODE)ALTRET(NOMOD);

   9125  1 007072   200035 633500                    EPPR3   CODE,,AUTO
         1 007073   200053 453500                    STP3    INDX+2,,AUTO
         1 007074   200017 236100                    LDQ     T$$,,AUTO
         1 007075   200052 756100                    STQ     INDX+1,,AUTO
         1 007076   200052 630500                    EPPR0   INDX+1,,AUTO
         1 007077   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 007100   000000 701000 xent               TSX1    FMO$LOCCODX
         1 007101   007130 702000 1                  TSX2    NOMOD

     1514     9126    4                  IF FM$FIT.CODES.NDW(CODE)=0 THEN GOTO NOMOD;

   9126  1 007102   200007 470500                    LDP0    FIT$,,AUTO
         1 007103   200035 720100                    LXL0    CODE,,AUTO
         1 007104   000000 236110                    LDQ     0,X0,PR0
         1 007105   000032 316000 2                  CANQ    26
         1 007106   007130 600000 1                  TZE     NOMOD

     1515     9127    4                  FM$FIT.CODES.NDW(CODE)=0;

   9127  1 007107   000004 236000 2                  LDQ     4
         1 007110   000000 356110                    ANSQ    0,X0,PR0

     1516     9128    4                  END;

   9128  1 007111   007126 710000 1                  TRA     s:9134

     1517     9129    4               ELSE DO;

     1518     9130    4                  CALL FMM$SCRAMBLE(F$DCB.PASS);

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:268  
   9130  1 007112   200004 236100                    LDQ     JDCB$,,AUTO
         1 007113   000022 036003                    ADLQ    18,DU
         1 007114   200052 756100                    STQ     INDX+1,,AUTO
         1 007115   200052 630500                    EPPR0   INDX+1,,AUTO
         1 007116   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 007117   000000 701000 xent               TSX1    FMM$SCRAMBLE
         1 007120   000000 011000                    NOP     0

     1519     9131    4                  F$DCB.PASSF='1'B;

   9131  1 007121   200004 470500                    LDP0    JDCB$,,AUTO
         1 007122   400000 236007                    LDQ     -131072,DL
         1 007123   000031 256100                    ORSQ    25,,PR0

     1520     9132    4                  CALL FMO$BLDCODE;

   9132  1 007124   000566 701000 1                  TSX1    FMO$BLDCODE
         1 007125   000000 011000                    NOP     0

     1521     9133    4                  END;

     1522     9134    3               CALL MODIFIED;

   9134  1 007126   002465 701000 1                  TSX1    MODIFIED
         1 007127   000000 011000                    NOP     0

     1523     9135    3               END;

   9128  1 007130                       NOMOD        null
     1524     9136    2   NOMOD: ;
     1525     9137    2         J=0;

   9137  1 007130   200013 450100                    STZ     J,,AUTO

     1526     9138    2         LOCCODX=3;

   9138  1 007131   000003 235007                    LDA     3,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:269  
         1 007132   200020 755100                    STA     LOCCODX,,AUTO

     1527     9139    2         CALL LOCCODP ALTRET(DONE);

   9139  1 007133   002543 701000 1                  TSX1    LOCCODP
         1 007134   011040 702000 1                  TSX2    DONE

     1528     9140    2         END;

     1529     9141    1      IF FM$CFU.USECNT>1 AND FM$CFU.FUN~=%JRNL#

   9141  1 007135   200010 470500                    LDP0    CFU$,,AUTO
         1 007136   000003 720100                    LXL0    3,,PR0
         1 007137   000002 100003                    CMPX0   2,DU
         1 007140   007145 602000 1                  TNC     s:9141+8
         1 007141   000000 236100                    LDQ     0,,PR0
         1 007142   700000 376003                    ANQ     -32768,DU
         1 007143   400000 116003                    CMPQ    -131072,DU
         1 007144   011040 601000 1                  TNZ     DONE
         1 007145   200004 471500                    LDP1    JDCB$,,AUTO
         1 007146   100036 236100                    LDQ     30,,PR1
         1 007147   000777 376007                    ANQ     511,DL
         1 007150   000003 116007                    CMPQ    3,DL
         1 007151   007156 601000 1                  TNZ     s:9145
         1 007152   100032 236100                    LDQ     26,,PR1
         1 007153   000777 376003                    ANQ     511,DU
         1 007154   000003 116003                    CMPQ    3,DU
         1 007155   011040 600000 1                  TZE     DONE

     1530     9142    1        OR F$DCB.ACS=%BLOCK# AND F$DCB.FUN=%CREATE#
     1531     9143    1      THEN GOTO DONE;
     1532     9144                    /* */
     1533     9145    2      IF (F$DCB.ASN=%FILE# OR F$DCB.ASN=%TAPE#) THEN DO;

   9145  1 007156   100032 236100                    LDQ     26,,PR1
         1 007157   777000 376007                    ANQ     -512,DL
         1 007160   001000 116007                    CMPQ    512,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:270  
         1 007161   007164 600000 1                  TZE     s:9147
         1 007162   002000 116007                    CMPQ    1024,DL
         1 007163   010032 601000 1                  TNZ     s:9318

     1534     9146                    /* Don't replace IRREC if RECFIELD is specified, but not used */
     1535     9147    2         NEW_RECFIELD='0'B;

   9147  1 007164   200032 450100                    STZ     NEW_RECFIELD,,AUTO

     1536     9148    2         IF NOT FPT$CLOSE_V.OPER.CHGATT THEN

   9148  1 007165   200003 473500                    LDP3    @DUMMY,,AUTO
         1 007166   300000 474500                    LDP4    0,,PR3
         1 007167   400000 236100                    LDQ     0,,PR4
         1 007170   400000 316007                    CANQ    -131072,DL
         1 007171   007755 600000 1                  TZE     NO_IRREC

     1537     9149    2            GOTO NO_IRREC;
     1538     9150    2         IF CPN$.RECFIELD_~=B$PS2$ THEN

   9150  1 007172   300002 236100                    LDQ     2,,PR3
         1 007173   000000 116000 xsym               CMPQ    B$PS2$
         1 007174   007501 601000 1                  TNZ     NO_RECFIELD

     1539     9151    2            GOTO NO_RECFIELD;
     1540     9152    2         CALL HFF$DSIZ(B$PS2$,I);

   9152  1 007175   200012 635500                    EPPR5   I,,AUTO
         1 007176   200053 455500                    STP5    INDX+2,,AUTO
         1 007177   000040 236000 2                  LDQ     32
         1 007200   200052 756100                    STQ     INDX+1,,AUTO
         1 007201   200052 630500                    EPPR0   INDX+1,,AUTO
         1 007202   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 007203   000000 701000 xent               TSX1    HFF$DSIZ
         1 007204   000000 011000                    NOP     0

     1541     9153    2         IF I=0 THEN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:271  

   9153  1 007205   200012 235100                    LDA     I,,AUTO
         1 007206   007501 600000 1                  TZE     NO_RECFIELD

     1542     9154    2            GOTO NO_RECFIELD;
     1543     9155    2         IF VLP$RECFIELD.VLPID# ~= 511 THEN

   9155  1 007207   000000 470400 xsym               LDP0    B$PS2$
         1 007210   000000 236100                    LDQ     0,,PR0
         1 007211   777000 376003                    ANQ     -512,DU
         1 007212   777000 116003                    CMPQ    -512,DU
         1 007213   007501 601000 1                  TNZ     NO_RECFIELD

     1544     9156    2            GOTO NO_RECFIELD;
     1545     9157                    /* If this is an IREL file, RECFIELD can't be altered since keys
     1546     9158                       can't be changed, and altering the physical fields may alter
     1547     9159                       the keys. Since we won't use RECFIELD, we can't use IRREC
     1548     9160                       either since we must assume that the two are intended to be a
     1549     9161                       matched set. (If the user didn't specify a new RECFIELD for
     1550     9162                       an IREL file, it's OK for him to change IRREC.)           */
     1551     9163    2         IF F$DCB.ORG=%IREL# THEN

   9163  1 007214   200004 471500                    LDP1    JDCB$,,AUTO
         1 007215   100032 236100                    LDQ     26,,PR1
         1 007216   777000 376003                    ANQ     -512,DU
         1 007217   015000 116003                    CMPQ    6656,DU
         1 007220   007755 600000 1                  TZE     NO_IRREC

     1552     9164    2            GOTO NO_IRREC;
     1553     9165    3         IF NOT F$DCB.FFLG.REATTR THEN DO;

   9165  1 007221   100004 236100                    LDQ     4,,PR1
         1 007222   004000 316003                    CANQ    2048,DU
         1 007223   007230 601000 1                  TNZ     s:9169

     1554     9166    3            B$JIT.ERR=FMO$E$REATTR;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:272  
   9166  1 007224   000014 236000 0                  LDQ     FMO$E$REATTR
         1 007225   000000 473400 xsym               LDP3    B$JIT$
         1 007226   300012 756100                    STQ     10,,PR3

     1555     9167    3            GOTO NO_IRREC;

   9167  1 007227   007755 710000 1                  TRA     NO_IRREC

     1556     9168    3            END;
     1557     9169    2         IF I/2-2 < VLP$RECFIELD.NFIELDS# OR VLP$RECFIELD.NFIELDS# > 511

   9169  1 007230   200012 236100                    LDQ     I,,AUTO
         1 007231   000001 772000                    QRL     1
         1 007232   200052 756100                    STQ     INDX+1,,AUTO
         1 007233   000000 236100                    LDQ     0,,PR0
         1 007234   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 007235   200053 756100                    STQ     INDX+2,,AUTO
         1 007236   200052 236100                    LDQ     INDX+1,,AUTO
         1 007237   000002 136007                    SBLQ    2,DL
         1 007240   200053 116100                    CMPQ    INDX+2,,AUTO
         1 007241   007246 604000 1                  TMI     s:9171
         1 007242   000000 236100                    LDQ     0,,PR0
         1 007243   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 007244   001000 116007                    CMPQ    512,DL
         1 007245   007252 602000 1                  TNC     s:9184

     1558     9170    3         THEN DO;

     1559     9171    3            B$JIT.ERR=FMO$E$BADVECT2;

   9171  1 007246   000042 236000 0                  LDQ     FMO$E$BADVECT2
         1 007247   000000 473400 xsym               LDP3    B$JIT$
         1 007250   300012 756100                    STQ     10,,PR3

     1560     9172    3            GOTO NO_IRREC;

   9172  1 007251   007755 710000 1                  TRA     NO_IRREC
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:273  

     1561     9173    3            END;
     1562     9174                    /*E*  ERROR:    FMO-E$BADVECT2-E
     1563     9175                          MESSAGE:  Bad RECFIELD vector on close% of %UF%
     1564     9176                          MESSAGE1: On close% of %UF%, the RECFIELD vector
     1565     9177                                    was bad because it either (1) framed an area
     1566     9178                                    too small to hold all specified fields, (2)
     1567     9179                                    specified more than 511 fields, or (3)
     1568     9180                                    invalidated existing IRREC information and no
     1569     9181                                    new IRREC vector was specified. Previous
     1570     9182                                    values for RECFIELD and IRREC retained.
     1571     9183                    */
     1572     9184    2         NEWSIZE=(B$PS2$->VLP$RECFIELD.NFIELDS#+1)/2 + 1;

   9184  1 007252   000001 036007                    ADLQ    1,DL
         1 007253   000001 772000                    QRL     1
         1 007254   000001 036007                    ADLQ    1,DL
         1 007255   200034 756100                    STQ     NEWSIZE,,AUTO

     1573     9185    2         CALL FSA$GSP(NEWSIZE,XT$) ALTRET(NO_IRREC);

   9185  1 007256   200017 236100                    LDQ     T$$,,AUTO
         1 007257   200053 756100                    STQ     INDX+2,,AUTO
         1 007260   200034 633500                    EPPR3   NEWSIZE,,AUTO
         1 007261   200052 453500                    STP3    INDX+1,,AUTO
         1 007262   200052 630500                    EPPR0   INDX+1,,AUTO
         1 007263   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 007264   000000 701000 xent               TSX1    FSA$GSP
         1 007265   007755 702000 1                  TSX2    NO_IRREC

     1574     9186    2         P1$=T$;

   9186  1 007266   200016 236100                    LDQ     T$,,AUTO
         1 007267   200006 756100                    STQ     P1$,,AUTO

     1575     9187    2         J=NEWSIZE*4;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:274  
   9187  1 007270   200034 235100                    LDA     NEWSIZE,,AUTO
         1 007271   000002 735000                    ALS     2
         1 007272   200013 755100                    STA     J,,AUTO

     1576     9188    2         P1$->ZAPJ=B$PS2$->ZAPJ;

   9188  1 007273   000000 470400 xsym               LDP0    B$PS2$
         1 007274   000000 620005                    EAX0    0,AL
         1 007275   200006 471500                    LDP1    P1$,,AUTO
         1 007276   200013 721100                    LXL1    J,,AUTO
         1 007277   000140 100540                    MLR     fill='000'O
         1 007300   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 007301   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     1577     9189    2         SAVE_FIELDX=F$DCB.FIELDX;

   9189  1 007302   200004 470500                    LDP0    JDCB$,,AUTO
         1 007303   000054 236100                    LDQ     44,,PR0
         1 007304   777777 376007                    ANQ     -1,DL
         1 007305   200030 756100                    STQ     SAVE_FIELDX,,AUTO

     1578     9190    2         F$DCB.FIELDX=POFFW(P1$,B$ROSEG$);

   9190  1 007306   000000 235000 xsym               LDA     B$ROSEG$
         1 007307   000022 771000                    ARL     18
         1 007310   200052 755100                    STA     INDX+1,,AUTO
         1 007311   200006 236100                    LDQ     P1$,,AUTO
         1 007312   000022 772000                    QRL     18
         1 007313   200052 136100                    SBLQ    INDX+1,,AUTO
         1 007314   000000 620006                    EAX0    0,QL
         1 007315   000054 440100                    SXL0    44,,PR0

     1579     9191    2         SAVE_STARTX=F$DCB.STARTX;

   9191  1 007316   000057 236100                    LDQ     47,,PR0
         1 007317   000022 772000                    QRL     18
         1 007320   200031 756100                    STQ     SAVE_STARTX,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:275  

     1580     9192    2         F$DCB.STARTX=0;

   9192  1 007321   000000 221003                    LDX1    0,DU
         1 007322   000057 741100                    STX1    47,,PR0

     1581     9193    2         FIELD$=P1$; /* FIELD$ must be set for FMO$CHKRECFIELD */

   9193  1 007323   200006 236100                    LDQ     P1$,,AUTO
         1 007324   200021 756100                    STQ     FIELD$,,AUTO

     1582     9194    2         CALL FMO$CHKRECFIELD ALTRET(RSTR_RECFIELD_ROSEG);

   9194  1 007325   002564 701000 1                  TSX1    FMO$CHKRECFIELD
         1 007326   007424 702000 1                  TSX2    RSTR_RECFIELD_ROSEG

     1583     9195    2         CALL FMO$FIELD_START_SETUP ALTRET(RSTR_RECFIELD_ROSEG);

   9195  1 007327   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 007330   000000 701000 xent               TSX1    FMO$FIELD_START_SETUP
         1 007331   007424 702000 1                  TSX2    RSTR_RECFIELD_ROSEG

     1584     9196    2         NEWSIZE=(P1$->RECFIELD.NFIELDS+1)/2 + 1;

   9196  1 007332   200006 470500                    LDP0    P1$,,AUTO
         1 007333   000000 236100                    LDQ     0,,PR0
         1 007334   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 007335   000001 036007                    ADLQ    1,DL
         1 007336   000001 772000                    QRL     1
         1 007337   000001 036007                    ADLQ    1,DL
         1 007340   200034 756100                    STQ     NEWSIZE,,AUTO

     1585     9197    2         CODE=18;

   9197  1 007341   000022 235007                    LDA     18,DL
         1 007342   200035 755100                    STA     CODE,,AUTO

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:276  
     1586     9198    2         CALL FMO$FITSPACE(NEWSIZE) ALTRET(RSTR_RECFIELD_ROSEG);

   9198  1 007343   200034 631500                    EPPR1   NEWSIZE,,AUTO
         1 007344   200047 451500                    STP1    FN+3,,AUTO
         1 007345   004717 701000 1                  TSX1    FMO$FITSPACE
         1 007346   007424 702000 1                  TSX2    RSTR_RECFIELD_ROSEG

     1587     9199    2         J=NEWSIZE*4;

   9199  1 007347   200034 235100                    LDA     NEWSIZE,,AUTO
         1 007350   000002 735000                    ALS     2
         1 007351   200013 755100                    STA     J,,AUTO

     1588     9200    2         LOC$->MOVEJ=P1$->MOVEJ;

   9200  1 007352   200006 470500                    LDP0    P1$,,AUTO
         1 007353   000000 620005                    EAX0    0,AL
         1 007354   200005 471500                    LDP1    LOC$,,AUTO
         1 007355   200013 721100                    LXL1    J,,AUTO
         1 007356   040140 100540                    MLR     fill='040'O
         1 007357   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 007360   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     1589     9201    2         NEW_RECFIELD='1'B;

   9201  1 007361   400000 236003                    LDQ     -131072,DU
         1 007362   200032 756100                    STQ     NEW_RECFIELD,,AUTO

     1590     9202    3         IF '0'B THEN DO;

   9202  1 007363   007501 710000 1                  TRA     NO_RECFIELD

   9196  1 007364                       RSTR_OLD_RE* null
     1591     9203    3   RSTR_OLD_RECFIELD:;
     1592     9204    4            IF NEW_RECFIELD THEN DO;

   9204  1 007364   200032 234100                    SZN     NEW_RECFIELD,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:277  
         1 007365   007500 605000 1                  TPL     s:9232

     1593     9205    5               IF SAVE_FIELDX~=0 THEN DO;

   9205  1 007366   200030 235100                    LDA     SAVE_FIELDX,,AUTO
         1 007367   007755 600000 1                  TZE     NO_IRREC

     1594     9206    5                  FIELD$=PINCRW(B$ROSEG$,SAVE_FIELDX);

   9206  1 007370   200030 236100                    LDQ     SAVE_FIELDX,,AUTO
         1 007371   000022 736000                    QLS     18
         1 007372   000000 036000 xsym               ADLQ    B$ROSEG$
         1 007373   200021 756100                    STQ     FIELD$,,AUTO

     1595     9207    5                  NEWSIZE=(RECFIELD.NFIELDS+1)/2 + 1;

   9207  1 007374   200021 470500                    LDP0    FIELD$,,AUTO
         1 007375   000000 236100                    LDQ     0,,PR0
         1 007376   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 007377   000001 036007                    ADLQ    1,DL
         1 007400   000001 772000                    QRL     1
         1 007401   000001 036007                    ADLQ    1,DL
         1 007402   200034 756100                    STQ     NEWSIZE,,AUTO

     1596     9208    5                  CODE=18;

   9208  1 007403   000022 235007                    LDA     18,DL
         1 007404   200035 755100                    STA     CODE,,AUTO

     1597     9209    5                  CALL FMO$FITSPACE(NEWSIZE) ALTRET(NO_IRREC);/* shouldn't altret */

   9209  1 007405   200034 631500                    EPPR1   NEWSIZE,,AUTO
         1 007406   200047 451500                    STP1    FN+3,,AUTO
         1 007407   004717 701000 1                  TSX1    FMO$FITSPACE
         1 007410   007755 702000 1                  TSX2    NO_IRREC

     1598     9210    5                  J=NEWSIZE*4;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:278  

   9210  1 007411   200034 235100                    LDA     NEWSIZE,,AUTO
         1 007412   000002 735000                    ALS     2
         1 007413   200013 755100                    STA     J,,AUTO

     1599     9211    5                  LOC$->MOVEJ=FIELD$->MOVEJ;

   9211  1 007414   200021 470500                    LDP0    FIELD$,,AUTO
         1 007415   000000 620005                    EAX0    0,AL
         1 007416   200005 471500                    LDP1    LOC$,,AUTO
         1 007417   200013 721100                    LXL1    J,,AUTO
         1 007420   040140 100540                    MLR     fill='040'O
         1 007421   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 007422   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     1600     9212    5                  END;

   9212  1 007423   007424 710000 1                  TRA     RSTR_RECFIELD_ROSEG

   9211  1 007424                       RSTR_RECFIE* null
     1601     9213    4               ELSE GOTO NO_IRREC; /* Leave the new RECFIELD since no
     1602     9214                    RECFIELD or IRREC existed before
     1603     9215                    and it would be painful to delete
     1604     9216                    the new RECFIELD.              */
     1605     9217    4   RSTR_RECFIELD_ROSEG:;
     1606     9218    5               IF F$DCB.FIELDX~=0 THEN DO;

   9218  1 007424   200004 470500                    LDP0    JDCB$,,AUTO
         1 007425   000054 720100                    LXL0    44,,PR0
         1 007426   007451 600000 1                  TZE     s:9223

     1607     9219    5                  FIELD$=PINCRW(B$ROSEG$,F$DCB.FIELDX);

   9219  1 007427   000000 636010                    EAQ     0,X0
         1 007430   000000 036000 xsym               ADLQ    B$ROSEG$
         1 007431   200021 756100                    STQ     FIELD$,,AUTO

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:279  
     1608     9220    5                  K=(RECFIELD.NFIELDS+1)/2 + 1;

   9220  1 007432   200021 471500                    LDP1    FIELD$,,AUTO
         1 007433   100000 236100                    LDQ     0,,PR1
         1 007434   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 007435   000001 036007                    ADLQ    1,DL
         1 007436   000001 772000                    QRL     1
         1 007437   000001 036007                    ADLQ    1,DL
         1 007440   200014 756100                    STQ     K,,AUTO

     1609     9221    5                  CALL FSA$FSP(K,FIELD$);

   9221  1 007441   200021 633500                    EPPR3   FIELD$,,AUTO
         1 007442   200053 453500                    STP3    INDX+2,,AUTO
         1 007443   200014 634500                    EPPR4   K,,AUTO
         1 007444   200052 454500                    STP4    INDX+1,,AUTO
         1 007445   200052 630500                    EPPR0   INDX+1,,AUTO
         1 007446   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 007447   000000 701000 xent               TSX1    FSA$FSP
         1 007450   000000 011000                    NOP     0

     1610     9222    5                  END;

     1611     9223    4               F$DCB.FIELDX=SAVE_FIELDX;

   9223  1 007451   200030 720100                    LXL0    SAVE_FIELDX,,AUTO
         1 007452   200004 470500                    LDP0    JDCB$,,AUTO
         1 007453   000054 440100                    SXL0    44,,PR0

     1612     9224    5               IF F$DCB.STARTX~=0 THEN DO;

   9224  1 007454   000057 221100                    LDX1    47,,PR0
         1 007455   007474 600000 1                  TZE     s:9229

     1613     9225    5                  START$=PINCRW(B$ROSEG$,F$DCB.STARTX);

   9225  1 007456   000000 636011                    EAQ     0,X1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:280  
         1 007457   000000 036000 xsym               ADLQ    B$ROSEG$
         1 007460   200022 756100                    STQ     START$,,AUTO

     1614     9226    5                  K=START$->FIELD_START.NWORDS;

   9226  1 007461   200022 471500                    LDP1    START$,,AUTO
         1 007462   100000 235100                    LDA     0,,PR1
         1 007463   200014 755100                    STA     K,,AUTO

     1615     9227    5                  CALL FSA$FSP(K,START$);

   9227  1 007464   200022 633500                    EPPR3   START$,,AUTO
         1 007465   200053 453500                    STP3    INDX+2,,AUTO
         1 007466   200014 634500                    EPPR4   K,,AUTO
         1 007467   200052 454500                    STP4    INDX+1,,AUTO
         1 007470   200052 630500                    EPPR0   INDX+1,,AUTO
         1 007471   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 007472   000000 701000 xent               TSX1    FSA$FSP
         1 007473   000000 011000                    NOP     0

     1616     9228    5                  END;

     1617     9229    4               F$DCB.STARTX=SAVE_STARTX;

   9229  1 007474   200031 720100                    LXL0    SAVE_STARTX,,AUTO
         1 007475   200004 470500                    LDP0    JDCB$,,AUTO
         1 007476   000057 740100                    STX0    47,,PR0

     1618     9230    4               NEW_RECFIELD='0'B;

   9230  1 007477   200032 450100                    STZ     NEW_RECFIELD,,AUTO

     1619     9231    4               END;

     1620     9232    3            GOTO NO_IRREC;

   9232  1 007500   007755 710000 1                  TRA     NO_IRREC
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:281  

   9226  1 007501                       NO_RECFIELD  null
     1621     9233    3            END;
     1622     9234    2   NO_RECFIELD:;
     1623     9235    3         IF CPN$.IRREC_~=B$PS1$ THEN DO;

   9235  1 007501   200003 470500                    LDP0    @DUMMY,,AUTO
         1 007502   000001 236100                    LDQ     1,,PR0
         1 007503   000000 116000 xsym               CMPQ    B$PS1$
         1 007504   007527 600000 1                  TZE     s:9246

   9232  1 007505                       CHK_OLD_IRR* null
     1624     9236    3   CHK_OLD_IRREC:;
     1625     9237    4            IF NEW_RECFIELD AND F$DCB.IRRECX > 0 THEN DO;

   9237  1 007505   200032 234100                    SZN     NEW_RECFIELD,,AUTO
         1 007506   007526 605000 1                  TPL     s:9244
         1 007507   200004 470500                    LDP0    JDCB$,,AUTO
         1 007510   000061 220100                    LDX0    49,,PR0
         1 007511   007526 600000 1                  TZE     s:9244

     1626     9238    4               IRREC$=PINCRW(B$ROSEG$,F$DCB.IRRECX);

   9238  1 007512   000000 636010                    EAQ     0,X0
         1 007513   000000 036000 xsym               ADLQ    B$ROSEG$
         1 007514   200023 756100                    STQ     IRREC$,,AUTO

     1627     9239    5               CALL FMO$CHKIRREC(IRREC$) WHENALTRETURN DO;

   9239  1 007515   200023 631500                    EPPR1   IRREC$,,AUTO
         1 007516   200043 451500                    STP1    CODE+6,,AUTO
         1 007517   003332 701000 1                  TSX1    FMO$CHKIRREC
         1 007520   007522 702000 1                  TSX2    s:9240
         1 007521   007526 710000 1                  TRA     s:9244

     1628     9240    5                  B$JIT.ERR=FMO$E$BADVECT2;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:282  
   9240  1 007522   000042 236000 0                  LDQ     FMO$E$BADVECT2
         1 007523   000000 470400 xsym               LDP0    B$JIT$
         1 007524   000012 756100                    STQ     10,,PR0

     1629     9241    5                  GOTO RSTR_OLD_RECFIELD;

   9241  1 007525   007364 710000 1                  TRA     RSTR_OLD_RECFIELD

     1630     9242    5                  END;
     1631     9243    4               END;

     1632     9244    3            GOTO NO_IRREC;

   9244  1 007526   007755 710000 1                  TRA     NO_IRREC

     1633     9245    3            END;
     1634     9246    2         CALL HFF$DSIZ(B$PS1$,I);

   9246  1 007527   200012 631500                    EPPR1   I,,AUTO
         1 007530   200053 451500                    STP1    INDX+2,,AUTO
         1 007531   000041 236000 2                  LDQ     33
         1 007532   200052 756100                    STQ     INDX+1,,AUTO
         1 007533   200052 630500                    EPPR0   INDX+1,,AUTO
         1 007534   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 007535   000000 701000 xent               TSX1    HFF$DSIZ
         1 007536   000000 011000                    NOP     0

     1635     9247    2         IF I=0 THEN

   9247  1 007537   200012 235100                    LDA     I,,AUTO
         1 007540   007505 600000 1                  TZE     CHK_OLD_IRREC

     1636     9248    2            GOTO CHK_OLD_IRREC;
     1637     9249    2         IF VLP$IRREC.VLPID# ~= 511 THEN

   9249  1 007541   000000 470400 xsym               LDP0    B$PS1$
         1 007542   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:283  
         1 007543   777000 376003                    ANQ     -512,DU
         1 007544   777000 116003                    CMPQ    -512,DU
         1 007545   007755 601000 1                  TNZ     NO_IRREC

     1638     9250    2            GOTO NO_IRREC;
     1639     9251    3         IF NOT F$DCB.FFLG.REATTR THEN DO;

   9251  1 007546   200004 471500                    LDP1    JDCB$,,AUTO
         1 007547   100004 236100                    LDQ     4,,PR1
         1 007550   004000 316003                    CANQ    2048,DU
         1 007551   007556 601000 1                  TNZ     s:9255

     1640     9252    3            B$JIT.ERR=FMO$E$REATTR;

   9252  1 007552   000014 236000 0                  LDQ     FMO$E$REATTR
         1 007553   000000 473400 xsym               LDP3    B$JIT$
         1 007554   300012 756100                    STQ     10,,PR3

     1641     9253    3            GOTO NO_IRREC;

   9253  1 007555   007755 710000 1                  TRA     NO_IRREC

     1642     9254    3            END;
     1643     9255    3         IF F$DCB.FIELDX=0 THEN DO;

   9255  1 007556   100054 720100                    LXL0    44,,PR1
         1 007557   007564 601000 1                  TNZ     s:9259

     1644     9256    3            B$JIT.ERR=FMO$E$BADVECT1;

   9256  1 007560   000041 236000 0                  LDQ     FMO$E$BADVECT1
         1 007561   000000 473400 xsym               LDP3    B$JIT$
         1 007562   300012 756100                    STQ     10,,PR3

     1645     9257    3            GOTO NO_IRREC;

   9257  1 007563   007755 710000 1                  TRA     NO_IRREC
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:284  

     1646     9258    3            END;
     1647     9259    3         IF I-4 < VLP$IRREC.NFIELDS# OR VLP$IRREC.NFIELDS# > 511 THEN DO;

   9259  1 007564   000000 236100                    LDQ     0,,PR0
         1 007565   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 007566   200052 756100                    STQ     INDX+1,,AUTO
         1 007567   200012 236100                    LDQ     I,,AUTO
         1 007570   000004 136007                    SBLQ    4,DL
         1 007571   200052 116100                    CMPQ    INDX+1,,AUTO
         1 007572   007577 604000 1                  TMI     s:9260
         1 007573   000000 236100                    LDQ     0,,PR0
         1 007574   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 007575   001000 116007                    CMPQ    512,DL
         1 007576   007603 602000 1                  TNC     s:9263

     1648     9260    3            B$JIT.ERR=FMO$E$BADVECT1;

   9260  1 007577   000041 236000 0                  LDQ     FMO$E$BADVECT1
         1 007600   000000 473400 xsym               LDP3    B$JIT$
         1 007601   300012 756100                    STQ     10,,PR3

     1649     9261    3            GOTO RSTR_OLD_RECFIELD;

   9261  1 007602   007364 710000 1                  TRA     RSTR_OLD_RECFIELD

     1650     9262    3            END;
     1651     9263    3         CALL FMO$CHKIRREC(B$PS1$) WHENALTRETURN DO;

   9263  1 007603   000041 236000 2                  LDQ     33
         1 007604   200043 756100                    STQ     CODE+6,,AUTO
         1 007605   003332 701000 1                  TSX1    FMO$CHKIRREC
         1 007606   007610 702000 1                  TSX2    s:9264
         1 007607   007614 710000 1                  TRA     s:9280

     1652     9264    3            B$JIT.ERR=FMO$E$BADVECT1;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:285  
   9264  1 007610   000041 236000 0                  LDQ     FMO$E$BADVECT1
         1 007611   000000 470400 xsym               LDP0    B$JIT$
         1 007612   000012 756100                    STQ     10,,PR0

     1653     9265    3            GOTO RSTR_OLD_RECFIELD;

   9265  1 007613   007364 710000 1                  TRA     RSTR_OLD_RECFIELD

     1654     9266    3            END;
     1655     9267                    /*E*  ERROR:    FMO-E$BADVECT1-E
     1656     9268                          MESSAGE:  Bad IRREC vector on close% of %UF%
     1657     9269                          MESSAGE1: IRREC_ on close% of %UF% was bad
     1658     9270                                    for one of the following reasons:
     1659     9271                                    (1) the area framed was too small to hold all
     1660     9272                                    the specified fields; (2) NFIELDS was greater
     1661     9273                                    than the number of fields defined in the
     1662     9274                                    file or greater than 511; (3) it referenced
     1663     9275                                    one or more fields not defined in the file
     1664     9276                                    or defined as list elements; (4) no fields
     1665     9277                                    were defined for the file. Previous values for
     1666     9278                                    RECFIELD and IRREC retained if they existed.
     1667     9279                    */
     1668     9280    2         NEWSIZE=(B$PS1$->VLP$IRREC.NFIELDS#+3)/4 + 1;

   9280  1 007614   000000 470400 xsym               LDP0    B$PS1$
         1 007615   000000 236100                    LDQ     0,,PR0
         1 007616   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 007617   000003 036007                    ADLQ    3,DL
         1 007620   000002 772000                    QRL     2
         1 007621   000001 036007                    ADLQ    1,DL
         1 007622   200034 756100                    STQ     NEWSIZE,,AUTO

     1669     9281    2         CALL FSA$GSP(NEWSIZE,XT$) ALTRET(RSTR_OLD_RECFIELD);

   9281  1 007623   200017 236100                    LDQ     T$$,,AUTO
         1 007624   200053 756100                    STQ     INDX+2,,AUTO
         1 007625   200034 631500                    EPPR1   NEWSIZE,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:286  
         1 007626   200052 451500                    STP1    INDX+1,,AUTO
         1 007627   200052 630500                    EPPR0   INDX+1,,AUTO
         1 007630   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 007631   000000 701000 xent               TSX1    FSA$GSP
         1 007632   007364 702000 1                  TSX2    RSTR_OLD_RECFIELD

     1670     9282    2         P1$=T$;

   9282  1 007633   200016 236100                    LDQ     T$,,AUTO
         1 007634   200006 756100                    STQ     P1$,,AUTO

     1671     9283    2         J=NEWSIZE*4;

   9283  1 007635   200034 235100                    LDA     NEWSIZE,,AUTO
         1 007636   000002 735000                    ALS     2
         1 007637   200013 755100                    STA     J,,AUTO

     1672     9284    2         P1$->ZAPJ=B$PS1$->ZAPJ;

   9284  1 007640   000000 470400 xsym               LDP0    B$PS1$
         1 007641   000000 620005                    EAX0    0,AL
         1 007642   200006 471500                    LDP1    P1$,,AUTO
         1 007643   200013 721100                    LXL1    J,,AUTO
         1 007644   000140 100540                    MLR     fill='000'O
         1 007645   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 007646   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     1673     9285    2         NEWSIZE=(P1$->IRREC.NFIELDS+3)/4 + 1;

   9285  1 007647   200006 470500                    LDP0    P1$,,AUTO
         1 007650   000000 236100                    LDQ     0,,PR0
         1 007651   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 007652   000003 036007                    ADLQ    3,DL
         1 007653   000002 772000                    QRL     2
         1 007654   000001 036007                    ADLQ    1,DL
         1 007655   200034 756100                    STQ     NEWSIZE,,AUTO

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:287  
     1674     9286    2         CODE=21;

   9286  1 007656   000025 235007                    LDA     21,DL
         1 007657   200035 755100                    STA     CODE,,AUTO

     1675     9287    3         CALL FMO$FITSPACE(NEWSIZE) WHENALTRETURN DO;

   9287  1 007660   200034 631500                    EPPR1   NEWSIZE,,AUTO
         1 007661   200047 451500                    STP1    FN+3,,AUTO
         1 007662   004717 701000 1                  TSX1    FMO$FITSPACE
         1 007663   007665 702000 1                  TSX2    s:9288
         1 007664   007705 710000 1                  TRA     s:9292

     1676     9288    3            K=(P1$->IRREC.NFIELDS+3)/4 + 1;

   9288  1 007665   200006 470500                    LDP0    P1$,,AUTO
         1 007666   000000 236100                    LDQ     0,,PR0
         1 007667   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 007670   000003 036007                    ADLQ    3,DL
         1 007671   000002 772000                    QRL     2
         1 007672   000001 036007                    ADLQ    1,DL
         1 007673   200014 756100                    STQ     K,,AUTO

     1677     9289    3            CALL FSA$FSP(K,P1$);

   9289  1 007674   200006 631500                    EPPR1   P1$,,AUTO
         1 007675   200053 451500                    STP1    INDX+2,,AUTO
         1 007676   200014 633500                    EPPR3   K,,AUTO
         1 007677   200052 453500                    STP3    INDX+1,,AUTO
         1 007700   200052 630500                    EPPR0   INDX+1,,AUTO
         1 007701   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 007702   000000 701000 xent               TSX1    FSA$FSP
         1 007703   000000 011000                    NOP     0

     1678     9290    3            GOTO RSTR_OLD_RECFIELD;

   9290  1 007704   007364 710000 1                  TRA     RSTR_OLD_RECFIELD
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:288  

     1679     9291    3            END;
     1680     9292    2         J=NEWSIZE*4;

   9292  1 007705   200034 235100                    LDA     NEWSIZE,,AUTO
         1 007706   000002 735000                    ALS     2
         1 007707   200013 755100                    STA     J,,AUTO

     1681     9293    2         LOC$->MOVEJ=P1$->MOVEJ;

   9293  1 007710   200006 470500                    LDP0    P1$,,AUTO
         1 007711   000000 620005                    EAX0    0,AL
         1 007712   200005 471500                    LDP1    LOC$,,AUTO
         1 007713   200013 721100                    LXL1    J,,AUTO
         1 007714   040140 100540                    MLR     fill='040'O
         1 007715   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 007716   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     1682     9294    3         IF F$DCB.IRRECX~=0 THEN DO;

   9294  1 007717   200004 470500                    LDP0    JDCB$,,AUTO
         1 007720   000061 220100                    LDX0    49,,PR0
         1 007721   007744 600000 1                  TZE     s:9299

     1683     9295    3            IRREC$=PINCRW(B$ROSEG$,F$DCB.IRRECX);

   9295  1 007722   000000 636010                    EAQ     0,X0
         1 007723   000000 036000 xsym               ADLQ    B$ROSEG$
         1 007724   200023 756100                    STQ     IRREC$,,AUTO

     1684     9296    3            K=(IRREC$->IRREC.NFIELDS+3)/4 + 1;

   9296  1 007725   200023 471500                    LDP1    IRREC$,,AUTO
         1 007726   100000 236100                    LDQ     0,,PR1
         1 007727   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 007730   000003 036007                    ADLQ    3,DL
         1 007731   000002 772000                    QRL     2
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:289  
         1 007732   000001 036007                    ADLQ    1,DL
         1 007733   200014 756100                    STQ     K,,AUTO

     1685     9297    3            CALL FSA$FSP(K,IRREC$);

   9297  1 007734   200023 633500                    EPPR3   IRREC$,,AUTO
         1 007735   200053 453500                    STP3    INDX+2,,AUTO
         1 007736   200014 634500                    EPPR4   K,,AUTO
         1 007737   200052 454500                    STP4    INDX+1,,AUTO
         1 007740   200052 630500                    EPPR0   INDX+1,,AUTO
         1 007741   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 007742   000000 701000 xent               TSX1    FSA$FSP
         1 007743   000000 011000                    NOP     0

     1686     9298    3            END;

     1687     9299    2         F$DCB.IRRECX=POFFW(P1$,B$ROSEG$);

   9299  1 007744   000000 235000 xsym               LDA     B$ROSEG$
         1 007745   000022 771000                    ARL     18
         1 007746   200052 755100                    STA     INDX+1,,AUTO
         1 007747   200006 236100                    LDQ     P1$,,AUTO
         1 007750   000022 772000                    QRL     18
         1 007751   200052 136100                    SBLQ    INDX+1,,AUTO
         1 007752   000000 620006                    EAX0    0,QL
         1 007753   200004 470500                    LDP0    JDCB$,,AUTO
         1 007754   000061 740100                    STX0    49,,PR0

   9299  1 007755                       NO_IRREC     null
     1688     9300    2   NO_IRREC:;
     1689     9301    3         IF NEW_RECFIELD THEN DO;

   9301  1 007755   200032 234100                    SZN     NEW_RECFIELD,,AUTO
         1 007756   010025 605000 1                  TPL     s:9313

     1690     9302    4            IF SAVE_FIELDX~=0 THEN DO;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:290  
   9302  1 007757   200030 235100                    LDA     SAVE_FIELDX,,AUTO
         1 007760   010004 600000 1                  TZE     s:9307

     1691     9303    4               FIELD$=PINCRW(B$ROSEG$,SAVE_FIELDX);

   9303  1 007761   200030 236100                    LDQ     SAVE_FIELDX,,AUTO
         1 007762   000022 736000                    QLS     18
         1 007763   000000 036000 xsym               ADLQ    B$ROSEG$
         1 007764   200021 756100                    STQ     FIELD$,,AUTO

     1692     9304    4               K=(RECFIELD.NFIELDS+1)/2 + 1;

   9304  1 007765   200021 470500                    LDP0    FIELD$,,AUTO
         1 007766   000000 236100                    LDQ     0,,PR0
         1 007767   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 007770   000001 036007                    ADLQ    1,DL
         1 007771   000001 772000                    QRL     1
         1 007772   000001 036007                    ADLQ    1,DL
         1 007773   200014 756100                    STQ     K,,AUTO

     1693     9305    4               CALL FSA$FSP(K,FIELD$);

   9305  1 007774   200021 631500                    EPPR1   FIELD$,,AUTO
         1 007775   200053 451500                    STP1    INDX+2,,AUTO
         1 007776   200014 633500                    EPPR3   K,,AUTO
         1 007777   200052 453500                    STP3    INDX+1,,AUTO
         1 010000   200052 630500                    EPPR0   INDX+1,,AUTO
         1 010001   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 010002   000000 701000 xent               TSX1    FSA$FSP
         1 010003   000000 011000                    NOP     0

     1694     9306    4               END;

     1695     9307    4            IF SAVE_STARTX~=0 THEN DO;

   9307  1 010004   200031 235100                    LDA     SAVE_STARTX,,AUTO
         1 010005   010025 600000 1                  TZE     s:9313
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:291  

     1696     9308    4               START$=PINCRW(B$ROSEG$,SAVE_STARTX);

   9308  1 010006   200031 236100                    LDQ     SAVE_STARTX,,AUTO
         1 010007   000022 736000                    QLS     18
         1 010010   000000 036000 xsym               ADLQ    B$ROSEG$
         1 010011   200022 756100                    STQ     START$,,AUTO

     1697     9309    4               K=START$->FIELD_START.NWORDS;

   9309  1 010012   200022 470500                    LDP0    START$,,AUTO
         1 010013   000000 235100                    LDA     0,,PR0
         1 010014   200014 755100                    STA     K,,AUTO

     1698     9310    4               CALL FSA$FSP(K,START$);

   9310  1 010015   200022 631500                    EPPR1   START$,,AUTO
         1 010016   200053 451500                    STP1    INDX+2,,AUTO
         1 010017   200014 633500                    EPPR3   K,,AUTO
         1 010020   200052 453500                    STP3    INDX+1,,AUTO
         1 010021   200052 630500                    EPPR0   INDX+1,,AUTO
         1 010022   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 010023   000000 701000 xent               TSX1    FSA$FSP
         1 010024   000000 011000                    NOP     0

     1699     9311    4               END;

     1700     9312    3            END;

     1701     9313    2         J=0;

   9313  1 010025   200013 450100                    STZ     J,,AUTO

     1702     9314    2         LOCCODX=3;

   9314  1 010026   000003 235007                    LDA     3,DL
         1 010027   200020 755100                    STA     LOCCODX,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:292  

     1703     9315    2         CALL LOCCODP ALTRET(DONE);

   9315  1 010030   002543 701000 1                  TSX1    LOCCODP
         1 010031   011040 702000 1                  TSX2    DONE

     1704     9316    2         END;

     1705     9317                    /* */
     1706     9318    2      IF F$DCB.ALTKEYX~=0 THEN DO;

   9318  1 010032   200004 470500                    LDP0    JDCB$,,AUTO
         1 010033   000052 720100                    LXL0    42,,PR0
         1 010034   010540 600000 1                  TZE     s:9417

     1707     9319    2         ALTKEY$=PINCRW(B$ROSEG$, F$DCB.ALTKEYX);

   9319  1 010035   000000 636010                    EAQ     0,X0
         1 010036   000000 036000 xsym               ADLQ    B$ROSEG$
         1 010037   200025 756100                    STQ     ALTKEY$,,AUTO

     1708     9320    3         IF F$DCB.ORG=%INDEXED# THEN DO;

   9320  1 010040   000032 236100                    LDQ     26,,PR0
         1 010041   777000 376003                    ANQ     -512,DU
         1 010042   006000 116003                    CMPQ    3072,DU
         1 010043   010073 601000 1                  TNZ     s:9327

     1709     9321    3            LOCCODX=8;

   9321  1 010044   000010 235007                    LDA     8,DL
         1 010045   200020 755100                    STA     LOCCODX,,AUTO

     1710     9322    3            CALL LOCCODP ALTRET(NOALT);

   9322  1 010046   002543 701000 1                  TSX1    LOCCODP
         1 010047   010533 702000 1                  TSX2    NOALT
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:293  

     1711     9323    3            I=FITALTKEYS.NUMWRDS*4;

   9323  1 010050   200005 470500                    LDP0    LOC$,,AUTO
         1 010051   000000 236100                    LDQ     0,,PR0
         1 010052   000031 772000                    QRL     25
         1 010053   003774 376007                    ANQ     2044,DL
         1 010054   200012 756100                    STQ     I,,AUTO

     1712     9324    3            LOC$->REC=ALTKEY$->REC;

   9324  1 010055   200025 471500                    LDP1    ALTKEY$,,AUTO
         1 010056   000000 620006                    EAX0    0,QL
         1 010057   200012 721100                    LXL1    I,,AUTO
         1 010060   040140 100540                    MLR     fill='040'O
         1 010061   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         1 010062   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

     1713     9325    3            FITALTKEYS.ALTBLD=FM$CFU.ALTBLD;

   9325  1 010063   200005 470500                    LDP0    LOC$,,AUTO
         1 010064   200010 471500                    LDP1    CFU$,,AUTO
         1 010065   100006 236100                    LDQ     6,,PR1
         1 010066   000006 736000                    QLS     6
         1 010067   000000 676100                    ERQ     0,,PR0
         1 010070   000400 376003                    ANQ     256,DU
         1 010071   000000 656100                    ERSQ    0,,PR0

     1714     9326    3            END;

   9326  1 010072   010203 710000 1                  TRA     s:9341

     1715     9327    3         ELSE IF F$DCB.ORG=%IREL# THEN DO;

   9327  1 010073   015000 116003                    CMPQ    6656,DU
         1 010074   010540 601000 1                  TNZ     s:9417

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:294  
     1716     9328    3               LOCCODX=20;

   9328  1 010075   000024 235007                    LDA     20,DL
         1 010076   200020 755100                    STA     LOCCODX,,AUTO

     1717     9329    3               CALL LOCCODP ALTRET(NOALT);

   9329  1 010077   002543 701000 1                  TSX1    LOCCODP
         1 010100   010533 702000 1                  TSX2    NOALT

     1718     9330    3               CODE20.ALTBLD=FM$CFU.ALTBLD;

   9330  1 010101   200005 470500                    LDP0    LOC$,,AUTO
         1 010102   200010 471500                    LDP1    CFU$,,AUTO
         1 010103   100006 236100                    LDQ     6,,PR1
         1 010104   000017 736000                    QLS     15
         1 010105   000001 676100                    ERQ     1,,PR0
         1 010106   400000 376003                    ANQ     -131072,DU
         1 010107   000001 656100                    ERSQ    1,,PR0

     1719     9331
     1720     9332    4               DO I=0 TO IRKEYS.NKEYS-1;

   9332  1 010110   200012 450100                    STZ     I,,AUTO
         1 010111   010174 710000 1                  TRA     s:9337+3

     1721     9333    4                  CODE20.K.TDALVL(I)=IRKEYS.K.TDALVL(I);

   9333  1 010112   200012 236100                    LDQ     I,,AUTO
         1 010113   000003 402007                    MPY     3,DL
         1 010114   000000 620006                    EAX0    0,QL
         1 010115   200012 236100                    LDQ     I,,AUTO
         1 010116   000007 402007                    MPY     7,DL
         1 010117   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 010120   200005 471500                    LDP1    LOC$,,AUTO
         1 010121   000003 236106                    LDQ     3,QL,PR0
         1 010122   100002 676110                    ERQ     2,X0,PR1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:295  
         1 010123   777000 376003                    ANQ     -512,DU
         1 010124   100002 656110                    ERSQ    2,X0,PR1

     1722     9334    4                  CODE20.K.TDA(I)=IRKEYS.K.TDA(I);

   9334  1 010125   200012 236100                    LDQ     I,,AUTO
         1 010126   000003 402007                    MPY     3,DL
         1 010127   000000 620006                    EAX0    0,QL
         1 010130   200012 236100                    LDQ     I,,AUTO
         1 010131   000007 402007                    MPY     7,DL
         1 010132   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 010133   200005 471500                    LDP1    LOC$,,AUTO
         1 010134   000003 236106                    LDQ     3,QL,PR0
         1 010135   100002 676110                    ERQ     2,X0,PR1
         1 010136   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 010137   100002 656110                    ERSQ    2,X0,PR1

     1723     9335    4                  CODE20.K.FDA(I)=IRKEYS.K.FDA(I);

   9335  1 010140   200012 236100                    LDQ     I,,AUTO
         1 010141   000003 402007                    MPY     3,DL
         1 010142   000000 620006                    EAX0    0,QL
         1 010143   200012 236100                    LDQ     I,,AUTO
         1 010144   000007 402007                    MPY     7,DL
         1 010145   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 010146   200005 471500                    LDP1    LOC$,,AUTO
         1 010147   000007 236106                    LDQ     7,QL,PR0
         1 010150   000011 736000                    QLS     9
         1 010151   100003 676110                    ERQ     3,X0,PR1
         1 010152   000012 376000 2                  ANQ     10
         1 010153   100003 656110                    ERSQ    3,X0,PR1

     1724     9336    4                  CODE20.K.LDA(I)=IRKEYS.K.LDA(I);

   9336  1 010154   200012 236100                    LDQ     I,,AUTO
         1 010155   000003 402007                    MPY     3,DL
         1 010156   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:296  
         1 010157   200012 236100                    LDQ     I,,AUTO
         1 010160   000007 402007                    MPY     7,DL
         1 010161   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 010162   200005 471500                    LDP1    LOC$,,AUTO
         1 010163   000002 736000                    QLS     2
         1 010164   000000 635010                    EAA     0,X0
         1 010165   000020 771000                    ARL     16
         1 010166   000105 100506                    MLR     fill='000'O
         1 010167   000011 200003                    ADSC9   9,Q,PR0                  cn=1,n=3
         1 010170   100003 600003                    ADSC9   3,A,PR1                  cn=3,n=3

     1725     9337    4                  END;

   9337  1 010171   200012 235100                    LDA     I,,AUTO
         1 010172   000001 035007                    ADLA    1,DL
         1 010173   200012 755100                    STA     I,,AUTO
         1 010174   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 010175   000000 236100                    LDQ     0,,PR0
         1 010176   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 010177   200012 116100                    CMPQ    I,,AUTO
         1 010200   010202 600000 1                  TZE     s:9338
         1 010201   010112 603000 1                  TRC     s:9333

     1726     9338    3               END;

   9338  1 010202   010203 710000 1                  TRA     s:9341

     1727     9339    2            ELSE EXIT;
     1728     9340
     1729     9341    2         IF CPN$.ALTKEYS_~=B$PS12$ THEN GOTO NOALT;

   9341  1 010203   200003 470500                    LDP0    @DUMMY,,AUTO
         1 010204   000014 236100                    LDQ     12,,PR0
         1 010205   000000 116000 xsym               CMPQ    B$PS12$
         1 010206   010533 601000 1                  TNZ     NOALT

     1730     9342    2         CALL HFF$DSIZ(B$PS12$, I);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:297  

   9342  1 010207   200012 631500                    EPPR1   I,,AUTO
         1 010210   200053 451500                    STP1    INDX+2,,AUTO
         1 010211   000042 236000 2                  LDQ     34
         1 010212   200052 756100                    STQ     INDX+1,,AUTO
         1 010213   200052 630500                    EPPR0   INDX+1,,AUTO
         1 010214   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 010215   000000 701000 xent               TSX1    HFF$DSIZ
         1 010216   000000 011000                    NOP     0

     1731     9343    2         IF I=0 THEN GOTO NOALT;

   9343  1 010217   200012 235100                    LDA     I,,AUTO
         1 010220   010533 600000 1                  TZE     NOALT

     1732     9344    2         IF NOT FPT$CLOSE_V.OPER.CHGATT THEN GOTO NOALT;

   9344  1 010221   200003 470500                    LDP0    @DUMMY,,AUTO
         1 010222   000000 471500                    LDP1    0,,PR0
         1 010223   100000 236100                    LDQ     0,,PR1
         1 010224   400000 316007                    CANQ    -131072,DL
         1 010225   010533 600000 1                  TZE     NOALT

     1733     9345    3         IF NOT F$DCB.FFLG.REATTR THEN DO;

   9345  1 010226   200004 473500                    LDP3    JDCB$,,AUTO
         1 010227   300004 236100                    LDQ     4,,PR3
         1 010230   004000 316003                    CANQ    2048,DU
         1 010231   010236 601000 1                  TNZ     s:9350

     1734     9346    3            B$JIT.ERR=FMO$E$REATTR;

   9346  1 010232   000014 236000 0                  LDQ     FMO$E$REATTR
         1 010233   000000 474400 xsym               LDP4    B$JIT$
         1 010234   400012 756100                    STQ     10,,PR4

     1735     9347    3            GOTO NOALT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:298  

   9347  1 010235   010533 710000 1                  TRA     NOALT

     1736     9348    3            END;
     1737     9349
     1738     9350    3         IF F$DCB.ORG=%INDEXED# THEN DO;

   9350  1 010236   300032 236100                    LDQ     26,,PR3
         1 010237   777000 376003                    ANQ     -512,DU
         1 010240   006000 116003                    CMPQ    3072,DU
         1 010241   010533 601000 1                  TNZ     NOALT

     1739     9351    3            I=(I-1)/4;

   9351  1 010242   200012 236100                    LDQ     I,,AUTO
         1 010243   000001 136007                    SBLQ    1,DL
         1 010244   000004 506007                    DIV     4,DL
         1 010245   200012 756100                    STQ     I,,AUTO

     1740     9352    3            IF I>80 THEN I=80;

   9352  1 010246   000121 116007                    CMPQ    81,DL
         1 010247   010252 602000 1                  TNC     s:9354

   9352  1 010250   000120 235007                    LDA     80,DL
         1 010251   200012 755100                    STA     I,,AUTO

     1741     9353
     1742     9354    3            IF VLP$ALTKEYS.SIZ#<=I THEN I=VLP$ALTKEYS.SIZ#;

   9354  1 010252   000000 471400 xsym               LDP1    B$PS12$
         1 010253   200012 236100                    LDQ     I,,AUTO
         1 010254   100000 116100                    CMPQ    0,,PR1
         1 010255   010261 602000 1                  TNC     s:9356

   9354  1 010256   100000 235100                    LDA     0,,PR1
         1 010257   200012 755100                    STA     I,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:299  
         1 010260   010265 710000 1                  TRA     s:9368

     1743     9355    4            ELSE DO;

     1744     9356    4               B$JIT.ERR=FMO$E$BADVECT12;

   9356  1 010261   000031 236000 0                  LDQ     FMO$E$BADVECT12
         1 010262   000000 474400 xsym               LDP4    B$JIT$
         1 010263   400012 756100                    STQ     10,,PR4

     1745     9357    4               GOTO NOALT;

   9357  1 010264   010533 710000 1                  TRA     NOALT

     1746     9358                    /*E*   ERROR:   FMO-E$BADVECT12-E
     1747     9359                           MESSAGE: Bad ALTKEY vector on close% of %UF%
     1748     9360                           MESSAGE1:The ALTKEY vector on close% of %UF%
     1749     9361                                    was bad because it was not large enough
     1750     9362                                    to hold all the keys specified or the
     1751     9363                                    specified keys extend beyond the minimum
     1752     9364                                    record size.
     1753     9365                    */
     1754     9366    4               END;
     1755     9367
     1756     9368    3            NEWSIZE=((I+1)*SIZEW(FITALTKEYS.K(0)))+1;

   9368  1 010265   200012 236100                    LDQ     I,,AUTO
         1 010266   000006 402007                    MPY     6,DL
         1 010267   000007 036007                    ADLQ    7,DL
         1 010270   200034 756100                    STQ     NEWSIZE,,AUTO

     1757     9369    3            CALL FSA$GSP(NEWSIZE, XT$) ALTRET(NOALT);

   9369  1 010271   200017 236100                    LDQ     T$$,,AUTO
         1 010272   200053 756100                    STQ     INDX+2,,AUTO
         1 010273   200034 634500                    EPPR4   NEWSIZE,,AUTO
         1 010274   200052 454500                    STP4    INDX+1,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:300  
         1 010275   200052 630500                    EPPR0   INDX+1,,AUTO
         1 010276   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 010277   000000 701000 xent               TSX1    FSA$GSP
         1 010300   010533 702000 1                  TSX2    NOALT

     1758     9370    3            P1$=T$;

   9370  1 010301   200016 236100                    LDQ     T$,,AUTO
         1 010302   200006 756100                    STQ     P1$,,AUTO

     1759     9371
     1760     9372    3            J=NEWSIZE*4;

   9372  1 010303   200034 235100                    LDA     NEWSIZE,,AUTO
         1 010304   000002 735000                    ALS     2
         1 010305   200013 755100                    STA     J,,AUTO

     1761     9373    3            P1$->ZAPJ='0'B;

   9373  1 010306   200006 470500                    LDP0    P1$,,AUTO
         1 010307   000000 620005                    EAX0    0,AL
         1 010310   000140 100400                    MLR     fill='000'O
         1 010311   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 010312   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

     1762     9374    3            IF NEWSIZE > ALTKEY$->FITALTKEYS.NUMWRDS THEN

   9374  1 010313   200025 470500                    LDP0    ALTKEY$,,AUTO
         1 010314   000000 236100                    LDQ     0,,PR0
         1 010315   000033 772000                    QRL     27
         1 010316   200034 116100                    CMPQ    NEWSIZE,,AUTO
         1 010317   010322 605000 1                  TPL     s:9376

     1763     9375    3               J=ALTKEY$->FITALTKEYS.NUMWRDS*4;

   9375  1 010320   000002 736000                    QLS     2
         1 010321   200013 756100                    STQ     J,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:301  

     1764     9376    3            P1$->MOVEJ=ALTKEY$->MOVEJ;

   9376  1 010322   200013 720100                    LXL0    J,,AUTO
         1 010323   200006 471500                    LDP1    P1$,,AUTO
         1 010324   040140 100540                    MLR     fill='040'O
         1 010325   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 010326   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1765     9377    3            P1$->FITALTKEYS.NUMWRDS=NEWSIZE;

   9377  1 010327   200006 470500                    LDP0    P1$,,AUTO
         1 010330   200034 236100                    LDQ     NEWSIZE,,AUTO
         1 010331   000033 736000                    QLS     27
         1 010332   000000 552140                    STBQ    0,'40'O,PR0

     1766     9378
     1767     9379    4            DO K=1 TO I;

   9379  1 010333   000001 235007                    LDA     1,DL
         1 010334   200014 755100                    STA     K,,AUTO
         1 010335   010421 710000 1                  TRA     s:9389+3

     1768     9380    4               P1$->FITALTKEYS.K.KEYL(K)=VLP$ALTKEYS.K.KEYL#(K-1);

   9380  1 010336   200014 236100                    LDQ     K,,AUTO
         1 010337   000006 402007                    MPY     6,DL
         1 010340   000000 470400 xsym               LDP0    B$PS12$
         1 010341   200014 720100                    LXL0    K,,AUTO
         1 010342   200006 471500                    LDP1    P1$,,AUTO
         1 010343   000000 621006                    EAX1    0,QL
         1 010344   000000 236110                    LDQ     0,X0,PR0
         1 010345   000011 736000                    QLS     9
         1 010346   100001 676111                    ERQ     1,X1,PR1
         1 010347   777000 376003                    ANQ     -512,DU
         1 010350   100001 656111                    ERSQ    1,X1,PR1

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:302  
     1769     9381    4               P1$->FITALTKEYS.K.KEYX(K)=VLP$ALTKEYS.K.KEYX#(K-1);

   9381  1 010351   200014 236100                    LDQ     K,,AUTO
         1 010352   000006 402007                    MPY     6,DL
         1 010353   000000 470400 xsym               LDP0    B$PS12$
         1 010354   200014 720100                    LXL0    K,,AUTO
         1 010355   000000 721110                    LXL1    0,X0,PR0
         1 010356   200006 471500                    LDP1    P1$,,AUTO
         1 010357   100003 441106                    SXL1    3,QL,PR1

     1770     9382    4               P1$->FITALTKEYS.K.UNIQUE(K)=VLP$ALTKEYS.K.UNIQUE#(K-1);

   9382  1 010360   200014 236100                    LDQ     K,,AUTO
         1 010361   000006 402007                    MPY     6,DL
         1 010362   200006 470500                    LDP0    P1$,,AUTO
         1 010363   000000 471400 xsym               LDP1    B$PS12$
         1 010364   200014 720100                    LXL0    K,,AUTO
         1 010365   000000 621006                    EAX1    0,QL
         1 010366   100000 236110                    LDQ     0,X0,PR1
         1 010367   000011 772000                    QRL     9
         1 010370   000004 676111                    ERQ     4,X1,PR0
         1 010371   000400 376003                    ANQ     256,DU
         1 010372   000004 656111                    ERSQ    4,X1,PR0

     1771     9383    4               IF VLP$ALTKEYS.K.KEYX#(K-1)+VLP$ALTKEYS.K.KEYL#(K-1) >

   9383  1 010373   000000 470400 xsym               LDP0    B$PS12$
         1 010374   200014 720100                    LXL0    K,,AUTO
         1 010375   000000 236110                    LDQ     0,X0,PR0
         1 010376   000022 772000                    QRL     18
         1 010377   000777 376007                    ANQ     511,DL
         1 010400   200052 756100                    STQ     INDX+1,,AUTO
         1 010401   000000 236110                    LDQ     0,X0,PR0
         1 010402   777777 376007                    ANQ     -1,DL
         1 010403   200052 036100                    ADLQ    INDX+1,,AUTO
         1 010404   200053 756100                    STQ     INDX+2,,AUTO
         1 010405   200025 471500                    LDP1    ALTKEY$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:303  
         1 010406   100000 236100                    LDQ     0,,PR1
         1 010407   007777 376007                    ANQ     4095,DL
         1 010410   200053 116100                    CMPQ    INDX+2,,AUTO
         1 010411   010416 603000 1                  TRC     s:9389

     1772     9384    4                 ALTKEY$->FITALTKEYS.MINWRSIZ THEN
     1773     9385    5               DO;

     1774     9386    5                  B$JIT.ERR=FMO$E$BADVECT12;

   9386  1 010412   000031 236000 0                  LDQ     FMO$E$BADVECT12
         1 010413   000000 473400 xsym               LDP3    B$JIT$
         1 010414   300012 756100                    STQ     10,,PR3

     1775     9387    5                  GOTO BADVECT12;

   9387  1 010415   010515 710000 1                  TRA     BADVECT12

     1776     9388    5                  END;
     1777     9389    4               END;

   9389  1 010416   200014 235100                    LDA     K,,AUTO
         1 010417   000001 035007                    ADLA    1,DL
         1 010420   200014 755100                    STA     K,,AUTO
         1 010421   200012 236100                    LDQ     I,,AUTO
         1 010422   200014 116100                    CMPQ    K,,AUTO
         1 010423   010336 603000 1                  TRC     s:9380

     1778     9390    3            FM$CFU.ALTBLD='1'B;

   9390  1 010424   200010 470500                    LDP0    CFU$,,AUTO
         1 010425   000004 236003                    LDQ     4,DU
         1 010426   000006 256100                    ORSQ    6,,PR0

     1779     9391    3            F$DCB.UNIQUEBLD='1'B;

   9391  1 010427   200004 471500                    LDP1    JDCB$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:304  
         1 010430   002000 236007                    LDQ     1024,DL
         1 010431   100103 256100                    ORSQ    67,,PR1

     1780     9392    3            P1$->FITALTKEYS.ALTBLD='1'B;

   9392  1 010432   200006 473500                    LDP3    P1$,,AUTO
         1 010433   000400 236003                    LDQ     256,DU
         1 010434   300000 256100                    ORSQ    0,,PR3

     1781     9393    3            P1$->FITALTKEYS.UNIQUEBLD='1'B;

   9393  1 010435   200006 473500                    LDP3    P1$,,AUTO
         1 010436   400000 236007                    LDQ     -131072,DL
         1 010437   300000 256100                    ORSQ    0,,PR3

     1782     9394    3            P1$->FITALTKEYS.NUMENTS=I+1;

   9394  1 010440   200006 473500                    LDP3    P1$,,AUTO
         1 010441   200012 236100                    LDQ     I,,AUTO
         1 010442   000001 036007                    ADLQ    1,DL
         1 010443   000022 736000                    QLS     18
         1 010444   300000 676100                    ERQ     0,,PR3
         1 010445   000377 376003                    ANQ     255,DU
         1 010446   300000 656100                    ERSQ    0,,PR3

     1783     9395
     1784     9396    3            CODE=8;

   9396  1 010447   000010 235007                    LDA     8,DL
         1 010450   200035 755100                    STA     CODE,,AUTO

     1785     9397    3            CALL FMO$FITSPACE(NEWSIZE) ALTRET(BADVECT12);

   9397  1 010451   200034 633500                    EPPR3   NEWSIZE,,AUTO
         1 010452   200047 453500                    STP3    FN+3,,AUTO
         1 010453   004717 701000 1                  TSX1    FMO$FITSPACE
         1 010454   010515 702000 1                  TSX2    BADVECT12
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:305  

     1786     9398    3            J=NEWSIZE*4;

   9398  1 010455   200034 235100                    LDA     NEWSIZE,,AUTO
         1 010456   000002 735000                    ALS     2
         1 010457   200013 755100                    STA     J,,AUTO

     1787     9399    3            LOC$->MOVEJ=P1$->MOVEJ;

   9399  1 010460   200006 470500                    LDP0    P1$,,AUTO
         1 010461   000000 620005                    EAX0    0,AL
         1 010462   200005 471500                    LDP1    LOC$,,AUTO
         1 010463   200013 721100                    LXL1    J,,AUTO
         1 010464   040140 100540                    MLR     fill='040'O
         1 010465   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 010466   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     1788     9400    3            K=FITALTKEYS.NUMWRDS;

   9400  1 010467   200005 470500                    LDP0    LOC$,,AUTO
         1 010470   000000 236100                    LDQ     0,,PR0
         1 010471   000033 772000                    QRL     27
         1 010472   200014 756100                    STQ     K,,AUTO

     1789     9401    3            CALL FSA$FSP(K, ALTKEY$);

   9401  1 010473   200025 631500                    EPPR1   ALTKEY$,,AUTO
         1 010474   200053 451500                    STP1    INDX+2,,AUTO
         1 010475   200014 633500                    EPPR3   K,,AUTO
         1 010476   200052 453500                    STP3    INDX+1,,AUTO
         1 010477   200052 630500                    EPPR0   INDX+1,,AUTO
         1 010500   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 010501   000000 701000 xent               TSX1    FSA$FSP
         1 010502   000000 011000                    NOP     0

     1790     9402    3            F$DCB.ALTKEYX=POFFW(P1$, B$ROSEG$);

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:306  
   9402  1 010503   000000 235000 xsym               LDA     B$ROSEG$
         1 010504   000022 771000                    ARL     18
         1 010505   200052 755100                    STA     INDX+1,,AUTO
         1 010506   200006 236100                    LDQ     P1$,,AUTO
         1 010507   000022 772000                    QRL     18
         1 010510   200052 136100                    SBLQ    INDX+1,,AUTO
         1 010511   000000 620006                    EAX0    0,QL
         1 010512   200004 470500                    LDP0    JDCB$,,AUTO
         1 010513   000052 440100                    SXL0    42,,PR0

     1791     9403    4            IF '0'B THEN DO;

   9403  1 010514   010533 710000 1                  TRA     NOALT

   9402  1 010515                       BADVECT12    null
     1792     9404    4   BADVECT12:  ;
     1793     9405    4               K=P1$->FITALTKEYS.NUMWRDS;

   9405  1 010515   200006 470500                    LDP0    P1$,,AUTO
         1 010516   000000 236100                    LDQ     0,,PR0
         1 010517   000033 772000                    QRL     27
         1 010520   200014 756100                    STQ     K,,AUTO

     1794     9406    4               T$=P1$;

   9406  1 010521   200006 236100                    LDQ     P1$,,AUTO
         1 010522   200016 756100                    STQ     T$,,AUTO

     1795     9407    4               CALL FSA$FSP(K, XT$);

   9407  1 010523   200017 236100                    LDQ     T$$,,AUTO
         1 010524   200053 756100                    STQ     INDX+2,,AUTO
         1 010525   200014 631500                    EPPR1   K,,AUTO
         1 010526   200052 451500                    STP1    INDX+1,,AUTO
         1 010527   200052 630500                    EPPR0   INDX+1,,AUTO
         1 010530   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 010531   000000 701000 xent               TSX1    FSA$FSP
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:307  
         1 010532   000000 011000                    NOP     0

     1796     9408    4               END;

     1797     9409    3            END; /* If F$DCB.ORG=%INDEXED# */

   9405  1 010533                       NOALT        null
     1798     9410    2   NOALT: ;
     1799     9411    2         J=0;

   9411  1 010533   200013 450100                    STZ     J,,AUTO

     1800     9412    2         LOCCODX=3;

   9412  1 010534   000003 235007                    LDA     3,DL
         1 010535   200020 755100                    STA     LOCCODX,,AUTO

     1801     9413    2         CALL LOCCODP ALTRET(DONE);

   9413  1 010536   002543 701000 1                  TSX1    LOCCODP
         1 010537   011040 702000 1                  TSX2    DONE

     1802     9414    2         END;  /* If F$DCB.ALTKEYX~=0 */

     1803     9415
     1804     9416                    /* */
     1805     9417    1      IF F$DCB.SPAN OR (FPT$CLOSE_V.OPER.RELG AND F$DCB.FFLG.DELF)

   9417  1 010540   200004 470500                    LDP0    JDCB$,,AUTO
         1 010541   000064 236100                    LDQ     52,,PR0
         1 010542   100000 316007                    CANQ    32768,DL
         1 010543   010554 601000 1                  TNZ     s:9418
         1 010544   200003 471500                    LDP1    @DUMMY,,AUTO
         1 010545   100000 473500                    LDP3    0,,PR1
         1 010546   300000 236100                    LDQ     0,,PR3
         1 010547   200000 316007                    CANQ    65536,DL
         1 010550   010565 600000 1                  TZE     s:9419
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:308  
         1 010551   000004 236100                    LDQ     4,,PR0
         1 010552   020000 316003                    CANQ    8192,DU
         1 010553   010565 600000 1                  TZE     s:9419

     1806     9418    1      THEN IF BUFNO=1 THEN CALL FMG$KEYSQZ(J); /* MAKE 1 GRAN FILE IF POSS */

   9418  1 010554   200015 235100                    LDA     BUFNO,,AUTO
         1 010555   000001 115007                    CMPA    1,DL
         1 010556   010565 601000 1                  TNZ     s:9419

   9418  1 010557   200013 631500                    EPPR1   J,,AUTO
         1 010560   200052 451500                    STP1    INDX+1,,AUTO
         1 010561   200052 630500                    EPPR0   INDX+1,,AUTO
         1 010562   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 010563   000000 701000 xent               TSX1    FMG$KEYSQZ
         1 010564   000000 011000                    NOP     0

     1807     9419    1      CODE03.UGRANS=FM$CFU.UGRANS;

   9419  1 010565   200010 470500                    LDP0    CFU$,,AUTO
         1 010566   200005 471500                    LDP1    LOC$,,AUTO
         1 010567   000004 236100                    LDQ     4,,PR0
         1 010570   100000 552134                    STBQ    0,'34'O,PR1

     1808     9420    1      CODE03.LDA=FM$CFU.LDA;

   9420  1 010571   200005 471500                    LDP1    LOC$,,AUTO
         1 010572   000006 235100                    LDA     6,,PR0
         1 010573   000007 236100                    LDQ     7,,PR0
         1 010574   000033 773000                    LRL     27
         1 010575   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 010576   100004 552134                    STBQ    4,'34'O,PR1

     1809     9421    1      CODE03.NGAVAL=FM$CFU.NGAVAL;

   9421  1 010577   200005 471500                    LDP1    LOC$,,AUTO
         1 010600   000007 236100                    LDQ     7,,PR0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:309  
         1 010601   100003 552134                    STBQ    3,'34'O,PR1

     1810     9422    1      IF F$DCB.ORG=%RANDOM# OR F$DCB.ORG=%IDS#

   9422  1 010602   200004 471500                    LDP1    JDCB$,,AUTO
         1 010603   100032 236100                    LDQ     26,,PR1
         1 010604   777000 376003                    ANQ     -512,DU
         1 010605   003000 116003                    CMPQ    1536,DU
         1 010606   010611 600000 1                  TZE     s:9423
         1 010607   007000 116003                    CMPQ    3584,DU
         1 010610   010616 601000 1                  TNZ     s:9424

     1811     9423    1      THEN CODE03.NRECS=FM$CFU.UGRANS;

   9423  1 010611   000004 236100                    LDQ     4,,PR0
         1 010612   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 010613   200005 473500                    LDP3    LOC$,,AUTO
         1 010614   300002 756100                    STQ     2,,PR3
         1 010615   010621 710000 1                  TRA     s:9425

     1812     9424    1      ELSE CODE03.NRECS=FM$CFU.NRECS;

   9424  1 010616   200005 473500                    LDP3    LOC$,,AUTO
         1 010617   000001 235100                    LDA     1,,PR0
         1 010620   300002 755100                    STA     2,,PR3

     1813     9425    1      IF CODE03.RCSZ<FM$CFU.RCSZ

   9425  1 010621   000004 236100                    LDQ     4,,PR0
         1 010622   000033 772000                    QRL     27
         1 010623   200052 756100                    STQ     INDX+1,,AUTO
         1 010624   200005 473500                    LDP3    LOC$,,AUTO
         1 010625   300003 236100                    LDQ     3,,PR3
         1 010626   000033 772000                    QRL     27
         1 010627   200052 116100                    CMPQ    INDX+1,,AUTO
         1 010630   010633 605000 1                  TPL     s:9427

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:310  
     1814     9426    1      THEN CODE03.RCSZ=FM$CFU.RCSZ;

   9426  1 010631   000004 236100                    LDQ     4,,PR0
         1 010632   300003 552140                    STBQ    3,'40'O,PR3

     1815     9427    1      IF NOT FM$CFU.FMOD THEN F$DCB.DESC=CODE03.DESC;

   9427  1 010633   000000 236100                    LDQ     0,,PR0
         1 010634   004000 316003                    CANQ    2048,DU
         1 010635   010642 601000 1                  TNZ     s:9428

   9427  1 010636   200005 473500                    LDP3    LOC$,,AUTO
         1 010637   300001 220100                    LDX0    1,,PR3
         1 010640   100005 440100                    SXL0    5,,PR1
         1 010641   010645 710000 1                  TRA     s:9429

     1816     9428    1      ELSE CODE03.DESC=F$DCB.DESC;

   9428  1 010642   100005 720100                    LXL0    5,,PR1
         1 010643   200005 473500                    LDP3    LOC$,,AUTO
         1 010644   300001 740100                    STX0    1,,PR3

     1817     9429    1      F$DCB.BFR.BUFUP(BUFNO)='1'B;

   9429  1 010645   200015 720100                    LXL0    BUFNO,,AUTO
         1 010646   400000 236003                    LDQ     -131072,DU
         1 010647   100115 256110                    ORSQ    77,X0,PR1

     1818     9430    1      IF (FPT$CLOSE_V.OPER.RELG AND F$DCB.FUN~=%IN#

   9430  1 010650   200003 473500                    LDP3    @DUMMY,,AUTO
         1 010651   300000 474500                    LDP4    0,,PR3
         1 010652   400000 236100                    LDQ     0,,PR4
         1 010653   200000 316007                    CANQ    65536,DL
         1 010654   010661 600000 1                  TZE     s:9430+9
         1 010655   100032 236100                    LDQ     26,,PR1
         1 010656   000777 376003                    ANQ     511,DU
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:311  
         1 010657   000002 116003                    CMPQ    2,DU
         1 010660   010663 601000 1                  TNZ     s:9430+11
         1 010661   200013 235100                    LDA     J,,AUTO
         1 010662   010703 600000 1                  TZE     s:9441
         1 010663   200005 475500                    LDP5    LOC$,,AUTO
         1 010664   500003 236100                    LDQ     3,,PR5
         1 010665   000032 316000 xsym               CANQ    B_VECTNIL+26
         1 010666   010703 600000 1                  TZE     s:9441

     1819     9431    1        OR J~=0)
     1820     9432    1        AND CODE03.NGAVAL~=0
     1821     9433    1      THEN IF NOT F$DCB.FFLG.DELF AND J=0 THEN B$JIT.ERR=FMO$E$CLSREL;

   9433  1 010667   100004 236100                    LDQ     4,,PR1
         1 010670   020000 316003                    CANQ    8192,DU
         1 010671   010700 601000 1                  TNZ     s:9434
         1 010672   200013 235100                    LDA     J,,AUTO
         1 010673   010700 601000 1                  TNZ     s:9434

   9433  1 010674   000017 236000 0                  LDQ     FMO$E$CLSREL
         1 010675   000000 476400 xsym               LDP6    B$JIT$
         1 010676   600012 756100                    STQ     10,,PR6
         1 010677   010704 710000 1                  TRA     s:9446

     1822     9434    1         ELSE CALL RELG;

   9434  1 010700   012021 701000 1                  TSX1    RELG
         1 010701   000000 011000                    NOP     0
         1 010702   010704 710000 1                  TRA     s:9446

     1823     9435                    /*
     1824     9436                       IMPORTANT CONSIDERATION !!..
     1825     9437                       The RELG routine will leave an extent in J and K to
     1826     9438                       be released at the label "DONE". J-K MUST NOT be
     1827     9439                       altered prior to that.
     1828     9440                    */
     1829     9441    1      ELSE J=0;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:312  

   9441  1 010703   200013 450100                    STZ     J,,AUTO

     1830     9442                    /**/
     1831     9443                    /*
     1832     9444                    *  NOW UPDATE KEYED FILE INFORMATION
     1833     9445                    */
     1834     9446    1      LOCCODX=2;

   9446  1 010704   000002 235007                    LDA     2,DL
         1 010705   200020 755100                    STA     LOCCODX,,AUTO

     1835     9447    1      CALL LOCCODP ALTRET(NXTCODE);

   9447  1 010706   002543 701000 1                  TSX1    LOCCODP
         1 010707   010766 702000 1                  TSX2    NXTCODE

     1836     9448    1      CODE02.SLIDE=FM$CFU.SLIDE;

   9448  1 010710   200010 470500                    LDP0    CFU$,,AUTO
         1 010711   200005 471500                    LDP1    LOC$,,AUTO
         1 010712   000005 236100                    LDQ     5,,PR0
         1 010713   000033 772000                    QRL     27
         1 010714   100000 552104                    STBQ    0,'04'O,PR1

     1837     9449    1      CODE02.GDA=FM$CFU.GDA;

   9449  1 010715   200005 471500                    LDP1    LOC$,,AUTO
         1 010716   000005 236100                    LDQ     5,,PR0
         1 010717   100002 552134                    STBQ    2,'34'O,PR1

     1838     9450                    /*
     1839     9451                      If it's an alt key file, the TDA left in the DCB may be for a
     1840     9452                      secondary key, so stuff in the TDA for the primary key just
     1841     9453                      in case.
     1842     9454                    */
     1843     9455    2      IF F$DCB.ALTKEYX>0 THEN DO;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:313  

   9455  1 010720   200004 471500                    LDP1    JDCB$,,AUTO
         1 010721   100052 720100                    LXL0    42,,PR1
         1 010722   010756 600000 1                  TZE     s:9466

     1844     9456    2         ALTKEY$=PINCRW(B$ROSEG$, F$DCB.ALTKEYX);

   9456  1 010723   000000 636010                    EAQ     0,X0
         1 010724   000000 036000 xsym               ADLQ    B$ROSEG$
         1 010725   200025 756100                    STQ     ALTKEY$,,AUTO

     1845     9457    3         IF F$DCB.ORG=%INDEXED# THEN DO;

   9457  1 010726   100032 236100                    LDQ     26,,PR1
         1 010727   777000 376003                    ANQ     -512,DU
         1 010730   006000 116003                    CMPQ    3072,DU
         1 010731   010746 601000 1                  TNZ     s:9462

     1846     9458    3            F$DCB.TDA=ALTKEY$->FITALTKEYS.K.TDA(0);

   9458  1 010732   200025 473500                    LDP3    ALTKEY$,,AUTO
         1 010733   300002 235100                    LDA     2,,PR3
         1 010734   300003 236100                    LDQ     3,,PR3
         1 010735   000022 773000                    LRL     18
         1 010736   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 010737   100070 552134                    STBQ    56,'34'O,PR1

     1847     9459    3            F$DCB.TDALVL=ALTKEY$->FITALTKEYS.K.TDALVL(0);

   9459  1 010740   300004 236100                    LDQ     4,,PR3
         1 010741   000006 736000                    QLS     6
         1 010742   100067 676100                    ERQ     55,,PR1
         1 010743   700000 376003                    ANQ     -32768,DU
         1 010744   100067 656100                    ERSQ    55,,PR1

     1848     9460    3            END;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:314  
   9460  1 010745   010756 710000 1                  TRA     s:9466

     1849     9461    3         ELSE DO;

     1850     9462    3            F$DCB.TDA=IRKEYS.K.TDA(0);

   9462  1 010746   200025 473500                    LDP3    ALTKEY$,,AUTO
         1 010747   300003 236100                    LDQ     3,,PR3
         1 010750   100070 552134                    STBQ    56,'34'O,PR1

     1851     9463    3            F$DCB.TDALVL=IRKEYS.K.TDALVL(0);

   9463  1 010751   300003 236100                    LDQ     3,,PR3
         1 010752   000006 736000                    QLS     6
         1 010753   100067 676100                    ERQ     55,,PR1
         1 010754   700000 376003                    ANQ     -32768,DU
         1 010755   100067 656100                    ERSQ    55,,PR1

     1852     9464    3            END;

     1853     9465    2         END;

     1854     9466    1      CODE02.TDALVL=F$DCB.TDALVL;

   9466  1 010756   200005 473500                    LDP3    LOC$,,AUTO
         1 010757   100067 236100                    LDQ     55,,PR1
         1 010760   700000 376003                    ANQ     -32768,DU
         1 010761   000006 772000                    QRL     6
         1 010762   300001 552140                    STBQ    1,'40'O,PR3

     1855     9467    1      CODE02.TDA=JDCB$->F$DCB.TDA;

   9467  1 010763   200005 473500                    LDP3    LOC$,,AUTO
         1 010764   100070 236100                    LDQ     56,,PR1
         1 010765   300001 552134                    STBQ    1,'34'O,PR3

     1856     9468                    /**/
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:315  
     1857     9469                    /*
     1858     9470                    *  NOW UPDATE THE DATES RECORD
     1859     9471                    */
     1860     9472    1   NXTCODE:
     1861     9473    1      LOCCODX=16;

   9473  1 010766   000020 235007       NXTCODE      LDA     16,DL
         1 010767   200020 755100                    STA     LOCCODX,,AUTO

     1862     9474    1      CALL LOCCODP ALTRET(NXTCODE1);

   9474  1 010770   002543 701000 1                  TSX1    LOCCODP
         1 010771   011007 702000 1                  TSX2    NXTCODE1

     1863     9475                    /* NOW UPDATE THE UR INFO */
     1864     9476    1      F$DCB.FORM$->CODE16.IWL=F$DCB.IWL;

   9476  1 010772   200004 470500                    LDP0    JDCB$,,AUTO
         1 010773   000050 471500                    LDP1    40,,PR0
         1 010774   000103 236100                    LDQ     67,,PR0
         1 010775   770000 376007                    ANQ     -4096,DL
         1 010776   000001 772000                    QRL     1
         1 010777   100026 676100                    ERQ     22,,PR1
         1 011000   377000 376007                    ANQ     130560,DL
         1 011001   100026 656100                    ERSQ    22,,PR1

     1865     9477    1      CODE16=F$DCB.FORM$->CODE16;

   9477  1 011002   000050 471500                    LDP1    40,,PR0
         1 011003   200005 473500                    LDP3    LOC$,,AUTO
         1 011004   000100 100500                    MLR     fill='000'O
         1 011005   100000 000234                    ADSC9   0,,PR1                   cn=0,n=156
         1 011006   300000 000234                    ADSC9   0,,PR3                   cn=0,n=156

   9477  1 011007                       NXTCODE1     null
     1866     9478    1   NXTCODE1:;
     1867     9479    1      LOCCODX=4;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:316  

   9479  1 011007   000004 235007                    LDA     4,DL
         1 011010   200020 755100                    STA     LOCCODX,,AUTO

     1868     9480    1      CALL LOCCODP ALTRET(DONE);

   9480  1 011011   002543 701000 1                  TSX1    LOCCODP
         1 011012   011040 702000 1                  TSX2    DONE

     1869     9481    1      IF CODE04.SVMODIFY

   9481  1 011013   200005 470500                    LDP0    LOC$,,AUTO
         1 011014   000010 235100                    LDA     8,,PR0
         1 011015   011036 600000 1                  TZE     s:9485

     1870     9482    1      THEN IF FM$CFU.SHARED AND NOT FM$CFU.FMOD

   9482  1 011016   200010 471500                    LDP1    CFU$,,AUTO
         1 011017   100000 236100                    LDQ     0,,PR1
         1 011020   002000 316003                    CANQ    1024,DU
         1 011021   011027 600000 1                  TZE     s:9484
         1 011022   004000 316003                    CANQ    2048,DU
         1 011023   011027 601000 1                  TNZ     s:9484

     1871     9483    1         THEN CODE04.MODIFY.TIME=CODE04.SVMODIFY.TIME;

   9483  1 011024   000010 235100                    LDA     8,,PR0
         1 011025   000001 755100                    STA     1,,PR0
         1 011026   011036 710000 1                  TRA     s:9485

     1872     9484    1         ELSE CALL SSS$SYSTIME(CODE04.MODIFY);

   9484  1 011027   200005 236100                    LDQ     LOC$,,AUTO
         1 011030   000001 036003                    ADLQ    1,DU
         1 011031   200052 756100                    STQ     INDX+1,,AUTO
         1 011032   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011033   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:317  
         1 011034   000000 701000 xent               TSX1    SSS$SYSTIME
         1 011035   000000 011000                    NOP     0

     1873     9485    1      CODE04.SVMODIFY.TIME=0;

   9485  1 011036   200005 470500                    LDP0    LOC$,,AUTO
         1 011037   000010 450100                    STZ     8,,PR0

   9485  1 011040                       DONE         null
     1874     9486        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:318  
     1875     9487    1   DONE:;
     1876     9488                    /* RELEASE THE NGAVAL EXTENT NOW, IF REQUIRED */
     1877     9489                    /* SAVE THE NEW FIT IF NEW UPPER LEVEL JUST BUILT */
     1878     9490    2      IF J~=0 OR FM$CFU.FUN>4 THEN DO;

   9490  1 011040   200013 235100                    LDA     J,,AUTO
         1 011041   011047 601000 1                  TNZ     s:9491
         1 011042   200010 470500                    LDP0    CFU$,,AUTO
         1 011043   000000 236100                    LDQ     0,,PR0
         1 011044   700000 376003                    ANQ     -32768,DU
         1 011045   500000 116003                    CMPQ    -98304,DU
         1 011046   011101 602000 1                  TNC     s:9495

     1879     9491    2         CALL FMD$WRTSV(BUFNO);

   9491  1 011047   200015 630500                    EPPR0   BUFNO,,AUTO
         1 011050   200052 450500                    STP0    INDX+1,,AUTO
         1 011051   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011052   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 011053   000000 701000 xent               TSX1    FMD$WRTSV
         1 011054   000000 011000                    NOP     0

     1880     9492    2         IF J~=0 THEN CALL FAG$REXT(J);

   9492  1 011055   200013 235100                    LDA     J,,AUTO
         1 011056   011065 600000 1                  TZE     s:9493

   9492  1 011057   200013 630500                    EPPR0   J,,AUTO
         1 011060   200052 450500                    STP0    INDX+1,,AUTO
         1 011061   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011062   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 011063   000000 701000 xent               TSX1    FAG$REXT
         1 011064   000000 011000                    NOP     0

     1881     9493    2         IF FM$CFU.FUN>4 THEN FM$CFU.FUN=FM$CFU.FUN-4;

   9493  1 011065   200010 470500                    LDP0    CFU$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:319  
         1 011066   000000 236100                    LDQ     0,,PR0
         1 011067   700000 376003                    ANQ     -32768,DU
         1 011070   500000 116003                    CMPQ    -98304,DU
         1 011071   011101 602000 1                  TNC     s:9495

   9493  1 011072   000000 236100                    LDQ     0,,PR0
         1 011073   000041 772000                    QRL     33
         1 011074   000004 136007                    SBLQ    4,DL
         1 011075   000041 736000                    QLS     33
         1 011076   000000 676100                    ERQ     0,,PR0
         1 011077   700000 376003                    ANQ     -32768,DU
         1 011100   000000 656100                    ERSQ    0,,PR0

     1882     9494    2         END;

     1883     9495    2      IF FPT$CLOSE_V.OPER.CHGATT AND F$DCB.FUN~=%IN# THEN DO;

   9495  1 011101   200003 471500                    LDP1    @DUMMY,,AUTO
         1 011102   100000 473500                    LDP3    0,,PR1
         1 011103   300000 236100                    LDQ     0,,PR3
         1 011104   400000 316007                    CANQ    -131072,DL
         1 011105   011150 600000 1                  TZE     ALLDONE
         1 011106   200004 474500                    LDP4    JDCB$,,AUTO
         1 011107   400032 236100                    LDQ     26,,PR4
         1 011110   000777 376003                    ANQ     511,DU
         1 011111   000002 116003                    CMPQ    2,DU
         1 011112   011150 600000 1                  TZE     ALLDONE

     1884     9496    2         IF PN$.NAME_~=ADDR(NIL) THEN

   9496  1 011113   100003 236100                    LDQ     3,,PR1
         1 011114   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 011115   011150 600000 1                  TZE     ALLDONE

     1885     9497    2            IF NOT F$DCB.FFLG.DELF THEN B$JIT.ERR=FMO$E$RENAME;

   9497  1 011116   400004 236100                    LDQ     4,,PR4
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:320  
         1 011117   020000 316003                    CANQ    8192,DU
         1 011120   011125 601000 1                  TNZ     s:9498

   9497  1 011121   000012 236000 0                  LDQ     FMO$E$RENAME
         1 011122   000000 475400 xsym               LDP5    B$JIT$
         1 011123   500012 756100                    STQ     10,,PR5
         1 011124   011150 710000 1                  TRA     ALLDONE

     1886     9498    2            ELSE IF F$DCB.ACS=%JRNL#

   9498  1 011125   400036 236100                    LDQ     30,,PR4
         1 011126   000777 376007                    ANQ     511,DL
         1 011127   000004 116007                    CMPQ    4,DL
         1 011130   011135 600000 1                  TZE     s:9500
         1 011131   000000 236100                    LDQ     0,,PR0
         1 011132   060000 376003                    ANQ     24576,DU
         1 011133   060000 116003                    CMPQ    24576,DU
         1 011134   011145 601000 1                  TNZ     s:9501

     1887     9499    2                 OR FM$CFU.SHARE=%NONE#
     1888     9500    2               THEN CALL FMP$RENAME(PN$.NAME_)ALTRET(FMOALTRET);

   9500  1 011135   200003 236100                    LDQ     @DUMMY,,AUTO
         1 011136   000003 036003                    ADLQ    3,DU
         1 011137   200052 756100                    STQ     INDX+1,,AUTO
         1 011140   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011141   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 011142   000000 701000 xent               TSX1    FMP$RENAME
         1 011143   013126 702000 1                  TSX2    FMOALTRET
         1 011144   011150 710000 1                  TRA     ALLDONE

     1889     9501    2               ELSE B$JIT.ERR=FMO$E$RENAME;

   9501  1 011145   000012 236000 0                  LDQ     FMO$E$RENAME
         1 011146   000000 475400 xsym               LDP5    B$JIT$
         1 011147   500012 756100                    STQ     10,,PR5

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:321  
     1890     9502    2         END;

   9500  1 011150                       ALLDONE      null
     1891     9503        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:322  
     1892     9504    1   ALLDONE:;
     1893     9505    1      IF B$JIT.PRIV.ACTIVE.FMEFT

   9505  1 011150   000000 470400 xsym               LDP0    B$JIT$
         1 011151   000013 234100                    SZN     11,,PR0
         1 011152   011733 605000 1                  TPL     s:9618
         1 011153   200003 471500                    LDP1    @DUMMY,,AUTO
         1 011154   100000 473500                    LDP3    0,,PR1
         1 011155   300000 236100                    LDQ     0,,PR3
         1 011156   076000 316007                    CANQ    31744,DL
         1 011157   011733 600000 1                  TZE     s:9618

     1894     9506    2        AND FPT$CLOSE_V.EFTOPER THEN DO;

     1895     9507                    /* EFT WANTS TO MUCK WITH THE FILES STATE */
     1896     9508    2         IF FM$CFU.FITSDA=0 THEN GOTO MEBBEDELF; /* NOT MUCH POSSIBLE IF NO FIT */

   9508  1 011160   200010 474500                    LDP4    CFU$,,AUTO
         1 011161   400000 236100                    LDQ     0,,PR4
         1 011162   000032 316000 xsym               CANQ    B_VECTNIL+26
         1 011163   011416 600000 1                  TZE     MEBBEDELF

     1897     9509    2         CALL FMN$GETFIT(BUF$,BUFNO)ALTRET(MEBBEDELF);

   9509  1 011164   200015 635500                    EPPR5   BUFNO,,AUTO
         1 011165   200053 455500                    STP5    INDX+2,,AUTO
         1 011166   200011 633500                    EPPR3   BUF$,,AUTO
         1 011167   200052 453500                    STP3    INDX+1,,AUTO
         1 011170   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011171   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 011172   000000 701000 xent               TSX1    FMN$GETFIT
         1 011173   011416 702000 1                  TSX2    MEBBEDELF

     1898     9510    2         CALL SSS$SYSTIME(I);

   9510  1 011174   200012 630500                    EPPR0   I,,AUTO
         1 011175   200052 450500                    STP0    INDX+1,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:323  
         1 011176   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011177   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 011200   000000 701000 xent               TSX1    SSS$SYSTIME
         1 011201   000000 011000                    NOP     0

     1899     9511    2         FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));

   9511  1 011202   200011 236100                    LDQ     BUF$,,AUTO
         1 011203   000005 036003                    ADLQ    5,DU
         1 011204   200007 756100                    STQ     FIT$,,AUTO

     1900     9512    2         IF FPT$CLOSE_V.EFTOPER.UPDDESC AND NOT FPT$CLOSE_V.OPER.CHGATT

   9512  1 011205   200003 470500                    LDP0    @DUMMY,,AUTO
         1 011206   000000 471500                    LDP1    0,,PR0
         1 011207   100000 236100                    LDQ     0,,PR1
         1 011210   004000 316007                    CANQ    2048,DL
         1 011211   011217 600000 1                  TZE     s:9514
         1 011212   400000 316007                    CANQ    -131072,DL
         1 011213   011217 601000 1                  TNZ     s:9514

     1901     9513    2         THEN F$DCB.DESC=FPT$CLOSE_V.DESC;

   9513  1 011214   100001 220100                    LDX0    1,,PR1
         1 011215   200004 473500                    LDP3    JDCB$,,AUTO
         1 011216   300005 440100                    SXL0    5,,PR3

     1902     9514    2         J=0;

   9514  1 011217   200013 450100                    STZ     J,,AUTO

     1903     9515    2         IF FPT$CLOSE_V.EFTOPER.ASTOW THEN J=6;

   9515  1 011220   000000 471500                    LDP1    0,,PR0
         1 011221   100000 236100                    LDQ     0,,PR1
         1 011222   020000 316007                    CANQ    8192,DL
         1 011223   011226 600000 1                  TZE     s:9516
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:324  

   9515  1 011224   000006 235007                    LDA     6,DL
         1 011225   200013 755100                    STA     J,,AUTO

     1904     9516    2         IF FPT$CLOSE_V.EFTOPER.BACKUP THEN J=5;

   9516  1 011226   000000 471500                    LDP1    0,,PR0
         1 011227   100000 236100                    LDQ     0,,PR1
         1 011230   040000 316007                    CANQ    16384,DL
         1 011231   011234 600000 1                  TZE     s:9517

   9516  1 011232   000005 235007                    LDA     5,DL
         1 011233   200013 755100                    STA     J,,AUTO

     1905     9517    3         IF J~=0 THEN DO;

   9517  1 011234   200013 235100                    LDA     J,,AUTO
         1 011235   011315 600000 1                  TZE     EFTDESC

     1906     9518    3            IF J=5 THEN F$DCB.DESC.BUF='0'B;

   9518  1 011236   000005 115007                    CMPA    5,DL
         1 011237   011244 601000 1                  TNZ     s:9520

   9518  1 011240   200004 471500                    LDP1    JDCB$,,AUTO
         1 011241   000043 236000 2                  LDQ     35
         1 011242   100005 356100                    ANSQ    5,,PR1
         1 011243   011251 710000 1                  TRA     s:9523

     1907     9519    4            ELSE DO;

     1908     9520    4               F$DCB.DESC.QS='0'B;

   9520  1 011244   200004 471500                    LDP1    JDCB$,,AUTO
         1 011245   000044 236000 2                  LDQ     36
         1 011246   100005 356100                    ANSQ    5,,PR1

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:325  
     1909     9521    4               F$DCB.DESC.ARCHIVE='1'B;

   9521  1 011247   001000 236007                    LDQ     512,DL
         1 011250   100005 256100                    ORSQ    5,,PR1

     1910     9522    4               END;

     1911     9523    3            T$=FIT$;

   9523  1 011251   200007 236100                    LDQ     FIT$,,AUTO
         1 011252   200016 756100                    STQ     T$,,AUTO

     1912     9524    3            CALL FMO$LOCCODE(XT$,J)ALTRET(EFTDESC);

   9524  1 011253   200013 633500                    EPPR3   J,,AUTO
         1 011254   200053 453500                    STP3    INDX+2,,AUTO
         1 011255   200017 236100                    LDQ     T$$,,AUTO
         1 011256   200052 756100                    STQ     INDX+1,,AUTO
         1 011257   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011260   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 011261   000000 701000 xent               TSX1    FMO$LOCCODE
         1 011262   011315 702000 1                  TSX2    EFTDESC

     1913     9525    3            LOC$=T$;

   9525  1 011263   200016 236100                    LDQ     T$,,AUTO
         1 011264   200005 756100                    STQ     LOC$,,AUTO

     1914     9526    3            FM$FIT.CODES.NDW(J)=3;

   9526  1 011265   200007 470500                    LDP0    FIT$,,AUTO
         1 011266   200013 720100                    LXL0    J,,AUTO
         1 011267   000000 236110                    LDQ     0,X0,PR0
         1 011270   000004 376000 2                  ANQ     4
         1 011271   006000 276007                    ORQ     3072,DL
         1 011272   000000 756110                    STQ     0,X0,PR0

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:326  
     1915     9527    3            CODE05.BACKUP.TIME=I;

   9527  1 011273   200005 471500                    LDP1    LOC$,,AUTO
         1 011274   200012 235100                    LDA     I,,AUTO
         1 011275   100000 755100                    STA     0,,PR1

     1916     9528    3            CODE05.BACKUP.REEL=VLP$SN.SN#(0);

   9528  1 011276   200003 471500                    LDP1    @DUMMY,,AUTO
         1 011277   100001 473500                    LDP3    1,,PR1
         1 011300   200005 474500                    LDP4    LOC$,,AUTO
         1 011301   040100 100500                    MLR     fill='040'O
         1 011302   300001 000006                    ADSC9   1,,PR3                   cn=0,n=6
         1 011303   400001 000006                    ADSC9   1,,PR4                   cn=0,n=6

     1917     9529    3            CODE05.BACKUP.EFT=BINBIT(FPT$CLOSE_V.EXPIRE,LENGTHB(CODE05.BACKUP.EFT));

   9529  1 011304   100000 473500                    LDP3    0,,PR1
         1 011305   300002 236100                    LDQ     2,,PR3
         1 011306   000022 736000                    QLS     18
         1 011307   000022 732000                    QRS     18
         1 011310   000022 736000                    QLS     18
         1 011311   000022 772000                    QRL     18
         1 011312   000000 620006                    EAX0    0,QL
         1 011313   200005 474500                    LDP4    LOC$,,AUTO
         1 011314   400002 440100                    SXL0    2,,PR4

     1918     9530    3            END;

   9529  1 011315                       EFTDESC      null
     1919     9531    2   EFTDESC:;
     1920     9532    3         IF PN$.IFPARAM_~=ADDR(NIL) THEN DO CODE=4 TO 6;

   9532  1 011315   200003 470500                    LDP0    @DUMMY,,AUTO
         1 011316   000013 236100                    LDQ     11,,PR0
         1 011317   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 011320   011346 600000 1                  TZE     s:9539
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:327  

   9532  1 011321   000004 235007                    LDA     4,DL
         1 011322   200035 755100                    STA     CODE,,AUTO

     1921     9533    3            T$=PN$.IFPARAM_;

   9533  1 011323   200003 470500                    LDP0    @DUMMY,,AUTO
         1 011324   000013 236100                    LDQ     11,,PR0
         1 011325   200016 756100                    STQ     T$,,AUTO

     1922     9534    3            CALL FMO$LOCCODP(XT$,CODE)ALTRET(NOEFTUP);

   9534  1 011326   200035 631500                    EPPR1   CODE,,AUTO
         1 011327   200053 451500                    STP1    INDX+2,,AUTO
         1 011330   200017 236100                    LDQ     T$$,,AUTO
         1 011331   200052 756100                    STQ     INDX+1,,AUTO
         1 011332   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011333   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 011334   000000 701000 xent               TSX1    FMO$LOCCODP
         1 011335   011342 702000 1                  TSX2    NOEFTUP

     1923     9535    3            P1$=T$;

   9535  1 011336   200016 236100                    LDQ     T$,,AUTO
         1 011337   200006 756100                    STQ     P1$,,AUTO

     1924     9536    3            CALL FMO$BLDCODE;

   9536  1 011340   000566 701000 1                  TSX1    FMO$BLDCODE
         1 011341   000000 011000                    NOP     0

   9535  1 011342                       NOEFTUP      null
     1925     9537    3   NOEFTUP: ;
     1926     9538    3            END;

   9538  1 011342   200035 054100                    AOS     CODE,,AUTO
         1 011343   200035 235100                    LDA     CODE,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:328  
         1 011344   000006 115007                    CMPA    6,DL
         1 011345   011323 604400 1                  TMOZ    s:9533

     1927     9539    2         LOCCODX=3;

   9539  1 011346   000003 235007                    LDA     3,DL
         1 011347   200020 755100                    STA     LOCCODX,,AUTO

     1928     9540    2         CALL LOCCODP ALTRET(FMOE$BADFIT);

   9540  1 011350   002543 701000 1                  TSX1    LOCCODP
         1 011351   012015 702000 1                  TSX2    FMOE$BADFIT

     1929     9541    2         CODE03.DESC=F$DCB.DESC;

   9541  1 011352   200004 470500                    LDP0    JDCB$,,AUTO
         1 011353   000005 720100                    LXL0    5,,PR0
         1 011354   200005 471500                    LDP1    LOC$,,AUTO
         1 011355   100001 740100                    STX0    1,,PR1

     1930     9542    3         IF FM$CFU.SHARED AND F$DCB.DESC.BUPM AND FM$CFU.USECNT>1 THEN DO;

   9542  1 011356   200010 471500                    LDP1    CFU$,,AUTO
         1 011357   100000 236100                    LDQ     0,,PR1
         1 011360   002000 316003                    CANQ    1024,DU
         1 011361   011412 600000 1                  TZE     s:9554
         1 011362   000005 236100                    LDQ     5,,PR0
         1 011363   000400 316007                    CANQ    256,DL
         1 011364   011412 600000 1                  TZE     s:9554
         1 011365   100003 720100                    LXL0    3,,PR1
         1 011366   000002 100003                    CMPX0   2,DU
         1 011367   011412 602000 1                  TNC     s:9554

     1931     9543                    /* Keep the directory BUF descriptor on for the last closer */
     1932     9544    3            F$DCB.DESC.BUF='1'B;

   9544  1 011370   100000 236007                    LDQ     32768,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:329  
         1 011371   000005 256100                    ORSQ    5,,PR0

     1933     9545    4            IF FM$CFU.FMOD THEN DO;

   9545  1 011372   100000 236100                    LDQ     0,,PR1
         1 011373   004000 316003                    CANQ    2048,DU
         1 011374   011412 600000 1                  TZE     s:9554

     1934     9546                    /* File is not modified anymore, sort of.  Fix previous mod date */
     1935     9547    4               FM$CFU.FMOD='0'B;

   9547  1 011375   000045 236000 2                  LDQ     37
         1 011376   100000 356100                    ANSQ    0,,PR1

     1936     9548    4               LOCCODX=4;

   9548  1 011377   000004 235007                    LDA     4,DL
         1 011400   200020 755100                    STA     LOCCODX,,AUTO

     1937     9549    5               CALL LOCCODP WHENRETURN DO;

   9549  1 011401   002543 701000 1                  TSX1    LOCCODP
         1 011402   011412 702000 1                  TSX2    s:9554

     1938     9550    5                  CALL SSS$SYSTIME(CODE04.SVMODIFY);

   9550  1 011403   200005 236100                    LDQ     LOC$,,AUTO
         1 011404   000010 036003                    ADLQ    8,DU
         1 011405   200052 756100                    STQ     INDX+1,,AUTO
         1 011406   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011407   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 011410   000000 701000 xent               TSX1    SSS$SYSTIME
         1 011411   000000 011000                    NOP     0

     1939     9551    5                  END;

     1940     9552    4               END;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:330  

     1941     9553    3            END;

     1942     9554    2         F$DCB.BFR.BUFUP(BUFNO)='1'B;

   9554  1 011412   200004 470500                    LDP0    JDCB$,,AUTO
         1 011413   200015 720100                    LXL0    BUFNO,,AUTO
         1 011414   400000 236003                    LDQ     -131072,DU
         1 011415   000115 256110                    ORSQ    77,X0,PR0

   9554  1 011416                       MEBBEDELF    null
     1943     9555    2   MEBBEDELF:;
     1944     9556    2         CALL FMR$L8;

   9556  1 011416   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 011417   000000 701000 xent               TSX1    FMR$L8
         1 011420   000000 011000                    NOP     0

     1945     9557    2         IF (FPT$CLOSE_V.EFTOPER.DELFDE

   9557  1 011421   200003 470500                    LDP0    @DUMMY,,AUTO
         1 011422   000000 471500                    LDP1    0,,PR0
         1 011423   100000 236100                    LDQ     0,,PR1
         1 011424   002000 316007                    CANQ    1024,DL
         1 011425   011430 601000 1                  TNZ     s:9557+7
         1 011426   010000 316007                    CANQ    4096,DL
         1 011427   011730 600000 1                  TZE     s:9615
         1 011430   200010 473500                    LDP3    CFU$,,AUTO
         1 011431   300000 236100                    LDQ     0,,PR3
         1 011432   700000 376003                    ANQ     -32768,DU
         1 011433   300000 116003                    CMPQ    98304,DU
         1 011434   011730 603000 1                  TRC     s:9615
         1 011435   300002 720100                    LXL0    2,,PR3
         1 011436   011730 600000 1                  TZE     s:9615
         1 011437   300000 236100                    LDQ     0,,PR3
         1 011440   010000 316003                    CANQ    4096,DU
         1 011441   011730 601000 1                  TNZ     s:9615
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:331  
         1 011442   300002 236100                    LDQ     2,,PR3
         1 011443   000022 772000                    QRL     18
         1 011444   000000 116000 xsym               CMPQ    FM_SYSACCTX
         1 011445   011461 601000 1                  TNZ     s:9565
         1 011446   200004 474500                    LDP4    JDCB$,,AUTO
         1 011447   400004 236100                    LDQ     4,,PR4
         1 011450   020000 316003                    CANQ    8192,DU
         1 011451   011461 601000 1                  TNZ     s:9565
         1 011452   300000 236100                    LDQ     0,,PR3
         1 011453   000032 316000 xsym               CANQ    B_VECTNIL+26
         1 011454   011461 600000 1                  TZE     s:9565
         1 011455   040000 106500                    CMPC    fill='040'O
         1 011456   400010 200007                    ADSC9   8,,PR4                   cn=1,n=7
         1 011457   000045 000007 0                  ADSC9   FMO$E$BADIFLD+1          cn=0,n=7
         1 011460   011730 600000 1                  TZE     s:9615

     1946     9558    2           OR FPT$CLOSE_V.EFTOPER.ISTOW)
     1947     9559    2           AND FM$CFU.FUN<%CREATE#
     1948     9560    2           AND FM$CFU.NAMEX~=0
     1949     9561    2           AND FM$CFU.ACFU=0
     1950     9562    2           AND (FM$CFU.ACCTX~=FM_SYSACCTX
     1951     9563    2           OR F$DCB.FFLG.DELF OR FM$CFU.FITSDA=0
     1952     9564    3           OR SUBSTR(F$DCB.NAME.C,0,7)~=':SECLOG') THEN DO;

     1953     9565    3            FM$CFU.FUN=FM$CFU.FUN+4; /* MAKE IT STAY THAT WAY */

   9565  1 011461   300000 236100                    LDQ     0,,PR3
         1 011462   000041 772000                    QRL     33
         1 011463   000004 036007                    ADLQ    4,DL
         1 011464   000041 736000                    QLS     33
         1 011465   300000 676100                    ERQ     0,,PR3
         1 011466   700000 376003                    ANQ     -32768,DU
         1 011467   300000 656100                    ERSQ    0,,PR3

     1954     9566    3            CALL FMR$U8;

   9566  1 011470   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:332  
         1 011471   000000 701000 xent               TSX1    FMR$U8
         1 011472   000000 011000                    NOP     0

     1955     9567    3            F$DCB.BFR.BUFUP(BUFNO)='0'B;

   9567  1 011473   200004 470500                    LDP0    JDCB$,,AUTO
         1 011474   200015 720100                    LXL0    BUFNO,,AUTO
         1 011475   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 011476   000115 356110                    ANSQ    77,X0,PR0

     1956     9568    4            IF FPT$CLOSE_V.EFTOPER.ISTOW THEN DO;

   9568  1 011477   200003 471500                    LDP1    @DUMMY,,AUTO
         1 011500   100000 473500                    LDP3    0,,PR1
         1 011501   300000 236100                    LDQ     0,,PR3
         1 011502   010000 316007                    CANQ    4096,DL
         1 011503   011522 600000 1                  TZE     s:9573

     1957     9569    4               LOC$=FIT$;

   9569  1 011504   200007 236100                    LDQ     FIT$,,AUTO
         1 011505   200005 756100                    STQ     LOC$,,AUTO

     1958     9570    4               CALL FMO$LOCCODP(LOC$,6)ALTRET(FMOE$BADFIT);

   9570  1 011506   000046 236000 2                  LDQ     38
         1 011507   200053 756100                    STQ     INDX+2,,AUTO
         1 011510   200005 633500                    EPPR3   LOC$,,AUTO
         1 011511   200052 453500                    STP3    INDX+1,,AUTO
         1 011512   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011513   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 011514   000000 701000 xent               TSX1    FMO$LOCCODP
         1 011515   012015 702000 1                  TSX2    FMOE$BADFIT

     1959     9571    4               ADDR(I)->CODE06=CODE06;

   9571  1 011516   200005 470500                    LDP0    LOC$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:333  
         1 011517   000100 100500                    MLR     fill='000'O
         1 011520   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12
         1 011521   200012 000014                    ADSC9   I,,AUTO                  cn=0,n=12

     1960     9572    4               END;

     1961     9573    3            P1$=PINCRW(F$CFU$,FM$CFU.ACCTX);

   9573  1 011522   200010 470500                    LDP0    CFU$,,AUTO
         1 011523   000002 220100                    LDX0    2,,PR0
         1 011524   000000 636010                    EAQ     0,X0
         1 011525   000000 036000 xsym               ADLQ    F$CFU$
         1 011526   200006 756100                    STQ     P1$,,AUTO

     1962     9574    3            T$=P1$;

   9574  1 011527   200016 756100                    STQ     T$,,AUTO

     1963     9575    3            CALL UQB$MENQX(XT$)ALTRET(FMOALTRET);

   9575  1 011530   200017 630500                    EPPR0   T$$,,AUTO
         1 011531   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 011532   000000 701000 xent               TSX1    UQB$MENQX
         1 011533   013126 702000 1                  TSX2    FMOALTRET

     1964     9576    3            CALL FMQ$SRCHFD(ADDR(F$DCB.NAME),CODE,CODE,XT$,ADDR(ANYFOPN))

   9576  1 011534   200004 236100                    LDQ     JDCB$,,AUTO
         1 011535   000010 036003                    ADLQ    8,DU
         1 011536   200052 756100                    STQ     INDX+1,,AUTO
         1 011537   000047 236000 2                  LDQ     39
         1 011540   200053 756100                    STQ     INDX+2,,AUTO
         1 011541   200053 630500                    EPPR0   INDX+2,,AUTO
         1 011542   200060 450500                    STP0    INDX+7,,AUTO
         1 011543   200017 236100                    LDQ     T$$,,AUTO
         1 011544   200057 756100                    STQ     INDX+6,,AUTO
         1 011545   200035 631500                    EPPR1   CODE,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:334  
         1 011546   200056 451500                    STP1    INDX+5,,AUTO
         1 011547   200035 633500                    EPPR3   CODE,,AUTO
         1 011550   200055 453500                    STP3    INDX+4,,AUTO
         1 011551   200052 634500                    EPPR4   INDX+1,,AUTO
         1 011552   200054 454500                    STP4    INDX+3,,AUTO
         1 011553   200054 630500                    EPPR0   INDX+3,,AUTO
         1 011554   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 011555   000000 701000 xent               TSX1    FMQ$SRCHFD
         1 011556   011560 702000 1                  TSX2    EFTFDERR
         1 011557   011563 710000 1                  TRA     s:9582

     1965     9577    4            WHENALTRETURN DO;

   9577  1 011560                       EFTFDERR     null
     1966     9578    4   EFTFDERR:   ;
     1967     9579    4               I=1;

   9579  1 011560   000001 235007                    LDA     1,DL
         1 011561   200012 755100                    STA     I,,AUTO

     1968     9580    4               GOTO EFTFDQ;

   9580  1 011562   011656 710000 1                  TRA     EFTFDQ

     1969     9581    4               END;
     1970     9582    4            IF FPT$CLOSE_V.EFTOPER.DELFDE THEN DO;

   9582  1 011563   200003 470500                    LDP0    @DUMMY,,AUTO
         1 011564   000000 471500                    LDP1    0,,PR0
         1 011565   100000 236100                    LDQ     0,,PR1
         1 011566   002000 316007                    CANQ    1024,DL
         1 011567   011574 600000 1                  TZE     s:9586

     1971     9583    4               CALL FMG$REMKEY;

   9583  1 011570   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 011571   000000 701000 xent               TSX1    FMG$REMKEY
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:335  
         1 011572   000000 011000                    NOP     0

     1972     9584    4               END;

   9584  1 011573   011655 710000 1                  TRA     s:9599

     1973     9585    4            ELSE DO;

     1974     9586    4               CALL FMG$CURKEY(XT$,CODE) ALTRET(EFTFDERR);

   9586  1 011574   200035 633500                    EPPR3   CODE,,AUTO
         1 011575   200053 453500                    STP3    INDX+2,,AUTO
         1 011576   200017 236100                    LDQ     T$$,,AUTO
         1 011577   200052 756100                    STQ     INDX+1,,AUTO
         1 011600   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011601   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 011602   000000 701000 xent               TSX1    FMG$CURKEY
         1 011603   011560 702000 1                  TSX2    EFTFDERR

     1975     9587    5               IF CODE<SIZEW(CODE06)+SIZEW(FM$FDSEG) THEN DO;

   9587  1 011604   200035 235100                    LDA     CODE,,AUTO
         1 011605   000004 115007                    CMPA    4,DL
         1 011606   011631 605000 1                  TPL     s:9591

     1976     9588    5                  CALL FMG$ADDSEG(CODE,SIZEW(CODE06)) ALTRET(EFTFDERR);

   9588  1 011607   000050 236000 2                  LDQ     40
         1 011610   200053 756100                    STQ     INDX+2,,AUTO
         1 011611   200035 630500                    EPPR0   CODE,,AUTO
         1 011612   200052 450500                    STP0    INDX+1,,AUTO
         1 011613   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011614   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 011615   000000 701000 xent               TSX1    FMG$ADDSEG
         1 011616   011560 702000 1                  TSX2    EFTFDERR

     1977     9589    5                  CALL FMG$CURKEY(XT$,CODE,CODE) ALTRET(EFTFDERR);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:336  

   9589  1 011617   200035 630500                    EPPR0   CODE,,AUTO
         1 011620   200054 450500                    STP0    INDX+3,,AUTO
         1 011621   200035 631500                    EPPR1   CODE,,AUTO
         1 011622   200053 451500                    STP1    INDX+2,,AUTO
         1 011623   200017 236100                    LDQ     T$$,,AUTO
         1 011624   200052 756100                    STQ     INDX+1,,AUTO
         1 011625   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011626   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 011627   000000 701000 xent               TSX1    FMG$CURKEY
         1 011630   011560 702000 1                  TSX2    EFTFDERR

     1978     9590    5                  END;

     1979     9591    4               FIT$=T$;

   9591  1 011631   200016 236100                    LDQ     T$,,AUTO
         1 011632   200007 756100                    STQ     FIT$,,AUTO

     1980     9592    4               F$DCB.BFR.BUFUP(1)='1'B;

   9592  1 011633   200004 470500                    LDP0    JDCB$,,AUTO
         1 011634   400000 236003                    LDQ     -131072,DU
         1 011635   000116 256100                    ORSQ    78,,PR0

     1981     9593    4               FM$FDSEG.DESC='0'B;

   9593  1 011636   200007 471500                    LDP1    FIT$,,AUTO
         1 011637   000000 236003                    LDQ     0,DU
         1 011640   100000 552140                    STBQ    0,'40'O,PR1

     1982     9594    4               FM$FDSEG.DESC.ARCHIVE='1'B;

   9594  1 011641   001000 236003                    LDQ     512,DU
         1 011642   100000 256100                    ORSQ    0,,PR1

     1983     9595    4               FM$FDSEG.DESC.DELF='1'B;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:337  

   9595  1 011643   400000 236003                    LDQ     -131072,DU
         1 011644   100000 256100                    ORSQ    0,,PR1

     1984     9596    4               FM$FDSEG.DESC.ODSTOW = F$DCB.DESC.ODSTOW;

   9596  1 011645   000005 236100                    LDQ     5,,PR0
         1 011646   000022 736000                    QLS     18
         1 011647   100000 676100                    ERQ     0,,PR1
         1 011650   040000 376003                    ANQ     16384,DU
         1 011651   100000 656100                    ERSQ    0,,PR1

     1985     9597    4               ADDR(FM$FDSTOW.CODE06)->CODE06=ADDR(I)->CODE06;

   9597  1 011652   000100 100500                    MLR     fill='000'O
         1 011653   200012 000014                    ADSC9   I,,AUTO                  cn=0,n=12
         1 011654   100001 000014                    ADSC9   1,,PR1                   cn=0,n=12

     1986     9598    4               END;

     1987     9599    3            I=0; /* Flag saying we did something - the file went away */

   9599  1 011655   200012 450100                    STZ     I,,AUTO

   9599  1 011656                       EFTFDQ       null
     1988     9600    3   EFTFDQ:  ;
     1989     9601    3            CALL FMD$FLSHBUF(1);

   9601  1 011656   000000 630400 2                  EPPR0   0
         1 011657   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 011660   000000 701000 xent               TSX1    FMD$FLSHBUF
         1 011661   000000 011000                    NOP     0

     1990     9602    3            T$=P1$;

   9602  1 011662   200006 236100                    LDQ     P1$,,AUTO
         1 011663   200016 756100                    STQ     T$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:338  

     1991     9603    3            CALL UQB$MDEQ(XT$);

   9603  1 011664   200017 630500                    EPPR0   T$$,,AUTO
         1 011665   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 011666   000000 701000 xent               TSX1    UQB$MDEQ
         1 011667   000000 011000                    NOP     0

     1992     9604    3            IF I~=0 THEN RETURN;

   9604  1 011670   200012 235100                    LDA     I,,AUTO
         1 011671   011673 600000 1                  TZE     s:9605

   9604  1 011672   000000 702200 xent               TSX2  ! X66_ARET

     1993     9605    3            CALL FMR$L8;

   9605  1 011673   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 011674   000000 701000 xent               TSX1    FMR$L8
         1 011675   000000 011000                    NOP     0

     1994     9606    3            I=MOD(FM$CFU.UGRANS+FM$CFU.NGAVAL,%BITBIN('1000000000'O));

   9606  1 011676   200010 470500                    LDP0    CFU$,,AUTO
         1 011677   000007 236100                    LDQ     7,,PR0
         1 011700   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 011701   200052 756100                    STQ     INDX+1,,AUTO
         1 011702   000004 236100                    LDQ     4,,PR0
         1 011703   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 011704   200052 036100                    ADLQ    INDX+1,,AUTO
         1 011705   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 011706   200012 756100                    STQ     I,,AUTO

     1995     9607    4            IF I>0 THEN DO;

   9607  1 011707   011715 600000 1                  TZE     s:9611

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:339  
     1996     9608    4               FM$CFUA.GRANS=FM$CFUA.GRANS+I;

   9608  1 011710   200006 471500                    LDP1    P1$,,AUTO
         1 011711   100007 036100                    ADLQ    7,,PR1
         1 011712   100007 756100                    STQ     7,,PR1

     1997     9609    4               FM$CFUA.GMOD=1;

   9609  1 011713   100000 236003                    LDQ     32768,DU
         1 011714   100005 256100                    ORSQ    5,,PR1

     1998     9610    4               END;

     1999     9611    3            CALL FMR$FN(F$DCB.CFU$);

   9611  1 011715   200004 236100                    LDQ     JDCB$,,AUTO
         1 011716   000066 036003                    ADLQ    54,DU
         1 011717   200052 756100                    STQ     INDX+1,,AUTO
         1 011720   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011721   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 011722   000000 701000 xent               TSX1    FMR$FN
         1 011723   000000 011000                    NOP     0

     2000     9612    3            CALL FMR$U8;

   9612  1 011724   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 011725   000000 701000 xent               TSX1    FMR$U8
         1 011726   000000 011000                    NOP     0

     2001     9613    3            RETURN;

   9613  1 011727   000000 702200 xent               TSX2  ! X66_ARET

     2002     9614    3            END;
     2003     9615    2         CALL FMR$U8;

   9615  1 011730   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:340  
         1 011731   000000 701000 xent               TSX1    FMR$U8
         1 011732   000000 011000                    NOP     0

     2004     9616    2         END;

     2005     9617        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:341  
     2006     9618    1      IF F$DCB.BFR.BUFUP(BUFNO) THEN CALL FMD$WRTSV(BUFNO);

   9618  1 011733   200004 470500                    LDP0    JDCB$,,AUTO
         1 011734   200015 720100                    LXL0    BUFNO,,AUTO
         1 011735   000115 234110                    SZN     77,X0,PR0
         1 011736   011745 605000 1                  TPL     s:9619

   9618  1 011737   200015 631500                    EPPR1   BUFNO,,AUTO
         1 011740   200052 451500                    STP1    INDX+1,,AUTO
         1 011741   200052 630500                    EPPR0   INDX+1,,AUTO
         1 011742   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 011743   000000 701000 xent               TSX1    FMD$WRTSV
         1 011744   000000 011000                    NOP     0

     2007     9619    2      IF F$DCB.UPDCNT AND FM$CFU.FUN=%UPDATE# THEN DO;

   9619  1 011745   200004 470500                    LDP0    JDCB$,,AUTO
         1 011746   000103 236100                    LDQ     67,,PR0
         1 011747   001000 316007                    CANQ    512,DL
         1 011750   012014 600000 1                  TZE     s:9628
         1 011751   200010 471500                    LDP1    CFU$,,AUTO
         1 011752   100000 236100                    LDQ     0,,PR1
         1 011753   700000 376003                    ANQ     -32768,DU
         1 011754   100000 116003                    CMPQ    32768,DU
         1 011755   012014 601000 1                  TNZ     s:9628

     2008     9620                    /* This is shared-update. Let's see if it's not update anymore. */
     2009     9621    2         CALL FMR$L8;

   9621  1 011756   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 011757   000000 701000 xent               TSX1    FMR$L8
         1 011760   000000 011000                    NOP     0

     2010     9622    2         PINCRW(F$CFU$,FM$CFU.XTX)->FM$CFUEXT.UPDCNT=

   9622  1 011761   200010 470500                    LDP0    CFU$,,AUTO
         1 011762   000003 220100                    LDX0    3,,PR0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:342  
         1 011763   000000 471400 xsym               LDP1    F$CFU$
         1 011764   100000 236110                    LDQ     0,X0,PR1
         1 011765   000022 772000                    QRL     18
         1 011766   007777 376007                    ANQ     4095,DL
         1 011767   000001 136007                    SBLQ    1,DL
         1 011770   000022 736000                    QLS     18
         1 011771   100000 676110                    ERQ     0,X0,PR1
         1 011772   007777 376003                    ANQ     4095,DU
         1 011773   100000 656110                    ERSQ    0,X0,PR1

     2011     9623    2           PINCRW(F$CFU$,FM$CFU.XTX)->FM$CFUEXT.UPDCNT-1;
     2012     9624    2         IF PINCRW(F$CFU$,FM$CFU.XTX)->FM$CFUEXT.UPDCNT=0 THEN FM$CFU.FUN=%IN#;

   9624  1 011774   000003 220100                    LDX0    3,,PR0
         1 011775   000000 471400 xsym               LDP1    F$CFU$
         1 011776   100000 236110                    LDQ     0,X0,PR1
         1 011777   007777 316003                    CANQ    4095,DU
         1 012000   012005 601000 1                  TNZ     s:9625

   9624  1 012001   000000 236100                    LDQ     0,,PR0
         1 012002   000051 376000 2                  ANQ     41
         1 012003   200000 276003                    ORQ     65536,DU
         1 012004   000000 756100                    STQ     0,,PR0

     2013     9625    2         FM$CFU.SHARE=%ALL#;

   9625  1 012005   000000 236100                    LDQ     0,,PR0
         1 012006   000052 376000 2                  ANQ     42
         1 012007   020000 276003                    ORQ     8192,DU
         1 012010   000000 756100                    STQ     0,,PR0

     2014     9626    2         CALL FMR$U8;

   9626  1 012011   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 012012   000000 701000 xent               TSX1    FMR$U8
         1 012013   000000 011000                    NOP     0

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:343  
     2015     9627    2         END;

     2016     9628    1      RETURN;

   9628  1 012014   000000 702200 xent               TSX2  ! X66_ARET

     2017     9629                    /**/
     2018     9630    1   FMOE$BADFIT:
     2019     9631    1      B$JIT$->B$JIT.ERR=FMO$E$BADFIT; /* FIT HAS BEEN CLOBBERED */

   9631  1 012015   000015 236000 0     FMOE$BADFIT  LDQ     FMO$E$BADFIT
         1 012016   000000 470400 xsym               LDP0    B$JIT$
         1 012017   000012 756100                    STQ     10,,PR0

     2020     9632    1      ALTRETURN;

   9632  1 012020   000000 702200 xent               TSX2  ! X66_AALT

     2021     9633        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:344  
     2022     9634    1   RELG: PROC;

   9634  1 012021   200036 741300       RELG         STX1  ! CODE+1,,AUTO

     2023     9635                    /*I* NAME:         RELG
     2024     9636
     2025     9637                         PURPOSE:      RELG releases unused extents during a file
     2026     9638                                       close.
     2027     9639
     2028     9640                         CALL:         CALL RELG;
     2029     9641
     2030     9642                         DESCRIPTION:  RELG works backwards through the extent list
     2031     9643                                       in the CFU in order to release FM$CFU.NGAVAL
     2032     9644                                       extents. If an entire extent must be released
     2033     9645                                       and there's still more to give back after that,
     2034     9646                                       the extent is released by calling FAG$REXT.
     2035     9647                                       The CODE01 is kept current and the FIT written
     2036     9648                                       out as each extent is released.
     2037     9649
     2038     9650                                       IMPORTANT CONSIDERATION:  The very last extent
     2039     9651                                       or partial extent to be released is not released
     2040     9652                                       here. Instead, the extent is set up in the
     2041     9653                                       J and K variables to be released later
     2042     9654                                       (probably at the label DONE in FMO$MODFIT).
     2043     9655                                       Ergo, the values in J and K MUST NOT BE ALTERED
     2044     9656                                       prior to that time. This appears to be done in
     2045     9657                                       order to save a call to write out the FIT.
     2046     9658                    */
     2047     9659    2      K=CODE03.NGAVAL;

   9659  1 012022   200005 470500                    LDP0    LOC$,,AUTO
         1 012023   000003 236100                    LDQ     3,,PR0
         1 012024   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 012025   200014 756100                    STQ     K,,AUTO

     2048     9660    2      CODE03.NGAVAL=0;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:345  
   9660  1 012026   000000 236003                    LDQ     0,DU
         1 012027   000003 552134                    STBQ    3,'34'O,PR0

     2049     9661    3      IF F$DCB.STARF THEN DO;

   9661  1 012030   200004 470500                    LDP0    JDCB$,,AUTO
         1 012031   000064 236100                    LDQ     52,,PR0
         1 012032   200000 316003                    CANQ    65536,DU
         1 012033   012053 600000 1                  TZE     s:9666

     2050     9662    3         CALL FMR$UPDGAC(B$JIT.TMPGAC,B$JIT.CURTMPDP);

   9662  1 012034   000000 236000 xsym               LDQ     B$JIT$
         1 012035   000240 036003                    ADLQ    160,DU
         1 012036   200053 756100                    STQ     INDX+2,,AUTO
         1 012037   000000 236000 xsym               LDQ     B$JIT$
         1 012040   000246 036003                    ADLQ    166,DU
         1 012041   200052 756100                    STQ     INDX+1,,AUTO
         1 012042   200052 630500                    EPPR0   INDX+1,,AUTO
         1 012043   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 012044   000000 701000 xent               TSX1    FMR$UPDGAC
         1 012045   000000 011000                    NOP     0

     2051     9663    3         B$JIT.CURTMPDP=B$JIT.CURTMPDP-K;

   9663  1 012046   000000 470400 xsym               LDP0    B$JIT$
         1 012047   000240 236100                    LDQ     160,,PR0
         1 012050   200014 136100                    SBLQ    K,,AUTO
         1 012051   000240 756100                    STQ     160,,PR0

     2052     9664    3         END;

   9664  1 012052   012130 710000 1                  TRA     s:9678

     2053     9665    3      ELSE DO;

     2054     9666    3         P1$=CFU$;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:346  

   9666  1 012053   200010 236100                    LDQ     CFU$,,AUTO
         1 012054   200006 756100                    STQ     P1$,,AUTO

     2055     9667    3         CALL FMR$L8;

   9667  1 012055   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 012056   000000 701000 xent               TSX1    FMR$L8
         1 012057   000000 011000                    NOP     0

     2056     9668    3         IF FM$CFU.ACCTX=0 THEN P1$=PINCRW(F$CFU$,FM$CFU.NAMEX);

   9668  1 012060   200010 470500                    LDP0    CFU$,,AUTO
         1 012061   000002 220100                    LDX0    2,,PR0
         1 012062   012067 601000 1                  TNZ     s:9669

   9668  1 012063   000002 721100                    LXL1    2,,PR0
         1 012064   000000 636011                    EAQ     0,X1
         1 012065   000000 036000 xsym               ADLQ    F$CFU$
         1 012066   200006 756100                    STQ     P1$,,AUTO

     2057     9669    3         P1$=PINCRW(F$CFU$,P1$->FM$CFU.ACCTX);

   9669  1 012067   200006 471500                    LDP1    P1$,,AUTO
         1 012070   100002 220100                    LDX0    2,,PR1
         1 012071   000000 636010                    EAQ     0,X0
         1 012072   000000 036000 xsym               ADLQ    F$CFU$
         1 012073   200006 756100                    STQ     P1$,,AUTO

     2058     9670    3         IF F$DCB.WSR~=1 AND P1.WOFF~=FM_SYSACCTX

   9670  1 012074   200004 471500                    LDP1    JDCB$,,AUTO
         1 012075   100040 236100                    LDQ     32,,PR1
         1 012076   000777 376003                    ANQ     511,DU
         1 012077   000001 116003                    CMPQ    1,DU
         1 012100   012111 600000 1                  TZE     s:9672
         1 012101   200006 236100                    LDQ     P1$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:347  
         1 012102   000022 772000                    QRL     18
         1 012103   000000 116000 xsym               CMPQ    FM_SYSACCTX
         1 012104   012111 600000 1                  TZE     s:9672

     2059     9671    3         THEN B$JIT.PRDPRM=B$JIT.PRDPRM+K;

   9671  1 012105   000000 473400 xsym               LDP3    B$JIT$
         1 012106   300242 236100                    LDQ     162,,PR3
         1 012107   200014 036100                    ADLQ    K,,AUTO
         1 012110   300242 756100                    STQ     162,,PR3

     2060     9672    3         FM$CFUA.GRANS=FM$CFUA.GRANS+K;

   9672  1 012111   200006 473500                    LDP3    P1$,,AUTO
         1 012112   300007 236100                    LDQ     7,,PR3
         1 012113   200014 036100                    ADLQ    K,,AUTO
         1 012114   300007 756100                    STQ     7,,PR3

     2061     9673    3         FM$CFUA.GMOD=1;

   9673  1 012115   100000 236003                    LDQ     32768,DU
         1 012116   300005 256100                    ORSQ    5,,PR3

     2062     9674    3         I=K+FM$CFU.UGRANS;

   9674  1 012117   000004 236100                    LDQ     4,,PR0
         1 012120   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 012121   200014 036100                    ADLQ    K,,AUTO
         1 012122   200012 756100                    STQ     I,,AUTO

     2063     9675    3         CALL FMR$U8;

   9675  1 012123   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 012124   000000 701000 xent               TSX1    FMR$U8
         1 012125   000000 011000                    NOP     0

     2064     9676    3         CALL UPDGAC;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:348  

   9676  1 012126   002506 701000 1                  TSX1    UPDGAC
         1 012127   000000 011000                    NOP     0

     2065     9677    3         END;

     2066     9678    3      DO WHILE(FM$CFU.NGAVAL~=0);

   9678  1 012130   200010 470500                    LDP0    CFU$,,AUTO
         1 012131   000007 236100                    LDQ     7,,PR0
         1 012132   000032 316000 xsym               CANQ    B_VECTNIL+26
         1 012133   012440 600000 1                  TZE     s:9738

     2067     9679    3         FM$CFU.NGAVAL=0;

   9679  1 012134   200010 470500                    LDP0    CFU$,,AUTO
         1 012135   000000 236003                    LDQ     0,DU
         1 012136   000007 552134                    STBQ    7,'34'O,PR0

     2068     9680    3         P1$=PINCRW(F$CFU$,FM$CFU.XTX);

   9680  1 012137   000003 220100                    LDX0    3,,PR0
         1 012140   000000 636010                    EAQ     0,X0
         1 012141   000000 036000 xsym               ADLQ    F$CFU$
         1 012142   200006 756100                    STQ     P1$,,AUTO

     2069     9681    4         DO WHILE (FM$CFUEXT.LINKX~=0);

   9681  1 012143   200006 471500                    LDP1    P1$,,AUTO
         1 012144   100000 720100                    LXL0    0,,PR1
         1 012145   012156 600000 1                  TZE     s:9684

     2070     9682    4            P1$=PINCRW(F$CFU$,FM$CFUEXT.LINKX);

   9682  1 012146   200006 470500                    LDP0    P1$,,AUTO
         1 012147   000000 720100                    LXL0    0,,PR0
         1 012150   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:349  
         1 012151   000000 036000 xsym               ADLQ    F$CFU$
         1 012152   200006 756100                    STQ     P1$,,AUTO

     2071     9683    4            END;

   9683  1 012153   200006 470500                    LDP0    P1$,,AUTO
         1 012154   000000 720100                    LXL0    0,,PR0
         1 012155   012146 601000 1                  TNZ     s:9682

     2072     9684    3         LOC$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(1)+FM$FIT.CODES.NDW(1)-1);

   9684  1 012156   200007 470500                    LDP0    FIT$,,AUTO
         1 012157   000001 236100                    LDQ     1,,PR0
         1 012160   000012 772000                    QRL     10
         1 012161   001777 376007                    ANQ     1023,DL
         1 012162   200052 756100                    STQ     INDX+1,,AUTO
         1 012163   000001 236100                    LDQ     1,,PR0
         1 012164   001777 376007                    ANQ     1023,DL
         1 012165   200052 036100                    ADLQ    INDX+1,,AUTO
         1 012166   000022 736000                    QLS     18
         1 012167   000001 136003                    SBLQ    1,DU
         1 012170   200007 036100                    ADLQ    FIT$,,AUTO
         1 012171   200005 756100                    STQ     LOC$,,AUTO

     2073     9685    3         I=FM$CFUEXT.NUM;

   9685  1 012172   200006 471500                    LDP1    P1$,,AUTO
         1 012173   100000 236100                    LDQ     0,,PR1
         1 012174   000036 772000                    QRL     30
         1 012175   200012 756100                    STQ     I,,AUTO

     2074     9686    4         IF LOC$->OS.SIZ=0 THEN DO;

   9686  1 012176   200005 473500                    LDP3    LOC$,,AUTO
         1 012177   300000 236100                    LDQ     0,,PR3
         1 012200   777000 316003                    CANQ    -512,DU
         1 012201   012221 601000 1                  TNZ     s:9694
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:350  

     2075     9687    4            LOC$=PINCRW(LOC$,-1);

   9687  1 012202   200005 236100                    LDQ     LOC$,,AUTO
         1 012203   777777 036003                    ADLQ    -1,DU
         1 012204   200005 756100                    STQ     LOC$,,AUTO

     2076     9688    4            J=LOC$->O.SIZ-K;

   9688  1 012205   200005 473500                    LDP3    LOC$,,AUTO
         1 012206   300001 236100                    LDQ     1,,PR3
         1 012207   200014 136100                    SBLQ    K,,AUTO
         1 012210   200013 756100                    STQ     J,,AUTO

     2077     9689    4            LOC$->O.SIZ=J;

   9689  1 012211   300001 756100                    STQ     1,,PR3

     2078     9690    4            I=I-1;

   9690  1 012212   200012 235100                    LDA     I,,AUTO
         1 012213   000001 135007                    SBLA    1,DL
         1 012214   200012 755100                    STA     I,,AUTO

     2079     9691    4            PINCRW(P1$,I)->O.SIZ=J;

   9691  1 012215   200006 471500                    LDP1    P1$,,AUTO
         1 012216   200013 236100                    LDQ     J,,AUTO
         1 012217   100001 756105                    STQ     1,AL,PR1

     2080     9692    4            END;

   9692  1 012220   012236 710000 1                  TRA     s:9698

     2081     9693    4         ELSE DO;

     2082     9694    4            J=LOC$->OS.SIZ-K;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:351  

   9694  1 012221   300000 236100                    LDQ     0,,PR3
         1 012222   000033 772000                    QRL     27
         1 012223   200014 136100                    SBLQ    K,,AUTO
         1 012224   200013 756100                    STQ     J,,AUTO

     2083     9695    4            LOC$->OS.SIZ=J;

   9695  1 012225   000033 736000                    QLS     27
         1 012226   300000 552140                    STBQ    0,'40'O,PR3

     2084     9696    4            PINCRW(P1$,I)->OS.SIZ=J;

   9696  1 012227   200006 471500                    LDP1    P1$,,AUTO
         1 012230   200012 720100                    LXL0    I,,AUTO
         1 012231   200013 236100                    LDQ     J,,AUTO
         1 012232   000033 736000                    QLS     27
         1 012233   100000 676110                    ERQ     0,X0,PR1
         1 012234   777000 376003                    ANQ     -512,DU
         1 012235   100000 656110                    ERSQ    0,X0,PR1

     2085     9697    4            END;

     2086     9698    4         IF JSBIN<=0 THEN DO;

   9698  1 012236   200013 235100                    LDA     J,,AUTO
         1 012237   012427 605400 1                  TPNZ    s:9736

     2087     9699    4            K=K+J;

   9699  1 012240   200014 236100                    LDQ     K,,AUTO
         1 012241   200013 036100                    ADLQ    J,,AUTO
         1 012242   200014 756100                    STQ     K,,AUTO

     2088     9700    4            FM$CFU.NGAVAL=FM$CFU.NGAVAL-J;

   9700  1 012243   200010 471500                    LDP1    CFU$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:352  
         1 012244   100007 236100                    LDQ     7,,PR1
         1 012245   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 012246   200013 136100                    SBLQ    J,,AUTO
         1 012247   100007 552134                    STBQ    7,'34'O,PR1

     2089     9701    4            J=LOC$->OS.ADR;

   9701  1 012250   200005 473500                    LDP3    LOC$,,AUTO
         1 012251   300000 236100                    LDQ     0,,PR3
         1 012252   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 012253   200013 756100                    STQ     J,,AUTO

     2090     9702    4            FM$CFUEXT.NUM=I-1;

   9702  1 012254   200006 474500                    LDP4    P1$,,AUTO
         1 012255   200012 236100                    LDQ     I,,AUTO
         1 012256   000001 136007                    SBLQ    1,DL
         1 012257   000036 736000                    QLS     30
         1 012260   400000 752140                    STCQ    0,'40'O,PR4

     2091     9703    4            PINCRW(P1$,I)->O.ADR=1;/* WORD 3 MUST! BE NONZERO */

   9703  1 012261   000001 235007                    LDA     1,DL
         1 012262   200006 473500                    LDP3    P1$,,AUTO
         1 012263   200012 720100                    LXL0    I,,AUTO
         1 012264   300000 755110                    STA     0,X0,PR3

     2092     9704    4            IF I=2 THEN PINCRW(P1$,I)->O.SIZ=1;

   9704  1 012265   200012 236100                    LDQ     I,,AUTO
         1 012266   000002 116007                    CMPQ    2,DL
         1 012267   012272 601000 1                  TNZ     s:9705

   9704  1 012270   200006 473500                    LDP3    P1$,,AUTO
         1 012271   300001 755106                    STA     1,QL,PR3

     2093     9705    5            IF I=1 THEN DO;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:353  

   9705  1 012272   200012 236100                    LDQ     I,,AUTO
         1 012273   000001 116007                    CMPQ    1,DL
         1 012274   012327 601000 1                  TNZ     s:9714

     2094     9706    5               T$=P1$;

   9706  1 012275   200006 236100                    LDQ     P1$,,AUTO
         1 012276   200016 756100                    STQ     T$,,AUTO

     2095     9707    5               CALL FMR$Z8(XT$);

   9707  1 012277   200017 630500                    EPPR0   T$$,,AUTO
         1 012300   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 012301   000000 701000 xent               TSX1    FMR$Z8
         1 012302   000000 011000                    NOP     0

     2096     9708    5               I=FM$CFU.XTX;

   9708  1 012303   200010 470500                    LDP0    CFU$,,AUTO
         1 012304   000003 236100                    LDQ     3,,PR0
         1 012305   000022 772000                    QRL     18
         1 012306   200012 756100                    STQ     I,,AUTO

     2097     9709    6               DO WHILE(PINCRW(F$CFU$,I)->FM$CFUEXT.LINKX~=P1.WOFF);

   9709  1 012307   000000 471400 xsym               LDP1    F$CFU$
         1 012310   100000 720106                    LXL0    0,QL,PR1
         1 012311   200006 100100                    CMPX0   P1$,,AUTO
         1 012312   012323 600000 1                  TZE     s:9712

     2098     9710    6                  I=PINCRW(F$CFU$,I)->FM$CFUEXT.LINKX;

   9710  1 012313   000000 470400 xsym               LDP0    F$CFU$
         1 012314   200012 720100                    LXL0    I,,AUTO
         1 012315   000000 236110                    LDQ     0,X0,PR0
         1 012316   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:354  
         1 012317   200012 756100                    STQ     I,,AUTO

     2099     9711    6                  END;

   9711  1 012320   000000 720106                    LXL0    0,QL,PR0
         1 012321   200006 100100                    CMPX0   P1$,,AUTO
         1 012322   012313 601000 1                  TNZ     s:9710

     2100     9712    5               PINCRW(F$CFU$,I)->FM$CFUEXT.LINKX=0;

   9712  1 012323   000000 220003                    LDX0    0,DU
         1 012324   000000 470400 xsym               LDP0    F$CFU$
         1 012325   200012 721100                    LXL1    I,,AUTO
         1 012326   000000 440111                    SXL0    0,X1,PR0

     2101     9713    5               END;

     2102     9714    4            LOC$->O.ADR=0;

   9714  1 012327   200005 470500                    LDP0    LOC$,,AUTO
         1 012330   000000 450100                    STZ     0,,PR0

     2103     9715    4            P1$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(1));

   9715  1 012331   200007 470500                    LDP0    FIT$,,AUTO
         1 012332   000001 720100                    LXL0    1,,PR0
         1 012333   001777 360003                    ANX0    1023,DU
         1 012334   000000 636010                    EAQ     0,X0
         1 012335   200007 036100                    ADLQ    FIT$,,AUTO
         1 012336   200006 756100                    STQ     P1$,,AUTO

     2104     9716    4            I=POFFW(LOC$,P1$);

   9716  1 012337   200006 235100                    LDA     P1$,,AUTO
         1 012340   000022 771000                    ARL     18
         1 012341   200052 755100                    STA     INDX+1,,AUTO
         1 012342   200005 236100                    LDQ     LOC$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:355  
         1 012343   000022 772000                    QRL     18
         1 012344   200052 136100                    SBLQ    INDX+1,,AUTO
         1 012345   200012 756100                    STQ     I,,AUTO

     2105     9717    4            FM$FIT.CODES.NDW(1)=I;

   9717  1 012346   000012 736000                    QLS     10
         1 012347   000001 676100                    ERQ     1,,PR0
         1 012350   000032 376000 2                  ANQ     26
         1 012351   000001 656100                    ERSQ    1,,PR0

     2106     9718    4            P1$->CODE01.NXTNTS=I-1;

   9718  1 012352   200006 471500                    LDP1    P1$,,AUTO
         1 012353   200012 236100                    LDQ     I,,AUTO
         1 012354   000001 136007                    SBLQ    1,DL
         1 012355   000033 736000                    QLS     27
         1 012356   100000 552140                    STBQ    0,'40'O,PR1

     2107     9719    5            IF FM$CFU.NGAVAL~=0 THEN DO;

   9719  1 012357   200010 471500                    LDP1    CFU$,,AUTO
         1 012360   100007 236100                    LDQ     7,,PR1
         1 012361   000032 316000 xsym               CANQ    B_VECTNIL+26
         1 012362   012434 600000 1                  TZE     s:9737

     2108     9720    6               IF BUFNO>1 THEN DO;

   9720  1 012363   200015 235100                    LDA     BUFNO,,AUTO
         1 012364   000001 115007                    CMPA    1,DL
         1 012365   012406 604400 1                  TMOZ    s:9731

     2109     9721                    /* Get the FIT out of FAG$REXT's way. (It uses 4,3,and 2). */
     2110     9722
     2111     9723    6                  IBIT=F$DCB.BFR(0);

   9723  1 012366   200004 473500                    LDP3    JDCB$,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:356  
         1 012367   300115 236100                    LDQ     77,,PR3
         1 012370   200012 756100                    STQ     I,,AUTO

     2112     9724    6                  F$DCB.BFR(0)=F$DCB.BFR(BUFNO);

   9724  1 012371   300115 236105                    LDQ     77,AL,PR3
         1 012372   300115 756100                    STQ     77,,PR3

     2113     9725    6                  F$DCB.BFR(BUFNO)=IBIT;

   9725  1 012373   200012 236100                    LDQ     I,,AUTO
         1 012374   200015 720100                    LXL0    BUFNO,,AUTO
         1 012375   300115 756110                    STQ     77,X0,PR3

     2114     9726    6                  IBIT=F$DCB.BFR1(0);

   9726  1 012376   300122 236100                    LDQ     82,,PR3
         1 012377   200012 756100                    STQ     I,,AUTO

     2115     9727    6                  F$DCB.BFR1(0)=F$DCB.BFR1(BUFNO);

   9727  1 012400   200015 720100                    LXL0    BUFNO,,AUTO
         1 012401   300122 236110                    LDQ     82,X0,PR3
         1 012402   300122 756100                    STQ     82,,PR3

     2116     9728    6                  F$DCB.BFR1(BUFNO)=IBIT;

   9728  1 012403   200012 236100                    LDQ     I,,AUTO
         1 012404   300122 756110                    STQ     82,X0,PR3

     2117     9729    6                  BUFNO=0;

   9729  1 012405   200015 450100                    STZ     BUFNO,,AUTO

     2118     9730    6                  END;

     2119     9731    5               CALL FMD$WRTSV(BUFNO);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:357  

   9731  1 012406   200015 633500                    EPPR3   BUFNO,,AUTO
         1 012407   200052 453500                    STP3    INDX+1,,AUTO
         1 012410   200052 630500                    EPPR0   INDX+1,,AUTO
         1 012411   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 012412   000000 701000 xent               TSX1    FMD$WRTSV
         1 012413   000000 011000                    NOP     0

     2120     9732    5               CALL FAG$REXT(J);

   9732  1 012414   200013 630500                    EPPR0   J,,AUTO
         1 012415   200052 450500                    STP0    INDX+1,,AUTO
         1 012416   200052 630500                    EPPR0   INDX+1,,AUTO
         1 012417   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 012420   000000 701000 xent               TSX1    FAG$REXT
         1 012421   000000 011000                    NOP     0

     2121     9733    5               K=FM$CFU.NGAVAL;

   9733  1 012422   200010 470500                    LDP0    CFU$,,AUTO
         1 012423   000007 236100                    LDQ     7,,PR0
         1 012424   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 012425   200014 756100                    STQ     K,,AUTO

     2122     9734    5               END;

     2123     9735    4            END;

   9735  1 012426   012434 710000 1                  TRA     s:9737

     2124     9736    3         ELSE J=J+LOC$->OS.ADR;

   9736  1 012427   200005 471500                    LDP1    LOC$,,AUTO
         1 012430   100000 236100                    LDQ     0,,PR1
         1 012431   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 012432   200013 036100                    ADLQ    J,,AUTO
         1 012433   200013 756100                    STQ     J,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:358  

     2125     9737    3         END;

   9737  1 012434   200010 470500                    LDP0    CFU$,,AUTO
         1 012435   000007 236100                    LDQ     7,,PR0
         1 012436   000032 316000 xsym               CANQ    B_VECTNIL+26
         1 012437   012134 601000 1                  TNZ     s:9679

     2126     9738    2      RETURN;

   9738  1 012440   200036 221300                    LDX1  ! CODE+1,,AUTO
         1 012441   000001 702211                    TSX2  ! 1,X1

     2127     9739    2   END RELG;
     2128     9740        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:359  
     2129     9741    1   FMO$RELG: ENTRY(DUMMY) ALTRET;

   9741  1 012442   000000 700200 xent  FMO$RELG     TSX0  ! X66_AUTO_1
         1 012443   000062 000001                    ZERO    50,1

     2130     9742
     2131     9743                    /*F* NAME:         FMO$RELG
     2132     9744
     2133     9745                         PURPOSE:      FMO$RELG causes the unused extents of a file
     2134     9746                                       (FM$CFU.NGAVAL) to be released and updates the
     2135     9747                                       FIT, CFU, and granule accounting accordingly.
     2136     9748                    */
     2137     9749                    /*D* NAME:         FMO$RELG
     2138     9750
     2139     9751                         CALL:         CALL FMO$RELG(BUFNO) ALTRET(LBL);
     2140     9752
     2141     9753                         INPUT:        The buffer number of the pool buffer into which
     2142     9754                                       the FIT will be read.
     2143     9755
     2144     9756                         OUTPUT:       An updated FIT, CFU, etc. indicating that the
     2145     9757                                       NGAVAL granules have been released.
     2146     9758
     2147     9759                         DESCRIPTION:  FMO$RELG is called from the ALTKEY close routine
     2148     9760                                       in FMQ$RELSTARF. If ALTKEY was M$MLINKed to from
     2149     9761                                       M$CLOSE and it needed to allocate extents in order
     2150     9762                                       to build the alternate keys for an indexed or IREL
     2151     9763                                       file, there may be unused granules left when it's
     2152     9764                                       done. However, the user may have set RELG=YES in
     2153     9765                                       his close fpt and want these unused granules to
     2154     9766                                       go away. In a normal close, this is done in
     2155     9767                                       FMO$MODFIT. However, in our case, FMO$MODFIT was
     2156     9768                                       called before ALTKEY was invoked. So, we have to
     2157     9769                                       get rid of them again when ALTKEY is wrapping up.
     2158     9770                                       The checks to see whether this user asked to RELG,
     2159     9771                                       is allowed to RELG, or even has anything to RELG
     2160     9772                                       have already been done by M$RELSTARF. So, if
     2161     9773                                       FMO$RELG is called, we really do want to RELG.
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:360  
     2162     9774
     2163     9775                                       First, set up our DCB and CFU pointers. If the
     2164     9776                                       file doesn't have any extents (unlikely), we're
     2165     9777                                       done. Ditto if there's no FIT disk address. Then
     2166     9778                                       read the FIT into a buffer and update UGRANS and
     2167     9779                                       NGAVAL in the CODE03 from what's in the CFU.
     2168     9780                                       Call the RELG subroutine to release all but the
     2169     9781                                       last extent. RELG does most of the real work for
     2170     9782                                       this routine. However, although it sets up the
     2171     9783                                       final extent to be released, it doesn't actually
     2172     9784                                       release it. So, finally, we write out the FIT one
     2173     9785                                       more time and release the last extent.
     2174     9786
     2175     9787                                       This routine only altreturns if FMN$GETFIT found
     2176     9788                                       something wrong with the FIT.
     2177     9789                       */
     2178     9790           %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:361  
     2179     9791    1      JDCB$=B$JIT.DCB$;

   9791  1 012444   000000 470400 xsym               LDP0    B$JIT$
         1 012445   000232 236100                    LDQ     154,,PR0
         1 012446   200004 756100                    STQ     JDCB$,,AUTO

     2180     9792    1      CFU$=JDCB$->F$DCB.CFU$;

   9792  1 012447   200004 471500                    LDP1    JDCB$,,AUTO
         1 012450   100066 236100                    LDQ     54,,PR1
         1 012451   200010 756100                    STQ     CFU$,,AUTO

     2181     9793    1      T$$=ADDR(T$);

   9793  1 012452   200016 633500                    EPPR3   T$,,AUTO
         1 012453   200017 453500                    STP3    T$$,,AUTO

     2182     9794    1      IF FM$CFU.XTX=0 THEN

   9794  1 012454   200010 474500                    LDP4    CFU$,,AUTO
         1 012455   400003 220100                    LDX0    3,,PR4
         1 012456   012460 601000 1                  TNZ     s:9796

     2183     9795    1         RETURN; /* No extents */

   9795  1 012457   000000 702200 xent               TSX2  ! X66_ARET

     2184     9796    1      CALL FMR$L8;

   9796  1 012460   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 012461   000000 701000 xent               TSX1    FMR$L8
         1 012462   000000 011000                    NOP     0

     2185     9797    1      CALL FMR$U8;

   9797  1 012463   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 012464   000000 701000 xent               TSX1    FMR$U8
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:362  
         1 012465   000000 011000                    NOP     0

     2186     9798    1      IF FM$CFU.FITSDA=0 THEN

   9798  1 012466   200010 470500                    LDP0    CFU$,,AUTO
         1 012467   000000 236100                    LDQ     0,,PR0
         1 012470   000032 316000 xsym               CANQ    B_VECTNIL+26
         1 012471   012473 601000 1                  TNZ     s:9800

     2187     9799    1         RETURN;

   9799  1 012472   000000 702200 xent               TSX2  ! X66_ARET

     2188     9800    1      BUFNO=RELG_BUFNO;

   9800  1 012473   200003 471500                    LDP1    @DUMMY,,AUTO
         1 012474   100000 235100                    LDA     0,,PR1
         1 012475   200015 755100                    STA     BUFNO,,AUTO

     2189     9801    1      CALL FMN$GETFIT(BUF$,BUFNO) ALTRET(RELG_ALT);

   9801  1 012476   200015 633500                    EPPR3   BUFNO,,AUTO
         1 012477   200053 453500                    STP3    INDX+2,,AUTO
         1 012500   200011 634500                    EPPR4   BUF$,,AUTO
         1 012501   200052 454500                    STP4    INDX+1,,AUTO
         1 012502   200052 630500                    EPPR0   INDX+1,,AUTO
         1 012503   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 012504   000000 701000 xent               TSX1    FMN$GETFIT
         1 012505   012557 702000 1                  TSX2    RELG_ALT

     2190     9802    1      FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));

   9802  1 012506   200011 236100                    LDQ     BUF$,,AUTO
         1 012507   000005 036003                    ADLQ    5,DU
         1 012510   200007 756100                    STQ     FIT$,,AUTO

     2191     9803    1      LOCCODX=3;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:363  

   9803  1 012511   000003 235007                    LDA     3,DL
         1 012512   200020 755100                    STA     LOCCODX,,AUTO

     2192     9804    1      CALL LOCCODP;

   9804  1 012513   002543 701000 1                  TSX1    LOCCODP
         1 012514   000000 011000                    NOP     0

     2193     9805    1      CODE03.UGRANS=FM$CFU.UGRANS;

   9805  1 012515   200010 470500                    LDP0    CFU$,,AUTO
         1 012516   200005 471500                    LDP1    LOC$,,AUTO
         1 012517   000004 236100                    LDQ     4,,PR0
         1 012520   100000 552134                    STBQ    0,'34'O,PR1

     2194     9806    1      CODE03.NGAVAL=FM$CFU.NGAVAL;

   9806  1 012521   200005 471500                    LDP1    LOC$,,AUTO
         1 012522   000007 236100                    LDQ     7,,PR0
         1 012523   100003 552134                    STBQ    3,'34'O,PR1

     2195     9807    1      F$DCB.BFR.BUFUP(BUFNO)='1'B;

   9807  1 012524   200004 471500                    LDP1    JDCB$,,AUTO
         1 012525   200015 720100                    LXL0    BUFNO,,AUTO
         1 012526   400000 236003                    LDQ     -131072,DU
         1 012527   100115 256110                    ORSQ    77,X0,PR1

     2196     9808    1      CALL RELG;

   9808  1 012530   012021 701000 1                  TSX1    RELG
         1 012531   000000 011000                    NOP     0

     2197     9809    1      IF J~=0 OR F$DCB.BFR.BUFUP(BUFNO) THEN

   9809  1 012532   200013 235100                    LDA     J,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:364  
         1 012533   012540 601000 1                  TNZ     s:9811
         1 012534   200004 470500                    LDP0    JDCB$,,AUTO
         1 012535   200015 720100                    LXL0    BUFNO,,AUTO
         1 012536   000115 234110                    SZN     77,X0,PR0
         1 012537   012556 605000 1                  TPL     s:9815

     2198     9810    2      DO;

     2199     9811    2         CALL FMD$WRTSV(BUFNO);

   9811  1 012540   200015 630500                    EPPR0   BUFNO,,AUTO
         1 012541   200052 450500                    STP0    INDX+1,,AUTO
         1 012542   200052 630500                    EPPR0   INDX+1,,AUTO
         1 012543   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 012544   000000 701000 xent               TSX1    FMD$WRTSV
         1 012545   000000 011000                    NOP     0

     2200     9812    2         IF J~=0 THEN

   9812  1 012546   200013 235100                    LDA     J,,AUTO
         1 012547   012556 600000 1                  TZE     s:9815

     2201     9813    2            CALL FAG$REXT(J);

   9813  1 012550   200013 630500                    EPPR0   J,,AUTO
         1 012551   200052 450500                    STP0    INDX+1,,AUTO
         1 012552   200052 630500                    EPPR0   INDX+1,,AUTO
         1 012553   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 012554   000000 701000 xent               TSX1    FAG$REXT
         1 012555   000000 011000                    NOP     0

     2202     9814    2         END;

     2203     9815    1      RETURN;

   9815  1 012556   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:365  
   9809  1 012557                       RELG_ALT     null
     2204     9816    1   RELG_ALT:;
     2205     9817    1      ALTRETURN;

   9817  1 012557   000000 702200 xent               TSX2  ! X66_AALT

     2206     9818
     2207     9819        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:366  
     2208     9820                    /*F* NAME:FMO$XTNTOFIT
     2209     9821                    *
     2210     9822                 PURPOSE: This routine takes a raw extent allocated by FAG$GEXT and updates
     2211     9823                    the file's CFU and FIT to reflect the extension.
     2212     9824                    *
     2213     9825             DESCRIPTION: This routine takes a raw extent allocated by FAG$GEXT and updates
     2214     9826              the file's CFU and FIT to reflect the extension.  It ALTRETs if
     2215     9827              either the CFU area or FIT is too small to accommodate the new
     2216     9828              extent.  If an AFIT is required, an ALTRET may occur if one cannot
     2217     9829              be obtained.  Otherwise FIT and CFU extent list, UGRANS, and
     2218     9830              NGAVAL are updated.
     2219     9831              */
     2220     9832    1   FMO$XTNTOFIT: ENTRY(DUMMY) ALTRET;

   9832  1 012560   000000 700200 xent  FMO$XTNTOFIT TSX0  ! X66_AUTO_1
         1 012561   000062 000001                    ZERO    50,1

     2221     9833    1      JDCB$=B$JIT$->B$JIT.DCB$;

   9833  1 012562   000000 470400 xsym               LDP0    B$JIT$
         1 012563   000232 236100                    LDQ     154,,PR0
         1 012564   200004 756100                    STQ     JDCB$,,AUTO

     2222     9834    1      CFU$=JDCB$->F$DCB.CFU$;

   9834  1 012565   200004 471500                    LDP1    JDCB$,,AUTO
         1 012566   100066 236100                    LDQ     54,,PR1
         1 012567   200010 756100                    STQ     CFU$,,AUTO

     2223     9835    1      T$$=ADDR(T$);

   9835  1 012570   200016 633500                    EPPR3   T$,,AUTO
         1 012571   200017 453500                    STP3    T$$,,AUTO

     2224     9836    1      BUFNO=4;

   9836  1 012572   000004 235007                    LDA     4,DL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:367  
         1 012573   200015 755100                    STA     BUFNO,,AUTO

     2225     9837    1      I=2;

   9837  1 012574   000002 235007                    LDA     2,DL
         1 012575   200012 755100                    STA     I,,AUTO

     2226     9838    2      IF ADDR(PN$)->O.SIZ<512 THEN DO;

   9838  1 012576   200003 474500                    LDP4    @DUMMY,,AUTO
         1 012577   400001 235100                    LDA     1,,PR4
         1 012600   001000 115007                    CMPA    512,DL
         1 012601   012607 603000 1                  TRC     s:9843

     2227     9839    2         ADDR(PN$)->OS.SIZ=ADDR(PN$)->O.SIZ;

   9839  1 012602   400001 236100                    LDQ     1,,PR4
         1 012603   000033 736000                    QLS     27
         1 012604   400000 552140                    STBQ    0,'40'O,PR4

     2228     9840    2         I=1;

   9840  1 012605   000001 236007                    LDQ     1,DL
         1 012606   200012 756100                    STQ     I,,AUTO

     2229     9841    2         END;

     2230     9842                    /* FIND THE CFU SPOT FOR IT */
     2231     9843    1      P1$=PINCRW(F$CFU$,FM$CFU.XTX);

   9843  1 012607   200010 475500                    LDP5    CFU$,,AUTO
         1 012610   500003 220100                    LDX0    3,,PR5
         1 012611   000000 636010                    EAQ     0,X0
         1 012612   000000 036000 xsym               ADLQ    F$CFU$
         1 012613   200006 756100                    STQ     P1$,,AUTO

     2232     9844    2      DO WHILE (FM$CFUEXT.LINKX~=0);
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:368  

   9844  1 012614   200006 476500                    LDP6    P1$,,AUTO
         1 012615   600000 720100                    LXL0    0,,PR6
         1 012616   012627 600000 1                  TZE     s:9847

     2233     9845    2         P1$=PINCRW(F$CFU$,FM$CFUEXT.LINKX);

   9845  1 012617   200006 470500                    LDP0    P1$,,AUTO
         1 012620   000000 720100                    LXL0    0,,PR0
         1 012621   000000 636010                    EAQ     0,X0
         1 012622   000000 036000 xsym               ADLQ    F$CFU$
         1 012623   200006 756100                    STQ     P1$,,AUTO

     2234     9846    2         END;

   9846  1 012624   200006 470500                    LDP0    P1$,,AUTO
         1 012625   000000 720100                    LXL0    0,,PR0
         1 012626   012617 601000 1                  TNZ     s:9845

     2235     9847    1      J=FM$CFUEXT.XTNT.XTNSIZE(FM$CFUEXT.NUM-1);

   9847  1 012627   200006 470500                    LDP0    P1$,,AUTO
         1 012630   000000 236100                    LDQ     0,,PR0
         1 012631   000036 772000                    QRL     30
         1 012632   000000 236106                    LDQ     0,QL,PR0
         1 012633   000033 772000                    QRL     27
         1 012634   200013 756100                    STQ     J,,AUTO

     2236     9848    1      IF I=1   /* MERGE TWO EXTENTS IF THEY ARE CONTIGUOUS */

   9848  1 012635   200012 235100                    LDA     I,,AUTO
         1 012636   000001 115007                    CMPA    1,DL
         1 012637   012674 601000 1                  TNZ     s:9856
         1 012640   000000 116003                    CMPQ    0,DU
         1 012641   012674 600000 1                  TZE     s:9856
         1 012642   200003 471500                    LDP1    @DUMMY,,AUTO
         1 012643   100001 036100                    ADLQ    1,,PR1
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:369  
         1 012644   001000 116007                    CMPQ    512,DL
         1 012645   012674 603000 1                  TRC     s:9856
         1 012646   000000 236100                    LDQ     0,,PR0
         1 012647   000036 772000                    QRL     30
         1 012650   000000 236106                    LDQ     0,QL,PR0
         1 012651   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 012652   200013 036100                    ADLQ    J,,AUTO
         1 012653   200052 756100                    STQ     INDX+1,,AUTO
         1 012654   100000 236100                    LDQ     0,,PR1
         1 012655   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 012656   200053 756100                    STQ     INDX+2,,AUTO
         1 012657   200052 236100                    LDQ     INDX+1,,AUTO
         1 012660   200053 116100                    CMPQ    INDX+2,,AUTO
         1 012661   012674 601000 1                  TNZ     s:9856

     2237     9849    1        AND J~=0
     2238     9850    1        AND ADDR(PN$)->O.SIZ+J<512
     2239     9851    1        AND J+FM$CFUEXT.XTNT.XTNSDA(FM$CFUEXT.NUM-1)=ADDR(PN$)->OS.ADR
     2240     9852    2      THEN DO;

     2241     9853    2         I=0;

   9853  1 012662   200012 450100                    STZ     I,,AUTO

     2242     9854    2         FM$CFUEXT.XTNT.XTNSIZE(FM$CFUEXT.NUM-1)=J+ADDR(PN$)->O.SIZ;

   9854  1 012663   000000 236100                    LDQ     0,,PR0
         1 012664   000036 772000                    QRL     30
         1 012665   000000 620006                    EAX0    0,QL
         1 012666   200013 236100                    LDQ     J,,AUTO
         1 012667   100001 036100                    ADLQ    1,,PR1
         1 012670   000033 736000                    QLS     27
         1 012671   000000 676110                    ERQ     0,X0,PR0
         1 012672   777000 376003                    ANQ     -512,DU
         1 012673   000000 656110                    ERSQ    0,X0,PR0

     2243     9855    2         END;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:370  

     2244     9856    2      IF FM$CFUEXT.NUM+I>7 THEN DO; /* GET A BLOCK IF WE NEED ONE */

   9856  1 012674   200006 470500                    LDP0    P1$,,AUTO
         1 012675   000000 236100                    LDQ     0,,PR0
         1 012676   000036 772000                    QRL     30
         1 012677   200012 036100                    ADLQ    I,,AUTO
         1 012700   000010 116007                    CMPQ    8,DL
         1 012701   012717 602000 1                  TNC     s:9861

     2245     9857    2         CALL FMR$G8(BUF$,J) ALTRET(FMOE$NOCFUS);

   9857  1 012702   200013 631500                    EPPR1   J,,AUTO
         1 012703   200053 451500                    STP1    INDX+2,,AUTO
         1 012704   200011 633500                    EPPR3   BUF$,,AUTO
         1 012705   200052 453500                    STP3    INDX+1,,AUTO
         1 012706   200052 630500                    EPPR0   INDX+1,,AUTO
         1 012707   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 012710   000000 701000 xent               TSX1    FMR$G8
         1 012711   013123 702000 1                  TSX2    FMOE$NOCFUS

     2246     9858    2         FM$CFUEXT.LINKX=J;

   9858  1 012712   200013 720100                    LXL0    J,,AUTO
         1 012713   200006 470500                    LDP0    P1$,,AUTO
         1 012714   000000 440100                    SXL0    0,,PR0

     2247     9859    2         P1$=BUF$;

   9859  1 012715   200011 236100                    LDQ     BUF$,,AUTO
         1 012716   200006 756100                    STQ     P1$,,AUTO

     2248     9860    2         END;

     2249     9861    1      CALL FMN$GETFIT(BUF$,BUFNO)ALTRET(FMOALTRET);

   9861  1 012717   200015 630500                    EPPR0   BUFNO,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:371  
         1 012720   200053 450500                    STP0    INDX+2,,AUTO
         1 012721   200011 631500                    EPPR1   BUF$,,AUTO
         1 012722   200052 451500                    STP1    INDX+1,,AUTO
         1 012723   200052 630500                    EPPR0   INDX+1,,AUTO
         1 012724   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 012725   000000 701000 xent               TSX1    FMN$GETFIT
         1 012726   013126 702000 1                  TSX2    FMOALTRET

     2250     9862    1      CODE=1;

   9862  1 012727   000001 235007                    LDA     1,DL
         1 012730   200035 755100                    STA     CODE,,AUTO

     2251     9863    1      FIT$=PINCRW(BUF$,SIZEW(FM$GRAN));

   9863  1 012731   200011 236100                    LDQ     BUF$,,AUTO
         1 012732   000005 036003                    ADLQ    5,DU
         1 012733   200007 756100                    STQ     FIT$,,AUTO

     2252     9864    1      CALL FMO$FITSPACE(I+FM$FIT.CODES.NDW(1)) ALTRET(FMOALTRET);

   9864  1 012734   200007 470500                    LDP0    FIT$,,AUTO
         1 012735   000001 236100                    LDQ     1,,PR0
         1 012736   000012 772000                    QRL     10
         1 012737   001777 376007                    ANQ     1023,DL
         1 012740   200012 036100                    ADLQ    I,,AUTO
         1 012741   200061 756100                    STQ     INDX+8,,AUTO
         1 012742   200061 631500                    EPPR1   INDX+8,,AUTO
         1 012743   200047 451500                    STP1    FN+3,,AUTO
         1 012744   004717 701000 1                  TSX1    FMO$FITSPACE
         1 012745   013126 702000 1                  TSX2    FMOALTRET

     2253     9865    1      BUF$=PINCRW(LOC$,FM$FIT.CODES.NDW(1));

   9865  1 012746   200007 470500                    LDP0    FIT$,,AUTO
         1 012747   000001 236100                    LDQ     1,,PR0
         1 012750   000012 772000                    QRL     10
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:372  
         1 012751   001777 376007                    ANQ     1023,DL
         1 012752   000022 736000                    QLS     18
         1 012753   200005 036100                    ADLQ    LOC$,,AUTO
         1 012754   200011 756100                    STQ     BUF$,,AUTO

     2254     9866    2      IF I~=0 THEN DO;

   9866  1 012755   200012 235100                    LDA     I,,AUTO
         1 012756   013036 600000 1                  TZE     s:9877

     2255     9867    2         BUF$->O.ADR=ADDR(PN$)->O.ADR; /* MOVE IN THE EXTENT */

   9867  1 012757   200003 471500                    LDP1    @DUMMY,,AUTO
         1 012760   200011 473500                    LDP3    BUF$,,AUTO
         1 012761   100000 235100                    LDA     0,,PR1
         1 012762   300000 755100                    STA     0,,PR3

     2256     9868    2         IF I=2 THEN BUF$->O.SIZ=ADDR(PN$)->O.SIZ;

   9868  1 012763   200012 235100                    LDA     I,,AUTO
         1 012764   000002 115007                    CMPA    2,DL
         1 012765   012771 601000 1                  TNZ     s:9869

   9868  1 012766   200011 473500                    LDP3    BUF$,,AUTO
         1 012767   100001 235100                    LDA     1,,PR1
         1 012770   300001 755100                    STA     1,,PR3

     2257     9869    2         BUF$=PINCRW(P1$,FM$CFUEXT.NUM+1);

   9869  1 012771   200006 473500                    LDP3    P1$,,AUTO
         1 012772   300000 236100                    LDQ     0,,PR3
         1 012773   000036 772000                    QRL     30
         1 012774   000022 736000                    QLS     18
         1 012775   000001 036003                    ADLQ    1,DU
         1 012776   200006 036100                    ADLQ    P1$,,AUTO
         1 012777   200011 756100                    STQ     BUF$,,AUTO

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:373  
     2258     9870    2         BUF$->O.ADR=ADDR(PN$)->O.ADR; /* MOVE IN THE EXTENT */

   9870  1 013000   200011 474500                    LDP4    BUF$,,AUTO
         1 013001   100000 235100                    LDA     0,,PR1
         1 013002   400000 755100                    STA     0,,PR4

     2259     9871    2         IF I=2 THEN BUF$->O.SIZ=ADDR(PN$)->O.SIZ;

   9871  1 013003   200012 235100                    LDA     I,,AUTO
         1 013004   000002 115007                    CMPA    2,DL
         1 013005   013011 601000 1                  TNZ     s:9872

   9871  1 013006   200011 473500                    LDP3    BUF$,,AUTO
         1 013007   100001 235100                    LDA     1,,PR1
         1 013010   300001 755100                    STA     1,,PR3

     2260     9872    2         CODE01.NXTNTS=CODE01.NXTNTS+I;

   9872  1 013011   200005 473500                    LDP3    LOC$,,AUTO
         1 013012   300000 236100                    LDQ     0,,PR3
         1 013013   000033 772000                    QRL     27
         1 013014   200012 036100                    ADLQ    I,,AUTO
         1 013015   000033 736000                    QLS     27
         1 013016   300000 552140                    STBQ    0,'40'O,PR3

     2261     9873    2         FM$FIT.CODES.NDW(1)=FM$FIT.CODES.NDW(1)+I;

   9873  1 013017   000001 236100                    LDQ     1,,PR0
         1 013020   000012 772000                    QRL     10
         1 013021   001777 376007                    ANQ     1023,DL
         1 013022   200012 036100                    ADLQ    I,,AUTO
         1 013023   000012 736000                    QLS     10
         1 013024   000001 676100                    ERQ     1,,PR0
         1 013025   000032 376000 2                  ANQ     26
         1 013026   000001 656100                    ERSQ    1,,PR0

     2262     9874    2         FM$CFUEXT.NUM=FM$CFUEXT.NUM+I;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:374  

   9874  1 013027   200006 473500                    LDP3    P1$,,AUTO
         1 013030   300000 236100                    LDQ     0,,PR3
         1 013031   000036 772000                    QRL     30
         1 013032   200012 036100                    ADLQ    I,,AUTO
         1 013033   000036 736000                    QLS     30
         1 013034   300000 752140                    STCQ    0,'40'O,PR3

     2263     9875    2         END;

   9875  1 013035   013047 710000 1                  TRA     s:9880

     2264     9876    2      ELSE DO;

     2265     9877    2         BUF$=PINCRW(BUF$,-1);

   9877  1 013036   777777 036003                    ADLQ    -1,DU
         1 013037   200011 756100                    STQ     BUF$,,AUTO

     2266     9878    2         BUF$->OS.SIZ=BUF$->OS.SIZ+ADDR(PN$)->O.SIZ;

   9878  1 013040   200003 471500                    LDP1    @DUMMY,,AUTO
         1 013041   200011 473500                    LDP3    BUF$,,AUTO
         1 013042   300000 236100                    LDQ     0,,PR3
         1 013043   000033 772000                    QRL     27
         1 013044   100001 036100                    ADLQ    1,,PR1
         1 013045   000033 736000                    QLS     27
         1 013046   300000 552140                    STBQ    0,'40'O,PR3

     2267     9879    2         END;

     2268     9880    1      I=FM$CFU.UGRANS;

   9880  1 013047   200010 473500                    LDP3    CFU$,,AUTO
         1 013050   300004 236100                    LDQ     4,,PR3
         1 013051   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 013052   200012 756100                    STQ     I,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:375  

     2269     9881    1      CALL UPDGAC;

   9881  1 013053   002506 701000 1                  TSX1    UPDGAC
         1 013054   000000 011000                    NOP     0

     2270     9882    1      LOCCODX=3;

   9882  1 013055   000003 235007                    LDA     3,DL
         1 013056   200020 755100                    STA     LOCCODX,,AUTO

     2271     9883    1      CALL LOCCODP ALTRET(FMOE$BADFIT);

   9883  1 013057   002543 701000 1                  TSX1    LOCCODP
         1 013060   012015 702000 1                  TSX2    FMOE$BADFIT

     2272     9884    1      CODE03.UGRANS=CODE03.UGRANS+ADDR(PN$)->O.SIZ;

   9884  1 013061   200003 470500                    LDP0    @DUMMY,,AUTO
         1 013062   200005 471500                    LDP1    LOC$,,AUTO
         1 013063   100000 236100                    LDQ     0,,PR1
         1 013064   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 013065   000001 036100                    ADLQ    1,,PR0
         1 013066   100000 552134                    STBQ    0,'34'O,PR1

     2273     9885    2      IF F$DCB.IORG=%RANDOM# OR F$DCB.IORG=%RELATIVE# THEN DO;

   9885  1 013067   200004 471500                    LDP1    JDCB$,,AUTO
         1 013070   100070 236100                    LDQ     56,,PR1
         1 013071   077000 376003                    ANQ     32256,DU
         1 013072   003000 116003                    CMPQ    1536,DU
         1 013073   013076 600000 1                  TZE     s:9886
         1 013074   005000 116003                    CMPQ    2560,DU
         1 013075   013103 601000 1                  TNZ     s:9889

     2274     9886    2         FM$CFU.UGRANS=CODE03.UGRANS;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:376  
   9886  1 013076   200005 473500                    LDP3    LOC$,,AUTO
         1 013077   200010 474500                    LDP4    CFU$,,AUTO
         1 013100   300000 236100                    LDQ     0,,PR3
         1 013101   400004 552134                    STBQ    4,'34'O,PR4

     2275     9887    2         END;

   9887  1 013102   013117 710000 1                  TRA     s:9893

     2276     9888    2      ELSE DO;

     2277     9889    2         FM$CFU.NGAVAL=ADDR(PN$)->O.SIZ;

   9889  1 013103   200010 473500                    LDP3    CFU$,,AUTO
         1 013104   000001 236100                    LDQ     1,,PR0
         1 013105   300007 552134                    STBQ    7,'34'O,PR3

     2278     9890    2         CODE03.NRECS=FM$CFU.NRECS;

   9890  1 013106   200005 474500                    LDP4    LOC$,,AUTO
         1 013107   300001 235100                    LDA     1,,PR3
         1 013110   400002 755100                    STA     2,,PR4

     2279     9891    2         CODE03.LDA=FM$CFU.LDA;

   9891  1 013111   200005 474500                    LDP4    LOC$,,AUTO
         1 013112   300006 235100                    LDA     6,,PR3
         1 013113   300007 236100                    LDQ     7,,PR3
         1 013114   000033 773000                    LRL     27
         1 013115   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 013116   400004 552134                    STBQ    4,'34'O,PR4

     2280     9892    2         END;

     2281     9893    1      F$DCB.BFR.BUFUP(BUFNO)='1'B;

   9893  1 013117   200015 720100                    LXL0    BUFNO,,AUTO
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:377  
         1 013120   400000 236003                    LDQ     -131072,DU
         1 013121   100115 256110                    ORSQ    77,X0,PR1

     2282     9894    1      RETURN;

   9894  1 013122   000000 702200 xent               TSX2  ! X66_ARET

     2283     9895        %EJECT;
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:378  
     2284     9896    1   FMOE$NOCFUS: B$JIT$->B$JIT.ERR=FMO$E$NOCFUS;

   9896  1 013123   000016 236000 0     FMOE$NOCFUS  LDQ     FMO$E$NOCFUS
         1 013124   000000 470400 xsym               LDP0    B$JIT$
         1 013125   000012 756100                    STQ     10,,PR0

     2285     9897    1   FMOALTRET: ALTRETURN;

   9897  1 013126   000000 702200 xent  FMOALTRET    TSX2  ! X66_AALT
     2286     9898    1   END FMO$BLDFIT;
     2287     9899        %EOD;

PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:379  
--  Include file information  --

   UD_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   KI$CP6V_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   B$P.:E05TOU  cannot be made into a system file and is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   FM_FIELD_C.:E05TOU  is referenced.
   F$CP6P_C.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
      No diagnostics issued in procedure FMO$BLDFIT.
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:380  

 **** Variables and constants ****

  ****  Section 000 RoData FMO$BLDFIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/b BIT (72)    r     1 ANYFOPN                    6-0-0/b STRC        r     1 FCODE0
     7-0-0/b STRC        r     1 FCODE1                     0-0-0/w STRC(180)   r     1 FITHDR
    40-0-0/b STRC        r     1 FMO$E$BADALIGN            21-0-0/b STRC        r     1 FMO$E$BADALT
    37-0-0/b STRC        r     1 FMO$E$BADARRAY            43-0-0/b STRC        r     1 FMO$E$BADCNTFLD
    15-0-0/b STRC        r     1 FMO$E$BADFIT              36-0-0/b STRC        r     1 FMO$E$BADFLDTYPE
    23-0-0/b STRC        r     1 FMO$E$BADFTYPE            44-0-0/b STRC        r     1 FMO$E$BADIFLD
    24-0-0/b STRC        r     1 FMO$E$BADIKEY             25-0-0/b STRC        r     1 FMO$E$BADKEYLEN
    22-0-0/b STRC        r     1 FMO$E$BADLEN              35-0-0/b STRC        r     1 FMO$E$BADSCALE
    32-0-0/b STRC        r     1 FMO$E$BADSTART            20-0-0/b STRC        r     1 FMO$E$BADVECT0
    41-0-0/b STRC        r     1 FMO$E$BADVECT1            31-0-0/b STRC        r     1 FMO$E$BADVECT12
    42-0-0/b STRC        r     1 FMO$E$BADVECT2            27-0-0/b STRC        r     1 FMO$E$BIGKEY
    17-0-0/b STRC        r     1 FMO$E$CLSREL              16-0-0/b STRC        r     1 FMO$E$NOCFUS
    26-0-0/b STRC        r     1 FMO$E$NOFLD               33-0-0/b STRC        r     1 FMO$E$NOIREL
    14-0-0/b STRC        r     1 FMO$E$REATTR              12-0-0/b STRC        r     1 FMO$E$RENAME
    30-0-0/b STRC        r     1 FMO$E$TOOMANYF            34-0-0/b STRC        r     1 FMO$E$TOOMANYL
    13-0-0/b STRC        r     1 FMO$E$VLPERR               5-0-0/b STRC(9)     r     1 INITKEYTBL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DUMMY                    43-0-0/w PTR         r     1 @IR$
    47-0-0/w PTR         r     1 @SIZE                     25-0-0/w PTR         r     1 ALTKEY$
    11-0-0/w PTR         r     1 BUF$                      15-0-0/w SBIN        r     1 BUFNO
    10-0-0/w PTR         r     1 CFU$                      35-0-0/w SBIN        r     1 CODE
    26-0-0/w PTR         r     1 CODE19$                   *0-0-0/w STRC(504)   r     1 CPN$
    *0-0-0/w ACHR        r     1 DUMMY                     21-0-0/w PTR         r     1 FIELD$
     7-0-0/w PTR         r     1 FIT$                      44-0-0/w SBIN        r     1 FN
    12-0-0/w UBIN        r     1 I                         12-0-0/w BIT         r     1 IBIT
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:381  
    51-0-0/w UBIN        r     1 INDX                      *0-0-0/w PTR         r     1 IR$
    23-0-0/w PTR         r     1 IRREC$                    13-0-0/w UBIN        r     1 J
     4-0-0/w PTR         r     1 JDCB$                     13-0-0/w SBIN        r     1 JSBIN
    14-0-0/w UBIN        r     1 K                         24-0-0/w PTR         r     1 KFIELD$
     5-0-0/w PTR         r     1 LOC$                      20-0-0/w SBIN        r     1 LOCCODX
    43-0-0/w SBIN        r     1 N                         34-0-0/w SBIN        r     1 NEWSIZE
    32-0-0/w BIT         r     1 NEW_RECFIELD              33-0-0/w UBIN        r     1 NKEYS
     6-0-0/w STRC        r     1 P1                         6-0-0/w PTR         r     1 P1$
     6-0-0/w STRC        r     1 P1$PTR                    *0-0-0/w STRC(684)   r     1 PN$
    *0-0-0/w UBIN        r     1 RELG_BUFNO                30-0-0/w UBIN        r     1 SAVE_FIELDX
    31-0-0/w UBIN        r     1 SAVE_STARTX               *0-0-0/w UBIN        r     1 SIZE
    22-0-0/w PTR         r     1 START$                    *0-0-0/w STRC        r     1 SZ1
    16-0-0/w PTR         r     1 T$                        17-0-0/w PTR         r     1 T$$
    27-0-0/w SBIN        r     1 TFLEN                     50-0-0/w UBIN        r     1 TMP
    44-0-0/w UBIN        r     1 TOT_NIBS                  43-0-0/w UBIN        r     1 VAR_FIELD_INDX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$P$
     0-0-0/w PTR         r     1 B$PS1$                     0-0-0/w PTR         r     1 B$PS12$
     0-0-0/w PTR         r     1 B$PS2$                     0-0-0/w PTR         r     1 B$ROSEG$
     0-0-0/w PTR         r     1 F$CFU$
     0-0-0/w PTR         r     1 FM$BUF$(0:0)
     0-0-0/w UBIN        r     1 FM_FRZERO                  0-0-0/w UBIN        r     1 FM_SYSACCTX
     0-0-0/w PTR         r     1 S$CU$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(1224)  r     1 B$P(0:0)
     0-0-0/d STRC(576)   r     1 B$U                        0-0-0/w STRC(576)   r     1 CODE01
     0-0-0/w STRC(135)   r     1 CODE02                     0-0-0/w STRC(324)   r     1 CODE03
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:382  
     0-0-0/w STRC(396)   r     1 CODE04                     0-0-0/w STRC(108)   r     1 CODE05
     0-0-0/w STRC(108)   r     1 CODE06                     0-0-0/w STRC(72)    r     1 CODE07
     0-0-0/c STRC(90)    r     1 CODE09                     0-0-0/w STRC(144)   r     1 CODE15
     0-0-0/w STRC(1404)  r     1 CODE16                     0-0-0/d STRC(612)   r     1 CODE17
     0-0-0/w STRC(54)    r     1 CODE19                     0-0-0/w STRC(180)   r     1 CODE20
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(72)    r     1 FIELD_START
     0-0-0/w STRC(4572)  r     1 FITALTKEYS                 0-0-0/w STRC(288)   r     1 FM$CFU
     0-0-0/w STRC(288)   r     1 FM$CFUA                    0-0-0/w STRC(288)   r     1 FM$CFUEXT
     0-0-0/w STRC(288)   r     1 FM$CFUJ                    0-0-0/w STRC        r     1 FM$FDSEG
     0-0-0/w STRC(72)    r     1 FM$FDSTOW                  0-0-0/w STRC(1116)  r     1 FM$FIT
     0-0-0/w STRC(180)   r     1 FM$GRAN
     0-0-0/w UBIN(9)     r     1 FM$KEYTBL(0:279)
     0-0-0/w UBIN        r     1 FM$KT(0:69)                0-0-0/w STRC(288)   r     1 FM$SET(0:0)
     0-0-0/d STRC(144)   r     1 FPT$CLOSE_V                0-0-0/c CHAR(4096)  r     1 GRAN
     0-0-0/w STRC(360)   r     1 IRKEYS                     0-0-0/d STRC(45)    r     1 IRREC
     0-0-0/w STRC(81)    r     1 KFIELD                     0-0-0/c ACHR        r     1 MOVEJ
     0-0-0/w STRC(72)    r     1 O                          0-0-0/w STRC(72)    r     1 OS
     0-0-0/c ACHR        r     1 REC                        0-0-0/c CHAR(4)     r     1 REC4
     0-0-0/d STRC(54)    r     1 RECFIELD                   0-0-0/d STRC(72)    r     1 VLP$ALTKEYS
     0-0-0/d STRC(45)    r     1 VLP$IRREC                  0-0-0/d STRC(54)    r     1 VLP$RECFIELD
     0-0-0/d STRC(90)    r     1 VLP$SN                     0-0-0/w PTR         r     1 XT$
     0-0-0/c ASTR(0)     r     1 ZAPJ                       0-0-0/c ASTR(0)     r     1 ZAP_I


   Procedure FMO$BLDFIT requires 5719 words for executable code.
   Procedure FMO$BLDFIT requires 50 words of local(AUTO) storage.
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:383  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:384  
          MINI XREF LISTING

ALLDONE
      9500**LABEL    9017--GOTO     9044--GOTO
ALTKEY$
      5370**DCL      6732--IMP-PTR  8599<<ASSIGN   8613>>DOINDEX  8615>>DOINDEX  8615>>DOINDEX  8615>>DOINDEX
      8760>>ASSIGN   8769>>ASSIGN   8770>>ASSIGN   8771>>ASSIGN   8772>>ASSIGN   8774>>DOINDEX  8775>>ASSIGN
      8776>>ASSIGN   8777>>ASSIGN   8780>>ASSIGN   8781>>ASSIGN   8782>>ASSIGN   8783>>ASSIGN   8785>>ASSIGN
      8786>>ASSIGN   8788>>DOINDEX  8791>>ASSIGN   8798>>ASSIGN   8801>>ASSIGN   8802>>ASSIGN   9319<<ASSIGN
      9324>>ASSIGN   9332>>DOINDEX  9333>>ASSIGN   9334>>ASSIGN   9335>>ASSIGN   9336>>ASSIGN   9374>>IF
      9375>>ASSIGN   9376>>ASSIGN   9383>>IF       9401<>CALL     9456<<ASSIGN   9458>>ASSIGN   9459>>ASSIGN
      9462>>ASSIGN   9463>>ASSIGN
ALTKFPRG IN PROCEDURE FMO$BLDCODE
      8126**LABEL    8144--GOTO
ANYFOPN
      6943**DCL      9576--CALL
B$DO.ECCINFO
      5195**DCL      5196--REDEF
B$JIT.ACCN
      5715**DCL      8079>>ASSIGN
B$JIT.CURTMPDP
      5806**DCL      9662<>CALL     9663<<ASSIGN   9663>>ASSIGN
B$JIT.DCB$
      5805**DCL      7880>>ASSIGN   8823>>ASSIGN   9012>>ASSIGN   9791>>ASSIGN   9833>>ASSIGN
B$JIT.DEFEXP
      5805**DCL      8067>>ASSIGN
B$JIT.ERR
      5715**DCL      8003<<ASSIGN   8177<<ASSIGN   8204<<ASSIGN   8233<<ASSIGN   8328>>IF       8328<<ASSIGN
      8334<<ASSIGN   8341<<ASSIGN   8350<<ASSIGN   8364<<ASSIGN   8367<<ASSIGN   8369<<ASSIGN   8376<<ASSIGN
      8503<<ASSIGN   8513<<ASSIGN   8523<<ASSIGN   8533<<ASSIGN   8545<<ASSIGN   8675<<ASSIGN   8687<<ASSIGN
      8696<<ASSIGN   8706<<ASSIGN   8716<<ASSIGN   8728<<ASSIGN   8738<<ASSIGN   8933>>IF       8934<<ASSIGN
      9001>>IF       9075<<ASSIGN   9100<<ASSIGN   9114<<ASSIGN   9166<<ASSIGN   9171<<ASSIGN   9240<<ASSIGN
      9252<<ASSIGN   9256<<ASSIGN   9260<<ASSIGN   9264<<ASSIGN   9346<<ASSIGN   9356<<ASSIGN   9386<<ASSIGN
      9433<<ASSIGN   9497<<ASSIGN   9501<<ASSIGN   9631<<ASSIGN   9896<<ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:385  
B$JIT.ERR.CODE
      5716**DCL      8365<<ASSIGN   8365>>ASSIGN
B$JIT.ERR.MID
      5716**DCL      5716--REDEF
B$JIT.MAXEXP
      5805**DCL      8065>>IF       8065>>IF       8066>>ASSIGN   9065>>IF       9065>>IF
B$JIT.PRDPRM
      5806**DCL      9671<<ASSIGN   9671>>ASSIGN
B$JIT.PRIV.ACTIVE.FMEFT
      5716**DCL      7923>>IF       8011>>IF       8064>>IF       9037>>IF       9505>>IF
B$JIT.PRIV.ACTIVE.FMSEC
      5717**DCL      9054>>IF
B$JIT.TMPGAC
      5806**DCL      9662<>CALL
B$JIT.UNAME
      5715**DCL      8078>>ASSIGN
B$JIT$
      5283**DCL      5710--IMP-PTR  7880>>ASSIGN   7923>>IF       8003>>ASSIGN   8011>>IF       8064>>IF
      8065>>IF       8065>>IF       8066>>ASSIGN   8067>>ASSIGN   8078>>ASSIGN   8079>>ASSIGN   8177>>ASSIGN
      8204>>ASSIGN   8233>>ASSIGN   8328>>IF       8328>>ASSIGN   8334>>ASSIGN   8341>>ASSIGN   8350>>ASSIGN
      8364>>ASSIGN   8365>>ASSIGN   8365>>ASSIGN   8367>>ASSIGN   8369>>ASSIGN   8376>>ASSIGN   8503>>ASSIGN
      8513>>ASSIGN   8523>>ASSIGN   8533>>ASSIGN   8545>>ASSIGN   8675>>ASSIGN   8687>>ASSIGN   8696>>ASSIGN
      8706>>ASSIGN   8716>>ASSIGN   8728>>ASSIGN   8738>>ASSIGN   8823>>ASSIGN   8933>>IF       8934>>ASSIGN
      9001>>IF       9012>>ASSIGN   9037>>IF       9054>>IF       9065>>IF       9065>>IF       9075>>ASSIGN
      9100>>ASSIGN   9114>>ASSIGN   9166>>ASSIGN   9171>>ASSIGN   9240>>ASSIGN   9252>>ASSIGN   9256>>ASSIGN
      9260>>ASSIGN   9264>>ASSIGN   9346>>ASSIGN   9356>>ASSIGN   9386>>ASSIGN   9433>>ASSIGN   9497>>ASSIGN
      9501>>ASSIGN   9505>>IF       9631>>ASSIGN   9662>>CALL     9662>>CALL     9663>>ASSIGN   9663>>ASSIGN
      9671>>ASSIGN   9671>>ASSIGN   9791>>ASSIGN   9833>>ASSIGN   9896>>ASSIGN
B$P.NAME
      4992**DCL      8275--ASSIGN
B$P$
      5022**DCL      8275>>ASSIGN
B$PS1$
      5285**DCL      4718--IMP-PTR  9235>>IF       9246<>CALL     9249>>IF       9259>>IF       9259>>IF
      9263<>CALL     9280>>ASSIGN   9284>>ASSIGN
B$PS12$
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:386  
      5287**DCL      4659--IMP-PTR  9341>>IF       9342<>CALL     9354>>IF       9354>>ASSIGN   9380>>ASSIGN
      9381>>ASSIGN   9382>>ASSIGN   9383>>IF       9383>>IF
B$PS2$
      5286**DCL      4675--IMP-PTR  9150>>IF       9152<>CALL     9155>>IF       9169>>IF       9169>>IF
      9184>>ASSIGN   9188>>ASSIGN
B$ROSEG$
      5284**DCL      7954>>ASSIGN   8119>>ASSIGN   8141>>ASSIGN   8186>>ASSIGN   8236>>ASSIGN   8237>>ASSIGN
      8573>>ASSIGN   8598>>ASSIGN   8599>>ASSIGN   8600>>ASSIGN   8601>>ASSIGN   9190>>ASSIGN   9206>>ASSIGN
      9219>>ASSIGN   9225>>ASSIGN   9238>>ASSIGN   9295>>ASSIGN   9299>>ASSIGN   9303>>ASSIGN   9308>>ASSIGN
      9319>>ASSIGN   9402>>ASSIGN   9456>>ASSIGN
B$U.ASL
      5153**DCL      8275>>ASSIGN
B$U.MISC
      5174**DCL      5175--REDEF
B$USER.MISC
      5250**DCL      5251--REDEF
BADVECT12
      9402**LABEL    9387--GOTO     9397--CALLALT
BLDATTR IN PROCEDURE FMO$BLDCODE
      8278**LABEL    8263--GOTO
BLDATTR0 IN PROCEDURE FMO$BLDCODE
      8255**LABEL    8253--GOTO
BLDATTR1 IN PROCEDURE FMO$BLDCODE
      8277**LABEL    8266--GOTO     8269--GOTO
BLDFITX
      7991**LABEL    7927--GOTO
BUF$
      5352**DCL      6638--IMP-PTR  7884<>CALL     7900>>ASSIGN   7902>>IF       7908>>ASSIGN   7932>>ASSIGN
      7933>>ASSIGN   7936>>ASSIGN   7940>>ASSIGN   7945>>ASSIGN   7945>>ASSIGN   7946>>ASSIGN   7946>>ASSIGN
      7947>>ASSIGN   7947>>ASSIGN   7996>>ASSIGN   8828<<ASSIGN   8829>>ASSIGN   8875>>IF       8876>>IF
      8876>>ASSIGN   8879>>IF       8879>>IF       8880>>IF       8880>>IF       8883>>IF       8883>>IF
      8887>>CALL     8887>>CALL     8890>>IF       8892>>CALL     8892>>CALL     8893>>ASSIGN   8893>>ASSIGN
      8894>>ASSIGN   8894>>ASSIGN   8895>>ASSIGN   8895>>ASSIGN   8913>>ASSIGN   8913>>ASSIGN   8914>>IF
      8915>>DOINDEX  8928>>IF       8928>>IF       8938<>CALL     8939>>ASSIGN   8943>>ASSIGN   8969<>CALL
      8970>>ASSIGN   8971>>ASSIGN   8973>>CALL     8973>>CALL     8974>>ASSIGN   8974>>ASSIGN   8975>>ASSIGN
      8975>>ASSIGN   8976>>ASSIGN   8977>>ASSIGN   8988>>IF       8999<>CALL     9000>>ASSIGN   9045<>CALL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:387  
      9047>>ASSIGN   9509<>CALL     9511>>ASSIGN   9801<>CALL     9802>>ASSIGN   9857<>CALL     9859>>ASSIGN
      9861<>CALL     9863>>ASSIGN   9865<<ASSIGN   9867>>ASSIGN   9868>>ASSIGN   9869<<ASSIGN   9870>>ASSIGN
      9871>>ASSIGN   9877<<ASSIGN   9877>>ASSIGN   9878>>ASSIGN   9878>>ASSIGN
BUFNO
      5361**DCL      7885<<ASSIGN   8382>>ASSIGN   8825<<ASSIGN   8830--ASSIGN   8880>>IF       8914>>IF
      8938<>CALL     8940>>IF       8946<>CALL     8949<>CALL     8969<>CALL     8990>>ASSIGN   8991>>IF
      8992<>CALL     8994<>CALL     8999<>CALL     9015<<ASSIGN   9030<<ASSIGN   9031>>DOUNTIL  9032<<ASSIGN
      9032>>ASSIGN   9033>>IF       9033<>CALL     9045<>CALL     9046>>CALL     9418>>IF       9429>>ASSIGN
      9491<>CALL     9509<>CALL     9554>>ASSIGN   9567>>ASSIGN   9618>>IF       9618<>CALL     9720>>IF
      9724>>ASSIGN   9725>>ASSIGN   9727>>ASSIGN   9728>>ASSIGN   9729<<ASSIGN   9731<>CALL     9800<<ASSIGN
      9801<>CALL     9807>>ASSIGN   9809>>IF       9811<>CALL     9836<<ASSIGN   9861<>CALL     9893>>ASSIGN
CFU$
      5351**DCL      6804--IMP-PTR  6810--IMP-PTR  6813--IMP-PTR  7881<<ASSIGN   8034>>ASSIGN   8381>>ASSIGN
      8383>>ASSIGN   8383>>ASSIGN   8830<<ASSIGN   8884>>IF       8928>>IF       8947>>ASSIGN   8960>>IF
      8961>>ASSIGN   8962>>ASSIGN   8964>>ASSIGN   8996>>ASSIGN   8997>>ASSIGN   9013<<ASSIGN   9017>>IF
      9022>>IF       9022>>IF       9023>>ASSIGN   9029>>IF       9037>>IF       9037>>IF       9037>>IF
      9141>>IF       9141>>IF       9325>>ASSIGN   9330>>ASSIGN   9390>>ASSIGN   9419>>ASSIGN   9420>>ASSIGN
      9421>>ASSIGN   9423>>ASSIGN   9424>>ASSIGN   9425>>IF       9426>>ASSIGN   9427>>IF       9448>>ASSIGN
      9449>>ASSIGN   9482>>IF       9482>>IF       9490>>IF       9493>>IF       9493>>ASSIGN   9493>>ASSIGN
      9498>>IF       9508>>IF       9542>>IF       9542>>IF       9545>>IF       9547>>ASSIGN   9557>>IF
      9557>>IF       9557>>IF       9557>>IF       9557>>IF       9565>>ASSIGN   9565>>ASSIGN   9573>>ASSIGN
      9606>>ASSIGN   9606>>ASSIGN   9619>>IF       9622>>ASSIGN   9622>>ASSIGN   9624>>IF       9624>>ASSIGN
      9625>>ASSIGN   9666>>ASSIGN   9668>>IF       9668>>ASSIGN   9674>>ASSIGN   9678>>DOWHILE  9679>>ASSIGN
      9680>>ASSIGN   9700>>ASSIGN   9700>>ASSIGN   9708>>ASSIGN   9719>>IF       9733>>ASSIGN   9792<<ASSIGN
      9794>>IF       9798>>IF       9805>>ASSIGN   9806>>ASSIGN   9834<<ASSIGN   9843>>ASSIGN   9880>>ASSIGN
      9886>>ASSIGN   9889>>ASSIGN   9890>>ASSIGN   9891>>ASSIGN
CHK_OLD_IRREC
      9232**LABEL    9248--GOTO
CODE
      5378**DCL      7917<<DOINDEX  7918>>ASSIGN   7923<<DOINDEX  7978<<ASSIGN   7982>>DOWHILE  7984<<ASSIGN
      7984>>ASSIGN   7990<<ASSIGN   8014>>ASSIGN   8020>>DOCASE   8071<<ASSIGN   8282>>ASSIGN   8312>>IF
      8761<<ASSIGN   8767<<ASSIGN   8827<<ASSIGN   8850>>IF       8860>>ASSIGN   8870>>IF       8875>>IF
      8880>>IF       8902>>ASSIGN   8908>>IF       8914>>IF       9083<<ASSIGN   9109<<DOINDEX  9121<<ASSIGN
      9125<>CALL     9126>>IF       9127>>ASSIGN   9197<<ASSIGN   9208<<ASSIGN   9286<<ASSIGN   9396<<ASSIGN
      9532<<DOINDEX  9534<>CALL     9576<>CALL     9576<>CALL     9586<>CALL     9587>>IF       9588<>CALL
      9589<>CALL     9589<>CALL     9862<<ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:388  
CODE01
      6652**DCL      7994<<ASSIGN
CODE01.HASH
      6652**DCL      7995<<ASSIGN
CODE01.NXTNTS
      6652**DCL      9718<<ASSIGN   9872<<ASSIGN   9872>>ASSIGN
CODE01.XTNT
      6652**DCL      6653--REDEF
CODE02
      6656**DCL      8025--CALL     8026<<ASSIGN
CODE02.GDA
      6657**DCL      9449<<ASSIGN
CODE02.KEYL
      6657**DCL      8033<<ASSIGN
CODE02.KEYX
      6657**DCL      8032<<ASSIGN
CODE02.LRDL0
      6656**DCL      8030<<ASSIGN   9097>>IF       9104<<ASSIGN
CODE02.LSLIDE
      6656**DCL      8029<<ASSIGN   9097>>IF       9103<<ASSIGN
CODE02.SLIDE
      6656**DCL      9448<<ASSIGN
CODE02.SPARE
      6656**DCL      8031<<ASSIGN   9097>>IF       9102<<ASSIGN
CODE02.TDA
      6656**DCL      9467<<ASSIGN
CODE02.TDALVL
      6656**DCL      9466<<ASSIGN
CODE03
      6660**DCL      8038--CALL     8039<<ASSIGN   8039>>ASSIGN   8042<<ASSIGN   9085--CALL
CODE03.COMP
      6662**DCL      8049<<ASSIGN
CODE03.DESC
      6660**DCL      7915>>ASSIGN   8045<<ASSIGN   8060>>ASSIGN   8321<<ASSIGN   9061>>ASSIGN   9076>>ASSIGN
      9088<<ASSIGN   9427>>ASSIGN   9428<<ASSIGN   9541<<ASSIGN
CODE03.DESC.BUPM
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:389  
      6661**DCL      9069>>IF
CODE03.EXPIRE
      6663**DCL      8069<<ASSIGN   9066>>ASSIGN   9069>>IF       9084>>IF       9086<<ASSIGN
CODE03.GHSTACS
      6662**DCL      8057<<ASSIGN   9052>>ASSIGN   9069>>IF       9082<<ASSIGN
CODE03.LDA
      6663**DCL      8047<<ASSIGN   9420<<ASSIGN   9891<<ASSIGN
CODE03.NGAVAL
      6662**DCL      7913>>ASSIGN   7914>>ASSIGN   9421<<ASSIGN   9430>>IF       9659>>ASSIGN   9660<<ASSIGN
      9806<<ASSIGN
CODE03.NRECS
      6662**DCL      8053<<ASSIGN   8056<<ASSIGN   9423<<ASSIGN   9424<<ASSIGN   9890<<ASSIGN
CODE03.NSTAMP
      6663**DCL      7916<>CALL     8063<>CALL
CODE03.ORG
      6660**DCL      8043<<ASSIGN
CODE03.RCSZ
      6662**DCL      8052<<ASSIGN   9425>>IF       9426<<ASSIGN
CODE03.RECL
      6663**DCL      8051<<ASSIGN
CODE03.TYPE
      6662**DCL      8044<<ASSIGN   9054>>IF       9069>>IF       9080<<ASSIGN
CODE03.UGRANS
      6660**DCL      7913>>ASSIGN   7914<<ASSIGN   8061<<ASSIGN   8062<<ASSIGN   9419<<ASSIGN   9805<<ASSIGN
      9884<<ASSIGN   9884>>ASSIGN   9886>>ASSIGN
CODE03.XTNSIZE
      6663**DCL      8048<<ASSIGN   9050>>ASSIGN   9069>>IF       9081<<ASSIGN
CODE04
      6669**DCL      8075--CALL     8076<<ASSIGN   8076>>ASSIGN
CODE04.ACCESS.TIME
      6671**DCL      8081<<ASSIGN
CODE04.CREATION.TIME
      6671**DCL      8087<<ASSIGN
CODE04.CREATOR.ACCT
      6671**DCL      8079<<ASSIGN
CODE04.CREATOR.NAME
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:390  
      6671**DCL      8078<<ASSIGN
CODE04.GAC
      6672**DCL      8392<>CALL
CODE04.GAC.N
      6672**DCL      8086<<ASSIGN   8390<<ASSIGN
CODE04.GAC.TIME
      6672**DCL      8085<<ASSIGN   8388>>IF       8389<<ASSIGN
CODE04.MODIFY
      6671**DCL      9484<>CALL
CODE04.MODIFY.TIME
      6671**DCL      8082<<ASSIGN   9483<<ASSIGN
CODE04.SVMODIFY
      6672**DCL      9481>>IF       9550<>CALL
CODE04.SVMODIFY.TIME
      6672**DCL      8083<<ASSIGN   8084<<ASSIGN   9483>>ASSIGN   9485<<ASSIGN
CODE05
      6675**DCL      8092--ASSIGN   8094<<ASSIGN   8094>>ASSIGN   8096<<ASSIGN
CODE05.BACKUP.EFT
      6675**DCL      9529<<ASSIGN   9529--ASSIGN
CODE05.BACKUP.REEL
      6675**DCL      9528<<ASSIGN
CODE05.BACKUP.TIME
      6675**DCL      9527<<ASSIGN
CODE06
      6678**DCL      9571<<ASSIGN   9571>>ASSIGN   9587--IF       9588--CALL     9597<<ASSIGN   9597>>ASSIGN
CODE06.STOW.EFT
      6678**DCL      6679--REDEF
CODE07
      6682**DCL      8104<<ASSIGN   8104>>ASSIGN   8107--CALL
CODE07.PASS
      6682**DCL      8108<<ASSIGN
CODE09.FFLG.NOLIST
      6691**DCL      8315>>IF
CODE15
      6695**DCL      8149--CALL     8151<<ASSIGN   8156<<ASSIGN   8156>>ASSIGN
CODE15.CGORG
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:391  
      6695**DCL      8152<<ASSIGN
CODE15.QISS
      6695**DCL      8153<<ASSIGN
CODE16
      6698**DCL      8161--CALL     8163--CALL     8164<<ASSIGN   8166<<ASSIGN   8166>>ASSIGN   9477<<ASSIGN
      9477>>ASSIGN
CODE16.IWL
      6702**DCL      9476<<ASSIGN
CODE17
      6708**DCL      8142--ASSIGN
CODE18.DECFIELD
      6717**DCL      6718--REDEF
CODE19.K.FIELDN
      6721**DCL      8792<<ASSIGN   8793>>ASSIGN
CODE19.K.KEYEND
      6721**DCL      8778<<ASSIGN
CODE19.K.UNIQUE
      6721**DCL      8776<<ASSIGN
CODE19.NKEYS
      6721**DCL      8769<<ASSIGN
CODE19$
      5371**DCL      6721--IMP-PTR  8765<<ASSIGN   8766<>CALL     8769>>ASSIGN   8776>>ASSIGN   8778>>ASSIGN
      8792>>ASSIGN   8793>>ASSIGN
CODE20.ALTBLD
      6724**DCL      8771<<ASSIGN   9330<<ASSIGN
CODE20.K
      6724**DCL      8760--ASSIGN
CODE20.K.CONTIGUOUS
      6725**DCL      8802<<ASSIGN
CODE20.K.DEGENERATE
      6725**DCL      8801<<ASSIGN
CODE20.K.FDA
      6725**DCL      8782<<ASSIGN   9335<<ASSIGN
CODE20.K.LDA
      6725**DCL      8783<<ASSIGN   9336<<ASSIGN
CODE20.K.TDA
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:392  
      6724**DCL      8781<<ASSIGN   9334<<ASSIGN
CODE20.K.TDALVL
      6724**DCL      8780<<ASSIGN   9333<<ASSIGN
CODE20.NKEYS
      6724**DCL      8770<<ASSIGN
CODE20.UNIQUEBLD
      6724**DCL      8772<<ASSIGN
CPN$.ALTKEYS_
      4643**DCL      9341>>IF
CPN$.IRREC_
      4642**DCL      9235>>IF
CPN$.RECFIELD_
      4642**DCL      9150>>IF
CPN$.SN_
      4642**DCL      4642--REDEF
CPN$.UTL_
      4642**DCL      4642--REDEF
DONE
      9485**LABEL    9049--CALLALT  9092--CALLALT  9139--CALLALT  9143--GOTO     9315--CALLALT  9413--CALLALT
      9480--CALLALT
DUMMY
        49**DCL        48--PROC     4636--REDEF    4642--REDEF    4645--REDEF    8822--ENTRY    9011--ENTRY
      9741--ENTRY    9832--ENTRY
EFTDESC
      9529**LABEL    9524--CALLALT
EFTFDERR
      9577**LABEL    9586--CALLALT  9588--CALLALT  9589--CALLALT
EFTFDQ
      9599**LABEL    9580--GOTO
ERR IN PROCEDURE FMO$BLDIKEYS
      8805**LABEL    8757--CALLALT  8762--CALLALT
F$CFU$
      5288**DCL      6633--IMP-PTR  8388>>IF       8389>>ASSIGN   9573>>ASSIGN   9622>>ASSIGN   9622>>ASSIGN
      9624>>IF       9668>>ASSIGN   9669>>ASSIGN   9680>>ASSIGN   9682>>ASSIGN   9709>>DOWHILE  9710>>ASSIGN
      9712>>ASSIGN   9843>>ASSIGN   9845>>ASSIGN
F$DCB.ACS
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:393  
      6896**DCL      7897>>IF       7934>>IF       8083>>IF       8966>>IF       9141>>IF       9498>>IF
F$DCB.ACTPOS
      6904**DCL      6904--REDEF
F$DCB.ALTKEYX
      6902**DCL      7953>>IF       7954>>ASSIGN   8118>>IF       8119>>ASSIGN   8202>>IF       8207>>IF
      8599>>ASSIGN   9318>>IF       9319>>ASSIGN   9402<<ASSIGN   9455>>IF       9456>>ASSIGN
F$DCB.ARS
      6879**DCL      6879--REDEF    8351<<ASSIGN   8557<<ASSIGN   8676<<ASSIGN   8697<<ASSIGN   8707<<ASSIGN
      8717<<ASSIGN   8729<<ASSIGN   8739<<ASSIGN
F$DCB.ASN
      6894**DCL      7914>>IF       7934>>IF       9145>>IF       9145>>IF
F$DCB.ATTR
      6897**DCL      6898--REDEF
F$DCB.BFR
      6923**DCL      9723>>ASSIGN   9724<<ASSIGN   9724>>ASSIGN   9725<<ASSIGN
F$DCB.BFR.BUFUP
      6923**DCL      8382<<ASSIGN   9429<<ASSIGN   9554<<ASSIGN   9567<<ASSIGN   9592<<ASSIGN   9618>>IF
      9807<<ASSIGN   9809>>IF       9893<<ASSIGN
F$DCB.BFR.BUFX
      6924**DCL      8828>>ASSIGN
F$DCB.BFR.DA
      6924**DCL      8952<<ASSIGN   9023<<ASSIGN
F$DCB.BFR.SCRUB
      6923**DCL      7998<<ASSIGN   8990<<ASSIGN
F$DCB.BFR1
      6924**DCL      9726>>ASSIGN   9727<<ASSIGN   9727>>ASSIGN   9728<<ASSIGN
F$DCB.BFR1.CX
      6925**DCL      9033>>IF
F$DCB.BORROW
      6912**DCL      6912--REDEF    6912--REDEF    6912--REDEF
F$DCB.CFU$
      6913**DCL      7881>>ASSIGN   9013>>ASSIGN   9021<>CALL     9611<>CALL     9792>>ASSIGN   9834>>ASSIGN
F$DCB.COMP
      6892**DCL      8049>>ASSIGN
F$DCB.CRECNO
      6916**DCL      7903<<ASSIGN   7904<<ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:394  
F$DCB.CTG
      6892**DCL      7934>>IF
F$DCB.DCBNAME.L
      6926**DCL      6926--IMP-SIZ
F$DCB.DESC
      6886**DCL      7915<<ASSIGN   8045>>ASSIGN   8060<<ASSIGN   8321>>ASSIGN   9061<<ASSIGN   9076<<ASSIGN
      9088>>ASSIGN   9427<<ASSIGN   9428>>ASSIGN   9513<<ASSIGN   9541>>ASSIGN
F$DCB.DESC.ARCHIVE
      6887**DCL      9521<<ASSIGN
F$DCB.DESC.BUF
      6886**DCL      9063<<ASSIGN   9518<<ASSIGN   9544<<ASSIGN
F$DCB.DESC.BUPM
      6887**DCL      9062<<ASSIGN   9063>>ASSIGN   9069>>IF       9542>>IF
F$DCB.DESC.NOLIST
      6886**DCL      8313<<ASSIGN   8315<<ASSIGN
F$DCB.DESC.ODSTOW
      6886**DCL      9596>>ASSIGN
F$DCB.DESC.QS
      6887**DCL      9520<<ASSIGN
F$DCB.DISP
      6894**DCL      7917>>IF       8071>>IF
F$DCB.EOMCHAR
      6883**DCL      6883--REDEF
F$DCB.EXPIRE
      6895**DCL      8065>>IF       8065>>IF       8066<<ASSIGN   8067>>IF       8067<<ASSIGN   8069>>ASSIGN
      9064<<ASSIGN   9065>>IF       9065>>IF       9066<<ASSIGN   9069>>IF       9084>>IF       9086>>ASSIGN
F$DCB.FFLG
      6883**DCL      7888<<ASSIGN
F$DCB.FFLG.DELF
      6884**DCL      8257>>IF       9114>>IF       9417>>IF       9433>>IF       9497>>IF       9557>>IF
F$DCB.FFLG.EXEC
      6884**DCL      7890<<ASSIGN
F$DCB.FFLG.REATTR
      6884**DCL      8278>>IF       9074>>IF       9100>>IF       9165>>IF       9251>>IF       9345>>IF
F$DCB.FIELDX
      6903**DCL      8175>>IF       8185>>IF       8186>>ASSIGN   8192>>IF       8232>>IF       8237>>ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:395  
      8573>>ASSIGN   8596>>IF       8598>>ASSIGN   9189>>ASSIGN   9190<<ASSIGN   9218>>IF       9219>>ASSIGN
      9223<<ASSIGN   9255>>IF
F$DCB.FLDID
      6907**DCL      6907--REDEF
F$DCB.FORM$
      6901**DCL      6901--REDEF    8162>>IF       8163<>CALL     8164>>ASSIGN   8166>>ASSIGN   9476>>ASSIGN
      9477>>ASSIGN
F$DCB.FPRGX
      6903**DCL      8140>>IF       8141>>ASSIGN
F$DCB.FSECT
      6917**DCL      6917--REDEF
F$DCB.FSN
      6894**DCL      6894--REDEF    6894--REDEF    6895--REDEF
F$DCB.FUN
      6893**DCL      9037>>IF       9141>>IF       9430>>IF       9495>>IF
F$DCB.GHSTACS
      6902**DCL      8057>>IF       8057>>ASSIGN   8058<<ASSIGN   9052<<ASSIGN   9067<<ASSIGN   9068>>IF
      9068<<ASSIGN   9069>>IF       9082>>ASSIGN
F$DCB.GTYP
      6908**DCL      8948<<ASSIGN
F$DCB.HASH
      6916**DCL      7887<<ASSIGN   7995>>ASSIGN   7996>>ASSIGN
F$DCB.HEADER$
      6900**DCL      6900--REDEF
F$DCB.IASN
      6920**DCL      7901>>IF       8034>>IF       8061>>IF       8928>>IF       8999>>IF
F$DCB.IORG
      6915**DCL      7934>>IF       7934>>IF       7944>>IF       8024>>IF       8046>>IF       8050>>IF
      8160>>IF       8966>>IF       9090>>IF       9885>>IF       9885>>IF
F$DCB.IRRECX
      6907**DCL      8231>>IF       8236>>ASSIGN   9237>>IF       9238>>ASSIGN   9294>>IF       9295>>ASSIGN
      9299<<ASSIGN
F$DCB.IWL
      6920**DCL      9476>>ASSIGN
F$DCB.IXTNSIZE
      6898**DCL      6898--REDEF    7913<<ASSIGN   8056>>ASSIGN   8062>>ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:396  
F$DCB.KEYL
      6896**DCL      8027>>IF       8027<<ASSIGN   8028>>IF       8033>>ASSIGN   8113>>IF       8113>>IF
      8113>>IF
F$DCB.KEYX
      6895**DCL      8032>>ASSIGN   8113>>IF
F$DCB.KFIELDX
      6904**DCL      8600>>ASSIGN
F$DCB.LASTSTA$
      6888**DCL      6888--REDEF
F$DCB.LRDL0
      6896**DCL      8030>>ASSIGN   9096<<ASSIGN   9097>>IF       9104>>ASSIGN
F$DCB.LSLIDE
      6896**DCL      8029>>ASSIGN   9095<<ASSIGN   9097>>IF       9103>>ASSIGN
F$DCB.LVL
      6913**DCL      6913--REDEF
F$DCB.MODCNT
      6918**DCL      9029>>IF
F$DCB.MOVED
      6921**DCL      8923<<ASSIGN   8987<<ASSIGN
F$DCB.NAME
      6888**DCL      9576--CALL
F$DCB.NAME.C
      6888**DCL      6888--REDEF    9557>>IF
F$DCB.NOEOF
      6909**DCL      6909--REDEF
F$DCB.NRECS
      6899**DCL      6899--REDEF    8053>>ASSIGN
F$DCB.NRECX
      6918**DCL      6918--REDEF
F$DCB.OHDR
      6910**DCL      6910--REDEF
F$DCB.ORG
      6893**DCL      6893--REDEF    7933>>ASSIGN   7934>>IF       7955>>IF       7966>>IF       8043>>ASSIGN
      8112>>IF       8148>>IF       8171>>IF       8171>>IF       8171>>IF       8171>>IF       8171>>IF
      8175>>IF       8202>>IF       8207>>IF       8211>>IF       8218>>IF       8227>>IF       8227>>IF
      8227>>IF       8227>>IF       8227>>IF       8966>>IF       8966>>IF       8966>>IF       9163>>IF
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:397  
      9320>>IF       9327>>IF       9350>>IF       9422>>IF       9422>>IF       9457>>IF
F$DCB.OWNER
      6910**DCL      8080<<ASSIGN
F$DCB.PASS
      6889**DCL      8108>>ASSIGN   9120<<ASSIGN   9122>>IF       9130<>CALL
F$DCB.PASSF
      6891**DCL      8106>>IF       9123<<ASSIGN   9131<<ASSIGN
F$DCB.PRECNO
      6916**DCL      6916--REDEF
F$DCB.QISS
      6890**DCL      8153>>ASSIGN
F$DCB.RCSZ
      6921**DCL      6921--REDEF
F$DCB.RECL
      6894**DCL      8051>>ASSIGN   8052>>ASSIGN
F$DCB.RES
      6889**DCL      6889--REDEF
F$DCB.SETX
      6901**DCL      6901--REDEF    8388>>IF       8389>>ASSIGN
F$DCB.SHARED
      6908**DCL      9020>>IF
F$DCB.SPAN
      6910**DCL      9417>>IF
F$DCB.SPARE
      6896**DCL      8031>>ASSIGN   9094<<ASSIGN   9097>>IF       9102>>ASSIGN
F$DCB.STARF
      6908**DCL      7917>>IF       8071>>IF       9037>>IF       9661>>IF
F$DCB.STARTX
      6904**DCL      8601>>ASSIGN   9191>>ASSIGN   9192<<ASSIGN   9224>>IF       9225>>ASSIGN   9229<<ASSIGN
F$DCB.STARX
      6910**DCL      7889>>IF       8272>>IF
F$DCB.TAB$
      6900**DCL      6901--REDEF
F$DCB.TDA
      6915**DCL      6915--REDEF    8152>>ASSIGN   9458<<ASSIGN   9462<<ASSIGN   9467>>ASSIGN
F$DCB.TDALVL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:398  
      6913**DCL      9459<<ASSIGN   9463<<ASSIGN   9466>>ASSIGN
F$DCB.TYPE
      6889**DCL      8041>>IF       8041<<ASSIGN   8044>>ASSIGN   9059<<ASSIGN   9069>>IF       9080>>ASSIGN
F$DCB.UNIQUEBLD
      6920**DCL      9391<<ASSIGN
F$DCB.UPDCNT
      6920**DCL      9619>>IF
F$DCB.WSN
      6890**DCL      6890--REDEF
F$DCB.WSR
      6896**DCL      7891>>IF       7891<<ASSIGN   8041>>IF       8080>>IF       9054>>IF       9670>>IF
F$DCB.XTNSIZE
      6896**DCL      8048>>ASSIGN   9050<<ASSIGN   9060<<ASSIGN   9069>>IF       9081>>ASSIGN
FAG$GAFIT
      5297**DCL-ENT  8937--CALL
FAG$REXT
      5298**DCL-ENT  9492--CALL     9732--CALL     9813--CALL
FCODE0
      6938**DCL      7943>>ASSIGN
FCODE1
      6941**DCL      7942>>ASSIGN
FIELD$
      5366**DCL      6769--IMP-PTR  8186<<ASSIGN   8187>>IF       8189>>ASSIGN   8190>>ASSIGN   8237<<ASSIGN
      8238>>IF       8410>>DOINDEX  8411>>DOCASE   8414>>IF       8416>>IF       8417>>IF       8419>>IF
      8419>>IF       8419>>IF       8419>>IF       8431>>IF       8433>>IF       8433>>IF       8433>>IF
      8433>>IF       8438>>IF       8440>>ASSIGN   8442>>IF       8442>>IF       8445>>IF       8445>>IF
      8445>>IF       8445>>IF       8445>>IF       8445>>IF       8455>>IF       8460>>IF       8464>>IF
      8466>>IF       8470>>IF       8470>>IF       8475>>IF       8479>>IF       8483>>IF       8487>>IF
      8491>>IF       8573<<ASSIGN   8574>>IF       8579>>IF       8582>>IF       8582>>IF       8598<<ASSIGN
      8602>>ASSIGN   8604>>DOINDEX  8605>>IF       8605>>IF       8605>>IF       8618>>IF       8623>>IF
      8623>>IF       8627>>DOCASE   8632>>IF       8635>>IF       8638>>ASSIGN   8641>>IF       8644>>ASSIGN
      8648>>IF       8651>>ASSIGN   8659>>IF       8662>>ASSIGN   8794>>IF       8794>>IF       8794>>IF
      8794>>IF       9193<<ASSIGN   9206<<ASSIGN   9207>>ASSIGN   9211>>ASSIGN   9219<<ASSIGN   9220>>ASSIGN
      9221<>CALL     9303<<ASSIGN   9304>>ASSIGN   9305<>CALL
FIELD_START.NWORDS
      6755**DCL      9226>>ASSIGN   9309>>ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:399  
FIELD_START.OFFSET
      6757**DCL      8632>>IF       8635>>IF       8641>>IF       8648>>IF       8656>>IF       8657>>ASSIGN
      8658>>ASSIGN
FIND_VAR IN PROCEDURE FMO$CHKIKEYS
      8604**LABEL    8610--EXIT
FIT$
      5350**DCL      6642--IMP-PTR  6646--IMP-PTR  6649--IMP-PTR  7908<<ASSIGN   7909>>IF       7910>>ASSIGN
      7919>>ASSIGN   7921>>ASSIGN   7926>>ASSIGN   7926>>ASSIGN   7940<<ASSIGN   7941>>ASSIGN   7942>>ASSIGN
      7943>>ASSIGN   8097>>ASSIGN   8323>>ASSIGN   8397>>ASSIGN   8765>>ASSIGN   8829<<ASSIGN   8849>>DOWHILE
      8850>>IF       8853>>ASSIGN   8855>>IF       8859>>ASSIGN   8860>>ASSIGN   8861>>ASSIGN   8863>>IF
      8864>>ASSIGN   8864>>ASSIGN   8865>>ASSIGN   8865>>ASSIGN   8866>>IF       8870>>ASSIGN   8873>>ASSIGN
      8874>>ASSIGN   8897>>IF       8898>>ASSIGN   8899>>ASSIGN   8900>>ASSIGN   8901>>ASSIGN   8902>>ASSIGN
      8904>>ASSIGN   8904>>ASSIGN   8905>>ASSIGN   8905>>ASSIGN   8907>>DOWHILE  8908>>IF       8908>>IF
      8908>>IF       8910>>ASSIGN   8910>>ASSIGN   8939<<ASSIGN   8942<<ASSIGN   8943>>ASSIGN   8950<<ASSIGN
      8953>>ASSIGN   8954>>ASSIGN   8955>>ASSIGN   8955>>ASSIGN   8956>>ASSIGN   8956>>ASSIGN   8957>>ASSIGN
      8958>>ASSIGN   8971<<ASSIGN   8972>>ASSIGN   8979>>ASSIGN   8980>>IF       8982>>IF       8983>>ASSIGN
      8984>>ASSIGN   8988>>IF       8989>>ASSIGN   9000<<ASSIGN   9047<<ASSIGN   9091>>ASSIGN   9111>>IF
      9124>>ASSIGN   9126>>IF       9127>>ASSIGN   9511<<ASSIGN   9523>>ASSIGN   9526>>ASSIGN   9569>>ASSIGN
      9591<<ASSIGN   9593>>ASSIGN   9594>>ASSIGN   9595>>ASSIGN   9596>>ASSIGN   9597>>ASSIGN   9684>>ASSIGN
      9684>>ASSIGN   9684>>ASSIGN   9715>>ASSIGN   9715>>ASSIGN   9717>>ASSIGN   9802<<ASSIGN   9863<<ASSIGN
      9864>>CALL     9865>>ASSIGN   9873>>ASSIGN   9873>>ASSIGN
FITALTKEYS.ALTBLD
      6685**DCL      7956<<ASSIGN   9325<<ASSIGN   9392<<ASSIGN
FITALTKEYS.K
      6686**DCL      9368--ASSIGN
FITALTKEYS.K.DUPKEY
      6687**DCL      7963<<ASSIGN
FITALTKEYS.K.FDA
      6686**DCL      7955>>IF       7959<<ASSIGN
FITALTKEYS.K.KEYL
      6686**DCL      8125>>IF       8125>>IF       8125>>IF       9380<<ASSIGN
FITALTKEYS.K.KEYX
      6686**DCL      8125>>IF       9381<<ASSIGN
FITALTKEYS.K.LDA
      6686**DCL      7960<<ASSIGN
FITALTKEYS.K.TDA
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:400  
      6686**DCL      7961<<ASSIGN   9458>>ASSIGN
FITALTKEYS.K.TDALVL
      6686**DCL      7962<<ASSIGN   9459>>ASSIGN
FITALTKEYS.K.UNIQUE
      6687**DCL      9382<<ASSIGN
FITALTKEYS.MINWRSIZ
      6685**DCL      9383>>IF
FITALTKEYS.NUMENTS
      6685**DCL      7958>>DOINDEX  8124>>DOINDEX  9394<<ASSIGN
FITALTKEYS.NUMWRDS
      6685**DCL      8120>>ASSIGN   9323>>ASSIGN   9374>>IF       9375>>ASSIGN   9377<<ASSIGN   9400>>ASSIGN
      9405>>ASSIGN
FITALTKEYS.UNIQUEBLD
      6685**DCL      7957<<ASSIGN   9393<<ASSIGN
FITHDR
      6929**DCL      7932>>ASSIGN
FITSP$AFIT IN PROCEDURE FMO$FITSPACE
      8918**LABEL    8879--GOTO     8883--GOTO     8890--GOTO
FITSP$GOTAFIT IN PROCEDURE FMO$FITSPACE
      8997**LABEL    8882--CALLALT  8884--GOTO     8937--CALLALT
FITSP0 IN PROCEDURE FMO$FITSPACE
      8839**LABEL    8925--GOTO     9001--GOTO
FITSP1 IN PROCEDURE FMO$FITSPACE
      8861**LABEL    8850--GOTO
FITSP9 IN PROCEDURE FMO$FITSPACE
      8875**LABEL    8857--GOTO
FM$BUF$
      5293**DCL      8828>>ASSIGN
FM$CFU.ACCTX
      6805**DCL      6805--REDEF    9557>>IF       9573>>ASSIGN   9668>>IF       9669>>ASSIGN
FM$CFU.ACFU
      6804**DCL      9557>>IF
FM$CFU.AFIT
      6804**DCL      8884>>IF       8996<<ASSIGN
FM$CFU.ALTBLD
      6807**DCL      9325>>ASSIGN   9330>>ASSIGN   9390<<ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:401  
FM$CFU.FITSDA
      6805**DCL      8947>>ASSIGN   8961>>ASSIGN   8962<<ASSIGN   8964<<ASSIGN   8997<<ASSIGN   9037>>IF
      9508>>IF       9557>>IF       9798>>IF
FM$CFU.FMOD
      6804**DCL      8381<<ASSIGN   9037>>IF       9427>>IF       9482>>IF       9545>>IF       9547<<ASSIGN
FM$CFU.FUN
      6804**DCL      8960>>IF       9022>>IF       9141>>IF       9490>>IF       9493>>IF       9493<<ASSIGN
      9493>>ASSIGN   9557>>IF       9565<<ASSIGN   9565>>ASSIGN   9619>>IF       9624<<ASSIGN
FM$CFU.GDA
      6806**DCL      9449>>ASSIGN
FM$CFU.LDA
      6807**DCL      9023>>ASSIGN   9420>>ASSIGN   9891>>ASSIGN
FM$CFU.MODCNT
      6806**DCL      8383<<ASSIGN   8383>>ASSIGN   9029>>IF
FM$CFU.NAMEX
      6805**DCL      9557>>IF       9668>>ASSIGN
FM$CFU.NGAVAL
      6807**DCL      9421>>ASSIGN   9606>>ASSIGN   9678>>DOWHILE  9679<<ASSIGN   9700<<ASSIGN   9700>>ASSIGN
      9719>>IF       9733>>ASSIGN   9806>>ASSIGN   9889<<ASSIGN
FM$CFU.NRECS
      6805**DCL      9424>>ASSIGN   9890>>ASSIGN
FM$CFU.RCSZ
      6806**DCL      9425>>IF       9426>>ASSIGN
FM$CFU.SHARE
      6804**DCL      9498>>IF       9625<<ASSIGN
FM$CFU.SHARED
      6804**DCL      9482>>IF       9542>>IF
FM$CFU.SLIDE
      6806**DCL      8034<<ASSIGN   9448>>ASSIGN
FM$CFU.UGRANS
      6806**DCL      9419>>ASSIGN   9423>>ASSIGN   9606>>ASSIGN   9674>>ASSIGN   9805>>ASSIGN   9880>>ASSIGN
      9886<<ASSIGN
FM$CFU.USECNT
      6806**DCL      9037>>IF       9141>>IF       9542>>IF
FM$CFU.XTX
      6806**DCL      8928>>IF       9017>>IF       9622>>ASSIGN   9622>>ASSIGN   9624>>IF       9680>>ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:402  
      9708>>ASSIGN   9794>>IF       9843>>ASSIGN
FM$CFUA.GMOD
      6823**DCL      9609<<ASSIGN   9673<<ASSIGN
FM$CFUA.GRANS
      6825**DCL      9608<<ASSIGN   9608>>ASSIGN   9672<<ASSIGN   9672>>ASSIGN
FM$CFUEXT.LINKX
      6818**DCL      9681>>DOWHILE  9682>>ASSIGN   9709>>DOWHILE  9710>>ASSIGN   9712<<ASSIGN   9844>>DOWHILE
      9845>>ASSIGN   9858<<ASSIGN
FM$CFUEXT.NUM
      6818**DCL      9685>>ASSIGN   9702<<ASSIGN   9847>>ASSIGN   9848>>IF       9854>>ASSIGN   9856>>IF
      9869>>ASSIGN   9874<<ASSIGN   9874>>ASSIGN
FM$CFUEXT.UPDCNT
      6818**DCL      9622<<ASSIGN   9622>>ASSIGN   9624>>IF
FM$CFUEXT.XTNT
      6818**DCL      6819--REDEF
FM$CFUEXT.XTNT.XTNSDA
      6819**DCL      9848>>IF
FM$CFUEXT.XTNT.XTNSIZE
      6818**DCL      9847>>ASSIGN   9854<<ASSIGN
FM$CFUJ.PAGE#
      6814**DCL      9022>>IF
FM$FDSEG
      6642**DCL      9587--IF
FM$FDSEG.DESC
      6642**DCL      9593<<ASSIGN
FM$FDSEG.DESC.ARCHIVE
      6642**DCL      9594<<ASSIGN
FM$FDSEG.DESC.DELF
      6642**DCL      9595<<ASSIGN
FM$FDSEG.DESC.ODSTOW
      6642**DCL      9596<<ASSIGN
FM$FDSTOW.CODE06
      6646**DCL      9597--ASSIGN
FM$FIT
      6649**DCL      7941<<ASSIGN
FM$FIT.CODES
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:403  
      6649**DCL      7921<<ASSIGN   7942<<ASSIGN   7943<<ASSIGN   8017>>ASSIGN   8286>>ASSIGN   8859<<ASSIGN
      8900<<ASSIGN
FM$FIT.CODES.CODE
      6649**DCL      7909>>IF       8827>>ASSIGN   8843>>IF       8849>>DOWHILE  8850>>IF       8860<<ASSIGN
      8861<<ASSIGN   8867>>IF       8897>>IF       8898<<ASSIGN   8902<<ASSIGN   8907>>DOWHILE  8908>>IF
FM$FIT.CODES.ITEMX
      6649**DCL      7926>>ASSIGN   8864<<ASSIGN   8864>>ASSIGN   8865>>ASSIGN   8901<<ASSIGN   8908>>IF
      8910<<ASSIGN   8910>>ASSIGN   9684>>ASSIGN   9715>>ASSIGN
FM$FIT.CODES.NAW
      6649**DCL      8844>>ASSIGN   8855>>IF       8863>>IF       8866>>IF       8873>>ASSIGN   8874>>ASSIGN
      8899<<ASSIGN   8905<<ASSIGN   8905>>ASSIGN
FM$FIT.CODES.NDW
      6649**DCL      7910<<ASSIGN   8097<<ASSIGN   8845>>IF       8846>>ASSIGN   8868>>ASSIGN   8870<<ASSIGN
      8904<<ASSIGN   8904>>ASSIGN   9126>>IF       9127<<ASSIGN   9526<<ASSIGN   9684>>ASSIGN   9717<<ASSIGN
      9864>>CALL     9865>>ASSIGN   9873<<ASSIGN   9873>>ASSIGN
FM$GRAN
      6638**DCL      7908--ASSIGN   7932<<ASSIGN   7940--ASSIGN   8829--ASSIGN   8970--ASSIGN   8971--ASSIGN
      8976--ASSIGN   9000--ASSIGN   9047--ASSIGN   9511--ASSIGN   9802--ASSIGN   9863--ASSIGN
FM$GRAN.AVAIL
      6639**DCL      7946<<ASSIGN   7946>>ASSIGN   8875>>IF       8876>>IF       8876>>ASSIGN   8879>>IF
      8883>>IF       8890>>IF       8894<<ASSIGN   8894>>ASSIGN   8956<<ASSIGN   8975<<ASSIGN   8975>>ASSIGN
FM$GRAN.FCEX
      6639**DCL      7947>>ASSIGN   8880>>IF       8887>>CALL     8895<<ASSIGN   8895>>ASSIGN   8913>>ASSIGN
      8928>>IF       8955>>ASSIGN   8956>>ASSIGN   8970>>ASSIGN   8973>>CALL     8976<<ASSIGN
FM$GRAN.FLINK
      6639**DCL      8958<<ASSIGN
FM$GRAN.KEYCNT
      6639**DCL      8880>>IF       8914>>IF       8915>>DOINDEX  8957<<ASSIGN   8977>>ASSIGN   8988>>IF
FM$GRAN.LVL
      6638**DCL      7902>>IF       7936<<ASSIGN   8928>>IF       8953<<ASSIGN
FM$GRAN.NAVX
      6638**DCL      7945<<ASSIGN   7945>>ASSIGN   8879>>IF       8883>>IF       8892>>CALL     8893<<ASSIGN
      8893>>ASSIGN   8955<<ASSIGN   8973>>CALL     8974<<ASSIGN   8974>>ASSIGN
FM$GRAN.ORG
      6638**DCL      7933<<ASSIGN
FM$GRAN.STAMP
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:404  
      6638**DCL      7996<<ASSIGN
FM$GRAN.STAMP.GMOD
      6638**DCL      8954<<ASSIGN
FM$KEYTBL
      6933**DCL      7945--ASSIGN   7946--ASSIGN   7947<<ASSIGN   8880--IF       8916>>ASSIGN   8917>>IF
      8919>>IF       8920<<ASSIGN   8921<<ASSIGN   8979>>ASSIGN   8980>>IF       8982>>IF       8983<<ASSIGN
      8984<<ASSIGN   8988>>IF       8989<<ASSIGN   8989--ASSIGN
FM$KT
      6933**DCL      6933--REDEF
FM$SET.GACTIME
      6635**DCL      8388>>IF       8389>>ASSIGN
FM$SET.USERLIST
      6634**DCL      6634--REDEF
FMD$FLSHBUF
      5300**DCL-ENT  7883--CALL     8946--CALL     9025--CALL     9033--CALL     9046--CALL     9601--CALL
FMD$GETBUF
      5301**DCL-ENT  7884--CALL     8941--CALL
FMD$REDBUFBC
      5304**DCL-ENT  8949--CALL
FMD$WRTBUF
      5302**DCL-ENT  8994--CALL
FMD$WRTSV
      5303**DCL-ENT  8959--CALL     8992--CALL     9491--CALL     9618--CALL     9731--CALL     9811--CALL
FMG$ADDSEG
      5305**DCL-ENT  9588--CALL
FMG$CURKEY
      5306**DCL-ENT  9586--CALL     9589--CALL
FMG$KEYSQZ
      5307**DCL-ENT  9418--CALL
FMG$MOVKEYS
      5308**DCL-ENT  8882--CALL
FMG$REMKEY
      5309**DCL-ENT  9583--CALL
FMH$MAPJRNL
      5311**DCL-ENT  9024--CALL
FMM$IFPARAM
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:405  
      5312**DCL-ENT  9053--CALL
FMM$NSTAMP
      5313**DCL-ENT  7916--CALL     8063--CALL
FMM$SCRAMBLE
      5314**DCL-ENT  9130--CALL
FMN$GETFIT
      5315**DCL-ENT  8938--CALL     8969--CALL     8999--CALL     9045--CALL     9509--CALL     9801--CALL
      9861--CALL
FMO$BLDCODE
      8010**PROC     7924--CALL     7983--CALL     9110--CALL     9132--CALL     9536--CALL
FMO$BLDIKEYS
      8751**PROC     8209--CALL
FMO$CHKIKEYS
      8590**PROC     8208--CALL
FMO$CHKIRREC
      8562**PROC     8240--CALL     9239--CALL     9263--CALL
FMO$CHKRECFIELD
      8405**PROC     8188--CALL     9194--CALL
FMO$E$BADALIGN
      7857**DCL      8738>>ASSIGN
FMO$E$BADALT
      7797**DCL      8369>>ASSIGN
FMO$E$BADARRAY
      7853**DCL      8533>>ASSIGN
FMO$E$BADCNTFLD
      7869**DCL      8545>>ASSIGN
FMO$E$BADFIT
      7781**DCL      9631>>ASSIGN
FMO$E$BADFLDTYPE
      7849**DCL      8523>>ASSIGN
FMO$E$BADFTYPE
      7805**DCL      8675>>ASSIGN
FMO$E$BADIFLD
      7873**DCL      8350>>ASSIGN
FMO$E$BADIKEY
      7809**DCL      8696>>ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:406  
FMO$E$BADKEYLEN
      7813**DCL      8706>>ASSIGN
FMO$E$BADLEN
      7801**DCL      8503>>ASSIGN
FMO$E$BADSCALE
      7845**DCL      8513>>ASSIGN
FMO$E$BADSTART
      7833**DCL      8728>>ASSIGN
FMO$E$BADVECT0
      7793**DCL      8364>>ASSIGN
FMO$E$BADVECT1
      7861**DCL      9256>>ASSIGN   9260>>ASSIGN   9264>>ASSIGN
FMO$E$BADVECT12
      7829**DCL      9356>>ASSIGN   9386>>ASSIGN
FMO$E$BADVECT2
      7865**DCL      9171>>ASSIGN   9240>>ASSIGN
FMO$E$BIGKEY
      7821**DCL      8716>>ASSIGN
FMO$E$CLSREL
      7789**DCL      8376>>ASSIGN   9433>>ASSIGN
FMO$E$NOCFUS
      7785**DCL      9896>>ASSIGN
FMO$E$NOFLD
      7817**DCL      8233>>ASSIGN   8687>>ASSIGN
FMO$E$NOIREL
      7837**DCL      8177>>ASSIGN   8204>>ASSIGN
FMO$E$REATTR
      7777**DCL      8367>>ASSIGN   9075>>ASSIGN   9100>>ASSIGN   9166>>ASSIGN   9252>>ASSIGN   9346>>ASSIGN
FMO$E$RENAME
      7769**DCL      9114>>ASSIGN   9497>>ASSIGN   9501>>ASSIGN
FMO$E$TOOMANYF
      7825**DCL      8334>>ASSIGN
FMO$E$TOOMANYL
      7841**DCL      8341>>ASSIGN
FMO$E$VLPERR
      7773**DCL      8003>>ASSIGN   8328>>ASSIGN   8934>>ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:407  
FMO$FIELD_START_SETUP
      5319**DCL-ENT  8193--CALL     9195--CALL
FMO$FITSPACE
      8833**PROC     7992--CALL     8025--CALL     8038--CALL     8075--CALL     8093--CALL     8103--CALL
      8107--CALL     8133--CALL     8149--CALL     8161--CALL     8196--CALL     8212--CALL     8219--CALL
      8246--CALL     8273--CALL     8289--CALL     8757--CALL     8762--CALL     8831--CALL     9085--CALL
      9198--CALL     9209--CALL     9287--CALL     9397--CALL     9864--CALL
FMO$LOCCODE
      5316**DCL-ENT  8015--CALL     8284--CALL     9524--CALL
FMO$LOCCODP
      5317**DCL-ENT  8398--CALL     8766--CALL     9092--CALL     9534--CALL     9570--CALL
FMO$LOCCODX
      5318**DCL-ENT  7920--CALL     9125--CALL
FMOALTRET
      9897**LABEL    7983--CALLALT  9045--CALLALT  9500--CALLALT  9575--CALLALT  9861--CALLALT  9864--CALLALT
FMOE$BADALIGN IN PROCEDURE FMO$CHKIKEYS
      8729**LABEL    8634--GOTO
FMOE$BADALT IN PROCEDURE FMO$BLDCODE
      8369**LABEL    8028--GOTO     8116--GOTO     8128--GOTO
FMOE$BADARRAY IN PROCEDURE FMO$CHKRECFIELD
      8523**LABEL    8418--GOTO     8423--GOTO     8432--GOTO     8437--GOTO
FMOE$BADCNTFLD IN PROCEDURE FMO$CHKRECFIELD
      8533**LABEL    8439--GOTO     8444--GOTO     8451--GOTO
FMOE$BADFIT
      9631**LABEL    9540--CALLALT  9570--CALLALT  9883--CALLALT
FMOE$BADFLDTYPE IN PROCEDURE FMO$CHKRECFIELD
      8513**LABEL    8495--GOTO
FMOE$BADFTYPE IN PROCEDURE FMO$CHKIKEYS
      8662**LABEL    8625--GOTO     8630--GOTO     8665--GOTO
FMOE$BADIFLD IN PROCEDURE FMO$BLDCODE
      8341**LABEL    8240--CALLALT
FMOE$BADIKEY IN PROCEDURE FMO$CHKIKEYS
      8687**LABEL    8619--GOTO
FMOE$BADKEYLEN IN PROCEDURE FMO$CHKIKEYS
      8697**LABEL    8637--GOTO     8643--GOTO     8650--GOTO     8661--GOTO
FMOE$BADLEN IN PROCEDURE FMO$CHKRECFIELD
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:408  
      8491**LABEL    8415--GOTO     8456--GOTO     8461--GOTO     8465--GOTO     8472--GOTO     8476--GOTO
      8480--GOTO     8484--GOTO     8488--GOTO     8492--GOTO
FMOE$BADSCALE IN PROCEDURE FMO$CHKRECFIELD
      8503**LABEL    8467--GOTO
FMOE$BADSTART IN PROCEDURE FMO$CHKIKEYS
      8717**LABEL    8621--GOTO
FMOE$BIGKEY IN PROCEDURE FMO$CHKIKEYS
      8707**LABEL    8670--GOTO
FMOE$CLSREL IN PROCEDURE FMO$BLDCODE
      8376**LABEL    8257--GOTO
FMOE$NOCFUS
      9896**LABEL    9857--CALLALT
FMOE$NOFLD IN PROCEDURE FMO$CHKIKEYS
      8676**LABEL    8597--GOTO
FMOE$PSERR IN PROCEDURE FMO$BLDCODE
      8351**LABEL    8294--GOTO
FMOE$REATTR IN PROCEDURE FMO$BLDCODE
      8367**LABEL    8278--GOTO
FMOE$TOOMANYF IN PROCEDURE FMO$BLDCODE
      8328**LABEL    8187--GOTO
FMOE$TOOMANYL IN PROCEDURE FMO$BLDCODE
      8334**LABEL    8239--GOTO
FMOE$VLPERR
      8003**LABEL    7899--GOTO     7909--GOTO     7912--CALLALT  7924--CALLALT  7992--CALLALT  8831--CALLALT
FMOE$VLPERR IN PROCEDURE FMO$BLDCODE
      8328**LABEL    8025--CALLALT  8038--CALLALT  8075--CALLALT  8093--CALLALT  8103--CALLALT  8107--CALLALT
      8133--CALLALT  8149--CALLALT  8161--CALLALT  8183--GOTO     8196--CALLALT  8205--GOTO     8209--CALLALT
      8212--CALLALT  8219--CALLALT  8246--CALLALT  8273--CALLALT  8284--CALLALT  8289--CALLALT
FMP$AFITCTG
      5320**DCL-ENT  8963--CALL
FMP$RENAME
      5321**DCL-ENT  9500--CALL
FMQ$SRCHFD
      5323**DCL-ENT  9576--CALL
FMR$FN
      5324**DCL-ENT  9611--CALL
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:409  
FMR$G8
      5326**DCL-ENT  9857--CALL
FMR$L8
      5327**DCL-ENT  9018--CALL     9556--CALL     9605--CALL     9621--CALL     9667--CALL     9796--CALL
FMR$SLIDE
      5325**DCL-ENT  8887--CALL     8892--CALL     8973--CALL
FMR$U8
      5328**DCL-ENT  9019--CALL     9566--CALL     9612--CALL     9615--CALL     9626--CALL     9675--CALL
      9797--CALL
FMR$UPDGAC
      5333**DCL-ENT  8392--CALL     9662--CALL
FMR$Z8
      5329**DCL-ENT  9707--CALL
FMU$BLD
      5330**DCL-ENT  9028--CALL
FM_FRZERO
      5290**DCL      8047>>ASSIGN
FM_SYSACCTX
      5292**DCL      9557>>IF       9670>>IF
FN IN PROCEDURE FMO$BLDIKEYS
      8754**DCL      8787<<ASSIGN   8789>>IF       8790>>IF       8793<<ASSIGN   8794>>IF       8794>>IF
      8794>>IF       8794>>IF
FPT$CLOSE_V.BUPM
      5269**DCL      9062>>IF       9062>>ASSIGN
FPT$CLOSE_V.DESC
      5266**DCL      9513>>ASSIGN
FPT$CLOSE_V.EFTOPER
      5265**DCL      9505>>IF
FPT$CLOSE_V.EFTOPER.ASTOW
      5265**DCL      9515>>IF
FPT$CLOSE_V.EFTOPER.BACKUP
      5265**DCL      9516>>IF
FPT$CLOSE_V.EFTOPER.DELFDE
      5266**DCL      9557>>IF       9582>>IF
FPT$CLOSE_V.EFTOPER.ISTOW
      5266**DCL      9557>>IF       9568>>IF
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:410  
FPT$CLOSE_V.EFTOPER.UPDDESC
      5266**DCL      9512>>IF
FPT$CLOSE_V.EXPIRE
      5270**DCL      5270--REDEF    9064>>IF       9064>>ASSIGN   9529>>ASSIGN
FPT$CLOSE_V.GHSTACS
      5269**DCL      9067>>IF       9067>>ASSIGN
FPT$CLOSE_V.LRDL0
      5270**DCL      9096>>IF       9096>>ASSIGN
FPT$CLOSE_V.LSLIDE
      5270**DCL      9095>>IF       9095>>ASSIGN
FPT$CLOSE_V.OPER
      5265**DCL      9037>>IF
FPT$CLOSE_V.OPER.CHGATT
      5265**DCL      9051>>IF       9148>>IF       9344>>IF       9495>>IF       9512>>IF
FPT$CLOSE_V.OPER.RELG
      5265**DCL      9417>>IF       9430>>IF
FPT$CLOSE_V.SPARE
      5270**DCL      9094>>IF       9094>>ASSIGN
FPT$CLOSE_V.TYPE
      5269**DCL      5269--REDEF    9054>>IF       9054>>IF       9059>>ASSIGN
FPT$CLOSE_V.XTNSIZE
      5266**DCL      5266--REDEF    5268--REDEF    9060>>IF       9060>>ASSIGN
FSA$FSP
      5332**DCL-ENT  9221--CALL     9227--CALL     9289--CALL     9297--CALL     9305--CALL     9310--CALL
      9401--CALL     9407--CALL
FSA$GSP
      5331**DCL-ENT  8163--CALL     9185--CALL     9281--CALL     9369--CALL
GRAN
      5386**DCL      7900<<ASSIGN   7900>>ASSIGN   8943<<ASSIGN   8943>>ASSIGN
HFF$DSIZ
      5334**DCL-ENT  7898--CALL     8293--CALL     9152--CALL     9246--CALL     9342--CALL
I
      5354**DCL        49--IMP-SIZ  5355--REDEF    5356--REDEF    5379--IMP-SIZ  5381--IMP-SIZ  7886<>CALL
      7887>>ASSIGN   7991<<ASSIGN   7992<>CALL     8014<<ASSIGN   8015<>CALL     8017>>ASSIGN   8081>>ASSIGN
      8082>>ASSIGN   8084>>ASSIGN   8085>>ASSIGN   8087>>ASSIGN   8092<<ASSIGN   8093<>CALL     8103<>CALL
      8120<<ASSIGN   8133<>CALL     8134<<ASSIGN   8134>>ASSIGN   8135>>ASSIGN   8135>>ASSIGN   8142<<ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:411  
      8190<<ASSIGN   8196<>CALL     8197<<ASSIGN   8197>>ASSIGN   8198>>ASSIGN   8198>>ASSIGN   8212<>CALL
      8213<<ASSIGN   8213>>ASSIGN   8214>>ASSIGN   8214>>ASSIGN   8219<>CALL     8220<<ASSIGN   8220>>ASSIGN
      8221>>ASSIGN   8221>>ASSIGN   8242<<ASSIGN   8246<>CALL     8247<<ASSIGN   8247>>ASSIGN   8248>>ASSIGN
      8248>>ASSIGN   8274<<ASSIGN   8275>>ASSIGN   8275>>ASSIGN   8280--ASSIGN   8282<<ASSIGN   8284<>CALL
      8286>>ASSIGN   8289<>CALL     8290<<ASSIGN   8290>>ASSIGN   8294>>IF       8311>>ASSIGN   8311>>ASSIGN
      8314>>DOWHILE  8317<<ASSIGN   8317>>ASSIGN   8392<>CALL     8604<<DOINDEX  8605>>IF       8605>>IF
      8605>>IF       8609>>ASSIGN   8613<<DOINDEX  8615>>DOINDEX  8615>>DOINDEX  8615>>DOINDEX  8676>>ASSIGN
      8697>>ASSIGN   8707>>ASSIGN   8717>>ASSIGN   8729>>ASSIGN   8739>>ASSIGN   8756<<ASSIGN   8757<>CALL
      8758<<ASSIGN   8758>>ASSIGN   8759>>ASSIGN   8760<<ASSIGN   8762<>CALL     8763<<ASSIGN   8763>>ASSIGN
      8764>>ASSIGN   8774<<DOINDEX  8775>>ASSIGN   8776>>ASSIGN   8777>>ASSIGN   8780>>ASSIGN   8780>>ASSIGN
      8781>>ASSIGN   8781>>ASSIGN   8782>>ASSIGN   8782>>ASSIGN   8783>>ASSIGN   8783>>ASSIGN   8785>>ASSIGN
      8786>>ASSIGN   8788>>DOINDEX  8791>>ASSIGN   8798>>ASSIGN   8801>>ASSIGN   8801>>ASSIGN   8802>>ASSIGN
      8802>>ASSIGN   8827--ASSIGN   8831<>CALL     9119<<ASSIGN   9120>>ASSIGN   9152<>CALL     9153>>IF
      9169>>IF       9246<>CALL     9247>>IF       9259>>IF       9323<<ASSIGN   9324>>ASSIGN   9324>>ASSIGN
      9332<<DOINDEX  9333>>ASSIGN   9333>>ASSIGN   9334>>ASSIGN   9334>>ASSIGN   9335>>ASSIGN   9335>>ASSIGN
      9336>>ASSIGN   9336>>ASSIGN   9342<>CALL     9343>>IF       9351<<ASSIGN   9351>>ASSIGN   9352>>IF
      9352<<ASSIGN   9354>>IF       9354<<ASSIGN   9368>>ASSIGN   9379>>DOINDEX  9394>>ASSIGN   9510<>CALL
      9527>>ASSIGN   9571--ASSIGN   9579<<ASSIGN   9597--ASSIGN   9599<<ASSIGN   9604>>IF       9606<<ASSIGN
      9607>>IF       9608>>ASSIGN   9674<<ASSIGN   9685<<ASSIGN   9690<<ASSIGN   9690>>ASSIGN   9691>>ASSIGN
      9696>>ASSIGN   9702>>ASSIGN   9703>>ASSIGN   9704>>IF       9704>>ASSIGN   9705>>IF       9708<<ASSIGN
      9709>>DOWHILE  9710<<ASSIGN   9710>>ASSIGN   9712>>ASSIGN   9716<<ASSIGN   9717>>ASSIGN   9718>>ASSIGN
      9837<<ASSIGN   9840<<ASSIGN   9848>>IF       9853<<ASSIGN   9856>>IF       9864>>CALL     9866>>IF
      9868>>IF       9871>>IF       9872>>ASSIGN   9873>>ASSIGN   9874>>ASSIGN   9880<<ASSIGN
IBIT
      5356**DCL      8017<<ASSIGN   8286<<ASSIGN   8826<<ASSIGN   9723<<ASSIGN   9725>>ASSIGN   9726<<ASSIGN
      9728>>ASSIGN
INDX IN PROCEDURE FMO$FITSPACE
      8839**DCL      8915<<DOINDEX  8916>>ASSIGN   8917>>IF       8919>>IF       8920>>ASSIGN   8921>>ASSIGN
      8977<<ASSIGN   8978>>DOWHILE  8979>>ASSIGN   8980>>IF       8982>>IF       8983>>ASSIGN   8984>>ASSIGN
      8985<<ASSIGN   8985>>ASSIGN
INITKEYTBL
      6935**DCL      7947>>ASSIGN
IR$ IN PROCEDURE FMO$CHKIRREC
      8571**DCL      8562--PROC     8574>>IF       8577>>DOINDEX  8578>>ASSIGN
IRKEYS.ALTBLD
      6732**DCL      7967<<ASSIGN   8771>>ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:412  
IRKEYS.K.CONTIGUOUS
      6735**DCL      8786<<ASSIGN   8791<<ASSIGN   8802>>ASSIGN
IRKEYS.K.DEGENERATE
      6734**DCL      8785<<ASSIGN   8798<<ASSIGN   8801>>ASSIGN
IRKEYS.K.FDA
      6735**DCL      7966>>IF       7970<<ASSIGN   8782>>ASSIGN   9335>>ASSIGN
IRKEYS.K.FIRSTFIELD
      6733**DCL      8615>>DOINDEX  8615>>DOINDEX  8775>>ASSIGN   8788>>DOINDEX
IRKEYS.K.LDA
      6736**DCL      7971<<ASSIGN   8783>>ASSIGN   9336>>ASSIGN
IRKEYS.K.NFIELDS
      6733**DCL      8615>>DOINDEX  8777>>ASSIGN
IRKEYS.K.TDA
      6733**DCL      7972<<ASSIGN   8781>>ASSIGN   9334>>ASSIGN   9462>>ASSIGN
IRKEYS.K.TDALVL
      6733**DCL      7973<<ASSIGN   8780>>ASSIGN   9333>>ASSIGN   9463>>ASSIGN
IRKEYS.K.UNIQUE
      6734**DCL      8776>>ASSIGN
IRKEYS.NKEYS
      6732**DCL      7969>>DOINDEX  8613>>DOINDEX  8760>>ASSIGN   8769>>ASSIGN   8770>>ASSIGN   8774>>DOINDEX
      9332>>DOINDEX
IRKEYS.UNIQUEBLD
      6732**DCL      7968<<ASSIGN   8772>>ASSIGN
IRREC.FIELDN
      6801**DCL      8578>>ASSIGN
IRREC.NFIELDS
      6801**DCL      8238>>IF       8238>>IF       8242>>ASSIGN   8574>>IF       8577>>DOINDEX  9285>>ASSIGN
      9288>>ASSIGN   9296>>ASSIGN
IRREC$
      5368**DCL      6801--IMP-PTR  8236<<ASSIGN   8238>>IF       8238>>IF       8240<>CALL     8241>>ASSIGN
      8242>>ASSIGN   9238<<ASSIGN   9239<>CALL     9295<<ASSIGN   9296>>ASSIGN   9297<>CALL
J
      5357**DCL      5358--REDEF    5359--REDEF    5382--IMP-SIZ  5384--IMP-SIZ  8097>>ASSIGN   8124<<DOINDEX
      8125>>IF       8125>>IF       8125>>IF       8125>>IF       8351>>ASSIGN   8410<<DOINDEX  8411>>DOCASE
      8414>>IF       8416>>IF       8417>>IF       8419>>IF       8419>>IF       8419>>IF       8419>>IF
      8431>>IF       8433>>IF       8433>>IF       8433>>IF       8433>>IF       8438>>IF       8438>>IF
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:413  
      8440>>ASSIGN   8455>>IF       8460>>IF       8464>>IF       8466>>IF       8470>>IF       8470>>IF
      8475>>IF       8479>>IF       8483>>IF       8487>>IF       8491>>IF       8557>>ASSIGN   8577<<DOINDEX
      8578>>ASSIGN   8615<<DOINDEX  8617>>ASSIGN   8848<<ASSIGN   8849>>DOWHILE  8850>>IF       8851<<ASSIGN
      8851>>ASSIGN   8853>>ASSIGN   8855>>IF       8859>>ASSIGN   8860>>ASSIGN   8861>>ASSIGN   8863>>IF
      8864>>ASSIGN   8865>>ASSIGN   8866>>IF       8870>>ASSIGN   8873>>ASSIGN   8874>>ASSIGN   8897>>IF
      8898>>ASSIGN   8899>>ASSIGN   8900>>ASSIGN   8901>>ASSIGN   8901>>ASSIGN   8902>>ASSIGN   8905>>ASSIGN
      8905>>ASSIGN   8906<<ASSIGN   8907>>DOWHILE  8908>>IF       8908>>IF       8910>>ASSIGN   8910>>ASSIGN
      8911<<ASSIGN   8911>>ASSIGN   8947<<ASSIGN   8949<>CALL     8961<<ASSIGN   8964>>ASSIGN   8970<<ASSIGN
      8973<>CALL     8974>>ASSIGN   8975>>ASSIGN   8979>>ASSIGN   8987>>ASSIGN   9016<<ASSIGN   9137<<ASSIGN
      9187<<ASSIGN   9188>>ASSIGN   9188>>ASSIGN   9199<<ASSIGN   9200>>ASSIGN   9200>>ASSIGN   9210<<ASSIGN
      9211>>ASSIGN   9211>>ASSIGN   9283<<ASSIGN   9284>>ASSIGN   9284>>ASSIGN   9292<<ASSIGN   9293>>ASSIGN
      9293>>ASSIGN   9313<<ASSIGN   9372<<ASSIGN   9373>>ASSIGN   9375<<ASSIGN   9376>>ASSIGN   9376>>ASSIGN
      9398<<ASSIGN   9399>>ASSIGN   9399>>ASSIGN   9411<<ASSIGN   9418<>CALL     9430>>IF       9433>>IF
      9441<<ASSIGN   9490>>IF       9492>>IF       9492<>CALL     9514<<ASSIGN   9515<<ASSIGN   9516<<ASSIGN
      9517>>IF       9518>>IF       9524<>CALL     9526>>ASSIGN   9688<<ASSIGN   9689>>ASSIGN   9691>>ASSIGN
      9694<<ASSIGN   9695>>ASSIGN   9696>>ASSIGN   9699>>ASSIGN   9700>>ASSIGN   9701<<ASSIGN   9732<>CALL
      9736<<ASSIGN   9736>>ASSIGN   9809>>IF       9812>>IF       9813<>CALL     9847<<ASSIGN   9848>>IF
      9848>>IF       9848>>IF       9854>>ASSIGN   9857<>CALL     9858>>ASSIGN
JDCB$
      5341**DCL      6879--IMP-PTR  7880<<ASSIGN   7881>>ASSIGN   7887>>ASSIGN   7888>>ASSIGN   7889>>IF
      7890>>ASSIGN   7891>>IF       7891>>ASSIGN   7897>>IF       7901>>IF       7903>>ASSIGN   7904>>ASSIGN
      7913>>ASSIGN   7914>>IF       7915>>ASSIGN   7917>>IF       7917>>IF       7933>>ASSIGN   7934>>IF
      7934>>IF       7934>>IF       7934>>IF       7934>>IF       7934>>IF       7944>>IF       7953>>IF
      7954>>ASSIGN   7955>>IF       7966>>IF       7995>>ASSIGN   7996>>ASSIGN   7998>>ASSIGN   8024>>IF
      8027>>IF       8027>>ASSIGN   8028>>IF       8029>>ASSIGN   8030>>ASSIGN   8031>>ASSIGN   8032>>ASSIGN
      8033>>ASSIGN   8034>>IF       8041>>IF       8041>>IF       8041>>ASSIGN   8043>>ASSIGN   8044>>ASSIGN
      8045>>ASSIGN   8046>>IF       8048>>ASSIGN   8049>>ASSIGN   8050>>IF       8051>>ASSIGN   8052>>ASSIGN
      8053>>ASSIGN   8056>>ASSIGN   8057>>IF       8057>>ASSIGN   8058>>ASSIGN   8060>>ASSIGN   8061>>IF
      8062>>ASSIGN   8065>>IF       8065>>IF       8066>>ASSIGN   8067>>IF       8067>>ASSIGN   8069>>ASSIGN
      8071>>IF       8071>>IF       8080>>IF       8080>>ASSIGN   8083>>IF       8106>>IF       8108>>ASSIGN
      8112>>IF       8113>>IF       8113>>IF       8113>>IF       8113>>IF       8118>>IF       8119>>ASSIGN
      8140>>IF       8141>>ASSIGN   8148>>IF       8152>>ASSIGN   8153>>ASSIGN   8160>>IF       8162>>IF
      8163>>CALL     8164>>ASSIGN   8166>>ASSIGN   8171>>IF       8171>>IF       8171>>IF       8171>>IF
      8171>>IF       8175>>IF       8175>>IF       8185>>IF       8186>>ASSIGN   8192>>IF       8202>>IF
      8202>>IF       8207>>IF       8207>>IF       8211>>IF       8218>>IF       8227>>IF       8227>>IF
      8227>>IF       8227>>IF       8227>>IF       8231>>IF       8232>>IF       8236>>ASSIGN   8237>>ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:414  
      8257>>IF       8272>>IF       8278>>IF       8313>>ASSIGN   8315>>ASSIGN   8321>>ASSIGN   8351>>ASSIGN
      8382>>ASSIGN   8388>>IF       8389>>ASSIGN   8557>>ASSIGN   8573>>ASSIGN   8596>>IF       8598>>ASSIGN
      8599>>ASSIGN   8600>>ASSIGN   8601>>ASSIGN   8676>>ASSIGN   8697>>ASSIGN   8707>>ASSIGN   8717>>ASSIGN
      8729>>ASSIGN   8739>>ASSIGN   8823<<ASSIGN   8828>>ASSIGN   8923>>ASSIGN   8928>>IF       8948>>ASSIGN
      8952>>ASSIGN   8966>>IF       8966>>IF       8966>>IF       8966>>IF       8966>>IF       8987>>ASSIGN
      8990>>ASSIGN   8999>>IF       9012<<ASSIGN   9013>>ASSIGN   9020>>IF       9021>>CALL     9023>>ASSIGN
      9029>>IF       9033>>IF       9037>>IF       9037>>IF       9050>>ASSIGN   9052>>ASSIGN   9054>>IF
      9059>>ASSIGN   9060>>ASSIGN   9061>>ASSIGN   9062>>ASSIGN   9063>>ASSIGN   9063>>ASSIGN   9064>>ASSIGN
      9065>>IF       9065>>IF       9066>>ASSIGN   9067>>ASSIGN   9068>>IF       9068>>ASSIGN   9069>>IF
      9069>>IF       9069>>IF       9069>>IF       9069>>IF       9074>>IF       9076>>ASSIGN   9080>>ASSIGN
      9081>>ASSIGN   9082>>ASSIGN   9084>>IF       9086>>ASSIGN   9088>>ASSIGN   9090>>IF       9094>>ASSIGN
      9095>>ASSIGN   9096>>ASSIGN   9097>>IF       9097>>IF       9097>>IF       9100>>IF       9102>>ASSIGN
      9103>>ASSIGN   9104>>ASSIGN   9114>>IF       9120>>ASSIGN   9122>>IF       9123>>ASSIGN   9130>>CALL
      9131>>ASSIGN   9141>>IF       9141>>IF       9145>>IF       9145>>IF       9163>>IF       9165>>IF
      9189>>ASSIGN   9190>>ASSIGN   9191>>ASSIGN   9192>>ASSIGN   9218>>IF       9219>>ASSIGN   9223>>ASSIGN
      9224>>IF       9225>>ASSIGN   9229>>ASSIGN   9237>>IF       9238>>ASSIGN   9251>>IF       9255>>IF
      9294>>IF       9295>>ASSIGN   9299>>ASSIGN   9318>>IF       9319>>ASSIGN   9320>>IF       9327>>IF
      9345>>IF       9350>>IF       9391>>ASSIGN   9402>>ASSIGN   9417>>IF       9417>>IF       9422>>IF
      9422>>IF       9427>>ASSIGN   9428>>ASSIGN   9429>>ASSIGN   9430>>IF       9433>>IF       9455>>IF
      9456>>ASSIGN   9457>>IF       9458>>ASSIGN   9459>>ASSIGN   9462>>ASSIGN   9463>>ASSIGN   9466>>ASSIGN
      9467>>ASSIGN   9476>>ASSIGN   9476>>ASSIGN   9477>>ASSIGN   9495>>IF       9497>>IF       9498>>IF
      9513>>ASSIGN   9518>>ASSIGN   9520>>ASSIGN   9521>>ASSIGN   9541>>ASSIGN   9542>>IF       9544>>ASSIGN
      9554>>ASSIGN   9557>>IF       9557>>IF       9567>>ASSIGN   9576>>CALL     9592>>ASSIGN   9596>>ASSIGN
      9611>>CALL     9618>>IF       9619>>IF       9661>>IF       9670>>IF       9723>>ASSIGN   9724>>ASSIGN
      9724>>ASSIGN   9725>>ASSIGN   9726>>ASSIGN   9727>>ASSIGN   9727>>ASSIGN   9728>>ASSIGN   9791<<ASSIGN
      9792>>ASSIGN   9807>>ASSIGN   9809>>IF       9833<<ASSIGN   9834>>ASSIGN   9885>>IF       9885>>IF
      9893>>ASSIGN
JSBIN
      5359**DCL      9698>>IF
K
      5360**DCL      7898<>CALL     7899>>IF       7918<<ASSIGN   7920<>CALL     7921>>ASSIGN   8292<<ASSIGN
      8293<>CALL     8293<>CALL     8294>>IF       8440<<ASSIGN   8441>>IF       8442>>IF       8442>>IF
      8445>>IF       8445>>IF       8445>>IF       8445>>IF       8445>>IF       8445>>IF       8578<<ASSIGN
      8579>>IF       8581>>IF       8582>>IF       8582>>IF       8617<<ASSIGN   8618>>IF       8620>>IF
      8622>>IF       8623>>IF       8623>>IF       8627>>DOCASE   8632>>IF       8632>>IF       8635>>IF
      8635>>IF       8638>>ASSIGN   8641>>IF       8641>>IF       8644>>ASSIGN   8648>>IF       8648>>IF
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:415  
      8651>>ASSIGN   8656>>IF       8657>>ASSIGN   8658>>ASSIGN   8659>>IF       8662>>ASSIGN   8775<<ASSIGN
      8776>>ASSIGN   8777<<ASSIGN   8777>>ASSIGN   8778>>ASSIGN   8788>>DOINDEX  8841<<ASSIGN   8842>>IF
      8842<<ASSIGN   8844<<ASSIGN   8845>>IF       8846<<ASSIGN   8856<<ASSIGN   8856>>ASSIGN   8866>>IF
      8873<<ASSIGN   8873>>ASSIGN   8875>>IF       8876<<ASSIGN   8877<<ASSIGN   8880>>IF       8882<>CALL
      8887<>CALL     8887>>CALL     8890>>IF       8892<>CALL     8893>>ASSIGN   8894>>ASSIGN   8895>>ASSIGN
      8904>>ASSIGN   8905>>ASSIGN   8910>>ASSIGN   8916>>ASSIGN   8923>>ASSIGN   8928>>IF       8937<>CALL
      8952>>ASSIGN   8954>>ASSIGN   8962>>ASSIGN   8997>>ASSIGN   9220<<ASSIGN   9221<>CALL     9226<<ASSIGN
      9227<>CALL     9288<<ASSIGN   9289<>CALL     9296<<ASSIGN   9297<>CALL     9304<<ASSIGN   9305<>CALL
      9309<<ASSIGN   9310<>CALL     9379<<DOINDEX  9380>>ASSIGN   9380>>ASSIGN   9381>>ASSIGN   9381>>ASSIGN
      9382>>ASSIGN   9382>>ASSIGN   9383>>IF       9383>>IF       9400<<ASSIGN   9401<>CALL     9405<<ASSIGN
      9407<>CALL     9659<<ASSIGN   9663>>ASSIGN   9671>>ASSIGN   9672>>ASSIGN   9674>>ASSIGN   9688>>ASSIGN
      9694>>ASSIGN   9699<<ASSIGN   9699>>ASSIGN   9733<<ASSIGN
KFIELD.FIELD
      6739**DCL      8617>>ASSIGN   8790>>IF       8792>>ASSIGN
KFIELD.NFIELDS
      6739**DCL      8756>>ASSIGN
KFIELD$
      5369**DCL      6739--IMP-PTR  8600<<ASSIGN   8617>>ASSIGN   8756>>ASSIGN   8790>>IF       8792>>ASSIGN
LOC$
      5342**DCL      6652--IMP-PTR  6656--IMP-PTR  6660--IMP-PTR  6669--IMP-PTR  6675--IMP-PTR  6678--IMP-PTR
      6682--IMP-PTR  6685--IMP-PTR  6691--IMP-PTR  6695--IMP-PTR  6698--IMP-PTR  6717--IMP-PTR  6724--IMP-PTR
      6729--IMP-PTR  7913>>ASSIGN   7913>>ASSIGN   7914>>ASSIGN   7914>>ASSIGN   7915>>ASSIGN   7916>>CALL
      7926<<ASSIGN   7994>>ASSIGN   7995>>ASSIGN   8026>>ASSIGN   8029>>ASSIGN   8030>>ASSIGN   8031>>ASSIGN
      8032>>ASSIGN   8033>>ASSIGN   8039>>ASSIGN   8042>>ASSIGN   8043>>ASSIGN   8044>>ASSIGN   8045>>ASSIGN
      8047>>ASSIGN   8048>>ASSIGN   8049>>ASSIGN   8051>>ASSIGN   8052>>ASSIGN   8053>>ASSIGN   8056>>ASSIGN
      8057>>ASSIGN   8060>>ASSIGN   8061>>ASSIGN   8062>>ASSIGN   8063>>CALL     8069>>ASSIGN   8076>>ASSIGN
      8078>>ASSIGN   8079>>ASSIGN   8081>>ASSIGN   8082>>ASSIGN   8083>>ASSIGN   8084>>ASSIGN   8085>>ASSIGN
      8086>>ASSIGN   8087>>ASSIGN   8094>>ASSIGN   8096>>ASSIGN   8104>>ASSIGN   8108>>ASSIGN   8135>>ASSIGN
      8151>>ASSIGN   8152>>ASSIGN   8153>>ASSIGN   8156>>ASSIGN   8166>>ASSIGN   8198>>ASSIGN   8214>>ASSIGN
      8221>>ASSIGN   8248>>ASSIGN   8275>>ASSIGN   8311>>ASSIGN   8315>>IF       8316<<ASSIGN   8316>>ASSIGN
      8321>>ASSIGN   8323<<ASSIGN   8388>>IF       8389>>ASSIGN   8390>>ASSIGN   8392>>CALL     8399<<ASSIGN
      8759>>ASSIGN   8764>>ASSIGN   8770>>ASSIGN   8771>>ASSIGN   8772>>ASSIGN   8780>>ASSIGN   8781>>ASSIGN
      8782>>ASSIGN   8783>>ASSIGN   8801>>ASSIGN   8802>>ASSIGN   8853<<ASSIGN   8865<<ASSIGN   8874<<ASSIGN
      8874>>ASSIGN   8886>>ASSIGN   8887>>CALL     8891>>ASSIGN   8892>>CALL     8908>>IF       8913<<ASSIGN
      8916>>ASSIGN   8917>>IF       8919>>IF       8920>>ASSIGN   8921>>ASSIGN   9050>>ASSIGN   9052>>ASSIGN
      9054>>IF       9061>>ASSIGN   9066>>ASSIGN   9069>>IF       9069>>IF       9069>>IF       9069>>IF
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:416  
      9069>>IF       9076>>ASSIGN   9080>>ASSIGN   9081>>ASSIGN   9082>>ASSIGN   9084>>IF       9086>>ASSIGN
      9088>>ASSIGN   9108<<ASSIGN   9111>>IF       9200>>ASSIGN   9211>>ASSIGN   9293>>ASSIGN   9323>>ASSIGN
      9324>>ASSIGN   9325>>ASSIGN   9330>>ASSIGN   9333>>ASSIGN   9334>>ASSIGN   9335>>ASSIGN   9336>>ASSIGN
      9399>>ASSIGN   9400>>ASSIGN   9419>>ASSIGN   9420>>ASSIGN   9421>>ASSIGN   9423>>ASSIGN   9424>>ASSIGN
      9425>>IF       9426>>ASSIGN   9427>>ASSIGN   9428>>ASSIGN   9430>>IF       9448>>ASSIGN   9449>>ASSIGN
      9466>>ASSIGN   9467>>ASSIGN   9477>>ASSIGN   9481>>IF       9483>>ASSIGN   9483>>ASSIGN   9484>>CALL
      9485>>ASSIGN   9525<<ASSIGN   9527>>ASSIGN   9528>>ASSIGN   9529>>ASSIGN   9541>>ASSIGN   9550>>CALL
      9569<<ASSIGN   9570<>CALL     9571>>ASSIGN   9659>>ASSIGN   9660>>ASSIGN   9684<<ASSIGN   9686>>IF
      9687<<ASSIGN   9687>>ASSIGN   9688>>ASSIGN   9689>>ASSIGN   9694>>ASSIGN   9695>>ASSIGN   9701>>ASSIGN
      9714>>ASSIGN   9716>>ASSIGN   9736>>ASSIGN   9805>>ASSIGN   9806>>ASSIGN   9865>>ASSIGN   9872>>ASSIGN
      9872>>ASSIGN   9884>>ASSIGN   9884>>ASSIGN   9886>>ASSIGN   9890>>ASSIGN   9891>>ASSIGN
LOCCODP
      8396**PROC     7912--CALL     8320--CALL     8387--CALL     9049--CALL     9139--CALL     9315--CALL
      9322--CALL     9329--CALL     9413--CALL     9447--CALL     9474--CALL     9480--CALL     9540--CALL
      9549--CALL     9804--CALL     9883--CALL
LOCCODX
      5365**DCL      7911<<ASSIGN   8319<<ASSIGN   8386<<ASSIGN   8398<>CALL     9048<<ASSIGN   9138<<ASSIGN
      9314<<ASSIGN   9321<<ASSIGN   9328<<ASSIGN   9412<<ASSIGN   9446<<ASSIGN   9473<<ASSIGN   9479<<ASSIGN
      9539<<ASSIGN   9548<<ASSIGN   9803<<ASSIGN   9882<<ASSIGN
MEBBEDELF
      9554**LABEL    9508--GOTO     9509--CALLALT
MODIFIED IN PROCEDURE FMO$BLDCODE
      8380**ENTRY    9079--CALL     9105--CALL     9111--CALL     9134--CALL
MOVEJ
      5382**DCL      9200<<ASSIGN   9200>>ASSIGN   9211<<ASSIGN   9211>>ASSIGN   9293<<ASSIGN   9293>>ASSIGN
      9376<<ASSIGN   9376>>ASSIGN   9399<<ASSIGN   9399>>ASSIGN
N IN PROCEDURE FMO$BLDIKEYS
      8753**DCL      8788<<DOINDEX  8790>>IF       8792>>ASSIGN   8792>>ASSIGN   8793>>ASSIGN
NEWSIZE
      5377**DCL      9184<<ASSIGN   9185<>CALL     9187>>ASSIGN   9196<<ASSIGN   9198<>CALL     9199>>ASSIGN
      9207<<ASSIGN   9209<>CALL     9210>>ASSIGN   9280<<ASSIGN   9281<>CALL     9283>>ASSIGN   9285<<ASSIGN
      9287<>CALL     9292>>ASSIGN   9368<<ASSIGN   9369<>CALL     9372>>ASSIGN   9374>>IF       9377>>ASSIGN
      9397<>CALL     9398>>ASSIGN
NEW_RECFIELD
      5375**DCL      9147<<ASSIGN   9201<<ASSIGN   9204>>IF       9230<<ASSIGN   9237>>IF       9301>>IF
NKEYS
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:417  
      5376**DCL      7958<<DOINDEX  7959>>ASSIGN   7960>>ASSIGN   7961>>ASSIGN   7962>>ASSIGN   7963>>ASSIGN
      7969<<DOINDEX
NOALT
      9405**LABEL    9322--CALLALT  9329--CALLALT  9341--GOTO     9343--GOTO     9344--GOTO     9347--GOTO
      9357--GOTO     9369--CALLALT
NOEFTUP
      9535**LABEL    9534--CALLALT
NOFIX
      7922**LABEL    7920--CALLALT
NOMOD
      9128**LABEL    9125--CALLALT  9126--GOTO
NOXPIRE
      9086**LABEL    9085--CALLALT
NO_IRREC
      9299**LABEL    9149--GOTO     9164--GOTO     9167--GOTO     9172--GOTO     9185--CALLALT  9209--CALLALT
      9213--GOTO     9232--GOTO     9244--GOTO     9250--GOTO     9253--GOTO     9257--GOTO
NO_RECFIELD
      9226**LABEL    9151--GOTO     9154--GOTO     9156--GOTO
NXTCODE
      9473**LABEL    9447--CALLALT
NXTCODE1
      9477**LABEL    9474--CALLALT
O
      5273**DCL      5276--REDEF
O.ADR
      5274**DCL      9703<<ASSIGN   9714<<ASSIGN   9867<<ASSIGN   9867>>ASSIGN   9870<<ASSIGN   9870>>ASSIGN
O.SIZ
      5275**DCL      9688>>ASSIGN   9689<<ASSIGN   9691<<ASSIGN   9704<<ASSIGN   9838>>IF       9839>>ASSIGN
      9848>>IF       9854>>ASSIGN   9868<<ASSIGN   9868>>ASSIGN   9871<<ASSIGN   9871>>ASSIGN   9878>>ASSIGN
      9884>>ASSIGN   9889>>ASSIGN
OS.ADR
      5278**DCL      9701>>ASSIGN   9736>>ASSIGN   9848>>IF
OS.SIZ
      5277**DCL      9686>>IF       9694>>ASSIGN   9695<<ASSIGN   9696<<ASSIGN   9839<<ASSIGN   9878<<ASSIGN
      9878>>ASSIGN
P1.WOFF
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:418  
      5348**DCL      9670>>IF       9709>>DOWHILE
P1$
      5343**DCL      5344--REDEF    5347--REDEF    6818--IMP-PTR  6822--IMP-PTR  7954<<ASSIGN   7955>>IF
      7956>>ASSIGN   7957>>ASSIGN   7958>>DOINDEX  7959>>ASSIGN   7960>>ASSIGN   7961>>ASSIGN   7962>>ASSIGN
      7963>>ASSIGN   7966>>IF       7967>>ASSIGN   7968>>ASSIGN   7969>>DOINDEX  7970>>ASSIGN   7971>>ASSIGN
      7972>>ASSIGN   7973>>ASSIGN   8016<<ASSIGN   8019<<ASSIGN   8039>>IF       8039>>ASSIGN   8076>>IF
      8076>>ASSIGN   8092>>IF       8094>>IF       8094>>ASSIGN   8102>>IF       8104>>ASSIGN   8118>>IF
      8119<<ASSIGN   8120>>ASSIGN   8123>>IF       8124>>DOINDEX  8125>>IF       8125>>IF       8125>>IF
      8125>>IF       8132>>IF       8135>>ASSIGN   8140>>IF       8141<<ASSIGN   8150>>IF       8156>>ASSIGN
      8175>>IF       8185>>IF       8189<<ASSIGN   8195>>IF       8198>>ASSIGN   8202>>IF       8207>>IF
      8211>>IF       8214>>ASSIGN   8218>>IF       8221>>ASSIGN   8231>>IF       8241<<ASSIGN   8245>>IF
      8248>>ASSIGN   8252<<ASSIGN   8255<<ASSIGN   8257>>IF       8265<<ASSIGN   8268<<ASSIGN   8271<<ASSIGN
      8277>>IF       8280>>ASSIGN   8281>>IF       8283>>ASSIGN   8285<<ASSIGN   8288<<ASSIGN   8288>>ASSIGN
      8311>>ASSIGN   9093<<ASSIGN   9097>>IF       9097>>IF       9097>>IF       9102>>ASSIGN   9103>>ASSIGN
      9104>>ASSIGN   9186<<ASSIGN   9188>>ASSIGN   9190>>ASSIGN   9193>>ASSIGN   9196>>ASSIGN   9200>>ASSIGN
      9282<<ASSIGN   9284>>ASSIGN   9285>>ASSIGN   9288>>ASSIGN   9289<>CALL     9293>>ASSIGN   9299>>ASSIGN
      9370<<ASSIGN   9373>>ASSIGN   9376>>ASSIGN   9377>>ASSIGN   9380>>ASSIGN   9381>>ASSIGN   9382>>ASSIGN
      9392>>ASSIGN   9393>>ASSIGN   9394>>ASSIGN   9399>>ASSIGN   9402>>ASSIGN   9405>>ASSIGN   9406>>ASSIGN
      9535<<ASSIGN   9573<<ASSIGN   9574>>ASSIGN   9602>>ASSIGN   9608>>ASSIGN   9608>>ASSIGN   9609>>ASSIGN
      9666<<ASSIGN   9668<<ASSIGN   9669<<ASSIGN   9669>>ASSIGN   9672>>ASSIGN   9672>>ASSIGN   9673>>ASSIGN
      9680<<ASSIGN   9681>>DOWHILE  9682<<ASSIGN   9682>>ASSIGN   9685>>ASSIGN   9691>>ASSIGN   9696>>ASSIGN
      9702>>ASSIGN   9703>>ASSIGN   9704>>ASSIGN   9706>>ASSIGN   9715<<ASSIGN   9716>>ASSIGN   9718>>ASSIGN
      9843<<ASSIGN   9844>>DOWHILE  9845<<ASSIGN   9845>>ASSIGN   9847>>ASSIGN   9847>>ASSIGN   9848>>IF
      9848>>IF       9854>>ASSIGN   9854>>ASSIGN   9856>>IF       9858>>ASSIGN   9859<<ASSIGN   9869>>ASSIGN
      9869>>ASSIGN   9874>>ASSIGN   9874>>ASSIGN
P1$PTR.COFF
      5345**DCL      8294>>IF
P1$PTR.SEGID
      5346**DCL      8291>>IF       8292>>ASSIGN   8365>>ASSIGN
PN$
      4636**DCL      8826>>ASSIGN   9053<>CALL     9838--IF       9839--ASSIGN   9839--ASSIGN   9848--IF
      9848--IF       9854--ASSIGN   9867--ASSIGN   9868--ASSIGN   9870--ASSIGN   9871--ASSIGN   9878--ASSIGN
      9884--ASSIGN   9889--ASSIGN
PN$.ACCESS_
      4636**DCL      8252>>ASSIGN
PN$.ACSVEH_
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:419  
      4637**DCL      4637--REDEF    8255>>ASSIGN
PN$.ALTKEYS_
      4639**DCL      4639--REDEF    4639--REDEF
PN$.HDR_
      4638**DCL      4638--REDEF
PN$.IFPARAM_
      4637**DCL      7898--CALL     7900>>ASSIGN   8011>>IF       8013>>ASSIGN   8017>>ASSIGN   8281>>IF
      8286>>ASSIGN   9053>>IF       9532>>IF       9533>>ASSIGN
PN$.INSTATTR_
      4637**DCL      8268>>ASSIGN
PN$.NAME_
      4636**DCL      9496>>IF       9500<>CALL
PN$.PASS_
      4636**DCL      9113>>IF       9120>>ASSIGN
PN$.PROCATTR_
      4637**DCL      8271>>ASSIGN
PN$.SN_
      4636**DCL      4732--IMP-PTR  9528>>ASSIGN
PN$.TAB_
      4638**DCL      4638--REDEF
PN$.UATTR_
      4637**DCL      8265>>ASSIGN
PN$.UHL_
      4636**DCL      4636--REDEF    4636--REDEF
PN$.V_
      4636**DCL      5265--IMP-PTR  7898--CALL     9037>>IF       9051>>IF       9054>>IF       9054>>IF
      9059>>ASSIGN   9060>>IF       9060>>ASSIGN   9062>>IF       9062>>ASSIGN   9064>>IF       9064>>ASSIGN
      9067>>IF       9067>>ASSIGN   9094>>IF       9094>>ASSIGN   9095>>IF       9095>>ASSIGN   9096>>IF
      9096>>ASSIGN   9148>>IF       9344>>IF       9417>>IF       9430>>IF       9495>>IF       9505>>IF
      9512>>IF       9512>>IF       9513>>ASSIGN   9515>>IF       9516>>IF       9529>>ASSIGN   9557>>IF
      9557>>IF       9568>>IF       9582>>IF
PN$.WSN_
      4638**DCL      4638--REDEF
REC
      5379**DCL      8135<<ASSIGN   8135>>ASSIGN   8198<<ASSIGN   8198>>ASSIGN   8214<<ASSIGN   8214>>ASSIGN
      8221<<ASSIGN   8221>>ASSIGN   8248<<ASSIGN   8248>>ASSIGN   8275<<ASSIGN   8275>>ASSIGN   8311<<ASSIGN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:420  
      8311>>ASSIGN   9120>>ASSIGN   9324<<ASSIGN   9324>>ASSIGN
REC4
      5385**DCL      8280<<ASSIGN   8280>>ASSIGN
RECALT IN PROCEDURE FMO$CHKRECFIELD
      8545**LABEL    8504--GOTO     8514--GOTO     8524--GOTO     8534--GOTO
RECFIELD.DECFIELD.LEN
      6776**DCL      8455>>IF       8460>>IF       8464>>IF       8487>>IF       8491>>IF       8648>>IF
      8651>>ASSIGN   8659>>IF       8662>>ASSIGN
RECFIELD.DECFIELD.SCALE
      6776**DCL      8466>>IF
RECFIELD.FIELD
      6776**DCL      6776--REDEF
RECFIELD.FIELD.LEN
      6776**DCL      8414>>IF       8438>>IF       8440>>ASSIGN   8470>>IF       8470>>IF       8475>>IF
      8479>>IF       8483>>IF       8632>>IF       8635>>IF       8638>>ASSIGN   8641>>IF       8644>>ASSIGN
RECFIELD.FIELD.TYPE
      6776**DCL      8411>>DOCASE   8416>>IF       8419>>IF       8419>>IF       8419>>IF       8419>>IF
      8433>>IF       8433>>IF       8433>>IF       8433>>IF       8442>>IF       8442>>IF       8445>>IF
      8445>>IF       8445>>IF       8445>>IF       8445>>IF       8445>>IF       8582>>IF       8582>>IF
      8605>>IF       8605>>IF       8605>>IF       8623>>IF       8623>>IF       8627>>DOCASE   8794>>IF
      8794>>IF       8794>>IF       8794>>IF
RECFIELD.NFIELDS
      6769**DCL      8187>>IF       8190>>ASSIGN   8238>>IF       8410>>DOINDEX  8417>>IF       8431>>IF
      8574>>IF       8579>>IF       8602>>ASSIGN   8604>>DOINDEX  8618>>IF       9196>>ASSIGN   9207>>ASSIGN
      9220>>ASSIGN   9304>>ASSIGN
RELG
      9634**PROC     9434--CALL     9808--CALL
RELG_ALT
      9809**LABEL    9801--CALLALT
RELG_BUFNO
      4645**DCL      9800>>ASSIGN
RET123 IN PROCEDURE FMO$BLDCODE
      8019**LABEL    8015--CALLALT
RETALT IN PROCEDURE FMO$BLDCODE
      8365**LABEL    8163--CALLALT  8188--CALLALT  8193--CALLALT  8208--CALLALT  8234--GOTO     8320--CALLALT
      8387--CALLALT
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:421  
RSTR_OLD_RECFIELD
      9196**LABEL    9241--GOTO     9261--GOTO     9265--GOTO     9281--CALLALT  9290--GOTO
RSTR_RECFIELD_ROSEG
      9211**LABEL    9194--CALLALT  9195--CALLALT  9198--CALLALT
S$CU$
      5261**DCL      8275>>ASSIGN
SAVE_FIELDX
      5373**DCL      9189<<ASSIGN   9205>>IF       9206>>ASSIGN   9223>>ASSIGN   9302>>IF       9303>>ASSIGN
SAVE_STARTX
      5374**DCL      9191<<ASSIGN   9229>>ASSIGN   9307>>IF       9308>>ASSIGN
SIZE IN PROCEDURE FMO$FITSPACE
      8834**DCL      8833--PROC     8835--REDEF    8843--IF       8844--ASSIGN   8845--IF       8846--ASSIGN
      8854>>IF       8867--IF       8868<<ASSIGN   8868--ASSIGN   8869<<ASSIGN   8870>>ASSIGN
SSS$SYSTIME
      5335**DCL-ENT  7886--CALL     9484--CALL     9510--CALL     9550--CALL
START$
      5367**DCL      6754--IMP-PTR  8601<<ASSIGN   8632>>IF       8635>>IF       8641>>IF       8648>>IF
      8656>>IF       8657>>ASSIGN   8658>>ASSIGN   9225<<ASSIGN   9226>>ASSIGN   9227<>CALL     9308<<ASSIGN
      9309>>ASSIGN   9310<>CALL
SZ1.NAW IN PROCEDURE FMO$FITSPACE
      8836**DCL      8842>>IF       8842>>ASSIGN   8869>>IF
SZ1.NDW IN PROCEDURE FMO$FITSPACE
      8837**DCL      8841>>ASSIGN   8869>>ASSIGN
T$
      5362**DCL      7882--ASSIGN   7919<<ASSIGN   8013<<ASSIGN   8016>>ASSIGN   8283<<ASSIGN   8285>>ASSIGN
      8397<<ASSIGN   8399>>ASSIGN   8824--ASSIGN   8886<<ASSIGN   8891<<ASSIGN   8942>>ASSIGN   8950>>ASSIGN
      8972<<ASSIGN   9014--ASSIGN   9091<<ASSIGN   9093>>ASSIGN   9124<<ASSIGN   9186>>ASSIGN   9282>>ASSIGN
      9370>>ASSIGN   9406<<ASSIGN   9523<<ASSIGN   9525>>ASSIGN   9533<<ASSIGN   9535>>ASSIGN   9574<<ASSIGN
      9591>>ASSIGN   9602<<ASSIGN   9706<<ASSIGN   9793--ASSIGN   9835--ASSIGN
T$$
      5363**DCL      5364--IMP-PTR  7882<<ASSIGN   7920>>CALL     8015>>CALL     8284>>CALL     8398>>CALL
      8824<<ASSIGN   8887>>CALL     8892>>CALL     8941>>CALL     8949>>CALL     8973>>CALL     9014<<ASSIGN
      9092>>CALL     9125>>CALL     9185>>CALL     9281>>CALL     9369>>CALL     9407>>CALL     9524>>CALL
      9534>>CALL     9575>>CALL     9576>>CALL     9586>>CALL     9589>>CALL     9603>>CALL     9707>>CALL
      9793<<ASSIGN   9835<<ASSIGN
TFLEN
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:422  
      5372**DCL      8614<<ASSIGN   8638<<ASSIGN   8638>>ASSIGN   8644<<ASSIGN   8644>>ASSIGN   8651<<ASSIGN
      8651>>ASSIGN   8662<<ASSIGN   8662>>ASSIGN   8669>>IF
TMP IN PROCEDURE FMO$FITSPACE
      8838**DCL      8916<<ASSIGN   8918<<ASSIGN   8918>>ASSIGN   8919>>IF       8921>>ASSIGN   8979<<ASSIGN
      8981<<ASSIGN   8981>>ASSIGN   8982>>IF       8984>>ASSIGN
TOT_NIBS IN PROCEDURE FMO$CHKIKEYS
      8593**DCL      8657<<ASSIGN   8658<<ASSIGN   8659>>IF
UPDGAC IN PROCEDURE FMO$BLDCODE
      8385**ENTRY    9676--CALL     9881--CALL
UQB$MDEQ
      5337**DCL-ENT  9603--CALL
UQB$MENQX
      5336**DCL-ENT  9021--CALL     9575--CALL
VAR_FIELD_INDX IN PROCEDURE FMO$CHKIKEYS
      8592**DCL      8602<<ASSIGN   8609<<ASSIGN   8620>>IF
VLP$ALTKEYS.K.KEYL#
      4660**DCL      9380>>ASSIGN   9383>>IF
VLP$ALTKEYS.K.KEYX#
      4660**DCL      9381>>ASSIGN   9383>>IF
VLP$ALTKEYS.K.UNIQUE#
      4659**DCL      9382>>ASSIGN
VLP$ALTKEYS.SIZ#
      4659**DCL      9354>>IF       9354>>ASSIGN
VLP$IRREC.NFIELDS#
      4718**DCL      9259>>IF       9259>>IF       9280>>ASSIGN
VLP$IRREC.VLPID#
      4718**DCL      9249>>IF
VLP$RECFIELD.FIELD
      4683**DCL      4683--REDEF
VLP$RECFIELD.NFIELDS#
      4675**DCL      9169>>IF       9169>>IF       9184>>ASSIGN
VLP$RECFIELD.VLPID#
      4675**DCL      9155>>IF
VLP$SN.SN#
      4732**DCL      9528>>ASSIGN
XT$
PL6.E3A0      #001=FMO$BLDFIT File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:55 Page:423  
      5364**DCL      7920<>CALL     8015<>CALL     8284<>CALL     8398<>CALL     8887<>CALL     8892<>CALL
      8941<>CALL     8949<>CALL     8973<>CALL     9092<>CALL     9125<>CALL     9185<>CALL     9281<>CALL
      9369<>CALL     9407<>CALL     9524<>CALL     9534<>CALL     9575<>CALL     9576<>CALL     9586<>CALL
      9589<>CALL     9603<>CALL     9707<>CALL
ZAPJ
      5383**DCL      9188<<ASSIGN   9188>>ASSIGN   9284<<ASSIGN   9284>>ASSIGN   9373<<ASSIGN
ZAP_I
      5380**DCL      8759<<ASSIGN   8764<<ASSIGN

PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:424  
     2288        1        /*T***********************************************************/
     2289        2        /*T*                                                         */
     2290        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2291        4        /*T*                                                         */
     2292        5        /*T***********************************************************/
     2293        6                    /* FMO$LOCCODx */
     2294        7        %INCLUDE FM$FIT;
     2295      228        %LIST;
     2296      229           %LOCCODE(PREF=FMO);
               230        %LSET LISTDIR='0'B;
               237        FMO$LOCCODE:  PROC(FIT$,CODE) ALTRET;
               238    1   DCL FIT$ PTR;
               239    1   DCL CODE UBIN;
               240    1   DCL I UBIN;
               241    1   DCL NC UBIN;
               242    1   DCL ENTNO UBIN;
               248    1           ENTNO=0;
               249    1           GOTO MAINLOOP;
               250    1   FMO$LOCCODX:  ENTRY(FIT$,CODE) ALTRET;
               251    1           ENTNO=2;
               252    1           GOTO MAINLOOP;
               253    1   FMO$LOCCODT:  ENTRY(FIT$,CODE)ALTRET;
               254    1           ENTNO=3;
               255    1           GOTO MAINLOOP;
               256    1   FMO$LOCCODP:  ENTRY(FIT$,CODE) ALTRET;
               257    1           ENTNO=1;
               258    1   MAINLOOP:
               259    1           NC=FM$FIT.CODES.CODE(0);
               260    2           DO I= 1 TO NC;
               261    3              IF FM$FIT.CODES.CODE(I)=CODE THEN DO CASE(ENTNO);
               262    3               CASE(0);
               263    3                 FIT$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(I));
               264    3                 CODE=I;
               265    3                 RETURN;
               266    3               CASE(1);
               267    3                 FIT$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(I));
               268    3                 RETURN;
PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:425  
               269    3               CASE(2);
               270    3                 CODE=I;
               271    3                 RETURN;
               272    3               CASE(3);
               273    3                 IF FM$FIT.CODES.NDW(I)=0 THEN ALTRETURN;
               274    3                 FIT$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(I));
               275    3                 RETURN;
               276    3               END;
               277    2              END;
               278    1           ALTRETURN;
               279    1   END FMO$LOCCODE;
     2297      281        %EOD;

PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:426  
--  Include file information  --

   FM$FIT.:E05TOU  is referenced.
      No diagnostics issued in procedure FMO$LOCCODE.

   Procedure FMO$LOCCODE requires 73 words for executable code.
   Procedure FMO$LOCCODE requires 8 words of local(AUTO) storage.

PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:427  

 Object Unit name= FMO$LOCCODE                                File name= FMO$OBSE.:E05TOU
 UTS= JUL 29 '97 16:57:49.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    73    111  FMO$LOCCODE
    1  RoData even  none     1      1  FMO$LOCCODE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        2  FMO$LOCCODE
     0      4          yes     yes      Std        2  FMO$LOCCODX
     0     11          yes     yes      Std        2  FMO$LOCCODT
     0     16          yes     yes      Std        2  FMO$LOCCODP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:428  


     2288        1        /*T***********************************************************/
     2289        2        /*T*                                                         */
     2290        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2291        4        /*T*                                                         */
     2292        5        /*T***********************************************************/
     2293        6                    /* FMO$LOCCODx */
     2294        7        %INCLUDE FM$FIT;
     2295      228        %LIST;
     2296      229           %LOCCODE(PREF=FMO);
               230        %LSET LISTDIR='0'B;
               237        FMO$LOCCODE:  PROC(FIT$,CODE) ALTRET;

    237  0 000000   000000 700200 xent  FMO$LOCCODE  TSX0  ! X66_AUTO_2
         0 000001   000010 000002                    ZERO    8,2

               238    1   DCL FIT$ PTR;
               239    1   DCL CODE UBIN;
               240    1   DCL I UBIN;
               241    1   DCL NC UBIN;
               242    1   DCL ENTNO UBIN;
               248    1           ENTNO=0;

    248  0 000002   200007 450100                    STZ     ENTNO,,AUTO

               249    1           GOTO MAINLOOP;

    249  0 000003   000022 710000 0                  TRA     MAINLOOP

               250    1   FMO$LOCCODX:  ENTRY(FIT$,CODE) ALTRET;

    250  0 000004   000000 700200 xent  FMO$LOCCODX  TSX0  ! X66_AUTO_2
         0 000005   000010 000002                    ZERO    8,2

               251    1           ENTNO=2;

    251  0 000006   000002 235007                    LDA     2,DL
PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:429  
         0 000007   200007 755100                    STA     ENTNO,,AUTO

               252    1           GOTO MAINLOOP;

    252  0 000010   000022 710000 0                  TRA     MAINLOOP

               253    1   FMO$LOCCODT:  ENTRY(FIT$,CODE)ALTRET;

    253  0 000011   000000 700200 xent  FMO$LOCCODT  TSX0  ! X66_AUTO_2
         0 000012   000010 000002                    ZERO    8,2

               254    1           ENTNO=3;

    254  0 000013   000003 235007                    LDA     3,DL
         0 000014   200007 755100                    STA     ENTNO,,AUTO

               255    1           GOTO MAINLOOP;

    255  0 000015   000022 710000 0                  TRA     MAINLOOP

               256    1   FMO$LOCCODP:  ENTRY(FIT$,CODE) ALTRET;

    256  0 000016   000000 700200 xent  FMO$LOCCODP  TSX0  ! X66_AUTO_2
         0 000017   000010 000002                    ZERO    8,2

               257    1           ENTNO=1;

    257  0 000020   000001 235007                    LDA     1,DL
         0 000021   200007 755100                    STA     ENTNO,,AUTO

               258    1   MAINLOOP:
               259    1           NC=FM$FIT.CODES.CODE(0);

    259  0 000022   200003 470500       MAINLOOP     LDP0    @FIT$,,AUTO
         0 000023   000000 471500                    LDP1    0,,PR0
         0 000024   100000 236100                    LDQ     0,,PR1
         0 000025   000037 772000                    QRL     31
PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:430  
         0 000026   200006 756100                    STQ     NC,,AUTO

               260    2           DO I= 1 TO NC;

    260  0 000027   000001 235007                    LDA     1,DL
         0 000030   200005 755100                    STA     I,,AUTO
         0 000031   000105 710000 0                  TRA     s:277+3

               261    3              IF FM$FIT.CODES.CODE(I)=CODE THEN DO CASE(ENTNO);

    261  0 000032   200003 470500                    LDP0    @FIT$,,AUTO
         0 000033   000000 471500                    LDP1    0,,PR0
         0 000034   200004 473500                    LDP3    @CODE,,AUTO
         0 000035   200005 720100                    LXL0    I,,AUTO
         0 000036   100000 236110                    LDQ     0,X0,PR1
         0 000037   000037 772000                    QRL     31
         0 000040   300000 116100                    CMPQ    0,,PR3
         0 000041   000102 601000 0                  TNZ     s:277

    261  0 000042   200007 235100                    LDA     ENTNO,,AUTO
         0 000043   000004 115007                    CMPA    4,DL
         0 000044   000046 602005 0                  TNC     s:261+12,AL
         0 000045   000102 710000 0                  TRA     s:277
         0 000046   000052 710000 0                  TRA     s:263
         0 000047   000061 710000 0                  TRA     s:267
         0 000050   000066 710000 0                  TRA     s:270
         0 000051   000071 710000 0                  TRA     s:273

               262    3               CASE(0);

               263    3                 FIT$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(I));

    263  0 000052   100000 721110                    LXL1    0,X0,PR1
         0 000053   001777 361003                    ANX1    1023,DU
         0 000054   100000 634511                    EPPR4   0,X1,PR1
         0 000055   000000 454500                    STP4    0,,PR0

PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:431  
               264    3                 CODE=I;

    264  0 000056   200005 236100                    LDQ     I,,AUTO
         0 000057   300000 756100                    STQ     0,,PR3

               265    3                 RETURN;

    265  0 000060   000000 702200 xent               TSX2  ! X66_ARET

               266    3               CASE(1);

               267    3                 FIT$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(I));

    267  0 000061   100000 721110                    LXL1    0,X0,PR1
         0 000062   001777 361003                    ANX1    1023,DU
         0 000063   100000 634511                    EPPR4   0,X1,PR1
         0 000064   000000 454500                    STP4    0,,PR0

               268    3                 RETURN;

    268  0 000065   000000 702200 xent               TSX2  ! X66_ARET

               269    3               CASE(2);

               270    3                 CODE=I;

    270  0 000066   200005 235100                    LDA     I,,AUTO
         0 000067   300000 755100                    STA     0,,PR3

               271    3                 RETURN;

    271  0 000070   000000 702200 xent               TSX2  ! X66_ARET

               272    3               CASE(3);

               273    3                 IF FM$FIT.CODES.NDW(I)=0 THEN ALTRETURN;

PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:432  
    273  0 000071   100000 236110                    LDQ     0,X0,PR1
         0 000072   000000 316000 1                  CANQ    0
         0 000073   000075 601000 0                  TNZ     s:274

    273  0 000074   000000 702200 xent               TSX2  ! X66_AALT

               274    3                 FIT$=PINCRW(FIT$,FM$FIT.CODES.ITEMX(I));

    274  0 000075   100000 721110                    LXL1    0,X0,PR1
         0 000076   001777 361003                    ANX1    1023,DU
         0 000077   100000 634511                    EPPR4   0,X1,PR1
         0 000100   000000 454500                    STP4    0,,PR0

               275    3                 RETURN;

    275  0 000101   000000 702200 xent               TSX2  ! X66_ARET

               276    3               END;

               277    2              END;

    277  0 000102   200005 235100                    LDA     I,,AUTO
         0 000103   000001 035007                    ADLA    1,DL
         0 000104   200005 755100                    STA     I,,AUTO
         0 000105   200006 236100                    LDQ     NC,,AUTO
         0 000106   200005 116100                    CMPQ    I,,AUTO
         0 000107   000032 603000 0                  TRC     s:261

               278    1           ALTRETURN;

    278  0 000110   000000 702200 xent               TSX2  ! X66_AALT
               279    1   END FMO$LOCCODE;
     2297      281        %EOD;

PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:433  
--  Include file information  --

   FM$FIT.:E05TOU  is referenced.
      No diagnostics issued in procedure FMO$LOCCODE.
PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:434  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CODE                      3-0-0/w PTR         r     1 @FIT$
    *0-0-0/w UBIN        r     1 CODE                       7-0-0/w UBIN        r     1 ENTNO
    *0-0-0/w PTR         r     1 FIT$                       5-0-0/w UBIN        r     1 I
     6-0-0/w UBIN        r     1 NC

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1116)  r     1 FM$FIT


   Procedure FMO$LOCCODE requires 73 words for executable code.
   Procedure FMO$LOCCODE requires 8 words of local(AUTO) storage.
PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:435  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FMO$LOCCODE File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:57 Page:436  
          MINI XREF LISTING

CODE
       239**DCL       237--PROC      250--ENTRY     253--ENTRY     256--ENTRY     261>>IF        264<<ASSIGN
       270<<ASSIGN
ENTNO
       242**DCL       248<<ASSIGN    251<<ASSIGN    254<<ASSIGN    257<<ASSIGN    261>>DOCASE
FIT$
       238**DCL       237--PROC      245--IMP-PTR   250--ENTRY     253--ENTRY     256--ENTRY     259>>ASSIGN
       261>>IF        263<<ASSIGN    263>>ASSIGN    263>>ASSIGN    267<<ASSIGN    267>>ASSIGN    267>>ASSIGN
       273>>IF        274<<ASSIGN    274>>ASSIGN    274>>ASSIGN
FM$FIT.CODES.CODE
       245**DCL       259>>ASSIGN    261>>IF
FM$FIT.CODES.ITEMX
       245**DCL       263>>ASSIGN    267>>ASSIGN    274>>ASSIGN
FM$FIT.CODES.NDW
       245**DCL       273>>IF
I
       240**DCL       260<<DOINDEX   261>>IF        263>>ASSIGN    264>>ASSIGN    267>>ASSIGN    270>>ASSIGN
       273>>IF        274>>ASSIGN
MAINLOOP
       259**LABEL     249--GOTO      252--GOTO      255--GOTO
NC
       241**DCL       259<<ASSIGN    260>>DOINDEX

PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:437  
     2298        1        /*T***********************************************************/
     2299        2        /*T*                                                         */
     2300        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2301        4        /*T*                                                         */
     2302        5        /*T***********************************************************/
     2303        6                    /*F*
     2304        7                    *     NAME:   FMO$GETDOMAIN
     2305        8                    *     PURPOSE:  TO GET THE WSR NUMBER FROM THE SAFE STORE FRAME
     2306        9                    *               WHICH EXECUTED THIS PMME CLIMB.
     2307       10                    */
     2308       11        FMO$GETDOMAIN: PROC(WSR);
     2309       12                    /**/
     2310       13        %MACRO B$ROSEG (BASED="BASED(B$ROSEG$)");
     2311       14        %INCLUDE B$ROSEG;
     2312       77        %MEND;
     2313       78        %B$ROSEG;
     2314      138    1   DCL B$ROSEG$ PTR SYMREF READONLY;
     2315      139        %INCLUDE B$SS;
     2316      318        %INCLUDE B_MAGIC_C;
     2317      436        %B_MPT (FPTN=B_MPT,STCLASS=SYMREF);
     2318      529        %INCLUDE B_STRINGS_C;
     2319      658        %INCLUDE KI_SUBS_C;
     2320      794        %INCLUDE M_INFO_C;
     2321      934        %INCLUDE B_MACROS_C;
     2322     1045        %T01DESCR (NAME=DSC);
     2323     1053    1   DCL B$USERHJIT$ PTR SYMREF READONLY;
     2324     1054        %LIST;
     2325     1055                    /**/
     2326     1056                    /* PARAMETER DATA */
     2327     1057    1   DCL WSR SBIN; /* WORKING SPACE QUARTER */
     2328     1058                    /**/
     2329     1059                    /**/
     2330     1060                    /* AUTO VARIABLE(S) */
     2331     1061                    /**/
     2332     1062    1   DCL OFS SBIN;
     2333     1063
     2334     1064    1      WSR=B_MPT.SS$->B$SS.ISR.WSR;
PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:438  
     2335     1065    1      RETURN;
     2336     1066                    /**/
     2337     1067    1   FMO$GETPFB: ENTRY (WSR);
     2338     1068                    /**/
     2339     1069                    /*F*
     2340     1070                    *     NAME:   FMO$GETPFB
     2341     1071                    *     PURPOSE: GETS THE WSR NUMBER OF THE SAFE STORE FRAME WHICH
     2342     1072                    *              EXECUTED THIS PMME AND CONVERTS IT TO FEP DOMAIN
     2343     1073                    *              INDEX FORMAT (PAUL'S FUNNY BYTE).
     2344     1074                    */
     2345     1075    1      OFS=B_MPT.SSDESC$->DSC.BASE/4-%HJITPG*1024;
     2346     1076    1   NXTFRAME:;
     2347     1077    1      WSR=PINCRW(B$USERHJIT$,OFS)->B$SS.ISR.WSR;
     2348     1078    1      IF WSR=%CPWSR THEN WSR=KIDM_CP;
     2349     1079    1      ELSE IF WSR=%DBWSR THEN WSR=KIDM_DB;
     2350     1080    1         ELSE IF WSR=%USERWSR THEN WSR=KIDM_USER;
     2351     1081    2            ELSE DO;
     2352     1082                    /* Must be a monitor PMME, find the one that invoked it. */
     2353     1083    3               DO SELECT PINCRW(B$USERHJIT$,OFS)->B$SS.SCR;
     2354     1084    3                  SELECT '00'B;
     2355     1085    3                  OFS=OFS-16;
     2356     1086    3                  SELECT '01'B;
     2357     1087    3                  OFS=OFS-24;
     2358     1088    3                  SELECT ELSE;
     2359     1089    3               OFS=OFS-64;
     2360     1090    3                  END;
     2361     1091    2            GOTO NXTFRAME;
     2362     1092    2               END;
     2363     1093    1      IF NOT B$ROSEG.STREAM_VALID(WSR) THEN WSR=KIDM_CP;
     2364     1094    1      RETURN;
     2365     1095                    /**/
     2366     1096    1   END FMO$GETDOMAIN;
     2367     1097        %EOD;

PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:439  
--  Include file information  --

   B_MACROS_C.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_MAGIC_C.:E05TOU  is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
   B$ROSEG.:E05TOU  is referenced.
      No diagnostics issued in procedure FMO$GETDOMAIN.

   Procedure FMO$GETDOMAIN requires 67 words for executable code.
   Procedure FMO$GETDOMAIN requires 6 words of local(AUTO) storage.

PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:440  

 Object Unit name= FMO$GETDOMAIN                              File name= FMO$OBSE.:E05TOU
 UTS= JUL 29 '97 16:57:54.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    67    103  FMO$GETDOMAIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  FMO$GETDOMAIN
     0     11                  yes      Std        1  FMO$GETPFB

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    B$ROSEG$                              B_MPT                            r    B$USERHJIT$
     B_VECTNIL
PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:441  


     2298        1        /*T***********************************************************/
     2299        2        /*T*                                                         */
     2300        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2301        4        /*T*                                                         */
     2302        5        /*T***********************************************************/
     2303        6                    /*F*
     2304        7                    *     NAME:   FMO$GETDOMAIN
     2305        8                    *     PURPOSE:  TO GET THE WSR NUMBER FROM THE SAFE STORE FRAME
     2306        9                    *               WHICH EXECUTED THIS PMME CLIMB.
     2307       10                    */
     2308       11        FMO$GETDOMAIN: PROC(WSR);

     11  0 000000   000000 700200 xent  FMO$GETDOMA* TSX0  ! X66_AUTO_1
         0 000001   000006 000001                    ZERO    6,1

     2309       12                    /**/
     2310       13        %MACRO B$ROSEG (BASED="BASED(B$ROSEG$)");
     2311       14        %INCLUDE B$ROSEG;
     2312       77        %MEND;
     2313       78        %B$ROSEG;
     2314      138    1   DCL B$ROSEG$ PTR SYMREF READONLY;
     2315      139        %INCLUDE B$SS;
     2316      318        %INCLUDE B_MAGIC_C;
     2317      436        %B_MPT (FPTN=B_MPT,STCLASS=SYMREF);
     2318      529        %INCLUDE B_STRINGS_C;
     2319      658        %INCLUDE KI_SUBS_C;
     2320      794        %INCLUDE M_INFO_C;
     2321      934        %INCLUDE B_MACROS_C;
     2322     1045        %T01DESCR (NAME=DSC);
     2323     1053    1   DCL B$USERHJIT$ PTR SYMREF READONLY;
     2324     1054        %LIST;
     2325     1055                    /**/
     2326     1056                    /* PARAMETER DATA */
     2327     1057    1   DCL WSR SBIN; /* WORKING SPACE QUARTER */
     2328     1058                    /**/
     2329     1059                    /**/
PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:442  
     2330     1060                    /* AUTO VARIABLE(S) */
     2331     1061                    /**/
     2332     1062    1   DCL OFS SBIN;
     2333     1063
     2334     1064    1      WSR=B_MPT.SS$->B$SS.ISR.WSR;

   1064  0 000002   000000 470400 xsym               LDP0    B_MPT
         0 000003   000010 236100                    LDQ     8,,PR0
         0 000004   000004 772000                    QRL     4
         0 000005   000007 376007                    ANQ     7,DL
         0 000006   200003 471500                    LDP1    @WSR,,AUTO
         0 000007   100000 756100                    STQ     0,,PR1

     2335     1065    1      RETURN;

   1065  0 000010   000000 702200 xent               TSX2  ! X66_ARET

     2336     1066                    /**/
     2337     1067    1   FMO$GETPFB: ENTRY (WSR);

   1067  0 000011   000000 700200 xent  FMO$GETPFB   TSX0  ! X66_AUTO_1
         0 000012   000006 000001                    ZERO    6,1

     2338     1068                    /**/
     2339     1069                    /*F*
     2340     1070                    *     NAME:   FMO$GETPFB
     2341     1071                    *     PURPOSE: GETS THE WSR NUMBER OF THE SAFE STORE FRAME WHICH
     2342     1072                    *              EXECUTED THIS PMME AND CONVERTS IT TO FEP DOMAIN
     2343     1073                    *              INDEX FORMAT (PAUL'S FUNNY BYTE).
     2344     1074                    */
     2345     1075    1      OFS=B_MPT.SSDESC$->DSC.BASE/4-%HJITPG*1024;

   1075  0 000013   000006 470400 xsym               LDP0    B_MPT+6
         0 000014   000001 236100                    LDQ     1,,PR0
         0 000015   000004 506007                    DIV     4,DL
         0 000016   032000 136007                    SBLQ    13312,DL
         0 000017   200004 756100                    STQ     OFS,,AUTO
PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:443  

   1075  0 000020                       NXTFRAME     null
     2346     1076    1   NXTFRAME:;
     2347     1077    1      WSR=PINCRW(B$USERHJIT$,OFS)->B$SS.ISR.WSR;

   1077  0 000020   000000 470400 xsym               LDP0    B$USERHJIT$
         0 000021   200004 720100                    LXL0    OFS,,AUTO
         0 000022   000010 236110                    LDQ     8,X0,PR0
         0 000023   000004 772000                    QRL     4
         0 000024   000007 376007                    ANQ     7,DL
         0 000025   200003 471500                    LDP1    @WSR,,AUTO
         0 000026   100000 756100                    STQ     0,,PR1

     2348     1078    1      IF WSR=%CPWSR THEN WSR=KIDM_CP;

   1078  0 000027   000004 116007                    CMPQ    4,DL
         0 000030   000034 601000 0                  TNZ     s:1079

   1078  0 000031   000001 235007                    LDA     1,DL
         0 000032   100000 755100                    STA     0,,PR1
         0 000033   000071 710000 0                  TRA     s:1093

     2349     1079    1      ELSE IF WSR=%DBWSR THEN WSR=KIDM_DB;

   1079  0 000034   000005 116007                    CMPQ    5,DL
         0 000035   000041 601000 0                  TNZ     s:1080

   1079  0 000036   000003 235007                    LDA     3,DL
         0 000037   100000 755100                    STA     0,,PR1
         0 000040   000071 710000 0                  TRA     s:1093

     2350     1080    1         ELSE IF WSR=%USERWSR THEN WSR=KIDM_USER;

   1080  0 000041   000007 116007                    CMPQ    7,DL
         0 000042   000046 601000 0                  TNZ     s:1083

   1080  0 000043   000002 235007                    LDA     2,DL
PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:444  
         0 000044   100000 755100                    STA     0,,PR1
         0 000045   000071 710000 0                  TRA     s:1093

     2351     1081    2            ELSE DO;

     2352     1082                    /* Must be a monitor PMME, find the one that invoked it. */
     2353     1083    3               DO SELECT PINCRW(B$USERHJIT$,OFS)->B$SS.SCR;

   1083  0 000046   000005 236110                    LDQ     5,X0,PR0
         0 000047   030000 376007                    ANQ     12288,DL
         0 000050   000000 116003                    CMPQ    0,DU
         0 000051   000060 602000 0                  TNC     s:1085
         0 000052   000060 600000 0                  TZE     s:1085
         0 000053   000005 236110                    LDQ     5,X0,PR0
         0 000054   030000 376007                    ANQ     12288,DL
         0 000055   010000 116007                    CMPQ    4096,DL
         0 000056   000066 601000 0                  TNZ     s:1089
         0 000057   000063 710000 0                  TRA     s:1087

     2354     1084    3                  SELECT '00'B;

     2355     1085    3                  OFS=OFS-16;

   1085  0 000060   000020 336007                    LCQ     16,DL
         0 000061   200004 056100                    ASQ     OFS,,AUTO
         0 000062   000070 710000 0                  TRA     s:1091

     2356     1086    3                  SELECT '01'B;

     2357     1087    3                  OFS=OFS-24;

   1087  0 000063   000030 336007                    LCQ     24,DL
         0 000064   200004 056100                    ASQ     OFS,,AUTO
         0 000065   000070 710000 0                  TRA     s:1091

     2358     1088    3                  SELECT ELSE;

PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:445  
     2359     1089    3               OFS=OFS-64;

   1089  0 000066   000100 336007                    LCQ     64,DL
         0 000067   200004 056100                    ASQ     OFS,,AUTO

     2360     1090    3                  END;

     2361     1091    2            GOTO NXTFRAME;

   1091  0 000070   000020 710000 0                  TRA     NXTFRAME

     2362     1092    2               END;
     2363     1093    1      IF NOT B$ROSEG.STREAM_VALID(WSR) THEN WSR=KIDM_CP;

   1093  0 000071   000073 605000 0                  TPL     s:1093+2
         0 000072   000044 035003                    ADLA    36,DU
         0 000073   000000 473400 xsym               LDP3    B$ROSEG$
         0 000074   000000 066505                    CMPB    filb='0'B
         0 000075   300117 000001                    BDSC    79,A,PR3                 by=0,bit=0,n=1
         0 000076   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         0 000077   000102 601000 0                  TNZ     s:1094

   1093  0 000100   000001 235007                    LDA     1,DL
         0 000101   100000 755100                    STA     0,,PR1

     2364     1094    1      RETURN;

   1094  0 000102   000000 702200 xent               TSX2  ! X66_ARET
     2365     1095                    /**/
     2366     1096    1   END FMO$GETDOMAIN;
     2367     1097        %EOD;

PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:446  
--  Include file information  --

   B_MACROS_C.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_MAGIC_C.:E05TOU  is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
   B$ROSEG.:E05TOU  is referenced.
      No diagnostics issued in procedure FMO$GETDOMAIN.
PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:447  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @WSR                       4-0-0/w SBIN        r     1 OFS
    *0-0-0/w SBIN        r     1 WSR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$ROSEG$                   0-0-0/w PTR         r     1 B$USERHJIT$
     0-0-0/d STRC(432)   r     1 B_MPT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(3024)  r     1 B$ROSEG                    0-0-0/d STRC(2304)  r     1 B$SS
     0-0-0/w STRC(72)    r     1 DSC


   Procedure FMO$GETDOMAIN requires 67 words for executable code.
   Procedure FMO$GETDOMAIN requires 6 words of local(AUTO) storage.
PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:448  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:449  
          MINI XREF LISTING

B$ROSEG.STREAM_VALID
       120**DCL      1093>>IF
B$ROSEG$
       138**DCL        87--IMP-PTR   123--IMP-PTR   125--IMP-PTR  1093>>IF
B$SS.ISR.WSR
       196**DCL      1064>>ASSIGN   1077>>ASSIGN
B$SS.RVA
       191**DCL       192--REDEF
B$SS.SCR
       183**DCL      1083>>DOSELCT
B$USERHJIT$
      1053**DCL      1077>>ASSIGN   1083>>DOSELCT
B_MPT.AS
       472**DCL       475--REDEF
B_MPT.ASDESC
       504**DCL       508--REDEF
B_MPT.ECCB
       487**DCL       490--REDEF
B_MPT.ECCBDESC
       522**DCL       526--REDEF
B_MPT.LS
       467**DCL       470--REDEF
B_MPT.LSDESC
       498**DCL       502--REDEF
B_MPT.PS
       477**DCL       480--REDEF
B_MPT.PSDESC
       510**DCL       514--REDEF
B_MPT.SS
       462**DCL       465--REDEF
B_MPT.SS$
       465**DCL      1064>>ASSIGN
PL6.E3A0      #003=FMO$GETDOMAIN File=FMO$OBSE.:E05TSI                           TUE 07/29/97 16:57 Page:450  
B_MPT.SSDESC
       492**DCL       496--REDEF
B_MPT.SSDESC$
       496**DCL      1075>>ASSIGN
B_MPT.TCB
       482**DCL       485--REDEF
B_MPT.TCBDESC
       516**DCL       520--REDEF
DSC.BASE
      1051**DCL      1075>>ASSIGN
NXTFRAME
      1075**LABEL    1091--GOTO
OFS
      1062**DCL      1075<<ASSIGN   1077>>ASSIGN   1083>>DOSELCT  1085<<ASSIGN   1085>>ASSIGN   1087<<ASSIGN
      1087>>ASSIGN   1089<<ASSIGN   1089>>ASSIGN
WSR
      1057**DCL        11--PROC     1064<<ASSIGN   1067--ENTRY    1077<<ASSIGN   1078>>IF       1078<<ASSIGN
      1079>>IF       1079<<ASSIGN   1080>>IF       1080<<ASSIGN   1093>>IF       1093<<ASSIGN

PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:451  
     2368        1        /*T***********************************************************/
     2369        2        /*T*                                                         */
     2370        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2371        4        /*T*                                                         */
     2372        5        /*T***********************************************************/
     2373        6                    /*F*
     2374        7                    *     NAME:             FMO$TRNINFO
     2375        8                    *
     2376        9                    *     PURPOSE:          THIS ROUTINE MOVES THE FIT INFORMATION
     2377       10                    *                       TO THE USER SPECIFIED FPARAM BUFFER.
     2378       11                    *
     2379       12                    */
     2380       13                    /*D*
     2381       14                    *     NAME:             FMO$TRNINFO
     2382       15                    *     CALL:             CALL FMO$TRNINFO(FPARAM$,FIT$)  ALTRET(ADDR);
     2383       16                    *
     2384       17                    *                       THE FIT MUST HAVE BEEN READ INTO
     2385       18                    *                       A BUFFER  BEFORE THIS ROUTINE
     2386       19                    *                       IS CALLED.
     2387       20                    *
     2388       21                    *     DESCRIPTION:      FOR A NORMAL OPEN WITH FPARAMS, ONLY
     2389       22                    *                       FIT CODES 2 THROUGH 31 ARE MOVED TO THE
     2390       23                    *                       FPARAM BUFFER.  FOR A BLOCKED ACCESS
     2391       24                    *                       OPEN WITH FPARAMS, THE ENTIRE FIT (OR AFIT)
     2392       25                    *                       GRANULE IS MOVED TO THE FPARAM BUFFR.
     2393       26                    */
     2394       27        FMO$TRNINFO: PROC(FPARAM$,FIT$)  ALTRET;
     2395       28                    /**/
     2396       29                    /* PARAMETER DATA */
     2397       30                    /**/
     2398       31    1   DCL FPARAM$ PTR; /* FPARAM BUFFER ADDRESS */
     2399       32    1   DCL FIT$ PTR; /* POINTER TO FIT */
     2400       33                    /**/
     2401       34                    /* SYMREF DATA */
     2402       35    1   DCL B$JIT$ PTR SYMREF; /* POINTER TO JIT */
     2403       36                    /**/
     2404       37                    /* DEFINE EXTERNAL ROUTINES */
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:452  
     2405       38                    /**/
     2406       39    1   DCL FMO$LOCCODP ENTRY(2)ALTRET;
     2407       40    1   DCL HFF$DSIZ ENTRY(2); /* GET BYTE SIZE FROM DESCRIPTOR */
     2408       41                    /**/
     2409       42                    /* AUTOMATIC DATA */
     2410       43                    /**/
     2411       44    1   DCL JDCB$ PTR; /* CURRENT DCB ADDRESS */
     2412       45    1   DCL LOC$ PTR; /* POINTER TO FIT DATA ITEM */
     2413       46    1   DCL BUF$ PTR; /* SCRATCH POINTER */
     2414       47    1   DCL NDW SBIN; /* ITEM SIZE */
     2415       48    1   DCL ITEMX SBIN; /* ITEM OFFSET */
     2416       49    1   DCL I UBIN;
     2417       50    1   DCL J UBIN;
     2418       51    1   DCL REC CHAR(NDW) BASED; /* FORM FOR MOVING FIT ITEMS */
     2419       52    1   DCL AVAIL SBIN; /* NO BYTES LEFT IN FPARAM BUF */
     2420       53                    /**/
     2421       54        %INCLUDE F$JIT_C;
     2422      484        %MACRO F$DCB(BASED=BASED);
     2423      485        %INCLUDE F$DCB;
     2424      534        %MEND;
     2425      535        %F$DCB(BASED="BASED(JDCB$)");
     2426      585        %INCLUDE F_CP6;
     2427     1610        %FPT_OPEN(PFMT=PTR,STCLASS="BASED(BUF$)",FPTN=PN$);
     2428     1719        %INCLUDE FM$MACROS;
     2429     2094        %FM$CFU;
     2430     2100        %FM$FIT;
     2431     2103        %CODE04(BASED="BASED(LOC$)");
     2432     2111        %CODE14(BASED="BASED(LOC$)");
     2433     2121        %FM$GRAN;
     2434     2125        %INCLUDE CP_6_SUBS;
     2435     2665        %INCLUDE F_ERRORS_C;
     2436     2905        %SUB FCG#='0615'O;
     2437     2906        %SUB MID#='17'O;
     2438     2907        %ERRCODE(NAME=FMO$E$FPARAM,COD#=%E$FPARAM);
     2439     2911        %ERRCODE(NAME=FMO$E$BADFIT,COD#=%E$BADFIT);
     2440     2915                    /**/
     2441     2916    1      JDCB$=B$JIT$->B$JIT.DCB$;
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:453  
     2442     2917    1      CALL HFF$DSIZ(POFFW(ADDR(PN$.FPARAM_),ADDR(PN$.V_)),AVAIL);
     2443     2918                    /*
     2444     2919                    *  FOR BLOCK ACCESS, THE ENTIRE FIT/AFIT GRANULE IS
     2445     2920                    *  MOVED TO THE FPARAM BUFFER.
     2446     2921                    */
     2447     2922    1      IF F$DCB.ACS=%BLOCK#
     2448     2923    2      THEN DO;
     2449     2924    2         IF AVAIL < 4095 THEN GOTO FMOE$FPARAM;
     2450     2925    2         BUF$=PINCRW(FIT$,-SIZEW(FM$GRAN));
     2451     2926    2         NDW=4096;
     2452     2927    2         FPARAM$->REC=BUF$->REC;
     2453     2928    2         IF B$JIT.PRIV.ACTIVE.FMSEC THEN RETURN;
     2454     2929    2         LOC$=PINCRW(FPARAM$,SIZEW(FM$GRAN));
     2455     2930    2         CALL FMO$LOCCODP(LOC$,4)ALTRET(NONAME);/*ZAP NAME IF NOT PRIVILEGED*/
     2456     2931    2         IF POFFW(LOC$,FPARAM$)+SIZEW(CODE04)>1024 THEN GOTO FMOE$BADFIT;
     2457     2932    2         CODE04.CREATOR.NAME=' ';
     2458     2933    2         CODE04.CREATOR.ACCT=' ';
     2459     2934    2   NONAME:;
     2460     2935    2         RETURN;
     2461     2936    2         END;
     2462     2937                    /*
     2463     2938                    *  FOR NORMAL FPARAM REQUESTS, CODES 02 THROUGH 31 ARE
     2464     2939                    *  MOVED TO THE FPARAM BUFFER IN FIT FORMAT.
     2465     2940                    */
     2466     2941    1      IF AVAIL<SIZEC(FIT$->FM$FIT) THEN RETURN;
     2467     2942                    /*
     2468     2943                    *  SPECIAL CASE FOR SMALL FPARAM BUFFER GIVES USER NO FPARAMS
     2469     2944                    */
     2470     2945    1      FPARAM$->FM$FIT='0'B;
     2471     2946    1      ITEMX=FIT$->FM$FIT.CODES.CODE(0)+1;
     2472     2947    1      J=0;
     2473     2948    2      DO I=1 TO FIT$->FM$FIT.CODES.CODE(0);
     2474     2949    2         NDW=FIT$->FM$FIT.CODES.NDW(I);
     2475     2950    3         IF NOT B$JIT.PRIV.ACTIVE.FMSEC AND NDW~=0 THEN DO;
     2476     2951    3            IF FIT$->FM$FIT.CODES.CODE(I)=4
     2477     2952    3            THEN NDW=POFFW(ADDR(CODE04.CREATOR),ADDR(CODE04));
     2478     2953    3            IF FIT$->FM$FIT.CODES.CODE(I)=14
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:454  
     2479     2954    3            THEN NDW=POFFW(ADDR(CODE14.OWNER),ADDR(CODE14));
     2480     2955    3            END;
     2481     2956    2         IF FIT$->FM$FIT.CODES.CODE(I)~=1 AND
     2482     2957    3           (NDW~=0 OR B$JIT.PRIV.ACTIVE.FMEFT) THEN DO;
     2483     2958    3            J=J+1;
     2484     2959    3            FPARAM$->FM$FIT.CODES(J)=FIT$->FM$FIT.CODES(I);
     2485     2960    3            FPARAM$->FM$FIT.CODES.NDW(J)=NDW;
     2486     2961    3            FPARAM$->FM$FIT.CODES.ITEMX(J)=ITEMX;
     2487     2962                    /*
     2488     2963                    *  NOW THAT THE FIT HEADER CODE IS BUILT, MOVE THE FIT ITEM
     2489     2964                    *  TO THE FPARAM BUFFER.
     2490     2965                    */
     2491     2966    3            LOC$=PINCRW(FIT$,FIT$->FM$FIT.CODES.ITEMX(I));
     2492     2967    3            BUF$=PINCRW(FPARAM$,ITEMX);
     2493     2968    3            IF POFFW(LOC$,FIT$)+NDW+SIZEW(FM$GRAN)>1024
     2494     2969    3            THEN GOTO FMOE$BADFIT;
     2495     2970    3            ITEMX=ITEMX+NDW;
     2496     2971    3            NDW=NDW*4;
     2497     2972    3            IF ITEMX*4>AVAIL THEN GOTO FMOE$FPARAM;
     2498     2973    3            BUF$->REC=LOC$->REC;
     2499     2974    4            IF FIT$->FM$FIT.CODES.CODE(I)=4 AND LOC$->CODE04.SVMODIFY THEN DO;
     2500     2975    4               IF F$DCB.ASN=%TAPE# OR F$DCB.CFU$=ADDR(NIL) THEN EXIT;
     2501     2976    4               IF F$DCB.CFU$->FM$CFU.FMOD THEN EXIT;
     2502     2977    4               BUF$->CODE04.MODIFY=LOC$->CODE04.SVMODIFY;
     2503     2978    4               END;
     2504     2979    3            END;
     2505     2980    2   NXTCODE:
     2506     2981    2         END;
     2507     2982                    /*
     2508     2983                    *  FINALLY FILL IN THE ZERO FIT ENTRY TO DEFINE HOW MANY ITEMS
     2509     2984                    *  ARE DESCRIBED IN THE FPARAM.
     2510     2985                    */
     2511     2986    1      FPARAM$->FM$FIT.CODES.NAW(0)=FIT$->FM$FIT.CODES.NDW(0);
     2512     2987    1      FPARAM$->FM$FIT.CODES.NDW(0)=ITEMX;
     2513     2988    1      FPARAM$->FM$FIT.CODES.CODE(0)=J;
     2514     2989    1      RETURN;
     2515     2990                    /**/
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:455  
     2516     2991                    /*E*     ERROR: FMO-E$FPARAM-E
     2517     2992                    *        MESSAGE:FPARAM area too small% for %UF%
     2518     2993                    */
     2519     2994    1   FMOE$FPARAM: B$JIT$->B$JIT.ERR=FMO$E$FPARAM;
     2520     2995    1      ALTRETURN;
     2521     2996    1   FMOE$BADFIT: B$JIT.ERR=FMO$E$BADFIT;
     2522     2997    1      ALTRETURN;
     2523     2998    1   END FMO$TRNINFO;
     2524     2999        %EOD;

PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:456  
--  Include file information  --

   F_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FMO$TRNINFO.

   Procedure FMO$TRNINFO requires 255 words for executable code.
   Procedure FMO$TRNINFO requires 18 words of local(AUTO) storage.

PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:457  

 Object Unit name= FMO$TRNINFO                                File name= FMO$OBSE.:E05TOU
 UTS= JUL 29 '97 16:58:02.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      2      2  FMO$TRNINFO
    1   Proc  even  none   255    377  FMO$TRNINFO
    2  RoData even  none     2      2  FMO$TRNINFO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  FMO$TRNINFO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 HFF$DSIZ
 yes     yes           Std       2 FMO$LOCCODP
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                B_VECTNIL
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:458  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:459  


     2368        1        /*T***********************************************************/
     2369        2        /*T*                                                         */
     2370        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2371        4        /*T*                                                         */
     2372        5        /*T***********************************************************/
     2373        6                    /*F*
     2374        7                    *     NAME:             FMO$TRNINFO
     2375        8                    *
     2376        9                    *     PURPOSE:          THIS ROUTINE MOVES THE FIT INFORMATION
     2377       10                    *                       TO THE USER SPECIFIED FPARAM BUFFER.
     2378       11                    *
     2379       12                    */
     2380       13                    /*D*
     2381       14                    *     NAME:             FMO$TRNINFO
     2382       15                    *     CALL:             CALL FMO$TRNINFO(FPARAM$,FIT$)  ALTRET(ADDR);
     2383       16                    *
     2384       17                    *                       THE FIT MUST HAVE BEEN READ INTO
     2385       18                    *                       A BUFFER  BEFORE THIS ROUTINE
     2386       19                    *                       IS CALLED.
     2387       20                    *
     2388       21                    *     DESCRIPTION:      FOR A NORMAL OPEN WITH FPARAMS, ONLY
     2389       22                    *                       FIT CODES 2 THROUGH 31 ARE MOVED TO THE
     2390       23                    *                       FPARAM BUFFER.  FOR A BLOCKED ACCESS
     2391       24                    *                       OPEN WITH FPARAMS, THE ENTIRE FIT (OR AFIT)
     2392       25                    *                       GRANULE IS MOVED TO THE FPARAM BUFFR.
     2393       26                    */
     2394       27        FMO$TRNINFO: PROC(FPARAM$,FIT$)  ALTRET;

     27  1 000000   000000 700200 xent  FMO$TRNINFO  TSX0  ! X66_AUTO_2
         1 000001   000022 000002                    ZERO    18,2

     2395       28                    /**/
     2396       29                    /* PARAMETER DATA */
     2397       30                    /**/
     2398       31    1   DCL FPARAM$ PTR; /* FPARAM BUFFER ADDRESS */
     2399       32    1   DCL FIT$ PTR; /* POINTER TO FIT */
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:460  
     2400       33                    /**/
     2401       34                    /* SYMREF DATA */
     2402       35    1   DCL B$JIT$ PTR SYMREF; /* POINTER TO JIT */
     2403       36                    /**/
     2404       37                    /* DEFINE EXTERNAL ROUTINES */
     2405       38                    /**/
     2406       39    1   DCL FMO$LOCCODP ENTRY(2)ALTRET;
     2407       40    1   DCL HFF$DSIZ ENTRY(2); /* GET BYTE SIZE FROM DESCRIPTOR */
     2408       41                    /**/
     2409       42                    /* AUTOMATIC DATA */
     2410       43                    /**/
     2411       44    1   DCL JDCB$ PTR; /* CURRENT DCB ADDRESS */
     2412       45    1   DCL LOC$ PTR; /* POINTER TO FIT DATA ITEM */
     2413       46    1   DCL BUF$ PTR; /* SCRATCH POINTER */
     2414       47    1   DCL NDW SBIN; /* ITEM SIZE */
     2415       48    1   DCL ITEMX SBIN; /* ITEM OFFSET */
     2416       49    1   DCL I UBIN;
     2417       50    1   DCL J UBIN;
     2418       51    1   DCL REC CHAR(NDW) BASED; /* FORM FOR MOVING FIT ITEMS */
     2419       52    1   DCL AVAIL SBIN; /* NO BYTES LEFT IN FPARAM BUF */
     2420       53                    /**/
     2421       54        %INCLUDE F$JIT_C;
     2422      484        %MACRO F$DCB(BASED=BASED);
     2423      485        %INCLUDE F$DCB;
     2424      534        %MEND;
     2425      535        %F$DCB(BASED="BASED(JDCB$)");
     2426      585        %INCLUDE F_CP6;
     2427     1610        %FPT_OPEN(PFMT=PTR,STCLASS="BASED(BUF$)",FPTN=PN$);
     2428     1719        %INCLUDE FM$MACROS;
     2429     2094        %FM$CFU;
     2430     2100        %FM$FIT;
     2431     2103        %CODE04(BASED="BASED(LOC$)");
     2432     2111        %CODE14(BASED="BASED(LOC$)");
     2433     2121        %FM$GRAN;
     2434     2125        %INCLUDE CP_6_SUBS;
     2435     2665        %INCLUDE F_ERRORS_C;
     2436     2905        %SUB FCG#='0615'O;
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:461  
     2437     2906        %SUB MID#='17'O;
     2438     2907        %ERRCODE(NAME=FMO$E$FPARAM,COD#=%E$FPARAM);
     2439     2911        %ERRCODE(NAME=FMO$E$BADFIT,COD#=%E$BADFIT);
     2440     2915                    /**/
     2441     2916    1      JDCB$=B$JIT$->B$JIT.DCB$;

   2916  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   000232 236100                    LDQ     154,,PR0
         1 000004   200005 756100                    STQ     JDCB$,,AUTO

     2442     2917    1      CALL HFF$DSIZ(POFFW(ADDR(PN$.FPARAM_),ADDR(PN$.V_)),AVAIL);

   2917  1 000005   200007 236100                    LDQ     BUF$,,AUTO
         1 000006   000022 772000                    QRL     18
         1 000007   200016 756100                    STQ     AVAIL+2,,AUTO
         1 000010   200007 236100                    LDQ     BUF$,,AUTO
         1 000011   000014 036003                    ADLQ    12,DU
         1 000012   000022 772000                    QRL     18
         1 000013   200016 136100                    SBLQ    AVAIL+2,,AUTO
         1 000014   200017 756100                    STQ     AVAIL+3,,AUTO
         1 000015   200014 631500                    EPPR1   AVAIL,,AUTO
         1 000016   200021 451500                    STP1    AVAIL+5,,AUTO
         1 000017   200017 633500                    EPPR3   AVAIL+3,,AUTO
         1 000020   200020 453500                    STP3    AVAIL+4,,AUTO
         1 000021   200020 630500                    EPPR0   AVAIL+4,,AUTO
         1 000022   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000023   000000 701000 xent               TSX1    HFF$DSIZ
         1 000024   000000 011000                    NOP     0

     2443     2918                    /*
     2444     2919                    *  FOR BLOCK ACCESS, THE ENTIRE FIT/AFIT GRANULE IS
     2445     2920                    *  MOVED TO THE FPARAM BUFFER.
     2446     2921                    */
     2447     2922    1      IF F$DCB.ACS=%BLOCK#

   2922  1 000025   200005 470500                    LDP0    JDCB$,,AUTO
         1 000026   000036 236100                    LDQ     30,,PR0
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:462  
         1 000027   000777 376007                    ANQ     511,DL
         1 000030   000003 116007                    CMPQ    3,DL
         1 000031   000116 601000 1                  TNZ     s:2941

     2448     2923    2      THEN DO;

     2449     2924    2         IF AVAIL < 4095 THEN GOTO FMOE$FPARAM;

   2924  1 000032   200014 235100                    LDA     AVAIL,,AUTO
         1 000033   007777 115007                    CMPA    4095,DL
         1 000034   000367 604000 1                  TMI     FMOE$FPARAM

     2450     2925    2         BUF$=PINCRW(FIT$,-SIZEW(FM$GRAN));

   2925  1 000035   200004 471500                    LDP1    @FIT$,,AUTO
         1 000036   100000 236100                    LDQ     0,,PR1
         1 000037   777773 036003                    ADLQ    -5,DU
         1 000040   200007 756100                    STQ     BUF$,,AUTO

     2451     2926    2         NDW=4096;

   2926  1 000041   010000 235007                    LDA     4096,DL
         1 000042   200010 755100                    STA     NDW,,AUTO

     2452     2927    2         FPARAM$->REC=BUF$->REC;

   2927  1 000043   200003 473500                    LDP3    @FPARAM$,,AUTO
         1 000044   300000 474500                    LDP4    0,,PR3
         1 000045   200007 475500                    LDP5    BUF$,,AUTO
         1 000046   000000 620005                    EAX0    0,AL
         1 000047   200010 721100                    LXL1    NDW,,AUTO
         1 000050   040140 100540                    MLR     fill='040'O
         1 000051   500000 000010                    ADSC9   0,,PR5                   cn=0,n=*X0
         1 000052   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1

     2453     2928    2         IF B$JIT.PRIV.ACTIVE.FMSEC THEN RETURN;

PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:463  
   2928  1 000053   000000 474400 xsym               LDP4    B$JIT$
         1 000054   400013 236100                    LDQ     11,,PR4
         1 000055   100000 316003                    CANQ    32768,DU
         1 000056   000060 600000 1                  TZE     s:2929

   2928  1 000057   000000 702200 xent               TSX2  ! X66_ARET

     2454     2929    2         LOC$=PINCRW(FPARAM$,SIZEW(FM$GRAN));

   2929  1 000060   300000 236100                    LDQ     0,,PR3
         1 000061   000005 036003                    ADLQ    5,DU
         1 000062   200006 756100                    STQ     LOC$,,AUTO

     2455     2930    2         CALL FMO$LOCCODP(LOC$,4)ALTRET(NONAME);/*ZAP NAME IF NOT PRIVILEGED*/

   2930  1 000063   000000 236000 2                  LDQ     0
         1 000064   200017 756100                    STQ     AVAIL+3,,AUTO
         1 000065   200006 636500                    EPPR6   LOC$,,AUTO
         1 000066   200016 456500                    STP6    AVAIL+2,,AUTO
         1 000067   200016 630500                    EPPR0   AVAIL+2,,AUTO
         1 000070   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000071   000000 701000 xent               TSX1    FMO$LOCCODP
         1 000072   000115 702000 1                  TSX2    NONAME

     2456     2931    2         IF POFFW(LOC$,FPARAM$)+SIZEW(CODE04)>1024 THEN GOTO FMOE$BADFIT;

   2931  1 000073   200003 470500                    LDP0    @FPARAM$,,AUTO
         1 000074   000000 236100                    LDQ     0,,PR0
         1 000075   000022 772000                    QRL     18
         1 000076   200016 756100                    STQ     AVAIL+2,,AUTO
         1 000077   200006 236100                    LDQ     LOC$,,AUTO
         1 000100   000022 772000                    QRL     18
         1 000101   200016 136100                    SBLQ    AVAIL+2,,AUTO
         1 000102   001765 116007                    CMPQ    1013,DL
         1 000103   000373 605400 1                  TPNZ    FMOE$BADFIT

     2457     2932    2         CODE04.CREATOR.NAME=' ';
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:464  

   2932  1 000104   200006 471500                    LDP1    LOC$,,AUTO
         1 000105   040100 100400                    MLR     fill='040'O
         1 000106   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000107   100005 000014                    ADSC9   5,,PR1                   cn=0,n=12

     2458     2933    2         CODE04.CREATOR.ACCT=' ';

   2933  1 000110   200006 471500                    LDP1    LOC$,,AUTO
         1 000111   000035 235000 xsym               LDA     B_VECTNIL+29
         1 000112   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 000113   100003 755100                    STA     3,,PR1
         1 000114   100004 756100                    STQ     4,,PR1

   2933  1 000115                       NONAME       null
     2459     2934    2   NONAME:;
     2460     2935    2         RETURN;

   2935  1 000115   000000 702200 xent               TSX2  ! X66_ARET

     2461     2936    2         END;
     2462     2937                    /*
     2463     2938                    *  FOR NORMAL FPARAM REQUESTS, CODES 02 THROUGH 31 ARE
     2464     2939                    *  MOVED TO THE FPARAM BUFFER IN FIT FORMAT.
     2465     2940                    */
     2466     2941    1      IF AVAIL<SIZEC(FIT$->FM$FIT) THEN RETURN;

   2941  1 000116   200004 471500                    LDP1    @FIT$,,AUTO
         1 000117   100000 473500                    LDP3    0,,PR1
         1 000120   200014 235100                    LDA     AVAIL,,AUTO
         1 000121   000174 115007                    CMPA    124,DL
         1 000122   000124 605000 1                  TPL     s:2945

   2941  1 000123   000000 702200 xent               TSX2  ! X66_ARET

     2467     2942                    /*
     2468     2943                    *  SPECIAL CASE FOR SMALL FPARAM BUFFER GIVES USER NO FPARAMS
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:465  
     2469     2944                    */
     2470     2945    1      FPARAM$->FM$FIT='0'B;

   2945  1 000124   200003 474500                    LDP4    @FPARAM$,,AUTO
         1 000125   400000 475500                    LDP5    0,,PR4
         1 000126   000100 100400                    MLR     fill='000'O
         1 000127   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000130   500000 000174                    ADSC9   0,,PR5                   cn=0,n=124

     2471     2946    1      ITEMX=FIT$->FM$FIT.CODES.CODE(0)+1;

   2946  1 000131   100000 473500                    LDP3    0,,PR1
         1 000132   300000 236100                    LDQ     0,,PR3
         1 000133   000037 772000                    QRL     31
         1 000134   000001 036007                    ADLQ    1,DL
         1 000135   200011 756100                    STQ     ITEMX,,AUTO

     2472     2947    1      J=0;

   2947  1 000136   200013 450100                    STZ     J,,AUTO

     2473     2948    2      DO I=1 TO FIT$->FM$FIT.CODES.CODE(0);

   2948  1 000137   000001 235007                    LDA     1,DL
         1 000140   200012 755100                    STA     I,,AUTO
         1 000141   000335 710000 1                  TRA     NXTCODE+3

     2474     2949    2         NDW=FIT$->FM$FIT.CODES.NDW(I);

   2949  1 000142   200004 470500                    LDP0    @FIT$,,AUTO
         1 000143   000000 471500                    LDP1    0,,PR0
         1 000144   200012 720100                    LXL0    I,,AUTO
         1 000145   100000 236110                    LDQ     0,X0,PR1
         1 000146   000012 772000                    QRL     10
         1 000147   001777 376007                    ANQ     1023,DL
         1 000150   200010 756100                    STQ     NDW,,AUTO

PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:466  
     2475     2950    3         IF NOT B$JIT.PRIV.ACTIVE.FMSEC AND NDW~=0 THEN DO;

   2950  1 000151   000000 473400 xsym               LDP3    B$JIT$
         1 000152   300013 236100                    LDQ     11,,PR3
         1 000153   100000 316003                    CANQ    32768,DU
         1 000154   000210 601000 1                  TNZ     s:2956
         1 000155   200010 235100                    LDA     NDW,,AUTO
         1 000156   000210 600000 1                  TZE     s:2956

     2476     2951    3            IF FIT$->FM$FIT.CODES.CODE(I)=4

   2951  1 000157   100000 236110                    LDQ     0,X0,PR1
         1 000160   760000 376003                    ANQ     -8192,DU
         1 000161   100000 116003                    CMPQ    32768,DU
         1 000162   000173 601000 1                  TNZ     s:2953

     2477     2952    3            THEN NDW=POFFW(ADDR(CODE04.CREATOR),ADDR(CODE04));

   2952  1 000163   200006 236100                    LDQ     LOC$,,AUTO
         1 000164   000022 772000                    QRL     18
         1 000165   200016 756100                    STQ     AVAIL+2,,AUTO
         1 000166   200006 236100                    LDQ     LOC$,,AUTO
         1 000167   000003 036003                    ADLQ    3,DU
         1 000170   000022 772000                    QRL     18
         1 000171   200016 136100                    SBLQ    AVAIL+2,,AUTO
         1 000172   200010 756100                    STQ     NDW,,AUTO

     2478     2953    3            IF FIT$->FM$FIT.CODES.CODE(I)=14

   2953  1 000173   000000 471500                    LDP1    0,,PR0
         1 000174   100000 236110                    LDQ     0,X0,PR1
         1 000175   760000 376003                    ANQ     -8192,DU
         1 000176   340000 116003                    CMPQ    114688,DU
         1 000177   000210 601000 1                  TNZ     s:2956

     2479     2954    3            THEN NDW=POFFW(ADDR(CODE14.OWNER),ADDR(CODE14));

PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:467  
   2954  1 000200   200006 236100                    LDQ     LOC$,,AUTO
         1 000201   000022 772000                    QRL     18
         1 000202   200016 756100                    STQ     AVAIL+2,,AUTO
         1 000203   200006 236100                    LDQ     LOC$,,AUTO
         1 000204   000003 036003                    ADLQ    3,DU
         1 000205   000022 772000                    QRL     18
         1 000206   200016 136100                    SBLQ    AVAIL+2,,AUTO
         1 000207   200010 756100                    STQ     NDW,,AUTO

     2480     2955    3            END;

     2481     2956    2         IF FIT$->FM$FIT.CODES.CODE(I)~=1 AND

   2956  1 000210   000000 471500                    LDP1    0,,PR0
         1 000211   100000 236110                    LDQ     0,X0,PR1
         1 000212   760000 376003                    ANQ     -8192,DU
         1 000213   020000 116003                    CMPQ    8192,DU
         1 000214   000332 600000 1                  TZE     NXTCODE
         1 000215   200010 235100                    LDA     NDW,,AUTO
         1 000216   000221 601000 1                  TNZ     s:2958
         1 000217   300013 234100                    SZN     11,,PR3
         1 000220   000332 605000 1                  TPL     NXTCODE

     2482     2957    3           (NDW~=0 OR B$JIT.PRIV.ACTIVE.FMEFT) THEN DO;

     2483     2958    3            J=J+1;

   2958  1 000221   200013 235100                    LDA     J,,AUTO
         1 000222   000001 035007                    ADLA    1,DL
         1 000223   200013 755100                    STA     J,,AUTO

     2484     2959    3            FPARAM$->FM$FIT.CODES(J)=FIT$->FM$FIT.CODES(I);

   2959  1 000224   200003 474500                    LDP4    @FPARAM$,,AUTO
         1 000225   400000 475500                    LDP5    0,,PR4
         1 000226   100000 236110                    LDQ     0,X0,PR1
         1 000227   500000 756105                    STQ     0,AL,PR5
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:468  

     2485     2960    3            FPARAM$->FM$FIT.CODES.NDW(J)=NDW;

   2960  1 000230   400000 471500                    LDP1    0,,PR4
         1 000231   200013 721100                    LXL1    J,,AUTO
         1 000232   200010 236100                    LDQ     NDW,,AUTO
         1 000233   000012 736000                    QLS     10
         1 000234   100000 676111                    ERQ     0,X1,PR1
         1 000235   000001 376000 2                  ANQ     1
         1 000236   100000 656111                    ERSQ    0,X1,PR1

     2486     2961    3            FPARAM$->FM$FIT.CODES.ITEMX(J)=ITEMX;

   2961  1 000237   400000 471500                    LDP1    0,,PR4
         1 000240   200011 236100                    LDQ     ITEMX,,AUTO
         1 000241   100000 676111                    ERQ     0,X1,PR1
         1 000242   001777 376007                    ANQ     1023,DL
         1 000243   100000 656111                    ERSQ    0,X1,PR1

     2487     2962                    /*
     2488     2963                    *  NOW THAT THE FIT HEADER CODE IS BUILT, MOVE THE FIT ITEM
     2489     2964                    *  TO THE FPARAM BUFFER.
     2490     2965                    */
     2491     2966    3            LOC$=PINCRW(FIT$,FIT$->FM$FIT.CODES.ITEMX(I));

   2966  1 000244   000000 471500                    LDP1    0,,PR0
         1 000245   100000 722110                    LXL2    0,X0,PR1
         1 000246   001777 362003                    ANX2    1023,DU
         1 000247   100000 633512                    EPPR3   0,X2,PR1
         1 000250   200006 453500                    STP3    LOC$,,AUTO

     2492     2967    3            BUF$=PINCRW(FPARAM$,ITEMX);

   2967  1 000251   400000 471500                    LDP1    0,,PR4
         1 000252   200011 722100                    LXL2    ITEMX,,AUTO
         1 000253   100000 635512                    EPPR5   0,X2,PR1
         1 000254   200007 455500                    STP5    BUF$,,AUTO
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:469  

     2493     2968    3            IF POFFW(LOC$,FIT$)+NDW+SIZEW(FM$GRAN)>1024

   2968  1 000255   000000 236100                    LDQ     0,,PR0
         1 000256   000022 772000                    QRL     18
         1 000257   200016 756100                    STQ     AVAIL+2,,AUTO
         1 000260   200006 236100                    LDQ     LOC$,,AUTO
         1 000261   000022 772000                    QRL     18
         1 000262   200016 136100                    SBLQ    AVAIL+2,,AUTO
         1 000263   200010 036100                    ADLQ    NDW,,AUTO
         1 000264   001773 116007                    CMPQ    1019,DL
         1 000265   000373 605400 1                  TPNZ    FMOE$BADFIT

     2494     2969    3            THEN GOTO FMOE$BADFIT;
     2495     2970    3            ITEMX=ITEMX+NDW;

   2970  1 000266   200011 236100                    LDQ     ITEMX,,AUTO
         1 000267   200010 036100                    ADLQ    NDW,,AUTO
         1 000270   200011 756100                    STQ     ITEMX,,AUTO

     2496     2971    3            NDW=NDW*4;

   2971  1 000271   200010 235100                    LDA     NDW,,AUTO
         1 000272   000002 735000                    ALS     2
         1 000273   200010 755100                    STA     NDW,,AUTO

     2497     2972    3            IF ITEMX*4>AVAIL THEN GOTO FMOE$FPARAM;

   2972  1 000274   000002 736000                    QLS     2
         1 000275   200014 116100                    CMPQ    AVAIL,,AUTO
         1 000276   000367 605400 1                  TPNZ    FMOE$FPARAM

     2498     2973    3            BUF$->REC=LOC$->REC;

   2973  1 000277   000000 622005                    EAX2    0,AL
         1 000300   200010 723100                    LXL3    NDW,,AUTO
         1 000301   040140 100540                    MLR     fill='040'O
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:470  
         1 000302   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2
         1 000303   500000 000013                    ADSC9   0,,PR5                   cn=0,n=*X3

     2499     2974    4            IF FIT$->FM$FIT.CODES.CODE(I)=4 AND LOC$->CODE04.SVMODIFY THEN DO;

   2974  1 000304   000000 471500                    LDP1    0,,PR0
         1 000305   100000 236110                    LDQ     0,X0,PR1
         1 000306   760000 376003                    ANQ     -8192,DU
         1 000307   100000 116003                    CMPQ    32768,DU
         1 000310   000332 601000 1                  TNZ     NXTCODE
         1 000311   200006 473500                    LDP3    LOC$,,AUTO
         1 000312   300010 235100                    LDA     8,,PR3
         1 000313   000332 600000 1                  TZE     NXTCODE

     2500     2975    4               IF F$DCB.ASN=%TAPE# OR F$DCB.CFU$=ADDR(NIL) THEN EXIT;

   2975  1 000314   200005 476500                    LDP6    JDCB$,,AUTO
         1 000315   600032 236100                    LDQ     26,,PR6
         1 000316   777000 376007                    ANQ     -512,DL
         1 000317   002000 116007                    CMPQ    1024,DL
         1 000320   000332 600000 1                  TZE     NXTCODE
         1 000321   600066 236100                    LDQ     54,,PR6
         1 000322   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000323   000332 600000 1                  TZE     NXTCODE

     2501     2976    4               IF F$DCB.CFU$->FM$CFU.FMOD THEN EXIT;

   2976  1 000324   600066 477500                    LDP7    54,,PR6
         1 000325   700000 236100                    LDQ     0,,PR7
         1 000326   004000 316003                    CANQ    2048,DU
         1 000327   000332 601000 1                  TNZ     NXTCODE

     2502     2977    4               BUF$->CODE04.MODIFY=LOC$->CODE04.SVMODIFY;

   2977  1 000330   300010 236100                    LDQ     8,,PR3
         1 000331   500001 756100                    STQ     1,,PR5

PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:471  
     2503     2978    4               END;

     2504     2979    3            END;

     2505     2980    2   NXTCODE:
     2506     2981    2         END;

   2981  1 000332   200012 235100       NXTCODE      LDA     I,,AUTO
         1 000333   000001 035007                    ADLA    1,DL
         1 000334   200012 755100                    STA     I,,AUTO
         1 000335   200004 470500                    LDP0    @FIT$,,AUTO
         1 000336   000000 471500                    LDP1    0,,PR0
         1 000337   100000 236100                    LDQ     0,,PR1
         1 000340   000037 772000                    QRL     31
         1 000341   200012 116100                    CMPQ    I,,AUTO
         1 000342   000142 603000 1                  TRC     s:2949

     2507     2982                    /*
     2508     2983                    *  FINALLY FILL IN THE ZERO FIT ENTRY TO DEFINE HOW MANY ITEMS
     2509     2984                    *  ARE DESCRIBED IN THE FPARAM.
     2510     2985                    */
     2511     2986    1      FPARAM$->FM$FIT.CODES.NAW(0)=FIT$->FM$FIT.CODES.NDW(0);

   2986  1 000343   200003 473500                    LDP3    @FPARAM$,,AUTO
         1 000344   300000 474500                    LDP4    0,,PR3
         1 000345   100000 236100                    LDQ     0,,PR1
         1 000346   000012 736000                    QLS     10
         1 000347   400000 676100                    ERQ     0,,PR4
         1 000350   007774 376003                    ANQ     4092,DU
         1 000351   400000 656100                    ERSQ    0,,PR4

     2512     2987    1      FPARAM$->FM$FIT.CODES.NDW(0)=ITEMX;

   2987  1 000352   300000 471500                    LDP1    0,,PR3
         1 000353   200011 236100                    LDQ     ITEMX,,AUTO
         1 000354   000012 736000                    QLS     10
         1 000355   100000 676100                    ERQ     0,,PR1
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:472  
         1 000356   000001 376000 2                  ANQ     1
         1 000357   100000 656100                    ERSQ    0,,PR1

     2513     2988    1      FPARAM$->FM$FIT.CODES.CODE(0)=J;

   2988  1 000360   300000 471500                    LDP1    0,,PR3
         1 000361   200013 236100                    LDQ     J,,AUTO
         1 000362   000037 736000                    QLS     31
         1 000363   100000 676100                    ERQ     0,,PR1
         1 000364   760000 376003                    ANQ     -8192,DU
         1 000365   100000 656100                    ERSQ    0,,PR1

     2514     2989    1      RETURN;

   2989  1 000366   000000 702200 xent               TSX2  ! X66_ARET

     2515     2990                    /**/
     2516     2991                    /*E*     ERROR: FMO-E$FPARAM-E
     2517     2992                    *        MESSAGE:FPARAM area too small% for %UF%
     2518     2993                    */
     2519     2994    1   FMOE$FPARAM: B$JIT$->B$JIT.ERR=FMO$E$FPARAM;

   2994  1 000367   000000 236000 0     FMOE$FPARAM  LDQ     FMO$E$FPARAM
         1 000370   000000 470400 xsym               LDP0    B$JIT$
         1 000371   000012 756100                    STQ     10,,PR0

     2520     2995    1      ALTRETURN;

   2995  1 000372   000000 702200 xent               TSX2  ! X66_AALT

     2521     2996    1   FMOE$BADFIT: B$JIT.ERR=FMO$E$BADFIT;

   2996  1 000373   000001 236000 0     FMOE$BADFIT  LDQ     FMO$E$BADFIT
         1 000374   000000 470400 xsym               LDP0    B$JIT$
         1 000375   000012 756100                    STQ     10,,PR0

     2522     2997    1      ALTRETURN;
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:473  

   2997  1 000376   000000 702200 xent               TSX2  ! X66_AALT
     2523     2998    1   END FMO$TRNINFO;
     2524     2999        %EOD;

PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:474  
--  Include file information  --

   F_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FMO$TRNINFO.
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:475  

 **** Variables and constants ****

  ****  Section 000 RoData FMO$TRNINFO

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/b STRC        r     1 FMO$E$BADFIT               0-0-0/b STRC        r     1 FMO$E$FPARAM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @FIT$                      3-0-0/w PTR         r     1 @FPARAM$
    14-0-0/w SBIN        r     1 AVAIL                      7-0-0/w PTR         r     1 BUF$
    *0-0-0/w PTR         r     1 FIT$                      *0-0-0/w PTR         r     1 FPARAM$
    12-0-0/w UBIN        r     1 I                         11-0-0/w SBIN        r     1 ITEMX
    13-0-0/w UBIN        r     1 J                          5-0-0/w PTR         r     1 JDCB$
     6-0-0/w PTR         r     1 LOC$                      10-0-0/w SBIN        r     1 NDW

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC(396)   r     1 CODE04
     0-0-0/w STRC(288)   r     1 CODE14                     0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(288)   r     1 FM$CFU                     0-0-0/w STRC(1116)  r     1 FM$FIT
     0-0-0/w STRC(180)   r     1 FM$GRAN                    0-0-0/d STRC(1440)  r     1 PN$
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:476  
     0-0-0/c ACHR        r     1 REC


   Procedure FMO$TRNINFO requires 255 words for executable code.
   Procedure FMO$TRNINFO requires 18 words of local(AUTO) storage.
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:477  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:478  
          MINI XREF LISTING

AVAIL
        52**DCL      2917<>CALL     2924>>IF       2941>>IF       2972>>IF
B$JIT.DCB$
       471**DCL      2916>>ASSIGN
B$JIT.ERR
       381**DCL      2994<<ASSIGN   2996<<ASSIGN
B$JIT.ERR.MID
       382**DCL       382--REDEF
B$JIT.PRIV.ACTIVE.FMEFT
       382**DCL      2956>>IF
B$JIT.PRIV.ACTIVE.FMSEC
       383**DCL      2928>>IF       2950>>IF
B$JIT$
        35**DCL       376--IMP-PTR  2916>>ASSIGN   2928>>IF       2950>>IF       2956>>IF       2994>>ASSIGN
      2996>>ASSIGN
BUF$
        46**DCL      1675--IMP-PTR  2917>>CALL     2917>>CALL     2925<<ASSIGN   2927>>ASSIGN   2967<<ASSIGN
      2973>>ASSIGN   2977>>ASSIGN
CODE04
      2106**DCL      2931--IF       2952--ASSIGN
CODE04.CREATOR
      2108**DCL      2952--ASSIGN
CODE04.CREATOR.ACCT
      2108**DCL      2933<<ASSIGN
CODE04.CREATOR.NAME
      2108**DCL      2932<<ASSIGN
CODE04.MODIFY
      2108**DCL      2977<<ASSIGN
CODE04.SVMODIFY
      2109**DCL      2974>>IF       2977>>ASSIGN
CODE14
      2114**DCL      2954--ASSIGN
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:479  
CODE14.OWNER
      2119**DCL      2954--ASSIGN
F$DCB.ACS
       553**DCL      2922>>IF
F$DCB.ACTPOS
       561**DCL       561--REDEF
F$DCB.ARS
       536**DCL       536--REDEF
F$DCB.ASN
       551**DCL      2975>>IF
F$DCB.ATTR
       554**DCL       555--REDEF
F$DCB.BORROW
       569**DCL       569--REDEF     569--REDEF     569--REDEF
F$DCB.CFU$
       570**DCL      2975>>IF       2976>>IF
F$DCB.DCBNAME.L
       583**DCL       583--IMP-SIZ
F$DCB.EOMCHAR
       540**DCL       540--REDEF
F$DCB.FLDID
       564**DCL       564--REDEF
F$DCB.FORM$
       558**DCL       558--REDEF
F$DCB.FSECT
       574**DCL       574--REDEF
F$DCB.FSN
       551**DCL       551--REDEF     551--REDEF     552--REDEF
F$DCB.HEADER$
       557**DCL       557--REDEF
F$DCB.IXTNSIZE
       555**DCL       555--REDEF
F$DCB.LASTSTA$
       545**DCL       545--REDEF
F$DCB.LVL
       570**DCL       570--REDEF
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:480  
F$DCB.NAME.C
       545**DCL       545--REDEF
F$DCB.NOEOF
       566**DCL       566--REDEF
F$DCB.NRECS
       556**DCL       556--REDEF
F$DCB.NRECX
       575**DCL       575--REDEF
F$DCB.OHDR
       567**DCL       567--REDEF
F$DCB.ORG
       550**DCL       550--REDEF
F$DCB.PRECNO
       573**DCL       573--REDEF
F$DCB.RCSZ
       578**DCL       578--REDEF
F$DCB.RES
       546**DCL       546--REDEF
F$DCB.SETX
       558**DCL       558--REDEF
F$DCB.TAB$
       557**DCL       558--REDEF
F$DCB.TDA
       572**DCL       572--REDEF
F$DCB.WSN
       547**DCL       547--REDEF
FIT$
        32**DCL        27--PROC     2925>>ASSIGN   2941>>IF       2946>>ASSIGN   2948>>DOINDEX  2949>>ASSIGN
      2951>>IF       2953>>IF       2956>>IF       2959>>ASSIGN   2966>>ASSIGN   2966>>ASSIGN   2968>>IF
      2974>>IF       2986>>ASSIGN
FM$CFU.ACCTX
      2096**DCL      2096--REDEF
FM$CFU.FMOD
      2095**DCL      2976>>IF
FM$FIT
      2101**DCL      2941--IF       2945<<ASSIGN
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:481  
FM$FIT.CODES
      2101**DCL      2959<<ASSIGN   2959>>ASSIGN
FM$FIT.CODES.CODE
      2101**DCL      2946>>ASSIGN   2948>>DOINDEX  2951>>IF       2953>>IF       2956>>IF       2974>>IF
      2988<<ASSIGN
FM$FIT.CODES.ITEMX
      2101**DCL      2961<<ASSIGN   2966>>ASSIGN
FM$FIT.CODES.NAW
      2101**DCL      2986<<ASSIGN
FM$FIT.CODES.NDW
      2101**DCL      2949>>ASSIGN   2960<<ASSIGN   2986>>ASSIGN   2987<<ASSIGN
FM$GRAN
      2122**DCL      2925--ASSIGN   2929--ASSIGN   2968--IF
FMO$E$BADFIT
      2912**DCL      2996>>ASSIGN
FMO$E$FPARAM
      2908**DCL      2994>>ASSIGN
FMO$LOCCODP
        39**DCL-ENT  2930--CALL
FMOE$BADFIT
      2996**LABEL    2931--GOTO     2969--GOTO
FMOE$FPARAM
      2994**LABEL    2924--GOTO     2972--GOTO
FPARAM$
        31**DCL        27--PROC     2927>>ASSIGN   2929>>ASSIGN   2931>>IF       2945>>ASSIGN   2959>>ASSIGN
      2960>>ASSIGN   2961>>ASSIGN   2967>>ASSIGN   2986>>ASSIGN   2987>>ASSIGN   2988>>ASSIGN
HFF$DSIZ
        40**DCL-ENT  2917--CALL
I
        49**DCL      2948<<DOINDEX  2949>>ASSIGN   2951>>IF       2953>>IF       2956>>IF       2959>>ASSIGN
      2966>>ASSIGN   2974>>IF
ITEMX
        48**DCL      2946<<ASSIGN   2961>>ASSIGN   2967>>ASSIGN   2970<<ASSIGN   2970>>ASSIGN   2972>>IF
      2987>>ASSIGN
J
        50**DCL      2947<<ASSIGN   2958<<ASSIGN   2958>>ASSIGN   2959>>ASSIGN   2960>>ASSIGN   2961>>ASSIGN
PL6.E3A0      #004=FMO$TRNINFO File=FMO$OBSE.:E05TSI                             TUE 07/29/97 16:58 Page:482  
      2988>>ASSIGN
JDCB$
        44**DCL       536--IMP-PTR  2916<<ASSIGN   2922>>IF       2975>>IF       2975>>IF       2976>>IF
LOC$
        45**DCL      2106--IMP-PTR  2114--IMP-PTR  2929<<ASSIGN   2930<>CALL     2931>>IF       2932>>ASSIGN
      2933>>ASSIGN   2952>>ASSIGN   2952>>ASSIGN   2954>>ASSIGN   2954>>ASSIGN   2966<<ASSIGN   2968>>IF
      2973>>ASSIGN   2974>>IF       2977>>ASSIGN
NDW
        47**DCL        51--IMP-SIZ  2926<<ASSIGN   2927>>ASSIGN   2927>>ASSIGN   2949<<ASSIGN   2950>>IF
      2952<<ASSIGN   2954<<ASSIGN   2956>>IF       2960>>ASSIGN   2968>>IF       2970>>ASSIGN   2971<<ASSIGN
      2971>>ASSIGN   2973>>ASSIGN   2973>>ASSIGN
NONAME
      2933**LABEL    2930--CALLALT
PN$.ACSVEH_
      1677**DCL      1678--REDEF
PN$.ALTKEYS_
      1683**DCL      1684--REDEF    1684--REDEF
PN$.FPARAM_
      1680**DCL      2917--CALL
PN$.HDR_
      1682**DCL      1683--REDEF
PN$.TAB_
      1681**DCL      1682--REDEF
PN$.UHL_
      1675**DCL      1676--REDEF    1676--REDEF
PN$.V.FSN#
      1715**DCL      1715--REDEF    1715--REDEF
PN$.V_
      1675**DCL      2917--CALL
PN$.WSN_
      1681**DCL      1681--REDEF
REC
        51**DCL      2927<<ASSIGN   2927>>ASSIGN   2973<<ASSIGN   2973>>ASSIGN

PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:483  
     2525        1        /*T***********************************************************/
     2526        2        /*T*                                                         */
     2527        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2528        4        /*T*                                                         */
     2529        5        /*T***********************************************************/
     2530        6                    /*F*   NAME:   FMO$FDHASH
     2531        7                    *      PURPOSE:  Generate the hash used in the stamp of file
     2532        8                    *                directory granules.
     2533        9                    *
     2534       10                    *
     2535       11                    */
     2536       12                    /*D*   NAME:   FMO$FDHASH
     2537       13                    *      CALL:   CALL FMO$FDHASH(JDCB$,HASH);
     2538       14                    *      INPUT:  JDCB$ - Pointer to DCB
     2539       15                    *      OUTPUT: HASH - The hash (a 27-bit variable)
     2540       16                    *      DESCRIPTION:  The hash for regular accounts is the sum
     2541       17                    *                    of bits 0-26, 24-50 and 45-71 of the account.
     2542       18                    *                    For the star-file directory, it is the SYSID
     2543       19                    *                    of the user.  */
     2544       20                    /* */
     2545       21        FMO$FDHASH: PROC(JDCB$,HASH);
     2546       22                    /* PARAMETERS */
     2547       23    1   DCL JDCB$ PTR;
     2548       24    1   DCL HASH UBIN(27) CALIGNED;
     2549       25                    /* LOCAL AUTOMATIC STORAGE */
     2550       26    1   DCL ACCT$ PTR;
     2551       27                    /* INCLUDE FILES */
     2552       28        %INCLUDE F$DCB;
     2553       77        %INCLUDE B$USER;
     2554      293        %B$USERREFS;
     2555      297                    /* BASED STRUCTURES */
     2556      298    1   DCL 1 BITS BASED ALIGNED,
     2557      299    1         2 B1 UBIN(27) UNAL,
     2558      300    1         2 * UBIN(18) UNAL,
     2559      301    1         2 B2 UBIN(27) UNAL;
     2560      302    1   DCL 1 MBITS BASED ALIGNED,
     2561      303    1         2 * UBIN(24) UNAL,
PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:484  
     2562      304    1         2 B3 UBIN(27) UNAL;
     2563      305                    /* */
     2564      306    1      IF JDCB$->F$DCB.STARF
     2565      307    1      THEN     /* STAR FILE DIRECTORY */
     2566      308    1         HASH=S$CU$->B$U.SYSID; /* HASH IS USER'S SYSID */
     2567      309    1      ELSE     /* REGULAR DIRECTORY */
     2568      310    2      DO;
     2569      311    2         ACCT$=ADDR(JDCB$->F$DCB.ACCT); /* ADDRESS OF ACCOUNT NAME */
     2570      312    2         HASH=ACCT$->BITS.B1+ACCT$->BITS.B2+ACCT$->MBITS.B3;
     2571      313    2         END;
     2572      314    1      RETURN;
     2573      315    1   END FMO$FDHASH;
     2574      316        %EOD;

PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:485  
--  Include file information  --

   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FMO$FDHASH.

   Procedure FMO$FDHASH requires 35 words for executable code.
   Procedure FMO$FDHASH requires 10 words of local(AUTO) storage.

PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:486  

 Object Unit name= FMO$FDHASH                                 File name= FMO$OBSE.:E05TOU
 UTS= JUL 29 '97 16:58:24.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    35     43  FMO$FDHASH

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        2  FMO$FDHASH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     S$CU$                                 B_VECTNIL
PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:487  


     2525        1        /*T***********************************************************/
     2526        2        /*T*                                                         */
     2527        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2528        4        /*T*                                                         */
     2529        5        /*T***********************************************************/
     2530        6                    /*F*   NAME:   FMO$FDHASH
     2531        7                    *      PURPOSE:  Generate the hash used in the stamp of file
     2532        8                    *                directory granules.
     2533        9                    *
     2534       10                    *
     2535       11                    */
     2536       12                    /*D*   NAME:   FMO$FDHASH
     2537       13                    *      CALL:   CALL FMO$FDHASH(JDCB$,HASH);
     2538       14                    *      INPUT:  JDCB$ - Pointer to DCB
     2539       15                    *      OUTPUT: HASH - The hash (a 27-bit variable)
     2540       16                    *      DESCRIPTION:  The hash for regular accounts is the sum
     2541       17                    *                    of bits 0-26, 24-50 and 45-71 of the account.
     2542       18                    *                    For the star-file directory, it is the SYSID
     2543       19                    *                    of the user.  */
     2544       20                    /* */
     2545       21        FMO$FDHASH: PROC(JDCB$,HASH);

     21  0 000000   000000 700200 xent  FMO$FDHASH   TSX0  ! X66_AUTO_2
         0 000001   000012 000002                    ZERO    10,2

     2546       22                    /* PARAMETERS */
     2547       23    1   DCL JDCB$ PTR;
     2548       24    1   DCL HASH UBIN(27) CALIGNED;
     2549       25                    /* LOCAL AUTOMATIC STORAGE */
     2550       26    1   DCL ACCT$ PTR;
     2551       27                    /* INCLUDE FILES */
     2552       28        %INCLUDE F$DCB;
     2553       77        %INCLUDE B$USER;
     2554      293        %B$USERREFS;
     2555      297                    /* BASED STRUCTURES */
     2556      298    1   DCL 1 BITS BASED ALIGNED,
PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:488  
     2557      299    1         2 B1 UBIN(27) UNAL,
     2558      300    1         2 * UBIN(18) UNAL,
     2559      301    1         2 B2 UBIN(27) UNAL;
     2560      302    1   DCL 1 MBITS BASED ALIGNED,
     2561      303    1         2 * UBIN(24) UNAL,
     2562      304    1         2 B3 UBIN(27) UNAL;
     2563      305                    /* */
     2564      306    1      IF JDCB$->F$DCB.STARF

    306  0 000002   200003 470500                    LDP0    @JDCB$,,AUTO
         0 000003   000000 471500                    LDP1    0,,PR0
         0 000004   100064 236100                    LDQ     52,,PR1
         0 000005   200000 316003                    CANQ    65536,DU
         0 000006   000015 600000 0                  TZE     s:311

     2565      307    1      THEN     /* STAR FILE DIRECTORY */
     2566      308    1         HASH=S$CU$->B$U.SYSID; /* HASH IS USER'S SYSID */

    308  0 000007   000000 473400 xsym               LDP3    S$CU$
         0 000010   200004 474500                    LDP4    @HASH,,AUTO
         0 000011   000100 101500                    MRL     fill='000'O
         0 000012   300014 400002                    ADSC9   12,,PR3                  cn=2,n=2
         0 000013   400000 000003                    ADSC9   0,,PR4                   cn=0,n=3
         0 000014   000042 710000 0                  TRA     s:314

     2567      309    1      ELSE     /* REGULAR DIRECTORY */
     2568      310    2      DO;

     2569      311    2         ACCT$=ADDR(JDCB$->F$DCB.ACCT); /* ADDRESS OF ACCOUNT NAME */

    311  0 000015   100020 633500                    EPPR3   16,,PR1
         0 000016   200005 453500                    STP3    ACCT$,,AUTO

     2570      312    2         HASH=ACCT$->BITS.B1+ACCT$->BITS.B2+ACCT$->MBITS.B3;

    312  0 000017   300001 236100                    LDQ     1,,PR3
         0 000020   000032 376000 xsym               ANQ     B_VECTNIL+26
PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:489  
         0 000021   200006 756100                    STQ     ACCT$+1,,AUTO
         0 000022   300000 236100                    LDQ     0,,PR3
         0 000023   000011 772000                    QRL     9
         0 000024   200006 036100                    ADLQ    ACCT$+1,,AUTO
         0 000025   300000 235100                    LDA     0,,PR3
         0 000026   200007 756100                    STQ     ACCT$+2,,AUTO
         0 000027   300001 236100                    LDQ     1,,PR3
         0 000030   000025 773000                    LRL     21
         0 000031   000032 376000 xsym               ANQ     B_VECTNIL+26
         0 000032   200010 756100                    STQ     ACCT$+3,,AUTO
         0 000033   200007 236100                    LDQ     ACCT$+2,,AUTO
         0 000034   200010 036100                    ADLQ    ACCT$+3,,AUTO
         0 000035   200011 756100                    STQ     ACCT$+4,,AUTO
         0 000036   200004 471500                    LDP1    @HASH,,AUTO
         0 000037   000100 101500                    MRL     fill='000'O
         0 000040   200011 000004                    ADSC9   ACCT$+4,,AUTO            cn=0,n=4
         0 000041   100000 000003                    ADSC9   0,,PR1                   cn=0,n=3

     2571      313    2         END;

     2572      314    1      RETURN;

    314  0 000042   000000 702200 xent               TSX2  ! X66_ARET
     2573      315    1   END FMO$FDHASH;
     2574      316        %EOD;

PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:490  
--  Include file information  --

   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FMO$FDHASH.
PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:491  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @HASH                      3-0-0/w PTR         r     1 @JDCB$
     5-0-0/w PTR         r     1 ACCT$                     *0-0-0/c UBIN(27)    r     1 HASH
    *0-0-0/w PTR         r     1 JDCB$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 S$CU$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(576)   r     1 B$U                        0-0-0/w STRC(72)    r     1 BITS
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(51)    r     1 MBITS


   Procedure FMO$FDHASH requires 35 words for executable code.
   Procedure FMO$FDHASH requires 10 words of local(AUTO) storage.
PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:492  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:493  
          MINI XREF LISTING

ACCT$
        26**DCL       311<<ASSIGN    312>>ASSIGN    312>>ASSIGN    312>>ASSIGN
B$DO.ECCINFO
       228**DCL       229--REDEF
B$U.MISC
       207**DCL       208--REDEF
B$U.SYSID
       202**DCL       308>>ASSIGN
B$USER.MISC
       283**DCL       284--REDEF
BITS.B1
       299**DCL       312>>ASSIGN
BITS.B2
       301**DCL       312>>ASSIGN
F$DCB.ACCT
        39**DCL       311--ASSIGN
F$DCB.ACTPOS
        54**DCL        54--REDEF
F$DCB.ARS
        29**DCL        29--REDEF
F$DCB.ATTR
        47**DCL        48--REDEF
F$DCB.BORROW
        62**DCL        62--REDEF      62--REDEF      62--REDEF
F$DCB.DCBNAME.L
        76**DCL        76--IMP-SIZ
F$DCB.EOMCHAR
        33**DCL        33--REDEF
F$DCB.FLDID
        57**DCL        57--REDEF
F$DCB.FORM$
        51**DCL        51--REDEF
PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:494  
F$DCB.FSECT
        67**DCL        67--REDEF
F$DCB.FSN
        44**DCL        44--REDEF      44--REDEF      45--REDEF
F$DCB.HEADER$
        50**DCL        50--REDEF
F$DCB.IXTNSIZE
        48**DCL        48--REDEF
F$DCB.LASTSTA$
        38**DCL        38--REDEF
F$DCB.LVL
        63**DCL        63--REDEF
F$DCB.NAME.C
        38**DCL        38--REDEF
F$DCB.NOEOF
        59**DCL        59--REDEF
F$DCB.NRECS
        49**DCL        49--REDEF
F$DCB.NRECX
        68**DCL        68--REDEF
F$DCB.OHDR
        60**DCL        60--REDEF
F$DCB.ORG
        43**DCL        43--REDEF
F$DCB.PRECNO
        66**DCL        66--REDEF
F$DCB.RCSZ
        71**DCL        71--REDEF
F$DCB.RES
        39**DCL        39--REDEF
F$DCB.SETX
        51**DCL        51--REDEF
F$DCB.STARF
        58**DCL       306>>IF
F$DCB.TAB$
        50**DCL        51--REDEF
PL6.E3A0      #005=FMO$FDHASH File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:495  
F$DCB.TDA
        65**DCL        65--REDEF
F$DCB.WSN
        40**DCL        40--REDEF
HASH
        24**DCL        21--PROC      308<<ASSIGN    312<<ASSIGN
JDCB$
        23**DCL        21--PROC      306>>IF        311>>ASSIGN
MBITS.B3
       304**DCL       312>>ASSIGN
S$CU$
       294**DCL       308>>ASSIGN

PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:496  
     2575        1        /*T***********************************************************/
     2576        2        /*T*                                                         */
     2577        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2578        4        /*T*                                                         */
     2579        5        /*T***********************************************************/
     2580        6                    /*F*
     2581        7                    *      NAME:   FMO$PACKACCT
     2582        8                    *
     2583        9                    *      PURPOSE:   TO PACK THE ACCT FROM THE DCB INTO A TEXTC
     2584       10                    *                 TYPE KEY FOR THE ACCT DIRECTORY.
     2585       11                    *
     2586       12                    */
     2587       13        FMO$PACKACCT: PROC(JDCB$,KEY$);
     2588       14                    /**/
     2589       15        %INCLUDE F$DCB;
     2590       64                    /**/
     2591       65                    /* PARAMETER DATA */
     2592       66                    /**/
     2593       67    1   DCL JDCB$ PTR; /* POINTER TO THE DCB */
     2594       68    1   DCL KEY$ PTR; /* POINTER TO THE AREA FOR KEY*/
     2595       69                    /**/
     2596       70                    /* AUTOMATIC DATA */
     2597       71    1   DCL I UBIN; /* INDEX */
     2598       72                    /**/
     2599       73                    /* BASED STRUCTURES */
     2600       74                    /**/
     2601       75    1   DCL 1 AC7 BASED ALIGNED,
     2602       76    1         2 C UBIN(9) UNAL,
     2603       77    1         2 R (0:7) UBIN(7) UNAL,
     2604       78    1         2 P UBIN(7) UNAL;
     2605       79                    /* TEXTC TYPE ACCT NUMBER */
     2606       80    1   DCL 1 AC9,
     2607       81    1         2 R(0:7) UBIN BYTE UNAL;
     2608       82                    /* TEXT TYPE ACCT NO. (ASCII)*/
     2609       83                    /**/
     2610       84    1      AC9=ADDR(JDCB$->F$DCB.ACCT)->AC7;
     2611       85    2      DO I=0 TO 7;
PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:497  
     2612       86    2         KEY$->AC7.R(I)=AC9.R(I);
     2613       87    2         END;
     2614       88    1      KEY$->AC7.C=7;
     2615       89    1      KEY$->AC7.P=0;
     2616       90    1      RETURN;
     2617       91                    /**/
     2618       92                    /*F*
     2619       93                    *      NAME:   FMO$UNPKACCT
     2620       94                    *
     2621       95                    *      PURPOSE:   TO UNPACK THE ACCOUNT FROM ITS TEXTC FORM IN
     2622       96                    *                 THE ACCT DIRECTORY TO TEXT IN THE DCB.
     2623       97                    */
     2624       98    1   FMO$UPKACCT: ENTRY(JDCB$,KEY$);
     2625       99                    /**/
     2626      100    2      DO I=0 TO 7;
     2627      101    2         AC9.R(I)=KEY$->AC7.R(I);
     2628      102    2         ADDR(JDCB$->F$DCB.ACCT)->AC7=AC9;
     2629      103    2         END;
     2630      104    1      RETURN;
     2631      105                    /**/
     2632      106    1   END FMO$PACKACCT;
     2633      107        %EOD;

PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:498  
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FMO$PACKACCT.

   Procedure FMO$PACKACCT requires 54 words for executable code.
   Procedure FMO$PACKACCT requires 10 words of local(AUTO) storage.

PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:499  

 Object Unit name= FMO$PACKACCT                               File name= FMO$OBSE.:E05TOU
 UTS= JUL 29 '97 16:58:31.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    54     66  FMO$PACKACCT
    1  RoData even  none     1      1  FMO$PACKACCT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        2  FMO$PACKACCT
     0     36                  yes      Std        2  FMO$UPKACCT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:500  


     2575        1        /*T***********************************************************/
     2576        2        /*T*                                                         */
     2577        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2578        4        /*T*                                                         */
     2579        5        /*T***********************************************************/
     2580        6                    /*F*
     2581        7                    *      NAME:   FMO$PACKACCT
     2582        8                    *
     2583        9                    *      PURPOSE:   TO PACK THE ACCT FROM THE DCB INTO A TEXTC
     2584       10                    *                 TYPE KEY FOR THE ACCT DIRECTORY.
     2585       11                    *
     2586       12                    */
     2587       13        FMO$PACKACCT: PROC(JDCB$,KEY$);

     13  0 000000   000000 700200 xent  FMO$PACKACCT TSX0  ! X66_AUTO_2
         0 000001   000012 000002                    ZERO    10,2

     2588       14                    /**/
     2589       15        %INCLUDE F$DCB;
     2590       64                    /**/
     2591       65                    /* PARAMETER DATA */
     2592       66                    /**/
     2593       67    1   DCL JDCB$ PTR; /* POINTER TO THE DCB */
     2594       68    1   DCL KEY$ PTR; /* POINTER TO THE AREA FOR KEY*/
     2595       69                    /**/
     2596       70                    /* AUTOMATIC DATA */
     2597       71    1   DCL I UBIN; /* INDEX */
     2598       72                    /**/
     2599       73                    /* BASED STRUCTURES */
     2600       74                    /**/
     2601       75    1   DCL 1 AC7 BASED ALIGNED,
     2602       76    1         2 C UBIN(9) UNAL,
     2603       77    1         2 R (0:7) UBIN(7) UNAL,
     2604       78    1         2 P UBIN(7) UNAL;
     2605       79                    /* TEXTC TYPE ACCT NUMBER */
     2606       80    1   DCL 1 AC9,
PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:501  
     2607       81    1         2 R(0:7) UBIN BYTE UNAL;
     2608       82                    /* TEXT TYPE ACCT NO. (ASCII)*/
     2609       83                    /**/
     2610       84    1      AC9=ADDR(JDCB$->F$DCB.ACCT)->AC7;

     84  0 000002   200003 470500                    LDP0    @JDCB$,,AUTO
         0 000003   000000 471500                    LDP1    0,,PR0
         0 000004   100020 237100                    LDAQ    16,,PR1
         0 000005   200006 757100                    STAQ    AC9,,AUTO

     2611       85    2      DO I=0 TO 7;

     85  0 000006   200005 450100                    STZ     I,,AUTO

     2612       86    2         KEY$->AC7.R(I)=AC9.R(I);

     86  0 000007   200004 470500                    LDP0    @KEY$,,AUTO
         0 000010   000000 471500                    LDP1    0,,PR0
         0 000011   200005 236100                    LDQ     I,,AUTO
         0 000012   000011 402007                    MPY     9,DL
         0 000013   200010 756100                    STQ     AC9+2,,AUTO
         0 000014   200005 236100                    LDQ     I,,AUTO
         0 000015   000007 402007                    MPY     7,DL
         0 000016   200010 235100                    LDA     AC9+2,,AUTO
         0 000017   003106 061505                    CSR     bolr='003'O
         0 000020   200006 000011                    BDSC    AC9,A,AUTO               by=0,bit=0,n=9
         0 000021   100000 200007                    BDSC    0,Q,PR1                  by=1,bit=0,n=7

     2613       87    2         END;

     87  0 000022   200005 235100                    LDA     I,,AUTO
         0 000023   000001 035007                    ADLA    1,DL
         0 000024   200005 755100                    STA     I,,AUTO
         0 000025   000010 115007                    CMPA    8,DL
         0 000026   000007 602000 0                  TNC     s:86

     2614       88    1      KEY$->AC7.C=7;
PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:502  

     88  0 000027   000000 471500                    LDP1    0,,PR0
         0 000030   007000 236003                    LDQ     3584,DU
         0 000031   100000 552140                    STBQ    0,'40'O,PR1

     2615       89    1      KEY$->AC7.P=0;

     89  0 000032   000000 471500                    LDP1    0,,PR0
         0 000033   000000 236000 1                  LDQ     0
         0 000034   100001 356100                    ANSQ    1,,PR1

     2616       90    1      RETURN;

     90  0 000035   000000 702200 xent               TSX2  ! X66_ARET

     2617       91                    /**/
     2618       92                    /*F*
     2619       93                    *      NAME:   FMO$UNPKACCT
     2620       94                    *
     2621       95                    *      PURPOSE:   TO UNPACK THE ACCOUNT FROM ITS TEXTC FORM IN
     2622       96                    *                 THE ACCT DIRECTORY TO TEXT IN THE DCB.
     2623       97                    */
     2624       98    1   FMO$UPKACCT: ENTRY(JDCB$,KEY$);

     98  0 000036   000000 700200 xent  FMO$UPKACCT  TSX0  ! X66_AUTO_2
         0 000037   000012 000002                    ZERO    10,2

     2625       99                    /**/
     2626      100    2      DO I=0 TO 7;

    100  0 000040   200005 450100                    STZ     I,,AUTO

     2627      101    2         AC9.R(I)=KEY$->AC7.R(I);

    101  0 000041   200004 470500                    LDP0    @KEY$,,AUTO
         0 000042   000000 471500                    LDP1    0,,PR0
         0 000043   200005 236100                    LDQ     I,,AUTO
PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:503  
         0 000044   000007 402007                    MPY     7,DL
         0 000045   200010 756100                    STQ     AC9+2,,AUTO
         0 000046   200005 236100                    LDQ     I,,AUTO
         0 000047   000011 402007                    MPY     9,DL
         0 000050   200010 235100                    LDA     AC9+2,,AUTO
         0 000051   003106 061505                    CSR     bolr='003'O
         0 000052   100000 200007                    BDSC    0,A,PR1                  by=1,bit=0,n=7
         0 000053   200006 000011                    BDSC    AC9,Q,AUTO               by=0,bit=0,n=9

     2628      102    2         ADDR(JDCB$->F$DCB.ACCT)->AC7=AC9;

    102  0 000054   200003 471500                    LDP1    @JDCB$,,AUTO
         0 000055   100000 473500                    LDP3    0,,PR1
         0 000056   200006 237100                    LDAQ    AC9,,AUTO
         0 000057   300020 757100                    STAQ    16,,PR3

     2629      103    2         END;

    103  0 000060   200005 235100                    LDA     I,,AUTO
         0 000061   000001 035007                    ADLA    1,DL
         0 000062   200005 755100                    STA     I,,AUTO
         0 000063   000010 115007                    CMPA    8,DL
         0 000064   000041 602000 0                  TNC     s:101

     2630      104    1      RETURN;

    104  0 000065   000000 702200 xent               TSX2  ! X66_ARET
     2631      105                    /**/
     2632      106    1   END FMO$PACKACCT;
     2633      107        %EOD;

PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:504  
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FMO$PACKACCT.
PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:505  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @JDCB$                     4-0-0/w PTR         r     1 @KEY$
     6-0-0/b STRC(72)    r     1 AC9                        5-0-0/w UBIN        r     1 I
    *0-0-0/w PTR         r     1 JDCB$                     *0-0-0/w PTR         r     1 KEY$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 AC7                        0-0-0/d ASTR(3528)  r     1 F$DCB


   Procedure FMO$PACKACCT requires 54 words for executable code.
   Procedure FMO$PACKACCT requires 10 words of local(AUTO) storage.
PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:506  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:507  
          MINI XREF LISTING

AC7
        75**DCL        84>>ASSIGN    102<<ASSIGN
AC7.C
        76**DCL        88<<ASSIGN
AC7.P
        78**DCL        89<<ASSIGN
AC7.R
        77**DCL        86<<ASSIGN    101>>ASSIGN
AC9
        80**DCL        84<<ASSIGN    102>>ASSIGN
AC9.R
        81**DCL        86>>ASSIGN    101<<ASSIGN
F$DCB.ACCT
        26**DCL        84--ASSIGN    102--ASSIGN
F$DCB.ACTPOS
        41**DCL        41--REDEF
F$DCB.ARS
        16**DCL        16--REDEF
F$DCB.ATTR
        34**DCL        35--REDEF
F$DCB.BORROW
        49**DCL        49--REDEF      49--REDEF      49--REDEF
F$DCB.DCBNAME.L
        63**DCL        63--IMP-SIZ
F$DCB.EOMCHAR
        20**DCL        20--REDEF
F$DCB.FLDID
        44**DCL        44--REDEF
F$DCB.FORM$
        38**DCL        38--REDEF
F$DCB.FSECT
        54**DCL        54--REDEF
PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:508  
F$DCB.FSN
        31**DCL        31--REDEF      31--REDEF      32--REDEF
F$DCB.HEADER$
        37**DCL        37--REDEF
F$DCB.IXTNSIZE
        35**DCL        35--REDEF
F$DCB.LASTSTA$
        25**DCL        25--REDEF
F$DCB.LVL
        50**DCL        50--REDEF
F$DCB.NAME.C
        25**DCL        25--REDEF
F$DCB.NOEOF
        46**DCL        46--REDEF
F$DCB.NRECS
        36**DCL        36--REDEF
F$DCB.NRECX
        55**DCL        55--REDEF
F$DCB.OHDR
        47**DCL        47--REDEF
F$DCB.ORG
        30**DCL        30--REDEF
F$DCB.PRECNO
        53**DCL        53--REDEF
F$DCB.RCSZ
        58**DCL        58--REDEF
F$DCB.RES
        26**DCL        26--REDEF
F$DCB.SETX
        38**DCL        38--REDEF
F$DCB.TAB$
        37**DCL        38--REDEF
F$DCB.TDA
        52**DCL        52--REDEF
F$DCB.WSN
        27**DCL        27--REDEF
PL6.E3A0      #006=FMO$PACKACCT File=FMO$OBSE.:E05TSI                            TUE 07/29/97 16:58 Page:509  
I
        71**DCL        85<<DOINDEX    86>>ASSIGN     86>>ASSIGN    100<<DOINDEX   101>>ASSIGN    101>>ASSIGN
JDCB$
        67**DCL        13--PROC       84>>ASSIGN     98--ENTRY     102>>ASSIGN
KEY$
        68**DCL        13--PROC       86>>ASSIGN     88>>ASSIGN     89>>ASSIGN     98--ENTRY     101>>ASSIGN

PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:510  
     2634        1        /*T***********************************************************/
     2635        2        /*T*                                                         */
     2636        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2637        4        /*T*                                                         */
     2638        5        /*T***********************************************************/
     2639        6                    /*F*
     2640        7                    *     NAME:   FMO$SECCHK
     2641        8                    *
     2642        9                    *     PURPOSE:  TO CHECK THE SECURITY OF THE FILE IN CONJUNCTION
     2643       10                    *               WITH THE CURRENT OPEN REQUEST.
     2644       11                    */
     2645       12        FMO$SECCHK: PROC(FDFIT,FM$FIT);
     2646       13    1   DCL FDFIT UBIN;/* THIS PARAMEWTER IS PRESENT, BUT UNUSED, IF NOT SECCHKFD */
     2647       14        %INCLUDE FM$MACROS;
     2648      389        %FM$FIT(BASED=" ");
     2649      392        %CODE03(BASED="BASED(LOC$)");
     2650      399        %CODE04(BASED="BASED(LOC$)");
     2651      407        %CODE07(BASED="BASED(LOC$)");
     2652      410        %CODE09(BASED="BASED(LOC$)");
     2653      414        %CODE10(BASED="BASED(LOC$)");
     2654      418        %FM$CFU(BASED="BASED(CFU$)");
     2655      424        %FM$CFUA(BASED="BASED(CFU$)");
     2656      430        %INCLUDE F_ERRORS_C;
     2657      670        %INCLUDE F$JIT_C;
     2658     1100        %MACRO F$DCB#(BASED=BASED);
     2659     1101        %INCLUDE F$DCB;
     2660     1150        %MEND;
     2661     1151        %F$DCB#(BASED="BASED(JDCB$)");
     2662     1201        %INCLUDE CP_6_SUBS;
     2663     1741        %INCLUDE B$P;
     2664     1825        %INCLUDE B$USER;
     2665     2041        %B$USERREFS;
     2666     2045    1   DCL 1 BACSVEH BASED,
     2667     2046    1         2 L UBIN BYTE UNAL,
     2668     2047    1         2 C CHAR(BACSVEH.L);
     2669     2048    1   DCL BACCT BASED CHAR(8);
     2670     2049                    /**/
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:511  
     2671     2050                    /* AUTO DATA */
     2672     2051    1   DCL JDCB$ PTR; /* DCB POINTER */
     2673     2052    1   DCL LOC$ PTR; /* FITCODE PTR */
     2674     2053    1   DCL CFU$ PTR; /* CFU AREA PINTER */
     2675     2054    1   DCL I UBIN;
     2676     2055    1   DCL J UBIN;
     2677     2056    1   DCL WILD_XC REDEF J CHAR(4);
     2678     2057    1   DCL K UBIN;
     2679     2058    1   DCL JP UBIN;
     2680     2059    1   DCL KP UBIN;
     2681     2060    1   DCL ACCT$ REDEF KP PTR;
     2682     2061    1   DCL 1 M,
     2683     2062    1         2 CM UBIN,
     2684     2063    1         2 C SBIN;
     2685     2064    1   DCL TACCT REDEF M CHAR(8);
     2686     2065    1   DCL 1 FLAGS, /* IMTERMEDIATE RESULT */
     2687     2066    1         2 READ BIT(1),
     2688     2067    1         2 DELR BIT(1),
     2689     2068    1         2 WNEW BIT(1),
     2690     2069    1         2 UPD BIT(1),
     2691     2070    1         2 DELF BIT(1),
     2692     2071    1         2 NOLIST BIT(1),
     2693     2072    1         2 REATTR BIT(1),
     2694     2073    1         2 EXEC BIT(1),
     2695     2074    1         2 CREATE BIT(1),
     2696     2075    1         2 ANY BIT(1),
     2697     2076    1         2 * BIT(26);
     2698     2077                    /**/
     2699     2078    1   DCL FMO$LOCCODE ENTRY(2) ALTRET;
     2700     2079    1   DCL FMO$LOCCODT ENTRY(2)ALTRET;
     2701     2080    1   DCL FMR$L8 ENTRY; /* KEEP ACCTX FIXED */
     2702     2081    1   DCL FMR$U8 ENTRY; /* ALSO */
     2703     2082                    /* STATIC */
     2704     2083    1   DCL F$CFU$ PTR SYMREF;
     2705     2084    1   DCL B$JIT$ PTR SYMREF;
     2706     2085    1   DCL FM_SYSACCTX UBIN SYMREF;
     2707     2086                    /* CONSTANT DATA */
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:512  
     2708     2087        %SUB FCG#='0615'O;
     2709     2088        %SUB MID#='16'O;
     2710     2089        %ERRCODE(NAME=FMO$E$NOFILE,COD#=%E$NOFILE);
     2711     2093        %ERRCODE(NAME=FMO$E$NOACCESS,COD#=%E$NOACCESS);
     2712     2097        %ERRCODE(NAME=FMO$E$QSTOW,COD#=%E$QSTOW);
     2713     2101        %ERRCODE(NAME=FMO$E$CLSREL,COD#=%E$CLSREL);
     2714     2105    1   DCL 1 FETCHVEH CONSTANT,
     2715     2106    1         2 * UBIN BYTE UNAL INIT(5),
     2716     2107    1         2 * CHAR(5) INIT('FETCH');
     2717     2108    1   DCL SYSACCT CHAR(8)INIT(':SYS')CONSTANT;
     2718     2109        %EJECT;
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:513  
     2719     2110                    /* PROCDEURE */
     2720     2111    1      JDCB$=B$JIT.DCB$;
     2721     2112    2      IF ADDR(FDFIT)=ADDR(NIL) THEN DO;
     2722     2113    2         FLAGS=F$DCB.FFLG; /* MUST BE CALL FOR SECCHKFD */
     2723     2114    2         GOTO SECCHKFD;
     2724     2115    2         END;
     2725     2116    1      IF F$DCB.IASN~=%FILE# THEN F$DCB.FFLG=F$CFU$->FM$CFUA.DFLTALL;
     2726     2117    1      KP=BITBIN(F$DCB.FFLG); /* REMEMBER THE DEFAULT FOR NON-OWNERS */
     2727     2118    1      F$DCB.FFLG='0'B;
     2728     2119    1      FLAGS=%FFLG_OWNER#;
     2729     2120    1      I=4;
     2730     2121    1      LOC$=ADDR(FM$FIT);
     2731     2122    1      CALL FMO$LOCCODE(LOC$,I) ALTRET(OWNEROK);/*STAR IF ALTRET */
     2732     2123    1      IF CODE04.CREATOR.NAME=B$JIT.UNAME
     2733     2124    2        AND CODE04.CREATOR.ACCT=B$JIT.ACCN THEN DO;
     2734     2125    2         F$DCB.OWNER='1'B;
     2735     2126    2         GOTO OWNEROK;
     2736     2127    2         END;
     2737     2128    2      IF F$DCB.OWNER THEN DO; /* NOT A PROTECTED ACCOUNT */
     2738     2129    2         F$DCB.OWNER='0'B; /* NOT THE FILE'S OWNER */
     2739     2130    2         IF F$DCB.ACCT=B$JIT.ACCN THEN GOTO OWNEROK;
     2740     2131    2         END;
     2741     2132    1      FLAGS=BINBIT(KP,18); /* NOT OWNER, OR ACCOUNT PRIVILEGED */
     2742     2133    2      IF FLAGS=%FFLG_CREATE# THEN DO;
     2743     2134                    /* This is a "write-only" account, so only owned files are visible. */
     2744     2135    2         FLAGS=%FFLG_NOLIST#;
     2745     2136    2         GOTO OWNEROK;
     2746     2137    2         END;
     2747     2138    1   SECCHKFD:;
     2748     2139    1      I=9;
     2749     2140    1      LOC$=ADDR(FM$FIT);
     2750     2141    1      CALL FMO$LOCCODE(LOC$,I) ALTRET(OTHEROK);
     2751     2142    1      I=FM$FIT.CODES.NDW(I)*4;
     2752     2143    1      CFU$=ADDR(NIL);
     2753     2144    1      M.CM=F$DCB.FDCM;
     2754     2145    2      DO WHILE (I>9);
     2755     2146        %LIST;
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:514  
     2756     2147              %WILD_COMPARE(COMP_COUNT=M.C,
     2757     2148              WILD_CHARS=CODE09.ACCT,
     2758     2149              WILD_X=J,
     2759     2150              WILD_XP=JP,
     2760     2151              COMPARE_CHARS=B$JIT.ACCN,
     2761     2152              COMPARE_X=K,
     2762     2153              COMPARE_XP=KP,
     2763     2154              NO_MATCH=GOTO NOMATCH);
              2155        %LSET LISTDIR='0'B;
              2172    2           WILD_XC=CODE09.ACCT;
              2173    3           IF (BINBIT(J,36)&'737737737777'O)='101114114040'O THEN DO;
              2174    3              J=3;
              2175    3              JP=2;
              2176    3              END;
              2186    3           ELSE DO;
              2187    3              J=0;
              2188    3              JP=SIZEC(CODE09.ACCT);
              2189    3              END;
              2190    2           K=0;
              2191    2           KP=0;
              2193    2           M.C=0;
              2195    3           DO WHILE(J<SIZEC(CODE09.ACCT) AND SUBSTR(CODE09.ACCT,J,1)~=' '
              2196    3             OR K<SIZEC(B$JIT.ACCN) AND SUBSTR(B$JIT.ACCN,K,1)~=' ');
              2197    4              IF J<SIZEC(CODE09.ACCT) AND SUBSTR(CODE09.ACCT,J,1)='?' THEN DO;
              2198    4                 JP=J;
              2199    4                 END;
              2200    4              ELSE DO;
              2201    4                 IF J=JP+1 THEN KP=K;
              2202    4                 IF J>=SIZEC(CODE09.ACCT)
              2203    4                   OR K>=SIZEC(B$JIT.ACCN)
              2204    4                   OR SUBSTR(CODE09.ACCT,J,1) ~=
              2205    5                   SUBSTR(B$JIT.ACCN,K,1) THEN DO;
              2206    5                    IF JP=SIZEC(CODE09.ACCT) OR KP=SIZEC(B$JIT.ACCN)
              2207    5                    THEN GOTO NOMATCH;
              2208    5                    J=JP;
              2210    5                    M.C=M.C-K+KP;
              2212    5                    K=KP;
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:515  
              2213    5                    END;
              2215    4                 ELSE M.C=M.C+1;
              2217    4                 K=K+1;
              2218    4                 END;
              2219    3              IF J<SIZEC(CODE09.ACCT) THEN J=J+1;
              2220    3   END;
              2222    2           IF JP=SIZEC(CODE09.ACCT) THEN M.C=SIZEC(CODE09.ACCT);
     2764     2225    3         IF M.C>=M.CM THEN DO;
     2765     2226    3            CFU$=LOC$;
     2766     2227    3            M.CM=M.C;
     2767     2228    3            END;
     2768     2229    2   NOMATCH:;
     2769     2230    2         LOC$=PINCRC(LOC$,10);
     2770     2231    2         I=I-10;
     2771     2232    2         END;
     2772     2233    1      IF CFU$~=ADDR(NIL) THEN FLAGS=CFU$->CODE09.FFLG;
     2773     2234    1      F$DCB.FDCM=M.CM;
     2774     2235                    /**/
     2775     2236    1   OTHEROK:;
     2776     2237    1      IF ADDR(FDFIT)=ADDR(NIL) THEN GOTO NOPASSWD; /* SECCHKFD - nearly done */
     2777     2238    1      IF NOT FLAGS.EXEC THEN GOTO OWNEROK; /* MUST WE CHECK FOR VEHICLE */
     2778     2239    1      FLAGS.EXEC='0'B; /* FLAGS IF NO MATCH */
     2779     2240    1      ACCT$=ADDR(SYSACCT); /* DEFAULT ACCOUNT */
     2780     2241    2      DO CASE (F$DCB.WSR);
     2781     2242    2      CASE(0); /* MONITOR */
     2782     2243    2         CFU$=ADDR(FETCHVEH); /* MOST LIKELY FETCH */
     2783     2244    2         FLAGS=%(FFLG_READ#|FFLG_EXEC#);
     2784     2245    2      CASE(4); /* CP */
     2785     2246    2         CFU$=ADDR(B$P$->B$P.NAME(S$CU$->B$U.ACP));
     2786     2247    2      CASE(5); /* DB */
     2787     2248    2         CFU$=ADDR(B$P$->B$P.NAME(S$CU$->B$U.DB));
     2788     2249    2      CASE(6); /* ASL */
     2789     2250    2         CFU$=ADDR(B$P$->B$P.NAME(S$CU$->B$U.ASL));
     2790     2251    2      CASE(7); /* USER */
     2791     2252    2         IF DCBADDR(2)->F$DCB.WSR=0 AND DCBADDR(2)->F$DCB.FCD
     2792     2253    2           AND DCBADDR(2)->F$DCB.PSN=' '
     2793     2254    3         THEN DO;
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:516  
     2794     2255    3            CFU$=ADDR(DCBADDR(2)->F$DCB.NAME);
     2795     2256    3            ACCT$=ADDR(DCBADDR(2)->F$DCB.ACCT);
     2796     2257    3            END;
     2797     2258    2         ELSE GOTO OWNEROK; /* USE WHAT'S HERE */
     2798     2259    2      CASE(ELSE);
     2799     2260    2         GOTO OWNEROK;
     2800     2261    2      END;
     2801     2262    1      I=10;
     2802     2263    1      LOC$=ADDR(FM$FIT);
     2803     2264    1      CALL FMO$LOCCODE(LOC$,I)ALTRET(OWNEROK);
     2804     2265    1      K=0;
     2805     2266    1      I=FM$FIT.CODES.NDW(I)*4;
     2806     2267    2      DO WHILE(I>=SIZEC(CODE10));
     2807     2268    2         I=I-SIZEC(CODE10);
     2808     2269    2         CALL INDEX1(J,'.',CODE10.ACSVEH.T);
     2809     2270    2         IF J=CODE10.ACSVEH.C THEN TACCT=SYSACCT;
     2810     2271    2         ELSE IF J=CODE10.ACSVEH.C-1 THEN TACCT=F$DCB.ACCT;
     2811     2272    2            ELSE TACCT=SUBSTR(CODE10.ACSVEH.T,J+1);
     2812     2273    2         IF TACCT=ACCT$->BACCT
     2813     2274    3         THEN IF SUBSTR(CODE10.ACSVEH.T,0,J)=CFU$->BACSVEH.C THEN DO;
     2814     2275    3   GOTONE:     ;
     2815     2276    3               K=J;
     2816     2277    3               FLAGS=CODE10.FFLG;
     2817     2278    3               IF FLAGS&~%FFLG_EXEC# THEN FLAGS.EXEC='1'B;
     2818     2279    3               ELSE FLAGS='0'B;
     2819     2280    3               END;
     2820     2281    3            ELSE IF J>K THEN DO;
     2821     2282    3                  J=J-1;
     2822     2283    3                  IF SUBSTR(CODE10.ACSVEH.T,J,1)='?' AND J<=CFU$->BACSVEH.L
     2823     2284    3                    AND SUBSTR(CODE10.ACSVEH.T,0,J)=SUBSTR(CFU$->BACSVEH.C,0,J)
     2824     2285    3                  THEN GOTO GOTONE;
     2825     2286    3                  END;
     2826     2287    2         LOC$=PINCRC(LOC$,SIZEC(CODE10));
     2827     2288    2         END;
     2828     2289        %EJECT;
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:517  
     2829     2290    1   OWNEROK:;
     2830     2291    1      LOC$=ADDR(FM$FIT);
     2831     2292    1      CALL FMO$LOCCODT(LOC$,7)ALTRET(NOPASSWD);
     2832     2293    1      IF NOT F$DCB.PASSF OR F$DCB.PASS~=CODE07.PASS
     2833     2294    1      THEN FLAGS=FLAGS&%FFLG_NOLIST#;
     2834     2295                    /*E*     ERROR: -E$NOACCESS-E
     2835     2296                    *        MESSAGE:Access denied% to %UF% %through %DC%
     2836     2297                    */
     2837     2298    1   NOPASSWD:;
     2838     2299    1      F$DCB.AUTHFFLG=FLAGS;
     2839     2300    2      DO;
     2840     2301    2         IF F$DCB.WSR=1 THEN F$DCB.OWNER='0'B;
     2841     2302    2         ELSE IF NOT B$JIT.PRIV.ACTIVE.FMSEC THEN EXIT;
     2842     2303    2            ELSE IF (FLAGS&%FFLG_WRITE#)~=%FFLG_WRITE# THEN F$DCB.PRIVOPN='1'B;
     2843     2304    2         FLAGS=%FFLG_OWNER#;
     2844     2305    2         END;
     2845     2306    1      IF ADDR(FDFIT)=ADDR(NIL) THEN GOTO NOTFILE; /* SECCHKFD - all done */
     2846     2307    1      IF FLAGS.NOLIST AND NOT B$JIT.PRIV.ACTIVE.FMREAD
     2847     2308    1      THEN GOTO FMOE$NOFILE;
     2848     2309    1      IF F$DCB.FUN=%IN# THEN FLAGS=FLAGS&%FFLG_INFLGS#;
     2849     2310    1      J=F$DCB.STARX-3; /* 0 AND 1 FOR *A AND *S */
     2850     2311    1      IF J<=1 AND F$DCB.WSR>4
     2851     2312    2        OR J=4 AND F$DCB.WSR~=6 THEN DO;
     2852     2313    2         FLAGS=%FFLG_READ#;
     2853     2314    2         F$DCB.AUTHFFLG=%FFLG_READ#;
     2854     2315    2         END;
     2855     2316    2      ELSE IF J<5 THEN DO;
     2856     2317    2            FLAGS=FLAGS|%FFLG_EXEC#;
     2857     2318    2            IF F$DCB.WSR=1 THEN F$DCB.WSR=0;/* ALL IO WILL BE M$M... */
     2858     2319    2            END;
     2859     2320    1      IF F$DCB.FUN=%CREATE#
     2860     2321    1      THEN IF F$DCB.EXIST~=%OLDFILE#
     2861     2322    1           AND (NOT FLAGS.DELF OR J<5) THEN GOTO FMOE$CLSREL;
     2862     2323    1         ELSE IF NOT FLAGS&%FFLG_UPFLGS# THEN GOTO FMOE$NOACCESS;
     2863     2324                    /*E*     ERROR: FMN-E$CLSREL-E
     2864     2325                    *        MESSAGE:You may not replace file %FN
     2865     2326                    */
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:518  
     2866     2327    1      I=3;
     2867     2328    1      LOC$=ADDR(FM$FIT);
     2868     2329    1      CALL FMO$LOCCODE(LOC$,I)ALTRET(NOTFILE);
     2869     2330    1      IF (F$DCB.FUN~=%CREATE# OR F$DCB.EXIST=%OLDFILE#)
     2870     2331    2        AND F$DCB.ASN~=%TAPE# THEN DO;
     2871     2332    2         F$DCB.TYPE=CODE03.TYPE;
     2872     2333    2         F$DCB.ORG=CODE03.ORG;
     2873     2334    2         END;
     2874     2335    1      IF CODE03.DESC.ARCHIVE
     2875     2336    1      THEN IF F$DCB.FUN=%CREATE# THEN GOTO FMOE$QSTOW;
     2876     2337    1         ELSE IF B$JIT.PRIV.ACTIVE.FMEFT THEN FLAGS=FLAGS&%FFLG_INFLGS#;
     2877     2338    1            ELSE FLAGS=FLAGS&%(FFLG_INFLGS#&~FFLG_DELF#);
     2878     2339                    /*E*     ERROR: FMN-E$QSTOW-E
     2879     2340                    *        MESSAGE:File% %FN% is read-only because it is archived.
     2880     2341                    *        MESSAGE1:File% %UF% is stowed or waiting to be stowed.
     2881     2342                    */
     2882     2343    1      IF SUBSTR(CODE03.TYPE,0,1)='*' AND F$DCB.WSR~=0
     2883     2344    2        AND NOT B$JIT.PRIV.ACTIVE.FMSEC THEN DO;
     2884     2345    2         IF FLAGS.READ THEN FLAGS=FLAGS|%FFLG_AURD#; /* LET LIST WORK */
     2885     2346    2         FLAGS=FLAGS&
     2886     2347    2           %(FFLG_DELF#|FFLG_EXEC#|FFLG_CREATE#|FFLG_REATTR#|FFLG_AURD#);
     2887     2348    2         END;
     2888     2349    1      IF CODE03.ORG=%SYMB# THEN FLAGS=FLAGS&~(%FFLG_UPD#|%FFLG_DELR#);
     2889     2350    1      IF CODE03.GHSTACS~=0 THEN F$DCB.GHSTACS=CODE03.GHSTACS;
     2890     2351    1   NOTFILE:;
     2891     2352    2      IF B$JIT.PRIV.ACTIVE.FMREAD AND ADDR(FDFIT)~=ADDR(NIL) THEN DO;
     2892     2353    2         IF F$DCB.STARX~=0 THEN EXIT; /* do nothing for system starfiles */
     2893     2354    2         IF FLAGS.EXEC OR NOT FLAGS.READ THEN F$DCB.PRIVOPN='1'B;
     2894     2355    2         FLAGS=FLAGS&~%FFLG_EXEC#|%FFLG_READ#;
     2895     2356    2         END;
     2896     2357                    /* IF FMREAD PRIV OVERRODE NONE ACCESS, HE GETS ONLY READ */
     2897     2358    1      IF F$DCB.FDCM=511 THEN FLAGS=%FFLG_READ#;
     2898     2359    1      F$DCB.FFLG=FLAGS;
     2899     2360    1      IF F$DCB.FFLG THEN RETURN;
     2900     2361                    /**/
     2901     2362    1   FMOE$NOACCESS: B$JIT.ERR=FMO$E$NOACCESS;
     2902     2363    1      RETURN;
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:519  
     2903     2364    1   FMOE$NOFILE: B$JIT.ERR=FMO$E$NOFILE;
     2904     2365    1      F$DCB.AUTHFFLG='0'B;
     2905     2366    1      RETURN;
     2906     2367    1   FMOE$QSTOW: B$JIT.ERR=FMO$E$QSTOW;
     2907     2368    1      RETURN;
     2908     2369    1   FMOE$CLSREL: B$JIT.ERR=FMO$E$CLSREL;
     2909     2370    1      RETURN;
     2910     2371    1   END FMO$SECCHK;
     2911     2372        %EOD;

PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:520  
--  Include file information  --

   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   B$P.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure FMO$SECCHK.

   Procedure FMO$SECCHK requires 700 words for executable code.
   Procedure FMO$SECCHK requires 20 words of local(AUTO) storage.

PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:521  

 Object Unit name= FMO$SECCHK                                 File name= FMO$OBSE.:E05TOU
 UTS= JUL 29 '97 16:58:37.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     10     12  FMO$SECCHK
    1   Proc  even  none   700   1274  FMO$SECCHK
    2  RoData even  none     9     11  FMO$SECCHK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        2  FMO$SECCHK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 FMO$LOCCODE
 yes     yes           Std       2 FMO$LOCCODT
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$P$                                  S$CU$                                 F$CFU$
     B$JIT$                                B_VECTNIL
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:522  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 ISSID
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:523  


     2634        1        /*T***********************************************************/
     2635        2        /*T*                                                         */
     2636        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2637        4        /*T*                                                         */
     2638        5        /*T***********************************************************/
     2639        6                    /*F*
     2640        7                    *     NAME:   FMO$SECCHK
     2641        8                    *
     2642        9                    *     PURPOSE:  TO CHECK THE SECURITY OF THE FILE IN CONJUNCTION
     2643       10                    *               WITH THE CURRENT OPEN REQUEST.
     2644       11                    */
     2645       12        FMO$SECCHK: PROC(FDFIT,FM$FIT);

     12  1 000000   000000 700200 xent  FMO$SECCHK   TSX0  ! X66_AUTO_2
         1 000001   000024 000002                    ZERO    20,2

     2646       13    1   DCL FDFIT UBIN;/* THIS PARAMEWTER IS PRESENT, BUT UNUSED, IF NOT SECCHKFD */
     2647       14        %INCLUDE FM$MACROS;
     2648      389        %FM$FIT(BASED=" ");
     2649      392        %CODE03(BASED="BASED(LOC$)");
     2650      399        %CODE04(BASED="BASED(LOC$)");
     2651      407        %CODE07(BASED="BASED(LOC$)");
     2652      410        %CODE09(BASED="BASED(LOC$)");
     2653      414        %CODE10(BASED="BASED(LOC$)");
     2654      418        %FM$CFU(BASED="BASED(CFU$)");
     2655      424        %FM$CFUA(BASED="BASED(CFU$)");
     2656      430        %INCLUDE F_ERRORS_C;
     2657      670        %INCLUDE F$JIT_C;
     2658     1100        %MACRO F$DCB#(BASED=BASED);
     2659     1101        %INCLUDE F$DCB;
     2660     1150        %MEND;
     2661     1151        %F$DCB#(BASED="BASED(JDCB$)");
     2662     1201        %INCLUDE CP_6_SUBS;
     2663     1741        %INCLUDE B$P;
     2664     1825        %INCLUDE B$USER;
     2665     2041        %B$USERREFS;
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:524  
     2666     2045    1   DCL 1 BACSVEH BASED,
     2667     2046    1         2 L UBIN BYTE UNAL,
     2668     2047    1         2 C CHAR(BACSVEH.L);
     2669     2048    1   DCL BACCT BASED CHAR(8);
     2670     2049                    /**/
     2671     2050                    /* AUTO DATA */
     2672     2051    1   DCL JDCB$ PTR; /* DCB POINTER */
     2673     2052    1   DCL LOC$ PTR; /* FITCODE PTR */
     2674     2053    1   DCL CFU$ PTR; /* CFU AREA PINTER */
     2675     2054    1   DCL I UBIN;
     2676     2055    1   DCL J UBIN;
     2677     2056    1   DCL WILD_XC REDEF J CHAR(4);
     2678     2057    1   DCL K UBIN;
     2679     2058    1   DCL JP UBIN;
     2680     2059    1   DCL KP UBIN;
     2681     2060    1   DCL ACCT$ REDEF KP PTR;
     2682     2061    1   DCL 1 M,
     2683     2062    1         2 CM UBIN,
     2684     2063    1         2 C SBIN;
     2685     2064    1   DCL TACCT REDEF M CHAR(8);
     2686     2065    1   DCL 1 FLAGS, /* IMTERMEDIATE RESULT */
     2687     2066    1         2 READ BIT(1),
     2688     2067    1         2 DELR BIT(1),
     2689     2068    1         2 WNEW BIT(1),
     2690     2069    1         2 UPD BIT(1),
     2691     2070    1         2 DELF BIT(1),
     2692     2071    1         2 NOLIST BIT(1),
     2693     2072    1         2 REATTR BIT(1),
     2694     2073    1         2 EXEC BIT(1),
     2695     2074    1         2 CREATE BIT(1),
     2696     2075    1         2 ANY BIT(1),
     2697     2076    1         2 * BIT(26);
     2698     2077                    /**/
     2699     2078    1   DCL FMO$LOCCODE ENTRY(2) ALTRET;
     2700     2079    1   DCL FMO$LOCCODT ENTRY(2)ALTRET;
     2701     2080    1   DCL FMR$L8 ENTRY; /* KEEP ACCTX FIXED */
     2702     2081    1   DCL FMR$U8 ENTRY; /* ALSO */
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:525  
     2703     2082                    /* STATIC */
     2704     2083    1   DCL F$CFU$ PTR SYMREF;
     2705     2084    1   DCL B$JIT$ PTR SYMREF;
     2706     2085    1   DCL FM_SYSACCTX UBIN SYMREF;
     2707     2086                    /* CONSTANT DATA */
     2708     2087        %SUB FCG#='0615'O;
     2709     2088        %SUB MID#='16'O;
     2710     2089        %ERRCODE(NAME=FMO$E$NOFILE,COD#=%E$NOFILE);
     2711     2093        %ERRCODE(NAME=FMO$E$NOACCESS,COD#=%E$NOACCESS);
     2712     2097        %ERRCODE(NAME=FMO$E$QSTOW,COD#=%E$QSTOW);
     2713     2101        %ERRCODE(NAME=FMO$E$CLSREL,COD#=%E$CLSREL);
     2714     2105    1   DCL 1 FETCHVEH CONSTANT,
     2715     2106    1         2 * UBIN BYTE UNAL INIT(5),
     2716     2107    1         2 * CHAR(5) INIT('FETCH');
     2717     2108    1   DCL SYSACCT CHAR(8)INIT(':SYS')CONSTANT;
     2718     2109        %EJECT;
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:526  
     2719     2110                    /* PROCDEURE */
     2720     2111    1      JDCB$=B$JIT.DCB$;

   2111  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   000232 236100                    LDQ     154,,PR0
         1 000004   200005 756100                    STQ     JDCB$,,AUTO

     2721     2112    2      IF ADDR(FDFIT)=ADDR(NIL) THEN DO;

   2112  1 000005   200003 236100                    LDQ     @FDFIT,,AUTO
         1 000006   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000007   000015 601000 1                  TNZ     s:2116

     2722     2113    2         FLAGS=F$DCB.FFLG; /* MUST BE CALL FOR SECCHKFD */

   2113  1 000010   200005 471500                    LDP1    JDCB$,,AUTO
         1 000011   100004 236100                    LDQ     4,,PR1
         1 000012   777777 376003                    ANQ     -1,DU
         1 000013   200017 756100                    STQ     FLAGS,,AUTO

     2723     2114    2         GOTO SECCHKFD;

   2114  1 000014   000110 710000 1                  TRA     SECCHKFD

     2724     2115    2         END;
     2725     2116    1      IF F$DCB.IASN~=%FILE# THEN F$DCB.FFLG=F$CFU$->FM$CFUA.DFLTALL;

   2116  1 000015   200005 471500                    LDP1    JDCB$,,AUTO
         1 000016   100103 236100                    LDQ     67,,PR1
         1 000017   000777 376007                    ANQ     511,DL
         1 000020   000001 116007                    CMPQ    1,DL
         1 000021   000025 600000 1                  TZE     s:2117

   2116  1 000022   000000 473400 xsym               LDP3    F$CFU$
         1 000023   300006 720100                    LXL0    6,,PR3
         1 000024   100004 740100                    STX0    4,,PR1

PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:527  
     2726     2117    1      KP=BITBIN(F$DCB.FFLG); /* REMEMBER THE DEFAULT FOR NON-OWNERS */

   2117  1 000025   100004 236100                    LDQ     4,,PR1
         1 000026   000022 772000                    QRL     18
         1 000027   200014 756100                    STQ     KP,,AUTO

     2727     2118    1      F$DCB.FFLG='0'B;

   2118  1 000030   000000 220003                    LDX0    0,DU
         1 000031   100004 740100                    STX0    4,,PR1

     2728     2119    1      FLAGS=%FFLG_OWNER#;

   2119  1 000032   765700 236003                    LDQ     -5184,DU
         1 000033   200017 756100                    STQ     FLAGS,,AUTO

     2729     2120    1      I=4;

   2120  1 000034   000004 235007                    LDA     4,DL
         1 000035   200010 755100                    STA     I,,AUTO

     2730     2121    1      LOC$=ADDR(FM$FIT);

   2121  1 000036   200004 236100                    LDQ     @FM$FIT,,AUTO
         1 000037   200006 756100                    STQ     LOC$,,AUTO

     2731     2122    1      CALL FMO$LOCCODE(LOC$,I) ALTRET(OWNEROK);/*STAR IF ALTRET */

   2122  1 000040   200010 633500                    EPPR3   I,,AUTO
         1 000041   200021 453500                    STP3    FLAGS+2,,AUTO
         1 000042   200006 634500                    EPPR4   LOC$,,AUTO
         1 000043   200020 454500                    STP4    FLAGS+1,,AUTO
         1 000044   200020 630500                    EPPR0   FLAGS+1,,AUTO
         1 000045   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000046   000000 701000 xent               TSX1    FMO$LOCCODE
         1 000047   000712 702000 1                  TSX2    OWNEROK

PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:528  
     2732     2123    1      IF CODE04.CREATOR.NAME=B$JIT.UNAME

   2123  1 000050   200006 470500                    LDP0    LOC$,,AUTO
         1 000051   000000 471400 xsym               LDP1    B$JIT$
         1 000052   040100 106500                    CMPC    fill='040'O
         1 000053   000005 000014                    ADSC9   5,,PR0                   cn=0,n=12
         1 000054   100003 000014                    ADSC9   3,,PR1                   cn=0,n=12
         1 000055   000066 601000 1                  TNZ     s:2128
         1 000056   040100 106500                    CMPC    fill='040'O
         1 000057   000003 000010                    ADSC9   3,,PR0                   cn=0,n=8
         1 000060   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         1 000061   000066 601000 1                  TNZ     s:2128

     2733     2124    2        AND CODE04.CREATOR.ACCT=B$JIT.ACCN THEN DO;

     2734     2125    2         F$DCB.OWNER='1'B;

   2125  1 000062   200005 473500                    LDP3    JDCB$,,AUTO
         1 000063   040000 236007                    LDQ     16384,DL
         1 000064   300064 256100                    ORSQ    52,,PR3

     2735     2126    2         GOTO OWNEROK;

   2126  1 000065   000712 710000 1                  TRA     OWNEROK

     2736     2127    2         END;
     2737     2128    2      IF F$DCB.OWNER THEN DO; /* NOT A PROTECTED ACCOUNT */

   2128  1 000066   200005 473500                    LDP3    JDCB$,,AUTO
         1 000067   300064 236100                    LDQ     52,,PR3
         1 000070   040000 316007                    CANQ    16384,DL
         1 000071   000100 600000 1                  TZE     s:2132

     2738     2129    2         F$DCB.OWNER='0'B; /* NOT THE FILE'S OWNER */

   2129  1 000072   000000 236000 2                  LDQ     0
         1 000073   300064 356100                    ANSQ    52,,PR3
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:529  

     2739     2130    2         IF F$DCB.ACCT=B$JIT.ACCN THEN GOTO OWNEROK;

   2130  1 000074   040100 106500                    CMPC    fill='040'O
         1 000075   300020 000010                    ADSC9   16,,PR3                  cn=0,n=8
         1 000076   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         1 000077   000712 600000 1                  TZE     OWNEROK

     2740     2131    2         END;

     2741     2132    1      FLAGS=BINBIT(KP,18); /* NOT OWNER, OR ACCOUNT PRIVILEGED */

   2132  1 000100   200014 236100                    LDQ     KP,,AUTO
         1 000101   000022 736000                    QLS     18
         1 000102   200017 756100                    STQ     FLAGS,,AUTO

     2742     2133    2      IF FLAGS=%FFLG_CREATE# THEN DO;

   2133  1 000103   001000 116003                    CMPQ    512,DU
         1 000104   000110 601000 1                  TNZ     SECCHKFD

     2743     2134                    /* This is a "write-only" account, so only owned files are visible. */
     2744     2135    2         FLAGS=%FFLG_NOLIST#;

   2135  1 000105   010000 236003                    LDQ     4096,DU
         1 000106   200017 756100                    STQ     FLAGS,,AUTO

     2745     2136    2         GOTO OWNEROK;

   2136  1 000107   000712 710000 1                  TRA     OWNEROK

   2133  1 000110                       SECCHKFD     null
     2746     2137    2         END;
     2747     2138    1   SECCHKFD:;
     2748     2139    1      I=9;

   2139  1 000110   000011 235007                    LDA     9,DL
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:530  
         1 000111   200010 755100                    STA     I,,AUTO

     2749     2140    1      LOC$=ADDR(FM$FIT);

   2140  1 000112   200004 236100                    LDQ     @FM$FIT,,AUTO
         1 000113   200006 756100                    STQ     LOC$,,AUTO

     2750     2141    1      CALL FMO$LOCCODE(LOC$,I) ALTRET(OTHEROK);

   2141  1 000114   200010 630500                    EPPR0   I,,AUTO
         1 000115   200021 450500                    STP0    FLAGS+2,,AUTO
         1 000116   200006 631500                    EPPR1   LOC$,,AUTO
         1 000117   200020 451500                    STP1    FLAGS+1,,AUTO
         1 000120   200020 630500                    EPPR0   FLAGS+1,,AUTO
         1 000121   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000122   000000 701000 xent               TSX1    FMO$LOCCODE
         1 000123   000333 702000 1                  TSX2    OTHEROK

     2751     2142    1      I=FM$FIT.CODES.NDW(I)*4;

   2142  1 000124   200004 470500                    LDP0    @FM$FIT,,AUTO
         1 000125   200010 720100                    LXL0    I,,AUTO
         1 000126   000000 236110                    LDQ     0,X0,PR0
         1 000127   000010 772000                    QRL     8
         1 000130   007774 376007                    ANQ     4092,DL
         1 000131   200010 756100                    STQ     I,,AUTO

     2752     2143    1      CFU$=ADDR(NIL);

   2143  1 000132   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000133   200007 756100                    STQ     CFU$,,AUTO

     2753     2144    1      M.CM=F$DCB.FDCM;

   2144  1 000134   200005 471500                    LDP1    JDCB$,,AUTO
         1 000135   100073 236100                    LDQ     59,,PR1
         1 000136   000777 376007                    ANQ     511,DL
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:531  
         1 000137   200015 756100                    STQ     M,,AUTO

     2754     2145    2      DO WHILE (I>9);

   2145  1 000140   200010 235100                    LDA     I,,AUTO
         1 000141   000012 115007                    CMPA    10,DL
         1 000142   000321 602000 1                  TNC     s:2233

     2755     2146        %LIST;
     2756     2147              %WILD_COMPARE(COMP_COUNT=M.C,
     2757     2148              WILD_CHARS=CODE09.ACCT,
     2758     2149              WILD_X=J,
     2759     2150              WILD_XP=JP,
     2760     2151              COMPARE_CHARS=B$JIT.ACCN,
     2761     2152              COMPARE_X=K,
     2762     2153              COMPARE_XP=KP,
     2763     2154              NO_MATCH=GOTO NOMATCH);
              2155        %LSET LISTDIR='0'B;
              2172    2           WILD_XC=CODE09.ACCT;

   2172  1 000143   200006 470500                    LDP0    LOC$,,AUTO
         1 000144   040100 100500                    MLR     fill='040'O
         1 000145   000000 400004                    ADSC9   0,,PR0                   cn=2,n=4
         1 000146   200011 000004                    ADSC9   J,,AUTO                  cn=0,n=4

              2173    3           IF (BINBIT(J,36)&'737737737777'O)='101114114040'O THEN DO;

   2173  1 000147   200011 236100                    LDQ     J,,AUTO
         1 000150   000010 376000 0                  ANQ     SYSACCT+2
         1 000151   000011 116000 0                  CMPQ    SYSACCT+3
         1 000152   000160 601000 1                  TNZ     s:2187

              2174    3              J=3;

   2174  1 000153   000003 235007                    LDA     3,DL
         1 000154   200011 755100                    STA     J,,AUTO

PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:532  
              2175    3              JP=2;

   2175  1 000155   000002 236007                    LDQ     2,DL
         1 000156   200013 756100                    STQ     JP,,AUTO

              2176    3              END;

   2176  1 000157   000163 710000 1                  TRA     s:2190

              2186    3           ELSE DO;

              2187    3              J=0;

   2187  1 000160   200011 450100                    STZ     J,,AUTO

              2188    3              JP=SIZEC(CODE09.ACCT);

   2188  1 000161   000010 235007                    LDA     8,DL
         1 000162   200013 755100                    STA     JP,,AUTO

              2189    3              END;

              2190    2           K=0;

   2190  1 000163   200012 450100                    STZ     K,,AUTO

              2191    2           KP=0;

   2191  1 000164   200014 450100                    STZ     KP,,AUTO

              2193    2           M.C=0;

   2193  1 000165   200016 450100                    STZ     M+1,,AUTO

              2195    3           DO WHILE(J<SIZEC(CODE09.ACCT) AND SUBSTR(CODE09.ACCT,J,1)~=' '

   2195  1 000166   000254 710000 1                  TRA     s:2220
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:533  

              2196    3             OR K<SIZEC(B$JIT.ACCN) AND SUBSTR(B$JIT.ACCN,K,1)~=' ');
              2197    4              IF J<SIZEC(CODE09.ACCT) AND SUBSTR(CODE09.ACCT,J,1)='?' THEN DO;

   2197  1 000167   200011 235100                    LDA     J,,AUTO
         1 000170   000010 115007                    CMPA    8,DL
         1 000171   000201 603000 1                  TRC     s:2201
         1 000172   200006 470500                    LDP0    LOC$,,AUTO
         1 000173   040000 106505                    CMPC    fill='040'O
         1 000174   000000 400001                    ADSC9   0,A,PR0                  cn=2,n=1
         1 000175   000001 000001 2                  ADSC9   1                        cn=0,n=1
         1 000176   000201 601000 1                  TNZ     s:2201

              2198    4                 JP=J;

   2198  1 000177   200013 755100                    STA     JP,,AUTO

              2199    4                 END;

   2199  1 000200   000247 710000 1                  TRA     s:2219

              2200    4              ELSE DO;

              2201    4                 IF J=JP+1 THEN KP=K;

   2201  1 000201   200013 236100                    LDQ     JP,,AUTO
         1 000202   000001 036007                    ADLQ    1,DL
         1 000203   200011 116100                    CMPQ    J,,AUTO
         1 000204   000207 601000 1                  TNZ     s:2202

   2201  1 000205   200012 235100                    LDA     K,,AUTO
         1 000206   200014 755100                    STA     KP,,AUTO

              2202    4                 IF J>=SIZEC(CODE09.ACCT)

   2202  1 000207   200011 235100                    LDA     J,,AUTO
         1 000210   000010 115007                    CMPA    8,DL
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:534  
         1 000211   000225 603000 1                  TRC     s:2206
         1 000212   200012 235100                    LDA     K,,AUTO
         1 000213   000010 115007                    CMPA    8,DL
         1 000214   000225 603000 1                  TRC     s:2206
         1 000215   200006 470500                    LDP0    LOC$,,AUTO
         1 000216   200011 235100                    LDA     J,,AUTO
         1 000217   000000 471400 xsym               LDP1    B$JIT$
         1 000220   200012 236100                    LDQ     K,,AUTO
         1 000221   040106 106505                    CMPC    fill='040'O
         1 000222   000000 400001                    ADSC9   0,A,PR0                  cn=2,n=1
         1 000223   100001 000001                    ADSC9   1,Q,PR1                  cn=0,n=1
         1 000224   000243 600000 1                  TZE     s:2215

              2203    4                   OR K>=SIZEC(B$JIT.ACCN)
              2204    4                   OR SUBSTR(CODE09.ACCT,J,1) ~=
              2205    5                   SUBSTR(B$JIT.ACCN,K,1) THEN DO;

              2206    5                    IF JP=SIZEC(CODE09.ACCT) OR KP=SIZEC(B$JIT.ACCN)

   2206  1 000225   200013 235100                    LDA     JP,,AUTO
         1 000226   000010 115007                    CMPA    8,DL
         1 000227   000311 600000 1                  TZE     NOMATCH
         1 000230   200014 236100                    LDQ     KP,,AUTO
         1 000231   000010 116007                    CMPQ    8,DL
         1 000232   000311 600000 1                  TZE     NOMATCH

              2207    5                    THEN GOTO NOMATCH;
              2208    5                    J=JP;

   2208  1 000233   200011 755100                    STA     J,,AUTO

              2210    5                    M.C=M.C-K+KP;

   2210  1 000234   200016 236100                    LDQ     M+1,,AUTO
         1 000235   200012 136100                    SBLQ    K,,AUTO
         1 000236   200014 036100                    ADLQ    KP,,AUTO
         1 000237   200016 756100                    STQ     M+1,,AUTO
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:535  

              2212    5                    K=KP;

   2212  1 000240   200014 235100                    LDA     KP,,AUTO
         1 000241   200012 755100                    STA     K,,AUTO

              2213    5                    END;

   2213  1 000242   000244 710000 1                  TRA     s:2217

              2215    4                 ELSE M.C=M.C+1;

   2215  1 000243   200016 054100                    AOS     M+1,,AUTO

              2217    4                 K=K+1;

   2217  1 000244   200012 235100                    LDA     K,,AUTO
         1 000245   000001 035007                    ADLA    1,DL
         1 000246   200012 755100                    STA     K,,AUTO

              2218    4                 END;

              2219    3              IF J<SIZEC(CODE09.ACCT) THEN J=J+1;

   2219  1 000247   200011 235100                    LDA     J,,AUTO
         1 000250   000010 115007                    CMPA    8,DL
         1 000251   000254 603000 1                  TRC     s:2220

   2219  1 000252   000001 035007                    ADLA    1,DL
         1 000253   200011 755100                    STA     J,,AUTO

              2220    3   END;

   2220  1 000254   200011 235100                    LDA     J,,AUTO
         1 000255   000010 115007                    CMPA    8,DL
         1 000256   000264 603000 1                  TRC     s:2220+8
         1 000257   200006 470500                    LDP0    LOC$,,AUTO
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:536  
         1 000260   040000 106505                    CMPC    fill='040'O
         1 000261   000000 400001                    ADSC9   0,A,PR0                  cn=2,n=1
         1 000262   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000263   000167 601000 1                  TNZ     s:2197
         1 000264   200012 236100                    LDQ     K,,AUTO
         1 000265   000010 116007                    CMPQ    8,DL
         1 000266   000274 603000 1                  TRC     s:2222
         1 000267   000000 470400 xsym               LDP0    B$JIT$
         1 000270   040000 106506                    CMPC    fill='040'O
         1 000271   000001 000001                    ADSC9   1,Q,PR0                  cn=0,n=1
         1 000272   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000273   000167 601000 1                  TNZ     s:2197

              2222    2           IF JP=SIZEC(CODE09.ACCT) THEN M.C=SIZEC(CODE09.ACCT);

   2222  1 000274   200013 235100                    LDA     JP,,AUTO
         1 000275   000010 115007                    CMPA    8,DL
         1 000276   000301 601000 1                  TNZ     s:2225

   2222  1 000277   000010 235007                    LDA     8,DL
         1 000300   200016 755100                    STA     M+1,,AUTO

     2764     2225    3         IF M.C>=M.CM THEN DO;

   2225  1 000301   200016 236100                    LDQ     M+1,,AUTO
         1 000302   000311 604000 1                  TMI     NOMATCH
         1 000303   200015 116100                    CMPQ    M,,AUTO
         1 000304   000311 602000 1                  TNC     NOMATCH

     2765     2226    3            CFU$=LOC$;

   2226  1 000305   200006 236100                    LDQ     LOC$,,AUTO
         1 000306   200007 756100                    STQ     CFU$,,AUTO

     2766     2227    3            M.CM=M.C;

   2227  1 000307   200016 235100                    LDA     M+1,,AUTO
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:537  
         1 000310   200015 755100                    STA     M,,AUTO

     2767     2228    3            END;

   2225  1 000311                       NOMATCH      null
     2768     2229    2   NOMATCH:;
     2769     2230    2         LOC$=PINCRC(LOC$,10);

   2230  1 000311   200006 236100                    LDQ     LOC$,,AUTO
         1 000312   000002 036000 2                  ADLQ    2
         1 000313   200006 756100                    STQ     LOC$,,AUTO

     2770     2231    2         I=I-10;

   2231  1 000314   200010 235100                    LDA     I,,AUTO
         1 000315   000012 135007                    SBLA    10,DL
         1 000316   200010 755100                    STA     I,,AUTO

     2771     2232    2         END;

   2232  1 000317   000012 115007                    CMPA    10,DL
         1 000320   000143 603000 1                  TRC     s:2172

     2772     2233    1      IF CFU$~=ADDR(NIL) THEN FLAGS=CFU$->CODE09.FFLG;

   2233  1 000321   200007 236100                    LDQ     CFU$,,AUTO
         1 000322   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000323   000330 600000 1                  TZE     s:2234

   2233  1 000324   200007 470500                    LDP0    CFU$,,AUTO
         1 000325   000100 100500                    MLR     fill='000'O
         1 000326   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         1 000327   200017 000004                    ADSC9   FLAGS,,AUTO              cn=0,n=4

     2773     2234    1      F$DCB.FDCM=M.CM;

   2234  1 000330   200005 470500                    LDP0    JDCB$,,AUTO
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:538  
         1 000331   200015 236100                    LDQ     M,,AUTO
         1 000332   000073 552104                    STBQ    59,'04'O,PR0

   2234  1 000333                       OTHEROK      null
     2774     2235                    /**/
     2775     2236    1   OTHEROK:;
     2776     2237    1      IF ADDR(FDFIT)=ADDR(NIL) THEN GOTO NOPASSWD; /* SECCHKFD - nearly done */

   2237  1 000333   200003 236100                    LDQ     @FDFIT,,AUTO
         1 000334   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000335   000740 600000 1                  TZE     NOPASSWD

     2777     2238    1      IF NOT FLAGS.EXEC THEN GOTO OWNEROK; /* MUST WE CHECK FOR VEHICLE */

   2238  1 000336   200017 236100                    LDQ     FLAGS,,AUTO
         1 000337   002000 316003                    CANQ    1024,DU
         1 000340   000712 600000 1                  TZE     OWNEROK

     2778     2239    1      FLAGS.EXEC='0'B; /* FLAGS IF NO MATCH */

   2239  1 000341   000003 236000 2                  LDQ     3
         1 000342   200017 356100                    ANSQ    FLAGS,,AUTO

     2779     2240    1      ACCT$=ADDR(SYSACCT); /* DEFAULT ACCOUNT */

   2240  1 000343   000004 236000 2                  LDQ     4
         1 000344   200014 756100                    STQ     KP,,AUTO

     2780     2241    2      DO CASE (F$DCB.WSR);

   2241  1 000345   200005 470500                    LDP0    JDCB$,,AUTO
         1 000346   000040 220100                    LDX0    32,,PR0
         1 000347   000777 360003                    ANX0    511,DU
         1 000350   000010 100003                    CMPX0   8,DU
         1 000351   000353 602010 1                  TNC     s:2241+6,X0
         1 000352   000447 710000 1                  TRA     s:2260
         1 000353   000363 710000 1                  TRA     s:2243
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:539  
         1 000354   000447 710000 1                  TRA     s:2260
         1 000355   000447 710000 1                  TRA     s:2260
         1 000356   000447 710000 1                  TRA     s:2260
         1 000357   000370 710000 1                  TRA     s:2246
         1 000360   000402 710000 1                  TRA     s:2248
         1 000361   000414 710000 1                  TRA     s:2250
         1 000362   000425 710000 1                  TRA     s:2252

     2781     2242    2      CASE(0); /* MONITOR */

     2782     2243    2         CFU$=ADDR(FETCHVEH); /* MOST LIKELY FETCH */

   2243  1 000363   000005 236000 2                  LDQ     5
         1 000364   200007 756100                    STQ     CFU$,,AUTO

     2783     2244    2         FLAGS=%(FFLG_READ#|FFLG_EXEC#);

   2244  1 000365   402000 236003                    LDQ     -130048,DU
         1 000366   200017 756100                    STQ     FLAGS,,AUTO
         1 000367   000450 710000 1                  TRA     s:2262

     2784     2245    2      CASE(4); /* CP */

     2785     2246    2         CFU$=ADDR(B$P$->B$P.NAME(S$CU$->B$U.ACP));

   2246  1 000370   000000 471400 xsym               LDP1    S$CU$
         1 000371   100006 236100                    LDQ     6,,PR1
         1 000372   000022 772000                    QRL     18
         1 000373   000777 376007                    ANQ     511,DL
         1 000374   000021 402007                    MPY     17,DL
         1 000375   000023 736000                    QLS     19
         1 000376   000032 036003                    ADLQ    26,DU
         1 000377   000000 036000 xsym               ADLQ    B$P$
         1 000400   200007 756100                    STQ     CFU$,,AUTO
         1 000401   000450 710000 1                  TRA     s:2262

     2786     2247    2      CASE(5); /* DB */
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:540  

     2787     2248    2         CFU$=ADDR(B$P$->B$P.NAME(S$CU$->B$U.DB));

   2248  1 000402   000000 471400 xsym               LDP1    S$CU$
         1 000403   100006 236100                    LDQ     6,,PR1
         1 000404   000011 772000                    QRL     9
         1 000405   000777 376007                    ANQ     511,DL
         1 000406   000021 402007                    MPY     17,DL
         1 000407   000023 736000                    QLS     19
         1 000410   000032 036003                    ADLQ    26,DU
         1 000411   000000 036000 xsym               ADLQ    B$P$
         1 000412   200007 756100                    STQ     CFU$,,AUTO
         1 000413   000450 710000 1                  TRA     s:2262

     2788     2249    2      CASE(6); /* ASL */

     2789     2250    2         CFU$=ADDR(B$P$->B$P.NAME(S$CU$->B$U.ASL));

   2250  1 000414   000000 471400 xsym               LDP1    S$CU$
         1 000415   100006 236100                    LDQ     6,,PR1
         1 000416   000777 376007                    ANQ     511,DL
         1 000417   000021 402007                    MPY     17,DL
         1 000420   000023 736000                    QLS     19
         1 000421   000032 036003                    ADLQ    26,DU
         1 000422   000000 036000 xsym               ADLQ    B$P$
         1 000423   200007 756100                    STQ     CFU$,,AUTO
         1 000424   000450 710000 1                  TRA     s:2262

     2790     2251    2      CASE(7); /* USER */

     2791     2252    2         IF DCBADDR(2)->F$DCB.WSR=0 AND DCBADDR(2)->F$DCB.FCD

   2252  1 000425   000006 471400 2                  LDP1    6
         1 000426   100000 473500                    LDP3    0,,PR1
         1 000427   300002 474500                    LDP4    2,,PR3
         1 000430   400040 236100                    LDQ     32,,PR4
         1 000431   000777 316003                    CANQ    511,DU
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:541  
         1 000432   000712 601000 1                  TNZ     OWNEROK
         1 000433   400031 236100                    LDQ     25,,PR4
         1 000434   020000 316007                    CANQ    8192,DL
         1 000435   000712 600000 1                  TZE     OWNEROK
         1 000436   040000 106500                    CMPC    fill='040'O
         1 000437   400024 000006                    ADSC9   20,,PR4                  cn=0,n=6
         1 000440   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000441   000712 601000 1                  TNZ     OWNEROK

     2792     2253    2           AND DCBADDR(2)->F$DCB.PSN=' '
     2793     2254    3         THEN DO;

     2794     2255    3            CFU$=ADDR(DCBADDR(2)->F$DCB.NAME);

   2255  1 000442   400010 635500                    EPPR5   8,,PR4
         1 000443   200007 455500                    STP5    CFU$,,AUTO

     2795     2256    3            ACCT$=ADDR(DCBADDR(2)->F$DCB.ACCT);

   2256  1 000444   400020 636500                    EPPR6   16,,PR4
         1 000445   200014 456500                    STP6    KP,,AUTO

     2796     2257    3            END;

   2257  1 000446   000450 710000 1                  TRA     s:2262

     2797     2258    2         ELSE GOTO OWNEROK; /* USE WHAT'S HERE */
     2798     2259    2      CASE(ELSE);

     2799     2260    2         GOTO OWNEROK;

   2260  1 000447   000712 710000 1                  TRA     OWNEROK

     2800     2261    2      END;

     2801     2262    1      I=10;

PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:542  
   2262  1 000450   000012 235007                    LDA     10,DL
         1 000451   200010 755100                    STA     I,,AUTO

     2802     2263    1      LOC$=ADDR(FM$FIT);

   2263  1 000452   200004 236100                    LDQ     @FM$FIT,,AUTO
         1 000453   200006 756100                    STQ     LOC$,,AUTO

     2803     2264    1      CALL FMO$LOCCODE(LOC$,I)ALTRET(OWNEROK);

   2264  1 000454   200010 631500                    EPPR1   I,,AUTO
         1 000455   200021 451500                    STP1    FLAGS+2,,AUTO
         1 000456   200006 633500                    EPPR3   LOC$,,AUTO
         1 000457   200020 453500                    STP3    FLAGS+1,,AUTO
         1 000460   200020 630500                    EPPR0   FLAGS+1,,AUTO
         1 000461   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000462   000000 701000 xent               TSX1    FMO$LOCCODE
         1 000463   000712 702000 1                  TSX2    OWNEROK

     2804     2265    1      K=0;

   2265  1 000464   200012 450100                    STZ     K,,AUTO

     2805     2266    1      I=FM$FIT.CODES.NDW(I)*4;

   2266  1 000465   200004 470500                    LDP0    @FM$FIT,,AUTO
         1 000466   200010 720100                    LXL0    I,,AUTO
         1 000467   000000 236110                    LDQ     0,X0,PR0
         1 000470   000010 772000                    QRL     8
         1 000471   007774 376007                    ANQ     4092,DL
         1 000472   200010 756100                    STQ     I,,AUTO

     2806     2267    2      DO WHILE(I>=SIZEC(CODE10));

   2267  1 000473   000677 710000 1                  TRA     s:2288

     2807     2268    2         I=I-SIZEC(CODE10);
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:543  

   2268  1 000474   200006 470500                    LDP0    LOC$,,AUTO
         1 000475   000100 101500                    MRL     fill='000'O
         1 000476   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         1 000477   200020 000002                    ADSC9   FLAGS+1,,AUTO            cn=0,n=2
         1 000500   200020 220100                    LDX0    FLAGS+1,,AUTO
         1 000501   000003 621010                    EAX1    3,X0
         1 000502   000000 635011                    EAA     0,X1
         1 000503   000022 771000                    ARL     18
         1 000504   200021 755100                    STA     FLAGS+2,,AUTO
         1 000505   200010 236100                    LDQ     I,,AUTO
         1 000506   200021 136100                    SBLQ    FLAGS+2,,AUTO
         1 000507   200010 756100                    STQ     I,,AUTO

     2808     2269    2         CALL INDEX1(J,'.',CODE10.ACSVEH.T);

   2269  1 000510   000100 101500                    MRL     fill='000'O
         1 000511   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         1 000512   200020 000002                    ADSC9   FLAGS+1,,AUTO            cn=0,n=2
         1 000513   200020 220100                    LDX0    FLAGS+1,,AUTO
         1 000514   000000 124540                    SCM     mask='000'O
         1 000515   000000 600010                    ADSC9   0,,PR0                   cn=3,n=*X0
         1 000516   000007 000001 2                  ADSC9   7                        cn=0,n=1
         1 000517   200011 000100                    ARG     J,,AUTO

     2809     2270    2         IF J=CODE10.ACSVEH.C THEN TACCT=SYSACCT;

   2270  1 000520   000100 101500                    MRL     fill='000'O
         1 000521   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         1 000522   200020 000004                    ADSC9   FLAGS+1,,AUTO            cn=0,n=4
         1 000523   200020 236100                    LDQ     FLAGS+1,,AUTO
         1 000524   200011 116100                    CMPQ    J,,AUTO
         1 000525   000532 601000 1                  TNZ     s:2271

   2270  1 000526   000006 237000 0                  LDAQ    SYSACCT
         1 000527   200015 755100                    STA     M,,AUTO
         1 000530   200016 756100                    STQ     M+1,,AUTO
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:544  
         1 000531   000563 710000 1                  TRA     s:2273

     2810     2271    2         ELSE IF J=CODE10.ACSVEH.C-1 THEN TACCT=F$DCB.ACCT;

   2271  1 000532   000100 101500                    MRL     fill='000'O
         1 000533   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         1 000534   200020 000004                    ADSC9   FLAGS+1,,AUTO            cn=0,n=4
         1 000535   200020 236100                    LDQ     FLAGS+1,,AUTO
         1 000536   000001 136007                    SBLQ    1,DL
         1 000537   000547 604000 1                  TMI     s:2272
         1 000540   200011 116100                    CMPQ    J,,AUTO
         1 000541   000547 601000 1                  TNZ     s:2272

   2271  1 000542   200005 471500                    LDP1    JDCB$,,AUTO
         1 000543   100020 237100                    LDAQ    16,,PR1
         1 000544   200015 755100                    STA     M,,AUTO
         1 000545   200016 756100                    STQ     M+1,,AUTO
         1 000546   000563 710000 1                  TRA     s:2273

     2811     2272    2            ELSE TACCT=SUBSTR(CODE10.ACSVEH.T,J+1);

   2272  1 000547   000100 101500                    MRL     fill='000'O
         1 000550   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         1 000551   200020 000002                    ADSC9   FLAGS+1,,AUTO            cn=0,n=2
         1 000552   200020 220100                    LDX0    FLAGS+1,,AUTO
         1 000553   000000 636010                    EAQ     0,X0
         1 000554   000022 772000                    QRL     18
         1 000555   200011 136100                    SBLQ    J,,AUTO
         1 000556   777777 621006                    EAX1    -1,QL
         1 000557   200011 235100                    LDA     J,,AUTO
         1 000560   040100 100545                    MLR     fill='040'O
         1 000561   000001 000011                    ADSC9   1,A,PR0                  cn=0,n=*X1
         1 000562   200015 000010                    ADSC9   M,,AUTO                  cn=0,n=8

     2812     2273    2         IF TACCT=ACCT$->BACCT

   2273  1 000563   200014 471500                    LDP1    KP,,AUTO
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:545  
         1 000564   040100 106500                    CMPC    fill='040'O
         1 000565   200015 000010                    ADSC9   M,,AUTO                  cn=0,n=8
         1 000566   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         1 000567   000666 601000 1                  TNZ     s:2287

     2813     2274    3         THEN IF SUBSTR(CODE10.ACSVEH.T,0,J)=CFU$->BACSVEH.C THEN DO;

   2274  1 000570   000100 101500                    MRL     fill='000'O
         1 000571   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         1 000572   200020 000002                    ADSC9   FLAGS+1,,AUTO            cn=0,n=2
         1 000573   200020 220100                    LDX0    FLAGS+1,,AUTO
         1 000574   200007 473500                    LDP3    CFU$,,AUTO
         1 000575   000100 101500                    MRL     fill='000'O
         1 000576   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000577   200021 000002                    ADSC9   FLAGS+2,,AUTO            cn=0,n=2
         1 000600   200021 221100                    LDX1    FLAGS+2,,AUTO
         1 000601   200011 722100                    LXL2    J,,AUTO
         1 000602   040140 106540                    CMPC    fill='040'O
         1 000603   000000 600012                    ADSC9   0,,PR0                   cn=3,n=*X2
         1 000604   300000 200011                    ADSC9   0,,PR3                   cn=1,n=*X1
         1 000605   000624 601000 1                  TNZ     s:2281

   2272  1 000606                       GOTONE       null
     2814     2275    3   GOTONE:     ;
     2815     2276    3               K=J;

   2276  1 000606   200011 235100                    LDA     J,,AUTO
         1 000607   200012 755100                    STA     K,,AUTO

     2816     2277    3               FLAGS=CODE10.FFLG;

   2277  1 000610   200006 470500                    LDP0    LOC$,,AUTO
         1 000611   000100 100500                    MLR     fill='000'O
         1 000612   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         1 000613   200017 000004                    ADSC9   FLAGS,,AUTO              cn=0,n=4

     2817     2278    3               IF FLAGS&~%FFLG_EXEC# THEN FLAGS.EXEC='1'B;
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:546  

   2278  1 000614   200017 236100                    LDQ     FLAGS,,AUTO
         1 000615   775777 376003                    ANQ     -1025,DU
         1 000616   000622 600000 1                  TZE     s:2279

   2278  1 000617   002000 236003                    LDQ     1024,DU
         1 000620   200017 256100                    ORSQ    FLAGS,,AUTO
         1 000621   000666 710000 1                  TRA     s:2287

     2818     2279    3               ELSE FLAGS='0'B;

   2279  1 000622   200017 450100                    STZ     FLAGS,,AUTO

     2819     2280    3               END;

   2280  1 000623   000666 710000 1                  TRA     s:2287

     2820     2281    3            ELSE IF J>K THEN DO;

   2281  1 000624   200012 236100                    LDQ     K,,AUTO
         1 000625   200011 116100                    CMPQ    J,,AUTO
         1 000626   000666 603000 1                  TRC     s:2287

     2821     2282    3                  J=J-1;

   2282  1 000627   200011 235100                    LDA     J,,AUTO
         1 000630   000001 135007                    SBLA    1,DL
         1 000631   200011 755100                    STA     J,,AUTO

     2822     2283    3                  IF SUBSTR(CODE10.ACSVEH.T,J,1)='?' AND J<=CFU$->BACSVEH.L

   2283  1 000632   000100 101500                    MRL     fill='000'O
         1 000633   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         1 000634   200020 000002                    ADSC9   FLAGS+1,,AUTO            cn=0,n=2
         1 000635   200020 220100                    LDX0    FLAGS+1,,AUTO
         1 000636   040000 106505                    CMPC    fill='040'O
         1 000637   000000 600001                    ADSC9   0,A,PR0                  cn=3,n=1
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:547  
         1 000640   000001 000001 2                  ADSC9   1                        cn=0,n=1
         1 000641   000666 601000 1                  TNZ     s:2287
         1 000642   000100 101500                    MRL     fill='000'O
         1 000643   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000644   200021 000004                    ADSC9   FLAGS+2,,AUTO            cn=0,n=4
         1 000645   200021 236100                    LDQ     FLAGS+2,,AUTO
         1 000646   200011 116100                    CMPQ    J,,AUTO
         1 000647   000666 602000 1                  TNC     s:2287
         1 000650   000100 101500                    MRL     fill='000'O
         1 000651   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         1 000652   200022 000002                    ADSC9   FLAGS+3,,AUTO            cn=0,n=2
         1 000653   200022 221100                    LDX1    FLAGS+3,,AUTO
         1 000654   000100 101500                    MRL     fill='000'O
         1 000655   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000656   200023 000002                    ADSC9   FLAGS+4,,AUTO            cn=0,n=2
         1 000657   200023 222100                    LDX2    FLAGS+4,,AUTO
         1 000660   000000 623005                    EAX3    0,AL
         1 000661   200011 724100                    LXL4    J,,AUTO
         1 000662   040140 106540                    CMPC    fill='040'O
         1 000663   000000 600013                    ADSC9   0,,PR0                   cn=3,n=*X3
         1 000664   300000 200014                    ADSC9   0,,PR3                   cn=1,n=*X4
         1 000665   000606 600000 1                  TZE     GOTONE

     2823     2284    3                    AND SUBSTR(CODE10.ACSVEH.T,0,J)=SUBSTR(CFU$->BACSVEH.C,0,J)
     2824     2285    3                  THEN GOTO GOTONE;
     2825     2286    3                  END;

     2826     2287    2         LOC$=PINCRC(LOC$,SIZEC(CODE10));

   2287  1 000666   000100 101500                    MRL     fill='000'O
         1 000667   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         1 000670   200020 000002                    ADSC9   FLAGS+1,,AUTO            cn=0,n=2
         1 000671   200020 220100                    LDX0    FLAGS+1,,AUTO
         1 000672   000003 621010                    EAX1    3,X0
         1 000673   000000 636011                    EAQ     0,X1
         1 000674   000002 772000                    QRL     2
         1 000675   200006 036100                    ADLQ    LOC$,,AUTO
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:548  
         1 000676   200006 756100                    STQ     LOC$,,AUTO

     2827     2288    2         END;

   2288  1 000677   200006 470500                    LDP0    LOC$,,AUTO
         1 000700   000100 101500                    MRL     fill='000'O
         1 000701   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
         1 000702   200020 000002                    ADSC9   FLAGS+1,,AUTO            cn=0,n=2
         1 000703   200020 220100                    LDX0    FLAGS+1,,AUTO
         1 000704   000003 621010                    EAX1    3,X0
         1 000705   000000 636011                    EAQ     0,X1
         1 000706   000022 772000                    QRL     18
         1 000707   200010 116100                    CMPQ    I,,AUTO
         1 000710   000474 602000 1                  TNC     s:2268
         1 000711   000474 600000 1                  TZE     s:2268

   2287  1 000712                       OWNEROK      null
     2828     2289        %EJECT;
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:549  
     2829     2290    1   OWNEROK:;
     2830     2291    1      LOC$=ADDR(FM$FIT);

   2291  1 000712   200004 236100                    LDQ     @FM$FIT,,AUTO
         1 000713   200006 756100                    STQ     LOC$,,AUTO

     2831     2292    1      CALL FMO$LOCCODT(LOC$,7)ALTRET(NOPASSWD);

   2292  1 000714   000010 236000 2                  LDQ     8
         1 000715   200021 756100                    STQ     FLAGS+2,,AUTO
         1 000716   200006 630500                    EPPR0   LOC$,,AUTO
         1 000717   200020 450500                    STP0    FLAGS+1,,AUTO
         1 000720   200020 630500                    EPPR0   FLAGS+1,,AUTO
         1 000721   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000722   000000 701000 xent               TSX1    FMO$LOCCODT
         1 000723   000740 702000 1                  TSX2    NOPASSWD

     2832     2293    1      IF NOT F$DCB.PASSF OR F$DCB.PASS~=CODE07.PASS

   2293  1 000724   200005 470500                    LDP0    JDCB$,,AUTO
         1 000725   000031 236100                    LDQ     25,,PR0
         1 000726   400000 316007                    CANQ    -131072,DL
         1 000727   000735 600000 1                  TZE     s:2294
         1 000730   200006 471500                    LDP1    LOC$,,AUTO
         1 000731   040100 106500                    CMPC    fill='040'O
         1 000732   000022 000010                    ADSC9   18,,PR0                  cn=0,n=8
         1 000733   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         1 000734   000740 600000 1                  TZE     NOPASSWD

     2833     2294    1      THEN FLAGS=FLAGS&%FFLG_NOLIST#;

   2294  1 000735   200017 236100                    LDQ     FLAGS,,AUTO
         1 000736   010000 376003                    ANQ     4096,DU
         1 000737   200017 756100                    STQ     FLAGS,,AUTO

   2293  1 000740                       NOPASSWD     null
     2834     2295                    /*E*     ERROR: -E$NOACCESS-E
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:550  
     2835     2296                    *        MESSAGE:Access denied% to %UF% %through %DC%
     2836     2297                    */
     2837     2298    1   NOPASSWD:;
     2838     2299    1      F$DCB.AUTHFFLG=FLAGS;

   2299  1 000740   200017 220100                    LDX0    FLAGS,,AUTO
         1 000741   200005 470500                    LDP0    JDCB$,,AUTO
         1 000742   000057 440100                    SXL0    47,,PR0

     2839     2300    2      DO;

     2840     2301    2         IF F$DCB.WSR=1 THEN F$DCB.OWNER='0'B;

   2301  1 000743   000040 236100                    LDQ     32,,PR0
         1 000744   000777 376003                    ANQ     511,DU
         1 000745   000001 116003                    CMPQ    1,DU
         1 000746   000752 601000 1                  TNZ     s:2302

   2301  1 000747   000000 236000 2                  LDQ     0
         1 000750   000064 356100                    ANSQ    52,,PR0
         1 000751   000764 710000 1                  TRA     s:2304

     2841     2302    2         ELSE IF NOT B$JIT.PRIV.ACTIVE.FMSEC THEN EXIT;

   2302  1 000752   000000 471400 xsym               LDP1    B$JIT$
         1 000753   100013 236100                    LDQ     11,,PR1
         1 000754   100000 316003                    CANQ    32768,DU
         1 000755   000766 600000 1                  TZE     s:2306

     2842     2303    2            ELSE IF (FLAGS&%FFLG_WRITE#)~=%FFLG_WRITE# THEN F$DCB.PRIVOPN='1'B;

   2303  1 000756   200017 236100                    LDQ     FLAGS,,AUTO
         1 000757   765000 376003                    ANQ     -5632,DU
         1 000760   765000 116003                    CMPQ    -5632,DU
         1 000761   000764 600000 1                  TZE     s:2304

   2303  1 000762   200000 236003                    LDQ     65536,DU
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:551  
         1 000763   000102 256100                    ORSQ    66,,PR0

     2843     2304    2         FLAGS=%FFLG_OWNER#;

   2304  1 000764   765700 236003                    LDQ     -5184,DU
         1 000765   200017 756100                    STQ     FLAGS,,AUTO

     2844     2305    2         END;

     2845     2306    1      IF ADDR(FDFIT)=ADDR(NIL) THEN GOTO NOTFILE; /* SECCHKFD - all done */

   2306  1 000766   200003 236100                    LDQ     @FDFIT,,AUTO
         1 000767   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000770   001212 600000 1                  TZE     NOTFILE

     2846     2307    1      IF FLAGS.NOLIST AND NOT B$JIT.PRIV.ACTIVE.FMREAD

   2307  1 000771   200017 236100                    LDQ     FLAGS,,AUTO
         1 000772   010000 316003                    CANQ    4096,DU
         1 000773   001000 600000 1                  TZE     s:2309
         1 000774   000000 471400 xsym               LDP1    B$JIT$
         1 000775   100013 236100                    LDQ     11,,PR1
         1 000776   020000 316003                    CANQ    8192,DU
         1 000777   001257 600000 1                  TZE     FMOE$NOFILE

     2847     2308    1      THEN GOTO FMOE$NOFILE;
     2848     2309    1      IF F$DCB.FUN=%IN# THEN FLAGS=FLAGS&%FFLG_INFLGS#;

   2309  1 001000   000032 236100                    LDQ     26,,PR0
         1 001001   000777 376003                    ANQ     511,DU
         1 001002   000002 116003                    CMPQ    2,DU
         1 001003   001007 601000 1                  TNZ     s:2310

   2309  1 001004   200017 236100                    LDQ     FLAGS,,AUTO
         1 001005   422200 376003                    ANQ     -121728,DU
         1 001006   200017 756100                    STQ     FLAGS,,AUTO

PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:552  
     2849     2310    1      J=F$DCB.STARX-3; /* 0 AND 1 FOR *A AND *S */

   2310  1 001007   000064 236100                    LDQ     52,,PR0
         1 001010   000011 772000                    QRL     9
         1 001011   000007 376007                    ANQ     7,DL
         1 001012   000003 136007                    SBLQ    3,DL
         1 001013   200011 756100                    STQ     J,,AUTO

     2850     2311    1      IF J<=1 AND F$DCB.WSR>4

   2311  1 001014   000002 116007                    CMPQ    2,DL
         1 001015   001022 603000 1                  TRC     s:2311+6
         1 001016   000040 236100                    LDQ     32,,PR0
         1 001017   000777 376003                    ANQ     511,DU
         1 001020   000005 116003                    CMPQ    5,DU
         1 001021   001031 603000 1                  TRC     s:2313
         1 001022   200011 235100                    LDA     J,,AUTO
         1 001023   000004 115007                    CMPA    4,DL
         1 001024   001036 601000 1                  TNZ     s:2316
         1 001025   000040 236100                    LDQ     32,,PR0
         1 001026   000777 376003                    ANQ     511,DU
         1 001027   000006 116003                    CMPQ    6,DU
         1 001030   001036 600000 1                  TZE     s:2316

     2851     2312    2        OR J=4 AND F$DCB.WSR~=6 THEN DO;

     2852     2313    2         FLAGS=%FFLG_READ#;

   2313  1 001031   400000 236003                    LDQ     -131072,DU
         1 001032   200017 756100                    STQ     FLAGS,,AUTO

     2853     2314    2         F$DCB.AUTHFFLG=%FFLG_READ#;

   2314  1 001033   400000 221003                    LDX1    -131072,DU
         1 001034   000057 441100                    SXL1    47,,PR0

     2854     2315    2         END;
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:553  

   2315  1 001035   001051 710000 1                  TRA     s:2320

     2855     2316    2      ELSE IF J<5 THEN DO;

   2316  1 001036   000005 115007                    CMPA    5,DL
         1 001037   001051 603000 1                  TRC     s:2320

     2856     2317    2            FLAGS=FLAGS|%FFLG_EXEC#;

   2317  1 001040   200017 236100                    LDQ     FLAGS,,AUTO
         1 001041   002000 276003                    ORQ     1024,DU
         1 001042   200017 756100                    STQ     FLAGS,,AUTO

     2857     2318    2            IF F$DCB.WSR=1 THEN F$DCB.WSR=0;/* ALL IO WILL BE M$M... */

   2318  1 001043   000040 236100                    LDQ     32,,PR0
         1 001044   000777 376003                    ANQ     511,DU
         1 001045   000001 116003                    CMPQ    1,DU
         1 001046   001051 601000 1                  TNZ     s:2320

   2318  1 001047   000000 236003                    LDQ     0,DU
         1 001050   000040 552120                    STBQ    32,'20'O,PR0

     2858     2319    2            END;

     2859     2320    1      IF F$DCB.FUN=%CREATE#

   2320  1 001051   000032 236100                    LDQ     26,,PR0
         1 001052   000777 376003                    ANQ     511,DU
         1 001053   000003 116003                    CMPQ    3,DU
         1 001054   001072 601000 1                  TNZ     s:2327

     2860     2321    1      THEN IF F$DCB.EXIST~=%OLDFILE#

   2321  1 001055   000031 236100                    LDQ     25,,PR0
         1 001056   003000 376007                    ANQ     1536,DL
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:554  
         1 001057   002000 116007                    CMPQ    1024,DL
         1 001060   001067 600000 1                  TZE     s:2323
         1 001061   200017 236100                    LDQ     FLAGS,,AUTO
         1 001062   020000 316003                    CANQ    8192,DU
         1 001063   001270 600000 1                  TZE     FMOE$CLSREL
         1 001064   200011 235100                    LDA     J,,AUTO
         1 001065   000005 115007                    CMPA    5,DL
         1 001066   001270 602000 1                  TNC     FMOE$CLSREL

     2861     2322    1           AND (NOT FLAGS.DELF OR J<5) THEN GOTO FMOE$CLSREL;
     2862     2323    1         ELSE IF NOT FLAGS&%FFLG_UPFLGS# THEN GOTO FMOE$NOACCESS;

   2323  1 001067   200017 236100                    LDQ     FLAGS,,AUTO
         1 001070   344500 376003                    ANQ     117056,DU
         1 001071   001253 600000 1                  TZE     FMOE$NOACCESS

     2863     2324                    /*E*     ERROR: FMN-E$CLSREL-E
     2864     2325                    *        MESSAGE:You may not replace file %FN
     2865     2326                    */
     2866     2327    1      I=3;

   2327  1 001072   000003 235007                    LDA     3,DL
         1 001073   200010 755100                    STA     I,,AUTO

     2867     2328    1      LOC$=ADDR(FM$FIT);

   2328  1 001074   200004 236100                    LDQ     @FM$FIT,,AUTO
         1 001075   200006 756100                    STQ     LOC$,,AUTO

     2868     2329    1      CALL FMO$LOCCODE(LOC$,I)ALTRET(NOTFILE);

   2329  1 001076   200010 631500                    EPPR1   I,,AUTO
         1 001077   200021 451500                    STP1    FLAGS+2,,AUTO
         1 001100   200006 633500                    EPPR3   LOC$,,AUTO
         1 001101   200020 453500                    STP3    FLAGS+1,,AUTO
         1 001102   200020 630500                    EPPR0   FLAGS+1,,AUTO
         1 001103   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:555  
         1 001104   000000 701000 xent               TSX1    FMO$LOCCODE
         1 001105   001212 702000 1                  TSX2    NOTFILE

     2869     2330    1      IF (F$DCB.FUN~=%CREATE# OR F$DCB.EXIST=%OLDFILE#)

   2330  1 001106   200005 470500                    LDP0    JDCB$,,AUTO
         1 001107   000032 236100                    LDQ     26,,PR0
         1 001110   000777 376003                    ANQ     511,DU
         1 001111   000003 116003                    CMPQ    3,DU
         1 001112   001117 601000 1                  TNZ     s:2330+9
         1 001113   000031 236100                    LDQ     25,,PR0
         1 001114   003000 376007                    ANQ     1536,DL
         1 001115   002000 116007                    CMPQ    1024,DL
         1 001116   001130 601000 1                  TNZ     s:2335
         1 001117   000032 236100                    LDQ     26,,PR0
         1 001120   777000 376007                    ANQ     -512,DL
         1 001121   002000 116007                    CMPQ    1024,DL
         1 001122   001130 600000 1                  TZE     s:2335

     2870     2331    2        AND F$DCB.ASN~=%TAPE# THEN DO;

     2871     2332    2         F$DCB.TYPE=CODE03.TYPE;

   2332  1 001123   200006 471500                    LDP1    LOC$,,AUTO
         1 001124   100001 720100                    LXL0    1,,PR1
         1 001125   000025 440100                    SXL0    21,,PR0

     2872     2333    2         F$DCB.ORG=CODE03.ORG;

   2333  1 001126   100000 236100                    LDQ     0,,PR1
         1 001127   000032 552140                    STBQ    26,'40'O,PR0

     2873     2334    2         END;

     2874     2335    1      IF CODE03.DESC.ARCHIVE

   2335  1 001130   200006 471500                    LDP1    LOC$,,AUTO
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:556  
         1 001131   100001 430100                    FSZN    1,,PR1
         1 001132   001151 605000 1                  TPL     s:2343

     2875     2336    1      THEN IF F$DCB.FUN=%CREATE# THEN GOTO FMOE$QSTOW;

   2336  1 001133   000032 236100                    LDQ     26,,PR0
         1 001134   000777 376003                    ANQ     511,DU
         1 001135   000003 116003                    CMPQ    3,DU
         1 001136   001264 600000 1                  TZE     FMOE$QSTOW

     2876     2337    1         ELSE IF B$JIT.PRIV.ACTIVE.FMEFT THEN FLAGS=FLAGS&%FFLG_INFLGS#;

   2337  1 001137   000000 473400 xsym               LDP3    B$JIT$
         1 001140   300013 234100                    SZN     11,,PR3
         1 001141   001146 605000 1                  TPL     s:2338

   2337  1 001142   200017 236100                    LDQ     FLAGS,,AUTO
         1 001143   422200 376003                    ANQ     -121728,DU
         1 001144   200017 756100                    STQ     FLAGS,,AUTO
         1 001145   001151 710000 1                  TRA     s:2343

     2877     2338    1            ELSE FLAGS=FLAGS&%(FFLG_INFLGS#&~FFLG_DELF#);

   2338  1 001146   200017 236100                    LDQ     FLAGS,,AUTO
         1 001147   402200 376003                    ANQ     -129920,DU
         1 001150   200017 756100                    STQ     FLAGS,,AUTO

     2878     2339                    /*E*     ERROR: FMN-E$QSTOW-E
     2879     2340                    *        MESSAGE:File% %FN% is read-only because it is archived.
     2880     2341                    *        MESSAGE1:File% %UF% is stowed or waiting to be stowed.
     2881     2342                    */
     2882     2343    1      IF SUBSTR(CODE03.TYPE,0,1)='*' AND F$DCB.WSR~=0

   2343  1 001151   100001 236100                    LDQ     1,,PR1
         1 001152   777000 376007                    ANQ     -512,DL
         1 001153   052000 116007                    CMPQ    21504,DL
         1 001154   001174 601000 1                  TNZ     s:2349
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:557  
         1 001155   000040 236100                    LDQ     32,,PR0
         1 001156   000777 316003                    CANQ    511,DU
         1 001157   001174 600000 1                  TZE     s:2349
         1 001160   000000 473400 xsym               LDP3    B$JIT$
         1 001161   300013 236100                    LDQ     11,,PR3
         1 001162   100000 316003                    CANQ    32768,DU
         1 001163   001174 601000 1                  TNZ     s:2349

     2883     2344    2        AND NOT B$JIT.PRIV.ACTIVE.FMSEC THEN DO;

     2884     2345    2         IF FLAGS.READ THEN FLAGS=FLAGS|%FFLG_AURD#; /* LET LIST WORK */

   2345  1 001164   200017 234100                    SZN     FLAGS,,AUTO
         1 001165   001171 605000 1                  TPL     s:2346

   2345  1 001166   200017 236100                    LDQ     FLAGS,,AUTO
         1 001167   000200 276003                    ORQ     128,DU
         1 001170   200017 756100                    STQ     FLAGS,,AUTO

     2885     2346    2         FLAGS=FLAGS&

   2346  1 001171   200017 236100                    LDQ     FLAGS,,AUTO
         1 001172   027200 376003                    ANQ     11904,DU
         1 001173   200017 756100                    STQ     FLAGS,,AUTO

     2886     2347    2           %(FFLG_DELF#|FFLG_EXEC#|FFLG_CREATE#|FFLG_REATTR#|FFLG_AURD#);
     2887     2348    2         END;

     2888     2349    1      IF CODE03.ORG=%SYMB# THEN FLAGS=FLAGS&~(%FFLG_UPD#|%FFLG_DELR#);

   2349  1 001174   100000 236100                    LDQ     0,,PR1
         1 001175   777000 376003                    ANQ     -512,DU
         1 001176   011000 116003                    CMPQ    4608,DU
         1 001177   001203 601000 1                  TNZ     s:2350

   2349  1 001200   200017 236100                    LDQ     FLAGS,,AUTO
         1 001201   537777 376003                    ANQ     -81921,DU
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:558  
         1 001202   200017 756100                    STQ     FLAGS,,AUTO

     2889     2350    1      IF CODE03.GHSTACS~=0 THEN F$DCB.GHSTACS=CODE03.GHSTACS;

   2350  1 001203   100004 236100                    LDQ     4,,PR1
         1 001204   017000 316003                    CANQ    7680,DU
         1 001205   001212 600000 1                  TZE     NOTFILE

   2350  1 001206   000011 772000                    QRL     9
         1 001207   000052 676100                    ERQ     42,,PR0
         1 001210   000017 376003                    ANQ     15,DU
         1 001211   000052 656100                    ERSQ    42,,PR0

   2350  1 001212                       NOTFILE      null
     2890     2351    1   NOTFILE:;
     2891     2352    2      IF B$JIT.PRIV.ACTIVE.FMREAD AND ADDR(FDFIT)~=ADDR(NIL) THEN DO;

   2352  1 001212   000000 470400 xsym               LDP0    B$JIT$
         1 001213   000013 236100                    LDQ     11,,PR0
         1 001214   020000 316003                    CANQ    8192,DU
         1 001215   001240 600000 1                  TZE     s:2358
         1 001216   200003 236100                    LDQ     @FDFIT,,AUTO
         1 001217   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001220   001240 600000 1                  TZE     s:2358

     2892     2353    2         IF F$DCB.STARX~=0 THEN EXIT; /* do nothing for system starfiles */

   2353  1 001221   200005 471500                    LDP1    JDCB$,,AUTO
         1 001222   100064 236100                    LDQ     52,,PR1
         1 001223   007000 316007                    CANQ    3584,DL
         1 001224   001240 601000 1                  TNZ     s:2358

     2893     2354    2         IF FLAGS.EXEC OR NOT FLAGS.READ THEN F$DCB.PRIVOPN='1'B;

   2354  1 001225   200017 236100                    LDQ     FLAGS,,AUTO
         1 001226   002000 316003                    CANQ    1024,DU
         1 001227   001232 601000 1                  TNZ     s:2354+5
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:559  
         1 001230   200017 234100                    SZN     FLAGS,,AUTO
         1 001231   001234 604000 1                  TMI     s:2355

   2354  1 001232   200000 236003                    LDQ     65536,DU
         1 001233   100102 256100                    ORSQ    66,,PR1

     2894     2355    2         FLAGS=FLAGS&~%FFLG_EXEC#|%FFLG_READ#;

   2355  1 001234   200017 236100                    LDQ     FLAGS,,AUTO
         1 001235   775777 376003                    ANQ     -1025,DU
         1 001236   400000 276003                    ORQ     -131072,DU
         1 001237   200017 756100                    STQ     FLAGS,,AUTO

     2895     2356    2         END;

     2896     2357                    /* IF FMREAD PRIV OVERRODE NONE ACCESS, HE GETS ONLY READ */
     2897     2358    1      IF F$DCB.FDCM=511 THEN FLAGS=%FFLG_READ#;

   2358  1 001240   200005 471500                    LDP1    JDCB$,,AUTO
         1 001241   100073 236100                    LDQ     59,,PR1
         1 001242   000777 376007                    ANQ     511,DL
         1 001243   000777 116007                    CMPQ    511,DL
         1 001244   001247 601000 1                  TNZ     s:2359

   2358  1 001245   400000 236003                    LDQ     -131072,DU
         1 001246   200017 756100                    STQ     FLAGS,,AUTO

     2898     2359    1      F$DCB.FFLG=FLAGS;

   2359  1 001247   200017 220100                    LDX0    FLAGS,,AUTO
         1 001250   100004 740100                    STX0    4,,PR1

     2899     2360    1      IF F$DCB.FFLG THEN RETURN;

   2360  1 001251   001253 600000 1                  TZE     FMOE$NOACCESS

   2360  1 001252   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:560  

     2900     2361                    /**/
     2901     2362    1   FMOE$NOACCESS: B$JIT.ERR=FMO$E$NOACCESS;

   2362  1 001253   000001 236000 0     FMOE$NOACCE* LDQ     FMO$E$NOACCESS
         1 001254   000000 470400 xsym               LDP0    B$JIT$
         1 001255   000012 756100                    STQ     10,,PR0

     2902     2363    1      RETURN;

   2363  1 001256   000000 702200 xent               TSX2  ! X66_ARET

     2903     2364    1   FMOE$NOFILE: B$JIT.ERR=FMO$E$NOFILE;

   2364  1 001257   000000 236000 0     FMOE$NOFILE  LDQ     FMO$E$NOFILE
         1 001260   100012 756100                    STQ     10,,PR1

     2904     2365    1      F$DCB.AUTHFFLG='0'B;

   2365  1 001261   000000 220003                    LDX0    0,DU
         1 001262   000057 440100                    SXL0    47,,PR0

     2905     2366    1      RETURN;

   2366  1 001263   000000 702200 xent               TSX2  ! X66_ARET

     2906     2367    1   FMOE$QSTOW: B$JIT.ERR=FMO$E$QSTOW;

   2367  1 001264   000002 236000 0     FMOE$QSTOW   LDQ     FMO$E$QSTOW
         1 001265   000000 473400 xsym               LDP3    B$JIT$
         1 001266   300012 756100                    STQ     10,,PR3

     2907     2368    1      RETURN;

   2368  1 001267   000000 702200 xent               TSX2  ! X66_ARET

     2908     2369    1   FMOE$CLSREL: B$JIT.ERR=FMO$E$CLSREL;
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:561  

   2369  1 001270   000003 236000 0     FMOE$CLSREL  LDQ     FMO$E$CLSREL
         1 001271   000000 471400 xsym               LDP1    B$JIT$
         1 001272   100012 756100                    STQ     10,,PR1

     2909     2370    1      RETURN;

   2370  1 001273   000000 702200 xent               TSX2  ! X66_ARET
     2910     2371    1   END FMO$SECCHK;
     2911     2372        %EOD;

PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:562  
--  Include file information  --

   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   B$P.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure FMO$SECCHK.
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:563  

 **** Variables and constants ****

  ****  Section 000 RoData FMO$SECCHK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/c STRC(54)    r     1 FETCHVEH                   3-0-0/b STRC        r     1 FMO$E$CLSREL
     1-0-0/b STRC        r     1 FMO$E$NOACCESS             0-0-0/b STRC        r     1 FMO$E$NOFILE
     2-0-0/b STRC        r     1 FMO$E$QSTOW                6-0-0/c CHAR(8)     r     1 SYSACCT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FDFIT                     4-0-0/w PTR         r     1 @FM$FIT
    14-0-0/w PTR         r     1 ACCT$                      7-0-0/w PTR         r     1 CFU$
    *0-0-0/w UBIN        r     1 FDFIT                     17-0-0/b STRC        r     1 FLAGS
    *0-0-0/w STRC(1116)  r     1 FM$FIT                    10-0-0/w UBIN        r     1 I
    11-0-0/w UBIN        r     1 J                          5-0-0/w PTR         r     1 JDCB$
    13-0-0/w UBIN        r     1 JP                        12-0-0/w UBIN        r     1 K
    14-0-0/w UBIN        r     1 KP                         6-0-0/w PTR         r     1 LOC$
    15-0-0/w STRC(72)    r     1 M                         15-0-0/w CHAR(8)     r     1 TACCT
    11-0-0/w CHAR(4)     r     1 WILD_XC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$P$
     0-0-0/w PTR         r     1 F$CFU$                     0-0-0/w PTR         r     1 S$CU$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:564  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(1224)  r     1 B$P(0:0)
     0-0-0/d STRC(576)   r     1 B$U                        0-0-0/c CHAR(8)     r     1 BACCT
     0-0-0/c ASTR(9)     r     1 BACSVEH                    0-0-0/w STRC(324)   r     1 CODE03
     0-0-0/w STRC(396)   r     1 CODE04                     0-0-0/w STRC(72)    r     1 CODE07
     0-0-0/c STRC(90)    r     1 CODE09                     0-0-0/c ASTR(27)    r     1 CODE10
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(288)   r     1 FM$CFUA


   Procedure FMO$SECCHK requires 700 words for executable code.
   Procedure FMO$SECCHK requires 20 words of local(AUTO) storage.
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:565  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:566  
          MINI XREF LISTING

ACCT$
      2060**DCL      2240<<ASSIGN   2256<<ASSIGN   2273>>IF
B$DO.ECCINFO
      1976**DCL      1977--REDEF
B$JIT.ACCN
       997**DCL      2123>>IF       2130>>IF       2195--DOWHILE  2195>>DOWHILE  2202--IF       2202>>IF
      2206--IF
B$JIT.DCB$
      1087**DCL      2111>>ASSIGN
B$JIT.ERR
       997**DCL      2362<<ASSIGN   2364<<ASSIGN   2367<<ASSIGN   2369<<ASSIGN
B$JIT.ERR.MID
       998**DCL       998--REDEF
B$JIT.PRIV.ACTIVE.FMEFT
       998**DCL      2337>>IF
B$JIT.PRIV.ACTIVE.FMREAD
       999**DCL      2307>>IF       2352>>IF
B$JIT.PRIV.ACTIVE.FMSEC
       999**DCL      2302>>IF       2343>>IF
B$JIT.UNAME
       997**DCL      2123>>IF
B$JIT$
      2084**DCL       992--IMP-PTR  2111>>ASSIGN   2123>>IF       2123>>IF       2130>>IF       2195>>DOWHILE
      2202>>IF       2302>>IF       2307>>IF       2337>>IF       2343>>IF       2352>>IF       2362>>ASSIGN
      2364>>ASSIGN   2367>>ASSIGN   2369>>ASSIGN
B$P.NAME
      1773**DCL      2246--ASSIGN   2248--ASSIGN   2250--ASSIGN
B$P$
      1803**DCL      2246>>ASSIGN   2248>>ASSIGN   2250>>ASSIGN
B$U.ACP
      1932**DCL      2246>>ASSIGN
B$U.ASL
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:567  
      1934**DCL      2250>>ASSIGN
B$U.DB
      1933**DCL      2248>>ASSIGN
B$U.MISC
      1955**DCL      1956--REDEF
B$USER.MISC
      2031**DCL      2032--REDEF
BACCT
      2048**DCL      2273>>IF
BACSVEH.C
      2047**DCL      2274>>IF       2283>>IF
BACSVEH.L
      2046**DCL      2047--IMP-SIZ  2274>>IF       2283>>IF       2283>>IF
CFU$
      2053**DCL       419--IMP-PTR   425--IMP-PTR  2143<<ASSIGN   2226<<ASSIGN   2233>>IF       2233>>ASSIGN
      2243<<ASSIGN   2246<<ASSIGN   2248<<ASSIGN   2250<<ASSIGN   2255<<ASSIGN   2274>>IF       2274>>IF
      2283>>IF       2283>>IF       2283>>IF
CODE03.DESC.ARCHIVE
       394**DCL      2335>>IF
CODE03.GHSTACS
       395**DCL      2350>>IF       2350>>ASSIGN
CODE03.ORG
       393**DCL      2333>>ASSIGN   2349>>IF
CODE03.TYPE
       395**DCL      2332>>ASSIGN   2343>>IF
CODE04.CREATOR.ACCT
       404**DCL      2123>>IF
CODE04.CREATOR.NAME
       404**DCL      2123>>IF
CODE07.PASS
       408**DCL      2293>>IF
CODE09.ACCT
       412**DCL      2172>>ASSIGN   2188--ASSIGN   2195--DOWHILE  2195>>DOWHILE  2197--IF       2197>>IF
      2202--IF       2202>>IF       2206--IF       2219--IF       2222--IF       2222--ASSIGN
CODE09.FFLG
       411**DCL      2233>>ASSIGN
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:568  
CODE10
       415**DCL      2267--DOWHILE  2268--ASSIGN   2287--ASSIGN
CODE10.ACSVEH.C
       416**DCL       416--IMP-SIZ  2267>>DOWHILE  2268>>ASSIGN   2269>>CALLBLT  2270>>IF       2271>>IF
      2272>>ASSIGN   2274>>IF       2283>>IF       2283>>IF       2287>>ASSIGN
CODE10.ACSVEH.T
       416**DCL      2269>>CALLBLT  2272>>ASSIGN   2274>>IF       2283>>IF       2283>>IF
CODE10.FFLG
       415**DCL      2277>>ASSIGN
F$CFU$
      2083**DCL      2116>>ASSIGN
F$DCB.ACCT
      1162**DCL      2130>>IF       2256--ASSIGN   2271>>ASSIGN
F$DCB.ACTPOS
      1177**DCL      1177--REDEF
F$DCB.ARS
      1152**DCL      1152--REDEF
F$DCB.ASN
      1167**DCL      2330>>IF
F$DCB.ATTR
      1170**DCL      1171--REDEF
F$DCB.AUTHFFLG
      1177**DCL      2299<<ASSIGN   2314<<ASSIGN   2365<<ASSIGN
F$DCB.BORROW
      1185**DCL      1185--REDEF    1185--REDEF    1185--REDEF
F$DCB.DCBNAME.L
      1199**DCL      1199--IMP-SIZ
F$DCB.EOMCHAR
      1156**DCL      1156--REDEF
F$DCB.EXIST
      1165**DCL      2321>>IF       2330>>IF
F$DCB.FCD
      1165**DCL      2252>>IF
F$DCB.FDCM
      1189**DCL      2144>>ASSIGN   2234<<ASSIGN   2358>>IF
F$DCB.FFLG
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:569  
      1156**DCL      2113>>ASSIGN   2116<<ASSIGN   2117>>ASSIGN   2118<<ASSIGN   2359<<ASSIGN   2360>>IF
F$DCB.FLDID
      1180**DCL      1180--REDEF
F$DCB.FORM$
      1174**DCL      1174--REDEF
F$DCB.FSECT
      1190**DCL      1190--REDEF
F$DCB.FSN
      1167**DCL      1167--REDEF    1167--REDEF    1168--REDEF
F$DCB.FUN
      1166**DCL      2309>>IF       2320>>IF       2330>>IF       2336>>IF
F$DCB.GHSTACS
      1175**DCL      2350<<ASSIGN
F$DCB.HEADER$
      1173**DCL      1173--REDEF
F$DCB.IASN
      1193**DCL      2116>>IF
F$DCB.IXTNSIZE
      1171**DCL      1171--REDEF
F$DCB.LASTSTA$
      1161**DCL      1161--REDEF
F$DCB.LVL
      1186**DCL      1186--REDEF
F$DCB.NAME
      1161**DCL      2255--ASSIGN
F$DCB.NAME.C
      1161**DCL      1161--REDEF
F$DCB.NOEOF
      1182**DCL      1182--REDEF
F$DCB.NRECS
      1172**DCL      1172--REDEF
F$DCB.NRECX
      1191**DCL      1191--REDEF
F$DCB.OHDR
      1183**DCL      1183--REDEF
F$DCB.ORG
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:570  
      1166**DCL      1166--REDEF    2333<<ASSIGN
F$DCB.OWNER
      1183**DCL      2125<<ASSIGN   2128>>IF       2129<<ASSIGN   2301<<ASSIGN
F$DCB.PASS
      1162**DCL      2293>>IF
F$DCB.PASSF
      1164**DCL      2293>>IF
F$DCB.PRECNO
      1189**DCL      1189--REDEF
F$DCB.PRIVOPN
      1191**DCL      2303<<ASSIGN   2354<<ASSIGN
F$DCB.PSN
      1162**DCL      2252>>IF
F$DCB.RCSZ
      1194**DCL      1194--REDEF
F$DCB.RES
      1162**DCL      1162--REDEF
F$DCB.SETX
      1174**DCL      1174--REDEF
F$DCB.STARX
      1183**DCL      2310>>ASSIGN   2353>>IF
F$DCB.TAB$
      1173**DCL      1174--REDEF
F$DCB.TDA
      1188**DCL      1188--REDEF
F$DCB.TYPE
      1162**DCL      2332<<ASSIGN
F$DCB.WSN
      1163**DCL      1163--REDEF
F$DCB.WSR
      1169**DCL      2241>>DOCASE   2252>>IF       2301>>IF       2311>>IF       2311>>IF       2318>>IF
      2318<<ASSIGN   2343>>IF
FDFIT
        13**DCL        12--PROC     2112--IF       2237--IF       2306--IF       2352--IF
FETCHVEH
      2105**DCL      2243--ASSIGN
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:571  
FLAGS
      2065**DCL      2113<<ASSIGN   2119<<ASSIGN   2132<<ASSIGN   2133>>IF       2135<<ASSIGN   2233<<ASSIGN
      2244<<ASSIGN   2277<<ASSIGN   2278>>IF       2279<<ASSIGN   2294<<ASSIGN   2294>>ASSIGN   2299>>ASSIGN
      2303>>IF       2304<<ASSIGN   2309<<ASSIGN   2309>>ASSIGN   2313<<ASSIGN   2317<<ASSIGN   2317>>ASSIGN
      2323>>IF       2337<<ASSIGN   2337>>ASSIGN   2338<<ASSIGN   2338>>ASSIGN   2345<<ASSIGN   2345>>ASSIGN
      2346<<ASSIGN   2346>>ASSIGN   2349<<ASSIGN   2349>>ASSIGN   2355<<ASSIGN   2355>>ASSIGN   2358<<ASSIGN
      2359>>ASSIGN
FLAGS.DELF
      2070**DCL      2321>>IF
FLAGS.EXEC
      2073**DCL      2238>>IF       2239<<ASSIGN   2278<<ASSIGN   2354>>IF
FLAGS.NOLIST
      2071**DCL      2307>>IF
FLAGS.READ
      2066**DCL      2345>>IF       2354>>IF
FM$CFU.ACCTX
       420**DCL       420--REDEF
FM$CFUA.DFLTALL
       428**DCL      2116>>ASSIGN
FM$FIT
       390**DCL        12--PROC     2121--ASSIGN   2140--ASSIGN   2263--ASSIGN   2291--ASSIGN   2328--ASSIGN
FM$FIT.CODES.NDW
       390**DCL      2142>>ASSIGN   2266>>ASSIGN
FMO$E$CLSREL
      2102**DCL      2369>>ASSIGN
FMO$E$NOACCESS
      2094**DCL      2362>>ASSIGN
FMO$E$NOFILE
      2090**DCL      2364>>ASSIGN
FMO$E$QSTOW
      2098**DCL      2367>>ASSIGN
FMO$LOCCODE
      2078**DCL-ENT  2122--CALL     2141--CALL     2264--CALL     2329--CALL
FMO$LOCCODT
      2079**DCL-ENT  2292--CALL
FMOE$CLSREL
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:572  
      2369**LABEL    2322--GOTO
FMOE$NOACCESS
      2362**LABEL    2323--GOTO
FMOE$NOFILE
      2364**LABEL    2308--GOTO
FMOE$QSTOW
      2367**LABEL    2336--GOTO
GOTONE
      2272**LABEL    2285--GOTO
I
      2054**DCL      2120<<ASSIGN   2122<>CALL     2139<<ASSIGN   2141<>CALL     2142<<ASSIGN   2142>>ASSIGN
      2145>>DOWHILE  2231<<ASSIGN   2231>>ASSIGN   2262<<ASSIGN   2264<>CALL     2266<<ASSIGN   2266>>ASSIGN
      2267>>DOWHILE  2268<<ASSIGN   2268>>ASSIGN   2327<<ASSIGN   2329<>CALL
J
      2055**DCL      2056--REDEF    2173>>IF       2174<<ASSIGN   2187<<ASSIGN   2195>>DOWHILE  2195>>DOWHILE
      2197>>IF       2197>>IF       2198>>ASSIGN   2201>>IF       2202>>IF       2202>>IF       2208<<ASSIGN
      2219>>IF       2219<<ASSIGN   2219>>ASSIGN   2269<<CALLBLT  2270>>IF       2271>>IF       2272>>ASSIGN
      2274>>IF       2276>>ASSIGN   2281>>IF       2282<<ASSIGN   2282>>ASSIGN   2283>>IF       2283>>IF
      2283>>IF       2283>>IF       2310<<ASSIGN   2311>>IF       2311>>IF       2316>>IF       2321>>IF
JDCB$
      2051**DCL      1152--IMP-PTR  2111<<ASSIGN   2113>>ASSIGN   2116>>IF       2116>>ASSIGN   2117>>ASSIGN
      2118>>ASSIGN   2125>>ASSIGN   2128>>IF       2129>>ASSIGN   2130>>IF       2144>>ASSIGN   2234>>ASSIGN
      2241>>DOCASE   2271>>ASSIGN   2293>>IF       2293>>IF       2299>>ASSIGN   2301>>IF       2301>>ASSIGN
      2303>>ASSIGN   2309>>IF       2310>>ASSIGN   2311>>IF       2311>>IF       2314>>ASSIGN   2318>>IF
      2318>>ASSIGN   2320>>IF       2321>>IF       2330>>IF       2330>>IF       2330>>IF       2332>>ASSIGN
      2333>>ASSIGN   2336>>IF       2343>>IF       2350>>ASSIGN   2353>>IF       2354>>ASSIGN   2358>>IF
      2359>>ASSIGN   2360>>IF       2365>>ASSIGN
JP
      2058**DCL      2175<<ASSIGN   2188<<ASSIGN   2198<<ASSIGN   2201>>IF       2206>>IF       2208>>ASSIGN
      2222>>IF
K
      2057**DCL      2190<<ASSIGN   2195>>DOWHILE  2195>>DOWHILE  2201>>ASSIGN   2202>>IF       2202>>IF
      2210>>ASSIGN   2212<<ASSIGN   2217<<ASSIGN   2217>>ASSIGN   2265<<ASSIGN   2276<<ASSIGN   2281>>IF
KP
      2059**DCL      2060--REDEF    2117<<ASSIGN   2132>>ASSIGN   2191<<ASSIGN   2201<<ASSIGN   2206>>IF
      2210>>ASSIGN   2212>>ASSIGN
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:573  
LOC$
      2052**DCL       393--IMP-PTR   402--IMP-PTR   408--IMP-PTR   411--IMP-PTR   415--IMP-PTR  2121<<ASSIGN
      2122<>CALL     2123>>IF       2123>>IF       2140<<ASSIGN   2141<>CALL     2172>>ASSIGN   2195>>DOWHILE
      2197>>IF       2202>>IF       2226>>ASSIGN   2230<<ASSIGN   2230>>ASSIGN   2263<<ASSIGN   2264<>CALL
      2267>>DOWHILE  2267>>DOWHILE  2268>>ASSIGN   2268>>ASSIGN   2269>>CALLBLT  2269>>CALLBLT  2270>>IF
      2271>>IF       2272>>ASSIGN   2272>>ASSIGN   2274>>IF       2274>>IF       2277>>ASSIGN   2283>>IF
      2283>>IF       2283>>IF       2283>>IF       2287<<ASSIGN   2287>>ASSIGN   2287>>ASSIGN   2287>>ASSIGN
      2291<<ASSIGN   2292<>CALL     2293>>IF       2328<<ASSIGN   2329<>CALL     2332>>ASSIGN   2333>>ASSIGN
      2335>>IF       2343>>IF       2349>>IF       2350>>IF       2350>>ASSIGN
M
      2061**DCL      2064--REDEF
M.C
      2063**DCL      2193<<ASSIGN   2210<<ASSIGN   2210>>ASSIGN   2215<<ASSIGN   2215>>ASSIGN   2222<<ASSIGN
      2225>>IF       2227>>ASSIGN
M.CM
      2062**DCL      2144<<ASSIGN   2225>>IF       2227<<ASSIGN   2234>>ASSIGN
NOMATCH
      2225**LABEL    2207--GOTO
NOPASSWD
      2293**LABEL    2237--GOTO     2292--CALLALT
NOTFILE
      2350**LABEL    2306--GOTO     2329--CALLALT
OTHEROK
      2234**LABEL    2141--CALLALT
OWNEROK
      2287**LABEL    2122--CALLALT  2126--GOTO     2130--GOTO     2136--GOTO     2238--GOTO     2258--GOTO
      2260--GOTO     2264--CALLALT
S$CU$
      2042**DCL      2246>>ASSIGN   2248>>ASSIGN   2250>>ASSIGN
SECCHKFD
      2133**LABEL    2114--GOTO
SYSACCT
      2108**DCL      2240--ASSIGN   2270>>ASSIGN
TACCT
      2064**DCL      2270<<ASSIGN   2271<<ASSIGN   2272<<ASSIGN   2273>>IF
WILD_XC
PL6.E3A0      #007=FMO$SECCHK File=FMO$OBSE.:E05TSI                              TUE 07/29/97 16:58 Page:574  
      2056**DCL      2172<<ASSIGN

PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:575  
     2912        1        /*T***********************************************************/
     2913        2        /*T*                                                         */
     2914        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2915        4        /*T*                                                         */
     2916        5        /*T***********************************************************/
     2917        6        FMO$FIELD_START_SETUP: PROC ALTRET;
     2918        7                    /*F*     NAME:     FMO$FIELD_START_SETUP
     2919        8
     2920        9                             PURPOSE:  To set up the FM$FIELD_START array in the ROSEG
     2921       10                                       from information in a VLP_RECFIELD or CODE18
     2922       11                                       structure which is known to contain legal field
     2923       12                                       definitions.
     2924       13                    */
     2925       14                    /*D*     NAME:     FMO$FIELD_START_SETUP
     2926       15
     2927       16                             CALL:     CALL FMO$FIELD_START_SETUP(VLP_RECFIELD) ALTRET(LBL);
     2928       17                             INPUT:    F$DCB.FIELDX, indicating an existing area in the
     2929       18                                       ROSEG which contains a VLP_RECFIELD structure
     2930       19                                       known to contain legal field definitions.
     2931       20
     2932       21                                       F$DCB.STARTX=0
     2933       22
     2934       23                             OUTPUT:   F$DCB.STARTX, set to a ROSEG offset.
     2935       24
     2936       25                                       Initial field offsets placed in the FM$FIELD_START
     2937       26                                       array for each field in VLP_RECFIELD.
     2938       27
     2939       28                             DESCRIPTION:
     2940       29                                       An area in the ROSEG is located for FM$FIELD_START
     2941       30                                       and F$DCB.STARTX is set.  Then, elements in the
     2942       31                                       FM$FIELD_START array are set to contain the offset,
     2943       32                                       in bits, from the start of a record to the start
     2944       33                                       of a field defined in VLP_RECFIELD.  The index
     2945       34                                       into the FM$FIELD_START array for each field is
     2946       35                                       the same as its index in the VLP_RECFIELD field
     2947       36                                       array (VLP_RECFIELD.FIELD or VLP_RECFIELD.DECFIELD).
     2948       37                                       Field offsets must be computed in accordance with
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:576  
     2949       38                                       the data types specified.  All fields must be on
     2950       39                                       byte boundaries except packed decimal which can be
     2951       40                                       on nibble boundaries and integer (SBIN, UBIN) which
     2952       41                                       can be on bit boundaries.  If fields are specified
     2953       42                                       in an order that would place a field on a boundary
     2954       43                                       which is not normally legal, slack bits will be
     2955       44                                       inserted until a legal boundary is reached.  These
     2956       45                                       slack bits will not be inserted into the
     2957       46                                       VLP_RECFIELD structure, but will be reflected in
     2958       47                                       the bit offsets placed in the FM$FIELD_START array.
     2959       48
     2960       49                                       VLP_RECFIELD fields are assumed to have been
     2961       50                                       verified already to assure that they specify legal
     2962       51                                       data types, lengths, and scale values.  (See
     2963       52                                       FMO$CHKRECFIELD).
     2964       53
     2965       54                                       The altreturn will be taken if no space was
     2966       55                                       available in the ROSEG for FIELD_START or if
     2967       56                                       F$DCB.FIELDX=0.
     2968       57                    */
     2969       58                    /**/
     2970       59                    /* Includes */
     2971       60                    /**/
     2972       61        %INCLUDE F$CP6V_C;
     2973      287        %INCLUDE B$JIT;
     2974      890        %MACRO F$DCB(BASED=BASED);
     2975      891        %INCLUDE F$DCB;
     2976      940        %MEND;
     2977      941        %INCLUDE F_ERRORS_C;
     2978     1181        %INCLUDE FM$MACROS;
     2979     1556        %INCLUDE FM_FIELD_C;
     2980     1597        %INCLUDE B$OBJECT_C;
     2981     5027        %VREBL_DATATYPES;
     2982     5102                    /**/
     2983     5103                    /* Entry Points */
     2984     5104                    /**/
     2985     5105    1   DCL FSA$FSP ENTRY(2) ALTRET;
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:577  
     2986     5106    1   DCL FSA$GSP ENTRY(2) ALTRET;
     2987     5107                    /**/
     2988     5108                    /* Based Variables */
     2989     5109                    /**/
     2990     5110        %VLP$RECFIELD_V(FPTN=RECFIELD,BASED="BASED(FIELD$)");
     2991     5147        %FM$FIELD_START(FPTN=FIELD_START,STCLASS="BASED(START$)");
     2992     5169        %F$DCB(BASED="BASED(JDCB$)");
     2993     5219    1   DCL 1 MOVEI BASED ALIGNED,
     2994     5220    1         2 * CHAR(I) CALIGNED;
     2995     5221                    /**/
     2996     5222                    /* Auto Variables */
     2997     5223                    /**/
     2998     5224    1   DCL JDCB$ PTR;
     2999     5225    1   DCL FIELD$ PTR;
     3000     5226    1   DCL START$ PTR;
     3001     5227    1   DCL I UBIN;
     3002     5228    1   DCL J UBIN;
     3003     5229    1   DCL REC_OFFSET SBIN;
     3004     5230                    /**/
     3005     5231                    /* Symrefed Variables */
     3006     5232                    /**/
     3007     5233    1   DCL B$JIT$ PTR SYMREF;
     3008     5234    1   DCL B$ROSEG$ PTR SYMREF;
     3009     5235                    /**/
     3010     5236                    /* Equates */
     3011     5237                    /**/
     3012     5238        %EQU BYTE_ALIGNED   = 1;
     3013     5239        %EQU NIBBLE_ALIGNED = 2;
     3014     5240        %EQU BIT_ALIGNED    = 3;
     3015     5241                    /**/
     3016     5242                    /* Constant data */
     3017     5243                    /**/
     3018     5244        %SUB FCG#='0615'O;
     3019     5245        %SUB MID#='17'O;
     3020     5246        %ERRCODE(NAME=FMO$E$NOFLD,COD#=%E$NOFLD);
     3021     5250        %EJECT;
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:578  
     3022     5251    1      JDCB$=B$JIT.DCB$;
     3023     5252    2      IF F$DCB.STARTX~=0 THEN DO;
     3024     5253    2         START$=PINCRW(B$ROSEG$,F$DCB.STARTX);
     3025     5254    2         I=FIELD_START.NWORDS;
     3026     5255    2         CALL FSA$FSP(I,START$);
     3027     5256    2         F$DCB.STARTX=0;
     3028     5257    2         END;
     3029     5258    2      IF F$DCB.FIELDX=0 THEN DO;
     3030     5259    2         B$JIT.ERR=FMO$E$NOFLD;
     3031     5260    2         ALTRETURN;
     3032     5261    2         END;
     3033     5262    1      FIELD$=PINCRW(B$ROSEG$,F$DCB.FIELDX);
     3034     5263    1      I=RECFIELD.NFIELDS+1;
     3035     5264    2      CALL FSA$GSP(I,START$) WHENALTRETURN DO;
     3036     5265    2         ALTRETURN;
     3037     5266    2         END;
     3038     5267    1      F$DCB.STARTX=POFFW(START$,B$ROSEG$);
     3039     5268    1      I=I*4;
     3040     5269    1      START$->MOVEI='0'B;
     3041     5270    1      FIELD_START.NWORDS=I/4;
     3042     5271
     3043     5272    1      REC_OFFSET=0;
     3044     5273    1      I=0;
     3045     5274
     3046     5275    2      DO WHILE(I <= RECFIELD.NFIELDS-1);
     3047     5276
     3048     5277    3         DO CASE(RECFIELD.FIELD.TYPE(I));
     3049     5278
     3050     5279    3         CASE(%LIST_DATATYPE);
     3051     5280                    /* Since the next entry defines the elements of the array,
     3052     5281                       set up the first element so we can get REC_OFFSET
     3053     5282                       for the list.                                       */
     3054     5283    3            CALL FIELD_START_SETUP(I+1);
     3055     5284    3            FIELD_START.OFFSET(I)=FIELD_START.OFFSET(I+1);
     3056     5285                    /* Now, do the remaining number of list elements so
     3057     5286                       REC_OFFSET will be right for the next non-element
     3058     5287                       field following this list.                          */
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:579  
     3059     5288    4            DO J=2 TO RECFIELD.FIELD.LEN(I);
     3060     5289    4               CALL FIELD_START_SETUP(I+1);
     3061     5290    4               END;
     3062     5291                    /* Set the offset for the element definition back to what
     3063     5292                       it was for the first element.                       */
     3064     5293    3            FIELD_START.OFFSET(I+1)=FIELD_START.OFFSET(I);
     3065     5294    3            I=I+1;
     3066     5295
     3067     5296    3         CASE(%VLIST_DATATYPE);
     3068     5297    3            CALL FIELD_START_SETUP(I+1);
     3069     5298    3            FIELD_START.OFFSET(I)=FIELD_START.OFFSET(I+1);
     3070     5299                    /* Since the count field is a separate field entirely,
     3071     5300                       set REC_OFFSET back so we add in the length of zero
     3072     5301                       elements at initialization. So, REC_OFFSET will
     3073     5302                       only have been affected by the alignment requirements
     3074     5303                       of the element type.                               */
     3075     5304    3            REC_OFFSET=FIELD_START.OFFSET(I);
     3076     5305    3            I=I+1;
     3077     5306
     3078     5307    3         CASE(ELSE);
     3079     5308    3            CALL FIELD_START_SETUP(I);
     3080     5309
     3081     5310    3         END;  /* Do Case */
     3082     5311
     3083     5312    2         I=I+1;
     3084     5313    2         END;  /* Do While */
     3085     5314
     3086     5315    1      RETURN;
     3087     5316        %EJECT;
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:580  
     3088     5317    1   FIELD_START_SETUP: PROC(K);
     3089     5318                    /**/
     3090     5319    2   DCL K UBIN;
     3091     5320                    /**/
     3092     5321
     3093     5322    3      DO CASE(RECFIELD.FIELD.TYPE(K));
     3094     5323
     3095     5324    3      CASE(%NO_DATATYPE,%CHAR_DATATYPE);
     3096     5325    3         CALL SET_FIELD_START(%BYTE_ALIGNED);
     3097     5326    3         REC_OFFSET=REC_OFFSET + (RECFIELD.FIELD.LEN(K)*9);
     3098     5327
     3099     5328    3      CASE(%SBIN_DATATYPE,%UBIN_DATATYPE);
     3100     5329    3         CALL SET_FIELD_START(%BIT_ALIGNED);
     3101     5330    3         REC_OFFSET=REC_OFFSET + RECFIELD.FIELD.LEN(K);
     3102     5331
     3103     5332    3      CASE(%SFLT_DATATYPE,%UTS_DATATYPE);
     3104     5333    3         CALL SET_FIELD_START(%BYTE_ALIGNED);
     3105     5334    3         REC_OFFSET=REC_OFFSET + 36;
     3106     5335
     3107     5336    3      CASE(%DFLT_DATATYPE,%DATE_DATATYPE,%TIME_DATATYPE);
     3108     5337    3         CALL SET_FIELD_START(%BYTE_ALIGNED);
     3109     5338    3         REC_OFFSET=REC_OFFSET + 72;
     3110     5339
     3111     5340    3      CASE(%PDLA_DATATYPE,%PDTA_DATATYPE,%PDLE_DATATYPE,
     3112     5341    3           %PDTE_DATATYPE,%PDFLT_DATATYPE,%PDNS_DATATYPE);
     3113     5342    3         CALL SET_FIELD_START(%NIBBLE_ALIGNED);
     3114     5343                    /* Compute the bit length for this packed field.  First,
     3115     5344                       add in the bit length of the even number of bytes in the
     3116     5345                       field. If the field length is even, we're done. Otherwise,
     3117     5346                       we need to know if the field started on an even nibble
     3118     5347                       (byte) or odd nibble boundary so we can tell whether to
     3119     5348                       add 5 bits or 4 bits to the bit length to account for the
     3120     5349                       extra nibble.                                         */
     3121     5350    3         REC_OFFSET=REC_OFFSET + ((RECFIELD.DECFIELD.LEN(K)/2)*9);
     3122     5351    3         IF MOD(RECFIELD.DECFIELD.LEN(K),2)~=0 THEN /* odd length */
     3123     5352    3            IF MOD(REC_OFFSET,9)=0 THEN
     3124     5353    3               REC_OFFSET=REC_OFFSET+5; /* even nibble boundary */
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:581  
     3125     5354    3            ELSE REC_OFFSET=REC_OFFSET+4; /* odd nibble boundary */
     3126     5355
     3127     5356    3      CASE(%TEXTC_DATATYPE);
     3128     5357    3         CALL SET_FIELD_START(%BYTE_ALIGNED);
     3129     5358    3         REC_OFFSET=REC_OFFSET + 9; /* For initialization */
     3130     5359
     3131     5360    3      CASE(%TEXTH_DATATYPE);
     3132     5361    3         CALL SET_FIELD_START(%BYTE_ALIGNED);
     3133     5362    3         REC_OFFSET=REC_OFFSET + 18; /* For initialization */
     3134     5363
     3135     5364    3      CASE(%UDNS_DATATYPE,%UDLS_DATATYPE,%UDTS_DATATYPE,
     3136     5365    3           %UDLO_DATATYPE,%UDTO_DATATYPE,%UDFLT_DATATYPE);
     3137     5366    3         CALL SET_FIELD_START(%BYTE_ALIGNED);
     3138     5367    3         REC_OFFSET=REC_OFFSET + (RECFIELD.DECFIELD.LEN(K)*9);
     3139     5368
     3140     5369    3      END;     /* Do Case */
     3141     5370
     3142     5371    2      RETURN;
     3143     5372        %EJECT;
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:582  
     3144     5373    2   SET_FIELD_START: PROC (ALIGN_TYPE);
     3145     5374                    /**/
     3146     5375    3   DCL ALIGN_TYPE UBIN;
     3147     5376                    /**/
     3148     5377    3   DCL EVEN UBIN;
     3149     5378                    /**/
     3150     5379
     3151     5380    4      DO CASE(ALIGN_TYPE);
     3152     5381    4      CASE(%BYTE_ALIGNED);
     3153     5382    4         IF MOD(REC_OFFSET,9)~=0 THEN
     3154     5383    4            REC_OFFSET=((REC_OFFSET/9)*9) + 9;
     3155     5384
     3156     5385    4      CASE(%NIBBLE_ALIGNED);
     3157     5386    4         EVEN=(REC_OFFSET/9)*9;
     3158     5387    4         IF REC_OFFSET > EVEN AND REC_OFFSET < EVEN+5 THEN
     3159     5388    4            REC_OFFSET=EVEN+5;
     3160     5389    4         ELSE IF REC_OFFSET > EVEN+5 THEN
     3161     5390    4               REC_OFFSET=EVEN+9;
     3162     5391
     3163     5392    4      CASE(%BIT_ALIGNED);
     3164     5393                    /* Don't need to do anything. */
     3165     5394
     3166     5395    4      END;     /* Do Case */
     3167     5396
     3168     5397    3      FIELD_START.OFFSET(K)=REC_OFFSET; /* K defined in FIELD_START_SETUP */
     3169     5398    3      RETURN;
     3170     5399
     3171     5400    3   END SET_FIELD_START;
     3172     5401
     3173     5402    2   END FIELD_START_SETUP;
     3174     5403
     3175     5404    1   END FMO$FIELD_START_SETUP;

PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:583  
--  Include file information  --

   B$OBJECT_C.:E05TOU  is referenced.
   FM_FIELD_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   F$CP6V_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FMO$FIELD_START_SETUP.

   Procedure FMO$FIELD_START_SETUP requires 392 words for executable code.
   Procedure FMO$FIELD_START_SETUP requires 22 words of local(AUTO) storage.

    No errors detected in file FMO$OBSE.:E05TSI    .

PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:584  

 Object Unit name= FMO$FIELD_START_SETUP                      File name= FMO$OBSE.:E05TOU
 UTS= JUL 29 '97 16:59:04.92 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  FMO$FIELD_START_SETUP
    1   Proc  even  none   392    610  FMO$FIELD_START_SETUP
    2  RoData even  none     3      3  FMO$FIELD_START_SETUP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        0  FMO$FIELD_START_SETUP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 FSA$FSP
 yes     yes           Std       2 FSA$GSP
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                B$ROSEG$                              B_VECTNIL
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:585  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:586  


     2912        1        /*T***********************************************************/
     2913        2        /*T*                                                         */
     2914        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2915        4        /*T*                                                         */
     2916        5        /*T***********************************************************/
     2917        6        FMO$FIELD_START_SETUP: PROC ALTRET;

      6  1 000000   000000 700200 xent  FMO$FIELD_S* TSX0  ! X66_AUTO_0
         1 000001   000026 000000                    ZERO    22,0

     2918        7                    /*F*     NAME:     FMO$FIELD_START_SETUP
     2919        8
     2920        9                             PURPOSE:  To set up the FM$FIELD_START array in the ROSEG
     2921       10                                       from information in a VLP_RECFIELD or CODE18
     2922       11                                       structure which is known to contain legal field
     2923       12                                       definitions.
     2924       13                    */
     2925       14                    /*D*     NAME:     FMO$FIELD_START_SETUP
     2926       15
     2927       16                             CALL:    CALL FMO$FIELD_START_SETUP(VLP_RECFIELD) ALTRET(LBL);
     2928       17                             INPUT:    F$DCB.FIELDX, indicating an existing area in the
     2929       18                                       ROSEG which contains a VLP_RECFIELD structure
     2930       19                                       known to contain legal field definitions.
     2931       20
     2932       21                                       F$DCB.STARTX=0
     2933       22
     2934       23                             OUTPUT:   F$DCB.STARTX, set to a ROSEG offset.
     2935       24
     2936       25                                       Initial field offsets placed in the FM$FIELD_START
     2937       26                                       array for each field in VLP_RECFIELD.
     2938       27
     2939       28                             DESCRIPTION:
     2940       29                                       An area in the ROSEG is located for FM$FIELD_START
     2941       30                                       and F$DCB.STARTX is set.  Then, elements in the
     2942       31                                       FM$FIELD_START array are set to contain the offset,
     2943       32                                       in bits, from the start of a record to the start
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:587  
     2944       33                                       of a field defined in VLP_RECFIELD.  The index
     2945       34                                       into the FM$FIELD_START array for each field is
     2946       35                                       the same as its index in the VLP_RECFIELD field
     2947       36                                       array (VLP_RECFIELD.FIELD or VLP_RECFIELD.DECFIELD).
     2948       37                                       Field offsets must be computed in accordance with
     2949       38                                       the data types specified.  All fields must be on
     2950       39                                       byte boundaries except packed decimal which can be
     2951       40                                       on nibble boundaries and integer (SBIN, UBIN) which
     2952       41                                       can be on bit boundaries.  If fields are specified
     2953       42                                       in an order that would place a field on a boundary
     2954       43                                       which is not normally legal, slack bits will be
     2955       44                                       inserted until a legal boundary is reached.  These
     2956       45                                       slack bits will not be inserted into the
     2957       46                                       VLP_RECFIELD structure, but will be reflected in
     2958       47                                       the bit offsets placed in the FM$FIELD_START array.
     2959       48
     2960       49                                       VLP_RECFIELD fields are assumed to have been
     2961       50                                       verified already to assure that they specify legal
     2962       51                                       data types, lengths, and scale values.  (See
     2963       52                                       FMO$CHKRECFIELD).
     2964       53
     2965       54                                       The altreturn will be taken if no space was
     2966       55                                       available in the ROSEG for FIELD_START or if
     2967       56                                       F$DCB.FIELDX=0.
     2968       57                    */
     2969       58                    /**/
     2970       59                    /* Includes */
     2971       60                    /**/
     2972       61        %INCLUDE F$CP6V_C;
     2973      287        %INCLUDE B$JIT;
     2974      890        %MACRO F$DCB(BASED=BASED);
     2975      891        %INCLUDE F$DCB;
     2976      940        %MEND;
     2977      941        %INCLUDE F_ERRORS_C;
     2978     1181        %INCLUDE FM$MACROS;
     2979     1556        %INCLUDE FM_FIELD_C;
     2980     1597        %INCLUDE B$OBJECT_C;
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:588  
     2981     5027        %VREBL_DATATYPES;
     2982     5102                    /**/
     2983     5103                    /* Entry Points */
     2984     5104                    /**/
     2985     5105    1   DCL FSA$FSP ENTRY(2) ALTRET;
     2986     5106    1   DCL FSA$GSP ENTRY(2) ALTRET;
     2987     5107                    /**/
     2988     5108                    /* Based Variables */
     2989     5109                    /**/
     2990     5110        %VLP$RECFIELD_V(FPTN=RECFIELD,BASED="BASED(FIELD$)");
     2991     5147        %FM$FIELD_START(FPTN=FIELD_START,STCLASS="BASED(START$)");
     2992     5169        %F$DCB(BASED="BASED(JDCB$)");
     2993     5219    1   DCL 1 MOVEI BASED ALIGNED,
     2994     5220    1         2 * CHAR(I) CALIGNED;
     2995     5221                    /**/
     2996     5222                    /* Auto Variables */
     2997     5223                    /**/
     2998     5224    1   DCL JDCB$ PTR;
     2999     5225    1   DCL FIELD$ PTR;
     3000     5226    1   DCL START$ PTR;
     3001     5227    1   DCL I UBIN;
     3002     5228    1   DCL J UBIN;
     3003     5229    1   DCL REC_OFFSET SBIN;
     3004     5230                    /**/
     3005     5231                    /* Symrefed Variables */
     3006     5232                    /**/
     3007     5233    1   DCL B$JIT$ PTR SYMREF;
     3008     5234    1   DCL B$ROSEG$ PTR SYMREF;
     3009     5235                    /**/
     3010     5236                    /* Equates */
     3011     5237                    /**/
     3012     5238        %EQU BYTE_ALIGNED   = 1;
     3013     5239        %EQU NIBBLE_ALIGNED = 2;
     3014     5240        %EQU BIT_ALIGNED    = 3;
     3015     5241                    /**/
     3016     5242                    /* Constant data */
     3017     5243                    /**/
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:589  
     3018     5244        %SUB FCG#='0615'O;
     3019     5245        %SUB MID#='17'O;
     3020     5246        %ERRCODE(NAME=FMO$E$NOFLD,COD#=%E$NOFLD);
     3021     5250        %EJECT;
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:590  
     3022     5251    1      JDCB$=B$JIT.DCB$;

   5251  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   000232 236100                    LDQ     154,,PR0
         1 000004   200003 756100                    STQ     JDCB$,,AUTO

     3023     5252    2      IF F$DCB.STARTX~=0 THEN DO;

   5252  1 000005   200003 471500                    LDP1    JDCB$,,AUTO
         1 000006   100057 220100                    LDX0    47,,PR1
         1 000007   000031 600000 1                  TZE     s:5258

     3024     5253    2         START$=PINCRW(B$ROSEG$,F$DCB.STARTX);

   5253  1 000010   000000 636010                    EAQ     0,X0
         1 000011   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000012   200005 756100                    STQ     START$,,AUTO

     3025     5254    2         I=FIELD_START.NWORDS;

   5254  1 000013   200005 473500                    LDP3    START$,,AUTO
         1 000014   300000 235100                    LDA     0,,PR3
         1 000015   200006 755100                    STA     I,,AUTO

     3026     5255    2         CALL FSA$FSP(I,START$);

   5255  1 000016   200005 634500                    EPPR4   START$,,AUTO
         1 000017   200021 454500                    STP4    EVEN+3,,AUTO
         1 000020   200006 635500                    EPPR5   I,,AUTO
         1 000021   200020 455500                    STP5    EVEN+2,,AUTO
         1 000022   200020 630500                    EPPR0   EVEN+2,,AUTO
         1 000023   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000024   000000 701000 xent               TSX1    FSA$FSP
         1 000025   000000 011000                    NOP     0

     3027     5256    2         F$DCB.STARTX=0;

PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:591  
   5256  1 000026   000000 220003                    LDX0    0,DU
         1 000027   200003 470500                    LDP0    JDCB$,,AUTO
         1 000030   000057 740100                    STX0    47,,PR0

     3028     5257    2         END;

     3029     5258    2      IF F$DCB.FIELDX=0 THEN DO;

   5258  1 000031   200003 470500                    LDP0    JDCB$,,AUTO
         1 000032   000054 720100                    LXL0    44,,PR0
         1 000033   000040 601000 1                  TNZ     s:5262

     3030     5259    2         B$JIT.ERR=FMO$E$NOFLD;

   5259  1 000034   000000 236000 0                  LDQ     FMO$E$NOFLD
         1 000035   000000 471400 xsym               LDP1    B$JIT$
         1 000036   100012 756100                    STQ     10,,PR1

     3031     5260    2         ALTRETURN;

   5260  1 000037   000000 702200 xent               TSX2  ! X66_AALT

     3032     5261    2         END;
     3033     5262    1      FIELD$=PINCRW(B$ROSEG$,F$DCB.FIELDX);

   5262  1 000040   000000 636010                    EAQ     0,X0
         1 000041   000000 036000 xsym               ADLQ    B$ROSEG$
         1 000042   200004 756100                    STQ     FIELD$,,AUTO

     3034     5263    1      I=RECFIELD.NFIELDS+1;

   5263  1 000043   200004 471500                    LDP1    FIELD$,,AUTO
         1 000044   100000 236100                    LDQ     0,,PR1
         1 000045   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 000046   000001 036007                    ADLQ    1,DL
         1 000047   200006 756100                    STQ     I,,AUTO

PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:592  
     3035     5264    2      CALL FSA$GSP(I,START$) WHENALTRETURN DO;

   5264  1 000050   200005 633500                    EPPR3   START$,,AUTO
         1 000051   200021 453500                    STP3    EVEN+3,,AUTO
         1 000052   200006 634500                    EPPR4   I,,AUTO
         1 000053   200020 454500                    STP4    EVEN+2,,AUTO
         1 000054   200020 630500                    EPPR0   EVEN+2,,AUTO
         1 000055   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000056   000000 701000 xent               TSX1    FSA$GSP
         1 000057   000061 702000 1                  TSX2    s:5265
         1 000060   000062 710000 1                  TRA     s:5267

     3036     5265    2         ALTRETURN;

   5265  1 000061   000000 702200 xent               TSX2  ! X66_AALT

     3037     5266    2         END;
     3038     5267    1      F$DCB.STARTX=POFFW(START$,B$ROSEG$);

   5267  1 000062   000000 235000 xsym               LDA     B$ROSEG$
         1 000063   000022 771000                    ARL     18
         1 000064   200020 755100                    STA     EVEN+2,,AUTO
         1 000065   200005 236100                    LDQ     START$,,AUTO
         1 000066   000022 772000                    QRL     18
         1 000067   200020 136100                    SBLQ    EVEN+2,,AUTO
         1 000070   000000 620006                    EAX0    0,QL
         1 000071   200003 470500                    LDP0    JDCB$,,AUTO
         1 000072   000057 740100                    STX0    47,,PR0

     3039     5268    1      I=I*4;

   5268  1 000073   200006 236100                    LDQ     I,,AUTO
         1 000074   000002 736000                    QLS     2
         1 000075   200006 756100                    STQ     I,,AUTO

     3040     5269    1      START$->MOVEI='0'B;

PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:593  
   5269  1 000076   200005 471500                    LDP1    START$,,AUTO
         1 000077   000000 621006                    EAX1    0,QL
         1 000100   000140 100400                    MLR     fill='000'O
         1 000101   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000102   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     3041     5270    1      FIELD_START.NWORDS=I/4;

   5270  1 000103   200006 236100                    LDQ     I,,AUTO
         1 000104   000002 772000                    QRL     2
         1 000105   200005 471500                    LDP1    START$,,AUTO
         1 000106   100000 756100                    STQ     0,,PR1

     3042     5271
     3043     5272    1      REC_OFFSET=0;

   5272  1 000107   200010 450100                    STZ     REC_OFFSET,,AUTO

     3044     5273    1      I=0;

   5273  1 000110   200006 450100                    STZ     I,,AUTO

     3045     5274
     3046     5275    2      DO WHILE(I <= RECFIELD.NFIELDS-1);

   5275  1 000111   000232 710000 1                  TRA     s:5313

     3047     5276
     3048     5277    3         DO CASE(RECFIELD.FIELD.TYPE(I));

   5277  1 000112   200006 236100                    LDQ     I,,AUTO
         1 000113   000003 402007                    MPY     3,DL
         1 000114   200004 470500                    LDP0    FIELD$,,AUTO
         1 000115   000100 101506                    MRL     fill='000'O
         1 000116   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
         1 000117   200020 020006                    ADSC6   EVEN+2,,AUTO             cn=0,n=6
         1 000120   200020 236100                    LDQ     EVEN+2,,AUTO
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:594  
         1 000121   000057 136007                    SBLQ    47,DL
         1 000122   000002 116007                    CMPQ    2,DL
         1 000123   000125 602006 1                  TNC     s:5277+11,QL
         1 000124   000223 710000 1                  TRA     s:5308
         1 000125   000127 710000 1                  TRA     s:5283
         1 000126   000200 710000 1                  TRA     s:5297

     3049     5278
     3050     5279    3         CASE(%LIST_DATATYPE);

     3051     5280                    /* Since the next entry defines the elements of the array,
     3052     5281                       set up the first element so we can get REC_OFFSET
     3053     5282                       for the list.                                       */
     3054     5283    3            CALL FIELD_START_SETUP(I+1);

   5283  1 000127   200006 235100                    LDA     I,,AUTO
         1 000130   000001 035007                    ADLA    1,DL
         1 000131   200022 755100                    STA     EVEN+4,,AUTO
         1 000132   200022 631500                    EPPR1   EVEN+4,,AUTO
         1 000133   200013 451500                    STP1    REC_OFFSET+3,,AUTO
         1 000134   000241 701000 1                  TSX1    FIELD_START_SETUP
         1 000135   000000 011000                    NOP     0

     3055     5284    3            FIELD_START.OFFSET(I)=FIELD_START.OFFSET(I+1);

   5284  1 000136   200005 470500                    LDP0    START$,,AUTO
         1 000137   200006 720100                    LXL0    I,,AUTO
         1 000140   000002 235110                    LDA     2,X0,PR0
         1 000141   000001 755110                    STA     1,X0,PR0

     3056     5285                    /* Now, do the remaining number of list elements so
     3057     5286                       REC_OFFSET will be right for the next non-element
     3058     5287                       field following this list.                          */
     3059     5288    4            DO J=2 TO RECFIELD.FIELD.LEN(I);

   5288  1 000142   000002 235007                    LDA     2,DL
         1 000143   200007 755100                    STA     J,,AUTO
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:595  
         1 000144   000157 710000 1                  TRA     s:5290+3

     3060     5289    4               CALL FIELD_START_SETUP(I+1);

   5289  1 000145   200006 235100                    LDA     I,,AUTO
         1 000146   000001 035007                    ADLA    1,DL
         1 000147   200023 755100                    STA     EVEN+5,,AUTO
         1 000150   200023 630500                    EPPR0   EVEN+5,,AUTO
         1 000151   200013 450500                    STP0    REC_OFFSET+3,,AUTO
         1 000152   000241 701000 1                  TSX1    FIELD_START_SETUP
         1 000153   000000 011000                    NOP     0

     3061     5290    4               END;

   5290  1 000154   200007 235100                    LDA     J,,AUTO
         1 000155   000001 035007                    ADLA    1,DL
         1 000156   200007 755100                    STA     J,,AUTO
         1 000157   200006 236100                    LDQ     I,,AUTO
         1 000160   000003 402007                    MPY     3,DL
         1 000161   200004 470500                    LDP0    FIELD$,,AUTO
         1 000162   000100 101506                    MRL     fill='000'O
         1 000163   000001 120002                    ADSC6   1,Q,PR0                  cn=1,n=2
         1 000164   200020 020006                    ADSC6   EVEN+2,,AUTO             cn=0,n=6
         1 000165   200020 236100                    LDQ     EVEN+2,,AUTO
         1 000166   200007 116100                    CMPQ    J,,AUTO
         1 000167   000145 603000 1                  TRC     s:5289

     3062     5291                    /* Set the offset for the element definition back to what
     3063     5292                       it was for the first element.                       */
     3064     5293    3            FIELD_START.OFFSET(I+1)=FIELD_START.OFFSET(I);

   5293  1 000170   200005 471500                    LDP1    START$,,AUTO
         1 000171   200006 720100                    LXL0    I,,AUTO
         1 000172   100001 235110                    LDA     1,X0,PR1
         1 000173   100002 755110                    STA     2,X0,PR1

     3065     5294    3            I=I+1;
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:596  

   5294  1 000174   200006 235100                    LDA     I,,AUTO
         1 000175   000001 035007                    ADLA    1,DL
         1 000176   200006 755100                    STA     I,,AUTO
         1 000177   000227 710000 1                  TRA     s:5312

     3066     5295
     3067     5296    3         CASE(%VLIST_DATATYPE);

     3068     5297    3            CALL FIELD_START_SETUP(I+1);

   5297  1 000200   200006 235100                    LDA     I,,AUTO
         1 000201   000001 035007                    ADLA    1,DL
         1 000202   200024 755100                    STA     EVEN+6,,AUTO
         1 000203   200024 631500                    EPPR1   EVEN+6,,AUTO
         1 000204   200013 451500                    STP1    REC_OFFSET+3,,AUTO
         1 000205   000241 701000 1                  TSX1    FIELD_START_SETUP
         1 000206   000000 011000                    NOP     0

     3069     5298    3            FIELD_START.OFFSET(I)=FIELD_START.OFFSET(I+1);

   5298  1 000207   200005 470500                    LDP0    START$,,AUTO
         1 000210   200006 720100                    LXL0    I,,AUTO
         1 000211   000002 235110                    LDA     2,X0,PR0
         1 000212   000001 755110                    STA     1,X0,PR0

     3070     5299                    /* Since the count field is a separate field entirely,
     3071     5300                       set REC_OFFSET back so we add in the length of zero
     3072     5301                       elements at initialization. So, REC_OFFSET will
     3073     5302                       only have been affected by the alignment requirements
     3074     5303                       of the element type.                               */
     3075     5304    3            REC_OFFSET=FIELD_START.OFFSET(I);

   5304  1 000213   200005 470500                    LDP0    START$,,AUTO
         1 000214   200006 720100                    LXL0    I,,AUTO
         1 000215   000001 235110                    LDA     1,X0,PR0
         1 000216   200010 755100                    STA     REC_OFFSET,,AUTO
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:597  

     3076     5305    3            I=I+1;

   5305  1 000217   200006 236100                    LDQ     I,,AUTO
         1 000220   000001 036007                    ADLQ    1,DL
         1 000221   200006 756100                    STQ     I,,AUTO
         1 000222   000227 710000 1                  TRA     s:5312

     3077     5306
     3078     5307    3         CASE(ELSE);

     3079     5308    3            CALL FIELD_START_SETUP(I);

   5308  1 000223   200006 631500                    EPPR1   I,,AUTO
         1 000224   200013 451500                    STP1    REC_OFFSET+3,,AUTO
         1 000225   000241 701000 1                  TSX1    FIELD_START_SETUP
         1 000226   000000 011000                    NOP     0

     3080     5309
     3081     5310    3         END;  /* Do Case */

     3082     5311
     3083     5312    2         I=I+1;

   5312  1 000227   200006 235100                    LDA     I,,AUTO
         1 000230   000001 035007                    ADLA    1,DL
         1 000231   200006 755100                    STA     I,,AUTO

     3084     5313    2         END;  /* Do While */

   5313  1 000232   200004 470500                    LDP0    FIELD$,,AUTO
         1 000233   000000 236100                    LDQ     0,,PR0
         1 000234   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 000235   200006 116100                    CMPQ    I,,AUTO
         1 000236   000240 600000 1                  TZE     s:5315
         1 000237   000112 603000 1                  TRC     s:5277

PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:598  
     3085     5314
     3086     5315    1      RETURN;

   5315  1 000240   000000 702200 xent               TSX2  ! X66_ARET

     3087     5316        %EJECT;
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:599  
     3088     5317    1   FIELD_START_SETUP: PROC(K);

   5317  1 000241   200012 741300       FIELD_START* STX1  ! REC_OFFSET+2,,AUTO

     3089     5318                    /**/
     3090     5319    2   DCL K UBIN;
     3091     5320                    /**/
     3092     5321
     3093     5322    3      DO CASE(RECFIELD.FIELD.TYPE(K));

   5322  1 000242   200013 470500                    LDP0    @K,,AUTO
         1 000243   000000 236100                    LDQ     0,,PR0
         1 000244   000003 402007                    MPY     3,DL
         1 000245   200004 471500                    LDP1    FIELD$,,AUTO
         1 000246   000100 101506                    MRL     fill='000'O
         1 000247   100001 020001                    ADSC6   1,Q,PR1                  cn=0,n=1
         1 000250   200020 020003                    ADSC6   EVEN+2,,AUTO             cn=0,n=3
         1 000251   200020 220100                    LDX0    EVEN+2,,AUTO
         1 000252   000072 100003                    CMPX0   58,DU
         1 000253   000255 602010 1                  TNC     s:5322+11,X0
         1 000254   000524 710000 1                  TRA     s:5371
         1 000255   000347 710000 1                  TRA     s:5325
         1 000256   000367 710000 1                  TRA     s:5329
         1 000257   000524 710000 1                  TRA     s:5371
         1 000260   000406 710000 1                  TRA     s:5333
         1 000261   000415 710000 1                  TRA     s:5337
         1 000262   000524 710000 1                  TRA     s:5371
         1 000263   000524 710000 1                  TRA     s:5371
         1 000264   000524 710000 1                  TRA     s:5371
         1 000265   000524 710000 1                  TRA     s:5371
         1 000266   000424 710000 1                  TRA     s:5342
         1 000267   000424 710000 1                  TRA     s:5342
         1 000270   000524 710000 1                  TRA     s:5371
         1 000271   000524 710000 1                  TRA     s:5371
         1 000272   000524 710000 1                  TRA     s:5371
         1 000273   000524 710000 1                  TRA     s:5371
         1 000274   000524 710000 1                  TRA     s:5371
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:600  
         1 000275   000524 710000 1                  TRA     s:5371
         1 000276   000524 710000 1                  TRA     s:5371
         1 000277   000524 710000 1                  TRA     s:5371
         1 000300   000524 710000 1                  TRA     s:5371
         1 000301   000524 710000 1                  TRA     s:5371
         1 000302   000347 710000 1                  TRA     s:5325
         1 000303   000467 710000 1                  TRA     s:5357
         1 000304   000524 710000 1                  TRA     s:5371
         1 000305   000367 710000 1                  TRA     s:5329
         1 000306   000424 710000 1                  TRA     s:5342
         1 000307   000524 710000 1                  TRA     s:5371
         1 000310   000524 710000 1                  TRA     s:5371
         1 000311   000524 710000 1                  TRA     s:5371
         1 000312   000524 710000 1                  TRA     s:5371
         1 000313   000524 710000 1                  TRA     s:5371
         1 000314   000424 710000 1                  TRA     s:5342
         1 000315   000524 710000 1                  TRA     s:5371
         1 000316   000524 710000 1                  TRA     s:5371
         1 000317   000524 710000 1                  TRA     s:5371
         1 000320   000524 710000 1                  TRA     s:5371
         1 000321   000524 710000 1                  TRA     s:5371
         1 000322   000524 710000 1                  TRA     s:5371
         1 000323   000524 710000 1                  TRA     s:5371
         1 000324   000524 710000 1                  TRA     s:5371
         1 000325   000424 710000 1                  TRA     s:5342
         1 000326   000505 710000 1                  TRA     s:5366
         1 000327   000505 710000 1                  TRA     s:5366
         1 000330   000505 710000 1                  TRA     s:5366
         1 000331   000505 710000 1                  TRA     s:5366
         1 000332   000505 710000 1                  TRA     s:5366
         1 000333   000524 710000 1                  TRA     s:5371
         1 000334   000524 710000 1                  TRA     s:5371
         1 000335   000524 710000 1                  TRA     s:5371
         1 000336   000524 710000 1                  TRA     s:5371
         1 000337   000505 710000 1                  TRA     s:5366
         1 000340   000424 710000 1                  TRA     s:5342
         1 000341   000524 710000 1                  TRA     s:5371
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:601  
         1 000342   000524 710000 1                  TRA     s:5371
         1 000343   000415 710000 1                  TRA     s:5337
         1 000344   000406 710000 1                  TRA     s:5333
         1 000345   000476 710000 1                  TRA     s:5361
         1 000346   000415 710000 1                  TRA     s:5337

     3094     5323
     3095     5324    3      CASE(%NO_DATATYPE,%CHAR_DATATYPE);

     3096     5325    3         CALL SET_FIELD_START(%BYTE_ALIGNED);

   5325  1 000347   000000 236000 2                  LDQ     0
         1 000350   200015 756100                    STQ     @K+2,,AUTO
         1 000351   000526 701000 1                  TSX1    SET_FIELD_START
         1 000352   000000 011000                    NOP     0

     3097     5326    3         REC_OFFSET=REC_OFFSET + (RECFIELD.FIELD.LEN(K)*9);

   5326  1 000353   200013 470500                    LDP0    @K,,AUTO
         1 000354   000000 236100                    LDQ     0,,PR0
         1 000355   000003 402007                    MPY     3,DL
         1 000356   200004 471500                    LDP1    FIELD$,,AUTO
         1 000357   000100 101506                    MRL     fill='000'O
         1 000360   100001 120002                    ADSC6   1,Q,PR1                  cn=1,n=2
         1 000361   200020 020006                    ADSC6   EVEN+2,,AUTO             cn=0,n=6
         1 000362   200020 236100                    LDQ     EVEN+2,,AUTO
         1 000363   000011 402007                    MPY     9,DL
         1 000364   200010 036100                    ADLQ    REC_OFFSET,,AUTO
         1 000365   200010 756100                    STQ     REC_OFFSET,,AUTO
         1 000366   000524 710000 1                  TRA     s:5371

     3098     5327
     3099     5328    3      CASE(%SBIN_DATATYPE,%UBIN_DATATYPE);

     3100     5329    3         CALL SET_FIELD_START(%BIT_ALIGNED);

   5329  1 000367   000001 236000 2                  LDQ     1
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:602  
         1 000370   200015 756100                    STQ     @K+2,,AUTO
         1 000371   000526 701000 1                  TSX1    SET_FIELD_START
         1 000372   000000 011000                    NOP     0

     3101     5330    3         REC_OFFSET=REC_OFFSET + RECFIELD.FIELD.LEN(K);

   5330  1 000373   200013 470500                    LDP0    @K,,AUTO
         1 000374   000000 236100                    LDQ     0,,PR0
         1 000375   000003 402007                    MPY     3,DL
         1 000376   200004 471500                    LDP1    FIELD$,,AUTO
         1 000377   000100 101506                    MRL     fill='000'O
         1 000400   100001 120002                    ADSC6   1,Q,PR1                  cn=1,n=2
         1 000401   200020 020006                    ADSC6   EVEN+2,,AUTO             cn=0,n=6
         1 000402   200020 236100                    LDQ     EVEN+2,,AUTO
         1 000403   200010 036100                    ADLQ    REC_OFFSET,,AUTO
         1 000404   200010 756100                    STQ     REC_OFFSET,,AUTO
         1 000405   000524 710000 1                  TRA     s:5371

     3102     5331
     3103     5332    3      CASE(%SFLT_DATATYPE,%UTS_DATATYPE);

     3104     5333    3         CALL SET_FIELD_START(%BYTE_ALIGNED);

   5333  1 000406   000000 236000 2                  LDQ     0
         1 000407   200015 756100                    STQ     @K+2,,AUTO
         1 000410   000526 701000 1                  TSX1    SET_FIELD_START
         1 000411   000000 011000                    NOP     0

     3105     5334    3         REC_OFFSET=REC_OFFSET + 36;

   5334  1 000412   000044 236007                    LDQ     36,DL
         1 000413   200010 056100                    ASQ     REC_OFFSET,,AUTO
         1 000414   000524 710000 1                  TRA     s:5371

     3106     5335
     3107     5336    3      CASE(%DFLT_DATATYPE,%DATE_DATATYPE,%TIME_DATATYPE);

PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:603  
     3108     5337    3         CALL SET_FIELD_START(%BYTE_ALIGNED);

   5337  1 000415   000000 236000 2                  LDQ     0
         1 000416   200015 756100                    STQ     @K+2,,AUTO
         1 000417   000526 701000 1                  TSX1    SET_FIELD_START
         1 000420   000000 011000                    NOP     0

     3109     5338    3         REC_OFFSET=REC_OFFSET + 72;

   5338  1 000421   000110 236007                    LDQ     72,DL
         1 000422   200010 056100                    ASQ     REC_OFFSET,,AUTO
         1 000423   000524 710000 1                  TRA     s:5371

     3110     5339
     3111     5340    3      CASE(%PDLA_DATATYPE,%PDTA_DATATYPE,%PDLE_DATATYPE,

     3112     5341    3           %PDTE_DATATYPE,%PDFLT_DATATYPE,%PDNS_DATATYPE);
     3113     5342    3         CALL SET_FIELD_START(%NIBBLE_ALIGNED);

   5342  1 000424   000002 236000 2                  LDQ     2
         1 000425   200015 756100                    STQ     @K+2,,AUTO
         1 000426   000526 701000 1                  TSX1    SET_FIELD_START
         1 000427   000000 011000                    NOP     0

     3114     5343                    /* Compute the bit length for this packed field.  First,
     3115     5344                       add in the bit length of the even number of bytes in the
     3116     5345                       field. If the field length is even, we're done. Otherwise,
     3117     5346                       we need to know if the field started on an even nibble
     3118     5347                       (byte) or odd nibble boundary so we can tell whether to
     3119     5348                       add 5 bits or 4 bits to the bit length to account for the
     3120     5349                       extra nibble.                                         */
     3121     5350    3         REC_OFFSET=REC_OFFSET + ((RECFIELD.DECFIELD.LEN(K)/2)*9);

   5350  1 000430   200013 470500                    LDP0    @K,,AUTO
         1 000431   000000 236100                    LDQ     0,,PR0
         1 000432   000003 402007                    MPY     3,DL
         1 000433   200004 471500                    LDP1    FIELD$,,AUTO
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:604  
         1 000434   000100 101506                    MRL     fill='000'O
         1 000435   100001 120001                    ADSC6   1,Q,PR1                  cn=1,n=1
         1 000436   200020 020006                    ADSC6   EVEN+2,,AUTO             cn=0,n=6
         1 000437   200020 236100                    LDQ     EVEN+2,,AUTO
         1 000440   000001 772000                    QRL     1
         1 000441   000011 402007                    MPY     9,DL
         1 000442   200010 036100                    ADLQ    REC_OFFSET,,AUTO
         1 000443   200010 756100                    STQ     REC_OFFSET,,AUTO

     3122     5351    3         IF MOD(RECFIELD.DECFIELD.LEN(K),2)~=0 THEN /* odd length */

   5351  1 000444   000000 236100                    LDQ     0,,PR0
         1 000445   000003 402007                    MPY     3,DL
         1 000446   000100 101506                    MRL     fill='000'O
         1 000447   100001 120001                    ADSC6   1,Q,PR1                  cn=1,n=1
         1 000450   200020 020006                    ADSC6   EVEN+2,,AUTO             cn=0,n=6
         1 000451   200020 236100                    LDQ     EVEN+2,,AUTO
         1 000452   000001 376007                    ANQ     1,DL
         1 000453   000524 600000 1                  TZE     s:5371

     3123     5352    3            IF MOD(REC_OFFSET,9)=0 THEN

   5352  1 000454   200010 236100                    LDQ     REC_OFFSET,,AUTO
         1 000455   000011 506007                    DIV     9,DL
         1 000456   000044 733000                    LRS     36
         1 000457   000000 116003                    CMPQ    0,DU
         1 000460   000464 601000 1                  TNZ     s:5354

     3124     5353    3               REC_OFFSET=REC_OFFSET+5; /* even nibble boundary */

   5353  1 000461   000005 236007                    LDQ     5,DL
         1 000462   200010 056100                    ASQ     REC_OFFSET,,AUTO
         1 000463   000524 710000 1                  TRA     s:5371

     3125     5354    3            ELSE REC_OFFSET=REC_OFFSET+4; /* odd nibble boundary */

   5354  1 000464   000004 236007                    LDQ     4,DL
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:605  
         1 000465   200010 056100                    ASQ     REC_OFFSET,,AUTO
         1 000466   000524 710000 1                  TRA     s:5371

     3126     5355
     3127     5356    3      CASE(%TEXTC_DATATYPE);

     3128     5357    3         CALL SET_FIELD_START(%BYTE_ALIGNED);

   5357  1 000467   000000 236000 2                  LDQ     0
         1 000470   200015 756100                    STQ     @K+2,,AUTO
         1 000471   000526 701000 1                  TSX1    SET_FIELD_START
         1 000472   000000 011000                    NOP     0

     3129     5358    3         REC_OFFSET=REC_OFFSET + 9; /* For initialization */

   5358  1 000473   000011 236007                    LDQ     9,DL
         1 000474   200010 056100                    ASQ     REC_OFFSET,,AUTO
         1 000475   000524 710000 1                  TRA     s:5371

     3130     5359
     3131     5360    3      CASE(%TEXTH_DATATYPE);

     3132     5361    3         CALL SET_FIELD_START(%BYTE_ALIGNED);

   5361  1 000476   000000 236000 2                  LDQ     0
         1 000477   200015 756100                    STQ     @K+2,,AUTO
         1 000500   000526 701000 1                  TSX1    SET_FIELD_START
         1 000501   000000 011000                    NOP     0

     3133     5362    3         REC_OFFSET=REC_OFFSET + 18; /* For initialization */

   5362  1 000502   000022 236007                    LDQ     18,DL
         1 000503   200010 056100                    ASQ     REC_OFFSET,,AUTO
         1 000504   000524 710000 1                  TRA     s:5371

     3134     5363
     3135     5364    3      CASE(%UDNS_DATATYPE,%UDLS_DATATYPE,%UDTS_DATATYPE,
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:606  

     3136     5365    3           %UDLO_DATATYPE,%UDTO_DATATYPE,%UDFLT_DATATYPE);
     3137     5366    3         CALL SET_FIELD_START(%BYTE_ALIGNED);

   5366  1 000505   000000 236000 2                  LDQ     0
         1 000506   200015 756100                    STQ     @K+2,,AUTO
         1 000507   000526 701000 1                  TSX1    SET_FIELD_START
         1 000510   000000 011000                    NOP     0

     3138     5367    3         REC_OFFSET=REC_OFFSET + (RECFIELD.DECFIELD.LEN(K)*9);

   5367  1 000511   200013 470500                    LDP0    @K,,AUTO
         1 000512   000000 236100                    LDQ     0,,PR0
         1 000513   000003 402007                    MPY     3,DL
         1 000514   200004 471500                    LDP1    FIELD$,,AUTO
         1 000515   000100 101506                    MRL     fill='000'O
         1 000516   100001 120001                    ADSC6   1,Q,PR1                  cn=1,n=1
         1 000517   200020 020006                    ADSC6   EVEN+2,,AUTO             cn=0,n=6
         1 000520   200020 236100                    LDQ     EVEN+2,,AUTO
         1 000521   000011 402007                    MPY     9,DL
         1 000522   200010 036100                    ADLQ    REC_OFFSET,,AUTO
         1 000523   200010 756100                    STQ     REC_OFFSET,,AUTO

     3139     5368
     3140     5369    3      END;     /* Do Case */

     3141     5370
     3142     5371    2      RETURN;

   5371  1 000524   200012 221300                    LDX1  ! REC_OFFSET+2,,AUTO
         1 000525   000001 702211                    TSX2  ! 1,X1

     3143     5372        %EJECT;
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:607  
     3144     5373    2   SET_FIELD_START: PROC (ALIGN_TYPE);

   5373  1 000526   200014 741300       SET_FIELD_S* STX1  ! @K+1,,AUTO

     3145     5374                    /**/
     3146     5375    3   DCL ALIGN_TYPE UBIN;
     3147     5376                    /**/
     3148     5377    3   DCL EVEN UBIN;
     3149     5378                    /**/
     3150     5379
     3151     5380    4      DO CASE(ALIGN_TYPE);

   5380  1 000527   200015 470500                    LDP0    @ALIGN_TYPE,,AUTO
         1 000530   000000 235100                    LDA     0,,PR0
         1 000531   000003 115007                    CMPA    3,DL
         1 000532   000534 602005 1                  TNC     s:5380+5,AL
         1 000533   000601 710000 1                  TRA     s:5397
         1 000534   000601 710000 1                  TRA     s:5397
         1 000535   000537 710000 1                  TRA     s:5382
         1 000536   000552 710000 1                  TRA     s:5386

     3152     5381    4      CASE(%BYTE_ALIGNED);

     3153     5382    4         IF MOD(REC_OFFSET,9)~=0 THEN

   5382  1 000537   200010 236100                    LDQ     REC_OFFSET,,AUTO
         1 000540   000011 506007                    DIV     9,DL
         1 000541   000044 733000                    LRS     36
         1 000542   000000 116003                    CMPQ    0,DU
         1 000543   000601 600000 1                  TZE     s:5397

     3154     5383    4            REC_OFFSET=((REC_OFFSET/9)*9) + 9;

   5383  1 000544   200010 236100                    LDQ     REC_OFFSET,,AUTO
         1 000545   000011 506007                    DIV     9,DL
         1 000546   000011 402007                    MPY     9,DL
         1 000547   000011 036007                    ADLQ    9,DL
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:608  
         1 000550   200010 756100                    STQ     REC_OFFSET,,AUTO
         1 000551   000601 710000 1                  TRA     s:5397

     3155     5384
     3156     5385    4      CASE(%NIBBLE_ALIGNED);

     3157     5386    4         EVEN=(REC_OFFSET/9)*9;

   5386  1 000552   200010 236100                    LDQ     REC_OFFSET,,AUTO
         1 000553   000011 506007                    DIV     9,DL
         1 000554   000011 402007                    MPY     9,DL
         1 000555   200016 756100                    STQ     EVEN,,AUTO

     3158     5387    4         IF REC_OFFSET > EVEN AND REC_OFFSET < EVEN+5 THEN

   5387  1 000556   000000 116003                    CMPQ    0,DU
         1 000557   000570 604000 1                  TMI     s:5389
         1 000560   200010 116100                    CMPQ    REC_OFFSET,,AUTO
         1 000561   000570 605000 1                  TPL     s:5389
         1 000562   000005 036007                    ADLQ    5,DL
         1 000563   000566 604000 1                  TMI     s:5388
         1 000564   200010 116100                    CMPQ    REC_OFFSET,,AUTO
         1 000565   000570 604400 1                  TMOZ    s:5389

     3159     5388    4            REC_OFFSET=EVEN+5;

   5388  1 000566   200010 756100                    STQ     REC_OFFSET,,AUTO
         1 000567   000601 710000 1                  TRA     s:5397

     3160     5389    4         ELSE IF REC_OFFSET > EVEN+5 THEN

   5389  1 000570   200016 236100                    LDQ     EVEN,,AUTO
         1 000571   000005 036007                    ADLQ    5,DL
         1 000572   000601 604000 1                  TMI     s:5397
         1 000573   200010 116100                    CMPQ    REC_OFFSET,,AUTO
         1 000574   000601 605000 1                  TPL     s:5397

PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:609  
     3161     5390    4               REC_OFFSET=EVEN+9;

   5390  1 000575   200016 235100                    LDA     EVEN,,AUTO
         1 000576   000011 035007                    ADLA    9,DL
         1 000577   200010 755100                    STA     REC_OFFSET,,AUTO
         1 000600   000601 710000 1                  TRA     s:5397

     3162     5391
     3163     5392    4      CASE(%BIT_ALIGNED);

     3164     5393                    /* Don't need to do anything. */
     3165     5394
     3166     5395    4      END;     /* Do Case */

     3167     5396
     3168     5397    3      FIELD_START.OFFSET(K)=REC_OFFSET; /* K defined in FIELD_START_SETUP */

   5397  1 000601   200013 471500                    LDP1    @K,,AUTO
         1 000602   100000 720100                    LXL0    0,,PR1
         1 000603   200005 473500                    LDP3    START$,,AUTO
         1 000604   200010 235100                    LDA     REC_OFFSET,,AUTO
         1 000605   300001 755110                    STA     1,X0,PR3

     3169     5398    3      RETURN;

   5398  1 000606   200014 221300                    LDX1  ! @K+1,,AUTO
         1 000607   000001 702211                    TSX2  ! 1,X1
     3170     5399
     3171     5400    3   END SET_FIELD_START;
     3172     5401
     3173     5402    2   END FIELD_START_SETUP;
     3174     5403
     3175     5404    1   END FMO$FIELD_START_SETUP;

PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:610  
--  Include file information  --

   B$OBJECT_C.:E05TOU  is referenced.
   FM_FIELD_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   F$CP6V_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FMO$FIELD_START_SETUP.
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:611  

 **** Variables and constants ****

  ****  Section 000 RoData FMO$FIELD_START_SETUP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC        r     1 FMO$E$NOFLD

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/w PTR         r     1 @ALIGN_TYPE               13-0-0/w PTR         r     1 @K
    *0-0-0/w UBIN        r     1 ALIGN_TYPE                16-0-0/w UBIN        r     1 EVEN
     4-0-0/w PTR         r     1 FIELD$                     6-0-0/w UBIN        r     1 I
     7-0-0/w UBIN        r     1 J                          3-0-0/w PTR         r     1 JDCB$
    *0-0-0/w UBIN        r     1 K                         10-0-0/w SBIN        r     1 REC_OFFSET
     5-0-0/w PTR         r     1 START$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$ROSEG$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(72)    r     1 FIELD_START                0-0-0/w ASTR(0)     r     1 MOVEI
     0-0-0/d STRC(54)    r     1 RECFIELD

PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:612  

   Procedure FMO$FIELD_START_SETUP requires 392 words for executable code.
   Procedure FMO$FIELD_START_SETUP requires 22 words of local(AUTO) storage.

    No errors detected in file FMO$OBSE.:E05TSI    .
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:613  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:614  
          MINI XREF LISTING

ALIGN_TYPE IN PROCEDURE SET_FIELD_START
      5375**DCL      5373--PROC     5380>>DOCASE
B$JIT.CPFLAGS1.SLEAZE
       708**DCL       708--REDEF
B$JIT.DCB$
       782**DCL      5251>>ASSIGN
B$JIT.ERR
       614**DCL      5259<<ASSIGN
B$JIT.ERR.MID
       615**DCL       615--REDEF
B$JIT.JRESPEAK
       776**DCL       777--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       885**DCL       885--REDEF     886--REDEF
B$JIT.PNR
       789**DCL       789--REDEF
B$JIT.TSLINE
       883**DCL       884--REDEF
B$JIT$
      5233**DCL       609--IMP-PTR  5251>>ASSIGN   5259>>ASSIGN
B$ROSEG$
      5234**DCL      5253>>ASSIGN   5262>>ASSIGN   5267>>ASSIGN
EVEN IN PROCEDURE SET_FIELD_START
      5377**DCL      5386<<ASSIGN   5387>>IF       5387>>IF       5388>>ASSIGN   5389>>IF       5390>>ASSIGN
F$DCB.ACTPOS
      5195**DCL      5195--REDEF
F$DCB.ARS
      5170**DCL      5170--REDEF
F$DCB.ATTR
      5188**DCL      5189--REDEF
F$DCB.BORROW
      5203**DCL      5203--REDEF    5203--REDEF    5203--REDEF
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:615  
F$DCB.DCBNAME.L
      5217**DCL      5217--IMP-SIZ
F$DCB.EOMCHAR
      5174**DCL      5174--REDEF
F$DCB.FIELDX
      5194**DCL      5258>>IF       5262>>ASSIGN
F$DCB.FLDID
      5198**DCL      5198--REDEF
F$DCB.FORM$
      5192**DCL      5192--REDEF
F$DCB.FSECT
      5208**DCL      5208--REDEF
F$DCB.FSN
      5185**DCL      5185--REDEF    5185--REDEF    5186--REDEF
F$DCB.HEADER$
      5191**DCL      5191--REDEF
F$DCB.IXTNSIZE
      5189**DCL      5189--REDEF
F$DCB.LASTSTA$
      5179**DCL      5179--REDEF
F$DCB.LVL
      5204**DCL      5204--REDEF
F$DCB.NAME.C
      5179**DCL      5179--REDEF
F$DCB.NOEOF
      5200**DCL      5200--REDEF
F$DCB.NRECS
      5190**DCL      5190--REDEF
F$DCB.NRECX
      5209**DCL      5209--REDEF
F$DCB.OHDR
      5201**DCL      5201--REDEF
F$DCB.ORG
      5184**DCL      5184--REDEF
F$DCB.PRECNO
      5207**DCL      5207--REDEF
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:616  
F$DCB.RCSZ
      5212**DCL      5212--REDEF
F$DCB.RES
      5180**DCL      5180--REDEF
F$DCB.SETX
      5192**DCL      5192--REDEF
F$DCB.STARTX
      5195**DCL      5252>>IF       5253>>ASSIGN   5256<<ASSIGN   5267<<ASSIGN
F$DCB.TAB$
      5191**DCL      5192--REDEF
F$DCB.TDA
      5206**DCL      5206--REDEF
F$DCB.WSN
      5181**DCL      5181--REDEF
FIELD$
      5225**DCL      5116--IMP-PTR  5262<<ASSIGN   5263>>ASSIGN   5275>>DOWHILE  5277>>DOCASE   5288>>DOINDEX
      5322>>DOCASE   5326>>ASSIGN   5330>>ASSIGN   5350>>ASSIGN   5351>>IF       5367>>ASSIGN
FIELD_START.NWORDS
      5161**DCL      5254>>ASSIGN   5270<<ASSIGN
FIELD_START.OFFSET
      5163**DCL      5284<<ASSIGN   5284>>ASSIGN   5293<<ASSIGN   5293>>ASSIGN   5298<<ASSIGN   5298>>ASSIGN
      5304>>ASSIGN   5397<<ASSIGN
FIELD_START_SETUP
      5317**PROC     5283--CALL     5289--CALL     5297--CALL     5308--CALL
FMO$E$NOFLD
      5247**DCL      5259>>ASSIGN
FSA$FSP
      5105**DCL-ENT  5255--CALL
FSA$GSP
      5106**DCL-ENT  5264--CALL
I
      5227**DCL      5220--IMP-SIZ  5254<<ASSIGN   5255<>CALL     5263<<ASSIGN   5264<>CALL     5268<<ASSIGN
      5268>>ASSIGN   5269>>ASSIGN   5270>>ASSIGN   5273<<ASSIGN   5275>>DOWHILE  5277>>DOCASE   5283>>CALL
      5284>>ASSIGN   5284>>ASSIGN   5288>>DOINDEX  5289>>CALL     5293>>ASSIGN   5293>>ASSIGN   5294<<ASSIGN
      5294>>ASSIGN   5297>>CALL     5298>>ASSIGN   5298>>ASSIGN   5304>>ASSIGN   5305<<ASSIGN   5305>>ASSIGN
      5308<>CALL     5312<<ASSIGN   5312>>ASSIGN
PL6.E3A0      #008=FMO$FIELD_START_SETUP File=FMO$OBSE.:E05TSI                   TUE 07/29/97 16:59 Page:617  
J
      5228**DCL      5288<<DOINDEX
JDCB$
      5224**DCL      5170--IMP-PTR  5251<<ASSIGN   5252>>IF       5253>>ASSIGN   5256>>ASSIGN   5258>>IF
      5262>>ASSIGN   5267>>ASSIGN
K IN PROCEDURE FIELD_START_SETUP
      5319**DCL      5317--PROC     5322>>DOCASE   5326>>ASSIGN   5330>>ASSIGN   5350>>ASSIGN   5351>>IF
      5367>>ASSIGN   5397>>ASSIGN
MOVEI
      5219**DCL      5269<<ASSIGN
RECFIELD.DECFIELD.LEN
      5123**DCL      5350>>ASSIGN   5351>>IF       5367>>ASSIGN
RECFIELD.FIELD
      5123**DCL      5123--REDEF
RECFIELD.FIELD.LEN
      5123**DCL      5288>>DOINDEX  5326>>ASSIGN   5330>>ASSIGN
RECFIELD.FIELD.TYPE
      5123**DCL      5277>>DOCASE   5322>>DOCASE
RECFIELD.NFIELDS
      5116**DCL      5263>>ASSIGN   5275>>DOWHILE
REC_OFFSET
      5229**DCL      5272<<ASSIGN   5304<<ASSIGN   5326<<ASSIGN   5326>>ASSIGN   5330<<ASSIGN   5330>>ASSIGN
      5334<<ASSIGN   5334>>ASSIGN   5338<<ASSIGN   5338>>ASSIGN   5350<<ASSIGN   5350>>ASSIGN   5352>>IF
      5353<<ASSIGN   5353>>ASSIGN   5354<<ASSIGN   5354>>ASSIGN   5358<<ASSIGN   5358>>ASSIGN   5362<<ASSIGN
      5362>>ASSIGN   5367<<ASSIGN   5367>>ASSIGN   5382>>IF       5383<<ASSIGN   5383>>ASSIGN   5386>>ASSIGN
      5387>>IF       5387>>IF       5388<<ASSIGN   5389>>IF       5390<<ASSIGN   5397>>ASSIGN
SET_FIELD_START IN PROCEDURE FIELD_START_SETUP
      5373**PROC     5325--CALL     5329--CALL     5333--CALL     5337--CALL     5342--CALL     5357--CALL
      5361--CALL     5366--CALL
START$
      5226**DCL      5160--IMP-PTR  5253<<ASSIGN   5254>>ASSIGN   5255<>CALL     5264<>CALL     5267>>ASSIGN
      5269>>ASSIGN   5270>>ASSIGN   5284>>ASSIGN   5284>>ASSIGN   5293>>ASSIGN   5293>>ASSIGN   5298>>ASSIGN
      5298>>ASSIGN   5304>>ASSIGN   5397>>ASSIGN
