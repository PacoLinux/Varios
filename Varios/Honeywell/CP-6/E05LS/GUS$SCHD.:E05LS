VERSION E05

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:1    
        1        1        /*M* GUS$SCHD - Scheduler related user service procedures */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*             */
        8        8        /*P*
        9        9             NAME: GUS$SCHD
       10       10             PURPOSE:
       11       11                  To provide Scheduler related user service procedures
       12       12             DESCRIPTION:
       13       13                  This module includes procedures for the following monitor
       14       14                  services.
       15       15                      M$WAIT
       16       16                      M$CLOCK
       17       17                      M$QFI and M$UQFI
       18       18                      M$EVENT
       19       19             REFERENCE:
       20       20                  The Monitor Services Reference Manual contains description
       21       21                  of the services and FPTs.
       22       22        */
       23       23        /*F*
       24       24             NAME: GUS$CLOCK
       25       25             PURPOSE:
       26       26                  To process the M$CLOCK Monitor Service.
       27       27        */
       28       28        /*D*
       29       29             NAME: GUS$CLOCK
       30       30             CALL:
       31       31             CALL: Standard MCL service decoder call.
       32       32             DESCRIPTION:
       33       33                  This procedure processes the M$CLOCK Monitor Service.
       34       34
       35       35                  If the Set Timer option is requested, the specified time
       36       36                  interval is added to the current time to obtain a Clock
       37       37                  Event time in UTS units.  If the Real Time option is specified
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:2    
       38       38                  an entry is placed in the monitor Clock Queue for the
       39       39                  current user.  The Clock Queue is a linked list of User Table
       40       40                  entries containing a Clock Event time sorted with the
       41       41                  earlier time first.
       42       42
       43       43                  If the Real Time option was not specified, the Clock Event
       44       44                  time is stored in the user's JIT and decremented by the
       45       45                  amount of execution time expended by the user.
       46       46
       47       47                  When the specified time has expired, either as real time,
       48       48                  or execution time, an entry is made on the user's Dolist
       49       49                  to cause entry to the user's Event asynchronous proc-
       50       50                  edure.
       51       51
       52       52                  If the Test Timer option is requested the approriate
       53       53                  time, either Real Time or execution time as specified by
       54       54                  the Real Time option, remaining before the timer will
       55       55                  expire is computed and returned to the user.
       56       56
       57       57                  If the Cancel option is requested the appropriate timer
       58       58                  is canceled and no Event asynchronous entry occurs.
       59       59        */
       60       60        GUS$CLOCK: PROC (PARM);
       61       61
       62       62        %INCLUDE GH_SCHD_E;
       63      158        %INCLUDE GH_SCHD_M;
       64      302 S      %INCLUDE GU_LCP6_M;
       65      303        %INCLUDE GU_MACROS_M;
       66      462        %INCLUDE G$BOBCAT_M;
       67      482        %INCLUDE GFR_DATA_M;
       68      502        %INCLUDE GH_GATE_M;
       69      543 S      %INCLUDE G_LCP6_E;
       70      544        %INCLUDE G_JIT_M;
       71      809 S      %INCLUDE GH_LCP6_M;
       72      810        %INCLUDE G_ROS_M;
       73      892 S      %INCLUDE GF_LCP6_M;
       74      893        %INCLUDE GM_VIRTUAL_E;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:3    
       75     1103        %INCLUDE KL_MACRO_C;
       76     4455        %INCLUDE KL_AFCN_C;
       77     4556        %INCLUDE AZ_SUBS_C;
       78     4625        %INCLUDE G_HJIT_M;
       79     4770        %INCLUDE B_ERRORS_C;
       80     5897
       81     5898
       82     5899        %G$MHJIT (STCLASS="BASED(G$MHJIT$)");
       83    12773        %G$HHJIT;
       84    14917        %G$UHJIT (STCLASS="BASED(G$UHJIT$)");
       85    17891        %G$USER (FPTN="G$USER(0:0)",STCLASS="BASED(G$USRT$)");
       86    17902        %G$USER (STCLASS="BASED(CU$)");
       87    17913        %G$DO;
       88    17976        %G$ROS (STCLASS="BASED(G$ROS$)",FULL=YES);
       89    18927        %G$ECCB;
       90    19003        %G$ROS (FPTN=ROS,STCLASS=BASED,FULL=YES);
       91    19954        %G$JIT (STCLASS="BASED(G$JIT$)");
       92    20368        %G$JIT (FPTN=JIT,STCLASS="BASED(D$)");
       93    20782        %G$JIT_E;
       94    20844        %G$BOBCAT (STCLASS="BASED(G$BOBCAT$)");
       95    20857        %GFR$ACCT (STCLASS="BASED(D$)");
       96    20870        %FPT_CLOCK (FPTN=FPT_CLOCKV,STCLASS="BASED(P1$)",VECTORS=NO);
       97    20894        %FPT_WAIT (FPTN=FPT_WAITV,VECTORS=NO,STCLASS="BASED(P1$)");
       98    20918        %FPT_RUE (FPTN=FPT_RUE,VECTORS=NO,STCLASS="BASED(P1$)");
       99    20941        %KL_STRTU (STCLASS="BASED(P1$)");
      100    21114        %GUD_HAND_PARAMS (FPTN=PARM);           /* FPT parameters                     */
      101    21190
      102    21191        %VLP_ERRCODE (FPTN=NOTAUTH,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      103    21192                      STCLASS=CONSTANT,ERR#=%E$NOTAUTH);
      104    21238        %VLP_ERRCODE (FPTN=NO_MSYS,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      105    21239                      STCLASS=CONSTANT,ERR#=%E$NO_MSYS);
      106    21285        %VLP_ERRCODE (FPTN=BDID,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      107    21286                      STCLASS=CONSTANT,ERR#=%E$BDID);
      108    21332        %VLP_ERRCODE (FPTN=BSUNM,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      109    21333                      STCLASS=CONSTANT,ERR#=%E$BSUNM);
      110    21379        %VLP_ERRCODE (FPTN=BADVECT1,FCG='GU',MID='U',MON='1'B,SEV=G_SEV_ERROR#,
      111    21380                      STCLASS=CONSTANT,ERR#=%E$BADVECT1);
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:4    
      112    21426
      113    21427    1   DCL GHI$UTS ENTRY(1);
      114    21428    1   DCL GHS$RUE ENTRY(4) ALTRET;
      115    21429    1   DCL GHS$REG ENTRY(2) ALTRET;
      116    21430    1   DCL GHS$ADDUSR ENTRY(5);
      117    21431    1   DCL GHH$ASD ENTRY(2);
      118    21432    1   DCL GHR$MON ENTRY;
      119    21433    1   DCL GHR$SRV ENTRY;
      120    21434    1   DCL GMA$RELPS ENTRY(2) ALTRET;
      121    21435    1   DCL GUD$CHKWP ENTRY(1) ALTRET;
      122    21436    1   DCL KNH$SCAN ENTRY(2) ALTRET;
      123    21437
      124    21438
      125    21439    1   DCL INTERVAL UBIN BASED;
      126    21440    1   DCL UTSVALUE UBIN(32) BASED;
      127    21441
      128    21442    1   DCL T UBIN(32);
      129    21443    1   DCL U UBIN(32);
      130    21444    1   DCL J UBIN;
      131    21445    1   DCL I UBIN;
      132    21446    1   DCL A SBIN(32);
      133    21447    1   DCL S SBIN;
      134    21448    1   DCL MAX(0:2) SBIN(32) CONSTANT INIT(%BITBIN('7FFFFFFF'X),8947850,149131);
      135    21449    1   DCL D(0:2) SBIN(32) CONSTANT INIT(1,16,16);
      136    21450    1   DCL C(0:2) UBIN CONSTANT INIT(1,120,7200);
      137    21451    1   DCL P1$ PTR;
      138    21452    1   DCL D$ PTR;
      139    21453    1   DCL CU$ PTR;
      140    21454    1   DCL USER# UBIN;
      141    21455    1   DCL ROSPP UBIN;
      142    21456    1   DCL CODE UBIN;
      143    21457    1   DCL DMN UBIN;
      144    21458    1   DCL GFR@INDX UBIN;
      145    21459    1   DCL GFR@PGSZ UBIN;
      146    21460    1   DCL MODE UBIN;
      147    21461
      148    21462    1   DCL G$JIT$ PTR SYMREF;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:5    
      149    21463    1   DCL G$MHJIT$ PTR SYMREF;
      150    21464    1   DCL G$USRT$ PTR SYMREF;
      151    21465    1   DCL G$UHJIT$ PTR SYMREF;
      152    21466    1   DCL G$ROS$ PTR SYMREF;
      153    21467    1   DCL G$WINDOW1$ PTR SYMREF;
      154    21468    1   DCL G$BOBCAT$ PTR SYMREF READONLY;
      155    21469        %GATE (FPTN=GFR_RES_LOCK,STCLASS=SYMREF);
      156    21488        %GATE (FPTN=G_CLKGATE,STCLASS=SYMREF);
      157    21507    1   DCL GH_CLOCKHD UBIN SYMREF;
      158    21508    1   DCL GM_INIT_PGSZ UBIN SYMREF;
      159    21509    1   DCL GFR_PSUDO_NM(0:7) CHAR(8) SYMREF;
      160    21510    1   DCL GFR_MAX_MEM(0:4) UBIN SYMREF;
      161    21511    1   DCL GFR_CUR_MEM(0:4) UBIN SYMREF;
      162    21512    1   DCL G_MUAIS UBIN SYMREF;
      163    21513    1   DCL GM_ASHUF UBIN(16) SYMREF;
      164    21514    1   DCL GM_HSHUF UBIN(16) SYMREF;
      165    21515
      166    21516        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:6    
      167    21517    1           CU$=G$MHJIT.CU$;
      168    21518    1           P1$=PARM.PTRS.PAR1$;
      169    21519    1           IF G$U.FLG.CPIC THEN
      170    21520    1              DMN=%GH_CPDMN#;
      171    21521    1           ELSE
      172    21522    1              IF G$UHJIT.DMN.ID = %G_DMN_DB_SVC# THEN
      173    21523    1                 DMN=%GH_DBDMN#;
      174    21524    1              ELSE
      175    21525    1                 DMN=%GH_USRDMN#;
      176    21526    2           DO CASE (FPT_CLOCKV.MODE);
      177    21527    2            CASE(%G_SET#);
      178    21528    2              A=PARM.PTRS.PAR2$->INTERVAL;
      179    21529    2              I=MAX(FPT_CLOCKV.UTYPE);
      180    21530    2              A=MOD(A,I);
      181    21531    2              A=A *
      182    21532    2                C(FPT_CLOCKV.UTYPE);
      183    21533    3              DO CASE(FPT_CLOCKV.CLOCK);
      184    21534    3               CASE(%G_WALL#);
      185    21535                      %LOCK (G=G_CLKGATE);
      186    21542    3                 IF G$U.CLOCK ~= 0 THEN
      187    21543    3                    CALL CANCEL;           /* Cancel current clock               */
      188    21544    3                 A = A/D(FPT_CLOCKV.UTYPE);
      189    21545    3                 CALL GHI$UTS (T);
      190    21546    3                 G$U.UTS = T + A;
      191    21547    3                 CALL QWALCLK;
      192    21548                      %UNLOCK (G=G_CLKGATE);
      193    21555    3                 G$JIT.CLUKRLVL = FPT_CLOCKV.LEVEL;
      194    21556    3                 IF FPT_CLOCKV.PERM THEN
      195    21557    3                    G$JIT.CLUKRINT = A;
      196    21558    3                 ELSE
      197    21559    3                    G$JIT.CLUKRINT = 0;
      198    21560    3               CASE(%G_EXECUTION#);
      199    21561    3                 G$JIT.TIMERS(DMN) = G$JIT.XTIME + G$JIT.STIME + A;
      200    21562    3                 IF G$JIT.TIMERS(DMN) < G$JIT.IDELTAT THEN
      201    21563    3                    G$JIT.IDELTAT = G$JIT.TIMERS(DMN);
      202    21564    3                 G$JIT.CLUKXLVL = FPT_CLOCKV.LEVEL;
      203    21565    3                 IF FPT_CLOCKV.PERM THEN
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:7    
      204    21566    3                    G$JIT.CLUKXINT = A;
      205    21567    3                 ELSE
      206    21568    3                    G$JIT.CLUKXINT = 0;
      207    21569    3               END;                        /* End CLOCK cases                    */
      208    21570    2            CASE(%G_TEST#);
      209    21571    3              DO CASE(FPT_CLOCKV.CLOCK);
      210    21572    3               CASE(%G_WALL#);
      211    21573    3                 PARM.ASDT_MCL_INDX = %GM_LPAR2#;
      212    21574    3                 CALL GUD$CHKWP(PARM)
      213    21575    4                 WHENALTRETURN DO;
      214    21576    4                    PARM.ERR = BADVECT1;
      215    21577    4                    RETURN;
      216    21578    4                    END;
      217    21579        /*E* ERROR: GUU-E$BADVECT1-E
      218    21580             MESSAGE: Access to M$CLOCK UNITS parameter is bad.
      219    21581        */
      220    21582    3                 IF G$U.CLOCK ~= 0 THEN
      221    21583    4                 DO;
      222    21584    4                    CALL GHI$UTS (T);
      223    21585    4                    T = G$U.UTS - T;
      224    21586    4                    PARM.PTRS.PAR2$->INTERVAL = T / C(FPT_CLOCKV.UTYPE);
      225    21587    4                    END;
      226    21588    3                 ELSE
      227    21589    3                    PARM.PTRS.PAR2$->INTERVAL = 0;
      228    21590    3               CASE(%G_EXECUTION#);
      229    21591    3                 A = G$JIT.TIMERS(DMN)-G$JIT.STIME-G$JIT.XTIME;
      230    21592    3                 IF A < 0 THEN
      231    21593    3                    A = 0;
      232    21594    3                 PARM.PTRS.PAR2$->INTERVAL = A / C(FPT_CLOCKV.UTYPE);
      233    21595    3               END;                        /* End CLOCK cases                    */
      234    21596    2            END;                           /* End MODE cases                     */
      235    21597    1           IF FPT_CLOCKV.CANCEL THEN
      236    21598    2           DO CASE(FPT_CLOCKV.CLOCK);
      237    21599    2            CASE(%G_WALL#);
      238    21600    2              IF G$U.CLOCK ~= 0 THEN
      239    21601    2                 CALL CANCEL;
      240    21602    2            CASE(%G_EXECUTION#);
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:8    
      241    21603    2              G$JIT.TIMERS(DMN) = 0;
      242    21604    2            END;                           /* End CLOCK cases                    */
      243    21605    1           RETURN;
      244    21606
      245    21607
      246    21608
      247    21609    1   QWALCLK: PROC;
      248    21610
      249    21611        /*  Queue user with those waiting for wall time clocks, in order. */
      250    21612
      251    21613    2           J=0;
      252    21614    2           I= GH_CLOCKHD;
      253    21615    3           DO WHILE ( I ~= -1);
      254    21616    3              IF G$USER.UTS(I) >= G$U.UTS THEN
      255    21617    3                 GOTO GOTIT;
      256    21618    3              J=I;
      257    21619    3              I=G$USER.CLOCK(I);
      258    21620    3              END;
      259    21621    2   GOTIT:  G$U.CLOCK=I;
      260    21622    2           IF J = 0 THEN
      261    21623    2              GH_CLOCKHD = G$MHJIT.CUN;
      262    21624    2           ELSE
      263    21625    2              G$USER.CLOCK(J) = G$MHJIT.CUN;
      264    21626    2           RETURN;
      265    21627    2   END QWALCLK;
      266    21628    1   CANCEL: PROC;
      267    21629
      268    21630        /* Search Clock queue for this user and delete his entry */
      269    21631
      270    21632    3           IF GH_CLOCKHD ~= -1 THEN DO;
      271    21633    3              I=GH_CLOCKHD;
      272    21634    3              J=0;
      273    21635    4              DO WHILE (I ~= -1);
      274    21636    4                 IF I = G$MHJIT.CUN THEN
      275    21637    4                    GOTO CNCL1;
      276    21638    4                 J=I;
      277    21639    4                 I=G$USER.CLOCK(I);
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:9    
      278    21640    4                 END;
      279    21641    3              GOTO CNCL2;
      280    21642    3   CNCL1:     IF J = 0 THEN
      281    21643    3                 GH_CLOCKHD = G$USER.CLOCK(I);
      282    21644    3              ELSE
      283    21645    3                 G$USER.CLOCK(J) = G$USER.CLOCK(I);
      284    21646    3   CNCL2:     G$USER.CLOCK(G$MHJIT.CUN) = 0;
      285    21647    3              END;
      286    21648    2           RETURN;
      287    21649    2   END CANCEL;
      288    21650        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:10   
      289    21651        /*F*
      290    21652              NAME:  GUS$RNDCLK
      291    21653              PURPOSE:
      292    21654                    To cancel an outstanding clock request during rundown.
      293    21655              CALL:
      294    21656                    CALL GUS$RNDCLK ();
      295    21657        */
      296    21658    1   GUS$RNDCLK: ENTRY;
      297    21659
      298    21660                %LOCK (G = G_CLKGATE);
      299    21667    1           CALL CANCEL;
      300    21668                %UNLOCK (G = G_CLKGATE);
      301    21675    1           RETURN;
      302    21676
      303    21677        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:11   
      304    21678        /*F*
      305    21679              NAME:  GUS$RESTRTCLK
      306    21680              PURPOSE:
      307    21681                 To restart a permanent wall time clock.
      308    21682              CALL:
      309    21683                 CALL GUS$RESTRTCLK;
      310    21684        */
      311    21685    1   GUS$RESTRTCLK: ENTRY;
      312    21686
      313    21687    1           CU$=G$MHJIT.CU$;
      314    21688    1           CALL GHI$UTS (T);
      315    21689    1           G$U.UTS = T + G$JIT.CLUKRINT;
      316    21690                %LOCK (G=G_CLKGATE);
      317    21697    1           CALL QWALCLK;
      318    21698                %UNLOCK (G=G_CLKGATE);
      319    21705    1           RETURN;
      320    21706
      321    21707        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:12   
      322    21708        /*F*
      323    21709             NAME: GUS$WAIT
      324    21710             PURPOSE:
      325    21711                  To process the M$WAIT monitor service.
      326    21712                  time.
      327    21713        */
      328    21714        /*D*
      329    21715             NAME: GUS$WAIT
      330    21716             CALL:
      331    21717                   Standard MCL service decoder call.
      332    21718             DESCRIPTION:
      333    21719                  The specified time interval is added to the current time to
      334    21720                  determine when the user is to be awakened. The user is placed
      335    21721                  in the scheduler Wait state queue.
      336    21722        */
      337    21723    1   GUS$WAIT: ENTRY (PARM);
      338    21724
      339    21725        /* Scan the queue before we go to sleep */
      340    21726    1           CALL KNH$SCAN(,T);
      341    21727
      342    21728    1           CALL GHR$MON;
      343    21729    1           P1$=PARM.PTRS.PAR1$;
      344    21730    2           DO CASE (FPT_WAITV.UTYPE);
      345    21731    2            CASE(%G_WAIT_UTS#);
      346    21732    2              CALL GHI$UTS (T);
      347    21733    2              U = PARM.PTRS.PAR2$->UTSVALUE - G$MHJIT.BOOTUTS;
      348    21734    3              IF U <= T THEN DO;
      349    21735    3                 S=0;
      350    21736    3                 GOTO NO_WAIT;
      351    21737    3                 END;
      352    21738    2              S = U-T;
      353    21739    2            CASE(%G_WAIT_SEC#);
      354    21740    2              U = PARM.PTRS.PAR2$->INTERVAL * 15 ;
      355    21741    2              S = U / 2 ;
      356    21742    2            CASE(%G_WAIT_TICS#);
      357    21743    2              S = PARM.PTRS.PAR2$->INTERVAL;
      358    21744    2            END;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:13   
      359    21745
      360    21746    2           DO CASE (FPT_WAITV.MODE);
      361    21747    2            CASE(%G_WAIT_ADJUST#);
      362    21748    2              J = G$JIT.USR#;
      363    21749    2              IF G$USER.US(J) = %GH_W THEN
      364    21750    3              DO;
      365    21751    3                 CALL GHS$RUE (%GH_EVSL,J,S);
      366    21752    3                 S = 0;
      367    21753    3                 END;
      368    21754    2              GOTO NO_WAIT;
      369    21755    2            CASE(%G_WAIT_SUSP#);
      370    21756    2              CU$ = G$MHJIT.CU$;
      371    21757    2              D$ = G$U.DL$;
      372    21758    3              DO WHILE ( D$ ~= ADDR(NIL));
      373    21759    3                 IF D$->G$DO.BUSY THEN
      374    21760    3                    D$ = D$->G$DO.LNK$;
      375    21761    3                 ELSE
      376    21762    4                 DO;
      377    21763    4   NO_WAIT:         IF PARM.MCL.V# = 3 AND PARM.PTRS.PAR3$ ~= ADDR(NIL) THEN
      378    21764    4                       PARM.PTRS.PAR3$->INTERVAL = S;
      379    21765    4                    CALL GHR$SRV;
      380    21766    4                    RETURN;
      381    21767    4                    END;
      382    21768    3                 END;
      383    21769    2              CALL GHS$REG (%GH_EVSL,S);
      384    21770    2              CALL GHI$UTS (T);
      385    21771    2              IF PARM.MCL.V# = 3 AND PARM.PTRS.PAR3$ ~= ADDR(NIL) THEN
      386    21772    2                 IF G$U.MISC < T THEN
      387    21773    2                    PARM.PTRS.PAR3$->INTERVAL = 0;
      388    21774    2                 ELSE
      389    21775    2                    PARM.PTRS.PAR3$->INTERVAL = G$U.MISC-T;
      390    21776    2            END;
      391    21777    1           RETURN;
      392    21778
      393    21779        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:14   
      394    21780        /*F*
      395    21781             NAME: GUS$MAKEUSR
      396    21782             PURPOSE: To process the M$MAKEUSR monitor service.
      397    21783        */
      398    21784        /*D*
      399    21785             NAME: GUS$MAKEUSR
      400    21786             CALL: Standard MCL service decoder call.
      401    21787             DESCRIPTION:
      402    21788                A new user is obtained by calling GHS$ADDUSER and his
      403    21789                context initialized from values passed through the FPT.
      404    21790                An error code is returned if the user cannot be started.
      405    21791                If he is started successfully he beomes executable
      406    21792                immediatly and may begin executing before we return to
      407    21793                the caller.
      408    21794
      409    21795                This service may only be called from NODEADMIN, User #1.
      410    21796                                                                          */
      411    21797    1   GUS$MAKEUSR: ENTRY (PARM);
      412    21798
      413    21799    1           IF G$JIT.USR# ~= 1 THEN
      414    21800    2           DO;
      415    21801    2              PARM.ERR=NOTAUTH;
      416    21802    2              RETURN;
      417    21803    2              END;
      418    21804        /*E* ERROR: GUS-E$NOTAUTH-E
      419    21805             MESSAGE: Only Node Admin may use the M$MAKEUSR monitor service.
      420    21806        */
      421    21807
      422    21808        /* Search the account resource table for this UNAME/ACCT and make
      423    21809           sure niether the max number of FPRGS or memory will be exceeded.
      424    21810        */
      425    21811    1           P1$=PARM.PTRS.PAR1$;
      426    21812    1           MODE=KL_STRTU.MODE;
      427    21813    1           I=KL_STRTU.INTS;                /* Number of interrupts*/
      428    21814    1           GFR@INDX=0;
      429    21815    1           GFR@PGSZ = GM_INIT_PGSZ;
      430    21816
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:15   
      431    21817    1           IF G$BOBCAT.ACCT_RES# ~= 0
      432    21818    2           THEN DO;
      433    21819    2              CODE=0;
      434    21820    2              D$=G$BOBCAT.ACCT_RES$;
      435    21821                   %LOCK (G=GFR_RES_LOCK);
      436    21828    2              IF GFR_CUR_MEM(MODE) + GFR@PGSZ > GFR_MAX_MEM(MODE)
      437    21829    3              THEN DO;
      438    21830    3                 CODE = %E$MODE_MEMLIMIT;
      439    21831    3                 GOTO GFR_END;
      440    21832    3                 END;
      441    21833
      442    21834    3              DO GFR@INDX=0 TO G$BOBCAT.ACCT_RES#;
      443    21835    3                 IF GFR$ACCT.UNAME(GFR@INDX) = KL_STRTU.UNAME
      444    21836    3                   AND GFR$ACCT.ACCN(GFR@INDX) = KL_STRTU.ACCT
      445    21837    4                 THEN DO;
      446    21838    4   SET_ACCRES:      ;
      447    21839    4                    GFR$ACCT.MAX_MEM(GFR@INDX) = KL_STRTU.MACCTMEM;
      448    21840    4                    GFR$ACCT.MAX_FPRGS(GFR@INDX) = KL_STRTU.MACCTFPRG;
      449    21841                            /*Update our tables with the latest SUPER information.    */
      450    21842
      451    21843    4                    IF GFR$ACCT.CUR_FPRGS(GFR@INDX) >= GFR$ACCT.MAX_FPRGS(GFR@INDX)
      452    21844    4                    THEN CODE = %E$MAXFPRGS;
      453    21845
      454    21846    4                    ELSE IF GFR$ACCT.CUR_MEM(GFR@INDX)+GFR@PGSZ
      455    21847    4                         > GFR$ACCT.MAX_MEM(GFR@INDX)
      456    21848    4                       THEN CODE = %E$ACCT_MEMLIMIT;
      457    21849    5                       ELSE DO;
      458    21850    5                          GFR$ACCT.CUR_FPRGS(GFR@INDX) =  GFR$ACCT.CUR_FPRGS(GFR@INDX)+
             21850                                   1;
      459    21851    5                          GFR$ACCT.CUR_MEM(GFR@INDX) =  GFR$ACCT.CUR_MEM(GFR@INDX)+
             21851                                   GFR@PGSZ;
      460    21852    5                          GFR_CUR_MEM(MODE) = GFR_CUR_MEM(MODE) + GFR@PGSZ;
      461    21853    5                          GOTO GFR_END;    /*unlock and continue*/
      462    21854    5                          END;
      463    21855    4                    GFR@INDX = 0;
      464    21856    4                    GOTO GFR_END;          /* unlock and report error*/
      465    21857    4                    END;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:16   
      466    21858    3                 END/*do 0 to GFR_ACCT#*/;
      467    21859
      468    21860        /*E* ERROR: GUS-E$MAXFPRGS-E
      469    21861             MESSAGE: Maximum number of FPRGs for your account has been exceeded.
      470    21862        */
      471    21863        /*E* ERROR: GUS-E$ACCT_MEMLIMIT-E
      472    21864             MESSAGE: Maximum memory for your LCP-6 account has been exceeded.
      473    21865        */
      474    21866
      475    21867        /*E* ERROR: GUS-E$MODE_MEMLIMIT-E
      476    21868             MESSAGE: Maximum memory for your LCP-6 mode has been exceeded.
      477    21869        */
      478    21870
      479    21871        /* If this UNAME/ACCT not already in the acct resource table, get
      480    21872           a table entry for it now.
      481    21873        */
      482    21874    3              DO GFR@INDX=1 TO G$BOBCAT.ACCT_RES#;
      483    21875    3                 IF GFR$ACCT.CUR_FPRGS(GFR@INDX) = 0
      484    21876    4                 THEN DO;
      485    21877    4                    GFR$ACCT.UNAME(GFR@INDX) = KL_STRTU.UNAME;
      486    21878    4                    GFR$ACCT.ACCN(GFR@INDX) = KL_STRTU.ACCT;
      487    21879    4                    GOTO SET_ACCRES;
      488    21880    4                    END;
      489    21881    3                 END/*do 0 to GFR_ACCT#*/;
      490    21882
      491    21883    2              GFR@INDX = 0;
      492    21884    2              CODE = %E$MAXACCT;
      493    21885        /*E* ERROR: GUS-E$MAXACCT-E
      494    21886             MESSAGE: Can't start your FPRG; no entry available in account resource table.
      495    21887        */
      496    21888
      497    21889    2   GFR_END:   ;
      498    21890                   %UNLOCK (G=GFR_RES_LOCK);
      499    21897    2              IF CODE ~= 0 THEN GOTO GFR_ERR;
      500    21898    2              END/*do if GFR_ACCT#*/;
      501    21899
      502    21900
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:17   
      503    21901    1           CALL GHS$ADDUSR (I,MODE,USER#,ROSPP,CODE);
      504    21902    1           IF CODE ~= 0 THEN
      505    21903    2           DO;
      506    21904    2   GFR_ERR:   ;
      507    21905    2              IF GFR@INDX ~= 0
      508    21906    3              THEN DO;
      509    21907                      %LOCK (G=GFR_RES_LOCK);
      510    21914    3                 GFR$ACCT.CUR_FPRGS(GFR@INDX) = GFR$ACCT.CUR_FPRGS(GFR@INDX)-1;
      511    21915    3                 GFR$ACCT.CUR_MEM(GFR@INDX) =  GFR$ACCT.CUR_MEM(GFR@INDX)-GFR@PGSZ;
      512    21916    3                 GFR_CUR_MEM(MODE) = GFR_CUR_MEM(MODE) - GFR@PGSZ;
      513    21917                      %UNLOCK (G=GFR_RES_LOCK);
      514    21924    3                 END;
      515    21925    2              PARM.ERR=NOTAUTH;
      516    21926    2              PARM.ERR.ERR#=CODE;    /* Pass error on back  */
      517    21927    2              RETURN;
      518    21928    2              END;
      519    21929
      520    21930    1           G$UHJIT.ASDT_MCL.WINDOW1.BASE=ROSPP;
      521    21931    1           G$UHJIT.ASDT_MCL.WINDOW1.SIZE=(SIZEW(G$ROS)-1)/256;
      522    21932    1           CALL GHH$ASD (G$WINDOW1$,G$UHJIT.ASDT_MCL.WINDOW1);
      523    21933    1           D$=ADDR(G$WINDOW1$->G$ROS.JIT);
      524    21934
      525    21935    1           CALL GHI$UTS(JIT.JSTART);
      526    21936    1           JIT.JSTART = JIT.JSTART + G$MHJIT.BOOTUTS;
      527    21937    1           JIT.ACCN=KL_STRTU.ACCT;
      528    21938    1           JIT.UNAME=KL_STRTU.UNAME;
      529    21939    1           JIT.MRT=KL_STRTU.MRT;
      530    21940    1           JIT.PRIV.AUTH=KL_STRTU.PRIV;
      531    21941    1           JIT.PPRIV=KL_STRTU.PPRIV;
      532    21942    1           JIT.BILL=KL_STRTU.BILL;
      533    21943    1           JIT.MAXLVLS=KL_STRTU.INTS;
      534    21944    1           JIT.MAXMEM=KL_STRTU.MEM;
      535    21945    1           IF JIT.MAXMEM > 4096 THEN JIT.MAXMEM = 4096;
      536    21946    1           JIT.MODE=KL_STRTU.MODE;
      537    21947    1           JIT.LANG = KL_STRTU.LANG;
      538    21948    1           JIT.JUNK.STEPACCT = KL_STRTU.FLAGS.STEPACCT;
      539    21949    1           JIT.PROG_ENTRY = %G_PE_HOST#;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:18   
      540    21950    1           JIT.DB_ACCN=KL_STRTU.DB_ACCT;
      541    21951    1           JIT.GFR_ACCT=GFR@INDX;
      542    21952    1           JIT.PCC = GFR@PGSZ;
      543    21953    1           JIT.ACCTLOG.FCN = %IGA_SYSLOG;
      544    21954    1           JIT.ACCTLOG.FILENUM = 2;
      545    21955    1           JIT.CODE = %AZ$LCP6;
      546    21956    1           G$WINDOW1$->ROS.M$LM.RLCID = KL_STRTU.NETADR_FROM;
      547    21957    1           G$WINDOW1$->ROS.M$HOST.RLCID = KL_STRTU.NETADR_FROM;
      548    21958    1           G$WINDOW1$->ROS.M$ME.RLCID = KL_STRTU.NETADR_TO;
      549    21959    1           G$WINDOW1$->ROS.M$ME.STRM = KL_STRTU.STR;
      550    21960
      551    21961    2           DO I=0 TO 7;
      552    21962    3              DO J=0 TO 7;
      553    21963    3                 IF KL_STRTU.PSEUDO_NAME(I) = GFR_PSUDO_NM(J)
      554    21964    4                 THEN DO;
      555    21965    4                    JIT.MAXSUDO(J) = KL_STRTU.PSEUDO_MAX(I);
      556    21966    4                    GOTO PSUDO_OK;
      557    21967    4                    END;
      558    21968    3                 END;
      559    21969        /* :HLP record for this user specifies a pseudo that doesn't exits
      560    21970           on this fep.
      561    21971        */
      562    21972    2              CODE = %E$BSUNM;
      563    21973    2              GOTO GFR_ERR;
      564    21974
      565    21975
      566    21976    2   PSUDO_OK:  ;
      567    21977    2              END;
      568    21978
      569    21979
      570    21980
      571    21981    1           RETURN;
      572    21982        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:19   
      573    21983        /*F*
      574    21984              NAME:  GUS$DELU
      575    21985              PURPOSE:  To complete elimination of a user.
      576    21986        */
      577    21987        /*D*
      578    21988              NAME:  GUS$DELU
      579    21989              CALL:
      580    21990                 CALL GUS$DELU
      581    21991              PARAMETERS:
      582    21992                 None
      583    21993              DESCRIPTION:
      584    21994                 The ROSEG, TSTACKU and UHJIT segments from the users ASDT
      585    21995                 are released.
      586    21996        */
      587    21997
      588    21998    1   GUS$DELU: ENTRY;
      589    21999
      590    22000    1           I = G$UHJIT.ASDT_USR.ROS.BASE;
      591    22001    1           G$UHJIT.ASDT_MCL.WINDOW1.BASE=I;
      592    22002    1           G$UHJIT.ASDT_MCL.WINDOW1.SIZE=(SIZEW(G$ROS)-1)/256;
      593    22003    1           CALL GHH$ASD (G$WINDOW1$,G$UHJIT.ASDT_MCL.WINDOW1);
      594    22004    1           D$=ADDR(G$WINDOW1$->G$ROS.JIT);
      595    22005
      596    22006    1           GFR@INDX = JIT.GFR_ACCT;
      597    22007    1           MODE = JIT.MODE;
      598    22008    1           GFR@PGSZ = 0;
      599    22009
      600    22010    1           J = G$UHJIT.ASDT_USR.ROS.SIZE+1;
      601    22011    1           GFR@PGSZ = GFR@PGSZ +J;
      602    22012    1           CALL GMA$RELPS (I,J);
      603    22013    1           I = G$UHJIT.ASDT_USR.TSTACKU.BASE;
      604    22014    1           J = G$UHJIT.ASDT_USR.TSTACKU.SIZE+1;
      605    22015    1           GFR@PGSZ = GFR@PGSZ +J;
      606    22016    1           CALL GMA$RELPS (I,J);
      607    22017    1           I = G$UHJIT.ASDT_USR.UHJIT.BASE;
      608    22018    1           J = G$UHJIT.ASDT_USR.UHJIT.SIZE+1;
      609    22019    1           GFR@PGSZ = GFR@PGSZ +J;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:20   
      610    22020    1           CALL GMA$RELPS (I,J);
      611    22021    1           IF GFR@INDX ~= 0
      612    22022    2           THEN DO;
      613    22023    2              D$ = G$BOBCAT.ACCT_RES$;
      614    22024                   %LOCK (G=GFR_RES_LOCK);
      615    22031    2              GFR$ACCT.CUR_FPRGS(GFR@INDX) = GFR$ACCT.CUR_FPRGS(GFR@INDX)-1;
      616    22032    2              GFR$ACCT.CUR_MEM(GFR@INDX) =  GFR$ACCT.CUR_MEM(GFR@INDX)-GFR@PGSZ;
      617    22033    2              GFR_CUR_MEM(MODE) = GFR_CUR_MEM(MODE) - GFR@PGSZ;
      618    22034    2              IF MODE = %G_M_HANDLER#
      619    22035    3              THEN DO;
      620    22036    3                 GM_ASHUF = GM_ASHUF + GFR@PGSZ;
      621    22037    3                 GM_HSHUF = GM_HSHUF - GFR@PGSZ;
      622    22038    3                 END;
      623    22039                   %UNLOCK (G=GFR_RES_LOCK);
      624    22046    2              END;
      625    22047    1           G$MHJIT.ASDT_MON.UMHJIT = G$MHJIT.ASDT_MON.MHJIT;
      626    22048    1           RETURN;
      627    22049        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:21   
      628    22050    1   GUS$RUE: ENTRY(PARM);
      629    22051
      630    22052    1           P1$ = PARM.PTRS.PAR1$;
      631    22053    1           IF NOT G$JIT.PRIV.ACTIVE.MSYS
      632    22054    2           THEN DO;
      633    22055    2              PARM.ERR = NO_MSYS;
      634    22056                  /*E* ERROR: GUS-E$NO_MSYS
      635    22057                       MESSAGE: M$RUE requires the MSYS privilege.
      636    22058                    */
      637    22059    2              RETURN;
      638    22060    2              END;
      639    22061
      640    22062    2           DO I = 1 TO G_MUAIS;
      641    22063    2              IF G$USER.SYSID(I) = FPT_RUE.USER
      642    22064    2                AND G$USER.US(I) ~= %GH_NULL
      643    22065    3              THEN DO;
      644    22066    3                 J = FPT_RUE.EVENT;
      645    22067    3                 CALL GHS$RUE(J,I);
      646    22068    3                 RETURN;
      647    22069    3                 END;
      648    22070    2              END;
      649    22071
      650    22072    1           PARM.ERR = BDID;
      651    22073        /*E* ERROR: GUS-E$BDID
      652    22074             MESSAGE: The sysid specified on M$RUE does not exist.
      653    22075        */
      654    22076    1           RETURN;
      655    22077
      656    22078    1   END;
      657    22079        %EOD;

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:22   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   G_HJIT_M.:E05TOU  is referenced.
   AZ_SUBS_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   G_ROS_M.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   GH_GATE_M.:E05TOU  cannot be made into a system file and is referenced.
   GFR_DATA_M.:E05TOU  is referenced.
   G$BOBCAT_M.:E05TOU  is referenced.
   GU_MACROS_M.:E05TOU  is referenced.
   GH_SCHD_M.:E05TOU  is referenced.
   GH_SCHD_E.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure GUS$CLOCK.

   Procedure GUS$CLOCK requires 1981 words for executable code.
   Procedure GUS$CLOCK requires 52 words of local(AUTO) storage.

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:23   

 Object Unit name= GUS$CLOCK                                  File name= GUS$SCHD.:E05TOU
 UTS= JUL 29 '97 22:15:56.56 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS     25     19  GUS$CLOCK
    1   Proc  even  none  1981    7BD  GUS$CLOCK
    2  RoData even  none     6      6  GUS$CLOCK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  GUS$CLOCK
     1    29B                  yes      Std        0  GUS$RNDCLK
     1    2B8                  yes      Std        0  GUS$RESTRTCLK
     1    2F3                  yes      Std        1  GUS$WAIT
     1    416                  yes      Std        1  GUS$MAKEUSR
     1    66F                  yes      Std        0  GUS$DELU
     1    75F                  yes      Std        1  GUS$RUE
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:24   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 GHH$LOCK
 yes     yes           Std       1 GHH$UNLOCK
 yes     yes           Std       2 KNH$SCAN
         yes           Std       2 GHH$ASD
 yes     yes           Std       4 GHS$RUE
 yes     yes           Std       2 GHS$REG
         yes           Std       5 GHS$ADDUSR
         yes           Std       1 GHI$UTS
         yes           Std       0 GHR$MON
 yes     yes           Std       1 GUD$CHKWP
         yes           Std       0 GHR$SRV
 yes     yes           Std       2 GMA$RELPS
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6D_MID
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     G$JIT$                                G$MHJIT$                              G$USRT$
     G$UHJIT$                              G$ROS$                                G$WINDOW1$
r    G$BOBCAT$                             GFR_RES_LOCK                          G_CLKGATE
     GH_CLOCKHD                            GM_INIT_PGSZ                          GFR_PSUDO_NM
     GFR_MAX_MEM                           GFR_CUR_MEM                           G_MUAIS
     GM_ASHUF                              GM_HSHUF                         r    G$ROS$
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:25   


        1        1        /*M* GUS$SCHD - Scheduler related user service procedures */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*             */
        8        8        /*P*
        9        9             NAME: GUS$SCHD
       10       10             PURPOSE:
       11       11                  To provide Scheduler related user service procedures
       12       12             DESCRIPTION:
       13       13                  This module includes procedures for the following monitor
       14       14                  services.
       15       15                      M$WAIT
       16       16                      M$CLOCK
       17       17                      M$QFI and M$UQFI
       18       18                      M$EVENT
       19       19             REFERENCE:
       20       20                  The Monitor Services Reference Manual contains description
       21       21                  of the services and FPTs.
       22       22        */
       23       23        /*F*
       24       24             NAME: GUS$CLOCK
       25       25             PURPOSE:
       26       26                  To process the M$CLOCK Monitor Service.
       27       27        */
       28       28        /*D*
       29       29             NAME: GUS$CLOCK
       30       30             CALL:
       31       31             CALL: Standard MCL service decoder call.
       32       32             DESCRIPTION:
       33       33                  This procedure processes the M$CLOCK Monitor Service.
       34       34
       35       35                  If the Set Timer option is requested, the specified time
       36       36                  interval is added to the current time to obtain a Clock
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:26   
       37       37                  Event time in UTS units.  If the Real Time option is specified
       38       38                  an entry is placed in the monitor Clock Queue for the
       39       39                  current user.  The Clock Queue is a linked list of User Table
       40       40                  entries containing a Clock Event time sorted with the
       41       41                  earlier time first.
       42       42
       43       43                  If the Real Time option was not specified, the Clock Event
       44       44                  time is stored in the user's JIT and decremented by the
       45       45                  amount of execution time expended by the user.
       46       46
       47       47                  When the specified time has expired, either as real time,
       48       48                  or execution time, an entry is made on the user's Dolist
       49       49                  to cause entry to the user's Event asynchronous proc-
       50       50                  edure.
       51       51
       52       52                  If the Test Timer option is requested the approriate
       53       53                  time, either Real Time or execution time as specified by
       54       54                  the Real Time option, remaining before the timer will
       55       55                  expire is computed and returned to the user.
       56       56
       57       57                  If the Cancel option is requested the appropriate timer
       58       58                  is canceled and no Event asynchronous entry occurs.
       59       59        */
       60       60        GUS$CLOCK: PROC (PARM);

     60   1 000000  D380 0000 0000  xent GUS$CLOCK       LNJ,B5   X6A_AUTO_1
          1 000003       0034 0001                       DC       52,1

       61       61
       62       62        %INCLUDE GH_SCHD_E;
       63      158        %INCLUDE GH_SCHD_M;
       64      302 S      %INCLUDE GU_LCP6_M;
       65      303        %INCLUDE GU_MACROS_M;
       66      462        %INCLUDE G$BOBCAT_M;
       67      482        %INCLUDE GFR_DATA_M;
       68      502        %INCLUDE GH_GATE_M;
       69      543 S      %INCLUDE G_LCP6_E;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:27   
       70      544        %INCLUDE G_JIT_M;
       71      809 S      %INCLUDE GH_LCP6_M;
       72      810        %INCLUDE G_ROS_M;
       73      892 S      %INCLUDE GF_LCP6_M;
       74      893        %INCLUDE GM_VIRTUAL_E;
       75     1103        %INCLUDE KL_MACRO_C;
       76     4455        %INCLUDE KL_AFCN_C;
       77     4556        %INCLUDE AZ_SUBS_C;
       78     4625        %INCLUDE G_HJIT_M;
       79     4770        %INCLUDE B_ERRORS_C;
       80     5897
       81     5898
       82     5899        %G$MHJIT (STCLASS="BASED(G$MHJIT$)");
       83    12773        %G$HHJIT;
       84    14917        %G$UHJIT (STCLASS="BASED(G$UHJIT$)");
       85    17891        %G$USER (FPTN="G$USER(0:0)",STCLASS="BASED(G$USRT$)");
       86    17902        %G$USER (STCLASS="BASED(CU$)");
       87    17913        %G$DO;
       88    17976        %G$ROS (STCLASS="BASED(G$ROS$)",FULL=YES);
       89    18927        %G$ECCB;
       90    19003        %G$ROS (FPTN=ROS,STCLASS=BASED,FULL=YES);
       91    19954        %G$JIT (STCLASS="BASED(G$JIT$)");
       92    20368        %G$JIT (FPTN=JIT,STCLASS="BASED(D$)");
       93    20782        %G$JIT_E;
       94    20844        %G$BOBCAT (STCLASS="BASED(G$BOBCAT$)");
       95    20857        %GFR$ACCT (STCLASS="BASED(D$)");
       96    20870        %FPT_CLOCK (FPTN=FPT_CLOCKV,STCLASS="BASED(P1$)",VECTORS=NO);
       97    20894        %FPT_WAIT (FPTN=FPT_WAITV,VECTORS=NO,STCLASS="BASED(P1$)");
       98    20918        %FPT_RUE (FPTN=FPT_RUE,VECTORS=NO,STCLASS="BASED(P1$)");
       99    20941        %KL_STRTU (STCLASS="BASED(P1$)");
      100    21114        %GUD_HAND_PARAMS (FPTN=PARM);           /* FPT parameters                     */
      101    21190
      102    21191        %VLP_ERRCODE (FPTN=NOTAUTH,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      103    21192                      STCLASS=CONSTANT,ERR#=%E$NOTAUTH);
      104    21238        %VLP_ERRCODE (FPTN=NO_MSYS,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      105    21239                      STCLASS=CONSTANT,ERR#=%E$NO_MSYS);
      106    21285        %VLP_ERRCODE (FPTN=BDID,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:28   
      107    21286                      STCLASS=CONSTANT,ERR#=%E$BDID);
      108    21332        %VLP_ERRCODE (FPTN=BSUNM,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      109    21333                      STCLASS=CONSTANT,ERR#=%E$BSUNM);
      110    21379        %VLP_ERRCODE (FPTN=BADVECT1,FCG='GU',MID='U',MON='1'B,SEV=G_SEV_ERROR#,
      111    21380                      STCLASS=CONSTANT,ERR#=%E$BADVECT1);
      112    21426
      113    21427    1   DCL GHI$UTS ENTRY(1);
      114    21428    1   DCL GHS$RUE ENTRY(4) ALTRET;
      115    21429    1   DCL GHS$REG ENTRY(2) ALTRET;
      116    21430    1   DCL GHS$ADDUSR ENTRY(5);
      117    21431    1   DCL GHH$ASD ENTRY(2);
      118    21432    1   DCL GHR$MON ENTRY;
      119    21433    1   DCL GHR$SRV ENTRY;
      120    21434    1   DCL GMA$RELPS ENTRY(2) ALTRET;
      121    21435    1   DCL GUD$CHKWP ENTRY(1) ALTRET;
      122    21436    1   DCL KNH$SCAN ENTRY(2) ALTRET;
      123    21437
      124    21438
      125    21439    1   DCL INTERVAL UBIN BASED;
      126    21440    1   DCL UTSVALUE UBIN(32) BASED;
      127    21441
      128    21442    1   DCL T UBIN(32);
      129    21443    1   DCL U UBIN(32);
      130    21444    1   DCL J UBIN;
      131    21445    1   DCL I UBIN;
      132    21446    1   DCL A SBIN(32);
      133    21447    1   DCL S SBIN;
      134    21448    1   DCL MAX(0:2) SBIN(32) CONSTANT INIT(%BITBIN('7FFFFFFF'X),8947850,149131);
      135    21449    1   DCL D(0:2) SBIN(32) CONSTANT INIT(1,16,16);
      136    21450    1   DCL C(0:2) UBIN CONSTANT INIT(1,120,7200);
      137    21451    1   DCL P1$ PTR;
      138    21452    1   DCL D$ PTR;
      139    21453    1   DCL CU$ PTR;
      140    21454    1   DCL USER# UBIN;
      141    21455    1   DCL ROSPP UBIN;
      142    21456    1   DCL CODE UBIN;
      143    21457    1   DCL DMN UBIN;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:29   
      144    21458    1   DCL GFR@INDX UBIN;
      145    21459    1   DCL GFR@PGSZ UBIN;
      146    21460    1   DCL MODE UBIN;
      147    21461
      148    21462    1   DCL G$JIT$ PTR SYMREF;
      149    21463    1   DCL G$MHJIT$ PTR SYMREF;
      150    21464    1   DCL G$USRT$ PTR SYMREF;
      151    21465    1   DCL G$UHJIT$ PTR SYMREF;
      152    21466    1   DCL G$ROS$ PTR SYMREF;
      153    21467    1   DCL G$WINDOW1$ PTR SYMREF;
      154    21468    1   DCL G$BOBCAT$ PTR SYMREF READONLY;
      155    21469        %GATE (FPTN=GFR_RES_LOCK,STCLASS=SYMREF);
      156    21488        %GATE (FPTN=G_CLKGATE,STCLASS=SYMREF);
      157    21507    1   DCL GH_CLOCKHD UBIN SYMREF;
      158    21508    1   DCL GM_INIT_PGSZ UBIN SYMREF;
      159    21509    1   DCL GFR_PSUDO_NM(0:7) CHAR(8) SYMREF;
      160    21510    1   DCL GFR_MAX_MEM(0:4) UBIN SYMREF;
      161    21511    1   DCL GFR_CUR_MEM(0:4) UBIN SYMREF;
      162    21512    1   DCL G_MUAIS UBIN SYMREF;
      163    21513    1   DCL GM_ASHUF UBIN(16) SYMREF;
      164    21514    1   DCL GM_HSHUF UBIN(16) SYMREF;
      165    21515
      166    21516        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:30   
      167    21517    1           CU$=G$MHJIT.CU$;

  21517   1 000005  EC80 0000 0000  xsym                 LDB,B6   G$MHJIT$
          1 000008  DCC6 0352                            LDB,B5   850,B6
          1 00000A  DFC7 0013                            STB,B5   CU$,AUTO

      168    21518    1           P1$=PARM.PTRS.PAR1$;

  21518   1 00000C  CCC7 0004                            LDB,B4   @PARM,AUTO
          1 00000E  BCC4 0006                            LDB,B3   6,B4
          1 000010  BFC7 000F                            STB,B3   P1$,AUTO

      169    21519    1           IF G$U.FLG.CPIC THEN

  21519   1 000012  8985                                 CMZ      ,B5
          1 000013  0881 0006                            BAGE     s:21522,PREL

      170    21520    1              DMN=%GH_CPDMN#;

  21520   1 000015  6C01                                 LDV,R6   1
          1 000016  EF47 0018                            STR,R6   DMN,AUTO
          1 000018  0F81 0010                            B        s:21526,PREL

      171    21521    1           ELSE
      172    21522    1              IF G$UHJIT.DMN.ID = %G_DMN_DB_SVC# THEN

  21522   1 00001A  AC80 0000 0000  xsym                 LDB,B2   G$UHJIT$
          1 00001D  E842 007E                            LDR,R6   126,B2
          1 00001F  6D01                                 CMV,R6   1
          1 000020  0981 0006                            BNE      s:21525,PREL

      173    21523    1                 DMN=%GH_DBDMN#;

  21523   1 000022  5C02                                 LDV,R5   2
          1 000023  DF47 0018                            STR,R5   DMN,AUTO
          1 000025  0F81 0003                            B        s:21526,PREL

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:31   
      174    21524    1              ELSE
      175    21525    1                 DMN=%GH_USRDMN#;

  21525   1 000027  8747 0018                            CL       DMN,AUTO

      176    21526    2           DO CASE (FPT_CLOCKV.MODE);

  21526   1 000029  B803                                 LDR,R3   ,B3
          1 00002A  304C                                 SOR,R3   12
          1 00002B  B570 0003                            AND,R3   3,IMO
          1 00002D  3D02                                 CMV,R3   2
          1 00002E  0281 01A2                            BGE      s:21597,PREL
          1 000030  A830 0000 0036  01                   LDR,R2   s:21526+13,R3
          1 000033  83A0 0000 0038  01                   JMP      s:21528,R2
          1 000036       0000                            DC       s:21528,PREL
          1 000037       00EC                            DC       s:21571,PREL

      177    21527    2            CASE(%G_SET#);

      178    21528    2              A=PARM.PTRS.PAR2$->INTERVAL;

  21528   1 000038  ACC4 0008                            LDB,B2   8,B4
          1 00003A  F802                                 LDR,R7   ,B2
          1 00003B  6C00                                 LDV,R6   0
          1 00003C  8D47 000C                            SDI      A,AUTO

      179    21529    2              I=MAX(FPT_CLOCKV.UTYPE);

  21529   1 00003E  9803                                 LDR,R1   ,B3
          1 00003F  104A                                 SOR,R1   10
          1 000040  9570 0003                            AND,R1   3,IMO
          1 000042  1001                                 SOL,R1   1
          1 000043  D810 0000 000B  00                   LDR,R5   MAX+1,R1
          1 000046  DF47 000B                            STR,R5   I,AUTO

      180    21530    2              A=MOD(A,I);

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:32   
  21530   1 000048  F855                                 LDR,R7   R5
          1 000049  6C00                                 LDV,R6   0
          1 00004A  8D47 0030                            SDI      MODE+21,AUTO
          1 00004C  0027                                 CBD      ;
          1 00004D       0407 0030                                BINARY(MODE+21,AUTO,,4),;
          1 00004F       4C07 001E                                UNPACKED(MODE+3,AUTO,,12,LEADING)
          1 000051  0027                                 CBD      ;
          1 000052       0407 000C                                BINARY(A,AUTO,,4),;
          1 000054       4C07 0024                                UNPACKED(MODE+9,AUTO,,12,LEADING)
          1 000056  002B                                 DDV      ;
          1 000057       4C07 001E                                UNPACKED(MODE+3,AUTO,,12,LEADING),;
          1 000059       4C07 0024                                UNPACKED(MODE+9,AUTO,,12,LEADING),;
          1 00005B       4C07 002A                                UNPACKED(MODE+15,AUTO,,12,LEADING)
          1 00005D  002A                                 CDB      ;
          1 00005E       4C07 0024                                UNPACKED(MODE+9,AUTO,,12,LEADING),;
          1 000060       0407 0032                                BINARY(MODE+23,AUTO,,4)
          1 000062  437F                                 CSYNC    s:21530+25,SPREL
          1 000063  8CC7 0032                            LDI      MODE+23,AUTO
          1 000065  8D47 000C                            SDI      A,AUTO

      181    21531    2              A=A *

  21531   1 000067  B803                                 LDR,R3   ,B3
          1 000068  304A                                 SOR,R3   10
          1 000069  B570 0003                            AND,R3   3,IMO
          1 00006B  F830 0000 0016  00                   LDR,R7   C,R3
          1 00006E  6C00                                 LDV,R6   0
          1 00006F  9BC7 000C                            LAB,B1   A,AUTO
          1 000071  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          1 000074  8D47 000C                            SDI      A,AUTO

      182    21532    2                C(FPT_CLOCKV.UTYPE);
      183    21533    3              DO CASE(FPT_CLOCKV.CLOCK);

  21533   1 000076  ECC7 000F                            LDB,B6   P1$,AUTO
          1 000078  B806                                 LDR,R3   ,B6
          1 000079  304E                                 SOR,R3   14
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:33   
          1 00007A  3D02                                 CMV,R3   2
          1 00007B  0281 0155                            BGE      s:21597,PREL
          1 00007D  A830 0000 0083  01                   LDR,R2   s:21533+13,R3
          1 000080  83A0 0000 0085  01                   JMP      s:21540,R2
          1 000083       0000                            DC       s:21540,PREL
          1 000084       0071                            DC       s:21561,PREL

      184    21534    3               CASE(%G_WALL#);

      185    21535                      %LOCK (G=G_CLKGATE);

  21540   1 000085  BB80 0000 0000  02                   LAB,B3   0
          1 000088  CBF0 0100                            LAB,B4   256,IMO
          1 00008A  E380 0000 0000  xent                 LNJ,B6   GHH$LOCK
          1 00008D       0001                            DC       s:21542,PREL

      186    21542    3                 IF G$U.CLOCK ~= 0 THEN

  21542   1 00008E  ECC7 0013                            LDB,B6   CU$,AUTO
          1 000090  E846 0009                            LDR,R6   9,B6
          1 000092  6901 0004                            BEZ,R6   s:21544,PREL

      187    21543    3                    CALL CANCEL;           /* Cancel current clock               */

  21543   1 000094  E3C0 01B6                            LNJ,B6   s:0,PREL
          1 000096       0001                            DC       s:21544,PREL

      188    21544    3                 A = A/D(FPT_CLOCKV.UTYPE);

  21544   1 000097  ECC7 000F                            LDB,B6   P1$,AUTO
          1 000099  B806                                 LDR,R3   ,B6
          1 00009A  304A                                 SOR,R3   10
          1 00009B  B570 0003                            AND,R3   3,IMO
          1 00009D  DB80 0000 0000  00                   LAB,B5   NOTAUTH
          1 0000A0  3002                                 SOL,R3   2
          1 0000A1  0027                                 CBD      ;
          1 0000A2       0435 0010                                BINARY(16,B5,R3,,4),;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:34   
          1 0000A4       4C07 001E                                UNPACKED(MODE+3,AUTO,,12,LEADING)
          1 0000A6  0027                                 CBD      ;
          1 0000A7       0407 000C                                BINARY(A,AUTO,,4),;
          1 0000A9       4C07 0024                                UNPACKED(MODE+9,AUTO,,12,LEADING)
          1 0000AB  002B                                 DDV      ;
          1 0000AC       4C07 001E                                UNPACKED(MODE+3,AUTO,,12,LEADING),;
          1 0000AE       4C07 0024                                UNPACKED(MODE+9,AUTO,,12,LEADING),;
          1 0000B0       4C07 002A                                UNPACKED(MODE+15,AUTO,,12,LEADING)
          1 0000B2  002A                                 CDB      ;
          1 0000B3       4C07 002A                                UNPACKED(MODE+15,AUTO,,12,LEADING),;
          1 0000B5       0407 0030                                BINARY(MODE+21,AUTO,,4)
          1 0000B7  437F                                 CSYNC    s:21544+31,SPREL
          1 0000B8  8CC7 0030                            LDI      MODE+21,AUTO
          1 0000BA  8D47 000C                            SDI      A,AUTO

      189    21545    3                 CALL GHI$UTS (T);

  21545   1 0000BC  DBC7 0006                            LAB,B5   T,AUTO
          1 0000BE  DFC7 001E                            STB,B5   MODE+3,AUTO
          1 0000C0  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 0000C2  CBF0 0100                            LAB,B4   256,IMO
          1 0000C4  E380 0000 0000  xent                 LNJ,B6   GHI$UTS
          1 0000C7       0001                            DC       s:21546,PREL

      190    21546    3                 G$U.UTS = T + A;

  21546   1 0000C8  8CC7 0006                            LDI      T,AUTO
          1 0000CA  8447 000C                            AID      A,AUTO
          1 0000CC  ECC7 0013                            LDB,B6   CU$,AUTO
          1 0000CE  8D46 0007                            SDI      7,B6

      191    21547    3                 CALL QWALCLK;

  21547   1 0000D0  E3C0 0130                            LNJ,B6   s:0,PREL
          1 0000D2       0001                            DC       s:21553,PREL

      192    21548                      %UNLOCK (G=G_CLKGATE);
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:35   

  21553   1 0000D3  BB80 0000 0000  02                   LAB,B3   0
          1 0000D6  CBF0 0100                            LAB,B4   256,IMO
          1 0000D8  E380 0000 0000  xent                 LNJ,B6   GHH$UNLOCK
          1 0000DB       0001                            DC       s:21555,PREL

      193    21555    3                 G$JIT.CLUKRLVL = FPT_CLOCKV.LEVEL;

  21555   1 0000DC  ECC7 000F                            LDB,B6   P1$,AUTO
          1 0000DE  E806                                 LDR,R6   ,B6
          1 0000DF  E570 003F                            AND,R6   63,IMO
          1 0000E1  DC80 0000 0000  xsym                 LDB,B5   G$JIT$
          1 0000E4  E7C5 0074                            STH,R6   116,B5

      194    21556    3                 IF FPT_CLOCKV.PERM THEN

  21556   1 0000E6  8286                                 LB,'0100'X        ,B6
  21556   1 0000E7       0100
          1 0000E8  0581 0007                            BBF      s:21559,PREL

      195    21557    3                    G$JIT.CLUKRINT = A;

  21557   1 0000EA  8CC7 000C                            LDI      A,AUTO
          1 0000EC  8D45 0075                            SDI      117,B5
          1 0000EE  0F81 00E2                            B        s:21597,PREL

      196    21558    3                 ELSE
      197    21559    3                    G$JIT.CLUKRINT = 0;

  21559   1 0000F0  8745 0075                            CL       117,B5
          1 0000F2  8745 0076                            CL       118,B5
          1 0000F4  0F81 00DC                            B        s:21597,PREL

      198    21560    3               CASE(%G_EXECUTION#);

      199    21561    3                 G$JIT.TIMERS(DMN) = G$JIT.XTIME + G$JIT.STIME + A;

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:36   
  21561   1 0000F6  DC80 0000 0000  xsym                 LDB,B5   G$JIT$
          1 0000F9  8CC5 006A                            LDI      106,B5
          1 0000FB  8445 006C                            AID      108,B5
          1 0000FD  8447 000C                            AID      A,AUTO
          1 0000FF  9847 0018                            LDR,R1   DMN,AUTO
          1 000101  1E54                                 ADV,R1   84
          1 000102  8D15                                 SDI      ,B5,R1

      200    21562    3                 IF G$JIT.TIMERS(DMN) < G$JIT.IDELTAT THEN

  21562   1 000103  DC80 0000 0000  xsym                 LDB,B5   G$JIT$
          1 000106  8C95                                 LDI      ,B5,R1
          1 000107  84C5 006E                            SID      110,B5
          1 000109  0601 0004                            BCT      s:21564,PREL

      201    21563    3                    G$JIT.IDELTAT = G$JIT.TIMERS(DMN);

  21563   1 00010B  8C95                                 LDI      ,B5,R1
          1 00010C  8D45 006E                            SDI      110,B5

      202    21564    3                 G$JIT.CLUKXLVL = FPT_CLOCKV.LEVEL;

  21564   1 00010E  E806                                 LDR,R6   ,B6
          1 00010F  E570 003F                            AND,R6   63,IMO
          1 000111  EAC5 0074                            SRM,R6,'00FF'X    116,B5
          1 000113       00FF

      203    21565    3                 IF FPT_CLOCKV.PERM THEN

  21565   1 000114  8286                                 LB,'0100'X        ,B6
  21565   1 000115       0100
          1 000116  0581 0007                            BBF      s:21568,PREL

      204    21566    3                    G$JIT.CLUKXINT = A;

  21566   1 000118  8CC7 000C                            LDI      A,AUTO
          1 00011A  8D45 0077                            SDI      119,B5
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:37   
          1 00011C  0F81 00B4                            B        s:21597,PREL

      205    21567    3                 ELSE
      206    21568    3                    G$JIT.CLUKXINT = 0;

  21568   1 00011E  8745 0077                            CL       119,B5
          1 000120  8745 0078                            CL       120,B5

      207    21569    3               END;                        /* End CLOCK cases                    */

  21569   1 000122  0F81 00AE                            B        s:21597,PREL

      208    21570    2            CASE(%G_TEST#);

      209    21571    3              DO CASE(FPT_CLOCKV.CLOCK);

  21571   1 000124  9803                                 LDR,R1   ,B3
          1 000125  104E                                 SOR,R1   14
          1 000126  1D02                                 CMV,R1   2
          1 000127  0281 00A9                            BGE      s:21597,PREL
          1 000129  B810 0000 012F  01                   LDR,R3   s:21571+11,R1
          1 00012C  83B0 0000 0131  01                   JMP      s:21573,R3
          1 00012F       0000                            DC       s:21573,PREL
          1 000130       0064                            DC       s:21591,PREL

      210    21572    3               CASE(%G_WALL#);

      211    21573    3                 PARM.ASDT_MCL_INDX = %GM_LPAR2#;

  21573   1 000131  6C0B                                 LDV,R6   11
          1 000132  EF44 004E                            STR,R6   78,B4

      212    21574    3                 CALL GUD$CHKWP(PARM)

  21574   1 000134  BBC7 0004                            LAB,B3   @PARM,AUTO
          1 000136  CBF0 0100                            LAB,B4   256,IMO
          1 000138  E380 0000 0000  xent                 LNJ,B6   GUD$CHKWP
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:38   
          1 00013B       0003                            DC       s:21576,PREL
          1 00013C  0F81 000B                            B        s:21582,PREL

      213    21575    4                 WHENALTRETURN DO;

      214    21576    4                    PARM.ERR = BADVECT1;

  21576   1 00013E  8C80 0000 0008  00                   LDI      BADVECT1
          1 000141  ECC7 0004                            LDB,B6   @PARM,AUTO
          1 000143  8D46 0003                            SDI      3,B6

      215    21577    4                    RETURN;

  21577   1 000145  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      216    21578    4                    END;
      217    21579        /*E* ERROR: GUU-E$BADVECT1-E
      218    21580             MESSAGE: Access to M$CLOCK UNITS parameter is bad.
      219    21581        */
      220    21582    3                 IF G$U.CLOCK ~= 0 THEN

  21582   1 000148  ECC7 0013                            LDB,B6   CU$,AUTO
          1 00014A  E846 0009                            LDR,R6   9,B6
          1 00014C  6901 0041                            BEZ,R6   s:21589,PREL

      221    21583    4                 DO;

      222    21584    4                    CALL GHI$UTS (T);

  21584   1 00014E  DBC7 0006                            LAB,B5   T,AUTO
          1 000150  DFC7 001E                            STB,B5   MODE+3,AUTO
          1 000152  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 000154  CBF0 0100                            LAB,B4   256,IMO
          1 000156  E380 0000 0000  xent                 LNJ,B6   GHI$UTS
          1 000159       0001                            DC       s:21585,PREL

      223    21585    4                    T = G$U.UTS - T;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:39   

  21585   1 00015A  ECC7 0013                            LDB,B6   CU$,AUTO
          1 00015C  8CC6 0007                            LDI      7,B6
          1 00015E  84C7 0006                            SID      T,AUTO
          1 000160  8D47 0006                            SDI      T,AUTO

      224    21586    4                    PARM.PTRS.PAR2$->INTERVAL = T / C(FPT_CLOCKV.UTYPE);

  21586   1 000162  DCC7 0004                            LDB,B5   @PARM,AUTO
          1 000164  CCC5 0008                            LDB,B4   8,B5
          1 000166  BCC7 000F                            LDB,B3   P1$,AUTO
          1 000168  B803                                 LDR,R3   ,B3
          1 000169  304A                                 SOR,R3   10
          1 00016A  B570 0003                            AND,R3   3,IMO
          1 00016C  F830 0000 0016  00                   LDR,R7   C,R3
          1 00016F  6C00                                 LDV,R6   0
          1 000170  8D47 0030                            SDI      MODE+21,AUTO
          1 000172  0027                                 CBD      ;
          1 000173       0407 0030                                BINARY(MODE+21,AUTO,,4),;
          1 000175       4C07 001E                                UNPACKED(MODE+3,AUTO,,12,LEADING)
          1 000177  0027                                 CBD      ;
          1 000178       0407 0006                                BINARY(T,AUTO,,4),;
          1 00017A       4C07 0024                                UNPACKED(MODE+9,AUTO,,12,LEADING)
          1 00017C  002B                                 DDV      ;
          1 00017D       4C07 001E                                UNPACKED(MODE+3,AUTO,,12,LEADING),;
          1 00017F       4C07 0024                                UNPACKED(MODE+9,AUTO,,12,LEADING),;
          1 000181       4C07 002A                                UNPACKED(MODE+15,AUTO,,12,LEADING)
          1 000183  002A                                 CDB      ;
          1 000184       4C07 002A                                UNPACKED(MODE+15,AUTO,,12,LEADING),;
          1 000186       0407 0032                                BINARY(MODE+23,AUTO,,4)
          1 000188  437F                                 CSYNC    s:21586+37,SPREL
          1 000189  D847 0033                            LDR,R5   MODE+24,AUTO
          1 00018B  DF04                                 STR,R5   ,B4

      225    21587    4                    END;

  21587   1 00018C  0F81 0044                            B        s:21597,PREL
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:40   

      226    21588    3                 ELSE
      227    21589    3                    PARM.PTRS.PAR2$->INTERVAL = 0;

  21589   1 00018E  DCC7 0004                            LDB,B5   @PARM,AUTO
          1 000190  CCC5 0008                            LDB,B4   8,B5
          1 000192  8704                                 CL       ,B4
          1 000193  0F81 003D                            B        s:21597,PREL

      228    21590    3               CASE(%G_EXECUTION#);

      229    21591    3                 A = G$JIT.TIMERS(DMN)-G$JIT.STIME-G$JIT.XTIME;

  21591   1 000195  AC80 0000 0000  xsym                 LDB,B2   G$JIT$
          1 000198  A847 0018                            LDR,R2   DMN,AUTO
          1 00019A  2E54                                 ADV,R2   84
          1 00019B  8CA2                                 LDI      ,B2,R2
          1 00019C  84C2 006C                            SID      108,B2
          1 00019E  84C2 006A                            SID      106,B2
          1 0001A0  8D47 000C                            SDI      A,AUTO

      230    21592    3                 IF A < 0 THEN

  21592   1 0001A2  84F0 0000 0000                       SID      0,IMO
          1 0001A5  6881 0005                            BGEZ,R6  s:21594,PREL

      231    21593    3                    A = 0;

  21593   1 0001A7  8747 000C                            CL       A,AUTO
          1 0001A9  8747 000D                            CL       A+1,AUTO

      232    21594    3                 PARM.PTRS.PAR2$->INTERVAL = A / C(FPT_CLOCKV.UTYPE);

  21594   1 0001AB  9CC4 0008                            LDB,B1   8,B4
          1 0001AD  B803                                 LDR,R3   ,B3
          1 0001AE  304A                                 SOR,R3   10
          1 0001AF  B570 0003                            AND,R3   3,IMO
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:41   
          1 0001B1  F830 0000 0016  00                   LDR,R7   C,R3
          1 0001B4  6C00                                 LDV,R6   0
          1 0001B5  8D47 0030                            SDI      MODE+21,AUTO
          1 0001B7  0027                                 CBD      ;
          1 0001B8       0407 0030                                BINARY(MODE+21,AUTO,,4),;
          1 0001BA       4C07 001E                                UNPACKED(MODE+3,AUTO,,12,LEADING)
          1 0001BC  0027                                 CBD      ;
          1 0001BD       0407 000C                                BINARY(A,AUTO,,4),;
          1 0001BF       4C07 0024                                UNPACKED(MODE+9,AUTO,,12,LEADING)
          1 0001C1  002B                                 DDV      ;
          1 0001C2       4C07 001E                                UNPACKED(MODE+3,AUTO,,12,LEADING),;
          1 0001C4       4C07 0024                                UNPACKED(MODE+9,AUTO,,12,LEADING),;
          1 0001C6       4C07 002A                                UNPACKED(MODE+15,AUTO,,12,LEADING)
          1 0001C8  002A                                 CDB      ;
          1 0001C9       4C07 002A                                UNPACKED(MODE+15,AUTO,,12,LEADING),;
          1 0001CB       0407 0032                                BINARY(MODE+23,AUTO,,4)
          1 0001CD  437F                                 CSYNC    s:21594+33,SPREL
          1 0001CE  D847 0033                            LDR,R5   MODE+24,AUTO
          1 0001D0  DF01                                 STR,R5   ,B1

      233    21595    3               END;                        /* End CLOCK cases                    */

      234    21596    2            END;                           /* End MODE cases                     */

      235    21597    1           IF FPT_CLOCKV.CANCEL THEN

  21597   1 0001D1  ECC7 000F                            LDB,B6   P1$,AUTO
          1 0001D3  8286                                 LB,'0200'X        ,B6
          1 0001D4       0200
          1 0001D5  0581 0028                            BBF      s:21605,PREL

      236    21598    2           DO CASE(FPT_CLOCKV.CLOCK);

  21598   1 0001D7  B806                                 LDR,R3   ,B6
          1 0001D8  304E                                 SOR,R3   14
          1 0001D9  3D02                                 CMV,R3   2
          1 0001DA  0281 0023                            BGE      s:21605,PREL
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:42   
          1 0001DC  A830 0000 01E2  01                   LDR,R2   s:21598+11,R3
          1 0001DF  83A0 0000 01E4  01                   JMP      s:21600,R2
          1 0001E2       0000                            DC       s:21600,PREL
          1 0001E3       000B                            DC       s:21603,PREL

      237    21599    2            CASE(%G_WALL#);

      238    21600    2              IF G$U.CLOCK ~= 0 THEN

  21600   1 0001E4  DCC7 0013                            LDB,B5   CU$,AUTO
          1 0001E6  E845 0009                            LDR,R6   9,B5
          1 0001E8  6901 0015                            BEZ,R6   s:21605,PREL

      239    21601    2                 CALL CANCEL;

  21601   1 0001EA  E3C0 0060                            LNJ,B6   s:0,PREL
          1 0001EC       0001                            DC       s:21601+3,PREL
          1 0001ED  0F81 0010                            B        s:21605,PREL

      240    21602    2            CASE(%G_EXECUTION#);

      241    21603    2              G$JIT.TIMERS(DMN) = 0;

  21603   1 0001EF  DC80 0000 0000  xsym                 LDB,B5   G$JIT$
          1 0001F2  CBC5 00A8                            LAB,B4   168,B5
          1 0001F4  9847 0018                            LDR,R1   DMN,AUTO
          1 0001F6  1001                                 SOL,R1   1
          1 0001F7  8714                                 CL       ,B4,R1
          1 0001F8  DC80 0000 0000  xsym                 LDB,B5   G$JIT$
          1 0001FB  CBC5 00A9                            LAB,B4   169,B5
          1 0001FD  8714                                 CL       ,B4,R1

      242    21604    2            END;                           /* End CLOCK cases                    */

      243    21605    1           RETURN;

  21605   1 0001FE  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:43   

      244    21606
      245    21607
      246    21608
      247    21609    1   QWALCLK: PROC;

  21609   1 000201  EFC7 001C            QWALCLK         STB,B6   MODE+1,AUTO

      248    21610
      249    21611        /*  Queue user with those waiting for wall time clocks, in order. */
      250    21612
      251    21613    2           J=0;

  21613   1 000203  8747 000A                            CL       J,AUTO

      252    21614    2           I= GH_CLOCKHD;

  21614   1 000205  E800 0000 0000  xsym                 LDR,R6   GH_CLOCKHD
          1 000208  EF47 000B                            STR,R6   I,AUTO

      253    21615    3           DO WHILE ( I ~= -1);

  21615   1 00020A  0F81 001A                            B        s:21620,PREL

      254    21616    3              IF G$USER.UTS(I) >= G$U.UTS THEN

  21616   1 00020C  ECC7 0013                            LDB,B6   CU$,AUTO
          1 00020E  DC80 0000 0000  xsym                 LDB,B5   G$USRT$
          1 000211  CBC5 0007                            LAB,B4   7,B5
          1 000213  B847 000B                            LDR,R3   I,AUTO
          1 000215  3F0C                                 MLV,R3   12
          1 000216  8CB4                                 LDI      ,B4,R3
          1 000217  84C6 0007                            SID      7,B6
          1 000219  0601 000D                            BCT      s:21621,PREL

      255    21617    3                 GOTO GOTIT;
      256    21618    3              J=I;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:44   

  21618   1 00021B  E847 000B                            LDR,R6   I,AUTO
          1 00021D  EF47 000A                            STR,R6   J,AUTO

      257    21619    3              I=G$USER.CLOCK(I);

  21619   1 00021F  A856                                 LDR,R2   R6
          1 000220  2F18                                 MLV,R2   24
          1 000221  2E09                                 ADV,R2   9
          1 000222  E825                                 LDR,R6   ,B5,R2
          1 000223  EF47 000B                            STR,R6   I,AUTO

      258    21620    3              END;

  21620   1 000225  6DFF                                 CMV,R6   -1
          1 000226  09E6                                 BNE      s:21616,SPREL

      259    21621    2   GOTIT:  G$U.CLOCK=I;

  21621   1 000227  ECC7 0013            GOTIT           LDB,B6   CU$,AUTO
          1 000229  E847 000B                            LDR,R6   I,AUTO
          1 00022B  EF46 0009                            STR,R6   9,B6

      260    21622    2           IF J = 0 THEN

  21622   1 00022D  D847 000A                            LDR,R5   J,AUTO
          1 00022F  5981 000B                            BNEZ,R5  s:21625,PREL

      261    21623    2              GH_CLOCKHD = G$MHJIT.CUN;

  21623   1 000231  DC80 0000 0000  xsym                 LDB,B5   G$MHJIT$
          1 000234  C845 0351                            LDR,R4   849,B5
          1 000236  CF00 0000 0000  xsym                 STR,R4   GH_CLOCKHD
          1 000239  0F81 000D                            B        s:21626,PREL

      262    21624    2           ELSE
      263    21625    2              G$USER.CLOCK(J) = G$MHJIT.CUN;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:45   

  21625   1 00023B  DC80 0000 0000  xsym                 LDB,B5   G$USRT$
          1 00023E  B855                                 LDR,R3   R5
          1 00023F  3F18                                 MLV,R3   24
          1 000240  3E09                                 ADV,R3   9
          1 000241  CC80 0000 0000  xsym                 LDB,B4   G$MHJIT$
          1 000244  C844 0351                            LDR,R4   849,B4
          1 000246  CF35                                 STR,R4   ,B5,R3

      264    21626    2           RETURN;

  21626   1 000247  ECC7 001C                            LDB,B6   MODE+1,AUTO
          1 000249  C3C6 0001                            LNJ,B4   1,B6

      265    21627    2   END QWALCLK;
      266    21628    1   CANCEL: PROC;

  21628   1 00024B  EFC7 001C            CANCEL          STB,B6   MODE+1,AUTO

      267    21629
      268    21630        /* Search Clock queue for this user and delete his entry */
      269    21631
      270    21632    3           IF GH_CLOCKHD ~= -1 THEN DO;

  21632   1 00024D  E800 0000 0000  xsym                 LDR,R6   GH_CLOCKHD
          1 000250  6DFF                                 CMV,R6   -1
          1 000251  0901 0045                            BE       s:21648,PREL

      271    21633    3              I=GH_CLOCKHD;

  21633   1 000253  EF47 000B                            STR,R6   I,AUTO

      272    21634    3              J=0;

  21634   1 000255  8747 000A                            CL       J,AUTO

      273    21635    4              DO WHILE (I ~= -1);
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:46   

  21635   1 000257  0F81 0015                            B        s:21640,PREL

      274    21636    4                 IF I = G$MHJIT.CUN THEN

  21636   1 000259  EC80 0000 0000  xsym                 LDB,B6   G$MHJIT$
          1 00025C  E847 000B                            LDR,R6   I,AUTO
          1 00025E  E946 0351                            CMR,R6   849,B6
          1 000260  0901 0010                            BE       s:21642,PREL

      275    21637    4                    GOTO CNCL1;
      276    21638    4                 J=I;

  21638   1 000262  EF47 000A                            STR,R6   J,AUTO

      277    21639    4                 I=G$USER.CLOCK(I);

  21639   1 000264  DC80 0000 0000  xsym                 LDB,B5   G$USRT$
          1 000267  B856                                 LDR,R3   R6
          1 000268  3F18                                 MLV,R3   24
          1 000269  3E09                                 ADV,R3   9
          1 00026A  E835                                 LDR,R6   ,B5,R3
          1 00026B  EF47 000B                            STR,R6   I,AUTO

      278    21640    4                 END;

  21640   1 00026D  6DFF                                 CMV,R6   -1
          1 00026E  09EB                                 BNE      s:21636,SPREL

      279    21641    3              GOTO CNCL2;

  21641   1 00026F  0F81 001C                            B        s:21646,PREL

      280    21642    3   CNCL1:     IF J = 0 THEN

  21642   1 000271  D847 000A            CNCL1           LDR,R5   J,AUTO
          1 000273  5981 000D                            BNEZ,R5  s:21645,PREL
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:47   

      281    21643    3                 GH_CLOCKHD = G$USER.CLOCK(I);

  21643   1 000275  DC80 0000 0000  xsym                 LDB,B5   G$USRT$
          1 000278  B856                                 LDR,R3   R6
          1 000279  3F18                                 MLV,R3   24
          1 00027A  3E09                                 ADV,R3   9
          1 00027B  C835                                 LDR,R4   ,B5,R3
          1 00027C  CF00 0000 0000  xsym                 STR,R4   GH_CLOCKHD
          1 00027F  0F81 000C                            B        s:21646,PREL

      282    21644    3              ELSE
      283    21645    3                 G$USER.CLOCK(J) = G$USER.CLOCK(I);

  21645   1 000281  DC80 0000 0000  xsym                 LDB,B5   G$USRT$
          1 000284  B855                                 LDR,R3   R5
          1 000285  3F18                                 MLV,R3   24
          1 000286  3E09                                 ADV,R3   9
          1 000287  A856                                 LDR,R2   R6
          1 000288  2F18                                 MLV,R2   24
          1 000289  2E09                                 ADV,R2   9
          1 00028A  C825                                 LDR,R4   ,B5,R2
          1 00028B  CF35                                 STR,R4   ,B5,R3

      284    21646    3   CNCL2:     G$USER.CLOCK(G$MHJIT.CUN) = 0;

  21646   1 00028C  EC80 0000 0000  xsym CNCL2           LDB,B6   G$MHJIT$
          1 00028F  B846 0351                            LDR,R3   849,B6
          1 000291  DC80 0000 0000  xsym                 LDB,B5   G$USRT$
          1 000294  3F18                                 MLV,R3   24
          1 000295  3E09                                 ADV,R3   9
          1 000296  8735                                 CL       ,B5,R3

      285    21647    3              END;

      286    21648    2           RETURN;

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:48   
  21648   1 000297  ECC7 001C                            LDB,B6   MODE+1,AUTO
          1 000299  C3C6 0001                            LNJ,B4   1,B6

      287    21649    2   END CANCEL;
      288    21650        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:49   
      289    21651        /*F*
      290    21652              NAME:  GUS$RNDCLK
      291    21653              PURPOSE:
      292    21654                    To cancel an outstanding clock request during rundown.
      293    21655              CALL:
      294    21656                    CALL GUS$RNDCLK ();
      295    21657        */
      296    21658    1   GUS$RNDCLK: ENTRY;

  21658   1 00029B  D380 0000 0000  xent GUS$RNDCLK      LNJ,B5   X6A_AUTO_1
          1 00029E       0034 0001                       DC       52,1

      297    21659
      298    21660                %LOCK (G = G_CLKGATE);

  21665   1 0002A0  BB80 0000 0000  02                   LAB,B3   0
          1 0002A3  CBF0 0100                            LAB,B4   256,IMO
          1 0002A5  E380 0000 0000  xent                 LNJ,B6   GHH$LOCK
          1 0002A8       0001                            DC       s:21667,PREL

      299    21667    1           CALL CANCEL;

  21667   1 0002A9  E3C0 FFA1                            LNJ,B6   s:0,PREL
          1 0002AB       0001                            DC       s:21673,PREL

      300    21668                %UNLOCK (G = G_CLKGATE);

  21673   1 0002AC  BB80 0000 0000  02                   LAB,B3   0
          1 0002AF  CBF0 0100                            LAB,B4   256,IMO
          1 0002B1  E380 0000 0000  xent                 LNJ,B6   GHH$UNLOCK
          1 0002B4       0001                            DC       s:21675,PREL

      301    21675    1           RETURN;

  21675   1 0002B5  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      302    21676
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:50   
      303    21677        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:51   
      304    21678        /*F*
      305    21679              NAME:  GUS$RESTRTCLK
      306    21680              PURPOSE:
      307    21681                 To restart a permanent wall time clock.
      308    21682              CALL:
      309    21683                 CALL GUS$RESTRTCLK;
      310    21684        */
      311    21685    1   GUS$RESTRTCLK: ENTRY;

  21685   1 0002B8  D380 0000 0000  xent GUS$RESTRTCLK   LNJ,B5   X6A_AUTO_1
          1 0002BB       0034 0001                       DC       52,1

      312    21686
      313    21687    1           CU$=G$MHJIT.CU$;

  21687   1 0002BD  EC80 0000 0000  xsym                 LDB,B6   G$MHJIT$
          1 0002C0  DCC6 0352                            LDB,B5   850,B6
          1 0002C2  DFC7 0013                            STB,B5   CU$,AUTO

      314    21688    1           CALL GHI$UTS (T);

  21688   1 0002C4  CBC7 0006                            LAB,B4   T,AUTO
          1 0002C6  CFC7 001E                            STB,B4   MODE+3,AUTO
          1 0002C8  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 0002CA  CBF0 0100                            LAB,B4   256,IMO
          1 0002CC  E380 0000 0000  xent                 LNJ,B6   GHI$UTS
          1 0002CF       0001                            DC       s:21689,PREL

      315    21689    1           G$U.UTS = T + G$JIT.CLUKRINT;

  21689   1 0002D0  EC80 0000 0000  xsym                 LDB,B6   G$JIT$
          1 0002D3  8CC7 0006                            LDI      T,AUTO
          1 0002D5  8446 0075                            AID      117,B6
          1 0002D7  DCC7 0013                            LDB,B5   CU$,AUTO
          1 0002D9  8D45 0007                            SDI      7,B5

      316    21690                %LOCK (G=G_CLKGATE);
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:52   

  21695   1 0002DB  BB80 0000 0000  02                   LAB,B3   0
          1 0002DE  CBF0 0100                            LAB,B4   256,IMO
          1 0002E0  E380 0000 0000  xent                 LNJ,B6   GHH$LOCK
          1 0002E3       0001                            DC       s:21697,PREL

      317    21697    1           CALL QWALCLK;

  21697   1 0002E4  E3C0 FF1C                            LNJ,B6   s:0,PREL
          1 0002E6       0001                            DC       s:21703,PREL

      318    21698                %UNLOCK (G=G_CLKGATE);

  21703   1 0002E7  BB80 0000 0000  02                   LAB,B3   0
          1 0002EA  CBF0 0100                            LAB,B4   256,IMO
          1 0002EC  E380 0000 0000  xent                 LNJ,B6   GHH$UNLOCK
          1 0002EF       0001                            DC       s:21705,PREL

      319    21705    1           RETURN;

  21705   1 0002F0  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      320    21706
      321    21707        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:53   
      322    21708        /*F*
      323    21709             NAME: GUS$WAIT
      324    21710             PURPOSE:
      325    21711                  To process the M$WAIT monitor service.
      326    21712                  time.
      327    21713        */
      328    21714        /*D*
      329    21715             NAME: GUS$WAIT
      330    21716             CALL:
      331    21717                   Standard MCL service decoder call.
      332    21718             DESCRIPTION:
      333    21719                  The specified time interval is added to the current time to
      334    21720                  determine when the user is to be awakened. The user is placed
      335    21721                  in the scheduler Wait state queue.
      336    21722        */
      337    21723    1   GUS$WAIT: ENTRY (PARM);

  21723   1 0002F3  D380 0000 0000  xent GUS$WAIT        LNJ,B5   X6A_AUTO_1
          1 0002F6       0034 0001                       DC       52,1

      338    21724
      339    21725        /* Scan the queue before we go to sleep */
      340    21726    1           CALL KNH$SCAN(,T);

  21726   1 0002F8  EBC7 0006                            LAB,B6   T,AUTO
          1 0002FA  EFC7 0020                            STB,B6   MODE+5,AUTO
          1 0002FC  DB80 0000 0000                       LAB,B5   0
          1 0002FF  DFC7 001E                            STB,B5   MODE+3,AUTO
          1 000301  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 000303  CBF0 0200                            LAB,B4   512,IMO
          1 000305  E380 0000 0000  xent                 LNJ,B6   KNH$SCAN
          1 000308       0001                            DC       s:21728,PREL

      341    21727
      342    21728    1           CALL GHR$MON;

  21728   1 000309  CBF0 0000                            LAB,B4   0,IMO
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:54   
          1 00030B  E380 0000 0000  xent                 LNJ,B6   GHR$MON
          1 00030E       0001                            DC       s:21729,PREL

      343    21729    1           P1$=PARM.PTRS.PAR1$;

  21729   1 00030F  ECC7 0004                            LDB,B6   @PARM,AUTO
          1 000311  DCC6 0006                            LDB,B5   6,B6
          1 000313  DFC7 000F                            STB,B5   P1$,AUTO

      344    21730    2           DO CASE (FPT_WAITV.UTYPE);

  21730   1 000315  B805                                 LDR,R3   ,B5
          1 000316  304C                                 SOR,R3   12
          1 000317  B570 0003                            AND,R3   3,IMO
          1 000319  3D03                                 CMV,R3   3
          1 00031A  0281 004E                            BGE      s:21746,PREL
          1 00031C  A830 0000 0322  01                   LDR,R2   s:21730+13,R3
          1 00031F  83A0 0000 0325  01                   JMP      s:21732,R2
          1 000322       003F                            DC       s:21743,PREL
          1 000323       002D                            DC       s:21740,PREL
          1 000324       0000                            DC       s:21732,PREL

      345    21731    2            CASE(%G_WAIT_UTS#);

      346    21732    2              CALL GHI$UTS (T);

  21732   1 000325  CBC7 0006                            LAB,B4   T,AUTO
          1 000327  CFC7 001E                            STB,B4   MODE+3,AUTO
          1 000329  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 00032B  CBF0 0100                            LAB,B4   256,IMO
          1 00032D  E380 0000 0000  xent                 LNJ,B6   GHI$UTS
          1 000330       0001                            DC       s:21733,PREL

      347    21733    2              U = PARM.PTRS.PAR2$->UTSVALUE - G$MHJIT.BOOTUTS;

  21733   1 000331  ECC7 0004                            LDB,B6   @PARM,AUTO
          1 000333  DCC6 0008                            LDB,B5   8,B6
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:55   
          1 000335  CC80 0000 0000  xsym                 LDB,B4   G$MHJIT$
          1 000338  8C85                                 LDI      ,B5
          1 000339  84C4 035A                            SID      858,B4
          1 00033B  8D47 0008                            SDI      U,AUTO

      348    21734    3              IF U <= T THEN DO;

  21734   1 00033D  84C7 0006                            SID      T,AUTO
          1 00033F  6981 0003                            BNEZ,R6  s:21734+6,PREL
          1 000341  7901 0003                            BEZ,R7   s:21735,PREL
          1 000343  0601 0005                            BCT      s:21738,PREL

      349    21735    3                 S=0;

  21735   1 000345  8747 000E                            CL       S,AUTO

      350    21736    3                 GOTO NO_WAIT;

  21736   1 000347  0F81 0073                            B        s:21762,PREL

      351    21737    3                 END;
      352    21738    2              S = U-T;

  21738   1 000349  8CC7 0008                            LDI      U,AUTO
          1 00034B  84C7 0006                            SID      T,AUTO
          1 00034D  E857                                 LDR,R6   R7
          1 00034E  EF47 000E                            STR,R6   S,AUTO
          1 000350  0F81 0018                            B        s:21746,PREL

      353    21739    2            CASE(%G_WAIT_SEC#);

      354    21740    2              U = PARM.PTRS.PAR2$->INTERVAL * 15 ;

  21740   1 000352  CCC6 0008                            LDB,B4   8,B6
          1 000354  F804                                 LDR,R7   ,B4
          1 000355  6C00                                 LDV,R6   0
          1 000356  9B80 0000 0002  02                   LAB,B1   +2
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:56   
          1 000359  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          1 00035C  8D47 0008                            SDI      U,AUTO

      355    21741    2              S = U / 2 ;

  21741   1 00035E  70C1                                 DOR,R7   1
          1 00035F  E857                                 LDR,R6   R7
          1 000360  EF47 000E                            STR,R6   S,AUTO
          1 000362  0F81 0006                            B        s:21746,PREL

      356    21742    2            CASE(%G_WAIT_TICS#);

      357    21743    2              S = PARM.PTRS.PAR2$->INTERVAL;

  21743   1 000364  CCC6 0008                            LDB,B4   8,B6
          1 000366  E804                                 LDR,R6   ,B4
          1 000367  EF47 000E                            STR,R6   S,AUTO

      358    21744    2            END;

      359    21745
      360    21746    2           DO CASE (FPT_WAITV.MODE);

  21746   1 000369  ECC7 000F                            LDB,B6   P1$,AUTO
          1 00036B  B806                                 LDR,R3   ,B6
          1 00036C  304E                                 SOR,R3   14
          1 00036D  3D02                                 CMV,R3   2
          1 00036E  0281 00A4                            BGE      s:21777,PREL
          1 000370  A830 0000 0376  01                   LDR,R2   s:21746+13,R3
          1 000373  83A0 0000 0378  01                   JMP      s:21748,R2
          1 000376       002B                            DC       s:21756,PREL
          1 000377       0000                            DC       s:21748,PREL

      361    21747    2            CASE(%G_WAIT_ADJUST#);

      362    21748    2              J = G$JIT.USR#;

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:57   
  21748   1 000378  DC80 0000 0000  xsym                 LDB,B5   G$JIT$
          1 00037B  E845 0004                            LDR,R6   4,B5
          1 00037D  E570 00FF                            AND,R6   255,IMO
          1 00037F  EF47 000A                            STR,R6   J,AUTO

      363    21749    2              IF G$USER.US(J) = %GH_W THEN

  21749   1 000381  CC80 0000 0000  xsym                 LDB,B4   G$USRT$
          1 000384  B856                                 LDR,R3   R6
          1 000385  3F18                                 MLV,R3   24
          1 000386  3E02                                 ADV,R3   2
          1 000387  D834                                 LDR,R5   ,B4,R3
          1 000388  5D0E                                 CMV,R5   14
          1 000389  0981 0017                            BNE      s:21754,PREL

      364    21750    3              DO;

      365    21751    3                 CALL GHS$RUE (%GH_EVSL,J,S);

  21751   1 00038B  BBF0 0001                            LAB,B3   1,IMO
          1 00038D  ABC7 000E                            LAB,B2   S,AUTO
          1 00038F  AFC7 0022                            STB,B2   MODE+7,AUTO
          1 000391  9BC7 000A                            LAB,B1   J,AUTO
          1 000393  9FC7 0020                            STB,B1   MODE+5,AUTO
          1 000395  BFC7 001E                            STB,B3   MODE+3,AUTO
          1 000397  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 000399  CBF0 0300                            LAB,B4   768,IMO
          1 00039B  E380 0000 0000  xent                 LNJ,B6   GHS$RUE
          1 00039E       0001                            DC       s:21752,PREL

      366    21752    3                 S = 0;

  21752   1 00039F  8747 000E                            CL       S,AUTO

      367    21753    3                 END;

      368    21754    2              GOTO NO_WAIT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:58   

  21754   1 0003A1  0F81 0019                            B        s:21762,PREL

      369    21755    2            CASE(%G_WAIT_SUSP#);

      370    21756    2              CU$ = G$MHJIT.CU$;

  21756   1 0003A3  DC80 0000 0000  xsym                 LDB,B5   G$MHJIT$
          1 0003A6  CCC5 0352                            LDB,B4   850,B5
          1 0003A8  CFC7 0013                            STB,B4   CU$,AUTO

      371    21757    2              D$ = G$U.DL$;

  21757   1 0003AA  BCC4 000D                            LDB,B3   13,B4
          1 0003AC  BFC7 0011                            STB,B3   D$,AUTO

      372    21758    3              DO WHILE ( D$ ~= ADDR(NIL));

  21758   1 0003AE  0F81 0025                            B        s:21768,PREL

      373    21759    3                 IF D$->G$DO.BUSY THEN

  21759   1 0003B0  ECC7 0011                            LDB,B6   D$,AUTO
          1 0003B2  89C6 0002                            CMZ      2,B6
          1 0003B4  0881 0006                            BAGE     s:21762,PREL

      374    21760    3                    D$ = D$->G$DO.LNK$;

  21760   1 0003B6  DC86                                 LDB,B5   ,B6
          1 0003B7  DFC7 0011                            STB,B5   D$,AUTO
          1 0003B9  0F81 001A                            B        s:21768,PREL

      375    21761    3                 ELSE
      376    21762    4                 DO;

      377    21763    4   NO_WAIT:         IF PARM.MCL.V# = 3 AND PARM.PTRS.PAR3$ ~= ADDR(NIL) THEN

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:59   
  21763   1 0003BB  ECC7 0004            NO_WAIT         LDB,B6   @PARM,AUTO
          1 0003BD  E806                                 LDR,R6   ,B6
          1 0003BE  604A                                 SOR,R6   10
          1 0003BF  6D03                                 CMV,R6   3
          1 0003C0  0981 000A                            BNE      s:21765,PREL
          1 0003C2  8DC6 000A                            CMN      10,B6
          1 0003C4  0901 0006                            BE       s:21765,PREL

      378    21764    4                       PARM.PTRS.PAR3$->INTERVAL = S;

  21764   1 0003C6  DCC6 000A                            LDB,B5   10,B6
          1 0003C8  D847 000E                            LDR,R5   S,AUTO
          1 0003CA  DF05                                 STR,R5   ,B5

      379    21765    4                    CALL GHR$SRV;

  21765   1 0003CB  CBF0 0000                            LAB,B4   0,IMO
          1 0003CD  E380 0000 0000  xent                 LNJ,B6   GHR$SRV
          1 0003D0       0001                            DC       s:21766,PREL

      380    21766    4                    RETURN;

  21766   1 0003D1  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      381    21767    4                    END;
      382    21768    3                 END;

  21768   1 0003D4  8DC7 0011                            CMN      D$,AUTO
          1 0003D6  09DA                                 BNE      s:21759,SPREL

      383    21769    2              CALL GHS$REG (%GH_EVSL,S);

  21769   1 0003D7  EBF0 0001                            LAB,B6   1,IMO
          1 0003D9  DBC7 000E                            LAB,B5   S,AUTO
          1 0003DB  DFC7 0020                            STB,B5   MODE+5,AUTO
          1 0003DD  EFC7 001E                            STB,B6   MODE+3,AUTO
          1 0003DF  BBC7 001E                            LAB,B3   MODE+3,AUTO
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:60   
          1 0003E1  CBF0 0200                            LAB,B4   512,IMO
          1 0003E3  E380 0000 0000  xent                 LNJ,B6   GHS$REG
          1 0003E6       0001                            DC       s:21770,PREL

      384    21770    2              CALL GHI$UTS (T);

  21770   1 0003E7  EBC7 0006                            LAB,B6   T,AUTO
          1 0003E9  EFC7 001E                            STB,B6   MODE+3,AUTO
          1 0003EB  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 0003ED  CBF0 0100                            LAB,B4   256,IMO
          1 0003EF  E380 0000 0000  xent                 LNJ,B6   GHI$UTS
          1 0003F2       0001                            DC       s:21771,PREL

      385    21771    2              IF PARM.MCL.V# = 3 AND PARM.PTRS.PAR3$ ~= ADDR(NIL) THEN

  21771   1 0003F3  ECC7 0004                            LDB,B6   @PARM,AUTO
          1 0003F5  E806                                 LDR,R6   ,B6
          1 0003F6  604A                                 SOR,R6   10
          1 0003F7  6D03                                 CMV,R6   3
          1 0003F8  0981 001A                            BNE      s:21777,PREL
          1 0003FA  8DC6 000A                            CMN      10,B6
          1 0003FC  0901 0016                            BE       s:21777,PREL

      386    21772    2                 IF G$U.MISC < T THEN

  21772   1 0003FE  DCC7 0013                            LDB,B5   CU$,AUTO
          1 000400  8CC5 0005                            LDI      5,B5
          1 000402  84C7 0006                            SID      T,AUTO
          1 000404  0601 0006                            BCT      s:21775,PREL

      387    21773    2                    PARM.PTRS.PAR3$->INTERVAL = 0;

  21773   1 000406  CCC6 000A                            LDB,B4   10,B6
          1 000408  8704                                 CL       ,B4
          1 000409  0F81 0009                            B        s:21777,PREL

      388    21774    2                 ELSE
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:61   
      389    21775    2                    PARM.PTRS.PAR3$->INTERVAL = G$U.MISC-T;

  21775   1 00040B  CCC6 000A                            LDB,B4   10,B6
          1 00040D  8CC5 0005                            LDI      5,B5
          1 00040F  84C7 0006                            SID      T,AUTO
          1 000411  E857                                 LDR,R6   R7
          1 000412  EF04                                 STR,R6   ,B4

      390    21776    2            END;

      391    21777    1           RETURN;

  21777   1 000413  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      392    21778
      393    21779        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:62   
      394    21780        /*F*
      395    21781             NAME: GUS$MAKEUSR
      396    21782             PURPOSE: To process the M$MAKEUSR monitor service.
      397    21783        */
      398    21784        /*D*
      399    21785             NAME: GUS$MAKEUSR
      400    21786             CALL: Standard MCL service decoder call.
      401    21787             DESCRIPTION:
      402    21788                A new user is obtained by calling GHS$ADDUSER and his
      403    21789                context initialized from values passed through the FPT.
      404    21790                An error code is returned if the user cannot be started.
      405    21791                If he is started successfully he beomes executable
      406    21792                immediatly and may begin executing before we return to
      407    21793                the caller.
      408    21794
      409    21795                This service may only be called from NODEADMIN, User #1.
      410    21796                                                                          */
      411    21797    1   GUS$MAKEUSR: ENTRY (PARM);

  21797   1 000416  D380 0000 0000  xent GUS$MAKEUSR     LNJ,B5   X6A_AUTO_1
          1 000419       0034 0001                       DC       52,1

      412    21798
      413    21799    1           IF G$JIT.USR# ~= 1 THEN

  21799   1 00041B  EC80 0000 0000  xsym                 LDB,B6   G$JIT$
          1 00041E  E846 0004                            LDR,R6   4,B6
          1 000420  E570 00FF                            AND,R6   255,IMO
          1 000422  6D01                                 CMV,R6   1
          1 000423  0901 000B                            BE       s:21811,PREL

      414    21800    2           DO;

      415    21801    2              PARM.ERR=NOTAUTH;

  21801   1 000425  8C80 0000 0000  00                   LDI      NOTAUTH
          1 000428  DCC7 0004                            LDB,B5   @PARM,AUTO
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:63   
          1 00042A  8D45 0003                            SDI      3,B5

      416    21802    2              RETURN;

  21802   1 00042C  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      417    21803    2              END;
      418    21804        /*E* ERROR: GUS-E$NOTAUTH-E
      419    21805             MESSAGE: Only Node Admin may use the M$MAKEUSR monitor service.
      420    21806        */
      421    21807
      422    21808        /* Search the account resource table for this UNAME/ACCT and make
      423    21809           sure niether the max number of FPRGS or memory will be exceeded.
      424    21810        */
      425    21811    1           P1$=PARM.PTRS.PAR1$;

  21811   1 00042F  DCC7 0004                            LDB,B5   @PARM,AUTO
          1 000431  CCC5 0006                            LDB,B4   6,B5
          1 000433  CFC7 000F                            STB,B4   P1$,AUTO

      426    21812    1           MODE=KL_STRTU.MODE;

  21812   1 000435  D2C4 0013                            LLH,R5   19,B4
          1 000437  DF47 001B                            STR,R5   MODE,AUTO

      427    21813    1           I=KL_STRTU.INTS;                /* Number of interrupts*/

  21813   1 000439  E2C4 001B                            LLH,R6   27,B4
          1 00043B  EF47 000B                            STR,R6   I,AUTO

      428    21814    1           GFR@INDX=0;

  21814   1 00043D  8747 0019                            CL       GFR@INDX,AUTO

      429    21815    1           GFR@PGSZ = GM_INIT_PGSZ;

  21815   1 00043F  C800 0000 0000  xsym                 LDR,R4   GM_INIT_PGSZ
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:64   
          1 000442  CF47 001A                            STR,R4   GFR@PGSZ,AUTO

      430    21816
      431    21817    1           IF G$BOBCAT.ACCT_RES# ~= 0

  21817   1 000444  BC80 0000 0000  xsym                 LDB,B3   G$BOBCAT$
          1 000447  B843 000E                            LDR,R3   14,B3
          1 000449  3901 00D5                            BEZ,R3   s:21901,PREL

      432    21818    2           THEN DO;

      433    21819    2              CODE=0;

  21819   1 00044B  8747 0017                            CL       CODE,AUTO

      434    21820    2              D$=G$BOBCAT.ACCT_RES$;

  21820   1 00044D  ACC3 0020                            LDB,B2   32,B3
          1 00044F  AFC7 0011                            STB,B2   D$,AUTO

      435    21821                   %LOCK (G=GFR_RES_LOCK);

  21826   1 000451  BB80 0000 0004  02                   LAB,B3   +4
          1 000454  CBF0 0100                            LAB,B4   256,IMO
          1 000456  E380 0000 0000  xent                 LNJ,B6   GHH$LOCK
          1 000459       0001                            DC       s:21828,PREL

      436    21828    2              IF GFR_CUR_MEM(MODE) + GFR@PGSZ > GFR_MAX_MEM(MODE)

  21828   1 00045A  B847 001B                            LDR,R3   MODE,AUTO
          1 00045C  E830 0000 0000  xsym                 LDR,R6   GFR_CUR_MEM,R3
          1 00045F  EA47 001A                            ADD,R6   GFR@PGSZ,AUTO
          1 000461  E930 0000 0000  xsym                 CMR,R6   GFR_MAX_MEM,R3
          1 000464  0381 0007                            BLE      s:21834,PREL

      437    21829    3              THEN DO;

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:65   
      438    21830    3                 CODE = %E$MODE_MEMLIMIT;

  21830   1 000466  E870 04D4                            LDR,R6   1236,IMO
          1 000468  EF47 0017                            STR,R6   CODE,AUTO

      439    21831    3                 GOTO GFR_END;

  21831   1 00046A  0F81 00A7                            B        s:21884,PREL

      440    21832    3                 END;
      441    21833
      442    21834    3              DO GFR@INDX=0 TO G$BOBCAT.ACCT_RES#;

  21834   1 00046C  8747 0019                            CL       GFR@INDX,AUTO
          1 00046E  0F81 0066                            B        s:21858+2,PREL

      443    21835    3                 IF GFR$ACCT.UNAME(GFR@INDX) = KL_STRTU.UNAME

  21835   1 000470  ECC7 0011                            LDB,B6   D$,AUTO
          1 000472  B847 0019                            LDR,R3   GFR@INDX,AUTO
          1 000474  3F1C                                 MLV,R3   28
          1 000475  DCC7 000F                            LDB,B5   P1$,AUTO
          1 000477  0022                                 ACM      ;
          1 000478       4C36 0000                                ALPHANUM(0,B6,R3,,12,FILL),;
          1 00047A       4C05 0005                                ALPHANUM(5,B5,,12,FILL)
          1 00047C  5301 0056                            CBNE     s:21858,PREL
          1 00047E  0022                                 ACM      ;
          1 00047F       4836 0006                                ALPHANUM(6,B6,R3,,8,FILL),;
          1 000481       4805 000B                                ALPHANUM(11,B5,,8,FILL)
          1 000483  5301 004F                            CBNE     s:21858,PREL

      444    21836    3                   AND GFR$ACCT.ACCN(GFR@INDX) = KL_STRTU.ACCT
      445    21837    4                 THEN DO;

  21831   1                              SET_ACCRES      null
      446    21838    4   SET_ACCRES:      ;
      447    21839    4                    GFR$ACCT.MAX_MEM(GFR@INDX) = KL_STRTU.MACCTMEM;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:66   

  21839   1 000485  ECC7 0011            SET_ACCRES      LDB,B6   D$,AUTO
          1 000487  B847 0019                            LDR,R3   GFR@INDX,AUTO
          1 000489  3F0E                                 MLV,R3   14
          1 00048A  3E0A                                 ADV,R3   10
          1 00048B  DCC7 000F                            LDB,B5   P1$,AUTO
          1 00048D  E845 001C                            LDR,R6   28,B5
          1 00048F  EF36                                 STR,R6   ,B6,R3

      448    21840    4                    GFR$ACCT.MAX_FPRGS(GFR@INDX) = KL_STRTU.MACCTFPRG;

  21840   1 000490  A847 0019                            LDR,R2   GFR@INDX,AUTO
          1 000492  2F0E                                 MLV,R2   14
          1 000493  2E0C                                 ADV,R2   12
          1 000494  D845 001B                            LDR,R5   27,B5
          1 000496  D570 00FF                            AND,R5   255,IMO
          1 000498  DF26                                 STR,R5   ,B6,R2

      449    21841                            /*Update our tables with the latest SUPER information.    */
      450    21842
      451    21843    4                    IF GFR$ACCT.CUR_FPRGS(GFR@INDX) >= GFR$ACCT.MAX_FPRGS(GFR@INDX)

  21843   1 000499  9847 0019                            LDR,R1   GFR@INDX,AUTO
          1 00049B  1F0E                                 MLV,R1   14
          1 00049C  1E0D                                 ADV,R1   13
          1 00049D  D916                                 CMR,R5   ,B6,R1
          1 00049E  0301 0007                            BG       s:21846,PREL

      452    21844    4                    THEN CODE = %E$MAXFPRGS;

  21844   1 0004A0  E870 02A0                            LDR,R6   672,IMO
          1 0004A2  EF47 0017                            STR,R6   CODE,AUTO
          1 0004A4  0F81 002A                            B        s:21855,PREL

      453    21845
      454    21846    4                    ELSE IF GFR$ACCT.CUR_MEM(GFR@INDX)+GFR@PGSZ

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:67   
  21846   1 0004A6  B847 0019                            LDR,R3   GFR@INDX,AUTO
          1 0004A8  3F0E                                 MLV,R3   14
          1 0004A9  3E0B                                 ADV,R3   11
          1 0004AA  E836                                 LDR,R6   ,B6,R3
          1 0004AB  EA47 001A                            ADD,R6   GFR@PGSZ,AUTO
          1 0004AD  B847 0019                            LDR,R3   GFR@INDX,AUTO
          1 0004AF  3F0E                                 MLV,R3   14
          1 0004B0  3E0A                                 ADV,R3   10
          1 0004B1  E936                                 CMR,R6   ,B6,R3
          1 0004B2  0381 0007                            BLE      s:21850,PREL

      455    21847    4                         > GFR$ACCT.MAX_MEM(GFR@INDX)
      456    21848    4                       THEN CODE = %E$ACCT_MEMLIMIT;

  21848   1 0004B4  E870 04D3                            LDR,R6   1235,IMO
          1 0004B6  EF47 0017                            STR,R6   CODE,AUTO
          1 0004B8  0F81 0016                            B        s:21855,PREL

      457    21849    5                       ELSE DO;

      458    21850    5                          GFR$ACCT.CUR_FPRGS(GFR@INDX) = GFR$ACCT.CUR_FPRGS(GFR@INDX)+
             21850                                   1;

  21850   1 0004BA  8A96                                 INC      ,B6,R1

      459    21851    5                          GFR$ACCT.CUR_MEM(GFR@INDX) =  GFR$ACCT.CUR_MEM(GFR@INDX)+
             21851                                   GFR@PGSZ;

  21851   1 0004BB  B847 0019                            LDR,R3   GFR@INDX,AUTO
          1 0004BD  3F0E                                 MLV,R3   14
          1 0004BE  3E0B                                 ADV,R3   11
          1 0004BF  E836                                 LDR,R6   ,B6,R3
          1 0004C0  EA47 001A                            ADD,R6   GFR@PGSZ,AUTO
          1 0004C2  EF36                                 STR,R6   ,B6,R3

      460    21852    5                          GFR_CUR_MEM(MODE) = GFR_CUR_MEM(MODE) + GFR@PGSZ;

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:68   
  21852   1 0004C3  B847 001B                            LDR,R3   MODE,AUTO
          1 0004C5  E830 0000 0000  xsym                 LDR,R6   GFR_CUR_MEM,R3
          1 0004C8  EA47 001A                            ADD,R6   GFR@PGSZ,AUTO
          1 0004CA  EF30 0000 0000  xsym                 STR,R6   GFR_CUR_MEM,R3

      461    21853    5                          GOTO GFR_END;    /*unlock and continue*/

  21853   1 0004CD  0F81 0044                            B        s:21884,PREL

      462    21854    5                          END;
      463    21855    4                    GFR@INDX = 0;

  21855   1 0004CF  8747 0019                            CL       GFR@INDX,AUTO

      464    21856    4                    GOTO GFR_END;          /* unlock and report error*/

  21856   1 0004D1  0F81 0040                            B        s:21884,PREL

      465    21857    4                    END;
      466    21858    3                 END/*do 0 to GFR_ACCT#*/;

  21858   1 0004D3  8AC7 0019                            INC      GFR@INDX,AUTO
          1 0004D5  EC80 0000 0000  xsym                 LDB,B6   G$BOBCAT$
          1 0004D8  E847 0019                            LDR,R6   GFR@INDX,AUTO
          1 0004DA  E946 000E                            CMR,R6   14,B6
          1 0004DC  0381 FF93                            BLE      s:21835,PREL

      467    21859
      468    21860        /*E* ERROR: GUS-E$MAXFPRGS-E
      469    21861             MESSAGE: Maximum number of FPRGs for your account has been exceeded.
      470    21862        */
      471    21863        /*E* ERROR: GUS-E$ACCT_MEMLIMIT-E
      472    21864             MESSAGE: Maximum memory for your LCP-6 account has been exceeded.
      473    21865        */
      474    21866
      475    21867        /*E* ERROR: GUS-E$MODE_MEMLIMIT-E
      476    21868             MESSAGE: Maximum memory for your LCP-6 mode has been exceeded.
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:69   
      477    21869        */
      478    21870
      479    21871        /* If this UNAME/ACCT not already in the acct resource table, get
      480    21872           a table entry for it now.
      481    21873        */
      482    21874    3              DO GFR@INDX=1 TO G$BOBCAT.ACCT_RES#;

  21874   1 0004DE  6C01                                 LDV,R6   1
          1 0004DF  EF47 0019                            STR,R6   GFR@INDX,AUTO
          1 0004E1  0F81 0022                            B        s:21881+2,PREL

      483    21875    3                 IF GFR$ACCT.CUR_FPRGS(GFR@INDX) = 0

  21875   1 0004E3  ECC7 0011                            LDB,B6   D$,AUTO
          1 0004E5  B847 0019                            LDR,R3   GFR@INDX,AUTO
          1 0004E7  3F0E                                 MLV,R3   14
          1 0004E8  3E0D                                 ADV,R3   13
          1 0004E9  E836                                 LDR,R6   ,B6,R3
          1 0004EA  6981 0017                            BNEZ,R6  s:21881,PREL

      484    21876    4                 THEN DO;

      485    21877    4                    GFR$ACCT.UNAME(GFR@INDX) = KL_STRTU.UNAME;

  21877   1 0004EC  ACC7 000F                            LDB,B2   P1$,AUTO
          1 0004EE  2C0A                                 LDV,R2   10
          1 0004EF  6C0C                                 LDV,R6   12
          1 0004F0  BB86                                 LAB,B3   ,B6
          1 0004F1  B847 0019                            LDR,R3   GFR@INDX,AUTO
          1 0004F3  3F1C                                 MLV,R3   28
          1 0004F4  0008                                 MMM

      486    21878    4                    GFR$ACCT.ACCN(GFR@INDX) = KL_STRTU.ACCT;

  21878   1 0004F5  ACC7 000F                            LDB,B2   P1$,AUTO
          1 0004F7  2C16                                 LDV,R2   22
          1 0004F8  6C08                                 LDV,R6   8
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:70   
          1 0004F9  BCC7 0011                            LDB,B3   D$,AUTO
          1 0004FB  B847 0019                            LDR,R3   GFR@INDX,AUTO
          1 0004FD  3F1C                                 MLV,R3   28
          1 0004FE  3E0C                                 ADV,R3   12
          1 0004FF  0008                                 MMM

      487    21879    4                    GOTO SET_ACCRES;

  21879   1 000500  0F81 FF84                            B        s:21837,PREL

      488    21880    4                    END;
      489    21881    3                 END/*do 0 to GFR_ACCT#*/;

  21881   1 000502  8AC7 0019                            INC      GFR@INDX,AUTO
          1 000504  EC80 0000 0000  xsym                 LDB,B6   G$BOBCAT$
          1 000507  E847 0019                            LDR,R6   GFR@INDX,AUTO
          1 000509  E946 000E                            CMR,R6   14,B6
          1 00050B  03D8                                 BLE      s:21875,SPREL

      490    21882
      491    21883    2              GFR@INDX = 0;

  21883   1 00050C  8747 0019                            CL       GFR@INDX,AUTO

      492    21884    2              CODE = %E$MAXACCT;

  21884   1 00050E  E870 029F                            LDR,R6   671,IMO
          1 000510  EF47 0017                            STR,R6   CODE,AUTO

  21884   1                              GFR_END         null
      493    21885        /*E* ERROR: GUS-E$MAXACCT-E
      494    21886             MESSAGE: Can't start your FPRG; no entry available in account resource table.
      495    21887        */
      496    21888
      497    21889    2   GFR_END:   ;
      498    21890                   %UNLOCK (G=GFR_RES_LOCK);

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:71   
  21895   1 000512  BB80 0000 0004  02   GFR_END         LAB,B3   +4
          1 000515  CBF0 0100                            LAB,B4   256,IMO
          1 000517  E380 0000 0000  xent                 LNJ,B6   GHH$UNLOCK
          1 00051A       0001                            DC       s:21897,PREL

      499    21897    2              IF CODE ~= 0 THEN GOTO GFR_ERR;

  21897   1 00051B  E847 0017                            LDR,R6   CODE,AUTO
          1 00051D  6981 0021                            BNEZ,R6  s:21903,PREL

      500    21898    2              END/*do if GFR_ACCT#*/;

      501    21899
      502    21900
      503    21901    1           CALL GHS$ADDUSR (I,MODE,USER#,ROSPP,CODE);

  21901   1 00051F  EBC7 0017                            LAB,B6   CODE,AUTO
          1 000521  EFC7 0026                            STB,B6   MODE+11,AUTO
          1 000523  DBC7 0016                            LAB,B5   ROSPP,AUTO
          1 000525  DFC7 0024                            STB,B5   MODE+9,AUTO
          1 000527  CBC7 0015                            LAB,B4   USER#,AUTO
          1 000529  CFC7 0022                            STB,B4   MODE+7,AUTO
          1 00052B  BBC7 001B                            LAB,B3   MODE,AUTO
          1 00052D  BFC7 0020                            STB,B3   MODE+5,AUTO
          1 00052F  ABC7 000B                            LAB,B2   I,AUTO
          1 000531  AFC7 001E                            STB,B2   MODE+3,AUTO
          1 000533  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 000535  CBF0 0500                            LAB,B4   1280,IMO
          1 000537  E380 0000 0000  xent                 LNJ,B6   GHS$ADDUSR
          1 00053A       0001                            DC       s:21902,PREL

      504    21902    1           IF CODE ~= 0 THEN

  21902   1 00053B  E847 0017                            LDR,R6   CODE,AUTO
          1 00053D  6901 0040                            BEZ,R6   s:21930,PREL

      505    21903    2           DO;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:72   

  21889   1                              GFR_ERR         null
      506    21904    2   GFR_ERR:   ;
      507    21905    2              IF GFR@INDX ~= 0

  21905   1 00053F  E847 0019            GFR_ERR         LDR,R6   GFR@INDX,AUTO
          1 000541  6901 002C                            BEZ,R6   s:21925,PREL

      508    21906    3              THEN DO;

      509    21907                      %LOCK (G=GFR_RES_LOCK);

  21912   1 000543  BB80 0000 0004  02                   LAB,B3   +4
          1 000546  CBF0 0100                            LAB,B4   256,IMO
          1 000548  E380 0000 0000  xent                 LNJ,B6   GHH$LOCK
          1 00054B       0001                            DC       s:21914,PREL

      510    21914    3                 GFR$ACCT.CUR_FPRGS(GFR@INDX) = GFR$ACCT.CUR_FPRGS(GFR@INDX)-1;

  21914   1 00054C  ECC7 0011                            LDB,B6   D$,AUTO
          1 00054E  B847 0019                            LDR,R3   GFR@INDX,AUTO
          1 000550  3F0E                                 MLV,R3   14
          1 000551  3E0D                                 ADV,R3   13
          1 000552  88B6                                 DEC      ,B6,R3

      511    21915    3                 GFR$ACCT.CUR_MEM(GFR@INDX) =  GFR$ACCT.CUR_MEM(GFR@INDX)-GFR@PGSZ;

  21915   1 000553  A847 0019                            LDR,R2   GFR@INDX,AUTO
          1 000555  2F0E                                 MLV,R2   14
          1 000556  2E0B                                 ADV,R2   11
          1 000557  E826                                 LDR,R6   ,B6,R2
          1 000558  E247 001A                            SUB,R6   GFR@PGSZ,AUTO
          1 00055A  EF26                                 STR,R6   ,B6,R2

      512    21916    3                 GFR_CUR_MEM(MODE) = GFR_CUR_MEM(MODE) - GFR@PGSZ;

  21916   1 00055B  9847 001B                            LDR,R1   MODE,AUTO
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:73   
          1 00055D  D810 0000 0000  xsym                 LDR,R5   GFR_CUR_MEM,R1
          1 000560  D247 001A                            SUB,R5   GFR@PGSZ,AUTO
          1 000562  DF10 0000 0000  xsym                 STR,R5   GFR_CUR_MEM,R1

      513    21917                      %UNLOCK (G=GFR_RES_LOCK);

  21922   1 000565  BB80 0000 0004  02                   LAB,B3   +4
          1 000568  CBF0 0100                            LAB,B4   256,IMO
          1 00056A  E380 0000 0000  xent                 LNJ,B6   GHH$UNLOCK
          1 00056D       0001                            DC       s:21925,PREL

      514    21924    3                 END;

      515    21925    2              PARM.ERR=NOTAUTH;

  21925   1 00056E  8C80 0000 0000  00                   LDI      NOTAUTH
          1 000571  ECC7 0004                            LDB,B6   @PARM,AUTO
          1 000573  8D46 0003                            SDI      3,B6

      516    21926    2              PARM.ERR.ERR#=CODE;    /* Pass error on back  */

  21926   1 000575  D847 0017                            LDR,R5   CODE,AUTO
          1 000577  5003                                 SOL,R5   3
          1 000578  DAC6 0004                            SRM,R5,'FFF8'X    4,B6
          1 00057A       FFF8

      517    21927    2              RETURN;

  21927   1 00057B  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      518    21928    2              END;
      519    21929
      520    21930    1           G$UHJIT.ASDT_MCL.WINDOW1.BASE=ROSPP;

  21930   1 00057E  D847 0016                            LDR,R5   ROSPP,AUTO
          1 000580  EC80 0000 0000  xsym                 LDB,B6   G$UHJIT$
          1 000583  DAC6 006E                            SRM,R5,'7FFF'X    110,B6
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:74   
          1 000585       7FFF

      521    21931    1           G$UHJIT.ASDT_MCL.WINDOW1.SIZE=(SIZEW(G$ROS)-1)/256;

  21931   1 000586  4C02                                 LDV,R4   2
          1 000587  CAC6 006F                            SRM,R4,'01FF'X    111,B6
          1 000589       01FF

      522    21932    1           CALL GHH$ASD (G$WINDOW1$,G$UHJIT.ASDT_MCL.WINDOW1);

  21932   1 00058A  DBC6 006E                            LAB,B5   110,B6
          1 00058C  DFC7 0020                            STB,B5   MODE+5,AUTO
          1 00058E  CB80 0000 0000  xsym                 LAB,B4   G$WINDOW1$
          1 000591  CFC7 001E                            STB,B4   MODE+3,AUTO
          1 000593  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 000595  CBF0 0200                            LAB,B4   512,IMO
          1 000597  E380 0000 0000  xent                 LNJ,B6   GHH$ASD
          1 00059A       0001                            DC       s:21933,PREL

      523    21933    1           D$=ADDR(G$WINDOW1$->G$ROS.JIT);

  21933   1 00059B  EC80 0000 0000  xsym                 LDB,B6   G$WINDOW1$
          1 00059E  DBC6 003A                            LAB,B5   58,B6
          1 0005A0  DFC7 0011                            STB,B5   D$,AUTO

      524    21934
      525    21935    1           CALL GHI$UTS(JIT.JSTART);

  21935   1 0005A2  CBC5 0068                            LAB,B4   104,B5
          1 0005A4  CFC7 001E                            STB,B4   MODE+3,AUTO
          1 0005A6  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 0005A8  CBF0 0100                            LAB,B4   256,IMO
          1 0005AA  E380 0000 0000  xent                 LNJ,B6   GHI$UTS
          1 0005AD       0001                            DC       s:21936,PREL

      526    21936    1           JIT.JSTART = JIT.JSTART + G$MHJIT.BOOTUTS;

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:75   
  21936   1 0005AE  EC80 0000 0000  xsym                 LDB,B6   G$MHJIT$
          1 0005B1  DCC7 0011                            LDB,B5   D$,AUTO
          1 0005B3  8CC5 0068                            LDI      104,B5
          1 0005B5  8446 035A                            AID      858,B6
          1 0005B7  8D45 0068                            SDI      104,B5

      527    21937    1           JIT.ACCN=KL_STRTU.ACCT;

  21937   1 0005B9  ACC7 000F                            LDB,B2   P1$,AUTO
          1 0005BB  2C16                                 LDV,R2   22
          1 0005BC  6C08                                 LDV,R6   8
          1 0005BD  BB85                                 LAB,B3   ,B5
          1 0005BE  3C0C                                 LDV,R3   12
          1 0005BF  0008                                 MMM

      528    21938    1           JIT.UNAME=KL_STRTU.UNAME;

  21938   1 0005C0  ACC7 000F                            LDB,B2   P1$,AUTO
          1 0005C2  2C0A                                 LDV,R2   10
          1 0005C3  6C0C                                 LDV,R6   12
          1 0005C4  BCC7 0011                            LDB,B3   D$,AUTO
          1 0005C6  3C14                                 LDV,R3   20
          1 0005C7  0008                                 MMM

      529    21939    1           JIT.MRT=KL_STRTU.MRT;

  21939   1 0005C8  ECC7 000F                            LDB,B6   P1$,AUTO
          1 0005CA  8CC6 0014                            LDI      20,B6
          1 0005CC  CCC7 0011                            LDB,B4   D$,AUTO
          1 0005CE  8D44 0070                            SDI      112,B4

      530    21940    1           JIT.PRIV.AUTH=KL_STRTU.PRIV;

  21940   1 0005D0  8CC6 0016                            LDI      22,B6
          1 0005D2  8D44 0090                            SDI      144,B4

      531    21941    1           JIT.PPRIV=KL_STRTU.PPRIV;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:76   

  21941   1 0005D4  8CC6 0018                            LDI      24,B6
          1 0005D6  8D44 0094                            SDI      148,B4

      532    21942    1           JIT.BILL=KL_STRTU.BILL;

  21942   1 0005D8  ABC6 0045                            LAB,B2   69,B6
          1 0005DA  2C00                                 LDV,R2   0
          1 0005DB  6C06                                 LDV,R6   6
          1 0005DC  BBC4 0057                            LAB,B3   87,B4
          1 0005DE  3C00                                 LDV,R3   0
          1 0005DF  0008                                 MMM

      533    21943    1           JIT.MAXLVLS=KL_STRTU.INTS;

  21943   1 0005E0  ECC7 000F                            LDB,B6   P1$,AUTO
          1 0005E2  E2C6 001B                            LLH,R6   27,B6
          1 0005E4  CCC7 0011                            LDB,B4   D$,AUTO
          1 0005E6  E7C4 009E                            STH,R6   158,B4

      534    21944    1           JIT.MAXMEM=KL_STRTU.MEM;

  21944   1 0005E8  E846 001A                            LDR,R6   26,B6
          1 0005EA  EF44 0089                            STR,R6   137,B4

      535    21945    1           IF JIT.MAXMEM > 4096 THEN JIT.MAXMEM = 4096;

  21945   1 0005EC  E970 1000                            CMR,R6   4096,IMO
          1 0005EE  0381 0005                            BLE      s:21946,PREL

  21945   1 0005F0  E870 1000                            LDR,R6   4096,IMO
          1 0005F2  EF44 0089                            STR,R6   137,B4

      536    21946    1           JIT.MODE=KL_STRTU.MODE;

  21946   1 0005F4  D2C6 0013                            LLH,R5   19,B6
          1 0005F6  D7C4 0004                            STH,R5   4,B4
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:77   

      537    21947    1           JIT.LANG = KL_STRTU.LANG;

  21947   1 0005F8  D0C6 0058                            LDH,R5   88,B6
          1 0005FA  DAC4 0099                            SRM,R5,'00FF'X    153,B4
          1 0005FC       00FF

      538    21948    1           JIT.JUNK.STEPACCT = KL_STRTU.FLAGS.STEPACCT;

  21948   1 0005FD  D846 0058                            LDR,R5   88,B6
          1 0005FF  5006                                 SOL,R5   6
          1 000600  DAC4 0098                            SRM,R5,'2000'X    152,B4
          1 000602       2000

      539    21949    1           JIT.PROG_ENTRY = %G_PE_HOST#;

  21949   1 000603  5C01                                 LDV,R5   1
          1 000604  DAC4 0003                            SRM,R5,'00FF'X    3,B4
          1 000606       00FF

      540    21950    1           JIT.DB_ACCN=KL_STRTU.DB_ACCT;

  21950   1 000607  AB86                                 LAB,B2   ,B6
          1 000608  2C1E                                 LDV,R2   30
          1 000609  6C08                                 LDV,R6   8
          1 00060A  BBC4 009A                            LAB,B3   154,B4
          1 00060C  3C00                                 LDV,R3   0
          1 00060D  0008                                 MMM

      541    21951    1           JIT.GFR_ACCT=GFR@INDX;

  21951   1 00060E  E847 0019                            LDR,R6   GFR@INDX,AUTO
          1 000610  CCC7 0011                            LDB,B4   D$,AUTO
          1 000612  E7C4 00A7                            STH,R6   167,B4

      542    21952    1           JIT.PCC = GFR@PGSZ;

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:78   
  21952   1 000614  C847 001A                            LDR,R4   GFR@PGSZ,AUTO
          1 000616  CF44 0085                            STR,R4   133,B4

      543    21953    1           JIT.ACCTLOG.FCN = %IGA_SYSLOG;

  21953   1 000618  3C27                                 LDV,R3   39
          1 000619  B784                                 STH,R3   ,B4

      544    21954    1           JIT.ACCTLOG.FILENUM = 2;

  21954   1 00061A  2C02                                 LDV,R2   2
          1 00061B  AAC4 0001                            SRM,R2,'00FF'X    1,B4
          1 00061D       00FF

      545    21955    1           JIT.CODE = %AZ$LCP6;

  21955   1 00061E  1C07                                 LDV,R1   7
          1 00061F  97C4 0002                            STH,R1   2,B4

      546    21956    1           G$WINDOW1$->ROS.M$LM.RLCID = KL_STRTU.NETADR_FROM;

  21956   1 000621  BCC7 000F                            LDB,B3   P1$,AUTO
          1 000623  8CC3 0001                            LDI      1,B3
          1 000625  9C80 0000 0000  xsym                 LDB,B1   G$WINDOW1$
          1 000628  8D41 0226                            SDI      550,B1

      547    21957    1           G$WINDOW1$->ROS.M$HOST.RLCID = KL_STRTU.NETADR_FROM;

  21957   1 00062A  8CC3 0001                            LDI      1,B3
          1 00062C  8D41 0299                            SDI      665,B1

      548    21958    1           G$WINDOW1$->ROS.M$ME.RLCID = KL_STRTU.NETADR_TO;

  21958   1 00062E  8CC3 0003                            LDI      3,B3
          1 000630  8D41 0264                            SDI      612,B1

      549    21959    1           G$WINDOW1$->ROS.M$ME.STRM = KL_STRTU.STR;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:79   

  21959   1 000632  E843 0013                            LDR,R6   19,B3
          1 000634  EAC1 0239                            SRM,R6,'00FF'X    569,B1
          1 000636       00FF

      550    21960
      551    21961    2           DO I=0 TO 7;

  21961   1 000637  8747 000B                            CL       I,AUTO

      552    21962    3              DO J=0 TO 7;

  21962   1 000639  8747 000A                            CL       J,AUTO

      553    21963    3                 IF KL_STRTU.PSEUDO_NAME(I) = GFR_PSUDO_NM(J)

  21963   1 00063B  ECC7 000F                            LDB,B6   P1$,AUTO
          1 00063D  B847 000B                            LDR,R3   I,AUTO
          1 00063F  3003                                 SOL,R3   3
          1 000640  DB80 0000 0000  xsym                 LAB,B5   GFR_PSUDO_NM
          1 000643  A847 000A                            LDR,R2   J,AUTO
          1 000645  2003                                 SOL,R2   3
          1 000646  0022                                 ACM      ;
          1 000647       4836 001D                                ALPHANUM(29,B6,R3,,8,FILL),;
          1 000649       4825 0000                                ALPHANUM(0,B5,R2,,8,FILL)
          1 00064B  5301 000E                            CBNE     s:21968,PREL

      554    21964    4                 THEN DO;

      555    21965    4                    JIT.MAXSUDO(J) = KL_STRTU.PSEUDO_MAX(I);

  21965   1 00064D  9847 000B                            LDR,R1   I,AUTO
          1 00064F  1E3D                                 ADV,R1   61
          1 000650  E816                                 LDR,R6   ,B6,R1
          1 000651  DCC7 0011                            LDB,B5   D$,AUTO
          1 000653  CBC5 009F                            LAB,B4   159,B5
          1 000655  B847 000A                            LDR,R3   J,AUTO
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:80   
          1 000657  E7B4                                 STH,R6   ,B4,R3

      556    21966    4                    GOTO PSUDO_OK;

  21966   1 000658  0F81 000D                            B        s:21972,PREL

      557    21967    4                    END;
      558    21968    3                 END;

  21968   1 00065A  8AC7 000A                            INC      J,AUTO
          1 00065C  E847 000A                            LDR,R6   J,AUTO
          1 00065E  6D07                                 CMV,R6   7
          1 00065F  03DC                                 BLE      s:21963,SPREL

      559    21969        /* :HLP record for this user specifies a pseudo that doesn't exits
      560    21970           on this fep.
      561    21971        */
      562    21972    2              CODE = %E$BSUNM;

  21972   1 000660  D870 0296                            LDR,R5   662,IMO
          1 000662  DF47 0017                            STR,R5   CODE,AUTO

      563    21973    2              GOTO GFR_ERR;

  21973   1 000664  0F81 FEDA                            B        s:21903,PREL

  21972   1                              PSUDO_OK        null
      564    21974
      565    21975
      566    21976    2   PSUDO_OK:  ;
      567    21977    2              END;

  21977   1 000666  8AC7 000B            PSUDO_OK        INC      I,AUTO
          1 000668  E847 000B                            LDR,R6   I,AUTO
          1 00066A  6D07                                 CMV,R6   7
          1 00066B  03CE                                 BLE      s:21962,SPREL

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:81   
      568    21978
      569    21979
      570    21980
      571    21981    1           RETURN;

  21981   1 00066C  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      572    21982        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:82   
      573    21983        /*F*
      574    21984              NAME:  GUS$DELU
      575    21985              PURPOSE:  To complete elimination of a user.
      576    21986        */
      577    21987        /*D*
      578    21988              NAME:  GUS$DELU
      579    21989              CALL:
      580    21990                 CALL GUS$DELU
      581    21991              PARAMETERS:
      582    21992                 None
      583    21993              DESCRIPTION:
      584    21994                 The ROSEG, TSTACKU and UHJIT segments from the users ASDT
      585    21995                 are released.
      586    21996        */
      587    21997
      588    21998    1   GUS$DELU: ENTRY;

  21998   1 00066F  D380 0000 0000  xent GUS$DELU        LNJ,B5   X6A_AUTO_1
          1 000672       0034 0001                       DC       52,1

      589    21999
      590    22000    1           I = G$UHJIT.ASDT_USR.ROS.BASE;

  22000   1 000674  EC80 0000 0000  xsym                 LDB,B6   G$UHJIT$
          1 000677  E846 0002                            LDR,R6   2,B6
          1 000679  E570 7FFF                            AND,R6   32767,IMO
          1 00067B  EF47 000B                            STR,R6   I,AUTO

      591    22001    1           G$UHJIT.ASDT_MCL.WINDOW1.BASE=I;

  22001   1 00067D  EAC6 006E                            SRM,R6,'7FFF'X    110,B6
  22001   1 00067F       7FFF

      592    22002    1           G$UHJIT.ASDT_MCL.WINDOW1.SIZE=(SIZEW(G$ROS)-1)/256;

  22002   1 000680  5C02                                 LDV,R5   2
          1 000681  DAC6 006F                            SRM,R5,'01FF'X    111,B6
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:83   
          1 000683       01FF

      593    22003    1           CALL GHH$ASD (G$WINDOW1$,G$UHJIT.ASDT_MCL.WINDOW1);

  22003   1 000684  DBC6 006E                            LAB,B5   110,B6
          1 000686  DFC7 0020                            STB,B5   MODE+5,AUTO
          1 000688  CB80 0000 0000  xsym                 LAB,B4   G$WINDOW1$
          1 00068B  CFC7 001E                            STB,B4   MODE+3,AUTO
          1 00068D  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 00068F  CBF0 0200                            LAB,B4   512,IMO
          1 000691  E380 0000 0000  xent                 LNJ,B6   GHH$ASD
          1 000694       0001                            DC       s:22004,PREL

      594    22004    1           D$=ADDR(G$WINDOW1$->G$ROS.JIT);

  22004   1 000695  EC80 0000 0000  xsym                 LDB,B6   G$WINDOW1$
          1 000698  DBC6 003A                            LAB,B5   58,B6
          1 00069A  DFC7 0011                            STB,B5   D$,AUTO

      595    22005
      596    22006    1           GFR@INDX = JIT.GFR_ACCT;

  22006   1 00069C  E2C5 00A7                            LLH,R6   167,B5
          1 00069E  EF47 0019                            STR,R6   GFR@INDX,AUTO

      597    22007    1           MODE = JIT.MODE;

  22007   1 0006A0  D2C5 0004                            LLH,R5   4,B5
          1 0006A2  DF47 001B                            STR,R5   MODE,AUTO

      598    22008    1           GFR@PGSZ = 0;

  22008   1 0006A4  8747 001A                            CL       GFR@PGSZ,AUTO

      599    22009
      600    22010    1           J = G$UHJIT.ASDT_USR.ROS.SIZE+1;

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:84   
  22010   1 0006A6  CC80 0000 0000  xsym                 LDB,B4   G$UHJIT$
          1 0006A9  C844 0003                            LDR,R4   3,B4
          1 0006AB  C570 01FF                            AND,R4   511,IMO
          1 0006AD  4E01                                 ADV,R4   1
          1 0006AE  CF47 000A                            STR,R4   J,AUTO

      601    22011    1           GFR@PGSZ = GFR@PGSZ +J;

  22011   1 0006B0  CA47 001A                            ADD,R4   GFR@PGSZ,AUTO
          1 0006B2  CF47 001A                            STR,R4   GFR@PGSZ,AUTO

      602    22012    1           CALL GMA$RELPS (I,J);

  22012   1 0006B4  BBC7 000A                            LAB,B3   J,AUTO
          1 0006B6  BFC7 0020                            STB,B3   MODE+5,AUTO
          1 0006B8  ABC7 000B                            LAB,B2   I,AUTO
          1 0006BA  AFC7 001E                            STB,B2   MODE+3,AUTO
          1 0006BC  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 0006BE  CBF0 0200                            LAB,B4   512,IMO
          1 0006C0  E380 0000 0000  xent                 LNJ,B6   GMA$RELPS
          1 0006C3       0001                            DC       s:22013,PREL

      603    22013    1           I = G$UHJIT.ASDT_USR.TSTACKU.BASE;

  22013   1 0006C4  EC80 0000 0000  xsym                 LDB,B6   G$UHJIT$
          1 0006C7  E846 0008                            LDR,R6   8,B6
          1 0006C9  E570 7FFF                            AND,R6   32767,IMO
          1 0006CB  EF47 000B                            STR,R6   I,AUTO

      604    22014    1           J = G$UHJIT.ASDT_USR.TSTACKU.SIZE+1;

  22014   1 0006CD  D846 0009                            LDR,R5   9,B6
          1 0006CF  D570 01FF                            AND,R5   511,IMO
          1 0006D1  5E01                                 ADV,R5   1
          1 0006D2  DF47 000A                            STR,R5   J,AUTO

      605    22015    1           GFR@PGSZ = GFR@PGSZ +J;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:85   

  22015   1 0006D4  DA47 001A                            ADD,R5   GFR@PGSZ,AUTO
          1 0006D6  DF47 001A                            STR,R5   GFR@PGSZ,AUTO

      606    22016    1           CALL GMA$RELPS (I,J);

  22016   1 0006D8  DBC7 000A                            LAB,B5   J,AUTO
          1 0006DA  DFC7 0020                            STB,B5   MODE+5,AUTO
          1 0006DC  CBC7 000B                            LAB,B4   I,AUTO
          1 0006DE  CFC7 001E                            STB,B4   MODE+3,AUTO
          1 0006E0  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 0006E2  CBF0 0200                            LAB,B4   512,IMO
          1 0006E4  E380 0000 0000  xent                 LNJ,B6   GMA$RELPS
          1 0006E7       0001                            DC       s:22017,PREL

      607    22017    1           I = G$UHJIT.ASDT_USR.UHJIT.BASE;

  22017   1 0006E8  EC80 0000 0000  xsym                 LDB,B6   G$UHJIT$
          1 0006EB  E846 000A                            LDR,R6   10,B6
          1 0006ED  E570 7FFF                            AND,R6   32767,IMO
          1 0006EF  EF47 000B                            STR,R6   I,AUTO

      608    22018    1           J = G$UHJIT.ASDT_USR.UHJIT.SIZE+1;

  22018   1 0006F1  D846 000B                            LDR,R5   11,B6
          1 0006F3  D570 01FF                            AND,R5   511,IMO
          1 0006F5  5E01                                 ADV,R5   1
          1 0006F6  DF47 000A                            STR,R5   J,AUTO

      609    22019    1           GFR@PGSZ = GFR@PGSZ +J;

  22019   1 0006F8  DA47 001A                            ADD,R5   GFR@PGSZ,AUTO
          1 0006FA  DF47 001A                            STR,R5   GFR@PGSZ,AUTO

      610    22020    1           CALL GMA$RELPS (I,J);

  22020   1 0006FC  DBC7 000A                            LAB,B5   J,AUTO
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:86   
          1 0006FE  DFC7 0020                            STB,B5   MODE+5,AUTO
          1 000700  CBC7 000B                            LAB,B4   I,AUTO
          1 000702  CFC7 001E                            STB,B4   MODE+3,AUTO
          1 000704  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 000706  CBF0 0200                            LAB,B4   512,IMO
          1 000708  E380 0000 0000  xent                 LNJ,B6   GMA$RELPS
          1 00070B       0001                            DC       s:22021,PREL

      611    22021    1           IF GFR@INDX ~= 0

  22021   1 00070C  E847 0019                            LDR,R6   GFR@INDX,AUTO
          1 00070E  6901 0046                            BEZ,R6   s:22047,PREL

      612    22022    2           THEN DO;

      613    22023    2              D$ = G$BOBCAT.ACCT_RES$;

  22023   1 000710  EC80 0000 0000  xsym                 LDB,B6   G$BOBCAT$
          1 000713  DCC6 0020                            LDB,B5   32,B6
          1 000715  DFC7 0011                            STB,B5   D$,AUTO

      614    22024                   %LOCK (G=GFR_RES_LOCK);

  22029   1 000717  BB80 0000 0004  02                   LAB,B3   +4
          1 00071A  CBF0 0100                            LAB,B4   256,IMO
          1 00071C  E380 0000 0000  xent                 LNJ,B6   GHH$LOCK
          1 00071F       0001                            DC       s:22031,PREL

      615    22031    2              GFR$ACCT.CUR_FPRGS(GFR@INDX) = GFR$ACCT.CUR_FPRGS(GFR@INDX)-1;

  22031   1 000720  ECC7 0011                            LDB,B6   D$,AUTO
          1 000722  B847 0019                            LDR,R3   GFR@INDX,AUTO
          1 000724  3F0E                                 MLV,R3   14
          1 000725  3E0D                                 ADV,R3   13
          1 000726  88B6                                 DEC      ,B6,R3

      616    22032    2              GFR$ACCT.CUR_MEM(GFR@INDX) =  GFR$ACCT.CUR_MEM(GFR@INDX)-GFR@PGSZ;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:87   

  22032   1 000727  A847 0019                            LDR,R2   GFR@INDX,AUTO
          1 000729  2F0E                                 MLV,R2   14
          1 00072A  2E0B                                 ADV,R2   11
          1 00072B  E826                                 LDR,R6   ,B6,R2
          1 00072C  E247 001A                            SUB,R6   GFR@PGSZ,AUTO
          1 00072E  EF26                                 STR,R6   ,B6,R2

      617    22033    2              GFR_CUR_MEM(MODE) = GFR_CUR_MEM(MODE) - GFR@PGSZ;

  22033   1 00072F  9847 001B                            LDR,R1   MODE,AUTO
          1 000731  D810 0000 0000  xsym                 LDR,R5   GFR_CUR_MEM,R1
          1 000734  D247 001A                            SUB,R5   GFR@PGSZ,AUTO
          1 000736  DF10 0000 0000  xsym                 STR,R5   GFR_CUR_MEM,R1

      618    22034    2              IF MODE = %G_M_HANDLER#

  22034   1 000739  1D03                                 CMV,R1   3
          1 00073A  0981 0011                            BNE      s:22044,PREL

      619    22035    3              THEN DO;

      620    22036    3                 GM_ASHUF = GM_ASHUF + GFR@PGSZ;

  22036   1 00073C  E800 0000 0000  xsym                 LDR,R6   GM_ASHUF
          1 00073F  EA47 001A                            ADD,R6   GFR@PGSZ,AUTO
          1 000741  EF00 0000 0000  xsym                 STR,R6   GM_ASHUF

      621    22037    3                 GM_HSHUF = GM_HSHUF - GFR@PGSZ;

  22037   1 000744  C800 0000 0000  xsym                 LDR,R4   GM_HSHUF
          1 000747  C247 001A                            SUB,R4   GFR@PGSZ,AUTO
          1 000749  CF00 0000 0000  xsym                 STR,R4   GM_HSHUF

      622    22038    3                 END;

      623    22039                   %UNLOCK (G=GFR_RES_LOCK);
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:88   

  22044   1 00074C  BB80 0000 0004  02                   LAB,B3   +4
          1 00074F  CBF0 0100                            LAB,B4   256,IMO
          1 000751  E380 0000 0000  xent                 LNJ,B6   GHH$UNLOCK
          1 000754       0001                            DC       s:22047,PREL

      624    22046    2              END;

      625    22047    1           G$MHJIT.ASDT_MON.UMHJIT = G$MHJIT.ASDT_MON.MHJIT;

  22047   1 000755  EC80 0000 0000  xsym                 LDB,B6   G$MHJIT$
          1 000758  8CC6 000C                            LDI      12,B6
          1 00075A  8D46 000A                            SDI      10,B6

      626    22048    1           RETURN;

  22048   1 00075C  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      627    22049        %EJECT;
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:89   
      628    22050    1   GUS$RUE: ENTRY(PARM);

  22050   1 00075F  D380 0000 0000  xent GUS$RUE         LNJ,B5   X6A_AUTO_1
          1 000762       0034 0001                       DC       52,1

      629    22051
      630    22052    1           P1$ = PARM.PTRS.PAR1$;

  22052   1 000764  ECC7 0004                            LDB,B6   @PARM,AUTO
          1 000766  DCC6 0006                            LDB,B5   6,B6
          1 000768  DFC7 000F                            STB,B5   P1$,AUTO

      631    22053    1           IF NOT G$JIT.PRIV.ACTIVE.MSYS

  22053   1 00076A  CC80 0000 0000  xsym                 LDB,B4   G$JIT$
          1 00076D  82C4 008F                            LB,'0008'X        143,B4
          1 00076F       0008
          1 000770  0501 0009                            BBT      s:22062,PREL

      632    22054    2           THEN DO;

      633    22055    2              PARM.ERR = NO_MSYS;

  22055   1 000772  8C80 0000 0002  00                   LDI      NO_MSYS
          1 000775  8D46 0003                            SDI      3,B6

      634    22056                  /*E* ERROR: GUS-E$NO_MSYS
      635    22057                       MESSAGE: M$RUE requires the MSYS privilege.
      636    22058                    */
      637    22059    2              RETURN;

  22059   1 000777  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      638    22060    2              END;
      639    22061
      640    22062    2           DO I = 1 TO G_MUAIS;

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:90   
  22062   1 00077A  6C01                                 LDV,R6   1
          1 00077B  EF47 000B                            STR,R6   I,AUTO
          1 00077D  0F81 002F                            B        s:22070+2,PREL

      641    22063    2              IF G$USER.SYSID(I) = FPT_RUE.USER

  22063   1 00077F  EC80 0000 0000  xsym                 LDB,B6   G$USRT$
          1 000782  B847 000B                            LDR,R3   I,AUTO
          1 000784  3F18                                 MLV,R3   24
          1 000785  3E13                                 ADV,R3   19
          1 000786  DCC7 000F                            LDB,B5   P1$,AUTO
          1 000788  E836                                 LDR,R6   ,B6,R3
          1 000789  E905                                 CMR,R6   ,B5
          1 00078A  0981 0020                            BNE      s:22070,PREL
          1 00078C  A847 000B                            LDR,R2   I,AUTO
          1 00078E  2F18                                 MLV,R2   24
          1 00078F  2E02                                 ADV,R2   2
          1 000790  D826                                 LDR,R5   ,B6,R2
          1 000791  5D1F                                 CMV,R5   31
          1 000792  0901 0018                            BE       s:22070,PREL

      642    22064    2                AND G$USER.US(I) ~= %GH_NULL
      643    22065    3              THEN DO;

      644    22066    3                 J = FPT_RUE.EVENT;

  22066   1 000794  C2C5 0001                            LLH,R4   1,B5
          1 000796  CF47 000A                            STR,R4   J,AUTO

      645    22067    3                 CALL GHS$RUE(J,I);

  22067   1 000798  CBC7 000B                            LAB,B4   I,AUTO
          1 00079A  CFC7 0020                            STB,B4   MODE+5,AUTO
          1 00079C  BBC7 000A                            LAB,B3   J,AUTO
          1 00079E  BFC7 001E                            STB,B3   MODE+3,AUTO
          1 0007A0  BBC7 001E                            LAB,B3   MODE+3,AUTO
          1 0007A2  CBF0 0200                            LAB,B4   512,IMO
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:91   
          1 0007A4  E380 0000 0000  xent                 LNJ,B6   GHS$RUE
          1 0007A7       0001                            DC       s:22068,PREL

      646    22068    3                 RETURN;

  22068   1 0007A8  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      647    22069    3                 END;
      648    22070    2              END;

  22070   1 0007AB  8AC7 000B                            INC      I,AUTO
          1 0007AD  E847 000B                            LDR,R6   I,AUTO
          1 0007AF  E900 0000 0000  xsym                 CMR,R6   G_MUAIS
          1 0007B2  03CD                                 BLE      s:22063,SPREL

      649    22071
      650    22072    1           PARM.ERR = BDID;

  22072   1 0007B3  8C80 0000 0004  00                   LDI      BDID
          1 0007B6  ECC7 0004                            LDB,B6   @PARM,AUTO
          1 0007B8  8D46 0003                            SDI      3,B6

      651    22073        /*E* ERROR: GUS-E$BDID
      652    22074             MESSAGE: The sysid specified on M$RUE does not exist.
      653    22075        */
      654    22076    1           RETURN;

  22076   1 0007BA  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
      655    22077
      656    22078    1   END;
      657    22079        %EOD;

PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:92   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   G_HJIT_M.:E05TOU  is referenced.
   AZ_SUBS_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   G_ROS_M.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   GH_GATE_M.:E05TOU  cannot be made into a system file and is referenced.
   GFR_DATA_M.:E05TOU  is referenced.
   G$BOBCAT_M.:E05TOU  is referenced.
   GU_MACROS_M.:E05TOU  is referenced.
   GH_SCHD_M.:E05TOU  is referenced.
   GH_SCHD_E.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure GUS$CLOCK.
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:93   

 **** Variables and constants ****

  ****  Section 000 RoData GUS$CLOCK

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     8-0-0/w STRC(32)    r     1 BADVECT1                   4-0-0/w STRC(32)    r     1 BDID
    16-0-0/w UBIN(16)    r     1 C(0:2)                    10-0-0/w SBIN(32)    r     1 D(0:2)
     A-0-0/w SBIN(32)    r     1 MAX(0:2)                   0-0-0/w STRC(32)    r     1 NOTAUTH
     2-0-0/w STRC(32)    r     1 NO_MSYS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @PARM                      C-0-0/w SBIN(32)    r     1 A
    17-0-0/w UBIN(16)    r     1 CODE                      13-0-0/w PTR         r     1 CU$
    11-0-0/w PTR         r     1 D$                        18-0-0/w UBIN(16)    r     1 DMN
    19-0-0/w UBIN(16)    r     1 GFR@INDX                  1A-0-0/w UBIN(16)    r     1 GFR@PGSZ
     B-0-0/w UBIN(16)    r     1 I                          A-0-0/w UBIN(16)    r     1 J
    1B-0-0/w UBIN(16)    r     1 MODE                       F-0-0/w PTR         r     1 P1$
    *0-0-0/w STRC(1280)  r     1 PARM                      16-0-0/w UBIN(16)    r     1 ROSPP
     E-0-0/w SBIN(16)    r     1 S                          6-0-0/w UBIN(32)    r     1 T
     8-0-0/w UBIN(32)    r     1 U                         15-0-0/w UBIN(16)    r     1 USER#

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 G$BOBCAT$                  0-0-0/w PTR         r     1 G$JIT$
     0-0-0/w PTR         r     1 G$MHJIT$                   0-0-0/w PTR         r     1 G$ROS$
     0-0-0/w PTR         r     1 G$UHJIT$                   0-0-0/w PTR         r     1 G$USRT$
     0-0-0/w PTR         r     1 G$WINDOW1$
     0-0-0/w UBIN(16)    r     1 GFR_CUR_MEM(0:4)
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:94   
     0-0-0/w UBIN(16)    r     1 GFR_MAX_MEM(0:4)
     0-0-0/c CHAR(8)     r     1 GFR_PSUDO_NM(0:7)
     0-0-0/w STRC(48)    r     1 GFR_RES_LOCK               0-0-0/w UBIN(16)    r     1 GH_CLOCKHD
     0-0-0/w UBIN(16)    r     1 GM_ASHUF                   0-0-0/w UBIN(16)    r     1 GM_HSHUF
     0-0-0/w UBIN(16)    r     1 GM_INIT_PGSZ               0-0-0/w STRC(48)    r     1 G_CLKGATE
     0-0-0/w UBIN(16)    r     1 G_MUAIS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(16)    r     1 FPT_CLOCKV                 0-0-0/d STRC(32)    r     1 FPT_RUE
     0-0-0/w STRC(16)    r     1 FPT_WAITV                  0-0-0/w STRC(1696)  r     1 G$BOBCAT
     0-0-0/w STRC(256)   r     1 G$DO                       0-0-0/w STRC(5616)  r     1 G$JIT
     0-0-0/w STRC(27232) r     1 G$MHJIT                    0-0-0/w STRC(12000) r     1 G$ROS
     0-0-0/w STRC(384)   r     1 G$U                        0-0-0/w STRC(6480)  r     1 G$UHJIT
     0-0-0/w STRC(384)   r     1 G$USER(0:0)
     0-0-0/w STRC(224)   r     1 GFR$ACCT(0:0)
     0-0-0/w UBIN(16)    r     1 INTERVAL                   0-0-0/w STRC(5616)  r     1 JIT
     0-0-0/w STRC(1440)  r     1 KL_STRTU                   0-0-0/w STRC(12000) r     1 ROS
     0-0-0/w UBIN(32)    r     1 UTSVALUE


   Procedure GUS$CLOCK requires 1981 words for executable code.
   Procedure GUS$CLOCK requires 52 words of local(AUTO) storage.
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:95   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:96   
          MINI XREF LISTING

A
     21446**DCL     21528<<ASSIGN  21530<<ASSIGN  21530>>ASSIGN  21531<<ASSIGN  21531>>ASSIGN  21544<<ASSIGN
     21544>>ASSIGN  21546>>ASSIGN  21557>>ASSIGN  21561>>ASSIGN  21566>>ASSIGN  21591<<ASSIGN  21592>>IF
     21593<<ASSIGN  21594>>ASSIGN
BADVECT1
     21394**DCL     21576>>ASSIGN
BDID
     21300**DCL     22072>>ASSIGN
C
     21450**DCL     21531>>ASSIGN  21586>>ASSIGN  21594>>ASSIGN
CANCEL
     21628**PROC    21543--CALL    21601--CALL    21667--CALL
CNCL1 IN PROCEDURE CANCEL
     21642**LABEL   21637--GOTO
CNCL2 IN PROCEDURE CANCEL
     21646**LABEL   21641--GOTO
CODE
     21456**DCL     21819<<ASSIGN  21830<<ASSIGN  21844<<ASSIGN  21848<<ASSIGN  21884<<ASSIGN  21897>>IF
     21901<>CALL    21902>>IF      21926>>ASSIGN  21972<<ASSIGN
CU$
     21453**DCL     17907--IMP-PTR 21517<<ASSIGN  21519>>IF      21542>>IF      21546>>ASSIGN  21582>>IF
     21585>>ASSIGN  21600>>IF      21616>>IF      21621>>ASSIGN  21687<<ASSIGN  21689>>ASSIGN  21756<<ASSIGN
     21757>>ASSIGN  21772>>IF      21775>>ASSIGN
D
     21449**DCL     21544>>ASSIGN
D$
     21452**DCL     20382--IMP-PTR 20863--IMP-PTR 21757<<ASSIGN  21758>>DOWHILE 21759>>IF      21760<<ASSIGN
     21760>>ASSIGN  21820<<ASSIGN  21835>>IF      21835>>IF      21839>>ASSIGN  21840>>ASSIGN  21843>>IF
     21843>>IF      21846>>IF      21846>>IF      21850>>ASSIGN  21850>>ASSIGN  21851>>ASSIGN  21851>>ASSIGN
     21875>>IF      21877>>ASSIGN  21878>>ASSIGN  21914>>ASSIGN  21914>>ASSIGN  21915>>ASSIGN  21915>>ASSIGN
     21933<<ASSIGN  21935>>CALL    21936>>ASSIGN  21936>>ASSIGN  21937>>ASSIGN  21938>>ASSIGN  21939>>ASSIGN
     21940>>ASSIGN  21941>>ASSIGN  21942>>ASSIGN  21943>>ASSIGN  21944>>ASSIGN  21945>>IF      21945>>ASSIGN
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:97   
     21946>>ASSIGN  21947>>ASSIGN  21948>>ASSIGN  21949>>ASSIGN  21950>>ASSIGN  21951>>ASSIGN  21952>>ASSIGN
     21953>>ASSIGN  21954>>ASSIGN  21955>>ASSIGN  21965>>ASSIGN  22004<<ASSIGN  22006>>ASSIGN  22007>>ASSIGN
     22023<<ASSIGN  22031>>ASSIGN  22031>>ASSIGN  22032>>ASSIGN  22032>>ASSIGN
DMN
     21457**DCL     21520<<ASSIGN  21523<<ASSIGN  21525<<ASSIGN  21561>>ASSIGN  21562>>IF      21563>>ASSIGN
     21591>>ASSIGN  21603>>ASSIGN
FPT_CLOCKV.CANCEL
     20891**DCL     21597>>IF
FPT_CLOCKV.CLOCK
     20890**DCL     21533>>DOCASE  21571>>DOCASE  21598>>DOCASE
FPT_CLOCKV.LEVEL
     20892**DCL     21555>>ASSIGN  21564>>ASSIGN
FPT_CLOCKV.MODE
     20890**DCL     21526>>DOCASE
FPT_CLOCKV.PERM
     20891**DCL     21556>>IF      21565>>IF
FPT_CLOCKV.UTYPE
     20890**DCL     21529>>ASSIGN  21531>>ASSIGN  21544>>ASSIGN  21586>>ASSIGN  21594>>ASSIGN
FPT_RUE.EVENT
     20938**DCL     22066>>ASSIGN
FPT_RUE.USER
     20938**DCL     22063>>IF
FPT_WAITV.MODE
     20915**DCL     21746>>DOCASE
FPT_WAITV.UTYPE
     20915**DCL     21730>>DOCASE
G$BOBCAT.ACCT_RES#
     20846**DCL     21817>>IF      21834>>DOINDEX 21874>>DOINDEX
G$BOBCAT.ACCT_RES$
     20849**DCL     21820>>ASSIGN  22023>>ASSIGN
G$BOBCAT$
     21468**DCL     20845--IMP-PTR 21817>>IF      21820>>ASSIGN  21834>>DOINDEX 21874>>DOINDEX 22023>>ASSIGN
G$DO.BUSY
     17922**DCL     21759>>IF
G$DO.LNK$
     17918**DCL     21760>>ASSIGN
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:98   
G$ECCB.FLTFLG
     18970**DCL     19001--REDEF
G$HHJIT.ISA_HND
     14210**DCL     14505--REDEF
G$HHJIT.ISA_HND.P$$
     14285**DCL     14285--REDEF
G$HHJIT.TSA_HND.ISA.P$$
     14694**DCL     14694--REDEF
G$HHJIT.TSA_HND.P$$
     14565**DCL     14565--REDEF   14566--REDEF
G$JIT.CLUKRINT
     20139**DCL     21557<<ASSIGN  21559<<ASSIGN  21689>>ASSIGN
G$JIT.CLUKRLVL
     20138**DCL     21555<<ASSIGN
G$JIT.CLUKXINT
     20139**DCL     21566<<ASSIGN  21568<<ASSIGN
G$JIT.CLUKXLVL
     20138**DCL     21564<<ASSIGN
G$JIT.ERRLOG
     20298**DCL     20301--REDEF
G$JIT.IDELTAT
     20137**DCL     21562>>IF      21563<<ASSIGN
G$JIT.JSUNIT
     20037**DCL     20038--REDEF
G$JIT.MCLS
     20036**DCL     20036--REDEF
G$JIT.PRIV.ACTIVE.MSYS
     20177**DCL     22053>>IF
G$JIT.STIME
     20136**DCL     21561>>ASSIGN  21591>>ASSIGN
G$JIT.TIMERS
     20306**DCL     21561<<ASSIGN  21562>>IF      21563>>ASSIGN  21591>>ASSIGN  21603<<ASSIGN
G$JIT.TMRZ
     20305**DCL     20306--REDEF
G$JIT.USER_EXTIME
     20029**DCL     20030--REDEF
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:99   
G$JIT.USER_MEMTIME
     20032**DCL     20032--REDEF
G$JIT.USER_SVTIME
     20031**DCL     20031--REDEF
G$JIT.USR#
     20026**DCL     21748>>ASSIGN  21799>>IF
G$JIT.XTIME
     20136**DCL     21561>>ASSIGN  21591>>ASSIGN
G$JIT$
     21462**DCL     19968--IMP-PTR 21555>>ASSIGN  21557>>ASSIGN  21559>>ASSIGN  21561>>ASSIGN  21561>>ASSIGN
     21561>>ASSIGN  21562>>IF      21562>>IF      21563>>ASSIGN  21563>>ASSIGN  21564>>ASSIGN  21566>>ASSIGN
     21568>>ASSIGN  21591>>ASSIGN  21591>>ASSIGN  21591>>ASSIGN  21603>>ASSIGN  21689>>ASSIGN  21748>>ASSIGN
     21799>>IF      22053>>IF
G$MHJIT.ASDT_MON.MHJIT
      6080**DCL     22047>>ASSIGN
G$MHJIT.ASDT_MON.UMHJIT
      6058**DCL     22047<<ASSIGN
G$MHJIT.BOOTUTS
     12246**DCL     21733>>ASSIGN  21936>>ASSIGN
G$MHJIT.CU$
     12244**DCL     21517>>ASSIGN  21687>>ASSIGN  21756>>ASSIGN
G$MHJIT.CUN
     12244**DCL     21623>>ASSIGN  21625>>ASSIGN  21636>>IF      21646>>ASSIGN
G$MHJIT.INTCON.HHJIT
     12378**DCL     12378--REDEF
G$MHJIT.INTCON.P$$
     12351**DCL     12351--REDEF
G$MHJIT.ISA_BIGFOOT.P$$
      9296**DCL      9296--REDEF
G$MHJIT.ISA_DBINH.P$$
     10510**DCL     10510--REDEF
G$MHJIT.ISA_IDLE.P$$
      7391**DCL      7391--REDEF
G$MHJIT.ISA_LVL10.P$$
     10813**DCL     10813--REDEF
G$MHJIT.ISA_LVL11.P$$
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:100  
     11116**DCL     11116--REDEF
G$MHJIT.ISA_LVL12.P$$
     11419**DCL     11419--REDEF
G$MHJIT.ISA_LVL5.P$$
      9599**DCL      9599--REDEF
G$MHJIT.ISA_OV.P$$
      8993**DCL      8993--REDEF
G$MHJIT.ISA_PFS.P$$
      8664**DCL      8664--REDEF
G$MHJIT.ISA_RT_CLOCK.P$$
     12026**DCL     12026--REDEF
G$MHJIT.ISA_SATYR_RCV.P$$
      9903**DCL      9903--REDEF
G$MHJIT.ISA_SATYR_TRN.P$$
     10207**DCL     10207--REDEF
G$MHJIT.ISA_SCHD.P$$
     11722**DCL     11722--REDEF
G$MHJIT.ISA_WDOG.P$$
      8772**DCL      8772--REDEF
G$MHJIT.TSA_DB.ISA.P$$
      7994**DCL      7994--REDEF
G$MHJIT.TSA_DB.P$$
      7865**DCL      7865--REDEF    7866--REDEF
G$MHJIT.TSA_HND.ISA.P$$
     12572**DCL     12572--REDEF
G$MHJIT.TSA_HND.P$$
     12443**DCL     12443--REDEF   12444--REDEF
G$MHJIT.TSA_MON.ISA.P$$
      7606**DCL      7606--REDEF
G$MHJIT.TSA_MON.P$$
      7477**DCL      7477--REDEF    7478--REDEF
G$MHJIT.TSA_OV.ISA.P$$
      8382**DCL      8382--REDEF
G$MHJIT.TSA_OV.P$$
      8253**DCL      8253--REDEF    8254--REDEF
G$MHJIT$
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:101  
     21463**DCL      5916--IMP-PTR 21517>>ASSIGN  21623>>ASSIGN  21625>>ASSIGN  21636>>IF      21646>>ASSIGN
     21687>>ASSIGN  21733>>ASSIGN  21756>>ASSIGN  21936>>ASSIGN  22047>>ASSIGN  22047>>ASSIGN
G$ROS
     17990**DCL     21931--ASSIGN  22002--ASSIGN
G$ROS.AUTO_DS$
     17999**DCL     18000--REDEF
G$ROS.AUTO_T$
     18000**DCL     18000--REDEF
G$ROS.CP_ECCB.FLTFLG
     18614**DCL     18645--REDEF
G$ROS.DB_ECCB.FLTFLG
     18538**DCL     18569--REDEF
G$ROS.JIT
     18021**DCL     21933--ASSIGN  22004--ASSIGN
G$ROS.JIT.ERRLOG
     18349**DCL     18352--REDEF
G$ROS.JIT.JSUNIT
     18088**DCL     18089--REDEF
G$ROS.JIT.MCLS
     18087**DCL     18087--REDEF
G$ROS.JIT.TMRZ
     18356**DCL     18357--REDEF
G$ROS.JIT.USER_EXTIME
     18080**DCL     18081--REDEF
G$ROS.JIT.USER_MEMTIME
     18083**DCL     18083--REDEF
G$ROS.JIT.USER_SVTIME
     18082**DCL     18082--REDEF
G$ROS.M$DEBUG.EOMCHAR
     18685**DCL     18685--REDEF   18686--REDEF
G$ROS.M$DEBUG.FLDID
     18684**DCL     18684--REDEF
G$ROS.M$DEBUG.RES
     18679**DCL     18680--REDEF
G$ROS.M$DO.EOMCHAR
     18890**DCL     18890--REDEF   18891--REDEF
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:102  
G$ROS.M$DO.FLDID
     18889**DCL     18889--REDEF
G$ROS.M$DO.RES
     18884**DCL     18885--REDEF
G$ROS.M$HOST.EOMCHAR
     18839**DCL     18839--REDEF   18840--REDEF
G$ROS.M$HOST.FLDID
     18838**DCL     18838--REDEF
G$ROS.M$HOST.RES
     18833**DCL     18834--REDEF
G$ROS.M$LM.EOMCHAR
     18736**DCL     18736--REDEF   18737--REDEF
G$ROS.M$LM.FLDID
     18735**DCL     18735--REDEF
G$ROS.M$LM.RES
     18730**DCL     18731--REDEF
G$ROS.M$ME.EOMCHAR
     18788**DCL     18788--REDEF   18789--REDEF
G$ROS.M$ME.FLDID
     18787**DCL     18787--REDEF
G$ROS.M$ME.RES
     18782**DCL     18783--REDEF
G$ROS.U_ECCB.FLTFLG
     18462**DCL     18493--REDEF
G$ROS$
     21466**DCL     17990--IMP-PTR
G$U.CLOCK
     17909**DCL     21542>>IF      21582>>IF      21600>>IF      21621<<ASSIGN
G$U.DL$
     17910**DCL     21757>>ASSIGN
G$U.FLG.CPIC
     17907**DCL     21519>>IF
G$U.MISC
     17908**DCL     17908--REDEF   21772>>IF      21775>>ASSIGN
G$U.UTS
     17909**DCL     21546<<ASSIGN  21585>>ASSIGN  21616>>IF      21689<<ASSIGN
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:103  
G$UHJIT.ASDT_MCL.WINDOW1
     16188**DCL     21932<>CALL    22003<>CALL
G$UHJIT.ASDT_MCL.WINDOW1.BASE
     16190**DCL     21930<<ASSIGN  22001<<ASSIGN
G$UHJIT.ASDT_MCL.WINDOW1.SIZE
     16192**DCL     21931<<ASSIGN  22002<<ASSIGN
G$UHJIT.ASDT_USR.ROS.BASE
     14990**DCL     22000>>ASSIGN
G$UHJIT.ASDT_USR.ROS.SIZE
     14992**DCL     22010>>ASSIGN
G$UHJIT.ASDT_USR.TSTACKU.BASE
     15056**DCL     22013>>ASSIGN
G$UHJIT.ASDT_USR.TSTACKU.SIZE
     15058**DCL     22014>>ASSIGN
G$UHJIT.ASDT_USR.UHJIT.BASE
     15078**DCL     22017>>ASSIGN
G$UHJIT.ASDT_USR.UHJIT.SIZE
     15080**DCL     22018>>ASSIGN
G$UHJIT.DMN.ID
     16652**DCL     21522>>IF
G$UHJIT.ISA_USR
     16357**DCL     16652--REDEF
G$UHJIT.ISA_USR.P$$
     16432**DCL     16432--REDEF
G$UHJIT.TSA_CP.ISA.P$$
     17639**DCL     17639--REDEF
G$UHJIT.TSA_CP.P$$
     17510**DCL     17510--REDEF   17511--REDEF
G$UHJIT.TSA_DB.ISA.P$$
     17251**DCL     17251--REDEF
G$UHJIT.TSA_DB.P$$
     17122**DCL     17122--REDEF   17123--REDEF
G$UHJIT.TSA_RTT.P$$
     17885**DCL     17885--REDEF   17886--REDEF
G$UHJIT.TSA_USR.ISA.P$$
     16841**DCL     16841--REDEF
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:104  
G$UHJIT.TSA_USR.P$$
     16712**DCL     16712--REDEF   16713--REDEF
G$UHJIT$
     21465**DCL     14934--IMP-PTR 21522>>IF      21930>>ASSIGN  21931>>ASSIGN  21932>>CALL    22000>>ASSIGN
     22001>>ASSIGN  22002>>ASSIGN  22003>>CALL    22010>>ASSIGN  22013>>ASSIGN  22014>>ASSIGN  22017>>ASSIGN
     22018>>ASSIGN
G$USER.CLOCK
     17898**DCL     21619>>ASSIGN  21625<<ASSIGN  21639>>ASSIGN  21643>>ASSIGN  21645<<ASSIGN  21645>>ASSIGN
     21646<<ASSIGN
G$USER.MISC
     17897**DCL     17897--REDEF
G$USER.SYSID
     17900**DCL     22063>>IF
G$USER.US
     17897**DCL     21749>>IF      22063>>IF
G$USER.UTS
     17898**DCL     21616>>IF
G$USRT$
     21464**DCL     17896--IMP-PTR 21616>>IF      21619>>ASSIGN  21625>>ASSIGN  21639>>ASSIGN  21643>>ASSIGN
     21645>>ASSIGN  21645>>ASSIGN  21646>>ASSIGN  21749>>IF      22063>>IF      22063>>IF
G$WINDOW1$
     21467**DCL     21932<>CALL    21933>>ASSIGN  21956>>ASSIGN  21957>>ASSIGN  21958>>ASSIGN  21959>>ASSIGN
     22003<>CALL    22004>>ASSIGN
GFR$ACCT.ACCN
     20867**DCL     21835>>IF      21878<<ASSIGN
GFR$ACCT.CUR_FPRGS
     20867**DCL     21843>>IF      21850<<ASSIGN  21850>>ASSIGN  21875>>IF      21914<<ASSIGN  21914>>ASSIGN
     22031<<ASSIGN  22031>>ASSIGN
GFR$ACCT.CUR_MEM
     20867**DCL     21846>>IF      21851<<ASSIGN  21851>>ASSIGN  21915<<ASSIGN  21915>>ASSIGN  22032<<ASSIGN
     22032>>ASSIGN
GFR$ACCT.MAX_FPRGS
     20867**DCL     21840<<ASSIGN  21843>>IF
GFR$ACCT.MAX_MEM
     20867**DCL     21839<<ASSIGN  21846>>IF
GFR$ACCT.UNAME
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:105  
     20867**DCL     21835>>IF      21877<<ASSIGN
GFR@INDX
     21458**DCL     21814<<ASSIGN  21834<<DOINDEX 21835>>IF      21835>>IF      21839>>ASSIGN  21840>>ASSIGN
     21843>>IF      21843>>IF      21846>>IF      21846>>IF      21850>>ASSIGN  21850>>ASSIGN  21851>>ASSIGN
     21851>>ASSIGN  21855<<ASSIGN  21874<<DOINDEX 21875>>IF      21877>>ASSIGN  21878>>ASSIGN  21883<<ASSIGN
     21905>>IF      21914>>ASSIGN  21914>>ASSIGN  21915>>ASSIGN  21915>>ASSIGN  21951>>ASSIGN  22006<<ASSIGN
     22021>>IF      22031>>ASSIGN  22031>>ASSIGN  22032>>ASSIGN  22032>>ASSIGN
GFR@PGSZ
     21459**DCL     21815<<ASSIGN  21828>>IF      21846>>IF      21851>>ASSIGN  21852>>ASSIGN  21915>>ASSIGN
     21916>>ASSIGN  21952>>ASSIGN  22008<<ASSIGN  22011<<ASSIGN  22011>>ASSIGN  22015<<ASSIGN  22015>>ASSIGN
     22019<<ASSIGN  22019>>ASSIGN  22032>>ASSIGN  22033>>ASSIGN  22036>>ASSIGN  22037>>ASSIGN
GFR_CUR_MEM
     21511**DCL     21828>>IF      21852<<ASSIGN  21852>>ASSIGN  21916<<ASSIGN  21916>>ASSIGN  22033<<ASSIGN
     22033>>ASSIGN
GFR_END
     21884**LABEL   21831--GOTO    21853--GOTO    21856--GOTO
GFR_ERR
     21889**LABEL   21897--GOTO    21973--GOTO
GFR_MAX_MEM
     21510**DCL     21828>>IF
GFR_PSUDO_NM
     21509**DCL     21963>>IF
GFR_RES_LOCK
     21481**DCL     21826<>CALL    21895<>CALL    21912<>CALL    21922<>CALL    22029<>CALL    22044<>CALL
GHH$ASD
     21431**DCL-ENT 21932--CALL    22003--CALL
GHH$LOCK
       542**DCL-ENT 21540--CALL    21665--CALL    21695--CALL    21826--CALL    21912--CALL    22029--CALL
GHH$UNLOCK
       542**DCL-ENT 21553--CALL    21673--CALL    21703--CALL    21895--CALL    21922--CALL    22044--CALL
GHI$UTS
     21427**DCL-ENT 21545--CALL    21584--CALL    21688--CALL    21732--CALL    21770--CALL    21935--CALL
GHR$MON
     21432**DCL-ENT 21728--CALL
GHR$SRV
     21433**DCL-ENT 21765--CALL
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:106  
GHS$ADDUSR
     21430**DCL-ENT 21901--CALL
GHS$REG
     21429**DCL-ENT 21769--CALL
GHS$RUE
     21428**DCL-ENT 21751--CALL    22067--CALL
GH_CLOCKHD
     21507**DCL     21614>>ASSIGN  21623<<ASSIGN  21632>>IF      21633>>ASSIGN  21643<<ASSIGN
GMA$RELPS
     21434**DCL-ENT 22012--CALL    22016--CALL    22020--CALL
GM_ASHUF
     21513**DCL     22036<<ASSIGN  22036>>ASSIGN
GM_HSHUF
     21514**DCL     22037<<ASSIGN  22037>>ASSIGN
GM_INIT_PGSZ
     21508**DCL     21815>>ASSIGN
GOTIT IN PROCEDURE QWALCLK
     21621**LABEL   21617--GOTO
GUD$CHKWP
     21435**DCL-ENT 21574--CALL
G_CLKGATE
     21500**DCL     21540<>CALL    21553<>CALL    21665<>CALL    21673<>CALL    21695<>CALL    21703<>CALL
G_MUAIS
     21512**DCL     22062>>DOINDEX
I
     21445**DCL     21529<<ASSIGN  21530>>ASSIGN  21614<<ASSIGN  21615>>DOWHILE 21616>>IF      21618>>ASSIGN
     21619<<ASSIGN  21619>>ASSIGN  21621>>ASSIGN  21633<<ASSIGN  21635>>DOWHILE 21636>>IF      21638>>ASSIGN
     21639<<ASSIGN  21639>>ASSIGN  21643>>ASSIGN  21645>>ASSIGN  21813<<ASSIGN  21901<>CALL    21961<<DOINDEX
     21963>>IF      21965>>ASSIGN  22000<<ASSIGN  22001>>ASSIGN  22012<>CALL    22013<<ASSIGN  22016<>CALL
     22017<<ASSIGN  22020<>CALL    22062<<DOINDEX 22063>>IF      22063>>IF      22067<>CALL
INTERVAL
     21439**DCL     21528>>ASSIGN  21586<<ASSIGN  21589<<ASSIGN  21594<<ASSIGN  21740>>ASSIGN  21743>>ASSIGN
     21764<<ASSIGN  21773<<ASSIGN  21775<<ASSIGN
J
     21444**DCL     21613<<ASSIGN  21618<<ASSIGN  21622>>IF      21625>>ASSIGN  21634<<ASSIGN  21638<<ASSIGN
     21642>>IF      21645>>ASSIGN  21748<<ASSIGN  21749>>IF      21751<>CALL    21962<<DOINDEX 21963>>IF
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:107  
     21965>>ASSIGN  22010<<ASSIGN  22011>>ASSIGN  22012<>CALL    22014<<ASSIGN  22015>>ASSIGN  22016<>CALL
     22018<<ASSIGN  22019>>ASSIGN  22020<>CALL    22066<<ASSIGN  22067<>CALL
JIT.ACCN
     20441**DCL     21937<<ASSIGN
JIT.ACCTLOG.FCN
     20407**DCL     21953<<ASSIGN
JIT.ACCTLOG.FILENUM
     20408**DCL     21954<<ASSIGN
JIT.BILL
     20545**DCL     21942<<ASSIGN
JIT.CODE
     20438**DCL     21955<<ASSIGN
JIT.DB_ACCN
     20716**DCL     21950<<ASSIGN
JIT.ERRLOG
     20712**DCL     20715--REDEF
JIT.GFR_ACCT
     20718**DCL     21951<<ASSIGN  22006>>ASSIGN
JIT.JSTART
     20549**DCL     21935<>CALL    21936<<ASSIGN  21936>>ASSIGN
JIT.JSUNIT
     20451**DCL     20452--REDEF
JIT.JUNK.STEPACCT
     20702**DCL     21948<<ASSIGN
JIT.LANG
     20715**DCL     21947<<ASSIGN
JIT.MAXLVLS
     20716**DCL     21943<<ASSIGN
JIT.MAXMEM
     20561**DCL     21944<<ASSIGN  21945>>IF      21945<<ASSIGN
JIT.MAXSUDO
     20717**DCL     21965<<ASSIGN
JIT.MCLS
     20450**DCL     20450--REDEF
JIT.MODE
     20439**DCL     21946<<ASSIGN  22007>>ASSIGN
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:108  
JIT.MRT
     20551**DCL     21939<<ASSIGN
JIT.PCC
     20558**DCL     21952<<ASSIGN
JIT.PPRIV
     20664**DCL     21941<<ASSIGN
JIT.PRIV.AUTH
     20615**DCL     21940<<ASSIGN
JIT.PROG_ENTRY
     20439**DCL     21949<<ASSIGN
JIT.TMRZ
     20719**DCL     20720--REDEF
JIT.UNAME
     20441**DCL     21938<<ASSIGN
JIT.USER_EXTIME
     20443**DCL     20444--REDEF
JIT.USER_MEMTIME
     20446**DCL     20446--REDEF
JIT.USER_SVTIME
     20445**DCL     20445--REDEF
KL_STRTU.ACCT
     20997**DCL     21835>>IF      21878>>ASSIGN  21937>>ASSIGN
KL_STRTU.BILL
     21089**DCL     21942>>ASSIGN
KL_STRTU.DB_ACCT
     21001**DCL     21950>>ASSIGN
KL_STRTU.FLAGS.STEPACCT
     21107**DCL     21948>>ASSIGN
KL_STRTU.INTS
     21054**DCL     21813>>ASSIGN  21943>>ASSIGN
KL_STRTU.LANG
     21099**DCL     21947>>ASSIGN
KL_STRTU.MACCTFPRG
     21058**DCL     21840>>ASSIGN
KL_STRTU.MACCTMEM
     21067**DCL     21839>>ASSIGN
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:109  
KL_STRTU.MEM
     21049**DCL     21944>>ASSIGN
KL_STRTU.MODE
     21005**DCL     21812>>ASSIGN  21946>>ASSIGN
KL_STRTU.MRT
     21018**DCL     21939>>ASSIGN
KL_STRTU.NETADR_FROM
     20967**DCL     21956>>ASSIGN  21957>>ASSIGN
KL_STRTU.NETADR_TO
     20980**DCL     21958>>ASSIGN
KL_STRTU.PPRIV
     21039**DCL     21941>>ASSIGN
KL_STRTU.PRIV
     21029**DCL     21940>>ASSIGN
KL_STRTU.PSEUDO_MAX
     21084**DCL     21965>>ASSIGN
KL_STRTU.PSEUDO_NAME
     21072**DCL     21963>>IF
KL_STRTU.STR
     21009**DCL     21959>>ASSIGN
KL_STRTU.UNAME
     20993**DCL     21835>>IF      21877>>ASSIGN  21938>>ASSIGN
KNH$SCAN
     21436**DCL-ENT 21726--CALL
MAX
     21448**DCL     21529>>ASSIGN
MODE
     21460**DCL     21812<<ASSIGN  21828>>IF      21828>>IF      21852>>ASSIGN  21852>>ASSIGN  21901<>CALL
     21916>>ASSIGN  21916>>ASSIGN  22007<<ASSIGN  22033>>ASSIGN  22033>>ASSIGN  22034>>IF
NOTAUTH
     21206**DCL     21801>>ASSIGN  21925>>ASSIGN
NO_MSYS
     21253**DCL     22055>>ASSIGN
NO_WAIT
     21763**LABEL   21736--GOTO    21754--GOTO
P1$
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:110  
     21451**DCL     20883--IMP-PTR 20907--IMP-PTR 20931--IMP-PTR 20956--IMP-PTR 21518<<ASSIGN  21526>>DOCASE
     21529>>ASSIGN  21531>>ASSIGN  21533>>DOCASE  21544>>ASSIGN  21555>>ASSIGN  21556>>IF      21564>>ASSIGN
     21565>>IF      21571>>DOCASE  21586>>ASSIGN  21594>>ASSIGN  21597>>IF      21598>>DOCASE  21729<<ASSIGN
     21730>>DOCASE  21746>>DOCASE  21811<<ASSIGN  21812>>ASSIGN  21813>>ASSIGN  21835>>IF      21835>>IF
     21839>>ASSIGN  21840>>ASSIGN  21877>>ASSIGN  21878>>ASSIGN  21937>>ASSIGN  21938>>ASSIGN  21939>>ASSIGN
     21940>>ASSIGN  21941>>ASSIGN  21942>>ASSIGN  21943>>ASSIGN  21944>>ASSIGN  21946>>ASSIGN  21947>>ASSIGN
     21948>>ASSIGN  21950>>ASSIGN  21956>>ASSIGN  21957>>ASSIGN  21958>>ASSIGN  21959>>ASSIGN  21963>>IF
     21965>>ASSIGN  22052<<ASSIGN  22063>>IF      22066>>ASSIGN
PARM
     21115**DCL        60--PROC    21574<>CALL    21723--ENTRY   21797--ENTRY   22050--ENTRY
PARM.ASDT_MCL_INDX
     21178**DCL     21573<<ASSIGN
PARM.BND
     21175**DCL     21176--REDEF
PARM.DESC
     21177**DCL     21178--REDEF
PARM.ERR
     21141**DCL     21576<<ASSIGN  21801<<ASSIGN  21925<<ASSIGN  22055<<ASSIGN  22072<<ASSIGN
PARM.ERR.ERR#
     21168**DCL     21926<<ASSIGN
PARM.MCL.CODE
     21122**DCL     21122--REDEF
PARM.MCL.V#
     21122**DCL     21763>>IF      21771>>IF
PARM.PTRS
     21171**DCL     21172--REDEF   21174--REDEF   21174--REDEF   21174--REDEF
PARM.PTRS.PAR1$
     21171**DCL     21518>>ASSIGN  21729>>ASSIGN  21811>>ASSIGN  22052>>ASSIGN
PARM.PTRS.PAR2$
     21171**DCL     21528>>ASSIGN  21586>>ASSIGN  21589>>ASSIGN  21594>>ASSIGN  21733>>ASSIGN  21740>>ASSIGN
     21743>>ASSIGN
PARM.PTRS.PAR3$
     21171**DCL     21763>>IF      21764>>ASSIGN  21771>>IF      21773>>ASSIGN  21775>>ASSIGN
PSUDO_OK
     21972**LABEL   21966--GOTO
QWALCLK
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:111  
     21609**PROC    21547--CALL    21697--CALL
ROS.AUTO_DS$
     19026**DCL     19027--REDEF
ROS.AUTO_T$
     19027**DCL     19027--REDEF
ROS.CP_ECCB.FLTFLG
     19641**DCL     19672--REDEF
ROS.DB_ECCB.FLTFLG
     19565**DCL     19596--REDEF
ROS.JIT.ERRLOG
     19376**DCL     19379--REDEF
ROS.JIT.JSUNIT
     19115**DCL     19116--REDEF
ROS.JIT.MCLS
     19114**DCL     19114--REDEF
ROS.JIT.TMRZ
     19383**DCL     19384--REDEF
ROS.JIT.USER_EXTIME
     19107**DCL     19108--REDEF
ROS.JIT.USER_MEMTIME
     19110**DCL     19110--REDEF
ROS.JIT.USER_SVTIME
     19109**DCL     19109--REDEF
ROS.M$DEBUG.EOMCHAR
     19712**DCL     19712--REDEF   19713--REDEF
ROS.M$DEBUG.FLDID
     19711**DCL     19711--REDEF
ROS.M$DEBUG.RES
     19706**DCL     19707--REDEF
ROS.M$DO.EOMCHAR
     19917**DCL     19917--REDEF   19918--REDEF
ROS.M$DO.FLDID
     19916**DCL     19916--REDEF
ROS.M$DO.RES
     19911**DCL     19912--REDEF
ROS.M$HOST.EOMCHAR
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:112  
     19866**DCL     19866--REDEF   19867--REDEF
ROS.M$HOST.FLDID
     19865**DCL     19865--REDEF
ROS.M$HOST.RES
     19860**DCL     19861--REDEF
ROS.M$HOST.RLCID
     19870**DCL     21957<<ASSIGN
ROS.M$LM.EOMCHAR
     19763**DCL     19763--REDEF   19764--REDEF
ROS.M$LM.FLDID
     19762**DCL     19762--REDEF
ROS.M$LM.RES
     19757**DCL     19758--REDEF
ROS.M$LM.RLCID
     19767**DCL     21956<<ASSIGN
ROS.M$ME.EOMCHAR
     19815**DCL     19815--REDEF   19816--REDEF
ROS.M$ME.FLDID
     19814**DCL     19814--REDEF
ROS.M$ME.RES
     19809**DCL     19810--REDEF
ROS.M$ME.RLCID
     19819**DCL     21958<<ASSIGN
ROS.M$ME.STRM
     19804**DCL     21959<<ASSIGN
ROS.U_ECCB.FLTFLG
     19489**DCL     19520--REDEF
ROSPP
     21455**DCL     21901<>CALL    21930>>ASSIGN
S
     21447**DCL     21735<<ASSIGN  21738<<ASSIGN  21741<<ASSIGN  21743<<ASSIGN  21751<>CALL    21752<<ASSIGN
     21764>>ASSIGN  21769<>CALL
SET_ACCRES
     21831**LABEL   21879--GOTO
T
     21442**DCL     21545<>CALL    21546>>ASSIGN  21584<>CALL    21585<<ASSIGN  21585>>ASSIGN  21586>>ASSIGN
PL6.E3A0      #001=GUS$CLOCK File=GUS$SCHD.:E05TSI                               TUE 07/29/97 22:15 Page:113  
     21688<>CALL    21689>>ASSIGN  21726<>CALL    21732<>CALL    21734>>IF      21738>>ASSIGN  21770<>CALL
     21772>>IF      21775>>ASSIGN
U
     21443**DCL     21733<<ASSIGN  21734>>IF      21738>>ASSIGN  21740<<ASSIGN  21741>>ASSIGN
USER#
     21454**DCL     21901<>CALL
UTSVALUE
     21440**DCL     21733>>ASSIGN

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:114  
      658        1        /*M*  Date and Time Service Procedure                              */
      659        2        /*T***********************************************************/
      660        3        /*T*                                                         */
      661        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      662        5        /*T*                                                         */
      663        6        /*T***********************************************************/
      664        7
      665        8        /*F*  NAME: GUS$TIME
      666        9              PURPOSE:  To process the M$TIME Monitor Service.
      667       10
      668       11        */
      669       12        /*D*
      670       13              NAME: GUS$TIME
      671       14              CALL:
      672       15                    Standard MCL Service Decoder call.
      673       16              DESCRIPTION:
      674       17                    This procedure processes the M$TIME service call.
      675       18                    It converts input defined by SOURCE type to an output
      676       19                    whose format is defined by DEST.
      677       20
      678       21
      679       22        */
      680       23
      681       24        GUS$TIME: PROC (PARM);
      682       25
      683       26
      684       27        %INCLUDE GU_MACROS_M;
      685      186 S      %INCLUDE GU_LCP6_M;
      686      187 S      %INCLUDE G_LCP6_E;
      687      188        %INCLUDE G_HJIT_M;
      688      333 S      %INCLUDE GH_LCP6_M;
      689      334        %INCLUDE P_FEP_M;
      690      772        %INCLUDE KL_MACRO_C;
      691     4124        %INCLUDE KL_AFCN_C;
      692     4225        %INCLUDE K_ID_E;
      693     4275        %INCLUDE UM_ERRORS_C;
      694     4309        %INCLUDE UD_ERRORS_C;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:115  
      695     4351
      696     4352
      697     4353
      698     4354
      699     4355    1   DCL   GHI$UTS ENTRY(1);
      700     4356
      701     4357    1   DCL G_BOOTTIME UBIN(32) STATIC SYMDEF INIT(0);
      702     4358        /*  Refer to AF_1293A-0 for a description of FEP eras       */
      703     4359        /*  Note that an era here is only 3 quarters of a full uts in length*/
      704     4360        /*  because first and last quarters overlap.  This makes code in */
      705     4361        /*  DATEUTS have to add another quarter to get the full UTS range*/
      706     4362    1   DCL   BD(0:3) UBIN(32) STATIC;          /* days from 1 AD to beginning of qtr */
      707     4363    1   DCL   U1(0:3) UBIN(32) STATIC;          /* uts to beginning of qtr            */
      708     4364    1   DCL   ELL UBIN(32) STATIC;              /* era lower limit                    */
      709     4365    1   DCL   ELLU UBIN(32) STATIC;             /* era lower limit uts                */
      710     4366    1   DCL   EUL UBIN(32) STATIC;              /* era upper limit                    */
      711     4367    1   DCL   EULU UBIN(32) STATIC;             /* era upper limit uts                */
      712     4368    1   DCL  ERA UBIN;                          /* temp era                           */
      713     4369    1   DCL  QTR UBIN;                          /* temp quarter                       */
      714     4370    1   DCL BASEDAYS UBIN(32) CONSTANT INIT (722528); /* Days to 1/1/78               */
      715     4371        /**/
      716     4372        %EQU  TICS_DAY = 648000;
      717     4373        %EQU  TICS_QTR = BITBIN ('40000000'X);
      718     4374        %EQU  TICS_ERA = TICS_QTR * 3;     /* each ERA has 3 quarters belonging to it */
      719     4375        %EQU  DAYS_QTR = TICS_QTR / TICS_DAY;
      720     4376        %EQU  DAYS_ERA = TICS_ERA / TICS_DAY;
      721     4377        %EQU  UTS_QTR  = MOD (TICS_QTR , TICS_DAY);
      722     4378        %EQU  UTS_ERA  = MOD (TICS_ERA , TICS_DAY);
      723     4379        /**/
      724     4380    1   DCL   B_TICSDAY STATIC SYMDEF UBIN(32) INIT(%TICS_DAY);
      725     4381        %EQU DPM = 306001;                      /* Days/month * 10000                 */
      726     4382    1   DCL   A UBIN(32) BASED CALIGNED;
      727     4383    1   DCL   UTIME UBIN(32);
      728     4384    1   DCL 1 UTIMEX REDEF UTIME,
      729     4385    1         2 QTR UBIN(2) UNAL,
      730     4386    1         2 * UBIN(30) UNAL;
      731     4387    1   DCL   UTI UBIN(32);
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:116  
      732     4388    1   DCL 1 UTIX REDEF UTI,
      733     4389    1         2 QTR UBIN(4) UNAL,
      734     4390    1         2 UTS UBIN(28) UNAL;
      735     4391    1   DCL   I UBIN;
      736     4392    1   DCL   J UBIN;
      737     4393    1   DCL   K UBIN;
      738     4394    1   DCL   YP UBIN(32);
      739     4395    1   DCL   MP UBIN(32);
      740     4396    1   DCL   TMSZ UBIN;
      741     4397    1   DCL TMSZZ UBIN(8);
      742     4398    1   DCL   DTSZ UBIN;
      743     4399    1   DCL   TUNITS UBIN(32);
      744     4400    1   DCL   P1$ PTR;
      745     4401    1   DCL   ST3 CHAR(3) BASED;
      746     4402    1   DCL   ST5 CHAR(5) BASED;
      747     4403    1   DCL   ST6 CHAR(6) BASED;
      748     4404    1   DCL   ST8 CHAR(8) BASED;
      749     4405    1   DCL   ST10 CHAR(10) BASED;
      750     4406    1   DCL   STTMSZ CHAR(TMSZZ) BASED;
      751     4407    1   DCL   HSEC CHAR(2);                     /* 1/100 SEC                          */
      752     4408    1   DCL   SEC CHAR(2);
      753     4409    1   DCL   SECONDS CHAR(6);
      754     4410    1   DCL   MINS CHAR(2);
      755     4411    1   DCL   HRS CHAR(2);
      756     4412    1   DCL   MON CHAR(2);
      757     4413    1   DCL   DAY CHAR(2);
      758     4414    1   DCL   YR CHAR(2);
      759     4415    1   DCL   D1 UBIN(32);
      760     4416    1   DCL   WKD UBIN;                         /* DAY OF WEEK                        */
      761     4417    1   DCL   JDAY CHAR(3);                     /* JULIEN DAY                         */
      762     4418    1   DCL   JD UBIN;                          /*  "                                 */
      763     4419    1   DCL 1 B,
      764     4420    1         2 MM UBIN,
      765     4421    1         2 DD UBIN,
      766     4422    1         2 YY UBIN,
      767     4423    1         2 HH UBIN,
      768     4424    1         2 MI UBIN,
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:117  
      769     4425    1         2 SS UBIN,
      770     4426    1         2 SS00 UBIN;
      771     4427    1   DCL   DT(0:6) REDEF B UBIN;
      772     4428    1   DCL   ST(0:6) REDEF B SBIN;
      773     4429        /*                                                                    */
      774     4430    1   DCL   WKDAY(0:6) CONSTANT CHAR(3) INIT(
      775     4431    1              'SUN','MON','TUE','WED','THU','FRI','SAT');
      776     4432    1   DCL   MONTH(0:11) CONSTANT CHAR(4) INIT(
      777     4433    1              'JAN ','FEB ','MAR ','APR ','MAY ','JUN ','JUL ',
      778     4434    1              'AUG ','SEP ','OCT ','NOV ','DEC ');
      779     4435    1   DCL   MONS(0:12) CONSTANT UBIN INIT(
      780     4436    1              0,31,59,90,120,151,181,212,243,273,304,334,365);
      781     4437    1   DCL   LPS(0:4) UBIN CONSTANT INIT(790,2251,3712,5173,
      782     4438    1              6634);
      783     4439    1   DCL    V1SIZE(0:3) UBIN STATIC SYMDEF INIT(0,10,6,8);
      784     4440    1   DCL    V3SIZE(0:3) UBIN STATIC SYMDEF INIT(0,3,5,3);
      785     4441
      786     4442        %FPT_TIME (FPTN=FPT_TIMEV,VECTORS=NO,STCLASS="BASED(P1$)");
      787     4466        %G$MHJIT (STCLASS="BASED (G$MHJIT$)");
      788    11340        %K#ENTID_E;
      789    11359        %K#LYRID_E;
      790    11366        %PS_LCP6STT (STCLASS=SYMREF);
      791    11870        %VLP_ERRCODE (FPTN=SRCERR,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      792    11871                      STCLASS=CONSTANT,ERR#=%E$BADDT);
      793    11917        %VLP_ERRCODE (FPTN=V4ERR,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      794    11918                      STCLASS=CONSTANT,ERR#=%E$BADVECT4);
      795    11964        %VLP_ERRCODE (FPTN=V1ERR,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      796    11965                      STCLASS=CONSTANT,ERR#=%E$BADVECT1);
      797    12011        %VLP_ERRCODE (FPTN=V2ERR,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      798    12012                      STCLASS=CONSTANT,ERR#=%E$BADVECT2);
      799    12058        %VLP_ERRCODE (FPTN=V3ERR,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      800    12059                      STCLASS=CONSTANT,ERR#=%E$BADVECT3);
      801    12105        %VLP_ERRCODE (FPTN=YRERR,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      802    12106                      STCLASS=CONSTANT,ERR#=%E$YEARERR);
      803    12152
      804    12153    1   DCL G$MHJIT$ PTR SYMREF;
      805    12154
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:118  
      806    12155        %GUD_HAND_PARAMS (FPTN=PARM);
      807    12231    1           P1$=PARM.PTRS.PAR1$;
      808    12232
      809    12233    1           B='0'B;                         /* Clear date, time values            */
      810    12234
      811    12235        /*       Convert source data to binary date and time.     */
      812    12236
      813    12237    2           DO CASE (FPT_TIMEV.SOURCE);
      814    12238
      815    12239    2            CASE(%G_TIME_ANS);
      816    12240    2              CALL ANSDATE(PARM.PTRS.PAR2$->A,PARM.PTRS.PAR3$->A) ALTRET(DTERR);
      817    12241    2            CASE (%G_TIME_LOCAL);
      818    12242    2              CALL LCLDATE(PARM.PTRS.PAR2$->A,PARM.PTRS.PAR3$->A) ALTRET(DTERR);
      819    12243    2            CASE (%G_TIME_CLOCK);
      820    12244    2              CALL GHI$UTS(UTIME);
      821    12245    2              UTIME=UTIME+G$MHJIT.BOOTUTS;
      822    12246    2              CALL UTSDATE;                /* Convert current time               */
      823    12247    2            CASE (%G_TIME_UTS);
      824    12248    2              CALL DSIZE(4,J) ALTRET(NOPS4);
      825    12249    2              UTIME=PARM.PTRS.PAR5$->A;    /* Convert input UTS                  */
      826    12250    2              CALL UTSDATE;
      827    12251    2            CASE (%G_TIME_TUN);
      828    12252    2              CALL DSIZE(4,J) ALTRET(NOPS4);
      829    12253    2              UTI=PARM.PTRS.PAR5$->A;      /* Get current time and substitute    */
      830    12254    2              CALL GHI$UTS(UTIME);         /* input TUNs                         */
      831    12255    2              UTIME=UTIME+G$MHJIT.BOOTUTS;
      832    12256    2              CALL UTSDATE;
      833    12257    2              B.SS00=MOD(UTI/10,100);
      834    12258    2              B.SS=MOD(UTI/1000,60);
      835    12259    2              B.MI=MOD(UTI/60000,60);
      836    12260    2              B.HH=MOD(UTI/3600000,24);
      837    12261    2            END;
      838    12262
      839    12263    1           JD=MONS(B.MM-1)+B.DD;
      840    12264    1           IF (MOD(B.YY,4)=0) AND (B.MM > 2) THEN
      841    12265    1              JD=JD+1;
      842    12266    1           YP=B.YY*365;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:119  
      843    12267    1           D1=YP+(B.YY-1)/4 +JD;
      844    12268    1           WKD=MOD(D1,7);                  /* Day of the week                    */
      845    12269    1           CALL BINCHAR(SEC,B.SS);
      846    12270    1           CALL BINCHAR(HSEC,B.SS00);
      847    12271    1           CALL BINCHAR(HRS,B.HH);
      848    12272    1           CALL BINCHAR(MINS,B.MI);
      849    12273    1           CALL BINCHAR(DAY,B.DD);
      850    12274    1           CALL BINCHAR(MON,B.MM);
      851    12275    1           CALL BINCHAR(YR,B.YY);
      852    12276    1           CALL BINCHAR(JDAY,JD);
      853    12277
      854    12278        /*    Format date and time for output                              */
      855    12279
      856    12280    2           DO CASE (FPT_TIMEV.DEST);
      857    12281    2            CASE(%G_TIME_UTS);
      858    12282    2            CASE (%G_TIME_TUN);
      859    12283    2              CALL DSIZE(4,J) ALTRET(NOPS4);
      860    12284    2              IF J ~= 4 THEN
      861    12285    2                 GOTO NOPS4;
      862    12286    2              CALL DATEUTS ALTRET(BADYR);
      863    12287    2              PARM.PTRS.PAR5$->A=TUNITS;
      864    12288    2              RETURN;
      865    12289    2            CASE (%G_TIME_EXT,%G_TIME_ANS,%G_TIME_LOCAL);
      866    12290    2              CALL DSIZE(1,J) ALTRET(TM2);
      867    12291    2              IF J < V1SIZE(FPT_TIMEV.DEST) THEN
      868    12292    2                 GOTO BADV1;
      869    12293    3              DO CASE (FPT_TIMEV.DEST);
      870    12294    3               CASE(%G_TIME_ANS);
      871    12295    3                 CALL CONCAT(PARM.CPTRS.PAR2$->ST6,YR,MON,DAY);
      872    12296    3               CASE (%G_TIME_LOCAL);
      873    12297    3                 CALL CONCAT(PARM.CPTRS.PAR2$->ST8,MON,'/',DAY,'/',YR);
      874    12298    3               CASE (%G_TIME_EXT);
      875    12299    3                 CALL CONCAT(PARM.CPTRS.PAR2$->ST10,MONTH(B.MM-1),DAY,' ''',YR);
      876    12300    3               END;
      877    12301    2   TM2:       CALL DSIZE(2,TMSZ) ALTRET(TM3);
      878    12302    2              TMSZZ=TMSZ;
      879    12303    3              DO CASE (FPT_TIMEV.DEST);
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:120  
      880    12304    3               CASE (%G_TIME_ANS);
      881    12305    3                 CALL CONCAT(PARM.CPTRS.PAR3$->STTMSZ,HRS,MINS,SEC,HSEC);
      882    12306    3               CASE (%G_TIME_LOCAL,%G_TIME_EXT);
      883    12307    3                 CALL CONCAT(SECONDS,SEC,'.',HSEC);
      884    12308    3                 CALL CONCAT(PARM.CPTRS.PAR3$->STTMSZ,HRS,':',MINS,':',SECONDS);
      885    12309    3               END;
      886    12310    2   TM3:       CALL DSIZE(3,J) ALTRET(UT);
      887    12311    2              IF J < V3SIZE(FPT_TIMEV.DEST) THEN
      888    12312    2                 GOTO BADV3;
      889    12313    3              DO CASE (FPT_TIMEV.DEST);
      890    12314    3               CASE (%G_TIME_ANS);
      891    12315    3                 CALL CONCAT(PARM.CPTRS.PAR4$->ST5,YR,JDAY);
      892    12316    3               CASE (%G_TIME_LOCAL,%G_TIME_EXT);
      893    12317    3                 PARM.PTRS.PAR4$->ST3=WKDAY(WKD);
      894    12318    3               END;
      895    12319    2            END;
      896    12320    1   UT:     CALL DSIZE(4,J) ALTRET(XTIME);
      897    12321    1           IF FPT_TIMEV.SOURCE ~= %G_TIME_UTS AND
      898    12322    2             FPT_TIMEV.SOURCE ~= %G_TIME_TUN THEN DO;
      899    12323    2              IF J ~= 4 THEN
      900    12324    2                 GOTO NOPS4;
      901    12325    2              CALL DATEUTS ALTRET(NOPS4);
      902    12326    2              PARM.PTRS.PAR5$->A=UTIME;
      903    12327    2              END;
      904    12328    1   XTIME:  RETURN;
      905    12329
      906    12330
      907    12331        /*E* ERROR: GUS-E$YEARERR-0
      908    12332              MESSAGE: M$TIME can't convert dates before 1/1/78 to UTS
      909    12333              values.
      910    12334                                                                           */
      911    12335        /*E*  ERROR: GUS-E$BADDT-0
      912    12336              MESSAGE: Source DATE or TIME format error.
      913    12337              DESCRIPTION: Date or time source string is non-numeric, has
      914    12338              incorrect length or is not in the correct format.
      915    12339                                                                           */
      916    12340        /*E*  ERROR: GUS-E$BADVECT1-0
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:121  
      917    12341              MESSAGE: Destination DATE vector is incorrect size.
      918    12342                                                                           */
      919    12343        /*E*  ERROR: GUS-E$BADVECT2-0
      920    12344              MESSAGE: Destination TIME vector is incorrect size.
      921    12345                                                                           */
      922    12346        /*E*  ERROR: GUS-E$BADVECT3-0
      923    12347              MESSAGE: Destination DAY vector is incorrect length.
      924    12348                                                                           */
      925    12349        /*E* ERROR: GUS-E$BADVECT4-0
      926    12350              MESSAGE: Required TSTAMP vector is missing.
      927    12351                                                                           */
      928    12352
      929    12353    1   BADYR:  PARM.ERR=YRERR;
      930    12354    1           GOTO ERRXIT;
      931    12355    1   BADV1:  PARM.ERR=V1ERR;
      932    12356    1           GOTO ERRXIT;
      933    12357    1   BADV3:  PARM.ERR=V3ERR;
      934    12358    1           GOTO ERRXIT;
      935    12359    1   NOPS4:  PARM.ERR=V4ERR;
      936    12360    1           GOTO ERRXIT;
      937    12361    1   DTERR:  PARM.ERR=SRCERR;
      938    12362    1   ERRXIT: RETURN;
      939    12363        %EJECT;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:122  
      940    12364        /*
      941    12365                   Convert LOCAL form to binary DATE and TIME
      942    12366                                                                           */
      943    12367
      944    12368    1   LCLDATE: PROC(DATE,TIME) ALTRET;
      945    12369
      946    12370    2   DCL   DATE CHAR(8);
      947    12371    2   DCL   DTCHR(0:7) REDEF DATE CHAR(1);
      948    12372    2   DCL   TIME CHAR(11);
      949    12373    2   DCL   TMCHR(0:10) REDEF TIME CHAR(1);
      950    12374    2   DCL   LO(0:6) UBIN CONSTANT INIT(1,1,0,0,0,0,0);
      951    12375    2   DCL   HI(0:6) UBIN CONSTANT INIT(12,31,99,23,59,59,99);
      952    12376    2   DCL DELM(0:6) CHAR(1) CONSTANT INIT('*','*','*',':',':','.','*');
      953    12377
      954    12378    2           CALL DSIZE (1,DTSZ) ALTRET(DATERR);
      955    12379    2           CALL DSIZE (2,TMSZ);
      956    12380
      957    12381        /*    Parse date string                                            */
      958    12382
      959    12383    3           DO I = 0 TO DTSZ-1;
      960    12384    3              IF DTCHR(I) ~= '/' AND (DTCHR(I) < '0' OR DTCHR(I) > '9') THEN
      961    12385    3                 GOTO DATERR;
      962    12386    3              END;
      963    12387    2           CALL INDEX (I,'/',DATE) ALTRET(DATERR);
      964    12388    2           CALL INDEX (J,'/',DATE,I+1) ALTRET(DATERR);
      965    12389    2           IF I=0 OR J=I+1 OR J ~= DTSZ-3 THEN
      966    12390    2              GOTO DATERR;
      967    12391    2           CALL CHARBIN(B.MM,SUBSTR(DATE,0,I));
      968    12392    2           CALL CHARBIN(B.DD,SUBSTR(DATE,I+1,J-(I+1)));
      969    12393    2           CALL CHARBIN(B.YY,SUBSTR(DATE,J+1,DTSZ-J-1));
      970    12394
      971    12395        /*    Parse time string                                            */
      972    12396
      973    12397    3           DO I = 0 TO TMSZ-1;
      974    12398    3              IF TMCHR(I) ~= ':' AND TMCHR(I) ~= '.' AND (TMCHR(I) < '0' OR
      975    12399    3                TMCHR(I) > '9') THEN
      976    12400    3                 GOTO DATERR;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:123  
      977    12401    3              END;
      978    12402    2           J=0;
      979    12403    2           I=3;
      980    12404    3           DO WHILE J < TMSZ;
      981    12405    3              IF I>6 THEN
      982    12406    3                 GOTO DATERR;
      983    12407    3              CALL INDEX (K,DELM(I),TIME,J) ALTRET(LASTFLD);
      984    12408    4              DO WHILE '0'B;
      985    12409    4   LASTFLD:      K=TMSZ;
      986    12410    4                 END;
      987    12411    4              IF K > J THEN DO;
      988    12412    4                 CALL CHARBIN(DT(I),SUBSTR(TIME,J,K-J));
      989    12413    4                 IF I=6 & K-J=1 THEN DT(6)=DT(6)*10;
      990    12414    4                 END;
      991    12415    3              J=K+1;
      992    12416    3              I=I+1;
      993    12417    3              END;
      994    12418    3   LCL4:   DO I = 0 TO 6;             /* Verify field values are within limits   */
      995    12419    3              IF DT(I) < LO(I) OR DT(I) > HI(I) THEN GOTO DATERR;
      996    12420    3              END;
      997    12421    2           IF B.DD > (MONS(B.MM)-MONS(B.MM-1)) AND
      998    12422    2             NOT (B.MM = 2 AND MOD(B.YY,4) = 0 AND B.DD = 29) THEN
      999    12423    2              GOTO DATERR;
     1000    12424    2           RETURN;
     1001    12425        %EJECT;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:124  
     1002    12426        /*
     1003    12427                 Convert ANS form to BINARY DATE and TIME
     1004    12428                                                                              */
     1005    12429    2   ANSDATE: ENTRY(DATE,TIME) ALTRET;
     1006    12430
     1007    12431    2           CALL DSIZE (1,DTSZ) ALTRET(DATERR);
     1008    12432    2           CALL DSIZE (2,TMSZ);
     1009    12433    2           IF DTSZ < 6 OR (TMSZ < 8 AND TMSZ > 0) THEN GOTO DATERR;
     1010    12434    3           IF DTSZ ~= 0 THEN DO I = 0 TO 5;
     1011    12435    3              IF DTCHR(I) < '0' OR DTCHR(I) > '9' THEN GOTO DATERR;
     1012    12436    3              END;
     1013    12437    3           IF TMSZ ~= 0 THEN DO I = 0 TO 7;
     1014    12438    3              IF TMCHR(I) < '0' OR TMCHR(I) > '9' THEN GOTO DATERR;
     1015    12439    3              END;
     1016    12440    2           CALL CHARBIN(DT(2),SUBSTR(DATE,0,2));
     1017    12441    2           CALL CHARBIN(DT(0),SUBSTR(DATE,2,2));
     1018    12442    2           CALL CHARBIN(DT(1),SUBSTR(DATE,4,2));
     1019    12443    2           K=0;
     1020    12444    2           IF TMSZ > 0 THEN
     1021    12445    3           DO I= 3 TO 6;
     1022    12446    3              CALL CHARBIN(DT(I),SUBSTR(TIME,K,2));
     1023    12447    3              K=K+2;
     1024    12448    3              END;
     1025    12449    2           GOTO LCL4;
     1026    12450    2   DATERR: ALTRETURN;
     1027    12451    2   END LCLDATE;
     1028    12452        %EJECT;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:125  
     1029    12453        /*
     1030    12454                   Convert UTS to DATE and TIME
     1031    12455                                                                              */
     1032    12456    1   UTSDATE: PROC;
     1033    12457
     1034    12458    2   DCL J UBIN(32);
     1035    12459    2   DCL U UBIN(32);
     1036    12460    2   DCL BIAS UBIN STATIC;
     1037    12461    2   DCL 1 NEGFLAG BIT(1) BASED WALIGNED;
     1038    12462
     1039    12463                /* The following code has been tweaked to address 42930. It does
     1040    12464                   this by checking if the UTS is negative. If so, it will subtract
     1041    12465                   a bias value which represents the number of ticks in 3314 days.
     1042    12466                   The value represents the largest positive UTS value on an even
     1043    12467                   day boundary that will fit in a 32-bit two's complement value.
     1044    12468                   Since the problem involves multiplication and division, the bias
     1045    12469                   bias value can be added back at the end of the multiplication
     1046    12470                   or division operations. */
     1047    12471
     1048    12472    3           IF ADDR(UTIME)->NEGFLAG THEN DO;
     1049    12473    3              U = UTIME - 2147472000;
     1050    12474    3              BIAS = 3314;
     1051    12475    4              IF ADDR(U)->NEGFLAG THEN DO;
     1052    12476    4                 U = U - %TICS_DAY;
     1053    12477    4                 BIAS = BIAS + 1;
     1054    12478    4                 END;
     1055    12479    3              END;
     1056    12480    3           ELSE DO;
     1057    12481    3              U = UTIME;
     1058    12482    3              BIAS = 0;
     1059    12483    3              END;
     1060    12484    2           J = MOD(U, %TICS_DAY) + U1(UTIMEX.QTR);
     1061    12485    2           D1 = U/%TICS_DAY + BD(UTIMEX.QTR) + J/%TICS_DAY + BIAS;
     1062    12486    2           J = (MOD(J, %TICS_DAY)*40 +2)/3; /* CV TO CENTISEC                    */
     1063    12487
     1064    12488    2           B.SS00 = MOD(J, 100);
     1065    12489    2           J = J / 100;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:126  
     1066    12490    2           B.SS = MOD(J, 60);
     1067    12491    2           J = J / 60;
     1068    12492    2           B.MI =  MOD(J, 60);
     1069    12493    2           B.HH = J / 60;
     1070    12494    2           YP=((D1*100-12210)/36525);
     1071    12495    2           MP=((D1-(36525*YP)/100)*10000)/%DPM;
     1072    12496    2           B.DD=D1-(36525*YP)/100-(%DPM*MP)/10000;
     1073    12497    2           IF MP>13 THEN
     1074    12498    2              B.MM=MP-13;
     1075    12499    2           ELSE
     1076    12500    2              B.MM=MP-1;
     1077    12501    2           IF B.MM <= 2 THEN
     1078    12502    2              B.YY=YP-1899;
     1079    12503    2           ELSE
     1080    12504    2              B.YY=YP-1900;
     1081    12505    2           RETURN;
     1082    12506    2   END UTSDATE;
     1083    12507
     1084    12508        /*    Convert Date and Time to UTS                                 */
     1085    12509
     1086    12510    1   DATEUTS: PROC ALTRET;
     1087    12511
     1088    12512    2   DCL J UBIN(32);
     1089    12513    2   DCL HH UBIN(32);
     1090    12514
     1091    12515    2           IF (B.YY < 78 AND B.YY > 20) THEN
     1092    12516    2              ALTRETURN;
     1093    12517    3           IF B.MM < 3 THEN DO;
     1094    12518    3              YP=B.YY-1;
     1095    12519    3              MP=B.MM+13;
     1096    12520    3              END;
     1097    12521    3           ELSE DO;
     1098    12522    3              MP=B.MM+1;
     1099    12523    3              YP=B.YY;
     1100    12524    3              END;
     1101    12525    2           IF B.YY > 77 THEN
     1102    12526    2              D1 = (36525*(YP+1900))/100+(%DPM*MP)/10000+B.DD;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:127  
     1103    12527    2           ELSE
     1104    12528    2              D1 = (36525*(YP+2000))/100+(%DPM*MP)/10000+B.DD;
     1105    12529    2           HH = B.HH;
     1106    12530    2           TUNITS = (((HH*60+B.MI)*60+B.SS)*100+B.SS00) * 10; /* time in msecs   */
     1107    12531    2           J = (TUNITS * 3 + 200) / 400;   /* TUNs in tics                       */
     1108    12532    2           IF (D1 < ELL OR (D1 = ELL AND J < ELLU) OR
     1109    12533    2             (D1 > EUL) OR (D1 = EUL AND J >= EULU)) THEN
     1110    12534    2              UTIME = 0;
     1111    12535    2           ELSE IF D1 > BD(1) OR (D1 = BD(1) AND J >= U1(1)) THEN
     1112    12536    2                 UTIME = (D1 - BD(1)) * %TICS_DAY + J - U1(1);
     1113    12537    2              ELSE
     1114    12538    2                 UTIME = (D1 - BD(3)) * %TICS_DAY + J - U1(3);
     1115    12539    2           RETURN;
     1116    12540    2   END DATEUTS;
     1117    12541        /*                                                                    */
     1118    12542        %EJECT;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:128  
     1119    12543
     1120    12544    1   DSIZE:  PROC (I,J) ALTRET;
     1121    12545
     1122    12546    2   DCL I UBIN;
     1123    12547    2   DCL J UBIN;
     1124    12548
     1125    12549    3           IF PARM.PTRS_ARRAY(I) = ADDR(NIL) THEN DO;
     1126    12550    3              J=0;
     1127    12551    3              ALTRETURN;
     1128    12552    3              END;
     1129    12553    2           ELSE
     1130    12554    2              J=PARM.BND_ARRAY(I)+1;
     1131    12555    2           RETURN;
     1132    12556    2   END DSIZE;
     1133    12557        %EJECT;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:129  
     1134    12558        /*       Set UTS                  */
     1135    12559    1   GUS$SETTIME: ENTRY (PARM);
     1136    12560
     1137    12561    1           UTI = ADDR(PARM)->A;            /* 36 bit boot uts scaled at b4       */
     1138    12562    1           ERA = UTIX.QTR / 3;
     1139    12563    1           QTR = MOD (UTIX.QTR,3);
     1140    12564                                      /* compute time to beginning of current era     */
     1141    12565    1           BD(0) = BASEDAYS + (ERA * %DAYS_ERA);
     1142    12566    1           BD(1) = BD(0);
     1143    12567    1           BD(2) = BD(0);
     1144    12568    1           U1(0) = (ERA * %UTS_ERA);
     1145    12569    1           U1(1) = U1(0);
     1146    12570    1           U1(2) = U1(0);
     1147    12571    2           IF (ERA > 0 AND QTR = 0) THEN DO;
             12571                    /* in 1st qtr : qtr 4 = qtr 3 of last era */
     1148    12572    2              BD(3) = BD(0) - %DAYS_ERA;
     1149    12573    2              U1(3) = U1(0) - %UTS_ERA;
     1150    12574    2              BD(2) = BD(3);
     1151    12575    2              U1(2) = U1(3);
     1152    12576    2              ELL = BD(3) + (2 * %DAYS_QTR);
     1153    12577    2              EUL = ELL + (3 * %DAYS_QTR);
     1154    12578    2              ELLU = U1(3) + (2 * %UTS_QTR);
     1155    12579    2              EULU = ELLU + (3 * %UTS_QTR);
     1156    12580    2              END;
     1157    12581    2           ELSE DO;         /* in 2nd or 3rd qtr : qtr 4 = qtr 0 of next era     */
     1158    12582    2              BD(3) = BD(0);
     1159    12583    2              U1(3) = U1(0);
     1160    12584    2              ELL = BD(0);
     1161    12585    2              ELLU = U1(0);
     1162    12586    2              EUL = ELL + (4 * %DAYS_QTR);
     1163    12587    2              EULU = ELLU + (4 * %UTS_QTR);
     1164    12588    2              END;
     1165    12589    1           CALL GHI$UTS (UTIME);
     1166    12590                       /* toss era and scale uts correctly, deduct time since boot*/
     1167    12591                                           /* adjust uts to correct era beginning     */
     1168    12592    1           UTIME = (UTI + (ERA * BITBIN('10000000'X))) * 4 - UTIME;
     1169    12593    1           IF G$MHJIT.BOOTUTS = 0 THEN
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:130  
     1170    12594    1              PS_LCP6STT.BOOT_UTS = UTIME;
     1171    12595    1           G$MHJIT.BOOTUTS = UTIME;
     1172    12596    1           G_BOOTTIME = UTIME;
     1173    12597    1           RETURN;
     1174    12598    1   END;

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:131  
--  Include file information  --

   UD_ERRORS_C.:E05TOU  is referenced.
   UM_ERRORS_C.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   P_FEP_M.:E05TOU  is referenced.
   G_HJIT_M.:E05TOU  is referenced.
   GU_MACROS_M.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure GUS$TIME.

   Procedure GUS$TIME requires 3232 words for executable code.
   Procedure GUS$TIME requires 108 words of local(AUTO) storage.

    No errors detected in file GUS$SCHD.:E05TSI    .

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:132  

 Object Unit name= GUS$TIME                                   File name= GUS$SCHD.:E05TOU
 UTS= JUL 29 '97 22:21:25.04 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Data  even  none    37     25  GUS$TIME
    1  RoData even  UTS     90     5A  GUS$TIME
    2   Proc  even  none  3232    CA0  GUS$TIME
    3  RoData even  none    36     24  GUS$TIME

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  GUS$TIME
     2    BB0                  yes      Std        1  GUS$SETTIME

  ****  Data defs  ****

 Sect HexLoc  Name                           Sect HexLoc  Name
    0      0  G_BOOTTIME                         0     1A  B_TICSDAY
    0     1C  V1SIZE                             0     20  V3SIZE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 GHI$UTS
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6D_MID
                       nStd      0 X6A_ARET
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:133  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     PS_LCP6STT                            G$MHJIT$                         r    G$ROS$
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:134  


      658        1        /*M*  Date and Time Service Procedure                              */
      659        2        /*T***********************************************************/
      660        3        /*T*                                                         */
      661        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      662        5        /*T*                                                         */
      663        6        /*T***********************************************************/
      664        7
      665        8        /*F*  NAME: GUS$TIME
      666        9              PURPOSE:  To process the M$TIME Monitor Service.
      667       10
      668       11        */
      669       12        /*D*
      670       13              NAME: GUS$TIME
      671       14              CALL:
      672       15                    Standard MCL Service Decoder call.
      673       16              DESCRIPTION:
      674       17                    This procedure processes the M$TIME service call.
      675       18                    It converts input defined by SOURCE type to an output
      676       19                    whose format is defined by DEST.
      677       20
      678       21
      679       22        */
      680       23
      681       24        GUS$TIME: PROC (PARM);

     24   2 000000  D380 0000 0000  xent GUS$TIME        LNJ,B5   X6A_AUTO_1
          2 000003       006C 0001                       DC       108,1

      682       25
      683       26
      684       27        %INCLUDE GU_MACROS_M;
      685      186 S      %INCLUDE GU_LCP6_M;
      686      187 S      %INCLUDE G_LCP6_E;
      687      188        %INCLUDE G_HJIT_M;
      688      333 S      %INCLUDE GH_LCP6_M;
      689      334        %INCLUDE P_FEP_M;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:135  
      690      772        %INCLUDE KL_MACRO_C;
      691     4124        %INCLUDE KL_AFCN_C;
      692     4225        %INCLUDE K_ID_E;
      693     4275        %INCLUDE UM_ERRORS_C;
      694     4309        %INCLUDE UD_ERRORS_C;
      695     4351
      696     4352
      697     4353
      698     4354
      699     4355    1   DCL   GHI$UTS ENTRY(1);
      700     4356
      701     4357    1   DCL G_BOOTTIME UBIN(32) STATIC SYMDEF INIT(0);
      702     4358        /*  Refer to AF_1293A-0 for a description of FEP eras       */
      703     4359        /*  Note that an era here is only 3 quarters of a full uts in length*/
      704     4360        /*  because first and last quarters overlap.  This makes code in */
      705     4361        /*  DATEUTS have to add another quarter to get the full UTS range*/
      706     4362    1   DCL   BD(0:3) UBIN(32) STATIC;          /* days from 1 AD to beginning of qtr */
      707     4363    1   DCL   U1(0:3) UBIN(32) STATIC;          /* uts to beginning of qtr            */
      708     4364    1   DCL   ELL UBIN(32) STATIC;              /* era lower limit                    */
      709     4365    1   DCL   ELLU UBIN(32) STATIC;             /* era lower limit uts                */
      710     4366    1   DCL   EUL UBIN(32) STATIC;              /* era upper limit                    */
      711     4367    1   DCL   EULU UBIN(32) STATIC;             /* era upper limit uts                */
      712     4368    1   DCL  ERA UBIN;                          /* temp era                           */
      713     4369    1   DCL  QTR UBIN;                          /* temp quarter                       */
      714     4370    1   DCL BASEDAYS UBIN(32) CONSTANT INIT (722528); /* Days to 1/1/78               */
      715     4371        /**/
      716     4372        %EQU  TICS_DAY = 648000;
      717     4373        %EQU  TICS_QTR = BITBIN ('40000000'X);
      718     4374        %EQU  TICS_ERA = TICS_QTR * 3;     /* each ERA has 3 quarters belonging to it */
      719     4375        %EQU  DAYS_QTR = TICS_QTR / TICS_DAY;
      720     4376        %EQU  DAYS_ERA = TICS_ERA / TICS_DAY;
      721     4377        %EQU  UTS_QTR  = MOD (TICS_QTR , TICS_DAY);
      722     4378        %EQU  UTS_ERA  = MOD (TICS_ERA , TICS_DAY);
      723     4379        /**/
      724     4380    1   DCL   B_TICSDAY STATIC SYMDEF UBIN(32) INIT(%TICS_DAY);
      725     4381        %EQU DPM = 306001;                      /* Days/month * 10000                 */
      726     4382    1   DCL   A UBIN(32) BASED CALIGNED;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:136  
      727     4383    1   DCL   UTIME UBIN(32);
      728     4384    1   DCL 1 UTIMEX REDEF UTIME,
      729     4385    1         2 QTR UBIN(2) UNAL,
      730     4386    1         2 * UBIN(30) UNAL;
      731     4387    1   DCL   UTI UBIN(32);
      732     4388    1   DCL 1 UTIX REDEF UTI,
      733     4389    1         2 QTR UBIN(4) UNAL,
      734     4390    1         2 UTS UBIN(28) UNAL;
      735     4391    1   DCL   I UBIN;
      736     4392    1   DCL   J UBIN;
      737     4393    1   DCL   K UBIN;
      738     4394    1   DCL   YP UBIN(32);
      739     4395    1   DCL   MP UBIN(32);
      740     4396    1   DCL   TMSZ UBIN;
      741     4397    1   DCL TMSZZ UBIN(8);
      742     4398    1   DCL   DTSZ UBIN;
      743     4399    1   DCL   TUNITS UBIN(32);
      744     4400    1   DCL   P1$ PTR;
      745     4401    1   DCL   ST3 CHAR(3) BASED;
      746     4402    1   DCL   ST5 CHAR(5) BASED;
      747     4403    1   DCL   ST6 CHAR(6) BASED;
      748     4404    1   DCL   ST8 CHAR(8) BASED;
      749     4405    1   DCL   ST10 CHAR(10) BASED;
      750     4406    1   DCL   STTMSZ CHAR(TMSZZ) BASED;
      751     4407    1   DCL   HSEC CHAR(2);                     /* 1/100 SEC                          */
      752     4408    1   DCL   SEC CHAR(2);
      753     4409    1   DCL   SECONDS CHAR(6);
      754     4410    1   DCL   MINS CHAR(2);
      755     4411    1   DCL   HRS CHAR(2);
      756     4412    1   DCL   MON CHAR(2);
      757     4413    1   DCL   DAY CHAR(2);
      758     4414    1   DCL   YR CHAR(2);
      759     4415    1   DCL   D1 UBIN(32);
      760     4416    1   DCL   WKD UBIN;                         /* DAY OF WEEK                        */
      761     4417    1   DCL   JDAY CHAR(3);                     /* JULIEN DAY                         */
      762     4418    1   DCL   JD UBIN;                          /*  "                                 */
      763     4419    1   DCL 1 B,
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:137  
      764     4420    1         2 MM UBIN,
      765     4421    1         2 DD UBIN,
      766     4422    1         2 YY UBIN,
      767     4423    1         2 HH UBIN,
      768     4424    1         2 MI UBIN,
      769     4425    1         2 SS UBIN,
      770     4426    1         2 SS00 UBIN;
      771     4427    1   DCL   DT(0:6) REDEF B UBIN;
      772     4428    1   DCL   ST(0:6) REDEF B SBIN;
      773     4429        /*                                                                    */
      774     4430    1   DCL   WKDAY(0:6) CONSTANT CHAR(3) INIT(
      775     4431    1              'SUN','MON','TUE','WED','THU','FRI','SAT');
      776     4432    1   DCL   MONTH(0:11) CONSTANT CHAR(4) INIT(
      777     4433    1              'JAN ','FEB ','MAR ','APR ','MAY ','JUN ','JUL ',
      778     4434    1              'AUG ','SEP ','OCT ','NOV ','DEC ');
      779     4435    1   DCL   MONS(0:12) CONSTANT UBIN INIT(
      780     4436    1              0,31,59,90,120,151,181,212,243,273,304,334,365);
      781     4437    1   DCL   LPS(0:4) UBIN CONSTANT INIT(790,2251,3712,5173,
      782     4438    1              6634);
      783     4439    1   DCL    V1SIZE(0:3) UBIN STATIC SYMDEF INIT(0,10,6,8);
      784     4440    1   DCL    V3SIZE(0:3) UBIN STATIC SYMDEF INIT(0,3,5,3);
      785     4441
      786     4442        %FPT_TIME (FPTN=FPT_TIMEV,VECTORS=NO,STCLASS="BASED(P1$)");
      787     4466        %G$MHJIT (STCLASS="BASED (G$MHJIT$)");
      788    11340        %K#ENTID_E;
      789    11359        %K#LYRID_E;
      790    11366        %PS_LCP6STT (STCLASS=SYMREF);
      791    11870        %VLP_ERRCODE (FPTN=SRCERR,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      792    11871                      STCLASS=CONSTANT,ERR#=%E$BADDT);
      793    11917        %VLP_ERRCODE (FPTN=V4ERR,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      794    11918                      STCLASS=CONSTANT,ERR#=%E$BADVECT4);
      795    11964        %VLP_ERRCODE (FPTN=V1ERR,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      796    11965                      STCLASS=CONSTANT,ERR#=%E$BADVECT1);
      797    12011        %VLP_ERRCODE (FPTN=V2ERR,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      798    12012                      STCLASS=CONSTANT,ERR#=%E$BADVECT2);
      799    12058        %VLP_ERRCODE (FPTN=V3ERR,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      800    12059                      STCLASS=CONSTANT,ERR#=%E$BADVECT3);
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:138  
      801    12105        %VLP_ERRCODE (FPTN=YRERR,FCG='GU',MID='S',MON='1'B,SEV=G_SEV_ERROR#,
      802    12106                      STCLASS=CONSTANT,ERR#=%E$YEARERR);
      803    12152
      804    12153    1   DCL G$MHJIT$ PTR SYMREF;
      805    12154
      806    12155        %GUD_HAND_PARAMS (FPTN=PARM);
      807    12231    1           P1$=PARM.PTRS.PAR1$;

  12231   2 000005  ECC7 0004                            LDB,B6   @PARM,AUTO
          2 000007  DCC6 0006                            LDB,B5   6,B6
          2 000009  DFC7 0018                            STB,B5   P1$,AUTO

      808    12232
      809    12233    1           B='0'B;                         /* Clear date, time values            */

  12233   2 00000B  5C0E                                 LDV,R5   14
          2 00000C  0021                                 ALR      ;
          2 00000D       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 00000F       4007 002A                                ALPHANUM(B,AUTO,,R5,FILL)

      810    12234
      811    12235        /*       Convert source data to binary date and time.     */
      812    12236
      813    12237    2           DO CASE (FPT_TIMEV.SOURCE);

  12237   2 000011  437F                                 CSYNC    s:12233+5,SPREL
          2 000012  B285                                 LLH,R3   ,B5
          2 000013  3D06                                 CMV,R3   6
          2 000014  0281 015E                            BGE      s:12263,PREL
          2 000016  A830 0000 001C  02                   LDR,R2   s:12237+11,R3
          2 000019  83A0 0000 0022  02                   JMP      s:12240,R2
          2 00001C       001A                            DC       s:12244,PREL
          2 00001D       0151                            DC       s:12263,PREL
          2 00001E       0000                            DC       s:12240,PREL
          2 00001F       000D                            DC       s:12242,PREL
          2 000020       0034                            DC       s:12248,PREL
          2 000021       004B                            DC       s:12252,PREL
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:139  

      814    12238
      815    12239    2            CASE(%G_TIME_ANS);

      816    12240    2              CALL ANSDATE(PARM.PTRS.PAR2$->A,PARM.PTRS.PAR3$->A) ALTRET(DTERR);

  12240   2 000022  CCC6 0008                            LDB,B4   8,B6
          2 000024  BCC6 000A                            LDB,B3   10,B6
          2 000026  BFC7 0036                            STB,B3   J+2,AUTO
          2 000028  CFC7 0034                            STB,B4   B+10,AUTO
          2 00002A  E3C0 062B                            LNJ,B6   s:0,PREL
          2 00002C       042A                            DC       s:12361,PREL
          2 00002D  0F81 0145                            B        s:12263,PREL

      817    12241    2            CASE (%G_TIME_LOCAL);

      818    12242    2              CALL LCLDATE(PARM.PTRS.PAR2$->A,PARM.PTRS.PAR3$->A) ALTRET(DTERR);

  12242   2 00002F  CCC6 0008                            LDB,B4   8,B6
          2 000031  BCC6 000A                            LDB,B3   10,B6
          2 000033  BFC7 0036                            STB,B3   J+2,AUTO
          2 000035  CFC7 0034                            STB,B4   B+10,AUTO
          2 000037  E3C0 0428                            LNJ,B6   s:0,PREL
          2 000039       041D                            DC       s:12361,PREL
          2 00003A  0F81 0138                            B        s:12263,PREL

      819    12243    2            CASE (%G_TIME_CLOCK);

      820    12244    2              CALL GHI$UTS(UTIME);

  12244   2 00003C  CBC7 0008                            LAB,B4   UTIME,AUTO
          2 00003E  CFC7 003E                            STB,B4   @J+2,AUTO
          2 000040  BBC7 003E                            LAB,B3   @J+2,AUTO
          2 000042  CBF0 0100                            LAB,B4   256,IMO
          2 000044  E380 0000 0000  xent                 LNJ,B6   GHI$UTS
          2 000047       0001                            DC       s:12245,PREL

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:140  
      821    12245    2              UTIME=UTIME+G$MHJIT.BOOTUTS;

  12245   2 000048  EC80 0000 0000  xsym                 LDB,B6   G$MHJIT$
          2 00004B  8CC7 0008                            LDI      UTIME,AUTO
          2 00004D  8446 035A                            AID      858,B6
          2 00004F  8D47 0008                            SDI      UTIME,AUTO

      822    12246    2              CALL UTSDATE;                /* Convert current time               */

  12246   2 000051  E3C0 06EC                            LNJ,B6   s:0,PREL
          2 000053       0001                            DC       s:12246+3,PREL
          2 000054  0F81 011E                            B        s:12263,PREL

      823    12247    2            CASE (%G_TIME_UTS);

      824    12248    2              CALL DSIZE(4,J) ALTRET(NOPS4);

  12248   2 000056  CBF0 0004                            LAB,B4   4,IMO
          2 000058  BBC7 000D                            LAB,B3   J,AUTO
          2 00005A  BFC7 003C                            STB,B3   @I+2,AUTO
          2 00005C  CFC7 003A                            STB,B4   HH+4,AUTO
          2 00005E  E3C0 0B34                            LNJ,B6   s:0,PREL
          2 000060       03ED                            DC       s:12359,PREL

      825    12249    2              UTIME=PARM.PTRS.PAR5$->A;    /* Convert input UTS                  */

  12249   2 000061  ECC7 0004                            LDB,B6   @PARM,AUTO
          2 000063  DCC6 000E                            LDB,B5   14,B6
          2 000065  8C85                                 LDI      ,B5
          2 000066  8D47 0008                            SDI      UTIME,AUTO

      826    12250    2              CALL UTSDATE;

  12250   2 000068  E3C0 06D5                            LNJ,B6   s:0,PREL
          2 00006A       0001                            DC       s:12250+3,PREL
          2 00006B  0F81 0107                            B        s:12263,PREL

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:141  
      827    12251    2            CASE (%G_TIME_TUN);

      828    12252    2              CALL DSIZE(4,J) ALTRET(NOPS4);

  12252   2 00006D  CBF0 0004                            LAB,B4   4,IMO
          2 00006F  BBC7 000D                            LAB,B3   J,AUTO
          2 000071  BFC7 003C                            STB,B3   @I+2,AUTO
          2 000073  CFC7 003A                            STB,B4   HH+4,AUTO
          2 000075  E3C0 0B1D                            LNJ,B6   s:0,PREL
          2 000077       03D6                            DC       s:12359,PREL

      829    12253    2              UTI=PARM.PTRS.PAR5$->A;      /* Get current time and substitute    */

  12253   2 000078  ECC7 0004                            LDB,B6   @PARM,AUTO
          2 00007A  DCC6 000E                            LDB,B5   14,B6
          2 00007C  8C85                                 LDI      ,B5
          2 00007D  8D47 000A                            SDI      UTI,AUTO

      830    12254    2              CALL GHI$UTS(UTIME);         /* input TUNs                         */

  12254   2 00007F  CBC7 0008                            LAB,B4   UTIME,AUTO
          2 000081  CFC7 003E                            STB,B4   @J+2,AUTO
          2 000083  BBC7 003E                            LAB,B3   @J+2,AUTO
          2 000085  CBF0 0100                            LAB,B4   256,IMO
          2 000087  E380 0000 0000  xent                 LNJ,B6   GHI$UTS
          2 00008A       0001                            DC       s:12255,PREL

      831    12255    2              UTIME=UTIME+G$MHJIT.BOOTUTS;

  12255   2 00008B  EC80 0000 0000  xsym                 LDB,B6   G$MHJIT$
          2 00008E  8CC7 0008                            LDI      UTIME,AUTO
          2 000090  8446 035A                            AID      858,B6
          2 000092  8D47 0008                            SDI      UTIME,AUTO

      832    12256    2              CALL UTSDATE;

  12256   2 000094  E3C0 06A9                            LNJ,B6   s:0,PREL
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:142  
          2 000096       0001                            DC       s:12257,PREL

      833    12257    2              B.SS00=MOD(UTI/10,100);

  12257   2 000097  EB80 0000 0000  03                   LAB,B6   0
          2 00009A  0027                                 CBD      ;
          2 00009B       0206 0000                                BINARY(0,B6,,2),;
          2 00009D       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 00009F  0027                                 CBD      ;
          2 0000A0       0407 000A                                BINARY(UTI,AUTO,,4),;
          2 0000A2       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 0000A4  002B                                 DDV      ;
          2 0000A5       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 0000A7       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 0000A9       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 0000AB  002A                                 CDB      ;
          2 0000AC       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 0000AE       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 0000B0  EB80 0000 0000  03                   LAB,B6   0
          2 0000B3  0027                                 CBD      ;
          2 0000B4       0206 0001                                BINARY(1,B6,,2),;
          2 0000B6       4C07 0052                                UNPACKED(@J+22,AUTO,,12,LEADING)
          2 0000B8  0027                                 CBD      ;
          2 0000B9       0407 0050                                BINARY(@J+20,AUTO,,4),;
          2 0000BB       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING)
          2 0000BD  002B                                 DDV      ;
          2 0000BE       4C07 0052                                UNPACKED(@J+22,AUTO,,12,LEADING),;
          2 0000C0       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING),;
          2 0000C2       4C07 005E                                UNPACKED(@J+34,AUTO,,12,LEADING)
          2 0000C4  002A                                 CDB      ;
          2 0000C5       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING),;
          2 0000C7       0407 0064                                BINARY(@J+40,AUTO,,4)
          2 0000C9  437F                                 CSYNC    s:12257+49,SPREL
          2 0000CA  E847 0065                            LDR,R6   @J+41,AUTO
          2 0000CC  EF47 0030                            STR,R6   B+6,AUTO

      834    12258    2              B.SS=MOD(UTI/1000,60);
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:143  

  12258   2 0000CE  EB80 0000 0000  03                   LAB,B6   0
          2 0000D1  0027                                 CBD      ;
          2 0000D2       0206 0002                                BINARY(2,B6,,2),;
          2 0000D4       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 0000D6  0027                                 CBD      ;
          2 0000D7       0407 000A                                BINARY(UTI,AUTO,,4),;
          2 0000D9       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 0000DB  002B                                 DDV      ;
          2 0000DC       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 0000DE       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 0000E0       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 0000E2  002A                                 CDB      ;
          2 0000E3       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 0000E5       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 0000E7  EB80 0000 0000  03                   LAB,B6   0
          2 0000EA  0027                                 CBD      ;
          2 0000EB       0206 0003                                BINARY(3,B6,,2),;
          2 0000ED       4C07 0052                                UNPACKED(@J+22,AUTO,,12,LEADING)
          2 0000EF  0027                                 CBD      ;
          2 0000F0       0407 0050                                BINARY(@J+20,AUTO,,4),;
          2 0000F2       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING)
          2 0000F4  002B                                 DDV      ;
          2 0000F5       4C07 0052                                UNPACKED(@J+22,AUTO,,12,LEADING),;
          2 0000F7       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING),;
          2 0000F9       4C07 005E                                UNPACKED(@J+34,AUTO,,12,LEADING)
          2 0000FB  002A                                 CDB      ;
          2 0000FC       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING),;
          2 0000FE       0407 0064                                BINARY(@J+40,AUTO,,4)
          2 000100  437F                                 CSYNC    s:12258+49,SPREL
          2 000101  D847 0065                            LDR,R5   @J+41,AUTO
          2 000103  DF47 002F                            STR,R5   B+5,AUTO

      835    12259    2              B.MI=MOD(UTI/60000,60);

  12259   2 000105  EB80 0000 0000  03                   LAB,B6   0
          2 000108  0027                                 CBD      ;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:144  
          2 000109       0406 0004                                BINARY(4,B6,,4),;
          2 00010B       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 00010D  0027                                 CBD      ;
          2 00010E       0407 000A                                BINARY(UTI,AUTO,,4),;
          2 000110       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 000112  002B                                 DDV      ;
          2 000113       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 000115       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 000117       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 000119  002A                                 CDB      ;
          2 00011A       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 00011C       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 00011E  EB80 0000 0000  03                   LAB,B6   0
          2 000121  0027                                 CBD      ;
          2 000122       0206 0003                                BINARY(3,B6,,2),;
          2 000124       4C07 0052                                UNPACKED(@J+22,AUTO,,12,LEADING)
          2 000126  0027                                 CBD      ;
          2 000127       0407 0050                                BINARY(@J+20,AUTO,,4),;
          2 000129       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING)
          2 00012B  002B                                 DDV      ;
          2 00012C       4C07 0052                                UNPACKED(@J+22,AUTO,,12,LEADING),;
          2 00012E       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING),;
          2 000130       4C07 005E                                UNPACKED(@J+34,AUTO,,12,LEADING)
          2 000132  002A                                 CDB      ;
          2 000133       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING),;
          2 000135       0407 0064                                BINARY(@J+40,AUTO,,4)
          2 000137  437F                                 CSYNC    s:12259+49,SPREL
          2 000138  C847 0065                            LDR,R4   @J+41,AUTO
          2 00013A  CF47 002E                            STR,R4   B+4,AUTO

      836    12260    2              B.HH=MOD(UTI/3600000,24);

  12260   2 00013C  EB80 0000 0000  03                   LAB,B6   0
          2 00013F  0027                                 CBD      ;
          2 000140       0406 0006                                BINARY(6,B6,,4),;
          2 000142       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 000144  0027                                 CBD      ;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:145  
          2 000145       0407 000A                                BINARY(UTI,AUTO,,4),;
          2 000147       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 000149  002B                                 DDV      ;
          2 00014A       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 00014C       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 00014E       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 000150  002A                                 CDB      ;
          2 000151       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 000153       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 000155  EB80 0000 0000  03                   LAB,B6   0
          2 000158  0027                                 CBD      ;
          2 000159       0206 0008                                BINARY(8,B6,,2),;
          2 00015B       4C07 0052                                UNPACKED(@J+22,AUTO,,12,LEADING)
          2 00015D  0027                                 CBD      ;
          2 00015E       0407 0050                                BINARY(@J+20,AUTO,,4),;
          2 000160       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING)
          2 000162  002B                                 DDV      ;
          2 000163       4C07 0052                                UNPACKED(@J+22,AUTO,,12,LEADING),;
          2 000165       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING),;
          2 000167       4C07 005E                                UNPACKED(@J+34,AUTO,,12,LEADING)
          2 000169  002A                                 CDB      ;
          2 00016A       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING),;
          2 00016C       0407 0064                                BINARY(@J+40,AUTO,,4)
          2 00016E  437F                                 CSYNC    s:12260+49,SPREL
          2 00016F  B847 0065                            LDR,R3   @J+41,AUTO
          2 000171  BF47 002D                            STR,R3   B+3,AUTO

      837    12261    2            END;

      838    12262
      839    12263    1           JD=MONS(B.MM-1)+B.DD;

  12263   2 000173  B847 002A                            LDR,R3   B,AUTO
          2 000175  E830 0000 0024  01                   LDR,R6   MONTH+23,R3
          2 000178  EA47 002B                            ADD,R6   B+1,AUTO
          2 00017A  EF47 0029                            STR,R6   JD,AUTO

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:146  
      840    12264    1           IF (MOD(B.YY,4)=0) AND (B.MM > 2) THEN

  12264   2 00017C  D847 002C                            LDR,R5   B+2,AUTO
          2 00017E  D570 0003                            AND,R5   3,IMO
          2 000180  5981 0006                            BNEZ,R5  s:12266,PREL
          2 000182  3D02                                 CMV,R3   2
          2 000183  0381 0003                            BLE      s:12266,PREL

      841    12265    1              JD=JD+1;

  12265   2 000185  8AC7 0029                            INC      JD,AUTO

      842    12266    1           YP=B.YY*365;

  12266   2 000187  F847 002C                            LDR,R7   B+2,AUTO
          2 000189  6C00                                 LDV,R6   0
          2 00018A  9B80 0000 0009  03                   LAB,B1   +9
          2 00018D  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000190  8D47 000F                            SDI      YP,AUTO

      843    12267    1           D1=YP+(B.YY-1)/4 +JD;

  12267   2 000192  F847 002C                            LDR,R7   B+2,AUTO
          2 000194  6C00                                 LDV,R6   0
          2 000195  8470 FFFF FFFF                       AID      -1,IMO
          2 000198  F370 0004                            DIV,R7   4,IMO
          2 00019A  E857                                 LDR,R6   R7
          2 00019B  70F0                                 DAR,R7   16
          2 00019C  8447 000F                            AID      YP,AUTO
          2 00019E  8D47 003E                            SDI      @J+2,AUTO
          2 0001A0  F847 0029                            LDR,R7   JD,AUTO
          2 0001A2  6C00                                 LDV,R6   0
          2 0001A3  8447 003E                            AID      @J+2,AUTO
          2 0001A5  8D47 0024                            SDI      D1,AUTO

      844    12268    1           WKD=MOD(D1,7);                  /* Day of the week                    */

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:147  
  12268   2 0001A7  EB80 0000 0000  03                   LAB,B6   0
          2 0001AA  0027                                 CBD      ;
          2 0001AB       0206 000B                                BINARY(11,B6,,2),;
          2 0001AD       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 0001AF  0027                                 CBD      ;
          2 0001B0       0407 0024                                BINARY(D1,AUTO,,4),;
          2 0001B2       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 0001B4  002B                                 DDV      ;
          2 0001B5       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 0001B7       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 0001B9       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 0001BB  002A                                 CDB      ;
          2 0001BC       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 0001BE       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 0001C0  437F                                 CSYNC    s:12268+24,SPREL
          2 0001C1  D847 0051                            LDR,R5   @J+21,AUTO
          2 0001C3  DF47 0026                            STR,R5   WKD,AUTO

      845    12269    1           CALL BINCHAR(SEC,B.SS);

  12269   2 0001C5  F847 002F                            LDR,R7   B+5,AUTO
          2 0001C7  6C00                                 LDV,R6   0
          2 0001C8  8D47 003E                            SDI      @J+2,AUTO
          2 0001CA  0027                                 CBD      ;
          2 0001CB       0407 003E                                BINARY(@J+2,AUTO,,4),;
          2 0001CD       0207 001B                                UNPACKED(SEC,AUTO,,2,UNSIGNED)

      846    12270    1           CALL BINCHAR(HSEC,B.SS00);

  12270   2 0001CF  F847 0030                            LDR,R7   B+6,AUTO
          2 0001D1  6C00                                 LDV,R6   0
          2 0001D2  437F                                 CSYNC    s:12270+2,SPREL
          2 0001D3  8D47 003E                            SDI      @J+2,AUTO
          2 0001D5  0027                                 CBD      ;
          2 0001D6       0407 003E                                BINARY(@J+2,AUTO,,4),;
          2 0001D8       0207 001A                                UNPACKED(HSEC,AUTO,,2,UNSIGNED)

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:148  
      847    12271    1           CALL BINCHAR(HRS,B.HH);

  12271   2 0001DA  F847 002D                            LDR,R7   B+3,AUTO
          2 0001DC  6C00                                 LDV,R6   0
          2 0001DD  437F                                 CSYNC    s:12271+2,SPREL
          2 0001DE  8D47 003E                            SDI      @J+2,AUTO
          2 0001E0  0027                                 CBD      ;
          2 0001E1       0407 003E                                BINARY(@J+2,AUTO,,4),;
          2 0001E3       0207 0020                                UNPACKED(HRS,AUTO,,2,UNSIGNED)

      848    12272    1           CALL BINCHAR(MINS,B.MI);

  12272   2 0001E5  F847 002E                            LDR,R7   B+4,AUTO
          2 0001E7  6C00                                 LDV,R6   0
          2 0001E8  437F                                 CSYNC    s:12272+2,SPREL
          2 0001E9  8D47 003E                            SDI      @J+2,AUTO
          2 0001EB  0027                                 CBD      ;
          2 0001EC       0407 003E                                BINARY(@J+2,AUTO,,4),;
          2 0001EE       0207 001F                                UNPACKED(MINS,AUTO,,2,UNSIGNED)

      849    12273    1           CALL BINCHAR(DAY,B.DD);

  12273   2 0001F0  F847 002B                            LDR,R7   B+1,AUTO
          2 0001F2  6C00                                 LDV,R6   0
          2 0001F3  437F                                 CSYNC    s:12273+2,SPREL
          2 0001F4  8D47 003E                            SDI      @J+2,AUTO
          2 0001F6  0027                                 CBD      ;
          2 0001F7       0407 003E                                BINARY(@J+2,AUTO,,4),;
          2 0001F9       0207 0022                                UNPACKED(DAY,AUTO,,2,UNSIGNED)

      850    12274    1           CALL BINCHAR(MON,B.MM);

  12274   2 0001FB  F847 002A                            LDR,R7   B,AUTO
          2 0001FD  6C00                                 LDV,R6   0
          2 0001FE  437F                                 CSYNC    s:12274+2,SPREL
          2 0001FF  8D47 003E                            SDI      @J+2,AUTO
          2 000201  0027                                 CBD      ;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:149  
          2 000202       0407 003E                                BINARY(@J+2,AUTO,,4),;
          2 000204       0207 0021                                UNPACKED(MON,AUTO,,2,UNSIGNED)

      851    12275    1           CALL BINCHAR(YR,B.YY);

  12275   2 000206  F847 002C                            LDR,R7   B+2,AUTO
          2 000208  6C00                                 LDV,R6   0
          2 000209  437F                                 CSYNC    s:12275+2,SPREL
          2 00020A  8D47 003E                            SDI      @J+2,AUTO
          2 00020C  0027                                 CBD      ;
          2 00020D       0407 003E                                BINARY(@J+2,AUTO,,4),;
          2 00020F       0207 0023                                UNPACKED(YR,AUTO,,2,UNSIGNED)

      852    12276    1           CALL BINCHAR(JDAY,JD);

  12276   2 000211  F847 0029                            LDR,R7   JD,AUTO
          2 000213  6C00                                 LDV,R6   0
          2 000214  437F                                 CSYNC    s:12276+2,SPREL
          2 000215  8D47 003E                            SDI      @J+2,AUTO
          2 000217  0027                                 CBD      ;
          2 000218       0407 003E                                BINARY(@J+2,AUTO,,4),;
          2 00021A       0307 0027                                UNPACKED(JDAY,AUTO,,3,UNSIGNED)

      853    12277
      854    12278        /*    Format date and time for output                              */
      855    12279
      856    12280    2           DO CASE (FPT_TIMEV.DEST);

  12280   2 00021C  ECC7 0018                            LDB,B6   P1$,AUTO
          2 00021E  437F                                 CSYNC    s:12280+1,SPREL
          2 00021F  B806                                 LDR,R3   ,B6
          2 000220  B570 00FF                            AND,R3   255,IMO
          2 000222  3D06                                 CMV,R3   6
          2 000223  0281 01E8                            BGE      s:12319,PREL
          2 000225  A830 0000 022B  02                   LDR,R2   s:12280+15,R3
          2 000228  83A0 0000 0231  02                   JMP      s:12283,R2
          2 00022B       01DB                            DC       s:12319,PREL
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:150  
          2 00022C       001D                            DC       s:12290,PREL
          2 00022D       001D                            DC       s:12290,PREL
          2 00022E       001D                            DC       s:12290,PREL
          2 00022F       01DB                            DC       s:12319,PREL
          2 000230       0000                            DC       s:12283,PREL

      857    12281    2            CASE(%G_TIME_UTS);

      858    12282    2            CASE (%G_TIME_TUN);

      859    12283    2              CALL DSIZE(4,J) ALTRET(NOPS4);

  12283   2 000231  DBF0 0004                            LAB,B5   4,IMO
          2 000233  CBC7 000D                            LAB,B4   J,AUTO
          2 000235  CFC7 003C                            STB,B4   @I+2,AUTO
          2 000237  DFC7 003A                            STB,B5   HH+4,AUTO
          2 000239  E3C0 0959                            LNJ,B6   s:0,PREL
          2 00023B       0212                            DC       s:12359,PREL

      860    12284    2              IF J ~= 4 THEN

  12284   2 00023C  E847 000D                            LDR,R6   J,AUTO
          2 00023E  6D04                                 CMV,R6   4
          2 00023F  0981 020D                            BNE      s:12359,PREL

      861    12285    2                 GOTO NOPS4;
      862    12286    2              CALL DATEUTS ALTRET(BADYR);

  12286   2 000241  E3C0 0787                            LNJ,B6   s:0,PREL
          2 000243       01EF                            DC       s:12353,PREL

      863    12287    2              PARM.PTRS.PAR5$->A=TUNITS;

  12287   2 000244  ECC7 0004                            LDB,B6   @PARM,AUTO
          2 000246  DCC6 000E                            LDB,B5   14,B6
          2 000248  8CC7 0016                            LDI      TUNITS,AUTO
          2 00024A  8D05                                 SDI      ,B5
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:151  

      864    12288    2              RETURN;

  12288   2 00024B  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      865    12289    2            CASE (%G_TIME_EXT,%G_TIME_ANS,%G_TIME_LOCAL);

      866    12290    2              CALL DSIZE(1,J) ALTRET(TM2);

  12290   2 00024E  DBF0 0001                            LAB,B5   1,IMO
          2 000250  CBC7 000D                            LAB,B4   J,AUTO
          2 000252  CFC7 003C                            STB,B4   @I+2,AUTO
          2 000254  DFC7 003A                            STB,B5   HH+4,AUTO
          2 000256  E3C0 093C                            LNJ,B6   s:0,PREL
          2 000258       0098                            DC       s:12300,PREL

      867    12291    2              IF J < V1SIZE(FPT_TIMEV.DEST) THEN

  12291   2 000259  ECC7 0018                            LDB,B6   P1$,AUTO
          2 00025B  B806                                 LDR,R3   ,B6
          2 00025C  B570 00FF                            AND,R3   255,IMO
          2 00025E  E847 000D                            LDR,R6   J,AUTO
          2 000260  E930 0000 001C  00                   CMR,R6   V1SIZE,R3
          2 000263  0201 01D7                            BL       s:12355,PREL

      868    12292    2                 GOTO BADV1;
      869    12293    3              DO CASE (FPT_TIMEV.DEST);

  12293   2 000265  3D04                                 CMV,R3   4
          2 000266  0281 0089                            BGE      s:12300,PREL
          2 000268  A830 0000 026E  02                   LDR,R2   s:12293+9,R3
          2 00026B  83A0 0000 0272  02                   JMP      s:12295,R2
          2 00026E       007E                            DC       s:12300,PREL
          2 00026F       0050                            DC       s:12299,PREL
          2 000270       0000                            DC       s:12295,PREL
          2 000271       0022                            DC       s:12297,PREL

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:152  
      870    12294    3               CASE(%G_TIME_ANS);

      871    12295    3                 CALL CONCAT(PARM.CPTRS.PAR2$->ST6,YR,MON,DAY);

  12295   2 000272  DCC7 0004                            LDB,B5   @PARM,AUTO
          2 000274  8CC5 0008                            LDI      8,B5
          2 000276  9856                                 LDR,R1   R6
          2 000277  E570 7FFF                            AND,R6   32767,IMO
          2 000279  8D47 003E                            SDI      @J+2,AUTO
          2 00027B  CCC7 003E                            LDB,B4   @J+2,AUTO
          2 00027D  104F                                 SOR,R1   15
          2 00027E  AB87                                 LAB,B2   ,AUTO
          2 00027F  2C46                                 LDV,R2   70
          2 000280  6C02                                 LDV,R6   2
          2 000281  BB84                                 LAB,B3   ,B4
          2 000282  B851                                 LDR,R3   R1
          2 000283  0008                                 MMM
          2 000284  AB87                                 LAB,B2   ,AUTO
          2 000285  2C42                                 LDV,R2   66
          2 000286  6C02                                 LDV,R6   2
          2 000287  BB84                                 LAB,B3   ,B4
          2 000288  B851                                 LDR,R3   R1
          2 000289  3E02                                 ADV,R3   2
          2 00028A  0008                                 MMM
          2 00028B  AB87                                 LAB,B2   ,AUTO
          2 00028C  2C44                                 LDV,R2   68
          2 00028D  6C02                                 LDV,R6   2
          2 00028E  BB84                                 LAB,B3   ,B4
          2 00028F  B851                                 LDR,R3   R1
          2 000290  3E04                                 ADV,R3   4
          2 000291  0008                                 MMM
          2 000292  0F81 005D                            B        s:12300,PREL

      872    12296    3               CASE (%G_TIME_LOCAL);

      873    12297    3                 CALL CONCAT(PARM.CPTRS.PAR2$->ST8,MON,'/',DAY,'/',YR);

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:153  
  12297   2 000294  DCC7 0004                            LDB,B5   @PARM,AUTO
          2 000296  8CC5 0008                            LDI      8,B5
          2 000298  9856                                 LDR,R1   R6
          2 000299  E570 7FFF                            AND,R6   32767,IMO
          2 00029B  8D47 003E                            SDI      @J+2,AUTO
          2 00029D  CCC7 003E                            LDB,B4   @J+2,AUTO
          2 00029F  104F                                 SOR,R1   15
          2 0002A0  AB87                                 LAB,B2   ,AUTO
          2 0002A1  2C42                                 LDV,R2   66
          2 0002A2  6C02                                 LDV,R6   2
          2 0002A3  BB84                                 LAB,B3   ,B4
          2 0002A4  B851                                 LDR,R3   R1
          2 0002A5  0008                                 MMM
          2 0002A6  6C2F                                 LDV,R6   47
          2 0002A7  9F47 0040                            STR,R1   @J+4,AUTO
          2 0002A9  1E02                                 ADV,R1   2
          2 0002AA  E794                                 STH,R6   ,B4,R1
          2 0002AB  AB87                                 LAB,B2   ,AUTO
          2 0002AC  2C44                                 LDV,R2   68
          2 0002AD  6C02                                 LDV,R6   2
          2 0002AE  BB84                                 LAB,B3   ,B4
          2 0002AF  B847 0040                            LDR,R3   @J+4,AUTO
          2 0002B1  3E03                                 ADV,R3   3
          2 0002B2  0008                                 MMM
          2 0002B3  6C2F                                 LDV,R6   47
          2 0002B4  B847 0040                            LDR,R3   @J+4,AUTO
          2 0002B6  3E05                                 ADV,R3   5
          2 0002B7  E7B4                                 STH,R6   ,B4,R3
          2 0002B8  AB87                                 LAB,B2   ,AUTO
          2 0002B9  2C46                                 LDV,R2   70
          2 0002BA  6C02                                 LDV,R6   2
          2 0002BB  BB84                                 LAB,B3   ,B4
          2 0002BC  B847 0040                            LDR,R3   @J+4,AUTO
          2 0002BE  3E06                                 ADV,R3   6
          2 0002BF  0008                                 MMM
          2 0002C0  0F81 002F                            B        s:12300,PREL

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:154  
      874    12298    3               CASE (%G_TIME_EXT);

      875    12299    3                 CALL CONCAT(PARM.CPTRS.PAR2$->ST10,MONTH(B.MM-1),DAY,' ''',YR);

  12299   2 0002C2  DCC7 0004                            LDB,B5   @PARM,AUTO
          2 0002C4  8CC5 0008                            LDI      8,B5
          2 0002C6  9856                                 LDR,R1   R6
          2 0002C7  E570 7FFF                            AND,R6   32767,IMO
          2 0002C9  8D47 003E                            SDI      @J+2,AUTO
          2 0002CB  CCC7 003E                            LDB,B4   @J+2,AUTO
          2 0002CD  104F                                 SOR,R1   15
          2 0002CE  AB80 0000 0000  01                   LAB,B2   BASEDAYS
          2 0002D1  A847 002A                            LDR,R2   B,AUTO
          2 0002D3  2002                                 SOL,R2   2
          2 0002D4  2E16                                 ADV,R2   22
          2 0002D5  6C04                                 LDV,R6   4
          2 0002D6  BB84                                 LAB,B3   ,B4
          2 0002D7  B851                                 LDR,R3   R1
          2 0002D8  0008                                 MMM
          2 0002D9  AB87                                 LAB,B2   ,AUTO
          2 0002DA  2C44                                 LDV,R2   68
          2 0002DB  6C02                                 LDV,R6   2
          2 0002DC  BB84                                 LAB,B3   ,B4
          2 0002DD  B851                                 LDR,R3   R1
          2 0002DE  3E04                                 ADV,R3   4
          2 0002DF  0008                                 MMM
          2 0002E0  AB80 0000 0055  01                   LAB,B2   DELM+4
          2 0002E3  2C00                                 LDV,R2   0
          2 0002E4  6C02                                 LDV,R6   2
          2 0002E5  BB84                                 LAB,B3   ,B4
          2 0002E6  B851                                 LDR,R3   R1
          2 0002E7  3E06                                 ADV,R3   6
          2 0002E8  0008                                 MMM
          2 0002E9  AB87                                 LAB,B2   ,AUTO
          2 0002EA  2C46                                 LDV,R2   70
          2 0002EB  6C02                                 LDV,R6   2
          2 0002EC  BB84                                 LAB,B3   ,B4
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:155  
          2 0002ED  B851                                 LDR,R3   R1
          2 0002EE  3E08                                 ADV,R3   8
          2 0002EF  0008                                 MMM

      876    12300    3               END;

      877    12301    2   TM2:       CALL DSIZE(2,TMSZ) ALTRET(TM3);

  12301   2 0002F0  EBF0 0002            TM2             LAB,B6   2,IMO
          2 0002F2  DBC7 0013                            LAB,B5   TMSZ,AUTO
          2 0002F4  DFC7 003C                            STB,B5   @I+2,AUTO
          2 0002F6  EFC7 003A                            STB,B6   HH+4,AUTO
          2 0002F8  E3C0 089A                            LNJ,B6   s:0,PREL
          2 0002FA       00C3                            DC       s:12309,PREL

      878    12302    2              TMSZZ=TMSZ;

  12302   2 0002FB  E847 0013                            LDR,R6   TMSZ,AUTO
          2 0002FD  E7C7 0014                            STH,R6   TMSZZ,AUTO

      879    12303    3              DO CASE (FPT_TIMEV.DEST);

  12303   2 0002FF  ECC7 0018                            LDB,B6   P1$,AUTO
          2 000301  B806                                 LDR,R3   ,B6
          2 000302  B570 00FF                            AND,R3   255,IMO
          2 000304  3D04                                 CMV,R3   4
          2 000305  0281 00B7                            BGE      s:12309,PREL
          2 000307  A830 0000 030D  02                   LDR,R2   s:12303+14,R3
          2 00030A  83A0 0000 0311  02                   JMP      s:12305,R2
          2 00030D       00AC                            DC       s:12309,PREL
          2 00030E       0048                            DC       s:12307,PREL
          2 00030F       0000                            DC       s:12305,PREL
          2 000310       0048                            DC       s:12307,PREL

      880    12304    3               CASE (%G_TIME_ANS);

      881    12305    3                 CALL CONCAT(PARM.CPTRS.PAR3$->STTMSZ,HRS,MINS,SEC,HSEC);
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:156  

  12305   2 000311  DCC7 0004                            LDB,B5   @PARM,AUTO
          2 000313  8CC5 000A                            LDI      10,B5
          2 000315  9856                                 LDR,R1   R6
          2 000316  E570 7FFF                            AND,R6   32767,IMO
          2 000318  8D47 003E                            SDI      @J+2,AUTO
          2 00031A  CCC7 003E                            LDB,B4   @J+2,AUTO
          2 00031C  104F                                 SOR,R1   15
          2 00031D  D2C7 0014                            LLH,R5   TMSZZ,AUTO
          2 00031F  DA70 2000                            ADD,R5   8192,IMO
          2 000321  0021                                 ALR      ;
          2 000322       4207 0020                                ALPHANUM(HRS,AUTO,,2),;
          2 000324       4014 0000                                ALPHANUM(0,B4,R1,,R5,FILL)
          2 000326  437F                                 CSYNC    s:12305+20,SPREL
          2 000327  E2C7 0014                            LLH,R6   TMSZZ,AUTO
          2 000329  6003                                 SOL,R6   3
          2 00032A  6EF0                                 ADV,R6   -16
          2 00032B  6901 002A                            BEZ,R6   s:12305+69,PREL
          2 00032D  D2C7 0014                            LLH,R5   TMSZZ,AUTO
          2 00032F  DA70 1FFE                            ADD,R5   8190,IMO
          2 000331  0021                                 ALR      ;
          2 000332       4207 001F                                ALPHANUM(MINS,AUTO,,2),;
          2 000334       4014 0001                                ALPHANUM(1,B4,R1,,R5,FILL)
          2 000336  437F                                 CSYNC    s:12305+36,SPREL
          2 000337  E2C7 0014                            LLH,R6   TMSZZ,AUTO
          2 000339  6003                                 SOL,R6   3
          2 00033A  6EE0                                 ADV,R6   -32
          2 00033B  6901 001A                            BEZ,R6   s:12305+69,PREL
          2 00033D  D2C7 0014                            LLH,R5   TMSZZ,AUTO
          2 00033F  DA70 1FFC                            ADD,R5   8188,IMO
          2 000341  0021                                 ALR      ;
          2 000342       4207 001B                                ALPHANUM(SEC,AUTO,,2),;
          2 000344       4014 0002                                ALPHANUM(2,B4,R1,,R5,FILL)
          2 000346  437F                                 CSYNC    s:12305+52,SPREL
          2 000347  E2C7 0014                            LLH,R6   TMSZZ,AUTO
          2 000349  6003                                 SOL,R6   3
          2 00034A  6ED0                                 ADV,R6   -48
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:157  
          2 00034B  6901 000A                            BEZ,R6   s:12305+69,PREL
          2 00034D  D2C7 0014                            LLH,R5   TMSZZ,AUTO
          2 00034F  DA70 1FFA                            ADD,R5   8186,IMO
          2 000351  0021                                 ALR      ;
          2 000352       4207 001A                                ALPHANUM(HSEC,AUTO,,2),;
          2 000354       4014 0003                                ALPHANUM(3,B4,R1,,R5,FILL)
          2 000356  437F                                 CSYNC    s:12305+68,SPREL
          2 000357  0F81 0065                            B        s:12309,PREL

      882    12306    3               CASE (%G_TIME_LOCAL,%G_TIME_EXT);

      883    12307    3                 CALL CONCAT(SECONDS,SEC,'.',HSEC);

  12307   2 000359  AB87                                 LAB,B2   ,AUTO
          2 00035A  2C36                                 LDV,R2   54
          2 00035B  6C02                                 LDV,R6   2
          2 00035C  BB87                                 LAB,B3   ,AUTO
          2 00035D  3C38                                 LDV,R3   56
          2 00035E  0008                                 MMM
          2 00035F  6C2E                                 LDV,R6   46
          2 000360  E7C7 001D                            STH,R6   SECONDS+1,AUTO
          2 000362  0021                                 ALR      ;
          2 000363       4207 001A                                ALPHANUM(HSEC,AUTO,,2),;
          2 000365       C307 001D                                ALPHANUM(SECONDS+1,AUTO,1,3,FILL)

      884    12308    3                 CALL CONCAT(PARM.CPTRS.PAR3$->STTMSZ,HRS,':',MINS,':',SECONDS);

  12308   2 000367  ECC7 0004                            LDB,B6   @PARM,AUTO
          2 000369  437F                                 CSYNC    s:12308+1,SPREL
          2 00036A  8CC6 000A                            LDI      10,B6
          2 00036C  B856                                 LDR,R3   R6
          2 00036D  E570 7FFF                            AND,R6   32767,IMO
          2 00036F  8D47 003E                            SDI      @J+2,AUTO
          2 000371  DCC7 003E                            LDB,B5   @J+2,AUTO
          2 000373  304F                                 SOR,R3   15
          2 000374  D2C7 0014                            LLH,R5   TMSZZ,AUTO
          2 000376  DA70 2000                            ADD,R5   8192,IMO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:158  
          2 000378  0021                                 ALR      ;
          2 000379       4207 0020                                ALPHANUM(HRS,AUTO,,2),;
          2 00037B       4035 0000                                ALPHANUM(0,B5,R3,,R5,FILL)
          2 00037D  437F                                 CSYNC    s:12308+21,SPREL
          2 00037E  E2C7 0014                            LLH,R6   TMSZZ,AUTO
          2 000380  6003                                 SOL,R6   3
          2 000381  6EF0                                 ADV,R6   -16
          2 000382  6901 003A                            BEZ,R6   s:12309,PREL
          2 000384  D2C7 0014                            LLH,R5   TMSZZ,AUTO
          2 000386  DA70 1FFE                            ADD,R5   8190,IMO
          2 000388  0021                                 ALR      ;
          2 000389       4178 3A00                                ALPHANUM('3A00'X,IMO,,1),;
          2 00038B       4035 0001                                ALPHANUM(1,B5,R3,,R5,FILL)
          2 00038D  437F                                 CSYNC    s:12308+37,SPREL
          2 00038E  E2C7 0014                            LLH,R6   TMSZZ,AUTO
          2 000390  6003                                 SOL,R6   3
          2 000391  6EE8                                 ADV,R6   -24
          2 000392  6901 002A                            BEZ,R6   s:12309,PREL
          2 000394  D2C7 0014                            LLH,R5   TMSZZ,AUTO
          2 000396  DA70 1FFD                            ADD,R5   8189,IMO
          2 000398  0021                                 ALR      ;
          2 000399       4207 001F                                ALPHANUM(MINS,AUTO,,2),;
          2 00039B       C035 0001                                ALPHANUM(1,B5,R3,1,R5,FILL)
          2 00039D  437F                                 CSYNC    s:12308+53,SPREL
          2 00039E  E2C7 0014                            LLH,R6   TMSZZ,AUTO
          2 0003A0  6003                                 SOL,R6   3
          2 0003A1  6ED8                                 ADV,R6   -40
          2 0003A2  6901 001A                            BEZ,R6   s:12309,PREL
          2 0003A4  D2C7 0014                            LLH,R5   TMSZZ,AUTO
          2 0003A6  DA70 1FFB                            ADD,R5   8187,IMO
          2 0003A8  0021                                 ALR      ;
          2 0003A9       4178 3A00                                ALPHANUM('3A00'X,IMO,,1),;
          2 0003AB       C035 0002                                ALPHANUM(2,B5,R3,1,R5,FILL)
          2 0003AD  437F                                 CSYNC    s:12308+69,SPREL
          2 0003AE  E2C7 0014                            LLH,R6   TMSZZ,AUTO
          2 0003B0  6003                                 SOL,R6   3
          2 0003B1  6ED0                                 ADV,R6   -48
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:159  
          2 0003B2  6901 000A                            BEZ,R6   s:12309,PREL
          2 0003B4  D2C7 0014                            LLH,R5   TMSZZ,AUTO
          2 0003B6  DA70 1FFA                            ADD,R5   8186,IMO
          2 0003B8  0021                                 ALR      ;
          2 0003B9       4607 001C                                ALPHANUM(SECONDS,AUTO,,6),;
          2 0003BB       4035 0003                                ALPHANUM(3,B5,R3,,R5,FILL)

      885    12309    3               END;

      886    12310    2   TM3:       CALL DSIZE(3,J) ALTRET(UT);

  12310   2 0003BD  EBF0 0003            TM3             LAB,B6   3,IMO
          2 0003BF  DBC7 000D                            LAB,B5   J,AUTO
          2 0003C1  437F                                 CSYNC    s:12309+3,SPREL
          2 0003C2  DFC7 003C                            STB,B5   @I+2,AUTO
          2 0003C4  EFC7 003A                            STB,B6   HH+4,AUTO
          2 0003C6  E3C0 07CC                            LNJ,B6   s:0,PREL
          2 0003C8       0044                            DC       s:12319,PREL

      887    12311    2              IF J < V3SIZE(FPT_TIMEV.DEST) THEN

  12311   2 0003C9  ECC7 0018                            LDB,B6   P1$,AUTO
          2 0003CB  B806                                 LDR,R3   ,B6
          2 0003CC  B570 00FF                            AND,R3   255,IMO
          2 0003CE  E847 000D                            LDR,R6   J,AUTO
          2 0003D0  E930 0000 0020  00                   CMR,R6   V3SIZE,R3
          2 0003D3  0201 0070                            BL       s:12357,PREL

      888    12312    2                 GOTO BADV3;
      889    12313    3              DO CASE (FPT_TIMEV.DEST);

  12313   2 0003D5  3D04                                 CMV,R3   4
          2 0003D6  0281 0035                            BGE      s:12319,PREL
          2 0003D8  A830 0000 03DE  02                   LDR,R2   s:12313+9,R3
          2 0003DB  83A0 0000 03E2  02                   JMP      s:12315,R2
          2 0003DE       002A                            DC       s:12319,PREL
          2 0003DF       001B                            DC       s:12317,PREL
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:160  
          2 0003E0       0000                            DC       s:12315,PREL
          2 0003E1       001B                            DC       s:12317,PREL

      890    12314    3               CASE (%G_TIME_ANS);

      891    12315    3                 CALL CONCAT(PARM.CPTRS.PAR4$->ST5,YR,JDAY);

  12315   2 0003E2  DCC7 0004                            LDB,B5   @PARM,AUTO
          2 0003E4  8CC5 000C                            LDI      12,B5
          2 0003E6  9856                                 LDR,R1   R6
          2 0003E7  E570 7FFF                            AND,R6   32767,IMO
          2 0003E9  8D47 003E                            SDI      @J+2,AUTO
          2 0003EB  CCC7 003E                            LDB,B4   @J+2,AUTO
          2 0003ED  104F                                 SOR,R1   15
          2 0003EE  AB87                                 LAB,B2   ,AUTO
          2 0003EF  2C46                                 LDV,R2   70
          2 0003F0  6C02                                 LDV,R6   2
          2 0003F1  BB84                                 LAB,B3   ,B4
          2 0003F2  B851                                 LDR,R3   R1
          2 0003F3  0008                                 MMM
          2 0003F4  AB87                                 LAB,B2   ,AUTO
          2 0003F5  2C4E                                 LDV,R2   78
          2 0003F6  6C03                                 LDV,R6   3
          2 0003F7  BB84                                 LAB,B3   ,B4
          2 0003F8  B851                                 LDR,R3   R1
          2 0003F9  3E02                                 ADV,R3   2
          2 0003FA  0008                                 MMM
          2 0003FB  0F81 0010                            B        s:12319,PREL

      892    12316    3               CASE (%G_TIME_LOCAL,%G_TIME_EXT);

      893    12317    3                 PARM.PTRS.PAR4$->ST3=WKDAY(WKD);

  12317   2 0003FD  DCC7 0004                            LDB,B5   @PARM,AUTO
          2 0003FF  CCC5 000C                            LDB,B4   12,B5
          2 000401  AB80 0000 0000  01                   LAB,B2   BASEDAYS
          2 000404  A847 0026                            LDR,R2   WKD,AUTO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:161  
          2 000406  2F03                                 MLV,R2   3
          2 000407  2E04                                 ADV,R2   4
          2 000408  6C03                                 LDV,R6   3
          2 000409  BB84                                 LAB,B3   ,B4
          2 00040A  3C00                                 LDV,R3   0
          2 00040B  0008                                 MMM

      894    12318    3               END;

      895    12319    2            END;

      896    12320    1   UT:     CALL DSIZE(4,J) ALTRET(XTIME);

  12320   2 00040C  EBF0 0004            UT              LAB,B6   4,IMO
          2 00040E  DBC7 000D                            LAB,B5   J,AUTO
          2 000410  DFC7 003C                            STB,B5   @I+2,AUTO
          2 000412  EFC7 003A                            STB,B6   HH+4,AUTO
          2 000414  E3C0 077E                            LNJ,B6   s:0,PREL
          2 000416       0019                            DC       s:12327,PREL

      897    12321    1           IF FPT_TIMEV.SOURCE ~= %G_TIME_UTS AND

  12321   2 000417  ECC7 0018                            LDB,B6   P1$,AUTO
          2 000419  E286                                 LLH,R6   ,B6
          2 00041A  6D04                                 CMV,R6   4
          2 00041B  0901 0013                            BE       s:12327,PREL
          2 00041D  6D05                                 CMV,R6   5
          2 00041E  0901 0010                            BE       s:12327,PREL

      898    12322    2             FPT_TIMEV.SOURCE ~= %G_TIME_TUN THEN DO;

      899    12323    2              IF J ~= 4 THEN

  12323   2 000420  D847 000D                            LDR,R5   J,AUTO
          2 000422  5D04                                 CMV,R5   4
          2 000423  0981 0029                            BNE      s:12359,PREL

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:162  
      900    12324    2                 GOTO NOPS4;
      901    12325    2              CALL DATEUTS ALTRET(NOPS4);

  12325   2 000425  E3C0 05A3                            LNJ,B6   s:0,PREL
          2 000427       0026                            DC       s:12359,PREL

      902    12326    2              PARM.PTRS.PAR5$->A=UTIME;

  12326   2 000428  ECC7 0004                            LDB,B6   @PARM,AUTO
          2 00042A  DCC6 000E                            LDB,B5   14,B6
          2 00042C  8CC7 0008                            LDI      UTIME,AUTO
          2 00042E  8D05                                 SDI      ,B5

      903    12327    2              END;

      904    12328    1   XTIME:  RETURN;

  12328   2 00042F  C380 0000 0000  xent XTIME           LNJ,B4   X6A_ARET

      905    12329
      906    12330
      907    12331        /*E* ERROR: GUS-E$YEARERR-0
      908    12332              MESSAGE: M$TIME can't convert dates before 1/1/78 to UTS
      909    12333              values.
      910    12334                                                                           */
      911    12335        /*E*  ERROR: GUS-E$BADDT-0
      912    12336              MESSAGE: Source DATE or TIME format error.
      913    12337              DESCRIPTION: Date or time source string is non-numeric, has
      914    12338              incorrect length or is not in the correct format.
      915    12339                                                                           */
      916    12340        /*E*  ERROR: GUS-E$BADVECT1-0
      917    12341              MESSAGE: Destination DATE vector is incorrect size.
      918    12342                                                                           */
      919    12343        /*E*  ERROR: GUS-E$BADVECT2-0
      920    12344              MESSAGE: Destination TIME vector is incorrect size.
      921    12345                                                                           */
      922    12346        /*E*  ERROR: GUS-E$BADVECT3-0
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:163  
      923    12347              MESSAGE: Destination DAY vector is incorrect length.
      924    12348                                                                           */
      925    12349        /*E* ERROR: GUS-E$BADVECT4-0
      926    12350              MESSAGE: Required TSTAMP vector is missing.
      927    12351                                                                           */
      928    12352
      929    12353    1   BADYR:  PARM.ERR=YRERR;

  12353   2 000432  8C80 0000 0041  01   BADYR           LDI      YRERR
          2 000435  ECC7 0004                            LDB,B6   @PARM,AUTO
          2 000437  8D46 0003                            SDI      3,B6

      930    12354    1           GOTO ERRXIT;

  12354   2 000439  0F81 0023                            B        s:12362,PREL

      931    12355    1   BADV1:  PARM.ERR=V1ERR;

  12355   2 00043B  8C80 0000 003B  01   BADV1           LDI      V1ERR
          2 00043E  DCC7 0004                            LDB,B5   @PARM,AUTO
          2 000440  8D45 0003                            SDI      3,B5

      932    12356    1           GOTO ERRXIT;

  12356   2 000442  0F81 001A                            B        s:12362,PREL

      933    12357    1   BADV3:  PARM.ERR=V3ERR;

  12357   2 000444  8C80 0000 003F  01   BADV3           LDI      V3ERR
          2 000447  DCC7 0004                            LDB,B5   @PARM,AUTO
          2 000449  8D45 0003                            SDI      3,B5

      934    12358    1           GOTO ERRXIT;

  12358   2 00044B  0F81 0011                            B        s:12362,PREL

      935    12359    1   NOPS4:  PARM.ERR=V4ERR;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:164  

  12359   2 00044D  8C80 0000 0039  01   NOPS4           LDI      V4ERR
          2 000450  ECC7 0004                            LDB,B6   @PARM,AUTO
          2 000452  8D46 0003                            SDI      3,B6

      936    12360    1           GOTO ERRXIT;

  12360   2 000454  0F81 0008                            B        s:12362,PREL

      937    12361    1   DTERR:  PARM.ERR=SRCERR;

  12361   2 000456  8C80 0000 0037  01   DTERR           LDI      SRCERR
          2 000459  ECC7 0004                            LDB,B6   @PARM,AUTO
          2 00045B  8D46 0003                            SDI      3,B6

      938    12362    1   ERRXIT: RETURN;

  12362   2 00045D  C380 0000 0000  xent ERRXIT          LNJ,B4   X6A_ARET

      939    12363        %EJECT;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:165  
      940    12364        /*
      941    12365                   Convert LOCAL form to binary DATE and TIME
      942    12366                                                                           */
      943    12367
      944    12368    1   LCLDATE: PROC(DATE,TIME) ALTRET;

  12368   2 000460  EFC7 0032            LCLDATE         STB,B6   B+8,AUTO

      945    12369
      946    12370    2   DCL   DATE CHAR(8);
      947    12371    2   DCL   DTCHR(0:7) REDEF DATE CHAR(1);
      948    12372    2   DCL   TIME CHAR(11);
      949    12373    2   DCL   TMCHR(0:10) REDEF TIME CHAR(1);
      950    12374    2   DCL   LO(0:6) UBIN CONSTANT INIT(1,1,0,0,0,0,0);
      951    12375    2   DCL   HI(0:6) UBIN CONSTANT INIT(12,31,99,23,59,59,99);
      952    12376    2   DCL DELM(0:6) CHAR(1) CONSTANT INIT('*','*','*',':',':','.','*');
      953    12377
      954    12378    2           CALL DSIZE (1,DTSZ) ALTRET(DATERR);

  12378   2 000462  DBF0 0001                            LAB,B5   1,IMO
          2 000464  CBC7 0015                            LAB,B4   DTSZ,AUTO
          2 000466  CFC7 003C                            STB,B4   @I+2,AUTO
          2 000468  DFC7 003A                            STB,B5   HH+4,AUTO
          2 00046A  E3C0 0728                            LNJ,B6   s:0,PREL
          2 00046C       02CE                            DC       s:12450,PREL

      955    12379    2           CALL DSIZE (2,TMSZ);

  12379   2 00046D  EBF0 0002                            LAB,B6   2,IMO
          2 00046F  DBC7 0013                            LAB,B5   TMSZ,AUTO
          2 000471  DFC7 003C                            STB,B5   @I+2,AUTO
          2 000473  EFC7 003A                            STB,B6   HH+4,AUTO
          2 000475  E3C0 071D                            LNJ,B6   s:0,PREL
          2 000477       0001                            DC       s:12383,PREL

      956    12380
      957    12381        /*    Parse date string                                            */
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:166  
      958    12382
      959    12383    3           DO I = 0 TO DTSZ-1;

  12383   2 000478  8747 000C                            CL       I,AUTO
          2 00047A  0F81 0033                            B        s:12386+2,PREL

      960    12384    3              IF DTCHR(I) ~= '/' AND (DTCHR(I) < '0' OR DTCHR(I) > '9') THEN

  12384   2 00047C  8CC7 0034                            LDI      @DATE,AUTO
          2 00047E  B856                                 LDR,R3   R6
          2 00047F  E570 7FFF                            AND,R6   32767,IMO
          2 000481  8D47 003E                            SDI      @J+2,AUTO
          2 000483  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 000485  304F                                 SOR,R3   15
          2 000486  BA47 000C                            ADD,R3   I,AUTO
          2 000488  D0B6                                 LDH,R5   ,B6,R3
          2 000489  5D2F                                 CMV,R5   47
          2 00048A  0901 0021                            BE       s:12386,PREL
          2 00048C  8CC7 0034                            LDI      @DATE,AUTO
          2 00048E  B856                                 LDR,R3   R6
          2 00048F  E570 7FFF                            AND,R6   32767,IMO
          2 000491  8D47 0040                            SDI      @J+4,AUTO
          2 000493  DCC7 0040                            LDB,B5   @J+4,AUTO
          2 000495  304F                                 SOR,R3   15
          2 000496  BA47 000C                            ADD,R3   I,AUTO
          2 000498  D0B5                                 LDH,R5   ,B5,R3
          2 000499  5D30                                 CMV,R5   48
          2 00049A  0201 029F                            BL       s:12450,PREL
          2 00049C  8CC7 0034                            LDI      @DATE,AUTO
          2 00049E  B856                                 LDR,R3   R6
          2 00049F  E570 7FFF                            AND,R6   32767,IMO
          2 0004A1  8D47 0042                            SDI      @J+6,AUTO
          2 0004A3  CCC7 0042                            LDB,B4   @J+6,AUTO
          2 0004A5  304F                                 SOR,R3   15
          2 0004A6  BA47 000C                            ADD,R3   I,AUTO
          2 0004A8  D0B4                                 LDH,R5   ,B4,R3
          2 0004A9  5D39                                 CMV,R5   57
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:167  
          2 0004AA  0301 028F                            BG       s:12450,PREL

      961    12385    3                 GOTO DATERR;
      962    12386    3              END;

  12386   2 0004AC  8AC7 000C                            INC      I,AUTO
          2 0004AE  E847 000C                            LDR,R6   I,AUTO
          2 0004B0  E947 0015                            CMR,R6   DTSZ,AUTO
          2 0004B2  024A                                 BL       s:12384,SPREL

      963    12387    2           CALL INDEX (I,'/',DATE) ALTRET(DATERR);

  12387   2 0004B3  8CC7 0034                            LDI      @DATE,AUTO
          2 0004B5  B856                                 LDR,R3   R6
          2 0004B6  E570 7FFF                            AND,R6   32767,IMO
          2 0004B8  8D47 003E                            SDI      @J+2,AUTO
          2 0004BA  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 0004BC  304F                                 SOR,R3   15
          2 0004BD  0028                                 SRH      ;
          2 0004BE       4178 2F00                                ALPHANUM('2F00'X,IMO,,1),;
          2 0004C0       4407 0040                                BINARY(@J+4,AUTO,,4),;
          2 0004C2       4836 0000                                ALPHANUM(0,B6,R3,,8)
          2 0004C4  5381 0006                            CBE      s:12387+24,PREL
          2 0004C6  5C08                                 LDV,R5   8
          2 0004C7  DF47 000C                            STR,R5   I,AUTO
          2 0004C9  0F81 0270                            B        s:12450,PREL
          2 0004CB  D847 0041                            LDR,R5   @J+5,AUTO
          2 0004CD  DF47 000C                            STR,R5   I,AUTO

      964    12388    2           CALL INDEX (J,'/',DATE,I+1) ALTRET(DATERR);

  12388   2 0004CF  8CC7 0034                            LDI      @DATE,AUTO
          2 0004D1  B856                                 LDR,R3   R6
          2 0004D2  E570 7FFF                            AND,R6   32767,IMO
          2 0004D4  8D47 003E                            SDI      @J+2,AUTO
          2 0004D6  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 0004D8  304F                                 SOR,R3   15
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:168  
          2 0004D9  BA55                                 ADD,R3   R5
          2 0004DA  E855                                 LDR,R6   R5
          2 0004DB  8256                                 NEG      R6
          2 0004DC  EA70 0107                            ADD,R6   263,IMO
          2 0004DE  0028                                 SRH      ;
          2 0004DF       4178 2F00                                ALPHANUM('2F00'X,IMO,,1),;
          2 0004E1       4407 0040                                BINARY(@J+4,AUTO,,4),;
          2 0004E3       C036 0000                                ALPHANUM(0,B6,R3,1,R6)
          2 0004E5  5381 0006                            CBE      s:12388+29,PREL
          2 0004E7  4C08                                 LDV,R4   8
          2 0004E8  CF47 000D                            STR,R4   J,AUTO
          2 0004EA  0F81 024F                            B        s:12450,PREL
          2 0004EC  DA47 0041                            ADD,R5   @J+5,AUTO
          2 0004EE  5E01                                 ADV,R5   1
          2 0004EF  DF47 000D                            STR,R5   J,AUTO

      965    12389    2           IF I=0 OR J=I+1 OR J ~= DTSZ-3 THEN

  12389   2 0004F1  C847 000C                            LDR,R4   I,AUTO
          2 0004F3  4901 0246                            BEZ,R4   s:12450,PREL
          2 0004F5  4E01                                 ADV,R4   1
          2 0004F6  C955                                 CMR,R4   R5
          2 0004F7  0901 0242                            BE       s:12450,PREL
          2 0004F9  B847 0015                            LDR,R3   DTSZ,AUTO
          2 0004FB  3EFD                                 ADV,R3   -3
          2 0004FC  3801 023D                            BLZ,R3   s:12450,PREL
          2 0004FE  B955                                 CMR,R3   R5
          2 0004FF  0981 023A                            BNE      s:12450,PREL

      966    12390    2              GOTO DATERR;
      967    12391    2           CALL CHARBIN(B.MM,SUBSTR(DATE,0,I));

  12391   2 000501  8CC7 0034                            LDI      @DATE,AUTO
          2 000503  A856                                 LDR,R2   R6
          2 000504  E570 7FFF                            AND,R6   32767,IMO
          2 000506  8D47 003E                            SDI      @J+2,AUTO
          2 000508  ECC7 003E                            LDB,B6   @J+2,AUTO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:169  
          2 00050A  204F                                 SOR,R2   15
          2 00050B  C847 000C                            LDR,R4   I,AUTO
          2 00050D  002A                                 CDB      ;
          2 00050E       0026 0000                                UNPACKED(0,B6,R2,,R4,UNSIGNED),;
          2 000510       0407 0040                                BINARY(@J+4,AUTO,,4)
          2 000512  437F                                 CSYNC    s:12391+16,SPREL
          2 000513  A847 0041                            LDR,R2   @J+5,AUTO
          2 000515  AF47 002A                            STR,R2   B,AUTO

      968    12392    2           CALL CHARBIN(B.DD,SUBSTR(DATE,I+1,J-(I+1)));

  12392   2 000517  8CC7 0034                            LDI      @DATE,AUTO
          2 000519  9856                                 LDR,R1   R6
          2 00051A  E570 7FFF                            AND,R6   32767,IMO
          2 00051C  8D47 003E                            SDI      @J+2,AUTO
          2 00051E  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 000520  104F                                 SOR,R1   15
          2 000521  D254                                 SUB,R5   R4
          2 000522  9A54                                 ADD,R1   R4
          2 000523  C855                                 LDR,R4   R5
          2 000524  4EFF                                 ADV,R4   -1
          2 000525  002A                                 CDB      ;
          2 000526       8016 0000                                UNPACKED(0,B6,R1,1,R4,UNSIGNED),;
          2 000528       0407 0040                                BINARY(@J+4,AUTO,,4)
          2 00052A  437F                                 CSYNC    s:12392+18,SPREL
          2 00052B  D847 0041                            LDR,R5   @J+5,AUTO
          2 00052D  DF47 002B                            STR,R5   B+1,AUTO

      969    12393    2           CALL CHARBIN(B.YY,SUBSTR(DATE,J+1,DTSZ-J-1));

  12393   2 00052F  8CC7 0034                            LDI      @DATE,AUTO
          2 000531  9856                                 LDR,R1   R6
          2 000532  E570 7FFF                            AND,R6   32767,IMO
          2 000534  8D47 003E                            SDI      @J+2,AUTO
          2 000536  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 000538  104F                                 SOR,R1   15
          2 000539  C847 0015                            LDR,R4   DTSZ,AUTO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:170  
          2 00053B  C247 000D                            SUB,R4   J,AUTO
          2 00053D  9A47 000D                            ADD,R1   J,AUTO
          2 00053F  4EFF                                 ADV,R4   -1
          2 000540  002A                                 CDB      ;
          2 000541       8016 0000                                UNPACKED(0,B6,R1,1,R4,UNSIGNED),;
          2 000543       0407 0040                                BINARY(@J+4,AUTO,,4)
          2 000545  437F                                 CSYNC    s:12393+21,SPREL
          2 000546  C847 0041                            LDR,R4   @J+5,AUTO
          2 000548  CF47 002C                            STR,R4   B+2,AUTO

      970    12394
      971    12395        /*    Parse time string                                            */
      972    12396
      973    12397    3           DO I = 0 TO TMSZ-1;

  12397   2 00054A  8747 000C                            CL       I,AUTO
          2 00054C  0F81 0043                            B        s:12401+2,PREL

      974    12398    3              IF TMCHR(I) ~= ':' AND TMCHR(I) ~= '.' AND (TMCHR(I) < '0' OR

  12398   2 00054E  8CC7 0036                            LDI      @TIME,AUTO
          2 000550  B856                                 LDR,R3   R6
          2 000551  E570 7FFF                            AND,R6   32767,IMO
          2 000553  8D47 003E                            SDI      @J+2,AUTO
          2 000555  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 000557  304F                                 SOR,R3   15
          2 000558  BA47 000C                            ADD,R3   I,AUTO
          2 00055A  D0B6                                 LDH,R5   ,B6,R3
          2 00055B  5D3A                                 CMV,R5   58
          2 00055C  0901 0031                            BE       s:12401,PREL
          2 00055E  8CC7 0036                            LDI      @TIME,AUTO
          2 000560  B856                                 LDR,R3   R6
          2 000561  E570 7FFF                            AND,R6   32767,IMO
          2 000563  8D47 0040                            SDI      @J+4,AUTO
          2 000565  DCC7 0040                            LDB,B5   @J+4,AUTO
          2 000567  304F                                 SOR,R3   15
          2 000568  BA47 000C                            ADD,R3   I,AUTO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:171  
          2 00056A  D0B5                                 LDH,R5   ,B5,R3
          2 00056B  5D2E                                 CMV,R5   46
          2 00056C  0901 0021                            BE       s:12401,PREL
          2 00056E  8CC7 0036                            LDI      @TIME,AUTO
          2 000570  B856                                 LDR,R3   R6
          2 000571  E570 7FFF                            AND,R6   32767,IMO
          2 000573  8D47 0042                            SDI      @J+6,AUTO
          2 000575  CCC7 0042                            LDB,B4   @J+6,AUTO
          2 000577  304F                                 SOR,R3   15
          2 000578  BA47 000C                            ADD,R3   I,AUTO
          2 00057A  D0B4                                 LDH,R5   ,B4,R3
          2 00057B  5D30                                 CMV,R5   48
          2 00057C  0201 01BD                            BL       s:12450,PREL
          2 00057E  8CC7 0036                            LDI      @TIME,AUTO
          2 000580  B856                                 LDR,R3   R6
          2 000581  E570 7FFF                            AND,R6   32767,IMO
          2 000583  8D47 0044                            SDI      @J+8,AUTO
          2 000585  BCC7 0044                            LDB,B3   @J+8,AUTO
          2 000587  304F                                 SOR,R3   15
          2 000588  BA47 000C                            ADD,R3   I,AUTO
          2 00058A  D0B3                                 LDH,R5   ,B3,R3
          2 00058B  5D39                                 CMV,R5   57
          2 00058C  0301 01AD                            BG       s:12450,PREL

      975    12399    3                TMCHR(I) > '9') THEN
      976    12400    3                 GOTO DATERR;
      977    12401    3              END;

  12401   2 00058E  8AC7 000C                            INC      I,AUTO
          2 000590  E847 000C                            LDR,R6   I,AUTO
          2 000592  E947 0013                            CMR,R6   TMSZ,AUTO
          2 000594  0201 FFB9                            BL       s:12398,PREL

      978    12402    2           J=0;

  12402   2 000596  8747 000D                            CL       J,AUTO

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:172  
      979    12403    2           I=3;

  12403   2 000598  6C03                                 LDV,R6   3
          2 000599  EF47 000C                            STR,R6   I,AUTO

      980    12404    3           DO WHILE J < TMSZ;

  12404   2 00059B  D847 000D                            LDR,R5   J,AUTO
          2 00059D  D947 0013                            CMR,R5   TMSZ,AUTO
          2 00059F  0281 007E                            BGE      s:12418,PREL

      981    12405    3              IF I>6 THEN

  12405   2 0005A1  E847 000C                            LDR,R6   I,AUTO
          2 0005A3  6D06                                 CMV,R6   6
          2 0005A4  0301 0195                            BG       s:12450,PREL

      982    12406    3                 GOTO DATERR;
      983    12407    3              CALL INDEX (K,DELM(I),TIME,J) ALTRET(LASTFLD);

  12407   2 0005A6  8CC7 0036                            LDI      @TIME,AUTO
          2 0005A8  B856                                 LDR,R3   R6
          2 0005A9  E570 7FFF                            AND,R6   32767,IMO
          2 0005AB  8D47 003E                            SDI      @J+2,AUTO
          2 0005AD  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 0005AF  304F                                 SOR,R3   15
          2 0005B0  BA47 000D                            ADD,R3   J,AUTO
          2 0005B2  DB80 0000 0000  01                   LAB,B5   BASEDAYS
          2 0005B5  A847 000C                            LDR,R2   I,AUTO
          2 0005B7  E847 000D                            LDR,R6   J,AUTO
          2 0005B9  8256                                 NEG      R6
          2 0005BA  EA70 010B                            ADD,R6   267,IMO
          2 0005BC  0028                                 SRH      ;
          2 0005BD       4125 0051                                ALPHANUM(81,B5,R2,,1),;
          2 0005BF       4407 0040                                BINARY(@J+4,AUTO,,4),;
          2 0005C1       4036 0000                                ALPHANUM(0,B6,R3,,R6)
          2 0005C3  5381 0006                            CBE      s:12407+36,PREL
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:173  
          2 0005C5  5C0B                                 LDV,R5   11
          2 0005C6  DF47 000E                            STR,R5   K,AUTO
          2 0005C8  0F81 0009                            B        s:12409,PREL
          2 0005CA  D847 0041                            LDR,R5   @J+5,AUTO
          2 0005CC  DA47 000D                            ADD,R5   J,AUTO
          2 0005CE  DF47 000E                            STR,R5   K,AUTO

      984    12408    4              DO WHILE '0'B;

  12408   2 0005D0  0F81 0005                            B        s:12411,PREL

      985    12409    4   LASTFLD:      K=TMSZ;

  12409   2 0005D2  E847 0013            LASTFLD         LDR,R6   TMSZ,AUTO
          2 0005D4  EF47 000E                            STR,R6   K,AUTO

      986    12410    4                 END;

      987    12411    4              IF K > J THEN DO;

  12411   2 0005D6  E847 000E                            LDR,R6   K,AUTO
          2 0005D8  E947 000D                            CMR,R6   J,AUTO
          2 0005DA  0381 0038                            BLE      s:12415,PREL

      988    12412    4                 CALL CHARBIN(DT(I),SUBSTR(TIME,J,K-J));

  12412   2 0005DC  8CC7 0036                            LDI      @TIME,AUTO
          2 0005DE  B856                                 LDR,R3   R6
          2 0005DF  E570 7FFF                            AND,R6   32767,IMO
          2 0005E1  8D47 003E                            SDI      @J+2,AUTO
          2 0005E3  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 0005E5  304F                                 SOR,R3   15
          2 0005E6  D847 000E                            LDR,R5   K,AUTO
          2 0005E8  D247 000D                            SUB,R5   J,AUTO
          2 0005EA  BA47 000D                            ADD,R3   J,AUTO
          2 0005EC  C855                                 LDR,R4   R5
          2 0005ED  002A                                 CDB      ;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:174  
          2 0005EE       0036 0000                                UNPACKED(0,B6,R3,,R4,UNSIGNED),;
          2 0005F0       0407 0040                                BINARY(@J+4,AUTO,,4)
          2 0005F2  B847 000C                            LDR,R3   I,AUTO
          2 0005F4  3E2A                                 ADV,R3   42
          2 0005F5  437F                                 CSYNC    s:12412+24,SPREL
          2 0005F6  D847 0041                            LDR,R5   @J+5,AUTO
          2 0005F8  DF37                                 STR,R5   ,AUTO,R3

      989    12413    4                 IF I=6 & K-J=1 THEN DT(6)=DT(6)*10;

  12413   2 0005F9  C847 000E                            LDR,R4   K,AUTO
          2 0005FB  C247 000D                            SUB,R4   J,AUTO
          2 0005FD  A870 8000                            LDR,R2   -32768,IMO
          2 0005FF  4D01                                 CMV,R4   1
          2 000600  0901 0002                            BE       s:12413+10,PREL
          2 000602  2C00                                 LDV,R2   0
          2 000603  C870 8000                            LDR,R4   -32768,IMO
          2 000605  9847 000C                            LDR,R1   I,AUTO
          2 000607  1D06                                 CMV,R1   6
          2 000608  0901 0002                            BE       s:12413+18,PREL
          2 00060A  4C00                                 LDV,R4   0
          2 00060B  A554                                 AND,R2   R4
          2 00060C  2901 0006                            BEZ,R2   s:12415,PREL

  12413   2 00060E  C847 0030                            LDR,R4   B+6,AUTO
          2 000610  4F0A                                 MLV,R4   10
          2 000611  CF47 0030                            STR,R4   B+6,AUTO

      990    12414    4                 END;

      991    12415    3              J=K+1;

  12415   2 000613  E847 000E                            LDR,R6   K,AUTO
          2 000615  6E01                                 ADV,R6   1
          2 000616  EF47 000D                            STR,R6   J,AUTO

      992    12416    3              I=I+1;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:175  

  12416   2 000618  8AC7 000C                            INC      I,AUTO

      993    12417    3              END;

  12417   2 00061A  E947 0013                            CMR,R6   TMSZ,AUTO
          2 00061C  0201 FF84                            BL       s:12405,PREL

      994    12418    3   LCL4:   DO I = 0 TO 6;             /* Verify field values are within limits   */

  12418   2 00061E  8747 000C            LCL4            CL       I,AUTO

      995    12419    3              IF DT(I) < LO(I) OR DT(I) > HI(I) THEN GOTO DATERR;

  12419   2 000620  B847 000C                            LDR,R3   I,AUTO
          2 000622  3E2A                                 ADV,R3   42
          2 000623  A847 000C                            LDR,R2   I,AUTO
          2 000625  E837                                 LDR,R6   ,AUTO,R3
          2 000626  E920 0000 0043  01                   CMR,R6   LO,R2
          2 000629  0201 0110                            BL       s:12450,PREL
          2 00062B  E920 0000 004A  01                   CMR,R6   HI,R2
          2 00062E  0301 010B                            BG       s:12450,PREL

      996    12420    3              END;

  12420   2 000630  8AC7 000C                            INC      I,AUTO
          2 000632  E847 000C                            LDR,R6   I,AUTO
          2 000634  6D06                                 CMV,R6   6
          2 000635  03EB                                 BLE      s:12419,SPREL

      997    12421    2           IF B.DD > (MONS(B.MM)-MONS(B.MM-1)) AND

  12421   2 000636  B847 002A                            LDR,R3   B,AUTO
          2 000638  D830 0000 0025  01                   LDR,R5   MONS,R3
          2 00063B  D230 0000 0024  01                   SUB,R5   MONTH+23,R3
          2 00063E  5801 0005                            BLZ,R5   s:12421+14,PREL
          2 000640  D947 002B                            CMR,R5   B+1,AUTO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:176  
          2 000642  0281 000F                            BGE      s:12424,PREL
          2 000644  3D02                                 CMV,R3   2
          2 000645  0981 00F4                            BNE      s:12450,PREL
          2 000647  D847 002C                            LDR,R5   B+2,AUTO
          2 000649  D570 0003                            AND,R5   3,IMO
          2 00064B  5981 00EE                            BNEZ,R5  s:12450,PREL
          2 00064D  D847 002B                            LDR,R5   B+1,AUTO
          2 00064F  5D1D                                 CMV,R5   29
          2 000650  0981 00E9                            BNE      s:12450,PREL

      998    12422    2             NOT (B.MM = 2 AND MOD(B.YY,4) = 0 AND B.DD = 29) THEN
      999    12423    2              GOTO DATERR;
     1000    12424    2           RETURN;

  12424   2 000652  ECC7 0032                            LDB,B6   B+8,AUTO
          2 000654  C3C6 0001                            LNJ,B4   1,B6

     1001    12425        %EJECT;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:177  
     1002    12426        /*
     1003    12427                 Convert ANS form to BINARY DATE and TIME
     1004    12428                                                                              */
     1005    12429    2   ANSDATE: ENTRY(DATE,TIME) ALTRET;

  12429   2 000656  EFC7 0032            ANSDATE         STB,B6   B+8,AUTO

     1006    12430
     1007    12431    2           CALL DSIZE (1,DTSZ) ALTRET(DATERR);

  12431   2 000658  DBF0 0001                            LAB,B5   1,IMO
          2 00065A  CBC7 0015                            LAB,B4   DTSZ,AUTO
          2 00065C  CFC7 003C                            STB,B4   @I+2,AUTO
          2 00065E  DFC7 003A                            STB,B5   HH+4,AUTO
          2 000660  E3C0 0532                            LNJ,B6   s:0,PREL
          2 000662       00D8                            DC       s:12450,PREL

     1008    12432    2           CALL DSIZE (2,TMSZ);

  12432   2 000663  EBF0 0002                            LAB,B6   2,IMO
          2 000665  DBC7 0013                            LAB,B5   TMSZ,AUTO
          2 000667  DFC7 003C                            STB,B5   @I+2,AUTO
          2 000669  EFC7 003A                            STB,B6   HH+4,AUTO
          2 00066B  E3C0 0527                            LNJ,B6   s:0,PREL
          2 00066D       0001                            DC       s:12433,PREL

     1009    12433    2           IF DTSZ < 6 OR (TMSZ < 8 AND TMSZ > 0) THEN GOTO DATERR;

  12433   2 00066E  E847 0015                            LDR,R6   DTSZ,AUTO
          2 000670  6D06                                 CMV,R6   6
          2 000671  0201 00C8                            BL       s:12450,PREL
          2 000673  D847 0013                            LDR,R5   TMSZ,AUTO
          2 000675  5D08                                 CMV,R5   8
          2 000676  0281 0003                            BGE      s:12434,PREL
          2 000678  5981 00C1                            BNEZ,R5  s:12450,PREL

     1010    12434    3           IF DTSZ ~= 0 THEN DO I = 0 TO 5;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:178  

  12434   2 00067A  6901 0029                            BEZ,R6   s:12437,PREL

  12434   2 00067C  8747 000C                            CL       I,AUTO

     1011    12435    3              IF DTCHR(I) < '0' OR DTCHR(I) > '9' THEN GOTO DATERR;

  12435   2 00067E  8CC7 0034                            LDI      @DATE,AUTO
          2 000680  B856                                 LDR,R3   R6
          2 000681  E570 7FFF                            AND,R6   32767,IMO
          2 000683  8D47 003E                            SDI      @J+2,AUTO
          2 000685  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 000687  304F                                 SOR,R3   15
          2 000688  BA47 000C                            ADD,R3   I,AUTO
          2 00068A  D0B6                                 LDH,R5   ,B6,R3
          2 00068B  5D30                                 CMV,R5   48
          2 00068C  0201 00AD                            BL       s:12450,PREL
          2 00068E  8CC7 0034                            LDI      @DATE,AUTO
          2 000690  B856                                 LDR,R3   R6
          2 000691  E570 7FFF                            AND,R6   32767,IMO
          2 000693  8D47 0040                            SDI      @J+4,AUTO
          2 000695  DCC7 0040                            LDB,B5   @J+4,AUTO
          2 000697  304F                                 SOR,R3   15
          2 000698  BA47 000C                            ADD,R3   I,AUTO
          2 00069A  D0B5                                 LDH,R5   ,B5,R3
          2 00069B  5D39                                 CMV,R5   57
          2 00069C  0301 009D                            BG       s:12450,PREL

     1012    12436    3              END;

  12436   2 00069E  8AC7 000C                            INC      I,AUTO
          2 0006A0  D847 000C                            LDR,R5   I,AUTO
          2 0006A2  5D05                                 CMV,R5   5
          2 0006A3  03DB                                 BLE      s:12435,SPREL

     1013    12437    3           IF TMSZ ~= 0 THEN DO I = 0 TO 7;

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:179  
  12437   2 0006A4  E847 0013                            LDR,R6   TMSZ,AUTO
          2 0006A6  6901 0029                            BEZ,R6   s:12440,PREL

  12437   2 0006A8  8747 000C                            CL       I,AUTO

     1014    12438    3              IF TMCHR(I) < '0' OR TMCHR(I) > '9' THEN GOTO DATERR;

  12438   2 0006AA  8CC7 0036                            LDI      @TIME,AUTO
          2 0006AC  B856                                 LDR,R3   R6
          2 0006AD  E570 7FFF                            AND,R6   32767,IMO
          2 0006AF  8D47 003E                            SDI      @J+2,AUTO
          2 0006B1  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 0006B3  304F                                 SOR,R3   15
          2 0006B4  BA47 000C                            ADD,R3   I,AUTO
          2 0006B6  D0B6                                 LDH,R5   ,B6,R3
          2 0006B7  5D30                                 CMV,R5   48
          2 0006B8  0201 0081                            BL       s:12450,PREL
          2 0006BA  8CC7 0036                            LDI      @TIME,AUTO
          2 0006BC  B856                                 LDR,R3   R6
          2 0006BD  E570 7FFF                            AND,R6   32767,IMO
          2 0006BF  8D47 0040                            SDI      @J+4,AUTO
          2 0006C1  DCC7 0040                            LDB,B5   @J+4,AUTO
          2 0006C3  304F                                 SOR,R3   15
          2 0006C4  BA47 000C                            ADD,R3   I,AUTO
          2 0006C6  D0B5                                 LDH,R5   ,B5,R3
          2 0006C7  5D39                                 CMV,R5   57
          2 0006C8  0301 0071                            BG       s:12450,PREL

     1015    12439    3              END;

  12439   2 0006CA  8AC7 000C                            INC      I,AUTO
          2 0006CC  D847 000C                            LDR,R5   I,AUTO
          2 0006CE  5D07                                 CMV,R5   7
          2 0006CF  03DB                                 BLE      s:12438,SPREL

     1016    12440    2           CALL CHARBIN(DT(2),SUBSTR(DATE,0,2));

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:180  
  12440   2 0006D0  8CC7 0034                            LDI      @DATE,AUTO
          2 0006D2  B856                                 LDR,R3   R6
          2 0006D3  E570 7FFF                            AND,R6   32767,IMO
          2 0006D5  8D47 003E                            SDI      @J+2,AUTO
          2 0006D7  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 0006D9  304F                                 SOR,R3   15
          2 0006DA  002A                                 CDB      ;
          2 0006DB       0236 0000                                UNPACKED(0,B6,R3,,2,UNSIGNED),;
          2 0006DD       0407 0040                                BINARY(@J+4,AUTO,,4)
          2 0006DF  437F                                 CSYNC    s:12440+14,SPREL
          2 0006E0  D847 0041                            LDR,R5   @J+5,AUTO
          2 0006E2  DF47 002C                            STR,R5   B+2,AUTO

     1017    12441    2           CALL CHARBIN(DT(0),SUBSTR(DATE,2,2));

  12441   2 0006E4  8CC7 0034                            LDI      @DATE,AUTO
          2 0006E6  B856                                 LDR,R3   R6
          2 0006E7  E570 7FFF                            AND,R6   32767,IMO
          2 0006E9  8D47 003E                            SDI      @J+2,AUTO
          2 0006EB  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 0006ED  304F                                 SOR,R3   15
          2 0006EE  002A                                 CDB      ;
          2 0006EF       0236 0001                                UNPACKED(1,B6,R3,,2,UNSIGNED),;
          2 0006F1       0407 0040                                BINARY(@J+4,AUTO,,4)
          2 0006F3  437F                                 CSYNC    s:12441+14,SPREL
          2 0006F4  C847 0041                            LDR,R4   @J+5,AUTO
          2 0006F6  CF47 002A                            STR,R4   B,AUTO

     1018    12442    2           CALL CHARBIN(DT(1),SUBSTR(DATE,4,2));

  12442   2 0006F8  8CC7 0034                            LDI      @DATE,AUTO
          2 0006FA  B856                                 LDR,R3   R6
          2 0006FB  E570 7FFF                            AND,R6   32767,IMO
          2 0006FD  8D47 003E                            SDI      @J+2,AUTO
          2 0006FF  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 000701  304F                                 SOR,R3   15
          2 000702  002A                                 CDB      ;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:181  
          2 000703       0236 0002                                UNPACKED(2,B6,R3,,2,UNSIGNED),;
          2 000705       0407 0040                                BINARY(@J+4,AUTO,,4)
          2 000707  437F                                 CSYNC    s:12442+14,SPREL
          2 000708  B847 0041                            LDR,R3   @J+5,AUTO
          2 00070A  BF47 002B                            STR,R3   B+1,AUTO

     1019    12443    2           K=0;

  12443   2 00070C  8747 000E                            CL       K,AUTO

     1020    12444    2           IF TMSZ > 0 THEN

  12444   2 00070E  A847 0013                            LDR,R2   TMSZ,AUTO
          2 000710  2901 0027                            BEZ,R2   s:12449,PREL

     1021    12445    3           DO I= 3 TO 6;

  12445   2 000712  1C03                                 LDV,R1   3
          2 000713  9F47 000C                            STR,R1   I,AUTO

     1022    12446    3              CALL CHARBIN(DT(I),SUBSTR(TIME,K,2));

  12446   2 000715  8CC7 0036                            LDI      @TIME,AUTO
          2 000717  B856                                 LDR,R3   R6
          2 000718  E570 7FFF                            AND,R6   32767,IMO
          2 00071A  8D47 003E                            SDI      @J+2,AUTO
          2 00071C  ECC7 003E                            LDB,B6   @J+2,AUTO
          2 00071E  304F                                 SOR,R3   15
          2 00071F  BA47 000E                            ADD,R3   K,AUTO
          2 000721  002A                                 CDB      ;
          2 000722       0236 0000                                UNPACKED(0,B6,R3,,2,UNSIGNED),;
          2 000724       0407 0040                                BINARY(@J+4,AUTO,,4)
          2 000726  B847 000C                            LDR,R3   I,AUTO
          2 000728  3E2A                                 ADV,R3   42
          2 000729  437F                                 CSYNC    s:12446+19,SPREL
          2 00072A  D847 0041                            LDR,R5   @J+5,AUTO
          2 00072C  DF37                                 STR,R5   ,AUTO,R3
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:182  

     1023    12447    3              K=K+2;

  12447   2 00072D  C847 000E                            LDR,R4   K,AUTO
          2 00072F  4E02                                 ADV,R4   2
          2 000730  CF47 000E                            STR,R4   K,AUTO

     1024    12448    3              END;

  12448   2 000732  8AC7 000C                            INC      I,AUTO
          2 000734  B847 000C                            LDR,R3   I,AUTO
          2 000736  3D06                                 CMV,R3   6
          2 000737  03DE                                 BLE      s:12446,SPREL

     1025    12449    2           GOTO LCL4;

  12449   2 000738  0F81 FEE5                            B        s:12418,PREL

     1026    12450    2   DATERR: ALTRETURN;

  12450   2 00073A  ECC7 0032            DATERR          LDB,B6   B+8,AUTO
          2 00073C  B806                                 LDR,R3   ,B6
          2 00073D  C3B6                                 LNJ,B4   ,B6,R3

     1027    12451    2   END LCLDATE;
     1028    12452        %EJECT;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:183  
     1029    12453        /*
     1030    12454                   Convert UTS to DATE and TIME
     1031    12455                                                                              */
     1032    12456    1   UTSDATE: PROC;

  12456   2 00073E  EFC7 0032            UTSDATE         STB,B6   B+8,AUTO

     1033    12457
     1034    12458    2   DCL J UBIN(32);
     1035    12459    2   DCL U UBIN(32);
     1036    12460    2   DCL BIAS UBIN STATIC;
     1037    12461    2   DCL 1 NEGFLAG BIT(1) BASED WALIGNED;
     1038    12462
     1039    12463                /* The following code has been tweaked to address 42930. It does
     1040    12464                   this by checking if the UTS is negative. If so, it will subtract
     1041    12465                   a bias value which represents the number of ticks in 3314 days.
     1042    12466                   The value represents the largest positive UTS value on an even
     1043    12467                   day boundary that will fit in a 32-bit two's complement value.
     1044    12468                   Since the problem involves multiplication and division, the bias
     1045    12469                   bias value can be added back at the end of the multiplication
     1046    12470                   or division operations. */
     1047    12471
     1048    12472    3           IF ADDR(UTIME)->NEGFLAG THEN DO;

  12472   2 000740  89C7 0008                            CMZ      UTIME,AUTO
          2 000742  0881 001B                            BAGE     s:12481,PREL

     1049    12473    3              U = UTIME - 2147472000;

  12473   2 000744  8CC7 0008                            LDI      UTIME,AUTO
          2 000746  8470 8000 2D80                       AID      -2147472000,IMO
          2 000749  8D47 0036                            SDI      U,AUTO

     1050    12474    3              BIAS = 3314;

  12474   2 00074B  D870 0CF2                            LDR,R5   3314,IMO
          2 00074D  DF00 0000 0024  00                   STR,R5   BIAS
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:184  

     1051    12475    4              IF ADDR(U)->NEGFLAG THEN DO;

  12475   2 000750  89C7 0036                            CMZ      U,AUTO
          2 000752  0881 0012                            BAGE     s:12484,PREL

     1052    12476    4                 U = U - %TICS_DAY;

  12476   2 000754  8470 FFF6 1CC0                       AID      -648000,IMO
          2 000757  8D47 0036                            SDI      U,AUTO

     1053    12477    4                 BIAS = BIAS + 1;

  12477   2 000759  8A80 0000 0024  00                   INC      BIAS

     1054    12478    4                 END;

     1055    12479    3              END;

  12479   2 00075C  0F81 0008                            B        s:12484,PREL

     1056    12480    3           ELSE DO;

     1057    12481    3              U = UTIME;

  12481   2 00075E  8CC7 0008                            LDI      UTIME,AUTO
          2 000760  8D47 0036                            SDI      U,AUTO

     1058    12482    3              BIAS = 0;

  12482   2 000762  8700 0000 0024  00                   CL       BIAS

     1059    12483    3              END;

     1060    12484    2           J = MOD(U, %TICS_DAY) + U1(UTIMEX.QTR);

  12484   2 000765  DB80 0000 0000  03                   LAB,B5   0
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:185  
          2 000768  0027                                 CBD      ;
          2 000769       0405 000C                                BINARY(12,B5,,4),;
          2 00076B       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 00076D  0027                                 CBD      ;
          2 00076E       0407 0036                                BINARY(U,AUTO,,4),;
          2 000770       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 000772  002B                                 DDV      ;
          2 000773       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 000775       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 000777       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 000779  002A                                 CDB      ;
          2 00077A       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 00077C       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 00077E  B847 0008                            LDR,R3   UTIME,AUTO
          2 000780  304E                                 SOR,R3   14
          2 000781  437F                                 CSYNC    s:12484+27,SPREL
          2 000782  8CC7 0050                            LDI      @J+20,AUTO
          2 000784  8430 0000 000A  00                   AID      U1,R3
          2 000787  8D47 0034                            SDI      J,AUTO

     1061    12485    2           D1 = U/%TICS_DAY + BD(UTIMEX.QTR) + J/%TICS_DAY + BIAS;

  12485   2 000789  DB80 0000 0000  03                   LAB,B5   0
          2 00078C  0027                                 CBD      ;
          2 00078D       0405 000C                                BINARY(12,B5,,4),;
          2 00078F       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 000791  0027                                 CBD      ;
          2 000792       0407 0036                                BINARY(U,AUTO,,4),;
          2 000794       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 000796  002B                                 DDV      ;
          2 000797       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 000799       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 00079B       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 00079D  002A                                 CDB      ;
          2 00079E       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 0007A0       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 0007A2  437F                                 CSYNC    s:12485+24,SPREL
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:186  
          2 0007A3  8CC7 0050                            LDI      @J+20,AUTO
          2 0007A5  8430 0000 0002  00                   AID      BD,R3
          2 0007A8  DB80 0000 0000  03                   LAB,B5   0
          2 0007AB  0027                                 CBD      ;
          2 0007AC       0405 000C                                BINARY(12,B5,,4),;
          2 0007AE       4C07 0052                                UNPACKED(@J+22,AUTO,,12,LEADING)
          2 0007B0  0027                                 CBD      ;
          2 0007B1       0407 0034                                BINARY(J,AUTO,,4),;
          2 0007B3       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING)
          2 0007B5  002B                                 DDV      ;
          2 0007B6       4C07 0052                                UNPACKED(@J+22,AUTO,,12,LEADING),;
          2 0007B8       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING),;
          2 0007BA       4C07 005E                                UNPACKED(@J+34,AUTO,,12,LEADING)
          2 0007BC  002A                                 CDB      ;
          2 0007BD       4C07 005E                                UNPACKED(@J+34,AUTO,,12,LEADING),;
          2 0007BF       0407 0064                                BINARY(@J+40,AUTO,,4)
          2 0007C1  437F                                 CSYNC    s:12485+55,SPREL
          2 0007C2  8447 0064                            AID      @J+40,AUTO
          2 0007C4  8D47 0066                            SDI      @J+42,AUTO
          2 0007C6  F800 0000 0024  00                   LDR,R7   BIAS
          2 0007C9  6C00                                 LDV,R6   0
          2 0007CA  8447 0066                            AID      @J+42,AUTO
          2 0007CC  8D47 0024                            SDI      D1,AUTO

     1062    12486    2           J = (MOD(J, %TICS_DAY)*40 +2)/3; /* CV TO CENTISEC                    */

  12486   2 0007CE  DB80 0000 0000  03                   LAB,B5   0
          2 0007D1  0027                                 CBD      ;
          2 0007D2       0405 000C                                BINARY(12,B5,,4),;
          2 0007D4       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 0007D6  0027                                 CBD      ;
          2 0007D7       0407 0034                                BINARY(J,AUTO,,4),;
          2 0007D9       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 0007DB  002B                                 DDV      ;
          2 0007DC       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 0007DE       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 0007E0       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:187  
          2 0007E2  002A                                 CDB      ;
          2 0007E3       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 0007E5       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 0007E7  437F                                 CSYNC    s:12486+24,SPREL
          2 0007E8  8CC7 0050                            LDI      @J+20,AUTO
          2 0007EA  9B80 0000 000E  03                   LAB,B1   +14
          2 0007ED  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 0007F0  8470 0000 0002                       AID      2,IMO
          2 0007F3  8D47 0064                            SDI      @J+40,AUTO
          2 0007F5  EB80 0000 0000  03                   LAB,B6   0
          2 0007F8  0027                                 CBD      ;
          2 0007F9       0206 0010                                BINARY(16,B6,,2),;
          2 0007FB       4C07 0052                                UNPACKED(@J+22,AUTO,,12,LEADING)
          2 0007FD  0027                                 CBD      ;
          2 0007FE       0407 0064                                BINARY(@J+40,AUTO,,4),;
          2 000800       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING)
          2 000802  002B                                 DDV      ;
          2 000803       4C07 0052                                UNPACKED(@J+22,AUTO,,12,LEADING),;
          2 000805       4C07 0058                                UNPACKED(@J+28,AUTO,,12,LEADING),;
          2 000807       4C07 005E                                UNPACKED(@J+34,AUTO,,12,LEADING)
          2 000809  002A                                 CDB      ;
          2 00080A       4C07 005E                                UNPACKED(@J+34,AUTO,,12,LEADING),;
          2 00080C       0407 0066                                BINARY(@J+42,AUTO,,4)
          2 00080E  437F                                 CSYNC    s:12486+63,SPREL
          2 00080F  8CC7 0066                            LDI      @J+42,AUTO
          2 000811  8D47 0034                            SDI      J,AUTO

     1063    12487
     1064    12488    2           B.SS00 = MOD(J, 100);

  12488   2 000813  EB80 0000 0000  03                   LAB,B6   0
          2 000816  0027                                 CBD      ;
          2 000817       0206 0001                                BINARY(1,B6,,2),;
          2 000819       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 00081B  0027                                 CBD      ;
          2 00081C       0407 0034                                BINARY(J,AUTO,,4),;
          2 00081E       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:188  
          2 000820  002B                                 DDV      ;
          2 000821       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 000823       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 000825       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 000827  002A                                 CDB      ;
          2 000828       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 00082A       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 00082C  437F                                 CSYNC    s:12488+24,SPREL
          2 00082D  D847 0051                            LDR,R5   @J+21,AUTO
          2 00082F  DF47 0030                            STR,R5   B+6,AUTO

     1065    12489    2           J = J / 100;

  12489   2 000831  EB80 0000 0000  03                   LAB,B6   0
          2 000834  0027                                 CBD      ;
          2 000835       0206 0001                                BINARY(1,B6,,2),;
          2 000837       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 000839  0027                                 CBD      ;
          2 00083A       0407 0034                                BINARY(J,AUTO,,4),;
          2 00083C       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 00083E  002B                                 DDV      ;
          2 00083F       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 000841       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 000843       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 000845  002A                                 CDB      ;
          2 000846       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 000848       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 00084A  437F                                 CSYNC    s:12489+24,SPREL
          2 00084B  8CC7 0050                            LDI      @J+20,AUTO
          2 00084D  8D47 0034                            SDI      J,AUTO

     1066    12490    2           B.SS = MOD(J, 60);

  12490   2 00084F  EB80 0000 0000  03                   LAB,B6   0
          2 000852  0027                                 CBD      ;
          2 000853       0206 0003                                BINARY(3,B6,,2),;
          2 000855       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:189  
          2 000857  0027                                 CBD      ;
          2 000858       0407 0034                                BINARY(J,AUTO,,4),;
          2 00085A       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 00085C  002B                                 DDV      ;
          2 00085D       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 00085F       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 000861       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 000863  002A                                 CDB      ;
          2 000864       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 000866       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 000868  437F                                 CSYNC    s:12490+24,SPREL
          2 000869  C847 0051                            LDR,R4   @J+21,AUTO
          2 00086B  CF47 002F                            STR,R4   B+5,AUTO

     1067    12491    2           J = J / 60;

  12491   2 00086D  EB80 0000 0000  03                   LAB,B6   0
          2 000870  0027                                 CBD      ;
          2 000871       0206 0003                                BINARY(3,B6,,2),;
          2 000873       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 000875  0027                                 CBD      ;
          2 000876       0407 0034                                BINARY(J,AUTO,,4),;
          2 000878       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 00087A  002B                                 DDV      ;
          2 00087B       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 00087D       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 00087F       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 000881  002A                                 CDB      ;
          2 000882       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 000884       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 000886  437F                                 CSYNC    s:12491+24,SPREL
          2 000887  8CC7 0050                            LDI      @J+20,AUTO
          2 000889  8D47 0034                            SDI      J,AUTO

     1068    12492    2           B.MI =  MOD(J, 60);

  12492   2 00088B  EB80 0000 0000  03                   LAB,B6   0
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:190  
          2 00088E  0027                                 CBD      ;
          2 00088F       0206 0003                                BINARY(3,B6,,2),;
          2 000891       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 000893  0027                                 CBD      ;
          2 000894       0407 0034                                BINARY(J,AUTO,,4),;
          2 000896       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 000898  002B                                 DDV      ;
          2 000899       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 00089B       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 00089D       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 00089F  002A                                 CDB      ;
          2 0008A0       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 0008A2       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 0008A4  437F                                 CSYNC    s:12492+24,SPREL
          2 0008A5  B847 0051                            LDR,R3   @J+21,AUTO
          2 0008A7  BF47 002E                            STR,R3   B+4,AUTO

     1069    12493    2           B.HH = J / 60;

  12493   2 0008A9  EB80 0000 0000  03                   LAB,B6   0
          2 0008AC  0027                                 CBD      ;
          2 0008AD       0206 0003                                BINARY(3,B6,,2),;
          2 0008AF       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 0008B1  0027                                 CBD      ;
          2 0008B2       0407 0034                                BINARY(J,AUTO,,4),;
          2 0008B4       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 0008B6  002B                                 DDV      ;
          2 0008B7       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 0008B9       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 0008BB       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 0008BD  002A                                 CDB      ;
          2 0008BE       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 0008C0       0407 0050                                BINARY(@J+20,AUTO,,4)
          2 0008C2  437F                                 CSYNC    s:12493+24,SPREL
          2 0008C3  A847 0051                            LDR,R2   @J+21,AUTO
          2 0008C5  AF47 002D                            STR,R2   B+3,AUTO

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:191  
     1070    12494    2           YP=((D1*100-12210)/36525);

  12494   2 0008C7  8CC7 0024                            LDI      D1,AUTO
          2 0008C9  9B80 0000 0011  03                   LAB,B1   +17
          2 0008CC  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 0008CF  8470 FFFF D04E                       AID      -12210,IMO
          2 0008D2  8D47 0050                            SDI      @J+20,AUTO
          2 0008D4  EB80 0000 0000  03                   LAB,B6   0
          2 0008D7  0027                                 CBD      ;
          2 0008D8       0406 0013                                BINARY(19,B6,,4),;
          2 0008DA       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 0008DC  0027                                 CBD      ;
          2 0008DD       0407 0050                                BINARY(@J+20,AUTO,,4),;
          2 0008DF       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 0008E1  002B                                 DDV      ;
          2 0008E2       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 0008E4       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 0008E6       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 0008E8  002A                                 CDB      ;
          2 0008E9       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 0008EB       0407 0052                                BINARY(@J+22,AUTO,,4)
          2 0008ED  437F                                 CSYNC    s:12494+37,SPREL
          2 0008EE  8CC7 0052                            LDI      @J+22,AUTO
          2 0008F0  8D47 000F                            SDI      YP,AUTO

     1071    12495    2           MP=((D1-(36525*YP)/100)*10000)/%DPM;

  12495   2 0008F2  9B80 0000 0013  03                   LAB,B1   +19
          2 0008F5  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 0008F8  8D47 0050                            SDI      @J+20,AUTO
          2 0008FA  EB80 0000 0000  03                   LAB,B6   0
          2 0008FD  0027                                 CBD      ;
          2 0008FE       0206 0001                                BINARY(1,B6,,2),;
          2 000900       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 000902  0027                                 CBD      ;
          2 000903       0407 0050                                BINARY(@J+20,AUTO,,4),;
          2 000905       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:192  
          2 000907  002B                                 DDV      ;
          2 000908       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 00090A       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 00090C       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 00090E  002A                                 CDB      ;
          2 00090F       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 000911       0407 0052                                BINARY(@J+22,AUTO,,4)
          2 000913  8CC7 0024                            LDI      D1,AUTO
          2 000915  437F                                 CSYNC    s:12495+34,SPREL
          2 000916  84C7 0052                            SID      @J+22,AUTO
          2 000918  9B80 0000 0015  03                   LAB,B1   +21
          2 00091B  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 00091E  8D47 0066                            SDI      @J+42,AUTO
          2 000920  EB80 0000 0000  03                   LAB,B6   0
          2 000923  0027                                 CBD      ;
          2 000924       0406 0017                                BINARY(23,B6,,4),;
          2 000926       4C07 0054                                UNPACKED(@J+24,AUTO,,12,LEADING)
          2 000928  0027                                 CBD      ;
          2 000929       0407 0066                                BINARY(@J+42,AUTO,,4),;
          2 00092B       4C07 005A                                UNPACKED(@J+30,AUTO,,12,LEADING)
          2 00092D  002B                                 DDV      ;
          2 00092E       4C07 0054                                UNPACKED(@J+24,AUTO,,12,LEADING),;
          2 000930       4C07 005A                                UNPACKED(@J+30,AUTO,,12,LEADING),;
          2 000932       4C07 0060                                UNPACKED(@J+36,AUTO,,12,LEADING)
          2 000934  002A                                 CDB      ;
          2 000935       4C07 0060                                UNPACKED(@J+36,AUTO,,12,LEADING),;
          2 000937       0407 0068                                BINARY(@J+44,AUTO,,4)
          2 000939  437F                                 CSYNC    s:12495+70,SPREL
          2 00093A  8CC7 0068                            LDI      @J+44,AUTO
          2 00093C  8D47 0011                            SDI      MP,AUTO

     1072    12496    2           B.DD=D1-(36525*YP)/100-(%DPM*MP)/10000;

  12496   2 00093E  8CC7 000F                            LDI      YP,AUTO
          2 000940  9B80 0000 0013  03                   LAB,B1   +19
          2 000943  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000946  8D47 0050                            SDI      @J+20,AUTO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:193  
          2 000948  EB80 0000 0000  03                   LAB,B6   0
          2 00094B  0027                                 CBD      ;
          2 00094C       0206 0001                                BINARY(1,B6,,2),;
          2 00094E       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 000950  0027                                 CBD      ;
          2 000951       0407 0050                                BINARY(@J+20,AUTO,,4),;
          2 000953       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 000955  002B                                 DDV      ;
          2 000956       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 000958       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 00095A       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 00095C  002A                                 CDB      ;
          2 00095D       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 00095F       0407 0052                                BINARY(@J+22,AUTO,,4)
          2 000961  8CC7 0024                            LDI      D1,AUTO
          2 000963  437F                                 CSYNC    s:12496+36,SPREL
          2 000964  84C7 0052                            SID      @J+22,AUTO
          2 000966  8D47 0066                            SDI      @J+42,AUTO
          2 000968  8CC7 0011                            LDI      MP,AUTO
          2 00096A  9B80 0000 0017  03                   LAB,B1   +23
          2 00096D  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000970  8D47 0068                            SDI      @J+44,AUTO
          2 000972  EB80 0000 0000  03                   LAB,B6   0
          2 000975  0027                                 CBD      ;
          2 000976       0206 0016                                BINARY(22,B6,,2),;
          2 000978       4C07 0054                                UNPACKED(@J+24,AUTO,,12,LEADING)
          2 00097A  0027                                 CBD      ;
          2 00097B       0407 0068                                BINARY(@J+44,AUTO,,4),;
          2 00097D       4C07 005A                                UNPACKED(@J+30,AUTO,,12,LEADING)
          2 00097F  002B                                 DDV      ;
          2 000980       4C07 0054                                UNPACKED(@J+24,AUTO,,12,LEADING),;
          2 000982       4C07 005A                                UNPACKED(@J+30,AUTO,,12,LEADING),;
          2 000984       4C07 0060                                UNPACKED(@J+36,AUTO,,12,LEADING)
          2 000986  002A                                 CDB      ;
          2 000987       4C07 0060                                UNPACKED(@J+36,AUTO,,12,LEADING),;
          2 000989       0407 006A                                BINARY(@J+46,AUTO,,4)
          2 00098B  8CC7 0066                            LDI      @J+42,AUTO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:194  
          2 00098D  437F                                 CSYNC    s:12496+78,SPREL
          2 00098E  84C7 006A                            SID      @J+46,AUTO
          2 000990  E857                                 LDR,R6   R7
          2 000991  EF47 002B                            STR,R6   B+1,AUTO

     1073    12497    2           IF MP>13 THEN

  12497   2 000993  8CC7 0011                            LDI      MP,AUTO
          2 000995  84F0 0000 000D                       SID      13,IMO
          2 000998  0681 000F                            BCF      s:12500,PREL
          2 00099A  6981 0003                            BNEZ,R6  s:12498,PREL
          2 00099C  7901 000B                            BEZ,R7   s:12500,PREL

     1074    12498    2              B.MM=MP-13;

  12498   2 00099E  8CC7 0011                            LDI      MP,AUTO
          2 0009A0  8470 FFFF FFF3                       AID      -13,IMO
          2 0009A3  E857                                 LDR,R6   R7
          2 0009A4  EF47 002A                            STR,R6   B,AUTO
          2 0009A6  0F81 0009                            B        s:12501,PREL

     1075    12499    2           ELSE
     1076    12500    2              B.MM=MP-1;

  12500   2 0009A8  8CC7 0011                            LDI      MP,AUTO
          2 0009AA  8470 FFFF FFFF                       AID      -1,IMO
          2 0009AD  E857                                 LDR,R6   R7
          2 0009AE  EF47 002A                            STR,R6   B,AUTO

     1077    12501    2           IF B.MM <= 2 THEN

  12501   2 0009B0  6D02                                 CMV,R6   2
          2 0009B1  0301 000B                            BG       s:12504,PREL

     1078    12502    2              B.YY=YP-1899;

  12502   2 0009B3  8CC7 000F                            LDI      YP,AUTO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:195  
          2 0009B5  8470 FFFF F895                       AID      -1899,IMO
          2 0009B8  E857                                 LDR,R6   R7
          2 0009B9  EF47 002C                            STR,R6   B+2,AUTO
          2 0009BB  0F81 0009                            B        s:12505,PREL

     1079    12503    2           ELSE
     1080    12504    2              B.YY=YP-1900;

  12504   2 0009BD  8CC7 000F                            LDI      YP,AUTO
          2 0009BF  8470 FFFF F894                       AID      -1900,IMO
          2 0009C2  E857                                 LDR,R6   R7
          2 0009C3  EF47 002C                            STR,R6   B+2,AUTO

     1081    12505    2           RETURN;

  12505   2 0009C5  ECC7 0032                            LDB,B6   B+8,AUTO
          2 0009C7  C3C6 0001                            LNJ,B4   1,B6

     1082    12506    2   END UTSDATE;
     1083    12507
     1084    12508        /*    Convert Date and Time to UTS                                 */
     1085    12509
     1086    12510    1   DATEUTS: PROC ALTRET;

  12510   2 0009C9  EFC7 0032            DATEUTS         STB,B6   B+8,AUTO

     1087    12511
     1088    12512    2   DCL J UBIN(32);
     1089    12513    2   DCL HH UBIN(32);
     1090    12514
     1091    12515    2           IF (B.YY < 78 AND B.YY > 20) THEN

  12515   2 0009CB  E847 002C                            LDR,R6   B+2,AUTO
          2 0009CD  6D4E                                 CMV,R6   78
          2 0009CE  0281 0008                            BGE      s:12517,PREL
          2 0009D0  6D14                                 CMV,R6   20
          2 0009D1  0381 0005                            BLE      s:12517,PREL
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:196  

     1092    12516    2              ALTRETURN;

  12516   2 0009D3  ECC7 0032                            LDB,B6   B+8,AUTO
          2 0009D5  B806                                 LDR,R3   ,B6
          2 0009D6  C3B6                                 LNJ,B4   ,B6,R3

     1093    12517    3           IF B.MM < 3 THEN DO;

  12517   2 0009D7  D847 002A                            LDR,R5   B,AUTO
          2 0009D9  5D03                                 CMV,R5   3
          2 0009DA  0281 0011                            BGE      s:12522,PREL

     1094    12518    3              YP=B.YY-1;

  12518   2 0009DC  F856                                 LDR,R7   R6
          2 0009DD  6C00                                 LDV,R6   0
          2 0009DE  8470 FFFF FFFF                       AID      -1,IMO
          2 0009E1  8D47 000F                            SDI      YP,AUTO

     1095    12519    3              MP=B.MM+13;

  12519   2 0009E3  F855                                 LDR,R7   R5
          2 0009E4  6C00                                 LDV,R6   0
          2 0009E5  8470 0000 000D                       AID      13,IMO
          2 0009E8  8D47 0011                            SDI      MP,AUTO

     1096    12520    3              END;

  12520   2 0009EA  0F81 000D                            B        s:12525,PREL

     1097    12521    3           ELSE DO;

     1098    12522    3              MP=B.MM+1;

  12522   2 0009EC  F855                                 LDR,R7   R5
          2 0009ED  6C00                                 LDV,R6   0
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:197  
          2 0009EE  8470 0000 0001                       AID      1,IMO
          2 0009F1  8D47 0011                            SDI      MP,AUTO

     1099    12523    3              YP=B.YY;

  12523   2 0009F3  F847 002C                            LDR,R7   B+2,AUTO
          2 0009F5  6C00                                 LDV,R6   0
          2 0009F6  8D47 000F                            SDI      YP,AUTO

     1100    12524    3              END;

     1101    12525    2           IF B.YY > 77 THEN

  12525   2 0009F8  E847 002C                            LDR,R6   B+2,AUTO
          2 0009FA  6D4D                                 CMV,R6   77
          2 0009FB  0381 005B                            BLE      s:12528,PREL

     1102    12526    2              D1 = (36525*(YP+1900))/100+(%DPM*MP)/10000+B.DD;

  12526   2 0009FD  8CC7 000F                            LDI      YP,AUTO
          2 0009FF  9B80 0000 0013  03                   LAB,B1   +19
          2 000A02  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000A05  8470 0422 EBFC                       AID      69397500,IMO
          2 000A08  8D47 0050                            SDI      @J+20,AUTO
          2 000A0A  EB80 0000 0000  03                   LAB,B6   0
          2 000A0D  0027                                 CBD      ;
          2 000A0E       0206 0001                                BINARY(1,B6,,2),;
          2 000A10       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 000A12  0027                                 CBD      ;
          2 000A13       0407 0050                                BINARY(@J+20,AUTO,,4),;
          2 000A15       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 000A17  002B                                 DDV      ;
          2 000A18       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 000A1A       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 000A1C       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 000A1E  002A                                 CDB      ;
          2 000A1F       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:198  
          2 000A21       0407 0052                                BINARY(@J+22,AUTO,,4)
          2 000A23  8CC7 0011                            LDI      MP,AUTO
          2 000A25  9B80 0000 0017  03                   LAB,B1   +23
          2 000A28  437F                                 CSYNC    s:12526+42,SPREL
          2 000A29  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000A2C  8D47 0066                            SDI      @J+42,AUTO
          2 000A2E  EB80 0000 0000  03                   LAB,B6   0
          2 000A31  0027                                 CBD      ;
          2 000A32       0206 0016                                BINARY(22,B6,,2),;
          2 000A34       4C07 0054                                UNPACKED(@J+24,AUTO,,12,LEADING)
          2 000A36  0027                                 CBD      ;
          2 000A37       0407 0066                                BINARY(@J+42,AUTO,,4),;
          2 000A39       4C07 005A                                UNPACKED(@J+30,AUTO,,12,LEADING)
          2 000A3B  002B                                 DDV      ;
          2 000A3C       4C07 0054                                UNPACKED(@J+24,AUTO,,12,LEADING),;
          2 000A3E       4C07 005A                                UNPACKED(@J+30,AUTO,,12,LEADING),;
          2 000A40       4C07 0060                                UNPACKED(@J+36,AUTO,,12,LEADING)
          2 000A42  002A                                 CDB      ;
          2 000A43       4C07 0060                                UNPACKED(@J+36,AUTO,,12,LEADING),;
          2 000A45       0407 0068                                BINARY(@J+44,AUTO,,4)
          2 000A47  8CC7 0052                            LDI      @J+22,AUTO
          2 000A49  437F                                 CSYNC    s:12526+75,SPREL
          2 000A4A  8447 0068                            AID      @J+44,AUTO
          2 000A4C  8D47 006A                            SDI      @J+46,AUTO
          2 000A4E  F847 002B                            LDR,R7   B+1,AUTO
          2 000A50  6C00                                 LDV,R6   0
          2 000A51  8447 006A                            AID      @J+46,AUTO
          2 000A53  8D47 0024                            SDI      D1,AUTO
          2 000A55  0F81 0059                            B        s:12529,PREL

     1103    12527    2           ELSE
     1104    12528    2              D1 = (36525*(YP+2000))/100+(%DPM*MP)/10000+B.DD;

  12528   2 000A57  8CC7 000F                            LDI      YP,AUTO
          2 000A59  9B80 0000 0013  03                   LAB,B1   +19
          2 000A5C  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000A5F  8470 045A A790                       AID      73050000,IMO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:199  
          2 000A62  8D47 0050                            SDI      @J+20,AUTO
          2 000A64  EB80 0000 0000  03                   LAB,B6   0
          2 000A67  0027                                 CBD      ;
          2 000A68       0206 0001                                BINARY(1,B6,,2),;
          2 000A6A       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 000A6C  0027                                 CBD      ;
          2 000A6D       0407 0050                                BINARY(@J+20,AUTO,,4),;
          2 000A6F       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 000A71  002B                                 DDV      ;
          2 000A72       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 000A74       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 000A76       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 000A78  002A                                 CDB      ;
          2 000A79       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 000A7B       0407 0052                                BINARY(@J+22,AUTO,,4)
          2 000A7D  8CC7 0011                            LDI      MP,AUTO
          2 000A7F  9B80 0000 0017  03                   LAB,B1   +23
          2 000A82  437F                                 CSYNC    s:12528+42,SPREL
          2 000A83  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000A86  8D47 0066                            SDI      @J+42,AUTO
          2 000A88  EB80 0000 0000  03                   LAB,B6   0
          2 000A8B  0027                                 CBD      ;
          2 000A8C       0206 0016                                BINARY(22,B6,,2),;
          2 000A8E       4C07 0054                                UNPACKED(@J+24,AUTO,,12,LEADING)
          2 000A90  0027                                 CBD      ;
          2 000A91       0407 0066                                BINARY(@J+42,AUTO,,4),;
          2 000A93       4C07 005A                                UNPACKED(@J+30,AUTO,,12,LEADING)
          2 000A95  002B                                 DDV      ;
          2 000A96       4C07 0054                                UNPACKED(@J+24,AUTO,,12,LEADING),;
          2 000A98       4C07 005A                                UNPACKED(@J+30,AUTO,,12,LEADING),;
          2 000A9A       4C07 0060                                UNPACKED(@J+36,AUTO,,12,LEADING)
          2 000A9C  002A                                 CDB      ;
          2 000A9D       4C07 0060                                UNPACKED(@J+36,AUTO,,12,LEADING),;
          2 000A9F       0407 0068                                BINARY(@J+44,AUTO,,4)
          2 000AA1  8CC7 0052                            LDI      @J+22,AUTO
          2 000AA3  437F                                 CSYNC    s:12528+75,SPREL
          2 000AA4  8447 0068                            AID      @J+44,AUTO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:200  
          2 000AA6  8D47 006A                            SDI      @J+46,AUTO
          2 000AA8  F847 002B                            LDR,R7   B+1,AUTO
          2 000AAA  6C00                                 LDV,R6   0
          2 000AAB  8447 006A                            AID      @J+46,AUTO
          2 000AAD  8D47 0024                            SDI      D1,AUTO

     1105    12529    2           HH = B.HH;

  12529   2 000AAF  F847 002D                            LDR,R7   B+3,AUTO
          2 000AB1  6C00                                 LDV,R6   0
          2 000AB2  8D47 0036                            SDI      HH,AUTO

     1106    12530    2           TUNITS = (((HH*60+B.MI)*60+B.SS)*100+B.SS00) * 10; /* time in msecs   */

  12530   2 000AB4  F847 002E                            LDR,R7   B+4,AUTO
          2 000AB6  6C00                                 LDV,R6   0
          2 000AB7  8D47 003E                            SDI      @J+2,AUTO
          2 000AB9  8CC7 0036                            LDI      HH,AUTO
          2 000ABB  9B80 0000 0019  03                   LAB,B1   +25
          2 000ABE  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000AC1  8447 003E                            AID      @J+2,AUTO
          2 000AC3  8D47 0040                            SDI      @J+4,AUTO
          2 000AC5  F847 002F                            LDR,R7   B+5,AUTO
          2 000AC7  6C00                                 LDV,R6   0
          2 000AC8  8D47 0042                            SDI      @J+6,AUTO
          2 000ACA  8CC7 0040                            LDI      @J+4,AUTO
          2 000ACC  9B80 0000 0019  03                   LAB,B1   +25
          2 000ACF  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000AD2  8447 0042                            AID      @J+6,AUTO
          2 000AD4  8D47 0044                            SDI      @J+8,AUTO
          2 000AD6  F847 0030                            LDR,R7   B+6,AUTO
          2 000AD8  6C00                                 LDV,R6   0
          2 000AD9  8D47 0046                            SDI      @J+10,AUTO
          2 000ADB  8CC7 0044                            LDI      @J+8,AUTO
          2 000ADD  9B80 0000 0011  03                   LAB,B1   +17
          2 000AE0  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000AE3  8447 0046                            AID      @J+10,AUTO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:201  
          2 000AE5  9B80 0000 001B  03                   LAB,B1   +27
          2 000AE8  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000AEB  8D47 0016                            SDI      TUNITS,AUTO

     1107    12531    2           J = (TUNITS * 3 + 200) / 400;   /* TUNs in tics                       */

  12531   2 000AED  9B80 0000 001D  03                   LAB,B1   +29
          2 000AF0  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000AF3  8470 0000 00C8                       AID      200,IMO
          2 000AF6  8D47 0050                            SDI      @J+20,AUTO
          2 000AF8  EB80 0000 0000  03                   LAB,B6   0
          2 000AFB  0027                                 CBD      ;
          2 000AFC       0206 001F                                BINARY(31,B6,,2),;
          2 000AFE       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING)
          2 000B00  0027                                 CBD      ;
          2 000B01       0407 0050                                BINARY(@J+20,AUTO,,4),;
          2 000B03       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING)
          2 000B05  002B                                 DDV      ;
          2 000B06       4C07 003E                                UNPACKED(@J+2,AUTO,,12,LEADING),;
          2 000B08       4C07 0044                                UNPACKED(@J+8,AUTO,,12,LEADING),;
          2 000B0A       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING)
          2 000B0C  002A                                 CDB      ;
          2 000B0D       4C07 004A                                UNPACKED(@J+14,AUTO,,12,LEADING),;
          2 000B0F       0407 0052                                BINARY(@J+22,AUTO,,4)
          2 000B11  437F                                 CSYNC    s:12531+35,SPREL
          2 000B12  8CC7 0052                            LDI      @J+22,AUTO
          2 000B14  8D47 0034                            SDI      J,AUTO

     1108    12532    2           IF (D1 < ELL OR (D1 = ELL AND J < ELLU) OR

  12532   2 000B16  8CC7 0024                            LDI      D1,AUTO
          2 000B18  8480 0000 0012  00                   SID      ELL
          2 000B1B  0681 002C                            BCF      s:12534,PREL
          2 000B1D  8CC7 0024                            LDI      D1,AUTO
          2 000B1F  8480 0000 0012  00                   SID      ELL
          2 000B22  6981 000A                            BNEZ,R6  s:12532+23,PREL
          2 000B24  7981 0008                            BNEZ,R7  s:12532+23,PREL
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:202  
          2 000B26  8CC7 0034                            LDI      J,AUTO
          2 000B28  8480 0000 0014  00                   SID      ELLU
          2 000B2B  0681 001C                            BCF      s:12534,PREL
          2 000B2D  8CC7 0024                            LDI      D1,AUTO
          2 000B2F  8480 0000 0016  00                   SID      EUL
          2 000B32  6981 0003                            BNEZ,R6  s:12532+32,PREL
          2 000B34  7901 0003                            BEZ,R7   s:12532+34,PREL
          2 000B36  0601 0011                            BCT      s:12534,PREL
          2 000B38  8CC7 0024                            LDI      D1,AUTO
          2 000B3A  8480 0000 0016  00                   SID      EUL
          2 000B3D  6981 0010                            BNEZ,R6  s:12535,PREL
          2 000B3F  7981 000E                            BNEZ,R7  s:12535,PREL
          2 000B41  8CC7 0034                            LDI      J,AUTO
          2 000B43  8480 0000 0018  00                   SID      EULU
          2 000B46  0681 0007                            BCF      s:12535,PREL

     1109    12533    2             (D1 > EUL) OR (D1 = EUL AND J >= EULU)) THEN
     1110    12534    2              UTIME = 0;

  12534   2 000B48  8747 0008                            CL       UTIME,AUTO
          2 000B4A  8747 0009                            CL       UTIME+1,AUTO
          2 000B4C  0F81 0042                            B        s:12539,PREL

     1111    12535    2           ELSE IF D1 > BD(1) OR (D1 = BD(1) AND J >= U1(1)) THEN

  12535   2 000B4E  8CC7 0024                            LDI      D1,AUTO
          2 000B50  8480 0000 0004  00                   SID      BD+2
          2 000B53  6981 0003                            BNEZ,R6  s:12535+9,PREL
          2 000B55  7901 0003                            BEZ,R7   s:12535+11,PREL
          2 000B57  0601 0011                            BCT      s:12536,PREL
          2 000B59  8CC7 0024                            LDI      D1,AUTO
          2 000B5B  8480 0000 0004  00                   SID      BD+2
          2 000B5E  6981 001E                            BNEZ,R6  s:12538,PREL
          2 000B60  7981 001C                            BNEZ,R7  s:12538,PREL
          2 000B62  8CC7 0034                            LDI      J,AUTO
          2 000B64  8480 0000 000C  00                   SID      U1+2
          2 000B67  0681 0015                            BCF      s:12538,PREL
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:203  

     1112    12536    2                 UTIME = (D1 - BD(1)) * %TICS_DAY + J - U1(1);

  12536   2 000B69  8CC7 0024                            LDI      D1,AUTO
          2 000B6B  8480 0000 0004  00                   SID      BD+2
          2 000B6E  9B80 0000 000C  03                   LAB,B1   +12
          2 000B71  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000B74  8447 0034                            AID      J,AUTO
          2 000B76  8480 0000 000C  00                   SID      U1+2
          2 000B79  8D47 0008                            SDI      UTIME,AUTO
          2 000B7B  0F81 0013                            B        s:12539,PREL

     1113    12537    2              ELSE
     1114    12538    2                 UTIME = (D1 - BD(3)) * %TICS_DAY + J - U1(3);

  12538   2 000B7D  8CC7 0024                            LDI      D1,AUTO
          2 000B7F  8480 0000 0008  00                   SID      BD+6
          2 000B82  9B80 0000 000C  03                   LAB,B1   +12
          2 000B85  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000B88  8447 0034                            AID      J,AUTO
          2 000B8A  8480 0000 0010  00                   SID      U1+6
          2 000B8D  8D47 0008                            SDI      UTIME,AUTO

     1115    12539    2           RETURN;

  12539   2 000B8F  ECC7 0032                            LDB,B6   B+8,AUTO
          2 000B91  C3C6 0001                            LNJ,B4   1,B6

     1116    12540    2   END DATEUTS;
     1117    12541        /*                                                                    */
     1118    12542        %EJECT;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:204  
     1119    12543
     1120    12544    1   DSIZE:  PROC (I,J) ALTRET;

  12544   2 000B93  EFC7 0038            DSIZE           STB,B6   HH+2,AUTO

     1121    12545
     1122    12546    2   DCL I UBIN;
     1123    12547    2   DCL J UBIN;
     1124    12548
     1125    12549    3           IF PARM.PTRS_ARRAY(I) = ADDR(NIL) THEN DO;

  12549   2 000B95  DCC7 003A                            LDB,B5   @I,AUTO
          2 000B97  B805                                 LDR,R3   ,B5
          2 000B98  CCC7 0004                            LDB,B4   @PARM,AUTO
          2 000B9A  3E03                                 ADV,R3   3
          2 000B9B  8DB4                                 CMN      ,B4,R3
          2 000B9C  0981 0008                            BNE      s:12554,PREL

     1126    12550    3              J=0;

  12550   2 000B9E  BCC7 003C                            LDB,B3   @J,AUTO
          2 000BA0  8703                                 CL       ,B3

     1127    12551    3              ALTRETURN;

  12551   2 000BA1  ECC7 0038                            LDB,B6   HH+2,AUTO
          2 000BA3  B806                                 LDR,R3   ,B6
          2 000BA4  C3B6                                 LNJ,B4   ,B6,R3

     1128    12552    3              END;
     1129    12553    2           ELSE
     1130    12554    2              J=PARM.BND_ARRAY(I)+1;

  12554   2 000BA5  B805                                 LDR,R3   ,B5
          2 000BA6  3E26                                 ADV,R3   38
          2 000BA7  BCC7 003C                            LDB,B3   @J,AUTO
          2 000BA9  E834                                 LDR,R6   ,B4,R3
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:205  
          2 000BAA  6E01                                 ADV,R6   1
          2 000BAB  EF03                                 STR,R6   ,B3

     1131    12555    2           RETURN;

  12555   2 000BAC  ECC7 0038                            LDB,B6   HH+2,AUTO
          2 000BAE  C3C6 0001                            LNJ,B4   1,B6

     1132    12556    2   END DSIZE;
     1133    12557        %EJECT;
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:206  
     1134    12558        /*       Set UTS                  */
     1135    12559    1   GUS$SETTIME: ENTRY (PARM);

  12559   2 000BB0  D380 0000 0000  xent GUS$SETTIME     LNJ,B5   X6A_AUTO_1
          2 000BB3       006C 0001                       DC       108,1

     1136    12560
     1137    12561    1           UTI = ADDR(PARM)->A;            /* 36 bit boot uts scaled at b4       */

  12561   2 000BB5  ECC7 0004                            LDB,B6   @PARM,AUTO
          2 000BB7  8C86                                 LDI      ,B6
          2 000BB8  8D47 000A                            SDI      UTI,AUTO

     1138    12562    1           ERA = UTIX.QTR / 3;

  12562   2 000BBA  D847 000A                            LDR,R5   UTI,AUTO
          2 000BBC  504C                                 SOR,R5   12
          2 000BBD  D370 0003                            DIV,R5   3,IMO
          2 000BBF  DF47 0006                            STR,R5   ERA,AUTO

     1139    12563    1           QTR = MOD (UTIX.QTR,3);

  12563   2 000BC1  F847 000A                            LDR,R7   UTI,AUTO
          2 000BC3  704C                                 SOR,R7   12
          2 000BC4  6C00                                 LDV,R6   0
          2 000BC5  F370 0003                            DIV,R7   3,IMO
          2 000BC7  EF47 0007                            STR,R6   QTR,AUTO

     1140    12564                                      /* compute time to beginning of current era     */
     1141    12565    1           BD(0) = BASEDAYS + (ERA * %DAYS_ERA);

  12565   2 000BC9  F855                                 LDR,R7   R5
          2 000BCA  6C00                                 LDV,R6   0
          2 000BCB  9B80 0000 0020  03                   LAB,B1   +32
          2 000BCE  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000BD1  8400 0000 0000  01                   AID      BASEDAYS
          2 000BD4  8D00 0000 0002  00                   SDI      BD
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:207  

     1142    12566    1           BD(1) = BD(0);

  12566   2 000BD7  8D00 0000 0004  00                   SDI      BD+2

     1143    12567    1           BD(2) = BD(0);

  12567   2 000BDA  8D00 0000 0006  00                   SDI      BD+4

     1144    12568    1           U1(0) = (ERA * %UTS_ERA);

  12568   2 000BDD  F847 0006                            LDR,R7   ERA,AUTO
          2 000BDF  6C00                                 LDV,R6   0
          2 000BE0  9B80 0000 0022  03                   LAB,B1   +34
          2 000BE3  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000BE6  8D00 0000 000A  00                   SDI      U1

     1145    12569    1           U1(1) = U1(0);

  12569   2 000BE9  8D00 0000 000C  00                   SDI      U1+2

     1146    12570    1           U1(2) = U1(0);

  12570   2 000BEC  8D00 0000 000E  00                   SDI      U1+4

     1147    12571    2           IF (ERA > 0 AND QTR = 0) THEN DO;
             12571                    /* in 1st qtr : qtr 4 = qtr 3 of last era */

  12571   2 000BEF  D847 0006                            LDR,R5   ERA,AUTO
          2 000BF1  5901 0043                            BEZ,R5   s:12582,PREL
          2 000BF3  C847 0007                            LDR,R4   QTR,AUTO
          2 000BF5  4981 003F                            BNEZ,R4  s:12582,PREL

     1148    12572    2              BD(3) = BD(0) - %DAYS_ERA;

  12572   2 000BF7  8C80 0000 0002  00                   LDI      BD
          2 000BFA  8470 FFFF EC95                       AID      -4971,IMO
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:208  
          2 000BFD  8D00 0000 0008  00                   SDI      BD+6

     1149    12573    2              U1(3) = U1(0) - %UTS_ERA;

  12573   2 000C00  8C80 0000 000A  00                   LDI      U1
          2 000C03  8470 FFFF BBC0                       AID      -17472,IMO
          2 000C06  8D00 0000 0010  00                   SDI      U1+6

     1150    12574    2              BD(2) = BD(3);

  12574   2 000C09  8C80 0000 0008  00                   LDI      BD+6
          2 000C0C  8D00 0000 0006  00                   SDI      BD+4

     1151    12575    2              U1(2) = U1(3);

  12575   2 000C0F  8C80 0000 0010  00                   LDI      U1+6
          2 000C12  8D00 0000 000E  00                   SDI      U1+4

     1152    12576    2              ELL = BD(3) + (2 * %DAYS_QTR);

  12576   2 000C15  8C80 0000 0008  00                   LDI      BD+6
          2 000C18  8470 0000 0CF2                       AID      3314,IMO
          2 000C1B  8D00 0000 0012  00                   SDI      ELL

     1153    12577    2              EUL = ELL + (3 * %DAYS_QTR);

  12577   2 000C1E  8470 0000 136B                       AID      4971,IMO
          2 000C21  8D00 0000 0016  00                   SDI      EUL

     1154    12578    2              ELLU = U1(3) + (2 * %UTS_QTR);

  12578   2 000C24  8C80 0000 0010  00                   LDI      U1+6
          2 000C27  8470 0000 2D80                       AID      11648,IMO
          2 000C2A  8D00 0000 0014  00                   SDI      ELLU

     1155    12579    2              EULU = ELLU + (3 * %UTS_QTR);

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:209  
  12579   2 000C2D  8470 0000 4440                       AID      17472,IMO
          2 000C30  8D00 0000 0018  00                   SDI      EULU

     1156    12580    2              END;

  12580   2 000C33  0F81 002B                            B        s:12589,PREL

     1157    12581    2           ELSE DO;         /* in 2nd or 3rd qtr : qtr 4 = qtr 0 of next era     */

     1158    12582    2              BD(3) = BD(0);

  12582   2 000C35  8C80 0000 0002  00                   LDI      BD
          2 000C38  8D00 0000 0008  00                   SDI      BD+6

     1159    12583    2              U1(3) = U1(0);

  12583   2 000C3B  8C80 0000 000A  00                   LDI      U1
          2 000C3E  8D00 0000 0010  00                   SDI      U1+6

     1160    12584    2              ELL = BD(0);

  12584   2 000C41  8C80 0000 0002  00                   LDI      BD
          2 000C44  8D00 0000 0012  00                   SDI      ELL

     1161    12585    2              ELLU = U1(0);

  12585   2 000C47  8C80 0000 000A  00                   LDI      U1
          2 000C4A  8D00 0000 0014  00                   SDI      ELLU

     1162    12586    2              EUL = ELL + (4 * %DAYS_QTR);

  12586   2 000C4D  8C80 0000 0012  00                   LDI      ELL
          2 000C50  8470 0000 19E4                       AID      6628,IMO
          2 000C53  8D00 0000 0016  00                   SDI      EUL

     1163    12587    2              EULU = ELLU + (4 * %UTS_QTR);

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:210  
  12587   2 000C56  8C80 0000 0014  00                   LDI      ELLU
          2 000C59  8470 0000 5B00                       AID      23296,IMO
          2 000C5C  8D00 0000 0018  00                   SDI      EULU

     1164    12588    2              END;

     1165    12589    1           CALL GHI$UTS (UTIME);

  12589   2 000C5F  EBC7 0008                            LAB,B6   UTIME,AUTO
          2 000C61  EFC7 003E                            STB,B6   @J+2,AUTO
          2 000C63  BBC7 003E                            LAB,B3   @J+2,AUTO
          2 000C65  CBF0 0100                            LAB,B4   256,IMO
          2 000C67  E380 0000 0000  xent                 LNJ,B6   GHI$UTS
          2 000C6A       0001                            DC       s:12592,PREL

     1166    12590                       /* toss era and scale uts correctly, deduct time since boot*/
     1167    12591                                           /* adjust uts to correct era beginning     */
     1168    12592    1           UTIME = (UTI + (ERA * BITBIN('10000000'X))) * 4 - UTIME;

  12592   2 000C6B  F847 0006                            LDR,R7   ERA,AUTO
          2 000C6D  6C00                                 LDV,R6   0
          2 000C6E  9B80 0000 0056  01                   LAB,B1   DELM+5
          2 000C71  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          2 000C74  8447 000A                            AID      UTI,AUTO
          2 000C76  7082                                 DOL,R7   2
          2 000C77  8656                                 CPL      R6
          2 000C78  8657                                 CPL      R7
          2 000C79  8470 0000 0001                       AID      1,IMO
          2 000C7C  8447 0008                            AID      UTIME,AUTO
          2 000C7E  8656                                 CPL      R6
          2 000C7F  8657                                 CPL      R7
          2 000C80  8470 0000 0001                       AID      1,IMO
          2 000C83  8D47 0008                            SDI      UTIME,AUTO

     1169    12593    1           IF G$MHJIT.BOOTUTS = 0 THEN

  12593   2 000C85  EC80 0000 0000  xsym                 LDB,B6   G$MHJIT$
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:211  
          2 000C88  8CC6 035A                            LDI      858,B6
          2 000C8A  84F0 0000 0000                       SID      0,IMO
          2 000C8D  6981 0008                            BNEZ,R6  s:12595,PREL
          2 000C8F  7981 0006                            BNEZ,R7  s:12595,PREL

     1170    12594    1              PS_LCP6STT.BOOT_UTS = UTIME;

  12594   2 000C91  8CC7 0008                            LDI      UTIME,AUTO
          2 000C93  8D00 0000 0034  xsym                 SDI      PS_LCP6STT+52

     1171    12595    1           G$MHJIT.BOOTUTS = UTIME;

  12595   2 000C96  8CC7 0008                            LDI      UTIME,AUTO
          2 000C98  8D46 035A                            SDI      858,B6

     1172    12596    1           G_BOOTTIME = UTIME;

  12596   2 000C9A  8D00 0000 0000  00                   SDI      G_BOOTTIME

     1173    12597    1           RETURN;

  12597   2 000C9D  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
     1174    12598    1   END;

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:212  
--  Include file information  --

   UD_ERRORS_C.:E05TOU  is referenced.
   UM_ERRORS_C.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   P_FEP_M.:E05TOU  is referenced.
   G_HJIT_M.:E05TOU  is referenced.
   GU_MACROS_M.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure GUS$TIME.
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:213  

 **** Variables and constants ****

  ****  Section 000  Data  GUS$TIME

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/w UBIN(32)    r     1 BD(0:3)                   24-0-0/w UBIN(16)    r     1 BIAS
    12-0-0/w UBIN(32)    r     1 ELL                       14-0-0/w UBIN(32)    r     1 ELLU
    16-0-0/w UBIN(32)    r     1 EUL                       18-0-0/w UBIN(32)    r     1 EULU
     0-0-0/w UBIN(32)    r     1 G_BOOTTIME                 A-0-0/w UBIN(32)    r     1 U1(0:3)
    1C-0-0/w UBIN(16)    r     1 V1SIZE(0:3)               20-0-0/w UBIN(16)    r     1 V3SIZE(0:3)

  ****  Section 001 RoData GUS$TIME

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN(32)    r     1 BASEDAYS                  51-0-0/c CHAR        r     1 DELM(0:6)
    4A-0-0/w UBIN(16)    r     1 HI(0:6)                   43-0-0/w UBIN(16)    r     1 LO(0:6)
    25-0-0/w UBIN(16)    r     1 MONS(0:12)                 D-0-0/c CHAR(4)     r     1 MONTH(0:11)
    37-0-0/w STRC(32)    r     1 SRCERR                    3B-0-0/w STRC(32)    r     1 V1ERR
    3F-0-0/w STRC(32)    r     1 V3ERR                     39-0-0/w STRC(32)    r     1 V4ERR
     2-0-0/c CHAR(3)     r     1 WKDAY(0:6)                41-0-0/w STRC(32)    r     1 YRERR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    34-0-0/w PTR         r     1 @DATE                     3A-0-0/w PTR         r     1 @I
    3C-0-0/w PTR         r     1 @J                         4-0-0/w PTR         r     1 @PARM
    36-0-0/w PTR         r     1 @TIME                     2A-0-0/w STRC(112)   r     1 B
    24-0-0/w UBIN(32)    r     1 D1                        *0-0-0/c CHAR(8)     r     1 DATE
    22-0-0/c CHAR(2)     r     1 DAY                       2A-0-0/w UBIN(16)    r     1 DT(0:6)
    *0-0-0/c CHAR        r     1 DTCHR(0:7)                15-0-0/w UBIN(16)    r     1 DTSZ
     6-0-0/w UBIN(16)    r     1 ERA                       36-0-0/w UBIN(32)    r     1 HH
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:214  
    20-0-0/c CHAR(2)     r     1 HRS                       1A-0-0/c CHAR(2)     r     1 HSEC
     C-0-0/w UBIN(16)    r     1 I                         *0-0-0/w UBIN(16)    r     1 I
     D-0-0/w UBIN(16)    r     1 J                         34-0-0/w UBIN(32)    r     1 J
    34-0-0/w UBIN(32)    r     1 J                         *0-0-0/w UBIN(16)    r     1 J
    29-0-0/w UBIN(16)    r     1 JD                        27-0-0/c CHAR(3)     r     1 JDAY
     E-0-0/w UBIN(16)    r     1 K                         1F-0-0/c CHAR(2)     r     1 MINS
    21-0-0/c CHAR(2)     r     1 MON                       11-0-0/w UBIN(32)    r     1 MP
    18-0-0/w PTR         r     1 P1$                       *0-0-0/w STRC(1280)  r     1 PARM
     7-0-0/w UBIN(16)    r     1 QTR                       1B-0-0/c CHAR(2)     r     1 SEC
    1C-0-0/c CHAR(6)     r     1 SECONDS                   *0-0-0/c CHAR(11)    r     1 TIME
    *0-0-0/c CHAR        r     1 TMCHR(0:10)               13-0-0/w UBIN(16)    r     1 TMSZ
    14-0-0/w UBIN(8)     r     1 TMSZZ                     16-0-0/w UBIN(32)    r     1 TUNITS
    36-0-0/w UBIN(32)    r     1 U                          A-0-0/w UBIN(32)    r     1 UTI
     8-0-0/w UBIN(32)    r     1 UTIME                      8-0-0/w STRC(32)    r     1 UTIMEX
     A-0-0/w STRC(32)    r     1 UTIX                      26-0-0/w UBIN(16)    r     1 WKD
     F-0-0/w UBIN(32)    r     1 YP                        23-0-0/c CHAR(2)     r     1 YR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 G$MHJIT$                   0-0-0/w STRC(2208)  r     1 PS_LCP6STT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c UBIN(32)    r     1 A                          0-0-0/w STRC(16)    r     1 FPT_TIMEV
     0-0-0/w STRC(27232) r     1 G$MHJIT                    0-0-0/w BIT         r     1 NEGFLAG
     0-0-0/c CHAR(10)    r     1 ST10                       0-0-0/c CHAR(3)     r     1 ST3
     0-0-0/c CHAR(5)     r     1 ST5                        0-0-0/c CHAR(6)     r     1 ST6
     0-0-0/c CHAR(8)     r     1 ST8                        0-0-0/c ACHR        r     1 STTMSZ

PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:215  

   Procedure GUS$TIME requires 3232 words for executable code.
   Procedure GUS$TIME requires 108 words of local(AUTO) storage.

    No errors detected in file GUS$SCHD.:E05TSI    .
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:216  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:217  
          MINI XREF LISTING

A
      4382**DCL     12240<>CALL    12240<>CALL    12242<>CALL    12242<>CALL    12249>>ASSIGN  12253>>ASSIGN
     12287<<ASSIGN  12326<<ASSIGN  12561>>ASSIGN
ANSDATE IN PROCEDURE LCLDATE
     12429**ENTRY   12240--CALL
B
      4419**DCL      4427--REDEF    4428--REDEF   12233<<ASSIGN
B.DD
      4421**DCL     12263>>ASSIGN  12273>>CALLBLT 12392<<CALLBLT 12421>>IF      12421>>IF      12496<<ASSIGN
     12526>>ASSIGN  12528>>ASSIGN
B.HH
      4423**DCL     12260<<ASSIGN  12271>>CALLBLT 12493<<ASSIGN  12529>>ASSIGN
B.MI
      4424**DCL     12259<<ASSIGN  12272>>CALLBLT 12492<<ASSIGN  12530>>ASSIGN
B.MM
      4420**DCL     12263>>ASSIGN  12264>>IF      12274>>CALLBLT 12299>>CALLBLT 12391<<CALLBLT 12421>>IF
     12421>>IF      12421>>IF      12498<<ASSIGN  12500<<ASSIGN  12501>>IF      12517>>IF      12519>>ASSIGN
     12522>>ASSIGN
B.SS
      4425**DCL     12258<<ASSIGN  12269>>CALLBLT 12490<<ASSIGN  12530>>ASSIGN
B.SS00
      4426**DCL     12257<<ASSIGN  12270>>CALLBLT 12488<<ASSIGN  12530>>ASSIGN
B.YY
      4422**DCL     12264>>IF      12266>>ASSIGN  12267>>ASSIGN  12275>>CALLBLT 12393<<CALLBLT 12421>>IF
     12502<<ASSIGN  12504<<ASSIGN  12515>>IF      12515>>IF      12518>>ASSIGN  12523>>ASSIGN  12525>>IF
BADV1
     12355**LABEL   12292--GOTO
BADV3
     12357**LABEL   12312--GOTO
BADYR
     12353**LABEL   12286--CALLALT
BASEDAYS
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:218  
      4370**DCL     12565>>ASSIGN
BD
      4362**DCL     12485>>ASSIGN  12535>>IF      12535>>IF      12536>>ASSIGN  12538>>ASSIGN  12565<<ASSIGN
     12566<<ASSIGN  12566>>ASSIGN  12567<<ASSIGN  12567>>ASSIGN  12572<<ASSIGN  12572>>ASSIGN  12574<<ASSIGN
     12574>>ASSIGN  12576>>ASSIGN  12582<<ASSIGN  12582>>ASSIGN  12584>>ASSIGN
BIAS IN PROCEDURE UTSDATE
     12460**DCL     12474<<ASSIGN  12477<<ASSIGN  12477>>ASSIGN  12482<<ASSIGN  12485>>ASSIGN
D1
      4415**DCL     12267<<ASSIGN  12268>>ASSIGN  12485<<ASSIGN  12494>>ASSIGN  12495>>ASSIGN  12496>>ASSIGN
     12526<<ASSIGN  12528<<ASSIGN  12532>>IF      12532>>IF      12532>>IF      12532>>IF      12535>>IF
     12535>>IF      12536>>ASSIGN  12538>>ASSIGN
DATE IN PROCEDURE LCLDATE
     12370**DCL     12368--PROC    12371--REDEF   12387>>CALLBLT 12388>>CALLBLT 12391>>CALLBLT 12392>>CALLBLT
     12393>>CALLBLT 12429--ENTRY   12440>>CALLBLT 12441>>CALLBLT 12442>>CALLBLT
DATERR IN PROCEDURE LCLDATE
     12450**LABEL   12378--CALLALT 12385--GOTO    12387--CALLALT 12388--CALLALT 12390--GOTO    12400--GOTO
     12406--GOTO    12419--GOTO    12423--GOTO    12431--CALLALT 12433--GOTO    12435--GOTO    12438--GOTO
DATEUTS
     12510**PROC    12286--CALL    12325--CALL
DAY
      4413**DCL     12273<<CALLBLT 12295>>CALLBLT 12297>>CALLBLT 12299>>CALLBLT
DELM IN PROCEDURE LCLDATE
     12376**DCL     12407>>CALLBLT
DSIZE
     12544**PROC    12248--CALL    12252--CALL    12283--CALL    12290--CALL    12301--CALL    12310--CALL
     12320--CALL    12378--CALL    12379--CALL    12431--CALL    12432--CALL
DT
      4427**DCL     12412<<CALLBLT 12413<<ASSIGN  12413>>ASSIGN  12419>>IF      12419>>IF      12440<<CALLBLT
     12441<<CALLBLT 12442<<CALLBLT 12446<<CALLBLT
DTCHR IN PROCEDURE LCLDATE
     12371**DCL     12384>>IF      12384>>IF      12384>>IF      12435>>IF      12435>>IF
DTERR
     12361**LABEL   12240--CALLALT 12242--CALLALT
DTSZ
      4398**DCL     12378<>CALL    12383>>DOINDEX 12389>>IF      12393>>CALLBLT 12431<>CALL    12433>>IF
     12434>>IF
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:219  
ELL
      4364**DCL     12532>>IF      12532>>IF      12576<<ASSIGN  12577>>ASSIGN  12584<<ASSIGN  12586>>ASSIGN
ELLU
      4365**DCL     12532>>IF      12578<<ASSIGN  12579>>ASSIGN  12585<<ASSIGN  12587>>ASSIGN
ERA
      4368**DCL     12562<<ASSIGN  12565>>ASSIGN  12568>>ASSIGN  12571>>IF      12592>>ASSIGN
ERRXIT
     12362**LABEL   12354--GOTO    12356--GOTO    12358--GOTO    12360--GOTO
EUL
      4366**DCL     12532>>IF      12532>>IF      12577<<ASSIGN  12586<<ASSIGN
EULU
      4367**DCL     12532>>IF      12579<<ASSIGN  12587<<ASSIGN
FPT_TIMEV.DEST
      4464**DCL     12280>>DOCASE  12291>>IF      12293>>DOCASE  12303>>DOCASE  12311>>IF      12313>>DOCASE
FPT_TIMEV.SOURCE
      4464**DCL     12237>>DOCASE  12321>>IF      12321>>IF
G$MHJIT.BOOTUTS
     10813**DCL     12245>>ASSIGN  12255>>ASSIGN  12593>>IF      12595<<ASSIGN
G$MHJIT.INTCON.HHJIT
     10945**DCL     10945--REDEF
G$MHJIT.INTCON.P$$
     10918**DCL     10918--REDEF
G$MHJIT.ISA_BIGFOOT.P$$
      7863**DCL      7863--REDEF
G$MHJIT.ISA_DBINH.P$$
      9077**DCL      9077--REDEF
G$MHJIT.ISA_IDLE.P$$
      5958**DCL      5958--REDEF
G$MHJIT.ISA_LVL10.P$$
      9380**DCL      9380--REDEF
G$MHJIT.ISA_LVL11.P$$
      9683**DCL      9683--REDEF
G$MHJIT.ISA_LVL12.P$$
      9986**DCL      9986--REDEF
G$MHJIT.ISA_LVL5.P$$
      8166**DCL      8166--REDEF
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:220  
G$MHJIT.ISA_OV.P$$
      7560**DCL      7560--REDEF
G$MHJIT.ISA_PFS.P$$
      7231**DCL      7231--REDEF
G$MHJIT.ISA_RT_CLOCK.P$$
     10593**DCL     10593--REDEF
G$MHJIT.ISA_SATYR_RCV.P$$
      8470**DCL      8470--REDEF
G$MHJIT.ISA_SATYR_TRN.P$$
      8774**DCL      8774--REDEF
G$MHJIT.ISA_SCHD.P$$
     10289**DCL     10289--REDEF
G$MHJIT.ISA_WDOG.P$$
      7339**DCL      7339--REDEF
G$MHJIT.TSA_DB.ISA.P$$
      6561**DCL      6561--REDEF
G$MHJIT.TSA_DB.P$$
      6432**DCL      6432--REDEF    6433--REDEF
G$MHJIT.TSA_HND.ISA.P$$
     11139**DCL     11139--REDEF
G$MHJIT.TSA_HND.P$$
     11010**DCL     11010--REDEF   11011--REDEF
G$MHJIT.TSA_MON.ISA.P$$
      6173**DCL      6173--REDEF
G$MHJIT.TSA_MON.P$$
      6044**DCL      6044--REDEF    6045--REDEF
G$MHJIT.TSA_OV.ISA.P$$
      6949**DCL      6949--REDEF
G$MHJIT.TSA_OV.P$$
      6820**DCL      6820--REDEF    6821--REDEF
G$MHJIT$
     12153**DCL      4483--IMP-PTR 12245>>ASSIGN  12255>>ASSIGN  12593>>IF      12595>>ASSIGN
GHI$UTS
      4355**DCL-ENT 12244--CALL    12254--CALL    12589--CALL
G_BOOTTIME
      4357**DCL     12596<<ASSIGN
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:221  
HH IN PROCEDURE DATEUTS
     12513**DCL     12529<<ASSIGN  12530>>ASSIGN
HI IN PROCEDURE LCLDATE
     12375**DCL     12419>>IF
HRS
      4411**DCL     12271<<CALLBLT 12305>>CALLBLT 12308>>CALLBLT
HSEC
      4407**DCL     12270<<CALLBLT 12305>>CALLBLT 12307>>CALLBLT
I
      4391**DCL     12383<<DOINDEX 12384>>IF      12384>>IF      12384>>IF      12387<<CALLBLT 12388>>CALLBLT
     12389>>IF      12389>>IF      12391>>CALLBLT 12392>>CALLBLT 12392>>CALLBLT 12397<<DOINDEX 12398>>IF
     12398>>IF      12398>>IF      12398>>IF      12403<<ASSIGN  12405>>IF      12407>>CALLBLT 12412>>CALLBLT
     12413>>IF      12416<<ASSIGN  12416>>ASSIGN  12418<<DOINDEX 12419>>IF      12419>>IF      12419>>IF
     12419>>IF      12434<<DOINDEX 12435>>IF      12435>>IF      12437<<DOINDEX 12438>>IF      12438>>IF
     12445<<DOINDEX 12446>>CALLBLT
I IN PROCEDURE DSIZE
     12546**DCL     12544--PROC    12549>>IF      12554>>ASSIGN
J
      4392**DCL     12248<>CALL    12252<>CALL    12283<>CALL    12284>>IF      12290<>CALL    12291>>IF
     12310<>CALL    12311>>IF      12320<>CALL    12323>>IF      12388<<CALLBLT 12389>>IF      12389>>IF
     12392>>CALLBLT 12393>>CALLBLT 12393>>CALLBLT 12402<<ASSIGN  12404>>DOWHILE 12407>>CALLBLT 12411>>IF
     12412>>CALLBLT 12412>>CALLBLT 12413>>IF      12415<<ASSIGN
J IN PROCEDURE DATEUTS
     12512**DCL     12531<<ASSIGN  12532>>IF      12532>>IF      12535>>IF      12536>>ASSIGN  12538>>ASSIGN
J IN PROCEDURE DSIZE
     12547**DCL     12544--PROC    12550<<ASSIGN  12554<<ASSIGN
J IN PROCEDURE UTSDATE
     12458**DCL     12484<<ASSIGN  12485>>ASSIGN  12486<<ASSIGN  12486>>ASSIGN  12488>>ASSIGN  12489<<ASSIGN
     12489>>ASSIGN  12490>>ASSIGN  12491<<ASSIGN  12491>>ASSIGN  12492>>ASSIGN  12493>>ASSIGN
JD
      4418**DCL     12263<<ASSIGN  12265<<ASSIGN  12265>>ASSIGN  12267>>ASSIGN  12276>>CALLBLT
JDAY
      4417**DCL     12276<<CALLBLT 12315>>CALLBLT
K
      4393**DCL     12407<<CALLBLT 12409<<ASSIGN  12411>>IF      12412>>CALLBLT 12413>>IF      12415>>ASSIGN
     12443<<ASSIGN  12446>>CALLBLT 12447<<ASSIGN  12447>>ASSIGN
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:222  
LASTFLD IN PROCEDURE LCLDATE
     12409**LABEL   12407--CALLALT
LCL4 IN PROCEDURE LCLDATE
     12418**LABEL   12449--GOTO
LCLDATE
     12368**PROC    12242--CALL
LO IN PROCEDURE LCLDATE
     12374**DCL     12419>>IF
MINS
      4410**DCL     12272<<CALLBLT 12305>>CALLBLT 12308>>CALLBLT
MON
      4412**DCL     12274<<CALLBLT 12295>>CALLBLT 12297>>CALLBLT
MONS
      4435**DCL     12263>>ASSIGN  12421>>IF      12421>>IF
MONTH
      4432**DCL     12299>>CALLBLT
MP
      4395**DCL     12495<<ASSIGN  12496>>ASSIGN  12497>>IF      12498>>ASSIGN  12500>>ASSIGN  12519<<ASSIGN
     12522<<ASSIGN  12526>>ASSIGN  12528>>ASSIGN
NEGFLAG IN PROCEDURE UTSDATE
     12461**DCL     12472>>IF      12475>>IF
NOPS4
     12359**LABEL   12248--CALLALT 12252--CALLALT 12283--CALLALT 12285--GOTO    12324--GOTO    12325--CALLALT
P1$
      4400**DCL      4455--IMP-PTR 12231<<ASSIGN  12237>>DOCASE  12280>>DOCASE  12291>>IF      12293>>DOCASE
     12303>>DOCASE  12311>>IF      12313>>DOCASE  12321>>IF      12321>>IF
PARM
     12156**DCL        24--PROC    12559--ENTRY   12561--ASSIGN
PARM.BND
     12216**DCL     12217--REDEF
PARM.BND_ARRAY
     12217**DCL     12554>>ASSIGN
PARM.CPTRS.PAR2$
     12213**DCL     12295>>CALLBLT 12297>>CALLBLT 12299>>CALLBLT
PARM.CPTRS.PAR3$
     12214**DCL     12305>>CALLBLT 12308>>CALLBLT
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:223  
PARM.CPTRS.PAR4$
     12214**DCL     12315>>CALLBLT
PARM.DESC
     12218**DCL     12219--REDEF
PARM.ERR
     12182**DCL     12353<<ASSIGN  12355<<ASSIGN  12357<<ASSIGN  12359<<ASSIGN  12361<<ASSIGN
PARM.MCL.CODE
     12163**DCL     12163--REDEF
PARM.PTRS
     12212**DCL     12213--REDEF   12215--REDEF   12215--REDEF   12215--REDEF
PARM.PTRS.PAR1$
     12212**DCL     12231>>ASSIGN
PARM.PTRS.PAR2$
     12212**DCL     12240>>CALL    12242>>CALL
PARM.PTRS.PAR3$
     12212**DCL     12240>>CALL    12242>>CALL
PARM.PTRS.PAR4$
     12212**DCL     12317>>ASSIGN
PARM.PTRS.PAR5$
     12212**DCL     12249>>ASSIGN  12253>>ASSIGN  12287>>ASSIGN  12326>>ASSIGN
PARM.PTRS_ARRAY
     12215**DCL     12549>>IF
PS_LCP6STT.BOOT_UTS
     11701**DCL     12594<<ASSIGN
PS_LCP6STT.REQSTATS.DSPMSK
     11632**DCL     11638--REDEF
PS_LCP6STT.REQSTATS.SLCMSK
     11673**DCL     11680--REDEF
QTR
      4369**DCL     12563<<ASSIGN  12571>>IF
SEC
      4408**DCL     12269<<CALLBLT 12305>>CALLBLT 12307>>CALLBLT
SECONDS
      4409**DCL     12307<<CALLBLT 12308>>CALLBLT
SRCERR
     11885**DCL     12361>>ASSIGN
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:224  
ST10
      4405**DCL     12299<<CALLBLT
ST3
      4401**DCL     12317<<ASSIGN
ST5
      4402**DCL     12315<<CALLBLT
ST6
      4403**DCL     12295<<CALLBLT
ST8
      4404**DCL     12297<<CALLBLT
STTMSZ
      4406**DCL     12305<<CALLBLT 12308<<CALLBLT
TIME IN PROCEDURE LCLDATE
     12372**DCL     12368--PROC    12373--REDEF   12407>>CALLBLT 12412>>CALLBLT 12429--ENTRY   12446>>CALLBLT
TM2
     12301**LABEL   12290--CALLALT
TM3
     12310**LABEL   12301--CALLALT
TMCHR IN PROCEDURE LCLDATE
     12373**DCL     12398>>IF      12398>>IF      12398>>IF      12398>>IF      12438>>IF      12438>>IF
TMSZ
      4396**DCL     12301<>CALL    12302>>ASSIGN  12379<>CALL    12397>>DOINDEX 12404>>DOWHILE 12409>>ASSIGN
     12432<>CALL    12433>>IF      12433>>IF      12437>>IF      12444>>IF
TMSZZ
      4397**DCL      4406--IMP-SIZ 12302<<ASSIGN  12305>>CALLBLT 12308>>CALLBLT
TUNITS
      4399**DCL     12287>>ASSIGN  12530<<ASSIGN  12531>>ASSIGN
U IN PROCEDURE UTSDATE
     12459**DCL     12473<<ASSIGN  12475--IF      12476<<ASSIGN  12476>>ASSIGN  12481<<ASSIGN  12484>>ASSIGN
     12485>>ASSIGN
U1
      4363**DCL     12484>>ASSIGN  12535>>IF      12536>>ASSIGN  12538>>ASSIGN  12568<<ASSIGN  12569<<ASSIGN
     12569>>ASSIGN  12570<<ASSIGN  12570>>ASSIGN  12573<<ASSIGN  12573>>ASSIGN  12575<<ASSIGN  12575>>ASSIGN
     12578>>ASSIGN  12583<<ASSIGN  12583>>ASSIGN  12585>>ASSIGN
UT
     12320**LABEL   12310--CALLALT
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:225  
UTI
      4387**DCL      4388--REDEF   12253<<ASSIGN  12257>>ASSIGN  12258>>ASSIGN  12259>>ASSIGN  12260>>ASSIGN
     12561<<ASSIGN  12592>>ASSIGN
UTIME
      4383**DCL      4384--REDEF   12244<>CALL    12245<<ASSIGN  12245>>ASSIGN  12249<<ASSIGN  12254<>CALL
     12255<<ASSIGN  12255>>ASSIGN  12326>>ASSIGN  12472--IF      12473>>ASSIGN  12481>>ASSIGN  12534<<ASSIGN
     12536<<ASSIGN  12538<<ASSIGN  12589<>CALL    12592<<ASSIGN  12592>>ASSIGN  12594>>ASSIGN  12595>>ASSIGN
     12596>>ASSIGN
UTIMEX.QTR
      4385**DCL     12484>>ASSIGN  12485>>ASSIGN
UTIX.QTR
      4389**DCL     12562>>ASSIGN  12563>>ASSIGN
UTSDATE
     12456**PROC    12246--CALL    12250--CALL    12256--CALL
V1ERR
     11979**DCL     12355>>ASSIGN
V1SIZE
      4439**DCL     12291>>IF
V3ERR
     12073**DCL     12357>>ASSIGN
V3SIZE
      4440**DCL     12311>>IF
V4ERR
     11932**DCL     12359>>ASSIGN
WKD
      4416**DCL     12268<<ASSIGN  12317>>ASSIGN
WKDAY
      4430**DCL     12317>>ASSIGN
XTIME
     12328**LABEL   12320--CALLALT
YP
      4394**DCL     12266<<ASSIGN  12267>>ASSIGN  12494<<ASSIGN  12495>>ASSIGN  12496>>ASSIGN  12502>>ASSIGN
     12504>>ASSIGN  12518<<ASSIGN  12523<<ASSIGN  12526>>ASSIGN  12528>>ASSIGN
YR
      4414**DCL     12275<<CALLBLT 12295>>CALLBLT 12297>>CALLBLT 12299>>CALLBLT 12315>>CALLBLT
YRERR
PL6.E3A0      #002=GUS$TIME File=GUS$SCHD.:E05TSI                                TUE 07/29/97 22:21 Page:226  
     12120**DCL     12353>>ASSIGN
