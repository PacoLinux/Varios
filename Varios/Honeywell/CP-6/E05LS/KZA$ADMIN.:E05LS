VERSION E05

PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:1    
        1        1        /*M*     KZA$ADMIN - Administrative functions                    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=6,IND=3,CTI=3,DCI=3,DTI=0,MCI,MOC,DMC */
        8        8        /*P*     NAME:     KZA$ADMIN
        9        9                 PURPOSE:  KZA$ADMIN contains all PL6 code which performs
       10       10                           administrative services.  The routines are called
       11       11                           from Handler Common.  Services include accounting,
       12       12                           statistics gathering, enable, disable, kill, and
       13       13                           MLCP initialization.                            */
       14       14        KZA$ADMIN: PROC (KH$ADMIN_FPT) ALTRET;
       15       15
       16       16        %INCLUDE KH$CHN;
       17      138        %INCLUDE KZ_SCODE_C;
       18      153        %INCLUDE KH$IO;
       19      400        %INCLUDE GH_IOFNC_E;
       20      469        %INCLUDE KH_MACRO_C;
       21     1212        %INCLUDE KL_MACRO_C;
       22     4564        %INCLUDE KL_SUPER_C;
       23     7466        %INCLUDE KL_AFCN_C;
       24     7567        %INCLUDE K_ID_E;
       25     7617        %INCLUDE KV$GLB;
       26     8036        %INCLUDE KV_GLBCNS_E;
       27     8377        %INCLUDE KZ$BSCSTT;
       28     8483        %INCLUDE KH$STT;
       29     8513        %INCLUDE KZ_INIT_C;
       30     8849        %INCLUDE KZ_PERR_C;
       31     8931        %INCLUDE KH$CLK;
       32     9301        %INCLUDE KH_CLKFNC_E;
       33     9346        %INCLUDE KZ_CLM_E;
       34     9518        %INCLUDE KZ$LINCTX;
       35    10138        %INCLUDE KZ_LIN_C;
       36    10194        %INCLUDE KHA_FNC_E;
       37    10294        %INCLUDE LCP_6;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:2    
       38    14573        %INCLUDE CP_6_SUBS;
       39    15113        %INCLUDE KZ_MLCP_C;
       40    15188
       41    15189           %KH$ADMIN_FPT       ( FPTN = KH$ADMIN_FPT,
       42    15190                                 STCLASS = PARAM );
       43    15401
       44    15402        %K#ENTID_E;
       45    15421        %K#LYRID_E;
       46    15428        %KL_REQSTATS;
       47    15722           %KH$CHN;
       48    15846
       49    15847           %KH$CCPLCT          ( NAME = KZM$MLCP,
       50    15848                                 STCLASS = SYMREF );
       51    15874
       52    15875           %KH$DWNLODCCP    ( NAME = KH_DWNLODCCP,
       53    15876                              CCPLODBIS = 0,
       54    15877                              STCLASS = STATIC );
       55    15900
       56    15901           %KH$DWNLODLCT    ( NAME = KH_DWNLODLCT,
       57    15902                              STCLASS = STATIC );
       58    15926
       59    15927           %KZ$LINCTX;
       60    16358
       61    16359        %KZ_INIT_HDR (NAME=KZ$HDR,STCLASS=BASED);
       62    16383
       63    16384           %KH$IO              ( FPTN = KH_OTPCHN,
       64    16385                                 FNC = %GH#IO_OTPCHNCTR,
       65    16386                                 STCLASS = STATIC );
       66    16500
       67    16501           %KH$IO              ( FPTN = KH_OTPLCT,
       68    16502                                 FNC = %GH#IO_OTPLCTBYT,
       69    16503                                 STCLASS = STATIC);
       70    16617
       71    16618           %KH$CLK             ( FPTN = KH_SETCLK,
       72    16619                                 FNC = %KH#CLK_SETCLK,
       73    16620                                 PRDUNT = %KH#C_SEC,
       74    16621                                 PRD = 5,
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:3    
       75    16622                                 ACCURACY = 0,
       76    16623                                 STCLASS = STATIC );
       77    16772
       78    16773           %KZ$EVENT           ( FPTN = KZ$EVENT_C,
       79    16774                                 STCLASS = CONSTANT );
       80    16856
       81    16857           %KZ$EVENT           ( FPTN = KZ$EVENT,
       82    16858                                 STCLASS = AUTO );
       83    16940
       84    16941        %FPT_WRSYSLOG (FPTN=SGNRJC_LOG, FCG='KZ',MID='A',ERR=%E$LINLGNREJ,
       85    16942                       SEV=%G_WRSYSLOG_SEV_M$XXX#);
       86    17037        %FPT_WRSYSLOG (FPTN=CLKABRT, FCG='KZ',MID='A',ERR=%E$NOTENBLD,
       87    17038                       SEV=%G_WRSYSLOG_SEV_M$XXX#);
       88    17133        %KV$BPC (STCLASS="BASED(KV_B_POOL$)");
       89    17155        %KV$BPC  (NAME=KV$BPCSTT,STATS=YES,STCLASS="BASED(KV_B_POOL$)");
       90    17177        %KV$STT;
       91    17571        %KZ$BSCSTT;
       92    17952
       93    17953    1   DCL KHA$DVCADM ENTRY(6) ALTRET;
       94    17954    1   DCL KHA$ERRLOG ENTRY(2) ALTRET;
       95    17955    1   DCL KHA$LINE_ACTIVE ENTRY (1);
       96    17956    1   DCL KHA$SNDSTT ENTRY(2) ALTRET;
       97    17957    1   DCL KHC$CLOCK ENTRY (1) ALTRET;
       98    17958    1   DCL KHC$XEQ2 ENTRY (1) ALTRET;
       99    17959    1   DCL KHI$DWNLODCCP ENTRY (1) ALTRET;
      100    17960    1   DCL KHI$DWNLODLCT ENTRY (1) ALTRET;
      101    17961    1   DCL KHI$IO_OTP ENTRY (2) ALTRET;
      102    17962    1   DCL KHI$IO_OTPLCTBYT ENTRY (2) ALTRET;
      103    17963    1   DCL KZC$SEARCH_FOR_ACTIVITY ENTRY (1);
      104    17964    1   DCL KZP$CNCDSC ENTRY (1) ALTRET;
      105    17965    1   DCL KZ_SLCENTX(0:0) UBIN BYTE SYMREF;
      106    17966    1   DCL KZ_NHDR UBIN SYMREF;
      107    17967    1   DCL KZ_HDR$(0:0) PTR SYMREF;
      108    17968    1   DCL KV_B_POOL$ PTR SYMREF;
      109    17969    1   DCL KZ_CCPLODBIS_MLC8 UBIN WORD SYMREF;
      110    17970    1   DCL KZ_CCPLODBIS_MLC16 UBIN WORD SYMREF;
      111    17971    1   DCL S$ PTR;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:4    
      112    17972    1   DCL VDHVKT VECTOR;
      113    17973    1   DCL BSCVKT VECTOR;
      114    17974    1   DCL CURXEQTIM UBIN(32);
      115    17975    1   DCL E@ EPTR;
      116    17976    1   DCL I UBIN WORD ALIGNED;
      117    17977    1   DCL J SBIN;
      118    17978    1   DCL LCT$ PTR;
      119    17979    1   DCL BFR$ PTR;
      120    17980    1   DCL SSTR CHAR(32) CALIGNED BASED;
      121    17981
      122    17982    1   DCL 1 LCT_HEADER BASED ALIGNED,
      123    17983    1         2 BFR$ PTR,
      124    17984    1         2 SIZE UBIN WORD;
      125    17985
      126    17986    1   DCL 1 LCT_BYTE(0:0) UBIN BYTE BASED(BFR$) CALIGNED;
      127    17987
      128    17988        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:5    
      129    17989        /************************************************************/
      130    17990
      131    17991    1         KZ$EVENT = KZ$EVENT_C;
      132    17992
      133    17993    2         DO CASE (KH$ADMIN_FPT.FNC);
      134    17994
      135    17995                                           /*
      136    17996                                           Initial MLCP channel program
      137    17997                                           down-loading function.  The channel
      138    17998                                           table entry for the MLCP is
      139    17999                                           supplied.  KHI$DWNLODCCP is then
      140    18000                                           called in order to get the memory
      141    18001                                           image of the CCP into the MLCP.
      142    18002                                                                          */
      143    18003    2          CASE (%KHA_FNC_INTCTR);
      144    18004
      145    18005    2            IF KH$ADMIN_FPT.CHN$ -> KH$CHN.DVCID = '2978'X THEN
      146    18006    2               KH_DWNLODCCP.CCPLODBIS = KZ_CCPLODBIS_MLC16; /* MLC-16 (NMLC) */
      147    18007    2            ELSE
      148    18008    2               KH_DWNLODCCP.CCPLODBIS = KZ_CCPLODBIS_MLC8; /* MLC-8 (MLCP) */
      149    18009    2            KH_DWNLODCCP.CHN$ = KH$ADMIN_FPT.CHN$;
      150    18010    2            KH_DWNLODCCP.CCPLCT$ = ADDR ( KZM$MLCP );
      151    18011    2            CALL KHI$DWNLODCCP ( KH_DWNLODCCP )
      152    18012    3            WHENALTRETURN DO;
      153    18013        /*N*     SNAP */
      154    18014    3               END;
      155    18015
      156    18016        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:6    
      157    18017
      158    18018    2          CASE (%KHA_FNC_ENABLE);
      159    18019
      160    18020
      161    18021    2            IF KH$ADMIN_FPT.TERMID.LEV = %TERMINAL_ID_LEV_CHAN#
      162    18022    3            THEN DO;
      163    18023    3               CALL RESET_MLCP;
      164    18024    3               KH$ADMIN_FPT.LIN$ -> KH$CHN.TERMID.TTYP = %KLTY_3270#;
      165    18025    3               KH_SETCLK.UID$ = KH$ADMIN_FPT.CHN$;
      166    18026    3               KH_SETCLK.SBR$ = ENTADDR(KZC$SEARCH_FOR_ACTIVITY);
      167    18027    3               KH_SETCLK.CTBCTX$ = ADDR(NIL);
      168    18028    3               CALL KHC$CLOCK (KH_SETCLK)
      169    18029    4               WHENALTRETURN DO;
      170    18030
      171    18031        /*E*  ERROR:  KZA-E$NOTENBLD
      172    18032              MESSAGE: Unable to set SEARCH-FOR-ACTIVITY clock.
      173    18033              DESCRIPTION: KHC$CLOCK altreturned. Error code is in VALUE(0).
      174    18034        */
      175    18035    4                  CLKABRT.V.TERMID=KH$ADMIN_FPT.TERMID;
      176    18036    4                  CALL KHA$ERRLOG (CLKABRT);
      177    18037    4                  ALTRETURN;          /* Leave line in previous state */
      178    18038    4                  END;
      179    18039    3               END;
      180    18040    3            ELSE DO;
      181    18041    3               IF KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ ~= ADDR(NIL)
      182    18042    4               THEN DO;
      183    18043    4                  IF KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ -> KZ$LINCTX.DEVMGR@ ~= ENTADDR(
             18043                           NIL)
      184    18044    5                  THEN DO;
      185    18045    5                     KZ$EVENT.EVENT = %KZ#LINFCN_ENABL;
      186    18046    5                     KZ$EVENT.LINCTX$=KH$ADMIN_FPT.LIN$->KH$CHN.CTX$;
      187    18047    5                     KZ$EVENT.TERMID$=ADDR(KH$ADMIN_FPT.TERMID);
      188    18048    5                     KZ$EVENT.CHN$=KH$ADMIN_FPT.CHN$;
      189    18049    5                     CALL KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ -> KZ$LINCTX.DEVMGR@ (
             18049                              KZ$EVENT )
      190    18050    6                     WHENALTRETURN DO;
      191    18051    6                        KH$ADMIN_FPT.RESULTS = KZ$EVENT.RESULT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:7    
      192    18052    6                        ALTRETURN;
      193    18053    6                        END;
      194    18054    5                     END;
      195    18055    4                  END;
      196    18056    3               END;
      197    18057
      198    18058        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:8    
      199    18059                                           /*
      200    18060                                           Administrative request to disable
      201    18061                                           a line.  Channel table and level
      202    18062                                           (e.g. line, device, sub-device)
      203    18063                                           are supplied.  A disable event is
      204    18064                                           reported to the line-handler. If
      205    18065                                           no activity has been detected on
      206    18066                                           the line, the line handler pulls the
      207    18067                                           plug on itself and returns.  If
      208    18068                                           something other than data set ready
      209    18069                                           goes high, no action is taken, and
      210    18070                                           the request is ignored.
      211    18071                                                                          */
      212    18072    2          CASE (%KHA_FNC_DISABLE);
      213    18073
      214    18074                                           /*
      215    18075                                           Ignore disable following line drop
      216    18076                                                                          */
      217    18077    2            IF KH$ADMIN_FPT.CHN$->KH$CHN.CTX$ ~= ADDR(NIL) AND
      218    18078    2               KH$ADMIN_FPT.LIN$->KH$CHN.CTX$ ~= ADDR(NIL) AND
      219    18079    3               KH$ADMIN_FPT.LIN$->KH$CHN.CTX$->KZ$LINCTX.CHN$ ~= ADDR(NIL) THEN DO;
      220    18080    3               KZ$EVENT.EVENT = %KZ#CLM_EVENT_DSABLD;
      221    18081    3               KZ$EVENT.TERMID$ = ADDR(KH$ADMIN_FPT.TERMID);
      222    18082    3               KZ$EVENT.LINCTX$ = KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$;
      223    18083    3               KZ$EVENT.CHN$ = KH$ADMIN_FPT.CHN$;
      224    18084    3               CALL KZP$CNCDSC ( KZ$EVENT )
      225    18085    4               WHENALTRETURN DO;
      226    18086    4                  KH$ADMIN_FPT.RESULTS = KZ$EVENT.RESULT;
      227    18087    4                  ALTRETURN;
      228    18088    4                  END;
      229    18089    3               END;
      230    18090    2            RETURN;
      231    18091        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:9    
      232    18092
      233    18093                                           /*
      234    18094                                           This case performs the function
      235    18095                                           necessary to kill a channel.  Once
      236    18096                                           we insure there is good line context,
      237    18097                                           we initiate disconnect as though
      238    18098                                           data set ready dropped.
      239    18099                                                                          */
      240    18100    2          CASE (%KHA_FNC_KILL);
      241    18101
      242    18102    2            IF KH$ADMIN_FPT.CHN$->KH$CHN.CTX$ ~= ADDR(NIL) AND
      243    18103    2               KH$ADMIN_FPT.LIN$->KH$CHN.CTX$ ~= ADDR(NIL) AND
      244    18104    3               KH$ADMIN_FPT.LIN$->KH$CHN.CTX$->KZ$LINCTX.CHN$ ~= ADDR(NIL) THEN DO;
      245    18105    3               KZ$EVENT.EVENT = %KZ#CLM_EVENT_KILLED;
      246    18106    3               KZ$EVENT.TERMID$ = ADDR(KH$ADMIN_FPT.TERMID);
      247    18107    3               KZ$EVENT.LINCTX$ = KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$;
      248    18108    3               KZ$EVENT.CHN$ = KH$ADMIN_FPT.CHN$;
      249    18109    3               CALL KZP$CNCDSC ( KZ$EVENT )
      250    18110    4               WHENALTRETURN DO;
      251    18111    4                  KH$ADMIN_FPT.RESULTS = KZ$EVENT.RESULT;
      252    18112    4                  ALTRETURN;
      253    18113    4                  END;
      254    18114    3               END;
      255    18115    3            ELSE DO;
      256    18116    3               CALL KHA$DVCADM (%KHA_FNC_DISCONNECT_EVT,I,KH$ADMIN_FPT.TERMID,,);
      257    18117    3               CALL RESET_MLCP;       /* Stop the MLCP while killed  */
      258    18118    3               END;
      259    18119
      260    18120        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:10   
      261    18121
      262    18122                                           /*
      263    18123                                           This case provides the funtionality
      264    18124                                           for statistics gathering.
      265    18125                                                                          */
      266    18126    2          CASE (%KHA_FNC_REQSTATS);
      267    18127    3            DO I=0 TO KZ_NHDR-1;
      268    18128    3               IF KZ_SLCENTX(I) ~= 0 AND
      269    18129    3                  (KH$ADMIN_FPT.CTX$->KL_REQSTATS.SLCENT(KZ_SLCENTX(I)) OR
      270    18130    3                  KH$ADMIN_FPT.CTX$->KL_REQSTATS.SLCENT(%KH#ENTID_BSC)) AND
      271    18131    3                  KZ_HDR$(I) ~= ADDR(NIL) AND
      272    18132    3                  KZ_HDR$(I)->KZ$HDR.STTHND@ ~= ENTADDR(NIL) AND
      273    18133    4                  KZ_HDR$(I)->KZ$HDR.STTBFR$ ~= ADDR(NIL) THEN DO;
      274    18134    4                  E@ = KZ_HDR$(I)->KZ$HDR.STTHND@;
      275    18135    4                  S$=KZ_HDR$(I)->KZ$HDR.STTBFR$;
      276    18136    4                  S$->KZ$BSCSTT.BPSTT=KV$BPCSTT;
      277    18137    4                  S$->KZ$BSCSTT.BPSTT.MINSIZ=KV$BPC.MINSIZ;
      278    18138    5                  DO J = SIZEW(KV$BPC.COUNT)*2-1 DOWNTO 0;
      279    18139    5                     S$->KZ$BSCSTT.BPSTT.COUNT(J)=KV$BPC.COUNT(J);
      280    18140    5                     END;
      281    18141    4                  CALL E@ (VDHVKT,BSCVKT) ALTRET(NOSTTS);
      282    18142    4                  IF KH$ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_VDH) AND
      283    18143    5                     VBASE(VDHVKT) ~= ADDR(NIL) THEN DO;
      284    18144    5                     CALL KHC$XEQ2(CURXEQTIM);
      285    18145    5                     VBASE(VDHVKT)->KV$STT.SCHEXCTIM = CURXEQTIM
      286    18146    5                        - S$->KZ$BSCSTT.KHSTT.INPINTISATIM
      287    18147    5                        - S$->KZ$BSCSTT.KHSTT.OTPINTISATIM;
      288    18148    5                     CALL KHA$SNDSTT(KH$ADMIN_FPT.CTX$->KL_REQSTATS,VDHVKT);
      289    18149    5                     END;
      290    18150    4                  IF KH$ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(KZ_SLCENTX(I)) AND
      291    18151    4                     VBASE(BSCVKT) ~= ADDR(NIL) THEN
      292    18152    4                     CALL KHA$SNDSTT(KH$ADMIN_FPT.CTX$->KL_REQSTATS,BSCVKT);
      293    18153    4   NOSTTS:        ;
      294    18154    4                  END;
      295    18155    3               END;
      296    18156        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:11   
      297    18157                                           /*
      298    18158                                           The build context event from Handler
      299    18159                                           Common is the result of a successful
      300    18160                                           line profile request.
      301    18161                                                                          */
      302    18162    2          CASE (%KHA_FNC_BLDCTX);
      303    18163
      304    18164    2            IF KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ ~= ADDR(NIL)
      305    18165    3            THEN DO;
      306    18166    3               KZ$EVENT.EVENT = %KZ#CLM_EVENT_BLDCTX;
      307    18167    3               KZ$EVENT.CHNCTX$ = KH$ADMIN_FPT.CTX$;
      308    18168    3               KZ$EVENT.TERMID$ = ADDR(KH$ADMIN_FPT.TERMID);
      309    18169    3               KZ$EVENT.LINCTX$ = KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$;
      310    18170    3               KZ$EVENT.CHN$ = KH$ADMIN_FPT.CHN$;
      311    18171    3               CALL KZP$CNCDSC ( KZ$EVENT );
      312    18172    3               END;
      313    18173    3            ELSE DO;
      314    18174        /*N* KH$ADMIN_FPT.RESULTS = */
      315    18175    3               END;
      316    18176
      317    18177        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:12   
      318    18178                                           /*
      319    18179                                           The build context complete event
      320    18180                                           is to inform us that all context
      321    18181                                           for the specified channel has been
      322    18182                                           received.
      323    18183                                                                          */
      324    18184    2          CASE (%KHA_FNC_BLDCTXCMP);
      325    18185
      326    18186    2            IF KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ ~= ADDR(NIL)
      327    18187    3            THEN DO;
      328    18188    3               KZ$EVENT.EVENT = %KZ#CLM_EVENT_CTXCMP;
      329    18189    3               KZ$EVENT.TERMID$ = ADDR(KH$ADMIN_FPT.TERMID);
      330    18190    3               KZ$EVENT.LINCTX$ = KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$;
      331    18191    3               KZ$EVENT.CHN$ = KH$ADMIN_FPT.CHN$;
      332    18192    3               CALL KZP$CNCDSC ( KZ$EVENT );
      333    18193    3               END;
      334    18194    3            ELSE DO;
      335    18195        /*N* KH$ADMIN_FPT.RESULTS = */
      336    18196    3               END;
      337    18197        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:13   
      338    18198                                           /*
      339    18199                                           This event performs the function-
      340    18200                                           ality necessary as a result of a
      341    18201                                           DISC TERM keyin.
      342    18202                                                                          */
      343    18203    2          CASE ( %KHA_FNC_DISCONNECT_RQS );
      344    18204
      345    18205    2            IF KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ ~= ADDR(NIL)
      346    18206    3            THEN DO;
      347    18207    3               KZ$EVENT.EVENT = %KZ#CLM_EVENT_DSCTRM;
      348    18208    3               KZ$EVENT.TERMID$ = ADDR(KH$ADMIN_FPT.TERMID);
      349    18209    3               KZ$EVENT.LINCTX$ = KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$;
      350    18210    3               CALL KZP$CNCDSC ( KZ$EVENT );
      351    18211    3               END;
      352    18212    3            ELSE DO;
      353    18213        /* KH$ADMIN_FPT.RESULTS = */
      354    18214    3               END;
      355    18215        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:14   
      356    18216    2          CASE ( %KHA_FNC_SGNRJC );
      357    18217
      358    18218    2            IF KH$ADMIN_FPT.LIN$->KH$CHN.AUTLGN OR
      359    18219    2               KH$ADMIN_FPT.LIN$->KH$CHN.CTX$ = ADDR(NIL) THEN
      360    18220    2               SGNRJC_LOG.BUF_=VECTOR(NIL);
      361    18221    2            ELSE
      362    18222    2               SGNRJC_LOG.BUF_=VECTOR(KH$ADMIN_FPT.LIN$->KH$CHN.CTX$->
      363    18223    2                  KZ$LINCTX.INPBFR$->SSTR);
      364    18224    2            IF KH$ADMIN_FPT.LIN$->KH$CHN.CTX$ ~= ADDR(NIL) THEN
      365    18225    2               SGNRJC_LOG.V.TERMID = KH$ADMIN_FPT.LIN$->KH$CHN.CTX$->
      366    18226    2                  KZ$LINCTX.LINID;
      367    18227    2            ELSE
      368    18228    2               SGNRJC_LOG.V.TERMID = '0'B;
      369    18229
      370    18230
      371    18231
      372    18232        /*E*  ERROR: KZA-E$LINLGNREJ-7
      373    18233              MESSAGE: Logon rejected.
      374    18234              DESCRIPTION: A terminal definition could not be found for the
      375    18235              specified logon string. If the logon string was received from
      376    18236              the remote terminal, it is displayed as it was received, in
      377    18237              EBCDIC format.  If it was an AUTOLOG terminal, no logon string
      378    18238              is displayed and the channel number must be used to identify the
      379    18239              problem.
      380    18240                                                                           */
      381    18241    2            CALL KHA$ERRLOG ( SGNRJC_LOG )
      382    18242    3            WHENALTRETURN DO;
      383    18243    3               END;
      384    18244    2            IF KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ ~= ADDR(NIL)
      385    18245    3            THEN DO;
      386    18246    3               KZ$EVENT.EVENT = %KZ#CLM_EVENT_DSCTRM;
      387    18247    3               KZ$EVENT.TERMID$ = ADDR(KH$ADMIN_FPT.TERMID);
      388    18248    3               KZ$EVENT.LINCTX$ = KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$;
      389    18249    3               KZ$EVENT.CHN$ = KH$ADMIN_FPT.CHN$;
      390    18250    3               CALL KZP$CNCDSC ( KZ$EVENT );
      391    18251    3               END;
      392    18252    3            ELSE DO;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:15   
      393    18253        /* KH$ADMIN_FPT.RESULTS = */
      394    18254    3               END;
      395    18255        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:16   
      396    18256                                           /*
      397    18257                                           After a host recovery, we'll receive
      398    18258                                           one of these.  We should call KHA to
      399    18259                                           get a record written to the COMAC file
      400    18260                                           saying we're connected.
      401    18261                                                                          */
      402    18262    2          CASE (%KHA_FNC_HOSTUP);
      403    18263
      404    18264    2            CALL KHA$LINE_ACTIVE ( KH$ADMIN_FPT.TERMID );
      405    18265        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:17   
      406    18266
      407    18267    2          CASE (ELSE);
      408    18268        /*N* SNAP */
      409    18269
      410    18270    2          END;
      411    18271    1         RETURN;
      412    18272        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:18   
      413    18273
      414    18274                                           /*
      415    18275                                           This function causes the equivalent
      416    18276                                           of an "FEP stop I/O" to be done on
      417    18277                                           the MLCP.  After the halt, a fresh
      418    18278                                           copy of LCTs are down-loaded into
      419    18279                                           the MLCP (where we sit doing nothing).
      420    18280                                           If we get IONAKed we should screech.
      421    18281                                                                          */
      422    18282    1   RESET_MLCP: PROC;
      423    18283
      424    18284    2         KH_OTPCHN.OTPCHN = '0'B;
      425    18285    2         KH_OTPCHN.CHNCTR = '0'B;
      426    18286    2         KH_OTPCHN.CHNCTR.CHNINT = '1'B;
      427    18287    2         CALL KHI$IO_OTP (KH$ADMIN_FPT.CHN$ -> KH$CHN, KH_OTPCHN);
      428    18288    2         KH_OTPCHN.OTPCHN = '1'B;
      429    18289    2         CALL KHI$IO_OTP (KH$ADMIN_FPT.CHN$ -> KH$CHN, KH_OTPCHN);
      430    18290
      431    18291    2         IF KH$ADMIN_FPT.CHN$ -> KH$CHN.DVCID = '2978'X THEN
      432    18292    2            KH_DWNLODLCT.CCPLODBIS = KZ_CCPLODBIS_MLC16; /* MLC-16 (NMLC) */
      433    18293    2         ELSE
      434    18294    2            KH_DWNLODLCT.CCPLODBIS = KZ_CCPLODBIS_MLC8; /* MLC-8 (MLCP) */
      435    18295    2         KH_DWNLODLCT.CHN$ = KH$ADMIN_FPT.CHN$;
      436    18296    2         KH_DWNLODLCT.CCPLCT$ = ADDR ( KZM$MLCP );
      437    18297    2         KH_DWNLODLCT.RCVINTLVL = %KZ#ACTLVL;
      438    18298    2         KH_DWNLODLCT.TRNINTLVL = 0;
      439    18299    2         CALL KHI$DWNLODLCT ( KH_DWNLODLCT )
      440    18300    3         WHENALTRETURN DO;
      441    18301        /*N* SNAP */
      442    18302    3            END;
      443    18303
      444    18304    3         IF KH$ADMIN_FPT.CHN$ -> KH$CHN.CLK THEN DO;
      445    18305    3            KH_OTPLCT.LCTBYT.ADR = 20;
      446    18306    3            KH_OTPLCT.LCTBYT.DAT = KZM$MLCP.LCTBYT(20)+8;
      447    18307    3            CALL KHI$IO_OTPLCTBYT (KH$ADMIN_FPT.CHN$ -> KH$CHN, KH_OTPLCT);
      448    18308    3            END;
      449    18309
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:19   
      450    18310    2         RETURN;
      451    18311    2   END RESET_MLCP;
      452    18312
      453    18313    1   END KZA$ADMIN;

PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:20   
--  Include file information  --

   KZ_MLCP_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   KZ_LIN_C.:E05TOU  is referenced.
   KZ$LINCTX.:E05TOU  is referenced.
   KZ_CLM_E.:E05TOU  is referenced.
   KH_CLKFNC_E.:E05TOU  is referenced.
   KH$CLK.:E05TOU  is referenced.
   KZ_PERR_C.:E05TOU  is referenced.
   KZ_INIT_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KV$BPC.:E05TOU  is referenced.
   KZ$BSCSTT.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   GH_IOFNC_E.:E05TOU  is referenced.
   KH$IO.:E05TOU  is referenced.
   KZ_SCODE_C.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
      No diagnostics issued in procedure KZA$ADMIN.
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:21   

   Procedure KZA$ADMIN requires 979 words for executable code.
   Procedure KZA$ADMIN requires 50 words of local(AUTO) storage.

    No errors detected in file KZA$ADMIN.:E05TSI    .

PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:22   

 Object Unit name= KZA$ADMIN                                  File name= KZA$ADMIN.:E05TOU
 UTS= JUL 30 '97 02:48:32.48 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Data  even  none    69     45  KZA$ADMIN
    1  RoData even  UTS     14      E  KZA$ADMIN
    2   Proc  even  none   979    3D3  KZA$ADMIN
    3  RoData even  none    15      F  KZA$ADMIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  KZA$ADMIN
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:23   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KHI$DWNLODCCP
         yes           Std       1 KZC$SEARCH_FOR_ACTIVITY
 yes     yes           Std       1 KHC$CLOCK
 yes     yes           Std       1 KZP$CNCDSC
         yes           Std       1 KHA$LINE_ACTIVE
 yes     yes           Std       2 KHA$SNDSTT
 yes     yes           Std       2 KHA$ERRLOG
 yes     yes           Std       6 KHA$DVCADM
 yes     yes           Std       1 KHC$XEQ2
 yes     yes           Std       2 KHI$IO_OTP
 yes     yes           Std       1 KHI$DWNLODLCT
 yes     yes           Std       2 KHI$IO_OTPLCTBYT
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_AALT
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KZM$MLCP                              KZ_SLCENTX                            KZ_NHDR
     KZ_HDR$                               KV_B_POOL$                            KZ_CCPLODBIS_MLC8
     KZ_CCPLODBIS_MLC16               r    G$ROS$
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:24   


        1        1        /*M*     KZA$ADMIN - Administrative functions                    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=6,IND=3,CTI=3,DCI=3,DTI=0,MCI,MOC,DMC */
        8        8        /*P*     NAME:     KZA$ADMIN
        9        9                 PURPOSE:  KZA$ADMIN contains all PL6 code which performs
       10       10                           administrative services.  The routines are called
       11       11                           from Handler Common.  Services include accounting,
       12       12                           statistics gathering, enable, disable, kill, and
       13       13                           MLCP initialization.                            */
       14       14        KZA$ADMIN: PROC (KH$ADMIN_FPT) ALTRET;

     14   2 000000  D380 0000 0000  xent KZA$ADMIN       LNJ,B5   X6A_AUTO_1
          2 000003       0032 0001                       DC       50,1

       15       15
       16       16        %INCLUDE KH$CHN;
       17      138        %INCLUDE KZ_SCODE_C;
       18      153        %INCLUDE KH$IO;
       19      400        %INCLUDE GH_IOFNC_E;
       20      469        %INCLUDE KH_MACRO_C;
       21     1212        %INCLUDE KL_MACRO_C;
       22     4564        %INCLUDE KL_SUPER_C;
       23     7466        %INCLUDE KL_AFCN_C;
       24     7567        %INCLUDE K_ID_E;
       25     7617        %INCLUDE KV$GLB;
       26     8036        %INCLUDE KV_GLBCNS_E;
       27     8377        %INCLUDE KZ$BSCSTT;
       28     8483        %INCLUDE KH$STT;
       29     8513        %INCLUDE KZ_INIT_C;
       30     8849        %INCLUDE KZ_PERR_C;
       31     8931        %INCLUDE KH$CLK;
       32     9301        %INCLUDE KH_CLKFNC_E;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:25   
       33     9346        %INCLUDE KZ_CLM_E;
       34     9518        %INCLUDE KZ$LINCTX;
       35    10138        %INCLUDE KZ_LIN_C;
       36    10194        %INCLUDE KHA_FNC_E;
       37    10294        %INCLUDE LCP_6;
       38    14573        %INCLUDE CP_6_SUBS;
       39    15113        %INCLUDE KZ_MLCP_C;
       40    15188
       41    15189           %KH$ADMIN_FPT       ( FPTN = KH$ADMIN_FPT,
       42    15190                                 STCLASS = PARAM );
       43    15401
       44    15402        %K#ENTID_E;
       45    15421        %K#LYRID_E;
       46    15428        %KL_REQSTATS;
       47    15722           %KH$CHN;
       48    15846
       49    15847           %KH$CCPLCT          ( NAME = KZM$MLCP,
       50    15848                                 STCLASS = SYMREF );
       51    15874
       52    15875           %KH$DWNLODCCP    ( NAME = KH_DWNLODCCP,
       53    15876                              CCPLODBIS = 0,
       54    15877                              STCLASS = STATIC );
       55    15900
       56    15901           %KH$DWNLODLCT    ( NAME = KH_DWNLODLCT,
       57    15902                              STCLASS = STATIC );
       58    15926
       59    15927           %KZ$LINCTX;
       60    16358
       61    16359        %KZ_INIT_HDR (NAME=KZ$HDR,STCLASS=BASED);
       62    16383
       63    16384           %KH$IO              ( FPTN = KH_OTPCHN,
       64    16385                                 FNC = %GH#IO_OTPCHNCTR,
       65    16386                                 STCLASS = STATIC );
       66    16500
       67    16501           %KH$IO              ( FPTN = KH_OTPLCT,
       68    16502                                 FNC = %GH#IO_OTPLCTBYT,
       69    16503                                 STCLASS = STATIC);
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:26   
       70    16617
       71    16618           %KH$CLK             ( FPTN = KH_SETCLK,
       72    16619                                 FNC = %KH#CLK_SETCLK,
       73    16620                                 PRDUNT = %KH#C_SEC,
       74    16621                                 PRD = 5,
       75    16622                                 ACCURACY = 0,
       76    16623                                 STCLASS = STATIC );
       77    16772
       78    16773           %KZ$EVENT           ( FPTN = KZ$EVENT_C,
       79    16774                                 STCLASS = CONSTANT );
       80    16856
       81    16857           %KZ$EVENT           ( FPTN = KZ$EVENT,
       82    16858                                 STCLASS = AUTO );
       83    16940
       84    16941        %FPT_WRSYSLOG (FPTN=SGNRJC_LOG, FCG='KZ',MID='A',ERR=%E$LINLGNREJ,
       85    16942                       SEV=%G_WRSYSLOG_SEV_M$XXX#);
       86    17037        %FPT_WRSYSLOG (FPTN=CLKABRT, FCG='KZ',MID='A',ERR=%E$NOTENBLD,
       87    17038                       SEV=%G_WRSYSLOG_SEV_M$XXX#);
       88    17133        %KV$BPC (STCLASS="BASED(KV_B_POOL$)");
       89    17155        %KV$BPC  (NAME=KV$BPCSTT,STATS=YES,STCLASS="BASED(KV_B_POOL$)");
       90    17177        %KV$STT;
       91    17571        %KZ$BSCSTT;
       92    17952
       93    17953    1   DCL KHA$DVCADM ENTRY(6) ALTRET;
       94    17954    1   DCL KHA$ERRLOG ENTRY(2) ALTRET;
       95    17955    1   DCL KHA$LINE_ACTIVE ENTRY (1);
       96    17956    1   DCL KHA$SNDSTT ENTRY(2) ALTRET;
       97    17957    1   DCL KHC$CLOCK ENTRY (1) ALTRET;
       98    17958    1   DCL KHC$XEQ2 ENTRY (1) ALTRET;
       99    17959    1   DCL KHI$DWNLODCCP ENTRY (1) ALTRET;
      100    17960    1   DCL KHI$DWNLODLCT ENTRY (1) ALTRET;
      101    17961    1   DCL KHI$IO_OTP ENTRY (2) ALTRET;
      102    17962    1   DCL KHI$IO_OTPLCTBYT ENTRY (2) ALTRET;
      103    17963    1   DCL KZC$SEARCH_FOR_ACTIVITY ENTRY (1);
      104    17964    1   DCL KZP$CNCDSC ENTRY (1) ALTRET;
      105    17965    1   DCL KZ_SLCENTX(0:0) UBIN BYTE SYMREF;
      106    17966    1   DCL KZ_NHDR UBIN SYMREF;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:27   
      107    17967    1   DCL KZ_HDR$(0:0) PTR SYMREF;
      108    17968    1   DCL KV_B_POOL$ PTR SYMREF;
      109    17969    1   DCL KZ_CCPLODBIS_MLC8 UBIN WORD SYMREF;
      110    17970    1   DCL KZ_CCPLODBIS_MLC16 UBIN WORD SYMREF;
      111    17971    1   DCL S$ PTR;
      112    17972    1   DCL VDHVKT VECTOR;
      113    17973    1   DCL BSCVKT VECTOR;
      114    17974    1   DCL CURXEQTIM UBIN(32);
      115    17975    1   DCL E@ EPTR;
      116    17976    1   DCL I UBIN WORD ALIGNED;
      117    17977    1   DCL J SBIN;
      118    17978    1   DCL LCT$ PTR;
      119    17979    1   DCL BFR$ PTR;
      120    17980    1   DCL SSTR CHAR(32) CALIGNED BASED;
      121    17981
      122    17982    1   DCL 1 LCT_HEADER BASED ALIGNED,
      123    17983    1         2 BFR$ PTR,
      124    17984    1         2 SIZE UBIN WORD;
      125    17985
      126    17986    1   DCL 1 LCT_BYTE(0:0) UBIN BYTE BASED(BFR$) CALIGNED;
      127    17987
      128    17988        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:28   
      129    17989        /************************************************************/
      130    17990
      131    17991    1         KZ$EVENT = KZ$EVENT_C;

  17991   2 000005  AB80 0000 0000  01                   LAB,B2   KZ$EVENT_C
          2 000008  2C00                                 LDV,R2   0
          2 000009  6C1C                                 LDV,R6   28
          2 00000A  BB87                                 LAB,B3   ,AUTO
          2 00000B  3C0C                                 LDV,R3   12
          2 00000C  0008                                 MMM

      132    17992
      133    17993    2         DO CASE (KH$ADMIN_FPT.FNC);

  17993   2 00000D  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          2 00000F  B806                                 LDR,R3   ,B6
          2 000010  3D1B                                 CMV,R3   27
          2 000011  0281 032B                            BGE      s:18271,PREL
          2 000013  A830 0000 0019  02                   LDR,R2   s:17993+12,R3
          2 000016  83A0 0000 0034  02                   JMP      s:18005,R2
          2 000019       0309                            DC       s:18271,PREL
          2 00001A       002C                            DC       s:18021,PREL
          2 00001B       00A9                            DC       s:18077,PREL
          2 00001C       00E4                            DC       s:18102,PREL
          2 00001D       0141                            DC       s:18127,PREL
          2 00001E       0309                            DC       s:18271,PREL
          2 00001F       0309                            DC       s:18271,PREL
          2 000020       0309                            DC       s:18271,PREL
          2 000021       0309                            DC       s:18271,PREL
          2 000022       0309                            DC       s:18271,PREL
          2 000023       0216                            DC       s:18164,PREL
          2 000024       023F                            DC       s:18186,PREL
          2 000025       0309                            DC       s:18271,PREL
          2 000026       0264                            DC       s:18205,PREL
          2 000027       0309                            DC       s:18271,PREL
          2 000028       0000                            DC       s:18005,PREL
          2 000029       0309                            DC       s:18271,PREL
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:29   
          2 00002A       0309                            DC       s:18271,PREL
          2 00002B       0309                            DC       s:18271,PREL
          2 00002C       0309                            DC       s:18271,PREL
          2 00002D       0309                            DC       s:18271,PREL
          2 00002E       0285                            DC       s:18218,PREL
          2 00002F       0309                            DC       s:18271,PREL
          2 000030       0309                            DC       s:18271,PREL
          2 000031       0309                            DC       s:18271,PREL
          2 000032       0309                            DC       s:18271,PREL
          2 000033       02FB                            DC       s:18264,PREL

      134    17994
      135    17995                                           /*
      136    17996                                           Initial MLCP channel program
      137    17997                                           down-loading function.  The channel
      138    17998                                           table entry for the MLCP is
      139    17999                                           supplied.  KHI$DWNLODCCP is then
      140    18000                                           called in order to get the memory
      141    18001                                           image of the CCP into the MLCP.
      142    18002                                                                          */
      143    18003    2          CASE (%KHA_FNC_INTCTR);

      144    18004
      145    18005    2            IF KH$ADMIN_FPT.CHN$ -> KH$CHN.DVCID = '2978'X THEN

  18005   2 000034  DCC6 000B                            LDB,B5   11,B6
          2 000036  E845 0002                            LDR,R6   2,B5
          2 000038  E970 2978                            CMR,R6   10616,IMO
          2 00003A  0981 0009                            BNE      s:18008,PREL

      146    18006    2               KH_DWNLODCCP.CCPLODBIS = KZ_CCPLODBIS_MLC16; /* MLC-16 (NMLC) */

  18006   2 00003C  D800 0000 0000  xsym                 LDR,R5   KZ_CCPLODBIS_MLC16
          2 00003F  DF00 0000 0004  00                   STR,R5   KH_DWNLODCCP+4
          2 000042  0F81 0007                            B        s:18009,PREL

      147    18007    2            ELSE
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:30   
      148    18008    2               KH_DWNLODCCP.CCPLODBIS = KZ_CCPLODBIS_MLC8; /* MLC-8 (MLCP) */

  18008   2 000044  D800 0000 0000  xsym                 LDR,R5   KZ_CCPLODBIS_MLC8
          2 000047  DF00 0000 0004  00                   STR,R5   KH_DWNLODCCP+4

      149    18009    2            KH_DWNLODCCP.CHN$ = KH$ADMIN_FPT.CHN$;

  18009   2 00004A  DF80 0000 0000  00                   STB,B5   KH_DWNLODCCP

      150    18010    2            KH_DWNLODCCP.CCPLCT$ = ADDR ( KZM$MLCP );

  18010   2 00004D  CB80 0000 0000  xsym                 LAB,B4   KZM$MLCP
          2 000050  CF80 0000 0002  00                   STB,B4   KH_DWNLODCCP+2

      151    18011    2            CALL KHI$DWNLODCCP ( KH_DWNLODCCP )

  18011   2 000053  BB80 0000 0000  03                   LAB,B3   0
          2 000056  CBF0 0100                            LAB,B4   256,IMO
          2 000058  E380 0000 0000  xent                 LNJ,B6   KHI$DWNLODCCP
          2 00005B       0003                            DC       s:18014,PREL
          2 00005C  0F81 0001                            B        s:18014,PREL

      152    18012    3            WHENALTRETURN DO;

      153    18013        /*N*     SNAP */
      154    18014    3               END;

  18014   2 00005E  0F81 02DE                            B        s:18271,PREL

      155    18015
      156    18016        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:31   
      157    18017
      158    18018    2          CASE (%KHA_FNC_ENABLE);

      159    18019
      160    18020
      161    18021    2            IF KH$ADMIN_FPT.TERMID.LEV = %TERMINAL_ID_LEV_CHAN#

  18021   2 000060  E846 0001                            LDR,R6   1,B6
          2 000062  E570 00FF                            AND,R6   255,IMO
          2 000064  6D01                                 CMV,R6   1
          2 000065  0981 003E                            BNE      s:18041,PREL

      162    18022    3            THEN DO;

      163    18023    3               CALL RESET_MLCP;

  18023   2 000067  E3C0 02D8                            LNJ,B6   s:0,PREL
          2 000069       0001                            DC       s:18024,PREL

      164    18024    3               KH$ADMIN_FPT.LIN$ -> KH$CHN.TERMID.TTYP = %KLTY_3270#;

  18024   2 00006A  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          2 00006C  DCC6 000D                            LDB,B5   13,B6
          2 00006E  6C07                                 LDV,R6   7
          2 00006F  E7C5 0012                            STH,R6   18,B5

      165    18025    3               KH_SETCLK.UID$ = KH$ADMIN_FPT.CHN$;

  18025   2 000071  DCC6 000B                            LDB,B5   11,B6
          2 000073  DF80 0000 0012  00                   STB,B5   KH_SETCLK+2

      166    18026    3               KH_SETCLK.SBR$ = ENTADDR(KZC$SEARCH_FOR_ACTIVITY);

  18026   2 000076  CB80 0000 0000  xent                 LAB,B4   KZC$SEARCH_FOR_ACTIVITY
          2 000079  CF80 0000 0018  00                   STB,B4   KH_SETCLK+8

      167    18027    3               KH_SETCLK.CTBCTX$ = ADDR(NIL);
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:32   

  18027   2 00007C  BB80 0000 0000                       LAB,B3   0
          2 00007F  BF80 0000 0010  00                   STB,B3   KH_SETCLK

      168    18028    3               CALL KHC$CLOCK (KH_SETCLK)

  18028   2 000082  BB80 0000 0002  03                   LAB,B3   +2
          2 000085  CBF0 0100                            LAB,B4   256,IMO
          2 000087  E380 0000 0000  xent                 LNJ,B6   KHC$CLOCK
          2 00008A       0003                            DC       s:18035,PREL
          2 00008B  0F81 0016                            B        s:18039,PREL

      169    18029    4               WHENALTRETURN DO;

      170    18030
      171    18031        /*E*  ERROR:  KZA-E$NOTENBLD
      172    18032              MESSAGE: Unable to set SEARCH-FOR-ACTIVITY clock.
      173    18033              DESCRIPTION: KHC$CLOCK altreturned. Error code is in VALUE(0).
      174    18034        */
      175    18035    4                  CLKABRT.V.TERMID=KH$ADMIN_FPT.TERMID;

  18035   2 00008D  ACC7 0004                            LDB,B2   @KH$ADMIN_FPT,AUTO
          2 00008F  2C02                                 LDV,R2   2
          2 000090  6C10                                 LDV,R6   16
          2 000091  BB80 0000 0000  00                   LAB,B3   KH_DWNLODCCP
          2 000094  3C70                                 LDV,R3   112
          2 000095  0008                                 MMM

      176    18036    4                  CALL KHA$ERRLOG (CLKABRT);

  18036   2 000096  BB80 0000 0004  03                   LAB,B3   +4
          2 000099  CBF0 0100                            LAB,B4   256,IMO
          2 00009B  E380 0000 0000  xent                 LNJ,B6   KHA$ERRLOG
          2 00009E       0001                            DC       s:18037,PREL

      177    18037    4                  ALTRETURN;          /* Leave line in previous state */

PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:33   
  18037   2 00009F  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      178    18038    4                  END;
      179    18039    3               END;

  18039   2 0000A2  0F81 029A                            B        s:18271,PREL

      180    18040    3            ELSE DO;

      181    18041    3               IF KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ ~= ADDR(NIL)

  18041   2 0000A4  DCC6 000D                            LDB,B5   13,B6
          2 0000A6  8DC5 000C                            CMN      12,B5
          2 0000A8  0901 0294                            BE       s:18271,PREL

      182    18042    4               THEN DO;

      183    18043    4                  IF KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ -> KZ$LINCTX.DEVMGR@ ~= ENTADDR(
             18043                           NIL)

  18043   2 0000AA  CCC5 000C                            LDB,B4   12,B5
          2 0000AC  ACC4 006E                            LDB,B2   110,B4
          2 0000AE  AD80 0000 0006  03                   CMB,B2   +6
          2 0000B1  0901 028B                            BE       s:18271,PREL

      184    18044    5                  THEN DO;

      185    18045    5                     KZ$EVENT.EVENT = %KZ#LINFCN_ENABL;

  18045   2 0000B3  5C09                                 LDV,R5   9
          2 0000B4  DF47 0006                            STR,R5   KZ$EVENT,AUTO

      186    18046    5                     KZ$EVENT.LINCTX$=KH$ADMIN_FPT.LIN$->KH$CHN.CTX$;

  18046   2 0000B6  CFC7 0009                            STB,B4   KZ$EVENT+3,AUTO

      187    18047    5                     KZ$EVENT.TERMID$=ADDR(KH$ADMIN_FPT.TERMID);
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:34   

  18047   2 0000B8  9BC6 0001                            LAB,B1   1,B6
          2 0000BA  9FC7 000B                            STB,B1   KZ$EVENT+5,AUTO

      188    18048    5                     KZ$EVENT.CHN$=KH$ADMIN_FPT.CHN$;

  18048   2 0000BC  DCC6 000B                            LDB,B5   11,B6
          2 0000BE  DFC7 000D                            STB,B5   KZ$EVENT+7,AUTO

      189    18049    5                     CALL KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ -> KZ$LINCTX.DEVMGR@ (
             18049                              KZ$EVENT )

  18049   2 0000C0  DCC6 000D                            LDB,B5   13,B6
          2 0000C2  ECC5 000C                            LDB,B6   12,B5
          2 0000C4  DBC7 0006                            LAB,B5   KZ$EVENT,AUTO
          2 0000C6  DFC7 0028                            STB,B5   BFR$+4,AUTO
          2 0000C8  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 0000CA  9CC6 006E                            LDB,B1   110,B6
          2 0000CC  CBF0 0100                            LAB,B4   256,IMO
          2 0000CE  E381                                 LNJ,B6   ,B1
          2 0000CF       0003                            DC       s:18051,PREL
          2 0000D0  0F81 000A                            B        s:18056,PREL

      190    18050    6                     WHENALTRETURN DO;

      191    18051    6                        KH$ADMIN_FPT.RESULTS = KZ$EVENT.RESULT;

  18051   2 0000D2  8CC7 0012                            LDI      KZ$EVENT+12,AUTO
          2 0000D4  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          2 0000D6  8D46 000F                            SDI      15,B6

      192    18052    6                        ALTRETURN;

  18052   2 0000D8  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      193    18053    6                        END;
      194    18054    5                     END;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:35   

      195    18055    4                  END;

      196    18056    3               END;

  18056   2 0000DB  0F81 0261                            B        s:18271,PREL

      197    18057
      198    18058        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:36   
      199    18059                                           /*
      200    18060                                           Administrative request to disable
      201    18061                                           a line.  Channel table and level
      202    18062                                           (e.g. line, device, sub-device)
      203    18063                                           are supplied.  A disable event is
      204    18064                                           reported to the line-handler. If
      205    18065                                           no activity has been detected on
      206    18066                                           the line, the line handler pulls the
      207    18067                                           plug on itself and returns.  If
      208    18068                                           something other than data set ready
      209    18069                                           goes high, no action is taken, and
      210    18070                                           the request is ignored.
      211    18071                                                                          */
      212    18072    2          CASE (%KHA_FNC_DISABLE);

      213    18073
      214    18074                                           /*
      215    18075                                           Ignore disable following line drop
      216    18076                                                                          */
      217    18077    2            IF KH$ADMIN_FPT.CHN$->KH$CHN.CTX$ ~= ADDR(NIL) AND

  18077   2 0000DD  DCC6 000B                            LDB,B5   11,B6
          2 0000DF  8DC5 000C                            CMN      12,B5
          2 0000E1  0901 0033                            BE       s:18090,PREL
          2 0000E3  CCC6 000D                            LDB,B4   13,B6
          2 0000E5  8DC4 000C                            CMN      12,B4
          2 0000E7  0901 002D                            BE       s:18090,PREL
          2 0000E9  ACC4 000C                            LDB,B2   12,B4
          2 0000EB  8DC2 0002                            CMN      2,B2
          2 0000ED  0901 0027                            BE       s:18090,PREL

      218    18078    2               KH$ADMIN_FPT.LIN$->KH$CHN.CTX$ ~= ADDR(NIL) AND
      219    18079    3               KH$ADMIN_FPT.LIN$->KH$CHN.CTX$->KZ$LINCTX.CHN$ ~= ADDR(NIL) THEN DO;

      220    18080    3               KZ$EVENT.EVENT = %KZ#CLM_EVENT_DSABLD;

  18080   2 0000EF  6C08                                 LDV,R6   8
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:37   
          2 0000F0  EF47 0006                            STR,R6   KZ$EVENT,AUTO

      221    18081    3               KZ$EVENT.TERMID$ = ADDR(KH$ADMIN_FPT.TERMID);

  18081   2 0000F2  9BC6 0001                            LAB,B1   1,B6
          2 0000F4  9FC7 000B                            STB,B1   KZ$EVENT+5,AUTO

      222    18082    3               KZ$EVENT.LINCTX$ = KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$;

  18082   2 0000F6  DCC4 000C                            LDB,B5   12,B4
          2 0000F8  DFC7 0009                            STB,B5   KZ$EVENT+3,AUTO

      223    18083    3               KZ$EVENT.CHN$ = KH$ADMIN_FPT.CHN$;

  18083   2 0000FA  ACC6 000B                            LDB,B2   11,B6
          2 0000FC  AFC7 000D                            STB,B2   KZ$EVENT+7,AUTO

      224    18084    3               CALL KZP$CNCDSC ( KZ$EVENT )

  18084   2 0000FE  CBC7 0006                            LAB,B4   KZ$EVENT,AUTO
          2 000100  CFC7 0028                            STB,B4   BFR$+4,AUTO
          2 000102  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 000104  CBF0 0100                            LAB,B4   256,IMO
          2 000106  E380 0000 0000  xent                 LNJ,B6   KZP$CNCDSC
          2 000109       0003                            DC       s:18086,PREL
          2 00010A  0F81 000A                            B        s:18090,PREL

      225    18085    4               WHENALTRETURN DO;

      226    18086    4                  KH$ADMIN_FPT.RESULTS = KZ$EVENT.RESULT;

  18086   2 00010C  8CC7 0012                            LDI      KZ$EVENT+12,AUTO
          2 00010E  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          2 000110  8D46 000F                            SDI      15,B6

      227    18087    4                  ALTRETURN;

PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:38   
  18087   2 000112  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      228    18088    4                  END;
      229    18089    3               END;

      230    18090    2            RETURN;

  18090   2 000115  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      231    18091        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:39   
      232    18092
      233    18093                                           /*
      234    18094                                           This case performs the function
      235    18095                                           necessary to kill a channel.  Once
      236    18096                                           we insure there is good line context,
      237    18097                                           we initiate disconnect as though
      238    18098                                           data set ready dropped.
      239    18099                                                                          */
      240    18100    2          CASE (%KHA_FNC_KILL);

      241    18101
      242    18102    2            IF KH$ADMIN_FPT.CHN$->KH$CHN.CTX$ ~= ADDR(NIL) AND

  18102   2 000118  DCC6 000B                            LDB,B5   11,B6
          2 00011A  8DC5 000C                            CMN      12,B5
          2 00011C  0901 0035                            BE       s:18116,PREL
          2 00011E  CCC6 000D                            LDB,B4   13,B6
          2 000120  8DC4 000C                            CMN      12,B4
          2 000122  0901 002F                            BE       s:18116,PREL
          2 000124  ACC4 000C                            LDB,B2   12,B4
          2 000126  8DC2 0002                            CMN      2,B2
          2 000128  0901 0029                            BE       s:18116,PREL

      243    18103    2               KH$ADMIN_FPT.LIN$->KH$CHN.CTX$ ~= ADDR(NIL) AND
      244    18104    3               KH$ADMIN_FPT.LIN$->KH$CHN.CTX$->KZ$LINCTX.CHN$ ~= ADDR(NIL) THEN DO;

      245    18105    3               KZ$EVENT.EVENT = %KZ#CLM_EVENT_KILLED;

  18105   2 00012A  6C07                                 LDV,R6   7
          2 00012B  EF47 0006                            STR,R6   KZ$EVENT,AUTO

      246    18106    3               KZ$EVENT.TERMID$ = ADDR(KH$ADMIN_FPT.TERMID);

  18106   2 00012D  9BC6 0001                            LAB,B1   1,B6
          2 00012F  9FC7 000B                            STB,B1   KZ$EVENT+5,AUTO

      247    18107    3               KZ$EVENT.LINCTX$ = KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:40   

  18107   2 000131  DCC4 000C                            LDB,B5   12,B4
          2 000133  DFC7 0009                            STB,B5   KZ$EVENT+3,AUTO

      248    18108    3               KZ$EVENT.CHN$ = KH$ADMIN_FPT.CHN$;

  18108   2 000135  ACC6 000B                            LDB,B2   11,B6
          2 000137  AFC7 000D                            STB,B2   KZ$EVENT+7,AUTO

      249    18109    3               CALL KZP$CNCDSC ( KZ$EVENT )

  18109   2 000139  CBC7 0006                            LAB,B4   KZ$EVENT,AUTO
          2 00013B  CFC7 0028                            STB,B4   BFR$+4,AUTO
          2 00013D  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 00013F  CBF0 0100                            LAB,B4   256,IMO
          2 000141  E380 0000 0000  xent                 LNJ,B6   KZP$CNCDSC
          2 000144       0003                            DC       s:18111,PREL
          2 000145  0F81 000A                            B        s:18114,PREL

      250    18110    4               WHENALTRETURN DO;

      251    18111    4                  KH$ADMIN_FPT.RESULTS = KZ$EVENT.RESULT;

  18111   2 000147  8CC7 0012                            LDI      KZ$EVENT+12,AUTO
          2 000149  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          2 00014B  8D46 000F                            SDI      15,B6

      252    18112    4                  ALTRETURN;

  18112   2 00014D  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      253    18113    4                  END;
      254    18114    3               END;

  18114   2 000150  0F81 01EC                            B        s:18271,PREL

      255    18115    3            ELSE DO;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:41   

      256    18116    3               CALL KHA$DVCADM (%KHA_FNC_DISCONNECT_EVT,I,KH$ADMIN_FPT.TERMID,,);

  18116   2 000152  CBF0 000C                            LAB,B4   12,IMO
          2 000154  AB80 0000 0000                       LAB,B2   0
          2 000157  AFC7 0030                            STB,B2   BFR$+12,AUTO
          2 000159  DB80 0000 0000                       LAB,B5   0
          2 00015C  DFC7 002E                            STB,B5   BFR$+10,AUTO
          2 00015E  9BC6 0001                            LAB,B1   1,B6
          2 000160  9FC7 002C                            STB,B1   BFR$+8,AUTO
          2 000162  EBC7 0020                            LAB,B6   I,AUTO
          2 000164  EFC7 002A                            STB,B6   BFR$+6,AUTO
          2 000166  CFC7 0028                            STB,B4   BFR$+4,AUTO
          2 000168  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 00016A  CBF0 0500                            LAB,B4   1280,IMO
          2 00016C  E380 0000 0000  xent                 LNJ,B6   KHA$DVCADM
          2 00016F       0001                            DC       s:18117,PREL

      257    18117    3               CALL RESET_MLCP;       /* Stop the MLCP while killed  */

  18117   2 000170  E3C0 01CF                            LNJ,B6   s:0,PREL
          2 000172       0001                            DC       s:18118,PREL

      258    18118    3               END;

  18118   2 000173  0F81 01C9                            B        s:18271,PREL

      259    18119
      260    18120        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:42   
      261    18121
      262    18122                                           /*
      263    18123                                           This case provides the funtionality
      264    18124                                           for statistics gathering.
      265    18125                                                                          */
      266    18126    2          CASE (%KHA_FNC_REQSTATS);

      267    18127    3            DO I=0 TO KZ_NHDR-1;

  18127   2 000175  8747 0020                            CL       I,AUTO
          2 000177  0F81 00C9                            B        s:18150+2,PREL

      268    18128    3               IF KZ_SLCENTX(I) ~= 0 AND

  18128   2 000179  B847 0020                            LDR,R3   I,AUTO
          2 00017B  3001                                 SOL,R3   1
          2 00017C  E2B0 0000 0000  xsym                 LLH,R6   KZ_SLCENTX,R3
          2 00017F  6901 00BF                            BEZ,R6   s:18150,PREL
          2 000181  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          2 000183  DCC6 0009                            LDB,B5   9,B6
          2 000185  A856                                 LDR,R2   R6
          2 000186  CBC5 0012                            LAB,B4   18,B5
          2 000188  82A4                                 LB       ,B4,R2
          2 000189  0501 0006                            BBT      s:18128+23,PREL
          2 00018B  82C5 0012                            LB,'2000'X        18,B5
          2 00018D       2000
          2 00018E  0581 00B0                            BBF      s:18150,PREL
          2 000190  9847 0020                            LDR,R1   I,AUTO
          2 000192  8D90 0000 0000  xsym                 CMN      KZ_HDR$,R1
          2 000195  0901 00A9                            BE       s:18150,PREL
          2 000197  CC90 0000 0000  xsym                 LDB,B4   KZ_HDR$,R1
          2 00019A  BCC4 0004                            LDB,B3   4,B4
          2 00019C  BD80 0000 0006  03                   CMB,B3   +6
          2 00019F  0901 009F                            BE       s:18150,PREL
          2 0001A1  8DC4 0006                            CMN      6,B4
          2 0001A3  0901 009B                            BE       s:18150,PREL

PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:43   
      269    18129    3                  (KH$ADMIN_FPT.CTX$->KL_REQSTATS.SLCENT(KZ_SLCENTX(I)) OR
      270    18130    3                  KH$ADMIN_FPT.CTX$->KL_REQSTATS.SLCENT(%KH#ENTID_BSC)) AND
      271    18131    3                  KZ_HDR$(I) ~= ADDR(NIL) AND
      272    18132    3                  KZ_HDR$(I)->KZ$HDR.STTHND@ ~= ENTADDR(NIL) AND
      273    18133    4                  KZ_HDR$(I)->KZ$HDR.STTBFR$ ~= ADDR(NIL) THEN DO;

      274    18134    4                  E@ = KZ_HDR$(I)->KZ$HDR.STTHND@;

  18134   2 0001A5  BFC7 001E                            STB,B3   E@,AUTO

      275    18135    4                  S$=KZ_HDR$(I)->KZ$HDR.STTBFR$;

  18135   2 0001A7  ACC4 0006                            LDB,B2   6,B4
          2 0001A9  AFC7 0014                            STB,B2   S$,AUTO

      276    18136    4                  S$->KZ$BSCSTT.BPSTT=KV$BPCSTT;

  18136   2 0001AB  AC80 0000 0000  xsym                 LDB,B2   KV_B_POOL$
          2 0001AE  2C00                                 LDV,R2   0
          2 0001AF  E870 00A4                            LDR,R6   164,IMO
          2 0001B1  BCC7 0014                            LDB,B3   S$,AUTO
          2 0001B3  3C60                                 LDV,R3   96
          2 0001B4  0008                                 MMM

      277    18137    4                  S$->KZ$BSCSTT.BPSTT.MINSIZ=KV$BPC.MINSIZ;

  18137   2 0001B5  DC80 0000 0000  xsym                 LDB,B5   KV_B_POOL$
          2 0001B8  F845 006A                            LDR,R7   106,B5
          2 0001BA  6C00                                 LDV,R6   0
          2 0001BB  CCC7 0014                            LDB,B4   S$,AUTO
          2 0001BD  8D44 0080                            SDI      128,B4

      278    18138    5                  DO J = SIZEW(KV$BPC.COUNT)*2-1 DOWNTO 0;

  18138   2 0001BF  5C19                                 LDV,R5   25
          2 0001C0  DF47 0021                            STR,R5   J,AUTO
          2 0001C2  0F81 0011                            B        s:18140+2,PREL
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:44   

      279    18139    5                     S$->KZ$BSCSTT.BPSTT.COUNT(J)=KV$BPC.COUNT(J);

  18139   2 0001C4  EC80 0000 0000  xsym                 LDB,B6   KV_B_POOL$
          2 0001C7  B847 0021                            LDR,R3   J,AUTO
          2 0001C9  3E1C                                 ADV,R3   28
          2 0001CA  F836                                 LDR,R7   ,B6,R3
          2 0001CB  6C00                                 LDV,R6   0
          2 0001CC  DCC7 0014                            LDB,B5   S$,AUTO
          2 0001CE  A847 0021                            LDR,R2   J,AUTO
          2 0001D0  2E26                                 ADV,R2   38
          2 0001D1  8D25                                 SDI      ,B5,R2

      280    18140    5                     END;

  18140   2 0001D2  88C7 0021                            DEC      J,AUTO
          2 0001D4  E847 0021                            LDR,R6   J,AUTO
          2 0001D6  68EE                                 BGEZ,R6  s:18139,SPREL

      281    18141    4                  CALL E@ (VDHVKT,BSCVKT) ALTRET(NOSTTS);

  18141   2 0001D7  EBC7 0019                            LAB,B6   BSCVKT,AUTO
          2 0001D9  EFC7 002A                            STB,B6   BFR$+6,AUTO
          2 0001DB  DBC7 0016                            LAB,B5   VDHVKT,AUTO
          2 0001DD  DFC7 0028                            STB,B5   BFR$+4,AUTO
          2 0001DF  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 0001E1  9CC7 001E                            LDB,B1   E@,AUTO
          2 0001E3  CBF0 0200                            LAB,B4   512,IMO
          2 0001E5  E381                                 LNJ,B6   ,B1
          2 0001E6       0059                            DC       s:18150,PREL

      282    18142    4                  IF KH$ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_VDH) AND

  18142   2 0001E7  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          2 0001E9  DCC6 0009                            LDB,B5   9,B6
          2 0001EB  82C5 0010                            LB,'0020'X        16,B5
          2 0001ED       0020
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:45   
          2 0001EE  0581 002F                            BBF      s:18150,PREL
          2 0001F0  8DC7 0017                            CMN      VDHVKT+1,AUTO
          2 0001F2  0901 002B                            BE       s:18150,PREL

      283    18143    5                     VBASE(VDHVKT) ~= ADDR(NIL) THEN DO;

      284    18144    5                     CALL KHC$XEQ2(CURXEQTIM);

  18144   2 0001F4  CBC7 001C                            LAB,B4   CURXEQTIM,AUTO
          2 0001F6  CFC7 0028                            STB,B4   BFR$+4,AUTO
          2 0001F8  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 0001FA  CBF0 0100                            LAB,B4   256,IMO
          2 0001FC  E380 0000 0000  xent                 LNJ,B6   KHC$XEQ2
          2 0001FF       0001                            DC       s:18145,PREL

      285    18145    5                     VBASE(VDHVKT)->KV$STT.SCHEXCTIM = CURXEQTIM

  18145   2 000200  ECC7 0014                            LDB,B6   S$,AUTO
          2 000202  8CC7 001C                            LDI      CURXEQTIM,AUTO
          2 000204  84C6 0018                            SID      24,B6
          2 000206  84C6 001A                            SID      26,B6
          2 000208  DCC7 0017                            LDB,B5   VDHVKT+1,AUTO
          2 00020A  8D45 003C                            SDI      60,B5

      286    18146    5                        - S$->KZ$BSCSTT.KHSTT.INPINTISATIM
      287    18147    5                        - S$->KZ$BSCSTT.KHSTT.OTPINTISATIM;
      288    18148    5                     CALL KHA$SNDSTT(KH$ADMIN_FPT.CTX$->KL_REQSTATS,VDHVKT);

  18148   2 00020C  CCC7 0004                            LDB,B4   @KH$ADMIN_FPT,AUTO
          2 00020E  BCC4 0009                            LDB,B3   9,B4
          2 000210  ABC7 0016                            LAB,B2   VDHVKT,AUTO
          2 000212  AFC7 002A                            STB,B2   BFR$+6,AUTO
          2 000214  BFC7 0028                            STB,B3   BFR$+4,AUTO
          2 000216  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 000218  CBF0 0200                            LAB,B4   512,IMO
          2 00021A  E380 0000 0000  xent                 LNJ,B6   KHA$SNDSTT
          2 00021D       0001                            DC       s:18150,PREL
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:46   

      289    18149    5                     END;

      290    18150    4                  IF KH$ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(KZ_SLCENTX(I)) AND

  18150   2 00021E  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          2 000220  DCC6 0009                            LDB,B5   9,B6
          2 000222  B847 0020                            LDR,R3   I,AUTO
          2 000224  3001                                 SOL,R3   1
          2 000225  A2B0 0000 0000  xsym                 LLH,R2   KZ_SLCENTX,R3
          2 000228  CBC5 0010                            LAB,B4   16,B5
          2 00022A  82A4                                 LB       ,B4,R2
          2 00022B  0581 0013                            BBF      s:18150,PREL
          2 00022D  8DC7 001A                            CMN      BSCVKT+1,AUTO
          2 00022F  0901 000F                            BE       s:18150,PREL

      291    18151    4                     VBASE(BSCVKT) ~= ADDR(NIL) THEN
      292    18152    4                     CALL KHA$SNDSTT(KH$ADMIN_FPT.CTX$->KL_REQSTATS,BSCVKT);

  18152   2 000231  CBC7 0019                            LAB,B4   BSCVKT,AUTO
          2 000233  CFC7 002A                            STB,B4   BFR$+6,AUTO
          2 000235  DFC7 0028                            STB,B5   BFR$+4,AUTO
          2 000237  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 000239  CBF0 0200                            LAB,B4   512,IMO
          2 00023B  E380 0000 0000  xent                 LNJ,B6   KHA$SNDSTT
          2 00023E       0001                            DC       s:18150,PREL

  18150   2                              NOSTTS          null
      293    18153    4   NOSTTS:        ;
      294    18154    4                  END;

      295    18155    3               END;

  18155   2 00023F  8AC7 0020            NOSTTS          INC      I,AUTO
          2 000241  E847 0020                            LDR,R6   I,AUTO
          2 000243  E900 0000 0000  xsym                 CMR,R6   KZ_NHDR
          2 000246  0201 FF32                            BL       s:18128,PREL
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:47   
          2 000248  0F81 00F4                            B        s:18271,PREL

      296    18156        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:48   
      297    18157                                           /*
      298    18158                                           The build context event from Handler
      299    18159                                           Common is the result of a successful
      300    18160                                           line profile request.
      301    18161                                                                          */
      302    18162    2          CASE (%KHA_FNC_BLDCTX);

      303    18163
      304    18164    2            IF KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ ~= ADDR(NIL)

  18164   2 00024A  DCC6 000D                            LDB,B5   13,B6
          2 00024C  8DC5 000C                            CMN      12,B5
          2 00024E  0901 0022                            BE       s:18175,PREL

      305    18165    3            THEN DO;

      306    18166    3               KZ$EVENT.EVENT = %KZ#CLM_EVENT_BLDCTX;

  18166   2 000250  6C02                                 LDV,R6   2
          2 000251  EF47 0006                            STR,R6   KZ$EVENT,AUTO

      307    18167    3               KZ$EVENT.CHNCTX$ = KH$ADMIN_FPT.CTX$;

  18167   2 000253  CCC6 0009                            LDB,B4   9,B6
          2 000255  CFC7 0007                            STB,B4   KZ$EVENT+1,AUTO

      308    18168    3               KZ$EVENT.TERMID$ = ADDR(KH$ADMIN_FPT.TERMID);

  18168   2 000257  ABC6 0001                            LAB,B2   1,B6
          2 000259  AFC7 000B                            STB,B2   KZ$EVENT+5,AUTO

      309    18169    3               KZ$EVENT.LINCTX$ = KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$;

  18169   2 00025B  9CC5 000C                            LDB,B1   12,B5
          2 00025D  9FC7 0009                            STB,B1   KZ$EVENT+3,AUTO

      310    18170    3               KZ$EVENT.CHN$ = KH$ADMIN_FPT.CHN$;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:49   

  18170   2 00025F  DCC6 000B                            LDB,B5   11,B6
          2 000261  DFC7 000D                            STB,B5   KZ$EVENT+7,AUTO

      311    18171    3               CALL KZP$CNCDSC ( KZ$EVENT );

  18171   2 000263  EBC7 0006                            LAB,B6   KZ$EVENT,AUTO
          2 000265  EFC7 0028                            STB,B6   BFR$+4,AUTO
          2 000267  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 000269  CBF0 0100                            LAB,B4   256,IMO
          2 00026B  E380 0000 0000  xent                 LNJ,B6   KZP$CNCDSC
          2 00026E       0001                            DC       s:18172,PREL

      312    18172    3               END;

  18172   2 00026F  0F81 00CD                            B        s:18271,PREL

      313    18173    3            ELSE DO;

      314    18174        /*N* KH$ADMIN_FPT.RESULTS = */
      315    18175    3               END;

  18175   2 000271  0F81 00CB                            B        s:18271,PREL

      316    18176
      317    18177        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:50   
      318    18178                                           /*
      319    18179                                           The build context complete event
      320    18180                                           is to inform us that all context
      321    18181                                           for the specified channel has been
      322    18182                                           received.
      323    18183                                                                          */
      324    18184    2          CASE (%KHA_FNC_BLDCTXCMP);

      325    18185
      326    18186    2            IF KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ ~= ADDR(NIL)

  18186   2 000273  DCC6 000D                            LDB,B5   13,B6
          2 000275  8DC5 000C                            CMN      12,B5
          2 000277  0901 001E                            BE       s:18196,PREL

      327    18187    3            THEN DO;

      328    18188    3               KZ$EVENT.EVENT = %KZ#CLM_EVENT_CTXCMP;

  18188   2 000279  6C03                                 LDV,R6   3
          2 00027A  EF47 0006                            STR,R6   KZ$EVENT,AUTO

      329    18189    3               KZ$EVENT.TERMID$ = ADDR(KH$ADMIN_FPT.TERMID);

  18189   2 00027C  CBC6 0001                            LAB,B4   1,B6
          2 00027E  CFC7 000B                            STB,B4   KZ$EVENT+5,AUTO

      330    18190    3               KZ$EVENT.LINCTX$ = KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$;

  18190   2 000280  ACC5 000C                            LDB,B2   12,B5
          2 000282  AFC7 0009                            STB,B2   KZ$EVENT+3,AUTO

      331    18191    3               KZ$EVENT.CHN$ = KH$ADMIN_FPT.CHN$;

  18191   2 000284  9CC6 000B                            LDB,B1   11,B6
          2 000286  9FC7 000D                            STB,B1   KZ$EVENT+7,AUTO

PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:51   
      332    18192    3               CALL KZP$CNCDSC ( KZ$EVENT );

  18192   2 000288  DBC7 0006                            LAB,B5   KZ$EVENT,AUTO
          2 00028A  DFC7 0028                            STB,B5   BFR$+4,AUTO
          2 00028C  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 00028E  CBF0 0100                            LAB,B4   256,IMO
          2 000290  E380 0000 0000  xent                 LNJ,B6   KZP$CNCDSC
          2 000293       0001                            DC       s:18193,PREL

      333    18193    3               END;

  18193   2 000294  0F81 00A8                            B        s:18271,PREL

      334    18194    3            ELSE DO;

      335    18195        /*N* KH$ADMIN_FPT.RESULTS = */
      336    18196    3               END;

  18196   2 000296  0F81 00A6                            B        s:18271,PREL

      337    18197        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:52   
      338    18198                                           /*
      339    18199                                           This event performs the function-
      340    18200                                           ality necessary as a result of a
      341    18201                                           DISC TERM keyin.
      342    18202                                                                          */
      343    18203    2          CASE ( %KHA_FNC_DISCONNECT_RQS );

      344    18204
      345    18205    2            IF KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ ~= ADDR(NIL)

  18205   2 000298  DCC6 000D                            LDB,B5   13,B6
          2 00029A  8DC5 000C                            CMN      12,B5
          2 00029C  0901 001A                            BE       s:18214,PREL

      346    18206    3            THEN DO;

      347    18207    3               KZ$EVENT.EVENT = %KZ#CLM_EVENT_DSCTRM;

  18207   2 00029E  6C09                                 LDV,R6   9
          2 00029F  EF47 0006                            STR,R6   KZ$EVENT,AUTO

      348    18208    3               KZ$EVENT.TERMID$ = ADDR(KH$ADMIN_FPT.TERMID);

  18208   2 0002A1  CBC6 0001                            LAB,B4   1,B6
          2 0002A3  CFC7 000B                            STB,B4   KZ$EVENT+5,AUTO

      349    18209    3               KZ$EVENT.LINCTX$ = KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$;

  18209   2 0002A5  ACC5 000C                            LDB,B2   12,B5
          2 0002A7  AFC7 0009                            STB,B2   KZ$EVENT+3,AUTO

      350    18210    3               CALL KZP$CNCDSC ( KZ$EVENT );

  18210   2 0002A9  9BC7 0006                            LAB,B1   KZ$EVENT,AUTO
          2 0002AB  9FC7 0028                            STB,B1   BFR$+4,AUTO
          2 0002AD  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 0002AF  CBF0 0100                            LAB,B4   256,IMO
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:53   
          2 0002B1  E380 0000 0000  xent                 LNJ,B6   KZP$CNCDSC
          2 0002B4       0001                            DC       s:18211,PREL

      351    18211    3               END;

  18211   2 0002B5  0F81 0087                            B        s:18271,PREL

      352    18212    3            ELSE DO;

      353    18213        /* KH$ADMIN_FPT.RESULTS = */
      354    18214    3               END;

  18214   2 0002B7  0F81 0085                            B        s:18271,PREL

      355    18215        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:54   
      356    18216    2          CASE ( %KHA_FNC_SGNRJC );

      357    18217
      358    18218    2            IF KH$ADMIN_FPT.LIN$->KH$CHN.AUTLGN OR

  18218   2 0002B9  DCC6 000D                            LDB,B5   13,B6
          2 0002BB  8285                                 LB,'0004'X        ,B5
          2 0002BC       0004
          2 0002BD  0501 0005                            BBT      s:18220,PREL
          2 0002BF  8DC5 000C                            CMN      12,B5
          2 0002C1  0981 000D                            BNE      s:18222,PREL

      359    18219    2               KH$ADMIN_FPT.LIN$->KH$CHN.CTX$ = ADDR(NIL) THEN
      360    18220    2               SGNRJC_LOG.BUF_=VECTOR(NIL);

  18220   2 0002C3  AB80 0000 0000  03                   LAB,B2   0
          2 0002C6  2C10                                 LDV,R2   16
          2 0002C7  6C06                                 LDV,R6   6
          2 0002C8  BB80 0000 0000  00                   LAB,B3   KH_DWNLODCCP
          2 0002CB  3C3C                                 LDV,R3   60
          2 0002CC  0008                                 MMM
          2 0002CD  0F81 0013                            B        s:18224,PREL

      361    18221    2            ELSE
      362    18222    2               SGNRJC_LOG.BUF_=VECTOR(KH$ADMIN_FPT.LIN$->KH$CHN.CTX$->

  18222   2 0002CF  CCC5 000C                            LDB,B4   12,B5
          2 0002D1  ACC4 0056                            LDB,B2   86,B4
          2 0002D3  AFC7 0029                            STB,B2   BFR$+5,AUTO
          2 0002D5  6C1F                                 LDV,R6   31
          2 0002D6  EF47 0028                            STR,R6   BFR$+4,AUTO
          2 0002D8  ABC7 0028                            LAB,B2   BFR$+4,AUTO
          2 0002DA  2C00                                 LDV,R2   0
          2 0002DB  6C06                                 LDV,R6   6
          2 0002DC  BB80 0000 0000  00                   LAB,B3   KH_DWNLODCCP
          2 0002DF  3C3C                                 LDV,R3   60
          2 0002E0  0008                                 MMM
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:55   

      363    18223    2                  KZ$LINCTX.INPBFR$->SSTR);
      364    18224    2            IF KH$ADMIN_FPT.LIN$->KH$CHN.CTX$ ~= ADDR(NIL) THEN

  18224   2 0002E1  DCC6 000D                            LDB,B5   13,B6
          2 0002E3  8DC5 000C                            CMN      12,B5
          2 0002E5  0901 000D                            BE       s:18228,PREL

      365    18225    2               SGNRJC_LOG.V.TERMID = KH$ADMIN_FPT.LIN$->KH$CHN.CTX$->

  18225   2 0002E7  CCC5 000C                            LDB,B4   12,B5
          2 0002E9  AB84                                 LAB,B2   ,B4
          2 0002EA  2C08                                 LDV,R2   8
          2 0002EB  6C10                                 LDV,R6   16
          2 0002EC  BB80 0000 0000  00                   LAB,B3   KH_DWNLODCCP
          2 0002EF  3C46                                 LDV,R3   70
          2 0002F0  0008                                 MMM
          2 0002F1  0F81 000A                            B        s:18241,PREL

      366    18226    2                  KZ$LINCTX.LINID;
      367    18227    2            ELSE
      368    18228    2               SGNRJC_LOG.V.TERMID = '0'B;

  18228   2 0002F3  CB80 0000 0000  00                   LAB,B4   KH_DWNLODCCP
          2 0002F6  5C10                                 LDV,R5   16
          2 0002F7  0021                                 ALR      ;
          2 0002F8       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 0002FA       4004 0023                                ALPHANUM(35,B4,,R5,FILL)

      369    18229
      370    18230
      371    18231
      372    18232        /*E*  ERROR: KZA-E$LINLGNREJ-7
      373    18233              MESSAGE: Logon rejected.
      374    18234              DESCRIPTION: A terminal definition could not be found for the
      375    18235              specified logon string. If the logon string was received from
      376    18236              the remote terminal, it is displayed as it was received, in
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:56   
      377    18237              EBCDIC format.  If it was an AUTOLOG terminal, no logon string
      378    18238              is displayed and the channel number must be used to identify the
      379    18239              problem.
      380    18240                                                                           */
      381    18241    2            CALL KHA$ERRLOG ( SGNRJC_LOG )

  18241   2 0002FC  BB80 0000 000B  03                   LAB,B3   +11
          2 0002FF  CBF0 0100                            LAB,B4   256,IMO
          2 000301  437F                                 CSYNC    s:18241+4,SPREL
          2 000302  E380 0000 0000  xent                 LNJ,B6   KHA$ERRLOG
          2 000305       0003                            DC       s:18244,PREL
          2 000306  0F81 0001                            B        s:18244,PREL

      382    18242    3            WHENALTRETURN DO;

      383    18243    3               END;

      384    18244    2            IF KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$ ~= ADDR(NIL)

  18244   2 000308  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          2 00030A  DCC6 000D                            LDB,B5   13,B6
          2 00030C  8DC5 000C                            CMN      12,B5
          2 00030E  0901 001E                            BE       s:18254,PREL

      385    18245    3            THEN DO;

      386    18246    3               KZ$EVENT.EVENT = %KZ#CLM_EVENT_DSCTRM;

  18246   2 000310  6C09                                 LDV,R6   9
          2 000311  EF47 0006                            STR,R6   KZ$EVENT,AUTO

      387    18247    3               KZ$EVENT.TERMID$ = ADDR(KH$ADMIN_FPT.TERMID);

  18247   2 000313  CBC6 0001                            LAB,B4   1,B6
          2 000315  CFC7 000B                            STB,B4   KZ$EVENT+5,AUTO

      388    18248    3               KZ$EVENT.LINCTX$ = KH$ADMIN_FPT.LIN$ -> KH$CHN.CTX$;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:57   

  18248   2 000317  BCC5 000C                            LDB,B3   12,B5
          2 000319  BFC7 0009                            STB,B3   KZ$EVENT+3,AUTO

      389    18249    3               KZ$EVENT.CHN$ = KH$ADMIN_FPT.CHN$;

  18249   2 00031B  ACC6 000B                            LDB,B2   11,B6
          2 00031D  AFC7 000D                            STB,B2   KZ$EVENT+7,AUTO

      390    18250    3               CALL KZP$CNCDSC ( KZ$EVENT );

  18250   2 00031F  DBC7 0006                            LAB,B5   KZ$EVENT,AUTO
          2 000321  DFC7 0028                            STB,B5   BFR$+4,AUTO
          2 000323  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 000325  CBF0 0100                            LAB,B4   256,IMO
          2 000327  E380 0000 0000  xent                 LNJ,B6   KZP$CNCDSC
          2 00032A       0001                            DC       s:18251,PREL

      391    18251    3               END;

  18251   2 00032B  0F81 0011                            B        s:18271,PREL

      392    18252    3            ELSE DO;

      393    18253        /* KH$ADMIN_FPT.RESULTS = */
      394    18254    3               END;

  18254   2 00032D  0F81 000F                            B        s:18271,PREL

      395    18255        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:58   
      396    18256                                           /*
      397    18257                                           After a host recovery, we'll receive
      398    18258                                           one of these.  We should call KHA to
      399    18259                                           get a record written to the COMAC file
      400    18260                                           saying we're connected.
      401    18261                                                                          */
      402    18262    2          CASE (%KHA_FNC_HOSTUP);

      403    18263
      404    18264    2            CALL KHA$LINE_ACTIVE ( KH$ADMIN_FPT.TERMID );

  18264   2 00032F  DBC6 0001                            LAB,B5   1,B6
          2 000331  DFC7 0028                            STB,B5   BFR$+4,AUTO
          2 000333  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 000335  CBF0 0100                            LAB,B4   256,IMO
          2 000337  E380 0000 0000  xent                 LNJ,B6   KHA$LINE_ACTIVE
          2 00033A       0001                            DC       s:18264+12,PREL
          2 00033B  0F81 0001                            B        s:18271,PREL

      405    18265        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:59   
      406    18266
      407    18267    2          CASE (ELSE);

      408    18268        /*N* SNAP */
      409    18269
      410    18270    2          END;

      411    18271    1         RETURN;

  18271   2 00033D  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      412    18272        %EJECT;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:60   
      413    18273
      414    18274                                           /*
      415    18275                                           This function causes the equivalent
      416    18276                                           of an "FEP stop I/O" to be done on
      417    18277                                           the MLCP.  After the halt, a fresh
      418    18278                                           copy of LCTs are down-loaded into
      419    18279                                           the MLCP (where we sit doing nothing).
      420    18280                                           If we get IONAKed we should screech.
      421    18281                                                                          */
      422    18282    1   RESET_MLCP: PROC;

  18282   2 000340  EFC7 0026            RESET_MLCP      STB,B6   BFR$+2,AUTO

      423    18283
      424    18284    2         KH_OTPCHN.OTPCHN = '0'B;

  18284   2 000342  8800 0000 000C  00                   LBF,'0040'X       KH_OTPCHN
  18284   2 000345       0040

      425    18285    2         KH_OTPCHN.CHNCTR = '0'B;

  18285   2 000346  8700 0000 000D  00                   CL       KH_OTPCHN+1

      426    18286    2         KH_OTPCHN.CHNCTR.CHNINT = '1'B;

  18286   2 000349  8900 0000 000D  00                   LBT,'8000'X       KH_OTPCHN+1
  18286   2 00034C       8000

      427    18287    2         CALL KHI$IO_OTP (KH$ADMIN_FPT.CHN$ -> KH$CHN, KH_OTPCHN);

  18287   2 00034D  DCC7 0004                            LDB,B5   @KH$ADMIN_FPT,AUTO
          2 00034F  CCC5 000B                            LDB,B4   11,B5
          2 000351  BB80 0000 000C  00                   LAB,B3   KH_OTPCHN
          2 000354  BFC7 002A                            STB,B3   BFR$+6,AUTO
          2 000356  CFC7 0028                            STB,B4   BFR$+4,AUTO
          2 000358  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 00035A  CBF0 0200                            LAB,B4   512,IMO
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:61   
          2 00035C  E380 0000 0000  xent                 LNJ,B6   KHI$IO_OTP
          2 00035F       0001                            DC       s:18288,PREL

      428    18288    2         KH_OTPCHN.OTPCHN = '1'B;

  18288   2 000360  8900 0000 000C  00                   LBT,'0040'X       KH_OTPCHN
  18288   2 000363       0040

      429    18289    2         CALL KHI$IO_OTP (KH$ADMIN_FPT.CHN$ -> KH$CHN, KH_OTPCHN);

  18289   2 000364  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          2 000366  DCC6 000B                            LDB,B5   11,B6
          2 000368  CB80 0000 000C  00                   LAB,B4   KH_OTPCHN
          2 00036B  CFC7 002A                            STB,B4   BFR$+6,AUTO
          2 00036D  DFC7 0028                            STB,B5   BFR$+4,AUTO
          2 00036F  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 000371  CBF0 0200                            LAB,B4   512,IMO
          2 000373  E380 0000 0000  xent                 LNJ,B6   KHI$IO_OTP
          2 000376       0001                            DC       s:18291,PREL

      430    18290
      431    18291    2         IF KH$ADMIN_FPT.CHN$ -> KH$CHN.DVCID = '2978'X THEN

  18291   2 000377  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          2 000379  DCC6 000B                            LDB,B5   11,B6
          2 00037B  E845 0002                            LDR,R6   2,B5
          2 00037D  E970 2978                            CMR,R6   10616,IMO
          2 00037F  0981 0009                            BNE      s:18294,PREL

      432    18292    2            KH_DWNLODLCT.CCPLODBIS = KZ_CCPLODBIS_MLC16; /* MLC-16 (NMLC) */

  18292   2 000381  D800 0000 0000  xsym                 LDR,R5   KZ_CCPLODBIS_MLC16
          2 000384  DF00 0000 0009  00                   STR,R5   KH_DWNLODLCT+4
          2 000387  0F81 0007                            B        s:18295,PREL

      433    18293    2         ELSE
      434    18294    2            KH_DWNLODLCT.CCPLODBIS = KZ_CCPLODBIS_MLC8; /* MLC-8 (MLCP) */
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:62   

  18294   2 000389  D800 0000 0000  xsym                 LDR,R5   KZ_CCPLODBIS_MLC8
          2 00038C  DF00 0000 0009  00                   STR,R5   KH_DWNLODLCT+4

      435    18295    2         KH_DWNLODLCT.CHN$ = KH$ADMIN_FPT.CHN$;

  18295   2 00038F  DF80 0000 0005  00                   STB,B5   KH_DWNLODLCT

      436    18296    2         KH_DWNLODLCT.CCPLCT$ = ADDR ( KZM$MLCP );

  18296   2 000392  CB80 0000 0000  xsym                 LAB,B4   KZM$MLCP
          2 000395  CF80 0000 0007  00                   STB,B4   KH_DWNLODLCT+2

      437    18297    2         KH_DWNLODLCT.RCVINTLVL = %KZ#ACTLVL;

  18297   2 000398  6C01                                 LDV,R6   1
          2 000399  EF00 0000 000A  00                   STR,R6   KH_DWNLODLCT+5

      438    18298    2         KH_DWNLODLCT.TRNINTLVL = 0;

  18298   2 00039C  8700 0000 000B  00                   CL       KH_DWNLODLCT+6

      439    18299    2         CALL KHI$DWNLODLCT ( KH_DWNLODLCT )

  18299   2 00039F  BB80 0000 000D  03                   LAB,B3   +13
          2 0003A2  CBF0 0100                            LAB,B4   256,IMO
          2 0003A4  E380 0000 0000  xent                 LNJ,B6   KHI$DWNLODLCT
          2 0003A7       0003                            DC       s:18304,PREL
          2 0003A8  0F81 0001                            B        s:18304,PREL

      440    18300    3         WHENALTRETURN DO;

      441    18301        /*N* SNAP */
      442    18302    3            END;

      443    18303
      444    18304    3         IF KH$ADMIN_FPT.CHN$ -> KH$CHN.CLK THEN DO;
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:63   

  18304   2 0003AA  ECC7 0004                            LDB,B6   @KH$ADMIN_FPT,AUTO
          2 0003AC  DCC6 000B                            LDB,B5   11,B6
          2 0003AE  8285                                 LB,'0020'X        ,B5
          2 0003AF       0020
          2 0003B0  0581 001E                            BBF      s:18310,PREL

      445    18305    3            KH_OTPLCT.LCTBYT.ADR = 20;

  18305   2 0003B2  6C14                                 LDV,R6   20
          2 0003B3  EA80 0000 000F  00                   SRM,R6,'00FF'X    KH_OTPLCT+1
          2 0003B6       00FF

      446    18306    3            KH_OTPLCT.LCTBYT.DAT = KZM$MLCP.LCTBYT(20)+8;

  18306   2 0003B7  D280 0000 000D  xsym                 LLH,R5   KZM$MLCP+13
          2 0003BA  5E08                                 ADV,R5   8
          2 0003BB  D780 0000 000F  00                   STH,R5   KH_OTPLCT+1

      447    18307    3            CALL KHI$IO_OTPLCTBYT (KH$ADMIN_FPT.CHN$ -> KH$CHN, KH_OTPLCT);

  18307   2 0003BE  DCC6 000B                            LDB,B5   11,B6
          2 0003C0  CB80 0000 000E  00                   LAB,B4   KH_OTPLCT
          2 0003C3  CFC7 002A                            STB,B4   BFR$+6,AUTO
          2 0003C5  DFC7 0028                            STB,B5   BFR$+4,AUTO
          2 0003C7  BBC7 0028                            LAB,B3   BFR$+4,AUTO
          2 0003C9  CBF0 0200                            LAB,B4   512,IMO
          2 0003CB  E380 0000 0000  xent                 LNJ,B6   KHI$IO_OTPLCTBYT
          2 0003CE       0001                            DC       s:18310,PREL

      448    18308    3            END;

      449    18309
      450    18310    2         RETURN;

  18310   2 0003CF  ECC7 0026                            LDB,B6   BFR$+2,AUTO
          2 0003D1  C3C6 0001                            LNJ,B4   1,B6
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:64   
      451    18311    2   END RESET_MLCP;
      452    18312
      453    18313    1   END KZA$ADMIN;

PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:65   
--  Include file information  --

   KZ_MLCP_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   KZ_LIN_C.:E05TOU  is referenced.
   KZ$LINCTX.:E05TOU  is referenced.
   KZ_CLM_E.:E05TOU  is referenced.
   KH_CLKFNC_E.:E05TOU  is referenced.
   KH$CLK.:E05TOU  is referenced.
   KZ_PERR_C.:E05TOU  is referenced.
   KZ_INIT_C.:E05TOU  is referenced.
   KH$STT.:E05TOU  is referenced.
   KV$BPC.:E05TOU  is referenced.
   KZ$BSCSTT.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   GH_IOFNC_E.:E05TOU  is referenced.
   KH$IO.:E05TOU  is referenced.
   KZ_SCODE_C.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
      No diagnostics issued in procedure KZA$ADMIN.
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:66   

 **** Variables and constants ****

  ****  Section 000  Data  KZA$ADMIN

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    30-0-0/w STRC(336)   r     1 CLKABRT                    0-0-0/w STRC(80)    r     1 KH_DWNLODCCP
     5-0-0/w STRC(112)   r     1 KH_DWNLODLCT               C-0-0/w STRC(32)    r     1 KH_OTPCHN
     E-0-0/w STRC(32)    r     1 KH_OTPLCT                 10-0-0/w STRC(176)   r     1 KH_SETCLK
    1B-0-0/w STRC(336)   r     1 SGNRJC_LOG

  ****  Section 001 RoData KZA$ADMIN

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(224)   r     1 KZ$EVENT_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @KH$ADMIN_FPT             24-0-0/w PTR         r     1 BFR$
    19-0-0/w VECT        r     1 BSCVKT                    1C-0-0/w UBIN(32)    r     1 CURXEQTIM
    1E-0-0/w EPTR        r     1 E@                        20-0-0/w UBIN(16)    r     1 I
    21-0-0/w SBIN(16)    r     1 J                         *0-0-0/w STRC(288)   r     1 KH$ADMIN_FPT
     6-0-0/w STRC(224)   r     1 KZ$EVENT                  14-0-0/w PTR         r     1 S$
    16-0-0/w VECT        r     1 VDHVKT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KV_B_POOL$                 0-0-0/w STRC(2360)  r     1 KZM$MLCP
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:67   
     0-0-0/w UBIN(16)    r     1 KZ_CCPLODBIS_MLC16         0-0-0/w UBIN(16)    r     1 KZ_CCPLODBIS_MLC8
     0-0-0/w PTR         r     1 KZ_HDR$(0:0)
     0-0-0/w UBIN(16)    r     1 KZ_NHDR
     0-0-0/w UBIN(8)     r     1 KZ_SLCENTX(0:0)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(512)   r     1 KH$CHN                     0-0-0/w STRC(320)   r     1 KL_REQSTATS
     0-0-0/w ASTR(1824)  r     1 KV$BPC                     0-0-0/w STRC(1312)  r     1 KV$BPCSTT
     0-0-0/w STRC(8960)  r     1 KV$STT                     0-0-0/w STRC(2080)  r     1 KZ$BSCSTT
     0-0-0/w STRC(272)   r     1 KZ$HDR                     0-0-0/w STRC(2192)  r     1 KZ$LINCTX
     0-0-0/c CHAR(32)    r     1 SSTR


   Procedure KZA$ADMIN requires 979 words for executable code.
   Procedure KZA$ADMIN requires 50 words of local(AUTO) storage.

    No errors detected in file KZA$ADMIN.:E05TSI    .
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:68   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:69   
          MINI XREF LISTING

BFR$
     17979**DCL     17986--IMP-PTR
BSCVKT
     17973**DCL     18141<>CALL    18150>>IF      18152<>CALL
CLKABRT
     17051**DCL     18036<>CALL
CLKABRT.V
     17055**DCL     17053--DCLINIT
CLKABRT.V.TERMID
     17118**DCL     18035<<ASSIGN
CLKABRT.V.TERMID.TERM
     17120**DCL     17129--REDEF
CURXEQTIM
     17974**DCL     18144<>CALL    18145>>ASSIGN
E@
     17975**DCL     18134<<ASSIGN  18141>>CALL
I
     17976**DCL     18116<>CALL    18127<<DOINDEX 18128>>IF      18128>>IF      18128>>IF      18128>>IF
     18128>>IF      18134>>ASSIGN  18135>>ASSIGN  18150>>IF
J
     17977**DCL     18138<<DOINDEX 18139>>ASSIGN  18139>>ASSIGN
KH$ADMIN_FPT
     15205**DCL        14--PROC
KH$ADMIN_FPT.CHN$
     15332**DCL     18005>>IF      18009>>ASSIGN  18025>>ASSIGN  18048>>ASSIGN  18077>>IF      18083>>ASSIGN
     18102>>IF      18108>>ASSIGN  18170>>ASSIGN  18191>>ASSIGN  18249>>ASSIGN  18287>>CALL    18289>>CALL
     18291>>IF      18295>>ASSIGN  18304>>IF      18307>>CALL
KH$ADMIN_FPT.CTX$
     15261**DCL     18128>>IF      18128>>IF      18142>>IF      18148>>CALL    18150>>IF      18152>>CALL
     18167>>ASSIGN
KH$ADMIN_FPT.FNC
     15206**DCL     17993>>DOCASE
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:70   
KH$ADMIN_FPT.LIN$
     15336**DCL     18024>>ASSIGN  18041>>IF      18043>>IF      18046>>ASSIGN  18049>>CALL    18077>>IF
     18077>>IF      18082>>ASSIGN  18102>>IF      18102>>IF      18107>>ASSIGN  18164>>IF      18169>>ASSIGN
     18186>>IF      18190>>ASSIGN  18205>>IF      18209>>ASSIGN  18218>>IF      18218>>IF      18222>>ASSIGN
     18224>>IF      18225>>ASSIGN  18244>>IF      18248>>ASSIGN
KH$ADMIN_FPT.RESULTS
     15357**DCL     18051<<ASSIGN  18086<<ASSIGN  18111<<ASSIGN
KH$ADMIN_FPT.TERMID
     15227**DCL     18035>>ASSIGN  18047--ASSIGN  18081--ASSIGN  18106--ASSIGN  18116<>CALL    18168--ASSIGN
     18189--ASSIGN  18208--ASSIGN  18247--ASSIGN  18264<>CALL
KH$ADMIN_FPT.TERMID.LEV
     15229**DCL     18021>>IF
KH$ADMIN_FPT.TERMID.TERM
     15229**DCL     15238--REDEF
KH$CHN
     15737**DCL     18287<>CALL    18289<>CALL    18307<>CALL
KH$CHN.AUTLGN
     15748**DCL     18218>>IF
KH$CHN.CLK
     15748**DCL     18304>>IF
KH$CHN.CTX$
     15807**DCL     18041>>IF      18043>>IF      18046>>ASSIGN  18049>>CALL    18077>>IF      18077>>IF
     18077>>IF      18082>>ASSIGN  18102>>IF      18102>>IF      18102>>IF      18107>>ASSIGN  18164>>IF
     18169>>ASSIGN  18186>>IF      18190>>ASSIGN  18205>>IF      18209>>ASSIGN  18218>>IF      18222>>ASSIGN
     18224>>IF      18225>>ASSIGN  18244>>IF      18248>>ASSIGN
KH$CHN.DVCID
     15763**DCL     18005>>IF      18291>>IF
KH$CHN.TERMID.TERM
     15833**DCL     15842--REDEF
KH$CHN.TERMID.TTYP
     15833**DCL     18024<<ASSIGN
KHA$DVCADM
     17953**DCL-ENT 18116--CALL
KHA$ERRLOG
     17954**DCL-ENT 18036--CALL    18241--CALL
KHA$LINE_ACTIVE
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:71   
     17955**DCL-ENT 18264--CALL
KHA$SNDSTT
     17956**DCL-ENT 18148--CALL    18152--CALL
KHC$CLOCK
     17957**DCL-ENT 18028--CALL
KHC$XEQ2
     17958**DCL-ENT 18144--CALL
KHI$DWNLODCCP
     17959**DCL-ENT 18011--CALL
KHI$DWNLODLCT
     17960**DCL-ENT 18299--CALL
KHI$IO_OTP
     17961**DCL-ENT 18287--CALL    18289--CALL
KHI$IO_OTPLCTBYT
     17962**DCL-ENT 18307--CALL
KH_DWNLODCCP
     15891**DCL     18011<>CALL
KH_DWNLODCCP.CCPLCT$
     15897**DCL     18010<<ASSIGN
KH_DWNLODCCP.CCPLODBIS
     15897**DCL     18006<<ASSIGN  18008<<ASSIGN
KH_DWNLODCCP.CHN$
     15897**DCL     18009<<ASSIGN
KH_DWNLODLCT
     15916**DCL     18299<>CALL
KH_DWNLODLCT.CCPLCT$
     15922**DCL     18296<<ASSIGN
KH_DWNLODLCT.CCPLODBIS
     15922**DCL     18292<<ASSIGN  18294<<ASSIGN
KH_DWNLODLCT.CHN$
     15922**DCL     18295<<ASSIGN
KH_DWNLODLCT.RCVINTLVL
     15923**DCL     18297<<ASSIGN
KH_DWNLODLCT.TRNINTLVL
     15923**DCL     18298<<ASSIGN
KH_OTPCHN
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:72   
     16398**DCL     18287<>CALL    18289<>CALL
KH_OTPCHN.CHNCTR
     16431**DCL     18285<<ASSIGN
KH_OTPCHN.CHNCTR.CHNINT
     16431**DCL     18286<<ASSIGN
KH_OTPCHN.OTPCHN
     16404**DCL     18284<<ASSIGN  18288<<ASSIGN
KH_OTPLCT
     16515**DCL     18307<>CALL
KH_OTPLCT.LCTBYT.ADR
     16531**DCL     18305<<ASSIGN
KH_OTPLCT.LCTBYT.DAT
     16531**DCL     18306<<ASSIGN
KH_SETCLK
     16637**DCL     18028<>CALL
KH_SETCLK.CTBCTX$
     16643**DCL     18027<<ASSIGN
KH_SETCLK.SBR$
     16754**DCL     18026<<ASSIGN
KH_SETCLK.UID
     16653**DCL     16654--REDEF   16655--REDEF
KH_SETCLK.UID$
     16654**DCL     18025<<ASSIGN
KL_REQSTATS
     15580**DCL     18148<>CALL    18152<>CALL
KL_REQSTATS.DSPENT
     15676**DCL     18142>>IF      18150>>IF
KL_REQSTATS.DSPMSK
     15670**DCL     15676--REDEF
KL_REQSTATS.SLCENT
     15718**DCL     18128>>IF      18128>>IF
KL_REQSTATS.SLCMSK
     15711**DCL     15718--REDEF
KV$BPC.BITMAPSIZ
     17149**DCL     17152--IMP-SIZ
KV$BPC.COUNT
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:73   
     17148**DCL     18138--DOINDEX 18139>>ASSIGN
KV$BPC.MINSIZ
     17148**DCL     18137>>ASSIGN
KV$BPCSTT
     17160**DCL     18136>>ASSIGN
KV$STT.REQSTATS.DSPMSK
     17450**DCL     17456--REDEF
KV$STT.REQSTATS.SLCMSK
     17491**DCL     17498--REDEF
KV$STT.SCHEXCTIM
     17561**DCL     18145<<ASSIGN
KV_B_POOL$
     17968**DCL     17138--IMP-PTR 17160--IMP-PTR 18136>>ASSIGN  18137>>ASSIGN  18139>>ASSIGN
KZ$BSCSTT.BPSTT
     17930**DCL     18136<<ASSIGN
KZ$BSCSTT.BPSTT.COUNT
     17940**DCL     18139<<ASSIGN
KZ$BSCSTT.BPSTT.MINSIZ
     17940**DCL     18137<<ASSIGN
KZ$BSCSTT.KHSTT.INPINTISATIM
     17909**DCL     18145>>ASSIGN
KZ$BSCSTT.KHSTT.OTPINTISATIM
     17909**DCL     18145>>ASSIGN
KZ$BSCSTT.REQSTATS.DSPMSK
     17838**DCL     17844--REDEF
KZ$BSCSTT.REQSTATS.SLCMSK
     17879**DCL     17886--REDEF
KZ$EVENT
     16872**DCL     17991<<ASSIGN  18049<>CALL    18084<>CALL    18109<>CALL    18171<>CALL    18192<>CALL
     18210<>CALL    18250<>CALL
KZ$EVENT.CHN$
     16885**DCL     18048<<ASSIGN  18083<<ASSIGN  18108<<ASSIGN  18170<<ASSIGN  18191<<ASSIGN  18249<<ASSIGN
KZ$EVENT.CHNCTX$
     16876**DCL     18167<<ASSIGN
KZ$EVENT.EVENT
     16873**DCL     18045<<ASSIGN  18080<<ASSIGN  18105<<ASSIGN  18166<<ASSIGN  18188<<ASSIGN  18207<<ASSIGN
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:74   
     18246<<ASSIGN
KZ$EVENT.LINCTX$
     16879**DCL     18046<<ASSIGN  18082<<ASSIGN  18107<<ASSIGN  18169<<ASSIGN  18190<<ASSIGN  18209<<ASSIGN
     18248<<ASSIGN
KZ$EVENT.RESULT
     16907**DCL     18051>>ASSIGN  18086>>ASSIGN  18111>>ASSIGN
KZ$EVENT.TERMID$
     16882**DCL     18047<<ASSIGN  18081<<ASSIGN  18106<<ASSIGN  18168<<ASSIGN  18189<<ASSIGN  18208<<ASSIGN
     18247<<ASSIGN
KZ$EVENT_C
     16788**DCL     17991>>ASSIGN
KZ$HDR.STTBFR$
     16375**DCL     18128>>IF      18135>>ASSIGN
KZ$HDR.STTHND@
     16374**DCL     18128>>IF      18134>>ASSIGN
KZ$LINCTX.CHN$
     15941**DCL     18077>>IF      18102>>IF
KZ$LINCTX.DEVMGR@
     16301**DCL     18043>>IF      18049>>CALL
KZ$LINCTX.INPBFR$
     16244**DCL     18222>>ASSIGN
KZ$LINCTX.LINID
     15959**DCL     18225>>ASSIGN
KZ$LINCTX.LINID.TERM
     15961**DCL     15970--REDEF
KZ$LINCTX.OTPCNT
     16226**DCL     16229--REDEF
KZ$LINCTX.POLSIZ
     16272**DCL     16274--REDEF
KZC$SEARCH_FOR_ACTIVITY
     17963**DCL-ENT 18026--ASSIGN
KZM$MLCP
     15862**DCL     18010--ASSIGN  18296--ASSIGN
KZM$MLCP.CCPRLCTBLWRDX
     15868**DCL     15868--REDEF
KZM$MLCP.LCTBYT
PL6.E3A0      #001=KZA$ADMIN File=KZA$ADMIN.:E05TSI                              WED 07/30/97 02:48 Page:75   
     15869**DCL     15869--REDEF   15869--REDEF   18306>>ASSIGN
KZM$MLCP.LCTRLCTBL_BYT
     15871**DCL     15872--REDEF
KZP$CNCDSC
     17964**DCL-ENT 18084--CALL    18109--CALL    18171--CALL    18192--CALL    18210--CALL    18250--CALL
KZ_CCPLODBIS_MLC16
     17970**DCL     18006>>ASSIGN  18292>>ASSIGN
KZ_CCPLODBIS_MLC8
     17969**DCL     18008>>ASSIGN  18294>>ASSIGN
KZ_HDR$
     17967**DCL     18128>>IF      18128>>IF      18128>>IF      18134>>ASSIGN  18135>>ASSIGN
KZ_NHDR
     17966**DCL     18127>>DOINDEX
KZ_SLCENTX
     17965**DCL     18128>>IF      18128>>IF      18150>>IF
NOSTTS
     18150**LABEL   18141--CALLALT
RESET_MLCP
     18282**PROC    18023--CALL    18117--CALL
S$
     17971**DCL     18135<<ASSIGN  18136>>ASSIGN  18137>>ASSIGN  18139>>ASSIGN  18145>>ASSIGN  18145>>ASSIGN
SGNRJC_LOG
     16955**DCL     18241<>CALL
SGNRJC_LOG.BUF_
     16957**DCL     18220<<ASSIGN  18222<<ASSIGN
SGNRJC_LOG.V
     16959**DCL     16957--DCLINIT
SGNRJC_LOG.V.TERMID
     17022**DCL     18225<<ASSIGN  18228<<ASSIGN
SGNRJC_LOG.V.TERMID.TERM
     17024**DCL     17033--REDEF
SSTR
     17980**DCL     18222--ASSIGN
VDHVKT
     17972**DCL     18141<>CALL    18142>>IF      18145>>ASSIGN  18148<>CALL
