VERSION E05

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:1    
        1        1        /*M* ASC$CHARSET -- PROCS TO HANDLE CHARSETS FOR SUPER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASC$CHARSET: PROC;
       10       10        %SET LISTSUB = '1'B;
       11       11        /*****************************************************************/
       12       12        /*D*  NAME:       ASC$CHARSET
       13       13        DESCRIPTION:
       14       14        To create a charset defintion using SUPER, the command is:
       15       15        C[REATE] CHAR[SET] charsetname [ FROM charsetname2]
       16       16        'charsetname' is the name of the charset you are creating, and
       17       17        'charsetname2' is the name of an existing charset that you want to use
       18       18        to get the default setting for options.  If 'FROM charsetname2' is
       19       19        ommited, the default is 'FROM 600'.
       20       20        Charsetnames must be from 1 to 8 characters long.
       21       21        To modify an existing charset, you use the command:
       22       22        M[ODIFY] CHAR[SET] charsetname [ FROM charsetname2]
       23       23        'charsetname' and 'charsetname2' mean the same thing as in the create
       24       24        command, but if 'FROM charsetname2' is ommited, the default is
       25       25        'FROM charsetname'.
       26       26        **
       27       27        ASC$CHARSET calls internal procedures to proccess
       28       28        the options.                                                   */
       29       29        /*F*
       30       30             NAME: ASC$CHARSET
       31       31             PURPOSE:
       32       32                   To create or maintain charset records in the :FORM file.
       33       33             DESCRIPTION:
       34       34                  This routine brings SUPERto the OPT* level and allows the user to
       35       35                  modify the attributes, legal devices or chain image in any particular
       36       36                  charset record.
       37       37                  are removed when any attribute is changed.  The attribute field is
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:2    
       38       38                  set to '0'B an the bit representations for all the attributes in the
       39       39                  ATTRIBUTE command are ORed together.  The chain image is broken into
       40       40                  10 sets of 24 characters.  Each set MUST consist of exactly 24
       41       41                  characters.  Any given set can be modified without changing the other
       42       42                  9.
       43       43             REFERENCE:
       44       44                  AF0869A-0.ARCHFILE
       45       45        */
       46       46        /*
       47       47                  I n c l u d e     f i l e s
       48       48        */
       49       49        %INCLUDE AS_ENTRIES_M;
       50     1099        %INCLUDE CP_6;
       51     6658        %INCLUDE CP_6_SUBS;
       52     7198        %INCLUDE AS_SUPER_C;
       53     7633        %INCLUDE FS_SUPER_C;
       54     8396        %INCLUDE KL_SUPER_C;
       55    11298        %INCLUDE AS_SUBS_C;
       56    12712        %INCLUDE AS_MAC_C;
       57    12792        %INCLUDE AS_PERR_C;
       58    13394        %INCLUDE XU_MACRO_C;
       59    16500        %INCLUDE XU_FORMAT_C;
       60    16662        %INCLUDE AS_SUPER_R;
       61    19678        %FS$CHARSET(NAME=FS$CHARSET,
       62    19679                    STCLASS="BASED (F$)") ;
       63    19710    1   DCL X$PARSE ENTRY(1) ALTRET;
       64    19711        %ASH$ERROR ;
       65    19714        %ASH$WARN ;
       66    19717        %ASH$INFO ;
       67    19720        %ASH$HELP ;
       68    19723        %ASH$QUEST ;
       69    19726        %ASH$DQUEST ;
       70    19729        %ASF$READ_FORM ;
       71    19732        %ASF$WRITE_FORM ;
       72    19735        %ASB$READ_SI ;
       73    19738        %ASB$GETSEG ;
       74    19741        %ASB$SET_PROMPT ;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:3    
       75    19744    1   DCL CREATE BIT(1);
       76    19745    1   DCL FROM BIT(1);
       77    19746    1   DCL ARS UBIN WORD;
       78    19747    1   DCL SUBS UBIN WORD;
       79    19748    1   DCL 1 ASH_FCG CONSTANT ,
       80    19749    1          2 FCG_MID UBIN(18) INIT(5320) UNAL ;     /* 'ASH' in sixbit */
       81    19750    1   DCL 1 ERR_FCG CONSTANT ,
       82    19751    1          2 FCG_MID UBIN(18) UNAL INIT( 5315 ) ;   /* 'ASC' in sixbit */
       83    19752    1   DCL 1 CHARSET_KEY ALIGNED,
       84    19753    1          2 CNT UBIN BYTE UNAL,
       85    19754    1          2 TEXT CHAR(20) UNAL;
       86    19755        %PARSE$OUT (NAME=P$NODE, STCLASS="BASED(NODE$)",
       87    19756                    NDTYPE=TYPE, NSUBLKS=SUBNODES);
       88    19801        %PARSE$SYM (NAME=OUT$SYM, STCLASS="BASED(BLK$)");
       89    19839    1   DCL BLK$ PTR;
       90    19840    1   DCL F$ PTR;
       91    19841        /* These symrefs are the parse-nodes for X$PARSE  */
       92    19842    1   DCL CHARSET_CMD UBIN WORD SYMREF;
       93    19843    1   DCL CHARSET_OPT_LIST UBIN WORD SYMREF;
       94    19844    1   DCL CHARSET_IMAGE_LIST UBIN WORD SYMREF;
       95    19845    1   DCL CHARSET_DEVS_LIST UBIN WORD SYMREF;
       96    19846        %EJECT;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:4    
       97    19847        /* Procedure */
       98    19848        /* This routine is called from ASA$SUPER to proccess the
       99    19849           commands 'CREATE CHARSET', 'MODIFY CHARSET' and 'REMOVE CHARSET'.
      100    19850              The following code gets date segments in order to
      101    19851              build the variable length record
      102    19852        */
      103    19853                                                        /* Get data segs */
      104    19854    2   IF NOT DSEG_FLG THEN DO;
      105    19855    2      CALL ASB$GETSEG
      106    19856    3      WHENALTRETURN DO;
      107    19857              %SCREAM( ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='C');
      108    19872    3         RETURN ;
      109    19873    3         END;
      110    19874    2      END ;
      111    19875    1   F$ = DSEG1$;
      112    19876    1   P_PCB.ROOT$ = ADDR(CHARSET_CMD);
      113    19877    1   CALL X$PARSE(P_PCB)
      114    19878    2   WHENALTRETURN DO;
      115    19879    2      CALL ASH$ERROR (P_PCB.ERROR);
      116    19880    2      RETURN;
      117    19881    2      END;
      118    19882    1   NODE$ = P_PCB.OUT$;
      119    19883    1   IF P$NODE.CODE = 81 /*CR_CHARSET_VAL*/
      120    19884    2   THEN DO;
      121    19885    2      CREATE = AS_TRUE;   /* Create a charset */
      122    19886    2      END;
      123    19887    2   ELSE DO;
      124    19888    2      CREATE = AS_FALSE;  /* Modify an existing charset */
      125    19889    2      END;
      126    19890    1   BLK$ = P$NODE.SUBLK$(0)-> P$NODE.SUBLK$(0);
      127    19891    1   CHARSET_KEY.TEXT = '                    ';
      128    19892    1   FROM_KEY = CHARSET_KEY;
      129    19893    1   CALL CONCAT (CHARSET_KEY.TEXT,'~',OUT$SYM.TEXT,'CHARSET');
      130    19894    1   CHARSET_KEY.CNT = 8 + OUT$SYM.COUNT;
      131    19895    1   IF OUT$SYM.COUNT > 8
      132    19896    2   THEN DO;
      133    19897        /*E* ERROR: ASC-E$CHARNAMETOOBIG-0
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:5    
      134    19898             MESSAGE: %U1 is too long for a CHARSET name.
      135    19899             MESSAGE1: CHARSET names can be at most 8 characters long.
      136    19900        */
      137    19901    2      AS_FIELD1.COUNT = OUT$SYM.COUNT ;
      138    19902    2      AS_FIELD1.TEXT = OUT$SYM.TEXT;
      139    19903           %SCREAM (ERR#=E$CHARNAMETOOBIG,MID='C',LEVEL=ERROR);
      140    19918    2      RETURN;
      141    19919    2      END;
      142    19920    1   ARS = SIZEC (FS$CHARSET) ;
      143    19921    1   CALL ASF$READ_FORM (CHARSET_KEY, F$, ARS)
      144    19922    2   WHENRETURN DO;
      145    19923    2      IF CREATE
      146    19924    3      THEN DO;
      147    19925        /*E* ERROR: ASC-E$CHAREXISTS-C
      148    19926             MESSAGE: CHARSET %U1 already exists.
      149    19927             MESSAGE1: You can't create a CHARSET that already exists */
      150    19928    3         AS_FIELD1.COUNT = OUT$SYM.COUNT ;
      151    19929    3         AS_FIELD1.TEXT = OUT$SYM.TEXT;
      152    19930              %SCREAM( ERR#=E$CHAREXISTS,MID='C',LEVEL=ERROR);
      153    19945    3         RETURN;
      154    19946    3         END;
      155    19947    2      END;
      156    19948    2   WHENALTRETURN DO;
      157    19949    2      IF ~CREATE
      158    19950    3      THEN DO;
      159    19951        /*E* ERROR: ASF-E$CHARSWITCH-0
      160    19952             MESSAGE: %%U1 %does not exist. Switching to CREATE mode.
      161    19953        */
      162    19954    3         AS_FIELD1.COUNT = OUT$SYM.COUNT ;
      163    19955    3         AS_FIELD1.TEXT = OUT$SYM.TEXT;
      164    19956              %SCREAM( ERR#= E$CHARSWITCH,MID='F',LEVEL=INFO );
      165    19971    3         CREATE=AS_TRUE;
      166    19972    3         END;
      167    19973    2      SUBS = P$NODE.SUBNODES;
      168    19974    2      FROM = AS_FALSE;   /* Start processing from field */
      169    19975    2      IF CREATE
      170    19976    3      THEN DO;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:6    
      171    19977    3         IF P$NODE.SUBLK$(1)->P$NODE.CODE = 84 /*CHARSET_NAME_2_VAL*/
      172    19978    4         THEN DO;
      173    19979    4            BLK$ = P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0);
      174    19980    4            CALL CONCAT(FROM_KEY.TEXT,'~',OUT$SYM.TEXT,'CHARSET');
      175    19981    4            FROM_KEY.CNT = 8 + OUT$SYM.COUNT;
      176    19982    4            FROM = AS_TRUE;
      177    19983    4            IF OUT$SYM.COUNT > 8
      178    19984    5            THEN DO;
      179    19985    5               AS_FIELD1.COUNT = OUT$SYM.COUNT ;
      180    19986    5               AS_FIELD1.TEXT = OUT$SYM.TEXT;
      181    19987                    %SCREAM( ERR#=E$CHARNAMETOOBIG,MID='C',LEVEL=ERROR);
      182    20002    5               RETURN;
      183    20003    5               END;
      184    20004    4            END;
      185    20005    4         ELSE DO;
      186    20006    4            FROM_KEY.CNT = 11;
      187    20007    4            FROM_KEY.TEXT = '~600CHARSET';
      188    20008    4            END;
      189    20009    3         CALL ASF$READ_FORM( FROM_KEY, F$, ARS)
      190    20010    4         WHENALTRETURN DO;
      191    20011        /*E* ERROR: ASC-E$CANTREADCHARSET-C
      192    20012             MESSAGE: Unable to read CHARSET %U1 from :FORM file.
      193    20013             MESSAGE1: The FROM (default 600) charset record is unreadable.
      194    20014        */
      195    20015    4            AS_FIELD1.COUNT = FROM_KEY.CNT ;
      196    20016    4            AS_FIELD1.TEXT = FROM_KEY.TEXT;
      197    20017                 %SCREAM( ERR#=E$CANTREADCHARSET, LEVEL=ERROR, MID='C' );
      198    20032    4            RETURN;
      199    20033    4            END;
      200    20034    3         END;
      201    20035    2      END;
      202    20036    1   CALL CHARSET_OPTS; /* Get all of the options and update FS$CHARSET*/
      203    20037
      204    20038    1   ARS = SIZEC (FS$CHARSET);
      205    20039    1   CALL ASF$WRITE_FORM (CHARSET_KEY,F$,ARS);
      206    20040    1   RETURN;
      207    20041        %EJECT;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:7    
      208    20042        /*F*
      209    20043             NAME: CHARSET_OPTS
      210    20044             PURPOSE:
      211    20045                  To process all the options when altering charset records.
      212    20046             DESCRIPTION:
      213    20047                  This routine reads input, parses it, and performs the apporpriate
      214    20048                  action.  It will either handle the attributes, devices, or call
      215    20049                  the IMAGE routine to modify the chain image.
      216    20050        */
      217    20051        /*D*
      218    20052             NAME: CHARSET_OPTS
      219    20053             ENTRY:
      220    20054                  CALL CHARSET_OPTS
      221    20055             CALL:
      222    20056                  Only called from and within the ASC$CHARSET routine.
      223    20057             ENVIRONMENT:
      224    20058                  SUPER
      225    20059             DESCRIPTION:
      226    20060                  When an attribute command is given, the attribute field is zeroed out
      227    20061                  and all the new attributes are ORed together.  Devices are handled
      228    20062                  differently.  The device command will set a flag for each device type
      229    20063                  given, allowable are 'LP', 'TS', '?', 'xx' where xx is any two
      230    20064                  character device type.  This type is not checked for legality, that
      231    20065                  is done elsewhere after that type is placed into the form record.
      232    20066        */
      233    20067    1   CHARSET_OPTS: PROC;
      234    20068
      235    20069    2   DCL J UBIN WORD;
      236    20070    2   DCL PTR$ PTR;
      237    20071    2   DCL SUBNODES UBIN WORD;
      238    20072    2   DCL WARN BIT(1);
      239    20073    2   DCL FOUND UBIN;
      240    20074
      241    20075    3   DO WHILE ( AS_TRUE );
      242    20076    3   RETRY: ;
      243    20077    3      CALL ASB$SET_PROMPT ( %PROMPT_OPT );
      244    20078    3      CALL ASB$READ_SI( IN_BUF, ARS);
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:8    
      245    20079    3      P_PCB.NCHARS = ARS;
      246    20080    3      P_PCB.ROOT$ = ADDR (CHARSET_OPT_LIST);
      247    20081    3      CALL X$PARSE(P_PCB)
      248    20082    4      WHENALTRETURN DO;
      249    20083    4         CALL ASH$ERROR (P_PCB.ERROR);
      250    20084    4         GOTO RETRY;
      251    20085    4         END;
      252    20086    3      NODE$ = P_PCB.OUT$;
      253    20087    3      SUBNODES = P$NODE.SUBNODES;
      254    20088    3      CODE = P$NODE.CODE;
      255    20089    4      DO SELECT (CODE);
      256    20090    4         SELECT( 302 /* HELP_VAL */ );
      257    20091    4         CALL ASH$HELP;
      258    20092    4         SELECT( 301 /* QUESTION_VAL */ );
      259    20093    4         CALL ASH$QUEST;
      260    20094    4         SELECT( 300 /* DQUESTION_VAL */ );
      261    20095    4         CALL ASH$DQUEST;
      262    20096    4         SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */);
      263    20097    4         RETURN;
      264    20098    4         SELECT( 96 /* C_IMAGE_VAL */ );
      265    20099    4         CALL IMAGE;
      266    20100    4         SELECT ( 95 /* C_DEVS_VAL */);
      267    20101    4         CALL DEVICES;
      268    20102    4         SELECT( 90 /* C_ATTRS_VAL */ );
      269    20103
      270    20104    4         WARN = AS_FALSE;
      271    20105    4         FOUND = 0;
      272    20106    4         FS$CHARSET.ATTRS = AS_FALSE;
      273    20107    5         DO J = 0 TO SUBNODES - 1;
      274    20108    5            PTR$ = P$NODE.SUBLK$(J);
      275    20109    5            CODE = PTR$-> P$NODE.CODE;
      276    20110    6            DO SELECT (CODE);
      277    20111    6               SELECT(110 /* C_ATTR_OVER */);
      278    20112
      279    20113    6               FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_TRUOVRPRT#;
      280    20114
      281    20115    6               SELECT (111 /* C_ATTR_APL */);
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:9    
      282    20116
      283    20117    6               IF FOUND = 0 THEN
      284    20118    7               DO;
      285    20119    7                  FOUND = CODE;
      286    20120    7                  FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_APL#;
      287    20121    7                  AS_FIELD1.TEXT = 'APL';
      288    20122    7                  AS_FIELD1.COUNT = 3;
      289    20123    7                  END; /*  Not found yet  */
      290    20124    7               ELSE DO;
      291    20125    7                  WARN = AS_TRUE;
      292    20126    7                  AS_FIELD2.TEXT = 'APL';
      293    20127    7                  AS_FIELD2.COUNT = 3;
      294    20128    7                  END;
      295    20129
      296    20130    6               SELECT (112 /* C_ATTR_BIN */);
      297    20131
      298    20132    6               FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_BIN#;
      299    20133
      300    20134    6               SELECT(114 /* C_ATTR_LOWERCASE */);
      301    20135
      302    20136    6               IF FOUND = 0 OR FOUND = 115 /* C_ATTR_UPPERCASE */ THEN
      303    20137    7               DO;
      304    20138    7                  FOUND = CODE;
      305    20139    7                  FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_LOWERCASE#;
      306    20140    7                  AS_FIELD1.TEXT = 'LOWERCASE';
      307    20141    7                  AS_FIELD1.COUNT = 9;
      308    20142    7                  END; /*  Not found yet  */
      309    20143    7               ELSE DO;
      310    20144    7                  WARN = AS_TRUE;
      311    20145    7                  AS_FIELD2.TEXT = 'LOWERCASE';
      312    20146    7                  AS_FIELD2.COUNT = 9;
      313    20147    7                  END;
      314    20148
      315    20149    6               SELECT(113 /* C_ATTR_NATL */);
      316    20150
      317    20151    6               IF FOUND = 0 THEN
      318    20152    7               DO;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:10   
      319    20153    7                  FOUND = CODE;
      320    20154    7                  FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_NATL#;
      321    20155    7                  AS_FIELD1.TEXT = 'NATL';
      322    20156    7                  AS_FIELD1.COUNT = 4;
      323    20157    7                  END; /*  Not found yet  */
      324    20158    7               ELSE DO;
      325    20159    7                  WARN = AS_TRUE;
      326    20160    7                  AS_FIELD2.TEXT = 'NATL';
      327    20161    7                  AS_FIELD2.COUNT = 4;
      328    20162    7                  END;
      329    20163
      330    20164    6               SELECT(115 /* C_ATTR_UPPERCASE */);
      331    20165
      332    20166    6               IF FOUND = 0 OR FOUND = 114 /* C_ATTR_LOWERCASE */ THEN
      333    20167    7               DO;
      334    20168    7                  FOUND = CODE;
      335    20169    7                  FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_UPPERCASE#;
      336    20170    7                  AS_FIELD1.TEXT = 'UPPERCASE';
      337    20171    7                  AS_FIELD1.COUNT = 9;
      338    20172    7                  END; /*  Not found yet  */
      339    20173    7               ELSE DO;
      340    20174    7                  WARN = AS_TRUE;
      341    20175    7                  AS_FIELD2.TEXT = 'UPPERCASE';
      342    20176    7                  AS_FIELD2.COUNT = 9;
      343    20177    7                  END;
      344    20178
      345    20179    6               SELECT(116 /* C_ATTR_NOXLATE */);
      346    20180
      347    20181    6               IF FOUND = 0 THEN
      348    20182    7               DO;
      349    20183    7                  FOUND = CODE;
      350    20184    7                  FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_NOXLATE#;
      351    20185    7                  AS_FIELD1.TEXT = 'NOXLATE';
      352    20186    7                  AS_FIELD1.COUNT = 7;
      353    20187    7                  END; /*  Not found yet  */
      354    20188    7               ELSE DO;
      355    20189    7                  WARN = AS_TRUE;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:11   
      356    20190    7                  AS_FIELD2.TEXT = 'NOXLATE';
      357    20191    7                  AS_FIELD2.COUNT = 7;
      358    20192    7                  END;
      359    20193
      360    20194    6               SELECT (126 /* C_ATTR_TRANSLGL */);
      361    20195
      362    20196    6               FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_TRANSLGL#;
      363    20197
      364    20198    6               SELECT( ELSE );
      365    20199                        /* Don't know what to do here, so do nothing! */
      366    20200    6               END; /* Do case */
      367    20201
      368    20202    5         IF WARN THEN
      369    20203        /*E*  ERROR:   ASC-E$TOO_MANY_TRANSTABLES-0
      370    20204              MESSAGE0: %U1 and %U2 have a precedence order.
      371    20205                        Only one of them will be used.
      372    20206              MESSAGE1: You have specified conflicting translation tables
      373    20207                        on this option,  %U1 and %U2.
      374    20208              MESSAGE2: Translation table precedence is NOXL,NATL,APL,(UP&LO),UP,LO.
      375    20209        */
      376    20210                 %SCREAM (ERR#=E$TOO_MANY_TRANSTABLES,LEVEL=WARN,MID='C');
      377    20225
      378    20226    5            END; /* Do j */
      379    20227    4         END; /* Do case */
      380    20228    3      END; /* Do while */
      381    20229    2   END CHARSET_OPTS;
      382    20230        %EJECT;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:12   
      383    20231        /*F*
      384    20232             NAME: IMAGE
      385    20233             PURPOSE:
      386    20234                  Handle the image response inside CHARSET_OPTS.
      387    20235             DESCRIPTION:
      388    20236                  Brings SUPER to the SUB* level and allow the chain image to be
      389    20237                  modified by setting in arbitrary order the chain image through
      390    20238                  specification of 24 character parts.  Exactly 24 characters must be
      391    20239                  given.
      392    20240        */
      393    20241    1   IMAGE: PROC;
      394    20242
      395    20243
      396    20244    2   DCL PTR$ PTR;
      397    20245    2   DCL SETNUM UBIN;
      398    20246
      399    20247    2   CALL ASB$SET_PROMPT ( %PROMPT_SUB );
      400    20248    2   P_PCB.ROOT$ = ADDR (CHARSET_IMAGE_LIST);
      401    20249    3   DO WHILE ( '1'B );
      402    20250    3   RETRY: ;
      403    20251    3      CALL ASB$READ_SI( IN_BUF, ARS);
      404    20252    3      P_PCB.NCHARS = ARS;
      405    20253    3      CALL X$PARSE(P_PCB)
      406    20254    4      WHENALTRETURN DO;
      407    20255    4         CALL ASH$ERROR (P_PCB.ERROR);
      408    20256    4         GOTO RETRY;
      409    20257    4         END;
      410    20258    3      NODE$ = P_PCB.OUT$;
      411    20259    3      CODE = P$NODE.CODE;
      412    20260    4      DO SELECT (CODE);
      413    20261    4         SELECT( 302 /* HELP_VAL */ );
      414    20262    4         CALL ASH$HELP;
      415    20263    4         SELECT( 301 /* QUESTION_VAL */ );
      416    20264    4         CALL ASH$QUEST;
      417    20265    4         SELECT( 300 /* DQUESTION_VAL */ );
      418    20266    4         CALL ASH$DQUEST;
      419    20267    4         SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */);
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:13   
      420    20268    4         RETURN;
      421    20269    4         SELECT( 85 /* C_SET_VAL */ );
      422    20270    4         PTR$ = P$NODE.SUBLK$(0);
      423    20271    4         CALL CHARBIN (SETNUM, PTR$->OUT$SYM.TEXT);
      424    20272    4         PTR$ = P$NODE.SUBLK$(1);
      425    20273    4         IF PTR$->P$NODE.SUBLK$(0)->OUT$SYM.COUNT ~= 24
      426    20274    5         THEN DO;
      427    20275            /*E* ERROR: ASF-E$BADSETLENGTH-0
      428    20276                 MESSAGE: Bad length for a character set, it's not 24 characters.
      429    20277                 MESSAGE1: Each character set must be exactly 24 characters.
      430    20278            */
      431    20279        %SET LISTMAC='1'B;
      432    20280                 %SCREAM( ERR#=E$BADSETLENGTH,LEVEL=ERROR,MID='F');
             20281        %LSET LISTDIR='0'B;
             20292    5         CALL ASH$ERROR( %(ERR_CODE) );
      433    20295        %SET LISTMAC='0'B;
      434    20296    5            END;
      435    20297    5         ELSE DO;
      436    20298    5            FS$CHARSET.SETS (SETNUM) = PTR$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT;
      437    20299    5            END;
      438    20300    4         END; /* Do case */
      439    20301    3      END; /* Do while */
      440    20302    2   END IMAGE;
      441    20303        %EJECT;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:14   
      442    20304        /*F*
      443    20305             NAME: DEVICES
      444    20306             PURPOSE:
      445    20307                  Handle the DEVICES response inside CHARSET_OPTS.
      446    20308             DESCRIPTION:
      447    20309                  Brings SUPER to the SUB* level and allow the devices to be
      448    20310                  modified by either setting them to YES or NO.
      449    20311                  YES is the default if a device is specified with no other
      450    20312                  field.
      451    20313        */
      452    20314    1   DEVICES: PROC;
      453    20315
      454    20316
      455    20317    2   DCL YES_NO BIT (1);
      456    20318    2   DCL SUBNODES UBIN;
      457    20319    2   DCL J UBIN;
      458    20320    2   DCL PTR$ PTR;
      459    20321
      460    20322    2   CALL ASB$SET_PROMPT ( %PROMPT_SUB );
      461    20323    2   P_PCB.ROOT$ = ADDR (CHARSET_DEVS_LIST);
      462    20324    3   DO WHILE ( '1'B );
      463    20325    3   RETRY: ;
      464    20326    3      CALL ASB$READ_SI( IN_BUF, ARS);
      465    20327    3      P_PCB.NCHARS = ARS;
      466    20328    3      CALL X$PARSE(P_PCB)
      467    20329    4      WHENALTRETURN DO;
      468    20330    4         CALL ASH$ERROR (P_PCB.ERROR);
      469    20331    4         GOTO RETRY;
      470    20332    4         END;
      471    20333    3      NODE$ = P_PCB.OUT$;
      472    20334    3      SUBNODES = P$NODE.SUBNODES;
      473    20335    3      IF SUBNODES = 0
      474    20336    4      THEN DO;
      475    20337    4         RETURN;
      476    20338    4         END;
      477    20339    4      DO J = 0 TO SUBNODES-1;
      478    20340    4         PTR$ = P$NODE.SUBLK$ (J);
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:15   
      479    20341    4         CODE = PTR$->P$NODE.CODE;
      480    20342    4         IF ((CODE = 98 /* C_DEV_LP */) OR
      481    20343    4              (CODE = 99 /* C_DEV_TS */) OR
      482    20344    4              (CODE = 100 /* C_DEV_ELS */))
      483    20345    5         THEN DO;
      484    20346    5            IF PTR$->P$NODE.SUBNODES = 0
      485    20347    6            THEN DO;
      486    20348    6               YES_NO = '1'B;
      487    20349    6               END;
      488    20350    6            ELSE DO;
      489    20351    6               IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE = 1   /*  YES_VAL  */
      490    20352    7               THEN DO;
      491    20353    7                  YES_NO = '1'B;
      492    20354    7                  END;
      493    20355    7               ELSE DO;
      494    20356    7                  YES_NO = '0'B;
      495    20357    7                  END;
      496    20358    6               END;
      497    20359    5            END;
      498    20360    5         DO SELECT (CODE);
      499    20361    5            SELECT( 302 /* HELP_VAL */ );
      500    20362    5            CALL ASH$HELP;
      501    20363    5            SELECT( 301 /* QUESTION_VAL */ );
      502    20364    5            CALL ASH$QUEST;
      503    20365    5            SELECT( 300 /* DQUESTION_VAL */ );
      504    20366    5            CALL ASH$DQUEST;
      505    20367    5            SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */);
      506    20368    5            RETURN;
      507    20369    5            SELECT(98 /* C_DEV_LP */);
      508    20370    5            FS$CHARSET.LGLTYPS.LPOK = YES_NO;
      509    20371    5            SELECT (99 /* C_DEV_TS */);
      510    20372    5            FS$CHARSET.LGLTYPS.TSOK = YES_NO;
      511    20373    5            SELECT (100 /* C_DEV_ELS */);
      512    20374    5            FS$CHARSET.LGLTYPS.ELSOK = YES_NO;
      513    20375    5            SELECT (101 /* C_DEV_LTYP */);
      514    20376    5            IF PTR$->P$NODE.SUBNODES = 0
      515    20377    6            THEN DO;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:16   
      516    20378    6               FS$CHARSET.LGLTYPS.LTYP = '  ';
      517    20379    6               FS$CHARSET.LGLTYPS.ONEOK = '0'B;
      518    20380    6               END;
      519    20381    6            ELSE DO;
      520    20382    6               IF SUBSTR(PTR$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT,0,2) = 'NO'
      521    20383    7               THEN DO;
      522    20384    7                  FS$CHARSET.LGLTYPS.LTYP = '  ';
      523    20385    7                  FS$CHARSET.LGLTYPS.ONEOK = '0'B;
      524    20386    7                  END;
      525    20387    7               ELSE DO;
      526    20388    7                  FS$CHARSET.LGLTYPS.LTYP =
      527    20389    7                       PTR$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT;
      528    20390    7                  FS$CHARSET.LGLTYPS.ONEOK = '1'B;
      529    20391    7                  END;
      530    20392    6               END;
      531    20393    5            END; /* Do case */
      532    20394    4         END; /* Do j */
      533    20395    3      END; /* Do while */
      534    20396    2   END DEVICES;
      535    20397    1   END ASC$CHARSET;

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:17   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
      No diagnostics issued in procedure ASC$CHARSET.

   Procedure ASC$CHARSET requires 778 words for executable code.
   Procedure ASC$CHARSET requires 32 words of local(AUTO) storage.

    No errors detected in file ASC$CHARSET.:E05TSI    .

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:18   

 Object Unit name= ASC$CHARSET                                File name= ASC$CHARSET.:E05TOU
 UTS= JUL 29 '97 09:31:27.36 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2  RoData even  UTS     29     35  ASC$CHARSET
    3   Proc  even  none   778   1412  ASC$CHARSET
    4  RoData even  none    18     22  ASC$CHARSET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  ASC$CHARSET
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:19   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       3 ASF$READ_FORM
 yes     yes           Std       3 ASF$WRITE_FORM
 yes     yes           Std       0 ASB$GETSEG
         yes           Std       2 ASH$ERROR
         yes           Std       2 ASH$INFO
 yes     yes           Std       1 X$PARSE
 yes     yes           Std       3 ASB$SET_PROMPT
         yes           Std       2 ASB$READ_SI
         yes           Std       0 ASH$HELP
         yes           Std       0 ASH$QUEST
         yes           Std       0 ASH$DQUEST
         yes           Std       2 ASH$WARN
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_TRUE                          r    AS_FALSE
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     FROM_KEY                              IN_BUF                                NODE$
     CODE                                  ERR_CODE                              AS_FIELD1
     AS_FIELD2                             REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          DSEG_FLG                              DSEG1$
     P_PCB                                 CHARSET_CMD                           CHARSET_OPT_LIST
     CHARSET_IMAGE_LIST                    CHARSET_DEVS_LIST                     B_VECTNIL
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:20   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:21   


        1        1        /*M* ASC$CHARSET -- PROCS TO HANDLE CHARSETS FOR SUPER */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASC$CHARSET: PROC;

      9  3 000000   000000 700200 xent  ASC$CHARSET  TSX0  ! X66_AUTO_0
         3 000001   000040 000000                    ZERO    32,0

       10       10        %SET LISTSUB = '1'B;
       11       11        /*****************************************************************/
       12       12        /*D*  NAME:       ASC$CHARSET
       13       13        DESCRIPTION:
       14       14        To create a charset defintion using SUPER, the command is:
       15       15        C[REATE] CHAR[SET] charsetname [ FROM charsetname2]
       16       16        'charsetname' is the name of the charset you are creating, and
       17       17        'charsetname2' is the name of an existing charset that you want to use
       18       18        to get the default setting for options.  If 'FROM charsetname2' is
       19       19        ommited, the default is 'FROM 600'.
       20       20        Charsetnames must be from 1 to 8 characters long.
       21       21        To modify an existing charset, you use the command:
       22       22        M[ODIFY] CHAR[SET] charsetname [ FROM charsetname2]
       23       23        'charsetname' and 'charsetname2' mean the same thing as in the create
       24       24        command, but if 'FROM charsetname2' is ommited, the default is
       25       25        'FROM charsetname'.
       26       26        **
       27       27        ASC$CHARSET calls internal procedures to proccess
       28       28        the options.                                                   */
       29       29        /*F*
       30       30             NAME: ASC$CHARSET
       31       31             PURPOSE:
       32       32                   To create or maintain charset records in the :FORM file.
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:22   
       33       33             DESCRIPTION:
       34       34                  This routine brings SUPERto the OPT* level and allows the user to
       35       35                  modify the attributes, legal devices or chain image in any particular
       36       36                  charset record.
       37       37                  are removed when any attribute is changed.  The attribute field is
       38       38                  set to '0'B an the bit representations for all the attributes in the
       39       39                  ATTRIBUTE command are ORed together.  The chain image is broken into
       40       40                  10 sets of 24 characters.  Each set MUST consist of exactly 24
       41       41                  characters.  Any given set can be modified without changing the other
       42       42                  9.
       43       43             REFERENCE:
       44       44                  AF0869A-0.ARCHFILE
       45       45        */
       46       46        /*
       47       47                  I n c l u d e     f i l e s
       48       48        */
       49       49        %INCLUDE AS_ENTRIES_M;
       50     1099        %INCLUDE CP_6;
       51     6658        %INCLUDE CP_6_SUBS;
       52     7198        %INCLUDE AS_SUPER_C;
       53     7633        %INCLUDE FS_SUPER_C;
       54     8396        %INCLUDE KL_SUPER_C;
       55    11298        %INCLUDE AS_SUBS_C;
       56    12712        %INCLUDE AS_MAC_C;
       57    12792        %INCLUDE AS_PERR_C;
       58    13394        %INCLUDE XU_MACRO_C;
       59    16500        %INCLUDE XU_FORMAT_C;
       60    16662        %INCLUDE AS_SUPER_R;
       61    19678        %FS$CHARSET(NAME=FS$CHARSET,
       62    19679                    STCLASS="BASED (F$)") ;
       63    19710    1   DCL X$PARSE ENTRY(1) ALTRET;
       64    19711        %ASH$ERROR ;
       65    19714        %ASH$WARN ;
       66    19717        %ASH$INFO ;
       67    19720        %ASH$HELP ;
       68    19723        %ASH$QUEST ;
       69    19726        %ASH$DQUEST ;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:23   
       70    19729        %ASF$READ_FORM ;
       71    19732        %ASF$WRITE_FORM ;
       72    19735        %ASB$READ_SI ;
       73    19738        %ASB$GETSEG ;
       74    19741        %ASB$SET_PROMPT ;
       75    19744    1   DCL CREATE BIT(1);
       76    19745    1   DCL FROM BIT(1);
       77    19746    1   DCL ARS UBIN WORD;
       78    19747    1   DCL SUBS UBIN WORD;
       79    19748    1   DCL 1 ASH_FCG CONSTANT ,
       80    19749    1          2 FCG_MID UBIN(18) INIT(5320) UNAL ;     /* 'ASH' in sixbit */
       81    19750    1   DCL 1 ERR_FCG CONSTANT ,
       82    19751    1          2 FCG_MID UBIN(18) UNAL INIT( 5315 ) ;   /* 'ASC' in sixbit */
       83    19752    1   DCL 1 CHARSET_KEY ALIGNED,
       84    19753    1          2 CNT UBIN BYTE UNAL,
       85    19754    1          2 TEXT CHAR(20) UNAL;
       86    19755        %PARSE$OUT (NAME=P$NODE, STCLASS="BASED(NODE$)",
       87    19756                    NDTYPE=TYPE, NSUBLKS=SUBNODES);
       88    19801        %PARSE$SYM (NAME=OUT$SYM, STCLASS="BASED(BLK$)");
       89    19839    1   DCL BLK$ PTR;
       90    19840    1   DCL F$ PTR;
       91    19841        /* These symrefs are the parse-nodes for X$PARSE  */
       92    19842    1   DCL CHARSET_CMD UBIN WORD SYMREF;
       93    19843    1   DCL CHARSET_OPT_LIST UBIN WORD SYMREF;
       94    19844    1   DCL CHARSET_IMAGE_LIST UBIN WORD SYMREF;
       95    19845    1   DCL CHARSET_DEVS_LIST UBIN WORD SYMREF;
       96    19846        %EJECT;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:24   
       97    19847        /* Procedure */
       98    19848        /* This routine is called from ASA$SUPER to proccess the
       99    19849           commands 'CREATE CHARSET', 'MODIFY CHARSET' and 'REMOVE CHARSET'.
      100    19850              The following code gets date segments in order to
      101    19851              build the variable length record
      102    19852        */
      103    19853                                                        /* Get data segs */
      104    19854    2   IF NOT DSEG_FLG THEN DO;

  19854  3 000002   000000 234000 xsym               SZN     DSEG_FLG
         3 000003   000015 604000 3                  TMI     s:19875

      105    19855    2      CALL ASB$GETSEG

  19855  3 000004   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000005   000000 701000 xent               TSX1    ASB$GETSEG
         3 000006   000010 702000 3                  TSX2    s:19869
         3 000007   000015 710000 3                  TRA     s:19875

      106    19856    3      WHENALTRETURN DO;

      107    19857              %SCREAM( ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='C');

  19869  3 000010   000000 630400 4                  EPPR0   0
         3 000011   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000012   000000 701000 xent               TSX1    ASH$ERROR
         3 000013   000000 011000                    NOP     0

      108    19872    3         RETURN ;

  19872  3 000014   000000 702200 xent               TSX2  ! X66_ARET

      109    19873    3         END;
      110    19874    2      END ;

      111    19875    1   F$ = DSEG1$;

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:25   
  19875  3 000015   000000 236000 xsym               LDQ     DSEG1$
         3 000016   200016 756100                    STQ     F$,,AUTO

      112    19876    1   P_PCB.ROOT$ = ADDR(CHARSET_CMD);

  19876  3 000017   000001 236000 4                  LDQ     1
         3 000020   000001 756000 xsym               STQ     P_PCB+1

      113    19877    1   CALL X$PARSE(P_PCB)

  19877  3 000021   000002 630400 4                  EPPR0   2
         3 000022   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000023   000000 701000 xent               TSX1    X$PARSE
         3 000024   000026 702000 3                  TSX2    s:19879
         3 000025   000033 710000 3                  TRA     s:19882

      114    19878    2   WHENALTRETURN DO;

      115    19879    2      CALL ASH$ERROR (P_PCB.ERROR);

  19879  3 000026   000003 630400 4                  EPPR0   3
         3 000027   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000030   000000 701000 xent               TSX1    ASH$ERROR
         3 000031   000000 011000                    NOP     0

      116    19880    2      RETURN;

  19880  3 000032   000000 702200 xent               TSX2  ! X66_ARET

      117    19881    2      END;
      118    19882    1   NODE$ = P_PCB.OUT$;

  19882  3 000033   000003 236000 xsym               LDQ     P_PCB+3
         3 000034   000000 756000 xsym               STQ     NODE$

      119    19883    1   IF P$NODE.CODE = 81 /*CR_CHARSET_VAL*/

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:26   
  19883  3 000035   000000 470400 xsym               LDP0    NODE$
         3 000036   000000 720100                    LXL0    0,,PR0
         3 000037   000121 100003                    CMPX0   81,DU
         3 000040   000045 601000 3                  TNZ     s:19888

      120    19884    2   THEN DO;

      121    19885    2      CREATE = AS_TRUE;   /* Create a charset */

  19885  3 000041   000000 236000 xsym               LDQ     AS_TRUE
         3 000042   400000 376003                    ANQ     -131072,DU
         3 000043   200003 756100                    STQ     CREATE,,AUTO

      122    19886    2      END;

  19886  3 000044   000050 710000 3                  TRA     s:19890

      123    19887    2   ELSE DO;

      124    19888    2      CREATE = AS_FALSE;  /* Modify an existing charset */

  19888  3 000045   000000 236000 xsym               LDQ     AS_FALSE
         3 000046   400000 376003                    ANQ     -131072,DU
         3 000047   200003 756100                    STQ     CREATE,,AUTO

      125    19889    2      END;

      126    19890    1   BLK$ = P$NODE.SUBLK$(0)-> P$NODE.SUBLK$(0);

  19890  3 000050   000003 471500                    LDP1    3,,PR0
         3 000051   100003 236100                    LDQ     3,,PR1
         3 000052   200015 756100                    STQ     BLK$,,AUTO

      127    19891    1   CHARSET_KEY.TEXT = '                    ';

  19891  3 000053   040100 100400                    MLR     fill='040'O
         3 000054   000003 000024 2                  ADSC9   3                        cn=0,n=20
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:27   
         3 000055   200007 200024                    ADSC9   CHARSET_KEY,,AUTO        cn=1,n=20

      128    19892    1   FROM_KEY = CHARSET_KEY;

  19892  3 000056   000000 100500                    MLR     fill='000'O
         3 000057   200007 000025                    ADSC9   CHARSET_KEY,,AUTO        cn=0,n=21
         3 000060   000000 000025 xsym               ADSC9   FROM_KEY                 cn=0,n=21

      129    19893    1   CALL CONCAT (CHARSET_KEY.TEXT,'~',OUT$SYM.TEXT,'CHARSET');

  19893  3 000061   200015 471500                    LDP1    BLK$,,AUTO
         3 000062   100004 236100                    LDQ     4,,PR1
         3 000063   000033 772000                    QRL     27
         3 000064   000000 620006                    EAX0    0,QL
         3 000065   000176 236003                    LDQ     126,DU
         3 000066   200007 552120                    STBQ    CHARSET_KEY,'20'O,AUTO
         3 000067   040100 100540                    MLR     fill='040'O
         3 000070   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         3 000071   200007 400023                    ADSC9   CHARSET_KEY,,AUTO        cn=2,n=19
         3 000072   000000 636010                    EAQ     0,X0
         3 000073   000022 772000                    QRL     18
         3 000074   000023 116007                    CMPQ    19,DL
         3 000075   000106 603000 3                  TRC     s:19894
         3 000076   200034 740100                    STX0    PTR$+2,,AUTO
         3 000077   777754 620010                    EAX0    -20,X0
         3 000100   777777 660003                    ERX0    -1,DU
         3 000101   200034 235100                    LDA     PTR$+2,,AUTO
         3 000102   000022 771000                    ARL     18
         3 000103   040145 100400                    MLR     fill='040'O
         3 000104   000010 000007 2                  ADSC9   8                        cn=0,n=7
         3 000105   200007 400010                    ADSC9   CHARSET_KEY,A,AUTO       cn=2,n=*X0

      130    19894    1   CHARSET_KEY.CNT = 8 + OUT$SYM.COUNT;

  19894  3 000106   100004 236100                    LDQ     4,,PR1
         3 000107   000033 772000                    QRL     27
         3 000110   000010 036007                    ADLQ    8,DL
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:28   
         3 000111   000033 736000                    QLS     27
         3 000112   200007 552140                    STBQ    CHARSET_KEY,'40'O,AUTO

      131    19895    1   IF OUT$SYM.COUNT > 8

  19895  3 000113   100004 236100                    LDQ     4,,PR1
         3 000114   777000 376003                    ANQ     -512,DU
         3 000115   011000 116003                    CMPQ    4608,DU
         3 000116   000134 602000 3                  TNC     s:19920

      132    19896    2   THEN DO;

      133    19897        /*E* ERROR: ASC-E$CHARNAMETOOBIG-0
      134    19898             MESSAGE: %U1 is too long for a CHARSET name.
      135    19899             MESSAGE1: CHARSET names can be at most 8 characters long.
      136    19900        */
      137    19901    2      AS_FIELD1.COUNT = OUT$SYM.COUNT ;

  19901  3 000117   100004 236100                    LDQ     4,,PR1
         3 000120   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      138    19902    2      AS_FIELD1.TEXT = OUT$SYM.TEXT;

  19902  3 000121   100004 236100                    LDQ     4,,PR1
         3 000122   000033 772000                    QRL     27
         3 000123   000000 620006                    EAX0    0,QL
         3 000124   040000 100540                    MLR     fill='040'O
         3 000125   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         3 000126   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      139    19903           %SCREAM (ERR#=E$CHARNAMETOOBIG,MID='C',LEVEL=ERROR);

  19915  3 000127   000004 630400 4                  EPPR0   4
         3 000130   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000131   000000 701000 xent               TSX1    ASH$ERROR
         3 000132   000000 011000                    NOP     0

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:29   
      140    19918    2      RETURN;

  19918  3 000133   000000 702200 xent               TSX2  ! X66_ARET

      141    19919    2      END;
      142    19920    1   ARS = SIZEC (FS$CHARSET) ;

  19920  3 000134   000370 235007                    LDA     248,DL
         3 000135   200005 755100                    STA     ARS,,AUTO

      143    19921    1   CALL ASF$READ_FORM (CHARSET_KEY, F$, ARS)

  19921  3 000136   200005 633500                    EPPR3   ARS,,AUTO
         3 000137   200036 453500                    STP3    PTR$+4,,AUTO
         3 000140   200016 634500                    EPPR4   F$,,AUTO
         3 000141   200035 454500                    STP4    PTR$+3,,AUTO
         3 000142   200007 635500                    EPPR5   CHARSET_KEY,,AUTO
         3 000143   200034 455500                    STP5    PTR$+2,,AUTO
         3 000144   200034 630500                    EPPR0   PTR$+2,,AUTO
         3 000145   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000146   000000 701000 xent               TSX1    ASF$READ_FORM
         3 000147   000171 702000 3                  TSX2    s:19949

      144    19922    2   WHENRETURN DO;

      145    19923    2      IF CREATE

  19923  3 000150   200003 234100                    SZN     CREATE,,AUTO
         3 000151   000170 605000 3                  TPL     s:19945+1

      146    19924    3      THEN DO;

      147    19925        /*E* ERROR: ASC-E$CHAREXISTS-C
      148    19926             MESSAGE: CHARSET %U1 already exists.
      149    19927             MESSAGE1: You can't create a CHARSET that already exists */
      150    19928    3         AS_FIELD1.COUNT = OUT$SYM.COUNT ;

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:30   
  19928  3 000152   200015 470500                    LDP0    BLK$,,AUTO
         3 000153   000004 236100                    LDQ     4,,PR0
         3 000154   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      151    19929    3         AS_FIELD1.TEXT = OUT$SYM.TEXT;

  19929  3 000155   000004 236100                    LDQ     4,,PR0
         3 000156   000033 772000                    QRL     27
         3 000157   000000 620006                    EAX0    0,QL
         3 000160   040000 100540                    MLR     fill='040'O
         3 000161   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         3 000162   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      152    19930              %SCREAM( ERR#=E$CHAREXISTS,MID='C',LEVEL=ERROR);

  19942  3 000163   000005 630400 4                  EPPR0   5
         3 000164   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000165   000000 701000 xent               TSX1    ASH$ERROR
         3 000166   000000 011000                    NOP     0

      153    19945    3         RETURN;

  19945  3 000167   000000 702200 xent               TSX2  ! X66_ARET
         3 000170   000344 710000 3                  TRA     s:20036

      154    19946    3         END;
      155    19947    2      END;
      156    19948    2   WHENALTRETURN DO;

      157    19949    2      IF ~CREATE

  19949  3 000171   200003 236100                    LDQ     CREATE,,AUTO
         3 000172   400000 376003                    ANQ     -131072,DU
         3 000173   400000 676003                    ERQ     -131072,DU
         3 000174   000215 600000 3                  TZE     s:19973

      158    19950    3      THEN DO;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:31   

      159    19951        /*E* ERROR: ASF-E$CHARSWITCH-0
      160    19952             MESSAGE: %%U1 %does not exist. Switching to CREATE mode.
      161    19953        */
      162    19954    3         AS_FIELD1.COUNT = OUT$SYM.COUNT ;

  19954  3 000175   200015 470500                    LDP0    BLK$,,AUTO
         3 000176   000004 236100                    LDQ     4,,PR0
         3 000177   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      163    19955    3         AS_FIELD1.TEXT = OUT$SYM.TEXT;

  19955  3 000200   000004 236100                    LDQ     4,,PR0
         3 000201   000033 772000                    QRL     27
         3 000202   000000 620006                    EAX0    0,QL
         3 000203   040000 100540                    MLR     fill='040'O
         3 000204   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         3 000205   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      164    19956              %SCREAM( ERR#= E$CHARSWITCH,MID='F',LEVEL=INFO );

  19964  3 000206   000006 630400 4                  EPPR0   6
         3 000207   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000210   000000 701000 xent               TSX1    ASH$INFO
         3 000211   000000 011000                    NOP     0

      165    19971    3         CREATE=AS_TRUE;

  19971  3 000212   000000 236000 xsym               LDQ     AS_TRUE
         3 000213   400000 376003                    ANQ     -131072,DU
         3 000214   200003 756100                    STQ     CREATE,,AUTO

      166    19972    3         END;

      167    19973    2      SUBS = P$NODE.SUBNODES;

  19973  3 000215   000000 470400 xsym               LDP0    NODE$
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:32   
         3 000216   000001 236100                    LDQ     1,,PR0
         3 000217   000022 772000                    QRL     18
         3 000220   200006 756100                    STQ     SUBS,,AUTO

      168    19974    2      FROM = AS_FALSE;   /* Start processing from field */

  19974  3 000221   000000 236000 xsym               LDQ     AS_FALSE
         3 000222   400000 376003                    ANQ     -131072,DU
         3 000223   200004 756100                    STQ     FROM,,AUTO

      169    19975    2      IF CREATE

  19975  3 000224   200003 234100                    SZN     CREATE,,AUTO
         3 000225   000344 605000 3                  TPL     s:20036

      170    19976    3      THEN DO;

      171    19977    3         IF P$NODE.SUBLK$(1)->P$NODE.CODE = 84 /*CHARSET_NAME_2_VAL*/

  19977  3 000226   000004 471500                    LDP1    4,,PR0
         3 000227   100000 720100                    LXL0    0,,PR1
         3 000230   000124 100003                    CMPX0   84,DU
         3 000231   000312 601000 3                  TNZ     s:20006

      172    19978    4         THEN DO;

      173    19979    4            BLK$ = P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0);

  19979  3 000232   100003 236100                    LDQ     3,,PR1
         3 000233   200015 756100                    STQ     BLK$,,AUTO

      174    19980    4            CALL CONCAT(FROM_KEY.TEXT,'~',OUT$SYM.TEXT,'CHARSET');

  19980  3 000234   200015 473500                    LDP3    BLK$,,AUTO
         3 000235   300004 236100                    LDQ     4,,PR3
         3 000236   000033 772000                    QRL     27
         3 000237   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:33   
         3 000240   000176 236003                    LDQ     126,DU
         3 000241   000000 552020 xsym               STBQ    FROM_KEY,'20'O
         3 000242   040000 100540                    MLR     fill='040'O
         3 000243   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         3 000244   000000 400023 xsym               ADSC9   FROM_KEY                 cn=2,n=19
         3 000245   000000 636011                    EAQ     0,X1
         3 000246   000022 772000                    QRL     18
         3 000247   000023 116007                    CMPQ    19,DL
         3 000250   000261 603000 3                  TRC     s:19981
         3 000251   200034 741100                    STX1    PTR$+2,,AUTO
         3 000252   777754 621011                    EAX1    -20,X1
         3 000253   777777 661003                    ERX1    -1,DU
         3 000254   200034 235100                    LDA     PTR$+2,,AUTO
         3 000255   000022 771000                    ARL     18
         3 000256   040045 100400                    MLR     fill='040'O
         3 000257   000010 000007 2                  ADSC9   8                        cn=0,n=7
         3 000260   000000 400011 xsym               ADSC9   FROM_KEY,A               cn=2,n=*X1

      175    19981    4            FROM_KEY.CNT = 8 + OUT$SYM.COUNT;

  19981  3 000261   300004 236100                    LDQ     4,,PR3
         3 000262   000033 772000                    QRL     27
         3 000263   000010 036007                    ADLQ    8,DL
         3 000264   000033 736000                    QLS     27
         3 000265   000000 552040 xsym               STBQ    FROM_KEY,'40'O

      176    19982    4            FROM = AS_TRUE;

  19982  3 000266   000000 236000 xsym               LDQ     AS_TRUE
         3 000267   400000 376003                    ANQ     -131072,DU
         3 000270   200004 756100                    STQ     FROM,,AUTO

      177    19983    4            IF OUT$SYM.COUNT > 8

  19983  3 000271   300004 236100                    LDQ     4,,PR3
         3 000272   777000 376003                    ANQ     -512,DU
         3 000273   011000 116003                    CMPQ    4608,DU
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:34   
         3 000274   000317 602000 3                  TNC     s:20009

      178    19984    5            THEN DO;

      179    19985    5               AS_FIELD1.COUNT = OUT$SYM.COUNT ;

  19985  3 000275   300004 236100                    LDQ     4,,PR3
         3 000276   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      180    19986    5               AS_FIELD1.TEXT = OUT$SYM.TEXT;

  19986  3 000277   300004 236100                    LDQ     4,,PR3
         3 000300   000033 772000                    QRL     27
         3 000301   000000 620006                    EAX0    0,QL
         3 000302   040000 100540                    MLR     fill='040'O
         3 000303   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         3 000304   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      181    19987                    %SCREAM( ERR#=E$CHARNAMETOOBIG,MID='C',LEVEL=ERROR);

  19999  3 000305   000004 630400 4                  EPPR0   4
         3 000306   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000307   000000 701000 xent               TSX1    ASH$ERROR
         3 000310   000000 011000                    NOP     0

      182    20002    5               RETURN;

  20002  3 000311   000000 702200 xent               TSX2  ! X66_ARET

      183    20003    5               END;
      184    20004    4            END;
      185    20005    4         ELSE DO;

      186    20006    4            FROM_KEY.CNT = 11;

  20006  3 000312   013000 236003                    LDQ     5632,DU
         3 000313   000000 552040 xsym               STBQ    FROM_KEY,'40'O
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:35   

      187    20007    4            FROM_KEY.TEXT = '~600CHARSET';

  20007  3 000314   040000 100400                    MLR     fill='040'O
         3 000315   000015 000013 2                  ADSC9   13                       cn=0,n=11
         3 000316   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20

      188    20008    4            END;

      189    20009    3         CALL ASF$READ_FORM( FROM_KEY, F$, ARS)

  20009  3 000317   200005 631500                    EPPR1   ARS,,AUTO
         3 000320   200036 451500                    STP1    PTR$+4,,AUTO
         3 000321   200016 633500                    EPPR3   F$,,AUTO
         3 000322   200035 453500                    STP3    PTR$+3,,AUTO
         3 000323   000007 236000 4                  LDQ     7
         3 000324   200034 756100                    STQ     PTR$+2,,AUTO
         3 000325   200034 630500                    EPPR0   PTR$+2,,AUTO
         3 000326   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000327   000000 701000 xent               TSX1    ASF$READ_FORM
         3 000330   000332 702000 3                  TSX2    s:20015
         3 000331   000344 710000 3                  TRA     s:20036

      190    20010    4         WHENALTRETURN DO;

      191    20011        /*E* ERROR: ASC-E$CANTREADCHARSET-C
      192    20012             MESSAGE: Unable to read CHARSET %U1 from :FORM file.
      193    20013             MESSAGE1: The FROM (default 600) charset record is unreadable.
      194    20014        */
      195    20015    4            AS_FIELD1.COUNT = FROM_KEY.CNT ;

  20015  3 000332   000000 236000 xsym               LDQ     FROM_KEY
         3 000333   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      196    20016    4            AS_FIELD1.TEXT = FROM_KEY.TEXT;

  20016  3 000334   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:36   
         3 000335   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20
         3 000336   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      197    20017                 %SCREAM( ERR#=E$CANTREADCHARSET, LEVEL=ERROR, MID='C' );

  20029  3 000337   000010 630400 4                  EPPR0   8
         3 000340   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000341   000000 701000 xent               TSX1    ASH$ERROR
         3 000342   000000 011000                    NOP     0

      198    20032    4            RETURN;

  20032  3 000343   000000 702200 xent               TSX2  ! X66_ARET

      199    20033    4            END;
      200    20034    3         END;

      201    20035    2      END;

      202    20036    1   CALL CHARSET_OPTS; /* Get all of the options and update FS$CHARSET*/

  20036  3 000344   000363 701000 3                  TSX1    CHARSET_OPTS
         3 000345   000000 011000                    NOP     0

      203    20037
      204    20038    1   ARS = SIZEC (FS$CHARSET);

  20038  3 000346   000370 235007                    LDA     248,DL
         3 000347   200005 755100                    STA     ARS,,AUTO

      205    20039    1   CALL ASF$WRITE_FORM (CHARSET_KEY,F$,ARS);

  20039  3 000350   200005 630500                    EPPR0   ARS,,AUTO
         3 000351   200036 450500                    STP0    PTR$+4,,AUTO
         3 000352   200016 631500                    EPPR1   F$,,AUTO
         3 000353   200035 451500                    STP1    PTR$+3,,AUTO
         3 000354   200007 633500                    EPPR3   CHARSET_KEY,,AUTO
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:37   
         3 000355   200034 453500                    STP3    PTR$+2,,AUTO
         3 000356   200034 630500                    EPPR0   PTR$+2,,AUTO
         3 000357   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000360   000000 701000 xent               TSX1    ASF$WRITE_FORM
         3 000361   000000 011000                    NOP     0

      206    20040    1   RETURN;

  20040  3 000362   000000 702200 xent               TSX2  ! X66_ARET

      207    20041        %EJECT;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:38   
      208    20042        /*F*
      209    20043             NAME: CHARSET_OPTS
      210    20044             PURPOSE:
      211    20045                  To process all the options when altering charset records.
      212    20046             DESCRIPTION:
      213    20047                  This routine reads input, parses it, and performs the apporpriate
      214    20048                  action.  It will either handle the attributes, devices, or call
      215    20049                  the IMAGE routine to modify the chain image.
      216    20050        */
      217    20051        /*D*
      218    20052             NAME: CHARSET_OPTS
      219    20053             ENTRY:
      220    20054                  CALL CHARSET_OPTS
      221    20055             CALL:
      222    20056                  Only called from and within the ASC$CHARSET routine.
      223    20057             ENVIRONMENT:
      224    20058                  SUPER
      225    20059             DESCRIPTION:
      226    20060                  When an attribute command is given, the attribute field is zeroed out
      227    20061                  and all the new attributes are ORed together.  Devices are handled
      228    20062                  differently.  The device command will set a flag for each device type
      229    20063                  given, allowable are 'LP', 'TS', '?', 'xx' where xx is any two
      230    20064                  character device type.  This type is not checked for legality, that
      231    20065                  is done elsewhere after that type is placed into the form record.
      232    20066        */
      233    20067    1   CHARSET_OPTS: PROC;

  20067  3 000363   200020 741300       CHARSET_OPTS STX1  ! F$+2,,AUTO

      234    20068
      235    20069    2   DCL J UBIN WORD;
      236    20070    2   DCL PTR$ PTR;
      237    20071    2   DCL SUBNODES UBIN WORD;
      238    20072    2   DCL WARN BIT(1);
      239    20073    2   DCL FOUND UBIN;
      240    20074
      241    20075    3   DO WHILE ( AS_TRUE );
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:39   

  20075  3 000364   000000 234000 xsym               SZN     AS_TRUE
         3 000365   001000 605000 3                  TPL     s:20229

  20073  3 000366                       RETRY        null
      242    20076    3   RETRY: ;
      243    20077    3      CALL ASB$SET_PROMPT ( %PROMPT_OPT );

  20077  3 000366   000011 630400 4                  EPPR0   9
         3 000367   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000370   000000 701000 xent               TSX1    ASB$SET_PROMPT
         3 000371   000000 011000                    NOP     0

      244    20078    3      CALL ASB$READ_SI( IN_BUF, ARS);

  20078  3 000372   200005 630500                    EPPR0   ARS,,AUTO
         3 000373   200035 450500                    STP0    PTR$+3,,AUTO
         3 000374   000012 236000 4                  LDQ     10
         3 000375   200034 756100                    STQ     PTR$+2,,AUTO
         3 000376   200034 630500                    EPPR0   PTR$+2,,AUTO
         3 000377   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000400   000000 701000 xent               TSX1    ASB$READ_SI
         3 000401   000000 011000                    NOP     0

      245    20079    3      P_PCB.NCHARS = ARS;

  20079  3 000402   200005 235100                    LDA     ARS,,AUTO
         3 000403   000011 755000 xsym               STA     P_PCB+9

      246    20080    3      P_PCB.ROOT$ = ADDR (CHARSET_OPT_LIST);

  20080  3 000404   000013 236000 4                  LDQ     11
         3 000405   000001 756000 xsym               STQ     P_PCB+1

      247    20081    3      CALL X$PARSE(P_PCB)

  20081  3 000406   000002 630400 4                  EPPR0   2
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:40   
         3 000407   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000410   000000 701000 xent               TSX1    X$PARSE
         3 000411   000413 702000 3                  TSX2    s:20083
         3 000412   000420 710000 3                  TRA     s:20086

      248    20082    4      WHENALTRETURN DO;

      249    20083    4         CALL ASH$ERROR (P_PCB.ERROR);

  20083  3 000413   000003 630400 4                  EPPR0   3
         3 000414   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000415   000000 701000 xent               TSX1    ASH$ERROR
         3 000416   000000 011000                    NOP     0

      250    20084    4         GOTO RETRY;

  20084  3 000417   000366 710000 3                  TRA     RETRY

      251    20085    4         END;
      252    20086    3      NODE$ = P_PCB.OUT$;

  20086  3 000420   000003 236000 xsym               LDQ     P_PCB+3
         3 000421   000000 756000 xsym               STQ     NODE$

      253    20087    3      SUBNODES = P$NODE.SUBNODES;

  20087  3 000422   000000 470400 xsym               LDP0    NODE$
         3 000423   000001 236100                    LDQ     1,,PR0
         3 000424   000022 772000                    QRL     18
         3 000425   200023 756100                    STQ     SUBNODES,,AUTO

      254    20088    3      CODE = P$NODE.CODE;

  20088  3 000426   000000 236100                    LDQ     0,,PR0
         3 000427   777777 376007                    ANQ     -1,DL
         3 000430   000000 756000 xsym               STQ     CODE

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:41   
      255    20089    4      DO SELECT (CODE);

  20089  3 000431   000454 116007                    CMPQ    300,DL
         3 000432   000442 602000 3                  TNC     s:20089+9
         3 000433   000471 600000 3                  TZE     s:20095
         3 000434   000455 116007                    CMPQ    301,DL
         3 000435   000776 602000 3                  TNC     s:20228
         3 000436   000465 600000 3                  TZE     s:20093
         3 000437   000456 116007                    CMPQ    302,DL
         3 000440   000776 601000 3                  TNZ     s:20228
         3 000441   000461 710000 3                  TRA     s:20091
         3 000442   000032 116007                    CMPQ    26,DL
         3 000443   000456 602000 3                  TNC     s:20089+21
         3 000444   000475 600000 3                  TZE     s:20097
         3 000445   000137 116007                    CMPQ    95,DL
         3 000446   000453 602000 3                  TNC     s:20089+18
         3 000447   000502 600000 3                  TZE     s:20101
         3 000450   000140 116007                    CMPQ    96,DL
         3 000451   000776 601000 3                  TNZ     s:20228
         3 000452   000477 710000 3                  TRA     s:20099
         3 000453   000132 116007                    CMPQ    90,DL
         3 000454   000776 601000 3                  TNZ     s:20228
         3 000455   000505 710000 3                  TRA     s:20104
         3 000456   000014 116007                    CMPQ    12,DL
         3 000457   000776 601000 3                  TNZ     s:20228
         3 000460   000475 710000 3                  TRA     s:20097

      256    20090    4         SELECT( 302 /* HELP_VAL */ );

      257    20091    4         CALL ASH$HELP;

  20091  3 000461   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000462   000000 701000 xent               TSX1    ASH$HELP
         3 000463   000000 011000                    NOP     0
         3 000464   000776 710000 3                  TRA     s:20228

      258    20092    4         SELECT( 301 /* QUESTION_VAL */ );
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:42   

      259    20093    4         CALL ASH$QUEST;

  20093  3 000465   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000466   000000 701000 xent               TSX1    ASH$QUEST
         3 000467   000000 011000                    NOP     0
         3 000470   000776 710000 3                  TRA     s:20228

      260    20094    4         SELECT( 300 /* DQUESTION_VAL */ );

      261    20095    4         CALL ASH$DQUEST;

  20095  3 000471   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000472   000000 701000 xent               TSX1    ASH$DQUEST
         3 000473   000000 011000                    NOP     0
         3 000474   000776 710000 3                  TRA     s:20228

      262    20096    4         SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */);

      263    20097    4         RETURN;

  20097  3 000475   200020 221300                    LDX1  ! F$+2,,AUTO
         3 000476   000001 702211                    TSX2  ! 1,X1

      264    20098    4         SELECT( 96 /* C_IMAGE_VAL */ );

      265    20099    4         CALL IMAGE;

  20099  3 000477   001002 701000 3                  TSX1    IMAGE
         3 000500   000000 011000                    NOP     0
         3 000501   000776 710000 3                  TRA     s:20228

      266    20100    4         SELECT ( 95 /* C_DEVS_VAL */);

      267    20101    4         CALL DEVICES;

  20101  3 000502   001145 701000 3                  TSX1    DEVICES
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:43   
         3 000503   000000 011000                    NOP     0
         3 000504   000776 710000 3                  TRA     s:20228

      268    20102    4         SELECT( 90 /* C_ATTRS_VAL */ );

      269    20103
      270    20104    4         WARN = AS_FALSE;

  20104  3 000505   000000 236000 xsym               LDQ     AS_FALSE
         3 000506   400000 376003                    ANQ     -131072,DU
         3 000507   200024 756100                    STQ     WARN,,AUTO

      271    20105    4         FOUND = 0;

  20105  3 000510   200025 450100                    STZ     FOUND,,AUTO

      272    20106    4         FS$CHARSET.ATTRS = AS_FALSE;

  20106  3 000511   003100 060400                    CSL     bolr='003'O
         3 000512   000000 000001 xsym               BDSC    AS_FALSE                 by=0,bit=0,n=1
         3 000513   200034 000044                    BDSC    PTR$+2,,AUTO             by=0,bit=0,n=36
         3 000514   200034 220100                    LDX0    PTR$+2,,AUTO
         3 000515   200016 471500                    LDP1    F$,,AUTO
         3 000516   100074 740100                    STX0    60,,PR1

      273    20107    5         DO J = 0 TO SUBNODES - 1;

  20107  3 000517   200021 450100                    STZ     J,,AUTO
         3 000520   000773 710000 3                  TRA     s:20226+3

      274    20108    5            PTR$ = P$NODE.SUBLK$(J);

  20108  3 000521   000000 470400 xsym               LDP0    NODE$
         3 000522   200021 720100                    LXL0    J,,AUTO
         3 000523   000003 236110                    LDQ     3,X0,PR0
         3 000524   200022 756100                    STQ     PTR$,,AUTO

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:44   
      275    20109    5            CODE = PTR$-> P$NODE.CODE;

  20109  3 000525   200022 471500                    LDP1    PTR$,,AUTO
         3 000526   100000 236100                    LDQ     0,,PR1
         3 000527   777777 376007                    ANQ     -1,DL
         3 000530   000000 756000 xsym               STQ     CODE

      276    20110    6            DO SELECT (CODE);

  20110  3 000531   000161 116007                    CMPQ    113,DL
         3 000532   000550 602000 3                  TNC     s:20110+15
         3 000533   000651 600000 3                  TZE     s:20151
         3 000534   000163 116007                    CMPQ    115,DL
         3 000535   000545 602000 3                  TNC     s:20110+12
         3 000536   000677 600000 3                  TZE     s:20166
         3 000537   000164 116007                    CMPQ    116,DL
         3 000540   000762 602000 3                  TNC     s:20202
         3 000541   000727 600000 3                  TZE     s:20181
         3 000542   000176 116007                    CMPQ    126,DL
         3 000543   000762 601000 3                  TNZ     s:20202
         3 000544   000755 710000 3                  TRA     s:20196
         3 000545   000162 116007                    CMPQ    114,DL
         3 000546   000762 601000 3                  TNZ     s:20202
         3 000547   000621 710000 3                  TRA     s:20136
         3 000550   000157 116007                    CMPQ    111,DL
         3 000551   000556 602000 3                  TNC     s:20110+21
         3 000552   000566 600000 3                  TZE     s:20117
         3 000553   000160 116007                    CMPQ    112,DL
         3 000554   000762 601000 3                  TNZ     s:20202
         3 000555   000614 710000 3                  TRA     s:20132
         3 000556   000156 116007                    CMPQ    110,DL
         3 000557   000762 601000 3                  TNZ     s:20202
         3 000560   000561 710000 3                  TRA     s:20113

      277    20111    6               SELECT(110 /* C_ATTR_OVER */);

      278    20112
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:45   
      279    20113    6               FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_TRUOVRPRT#;

  20113  3 000561   200016 473500                    LDP3    F$,,AUTO
         3 000562   300074 221100                    LDX1    60,,PR3
         3 000563   000010 261003                    ORX1    8,DU
         3 000564   300074 741100                    STX1    60,,PR3
         3 000565   000762 710000 3                  TRA     s:20202

      280    20114
      281    20115    6               SELECT (111 /* C_ATTR_APL */);

      282    20116
      283    20117    6               IF FOUND = 0 THEN

  20117  3 000566   200025 235100                    LDA     FOUND,,AUTO
         3 000567   000603 601000 3                  TNZ     s:20125

      284    20118    7               DO;

      285    20119    7                  FOUND = CODE;

  20119  3 000570   200025 756100                    STQ     FOUND,,AUTO

      286    20120    7                  FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_APL#;

  20120  3 000571   200016 473500                    LDP3    F$,,AUTO
         3 000572   300074 221100                    LDX1    60,,PR3
         3 000573   000004 261003                    ORX1    4,DU
         3 000574   300074 741100                    STX1    60,,PR3

      287    20121    7                  AS_FIELD1.TEXT = 'APL';

  20121  3 000575   040000 100400                    MLR     fill='040'O
         3 000576   000021 000003 2                  ADSC9   17                       cn=0,n=3
         3 000577   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      288    20122    7                  AS_FIELD1.COUNT = 3;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:46   

  20122  3 000600   003000 236003                    LDQ     1536,DU
         3 000601   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      289    20123    7                  END; /*  Not found yet  */

  20123  3 000602   000762 710000 3                  TRA     s:20202

      290    20124    7               ELSE DO;

      291    20125    7                  WARN = AS_TRUE;

  20125  3 000603   000000 236000 xsym               LDQ     AS_TRUE
         3 000604   400000 376003                    ANQ     -131072,DU
         3 000605   200024 756100                    STQ     WARN,,AUTO

      292    20126    7                  AS_FIELD2.TEXT = 'APL';

  20126  3 000606   040000 100400                    MLR     fill='040'O
         3 000607   000021 000003 2                  ADSC9   17                       cn=0,n=3
         3 000610   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      293    20127    7                  AS_FIELD2.COUNT = 3;

  20127  3 000611   003000 236003                    LDQ     1536,DU
         3 000612   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      294    20128    7                  END;

  20128  3 000613   000762 710000 3                  TRA     s:20202

      295    20129
      296    20130    6               SELECT (112 /* C_ATTR_BIN */);

      297    20131
      298    20132    6               FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_BIN#;

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:47   
  20132  3 000614   200016 473500                    LDP3    F$,,AUTO
         3 000615   300074 221100                    LDX1    60,,PR3
         3 000616   000002 261003                    ORX1    2,DU
         3 000617   300074 741100                    STX1    60,,PR3
         3 000620   000762 710000 3                  TRA     s:20202

      299    20133
      300    20134    6               SELECT(114 /* C_ATTR_LOWERCASE */);

      301    20135
      302    20136    6               IF FOUND = 0 OR FOUND = 115 /* C_ATTR_UPPERCASE */ THEN

  20136  3 000621   200025 235100                    LDA     FOUND,,AUTO
         3 000622   000625 600000 3                  TZE     s:20138
         3 000623   000163 115007                    CMPA    115,DL
         3 000624   000640 601000 3                  TNZ     s:20144

      303    20137    7               DO;

      304    20138    7                  FOUND = CODE;

  20138  3 000625   200025 756100                    STQ     FOUND,,AUTO

      305    20139    7                  FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_LOWERCASE#;

  20139  3 000626   200016 473500                    LDP3    F$,,AUTO
         3 000627   300074 221100                    LDX1    60,,PR3
         3 000630   000001 261003                    ORX1    1,DU
         3 000631   300074 741100                    STX1    60,,PR3

      306    20140    7                  AS_FIELD1.TEXT = 'LOWERCASE';

  20140  3 000632   040000 100400                    MLR     fill='040'O
         3 000633   000022 000011 2                  ADSC9   18                       cn=0,n=9
         3 000634   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      307    20141    7                  AS_FIELD1.COUNT = 9;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:48   

  20141  3 000635   011000 236003                    LDQ     4608,DU
         3 000636   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      308    20142    7                  END; /*  Not found yet  */

  20142  3 000637   000762 710000 3                  TRA     s:20202

      309    20143    7               ELSE DO;

      310    20144    7                  WARN = AS_TRUE;

  20144  3 000640   000000 236000 xsym               LDQ     AS_TRUE
         3 000641   400000 376003                    ANQ     -131072,DU
         3 000642   200024 756100                    STQ     WARN,,AUTO

      311    20145    7                  AS_FIELD2.TEXT = 'LOWERCASE';

  20145  3 000643   040000 100400                    MLR     fill='040'O
         3 000644   000022 000011 2                  ADSC9   18                       cn=0,n=9
         3 000645   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      312    20146    7                  AS_FIELD2.COUNT = 9;

  20146  3 000646   011000 236003                    LDQ     4608,DU
         3 000647   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      313    20147    7                  END;

  20147  3 000650   000762 710000 3                  TRA     s:20202

      314    20148
      315    20149    6               SELECT(113 /* C_ATTR_NATL */);

      316    20150
      317    20151    6               IF FOUND = 0 THEN

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:49   
  20151  3 000651   200025 235100                    LDA     FOUND,,AUTO
         3 000652   000666 601000 3                  TNZ     s:20159

      318    20152    7               DO;

      319    20153    7                  FOUND = CODE;

  20153  3 000653   200025 756100                    STQ     FOUND,,AUTO

      320    20154    7                  FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_NATL#;

  20154  3 000654   200016 473500                    LDP3    F$,,AUTO
         3 000655   300074 221100                    LDX1    60,,PR3
         3 000656   000020 261003                    ORX1    16,DU
         3 000657   300074 741100                    STX1    60,,PR3

      321    20155    7                  AS_FIELD1.TEXT = 'NATL';

  20155  3 000660   040000 100400                    MLR     fill='040'O
         3 000661   000025 000004 2                  ADSC9   21                       cn=0,n=4
         3 000662   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      322    20156    7                  AS_FIELD1.COUNT = 4;

  20156  3 000663   004000 236003                    LDQ     2048,DU
         3 000664   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      323    20157    7                  END; /*  Not found yet  */

  20157  3 000665   000762 710000 3                  TRA     s:20202

      324    20158    7               ELSE DO;

      325    20159    7                  WARN = AS_TRUE;

  20159  3 000666   000000 236000 xsym               LDQ     AS_TRUE
         3 000667   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:50   
         3 000670   200024 756100                    STQ     WARN,,AUTO

      326    20160    7                  AS_FIELD2.TEXT = 'NATL';

  20160  3 000671   040000 100400                    MLR     fill='040'O
         3 000672   000025 000004 2                  ADSC9   21                       cn=0,n=4
         3 000673   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      327    20161    7                  AS_FIELD2.COUNT = 4;

  20161  3 000674   004000 236003                    LDQ     2048,DU
         3 000675   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      328    20162    7                  END;

  20162  3 000676   000762 710000 3                  TRA     s:20202

      329    20163
      330    20164    6               SELECT(115 /* C_ATTR_UPPERCASE */);

      331    20165
      332    20166    6               IF FOUND = 0 OR FOUND = 114 /* C_ATTR_LOWERCASE */ THEN

  20166  3 000677   200025 235100                    LDA     FOUND,,AUTO
         3 000700   000703 600000 3                  TZE     s:20168
         3 000701   000162 115007                    CMPA    114,DL
         3 000702   000716 601000 3                  TNZ     s:20174

      333    20167    7               DO;

      334    20168    7                  FOUND = CODE;

  20168  3 000703   200025 756100                    STQ     FOUND,,AUTO

      335    20169    7                  FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_UPPERCASE#;

  20169  3 000704   200016 473500                    LDP3    F$,,AUTO
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:51   
         3 000705   300074 221100                    LDX1    60,,PR3
         3 000706   000040 261003                    ORX1    32,DU
         3 000707   300074 741100                    STX1    60,,PR3

      336    20170    7                  AS_FIELD1.TEXT = 'UPPERCASE';

  20170  3 000710   040000 100400                    MLR     fill='040'O
         3 000711   000026 000011 2                  ADSC9   22                       cn=0,n=9
         3 000712   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      337    20171    7                  AS_FIELD1.COUNT = 9;

  20171  3 000713   011000 236003                    LDQ     4608,DU
         3 000714   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      338    20172    7                  END; /*  Not found yet  */

  20172  3 000715   000762 710000 3                  TRA     s:20202

      339    20173    7               ELSE DO;

      340    20174    7                  WARN = AS_TRUE;

  20174  3 000716   000000 236000 xsym               LDQ     AS_TRUE
         3 000717   400000 376003                    ANQ     -131072,DU
         3 000720   200024 756100                    STQ     WARN,,AUTO

      341    20175    7                  AS_FIELD2.TEXT = 'UPPERCASE';

  20175  3 000721   040000 100400                    MLR     fill='040'O
         3 000722   000026 000011 2                  ADSC9   22                       cn=0,n=9
         3 000723   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      342    20176    7                  AS_FIELD2.COUNT = 9;

  20176  3 000724   011000 236003                    LDQ     4608,DU
         3 000725   000000 552040 xsym               STBQ    AS_FIELD2,'40'O
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:52   

      343    20177    7                  END;

  20177  3 000726   000762 710000 3                  TRA     s:20202

      344    20178
      345    20179    6               SELECT(116 /* C_ATTR_NOXLATE */);

      346    20180
      347    20181    6               IF FOUND = 0 THEN

  20181  3 000727   200025 235100                    LDA     FOUND,,AUTO
         3 000730   000744 601000 3                  TNZ     s:20189

      348    20182    7               DO;

      349    20183    7                  FOUND = CODE;

  20183  3 000731   200025 756100                    STQ     FOUND,,AUTO

      350    20184    7                  FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_NOXLATE#;

  20184  3 000732   200016 473500                    LDP3    F$,,AUTO
         3 000733   300074 221100                    LDX1    60,,PR3
         3 000734   000100 261003                    ORX1    64,DU
         3 000735   300074 741100                    STX1    60,,PR3

      351    20185    7                  AS_FIELD1.TEXT = 'NOXLATE';

  20185  3 000736   040000 100400                    MLR     fill='040'O
         3 000737   000031 000007 2                  ADSC9   25                       cn=0,n=7
         3 000740   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      352    20186    7                  AS_FIELD1.COUNT = 7;

  20186  3 000741   007000 236003                    LDQ     3584,DU
         3 000742   000000 552040 xsym               STBQ    AS_FIELD1,'40'O
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:53   

      353    20187    7                  END; /*  Not found yet  */

  20187  3 000743   000762 710000 3                  TRA     s:20202

      354    20188    7               ELSE DO;

      355    20189    7                  WARN = AS_TRUE;

  20189  3 000744   000000 236000 xsym               LDQ     AS_TRUE
         3 000745   400000 376003                    ANQ     -131072,DU
         3 000746   200024 756100                    STQ     WARN,,AUTO

      356    20190    7                  AS_FIELD2.TEXT = 'NOXLATE';

  20190  3 000747   040000 100400                    MLR     fill='040'O
         3 000750   000031 000007 2                  ADSC9   25                       cn=0,n=7
         3 000751   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      357    20191    7                  AS_FIELD2.COUNT = 7;

  20191  3 000752   007000 236003                    LDQ     3584,DU
         3 000753   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      358    20192    7                  END;

  20192  3 000754   000762 710000 3                  TRA     s:20202

      359    20193
      360    20194    6               SELECT (126 /* C_ATTR_TRANSLGL */);

      361    20195
      362    20196    6               FS$CHARSET.ATTRS = FS$CHARSET.ATTRS | %ATTR_TRANSLGL#;

  20196  3 000755   200016 473500                    LDP3    F$,,AUTO
         3 000756   300074 221100                    LDX1    60,,PR3
         3 000757   000200 261003                    ORX1    128,DU
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:54   
         3 000760   300074 741100                    STX1    60,,PR3
         3 000761   000762 710000 3                  TRA     s:20202

      363    20197
      364    20198    6               SELECT( ELSE );

      365    20199                        /* Don't know what to do here, so do nothing! */
      366    20200    6               END; /* Do case */

      367    20201
      368    20202    5         IF WARN THEN

  20202  3 000762   200024 234100                    SZN     WARN,,AUTO
         3 000763   000770 605000 3                  TPL     s:20226

      369    20203        /*E*  ERROR:   ASC-E$TOO_MANY_TRANSTABLES-0
      370    20204              MESSAGE0: %U1 and %U2 have a precedence order.
      371    20205                        Only one of them will be used.
      372    20206              MESSAGE1: You have specified conflicting translation tables
      373    20207                        on this option,  %U1 and %U2.
      374    20208              MESSAGE2: Translation table precedence is NOXL,NATL,APL,(UP&LO),UP,LO.
      375    20209        */
      376    20210                 %SCREAM (ERR#=E$TOO_MANY_TRANSTABLES,LEVEL=WARN,MID='C');

  20220  3 000764   000014 630400 4                  EPPR0   12
         3 000765   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000766   000000 701000 xent               TSX1    ASH$WARN
         3 000767   000000 011000                    NOP     0

      377    20225
      378    20226    5            END; /* Do j */

  20226  3 000770   200021 235100                    LDA     J,,AUTO
         3 000771   000001 035007                    ADLA    1,DL
         3 000772   200021 755100                    STA     J,,AUTO
         3 000773   200021 236100                    LDQ     J,,AUTO
         3 000774   200023 116100                    CMPQ    SUBNODES,,AUTO
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:55   
         3 000775   000521 602000 3                  TNC     s:20108

      379    20227    4         END; /* Do case */

      380    20228    3      END; /* Do while */

  20228  3 000776   000000 234000 xsym               SZN     AS_TRUE
         3 000777   000366 604000 3                  TMI     RETRY

      381    20229    2   END CHARSET_OPTS;

  20229  3 001000   200020 221300                    LDX1  ! F$+2,,AUTO
         3 001001   000001 702211                    TSX2  ! 1,X1

      382    20230        %EJECT;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:56   
      383    20231        /*F*
      384    20232             NAME: IMAGE
      385    20233             PURPOSE:
      386    20234                  Handle the image response inside CHARSET_OPTS.
      387    20235             DESCRIPTION:
      388    20236                  Brings SUPER to the SUB* level and allow the chain image to be
      389    20237                  modified by setting in arbitrary order the chain image through
      390    20238                  specification of 24 character parts.  Exactly 24 characters must be
      391    20239                  given.
      392    20240        */
      393    20241    1   IMAGE: PROC;

  20241  3 001002   200026 741300       IMAGE        STX1  ! FOUND+1,,AUTO

      394    20242
      395    20243
      396    20244    2   DCL PTR$ PTR;
      397    20245    2   DCL SETNUM UBIN;
      398    20246
      399    20247    2   CALL ASB$SET_PROMPT ( %PROMPT_SUB );

  20247  3 001003   000015 630400 4                  EPPR0   13
         3 001004   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001005   000000 701000 xent               TSX1    ASB$SET_PROMPT
         3 001006   000000 011000                    NOP     0

      400    20248    2   P_PCB.ROOT$ = ADDR (CHARSET_IMAGE_LIST);

  20248  3 001007   000016 236000 4                  LDQ     14
         3 001010   000001 756000 xsym               STQ     P_PCB+1

      401    20249    3   DO WHILE ( '1'B );

  20248  3 001011                       RETRY        null
      402    20250    3   RETRY: ;
      403    20251    3      CALL ASB$READ_SI( IN_BUF, ARS);

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:57   
  20251  3 001011   200005 630500                    EPPR0   ARS,,AUTO
         3 001012   200035 450500                    STP0    PTR$+3,,AUTO
         3 001013   000012 236000 4                  LDQ     10
         3 001014   200034 756100                    STQ     PTR$+2,,AUTO
         3 001015   200034 630500                    EPPR0   PTR$+2,,AUTO
         3 001016   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001017   000000 701000 xent               TSX1    ASB$READ_SI
         3 001020   000000 011000                    NOP     0

      404    20252    3      P_PCB.NCHARS = ARS;

  20252  3 001021   200005 235100                    LDA     ARS,,AUTO
         3 001022   000011 755000 xsym               STA     P_PCB+9

      405    20253    3      CALL X$PARSE(P_PCB)

  20253  3 001023   000002 630400 4                  EPPR0   2
         3 001024   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001025   000000 701000 xent               TSX1    X$PARSE
         3 001026   001030 702000 3                  TSX2    s:20255
         3 001027   001035 710000 3                  TRA     s:20258

      406    20254    4      WHENALTRETURN DO;

      407    20255    4         CALL ASH$ERROR (P_PCB.ERROR);

  20255  3 001030   000003 630400 4                  EPPR0   3
         3 001031   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001032   000000 701000 xent               TSX1    ASH$ERROR
         3 001033   000000 011000                    NOP     0

      408    20256    4         GOTO RETRY;

  20256  3 001034   001011 710000 3                  TRA     RETRY

      409    20257    4         END;
      410    20258    3      NODE$ = P_PCB.OUT$;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:58   

  20258  3 001035   000003 236000 xsym               LDQ     P_PCB+3
         3 001036   000000 756000 xsym               STQ     NODE$

      411    20259    3      CODE = P$NODE.CODE;

  20259  3 001037   000000 470400 xsym               LDP0    NODE$
         3 001040   000000 236100                    LDQ     0,,PR0
         3 001041   777777 376007                    ANQ     -1,DL
         3 001042   000000 756000 xsym               STQ     CODE

      412    20260    4      DO SELECT (CODE);

  20260  3 001043   000454 116007                    CMPQ    300,DL
         3 001044   001054 602000 3                  TNC     s:20260+9
         3 001045   001075 600000 3                  TZE     s:20266
         3 001046   000455 116007                    CMPQ    301,DL
         3 001047   001011 602000 3                  TNC     RETRY
         3 001050   001071 600000 3                  TZE     s:20264
         3 001051   000456 116007                    CMPQ    302,DL
         3 001052   001011 601000 3                  TNZ     RETRY
         3 001053   001065 710000 3                  TRA     s:20262
         3 001054   000032 116007                    CMPQ    26,DL
         3 001055   001062 602000 3                  TNC     s:20260+15
         3 001056   001101 600000 3                  TZE     s:20268
         3 001057   000125 116007                    CMPQ    85,DL
         3 001060   001011 601000 3                  TNZ     RETRY
         3 001061   001103 710000 3                  TRA     s:20270
         3 001062   000014 116007                    CMPQ    12,DL
         3 001063   001011 601000 3                  TNZ     RETRY
         3 001064   001101 710000 3                  TRA     s:20268

      413    20261    4         SELECT( 302 /* HELP_VAL */ );

      414    20262    4         CALL ASH$HELP;

  20262  3 001065   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:59   
         3 001066   000000 701000 xent               TSX1    ASH$HELP
         3 001067   000000 011000                    NOP     0
         3 001070   001011 710000 3                  TRA     RETRY

      415    20263    4         SELECT( 301 /* QUESTION_VAL */ );

      416    20264    4         CALL ASH$QUEST;

  20264  3 001071   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 001072   000000 701000 xent               TSX1    ASH$QUEST
         3 001073   000000 011000                    NOP     0
         3 001074   001011 710000 3                  TRA     RETRY

      417    20265    4         SELECT( 300 /* DQUESTION_VAL */ );

      418    20266    4         CALL ASH$DQUEST;

  20266  3 001075   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 001076   000000 701000 xent               TSX1    ASH$DQUEST
         3 001077   000000 011000                    NOP     0
         3 001100   001011 710000 3                  TRA     RETRY

      419    20267    4         SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */);

      420    20268    4         RETURN;

  20268  3 001101   200026 221300                    LDX1  ! FOUND+1,,AUTO
         3 001102   000001 702211                    TSX2  ! 1,X1

      421    20269    4         SELECT( 85 /* C_SET_VAL */ );

      422    20270    4         PTR$ = P$NODE.SUBLK$(0);

  20270  3 001103   000003 236100                    LDQ     3,,PR0
         3 001104   200027 756100                    STQ     PTR$,,AUTO

      423    20271    4         CALL CHARBIN (SETNUM, PTR$->OUT$SYM.TEXT);
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:60   

  20271  3 001105   200027 471500                    LDP1    PTR$,,AUTO
         3 001106   100004 236100                    LDQ     4,,PR1
         3 001107   000033 772000                    QRL     27
         3 001110   000000 620006                    EAX0    0,QL
         3 001111   000100 305540                    DTB
         3 001112   100004 230010                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X0
         3 001113   200034 000010                    NDSC9   PTR$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         3 001114   200035 235100                    LDA     PTR$+3,,AUTO
         3 001115   200030 755100                    STA     SETNUM,,AUTO

      424    20272    4         PTR$ = P$NODE.SUBLK$(1);

  20272  3 001116   000004 236100                    LDQ     4,,PR0
         3 001117   200027 756100                    STQ     PTR$,,AUTO

      425    20273    4         IF PTR$->P$NODE.SUBLK$(0)->OUT$SYM.COUNT ~= 24

  20273  3 001120   200027 471500                    LDP1    PTR$,,AUTO
         3 001121   100003 473500                    LDP3    3,,PR1
         3 001122   300004 236100                    LDQ     4,,PR3
         3 001123   777000 376003                    ANQ     -512,DU
         3 001124   030000 116003                    CMPQ    12288,DU
         3 001125   001133 600000 3                  TZE     s:20298

      426    20274    5         THEN DO;

      427    20275            /*E* ERROR: ASF-E$BADSETLENGTH-0
      428    20276                 MESSAGE: Bad length for a character set, it's not 24 characters.
      429    20277                 MESSAGE1: Each character set must be exactly 24 characters.
      430    20278            */
      431    20279        %SET LISTMAC='1'B;
      432    20280                 %SCREAM( ERR#=E$BADSETLENGTH,LEVEL=ERROR,MID='F');
             20281        %LSET LISTDIR='0'B;
             20292    5         CALL ASH$ERROR( %(ERR_CODE) );

  20292  3 001126   000017 630400 4                  EPPR0   15
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:61   
         3 001127   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001130   000000 701000 xent               TSX1    ASH$ERROR
         3 001131   000000 011000                    NOP     0

      433    20295        %SET LISTMAC='0'B;
      434    20296    5            END;

  20296  3 001132   001011 710000 3                  TRA     RETRY

      435    20297    5         ELSE DO;

      436    20298    5            FS$CHARSET.SETS (SETNUM) = PTR$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT;

  20298  3 001133   300004 236100                    LDQ     4,,PR3
         3 001134   000033 772000                    QRL     27
         3 001135   000000 620006                    EAX0    0,QL
         3 001136   200030 236100                    LDQ     SETNUM,,AUTO
         3 001137   000030 402007                    MPY     24,DL
         3 001140   200016 474500                    LDP4    F$,,AUTO
         3 001141   040106 100540                    MLR     fill='040'O
         3 001142   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         3 001143   400000 000030                    ADSC9   0,Q,PR4                  cn=0,n=24

      437    20299    5            END;

      438    20300    4         END; /* Do case */

      439    20301    3      END; /* Do while */

  20301  3 001144   001011 710000 3                  TRA     RETRY

      440    20302    2   END IMAGE;
      441    20303        %EJECT;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:62   
      442    20304        /*F*
      443    20305             NAME: DEVICES
      444    20306             PURPOSE:
      445    20307                  Handle the DEVICES response inside CHARSET_OPTS.
      446    20308             DESCRIPTION:
      447    20309                  Brings SUPER to the SUB* level and allow the devices to be
      448    20310                  modified by either setting them to YES or NO.
      449    20311                  YES is the default if a device is specified with no other
      450    20312                  field.
      451    20313        */
      452    20314    1   DEVICES: PROC;

  20314  3 001145   200026 741300       DEVICES      STX1  ! FOUND+1,,AUTO

      453    20315
      454    20316
      455    20317    2   DCL YES_NO BIT (1);
      456    20318    2   DCL SUBNODES UBIN;
      457    20319    2   DCL J UBIN;
      458    20320    2   DCL PTR$ PTR;
      459    20321
      460    20322    2   CALL ASB$SET_PROMPT ( %PROMPT_SUB );

  20322  3 001146   000015 630400 4                  EPPR0   13
         3 001147   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001150   000000 701000 xent               TSX1    ASB$SET_PROMPT
         3 001151   000000 011000                    NOP     0

      461    20323    2   P_PCB.ROOT$ = ADDR (CHARSET_DEVS_LIST);

  20323  3 001152   000020 236000 4                  LDQ     16
         3 001153   000001 756000 xsym               STQ     P_PCB+1

      462    20324    3   DO WHILE ( '1'B );

  20317  3 001154                       RETRY        null
      463    20325    3   RETRY: ;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:63   
      464    20326    3      CALL ASB$READ_SI( IN_BUF, ARS);

  20326  3 001154   200005 630500                    EPPR0   ARS,,AUTO
         3 001155   200035 450500                    STP0    PTR$+3,,AUTO
         3 001156   000012 236000 4                  LDQ     10
         3 001157   200034 756100                    STQ     PTR$+2,,AUTO
         3 001160   200034 630500                    EPPR0   PTR$+2,,AUTO
         3 001161   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001162   000000 701000 xent               TSX1    ASB$READ_SI
         3 001163   000000 011000                    NOP     0

      465    20327    3      P_PCB.NCHARS = ARS;

  20327  3 001164   200005 235100                    LDA     ARS,,AUTO
         3 001165   000011 755000 xsym               STA     P_PCB+9

      466    20328    3      CALL X$PARSE(P_PCB)

  20328  3 001166   000002 630400 4                  EPPR0   2
         3 001167   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001170   000000 701000 xent               TSX1    X$PARSE
         3 001171   001173 702000 3                  TSX2    s:20330
         3 001172   001200 710000 3                  TRA     s:20333

      467    20329    4      WHENALTRETURN DO;

      468    20330    4         CALL ASH$ERROR (P_PCB.ERROR);

  20330  3 001173   000003 630400 4                  EPPR0   3
         3 001174   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001175   000000 701000 xent               TSX1    ASH$ERROR
         3 001176   000000 011000                    NOP     0

      469    20331    4         GOTO RETRY;

  20331  3 001177   001154 710000 3                  TRA     RETRY

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:64   
      470    20332    4         END;
      471    20333    3      NODE$ = P_PCB.OUT$;

  20333  3 001200   000003 236000 xsym               LDQ     P_PCB+3
         3 001201   000000 756000 xsym               STQ     NODE$

      472    20334    3      SUBNODES = P$NODE.SUBNODES;

  20334  3 001202   000000 470400 xsym               LDP0    NODE$
         3 001203   000001 236100                    LDQ     1,,PR0
         3 001204   000022 772000                    QRL     18
         3 001205   200030 756100                    STQ     SUBNODES,,AUTO

      473    20335    3      IF SUBNODES = 0

  20335  3 001206   001211 601000 3                  TNZ     s:20339

      474    20336    4      THEN DO;

      475    20337    4         RETURN;

  20337  3 001207   200026 221300                    LDX1  ! FOUND+1,,AUTO
         3 001210   000001 702211                    TSX2  ! 1,X1

      476    20338    4         END;
      477    20339    4      DO J = 0 TO SUBNODES-1;

  20339  3 001211   200031 450100                    STZ     J,,AUTO
         3 001212   001406 710000 3                  TRA     s:20394+3

      478    20340    4         PTR$ = P$NODE.SUBLK$ (J);

  20340  3 001213   000000 470400 xsym               LDP0    NODE$
         3 001214   200031 720100                    LXL0    J,,AUTO
         3 001215   000003 236110                    LDQ     3,X0,PR0
         3 001216   200032 756100                    STQ     PTR$,,AUTO

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:65   
      479    20341    4         CODE = PTR$->P$NODE.CODE;

  20341  3 001217   200032 471500                    LDP1    PTR$,,AUTO
         3 001220   100000 236100                    LDQ     0,,PR1
         3 001221   777777 376007                    ANQ     -1,DL
         3 001222   000000 756000 xsym               STQ     CODE

      480    20342    4         IF ((CODE = 98 /* C_DEV_LP */) OR

  20342  3 001223   000142 116007                    CMPQ    98,DL
         3 001224   001231 600000 3                  TZE     s:20346
         3 001225   000143 116007                    CMPQ    99,DL
         3 001226   001231 600000 3                  TZE     s:20346
         3 001227   000144 116007                    CMPQ    100,DL
         3 001230   001246 601000 3                  TNZ     s:20360

      481    20343    4              (CODE = 99 /* C_DEV_TS */) OR
      482    20344    4              (CODE = 100 /* C_DEV_ELS */))
      483    20345    5         THEN DO;

      484    20346    5            IF PTR$->P$NODE.SUBNODES = 0

  20346  3 001231   100001 221100                    LDX1    1,,PR1
         3 001232   001236 601000 3                  TNZ     s:20351

      485    20347    6            THEN DO;

      486    20348    6               YES_NO = '1'B;

  20348  3 001233   400000 236003                    LDQ     -131072,DU
         3 001234   200027 756100                    STQ     YES_NO,,AUTO

      487    20349    6               END;

  20349  3 001235   001246 710000 3                  TRA     s:20360

      488    20350    6            ELSE DO;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:66   

      489    20351    6               IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE = 1   /*  YES_VAL  */

  20351  3 001236   100003 473500                    LDP3    3,,PR1
         3 001237   300000 722100                    LXL2    0,,PR3
         3 001240   000001 102003                    CMPX2   1,DU
         3 001241   001245 601000 3                  TNZ     s:20356

      490    20352    7               THEN DO;

      491    20353    7                  YES_NO = '1'B;

  20353  3 001242   400000 236003                    LDQ     -131072,DU
         3 001243   200027 756100                    STQ     YES_NO,,AUTO

      492    20354    7                  END;

  20354  3 001244   001246 710000 3                  TRA     s:20360

      493    20355    7               ELSE DO;

      494    20356    7                  YES_NO = '0'B;

  20356  3 001245   200027 450100                    STZ     YES_NO,,AUTO

      495    20357    7                  END;

      496    20358    6               END;

      497    20359    5            END;

      498    20360    5         DO SELECT (CODE);

  20360  3 001246   000000 236000 xsym               LDQ     CODE
         3 001247   000454 116007                    CMPQ    300,DL
         3 001250   001260 602000 3                  TNC     s:20360+10
         3 001251   001312 600000 3                  TZE     s:20366
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:67   
         3 001252   000455 116007                    CMPQ    301,DL
         3 001253   001403 602000 3                  TNC     s:20394
         3 001254   001306 600000 3                  TZE     s:20364
         3 001255   000456 116007                    CMPQ    302,DL
         3 001256   001403 601000 3                  TNZ     s:20394
         3 001257   001302 710000 3                  TRA     s:20362
         3 001260   000143 116007                    CMPQ    99,DL
         3 001261   001271 602000 3                  TNC     s:20360+19
         3 001262   001327 600000 3                  TZE     s:20372
         3 001263   000144 116007                    CMPQ    100,DL
         3 001264   001403 602000 3                  TNC     s:20394
         3 001265   001336 600000 3                  TZE     s:20374
         3 001266   000145 116007                    CMPQ    101,DL
         3 001267   001403 601000 3                  TNZ     s:20394
         3 001270   001345 710000 3                  TRA     s:20376
         3 001271   000032 116007                    CMPQ    26,DL
         3 001272   001277 602000 3                  TNC     s:20360+25
         3 001273   001316 600000 3                  TZE     s:20368
         3 001274   000142 116007                    CMPQ    98,DL
         3 001275   001403 601000 3                  TNZ     s:20394
         3 001276   001320 710000 3                  TRA     s:20370
         3 001277   000014 116007                    CMPQ    12,DL
         3 001300   001403 601000 3                  TNZ     s:20394
         3 001301   001316 710000 3                  TRA     s:20368

      499    20361    5            SELECT( 302 /* HELP_VAL */ );

      500    20362    5            CALL ASH$HELP;

  20362  3 001302   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 001303   000000 701000 xent               TSX1    ASH$HELP
         3 001304   000000 011000                    NOP     0
         3 001305   001403 710000 3                  TRA     s:20394

      501    20363    5            SELECT( 301 /* QUESTION_VAL */ );

      502    20364    5            CALL ASH$QUEST;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:68   

  20364  3 001306   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 001307   000000 701000 xent               TSX1    ASH$QUEST
         3 001310   000000 011000                    NOP     0
         3 001311   001403 710000 3                  TRA     s:20394

      503    20365    5            SELECT( 300 /* DQUESTION_VAL */ );

      504    20366    5            CALL ASH$DQUEST;

  20366  3 001312   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 001313   000000 701000 xent               TSX1    ASH$DQUEST
         3 001314   000000 011000                    NOP     0
         3 001315   001403 710000 3                  TRA     s:20394

      505    20367    5            SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */);

      506    20368    5            RETURN;

  20368  3 001316   200026 221300                    LDX1  ! FOUND+1,,AUTO
         3 001317   000001 702211                    TSX2  ! 1,X1

      507    20369    5            SELECT(98 /* C_DEV_LP */);

      508    20370    5            FS$CHARSET.LGLTYPS.LPOK = YES_NO;

  20370  3 001320   200016 473500                    LDP3    F$,,AUTO
         3 001321   200027 236100                    LDQ     YES_NO,,AUTO
         3 001322   000022 772000                    QRL     18
         3 001323   300074 676100                    ERQ     60,,PR3
         3 001324   400000 376007                    ANQ     -131072,DL
         3 001325   300074 656100                    ERSQ    60,,PR3
         3 001326   001403 710000 3                  TRA     s:20394

      509    20371    5            SELECT (99 /* C_DEV_TS */);

      510    20372    5            FS$CHARSET.LGLTYPS.TSOK = YES_NO;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:69   

  20372  3 001327   200016 473500                    LDP3    F$,,AUTO
         3 001330   200027 236100                    LDQ     YES_NO,,AUTO
         3 001331   000023 772000                    QRL     19
         3 001332   300074 676100                    ERQ     60,,PR3
         3 001333   200000 376007                    ANQ     65536,DL
         3 001334   300074 656100                    ERSQ    60,,PR3
         3 001335   001403 710000 3                  TRA     s:20394

      511    20373    5            SELECT (100 /* C_DEV_ELS */);

      512    20374    5            FS$CHARSET.LGLTYPS.ELSOK = YES_NO;

  20374  3 001336   200016 473500                    LDP3    F$,,AUTO
         3 001337   200027 236100                    LDQ     YES_NO,,AUTO
         3 001340   000024 772000                    QRL     20
         3 001341   300074 676100                    ERQ     60,,PR3
         3 001342   100000 376007                    ANQ     32768,DL
         3 001343   300074 656100                    ERSQ    60,,PR3
         3 001344   001403 710000 3                  TRA     s:20394

      513    20375    5            SELECT (101 /* C_DEV_LTYP */);

      514    20376    5            IF PTR$->P$NODE.SUBNODES = 0

  20376  3 001345   100001 221100                    LDX1    1,,PR1
         3 001346   001356 601000 3                  TNZ     s:20382

      515    20377    6            THEN DO;

      516    20378    6               FS$CHARSET.LGLTYPS.LTYP = '  ';

  20378  3 001347   200016 473500                    LDP3    F$,,AUTO
         3 001350   040100 100400                    MLR     fill='040'O
         3 001351   000003 000002 2                  ADSC9   3                        cn=0,n=2
         3 001352   300074 600002                    ADSC9   60,,PR3                  cn=3,n=2

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:70   
      517    20379    6               FS$CHARSET.LGLTYPS.ONEOK = '0'B;

  20379  3 001353   000021 236000 4                  LDQ     17
         3 001354   300074 356100                    ANSQ    60,,PR3

      518    20380    6               END;

  20380  3 001355   001403 710000 3                  TRA     s:20394

      519    20381    6            ELSE DO;

      520    20382    6               IF SUBSTR(PTR$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT,0,2) = 'NO'

  20382  3 001356   100003 473500                    LDP3    3,,PR1
         3 001357   300004 236100                    LDQ     4,,PR3
         3 001360   000033 772000                    QRL     27
         3 001361   040000 106500                    CMPC    fill='040'O
         3 001362   300004 200002                    ADSC9   4,,PR3                   cn=1,n=2
         3 001363   000031 000002 2                  ADSC9   25                       cn=0,n=2
         3 001364   001374 601000 3                  TNZ     s:20388

      521    20383    7               THEN DO;

      522    20384    7                  FS$CHARSET.LGLTYPS.LTYP = '  ';

  20384  3 001365   200016 474500                    LDP4    F$,,AUTO
         3 001366   040100 100400                    MLR     fill='040'O
         3 001367   000003 000002 2                  ADSC9   3                        cn=0,n=2
         3 001370   400074 600002                    ADSC9   60,,PR4                  cn=3,n=2

      523    20385    7                  FS$CHARSET.LGLTYPS.ONEOK = '0'B;

  20385  3 001371   000021 236000 4                  LDQ     17
         3 001372   400074 356100                    ANSQ    60,,PR4

      524    20386    7                  END;

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:71   
  20386  3 001373   001403 710000 3                  TRA     s:20394

      525    20387    7               ELSE DO;

      526    20388    7                  FS$CHARSET.LGLTYPS.LTYP =

  20388  3 001374   000000 622006                    EAX2    0,QL
         3 001375   200016 474500                    LDP4    F$,,AUTO
         3 001376   040100 100540                    MLR     fill='040'O
         3 001377   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         3 001400   400074 600002                    ADSC9   60,,PR4                  cn=3,n=2

      527    20389    7                       PTR$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT;
      528    20390    7                  FS$CHARSET.LGLTYPS.ONEOK = '1'B;

  20390  3 001401   040000 236007                    LDQ     16384,DL
         3 001402   400074 256100                    ORSQ    60,,PR4

      529    20391    7                  END;

      530    20392    6               END;

      531    20393    5            END; /* Do case */

      532    20394    4         END; /* Do j */

  20394  3 001403   200031 235100                    LDA     J,,AUTO
         3 001404   000001 035007                    ADLA    1,DL
         3 001405   200031 755100                    STA     J,,AUTO
         3 001406   200031 236100                    LDQ     J,,AUTO
         3 001407   200030 116100                    CMPQ    SUBNODES,,AUTO
         3 001410   001213 602000 3                  TNC     s:20340

      533    20395    3      END; /* Do while */

  20395  3 001411   001154 710000 3                  TRA     RETRY
      534    20396    2   END DEVICES;
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:72   
      535    20397    1   END ASC$CHARSET;

PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:73   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
      No diagnostics issued in procedure ASC$CHARSET.
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:74   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w UBIN        r     1 ARS                       15-0-0/w PTR         r     1 BLK$
     7-0-0/w STRC(189)   r     1 CHARSET_KEY                3-0-0/b BIT         r     1 CREATE
    16-0-0/w PTR         r     1 F$                        25-0-0/w UBIN        r     1 FOUND
     4-0-0/b BIT         r     1 FROM                      21-0-0/w UBIN        r     1 J
    31-0-0/w UBIN        r     1 J                         22-0-0/w PTR         r     1 PTR$
    27-0-0/w PTR         r     1 PTR$                      32-0-0/w PTR         r     1 PTR$
    30-0-0/w UBIN        r     1 SETNUM                    23-0-0/w UBIN        r     1 SUBNODES
    30-0-0/w UBIN        r     1 SUBNODES                   6-0-0/w UBIN        r     1 SUBS
    24-0-0/b BIT         r     1 WARN                      27-0-0/b BIT         r     1 YES_NO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 AS_FALSE                   0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/w STRC(369)   r     1 AS_FIELD2                  0-0-0/b BIT         r     1 AS_TRUE
     0-0-0/w UBIN        r     1 CHARSET_CMD                0-0-0/w UBIN        r     1 CHARSET_DEVS_LIST
     0-0-0/w UBIN        r     1 CHARSET_IMAGE_LIST         0-0-0/w UBIN        r     1 CHARSET_OPT_LIST
     0-0-0/w UBIN        r     1 CODE                       0-0-0/w PTR         r     1 DSEG1$
     0-0-0/b BIT         r     1 DSEG_FLG                   0-0-0/c STRC(189)   r     1 FROM_KEY
     0-0-0/c CHAR(255)   r     1 IN_BUF                     0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2232)  r     1 FS$CHARSET                 0-0-0/w ASTR(153)   r     1 OUT$SYM
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:75   
     0-0-0/w STRC(144)   r     1 P$NODE


   Procedure ASC$CHARSET requires 778 words for executable code.
   Procedure ASC$CHARSET requires 32 words of local(AUTO) storage.

    No errors detected in file ASC$CHARSET.:E05TSI    .
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:76   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:77   
          MINI XREF LISTING

ARS
     19746**DCL     19920<<ASSIGN  19921<>CALL    20009<>CALL    20038<<ASSIGN  20039<>CALL    20078<>CALL
     20079>>ASSIGN  20251<>CALL    20252>>ASSIGN  20326<>CALL    20327>>ASSIGN
ASA_BRKS_LOC
     16826**DCL     16826--REDEF
ASB$GETSEG
     19739**DCL-ENT 19855--CALL
ASB$READ_SI
     19736**DCL-ENT 20078--CALL    20251--CALL    20326--CALL
ASB$SET_PROMPT
     19742**DCL-ENT 20077--CALL    20247--CALL    20322--CALL
ASF$READ_FORM
     19730**DCL-ENT 19921--CALL    20009--CALL
ASF$WRITE_FORM
     19733**DCL-ENT 20039--CALL
ASH$DQUEST
     19727**DCL-ENT 20095--CALL    20266--CALL    20366--CALL
ASH$ERROR
     19712**DCL-ENT 19869--CALL    19879--CALL    19915--CALL    19942--CALL    19999--CALL    20029--CALL
     20083--CALL    20255--CALL    20292--CALL    20330--CALL
ASH$HELP
     19721**DCL-ENT 20091--CALL    20262--CALL    20362--CALL
ASH$INFO
     19718**DCL-ENT 19964--CALL
ASH$QUEST
     19724**DCL-ENT 20093--CALL    20264--CALL    20364--CALL
ASH$WARN
     19715**DCL-ENT 20220--CALL
AS_DEFAULT.BANNER_PERM
     17519**DCL     17520--REDEF
AS_DEFAULT.BUDGET.MACCT
     17424**DCL     17428--REDEF
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:78   
AS_DEFAULT.BUDGET.MAX_PROJECTS
     17437**DCL     17440--REDEF
AS_DEFAULT.BUDGET.PACCUM
     17420**DCL     17422--REDEF
AS_DEFAULT.BUDGET.PMAXC
     17415**DCL     17417--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     17535**DCL     17536--REDEF   17537--REDEF
AS_DEFAULT_DREC.PASSWORD
     18789**DCL     18793--REDEF
AS_DEFAULT_DREC.RENAME
     18812**DCL     18813--REDEF
AS_DFLT.BANNER_PERM
     17341**DCL     17342--REDEF
AS_DFLT.BUDGET.MACCT
     17246**DCL     17250--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     17259**DCL     17262--REDEF
AS_DFLT.BUDGET.PACCUM
     17242**DCL     17244--REDEF
AS_DFLT.BUDGET.PMAXC
     17237**DCL     17239--REDEF
AS_DFLT.SETUP_CHRA.TXT
     17357**DCL     17358--REDEF   17359--REDEF
AS_FALSE
     16686**DCL     19888>>ASSIGN  19974>>ASSIGN  20104>>ASSIGN  20106>>ASSIGN
AS_FE_MODE
     16692**DCL     16693--REDEF
AS_FIELD1.COUNT
     16823**DCL     19901<<ASSIGN  19928<<ASSIGN  19954<<ASSIGN  19985<<ASSIGN  20015<<ASSIGN  20122<<ASSIGN
     20141<<ASSIGN  20156<<ASSIGN  20171<<ASSIGN  20186<<ASSIGN
AS_FIELD1.TEXT
     16823**DCL     19902<<ASSIGN  19929<<ASSIGN  19955<<ASSIGN  19986<<ASSIGN  20016<<ASSIGN  20121<<ASSIGN
     20140<<ASSIGN  20155<<ASSIGN  20170<<ASSIGN  20185<<ASSIGN
AS_FIELD2.COUNT
     16823**DCL     20127<<ASSIGN  20146<<ASSIGN  20161<<ASSIGN  20176<<ASSIGN  20191<<ASSIGN
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:79   
AS_FIELD2.TEXT
     16823**DCL     20126<<ASSIGN  20145<<ASSIGN  20160<<ASSIGN  20175<<ASSIGN  20190<<ASSIGN
AS_MODE
     16689**DCL     16691--REDEF
AS_MOD_USER.ACCESS
     19554**DCL     19555--REDEF
AS_MOD_USER.BANNER
     19541**DCL     19542--REDEF
AS_MOD_USER.BANNER_PERM
     19543**DCL     19544--REDEF
AS_MOD_USER.BILL
     19549**DCL     19550--REDEF
AS_MOD_USER.CPROC
     19545**DCL     19546--REDEF
AS_MOD_USER.FEBILL
     19625**DCL     19626--REDEF
AS_MOD_USER.FECXTMEM
     19642**DCL     19643--REDEF
AS_MOD_USER.FEMINTS
     19627**DCL     19628--REDEF
AS_MOD_USER.FEMMEM
     19638**DCL     19639--REDEF
AS_MOD_USER.FEMTIME
     19636**DCL     19637--REDEF
AS_MOD_USER.FEPPRIV
     19633**DCL     19635--REDEF
AS_MOD_USER.FEPRIV
     19630**DCL     19632--REDEF
AS_MOD_USER.FORCE_BIT
     19539**DCL     19540--REDEF
AS_MOD_USER.KEY
     19621**DCL     19623--REDEF
AS_MOD_USER.LASTCPROC
     19547**DCL     19548--REDEF
AS_MOD_USER.LIMITS.DO_
     19595**DCL     19596--REDEF
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:80   
AS_MOD_USER.LIMITS.FPOOLS
     19611**DCL     19612--REDEF
AS_MOD_USER.LIMITS.LO
     19591**DCL     19592--REDEF
AS_MOD_USER.LIMITS.MEM
     19587**DCL     19588--REDEF
AS_MOD_USER.LIMITS.MPRIO
     19615**DCL     19616--REDEF
AS_MOD_USER.LIMITS.PDIS
     19603**DCL     19604--REDEF
AS_MOD_USER.LIMITS.PO
     19599**DCL     19600--REDEF
AS_MOD_USER.LIMITS.TDIS
     19607**DCL     19608--REDEF
AS_MOD_USER.LIMITS.TIME
     19583**DCL     19584--REDEF
AS_MOD_USER.MAXENQ
     19564**DCL     19565--REDEF
AS_MOD_USER.PERM_BIT
     19537**DCL     19538--REDEF
AS_MOD_USER.PPRIV
     19559**DCL     19561--REDEF
AS_MOD_USER.PRIOB
     19566**DCL     19567--REDEF
AS_MOD_USER.PRIV
     19556**DCL     19558--REDEF
AS_MOD_USER.QUAN
     19562**DCL     19563--REDEF
AS_MOD_USER.SETUP
     19535**DCL     19536--REDEF
AS_PROJECT.BANNER_PERM
     17875**DCL     17876--REDEF
AS_PROJECT.BUDGET.MACCT
     17780**DCL     17784--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     17793**DCL     17796--REDEF
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:81   
AS_PROJECT.BUDGET.PACCUM
     17776**DCL     17778--REDEF
AS_PROJECT.BUDGET.PMAXC
     17771**DCL     17773--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     17891**DCL     17892--REDEF   17893--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     18053**DCL     18054--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     17958**DCL     17962--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     17971**DCL     17974--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     17954**DCL     17956--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     17949**DCL     17951--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     18069**DCL     18070--REDEF   18071--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     19275**DCL     19279--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     19298**DCL     19299--REDEF
AS_PROJECT_DREC.PASSWORD
     19113**DCL     19117--REDEF
AS_PROJECT_DREC.RENAME
     19136**DCL     19137--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     17697**DCL     17698--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     17602**DCL     17606--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     17615**DCL     17618--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     17598**DCL     17600--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     17593**DCL     17595--REDEF
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:82   
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     17713**DCL     17714--REDEF   17715--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     18951**DCL     18955--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     18974**DCL     18975--REDEF
AS_TRUE
     16686**DCL     19885>>ASSIGN  19971>>ASSIGN  19982>>ASSIGN  20075>>DOWHILE 20125>>ASSIGN  20144>>ASSIGN
     20159>>ASSIGN  20174>>ASSIGN  20189>>ASSIGN
AS_USERS.BANNER_PERM
     17163**DCL     17164--REDEF
AS_USERS.BUDGET.MACCT
     17068**DCL     17072--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     17081**DCL     17084--REDEF
AS_USERS.BUDGET.PACCUM
     17064**DCL     17066--REDEF
AS_USERS.BUDGET.PMAXC
     17059**DCL     17061--REDEF
AS_USERS.SETUP_CHRA.TXT
     17179**DCL     17180--REDEF   17181--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     18231**DCL     18232--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     18136**DCL     18140--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     18149**DCL     18152--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     18132**DCL     18134--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     18127**DCL     18129--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     18247**DCL     18248--REDEF   18249--REDEF
BLK$
     19839**DCL     19808--IMP-PTR 19890<<ASSIGN  19893>>CALLBLT 19893>>CALLBLT 19894>>ASSIGN  19895>>IF
     19901>>ASSIGN  19902>>ASSIGN  19902>>ASSIGN  19928>>ASSIGN  19929>>ASSIGN  19929>>ASSIGN  19954>>ASSIGN
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:83   
     19955>>ASSIGN  19955>>ASSIGN  19979<<ASSIGN  19980>>CALLBLT 19980>>CALLBLT 19981>>ASSIGN  19983>>IF
     19985>>ASSIGN  19986>>ASSIGN  19986>>ASSIGN
CHARSET_CMD
     19842**DCL     19876--ASSIGN
CHARSET_DEVS_LIST
     19845**DCL     20323--ASSIGN
CHARSET_IMAGE_LIST
     19844**DCL     20248--ASSIGN
CHARSET_KEY
     19752**DCL     19892>>ASSIGN  19921<>CALL    20039<>CALL
CHARSET_KEY.CNT
     19753**DCL     19894<<ASSIGN
CHARSET_KEY.TEXT
     19754**DCL     19891<<ASSIGN  19893<<CALLBLT
CHARSET_OPTS
     20067**PROC    20036--CALL
CHARSET_OPT_LIST
     19843**DCL     20080--ASSIGN
CODE
     16819**DCL     20088<<ASSIGN  20089>>DOSELCT 20109<<ASSIGN  20110>>DOSELCT 20119>>ASSIGN  20138>>ASSIGN
     20153>>ASSIGN  20168>>ASSIGN  20183>>ASSIGN  20259<<ASSIGN  20260>>DOSELCT 20341<<ASSIGN  20342>>IF
     20342>>IF      20342>>IF      20360>>DOSELCT
CREATE
     19744**DCL     19885<<ASSIGN  19888<<ASSIGN  19923>>IF      19949>>IF      19971<<ASSIGN  19975>>IF
DEVICES
     20314**PROC    20101--CALL
DSEG1$
     16827**DCL     19875>>ASSIGN
DSEG_FLG
     16827**DCL     19854>>IF
ERR_CODE
     16821**DCL     16822--REDEF
F$
     19840**DCL     19688--IMP-PTR 19875<<ASSIGN  19921<>CALL    20009<>CALL    20039<>CALL    20106>>ASSIGN
     20113>>ASSIGN  20113>>ASSIGN  20120>>ASSIGN  20120>>ASSIGN  20132>>ASSIGN  20132>>ASSIGN  20139>>ASSIGN
     20139>>ASSIGN  20154>>ASSIGN  20154>>ASSIGN  20169>>ASSIGN  20169>>ASSIGN  20184>>ASSIGN  20184>>ASSIGN
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:84   
     20196>>ASSIGN  20196>>ASSIGN  20298>>ASSIGN  20370>>ASSIGN  20372>>ASSIGN  20374>>ASSIGN  20378>>ASSIGN
     20379>>ASSIGN  20384>>ASSIGN  20385>>ASSIGN  20388>>ASSIGN  20390>>ASSIGN
FOUND IN PROCEDURE CHARSET_OPTS
     20073**DCL     20105<<ASSIGN  20117>>IF      20119<<ASSIGN  20136>>IF      20136>>IF      20138<<ASSIGN
     20151>>IF      20153<<ASSIGN  20166>>IF      20166>>IF      20168<<ASSIGN  20181>>IF      20183<<ASSIGN
FROM
     19745**DCL     19974<<ASSIGN  19982<<ASSIGN
FROM_KEY
     16700**DCL     19892<<ASSIGN  20009<>CALL
FROM_KEY.CNT
     16700**DCL     19981<<ASSIGN  20006<<ASSIGN  20015>>ASSIGN
FROM_KEY.TEXT
     16700**DCL     19980<<CALLBLT 20007<<ASSIGN  20016>>ASSIGN
FS$CHARSET
     19688**DCL     19920--ASSIGN  20038--ASSIGN
FS$CHARSET.ATTRS
     19700**DCL     20106<<ASSIGN  20113<<ASSIGN  20113>>ASSIGN  20120<<ASSIGN  20120>>ASSIGN  20132<<ASSIGN
     20132>>ASSIGN  20139<<ASSIGN  20139>>ASSIGN  20154<<ASSIGN  20154>>ASSIGN  20169<<ASSIGN  20169>>ASSIGN
     20184<<ASSIGN  20184>>ASSIGN  20196<<ASSIGN  20196>>ASSIGN
FS$CHARSET.LGLTYPS.ELSOK
     19704**DCL     20374<<ASSIGN
FS$CHARSET.LGLTYPS.LPOK
     19702**DCL     20370<<ASSIGN
FS$CHARSET.LGLTYPS.LTYP
     19707**DCL     20378<<ASSIGN  20384<<ASSIGN  20388<<ASSIGN
FS$CHARSET.LGLTYPS.ONEOK
     19705**DCL     20379<<ASSIGN  20385<<ASSIGN  20390<<ASSIGN
FS$CHARSET.LGLTYPS.TSOK
     19703**DCL     20372<<ASSIGN
FS$CHARSET.SETS
     19689**DCL     19699--REDEF   20298<<ASSIGN
IMAGE
     20241**PROC    20099--CALL
IN_BUF
     16817**DCL     20078<>CALL    20251<>CALL    20326<>CALL
J IN PROCEDURE CHARSET_OPTS
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:85   
     20069**DCL     20107<<DOINDEX 20108>>ASSIGN
J IN PROCEDURE DEVICES
     20319**DCL     20339<<DOINDEX 20340>>ASSIGN
KL_DEFAULT.PASSWORD
     19437**DCL     19441--REDEF
KL_DEFAULT.RENAME
     19460**DCL     19461--REDEF
KL_DFLT.PASSWORD
     18627**DCL     18631--REDEF
KL_DFLT.RENAME
     18650**DCL     18651--REDEF
KL_DREC.PASSWORD
     18465**DCL     18469--REDEF
KL_DREC.RENAME
     18488**DCL     18489--REDEF
KL_DREC_CNT.PASSWORD
     18352**DCL     18356--REDEF
KL_DREC_CNT.RENAME
     18375**DCL     18376--REDEF
NODE$
     16819**DCL     19762--IMP-PTR 19882<<ASSIGN  19883>>IF      19890>>ASSIGN  19973>>ASSIGN  19977>>IF
     19979>>ASSIGN  20086<<ASSIGN  20087>>ASSIGN  20088>>ASSIGN  20108>>ASSIGN  20258<<ASSIGN  20259>>ASSIGN
     20270>>ASSIGN  20272>>ASSIGN  20333<<ASSIGN  20334>>ASSIGN  20340>>ASSIGN
OUT$SYM.COUNT
     19831**DCL     19834--IMP-SIZ 19893>>CALLBLT 19894>>ASSIGN  19895>>IF      19901>>ASSIGN  19902>>ASSIGN
     19928>>ASSIGN  19929>>ASSIGN  19954>>ASSIGN  19955>>ASSIGN  19980>>CALLBLT 19981>>ASSIGN  19983>>IF
     19985>>ASSIGN  19986>>ASSIGN  20271>>CALLBLT 20273>>IF      20298>>ASSIGN  20382>>IF      20388>>ASSIGN
OUT$SYM.TEXT
     19834**DCL     19893>>CALLBLT 19902>>ASSIGN  19929>>ASSIGN  19955>>ASSIGN  19980>>CALLBLT 19986>>ASSIGN
     20271>>CALLBLT 20298>>ASSIGN  20382>>IF      20388>>ASSIGN
P$NODE.CODE
     19770**DCL     19883>>IF      19977>>IF      20088>>ASSIGN  20109>>ASSIGN  20259>>ASSIGN  20341>>ASSIGN
     20351>>IF
P$NODE.SUBLK$
     19795**DCL     19890>>ASSIGN  19890>>ASSIGN  19977>>IF      19979>>ASSIGN  19979>>ASSIGN  20108>>ASSIGN
     20270>>ASSIGN  20272>>ASSIGN  20273>>IF      20298>>ASSIGN  20298>>ASSIGN  20340>>ASSIGN  20351>>IF
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:86   
     20382>>IF      20382>>IF      20388>>ASSIGN  20388>>ASSIGN
P$NODE.SUBNODES
     19774**DCL     19973>>ASSIGN  20087>>ASSIGN  20334>>ASSIGN  20346>>IF      20376>>IF
PROJ_KEY.TEXT
     16699**DCL     16699--REDEF
PROJ_KEY.TXT.PROJECT
     16699**DCL     16699--REDEF
PTR$ IN PROCEDURE CHARSET_OPTS
     20070**DCL     20108<<ASSIGN  20109>>ASSIGN
PTR$ IN PROCEDURE DEVICES
     20320**DCL     20340<<ASSIGN  20341>>ASSIGN  20346>>IF      20351>>IF      20376>>IF      20382>>IF
     20382>>IF      20388>>ASSIGN  20388>>ASSIGN
PTR$ IN PROCEDURE IMAGE
     20244**DCL     20270<<ASSIGN  20271>>CALLBLT 20271>>CALLBLT 20272<<ASSIGN  20273>>IF      20298>>ASSIGN
     20298>>ASSIGN
P_PCB
     16854**DCL     19877<>CALL    20081<>CALL    20253<>CALL    20328<>CALL
P_PCB.ERROR
     16958**DCL     19879<>CALL    20083<>CALL    20255<>CALL    20330<>CALL
P_PCB.NCHARS
     17001**DCL     20079<<ASSIGN  20252<<ASSIGN  20327<<ASSIGN
P_PCB.OUT$
     16867**DCL     19882>>ASSIGN  20086>>ASSIGN  20258>>ASSIGN  20333>>ASSIGN
P_PCB.ROOT$
     16859**DCL     19876<<ASSIGN  20080<<ASSIGN  20248<<ASSIGN  20323<<ASSIGN
REMEM_VAR
     16825**DCL     16825--REDEF
REM_FCMD
     16825**DCL     16826--REDEF
RETRY IN PROCEDURE CHARSET_OPTS
     20073**LABEL   20084--GOTO
RETRY IN PROCEDURE DEVICES
     20317**LABEL   20331--GOTO
RETRY IN PROCEDURE IMAGE
     20248**LABEL   20256--GOTO
SETNUM IN PROCEDURE IMAGE
PL6.E3A0      #001=ASC$CHARSET File=ASC$CHARSET.:E05TSI                          TUE 07/29/97 09:31 Page:87   
     20245**DCL     20271<<CALLBLT 20298>>ASSIGN
SUBNODES IN PROCEDURE CHARSET_OPTS
     20071**DCL     20087<<ASSIGN  20107>>DOINDEX
SUBNODES IN PROCEDURE DEVICES
     20318**DCL     20334<<ASSIGN  20335>>IF      20339>>DOINDEX
SUBS
     19747**DCL     19973<<ASSIGN
USERS_KEY.TEXT
     16696**DCL     16697--REDEF   16697--REDEF   16697--REDEF   16698--REDEF
WARN IN PROCEDURE CHARSET_OPTS
     20072**DCL     20104<<ASSIGN  20125<<ASSIGN  20144<<ASSIGN  20159<<ASSIGN  20174<<ASSIGN  20189<<ASSIGN
     20202>>IF
X$PARSE
     19710**DCL-ENT 19877--CALL    20081--CALL    20253--CALL    20328--CALL
YES_NO IN PROCEDURE DEVICES
     20317**DCL     20348<<ASSIGN  20353<<ASSIGN  20356<<ASSIGN  20370>>ASSIGN  20372>>ASSIGN  20374>>ASSIGN
