VERSION E05

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:1    
        1        1        /*M* ASR$R_PROJECT - processes the REMOVE PROJECT command.   */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
       11       11              ECU=3,CSU=3,SDI=3                                           */
       12       12                                                              /**/
       13       13        ASR$R_PROJECT: PROC( KEY, P_COUNT, FACCOUNT_OPT );
       14       14
       15       15        /********************************************************************/
       16       16        /*    Parameters      parameters      parameters      parameters    */
       17       17        /********************************************************************/
       18       18
       19       19    1   DCL 1 KEY,
       20       20    1          2 COUNT UBIN BYTE UNAL,
       21       21    1          2 TEXT CHAR(41) ,
       22       22    1          2 SKEY REDEF TEXT,
       23       23    1             3 PROJ UBIN BYTE UNAL,
       24       24    1             3 CREATOR CHAR(20) ,
       25       25    1             3 USER CHAR(20) ;
       26       26    1   DCL P_COUNT UBIN ;
       27       27    1   DCL FACCOUNT_OPT BIT(1) ALIGNED;
       28       28
       29       29        /********************************************************************/
       30       30        /*    Include files       include files       include files         */
       31       31        /********************************************************************/
       32       32
       33       33        %INCLUDE    AS_ENTRIES_M ;
       34     1083        %INCLUDE    AS_SUPER_C ;
       35     1518        %INCLUDE    AS_SUBS_C  ;
       36     2932        %INCLUDE    AS_MAC_C   ;
       37     3012        %INCLUDE    KL_SUPER_C ;
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:2    
       38     5914        %INCLUDE    XU_MACRO_C ;
       39     9020        %INCLUDE    XU_FORMAT_C ;
       40     9182        %INCLUDE    AS_PERR_C ;
       41     9784        %INCLUDE    AS_SUPER_R ;
       42    12800
       43    12801        /********************************************************************/
       44    12802        /*    Auto data       auto data       auto data       auto data     */
       45    12803        /********************************************************************/
       46    12804
       47    12805    1   DCL 1 SUB_PROJ_KEY ,
       48    12806    1          2 COUNT UBIN BYTE UNAL,
       49    12807    1          2 TEXT CHAR(41) ,
       50    12808    1          2 SKEY REDEF TEXT,
       51    12809    1             3 PROJ UBIN BYTE UNAL,
       52    12810    1             3 CREATOR CHAR(20) ,
       53    12811    1             3 USER CHAR(20) ;
       54    12812    1   DCL MORE BIT(1) ;
       55    12813    1   DCL I SBIN ;
       56    12814    1   DCL J SBIN ;
       57    12815    1   DCL K SBIN ;
       58    12816    1   DCL U_COUNT UBIN ;
       59    12817    1   DCL ARS UBIN;
       60    12818    1   DCL INITIAL_DSEG2SIZE UBIN;
       61    12819    1   DCL INITIAL_DSEG1SIZE UBIN;
       62    12820    1   DCL PROJ1$            PTR;
       63    12821    1   DCL PROJ2$            PTR;
       64    12822
       65    12823        /********************************************************************/
       66    12824        /*    Entry dcl       entry dcl       entry dcl       entry dcl     */
       67    12825        /********************************************************************/
       68    12826
       69    12827        %ASB$DELREC_USERS ;
       70    12830        %ASB$DELREC_HLP ;
       71    12833        %ASB$PREC_USERS ;
       72    12836        %ASB$ENQ ;
       73    12839        %ASB$ENQ_USERS ;
       74    12842        %ASB$READ_USERS_SEQ ;
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:3    
       75    12845        %ASH$INFO ;
       76    12848        %ASB$DEQ ;
       77    12851        %ASB$GETSEG ;
       78    12854        %ASB$ENQ_PROJ ;
       79    12857        %ASB$READ_PROJ_SEQ ;
       80    12860        %ASB$DELREC_PROJ ;
       81    12863        %ASB$WRITE_PROJ ;
       82    12866        %ASB$DEQ_PROJ ;
       83    12869        %ASH$ERROR ;
       84    12872        %ASB$PREC_PROJ ;
       85    12875        %ASB$FREE_SEG ;
       86    12878        %ASB$READ_PROJ ;
       87    12881        %ASB$GET_MORE_SEG ;
       88    12884        %ASB$PIG ;
       89    12887
       90    12888        /********************************************************************/
       91    12889        /*    Based data      based data      based data      based data    */
       92    12890        /********************************************************************/
       93    12891
       94    12892        %AS$PROJ( STCLASS="BASED(DSEG2$)" );
       95    12926        %AS$PROJ_HEADER( STCLASS=BASED  );
       96    12955        %AS$PROJ_ACCT_LIST( NAME=ACCT$LIST, STCLASS=BASED );
       97    12960        %SUPER_TO_PIG( VARY=NO, STCLASS="BASED(DSEG1$)" );
       98    12992
       99    12993
      100    12994        /********************************************************************/
      101    12995        /*    Procedure       procedure       procedure       procedure     */
      102    12996        /********************************************************************/
      103    12997
      104    12998
      105    12999
      106    13000    1   SUB_PROJ_KEY.SKEY.PROJ = 1 ;
      107    13001    1   SUB_PROJ_KEY.SKEY.CREATOR = KEY.SKEY.USER ;
      108    13002    1   SUB_PROJ_KEY.SKEY.USER = AS_BLANK ;
      109    13003    1   SUB_PROJ_KEY.COUNT = 21 ;
      110    13004    1   MORE = AS_TRUE ;
      111    13005    2   DO WHILE( MORE ) ;      /* Remove all sub-projects */
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:4    
      112    13006    2      USERS_KEY = SUB_PROJ_KEY;
      113    13007    2      CALL ASB$PREC_USERS ;           /* Position to last key */
      114    13008
      115    13009    2      CALL ASB$READ_USERS_SEQ( AS_USERS ) ALTRET( DONE_WITH_SUB_PROJS);
      116    13010    2      IF USERS_KEY.COUNT < 22 THEN MORE = AS_FALSE ;
      117    13011    2      ELSE
      118    13012    2         IF USERS_KEY.SKEY.CREATOR ~= SUB_PROJ_KEY.SKEY.CREATOR
      119    13013    2         THEN MORE = AS_FALSE ;
      120    13014    3         ELSE DO ;
      121    13015    3            SUB_PROJ_KEY = USERS_KEY ;
      122    13016    3            CALL ASR$R_PROJECT( SUB_PROJ_KEY, P_COUNT, FACCOUNT_OPT );
      123    13017    3            END ;
      124    13018    2      END ;       /* Do while( more ); */
      125    13019
      126    13020    1   DONE_WITH_SUB_PROJS: ;
      127    13021                                                  /* Remove all users in the project */
      128    13022    1   SUB_PROJ_KEY.SKEY.PROJ = 0 ;
      129    13023    1   SUB_PROJ_KEY.SKEY.USER = AS_BLANK ;
      130    13024    1   SUB_PROJ_KEY.COUNT = 21 ;
      131    13025    1   U_COUNT = 0 ;
      132    13026    1   MORE = AS_TRUE ;
      133    13027    2   DO WHILE( MORE ) ;
      134    13028    2      USERS_KEY = SUB_PROJ_KEY ;
      135    13029    2      CALL ASB$PREC_USERS ;           /* Position to last key */
      136    13030
      137    13031    2      CALL ASB$READ_USERS_SEQ( AS_USERS ) ALTRET( DONE_WITH_USERS ) ;
      138    13032    2      IF USERS_KEY.COUNT < 22 THEN MORE = AS_FALSE ;
      139    13033    2      ELSE
      140    13034    2         IF USERS_KEY.SKEY.PROJ ~= 0
      141    13035    2              OR USERS_KEY.SKEY.CREATOR ~= KEY.SKEY.USER
      142    13036    2         THEN MORE = AS_FALSE;
      143    13037    3         ELSE DO ;
      144    13038    3            CALL ASB$ENQ_USERS ALTRET( ENQ_ERR ) ;
      145    13039    3            CALL ASB$DELREC_USERS ;
      146    13040    3            SUB_PROJ_KEY = USERS_KEY ;
      147    13041    3            USERS_KEY.TXTC = SUB_PROJ_KEY.SKEY.USER ;
      148    13042    3            CALL INDEX( I, AS_BLANK, USERS_KEY.UKEY.UNAME );
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:5    
      149    13043    3            USERS_KEY.COUNT = 8 + I ;
      150    13044    3            CALL ASB$ENQ ALTRET( ENQ_ERR ) ;
      151    13045    3            CALL ASB$DELREC_USERS ;
      152    13046    3            CALL ASB$DELREC_HLP ;
      153    13047    3            CALL ASB$DEQ ;
      154    13048    3            U_COUNT = U_COUNT + 1 ;
      155    13049    3            END ;
      156    13050    2      END ;       /* Do while( more ); */
      157    13051
      158    13052    1   DONE_WITH_USERS: ;
      159    13053                                                  /* Now remove the project. */
      160    13054    1   USERS_KEY = KEY ;
      161    13055    1   CALL ASB$ENQ_USERS ALTRET( ENQ_ERR );
      162    13056    1   CALL ASB$DELREC_USERS ;
      163    13057    1   USERS_KEY.TXTC = KEY.SKEY.USER ;
      164    13058    1   CALL INDEX( J, AS_BLANK, USERS_KEY.UKEY.UNAME ) ;
      165    13059    1   USERS_KEY.COUNT = J + 8 ;
      166    13060    1   CALL ASB$ENQ ALTRET( ENQ_ERR );
      167    13061    1   CALL ASB$DELREC_USERS ;
      168    13062    1   CALL ASB$DELREC_HLP ;
      169    13063    1   USERS_KEY.COUNT = 21 ;
      170    13064    1   USERS_KEY.UKEY.S = 'S' ;
      171    13065    1   CALL ASB$ENQ ALTRET( ENQ_ERR );
      172    13066    1   CALL ASB$DELREC_USERS ;
      173    13067    1   CALL ASB$DELREC_HLP ;
      174    13068    1   CALL ASB$DEQ ;
      175    13069    1   ENQDEQ_FLG = AS_FALSE ;
      176    13070    1   P_COUNT = P_COUNT + 1 ;
      177    13071
      178    13072        /*E* ERROR:   ASR-E$PROJ_REMOVED-C
      179    13073             MESSAGE: Project "%U1" removed.  %U2 users removed.
      180    13074        */
      181    13075    1   CALL INDEX( I, AS_BLANK, USERS_KEY.UKEY.ACCT );
      182    13076    1   CALL CONCAT( AS_FIELD1.TEXT, SUBSTR(USERS_KEY.TXTC,0,I), ',',
      183    13077    1        SUBSTR(USERS_KEY.TXTC,8,J) ) ;
      184    13078    1   AS_FIELD1.COUNT = I + J + 1 ;
      185    13079        %NUMBER( NUM2=U_COUNT ) ;
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:6    
             13095    1         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, U_COUNT );
      186    13109        %SCREAM( ERR#=E$PROJ_REMOVED, MID='R', LEVEL=INFO ) ;
      187    13124        /*
      188    13125                                      Remove packset records from :PROJ
      189    13126        */
      190    13127    1   IF NOT DSEG_FLG THEN
      191    13128    1      CALL ASB$GETSEG
      192    13129    2      WHENALTRETURN DO;
      193    13130    2   GETSEG_ERR:
      194    13131              %SCREAM (ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='R' );
      195    13146    2         RETURN;
      196    13147    2         END;   /* Whenaltreturn from ASB$GETSEG  */
      197    13148    1   PROJ_KEY.COUNT = 20;
      198    13149    1   PROJ_KEY.TEXT = KEY.SKEY.USER;
      199    13150    1   CALL ASB$PREC_PROJ;
      200    13151    1   INITIAL_DSEG1SIZE = DSEG1SIZE;
      201    13152    1   INITIAL_DSEG2SIZE = DSEG2SIZE;
      202    13153    1   ARS = DSEG2SIZE;
      203    13154    1   CALL ASB$READ_PROJ_SEQ( DSEG2$, ARS, 2 ) ALTRET(FINISHED);
      204    13155    2   DO WHILE( PROJ_KEY.TXT.PROJECT = KEY.SKEY.USER );
      205    13156    3      IF FACCOUNT_OPT AND AS$PROJ.NUM_ACCTS > 0 THEN DO;
      206    13157                                              /* Delete file management accounts */
      207    13158    3         PROJ2$ = PINCRW( DSEG2$, SIZEW(AS$PROJ_HEADER)+(AS$PROJ.ATTRIBUTES.COUNT+5)/4
             13158                  );
      208    13159    3         SUPER_TO_PIG.TYPE = %DELETE_ACCT;
      209    13160    3         SUPER_TO_PIG.WIDTH = LO_WIDTH;
      210    13161    3         SUPER_TO_PIG.PROJ = (KEY.SKEY.CREATOR ~= AS_NONE.TEXT );
      211    13162    3         SUPER_TO_PIG.RESUPER = AS_LOGON_KEY.TEXT;
      212    13163    3         SUPER_TO_PIG.PROJECT_TEXT = KEY.SKEY.USER;
      213    13164    3         SUPER_TO_PIG.PACKSET = PROJ_KEY.TXT.PACKSET;
      214    13165    3         SUPER_TO_PIG.ATTR.COUNT = 0;
      215    13166    4         DO I = 0 TO AS$PROJ.NUM_ACCTS-1;
      216    13167    4            SUPER_TO_PIG.ACCT = PROJ2$->ACCT$LIST.ACCT(I);
      217    13168    4            CALL ASB$PIG( SUPER_TO_PIG );
      218    13169    4            END;
      219    13170    3         CALL ASB$READ_PROJ(DSEG2$,ARS,2) ALTRET(FINISHED);
      220    13171    3         END;
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:7    
      221    13172    2      CALL ASB$ENQ_PROJ;
      222    13173    2      IF AS$PROJ.CREATOR = AS_BLANK THEN
      223    13174    2         IF AS$PROJ.NUM_ACCTS = 0 THEN
      224    13175    2            CALL ASB$DELREC_PROJ;
      225    13176    3         ELSE DO;
      226    13177    3            AS$PROJ.PROJ_REMOVED = AS_TRUE;
      227    13178    3            AS$PROJ.MAX_NUM_ACCTS = 0;
      228    13179    3            AS$PROJ.MAX_NUM_GRANS = 0;
      229    13180    3            CALL ASB$WRITE_PROJ( DSEG2$, ARS );
      230    13181    3            END;
      231    13182    3      ELSE DO;
      232    13183    3         CALL ASB$DELREC_PROJ;
      233    13184    3         IF AS$PROJ.MAX_NUM_ACCTS > 0  OR  AS$PROJ.MAX_NUM_GRANS > 0
      234    13185    4         THEN DO;
      235    13186    4            PROJ_KEY.TXT.PROJECT = KEY.SKEY.CREATOR;
      236    13187    4            CALL ASB$ENQ_PROJ;
      237    13188    4            ARS = DSEG1SIZE;
      238    13189    4            CALL ASB$READ_PROJ( DSEG1$, ARS, 1 ) ALTRET(ALT);
      239    13190    4            DSEG1$->AS$PROJ.SUB_PROJ_ACCTS = DSEG1$->AS$PROJ.SUB_PROJ_ACCTS - DSEG2$->
             13190                     AS$PROJ.MAX_NUM_ACCTS;
      240    13191    4            DSEG1$->AS$PROJ.GRANS_ACCUM = DSEG1$->AS$PROJ.GRANS_ACCUM - DSEG2$->AS$PROJ
             13191                     .MAX_NUM_GRANS;
      241    13192    5            IF DSEG2$->AS$PROJ.NUM_ACCTS > 0 THEN DO;
      242    13193    5               PROJ1$ = PINCRW(DSEG1$,
      243    13194    5                    SIZEW(AS$PROJ_HEADER)
      244    13195    5                    + (DSEG1$->AS$PROJ.ATTRIBUTES.COUNT+5)/4 );
      245    13196    5               ARS = POFFC(PROJ1$,DSEG1$)+(DSEG1$->AS$PROJ.MAX_NUM_ACCTS
      246    13197    5                    * SIZEC(ACCT$LIST(0)) );
      247    13198    6               IF ARS > DSEG1SIZE THEN DO;
      248    13199    6                  J = ((ARS - DSEG1SIZE + 4095)/4096) * 4096;
      249    13200    6                  CALL ASB$GET_MORE_SEG( 1, J ) ALTRET(GETSEG_ERR);
      250    13201    6                  END;
      251    13202    5               PROJ2$ = PINCRW(DSEG2$, SIZEW(AS$PROJ_HEADER)+(DSEG2$->AS$PROJ.
             13202                        ATTRIBUTES.COUNT+5)/4 );
      252    13203    5               I = DSEG1$->AS$PROJ.NUM_ACCTS - 1;
      253    13204    5               J = DSEG2$->AS$PROJ.NUM_ACCTS - 1;
      254    13205    5               DSEG1$->AS$PROJ.NUM_ACCTS = DSEG1$->AS$PROJ.NUM_ACCTS + DSEG2$->AS$PROJ.
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:8    
             13205                        NUM_ACCTS;
      255    13206    5               DSEG1$->AS$PROJ.GRANS_ACCUM = DSEG1$->AS$PROJ.GRANS_ACCUM + DSEG2$->
             13206                        AS$PROJ.GRANS_ACCUM;
      256    13207    5               K = DSEG1$->AS$PROJ.NUM_ACCTS - 1;
      257    13208    6               DO WHILE( I >= 0  AND  J >= 0 );
      258    13209    7                  IF PROJ2$->ACCT$LIST(J) > PROJ1$->ACCT$LIST(I) THEN DO;
      259    13210    7                     PROJ1$->ACCT$LIST(K) = PROJ2$->ACCT$LIST(J);
      260    13211    7                     J = J - 1;
      261    13212    7                     END;
      262    13213    7                  ELSE DO;
      263    13214    7                     PROJ1$->ACCT$LIST(K) = PROJ1$->ACCT$LIST(I);
      264    13215    7                     I = I - 1;
      265    13216    7                     END;
      266    13217    6                  K = K - 1;
      267    13218    6                  END;
      268    13219    6               DO I = 0 TO J;
      269    13220    6                  PROJ1$->ACCT$LIST(I) = PROJ2$->ACCT$LIST(I);
      270    13221    6                  END;
      271    13222    5               END;
      272    13223    4            CALL ASB$WRITE_PROJ( DSEG1$, ARS );
      273    13224    4   ALT:     PROJ_KEY.TXT.PROJECT = KEY.SKEY.USER;
      274    13225    4            CALL ASB$PREC_PROJ;
      275    13226    4            END;
      276    13227    3         END;
      277    13228    2      CALL ASB$DEQ_PROJ;
      278    13229    2      ARS = DSEG2SIZE;
      279    13230    2      CALL ASB$READ_PROJ_SEQ( DSEG2$, ARS, 2 ) ALTRET(FINISHED);
      280    13231    2      END;
      281    13232    1   FINISHED:
      282    13233    1   ARS = DSEG1SIZE - INITIAL_DSEG1SIZE;
      283    13234    1   IF ARS > 0 THEN CALL ASB$FREE_SEG( 1, ARS );
      284    13235    1   ARS = DSEG2SIZE - INITIAL_DSEG2SIZE;
      285    13236    1   IF ARS > 0 THEN CALL ASB$FREE_SEG( 2, ARS );
      286    13237
      287    13238    1   ENQ_ERR:
      288    13239
      289    13240    1   RETURN ;
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:9    
      290    13241
      291    13242
      292    13243    1   END ASR$R_PROJECT ;

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:10   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
      No diagnostics issued in procedure ASR$R_PROJECT.

   Procedure ASR$R_PROJECT requires 593 words for executable code.
   Procedure ASR$R_PROJECT requires 32 words of local(AUTO) storage.

    No errors detected in file ASR$REMOVE_PROJECT.:E05TSI    .

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:11   

 Object Unit name= ASR$R_PROJECT                              File name= ASR$REMOVE_PROJECT.:E05TOU
 UTS= JUL 29 '97 10:50:47.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS      2      2  ASR$R_PROJECT
    2   Proc  even  none   593   1121  ASR$R_PROJECT
    3  RoData even  none    12     14  ASR$R_PROJECT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        3  ASR$R_PROJECT
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:12   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       0 ASB$PREC_USERS
 yes     yes           Std       0 ASB$DELREC_HLP
 yes     yes           Std       0 ASB$ENQ_USERS
         yes           Std       4 ASB$BINCHAR
 yes     yes           Std       0 ASB$ENQ
 yes     yes           Std       0 ASB$DEQ
 yes     yes           Std       0 ASB$PREC_PROJ
 yes     yes           Std       3 ASB$READ_PROJ_SEQ
 yes     yes           Std       1 ASB$PIG
 yes     yes           Std       0 ASB$DELREC_PROJ
 yes     yes           Std       1 ASB$READ_USERS_SEQ
 yes     yes           Std       0 ASB$DELREC_USERS
 yes     yes           Std       0 ASB$ENQ_PROJ
 yes     yes           Std       0 ASB$DEQ_PROJ
 yes     yes           Std       2 ASB$WRITE_PROJ
         yes           Std       2 ASH$INFO
 yes     yes           Std       0 ASB$GETSEG
         yes           Std       2 ASH$ERROR
 yes     yes           Std       3 ASB$READ_PROJ
 yes     yes           Std       2 ASB$GET_MORE_SEG
 yes     yes           Std       2 ASB$FREE_SEG
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:13   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_TRUE                          r    AS_FALSE
r    AS_NONE                          r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             PROJ_KEY
     LO_WIDTH                              ERR_CODE                              AS_FIELD1
     AS_FIELD2                             REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          DSEG_FLG                              DSEG1$
     DSEG1SIZE                             DSEG2$                                DSEG2SIZE
     ENQDEQ_FLG                            AS_LOGON_KEY                          AS_USERS
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:14   


        1        1        /*M* ASR$R_PROJECT - processes the REMOVE PROJECT command.   */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
       11       11              ECU=3,CSU=3,SDI=3                                           */
       12       12                                                              /**/
       13       13        ASR$R_PROJECT: PROC( KEY, P_COUNT, FACCOUNT_OPT );

     13  2 000000   000000 700200 xent  ASR$R_PROJE* TSX0  ! X66_AUTO_3
         2 000001   000040 000003                    ZERO    32,3

       14       14
       15       15        /********************************************************************/
       16       16        /*    Parameters      parameters      parameters      parameters    */
       17       17        /********************************************************************/
       18       18
       19       19    1   DCL 1 KEY,
       20       20    1          2 COUNT UBIN BYTE UNAL,
       21       21    1          2 TEXT CHAR(41) ,
       22       22    1          2 SKEY REDEF TEXT,
       23       23    1             3 PROJ UBIN BYTE UNAL,
       24       24    1             3 CREATOR CHAR(20) ,
       25       25    1             3 USER CHAR(20) ;
       26       26    1   DCL P_COUNT UBIN ;
       27       27    1   DCL FACCOUNT_OPT BIT(1) ALIGNED;
       28       28
       29       29        /********************************************************************/
       30       30        /*    Include files       include files       include files         */
       31       31        /********************************************************************/
       32       32
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:15   
       33       33        %INCLUDE    AS_ENTRIES_M ;
       34     1083        %INCLUDE    AS_SUPER_C ;
       35     1518        %INCLUDE    AS_SUBS_C  ;
       36     2932        %INCLUDE    AS_MAC_C   ;
       37     3012        %INCLUDE    KL_SUPER_C ;
       38     5914        %INCLUDE    XU_MACRO_C ;
       39     9020        %INCLUDE    XU_FORMAT_C ;
       40     9182        %INCLUDE    AS_PERR_C ;
       41     9784        %INCLUDE    AS_SUPER_R ;
       42    12800
       43    12801        /********************************************************************/
       44    12802        /*    Auto data       auto data       auto data       auto data     */
       45    12803        /********************************************************************/
       46    12804
       47    12805    1   DCL 1 SUB_PROJ_KEY ,
       48    12806    1          2 COUNT UBIN BYTE UNAL,
       49    12807    1          2 TEXT CHAR(41) ,
       50    12808    1          2 SKEY REDEF TEXT,
       51    12809    1             3 PROJ UBIN BYTE UNAL,
       52    12810    1             3 CREATOR CHAR(20) ,
       53    12811    1             3 USER CHAR(20) ;
       54    12812    1   DCL MORE BIT(1) ;
       55    12813    1   DCL I SBIN ;
       56    12814    1   DCL J SBIN ;
       57    12815    1   DCL K SBIN ;
       58    12816    1   DCL U_COUNT UBIN ;
       59    12817    1   DCL ARS UBIN;
       60    12818    1   DCL INITIAL_DSEG2SIZE UBIN;
       61    12819    1   DCL INITIAL_DSEG1SIZE UBIN;
       62    12820    1   DCL PROJ1$            PTR;
       63    12821    1   DCL PROJ2$            PTR;
       64    12822
       65    12823        /********************************************************************/
       66    12824        /*    Entry dcl       entry dcl       entry dcl       entry dcl     */
       67    12825        /********************************************************************/
       68    12826
       69    12827        %ASB$DELREC_USERS ;
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:16   
       70    12830        %ASB$DELREC_HLP ;
       71    12833        %ASB$PREC_USERS ;
       72    12836        %ASB$ENQ ;
       73    12839        %ASB$ENQ_USERS ;
       74    12842        %ASB$READ_USERS_SEQ ;
       75    12845        %ASH$INFO ;
       76    12848        %ASB$DEQ ;
       77    12851        %ASB$GETSEG ;
       78    12854        %ASB$ENQ_PROJ ;
       79    12857        %ASB$READ_PROJ_SEQ ;
       80    12860        %ASB$DELREC_PROJ ;
       81    12863        %ASB$WRITE_PROJ ;
       82    12866        %ASB$DEQ_PROJ ;
       83    12869        %ASH$ERROR ;
       84    12872        %ASB$PREC_PROJ ;
       85    12875        %ASB$FREE_SEG ;
       86    12878        %ASB$READ_PROJ ;
       87    12881        %ASB$GET_MORE_SEG ;
       88    12884        %ASB$PIG ;
       89    12887
       90    12888        /********************************************************************/
       91    12889        /*    Based data      based data      based data      based data    */
       92    12890        /********************************************************************/
       93    12891
       94    12892        %AS$PROJ( STCLASS="BASED(DSEG2$)" );
       95    12926        %AS$PROJ_HEADER( STCLASS=BASED  );
       96    12955        %AS$PROJ_ACCT_LIST( NAME=ACCT$LIST, STCLASS=BASED );
       97    12960        %SUPER_TO_PIG( VARY=NO, STCLASS="BASED(DSEG1$)" );
       98    12992
       99    12993
      100    12994        /********************************************************************/
      101    12995        /*    Procedure       procedure       procedure       procedure     */
      102    12996        /********************************************************************/
      103    12997
      104    12998
      105    12999
      106    13000    1   SUB_PROJ_KEY.SKEY.PROJ = 1 ;
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:17   

  13000  2 000002   000001 236003                    LDQ     1,DU
         2 000003   200006 552120                    STBQ    SUB_PROJ_KEY,'20'O,AUTO

      107    13001    1   SUB_PROJ_KEY.SKEY.CREATOR = KEY.SKEY.USER ;

  13001  2 000004   200003 470500                    LDP0    @KEY,,AUTO
         2 000005   040100 100500                    MLR     fill='040'O
         2 000006   000005 400024                    ADSC9   5,,PR0                   cn=2,n=20
         2 000007   200006 400024                    ADSC9   SUB_PROJ_KEY,,AUTO       cn=2,n=20

      108    13002    1   SUB_PROJ_KEY.SKEY.USER = AS_BLANK ;

  13002  2 000010   040100 100400                    MLR     fill='040'O
         2 000011   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000012   200013 400024                    ADSC9   SUB_PROJ_KEY+5,,AUTO     cn=2,n=20

      109    13003    1   SUB_PROJ_KEY.COUNT = 21 ;

  13003  2 000013   025000 236003                    LDQ     10752,DU
         2 000014   200006 552140                    STBQ    SUB_PROJ_KEY,'40'O,AUTO

      110    13004    1   MORE = AS_TRUE ;

  13004  2 000015   000000 236000 xsym               LDQ     AS_TRUE
         2 000016   400000 376003                    ANQ     -131072,DU
         2 000017   200021 756100                    STQ     MORE,,AUTO

      111    13005    2   DO WHILE( MORE ) ;      /* Remove all sub-projects */

  13005  2 000020   200021 234100                    SZN     MORE,,AUTO
         2 000021   000073 605000 2                  TPL     DONE_WITH_SUB_PROJS

      112    13006    2      USERS_KEY = SUB_PROJ_KEY;

  13006  2 000022   000000 100500                    MLR     fill='000'O
         2 000023   200006 000052                    ADSC9   SUB_PROJ_KEY,,AUTO       cn=0,n=42
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:18   
         2 000024   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      113    13007    2      CALL ASB$PREC_USERS ;           /* Position to last key */

  13007  2 000025   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000026   000000 701000 xent               TSX1    ASB$PREC_USERS
         2 000027   000000 011000                    NOP     0

      114    13008
      115    13009    2      CALL ASB$READ_USERS_SEQ( AS_USERS ) ALTRET( DONE_WITH_SUB_PROJS);

  13009  2 000030   000000 630400 3                  EPPR0   0
         2 000031   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000032   000000 701000 xent               TSX1    ASB$READ_USERS_SEQ
         2 000033   000073 702000 2                  TSX2    DONE_WITH_SUB_PROJS

      116    13010    2      IF USERS_KEY.COUNT < 22 THEN MORE = AS_FALSE ;

  13010  2 000034   000000 236000 xsym               LDQ     USERS_KEY
         2 000035   777000 376003                    ANQ     -512,DU
         2 000036   026000 116003                    CMPQ    11264,DU
         2 000037   000044 603000 2                  TRC     s:13012

  13010  2 000040   000000 236000 xsym               LDQ     AS_FALSE
         2 000041   400000 376003                    ANQ     -131072,DU
         2 000042   200021 756100                    STQ     MORE,,AUTO
         2 000043   000071 710000 2                  TRA     s:13018

      117    13011    2      ELSE
      118    13012    2         IF USERS_KEY.SKEY.CREATOR ~= SUB_PROJ_KEY.SKEY.CREATOR

  13012  2 000044   040100 106400                    CMPC    fill='040'O
         2 000045   000000 400024 xsym               ADSC9   USERS_KEY                cn=2,n=20
         2 000046   200006 400024                    ADSC9   SUB_PROJ_KEY,,AUTO       cn=2,n=20
         2 000047   000054 600000 2                  TZE     s:13015

      119    13013    2         THEN MORE = AS_FALSE ;
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:19   

  13013  2 000050   000000 236000 xsym               LDQ     AS_FALSE
         2 000051   400000 376003                    ANQ     -131072,DU
         2 000052   200021 756100                    STQ     MORE,,AUTO
         2 000053   000071 710000 2                  TRA     s:13018

      120    13014    3         ELSE DO ;

      121    13015    3            SUB_PROJ_KEY = USERS_KEY ;

  13015  2 000054   000100 100400                    MLR     fill='000'O
         2 000055   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         2 000056   200006 000052                    ADSC9   SUB_PROJ_KEY,,AUTO       cn=0,n=42

      122    13016    3            CALL ASR$R_PROJECT( SUB_PROJ_KEY, P_COUNT, FACCOUNT_OPT );

  13016  2 000057   200005 236100                    LDQ     @FACCOUNT_OPT,,AUTO
         2 000060   200036 756100                    STQ     PROJ2$+4,,AUTO
         2 000061   200004 236100                    LDQ     @P_COUNT,,AUTO
         2 000062   200035 756100                    STQ     PROJ2$+3,,AUTO
         2 000063   200006 630500                    EPPR0   SUB_PROJ_KEY,,AUTO
         2 000064   200034 450500                    STP0    PROJ2$+2,,AUTO
         2 000065   200034 630500                    EPPR0   PROJ2$+2,,AUTO
         2 000066   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000067   000000 701000 2                  TSX1    s:13
         2 000070   000000 011000                    NOP     0

      123    13017    3            END ;

      124    13018    2      END ;       /* Do while( more ); */

  13018  2 000071   200021 234100                    SZN     MORE,,AUTO
         2 000072   000022 604000 2                  TMI     s:13006

  13015  2 000073                       DONE_WITH_S* null
      125    13019
      126    13020    1   DONE_WITH_SUB_PROJS: ;
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:20   
      127    13021                                                  /* Remove all users in the project */
      128    13022    1   SUB_PROJ_KEY.SKEY.PROJ = 0 ;

  13022  2 000073   000000 236003                    LDQ     0,DU
         2 000074   200006 552120                    STBQ    SUB_PROJ_KEY,'20'O,AUTO

      129    13023    1   SUB_PROJ_KEY.SKEY.USER = AS_BLANK ;

  13023  2 000075   040100 100400                    MLR     fill='040'O
         2 000076   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000077   200013 400024                    ADSC9   SUB_PROJ_KEY+5,,AUTO     cn=2,n=20

      130    13024    1   SUB_PROJ_KEY.COUNT = 21 ;

  13024  2 000100   025000 236003                    LDQ     10752,DU
         2 000101   200006 552140                    STBQ    SUB_PROJ_KEY,'40'O,AUTO

      131    13025    1   U_COUNT = 0 ;

  13025  2 000102   200025 450100                    STZ     U_COUNT,,AUTO

      132    13026    1   MORE = AS_TRUE ;

  13026  2 000103   000000 236000 xsym               LDQ     AS_TRUE
         2 000104   400000 376003                    ANQ     -131072,DU
         2 000105   200021 756100                    STQ     MORE,,AUTO

      133    13027    2   DO WHILE( MORE ) ;

  13027  2 000106   200021 234100                    SZN     MORE,,AUTO
         2 000107   000213 605000 2                  TPL     DONE_WITH_USERS

      134    13028    2      USERS_KEY = SUB_PROJ_KEY ;

  13028  2 000110   000000 100500                    MLR     fill='000'O
         2 000111   200006 000052                    ADSC9   SUB_PROJ_KEY,,AUTO       cn=0,n=42
         2 000112   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:21   

      135    13029    2      CALL ASB$PREC_USERS ;           /* Position to last key */

  13029  2 000113   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000114   000000 701000 xent               TSX1    ASB$PREC_USERS
         2 000115   000000 011000                    NOP     0

      136    13030
      137    13031    2      CALL ASB$READ_USERS_SEQ( AS_USERS ) ALTRET( DONE_WITH_USERS ) ;

  13031  2 000116   000000 630400 3                  EPPR0   0
         2 000117   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000120   000000 701000 xent               TSX1    ASB$READ_USERS_SEQ
         2 000121   000213 702000 2                  TSX2    DONE_WITH_USERS

      138    13032    2      IF USERS_KEY.COUNT < 22 THEN MORE = AS_FALSE ;

  13032  2 000122   000000 236000 xsym               LDQ     USERS_KEY
         2 000123   777000 376003                    ANQ     -512,DU
         2 000124   026000 116003                    CMPQ    11264,DU
         2 000125   000132 603000 2                  TRC     s:13034

  13032  2 000126   000000 236000 xsym               LDQ     AS_FALSE
         2 000127   400000 376003                    ANQ     -131072,DU
         2 000130   200021 756100                    STQ     MORE,,AUTO
         2 000131   000211 710000 2                  TRA     s:13050

      139    13033    2      ELSE
      140    13034    2         IF USERS_KEY.SKEY.PROJ ~= 0

  13034  2 000132   000000 236000 xsym               LDQ     USERS_KEY
         2 000133   000777 316003                    CANQ    511,DU
         2 000134   000142 601000 2                  TNZ     s:13036
         2 000135   200003 470500                    LDP0    @KEY,,AUTO
         2 000136   040100 106400                    CMPC    fill='040'O
         2 000137   000000 400024 xsym               ADSC9   USERS_KEY                cn=2,n=20
         2 000140   000005 400024                    ADSC9   5,,PR0                   cn=2,n=20
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:22   
         2 000141   000146 600000 2                  TZE     s:13038

      141    13035    2              OR USERS_KEY.SKEY.CREATOR ~= KEY.SKEY.USER
      142    13036    2         THEN MORE = AS_FALSE;

  13036  2 000142   000000 236000 xsym               LDQ     AS_FALSE
         2 000143   400000 376003                    ANQ     -131072,DU
         2 000144   200021 756100                    STQ     MORE,,AUTO
         2 000145   000211 710000 2                  TRA     s:13050

      143    13037    3         ELSE DO ;

      144    13038    3            CALL ASB$ENQ_USERS ALTRET( ENQ_ERR ) ;

  13038  2 000146   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000147   000000 701000 xent               TSX1    ASB$ENQ_USERS
         2 000150   001120 702000 2                  TSX2    ENQ_ERR

      145    13039    3            CALL ASB$DELREC_USERS ;

  13039  2 000151   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000152   000000 701000 xent               TSX1    ASB$DELREC_USERS
         2 000153   000000 011000                    NOP     0

      146    13040    3            SUB_PROJ_KEY = USERS_KEY ;

  13040  2 000154   000100 100400                    MLR     fill='000'O
         2 000155   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         2 000156   200006 000052                    ADSC9   SUB_PROJ_KEY,,AUTO       cn=0,n=42

      147    13041    3            USERS_KEY.TXTC = SUB_PROJ_KEY.SKEY.USER ;

  13041  2 000157   040000 100500                    MLR     fill='040'O
         2 000160   200013 400024                    ADSC9   SUB_PROJ_KEY+5,,AUTO     cn=2,n=20
         2 000161   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      148    13042    3            CALL INDEX( I, AS_BLANK, USERS_KEY.UKEY.UNAME );
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:23   

  13042  2 000162   000000 124400                    SCM     mask='000'O
         2 000163   000002 200014 xsym               ADSC9   USERS_KEY+2              cn=1,n=12
         2 000164   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000165   200022 000100                    ARG     I,,AUTO

      149    13043    3            USERS_KEY.COUNT = 8 + I ;

  13043  2 000166   200022 236100                    LDQ     I,,AUTO
         2 000167   000010 036007                    ADLQ    8,DL
         2 000170   000033 736000                    QLS     27
         2 000171   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      150    13044    3            CALL ASB$ENQ ALTRET( ENQ_ERR ) ;

  13044  2 000172   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000173   000000 701000 xent               TSX1    ASB$ENQ
         2 000174   001120 702000 2                  TSX2    ENQ_ERR

      151    13045    3            CALL ASB$DELREC_USERS ;

  13045  2 000175   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000176   000000 701000 xent               TSX1    ASB$DELREC_USERS
         2 000177   000000 011000                    NOP     0

      152    13046    3            CALL ASB$DELREC_HLP ;

  13046  2 000200   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000201   000000 701000 xent               TSX1    ASB$DELREC_HLP
         2 000202   000000 011000                    NOP     0

      153    13047    3            CALL ASB$DEQ ;

  13047  2 000203   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000204   000000 701000 xent               TSX1    ASB$DEQ
         2 000205   000000 011000                    NOP     0

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:24   
      154    13048    3            U_COUNT = U_COUNT + 1 ;

  13048  2 000206   200025 235100                    LDA     U_COUNT,,AUTO
         2 000207   000001 035007                    ADLA    1,DL
         2 000210   200025 755100                    STA     U_COUNT,,AUTO

      155    13049    3            END ;

      156    13050    2      END ;       /* Do while( more ); */

  13050  2 000211   200021 234100                    SZN     MORE,,AUTO
         2 000212   000110 604000 2                  TMI     s:13028

  13043  2 000213                       DONE_WITH_U* null
      157    13051
      158    13052    1   DONE_WITH_USERS: ;
      159    13053                                                  /* Now remove the project. */
      160    13054    1   USERS_KEY = KEY ;

  13054  2 000213   200003 470500                    LDP0    @KEY,,AUTO
         2 000214   000000 100500                    MLR     fill='000'O
         2 000215   000000 000052                    ADSC9   0,,PR0                   cn=0,n=42
         2 000216   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      161    13055    1   CALL ASB$ENQ_USERS ALTRET( ENQ_ERR );

  13055  2 000217   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000220   000000 701000 xent               TSX1    ASB$ENQ_USERS
         2 000221   001120 702000 2                  TSX2    ENQ_ERR

      162    13056    1   CALL ASB$DELREC_USERS ;

  13056  2 000222   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000223   000000 701000 xent               TSX1    ASB$DELREC_USERS
         2 000224   000000 011000                    NOP     0

      163    13057    1   USERS_KEY.TXTC = KEY.SKEY.USER ;
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:25   

  13057  2 000225   200003 470500                    LDP0    @KEY,,AUTO
         2 000226   040000 100500                    MLR     fill='040'O
         2 000227   000005 400024                    ADSC9   5,,PR0                   cn=2,n=20
         2 000230   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      164    13058    1   CALL INDEX( J, AS_BLANK, USERS_KEY.UKEY.UNAME ) ;

  13058  2 000231   000000 124400                    SCM     mask='000'O
         2 000232   000002 200014 xsym               ADSC9   USERS_KEY+2              cn=1,n=12
         2 000233   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000234   200023 000100                    ARG     J,,AUTO

      165    13059    1   USERS_KEY.COUNT = J + 8 ;

  13059  2 000235   200023 236100                    LDQ     J,,AUTO
         2 000236   000010 036007                    ADLQ    8,DL
         2 000237   000033 736000                    QLS     27
         2 000240   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      166    13060    1   CALL ASB$ENQ ALTRET( ENQ_ERR );

  13060  2 000241   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000242   000000 701000 xent               TSX1    ASB$ENQ
         2 000243   001120 702000 2                  TSX2    ENQ_ERR

      167    13061    1   CALL ASB$DELREC_USERS ;

  13061  2 000244   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000245   000000 701000 xent               TSX1    ASB$DELREC_USERS
         2 000246   000000 011000                    NOP     0

      168    13062    1   CALL ASB$DELREC_HLP ;

  13062  2 000247   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000250   000000 701000 xent               TSX1    ASB$DELREC_HLP
         2 000251   000000 011000                    NOP     0
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:26   

      169    13063    1   USERS_KEY.COUNT = 21 ;

  13063  2 000252   025000 236003                    LDQ     10752,DU
         2 000253   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      170    13064    1   USERS_KEY.UKEY.S = 'S' ;

  13064  2 000254   000123 236003                    LDQ     83,DU
         2 000255   000005 552020 xsym               STBQ    USERS_KEY+5,'20'O

      171    13065    1   CALL ASB$ENQ ALTRET( ENQ_ERR );

  13065  2 000256   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000257   000000 701000 xent               TSX1    ASB$ENQ
         2 000260   001120 702000 2                  TSX2    ENQ_ERR

      172    13066    1   CALL ASB$DELREC_USERS ;

  13066  2 000261   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000262   000000 701000 xent               TSX1    ASB$DELREC_USERS
         2 000263   000000 011000                    NOP     0

      173    13067    1   CALL ASB$DELREC_HLP ;

  13067  2 000264   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000265   000000 701000 xent               TSX1    ASB$DELREC_HLP
         2 000266   000000 011000                    NOP     0

      174    13068    1   CALL ASB$DEQ ;

  13068  2 000267   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000270   000000 701000 xent               TSX1    ASB$DEQ
         2 000271   000000 011000                    NOP     0

      175    13069    1   ENQDEQ_FLG = AS_FALSE ;

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:27   
  13069  2 000272   000000 236000 xsym               LDQ     AS_FALSE
         2 000273   400000 376003                    ANQ     -131072,DU
         2 000274   000000 756000 xsym               STQ     ENQDEQ_FLG

      176    13070    1   P_COUNT = P_COUNT + 1 ;

  13070  2 000275   200004 470500                    LDP0    @P_COUNT,,AUTO
         2 000276   000000 235100                    LDA     0,,PR0
         2 000277   000001 035007                    ADLA    1,DL
         2 000300   000000 755100                    STA     0,,PR0

      177    13071
      178    13072        /*E* ERROR:   ASR-E$PROJ_REMOVED-C
      179    13073             MESSAGE: Project "%U1" removed.  %U2 users removed.
      180    13074        */
      181    13075    1   CALL INDEX( I, AS_BLANK, USERS_KEY.UKEY.ACCT );

  13075  2 000301   000000 124400                    SCM     mask='000'O
         2 000302   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000303   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000304   200022 000100                    ARG     I,,AUTO

      182    13076    1   CALL CONCAT( AS_FIELD1.TEXT, SUBSTR(USERS_KEY.TXTC,0,I), ',',

  13076  2 000305   200022 720100                    LXL0    I,,AUTO
         2 000306   040000 100440                    MLR     fill='040'O
         2 000307   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
         2 000310   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         2 000311   200022 236100                    LDQ     I,,AUTO
         2 000312   000050 116007                    CMPQ    40,DL
         2 000313   000331 605000 2                  TPL     s:13078
         2 000314   777727 621006                    EAX1    -41,QL
         2 000315   777777 661003                    ERX1    -1,DU
         2 000316   040046 100400                    MLR     fill='040'O
         2 000317   000001 000001 3                  ADSC9   1                        cn=0,n=1
         2 000320   000000 200011 xsym               ADSC9   AS_FIELD1,Q              cn=1,n=*X1
         2 000321   000047 116007                    CMPQ    39,DL
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:28   
         2 000322   000331 605000 2                  TPL     s:13078
         2 000323   777730 622006                    EAX2    -40,QL
         2 000324   777777 662003                    ERX2    -1,DU
         2 000325   200023 723100                    LXL3    J,,AUTO
         2 000326   040046 100440                    MLR     fill='040'O
         2 000327   000002 200013 xsym               ADSC9   USERS_KEY+2              cn=1,n=*X3
         2 000330   000000 400012 xsym               ADSC9   AS_FIELD1,Q              cn=2,n=*X2

      183    13077    1        SUBSTR(USERS_KEY.TXTC,8,J) ) ;
      184    13078    1   AS_FIELD1.COUNT = I + J + 1 ;

  13078  2 000331   200023 036100                    ADLQ    J,,AUTO
         2 000332   000001 036007                    ADLQ    1,DL
         2 000333   000033 736000                    QLS     27
         2 000334   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      185    13079        %NUMBER( NUM2=U_COUNT ) ;
             13095    1         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, U_COUNT );

  13095  2 000335   200025 631500                    EPPR1   U_COUNT,,AUTO
         2 000336   200037 451500                    STP1    PROJ2$+5,,AUTO
         2 000337   000003 236000 3                  LDQ     3
         2 000340   200036 756100                    STQ     PROJ2$+4,,AUTO
         2 000341   000004 237000 3                  LDAQ    4
         2 000342   200034 757100                    STAQ    PROJ2$+2,,AUTO
         2 000343   200034 630500                    EPPR0   PROJ2$+2,,AUTO
         2 000344   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000345   000000 701000 xent               TSX1    ASB$BINCHAR
         2 000346   000000 011000                    NOP     0

      186    13109        %SCREAM( ERR#=E$PROJ_REMOVED, MID='R', LEVEL=INFO ) ;

  13117  2 000347   000006 630400 3                  EPPR0   6
         2 000350   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000351   000000 701000 xent               TSX1    ASH$INFO
         2 000352   000000 011000                    NOP     0

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:29   
      187    13124        /*
      188    13125                                      Remove packset records from :PROJ
      189    13126        */
      190    13127    1   IF NOT DSEG_FLG THEN

  13127  2 000353   000000 234000 xsym               SZN     DSEG_FLG
         2 000354   000366 604000 2                  TMI     s:13148

      191    13128    1      CALL ASB$GETSEG

  13128  2 000355   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000356   000000 701000 xent               TSX1    ASB$GETSEG
         2 000357   000361 702000 2                  TSX2    GETSEG_ERR
         2 000360   000366 710000 2                  TRA     s:13148

      192    13129    2      WHENALTRETURN DO;

      193    13130    2   GETSEG_ERR:
      194    13131              %SCREAM (ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='R' );

  13143  2 000361   000007 630400 3     GETSEG_ERR   EPPR0   7
         2 000362   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000363   000000 701000 xent               TSX1    ASH$ERROR
         2 000364   000000 011000                    NOP     0

      195    13146    2         RETURN;

  13146  2 000365   000000 702200 xent               TSX2  ! X66_ARET

      196    13147    2         END;   /* Whenaltreturn from ASB$GETSEG  */
      197    13148    1   PROJ_KEY.COUNT = 20;

  13148  2 000366   024000 236003                    LDQ     10240,DU
         2 000367   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

      198    13149    1   PROJ_KEY.TEXT = KEY.SKEY.USER;

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:30   
  13149  2 000370   200003 470500                    LDP0    @KEY,,AUTO
         2 000371   040000 100500                    MLR     fill='040'O
         2 000372   000005 400024                    ADSC9   5,,PR0                   cn=2,n=20
         2 000373   000000 200032 xsym               ADSC9   PROJ_KEY                 cn=1,n=26

      199    13150    1   CALL ASB$PREC_PROJ;

  13150  2 000374   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000375   000000 701000 xent               TSX1    ASB$PREC_PROJ
         2 000376   000000 011000                    NOP     0

      200    13151    1   INITIAL_DSEG1SIZE = DSEG1SIZE;

  13151  2 000377   000000 235000 xsym               LDA     DSEG1SIZE
         2 000400   200030 755100                    STA     INITIAL_DSEG1SIZE,,AUTO

      201    13152    1   INITIAL_DSEG2SIZE = DSEG2SIZE;

  13152  2 000401   000000 236000 xsym               LDQ     DSEG2SIZE
         2 000402   200027 756100                    STQ     INITIAL_DSEG2SIZE,,AUTO

      202    13153    1   ARS = DSEG2SIZE;

  13153  2 000403   200026 756100                    STQ     ARS,,AUTO

      203    13154    1   CALL ASB$READ_PROJ_SEQ( DSEG2$, ARS, 2 ) ALTRET(FINISHED);

  13154  2 000404   000010 236000 3                  LDQ     8
         2 000405   200036 756100                    STQ     PROJ2$+4,,AUTO
         2 000406   200026 630500                    EPPR0   ARS,,AUTO
         2 000407   200035 450500                    STP0    PROJ2$+3,,AUTO
         2 000410   000011 236000 3                  LDQ     9
         2 000411   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 000412   200034 630500                    EPPR0   PROJ2$+2,,AUTO
         2 000413   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000414   000000 701000 xent               TSX1    ASB$READ_PROJ_SEQ
         2 000415   001070 702000 2                  TSX2    FINISHED
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:31   

      204    13155    2   DO WHILE( PROJ_KEY.TXT.PROJECT = KEY.SKEY.USER );

  13155  2 000416   200003 470500                    LDP0    @KEY,,AUTO
         2 000417   040100 106400                    CMPC    fill='040'O
         2 000420   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20
         2 000421   000005 400024                    ADSC9   5,,PR0                   cn=2,n=20
         2 000422   001070 601000 2                  TNZ     FINISHED

      205    13156    3      IF FACCOUNT_OPT AND AS$PROJ.NUM_ACCTS > 0 THEN DO;

  13156  2 000423   200005 470500                    LDP0    @FACCOUNT_OPT,,AUTO
         2 000424   000000 234100                    SZN     0,,PR0
         2 000425   000540 605000 2                  TPL     s:13172
         2 000426   000000 471400 xsym               LDP1    DSEG2$
         2 000427   100013 235100                    LDA     11,,PR1
         2 000430   000540 604400 2                  TMOZ    s:13172

      206    13157                                              /* Delete file management accounts */
      207    13158    3         PROJ2$ = PINCRW( DSEG2$, SIZEW(AS$PROJ_HEADER)+(AS$PROJ.ATTRIBUTES.COUNT+5)/4
             13158                  );

  13158  2 000431   100014 236100                    LDQ     12,,PR1
         2 000432   000022 772000                    QRL     18
         2 000433   000005 036007                    ADLQ    5,DL
         2 000434   000002 772000                    QRL     2
         2 000435   000022 736000                    QLS     18
         2 000436   000014 036003                    ADLQ    12,DU
         2 000437   000000 036000 xsym               ADLQ    DSEG2$
         2 000440   200032 756100                    STQ     PROJ2$,,AUTO

      208    13159    3         SUPER_TO_PIG.TYPE = %DELETE_ACCT;

  13159  2 000441   000000 473400 xsym               LDP3    DSEG1$
         2 000442   004000 236003                    LDQ     2048,DU
         2 000443   300000 552140                    STBQ    0,'40'O,PR3

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:32   
      209    13160    3         SUPER_TO_PIG.WIDTH = LO_WIDTH;

  13160  2 000444   000000 471400 xsym               LDP1    DSEG1$
         2 000445   000000 236000 xsym               LDQ     LO_WIDTH
         2 000446   000022 736000                    QLS     18
         2 000447   100000 676100                    ERQ     0,,PR1
         2 000450   000377 376003                    ANQ     255,DU
         2 000451   100000 656100                    ERSQ    0,,PR1

      210    13161    3         SUPER_TO_PIG.PROJ = (KEY.SKEY.CREATOR ~= AS_NONE.TEXT );

  13161  2 000452   400000 220003                    LDX0    -131072,DU
         2 000453   200003 471500                    LDP1    @KEY,,AUTO
         2 000454   040000 106500                    CMPC    fill='040'O
         2 000455   100000 400024                    ADSC9   0,,PR1                   cn=2,n=20
         2 000456   000000 200024 xsym               ADSC9   AS_NONE                  cn=1,n=20
         2 000457   000461 601000 2                  TNZ     s:13161+7
         2 000460   000000 220003                    LDX0    0,DU
         2 000461   000000 473400 xsym               LDP3    DSEG1$
         2 000462   000000 636010                    EAQ     0,X0
         2 000463   000011 772000                    QRL     9
         2 000464   300000 676100                    ERQ     0,,PR3
         2 000465   000400 376003                    ANQ     256,DU
         2 000466   300000 656100                    ERSQ    0,,PR3

      211    13162    3         SUPER_TO_PIG.RESUPER = AS_LOGON_KEY.TEXT;

  13162  2 000467   000000 473400 xsym               LDP3    DSEG1$
         2 000470   040100 100400                    MLR     fill='040'O
         2 000471   000000 200024 xsym               ADSC9   AS_LOGON_KEY             cn=1,n=20
         2 000472   300000 400024                    ADSC9   0,,PR3                   cn=2,n=20

      212    13163    3         SUPER_TO_PIG.PROJECT_TEXT = KEY.SKEY.USER;

  13163  2 000473   000000 473400 xsym               LDP3    DSEG1$
         2 000474   040100 100500                    MLR     fill='040'O
         2 000475   100005 400024                    ADSC9   5,,PR1                   cn=2,n=20
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:33   
         2 000476   300005 400024                    ADSC9   5,,PR3                   cn=2,n=20

      213    13164    3         SUPER_TO_PIG.PACKSET = PROJ_KEY.TXT.PACKSET;

  13164  2 000477   040100 100400                    MLR     fill='040'O
         2 000500   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         2 000501   300012 400006                    ADSC9   10,,PR3                  cn=2,n=6

      214    13165    3         SUPER_TO_PIG.ATTR.COUNT = 0;

  13165  2 000502   000000 220003                    LDX0    0,DU
         2 000503   300016 740100                    STX0    14,,PR3

      215    13166    4         DO I = 0 TO AS$PROJ.NUM_ACCTS-1;

  13166  2 000504   200022 450100                    STZ     I,,AUTO
         2 000505   000522 710000 2                  TRA     s:13169+1

      216    13167    4            SUPER_TO_PIG.ACCT = PROJ2$->ACCT$LIST.ACCT(I);

  13167  2 000506   200022 236100                    LDQ     I,,AUTO
         2 000507   000014 402007                    MPY     12,DL
         2 000510   200032 470500                    LDP0    PROJ2$,,AUTO
         2 000511   000000 471400 xsym               LDP1    DSEG1$
         2 000512   040100 100506                    MLR     fill='040'O
         2 000513   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         2 000514   100014 000010                    ADSC9   12,,PR1                  cn=0,n=8

      217    13168    4            CALL ASB$PIG( SUPER_TO_PIG );

  13168  2 000515   000000 630400 xsym               EPPR0   DSEG1$
         2 000516   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000517   000000 701000 xent               TSX1    ASB$PIG
         2 000520   000000 011000                    NOP     0

      218    13169    4            END;

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:34   
  13169  2 000521   200022 054100                    AOS     I,,AUTO
         2 000522   000000 470400 xsym               LDP0    DSEG2$
         2 000523   200022 236100                    LDQ     I,,AUTO
         2 000524   000013 116100                    CMPQ    11,,PR0
         2 000525   000506 604000 2                  TMI     s:13167

      219    13170    3         CALL ASB$READ_PROJ(DSEG2$,ARS,2) ALTRET(FINISHED);

  13170  2 000526   000010 236000 3                  LDQ     8
         2 000527   200036 756100                    STQ     PROJ2$+4,,AUTO
         2 000530   200026 631500                    EPPR1   ARS,,AUTO
         2 000531   200035 451500                    STP1    PROJ2$+3,,AUTO
         2 000532   000011 236000 3                  LDQ     9
         2 000533   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 000534   200034 630500                    EPPR0   PROJ2$+2,,AUTO
         2 000535   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000536   000000 701000 xent               TSX1    ASB$READ_PROJ
         2 000537   001070 702000 2                  TSX2    FINISHED

      220    13171    3         END;

      221    13172    2      CALL ASB$ENQ_PROJ;

  13172  2 000540   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000541   000000 701000 xent               TSX1    ASB$ENQ_PROJ
         2 000542   000000 011000                    NOP     0

      222    13173    2      IF AS$PROJ.CREATOR = AS_BLANK THEN

  13173  2 000543   000000 470400 xsym               LDP0    DSEG2$
         2 000544   040000 106500                    CMPC    fill='040'O
         2 000545   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20
         2 000546   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000547   000576 601000 2                  TNZ     s:13183

      223    13174    2         IF AS$PROJ.NUM_ACCTS = 0 THEN

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:35   
  13174  2 000550   000013 235100                    LDA     11,,PR0
         2 000551   000556 601000 2                  TNZ     s:13177

      224    13175    2            CALL ASB$DELREC_PROJ;

  13175  2 000552   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000553   000000 701000 xent               TSX1    ASB$DELREC_PROJ
         2 000554   000000 011000                    NOP     0
         2 000555   001044 710000 2                  TRA     s:13228

      225    13176    3         ELSE DO;

      226    13177    3            AS$PROJ.PROJ_REMOVED = AS_TRUE;

  13177  2 000556   000000 236000 xsym               LDQ     AS_TRUE
         2 000557   000001 772000                    QRL     1
         2 000560   000005 676100                    ERQ     5,,PR0
         2 000561   200000 376003                    ANQ     65536,DU
         2 000562   000005 656100                    ERSQ    5,,PR0

      227    13178    3            AS$PROJ.MAX_NUM_ACCTS = 0;

  13178  2 000563   000012 450100                    STZ     10,,PR0

      228    13179    3            AS$PROJ.MAX_NUM_GRANS = 0;

  13179  2 000564   000006 450100                    STZ     6,,PR0

      229    13180    3            CALL ASB$WRITE_PROJ( DSEG2$, ARS );

  13180  2 000565   200026 631500                    EPPR1   ARS,,AUTO
         2 000566   200035 451500                    STP1    PROJ2$+3,,AUTO
         2 000567   000011 236000 3                  LDQ     9
         2 000570   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 000571   200034 630500                    EPPR0   PROJ2$+2,,AUTO
         2 000572   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000573   000000 701000 xent               TSX1    ASB$WRITE_PROJ
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:36   
         2 000574   000000 011000                    NOP     0

      230    13181    3            END;

  13181  2 000575   001044 710000 2                  TRA     s:13228

      231    13182    3      ELSE DO;

      232    13183    3         CALL ASB$DELREC_PROJ;

  13183  2 000576   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000577   000000 701000 xent               TSX1    ASB$DELREC_PROJ
         2 000600   000000 011000                    NOP     0

      233    13184    3         IF AS$PROJ.MAX_NUM_ACCTS > 0  OR  AS$PROJ.MAX_NUM_GRANS > 0

  13184  2 000601   000000 470400 xsym               LDP0    DSEG2$
         2 000602   000012 235100                    LDA     10,,PR0
         2 000603   000606 601000 2                  TNZ     s:13186
         2 000604   000006 235100                    LDA     6,,PR0
         2 000605   001044 600000 2                  TZE     s:13228

      234    13185    4         THEN DO;

      235    13186    4            PROJ_KEY.TXT.PROJECT = KEY.SKEY.CREATOR;

  13186  2 000606   200003 471500                    LDP1    @KEY,,AUTO
         2 000607   040000 100500                    MLR     fill='040'O
         2 000610   100000 400024                    ADSC9   0,,PR1                   cn=2,n=20
         2 000611   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20

      236    13187    4            CALL ASB$ENQ_PROJ;

  13187  2 000612   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000613   000000 701000 xent               TSX1    ASB$ENQ_PROJ
         2 000614   000000 011000                    NOP     0

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:37   
      237    13188    4            ARS = DSEG1SIZE;

  13188  2 000615   000000 235000 xsym               LDA     DSEG1SIZE
         2 000616   200026 755100                    STA     ARS,,AUTO

      238    13189    4            CALL ASB$READ_PROJ( DSEG1$, ARS, 1 ) ALTRET(ALT);

  13189  2 000617   000012 236000 3                  LDQ     10
         2 000620   200036 756100                    STQ     PROJ2$+4,,AUTO
         2 000621   200026 630500                    EPPR0   ARS,,AUTO
         2 000622   200035 450500                    STP0    PROJ2$+3,,AUTO
         2 000623   000013 236000 3                  LDQ     11
         2 000624   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 000625   200034 630500                    EPPR0   PROJ2$+2,,AUTO
         2 000626   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000627   000000 701000 xent               TSX1    ASB$READ_PROJ
         2 000630   001035 702000 2                  TSX2    ALT

      239    13190    4            DSEG1$->AS$PROJ.SUB_PROJ_ACCTS = DSEG1$->AS$PROJ.SUB_PROJ_ACCTS - DSEG2$->
             13190                     AS$PROJ.MAX_NUM_ACCTS;

  13190  2 000631   000000 470400 xsym               LDP0    DSEG2$
         2 000632   000000 471400 xsym               LDP1    DSEG1$
         2 000633   100005 236100                    LDQ     5,,PR1
         2 000634   777777 376007                    ANQ     -1,DL
         2 000635   000012 136100                    SBLQ    10,,PR0
         2 000636   000000 620006                    EAX0    0,QL
         2 000637   100005 440100                    SXL0    5,,PR1

      240    13191    4           DSEG1$->AS$PROJ.GRANS_ACCUM = DSEG1$->AS$PROJ.GRANS_ACCUM - DSEG2$->AS$PROJ
             13191                     .MAX_NUM_GRANS;

  13191  2 000640   100007 236100                    LDQ     7,,PR1
         2 000641   000006 136100                    SBLQ    6,,PR0
         2 000642   100007 756100                    STQ     7,,PR1

      241    13192    5            IF DSEG2$->AS$PROJ.NUM_ACCTS > 0 THEN DO;
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:38   

  13192  2 000643   000013 235100                    LDA     11,,PR0
         2 000644   001025 604400 2                  TMOZ    s:13223

      242    13193    5               PROJ1$ = PINCRW(DSEG1$,

  13193  2 000645   100014 236100                    LDQ     12,,PR1
         2 000646   000022 772000                    QRL     18
         2 000647   000005 036007                    ADLQ    5,DL
         2 000650   000002 772000                    QRL     2
         2 000651   000022 736000                    QLS     18
         2 000652   000014 036003                    ADLQ    12,DU
         2 000653   000000 036000 xsym               ADLQ    DSEG1$
         2 000654   200031 756100                    STQ     PROJ1$,,AUTO

      243    13194    5                    SIZEW(AS$PROJ_HEADER)
      244    13195    5                    + (DSEG1$->AS$PROJ.ATTRIBUTES.COUNT+5)/4 );
      245    13196    5               ARS = POFFC(PROJ1$,DSEG1$)+(DSEG1$->AS$PROJ.MAX_NUM_ACCTS

  13196  2 000655   000000 236000 xsym               LDQ     DSEG1$
         2 000656   000020 772000                    QRL     16
         2 000657   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 000660   200031 236100                    LDQ     PROJ1$,,AUTO
         2 000661   000020 772000                    QRL     16
         2 000662   200034 136100                    SBLQ    PROJ2$+2,,AUTO
         2 000663   200035 756100                    STQ     PROJ2$+3,,AUTO
         2 000664   100012 236100                    LDQ     10,,PR1
         2 000665   000014 402007                    MPY     12,DL
         2 000666   200035 036100                    ADLQ    PROJ2$+3,,AUTO
         2 000667   200026 756100                    STQ     ARS,,AUTO

      246    13197    5                    * SIZEC(ACCT$LIST(0)) );
      247    13198    6               IF ARS > DSEG1SIZE THEN DO;

  13198  2 000670   000000 116000 xsym               CMPQ    DSEG1SIZE
         2 000671   000710 602000 2                  TNC     s:13202
         2 000672   000710 600000 2                  TZE     s:13202
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:39   

      248    13199    6                  J = ((ARS - DSEG1SIZE + 4095)/4096) * 4096;

  13199  2 000673   000000 136000 xsym               SBLQ    DSEG1SIZE
         2 000674   007777 036007                    ADLQ    4095,DL
         2 000675   010000 506007                    DIV     4096,DL
         2 000676   000014 736000                    QLS     12
         2 000677   200023 756100                    STQ     J,,AUTO

      249    13200    6                  CALL ASB$GET_MORE_SEG( 1, J ) ALTRET(GETSEG_ERR);

  13200  2 000700   200023 633500                    EPPR3   J,,AUTO
         2 000701   200035 453500                    STP3    PROJ2$+3,,AUTO
         2 000702   000012 236000 3                  LDQ     10
         2 000703   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 000704   200034 630500                    EPPR0   PROJ2$+2,,AUTO
         2 000705   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000706   000000 701000 xent               TSX1    ASB$GET_MORE_SEG
         2 000707   000361 702000 2                  TSX2    GETSEG_ERR

      250    13201    6                  END;

      251    13202    5               PROJ2$ = PINCRW(DSEG2$, SIZEW(AS$PROJ_HEADER)+(DSEG2$->AS$PROJ.
             13202                        ATTRIBUTES.COUNT+5)/4 );

  13202  2 000710   000000 470400 xsym               LDP0    DSEG2$
         2 000711   000014 236100                    LDQ     12,,PR0
         2 000712   000022 772000                    QRL     18
         2 000713   000005 036007                    ADLQ    5,DL
         2 000714   000002 772000                    QRL     2
         2 000715   000022 736000                    QLS     18
         2 000716   000014 036003                    ADLQ    12,DU
         2 000717   000000 036000 xsym               ADLQ    DSEG2$
         2 000720   200032 756100                    STQ     PROJ2$,,AUTO

      252    13203    5               I = DSEG1$->AS$PROJ.NUM_ACCTS - 1;

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:40   
  13203  2 000721   000000 471400 xsym               LDP1    DSEG1$
         2 000722   100013 235100                    LDA     11,,PR1
         2 000723   000001 135007                    SBLA    1,DL
         2 000724   200022 755100                    STA     I,,AUTO

      253    13204    5               J = DSEG2$->AS$PROJ.NUM_ACCTS - 1;

  13204  2 000725   000013 235100                    LDA     11,,PR0
         2 000726   000001 135007                    SBLA    1,DL
         2 000727   200023 755100                    STA     J,,AUTO

      254    13205    5              DSEG1$->AS$PROJ.NUM_ACCTS = DSEG1$->AS$PROJ.NUM_ACCTS + DSEG2$->AS$PROJ.
             13205                        NUM_ACCTS;

  13205  2 000730   100013 236100                    LDQ     11,,PR1
         2 000731   000013 036100                    ADLQ    11,,PR0
         2 000732   100013 756100                    STQ     11,,PR1

      255    13206    5               DSEG1$->AS$PROJ.GRANS_ACCUM = DSEG1$->AS$PROJ.GRANS_ACCUM + DSEG2$->
             13206                        AS$PROJ.GRANS_ACCUM;

  13206  2 000733   100007 236100                    LDQ     7,,PR1
         2 000734   000007 036100                    ADLQ    7,,PR0
         2 000735   100007 756100                    STQ     7,,PR1

      256    13207    5               K = DSEG1$->AS$PROJ.NUM_ACCTS - 1;

  13207  2 000736   100013 235100                    LDA     11,,PR1
         2 000737   000001 135007                    SBLA    1,DL
         2 000740   200024 755100                    STA     K,,AUTO

      257    13208    6               DO WHILE( I >= 0  AND  J >= 0 );

  13208  2 000741   001004 710000 2                  TRA     s:13218

      258    13209    7                  IF PROJ2$->ACCT$LIST(J) > PROJ1$->ACCT$LIST(I) THEN DO;

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:41   
  13209  2 000742   200022 236100                    LDQ     I,,AUTO
         2 000743   000014 402007                    MPY     12,DL
         2 000744   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 000745   200023 236100                    LDQ     J,,AUTO
         2 000746   000014 402007                    MPY     12,DL
         2 000747   200031 470500                    LDP0    PROJ1$,,AUTO
         2 000750   200034 235100                    LDA     PROJ2$+2,,AUTO
         2 000751   200032 471500                    LDP1    PROJ2$,,AUTO
         2 000752   000106 106505                    CMPC    fill='000'O
         2 000753   000000 000014                    ADSC9   0,A,PR0                  cn=0,n=12
         2 000754   100000 000014                    ADSC9   0,Q,PR1                  cn=0,n=12
         2 000755   000770 603000 2                  TRC     s:13214

      259    13210    7                     PROJ1$->ACCT$LIST(K) = PROJ2$->ACCT$LIST(J);

  13210  2 000756   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 000757   200024 236100                    LDQ     K,,AUTO
         2 000760   000014 402007                    MPY     12,DL
         2 000761   200034 235100                    LDA     PROJ2$+2,,AUTO
         2 000762   000106 100505                    MLR     fill='000'O
         2 000763   100000 000014                    ADSC9   0,A,PR1                  cn=0,n=12
         2 000764   000000 000014                    ADSC9   0,Q,PR0                  cn=0,n=12

      260    13211    7                     J = J - 1;

  13211  2 000765   000001 336007                    LCQ     1,DL
         2 000766   200023 056100                    ASQ     J,,AUTO

      261    13212    7                     END;

  13212  2 000767   001003 710000 2                  TRA     s:13217

      262    13213    7                  ELSE DO;

      263    13214    7                     PROJ1$->ACCT$LIST(K) = PROJ1$->ACCT$LIST(I);

  13214  2 000770   200022 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:42   
         2 000771   000014 402007                    MPY     12,DL
         2 000772   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 000773   200024 236100                    LDQ     K,,AUTO
         2 000774   000014 402007                    MPY     12,DL
         2 000775   200034 235100                    LDA     PROJ2$+2,,AUTO
         2 000776   000106 100505                    MLR     fill='000'O
         2 000777   000000 000014                    ADSC9   0,A,PR0                  cn=0,n=12
         2 001000   000000 000014                    ADSC9   0,Q,PR0                  cn=0,n=12

      264    13215    7                     I = I - 1;

  13215  2 001001   000001 336007                    LCQ     1,DL
         2 001002   200022 056100                    ASQ     I,,AUTO

      265    13216    7                     END;

      266    13217    6                  K = K - 1;

  13217  2 001003   200024 056100                    ASQ     K,,AUTO

      267    13218    6                  END;

  13218  2 001004   200022 235100                    LDA     I,,AUTO
         2 001005   001010 604000 2                  TMI     s:13219
         2 001006   200023 236100                    LDQ     J,,AUTO
         2 001007   000742 605000 2                  TPL     s:13209

      268    13219    6               DO I = 0 TO J;

  13219  2 001010   200022 450100                    STZ     I,,AUTO
         2 001011   001022 710000 2                  TRA     s:13221+1

      269    13220    6                  PROJ1$->ACCT$LIST(I) = PROJ2$->ACCT$LIST(I);

  13220  2 001012   200022 236100                    LDQ     I,,AUTO
         2 001013   000014 402007                    MPY     12,DL
         2 001014   200032 470500                    LDP0    PROJ2$,,AUTO
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:43   
         2 001015   200031 471500                    LDP1    PROJ1$,,AUTO
         2 001016   000106 100506                    MLR     fill='000'O
         2 001017   000000 000014                    ADSC9   0,Q,PR0                  cn=0,n=12
         2 001020   100000 000014                    ADSC9   0,Q,PR1                  cn=0,n=12

      270    13221    6                  END;

  13221  2 001021   200022 054100                    AOS     I,,AUTO
         2 001022   200022 236100                    LDQ     I,,AUTO
         2 001023   200023 116100                    CMPQ    J,,AUTO
         2 001024   001012 604400 2                  TMOZ    s:13220

      271    13222    5               END;

      272    13223    4            CALL ASB$WRITE_PROJ( DSEG1$, ARS );

  13223  2 001025   200026 630500                    EPPR0   ARS,,AUTO
         2 001026   200035 450500                    STP0    PROJ2$+3,,AUTO
         2 001027   000013 236000 3                  LDQ     11
         2 001030   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 001031   200034 630500                    EPPR0   PROJ2$+2,,AUTO
         2 001032   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001033   000000 701000 xent               TSX1    ASB$WRITE_PROJ
         2 001034   000000 011000                    NOP     0

      273    13224    4   ALT:     PROJ_KEY.TXT.PROJECT = KEY.SKEY.USER;

  13224  2 001035   200003 470500       ALT          LDP0    @KEY,,AUTO
         2 001036   040000 100500                    MLR     fill='040'O
         2 001037   000005 400024                    ADSC9   5,,PR0                   cn=2,n=20
         2 001040   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20

      274    13225    4            CALL ASB$PREC_PROJ;

  13225  2 001041   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001042   000000 701000 xent               TSX1    ASB$PREC_PROJ
         2 001043   000000 011000                    NOP     0
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:44   

      275    13226    4            END;

      276    13227    3         END;

      277    13228    2      CALL ASB$DEQ_PROJ;

  13228  2 001044   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001045   000000 701000 xent               TSX1    ASB$DEQ_PROJ
         2 001046   000000 011000                    NOP     0

      278    13229    2      ARS = DSEG2SIZE;

  13229  2 001047   000000 235000 xsym               LDA     DSEG2SIZE
         2 001050   200026 755100                    STA     ARS,,AUTO

      279    13230    2      CALL ASB$READ_PROJ_SEQ( DSEG2$, ARS, 2 ) ALTRET(FINISHED);

  13230  2 001051   000010 236000 3                  LDQ     8
         2 001052   200036 756100                    STQ     PROJ2$+4,,AUTO
         2 001053   200026 630500                    EPPR0   ARS,,AUTO
         2 001054   200035 450500                    STP0    PROJ2$+3,,AUTO
         2 001055   000011 236000 3                  LDQ     9
         2 001056   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 001057   200034 630500                    EPPR0   PROJ2$+2,,AUTO
         2 001060   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001061   000000 701000 xent               TSX1    ASB$READ_PROJ_SEQ
         2 001062   001070 702000 2                  TSX2    FINISHED

      280    13231    2      END;

  13231  2 001063   200003 470500                    LDP0    @KEY,,AUTO
         2 001064   040100 106400                    CMPC    fill='040'O
         2 001065   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20
         2 001066   000005 400024                    ADSC9   5,,PR0                   cn=2,n=20
         2 001067   000423 600000 2                  TZE     s:13156

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:45   
      281    13232    1   FINISHED:
      282    13233    1   ARS = DSEG1SIZE - INITIAL_DSEG1SIZE;

  13233  2 001070   000000 236000 xsym  FINISHED     LDQ     DSEG1SIZE
         2 001071   200030 136100                    SBLQ    INITIAL_DSEG1SIZE,,AUTO
         2 001072   200026 756100                    STQ     ARS,,AUTO

      283    13234    1   IF ARS > 0 THEN CALL ASB$FREE_SEG( 1, ARS );

  13234  2 001073   001104 600000 2                  TZE     s:13235

  13234  2 001074   200026 630500                    EPPR0   ARS,,AUTO
         2 001075   200035 450500                    STP0    PROJ2$+3,,AUTO
         2 001076   000012 236000 3                  LDQ     10
         2 001077   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 001100   200034 630500                    EPPR0   PROJ2$+2,,AUTO
         2 001101   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001102   000000 701000 xent               TSX1    ASB$FREE_SEG
         2 001103   000000 011000                    NOP     0

      284    13235    1   ARS = DSEG2SIZE - INITIAL_DSEG2SIZE;

  13235  2 001104   000000 236000 xsym               LDQ     DSEG2SIZE
         2 001105   200027 136100                    SBLQ    INITIAL_DSEG2SIZE,,AUTO
         2 001106   200026 756100                    STQ     ARS,,AUTO

      285    13236    1   IF ARS > 0 THEN CALL ASB$FREE_SEG( 2, ARS );

  13236  2 001107   001120 600000 2                  TZE     ENQ_ERR

  13236  2 001110   200026 630500                    EPPR0   ARS,,AUTO
         2 001111   200035 450500                    STP0    PROJ2$+3,,AUTO
         2 001112   000010 236000 3                  LDQ     8
         2 001113   200034 756100                    STQ     PROJ2$+2,,AUTO
         2 001114   200034 630500                    EPPR0   PROJ2$+2,,AUTO
         2 001115   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001116   000000 701000 xent               TSX1    ASB$FREE_SEG
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:46   
         2 001117   000000 011000                    NOP     0

      286    13237
      287    13238    1   ENQ_ERR:
      288    13239
      289    13240    1   RETURN ;

  13240  2 001120   000000 702200 xent  ENQ_ERR      TSX2  ! X66_ARET
      290    13241
      291    13242
      292    13243    1   END ASR$R_PROJECT ;

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:47   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
      No diagnostics issued in procedure ASR$R_PROJECT.
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:48   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @FACCOUNT_OPT              3-0-0/w PTR         r     1 @KEY
     4-0-0/w PTR         r     1 @P_COUNT                  26-0-0/w UBIN        r     1 ARS
    *0-0-0/w BIT         r     1 FACCOUNT_OPT              22-0-0/w SBIN        r     1 I
    30-0-0/w UBIN        r     1 INITIAL_DSEG1SIZE         27-0-0/w UBIN        r     1 INITIAL_DSEG2SIZE
    23-0-0/w SBIN        r     1 J                         24-0-0/w SBIN        r     1 K
    *0-0-0/c STRC(378)   r     1 KEY                       21-0-0/b BIT         r     1 MORE
    31-0-0/w PTR         r     1 PROJ1$                    32-0-0/w PTR         r     1 PROJ2$
    *0-0-0/w UBIN        r     1 P_COUNT                    6-0-0/c STRC(378)   r     1 SUB_PROJ_KEY
    25-0-0/w UBIN        r     1 U_COUNT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/b BIT         r     1 AS_FALSE
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/c STRC(189)   r     1 AS_LOGON_KEY               0-0-0/c STRC(189)   r     1 AS_NONE
     0-0-0/b BIT         r     1 AS_TRUE                    0-0-0/w STRC(18576) r     1 AS_USERS
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/w UBIN        r     1 DSEG2SIZE
     0-0-0/b BIT         r     1 DSEG_FLG                   0-0-0/b BIT         r     1 ENQDEQ_FLG
     0-0-0/w UBIN        r     1 LO_WIDTH                   0-0-0/c STRC(243)   r     1 PROJ_KEY
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:49   
     0-0-0/w STRC(108)   r     1 ACCT$LIST(0:0)
     0-0-0/w ASTR(468)   r     1 AS$PROJ                    0-0-0/w STRC(432)   r     1 AS$PROJ_HEADER
     0-0-0/w STRC(43722) r     1 SUPER_TO_PIG


   Procedure ASR$R_PROJECT requires 593 words for executable code.
   Procedure ASR$R_PROJECT requires 32 words of local(AUTO) storage.

    No errors detected in file ASR$REMOVE_PROJECT.:E05TSI    .
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:50   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:51   
          MINI XREF LISTING

ACCT$LIST
     12956**DCL     13196--ASSIGN  13209>>IF      13209>>IF      13210<<ASSIGN  13210>>ASSIGN  13214<<ASSIGN
     13214>>ASSIGN  13220<<ASSIGN  13220>>ASSIGN
ACCT$LIST.ACCT
     12957**DCL     13167>>ASSIGN
ALT
     13224**LABEL   13189--CALLALT
ARS
     12817**DCL     13153<<ASSIGN  13154<>CALL    13170<>CALL    13180<>CALL    13188<<ASSIGN  13189<>CALL
     13196<<ASSIGN  13198>>IF      13199>>ASSIGN  13223<>CALL    13229<<ASSIGN  13230<>CALL    13233<<ASSIGN
     13234>>IF      13234<>CALL    13235<<ASSIGN  13236>>IF      13236<>CALL
AS$PROJ.ATTRIBUTES.COUNT
     12923**DCL     12924--IMP-SIZ 13158>>ASSIGN  13193>>ASSIGN  13202>>ASSIGN
AS$PROJ.CREATOR
     12905**DCL     13173>>IF
AS$PROJ.GRANS_ACCUM
     12914**DCL     13191<<ASSIGN  13191>>ASSIGN  13206<<ASSIGN  13206>>ASSIGN  13206>>ASSIGN
AS$PROJ.MAX_NUM_ACCTS
     12918**DCL     13178<<ASSIGN  13184>>IF      13190>>ASSIGN  13196>>ASSIGN
AS$PROJ.MAX_NUM_GRANS
     12912**DCL     13179<<ASSIGN  13184>>IF      13191>>ASSIGN
AS$PROJ.NUM_ACCTS
     12920**DCL     13156>>IF      13166>>DOINDEX 13174>>IF      13192>>IF      13203>>ASSIGN  13204>>ASSIGN
     13205<<ASSIGN  13205>>ASSIGN  13205>>ASSIGN  13207>>ASSIGN
AS$PROJ.PROJ_REMOVED
     12908**DCL     13177<<ASSIGN
AS$PROJ.SUB_PROJ_ACCTS
     12910**DCL     13190<<ASSIGN  13190>>ASSIGN
AS$PROJ_HEADER
     12936**DCL     13158--ASSIGN  13193--ASSIGN  13202--ASSIGN
ASA_BRKS_LOC
      9948**DCL      9948--REDEF
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:52   
ASB$BINCHAR
      3010**DCL-ENT 13095--CALL
ASB$DELREC_HLP
     12831**DCL-ENT 13046--CALL    13062--CALL    13067--CALL
ASB$DELREC_PROJ
     12861**DCL-ENT 13175--CALL    13183--CALL
ASB$DELREC_USERS
     12828**DCL-ENT 13039--CALL    13045--CALL    13056--CALL    13061--CALL    13066--CALL
ASB$DEQ
     12849**DCL-ENT 13047--CALL    13068--CALL
ASB$DEQ_PROJ
     12867**DCL-ENT 13228--CALL
ASB$ENQ
     12837**DCL-ENT 13044--CALL    13060--CALL    13065--CALL
ASB$ENQ_PROJ
     12855**DCL-ENT 13172--CALL    13187--CALL
ASB$ENQ_USERS
     12840**DCL-ENT 13038--CALL    13055--CALL
ASB$FREE_SEG
     12876**DCL-ENT 13234--CALL    13236--CALL
ASB$GETSEG
     12852**DCL-ENT 13128--CALL
ASB$GET_MORE_SEG
     12882**DCL-ENT 13200--CALL
ASB$PIG
     12885**DCL-ENT 13168--CALL
ASB$PREC_PROJ
     12873**DCL-ENT 13150--CALL    13225--CALL
ASB$PREC_USERS
     12834**DCL-ENT 13007--CALL    13029--CALL
ASB$READ_PROJ
     12879**DCL-ENT 13170--CALL    13189--CALL
ASB$READ_PROJ_SEQ
     12858**DCL-ENT 13154--CALL    13230--CALL
ASB$READ_USERS_SEQ
     12843**DCL-ENT 13009--CALL    13031--CALL
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:53   
ASB$WRITE_PROJ
     12864**DCL-ENT 13180--CALL    13223--CALL
ASH$ERROR
     12870**DCL-ENT 13143--CALL
ASH$INFO
     12846**DCL-ENT 13117--CALL
ASR$R_PROJECT
        13**PROC    13016--CALL
AS_BLANK
      9808**DCL     13002>>ASSIGN  13023>>ASSIGN  13042>>CALLBLT 13058>>CALLBLT 13075>>CALLBLT 13173>>IF
AS_DEFAULT.BANNER_PERM
     10641**DCL     10642--REDEF
AS_DEFAULT.BUDGET.MACCT
     10546**DCL     10550--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10559**DCL     10562--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10542**DCL     10544--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10537**DCL     10539--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10657**DCL     10658--REDEF   10659--REDEF
AS_DEFAULT_DREC.PASSWORD
     11911**DCL     11915--REDEF
AS_DEFAULT_DREC.RENAME
     11934**DCL     11935--REDEF
AS_DFLT.BANNER_PERM
     10463**DCL     10464--REDEF
AS_DFLT.BUDGET.MACCT
     10368**DCL     10372--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10381**DCL     10384--REDEF
AS_DFLT.BUDGET.PACCUM
     10364**DCL     10366--REDEF
AS_DFLT.BUDGET.PMAXC
     10359**DCL     10361--REDEF
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:54   
AS_DFLT.SETUP_CHRA.TXT
     10479**DCL     10480--REDEF   10481--REDEF
AS_FALSE
      9808**DCL     13010>>ASSIGN  13013>>ASSIGN  13032>>ASSIGN  13036>>ASSIGN  13069>>ASSIGN
AS_FE_MODE
      9814**DCL      9815--REDEF
AS_FIELD1.COUNT
      9945**DCL     13078<<ASSIGN
AS_FIELD1.TEXT
      9945**DCL     13076<<CALLBLT
AS_FIELD2.TEXT
      9945**DCL     13095<>CALL
AS_LOGON_KEY.TEXT
      9953**DCL     13162>>ASSIGN
AS_MODE
      9811**DCL      9813--REDEF
AS_MOD_USER.ACCESS
     12676**DCL     12677--REDEF
AS_MOD_USER.BANNER
     12663**DCL     12664--REDEF
AS_MOD_USER.BANNER_PERM
     12665**DCL     12666--REDEF
AS_MOD_USER.BILL
     12671**DCL     12672--REDEF
AS_MOD_USER.CPROC
     12667**DCL     12668--REDEF
AS_MOD_USER.FEBILL
     12747**DCL     12748--REDEF
AS_MOD_USER.FECXTMEM
     12764**DCL     12765--REDEF
AS_MOD_USER.FEMINTS
     12749**DCL     12750--REDEF
AS_MOD_USER.FEMMEM
     12760**DCL     12761--REDEF
AS_MOD_USER.FEMTIME
     12758**DCL     12759--REDEF
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:55   
AS_MOD_USER.FEPPRIV
     12755**DCL     12757--REDEF
AS_MOD_USER.FEPRIV
     12752**DCL     12754--REDEF
AS_MOD_USER.FORCE_BIT
     12661**DCL     12662--REDEF
AS_MOD_USER.KEY
     12743**DCL     12745--REDEF
AS_MOD_USER.LASTCPROC
     12669**DCL     12670--REDEF
AS_MOD_USER.LIMITS.DO_
     12717**DCL     12718--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12733**DCL     12734--REDEF
AS_MOD_USER.LIMITS.LO
     12713**DCL     12714--REDEF
AS_MOD_USER.LIMITS.MEM
     12709**DCL     12710--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12737**DCL     12738--REDEF
AS_MOD_USER.LIMITS.PDIS
     12725**DCL     12726--REDEF
AS_MOD_USER.LIMITS.PO
     12721**DCL     12722--REDEF
AS_MOD_USER.LIMITS.TDIS
     12729**DCL     12730--REDEF
AS_MOD_USER.LIMITS.TIME
     12705**DCL     12706--REDEF
AS_MOD_USER.MAXENQ
     12686**DCL     12687--REDEF
AS_MOD_USER.PERM_BIT
     12659**DCL     12660--REDEF
AS_MOD_USER.PPRIV
     12681**DCL     12683--REDEF
AS_MOD_USER.PRIOB
     12688**DCL     12689--REDEF
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:56   
AS_MOD_USER.PRIV
     12678**DCL     12680--REDEF
AS_MOD_USER.QUAN
     12684**DCL     12685--REDEF
AS_MOD_USER.SETUP
     12657**DCL     12658--REDEF
AS_NONE.TEXT
      9809**DCL     13161>>ASSIGN
AS_PROJECT.BANNER_PERM
     10997**DCL     10998--REDEF
AS_PROJECT.BUDGET.MACCT
     10902**DCL     10906--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     10915**DCL     10918--REDEF
AS_PROJECT.BUDGET.PACCUM
     10898**DCL     10900--REDEF
AS_PROJECT.BUDGET.PMAXC
     10893**DCL     10895--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11013**DCL     11014--REDEF   11015--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11175**DCL     11176--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11080**DCL     11084--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11093**DCL     11096--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11076**DCL     11078--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11071**DCL     11073--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11191**DCL     11192--REDEF   11193--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12397**DCL     12401--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12420**DCL     12421--REDEF
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:57   
AS_PROJECT_DREC.PASSWORD
     12235**DCL     12239--REDEF
AS_PROJECT_DREC.RENAME
     12258**DCL     12259--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10819**DCL     10820--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10724**DCL     10728--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10737**DCL     10740--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     10720**DCL     10722--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10715**DCL     10717--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10835**DCL     10836--REDEF   10837--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12073**DCL     12077--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12096**DCL     12097--REDEF
AS_TRUE
      9808**DCL     13004>>ASSIGN  13026>>ASSIGN  13177>>ASSIGN
AS_USERS
     10170**DCL     13009<>CALL    13031<>CALL
AS_USERS.BANNER_PERM
     10285**DCL     10286--REDEF
AS_USERS.BUDGET.MACCT
     10190**DCL     10194--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10203**DCL     10206--REDEF
AS_USERS.BUDGET.PACCUM
     10186**DCL     10188--REDEF
AS_USERS.BUDGET.PMAXC
     10181**DCL     10183--REDEF
AS_USERS.SETUP_CHRA.TXT
     10301**DCL     10302--REDEF   10303--REDEF
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:58   
AS_USERS_CONSTANT.BANNER_PERM
     11353**DCL     11354--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11258**DCL     11262--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11271**DCL     11274--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11254**DCL     11256--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11249**DCL     11251--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11369**DCL     11370--REDEF   11371--REDEF
DONE_WITH_SUB_PROJS
     13015**LABEL   13009--CALLALT
DONE_WITH_USERS
     13043**LABEL   13031--CALLALT
DSEG1$
      9949**DCL     12961--IMP-PTR 13159>>ASSIGN  13160>>ASSIGN  13161>>ASSIGN  13162>>ASSIGN  13163>>ASSIGN
     13164>>ASSIGN  13165>>ASSIGN  13167>>ASSIGN  13168>>CALL    13189<>CALL    13190>>ASSIGN  13190>>ASSIGN
     13191>>ASSIGN  13191>>ASSIGN  13193>>ASSIGN  13193>>ASSIGN  13196>>ASSIGN  13196>>ASSIGN  13203>>ASSIGN
     13205>>ASSIGN  13205>>ASSIGN  13206>>ASSIGN  13206>>ASSIGN  13207>>ASSIGN  13223<>CALL
DSEG1SIZE
      9950**DCL     13151>>ASSIGN  13188>>ASSIGN  13198>>IF      13199>>ASSIGN  13233>>ASSIGN
DSEG2$
      9950**DCL     12903--IMP-PTR 13154<>CALL    13156>>IF      13158>>ASSIGN  13158>>ASSIGN  13166>>DOINDEX
     13170<>CALL    13173>>IF      13174>>IF      13177>>ASSIGN  13178>>ASSIGN  13179>>ASSIGN  13180<>CALL
     13184>>IF      13184>>IF      13190>>ASSIGN  13191>>ASSIGN  13192>>IF      13202>>ASSIGN  13202>>ASSIGN
     13204>>ASSIGN  13205>>ASSIGN  13206>>ASSIGN  13230<>CALL
DSEG2SIZE
      9950**DCL     13152>>ASSIGN  13153>>ASSIGN  13229>>ASSIGN  13235>>ASSIGN
DSEG_FLG
      9949**DCL     13127>>IF
ENQDEQ_FLG
      9951**DCL     13069<<ASSIGN
ENQ_ERR
     13240**LABEL   13038--CALLALT 13044--CALLALT 13055--CALLALT 13060--CALLALT 13065--CALLALT
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:59   
ERR_CODE
      9943**DCL      9944--REDEF
FACCOUNT_OPT
        27**DCL        13--PROC    13016<>CALL    13156>>IF
FINISHED
     13233**LABEL   13154--CALLALT 13170--CALLALT 13230--CALLALT
GETSEG_ERR
     13143**LABEL   13200--CALLALT
I
     12813**DCL     13042<<CALLBLT 13043>>ASSIGN  13075<<CALLBLT 13076>>CALLBLT 13078>>ASSIGN  13166<<DOINDEX
     13167>>ASSIGN  13203<<ASSIGN  13208>>DOWHILE 13209>>IF      13214>>ASSIGN  13215<<ASSIGN  13215>>ASSIGN
     13219<<DOINDEX 13220>>ASSIGN  13220>>ASSIGN
INITIAL_DSEG1SIZE
     12819**DCL     13151<<ASSIGN  13233>>ASSIGN
INITIAL_DSEG2SIZE
     12818**DCL     13152<<ASSIGN  13235>>ASSIGN
J
     12814**DCL     13058<<CALLBLT 13059>>ASSIGN  13076>>CALLBLT 13078>>ASSIGN  13199<<ASSIGN  13200<>CALL
     13204<<ASSIGN  13208>>DOWHILE 13209>>IF      13210>>ASSIGN  13211<<ASSIGN  13211>>ASSIGN  13219>>DOINDEX
K
     12815**DCL     13207<<ASSIGN  13210>>ASSIGN  13214>>ASSIGN  13217<<ASSIGN  13217>>ASSIGN
KEY
        19**DCL        13--PROC    13054>>ASSIGN
KEY.SKEY.CREATOR
        24**DCL     13161>>ASSIGN  13186>>ASSIGN
KEY.SKEY.USER
        25**DCL     13001>>ASSIGN  13034>>IF      13057>>ASSIGN  13149>>ASSIGN  13155>>DOWHILE 13163>>ASSIGN
     13224>>ASSIGN
KEY.TEXT
        21**DCL        22--REDEF
KL_DEFAULT.PASSWORD
     12559**DCL     12563--REDEF
KL_DEFAULT.RENAME
     12582**DCL     12583--REDEF
KL_DFLT.PASSWORD
     11749**DCL     11753--REDEF
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:60   
KL_DFLT.RENAME
     11772**DCL     11773--REDEF
KL_DREC.PASSWORD
     11587**DCL     11591--REDEF
KL_DREC.RENAME
     11610**DCL     11611--REDEF
KL_DREC_CNT.PASSWORD
     11474**DCL     11478--REDEF
KL_DREC_CNT.RENAME
     11497**DCL     11498--REDEF
LO_WIDTH
      9825**DCL     13160>>ASSIGN
MORE
     12812**DCL     13004<<ASSIGN  13005>>DOWHILE 13010<<ASSIGN  13013<<ASSIGN  13026<<ASSIGN  13027>>DOWHILE
     13032<<ASSIGN  13036<<ASSIGN
PROJ1$
     12820**DCL     13193<<ASSIGN  13196>>ASSIGN  13209>>IF      13210>>ASSIGN  13214>>ASSIGN  13214>>ASSIGN
     13220>>ASSIGN
PROJ2$
     12821**DCL     13158<<ASSIGN  13167>>ASSIGN  13202<<ASSIGN  13209>>IF      13210>>ASSIGN  13220>>ASSIGN
PROJ_KEY.COUNT
      9821**DCL     13148<<ASSIGN
PROJ_KEY.TEXT
      9821**DCL      9821--REDEF   13149<<ASSIGN
PROJ_KEY.TXT.PACKSET
      9822**DCL     13164>>ASSIGN
PROJ_KEY.TXT.PROJECT
      9821**DCL      9821--REDEF   13155>>DOWHILE 13186<<ASSIGN  13224<<ASSIGN
P_COUNT
        26**DCL        13--PROC    13016<>CALL    13070<<ASSIGN  13070>>ASSIGN
REMEM_VAR
      9947**DCL      9947--REDEF
REM_FCMD
      9947**DCL      9948--REDEF
SUB_PROJ_KEY
     12805**DCL     13006>>ASSIGN  13015<<ASSIGN  13016<>CALL    13028>>ASSIGN  13040<<ASSIGN
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:61   
SUB_PROJ_KEY.COUNT
     12806**DCL     13003<<ASSIGN  13024<<ASSIGN
SUB_PROJ_KEY.SKEY.CREATOR
     12810**DCL     13001<<ASSIGN  13012>>IF
SUB_PROJ_KEY.SKEY.PROJ
     12809**DCL     13000<<ASSIGN  13022<<ASSIGN
SUB_PROJ_KEY.SKEY.USER
     12811**DCL     13002<<ASSIGN  13023<<ASSIGN  13041>>ASSIGN
SUB_PROJ_KEY.TEXT
     12807**DCL     12808--REDEF
SUPER_TO_PIG
     12961**DCL     13168<>CALL
SUPER_TO_PIG.ACCT
     12982**DCL     13167<<ASSIGN
SUPER_TO_PIG.ATTR.COUNT
     12984**DCL     13165<<ASSIGN
SUPER_TO_PIG.PACKSET
     12981**DCL     13164<<ASSIGN
SUPER_TO_PIG.PROJ
     12970**DCL     13161<<ASSIGN
SUPER_TO_PIG.PROJECT
     12977**DCL     12980--REDEF
SUPER_TO_PIG.PROJECT_TEXT
     12980**DCL     13163<<ASSIGN
SUPER_TO_PIG.RESUPER
     12976**DCL     13162<<ASSIGN
SUPER_TO_PIG.SUPER
     12973**DCL     12976--REDEF
SUPER_TO_PIG.TYPE
     12962**DCL     13159<<ASSIGN
SUPER_TO_PIG.WIDTH
     12972**DCL     13160<<ASSIGN
USERS_KEY
      9818**DCL     13006<<ASSIGN  13015>>ASSIGN  13028<<ASSIGN  13040>>ASSIGN  13054<<ASSIGN
USERS_KEY.COUNT
      9818**DCL     13010>>IF      13032>>IF      13043<<ASSIGN  13059<<ASSIGN  13063<<ASSIGN
PL6.E3A0      #001=ASR$R_PROJECT File=ASR$REMOVE_PROJECT.:E05TSI                 TUE 07/29/97 10:50 Page:62   
USERS_KEY.SKEY.CREATOR
      9820**DCL     13012>>IF      13034>>IF
USERS_KEY.SKEY.PROJ
      9820**DCL     13034>>IF
USERS_KEY.TEXT
      9818**DCL      9819--REDEF    9819--REDEF    9819--REDEF    9820--REDEF
USERS_KEY.TXTC
      9819**DCL     13041<<ASSIGN  13057<<ASSIGN  13076>>CALLBLT 13076>>CALLBLT
USERS_KEY.UKEY.ACCT
      9819**DCL     13075>>CALLBLT
USERS_KEY.UKEY.S
      9820**DCL     13064<<ASSIGN
USERS_KEY.UKEY.UNAME
      9820**DCL     13042>>CALLBLT 13058>>CALLBLT
U_COUNT
     12816**DCL     13025<<ASSIGN  13048<<ASSIGN  13048>>ASSIGN  13095<>CALL
