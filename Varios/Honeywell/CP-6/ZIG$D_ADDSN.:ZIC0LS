
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:1    
        1        1        /*M* ADD_SN         I-D-S/II    DBACS DDL TRANSLATOR */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:  ADD_SN
        9        9        PURPOSE:  Called by ZIG$D_PSET to generate SN and NR records.
       10       10        */
       11       11        ADD_SN:
       12       12            PROC(TYPE,WORD1,DCLR,LN,FND,RLTYPE,IMPLCIT,RC_DBK);
       13       13        /************************************
       14       14        * for filling in fields in SN record*
       15       15        ************************************/
       16       16    1   DCL WORD1 CHAR(30); /* uwa.sn.sename */
       17       17    1   DCL DCLR SBIN(36); /* uwa.sn.dclr */
       18       18    1   DCL LN UBIN(36); /* uwa.sn.lno */
       19       19    1   DCL TYPE UBIN(36); /* uwa.sn.setype */
       20       20        /*******************************
       21       21        * to signal that SN with       *
       22       22        * SENAME=WORD1 has been found  *
       23       23        *******************************/
       24       24    1   DCL FND UBIN WORD;
       25       25    1   DCL RC_DBK UBIN (36);
       26       26        /*D*     NAME:     RC_DBK
       27       27        DESCRIPTION:
       28       28              This is the DBK of the rc record that this field is owned
       29       29            by. If zero is given then find any field with the that name.
       30       30        */
       31       31        /************************************
       32       32        * for filling in fields in NR record*
       33       33        ************************************/
       34       34    1   DCL RLTYPE SBIN WORD; /* uwa.nr.reltype */
       35       35    1   DCL IMPLCIT SBIN WORD; /* uwa.nr.implct */
       36       36        /***********************************
       37       37        * first SN of its type in DA-SN set*
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:2    
       38       38        ***********************************/
       39       39    1   DCL LAST_RC_DBK UBIN (36) EXT;
       40       40    1   DCL LAST_SN_DBK UBIN WORD; /* for saving SN currency if need to add NR */
       41       41    1   DCL ABORT ENTRY;
       42       42        /* need to keep track of DBK of last defined record, set and key
       43       43           for purposes of adding NR records */
       44       44    1   DCL LAST_DEF_KEY_DBK UBIN WORD STATIC;
       45       45    1   DCL LN_DIFF UBIN WORD;
       46       46    1   DCL DBK UBIN (36) ALIGNED STATIC;
       47       47        /*
       48       48              Now come the data things needed to do memory searches for
       49       49            names in the SN records.
       50       50        */
       51       51    1   DCL NUMB_AREA_SN UBIN (36) EXT;
       52       52    1   DCL NUMB_KEY_SN UBIN (36) EXT;
       53       53    1   DCL AREA$ PTR EXT;
       54       54    1   DCL KEY$ PTR EXT;
       55       55    1   DCL STRING CHAR (LEN_STRING) BASED;
       56       56    1   DCL LEN_STRING UBIN (36) STATIC;
       57       57    1   DCL ZIG$ALLOCATE ENTRY (3) ALTRET;
       58       58    1   DCL PTR$ PTR STATIC;
       59       59    1   DCL LAST_RC$ PTR EXT;
       60       60        %EQU DS6 = 5 /* AREA, SET, KEY, RECORD info .*/;
       61       61        %EQU DS7 = 6 /* FIELD info .*/;
       62       62    1   DCL ZIG$MRL ENTRY (3);
       63       63    1   DCL PTR1$ PTR STATIC;
       64       64    1   DCL PTR2$ PTR STATIC;
       65       65    1   DCL MOVE_LEN UBIN (36) STATIC;
       66       66    1   DCL TABLE_POS SBIN (36) STATIC;
       67       67    1   DCL POS_WORD CHAR (30) STATIC;
       68       68    1   DCL ERROR ENTRY(1);
       69       69        %INCLUDE ZIG_TYPE_SUBS;
       70       84        %INCLUDE ZIG_DDL_INCL;
       71      346         %DDL_XLATE;
       72      441        %INCLUDE ZI_SUB4_CAN;
       73     1098        %UWA;
       74     1433        %INCLUDE ZIG_DBA_INT;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:3    
       75     1481    1   SEARCH_BIN:
       76     1482    1       PROC (LIST$,LEN,WORD1,TABLE_POS);
       77     1483    2   DCL LIST$ PTR;
       78     1484    2   DCL LEN UBIN (36);
       79     1485    2   DCL WORD1 CHAR (30);
       80     1486    2   DCL TABLE_POS SBIN (36);
       81     1487    2   DCL HIGH_POS SBIN (36) STATIC;
       82     1488    2   DCL LOW_POS SBIN (36) STATIC;
       83     1489    2   DCL POS SBIN (36) STATIC;
       84     1490    2       HIGH_POS = LEN - 1;
       85     1491    2       LOW_POS = 0;
       86     1492    2       IF HIGH_POS = -1
       87     1493    3       THEN DO;
       88     1494    3           CALL FCURR_R_6('DA   ');
       89     1495    3           TABLE_POS = -1;
       90     1496    3           RETURN;
       91     1497    3           END;
       92     1498    3       DO WHILE ('1'B);
       93     1499    3           POS = ( HIGH_POS + LOW_POS ) / 2;
       94     1500    3           POS_WORD = LIST$ -> TABLES.NAME(POS);
       95     1501    3           IF POS_WORD > WORD1
       96     1502    4           THEN DO;
       97     1503    4               HIGH_POS = POS;
       98     1504    4               END;
       99     1505    4           ELSE DO;
      100     1506    4               IF POS_WORD < WORD1
      101     1507    5               THEN DO;
      102     1508    5                   LOW_POS = POS;
      103     1509    5                   END;
      104     1510    5               ELSE DO;
      105     1511    5                   FND = %FOUNDREF;
      106     1512    5                   TABLE_POS = POS;
      107     1513    5                   IF (LIST$ = FIELD$)
      108     1514    6                   THEN DO;
      109     1515    6                       CALL FIND_RIGHT_FIELD(POS);
      110     1516    6                       TABLE_POS = POS;
      111     1517    6                       END;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:4    
      112     1518         /* table_pos=-1 if this user-name belongs in front
      113     1519            of all others of its type, so find the first one
      114     1520            of its type and back up one, otherwise just
      115     1521            fetch the sn just prior to where this goes */
      116     1522    5                   IF TABLE_POS = -1 THEN
      117     1523    6                   DO;
      118     1524    6                       DBK = LIST$ -> TABLES.DBK(0);
      119     1525    6                       CALL FINDD_6('SN      ',DBK);
      120     1526    6                       CALL FETCHPS_6('DA-SN   ');
      121     1527    6                       IF UWA.DB_STATUS = '0502100' THEN
      122     1528    6                           CALL FCURR_R_6('DA      '); /* DA */
      123     1529    6                       END;
      124     1530    5                   ELSE
      125     1531    6                   DO;
      126     1532    6                       DBK = LIST$ -> TABLES.DBK(TABLE_POS);
      127     1533    6                       CALL FETCHD_6('SN  ',DBK);
      128     1534    6                       END;
      129     1535    5                   RETURN;
      130     1536    5                   END;
      131     1537    4               END;
      132     1538    3           IF HIGH_POS = LOW_POS OR (( HIGH_POS + LOW_POS) / 2 = LOW_POS)
      133     1539    4           THEN DO;
      134     1540    4               IF WORD1 = LIST$ -> TABLES.NAME(HIGH_POS)
      135     1541    4                  OR WORD1 = LIST$ -> TABLES.NAME(LOW_POS)
      136     1542    5               THEN DO;
      137     1543    5                   IF WORD1 = LIST$ -> TABLES.NAME(LOW_POS)
      138     1544    5                   THEN POS = LOW_POS;
      139     1545    5                   ELSE POS = HIGH_POS;
      140     1546    5                   FND = %FOUNDREF;
      141     1547    5                   TABLE_POS = POS;
      142     1548    5                   IF (LIST$ = FIELD$)
      143     1549    6                   THEN DO;
      144     1550    6                       CALL FIND_RIGHT_FIELD(POS);
      145     1551    6                       TABLE_POS = POS;
      146     1552    6                       END;
      147     1553         /* table_pos=-1 if this user-name belongs in front
      148     1554            of all others of its type, so find the first one
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:5    
      149     1555            of its type and back up one, otherwise just
      150     1556            fetch the sn just prior to where this goes */
      151     1557    5                   IF TABLE_POS = -1 THEN
      152     1558    6                   DO;
      153     1559    6                       DBK = LIST$ -> TABLES.DBK(0);
      154     1560    6                       CALL FINDD_6('SN      ',DBK);
      155     1561    6                       CALL FETCHPS_6('DA-SN   ');
      156     1562    6                       IF UWA.DB_STATUS = '0502100' THEN
      157     1563    6                           CALL FCURR_R_6('DA      '); /* DA */
      158     1564    6                       END;
      159     1565    5                   ELSE
      160     1566    6                   DO;
      161     1567    6                       DBK = LIST$ -> TABLES.DBK(TABLE_POS);
      162     1568    6                       CALL FETCHD_6('SN  ',DBK);
      163     1569    6                       END;
      164     1570    5                   RETURN;
      165     1571    5                   END;
      166     1572    5               ELSE DO;
      167     1573    5                   IF WORD1 < LIST$ -> TABLES.NAME(HIGH_POS)
      168     1574    6                   THEN DO;
      169     1575    6                       IF WORD1 < LIST$ -> TABLES.NAME(LOW_POS)
      170     1576    7                       THEN DO;
      171     1577    7                           TABLE_POS = LOW_POS - 1;
      172     1578    7                           END;
      173     1579    7                       ELSE DO;
      174     1580    7                           TABLE_POS = LOW_POS;
      175     1581    7                           END;
      176     1582    6                       END;
      177     1583    6                   ELSE DO;
      178     1584    6                       TABLE_POS = HIGH_POS;
      179     1585    6                       END;
      180     1586    5                   END;
      181     1587         /* table_pos=-1 if this user-name belongs in
      182     1588            front of all others of its type, so find the
      183     1589            first one of its type and back up one , otherwise
      184     1590            just fetch the sn just prior to where this
      185     1591            one belongs */
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:6    
      186     1592    4               IF TABLE_POS = -1 THEN
      187     1593    5               DO;
      188     1594    5                   DBK = LIST$ -> TABLES.DBK(0);
      189     1595    5                   CALL FINDD_6('SN      ',DBK);
      190     1596    5                   CALL FETCHPS_6('DA-SN   ');
      191     1597    5                   IF UWA.DB_STATUS = '0502100' THEN /* DA */
      192     1598    5                       CALL FCURR_R_6('DA      ');
      193     1599    5                   END;
      194     1600    4               ELSE
      195     1601    5               DO;
      196     1602    5                   DBK = LIST$ -> TABLES.DBK(TABLE_POS);
      197     1603    5                   CALL FETCHD_6('SN  ',DBK);
      198     1604    5                   END;
      199     1605    4               RETURN;
      200     1606    4               END;
      201     1607    3           END;
      202     1608    2   END SEARCH_BIN;
      203     1609        %EJECT;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:7    
      204     1610    1   ADD_TABLE:
      205     1611    1       PROC(POS,PTR$,NUMB_IN_TABLE);
      206     1612    2   DCL POS SBIN (36);
      207     1613    2   DCL PTR$ PTR;
      208     1614    2   DCL NUMB_IN_TABLE UBIN (36);
      209     1615    2       IF TYPE = %ZIG_RTYPE_FR
      210     1616    3       THEN DO;
      211     1617    3           CALL ZIG$ALLOCATE(%DS7,9,PTR1$) ALTRET(NO_NO);
      212     1618    3           END;
      213     1619    3       ELSE DO;
      214     1620    3           CALL ZIG$ALLOCATE(%DS6,9,PTR1$) ALTRET(NO_NO);
      215     1621    3           END;
      216     1622    2       IF NUMB_IN_TABLE > 0
      217     1623    3       THEN DO;
      218     1624    3           PTR1$ = ADDR(PTR$ -> TABLES.NAME(POS));
      219     1625    3           PTR2$ = PINCRW(PTR1$,9);
      220     1626    3           MOVE_LEN = ((NUMB_IN_TABLE - POS) * 9 * 4);
      221     1627    3           CALL ZIG$MRL(PTR1$ -> TABLES,PTR2$ -> TABLES,MOVE_LEN);
      222     1628    3           END;
      223     1629    2       PTR$ -> TABLES.NAME(POS) = WORD1;
      224     1630    2       PTR$ -> TABLES.DBK_RC(POS) = RC_DBK;
      225     1631    2       IF DCLR = 1
      226     1632    2       THEN PTR$ -> TABLES.DEFINED(POS) = '1'B;
      227     1633    2       ELSE PTR$ -> TABLES.DEFINED(POS) = '0'B;
      228     1634    2       PTR$ -> TABLES.DBK(POS) = UWA.DIRECT_REF;
      229     1635    2       IF TYPE = %ZIG_RTYPE_RC THEN LAST_RC$ = PINCRW(PTR$,POS*9);
      230     1636    2       RETURN;
      231     1637    2   NO_NO:
      232     1638    2       CALL ABORT;
      233     1639    2       RETURN;
      234     1640    2   END ADD_TABLE;
      235     1641        %EJECT;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:8    
      236     1642    1   FIND_RIGHT_FIELD:
      237     1643    1       PROC(POS);
      238     1644    2   DCL POS SBIN (36);
      239     1645    2   DCL COUNT UBIN (36) STATIC;
      240     1646    2   DCL EXIT_DO BIT(1) STATIC;
      241     1647    2       COUNT = 0;
      242     1648    2       EXIT_DO = '0'B;
      243     1649    2       IF RC_DBK = 0 THEN /* looking for field in any record */
      244     1650    3       DO;
      245     1651    4           DO WHILE (POS>=0 AND FIELD$->TABLES.NAME(POS)=WORD1);
      246     1652    4               POS = POS - 1; /* back up while still same fieldname */
      247     1653    4               END;
      248     1654    3           POS = POS + 1; /*position to last entry with this name */
      249     1655    4           DO WHILE (FIELD$->TABLES.NAME(POS)=WORD1 AND POS<=NUMB_FIELD_SN);
      250     1656    4               IF FIELD$->TABLES.DBK_RC(POS)~=0 THEN COUNT = COUNT + 1;
      251     1657    4               POS = POS + 1; /* count # defined fields with this name */
      252     1658    4               END;
      253     1659    3           POS = POS - 1; /*position to last entry with this name */
      254     1660    3           IF COUNT >= 2
      255     1661    3           THEN FND = %FOUNDDUP; /* needs qualifier */
      256     1662    3           ELSE IF FIELD$->TABLES.DBK_RC(POS)~=0
      257     1663    3               THEN FND = %FOUNDDEF;
      258     1664    3               ELSE FND = %FOUNDREF;
      259     1665    3           RETURN;
      260     1666    3           END;
      261     1667    2       IF FIELD$ -> TABLES.DBK_RC(POS) = RC_DBK THEN RETURN;
      262     1668    3       DO WHILE (FIELD$ -> TABLES.DBK_RC(POS) ~= RC_DBK AND
      263     1669    3          FIELD$ -> TABLES.NAME(POS) = WORD1 AND POS > 0);
      264     1670    3           POS = POS - 1;
      265     1671    3           COUNT = COUNT + 1;
      266     1672    3           END;
      267     1673    2       IF FIELD$->TABLES.NAME(POS) ~= WORD1 THEN POS = POS + 1;
      268     1674    3       DO WHILE (FIELD$ -> TABLES.DBK_RC(POS) ~= RC_DBK
      269     1675    3          AND FIELD$ -> TABLES.NAME(POS) = WORD1 AND ~EXIT_DO);
      270     1676    3           POS = POS + 1;
      271     1677    3           IF POS = NUMB_FIELD_SN THEN
      272     1678    4           DO;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:9    
      273     1679    4               POS = POS - 1;
      274     1680    4               EXIT_DO = '1'B;
      275     1681    4               END;
      276     1682    3           COUNT = COUNT + 1;
      277     1683    3           END;
      278     1684    2       IF FIELD$ -> TABLES.DBK_RC(POS) = RC_DBK AND
      279     1685    2          FIELD$ -> TABLES.NAME(POS) = WORD1
      280     1686    3       THEN DO;
      281     1687    3           IF FIELD$->TABLES.DEFINED(POS) = '1'B
      282     1688    3           THEN FND = %FOUNDDEF;
      283     1689    3           ELSE FND = %FOUNDREF;
      284     1690    3           RETURN;
      285     1691    3           END;
      286     1692    2       IF FIELD$->TABLES.NAME(POS) ~= WORD1
      287     1693    2       THEN POS = POS - 1;
      288     1694    2       FND = %NOTFOUND;
      289     1695    2       RETURN;
      290     1696    2   END FIND_RIGHT_FIELD;
      291     1697        %EJECT;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:10   
      292     1698    1       FND = %NOTFOUND;
      293     1699    2       DO CASE(TYPE);
      294     1700    2       CASE (%ZIG_RTYPE_FR);
      295     1701    2           CALL SEARCH_BIN(FIELD$,NUMB_FIELD_SN,WORD1,TABLE_POS);
      296     1702    2       CASE (%ZIG_RTYPE_RC);
      297     1703    2           CALL SEARCH_BIN(RECORD$,NUMB_RECORD_SN,WORD1,TABLE_POS);
      298     1704    2       CASE (%ZIG_RTYPE_AC);
      299     1705    2           CALL SEARCH_BIN(AREA$,NUMB_AREA_SN,WORD1,TABLE_POS);
      300     1706    2       CASE (%ZIG_RTYPE_SC);
      301     1707    2           CALL SEARCH_BIN(SET$,NUMB_SET_SN,WORD1,TABLE_POS);
      302     1708    2       CASE (%ZIG_RTYPE_KC);
      303     1709    2           CALL SEARCH_BIN(KEY$,NUMB_KEY_SN,WORD1,TABLE_POS);
      304     1710    2           END;
      305     1711    1       IF FND ~= %NOTFOUND
      306     1712    2       THEN DO;
      307     1713    2           IF FND ~= %FOUNDDUP
      308     1714    3           THEN DO;
      309     1715    3               IF UWA.SN.DCLR = 1
      310     1716    3               THEN FND = %FOUNDDEF;
      311     1717    3               ELSE FND = %FOUNDREF;
      312     1718    3               END;
      313     1719         /* if this is the definition of a forward reference, then
      314     1720            update the SN to show forward ref satisfied,
      315     1721            update current def dbk (nrwu),
      316     1722            DONT call add_nr (unless it is a key )
      317     1723            otherwise, its not a def so call add_nr. */
      318     1724    3           IF DCLR = 1 THEN DO;
      319     1725    3               IF TYPE ~= %ZIG_RTYPE_KC THEN UWA.SN.LNO = LN;
      320     1726    3               UWA.SN.DCLR = 1;
      321     1727    3               CALL MODIFY_6('SN      ');
      322     1728    4               DO CASE(TYPE);
      323     1729    4               CASE(%ZIG_RTYPE_RC);
      324     1730    4                   LAST_DEF_REC_DBK = UWA.DIRECT_REF;
      325     1731    4                   RECORD$ -> TABLES.DEFINED(TABLE_POS) = '1'B;
      326     1732    4               CASE(%ZIG_RTYPE_SC);
      327     1733    4                   LAST_DEF_SET_DBK = UWA.DIRECT_REF;
      328     1734    4                   SET$ -> TABLES.DEFINED(TABLE_POS) = '1'B;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:11   
      329     1735    4               CASE(%ZIG_RTYPE_KC);
      330     1736    4                   LAST_DEF_KEY_DBK = UWA.DIRECT_REF;
      331     1737    4                   KEY$ -> TABLES.DEFINED(TABLE_POS) = '1'B;
      332     1738    4                   CALL ADD_NR;
      333     1739    4               CASE (%ZIG_RTYPE_FR);
      334     1740    4                   FIELD$ -> TABLES.DEFINED(TABLE_POS) = '1'B;
      335     1741    4               CASE (%ZIG_RTYPE_AC);
      336     1742    4                   AREA$ -> TABLES.DEFINED(TABLE_POS) = '1'B;
      337     1743    4                   END; /*CASE*/
      338     1744    3               END;
      339     1745    3           ELSE DO;
      340     1746    3               IF TYPE = %ZIG_RTYPE_RC
      341     1747    3               THEN LAST_RC$ = ADDR(RECORD$->TABLES(TABLE_POS));
      342     1748    3               IF RLTYPE ~= RELTYPE.NO_NR THEN
      343     1749    3                   CALL ADD_NR;
      344     1750    3               END;
      345     1751    2           RETURN;
      346     1752    2           END;
      347     1753    1   STORE_SN: IF UWA.DIRECT_REF = UWA.SF.DBKEY_DA THEN
      348     1754    1           CALL FETCHNS_6('DA-SN   '); /* SN of schema name */
      349     1755    1       UWA.SN = '0'B;
      350     1756    1       UWA.SN.DCLR = DCLR;
      351     1757    1       UWA.SN.SETYPE = TYPE;
      352     1758    1       UWA.SN.LNO = LN;
      353     1759    1       UWA.SN.SENAME = WORD1;
      354     1760    1       CALL STRE_6('SN      ');
      355     1761    1       UWA.DA.NUMB_SN = UWA.DA.NUMB_SN + 1;
      356     1762    2       DO CASE(TYPE);
      357     1763    2       CASE(%ZIG_RTYPE_FR);
      358     1764    2           CALL ADD_TABLE(TABLE_POS+1,FIELD$,NUMB_FIELD_SN);
      359     1765    2           NUMB_FIELD_SN = NUMB_FIELD_SN + 1;
      360     1766    2           IF TABLE_POS = -1 THEN UWA.DA.FRST_FR = UWA.DIRECT_REF;
      361     1767    2       CASE(%ZIG_RTYPE_AC);
      362     1768    2           CALL ADD_TABLE(TABLE_POS+1,AREA$,NUMB_AREA_SN+NUMB_KEY_SN+NUMB_RECORD_SN+
              1768                    NUMB_SET_SN);
      363     1769    2           NUMB_AREA_SN = NUMB_AREA_SN + 1;
      364     1770    2           IF TABLE_POS = -1 THEN UWA.DA.FRST_AC = UWA.DIRECT_REF;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:12   
      365     1771    2           SET$ = PINCRW(SET$,9);
      366     1772    2           KEY$ = PINCRW(KEY$,9);
      367     1773    2           RECORD$ = PINCRW(RECORD$,9);
      368     1774    2       CASE(%ZIG_RTYPE_RC);
      369     1775    2           CALL ADD_TABLE(TABLE_POS+1,RECORD$,NUMB_RECORD_SN+NUMB_SET_SN);
      370     1776    2           NUMB_RECORD_SN = NUMB_RECORD_SN + 1;
      371     1777    2           IF TABLE_POS = -1 THEN UWA.DA.FRST_RC = UWA.DIRECT_REF;
      372     1778    2           IF DCLR = 1 THEN LAST_DEF_REC_DBK = UWA.DIRECT_REF;
      373     1779    2           SET$ = PINCRW(SET$,9);
      374     1780    2       CASE(%ZIG_RTYPE_SC);
      375     1781    2           CALL ADD_TABLE(TABLE_POS+1,SET$,NUMB_SET_SN);
      376     1782    2           NUMB_SET_SN = NUMB_SET_SN + 1;
      377     1783    2           IF TABLE_POS = -1 THEN UWA.DA.FRST_SC = UWA.DIRECT_REF;
      378     1784    2           IF DCLR = 1 THEN LAST_DEF_SET_DBK = UWA.DIRECT_REF;
      379     1785    2       CASE(%ZIG_RTYPE_KC);
      380     1786    2           CALL ADD_TABLE(TABLE_POS+1,KEY$,NUMB_KEY_SN+NUMB_RECORD_SN+NUMB_SET_SN);
      381     1787    2           NUMB_KEY_SN = NUMB_KEY_SN + 1;
      382     1788    2           IF TABLE_POS = -1 THEN UWA.DA.FRST_KC = UWA.DIRECT_REF;
      383     1789    2           RECORD$ = PINCRW(RECORD$,9);
      384     1790    2           SET$ = PINCRW(SET$,9);
      385     1791    3           IF DCLR = 1 THEN DO;
      386     1792    3               LAST_DEF_KEY_DBK = UWA.DIRECT_REF;
      387     1793    3               END;
      388     1794    2           END;
      389     1795    1       IF RLTYPE ~= RELTYPE.NO_NR THEN
      390     1796    1           CALL ADD_NR;
      391     1797    1       RETURN;
      392     1798
      393     1799        %EJECT;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:13   
      394     1800    1   JUST_FIND_SN:
      395     1801    1       ENTRY(TYPE,WORD1,DCLR,LN,FND,RLTYPE,IMPLCIT,RC_DBK);
      396     1802    1       FND = %NOTFOUND;
      397     1803    2       DO CASE(TYPE);
      398     1804    2       CASE (%ZIG_RTYPE_FR);
      399     1805    2           CALL SEARCH_BIN(FIELD$,NUMB_FIELD_SN,WORD1,TABLE_POS);
      400     1806    2       CASE (%ZIG_RTYPE_RC);
      401     1807    2           CALL SEARCH_BIN(RECORD$,NUMB_RECORD_SN,WORD1,TABLE_POS);
      402     1808    2       CASE (%ZIG_RTYPE_AC);
      403     1809    2           CALL SEARCH_BIN(AREA$,NUMB_AREA_SN,WORD1,TABLE_POS);
      404     1810    2       CASE (%ZIG_RTYPE_SC);
      405     1811    2           CALL SEARCH_BIN(SET$,NUMB_SET_SN,WORD1,TABLE_POS);
      406     1812    2       CASE (%ZIG_RTYPE_KC);
      407     1813    2           CALL SEARCH_BIN(KEY$,NUMB_KEY_SN,WORD1,TABLE_POS);
      408     1814    2           END;
      409     1815    1       RETURN;
      410     1816        %EJECT;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:14   
      411     1817    1   ADD_NR: PROC;
      412     1818
      413     1819    2       LN_DIFF = 0;
      414     1820    2       IF (RLTYPE = RELTYPE.KEY_IN_REC) OR (RLTYPE = RELTYPE.FLD_IN_KEY) THEN
      415     1821    2           LN_DIFF = 1;
      416     1822    2       LAST_SN_DBK = UWA.DIRECT_REF; /* save currency so can restore later */
      417     1823    2       UWA.NR = '0'B;
      418     1824    2       UWA.NR.IMPLCT = IMPLCIT;
      419     1825    2       UWA.NR.RELTYPE = RLTYPE;
      420     1826    2       UWA.NR.LNO = LN + LN_DIFF;
      421     1827    2       CALL STRE_6('NR      ');
      422     1828    2       UWA.DA.NUMB_NR = UWA.DA.NUMB_NR + 1;
      423     1829    3       DO CASE(RLTYPE);
      424     1830    3       CASE(8,9,11);
      425     1831    3           CALL FINDD_6('SN      ',LAST_DEF_SET_DBK);
      426     1832    3       CASE(3,4);
      427     1833    3           CALL FINDD_6('RC      ',RC_DBK); /* RC */
      428     1834    3           CALL FINDOS_6('SN-SE   '); /* SN */
      429     1835    3       CASE(6,7,17);
      430     1836    3           CALL FINDD_6('SN      ',LAST_DEF_REC_DBK);
      431     1837    3       CASE(18);
      432     1838    3           CALL FINDD_6('SN      ',LAST_DEF_KEY_DBK);
      433     1839    3           END; /*CASE*/
      434     1840    2       CALL FCURR_R_6('NR      ');
      435     1841    2       CALL CONNECT_6('SN-NRWU ');
      436     1842    2       CALL FINDD_6('SN      ',LAST_SN_DBK); /* restore SN currency */
      437     1843    2   END; /* ADD_NR */
      438     1844    1   END ADD_SN;

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:15   
--  Include file information  --

   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DDL_INCL.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ADD_SN.

   Procedure ADD_SN requires 1140 words for executable code.
   Procedure ADD_SN requires 36 words of local(AUTO) storage.

    No errors detected in file ZIG$D_ADDSN.:ZIC0TSI    .

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:16   

 Object Unit name= ADD_SN                                     File name= ZIG$D_ADDSN.:ZIC0TOU
 UTS= SEP 05 '97 11:56:48.88 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  LAST_RC_DBK
    1   Data  even  none    34     42  ADD_SN
    2  LblCom even  none     1      1  NUMB_AREA_SN
    3  LblCom even  none     1      1  NUMB_KEY_SN
    4  LblCom even  none     1      1  AREA$
    5  LblCom even  none     1      1  KEY$
    6  LblCom even  none     1      1  LAST_RC$
    7  LblCom even  none     1      1  NUMB_RECORD_SN
    8  LblCom even  none     1      1  NUMB_FIELD_SN
    9  LblCom even  none     1      1  NUMB_SET_SN
   10  LblCom even  none     1      1  RECORD$
   11  LblCom even  none     1      1  FIELD$
   12  LblCom even  none     1      1  SET$
   13  LblCom even  none     1      1  DYNMEM_START$
   14  LblCom even  none     1      1  DBK_STAR_DBPARAM_RC
   15  LblCom even  none     1      1  DBK_SO_CALC
   16  LblCom even  none     1      1  LAST_DEF_SET_DBK
   17  LblCom even  none     1      1  LAST_DEF_REC_DBK
   18  LblCom even  none     8     10  FIELD1
   19  LblCom even  none   656   1220  UWA
   20  RoData even  UTS     16     20  ADD_SN
   21   Proc  even  none  1140   2164  ADD_SN
   22  RoData even  none    46     56  ADD_SN
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:17   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    21      0   yes            yes      Std        8  ADD_SN
    21   1670                  yes      Std        8  JUST_FIND_SN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 FETCHNS_6
 yes     yes           Std       1 STRE_6
 yes     yes           Std       1 MODIFY_6
 yes     yes           Std       1 FCURR_R_6
 yes     yes           Std       2 FINDD_6
 yes     yes           Std       2 FETCHD_6
 yes     yes           Std       1 FETCHPS_6
 yes     yes           Std       3 ZIG$ALLOCATE
         yes           Std       3 ZIG$MRL
         yes           Std       0 ABORT
 yes     yes           Std       1 FINDOS_6
 yes     yes           Std       1 CONNECT_6
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:18   


        1        1        /*M* ADD_SN         I-D-S/II    DBACS DDL TRANSLATOR */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8        NAME:  ADD_SN
        9        9        PURPOSE:  Called by ZIG$D_PSET to generate SN and NR records.
       10       10        */
       11       11        ADD_SN:
       12       12            PROC(TYPE,WORD1,DCLR,LN,FND,RLTYPE,IMPLCIT,RC_DBK);

     12 21 000000   000000 700200 xent  ADD_SN       TSX0  ! X66_AUTO_N
        21 000001   000044 000010                    ZERO    36,8
        21 000002   001014 710000 21                 TRA     s:1698

       13       13        /************************************
       14       14        * for filling in fields in SN record*
       15       15        ************************************/
       16       16    1   DCL WORD1 CHAR(30); /* uwa.sn.sename */
       17       17    1   DCL DCLR SBIN(36); /* uwa.sn.dclr */
       18       18    1   DCL LN UBIN(36); /* uwa.sn.lno */
       19       19    1   DCL TYPE UBIN(36); /* uwa.sn.setype */
       20       20        /*******************************
       21       21        * to signal that SN with       *
       22       22        * SENAME=WORD1 has been found  *
       23       23        *******************************/
       24       24    1   DCL FND UBIN WORD;
       25       25    1   DCL RC_DBK UBIN (36);
       26       26        /*D*     NAME:     RC_DBK
       27       27        DESCRIPTION:
       28       28              This is the DBK of the rc record that this field is owned
       29       29            by. If zero is given then find any field with the that name.
       30       30        */
       31       31        /************************************
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:19   
       32       32        * for filling in fields in NR record*
       33       33        ************************************/
       34       34    1   DCL RLTYPE SBIN WORD; /* uwa.nr.reltype */
       35       35    1   DCL IMPLCIT SBIN WORD; /* uwa.nr.implct */
       36       36        /***********************************
       37       37        * first SN of its type in DA-SN set*
       38       38        ***********************************/
       39       39    1   DCL LAST_RC_DBK UBIN (36) EXT;
       40       40    1   DCL LAST_SN_DBK UBIN WORD; /* for saving SN currency if need to add NR */
       41       41    1   DCL ABORT ENTRY;
       42       42        /* need to keep track of DBK of last defined record, set and key
       43       43           for purposes of adding NR records */
       44       44    1   DCL LAST_DEF_KEY_DBK UBIN WORD STATIC;
       45       45    1   DCL LN_DIFF UBIN WORD;
       46       46    1   DCL DBK UBIN (36) ALIGNED STATIC;
       47       47        /*
       48       48              Now come the data things needed to do memory searches for
       49       49            names in the SN records.
       50       50        */
       51       51    1   DCL NUMB_AREA_SN UBIN (36) EXT;
       52       52    1   DCL NUMB_KEY_SN UBIN (36) EXT;
       53       53    1   DCL AREA$ PTR EXT;
       54       54    1   DCL KEY$ PTR EXT;
       55       55    1   DCL STRING CHAR (LEN_STRING) BASED;
       56       56    1   DCL LEN_STRING UBIN (36) STATIC;
       57       57    1   DCL ZIG$ALLOCATE ENTRY (3) ALTRET;
       58       58    1   DCL PTR$ PTR STATIC;
       59       59    1   DCL LAST_RC$ PTR EXT;
       60       60        %EQU DS6 = 5 /* AREA, SET, KEY, RECORD info .*/;
       61       61        %EQU DS7 = 6 /* FIELD info .*/;
       62       62    1   DCL ZIG$MRL ENTRY (3);
       63       63    1   DCL PTR1$ PTR STATIC;
       64       64    1   DCL PTR2$ PTR STATIC;
       65       65    1   DCL MOVE_LEN UBIN (36) STATIC;
       66       66    1   DCL TABLE_POS SBIN (36) STATIC;
       67       67    1   DCL POS_WORD CHAR (30) STATIC;
       68       68    1   DCL ERROR ENTRY(1);
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:20   
       69       69        %INCLUDE ZIG_TYPE_SUBS;
       70       84        %INCLUDE ZIG_DDL_INCL;
       71      346         %DDL_XLATE;
       72      441        %INCLUDE ZI_SUB4_CAN;
       73     1098        %UWA;
       74     1433        %INCLUDE ZIG_DBA_INT;
       75     1481    1   SEARCH_BIN:

   1481 21 000003   200020 741300       SEARCH_BIN   STX1  ! LNO+1,,AUTO

       76     1482    1       PROC (LIST$,LEN,WORD1,TABLE_POS);
       77     1483    2   DCL LIST$ PTR;
       78     1484    2   DCL LEN UBIN (36);
       79     1485    2   DCL WORD1 CHAR (30);
       80     1486    2   DCL TABLE_POS SBIN (36);
       81     1487    2   DCL HIGH_POS SBIN (36) STATIC;
       82     1488    2   DCL LOW_POS SBIN (36) STATIC;
       83     1489    2   DCL POS SBIN (36) STATIC;
       84     1490    2       HIGH_POS = LEN - 1;

   1490 21 000004   200022 470500                    LDP0    @LEN,,AUTO
        21 000005   000000 235100                    LDA     0,,PR0
        21 000006   000001 135007                    SBLA    1,DL
        21 000007   000035 755000 1                  STA     HIGH_POS

       85     1491    2       LOW_POS = 0;

   1491 21 000010   000036 450000 1                  STZ     LOW_POS

       86     1492    2       IF HIGH_POS = -1

   1492 21 000011   000000 115000 22                 CMPA    0
        21 000012   000024 601000 21                 TNZ     s:1499

       87     1493    3       THEN DO;

       88     1494    3           CALL FCURR_R_6('DA   ');
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:21   

   1494 21 000013   000002 630400 22                 EPPR0   2
        21 000014   000001 631400 22                 EPPR1   1
        21 000015   000000 701000 xent               TSX1    FCURR_R_6
        21 000016   000000 011000                    NOP     0

       89     1495    3           TABLE_POS = -1;

   1495 21 000017   000001 335007                    LCA     1,DL
        21 000020   200024 470500                    LDP0    @TABLE_POS,,AUTO
        21 000021   000000 755100                    STA     0,,PR0

       90     1496    3           RETURN;

   1496 21 000022   200020 221300                    LDX1  ! LNO+1,,AUTO
        21 000023   000001 702211                    TSX2  ! 1,X1

       91     1497    3           END;
       92     1498    3       DO WHILE ('1'B);

       93     1499    3           POS = ( HIGH_POS + LOW_POS ) / 2;

   1499 21 000024   000035 236000 1                  LDQ     HIGH_POS
        21 000025   000036 036000 1                  ADLQ    LOW_POS
        21 000026   000002 506007                    DIV     2,DL
        21 000027   000037 756000 1                  STQ     POS

       94     1500    3           POS_WORD = LIST$ -> TABLES.NAME(POS);

   1500 21 000030   200021 470500                    LDP0    @LIST$,,AUTO
        21 000031   000000 471500                    LDP1    0,,PR0
        21 000032   000044 402007                    MPY     36,DL
        21 000033   040000 100506                    MLR     fill='040'O
        21 000034   100000 000036                    ADSC9   0,Q,PR1                  cn=0,n=30
        21 000035   000010 000036 1                  ADSC9   POS_WORD                 cn=0,n=30

       95     1501    3           IF POS_WORD > WORD1
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:22   

   1501 21 000036   200023 473500                    LDP3    @WORD1,,AUTO
        21 000037   040000 106500                    CMPC    fill='040'O
        21 000040   300000 000036                    ADSC9   0,,PR3                   cn=0,n=30
        21 000041   000010 000036 1                  ADSC9   POS_WORD                 cn=0,n=30
        21 000042   000046 603000 21                 TRC     s:1506

       96     1502    4           THEN DO;

       97     1503    4               HIGH_POS = POS;

   1503 21 000043   000037 235000 1                  LDA     POS
        21 000044   000035 755000 1                  STA     HIGH_POS

       98     1504    4               END;

   1504 21 000045   000142 710000 21                 TRA     s:1538

       99     1505    4           ELSE DO;

      100     1506    4               IF POS_WORD < WORD1

   1506 21 000046   000053 602000 21                 TNC     s:1511
        21 000047   000053 600000 21                 TZE     s:1511

      101     1507    5               THEN DO;

      102     1508    5                   LOW_POS = POS;

   1508 21 000050   000037 235000 1                  LDA     POS
        21 000051   000036 755000 1                  STA     LOW_POS

      103     1509    5                   END;

   1509 21 000052   000142 710000 21                 TRA     s:1538

      104     1510    5               ELSE DO;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:23   

      105     1511    5                   FND = %FOUNDREF;

   1511 21 000053   000001 235007                    LDA     1,DL
        21 000054   200007 474500                    LDP4    @FND,,AUTO
        21 000055   400000 755100                    STA     0,,PR4

      106     1512    5                   TABLE_POS = POS;

   1512 21 000056   200024 471500                    LDP1    @TABLE_POS,,AUTO
        21 000057   000037 236000 1                  LDQ     POS
        21 000060   100000 756100                    STQ     0,,PR1

      107     1513    5                   IF (LIST$ = FIELD$)

   1513 21 000061   000000 236100                    LDQ     0,,PR0
        21 000062   000000 116000 11                 CMPQ    FIELD$
        21 000063   000073 601000 21                 TNZ     s:1522

      108     1514    6                   THEN DO;

      109     1515    6                       CALL FIND_RIGHT_FIELD(POS);

   1515 21 000064   000003 236000 22                 LDQ     3
        21 000065   200027 756100                    STQ     @TABLE_POS+3,,AUTO
        21 000066   000517 701000 21                 TSX1    FIND_RIGHT_FIELD
        21 000067   000000 011000                    NOP     0

      110     1516    6                       TABLE_POS = POS;

   1516 21 000070   200024 470500                    LDP0    @TABLE_POS,,AUTO
        21 000071   000037 235000 1                  LDA     POS
        21 000072   000000 755100                    STA     0,,PR0

      111     1517    6                       END;

      112     1518         /* table_pos=-1 if this user-name belongs in front
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:24   
      113     1519            of all others of its type, so find the first one
      114     1520            of its type and back up one, otherwise just
      115     1521            fetch the sn just prior to where this goes */
      116     1522    5                   IF TABLE_POS = -1 THEN

   1522 21 000073   200024 470500                    LDP0    @TABLE_POS,,AUTO
        21 000074   000000 235100                    LDA     0,,PR0
        21 000075   000000 115000 22                 CMPA    0
        21 000076   000125 601000 21                 TNZ     s:1532

      117     1523    6                   DO;

      118     1524    6                       DBK = LIST$ -> TABLES.DBK(0);

   1524 21 000077   200021 471500                    LDP1    @LIST$,,AUTO
        21 000100   100000 473500                    LDP3    0,,PR1
        21 000101   300007 236100                    LDQ     7,,PR3
        21 000102   777777 376007                    ANQ     -1,DL
        21 000103   000001 756000 1                  STQ     DBK

      119     1525    6                       CALL FINDD_6('SN      ',DBK);

   1525 21 000104   000005 630400 22                 EPPR0   5
        21 000105   000004 631400 22                 EPPR1   4
        21 000106   000000 701000 xent               TSX1    FINDD_6
        21 000107   000000 011000                    NOP     0

      120     1526    6                       CALL FETCHPS_6('DA-SN   ');

   1526 21 000110   000007 630400 22                 EPPR0   7
        21 000111   000001 631400 22                 EPPR1   1
        21 000112   000000 701000 xent               TSX1    FETCHPS_6
        21 000113   000000 011000                    NOP     0

      121     1527    6                       IF UWA.DB_STATUS = '0502100' THEN

   1527 21 000114   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:25   
        21 000115   000001 000007 19                 ADSC9   UWA+1                    cn=0,n=7
        21 000116   000006 000007 20                 ADSC9   6                        cn=0,n=7
        21 000117   000140 601000 21                 TNZ     s:1535

      122     1528    6                           CALL FCURR_R_6('DA      '); /* DA */

   1528 21 000120   000002 630400 22                 EPPR0   2
        21 000121   000001 631400 22                 EPPR1   1
        21 000122   000000 701000 xent               TSX1    FCURR_R_6
        21 000123   000000 011000                    NOP     0

      123     1529    6                       END;

   1529 21 000124   000140 710000 21                 TRA     s:1535

      124     1530    5                   ELSE
      125     1531    6                   DO;

      126     1532    6                       DBK = LIST$ -> TABLES.DBK(TABLE_POS);

   1532 21 000125   200021 471500                    LDP1    @LIST$,,AUTO
        21 000126   100000 473500                    LDP3    0,,PR1
        21 000127   000000 236100                    LDQ     0,,PR0
        21 000130   000011 402007                    MPY     9,DL
        21 000131   300007 236106                    LDQ     7,QL,PR3
        21 000132   777777 376007                    ANQ     -1,DL
        21 000133   000001 756000 1                  STQ     DBK

      127     1533    6                       CALL FETCHD_6('SN  ',DBK);

   1533 21 000134   000005 630400 22                 EPPR0   5
        21 000135   000004 631400 22                 EPPR1   4
        21 000136   000000 701000 xent               TSX1    FETCHD_6
        21 000137   000000 011000                    NOP     0

      128     1534    6                       END;

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:26   
      129     1535    5                   RETURN;

   1535 21 000140   200020 221300                    LDX1  ! LNO+1,,AUTO
        21 000141   000001 702211                    TSX2  ! 1,X1

      130     1536    5                   END;
      131     1537    4               END;
      132     1538    3           IF HIGH_POS = LOW_POS OR (( HIGH_POS + LOW_POS) / 2 = LOW_POS)

   1538 21 000142   000035 236000 1                  LDQ     HIGH_POS
        21 000143   000036 116000 1                  CMPQ    LOW_POS
        21 000144   000151 600000 21                 TZE     s:1540
        21 000145   000036 036000 1                  ADLQ    LOW_POS
        21 000146   000002 506007                    DIV     2,DL
        21 000147   000036 116000 1                  CMPQ    LOW_POS
        21 000150   000024 601000 21                 TNZ     s:1499

      133     1539    4           THEN DO;

      134     1540    4               IF WORD1 = LIST$ -> TABLES.NAME(HIGH_POS)

   1540 21 000151   000035 236000 1                  LDQ     HIGH_POS
        21 000152   000044 402007                    MPY     36,DL
        21 000153   040106 106500                    CMPC    fill='040'O
        21 000154   300000 000036                    ADSC9   0,,PR3                   cn=0,n=30
        21 000155   100000 000036                    ADSC9   0,Q,PR1                  cn=0,n=30
        21 000156   000165 600000 21                 TZE     s:1543
        21 000157   000036 236000 1                  LDQ     LOW_POS
        21 000160   000044 402007                    MPY     36,DL
        21 000161   040106 106500                    CMPC    fill='040'O
        21 000162   300000 000036                    ADSC9   0,,PR3                   cn=0,n=30
        21 000163   100000 000036                    ADSC9   0,Q,PR1                  cn=0,n=30
        21 000164   000267 601000 21                 TNZ     s:1573

      135     1541    4                  OR WORD1 = LIST$ -> TABLES.NAME(LOW_POS)
      136     1542    5               THEN DO;

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:27   
      137     1543    5                   IF WORD1 = LIST$ -> TABLES.NAME(LOW_POS)

   1543 21 000165   000036 236000 1                  LDQ     LOW_POS
        21 000166   000044 402007                    MPY     36,DL
        21 000167   040106 106500                    CMPC    fill='040'O
        21 000170   300000 000036                    ADSC9   0,,PR3                   cn=0,n=30
        21 000171   100000 000036                    ADSC9   0,Q,PR1                  cn=0,n=30
        21 000172   000176 601000 21                 TNZ     s:1545

      138     1544    5                   THEN POS = LOW_POS;

   1544 21 000173   000036 235000 1                  LDA     LOW_POS
        21 000174   000037 755000 1                  STA     POS
        21 000175   000200 710000 21                 TRA     s:1546

      139     1545    5                   ELSE POS = HIGH_POS;

   1545 21 000176   000035 235000 1                  LDA     HIGH_POS
        21 000177   000037 755000 1                  STA     POS

      140     1546    5                   FND = %FOUNDREF;

   1546 21 000200   000001 235007                    LDA     1,DL
        21 000201   200007 471500                    LDP1    @FND,,AUTO
        21 000202   100000 755100                    STA     0,,PR1

      141     1547    5                   TABLE_POS = POS;

   1547 21 000203   200024 474500                    LDP4    @TABLE_POS,,AUTO
        21 000204   000037 235000 1                  LDA     POS
        21 000205   400000 755100                    STA     0,,PR4

      142     1548    5                   IF (LIST$ = FIELD$)

   1548 21 000206   000000 236100                    LDQ     0,,PR0
        21 000207   000000 116000 11                 CMPQ    FIELD$
        21 000210   000220 601000 21                 TNZ     s:1557
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:28   

      143     1549    6                   THEN DO;

      144     1550    6                       CALL FIND_RIGHT_FIELD(POS);

   1550 21 000211   000003 236000 22                 LDQ     3
        21 000212   200027 756100                    STQ     @TABLE_POS+3,,AUTO
        21 000213   000517 701000 21                 TSX1    FIND_RIGHT_FIELD
        21 000214   000000 011000                    NOP     0

      145     1551    6                       TABLE_POS = POS;

   1551 21 000215   200024 470500                    LDP0    @TABLE_POS,,AUTO
        21 000216   000037 235000 1                  LDA     POS
        21 000217   000000 755100                    STA     0,,PR0

      146     1552    6                       END;

      147     1553         /* table_pos=-1 if this user-name belongs in front
      148     1554            of all others of its type, so find the first one
      149     1555            of its type and back up one, otherwise just
      150     1556            fetch the sn just prior to where this goes */
      151     1557    5                   IF TABLE_POS = -1 THEN

   1557 21 000220   200024 470500                    LDP0    @TABLE_POS,,AUTO
        21 000221   000000 235100                    LDA     0,,PR0
        21 000222   000000 115000 22                 CMPA    0
        21 000223   000252 601000 21                 TNZ     s:1567

      152     1558    6                   DO;

      153     1559    6                       DBK = LIST$ -> TABLES.DBK(0);

   1559 21 000224   200021 471500                    LDP1    @LIST$,,AUTO
        21 000225   100000 473500                    LDP3    0,,PR1
        21 000226   300007 236100                    LDQ     7,,PR3
        21 000227   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:29   
        21 000230   000001 756000 1                  STQ     DBK

      154     1560    6                       CALL FINDD_6('SN      ',DBK);

   1560 21 000231   000005 630400 22                 EPPR0   5
        21 000232   000004 631400 22                 EPPR1   4
        21 000233   000000 701000 xent               TSX1    FINDD_6
        21 000234   000000 011000                    NOP     0

      155     1561    6                       CALL FETCHPS_6('DA-SN   ');

   1561 21 000235   000007 630400 22                 EPPR0   7
        21 000236   000001 631400 22                 EPPR1   1
        21 000237   000000 701000 xent               TSX1    FETCHPS_6
        21 000240   000000 011000                    NOP     0

      156     1562    6                       IF UWA.DB_STATUS = '0502100' THEN

   1562 21 000241   040000 106400                    CMPC    fill='040'O
        21 000242   000001 000007 19                 ADSC9   UWA+1                    cn=0,n=7
        21 000243   000006 000007 20                 ADSC9   6                        cn=0,n=7
        21 000244   000265 601000 21                 TNZ     s:1570

      157     1563    6                           CALL FCURR_R_6('DA      '); /* DA */

   1563 21 000245   000002 630400 22                 EPPR0   2
        21 000246   000001 631400 22                 EPPR1   1
        21 000247   000000 701000 xent               TSX1    FCURR_R_6
        21 000250   000000 011000                    NOP     0

      158     1564    6                       END;

   1564 21 000251   000265 710000 21                 TRA     s:1570

      159     1565    5                   ELSE
      160     1566    6                   DO;

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:30   
      161     1567    6                       DBK = LIST$ -> TABLES.DBK(TABLE_POS);

   1567 21 000252   200021 471500                    LDP1    @LIST$,,AUTO
        21 000253   100000 473500                    LDP3    0,,PR1
        21 000254   000000 236100                    LDQ     0,,PR0
        21 000255   000011 402007                    MPY     9,DL
        21 000256   300007 236106                    LDQ     7,QL,PR3
        21 000257   777777 376007                    ANQ     -1,DL
        21 000260   000001 756000 1                  STQ     DBK

      162     1568    6                       CALL FETCHD_6('SN  ',DBK);

   1568 21 000261   000005 630400 22                 EPPR0   5
        21 000262   000004 631400 22                 EPPR1   4
        21 000263   000000 701000 xent               TSX1    FETCHD_6
        21 000264   000000 011000                    NOP     0

      163     1569    6                       END;

      164     1570    5                   RETURN;

   1570 21 000265   200020 221300                    LDX1  ! LNO+1,,AUTO
        21 000266   000001 702211                    TSX2  ! 1,X1

      165     1571    5                   END;
      166     1572    5               ELSE DO;

      167     1573    5                   IF WORD1 < LIST$ -> TABLES.NAME(HIGH_POS)

   1573 21 000267   000035 236000 1                  LDQ     HIGH_POS
        21 000270   000044 402007                    MPY     36,DL
        21 000271   040106 106500                    CMPC    fill='040'O
        21 000272   300000 000036                    ADSC9   0,,PR3                   cn=0,n=30
        21 000273   100000 000036                    ADSC9   0,Q,PR1                  cn=0,n=30
        21 000274   000314 603000 21                 TRC     s:1584

      168     1574    6                   THEN DO;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:31   

      169     1575    6                       IF WORD1 < LIST$ -> TABLES.NAME(LOW_POS)

   1575 21 000275   000036 236000 1                  LDQ     LOW_POS
        21 000276   000044 402007                    MPY     36,DL
        21 000277   040106 106500                    CMPC    fill='040'O
        21 000300   300000 000036                    ADSC9   0,,PR3                   cn=0,n=30
        21 000301   100000 000036                    ADSC9   0,Q,PR1                  cn=0,n=30
        21 000302   000310 603000 21                 TRC     s:1580

      170     1576    7                       THEN DO;

      171     1577    7                           TABLE_POS = LOW_POS - 1;

   1577 21 000303   200024 474500                    LDP4    @TABLE_POS,,AUTO
        21 000304   000036 235000 1                  LDA     LOW_POS
        21 000305   000001 135007                    SBLA    1,DL
        21 000306   400000 755100                    STA     0,,PR4

      172     1578    7                           END;

   1578 21 000307   000317 710000 21                 TRA     s:1592

      173     1579    7                       ELSE DO;

      174     1580    7                           TABLE_POS = LOW_POS;

   1580 21 000310   200024 474500                    LDP4    @TABLE_POS,,AUTO
        21 000311   000036 235000 1                  LDA     LOW_POS
        21 000312   400000 755100                    STA     0,,PR4

      175     1581    7                           END;

      176     1582    6                       END;

   1582 21 000313   000317 710000 21                 TRA     s:1592

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:32   
      177     1583    6                   ELSE DO;

      178     1584    6                       TABLE_POS = HIGH_POS;

   1584 21 000314   200024 474500                    LDP4    @TABLE_POS,,AUTO
        21 000315   000035 235000 1                  LDA     HIGH_POS
        21 000316   400000 755100                    STA     0,,PR4

      179     1585    6                       END;

      180     1586    5                   END;

      181     1587         /* table_pos=-1 if this user-name belongs in
      182     1588            front of all others of its type, so find the
      183     1589            first one of its type and back up one , otherwise
      184     1590            just fetch the sn just prior to where this
      185     1591            one belongs */
      186     1592    4               IF TABLE_POS = -1 THEN

   1592 21 000317   000000 115000 22                 CMPA    0
        21 000320   000346 601000 21                 TNZ     s:1602

      187     1593    5               DO;

      188     1594    5                   DBK = LIST$ -> TABLES.DBK(0);

   1594 21 000321   000000 471500                    LDP1    0,,PR0
        21 000322   100007 236100                    LDQ     7,,PR1
        21 000323   777777 376007                    ANQ     -1,DL
        21 000324   000001 756000 1                  STQ     DBK

      189     1595    5                   CALL FINDD_6('SN      ',DBK);

   1595 21 000325   000005 630400 22                 EPPR0   5
        21 000326   000004 631400 22                 EPPR1   4
        21 000327   000000 701000 xent               TSX1    FINDD_6
        21 000330   000000 011000                    NOP     0
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:33   

      190     1596    5                   CALL FETCHPS_6('DA-SN   ');

   1596 21 000331   000007 630400 22                 EPPR0   7
        21 000332   000001 631400 22                 EPPR1   1
        21 000333   000000 701000 xent               TSX1    FETCHPS_6
        21 000334   000000 011000                    NOP     0

      191     1597    5                   IF UWA.DB_STATUS = '0502100' THEN /* DA */

   1597 21 000335   040000 106400                    CMPC    fill='040'O
        21 000336   000001 000007 19                 ADSC9   UWA+1                    cn=0,n=7
        21 000337   000006 000007 20                 ADSC9   6                        cn=0,n=7
        21 000340   000360 601000 21                 TNZ     s:1605

      192     1598    5                       CALL FCURR_R_6('DA      ');

   1598 21 000341   000002 630400 22                 EPPR0   2
        21 000342   000001 631400 22                 EPPR1   1
        21 000343   000000 701000 xent               TSX1    FCURR_R_6
        21 000344   000000 011000                    NOP     0

      193     1599    5                   END;

   1599 21 000345   000360 710000 21                 TRA     s:1605

      194     1600    4               ELSE
      195     1601    5               DO;

      196     1602    5                   DBK = LIST$ -> TABLES.DBK(TABLE_POS);

   1602 21 000346   000000 471500                    LDP1    0,,PR0
        21 000347   400000 236100                    LDQ     0,,PR4
        21 000350   000011 402007                    MPY     9,DL
        21 000351   100007 236106                    LDQ     7,QL,PR1
        21 000352   777777 376007                    ANQ     -1,DL
        21 000353   000001 756000 1                  STQ     DBK
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:34   

      197     1603    5                   CALL FETCHD_6('SN  ',DBK);

   1603 21 000354   000005 630400 22                 EPPR0   5
        21 000355   000004 631400 22                 EPPR1   4
        21 000356   000000 701000 xent               TSX1    FETCHD_6
        21 000357   000000 011000                    NOP     0

      198     1604    5                   END;

      199     1605    4               RETURN;

   1605 21 000360   200020 221300                    LDX1  ! LNO+1,,AUTO
        21 000361   000001 702211                    TSX2  ! 1,X1

      200     1606    4               END;
      201     1607    3           END;

      202     1608    2   END SEARCH_BIN;
      203     1609        %EJECT;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:35   
      204     1610    1   ADD_TABLE:

   1610 21 000362   200020 741300       ADD_TABLE    STX1  ! LNO+1,,AUTO

      205     1611    1       PROC(POS,PTR$,NUMB_IN_TABLE);
      206     1612    2   DCL POS SBIN (36);
      207     1613    2   DCL PTR$ PTR;
      208     1614    2   DCL NUMB_IN_TABLE UBIN (36);
      209     1615    2       IF TYPE = %ZIG_RTYPE_FR

   1615 21 000363   200003 470500                    LDP0    @TYPE,,AUTO
        21 000364   000000 235100                    LDA     0,,PR0
        21 000365   000062 115007                    CMPA    50,DL
        21 000366   000374 601000 21                 TNZ     s:1620

      210     1616    3       THEN DO;

      211     1617    3           CALL ZIG$ALLOCATE(%DS7,9,PTR1$) ALTRET(NO_NO);

   1617 21 000367   000013 630400 22                 EPPR0   11
        21 000370   000010 631400 22                 EPPR1   8
        21 000371   000000 701000 xent               TSX1    ZIG$ALLOCATE
        21 000372   000512 702000 21                 TSX2    NO_NO

      212     1618    3           END;

   1618 21 000373   000400 710000 21                 TRA     s:1622

      213     1619    3       ELSE DO;

      214     1620    3           CALL ZIG$ALLOCATE(%DS6,9,PTR1$) ALTRET(NO_NO);

   1620 21 000374   000017 630400 22                 EPPR0   15
        21 000375   000010 631400 22                 EPPR1   8
        21 000376   000000 701000 xent               TSX1    ZIG$ALLOCATE
        21 000377   000512 702000 21                 TSX2    NO_NO

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:36   
      215     1621    3           END;

      216     1622    2       IF NUMB_IN_TABLE > 0

   1622 21 000400   200023 470500                    LDP0    @NUMB_IN_TABLE,,AUTO
        21 000401   000000 235100                    LDA     0,,PR0
        21 000402   000431 600000 21                 TZE     s:1629

      217     1623    3       THEN DO;

      218     1624    3           PTR1$ = ADDR(PTR$ -> TABLES.NAME(POS));

   1624 21 000403   200022 471500                    LDP1    @PTR$,,AUTO
        21 000404   100000 473500                    LDP3    0,,PR1
        21 000405   200021 474500                    LDP4    @POS,,AUTO
        21 000406   400000 236100                    LDQ     0,,PR4
        21 000407   000011 402007                    MPY     9,DL
        21 000410   300000 635506                    EPPR5   0,QL,PR3
        21 000411   000004 455400 1                  STP5    PTR1$

      219     1625    3           PTR2$ = PINCRW(PTR1$,9);

   1625 21 000412   000004 236000 1                  LDQ     PTR1$
        21 000413   000011 036003                    ADLQ    9,DU
        21 000414   000005 756000 1                  STQ     PTR2$

      220     1626    3           MOVE_LEN = ((NUMB_IN_TABLE - POS) * 9 * 4);

   1626 21 000415   000000 236100                    LDQ     0,,PR0
        21 000416   400000 136100                    SBLQ    0,,PR4
        21 000417   000044 402007                    MPY     36,DL
        21 000420   000006 756000 1                  STQ     MOVE_LEN

      221     1627    3           CALL ZIG$MRL(PTR1$ -> TABLES,PTR2$ -> TABLES,MOVE_LEN);

   1627 21 000421   000022 236000 22                 LDQ     18
        21 000422   200032 756100                    STQ     @POS+3,,AUTO
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:37   
        21 000423   000004 237000 1                  LDAQ    PTR1$
        21 000424   200030 757100                    STAQ    @POS+1,,AUTO
        21 000425   200030 630500                    EPPR0   @POS+1,,AUTO
        21 000426   000010 631400 22                 EPPR1   8
        21 000427   000000 701000 xent               TSX1    ZIG$MRL
        21 000430   000000 011000                    NOP     0

      222     1628    3           END;

      223     1629    2       PTR$ -> TABLES.NAME(POS) = WORD1;

   1629 21 000431   200022 470500                    LDP0    @PTR$,,AUTO
        21 000432   000000 471500                    LDP1    0,,PR0
        21 000433   200021 473500                    LDP3    @POS,,AUTO
        21 000434   300000 236100                    LDQ     0,,PR3
        21 000435   000011 402007                    MPY     9,DL
        21 000436   000002 736000                    QLS     2
        21 000437   200004 474500                    LDP4    @WORD1,,AUTO
        21 000440   040106 100500                    MLR     fill='040'O
        21 000441   400000 000036                    ADSC9   0,,PR4                   cn=0,n=30
        21 000442   100000 000036                    ADSC9   0,Q,PR1                  cn=0,n=30

      224     1630    2       PTR$ -> TABLES.DBK_RC(POS) = RC_DBK;

   1630 21 000443   000000 471500                    LDP1    0,,PR0
        21 000444   300000 236100                    LDQ     0,,PR3
        21 000445   000011 402007                    MPY     9,DL
        21 000446   200012 475500                    LDP5    @RC_DBK,,AUTO
        21 000447   500000 720100                    LXL0    0,,PR5
        21 000450   100010 440106                    SXL0    8,QL,PR1

      225     1631    2       IF DCLR = 1

   1631 21 000451   200005 471500                    LDP1    @DCLR,,AUTO
        21 000452   100000 235100                    LDA     0,,PR1
        21 000453   000001 115007                    CMPA    1,DL
        21 000454   000464 601000 21                 TNZ     s:1633
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:38   

      226     1632    2       THEN PTR$ -> TABLES.DEFINED(POS) = '1'B;

   1632 21 000455   000000 476500                    LDP6    0,,PR0
        21 000456   300000 236100                    LDQ     0,,PR3
        21 000457   000011 402007                    MPY     9,DL
        21 000460   000000 620006                    EAX0    0,QL
        21 000461   400000 236003                    LDQ     -131072,DU
        21 000462   600010 256110                    ORSQ    8,X0,PR6
        21 000463   000472 710000 21                 TRA     s:1634

      227     1633    2       ELSE PTR$ -> TABLES.DEFINED(POS) = '0'B;

   1633 21 000464   000000 476500                    LDP6    0,,PR0
        21 000465   300000 236100                    LDQ     0,,PR3
        21 000466   000011 402007                    MPY     9,DL
        21 000467   000000 620006                    EAX0    0,QL
        21 000470   000023 236000 22                 LDQ     19
        21 000471   600010 356110                    ANSQ    8,X0,PR6

      228     1634    2       PTR$ -> TABLES.DBK(POS) = UWA.DIRECT_REF;

   1634 21 000472   000000 476500                    LDP6    0,,PR0
        21 000473   300000 236100                    LDQ     0,,PR3
        21 000474   000011 402007                    MPY     9,DL
        21 000475   000036 720000 19                 LXL0    UWA+30
        21 000476   600007 440106                    SXL0    7,QL,PR6

      229     1635    2       IF TYPE = %ZIG_RTYPE_RC THEN LAST_RC$ = PINCRW(PTR$,POS*9);

   1635 21 000477   200003 476500                    LDP6    @TYPE,,AUTO
        21 000500   600000 235100                    LDA     0,,PR6
        21 000501   000050 115007                    CMPA    40,DL
        21 000502   000510 601000 21                 TNZ     s:1636

   1635 21 000503   300000 236100                    LDQ     0,,PR3
        21 000504   000000 477500                    LDP7    0,,PR0
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:39   
        21 000505   000011 402007                    MPY     9,DL
        21 000506   700000 630506                    EPPR0   0,QL,PR7
        21 000507   000000 450400 6                  STP0    LAST_RC$

      230     1636    2       RETURN;

   1636 21 000510   200020 221300                    LDX1  ! LNO+1,,AUTO
        21 000511   000001 702211                    TSX2  ! 1,X1

      231     1637    2   NO_NO:
      232     1638    2       CALL ABORT;

   1638 21 000512   000024 631400 22    NO_NO        EPPR1   20
        21 000513   000000 701000 xent               TSX1    ABORT
        21 000514   000000 011000                    NOP     0

      233     1639    2       RETURN;

   1639 21 000515   200020 221300                    LDX1  ! LNO+1,,AUTO
        21 000516   000001 702211                    TSX2  ! 1,X1

      234     1640    2   END ADD_TABLE;
      235     1641        %EJECT;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:40   
      236     1642    1   FIND_RIGHT_FIELD:

   1642 21 000517   200026 741300       FIND_RIGHT_* STX1  ! @TABLE_POS+2,,AUTO

      237     1643    1       PROC(POS);
      238     1644    2   DCL POS SBIN (36);
      239     1645    2   DCL COUNT UBIN (36) STATIC;
      240     1646    2   DCL EXIT_DO BIT(1) STATIC;
      241     1647    2       COUNT = 0;

   1647 21 000520   000040 450000 1                  STZ     COUNT

      242     1648    2       EXIT_DO = '0'B;

   1648 21 000521   000041 450000 1                  STZ     EXIT_DO

      243     1649    2       IF RC_DBK = 0 THEN /* looking for field in any record */

   1649 21 000522   200012 470500                    LDP0    @RC_DBK,,AUTO
        21 000523   000000 235100                    LDA     0,,PR0
        21 000524   000625 601000 21                 TNZ     s:1667

      244     1650    3       DO;

      245     1651    4           DO WHILE (POS>=0 AND FIELD$->TABLES.NAME(POS)=WORD1);

   1651 21 000525   000531 710000 21                 TRA     s:1653

      246     1652    4               POS = POS - 1; /* back up while still same fieldname */

   1652 21 000526   200027 470500                    LDP0    @POS,,AUTO
        21 000527   000001 336007                    LCQ     1,DL
        21 000530   000000 056100                    ASQ     0,,PR0

      247     1653    4               END;

   1653 21 000531   200027 470500                    LDP0    @POS,,AUTO
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:41   
        21 000532   000000 235100                    LDA     0,,PR0
        21 000533   000545 604000 21                 TMI     s:1654
        21 000534   000000 236100                    LDQ     0,,PR0
        21 000535   000011 402007                    MPY     9,DL
        21 000536   000002 736000                    QLS     2
        21 000537   000000 471400 11                 LDP1    FIELD$
        21 000540   200004 473500                    LDP3    @WORD1,,AUTO
        21 000541   040100 106506                    CMPC    fill='040'O
        21 000542   100000 000036                    ADSC9   0,Q,PR1                  cn=0,n=30
        21 000543   300000 000036                    ADSC9   0,,PR3                   cn=0,n=30
        21 000544   000526 600000 21                 TZE     s:1652

      248     1654    3           POS = POS + 1; /*position to last entry with this name */

   1654 21 000545   000000 054100                    AOS     0,,PR0

      249     1655    4           DO WHILE (FIELD$->TABLES.NAME(POS)=WORD1 AND POS<=NUMB_FIELD_SN);

   1655 21 000546   000561 710000 21                 TRA     s:1658

      250     1656    4               IF FIELD$->TABLES.DBK_RC(POS)~=0 THEN COUNT = COUNT + 1;

   1656 21 000547   200027 470500                    LDP0    @POS,,AUTO
        21 000550   000000 236100                    LDQ     0,,PR0
        21 000551   000011 402007                    MPY     9,DL
        21 000552   000000 471400 11                 LDP1    FIELD$
        21 000553   100010 720106                    LXL0    8,QL,PR1
        21 000554   000560 600000 21                 TZE     s:1657

   1656 21 000555   000040 235000 1                  LDA     COUNT
        21 000556   000001 035007                    ADLA    1,DL
        21 000557   000040 755000 1                  STA     COUNT

      251     1657    4               POS = POS + 1; /* count # defined fields with this name */

   1657 21 000560   000000 054100                    AOS     0,,PR0

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:42   
      252     1658    4               END;

   1658 21 000561   000000 236100                    LDQ     0,,PR0
        21 000562   000011 402007                    MPY     9,DL
        21 000563   000002 736000                    QLS     2
        21 000564   000000 471400 11                 LDP1    FIELD$
        21 000565   200004 473500                    LDP3    @WORD1,,AUTO
        21 000566   040100 106506                    CMPC    fill='040'O
        21 000567   100000 000036                    ADSC9   0,Q,PR1                  cn=0,n=30
        21 000570   300000 000036                    ADSC9   0,,PR3                   cn=0,n=30
        21 000571   000576 601000 21                 TNZ     s:1659
        21 000572   000000 236000 8                  LDQ     NUMB_FIELD_SN
        21 000573   000547 604000 21                 TMI     s:1656
        21 000574   000000 116100                    CMPQ    0,,PR0
        21 000575   000547 605000 21                 TPL     s:1656

      253     1659    3           POS = POS - 1; /*position to last entry with this name */

   1659 21 000576   000001 336007                    LCQ     1,DL
        21 000577   000000 056100                    ASQ     0,,PR0

      254     1660    3           IF COUNT >= 2

   1660 21 000600   000040 235000 1                  LDA     COUNT
        21 000601   000002 115007                    CMPA    2,DL
        21 000602   000607 602000 21                 TNC     s:1662

      255     1661    3           THEN FND = %FOUNDDUP; /* needs qualifier */

   1661 21 000603   000003 235007                    LDA     3,DL
        21 000604   200007 471500                    LDP1    @FND,,AUTO
        21 000605   100000 755100                    STA     0,,PR1
        21 000606   000623 710000 21                 TRA     s:1665

      256     1662    3           ELSE IF FIELD$->TABLES.DBK_RC(POS)~=0

   1662 21 000607   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:43   
        21 000610   000011 402007                    MPY     9,DL
        21 000611   000000 471400 11                 LDP1    FIELD$
        21 000612   100010 720106                    LXL0    8,QL,PR1
        21 000613   000620 600000 21                 TZE     s:1664

      257     1663    3               THEN FND = %FOUNDDEF;

   1663 21 000614   000002 235007                    LDA     2,DL
        21 000615   200007 474500                    LDP4    @FND,,AUTO
        21 000616   400000 755100                    STA     0,,PR4
        21 000617   000623 710000 21                 TRA     s:1665

      258     1664    3               ELSE FND = %FOUNDREF;

   1664 21 000620   000001 235007                    LDA     1,DL
        21 000621   200007 474500                    LDP4    @FND,,AUTO
        21 000622   400000 755100                    STA     0,,PR4

      259     1665    3           RETURN;

   1665 21 000623   200026 221300                    LDX1  ! @TABLE_POS+2,,AUTO
        21 000624   000001 702211                    TSX2  ! 1,X1

      260     1666    3           END;
      261     1667    2       IF FIELD$ -> TABLES.DBK_RC(POS) = RC_DBK THEN RETURN;

   1667 21 000625   200027 471500                    LDP1    @POS,,AUTO
        21 000626   100000 236100                    LDQ     0,,PR1
        21 000627   000011 402007                    MPY     9,DL
        21 000630   000000 473400 11                 LDP3    FIELD$
        21 000631   300010 236106                    LDQ     8,QL,PR3
        21 000632   777777 376007                    ANQ     -1,DL
        21 000633   000000 116100                    CMPQ    0,,PR0
        21 000634   000636 601000 21                 TNZ     s:1668

   1667 21 000635   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:44   
      262     1668    3       DO WHILE (FIELD$ -> TABLES.DBK_RC(POS) ~= RC_DBK AND

   1668 21 000636   000645 710000 21                 TRA     s:1672

      263     1669    3          FIELD$ -> TABLES.NAME(POS) = WORD1 AND POS > 0);
      264     1670    3           POS = POS - 1;

   1670 21 000637   200027 470500                    LDP0    @POS,,AUTO
        21 000640   000001 336007                    LCQ     1,DL
        21 000641   000000 056100                    ASQ     0,,PR0

      265     1671    3           COUNT = COUNT + 1;

   1671 21 000642   000040 235000 1                  LDA     COUNT
        21 000643   000001 035007                    ADLA    1,DL
        21 000644   000040 755000 1                  STA     COUNT

      266     1672    3           END;

   1672 21 000645   200027 470500                    LDP0    @POS,,AUTO
        21 000646   000000 236100                    LDQ     0,,PR0
        21 000647   000011 402007                    MPY     9,DL
        21 000650   200012 471500                    LDP1    @RC_DBK,,AUTO
        21 000651   000000 473400 11                 LDP3    FIELD$
        21 000652   300010 236106                    LDQ     8,QL,PR3
        21 000653   777777 376007                    ANQ     -1,DL
        21 000654   100000 116100                    CMPQ    0,,PR1
        21 000655   000670 600000 21                 TZE     s:1673
        21 000656   000000 236100                    LDQ     0,,PR0
        21 000657   000011 402007                    MPY     9,DL
        21 000660   000002 736000                    QLS     2
        21 000661   200004 474500                    LDP4    @WORD1,,AUTO
        21 000662   040100 106506                    CMPC    fill='040'O
        21 000663   300000 000036                    ADSC9   0,Q,PR3                  cn=0,n=30
        21 000664   400000 000036                    ADSC9   0,,PR4                   cn=0,n=30
        21 000665   000670 601000 21                 TNZ     s:1673
        21 000666   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:45   
        21 000667   000637 605400 21                 TPNZ    s:1670

      267     1673    2       IF FIELD$->TABLES.NAME(POS) ~= WORD1 THEN POS = POS + 1;

   1673 21 000670   000000 236100                    LDQ     0,,PR0
        21 000671   000011 402007                    MPY     9,DL
        21 000672   000002 736000                    QLS     2
        21 000673   200004 474500                    LDP4    @WORD1,,AUTO
        21 000674   040100 106506                    CMPC    fill='040'O
        21 000675   300000 000036                    ADSC9   0,Q,PR3                  cn=0,n=30
        21 000676   400000 000036                    ADSC9   0,,PR4                   cn=0,n=30
        21 000677   000701 600000 21                 TZE     s:1674

   1673 21 000700   000000 054100                    AOS     0,,PR0

      268     1674    3       DO WHILE (FIELD$ -> TABLES.DBK_RC(POS) ~= RC_DBK

   1674 21 000701   000717 710000 21                 TRA     s:1683

      269     1675    3          AND FIELD$ -> TABLES.NAME(POS) = WORD1 AND ~EXIT_DO);
      270     1676    3           POS = POS + 1;

   1676 21 000702   200027 470500                    LDP0    @POS,,AUTO
        21 000703   000000 054100                    AOS     0,,PR0

      271     1677    3           IF POS = NUMB_FIELD_SN THEN

   1677 21 000704   000000 236100                    LDQ     0,,PR0
        21 000705   000714 604000 21                 TMI     s:1682
        21 000706   000000 116000 8                  CMPQ    NUMB_FIELD_SN
        21 000707   000714 601000 21                 TNZ     s:1682

      272     1678    4           DO;

      273     1679    4               POS = POS - 1;

   1679 21 000710   000001 336007                    LCQ     1,DL
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:46   
        21 000711   000000 056100                    ASQ     0,,PR0

      274     1680    4               EXIT_DO = '1'B;

   1680 21 000712   400000 236003                    LDQ     -131072,DU
        21 000713   000041 756000 1                  STQ     EXIT_DO

      275     1681    4               END;

      276     1682    3           COUNT = COUNT + 1;

   1682 21 000714   000040 235000 1                  LDA     COUNT
        21 000715   000001 035007                    ADLA    1,DL
        21 000716   000040 755000 1                  STA     COUNT

      277     1683    3           END;

   1683 21 000717   000000 236100                    LDQ     0,,PR0
        21 000720   000011 402007                    MPY     9,DL
        21 000721   200012 471500                    LDP1    @RC_DBK,,AUTO
        21 000722   000000 473400 11                 LDP3    FIELD$
        21 000723   300010 236106                    LDQ     8,QL,PR3
        21 000724   777777 376007                    ANQ     -1,DL
        21 000725   100000 116100                    CMPQ    0,,PR1
        21 000726   000743 600000 21                 TZE     s:1684
        21 000727   000000 236100                    LDQ     0,,PR0
        21 000730   000011 402007                    MPY     9,DL
        21 000731   000002 736000                    QLS     2
        21 000732   200004 474500                    LDP4    @WORD1,,AUTO
        21 000733   040100 106506                    CMPC    fill='040'O
        21 000734   300000 000036                    ADSC9   0,Q,PR3                  cn=0,n=30
        21 000735   400000 000036                    ADSC9   0,,PR4                   cn=0,n=30
        21 000736   000743 601000 21                 TNZ     s:1684
        21 000737   000041 236000 1                  LDQ     EXIT_DO
        21 000740   400000 376003                    ANQ     -131072,DU
        21 000741   400000 676003                    ERQ     -131072,DU
        21 000742   000702 601000 21                 TNZ     s:1676
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:47   

      278     1684    2       IF FIELD$ -> TABLES.DBK_RC(POS) = RC_DBK AND

   1684 21 000743   000000 236100                    LDQ     0,,PR0
        21 000744   000011 402007                    MPY     9,DL
        21 000745   300010 236106                    LDQ     8,QL,PR3
        21 000746   777777 376007                    ANQ     -1,DL
        21 000747   100000 116100                    CMPQ    0,,PR1
        21 000750   000776 601000 21                 TNZ     s:1692
        21 000751   000000 236100                    LDQ     0,,PR0
        21 000752   000011 402007                    MPY     9,DL
        21 000753   000002 736000                    QLS     2
        21 000754   200004 474500                    LDP4    @WORD1,,AUTO
        21 000755   040100 106506                    CMPC    fill='040'O
        21 000756   300000 000036                    ADSC9   0,Q,PR3                  cn=0,n=30
        21 000757   400000 000036                    ADSC9   0,,PR4                   cn=0,n=30
        21 000760   000776 601000 21                 TNZ     s:1692

      279     1685    2          FIELD$ -> TABLES.NAME(POS) = WORD1
      280     1686    3       THEN DO;

      281     1687    3           IF FIELD$->TABLES.DEFINED(POS) = '1'B

   1687 21 000761   000000 236100                    LDQ     0,,PR0
        21 000762   000011 402007                    MPY     9,DL
        21 000763   300010 234106                    SZN     8,QL,PR3
        21 000764   000771 605000 21                 TPL     s:1689

      282     1688    3           THEN FND = %FOUNDDEF;

   1688 21 000765   000002 235007                    LDA     2,DL
        21 000766   200007 475500                    LDP5    @FND,,AUTO
        21 000767   500000 755100                    STA     0,,PR5
        21 000770   000774 710000 21                 TRA     s:1690

      283     1689    3           ELSE FND = %FOUNDREF;

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:48   
   1689 21 000771   000001 235007                    LDA     1,DL
        21 000772   200007 475500                    LDP5    @FND,,AUTO
        21 000773   500000 755100                    STA     0,,PR5

      284     1690    3           RETURN;

   1690 21 000774   200026 221300                    LDX1  ! @TABLE_POS+2,,AUTO
        21 000775   000001 702211                    TSX2  ! 1,X1

      285     1691    3           END;
      286     1692    2       IF FIELD$->TABLES.NAME(POS) ~= WORD1

   1692 21 000776   000000 236100                    LDQ     0,,PR0
        21 000777   000011 402007                    MPY     9,DL
        21 001000   000002 736000                    QLS     2
        21 001001   200004 474500                    LDP4    @WORD1,,AUTO
        21 001002   040100 106506                    CMPC    fill='040'O
        21 001003   300000 000036                    ADSC9   0,Q,PR3                  cn=0,n=30
        21 001004   400000 000036                    ADSC9   0,,PR4                   cn=0,n=30
        21 001005   001010 600000 21                 TZE     s:1694

      287     1693    2       THEN POS = POS - 1;

   1693 21 001006   000001 336007                    LCQ     1,DL
        21 001007   000000 056100                    ASQ     0,,PR0

      288     1694    2       FND = %NOTFOUND;

   1694 21 001010   200007 473500                    LDP3    @FND,,AUTO
        21 001011   300000 450100                    STZ     0,,PR3

      289     1695    2       RETURN;

   1695 21 001012   200026 221300                    LDX1  ! @TABLE_POS+2,,AUTO
        21 001013   000001 702211                    TSX2  ! 1,X1

      290     1696    2   END FIND_RIGHT_FIELD;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:49   
      291     1697        %EJECT;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:50   
      292     1698    1       FND = %NOTFOUND;

   1698 21 001014   200007 470500                    LDP0    @FND,,AUTO
        21 001015   000000 450100                    STZ     0,,PR0

      293     1699    2       DO CASE(TYPE);

   1699 21 001016   200003 471500                    LDP1    @TYPE,,AUTO
        21 001017   100000 235100                    LDA     0,,PR1
        21 001020   000024 135007                    SBLA    20,DL
        21 001021   000037 115007                    CMPA    31,DL
        21 001022   001024 602005 21                 TNC     s:1699+6,AL
        21 001023   001144 710000 21                 TRA     s:1711
        21 001024   001107 710000 21                 TRA     s:1705
        21 001025   001144 710000 21                 TRA     s:1711
        21 001026   001144 710000 21                 TRA     s:1711
        21 001027   001144 710000 21                 TRA     s:1711
        21 001030   001144 710000 21                 TRA     s:1711
        21 001031   001144 710000 21                 TRA     s:1711
        21 001032   001144 710000 21                 TRA     s:1711
        21 001033   001144 710000 21                 TRA     s:1711
        21 001034   001144 710000 21                 TRA     s:1711
        21 001035   001144 710000 21                 TRA     s:1711
        21 001036   001121 710000 21                 TRA     s:1707
        21 001037   001133 710000 21                 TRA     s:1709
        21 001040   001144 710000 21                 TRA     s:1711
        21 001041   001144 710000 21                 TRA     s:1711
        21 001042   001144 710000 21                 TRA     s:1711
        21 001043   001144 710000 21                 TRA     s:1711
        21 001044   001144 710000 21                 TRA     s:1711
        21 001045   001144 710000 21                 TRA     s:1711
        21 001046   001144 710000 21                 TRA     s:1711
        21 001047   001144 710000 21                 TRA     s:1711
        21 001050   001075 710000 21                 TRA     s:1703
        21 001051   001144 710000 21                 TRA     s:1711
        21 001052   001144 710000 21                 TRA     s:1711
        21 001053   001144 710000 21                 TRA     s:1711
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:51   
        21 001054   001144 710000 21                 TRA     s:1711
        21 001055   001144 710000 21                 TRA     s:1711
        21 001056   001144 710000 21                 TRA     s:1711
        21 001057   001144 710000 21                 TRA     s:1711
        21 001060   001144 710000 21                 TRA     s:1711
        21 001061   001144 710000 21                 TRA     s:1711
        21 001062   001063 710000 21                 TRA     s:1701

      294     1700    2       CASE (%ZIG_RTYPE_FR);

      295     1701    2           CALL SEARCH_BIN(FIELD$,NUMB_FIELD_SN,WORD1,TABLE_POS);

   1701 21 001063   000025 236000 22                 LDQ     21
        21 001064   200024 756100                    STQ     @NUMB_IN_TABLE+1,,AUTO
        21 001065   200004 236100                    LDQ     @WORD1,,AUTO
        21 001066   000026 235000 22                 LDA     22
        21 001067   200022 757100                    STAQ    @POS+1,,AUTO
        21 001070   000027 236000 22                 LDQ     23
        21 001071   200021 756100                    STQ     LNO+2,,AUTO
        21 001072   000003 701000 21                 TSX1    SEARCH_BIN
        21 001073   000000 011000                    NOP     0
        21 001074   001144 710000 21                 TRA     s:1711

      296     1702    2       CASE (%ZIG_RTYPE_RC);

      297     1703    2           CALL SEARCH_BIN(RECORD$,NUMB_RECORD_SN,WORD1,TABLE_POS);

   1703 21 001075   000025 236000 22                 LDQ     21
        21 001076   200024 756100                    STQ     @NUMB_IN_TABLE+1,,AUTO
        21 001077   200004 236100                    LDQ     @WORD1,,AUTO
        21 001100   000030 235000 22                 LDA     24
        21 001101   200022 757100                    STAQ    @POS+1,,AUTO
        21 001102   000031 236000 22                 LDQ     25
        21 001103   200021 756100                    STQ     LNO+2,,AUTO
        21 001104   000003 701000 21                 TSX1    SEARCH_BIN
        21 001105   000000 011000                    NOP     0
        21 001106   001144 710000 21                 TRA     s:1711
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:52   

      298     1704    2       CASE (%ZIG_RTYPE_AC);

      299     1705    2           CALL SEARCH_BIN(AREA$,NUMB_AREA_SN,WORD1,TABLE_POS);

   1705 21 001107   000025 236000 22                 LDQ     21
        21 001110   200024 756100                    STQ     @NUMB_IN_TABLE+1,,AUTO
        21 001111   200004 236100                    LDQ     @WORD1,,AUTO
        21 001112   000032 235000 22                 LDA     26
        21 001113   200022 757100                    STAQ    @POS+1,,AUTO
        21 001114   000033 236000 22                 LDQ     27
        21 001115   200021 756100                    STQ     LNO+2,,AUTO
        21 001116   000003 701000 21                 TSX1    SEARCH_BIN
        21 001117   000000 011000                    NOP     0
        21 001120   001144 710000 21                 TRA     s:1711

      300     1706    2       CASE (%ZIG_RTYPE_SC);

      301     1707    2           CALL SEARCH_BIN(SET$,NUMB_SET_SN,WORD1,TABLE_POS);

   1707 21 001121   000025 236000 22                 LDQ     21
        21 001122   200024 756100                    STQ     @NUMB_IN_TABLE+1,,AUTO
        21 001123   200004 236100                    LDQ     @WORD1,,AUTO
        21 001124   000034 235000 22                 LDA     28
        21 001125   200022 757100                    STAQ    @POS+1,,AUTO
        21 001126   000035 236000 22                 LDQ     29
        21 001127   200021 756100                    STQ     LNO+2,,AUTO
        21 001130   000003 701000 21                 TSX1    SEARCH_BIN
        21 001131   000000 011000                    NOP     0
        21 001132   001144 710000 21                 TRA     s:1711

      302     1708    2       CASE (%ZIG_RTYPE_KC);

      303     1709    2           CALL SEARCH_BIN(KEY$,NUMB_KEY_SN,WORD1,TABLE_POS);

   1709 21 001133   000025 236000 22                 LDQ     21
        21 001134   200024 756100                    STQ     @NUMB_IN_TABLE+1,,AUTO
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:53   
        21 001135   200004 236100                    LDQ     @WORD1,,AUTO
        21 001136   000036 235000 22                 LDA     30
        21 001137   200022 757100                    STAQ    @POS+1,,AUTO
        21 001140   000037 236000 22                 LDQ     31
        21 001141   200021 756100                    STQ     LNO+2,,AUTO
        21 001142   000003 701000 21                 TSX1    SEARCH_BIN
        21 001143   000000 011000                    NOP     0

      304     1710    2           END;

      305     1711    1       IF FND ~= %NOTFOUND

   1711 21 001144   200007 470500                    LDP0    @FND,,AUTO
        21 001145   000000 235100                    LDA     0,,PR0
        21 001146   001341 600000 21                 TZE     STORE_SN

      306     1712    2       THEN DO;

      307     1713    2           IF FND ~= %FOUNDDUP

   1713 21 001147   000003 115007                    CMPA    3,DL
        21 001150   001161 600000 21                 TZE     s:1724

      308     1714    3           THEN DO;

      309     1715    3               IF UWA.SN.DCLR = 1

   1715 21 001151   000422 236000 19                 LDQ     UWA+274
        21 001152   000001 116007                    CMPQ    1,DL
        21 001153   001157 601000 21                 TNZ     s:1717

      310     1716    3               THEN FND = %FOUNDDEF;

   1716 21 001154   000002 235007                    LDA     2,DL
        21 001155   000000 755100                    STA     0,,PR0
        21 001156   001161 710000 21                 TRA     s:1724

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:54   
      311     1717    3               ELSE FND = %FOUNDREF;

   1717 21 001157   000001 235007                    LDA     1,DL
        21 001160   000000 755100                    STA     0,,PR0

      312     1718    3               END;

      313     1719         /* if this is the definition of a forward reference, then
      314     1720            update the SN to show forward ref satisfied,
      315     1721            update current def dbk (nrwu),
      316     1722            DONT call add_nr (unless it is a key )
      317     1723            otherwise, its not a def so call add_nr. */
      318     1724    3           IF DCLR = 1 THEN DO;

   1724 21 001161   200005 471500                    LDP1    @DCLR,,AUTO
        21 001162   100000 235100                    LDA     0,,PR1
        21 001163   000001 115007                    CMPA    1,DL
        21 001164   001322 601000 21                 TNZ     s:1746

      319     1725    3               IF TYPE ~= %ZIG_RTYPE_KC THEN UWA.SN.LNO = LN;

   1725 21 001165   200003 473500                    LDP3    @TYPE,,AUTO
        21 001166   300000 235100                    LDA     0,,PR3
        21 001167   000037 115007                    CMPA    31,DL
        21 001170   001174 600000 21                 TZE     s:1726

   1725 21 001171   200006 474500                    LDP4    @LN,,AUTO
        21 001172   400000 235100                    LDA     0,,PR4
        21 001173   000425 755000 19                 STA     UWA+277

      320     1726    3               UWA.SN.DCLR = 1;

   1726 21 001174   000001 235007                    LDA     1,DL
        21 001175   000422 755000 19                 STA     UWA+274

      321     1727    3               CALL MODIFY_6('SN      ');

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:55   
   1727 21 001176   000005 630400 22                 EPPR0   5
        21 001177   000001 631400 22                 EPPR1   1
        21 001200   000000 701000 xent               TSX1    MODIFY_6
        21 001201   000000 011000                    NOP     0

      322     1728    4               DO CASE(TYPE);

   1728 21 001202   200003 470500                    LDP0    @TYPE,,AUTO
        21 001203   000000 235100                    LDA     0,,PR0
        21 001204   000024 135007                    SBLA    20,DL
        21 001205   000037 115007                    CMPA    31,DL
        21 001206   001210 602005 21                 TNC     s:1728+6,AL
        21 001207   001340 710000 21                 TRA     s:1751
        21 001210   001313 710000 21                 TRA     s:1742
        21 001211   001321 710000 21                 TRA     s:1744
        21 001212   001321 710000 21                 TRA     s:1744
        21 001213   001321 710000 21                 TRA     s:1744
        21 001214   001321 710000 21                 TRA     s:1744
        21 001215   001321 710000 21                 TRA     s:1744
        21 001216   001321 710000 21                 TRA     s:1744
        21 001217   001321 710000 21                 TRA     s:1744
        21 001220   001321 710000 21                 TRA     s:1744
        21 001221   001321 710000 21                 TRA     s:1744
        21 001222   001260 710000 21                 TRA     s:1733
        21 001223   001271 710000 21                 TRA     s:1736
        21 001224   001321 710000 21                 TRA     s:1744
        21 001225   001321 710000 21                 TRA     s:1744
        21 001226   001321 710000 21                 TRA     s:1744
        21 001227   001321 710000 21                 TRA     s:1744
        21 001230   001321 710000 21                 TRA     s:1744
        21 001231   001321 710000 21                 TRA     s:1744
        21 001232   001321 710000 21                 TRA     s:1744
        21 001233   001321 710000 21                 TRA     s:1744
        21 001234   001247 710000 21                 TRA     s:1730
        21 001235   001321 710000 21                 TRA     s:1744
        21 001236   001321 710000 21                 TRA     s:1744
        21 001237   001321 710000 21                 TRA     s:1744
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:56   
        21 001240   001321 710000 21                 TRA     s:1744
        21 001241   001321 710000 21                 TRA     s:1744
        21 001242   001321 710000 21                 TRA     s:1744
        21 001243   001321 710000 21                 TRA     s:1744
        21 001244   001321 710000 21                 TRA     s:1744
        21 001245   001321 710000 21                 TRA     s:1744
        21 001246   001304 710000 21                 TRA     s:1740

      323     1729    4               CASE(%ZIG_RTYPE_RC);

      324     1730    4                   LAST_DEF_REC_DBK = UWA.DIRECT_REF;

   1730 21 001247   000036 236000 19                 LDQ     UWA+30
        21 001250   000000 756000 17                 STQ     LAST_DEF_REC_DBK

      325     1731    4                   RECORD$ -> TABLES.DEFINED(TABLE_POS) = '1'B;

   1731 21 001251   000007 236000 1                  LDQ     TABLE_POS
        21 001252   000011 402007                    MPY     9,DL
        21 001253   000000 471400 10                 LDP1    RECORD$
        21 001254   000000 620006                    EAX0    0,QL
        21 001255   400000 236003                    LDQ     -131072,DU
        21 001256   100010 256110                    ORSQ    8,X0,PR1
        21 001257   001340 710000 21                 TRA     s:1751

      326     1732    4               CASE(%ZIG_RTYPE_SC);

      327     1733    4                   LAST_DEF_SET_DBK = UWA.DIRECT_REF;

   1733 21 001260   000036 236000 19                 LDQ     UWA+30
        21 001261   000000 756000 16                 STQ     LAST_DEF_SET_DBK

      328     1734    4                   SET$ -> TABLES.DEFINED(TABLE_POS) = '1'B;

   1734 21 001262   000007 236000 1                  LDQ     TABLE_POS
        21 001263   000011 402007                    MPY     9,DL
        21 001264   000000 471400 12                 LDP1    SET$
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:57   
        21 001265   000000 620006                    EAX0    0,QL
        21 001266   400000 236003                    LDQ     -131072,DU
        21 001267   100010 256110                    ORSQ    8,X0,PR1
        21 001270   001340 710000 21                 TRA     s:1751

      329     1735    4               CASE(%ZIG_RTYPE_KC);

      330     1736    4                   LAST_DEF_KEY_DBK = UWA.DIRECT_REF;

   1736 21 001271   000036 236000 19                 LDQ     UWA+30
        21 001272   000000 756000 1                  STQ     LAST_DEF_KEY_DBK

      331     1737    4                   KEY$ -> TABLES.DEFINED(TABLE_POS) = '1'B;

   1737 21 001273   000007 236000 1                  LDQ     TABLE_POS
        21 001274   000011 402007                    MPY     9,DL
        21 001275   000000 471400 5                  LDP1    KEY$
        21 001276   000000 620006                    EAX0    0,QL
        21 001277   400000 236003                    LDQ     -131072,DU
        21 001300   100010 256110                    ORSQ    8,X0,PR1

      332     1738    4                   CALL ADD_NR;

   1738 21 001301   002023 701000 21                 TSX1    ADD_NR
        21 001302   000000 011000                    NOP     0
        21 001303   001340 710000 21                 TRA     s:1751

      333     1739    4               CASE (%ZIG_RTYPE_FR);

      334     1740    4                   FIELD$ -> TABLES.DEFINED(TABLE_POS) = '1'B;

   1740 21 001304   000007 236000 1                  LDQ     TABLE_POS
        21 001305   000011 402007                    MPY     9,DL
        21 001306   000000 471400 11                 LDP1    FIELD$
        21 001307   000000 620006                    EAX0    0,QL
        21 001310   400000 236003                    LDQ     -131072,DU
        21 001311   100010 256110                    ORSQ    8,X0,PR1
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:58   
        21 001312   001340 710000 21                 TRA     s:1751

      335     1741    4               CASE (%ZIG_RTYPE_AC);

      336     1742    4                   AREA$ -> TABLES.DEFINED(TABLE_POS) = '1'B;

   1742 21 001313   000007 236000 1                  LDQ     TABLE_POS
        21 001314   000011 402007                    MPY     9,DL
        21 001315   000000 471400 4                  LDP1    AREA$
        21 001316   000000 620006                    EAX0    0,QL
        21 001317   400000 236003                    LDQ     -131072,DU
        21 001320   100010 256110                    ORSQ    8,X0,PR1

      337     1743    4                   END; /*CASE*/

      338     1744    3               END;

   1744 21 001321   001340 710000 21                 TRA     s:1751

      339     1745    3           ELSE DO;

      340     1746    3               IF TYPE = %ZIG_RTYPE_RC

   1746 21 001322   200003 473500                    LDP3    @TYPE,,AUTO
        21 001323   300000 235100                    LDA     0,,PR3
        21 001324   000050 115007                    CMPA    40,DL
        21 001325   001332 601000 21                 TNZ     s:1748

      341     1747    3               THEN LAST_RC$ = ADDR(RECORD$->TABLES(TABLE_POS));

   1747 21 001326   000007 236000 1                  LDQ     TABLE_POS
        21 001327   000011 402003                    MPY     9,DU
        21 001330   000000 036000 10                 ADLQ    RECORD$
        21 001331   000000 756000 6                  STQ     LAST_RC$

      342     1748    3               IF RLTYPE ~= RELTYPE.NO_NR THEN

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:59   
   1748 21 001332   200010 474500                    LDP4    @RLTYPE,,AUTO
        21 001333   400000 236100                    LDQ     0,,PR4
        21 001334   000034 116000 1                  CMPQ    RELTYPE+9
        21 001335   001340 600000 21                 TZE     s:1751

      343     1749    3                   CALL ADD_NR;

   1749 21 001336   002023 701000 21                 TSX1    ADD_NR
        21 001337   000000 011000                    NOP     0

      344     1750    3               END;

      345     1751    2           RETURN;

   1751 21 001340   000000 702200 xent               TSX2  ! X66_ARET

      346     1752    2           END;
      347     1753    1   STORE_SN: IF UWA.DIRECT_REF = UWA.SF.DBKEY_DA THEN

   1753 21 001341   000036 236000 19    STORE_SN     LDQ     UWA+30
        21 001342   000064 116000 19                 CMPQ    UWA+52
        21 001343   001350 601000 21                 TNZ     s:1755

      348     1754    1           CALL FETCHNS_6('DA-SN   '); /* SN of schema name */

   1754 21 001344   000007 630400 22                 EPPR0   7
        21 001345   000001 631400 22                 EPPR1   1
        21 001346   000000 701000 xent               TSX1    FETCHNS_6
        21 001347   000000 011000                    NOP     0

      349     1755    1       UWA.SN = '0'B;

   1755 21 001350   000000 100400                    MLR     fill='000'O
        21 001351   000024 000001 22                 ADSC9   20                       cn=0,n=1
        21 001352   000422 000062 19                 ADSC9   UWA+274                  cn=0,n=50

      350     1756    1       UWA.SN.DCLR = DCLR;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:60   

   1756 21 001353   200005 470500                    LDP0    @DCLR,,AUTO
        21 001354   000000 235100                    LDA     0,,PR0
        21 001355   000422 755000 19                 STA     UWA+274

      351     1757    1       UWA.SN.SETYPE = TYPE;

   1757 21 001356   200003 471500                    LDP1    @TYPE,,AUTO
        21 001357   100000 235100                    LDA     0,,PR1
        21 001360   000424 755000 19                 STA     UWA+276

      352     1758    1       UWA.SN.LNO = LN;

   1758 21 001361   200006 473500                    LDP3    @LN,,AUTO
        21 001362   300000 235100                    LDA     0,,PR3
        21 001363   000425 755000 19                 STA     UWA+277

      353     1759    1       UWA.SN.SENAME = WORD1;

   1759 21 001364   200004 474500                    LDP4    @WORD1,,AUTO
        21 001365   040000 100500                    MLR     fill='040'O
        21 001366   400000 000036                    ADSC9   0,,PR4                   cn=0,n=30
        21 001367   000427 000036 19                 ADSC9   UWA+279                  cn=0,n=30

      354     1760    1       CALL STRE_6('SN      ');

   1760 21 001370   000005 630400 22                 EPPR0   5
        21 001371   000001 631400 22                 EPPR1   1
        21 001372   000000 701000 xent               TSX1    STRE_6
        21 001373   000000 011000                    NOP     0

      355     1761    1       UWA.DA.NUMB_SN = UWA.DA.NUMB_SN + 1;

   1761 21 001374   000406 054000 19                 AOS     UWA+262

      356     1762    2       DO CASE(TYPE);

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:61   
   1762 21 001375   200003 470500                    LDP0    @TYPE,,AUTO
        21 001376   000000 235100                    LDA     0,,PR0
        21 001377   000024 135007                    SBLA    20,DL
        21 001400   000037 115007                    CMPA    31,DL
        21 001401   001403 602005 21                 TNC     s:1762+6,AL
        21 001402   001661 710000 21                 TRA     s:1795
        21 001403   001464 710000 21                 TRA     s:1768
        21 001404   001661 710000 21                 TRA     s:1795
        21 001405   001661 710000 21                 TRA     s:1795
        21 001406   001661 710000 21                 TRA     s:1795
        21 001407   001661 710000 21                 TRA     s:1795
        21 001410   001661 710000 21                 TRA     s:1795
        21 001411   001661 710000 21                 TRA     s:1795
        21 001412   001661 710000 21                 TRA     s:1795
        21 001413   001661 710000 21                 TRA     s:1795
        21 001414   001661 710000 21                 TRA     s:1795
        21 001415   001566 710000 21                 TRA     s:1781
        21 001416   001616 710000 21                 TRA     s:1786
        21 001417   001661 710000 21                 TRA     s:1795
        21 001420   001661 710000 21                 TRA     s:1795
        21 001421   001661 710000 21                 TRA     s:1795
        21 001422   001661 710000 21                 TRA     s:1795
        21 001423   001661 710000 21                 TRA     s:1795
        21 001424   001661 710000 21                 TRA     s:1795
        21 001425   001661 710000 21                 TRA     s:1795
        21 001426   001661 710000 21                 TRA     s:1795
        21 001427   001526 710000 21                 TRA     s:1775
        21 001430   001661 710000 21                 TRA     s:1795
        21 001431   001661 710000 21                 TRA     s:1795
        21 001432   001661 710000 21                 TRA     s:1795
        21 001433   001661 710000 21                 TRA     s:1795
        21 001434   001661 710000 21                 TRA     s:1795
        21 001435   001661 710000 21                 TRA     s:1795
        21 001436   001661 710000 21                 TRA     s:1795
        21 001437   001661 710000 21                 TRA     s:1795
        21 001440   001661 710000 21                 TRA     s:1795
        21 001441   001442 710000 21                 TRA     s:1764
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:62   

      357     1763    2       CASE(%ZIG_RTYPE_FR);

      358     1764    2           CALL ADD_TABLE(TABLE_POS+1,FIELD$,NUMB_FIELD_SN);

   1764 21 001442   000007 236000 1                  LDQ     TABLE_POS
        21 001443   000001 036007                    ADLQ    1,DL
        21 001444   200033 756100                    STQ     @POS+4,,AUTO
        21 001445   000040 237000 22                 LDAQ    32
        21 001446   200022 757100                    STAQ    @POS+1,,AUTO
        21 001447   200033 631500                    EPPR1   @POS+4,,AUTO
        21 001450   200021 451500                    STP1    LNO+2,,AUTO
        21 001451   000362 701000 21                 TSX1    ADD_TABLE
        21 001452   000000 011000                    NOP     0

      359     1765    2           NUMB_FIELD_SN = NUMB_FIELD_SN + 1;

   1765 21 001453   000000 235000 8                  LDA     NUMB_FIELD_SN
        21 001454   000001 035007                    ADLA    1,DL
        21 001455   000000 755000 8                  STA     NUMB_FIELD_SN

      360     1766    2           IF TABLE_POS = -1 THEN UWA.DA.FRST_FR = UWA.DIRECT_REF;

   1766 21 001456   000007 236000 1                  LDQ     TABLE_POS
        21 001457   000000 116000 22                 CMPQ    0
        21 001460   001661 601000 21                 TNZ     s:1795

   1766 21 001461   000036 235000 19                 LDA     UWA+30
        21 001462   000421 755000 19                 STA     UWA+273
        21 001463   001661 710000 21                 TRA     s:1795

      361     1767    2       CASE(%ZIG_RTYPE_AC);

      362     1768    2           CALL ADD_TABLE(TABLE_POS+1,AREA$,NUMB_AREA_SN+NUMB_KEY_SN+NUMB_RECORD_SN+
              1768                    NUMB_SET_SN);

   1768 21 001464   000000 236000 2                  LDQ     NUMB_AREA_SN
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:63   
        21 001465   000000 036000 3                  ADLQ    NUMB_KEY_SN
        21 001466   000000 036000 7                  ADLQ    NUMB_RECORD_SN
        21 001467   000000 036000 9                  ADLQ    NUMB_SET_SN
        21 001470   000007 235000 1                  LDA     TABLE_POS
        21 001471   000001 035007                    ADLA    1,DL
        21 001472   200034 755100                    STA     @POS+5,,AUTO
        21 001473   200035 756100                    STQ     @POS+6,,AUTO
        21 001474   200035 631500                    EPPR1   @POS+6,,AUTO
        21 001475   200023 451500                    STP1    @PTR$+1,,AUTO
        21 001476   000033 236000 22                 LDQ     27
        21 001477   200022 756100                    STQ     @POS+1,,AUTO
        21 001500   200034 633500                    EPPR3   @POS+5,,AUTO
        21 001501   200021 453500                    STP3    LNO+2,,AUTO
        21 001502   000362 701000 21                 TSX1    ADD_TABLE
        21 001503   000000 011000                    NOP     0

      363     1769    2           NUMB_AREA_SN = NUMB_AREA_SN + 1;

   1769 21 001504   000000 235000 2                  LDA     NUMB_AREA_SN
        21 001505   000001 035007                    ADLA    1,DL
        21 001506   000000 755000 2                  STA     NUMB_AREA_SN

      364     1770    2           IF TABLE_POS = -1 THEN UWA.DA.FRST_AC = UWA.DIRECT_REF;

   1770 21 001507   000007 236000 1                  LDQ     TABLE_POS
        21 001510   000000 116000 22                 CMPQ    0
        21 001511   001514 601000 21                 TNZ     s:1771

   1770 21 001512   000036 235000 19                 LDA     UWA+30
        21 001513   000415 755000 19                 STA     UWA+269

      365     1771    2           SET$ = PINCRW(SET$,9);

   1771 21 001514   000000 236000 12                 LDQ     SET$
        21 001515   000011 036003                    ADLQ    9,DU
        21 001516   000000 756000 12                 STQ     SET$

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:64   
      366     1772    2           KEY$ = PINCRW(KEY$,9);

   1772 21 001517   000000 236000 5                  LDQ     KEY$
        21 001520   000011 036003                    ADLQ    9,DU
        21 001521   000000 756000 5                  STQ     KEY$

      367     1773    2           RECORD$ = PINCRW(RECORD$,9);

   1773 21 001522   000000 236000 10                 LDQ     RECORD$
        21 001523   000011 036003                    ADLQ    9,DU
        21 001524   000000 756000 10                 STQ     RECORD$
        21 001525   001661 710000 21                 TRA     s:1795

      368     1774    2       CASE(%ZIG_RTYPE_RC);

      369     1775    2           CALL ADD_TABLE(TABLE_POS+1,RECORD$,NUMB_RECORD_SN+NUMB_SET_SN);

   1775 21 001526   000000 236000 7                  LDQ     NUMB_RECORD_SN
        21 001527   000000 036000 9                  ADLQ    NUMB_SET_SN
        21 001530   000007 235000 1                  LDA     TABLE_POS
        21 001531   000001 035007                    ADLA    1,DL
        21 001532   200036 755100                    STA     @POS+7,,AUTO
        21 001533   200037 756100                    STQ     @POS+8,,AUTO
        21 001534   200037 631500                    EPPR1   @POS+8,,AUTO
        21 001535   200023 451500                    STP1    @PTR$+1,,AUTO
        21 001536   000031 236000 22                 LDQ     25
        21 001537   200022 756100                    STQ     @POS+1,,AUTO
        21 001540   200036 633500                    EPPR3   @POS+7,,AUTO
        21 001541   200021 453500                    STP3    LNO+2,,AUTO
        21 001542   000362 701000 21                 TSX1    ADD_TABLE
        21 001543   000000 011000                    NOP     0

      370     1776    2           NUMB_RECORD_SN = NUMB_RECORD_SN + 1;

   1776 21 001544   000000 235000 7                  LDA     NUMB_RECORD_SN
        21 001545   000001 035007                    ADLA    1,DL
        21 001546   000000 755000 7                  STA     NUMB_RECORD_SN
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:65   

      371     1777    2           IF TABLE_POS = -1 THEN UWA.DA.FRST_RC = UWA.DIRECT_REF;

   1777 21 001547   000007 236000 1                  LDQ     TABLE_POS
        21 001550   000000 116000 22                 CMPQ    0
        21 001551   001554 601000 21                 TNZ     s:1778

   1777 21 001552   000036 235000 19                 LDA     UWA+30
        21 001553   000416 755000 19                 STA     UWA+270

      372     1778    2           IF DCLR = 1 THEN LAST_DEF_REC_DBK = UWA.DIRECT_REF;

   1778 21 001554   200005 470500                    LDP0    @DCLR,,AUTO
        21 001555   000000 235100                    LDA     0,,PR0
        21 001556   000001 115007                    CMPA    1,DL
        21 001557   001562 601000 21                 TNZ     s:1779

   1778 21 001560   000036 235000 19                 LDA     UWA+30
        21 001561   000000 755000 17                 STA     LAST_DEF_REC_DBK

      373     1779    2           SET$ = PINCRW(SET$,9);

   1779 21 001562   000000 236000 12                 LDQ     SET$
        21 001563   000011 036003                    ADLQ    9,DU
        21 001564   000000 756000 12                 STQ     SET$
        21 001565   001661 710000 21                 TRA     s:1795

      374     1780    2       CASE(%ZIG_RTYPE_SC);

      375     1781    2           CALL ADD_TABLE(TABLE_POS+1,SET$,NUMB_SET_SN);

   1781 21 001566   000007 236000 1                  LDQ     TABLE_POS
        21 001567   000001 036007                    ADLQ    1,DL
        21 001570   200040 756100                    STQ     @POS+9,,AUTO
        21 001571   000042 237000 22                 LDAQ    34
        21 001572   200022 757100                    STAQ    @POS+1,,AUTO
        21 001573   200040 631500                    EPPR1   @POS+9,,AUTO
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:66   
        21 001574   200021 451500                    STP1    LNO+2,,AUTO
        21 001575   000362 701000 21                 TSX1    ADD_TABLE
        21 001576   000000 011000                    NOP     0

      376     1782    2           NUMB_SET_SN = NUMB_SET_SN + 1;

   1782 21 001577   000000 235000 9                  LDA     NUMB_SET_SN
        21 001600   000001 035007                    ADLA    1,DL
        21 001601   000000 755000 9                  STA     NUMB_SET_SN

      377     1783    2           IF TABLE_POS = -1 THEN UWA.DA.FRST_SC = UWA.DIRECT_REF;

   1783 21 001602   000007 236000 1                  LDQ     TABLE_POS
        21 001603   000000 116000 22                 CMPQ    0
        21 001604   001607 601000 21                 TNZ     s:1784

   1783 21 001605   000036 235000 19                 LDA     UWA+30
        21 001606   000417 755000 19                 STA     UWA+271

      378     1784    2           IF DCLR = 1 THEN LAST_DEF_SET_DBK = UWA.DIRECT_REF;

   1784 21 001607   200005 470500                    LDP0    @DCLR,,AUTO
        21 001610   000000 235100                    LDA     0,,PR0
        21 001611   000001 115007                    CMPA    1,DL
        21 001612   001661 601000 21                 TNZ     s:1795

   1784 21 001613   000036 235000 19                 LDA     UWA+30
        21 001614   000000 755000 16                 STA     LAST_DEF_SET_DBK
        21 001615   001661 710000 21                 TRA     s:1795

      379     1785    2       CASE(%ZIG_RTYPE_KC);

      380     1786    2           CALL ADD_TABLE(TABLE_POS+1,KEY$,NUMB_KEY_SN+NUMB_RECORD_SN+NUMB_SET_SN);

   1786 21 001616   000000 236000 3                  LDQ     NUMB_KEY_SN
        21 001617   000000 036000 7                  ADLQ    NUMB_RECORD_SN
        21 001620   000000 036000 9                  ADLQ    NUMB_SET_SN
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:67   
        21 001621   000007 235000 1                  LDA     TABLE_POS
        21 001622   000001 035007                    ADLA    1,DL
        21 001623   200041 755100                    STA     @POS+10,,AUTO
        21 001624   200042 756100                    STQ     @POS+11,,AUTO
        21 001625   200042 631500                    EPPR1   @POS+11,,AUTO
        21 001626   200023 451500                    STP1    @PTR$+1,,AUTO
        21 001627   000037 236000 22                 LDQ     31
        21 001630   200022 756100                    STQ     @POS+1,,AUTO
        21 001631   200041 633500                    EPPR3   @POS+10,,AUTO
        21 001632   200021 453500                    STP3    LNO+2,,AUTO
        21 001633   000362 701000 21                 TSX1    ADD_TABLE
        21 001634   000000 011000                    NOP     0

      381     1787    2           NUMB_KEY_SN = NUMB_KEY_SN + 1;

   1787 21 001635   000000 235000 3                  LDA     NUMB_KEY_SN
        21 001636   000001 035007                    ADLA    1,DL
        21 001637   000000 755000 3                  STA     NUMB_KEY_SN

      382     1788    2           IF TABLE_POS = -1 THEN UWA.DA.FRST_KC = UWA.DIRECT_REF;

   1788 21 001640   000007 236000 1                  LDQ     TABLE_POS
        21 001641   000000 116000 22                 CMPQ    0
        21 001642   001645 601000 21                 TNZ     s:1789

   1788 21 001643   000036 235000 19                 LDA     UWA+30
        21 001644   000420 755000 19                 STA     UWA+272

      383     1789    2           RECORD$ = PINCRW(RECORD$,9);

   1789 21 001645   000000 236000 10                 LDQ     RECORD$
        21 001646   000011 036003                    ADLQ    9,DU
        21 001647   000000 756000 10                 STQ     RECORD$

      384     1790    2           SET$ = PINCRW(SET$,9);

   1790 21 001650   000000 236000 12                 LDQ     SET$
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:68   
        21 001651   000011 036003                    ADLQ    9,DU
        21 001652   000000 756000 12                 STQ     SET$

      385     1791    3           IF DCLR = 1 THEN DO;

   1791 21 001653   200005 470500                    LDP0    @DCLR,,AUTO
        21 001654   000000 235100                    LDA     0,,PR0
        21 001655   000001 115007                    CMPA    1,DL
        21 001656   001661 601000 21                 TNZ     s:1795

      386     1792    3               LAST_DEF_KEY_DBK = UWA.DIRECT_REF;

   1792 21 001657   000036 235000 19                 LDA     UWA+30
        21 001660   000000 755000 1                  STA     LAST_DEF_KEY_DBK

      387     1793    3               END;

      388     1794    2           END;

      389     1795    1       IF RLTYPE ~= RELTYPE.NO_NR THEN

   1795 21 001661   200010 470500                    LDP0    @RLTYPE,,AUTO
        21 001662   000000 236100                    LDQ     0,,PR0
        21 001663   000034 116000 1                  CMPQ    RELTYPE+9
        21 001664   001667 600000 21                 TZE     s:1797

      390     1796    1           CALL ADD_NR;

   1796 21 001665   002023 701000 21                 TSX1    ADD_NR
        21 001666   000000 011000                    NOP     0

      391     1797    1       RETURN;

   1797 21 001667   000000 702200 xent               TSX2  ! X66_ARET

      392     1798
      393     1799        %EJECT;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:69   
      394     1800    1   JUST_FIND_SN:
      395     1801    1       ENTRY(TYPE,WORD1,DCLR,LN,FND,RLTYPE,IMPLCIT,RC_DBK);

   1801 21 001670   000000 700200 xent  JUST_FIND_SN TSX0  ! X66_AUTO_N
        21 001671   000044 000010                    ZERO    36,8

      396     1802    1       FND = %NOTFOUND;

   1802 21 001672   200007 470500                    LDP0    @FND,,AUTO
        21 001673   000000 450100                    STZ     0,,PR0

      397     1803    2       DO CASE(TYPE);

   1803 21 001674   200003 471500                    LDP1    @TYPE,,AUTO
        21 001675   100000 235100                    LDA     0,,PR1
        21 001676   000024 135007                    SBLA    20,DL
        21 001677   000037 115007                    CMPA    31,DL
        21 001700   001702 602005 21                 TNC     s:1803+6,AL
        21 001701   002022 710000 21                 TRA     s:1815
        21 001702   001765 710000 21                 TRA     s:1809
        21 001703   002022 710000 21                 TRA     s:1815
        21 001704   002022 710000 21                 TRA     s:1815
        21 001705   002022 710000 21                 TRA     s:1815
        21 001706   002022 710000 21                 TRA     s:1815
        21 001707   002022 710000 21                 TRA     s:1815
        21 001710   002022 710000 21                 TRA     s:1815
        21 001711   002022 710000 21                 TRA     s:1815
        21 001712   002022 710000 21                 TRA     s:1815
        21 001713   002022 710000 21                 TRA     s:1815
        21 001714   001777 710000 21                 TRA     s:1811
        21 001715   002011 710000 21                 TRA     s:1813
        21 001716   002022 710000 21                 TRA     s:1815
        21 001717   002022 710000 21                 TRA     s:1815
        21 001720   002022 710000 21                 TRA     s:1815
        21 001721   002022 710000 21                 TRA     s:1815
        21 001722   002022 710000 21                 TRA     s:1815
        21 001723   002022 710000 21                 TRA     s:1815
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:70   
        21 001724   002022 710000 21                 TRA     s:1815
        21 001725   002022 710000 21                 TRA     s:1815
        21 001726   001753 710000 21                 TRA     s:1807
        21 001727   002022 710000 21                 TRA     s:1815
        21 001730   002022 710000 21                 TRA     s:1815
        21 001731   002022 710000 21                 TRA     s:1815
        21 001732   002022 710000 21                 TRA     s:1815
        21 001733   002022 710000 21                 TRA     s:1815
        21 001734   002022 710000 21                 TRA     s:1815
        21 001735   002022 710000 21                 TRA     s:1815
        21 001736   002022 710000 21                 TRA     s:1815
        21 001737   002022 710000 21                 TRA     s:1815
        21 001740   001741 710000 21                 TRA     s:1805

      398     1804    2       CASE (%ZIG_RTYPE_FR);

      399     1805    2           CALL SEARCH_BIN(FIELD$,NUMB_FIELD_SN,WORD1,TABLE_POS);

   1805 21 001741   000025 236000 22                 LDQ     21
        21 001742   200024 756100                    STQ     @NUMB_IN_TABLE+1,,AUTO
        21 001743   200004 236100                    LDQ     @WORD1,,AUTO
        21 001744   000026 235000 22                 LDA     22
        21 001745   200022 757100                    STAQ    @POS+1,,AUTO
        21 001746   000027 236000 22                 LDQ     23
        21 001747   200021 756100                    STQ     LNO+2,,AUTO
        21 001750   000003 701000 21                 TSX1    SEARCH_BIN
        21 001751   000000 011000                    NOP     0
        21 001752   002022 710000 21                 TRA     s:1815

      400     1806    2       CASE (%ZIG_RTYPE_RC);

      401     1807    2           CALL SEARCH_BIN(RECORD$,NUMB_RECORD_SN,WORD1,TABLE_POS);

   1807 21 001753   000025 236000 22                 LDQ     21
        21 001754   200024 756100                    STQ     @NUMB_IN_TABLE+1,,AUTO
        21 001755   200004 236100                    LDQ     @WORD1,,AUTO
        21 001756   000030 235000 22                 LDA     24
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:71   
        21 001757   200022 757100                    STAQ    @POS+1,,AUTO
        21 001760   000031 236000 22                 LDQ     25
        21 001761   200021 756100                    STQ     LNO+2,,AUTO
        21 001762   000003 701000 21                 TSX1    SEARCH_BIN
        21 001763   000000 011000                    NOP     0
        21 001764   002022 710000 21                 TRA     s:1815

      402     1808    2       CASE (%ZIG_RTYPE_AC);

      403     1809    2           CALL SEARCH_BIN(AREA$,NUMB_AREA_SN,WORD1,TABLE_POS);

   1809 21 001765   000025 236000 22                 LDQ     21
        21 001766   200024 756100                    STQ     @NUMB_IN_TABLE+1,,AUTO
        21 001767   200004 236100                    LDQ     @WORD1,,AUTO
        21 001770   000032 235000 22                 LDA     26
        21 001771   200022 757100                    STAQ    @POS+1,,AUTO
        21 001772   000033 236000 22                 LDQ     27
        21 001773   200021 756100                    STQ     LNO+2,,AUTO
        21 001774   000003 701000 21                 TSX1    SEARCH_BIN
        21 001775   000000 011000                    NOP     0
        21 001776   002022 710000 21                 TRA     s:1815

      404     1810    2       CASE (%ZIG_RTYPE_SC);

      405     1811    2           CALL SEARCH_BIN(SET$,NUMB_SET_SN,WORD1,TABLE_POS);

   1811 21 001777   000025 236000 22                 LDQ     21
        21 002000   200024 756100                    STQ     @NUMB_IN_TABLE+1,,AUTO
        21 002001   200004 236100                    LDQ     @WORD1,,AUTO
        21 002002   000034 235000 22                 LDA     28
        21 002003   200022 757100                    STAQ    @POS+1,,AUTO
        21 002004   000035 236000 22                 LDQ     29
        21 002005   200021 756100                    STQ     LNO+2,,AUTO
        21 002006   000003 701000 21                 TSX1    SEARCH_BIN
        21 002007   000000 011000                    NOP     0
        21 002010   002022 710000 21                 TRA     s:1815

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:72   
      406     1812    2       CASE (%ZIG_RTYPE_KC);

      407     1813    2           CALL SEARCH_BIN(KEY$,NUMB_KEY_SN,WORD1,TABLE_POS);

   1813 21 002011   000025 236000 22                 LDQ     21
        21 002012   200024 756100                    STQ     @NUMB_IN_TABLE+1,,AUTO
        21 002013   200004 236100                    LDQ     @WORD1,,AUTO
        21 002014   000036 235000 22                 LDA     30
        21 002015   200022 757100                    STAQ    @POS+1,,AUTO
        21 002016   000037 236000 22                 LDQ     31
        21 002017   200021 756100                    STQ     LNO+2,,AUTO
        21 002020   000003 701000 21                 TSX1    SEARCH_BIN
        21 002021   000000 011000                    NOP     0

      408     1814    2           END;

      409     1815    1       RETURN;

   1815 21 002022   000000 702200 xent               TSX2  ! X66_ARET

      410     1816        %EJECT;
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:73   
      411     1817    1   ADD_NR: PROC;

   1817 21 002023   200020 741300       ADD_NR       STX1  ! LNO+1,,AUTO

      412     1818
      413     1819    2       LN_DIFF = 0;

   1819 21 002024   200014 450100                    STZ     LN_DIFF,,AUTO

      414     1820    2       IF (RLTYPE = RELTYPE.KEY_IN_REC) OR (RLTYPE = RELTYPE.FLD_IN_KEY) THEN

   1820 21 002025   200010 470500                    LDP0    @RLTYPE,,AUTO
        21 002026   000000 236100                    LDQ     0,,PR0
        21 002027   000032 116000 1                  CMPQ    RELTYPE+7
        21 002030   002033 600000 21                 TZE     s:1821
        21 002031   000033 116000 1                  CMPQ    RELTYPE+8
        21 002032   002035 601000 21                 TNZ     s:1822

      415     1821    2           LN_DIFF = 1;

   1821 21 002033   000001 235007                    LDA     1,DL
        21 002034   200014 755100                    STA     LN_DIFF,,AUTO

      416     1822    2       LAST_SN_DBK = UWA.DIRECT_REF; /* save currency so can restore later */

   1822 21 002035   000036 235000 19                 LDA     UWA+30
        21 002036   200013 755100                    STA     LAST_SN_DBK,,AUTO

      417     1823    2       UWA.NR = '0'B;

   1823 21 002037   000000 100400                    MLR     fill='000'O
        21 002040   000024 000001 22                 ADSC9   20                       cn=0,n=1
        21 002041   000466 000020 19                 ADSC9   UWA+310                  cn=0,n=16

      418     1824    2       UWA.NR.IMPLCT = IMPLCIT;

   1824 21 002042   200011 471500                    LDP1    @IMPLCIT,,AUTO
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:74   
        21 002043   100000 235100                    LDA     0,,PR1
        21 002044   000467 755000 19                 STA     UWA+311

      419     1825    2       UWA.NR.RELTYPE = RLTYPE;

   1825 21 002045   000000 235100                    LDA     0,,PR0
        21 002046   000470 755000 19                 STA     UWA+312

      420     1826    2       UWA.NR.LNO = LN + LN_DIFF;

   1826 21 002047   200006 473500                    LDP3    @LN,,AUTO
        21 002050   300000 236100                    LDQ     0,,PR3
        21 002051   200014 036100                    ADLQ    LN_DIFF,,AUTO
        21 002052   000471 756000 19                 STQ     UWA+313

      421     1827    2       CALL STRE_6('NR      ');

   1827 21 002053   000044 630400 22                 EPPR0   36
        21 002054   000001 631400 22                 EPPR1   1
        21 002055   000000 701000 xent               TSX1    STRE_6
        21 002056   000000 011000                    NOP     0

      422     1828    2       UWA.DA.NUMB_NR = UWA.DA.NUMB_NR + 1;

   1828 21 002057   000407 054000 19                 AOS     UWA+263

      423     1829    3       DO CASE(RLTYPE);

   1829 21 002060   200010 470500                    LDP0    @RLTYPE,,AUTO
        21 002061   000000 235100                    LDA     0,,PR0
        21 002062   000023 115007                    CMPA    19,DL
        21 002063   002065 602005 21                 TNC     s:1829+5,AL
        21 002064   002142 710000 21                 TRA     s:1840
        21 002065   002142 710000 21                 TRA     s:1840
        21 002066   002142 710000 21                 TRA     s:1840
        21 002067   002142 710000 21                 TRA     s:1840
        21 002070   002115 710000 21                 TRA     s:1833
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:75   
        21 002071   002115 710000 21                 TRA     s:1833
        21 002072   002142 710000 21                 TRA     s:1840
        21 002073   002131 710000 21                 TRA     s:1836
        21 002074   002131 710000 21                 TRA     s:1836
        21 002075   002110 710000 21                 TRA     s:1831
        21 002076   002110 710000 21                 TRA     s:1831
        21 002077   002142 710000 21                 TRA     s:1840
        21 002100   002110 710000 21                 TRA     s:1831
        21 002101   002142 710000 21                 TRA     s:1840
        21 002102   002142 710000 21                 TRA     s:1840
        21 002103   002142 710000 21                 TRA     s:1840
        21 002104   002142 710000 21                 TRA     s:1840
        21 002105   002142 710000 21                 TRA     s:1840
        21 002106   002131 710000 21                 TRA     s:1836
        21 002107   002136 710000 21                 TRA     s:1838

      424     1830    3       CASE(8,9,11);

      425     1831    3           CALL FINDD_6('SN      ',LAST_DEF_SET_DBK);

   1831 21 002110   000045 630400 22                 EPPR0   37
        21 002111   000004 631400 22                 EPPR1   4
        21 002112   000000 701000 xent               TSX1    FINDD_6
        21 002113   000000 011000                    NOP     0
        21 002114   002142 710000 21                 TRA     s:1840

      426     1832    3       CASE(3,4);

      427     1833    3           CALL FINDD_6('RC      ',RC_DBK); /* RC */

   1833 21 002115   200012 236100                    LDQ     @RC_DBK,,AUTO
        21 002116   000047 235000 22                 LDA     39
        21 002117   200030 757100                    STAQ    @POS+1,,AUTO
        21 002120   200030 630500                    EPPR0   @POS+1,,AUTO
        21 002121   000004 631400 22                 EPPR1   4
        21 002122   000000 701000 xent               TSX1    FINDD_6
        21 002123   000000 011000                    NOP     0
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:76   

      428     1834    3           CALL FINDOS_6('SN-SE   '); /* SN */

   1834 21 002124   000050 630400 22                 EPPR0   40
        21 002125   000001 631400 22                 EPPR1   1
        21 002126   000000 701000 xent               TSX1    FINDOS_6
        21 002127   000000 011000                    NOP     0
        21 002130   002142 710000 21                 TRA     s:1840

      429     1835    3       CASE(6,7,17);

      430     1836    3           CALL FINDD_6('SN      ',LAST_DEF_REC_DBK);

   1836 21 002131   000051 630400 22                 EPPR0   41
        21 002132   000004 631400 22                 EPPR1   4
        21 002133   000000 701000 xent               TSX1    FINDD_6
        21 002134   000000 011000                    NOP     0
        21 002135   002142 710000 21                 TRA     s:1840

      431     1837    3       CASE(18);

      432     1838    3           CALL FINDD_6('SN      ',LAST_DEF_KEY_DBK);

   1838 21 002136   000053 630400 22                 EPPR0   43
        21 002137   000004 631400 22                 EPPR1   4
        21 002140   000000 701000 xent               TSX1    FINDD_6
        21 002141   000000 011000                    NOP     0

      433     1839    3           END; /*CASE*/

      434     1840    2       CALL FCURR_R_6('NR      ');

   1840 21 002142   000044 630400 22                 EPPR0   36
        21 002143   000001 631400 22                 EPPR1   1
        21 002144   000000 701000 xent               TSX1    FCURR_R_6
        21 002145   000000 011000                    NOP     0

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:77   
      435     1841    2       CALL CONNECT_6('SN-NRWU ');

   1841 21 002146   000055 630400 22                 EPPR0   45
        21 002147   000001 631400 22                 EPPR1   1
        21 002150   000000 701000 xent               TSX1    CONNECT_6
        21 002151   000000 011000                    NOP     0

      436     1842    2       CALL FINDD_6('SN      ',LAST_SN_DBK); /* restore SN currency */

   1842 21 002152   200013 630500                    EPPR0   LAST_SN_DBK,,AUTO
        21 002153   200031 450500                    STP0    @POS+2,,AUTO
        21 002154   000005 236000 22                 LDQ     5
        21 002155   200030 756100                    STQ     @POS+1,,AUTO
        21 002156   200030 630500                    EPPR0   @POS+1,,AUTO
        21 002157   000004 631400 22                 EPPR1   4
        21 002160   000000 701000 xent               TSX1    FINDD_6
        21 002161   000000 011000                    NOP     0

      437     1843    2   END; /* ADD_NR */

   1843 21 002162   200020 221300                    LDX1  ! LNO+1,,AUTO
        21 002163   000001 702211                    TSX2  ! 1,X1

POS_WORD
 Sect OctLoc
   1     010   ****** ******   ****** ******   ****** ******   ****** ******    ................

IMPLCT
 Sect OctLoc
   1     020   000000 000001                                                    ....

EXPLCT
 Sect OctLoc
   1     021   000000 000000                                                    ....

RELTYPE
 Sect OctLoc
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:78   
   1     023   000000 000003   000000 000004   000000 000006   000000 000007    ................
   1     027   000000 000010   000000 000011   000000 000013   000000 000021    ................
   1     033   000000 000022   000000 000143                                    .......c

FIELD1
 Sect OctLoc
  18     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA
 Sect OctLoc
  19     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
  19     004   040040 040040   040040 040040   040040 040040   040040 040040
  19     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
  19     014   040040 040040   040040 040040   040040 040040   040040 040040
  19     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
  19     024   040040 040040   040040 040040   040040 040040   040040 040040
  19     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
  19     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
  19     040   040040 040040   040040 040040   040040 040040   040040 040040
  19     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
  19     050   040040 040040   040040 040040   040040 040040   040040 040040
  19     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
  19     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
  19     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
  19     070   040040 040040   040040 040040   040040 040040   040040 040040
  19     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
  19     104   040040 040040   040040 040040   040040 040040   040040 040040
  19     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
  19     130   040040 040040   040040 040040   040040 040040   040040 040040
  19     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
  19     140   040040 040040   040040 040040   040040 040040   040040 040040
  19     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
  19     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     154   040040 040040   040040 040040   040040 040040   040040 040040
  19     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
  19     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
  19     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:79   
  19     174   040040 040040   040040 040040   040040 040040   040040 040040
  19     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  19     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
  19     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
  19     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  19     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  19     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  19     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  19     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
  19     430   040040 040040   040040 040040   040040 040040   040040 040040
  19     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
  19     440   040040 040040   040040 040040   040040 040040   040040 040040
  19     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
  19     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
  19     460   040040 040040   040040 040040   040040 040040   040040 040040
  19     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
  19     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
  19     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
  19     504   040040 040040   040040 040040   040040 040040   040040 040040
  19     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  19     524   040040 040040   040040 040040   040040 040040   040040 040040
  19     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
  19     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
  19     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
  19     614   040040 040040   040040 040040   040040 040040   040040 040040
  19     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
  19     624   040040 040040   040040 040040   040040 040040   040040 040040
  19     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  19     664   040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:80   
  19     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19     700   040040 040040   040040 040040   040040 040040   040040 040040
  19     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19     714   040040 040040   040040 040040   040040 040040   040040 040040
  19     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
  19     724   040040 040040   040040 040040   040040 040040   040040 040040
  19     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19     744   040040 040040   040040 040040   040040 040040   040040 040040
  19     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19    1000   040040 040040   040040 040040   040040 040040   040040 040040
  19    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19    1040   040040 040040   040040 040040   040040 040040   040040 040040
  19    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19    1064   040040 040040   040040 040040   040040 040040   040040 040040
  19    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  19    1120   040040 040040   040040 040040   040040 040040   040040 040040
  19    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  19    1140   040040 040040   040040 040040   040040 040040   040040 040040
  19    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
  19    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
  19    1154   040040 040040   040040 040040   040040 040040   040040 040040
  19    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
  19    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
  19    1170   040040 040040   040040 040040   040040 040040   040040 040040
  19    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  19    1204   040040 040040   040040 040040   040040 040040   040040 040040
  19    1214*  040040 040040   040040 040040   040040 040040   040040 040040

(unnamed)
 Sect OctLoc
  20     000   104101 040040   040040 040040   123116 040040   040040 040040    DA      SN
  20     004   104101 055123   116040 040040   060065 060062   061060 060040    DA-SN   0502100
  20     010   116122 040040   040040 040040   122103 040040   040040 040040    NR      RC
  20     014   123116 055123   105040 040040   123116 055116   122127 125040    SN-SE   SN-NRWU

(unnamed)
 Sect OctLoc
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:81   
  22     000   777777 777777   000001 000000   000000 006000   000037 006000    ................
  22     004   000002 000000   000002 006000   000001 006000   000004 006000    ................
  22     010   000003 000000   000000 000006   000000 000011   000011 006000    ................
  22     014   000012 006000   000004 006000   000000 000005   000016 006000    ................
  22     020   000012 006000   000004 006000   000006 006000   377777 777777    ................
  22     024   000000 000000   000007 006000   000000 006000   000000 006000    ................
  22     030   000000 006000   000000 006000   000000 006000   000000 006000    ................
  22     044*  000010 006000   000002 006000   000000 006000   000012 006000    ................
  22     050   000014 006000   000002 006000   000000 006000   000002 006000    ................
  22     054   000000 006000   000016 006000                                    ........
      438     1844    1   END ADD_SN;

PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:82   
--  Include file information  --

   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DDL_INCL.:ZIC0TOU  is referenced.
   ZIG_TYPE_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ADD_SN.

   Procedure ADD_SN requires 1140 words for executable code.
   Procedure ADD_SN requires 36 words of local(AUTO) storage.

    No errors detected in file ZIG$D_ADDSN.:ZIC0TSI    .
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:83   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:84   
          MINI XREF LISTING

ABORT
        41**DCL-ENT  1638--CALL
ADD_NR
      1817**PROC     1738--CALL     1749--CALL     1796--CALL
ADD_TABLE
      1611**PROC     1764--CALL     1768--CALL     1775--CALL     1781--CALL     1786--CALL
AREA$
        53**DCL      1705<>CALL     1742>>ASSIGN   1768<>CALL     1809<>CALL
CONNECT_6
      1453**DCL-ENT  1841--CALL
COUNT IN PROCEDURE FIND_RIGHT_FIELD
      1645**DCL      1647<<ASSIGN   1656<<ASSIGN   1656>>ASSIGN   1660>>IF       1671<<ASSIGN   1671>>ASSIGN
      1682<<ASSIGN   1682>>ASSIGN
DBK
        46**DCL      1524<<ASSIGN   1525<>CALL     1532<<ASSIGN   1533<>CALL     1559<<ASSIGN   1560<>CALL
      1567<<ASSIGN   1568<>CALL     1594<<ASSIGN   1595<>CALL     1602<<ASSIGN   1603<>CALL
DCLR
        17**DCL        11--PROC     1631>>IF       1724>>IF       1756>>ASSIGN   1778>>IF       1784>>IF
      1791>>IF       1800--ENTRY
DYNMEM$
       392**DCL       397--IMP-PTR
EXIT_DO IN PROCEDURE FIND_RIGHT_FIELD
      1646**DCL      1648<<ASSIGN   1674>>DOWHILE  1680<<ASSIGN
FCURR_R_6
      1445**DCL-ENT  1494--CALL     1528--CALL     1563--CALL     1598--CALL     1840--CALL
FETCHD_6
      1443**DCL-ENT  1533--CALL     1568--CALL     1603--CALL
FETCHNS_6
      1448**DCL-ENT  1754--CALL
FETCHPS_6
      1450**DCL-ENT  1526--CALL     1561--CALL     1596--CALL
FIELD$
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:85   
       360**DCL      1513>>IF       1548>>IF       1651>>DOWHILE  1655>>DOWHILE  1656>>IF       1662>>IF
      1667>>IF       1668>>DOWHILE  1668>>DOWHILE  1673>>IF       1674>>DOWHILE  1674>>DOWHILE  1684>>IF
      1684>>IF       1687>>IF       1692>>IF       1701<>CALL     1740>>ASSIGN   1764<>CALL     1805<>CALL
FINDD_6
      1444**DCL-ENT  1525--CALL     1560--CALL     1595--CALL     1831--CALL     1833--CALL     1836--CALL
      1838--CALL     1842--CALL
FINDOS_6
      1451**DCL-ENT  1834--CALL
FIND_RIGHT_FIELD
      1643**PROC     1515--CALL     1550--CALL
FND
        24**DCL        11--PROC     1511<<ASSIGN   1546<<ASSIGN   1661<<ASSIGN   1663<<ASSIGN   1664<<ASSIGN
      1688<<ASSIGN   1689<<ASSIGN   1694<<ASSIGN   1698<<ASSIGN   1711>>IF       1713>>IF       1716<<ASSIGN
      1717<<ASSIGN   1800--ENTRY    1802<<ASSIGN
HIGH_POS IN PROCEDURE SEARCH_BIN
      1487**DCL      1490<<ASSIGN   1492>>IF       1499>>ASSIGN   1503<<ASSIGN   1538>>IF       1538>>IF
      1540>>IF       1545>>ASSIGN   1573>>IF       1584>>ASSIGN
IMPLCIT
        35**DCL        11--PROC     1800--ENTRY    1824>>ASSIGN
KEY$
        54**DCL      1709<>CALL     1737>>ASSIGN   1772<<ASSIGN   1772>>ASSIGN   1786<>CALL     1813<>CALL
LAST_DEF_KEY_DBK
        44**DCL      1736<<ASSIGN   1792<<ASSIGN   1838<>CALL
LAST_DEF_REC_DBK
       433**DCL      1730<<ASSIGN   1778<<ASSIGN   1836<>CALL
LAST_DEF_SET_DBK
       432**DCL      1733<<ASSIGN   1784<<ASSIGN   1831<>CALL
LAST_RC$
        59**DCL      1635<<ASSIGN   1747<<ASSIGN
LAST_SN_DBK
        40**DCL      1822<<ASSIGN   1842<>CALL
LEN IN PROCEDURE SEARCH_BIN
      1484**DCL      1482--PROC     1490>>ASSIGN
LEN_STRING
        56**DCL        55--IMP-SIZ
LIST$ IN PROCEDURE SEARCH_BIN
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:86   
      1483**DCL      1482--PROC     1500>>ASSIGN   1513>>IF       1524>>ASSIGN   1532>>ASSIGN   1540>>IF
      1540>>IF       1543>>IF       1548>>IF       1559>>ASSIGN   1567>>ASSIGN   1573>>IF       1575>>IF
      1594>>ASSIGN   1602>>ASSIGN
LN
        18**DCL        11--PROC     1725>>ASSIGN   1758>>ASSIGN   1800--ENTRY    1826>>ASSIGN
LN_DIFF
        45**DCL      1819<<ASSIGN   1821<<ASSIGN   1826>>ASSIGN
LOW_POS IN PROCEDURE SEARCH_BIN
      1488**DCL      1491<<ASSIGN   1499>>ASSIGN   1508<<ASSIGN   1538>>IF       1538>>IF       1538>>IF
      1540>>IF       1543>>IF       1544>>ASSIGN   1575>>IF       1577>>ASSIGN   1580>>ASSIGN
MODIFY_6
      1446**DCL-ENT  1727--CALL
MOVE_LEN
        65**DCL      1626<<ASSIGN   1627<>CALL
NO_NO IN PROCEDURE ADD_TABLE
      1638**LABEL    1617--CALLALT  1620--CALLALT
NUMB_AREA_SN
        51**DCL      1705<>CALL     1768>>CALL     1769<<ASSIGN   1769>>ASSIGN   1809<>CALL
NUMB_FIELD_SN
       357**DCL      1655>>DOWHILE  1677>>IF       1701<>CALL     1764<>CALL     1765<<ASSIGN   1765>>ASSIGN
      1805<>CALL
NUMB_IN_TABLE IN PROCEDURE ADD_TABLE
      1614**DCL      1611--PROC     1622>>IF       1626>>ASSIGN
NUMB_KEY_SN
        52**DCL      1709<>CALL     1768>>CALL     1786>>CALL     1787<<ASSIGN   1787>>ASSIGN   1813<>CALL
NUMB_RECORD_SN
       356**DCL      1703<>CALL     1768>>CALL     1775>>CALL     1776<<ASSIGN   1776>>ASSIGN   1786>>CALL
      1807<>CALL
NUMB_SET_SN
       358**DCL      1707<>CALL     1768>>CALL     1775>>CALL     1781<>CALL     1782<<ASSIGN   1782>>ASSIGN
      1786>>CALL     1811<>CALL
POS IN PROCEDURE ADD_TABLE
      1612**DCL      1611--PROC     1624>>ASSIGN   1626>>ASSIGN   1629>>ASSIGN   1630>>ASSIGN   1632>>ASSIGN
      1633>>ASSIGN   1634>>ASSIGN   1635>>ASSIGN
POS IN PROCEDURE FIND_RIGHT_FIELD
      1644**DCL      1643--PROC     1651>>DOWHILE  1651>>DOWHILE  1652<<ASSIGN   1652>>ASSIGN   1654<<ASSIGN
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:87   
      1654>>ASSIGN   1655>>DOWHILE  1655>>DOWHILE  1656>>IF       1657<<ASSIGN   1657>>ASSIGN   1659<<ASSIGN
      1659>>ASSIGN   1662>>IF       1667>>IF       1668>>DOWHILE  1668>>DOWHILE  1668>>DOWHILE  1670<<ASSIGN
      1670>>ASSIGN   1673>>IF       1673<<ASSIGN   1673>>ASSIGN   1674>>DOWHILE  1674>>DOWHILE  1676<<ASSIGN
      1676>>ASSIGN   1677>>IF       1679<<ASSIGN   1679>>ASSIGN   1684>>IF       1684>>IF       1687>>IF
      1692>>IF       1693<<ASSIGN   1693>>ASSIGN
POS IN PROCEDURE SEARCH_BIN
      1489**DCL      1499<<ASSIGN   1500>>ASSIGN   1503>>ASSIGN   1508>>ASSIGN   1512>>ASSIGN   1515<>CALL
      1516>>ASSIGN   1544<<ASSIGN   1545<<ASSIGN   1547>>ASSIGN   1550<>CALL     1551>>ASSIGN
POS_WORD
        67**DCL      1500<<ASSIGN   1501>>IF       1506>>IF
PTR$ IN PROCEDURE ADD_TABLE
      1613**DCL      1611--PROC     1624>>ASSIGN   1629>>ASSIGN   1630>>ASSIGN   1632>>ASSIGN   1633>>ASSIGN
      1634>>ASSIGN   1635>>ASSIGN
PTR1$
        63**DCL      1617<>CALL     1620<>CALL     1624<<ASSIGN   1625>>ASSIGN   1627>>CALL
PTR2$
        64**DCL      1625<<ASSIGN   1627>>CALL
RC_DBK
        25**DCL        11--PROC     1630>>ASSIGN   1649>>IF       1667>>IF       1668>>DOWHILE  1674>>DOWHILE
      1684>>IF       1800--ENTRY    1833<>CALL
RECORD$
       359**DCL      1703<>CALL     1731>>ASSIGN   1747>>ASSIGN   1773<<ASSIGN   1773>>ASSIGN   1775<>CALL
      1789<<ASSIGN   1789>>ASSIGN   1807<>CALL
RELTYPE.FLD_IN_KEY
       421**DCL      1820>>IF
RELTYPE.KEY_IN_REC
       420**DCL      1820>>IF
RELTYPE.NO_NR
       422**DCL      1748>>IF       1795>>IF
RLTYPE
        34**DCL        11--PROC     1748>>IF       1795>>IF       1800--ENTRY    1820>>IF       1820>>IF
      1825>>ASSIGN   1829>>DOCASE
SEARCH_BIN
      1482**PROC     1701--CALL     1703--CALL     1705--CALL     1707--CALL     1709--CALL     1805--CALL
      1807--CALL     1809--CALL     1811--CALL     1813--CALL
SET$
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:88   
       361**DCL      1707<>CALL     1734>>ASSIGN   1771<<ASSIGN   1771>>ASSIGN   1779<<ASSIGN   1779>>ASSIGN
      1781<>CALL     1790<<ASSIGN   1790>>ASSIGN   1811<>CALL
STRE_6
      1440**DCL-ENT  1760--CALL     1827--CALL
TABLES
       362**DCL      1627<>CALL     1627<>CALL     1747--ASSIGN
TABLES.DBK
       364**DCL      1524>>ASSIGN   1532>>ASSIGN   1559>>ASSIGN   1567>>ASSIGN   1594>>ASSIGN   1602>>ASSIGN
      1634<<ASSIGN
TABLES.DBK_RC
       367**DCL      1630<<ASSIGN   1656>>IF       1662>>IF       1667>>IF       1668>>DOWHILE  1674>>DOWHILE
      1684>>IF
TABLES.DEFINED
       365**DCL      1632<<ASSIGN   1633<<ASSIGN   1687>>IF       1731<<ASSIGN   1734<<ASSIGN   1737<<ASSIGN
      1740<<ASSIGN   1742<<ASSIGN
TABLES.NAME
       363**DCL      1500>>ASSIGN   1540>>IF       1540>>IF       1543>>IF       1573>>IF       1575>>IF
      1624--ASSIGN   1629<<ASSIGN   1651>>DOWHILE  1655>>DOWHILE  1668>>DOWHILE  1673>>IF       1674>>DOWHILE
      1684>>IF       1692>>IF
TABLE_POS
        66**DCL      1701<>CALL     1703<>CALL     1705<>CALL     1707<>CALL     1709<>CALL     1731>>ASSIGN
      1734>>ASSIGN   1737>>ASSIGN   1740>>ASSIGN   1742>>ASSIGN   1747>>ASSIGN   1764>>CALL     1766>>IF
      1768>>CALL     1770>>IF       1775>>CALL     1777>>IF       1781>>CALL     1783>>IF       1786>>CALL
      1788>>IF       1805<>CALL     1807<>CALL     1809<>CALL     1811<>CALL     1813<>CALL
TABLE_POS IN PROCEDURE SEARCH_BIN
      1486**DCL      1482--PROC     1495<<ASSIGN   1512<<ASSIGN   1516<<ASSIGN   1522>>IF       1532>>ASSIGN
      1547<<ASSIGN   1551<<ASSIGN   1557>>IF       1567>>ASSIGN   1577<<ASSIGN   1580<<ASSIGN   1584<<ASSIGN
      1592>>IF       1602>>ASSIGN
TYPE
        19**DCL        11--PROC     1615>>IF       1635>>IF       1699>>DOCASE   1725>>IF       1728>>DOCASE
      1746>>IF       1757>>ASSIGN   1762>>DOCASE   1800--ENTRY    1803>>DOCASE
UWA.AC.CALC_NEXT
      1209**DCL      1210--REDEF
UWA.AC.CALC_PRIOR
      1218**DCL      1219--REDEF
UWA.AC.DEFAULTS
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:89   
      1170**DCL      1171--REDEF
UWA.AC.FILE_CODE
      1175**DCL      1176--REDEF
UWA.AC.FLAG1.ERROR_TYPE
      1172**DCL      1173--REDEF
UWA.DA.FRST_AC
      1317**DCL      1770<<ASSIGN
UWA.DA.FRST_FR
      1321**DCL      1766<<ASSIGN
UWA.DA.FRST_KC
      1320**DCL      1788<<ASSIGN
UWA.DA.FRST_RC
      1318**DCL      1777<<ASSIGN
UWA.DA.FRST_SC
      1319**DCL      1783<<ASSIGN
UWA.DA.NUMB_NR
      1311**DCL      1828<<ASSIGN   1828>>ASSIGN
UWA.DA.NUMB_SN
      1310**DCL      1761<<ASSIGN   1761>>ASSIGN
UWA.DB_STATUS
      1101**DCL      1527>>IF       1562>>IF       1597>>IF
UWA.DIRECT_REF
      1110**DCL      1634>>ASSIGN   1730>>ASSIGN   1733>>ASSIGN   1736>>ASSIGN   1753>>IF       1766>>ASSIGN
      1770>>ASSIGN   1777>>ASSIGN   1778>>ASSIGN   1783>>ASSIGN   1784>>ASSIGN   1788>>ASSIGN   1792>>ASSIGN
      1822>>ASSIGN
UWA.NR
      1335**DCL      1823<<ASSIGN
UWA.NR.IMPLCT
      1337**DCL      1824<<ASSIGN
UWA.NR.LNO
      1339**DCL      1826<<ASSIGN
UWA.NR.RELTYPE
      1338**DCL      1825<<ASSIGN
UWA.SF.DBKEY_DA
      1120**DCL      1753>>IF
UWA.SN
PL6.E3A0      #001=ADD_SN File=ZIG$D_ADDSN.:ZIC0TSI                              FRI 09/05/97 11:56 Page:90   
      1322**DCL      1755<<ASSIGN
UWA.SN.DCLR
      1323**DCL      1715>>IF       1726<<ASSIGN   1756<<ASSIGN
UWA.SN.LNO
      1326**DCL      1725<<ASSIGN   1758<<ASSIGN
UWA.SN.SENAME
      1328**DCL      1759<<ASSIGN
UWA.SN.SETYPE
      1325**DCL      1757<<ASSIGN
WORD1
        16**DCL        11--PROC     1629>>ASSIGN   1651>>DOWHILE  1655>>DOWHILE  1668>>DOWHILE  1673>>IF
      1674>>DOWHILE  1684>>IF       1692>>IF       1701<>CALL     1703<>CALL     1705<>CALL     1707<>CALL
      1709<>CALL     1759>>ASSIGN   1800--ENTRY    1805<>CALL     1807<>CALL     1809<>CALL     1811<>CALL
      1813<>CALL
WORD1 IN PROCEDURE SEARCH_BIN
      1485**DCL      1482--PROC     1501>>IF       1506>>IF       1540>>IF       1540>>IF       1543>>IF
      1573>>IF       1575>>IF
ZIG$ALLOCATE
        57**DCL-ENT  1617--CALL     1620--CALL
ZIG$MRL
        62**DCL-ENT  1627--CALL
