VERSION A06

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:1    
        1        1        /*M*  Z8FF$FLOW_ANALYSIS                                                  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8               NAME:  Z8FF$FLOW_ANALYSIS
        9        9             AUTHOR:  Greg Myers
       10       10            PURPOSE:  This procedure does all the preparatory flow analysis for
       11       11                      PHASE 3.  This includes:  Dead code elimination,
       12       12                      PERFORM handling, transforming IF-loops
       13       13                      to DO-loops, and optimizing ALTERed GO TOs.
       14       14        */
       15       15
       16       16        /*D*
       17       17               NAME:  Z8FF$FLOW_ANALYSIS
       18       18               CALL:  CALL Z8FF$FLOW_ANALYSIS ;
       19       19          INTERFACE:  Z8FS$SRCH_IF_DO_LBL -- Resets the links affected by the PFORM.
       20       20                      Z8FP$PFORM_CHECKING -- Creates COBOL 74 or optimized PFORMs.
       21       21                      Z8AC$MAKE_CONST -- Creates CONST ST item.
       22       22                      Z8AE$ERROR -- Called to output error messages.
       23       23                      Z8AF$NEW_BASE -- Called to set up BASE item for anything that
       24       24                                       needs one.
       25       25                      Z8AT$CREATE_TEMPORARY -- Creates temporary labels and scalars.
       26       26
       27       27              INPUT:  The ILS, ILL, ETT, and ST are accessed.
       28       28             OUTPUT:  VARIABLE.SEQ#.FD            Forward definition point
       29       29                      ILS.SEQNO         Sequence number
       30       30                      ILS.NEXT          Pointer to next item in ILS
       31       31                      COMCOM.FIRST_ILS  Pointer to top of ILS (Last entry of ILS)
       32       32                      COMCOM.H_LBL      Pointer to top of label chain (Last label)
       33       33            SCRATCH:  ILL$                   ILL Pointer
       34       34                      ILS$                   ILS Pointer
       35       35                      ST$                    ST Pointer
       36       36                      COMCOM.CURRENT.LINE    For error messages
       37       37                      COMCOM.CURRENT.COLUMN  For error messages
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:2    
       38       38
       39       39        DESCRIPTION:  This procedure uses a loop to go thru the ILS
       40       40                      table skipping the ILS entries that point to LINOI items.
       41       41                      Inside the loop there are two case statements.  Different
       42       42                      optimizations are then performed on the ILL items.  A loop is
       43       43                      also performed on the ILS table to create sequence numbers
       44       44                      and redefinitions.  When phase 2 is done the ILS is linked
       45       45                      in reverse order for phase 3.
       46       46        */
       47       47        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:3    
       48       48        Z8FF$FLOW_ANALYSIS: PROC NOAUTO ;
       49       49        /*N*
       50       50            CHANGES -- Remember on the GOTO item there are two changes.
       51       51                       As of now I assume there is a LINOI item for every ILL
       52       52                       statement and that I could reach the end of the
       53       53                       program.  In reality there will be a STOP item, and
       54       54                       maybe no LINOI entry between ILL entries.
       55       55        */
       56       56        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:4    
       57       57        %EQU PHASE = 2 ;
       58       58        %EQU #_STATEMENTS = 4 ; /* Number of statements including LINOI's to determine if pe
                58        rform should be copied */
       59       59        %INCLUDE Z8A_DEFC ;
       60      127        %INCLUDE Z8A_SUPP_MAC ;
       61     2527        %INCLUDE Z9A_SUPP_MAC;
       62     2816        %INCLUDE Z9A_FLAGS;
       63     2830        %INCLUDE Z8A_COMCOM ;
       64     3480        %INCLUDE Z8A_DNT ;
       65     3701        %INCLUDE Z8A_ILS ;
       66     3810        %INCLUDE Z8A_DPI ;
       67     3894        %INCLUDE Z8A_ILL ;
       68     4587        %INCLUDE Z8A_ETT ;
       69     4888        %INCLUDE Z8A_LTS ;
       70     6965        %INCLUDE Z8A_MKCN ;
       71     6982        %INCLUDE Z8A_ST ;
       72    10641        %INCLUDE Z8A_ERR_NUMS ;
       73    11405        %INCLUDE Z8A_TYPES ;
       74    11579        %INCLUDE Z8E_NEW_ILL ;
       75    11593        %INCLUDE Z8E_STACKS ;
       76    13859        %INCLUDE Z8E_STATEMNT ;
       77    13928        %INCLUDE Z8F_O2COM ;
       78    14038
       79    14039    1   DCL   PREV_ILS$            PTR AUTO ; /* Ptr to previous ILS entry        */
       80    14040    1   DCL   NEXT_ILS$            PTR AUTO ; /* Ptr to next item in ILS          */
       81    14041    1   DCL   PERF_LABEL_CHECK     PTR AUTO ; /* Ptr to ILS entry for perform check */
       82    14042    1   DCL   PERF_STATEMENT_CHECK PTR AUTO ; /*Ptr to ILS entry for perform check */
       83    14043    1   DCL   START_LABEL$         PTR ; /* Ptr to start label of PERFORM */
       84    14044    1   DCL   START_LABEL_ILS$     PTR ; /* Ptr to starting label's ILS entry */
       85    14045    1   DCL   END_LABEL$           PTR ; /* Ptr to end label of PERFORM */
       86    14046    1   DCL   END_LABEL_ILS$       PTR ; /* Ptr to ending label's ILS entry */
       87    14047    1   DCL   NEXT_LABEL$          PTR ; /* Ptr to next label after end label of PFORM */
       88    14048    1   DCL   NULL_PFORM_CHECK$    PTR ; /* To check for null PERFORM */
       89    14049
       90    14050    1   DCL   DOEND_ILS$           PTR AUTO ; /* Ptr to DOEND entry in ILS                */
       91    14051    1   DCL   GOTO_DEST$           PTR AUTO ; /* Ptr to destination of backward GOTO */
       92    14052    1   DCL   GO_ILS$              PTR AUTO ; /* Ptr to GO entry in ILS                   */
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:5    
       93    14053    1   DCL   INITIAL_ILS$         PTR AUTO ;
             14053            /* Ptr to ILS entry for copying stmts within perform */
       94    14054    1   DCL   SEARCH_DO$           PTR AUTO ; /* Ptr used to search DOs in DO loop */
       95    14055    1   DCL   COPY_ILS$            PTR AUTO ;
             14055            /* Ptr to ILS entry for copying stmts within perform */
       96    14056    1   DCL   NEXT_COPY$           PTR AUTO ;
             14056            /* Ptr to ILS entry for copying stmts within perform */
       97    14057    1   DCL   DO_ILS$              PTR AUTO ; /* Ptr to DO entry in ILS */
       98    14058    1   DCL   DO_LINOI$            PTR ; /* PTR to ILS for LINOI before DOn */
       99    14059    1   DCL   FATHER_DO            PTR AUTO ; /* Ptr to father loop of DO loop if any */
      100    14060    1   DCL   REF_DEFLB            PTR AUTO ; /* Ptr to last refd label  */
      101    14061
      102    14062    1   DCL   GO_LABEL_LINOI$      PTR AUTO ; /* Ptr to target labels LINOI entry */
      103    14063    1   DCL   GO_LABEL_ILS$        PTR AUTO ; /* Ptr to target labels ILS entry */
      104    14064    1   DCL   LABEL_CHECK$         PTR AUTO ;
             14064            /* Ptr to labels as a check is made for references */
      105    14065    1   DCL   CREATED_LABEL$       REDEF LABEL_CHECK$ PTR ;
             14065            /* Ptr to created label for IF */
      106    14066    1   DCL   VAL_END$             PTR ;
      107    14067    1   DCL   DPI$$                PTR AUTO ; /* Used in MULTI_REDEF */
      108    14068    1   DCL   EXIT_PROG$           PTR AUTO ; /* If EXIT PROGRAM in USE proc */
      109    14069    1   DCL   EXIT_PROG_FOUND      BOOLEAN ;
      110    14070    1   DCL   CONST$               PTR ; /* For constant operand */
      111    14071    1   DCL   OPERAND$             PTR ; /* For variable operand */
      112    14072    1   DCL   OPERAND_TYPE         UBIN ;
      113    14073    1   DCL   TEMP_UBIN            UBIN ;
      114    14074    1   DCL   TEMP_SBIN            SBIN ;
      115    14075    1   DCL   TEMP_STR             CHAR (12) ;
      116    14076    1   DCL   OPTIMIZE_DO3         BOOLEAN ;
      117    14077    1   DCL   ILL_ID               UBIN ;
      118    14078    1   DCL   STATEMENT_COUNT      SBIN WORD AUTO ; /* Statement count */
      119    14079    1   DCL   GO_FLAG              SBIN ; /* For GO statement optimizations */
      120    14080    1   DCL   DO_LEVEL             SBIN WORD AUTO ; /* Nesting level of DO loop */
      121    14081    1   DCL   CURRENT_SEQ_NO       SBIN WORD AUTO ; /* Sequence counter */
      122    14082    1   DCL   FALL_THRU_FLAG       SBIN ;
      123    14083    1   DCL   CURRENT_SEG#         SBIN WORD ;  /* Segment number */
      124    14084    1   DCL   DEFLB_FOLLOWS        BOOLEAN ; /* DEFLB after PFORM */
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:6    
      125    14085    1   DCL   LABEL_AFTER_PFORM$   PTR ; /* DEFLB.LOP (ST pointer) */
      126    14086    1   DCL   DEFLB_AFTER_ENTRY    BOOLEAN ;
             14086            /* Used to set REFERENCED in first DEFLB after an ENTRY */
      127    14087    1   DCL   ILS$$                PTR AUTO ; /* Created STOP or EXIT */
      128    14088    1   DCL   ILL$$                PTR AUTO ;
      129    14089    1   DCL   CDEF_FLAG            BOOLEAN ;
      130    14090        %DCL_AUTO_LX_ITEM (@NAME = TEMP_ILS_LIST) ;
      131    14094    1   DCL   GOTO_VECTOR          BOOLEAN ; /* Processing a GO TO vector */
      132    14095    1   DCL   VECTOR_END$          PTR ; /* PTR to LABEL at end of GO TO vector */
      133    14096    1   DCL   DEAD_CODE_CHECK      SBIN ; /* Used in looking for unreachable code */
      134    14097    1   DCL   SEARCH_ILS$          PTR ; /* Likewise */
      135    14098    1   DCL   ENTADDR_OF_NIL$      PTR ; /* PTR to CONSTANT item for null PTR */
      136    14099    1   DCL   ENTADDR_ENIL$        EPTR CONSTANT INIT (ENTADDR (NIL)) ;
      137    14100    1   DCL   ENTADDR_OF_NIL_UBIN  REDEF ENTADDR_ENIL$ UBIN ;
      138    14101    1   DCL   LINOI_FLAG1          BOOLEAN ; /* Found any LINOI */
      139    14102    1   DCL   LINOI_FLAG           BOOLEAN ; /* Found LINOI with statement type */
      140    14103    1   DCL   USE_FLAG             BOOLEAN ; /* Dead code detection in USE procedure */
      141    14104    1   DCL   AFTER_USE            BOOLEAN ;
             14104            /* To find the first label after USE procedure */
      142    14105    1   DCL   LABEL_AFTER_USE      PTR ;
      143    14106    1   DCL   DOEND_FLAG           SBIN ;
             14106            /* DOEND from GO optimization to be skipped in dead code check */
      144    14107    1   DCL   ENTRY_TYPE           UBIN ;
             14107            /* To distinguish between main prog and subroutine */
      145    14108    1   DCL   TEMP$                PTR ;
      146    14109    1   DCL   CURRENT_PROC$        PTR ; /* PTR to current Proc_ ST item */
      147    14110    1   DCL   Z8AT$CREATE_TEMPORARY ENTRY(2) ;
      148    14111    1   DCL   Z8AN$NEW_ILL2        ENTRY (6) ;
      149    14112    1   DCL   Z8AF$NEW_BASE        ENTRY (3) ; /* LOP, ROP, RETURN */
      150    14113    1   DCL   Z8AE$ERROR           ENTRY (12) ;
      151    14114    1   DCL   Z8AC$MAKE_CONST      ENTRY (1) ;
      152    14115    1   DCL   Z8AH$SEARCH_         ENTRY ;
      153    14116    1   DCL   Z9EC$ALIGN           ENTRY (2) ;
      154    14117    1   DCL   Z8FP$PFORM_CHECKING  ENTRY ;
      155    14118    1   DCL   Z8FS$SRCH_IF_DO_LBL  ENTRY (2) ;
      156    14119
      157    14120        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:7    
      158    14121        /*E*
      159    14122              ERROR:  E$NULL_PFORM_WARNING
      160    14123            MESSAGE:  There is no executable code in the code group to be performed.
      161    14124        DESCRIPTION:  This warning is flagged when the perform code group consists
      162    14125                      of only a start label and end label with no code inbetween.
      163    14126                      The PFORM is then deleted from the program.
      164    14127        */
      165    14128
      166    14129        %MACRO NULL_PFORM_WARNING ;
      167    14130               DO ;
      168    14131                 IF ILL$->ILL.CODE ~= %PFORM_USE_PROC THEN
      169    14132                   CALL Z8AE$ERROR(%E$NULL_PFORM_WARNING) ;
      170    14133                 PREV_ILS$->ILS.NEXT = NEXT_ILS$ ;
      171    14134                 ILS$ = NEXT_ILS$ ;
      172    14135                 IF DEFLB_FOLLOWS THEN
      173    14136                   LABEL_AFTER_PFORM$->LABEL.PREV_ILS$ = PREV_ILS$ ;
      174    14137               END ;
      175    14138        %MEND ;
      176    14139        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:8    
      177    14140        /*V*
      178    14141            FIND_LAST_LINOI -- In dead code detection occasionally there is no LINOI
      179    14142                               between the STOP or GO and the next executable ILL
      180    14143                               item. In this case it is necessary to trace back thru
      181    14144                               the ILL to find the last LINOI.
      182    14145        */
      183    14146
      184    14147        %MACRO FIND_LAST_LINOI ;
      185    14148               DO ;
      186    14149                 TEMP$ = PREV_ILS$ ;
      187    14150                 DO WHILE TEMP$->ILS.ILL$->ILL.ID ~= %LINOI ;
      188    14151                   %NEXT_ILS (POINTER=TEMP$) ;
      189    14152                 END ;
      190    14153                 COMCOM.CURRENT.LINE = TEMP$->ILS.ILL$->LINOI.LINE_NO ;
      191    14154                 COMCOM.CURRENT.COLUMN = TEMP$->ILS.ILL$->LINOI.COLUMN_NO ;
      192    14155               END ;
      193    14156        %MEND ;
      194    14157        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:9    
      195    14158        /*V*
      196    14159            FIND_ITEM -- This macro searches thru the ILS until it finds the
      197    14160                         requested item or the end of the program.
      198    14161                         It also updates COMCOM.CURRENT as appropriate.
      199    14162        */
      200    14163        /*N* May need to consider POINTER->ILS.ILL$ = ADDR (NIL) as a possibility.
      201    14164             If it ever happens then before the %NEXT_ILS call insert:
      202    14165             DO UNTIL POINTER->ILS.ILL$ ~= ADDR (NIL) ;       */
      203    14166
      204    14167        %MACRO FIND_ITEM(ITEM=%GO, POINTER=NEXT_ILS$) ;
      205    14168               DO ;
      206    14169                 DO WHILE POINTER->ILS.ILL$->ILL.ID ~= %END AND
      207    14170                          POINTER->ILS.ILL$->ILL.ID ~= ITEM ;
      208    14171                   IF POINTER->ILS.ILL$->ILL.ID = %LINOI THEN
      209    14172                     IF POINTER->ILS.ILL$->LINOI.TYPE ~= %NO_STATEMENT_TYPE THEN DO ;
      210    14173                       COMCOM.CURRENT.LINE = POINTER->ILS.ILL$->LINOI.LINE_NO ;
      211    14174                       COMCOM.CURRENT.COLUMN = POINTER->ILS.ILL$->LINOI.COLUMN_NO ;
      212    14175                     END ;
      213    14176
      214    14177                   %NEXT_ILS (POINTER=POINTER) ;
      215    14178                 END ;
      216    14179               END ;
      217    14180        %MEND ;
      218    14181        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:10   
      219    14182        /*V*
      220    14183            ASSIGN_LABEL_INFO -- The basic label information is assigned here.
      221    14184                                 This includes
      222    14185
      223    14186                                   1.  If the label is referenced then the pointer
      224    14187                                       REF_DEFLB is updated to point to the last
      225    14188                                       referenced label.
      226    14189
      227    14190                                   2.  The pointer to last label encountered
      228    14191                                       O2COM.LAST_LBL$ is updated.
      229    14192
      230    14193                                   3.  Set FALL_THRU_FLAG since control can fall
      231    14194                                       thru after a label.
      232    14195        */
      233    14196
      234    14197        %MACRO ASSIGN_LABEL_INFO (@ILS$ = ILS$, @ILL$ = ILL$) ;
      235    14198         DO ;
      236    14199           IF DEFLB_AFTER_ENTRY THEN
      237    14200             @ILL$->ILL.LOP->LABEL.B.REFERENCED = TRUE ;
      238    14201
      239    14202           IF @ILL$->ILL.LOP->LABEL.B.REFERENCED THEN
      240    14203             DO ;
      241    14204               REF_DEFLB = @ILS$ ;
      242    14205               FALL_THRU_FLAG = 1 ; /* After a referenced label, fall thru is possible. */
      243    14206             END ;
      244    14207
      245    14208           IF @ILL$ -> ILL.LOP -> LABEL.ID = %SECTION THEN
      246    14209             DO ;
      247    14210               O2COM.SECTION$ = @ILL$ -> ILL.LOP ;
      248    14211               IF @ILL$ -> ILL.LOP -> SECTION.SEGMENT$ ~= ADDR(NIL) THEN
      249    14212        O2COM.SEGMENT_NO = @ILL$ -> ILL.LOP -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO# ;
      250    14213             END ;
      251    14214
      252    14215           O2COM.LAST_LBL$ = @ILS$ ;
      253    14216           DEFLB_AFTER_ENTRY = FALSE ;
      254    14217         END ;
      255    14218        %MEND ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:11   
      256    14219        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:12   
      257    14220        /*V*
      258    14221            ASSIGN_DO_ITEM_INFO -- The information needed for the DO item is assigned.
      259    14222                                   This includes
      260    14223
      261    14224                                     1.  The pointer to the previous DO or DOend
      262    14225                                         item (DO_N.ITP) and updating the pointer to
      263    14226                                         the last one (COMCOM.H_DO).
      264    14227
      265    14228                                     2.  Assigning the pointer to the last referenced
      266    14229                                         label (DO_N.XLAB).
      267    14230
      268    14231                                     3.  Updating nesting level information which
      269    14232                                         involves assigning DO_N.ITO (pointer to father
      270    14233                                         Do entry) and DO_N.LEVEL (nesting level).
      271    14234                                         The variables used for this are updated.
      272    14235        */
      273    14236
      274    14237        %MACRO ASSIGN_DO_ITEM_INFO (@ILS$ = ILS$, @ILL$ = ILL$) ;
      275    14238         DO ;
      276    14239           DO_LINOI$ = PREV_ILS$ ;
      277    14240           %NEXT_ILS (POINTER=DO_LINOI$) ;
      278    14241           @ILL$->DO_N.ITP = COMCOM.H_DO ;
      279    14242           COMCOM.H_DO = @ILS$ ;
      280    14243           @ILL$->DO_N.XLAB = REF_DEFLB ;
      281    14244           @ILL$->DO_N.ITO = FATHER_DO ;
      282    14245           FATHER_DO = @ILS$ ;
      283    14246           @ILL$->DO_N.LEVEL = DO_LEVEL ;
      284    14247           DO_LEVEL = DO_LEVEL + 1 ;
      285    14248           FALL_THRU_FLAG = 1 ; /* Fall thru possible after a DOn */
      286    14249         END ;
      287    14250        %MEND ;
      288    14251        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:13   
      289    14252        /*V*
      290    14253            ASSIGN_DOEND_INFO -- The information for the DOEND item is assigned
      291    14254                                 which includes
      292    14255
      293    14256                                   1.  The pointer to the previous DO or DOEND item
      294    14257                                       is assigned and updated.
      295    14258
      296    14259                                   2.  The nesting level variables are updated.
      297    14260        */
      298    14261
      299    14262        %MACRO ASSIGN_DOEND_INFO(@ILS$ = ILS$, @ILL$ = ILL$) ;
      300    14263         DO ;
      301    14264           @ILL$->DO_N.ITP = COMCOM.H_DO ;
      302    14265           COMCOM.H_DO = @ILS$ ;
      303    14266           DO_LEVEL = DO_LEVEL - 1 ;
      304    14267           FATHER_DO = FATHER_DO->ILS.ILL$->DO_N.ITO ;
      305    14268           FALL_THRU_FLAG = 1 ; /* Fall thru possible after a DOEND */
      306    14269         END ;
      307    14270        %MEND ;
      308    14271        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:14   
      309    14272        /*V*
      310    14273            COPY_ILS_ENTRY -- This macro is used in the copying of a perform code
      311    14274                              group in line.  A ILS entry is created and the
      312    14275                              information is copied in.  The pointers are then updated.
      313    14276        */
      314    14277
      315    14278        %MACRO COPY_ILS_ENTRY ;
      316    14279         DO ;
      317    14280           %RESERVE_ILS (ITEM    = INITIAL_ILS$->ILS.ID ,
      318    14281                         POINTER = NEXT_COPY$, VARIABLE = '1'B) ;
      319    14282
      320    14283           IF INITIAL_ILS$->ILS.ID = %OPN THEN
      321    14284             NEXT_COPY$->OPN = INITIAL_ILS$->OPN ;
      322    14285           ELSE
      323    14286             NEXT_COPY$->ILS = INITIAL_ILS$->ILS ;
      324    14287
      325    14288           COPY_ILS$->ILS.NEXT = NEXT_COPY$ ;
      326    14289           %NEXT_ILS (POINTER=INITIAL_ILS$) ;
      327    14290           COPY_ILS$ = NEXT_COPY$ ;
      328    14291         END ;
      329    14292        %MEND ;
      330    14293        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:15   
      331    14294    1   INSERT_STOP_OR_EXIT: PROC ;
      332    14295
      333    14296        /*I*
      334    14297               NAME: INSERT_STOP_OR_EXIT
      335    14298               CALL: CALL INSERT_STOP_OR_EXIT ;
      336    14299
      337    14300              INPUT: ILS$ - Pointer to ILS item at which the STOP or EXIT_PROG
      338    14301                            is to be inserted.
      339    14302                     ENTRY_TYPE - Code to determine which is needed, STOP or
      340    14303                                   EXIT_PROG.
      341    14304                     PREV_ILS$ - Pointer to an ILS item before where ILS$ points.
      342    14305             OUTPUT: A STOP or EXIT_PROG is inserted.
      343    14306
      344    14307        DESCRIPTION: A STOP or EXIT_PROG is inserted before the current ILL item.
      345    14308        */
      346    14309
      347    14310    3          DO WHILE PREV_ILS$->ILS.NEXT ~= ILS$ ;
      348    14311                 %NEXT_ILS (POINTER=PREV_ILS$) ;
      349    14316    3          END ;
      350    14317    2          IF CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.EXIT_PROG_IN_DECL
      351    14318                      %IF CP6;
      352    14319    2                 AND ENTRY_TYPE = %SUBROUTINE
      353    14320                      %ENDIF;
      354    14321    2                 THEN
      355    14322    3            IF EXIT_PROG$ ~= ADDR(NIL) AND NOT EXIT_PROG_FOUND THEN DO;
      356    14323                   /* EXIT PROGRAM in any USE procedure can only terminate all
      357    14324                      active USE procedures, and then UNWIND to an EXIT PROGRAM
      358    14325                      statement in the program, but there is none, so, create
      359    14326                      one, along with a label to which to UNWIND. */
      360    14327    3              TEMP$ = PREV_ILS$;
      361    14328                   %RESERVE_ILS (ITEM=%OPN, POINTER=PREV_ILS$->ILS.NEXT);
      362    14357                   %NEXT_ILS (POINTER=PREV_ILS$);
      363    14362                   %RESERVE_ILL (ITEM=%LINOI, POINTER=PREV_ILS$->ILS.ILL$);
      364    14372    3              PREV_ILS$->ILS.ILL$->LINOI.PREV_COL = COMCOM.CURRENT.COLUMN;
      365    14373    3              PREV_ILS$->ILS.ILL$->LINOI.COLUMN_NO = COMCOM.CURRENT.COLUMN;
      366    14374    3              PREV_ILS$->ILS.ILL$->LINOI.PREV_LINE = COMCOM.CURRENT.LINE;
      367    14375    3              PREV_ILS$->ILS.ILL$->LINOI.LINE_NO = COMCOM.CURRENT.LINE;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:16   
      368    14376                   %RESERVE_ILS (ITEM=%OPN, POINTER=PREV_ILS$->ILS.NEXT);
      369    14405                   %NEXT_ILS (POINTER=PREV_ILS$);
      370    14410                   %RESERVE_ILL (ITEM=%DEFLB, POINTER=PREV_ILS$->ILS.ILL$);
      371    14420    3              PREV_ILS$->ILS.ILL$->ILL.LOP = EXIT_PROG$;
      372    14421    3              EXIT_PROG$->LABEL.PREV_ILS$ = TEMP$;
      373    14422    3              IF FALL_THRU_FLAG ~= 0 THEN
      374    14423    3                EXIT_PROG$->LABEL.B.FALL_THRU = TRUE;
      375    14424    3              EXIT_PROG$->LABEL.B.PHASE_2 = TRUE;
      376    14425    3              EXIT_PROG_FOUND = TRUE;
      377    14426    3              FALL_THRU_FLAG = 1;
      378    14427    3            END;
      379    14428               %RESERVE_ILS (ITEM=%OPN, POINTER=PREV_ILS$->ILS.NEXT) ;
      380    14457               %NEXT_ILS (POINTER=PREV_ILS$) ;
      381    14462    2          IF ENTRY_TYPE = %MAIN_PROGRAM AND
      382    14463    2            NOT COMCOM.OB.TP AND NOT COMCOM.OB.TP8 THEN
      383    14464                   %RESERVE_ILL (ITEM=%STOP, POINTER=PREV_ILS$->ILS.ILL$) ;
      384    14474    3            ELSE DO ;
      385    14475    3              TEMP$ = CURRENT_PROC$->PROC_.PROC_SUPP$->PROC_SUPP.IO_RESTORE_CHAIN$;
      386    14476    4              DO WHILE TEMP$ ~= ADDR(NIL); /* Restore caller's USE pointers */
      387    14477                     %RESERVE_ILL (ITEM=%MVII, POINTER=PREV_ILS$->ILS.ILL$);
      388    14487    4                PREV_ILS$->ILS.ILL$->ILL.LOP = TEMP$->IO_RESTORE_CHAIN.TO$;
      389    14488    4                PREV_ILS$->ILS.ILL$->ILL.ROP = TEMP$->IO_RESTORE_CHAIN.RESTORE$;
      390    14489                     %RESERVE_ILS (ITEM=%OPN, POINTER=PREV_ILS$->ILS.NEXT);
      391    14518                     %NEXT_ILS (POINTER=PREV_ILS$);
      392    14523    4                TEMP$ = TEMP$->IO_RESTORE_CHAIN.NEXT$;
      393    14524    4              END; /* WHILE */
      394    14525                   %RESERVE_ILL (ITEM=%EXIT_PROG, POINTER=PREV_ILS$->ILS.ILL$) ;
      395    14535    3              PREV_ILS$->ILS.ILL$->ILL.LOP = CURRENT_PROC$ ;
      396    14536    3            END ;
      397    14537    2          PREV_ILS$->ILS.ILL$->ILL.CODE = %EXIT_PROG_PHASE2_CREATED ;
      398    14538    2          PREV_ILS$->ILS.NEXT = ILS$ ;
      399    14539    2   END INSERT_STOP_OR_EXIT ;
      400    14540        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:17   
      401    14541    1   RESTORE_IO_CHAIN: PROC;
      402    14542
      403    14543        /*I*
      404    14544               NAME: RESTORE_IO_CHAIN
      405    14545               CALL: CALL RESTORE_IO_CHAIN;
      406    14546
      407    14547              INPUT: ILS$ - Pointer to the ILS item at which USE pointers are
      408    14548                            to be restored.
      409    14549                 IO: PREV_ILS$ - Pointer to ILS item before insertion.
      410    14550             OUTPUT: MVII items are generated to restore all a caller's USE
      411    14551                     pointers.
      412    14552        */
      413    14553
      414    14554    3          DO WHILE PREV_ILS$->ILS.NEXT ~= ILS$;
      415    14555                 %NEXT_ILS (POINTER=PREV_ILS$);
      416    14560    3          END;
      417    14561    2          TEMP$ = CURRENT_PROC$->PROC_.PROC_SUPP$->PROC_SUPP.IO_RESTORE_CHAIN$;
      418    14562    3          DO WHILE TEMP$ ~= ADDR(NIL);
      419    14563                 %RESERVE_ILS (ITEM=%OPN, POINTER=PREV_ILS$->ILS.NEXT);
      420    14592                 %NEXT_ILS (POINTER=PREV_ILS$);
      421    14597                 %RESERVE_ILL (ITEM=%MVII, POINTER=PREV_ILS$->ILS.ILL$);
      422    14607    3            PREV_ILS$->ILS.ILL$->ILL.LOP = TEMP$->IO_RESTORE_CHAIN.TO$;
      423    14608    3            PREV_ILS$->ILS.ILL$->ILL.ROP = TEMP$->IO_RESTORE_CHAIN.RESTORE$;
      424    14609    3            TEMP$ = TEMP$->IO_RESTORE_CHAIN.NEXT$;
      425    14610    3          END;
      426    14611    2          PREV_ILS$->ILS.NEXT = ILS$ ;
      427    14612    2   END RESTORE_IO_CHAIN;
      428    14613        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:18   
      429    14614    1   OPTIMIZE_CALL: PROC (CALLEE$) ALTRET ;
      430    14615        /*I*
      431    14616               NAME: OPTIMIZE_CALL
      432    14617               CALL: CALL OPTIMIZE_CALL (CALLEE$);
      433    14618              INPUT: CALLEE$ - Pointer to PROC_DEF for subroutine being called.
      434    14619             OUTPUT: If the subroutine is internal, is called exactly once, and
      435    14620                     certain other requirements are met, the subroutine's ILL
      436    14621                     is moved in line in place of the CALL.
      437    14622        */
      438    14623        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:19   
      439    14624    2   DCL   CALLEE$ PTR ;
      440    14625    2   DCL   PROC1$ PTR;
      441    14626    2   DCL   FATHER_PROC$ PTR;
      442    14627    2   DCL   PARAMLIST$ PTR ;
      443    14628    2   DCL   PARAM$ PTR ;
      444    14629    2   DCL   ARG$ PTR ;
      445    14630    2   DCL   BASE$ PTR;
      446    14631    2   DCL   ENTRY$ PTR ;
      447    14632    2   DCL   SEARCH_ILL$ PTR ;
      448    14633    2   DCL   N UBIN ;
      449    14634    2   DCL   OPT_FLAG BIT (1) ;
      450    14635    2   DCL   BASED$PTR$ PTR BASED;
      451    14636          /**/
      452    14637    2          IF CALLEE$->PROC_DEF.ID ~= %INTDEF OR NOT COMCOM.OB.OPTZ OR
      453    14638    2              COMCOM.OB.COUNT OR
      454    14639    2              COMCOM.CANCEL_ID OR O2COM.CALL_ID THEN GOTO CANT_OPTIMIZE ;
      455    14640    2          PROC1$ = CALLEE$->INTDEF.PROC$ ;
      456    14641    2          IF PROC1$->PROC_.B.CANCELED OR PROC1$->PROC_.B.INITIAL OR
      457    14642    2              PROC1$->PROC_.PROC_SUPP$->PROC_SUPP.REF_COUNT ~= 1 THEN
      458    14643    2              GOTO CANT_OPTIMIZE ;
      459    14644    2          PARAMLIST$ = PROC1$->PROC_.PROC_DEF$->INTDEF.ARGLIST$ ;
      460    14645    2          LTS$ = ILL$->ILL.LOP; /* PTR to arg list */
      461    14646    3          IF PARAMLIST$ = ADDR(NIL) THEN DO ; /* Subroutine, no args */
      462    14647    3            IF LTS$->ARGLIST.N = 1 THEN GOTO PROC_NO_PARAMS ;
      463    14648    3            GOTO CANT_OPTIMIZE ;
      464    14649    3          END ;
      465    14650    2          IF PARAMLIST$->ARGLIST.N ~= LTS$->ARGLIST.N THEN
      466    14651    2              GOTO CANT_OPTIMIZE ; /* Wrong number of args */
      467    14652    2          OPT_FLAG = TRUE ; /* Be optimistic - assume CALL is optimizable */
      468    14653    3          DO N = 2 TO PARAMLIST$->ARGLIST.N ;
      469    14654    3            PARAM$ = PARAMLIST$->ARGLIST.ARG$ (N - 2) ;
      470    14655    3            ARG$ = LTS$->ARGLIST.ARG$ (N - 2) ->ETT.LOP ;
      471    14656                 /* Parameter arglist points to ST items, while CALL arglist
      472    14657                    points to BASE items. */
      473    14658    3            IF PARAM$->VARIABLE.B.REDEF_SUB THEN OPT_FLAG = FALSE ;
      474    14659    3            ELSE IF NOT PARAM$->VARIABLE.B.ELEMENTARY OR NOT ARG$->
      475    14660    4                VARIABLE.B.ELEMENTARY THEN DO ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:20   
      476    14661    4              OPT_FLAG = FALSE ; /* Cannot verify that structures match */
      477    14662    4            END ;
      478    14663    3            ELSE IF PARAM$->VARIABLE.TYPE ~= ARG$->VARIABLE.TYPE THEN
      479    14664    3              OPT_FLAG = FALSE ;
      480    14665    3          END ;
      481    14666    2          IF NOT OPT_FLAG THEN GOTO CANT_OPTIMIZE ;
      482    14667               /* Transfer the subroutine text in line. */
      483    14668    2   PROC_NO_PARAMS:
      484    14669    2          DEFLB_FOLLOWS = FALSE ;
      485    14670    2          TEMP$ = ILS$ ;
      486    14671               %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
      487    14686    3          IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB THEN DO ;
      488    14687    3            DEFLB_FOLLOWS = TRUE ;
      489    14688    3            LABEL_AFTER_PFORM$ = TEMP$->ILS.ILL$->ILL.LOP ;
      490    14689    3          END ;
      491    14690               /* Set SEARCH_ILS$ to point to the ILS for the first ENTRY in the
      492    14691                  subroutine. */
      493    14692    2          COPY_ILS$ = ADDR(NIL) ;
      494    14693    2          TEMP$ = PROC1$->PROC_.PROC_DEF$ ;
      495    14694    2          SEARCH_ILS$ = COMCOM.INT_SUB$ ;
      496    14695    2          ENTRY$ = COMCOM.INT_SUB$ ;
      497    14696    3          DO WHILE SEARCH_ILS$->ILS.ILL$->ENTRY_ILL.LOP ~= TEMP$ ;
      498    14697    3            COPY_ILS$ = SEARCH_ILS$ ;
      499    14698    3            SEARCH_ILS$ = SEARCH_ILS$->ILS.ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ ;
      500    14699                 /* SEARCH_ILS$ should never be ADDR (NIL). */
      501    14700    3            IF SEARCH_ILS$->ILS.ILL$->ILL.LOP = CALLEE$ THEN
      502    14701    3              ENTRY$ = SEARCH_ILS$ ; /* ILS for the ENTRY that is called */
      503    14702    3          END ;
      504    14703               /* ENTRY$ is for the ENTRY that is called, and SEARCH_ILS$ for the
      505    14704                  main entry point of the subroutine. Normally they are the same, but
      506    14705                  they can differ, as in the case of a subroutine that is never
      507    14706                  called thru its main entry and is called only once thru another
      508    14707                  entry point. */
      509    14708    2          START_LABEL_ILS$ = SEARCH_ILS$ ;
      510    14709               %NEXT_NON_LINOI (POINTER=START_LABEL_ILS$) ; /* First DEFLB's ILS */
      511    14719    2          IF START_LABEL_ILS$->ILS.ILL$->ILL.ID ~= %DEFLB
      512    14720                 /* This can happen if there are USE procedures -- they must be in
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:21   
      513    14721                    effect ONLY for the internal program -- or if segmentation is used
      514    14722                    by the internal program -- it is reasonable to sacrifice this
      515    14723                    optimization in this case too. */
      516    14724    2            THEN GOTO CANT_OPTIMIZE ;
      517    14725    2          PROC1$->PROC_.B.INLINE = TRUE ; /* So that the SCOPE and PEND
      518    14726                                                  can be scrapped later */
      519    14727    2          IF COPY_ILS$ = ADDR(NIL)
      520    14728    2            THEN COMCOM.INT_SUB$ = SEARCH_ILS$->ILS.ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ ;
      521    14729    2            ELSE COPY_ILS$->ILS.ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ =
      522    14730    2                SEARCH_ILS$->ILS.ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ ;
      523    14731    2          SEARCH_ILS$->ILS.ILL$ = ADDR(NIL) ; /* Get rid of the %ENTRY */
      524    14732    3          IF ENTRY$ ~= SEARCH_ILS$ THEN DO ;
      525    14733                 %RESERVE_ILL (ITEM=%GO,POINTER=ILS$->ILS.ILL$) ;
      526    14743    3            TEMP$ = ENTRY$ ;
      527    14744                 %NEXT_NON_LINOI (POINTER=TEMP$) ; /* Should point to DEFLB's ILS */
      528    14754    3            PREV_ILS$ = ILS$ ;
      529    14755    3            ILS$->ILS.ILL$->GO.EXPR$ = ADDR(NIL) ;
      530    14756    3            ILS$->ILS.ILL$->GO.LABEL$ = TEMP$->ILS.ILL$->DEFLB.LOP ;
      531    14757    3            IF TEMP$->ILS.ILL$->DEFLB.LOP->LABEL.B.REFERENCED
      532    14758    3              THEN TEMP$->ILS.ILL$->DEFLB.LOP->LABEL.B.ONE_REF = FALSE ;
      533    14759    3              ELSE TEMP$->ILS.ILL$->DEFLB.LOP->LABEL.B.ONE_REF = TRUE ;
      534    14760    3            TEMP$->ILS.ILL$->DEFLB.LOP->LABEL.B.REFERENCED = TRUE ;
      535    14761    3          END ;
      536    14762    2          ELSE ILS$->ILS.ILL$ = ADDR(NIL) ;
      537    14763    2          ILS$->ILS.NEXT = START_LABEL_ILS$ ;
      538    14764    2          END_LABEL_ILS$ = START_LABEL_ILS$ ;
      539    14765    2          START_LABEL$ = START_LABEL_ILS$->ILS.ILL$->ILL.LOP ;
      540    14766    2          START_LABEL$->LABEL.B.REFERENCED = TRUE ;
      541    14767    2          PERF_LABEL_CHECK = COMCOM.H_LBL ;
      542    14768    2          LABEL_CHECK$ = COMCOM.H_LBL ;
      543    14769    3          IF REF_DEFLB ~= ADDR(NIL) THEN DO ;
      544    14770    3            PERF_LABEL_CHECK = REF_DEFLB ;
      545    14771    3            LABEL_CHECK$ = REF_DEFLB ;
      546    14772    3          END ;
      547    14773    3          DO WHILE '1'B ; /* Rather, until last DEFLB before CALL found */
      548    14774    3            TEMP$ = PERF_LABEL_CHECK->ILS.ILL$->ILL.LBL ;
      549    14775    3            IF TEMP$ = ADDR(NIL) THEN EXIT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:22   
      550    14776    3            IF NOT TEMP$->ILS.ILL$->ILL.LOP->LABEL.B.PHASE_2 THEN EXIT ;
      551    14777    3            PERF_LABEL_CHECK = TEMP$ ;
      552    14778    3          END ;
      553    14779    2          IF NOT START_LABEL$->LABEL.B.PHASE_2 THEN
      554    14780    3            DO WHILE '1'B ; /* Rather, until last DEFLB before subroutine found */
      555    14781    3              TEMP$ = LABEL_CHECK$->ILS.ILL$->ILL.LBL ; /* Should never be ADDR(NIL) */
      556    14782    3              IF TEMP$ = START_LABEL_ILS$ THEN EXIT ;
      557    14783    3              LABEL_CHECK$ = TEMP$ ;
      558    14784    3            END ;
      559    14785        /*V*
      560    14786            SCAN_SUBROUTINE -- Thruout the subroutine, change all line numbers,
      561    14787                               replace all EXIT PROGRAM statements except the last
      562    14788                               with GOTOs to a label immediately after the CALL, and
      563    14789                               find the last label in the subroutine.
      564    14790        */
      565    14791    3   SCAN_SUBR: DO WHILE SEARCH_ILS$ ~= ADDR(NIL) ;
      566    14792    3            SEARCH_ILL$ = SEARCH_ILS$->ILS.ILL$ ;
      567    14793    4            IF SEARCH_ILL$ ~= ADDR(NIL) THEN DO ;
      568    14794    5              IF SEARCH_ILL$->ILL.ID = %DEFLB THEN DO ;
      569    14795    5                END_LABEL_ILS$ = SEARCH_ILS$ ;
      570    14796    5                SEARCH_ILL$->ILL.LOP->LABEL.PROC$ = CURRENT_PROC$ ;
      571    14797                     /* Label is now in CALL statement's program. */
      572    14798    5              END ;
      573    14799    5              ELSE IF SEARCH_ILL$->ILL.ID = %EXIT_PROG THEN DO ;
      574    14800    5                TEMP$ = SEARCH_ILS$ ;
      575    14801                     %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
      576    14816    6                DO CASE (TEMP$->ILS.ILL$->ILL.ID) ;
      577    14817    6                  CASE (%SCOPE,%END_PROG) ;
      578    14818    6                    SEARCH_ILS$->ILS.ILL$ = ADDR(NIL) ;
             14818                             /* Get rid of last %EXIT_PROG */
      579    14819    6                    EXIT SCAN_SUBR ;
      580    14820    6                  CASE (%LINOI,%PREOFF,%PRESET,%PTR_SET,%P_A_PRESET,%P_P_PRESET) ;
      581    14821                         /* Do not update COPY_ILS$ */
      582    14822    6                  CASE (ELSE) ;
      583    14823    6                    COPY_ILS$ = SEARCH_ILS$ ;
      584    14824    6                END ;
      585    14825    6                IF NOT DEFLB_FOLLOWS THEN DO ; /* Create label after CALL */
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:23   
      586    14826    6                  CALL Z8AT$CREATE_TEMPORARY (%PARA,LABEL_AFTER_PFORM$) ;
      587    14827    6                  LABEL_AFTER_PFORM$->LABEL.B.REFERENCED = TRUE ;
      588    14828    6                  LABEL_AFTER_PFORM$->LABEL.B.ONE_REF = TRUE ;
      589    14829    6                  LABEL_AFTER_PFORM$->LABEL.SECTION$ = O2COM.SECTION$ ;
      590    14830    6                  LABEL_AFTER_PFORM$->LABEL.PROC$ = CURRENT_PROC$ ;
      591    14831                       %RESERVE_ILS (ITEM=%OPN,POINTER=TEMP$) ;
      592    14860                       %RESERVE_ILL (ITEM=%LINOI,POINTER=TEMP$->ILS.ILL$) ;
      593    14870                       %RESERVE_ILS (ITEM=%OPN,POINTER=TEMP$->ILS.NEXT) ;
      594    14899                       %RESERVE_ILL (ITEM=%DEFLB,POINTER=TEMP$->ILS.NEXT->ILS.ILL$) ;
      595    14909    6                  TEMP$->ILS.NEXT->ILS.NEXT = NEXT_ILS$ ;
      596    14910    6                  NEXT_ILS$ = TEMP$ ;
      597    14911    6                  TEMP$->ILS.ILL$->LINOI.PREV_LINE = COMCOM.CURRENT.LINE ;
      598    14912    6                  TEMP$->ILS.ILL$->LINOI.LINE_NO = COMCOM.CURRENT.LINE ;
      599    14913    6                  TEMP$->ILS.ILL$->LINOI.PREV_COL = COMCOM.CURRENT.COLUMN ;
      600    14914    6                  TEMP$->ILS.ILL$->LINOI.COLUMN_NO = COMCOM.CURRENT.COLUMN ;
      601    14915                       %NEXT_ILS (POINTER=TEMP$) ;
      602    14920    6                  TEMP$->ILS.ILL$->ILL.LOP = LABEL_AFTER_PFORM$ ;
      603    14921    6                  TEMP$->ILS.ILL$->ILL.LBL = PERF_LABEL_CHECK->ILS.ILL$->ILL.LBL ;
      604    14922    6                  PERF_LABEL_CHECK->ILS.ILL$->ILL.LBL = TEMP$ ;
      605    14923    6                  DEFLB_FOLLOWS = TRUE ;
      606    14924    6                END ;
      607    14925    5                ELSE LABEL_AFTER_PFORM$->LABEL.B.ONE_REF = FALSE ;
      608    14926                     %RESERVE_ILL (ITEM=%GO,POINTER=SEARCH_ILS$->ILS.ILL$) ;
      609    14936    5                SEARCH_ILS$->ILS.ILL$->GO.LABEL$ = LABEL_AFTER_PFORM$ ;
      610    14937    5                SEARCH_ILS$->ILS.ILL$->GO.EXPR$ = ADDR(NIL) ;
      611    14938    5              END ;
      612    14939    5              ELSE IF SEARCH_ILL$->ILL.ID = %LINOI THEN DO ;
      613    14940    5                SEARCH_ILL$->LINOI.PREV_LINE = COMCOM.CURRENT.LINE ;
      614    14941    5                SEARCH_ILL$->LINOI.LINE_NO = COMCOM.CURRENT.LINE ;
      615    14942    5              END ;
      616    14943    4            END ;
      617    14944    3            TEMP$ = SEARCH_ILS$ ;
      618    14945                 %NEXT_ILS (POINTER=TEMP$) ;
      619    14950    3            IF TEMP$->ILS.ILL$ ~= ADDR(NIL) THEN
      620    14951    3              IF TEMP$->ILS.ILL$->ILL.ID = %SCOPE OR
      621    14952    3                  TEMP$->ILS.ILL$->ILL.ID = %END_PROG THEN
      622    14953    3                EXIT SCAN_SUBR ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:24   
      623    14954    3            SEARCH_ILS$ = TEMP$ ;
      624    14955    3          END ; /* SCAN_SUBR */
      625    14956    2          IF DEFLB_FOLLOWS THEN
      626    14957    2            LABEL_AFTER_PFORM$->LABEL.PREV_ILS$ = COPY_ILS$ ;
      627    14958    2          END_LABEL$ = END_LABEL_ILS$->ILS.ILL$->ILL.LOP ;
      628    14959    2          IF START_LABEL$->LABEL.B.PHASE_2 /* Flow analysis already done */
      629    14960    2            THEN CALL Z8FS$SRCH_IF_DO_LBL (START_LABEL$,END_LABEL$) ;
      630    14961    2            ELSE LABEL_CHECK$->ILS.ILL$->ILL.LBL = END_LABEL_ILS$->ILS.ILL$->ILL.LBL ;
      631    14962    2          START_LABEL$->LABEL.PREV_ILS$->ILS.NEXT = SEARCH_ILS$->ILS.NEXT ;
      632    14963    2          START_LABEL$->LABEL.PREV_ILS$ = PREV_ILS$ ;
      633    14964    2          END_LABEL_ILS$->ILS.ILL$->ILL.LBL = PERF_LABEL_CHECK->ILS.ILL$->ILL.LBL ;
      634    14965    2          PERF_LABEL_CHECK->ILS.ILL$->ILL.LBL = START_LABEL_ILS$ ;
      635    14966    2          SEARCH_ILS$->ILS.NEXT = NEXT_ILS$ ;
      636    14967    3          IF START_LABEL$->LABEL.B.PHASE_2 THEN DO ;
      637    14968    3            PREV_ILS$ = SEARCH_ILS$ ;
      638    14969    3            ILS$ = NEXT_ILS$ ;
      639    14970    3          END ;
      640    14971    3          ELSE DO ;
      641    14972    3            ILS$ = PREV_ILS$ ;
      642    14973                 %NEXT_NON_SUPPORT ;
      643    14988    3          END ;
      644    14989    2          IF PARAMLIST$ = ADDR(NIL) THEN
      645    14990    2            GOTO OPTIMIZED ; /* No parameters, therefore no need to adjust any
      646    14991                                     BASE triads */
      647    14992    2          BASE$ = COMCOM.H_BASE ;
      648    14993    3          DO WHILE BASE$ ~= ADDR(NIL) ; /* Replace parameters with args */
      649    14994    4   REPLACE_PARAM: DO N = 2 TO PARAMLIST$->ARGLIST.N ;
      650    14995    5              IF BASE$->ETT.LOP = PARAMLIST$->ARGLIST.ARG$ (N - 2) THEN DO ;
      651    14996    5                BASE$->ETT.LOP = LTS$->ARGLIST.ARG$ (N - 2) ->ETT.LOP ;
      652    14997    5                EXIT REPLACE_PARAM ;
      653    14998    5              END ;
      654    14999    4            END ; /* REPLACE_PARAM */
      655    15000    3            BASE$ = BASE$->ETT.ROP ;
      656    15001    3          END ;
      657    15002    2   OPTIMIZED:
      658    15003               /* Prune the PROC_ from the procedure tree. */
      659    15004    2          FATHER_PROC$ = PROC1$->PROC_.FATHER ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:25   
      660    15005    2          TEMP$ = ADDR (FATHER_PROC$->PROC_.SON) ;
      661    15006               /* Set TEMP$ to point to the son or brother pointer pointing to PROC1$. */
      662    15007    3          DO WHILE TEMP$->BASED$PTR$ ~= PROC1$ ;
      663    15008    3            TEMP$ = ADDR (TEMP$->BASED$PTR$->PROC_.BROTHER) ;
      664    15009    3          END ;
      665    15010    2          TEMP$->BASED$PTR$ = PROC1$->PROC_.SON ;
      666    15011    3          DO WHILE TEMP$->BASED$PTR$ ~= ADDR (NIL) ;
      667    15012    3            TEMP$->BASED$PTR$->PROC_.FATHER = FATHER_PROC$ ;
      668    15013    3            TEMP$ = ADDR (TEMP$->BASED$PTR$->PROC_.BROTHER) ;
      669    15014    3          END ; /* FATHER pointers have been updated by this loop. */
      670    15015    2          TEMP$->BASED$PTR$ = PROC1$->PROC_.BROTHER ;
      671    15016    2          RETURN ;
      672    15017    2   CANT_OPTIMIZE:
      673    15018    2          ALTRETURN ;
      674    15019    2   END OPTIMIZE_CALL ;
      675    15020        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:26   
      676    15021        /*V*
      677    15022            INITIALIZE  -- Initialize variables before loop
      678    15023                           1.  Get the first ILS item that points to a non-LINOI
      679    15024                               item in the ILL.
      680    15025                           2.  Set all of the DO variables.
      681    15026                           3.  Generate STOP RUN or EXIT PROGRAM if the last
      682    15027                               statement was not an unconditional transfer.
      683    15028        */
      684    15029
      685    15030    1          ILS$ = COMCOM.FIRST_ILS ; /* Find the first non-LINOI ILS item. */
      686    15031               %NEXT_NON_LINOI ;
      687    15041    1          PREV_ILS$ = COMCOM.FIRST_ILS ;
      688    15042    1          COMCOM.H_DO = ADDR(NIL) ;
      689    15043    1          O2COM.LAST_LBL$ = ADDR(NIL) ;
      690    15044
      691    15045    1          FATHER_DO = ADDR(NIL) ;
      692    15046    1          REF_DEFLB = ADDR(NIL) ;
      693    15047    1          GOTO_DEST$ = ADDR (NIL) ;
      694    15048    1          VECTOR_END$ = ADDR(NIL) ;
      695    15049    1          GOTO_VECTOR = FALSE ;
      696    15050    1          DEFLB_AFTER_ENTRY = FALSE ;
      697    15051    1          AFTER_USE         = FALSE ;
      698    15052    1          LABEL_AFTER_USE   = ADDR (NIL) ;
      699    15053    1          ENTADDR_OF_NIL$ = ADDR (NIL) ;
      700    15054    1          EXIT_PROG$ = ADDR (NIL) ;
      701    15055    1          EXIT_PROG_FOUND = FALSE ;
      702    15056    1          FALL_THRU_FLAG = -1 ; /* Beginning of program */
      703    15057    1          DO_LEVEL = 1 ;
      704    15058    1          ENTRY_TYPE = %SUBROUTINE ; /* The default */
      705    15059        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:27   
      706    15060        /*V*
      707    15061            LOOP_THRU_ILS -- Loop thru the ILS looking at each ILL item.
      708    15062                             If optimizations are possible then they are done.
      709    15063
      710    15064                             ILS.ILL$ may be nill for a ILS entry so a check is made
      711    15065                             for that and if one is found it is deleted from the ILS.
      712    15066                             A case is then performed on the ILL entry's ID.
      713    15067        */
      714    15068
      715    15069    1      CASE_LOOP:
      716    15070    2          DO UNTIL (ILS$ = ADDR(NIL)) ;
      717    15071    2            ILL$ = ILS$->ILS.ILL$ ;
      718    15072    2            NEXT_ILS$ = ILS$ ;
      719    15073                 %NEXT_ILS (POINTER=NEXT_ILS$) ;
      720    15078
      721    15079    3            IF NEXT_ILS$ ~= ADDR(NIL) THEN DO ;
      722    15080    4              IF NEXT_ILS$->ILS.ILL$ = ADDR(NIL) THEN DO ;
      723    15081
      724    15082    5                DO UNTIL NEXT_ILS$->ILS.ILL$ ~= ADDR(NIL)  ;
      725    15083                       %NEXT_ILS (POINTER=NEXT_ILS$) ;
      726    15088    5                END ;
      727    15089
      728    15090    4                ILS$->ILS.NEXT = NEXT_ILS$ ;
      729    15091    4              END ;
      730    15092    3            END ;
      731    15093
      732    15094    2          CASE_STMT:
      733    15095    3            DO CASE (ILL$->ILL.ID) ;
      734    15096        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:28   
      735    15097        /*V*
      736    15098            SCOPE -- If necessary then insert a STOP or EXIT_PROG before it.
      737    15099        */
      738    15100    3              CASE (%SCOPE) ;
      739    15101    3                O2COM.SEGMENT_NO = 0 ;
      740    15102    3                IF FALL_THRU_FLAG > 0 OR
      741    15103    3                  (ILL$ -> SCOPE.PROC$ ~= ADDR (NIL) AND
      742    15104    3                   ILL$ -> SCOPE.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.
             15104                            EXIT_PROG_IN_DECL AND
      743    15105                         %IF CP6 ;
      744    15106    3                    ENTRY_TYPE = %SUBROUTINE AND
      745    15107                         %ENDIF ;
      746    15108    3                    EXIT_PROG$ ~= ADDR (NIL) AND
      747    15109    3                    NOT EXIT_PROG_FOUND) THEN
      748    15110    3                  CALL INSERT_STOP_OR_EXIT ;
      749    15111    3                CURRENT_PROC$ = ILL$ -> SCOPE.PROC$ ;
      750    15112    3                IF CURRENT_PROC$ = ADDR (NIL)
      751    15113    3                  THEN FALL_THRU_FLAG = 0 ; /* End of program */
      752    15114    3                ELSE IF CURRENT_PROC$->PROC_.B.INLINE
      753    15115    3                  THEN FALL_THRU_FLAG = 0 ; /* Program that was optimized out */
      754    15116    3                  ELSE FALL_THRU_FLAG = -1 ; /* Beginning of (next) program */
      755    15117    3                EXIT_PROG$ = ADDR (NIL) ;
      756    15118    3                EXIT_PROG_FOUND = FALSE ;
      757    15119    3                PREV_ILS$ = ILS$ ;
      758    15120    3                ILS$ = NEXT_ILS$ ;
      759    15121        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:29   
      760    15122        /*V*
      761    15123            ENTRY -- If a main program or subroutine entry then:
      762    15124                     If there is no STOP or EXIT_PROG before the ENTRY and the ENTRY
      763    15125                     is not at the beginning of the program then insert a STOP or
      764    15126                     EXIT_PROG. Set the type for main program or subroutine.
      765    15127        */
      766    15128    3              CASE (%ENTRY) ;
      767    15129    4                IF ILL$->ILL.CODE ~= %SUBROUTINE_ENTRY THEN DO ;
      768    15130    4                  IF FALL_THRU_FLAG > 0 THEN
      769    15131    4                    CALL INSERT_STOP_OR_EXIT ;
      770    15132    4                  ENTRY_TYPE = ILL$->ILL.CODE ;
      771    15133    4                  TEMP$ = ILS$ ;
      772    15134                       %NEXT_NON_LINOI (POINTER=TEMP$) ;
      773    15144    4                  IF TEMP$->ILS.ILL$->ILL.ID = %GO THEN
      774    15145    4                    AFTER_USE = TRUE ;
      775    15146    4                END ;
      776    15147    3                DEFLB_AFTER_ENTRY = TRUE ;
      777    15148    3                FALL_THRU_FLAG = 1 ;
      778    15149    3                IF CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.EXIT_PROG_IN_DECL
      779    15150                         %IF CP6 ;
      780    15151    3                    AND ENTRY_TYPE = %SUBROUTINE
      781    15152                         %ENDIF ;
      782    15153    4                    THEN DO ;
      783    15154    5                  IF EXIT_PROG$ = ADDR (NIL) THEN DO ;
      784    15155    5                    CALL Z8AT$CREATE_TEMPORARY (%PARA, EXIT_PROG$) ;
      785    15156    5                    EXIT_PROG$->LABEL.PROC$ = CURRENT_PROC$ ;
      786    15157    5                    EXIT_PROG$->LABEL.B.EXIT_PROG_LABEL = TRUE;
      787    15158    5                    EXIT_PROG$->LABEL.B.REFERENCED = TRUE ;
      788    15159    5                  END ;
      789    15160    4                  ILL$->ENTRY_ILL.EXIT_PROG$ = EXIT_PROG$ ;
      790    15161    4                END ;
      791    15162    3                PREV_ILS$ = ILS$ ;
      792    15163    3                ILS$ = NEXT_ILS$ ;
      793    15164        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:30   
      794    15165        /*V*
      795    15166            GO -- The GO statement is checked for its validity, whether it's an
      796    15167                  altered GO, and if it can be optimized.
      797    15168
      798    15169                  We check the left operand of the GO item to see if it is nill.
      799    15170                  If it is nill and the GO code does not specify it as nill then we
      800    15171                  delete the GO statement from the program.
      801    15172        */
      802    15173
      803    15174    3              CASE (%GO) ;
      804    15175
      805    15176    3                IF ILL$->ILL.LOP = ADDR(NIL) THEN
      806    15177    4                  DO ;
      807    15178
      808    15179    4                    IF ILL$->ILL.CODE = %GO_OVERFLOW_OFF OR
      809    15180    4                       ILL$->ILL.CODE = %GO_FLT_OVERFLOW_OFF THEN
      810    15181    5                      DO ;
      811    15182    5                        PREV_ILS$ = ILS$ ;
      812    15183    5                      END ;
      813    15184    4                    ELSE
      814    15185    5                      DO ;
      815    15186    5                        IF ILL$->ILL.CODE ~= %GO_INVALID_LABEL /*#33670*/
      816    15187    5                          THEN CALL Z8AE$ERROR (%E$GOTO_NO_DEST) ;
      817    15188    5                        PREV_ILS$->ILS.NEXT = NEXT_ILS$ ;
      818    15189    5                        ILS$$ = ILS$ ;
      819    15190                             %NEXT_NON_SUPPORT (POINTER=ILS$$) ;
      820    15205    5                        IF ILS$$->ILS.ILL$->ILL.ID = %DEFLB
      821    15206    5                          THEN ILS$$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$
      822    15207    5                              = PREV_ILS$ ;
      823    15208    5                      END ;
      824    15209
      825    15210    4                    ILS$ = NEXT_ILS$ ;
      826    15211    4                    FALL_THRU_FLAG = 1 ; /* Fall thru possible */
      827    15212
      828    15213    4                    EXIT CASE_STMT ;
      829    15214    4                  END ;
      830    15215        %EJECT;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:31   
      831    15216        /*V*
      832    15217            USELESS_GO -- Optimize out all transfers to current location + 1, unless
      833    15218                          they are ALTERed or use instructions like TOV that may
      834    15219                          change the Indicator Register or transfer to a different
      835    15220                          segment. If FALL_THRU_FLAG = 0 it is dead code; get rid
      836    15221                          of it later.
      837    15222        */
      838    15223    3                IF FALL_THRU_FLAG ~= 0 THEN
      839    15224    4                  DO CASE (ILL$ -> ILL.CODE) ;
      840    15225    4                    CASE (%GO_OVERFLOW, %GO_OVERFLOW_OFF, %GO_FLT_OVERFLOW,
      841    15226    4                          %GO_FLT_OVERFLOW_OFF, %GO_ALTERED) ;
      842    15227                           /* These cannot be optimized out. */
      843    15228    4                    CASE (ELSE) ;
      844    15229    4                      ILS$$ = ILS$ ;
      845    15230                           %NEXT_NON_SUPPORT (POINTER=ILS$$) ;
      846    15245    4                      IF ILS$$->ILS.ILL$->ILL.ID = %DEFLB AND
      847    15246    4                          NOT ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.PFORM_END_LBL AND
      848    15247    4                          (ILS$$->ILS.ILL$->ILL.LOP->LABEL.ID = %PARA OR
      849    15248    4                           ILS$$->ILS.ILL$->ILL.LOP->SECTION.SEGMENT$ = ADDR(NIL) OR
      850    15249    4                           ILS$$->ILS.ILL$->ILL.LOP->SECTION.SEGMENT$->SEGMENT_LTS.
             15249                                    SEGMENT_NO# =
      851    15250    4                             O2COM.SEGMENT_NO) THEN
      852    15251    5   USELESS_GO_CHECK:    DO ;
      853    15252    5                          TEMP$ = ILS$$ ;
             15252                                   /* So this DEFLB's PREV_ILS$ can be changed */
      854    15253    6                          DO WHILE ILS$$->ILS.ILL$->ILL.LOP ~= ILL$->ILL.LOP ;
      855    15254                                 %NEXT_NON_SUPPORT (POINTER=ILS$$) ;
      856    15269    6                            IF ILS$$->ILS.ILL$->ILL.ID ~= %DEFLB OR
      857    15270    6                                ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.PFORM_END_LBL THEN
      858    15271    6                              EXIT USELESS_GO_CHECK ; /* Not transfer to *+1 */
      859    15272    6                          END ; /* WHILE */
      860    15273    6                          IF ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.ONE_REF THEN DO ;
      861    15274    6                            ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.ONE_REF = FALSE ;
      862    15275    6                            ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.REFERENCED = FALSE ;
      863    15276    6                            ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.GOTO_LABEL = FALSE ;
      864    15277    6                          END ;
      865    15278    5                          TEMP$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ = PREV_ILS$ ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:32   
      866    15279    5                          PREV_ILS$->ILS.NEXT = NEXT_ILS$ ;
      867    15280    5                          ILS$ = NEXT_ILS$ ;
      868    15281    5                          EXIT CASE_STMT ;
      869    15282    5                        END ; /* USELESS_GO_CHECK */
      870    15283    4                  END ; /* CASE */
      871    15284        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:33   
      872    15285        /*V*
      873    15286            CHAIN_OF_GO_ITEMS -- If the GO points directly to a non-ALTERed GO then
      874    15287                                 this GO can be set to point to where the destination
      875    15288                                 GO points. It is possible for long chains of GOs to
      876    15289                                 be collapsed to a single GO this way.
      877    15290                                 Suppress this optimization if NOPTZ.
      878    15291        */
      879    15292        /*                Explanation of GO_FLAG:
      880    15293                          -1 GO destination is not a GO or is ALTERED.
      881    15294                           0 GO destination is non-ALTERed GO that cannot
      882    15295                             be optimized out.
      883    15296                          +1 Go destination is non-ALTERed GO that can
      884    15297                             be optimized out.
      885    15298        */
      886    15299    3                IF COMCOM.OB.OPTZ AND
      887    15300    4                    COMCOM.SEGMENTC <= 1 THEN DO;
      888    15301    5                  DO UNTIL GO_FLAG < 0 ;
      889    15302    5                    IF ILL$->ILL.LOP->LABEL.ID = %PARA OR
      890    15303    6                        ILL$->ILL.LOP->LABEL.ID = %SECTION THEN DO ;
      891    15304                                    /* It can be SSOP, for example. */
      892    15305    6                      ILS$$ = ILL$->ILL.LOP->LABEL.PREV_ILS$ ;
      893    15306                           %NEXT_NON_SUPPORT (POINTER=ILS$$) ; /* ILS for DEFLB */
      894    15321    6                      GO_ILS$ = ILS$$ ;
      895    15322                           %NEXT_NON_SUPPORT (POINTER=ILS$$) ; /* Next statement */
      896    15337    6                      IF ILS$$->ILS.ILL$->ILL.ID = %GO AND
      897    15338    6                          ILS$$->ILS.ILL$->ILL.CODE = %GO_UNCONDITIONAL AND
      898    15339    6                          ILS$$->ILS.ILL$->ILL.LOP ~= ADDR (NIL) AND
      899    15340    7                          ILL$->ILL.LOP->LABEL.POINTER$ = ADDR (NIL) THEN DO ;
      900    15341    8                        IF ILL$->ILL.LOP ~= ILS$$->ILS.ILL$->ILL.LOP THEN DO ;
      901    15342    8                          GO_FLAG = 0 ; /* GO points to another GO */
      902    15343    8                          IF ILL$->ILL.LOP->LABEL.B.FALL_THRU OR
      903    15344    8                              NOT ILL$->ILL.LOP->LABEL.B.ONE_REF
      904    15345    8                            THEN ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.ONE_REF = FALSE ;
      905    15346    8                            ELSE GO_FLAG = 1 ; /* Destination GO can be scrapped */
      906    15347    9                          IF ILL$->ILL.LOP->LABEL.B.ONE_REF THEN DO ;
      907    15348    9                            ILL$->ILL.LOP->LABEL.B.ONE_REF = FALSE ;
      908    15349    9                            ILL$->ILL.LOP->LABEL.B.REFERENCED = FALSE ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:34   
      909    15350    9                          END ;
      910    15351    8                          ILL$->ILL.LOP = ILS$$->ILS.ILL$->ILL.LOP ;
      911    15352                                   /* Optimize out an unneeded GO */
      912    15353    9                          IF GO_FLAG > 0 THEN DO ;
      913    15354    9                            ILS$$->ILS.ILL$ = ADDR (NIL) ;
      914    15355    9                            TEMP$ = ILS$$ ;
      915    15356                                 %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
      916    15371    9                            IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB THEN
      917    15372    9                              TEMP$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ =
      918    15373    9                                  GO_ILS$ ;
      919    15374    9                          END ;
      920    15375                                     /* Mark the destination GO for deletion */
      921    15376    8                        END ;
      922    15377    7                        ELSE GO_FLAG = -1 ;
      923    15378                             /* GO TO itself is legal and should not be optimized.
      924    15379                                The user is risking a lockup fault at runtime. */
      925    15380    7                      END ;
      926    15381    6                      ELSE GO_FLAG = -1 ; /* GO does not point to another GO */
      927    15382    6                    END ;
      928    15383    5                    ELSE GO_FLAG = -1 ; /* Do not optimize GO TO DEPENDING. */
      929    15384    5                  END ;
      930    15385        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:35   
      931    15386        /*V*
      932    15387            OPTIMIZE_GO -- If it is a GO to a label before the GO and all the
      933    15388                           referenced labels in between, if any, are compiler
      934    15389                           created, then generate DO_1 and DOEND around the GO and
      935    15390                           label so that Phase 3 can optimize it.
      936    15391                           Suppress this optimization if NOPTZ.
      937    15392        */
      938    15393        /*         Explanation of GO_FLAG for the following code:
      939    15394                   +1 GO can be optimized to a DO loop.
      940    15395                   0  It is not yet known if the GO can be optimized.
      941    15396                   -1 GO cannot be optimized to a DO loop.
      942    15397        */
      943    15398    4                  IF GOTO_DEST$ = ADDR (NIL) AND ILL$->ILL.LOP ~= ADDR (NIL)
      944    15399    4                      AND NOT ILL$ -> ILL.LOP -> LABEL.B.COMPILER_CREATED
      945    15400    4                      AND (ILL$->ILL.LOP->LABEL.ID = %PARA
      946    15401    4                      OR ILL$->ILL.LOP->LABEL.ID = %SECTION)
      947    15402    4                      AND ILL$->ILL.LOP->LABEL.B.PHASE_2 AND DO_LEVEL = 1
      948    15403    4                    THEN GOTO_DEST$ = ILL$->ILL.LOP ;
      949    15404    5                  IF GOTO_DEST$ ~= ADDR (NIL) AND DO_LEVEL = 1 THEN DO ;
      950    15405    5                    GO_ILS$ = ILS$ ;
      951    15406    5                    GO_FLAG = 0 ;
      952    15407    5                    IF NOT GOTO_DEST$->LABEL.B.ENTRY_POINT
      953    15408    6                        THEN DO UNTIL (GO_FLAG ~= 0) ;
      954    15409                           %NEXT_NON_SUPPORT (POINTER=GO_ILS$) ;
      955    15424    6                      TEMP$ = GO_ILS$->ILS.ILL$->ILL.LOP ;
      956    15425    7   GO_1:              DO CASE (GO_ILS$->ILS.ILL$->ILL.ID) ;
      957    15426    7                        CASE (%DEFLB) ;
      958    15427    7                          IF TEMP$->LABEL.B.GO_VECTOR_START OR
      959    15428    7                              NOT TEMP$->LABEL.B.COMPILER_CREATED THEN
      960    15429    7                            GO_FLAG = 1 ;
      961    15430    7                        CASE (%GO) ;
      962    15431    8                          IF TEMP$ ~= ADDR (NIL) THEN DO ;
      963    15432    8                            IF TEMP$->LABEL.ID ~= %SECTION AND
      964    15433    9                                TEMP$->LABEL.ID ~= %PARA THEN DO ;
      965    15434                                     /* E.g., TEMP$->ETT.ID = %SSOP */
      966    15435    9                              GO_FLAG = 1 ;
      967    15436    9                              EXIT GO_1 ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:36   
      968    15437    9                            END ;
      969    15438    9                            IF TEMP$->LABEL.B.PHASE_2 THEN DO ;
      970    15439    9                              IF TEMP$ ~= GOTO_DEST$
      971    15440    9                                THEN GO_FLAG = 1 ;
      972    15441    9                                ELSE GO_FLAG = -1 ;
      973    15442    9                            END ;
      974    15443    8                          END ;
      975    15444    7                        CASE (ELSE) ;
      976    15445    7                          GO_FLAG = 1 ;
      977    15446    7                      END GO_1 ;
      978    15447    6                    END ;
      979    15448    6                    IF GO_FLAG > 0 THEN DO ; /* GO may be optimizable */
      980    15449    6                      LABEL_CHECK$ = ILL$->ILL.LOP->LABEL.PREV_ILS$ ;
      981    15450                           %NEXT_NON_SUPPORT (POINTER=LABEL_CHECK$) ;
      982    15465
      983    15466    6                    GO_LABEL_CHECK:
      984    15467    7                      DO WHILE LABEL_CHECK$ ~= REF_DEFLB ;
      985    15468    7                        LABEL_CHECK$ = LABEL_CHECK$->ILS.ILL$->ILL.LBL ;
      986    15469    7                        IF LABEL_CHECK$->ILS.ILL$->ILL.LOP->LABEL.B.REFERENCED AND
      987    15470    7                           NOT (LABEL_CHECK$->ILS.ILL$->ILL.LOP->LABEL.B.
             15470                                    COMPILER_CREATED) THEN
      988    15471    8                          DO ;
      989    15472    8                            GO_FLAG = 0 ;
      990    15473    8                            EXIT GO_LABEL_CHECK ;
      991    15474    8                          END ;
      992    15475
      993    15476    7                      END GO_LABEL_CHECK ;
      994    15477    6                    END ;
      995    15478    6                    IF GO_FLAG > 0 THEN DO ; /* GO is optimizable */
      996    15479        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:37   
      997    15480        /*V*
      998    15481            GO_LOOP_PRESET -- Pointers used in the conversion are initialized.
      999    15482                              These are
     1000    15483
     1001    15484                                1. GO_LABEL_LINOI$ - Ptr to linoi entry of target label.
     1002    15485                                2. GO_LABEL_ILS$   - Ptr to ILS entry for target label.
     1003    15486
     1004    15487                              The DO_1 is created for the loop and the pointers for
     1005    15488                              the DO item are assigned (previous DO item, level, and
     1006    15489                              last label).  For descriptions please see DO item in the
     1007    15490                              outer case.
     1008    15491        */
     1009    15492
     1010    15493    6                      GO_LABEL_LINOI$ = ILL$->ILL.LOP->LABEL.PREV_ILS$ ;
     1011    15494                           %NEXT_ILS (POINTER=GO_LABEL_LINOI$) ;
     1012    15499    6                      GO_LABEL_ILS$ = GO_LABEL_LINOI$ ;
     1013    15500                           %NEXT_NON_SUPPORT (POINTER=GO_LABEL_ILS$) ;
     1014    15515
     1015    15516                           %RESERVE_ILS (ITEM=%OPN, POINTER=DO_LINOI$) ;
     1016    15545                           %RESERVE_ILL (ITEM=%LINOI, POINTER=DO_LINOI$->ILS.ILL$) ;
     1017    15555    6                      DO_LINOI$->ILS.ILL$->LINOI.LINE_NO =
     1018    15556    6                          GO_LABEL_LINOI$->ILS.ILL$->LINOI.LINE_NO ;
     1019    15557    6                      DO_LINOI$->ILS.ILL$->LINOI.PREV_LINE =
     1020    15558    6                          GO_LABEL_LINOI$->ILS.ILL$->LINOI.LINE_NO ;
     1021    15559    6                      DO_LINOI$->ILS.ILL$->LINOI.COLUMN_NO =
     1022    15560    6                          GO_LABEL_LINOI$->ILS.ILL$->LINOI.COLUMN_NO ;
     1023    15561    6                      DO_LINOI$->ILS.ILL$->LINOI.PREV_COL =
     1024    15562    6                          GO_LABEL_LINOI$->ILS.ILL$->LINOI.COLUMN_NO ;
     1025    15563                           %RESERVE_ILS (ITEM=%OPN, POINTER=DO_ILS$) ;
     1026    15592                           %RESERVE_ILL (ITEM=%DO1, POINTER=DO_ILS$->ILS.ILL$) ;
     1027    15602    6                      DO_ILS$->ILS.ILL$->DO_N.ITO = FATHER_DO ;
     1028    15603    6                      DO_ILS$->ILS.ILL$->DO_N.LEVEL = DO_LEVEL ;
     1029    15604        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:38   
     1030    15605        /*V*
     1031    15606            SET_UP_GO_LOOP_FLOW --
     1032    15607               The GO loop given in the above example may be converted two different
     1033    15608               ways into a loop.
     1034    15609
     1035    15610               If the target label "A" is the only referenced once then the DO item
     1036    15611               is inserted before the label and will look like this.
     1037    15612
     1038    15613                   DO_1.
     1039    15614                     A.
     1040    15615                       Add 1 to variable.
     1041    15616                       If variable < 5 then go to A.
     1042    15617                   DOEND.
     1043    15618
     1044    15619               When the target label "A" is referenced more than once then the
     1045    15620               conversion is a little more involved.  The conversion requires linking
     1046    15621               the DO item after the target label and creating a label to follow the DO
     1047    15622               item.  A check is also made of the GO statements in between, if any, to
     1048    15623               change any references from "A" to the created label.
     1049    15624
     1050    15625                   A.
     1051    15626                     DO_1.
     1052    15627                       CREATED_LABEL.
     1053    15628                         Add 1 to variable.
     1054    15629                         If variable < 5 then go to CREATED_LABEL.
     1055    15630                     DOEND.
     1056    15631
     1057    15632               The DOEND item is created and inserted after the last GO item for both
     1058    15633               types of loops.
     1059    15634            */
     1060    15635        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:39   
     1061    15636    6                      IF GO_LABEL_ILS$->ILS.ILL$->ILL.LOP->LABEL.B.ONE_REF THEN
     1062    15637    7                        DO ;
     1063    15638    7                          DO_ILS$->ILS.ILL$->DO_N.XLAB = ADDR (NIL) ;
     1064    15639    7                          TEMP$ = COMCOM.H_LBL ;
     1065    15640    8                          DO WHILE TEMP$ ~= GO_LABEL_ILS$ ;
     1066    15641    8                            DO_ILS$->ILS.ILL$->DO_N.XLAB = TEMP$ ;
     1067    15642    8                            TEMP$ = TEMP$->ILS.ILL$->ILL.LBL ;
     1068    15643    8                          END ;
     1069    15644    7                          GO_LABEL_ILS$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$
     1070    15645    7                              = DO_ILS$ ;
     1071    15646    7                          GO_LABEL_LINOI$->ILS.NEXT = DO_ILS$ ;
     1072    15647    7                          DO_ILS$->ILS.NEXT = DO_LINOI$ ;
     1073    15648    7                          DO_LINOI$->ILS.NEXT = GO_LABEL_ILS$ ;
     1074    15649    7                        END ;
     1075    15650    6                      ELSE  /* Multiple references */
     1076    15651    7                        DO ;
     1077    15652    7                          DO_ILS$->ILS.ILL$->DO_N.XLAB = GO_LABEL_ILS$ ;
     1078    15653
     1079    15654    7                          CALL Z8AT$CREATE_TEMPORARY(%PARA, CREATED_LABEL$) ;
     1080    15655    7                          CREATED_LABEL$ -> LABEL.B.ONE_REF = TRUE ;
     1081    15656    7                          CREATED_LABEL$ -> LABEL.B.FALL_THRU = TRUE ;
     1082    15657    7                          CREATED_LABEL$ -> LABEL.PROC$ = CURRENT_PROC$ ;
     1083    15658
     1084    15659                               %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP$) ;
     1085    15688    7                          TEMP$->ILS.ILL$ = DO_LINOI$->ILS.ILL$ ;
     1086    15689                               %RESERVE_ILS(ITEM=%OPN, POINTER=TEMP$->ILS.NEXT) ;
     1087    15718                               %RESERVE_ILL(ITEM=%DEFLB, POINTER=TEMP$->ILS.NEXT->ILS.ILL$)
             15718                                   ;
     1088    15728    7                          TEMP$->ILS.NEXT->ILS.ILL$->ILL.LOP = CREATED_LABEL$ ;
     1089    15729    7                          TEMP$->ILS.NEXT->ILS.ILL$->ILL.LBL =
     1090    15730    7                              GO_LABEL_ILS$->ILS.ILL$->ILL.LBL ;
     1091    15731    7                          GO_LABEL_ILS$->ILS.ILL$->ILL.LBL = TEMP$->ILS.NEXT ;
     1092    15732    7                          TEMP$->ILS.NEXT->ILS.NEXT = GO_LABEL_ILS$->ILS.NEXT ;
     1093    15733    7                          GO_LABEL_ILS$->ILS.NEXT = DO_LINOI$ ;
     1094    15734    7                          DO_LINOI$->ILS.NEXT = DO_ILS$ ;
     1095    15735    7                          DO_ILS$->ILS.NEXT = TEMP$ ;
     1096    15736    8                          IF REF_DEFLB = GO_LABEL_ILS$ THEN DO ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:40   
     1097    15737    8                            REF_DEFLB = DO_ILS$ ;
     1098    15738                                 %NEXT_ILS (POINTER=REF_DEFLB) ; /* LINOI */
     1099    15743                                 %NEXT_ILS (POINTER=REF_DEFLB) ; /* DEFLB */
     1100    15748    8                            O2COM.LAST_LBL$ = REF_DEFLB ;
     1101    15749    8                          END ;
     1102    15750    7                          CREATED_LABEL$->LABEL.PREV_ILS$ = DO_ILS$ ;
     1103    15751
     1104    15752    7                          TEMP$ = DO_ILS$ ;
     1105    15753    8                          DO UNTIL TEMP$ = ILS$ ;
     1106    15754                                 %NEXT_ILS (POINTER=TEMP$) ;
     1107    15759    8                            IF TEMP$->ILS.ILL$->ILL.LOP =
     1108    15760    9                                GO_LABEL_ILS$->ILS.ILL$->ILL.LOP THEN DO ;
     1109    15761    9                              IF CREATED_LABEL$->LABEL.B.REFERENCED
     1110    15762    9                                THEN CREATED_LABEL$->LABEL.B.ONE_REF = FALSE ;
     1111    15763    9                              CREATED_LABEL$ -> LABEL.B.REFERENCED = TRUE ;
     1112    15764    9                              TEMP$->ILS.ILL$->ILL.LOP = CREATED_LABEL$ ;
     1113    15765    9                            END ;
     1114    15766
     1115    15767    8                          END ;
     1116    15768
     1117    15769    7                        END ;
     1118    15770
     1119    15771                           %RESERVE_ILS(ITEM=%OPN, POINTER=DOEND_ILS$) ;
     1120    15800                           %RESERVE_ILL(ITEM=%DOEND, POINTER=DOEND_ILS$->ILS.ILL$) ;
     1121    15810    6                      DOEND_ILS$->ILS.ILL$->DO_N.ITB = DO_ILS$ ;
     1122    15811    6                      DO_ILS$->ILS.ILL$->DO_N.ITE = DOEND_ILS$ ;
     1123    15812    6                      DOEND_ILS$->ILS.NEXT = NEXT_ILS$ ;
     1124    15813    6                      ILS$->ILS.NEXT = DOEND_ILS$ ;
     1125    15814    6                      TEMP$ = DOEND_ILS$ ;
     1126    15815                           %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
     1127    15830    6                      IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB
     1128    15831    6                        THEN TEMP$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$
     1129    15832    6                            = DOEND_ILS$ ;
     1130    15833        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:41   
     1131    15834        /*V*
     1132    15835            SEARCH_FOR_INTERNAL_DO -- A search is made starting from the created
     1133    15836                                      DO item to find any internal DOs.  If none are
     1134    15837                                      found then the DO item is inserted at the end
     1135    15838                                      of the DO LINK.
     1136    15839
     1137    15840                                      If one is found then the created DO is inserted
     1138    15841                                      into the linked list right before the first
     1139    15842                                      internal DO.  A search is then made thru the
     1140    15843                                      internal DOs and DOENDs to update them.
     1141    15844        */
     1142    15845
     1143    15846    6                      SEARCH_DO$ = DO_ILS$ ;
     1144    15847
     1145    15848    7                      DO UNTIL SEARCH_DO$->ILS.ILL$->ILL.ID = %DO1 OR
     1146    15849    7                               SEARCH_DO$->ILS.ILL$->ILL.ID = %DO2 OR
     1147    15850    7                               SEARCH_DO$->ILS.ILL$->ILL.ID = %DO3 OR
     1148    15851    7                               SEARCH_DO$->ILS.ILL$->ILL.ID = %DO4 OR
     1149    15852    7                               SEARCH_DO$->ILS.ILL$->ILL.ID = %DO5 OR
     1150    15853                                 /* SEARCH_DO$->ILS.ILL$->ILL.ID = %DO6 OR */
     1151    15854    7                               SEARCH_DO$ = DOEND_ILS$ ;
     1152    15855                             %NEXT_ILS (POINTER=SEARCH_DO$) ;
     1153    15860    7                      END ;
     1154    15861
     1155    15862    6                      IF SEARCH_DO$ = DOEND_ILS$ THEN
     1156    15863    7                        DO ;
     1157    15864    7                          DO_ILS$->ILS.ILL$->DO_N.ITP = COMCOM.H_DO ;
     1158    15865    7                          COMCOM.H_DO = DO_ILS$ ;
     1159    15866    7                        END ;
     1160    15867    6                      ELSE
     1161    15868    7                        DO ;
     1162    15869    7                          DO_ILS$->ILS.ILL$->DO_N.ITP = SEARCH_DO$->ILS.ILL$->DO_N.ITP
             15869                                   ;
     1163    15870    7                          SEARCH_DO$->ILS.ILL$->DO_N.ITP = DO_ILS$ ;
     1164    15871    7                          IF SEARCH_DO$->ILS.ILL$->DO_N.XLAB = GO_LABEL_ILS$ THEN
     1165    15872    8                            DO ;
     1166    15873    8                              SEARCH_DO$->ILS.ILL$->DO_N.XLAB = DO_ILS$ ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:42   
     1167    15874                                   %NEXT_ILS (POINTER=SEARCH_DO$->ILS.ILL$->DO_N.XLAB) ;
     1168    15879    8                            END ;
     1169    15880
     1170    15881        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:43   
     1171    15882        /*V*
     1172    15883            SEARCH_INTERNAL_DOS -- The search continues thru the internal DO
     1173    15884                                   and DOEND items to update them.  Their links may
     1174    15885                                   change and their level numbers and their fathers
     1175    15886                                   will change.
     1176    15887        */
     1177    15888
     1178    15889    8                          DO UNTIL SEARCH_DO$ = DOEND_ILS$ ;
     1179    15890
     1180    15891    9                            DO CASE(SEARCH_DO$->ILS.ILL$->ILL.ID) ;
     1181    15892
     1182    15893    9                              CASE(%DO1, %DO2, %DO3, %DO4, %DO5/*, %DO6 */) ;
     1183    15894    9                                IF SEARCH_DO$->ILS.ILL$->DO_N.LEVEL = 1
     1184    15895    9                                  THEN SEARCH_DO$->ILS.ILL$->DO_N.ITO = DO_ILS$ ;
     1185    15896    9                                SEARCH_DO$->ILS.ILL$->DO_N.LEVEL =
     1186    15897    9                                  SEARCH_DO$->ILS.ILL$->DO_N.LEVEL + 1 ;
     1187    15898
     1188    15899    9                            END ;
     1189    15900
     1190    15901                                 %NEXT_ILS (POINTER=SEARCH_DO$) ;
     1191    15906
     1192    15907    8                          END ;
     1193    15908
     1194    15909    7                        END ;
     1195    15910
     1196    15911    6                      DOEND_ILS$->ILS.ILL$->DO_N.ITP = COMCOM.H_DO ;
     1197    15912    6                      COMCOM.H_DO = DOEND_ILS$ ;
     1198    15913    6                      ILS$ = DOEND_ILS$ ;
     1199    15914    6                    END ;
     1200    15915    5                    IF GO_FLAG >= 0 THEN GOTO_DEST$ = ADDR (NIL) ;
     1201    15916    5                  END ;
     1202    15917    4                END ;
     1203    15918        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:44   
     1204    15919        /*V*
     1205    15920            GO_ALTER_CHECK -- If the item is a GO altered then set the code to
     1206    15921                              %GO_ALTERED.  A base item is created above the SWITCH and
     1207    15922                              GO is assigned the pointer.
     1208    15923                              This applies to GO TO unconditional, the destination of
     1209    15924                              which is an ALTERed GO TO.
     1210    15925        */
     1211    15926
     1212    15927    4                IF COMCOM.SEGMENTC <= 1 THEN DO;
     1213    15928    4                IF ILL$->ILL.CODE = %GO_UNCONDITIONAL THEN
     1214    15929    5                  DO ;
     1215    15930    5                    IF ILL$->ILL.LOP->LABEL.ID = %PARA AND
     1216    15931    5                       ILL$->ILL.LOP->LABEL.POINTER$ ~= ADDR(NIL) THEN
     1217    15932    6                      DO ;
     1218    15933    6                        ILL$->ILL.CODE = %GO_ALTERED ;
     1219    15934    6                        CALL Z8AF$NEW_BASE (ILL$ ->ILL.LOP -> LABEL.POINTER$,
     1220    15935    6                                            ADDR(NIL),
     1221    15936    6                                            ILL$ -> ILL.LOP) ;
     1222    15937    6                      END ;
     1223    15938    5                    FALL_THRU_FLAG = 0 ; /* Fall thru not possible */
     1224    15939    5                  END ;
     1225    15940    5                  ELSE DO;
     1226    15941    6   EXTRA_GO_CHECK:  DO;
     1227    15942    6                      GO_ILS$ = ILS$;
     1228    15943                           %NEXT_NON_SUPPORT (POINTER=GO_ILS$);
     1229    15958    6                      IF GO_ILS$ -> ILS.ILL$ = ADDR(NIL) OR
     1230    15959    6                          GO_ILS$ -> ILS.ILL$ -> ILL.ID ~= %GO OR
     1231    15960    6                          GO_ILS$ -> ILS.ILL$ -> ILL.CODE ~= %GO_UNCONDITIONAL OR
     1232    15961    6                          GO_ILS$ -> ILS.ILL$ -> ILL.LOP = ADDR(NIL) OR
     1233    15962    6                          GO_ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.POINTER$ ~= ADDR(NIL)
     1234    15963    6                        THEN EXIT EXTRA_GO_CHECK;
     1235    15964    6                      LABEL_CHECK$ = GO_ILS$ -> ILS.ILL$ -> ILL.LOP;
     1236    15965    6                      ILS$$ = GO_ILS$;
     1237    15966                           %NEXT_NON_SUPPORT (POINTER=GO_ILS$);
     1238    15981    6                      IF GO_ILS$ -> ILS.ILL$ -> ILL.ID ~= %DEFLB OR
     1239    15982    6                          GO_ILS$ -> ILS.ILL$ -> DEFLB.LOP ~= ILL$ -> ILL.LOP
     1240    15983    6                        THEN EXIT EXTRA_GO_CHECK;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:45   
     1241    15984                           /* This can be optimized. */
     1242    15985    6                      ILL$ -> ILL.LOP = LABEL_CHECK$;
     1243    15986                           %REVERSE_RELATE_OP_CODE (OP_CODE=ILL$->ILL.CODE,@CLASS=YES);
     1244    16024    6                      IF GO_ILS$ -> ILS.ILL$ -> DEFLB.LOP -> LABEL.ID = %PARA AND
     1245    16025    7                          GO_ILS$ -> ILS.ILL$ -> DEFLB.LOP -> LABEL.B.ONE_REF THEN DO;
     1246    16026                             /* Optimize out label */
     1247    16027    7                        GO_ILS$ -> ILS.ILL$ -> DEFLB.LOP -> LABEL.B.ONE_REF = FALSE;
     1248    16028    7                        GO_ILS$ -> ILS.ILL$ -> DEFLB.LOP -> LABEL.B.REFERENCED = FALSE;
     1249    16029    7                      END;
     1250    16030                           /* Now mark the GO to be optimized out. */
     1251    16031    6                      ILS$$ -> ILS.ILL$ -> ILL.CODE = %GO_INVALID_LABEL;
     1252    16032                           /* So it won't be mistaken for GO TO. in program. */
     1253    16033    6                      ILS$$ -> ILS.ILL$ -> ILL.LOP = ADDR(NIL);
     1254    16034    6                    END; /* EXTRA_GO_CHECK */
     1255    16035    5                    FALL_THRU_FLAG = 1; /* Conditional GO can fall thru */
     1256    16036    5                  END;
     1257    16037    4                  END;
     1258    16038    3                  ELSE FALL_THRU_FLAG = 1 ; /* Conditional GO can fall thru. */
     1259    16039        /*V*
     1260    16040            LABEL_AFTER_USE -- Phase 3 needs to have the first label after any
     1261    16041                               report writer and/or USE procedures added into
     1262    16042                               the entry chain.
     1263    16043        */
     1264    16044    3                 IF AFTER_USE THEN
     1265    16045    4                   DO ;
     1266    16046    4                     LABEL_AFTER_USE = ILL$->ILL.LOP ;
     1267    16047    4                     AFTER_USE = FALSE ;
     1268    16048    4                   END ;
     1269    16049    3                PREV_ILS$ = ILS$ ;
     1270    16050    3                ILS$ = NEXT_ILS$ ;
     1271    16051
     1272    16052        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:46   
     1273    16053        /*V*
     1274    16054            DEFLB -- The label information is assigned and the label is marked
     1275    16055                     as phase 2 referenced.
     1276    16056        */
     1277    16057
     1278    16058    3              CASE (%DEFLB) ;
     1279    16059                     %ASSIGN_LABEL_INFO ;
     1280    16078    3                IF AFTER_USE AND NOT ILL$->ILL.LOP->LABEL.B.COMPILER_CREATED THEN
     1281    16079    4                  DO ;
     1282    16080    4                    ILL$->ILL.LOP->LABEL.B.LABEL_AFTER_USE = TRUE ;
     1283    16081    4                    AFTER_USE = FALSE ;
     1284    16082    4                  END ;
     1285    16083    3                IF ILL$->ILL.LOP = LABEL_AFTER_USE THEN
     1286    16084    4                  DO ;
     1287    16085    4                    AFTER_USE = TRUE ;
     1288    16086    4                    LABEL_AFTER_USE = ADDR (NIL) ;
     1289    16087    4                  END ;
     1290    16088
     1291    16089        /*V*
     1292    16090            POINTER_LABEL -- If the item is a pointer then we need to create a BASE
     1293    16091                             entry for the pointer.  The loop will continue after
     1294    16092                             the GO item inside the ALTER paragraph because other-
     1295    16093                             wise CASE(%GO) would flag the null left operand as an error.
     1296    16094        */
     1297    16095
     1298    16096    3                IF ILL$->ILL.LOP->LABEL.POINTER$ ~= ADDR(NIL) AND
     1299    16097    3                   NOT ILL$ -> ILL.LOP -> LABEL.B.GO_ALTERED THEN
     1300    16098    4                  DO ;
     1301    16099
     1302    16100                         %FIND_ITEM(ITEM=%GO, POINTER=NEXT_ILS$) ;
     1303    16117
     1304    16118    4                    IF NEXT_ILS$ ->ILS.ILL$->ILL.CODE=%GO_AND_SAVE_IC_IN_X1 THEN
     1305    16119    5                      DO;
     1306    16120    5                        NEXT_ILS$ = NEXT_ILS$ -> ILS.NEXT;
     1307    16121
     1308    16122                             %FIND_ITEM(ITEM=%GO, POINTER=NEXT_ILS$);
     1309    16139    5                      END;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:47   
     1310    16140
     1311    16141    4                    NEXT_ILS$->ILS.ILL$->ILL.CODE = %GO_ALTERED ;
     1312    16142    4                    CALL Z8AF$NEW_BASE (ILL$ ->ILL.LOP -> LABEL.POINTER$,
     1313    16143    4                                        ADDR(NIL),
     1314    16144    4                                        NEXT_ILS$ -> ILS.ILL$ -> ILL.LOP) ;
     1315    16145    4                    ILS$ = NEXT_ILS$ ;
     1316    16146    4                    PREV_ILS$ = ILS$ ;
     1317    16147                         %NEXT_ILS (POINTER=ILS$) ;
     1318    16152
     1319    16153    4                  END ;
     1320    16154    3                ELSE
     1321    16155    4                  DO ;
     1322    16156        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:48   
     1323    16157        /*V*
     1324    16158            GO_VECTOR -- If the label is the lead label for a vector of GO items
     1325    16159                         then we skip past all of the GOs inside as there is no
     1326    16160                         need to check them and CASE(%GO) might optimize them out.
     1327    16161                         A vector is set up for GO TO DEPENDING and EVALUATE
     1328    16162                         statements that have been converted into CASE statements.
     1329    16163        */
     1330    16164
     1331    16165    4                    IF ILL$->ILL.LOP->LABEL.B.GO_VECTOR_START THEN
     1332    16166    5                      DO ;
     1333    16167    5                        PREV_ILS$ = ILL$->ILL.LOP->LABEL.P_END$->LABEL.PREV_ILS$ ;
     1334    16168
     1335    16169    5                        TEMP$ = PREV_ILS$ ;
     1336    16170                             %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
     1337    16185    6                        DO WHILE (ILS$ ~= TEMP$) ;
     1338    16186    6                          IF NEXT_ILS$->ILS.ILL$->ILL.ID = %GO AND
     1339    16187    7                             NEXT_ILS$->ILS.ILL$->ILL.LOP = ADDR(NIL) THEN DO ;
     1340    16188    7                            NEXT_ILS$->ILS.ILL$->ILL.LOP =
     1341    16189    7                                ILL$->ILL.LOP->LABEL.P_END$ ;
     1342    16190                                   /* Choosing an undefined label will cause
     1343    16191                                      control to fall thru. */
     1344    16192    7                            NEXT_ILS$->ILS.ILL$->ILL.CODE = %GO_UNCONDITIONAL ;
             16192                                     /*#33670*/
     1345    16193    7                          END ;
     1346    16194
     1347    16195    6                          ILS$ = NEXT_ILS$ ;
     1348    16196                               %NEXT_ILS (POINTER=NEXT_ILS$) ;
     1349    16201    6                        END ;
     1350    16202
     1351    16203    5                      END ;
     1352    16204    4                    ELSE
     1353    16205    5                      DO ;
     1354    16206    5                        PREV_ILS$ = ILS$ ;
     1355    16207    5                        ILS$ = NEXT_ILS$ ;
     1356    16208    5                      END ;
     1357    16209
     1358    16210    4                  END ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:49   
     1359    16211
     1360    16212    3                ILL$->ILL.LOP->LABEL.B.PHASE_2 = TRUE ;
     1361    16213        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:50   
     1362    16214        /*V*
     1363    16215            DO_S -- The DO pointers information is set.
     1364    16216        */
     1365    16217
     1366    16218    3              CASE (%DO1,%DO2,%DO3,%DO4,%DO5/*,%DO6 */) ;
     1367    16219    3                 OPTIMIZE_DO3 = FALSE ;
     1368    16220         /*V* DO3_OPTIMIZATION: PERFORM UNTIL <variable> <condition> <constant>
     1369    16221                                  SUBTRACT 1 FROM <variable>
     1370    16222                                END-PERFORM
     1371    16223                                Old ILL: If TEST BEFORE: DO3;DEFLB,lab1;GO,<variable>
     1372    16224                                <condition> <constant>;SB2I(e.g.);GO,lab1;
     1373    16225                                DEFLB,lab2;DOEND. If TEST AFTER: DO3;DEFLB,lab1;
     1374    16226                                SB2I(e.g.);GO,<variable> NOT <condition> <constant>,lab1;
     1375    16227                                DOEND.
     1376    16228                                The above can be optimized. If <condition> is =,
     1377    16229                                the optimized code is MOVE <constant> TO <variable>.
     1378    16230                                Otherwise, <constant'> = <constant> unless <condition>
     1379    16231                                is > or <, in which case it is <constant> - 1.
     1380    16232                                If TEST BEFORE, new ILL burst is: GO,<variable>
     1381    16233                                <condition><constant>,label2;MVII(e.g.) <constant'>
     1382    16234                                TO <variable>;DEFLB,lab2. Otherwise it is: GO,
     1383    16235                                <variable> NOT <condition> <constant>,lab1; SB2I(e.g.);
     1384    16236                                GO,created-label;DEFLB,lab1;MVII(e.g.) <constant'>
     1385    16237                                TO <variable>;DEFLB,created-label.
     1386    16238                                This will be done only for COMP-1, COMP-2, COMP-6,
     1387    16239                                and COMP-7 variables. */
     1388    16240    3                 IF ILL$->ILL.ID = %DO3 THEN
     1389    16241    4    CHECK_DO3:     DO ;
     1390    16242    4                     DO_ILS$ = ILS$ ;
     1391    16243                          %NEXT_ILS(POINTER=DO_ILS$) ;
     1392    16248    4                     IF DO_ILS$->ILS.ILL$->ILL.ID ~= %LINOI THEN
     1393    16249    4                       EXIT CHECK_DO3 ;
     1394    16250    4                     ILS$$ = DO_ILS$ ; /* LINOI ILS pointer for start label */
     1395    16251                          %NEXT_ILS(POINTER=DO_ILS$) ;
     1396    16256    4                     IF DO_ILS$->ILS.ILL$->ILL.ID ~= %DEFLB THEN
     1397    16257    4                       EXIT CHECK_DO3 ;
     1398    16258
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:51   
     1399    16259    4                     IF ILL$->DO_N.B.TEST_AFTER THEN
     1400    16260    5                       DO ;
     1401    16261    5                         START_LABEL_ILS$ = DO_ILS$ ;
     1402    16262    5                         START_LABEL$ = START_LABEL_ILS$->ILS.ILL$->ILL.LOP ;
     1403    16263                              %NEXT_ILS(POINTER=DO_ILS$) ;
     1404    16268    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %LINOI THEN
     1405    16269    5                           EXIT CHECK_DO3 ;
     1406    16270    5                       END ;
     1407    16271    4                     ELSE
     1408    16272    5                       DO ; /* TEST BEFORE or default */
     1409    16273                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;
     1410    16283    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %GO THEN
     1411    16284    5                           EXIT CHECK_DO3 ;
     1412    16285    5                         GO_ILS$ = DO_ILS$ ;
     1413    16286    5                         END_LABEL$ = DO_ILS$->ILS.ILL$->ILL.LOP ;
     1414    16287                              %NEXT_ILS(POINTER=DO_ILS$) ;
     1415    16292    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %LINOI THEN
     1416    16293    5                           EXIT CHECK_DO3 ;
     1417    16294    5                       END ;
     1418    16295
     1419    16296    4                     DO_LINOI$ = DO_ILS$ ;
     1420    16297                          %NEXT_ILS(POINTER=DO_ILS$) ;
     1421    16302    4                     OPERAND$ = DO_ILS$->ILS.ILL$->ILL.LOP ;
     1422    16303    4                     TEMP$ = DO_ILS$->ILS.ILL$->ILL.ROP ;
     1423    16304    5                     DO CASE (DO_ILS$->ILS.ILL$->ILL.ID) ;
     1424    16305    5                       CASE (%SB2I) ;
     1425    16306    5                         OPERAND_TYPE = %TYI ;
     1426    16307    5                       CASE (%MVHH) ;
     1427    16308    5                         IF TEMP$->ETT.ID ~= %CVIH OR
     1428    16309    5                             TEMP$->ETT.LOP->ETT.ID ~= %SBI OR
     1429    16310    5                             TEMP$->ETT.LOP->ETT.LOP->ETT.ID ~= %CVHI OR
     1430    16311    5                             TEMP$->ETT.LOP->ETT.LOP->ETT.LOP ~= OPERAND$ THEN
     1431    16312    5                           EXIT CHECK_DO3 ;
     1432    16313    5                         OPERAND_TYPE = %TYH ;
     1433    16314    5                         TEMP$ = TEMP$->ETT.LOP->ETT.ROP ;
     1434    16315    5                       CASE (%MVJJ) ;
     1435    16316    5                         IF TEMP$->ETT.ID ~= %CVIJ OR
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:52   
     1436    16317    5                             TEMP$->ETT.LOP->ETT.ID ~= %SBI OR
     1437    16318    5                             TEMP$->ETT.LOP->ETT.LOP->ETT.ID ~= %CVJI OR
     1438    16319    5                             TEMP$->ETT.LOP->ETT.LOP->ETT.LOP ~= OPERAND$ THEN
     1439    16320    5                           EXIT CHECK_DO3 ;
     1440    16321    5                         OPERAND_TYPE = %TYJ ;
     1441    16322    5                         TEMP$ = TEMP$->ETT.LOP->ETT.ROP ;
     1442    16323    5                       CASE (%MVKK) ;
     1443    16324    5                         IF TEMP$->ETT.ID ~= %CVIK OR
     1444    16325    5                             TEMP$->ETT.LOP->ETT.ID ~= %SBI OR
     1445    16326    5                             TEMP$->ETT.LOP->ETT.LOP->ETT.ID ~= %CVKI OR
     1446    16327    5                             TEMP$->ETT.LOP->ETT.LOP->ETT.LOP ~= OPERAND$ THEN
     1447    16328    5                           EXIT CHECK_DO3 ;
     1448    16329    5                         OPERAND_TYPE = %TYK ;
     1449    16330    5                         TEMP$ = TEMP$->ETT.LOP->ETT.ROP ;
     1450    16331    5                       CASE (ELSE) ;
     1451    16332    5                         EXIT CHECK_DO3 ;
     1452    16333    5                     END ; /* CASE */
     1453    16334
     1454    16335    4                     IF TEMP$ ~= COMCOM.VALUE_1 THEN
     1455    16336    4                       EXIT CHECK_DO3 ;
     1456    16337    4                     IF OPERAND$->ETT.ID = %BASE OR OPERAND$->ETT.ID = %OFF THEN;
     1457    16338                            /* OK, with these triads, optimizable */
     1458    16339    4                     ELSE
     1459    16340    4                       EXIT CHECK_DO3 ; /* Other triads, not optimizable */
     1460    16341    4                     SEARCH_DO$ = DO_ILS$ ;
     1461    16342                          /* GO_FLAG = 1 for PERFORM UNTIL <variable> < <constant>
     1462    16343                                         as result = <constant> - 1
     1463    16344                             GO_FLAG = 0 for PERFORM UNTIL <variable> <= <constant>
     1464    16345                                         as result = <constant>
     1465    16346                             GO_FLAG = -1 for PERFORM UNTIL <variable> = <constant>
     1466    16347                                         as this unconditionally sets result
     1467    16348                                         = <constant> regardless of prior value */
     1468    16349    4                     IF ILL$->DO_N.B.TEST_AFTER THEN
     1469    16350    5                       DO ;
     1470    16351                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;
     1471    16361    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %GO OR
     1472    16362    5                             DO_ILS$->ILS.ILL$->ILL.LOP ~= START_LABEL$ THEN
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:53   
     1473    16363    5                           EXIT CHECK_DO3 ;
     1474    16364    5                         GO_ILS$ = DO_ILS$ ;
     1475    16365                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;
     1476    16375    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %DOEND THEN
     1477    16376    5                           EXIT CHECK_DO3 ;
     1478    16377    5                         IF GO_ILS$->ILS.ILL$->ILL.CODE = %GO_LESS_THAN_OR_EQUAL OR
     1479    16378    5                             GO_ILS$->ILS.ILL$->ILL.CODE = %GO_GREATER_THAN_OR_EQUAL
     1480    16379    5                           THEN GO_FLAG = 1 ;
     1481    16380    5                         ELSE
     1482    16381    6                           DO ;
     1483    16382    6                             IF GO_ILS$->ILS.ILL$->ILL.CODE = %GO_NOT_EQUAL THEN
     1484    16383    7                               DO ;
     1485    16384                                      /* Need ILS after that for DOEND */
     1486    16385                                      %NEXT_ILS(POINTER=DO_ILS$) ;
     1487    16390    7                                 GO_FLAG = -1 ;
     1488    16391    7                               END ;
     1489    16392    6                               ELSE /* Need ILS for DOEND, will reuse */
     1490    16393    6                                 GO_FLAG = 0 ;
     1491    16394    6                           END ;
     1492    16395    5                       END ;
     1493    16396    4                     ELSE
     1494    16397    5                       DO ; /* TEST BEFORE or default */
     1495    16398                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;
     1496    16408    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %GO THEN
     1497    16409    5                           EXIT CHECK_DO3 ;
     1498    16410                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;
     1499    16420    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %DEFLB OR
     1500    16421    5                             DO_ILS$->ILS.ILL$->ILL.LOP ~= END_LABEL$ THEN
     1501    16422    5                           EXIT CHECK_DO3 ;
     1502    16423    5                         END_LABEL_ILS$ = DO_ILS$ ;
     1503    16424                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;
     1504    16434    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %DOEND THEN
     1505    16435    5                           EXIT CHECK_DO3 ;
     1506    16436                              %NEXT_ILS(POINTER=DO_ILS$) ; /* Need ILS after DOEND */
     1507    16441    5                         IF GO_ILS$->ILS.ILL$->ILL.CODE = %GO_LESS_THAN OR
     1508    16442    5                             GO_ILS$->ILS.ILL$->ILL.CODE = %GO_GREATER_THAN
     1509    16443    5                           THEN GO_FLAG = 1 ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:54   
     1510    16444    5                           ELSE IF GO_ILS$->ILS.ILL$->ILL.CODE = %GO_EQUAL
     1511    16445    5                             THEN GO_FLAG = -1 ;
     1512    16446    5                             ELSE GO_FLAG = 0 ;
     1513    16447    5                       END ;
     1514    16448
     1515    16449    4                     TEMP$ = GO_ILS$->ILS.ILL$->ILL.ROP ;
     1516    16450    4                     IF TEMP$ = ADDR(NIL) OR
     1517    16451    4                         TEMP$->ETT.ID ~= %CMPI THEN
     1518    16452    4                       EXIT CHECK_DO3 ;
     1519    16453    4                     IF TEMP$->ETT.LOP->ETT.ID = %TRIAD THEN
     1520    16454    5                       DO ;
     1521    16455    5                         CONST$ = TEMP$->ETT.LOP ;
     1522    16456    5                         TEMP$ = TEMP$->ETT.ROP ;
     1523    16457    5                       END ;
     1524    16458    4                     ELSE
     1525    16459    5                       DO ;
     1526    16460    5                         IF TEMP$->ETT.ROP->ETT.ID ~= %TRIAD THEN
     1527    16461    5                           EXIT CHECK_DO3 ;
     1528    16462    5                         CONST$ = TEMP$->ETT.ROP ;
     1529    16463    5                         TEMP$ = TEMP$->ETT.LOP ;
     1530    16464    5                       END ;
     1531    16465    5                     DO CASE (TEMP$->ETT.ID) ;
     1532    16466    5                       CASE (%CVHI, %CVJI, %CVKI) ;
     1533    16467    5                         TEMP$ = TEMP$->ETT.LOP ;
     1534    16468    5                     END ; /* CASE */
     1535    16469    4                     IF TEMP$ ~= OPERAND$ THEN
     1536    16470    4                       EXIT CHECK_DO3 ;
     1537    16471    4                     OPTIMIZE_DO3 = TRUE ;
     1538    16472    4                     IF ILL$->DO_N.B.TEST_AFTER AND
     1539    16473    4                         GO_ILS$->ILS.ILL$->ILL.CODE ~= %GO_NOT_EQUAL THEN
     1540    16474    5                       DO ;
     1541    16475    5                         TEMP$ = PREV_ILS$ ;
     1542    16476                              %NEXT_ILS(POINTER=TEMP$) ; /* ILS for LINOI */
     1543    16481    5                         TEMP$->ILS.NEXT = GO_ILS$ ;
     1544    16482    5                         ILS$ = GO_ILS$ ;
     1545    16483    5                         GO_ILS$->ILS.NEXT = DO_LINOI$ ;
     1546    16484                              %RESERVE_ILS(ITEM=%OPN,POINTER=SEARCH_DO$->ILS.NEXT) ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:55   
     1547    16513                              %NEXT_ILS(POINTER=SEARCH_DO$) ;
     1548    16518                              %RESERVE_ILL(ITEM=%LINOI,POINTER=SEARCH_DO$->ILS.ILL$) ;
     1549    16528    5                         SEARCH_DO$->ILS.ILL$->LINOI = DO_LINOI$->ILS.ILL$->LINOI ;
     1550    16529                              %RESERVE_ILS(ITEM=%OPN,POINTER=SEARCH_DO$->ILS.NEXT) ;
     1551    16558                              %NEXT_ILS(POINTER=SEARCH_DO$);
     1552    16563    5                         CALL Z8AT$CREATE_TEMPORARY (%PARA,CREATED_LABEL$) ;
     1553    16564    5                         CREATED_LABEL$->LABEL.B.REFERENCED = TRUE ;
     1554    16565    5                         CREATED_LABEL$->LABEL.B.ONE_REF = TRUE ;
     1555    16566    5                         CREATED_LABEL$->LABEL.B.GOTO_LABEL = TRUE ;
     1556    16567                              %RESERVE_ILL(ITEM=%GO,POINTER=SEARCH_DO$->ILS.ILL$) ;
     1557    16577    5                         SEARCH_DO$->ILS.ILL$->ILL.LOP = CREATED_LABEL$ ;
     1558    16578    5                         SEARCH_DO$->ILS.ILL$->ILL.ROP = ADDR(NIL) ;
     1559    16579    5                         SEARCH_DO$->ILS.NEXT = ILS$$ ; /* ADDR of ILS for LINOI
     1560    16580                                                                of START_LABEL$ */
     1561    16581    5                         START_LABEL_ILS$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ =
             16581                                  SEARCH_DO$ ;
     1562    16582                              %RESERVE_ILS(ITEM=%OPN,POINTER=START_LABEL_ILS$->ILS.NEXT) ;
     1563    16611                              %NEXT_ILS(POINTER=START_LABEL_ILS$) ;
     1564    16616                              %RESERVE_ILL(ITEM=%LINOI,POINTER=START_LABEL_ILS$->ILS.ILL$) ;
     1565    16626    5                         START_LABEL_ILS$->ILS.ILL$->LINOI =
     1566    16627    5                             DO_LINOI$->ILS.ILL$->LINOI ;
     1567    16628                              %RESERVE_ILS(ITEM=%OPV,POINTER=SEARCH_DO$) ;
     1568    16657    5                         SEARCH_DO$->ILS.DEF = OPERAND$ ;
     1569    16658    5                         START_LABEL_ILS$->ILS.NEXT = SEARCH_DO$ ;
     1570    16659    5                       END ; /* TEST AFTER */
     1571    16660    4                     ELSE
     1572    16661    5                       DO ; /* TEST BEFORE or test for equality or default */
     1573    16662    5                         IF GO_FLAG >= 0 THEN
     1574    16663    6                           DO ;
     1575    16664    6                             PREV_ILS$->ILS.NEXT = ILS$$ ;
     1576    16665    6                             ILS$$->ILS.NEXT = GO_ILS$ ;
     1577    16666    6                             GO_ILS$->ILS.NEXT = DO_LINOI$ ;
     1578    16667    6                           END ;
     1579    16668    5                         ELSE /* Test for equality, simplest case */
     1580    16669    6                           DO ;
     1581    16670    6                             PREV_ILS$->ILS.NEXT = DO_LINOI$ ;
     1582    16671    6                             SEARCH_DO$->ILS.NEXT = DO_ILS$ ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:56   
     1583    16672    6                           END ;
     1584    16673    5                         ILS$ = DO_LINOI$ ;
     1585    16674    5                         DO_LINOI$->ILS.NEXT = SEARCH_DO$ ;
     1586    16675    5                         NEXT_ILS$ = SEARCH_DO$ ;
     1587    16676    5                       END ;
     1588    16677
     1589    16678    4                     IF OPERAND_TYPE ~= %TYI OR GO_FLAG > 0 THEN
     1590    16679    5                       DO ;
     1591    16680    5                         TEMP_SBIN = CONST$->ETT.LOP->CONST.CONSTI.WORD1 ;
     1592    16681    5                         IF GO_FLAG > 0 THEN
     1593    16682    6                           DO ;
     1594    16683    6                             TEMP_SBIN = TEMP_SBIN - 1 ;
     1595    16684    6                             CALL BINXCHAR(TEMP_STR,TEMP_SBIN) ;
     1596    16685    6                             TEMP_UBIN = 1 ;
     1597    16686    7                             DO WHILE SUBSTR(TEMP_STR,TEMP_UBIN,1) = '0' ;
     1598    16687    7                               TEMP_UBIN = TEMP_UBIN + 1 ;
     1599    16688    7                             END ;
     1600    16689    6                             IF TEMP_SBIN < 0 THEN
     1601    16690    7                               DO ;
     1602    16691    7                                 CALL CONCAT(LEX_SYMBOL.SYMBOL,SUBSTR(TEMP_STR,0,1),
     1603    16692    7                                     SUBSTR(TEMP_STR,TEMP_UBIN)) ;
     1604    16693                                      /* TEMP_STR byte 0 = minus sign; concatenate
     1605    16694                                         with desired number of digits */
     1606    16695    7                                 LEX_SYMBOL.SIZE = 13 - TEMP_UBIN ;
     1607    16696    7                               END ;
     1608    16697    6                             ELSE
     1609    16698    7                               DO ;
     1610    16699    7                                 LEX_SYMBOL.SYMBOL = SUBSTR(TEMP_STR,TEMP_UBIN) ;
     1611    16700    7                                 LEX_SYMBOL.SIZE = 12 - TEMP_UBIN ;
     1612    16701    7                               END ;
     1613    16702    6                             CALL Z8AH$SEARCH_ ;
     1614    16703    6                           END ;
     1615    16704    5                         ELSE
     1616    16705    5                           DNT$ = CONST$->ETT.LOP->CONST.DNT$ ;
     1617    16706    5                         TEMP_UBIN = CONST$->ETT.LOP->CONST.COUNT ;
     1618    16707                              %NEW_CONST(@ST$   = CONST$,
     1619    16708                                         @COUNT = TEMP_UBIN,
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:57   
     1620    16709                                         @TYPE  = OPERAND_TYPE,
     1621    16710                                         @DNT$  = DNT$) ;
     1622    16751    5                         IF OPERAND_TYPE = %TYJ OR OPERAND_TYPE = %TYK THEN
     1623    16752    5                           CALL Z9EC$ALIGN(TEMP_SBIN,TEMP_SBIN) ;
     1624    16753                                /* Convert to COMP-1 or COMP-2 format if need be */
     1625    16754    5                         IF OPERAND_TYPE = %TYI OR OPERAND_TYPE = %TYK THEN
     1626    16755    6                           DO ;
     1627    16756    6                             CONST$->CONST.CONSTI.WORD1 = TEMP_SBIN ;
     1628    16757    6                             CONST$->CONST.ADSC.N = %COMP6_LENGTH ;
     1629    16758                                  /* COMP-2 uses same length */
     1630    16759    6                           END ;
     1631    16760    5                         ELSE
     1632    16761    6                           DO ;
     1633    16762    6                             CONST$->CONST.CONSTS.UPPER = TEMP_SBIN ;
     1634    16763    6                             CONST$->CONST.ADSC.N = %COMP7_LENGTH ;
     1635    16764                                  /* COMP-1 uses same length */
     1636    16765    6                           END ;
     1637    16766                              %NEW_ETT(@ID  = %TRIAD,
     1638    16767                                       @LOP = CONST$) ;
     1639    16837    5                         CONST$ = ETT$ ;
     1640    16838    5                       END ;
     1641    16839
     1642    16840    5                     DO CASE (OPERAND_TYPE) ;
     1643    16841    5                       CASE (%TYI) ;
     1644    16842    5                         ILL_ID = %MVII ;
     1645    16843    5                       CASE (%TYH) ;
     1646    16844    5                         ILL_ID = %MVHH ;
     1647    16845    5                       CASE (%TYJ) ;
     1648    16846    5                         ILL_ID = %MVJJ ;
     1649    16847    5                       CASE (%TYK) ;
     1650    16848    5                         ILL_ID = %MVKK ;
     1651    16849    5                     END ;
     1652    16850
     1653    16851                          %RESERVE_ILL(ITEM=ILL_ID,POINTER=SEARCH_DO$->ILS.ILL$) ;
     1654    16861    4                     SEARCH_DO$->ILS.ILL$->ILL.ROP = CONST$ ;
     1655    16862    4                     SEARCH_DO$->ILS.ILL$->ILL.LOP = OPERAND$ ;
     1656    16863    4                     IF ILL$->DO_N.B.TEST_AFTER AND
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:58   
     1657    16864    4                         GO_ILS$->ILS.ILL$->ILL.CODE ~= %GO_NOT_EQUAL THEN
     1658    16865    5                       DO ;
     1659    16866                              %RESERVE_ILS(ITEM=%OPN,POINTER=SEARCH_DO$->ILS.NEXT) ;
     1660    16895    5                         CREATED_LABEL$->LABEL.PREV_ILS$ = SEARCH_DO$ ;
     1661    16896                              %NEXT_ILS(POINTER=SEARCH_DO$) ;
     1662    16901                              %RESERVE_ILL(ITEM=%LINOI,POINTER=SEARCH_DO$->ILS.ILL$) ;
     1663    16911    5                         SEARCH_DO$->ILS.ILL$->LINOI = DO_LINOI$->ILS.ILL$->LINOI ;
     1664    16912    5                         SEARCH_DO$->ILS.NEXT = DO_ILS$ ; /* Reuse DOEND's ILS item */
     1665    16913                              %RESERVE_ILL(ITEM=%DEFLB,POINTER=DO_ILS$->ILS.ILL$) ;
     1666    16923    5                         DO_ILS$->ILS.ILL$->ILL.LOP = CREATED_LABEL$ ;
     1667    16924    5                       END ;
     1668    16925    4                     ELSE
     1669    16926    5                       DO ; /* TEST BEFORE or test for equality or default */
     1670    16927    5                         IF GO_FLAG >= 0 THEN
     1671    16928    6                           DO ;
     1672    16929    6                             END_LABEL_ILS$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ =
             16929                                      SEARCH_DO$ ;
     1673    16930    6                             TEMP$ = SEARCH_DO$ ;
     1674    16931    7                             DO UNTIL TEMP$->ILS.ILL$->ILL.ID = %LINOI ;
     1675    16932                                    %NEXT_ILS (POINTER=TEMP$) ;
     1676    16937    7                             END ;
     1677    16938    6                             SEARCH_DO$->ILS.NEXT = TEMP$ ;
     1678    16939    6                             TEMP$->ILS.NEXT = END_LABEL_ILS$ ;
     1679    16940    6                             END_LABEL_ILS$->ILS.NEXT = DO_ILS$ ;
     1680    16941    6                           END ;
     1681    16942                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;
     1682    16952    5                         IF DO_ILS$->ILS.ILL$->ILL.ID = %DEFLB THEN
     1683    16953    5                           DO_ILS$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ = SEARCH_DO$ ;
     1684    16954    5                       END ;
     1685    16955    4                 END ; /* CHECK_DO3 */
     1686    16956
     1687    16957    3                 IF NOT OPTIMIZE_DO3 THEN
     1688    16958    4                   DO ;
     1689    16959                          %ASSIGN_DO_ITEM_INFO ;
     1690    16977    4                     PREV_ILS$ = ILS$ ;
     1691    16978    4                     ILS$ = NEXT_ILS$ ;
     1692    16979    4                   END ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:59   
     1693    16980        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:60   
     1694    16981        /*V*
     1695    16982            DOEND -- The pointer to the previous DO or DOEND item is set and the
     1696    16983                     variables for the nesting level and  outer DO item
     1697    16984                     are reset.
     1698    16985        */
     1699    16986
     1700    16987    3              CASE (%DOEND) ;
     1701    16988                     %ASSIGN_DOEND_INFO ;
     1702    16997    3                PREV_ILS$ = ILS$ ;
     1703    16998    3                ILS$ = NEXT_ILS$ ;
     1704    16999        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:61   
     1705    17000        /*V*
     1706    17001            PFORM -- Error checking for null pforms and recursive performs are done.
     1707    17002                     A check is also made to see if the perform code group can be
     1708    17003                     either transfered in line or copied in line.
     1709    17004        */
     1710    17005
     1711    17006
     1712    17007    3              CASE (%PFORM) ;
     1713    17008        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:62   
     1714    17009        /*V*
     1715    17010            PFORM_INITIALIZE -- Pointers used in the PFORM handling are assigned.
     1716    17011                                This includes pointers to the starting and ending
     1717    17012                                labels as well as the label following the end label.
     1718    17013        */
     1719    17014
     1720    17015    3                ILL$ -> PFORM.BRANCH$ = O2COM.SECTION$;
     1721    17016    3                ILL$ -> PFORM.DO$ = ADDR (NIL) ;
     1722    17017    3                DEFLB_FOLLOWS = FALSE  ; /* Usual case */
     1723    17018    3                TEMP$ = ILS$ ;
     1724    17019                     %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
     1725    17034    3                IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB
     1726    17035    4                  THEN DO ;
     1727    17036    4                    DEFLB_FOLLOWS = TRUE ; /* Next statement is a label. */
     1728    17037    4                    LABEL_AFTER_PFORM$ = TEMP$->ILS.ILL$->ILL.LOP ;
     1729    17038    4                  END ;
     1730    17039    3                START_LABEL$ = ILL$->ILL.LOP ;
     1731    17040
     1732    17041    3                IF START_LABEL$ = ADDR(NIL) THEN
     1733    17042    4                  DO ; /* If there is nothing to PERFORM then do not PERFORM it */
     1734    17043    4                    PREV_ILS$->ILS.NEXT = NEXT_ILS$ ;
     1735    17044    4                    ILS$ = NEXT_ILS$ ;
     1736    17045    4                    EXIT CASE_STMT ;
     1737    17046    4                  END ;
     1738    17047
     1739    17048    3                START_LABEL_ILS$ = START_LABEL$->LABEL.PREV_ILS$ ;
     1740    17049                     /* Find start label. %NEXT_NON_SUPPORT will not quite do it,
     1741    17050                        because the start label could be a program entry point. */
     1742    17051    4                DO UNTIL START_LABEL_ILS$->ILS.ILL$ ~= ADDR (NIL) AND
     1743    17052    4                    START_LABEL_ILS$->ILS.ILL$->ILL.ID = %DEFLB ;
     1744    17053                       %NEXT_ILS (POINTER=START_LABEL_ILS$) ;
     1745    17058    4                END ;
     1746    17059    4                IF START_LABEL$->LABEL.B.ENTRY_POINT THEN DO ; /*#35059*/
     1747    17060                       /* Program entry ... need to bypass %ENTRY and find
     1748    17061                          compiler-created label after it. */
     1749    17062    5                  DO UNTIL START_LABEL_ILS$->ILS.ILL$->ILL.ID = %DEFLB ;
     1750    17063                         %NEXT_ILS (POINTER=START_LABEL_ILS$) ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:63   
     1751    17068    5                  END ;
     1752    17069    4                  START_LABEL$ = START_LABEL_ILS$->ILS.ILL$->ILL.LOP ;
     1753    17070    4                  ILL$->ILL.LOP = START_LABEL$ ; /* Start here */
     1754    17071    4                END ;
     1755    17072    3                END_LABEL$ = ILL$->ILL.ROP ;
     1756    17073    3                END_LABEL_ILS$ = END_LABEL$->LABEL.PREV_ILS$ ;
     1757    17074                     %NEXT_NON_SUPPORT (POINTER=END_LABEL_ILS$) ;
     1758    17089    3                NEXT_LABEL$ = END_LABEL_ILS$ ;
     1759    17090                     %NEXT_NON_SUPPORT (POINTER=NEXT_LABEL$) ;
     1760    17105
     1761    17106                     /* Always check for null PERFORM */
     1762    17107    3                NULL_PFORM_CHECK$ = START_LABEL_ILS$ ;
     1763    17108    4                DO UNTIL(NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %DEFLB
     1764    17109    4                    AND NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %LINOI
     1765    17110    4                    AND NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %PREOFF
     1766    17111    4                    AND NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %PRESET
     1767    17112    4                    AND NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %P_A_PRESET
     1768    17113    4                    AND NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %P_P_PRESET
     1769    17114    4                    AND NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %PTR_SET) ;
     1770    17115                       %NEXT_ILS (POINTER=NULL_PFORM_CHECK$) ;
     1771    17120    4                  IF NULL_PFORM_CHECK$ = END_LABEL_ILS$ THEN
     1772    17121    5                    DO ;
     1773    17122                           %NULL_PFORM_WARNING ;
     1774    17132    5                      EXIT CASE_STMT ;
     1775    17133    5                    END ;
     1776    17134    4                  IF NULL_PFORM_CHECK$ = ADDR(NIL) /* BACKWARD PERFORM  */
     1777    17135    4                      THEN EXIT ;
     1778    17136    4                END ;
     1779    17137
     1780    17138        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:64   
     1781    17139        /*E*
     1782    17140              ERROR:  RECURSIVE_PERFORM
     1783    17141            MESSAGE:  This PERFORM may be recursive.
     1784    17142        DESCRIPTION:  This message is printed when the start label of a PERFORM
     1785    17143                      is before the PERFORM and the end label is after it.  The phase_2
     1786    17144                      bit means that the label is in the program flow before our current
     1787    17145                      position so they are used to check for a recursive PERFORM.
     1788    17146        */
     1789    17147
     1790    17148    3                IF START_LABEL$->LABEL.B.PHASE_2 AND NOT(END_LABEL$->LABEL.B.PHASE_2)
             17148                         THEN
     1791    17149
     1792    17150    3                  CALL Z8AE$ERROR (%E$RECURSIVE_PERFORM) ;
     1793    17151        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:65   
     1794    17152        /*V*
     1795    17153            PFORM_search_refd_labels --
     1796    17154                 If the starting and ending labels are referenced only once then the
     1797    17155                 PFORM might be able to be transferred in line.  A search is made
     1798    17156                 of the labels if any between the starting and ending labels to see
     1799    17157                 if there are any non compiler created labels that are referenced
     1800    17158                 between these two points as this would preclude the transfer of code.
     1801    17159                 This check is bypassed in case of the NOPTZ option.
     1802    17160        */
     1803    17161
     1804    17162    3                ELSE IF COMCOM.OB.OPTZ AND NOT COMCOM.OB.COUNT
     1805    17163                             %SEGMENT_OPTZ_CHECK;
     1806    17166    4                  THEN DO;
     1807    17167    4                  PERF_LABEL_CHECK = START_LABEL_ILS$ ;
     1808    17168
     1809    17169    4                  IF START_LABEL$->LABEL.B.ONE_REF AND END_LABEL$->LABEL.B.ONE_REF AND
     1810    17170    4                     NOT (START_LABEL$->LABEL.B.FALL_THRU) THEN
     1811    17171    5                    DO ;
     1812    17172    6                      DO UNTIL ((PERF_LABEL_CHECK->ILS.ILL$->ILL.LOP->LABEL.B.
             17172                               REFERENCED AND
     1813    17173    6                                 NOT (PERF_LABEL_CHECK->ILS.ILL$->ILL.LOP->LABEL.B.
             17173                                          COMPILER_CREATED)) OR
     1814    17174    6                                PERF_LABEL_CHECK->ILS.ILL$->ILL.LOP = END_LABEL$) ;
     1815    17175    6                        PERF_LABEL_CHECK = PERF_LABEL_CHECK->ILS.ILL$->ILL.LBL ;
     1816    17176    6                        IF PERF_LABEL_CHECK = ADDR(NIL)
     1817    17177                                           /* PERFORM START LABEL AFTER END LABEL    */
     1818    17178    6                        THEN EXIT ;
     1819    17179    6                      END ;
     1820    17180    5                    END ;
     1821    17181        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:66   
     1822    17182        /*V*
     1823    17183            TRANSFER_IN_LINE -- The code group can be transferred in line if there
     1824    17184                                are no referenced labels inbetween the starting
     1825    17185                                and ending labels.
     1826    17186
     1827    17187                                If the starting label has already been read then
     1828    17188                                then the IF, DO and DEFLB linked lists must be
     1829    17189                                updated which is handled in Z8FS$SRCH_IF_DO_LBL.
     1830    17190
     1831    17191                                The code group is then linked into the ILS at its
     1832    17192                                new location and all the LINOIs transfered are
     1833    17193                                updated to their new line number.  The label following
     1834    17194                                the end label has its FALL_THRU bit turned off.
     1835    17195                                The label can't be reached by falling thru because the
     1836    17196                                paragraph that preceded it couldn't be reached
     1837    17197                                by falling thru.
     1838    17198
     1839    17199                                This check is bypassed for the NOPTZ option.
     1840    17200        */
     1841    17201        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:67   
     1842    17202    4                  IF PERF_LABEL_CHECK = END_LABEL_ILS$ THEN
     1843    17203    5                    DO ;
     1844    17204
     1845    17205    5                      IF START_LABEL$->LABEL.B.PHASE_2 THEN
     1846    17206    5                        CALL Z8FS$SRCH_IF_DO_LBL(START_LABEL$, END_LABEL$) ;
     1847    17207    5                      PREV_ILS$->ILS.NEXT = START_LABEL_ILS$->ILS.NEXT ;
     1848    17208    5                      START_LABEL$->LABEL.PREV_ILS$->ILS.NEXT = END_LABEL_ILS$->ILS.
             17208                               NEXT ;
     1849    17209
     1850    17210    5                      PERF_LABEL_CHECK = NEXT_LABEL$ ;
     1851    17211    5                      IF PERF_LABEL_CHECK->ILS.ILL$->ILL.ID = %DEFLB THEN
     1852    17212    5                        PERF_LABEL_CHECK->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ =
             17212                                 START_LABEL$->LABEL.PREV_ILS$ ;
     1853    17213    5                      END_LABEL$->LABEL.PREV_ILS$->ILS.NEXT = NEXT_ILS$ ;
     1854    17214    5                      ILS$$ = PREV_ILS$ ;
     1855    17215    5                      ILS$ = PREV_ILS$ ;
     1856    17216                           %NEXT_ILS ;
     1857    17221
     1858    17222    6                      DO WHILE ILS$ ~= NEXT_ILS$ ;
     1859    17223    6                        IF ILS$->ILS.ILL$->ILL.ID = %LINOI THEN
     1860    17224    6                          ILS$->ILS.ILL$->LINOI.LINE_NO = COMCOM.CURRENT.LINE ;
     1861    17225    6                        ILS$$ = ILS$ ;
     1862    17226                             %NEXT_ILS ;
     1863    17231    6                      END ;
     1864    17232
     1865    17233    5                      IF DEFLB_FOLLOWS
     1866    17234    5                        THEN LABEL_AFTER_PFORM$->LABEL.PREV_ILS$ = ILS$$ ;
     1867    17235    5                      IF START_LABEL$->LABEL.B.PHASE_2
     1868    17236    6                        THEN DO ; /* Flow analysis already done on this code. */
     1869    17237    6                          PREV_ILS$ = ILS$$ ;
     1870    17238    6                          ILS$ = NEXT_ILS$ ;
     1871    17239    6                        END ;
     1872    17240    6                        ELSE DO ;
     1873    17241    6                          ILS$ = PREV_ILS$ ;
     1874    17242                               %NEXT_NON_SUPPORT ;
     1875    17257    6                          START_LABEL$->LABEL.B.PHASE_2 = TRUE ;
     1876    17258    6                          SEARCH_ILS$ = REF_DEFLB ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:68   
     1877    17259    7                          DO WHILE SEARCH_ILS$->ILS.ILL$->ILL.LBL ~= START_LABEL_ILS$ ;
     1878    17260    7                            SEARCH_ILS$ = SEARCH_ILS$->ILS.ILL$->ILL.LBL ;
     1879    17261    7                          END ;
     1880    17262    6                          SEARCH_ILS$->ILS.ILL$->ILL.LBL = END_LABEL_ILS$->ILS.ILL$->
             17262                                   ILL.LBL ;
     1881    17263    6                        END ;
     1882    17264
     1883    17265    5                        END_LABEL_ILS$->ILS.ILL$->ILL.LBL = REF_DEFLB->ILS.ILL$->ILL.
             17265                                 LBL ;
     1884    17266    5                        REF_DEFLB->ILS.ILL$->ILL.LBL = START_LABEL_ILS$ ;
     1885    17267
     1886    17268    5                      IF NEXT_LABEL$->ILS.ILL$->ILL.ID = %DEFLB THEN
     1887    17269    5                        NEXT_LABEL$->ILS.ILL$->ILL.LOP->LABEL.B.FALL_THRU = FALSE ;
     1888    17270
     1889    17271    5                      EXIT CASE_STMT ;
     1890    17272    5                    END ;
     1891    17273
     1892    17274        /*V*
     1893    17275        COPY_CHECK -- Check to see if the perform group is small enough to
     1894    17276                      make it beneficial to bring a copy in-line.  Count the
     1895    17277                      number of statements and compare them against the
     1896    17278                      decision breakpoint.  If they are less than the
     1897    17279                      breakpoint and there are no label references, then make a
     1898    17280                      copy of the ILS entries for the code group and link
     1899    17281                      them in line.
     1900    17282        */
     1901    17283
     1902    17284
     1903    17285    4                  PERF_STATEMENT_CHECK = START_LABEL$->LABEL.PREV_ILS$ ;
     1904    17286                       %NEXT_NON_SUPPORT (POINTER=PERF_STATEMENT_CHECK) ;
     1905    17301    4                  STATEMENT_COUNT = 0 ;
     1906    17302
     1907    17303    5                    DO UNTIL (STATEMENT_COUNT > %#_STATEMENTS OR
     1908    17304    5                       PERF_STATEMENT_CHECK = END_LABEL_ILS$) ;
     1909    17305    6                      DO CASE (PERF_STATEMENT_CHECK->ILS.ILL$->ILL.ID) ;
     1910    17306
     1911    17307    6                        CASE (%LINOI, %DEFLB, %PREOFF, %PRESET, %P_A_PRESET,
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:69   
     1912    17308    6                              %PTR_SET, %P_P_PRESET);
     1913    17309                               %NEXT_ILS (POINTER=PERF_STATEMENT_CHECK) ;
     1914    17314
     1915    17315    6                        CASE (%GO,%PFORM,%DO1,%DO2,%DO3,%DO4,%DO5/*,%DO6 */,
     1916    17316    6                              %STOP,%EXIT_PROG,%USER_CALL,%OS_CALL) ;
     1917    17317
     1918    17318
     1919    17319    6                          STATEMENT_COUNT = %(#_STATEMENTS + 1) ;
     1920    17320
     1921    17321    6                        CASE (ELSE) ;
     1922    17322    6                          STATEMENT_COUNT = STATEMENT_COUNT + 1 ;
     1923    17323                               %NEXT_ILS (POINTER=PERF_STATEMENT_CHECK) ;
     1924    17328
     1925    17329    6                      END ;
     1926    17330    5                      IF PERF_STATEMENT_CHECK = ADDR(NIL) THEN
     1927    17331    5                          STATEMENT_COUNT=%(#_STATEMENTS + 1) ;
     1928    17332    5                    END ;
     1929    17333        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:70   
     1930    17334        /*V*
     1931    17335            COPY_CODE_IN_LINE --
     1932    17336                If the number of statements is below the decision breakpoint then
     1933    17337                copy it in line.  This is done by searching the code group and
     1934    17338                creating copies of the ILS entries.
     1935    17339
     1936    17340                If a label or preset is encountered then no copy is made of the ILS
     1937    17341                entry as this would cause problems in the created OU.  If a LINOI
     1938    17342                is found then we set the line type to %NO_STATEMENT_TYPE so the LS is
     1939    17343                created correctly.  If any other items are found then a copy is made of
     1940    17344                the ILS entry.
     1941    17345
     1942    17346                This is not done in case of the NOPTZ option.
     1943    17347        */
     1944    17348
     1945    17349    4                  IF STATEMENT_COUNT < %#_STATEMENTS THEN
     1946    17350    5                    DO ;
     1947    17351    5                      INITIAL_ILS$ = START_LABEL_ILS$ ;
     1948    17352                           %NEXT_ILS (POINTER=INITIAL_ILS$) ;
     1949    17357    5                      COPY_ILS$ = PREV_ILS$ ;
     1950    17358                           %NEXT_ILS (POINTER=COPY_ILS$) ;
     1951    17363
     1952    17364    6                      DO UNTIL (INITIAL_ILS$->ILS.NEXT = END_LABEL_ILS$) ;
     1953    17365
     1954    17366    7                        DO SELECT(INITIAL_ILS$->ILS.ILL$->ILL.ID) ;
     1955    17367
     1956    17368    7                          SELECT(%DEFLB, %PTR_SET, %PRESET, %P_A_PRESET, %PREOFF, %
             17368                                   P_P_PRESET) ;
     1957    17369
     1958    17370                                 %NEXT_ILS (POINTER=INITIAL_ILS$) ;
     1959    17375
     1960    17376    7                          SELECT(%LINOI) ;
     1961    17377    7                            INITIAL_ILS$->ILS.ILL$->LINOI.TYPE =
     1962    17378    7                              %NO_STATEMENT_TYPE ;
     1963    17379                                 %COPY_ILS_ENTRY ;
     1964    17424
     1965    17425    7                          SELECT(ELSE) ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:71   
     1966    17426                                 %COPY_ILS_ENTRY ;
     1967    17471
     1968    17472    7                        END ;
     1969    17473    6                      END ;
     1970    17474
     1971    17475    5                      COPY_ILS$->ILS.NEXT = NEXT_ILS$ ;
     1972    17476    5                      IF DEFLB_FOLLOWS
     1973    17477    5                        THEN LABEL_AFTER_PFORM$->LABEL.PREV_ILS$ = COPY_ILS$ ;
     1974    17478    5                      FALL_THRU_FLAG = 1 ; /* Fall thru possible */
     1975    17479    5                      ILS$ = PREV_ILS$ ;
     1976    17480                           %NEXT_ILS ;
     1977    17485                           %NEXT_ILS ;
     1978    17490    5                      EXIT CASE_STMT ;
     1979    17491    5                    END ;
     1980    17492        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:72   
     1981    17493        /*V*
     1982    17494            ASSIGN_PFORM_INFO -- The PFORM cannot be transfered or copied in line
     1983    17495                                 so it is left as a PFORM.
     1984    17496
     1985    17497                                 If OPTZ and PERFORM n TIMES then remember location
     1986    17498                                 of the DO2's ILS item.
     1987    17499
     1988    17500                                 The paragraph and section that the PFORM are located
     1989    17501                                 in are marked as containing a PFORM statement.
     1990    17502                                 The PFORM is then linked into the list of PFORMs.
     1991    17503        */
     1992    17504    4                END;
     1993    17505
     1994    17506    3                IF PREV_ILS$->ILS.ILL$->ILL.ID = %DO2 THEN
     1995    17507    3                  ILL$->PFORM.DO$ = DO_LINOI$ ;
     1996    17508
     1997    17509    3                IF O2COM.LAST_LBL$ ~= ADDR(NIL) THEN
     1998    17510    4                  DO ;
     1999    17511    4                    O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.B.PFORM_NESTED = TRUE ;
     2000    17512
     2001    17513    4                    IF O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.SECTION$ ~= ADDR(NIL)
             17513                             AND
     2002    17514    4                       O2COM.LAST_LBL$ -> ILS.ILL$ -> ILL.LOP ->
     2003    17515    4                         LABEL.SECTION$ -> LABEL.ID = %SECTION THEN
     2004    17516    4                      O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.SECTION$->LABEL.B.
             17516                               PFORM_NESTED = TRUE ;
     2005    17517    4                  END ;
     2006    17518
     2007    17519    3                IF COMCOM.H_PFORM = ADDR(NIL) THEN
     2008    17520    3                  COMCOM.H_PFORM = ILS$ ;
     2009    17521    3                ELSE
     2010    17522    3                  O2COM.PFORM_LIST$->ILS.ILL$->PFORM.PFORM_LIST$ = ILS$ ;
     2011    17523    3                O2COM.PFORM_LIST$ = ILS$ ;
     2012    17524
     2013    17525    3                PREV_ILS$ = ILS$ ;
     2014    17526    3                ILS$ = NEXT_ILS$ ;
     2015    17527
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:73   
     2016    17528        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:74   
     2017    17529        /*V*
     2018    17530            ALTER -- The left operand of the ILL (which points to the switch variable)
     2019    17531                     may be NILL due to Z8FL$LABEL_REFERENCE.  If it is then the
     2020    17532                     ALTER will be deleted otherwise a BASE item is created above
     2021    17533                     the SWITCH.
     2022    17534        */
     2023    17535    3              CASE (%ALTER) ;
     2024    17536    3                IF ILL$->ILL.LOP = ADDR(NIL) THEN
     2025    17537    3                  PREV_ILS$->ILS.NEXT = NEXT_ILS$ ;
     2026    17538    3                ELSE
     2027    17539    4                  DO ;
     2028    17540    4                    IF ILL$ -> ILL.LOP -> ETT.ID = %BASE THEN
     2029    17541                           /* Flow analysis already done on this ALTER, probably
     2030    17542                              because a PERFORM code group was copied in-line. */
     2031    17543    4                                                              ;
     2032    17544    4                      ELSE
     2033    17545    4                        CALL Z8AF$NEW_BASE (ILL$ -> ILL.LOP -> LABEL.POINTER$,
     2034    17546    4                                            ADDR(NIL),
     2035    17547    4                                            ILL$ -> ILL.LOP) ;
     2036    17548
     2037    17549    4                    IF ILS$->ILS.ID = %OPV
     2038    17550    4                    THEN ILS$->ILS.DNAME = ILL$->ILL.LOP ;
     2039    17551    4                    FALL_THRU_FLAG = 1 ; /* Fall thru possible */
     2040    17552
     2041    17553    4                    PREV_ILS$ = ILS$ ;
     2042    17554    4                  END ;
     2043    17555
     2044    17556    3                ILS$ = NEXT_ILS$ ;
     2045    17557        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:75   
     2046    17558        /*V*
     2047    17559            MVII -- Two consecutive MVIIs may represent a DIVIDE statement with
     2048    17560                    remainder. If so, optimize them to a DV4I.
     2049    17561        */
     2050    17562    3              CASE (%MVII) ;
     2051    17563    3                ILS$$ = ILS$ ;
     2052    17564                     %NEXT_NON_SUPPORT (POINTER=ILS$$) ;
     2053    17579    3                TEMP$ = ILS$$->ILS.ILL$ ;
     2054    17580    3                IF ILL$->ILL.ROP->ETT.ID = %DVI
     2055    17581    3                    AND TEMP$->ILL.ID = %MVII
     2056    17582    3                    AND TEMP$->ILL.ROP->ETT.ID = %SBI
     2057    17583    3                    AND ILL$->ILL.ROP->ETT.LOP = TEMP$->ILL.ROP->ETT.LOP
     2058    17584    3                    AND TEMP$->ILL.ROP->ETT.ROP->ETT.ID = %MPI
     2059    17585    3                    AND ILL$->ILL.LOP = TEMP$->ILL.ROP->ETT.ROP->ETT.ROP
     2060    17586    3                    AND ILL$->ILL.ROP->ETT.ROP = TEMP$->ILL.ROP->ETT.ROP->ETT.LOP THEN
     2061    17587    4                  DO ;
     2062    17588    4                    ILL$$ = ILL$ ;
     2063    17589    4                    IF ILS$->ILS.B.CDEF OR ILS$$->ILS.B.CDEF THEN
     2064    17590    5                      DO ; /* Simple case, common redefinition */
     2065    17591                             %RESERVE_ILL (POINTER=ILL$, ITEM=%DV4I) ;
     2066    17601    5                        ILS$->ILS.ID = %OPA ; /* Length same for OPV, OPA */
     2067    17602    5                        ILS$->ILS.B.CDEF = TRUE ;
     2068    17603    5                        ILS$->ILS.ILL$ = ILL$ ;
     2069    17604    5                        PREV_ILS$ = ILS$ ;
     2070    17605    5                      END ;
     2071    17606    4                    ELSE
     2072    17607    5                      DO ;
     2073    17608    6                        DO UNTIL PREV_ILS$->ILS.NEXT = ILS$ ;
     2074    17609                               %NEXT_ILS (POINTER=PREV_ILS$) ;
     2075    17614    6                        END ;
     2076    17615    5                        ADDR(TEMP_ILS_LIST)->ILS_LIST.ID = %ILS_LIST ;
     2077    17616    5                        ADDR(TEMP_ILS_LIST)->ILS_LIST.HEAD$ = ADDR(NIL) ;
     2078    17617    5                        ADDR(TEMP_ILS_LIST)->ILS_LIST.TAIL$ = ADDR(NIL) ;
     2079    17618    5                        CALL Z8AN$NEW_ILL2 (%TWO_REDEFS, %DV4I, ILL$,
     2080    17619    5                            ADDR (TEMP_ILS_LIST), ILL$->ILL.LOP, TEMP$->ILL.LOP) ;
     2081    17620                             /* One could replicate the complex logic for building the
     2082    17621                                DPI chain in this module, but that would make it
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:76   
     2083    17622                                necessary to update it here too any time it is changed
     2084    17623                                in Z8AN. It is easier and safer to rely on the module
     2085    17624                                that already knows how to set up the DPI chain. */
     2086    17625    5                        ADDR(TEMP_ILS_LIST)->ILS_LIST.TAIL$->ILS.NEXT = NEXT_ILS$ ;
     2087    17626    5                        PREV_ILS$->ILS.NEXT = ADDR(TEMP_ILS_LIST)->ILS_LIST.TAIL$ ;
     2088    17627    5                        PREV_ILS$ = ADDR(TEMP_ILS_LIST)->ILS_LIST.TAIL$ ;
     2089    17628                             /* TEMP_ILS_LIST.HEAD$ usually will point to the ILS for a
     2090    17629                                LINOI, which can be disregarded because there is
     2091    17630                                already a suitable LINOI available. */
     2092    17631    5                      END ;
     2093    17632    4                    ILL$->DV4I.LOP = ILL$$->ILL.ROP->ETT.LOP ;
     2094    17633    4                    ILL$->DV4I.ROP = ILL$$->ILL.ROP->ETT.ROP ;
     2095    17634    4                    ILL$->DV4I.TO_ = ILL$$->ILL.LOP ;
     2096    17635    4                    ILL$->DV4I.REMAINDER = TEMP$->ILL.LOP ;
     2097    17636    4                    ILS$$->ILS.ILL$ = ADDR(NIL) ;
     2098    17637    4                  END ;
     2099    17638    3                ELSE
     2100    17639    3                  PREV_ILS$ = ILS$ ;
     2101    17640
     2102    17641    3                FALL_THRU_FLAG = 1 ; /* Fall thru possible */
     2103    17642    3                ILS$ = NEXT_ILS$ ;
     2104    17643        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:77   
     2105    17644        /*V*
     2106    17645            CALL -- External calls may cause registers not to be preserved. The
     2107    17646                    PERFORM handler needs to be notified so it can arrange for X7
     2108    17647                    to be preserved if necessary.
     2109    17648        */
     2110    17649    3              CASE (%OS_CALL, %USER_CALL, %ACCEP, %DISPL) ;
     2111    17650    3                IF O2COM.LAST_LBL$ ~= ADDR(NIL) THEN
     2112    17651    4                  DO ;
     2113    17652    4                    O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.B.PFORM_NESTED = TRUE ;
     2114    17653
     2115    17654    4                    IF O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.SECTION$ ~= ADDR(NIL)
             17654                             AND
     2116    17655    4                       O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.SECTION$ ->
     2117    17656    4                          LABEL.ID = %SECTION THEN
     2118    17657    4                      O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.SECTION$->LABEL.B.
             17657                               PFORM_NESTED = TRUE ;
     2119    17658    4                  END ;
     2120    17659    3                IF ILL$->ILL.ID = %USER_CALL THEN
     2121    17660    3                  CALL OPTIMIZE_CALL (ILL$->USER_CALL.DESTINATION$)
     2122    17661    4                    WHENRETURN DO ;
     2123    17662    4                      EXIT CASE_STMT ;
     2124    17663    4                    END ;
     2125    17664                     /* ELSE cannot optimize call. */
     2126    17665    3                FALL_THRU_FLAG = 1 ; /* Fall thru possible */
     2127    17666    3                PREV_ILS$ = ILS$ ;
     2128    17667    3                ILS$ = NEXT_ILS$ ;
     2129    17668        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:78   
     2130    17669        /*V*
     2131    17670            LINOI -- The current line and column numbers are updated.
     2132    17671        */
     2133    17672
     2134    17673    3              CASE (%LINOI) ;
     2135    17674
     2136    17675    4                IF ILL$->LINOI.TYPE ~= %NO_STATEMENT_TYPE THEN DO ;
     2137    17676    4                  COMCOM.CURRENT.LINE = ILL$->LINOI.LINE_NO ;
     2138    17677    4                  COMCOM.CURRENT.COLUMN = ILL$->LINOI.COLUMN_NO ;
     2139    17678    4                END ;
     2140    17679
     2141    17680    3                ILS$ = NEXT_ILS$ ;
     2142    17681        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:79   
     2143    17682        /*V*
     2144    17683            STOP -- No special action, except turn off the FALL_THRU_FLAG.
     2145    17684        */
     2146    17685    3              CASE (%STOP, %USE_END) ;
     2147    17686    3                FALL_THRU_FLAG = 0 ; /* Fall thru not possible */
     2148    17687
     2149    17688    3                PREV_ILS$ = ILS$ ;
     2150    17689    3                ILS$ = NEXT_ILS$ ;
     2151    17690        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:80   
     2152    17691        /*V*
     2153    17692            EXIT_PROGRAM -- If in a subroutine, it merely requires turning off the
     2154    17693                            FALL_THRU_FLAG. In a main program it is optimized out
     2155    17694                            and a warning message is issued.
     2156    17695        */
     2157    17696    3              CASE (%EXIT_PROG) ;
     2158    17697    3                IF ENTRY_TYPE = %MAIN_PROGRAM
     2159    17698    4                    AND NOT COMCOM.OB.TP8 THEN DO ;
     2160    17699    4                  PREV_ILS$->ILS.NEXT = NEXT_ILS$ ; /* Optimize it out. */
     2161    17700    4                  CALL Z8AE$ERROR (%E$CANT_EXIT) ;
     2162    17701        /*E*
     2163    17702              ERROR:  CANT_EXIT
     2164    17703            MESSAGE:  EXIT PROGRAM in main program ignored.
     2165    17704        DESCRIPTION:  The standard specifies that it is legal to have the
     2166    17705                      EXIT-PROGRAM statement in a main program, and that if this
     2167    17706                      is done no action should be taken. Control goes on to the
     2168    17707                      next statement.
     2169    17708        */
     2170    17709    4                  TEMP$ = ILS$ ;
     2171    17710                       %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
     2172    17725    4                  IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB THEN
     2173    17726    4                    TEMP$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ = PREV_ILS$ ;
     2174    17727                         /* If label after the EXIT PROGRAM then adjust its PREV_ILS$. */
     2175    17728    4                END ;
     2176    17729    4                ELSE DO ;
     2177    17730    4                  IF CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.EXIT_PROG_IN_DECL
     2178    17731                           %IF CP6;
     2179    17732    4                      AND ENTRY_TYPE = %SUBROUTINE
     2180    17733                           %ENDIF ;
     2181    17734    4                      THEN
     2182    17735    5                    IF NOT EXIT_PROG_FOUND THEN DO ;
     2183    17736                           /* EXIT PROGRAM in any USE procedure can only terminate
     2184    17737                              all active USE procedures, and then UNWIND to an
     2185    17738                              EXIT PROGRAM statement in the program. Insert a
     2186    17739                              compiler-created label before it, for EXIT
     2187    17740                              PROGRAM to unwind to. */
     2188    17741                           %RESERVE_ILS (ITEM=%OPN, POINTER=ILS$$) ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:81   
     2189    17770                           %RESERVE_ILL (ITEM=%LINOI, POINTER=ILS$$->ILS.ILL$) ;
     2190    17780    5                      ILS$$->ILS.ILL$->LINOI.PREV_COL = COMCOM.CURRENT.COLUMN ;
     2191    17781    5                      ILS$$->ILS.ILL$->LINOI.COLUMN_NO = COMCOM.CURRENT.COLUMN ;
     2192    17782    5                      ILS$$->ILS.ILL$->LINOI.PREV_LINE = COMCOM.CURRENT.LINE ;
     2193    17783    5                      ILS$$->ILS.ILL$->LINOI.LINE_NO = COMCOM.CURRENT.LINE ;
     2194    17784                           %RESERVE_ILS (ITEM=%OPN, POINTER=ILS$$->ILS.NEXT) ;
     2195    17813    5                      ILS$$->ILS.NEXT->ILS.NEXT = NEXT_ILS$ ;
     2196    17814    5                      ILS$->ILS.NEXT = ILS$$ ;
     2197    17815                           %NEXT_ILS (POINTER=ILS$$) ;
     2198    17820    5                      ILS$$->ILS.ILL$ = ILL$ ;
     2199    17821                           %RESERVE_ILL (ITEM=%DEFLB, POINTER=ILS$->ILS.ILL$) ;
     2200    17831    5                      ILS$->ILS.ILL$->ILL.LOP = EXIT_PROG$ ;
     2201    17832    5                      EXIT_PROG$->LABEL.PREV_ILS$ = PREV_ILS$ ;
     2202    17833                           %ASSIGN_LABEL_INFO (@ILL$=ILS$->ILS.ILL$) ;
     2203    17852    5                      IF FALL_THRU_FLAG ~= 0 THEN
     2204    17853    5                        EXIT_PROG$->LABEL.B.FALL_THRU = TRUE ;
     2205    17854    5                      EXIT_PROG$->LABEL.B.PHASE_2 = TRUE ;
     2206    17855    5                      TEMP$ = ILS$$ ;
     2207    17856                           %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
     2208    17871    5                      IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB THEN
     2209    17872    5                        TEMP$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ = ILS$$ ;
     2210    17873    5                      EXIT_PROG_FOUND = TRUE ;
     2211    17874    5                      FALL_THRU_FLAG = 1 ;
     2212    17875    5                    END ;
     2213    17876    4                  CALL RESTORE_IO_CHAIN ;
     2214    17877    4                  ILL$->ILL.LOP = CURRENT_PROC$ ;
     2215    17878    4                  FALL_THRU_FLAG = 0 ; /* Fall thru not possible */
     2216    17879    4                  PREV_ILS$ = ILS$ ;
     2217    17880    4                END ;
     2218    17881
     2219    17882    3                ILS$ = NEXT_ILS$ ;
     2220    17883        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:82   
     2221    17884        /*V*
     2222    17885            NON_GENERATING -- For ILL items that cannot generate any code, just
     2223    17886                              go on to the next without touching FALL_THRU_FLAG.
     2224    17887        */
     2225    17888    3              CASE (%PREOFF,%PRESET,%P_A_PRESET,%PTR_SET,%PEND, %P_P_PRESET) ;
     2226    17889    3                PREV_ILS$ = ILS$ ;
     2227    17890    3                ILS$ = NEXT_ILS$ ;
     2228    17891        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:83   
     2229    17892        /*V*
     2230    17893            END -- If necessary then insert a STOP or EXIT_PROG before it.
     2231    17894        */
     2232    17895    3              CASE (%END, %END_PROG) ;
     2233    17896    3                IF FALL_THRU_FLAG ~= 0
     2234    17897    3                    OR NOT EXIT_PROG_FOUND
     2235    17898    3                       AND EXIT_PROG$ ~= ADDR (NIL)
     2236    17899    3                       AND CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.
             17899                                EXIT_PROG_IN_DECL
     2237    17900                            %IF CP6 ;
     2238    17901    3                       AND ENTRY_TYPE = %SUBROUTINE
     2239    17902                            %ENDIF ;
     2240    17903    3                  THEN CALL INSERT_STOP_OR_EXIT ;
     2241    17904    3                FALL_THRU_FLAG = -1 ; /* Beginning of next program if any */
     2242    17905    3                PREV_ILS$ = ILS$ ;
     2243    17906    3                ILS$ = NEXT_ILS$ ;
     2244    17907        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:84   
     2245    17908        /*V*
     2246    17909            ELSE -- If the item belongs to none of the above optimizations it is sent
     2247    17910                    here. Just skip to the next ILS item.
     2248    17911        */
     2249    17912    3              CASE (ELSE) ;
     2250    17913
     2251    17914    3                FALL_THRU_FLAG = 1 ; /* Fall thru possible */
     2252    17915    3                PREV_ILS$ = ILS$ ;
     2253    17916    3                ILS$ = NEXT_ILS$ ;
     2254    17917
     2255    17918    3            END CASE_STMT ;
     2256    17919
     2257    17920    2          END CASE_LOOP ;
     2258    17921        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:85   
     2259    17922        /*V*
     2260    17923            SEQUENCING_PRESET --  If there were any PFORMs in the program then
     2261    17924                                  Z8FP$PFORM_CHECKING is called to operate on those
     2262    17925                                  items.  The initialization is done for the
     2263    17926                                  sequencing loop which includes assigning the
     2264    17927                                  starting ILS$(top of ILS), sequence number (1), and
     2265    17928                                  COMCOM.COMMON_REDEF (0).
     2266    17929        */
     2267    17930
     2268    17931    1          IF COMCOM.H_PFORM ~= ADDR(NIL) THEN
     2269    17932    2            DO ;
     2270    17933    2              O2COM.PFORM_LIST$->ILS.ILL$->PFORM.PFORM_LIST$ = ADDR(NIL) ;
     2271    17934    2              CALL Z8FP$PFORM_CHECKING ;
     2272    17935    2            END ;
     2273    17936
     2274    17937         /* If any overlayable segments exist, the count fields
     2275    17938            of the labels need to be set equal to the count field of the
     2276    17939            segment they belong to */
     2277    17940
     2278    17941    1          IF COMCOM.SEGMENTC > 1 THEN
     2279    17942    2            DO;
     2280    17943    2              ILS$ = COMCOM.FIRST_ILS;
     2281    17944    2              CURRENT_SEG# = 0;
     2282    17945
     2283    17946    3              DO WHILE (ILS$ ~= ADDR(NIL));
     2284    17947
     2285    17948    3                IF ILS$ -> ILS.ILL$ ~= ADDR(NIL) AND
     2286    17949    3                  ILS$ -> ILS.ILL$ -> ILL.ID = %DEFLB THEN
     2287    17950    4                  DO;
     2288    17951    4                    IF ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.ID = %SECTION AND
     2289    17952    4                      ILS$ -> ILS.ILL$ -> ILL.LOP -> SECTION.SEGMENT$ ~= ADDR(NIL) THEN
     2290    17953    4                      CURRENT_SEG# = ILS$ -> ILS.ILL$ -> ILL.LOP ->
     2291    17954    4                            SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO#;
     2292    17955
     2293    17956    4                      ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.COUNT =
     2294    17957    4                          COMCOM.SEGMENT$(CURRENT_SEG#) -> SEGMENT.COUNT;
     2295    17958
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:86   
     2296    17959    4                  END;
     2297    17960
     2298    17961    3                ILS$ = ILS$ -> ILS.NEXT;
     2299    17962
     2300    17963    3              END;   /* DO WHILE */
     2301    17964    2          END;
     2302    17965
     2303    17966    1          ILS$ = COMCOM.FIRST_ILS ;
     2304    17967    1          PREV_ILS$ = ADDR(NIL) ;
     2305    17968    1          VAL_END$ = ADDR(NIL) ;
     2306    17969    1          COMCOM.H_ENTRY$ = ADDR(NIL) ;
     2307    17970    1          COMCOM.H_LBL = ADDR(NIL) ;
     2308    17971    1          COMCOM.COMMON_REDEF = 0 ;
     2309    17972    1          COMCOM.FIRST_ENTRY_SEQ_NUM = 0 ;
     2310    17973    1          CURRENT_SEQ_NO = 1 ;
     2311    17974        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:87   
     2312    17975    1          DOEND_FLAG = 1 ;
     2313    17976    2          DO WHILE (ILS$ ~= ADDR(NIL)) ;
     2314    17977
     2315    17978    3            DO CASE (ILS$->ILS.ID) ;
     2316    17979
     2317    17980        /*V*
     2318    17981            SINGLE_REDEF -- Assign the data item's forward definition point in its
     2319    17982                            ST entry.
     2320    17983        */
     2321    17984
     2322    17985    3              CASE (%OPV) ;
     2323    17986
     2324    17987                     %FISH(TRIAD=ILS$->ILS.DNAME, RTN=ST$) ;
     2325    17995    3                ILS$->ILS.RDEF = ST$ -> VARIABLE.SEQ#.FD ;
     2326    17996    3                ST$->VARIABLE.SEQ#.FD = CURRENT_SEQ_NO ;
     2327    17997    3                ST$->VARIABLE.SEQ#.BD = %MAX_SEQ# ;
     2328    17998
     2329    17999        /*V*
     2330    18000            MULTI_RDEF -- If the ILL item is GO_SUB or CALL then reassign the
     2331    18001                          field pointing to the previous GO_SUB or CALL item.
     2332    18002                          These items are identified by ILS.DEF = ADDR(NIL).
     2333    18003                          Search the DPI items and assign the forward defini-
     2334    18004                          tion point.
     2335    18005        */
     2336    18006
     2337    18007    3              CASE (%OPA) ;
     2338    18008    3                DPI$$ = ILS$->ILS.DEF ;
     2339    18009    3                IF DPI$$ = ADDR(NIL) THEN
     2340    18010        /*N*
     2341    18011            CALL_IMPLEMENT -- When CALLs are implemented they must be included
     2342    18012                              in this IF statement, if ILS.DEF could be ~= ADDR(NIL).
     2343    18013        */
     2344    18014
     2345    18015    4                  DO ;
     2346    18016    4                    ILS$->ILS.RDEF = COMCOM.COMMON_REDEF ;
     2347    18017    4                    COMCOM.COMMON_REDEF = CURRENT_SEQ_NO ;
     2348    18018    4                  END ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:88   
     2349    18019
     2350    18020    4                ELSE DO UNTIL DPI$$ = ADDR(NIL) ;
     2351    18021                            /* Let's go %FISHing */
     2352    18022                       %FISH(TRIAD=DPI$$->DPI.DNAME, RTN=ST$) ;
     2353    18030    4                  DPI$$->DPI.RDEF = ST$->VARIABLE.SEQ#.FD ;
     2354    18031    4                  ST$->VARIABLE.SEQ#.FD = CURRENT_SEQ_NO ;
     2355    18032    4                  ST$->VARIABLE.SEQ#.BD = CURRENT_SEQ_NO ;      /*#42183*/
     2356    18033    4                  DPI$$ = DPI$$ -> DPI.NEXT;
     2357    18034    4                END ;
     2358    18035
     2359    18036    3            END /* Case of ILS ID */ ;
     2360    18037        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:89   
     2361    18038    2            NEXT_ILS$ = ILS$ ;
     2362    18039                 %NEXT_ILS (POINTER=NEXT_ILS$) ;
     2363    18044    2            ILL$ = ILS$->ILS.ILL$ ;
     2364    18045    3            IF ILL$ ~= ADDR (NIL) THEN DO ;
     2365    18046        /*V*
     2366    18047            CHECK_INIT_PROC -- If the ILL item is %SCOPE then check the current
     2367    18048                               procedure's initialization procedure. If it exists but
     2368    18049                               is nil (it has nothing to initialize for CANCEL or
     2369    18050                               because of the INITIAL attribute) then delete it,
     2370    18051                               and set its pointer to show that there is now no
     2371    18052                               init proc.
     2372    18053        */
     2373    18054    4              IF ILL$->ILL.ID = %SCOPE THEN DO ;
     2374    18055    4                CURRENT_PROC$ = ILL$->SCOPE.PROC$ ;
     2375    18056    5                IF CURRENT_PROC$ ~= ADDR (NIL) THEN DO ;
     2376    18057                       /* Current procedure is not itself an initialization proc */
     2377    18058    6                  IF CURRENT_PROC$->PROC_.B.INLINE THEN DO ;
     2378    18059                         /* Procedure was optimized out. Now get rid of SCOPE,PEND. */
     2379    18060    6                    ILS$$ = ILS$ ;
     2380    18061    6                    ILS$->ILS.ILL$ = ADDR(NIL) ; /* Optimize out SCOPE */
     2381    18062                         %NEXT_NON_SUPPORT (POINTER=ILS$$) ;
     2382    18077    6                    ILS$$->ILS.ILL$ = ADDR(NIL) ; /* Also the PEND */
     2383    18078    6                  END ;
     2384    18079    6                  ELSE DO ;
     2385    18080    6                    ILS$$ = CURRENT_PROC$->PROC_.PROC_SUPP$->PROC_SUPP.INIT_PROC$ ;
     2386    18081    7                    IF ILS$$ ~= ADDR (NIL) THEN DO ; /* Init proc exists */
     2387    18082    7                      SEARCH_ILS$ = ILS$$->ILS.ILL$-> /* PTR to PTR_SET */
     2388    18083    7                          PRESET.ROP->LABEL.PREV_ILS$ ;
     2389    18084                           /* PTR_SET items use the same template as PRESET. */
     2390    18085    8                      DO UNTIL SEARCH_ILS$->ILS.ILL$->ILL.ID = %USE_ENTRY ;
     2391    18086                             %NEXT_ILS (POINTER=SEARCH_ILS$) ;
     2392    18091    8                      END ;
     2393    18092    7                      TEMP$ = SEARCH_ILS$ ; /* Found beginning of init proc */
     2394    18093                           %NEXT_NON_LINOI (POINTER=TEMP$) ;
     2395    18103    8                      IF TEMP$->ILS.ILL$->ILL.ID = %USE_END THEN DO ;
     2396    18104                             /* Nil init proc, nothing to initialize */
     2397    18105    8                        SEARCH_ILS$->ILS.ILL$ = ADDR (NIL) ; /* Optimize it out */
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:90   
     2398    18106    8                        TEMP$->ILS.ILL$ = ADDR (NIL) ;
     2399    18107    9                        IF ENTADDR_OF_NIL$ = ADDR (NIL) THEN DO ;
     2400    18108    9                          MKCN.CON = ENTADDR_OF_NIL_UBIN ;
     2401    18109    9                          CALL Z8AC$MAKE_CONST (ENTADDR_OF_NIL$) ;
     2402    18110    9                        END ;
     2403    18111                             %RESERVE_ILL (ITEM=%PREOFF, POINTER=TEMP$) ;
     2404    18121                             /* Create PREOFF item to show there is no init proc */
     2405    18122    8                        TEMP$->PREOFF.OFFSET = ILS$$->ILS.ILL$->PRESET.OFFSET ;
     2406    18123    8                        TEMP$->PREOFF.LOP = ILS$$->ILS.ILL$->PRESET.LOP ;
     2407    18124    8                        TEMP$->PREOFF.ROP = ENTADDR_OF_NIL$->ETT.LOP ;
     2408    18125    8                        TEMP$->PREOFF.N = 1 ;
     2409    18126    8                        ILS$$->ILS.ILL$ = TEMP$ ;
     2410    18127    8                      END ;
     2411    18128    7                    END ;
     2412    18129    6                  END ;
     2413    18130    5                END ;
     2414    18131    4              END ;
     2415    18132    4              ELSE IF ILL$->ILL.ID = %ENTRY THEN DO ;
     2416    18133        /*V*
     2417    18134            FIND_FIRST_ENTRY -- Notify later phases what the sequence number
     2418    18135                                is for the first ENTRY in the ILL.
     2419    18136        */
     2420    18137    4                IF COMCOM.FIRST_ENTRY_SEQ_NUM = 0 THEN
     2421    18138    4                  COMCOM.FIRST_ENTRY_SEQ_NUM = CURRENT_SEQ_NO ;
     2422    18139    4                ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ = COMCOM.H_ENTRY$;
     2423    18140    4                COMCOM.H_ENTRY$ = ILS$;
     2424    18141    4              END ;
     2425    18142    4              ELSE IF ILL$->ILL.ID = %USE_ENTRY THEN DO;
     2426    18143    4                ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ = COMCOM.H_ENTRY$;
     2427    18144    4                COMCOM.H_ENTRY$ = ILS$;
     2428    18145    4              END;
     2429    18146    3              ELSE IF ILL$->ILL.ID = %VAL_END AND VAL_END$ = ADDR(NIL) THEN
     2430    18147    3                VAL_END$ = ILL$;
     2431    18148    4              ELSE IF ILL$->ILL.ID = %LINOI AND VAL_END$ ~= ADDR(NIL) THEN DO;
     2432    18149    4                VAL_END$->VAL_END.LINOI$ = ILS$;
     2433    18150    4                VAL_END$ = ADDR(NIL);
     2434    18151    4              END;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:91   
     2435    18152
     2436    18153        /*V*
     2437    18154            DEAD_CODE_CHECK -- After each unconditional or altered GO that is not in
     2438    18155                               a GO vector (GO TO DEPENDING) and each STOP, look for
     2439    18156                               unreachable code, flag it as such, and delete it.
     2440    18157        */
     2441    18158    4              ELSE IF ILL$->ILL.ID = %DEFLB THEN DO ;
     2442    18159    5                IF ILL$->ILL.LOP->LABEL.B.GO_VECTOR_START THEN DO ;
     2443    18160    5                  GOTO_VECTOR = TRUE ;
     2444    18161    5                  VECTOR_END$ = ILL$->ILL.LOP->LABEL.P_END$ ;
     2445    18162    5                END ;
     2446    18163    4                ELSE IF ILL$->ILL.LOP = VECTOR_END$
     2447    18164    4                  THEN GOTO_VECTOR = FALSE ;
     2448    18165    5                ELSE IF ILL$->ILL.LOP->LABEL.B.LABEL_AFTER_USE THEN DO ;
     2449    18166    5                  ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ = COMCOM.H_ENTRY$;
     2450    18167    5                  COMCOM.H_ENTRY$ = ILS$;
     2451    18168    5                END ;
     2452    18169    4              END ;
     2453    18170
     2454    18171    3              IF NOT GOTO_VECTOR THEN
     2455    18172                          /* In a GOTO vector, suppress dead code check. */
     2456    18173    3                IF ILL$->ILL.ID = %STOP OR ILL$->ILL.ID = %EXIT_PROG
     2457    18174    3                   OR ILL$->ILL.ID = %USE_END OR (ILL$->ILL.ID = %GO AND
     2458    18175    3                    (ILL$->ILL.CODE = %GO_UNCONDITIONAL OR
     2459    18176    3                     ILL$->ILL.CODE = %GO_ALTERED)) OR DOEND_FLAG <= 0 THEN
     2460    18177    4   SCRAP_DEAD_CODE: DO ;
     2461    18178    5                  IF ILL$->ILL.ID = %GO AND ILL$->ILL.CODE = %GO_ALTERED THEN DO ;
     2462    18179    5                    SEARCH_ILS$ = ILS$ ;
     2463    18180                         %NEXT_NON_SUPPORT (POINTER=SEARCH_ILS$) ;
     2464    18195    5                    IF SEARCH_ILS$->ILS.ILL$->ILL.ID = %DEFLB THEN
     2465    18196    5                      IF SEARCH_ILS$->ILS.ILL$->ILL.LOP->LABEL.B.PFORM_74_END
     2466    18197    5                        THEN EXIT SCRAP_DEAD_CODE ;
     2467    18198                           /* End of CBL74 PERFORM, there is no dead code. */
     2468    18199    5                  END ;
     2469    18200    4                  DEAD_CODE_CHECK = MINIMUM (DOEND_FLAG, 0) ;
     2470    18201    4                  DOEND_FLAG = 1 ;
     2471    18202        /*             Explanation of DEAD_CODE_CHECK:
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:92   
     2472    18203                       0 = Nothing of interest deleted (yet).
     2473    18204                       -1 = At least one executable statement has been deleted.
     2474    18205                            The dead code message has been issued. It may be
     2475    18206                            necessary to delete more, so continue scanning, but
     2476    18207                            disable printing of dead code messages for the current
     2477    18208                            %STOP or %GO.
     2478    18209                       +1 = Referenced label or end of program found. There is
     2479    18210                            no (more) dead code for the current %STOP or %GO.
     2480    18211        */
     2481    18212    4                  LINOI_FLAG = ILL$->ILL.ID = %USE_ENTRY ;
     2482    18213    4                  LINOI_FLAG1 = LINOI_FLAG ;
     2483    18214    4                  USE_FLAG = LINOI_FLAG ;
     2484    18215    4                  SEARCH_ILS$ = ILS$ ;
     2485    18216    5                  DO UNTIL DEAD_CODE_CHECK > 0 ;
     2486    18217                         %NEXT_ILS (POINTER=SEARCH_ILS$) ;
     2487    18222    5                    ILL$ = SEARCH_ILS$->ILS.ILL$ ;
     2488    18223    6                    IF ILL$ ~= ADDR (NIL) THEN DO CASE (ILL$->ILL.ID) ;
     2489    18224
     2490    18225    6                      CASE (%LINOI) ;
     2491    18226    7                        IF ILL$->LINOI.TYPE = %S_TYPE_ENTRY THEN DO ;
     2492    18227                               /* Found an IBM-style ENTRY, which cannot be
     2493    18228                                  dead code. */
     2494    18229    7                          DEAD_CODE_CHECK = 1 ;
     2495    18230    7                          NEXT_ILS$ = SEARCH_ILS$ ;
     2496    18231    7                          IF SEARCH_ILS$->ILS.NEXT->ILS.ILL$->ILL.ID = %GO
     2497    18232    7                            THEN SEARCH_ILS$->ILS.NEXT->ILS.ILL$ = ADDR (NIL) ;
     2498    18233                                 /* Optimize out the unneeded GO around the ENTRY */
     2499    18234    7                        END ;
     2500    18235    6                        ELSE IF (ILL$->LINOI.TYPE ~= %NO_STATEMENT_TYPE AND
     2501    18236    7                            NOT USE_FLAG) OR NOT LINOI_FLAG THEN DO ;
     2502    18237    8                          IF ILL$->LINOI.TYPE = %S_TYPE_LABEL_DEF THEN DO ;
     2503    18238                                 /* Check for GO to next SECTION; if found,
     2504    18239                                    quietly optimize it out. */
     2505    18240    8                            IF SEARCH_ILS$->ILS.NEXT->ILS.ILL$->ILL.ID = %GO THEN
     2506    18241    8                              SEARCH_ILS$->ILS.NEXT->ILS.ILL$ = ADDR (NIL) ;
     2507    18242    8                          END ;
     2508    18243    7                          TEMP$ = SEARCH_ILS$ ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:93   
     2509    18244                               %NEXT_ILS (POINTER=TEMP$) ;
     2510    18249    7                          IF TEMP$->ILS.ILL$ ~= ADDR (NIL) THEN
     2511    18250    7                            IF TEMP$->ILS.ILL$->ILL.ID = %DO1 THEN EXIT ;
     2512    18251                                 /* The above needed so the dead code message will
     2513    18252                                    be at a statement, not a label. */
     2514    18253    7                          LINOI_FLAG1 = TRUE ; /* We've found a LINOI */
     2515    18254    7                          COMCOM.CURRENT.LINE = ILL$->LINOI.LINE_NO ;
     2516    18255    7                          COMCOM.CURRENT.COLUMN = ILL$->LINOI.COLUMN_NO ;
     2517    18256    7                          NEXT_ILS$ = SEARCH_ILS$ ;
     2518    18257                               /* If dead code detected, will delete everything up to
     2519    18258                                  but not including the LINOI of a DOEND or a
     2520    18259                                  referenced DEFLB. */
     2521    18260    7                        END ;
     2522    18261
     2523    18262    6                        IF ILL$->LINOI.TYPE ~= %NO_STATEMENT_TYPE
     2524    18263    6                          THEN LINOI_FLAG = TRUE ;
     2525    18264
     2526    18265    6                      CASE (%ENTRY) ;
     2527    18266    6                        DEAD_CODE_CHECK = 1 ;
     2528    18267
     2529    18268    6                      CASE (%DEFLB) ;
     2530    18269    6                        IF ILL$->ILL.LOP->LABEL.B.REFERENCED
     2531    18270    6                            AND NOT ILL$->ILL.LOP->LABEL.B.PFORM_END
     2532    18271    6                            AND NOT ILL$->ILL.LOP->LABEL.B.PFORM_74_END
     2533    18272    6                            AND NOT ILL$->ILL.LOP->LABEL.B.ON_SIZE_ERROR
     2534    18273    6                          THEN DEAD_CODE_CHECK = 1 ;
     2535    18274    6                        ELSE IF ILL$->ILL.LOP->LABEL.ID = %SECTION
     2536    18275    6                            AND ILL$->ILL.LOP->LABEL.SEGMENT$ ~= ADDR(NIL) THEN
     2537    18276    7                          DO ;
     2538    18277                                 /* Do not optimize out numbered SECTION label */
     2539    18278    7                            DOEND_FLAG = DEAD_CODE_CHECK ;
     2540    18279    7                            NEXT_ILS$ = SEARCH_ILS$ ;
     2541    18280    7                            DEAD_CODE_CHECK = 1 ;
     2542    18281    7                          END ;
     2543    18282
     2544    18283    6                      CASE (%DO1, %DO2, %DO3, %DO4, %DO5/*, %DO6 */) ;
     2545    18284
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:94   
     2546    18285        /*E*
     2547    18286              ERROR:  DEAD_CODE
     2548    18287            MESSAGE:  This statement generates code that cannot be reached.
     2549    18288        DESCRIPTION:  This warning is flagged if there is some dead code after
     2550    18289                      an unconditional GOTO or STOP RUN statement.
     2551    18290        */
     2552    18291
     2553    18292    7                        IF DEAD_CODE_CHECK = 0 THEN DO ;
     2554    18293    8                          IF NOT LINOI_FLAG1 THEN DO ;
     2555    18294    9                            IF ILL$->ILL.ID = %DO1 THEN DO ;
     2556    18295    9                              TEMP$ = SEARCH_ILS$ ;
     2557    18296                                   %NEXT_NON_LINOI (POINTER=TEMP$) ;
     2558    18306   10                              DO UNTIL TEMP$->ILS.ILL$->ILL.ID = %LINOI
     2559    18307   10                                AND TEMP$->ILS.ILL$->LINOI.TYPE ~= %S_TYPE_LABEL_DEF ;
     2560    18308   11                                DO UNTIL TEMP$->ILS.ILL$ ~= ADDR (NIL) ;
     2561    18309                                       %NEXT_ILS (POINTER=TEMP$) ;
     2562    18314   11                                END ;
     2563    18315   10                              END ;
     2564    18316    9                              COMCOM.CURRENT.LINE = TEMP$->ILS.ILL$->LINOI.LINE_NO ;
     2565    18317    9                              COMCOM.CURRENT.COLUMN = TEMP$->ILS.ILL$->LINOI.COLUMN_NO
             18317                                       ;
     2566    18318    9                            END ;
     2567    18319    8                            ELSE
     2568    18320                                   %FIND_LAST_LINOI ;
     2569    18334    8                          END ;
     2570    18335    7                          CALL Z8AE$ERROR (%E$DEAD_CODE) ;
     2571    18336    7                        END ;
     2572    18337    6                        DEAD_CODE_CHECK = -1 ; /* Disable dead code message */
     2573    18338    7                        DO UNTIL SEARCH_ILS$ = ILL$->DO_N.ITE ; /*#40751*/
     2574    18339    7                          TEMP$ = SEARCH_ILS$ ;
     2575    18340    8                          DO UNTIL SEARCH_ILS$->ILS.ILL$ ~= ADDR(NIL) ;
     2576    18341                                 %NEXT_ILS (POINTER=SEARCH_ILS$) ;
     2577    18346    8                          END ;
     2578    18347    8                          DO CASE (TEMP$->ILS.ILL$->ILL.ID);
     2579    18348    8                            CASE (%PREOFF, %PRESET, %P_A_PRESET, %P_P_PRESET, %PTR_SET)
             18348                                     ;
     2580    18349    8                              TEMP$->ILS.SEQNO = CURRENT_SEQ_NO ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:95   
     2581    18350    8                              CURRENT_SEQ_NO = CURRENT_SEQ_NO + 1 ;
     2582    18351    8                              TEMP$->ILS.NEXT = PREV_ILS$ ;
     2583    18352    8                              PREV_ILS$ = TEMP$ ;
     2584    18353                                   /* Do not optimize out the above. */
     2585    18354    8                          END ; /* CASE */
     2586    18355    7                        END ; /* UNTIL */
     2587    18356                             /* Optimize out everything thru and including the DOEND,
     2588    18357                                except PREOFFs and such */
     2589    18358
     2590    18359    6                      CASE (%DOEND) ;
     2591    18360    7                        IF ILL$->DO_N.ITB->ILS.ILL$->DO_N.ID = %DO1 THEN DO ;
     2592    18361    7                          DOEND_FLAG = DEAD_CODE_CHECK ;
     2593    18362                               /* Do not delete the DOEND from a GO optimization,
     2594    18363                                  and restart the dead code search on the next
     2595    18364                                  ILL item. */
     2596    18365    7                          NEXT_ILS$ = SEARCH_ILS$ ;
     2597    18366    7                        END ;
     2598    18367    7                        ELSE DO ;
     2599    18368    8                          IF DEAD_CODE_CHECK = 0 THEN DO ;
     2600    18369    8                            IF NOT LINOI_FLAG1 THEN
     2601    18370                                   %FIND_LAST_LINOI ;
     2602    18384    8                            CALL Z8AE$ERROR (%E$DEAD_CODE) ;
     2603    18385    8                          END ;
     2604    18386    7                        END ;
     2605    18387    6                        DEAD_CODE_CHECK = 1 ;
     2606    18388                             /* End of dead code. Don't get rid of DOEND, lest
     2607    18389                                Phase 3 find an unmatched DO. */
     2608    18390
     2609    18391    6                      CASE (%SUB_END, %SUB_PREP) ;
     2610    18392                             /* End of optimized PERFORM cannot be reached. This is
     2611    18393                                perfectly legal though perhaps a trifle offbeat.
     2612    18394                                Delete the SUB_END without any warning message.
     2613    18395                                If SUB_PREP, it means it turns out after all that it
     2614    18396                                is not possible to fall thru into the body of an
     2615    18397                                optimized PERFORM. The SUB_PREP should be quietly
     2616    18398                                deleted. */
     2617    18399
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:96   
     2618    18400    6                      CASE (%GO) ;
     2619    18401                             /* An ALTERed GO, if in the user program, is always
     2620    18402                                preceded by a referenced label. Therefore, it can
     2621    18403                                occur here only if it is compiler-created as the
     2622    18404                                exit from a COBOL-74 PERFORM. As with SUB_END,
     2623    18405                                delete it without message. A GO with any code other
     2624    18406                                than %GO_ALTERED is genuine dead code. */
     2625    18407    7                        IF ILL$->ILL.CODE ~= %GO_ALTERED THEN DO;
     2626    18408    8                          IF DEAD_CODE_CHECK = 0 THEN DO ;
     2627    18409    8                            IF NOT LINOI_FLAG1 THEN
     2628    18410                                   %FIND_LAST_LINOI ;
     2629    18424    8                            CALL Z8AE$ERROR (%E$DEAD_CODE) ;
     2630    18425    8                          DEAD_CODE_CHECK = -1 ;
     2631    18426    8                          END ;
     2632    18427    7                        END ;
     2633    18428
     2634    18429    6                      CASE (%USE_ENTRY, %USE_END, %PREOFF, %PRESET, %P_A_PRESET,
     2635    18430    6                            %PTR_SET, %P_P_PRESET) ;
     2636    18431                             /* These items must never be optimized out. */
     2637    18432    6                        DOEND_FLAG = DEAD_CODE_CHECK ;
     2638    18433                             /* Handle like a DOEND matched with a DO1. */
     2639    18434    6                        NEXT_ILS$ = SEARCH_ILS$ ;
     2640    18435    6                        DEAD_CODE_CHECK = 1 ;
     2641    18436
     2642    18437    6                      CASE (%VAL_END) ;
     2643    18438    6                        IF ILL$->VAL_END.VAL$->ILS.SEQNO ~= 0 THEN
     2644    18439    7                          DO ;
     2645    18440                                 /* Do not optimize this out, either. */
     2646    18441    7                            IF VAL_END$ = ADDR(NIL) THEN
     2647    18442    7                              VAL_END$ = ILL$ ;
     2648    18443    7                            DOEND_FLAG = DEAD_CODE_CHECK ;
     2649    18444    7                            NEXT_ILS$ = SEARCH_ILS$ ;
     2650    18445    7                            DEAD_CODE_CHECK = 1 ;
     2651    18446    7                          END ;
     2652    18447
     2653    18448    6                      CASE (%SCOPE) ;
     2654    18449    6                        NEXT_ILS$ = SEARCH_ILS$ ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:97   
     2655    18450    6                        DEAD_CODE_CHECK = 1 ;
     2656    18451                             /* Dead code thru end of program */
     2657    18452
     2658    18453    6                      CASE (%END_PROG, %END) ;
     2659    18454    6                        DEAD_CODE_CHECK = 1 ;
     2660    18455                             /* Dead code thru end of program, don't scrap LINOI */
     2661    18456
     2662    18457    6                      CASE (%STOP,%EXIT_PROG) ;
     2663    18458    7                        IF ILL$->ILL.CODE ~= %EXIT_PROG_PHASE2_CREATED THEN DO ;
     2664    18459    8                          IF DEAD_CODE_CHECK = 0 THEN DO ;
     2665    18460    8                            IF NOT LINOI_FLAG1 THEN
     2666    18461                                   %FIND_LAST_LINOI ;
     2667    18475    8                            CALL Z8AE$ERROR (%E$DEAD_CODE) ;
     2668    18476    8                          END ;
     2669    18477    7                          DEAD_CODE_CHECK = -1 ;
     2670    18478    7                        END ;
     2671    18479
     2672    18480    6                      CASE (ELSE) ;
     2673    18481    7                        IF DEAD_CODE_CHECK = 0 THEN DO ;
     2674    18482    7                          IF NOT LINOI_FLAG1 THEN
     2675    18483                                 %FIND_LAST_LINOI ;
     2676    18497    7                          CALL Z8AE$ERROR (%E$DEAD_CODE) ;
     2677    18498    7                        END ;
     2678    18499    6                        DEAD_CODE_CHECK = -1 ;
     2679    18500    6                    END ; /* CASE (ILL$->ILL.ID) */
     2680    18501    5                  END ; /* UNTIL DEAD_CODE_CHECK > 0 */
     2681    18502    4                END ; /* SCRAP_DEAD_CODE */
     2682    18503    3            END ;
     2683    18504        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:98   
     2684    18505        /*V*
     2685    18506            ASSIGN_SEQ_NO -- Assign the sequence numbers for the ILS.
     2686    18507        */
     2687    18508
     2688    18509    2            IF ILS$->ILS.ILL$ ~= ADDR (NIL) AND
     2689    18510                   /* TRUE in all cases except SCOPE for inline subroutine */
     2690    18511    2                (ILS$->ILS.ILL$->ILL.ID ~= %LINOI OR
     2691    18512    2                 ILS$->ILS.ILL$->LINOI.TYPE ~= %S_TYPE_VALUE_IS) THEN
     2692    18513    3              DO CASE (ILS$->ILS.ILL$->ILL.ID) ;
     2693    18514    3                CASE (%PRESET, %PREOFF, %PTR_SET, %P_A_PRESET, %P_P_PRESET) ;
     2694    18515                       /* ILS.SEQNO not needed */
     2695    18516    3                CASE (ELSE) ;
     2696    18517                       %IF GCOS;
     2702    18523                       %ENDIF;
     2703    18524    3                  ILS$->ILS.SEQNO = CURRENT_SEQ_NO ;
     2704    18525    3                  CURRENT_SEQ_NO = CURRENT_SEQ_NO + 1 ;
     2705    18526    3                  IF CURRENT_SEQ_NO = %MAX_SEQ# THEN
     2706    18527    3                    CALL Z8AE$ERROR (%E$SEQ_NO_OVERFLOW) ;
     2707    18528    3                  IF ILS$->ILS.ILL$->ILL.ID = %DEFLB AND
     2708    18529    4                      ILS$->ILS.ILL$->ILL.LOP->LABEL.B.REFERENCED THEN DO;
     2709    18530                         /* Labels need to be linked in reverse order for phase 3. */
     2710    18531    4                    ILS$->ILS.ILL$->ILL.LBL = COMCOM.H_LBL ;
     2711    18532    4                    COMCOM.H_LBL = ILS$ ;
     2712    18533    4                  END ;
     2713    18534    3              END ; /* CASE */
     2714    18535
     2715    18536        /*V*
     2716    18537            RELINK_ILS -- Relink the ILS in reverse order for Phase 3.
     2717    18538        */
     2718    18539
     2719    18540    2            IF NEXT_ILS$ ~= ADDR(NIL) THEN
     2720    18541    2              IF NEXT_ILS$->ILS.ILL$ = ADDR(NIL) THEN
     2721    18542    3                DO ;
     2722    18543
     2723    18544    4                  DO WHILE NEXT_ILS$->ILS.ILL$ = ADDR(NIL) ;
     2724    18545                         %NEXT_ILS (POINTER=NEXT_ILS$) ;
     2725    18550    4                  END ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:99   
     2726    18551
     2727    18552    3                  ILS$->ILS.NEXT = NEXT_ILS$ ;
     2728    18553    3                END ;
     2729    18554
     2730    18555    3            IF ILS$->ILS.ILL$ ~= ADDR(NIL) THEN DO ;
     2731    18556    3              ILS$->ILS.NEXT = PREV_ILS$ ;
     2732    18557    3              PREV_ILS$ = ILS$ ;
     2733    18558    3            END ;
     2734    18559    2            ILS$ = NEXT_ILS$ ;
     2735    18560
     2736    18561    2          END /* DO WHILE */ ;
     2737    18562        /*V*
     2738    18563            WRAPUP -- The pointer to the top of the ILS link is assigned.  This is
     2739    18564                      in actuality the pointer to the END item.
     2740    18565        */
     2741    18566
     2742    18567    1          COMCOM.FIRST_ILS = PREV_ILS$ ;
     2743    18568
     2744    18569    1     END Z8FF$FLOW_ANALYSIS ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:100  
--  Include file information  --

   Z8F_O2COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STATEMNT.:Z8A6TOU  is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DPI.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z9A_SUPP_MAC.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8FF$FLOW_ANALYSIS.

   Procedure Z8FF$FLOW_ANALYSIS requires 6261 words for executable code.
   Procedure Z8FF$FLOW_ANALYSIS is declared NOAUTO and requires 96 words of local(STATIC) storage.

    No errors detected in file Z8FF.:Z8A6TSI    .

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:101  

 Object Unit name= Z8FF$FLOW_ANALYSIS                         File name= Z8FF.:Z8A6TOU
 UTS= AUG 09 '97 13:06:36.72 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    96    140  Z8FF$FLOW_ANALYSIS
    1  LblCom even  none     1      1  ITERATION
    2  LblCom even  none     1      1  DNT$
    3  LblCom even  none     5      5  DNT_
    4  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    5  LblCom even  none     1      1  DNT_OF_1$
    6  LblCom even  none     1      1  ILS$
    7  LblCom even  none     5      5  ILS_
    8  LblCom even  none     1      1  DPI$
    9  LblCom even  none     5      5  DPI_
   10  LblCom even  none     1      1  ILL$
   11  LblCom even  none     5      5  ILL_
   12  LblCom even  none     1      1  ETT$
   13  LblCom even  none     1      1  HEAD_ETT$
   14  LblCom even  none   512   1000  ETT_BUCKETS
   15  LblCom even  none     5      5  ETT_
   16  LblCom even  none     1      1  LTS$
   17  LblCom even  none     5      5  LTS_
   18  LblCom even  none     2      2  MKCN
   19  LblCom even  none     1      1  ST$
   20  LblCom even  none     5      5  ST_
   21  LblCom even  none    90    132  LEX_SYMBOL
   22  LblCom even  none     1      1  CURRENT_LEX_SYMBOL$
   23  LblCom even  none    90    132  TEMP_LEX_SYMBOL
   24  LblCom even  none    90    132  TEMP_LEX_SYMBOL2
   25  LblCom even  none    12     14  O2COM
   26  RoData even  UTS      1      1  Z8FF$FLOW_ANALYSIS
   27   Proc  even  none  6261  14165  Z8FF$FLOW_ANALYSIS
   28  RoData even  none    47     57  Z8FF$FLOW_ANALYSIS
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:102  

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    27      0   yes            yes      Std        0  Z8FF$FLOW_ANALYSIS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
         yes           Std       0 Z8AH$SEARCH_
         yes           Std       0 Z8FP$PFORM_CHECKING
         yes           Std       2 Z9EC$ALIGN
         yes           Std       2 Z8AT$CREATE_TEMPORARY
         yes           Std       1 Z8AR$RESERVER
         yes           Std       3 Z8AF$NEW_BASE
         yes           Std       2 Z8FS$SRCH_IF_DO_LBL
         yes           Std       6 Z8AN$NEW_ILL2
         yes           Std       1 Z8AC$MAKE_CONST

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    ILS_STEP_TABLE                   r    ILL_STEP
r    LTS_STEP

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:103  


        1        1        /*M*  Z8FF$FLOW_ANALYSIS                                                  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8               NAME:  Z8FF$FLOW_ANALYSIS
        9        9             AUTHOR:  Greg Myers
       10       10            PURPOSE:  This procedure does all the preparatory flow analysis for
       11       11                      PHASE 3.  This includes:  Dead code elimination,
       12       12                      PERFORM handling, transforming IF-loops
       13       13                      to DO-loops, and optimizing ALTERed GO TOs.
       14       14        */
       15       15
       16       16        /*D*
       17       17               NAME:  Z8FF$FLOW_ANALYSIS
       18       18               CALL:  CALL Z8FF$FLOW_ANALYSIS ;
       19       19          INTERFACE:  Z8FS$SRCH_IF_DO_LBL -- Resets the links affected by the PFORM.
       20       20                      Z8FP$PFORM_CHECKING -- Creates COBOL 74 or optimized PFORMs.
       21       21                      Z8AC$MAKE_CONST -- Creates CONST ST item.
       22       22                      Z8AE$ERROR -- Called to output error messages.
       23       23                      Z8AF$NEW_BASE -- Called to set up BASE item for anything that
       24       24                                       needs one.
       25       25                      Z8AT$CREATE_TEMPORARY -- Creates temporary labels and scalars.
       26       26
       27       27              INPUT:  The ILS, ILL, ETT, and ST are accessed.
       28       28             OUTPUT:  VARIABLE.SEQ#.FD            Forward definition point
       29       29                      ILS.SEQNO         Sequence number
       30       30                      ILS.NEXT          Pointer to next item in ILS
       31       31                      COMCOM.FIRST_ILS  Pointer to top of ILS (Last entry of ILS)
       32       32                      COMCOM.H_LBL      Pointer to top of label chain (Last label)
       33       33            SCRATCH:  ILL$                   ILL Pointer
       34       34                      ILS$                   ILS Pointer
       35       35                      ST$                    ST Pointer
       36       36                      COMCOM.CURRENT.LINE    For error messages
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:104  
       37       37                      COMCOM.CURRENT.COLUMN  For error messages
       38       38
       39       39        DESCRIPTION:  This procedure uses a loop to go thru the ILS
       40       40                      table skipping the ILS entries that point to LINOI items.
       41       41                      Inside the loop there are two case statements.  Different
       42       42                      optimizations are then performed on the ILL items.  A loop is
       43       43                      also performed on the ILS table to create sequence numbers
       44       44                      and redefinitions.  When phase 2 is done the ILS is linked
       45       45                      in reverse order for phase 3.
       46       46        */
       47       47        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:105  
       48       48        Z8FF$FLOW_ANALYSIS: PROC NOAUTO ;

     48 27 000000   000000 741200 0     Z8FF$FLOW_A* STX1  ! 0
        27 000001   002256 710000 27                 TRA     s:15030

       49       49        /*N*
       50       50            CHANGES -- Remember on the GOTO item there are two changes.
       51       51                       As of now I assume there is a LINOI item for every ILL
       52       52                       statement and that I could reach the end of the
       53       53                       program.  In reality there will be a STOP item, and
       54       54                       maybe no LINOI entry between ILL entries.
       55       55        */
       56       56        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:106  
       57       57        %EQU PHASE = 2 ;
       58       58       %EQU #_STATEMENTS = 4 ; /* Number of statements including LINOI's to determine if pe
                58        rform should be copied */
       59       59        %INCLUDE Z8A_DEFC ;
       60      127        %INCLUDE Z8A_SUPP_MAC ;
       61     2527        %INCLUDE Z9A_SUPP_MAC;
       62     2816        %INCLUDE Z9A_FLAGS;
       63     2830        %INCLUDE Z8A_COMCOM ;
       64     3480        %INCLUDE Z8A_DNT ;
       65     3701        %INCLUDE Z8A_ILS ;
       66     3810        %INCLUDE Z8A_DPI ;
       67     3894        %INCLUDE Z8A_ILL ;
       68     4587        %INCLUDE Z8A_ETT ;
       69     4888        %INCLUDE Z8A_LTS ;
       70     6965        %INCLUDE Z8A_MKCN ;
       71     6982        %INCLUDE Z8A_ST ;
       72    10641        %INCLUDE Z8A_ERR_NUMS ;
       73    11405        %INCLUDE Z8A_TYPES ;
       74    11579        %INCLUDE Z8E_NEW_ILL ;
       75    11593        %INCLUDE Z8E_STACKS ;
       76    13859        %INCLUDE Z8E_STATEMNT ;
       77    13928        %INCLUDE Z8F_O2COM ;
       78    14038
       79    14039    1   DCL   PREV_ILS$            PTR AUTO ; /* Ptr to previous ILS entry        */
       80    14040    1   DCL   NEXT_ILS$            PTR AUTO ; /* Ptr to next item in ILS          */
       81    14041    1   DCL   PERF_LABEL_CHECK     PTR AUTO ; /* Ptr to ILS entry for perform check */
       82    14042    1   DCL   PERF_STATEMENT_CHECK PTR AUTO ; /*Ptr to ILS entry for perform check */
       83    14043    1   DCL   START_LABEL$         PTR ; /* Ptr to start label of PERFORM */
       84    14044    1   DCL   START_LABEL_ILS$     PTR ; /* Ptr to starting label's ILS entry */
       85    14045    1   DCL   END_LABEL$           PTR ; /* Ptr to end label of PERFORM */
       86    14046    1   DCL   END_LABEL_ILS$       PTR ; /* Ptr to ending label's ILS entry */
       87    14047    1   DCL   NEXT_LABEL$          PTR ; /* Ptr to next label after end label of PFORM */
       88    14048    1   DCL   NULL_PFORM_CHECK$    PTR ; /* To check for null PERFORM */
       89    14049
       90    14050    1   DCL   DOEND_ILS$           PTR AUTO ; /* Ptr to DOEND entry in ILS               */
       91    14051    1   DCL   GOTO_DEST$           PTR AUTO ; /* Ptr to destination of backward GOTO */
       92    14052    1   DCL   GO_ILS$              PTR AUTO ; /* Ptr to GO entry in ILS                  */
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:107  
       93    14053    1   DCL   INITIAL_ILS$         PTR AUTO ;
             14053            /* Ptr to ILS entry for copying stmts within perform */
       94    14054    1   DCL   SEARCH_DO$           PTR AUTO ; /* Ptr used to search DOs in DO loop */
       95    14055    1   DCL   COPY_ILS$            PTR AUTO ;
             14055            /* Ptr to ILS entry for copying stmts within perform */
       96    14056    1   DCL   NEXT_COPY$           PTR AUTO ;
             14056            /* Ptr to ILS entry for copying stmts within perform */
       97    14057    1   DCL   DO_ILS$              PTR AUTO ; /* Ptr to DO entry in ILS */
       98    14058    1   DCL   DO_LINOI$            PTR ; /* PTR to ILS for LINOI before DOn */
       99    14059    1   DCL   FATHER_DO            PTR AUTO ; /* Ptr to father loop of DO loop if any */
      100    14060    1   DCL   REF_DEFLB            PTR AUTO ; /* Ptr to last refd label  */
      101    14061
      102    14062    1   DCL   GO_LABEL_LINOI$      PTR AUTO ; /* Ptr to target labels LINOI entry */
      103    14063    1   DCL   GO_LABEL_ILS$        PTR AUTO ; /* Ptr to target labels ILS entry */
      104    14064    1   DCL   LABEL_CHECK$         PTR AUTO ;
             14064            /* Ptr to labels as a check is made for references */
      105    14065    1   DCL   CREATED_LABEL$       REDEF LABEL_CHECK$ PTR ;
             14065            /* Ptr to created label for IF */
      106    14066    1   DCL   VAL_END$             PTR ;
      107    14067    1   DCL   DPI$$                PTR AUTO ; /* Used in MULTI_REDEF */
      108    14068    1   DCL   EXIT_PROG$           PTR AUTO ; /* If EXIT PROGRAM in USE proc */
      109    14069    1   DCL   EXIT_PROG_FOUND      BOOLEAN ;
      110    14070    1   DCL   CONST$               PTR ; /* For constant operand */
      111    14071    1   DCL   OPERAND$             PTR ; /* For variable operand */
      112    14072    1   DCL   OPERAND_TYPE         UBIN ;
      113    14073    1   DCL   TEMP_UBIN            UBIN ;
      114    14074    1   DCL   TEMP_SBIN            SBIN ;
      115    14075    1   DCL   TEMP_STR             CHAR (12) ;
      116    14076    1   DCL   OPTIMIZE_DO3         BOOLEAN ;
      117    14077    1   DCL   ILL_ID               UBIN ;
      118    14078    1   DCL   STATEMENT_COUNT      SBIN WORD AUTO ; /* Statement count */
      119    14079    1   DCL   GO_FLAG              SBIN ; /* For GO statement optimizations */
      120    14080    1   DCL   DO_LEVEL             SBIN WORD AUTO ; /* Nesting level of DO loop */
      121    14081    1   DCL   CURRENT_SEQ_NO       SBIN WORD AUTO ; /* Sequence counter */
      122    14082    1   DCL   FALL_THRU_FLAG       SBIN ;
      123    14083    1   DCL   CURRENT_SEG#         SBIN WORD ;  /* Segment number */
      124    14084    1   DCL   DEFLB_FOLLOWS        BOOLEAN ; /* DEFLB after PFORM */
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:108  
      125    14085    1   DCL   LABEL_AFTER_PFORM$   PTR ; /* DEFLB.LOP (ST pointer) */
      126    14086    1   DCL   DEFLB_AFTER_ENTRY    BOOLEAN ;
             14086            /* Used to set REFERENCED in first DEFLB after an ENTRY */
      127    14087    1   DCL   ILS$$                PTR AUTO ; /* Created STOP or EXIT */
      128    14088    1   DCL   ILL$$                PTR AUTO ;
      129    14089    1   DCL   CDEF_FLAG            BOOLEAN ;
      130    14090        %DCL_AUTO_LX_ITEM (@NAME = TEMP_ILS_LIST) ;
      131    14094    1   DCL   GOTO_VECTOR          BOOLEAN ; /* Processing a GO TO vector */
      132    14095    1   DCL   VECTOR_END$          PTR ; /* PTR to LABEL at end of GO TO vector */
      133    14096    1   DCL   DEAD_CODE_CHECK      SBIN ; /* Used in looking for unreachable code */
      134    14097    1   DCL   SEARCH_ILS$          PTR ; /* Likewise */
      135    14098    1   DCL   ENTADDR_OF_NIL$      PTR ; /* PTR to CONSTANT item for null PTR */
      136    14099    1   DCL   ENTADDR_ENIL$        EPTR CONSTANT INIT (ENTADDR (NIL)) ;
      137    14100    1   DCL   ENTADDR_OF_NIL_UBIN  REDEF ENTADDR_ENIL$ UBIN ;
      138    14101    1   DCL   LINOI_FLAG1          BOOLEAN ; /* Found any LINOI */
      139    14102    1   DCL   LINOI_FLAG           BOOLEAN ; /* Found LINOI with statement type */
      140    14103    1   DCL   USE_FLAG             BOOLEAN ; /* Dead code detection in USE procedure */
      141    14104    1   DCL   AFTER_USE            BOOLEAN ;
             14104            /* To find the first label after USE procedure */
      142    14105    1   DCL   LABEL_AFTER_USE      PTR ;
      143    14106    1   DCL   DOEND_FLAG           SBIN ;
             14106            /* DOEND from GO optimization to be skipped in dead code check */
      144    14107    1   DCL   ENTRY_TYPE           UBIN ;
             14107            /* To distinguish between main prog and subroutine */
      145    14108    1   DCL   TEMP$                PTR ;
      146    14109    1   DCL   CURRENT_PROC$        PTR ; /* PTR to current Proc_ ST item */
      147    14110    1   DCL   Z8AT$CREATE_TEMPORARY ENTRY(2) ;
      148    14111    1   DCL   Z8AN$NEW_ILL2        ENTRY (6) ;
      149    14112    1   DCL   Z8AF$NEW_BASE        ENTRY (3) ; /* LOP, ROP, RETURN */
      150    14113    1   DCL   Z8AE$ERROR           ENTRY (12) ;
      151    14114    1   DCL   Z8AC$MAKE_CONST      ENTRY (1) ;
      152    14115    1   DCL   Z8AH$SEARCH_         ENTRY ;
      153    14116    1   DCL   Z9EC$ALIGN           ENTRY (2) ;
      154    14117    1   DCL   Z8FP$PFORM_CHECKING  ENTRY ;
      155    14118    1   DCL   Z8FS$SRCH_IF_DO_LBL  ENTRY (2) ;
      156    14119
      157    14120        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:109  
      158    14121        /*E*
      159    14122              ERROR:  E$NULL_PFORM_WARNING
      160    14123            MESSAGE:  There is no executable code in the code group to be performed.
      161    14124        DESCRIPTION:  This warning is flagged when the perform code group consists
      162    14125                      of only a start label and end label with no code inbetween.
      163    14126                      The PFORM is then deleted from the program.
      164    14127        */
      165    14128
      166    14129        %MACRO NULL_PFORM_WARNING ;
      167    14130               DO ;
      168    14131                 IF ILL$->ILL.CODE ~= %PFORM_USE_PROC THEN
      169    14132                   CALL Z8AE$ERROR(%E$NULL_PFORM_WARNING) ;
      170    14133                 PREV_ILS$->ILS.NEXT = NEXT_ILS$ ;
      171    14134                 ILS$ = NEXT_ILS$ ;
      172    14135                 IF DEFLB_FOLLOWS THEN
      173    14136                   LABEL_AFTER_PFORM$->LABEL.PREV_ILS$ = PREV_ILS$ ;
      174    14137               END ;
      175    14138        %MEND ;
      176    14139        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:110  
      177    14140        /*V*
      178    14141            FIND_LAST_LINOI -- In dead code detection occasionally there is no LINOI
      179    14142                               between the STOP or GO and the next executable ILL
      180    14143                               item. In this case it is necessary to trace back thru
      181    14144                               the ILL to find the last LINOI.
      182    14145        */
      183    14146
      184    14147        %MACRO FIND_LAST_LINOI ;
      185    14148               DO ;
      186    14149                 TEMP$ = PREV_ILS$ ;
      187    14150                 DO WHILE TEMP$->ILS.ILL$->ILL.ID ~= %LINOI ;
      188    14151                   %NEXT_ILS (POINTER=TEMP$) ;
      189    14152                 END ;
      190    14153                 COMCOM.CURRENT.LINE = TEMP$->ILS.ILL$->LINOI.LINE_NO ;
      191    14154                 COMCOM.CURRENT.COLUMN = TEMP$->ILS.ILL$->LINOI.COLUMN_NO ;
      192    14155               END ;
      193    14156        %MEND ;
      194    14157        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:111  
      195    14158        /*V*
      196    14159            FIND_ITEM -- This macro searches thru the ILS until it finds the
      197    14160                         requested item or the end of the program.
      198    14161                         It also updates COMCOM.CURRENT as appropriate.
      199    14162        */
      200    14163        /*N* May need to consider POINTER->ILS.ILL$ = ADDR (NIL) as a possibility.
      201    14164             If it ever happens then before the %NEXT_ILS call insert:
      202    14165             DO UNTIL POINTER->ILS.ILL$ ~= ADDR (NIL) ;       */
      203    14166
      204    14167        %MACRO FIND_ITEM(ITEM=%GO, POINTER=NEXT_ILS$) ;
      205    14168               DO ;
      206    14169                 DO WHILE POINTER->ILS.ILL$->ILL.ID ~= %END AND
      207    14170                          POINTER->ILS.ILL$->ILL.ID ~= ITEM ;
      208    14171                   IF POINTER->ILS.ILL$->ILL.ID = %LINOI THEN
      209    14172                     IF POINTER->ILS.ILL$->LINOI.TYPE ~= %NO_STATEMENT_TYPE THEN DO ;
      210    14173                       COMCOM.CURRENT.LINE = POINTER->ILS.ILL$->LINOI.LINE_NO ;
      211    14174                       COMCOM.CURRENT.COLUMN = POINTER->ILS.ILL$->LINOI.COLUMN_NO ;
      212    14175                     END ;
      213    14176
      214    14177                   %NEXT_ILS (POINTER=POINTER) ;
      215    14178                 END ;
      216    14179               END ;
      217    14180        %MEND ;
      218    14181        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:112  
      219    14182        /*V*
      220    14183            ASSIGN_LABEL_INFO -- The basic label information is assigned here.
      221    14184                                 This includes
      222    14185
      223    14186                                   1.  If the label is referenced then the pointer
      224    14187                                       REF_DEFLB is updated to point to the last
      225    14188                                       referenced label.
      226    14189
      227    14190                                   2.  The pointer to last label encountered
      228    14191                                       O2COM.LAST_LBL$ is updated.
      229    14192
      230    14193                                   3.  Set FALL_THRU_FLAG since control can fall
      231    14194                                       thru after a label.
      232    14195        */
      233    14196
      234    14197        %MACRO ASSIGN_LABEL_INFO (@ILS$ = ILS$, @ILL$ = ILL$) ;
      235    14198         DO ;
      236    14199           IF DEFLB_AFTER_ENTRY THEN
      237    14200             @ILL$->ILL.LOP->LABEL.B.REFERENCED = TRUE ;
      238    14201
      239    14202           IF @ILL$->ILL.LOP->LABEL.B.REFERENCED THEN
      240    14203             DO ;
      241    14204               REF_DEFLB = @ILS$ ;
      242    14205               FALL_THRU_FLAG = 1 ; /* After a referenced label, fall thru is possible. */
      243    14206             END ;
      244    14207
      245    14208           IF @ILL$ -> ILL.LOP -> LABEL.ID = %SECTION THEN
      246    14209             DO ;
      247    14210               O2COM.SECTION$ = @ILL$ -> ILL.LOP ;
      248    14211               IF @ILL$ -> ILL.LOP -> SECTION.SEGMENT$ ~= ADDR(NIL) THEN
      249    14212       O2COM.SEGMENT_NO = @ILL$ -> ILL.LOP -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO# ;
      250    14213             END ;
      251    14214
      252    14215           O2COM.LAST_LBL$ = @ILS$ ;
      253    14216           DEFLB_AFTER_ENTRY = FALSE ;
      254    14217         END ;
      255    14218        %MEND ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:113  
      256    14219        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:114  
      257    14220        /*V*
      258    14221            ASSIGN_DO_ITEM_INFO -- The information needed for the DO item is assigned.
      259    14222                                   This includes
      260    14223
      261    14224                                     1.  The pointer to the previous DO or DOend
      262    14225                                         item (DO_N.ITP) and updating the pointer to
      263    14226                                         the last one (COMCOM.H_DO).
      264    14227
      265    14228                                     2.  Assigning the pointer to the last referenced
      266    14229                                         label (DO_N.XLAB).
      267    14230
      268    14231                                     3.  Updating nesting level information which
      269    14232                                         involves assigning DO_N.ITO (pointer to father
      270    14233                                         Do entry) and DO_N.LEVEL (nesting level).
      271    14234                                         The variables used for this are updated.
      272    14235        */
      273    14236
      274    14237        %MACRO ASSIGN_DO_ITEM_INFO (@ILS$ = ILS$, @ILL$ = ILL$) ;
      275    14238         DO ;
      276    14239           DO_LINOI$ = PREV_ILS$ ;
      277    14240           %NEXT_ILS (POINTER=DO_LINOI$) ;
      278    14241           @ILL$->DO_N.ITP = COMCOM.H_DO ;
      279    14242           COMCOM.H_DO = @ILS$ ;
      280    14243           @ILL$->DO_N.XLAB = REF_DEFLB ;
      281    14244           @ILL$->DO_N.ITO = FATHER_DO ;
      282    14245           FATHER_DO = @ILS$ ;
      283    14246           @ILL$->DO_N.LEVEL = DO_LEVEL ;
      284    14247           DO_LEVEL = DO_LEVEL + 1 ;
      285    14248           FALL_THRU_FLAG = 1 ; /* Fall thru possible after a DOn */
      286    14249         END ;
      287    14250        %MEND ;
      288    14251        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:115  
      289    14252        /*V*
      290    14253            ASSIGN_DOEND_INFO -- The information for the DOEND item is assigned
      291    14254                                 which includes
      292    14255
      293    14256                                   1.  The pointer to the previous DO or DOEND item
      294    14257                                       is assigned and updated.
      295    14258
      296    14259                                   2.  The nesting level variables are updated.
      297    14260        */
      298    14261
      299    14262        %MACRO ASSIGN_DOEND_INFO(@ILS$ = ILS$, @ILL$ = ILL$) ;
      300    14263         DO ;
      301    14264           @ILL$->DO_N.ITP = COMCOM.H_DO ;
      302    14265           COMCOM.H_DO = @ILS$ ;
      303    14266           DO_LEVEL = DO_LEVEL - 1 ;
      304    14267           FATHER_DO = FATHER_DO->ILS.ILL$->DO_N.ITO ;
      305    14268           FALL_THRU_FLAG = 1 ; /* Fall thru possible after a DOEND */
      306    14269         END ;
      307    14270        %MEND ;
      308    14271        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:116  
      309    14272        /*V*
      310    14273            COPY_ILS_ENTRY -- This macro is used in the copying of a perform code
      311    14274                              group in line.  A ILS entry is created and the
      312    14275                              information is copied in.  The pointers are then updated.
      313    14276        */
      314    14277
      315    14278        %MACRO COPY_ILS_ENTRY ;
      316    14279         DO ;
      317    14280           %RESERVE_ILS (ITEM    = INITIAL_ILS$->ILS.ID ,
      318    14281                         POINTER = NEXT_COPY$, VARIABLE = '1'B) ;
      319    14282
      320    14283           IF INITIAL_ILS$->ILS.ID = %OPN THEN
      321    14284             NEXT_COPY$->OPN = INITIAL_ILS$->OPN ;
      322    14285           ELSE
      323    14286             NEXT_COPY$->ILS = INITIAL_ILS$->ILS ;
      324    14287
      325    14288           COPY_ILS$->ILS.NEXT = NEXT_COPY$ ;
      326    14289           %NEXT_ILS (POINTER=INITIAL_ILS$) ;
      327    14290           COPY_ILS$ = NEXT_COPY$ ;
      328    14291         END ;
      329    14292        %MEND ;
      330    14293        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:117  
      331    14294    1   INSERT_STOP_OR_EXIT: PROC ;

  14294 27 000002   000112 741200 0     INSERT_STOP* STX1  ! CURRENT_PROC$+1

      332    14295
      333    14296        /*I*
      334    14297               NAME: INSERT_STOP_OR_EXIT
      335    14298               CALL: CALL INSERT_STOP_OR_EXIT ;
      336    14299
      337    14300              INPUT: ILS$ - Pointer to ILS item at which the STOP or EXIT_PROG
      338    14301                            is to be inserted.
      339    14302                     ENTRY_TYPE - Code to determine which is needed, STOP or
      340    14303                                   EXIT_PROG.
      341    14304                     PREV_ILS$ - Pointer to an ILS item before where ILS$ points.
      342    14305             OUTPUT: A STOP or EXIT_PROG is inserted.
      343    14306
      344    14307        DESCRIPTION: A STOP or EXIT_PROG is inserted before the current ILL item.
      345    14308        */
      346    14309
      347    14310    3          DO WHILE PREV_ILS$->ILS.NEXT ~= ILS$ ;

  14310 27 000003   000001 470400 0                  LDP0    PREV_ILS$
        27 000004   000002 236100                    LDQ     2,,PR0
        27 000005   000000 116000 6                  CMPQ    ILS$
        27 000006   000016 600000 27                 TZE     s:14317

      348    14311                 %NEXT_ILS (POINTER=PREV_ILS$) ;

  14313 27 000007   000001 470400 0                  LDP0    PREV_ILS$
        27 000010   000002 236100                    LDQ     2,,PR0
        27 000011   000001 756000 0                  STQ     PREV_ILS$

      349    14316    3          END ;

  14316 27 000012   000001 470400 0                  LDP0    PREV_ILS$
        27 000013   000002 236100                    LDQ     2,,PR0
        27 000014   000000 116000 6                  CMPQ    ILS$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:118  
        27 000015   000007 601000 27                 TNZ     s:14313

      350    14317    2          IF CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.EXIT_PROG_IN_DECL

  14317 27 000016   000111 471400 0                  LDP1    CURRENT_PROC$
        27 000017   100001 473500                    LDP3    1,,PR1
        27 000020   300001 236100                    LDQ     1,,PR3
        27 000021   000200 316007                    CANQ    128,DL
        27 000022   000245 600000 27                 TZE     s:14448
        27 000023   000107 235000 0                  LDA     ENTRY_TYPE
        27 000024   000001 115007                    CMPA    1,DL
        27 000025   000245 601000 27                 TNZ     s:14448

      351    14318                      %IF CP6;
      352    14319    2                 AND ENTRY_TYPE = %SUBROUTINE
      353    14320                      %ENDIF;
      354    14321    2                 THEN
      355    14322    3            IF EXIT_PROG$ ~= ADDR(NIL) AND NOT EXIT_PROG_FOUND THEN DO;

  14322 27 000026   000033 236000 0                  LDQ     EXIT_PROG$
        27 000027   000000 116000 28                 CMPQ    0
        27 000030   000245 600000 27                 TZE     s:14448
        27 000031   000034 234000 0                  SZN     EXIT_PROG_FOUND
        27 000032   000245 604000 27                 TMI     s:14448

      356    14323                   /* EXIT PROGRAM in any USE procedure can only terminate all
      357    14324                      active USE procedures, and then UNWIND to an EXIT PROGRAM
      358    14325                      statement in the program, but there is none, so, create
      359    14326                      one, along with a label to which to UNWIND. */
      360    14327    3              TEMP$ = PREV_ILS$;

  14327 27 000033   000001 236000 0                  LDQ     PREV_ILS$
        27 000034   000110 756000 0                  STQ     TEMP$

      361    14328                   %RESERVE_ILS (ITEM=%OPN, POINTER=PREV_ILS$->ILS.NEXT);

  14348 27 000035   000002 236000 7                  LDQ     ILS_+2
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:119  
        27 000036   000004 036007                    ADLQ    4,DL
        27 000037   000003 116000 7                  CMPQ    ILS_+3
        27 000040   000051 602000 27                 TNC     s:14350

  14349 27 000041   000002 236000 28                 LDQ     2
        27 000042   000130 756000 0                  STQ     OPT_FLAG+1
        27 000043   000130 633400 0                  EPPR3   OPT_FLAG+1
        27 000044   000131 453400 0                  STP3    OPT_FLAG+2
        27 000045   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 000046   000001 631400 28                 EPPR1   1
        27 000047   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000050   000000 011000                    NOP     0

  14350 27 000051   000002 236000 7                  LDQ     ILS_+2
        27 000052   000022 736000                    QLS     18
        27 000053   000001 036000 7                  ADLQ    ILS_+1
        27 000054   000001 470400 0                  LDP0    PREV_ILS$
        27 000055   000002 756100                    STQ     2,,PR0

  14351 27 000056   000002 235000 7                  LDA     ILS_+2
        27 000057   000004 035007                    ADLA    4,DL
        27 000060   000002 755000 7                  STA     ILS_+2

  14352 27 000061   000002 471500                    LDP1    2,,PR0
        27 000062   000740 220003                    LDX0    480,DU
        27 000063   100000 740100                    STX0    0,,PR1

  14353 27 000064   000002 471500                    LDP1    2,,PR0
        27 000065   000000 236000 28                 LDQ     0
        27 000066   100002 756100                    STQ     2,,PR1

      362    14357                   %NEXT_ILS (POINTER=PREV_ILS$);

  14359 27 000067   000002 236100                    LDQ     2,,PR0
        27 000070   000001 756000 0                  STQ     PREV_ILS$

      363    14362                   %RESERVE_ILL (ITEM=%LINOI, POINTER=PREV_ILS$->ILS.ILL$);
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:120  

  14364 27 000071   000145 235000 xsym               LDA     ILL_STEP+101
        27 000072   000000 755000 1                  STA     ITERATION

  14365 27 000073   000002 236000 11                 LDQ     ILL_+2
        27 000074   000000 036000 1                  ADLQ    ITERATION
        27 000075   000003 116000 11                 CMPQ    ILL_+3
        27 000076   000107 604000 27                 TMI     s:14367

  14366 27 000077   000003 236000 28                 LDQ     3
        27 000100   000130 756000 0                  STQ     OPT_FLAG+1
        27 000101   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 000102   000131 450400 0                  STP0    OPT_FLAG+2
        27 000103   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 000104   000001 631400 28                 EPPR1   1
        27 000105   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000106   000000 011000                    NOP     0

  14367 27 000107   000002 236000 11                 LDQ     ILL_+2
        27 000110   000022 736000                    QLS     18
        27 000111   000001 036000 11                 ADLQ    ILL_+1
        27 000112   000001 470400 0                  LDP0    PREV_ILS$
        27 000113   000003 756100                    STQ     3,,PR0

  14368 27 000114   000002 236000 11                 LDQ     ILL_+2
        27 000115   000000 036000 1                  ADLQ    ITERATION
        27 000116   000002 756000 11                 STQ     ILL_+2

  14369 27 000117   000003 471500                    LDP1    3,,PR0
        27 000120   000373 220003                    LDX0    251,DU
        27 000121   100000 740100                    STX0    0,,PR1

      364    14372    3              PREV_ILS$->ILS.ILL$->LINOI.PREV_COL = COMCOM.CURRENT.COLUMN;

  14372 27 000122   000003 471500                    LDP1    3,,PR0
        27 000123   000134 721000 xsym               LXL1    COMCOM+92
        27 000124   100002 441100                    SXL1    2,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:121  

      365    14373    3              PREV_ILS$->ILS.ILL$->LINOI.COLUMN_NO = COMCOM.CURRENT.COLUMN;

  14373 27 000125   000003 471500                    LDP1    3,,PR0
        27 000126   000134 721000 xsym               LXL1    COMCOM+92
        27 000127   100001 741100                    STX1    1,,PR1

      366    14374    3              PREV_ILS$->ILS.ILL$->LINOI.PREV_LINE = COMCOM.CURRENT.LINE;

  14374 27 000130   000003 471500                    LDP1    3,,PR0
        27 000131   000133 721000 xsym               LXL1    COMCOM+91
        27 000132   100000 441100                    SXL1    0,,PR1

      367    14375    3              PREV_ILS$->ILS.ILL$->LINOI.LINE_NO = COMCOM.CURRENT.LINE;

  14375 27 000133   000003 471500                    LDP1    3,,PR0
        27 000134   000133 721000 xsym               LXL1    COMCOM+91
        27 000135   100001 441100                    SXL1    1,,PR1

      368    14376                   %RESERVE_ILS (ITEM=%OPN, POINTER=PREV_ILS$->ILS.NEXT);

  14396 27 000136   000002 236000 7                  LDQ     ILS_+2
        27 000137   000004 036007                    ADLQ    4,DL
        27 000140   000003 116000 7                  CMPQ    ILS_+3
        27 000141   000152 602000 27                 TNC     s:14398

  14397 27 000142   000002 236000 28                 LDQ     2
        27 000143   000130 756000 0                  STQ     OPT_FLAG+1
        27 000144   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 000145   000131 451400 0                  STP1    OPT_FLAG+2
        27 000146   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 000147   000001 631400 28                 EPPR1   1
        27 000150   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000151   000000 011000                    NOP     0

  14398 27 000152   000002 236000 7                  LDQ     ILS_+2
        27 000153   000022 736000                    QLS     18
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:122  
        27 000154   000001 036000 7                  ADLQ    ILS_+1
        27 000155   000001 470400 0                  LDP0    PREV_ILS$
        27 000156   000002 756100                    STQ     2,,PR0

  14399 27 000157   000002 235000 7                  LDA     ILS_+2
        27 000160   000004 035007                    ADLA    4,DL
        27 000161   000002 755000 7                  STA     ILS_+2

  14400 27 000162   000002 471500                    LDP1    2,,PR0
        27 000163   000740 220003                    LDX0    480,DU
        27 000164   100000 740100                    STX0    0,,PR1

  14401 27 000165   000002 471500                    LDP1    2,,PR0
        27 000166   000000 236000 28                 LDQ     0
        27 000167   100002 756100                    STQ     2,,PR1

      369    14405                   %NEXT_ILS (POINTER=PREV_ILS$);

  14407 27 000170   000002 236100                    LDQ     2,,PR0
        27 000171   000001 756000 0                  STQ     PREV_ILS$

      370    14410                   %RESERVE_ILL (ITEM=%DEFLB, POINTER=PREV_ILS$->ILS.ILL$);

  14412 27 000172   000120 235000 xsym               LDA     ILL_STEP+80
        27 000173   000000 755000 1                  STA     ITERATION

  14413 27 000174   000002 236000 11                 LDQ     ILL_+2
        27 000175   000000 036000 1                  ADLQ    ITERATION
        27 000176   000003 116000 11                 CMPQ    ILL_+3
        27 000177   000210 604000 27                 TMI     s:14415

  14414 27 000200   000003 236000 28                 LDQ     3
        27 000201   000130 756000 0                  STQ     OPT_FLAG+1
        27 000202   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 000203   000131 450400 0                  STP0    OPT_FLAG+2
        27 000204   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 000205   000001 631400 28                 EPPR1   1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:123  
        27 000206   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000207   000000 011000                    NOP     0

  14415 27 000210   000002 236000 11                 LDQ     ILL_+2
        27 000211   000022 736000                    QLS     18
        27 000212   000001 036000 11                 ADLQ    ILL_+1
        27 000213   000001 470400 0                  LDP0    PREV_ILS$
        27 000214   000003 756100                    STQ     3,,PR0

  14416 27 000215   000002 236000 11                 LDQ     ILL_+2
        27 000216   000000 036000 1                  ADLQ    ITERATION
        27 000217   000002 756000 11                 STQ     ILL_+2

  14417 27 000220   000003 471500                    LDP1    3,,PR0
        27 000221   000346 220003                    LDX0    230,DU
        27 000222   100000 740100                    STX0    0,,PR1

      371    14420    3              PREV_ILS$->ILS.ILL$->ILL.LOP = EXIT_PROG$;

  14420 27 000223   000003 471500                    LDP1    3,,PR0
        27 000224   000033 236000 0                  LDQ     EXIT_PROG$
        27 000225   100001 756100                    STQ     1,,PR1

      372    14421    3              EXIT_PROG$->LABEL.PREV_ILS$ = TEMP$;

  14421 27 000226   000110 236000 0                  LDQ     TEMP$
        27 000227   000033 471400 0                  LDP1    EXIT_PROG$
        27 000230   100010 756100                    STQ     8,,PR1

      373    14422    3              IF FALL_THRU_FLAG ~= 0 THEN

  14422 27 000231   000053 235000 0                  LDA     FALL_THRU_FLAG
        27 000232   000236 600000 27                 TZE     s:14424

      374    14423    3                EXIT_PROG$->LABEL.B.FALL_THRU = TRUE;

  14423 27 000233   000033 471400 0                  LDP1    EXIT_PROG$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:124  
        27 000234   002000 236003                    LDQ     1024,DU
        27 000235   100003 256100                    ORSQ    3,,PR1

      375    14424    3              EXIT_PROG$->LABEL.B.PHASE_2 = TRUE;

  14424 27 000236   000033 471400 0                  LDP1    EXIT_PROG$
        27 000237   004000 236003                    LDQ     2048,DU
        27 000240   100003 256100                    ORSQ    3,,PR1

      376    14425    3              EXIT_PROG_FOUND = TRUE;

  14425 27 000241   400000 236003                    LDQ     -131072,DU
        27 000242   000034 756000 0                  STQ     EXIT_PROG_FOUND

      377    14426    3              FALL_THRU_FLAG = 1;

  14426 27 000243   000001 235007                    LDA     1,DL
        27 000244   000053 755000 0                  STA     FALL_THRU_FLAG

      378    14427    3            END;

      379    14428               %RESERVE_ILS (ITEM=%OPN, POINTER=PREV_ILS$->ILS.NEXT) ;

  14448 27 000245   000002 236000 7                  LDQ     ILS_+2
        27 000246   000004 036007                    ADLQ    4,DL
        27 000247   000003 116000 7                  CMPQ    ILS_+3
        27 000250   000261 602000 27                 TNC     s:14450

  14449 27 000251   000002 236000 28                 LDQ     2
        27 000252   000130 756000 0                  STQ     OPT_FLAG+1
        27 000253   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 000254   000131 451400 0                  STP1    OPT_FLAG+2
        27 000255   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 000256   000001 631400 28                 EPPR1   1
        27 000257   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000260   000000 011000                    NOP     0

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:125  
  14450 27 000261   000002 236000 7                  LDQ     ILS_+2
        27 000262   000022 736000                    QLS     18
        27 000263   000001 036000 7                  ADLQ    ILS_+1
        27 000264   000001 470400 0                  LDP0    PREV_ILS$
        27 000265   000002 756100                    STQ     2,,PR0

  14451 27 000266   000002 235000 7                  LDA     ILS_+2
        27 000267   000004 035007                    ADLA    4,DL
        27 000270   000002 755000 7                  STA     ILS_+2

  14452 27 000271   000002 471500                    LDP1    2,,PR0
        27 000272   000740 220003                    LDX0    480,DU
        27 000273   100000 740100                    STX0    0,,PR1

  14453 27 000274   000002 471500                    LDP1    2,,PR0
        27 000275   000000 236000 28                 LDQ     0
        27 000276   100002 756100                    STQ     2,,PR1

      380    14457               %NEXT_ILS (POINTER=PREV_ILS$) ;

  14459 27 000277   000002 236100                    LDQ     2,,PR0
        27 000300   000001 756000 0                  STQ     PREV_ILS$

      381    14462    2          IF ENTRY_TYPE = %MAIN_PROGRAM AND

  14462 27 000301   000107 235000 0                  LDA     ENTRY_TYPE
        27 000302   000341 601000 27                 TNZ     s:14475
        27 000303   000053 234000 xsym               SZN     COMCOM+43
        27 000304   000341 604000 27                 TMI     s:14475
        27 000305   000050 234000 xsym               SZN     COMCOM+40
        27 000306   000341 604000 27                 TMI     s:14475

      382    14463    2            NOT COMCOM.OB.TP AND NOT COMCOM.OB.TP8 THEN
      383    14464                   %RESERVE_ILL (ITEM=%STOP, POINTER=PREV_ILS$->ILS.ILL$) ;

  14466 27 000307   000111 235000 xsym               LDA     ILL_STEP+73
        27 000310   000000 755000 1                  STA     ITERATION
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:126  

  14467 27 000311   000002 236000 11                 LDQ     ILL_+2
        27 000312   000000 036000 1                  ADLQ    ITERATION
        27 000313   000003 116000 11                 CMPQ    ILL_+3
        27 000314   000325 604000 27                 TMI     s:14469

  14468 27 000315   000003 236000 28                 LDQ     3
        27 000316   000130 756000 0                  STQ     OPT_FLAG+1
        27 000317   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 000320   000131 450400 0                  STP0    OPT_FLAG+2
        27 000321   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 000322   000001 631400 28                 EPPR1   1
        27 000323   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000324   000000 011000                    NOP     0

  14469 27 000325   000002 236000 11                 LDQ     ILL_+2
        27 000326   000022 736000                    QLS     18
        27 000327   000001 036000 11                 ADLQ    ILL_+1
        27 000330   000001 470400 0                  LDP0    PREV_ILS$
        27 000331   000003 756100                    STQ     3,,PR0

  14470 27 000332   000002 236000 11                 LDQ     ILL_+2
        27 000333   000000 036000 1                  ADLQ    ITERATION
        27 000334   000002 756000 11                 STQ     ILL_+2

  14471 27 000335   000003 471500                    LDP1    3,,PR0
        27 000336   000337 220003                    LDX0    223,DU
        27 000337   100000 740100                    STX0    0,,PR1

  14472 27 000340   000503 710000 27                 TRA     s:14537

      384    14474    3            ELSE DO ;

      385    14475    3              TEMP$ = CURRENT_PROC$->PROC_.PROC_SUPP$->PROC_SUPP.IO_RESTORE_CHAIN$;

  14475 27 000341   000111 470400 0                  LDP0    CURRENT_PROC$
        27 000342   000001 471500                    LDP1    1,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:127  
        27 000343   100021 236100                    LDQ     17,,PR1
        27 000344   000110 756000 0                  STQ     TEMP$

      386    14476    4              DO WHILE TEMP$ ~= ADDR(NIL); /* Restore caller's USE pointers */

  14476 27 000345   000445 710000 27                 TRA     s:14524

      387    14477                     %RESERVE_ILL (ITEM=%MVII, POINTER=PREV_ILS$->ILS.ILL$);

  14479 27 000346   000017 235000 xsym               LDA     ILL_STEP+15
        27 000347   000000 755000 1                  STA     ITERATION

  14480 27 000350   000002 236000 11                 LDQ     ILL_+2
        27 000351   000000 036000 1                  ADLQ    ITERATION
        27 000352   000003 116000 11                 CMPQ    ILL_+3
        27 000353   000364 604000 27                 TMI     s:14482

  14481 27 000354   000003 236000 28                 LDQ     3
        27 000355   000130 756000 0                  STQ     OPT_FLAG+1
        27 000356   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 000357   000131 450400 0                  STP0    OPT_FLAG+2
        27 000360   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 000361   000001 631400 28                 EPPR1   1
        27 000362   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000363   000000 011000                    NOP     0

  14482 27 000364   000002 236000 11                 LDQ     ILL_+2
        27 000365   000022 736000                    QLS     18
        27 000366   000001 036000 11                 ADLQ    ILL_+1
        27 000367   000001 470400 0                  LDP0    PREV_ILS$
        27 000370   000003 756100                    STQ     3,,PR0

  14483 27 000371   000002 236000 11                 LDQ     ILL_+2
        27 000372   000000 036000 1                  ADLQ    ITERATION
        27 000373   000002 756000 11                 STQ     ILL_+2

  14484 27 000374   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:128  
        27 000375   000245 220003                    LDX0    165,DU
        27 000376   100000 740100                    STX0    0,,PR1

      388    14487    4                PREV_ILS$->ILS.ILL$->ILL.LOP = TEMP$->IO_RESTORE_CHAIN.TO$;

  14487 27 000377   000003 471500                    LDP1    3,,PR0
        27 000400   000110 473400 0                  LDP3    TEMP$
        27 000401   300002 236100                    LDQ     2,,PR3
        27 000402   100001 756100                    STQ     1,,PR1

      389    14488    4                PREV_ILS$->ILS.ILL$->ILL.ROP = TEMP$->IO_RESTORE_CHAIN.RESTORE$;

  14488 27 000403   000003 471500                    LDP1    3,,PR0
        27 000404   300001 236100                    LDQ     1,,PR3
        27 000405   100002 756100                    STQ     2,,PR1

      390    14489                     %RESERVE_ILS (ITEM=%OPN, POINTER=PREV_ILS$->ILS.NEXT);

  14509 27 000406   000002 236000 7                  LDQ     ILS_+2
        27 000407   000004 036007                    ADLQ    4,DL
        27 000410   000003 116000 7                  CMPQ    ILS_+3
        27 000411   000422 602000 27                 TNC     s:14511

  14510 27 000412   000002 236000 28                 LDQ     2
        27 000413   000130 756000 0                  STQ     OPT_FLAG+1
        27 000414   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 000415   000131 451400 0                  STP1    OPT_FLAG+2
        27 000416   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 000417   000001 631400 28                 EPPR1   1
        27 000420   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000421   000000 011000                    NOP     0

  14511 27 000422   000002 236000 7                  LDQ     ILS_+2
        27 000423   000022 736000                    QLS     18
        27 000424   000001 036000 7                  ADLQ    ILS_+1
        27 000425   000001 470400 0                  LDP0    PREV_ILS$
        27 000426   000002 756100                    STQ     2,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:129  

  14512 27 000427   000002 235000 7                  LDA     ILS_+2
        27 000430   000004 035007                    ADLA    4,DL
        27 000431   000002 755000 7                  STA     ILS_+2

  14513 27 000432   000002 471500                    LDP1    2,,PR0
        27 000433   000740 220003                    LDX0    480,DU
        27 000434   100000 740100                    STX0    0,,PR1

  14514 27 000435   000002 471500                    LDP1    2,,PR0
        27 000436   000000 236000 28                 LDQ     0
        27 000437   100002 756100                    STQ     2,,PR1

      391    14518                     %NEXT_ILS (POINTER=PREV_ILS$);

  14520 27 000440   000002 236100                    LDQ     2,,PR0
        27 000441   000001 756000 0                  STQ     PREV_ILS$

      392    14523    4                TEMP$ = TEMP$->IO_RESTORE_CHAIN.NEXT$;

  14523 27 000442   000110 470400 0                  LDP0    TEMP$
        27 000443   000004 236100                    LDQ     4,,PR0
        27 000444   000110 756000 0                  STQ     TEMP$

      393    14524    4              END; /* WHILE */

  14524 27 000445   000000 116000 28                 CMPQ    0
        27 000446   000346 601000 27                 TNZ     s:14479

      394    14525                   %RESERVE_ILL (ITEM=%EXIT_PROG, POINTER=PREV_ILS$->ILS.ILL$) ;

  14527 27 000447   000140 235000 xsym               LDA     ILL_STEP+96
        27 000450   000000 755000 1                  STA     ITERATION

  14528 27 000451   000002 236000 11                 LDQ     ILL_+2
        27 000452   000000 036000 1                  ADLQ    ITERATION
        27 000453   000003 116000 11                 CMPQ    ILL_+3
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:130  
        27 000454   000465 604000 27                 TMI     s:14530

  14529 27 000455   000003 236000 28                 LDQ     3
        27 000456   000130 756000 0                  STQ     OPT_FLAG+1
        27 000457   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 000460   000131 450400 0                  STP0    OPT_FLAG+2
        27 000461   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 000462   000001 631400 28                 EPPR1   1
        27 000463   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000464   000000 011000                    NOP     0

  14530 27 000465   000002 236000 11                 LDQ     ILL_+2
        27 000466   000022 736000                    QLS     18
        27 000467   000001 036000 11                 ADLQ    ILL_+1
        27 000470   000001 470400 0                  LDP0    PREV_ILS$
        27 000471   000003 756100                    STQ     3,,PR0

  14531 27 000472   000002 236000 11                 LDQ     ILL_+2
        27 000473   000000 036000 1                  ADLQ    ITERATION
        27 000474   000002 756000 11                 STQ     ILL_+2

  14532 27 000475   000003 471500                    LDP1    3,,PR0
        27 000476   000366 220003                    LDX0    246,DU
        27 000477   100000 740100                    STX0    0,,PR1

      395    14535    3              PREV_ILS$->ILS.ILL$->ILL.LOP = CURRENT_PROC$ ;

  14535 27 000500   000003 471500                    LDP1    3,,PR0
        27 000501   000111 236000 0                  LDQ     CURRENT_PROC$
        27 000502   100001 756100                    STQ     1,,PR1

      396    14536    3            END ;

      397    14537    2          PREV_ILS$->ILS.ILL$->ILL.CODE = %EXIT_PROG_PHASE2_CREATED ;

  14537 27 000503   000003 471500                    LDP1    3,,PR0
        27 000504   000001 220003                    LDX0    1,DU
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:131  
        27 000505   100000 440100                    SXL0    0,,PR1

      398    14538    2          PREV_ILS$->ILS.NEXT = ILS$ ;

  14538 27 000506   000000 236000 6                  LDQ     ILS$
        27 000507   000002 756100                    STQ     2,,PR0

      399    14539    2   END INSERT_STOP_OR_EXIT ;

  14539 27 000510   000112 221200 0                  LDX1  ! CURRENT_PROC$+1
        27 000511   000001 702211                    TSX2  ! 1,X1

      400    14540        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:132  
      401    14541    1   RESTORE_IO_CHAIN: PROC;

  14541 27 000512   000113 741200 0     RESTORE_IO_* STX1  ! CURRENT_PROC$+2

      402    14542
      403    14543        /*I*
      404    14544               NAME: RESTORE_IO_CHAIN
      405    14545               CALL: CALL RESTORE_IO_CHAIN;
      406    14546
      407    14547              INPUT: ILS$ - Pointer to the ILS item at which USE pointers are
      408    14548                            to be restored.
      409    14549                 IO: PREV_ILS$ - Pointer to ILS item before insertion.
      410    14550             OUTPUT: MVII items are generated to restore all a caller's USE
      411    14551                     pointers.
      412    14552        */
      413    14553
      414    14554    3          DO WHILE PREV_ILS$->ILS.NEXT ~= ILS$;

  14554 27 000513   000001 470400 0                  LDP0    PREV_ILS$
        27 000514   000002 236100                    LDQ     2,,PR0
        27 000515   000000 116000 6                  CMPQ    ILS$
        27 000516   000526 600000 27                 TZE     s:14561

      415    14555                 %NEXT_ILS (POINTER=PREV_ILS$);

  14557 27 000517   000001 470400 0                  LDP0    PREV_ILS$
        27 000520   000002 236100                    LDQ     2,,PR0
        27 000521   000001 756000 0                  STQ     PREV_ILS$

      416    14560    3          END;

  14560 27 000522   000001 470400 0                  LDP0    PREV_ILS$
        27 000523   000002 236100                    LDQ     2,,PR0
        27 000524   000000 116000 6                  CMPQ    ILS$
        27 000525   000517 601000 27                 TNZ     s:14557

      417    14561    2          TEMP$ = CURRENT_PROC$->PROC_.PROC_SUPP$->PROC_SUPP.IO_RESTORE_CHAIN$;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:133  

  14561 27 000526   000111 471400 0                  LDP1    CURRENT_PROC$
        27 000527   100001 473500                    LDP3    1,,PR1
        27 000530   300021 236100                    LDQ     17,,PR3
        27 000531   000110 756000 0                  STQ     TEMP$

      418    14562    3          DO WHILE TEMP$ ~= ADDR(NIL);

  14562 27 000532   000631 710000 27                 TRA     s:14610

      419    14563                 %RESERVE_ILS (ITEM=%OPN, POINTER=PREV_ILS$->ILS.NEXT);

  14583 27 000533   000002 236000 7                  LDQ     ILS_+2
        27 000534   000004 036007                    ADLQ    4,DL
        27 000535   000003 116000 7                  CMPQ    ILS_+3
        27 000536   000547 602000 27                 TNC     s:14585

  14584 27 000537   000002 236000 28                 LDQ     2
        27 000540   000130 756000 0                  STQ     OPT_FLAG+1
        27 000541   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 000542   000131 450400 0                  STP0    OPT_FLAG+2
        27 000543   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 000544   000001 631400 28                 EPPR1   1
        27 000545   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000546   000000 011000                    NOP     0

  14585 27 000547   000002 236000 7                  LDQ     ILS_+2
        27 000550   000022 736000                    QLS     18
        27 000551   000001 036000 7                  ADLQ    ILS_+1
        27 000552   000001 470400 0                  LDP0    PREV_ILS$
        27 000553   000002 756100                    STQ     2,,PR0

  14586 27 000554   000002 235000 7                  LDA     ILS_+2
        27 000555   000004 035007                    ADLA    4,DL
        27 000556   000002 755000 7                  STA     ILS_+2

  14587 27 000557   000002 471500                    LDP1    2,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:134  
        27 000560   000740 220003                    LDX0    480,DU
        27 000561   100000 740100                    STX0    0,,PR1

  14588 27 000562   000002 471500                    LDP1    2,,PR0
        27 000563   000000 236000 28                 LDQ     0
        27 000564   100002 756100                    STQ     2,,PR1

      420    14592                 %NEXT_ILS (POINTER=PREV_ILS$);

  14594 27 000565   000002 236100                    LDQ     2,,PR0
        27 000566   000001 756000 0                  STQ     PREV_ILS$

      421    14597                 %RESERVE_ILL (ITEM=%MVII, POINTER=PREV_ILS$->ILS.ILL$);

  14599 27 000567   000017 235000 xsym               LDA     ILL_STEP+15
        27 000570   000000 755000 1                  STA     ITERATION

  14600 27 000571   000002 236000 11                 LDQ     ILL_+2
        27 000572   000000 036000 1                  ADLQ    ITERATION
        27 000573   000003 116000 11                 CMPQ    ILL_+3
        27 000574   000605 604000 27                 TMI     s:14602

  14601 27 000575   000003 236000 28                 LDQ     3
        27 000576   000130 756000 0                  STQ     OPT_FLAG+1
        27 000577   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 000600   000131 450400 0                  STP0    OPT_FLAG+2
        27 000601   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 000602   000001 631400 28                 EPPR1   1
        27 000603   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 000604   000000 011000                    NOP     0

  14602 27 000605   000002 236000 11                 LDQ     ILL_+2
        27 000606   000022 736000                    QLS     18
        27 000607   000001 036000 11                 ADLQ    ILL_+1
        27 000610   000001 470400 0                  LDP0    PREV_ILS$
        27 000611   000003 756100                    STQ     3,,PR0

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:135  
  14603 27 000612   000002 236000 11                 LDQ     ILL_+2
        27 000613   000000 036000 1                  ADLQ    ITERATION
        27 000614   000002 756000 11                 STQ     ILL_+2

  14604 27 000615   000003 471500                    LDP1    3,,PR0
        27 000616   000245 220003                    LDX0    165,DU
        27 000617   100000 740100                    STX0    0,,PR1

      422    14607    3            PREV_ILS$->ILS.ILL$->ILL.LOP = TEMP$->IO_RESTORE_CHAIN.TO$;

  14607 27 000620   000003 471500                    LDP1    3,,PR0
        27 000621   000110 473400 0                  LDP3    TEMP$
        27 000622   300002 236100                    LDQ     2,,PR3
        27 000623   100001 756100                    STQ     1,,PR1

      423    14608    3            PREV_ILS$->ILS.ILL$->ILL.ROP = TEMP$->IO_RESTORE_CHAIN.RESTORE$;

  14608 27 000624   000003 471500                    LDP1    3,,PR0
        27 000625   300001 236100                    LDQ     1,,PR3
        27 000626   100002 756100                    STQ     2,,PR1

      424    14609    3            TEMP$ = TEMP$->IO_RESTORE_CHAIN.NEXT$;

  14609 27 000627   300004 236100                    LDQ     4,,PR3
        27 000630   000110 756000 0                  STQ     TEMP$

      425    14610    3          END;

  14610 27 000631   000000 116000 28                 CMPQ    0
        27 000632   000533 601000 27                 TNZ     s:14583

      426    14611    2          PREV_ILS$->ILS.NEXT = ILS$ ;

  14611 27 000633   000000 236000 6                  LDQ     ILS$
        27 000634   000002 756100                    STQ     2,,PR0

      427    14612    2   END RESTORE_IO_CHAIN;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:136  

  14612 27 000635   000113 221200 0                  LDX1  ! CURRENT_PROC$+2
        27 000636   000001 702211                    TSX2  ! 1,X1

      428    14613        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:137  
      429    14614    1   OPTIMIZE_CALL: PROC (CALLEE$) ALTRET ;

  14614 27 000637   000114 741200 0     OPTIMIZE_CA* STX1  ! CURRENT_PROC$+3

      430    14615        /*I*
      431    14616               NAME: OPTIMIZE_CALL
      432    14617               CALL: CALL OPTIMIZE_CALL (CALLEE$);
      433    14618              INPUT: CALLEE$ - Pointer to PROC_DEF for subroutine being called.
      434    14619             OUTPUT: If the subroutine is internal, is called exactly once, and
      435    14620                     certain other requirements are met, the subroutine's ILL
      436    14621                     is moved in line in place of the CALL.
      437    14622        */
      438    14623        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:138  
      439    14624    2   DCL   CALLEE$ PTR ;
      440    14625    2   DCL   PROC1$ PTR;
      441    14626    2   DCL   FATHER_PROC$ PTR;
      442    14627    2   DCL   PARAMLIST$ PTR ;
      443    14628    2   DCL   PARAM$ PTR ;
      444    14629    2   DCL   ARG$ PTR ;
      445    14630    2   DCL   BASE$ PTR;
      446    14631    2   DCL   ENTRY$ PTR ;
      447    14632    2   DCL   SEARCH_ILL$ PTR ;
      448    14633    2   DCL   N UBIN ;
      449    14634    2   DCL   OPT_FLAG BIT (1) ;
      450    14635    2   DCL   BASED$PTR$ PTR BASED;
      451    14636          /**/
      452    14637    2          IF CALLEE$->PROC_DEF.ID ~= %INTDEF OR NOT COMCOM.OB.OPTZ OR

  14637 27 000640   000115 470400 0                  LDP0    @CALLEE$
        27 000641   000000 471500                    LDP1    0,,PR0
        27 000642   100000 220100                    LDX0    0,,PR1
        27 000643   000776 100003                    CMPX0   510,DU
        27 000644   002254 601000 27                 TNZ     CANT_OPTIMIZE
        27 000645   000014 234000 xsym               SZN     COMCOM+12
        27 000646   002254 605000 27                 TPL     CANT_OPTIMIZE
        27 000647   000112 235000 xsym               LDA     COMCOM+74
        27 000650   002254 601000 27                 TNZ     CANT_OPTIMIZE
        27 000651   000463 234000 xsym               SZN     COMCOM+307
        27 000652   002254 604000 27                 TMI     CANT_OPTIMIZE
        27 000653   000011 234000 25                 SZN     O2COM+9
        27 000654   002254 604000 27                 TMI     CANT_OPTIMIZE

      453    14638    2              COMCOM.OB.COUNT OR
      454    14639    2              COMCOM.CANCEL_ID OR O2COM.CALL_ID THEN GOTO CANT_OPTIMIZE ;
      455    14640    2          PROC1$ = CALLEE$->INTDEF.PROC$ ;

  14640 27 000655   100011 236100                    LDQ     9,,PR1
        27 000656   000116 756000 0                  STQ     PROC1$

      456    14641    2          IF PROC1$->PROC_.B.CANCELED OR PROC1$->PROC_.B.INITIAL OR
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:139  

  14641 27 000657   000116 473400 0                  LDP3    PROC1$
        27 000660   300003 236100                    LDQ     3,,PR3
        27 000661   100000 316003                    CANQ    32768,DU
        27 000662   002254 601000 27                 TNZ     CANT_OPTIMIZE
        27 000663   200000 316003                    CANQ    65536,DU
        27 000664   002254 601000 27                 TNZ     CANT_OPTIMIZE
        27 000665   300001 474500                    LDP4    1,,PR3
        27 000666   400020 235100                    LDA     16,,PR4
        27 000667   000001 115007                    CMPA    1,DL
        27 000670   002254 601000 27                 TNZ     CANT_OPTIMIZE

      457    14642    2              PROC1$->PROC_.PROC_SUPP$->PROC_SUPP.REF_COUNT ~= 1 THEN
      458    14643    2              GOTO CANT_OPTIMIZE ;
      459    14644    2          PARAMLIST$ = PROC1$->PROC_.PROC_DEF$->INTDEF.ARGLIST$ ;

  14644 27 000671   300006 475500                    LDP5    6,,PR3
        27 000672   500005 236100                    LDQ     5,,PR5
        27 000673   000120 756000 0                  STQ     PARAMLIST$

      460    14645    2          LTS$ = ILL$->ILL.LOP; /* PTR to arg list */

  14645 27 000674   000000 476400 10                 LDP6    ILL$
        27 000675   600001 236100                    LDQ     1,,PR6
        27 000676   000000 756000 16                 STQ     LTS$

      461    14646    3          IF PARAMLIST$ = ADDR(NIL) THEN DO ; /* Subroutine, no args */

  14646 27 000677   000120 236000 0                  LDQ     PARAMLIST$
        27 000700   000000 116000 28                 CMPQ    0
        27 000701   000707 601000 27                 TNZ     s:14650

      462    14647    3            IF LTS$->ARGLIST.N = 1 THEN GOTO PROC_NO_PARAMS ;

  14647 27 000702   000000 471400 16                 LDP1    LTS$
        27 000703   100000 720100                    LXL0    0,,PR1
        27 000704   000001 100003                    CMPX0   1,DU
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:140  
        27 000705   000766 600000 27                 TZE     PROC_NO_PARAMS

      463    14648    3            GOTO CANT_OPTIMIZE ;

  14648 27 000706   002254 710000 27                 TRA     CANT_OPTIMIZE

      464    14649    3          END ;
      465    14650    2          IF PARAMLIST$->ARGLIST.N ~= LTS$->ARGLIST.N THEN

  14650 27 000707   000000 471400 16                 LDP1    LTS$
        27 000710   000120 477400 0                  LDP7    PARAMLIST$
        27 000711   700000 236100                    LDQ     0,,PR7
        27 000712   100000 676100                    ERQ     0,,PR1
        27 000713   777777 376007                    ANQ     -1,DL
        27 000714   002254 601000 27                 TNZ     CANT_OPTIMIZE

      466    14651    2              GOTO CANT_OPTIMIZE ; /* Wrong number of args */
      467    14652    2          OPT_FLAG = TRUE ; /* Be optimistic - assume CALL is optimizable */

  14652 27 000715   400000 236003                    LDQ     -131072,DU
        27 000716   000127 756000 0                  STQ     OPT_FLAG

      468    14653    3          DO N = 2 TO PARAMLIST$->ARGLIST.N ;

  14653 27 000717   000002 235007                    LDA     2,DL
        27 000720   000126 755000 0                  STA     N
        27 000721   000757 710000 27                 TRA     s:14665+3

      469    14654    3            PARAM$ = PARAMLIST$->ARGLIST.ARG$ (N - 2) ;

  14654 27 000722   000120 470400 0                  LDP0    PARAMLIST$
        27 000723   000126 720000 0                  LXL0    N
        27 000724   077777 236110                    LDQ     -1,X0,PR0
        27 000725   000121 756000 0                  STQ     PARAM$

      470    14655    3            ARG$ = LTS$->ARGLIST.ARG$ (N - 2) ->ETT.LOP ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:141  
  14655 27 000726   000000 471400 16                 LDP1    LTS$
        27 000727   177777 473510                    LDP3    -1,X0,PR1
        27 000730   300001 236100                    LDQ     1,,PR3
        27 000731   000122 756000 0                  STQ     ARG$

      471    14656                 /* Parameter arglist points to ST items, while CALL arglist
      472    14657                    points to BASE items. */
      473    14658    3            IF PARAM$->VARIABLE.B.REDEF_SUB THEN OPT_FLAG = FALSE ;

  14658 27 000732   000121 474400 0                  LDP4    PARAM$
        27 000733   400003 430100                    FSZN    3,,PR4
        27 000734   000737 605000 27                 TPL     s:14659

  14658 27 000735   000127 450000 0                  STZ     OPT_FLAG
        27 000736   000754 710000 27                 TRA     s:14665

      474    14659    3            ELSE IF NOT PARAM$->VARIABLE.B.ELEMENTARY OR NOT ARG$->

  14659 27 000737   400003 236100                    LDQ     3,,PR4
        27 000740   010000 316003                    CANQ    4096,DU
        27 000741   000746 600000 27                 TZE     s:14661
        27 000742   000122 475400 0                  LDP5    ARG$
        27 000743   500003 236100                    LDQ     3,,PR5
        27 000744   010000 316003                    CANQ    4096,DU
        27 000745   000750 601000 27                 TNZ     s:14663

      475    14660    4                VARIABLE.B.ELEMENTARY THEN DO ;

      476    14661    4              OPT_FLAG = FALSE ; /* Cannot verify that structures match */

  14661 27 000746   000127 450000 0                  STZ     OPT_FLAG

      477    14662    4            END ;

  14662 27 000747   000754 710000 27                 TRA     s:14665

      478    14663    3            ELSE IF PARAM$->VARIABLE.TYPE ~= ARG$->VARIABLE.TYPE THEN
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:142  

  14663 27 000750   400002 221100                    LDX1    2,,PR4
        27 000751   500002 101100                    CMPX1   2,,PR5
        27 000752   000754 600000 27                 TZE     s:14665

      479    14664    3              OPT_FLAG = FALSE ;

  14664 27 000753   000127 450000 0                  STZ     OPT_FLAG

      480    14665    3          END ;

  14665 27 000754   000126 235000 0                  LDA     N
        27 000755   000001 035007                    ADLA    1,DL
        27 000756   000126 755000 0                  STA     N
        27 000757   000120 470400 0                  LDP0    PARAMLIST$
        27 000760   000000 236100                    LDQ     0,,PR0
        27 000761   777777 376007                    ANQ     -1,DL
        27 000762   000126 116000 0                  CMPQ    N
        27 000763   000722 603000 27                 TRC     s:14654

      481    14666    2          IF NOT OPT_FLAG THEN GOTO CANT_OPTIMIZE ;

  14666 27 000764   000127 234000 0                  SZN     OPT_FLAG
        27 000765   002254 605000 27                 TPL     CANT_OPTIMIZE

      482    14667               /* Transfer the subroutine text in line. */
      483    14668    2   PROC_NO_PARAMS:
      484    14669    2          DEFLB_FOLLOWS = FALSE ;

  14669 27 000766   000055 450000 0     PROC_NO_PAR* STZ     DEFLB_FOLLOWS

      485    14670    2          TEMP$ = ILS$ ;

  14670 27 000767   000000 236000 6                  LDQ     ILS$
        27 000770   000110 756000 0                  STQ     TEMP$

      486    14671               %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:143  

  14681 27 000771   000110 470400 0                  LDP0    TEMP$
        27 000772   000002 236100                    LDQ     2,,PR0
        27 000773   000110 756000 0                  STQ     TEMP$

  14684 27 000774   000110 470400 0                  LDP0    TEMP$
        27 000775   000003 236100                    LDQ     3,,PR0
        27 000776   000000 116000 28                 CMPQ    0
        27 000777   000771 600000 27                 TZE     s:14681
        27 001000   000003 471500                    LDP1    3,,PR0
        27 001001   100000 220100                    LDX0    0,,PR1
        27 001002   000343 100003                    CMPX0   227,DU
        27 001003   000771 600000 27                 TZE     s:14681
        27 001004   000422 100003                    CMPX0   274,DU
        27 001005   000771 600000 27                 TZE     s:14681
        27 001006   000446 100003                    CMPX0   294,DU
        27 001007   000771 600000 27                 TZE     s:14681
        27 001010   000336 100003                    CMPX0   222,DU
        27 001011   000771 600000 27                 TZE     s:14681
        27 001012   000420 100003                    CMPX0   272,DU
        27 001013   000771 600000 27                 TZE     s:14681
        27 001014   000373 100003                    CMPX0   251,DU
        27 001015   000771 600000 27                 TZE     s:14681

      487    14686    3          IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB THEN DO ;

  14686 27 001016   000346 100003                    CMPX0   230,DU
        27 001017   001024 601000 27                 TNZ     s:14692

      488    14687    3            DEFLB_FOLLOWS = TRUE ;

  14687 27 001020   400000 236003                    LDQ     -131072,DU
        27 001021   000055 756000 0                  STQ     DEFLB_FOLLOWS

      489    14688    3            LABEL_AFTER_PFORM$ = TEMP$->ILS.ILL$->ILL.LOP ;

  14688 27 001022   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:144  
        27 001023   000056 756000 0                  STQ     LABEL_AFTER_PFORM$

      490    14689    3          END ;

      491    14690               /* Set SEARCH_ILS$ to point to the ILS for the first ENTRY in the
      492    14691                  subroutine. */
      493    14692    2          COPY_ILS$ = ADDR(NIL) ;

  14692 27 001024   000000 236000 28                 LDQ     0
        27 001025   000020 756000 0                  STQ     COPY_ILS$

      494    14693    2          TEMP$ = PROC1$->PROC_.PROC_DEF$ ;

  14693 27 001026   000116 471400 0                  LDP1    PROC1$
        27 001027   100006 236100                    LDQ     6,,PR1
        27 001030   000110 756000 0                  STQ     TEMP$

      495    14694    2          SEARCH_ILS$ = COMCOM.INT_SUB$ ;

  14694 27 001031   000361 236000 xsym               LDQ     COMCOM+241
        27 001032   000077 756000 0                  STQ     SEARCH_ILS$

      496    14695    2          ENTRY$ = COMCOM.INT_SUB$ ;

  14695 27 001033   000124 756000 0                  STQ     ENTRY$

      497    14696    3          DO WHILE SEARCH_ILS$->ILS.ILL$->ENTRY_ILL.LOP ~= TEMP$ ;

  14696 27 001034   000077 470400 0                  LDP0    SEARCH_ILS$
        27 001035   000003 473500                    LDP3    3,,PR0
        27 001036   300001 236100                    LDQ     1,,PR3
        27 001037   000110 116000 0                  CMPQ    TEMP$
        27 001040   001062 600000 27                 TZE     s:14708

      498    14697    3            COPY_ILS$ = SEARCH_ILS$ ;

  14697 27 001041   000077 236000 0                  LDQ     SEARCH_ILS$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:145  
        27 001042   000020 756000 0                  STQ     COPY_ILS$

      499    14698    3            SEARCH_ILS$ = SEARCH_ILS$->ILS.ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ ;

  14698 27 001043   000077 470400 0                  LDP0    SEARCH_ILS$
        27 001044   000003 471500                    LDP1    3,,PR0
        27 001045   100003 236100                    LDQ     3,,PR1
        27 001046   000077 756000 0                  STQ     SEARCH_ILS$

      500    14699                 /* SEARCH_ILS$ should never be ADDR (NIL). */
      501    14700    3            IF SEARCH_ILS$->ILS.ILL$->ILL.LOP = CALLEE$ THEN

  14700 27 001047   000077 470400 0                  LDP0    SEARCH_ILS$
        27 001050   000003 471500                    LDP1    3,,PR0
        27 001051   000115 473400 0                  LDP3    @CALLEE$
        27 001052   100001 236100                    LDQ     1,,PR1
        27 001053   300000 116100                    CMPQ    0,,PR3
        27 001054   001057 601000 27                 TNZ     s:14702

      502    14701    3              ENTRY$ = SEARCH_ILS$ ; /* ILS for the ENTRY that is called */

  14701 27 001055   000077 236000 0                  LDQ     SEARCH_ILS$
        27 001056   000124 756000 0                  STQ     ENTRY$

      503    14702    3          END ;

  14702 27 001057   100001 236100                    LDQ     1,,PR1
        27 001060   000110 116000 0                  CMPQ    TEMP$
        27 001061   001041 601000 27                 TNZ     s:14697

      504    14703               /* ENTRY$ is for the ENTRY that is called, and SEARCH_ILS$ for the
      505    14704                  main entry point of the subroutine. Normally they are the same, but
      506    14705                  they can differ, as in the case of a subroutine that is never
      507    14706                  called thru its main entry and is called only once thru another
      508    14707                  entry point. */
      509    14708    2          START_LABEL_ILS$ = SEARCH_ILS$ ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:146  
  14708 27 001062   000077 236000 0                  LDQ     SEARCH_ILS$
        27 001063   000006 756000 0                  STQ     START_LABEL_ILS$

      510    14709               %NEXT_NON_LINOI (POINTER=START_LABEL_ILS$) ; /* First DEFLB's ILS */

  14714 27 001064   000006 470400 0                  LDP0    START_LABEL_ILS$
        27 001065   000002 236100                    LDQ     2,,PR0
        27 001066   000006 756000 0                  STQ     START_LABEL_ILS$

  14717 27 001067   000006 470400 0                  LDP0    START_LABEL_ILS$
        27 001070   000003 236100                    LDQ     3,,PR0
        27 001071   000000 116000 28                 CMPQ    0
        27 001072   001064 600000 27                 TZE     s:14714
        27 001073   000003 471500                    LDP1    3,,PR0
        27 001074   100000 220100                    LDX0    0,,PR1
        27 001075   000373 100003                    CMPX0   251,DU
        27 001076   001064 600000 27                 TZE     s:14714

      511    14719    2          IF START_LABEL_ILS$->ILS.ILL$->ILL.ID ~= %DEFLB

  14719 27 001077   000346 100003                    CMPX0   230,DU
        27 001100   002254 601000 27                 TNZ     CANT_OPTIMIZE

      512    14720                 /* This can happen if there are USE procedures -- they must be in
      513    14721                    effect ONLY for the internal program -- or if segmentation is used
      514    14722                    by the internal program -- it is reasonable to sacrifice this
      515    14723                    optimization in this case too. */
      516    14724    2            THEN GOTO CANT_OPTIMIZE ;
      517    14725    2          PROC1$->PROC_.B.INLINE = TRUE ; /* So that the SCOPE and PEND

  14725 27 001101   000116 473400 0                  LDP3    PROC1$
        27 001102   001000 236003                    LDQ     512,DU
        27 001103   300003 256100                    ORSQ    3,,PR3

      518    14726                                                  can be scrapped later */
      519    14727    2          IF COPY_ILS$ = ADDR(NIL)

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:147  
  14727 27 001104   000020 236000 0                  LDQ     COPY_ILS$
        27 001105   000000 116000 28                 CMPQ    0
        27 001106   001114 601000 27                 TNZ     s:14729

      520    14728    2            THEN COMCOM.INT_SUB$ = SEARCH_ILS$->ILS.ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ ;

  14728 27 001107   000077 471400 0                  LDP1    SEARCH_ILS$
        27 001110   100003 474500                    LDP4    3,,PR1
        27 001111   400003 236100                    LDQ     3,,PR4
        27 001112   000361 756000 xsym               STQ     COMCOM+241
        27 001113   001122 710000 27                 TRA     s:14731

      521    14729    2            ELSE COPY_ILS$->ILS.ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ =

  14729 27 001114   000020 471400 0                  LDP1    COPY_ILS$
        27 001115   100003 474500                    LDP4    3,,PR1
        27 001116   000077 475400 0                  LDP5    SEARCH_ILS$
        27 001117   500003 476500                    LDP6    3,,PR5
        27 001120   600003 236100                    LDQ     3,,PR6
        27 001121   400003 756100                    STQ     3,,PR4

      522    14730    2                SEARCH_ILS$->ILS.ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ ;
      523    14731    2          SEARCH_ILS$->ILS.ILL$ = ADDR(NIL) ; /* Get rid of the %ENTRY */

  14731 27 001122   000000 236000 28                 LDQ     0
        27 001123   000077 471400 0                  LDP1    SEARCH_ILS$
        27 001124   100003 756100                    STQ     3,,PR1

      524    14732    3          IF ENTRY$ ~= SEARCH_ILS$ THEN DO ;

  14732 27 001125   000124 236000 0                  LDQ     ENTRY$
        27 001126   000077 116000 0                  CMPQ    SEARCH_ILS$
        27 001127   001226 600000 27                 TZE     s:14762

      525    14733                 %RESERVE_ILL (ITEM=%GO,POINTER=ILS$->ILS.ILL$) ;

  14735 27 001130   000116 235000 xsym               LDA     ILL_STEP+78
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:148  
        27 001131   000000 755000 1                  STA     ITERATION

  14736 27 001132   000002 236000 11                 LDQ     ILL_+2
        27 001133   000000 036000 1                  ADLQ    ITERATION
        27 001134   000003 116000 11                 CMPQ    ILL_+3
        27 001135   001146 604000 27                 TMI     s:14738

  14737 27 001136   000003 236000 28                 LDQ     3
        27 001137   000130 756000 0                  STQ     OPT_FLAG+1
        27 001140   000130 634400 0                  EPPR4   OPT_FLAG+1
        27 001141   000131 454400 0                  STP4    OPT_FLAG+2
        27 001142   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 001143   000001 631400 28                 EPPR1   1
        27 001144   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 001145   000000 011000                    NOP     0

  14738 27 001146   000002 236000 11                 LDQ     ILL_+2
        27 001147   000022 736000                    QLS     18
        27 001150   000001 036000 11                 ADLQ    ILL_+1
        27 001151   000000 470400 6                  LDP0    ILS$
        27 001152   000003 756100                    STQ     3,,PR0

  14739 27 001153   000002 236000 11                 LDQ     ILL_+2
        27 001154   000000 036000 1                  ADLQ    ITERATION
        27 001155   000002 756000 11                 STQ     ILL_+2

  14740 27 001156   000003 471500                    LDP1    3,,PR0
        27 001157   000344 220003                    LDX0    228,DU
        27 001160   100000 740100                    STX0    0,,PR1

      526    14743    3            TEMP$ = ENTRY$ ;

  14743 27 001161   000124 236000 0                  LDQ     ENTRY$
        27 001162   000110 756000 0                  STQ     TEMP$

      527    14744                 %NEXT_NON_LINOI (POINTER=TEMP$) ; /* Should point to DEFLB's ILS */

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:149  
  14749 27 001163   000110 470400 0                  LDP0    TEMP$
        27 001164   000002 236100                    LDQ     2,,PR0
        27 001165   000110 756000 0                  STQ     TEMP$

  14752 27 001166   000110 470400 0                  LDP0    TEMP$
        27 001167   000003 236100                    LDQ     3,,PR0
        27 001170   000000 116000 28                 CMPQ    0
        27 001171   001163 600000 27                 TZE     s:14749
        27 001172   000003 471500                    LDP1    3,,PR0
        27 001173   100000 220100                    LDX0    0,,PR1
        27 001174   000373 100003                    CMPX0   251,DU
        27 001175   001163 600000 27                 TZE     s:14749

      528    14754    3            PREV_ILS$ = ILS$ ;

  14754 27 001176   000000 236000 6                  LDQ     ILS$
        27 001177   000001 756000 0                  STQ     PREV_ILS$

      529    14755    3            ILS$->ILS.ILL$->GO.EXPR$ = ADDR(NIL) ;

  14755 27 001200   000000 473400 6                  LDP3    ILS$
        27 001201   300003 474500                    LDP4    3,,PR3
        27 001202   000000 236000 28                 LDQ     0
        27 001203   400002 756100                    STQ     2,,PR4

      530    14756    3            ILS$->ILS.ILL$->GO.LABEL$ = TEMP$->ILS.ILL$->DEFLB.LOP ;

  14756 27 001204   300003 471500                    LDP1    3,,PR3
        27 001205   000003 474500                    LDP4    3,,PR0
        27 001206   400001 236100                    LDQ     1,,PR4
        27 001207   100001 756100                    STQ     1,,PR1

      531    14757    3            IF TEMP$->ILS.ILL$->DEFLB.LOP->LABEL.B.REFERENCED

  14757 27 001210   000003 471500                    LDP1    3,,PR0
        27 001211   100001 474500                    LDP4    1,,PR1
        27 001212   400003 234100                    SZN     3,,PR4
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:150  
        27 001213   001217 605000 27                 TPL     s:14759

      532    14758    3              THEN TEMP$->ILS.ILL$->DEFLB.LOP->LABEL.B.ONE_REF = FALSE ;

  14758 27 001214   000004 236000 28                 LDQ     4
        27 001215   400003 356100                    ANSQ    3,,PR4
        27 001216   001221 710000 27                 TRA     s:14760

      533    14759    3              ELSE TEMP$->ILS.ILL$->DEFLB.LOP->LABEL.B.ONE_REF = TRUE ;

  14759 27 001217   010000 236003                    LDQ     4096,DU
        27 001220   400003 256100                    ORSQ    3,,PR4

      534    14760    3            TEMP$->ILS.ILL$->DEFLB.LOP->LABEL.B.REFERENCED = TRUE ;

  14760 27 001221   000003 471500                    LDP1    3,,PR0
        27 001222   100001 474500                    LDP4    1,,PR1
        27 001223   400000 236003                    LDQ     -131072,DU
        27 001224   400003 256100                    ORSQ    3,,PR4

      535    14761    3          END ;

  14761 27 001225   001231 710000 27                 TRA     s:14763

      536    14762    2          ELSE ILS$->ILS.ILL$ = ADDR(NIL) ;

  14762 27 001226   000000 236000 28                 LDQ     0
        27 001227   000000 474400 6                  LDP4    ILS$
        27 001230   400003 756100                    STQ     3,,PR4

      537    14763    2          ILS$->ILS.NEXT = START_LABEL_ILS$ ;

  14763 27 001231   000006 236000 0                  LDQ     START_LABEL_ILS$
        27 001232   000000 470400 6                  LDP0    ILS$
        27 001233   000002 756100                    STQ     2,,PR0

      538    14764    2          END_LABEL_ILS$ = START_LABEL_ILS$ ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:151  

  14764 27 001234   000010 756000 0                  STQ     END_LABEL_ILS$

      539    14765    2          START_LABEL$ = START_LABEL_ILS$->ILS.ILL$->ILL.LOP ;

  14765 27 001235   000006 471400 0                  LDP1    START_LABEL_ILS$
        27 001236   100003 473500                    LDP3    3,,PR1
        27 001237   300001 236100                    LDQ     1,,PR3
        27 001240   000005 756000 0                  STQ     START_LABEL$

      540    14766    2          START_LABEL$->LABEL.B.REFERENCED = TRUE ;

  14766 27 001241   000005 473400 0                  LDP3    START_LABEL$
        27 001242   400000 236003                    LDQ     -131072,DU
        27 001243   300003 256100                    ORSQ    3,,PR3

      541    14767    2          PERF_LABEL_CHECK = COMCOM.H_LBL ;

  14767 27 001244   000321 236000 xsym               LDQ     COMCOM+209
        27 001245   000003 756000 0                  STQ     PERF_LABEL_CHECK

      542    14768    2          LABEL_CHECK$ = COMCOM.H_LBL ;

  14768 27 001246   000030 756000 0                  STQ     LABEL_CHECK$

      543    14769    3          IF REF_DEFLB ~= ADDR(NIL) THEN DO ;

  14769 27 001247   000025 236000 0                  LDQ     REF_DEFLB
        27 001250   000000 116000 28                 CMPQ    0
        27 001251   001254 600000 27                 TZE     s:14774

      544    14770    3            PERF_LABEL_CHECK = REF_DEFLB ;

  14770 27 001252   000003 756000 0                  STQ     PERF_LABEL_CHECK

      545    14771    3            LABEL_CHECK$ = REF_DEFLB ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:152  
  14771 27 001253   000030 756000 0                  STQ     LABEL_CHECK$

      546    14772    3          END ;

      547    14773    3          DO WHILE '1'B ; /* Rather, until last DEFLB before CALL found */

      548    14774    3            TEMP$ = PERF_LABEL_CHECK->ILS.ILL$->ILL.LBL ;

  14774 27 001254   000003 470400 0                  LDP0    PERF_LABEL_CHECK
        27 001255   000003 471500                    LDP1    3,,PR0
        27 001256   100002 236100                    LDQ     2,,PR1
        27 001257   000110 756000 0                  STQ     TEMP$

      549    14775    3            IF TEMP$ = ADDR(NIL) THEN EXIT ;

  14775 27 001260   000000 116000 28                 CMPQ    0
        27 001261   001273 600000 27                 TZE     s:14779

      550    14776    3            IF NOT TEMP$->ILS.ILL$->ILL.LOP->LABEL.B.PHASE_2 THEN EXIT ;

  14776 27 001262   000110 473400 0                  LDP3    TEMP$
        27 001263   300003 474500                    LDP4    3,,PR3
        27 001264   400001 475500                    LDP5    1,,PR4
        27 001265   500003 236100                    LDQ     3,,PR5
        27 001266   004000 316003                    CANQ    2048,DU
        27 001267   001273 600000 27                 TZE     s:14779

      551    14777    3            PERF_LABEL_CHECK = TEMP$ ;

  14777 27 001270   000110 236000 0                  LDQ     TEMP$
        27 001271   000003 756000 0                  STQ     PERF_LABEL_CHECK

      552    14778    3          END ;

  14778 27 001272   001254 710000 27                 TRA     s:14774

      553    14779    2          IF NOT START_LABEL$->LABEL.B.PHASE_2 THEN
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:153  

  14779 27 001273   000005 473400 0                  LDP3    START_LABEL$
        27 001274   300003 236100                    LDQ     3,,PR3
        27 001275   004000 316003                    CANQ    2048,DU
        27 001276   001307 601000 27                 TNZ     SCAN_SUBR

      554    14780    3            DO WHILE '1'B ; /* Rather, until last DEFLB before subroutine found */

      555    14781    3             TEMP$ = LABEL_CHECK$->ILS.ILL$->ILL.LBL ; /* Should never be ADDR(NIL) */

  14781 27 001277   000030 470400 0                  LDP0    LABEL_CHECK$
        27 001300   000003 471500                    LDP1    3,,PR0
        27 001301   100002 236100                    LDQ     2,,PR1
        27 001302   000110 756000 0                  STQ     TEMP$

      556    14782    3              IF TEMP$ = START_LABEL_ILS$ THEN EXIT ;

  14782 27 001303   000006 116000 0                  CMPQ    START_LABEL_ILS$
        27 001304   001307 600000 27                 TZE     SCAN_SUBR

      557    14783    3              LABEL_CHECK$ = TEMP$ ;

  14783 27 001305   000030 756000 0                  STQ     LABEL_CHECK$

      558    14784    3            END ;

  14784 27 001306   001277 710000 27                 TRA     s:14781

      559    14785        /*V*
      560    14786            SCAN_SUBROUTINE -- Thruout the subroutine, change all line numbers,
      561    14787                               replace all EXIT PROGRAM statements except the last
      562    14788                               with GOTOs to a label immediately after the CALL, and
      563    14789                               find the last label in the subroutine.
      564    14790        */
      565    14791    3   SCAN_SUBR: DO WHILE SEARCH_ILS$ ~= ADDR(NIL) ;

  14791 27 001307   002031 710000 27    SCAN_SUBR    TRA     s:14955
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:154  

      566    14792    3            SEARCH_ILL$ = SEARCH_ILS$->ILS.ILL$ ;

  14792 27 001310   000077 470400 0                  LDP0    SEARCH_ILS$
        27 001311   000003 236100                    LDQ     3,,PR0
        27 001312   000125 756000 0                  STQ     SEARCH_ILL$

      567    14793    4            IF SEARCH_ILL$ ~= ADDR(NIL) THEN DO ;

  14793 27 001313   000000 116000 28                 CMPQ    0
        27 001314   002010 600000 27                 TZE     s:14944

      568    14794    5              IF SEARCH_ILL$->ILL.ID = %DEFLB THEN DO ;

  14794 27 001315   000125 471400 0                  LDP1    SEARCH_ILL$
        27 001316   100000 220100                    LDX0    0,,PR1
        27 001317   000346 100003                    CMPX0   230,DU
        27 001320   001327 601000 27                 TNZ     s:14799

      569    14795    5                END_LABEL_ILS$ = SEARCH_ILS$ ;

  14795 27 001321   000077 236000 0                  LDQ     SEARCH_ILS$
        27 001322   000010 756000 0                  STQ     END_LABEL_ILS$

      570    14796    5                SEARCH_ILL$->ILL.LOP->LABEL.PROC$ = CURRENT_PROC$ ;

  14796 27 001323   100001 473500                    LDP3    1,,PR1
        27 001324   000111 236000 0                  LDQ     CURRENT_PROC$
        27 001325   300011 756100                    STQ     9,,PR3

      571    14797                     /* Label is now in CALL statement's program. */
      572    14798    5              END ;

  14798 27 001326   002010 710000 27                 TRA     s:14944

      573    14799    5              ELSE IF SEARCH_ILL$->ILL.ID = %EXIT_PROG THEN DO ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:155  
  14799 27 001327   000366 100003                    CMPX0   246,DU
        27 001330   002002 601000 27                 TNZ     s:14939

      574    14800    5                TEMP$ = SEARCH_ILS$ ;

  14800 27 001331   000077 236000 0                  LDQ     SEARCH_ILS$
        27 001332   000110 756000 0                  STQ     TEMP$

      575    14801                     %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  14811 27 001333   000110 470400 0                  LDP0    TEMP$
        27 001334   000002 236100                    LDQ     2,,PR0
        27 001335   000110 756000 0                  STQ     TEMP$

  14814 27 001336   000110 470400 0                  LDP0    TEMP$
        27 001337   000003 236100                    LDQ     3,,PR0
        27 001340   000000 116000 28                 CMPQ    0
        27 001341   001333 600000 27                 TZE     s:14811
        27 001342   000003 471500                    LDP1    3,,PR0
        27 001343   100000 220100                    LDX0    0,,PR1
        27 001344   000343 100003                    CMPX0   227,DU
        27 001345   001333 600000 27                 TZE     s:14811
        27 001346   000422 100003                    CMPX0   274,DU
        27 001347   001333 600000 27                 TZE     s:14811
        27 001350   000446 100003                    CMPX0   294,DU
        27 001351   001333 600000 27                 TZE     s:14811
        27 001352   000336 100003                    CMPX0   222,DU
        27 001353   001333 600000 27                 TZE     s:14811
        27 001354   000420 100003                    CMPX0   272,DU
        27 001355   001333 600000 27                 TZE     s:14811
        27 001356   000373 100003                    CMPX0   251,DU
        27 001357   001333 600000 27                 TZE     s:14811

      576    14816    6                DO CASE (TEMP$->ILS.ILL$->ILL.ID) ;

  14816 27 001360   100000 236100                    LDQ     0,,PR1
        27 001361   000022 772000                    QRL     18
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:156  
        27 001362   000336 136007                    SBLQ    222,DL
        27 001363   000111 116007                    CMPQ    73,DL
        27 001364   001366 602006 27                 TNC     s:14816+6,QL
        27 001365   001503 710000 27                 TRA     s:14823
        27 001366   001505 710000 27                 TRA     s:14825
        27 001367   001503 710000 27                 TRA     s:14823
        27 001370   001503 710000 27                 TRA     s:14823
        27 001371   001503 710000 27                 TRA     s:14823
        27 001372   001503 710000 27                 TRA     s:14823
        27 001373   001505 710000 27                 TRA     s:14825
        27 001374   001503 710000 27                 TRA     s:14823
        27 001375   001503 710000 27                 TRA     s:14823
        27 001376   001503 710000 27                 TRA     s:14823
        27 001377   001503 710000 27                 TRA     s:14823
        27 001400   001503 710000 27                 TRA     s:14823
        27 001401   001503 710000 27                 TRA     s:14823
        27 001402   001503 710000 27                 TRA     s:14823
        27 001403   001503 710000 27                 TRA     s:14823
        27 001404   001503 710000 27                 TRA     s:14823
        27 001405   001503 710000 27                 TRA     s:14823
        27 001406   001503 710000 27                 TRA     s:14823
        27 001407   001503 710000 27                 TRA     s:14823
        27 001410   001503 710000 27                 TRA     s:14823
        27 001411   001503 710000 27                 TRA     s:14823
        27 001412   001503 710000 27                 TRA     s:14823
        27 001413   001503 710000 27                 TRA     s:14823
        27 001414   001503 710000 27                 TRA     s:14823
        27 001415   001503 710000 27                 TRA     s:14823
        27 001416   001503 710000 27                 TRA     s:14823
        27 001417   001503 710000 27                 TRA     s:14823
        27 001420   001503 710000 27                 TRA     s:14823
        27 001421   001503 710000 27                 TRA     s:14823
        27 001422   001503 710000 27                 TRA     s:14823
        27 001423   001505 710000 27                 TRA     s:14825
        27 001424   001503 710000 27                 TRA     s:14823
        27 001425   001503 710000 27                 TRA     s:14823
        27 001426   001503 710000 27                 TRA     s:14823
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:157  
        27 001427   001503 710000 27                 TRA     s:14823
        27 001430   001503 710000 27                 TRA     s:14823
        27 001431   001503 710000 27                 TRA     s:14823
        27 001432   001503 710000 27                 TRA     s:14823
        27 001433   001503 710000 27                 TRA     s:14823
        27 001434   001503 710000 27                 TRA     s:14823
        27 001435   001503 710000 27                 TRA     s:14823
        27 001436   001503 710000 27                 TRA     s:14823
        27 001437   001503 710000 27                 TRA     s:14823
        27 001440   001503 710000 27                 TRA     s:14823
        27 001441   001503 710000 27                 TRA     s:14823
        27 001442   001503 710000 27                 TRA     s:14823
        27 001443   001503 710000 27                 TRA     s:14823
        27 001444   001503 710000 27                 TRA     s:14823
        27 001445   001503 710000 27                 TRA     s:14823
        27 001446   001503 710000 27                 TRA     s:14823
        27 001447   001503 710000 27                 TRA     s:14823
        27 001450   001505 710000 27                 TRA     s:14825
        27 001451   001503 710000 27                 TRA     s:14823
        27 001452   001505 710000 27                 TRA     s:14825
        27 001453   001503 710000 27                 TRA     s:14823
        27 001454   001503 710000 27                 TRA     s:14823
        27 001455   001503 710000 27                 TRA     s:14823
        27 001456   001503 710000 27                 TRA     s:14823
        27 001457   001503 710000 27                 TRA     s:14823
        27 001460   001503 710000 27                 TRA     s:14823
        27 001461   001503 710000 27                 TRA     s:14823
        27 001462   001503 710000 27                 TRA     s:14823
        27 001463   001503 710000 27                 TRA     s:14823
        27 001464   001503 710000 27                 TRA     s:14823
        27 001465   001503 710000 27                 TRA     s:14823
        27 001466   001503 710000 27                 TRA     s:14823
        27 001467   001503 710000 27                 TRA     s:14823
        27 001470   001503 710000 27                 TRA     s:14823
        27 001471   001503 710000 27                 TRA     s:14823
        27 001472   001503 710000 27                 TRA     s:14823
        27 001473   001503 710000 27                 TRA     s:14823
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:158  
        27 001474   001477 710000 27                 TRA     s:14818
        27 001475   001477 710000 27                 TRA     s:14818
        27 001476   001505 710000 27                 TRA     s:14825

      577    14817    6                  CASE (%SCOPE,%END_PROG) ;

      578    14818    6                    SEARCH_ILS$->ILS.ILL$ = ADDR(NIL) ;
             14818                             /* Get rid of last %EXIT_PROG */

  14818 27 001477   000000 236000 28                 LDQ     0
        27 001500   000077 473400 0                  LDP3    SEARCH_ILS$
        27 001501   300003 756100                    STQ     3,,PR3

      579    14819    6                    EXIT SCAN_SUBR ;

  14819 27 001502   002034 710000 27                 TRA     s:14956

      580    14820    6                  CASE (%LINOI,%PREOFF,%PRESET,%PTR_SET,%P_A_PRESET,%P_P_PRESET) ;

      581    14821                         /* Do not update COPY_ILS$ */
      582    14822    6                  CASE (ELSE) ;

      583    14823    6                    COPY_ILS$ = SEARCH_ILS$ ;

  14823 27 001503   000077 236000 0                  LDQ     SEARCH_ILS$
        27 001504   000020 756000 0                  STQ     COPY_ILS$

      584    14824    6                END ;

      585    14825    6                IF NOT DEFLB_FOLLOWS THEN DO ; /* Create label after CALL */

  14825 27 001505   000055 234000 0                  SZN     DEFLB_FOLLOWS
        27 001506   001737 604000 27                 TMI     s:14925

      586    14826    6                  CALL Z8AT$CREATE_TEMPORARY (%PARA,LABEL_AFTER_PFORM$) ;

  14826 27 001507   000007 630400 28                 EPPR0   7
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:159  
        27 001510   000005 631400 28                 EPPR1   5
        27 001511   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        27 001512   000000 011000                    NOP     0

      587    14827    6                  LABEL_AFTER_PFORM$->LABEL.B.REFERENCED = TRUE ;

  14827 27 001513   000056 470400 0                  LDP0    LABEL_AFTER_PFORM$
        27 001514   400000 236003                    LDQ     -131072,DU
        27 001515   000003 256100                    ORSQ    3,,PR0

      588    14828    6                  LABEL_AFTER_PFORM$->LABEL.B.ONE_REF = TRUE ;

  14828 27 001516   000056 470400 0                  LDP0    LABEL_AFTER_PFORM$
        27 001517   010000 236003                    LDQ     4096,DU
        27 001520   000003 256100                    ORSQ    3,,PR0

      589    14829    6                  LABEL_AFTER_PFORM$->LABEL.SECTION$ = O2COM.SECTION$ ;

  14829 27 001521   000003 236000 25                 LDQ     O2COM+3
        27 001522   000056 470400 0                  LDP0    LABEL_AFTER_PFORM$
        27 001523   000007 756100                    STQ     7,,PR0

      590    14830    6                  LABEL_AFTER_PFORM$->LABEL.PROC$ = CURRENT_PROC$ ;

  14830 27 001524   000111 236000 0                  LDQ     CURRENT_PROC$
        27 001525   000056 470400 0                  LDP0    LABEL_AFTER_PFORM$
        27 001526   000011 756100                    STQ     9,,PR0

      591    14831                       %RESERVE_ILS (ITEM=%OPN,POINTER=TEMP$) ;

  14851 27 001527   000002 236000 7                  LDQ     ILS_+2
        27 001530   000004 036007                    ADLQ    4,DL
        27 001531   000003 116000 7                  CMPQ    ILS_+3
        27 001532   001543 602000 27                 TNC     s:14853

  14852 27 001533   000002 236000 28                 LDQ     2
        27 001534   000130 756000 0                  STQ     OPT_FLAG+1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:160  
        27 001535   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 001536   000131 450400 0                  STP0    OPT_FLAG+2
        27 001537   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 001540   000001 631400 28                 EPPR1   1
        27 001541   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 001542   000000 011000                    NOP     0

  14853 27 001543   000002 236000 7                  LDQ     ILS_+2
        27 001544   000022 736000                    QLS     18
        27 001545   000001 036000 7                  ADLQ    ILS_+1
        27 001546   000110 756000 0                  STQ     TEMP$

  14854 27 001547   000002 235000 7                  LDA     ILS_+2
        27 001550   000004 035007                    ADLA    4,DL
        27 001551   000002 755000 7                  STA     ILS_+2

  14855 27 001552   000740 220003                    LDX0    480,DU
        27 001553   000110 470400 0                  LDP0    TEMP$
        27 001554   000000 740100                    STX0    0,,PR0

  14856 27 001555   000000 236000 28                 LDQ     0
        27 001556   000002 756100                    STQ     2,,PR0

      592    14860                       %RESERVE_ILL (ITEM=%LINOI,POINTER=TEMP$->ILS.ILL$) ;

  14862 27 001557   000145 235000 xsym               LDA     ILL_STEP+101
        27 001560   000000 755000 1                  STA     ITERATION

  14863 27 001561   000002 236000 11                 LDQ     ILL_+2
        27 001562   000000 036000 1                  ADLQ    ITERATION
        27 001563   000003 116000 11                 CMPQ    ILL_+3
        27 001564   001575 604000 27                 TMI     s:14865

  14864 27 001565   000003 236000 28                 LDQ     3
        27 001566   000130 756000 0                  STQ     OPT_FLAG+1
        27 001567   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 001570   000131 451400 0                  STP1    OPT_FLAG+2
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:161  
        27 001571   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 001572   000001 631400 28                 EPPR1   1
        27 001573   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 001574   000000 011000                    NOP     0

  14865 27 001575   000002 236000 11                 LDQ     ILL_+2
        27 001576   000022 736000                    QLS     18
        27 001577   000001 036000 11                 ADLQ    ILL_+1
        27 001600   000110 470400 0                  LDP0    TEMP$
        27 001601   000003 756100                    STQ     3,,PR0

  14866 27 001602   000002 236000 11                 LDQ     ILL_+2
        27 001603   000000 036000 1                  ADLQ    ITERATION
        27 001604   000002 756000 11                 STQ     ILL_+2

  14867 27 001605   000003 471500                    LDP1    3,,PR0
        27 001606   000373 220003                    LDX0    251,DU
        27 001607   100000 740100                    STX0    0,,PR1

      593    14870                       %RESERVE_ILS (ITEM=%OPN,POINTER=TEMP$->ILS.NEXT) ;

  14890 27 001610   000002 236000 7                  LDQ     ILS_+2
        27 001611   000004 036007                    ADLQ    4,DL
        27 001612   000003 116000 7                  CMPQ    ILS_+3
        27 001613   001624 602000 27                 TNC     s:14892

  14891 27 001614   000002 236000 28                 LDQ     2
        27 001615   000130 756000 0                  STQ     OPT_FLAG+1
        27 001616   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 001617   000131 451400 0                  STP1    OPT_FLAG+2
        27 001620   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 001621   000001 631400 28                 EPPR1   1
        27 001622   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 001623   000000 011000                    NOP     0

  14892 27 001624   000002 236000 7                  LDQ     ILS_+2
        27 001625   000022 736000                    QLS     18
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:162  
        27 001626   000001 036000 7                  ADLQ    ILS_+1
        27 001627   000110 470400 0                  LDP0    TEMP$
        27 001630   000002 756100                    STQ     2,,PR0

  14893 27 001631   000002 235000 7                  LDA     ILS_+2
        27 001632   000004 035007                    ADLA    4,DL
        27 001633   000002 755000 7                  STA     ILS_+2

  14894 27 001634   000002 471500                    LDP1    2,,PR0
        27 001635   000740 220003                    LDX0    480,DU
        27 001636   100000 740100                    STX0    0,,PR1

  14895 27 001637   000002 471500                    LDP1    2,,PR0
        27 001640   000000 236000 28                 LDQ     0
        27 001641   100002 756100                    STQ     2,,PR1

      594    14899                       %RESERVE_ILL (ITEM=%DEFLB,POINTER=TEMP$->ILS.NEXT->ILS.ILL$) ;

  14901 27 001642   000120 235000 xsym               LDA     ILL_STEP+80
        27 001643   000000 755000 1                  STA     ITERATION

  14902 27 001644   000002 236000 11                 LDQ     ILL_+2
        27 001645   000000 036000 1                  ADLQ    ITERATION
        27 001646   000003 116000 11                 CMPQ    ILL_+3
        27 001647   001660 604000 27                 TMI     s:14904

  14903 27 001650   000003 236000 28                 LDQ     3
        27 001651   000130 756000 0                  STQ     OPT_FLAG+1
        27 001652   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 001653   000131 451400 0                  STP1    OPT_FLAG+2
        27 001654   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 001655   000001 631400 28                 EPPR1   1
        27 001656   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 001657   000000 011000                    NOP     0

  14904 27 001660   000110 470400 0                  LDP0    TEMP$
        27 001661   000002 471500                    LDP1    2,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:163  
        27 001662   000002 236000 11                 LDQ     ILL_+2
        27 001663   000022 736000                    QLS     18
        27 001664   000001 036000 11                 ADLQ    ILL_+1
        27 001665   100003 756100                    STQ     3,,PR1

  14905 27 001666   000002 236000 11                 LDQ     ILL_+2
        27 001667   000000 036000 1                  ADLQ    ITERATION
        27 001670   000002 756000 11                 STQ     ILL_+2

  14906 27 001671   000002 471500                    LDP1    2,,PR0
        27 001672   100003 473500                    LDP3    3,,PR1
        27 001673   000346 220003                    LDX0    230,DU
        27 001674   300000 740100                    STX0    0,,PR3

      595    14909    6                  TEMP$->ILS.NEXT->ILS.NEXT = NEXT_ILS$ ;

  14909 27 001675   000002 471500                    LDP1    2,,PR0
        27 001676   000002 236000 0                  LDQ     NEXT_ILS$
        27 001677   100002 756100                    STQ     2,,PR1

      596    14910    6                  NEXT_ILS$ = TEMP$ ;

  14910 27 001700   000110 236000 0                  LDQ     TEMP$
        27 001701   000002 756000 0                  STQ     NEXT_ILS$

      597    14911    6                  TEMP$->ILS.ILL$->LINOI.PREV_LINE = COMCOM.CURRENT.LINE ;

  14911 27 001702   000003 471500                    LDP1    3,,PR0
        27 001703   000133 721000 xsym               LXL1    COMCOM+91
        27 001704   100000 441100                    SXL1    0,,PR1

      598    14912    6                  TEMP$->ILS.ILL$->LINOI.LINE_NO = COMCOM.CURRENT.LINE ;

  14912 27 001705   000003 471500                    LDP1    3,,PR0
        27 001706   000133 721000 xsym               LXL1    COMCOM+91
        27 001707   100001 441100                    SXL1    1,,PR1

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:164  
      599    14913    6                  TEMP$->ILS.ILL$->LINOI.PREV_COL = COMCOM.CURRENT.COLUMN ;

  14913 27 001710   000003 471500                    LDP1    3,,PR0
        27 001711   000134 721000 xsym               LXL1    COMCOM+92
        27 001712   100002 441100                    SXL1    2,,PR1

      600    14914    6                  TEMP$->ILS.ILL$->LINOI.COLUMN_NO = COMCOM.CURRENT.COLUMN ;

  14914 27 001713   000003 471500                    LDP1    3,,PR0
        27 001714   000134 721000 xsym               LXL1    COMCOM+92
        27 001715   100001 741100                    STX1    1,,PR1

      601    14915                       %NEXT_ILS (POINTER=TEMP$) ;

  14917 27 001716   000002 236100                    LDQ     2,,PR0
        27 001717   000110 756000 0                  STQ     TEMP$

      602    14920    6                  TEMP$->ILS.ILL$->ILL.LOP = LABEL_AFTER_PFORM$ ;

  14920 27 001720   000110 470400 0                  LDP0    TEMP$
        27 001721   000003 471500                    LDP1    3,,PR0
        27 001722   000056 236000 0                  LDQ     LABEL_AFTER_PFORM$
        27 001723   100001 756100                    STQ     1,,PR1

      603    14921    6                  TEMP$->ILS.ILL$->ILL.LBL = PERF_LABEL_CHECK->ILS.ILL$->ILL.LBL ;

  14921 27 001724   000003 471500                    LDP1    3,,PR0
        27 001725   000003 473400 0                  LDP3    PERF_LABEL_CHECK
        27 001726   300003 474500                    LDP4    3,,PR3
        27 001727   400002 236100                    LDQ     2,,PR4
        27 001730   100002 756100                    STQ     2,,PR1

      604    14922    6                  PERF_LABEL_CHECK->ILS.ILL$->ILL.LBL = TEMP$ ;

  14922 27 001731   300003 471500                    LDP1    3,,PR3
        27 001732   000110 236000 0                  LDQ     TEMP$
        27 001733   100002 756100                    STQ     2,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:165  

      605    14923    6                  DEFLB_FOLLOWS = TRUE ;

  14923 27 001734   400000 236003                    LDQ     -131072,DU
        27 001735   000055 756000 0                  STQ     DEFLB_FOLLOWS

      606    14924    6                END ;

  14924 27 001736   001742 710000 27                 TRA     s:14928

      607    14925    5                ELSE LABEL_AFTER_PFORM$->LABEL.B.ONE_REF = FALSE ;

  14925 27 001737   000056 473400 0                  LDP3    LABEL_AFTER_PFORM$
        27 001740   000004 236000 28                 LDQ     4
        27 001741   300003 356100                    ANSQ    3,,PR3

      608    14926                     %RESERVE_ILL (ITEM=%GO,POINTER=SEARCH_ILS$->ILS.ILL$) ;

  14928 27 001742   000116 235000 xsym               LDA     ILL_STEP+78
        27 001743   000000 755000 1                  STA     ITERATION

  14929 27 001744   000002 236000 11                 LDQ     ILL_+2
        27 001745   000000 036000 1                  ADLQ    ITERATION
        27 001746   000003 116000 11                 CMPQ    ILL_+3
        27 001747   001760 604000 27                 TMI     s:14931

  14930 27 001750   000003 236000 28                 LDQ     3
        27 001751   000130 756000 0                  STQ     OPT_FLAG+1
        27 001752   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 001753   000131 451400 0                  STP1    OPT_FLAG+2
        27 001754   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 001755   000001 631400 28                 EPPR1   1
        27 001756   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 001757   000000 011000                    NOP     0

  14931 27 001760   000002 236000 11                 LDQ     ILL_+2
        27 001761   000022 736000                    QLS     18
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:166  
        27 001762   000001 036000 11                 ADLQ    ILL_+1
        27 001763   000077 470400 0                  LDP0    SEARCH_ILS$
        27 001764   000003 756100                    STQ     3,,PR0

  14932 27 001765   000002 236000 11                 LDQ     ILL_+2
        27 001766   000000 036000 1                  ADLQ    ITERATION
        27 001767   000002 756000 11                 STQ     ILL_+2

  14933 27 001770   000003 471500                    LDP1    3,,PR0
        27 001771   000344 220003                    LDX0    228,DU
        27 001772   100000 740100                    STX0    0,,PR1

      609    14936    5                SEARCH_ILS$->ILS.ILL$->GO.LABEL$ = LABEL_AFTER_PFORM$ ;

  14936 27 001773   000003 471500                    LDP1    3,,PR0
        27 001774   000056 236000 0                  LDQ     LABEL_AFTER_PFORM$
        27 001775   100001 756100                    STQ     1,,PR1

      610    14937    5                SEARCH_ILS$->ILS.ILL$->GO.EXPR$ = ADDR(NIL) ;

  14937 27 001776   000003 471500                    LDP1    3,,PR0
        27 001777   000000 236000 28                 LDQ     0
        27 002000   100002 756100                    STQ     2,,PR1

      611    14938    5              END ;

  14938 27 002001   002010 710000 27                 TRA     s:14944

      612    14939    5              ELSE IF SEARCH_ILL$->ILL.ID = %LINOI THEN DO ;

  14939 27 002002   000373 100003                    CMPX0   251,DU
        27 002003   002010 601000 27                 TNZ     s:14944

      613    14940    5                SEARCH_ILL$->LINOI.PREV_LINE = COMCOM.CURRENT.LINE ;

  14940 27 002004   000133 721000 xsym               LXL1    COMCOM+91
        27 002005   100000 441100                    SXL1    0,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:167  

      614    14941    5                SEARCH_ILL$->LINOI.LINE_NO = COMCOM.CURRENT.LINE ;

  14941 27 002006   000133 722000 xsym               LXL2    COMCOM+91
        27 002007   100001 442100                    SXL2    1,,PR1

      615    14942    5              END ;

      616    14943    4            END ;

      617    14944    3            TEMP$ = SEARCH_ILS$ ;

  14944 27 002010   000077 236000 0                  LDQ     SEARCH_ILS$
        27 002011   000110 756000 0                  STQ     TEMP$

      618    14945                 %NEXT_ILS (POINTER=TEMP$) ;

  14947 27 002012   000110 471400 0                  LDP1    TEMP$
        27 002013   100002 236100                    LDQ     2,,PR1
        27 002014   000110 756000 0                  STQ     TEMP$

      619    14950    3            IF TEMP$->ILS.ILL$ ~= ADDR(NIL) THEN

  14950 27 002015   000110 471400 0                  LDP1    TEMP$
        27 002016   100003 236100                    LDQ     3,,PR1
        27 002017   000000 116000 28                 CMPQ    0
        27 002020   002027 600000 27                 TZE     s:14954

      620    14951    3              IF TEMP$->ILS.ILL$->ILL.ID = %SCOPE OR

  14951 27 002021   100003 473500                    LDP3    3,,PR1
        27 002022   300000 220100                    LDX0    0,,PR3
        27 002023   000445 100003                    CMPX0   293,DU
        27 002024   002034 600000 27                 TZE     s:14956
        27 002025   000444 100003                    CMPX0   292,DU
        27 002026   002034 600000 27                 TZE     s:14956

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:168  
      621    14952    3                  TEMP$->ILS.ILL$->ILL.ID = %END_PROG THEN
      622    14953    3                EXIT SCAN_SUBR ;
      623    14954    3            SEARCH_ILS$ = TEMP$ ;

  14954 27 002027   000110 236000 0                  LDQ     TEMP$
        27 002030   000077 756000 0                  STQ     SEARCH_ILS$

      624    14955    3          END ; /* SCAN_SUBR */

  14955 27 002031   000077 236000 0                  LDQ     SEARCH_ILS$
        27 002032   000000 116000 28                 CMPQ    0
        27 002033   001310 601000 27                 TNZ     s:14792

      625    14956    2          IF DEFLB_FOLLOWS THEN

  14956 27 002034   000055 234000 0                  SZN     DEFLB_FOLLOWS
        27 002035   002041 605000 27                 TPL     s:14958

      626    14957    2            LABEL_AFTER_PFORM$->LABEL.PREV_ILS$ = COPY_ILS$ ;

  14957 27 002036   000020 236000 0                  LDQ     COPY_ILS$
        27 002037   000056 470400 0                  LDP0    LABEL_AFTER_PFORM$
        27 002040   000010 756100                    STQ     8,,PR0

      627    14958    2          END_LABEL$ = END_LABEL_ILS$->ILS.ILL$->ILL.LOP ;

  14958 27 002041   000010 470400 0                  LDP0    END_LABEL_ILS$
        27 002042   000003 471500                    LDP1    3,,PR0
        27 002043   100001 236100                    LDQ     1,,PR1
        27 002044   000007 756000 0                  STQ     END_LABEL$

      628    14959    2          IF START_LABEL$->LABEL.B.PHASE_2 /* Flow analysis already done */

  14959 27 002045   000005 471400 0                  LDP1    START_LABEL$
        27 002046   100003 236100                    LDQ     3,,PR1
        27 002047   004000 316003                    CANQ    2048,DU
        27 002050   002056 600000 27                 TZE     s:14961
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:169  

      629    14960    2            THEN CALL Z8FS$SRCH_IF_DO_LBL (START_LABEL$,END_LABEL$) ;

  14960 27 002051   000011 630400 28                 EPPR0   9
        27 002052   000005 631400 28                 EPPR1   5
        27 002053   000000 701000 xent               TSX1    Z8FS$SRCH_IF_DO_LBL
        27 002054   000000 011000                    NOP     0
        27 002055   002063 710000 27                 TRA     s:14962

      630    14961    2            ELSE LABEL_CHECK$->ILS.ILL$->ILL.LBL = END_LABEL_ILS$->ILS.ILL$->ILL.LBL ;

  14961 27 002056   000030 473400 0                  LDP3    LABEL_CHECK$
        27 002057   300003 474500                    LDP4    3,,PR3
        27 002060   000003 475500                    LDP5    3,,PR0
        27 002061   500002 236100                    LDQ     2,,PR5
        27 002062   400002 756100                    STQ     2,,PR4

      631    14962    2          START_LABEL$->LABEL.PREV_ILS$->ILS.NEXT = SEARCH_ILS$->ILS.NEXT ;

  14962 27 002063   000005 470400 0                  LDP0    START_LABEL$
        27 002064   000010 471500                    LDP1    8,,PR0
        27 002065   000077 473400 0                  LDP3    SEARCH_ILS$
        27 002066   300002 236100                    LDQ     2,,PR3
        27 002067   100002 756100                    STQ     2,,PR1

      632    14963    2          START_LABEL$->LABEL.PREV_ILS$ = PREV_ILS$ ;

  14963 27 002070   000001 236000 0                  LDQ     PREV_ILS$
        27 002071   000005 470400 0                  LDP0    START_LABEL$
        27 002072   000010 756100                    STQ     8,,PR0

      633    14964    2          END_LABEL_ILS$->ILS.ILL$->ILL.LBL = PERF_LABEL_CHECK->ILS.ILL$->ILL.LBL ;

  14964 27 002073   000010 471400 0                  LDP1    END_LABEL_ILS$
        27 002074   100003 474500                    LDP4    3,,PR1
        27 002075   000003 475400 0                  LDP5    PERF_LABEL_CHECK
        27 002076   500003 476500                    LDP6    3,,PR5
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:170  
        27 002077   600002 236100                    LDQ     2,,PR6
        27 002100   400002 756100                    STQ     2,,PR4

      634    14965    2          PERF_LABEL_CHECK->ILS.ILL$->ILL.LBL = START_LABEL_ILS$ ;

  14965 27 002101   500003 470500                    LDP0    3,,PR5
        27 002102   000006 236000 0                  LDQ     START_LABEL_ILS$
        27 002103   000002 756100                    STQ     2,,PR0

      635    14966    2          SEARCH_ILS$->ILS.NEXT = NEXT_ILS$ ;

  14966 27 002104   000002 236000 0                  LDQ     NEXT_ILS$
        27 002105   300002 756100                    STQ     2,,PR3

      636    14967    3          IF START_LABEL$->LABEL.B.PHASE_2 THEN DO ;

  14967 27 002106   000005 470400 0                  LDP0    START_LABEL$
        27 002107   000003 236100                    LDQ     3,,PR0
        27 002110   004000 316003                    CANQ    2048,DU
        27 002111   002117 600000 27                 TZE     s:14972

      637    14968    3            PREV_ILS$ = SEARCH_ILS$ ;

  14968 27 002112   000077 236000 0                  LDQ     SEARCH_ILS$
        27 002113   000001 756000 0                  STQ     PREV_ILS$

      638    14969    3            ILS$ = NEXT_ILS$ ;

  14969 27 002114   000002 236000 0                  LDQ     NEXT_ILS$
        27 002115   000000 756000 6                  STQ     ILS$

      639    14970    3          END ;

  14970 27 002116   002146 710000 27                 TRA     s:14989

      640    14971    3          ELSE DO ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:171  
      641    14972    3            ILS$ = PREV_ILS$ ;

  14972 27 002117   000001 236000 0                  LDQ     PREV_ILS$
        27 002120   000000 756000 6                  STQ     ILS$

      642    14973                 %NEXT_NON_SUPPORT ;

  14983 27 002121   000000 470400 6                  LDP0    ILS$
        27 002122   000002 236100                    LDQ     2,,PR0
        27 002123   000000 756000 6                  STQ     ILS$

  14986 27 002124   000000 470400 6                  LDP0    ILS$
        27 002125   000003 236100                    LDQ     3,,PR0
        27 002126   000000 116000 28                 CMPQ    0
        27 002127   002121 600000 27                 TZE     s:14983
        27 002130   000003 471500                    LDP1    3,,PR0
        27 002131   100000 220100                    LDX0    0,,PR1
        27 002132   000343 100003                    CMPX0   227,DU
        27 002133   002121 600000 27                 TZE     s:14983
        27 002134   000422 100003                    CMPX0   274,DU
        27 002135   002121 600000 27                 TZE     s:14983
        27 002136   000446 100003                    CMPX0   294,DU
        27 002137   002121 600000 27                 TZE     s:14983
        27 002140   000336 100003                    CMPX0   222,DU
        27 002141   002121 600000 27                 TZE     s:14983
        27 002142   000420 100003                    CMPX0   272,DU
        27 002143   002121 600000 27                 TZE     s:14983
        27 002144   000373 100003                    CMPX0   251,DU
        27 002145   002121 600000 27                 TZE     s:14983

      643    14988    3          END ;

      644    14989    2          IF PARAMLIST$ = ADDR(NIL) THEN

  14989 27 002146   000120 236000 0                  LDQ     PARAMLIST$
        27 002147   000000 116000 28                 CMPQ    0
        27 002150   002207 600000 27                 TZE     OPTIMIZED
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:172  

      645    14990    2            GOTO OPTIMIZED ; /* No parameters, therefore no need to adjust any
      646    14991                                     BASE triads */
      647    14992    2          BASE$ = COMCOM.H_BASE ;

  14992 27 002151   000323 236000 xsym               LDQ     COMCOM+211
        27 002152   000123 756000 0                  STQ     BASE$

      648    14993    3          DO WHILE BASE$ ~= ADDR(NIL) ; /* Replace parameters with args */

  14993 27 002153   002205 710000 27                 TRA     s:15001

      649    14994    4   REPLACE_PARAM: DO N = 2 TO PARAMLIST$->ARGLIST.N ;

  14994 27 002154   000002 235007       REPLACE_PAR* LDA     2,DL
        27 002155   000126 755000 0                  STA     N
        27 002156   002175 710000 27                 TRA     s:14999+3

      650    14995    5              IF BASE$->ETT.LOP = PARAMLIST$->ARGLIST.ARG$ (N - 2) THEN DO ;

  14995 27 002157   000123 470400 0                  LDP0    BASE$
        27 002160   000120 471400 0                  LDP1    PARAMLIST$
        27 002161   000126 720000 0                  LXL0    N
        27 002162   000001 236100                    LDQ     1,,PR0
        27 002163   177777 116110                    CMPQ    -1,X0,PR1
        27 002164   002172 601000 27                 TNZ     s:14999

      651    14996    5                BASE$->ETT.LOP = LTS$->ARGLIST.ARG$ (N - 2) ->ETT.LOP ;

  14996 27 002165   000000 473400 16                 LDP3    LTS$
        27 002166   377777 474510                    LDP4    -1,X0,PR3
        27 002167   400001 236100                    LDQ     1,,PR4
        27 002170   000001 756100                    STQ     1,,PR0

      652    14997    5                EXIT REPLACE_PARAM ;

  14997 27 002171   002202 710000 27                 TRA     s:15000
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:173  

      653    14998    5              END ;
      654    14999    4            END ; /* REPLACE_PARAM */

  14999 27 002172   000126 235000 0                  LDA     N
        27 002173   000001 035007                    ADLA    1,DL
        27 002174   000126 755000 0                  STA     N
        27 002175   000120 470400 0                  LDP0    PARAMLIST$
        27 002176   000000 236100                    LDQ     0,,PR0
        27 002177   777777 376007                    ANQ     -1,DL
        27 002200   000126 116000 0                  CMPQ    N
        27 002201   002157 603000 27                 TRC     s:14995

      655    15000    3            BASE$ = BASE$->ETT.ROP ;

  15000 27 002202   000123 470400 0                  LDP0    BASE$
        27 002203   000002 236100                    LDQ     2,,PR0
        27 002204   000123 756000 0                  STQ     BASE$

      656    15001    3          END ;

  15001 27 002205   000000 116000 28                 CMPQ    0
        27 002206   002154 601000 27                 TNZ     REPLACE_PARAM

      657    15002    2   OPTIMIZED:
      658    15003               /* Prune the PROC_ from the procedure tree. */
      659    15004    2          FATHER_PROC$ = PROC1$->PROC_.FATHER ;

  15004 27 002207   000116 470400 0     OPTIMIZED    LDP0    PROC1$
        27 002210   000011 236100                    LDQ     9,,PR0
        27 002211   000117 756000 0                  STQ     FATHER_PROC$

      660    15005    2          TEMP$ = ADDR (FATHER_PROC$->PROC_.SON) ;

  15005 27 002212   000007 036003                    ADLQ    7,DU
        27 002213   000110 756000 0                  STQ     TEMP$

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:174  
      661    15006               /* Set TEMP$ to point to the son or brother pointer pointing to PROC1$. */
      662    15007    3          DO WHILE TEMP$->BASED$PTR$ ~= PROC1$ ;

  15007 27 002214   000110 471400 0                  LDP1    TEMP$
        27 002215   100000 236100                    LDQ     0,,PR1
        27 002216   000116 116000 0                  CMPQ    PROC1$
        27 002217   002227 600000 27                 TZE     s:15010

      663    15008    3            TEMP$ = ADDR (TEMP$->BASED$PTR$->PROC_.BROTHER) ;

  15008 27 002220   000110 470400 0                  LDP0    TEMP$
        27 002221   000000 471500                    LDP1    0,,PR0
        27 002222   100010 633500                    EPPR3   8,,PR1
        27 002223   000110 453400 0                  STP3    TEMP$

      664    15009    3          END ;

  15009 27 002224   300000 236100                    LDQ     0,,PR3
        27 002225   000116 116000 0                  CMPQ    PROC1$
        27 002226   002220 601000 27                 TNZ     s:15008

      665    15010    2          TEMP$->BASED$PTR$ = PROC1$->PROC_.SON ;

  15010 27 002227   000116 470400 0                  LDP0    PROC1$
        27 002230   000007 236100                    LDQ     7,,PR0
        27 002231   000110 471400 0                  LDP1    TEMP$
        27 002232   100000 756100                    STQ     0,,PR1

      666    15011    3          DO WHILE TEMP$->BASED$PTR$ ~= ADDR (NIL) ;

  15011 27 002233   002243 710000 27                 TRA     s:15014

      667    15012    3            TEMP$->BASED$PTR$->PROC_.FATHER = FATHER_PROC$ ;

  15012 27 002234   000110 470400 0                  LDP0    TEMP$
        27 002235   000000 471500                    LDP1    0,,PR0
        27 002236   000117 236000 0                  LDQ     FATHER_PROC$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:175  
        27 002237   100011 756100                    STQ     9,,PR1

      668    15013    3            TEMP$ = ADDR (TEMP$->BASED$PTR$->PROC_.BROTHER) ;

  15013 27 002240   000000 471500                    LDP1    0,,PR0
        27 002241   100010 633500                    EPPR3   8,,PR1
        27 002242   000110 453400 0                  STP3    TEMP$

      669    15014    3          END ; /* FATHER pointers have been updated by this loop. */

  15014 27 002243   000110 470400 0                  LDP0    TEMP$
        27 002244   000000 236100                    LDQ     0,,PR0
        27 002245   000000 116000 28                 CMPQ    0
        27 002246   002234 601000 27                 TNZ     s:15012

      670    15015    2          TEMP$->BASED$PTR$ = PROC1$->PROC_.BROTHER ;

  15015 27 002247   000116 471400 0                  LDP1    PROC1$
        27 002250   100010 236100                    LDQ     8,,PR1
        27 002251   000000 756100                    STQ     0,,PR0

      671    15016    2          RETURN ;

  15016 27 002252   000114 221200 0                  LDX1  ! CURRENT_PROC$+3
        27 002253   000001 702211                    TSX2  ! 1,X1

      672    15017    2   CANT_OPTIMIZE:
      673    15018    2          ALTRETURN ;

  15018 27 002254   000114 221200 0     CANT_OPTIMI* LDX1  ! CURRENT_PROC$+3
        27 002255   000000 702211                    TSX2  ! 0,X1

      674    15019    2   END OPTIMIZE_CALL ;
      675    15020        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:176  
      676    15021        /*V*
      677    15022            INITIALIZE  -- Initialize variables before loop
      678    15023                           1.  Get the first ILS item that points to a non-LINOI
      679    15024                               item in the ILL.
      680    15025                           2.  Set all of the DO variables.
      681    15026                           3.  Generate STOP RUN or EXIT PROGRAM if the last
      682    15027                               statement was not an unconditional transfer.
      683    15028        */
      684    15029
      685    15030    1          ILS$ = COMCOM.FIRST_ILS ; /* Find the first non-LINOI ILS item. */

  15030 27 002256   000010 236000 xsym               LDQ     COMCOM+8
        27 002257   000000 756000 6                  STQ     ILS$

      686    15031               %NEXT_NON_LINOI ;

  15036 27 002260   000000 470400 6                  LDP0    ILS$
        27 002261   000002 236100                    LDQ     2,,PR0
        27 002262   000000 756000 6                  STQ     ILS$

  15039 27 002263   000000 470400 6                  LDP0    ILS$
        27 002264   000003 236100                    LDQ     3,,PR0
        27 002265   000000 116000 28                 CMPQ    0
        27 002266   002260 600000 27                 TZE     s:15036
        27 002267   000003 471500                    LDP1    3,,PR0
        27 002270   100000 220100                    LDX0    0,,PR1
        27 002271   000373 100003                    CMPX0   251,DU
        27 002272   002260 600000 27                 TZE     s:15036

      687    15041    1          PREV_ILS$ = COMCOM.FIRST_ILS ;

  15041 27 002273   000010 236000 xsym               LDQ     COMCOM+8
        27 002274   000001 756000 0                  STQ     PREV_ILS$

      688    15042    1          COMCOM.H_DO = ADDR(NIL) ;

  15042 27 002275   000000 236000 28                 LDQ     0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:177  
        27 002276   000332 756000 xsym               STQ     COMCOM+218

      689    15043    1          O2COM.LAST_LBL$ = ADDR(NIL) ;

  15043 27 002277   000002 756000 25                 STQ     O2COM+2

      690    15044
      691    15045    1          FATHER_DO = ADDR(NIL) ;

  15045 27 002300   000024 756000 0                  STQ     FATHER_DO

      692    15046    1          REF_DEFLB = ADDR(NIL) ;

  15046 27 002301   000025 756000 0                  STQ     REF_DEFLB

      693    15047    1          GOTO_DEST$ = ADDR (NIL) ;

  15047 27 002302   000014 756000 0                  STQ     GOTO_DEST$

      694    15048    1          VECTOR_END$ = ADDR(NIL) ;

  15048 27 002303   000075 756000 0                  STQ     VECTOR_END$

      695    15049    1          GOTO_VECTOR = FALSE ;

  15049 27 002304   000074 450000 0                  STZ     GOTO_VECTOR

      696    15050    1          DEFLB_AFTER_ENTRY = FALSE ;

  15050 27 002305   000057 450000 0                  STZ     DEFLB_AFTER_ENTRY

      697    15051    1          AFTER_USE         = FALSE ;

  15051 27 002306   000104 450000 0                  STZ     AFTER_USE

      698    15052    1          LABEL_AFTER_USE   = ADDR (NIL) ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:178  
  15052 27 002307   000105 756000 0                  STQ     LABEL_AFTER_USE

      699    15053    1          ENTADDR_OF_NIL$ = ADDR (NIL) ;

  15053 27 002310   000100 756000 0                  STQ     ENTADDR_OF_NIL$

      700    15054    1          EXIT_PROG$ = ADDR (NIL) ;

  15054 27 002311   000033 756000 0                  STQ     EXIT_PROG$

      701    15055    1          EXIT_PROG_FOUND = FALSE ;

  15055 27 002312   000034 450000 0                  STZ     EXIT_PROG_FOUND

      702    15056    1          FALL_THRU_FLAG = -1 ; /* Beginning of program */

  15056 27 002313   000001 335007                    LCA     1,DL
        27 002314   000053 755000 0                  STA     FALL_THRU_FLAG

      703    15057    1          DO_LEVEL = 1 ;

  15057 27 002315   000001 235007                    LDA     1,DL
        27 002316   000051 755000 0                  STA     DO_LEVEL

      704    15058    1          ENTRY_TYPE = %SUBROUTINE ; /* The default */

  15058 27 002317   000107 755000 0                  STA     ENTRY_TYPE

      705    15059        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:179  
      706    15060        /*V*
      707    15061            LOOP_THRU_ILS -- Loop thru the ILS looking at each ILL item.
      708    15062                             If optimizations are possible then they are done.
      709    15063
      710    15064                             ILS.ILL$ may be nill for a ILS entry so a check is made
      711    15065                             for that and if one is found it is deleted from the ILS.
      712    15066                             A case is then performed on the ILL entry's ID.
      713    15067        */
      714    15068
      715    15069    1      CASE_LOOP:
      716    15070    2          DO UNTIL (ILS$ = ADDR(NIL)) ;

  15070 27 002320                       CASE_LOOP    null
      717    15071    2            ILL$ = ILS$->ILS.ILL$ ;

  15071 27 002320   000000 470400 6                  LDP0    ILS$
        27 002321   000003 236100                    LDQ     3,,PR0
        27 002322   000000 756000 10                 STQ     ILL$

      718    15072    2            NEXT_ILS$ = ILS$ ;

  15072 27 002323   000000 236000 6                  LDQ     ILS$
        27 002324   000002 756000 0                  STQ     NEXT_ILS$

      719    15073                 %NEXT_ILS (POINTER=NEXT_ILS$) ;

  15075 27 002325   000002 471400 0                  LDP1    NEXT_ILS$
        27 002326   100002 236100                    LDQ     2,,PR1
        27 002327   000002 756000 0                  STQ     NEXT_ILS$

      720    15078
      721    15079    3            IF NEXT_ILS$ ~= ADDR(NIL) THEN DO ;

  15079 27 002330   000000 116000 28                 CMPQ    0
        27 002331   002350 600000 27                 TZE     CASE_STMT

      722    15080    4              IF NEXT_ILS$->ILS.ILL$ = ADDR(NIL) THEN DO ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:180  

  15080 27 002332   000002 471400 0                  LDP1    NEXT_ILS$
        27 002333   100003 236100                    LDQ     3,,PR1
        27 002334   000000 116000 28                 CMPQ    0
        27 002335   002350 601000 27                 TNZ     CASE_STMT

      723    15081
      724    15082    5                DO UNTIL NEXT_ILS$->ILS.ILL$ ~= ADDR(NIL)  ;

      725    15083                       %NEXT_ILS (POINTER=NEXT_ILS$) ;

  15085 27 002336   000002 470400 0                  LDP0    NEXT_ILS$
        27 002337   000002 236100                    LDQ     2,,PR0
        27 002340   000002 756000 0                  STQ     NEXT_ILS$

      726    15088    5                END ;

  15088 27 002341   000002 470400 0                  LDP0    NEXT_ILS$
        27 002342   000003 236100                    LDQ     3,,PR0
        27 002343   000000 116000 28                 CMPQ    0
        27 002344   002336 600000 27                 TZE     s:15085

      727    15089
      728    15090    4                ILS$->ILS.NEXT = NEXT_ILS$ ;

  15090 27 002345   000002 236000 0                  LDQ     NEXT_ILS$
        27 002346   000000 471400 6                  LDP1    ILS$
        27 002347   100002 756100                    STQ     2,,PR1

      729    15091    4              END ;

      730    15092    3            END ;

      731    15093
      732    15094    2          CASE_STMT:
      733    15095    3            DO CASE (ILL$->ILL.ID) ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:181  
  15095 27 002350   000000 470400 10    CASE_STMT    LDP0    ILL$
        27 002351   000000 236100                    LDQ     0,,PR0
        27 002352   000022 772000                    QRL     18
        27 002353   000245 136007                    SBLQ    165,DL
        27 002354   000202 116007                    CMPQ    130,DL
        27 002355   002357 602006 27                 TNC     CASE_STMT+7,QL
        27 002356   012073 710000 27                 TRA     s:17914
        27 002357   011113 710000 27                 TRA     s:17563
        27 002360   012073 710000 27                 TRA     s:17914
        27 002361   012073 710000 27                 TRA     s:17914
        27 002362   012073 710000 27                 TRA     s:17914
        27 002363   012073 710000 27                 TRA     s:17914
        27 002364   012073 710000 27                 TRA     s:17914
        27 002365   012073 710000 27                 TRA     s:17914
        27 002366   012073 710000 27                 TRA     s:17914
        27 002367   012073 710000 27                 TRA     s:17914
        27 002370   012073 710000 27                 TRA     s:17914
        27 002371   012073 710000 27                 TRA     s:17914
        27 002372   012073 710000 27                 TRA     s:17914
        27 002373   012073 710000 27                 TRA     s:17914
        27 002374   012073 710000 27                 TRA     s:17914
        27 002375   012073 710000 27                 TRA     s:17914
        27 002376   012073 710000 27                 TRA     s:17914
        27 002377   012073 710000 27                 TRA     s:17914
        27 002400   012073 710000 27                 TRA     s:17914
        27 002401   012073 710000 27                 TRA     s:17914
        27 002402   012073 710000 27                 TRA     s:17914
        27 002403   012073 710000 27                 TRA     s:17914
        27 002404   012073 710000 27                 TRA     s:17914
        27 002405   012073 710000 27                 TRA     s:17914
        27 002406   012073 710000 27                 TRA     s:17914
        27 002407   012073 710000 27                 TRA     s:17914
        27 002410   012073 710000 27                 TRA     s:17914
        27 002411   012073 710000 27                 TRA     s:17914
        27 002412   012073 710000 27                 TRA     s:17914
        27 002413   012073 710000 27                 TRA     s:17914
        27 002414   012073 710000 27                 TRA     s:17914
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:182  
        27 002415   012073 710000 27                 TRA     s:17914
        27 002416   012073 710000 27                 TRA     s:17914
        27 002417   012073 710000 27                 TRA     s:17914
        27 002420   012073 710000 27                 TRA     s:17914
        27 002421   012073 710000 27                 TRA     s:17914
        27 002422   012073 710000 27                 TRA     s:17914
        27 002423   012073 710000 27                 TRA     s:17914
        27 002424   012073 710000 27                 TRA     s:17914
        27 002425   012073 710000 27                 TRA     s:17914
        27 002426   012073 710000 27                 TRA     s:17914
        27 002427   012073 710000 27                 TRA     s:17914
        27 002430   012073 710000 27                 TRA     s:17914
        27 002431   012073 710000 27                 TRA     s:17914
        27 002432   012073 710000 27                 TRA     s:17914
        27 002433   012073 710000 27                 TRA     s:17914
        27 002434   012073 710000 27                 TRA     s:17914
        27 002435   012073 710000 27                 TRA     s:17914
        27 002436   012073 710000 27                 TRA     s:17914
        27 002437   012073 710000 27                 TRA     s:17914
        27 002440   012073 710000 27                 TRA     s:17914
        27 002441   012073 710000 27                 TRA     s:17914
        27 002442   012073 710000 27                 TRA     s:17914
        27 002443   012073 710000 27                 TRA     s:17914
        27 002444   012073 710000 27                 TRA     s:17914
        27 002445   012073 710000 27                 TRA     s:17914
        27 002446   012073 710000 27                 TRA     s:17914
        27 002447   012073 710000 27                 TRA     s:17914
        27 002450   012036 710000 27                 TRA     s:17889
        27 002451   011424 710000 27                 TRA     s:17686
        27 002452   012073 710000 27                 TRA     s:17914
        27 002453   012073 710000 27                 TRA     s:17914
        27 002454   012073 710000 27                 TRA     s:17914
        27 002455   012036 710000 27                 TRA     s:17889
        27 002456   002734 710000 27                 TRA     s:15176
        27 002457   012073 710000 27                 TRA     s:17914
        27 002460   005203 710000 27                 TRA     s:16061
        27 002461   012073 710000 27                 TRA     s:17914
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:183  
        27 002462   012073 710000 27                 TRA     s:17914
        27 002463   012073 710000 27                 TRA     s:17914
        27 002464   012073 710000 27                 TRA     s:17914
        27 002465   002634 710000 27                 TRA     s:15129
        27 002466   012073 710000 27                 TRA     s:17914
        27 002467   012073 710000 27                 TRA     s:17914
        27 002470   012073 710000 27                 TRA     s:17914
        27 002471   012073 710000 27                 TRA     s:17914
        27 002472   012073 710000 27                 TRA     s:17914
        27 002473   012073 710000 27                 TRA     s:17914
        27 002474   011346 710000 27                 TRA     s:17650
        27 002475   011346 710000 27                 TRA     s:17650
        27 002476   012073 710000 27                 TRA     s:17914
        27 002477   011424 710000 27                 TRA     s:17686
        27 002500   011432 710000 27                 TRA     s:17697
        27 002501   012073 710000 27                 TRA     s:17914
        27 002502   012073 710000 27                 TRA     s:17914
        27 002503   011346 710000 27                 TRA     s:17650
        27 002504   011346 710000 27                 TRA     s:17650
        27 002505   011411 710000 27                 TRA     s:17675
        27 002506   012043 710000 27                 TRA     s:17896
        27 002507   005501 710000 27                 TRA     s:16219
        27 002510   005501 710000 27                 TRA     s:16219
        27 002511   005501 710000 27                 TRA     s:16219
        27 002512   005501 710000 27                 TRA     s:16219
        27 002513   005501 710000 27                 TRA     s:16219
        27 002514   012073 710000 27                 TRA     s:17914
        27 002515   007554 710000 27                 TRA     s:16990
        27 002516   007575 710000 27                 TRA     s:17015
        27 002517   012073 710000 27                 TRA     s:17914
        27 002520   012073 710000 27                 TRA     s:17914
        27 002521   012073 710000 27                 TRA     s:17914
        27 002522   012073 710000 27                 TRA     s:17914
        27 002523   012073 710000 27                 TRA     s:17914
        27 002524   011045 710000 27                 TRA     s:17536
        27 002525   012073 710000 27                 TRA     s:17914
        27 002526   012073 710000 27                 TRA     s:17914
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:184  
        27 002527   012073 710000 27                 TRA     s:17914
        27 002530   012073 710000 27                 TRA     s:17914
        27 002531   012073 710000 27                 TRA     s:17914
        27 002532   012036 710000 27                 TRA     s:17889
        27 002533   012036 710000 27                 TRA     s:17889
        27 002534   012036 710000 27                 TRA     s:17889
        27 002535   012073 710000 27                 TRA     s:17914
        27 002536   012073 710000 27                 TRA     s:17914
        27 002537   012073 710000 27                 TRA     s:17914
        27 002540   012073 710000 27                 TRA     s:17914
        27 002541   012073 710000 27                 TRA     s:17914
        27 002542   012073 710000 27                 TRA     s:17914
        27 002543   012073 710000 27                 TRA     s:17914
        27 002544   012073 710000 27                 TRA     s:17914
        27 002545   012073 710000 27                 TRA     s:17914
        27 002546   012073 710000 27                 TRA     s:17914
        27 002547   012073 710000 27                 TRA     s:17914
        27 002550   012073 710000 27                 TRA     s:17914
        27 002551   012073 710000 27                 TRA     s:17914
        27 002552   012073 710000 27                 TRA     s:17914
        27 002553   012073 710000 27                 TRA     s:17914
        27 002554   012073 710000 27                 TRA     s:17914
        27 002555   012073 710000 27                 TRA     s:17914
        27 002556   012043 710000 27                 TRA     s:17896
        27 002557   002561 710000 27                 TRA     s:15101
        27 002560   012036 710000 27                 TRA     s:17889

      734    15096        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:185  
      735    15097        /*V*
      736    15098            SCOPE -- If necessary then insert a STOP or EXIT_PROG before it.
      737    15099        */
      738    15100    3              CASE (%SCOPE) ;

      739    15101    3                O2COM.SEGMENT_NO = 0 ;

  15101 27 002561   000005 450000 25                 STZ     O2COM+5

      740    15102    3                IF FALL_THRU_FLAG > 0 OR

  15102 27 002562   000053 235000 0                  LDA     FALL_THRU_FLAG
        27 002563   002604 605400 27                 TPNZ    s:15110
        27 002564   000001 236100                    LDQ     1,,PR0
        27 002565   000000 116000 28                 CMPQ    0
        27 002566   002606 600000 27                 TZE     s:15111
        27 002567   000001 471500                    LDP1    1,,PR0
        27 002570   100001 473500                    LDP3    1,,PR1
        27 002571   300001 236100                    LDQ     1,,PR3
        27 002572   000200 316007                    CANQ    128,DL
        27 002573   002606 600000 27                 TZE     s:15111
        27 002574   000107 235000 0                  LDA     ENTRY_TYPE
        27 002575   000001 115007                    CMPA    1,DL
        27 002576   002606 601000 27                 TNZ     s:15111
        27 002577   000033 236000 0                  LDQ     EXIT_PROG$
        27 002600   000000 116000 28                 CMPQ    0
        27 002601   002606 600000 27                 TZE     s:15111
        27 002602   000034 234000 0                  SZN     EXIT_PROG_FOUND
        27 002603   002606 604000 27                 TMI     s:15111

      741    15103    3                  (ILL$ -> SCOPE.PROC$ ~= ADDR (NIL) AND
      742    15104    3                   ILL$ -> SCOPE.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.
             15104                            EXIT_PROG_IN_DECL AND
      743    15105                         %IF CP6 ;
      744    15106    3                    ENTRY_TYPE = %SUBROUTINE AND
      745    15107                         %ENDIF ;
      746    15108    3                    EXIT_PROG$ ~= ADDR (NIL) AND
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:186  
      747    15109    3                    NOT EXIT_PROG_FOUND) THEN
      748    15110    3                  CALL INSERT_STOP_OR_EXIT ;

  15110 27 002604   000002 701000 27                 TSX1    INSERT_STOP_OR_EXIT
        27 002605   000000 011000                    NOP     0

      749    15111    3                CURRENT_PROC$ = ILL$ -> SCOPE.PROC$ ;

  15111 27 002606   000000 470400 10                 LDP0    ILL$
        27 002607   000001 236100                    LDQ     1,,PR0
        27 002610   000111 756000 0                  STQ     CURRENT_PROC$

      750    15112    3                IF CURRENT_PROC$ = ADDR (NIL)

  15112 27 002611   000000 116000 28                 CMPQ    0
        27 002612   002615 601000 27                 TNZ     s:15114

      751    15113    3                  THEN FALL_THRU_FLAG = 0 ; /* End of program */

  15113 27 002613   000053 450000 0                  STZ     FALL_THRU_FLAG
        27 002614   002624 710000 27                 TRA     s:15117

      752    15114    3                ELSE IF CURRENT_PROC$->PROC_.B.INLINE

  15114 27 002615   000111 471400 0                  LDP1    CURRENT_PROC$
        27 002616   100003 430100                    FSZN    3,,PR1
        27 002617   002622 605000 27                 TPL     s:15116

      753    15115    3                  THEN FALL_THRU_FLAG = 0 ; /* Program that was optimized out */

  15115 27 002620   000053 450000 0                  STZ     FALL_THRU_FLAG
        27 002621   002624 710000 27                 TRA     s:15117

      754    15116    3                  ELSE FALL_THRU_FLAG = -1 ; /* Beginning of (next) program */

  15116 27 002622   000001 335007                    LCA     1,DL
        27 002623   000053 755000 0                  STA     FALL_THRU_FLAG
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:187  

      755    15117    3                EXIT_PROG$ = ADDR (NIL) ;

  15117 27 002624   000000 236000 28                 LDQ     0
        27 002625   000033 756000 0                  STQ     EXIT_PROG$

      756    15118    3                EXIT_PROG_FOUND = FALSE ;

  15118 27 002626   000034 450000 0                  STZ     EXIT_PROG_FOUND

      757    15119    3                PREV_ILS$ = ILS$ ;

  15119 27 002627   000000 236000 6                  LDQ     ILS$
        27 002630   000001 756000 0                  STQ     PREV_ILS$

      758    15120    3                ILS$ = NEXT_ILS$ ;

  15120 27 002631   000002 236000 0                  LDQ     NEXT_ILS$
        27 002632   000000 756000 6                  STQ     ILS$
        27 002633   012101 710000 27                 TRA     s:17920

      759    15121        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:188  
      760    15122        /*V*
      761    15123            ENTRY -- If a main program or subroutine entry then:
      762    15124                     If there is no STOP or EXIT_PROG before the ENTRY and the ENTRY
      763    15125                     is not at the beginning of the program then insert a STOP or
      764    15126                     EXIT_PROG. Set the type for main program or subroutine.
      765    15127        */
      766    15128    3              CASE (%ENTRY) ;

      767    15129    4                IF ILL$->ILL.CODE ~= %SUBROUTINE_ENTRY THEN DO ;

  15129 27 002634   000000 720100                    LXL0    0,,PR0
        27 002635   000002 100003                    CMPX0   2,DU
        27 002636   002670 600000 27                 TZE     s:15147

      768    15130    4                  IF FALL_THRU_FLAG > 0 THEN

  15130 27 002637   000053 235000 0                  LDA     FALL_THRU_FLAG
        27 002640   002643 604400 27                 TMOZ    s:15132

      769    15131    4                    CALL INSERT_STOP_OR_EXIT ;

  15131 27 002641   000002 701000 27                 TSX1    INSERT_STOP_OR_EXIT
        27 002642   000000 011000                    NOP     0

      770    15132    4                  ENTRY_TYPE = ILL$->ILL.CODE ;

  15132 27 002643   000000 470400 10                 LDP0    ILL$
        27 002644   000000 236100                    LDQ     0,,PR0
        27 002645   777777 376007                    ANQ     -1,DL
        27 002646   000107 756000 0                  STQ     ENTRY_TYPE

      771    15133    4                  TEMP$ = ILS$ ;

  15133 27 002647   000000 236000 6                  LDQ     ILS$
        27 002650   000110 756000 0                  STQ     TEMP$

      772    15134                       %NEXT_NON_LINOI (POINTER=TEMP$) ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:189  

  15139 27 002651   000110 470400 0                  LDP0    TEMP$
        27 002652   000002 236100                    LDQ     2,,PR0
        27 002653   000110 756000 0                  STQ     TEMP$

  15142 27 002654   000110 470400 0                  LDP0    TEMP$
        27 002655   000003 236100                    LDQ     3,,PR0
        27 002656   000000 116000 28                 CMPQ    0
        27 002657   002651 600000 27                 TZE     s:15139
        27 002660   000003 471500                    LDP1    3,,PR0
        27 002661   100000 220100                    LDX0    0,,PR1
        27 002662   000373 100003                    CMPX0   251,DU
        27 002663   002651 600000 27                 TZE     s:15139

      773    15144    4                  IF TEMP$->ILS.ILL$->ILL.ID = %GO THEN

  15144 27 002664   000344 100003                    CMPX0   228,DU
        27 002665   002670 601000 27                 TNZ     s:15147

      774    15145    4                    AFTER_USE = TRUE ;

  15145 27 002666   400000 236003                    LDQ     -131072,DU
        27 002667   000104 756000 0                  STQ     AFTER_USE

      775    15146    4                END ;

      776    15147    3                DEFLB_AFTER_ENTRY = TRUE ;

  15147 27 002670   400000 236003                    LDQ     -131072,DU
        27 002671   000057 756000 0                  STQ     DEFLB_AFTER_ENTRY

      777    15148    3                FALL_THRU_FLAG = 1 ;

  15148 27 002672   000001 235007                    LDA     1,DL
        27 002673   000053 755000 0                  STA     FALL_THRU_FLAG

      778    15149    3                IF CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.EXIT_PROG_IN_DECL
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:190  

  15149 27 002674   000111 470400 0                  LDP0    CURRENT_PROC$
        27 002675   000001 471500                    LDP1    1,,PR0
        27 002676   100001 236100                    LDQ     1,,PR1
        27 002677   000200 316007                    CANQ    128,DL
        27 002700   002727 600000 27                 TZE     s:15162
        27 002701   000107 235000 0                  LDA     ENTRY_TYPE
        27 002702   000001 115007                    CMPA    1,DL
        27 002703   002727 601000 27                 TNZ     s:15162

      779    15150                         %IF CP6 ;
      780    15151    3                    AND ENTRY_TYPE = %SUBROUTINE
      781    15152                         %ENDIF ;
      782    15153    4                    THEN DO ;

      783    15154    5                  IF EXIT_PROG$ = ADDR (NIL) THEN DO ;

  15154 27 002704   000033 236000 0                  LDQ     EXIT_PROG$
        27 002705   000000 116000 28                 CMPQ    0
        27 002706   002724 601000 27                 TNZ     s:15160

      784    15155    5                    CALL Z8AT$CREATE_TEMPORARY (%PARA, EXIT_PROG$) ;

  15155 27 002707   000013 630400 28                 EPPR0   11
        27 002710   000005 631400 28                 EPPR1   5
        27 002711   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        27 002712   000000 011000                    NOP     0

      785    15156    5                    EXIT_PROG$->LABEL.PROC$ = CURRENT_PROC$ ;

  15156 27 002713   000111 236000 0                  LDQ     CURRENT_PROC$
        27 002714   000033 470400 0                  LDP0    EXIT_PROG$
        27 002715   000011 756100                    STQ     9,,PR0

      786    15157    5                    EXIT_PROG$->LABEL.B.EXIT_PROG_LABEL = TRUE;

  15157 27 002716   000033 470400 0                  LDP0    EXIT_PROG$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:191  
        27 002717   000200 236007                    LDQ     128,DL
        27 002720   000003 256100                    ORSQ    3,,PR0

      787    15158    5                    EXIT_PROG$->LABEL.B.REFERENCED = TRUE ;

  15158 27 002721   000033 470400 0                  LDP0    EXIT_PROG$
        27 002722   400000 236003                    LDQ     -131072,DU
        27 002723   000003 256100                    ORSQ    3,,PR0

      788    15159    5                  END ;

      789    15160    4                  ILL$->ENTRY_ILL.EXIT_PROG$ = EXIT_PROG$ ;

  15160 27 002724   000033 236000 0                  LDQ     EXIT_PROG$
        27 002725   000000 470400 10                 LDP0    ILL$
        27 002726   000004 756100                    STQ     4,,PR0

      790    15161    4                END ;

      791    15162    3                PREV_ILS$ = ILS$ ;

  15162 27 002727   000000 236000 6                  LDQ     ILS$
        27 002730   000001 756000 0                  STQ     PREV_ILS$

      792    15163    3                ILS$ = NEXT_ILS$ ;

  15163 27 002731   000002 236000 0                  LDQ     NEXT_ILS$
        27 002732   000000 756000 6                  STQ     ILS$
        27 002733   012101 710000 27                 TRA     s:17920

      793    15164        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:192  
      794    15165        /*V*
      795    15166            GO -- The GO statement is checked for its validity, whether it's an
      796    15167                  altered GO, and if it can be optimized.
      797    15168
      798    15169                  We check the left operand of the GO item to see if it is nill.
      799    15170                  If it is nill and the GO code does not specify it as nill then we
      800    15171                  delete the GO statement from the program.
      801    15172        */
      802    15173
      803    15174    3              CASE (%GO) ;

      804    15175
      805    15176    3                IF ILL$->ILL.LOP = ADDR(NIL) THEN

  15176 27 002734   000001 236100                    LDQ     1,,PR0
        27 002735   000000 116000 28                 CMPQ    0
        27 002736   003021 601000 27                 TNZ     s:15223

      806    15177    4                  DO ;

      807    15178
      808    15179    4                    IF ILL$->ILL.CODE = %GO_OVERFLOW_OFF OR

  15179 27 002737   000000 720100                    LXL0    0,,PR0
        27 002740   000024 100003                    CMPX0   20,DU
        27 002741   002744 600000 27                 TZE     s:15182
        27 002742   000023 100003                    CMPX0   19,DU
        27 002743   002747 601000 27                 TNZ     s:15186

      809    15180    4                       ILL$->ILL.CODE = %GO_FLT_OVERFLOW_OFF THEN
      810    15181    5                      DO ;

      811    15182    5                        PREV_ILS$ = ILS$ ;

  15182 27 002744   000000 236000 6                  LDQ     ILS$
        27 002745   000001 756000 0                  STQ     PREV_ILS$

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:193  
      812    15183    5                      END ;

  15183 27 002746   003014 710000 27                 TRA     s:15210

      813    15184    4                    ELSE
      814    15185    5                      DO ;

      815    15186    5                        IF ILL$->ILL.CODE ~= %GO_INVALID_LABEL /*#33670*/

  15186 27 002747   000033 100003                    CMPX0   27,DU
        27 002750   002755 600000 27                 TZE     s:15188

      816    15187    5                          THEN CALL Z8AE$ERROR (%E$GOTO_NO_DEST) ;

  15187 27 002751   000016 630400 28                 EPPR0   14
        27 002752   000001 631400 28                 EPPR1   1
        27 002753   000000 701000 xent               TSX1    Z8AE$ERROR
        27 002754   000000 011000                    NOP     0

      817    15188    5                        PREV_ILS$->ILS.NEXT = NEXT_ILS$ ;

  15188 27 002755   000002 236000 0                  LDQ     NEXT_ILS$
        27 002756   000001 470400 0                  LDP0    PREV_ILS$
        27 002757   000002 756100                    STQ     2,,PR0

      818    15189    5                        ILS$$ = ILS$ ;

  15189 27 002760   000000 236000 6                  LDQ     ILS$
        27 002761   000060 756000 0                  STQ     ILS$$

      819    15190                             %NEXT_NON_SUPPORT (POINTER=ILS$$) ;

  15200 27 002762   000060 470400 0                  LDP0    ILS$$
        27 002763   000002 236100                    LDQ     2,,PR0
        27 002764   000060 756000 0                  STQ     ILS$$

  15203 27 002765   000060 470400 0                  LDP0    ILS$$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:194  
        27 002766   000003 236100                    LDQ     3,,PR0
        27 002767   000000 116000 28                 CMPQ    0
        27 002770   002762 600000 27                 TZE     s:15200
        27 002771   000003 471500                    LDP1    3,,PR0
        27 002772   100000 220100                    LDX0    0,,PR1
        27 002773   000343 100003                    CMPX0   227,DU
        27 002774   002762 600000 27                 TZE     s:15200
        27 002775   000422 100003                    CMPX0   274,DU
        27 002776   002762 600000 27                 TZE     s:15200
        27 002777   000446 100003                    CMPX0   294,DU
        27 003000   002762 600000 27                 TZE     s:15200
        27 003001   000336 100003                    CMPX0   222,DU
        27 003002   002762 600000 27                 TZE     s:15200
        27 003003   000420 100003                    CMPX0   272,DU
        27 003004   002762 600000 27                 TZE     s:15200
        27 003005   000373 100003                    CMPX0   251,DU
        27 003006   002762 600000 27                 TZE     s:15200

      820    15205    5                        IF ILS$$->ILS.ILL$->ILL.ID = %DEFLB

  15205 27 003007   000346 100003                    CMPX0   230,DU
        27 003010   003014 601000 27                 TNZ     s:15210

      821    15206    5                          THEN ILS$$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$

  15206 27 003011   100001 473500                    LDP3    1,,PR1
        27 003012   000001 236000 0                  LDQ     PREV_ILS$
        27 003013   300010 756100                    STQ     8,,PR3

      822    15207    5                              = PREV_ILS$ ;
      823    15208    5                      END ;

      824    15209
      825    15210    4                    ILS$ = NEXT_ILS$ ;

  15210 27 003014   000002 236000 0                  LDQ     NEXT_ILS$
        27 003015   000000 756000 6                  STQ     ILS$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:195  

      826    15211    4                    FALL_THRU_FLAG = 1 ; /* Fall thru possible */

  15211 27 003016   000001 235007                    LDA     1,DL
        27 003017   000053 755000 0                  STA     FALL_THRU_FLAG

      827    15212
      828    15213    4                    EXIT CASE_STMT ;

  15213 27 003020   012101 710000 27                 TRA     s:17920

      829    15214    4                  END ;
      830    15215        %EJECT;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:196  
      831    15216        /*V*
      832    15217            USELESS_GO -- Optimize out all transfers to current location + 1, unless
      833    15218                          they are ALTERed or use instructions like TOV that may
      834    15219                          change the Indicator Register or transfer to a different
      835    15220                          segment. If FALL_THRU_FLAG = 0 it is dead code; get rid
      836    15221                          of it later.
      837    15222        */
      838    15223    3                IF FALL_THRU_FLAG ~= 0 THEN

  15223 27 003021   000053 235000 0                  LDA     FALL_THRU_FLAG
        27 003022   003212 600000 27                 TZE     s:15299

      839    15224    4                  DO CASE (ILL$ -> ILL.CODE) ;

  15224 27 003023   000000 236100                    LDQ     0,,PR0
        27 003024   777777 376007                    ANQ     -1,DL
        27 003025   000015 136007                    SBLQ    13,DL
        27 003026   000015 116007                    CMPQ    13,DL
        27 003027   003031 602006 27                 TNC     s:15224+6,QL
        27 003030   003046 710000 27                 TRA     s:15229
        27 003031   003212 710000 27                 TRA     s:15299
        27 003032   003046 710000 27                 TRA     s:15229
        27 003033   003046 710000 27                 TRA     s:15229
        27 003034   003212 710000 27                 TRA     s:15299
        27 003035   003046 710000 27                 TRA     s:15229
        27 003036   003046 710000 27                 TRA     s:15229
        27 003037   003212 710000 27                 TRA     s:15299
        27 003040   003212 710000 27                 TRA     s:15299
        27 003041   003046 710000 27                 TRA     s:15229
        27 003042   003046 710000 27                 TRA     s:15229
        27 003043   003046 710000 27                 TRA     s:15229
        27 003044   003046 710000 27                 TRA     s:15229
        27 003045   003212 710000 27                 TRA     s:15299

      840    15225    4                    CASE (%GO_OVERFLOW, %GO_OVERFLOW_OFF, %GO_FLT_OVERFLOW,

      841    15226    4                          %GO_FLT_OVERFLOW_OFF, %GO_ALTERED) ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:197  
      842    15227                           /* These cannot be optimized out. */
      843    15228    4                    CASE (ELSE) ;

      844    15229    4                      ILS$$ = ILS$ ;

  15229 27 003046   000000 236000 6                  LDQ     ILS$
        27 003047   000060 756000 0                  STQ     ILS$$

      845    15230                           %NEXT_NON_SUPPORT (POINTER=ILS$$) ;

  15240 27 003050   000060 470400 0                  LDP0    ILS$$
        27 003051   000002 236100                    LDQ     2,,PR0
        27 003052   000060 756000 0                  STQ     ILS$$

  15243 27 003053   000060 470400 0                  LDP0    ILS$$
        27 003054   000003 236100                    LDQ     3,,PR0
        27 003055   000000 116000 28                 CMPQ    0
        27 003056   003050 600000 27                 TZE     s:15240
        27 003057   000003 471500                    LDP1    3,,PR0
        27 003060   100000 220100                    LDX0    0,,PR1
        27 003061   000343 100003                    CMPX0   227,DU
        27 003062   003050 600000 27                 TZE     s:15240
        27 003063   000422 100003                    CMPX0   274,DU
        27 003064   003050 600000 27                 TZE     s:15240
        27 003065   000446 100003                    CMPX0   294,DU
        27 003066   003050 600000 27                 TZE     s:15240
        27 003067   000336 100003                    CMPX0   222,DU
        27 003070   003050 600000 27                 TZE     s:15240
        27 003071   000420 100003                    CMPX0   272,DU
        27 003072   003050 600000 27                 TZE     s:15240
        27 003073   000373 100003                    CMPX0   251,DU
        27 003074   003050 600000 27                 TZE     s:15240

      846    15245    4                      IF ILS$$->ILS.ILL$->ILL.ID = %DEFLB AND

  15245 27 003075   000346 100003                    CMPX0   230,DU
        27 003076   003212 601000 27                 TNZ     s:15299
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:198  
        27 003077   100001 473500                    LDP3    1,,PR1
        27 003100   300003 236100                    LDQ     3,,PR3
        27 003101   000400 316007                    CANQ    256,DL
        27 003102   003212 601000 27                 TNZ     s:15299
        27 003103   300000 221100                    LDX1    0,,PR3
        27 003104   000771 101003                    CMPX1   505,DU
        27 003105   003116 600000 27                 TZE     USELESS_GO_CHECK
        27 003106   300007 236100                    LDQ     7,,PR3
        27 003107   000000 116000 28                 CMPQ    0
        27 003110   003116 600000 27                 TZE     USELESS_GO_CHECK
        27 003111   300007 474500                    LDP4    7,,PR3
        27 003112   400002 236100                    LDQ     2,,PR4
        27 003113   003212 604000 27                 TMI     s:15299
        27 003114   000005 116000 25                 CMPQ    O2COM+5
        27 003115   003212 601000 27                 TNZ     s:15299

      847    15246    4                          NOT ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.PFORM_END_LBL AND
      848    15247    4                          (ILS$$->ILS.ILL$->ILL.LOP->LABEL.ID = %PARA OR
      849    15248    4                           ILS$$->ILS.ILL$->ILL.LOP->SECTION.SEGMENT$ = ADDR(NIL) OR
      850    15249    4                           ILS$$->ILS.ILL$->ILL.LOP->SECTION.SEGMENT$->SEGMENT_LTS.
             15249                                    SEGMENT_NO# =
      851    15250    4                             O2COM.SEGMENT_NO) THEN
      852    15251    5   USELESS_GO_CHECK:    DO ;

  15251 27 003116                       USELESS_GO_* null
      853    15252    5                          TEMP$ = ILS$$ ;
             15252                                   /* So this DEFLB's PREV_ILS$ can be changed */

  15252 27 003116   000060 236000 0                  LDQ     ILS$$
        27 003117   000110 756000 0                  STQ     TEMP$

      854    15253    6                          DO WHILE ILS$$->ILS.ILL$->ILL.LOP ~= ILL$->ILL.LOP ;

  15253 27 003120   000000 474400 10                 LDP4    ILL$
        27 003121   100001 236100                    LDQ     1,,PR1
        27 003122   400001 116100                    CMPQ    1,,PR4
        27 003123   003163 600000 27                 TZE     s:15273
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:199  

      855    15254                                 %NEXT_NON_SUPPORT (POINTER=ILS$$) ;

  15264 27 003124   000060 470400 0                  LDP0    ILS$$
        27 003125   000002 236100                    LDQ     2,,PR0
        27 003126   000060 756000 0                  STQ     ILS$$

  15267 27 003127   000060 470400 0                  LDP0    ILS$$
        27 003130   000003 236100                    LDQ     3,,PR0
        27 003131   000000 116000 28                 CMPQ    0
        27 003132   003124 600000 27                 TZE     s:15264
        27 003133   000003 471500                    LDP1    3,,PR0
        27 003134   100000 220100                    LDX0    0,,PR1
        27 003135   000343 100003                    CMPX0   227,DU
        27 003136   003124 600000 27                 TZE     s:15264
        27 003137   000422 100003                    CMPX0   274,DU
        27 003140   003124 600000 27                 TZE     s:15264
        27 003141   000446 100003                    CMPX0   294,DU
        27 003142   003124 600000 27                 TZE     s:15264
        27 003143   000336 100003                    CMPX0   222,DU
        27 003144   003124 600000 27                 TZE     s:15264
        27 003145   000420 100003                    CMPX0   272,DU
        27 003146   003124 600000 27                 TZE     s:15264
        27 003147   000373 100003                    CMPX0   251,DU
        27 003150   003124 600000 27                 TZE     s:15264

      856    15269    6                            IF ILS$$->ILS.ILL$->ILL.ID ~= %DEFLB OR

  15269 27 003151   000346 100003                    CMPX0   230,DU
        27 003152   003212 601000 27                 TNZ     s:15299
        27 003153   100001 473500                    LDP3    1,,PR1
        27 003154   300003 236100                    LDQ     3,,PR3
        27 003155   000400 316007                    CANQ    256,DL
        27 003156   003212 601000 27                 TNZ     s:15299

      857    15270    6                                ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.PFORM_END_LBL THEN
      858    15271    6                              EXIT USELESS_GO_CHECK ; /* Not transfer to *+1 */
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:200  
      859    15272    6                          END ; /* WHILE */

  15272 27 003157   000000 474400 10                 LDP4    ILL$
        27 003160   100001 236100                    LDQ     1,,PR1
        27 003161   400001 116100                    CMPQ    1,,PR4
        27 003162   003124 601000 27                 TNZ     s:15264

      860    15273    6                          IF ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.ONE_REF THEN DO ;

  15273 27 003163   300003 236100                    LDQ     3,,PR3
        27 003164   010000 316003                    CANQ    4096,DU
        27 003165   003200 600000 27                 TZE     s:15278

      861    15274    6                            ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.ONE_REF = FALSE ;

  15274 27 003166   000004 236000 28                 LDQ     4
        27 003167   300003 356100                    ANSQ    3,,PR3

      862    15275    6                            ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.REFERENCED = FALSE ;

  15275 27 003170   000003 471500                    LDP1    3,,PR0
        27 003171   100001 473500                    LDP3    1,,PR1
        27 003172   000017 236000 28                 LDQ     15
        27 003173   300003 356100                    ANSQ    3,,PR3

      863    15276    6                            ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.GOTO_LABEL = FALSE ;

  15276 27 003174   000003 471500                    LDP1    3,,PR0
        27 003175   100001 473500                    LDP3    1,,PR1
        27 003176   000020 236000 28                 LDQ     16
        27 003177   300003 356100                    ANSQ    3,,PR3

      864    15277    6                          END ;

      865    15278    5                          TEMP$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ = PREV_ILS$ ;

  15278 27 003200   000110 471400 0                  LDP1    TEMP$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:201  
        27 003201   100003 473500                    LDP3    3,,PR1
        27 003202   300001 475500                    LDP5    1,,PR3
        27 003203   000001 236000 0                  LDQ     PREV_ILS$
        27 003204   500010 756100                    STQ     8,,PR5

      866    15279    5                          PREV_ILS$->ILS.NEXT = NEXT_ILS$ ;

  15279 27 003205   000002 236000 0                  LDQ     NEXT_ILS$
        27 003206   000001 473400 0                  LDP3    PREV_ILS$
        27 003207   300002 756100                    STQ     2,,PR3

      867    15280    5                          ILS$ = NEXT_ILS$ ;

  15280 27 003210   000000 756000 6                  STQ     ILS$

      868    15281    5                          EXIT CASE_STMT ;

  15281 27 003211   012101 710000 27                 TRA     s:17920

      869    15282    5                        END ; /* USELESS_GO_CHECK */
      870    15283    4                  END ; /* CASE */

      871    15284        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:202  
      872    15285        /*V*
      873    15286            CHAIN_OF_GO_ITEMS -- If the GO points directly to a non-ALTERed GO then
      874    15287                                 this GO can be set to point to where the destination
      875    15288                                 GO points. It is possible for long chains of GOs to
      876    15289                                 be collapsed to a single GO this way.
      877    15290                                 Suppress this optimization if NOPTZ.
      878    15291        */
      879    15292        /*                Explanation of GO_FLAG:
      880    15293                          -1 GO destination is not a GO or is ALTERED.
      881    15294                           0 GO destination is non-ALTERed GO that cannot
      882    15295                             be optimized out.
      883    15296                          +1 Go destination is non-ALTERed GO that can
      884    15297                             be optimized out.
      885    15298        */
      886    15299    3                IF COMCOM.OB.OPTZ AND

  15299 27 003212   000014 234000 xsym               SZN     COMCOM+12
        27 003213   004665 605000 27                 TPL     s:15927
        27 003214   000314 235000 xsym               LDA     COMCOM+204
        27 003215   000001 115007                    CMPA    1,DL
        27 003216   004665 605400 27                 TPNZ    s:15927

      887    15300    4                    COMCOM.SEGMENTC <= 1 THEN DO;

      888    15301    5                  DO UNTIL GO_FLAG < 0 ;

      889    15302    5                    IF ILL$->ILL.LOP->LABEL.ID = %PARA OR

  15302 27 003217   000000 470400 10                 LDP0    ILL$
        27 003220   000001 471500                    LDP1    1,,PR0
        27 003221   100000 220100                    LDX0    0,,PR1
        27 003222   000771 100003                    CMPX0   505,DU
        27 003223   003226 600000 27                 TZE     s:15305
        27 003224   000770 100003                    CMPX0   504,DU
        27 003225   003422 601000 27                 TNZ     s:15383

      890    15303    6                        ILL$->ILL.LOP->LABEL.ID = %SECTION THEN DO ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:203  

      891    15304                                    /* It can be SSOP, for example. */
      892    15305    6                      ILS$$ = ILL$->ILL.LOP->LABEL.PREV_ILS$ ;

  15305 27 003226   100010 236100                    LDQ     8,,PR1
        27 003227   000060 756000 0                  STQ     ILS$$

      893    15306                           %NEXT_NON_SUPPORT (POINTER=ILS$$) ; /* ILS for DEFLB */

  15316 27 003230   000060 470400 0                  LDP0    ILS$$
        27 003231   000002 236100                    LDQ     2,,PR0
        27 003232   000060 756000 0                  STQ     ILS$$

  15319 27 003233   000060 470400 0                  LDP0    ILS$$
        27 003234   000003 236100                    LDQ     3,,PR0
        27 003235   000000 116000 28                 CMPQ    0
        27 003236   003230 600000 27                 TZE     s:15316
        27 003237   000003 471500                    LDP1    3,,PR0
        27 003240   100000 220100                    LDX0    0,,PR1
        27 003241   000343 100003                    CMPX0   227,DU
        27 003242   003230 600000 27                 TZE     s:15316
        27 003243   000422 100003                    CMPX0   274,DU
        27 003244   003230 600000 27                 TZE     s:15316
        27 003245   000446 100003                    CMPX0   294,DU
        27 003246   003230 600000 27                 TZE     s:15316
        27 003247   000336 100003                    CMPX0   222,DU
        27 003250   003230 600000 27                 TZE     s:15316
        27 003251   000420 100003                    CMPX0   272,DU
        27 003252   003230 600000 27                 TZE     s:15316
        27 003253   000373 100003                    CMPX0   251,DU
        27 003254   003230 600000 27                 TZE     s:15316

      894    15321    6                      GO_ILS$ = ILS$$ ;

  15321 27 003255   000060 236000 0                  LDQ     ILS$$
        27 003256   000015 756000 0                  STQ     GO_ILS$

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:204  
      895    15322                           %NEXT_NON_SUPPORT (POINTER=ILS$$) ; /* Next statement */

  15332 27 003257   000060 470400 0                  LDP0    ILS$$
        27 003260   000002 236100                    LDQ     2,,PR0
        27 003261   000060 756000 0                  STQ     ILS$$

  15335 27 003262   000060 470400 0                  LDP0    ILS$$
        27 003263   000003 236100                    LDQ     3,,PR0
        27 003264   000000 116000 28                 CMPQ    0
        27 003265   003257 600000 27                 TZE     s:15332
        27 003266   000003 471500                    LDP1    3,,PR0
        27 003267   100000 220100                    LDX0    0,,PR1
        27 003270   000343 100003                    CMPX0   227,DU
        27 003271   003257 600000 27                 TZE     s:15332
        27 003272   000422 100003                    CMPX0   274,DU
        27 003273   003257 600000 27                 TZE     s:15332
        27 003274   000446 100003                    CMPX0   294,DU
        27 003275   003257 600000 27                 TZE     s:15332
        27 003276   000336 100003                    CMPX0   222,DU
        27 003277   003257 600000 27                 TZE     s:15332
        27 003300   000420 100003                    CMPX0   272,DU
        27 003301   003257 600000 27                 TZE     s:15332
        27 003302   000373 100003                    CMPX0   251,DU
        27 003303   003257 600000 27                 TZE     s:15332

      896    15337    6                      IF ILS$$->ILS.ILL$->ILL.ID = %GO AND

  15337 27 003304   000344 100003                    CMPX0   228,DU
        27 003305   003417 601000 27                 TNZ     s:15381
        27 003306   100000 721100                    LXL1    0,,PR1
        27 003307   003417 601000 27                 TNZ     s:15381
        27 003310   100001 236100                    LDQ     1,,PR1
        27 003311   000000 116000 28                 CMPQ    0
        27 003312   003417 600000 27                 TZE     s:15381
        27 003313   000000 473400 10                 LDP3    ILL$
        27 003314   300001 474500                    LDP4    1,,PR3
        27 003315   400005 236100                    LDQ     5,,PR4
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:205  
        27 003316   000000 116000 28                 CMPQ    0
        27 003317   003417 601000 27                 TNZ     s:15381

      897    15338    6                          ILS$$->ILS.ILL$->ILL.CODE = %GO_UNCONDITIONAL AND
      898    15339    6                          ILS$$->ILS.ILL$->ILL.LOP ~= ADDR (NIL) AND
      899    15340    7                          ILL$->ILL.LOP->LABEL.POINTER$ = ADDR (NIL) THEN DO ;

      900    15341    8                        IF ILL$->ILL.LOP ~= ILS$$->ILS.ILL$->ILL.LOP THEN DO ;

  15341 27 003320   300001 236100                    LDQ     1,,PR3
        27 003321   100001 116100                    CMPQ    1,,PR1
        27 003322   003414 600000 27                 TZE     s:15377

      901    15342    8                          GO_FLAG = 0 ; /* GO points to another GO */

  15342 27 003323   000050 450000 0                  STZ     GO_FLAG

      902    15343    8                          IF ILL$->ILL.LOP->LABEL.B.FALL_THRU OR

  15343 27 003324   400003 236100                    LDQ     3,,PR4
        27 003325   002000 316003                    CANQ    1024,DU
        27 003326   003331 601000 27                 TNZ     s:15345
        27 003327   010000 316003                    CANQ    4096,DU
        27 003330   003335 601000 27                 TNZ     s:15346

      903    15344    8                              NOT ILL$->ILL.LOP->LABEL.B.ONE_REF
      904    15345    8                            THEN ILS$$->ILS.ILL$->ILL.LOP->LABEL.B.ONE_REF = FALSE ;

  15345 27 003331   100001 475500                    LDP5    1,,PR1
        27 003332   000004 236000 28                 LDQ     4
        27 003333   500003 356100                    ANSQ    3,,PR5
        27 003334   003337 710000 27                 TRA     s:15347

      905    15346    8                            ELSE GO_FLAG = 1 ; /* Destination GO can be scrapped */

  15346 27 003335   000001 235007                    LDA     1,DL
        27 003336   000050 755000 0                  STA     GO_FLAG
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:206  

      906    15347    9                          IF ILL$->ILL.LOP->LABEL.B.ONE_REF THEN DO ;

  15347 27 003337   300001 471500                    LDP1    1,,PR3
        27 003340   100003 236100                    LDQ     3,,PR1
        27 003341   010000 316003                    CANQ    4096,DU
        27 003342   003350 600000 27                 TZE     s:15351

      907    15348    9                            ILL$->ILL.LOP->LABEL.B.ONE_REF = FALSE ;

  15348 27 003343   000004 236000 28                 LDQ     4
        27 003344   100003 356100                    ANSQ    3,,PR1

      908    15349    9                            ILL$->ILL.LOP->LABEL.B.REFERENCED = FALSE ;

  15349 27 003345   300001 471500                    LDP1    1,,PR3
        27 003346   000017 236000 28                 LDQ     15
        27 003347   100003 356100                    ANSQ    3,,PR1

      909    15350    9                          END ;

      910    15351    8                          ILL$->ILL.LOP = ILS$$->ILS.ILL$->ILL.LOP ;

  15351 27 003350   000003 471500                    LDP1    3,,PR0
        27 003351   100001 236100                    LDQ     1,,PR1
        27 003352   300001 756100                    STQ     1,,PR3

      911    15352                                   /* Optimize out an unneeded GO */
      912    15353    9                          IF GO_FLAG > 0 THEN DO ;

  15353 27 003353   000050 235000 0                  LDA     GO_FLAG
        27 003354   003424 604400 27                 TMOZ    s:15384

      913    15354    9                            ILS$$->ILS.ILL$ = ADDR (NIL) ;

  15354 27 003355   000000 236000 28                 LDQ     0
        27 003356   000003 756100                    STQ     3,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:207  

      914    15355    9                            TEMP$ = ILS$$ ;

  15355 27 003357   000060 236000 0                  LDQ     ILS$$
        27 003360   000110 756000 0                  STQ     TEMP$

      915    15356                                 %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  15366 27 003361   000110 470400 0                  LDP0    TEMP$
        27 003362   000002 236100                    LDQ     2,,PR0
        27 003363   000110 756000 0                  STQ     TEMP$

  15369 27 003364   000110 470400 0                  LDP0    TEMP$
        27 003365   000003 236100                    LDQ     3,,PR0
        27 003366   000000 116000 28                 CMPQ    0
        27 003367   003361 600000 27                 TZE     s:15366
        27 003370   000003 471500                    LDP1    3,,PR0
        27 003371   100000 220100                    LDX0    0,,PR1
        27 003372   000343 100003                    CMPX0   227,DU
        27 003373   003361 600000 27                 TZE     s:15366
        27 003374   000422 100003                    CMPX0   274,DU
        27 003375   003361 600000 27                 TZE     s:15366
        27 003376   000446 100003                    CMPX0   294,DU
        27 003377   003361 600000 27                 TZE     s:15366
        27 003400   000336 100003                    CMPX0   222,DU
        27 003401   003361 600000 27                 TZE     s:15366
        27 003402   000420 100003                    CMPX0   272,DU
        27 003403   003361 600000 27                 TZE     s:15366
        27 003404   000373 100003                    CMPX0   251,DU
        27 003405   003361 600000 27                 TZE     s:15366

      916    15371    9                            IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB THEN

  15371 27 003406   000346 100003                    CMPX0   230,DU
        27 003407   003424 601000 27                 TNZ     s:15384

      917    15372    9                              TEMP$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ =
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:208  

  15372 27 003410   100001 473500                    LDP3    1,,PR1
        27 003411   000015 236000 0                  LDQ     GO_ILS$
        27 003412   300010 756100                    STQ     8,,PR3

      918    15373    9                                  GO_ILS$ ;
      919    15374    9                          END ;

      920    15375                                     /* Mark the destination GO for deletion */
      921    15376    8                        END ;

  15376 27 003413   003424 710000 27                 TRA     s:15384

      922    15377    7                        ELSE GO_FLAG = -1 ;

  15377 27 003414   000001 335007                    LCA     1,DL
        27 003415   000050 755000 0                  STA     GO_FLAG

      923    15378                             /* GO TO itself is legal and should not be optimized.
      924    15379                                The user is risking a lockup fault at runtime. */
      925    15380    7                      END ;

  15380 27 003416   003424 710000 27                 TRA     s:15384

      926    15381    6                      ELSE GO_FLAG = -1 ; /* GO does not point to another GO */

  15381 27 003417   000001 335007                    LCA     1,DL
        27 003420   000050 755000 0                  STA     GO_FLAG

      927    15382    6                    END ;

  15382 27 003421   003424 710000 27                 TRA     s:15384

      928    15383    5                    ELSE GO_FLAG = -1 ; /* Do not optimize GO TO DEPENDING. */

  15383 27 003422   000001 335007                    LCA     1,DL
        27 003423   000050 755000 0                  STA     GO_FLAG
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:209  

      929    15384    5                  END ;

  15384 27 003424   000050 235000 0                  LDA     GO_FLAG
        27 003425   003217 605000 27                 TPL     s:15302

      930    15385        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:210  
      931    15386        /*V*
      932    15387            OPTIMIZE_GO -- If it is a GO to a label before the GO and all the
      933    15388                           referenced labels in between, if any, are compiler
      934    15389                           created, then generate DO_1 and DOEND around the GO and
      935    15390                           label so that Phase 3 can optimize it.
      936    15391                           Suppress this optimization if NOPTZ.
      937    15392        */
      938    15393        /*         Explanation of GO_FLAG for the following code:
      939    15394                   +1 GO can be optimized to a DO loop.
      940    15395                   0  It is not yet known if the GO can be optimized.
      941    15396                   -1 GO cannot be optimized to a DO loop.
      942    15397        */
      943    15398    4                  IF GOTO_DEST$ = ADDR (NIL) AND ILL$->ILL.LOP ~= ADDR (NIL)

  15398 27 003426   000014 236000 0                  LDQ     GOTO_DEST$
        27 003427   000000 116000 28                 CMPQ    0
        27 003430   003455 601000 27                 TNZ     s:15404
        27 003431   000000 470400 10                 LDP0    ILL$
        27 003432   000001 236100                    LDQ     1,,PR0
        27 003433   000000 116000 28                 CMPQ    0
        27 003434   003455 600000 27                 TZE     s:15404
        27 003435   000001 471500                    LDP1    1,,PR0
        27 003436   100003 236100                    LDQ     3,,PR1
        27 003437   100000 316003                    CANQ    32768,DU
        27 003440   003455 601000 27                 TNZ     s:15404
        27 003441   100000 220100                    LDX0    0,,PR1
        27 003442   000771 100003                    CMPX0   505,DU
        27 003443   003446 600000 27                 TZE     s:15398+16
        27 003444   000770 100003                    CMPX0   504,DU
        27 003445   003455 601000 27                 TNZ     s:15404
        27 003446   004000 316003                    CANQ    2048,DU
        27 003447   003455 600000 27                 TZE     s:15404
        27 003450   000051 235000 0                  LDA     DO_LEVEL
        27 003451   000001 115007                    CMPA    1,DL
        27 003452   003455 601000 27                 TNZ     s:15404

      944    15399    4                      AND NOT ILL$ -> ILL.LOP -> LABEL.B.COMPILER_CREATED
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:211  
      945    15400    4                      AND (ILL$->ILL.LOP->LABEL.ID = %PARA
      946    15401    4                      OR ILL$->ILL.LOP->LABEL.ID = %SECTION)
      947    15402    4                      AND ILL$->ILL.LOP->LABEL.B.PHASE_2 AND DO_LEVEL = 1
      948    15403    4                    THEN GOTO_DEST$ = ILL$->ILL.LOP ;

  15403 27 003453   000001 236100                    LDQ     1,,PR0
        27 003454   000014 756000 0                  STQ     GOTO_DEST$

      949    15404    5                  IF GOTO_DEST$ ~= ADDR (NIL) AND DO_LEVEL = 1 THEN DO ;

  15404 27 003455   000014 236000 0                  LDQ     GOTO_DEST$
        27 003456   000000 116000 28                 CMPQ    0
        27 003457   004665 600000 27                 TZE     s:15927
        27 003460   000051 235000 0                  LDA     DO_LEVEL
        27 003461   000001 115007                    CMPA    1,DL
        27 003462   004665 601000 27                 TNZ     s:15927

      950    15405    5                    GO_ILS$ = ILS$ ;

  15405 27 003463   000000 236000 6                  LDQ     ILS$
        27 003464   000015 756000 0                  STQ     GO_ILS$

      951    15406    5                    GO_FLAG = 0 ;

  15406 27 003465   000050 450000 0                  STZ     GO_FLAG

      952    15407    5                    IF NOT GOTO_DEST$->LABEL.B.ENTRY_POINT

  15407 27 003466   000014 470400 0                  LDP0    GOTO_DEST$
        27 003467   000003 236100                    LDQ     3,,PR0
        27 003470   000002 316003                    CANQ    2,DU
        27 003471   003577 601000 27                 TNZ     s:15448

      953    15408    6                        THEN DO UNTIL (GO_FLAG ~= 0) ;

      954    15409                           %NEXT_NON_SUPPORT (POINTER=GO_ILS$) ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:212  
  15419 27 003472   000015 470400 0                  LDP0    GO_ILS$
        27 003473   000002 236100                    LDQ     2,,PR0
        27 003474   000015 756000 0                  STQ     GO_ILS$

  15422 27 003475   000015 470400 0                  LDP0    GO_ILS$
        27 003476   000003 236100                    LDQ     3,,PR0
        27 003477   000000 116000 28                 CMPQ    0
        27 003500   003472 600000 27                 TZE     s:15419
        27 003501   000003 471500                    LDP1    3,,PR0
        27 003502   100000 220100                    LDX0    0,,PR1
        27 003503   000343 100003                    CMPX0   227,DU
        27 003504   003472 600000 27                 TZE     s:15419
        27 003505   000422 100003                    CMPX0   274,DU
        27 003506   003472 600000 27                 TZE     s:15419
        27 003507   000446 100003                    CMPX0   294,DU
        27 003510   003472 600000 27                 TZE     s:15419
        27 003511   000336 100003                    CMPX0   222,DU
        27 003512   003472 600000 27                 TZE     s:15419
        27 003513   000420 100003                    CMPX0   272,DU
        27 003514   003472 600000 27                 TZE     s:15419
        27 003515   000373 100003                    CMPX0   251,DU
        27 003516   003472 600000 27                 TZE     s:15419

      955    15424    6                      TEMP$ = GO_ILS$->ILS.ILL$->ILL.LOP ;

  15424 27 003517   100001 236100                    LDQ     1,,PR1
        27 003520   000110 756000 0                  STQ     TEMP$

      956    15425    7   GO_1:              DO CASE (GO_ILS$->ILS.ILL$->ILL.ID) ;

  15425 27 003521   100000 236100       GO_1         LDQ     0,,PR1
        27 003522   000022 772000                    QRL     18
        27 003523   000344 136007                    SBLQ    228,DL
        27 003524   000003 116007                    CMPQ    3,DL
        27 003525   003527 602006 27                 TNC     GO_1+6,QL
        27 003526   003573 710000 27                 TRA     s:15445
        27 003527   003543 710000 27                 TRA     s:15431
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:213  
        27 003530   003573 710000 27                 TRA     s:15445
        27 003531   003532 710000 27                 TRA     s:15427

      957    15426    7                        CASE (%DEFLB) ;

      958    15427    7                          IF TEMP$->LABEL.B.GO_VECTOR_START OR

  15427 27 003532   000110 473400 0                  LDP3    TEMP$
        27 003533   300003 236100                    LDQ     3,,PR3
        27 003534   000004 316003                    CANQ    4,DU
        27 003535   003540 601000 27                 TNZ     s:15429
        27 003536   100000 316003                    CANQ    32768,DU
        27 003537   003575 601000 27                 TNZ     s:15447

      959    15428    7                              NOT TEMP$->LABEL.B.COMPILER_CREATED THEN
      960    15429    7                            GO_FLAG = 1 ;

  15429 27 003540   000001 235007                    LDA     1,DL
        27 003541   000050 755000 0                  STA     GO_FLAG
        27 003542   003575 710000 27                 TRA     s:15447

      961    15430    7                        CASE (%GO) ;

      962    15431    8                          IF TEMP$ ~= ADDR (NIL) THEN DO ;

  15431 27 003543   000110 236000 0                  LDQ     TEMP$
        27 003544   000000 116000 28                 CMPQ    0
        27 003545   003575 600000 27                 TZE     s:15447

      963    15432    8                            IF TEMP$->LABEL.ID ~= %SECTION AND

  15432 27 003546   000110 473400 0                  LDP3    TEMP$
        27 003547   300000 221100                    LDX1    0,,PR3
        27 003550   000770 101003                    CMPX1   504,DU
        27 003551   003557 600000 27                 TZE     s:15438
        27 003552   000771 101003                    CMPX1   505,DU
        27 003553   003557 600000 27                 TZE     s:15438
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:214  

      964    15433    9                                TEMP$->LABEL.ID ~= %PARA THEN DO ;

      965    15434                                     /* E.g., TEMP$->ETT.ID = %SSOP */
      966    15435    9                              GO_FLAG = 1 ;

  15435 27 003554   000001 235007                    LDA     1,DL
        27 003555   000050 755000 0                  STA     GO_FLAG

      967    15436    9                              EXIT GO_1 ;

  15436 27 003556   003575 710000 27                 TRA     s:15447

      968    15437    9                            END ;
      969    15438    9                            IF TEMP$->LABEL.B.PHASE_2 THEN DO ;

  15438 27 003557   300003 236100                    LDQ     3,,PR3
        27 003560   004000 316003                    CANQ    2048,DU
        27 003561   003575 600000 27                 TZE     s:15447

      970    15439    9                              IF TEMP$ ~= GOTO_DEST$

  15439 27 003562   000110 236000 0                  LDQ     TEMP$
        27 003563   000014 116000 0                  CMPQ    GOTO_DEST$
        27 003564   003570 600000 27                 TZE     s:15441

      971    15440    9                                THEN GO_FLAG = 1 ;

  15440 27 003565   000001 235007                    LDA     1,DL
        27 003566   000050 755000 0                  STA     GO_FLAG
        27 003567   003575 710000 27                 TRA     s:15447

      972    15441    9                                ELSE GO_FLAG = -1 ;

  15441 27 003570   000001 335007                    LCA     1,DL
        27 003571   000050 755000 0                  STA     GO_FLAG

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:215  
      973    15442    9                            END ;

      974    15443    8                          END ;

  15443 27 003572   003575 710000 27                 TRA     s:15447

      975    15444    7                        CASE (ELSE) ;

      976    15445    7                          GO_FLAG = 1 ;

  15445 27 003573   000001 235007                    LDA     1,DL
        27 003574   000050 755000 0                  STA     GO_FLAG

      977    15446    7                      END GO_1 ;

      978    15447    6                    END ;

  15447 27 003575   000050 235000 0                  LDA     GO_FLAG
        27 003576   003472 600000 27                 TZE     s:15419

      979    15448    6                    IF GO_FLAG > 0 THEN DO ; /* GO may be optimizable */

  15448 27 003577   000050 235000 0                  LDA     GO_FLAG
        27 003600   003656 604400 27                 TMOZ    s:15478

      980    15449    6                      LABEL_CHECK$ = ILL$->ILL.LOP->LABEL.PREV_ILS$ ;

  15449 27 003601   000000 470400 10                 LDP0    ILL$
        27 003602   000001 471500                    LDP1    1,,PR0
        27 003603   100010 236100                    LDQ     8,,PR1
        27 003604   000030 756000 0                  STQ     LABEL_CHECK$

      981    15450                           %NEXT_NON_SUPPORT (POINTER=LABEL_CHECK$) ;

  15460 27 003605   000030 470400 0                  LDP0    LABEL_CHECK$
        27 003606   000002 236100                    LDQ     2,,PR0
        27 003607   000030 756000 0                  STQ     LABEL_CHECK$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:216  

  15463 27 003610   000030 470400 0                  LDP0    LABEL_CHECK$
        27 003611   000003 236100                    LDQ     3,,PR0
        27 003612   000000 116000 28                 CMPQ    0
        27 003613   003605 600000 27                 TZE     s:15460
        27 003614   000003 471500                    LDP1    3,,PR0
        27 003615   100000 220100                    LDX0    0,,PR1
        27 003616   000343 100003                    CMPX0   227,DU
        27 003617   003605 600000 27                 TZE     s:15460
        27 003620   000422 100003                    CMPX0   274,DU
        27 003621   003605 600000 27                 TZE     s:15460
        27 003622   000446 100003                    CMPX0   294,DU
        27 003623   003605 600000 27                 TZE     s:15460
        27 003624   000336 100003                    CMPX0   222,DU
        27 003625   003605 600000 27                 TZE     s:15460
        27 003626   000420 100003                    CMPX0   272,DU
        27 003627   003605 600000 27                 TZE     s:15460
        27 003630   000373 100003                    CMPX0   251,DU
        27 003631   003605 600000 27                 TZE     s:15460

      982    15465
      983    15466    6                    GO_LABEL_CHECK:
      984    15467    7                      DO WHILE LABEL_CHECK$ ~= REF_DEFLB ;

  15467 27 003632   000030 236000 0     GO_LABEL_CH* LDQ     LABEL_CHECK$
        27 003633   000025 116000 0                  CMPQ    REF_DEFLB
        27 003634   003656 600000 27                 TZE     s:15478

      985    15468    7                        LABEL_CHECK$ = LABEL_CHECK$->ILS.ILL$->ILL.LBL ;

  15468 27 003635   000030 470400 0                  LDP0    LABEL_CHECK$
        27 003636   000003 471500                    LDP1    3,,PR0
        27 003637   100002 236100                    LDQ     2,,PR1
        27 003640   000030 756000 0                  STQ     LABEL_CHECK$

      986    15469    7                        IF LABEL_CHECK$->ILS.ILL$->ILL.LOP->LABEL.B.REFERENCED AND

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:217  
  15469 27 003641   000030 470400 0                  LDP0    LABEL_CHECK$
        27 003642   000003 471500                    LDP1    3,,PR0
        27 003643   100001 473500                    LDP3    1,,PR1
        27 003644   300003 234100                    SZN     3,,PR3
        27 003645   003653 605000 27                 TPL     s:15476
        27 003646   300003 236100                    LDQ     3,,PR3
        27 003647   100000 316003                    CANQ    32768,DU
        27 003650   003653 601000 27                 TNZ     s:15476

      987    15470    7                           NOT (LABEL_CHECK$->ILS.ILL$->ILL.LOP->LABEL.B.
             15470                                    COMPILER_CREATED) THEN
      988    15471    8                          DO ;

      989    15472    8                            GO_FLAG = 0 ;

  15472 27 003651   000050 450000 0                  STZ     GO_FLAG

      990    15473    8                            EXIT GO_LABEL_CHECK ;

  15473 27 003652   003656 710000 27                 TRA     s:15478

      991    15474    8                          END ;
      992    15475
      993    15476    7                      END GO_LABEL_CHECK ;

  15476 27 003653   000030 236000 0                  LDQ     LABEL_CHECK$
        27 003654   000025 116000 0                  CMPQ    REF_DEFLB
        27 003655   003635 601000 27                 TNZ     s:15468

      994    15477    6                    END ;

      995    15478    6                    IF GO_FLAG > 0 THEN DO ; /* GO is optimizable */

  15478 27 003656   000050 235000 0                  LDA     GO_FLAG
        27 003657   004661 604400 27                 TMOZ    s:15915

      996    15479        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:218  
      997    15480        /*V*
      998    15481            GO_LOOP_PRESET -- Pointers used in the conversion are initialized.
      999    15482                              These are
     1000    15483
     1001    15484                                1. GO_LABEL_LINOI$ - Ptr to linoi entry of target label.
     1002    15485                                2. GO_LABEL_ILS$   - Ptr to ILS entry for target label.
     1003    15486
     1004    15487                              The DO_1 is created for the loop and the pointers for
     1005    15488                              the DO item are assigned (previous DO item, level, and
     1006    15489                              last label).  For descriptions please see DO item in the
     1007    15490                              outer case.
     1008    15491        */
     1009    15492
     1010    15493    6                      GO_LABEL_LINOI$ = ILL$->ILL.LOP->LABEL.PREV_ILS$ ;

  15493 27 003660   000000 470400 10                 LDP0    ILL$
        27 003661   000001 471500                    LDP1    1,,PR0
        27 003662   100010 236100                    LDQ     8,,PR1
        27 003663   000026 756000 0                  STQ     GO_LABEL_LINOI$

     1011    15494                           %NEXT_ILS (POINTER=GO_LABEL_LINOI$) ;

  15496 27 003664   000026 473400 0                  LDP3    GO_LABEL_LINOI$
        27 003665   300002 236100                    LDQ     2,,PR3
        27 003666   000026 756000 0                  STQ     GO_LABEL_LINOI$

     1012    15499    6                      GO_LABEL_ILS$ = GO_LABEL_LINOI$ ;

  15499 27 003667   000027 756000 0                  STQ     GO_LABEL_ILS$

     1013    15500                           %NEXT_NON_SUPPORT (POINTER=GO_LABEL_ILS$) ;

  15510 27 003670   000027 470400 0                  LDP0    GO_LABEL_ILS$
        27 003671   000002 236100                    LDQ     2,,PR0
        27 003672   000027 756000 0                  STQ     GO_LABEL_ILS$

  15513 27 003673   000027 470400 0                  LDP0    GO_LABEL_ILS$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:219  
        27 003674   000003 236100                    LDQ     3,,PR0
        27 003675   000000 116000 28                 CMPQ    0
        27 003676   003670 600000 27                 TZE     s:15510
        27 003677   000003 471500                    LDP1    3,,PR0
        27 003700   100000 220100                    LDX0    0,,PR1
        27 003701   000343 100003                    CMPX0   227,DU
        27 003702   003670 600000 27                 TZE     s:15510
        27 003703   000422 100003                    CMPX0   274,DU
        27 003704   003670 600000 27                 TZE     s:15510
        27 003705   000446 100003                    CMPX0   294,DU
        27 003706   003670 600000 27                 TZE     s:15510
        27 003707   000336 100003                    CMPX0   222,DU
        27 003710   003670 600000 27                 TZE     s:15510
        27 003711   000420 100003                    CMPX0   272,DU
        27 003712   003670 600000 27                 TZE     s:15510
        27 003713   000373 100003                    CMPX0   251,DU
        27 003714   003670 600000 27                 TZE     s:15510

     1014    15515
     1015    15516                           %RESERVE_ILS (ITEM=%OPN, POINTER=DO_LINOI$) ;

  15536 27 003715   000002 236000 7                  LDQ     ILS_+2
        27 003716   000004 036007                    ADLQ    4,DL
        27 003717   000003 116000 7                  CMPQ    ILS_+3
        27 003720   003731 602000 27                 TNC     s:15538

  15537 27 003721   000002 236000 28                 LDQ     2
        27 003722   000130 756000 0                  STQ     OPT_FLAG+1
        27 003723   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 003724   000131 451400 0                  STP1    OPT_FLAG+2
        27 003725   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 003726   000001 631400 28                 EPPR1   1
        27 003727   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 003730   000000 011000                    NOP     0

  15538 27 003731   000002 236000 7                  LDQ     ILS_+2
        27 003732   000022 736000                    QLS     18
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:220  
        27 003733   000001 036000 7                  ADLQ    ILS_+1
        27 003734   000023 756000 0                  STQ     DO_LINOI$

  15539 27 003735   000002 235000 7                  LDA     ILS_+2
        27 003736   000004 035007                    ADLA    4,DL
        27 003737   000002 755000 7                  STA     ILS_+2

  15540 27 003740   000740 220003                    LDX0    480,DU
        27 003741   000023 470400 0                  LDP0    DO_LINOI$
        27 003742   000000 740100                    STX0    0,,PR0

  15541 27 003743   000000 236000 28                 LDQ     0
        27 003744   000002 756100                    STQ     2,,PR0

     1016    15545                           %RESERVE_ILL (ITEM=%LINOI, POINTER=DO_LINOI$->ILS.ILL$) ;

  15547 27 003745   000145 235000 xsym               LDA     ILL_STEP+101
        27 003746   000000 755000 1                  STA     ITERATION

  15548 27 003747   000002 236000 11                 LDQ     ILL_+2
        27 003750   000000 036000 1                  ADLQ    ITERATION
        27 003751   000003 116000 11                 CMPQ    ILL_+3
        27 003752   003763 604000 27                 TMI     s:15550

  15549 27 003753   000003 236000 28                 LDQ     3
        27 003754   000130 756000 0                  STQ     OPT_FLAG+1
        27 003755   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 003756   000131 451400 0                  STP1    OPT_FLAG+2
        27 003757   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 003760   000001 631400 28                 EPPR1   1
        27 003761   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 003762   000000 011000                    NOP     0

  15550 27 003763   000002 236000 11                 LDQ     ILL_+2
        27 003764   000022 736000                    QLS     18
        27 003765   000001 036000 11                 ADLQ    ILL_+1
        27 003766   000023 470400 0                  LDP0    DO_LINOI$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:221  
        27 003767   000003 756100                    STQ     3,,PR0

  15551 27 003770   000002 236000 11                 LDQ     ILL_+2
        27 003771   000000 036000 1                  ADLQ    ITERATION
        27 003772   000002 756000 11                 STQ     ILL_+2

  15552 27 003773   000003 471500                    LDP1    3,,PR0
        27 003774   000373 220003                    LDX0    251,DU
        27 003775   100000 740100                    STX0    0,,PR1

     1017    15555    6                      DO_LINOI$->ILS.ILL$->LINOI.LINE_NO =

  15555 27 003776   000003 471500                    LDP1    3,,PR0
        27 003777   000026 473400 0                  LDP3    GO_LABEL_LINOI$
        27 004000   300003 474500                    LDP4    3,,PR3
        27 004001   400001 721100                    LXL1    1,,PR4
        27 004002   100001 441100                    SXL1    1,,PR1

     1018    15556    6                          GO_LABEL_LINOI$->ILS.ILL$->LINOI.LINE_NO ;
     1019    15557    6                      DO_LINOI$->ILS.ILL$->LINOI.PREV_LINE =

  15557 27 004003   000003 471500                    LDP1    3,,PR0
        27 004004   300003 474500                    LDP4    3,,PR3
        27 004005   400001 721100                    LXL1    1,,PR4
        27 004006   100000 441100                    SXL1    0,,PR1

     1020    15558    6                          GO_LABEL_LINOI$->ILS.ILL$->LINOI.LINE_NO ;
     1021    15559    6                      DO_LINOI$->ILS.ILL$->LINOI.COLUMN_NO =

  15559 27 004007   000003 471500                    LDP1    3,,PR0
        27 004010   300003 474500                    LDP4    3,,PR3
        27 004011   400001 221100                    LDX1    1,,PR4
        27 004012   100001 741100                    STX1    1,,PR1

     1022    15560    6                          GO_LABEL_LINOI$->ILS.ILL$->LINOI.COLUMN_NO ;
     1023    15561    6                      DO_LINOI$->ILS.ILL$->LINOI.PREV_COL =

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:222  
  15561 27 004013   000003 471500                    LDP1    3,,PR0
        27 004014   300003 474500                    LDP4    3,,PR3
        27 004015   400001 221100                    LDX1    1,,PR4
        27 004016   100002 441100                    SXL1    2,,PR1

     1024    15562    6                          GO_LABEL_LINOI$->ILS.ILL$->LINOI.COLUMN_NO ;
     1025    15563                           %RESERVE_ILS (ITEM=%OPN, POINTER=DO_ILS$) ;

  15583 27 004017   000002 236000 7                  LDQ     ILS_+2
        27 004020   000004 036007                    ADLQ    4,DL
        27 004021   000003 116000 7                  CMPQ    ILS_+3
        27 004022   004033 602000 27                 TNC     s:15585

  15584 27 004023   000002 236000 28                 LDQ     2
        27 004024   000130 756000 0                  STQ     OPT_FLAG+1
        27 004025   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 004026   000131 451400 0                  STP1    OPT_FLAG+2
        27 004027   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 004030   000001 631400 28                 EPPR1   1
        27 004031   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 004032   000000 011000                    NOP     0

  15585 27 004033   000002 236000 7                  LDQ     ILS_+2
        27 004034   000022 736000                    QLS     18
        27 004035   000001 036000 7                  ADLQ    ILS_+1
        27 004036   000022 756000 0                  STQ     DO_ILS$

  15586 27 004037   000002 235000 7                  LDA     ILS_+2
        27 004040   000004 035007                    ADLA    4,DL
        27 004041   000002 755000 7                  STA     ILS_+2

  15587 27 004042   000740 220003                    LDX0    480,DU
        27 004043   000022 470400 0                  LDP0    DO_ILS$
        27 004044   000000 740100                    STX0    0,,PR0

  15588 27 004045   000000 236000 28                 LDQ     0
        27 004046   000002 756100                    STQ     2,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:223  

     1026    15592                           %RESERVE_ILL (ITEM=%DO1, POINTER=DO_ILS$->ILS.ILL$) ;

  15594 27 004047   000147 235000 xsym               LDA     ILL_STEP+103
        27 004050   000000 755000 1                  STA     ITERATION

  15595 27 004051   000002 236000 11                 LDQ     ILL_+2
        27 004052   000000 036000 1                  ADLQ    ITERATION
        27 004053   000003 116000 11                 CMPQ    ILL_+3
        27 004054   004065 604000 27                 TMI     s:15597

  15596 27 004055   000003 236000 28                 LDQ     3
        27 004056   000130 756000 0                  STQ     OPT_FLAG+1
        27 004057   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 004060   000131 451400 0                  STP1    OPT_FLAG+2
        27 004061   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 004062   000001 631400 28                 EPPR1   1
        27 004063   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 004064   000000 011000                    NOP     0

  15597 27 004065   000002 236000 11                 LDQ     ILL_+2
        27 004066   000022 736000                    QLS     18
        27 004067   000001 036000 11                 ADLQ    ILL_+1
        27 004070   000022 470400 0                  LDP0    DO_ILS$
        27 004071   000003 756100                    STQ     3,,PR0

  15598 27 004072   000002 236000 11                 LDQ     ILL_+2
        27 004073   000000 036000 1                  ADLQ    ITERATION
        27 004074   000002 756000 11                 STQ     ILL_+2

  15599 27 004075   000003 471500                    LDP1    3,,PR0
        27 004076   000375 220003                    LDX0    253,DU
        27 004077   100000 740100                    STX0    0,,PR1

     1027    15602    6                      DO_ILS$->ILS.ILL$->DO_N.ITO = FATHER_DO ;

  15602 27 004100   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:224  
        27 004101   000024 236000 0                  LDQ     FATHER_DO
        27 004102   100004 756100                    STQ     4,,PR1

     1028    15603    6                      DO_ILS$->ILS.ILL$->DO_N.LEVEL = DO_LEVEL ;

  15603 27 004103   000003 471500                    LDP1    3,,PR0
        27 004104   000051 721000 0                  LXL1    DO_LEVEL
        27 004105   100005 741100                    STX1    5,,PR1

     1029    15604        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:225  
     1030    15605        /*V*
     1031    15606            SET_UP_GO_LOOP_FLOW --
     1032    15607               The GO loop given in the above example may be converted two different
     1033    15608               ways into a loop.
     1034    15609
     1035    15610               If the target label "A" is the only referenced once then the DO item
     1036    15611               is inserted before the label and will look like this.
     1037    15612
     1038    15613                   DO_1.
     1039    15614                     A.
     1040    15615                       Add 1 to variable.
     1041    15616                       If variable < 5 then go to A.
     1042    15617                   DOEND.
     1043    15618
     1044    15619               When the target label "A" is referenced more than once then the
     1045    15620               conversion is a little more involved.  The conversion requires linking
     1046    15621               the DO item after the target label and creating a label to follow the DO
     1047    15622               item.  A check is also made of the GO statements in between, if any, to
     1048    15623               change any references from "A" to the created label.
     1049    15624
     1050    15625                   A.
     1051    15626                     DO_1.
     1052    15627                       CREATED_LABEL.
     1053    15628                         Add 1 to variable.
     1054    15629                         If variable < 5 then go to CREATED_LABEL.
     1055    15630                     DOEND.
     1056    15631
     1057    15632               The DOEND item is created and inserted after the last GO item for both
     1058    15633               types of loops.
     1059    15634            */
     1060    15635        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:226  
     1061    15636    6                      IF GO_LABEL_ILS$->ILS.ILL$->ILL.LOP->LABEL.B.ONE_REF THEN

  15636 27 004106   000027 471400 0                  LDP1    GO_LABEL_ILS$
        27 004107   100003 473500                    LDP3    3,,PR1
        27 004110   300001 474500                    LDP4    1,,PR3
        27 004111   400003 236100                    LDQ     3,,PR4
        27 004112   010000 316003                    CANQ    4096,DU
        27 004113   004152 600000 27                 TZE     s:15652

     1062    15637    7                        DO ;

     1063    15638    7                          DO_ILS$->ILS.ILL$->DO_N.XLAB = ADDR (NIL) ;

  15638 27 004114   000003 475500                    LDP5    3,,PR0
        27 004115   000000 236000 28                 LDQ     0
        27 004116   500006 756100                    STQ     6,,PR5

     1064    15639    7                          TEMP$ = COMCOM.H_LBL ;

  15639 27 004117   000321 236000 xsym               LDQ     COMCOM+209
        27 004120   000110 756000 0                  STQ     TEMP$

     1065    15640    8                          DO WHILE TEMP$ ~= GO_LABEL_ILS$ ;

  15640 27 004121   000027 116000 0                  CMPQ    GO_LABEL_ILS$
        27 004122   004135 600000 27                 TZE     s:15644

     1066    15641    8                            DO_ILS$->ILS.ILL$->DO_N.XLAB = TEMP$ ;

  15641 27 004123   000022 470400 0                  LDP0    DO_ILS$
        27 004124   000003 471500                    LDP1    3,,PR0
        27 004125   000110 236000 0                  LDQ     TEMP$
        27 004126   100006 756100                    STQ     6,,PR1

     1067    15642    8                            TEMP$ = TEMP$->ILS.ILL$->ILL.LBL ;

  15642 27 004127   000110 471400 0                  LDP1    TEMP$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:227  
        27 004130   100003 473500                    LDP3    3,,PR1
        27 004131   300002 236100                    LDQ     2,,PR3
        27 004132   000110 756000 0                  STQ     TEMP$

     1068    15643    8                          END ;

  15643 27 004133   000027 116000 0                  CMPQ    GO_LABEL_ILS$
        27 004134   004123 601000 27                 TNZ     s:15641

     1069    15644    7                          GO_LABEL_ILS$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$

  15644 27 004135   000027 471400 0                  LDP1    GO_LABEL_ILS$
        27 004136   100003 473500                    LDP3    3,,PR1
        27 004137   300001 474500                    LDP4    1,,PR3
        27 004140   000022 236000 0                  LDQ     DO_ILS$
        27 004141   400010 756100                    STQ     8,,PR4

     1070    15645    7                              = DO_ILS$ ;
     1071    15646    7                          GO_LABEL_LINOI$->ILS.NEXT = DO_ILS$ ;

  15646 27 004142   000026 473400 0                  LDP3    GO_LABEL_LINOI$
        27 004143   300002 756100                    STQ     2,,PR3

     1072    15647    7                          DO_ILS$->ILS.NEXT = DO_LINOI$ ;

  15647 27 004144   000023 236000 0                  LDQ     DO_LINOI$
        27 004145   000002 756100                    STQ     2,,PR0

     1073    15648    7                          DO_LINOI$->ILS.NEXT = GO_LABEL_ILS$ ;

  15648 27 004146   000027 236000 0                  LDQ     GO_LABEL_ILS$
        27 004147   000023 474400 0                  LDP4    DO_LINOI$
        27 004150   400002 756100                    STQ     2,,PR4

     1074    15649    7                        END ;

  15649 27 004151   004412 710000 27                 TRA     s:15791
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:228  

     1075    15650    6                      ELSE  /* Multiple references */
     1076    15651    7                        DO ;

     1077    15652    7                          DO_ILS$->ILS.ILL$->DO_N.XLAB = GO_LABEL_ILS$ ;

  15652 27 004152   000003 475500                    LDP5    3,,PR0
        27 004153   000027 236000 0                  LDQ     GO_LABEL_ILS$
        27 004154   500006 756100                    STQ     6,,PR5

     1078    15653
     1079    15654    7                          CALL Z8AT$CREATE_TEMPORARY(%PARA, CREATED_LABEL$) ;

  15654 27 004155   000021 630400 28                 EPPR0   17
        27 004156   000005 631400 28                 EPPR1   5
        27 004157   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        27 004160   000000 011000                    NOP     0

     1080    15655    7                          CREATED_LABEL$ -> LABEL.B.ONE_REF = TRUE ;

  15655 27 004161   000030 470400 0                  LDP0    LABEL_CHECK$
        27 004162   010000 236003                    LDQ     4096,DU
        27 004163   000003 256100                    ORSQ    3,,PR0

     1081    15656    7                          CREATED_LABEL$ -> LABEL.B.FALL_THRU = TRUE ;

  15656 27 004164   000030 470400 0                  LDP0    LABEL_CHECK$
        27 004165   002000 236003                    LDQ     1024,DU
        27 004166   000003 256100                    ORSQ    3,,PR0

     1082    15657    7                          CREATED_LABEL$ -> LABEL.PROC$ = CURRENT_PROC$ ;

  15657 27 004167   000111 236000 0                  LDQ     CURRENT_PROC$
        27 004170   000030 470400 0                  LDP0    LABEL_CHECK$
        27 004171   000011 756100                    STQ     9,,PR0

     1083    15658
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:229  
     1084    15659                               %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP$) ;

  15679 27 004172   000002 236000 7                  LDQ     ILS_+2
        27 004173   000004 036007                    ADLQ    4,DL
        27 004174   000003 116000 7                  CMPQ    ILS_+3
        27 004175   004206 602000 27                 TNC     s:15681

  15680 27 004176   000002 236000 28                 LDQ     2
        27 004177   000130 756000 0                  STQ     OPT_FLAG+1
        27 004200   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 004201   000131 450400 0                  STP0    OPT_FLAG+2
        27 004202   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 004203   000001 631400 28                 EPPR1   1
        27 004204   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 004205   000000 011000                    NOP     0

  15681 27 004206   000002 236000 7                  LDQ     ILS_+2
        27 004207   000022 736000                    QLS     18
        27 004210   000001 036000 7                  ADLQ    ILS_+1
        27 004211   000110 756000 0                  STQ     TEMP$

  15682 27 004212   000002 235000 7                  LDA     ILS_+2
        27 004213   000004 035007                    ADLA    4,DL
        27 004214   000002 755000 7                  STA     ILS_+2

  15683 27 004215   000740 220003                    LDX0    480,DU
        27 004216   000110 470400 0                  LDP0    TEMP$
        27 004217   000000 740100                    STX0    0,,PR0

  15684 27 004220   000000 236000 28                 LDQ     0
        27 004221   000002 756100                    STQ     2,,PR0

     1085    15688    7                          TEMP$->ILS.ILL$ = DO_LINOI$->ILS.ILL$ ;

  15688 27 004222   000023 471400 0                  LDP1    DO_LINOI$
        27 004223   100003 236100                    LDQ     3,,PR1
        27 004224   000003 756100                    STQ     3,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:230  

     1086    15689                               %RESERVE_ILS(ITEM=%OPN, POINTER=TEMP$->ILS.NEXT) ;

  15709 27 004225   000002 236000 7                  LDQ     ILS_+2
        27 004226   000004 036007                    ADLQ    4,DL
        27 004227   000003 116000 7                  CMPQ    ILS_+3
        27 004230   004241 602000 27                 TNC     s:15711

  15710 27 004231   000002 236000 28                 LDQ     2
        27 004232   000130 756000 0                  STQ     OPT_FLAG+1
        27 004233   000130 633400 0                  EPPR3   OPT_FLAG+1
        27 004234   000131 453400 0                  STP3    OPT_FLAG+2
        27 004235   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 004236   000001 631400 28                 EPPR1   1
        27 004237   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 004240   000000 011000                    NOP     0

  15711 27 004241   000002 236000 7                  LDQ     ILS_+2
        27 004242   000022 736000                    QLS     18
        27 004243   000001 036000 7                  ADLQ    ILS_+1
        27 004244   000110 470400 0                  LDP0    TEMP$
        27 004245   000002 756100                    STQ     2,,PR0

  15712 27 004246   000002 235000 7                  LDA     ILS_+2
        27 004247   000004 035007                    ADLA    4,DL
        27 004250   000002 755000 7                  STA     ILS_+2

  15713 27 004251   000002 471500                    LDP1    2,,PR0
        27 004252   000740 220003                    LDX0    480,DU
        27 004253   100000 740100                    STX0    0,,PR1

  15714 27 004254   000002 471500                    LDP1    2,,PR0
        27 004255   000000 236000 28                 LDQ     0
        27 004256   100002 756100                    STQ     2,,PR1

     1087    15718                               %RESERVE_ILL(ITEM=%DEFLB, POINTER=TEMP$->ILS.NEXT->ILS.ILL$)
             15718                                   ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:231  

  15720 27 004257   000120 235000 xsym               LDA     ILL_STEP+80
        27 004260   000000 755000 1                  STA     ITERATION

  15721 27 004261   000002 236000 11                 LDQ     ILL_+2
        27 004262   000000 036000 1                  ADLQ    ITERATION
        27 004263   000003 116000 11                 CMPQ    ILL_+3
        27 004264   004275 604000 27                 TMI     s:15723

  15722 27 004265   000003 236000 28                 LDQ     3
        27 004266   000130 756000 0                  STQ     OPT_FLAG+1
        27 004267   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 004270   000131 451400 0                  STP1    OPT_FLAG+2
        27 004271   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 004272   000001 631400 28                 EPPR1   1
        27 004273   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 004274   000000 011000                    NOP     0

  15723 27 004275   000110 470400 0                  LDP0    TEMP$
        27 004276   000002 471500                    LDP1    2,,PR0
        27 004277   000002 236000 11                 LDQ     ILL_+2
        27 004300   000022 736000                    QLS     18
        27 004301   000001 036000 11                 ADLQ    ILL_+1
        27 004302   100003 756100                    STQ     3,,PR1

  15724 27 004303   000002 236000 11                 LDQ     ILL_+2
        27 004304   000000 036000 1                  ADLQ    ITERATION
        27 004305   000002 756000 11                 STQ     ILL_+2

  15725 27 004306   000002 471500                    LDP1    2,,PR0
        27 004307   100003 473500                    LDP3    3,,PR1
        27 004310   000346 220003                    LDX0    230,DU
        27 004311   300000 740100                    STX0    0,,PR3

     1088    15728    7                          TEMP$->ILS.NEXT->ILS.ILL$->ILL.LOP = CREATED_LABEL$ ;

  15728 27 004312   000002 471500                    LDP1    2,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:232  
        27 004313   100003 473500                    LDP3    3,,PR1
        27 004314   000030 236000 0                  LDQ     LABEL_CHECK$
        27 004315   300001 756100                    STQ     1,,PR3

     1089    15729    7                          TEMP$->ILS.NEXT->ILS.ILL$->ILL.LBL =

  15729 27 004316   000002 471500                    LDP1    2,,PR0
        27 004317   100003 473500                    LDP3    3,,PR1
        27 004320   000027 474400 0                  LDP4    GO_LABEL_ILS$
        27 004321   400003 475500                    LDP5    3,,PR4
        27 004322   500002 236100                    LDQ     2,,PR5
        27 004323   300002 756100                    STQ     2,,PR3

     1090    15730    7                              GO_LABEL_ILS$->ILS.ILL$->ILL.LBL ;
     1091    15731    7                          GO_LABEL_ILS$->ILS.ILL$->ILL.LBL = TEMP$->ILS.NEXT ;

  15731 27 004324   400003 471500                    LDP1    3,,PR4
        27 004325   000002 236100                    LDQ     2,,PR0
        27 004326   100002 756100                    STQ     2,,PR1

     1092    15732    7                          TEMP$->ILS.NEXT->ILS.NEXT = GO_LABEL_ILS$->ILS.NEXT ;

  15732 27 004327   000002 471500                    LDP1    2,,PR0
        27 004330   400002 236100                    LDQ     2,,PR4
        27 004331   100002 756100                    STQ     2,,PR1

     1093    15733    7                          GO_LABEL_ILS$->ILS.NEXT = DO_LINOI$ ;

  15733 27 004332   000023 236000 0                  LDQ     DO_LINOI$
        27 004333   400002 756100                    STQ     2,,PR4

     1094    15734    7                          DO_LINOI$->ILS.NEXT = DO_ILS$ ;

  15734 27 004334   000022 236000 0                  LDQ     DO_ILS$
        27 004335   000023 471400 0                  LDP1    DO_LINOI$
        27 004336   100002 756100                    STQ     2,,PR1

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:233  
     1095    15735    7                          DO_ILS$->ILS.NEXT = TEMP$ ;

  15735 27 004337   000110 236000 0                  LDQ     TEMP$
        27 004340   000022 473400 0                  LDP3    DO_ILS$
        27 004341   300002 756100                    STQ     2,,PR3

     1096    15736    8                          IF REF_DEFLB = GO_LABEL_ILS$ THEN DO ;

  15736 27 004342   000025 236000 0                  LDQ     REF_DEFLB
        27 004343   000027 116000 0                  CMPQ    GO_LABEL_ILS$
        27 004344   004356 601000 27                 TNZ     s:15750

     1097    15737    8                            REF_DEFLB = DO_ILS$ ;

  15737 27 004345   000022 236000 0                  LDQ     DO_ILS$
        27 004346   000025 756000 0                  STQ     REF_DEFLB

     1098    15738                                 %NEXT_ILS (POINTER=REF_DEFLB) ; /* LINOI */

  15740 27 004347   000025 475400 0                  LDP5    REF_DEFLB
        27 004350   500002 236100                    LDQ     2,,PR5
        27 004351   000025 756000 0                  STQ     REF_DEFLB

     1099    15743                                 %NEXT_ILS (POINTER=REF_DEFLB) ; /* DEFLB */

  15745 27 004352   000025 475400 0                  LDP5    REF_DEFLB
        27 004353   500002 236100                    LDQ     2,,PR5
        27 004354   000025 756000 0                  STQ     REF_DEFLB

     1100    15748    8                            O2COM.LAST_LBL$ = REF_DEFLB ;

  15748 27 004355   000002 756000 25                 STQ     O2COM+2

     1101    15749    8                          END ;

     1102    15750    7                          CREATED_LABEL$->LABEL.PREV_ILS$ = DO_ILS$ ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:234  
  15750 27 004356   000022 236000 0                  LDQ     DO_ILS$
        27 004357   000030 475400 0                  LDP5    LABEL_CHECK$
        27 004360   500010 756100                    STQ     8,,PR5

     1103    15751
     1104    15752    7                          TEMP$ = DO_ILS$ ;

  15752 27 004361   000110 756000 0                  STQ     TEMP$

     1105    15753    8                          DO UNTIL TEMP$ = ILS$ ;

     1106    15754                                 %NEXT_ILS (POINTER=TEMP$) ;

  15756 27 004362   000110 470400 0                  LDP0    TEMP$
        27 004363   000002 236100                    LDQ     2,,PR0
        27 004364   000110 756000 0                  STQ     TEMP$

     1107    15759    8                            IF TEMP$->ILS.ILL$->ILL.LOP =

  15759 27 004365   000110 470400 0                  LDP0    TEMP$
        27 004366   000003 471500                    LDP1    3,,PR0
        27 004367   000027 473400 0                  LDP3    GO_LABEL_ILS$
        27 004370   300003 474500                    LDP4    3,,PR3
        27 004371   100001 236100                    LDQ     1,,PR1
        27 004372   400001 116100                    CMPQ    1,,PR4
        27 004373   004407 601000 27                 TNZ     s:15767

     1108    15760    9                                GO_LABEL_ILS$->ILS.ILL$->ILL.LOP THEN DO ;

     1109    15761    9                              IF CREATED_LABEL$->LABEL.B.REFERENCED

  15761 27 004374   000030 475400 0                  LDP5    LABEL_CHECK$
        27 004375   500003 234100                    SZN     3,,PR5
        27 004376   004401 605000 27                 TPL     s:15763

     1110    15762    9                                THEN CREATED_LABEL$->LABEL.B.ONE_REF = FALSE ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:235  
  15762 27 004377   000004 236000 28                 LDQ     4
        27 004400   500003 356100                    ANSQ    3,,PR5

     1111    15763    9                              CREATED_LABEL$ -> LABEL.B.REFERENCED = TRUE ;

  15763 27 004401   000030 471400 0                  LDP1    LABEL_CHECK$
        27 004402   400000 236003                    LDQ     -131072,DU
        27 004403   100003 256100                    ORSQ    3,,PR1

     1112    15764    9                              TEMP$->ILS.ILL$->ILL.LOP = CREATED_LABEL$ ;

  15764 27 004404   000003 471500                    LDP1    3,,PR0
        27 004405   000030 236000 0                  LDQ     LABEL_CHECK$
        27 004406   100001 756100                    STQ     1,,PR1

     1113    15765    9                            END ;

     1114    15766
     1115    15767    8                          END ;

  15767 27 004407   000110 236000 0                  LDQ     TEMP$
        27 004410   000000 116000 6                  CMPQ    ILS$
        27 004411   004362 601000 27                 TNZ     s:15756

     1116    15768
     1117    15769    7                        END ;

     1118    15770
     1119    15771                           %RESERVE_ILS(ITEM=%OPN, POINTER=DOEND_ILS$) ;

  15791 27 004412   000002 236000 7                  LDQ     ILS_+2
        27 004413   000004 036007                    ADLQ    4,DL
        27 004414   000003 116000 7                  CMPQ    ILS_+3
        27 004415   004426 602000 27                 TNC     s:15793

  15792 27 004416   000002 236000 28                 LDQ     2
        27 004417   000130 756000 0                  STQ     OPT_FLAG+1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:236  
        27 004420   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 004421   000131 450400 0                  STP0    OPT_FLAG+2
        27 004422   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 004423   000001 631400 28                 EPPR1   1
        27 004424   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 004425   000000 011000                    NOP     0

  15793 27 004426   000002 236000 7                  LDQ     ILS_+2
        27 004427   000022 736000                    QLS     18
        27 004430   000001 036000 7                  ADLQ    ILS_+1
        27 004431   000013 756000 0                  STQ     DOEND_ILS$

  15794 27 004432   000002 235000 7                  LDA     ILS_+2
        27 004433   000004 035007                    ADLA    4,DL
        27 004434   000002 755000 7                  STA     ILS_+2

  15795 27 004435   000740 220003                    LDX0    480,DU
        27 004436   000013 470400 0                  LDP0    DOEND_ILS$
        27 004437   000000 740100                    STX0    0,,PR0

  15796 27 004440   000000 236000 28                 LDQ     0
        27 004441   000002 756100                    STQ     2,,PR0

     1120    15800                           %RESERVE_ILL(ITEM=%DOEND, POINTER=DOEND_ILS$->ILS.ILL$) ;

  15802 27 004442   000155 235000 xsym               LDA     ILL_STEP+109
        27 004443   000000 755000 1                  STA     ITERATION

  15803 27 004444   000002 236000 11                 LDQ     ILL_+2
        27 004445   000000 036000 1                  ADLQ    ITERATION
        27 004446   000003 116000 11                 CMPQ    ILL_+3
        27 004447   004460 604000 27                 TMI     s:15805

  15804 27 004450   000003 236000 28                 LDQ     3
        27 004451   000130 756000 0                  STQ     OPT_FLAG+1
        27 004452   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 004453   000131 451400 0                  STP1    OPT_FLAG+2
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:237  
        27 004454   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 004455   000001 631400 28                 EPPR1   1
        27 004456   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 004457   000000 011000                    NOP     0

  15805 27 004460   000002 236000 11                 LDQ     ILL_+2
        27 004461   000022 736000                    QLS     18
        27 004462   000001 036000 11                 ADLQ    ILL_+1
        27 004463   000013 470400 0                  LDP0    DOEND_ILS$
        27 004464   000003 756100                    STQ     3,,PR0

  15806 27 004465   000002 236000 11                 LDQ     ILL_+2
        27 004466   000000 036000 1                  ADLQ    ITERATION
        27 004467   000002 756000 11                 STQ     ILL_+2

  15807 27 004470   000003 471500                    LDP1    3,,PR0
        27 004471   000403 220003                    LDX0    259,DU
        27 004472   100000 740100                    STX0    0,,PR1

     1121    15810    6                      DOEND_ILS$->ILS.ILL$->DO_N.ITB = DO_ILS$ ;

  15810 27 004473   000003 471500                    LDP1    3,,PR0
        27 004474   000022 236000 0                  LDQ     DO_ILS$
        27 004475   100001 756100                    STQ     1,,PR1

     1122    15811    6                      DO_ILS$->ILS.ILL$->DO_N.ITE = DOEND_ILS$ ;

  15811 27 004476   000022 471400 0                  LDP1    DO_ILS$
        27 004477   100003 473500                    LDP3    3,,PR1
        27 004500   000013 236000 0                  LDQ     DOEND_ILS$
        27 004501   300001 756100                    STQ     1,,PR3

     1123    15812    6                      DOEND_ILS$->ILS.NEXT = NEXT_ILS$ ;

  15812 27 004502   000002 236000 0                  LDQ     NEXT_ILS$
        27 004503   000002 756100                    STQ     2,,PR0

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:238  
     1124    15813    6                      ILS$->ILS.NEXT = DOEND_ILS$ ;

  15813 27 004504   000013 236000 0                  LDQ     DOEND_ILS$
        27 004505   000000 473400 6                  LDP3    ILS$
        27 004506   300002 756100                    STQ     2,,PR3

     1125    15814    6                      TEMP$ = DOEND_ILS$ ;

  15814 27 004507   000110 756000 0                  STQ     TEMP$

     1126    15815                           %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  15825 27 004510   000110 470400 0                  LDP0    TEMP$
        27 004511   000002 236100                    LDQ     2,,PR0
        27 004512   000110 756000 0                  STQ     TEMP$

  15828 27 004513   000110 470400 0                  LDP0    TEMP$
        27 004514   000003 236100                    LDQ     3,,PR0
        27 004515   000000 116000 28                 CMPQ    0
        27 004516   004510 600000 27                 TZE     s:15825
        27 004517   000003 471500                    LDP1    3,,PR0
        27 004520   100000 220100                    LDX0    0,,PR1
        27 004521   000343 100003                    CMPX0   227,DU
        27 004522   004510 600000 27                 TZE     s:15825
        27 004523   000422 100003                    CMPX0   274,DU
        27 004524   004510 600000 27                 TZE     s:15825
        27 004525   000446 100003                    CMPX0   294,DU
        27 004526   004510 600000 27                 TZE     s:15825
        27 004527   000336 100003                    CMPX0   222,DU
        27 004530   004510 600000 27                 TZE     s:15825
        27 004531   000420 100003                    CMPX0   272,DU
        27 004532   004510 600000 27                 TZE     s:15825
        27 004533   000373 100003                    CMPX0   251,DU
        27 004534   004510 600000 27                 TZE     s:15825

     1127    15830    6                      IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:239  
  15830 27 004535   000346 100003                    CMPX0   230,DU
        27 004536   004542 601000 27                 TNZ     s:15846

     1128    15831    6                        THEN TEMP$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$

  15831 27 004537   100001 473500                    LDP3    1,,PR1
        27 004540   000013 236000 0                  LDQ     DOEND_ILS$
        27 004541   300010 756100                    STQ     8,,PR3

     1129    15832    6                            = DOEND_ILS$ ;
     1130    15833        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:240  
     1131    15834        /*V*
     1132    15835            SEARCH_FOR_INTERNAL_DO -- A search is made starting from the created
     1133    15836                                      DO item to find any internal DOs.  If none are
     1134    15837                                      found then the DO item is inserted at the end
     1135    15838                                      of the DO LINK.
     1136    15839
     1137    15840                                      If one is found then the created DO is inserted
     1138    15841                                      into the linked list right before the first
     1139    15842                                      internal DO.  A search is then made thru the
     1140    15843                                      internal DOs and DOENDs to update them.
     1141    15844        */
     1142    15845
     1143    15846    6                      SEARCH_DO$ = DO_ILS$ ;

  15846 27 004542   000022 236000 0                  LDQ     DO_ILS$
        27 004543   000017 756000 0                  STQ     SEARCH_DO$

     1144    15847
     1145    15848    7                      DO UNTIL SEARCH_DO$->ILS.ILL$->ILL.ID = %DO1 OR

     1146    15849    7                               SEARCH_DO$->ILS.ILL$->ILL.ID = %DO2 OR
     1147    15850    7                               SEARCH_DO$->ILS.ILL$->ILL.ID = %DO3 OR
     1148    15851    7                               SEARCH_DO$->ILS.ILL$->ILL.ID = %DO4 OR
     1149    15852    7                               SEARCH_DO$->ILS.ILL$->ILL.ID = %DO5 OR
     1150    15853                                 /* SEARCH_DO$->ILS.ILL$->ILL.ID = %DO6 OR */
     1151    15854    7                               SEARCH_DO$ = DOEND_ILS$ ;
     1152    15855                             %NEXT_ILS (POINTER=SEARCH_DO$) ;

  15857 27 004544   000017 470400 0                  LDP0    SEARCH_DO$
        27 004545   000002 236100                    LDQ     2,,PR0
        27 004546   000017 756000 0                  STQ     SEARCH_DO$

     1153    15860    7                      END ;

  15860 27 004547   000017 470400 0                  LDP0    SEARCH_DO$
        27 004550   000003 471500                    LDP1    3,,PR0
        27 004551   100000 220100                    LDX0    0,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:241  
        27 004552   000375 100003                    CMPX0   253,DU
        27 004553   004566 600000 27                 TZE     s:15862
        27 004554   000376 100003                    CMPX0   254,DU
        27 004555   004566 600000 27                 TZE     s:15862
        27 004556   000377 100003                    CMPX0   255,DU
        27 004557   004566 600000 27                 TZE     s:15862
        27 004560   000400 100003                    CMPX0   256,DU
        27 004561   004566 600000 27                 TZE     s:15862
        27 004562   000401 100003                    CMPX0   257,DU
        27 004563   004566 600000 27                 TZE     s:15862
        27 004564   000013 116000 0                  CMPQ    DOEND_ILS$
        27 004565   004544 601000 27                 TNZ     s:15857

     1154    15861
     1155    15862    6                      IF SEARCH_DO$ = DOEND_ILS$ THEN

  15862 27 004566   000013 116000 0                  CMPQ    DOEND_ILS$
        27 004567   004577 601000 27                 TNZ     s:15869

     1156    15863    7                        DO ;

     1157    15864    7                          DO_ILS$->ILS.ILL$->DO_N.ITP = COMCOM.H_DO ;

  15864 27 004570   000022 473400 0                  LDP3    DO_ILS$
        27 004571   300003 474500                    LDP4    3,,PR3
        27 004572   000332 236000 xsym               LDQ     COMCOM+218
        27 004573   400003 756100                    STQ     3,,PR4

     1158    15865    7                          COMCOM.H_DO = DO_ILS$ ;

  15865 27 004574   000022 236000 0                  LDQ     DO_ILS$
        27 004575   000332 756000 xsym               STQ     COMCOM+218

     1159    15866    7                        END ;

  15866 27 004576   004652 710000 27                 TRA     s:15911

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:242  
     1160    15867    6                      ELSE
     1161    15868    7                        DO ;

     1162    15869    7                          DO_ILS$->ILS.ILL$->DO_N.ITP = SEARCH_DO$->ILS.ILL$->DO_N.ITP
             15869                                   ;

  15869 27 004577   000022 473400 0                  LDP3    DO_ILS$
        27 004600   300003 474500                    LDP4    3,,PR3
        27 004601   100003 236100                    LDQ     3,,PR1
        27 004602   400003 756100                    STQ     3,,PR4

     1163    15870    7                          SEARCH_DO$->ILS.ILL$->DO_N.ITP = DO_ILS$ ;

  15870 27 004603   000003 471500                    LDP1    3,,PR0
        27 004604   000022 236000 0                  LDQ     DO_ILS$
        27 004605   100003 756100                    STQ     3,,PR1

     1164    15871    7                          IF SEARCH_DO$->ILS.ILL$->DO_N.XLAB = GO_LABEL_ILS$ THEN

  15871 27 004606   000003 471500                    LDP1    3,,PR0
        27 004607   100006 236100                    LDQ     6,,PR1
        27 004610   000027 116000 0                  CMPQ    GO_LABEL_ILS$
        27 004611   004620 601000 27                 TNZ     s:15891

     1165    15872    8                            DO ;

     1166    15873    8                              SEARCH_DO$->ILS.ILL$->DO_N.XLAB = DO_ILS$ ;

  15873 27 004612   000022 236000 0                  LDQ     DO_ILS$
        27 004613   100006 756100                    STQ     6,,PR1

     1167    15874                                   %NEXT_ILS (POINTER=SEARCH_DO$->ILS.ILL$->DO_N.XLAB) ;

  15876 27 004614   000003 471500                    LDP1    3,,PR0
        27 004615   100006 474500                    LDP4    6,,PR1
        27 004616   400002 236100                    LDQ     2,,PR4
        27 004617   100006 756100                    STQ     6,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:243  

     1168    15879    8                            END ;

     1169    15880
     1170    15881        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:244  
     1171    15882        /*V*
     1172    15883            SEARCH_INTERNAL_DOS -- The search continues thru the internal DO
     1173    15884                                   and DOEND items to update them.  Their links may
     1174    15885                                   change and their level numbers and their fathers
     1175    15886                                   will change.
     1176    15887        */
     1177    15888
     1178    15889    8                          DO UNTIL SEARCH_DO$ = DOEND_ILS$ ;

     1179    15890
     1180    15891    9                            DO CASE(SEARCH_DO$->ILS.ILL$->ILL.ID) ;

  15891 27 004620   000017 470400 0                  LDP0    SEARCH_DO$
        27 004621   000003 471500                    LDP1    3,,PR0
        27 004622   100000 236100                    LDQ     0,,PR1
        27 004623   000022 772000                    QRL     18
        27 004624   000375 136007                    SBLQ    253,DL
        27 004625   000005 116007                    CMPQ    5,DL
        27 004626   004630 602006 27                 TNC     s:15891+8,QL
        27 004627   004646 710000 27                 TRA     s:15903
        27 004630   004635 710000 27                 TRA     s:15894
        27 004631   004635 710000 27                 TRA     s:15894
        27 004632   004635 710000 27                 TRA     s:15894
        27 004633   004635 710000 27                 TRA     s:15894
        27 004634   004635 710000 27                 TRA     s:15894

     1181    15892
     1182    15893    9                              CASE(%DO1, %DO2, %DO3, %DO4, %DO5/*, %DO6 */) ;

     1183    15894    9                                IF SEARCH_DO$->ILS.ILL$->DO_N.LEVEL = 1

  15894 27 004635   100005 220100                    LDX0    5,,PR1
        27 004636   000001 100003                    CMPX0   1,DU
        27 004637   004642 601000 27                 TNZ     s:15896

     1184    15895    9                                  THEN SEARCH_DO$->ILS.ILL$->DO_N.ITO = DO_ILS$ ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:245  
  15895 27 004640   000022 236000 0                  LDQ     DO_ILS$
        27 004641   100004 756100                    STQ     4,,PR1

     1185    15896    9                                SEARCH_DO$->ILS.ILL$->DO_N.LEVEL =

  15896 27 004642   000003 471500                    LDP1    3,,PR0
        27 004643   100005 220100                    LDX0    5,,PR1
        27 004644   000001 621010                    EAX1    1,X0
        27 004645   100005 741100                    STX1    5,,PR1

     1186    15897    9                                  SEARCH_DO$->ILS.ILL$->DO_N.LEVEL + 1 ;
     1187    15898
     1188    15899    9                            END ;

     1189    15900
     1190    15901                                 %NEXT_ILS (POINTER=SEARCH_DO$) ;

  15903 27 004646   000002 236100                    LDQ     2,,PR0
        27 004647   000017 756000 0                  STQ     SEARCH_DO$

     1191    15906
     1192    15907    8                          END ;

  15907 27 004650   000013 116000 0                  CMPQ    DOEND_ILS$
        27 004651   004620 601000 27                 TNZ     s:15891

     1193    15908
     1194    15909    7                        END ;

     1195    15910
     1196    15911    6                      DOEND_ILS$->ILS.ILL$->DO_N.ITP = COMCOM.H_DO ;

  15911 27 004652   000013 470400 0                  LDP0    DOEND_ILS$
        27 004653   000003 471500                    LDP1    3,,PR0
        27 004654   000332 236000 xsym               LDQ     COMCOM+218
        27 004655   100003 756100                    STQ     3,,PR1

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:246  
     1197    15912    6                      COMCOM.H_DO = DOEND_ILS$ ;

  15912 27 004656   000013 236000 0                  LDQ     DOEND_ILS$
        27 004657   000332 756000 xsym               STQ     COMCOM+218

     1198    15913    6                      ILS$ = DOEND_ILS$ ;

  15913 27 004660   000000 756000 6                  STQ     ILS$

     1199    15914    6                    END ;

     1200    15915    5                    IF GO_FLAG >= 0 THEN GOTO_DEST$ = ADDR (NIL) ;

  15915 27 004661   000050 235000 0                  LDA     GO_FLAG
        27 004662   004665 604000 27                 TMI     s:15927

  15915 27 004663   000000 236000 28                 LDQ     0
        27 004664   000014 756000 0                  STQ     GOTO_DEST$

     1201    15916    5                  END ;

     1202    15917    4                END ;

     1203    15918        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:247  
     1204    15919        /*V*
     1205    15920            GO_ALTER_CHECK -- If the item is a GO altered then set the code to
     1206    15921                              %GO_ALTERED.  A base item is created above the SWITCH and
     1207    15922                              GO is assigned the pointer.
     1208    15923                              This applies to GO TO unconditional, the destination of
     1209    15924                              which is an ALTERed GO TO.
     1210    15925        */
     1211    15926
     1212    15927    4                IF COMCOM.SEGMENTC <= 1 THEN DO;

  15927 27 004665   000314 235000 xsym               LDA     COMCOM+204
        27 004666   000001 115007                    CMPA    1,DL
        27 004667   005166 605400 27                 TPNZ    s:16038

     1213    15928    4                IF ILL$->ILL.CODE = %GO_UNCONDITIONAL THEN

  15928 27 004670   000000 470400 10                 LDP0    ILL$
        27 004671   000000 720100                    LXL0    0,,PR0
        27 004672   004725 601000 27                 TNZ     EXTRA_GO_CHECK

     1214    15929    5                  DO ;

     1215    15930    5                    IF ILL$->ILL.LOP->LABEL.ID = %PARA AND

  15930 27 004673   000001 471500                    LDP1    1,,PR0
        27 004674   100000 221100                    LDX1    0,,PR1
        27 004675   000771 101003                    CMPX1   505,DU
        27 004676   004723 601000 27                 TNZ     s:15938
        27 004677   100005 236100                    LDQ     5,,PR1
        27 004700   000000 116000 28                 CMPQ    0
        27 004701   004723 600000 27                 TZE     s:15938

     1216    15931    5                       ILL$->ILL.LOP->LABEL.POINTER$ ~= ADDR(NIL) THEN
     1217    15932    6                      DO ;

     1218    15933    6                        ILL$->ILL.CODE = %GO_ALTERED ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:248  
  15933 27 004702   000020 222003                    LDX2    16,DU
        27 004703   000000 442100                    SXL2    0,,PR0

     1219    15934    6                        CALL Z8AF$NEW_BASE (ILL$ ->ILL.LOP -> LABEL.POINTER$,

  15934 27 004704   000000 470400 10                 LDP0    ILL$
        27 004705   000001 471500                    LDP1    1,,PR0
        27 004706   000000 236000 28                 LDQ     0
        27 004707   000130 756000 0                  STQ     OPT_FLAG+1
        27 004710   000000 236000 10                 LDQ     ILL$
        27 004711   000001 036003                    ADLQ    1,DU
        27 004712   000133 756000 0                  STQ     OPT_FLAG+4
        27 004713   000130 633400 0                  EPPR3   OPT_FLAG+1
        27 004714   000132 453400 0                  STP3    OPT_FLAG+3
        27 004715   100005 634500                    EPPR4   5,,PR1
        27 004716   000131 454400 0                  STP4    OPT_FLAG+2
        27 004717   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 004720   000023 631400 28                 EPPR1   19
        27 004721   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        27 004722   000000 011000                    NOP     0

     1220    15935    6                                            ADDR(NIL),
     1221    15936    6                                            ILL$ -> ILL.LOP) ;
     1222    15937    6                      END ;

     1223    15938    5                    FALL_THRU_FLAG = 0 ; /* Fall thru not possible */

  15938 27 004723   000053 450000 0                  STZ     FALL_THRU_FLAG

     1224    15939    5                  END ;

  15939 27 004724   005170 710000 27                 TRA     s:16044

     1225    15940    5                  ELSE DO;

     1226    15941    6   EXTRA_GO_CHECK:  DO;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:249  
  15941 27 004725                       EXTRA_GO_CH* null
     1227    15942    6                      GO_ILS$ = ILS$;

  15942 27 004725   000000 236000 6                  LDQ     ILS$
        27 004726   000015 756000 0                  STQ     GO_ILS$

     1228    15943                           %NEXT_NON_SUPPORT (POINTER=GO_ILS$);

  15953 27 004727   000015 470400 0                  LDP0    GO_ILS$
        27 004730   000002 236100                    LDQ     2,,PR0
        27 004731   000015 756000 0                  STQ     GO_ILS$

  15956 27 004732   000015 470400 0                  LDP0    GO_ILS$
        27 004733   000003 236100                    LDQ     3,,PR0
        27 004734   000000 116000 28                 CMPQ    0
        27 004735   004727 600000 27                 TZE     s:15953
        27 004736   000003 471500                    LDP1    3,,PR0
        27 004737   100000 220100                    LDX0    0,,PR1
        27 004740   000343 100003                    CMPX0   227,DU
        27 004741   004727 600000 27                 TZE     s:15953
        27 004742   000422 100003                    CMPX0   274,DU
        27 004743   004727 600000 27                 TZE     s:15953
        27 004744   000446 100003                    CMPX0   294,DU
        27 004745   004727 600000 27                 TZE     s:15953
        27 004746   000336 100003                    CMPX0   222,DU
        27 004747   004727 600000 27                 TZE     s:15953
        27 004750   000420 100003                    CMPX0   272,DU
        27 004751   004727 600000 27                 TZE     s:15953
        27 004752   000373 100003                    CMPX0   251,DU
        27 004753   004727 600000 27                 TZE     s:15953

     1229    15958    6                      IF GO_ILS$ -> ILS.ILL$ = ADDR(NIL) OR

  15958 27 004754   000000 116000 28                 CMPQ    0
        27 004755   005163 600000 27                 TZE     s:16035
        27 004756   000344 100003                    CMPX0   228,DU
        27 004757   005163 601000 27                 TNZ     s:16035
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:250  
        27 004760   100000 721100                    LXL1    0,,PR1
        27 004761   005163 601000 27                 TNZ     s:16035
        27 004762   100001 236100                    LDQ     1,,PR1
        27 004763   000000 116000 28                 CMPQ    0
        27 004764   005163 600000 27                 TZE     s:16035
        27 004765   100001 473500                    LDP3    1,,PR1
        27 004766   300005 236100                    LDQ     5,,PR3
        27 004767   000000 116000 28                 CMPQ    0
        27 004770   005163 601000 27                 TNZ     s:16035

     1230    15959    6                          GO_ILS$ -> ILS.ILL$ -> ILL.ID ~= %GO OR
     1231    15960    6                          GO_ILS$ -> ILS.ILL$ -> ILL.CODE ~= %GO_UNCONDITIONAL OR
     1232    15961    6                          GO_ILS$ -> ILS.ILL$ -> ILL.LOP = ADDR(NIL) OR
     1233    15962    6                         GO_ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.POINTER$ ~= ADDR(NIL)
     1234    15963    6                        THEN EXIT EXTRA_GO_CHECK;
     1235    15964    6                      LABEL_CHECK$ = GO_ILS$ -> ILS.ILL$ -> ILL.LOP;

  15964 27 004771   100001 236100                    LDQ     1,,PR1
        27 004772   000030 756000 0                  STQ     LABEL_CHECK$

     1236    15965    6                      ILS$$ = GO_ILS$;

  15965 27 004773   000015 236000 0                  LDQ     GO_ILS$
        27 004774   000060 756000 0                  STQ     ILS$$

     1237    15966                           %NEXT_NON_SUPPORT (POINTER=GO_ILS$);

  15976 27 004775   000015 470400 0                  LDP0    GO_ILS$
        27 004776   000002 236100                    LDQ     2,,PR0
        27 004777   000015 756000 0                  STQ     GO_ILS$

  15979 27 005000   000015 470400 0                  LDP0    GO_ILS$
        27 005001   000003 236100                    LDQ     3,,PR0
        27 005002   000000 116000 28                 CMPQ    0
        27 005003   004775 600000 27                 TZE     s:15976
        27 005004   000003 471500                    LDP1    3,,PR0
        27 005005   100000 220100                    LDX0    0,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:251  
        27 005006   000343 100003                    CMPX0   227,DU
        27 005007   004775 600000 27                 TZE     s:15976
        27 005010   000422 100003                    CMPX0   274,DU
        27 005011   004775 600000 27                 TZE     s:15976
        27 005012   000446 100003                    CMPX0   294,DU
        27 005013   004775 600000 27                 TZE     s:15976
        27 005014   000336 100003                    CMPX0   222,DU
        27 005015   004775 600000 27                 TZE     s:15976
        27 005016   000420 100003                    CMPX0   272,DU
        27 005017   004775 600000 27                 TZE     s:15976
        27 005020   000373 100003                    CMPX0   251,DU
        27 005021   004775 600000 27                 TZE     s:15976

     1238    15981    6                      IF GO_ILS$ -> ILS.ILL$ -> ILL.ID ~= %DEFLB OR

  15981 27 005022   000346 100003                    CMPX0   230,DU
        27 005023   005163 601000 27                 TNZ     s:16035
        27 005024   000000 473400 10                 LDP3    ILL$
        27 005025   100001 236100                    LDQ     1,,PR1
        27 005026   300001 116100                    CMPQ    1,,PR3
        27 005027   005163 601000 27                 TNZ     s:16035

     1239    15982    6                          GO_ILS$ -> ILS.ILL$ -> DEFLB.LOP ~= ILL$ -> ILL.LOP
     1240    15983    6                        THEN EXIT EXTRA_GO_CHECK;
     1241    15984                           /* This can be optimized. */
     1242    15985    6                      ILL$ -> ILL.LOP = LABEL_CHECK$;

  15985 27 005030   000030 236000 0                  LDQ     LABEL_CHECK$
        27 005031   300001 756100                    STQ     1,,PR3

     1243    15986                           %REVERSE_RELATE_OP_CODE (OP_CODE=ILL$->ILL.CODE,@CLASS=YES);

  15990 27 005032   300000 720100                    LXL0    0,,PR3
        27 005033   000027 100003                    CMPX0   23,DU
        27 005034   005036 602010 27                 TNC     s:15990+4,X0
        27 005035   005136 710000 27                 TRA     s:16024
        27 005036   005136 710000 27                 TRA     s:16024
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:252  
        27 005037   005065 710000 27                 TRA     s:15992
        27 005040   005070 710000 27                 TRA     s:15994
        27 005041   005073 710000 27                 TRA     s:15996
        27 005042   005076 710000 27                 TRA     s:15998
        27 005043   005101 710000 27                 TRA     s:16000
        27 005044   005104 710000 27                 TRA     s:16002
        27 005045   005107 710000 27                 TRA     s:16004
        27 005046   005112 710000 27                 TRA     s:16006
        27 005047   005115 710000 27                 TRA     s:16008
        27 005050   005120 710000 27                 TRA     s:16010
        27 005051   005131 710000 27                 TRA     s:16017
        27 005052   005134 710000 27                 TRA     s:16019
        27 005053   005136 710000 27                 TRA     s:16024
        27 005054   005136 710000 27                 TRA     s:16024
        27 005055   005136 710000 27                 TRA     s:16024
        27 005056   005136 710000 27                 TRA     s:16024
        27 005057   005136 710000 27                 TRA     s:16024
        27 005060   005136 710000 27                 TRA     s:16024
        27 005061   005136 710000 27                 TRA     s:16024
        27 005062   005136 710000 27                 TRA     s:16024
        27 005063   005123 710000 27                 TRA     s:16012
        27 005064   005126 710000 27                 TRA     s:16014

  15992 27 005065   000007 221003                    LDX1    7,DU
        27 005066   300000 441100                    SXL1    0,,PR3
        27 005067   005136 710000 27                 TRA     s:16024

  15994 27 005070   000010 221003                    LDX1    8,DU
        27 005071   300000 441100                    SXL1    0,,PR3
        27 005072   005136 710000 27                 TRA     s:16024

  15996 27 005073   000005 221003                    LDX1    5,DU
        27 005074   300000 441100                    SXL1    0,,PR3
        27 005075   005136 710000 27                 TRA     s:16024

  15998 27 005076   000006 221003                    LDX1    6,DU
        27 005077   300000 441100                    SXL1    0,,PR3
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:253  
        27 005100   005136 710000 27                 TRA     s:16024

  16000 27 005101   000003 221003                    LDX1    3,DU
        27 005102   300000 441100                    SXL1    0,,PR3
        27 005103   005136 710000 27                 TRA     s:16024

  16002 27 005104   000004 221003                    LDX1    4,DU
        27 005105   300000 441100                    SXL1    0,,PR3
        27 005106   005136 710000 27                 TRA     s:16024

  16004 27 005107   000001 221003                    LDX1    1,DU
        27 005110   300000 441100                    SXL1    0,,PR3
        27 005111   005136 710000 27                 TRA     s:16024

  16006 27 005112   000002 221003                    LDX1    2,DU
        27 005113   300000 441100                    SXL1    0,,PR3
        27 005114   005136 710000 27                 TRA     s:16024

  16008 27 005115   000012 221003                    LDX1    10,DU
        27 005116   300000 441100                    SXL1    0,,PR3
        27 005117   005136 710000 27                 TRA     s:16024

  16010 27 005120   000011 221003                    LDX1    9,DU
        27 005121   300000 441100                    SXL1    0,,PR3
        27 005122   005136 710000 27                 TRA     s:16024

  16012 27 005123   000026 221003                    LDX1    22,DU
        27 005124   300000 441100                    SXL1    0,,PR3
        27 005125   005136 710000 27                 TRA     s:16024

  16014 27 005126   000025 221003                    LDX1    21,DU
        27 005127   300000 441100                    SXL1    0,,PR3
        27 005130   005136 710000 27                 TRA     s:16024

  16017 27 005131   000014 221003                    LDX1    12,DU
        27 005132   300000 441100                    SXL1    0,,PR3
        27 005133   005136 710000 27                 TRA     s:16024
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:254  

  16019 27 005134   000013 221003                    LDX1    11,DU
        27 005135   300000 441100                    SXL1    0,,PR3

     1244    16024    6                      IF GO_ILS$ -> ILS.ILL$ -> DEFLB.LOP -> LABEL.ID = %PARA AND

  16024 27 005136   000003 471500                    LDP1    3,,PR0
        27 005137   100001 473500                    LDP3    1,,PR1
        27 005140   300000 220100                    LDX0    0,,PR3
        27 005141   000771 100003                    CMPX0   505,DU
        27 005142   005154 601000 27                 TNZ     s:16031
        27 005143   300003 236100                    LDQ     3,,PR3
        27 005144   010000 316003                    CANQ    4096,DU
        27 005145   005154 600000 27                 TZE     s:16031

     1245    16025    7                          GO_ILS$ -> ILS.ILL$ -> DEFLB.LOP -> LABEL.B.ONE_REF THEN DO;

     1246    16026                             /* Optimize out label */
     1247    16027    7                        GO_ILS$ -> ILS.ILL$ -> DEFLB.LOP -> LABEL.B.ONE_REF = FALSE;

  16027 27 005146   000004 236000 28                 LDQ     4
        27 005147   300003 356100                    ANSQ    3,,PR3

     1248    16028    7                       GO_ILS$ -> ILS.ILL$ -> DEFLB.LOP -> LABEL.B.REFERENCED = FALSE;

  16028 27 005150   000003 471500                    LDP1    3,,PR0
        27 005151   100001 473500                    LDP3    1,,PR1
        27 005152   000017 236000 28                 LDQ     15
        27 005153   300003 356100                    ANSQ    3,,PR3

     1249    16029    7                      END;

     1250    16030                           /* Now mark the GO to be optimized out. */
     1251    16031    6                      ILS$$ -> ILS.ILL$ -> ILL.CODE = %GO_INVALID_LABEL;

  16031 27 005154   000060 471400 0                  LDP1    ILS$$
        27 005155   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:255  
        27 005156   000033 220003                    LDX0    27,DU
        27 005157   300000 440100                    SXL0    0,,PR3

     1252    16032                           /* So it won't be mistaken for GO TO. in program. */
     1253    16033    6                      ILS$$ -> ILS.ILL$ -> ILL.LOP = ADDR(NIL);

  16033 27 005160   100003 473500                    LDP3    3,,PR1
        27 005161   000000 236000 28                 LDQ     0
        27 005162   300001 756100                    STQ     1,,PR3

     1254    16034    6                    END; /* EXTRA_GO_CHECK */

     1255    16035    5                    FALL_THRU_FLAG = 1; /* Conditional GO can fall thru */

  16035 27 005163   000001 235007                    LDA     1,DL
        27 005164   000053 755000 0                  STA     FALL_THRU_FLAG

     1256    16036    5                  END;

     1257    16037    4                  END;

  16037 27 005165   005170 710000 27                 TRA     s:16044

     1258    16038    3                  ELSE FALL_THRU_FLAG = 1 ; /* Conditional GO can fall thru. */

  16038 27 005166   000001 236007                    LDQ     1,DL
        27 005167   000053 756000 0                  STQ     FALL_THRU_FLAG

     1259    16039        /*V*
     1260    16040            LABEL_AFTER_USE -- Phase 3 needs to have the first label after any
     1261    16041                               report writer and/or USE procedures added into
     1262    16042                               the entry chain.
     1263    16043        */
     1264    16044    3                 IF AFTER_USE THEN

  16044 27 005170   000104 234000 0                  SZN     AFTER_USE
        27 005171   005176 605000 27                 TPL     s:16049
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:256  

     1265    16045    4                   DO ;

     1266    16046    4                     LABEL_AFTER_USE = ILL$->ILL.LOP ;

  16046 27 005172   000000 470400 10                 LDP0    ILL$
        27 005173   000001 236100                    LDQ     1,,PR0
        27 005174   000105 756000 0                  STQ     LABEL_AFTER_USE

     1267    16047    4                     AFTER_USE = FALSE ;

  16047 27 005175   000104 450000 0                  STZ     AFTER_USE

     1268    16048    4                   END ;

     1269    16049    3                PREV_ILS$ = ILS$ ;

  16049 27 005176   000000 236000 6                  LDQ     ILS$
        27 005177   000001 756000 0                  STQ     PREV_ILS$

     1270    16050    3                ILS$ = NEXT_ILS$ ;

  16050 27 005200   000002 236000 0                  LDQ     NEXT_ILS$
        27 005201   000000 756000 6                  STQ     ILS$
        27 005202   012101 710000 27                 TRA     s:17920

     1271    16051
     1272    16052        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:257  
     1273    16053        /*V*
     1274    16054            DEFLB -- The label information is assigned and the label is marked
     1275    16055                     as phase 2 referenced.
     1276    16056        */
     1277    16057
     1278    16058    3              CASE (%DEFLB) ;

     1279    16059                     %ASSIGN_LABEL_INFO ;

  16061 27 005203   000057 234000 0                  SZN     DEFLB_AFTER_ENTRY
        27 005204   005210 605000 27                 TPL     s:16063

  16062 27 005205   000001 471500                    LDP1    1,,PR0
        27 005206   400000 236003                    LDQ     -131072,DU
        27 005207   100003 256100                    ORSQ    3,,PR1

  16063 27 005210   000001 471500                    LDP1    1,,PR0
        27 005211   100003 234100                    SZN     3,,PR1
        27 005212   005217 605000 27                 TPL     s:16068

  16065 27 005213   000000 236000 6                  LDQ     ILS$
        27 005214   000025 756000 0                  STQ     REF_DEFLB

  16066 27 005215   000001 235007                    LDA     1,DL
        27 005216   000053 755000 0                  STA     FALL_THRU_FLAG

  16068 27 005217   100000 220100                    LDX0    0,,PR1
        27 005220   000770 100003                    CMPX0   504,DU
        27 005221   005233 601000 27                 TNZ     s:16074

  16070 27 005222   000001 236100                    LDQ     1,,PR0
        27 005223   000003 756000 25                 STQ     O2COM+3

  16071 27 005224   000001 471500                    LDP1    1,,PR0
        27 005225   100007 236100                    LDQ     7,,PR1
        27 005226   000000 116000 28                 CMPQ    0
        27 005227   005233 600000 27                 TZE     s:16074
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:258  

  16072 27 005230   100007 473500                    LDP3    7,,PR1
        27 005231   300002 235100                    LDA     2,,PR3
        27 005232   000005 755000 25                 STA     O2COM+5

  16074 27 005233   000000 236000 6                  LDQ     ILS$
        27 005234   000002 756000 25                 STQ     O2COM+2

  16075 27 005235   000057 450000 0                  STZ     DEFLB_AFTER_ENTRY

     1280    16078    3                IF AFTER_USE AND NOT ILL$->ILL.LOP->LABEL.B.COMPILER_CREATED THEN

  16078 27 005236   000104 234000 0                  SZN     AFTER_USE
        27 005237   005247 605000 27                 TPL     s:16083
        27 005240   000001 471500                    LDP1    1,,PR0
        27 005241   100003 236100                    LDQ     3,,PR1
        27 005242   100000 316003                    CANQ    32768,DU
        27 005243   005247 601000 27                 TNZ     s:16083

     1281    16079    4                  DO ;

     1282    16080    4                    ILL$->ILL.LOP->LABEL.B.LABEL_AFTER_USE = TRUE ;

  16080 27 005244   000100 236007                    LDQ     64,DL
        27 005245   100003 256100                    ORSQ    3,,PR1

     1283    16081    4                    AFTER_USE = FALSE ;

  16081 27 005246   000104 450000 0                  STZ     AFTER_USE

     1284    16082    4                  END ;

     1285    16083    3                IF ILL$->ILL.LOP = LABEL_AFTER_USE THEN

  16083 27 005247   000001 236100                    LDQ     1,,PR0
        27 005250   000105 116000 0                  CMPQ    LABEL_AFTER_USE
        27 005251   005256 601000 27                 TNZ     s:16096
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:259  

     1286    16084    4                  DO ;

     1287    16085    4                    AFTER_USE = TRUE ;

  16085 27 005252   400000 236003                    LDQ     -131072,DU
        27 005253   000104 756000 0                  STQ     AFTER_USE

     1288    16086    4                    LABEL_AFTER_USE = ADDR (NIL) ;

  16086 27 005254   000000 236000 28                 LDQ     0
        27 005255   000105 756000 0                  STQ     LABEL_AFTER_USE

     1289    16087    4                  END ;

     1290    16088
     1291    16089        /*V*
     1292    16090            POINTER_LABEL -- If the item is a pointer then we need to create a BASE
     1293    16091                             entry for the pointer.  The loop will continue after
     1294    16092                             the GO item inside the ALTER paragraph because other-
     1295    16093                             wise CASE(%GO) would flag the null left operand as an error.
     1296    16094        */
     1297    16095
     1298    16096    3                IF ILL$->ILL.LOP->LABEL.POINTER$ ~= ADDR(NIL) AND

  16096 27 005256   000001 471500                    LDP1    1,,PR0
        27 005257   100005 236100                    LDQ     5,,PR1
        27 005260   000000 116000 28                 CMPQ    0
        27 005261   005402 600000 27                 TZE     s:16165
        27 005262   100003 236100                    LDQ     3,,PR1
        27 005263   020000 316007                    CANQ    8192,DL
        27 005264   005402 601000 27                 TNZ     s:16165

     1299    16097    3                   NOT ILL$ -> ILL.LOP -> LABEL.B.GO_ALTERED THEN
     1300    16098    4                  DO ;

     1301    16099
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:260  
     1302    16100                         %FIND_ITEM(ITEM=%GO, POINTER=NEXT_ILS$) ;

  16102 27 005265   005306 710000 27                 TRA     s:16114

  16104 27 005266   000002 470400 0                  LDP0    NEXT_ILS$
        27 005267   000003 471500                    LDP1    3,,PR0
        27 005270   100000 220100                    LDX0    0,,PR1
        27 005271   000373 100003                    CMPX0   251,DU
        27 005272   005304 601000 27                 TNZ     s:16111

  16105 27 005273   100002 221100                    LDX1    2,,PR1
        27 005274   005304 600000 27                 TZE     s:16111

  16106 27 005275   100001 236100                    LDQ     1,,PR1
        27 005276   777777 376007                    ANQ     -1,DL
        27 005277   000133 756000 xsym               STQ     COMCOM+91

  16107 27 005300   000003 471500                    LDP1    3,,PR0
        27 005301   100001 236100                    LDQ     1,,PR1
        27 005302   000022 772000                    QRL     18
        27 005303   000134 756000 xsym               STQ     COMCOM+92

  16111 27 005304   000002 236100                    LDQ     2,,PR0
        27 005305   000002 756000 0                  STQ     NEXT_ILS$

  16114 27 005306   000002 470400 0                  LDP0    NEXT_ILS$
        27 005307   000003 471500                    LDP1    3,,PR0
        27 005310   100000 220100                    LDX0    0,,PR1
        27 005311   000374 100003                    CMPX0   252,DU
        27 005312   005315 600000 27                 TZE     s:16118
        27 005313   000344 100003                    CMPX0   228,DU
        27 005314   005266 601000 27                 TNZ     s:16104

     1303    16117
     1304    16118    4                    IF NEXT_ILS$ ->ILS.ILL$->ILL.CODE=%GO_AND_SAVE_IC_IN_X1 THEN

  16118 27 005315   100000 721100                    LXL1    0,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:261  
        27 005316   000030 101003                    CMPX1   24,DU
        27 005317   005352 601000 27                 TNZ     s:16141

     1305    16119    5                      DO;

     1306    16120    5                        NEXT_ILS$ = NEXT_ILS$ -> ILS.NEXT;

  16120 27 005320   000002 236100                    LDQ     2,,PR0
        27 005321   000002 756000 0                  STQ     NEXT_ILS$

     1307    16121
     1308    16122                             %FIND_ITEM(ITEM=%GO, POINTER=NEXT_ILS$);

  16124 27 005322   005343 710000 27                 TRA     s:16136

  16126 27 005323   000002 470400 0                  LDP0    NEXT_ILS$
        27 005324   000003 471500                    LDP1    3,,PR0
        27 005325   100000 220100                    LDX0    0,,PR1
        27 005326   000373 100003                    CMPX0   251,DU
        27 005327   005341 601000 27                 TNZ     s:16133

  16127 27 005330   100002 221100                    LDX1    2,,PR1
        27 005331   005341 600000 27                 TZE     s:16133

  16128 27 005332   100001 236100                    LDQ     1,,PR1
        27 005333   777777 376007                    ANQ     -1,DL
        27 005334   000133 756000 xsym               STQ     COMCOM+91

  16129 27 005335   000003 471500                    LDP1    3,,PR0
        27 005336   100001 236100                    LDQ     1,,PR1
        27 005337   000022 772000                    QRL     18
        27 005340   000134 756000 xsym               STQ     COMCOM+92

  16133 27 005341   000002 236100                    LDQ     2,,PR0
        27 005342   000002 756000 0                  STQ     NEXT_ILS$

  16136 27 005343   000002 470400 0                  LDP0    NEXT_ILS$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:262  
        27 005344   000003 471500                    LDP1    3,,PR0
        27 005345   100000 220100                    LDX0    0,,PR1
        27 005346   000374 100003                    CMPX0   252,DU
        27 005347   005352 600000 27                 TZE     s:16141
        27 005350   000344 100003                    CMPX0   228,DU
        27 005351   005323 601000 27                 TNZ     s:16126

     1309    16139    5                      END;

     1310    16140
     1311    16141    4                    NEXT_ILS$->ILS.ILL$->ILL.CODE = %GO_ALTERED ;

  16141 27 005352   000020 221003                    LDX1    16,DU
        27 005353   100000 441100                    SXL1    0,,PR1

     1312    16142    4                    CALL Z8AF$NEW_BASE (ILL$ ->ILL.LOP -> LABEL.POINTER$,

  16142 27 005354   000000 471400 10                 LDP1    ILL$
        27 005355   100001 473500                    LDP3    1,,PR1
        27 005356   000003 474500                    LDP4    3,,PR0
        27 005357   000000 236000 28                 LDQ     0
        27 005360   000130 756000 0                  STQ     OPT_FLAG+1
        27 005361   400001 635500                    EPPR5   1,,PR4
        27 005362   000133 455400 0                  STP5    OPT_FLAG+4
        27 005363   000130 634400 0                  EPPR4   OPT_FLAG+1
        27 005364   000132 454400 0                  STP4    OPT_FLAG+3
        27 005365   300005 636500                    EPPR6   5,,PR3
        27 005366   000131 456400 0                  STP6    OPT_FLAG+2
        27 005367   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 005370   000023 631400 28                 EPPR1   19
        27 005371   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        27 005372   000000 011000                    NOP     0

     1313    16143    4                                        ADDR(NIL),
     1314    16144    4                                        NEXT_ILS$ -> ILS.ILL$ -> ILL.LOP) ;
     1315    16145    4                    ILS$ = NEXT_ILS$ ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:263  
  16145 27 005373   000002 236000 0                  LDQ     NEXT_ILS$
        27 005374   000000 756000 6                  STQ     ILS$

     1316    16146    4                    PREV_ILS$ = ILS$ ;

  16146 27 005375   000001 756000 0                  STQ     PREV_ILS$

     1317    16147                         %NEXT_ILS (POINTER=ILS$) ;

  16149 27 005376   000000 470400 6                  LDP0    ILS$
        27 005377   000002 236100                    LDQ     2,,PR0
        27 005400   000000 756000 6                  STQ     ILS$

     1318    16152
     1319    16153    4                  END ;

  16153 27 005401   005474 710000 27                 TRA     s:16212

     1320    16154    3                ELSE
     1321    16155    4                  DO ;

     1322    16156        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:264  
     1323    16157        /*V*
     1324    16158            GO_VECTOR -- If the label is the lead label for a vector of GO items
     1325    16159                         then we skip past all of the GOs inside as there is no
     1326    16160                         need to check them and CASE(%GO) might optimize them out.
     1327    16161                         A vector is set up for GO TO DEPENDING and EVALUATE
     1328    16162                         statements that have been converted into CASE statements.
     1329    16163        */
     1330    16164
     1331    16165    4                    IF ILL$->ILL.LOP->LABEL.B.GO_VECTOR_START THEN

  16165 27 005402   100003 236100                    LDQ     3,,PR1
        27 005403   000004 316003                    CANQ    4,DU
        27 005404   005470 600000 27                 TZE     s:16206

     1332    16166    5                      DO ;

     1333    16167    5                        PREV_ILS$ = ILL$->ILL.LOP->LABEL.P_END$->LABEL.PREV_ILS$ ;

  16167 27 005405   100001 473500                    LDP3    1,,PR1
        27 005406   300010 236100                    LDQ     8,,PR3
        27 005407   000001 756000 0                  STQ     PREV_ILS$

     1334    16168
     1335    16169    5                        TEMP$ = PREV_ILS$ ;

  16169 27 005410   000110 756000 0                  STQ     TEMP$

     1336    16170                             %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  16180 27 005411   000110 470400 0                  LDP0    TEMP$
        27 005412   000002 236100                    LDQ     2,,PR0
        27 005413   000110 756000 0                  STQ     TEMP$

  16183 27 005414   000110 470400 0                  LDP0    TEMP$
        27 005415   000003 236100                    LDQ     3,,PR0
        27 005416   000000 116000 28                 CMPQ    0
        27 005417   005411 600000 27                 TZE     s:16180
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:265  
        27 005420   000003 471500                    LDP1    3,,PR0
        27 005421   100000 220100                    LDX0    0,,PR1
        27 005422   000343 100003                    CMPX0   227,DU
        27 005423   005411 600000 27                 TZE     s:16180
        27 005424   000422 100003                    CMPX0   274,DU
        27 005425   005411 600000 27                 TZE     s:16180
        27 005426   000446 100003                    CMPX0   294,DU
        27 005427   005411 600000 27                 TZE     s:16180
        27 005430   000336 100003                    CMPX0   222,DU
        27 005431   005411 600000 27                 TZE     s:16180
        27 005432   000420 100003                    CMPX0   272,DU
        27 005433   005411 600000 27                 TZE     s:16180
        27 005434   000373 100003                    CMPX0   251,DU
        27 005435   005411 600000 27                 TZE     s:16180

     1337    16185    6                        DO WHILE (ILS$ ~= TEMP$) ;

  16185 27 005436   000000 236000 6                  LDQ     ILS$
        27 005437   000110 116000 0                  CMPQ    TEMP$
        27 005440   005474 600000 27                 TZE     s:16212

     1338    16186    6                          IF NEXT_ILS$->ILS.ILL$->ILL.ID = %GO AND

  16186 27 005441   000002 470400 0                  LDP0    NEXT_ILS$
        27 005442   000003 471500                    LDP1    3,,PR0
        27 005443   100000 220100                    LDX0    0,,PR1
        27 005444   000344 100003                    CMPX0   228,DU
        27 005445   005460 601000 27                 TNZ     s:16195
        27 005446   100001 236100                    LDQ     1,,PR1
        27 005447   000000 116000 28                 CMPQ    0
        27 005450   005460 601000 27                 TNZ     s:16195

     1339    16187    7                             NEXT_ILS$->ILS.ILL$->ILL.LOP = ADDR(NIL) THEN DO ;

     1340    16188    7                            NEXT_ILS$->ILS.ILL$->ILL.LOP =

  16188 27 005451   000000 473400 10                 LDP3    ILL$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:266  
        27 005452   300001 474500                    LDP4    1,,PR3
        27 005453   400001 236100                    LDQ     1,,PR4
        27 005454   100001 756100                    STQ     1,,PR1

     1341    16189    7                                ILL$->ILL.LOP->LABEL.P_END$ ;
     1342    16190                                   /* Choosing an undefined label will cause
     1343    16191                                      control to fall thru. */
     1344    16192    7                            NEXT_ILS$->ILS.ILL$->ILL.CODE = %GO_UNCONDITIONAL ;
             16192                                     /*#33670*/

  16192 27 005455   000003 471500                    LDP1    3,,PR0
        27 005456   000000 220003                    LDX0    0,DU
        27 005457   100000 440100                    SXL0    0,,PR1

     1345    16193    7                          END ;

     1346    16194
     1347    16195    6                          ILS$ = NEXT_ILS$ ;

  16195 27 005460   000002 236000 0                  LDQ     NEXT_ILS$
        27 005461   000000 756000 6                  STQ     ILS$

     1348    16196                               %NEXT_ILS (POINTER=NEXT_ILS$) ;

  16198 27 005462   000002 236100                    LDQ     2,,PR0
        27 005463   000002 756000 0                  STQ     NEXT_ILS$

     1349    16201    6                        END ;

  16201 27 005464   000000 236000 6                  LDQ     ILS$
        27 005465   000110 116000 0                  CMPQ    TEMP$
        27 005466   005441 601000 27                 TNZ     s:16186

     1350    16202
     1351    16203    5                      END ;

  16203 27 005467   005474 710000 27                 TRA     s:16212
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:267  

     1352    16204    4                    ELSE
     1353    16205    5                      DO ;

     1354    16206    5                        PREV_ILS$ = ILS$ ;

  16206 27 005470   000000 236000 6                  LDQ     ILS$
        27 005471   000001 756000 0                  STQ     PREV_ILS$

     1355    16207    5                        ILS$ = NEXT_ILS$ ;

  16207 27 005472   000002 236000 0                  LDQ     NEXT_ILS$
        27 005473   000000 756000 6                  STQ     ILS$

     1356    16208    5                      END ;

     1357    16209
     1358    16210    4                  END ;

     1359    16211
     1360    16212    3                ILL$->ILL.LOP->LABEL.B.PHASE_2 = TRUE ;

  16212 27 005474   000000 470400 10                 LDP0    ILL$
        27 005475   000001 471500                    LDP1    1,,PR0
        27 005476   004000 236003                    LDQ     2048,DU
        27 005477   100003 256100                    ORSQ    3,,PR1
        27 005500   012101 710000 27                 TRA     s:17920

     1361    16213        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:268  
     1362    16214        /*V*
     1363    16215            DO_S -- The DO pointers information is set.
     1364    16216        */
     1365    16217
     1366    16218    3              CASE (%DO1,%DO2,%DO3,%DO4,%DO5/*,%DO6 */) ;

     1367    16219    3                 OPTIMIZE_DO3 = FALSE ;

  16219 27 005501   000045 450000 0                  STZ     OPTIMIZE_DO3

     1368    16220         /*V* DO3_OPTIMIZATION: PERFORM UNTIL <variable> <condition> <constant>
     1369    16221                                  SUBTRACT 1 FROM <variable>
     1370    16222                                END-PERFORM
     1371    16223                                Old ILL: If TEST BEFORE: DO3;DEFLB,lab1;GO,<variable>
     1372    16224                                <condition> <constant>;SB2I(e.g.);GO,lab1;
     1373    16225                                DEFLB,lab2;DOEND. If TEST AFTER: DO3;DEFLB,lab1;
     1374    16226                                SB2I(e.g.);GO,<variable> NOT <condition> <constant>,lab1;
     1375    16227                                DOEND.
     1376    16228                                The above can be optimized. If <condition> is =,
     1377    16229                                the optimized code is MOVE <constant> TO <variable>.
     1378    16230                                Otherwise, <constant'> = <constant> unless <condition>
     1379    16231                                is > or <, in which case it is <constant> - 1.
     1380    16232                                If TEST BEFORE, new ILL burst is: GO,<variable>
     1381    16233                                <condition><constant>,label2;MVII(e.g.) <constant'>
     1382    16234                                TO <variable>;DEFLB,lab2. Otherwise it is: GO,
     1383    16235                                <variable> NOT <condition> <constant>,lab1; SB2I(e.g.);
     1384    16236                                GO,created-label;DEFLB,lab1;MVII(e.g.) <constant'>
     1385    16237                                TO <variable>;DEFLB,created-label.
     1386    16238                                This will be done only for COMP-1, COMP-2, COMP-6,
     1387    16239                                and COMP-7 variables. */
     1388    16240    3                 IF ILL$->ILL.ID = %DO3 THEN

  16240 27 005502   000000 220100                    LDX0    0,,PR0
        27 005503   000377 100003                    CMPX0   255,DU
        27 005504   007521 601000 27                 TNZ     s:16957

     1389    16241    4    CHECK_DO3:     DO ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:269  

  16241 27 005505                       CHECK_DO3    null
     1390    16242    4                     DO_ILS$ = ILS$ ;

  16242 27 005505   000000 236000 6                  LDQ     ILS$
        27 005506   000022 756000 0                  STQ     DO_ILS$

     1391    16243                          %NEXT_ILS(POINTER=DO_ILS$) ;

  16245 27 005507   000022 471400 0                  LDP1    DO_ILS$
        27 005510   100002 236100                    LDQ     2,,PR1
        27 005511   000022 756000 0                  STQ     DO_ILS$

     1392    16248    4                     IF DO_ILS$->ILS.ILL$->ILL.ID ~= %LINOI THEN

  16248 27 005512   000022 471400 0                  LDP1    DO_ILS$
        27 005513   100003 473500                    LDP3    3,,PR1
        27 005514   300000 221100                    LDX1    0,,PR3
        27 005515   000373 101003                    CMPX1   251,DU
        27 005516   007521 601000 27                 TNZ     s:16957

     1393    16249    4                       EXIT CHECK_DO3 ;
     1394    16250    4                     ILS$$ = DO_ILS$ ; /* LINOI ILS pointer for start label */

  16250 27 005517   000060 756000 0                  STQ     ILS$$

     1395    16251                          %NEXT_ILS(POINTER=DO_ILS$) ;

  16253 27 005520   100002 236100                    LDQ     2,,PR1
        27 005521   000022 756000 0                  STQ     DO_ILS$

     1396    16256    4                     IF DO_ILS$->ILS.ILL$->ILL.ID ~= %DEFLB THEN

  16256 27 005522   000022 471400 0                  LDP1    DO_ILS$
        27 005523   100003 473500                    LDP3    3,,PR1
        27 005524   300000 221100                    LDX1    0,,PR3
        27 005525   000346 101003                    CMPX1   230,DU
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:270  
        27 005526   007521 601000 27                 TNZ     s:16957

     1397    16257    4                       EXIT CHECK_DO3 ;
     1398    16258
     1399    16259    4                     IF ILL$->DO_N.B.TEST_AFTER THEN

  16259 27 005527   000000 236100                    LDQ     0,,PR0
        27 005530   400000 316007                    CANQ    -131072,DL
        27 005531   005550 600000 27                 TZE     s:16278

     1400    16260    5                       DO ;

     1401    16261    5                         START_LABEL_ILS$ = DO_ILS$ ;

  16261 27 005532   000022 236000 0                  LDQ     DO_ILS$
        27 005533   000006 756000 0                  STQ     START_LABEL_ILS$

     1402    16262    5                         START_LABEL$ = START_LABEL_ILS$->ILS.ILL$->ILL.LOP ;

  16262 27 005534   000006 474400 0                  LDP4    START_LABEL_ILS$
        27 005535   400003 475500                    LDP5    3,,PR4
        27 005536   500001 236100                    LDQ     1,,PR5
        27 005537   000005 756000 0                  STQ     START_LABEL$

     1403    16263                              %NEXT_ILS(POINTER=DO_ILS$) ;

  16265 27 005540   100002 236100                    LDQ     2,,PR1
        27 005541   000022 756000 0                  STQ     DO_ILS$

     1404    16268    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %LINOI THEN

  16268 27 005542   000022 471400 0                  LDP1    DO_ILS$
        27 005543   100003 473500                    LDP3    3,,PR1
        27 005544   300000 220100                    LDX0    0,,PR3
        27 005545   000373 100003                    CMPX0   251,DU
        27 005546   007521 601000 27                 TNZ     s:16957

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:271  
     1405    16269    5                           EXIT CHECK_DO3 ;
     1406    16270    5                       END ;

  16270 27 005547   005600 710000 27                 TRA     s:16296

     1407    16271    4                     ELSE
     1408    16272    5                       DO ; /* TEST BEFORE or default */

     1409    16273                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;

  16278 27 005550   000022 470400 0                  LDP0    DO_ILS$
        27 005551   000002 236100                    LDQ     2,,PR0
        27 005552   000022 756000 0                  STQ     DO_ILS$

  16281 27 005553   000022 470400 0                  LDP0    DO_ILS$
        27 005554   000003 236100                    LDQ     3,,PR0
        27 005555   000000 116000 28                 CMPQ    0
        27 005556   005550 600000 27                 TZE     s:16278
        27 005557   000003 471500                    LDP1    3,,PR0
        27 005560   100000 220100                    LDX0    0,,PR1
        27 005561   000373 100003                    CMPX0   251,DU
        27 005562   005550 600000 27                 TZE     s:16278

     1410    16283    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %GO THEN

  16283 27 005563   000344 100003                    CMPX0   228,DU
        27 005564   007521 601000 27                 TNZ     s:16957

     1411    16284    5                           EXIT CHECK_DO3 ;
     1412    16285    5                         GO_ILS$ = DO_ILS$ ;

  16285 27 005565   000022 236000 0                  LDQ     DO_ILS$
        27 005566   000015 756000 0                  STQ     GO_ILS$

     1413    16286    5                         END_LABEL$ = DO_ILS$->ILS.ILL$->ILL.LOP ;

  16286 27 005567   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:272  
        27 005570   000007 756000 0                  STQ     END_LABEL$

     1414    16287                              %NEXT_ILS(POINTER=DO_ILS$) ;

  16289 27 005571   000002 236100                    LDQ     2,,PR0
        27 005572   000022 756000 0                  STQ     DO_ILS$

     1415    16292    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %LINOI THEN

  16292 27 005573   000022 470400 0                  LDP0    DO_ILS$
        27 005574   000003 471500                    LDP1    3,,PR0
        27 005575   100000 220100                    LDX0    0,,PR1
        27 005576   000373 100003                    CMPX0   251,DU
        27 005577   007521 601000 27                 TNZ     s:16957

     1416    16293    5                           EXIT CHECK_DO3 ;
     1417    16294    5                       END ;

     1418    16295
     1419    16296    4                     DO_LINOI$ = DO_ILS$ ;

  16296 27 005600   000023 756000 0                  STQ     DO_LINOI$

     1420    16297                          %NEXT_ILS(POINTER=DO_ILS$) ;

  16299 27 005601   000022 470400 0                  LDP0    DO_ILS$
        27 005602   000002 236100                    LDQ     2,,PR0
        27 005603   000022 756000 0                  STQ     DO_ILS$

     1421    16302    4                     OPERAND$ = DO_ILS$->ILS.ILL$->ILL.LOP ;

  16302 27 005604   000022 470400 0                  LDP0    DO_ILS$
        27 005605   000003 471500                    LDP1    3,,PR0
        27 005606   100001 236100                    LDQ     1,,PR1
        27 005607   000036 756000 0                  STQ     OPERAND$

     1422    16303    4                     TEMP$ = DO_ILS$->ILS.ILL$->ILL.ROP ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:273  

  16303 27 005610   100002 236100                    LDQ     2,,PR1
        27 005611   000110 756000 0                  STQ     TEMP$

     1423    16304    5                     DO CASE (DO_ILS$->ILS.ILL$->ILL.ID) ;

  16304 27 005612   100000 236100                    LDQ     0,,PR1
        27 005613   000022 772000                    QRL     18
        27 005614   000233 136007                    SBLQ    155,DL
        27 005615   000035 116007                    CMPQ    29,DL
        27 005616   005620 602006 27                 TNC     s:16304+6,QL
        27 005617   005754 710000 27                 TRA     s:16332
        27 005620   005655 710000 27                 TRA     s:16306
        27 005621   005754 710000 27                 TRA     s:16332
        27 005622   005754 710000 27                 TRA     s:16332
        27 005623   005754 710000 27                 TRA     s:16332
        27 005624   005754 710000 27                 TRA     s:16332
        27 005625   005754 710000 27                 TRA     s:16332
        27 005626   005754 710000 27                 TRA     s:16332
        27 005627   005754 710000 27                 TRA     s:16332
        27 005630   005754 710000 27                 TRA     s:16332
        27 005631   005754 710000 27                 TRA     s:16332
        27 005632   005754 710000 27                 TRA     s:16332
        27 005633   005754 710000 27                 TRA     s:16332
        27 005634   005754 710000 27                 TRA     s:16332
        27 005635   005754 710000 27                 TRA     s:16332
        27 005636   005660 710000 27                 TRA     s:16308
        27 005637   005754 710000 27                 TRA     s:16332
        27 005640   005754 710000 27                 TRA     s:16332
        27 005641   005754 710000 27                 TRA     s:16332
        27 005642   005754 710000 27                 TRA     s:16332
        27 005643   005754 710000 27                 TRA     s:16332
        27 005644   005754 710000 27                 TRA     s:16332
        27 005645   005754 710000 27                 TRA     s:16332
        27 005646   005754 710000 27                 TRA     s:16332
        27 005647   005704 710000 27                 TRA     s:16316
        27 005650   005754 710000 27                 TRA     s:16332
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:274  
        27 005651   005754 710000 27                 TRA     s:16332
        27 005652   005754 710000 27                 TRA     s:16332
        27 005653   005754 710000 27                 TRA     s:16332
        27 005654   005730 710000 27                 TRA     s:16324

     1424    16305    5                       CASE (%SB2I) ;

     1425    16306    5                         OPERAND_TYPE = %TYI ;

  16306 27 005655   000001 235007                    LDA     1,DL
        27 005656   000037 755000 0                  STA     OPERAND_TYPE
        27 005657   005755 710000 27                 TRA     s:16335

     1426    16307    5                       CASE (%MVHH) ;

     1427    16308    5                         IF TEMP$->ETT.ID ~= %CVIH OR

  16308 27 005660   000110 473400 0                  LDP3    TEMP$
        27 005661   300000 220100                    LDX0    0,,PR3
        27 005662   000035 100003                    CMPX0   29,DU
        27 005663   007521 601000 27                 TNZ     s:16957
        27 005664   300001 474500                    LDP4    1,,PR3
        27 005665   400000 221100                    LDX1    0,,PR4
        27 005666   000056 101003                    CMPX1   46,DU
        27 005667   007521 601000 27                 TNZ     s:16957
        27 005670   400001 475500                    LDP5    1,,PR4
        27 005671   500000 222100                    LDX2    0,,PR5
        27 005672   000134 102003                    CMPX2   92,DU
        27 005673   007521 601000 27                 TNZ     s:16957
        27 005674   500001 236100                    LDQ     1,,PR5
        27 005675   000036 116000 0                  CMPQ    OPERAND$
        27 005676   007521 601000 27                 TNZ     s:16957

     1428    16309    5                             TEMP$->ETT.LOP->ETT.ID ~= %SBI OR
     1429    16310    5                             TEMP$->ETT.LOP->ETT.LOP->ETT.ID ~= %CVHI OR
     1430    16311    5                             TEMP$->ETT.LOP->ETT.LOP->ETT.LOP ~= OPERAND$ THEN
     1431    16312    5                           EXIT CHECK_DO3 ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:275  
     1432    16313    5                         OPERAND_TYPE = %TYH ;

  16313 27 005677   000007 235007                    LDA     7,DL
        27 005700   000037 755000 0                  STA     OPERAND_TYPE

     1433    16314    5                         TEMP$ = TEMP$->ETT.LOP->ETT.ROP ;

  16314 27 005701   400002 236100                    LDQ     2,,PR4
        27 005702   000110 756000 0                  STQ     TEMP$
        27 005703   005755 710000 27                 TRA     s:16335

     1434    16315    5                       CASE (%MVJJ) ;

     1435    16316    5                         IF TEMP$->ETT.ID ~= %CVIJ OR

  16316 27 005704   000110 473400 0                  LDP3    TEMP$
        27 005705   300000 220100                    LDX0    0,,PR3
        27 005706   000145 100003                    CMPX0   101,DU
        27 005707   007521 601000 27                 TNZ     s:16957
        27 005710   300001 474500                    LDP4    1,,PR3
        27 005711   400000 221100                    LDX1    0,,PR4
        27 005712   000056 101003                    CMPX1   46,DU
        27 005713   007521 601000 27                 TNZ     s:16957
        27 005714   400001 475500                    LDP5    1,,PR4
        27 005715   500000 222100                    LDX2    0,,PR5
        27 005716   000133 102003                    CMPX2   91,DU
        27 005717   007521 601000 27                 TNZ     s:16957
        27 005720   500001 236100                    LDQ     1,,PR5
        27 005721   000036 116000 0                  CMPQ    OPERAND$
        27 005722   007521 601000 27                 TNZ     s:16957

     1436    16317    5                             TEMP$->ETT.LOP->ETT.ID ~= %SBI OR
     1437    16318    5                             TEMP$->ETT.LOP->ETT.LOP->ETT.ID ~= %CVJI OR
     1438    16319    5                             TEMP$->ETT.LOP->ETT.LOP->ETT.LOP ~= OPERAND$ THEN
     1439    16320    5                           EXIT CHECK_DO3 ;
     1440    16321    5                         OPERAND_TYPE = %TYJ ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:276  
  16321 27 005723   000002 235007                    LDA     2,DL
        27 005724   000037 755000 0                  STA     OPERAND_TYPE

     1441    16322    5                         TEMP$ = TEMP$->ETT.LOP->ETT.ROP ;

  16322 27 005725   400002 236100                    LDQ     2,,PR4
        27 005726   000110 756000 0                  STQ     TEMP$
        27 005727   005755 710000 27                 TRA     s:16335

     1442    16323    5                       CASE (%MVKK) ;

     1443    16324    5                         IF TEMP$->ETT.ID ~= %CVIK OR

  16324 27 005730   000110 473400 0                  LDP3    TEMP$
        27 005731   300000 220100                    LDX0    0,,PR3
        27 005732   000023 100003                    CMPX0   19,DU
        27 005733   007521 601000 27                 TNZ     s:16957
        27 005734   300001 474500                    LDP4    1,,PR3
        27 005735   400000 221100                    LDX1    0,,PR4
        27 005736   000056 101003                    CMPX1   46,DU
        27 005737   007521 601000 27                 TNZ     s:16957
        27 005740   400001 475500                    LDP5    1,,PR4
        27 005741   500000 222100                    LDX2    0,,PR5
        27 005742   000024 102003                    CMPX2   20,DU
        27 005743   007521 601000 27                 TNZ     s:16957
        27 005744   500001 236100                    LDQ     1,,PR5
        27 005745   000036 116000 0                  CMPQ    OPERAND$
        27 005746   007521 601000 27                 TNZ     s:16957

     1444    16325    5                             TEMP$->ETT.LOP->ETT.ID ~= %SBI OR
     1445    16326    5                             TEMP$->ETT.LOP->ETT.LOP->ETT.ID ~= %CVKI OR
     1446    16327    5                             TEMP$->ETT.LOP->ETT.LOP->ETT.LOP ~= OPERAND$ THEN
     1447    16328    5                           EXIT CHECK_DO3 ;
     1448    16329    5                         OPERAND_TYPE = %TYK ;

  16329 27 005747   000017 235007                    LDA     15,DL
        27 005750   000037 755000 0                  STA     OPERAND_TYPE
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:277  

     1449    16330    5                         TEMP$ = TEMP$->ETT.LOP->ETT.ROP ;

  16330 27 005751   400002 236100                    LDQ     2,,PR4
        27 005752   000110 756000 0                  STQ     TEMP$
        27 005753   005755 710000 27                 TRA     s:16335

     1450    16331    5                       CASE (ELSE) ;

     1451    16332    5                         EXIT CHECK_DO3 ;

  16332 27 005754   007521 710000 27                 TRA     s:16957

     1452    16333    5                     END ; /* CASE */

     1453    16334
     1454    16335    4                     IF TEMP$ ~= COMCOM.VALUE_1 THEN

  16335 27 005755   000110 236000 0                  LDQ     TEMP$
        27 005756   000125 116000 xsym               CMPQ    COMCOM+85
        27 005757   007521 601000 27                 TNZ     s:16957

     1455    16336    4                       EXIT CHECK_DO3 ;
     1456    16337    4                     IF OPERAND$->ETT.ID = %BASE OR OPERAND$->ETT.ID = %OFF THEN;

  16337 27 005760   000036 473400 0                  LDP3    OPERAND$
        27 005761   300000 220100                    LDX0    0,,PR3
        27 005762   000001 100003                    CMPX0   1,DU
        27 005763   005766 600000 27                 TZE     s:16337+6
        27 005764   000003 100003                    CMPX0   3,DU
        27 005765   007521 601000 27                 TNZ     s:16957

  16337 27 005766   005767 710000 27                 TRA     s:16341

     1457    16338                            /* OK, with these triads, optimizable */
     1458    16339    4                     ELSE
     1459    16340    4                       EXIT CHECK_DO3 ; /* Other triads, not optimizable */
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:278  
     1460    16341    4                     SEARCH_DO$ = DO_ILS$ ;

  16341 27 005767   000022 236000 0                  LDQ     DO_ILS$
        27 005770   000017 756000 0                  STQ     SEARCH_DO$

     1461    16342                          /* GO_FLAG = 1 for PERFORM UNTIL <variable> < <constant>
     1462    16343                                         as result = <constant> - 1
     1463    16344                             GO_FLAG = 0 for PERFORM UNTIL <variable> <= <constant>
     1464    16345                                         as result = <constant>
     1465    16346                             GO_FLAG = -1 for PERFORM UNTIL <variable> = <constant>
     1466    16347                                         as this unconditionally sets result
     1467    16348                                         = <constant> regardless of prior value */
     1468    16349    4                     IF ILL$->DO_N.B.TEST_AFTER THEN

  16349 27 005771   000000 474400 10                 LDP4    ILL$
        27 005772   400000 236100                    LDQ     0,,PR4
        27 005773   400000 316007                    CANQ    -131072,DL
        27 005774   006057 600000 27                 TZE     s:16403

     1469    16350    5                       DO ;

     1470    16351                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;

  16356 27 005775   000022 470400 0                  LDP0    DO_ILS$
        27 005776   000002 236100                    LDQ     2,,PR0
        27 005777   000022 756000 0                  STQ     DO_ILS$

  16359 27 006000   000022 470400 0                  LDP0    DO_ILS$
        27 006001   000003 236100                    LDQ     3,,PR0
        27 006002   000000 116000 28                 CMPQ    0
        27 006003   005775 600000 27                 TZE     s:16356
        27 006004   000003 471500                    LDP1    3,,PR0
        27 006005   100000 220100                    LDX0    0,,PR1
        27 006006   000373 100003                    CMPX0   251,DU
        27 006007   005775 600000 27                 TZE     s:16356

     1471    16361    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %GO OR
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:279  

  16361 27 006010   000344 100003                    CMPX0   228,DU
        27 006011   007521 601000 27                 TNZ     s:16957
        27 006012   100001 236100                    LDQ     1,,PR1
        27 006013   000005 116000 0                  CMPQ    START_LABEL$
        27 006014   007521 601000 27                 TNZ     s:16957

     1472    16362    5                             DO_ILS$->ILS.ILL$->ILL.LOP ~= START_LABEL$ THEN
     1473    16363    5                           EXIT CHECK_DO3 ;
     1474    16364    5                         GO_ILS$ = DO_ILS$ ;

  16364 27 006015   000022 236000 0                  LDQ     DO_ILS$
        27 006016   000015 756000 0                  STQ     GO_ILS$

     1475    16365                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;

  16370 27 006017   000022 470400 0                  LDP0    DO_ILS$
        27 006020   000002 236100                    LDQ     2,,PR0
        27 006021   000022 756000 0                  STQ     DO_ILS$

  16373 27 006022   000022 470400 0                  LDP0    DO_ILS$
        27 006023   000003 236100                    LDQ     3,,PR0
        27 006024   000000 116000 28                 CMPQ    0
        27 006025   006017 600000 27                 TZE     s:16370
        27 006026   000003 471500                    LDP1    3,,PR0
        27 006027   100000 220100                    LDX0    0,,PR1
        27 006030   000373 100003                    CMPX0   251,DU
        27 006031   006017 600000 27                 TZE     s:16370

     1476    16375    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %DOEND THEN

  16375 27 006032   000403 100003                    CMPX0   259,DU
        27 006033   007521 601000 27                 TNZ     s:16957

     1477    16376    5                           EXIT CHECK_DO3 ;
     1478    16377    5                         IF GO_ILS$->ILS.ILL$->ILL.CODE = %GO_LESS_THAN_OR_EQUAL OR

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:280  
  16377 27 006034   000015 473400 0                  LDP3    GO_ILS$
        27 006035   300003 474500                    LDP4    3,,PR3
        27 006036   400000 721100                    LXL1    0,,PR4
        27 006037   000005 101003                    CMPX1   5,DU
        27 006040   006043 600000 27                 TZE     s:16379
        27 006041   000007 101003                    CMPX1   7,DU
        27 006042   006046 601000 27                 TNZ     s:16382

     1479    16378    5                             GO_ILS$->ILS.ILL$->ILL.CODE = %GO_GREATER_THAN_OR_EQUAL
     1480    16379    5                           THEN GO_FLAG = 1 ;

  16379 27 006043   000001 235007                    LDA     1,DL
        27 006044   000050 755000 0                  STA     GO_FLAG
        27 006045   006155 710000 27                 TRA     s:16449

     1481    16380    5                         ELSE
     1482    16381    6                           DO ;

     1483    16382    6                             IF GO_ILS$->ILS.ILL$->ILL.CODE = %GO_NOT_EQUAL THEN

  16382 27 006046   000012 101003                    CMPX1   10,DU
        27 006047   006055 601000 27                 TNZ     s:16393

     1484    16383    7                               DO ;

     1485    16384                                      /* Need ILS after that for DOEND */
     1486    16385                                      %NEXT_ILS(POINTER=DO_ILS$) ;

  16387 27 006050   000002 236100                    LDQ     2,,PR0
        27 006051   000022 756000 0                  STQ     DO_ILS$

     1487    16390    7                                 GO_FLAG = -1 ;

  16390 27 006052   000001 335007                    LCA     1,DL
        27 006053   000050 755000 0                  STA     GO_FLAG

     1488    16391    7                               END ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:281  

  16391 27 006054   006155 710000 27                 TRA     s:16449

     1489    16392    6                               ELSE /* Need ILS for DOEND, will reuse */
     1490    16393    6                                 GO_FLAG = 0 ;

  16393 27 006055   000050 450000 0                  STZ     GO_FLAG

     1491    16394    6                           END ;

     1492    16395    5                       END ;

  16395 27 006056   006155 710000 27                 TRA     s:16449

     1493    16396    4                     ELSE
     1494    16397    5                       DO ; /* TEST BEFORE or default */

     1495    16398                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;

  16403 27 006057   000022 470400 0                  LDP0    DO_ILS$
        27 006060   000002 236100                    LDQ     2,,PR0
        27 006061   000022 756000 0                  STQ     DO_ILS$

  16406 27 006062   000022 470400 0                  LDP0    DO_ILS$
        27 006063   000003 236100                    LDQ     3,,PR0
        27 006064   000000 116000 28                 CMPQ    0
        27 006065   006057 600000 27                 TZE     s:16403
        27 006066   000003 471500                    LDP1    3,,PR0
        27 006067   100000 220100                    LDX0    0,,PR1
        27 006070   000373 100003                    CMPX0   251,DU
        27 006071   006057 600000 27                 TZE     s:16403

     1496    16408    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %GO THEN

  16408 27 006072   000344 100003                    CMPX0   228,DU
        27 006073   007521 601000 27                 TNZ     s:16957

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:282  
     1497    16409    5                           EXIT CHECK_DO3 ;
     1498    16410                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;

  16415 27 006074   000022 470400 0                  LDP0    DO_ILS$
        27 006075   000002 236100                    LDQ     2,,PR0
        27 006076   000022 756000 0                  STQ     DO_ILS$

  16418 27 006077   000022 470400 0                  LDP0    DO_ILS$
        27 006100   000003 236100                    LDQ     3,,PR0
        27 006101   000000 116000 28                 CMPQ    0
        27 006102   006074 600000 27                 TZE     s:16415
        27 006103   000003 471500                    LDP1    3,,PR0
        27 006104   100000 220100                    LDX0    0,,PR1
        27 006105   000373 100003                    CMPX0   251,DU
        27 006106   006074 600000 27                 TZE     s:16415

     1499    16420    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %DEFLB OR

  16420 27 006107   000346 100003                    CMPX0   230,DU
        27 006110   007521 601000 27                 TNZ     s:16957
        27 006111   100001 236100                    LDQ     1,,PR1
        27 006112   000007 116000 0                  CMPQ    END_LABEL$
        27 006113   007521 601000 27                 TNZ     s:16957

     1500    16421    5                             DO_ILS$->ILS.ILL$->ILL.LOP ~= END_LABEL$ THEN
     1501    16422    5                           EXIT CHECK_DO3 ;
     1502    16423    5                         END_LABEL_ILS$ = DO_ILS$ ;

  16423 27 006114   000022 236000 0                  LDQ     DO_ILS$
        27 006115   000010 756000 0                  STQ     END_LABEL_ILS$

     1503    16424                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;

  16429 27 006116   000022 470400 0                  LDP0    DO_ILS$
        27 006117   000002 236100                    LDQ     2,,PR0
        27 006120   000022 756000 0                  STQ     DO_ILS$

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:283  
  16432 27 006121   000022 470400 0                  LDP0    DO_ILS$
        27 006122   000003 236100                    LDQ     3,,PR0
        27 006123   000000 116000 28                 CMPQ    0
        27 006124   006116 600000 27                 TZE     s:16429
        27 006125   000003 471500                    LDP1    3,,PR0
        27 006126   100000 220100                    LDX0    0,,PR1
        27 006127   000373 100003                    CMPX0   251,DU
        27 006130   006116 600000 27                 TZE     s:16429

     1504    16434    5                         IF DO_ILS$->ILS.ILL$->ILL.ID ~= %DOEND THEN

  16434 27 006131   000403 100003                    CMPX0   259,DU
        27 006132   007521 601000 27                 TNZ     s:16957

     1505    16435    5                           EXIT CHECK_DO3 ;
     1506    16436                              %NEXT_ILS(POINTER=DO_ILS$) ; /* Need ILS after DOEND */

  16438 27 006133   000002 236100                    LDQ     2,,PR0
        27 006134   000022 756000 0                  STQ     DO_ILS$

     1507    16441    5                         IF GO_ILS$->ILS.ILL$->ILL.CODE = %GO_LESS_THAN OR

  16441 27 006135   000015 470400 0                  LDP0    GO_ILS$
        27 006136   000003 471500                    LDP1    3,,PR0
        27 006137   100000 720100                    LXL0    0,,PR1
        27 006140   000001 100003                    CMPX0   1,DU
        27 006141   006144 600000 27                 TZE     s:16443
        27 006142   000003 100003                    CMPX0   3,DU
        27 006143   006147 601000 27                 TNZ     s:16444

     1508    16442    5                             GO_ILS$->ILS.ILL$->ILL.CODE = %GO_GREATER_THAN
     1509    16443    5                           THEN GO_FLAG = 1 ;

  16443 27 006144   000001 235007                    LDA     1,DL
        27 006145   000050 755000 0                  STA     GO_FLAG
        27 006146   006155 710000 27                 TRA     s:16449

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:284  
     1510    16444    5                           ELSE IF GO_ILS$->ILS.ILL$->ILL.CODE = %GO_EQUAL

  16444 27 006147   000011 100003                    CMPX0   9,DU
        27 006150   006154 601000 27                 TNZ     s:16446

     1511    16445    5                             THEN GO_FLAG = -1 ;

  16445 27 006151   000001 335007                    LCA     1,DL
        27 006152   000050 755000 0                  STA     GO_FLAG
        27 006153   006155 710000 27                 TRA     s:16449

     1512    16446    5                             ELSE GO_FLAG = 0 ;

  16446 27 006154   000050 450000 0                  STZ     GO_FLAG

     1513    16447    5                       END ;

     1514    16448
     1515    16449    4                     TEMP$ = GO_ILS$->ILS.ILL$->ILL.ROP ;

  16449 27 006155   000015 470400 0                  LDP0    GO_ILS$
        27 006156   000003 471500                    LDP1    3,,PR0
        27 006157   100002 236100                    LDQ     2,,PR1
        27 006160   000110 756000 0                  STQ     TEMP$

     1516    16450    4                     IF TEMP$ = ADDR(NIL) OR

  16450 27 006161   000000 116000 28                 CMPQ    0
        27 006162   007521 600000 27                 TZE     s:16957
        27 006163   000110 473400 0                  LDP3    TEMP$
        27 006164   300000 220100                    LDX0    0,,PR3
        27 006165   000106 100003                    CMPX0   70,DU
        27 006166   007521 601000 27                 TNZ     s:16957

     1517    16451    4                         TEMP$->ETT.ID ~= %CMPI THEN
     1518    16452    4                       EXIT CHECK_DO3 ;
     1519    16453    4                     IF TEMP$->ETT.LOP->ETT.ID = %TRIAD THEN
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:285  

  16453 27 006167   300001 474500                    LDP4    1,,PR3
        27 006170   400000 221100                    LDX1    0,,PR4
        27 006171   000015 101003                    CMPX1   13,DU
        27 006172   006200 601000 27                 TNZ     s:16460

     1520    16454    5                       DO ;

     1521    16455    5                         CONST$ = TEMP$->ETT.LOP ;

  16455 27 006173   300001 236100                    LDQ     1,,PR3
        27 006174   000035 756000 0                  STQ     CONST$

     1522    16456    5                         TEMP$ = TEMP$->ETT.ROP ;

  16456 27 006175   300002 236100                    LDQ     2,,PR3
        27 006176   000110 756000 0                  STQ     TEMP$

     1523    16457    5                       END ;

  16457 27 006177   006210 710000 27                 TRA     s:16465

     1524    16458    4                     ELSE
     1525    16459    5                       DO ;

     1526    16460    5                         IF TEMP$->ETT.ROP->ETT.ID ~= %TRIAD THEN

  16460 27 006200   300002 475500                    LDP5    2,,PR3
        27 006201   500000 222100                    LDX2    0,,PR5
        27 006202   000015 102003                    CMPX2   13,DU
        27 006203   007521 601000 27                 TNZ     s:16957

     1527    16461    5                           EXIT CHECK_DO3 ;
     1528    16462    5                         CONST$ = TEMP$->ETT.ROP ;

  16462 27 006204   300002 236100                    LDQ     2,,PR3
        27 006205   000035 756000 0                  STQ     CONST$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:286  

     1529    16463    5                         TEMP$ = TEMP$->ETT.LOP ;

  16463 27 006206   300001 236100                    LDQ     1,,PR3
        27 006207   000110 756000 0                  STQ     TEMP$

     1530    16464    5                       END ;

     1531    16465    5                     DO CASE (TEMP$->ETT.ID) ;

  16465 27 006210   000110 473400 0                  LDP3    TEMP$
        27 006211   300000 236100                    LDQ     0,,PR3
        27 006212   000022 772000                    QRL     18
        27 006213   000024 136007                    SBLQ    20,DL
        27 006214   000111 116007                    CMPQ    73,DL
        27 006215   006217 602006 27                 TNC     s:16465+7,QL
        27 006216   006332 710000 27                 TRA     s:16469
        27 006217   006330 710000 27                 TRA     s:16467
        27 006220   006332 710000 27                 TRA     s:16469
        27 006221   006332 710000 27                 TRA     s:16469
        27 006222   006332 710000 27                 TRA     s:16469
        27 006223   006332 710000 27                 TRA     s:16469
        27 006224   006332 710000 27                 TRA     s:16469
        27 006225   006332 710000 27                 TRA     s:16469
        27 006226   006332 710000 27                 TRA     s:16469
        27 006227   006332 710000 27                 TRA     s:16469
        27 006230   006332 710000 27                 TRA     s:16469
        27 006231   006332 710000 27                 TRA     s:16469
        27 006232   006332 710000 27                 TRA     s:16469
        27 006233   006332 710000 27                 TRA     s:16469
        27 006234   006332 710000 27                 TRA     s:16469
        27 006235   006332 710000 27                 TRA     s:16469
        27 006236   006332 710000 27                 TRA     s:16469
        27 006237   006332 710000 27                 TRA     s:16469
        27 006240   006332 710000 27                 TRA     s:16469
        27 006241   006332 710000 27                 TRA     s:16469
        27 006242   006332 710000 27                 TRA     s:16469
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:287  
        27 006243   006332 710000 27                 TRA     s:16469
        27 006244   006332 710000 27                 TRA     s:16469
        27 006245   006332 710000 27                 TRA     s:16469
        27 006246   006332 710000 27                 TRA     s:16469
        27 006247   006332 710000 27                 TRA     s:16469
        27 006250   006332 710000 27                 TRA     s:16469
        27 006251   006332 710000 27                 TRA     s:16469
        27 006252   006332 710000 27                 TRA     s:16469
        27 006253   006332 710000 27                 TRA     s:16469
        27 006254   006332 710000 27                 TRA     s:16469
        27 006255   006332 710000 27                 TRA     s:16469
        27 006256   006332 710000 27                 TRA     s:16469
        27 006257   006332 710000 27                 TRA     s:16469
        27 006260   006332 710000 27                 TRA     s:16469
        27 006261   006332 710000 27                 TRA     s:16469
        27 006262   006332 710000 27                 TRA     s:16469
        27 006263   006332 710000 27                 TRA     s:16469
        27 006264   006332 710000 27                 TRA     s:16469
        27 006265   006332 710000 27                 TRA     s:16469
        27 006266   006332 710000 27                 TRA     s:16469
        27 006267   006332 710000 27                 TRA     s:16469
        27 006270   006332 710000 27                 TRA     s:16469
        27 006271   006332 710000 27                 TRA     s:16469
        27 006272   006332 710000 27                 TRA     s:16469
        27 006273   006332 710000 27                 TRA     s:16469
        27 006274   006332 710000 27                 TRA     s:16469
        27 006275   006332 710000 27                 TRA     s:16469
        27 006276   006332 710000 27                 TRA     s:16469
        27 006277   006332 710000 27                 TRA     s:16469
        27 006300   006332 710000 27                 TRA     s:16469
        27 006301   006332 710000 27                 TRA     s:16469
        27 006302   006332 710000 27                 TRA     s:16469
        27 006303   006332 710000 27                 TRA     s:16469
        27 006304   006332 710000 27                 TRA     s:16469
        27 006305   006332 710000 27                 TRA     s:16469
        27 006306   006332 710000 27                 TRA     s:16469
        27 006307   006332 710000 27                 TRA     s:16469
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:288  
        27 006310   006332 710000 27                 TRA     s:16469
        27 006311   006332 710000 27                 TRA     s:16469
        27 006312   006332 710000 27                 TRA     s:16469
        27 006313   006332 710000 27                 TRA     s:16469
        27 006314   006332 710000 27                 TRA     s:16469
        27 006315   006332 710000 27                 TRA     s:16469
        27 006316   006332 710000 27                 TRA     s:16469
        27 006317   006332 710000 27                 TRA     s:16469
        27 006320   006332 710000 27                 TRA     s:16469
        27 006321   006332 710000 27                 TRA     s:16469
        27 006322   006332 710000 27                 TRA     s:16469
        27 006323   006332 710000 27                 TRA     s:16469
        27 006324   006332 710000 27                 TRA     s:16469
        27 006325   006332 710000 27                 TRA     s:16469
        27 006326   006330 710000 27                 TRA     s:16467
        27 006327   006330 710000 27                 TRA     s:16467

     1532    16466    5                       CASE (%CVHI, %CVJI, %CVKI) ;

     1533    16467    5                         TEMP$ = TEMP$->ETT.LOP ;

  16467 27 006330   300001 236100                    LDQ     1,,PR3
        27 006331   000110 756000 0                  STQ     TEMP$

     1534    16468    5                     END ; /* CASE */

     1535    16469    4                     IF TEMP$ ~= OPERAND$ THEN

  16469 27 006332   000110 236000 0                  LDQ     TEMP$
        27 006333   000036 116000 0                  CMPQ    OPERAND$
        27 006334   007521 601000 27                 TNZ     s:16957

     1536    16470    4                       EXIT CHECK_DO3 ;
     1537    16471    4                     OPTIMIZE_DO3 = TRUE ;

  16471 27 006335   400000 236003                    LDQ     -131072,DU
        27 006336   000045 756000 0                  STQ     OPTIMIZE_DO3
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:289  

     1538    16472    4                     IF ILL$->DO_N.B.TEST_AFTER AND

  16472 27 006337   000000 473400 10                 LDP3    ILL$
        27 006340   300000 236100                    LDQ     0,,PR3
        27 006341   400000 316007                    CANQ    -131072,DL
        27 006342   006724 600000 27                 TZE     s:16662
        27 006343   100000 720100                    LXL0    0,,PR1
        27 006344   000012 100003                    CMPX0   10,DU
        27 006345   006724 600000 27                 TZE     s:16662

     1539    16473    4                         GO_ILS$->ILS.ILL$->ILL.CODE ~= %GO_NOT_EQUAL THEN
     1540    16474    5                       DO ;

     1541    16475    5                         TEMP$ = PREV_ILS$ ;

  16475 27 006346   000001 236000 0                  LDQ     PREV_ILS$
        27 006347   000110 756000 0                  STQ     TEMP$

     1542    16476                              %NEXT_ILS(POINTER=TEMP$) ; /* ILS for LINOI */

  16478 27 006350   000110 474400 0                  LDP4    TEMP$
        27 006351   400002 236100                    LDQ     2,,PR4
        27 006352   000110 756000 0                  STQ     TEMP$

     1543    16481    5                         TEMP$->ILS.NEXT = GO_ILS$ ;

  16481 27 006353   000015 236000 0                  LDQ     GO_ILS$
        27 006354   000110 474400 0                  LDP4    TEMP$
        27 006355   400002 756100                    STQ     2,,PR4

     1544    16482    5                         ILS$ = GO_ILS$ ;

  16482 27 006356   000000 756000 6                  STQ     ILS$

     1545    16483    5                         GO_ILS$->ILS.NEXT = DO_LINOI$ ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:290  
  16483 27 006357   000023 236000 0                  LDQ     DO_LINOI$
        27 006360   000002 756100                    STQ     2,,PR0

     1546    16484                              %RESERVE_ILS(ITEM=%OPN,POINTER=SEARCH_DO$->ILS.NEXT) ;

  16504 27 006361   000002 236000 7                  LDQ     ILS_+2
        27 006362   000004 036007                    ADLQ    4,DL
        27 006363   000003 116000 7                  CMPQ    ILS_+3
        27 006364   006375 602000 27                 TNC     s:16506

  16505 27 006365   000002 236000 28                 LDQ     2
        27 006366   000130 756000 0                  STQ     OPT_FLAG+1
        27 006367   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 006370   000131 451400 0                  STP1    OPT_FLAG+2
        27 006371   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 006372   000001 631400 28                 EPPR1   1
        27 006373   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 006374   000000 011000                    NOP     0

  16506 27 006375   000002 236000 7                  LDQ     ILS_+2
        27 006376   000022 736000                    QLS     18
        27 006377   000001 036000 7                  ADLQ    ILS_+1
        27 006400   000017 470400 0                  LDP0    SEARCH_DO$
        27 006401   000002 756100                    STQ     2,,PR0

  16507 27 006402   000002 235000 7                  LDA     ILS_+2
        27 006403   000004 035007                    ADLA    4,DL
        27 006404   000002 755000 7                  STA     ILS_+2

  16508 27 006405   000002 471500                    LDP1    2,,PR0
        27 006406   000740 220003                    LDX0    480,DU
        27 006407   100000 740100                    STX0    0,,PR1

  16509 27 006410   000002 471500                    LDP1    2,,PR0
        27 006411   000000 236000 28                 LDQ     0
        27 006412   100002 756100                    STQ     2,,PR1

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:291  
     1547    16513                              %NEXT_ILS(POINTER=SEARCH_DO$) ;

  16515 27 006413   000002 236100                    LDQ     2,,PR0
        27 006414   000017 756000 0                  STQ     SEARCH_DO$

     1548    16518                              %RESERVE_ILL(ITEM=%LINOI,POINTER=SEARCH_DO$->ILS.ILL$) ;

  16520 27 006415   000145 235000 xsym               LDA     ILL_STEP+101
        27 006416   000000 755000 1                  STA     ITERATION

  16521 27 006417   000002 236000 11                 LDQ     ILL_+2
        27 006420   000000 036000 1                  ADLQ    ITERATION
        27 006421   000003 116000 11                 CMPQ    ILL_+3
        27 006422   006433 604000 27                 TMI     s:16523

  16522 27 006423   000003 236000 28                 LDQ     3
        27 006424   000130 756000 0                  STQ     OPT_FLAG+1
        27 006425   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 006426   000131 450400 0                  STP0    OPT_FLAG+2
        27 006427   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 006430   000001 631400 28                 EPPR1   1
        27 006431   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 006432   000000 011000                    NOP     0

  16523 27 006433   000002 236000 11                 LDQ     ILL_+2
        27 006434   000022 736000                    QLS     18
        27 006435   000001 036000 11                 ADLQ    ILL_+1
        27 006436   000017 470400 0                  LDP0    SEARCH_DO$
        27 006437   000003 756100                    STQ     3,,PR0

  16524 27 006440   000002 236000 11                 LDQ     ILL_+2
        27 006441   000000 036000 1                  ADLQ    ITERATION
        27 006442   000002 756000 11                 STQ     ILL_+2

  16525 27 006443   000003 471500                    LDP1    3,,PR0
        27 006444   000373 220003                    LDX0    251,DU
        27 006445   100000 740100                    STX0    0,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:292  

     1549    16528    5                         SEARCH_DO$->ILS.ILL$->LINOI = DO_LINOI$->ILS.ILL$->LINOI ;

  16528 27 006446   000003 471500                    LDP1    3,,PR0
        27 006447   000023 473400 0                  LDP3    DO_LINOI$
        27 006450   300003 474500                    LDP4    3,,PR3
        27 006451   000100 100500                    MLR     fill='000'O
        27 006452   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        27 006453   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

     1550    16529                              %RESERVE_ILS(ITEM=%OPN,POINTER=SEARCH_DO$->ILS.NEXT) ;

  16549 27 006454   000002 236000 7                  LDQ     ILS_+2
        27 006455   000004 036007                    ADLQ    4,DL
        27 006456   000003 116000 7                  CMPQ    ILS_+3
        27 006457   006470 602000 27                 TNC     s:16551

  16550 27 006460   000002 236000 28                 LDQ     2
        27 006461   000130 756000 0                  STQ     OPT_FLAG+1
        27 006462   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 006463   000131 451400 0                  STP1    OPT_FLAG+2
        27 006464   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 006465   000001 631400 28                 EPPR1   1
        27 006466   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 006467   000000 011000                    NOP     0

  16551 27 006470   000002 236000 7                  LDQ     ILS_+2
        27 006471   000022 736000                    QLS     18
        27 006472   000001 036000 7                  ADLQ    ILS_+1
        27 006473   000017 470400 0                  LDP0    SEARCH_DO$
        27 006474   000002 756100                    STQ     2,,PR0

  16552 27 006475   000002 235000 7                  LDA     ILS_+2
        27 006476   000004 035007                    ADLA    4,DL
        27 006477   000002 755000 7                  STA     ILS_+2

  16553 27 006500   000002 471500                    LDP1    2,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:293  
        27 006501   000740 220003                    LDX0    480,DU
        27 006502   100000 740100                    STX0    0,,PR1

  16554 27 006503   000002 471500                    LDP1    2,,PR0
        27 006504   000000 236000 28                 LDQ     0
        27 006505   100002 756100                    STQ     2,,PR1

     1551    16558                              %NEXT_ILS(POINTER=SEARCH_DO$);

  16560 27 006506   000002 236100                    LDQ     2,,PR0
        27 006507   000017 756000 0                  STQ     SEARCH_DO$

     1552    16563    5                         CALL Z8AT$CREATE_TEMPORARY (%PARA,CREATED_LABEL$) ;

  16563 27 006510   000021 630400 28                 EPPR0   17
        27 006511   000005 631400 28                 EPPR1   5
        27 006512   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        27 006513   000000 011000                    NOP     0

     1553    16564    5                         CREATED_LABEL$->LABEL.B.REFERENCED = TRUE ;

  16564 27 006514   000030 470400 0                  LDP0    LABEL_CHECK$
        27 006515   400000 236003                    LDQ     -131072,DU
        27 006516   000003 256100                    ORSQ    3,,PR0

     1554    16565    5                         CREATED_LABEL$->LABEL.B.ONE_REF = TRUE ;

  16565 27 006517   000030 470400 0                  LDP0    LABEL_CHECK$
        27 006520   010000 236003                    LDQ     4096,DU
        27 006521   000003 256100                    ORSQ    3,,PR0

     1555    16566    5                         CREATED_LABEL$->LABEL.B.GOTO_LABEL = TRUE ;

  16566 27 006522   000030 470400 0                  LDP0    LABEL_CHECK$
        27 006523   040000 236003                    LDQ     16384,DU
        27 006524   000003 256100                    ORSQ    3,,PR0

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:294  
     1556    16567                              %RESERVE_ILL(ITEM=%GO,POINTER=SEARCH_DO$->ILS.ILL$) ;

  16569 27 006525   000116 235000 xsym               LDA     ILL_STEP+78
        27 006526   000000 755000 1                  STA     ITERATION

  16570 27 006527   000002 236000 11                 LDQ     ILL_+2
        27 006530   000000 036000 1                  ADLQ    ITERATION
        27 006531   000003 116000 11                 CMPQ    ILL_+3
        27 006532   006543 604000 27                 TMI     s:16572

  16571 27 006533   000003 236000 28                 LDQ     3
        27 006534   000130 756000 0                  STQ     OPT_FLAG+1
        27 006535   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 006536   000131 450400 0                  STP0    OPT_FLAG+2
        27 006537   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 006540   000001 631400 28                 EPPR1   1
        27 006541   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 006542   000000 011000                    NOP     0

  16572 27 006543   000002 236000 11                 LDQ     ILL_+2
        27 006544   000022 736000                    QLS     18
        27 006545   000001 036000 11                 ADLQ    ILL_+1
        27 006546   000017 470400 0                  LDP0    SEARCH_DO$
        27 006547   000003 756100                    STQ     3,,PR0

  16573 27 006550   000002 236000 11                 LDQ     ILL_+2
        27 006551   000000 036000 1                  ADLQ    ITERATION
        27 006552   000002 756000 11                 STQ     ILL_+2

  16574 27 006553   000003 471500                    LDP1    3,,PR0
        27 006554   000344 220003                    LDX0    228,DU
        27 006555   100000 740100                    STX0    0,,PR1

     1557    16577    5                         SEARCH_DO$->ILS.ILL$->ILL.LOP = CREATED_LABEL$ ;

  16577 27 006556   000003 471500                    LDP1    3,,PR0
        27 006557   000030 236000 0                  LDQ     LABEL_CHECK$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:295  
        27 006560   100001 756100                    STQ     1,,PR1

     1558    16578    5                         SEARCH_DO$->ILS.ILL$->ILL.ROP = ADDR(NIL) ;

  16578 27 006561   000003 471500                    LDP1    3,,PR0
        27 006562   000000 236000 28                 LDQ     0
        27 006563   100002 756100                    STQ     2,,PR1

     1559    16579    5                         SEARCH_DO$->ILS.NEXT = ILS$$ ; /* ADDR of ILS for LINOI

  16579 27 006564   000060 236000 0                  LDQ     ILS$$
        27 006565   000002 756100                    STQ     2,,PR0

     1560    16580                                                                of START_LABEL$ */
     1561    16581    5                         START_LABEL_ILS$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ =
             16581                                  SEARCH_DO$ ;

  16581 27 006566   000006 471400 0                  LDP1    START_LABEL_ILS$
        27 006567   100003 473500                    LDP3    3,,PR1
        27 006570   300001 474500                    LDP4    1,,PR3
        27 006571   000017 236000 0                  LDQ     SEARCH_DO$
        27 006572   400010 756100                    STQ     8,,PR4

     1562    16582                              %RESERVE_ILS(ITEM=%OPN,POINTER=START_LABEL_ILS$->ILS.NEXT) ;

  16602 27 006573   000002 236000 7                  LDQ     ILS_+2
        27 006574   000004 036007                    ADLQ    4,DL
        27 006575   000003 116000 7                  CMPQ    ILS_+3
        27 006576   006607 602000 27                 TNC     s:16604

  16603 27 006577   000002 236000 28                 LDQ     2
        27 006600   000130 756000 0                  STQ     OPT_FLAG+1
        27 006601   000130 633400 0                  EPPR3   OPT_FLAG+1
        27 006602   000131 453400 0                  STP3    OPT_FLAG+2
        27 006603   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 006604   000001 631400 28                 EPPR1   1
        27 006605   000000 701000 xent               TSX1    Z8AR$RESERVER
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:296  
        27 006606   000000 011000                    NOP     0

  16604 27 006607   000002 236000 7                  LDQ     ILS_+2
        27 006610   000022 736000                    QLS     18
        27 006611   000001 036000 7                  ADLQ    ILS_+1
        27 006612   000006 470400 0                  LDP0    START_LABEL_ILS$
        27 006613   000002 756100                    STQ     2,,PR0

  16605 27 006614   000002 235000 7                  LDA     ILS_+2
        27 006615   000004 035007                    ADLA    4,DL
        27 006616   000002 755000 7                  STA     ILS_+2

  16606 27 006617   000002 471500                    LDP1    2,,PR0
        27 006620   000740 220003                    LDX0    480,DU
        27 006621   100000 740100                    STX0    0,,PR1

  16607 27 006622   000002 471500                    LDP1    2,,PR0
        27 006623   000000 236000 28                 LDQ     0
        27 006624   100002 756100                    STQ     2,,PR1

     1563    16611                              %NEXT_ILS(POINTER=START_LABEL_ILS$) ;

  16613 27 006625   000002 236100                    LDQ     2,,PR0
        27 006626   000006 756000 0                  STQ     START_LABEL_ILS$

     1564    16616                             %RESERVE_ILL(ITEM=%LINOI,POINTER=START_LABEL_ILS$->ILS.ILL$) ;

  16618 27 006627   000145 235000 xsym               LDA     ILL_STEP+101
        27 006630   000000 755000 1                  STA     ITERATION

  16619 27 006631   000002 236000 11                 LDQ     ILL_+2
        27 006632   000000 036000 1                  ADLQ    ITERATION
        27 006633   000003 116000 11                 CMPQ    ILL_+3
        27 006634   006645 604000 27                 TMI     s:16621

  16620 27 006635   000003 236000 28                 LDQ     3
        27 006636   000130 756000 0                  STQ     OPT_FLAG+1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:297  
        27 006637   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 006640   000131 450400 0                  STP0    OPT_FLAG+2
        27 006641   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 006642   000001 631400 28                 EPPR1   1
        27 006643   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 006644   000000 011000                    NOP     0

  16621 27 006645   000002 236000 11                 LDQ     ILL_+2
        27 006646   000022 736000                    QLS     18
        27 006647   000001 036000 11                 ADLQ    ILL_+1
        27 006650   000006 470400 0                  LDP0    START_LABEL_ILS$
        27 006651   000003 756100                    STQ     3,,PR0

  16622 27 006652   000002 236000 11                 LDQ     ILL_+2
        27 006653   000000 036000 1                  ADLQ    ITERATION
        27 006654   000002 756000 11                 STQ     ILL_+2

  16623 27 006655   000003 471500                    LDP1    3,,PR0
        27 006656   000373 220003                    LDX0    251,DU
        27 006657   100000 740100                    STX0    0,,PR1

     1565    16626    5                         START_LABEL_ILS$->ILS.ILL$->LINOI =

  16626 27 006660   000003 471500                    LDP1    3,,PR0
        27 006661   000023 473400 0                  LDP3    DO_LINOI$
        27 006662   300003 474500                    LDP4    3,,PR3
        27 006663   000100 100500                    MLR     fill='000'O
        27 006664   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        27 006665   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

     1566    16627    5                             DO_LINOI$->ILS.ILL$->LINOI ;
     1567    16628                              %RESERVE_ILS(ITEM=%OPV,POINTER=SEARCH_DO$) ;

  16648 27 006666   000002 236000 7                  LDQ     ILS_+2
        27 006667   000005 036007                    ADLQ    5,DL
        27 006670   000003 116000 7                  CMPQ    ILS_+3
        27 006671   006702 602000 27                 TNC     s:16650
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:298  

  16649 27 006672   000002 236000 28                 LDQ     2
        27 006673   000130 756000 0                  STQ     OPT_FLAG+1
        27 006674   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 006675   000131 451400 0                  STP1    OPT_FLAG+2
        27 006676   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 006677   000001 631400 28                 EPPR1   1
        27 006700   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 006701   000000 011000                    NOP     0

  16650 27 006702   000002 236000 7                  LDQ     ILS_+2
        27 006703   000022 736000                    QLS     18
        27 006704   000001 036000 7                  ADLQ    ILS_+1
        27 006705   000017 756000 0                  STQ     SEARCH_DO$

  16651 27 006706   000002 235000 7                  LDA     ILS_+2
        27 006707   000005 035007                    ADLA    5,DL
        27 006710   000002 755000 7                  STA     ILS_+2

  16652 27 006711   000741 220003                    LDX0    481,DU
        27 006712   000017 470400 0                  LDP0    SEARCH_DO$
        27 006713   000000 740100                    STX0    0,,PR0

  16653 27 006714   000000 236000 28                 LDQ     0
        27 006715   000002 756100                    STQ     2,,PR0

     1568    16657    5                         SEARCH_DO$->ILS.DEF = OPERAND$ ;

  16657 27 006716   000036 236000 0                  LDQ     OPERAND$
        27 006717   000004 756100                    STQ     4,,PR0

     1569    16658    5                         START_LABEL_ILS$->ILS.NEXT = SEARCH_DO$ ;

  16658 27 006720   000017 236000 0                  LDQ     SEARCH_DO$
        27 006721   000006 471400 0                  LDP1    START_LABEL_ILS$
        27 006722   100002 756100                    STQ     2,,PR1

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:299  
     1570    16659    5                       END ; /* TEST AFTER */

  16659 27 006723   006753 710000 27                 TRA     s:16678

     1571    16660    4                     ELSE
     1572    16661    5                       DO ; /* TEST BEFORE or test for equality or default */

     1573    16662    5                         IF GO_FLAG >= 0 THEN

  16662 27 006724   000050 235000 0                  LDA     GO_FLAG
        27 006725   006737 604000 27                 TMI     s:16670

     1574    16663    6                           DO ;

     1575    16664    6                             PREV_ILS$->ILS.NEXT = ILS$$ ;

  16664 27 006726   000060 236000 0                  LDQ     ILS$$
        27 006727   000001 474400 0                  LDP4    PREV_ILS$
        27 006730   400002 756100                    STQ     2,,PR4

     1576    16665    6                             ILS$$->ILS.NEXT = GO_ILS$ ;

  16665 27 006731   000015 236000 0                  LDQ     GO_ILS$
        27 006732   000060 471400 0                  LDP1    ILS$$
        27 006733   100002 756100                    STQ     2,,PR1

     1577    16666    6                             GO_ILS$->ILS.NEXT = DO_LINOI$ ;

  16666 27 006734   000023 236000 0                  LDQ     DO_LINOI$
        27 006735   000002 756100                    STQ     2,,PR0

     1578    16667    6                           END ;

  16667 27 006736   006745 710000 27                 TRA     s:16673

     1579    16668    5                         ELSE /* Test for equality, simplest case */
     1580    16669    6                           DO ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:300  

     1581    16670    6                             PREV_ILS$->ILS.NEXT = DO_LINOI$ ;

  16670 27 006737   000023 236000 0                  LDQ     DO_LINOI$
        27 006740   000001 474400 0                  LDP4    PREV_ILS$
        27 006741   400002 756100                    STQ     2,,PR4

     1582    16671    6                             SEARCH_DO$->ILS.NEXT = DO_ILS$ ;

  16671 27 006742   000022 236000 0                  LDQ     DO_ILS$
        27 006743   000017 471400 0                  LDP1    SEARCH_DO$
        27 006744   100002 756100                    STQ     2,,PR1

     1583    16672    6                           END ;

     1584    16673    5                         ILS$ = DO_LINOI$ ;

  16673 27 006745   000023 236000 0                  LDQ     DO_LINOI$
        27 006746   000000 756000 6                  STQ     ILS$

     1585    16674    5                         DO_LINOI$->ILS.NEXT = SEARCH_DO$ ;

  16674 27 006747   000017 236000 0                  LDQ     SEARCH_DO$
        27 006750   000023 471400 0                  LDP1    DO_LINOI$
        27 006751   100002 756100                    STQ     2,,PR1

     1586    16675    5                         NEXT_ILS$ = SEARCH_DO$ ;

  16675 27 006752   000002 756000 0                  STQ     NEXT_ILS$

     1587    16676    5                       END ;

     1588    16677
     1589    16678    4                     IF OPERAND_TYPE ~= %TYI OR GO_FLAG > 0 THEN

  16678 27 006753   000037 235000 0                  LDA     OPERAND_TYPE
        27 006754   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:301  
        27 006755   006760 601000 27                 TNZ     s:16680
        27 006756   000050 235000 0                  LDA     GO_FLAG
        27 006757   007205 604400 27                 TMOZ    s:16840

     1590    16679    5                       DO ;

     1591    16680    5                         TEMP_SBIN = CONST$->ETT.LOP->CONST.CONSTI.WORD1 ;

  16680 27 006760   000035 470400 0                  LDP0    CONST$
        27 006761   000001 471500                    LDP1    1,,PR0
        27 006762   100010 235100                    LDA     8,,PR1
        27 006763   000041 755000 0                  STA     TEMP_SBIN

     1592    16681    5                         IF GO_FLAG > 0 THEN

  16681 27 006764   000050 235000 0                  LDA     GO_FLAG
        27 006765   007036 604400 27                 TMOZ    s:16705

     1593    16682    6                           DO ;

     1594    16683    6                             TEMP_SBIN = TEMP_SBIN - 1 ;

  16683 27 006766   000001 336007                    LCQ     1,DL
        27 006767   000041 056000 0                  ASQ     TEMP_SBIN

     1595    16684    6                             CALL BINXCHAR(TEMP_STR,TEMP_SBIN) ;

  16684 27 006770   000000 301400                    BTD
        27 006771   000041 000004 0                  NDSC9   TEMP_SBIN                cn=0,s=lsgnf,sf=0,n=4
        27 006772   000042 010014 0                  NDSC9   TEMP_STR                 cn=0,s=lsgns,sf=0,n=12

     1596    16685    6                             TEMP_UBIN = 1 ;

  16685 27 006773   000001 235007                    LDA     1,DL
        27 006774   000040 755000 0                  STA     TEMP_UBIN

     1597    16686    7                             DO WHILE SUBSTR(TEMP_STR,TEMP_UBIN,1) = '0' ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:302  

  16686 27 006775   007001 710000 27                 TRA     s:16688

     1598    16687    7                               TEMP_UBIN = TEMP_UBIN + 1 ;

  16687 27 006776   000040 235000 0                  LDA     TEMP_UBIN
        27 006777   000001 035007                    ADLA    1,DL
        27 007000   000040 755000 0                  STA     TEMP_UBIN

     1599    16688    7                             END ;

  16688 27 007001   040000 106405                    CMPC    fill='040'O
        27 007002   000042 000001 0                  ADSC9   TEMP_STR,A               cn=0,n=1
        27 007003   000024 000001 28                 ADSC9   20                       cn=0,n=1
        27 007004   006776 600000 27                 TZE     s:16687

     1600    16689    6                             IF TEMP_SBIN < 0 THEN

  16689 27 007005   000041 236000 0                  LDQ     TEMP_SBIN
        27 007006   007022 605000 27                 TPL     s:16699

     1601    16690    7                               DO ;

     1602    16691    7                                 CALL CONCAT(LEX_SYMBOL.SYMBOL,SUBSTR(TEMP_STR,0,1),

  16691 27 007007   000042 236000 0                  LDQ     TEMP_STR
        27 007010   000011 552040 21                 STBQ    LEX_SYMBOL+9,'40'O
        27 007011   777763 620005                    EAX0    -13,AL
        27 007012   777777 660003                    ERX0    -1,DU
        27 007013   040000 100445                    MLR     fill='040'O
        27 007014   000042 000010 0                  ADSC9   TEMP_STR,A               cn=0,n=*X0
        27 007015   000011 200503 21                 ADSC9   LEX_SYMBOL+9             cn=1,n=323

     1603    16692    7                                     SUBSTR(TEMP_STR,TEMP_UBIN)) ;
     1604    16693                                      /* TEMP_STR byte 0 = minus sign; concatenate
     1605    16694                                         with desired number of digits */
     1606    16695    7                                 LEX_SYMBOL.SIZE = 13 - TEMP_UBIN ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:303  

  16695 27 007016   000015 235007                    LDA     13,DL
        27 007017   000040 135000 0                  SBLA    TEMP_UBIN
        27 007020   000010 755000 21                 STA     LEX_SYMBOL+8

     1607    16696    7                               END ;

  16696 27 007021   007032 710000 27                 TRA     s:16702

     1608    16697    6                             ELSE
     1609    16698    7                               DO ;

     1610    16699    7                                 LEX_SYMBOL.SYMBOL = SUBSTR(TEMP_STR,TEMP_UBIN) ;

  16699 27 007022   777763 620005                    EAX0    -13,AL
        27 007023   777777 660003                    ERX0    -1,DU
        27 007024   040000 100445                    MLR     fill='040'O
        27 007025   000042 000010 0                  ADSC9   TEMP_STR,A               cn=0,n=*X0
        27 007026   000011 000504 21                 ADSC9   LEX_SYMBOL+9             cn=0,n=324

     1611    16700    7                                 LEX_SYMBOL.SIZE = 12 - TEMP_UBIN ;

  16700 27 007027   000025 675000 28                 ERA     21
        27 007030   000015 035007                    ADLA    13,DL
        27 007031   000010 755000 21                 STA     LEX_SYMBOL+8

     1612    16701    7                               END ;

     1613    16702    6                             CALL Z8AH$SEARCH_ ;

  16702 27 007032   000026 631400 28                 EPPR1   22
        27 007033   000000 701000 xent               TSX1    Z8AH$SEARCH_
        27 007034   000000 011000                    NOP     0

     1614    16703    6                           END ;

  16703 27 007035   007041 710000 27                 TRA     s:16706
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:304  

     1615    16704    5                         ELSE
     1616    16705    5                           DNT$ = CONST$->ETT.LOP->CONST.DNT$ ;

  16705 27 007036   000001 471500                    LDP1    1,,PR0
        27 007037   100006 236100                    LDQ     6,,PR1
        27 007040   000000 756000 2                  STQ     DNT$

     1617    16706    5                         TEMP_UBIN = CONST$->ETT.LOP->CONST.COUNT ;

  16706 27 007041   000035 470400 0                  LDP0    CONST$
        27 007042   000001 471500                    LDP1    1,,PR0
        27 007043   100000 236100                    LDQ     0,,PR1
        27 007044   000777 376007                    ANQ     511,DL
        27 007045   000040 756000 0                  STQ     TEMP_UBIN

     1618    16707                              %NEW_CONST(@ST$   = CONST$,
     1619    16708                                         @COUNT = TEMP_UBIN,
     1620    16709                                         @TYPE  = OPERAND_TYPE,
     1621    16710                                         @DNT$  = DNT$) ;

  16714 27 007046   000002 236000 20                 LDQ     ST_+2
        27 007047   000013 036007                    ADLQ    11,DL
        27 007050   000003 116000 20                 CMPQ    ST_+3
        27 007051   007062 604000 27                 TMI     s:16716

  16715 27 007052   000027 236000 28                 LDQ     23
        27 007053   000130 756000 0                  STQ     OPT_FLAG+1
        27 007054   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 007055   000131 451400 0                  STP1    OPT_FLAG+2
        27 007056   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 007057   000001 631400 28                 EPPR1   1
        27 007060   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 007061   000000 011000                    NOP     0

  16716 27 007062   000002 236000 20                 LDQ     ST_+2
        27 007063   000022 736000                    QLS     18
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:305  
        27 007064   000001 036000 20                 ADLQ    ST_+1
        27 007065   000035 756000 0                  STQ     CONST$

  16717 27 007066   000013 236007                    LDQ     11,DL
        27 007067   000002 056000 20                 ASQ     ST_+2

  16720 27 007070   000767 220003                    LDX0    503,DU
        27 007071   000035 470400 0                  LDP0    CONST$
        27 007072   000000 740100                    STX0    0,,PR0

  16721 27 007073   001000 236007                    LDQ     512,DL
        27 007074   000000 552110                    STBQ    0,'10'O,PR0

  16722 27 007075   000040 236000 0                  LDQ     TEMP_UBIN
        27 007076   000000 552104                    STBQ    0,'04'O,PR0

  16723 27 007077   000037 721000 0                  LXL1    OPERAND_TYPE
        27 007100   000002 741100                    STX1    2,,PR0

  16724 27 007101   000003 450100                    STZ     3,,PR0

  16725 27 007102   000000 236000 28                 LDQ     0
        27 007103   000004 756100                    STQ     4,,PR0

  16726 27 007104   000005 756100                    STQ     5,,PR0

  16727 27 007105   000000 236000 2                  LDQ     DNT$
        27 007106   000006 756100                    STQ     6,,PR0

     1622    16751    5                         IF OPERAND_TYPE = %TYJ OR OPERAND_TYPE = %TYK THEN

  16751 27 007107   000037 235000 0                  LDA     OPERAND_TYPE
        27 007110   000002 115007                    CMPA    2,DL
        27 007111   007114 600000 27                 TZE     s:16752
        27 007112   000017 115007                    CMPA    15,DL
        27 007113   007120 601000 27                 TNZ     s:16754

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:306  
     1623    16752    5                           CALL Z9EC$ALIGN(TEMP_SBIN,TEMP_SBIN) ;

  16752 27 007114   000030 630400 28                 EPPR0   24
        27 007115   000005 631400 28                 EPPR1   5
        27 007116   000000 701000 xent               TSX1    Z9EC$ALIGN
        27 007117   000000 011000                    NOP     0

     1624    16753                                /* Convert to COMP-1 or COMP-2 format if need be */
     1625    16754    5                         IF OPERAND_TYPE = %TYI OR OPERAND_TYPE = %TYK THEN

  16754 27 007120   000037 235000 0                  LDA     OPERAND_TYPE
        27 007121   000001 115007                    CMPA    1,DL
        27 007122   007125 600000 27                 TZE     s:16756
        27 007123   000017 115007                    CMPA    15,DL
        27 007124   007133 601000 27                 TNZ     s:16762

     1626    16755    6                           DO ;

     1627    16756    6                             CONST$->CONST.CONSTI.WORD1 = TEMP_SBIN ;

  16756 27 007125   000035 470400 0                  LDP0    CONST$
        27 007126   000041 236000 0                  LDQ     TEMP_SBIN
        27 007127   000010 756100                    STQ     8,,PR0

     1628    16757    6                             CONST$->CONST.ADSC.N = %COMP6_LENGTH ;

  16757 27 007130   000004 236007                    LDQ     4,DL
        27 007131   000001 752103                    STCQ    1,'03'O,PR0

     1629    16758                                  /* COMP-2 uses same length */
     1630    16759    6                           END ;

  16759 27 007132   007140 710000 27                 TRA     s:16771

     1631    16760    5                         ELSE
     1632    16761    6                           DO ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:307  
     1633    16762    6                             CONST$->CONST.CONSTS.UPPER = TEMP_SBIN ;

  16762 27 007133   000041 720000 0                  LXL0    TEMP_SBIN
        27 007134   000035 470400 0                  LDP0    CONST$
        27 007135   000010 740100                    STX0    8,,PR0

     1634    16763    6                             CONST$->CONST.ADSC.N = %COMP7_LENGTH ;

  16763 27 007136   000002 236007                    LDQ     2,DL
        27 007137   000001 752103                    STCQ    1,'03'O,PR0

     1635    16764                                  /* COMP-1 uses same length */
     1636    16765    6                           END ;

     1637    16766                              %NEW_ETT(@ID  = %TRIAD,
     1638    16767                                       @LOP = CONST$) ;

  16771 27 007140   000000 236000 13                 LDQ     HEAD_ETT$
        27 007141   000000 116000 28                 CMPQ    0
        27 007142   007166 601000 27                 TNZ     s:16783

  16773 27 007143   000002 236000 15                 LDQ     ETT_+2
        27 007144   000005 036007                    ADLQ    5,DL
        27 007145   000003 116000 15                 CMPQ    ETT_+3
        27 007146   007157 604000 27                 TMI     s:16775

  16774 27 007147   000032 236000 28                 LDQ     26
        27 007150   000130 756000 0                  STQ     OPT_FLAG+1
        27 007151   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 007152   000131 451400 0                  STP1    OPT_FLAG+2
        27 007153   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 007154   000001 631400 28                 EPPR1   1
        27 007155   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 007156   000000 011000                    NOP     0

  16775 27 007157   000002 236000 15                 LDQ     ETT_+2
        27 007160   000022 736000                    QLS     18
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:308  
        27 007161   000001 036000 15                 ADLQ    ETT_+1
        27 007162   000000 756000 12                 STQ     ETT$

  16776 27 007163   000005 236007                    LDQ     5,DL
        27 007164   000002 056000 15                 ASQ     ETT_+2

  16777 27 007165   007172 710000 27                 TRA     s:16793

  16783 27 007166   000000 756000 12                 STQ     ETT$

  16784 27 007167   000000 471400 13                 LDP1    HEAD_ETT$
        27 007170   100003 236100                    LDQ     3,,PR1
        27 007171   000000 756000 13                 STQ     HEAD_ETT$

  16793 27 007172   000015 220003                    LDX0    13,DU
        27 007173   000000 470400 12                 LDP0    ETT$
        27 007174   000000 740100                    STX0    0,,PR0

  16816 27 007175   000035 236000 0                  LDQ     CONST$
        27 007176   000000 470400 12                 LDP0    ETT$
        27 007177   000001 756100                    STQ     1,,PR0

  16819 27 007200   000000 236000 28                 LDQ     0
        27 007201   000002 756100                    STQ     2,,PR0

  16821 27 007202   000003 756100                    STQ     3,,PR0

     1639    16837    5                         CONST$ = ETT$ ;

  16837 27 007203   000000 236000 12                 LDQ     ETT$
        27 007204   000035 756000 0                  STQ     CONST$

     1640    16838    5                       END ;

     1641    16839
     1642    16840    5                     DO CASE (OPERAND_TYPE) ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:309  
  16840 27 007205   000037 235000 0                  LDA     OPERAND_TYPE
        27 007206   000020 115007                    CMPA    16,DL
        27 007207   007211 602005 27                 TNC     s:16840+4,AL
        27 007210   007244 710000 27                 TRA     s:16853
        27 007211   007244 710000 27                 TRA     s:16853
        27 007212   007231 710000 27                 TRA     s:16842
        27 007213   007237 710000 27                 TRA     s:16846
        27 007214   007244 710000 27                 TRA     s:16853
        27 007215   007244 710000 27                 TRA     s:16853
        27 007216   007244 710000 27                 TRA     s:16853
        27 007217   007244 710000 27                 TRA     s:16853
        27 007220   007234 710000 27                 TRA     s:16844
        27 007221   007244 710000 27                 TRA     s:16853
        27 007222   007244 710000 27                 TRA     s:16853
        27 007223   007244 710000 27                 TRA     s:16853
        27 007224   007244 710000 27                 TRA     s:16853
        27 007225   007244 710000 27                 TRA     s:16853
        27 007226   007244 710000 27                 TRA     s:16853
        27 007227   007244 710000 27                 TRA     s:16853
        27 007230   007242 710000 27                 TRA     s:16848

     1643    16841    5                       CASE (%TYI) ;

     1644    16842    5                         ILL_ID = %MVII ;

  16842 27 007231   000245 236007                    LDQ     165,DL
        27 007232   000046 756000 0                  STQ     ILL_ID
        27 007233   007244 710000 27                 TRA     s:16853

     1645    16843    5                       CASE (%TYH) ;

     1646    16844    5                         ILL_ID = %MVHH ;

  16844 27 007234   000251 236007                    LDQ     169,DL
        27 007235   000046 756000 0                  STQ     ILL_ID
        27 007236   007244 710000 27                 TRA     s:16853

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:310  
     1647    16845    5                       CASE (%TYJ) ;

     1648    16846    5                         ILL_ID = %MVJJ ;

  16846 27 007237   000262 236007                    LDQ     178,DL
        27 007240   000046 756000 0                  STQ     ILL_ID
        27 007241   007244 710000 27                 TRA     s:16853

     1649    16847    5                       CASE (%TYK) ;

     1650    16848    5                         ILL_ID = %MVKK ;

  16848 27 007242   000267 236007                    LDQ     183,DL
        27 007243   000046 756000 0                  STQ     ILL_ID

     1651    16849    5                     END ;

     1652    16850
     1653    16851                          %RESERVE_ILL(ITEM=ILL_ID,POINTER=SEARCH_DO$->ILS.ILL$) ;

  16853 27 007244   000046 720000 0                  LXL0    ILL_ID
        27 007245   777552 235010 xsym               LDA     ILL_STEP-150,X0
        27 007246   000000 755000 1                  STA     ITERATION

  16854 27 007247   000002 236000 11                 LDQ     ILL_+2
        27 007250   000000 036000 1                  ADLQ    ITERATION
        27 007251   000003 116000 11                 CMPQ    ILL_+3
        27 007252   007263 604000 27                 TMI     s:16856

  16855 27 007253   000003 236000 28                 LDQ     3
        27 007254   000130 756000 0                  STQ     OPT_FLAG+1
        27 007255   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 007256   000131 450400 0                  STP0    OPT_FLAG+2
        27 007257   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 007260   000001 631400 28                 EPPR1   1
        27 007261   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 007262   000000 011000                    NOP     0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:311  

  16856 27 007263   000002 236000 11                 LDQ     ILL_+2
        27 007264   000022 736000                    QLS     18
        27 007265   000001 036000 11                 ADLQ    ILL_+1
        27 007266   000017 470400 0                  LDP0    SEARCH_DO$
        27 007267   000003 756100                    STQ     3,,PR0

  16857 27 007270   000002 236000 11                 LDQ     ILL_+2
        27 007271   000000 036000 1                  ADLQ    ITERATION
        27 007272   000002 756000 11                 STQ     ILL_+2

  16858 27 007273   000003 471500                    LDP1    3,,PR0
        27 007274   000046 720000 0                  LXL0    ILL_ID
        27 007275   100000 740100                    STX0    0,,PR1

     1654    16861    4                     SEARCH_DO$->ILS.ILL$->ILL.ROP = CONST$ ;

  16861 27 007276   000003 471500                    LDP1    3,,PR0
        27 007277   000035 236000 0                  LDQ     CONST$
        27 007300   100002 756100                    STQ     2,,PR1

     1655    16862    4                     SEARCH_DO$->ILS.ILL$->ILL.LOP = OPERAND$ ;

  16862 27 007301   000003 471500                    LDP1    3,,PR0
        27 007302   000036 236000 0                  LDQ     OPERAND$
        27 007303   100001 756100                    STQ     1,,PR1

     1656    16863    4                     IF ILL$->DO_N.B.TEST_AFTER AND

  16863 27 007304   000000 471400 10                 LDP1    ILL$
        27 007305   100000 236100                    LDQ     0,,PR1
        27 007306   400000 316007                    CANQ    -131072,DL
        27 007307   007452 600000 27                 TZE     s:16927
        27 007310   000015 473400 0                  LDP3    GO_ILS$
        27 007311   300003 474500                    LDP4    3,,PR3
        27 007312   400000 721100                    LXL1    0,,PR4
        27 007313   000012 101003                    CMPX1   10,DU
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:312  
        27 007314   007452 600000 27                 TZE     s:16927

     1657    16864    4                         GO_ILS$->ILS.ILL$->ILL.CODE ~= %GO_NOT_EQUAL THEN
     1658    16865    5                       DO ;

     1659    16866                              %RESERVE_ILS(ITEM=%OPN,POINTER=SEARCH_DO$->ILS.NEXT) ;

  16886 27 007315   000002 236000 7                  LDQ     ILS_+2
        27 007316   000004 036007                    ADLQ    4,DL
        27 007317   000003 116000 7                  CMPQ    ILS_+3
        27 007320   007331 602000 27                 TNC     s:16888

  16887 27 007321   000002 236000 28                 LDQ     2
        27 007322   000130 756000 0                  STQ     OPT_FLAG+1
        27 007323   000130 634400 0                  EPPR4   OPT_FLAG+1
        27 007324   000131 454400 0                  STP4    OPT_FLAG+2
        27 007325   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 007326   000001 631400 28                 EPPR1   1
        27 007327   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 007330   000000 011000                    NOP     0

  16888 27 007331   000002 236000 7                  LDQ     ILS_+2
        27 007332   000022 736000                    QLS     18
        27 007333   000001 036000 7                  ADLQ    ILS_+1
        27 007334   000017 470400 0                  LDP0    SEARCH_DO$
        27 007335   000002 756100                    STQ     2,,PR0

  16889 27 007336   000002 235000 7                  LDA     ILS_+2
        27 007337   000004 035007                    ADLA    4,DL
        27 007340   000002 755000 7                  STA     ILS_+2

  16890 27 007341   000002 471500                    LDP1    2,,PR0
        27 007342   000740 220003                    LDX0    480,DU
        27 007343   100000 740100                    STX0    0,,PR1

  16891 27 007344   000002 471500                    LDP1    2,,PR0
        27 007345   000000 236000 28                 LDQ     0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:313  
        27 007346   100002 756100                    STQ     2,,PR1

     1660    16895    5                         CREATED_LABEL$->LABEL.PREV_ILS$ = SEARCH_DO$ ;

  16895 27 007347   000017 236000 0                  LDQ     SEARCH_DO$
        27 007350   000030 471400 0                  LDP1    LABEL_CHECK$
        27 007351   100010 756100                    STQ     8,,PR1

     1661    16896                              %NEXT_ILS(POINTER=SEARCH_DO$) ;

  16898 27 007352   000002 236100                    LDQ     2,,PR0
        27 007353   000017 756000 0                  STQ     SEARCH_DO$

     1662    16901                              %RESERVE_ILL(ITEM=%LINOI,POINTER=SEARCH_DO$->ILS.ILL$) ;

  16903 27 007354   000145 235000 xsym               LDA     ILL_STEP+101
        27 007355   000000 755000 1                  STA     ITERATION

  16904 27 007356   000002 236000 11                 LDQ     ILL_+2
        27 007357   000000 036000 1                  ADLQ    ITERATION
        27 007360   000003 116000 11                 CMPQ    ILL_+3
        27 007361   007372 604000 27                 TMI     s:16906

  16905 27 007362   000003 236000 28                 LDQ     3
        27 007363   000130 756000 0                  STQ     OPT_FLAG+1
        27 007364   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 007365   000131 450400 0                  STP0    OPT_FLAG+2
        27 007366   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 007367   000001 631400 28                 EPPR1   1
        27 007370   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 007371   000000 011000                    NOP     0

  16906 27 007372   000002 236000 11                 LDQ     ILL_+2
        27 007373   000022 736000                    QLS     18
        27 007374   000001 036000 11                 ADLQ    ILL_+1
        27 007375   000017 470400 0                  LDP0    SEARCH_DO$
        27 007376   000003 756100                    STQ     3,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:314  

  16907 27 007377   000002 236000 11                 LDQ     ILL_+2
        27 007400   000000 036000 1                  ADLQ    ITERATION
        27 007401   000002 756000 11                 STQ     ILL_+2

  16908 27 007402   000003 471500                    LDP1    3,,PR0
        27 007403   000373 220003                    LDX0    251,DU
        27 007404   100000 740100                    STX0    0,,PR1

     1663    16911    5                         SEARCH_DO$->ILS.ILL$->LINOI = DO_LINOI$->ILS.ILL$->LINOI ;

  16911 27 007405   000003 471500                    LDP1    3,,PR0
        27 007406   000023 473400 0                  LDP3    DO_LINOI$
        27 007407   300003 474500                    LDP4    3,,PR3
        27 007410   000100 100500                    MLR     fill='000'O
        27 007411   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        27 007412   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

     1664    16912    5                         SEARCH_DO$->ILS.NEXT = DO_ILS$ ; /* Reuse DOEND's ILS item */

  16912 27 007413   000022 236000 0                  LDQ     DO_ILS$
        27 007414   000002 756100                    STQ     2,,PR0

     1665    16913                              %RESERVE_ILL(ITEM=%DEFLB,POINTER=DO_ILS$->ILS.ILL$) ;

  16915 27 007415   000120 235000 xsym               LDA     ILL_STEP+80
        27 007416   000000 755000 1                  STA     ITERATION

  16916 27 007417   000002 236000 11                 LDQ     ILL_+2
        27 007420   000000 036000 1                  ADLQ    ITERATION
        27 007421   000003 116000 11                 CMPQ    ILL_+3
        27 007422   007433 604000 27                 TMI     s:16918

  16917 27 007423   000003 236000 28                 LDQ     3
        27 007424   000130 756000 0                  STQ     OPT_FLAG+1
        27 007425   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 007426   000131 451400 0                  STP1    OPT_FLAG+2
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:315  
        27 007427   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 007430   000001 631400 28                 EPPR1   1
        27 007431   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 007432   000000 011000                    NOP     0

  16918 27 007433   000002 236000 11                 LDQ     ILL_+2
        27 007434   000022 736000                    QLS     18
        27 007435   000001 036000 11                 ADLQ    ILL_+1
        27 007436   000022 470400 0                  LDP0    DO_ILS$
        27 007437   000003 756100                    STQ     3,,PR0

  16919 27 007440   000002 236000 11                 LDQ     ILL_+2
        27 007441   000000 036000 1                  ADLQ    ITERATION
        27 007442   000002 756000 11                 STQ     ILL_+2

  16920 27 007443   000003 471500                    LDP1    3,,PR0
        27 007444   000346 220003                    LDX0    230,DU
        27 007445   100000 740100                    STX0    0,,PR1

     1666    16923    5                         DO_ILS$->ILS.ILL$->ILL.LOP = CREATED_LABEL$ ;

  16923 27 007446   000003 471500                    LDP1    3,,PR0
        27 007447   000030 236000 0                  LDQ     LABEL_CHECK$
        27 007450   100001 756100                    STQ     1,,PR1

     1667    16924    5                       END ;

  16924 27 007451   007521 710000 27                 TRA     s:16957

     1668    16925    4                     ELSE
     1669    16926    5                       DO ; /* TEST BEFORE or test for equality or default */

     1670    16927    5                         IF GO_FLAG >= 0 THEN

  16927 27 007452   000050 235000 0                  LDA     GO_FLAG
        27 007453   007501 604000 27                 TMI     s:16947

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:316  
     1671    16928    6                           DO ;

     1672    16929    6                             END_LABEL_ILS$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ =
             16929                                      SEARCH_DO$ ;

  16929 27 007454   000010 473400 0                  LDP3    END_LABEL_ILS$
        27 007455   300003 474500                    LDP4    3,,PR3
        27 007456   400001 475500                    LDP5    1,,PR4
        27 007457   000017 236000 0                  LDQ     SEARCH_DO$
        27 007460   500010 756100                    STQ     8,,PR5

     1673    16930    6                             TEMP$ = SEARCH_DO$ ;

  16930 27 007461   000110 756000 0                  STQ     TEMP$

     1674    16931    7                             DO UNTIL TEMP$->ILS.ILL$->ILL.ID = %LINOI ;

     1675    16932                                    %NEXT_ILS (POINTER=TEMP$) ;

  16934 27 007462   000110 470400 0                  LDP0    TEMP$
        27 007463   000002 236100                    LDQ     2,,PR0
        27 007464   000110 756000 0                  STQ     TEMP$

     1676    16937    7                             END ;

  16937 27 007465   000110 470400 0                  LDP0    TEMP$
        27 007466   000003 471500                    LDP1    3,,PR0
        27 007467   100000 220100                    LDX0    0,,PR1
        27 007470   000373 100003                    CMPX0   251,DU
        27 007471   007462 601000 27                 TNZ     s:16934

     1677    16938    6                             SEARCH_DO$->ILS.NEXT = TEMP$ ;

  16938 27 007472   000017 473400 0                  LDP3    SEARCH_DO$
        27 007473   300002 756100                    STQ     2,,PR3

     1678    16939    6                             TEMP$->ILS.NEXT = END_LABEL_ILS$ ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:317  

  16939 27 007474   000010 236000 0                  LDQ     END_LABEL_ILS$
        27 007475   000002 756100                    STQ     2,,PR0

     1679    16940    6                             END_LABEL_ILS$->ILS.NEXT = DO_ILS$ ;

  16940 27 007476   000022 236000 0                  LDQ     DO_ILS$
        27 007477   000010 471400 0                  LDP1    END_LABEL_ILS$
        27 007500   100002 756100                    STQ     2,,PR1

     1680    16941    6                           END ;

     1681    16942                              %NEXT_NON_LINOI(POINTER=DO_ILS$) ;

  16947 27 007501   000022 470400 0                  LDP0    DO_ILS$
        27 007502   000002 236100                    LDQ     2,,PR0
        27 007503   000022 756000 0                  STQ     DO_ILS$

  16950 27 007504   000022 470400 0                  LDP0    DO_ILS$
        27 007505   000003 236100                    LDQ     3,,PR0
        27 007506   000000 116000 28                 CMPQ    0
        27 007507   007501 600000 27                 TZE     s:16947
        27 007510   000003 471500                    LDP1    3,,PR0
        27 007511   100000 220100                    LDX0    0,,PR1
        27 007512   000373 100003                    CMPX0   251,DU
        27 007513   007501 600000 27                 TZE     s:16947

     1682    16952    5                         IF DO_ILS$->ILS.ILL$->ILL.ID = %DEFLB THEN

  16952 27 007514   000346 100003                    CMPX0   230,DU
        27 007515   007521 601000 27                 TNZ     s:16957

     1683    16953    5                           DO_ILS$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ = SEARCH_DO$ ;

  16953 27 007516   100001 473500                    LDP3    1,,PR1
        27 007517   000017 236000 0                  LDQ     SEARCH_DO$
        27 007520   300010 756100                    STQ     8,,PR3
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:318  

     1684    16954    5                       END ;

     1685    16955    4                 END ; /* CHECK_DO3 */

     1686    16956
     1687    16957    3                 IF NOT OPTIMIZE_DO3 THEN

  16957 27 007521   000045 234000 0                  SZN     OPTIMIZE_DO3
        27 007522   012101 604000 27                 TMI     s:17920

     1688    16958    4                   DO ;

     1689    16959                          %ASSIGN_DO_ITEM_INFO ;

  16961 27 007523   000001 236000 0                  LDQ     PREV_ILS$
        27 007524   000023 756000 0                  STQ     DO_LINOI$

  16964 27 007525   000023 470400 0                  LDP0    DO_LINOI$
        27 007526   000002 236100                    LDQ     2,,PR0
        27 007527   000023 756000 0                  STQ     DO_LINOI$

  16967 27 007530   000332 236000 xsym               LDQ     COMCOM+218
        27 007531   000000 470400 10                 LDP0    ILL$
        27 007532   000003 756100                    STQ     3,,PR0

  16968 27 007533   000000 236000 6                  LDQ     ILS$
        27 007534   000332 756000 xsym               STQ     COMCOM+218

  16969 27 007535   000025 236000 0                  LDQ     REF_DEFLB
        27 007536   000006 756100                    STQ     6,,PR0

  16970 27 007537   000024 236000 0                  LDQ     FATHER_DO
        27 007540   000004 756100                    STQ     4,,PR0

  16971 27 007541   000000 236000 6                  LDQ     ILS$
        27 007542   000024 756000 0                  STQ     FATHER_DO
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:319  

  16972 27 007543   000051 720000 0                  LXL0    DO_LEVEL
        27 007544   000005 740100                    STX0    5,,PR0

  16973 27 007545   000051 054000 0                  AOS     DO_LEVEL

  16974 27 007546   000001 235007                    LDA     1,DL
        27 007547   000053 755000 0                  STA     FALL_THRU_FLAG

     1690    16977    4                     PREV_ILS$ = ILS$ ;

  16977 27 007550   000001 756000 0                  STQ     PREV_ILS$

     1691    16978    4                     ILS$ = NEXT_ILS$ ;

  16978 27 007551   000002 236000 0                  LDQ     NEXT_ILS$
        27 007552   000000 756000 6                  STQ     ILS$

     1692    16979    4                   END ;

  16979 27 007553   012101 710000 27                 TRA     s:17920

     1693    16980        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:320  
     1694    16981        /*V*
     1695    16982            DOEND -- The pointer to the previous DO or DOEND item is set and the
     1696    16983                     variables for the nesting level and  outer DO item
     1697    16984                     are reset.
     1698    16985        */
     1699    16986
     1700    16987    3              CASE (%DOEND) ;

     1701    16988                     %ASSIGN_DOEND_INFO ;

  16990 27 007554   000332 236000 xsym               LDQ     COMCOM+218
        27 007555   000003 756100                    STQ     3,,PR0

  16991 27 007556   000000 236000 6                  LDQ     ILS$
        27 007557   000332 756000 xsym               STQ     COMCOM+218

  16992 27 007560   000001 336007                    LCQ     1,DL
        27 007561   000051 056000 0                  ASQ     DO_LEVEL

  16993 27 007562   000024 471400 0                  LDP1    FATHER_DO
        27 007563   100003 473500                    LDP3    3,,PR1
        27 007564   300004 236100                    LDQ     4,,PR3
        27 007565   000024 756000 0                  STQ     FATHER_DO

  16994 27 007566   000001 235007                    LDA     1,DL
        27 007567   000053 755000 0                  STA     FALL_THRU_FLAG

     1702    16997    3                PREV_ILS$ = ILS$ ;

  16997 27 007570   000000 236000 6                  LDQ     ILS$
        27 007571   000001 756000 0                  STQ     PREV_ILS$

     1703    16998    3                ILS$ = NEXT_ILS$ ;

  16998 27 007572   000002 236000 0                  LDQ     NEXT_ILS$
        27 007573   000000 756000 6                  STQ     ILS$
        27 007574   012101 710000 27                 TRA     s:17920
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:321  

     1704    16999        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:322  
     1705    17000        /*V*
     1706    17001            PFORM -- Error checking for null pforms and recursive performs are done.
     1707    17002                     A check is also made to see if the perform code group can be
     1708    17003                     either transfered in line or copied in line.
     1709    17004        */
     1710    17005
     1711    17006
     1712    17007    3              CASE (%PFORM) ;

     1713    17008        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:323  
     1714    17009        /*V*
     1715    17010            PFORM_INITIALIZE -- Pointers used in the PFORM handling are assigned.
     1716    17011                                This includes pointers to the starting and ending
     1717    17012                                labels as well as the label following the end label.
     1718    17013        */
     1719    17014
     1720    17015    3                ILL$ -> PFORM.BRANCH$ = O2COM.SECTION$;

  17015 27 007575   000003 236000 25                 LDQ     O2COM+3
        27 007576   000003 756100                    STQ     3,,PR0

     1721    17016    3                ILL$ -> PFORM.DO$ = ADDR (NIL) ;

  17016 27 007577   000000 236000 28                 LDQ     0
        27 007600   000005 756100                    STQ     5,,PR0

     1722    17017    3                DEFLB_FOLLOWS = FALSE  ; /* Usual case */

  17017 27 007601   000055 450000 0                  STZ     DEFLB_FOLLOWS

     1723    17018    3                TEMP$ = ILS$ ;

  17018 27 007602   000000 236000 6                  LDQ     ILS$
        27 007603   000110 756000 0                  STQ     TEMP$

     1724    17019                     %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  17029 27 007604   000110 470400 0                  LDP0    TEMP$
        27 007605   000002 236100                    LDQ     2,,PR0
        27 007606   000110 756000 0                  STQ     TEMP$

  17032 27 007607   000110 470400 0                  LDP0    TEMP$
        27 007610   000003 236100                    LDQ     3,,PR0
        27 007611   000000 116000 28                 CMPQ    0
        27 007612   007604 600000 27                 TZE     s:17029
        27 007613   000003 471500                    LDP1    3,,PR0
        27 007614   100000 220100                    LDX0    0,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:324  
        27 007615   000343 100003                    CMPX0   227,DU
        27 007616   007604 600000 27                 TZE     s:17029
        27 007617   000422 100003                    CMPX0   274,DU
        27 007620   007604 600000 27                 TZE     s:17029
        27 007621   000446 100003                    CMPX0   294,DU
        27 007622   007604 600000 27                 TZE     s:17029
        27 007623   000336 100003                    CMPX0   222,DU
        27 007624   007604 600000 27                 TZE     s:17029
        27 007625   000420 100003                    CMPX0   272,DU
        27 007626   007604 600000 27                 TZE     s:17029
        27 007627   000373 100003                    CMPX0   251,DU
        27 007630   007604 600000 27                 TZE     s:17029

     1725    17034    3                IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB

  17034 27 007631   000346 100003                    CMPX0   230,DU
        27 007632   007637 601000 27                 TNZ     s:17039

     1726    17035    4                  THEN DO ;

     1727    17036    4                    DEFLB_FOLLOWS = TRUE ; /* Next statement is a label. */

  17036 27 007633   400000 236003                    LDQ     -131072,DU
        27 007634   000055 756000 0                  STQ     DEFLB_FOLLOWS

     1728    17037    4                    LABEL_AFTER_PFORM$ = TEMP$->ILS.ILL$->ILL.LOP ;

  17037 27 007635   100001 236100                    LDQ     1,,PR1
        27 007636   000056 756000 0                  STQ     LABEL_AFTER_PFORM$

     1729    17038    4                  END ;

     1730    17039    3                START_LABEL$ = ILL$->ILL.LOP ;

  17039 27 007637   000000 471400 10                 LDP1    ILL$
        27 007640   100001 236100                    LDQ     1,,PR1
        27 007641   000005 756000 0                  STQ     START_LABEL$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:325  

     1731    17040
     1732    17041    3                IF START_LABEL$ = ADDR(NIL) THEN

  17041 27 007642   000000 116000 28                 CMPQ    0
        27 007643   007651 601000 27                 TNZ     s:17048

     1733    17042    4                  DO ; /* If there is nothing to PERFORM then do not PERFORM it */

     1734    17043    4                    PREV_ILS$->ILS.NEXT = NEXT_ILS$ ;

  17043 27 007644   000002 236000 0                  LDQ     NEXT_ILS$
        27 007645   000001 473400 0                  LDP3    PREV_ILS$
        27 007646   300002 756100                    STQ     2,,PR3

     1735    17044    4                    ILS$ = NEXT_ILS$ ;

  17044 27 007647   000000 756000 6                  STQ     ILS$

     1736    17045    4                    EXIT CASE_STMT ;

  17045 27 007650   012101 710000 27                 TRA     s:17920

     1737    17046    4                  END ;
     1738    17047
     1739    17048    3                START_LABEL_ILS$ = START_LABEL$->LABEL.PREV_ILS$ ;

  17048 27 007651   000005 473400 0                  LDP3    START_LABEL$
        27 007652   300010 236100                    LDQ     8,,PR3
        27 007653   000006 756000 0                  STQ     START_LABEL_ILS$

     1740    17049                     /* Find start label. %NEXT_NON_SUPPORT will not quite do it,
     1741    17050                        because the start label could be a program entry point. */
     1742    17051    4                DO UNTIL START_LABEL_ILS$->ILS.ILL$ ~= ADDR (NIL) AND

     1743    17052    4                    START_LABEL_ILS$->ILS.ILL$->ILL.ID = %DEFLB ;
     1744    17053                       %NEXT_ILS (POINTER=START_LABEL_ILS$) ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:326  

  17055 27 007654   000006 470400 0                  LDP0    START_LABEL_ILS$
        27 007655   000002 236100                    LDQ     2,,PR0
        27 007656   000006 756000 0                  STQ     START_LABEL_ILS$

     1745    17058    4                END ;

  17058 27 007657   000006 470400 0                  LDP0    START_LABEL_ILS$
        27 007660   000003 236100                    LDQ     3,,PR0
        27 007661   000000 116000 28                 CMPQ    0
        27 007662   007654 600000 27                 TZE     s:17055
        27 007663   000003 471500                    LDP1    3,,PR0
        27 007664   100000 220100                    LDX0    0,,PR1
        27 007665   000346 100003                    CMPX0   230,DU
        27 007666   007654 601000 27                 TNZ     s:17055

     1746    17059    4                IF START_LABEL$->LABEL.B.ENTRY_POINT THEN DO ; /*#35059*/

  17059 27 007667   000005 473400 0                  LDP3    START_LABEL$
        27 007670   300003 236100                    LDQ     3,,PR3
        27 007671   000002 316003                    CANQ    2,DU
        27 007672   007707 600000 27                 TZE     s:17072

     1747    17060                       /* Program entry ... need to bypass %ENTRY and find
     1748    17061                          compiler-created label after it. */
     1749    17062    5                  DO UNTIL START_LABEL_ILS$->ILS.ILL$->ILL.ID = %DEFLB ;

     1750    17063                         %NEXT_ILS (POINTER=START_LABEL_ILS$) ;

  17065 27 007673   000006 470400 0                  LDP0    START_LABEL_ILS$
        27 007674   000002 236100                    LDQ     2,,PR0
        27 007675   000006 756000 0                  STQ     START_LABEL_ILS$

     1751    17068    5                  END ;

  17068 27 007676   000006 470400 0                  LDP0    START_LABEL_ILS$
        27 007677   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:327  
        27 007700   100000 220100                    LDX0    0,,PR1
        27 007701   000346 100003                    CMPX0   230,DU
        27 007702   007673 601000 27                 TNZ     s:17065

     1752    17069    4                  START_LABEL$ = START_LABEL_ILS$->ILS.ILL$->ILL.LOP ;

  17069 27 007703   100001 236100                    LDQ     1,,PR1
        27 007704   000005 756000 0                  STQ     START_LABEL$

     1753    17070    4                  ILL$->ILL.LOP = START_LABEL$ ; /* Start here */

  17070 27 007705   000000 471400 10                 LDP1    ILL$
        27 007706   100001 756100                    STQ     1,,PR1

     1754    17071    4                END ;

     1755    17072    3                END_LABEL$ = ILL$->ILL.ROP ;

  17072 27 007707   000000 471400 10                 LDP1    ILL$
        27 007710   100002 236100                    LDQ     2,,PR1
        27 007711   000007 756000 0                  STQ     END_LABEL$

     1756    17073    3                END_LABEL_ILS$ = END_LABEL$->LABEL.PREV_ILS$ ;

  17073 27 007712   000007 473400 0                  LDP3    END_LABEL$
        27 007713   300010 236100                    LDQ     8,,PR3
        27 007714   000010 756000 0                  STQ     END_LABEL_ILS$

     1757    17074                     %NEXT_NON_SUPPORT (POINTER=END_LABEL_ILS$) ;

  17084 27 007715   000010 470400 0                  LDP0    END_LABEL_ILS$
        27 007716   000002 236100                    LDQ     2,,PR0
        27 007717   000010 756000 0                  STQ     END_LABEL_ILS$

  17087 27 007720   000010 470400 0                  LDP0    END_LABEL_ILS$
        27 007721   000003 236100                    LDQ     3,,PR0
        27 007722   000000 116000 28                 CMPQ    0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:328  
        27 007723   007715 600000 27                 TZE     s:17084
        27 007724   000003 471500                    LDP1    3,,PR0
        27 007725   100000 220100                    LDX0    0,,PR1
        27 007726   000343 100003                    CMPX0   227,DU
        27 007727   007715 600000 27                 TZE     s:17084
        27 007730   000422 100003                    CMPX0   274,DU
        27 007731   007715 600000 27                 TZE     s:17084
        27 007732   000446 100003                    CMPX0   294,DU
        27 007733   007715 600000 27                 TZE     s:17084
        27 007734   000336 100003                    CMPX0   222,DU
        27 007735   007715 600000 27                 TZE     s:17084
        27 007736   000420 100003                    CMPX0   272,DU
        27 007737   007715 600000 27                 TZE     s:17084
        27 007740   000373 100003                    CMPX0   251,DU
        27 007741   007715 600000 27                 TZE     s:17084

     1758    17089    3                NEXT_LABEL$ = END_LABEL_ILS$ ;

  17089 27 007742   000010 236000 0                  LDQ     END_LABEL_ILS$
        27 007743   000011 756000 0                  STQ     NEXT_LABEL$

     1759    17090                     %NEXT_NON_SUPPORT (POINTER=NEXT_LABEL$) ;

  17100 27 007744   000011 470400 0                  LDP0    NEXT_LABEL$
        27 007745   000002 236100                    LDQ     2,,PR0
        27 007746   000011 756000 0                  STQ     NEXT_LABEL$

  17103 27 007747   000011 470400 0                  LDP0    NEXT_LABEL$
        27 007750   000003 236100                    LDQ     3,,PR0
        27 007751   000000 116000 28                 CMPQ    0
        27 007752   007744 600000 27                 TZE     s:17100
        27 007753   000003 471500                    LDP1    3,,PR0
        27 007754   100000 220100                    LDX0    0,,PR1
        27 007755   000343 100003                    CMPX0   227,DU
        27 007756   007744 600000 27                 TZE     s:17100
        27 007757   000422 100003                    CMPX0   274,DU
        27 007760   007744 600000 27                 TZE     s:17100
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:329  
        27 007761   000446 100003                    CMPX0   294,DU
        27 007762   007744 600000 27                 TZE     s:17100
        27 007763   000336 100003                    CMPX0   222,DU
        27 007764   007744 600000 27                 TZE     s:17100
        27 007765   000420 100003                    CMPX0   272,DU
        27 007766   007744 600000 27                 TZE     s:17100
        27 007767   000373 100003                    CMPX0   251,DU
        27 007770   007744 600000 27                 TZE     s:17100

     1760    17105
     1761    17106                     /* Always check for null PERFORM */
     1762    17107    3                NULL_PFORM_CHECK$ = START_LABEL_ILS$ ;

  17107 27 007771   000006 236000 0                  LDQ     START_LABEL_ILS$
        27 007772   000012 756000 0                  STQ     NULL_PFORM_CHECK$

     1763    17108    4                DO UNTIL(NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %DEFLB

     1764    17109    4                    AND NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %LINOI
     1765    17110    4                    AND NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %PREOFF
     1766    17111    4                    AND NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %PRESET
     1767    17112    4                    AND NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %P_A_PRESET
     1768    17113    4                    AND NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %P_P_PRESET
     1769    17114    4                    AND NULL_PFORM_CHECK$->ILS.ILL$->ILL.ID ~= %PTR_SET) ;
     1770    17115                       %NEXT_ILS (POINTER=NULL_PFORM_CHECK$) ;

  17117 27 007773   000012 470400 0                  LDP0    NULL_PFORM_CHECK$
        27 007774   000002 236100                    LDQ     2,,PR0
        27 007775   000012 756000 0                  STQ     NULL_PFORM_CHECK$

     1771    17120    4                  IF NULL_PFORM_CHECK$ = END_LABEL_ILS$ THEN

  17120 27 007776   000010 116000 0                  CMPQ    END_LABEL_ILS$
        27 007777   010022 601000 27                 TNZ     s:17134

     1772    17121    5                    DO ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:330  
     1773    17122                           %NULL_PFORM_WARNING ;

  17124 27 010000   000000 470400 10                 LDP0    ILL$
        27 010001   000000 720100                    LXL0    0,,PR0
        27 010002   000002 100003                    CMPX0   2,DU
        27 010003   010010 600000 27                 TZE     s:17126

  17125 27 010004   000034 630400 28                 EPPR0   28
        27 010005   000001 631400 28                 EPPR1   1
        27 010006   000000 701000 xent               TSX1    Z8AE$ERROR
        27 010007   000000 011000                    NOP     0

  17126 27 010010   000002 236000 0                  LDQ     NEXT_ILS$
        27 010011   000001 470400 0                  LDP0    PREV_ILS$
        27 010012   000002 756100                    STQ     2,,PR0

  17127 27 010013   000000 756000 6                  STQ     ILS$

  17128 27 010014   000055 234000 0                  SZN     DEFLB_FOLLOWS
        27 010015   010021 605000 27                 TPL     s:17132

  17129 27 010016   000001 236000 0                  LDQ     PREV_ILS$
        27 010017   000056 471400 0                  LDP1    LABEL_AFTER_PFORM$
        27 010020   100010 756100                    STQ     8,,PR1

     1774    17132    5                      EXIT CASE_STMT ;

  17132 27 010021   012101 710000 27                 TRA     s:17920

     1775    17133    5                    END ;
     1776    17134    4                  IF NULL_PFORM_CHECK$ = ADDR(NIL) /* BACKWARD PERFORM  */

  17134 27 010022   000000 116000 28                 CMPQ    0
        27 010023   010045 600000 27                 TZE     s:17148

     1777    17135    4                      THEN EXIT ;
     1778    17136    4                END ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:331  

  17136 27 010024   000012 470400 0                  LDP0    NULL_PFORM_CHECK$
        27 010025   000003 471500                    LDP1    3,,PR0
        27 010026   100000 220100                    LDX0    0,,PR1
        27 010027   000346 100003                    CMPX0   230,DU
        27 010030   007773 600000 27                 TZE     s:17117
        27 010031   000373 100003                    CMPX0   251,DU
        27 010032   007773 600000 27                 TZE     s:17117
        27 010033   000420 100003                    CMPX0   272,DU
        27 010034   007773 600000 27                 TZE     s:17117
        27 010035   000422 100003                    CMPX0   274,DU
        27 010036   007773 600000 27                 TZE     s:17117
        27 010037   000446 100003                    CMPX0   294,DU
        27 010040   007773 600000 27                 TZE     s:17117
        27 010041   000336 100003                    CMPX0   222,DU
        27 010042   007773 600000 27                 TZE     s:17117
        27 010043   000343 100003                    CMPX0   227,DU
        27 010044   007773 600000 27                 TZE     s:17117

     1779    17137
     1780    17138        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:332  
     1781    17139        /*E*
     1782    17140              ERROR:  RECURSIVE_PERFORM
     1783    17141            MESSAGE:  This PERFORM may be recursive.
     1784    17142        DESCRIPTION:  This message is printed when the start label of a PERFORM
     1785    17143                      is before the PERFORM and the end label is after it.  The phase_2
     1786    17144                      bit means that the label is in the program flow before our current
     1787    17145                      position so they are used to check for a recursive PERFORM.
     1788    17146        */
     1789    17147
     1790    17148    3                IF START_LABEL$->LABEL.B.PHASE_2 AND NOT(END_LABEL$->LABEL.B.PHASE_2)
             17148                         THEN

  17148 27 010045   000005 470400 0                  LDP0    START_LABEL$
        27 010046   000003 236100                    LDQ     3,,PR0
        27 010047   004000 316003                    CANQ    2048,DU
        27 010050   010062 600000 27                 TZE     s:17162
        27 010051   000007 471400 0                  LDP1    END_LABEL$
        27 010052   100003 236100                    LDQ     3,,PR1
        27 010053   004000 316003                    CANQ    2048,DU
        27 010054   010062 601000 27                 TNZ     s:17162

     1791    17149
     1792    17150    3                  CALL Z8AE$ERROR (%E$RECURSIVE_PERFORM) ;

  17150 27 010055   000036 630400 28                 EPPR0   30
        27 010056   000001 631400 28                 EPPR1   1
        27 010057   000000 701000 xent               TSX1    Z8AE$ERROR
        27 010060   000000 011000                    NOP     0
        27 010061   010773 710000 27                 TRA     s:17506

     1793    17151        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:333  
     1794    17152        /*V*
     1795    17153            PFORM_search_refd_labels --
     1796    17154                 If the starting and ending labels are referenced only once then the
     1797    17155                 PFORM might be able to be transferred in line.  A search is made
     1798    17156                 of the labels if any between the starting and ending labels to see
     1799    17157                 if there are any non compiler created labels that are referenced
     1800    17158                 between these two points as this would preclude the transfer of code.
     1801    17159                 This check is bypassed in case of the NOPTZ option.
     1802    17160        */
     1803    17161
     1804    17162    3                ELSE IF COMCOM.OB.OPTZ AND NOT COMCOM.OB.COUNT

  17162 27 010062   000014 234000 xsym               SZN     COMCOM+12
        27 010063   010773 605000 27                 TPL     s:17506
        27 010064   000112 235000 xsym               LDA     COMCOM+74
        27 010065   010773 601000 27                 TNZ     s:17506

     1805    17163                             %SEGMENT_OPTZ_CHECK;
     1806    17166    4                  THEN DO;

     1807    17167    4                  PERF_LABEL_CHECK = START_LABEL_ILS$ ;

  17167 27 010066   000006 236000 0                  LDQ     START_LABEL_ILS$
        27 010067   000003 756000 0                  STQ     PERF_LABEL_CHECK

     1808    17168
     1809    17169    4                  IF START_LABEL$->LABEL.B.ONE_REF AND END_LABEL$->LABEL.B.ONE_REF AND

  17169 27 010070   000003 236100                    LDQ     3,,PR0
        27 010071   010000 316003                    CANQ    4096,DU
        27 010072   010123 600000 27                 TZE     s:17202
        27 010073   000007 471400 0                  LDP1    END_LABEL$
        27 010074   100003 236100                    LDQ     3,,PR1
        27 010075   010000 316003                    CANQ    4096,DU
        27 010076   010123 600000 27                 TZE     s:17202
        27 010077   000003 236100                    LDQ     3,,PR0
        27 010100   002000 316003                    CANQ    1024,DU
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:334  
        27 010101   010123 601000 27                 TNZ     s:17202

     1810    17170    4                     NOT (START_LABEL$->LABEL.B.FALL_THRU) THEN
     1811    17171    5                    DO ;

     1812    17172    6                      DO UNTIL ((PERF_LABEL_CHECK->ILS.ILL$->ILL.LOP->LABEL.B.
             17172                               REFERENCED AND

     1813    17173    6                                 NOT (PERF_LABEL_CHECK->ILS.ILL$->ILL.LOP->LABEL.B.
             17173                                          COMPILER_CREATED)) OR
     1814    17174    6                                PERF_LABEL_CHECK->ILS.ILL$->ILL.LOP = END_LABEL$) ;
     1815    17175    6                        PERF_LABEL_CHECK = PERF_LABEL_CHECK->ILS.ILL$->ILL.LBL ;

  17175 27 010102   000003 470400 0                  LDP0    PERF_LABEL_CHECK
        27 010103   000003 471500                    LDP1    3,,PR0
        27 010104   100002 236100                    LDQ     2,,PR1
        27 010105   000003 756000 0                  STQ     PERF_LABEL_CHECK

     1816    17176    6                        IF PERF_LABEL_CHECK = ADDR(NIL)

  17176 27 010106   000000 116000 28                 CMPQ    0
        27 010107   010123 600000 27                 TZE     s:17202

     1817    17177                                           /* PERFORM START LABEL AFTER END LABEL    */
     1818    17178    6                        THEN EXIT ;
     1819    17179    6                      END ;

  17179 27 010110   000003 470400 0                  LDP0    PERF_LABEL_CHECK
        27 010111   000003 471500                    LDP1    3,,PR0
        27 010112   100001 473500                    LDP3    1,,PR1
        27 010113   300003 234100                    SZN     3,,PR3
        27 010114   010120 605000 27                 TPL     s:17179+8
        27 010115   300003 236100                    LDQ     3,,PR3
        27 010116   100000 316003                    CANQ    32768,DU
        27 010117   010123 600000 27                 TZE     s:17202
        27 010120   100001 236100                    LDQ     1,,PR1
        27 010121   000007 116000 0                  CMPQ    END_LABEL$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:335  
        27 010122   010102 601000 27                 TNZ     s:17175

     1820    17180    5                    END ;

     1821    17181        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:336  
     1822    17182        /*V*
     1823    17183            TRANSFER_IN_LINE -- The code group can be transferred in line if there
     1824    17184                                are no referenced labels inbetween the starting
     1825    17185                                and ending labels.
     1826    17186
     1827    17187                                If the starting label has already been read then
     1828    17188                                then the IF, DO and DEFLB linked lists must be
     1829    17189                                updated which is handled in Z8FS$SRCH_IF_DO_LBL.
     1830    17190
     1831    17191                                The code group is then linked into the ILS at its
     1832    17192                                new location and all the LINOIs transfered are
     1833    17193                                updated to their new line number.  The label following
     1834    17194                                the end label has its FALL_THRU bit turned off.
     1835    17195                                The label can't be reached by falling thru because the
     1836    17196                                paragraph that preceded it couldn't be reached
     1837    17197                                by falling thru.
     1838    17198
     1839    17199                                This check is bypassed for the NOPTZ option.
     1840    17200        */
     1841    17201        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:337  
     1842    17202    4                  IF PERF_LABEL_CHECK = END_LABEL_ILS$ THEN

  17202 27 010123   000003 236000 0                  LDQ     PERF_LABEL_CHECK
        27 010124   000010 116000 0                  CMPQ    END_LABEL_ILS$
        27 010125   010333 601000 27                 TNZ     s:17285

     1843    17203    5                    DO ;

     1844    17204
     1845    17205    5                      IF START_LABEL$->LABEL.B.PHASE_2 THEN

  17205 27 010126   000005 470400 0                  LDP0    START_LABEL$
        27 010127   000003 236100                    LDQ     3,,PR0
        27 010130   004000 316003                    CANQ    2048,DU
        27 010131   010136 600000 27                 TZE     s:17207

     1846    17206    5                        CALL Z8FS$SRCH_IF_DO_LBL(START_LABEL$, END_LABEL$) ;

  17206 27 010132   000011 630400 28                 EPPR0   9
        27 010133   000005 631400 28                 EPPR1   5
        27 010134   000000 701000 xent               TSX1    Z8FS$SRCH_IF_DO_LBL
        27 010135   000000 011000                    NOP     0

     1847    17207    5                      PREV_ILS$->ILS.NEXT = START_LABEL_ILS$->ILS.NEXT ;

  17207 27 010136   000006 470400 0                  LDP0    START_LABEL_ILS$
        27 010137   000002 236100                    LDQ     2,,PR0
        27 010140   000001 471400 0                  LDP1    PREV_ILS$
        27 010141   100002 756100                    STQ     2,,PR1

     1848    17208    5                      START_LABEL$->LABEL.PREV_ILS$->ILS.NEXT = END_LABEL_ILS$->ILS.
             17208                               NEXT ;

  17208 27 010142   000005 473400 0                  LDP3    START_LABEL$
        27 010143   300010 474500                    LDP4    8,,PR3
        27 010144   000010 475400 0                  LDP5    END_LABEL_ILS$
        27 010145   500002 236100                    LDQ     2,,PR5
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:338  
        27 010146   400002 756100                    STQ     2,,PR4

     1849    17209
     1850    17210    5                      PERF_LABEL_CHECK = NEXT_LABEL$ ;

  17210 27 010147   000011 236000 0                  LDQ     NEXT_LABEL$
        27 010150   000003 756000 0                  STQ     PERF_LABEL_CHECK

     1851    17211    5                      IF PERF_LABEL_CHECK->ILS.ILL$->ILL.ID = %DEFLB THEN

  17211 27 010151   000003 473400 0                  LDP3    PERF_LABEL_CHECK
        27 010152   300003 474500                    LDP4    3,,PR3
        27 010153   400000 220100                    LDX0    0,,PR4
        27 010154   000346 100003                    CMPX0   230,DU
        27 010155   010162 601000 27                 TNZ     s:17213

     1852    17212    5                        PERF_LABEL_CHECK->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ =
             17212                                 START_LABEL$->LABEL.PREV_ILS$ ;

  17212 27 010156   400001 476500                    LDP6    1,,PR4
        27 010157   000005 477400 0                  LDP7    START_LABEL$
        27 010160   700010 236100                    LDQ     8,,PR7
        27 010161   600010 756100                    STQ     8,,PR6

     1853    17213    5                      END_LABEL$->LABEL.PREV_ILS$->ILS.NEXT = NEXT_ILS$ ;

  17213 27 010162   000007 474400 0                  LDP4    END_LABEL$
        27 010163   400010 476500                    LDP6    8,,PR4
        27 010164   000002 236000 0                  LDQ     NEXT_ILS$
        27 010165   600002 756100                    STQ     2,,PR6

     1854    17214    5                      ILS$$ = PREV_ILS$ ;

  17214 27 010166   000001 236000 0                  LDQ     PREV_ILS$
        27 010167   000060 756000 0                  STQ     ILS$$

     1855    17215    5                      ILS$ = PREV_ILS$ ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:339  

  17215 27 010170   000000 756000 6                  STQ     ILS$

     1856    17216                           %NEXT_ILS ;

  17218 27 010171   000000 474400 6                  LDP4    ILS$
        27 010172   400002 236100                    LDQ     2,,PR4
        27 010173   000000 756000 6                  STQ     ILS$

     1857    17221
     1858    17222    6                      DO WHILE ILS$ ~= NEXT_ILS$ ;

  17222 27 010174   000002 116000 0                  CMPQ    NEXT_ILS$
        27 010175   010213 600000 27                 TZE     s:17233

     1859    17223    6                        IF ILS$->ILS.ILL$->ILL.ID = %LINOI THEN

  17223 27 010176   000000 470400 6                  LDP0    ILS$
        27 010177   000003 471500                    LDP1    3,,PR0
        27 010200   100000 220100                    LDX0    0,,PR1
        27 010201   000373 100003                    CMPX0   251,DU
        27 010202   010205 601000 27                 TNZ     s:17225

     1860    17224    6                          ILS$->ILS.ILL$->LINOI.LINE_NO = COMCOM.CURRENT.LINE ;

  17224 27 010203   000133 721000 xsym               LXL1    COMCOM+91
        27 010204   100001 441100                    SXL1    1,,PR1

     1861    17225    6                        ILS$$ = ILS$ ;

  17225 27 010205   000000 236000 6                  LDQ     ILS$
        27 010206   000060 756000 0                  STQ     ILS$$

     1862    17226                             %NEXT_ILS ;

  17228 27 010207   000002 236100                    LDQ     2,,PR0
        27 010210   000000 756000 6                  STQ     ILS$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:340  

     1863    17231    6                      END ;

  17231 27 010211   000002 116000 0                  CMPQ    NEXT_ILS$
        27 010212   010176 601000 27                 TNZ     s:17223

     1864    17232
     1865    17233    5                      IF DEFLB_FOLLOWS

  17233 27 010213   000055 234000 0                  SZN     DEFLB_FOLLOWS
        27 010214   010220 605000 27                 TPL     s:17235

     1866    17234    5                        THEN LABEL_AFTER_PFORM$->LABEL.PREV_ILS$ = ILS$$ ;

  17234 27 010215   000060 236000 0                  LDQ     ILS$$
        27 010216   000056 470400 0                  LDP0    LABEL_AFTER_PFORM$
        27 010217   000010 756100                    STQ     8,,PR0

     1867    17235    5                      IF START_LABEL$->LABEL.B.PHASE_2

  17235 27 010220   000005 470400 0                  LDP0    START_LABEL$
        27 010221   000003 236100                    LDQ     3,,PR0
        27 010222   004000 316003                    CANQ    2048,DU
        27 010223   010231 600000 27                 TZE     s:17241

     1868    17236    6                        THEN DO ; /* Flow analysis already done on this code. */

     1869    17237    6                          PREV_ILS$ = ILS$$ ;

  17237 27 010224   000060 236000 0                  LDQ     ILS$$
        27 010225   000001 756000 0                  STQ     PREV_ILS$

     1870    17238    6                          ILS$ = NEXT_ILS$ ;

  17238 27 010226   000002 236000 0                  LDQ     NEXT_ILS$
        27 010227   000000 756000 6                  STQ     ILS$

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:341  
     1871    17239    6                        END ;

  17239 27 010230   010311 710000 27                 TRA     s:17265

     1872    17240    6                        ELSE DO ;

     1873    17241    6                          ILS$ = PREV_ILS$ ;

  17241 27 010231   000001 236000 0                  LDQ     PREV_ILS$
        27 010232   000000 756000 6                  STQ     ILS$

     1874    17242                               %NEXT_NON_SUPPORT ;

  17252 27 010233   000000 470400 6                  LDP0    ILS$
        27 010234   000002 236100                    LDQ     2,,PR0
        27 010235   000000 756000 6                  STQ     ILS$

  17255 27 010236   000000 470400 6                  LDP0    ILS$
        27 010237   000003 236100                    LDQ     3,,PR0
        27 010240   000000 116000 28                 CMPQ    0
        27 010241   010233 600000 27                 TZE     s:17252
        27 010242   000003 471500                    LDP1    3,,PR0
        27 010243   100000 220100                    LDX0    0,,PR1
        27 010244   000343 100003                    CMPX0   227,DU
        27 010245   010233 600000 27                 TZE     s:17252
        27 010246   000422 100003                    CMPX0   274,DU
        27 010247   010233 600000 27                 TZE     s:17252
        27 010250   000446 100003                    CMPX0   294,DU
        27 010251   010233 600000 27                 TZE     s:17252
        27 010252   000336 100003                    CMPX0   222,DU
        27 010253   010233 600000 27                 TZE     s:17252
        27 010254   000420 100003                    CMPX0   272,DU
        27 010255   010233 600000 27                 TZE     s:17252
        27 010256   000373 100003                    CMPX0   251,DU
        27 010257   010233 600000 27                 TZE     s:17252

     1875    17257    6                          START_LABEL$->LABEL.B.PHASE_2 = TRUE ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:342  

  17257 27 010260   000005 473400 0                  LDP3    START_LABEL$
        27 010261   004000 236003                    LDQ     2048,DU
        27 010262   300003 256100                    ORSQ    3,,PR3

     1876    17258    6                          SEARCH_ILS$ = REF_DEFLB ;

  17258 27 010263   000025 236000 0                  LDQ     REF_DEFLB
        27 010264   000077 756000 0                  STQ     SEARCH_ILS$

     1877    17259    7                         DO WHILE SEARCH_ILS$->ILS.ILL$->ILL.LBL ~= START_LABEL_ILS$ ;

  17259 27 010265   000077 471400 0                  LDP1    SEARCH_ILS$
        27 010266   100003 473500                    LDP3    3,,PR1
        27 010267   300002 236100                    LDQ     2,,PR3
        27 010270   000006 116000 0                  CMPQ    START_LABEL_ILS$
        27 010271   010303 600000 27                 TZE     s:17262

     1878    17260    7                            SEARCH_ILS$ = SEARCH_ILS$->ILS.ILL$->ILL.LBL ;

  17260 27 010272   000077 470400 0                  LDP0    SEARCH_ILS$
        27 010273   000003 471500                    LDP1    3,,PR0
        27 010274   100002 236100                    LDQ     2,,PR1
        27 010275   000077 756000 0                  STQ     SEARCH_ILS$

     1879    17261    7                          END ;

  17261 27 010276   000077 470400 0                  LDP0    SEARCH_ILS$
        27 010277   000003 471500                    LDP1    3,,PR0
        27 010300   100002 236100                    LDQ     2,,PR1
        27 010301   000006 116000 0                  CMPQ    START_LABEL_ILS$
        27 010302   010272 601000 27                 TNZ     s:17260

     1880    17262    6                          SEARCH_ILS$->ILS.ILL$->ILL.LBL = END_LABEL_ILS$->ILS.ILL$->
             17262                                   ILL.LBL ;

  17262 27 010303   000077 470400 0                  LDP0    SEARCH_ILS$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:343  
        27 010304   000003 471500                    LDP1    3,,PR0
        27 010305   000010 473400 0                  LDP3    END_LABEL_ILS$
        27 010306   300003 474500                    LDP4    3,,PR3
        27 010307   400002 236100                    LDQ     2,,PR4
        27 010310   100002 756100                    STQ     2,,PR1

     1881    17263    6                        END ;

     1882    17264
     1883    17265    5                        END_LABEL_ILS$->ILS.ILL$->ILL.LBL = REF_DEFLB->ILS.ILL$->ILL.
             17265                                 LBL ;

  17265 27 010311   000010 470400 0                  LDP0    END_LABEL_ILS$
        27 010312   000003 471500                    LDP1    3,,PR0
        27 010313   000025 473400 0                  LDP3    REF_DEFLB
        27 010314   300003 474500                    LDP4    3,,PR3
        27 010315   400002 236100                    LDQ     2,,PR4
        27 010316   100002 756100                    STQ     2,,PR1

     1884    17266    5                        REF_DEFLB->ILS.ILL$->ILL.LBL = START_LABEL_ILS$ ;

  17266 27 010317   300003 471500                    LDP1    3,,PR3
        27 010320   000006 236000 0                  LDQ     START_LABEL_ILS$
        27 010321   100002 756100                    STQ     2,,PR1

     1885    17267
     1886    17268    5                      IF NEXT_LABEL$->ILS.ILL$->ILL.ID = %DEFLB THEN

  17268 27 010322   000011 471400 0                  LDP1    NEXT_LABEL$
        27 010323   100003 474500                    LDP4    3,,PR1
        27 010324   400000 220100                    LDX0    0,,PR4
        27 010325   000346 100003                    CMPX0   230,DU
        27 010326   010332 601000 27                 TNZ     s:17271

     1887    17269    5                        NEXT_LABEL$->ILS.ILL$->ILL.LOP->LABEL.B.FALL_THRU = FALSE ;

  17269 27 010327   400001 475500                    LDP5    1,,PR4
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:344  
        27 010330   000037 236000 28                 LDQ     31
        27 010331   500003 356100                    ANSQ    3,,PR5

     1888    17270
     1889    17271    5                      EXIT CASE_STMT ;

  17271 27 010332   012101 710000 27                 TRA     s:17920

     1890    17272    5                    END ;
     1891    17273
     1892    17274        /*V*
     1893    17275        COPY_CHECK -- Check to see if the perform group is small enough to
     1894    17276                      make it beneficial to bring a copy in-line.  Count the
     1895    17277                      number of statements and compare them against the
     1896    17278                      decision breakpoint.  If they are less than the
     1897    17279                      breakpoint and there are no label references, then make a
     1898    17280                      copy of the ILS entries for the code group and link
     1899    17281                      them in line.
     1900    17282        */
     1901    17283
     1902    17284
     1903    17285    4                  PERF_STATEMENT_CHECK = START_LABEL$->LABEL.PREV_ILS$ ;

  17285 27 010333   000005 470400 0                  LDP0    START_LABEL$
        27 010334   000010 236100                    LDQ     8,,PR0
        27 010335   000004 756000 0                  STQ     PERF_STATEMENT_CHECK

     1904    17286                       %NEXT_NON_SUPPORT (POINTER=PERF_STATEMENT_CHECK) ;

  17296 27 010336   000004 470400 0                  LDP0    PERF_STATEMENT_CHECK
        27 010337   000002 236100                    LDQ     2,,PR0
        27 010340   000004 756000 0                  STQ     PERF_STATEMENT_CHECK

  17299 27 010341   000004 470400 0                  LDP0    PERF_STATEMENT_CHECK
        27 010342   000003 236100                    LDQ     3,,PR0
        27 010343   000000 116000 28                 CMPQ    0
        27 010344   010336 600000 27                 TZE     s:17296
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:345  
        27 010345   000003 471500                    LDP1    3,,PR0
        27 010346   100000 220100                    LDX0    0,,PR1
        27 010347   000343 100003                    CMPX0   227,DU
        27 010350   010336 600000 27                 TZE     s:17296
        27 010351   000422 100003                    CMPX0   274,DU
        27 010352   010336 600000 27                 TZE     s:17296
        27 010353   000446 100003                    CMPX0   294,DU
        27 010354   010336 600000 27                 TZE     s:17296
        27 010355   000336 100003                    CMPX0   222,DU
        27 010356   010336 600000 27                 TZE     s:17296
        27 010357   000420 100003                    CMPX0   272,DU
        27 010360   010336 600000 27                 TZE     s:17296
        27 010361   000373 100003                    CMPX0   251,DU
        27 010362   010336 600000 27                 TZE     s:17296

     1905    17301    4                  STATEMENT_COUNT = 0 ;

  17301 27 010363   000047 450000 0                  STZ     STATEMENT_COUNT

     1906    17302
     1907    17303    5                    DO UNTIL (STATEMENT_COUNT > %#_STATEMENTS OR

     1908    17304    5                       PERF_STATEMENT_CHECK = END_LABEL_ILS$) ;
     1909    17305    6                      DO CASE (PERF_STATEMENT_CHECK->ILS.ILL$->ILL.ID) ;

  17305 27 010364   000004 470400 0                  LDP0    PERF_STATEMENT_CHECK
        27 010365   000003 471500                    LDP1    3,,PR0
        27 010366   100000 236100                    LDQ     0,,PR1
        27 010367   000022 772000                    QRL     18
        27 010370   000336 136007                    SBLQ    222,DL
        27 010371   000111 116007                    CMPQ    73,DL
        27 010372   010374 602006 27                 TNC     s:17305+8,QL
        27 010373   010513 710000 27                 TRA     s:17322
        27 010374   010505 710000 27                 TRA     s:17311
        27 010375   010510 710000 27                 TRA     s:17319
        27 010376   010513 710000 27                 TRA     s:17322
        27 010377   010513 710000 27                 TRA     s:17322
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:346  
        27 010400   010513 710000 27                 TRA     s:17322
        27 010401   010505 710000 27                 TRA     s:17311
        27 010402   010510 710000 27                 TRA     s:17319
        27 010403   010513 710000 27                 TRA     s:17322
        27 010404   010505 710000 27                 TRA     s:17311
        27 010405   010513 710000 27                 TRA     s:17322
        27 010406   010513 710000 27                 TRA     s:17322
        27 010407   010513 710000 27                 TRA     s:17322
        27 010410   010513 710000 27                 TRA     s:17322
        27 010411   010513 710000 27                 TRA     s:17322
        27 010412   010513 710000 27                 TRA     s:17322
        27 010413   010513 710000 27                 TRA     s:17322
        27 010414   010513 710000 27                 TRA     s:17322
        27 010415   010513 710000 27                 TRA     s:17322
        27 010416   010513 710000 27                 TRA     s:17322
        27 010417   010513 710000 27                 TRA     s:17322
        27 010420   010510 710000 27                 TRA     s:17319
        27 010421   010510 710000 27                 TRA     s:17319
        27 010422   010513 710000 27                 TRA     s:17322
        27 010423   010513 710000 27                 TRA     s:17322
        27 010424   010510 710000 27                 TRA     s:17319
        27 010425   010513 710000 27                 TRA     s:17322
        27 010426   010513 710000 27                 TRA     s:17322
        27 010427   010513 710000 27                 TRA     s:17322
        27 010430   010513 710000 27                 TRA     s:17322
        27 010431   010505 710000 27                 TRA     s:17311
        27 010432   010513 710000 27                 TRA     s:17322
        27 010433   010510 710000 27                 TRA     s:17319
        27 010434   010510 710000 27                 TRA     s:17319
        27 010435   010510 710000 27                 TRA     s:17319
        27 010436   010510 710000 27                 TRA     s:17319
        27 010437   010510 710000 27                 TRA     s:17319
        27 010440   010513 710000 27                 TRA     s:17322
        27 010441   010513 710000 27                 TRA     s:17322
        27 010442   010510 710000 27                 TRA     s:17319
        27 010443   010513 710000 27                 TRA     s:17322
        27 010444   010513 710000 27                 TRA     s:17322
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:347  
        27 010445   010513 710000 27                 TRA     s:17322
        27 010446   010513 710000 27                 TRA     s:17322
        27 010447   010513 710000 27                 TRA     s:17322
        27 010450   010513 710000 27                 TRA     s:17322
        27 010451   010513 710000 27                 TRA     s:17322
        27 010452   010513 710000 27                 TRA     s:17322
        27 010453   010513 710000 27                 TRA     s:17322
        27 010454   010513 710000 27                 TRA     s:17322
        27 010455   010513 710000 27                 TRA     s:17322
        27 010456   010505 710000 27                 TRA     s:17311
        27 010457   010513 710000 27                 TRA     s:17322
        27 010460   010505 710000 27                 TRA     s:17311
        27 010461   010513 710000 27                 TRA     s:17322
        27 010462   010513 710000 27                 TRA     s:17322
        27 010463   010513 710000 27                 TRA     s:17322
        27 010464   010513 710000 27                 TRA     s:17322
        27 010465   010513 710000 27                 TRA     s:17322
        27 010466   010513 710000 27                 TRA     s:17322
        27 010467   010513 710000 27                 TRA     s:17322
        27 010470   010513 710000 27                 TRA     s:17322
        27 010471   010513 710000 27                 TRA     s:17322
        27 010472   010513 710000 27                 TRA     s:17322
        27 010473   010513 710000 27                 TRA     s:17322
        27 010474   010513 710000 27                 TRA     s:17322
        27 010475   010513 710000 27                 TRA     s:17322
        27 010476   010513 710000 27                 TRA     s:17322
        27 010477   010513 710000 27                 TRA     s:17322
        27 010500   010513 710000 27                 TRA     s:17322
        27 010501   010513 710000 27                 TRA     s:17322
        27 010502   010513 710000 27                 TRA     s:17322
        27 010503   010513 710000 27                 TRA     s:17322
        27 010504   010505 710000 27                 TRA     s:17311

     1910    17306
     1911    17307    6                        CASE (%LINOI, %DEFLB, %PREOFF, %PRESET, %P_A_PRESET,

     1912    17308    6                              %PTR_SET, %P_P_PRESET);
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:348  
     1913    17309                               %NEXT_ILS (POINTER=PERF_STATEMENT_CHECK) ;

  17311 27 010505   000002 236100                    LDQ     2,,PR0
        27 010506   000004 756000 0                  STQ     PERF_STATEMENT_CHECK

  17312 27 010507   010516 710000 27                 TRA     s:17330

     1914    17314
     1915    17315    6                        CASE (%GO,%PFORM,%DO1,%DO2,%DO3,%DO4,%DO5/*,%DO6 */,

     1916    17316    6                              %STOP,%EXIT_PROG,%USER_CALL,%OS_CALL) ;
     1917    17317
     1918    17318
     1919    17319    6                          STATEMENT_COUNT = %(#_STATEMENTS + 1) ;

  17319 27 010510   000005 235007                    LDA     5,DL
        27 010511   000047 755000 0                  STA     STATEMENT_COUNT
        27 010512   010516 710000 27                 TRA     s:17330

     1920    17320
     1921    17321    6                        CASE (ELSE) ;

     1922    17322    6                          STATEMENT_COUNT = STATEMENT_COUNT + 1 ;

  17322 27 010513   000047 054000 0                  AOS     STATEMENT_COUNT

     1923    17323                               %NEXT_ILS (POINTER=PERF_STATEMENT_CHECK) ;

  17325 27 010514   000002 236100                    LDQ     2,,PR0
        27 010515   000004 756000 0                  STQ     PERF_STATEMENT_CHECK

     1924    17328
     1925    17329    6                      END ;

     1926    17330    5                      IF PERF_STATEMENT_CHECK = ADDR(NIL) THEN

  17330 27 010516   000004 236000 0                  LDQ     PERF_STATEMENT_CHECK
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:349  
        27 010517   000000 116000 28                 CMPQ    0
        27 010520   010523 601000 27                 TNZ     s:17332

     1927    17331    5                          STATEMENT_COUNT=%(#_STATEMENTS + 1) ;

  17331 27 010521   000005 235007                    LDA     5,DL
        27 010522   000047 755000 0                  STA     STATEMENT_COUNT

     1928    17332    5                    END ;

  17332 27 010523   000047 235000 0                  LDA     STATEMENT_COUNT
        27 010524   000004 115007                    CMPA    4,DL
        27 010525   010530 605400 27                 TPNZ    s:17349
        27 010526   000010 116000 0                  CMPQ    END_LABEL_ILS$
        27 010527   010364 601000 27                 TNZ     s:17305

     1929    17333        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:350  
     1930    17334        /*V*
     1931    17335            COPY_CODE_IN_LINE --
     1932    17336                If the number of statements is below the decision breakpoint then
     1933    17337                copy it in line.  This is done by searching the code group and
     1934    17338                creating copies of the ILS entries.
     1935    17339
     1936    17340                If a label or preset is encountered then no copy is made of the ILS
     1937    17341                entry as this would cause problems in the created OU.  If a LINOI
     1938    17342                is found then we set the line type to %NO_STATEMENT_TYPE so the LS is
     1939    17343                created correctly.  If any other items are found then a copy is made of
     1940    17344                the ILS entry.
     1941    17345
     1942    17346                This is not done in case of the NOPTZ option.
     1943    17347        */
     1944    17348
     1945    17349    4                  IF STATEMENT_COUNT < %#_STATEMENTS THEN

  17349 27 010530   000004 115007                    CMPA    4,DL
        27 010531   010773 605000 27                 TPL     s:17506

     1946    17350    5                    DO ;

     1947    17351    5                      INITIAL_ILS$ = START_LABEL_ILS$ ;

  17351 27 010532   000006 236000 0                  LDQ     START_LABEL_ILS$
        27 010533   000016 756000 0                  STQ     INITIAL_ILS$

     1948    17352                           %NEXT_ILS (POINTER=INITIAL_ILS$) ;

  17354 27 010534   000016 470400 0                  LDP0    INITIAL_ILS$
        27 010535   000002 236100                    LDQ     2,,PR0
        27 010536   000016 756000 0                  STQ     INITIAL_ILS$

     1949    17357    5                      COPY_ILS$ = PREV_ILS$ ;

  17357 27 010537   000001 236000 0                  LDQ     PREV_ILS$
        27 010540   000020 756000 0                  STQ     COPY_ILS$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:351  

     1950    17358                           %NEXT_ILS (POINTER=COPY_ILS$) ;

  17360 27 010541   000020 470400 0                  LDP0    COPY_ILS$
        27 010542   000002 236100                    LDQ     2,,PR0
        27 010543   000020 756000 0                  STQ     COPY_ILS$

     1951    17363
     1952    17364    6                      DO UNTIL (INITIAL_ILS$->ILS.NEXT = END_LABEL_ILS$) ;

     1953    17365
     1954    17366    7                        DO SELECT(INITIAL_ILS$->ILS.ILL$->ILL.ID) ;

  17366 27 010544   000016 470400 0                  LDP0    INITIAL_ILS$
        27 010545   000003 471500                    LDP1    3,,PR0
        27 010546   100000 236100                    LDQ     0,,PR1
        27 010547   000022 772000                    QRL     18
        27 010550   000346 116007                    CMPQ    230,DL
        27 010551   010572 602000 27                 TNC     s:17366+22
        27 010552   010602 600000 27                 TZE     s:17372
        27 010553   000422 116007                    CMPQ    274,DL
        27 010554   010562 602000 27                 TNC     s:17366+14
        27 010555   010602 600000 27                 TZE     s:17372
        27 010556   100000 220100                    LDX0    0,,PR1
        27 010557   000446 100003                    CMPX0   294,DU
        27 010560   010666 601000 27                 TNZ     s:17432
        27 010561   010602 710000 27                 TRA     s:17372
        27 010562   000420 116007                    CMPQ    272,DL
        27 010563   010566 602000 27                 TNC     s:17366+18
        27 010564   010602 600000 27                 TZE     s:17372
        27 010565   010666 710000 27                 TRA     s:17432
        27 010566   100000 220100                    LDX0    0,,PR1
        27 010567   000373 100003                    CMPX0   251,DU
        27 010570   010666 601000 27                 TNZ     s:17432
        27 010571   010605 710000 27                 TRA     s:17377
        27 010572   000343 116007                    CMPQ    227,DL
        27 010573   010576 602000 27                 TNC     s:17366+26
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:352  
        27 010574   010602 600000 27                 TZE     s:17372
        27 010575   010666 710000 27                 TRA     s:17432
        27 010576   100000 220100                    LDX0    0,,PR1
        27 010577   000336 100003                    CMPX0   222,DU
        27 010600   010666 601000 27                 TNZ     s:17432
        27 010601   010602 710000 27                 TRA     s:17372

     1955    17367
     1956    17368    7                          SELECT(%DEFLB, %PTR_SET, %PRESET, %P_A_PRESET, %PREOFF, %
             17368                                   P_P_PRESET) ;

     1957    17369
     1958    17370                                 %NEXT_ILS (POINTER=INITIAL_ILS$) ;

  17372 27 010602   000002 236100                    LDQ     2,,PR0
        27 010603   000016 756000 0                  STQ     INITIAL_ILS$

  17373 27 010604   010744 710000 27                 TRA     s:17473

     1959    17375
     1960    17376    7                          SELECT(%LINOI) ;

     1961    17377    7                            INITIAL_ILS$->ILS.ILL$->LINOI.TYPE =

  17377 27 010605   000000 221003                    LDX1    0,DU
        27 010606   100002 741100                    STX1    2,,PR1

     1962    17378    7                              %NO_STATEMENT_TYPE ;
     1963    17379                                 %COPY_ILS_ENTRY ;

  17385 27 010607   000000 220100                    LDX0    0,,PR0
        27 010610   777040 235010 xsym               LDA     ILS_STEP_TABLE-480,X0
        27 010611   000000 755000 1                  STA     ITERATION

  17386 27 010612   000002 236000 7                  LDQ     ILS_+2
        27 010613   000000 036000 1                  ADLQ    ITERATION
        27 010614   010627 604000 27                 TMI     s:17388
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:353  
        27 010615   000003 116000 7                  CMPQ    ILS_+3
        27 010616   010627 602000 27                 TNC     s:17388

  17387 27 010617   000002 236000 28                 LDQ     2
        27 010620   000130 756000 0                  STQ     OPT_FLAG+1
        27 010621   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 010622   000131 451400 0                  STP1    OPT_FLAG+2
        27 010623   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 010624   000001 631400 28                 EPPR1   1
        27 010625   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 010626   000000 011000                    NOP     0

  17388 27 010627   000002 236000 7                  LDQ     ILS_+2
        27 010630   000022 736000                    QLS     18
        27 010631   000001 036000 7                  ADLQ    ILS_+1
        27 010632   000021 756000 0                  STQ     NEXT_COPY$

  17389 27 010633   000002 236000 7                  LDQ     ILS_+2
        27 010634   000000 036000 1                  ADLQ    ITERATION
        27 010635   000002 756000 7                  STQ     ILS_+2

  17390 27 010636   000016 470400 0                  LDP0    INITIAL_ILS$
        27 010637   000000 220100                    LDX0    0,,PR0
        27 010640   000021 471400 0                  LDP1    NEXT_COPY$
        27 010641   100000 740100                    STX0    0,,PR1

  17391 27 010642   000000 236000 28                 LDQ     0
        27 010643   100002 756100                    STQ     2,,PR1

  17411 27 010644   000000 221100                    LDX1    0,,PR0
        27 010645   000740 101003                    CMPX1   480,DU
        27 010646   010653 601000 27                 TNZ     s:17414

  17412 27 010647   000100 100500                    MLR     fill='000'O
        27 010650   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16
        27 010651   100000 000020                    ADSC9   0,,PR1                   cn=0,n=16
        27 010652   010656 710000 27                 TRA     s:17415
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:354  

  17414 27 010653   000100 100500                    MLR     fill='000'O
        27 010654   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20
        27 010655   100000 000024                    ADSC9   0,,PR1                   cn=0,n=20

  17415 27 010656   000021 236000 0                  LDQ     NEXT_COPY$
        27 010657   000020 473400 0                  LDP3    COPY_ILS$
        27 010660   300002 756100                    STQ     2,,PR3

  17418 27 010661   000002 236100                    LDQ     2,,PR0
        27 010662   000016 756000 0                  STQ     INITIAL_ILS$

  17421 27 010663   000021 236000 0                  LDQ     NEXT_COPY$
        27 010664   000020 756000 0                  STQ     COPY_ILS$

  17422 27 010665   010744 710000 27                 TRA     s:17473

     1964    17424
     1965    17425    7                          SELECT(ELSE) ;

     1966    17426                                 %COPY_ILS_ENTRY ;

  17432 27 010666   000000 220100                    LDX0    0,,PR0
        27 010667   777040 235010 xsym               LDA     ILS_STEP_TABLE-480,X0
        27 010670   000000 755000 1                  STA     ITERATION

  17433 27 010671   000002 236000 7                  LDQ     ILS_+2
        27 010672   000000 036000 1                  ADLQ    ITERATION
        27 010673   010706 604000 27                 TMI     s:17435
        27 010674   000003 116000 7                  CMPQ    ILS_+3
        27 010675   010706 602000 27                 TNC     s:17435

  17434 27 010676   000002 236000 28                 LDQ     2
        27 010677   000130 756000 0                  STQ     OPT_FLAG+1
        27 010700   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 010701   000131 451400 0                  STP1    OPT_FLAG+2
        27 010702   000131 630400 0                  EPPR0   OPT_FLAG+2
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:355  
        27 010703   000001 631400 28                 EPPR1   1
        27 010704   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 010705   000000 011000                    NOP     0

  17435 27 010706   000002 236000 7                  LDQ     ILS_+2
        27 010707   000022 736000                    QLS     18
        27 010710   000001 036000 7                  ADLQ    ILS_+1
        27 010711   000021 756000 0                  STQ     NEXT_COPY$

  17436 27 010712   000002 236000 7                  LDQ     ILS_+2
        27 010713   000000 036000 1                  ADLQ    ITERATION
        27 010714   000002 756000 7                  STQ     ILS_+2

  17437 27 010715   000016 470400 0                  LDP0    INITIAL_ILS$
        27 010716   000000 220100                    LDX0    0,,PR0
        27 010717   000021 471400 0                  LDP1    NEXT_COPY$
        27 010720   100000 740100                    STX0    0,,PR1

  17438 27 010721   000000 236000 28                 LDQ     0
        27 010722   100002 756100                    STQ     2,,PR1

  17458 27 010723   000000 221100                    LDX1    0,,PR0
        27 010724   000740 101003                    CMPX1   480,DU
        27 010725   010732 601000 27                 TNZ     s:17461

  17459 27 010726   000100 100500                    MLR     fill='000'O
        27 010727   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16
        27 010730   100000 000020                    ADSC9   0,,PR1                   cn=0,n=16
        27 010731   010735 710000 27                 TRA     s:17462

  17461 27 010732   000100 100500                    MLR     fill='000'O
        27 010733   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20
        27 010734   100000 000024                    ADSC9   0,,PR1                   cn=0,n=20

  17462 27 010735   000021 236000 0                  LDQ     NEXT_COPY$
        27 010736   000020 473400 0                  LDP3    COPY_ILS$
        27 010737   300002 756100                    STQ     2,,PR3
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:356  

  17465 27 010740   000002 236100                    LDQ     2,,PR0
        27 010741   000016 756000 0                  STQ     INITIAL_ILS$

  17468 27 010742   000021 236000 0                  LDQ     NEXT_COPY$
        27 010743   000020 756000 0                  STQ     COPY_ILS$

     1967    17471
     1968    17472    7                        END ;

     1969    17473    6                      END ;

  17473 27 010744   000016 470400 0                  LDP0    INITIAL_ILS$
        27 010745   000002 236100                    LDQ     2,,PR0
        27 010746   000010 116000 0                  CMPQ    END_LABEL_ILS$
        27 010747   010544 601000 27                 TNZ     s:17366

     1970    17474
     1971    17475    5                      COPY_ILS$->ILS.NEXT = NEXT_ILS$ ;

  17475 27 010750   000002 236000 0                  LDQ     NEXT_ILS$
        27 010751   000020 471400 0                  LDP1    COPY_ILS$
        27 010752   100002 756100                    STQ     2,,PR1

     1972    17476    5                      IF DEFLB_FOLLOWS

  17476 27 010753   000055 234000 0                  SZN     DEFLB_FOLLOWS
        27 010754   010760 605000 27                 TPL     s:17478

     1973    17477    5                        THEN LABEL_AFTER_PFORM$->LABEL.PREV_ILS$ = COPY_ILS$ ;

  17477 27 010755   000020 236000 0                  LDQ     COPY_ILS$
        27 010756   000056 473400 0                  LDP3    LABEL_AFTER_PFORM$
        27 010757   300010 756100                    STQ     8,,PR3

     1974    17478    5                      FALL_THRU_FLAG = 1 ; /* Fall thru possible */

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:357  
  17478 27 010760   000001 235007                    LDA     1,DL
        27 010761   000053 755000 0                  STA     FALL_THRU_FLAG

     1975    17479    5                      ILS$ = PREV_ILS$ ;

  17479 27 010762   000001 236000 0                  LDQ     PREV_ILS$
        27 010763   000000 756000 6                  STQ     ILS$

     1976    17480                           %NEXT_ILS ;

  17482 27 010764   000000 473400 6                  LDP3    ILS$
        27 010765   300002 236100                    LDQ     2,,PR3
        27 010766   000000 756000 6                  STQ     ILS$

     1977    17485                           %NEXT_ILS ;

  17487 27 010767   000000 473400 6                  LDP3    ILS$
        27 010770   300002 236100                    LDQ     2,,PR3
        27 010771   000000 756000 6                  STQ     ILS$

     1978    17490    5                      EXIT CASE_STMT ;

  17490 27 010772   012101 710000 27                 TRA     s:17920

     1979    17491    5                    END ;
     1980    17492        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:358  
     1981    17493        /*V*
     1982    17494            ASSIGN_PFORM_INFO -- The PFORM cannot be transfered or copied in line
     1983    17495                                 so it is left as a PFORM.
     1984    17496
     1985    17497                                 If OPTZ and PERFORM n TIMES then remember location
     1986    17498                                 of the DO2's ILS item.
     1987    17499
     1988    17500                                 The paragraph and section that the PFORM are located
     1989    17501                                 in are marked as containing a PFORM statement.
     1990    17502                                 The PFORM is then linked into the list of PFORMs.
     1991    17503        */
     1992    17504    4                END;
     1993    17505
     1994    17506    3                IF PREV_ILS$->ILS.ILL$->ILL.ID = %DO2 THEN

  17506 27 010773   000001 470400 0                  LDP0    PREV_ILS$
        27 010774   000003 471500                    LDP1    3,,PR0
        27 010775   100000 220100                    LDX0    0,,PR1
        27 010776   000376 100003                    CMPX0   254,DU
        27 010777   011003 601000 27                 TNZ     s:17509

     1995    17507    3                  ILL$->PFORM.DO$ = DO_LINOI$ ;

  17507 27 011000   000023 236000 0                  LDQ     DO_LINOI$
        27 011001   000000 473400 10                 LDP3    ILL$
        27 011002   300005 756100                    STQ     5,,PR3

     1996    17508
     1997    17509    3                IF O2COM.LAST_LBL$ ~= ADDR(NIL) THEN

  17509 27 011003   000002 236000 25                 LDQ     O2COM+2
        27 011004   000000 116000 28                 CMPQ    0
        27 011005   011026 600000 27                 TZE     s:17519

     1998    17510    4                  DO ;

     1999    17511    4                    O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.B.PFORM_NESTED = TRUE ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:359  

  17511 27 011006   000002 471400 25                 LDP1    O2COM+2
        27 011007   100003 473500                    LDP3    3,,PR1
        27 011010   300001 474500                    LDP4    1,,PR3
        27 011011   000100 236003                    LDQ     64,DU
        27 011012   400003 256100                    ORSQ    3,,PR4

     2000    17512
     2001    17513    4                    IF O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.SECTION$ ~= ADDR(NIL)
             17513                             AND

  17513 27 011013   100003 473500                    LDP3    3,,PR1
        27 011014   300001 474500                    LDP4    1,,PR3
        27 011015   400007 236100                    LDQ     7,,PR4
        27 011016   000000 116000 28                 CMPQ    0
        27 011017   011026 600000 27                 TZE     s:17519
        27 011020   400007 475500                    LDP5    7,,PR4
        27 011021   500000 220100                    LDX0    0,,PR5
        27 011022   000770 100003                    CMPX0   504,DU
        27 011023   011026 601000 27                 TNZ     s:17519

     2002    17514    4                       O2COM.LAST_LBL$ -> ILS.ILL$ -> ILL.LOP ->
     2003    17515    4                         LABEL.SECTION$ -> LABEL.ID = %SECTION THEN
     2004    17516    4                      O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.SECTION$->LABEL.B.
             17516                               PFORM_NESTED = TRUE ;

  17516 27 011024   000100 236003                    LDQ     64,DU
        27 011025   500003 256100                    ORSQ    3,,PR5

     2005    17517    4                  END ;

     2006    17518
     2007    17519    3                IF COMCOM.H_PFORM = ADDR(NIL) THEN

  17519 27 011026   000126 236000 xsym               LDQ     COMCOM+86
        27 011027   000000 116000 28                 CMPQ    0
        27 011030   011034 601000 27                 TNZ     s:17522
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:360  

     2008    17520    3                  COMCOM.H_PFORM = ILS$ ;

  17520 27 011031   000000 236000 6                  LDQ     ILS$
        27 011032   000126 756000 xsym               STQ     COMCOM+86
        27 011033   011040 710000 27                 TRA     s:17523

     2009    17521    3                ELSE
     2010    17522    3                  O2COM.PFORM_LIST$->ILS.ILL$->PFORM.PFORM_LIST$ = ILS$ ;

  17522 27 011034   000001 471400 25                 LDP1    O2COM+1
        27 011035   100003 473500                    LDP3    3,,PR1
        27 011036   000000 236000 6                  LDQ     ILS$
        27 011037   300004 756100                    STQ     4,,PR3

     2011    17523    3                O2COM.PFORM_LIST$ = ILS$ ;

  17523 27 011040   000001 756000 25                 STQ     O2COM+1

     2012    17524
     2013    17525    3                PREV_ILS$ = ILS$ ;

  17525 27 011041   000001 756000 0                  STQ     PREV_ILS$

     2014    17526    3                ILS$ = NEXT_ILS$ ;

  17526 27 011042   000002 236000 0                  LDQ     NEXT_ILS$
        27 011043   000000 756000 6                  STQ     ILS$
        27 011044   012101 710000 27                 TRA     s:17920

     2015    17527
     2016    17528        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:361  
     2017    17529        /*V*
     2018    17530            ALTER -- The left operand of the ILL (which points to the switch variable)
     2019    17531                     may be NILL due to Z8FL$LABEL_REFERENCE.  If it is then the
     2020    17532                     ALTER will be deleted otherwise a BASE item is created above
     2021    17533                     the SWITCH.
     2022    17534        */
     2023    17535    3              CASE (%ALTER) ;

     2024    17536    3                IF ILL$->ILL.LOP = ADDR(NIL) THEN

  17536 27 011045   000001 236100                    LDQ     1,,PR0
        27 011046   000000 116000 28                 CMPQ    0
        27 011047   011054 601000 27                 TNZ     s:17540

     2025    17537    3                  PREV_ILS$->ILS.NEXT = NEXT_ILS$ ;

  17537 27 011050   000002 236000 0                  LDQ     NEXT_ILS$
        27 011051   000001 471400 0                  LDP1    PREV_ILS$
        27 011052   100002 756100                    STQ     2,,PR1
        27 011053   011110 710000 27                 TRA     s:17556

     2026    17538    3                ELSE
     2027    17539    4                  DO ;

     2028    17540    4                    IF ILL$ -> ILL.LOP -> ETT.ID = %BASE THEN

  17540 27 011054   000001 471500                    LDP1    1,,PR0
        27 011055   100000 220100                    LDX0    0,,PR1
        27 011056   000001 100003                    CMPX0   1,DU
        27 011057   011075 600000 27                 TZE     s:17549

     2029    17541                           /* Flow analysis already done on this ALTER, probably
     2030    17542                              because a PERFORM code group was copied in-line. */
     2031    17543    4                                                              ;
     2032    17544    4                      ELSE
     2033    17545    4                        CALL Z8AF$NEW_BASE (ILL$ -> ILL.LOP -> LABEL.POINTER$,

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:362  
  17545 27 011060   000000 236000 28                 LDQ     0
        27 011061   000130 756000 0                  STQ     OPT_FLAG+1
        27 011062   000000 236000 10                 LDQ     ILL$
        27 011063   000001 036003                    ADLQ    1,DU
        27 011064   000133 756000 0                  STQ     OPT_FLAG+4
        27 011065   000130 633400 0                  EPPR3   OPT_FLAG+1
        27 011066   000132 453400 0                  STP3    OPT_FLAG+3
        27 011067   100005 634500                    EPPR4   5,,PR1
        27 011070   000131 454400 0                  STP4    OPT_FLAG+2
        27 011071   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 011072   000023 631400 28                 EPPR1   19
        27 011073   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        27 011074   000000 011000                    NOP     0

     2034    17546    4                                            ADDR(NIL),
     2035    17547    4                                            ILL$ -> ILL.LOP) ;
     2036    17548
     2037    17549    4                    IF ILS$->ILS.ID = %OPV

  17549 27 011075   000000 470400 6                  LDP0    ILS$
        27 011076   000000 220100                    LDX0    0,,PR0
        27 011077   000741 100003                    CMPX0   481,DU
        27 011100   011104 601000 27                 TNZ     s:17551

     2038    17550    4                    THEN ILS$->ILS.DNAME = ILL$->ILL.LOP ;

  17550 27 011101   000000 471400 10                 LDP1    ILL$
        27 011102   100001 236100                    LDQ     1,,PR1
        27 011103   000004 756100                    STQ     4,,PR0

     2039    17551    4                    FALL_THRU_FLAG = 1 ; /* Fall thru possible */

  17551 27 011104   000001 235007                    LDA     1,DL
        27 011105   000053 755000 0                  STA     FALL_THRU_FLAG

     2040    17552
     2041    17553    4                    PREV_ILS$ = ILS$ ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:363  

  17553 27 011106   000000 236000 6                  LDQ     ILS$
        27 011107   000001 756000 0                  STQ     PREV_ILS$

     2042    17554    4                  END ;

     2043    17555
     2044    17556    3                ILS$ = NEXT_ILS$ ;

  17556 27 011110   000002 236000 0                  LDQ     NEXT_ILS$
        27 011111   000000 756000 6                  STQ     ILS$
        27 011112   012101 710000 27                 TRA     s:17920

     2045    17557        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:364  
     2046    17558        /*V*
     2047    17559            MVII -- Two consecutive MVIIs may represent a DIVIDE statement with
     2048    17560                    remainder. If so, optimize them to a DV4I.
     2049    17561        */
     2050    17562    3              CASE (%MVII) ;

     2051    17563    3                ILS$$ = ILS$ ;

  17563 27 011113   000000 236000 6                  LDQ     ILS$
        27 011114   000060 756000 0                  STQ     ILS$$

     2052    17564                     %NEXT_NON_SUPPORT (POINTER=ILS$$) ;

  17574 27 011115   000060 470400 0                  LDP0    ILS$$
        27 011116   000002 236100                    LDQ     2,,PR0
        27 011117   000060 756000 0                  STQ     ILS$$

  17577 27 011120   000060 470400 0                  LDP0    ILS$$
        27 011121   000003 236100                    LDQ     3,,PR0
        27 011122   000000 116000 28                 CMPQ    0
        27 011123   011115 600000 27                 TZE     s:17574
        27 011124   000003 471500                    LDP1    3,,PR0
        27 011125   100000 220100                    LDX0    0,,PR1
        27 011126   000343 100003                    CMPX0   227,DU
        27 011127   011115 600000 27                 TZE     s:17574
        27 011130   000422 100003                    CMPX0   274,DU
        27 011131   011115 600000 27                 TZE     s:17574
        27 011132   000446 100003                    CMPX0   294,DU
        27 011133   011115 600000 27                 TZE     s:17574
        27 011134   000336 100003                    CMPX0   222,DU
        27 011135   011115 600000 27                 TZE     s:17574
        27 011136   000420 100003                    CMPX0   272,DU
        27 011137   011115 600000 27                 TZE     s:17574
        27 011140   000373 100003                    CMPX0   251,DU
        27 011141   011115 600000 27                 TZE     s:17574

     2053    17579    3                TEMP$ = ILS$$->ILS.ILL$ ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:365  

  17579 27 011142   000110 756000 0                  STQ     TEMP$

     2054    17580    3                IF ILL$->ILL.ROP->ETT.ID = %DVI

  17580 27 011143   000000 473400 10                 LDP3    ILL$
        27 011144   300002 474500                    LDP4    2,,PR3
        27 011145   400000 221100                    LDX1    0,,PR4
        27 011146   000062 101003                    CMPX1   50,DU
        27 011147   011337 601000 27                 TNZ     s:17639
        27 011150   000110 475400 0                  LDP5    TEMP$
        27 011151   500000 222100                    LDX2    0,,PR5
        27 011152   000245 102003                    CMPX2   165,DU
        27 011153   011337 601000 27                 TNZ     s:17639
        27 011154   500002 476500                    LDP6    2,,PR5
        27 011155   600000 223100                    LDX3    0,,PR6
        27 011156   000056 103003                    CMPX3   46,DU
        27 011157   011337 601000 27                 TNZ     s:17639
        27 011160   400001 236100                    LDQ     1,,PR4
        27 011161   600001 116100                    CMPQ    1,,PR6
        27 011162   011337 601000 27                 TNZ     s:17639
        27 011163   600002 477500                    LDP7    2,,PR6
        27 011164   700000 224100                    LDX4    0,,PR7
        27 011165   000060 104003                    CMPX4   48,DU
        27 011166   011337 601000 27                 TNZ     s:17639
        27 011167   300001 236100                    LDQ     1,,PR3
        27 011170   700002 116100                    CMPQ    2,,PR7
        27 011171   011337 601000 27                 TNZ     s:17639
        27 011172   400002 236100                    LDQ     2,,PR4
        27 011173   700001 116100                    CMPQ    1,,PR7
        27 011174   011337 601000 27                 TNZ     s:17639

     2055    17581    3                    AND TEMP$->ILL.ID = %MVII
     2056    17582    3                    AND TEMP$->ILL.ROP->ETT.ID = %SBI
     2057    17583    3                    AND ILL$->ILL.ROP->ETT.LOP = TEMP$->ILL.ROP->ETT.LOP
     2058    17584    3                    AND TEMP$->ILL.ROP->ETT.ROP->ETT.ID = %MPI
     2059    17585    3                    AND ILL$->ILL.LOP = TEMP$->ILL.ROP->ETT.ROP->ETT.ROP
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:366  
     2060    17586    3                    AND ILL$->ILL.ROP->ETT.ROP = TEMP$->ILL.ROP->ETT.ROP->ETT.LOP THEN
     2061    17587    4                  DO ;

     2062    17588    4                    ILL$$ = ILL$ ;

  17588 27 011175   000000 236000 10                 LDQ     ILL$
        27 011176   000061 756000 0                  STQ     ILL$$

     2063    17589    4                    IF ILS$->ILS.B.CDEF OR ILS$$->ILS.B.CDEF THEN

  17589 27 011177   000000 470400 6                  LDP0    ILS$
        27 011200   000001 234100                    SZN     1,,PR0
        27 011201   011205 604000 27                 TMI     s:17593
        27 011202   000060 471400 0                  LDP1    ILS$$
        27 011203   100001 234100                    SZN     1,,PR1
        27 011204   011250 605000 27                 TPL     s:17611

     2064    17590    5                      DO ; /* Simple case, common redefinition */

     2065    17591                             %RESERVE_ILL (POINTER=ILL$, ITEM=%DV4I) ;

  17593 27 011205   000104 235000 xsym               LDA     ILL_STEP+68
        27 011206   000000 755000 1                  STA     ITERATION

  17594 27 011207   000002 236000 11                 LDQ     ILL_+2
        27 011210   000000 036000 1                  ADLQ    ITERATION
        27 011211   000003 116000 11                 CMPQ    ILL_+3
        27 011212   011223 604000 27                 TMI     s:17596

  17595 27 011213   000003 236000 28                 LDQ     3
        27 011214   000130 756000 0                  STQ     OPT_FLAG+1
        27 011215   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 011216   000131 451400 0                  STP1    OPT_FLAG+2
        27 011217   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 011220   000001 631400 28                 EPPR1   1
        27 011221   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 011222   000000 011000                    NOP     0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:367  

  17596 27 011223   000002 236000 11                 LDQ     ILL_+2
        27 011224   000022 736000                    QLS     18
        27 011225   000001 036000 11                 ADLQ    ILL_+1
        27 011226   000000 756000 10                 STQ     ILL$

  17597 27 011227   000002 236000 11                 LDQ     ILL_+2
        27 011230   000000 036000 1                  ADLQ    ITERATION
        27 011231   000002 756000 11                 STQ     ILL_+2

  17598 27 011232   000332 220003                    LDX0    218,DU
        27 011233   000000 470400 10                 LDP0    ILL$
        27 011234   000000 740100                    STX0    0,,PR0

     2066    17601    5                        ILS$->ILS.ID = %OPA ; /* Length same for OPV, OPA */

  17601 27 011235   000742 221003                    LDX1    482,DU
        27 011236   000000 470400 6                  LDP0    ILS$
        27 011237   000000 741100                    STX1    0,,PR0

     2067    17602    5                        ILS$->ILS.B.CDEF = TRUE ;

  17602 27 011240   000000 470400 6                  LDP0    ILS$
        27 011241   400000 236003                    LDQ     -131072,DU
        27 011242   000001 256100                    ORSQ    1,,PR0

     2068    17603    5                        ILS$->ILS.ILL$ = ILL$ ;

  17603 27 011243   000000 236000 10                 LDQ     ILL$
        27 011244   000003 756100                    STQ     3,,PR0

     2069    17604    5                        PREV_ILS$ = ILS$ ;

  17604 27 011245   000000 236000 6                  LDQ     ILS$
        27 011246   000001 756000 0                  STQ     PREV_ILS$

     2070    17605    5                      END ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:368  

  17605 27 011247   011316 710000 27                 TRA     s:17632

     2071    17606    4                    ELSE
     2072    17607    5                      DO ;

     2073    17608    6                        DO UNTIL PREV_ILS$->ILS.NEXT = ILS$ ;

     2074    17609                               %NEXT_ILS (POINTER=PREV_ILS$) ;

  17611 27 011250   000001 470400 0                  LDP0    PREV_ILS$
        27 011251   000002 236100                    LDQ     2,,PR0
        27 011252   000001 756000 0                  STQ     PREV_ILS$

     2075    17614    6                        END ;

  17614 27 011253   000001 470400 0                  LDP0    PREV_ILS$
        27 011254   000002 236100                    LDQ     2,,PR0
        27 011255   000000 116000 6                  CMPQ    ILS$
        27 011256   011250 601000 27                 TNZ     s:17611

     2076    17615    5                        ADDR(TEMP_ILS_LIST)->ILS_LIST.ID = %ILS_LIST ;

  17615 27 011257   000007 220003                    LDX0    7,DU
        27 011260   000064 740000 0                  STX0    TEMP_ILS_LIST

     2077    17616    5                        ADDR(TEMP_ILS_LIST)->ILS_LIST.HEAD$ = ADDR(NIL) ;

  17616 27 011261   000000 236000 28                 LDQ     0
        27 011262   000065 756000 0                  STQ     TEMP_ILS_LIST+1

     2078    17617    5                        ADDR(TEMP_ILS_LIST)->ILS_LIST.TAIL$ = ADDR(NIL) ;

  17617 27 011263   000066 756000 0                  STQ     TEMP_ILS_LIST+2

     2079    17618    5                        CALL Z8AN$NEW_ILL2 (%TWO_REDEFS, %DV4I, ILL$,

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:369  
  17618 27 011264   000043 236000 28                 LDQ     35
        27 011265   000130 756000 0                  STQ     OPT_FLAG+1
        27 011266   000110 236000 0                  LDQ     TEMP$
        27 011267   000001 036003                    ADLQ    1,DU
        27 011270   000137 756000 0                  STQ     OPT_FLAG+8
        27 011271   000000 236000 10                 LDQ     ILL$
        27 011272   000001 036003                    ADLQ    1,DU
        27 011273   000136 756000 0                  STQ     OPT_FLAG+7
        27 011274   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 011275   000135 451400 0                  STP1    OPT_FLAG+6
        27 011276   000044 236000 28                 LDQ     36
        27 011277   000134 756000 0                  STQ     OPT_FLAG+5
        27 011300   000046 237000 28                 LDAQ    38
        27 011301   000132 757000 0                  STAQ    OPT_FLAG+3
        27 011302   000132 630400 0                  EPPR0   OPT_FLAG+3
        27 011303   000040 631400 28                 EPPR1   32
        27 011304   000000 701000 xent               TSX1    Z8AN$NEW_ILL2
        27 011305   000000 011000                    NOP     0

     2080    17619    5                            ADDR (TEMP_ILS_LIST), ILL$->ILL.LOP, TEMP$->ILL.LOP) ;
     2081    17620                             /* One could replicate the complex logic for building the
     2082    17621                                DPI chain in this module, but that would make it
     2083    17622                                necessary to update it here too any time it is changed
     2084    17623                                in Z8AN. It is easier and safer to rely on the module
     2085    17624                                that already knows how to set up the DPI chain. */
     2086    17625    5                        ADDR(TEMP_ILS_LIST)->ILS_LIST.TAIL$->ILS.NEXT = NEXT_ILS$ ;

  17625 27 011306   000002 236000 0                  LDQ     NEXT_ILS$
        27 011307   000066 470400 0                  LDP0    TEMP_ILS_LIST+2
        27 011310   000002 756100                    STQ     2,,PR0

     2087    17626    5                        PREV_ILS$->ILS.NEXT = ADDR(TEMP_ILS_LIST)->ILS_LIST.TAIL$ ;

  17626 27 011311   000066 236000 0                  LDQ     TEMP_ILS_LIST+2
        27 011312   000001 470400 0                  LDP0    PREV_ILS$
        27 011313   000002 756100                    STQ     2,,PR0

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:370  
     2088    17627    5                        PREV_ILS$ = ADDR(TEMP_ILS_LIST)->ILS_LIST.TAIL$ ;

  17627 27 011314   000066 236000 0                  LDQ     TEMP_ILS_LIST+2
        27 011315   000001 756000 0                  STQ     PREV_ILS$

     2089    17628                             /* TEMP_ILS_LIST.HEAD$ usually will point to the ILS for a
     2090    17629                                LINOI, which can be disregarded because there is
     2091    17630                                already a suitable LINOI available. */
     2092    17631    5                      END ;

     2093    17632    4                    ILL$->DV4I.LOP = ILL$$->ILL.ROP->ETT.LOP ;

  17632 27 011316   000061 470400 0                  LDP0    ILL$$
        27 011317   000002 471500                    LDP1    2,,PR0
        27 011320   100001 236100                    LDQ     1,,PR1
        27 011321   000000 473400 10                 LDP3    ILL$
        27 011322   300001 756100                    STQ     1,,PR3

     2094    17633    4                    ILL$->DV4I.ROP = ILL$$->ILL.ROP->ETT.ROP ;

  17633 27 011323   000002 471500                    LDP1    2,,PR0
        27 011324   100002 236100                    LDQ     2,,PR1
        27 011325   300002 756100                    STQ     2,,PR3

     2095    17634    4                    ILL$->DV4I.TO_ = ILL$$->ILL.LOP ;

  17634 27 011326   000001 236100                    LDQ     1,,PR0
        27 011327   300003 756100                    STQ     3,,PR3

     2096    17635    4                    ILL$->DV4I.REMAINDER = TEMP$->ILL.LOP ;

  17635 27 011330   000110 471400 0                  LDP1    TEMP$
        27 011331   100001 236100                    LDQ     1,,PR1
        27 011332   300004 756100                    STQ     4,,PR3

     2097    17636    4                    ILS$$->ILS.ILL$ = ADDR(NIL) ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:371  
  17636 27 011333   000000 236000 28                 LDQ     0
        27 011334   000060 474400 0                  LDP4    ILS$$
        27 011335   400003 756100                    STQ     3,,PR4

     2098    17637    4                  END ;

  17637 27 011336   011341 710000 27                 TRA     s:17641

     2099    17638    3                ELSE
     2100    17639    3                  PREV_ILS$ = ILS$ ;

  17639 27 011337   000000 236000 6                  LDQ     ILS$
        27 011340   000001 756000 0                  STQ     PREV_ILS$

     2101    17640
     2102    17641    3                FALL_THRU_FLAG = 1 ; /* Fall thru possible */

  17641 27 011341   000001 235007                    LDA     1,DL
        27 011342   000053 755000 0                  STA     FALL_THRU_FLAG

     2103    17642    3                ILS$ = NEXT_ILS$ ;

  17642 27 011343   000002 236000 0                  LDQ     NEXT_ILS$
        27 011344   000000 756000 6                  STQ     ILS$
        27 011345   012101 710000 27                 TRA     s:17920

     2104    17643        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:372  
     2105    17644        /*V*
     2106    17645            CALL -- External calls may cause registers not to be preserved. The
     2107    17646                    PERFORM handler needs to be notified so it can arrange for X7
     2108    17647                    to be preserved if necessary.
     2109    17648        */
     2110    17649    3              CASE (%OS_CALL, %USER_CALL, %ACCEP, %DISPL) ;

     2111    17650    3                IF O2COM.LAST_LBL$ ~= ADDR(NIL) THEN

  17650 27 011346   000002 236000 25                 LDQ     O2COM+2
        27 011347   000000 116000 28                 CMPQ    0
        27 011350   011371 600000 27                 TZE     s:17659

     2112    17651    4                  DO ;

     2113    17652    4                    O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.B.PFORM_NESTED = TRUE ;

  17652 27 011351   000002 471400 25                 LDP1    O2COM+2
        27 011352   100003 473500                    LDP3    3,,PR1
        27 011353   300001 474500                    LDP4    1,,PR3
        27 011354   000100 236003                    LDQ     64,DU
        27 011355   400003 256100                    ORSQ    3,,PR4

     2114    17653
     2115    17654    4                    IF O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.SECTION$ ~= ADDR(NIL)
             17654                             AND

  17654 27 011356   100003 473500                    LDP3    3,,PR1
        27 011357   300001 474500                    LDP4    1,,PR3
        27 011360   400007 236100                    LDQ     7,,PR4
        27 011361   000000 116000 28                 CMPQ    0
        27 011362   011371 600000 27                 TZE     s:17659
        27 011363   400007 475500                    LDP5    7,,PR4
        27 011364   500000 220100                    LDX0    0,,PR5
        27 011365   000770 100003                    CMPX0   504,DU
        27 011366   011371 601000 27                 TNZ     s:17659

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:373  
     2116    17655    4                       O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.SECTION$ ->
     2117    17656    4                          LABEL.ID = %SECTION THEN
     2118    17657    4                      O2COM.LAST_LBL$->ILS.ILL$->ILL.LOP->LABEL.SECTION$->LABEL.B.
             17657                               PFORM_NESTED = TRUE ;

  17657 27 011367   000100 236003                    LDQ     64,DU
        27 011370   500003 256100                    ORSQ    3,,PR5

     2119    17658    4                  END ;

     2120    17659    3                IF ILL$->ILL.ID = %USER_CALL THEN

  17659 27 011371   000000 220100                    LDX0    0,,PR0
        27 011372   000363 100003                    CMPX0   243,DU
        27 011373   011402 601000 27                 TNZ     s:17665

     2121    17660    3                  CALL OPTIMIZE_CALL (ILL$->USER_CALL.DESTINATION$)

  17660 27 011374   000000 236000 10                 LDQ     ILL$
        27 011375   000005 036003                    ADLQ    5,DU
        27 011376   000115 756000 0                  STQ     CURRENT_PROC$+4
        27 011377   000637 701000 27                 TSX1    OPTIMIZE_CALL
        27 011400   011402 702000 27                 TSX2    s:17665

     2122    17661    4                    WHENRETURN DO ;

     2123    17662    4                      EXIT CASE_STMT ;

  17662 27 011401   012101 710000 27                 TRA     s:17920

     2124    17663    4                    END ;
     2125    17664                     /* ELSE cannot optimize call. */
     2126    17665    3                FALL_THRU_FLAG = 1 ; /* Fall thru possible */

  17665 27 011402   000001 235007                    LDA     1,DL
        27 011403   000053 755000 0                  STA     FALL_THRU_FLAG

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:374  
     2127    17666    3                PREV_ILS$ = ILS$ ;

  17666 27 011404   000000 236000 6                  LDQ     ILS$
        27 011405   000001 756000 0                  STQ     PREV_ILS$

     2128    17667    3                ILS$ = NEXT_ILS$ ;

  17667 27 011406   000002 236000 0                  LDQ     NEXT_ILS$
        27 011407   000000 756000 6                  STQ     ILS$
        27 011410   012101 710000 27                 TRA     s:17920

     2129    17668        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:375  
     2130    17669        /*V*
     2131    17670            LINOI -- The current line and column numbers are updated.
     2132    17671        */
     2133    17672
     2134    17673    3              CASE (%LINOI) ;

     2135    17674
     2136    17675    4                IF ILL$->LINOI.TYPE ~= %NO_STATEMENT_TYPE THEN DO ;

  17675 27 011411   000002 220100                    LDX0    2,,PR0
        27 011412   011421 600000 27                 TZE     s:17680

     2137    17676    4                  COMCOM.CURRENT.LINE = ILL$->LINOI.LINE_NO ;

  17676 27 011413   000001 236100                    LDQ     1,,PR0
        27 011414   777777 376007                    ANQ     -1,DL
        27 011415   000133 756000 xsym               STQ     COMCOM+91

     2138    17677    4                  COMCOM.CURRENT.COLUMN = ILL$->LINOI.COLUMN_NO ;

  17677 27 011416   000001 236100                    LDQ     1,,PR0
        27 011417   000022 772000                    QRL     18
        27 011420   000134 756000 xsym               STQ     COMCOM+92

     2139    17678    4                END ;

     2140    17679
     2141    17680    3                ILS$ = NEXT_ILS$ ;

  17680 27 011421   000002 236000 0                  LDQ     NEXT_ILS$
        27 011422   000000 756000 6                  STQ     ILS$
        27 011423   012101 710000 27                 TRA     s:17920

     2142    17681        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:376  
     2143    17682        /*V*
     2144    17683            STOP -- No special action, except turn off the FALL_THRU_FLAG.
     2145    17684        */
     2146    17685    3              CASE (%STOP, %USE_END) ;

     2147    17686    3                FALL_THRU_FLAG = 0 ; /* Fall thru not possible */

  17686 27 011424   000053 450000 0                  STZ     FALL_THRU_FLAG

     2148    17687
     2149    17688    3                PREV_ILS$ = ILS$ ;

  17688 27 011425   000000 236000 6                  LDQ     ILS$
        27 011426   000001 756000 0                  STQ     PREV_ILS$

     2150    17689    3                ILS$ = NEXT_ILS$ ;

  17689 27 011427   000002 236000 0                  LDQ     NEXT_ILS$
        27 011430   000000 756000 6                  STQ     ILS$
        27 011431   012101 710000 27                 TRA     s:17920

     2151    17690        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:377  
     2152    17691        /*V*
     2153    17692            EXIT_PROGRAM -- If in a subroutine, it merely requires turning off the
     2154    17693                            FALL_THRU_FLAG. In a main program it is optimized out
     2155    17694                            and a warning message is issued.
     2156    17695        */
     2157    17696    3              CASE (%EXIT_PROG) ;

     2158    17697    3                IF ENTRY_TYPE = %MAIN_PROGRAM

  17697 27 011432   000107 235000 0                  LDA     ENTRY_TYPE
        27 011433   011502 601000 27                 TNZ     s:17730
        27 011434   000050 234000 xsym               SZN     COMCOM+40
        27 011435   011502 604000 27                 TMI     s:17730

     2159    17698    4                    AND NOT COMCOM.OB.TP8 THEN DO ;

     2160    17699    4                  PREV_ILS$->ILS.NEXT = NEXT_ILS$ ; /* Optimize it out. */

  17699 27 011436   000002 236000 0                  LDQ     NEXT_ILS$
        27 011437   000001 471400 0                  LDP1    PREV_ILS$
        27 011440   100002 756100                    STQ     2,,PR1

     2161    17700    4                  CALL Z8AE$ERROR (%E$CANT_EXIT) ;

  17700 27 011441   000051 630400 28                 EPPR0   41
        27 011442   000001 631400 28                 EPPR1   1
        27 011443   000000 701000 xent               TSX1    Z8AE$ERROR
        27 011444   000000 011000                    NOP     0

     2162    17701        /*E*
     2163    17702              ERROR:  CANT_EXIT
     2164    17703            MESSAGE:  EXIT PROGRAM in main program ignored.
     2165    17704        DESCRIPTION:  The standard specifies that it is legal to have the
     2166    17705                      EXIT-PROGRAM statement in a main program, and that if this
     2167    17706                      is done no action should be taken. Control goes on to the
     2168    17707                      next statement.
     2169    17708        */
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:378  
     2170    17709    4                  TEMP$ = ILS$ ;

  17709 27 011445   000000 236000 6                  LDQ     ILS$
        27 011446   000110 756000 0                  STQ     TEMP$

     2171    17710                       %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  17720 27 011447   000110 470400 0                  LDP0    TEMP$
        27 011450   000002 236100                    LDQ     2,,PR0
        27 011451   000110 756000 0                  STQ     TEMP$

  17723 27 011452   000110 470400 0                  LDP0    TEMP$
        27 011453   000003 236100                    LDQ     3,,PR0
        27 011454   000000 116000 28                 CMPQ    0
        27 011455   011447 600000 27                 TZE     s:17720
        27 011456   000003 471500                    LDP1    3,,PR0
        27 011457   100000 220100                    LDX0    0,,PR1
        27 011460   000343 100003                    CMPX0   227,DU
        27 011461   011447 600000 27                 TZE     s:17720
        27 011462   000422 100003                    CMPX0   274,DU
        27 011463   011447 600000 27                 TZE     s:17720
        27 011464   000446 100003                    CMPX0   294,DU
        27 011465   011447 600000 27                 TZE     s:17720
        27 011466   000336 100003                    CMPX0   222,DU
        27 011467   011447 600000 27                 TZE     s:17720
        27 011470   000420 100003                    CMPX0   272,DU
        27 011471   011447 600000 27                 TZE     s:17720
        27 011472   000373 100003                    CMPX0   251,DU
        27 011473   011447 600000 27                 TZE     s:17720

     2172    17725    4                  IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB THEN

  17725 27 011474   000346 100003                    CMPX0   230,DU
        27 011475   012033 601000 27                 TNZ     s:17882

     2173    17726    4                    TEMP$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ = PREV_ILS$ ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:379  
  17726 27 011476   100001 473500                    LDP3    1,,PR1
        27 011477   000001 236000 0                  LDQ     PREV_ILS$
        27 011500   300010 756100                    STQ     8,,PR3

     2174    17727                         /* If label after the EXIT PROGRAM then adjust its PREV_ILS$. */
     2175    17728    4                END ;

  17728 27 011501   012033 710000 27                 TRA     s:17882

     2176    17729    4                ELSE DO ;

     2177    17730    4                  IF CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.EXIT_PROG_IN_DECL

  17730 27 011502   000111 471400 0                  LDP1    CURRENT_PROC$
        27 011503   100001 473500                    LDP3    1,,PR1
        27 011504   300001 236100                    LDQ     1,,PR3
        27 011505   000200 316007                    CANQ    128,DL
        27 011506   012023 600000 27                 TZE     s:17876
        27 011507   000001 115007                    CMPA    1,DL
        27 011510   012023 601000 27                 TNZ     s:17876

     2178    17731                           %IF CP6;
     2179    17732    4                      AND ENTRY_TYPE = %SUBROUTINE
     2180    17733                           %ENDIF ;
     2181    17734    4                      THEN
     2182    17735    5                    IF NOT EXIT_PROG_FOUND THEN DO ;

  17735 27 011511   000034 234000 0                  SZN     EXIT_PROG_FOUND
        27 011512   012023 604000 27                 TMI     s:17876

     2183    17736                           /* EXIT PROGRAM in any USE procedure can only terminate
     2184    17737                              all active USE procedures, and then UNWIND to an
     2185    17738                              EXIT PROGRAM statement in the program. Insert a
     2186    17739                              compiler-created label before it, for EXIT
     2187    17740                              PROGRAM to unwind to. */
     2188    17741                           %RESERVE_ILS (ITEM=%OPN, POINTER=ILS$$) ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:380  
  17761 27 011513   000002 236000 7                  LDQ     ILS_+2
        27 011514   000004 036007                    ADLQ    4,DL
        27 011515   000003 116000 7                  CMPQ    ILS_+3
        27 011516   011527 602000 27                 TNC     s:17763

  17762 27 011517   000002 236000 28                 LDQ     2
        27 011520   000130 756000 0                  STQ     OPT_FLAG+1
        27 011521   000130 633400 0                  EPPR3   OPT_FLAG+1
        27 011522   000131 453400 0                  STP3    OPT_FLAG+2
        27 011523   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 011524   000001 631400 28                 EPPR1   1
        27 011525   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 011526   000000 011000                    NOP     0

  17763 27 011527   000002 236000 7                  LDQ     ILS_+2
        27 011530   000022 736000                    QLS     18
        27 011531   000001 036000 7                  ADLQ    ILS_+1
        27 011532   000060 756000 0                  STQ     ILS$$

  17764 27 011533   000002 235000 7                  LDA     ILS_+2
        27 011534   000004 035007                    ADLA    4,DL
        27 011535   000002 755000 7                  STA     ILS_+2

  17765 27 011536   000740 220003                    LDX0    480,DU
        27 011537   000060 470400 0                  LDP0    ILS$$
        27 011540   000000 740100                    STX0    0,,PR0

  17766 27 011541   000000 236000 28                 LDQ     0
        27 011542   000002 756100                    STQ     2,,PR0

     2189    17770                           %RESERVE_ILL (ITEM=%LINOI, POINTER=ILS$$->ILS.ILL$) ;

  17772 27 011543   000145 235000 xsym               LDA     ILL_STEP+101
        27 011544   000000 755000 1                  STA     ITERATION

  17773 27 011545   000002 236000 11                 LDQ     ILL_+2
        27 011546   000000 036000 1                  ADLQ    ITERATION
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:381  
        27 011547   000003 116000 11                 CMPQ    ILL_+3
        27 011550   011561 604000 27                 TMI     s:17775

  17774 27 011551   000003 236000 28                 LDQ     3
        27 011552   000130 756000 0                  STQ     OPT_FLAG+1
        27 011553   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 011554   000131 451400 0                  STP1    OPT_FLAG+2
        27 011555   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 011556   000001 631400 28                 EPPR1   1
        27 011557   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 011560   000000 011000                    NOP     0

  17775 27 011561   000002 236000 11                 LDQ     ILL_+2
        27 011562   000022 736000                    QLS     18
        27 011563   000001 036000 11                 ADLQ    ILL_+1
        27 011564   000060 470400 0                  LDP0    ILS$$
        27 011565   000003 756100                    STQ     3,,PR0

  17776 27 011566   000002 236000 11                 LDQ     ILL_+2
        27 011567   000000 036000 1                  ADLQ    ITERATION
        27 011570   000002 756000 11                 STQ     ILL_+2

  17777 27 011571   000003 471500                    LDP1    3,,PR0
        27 011572   000373 220003                    LDX0    251,DU
        27 011573   100000 740100                    STX0    0,,PR1

     2190    17780    5                      ILS$$->ILS.ILL$->LINOI.PREV_COL = COMCOM.CURRENT.COLUMN ;

  17780 27 011574   000003 471500                    LDP1    3,,PR0
        27 011575   000134 721000 xsym               LXL1    COMCOM+92
        27 011576   100002 441100                    SXL1    2,,PR1

     2191    17781    5                      ILS$$->ILS.ILL$->LINOI.COLUMN_NO = COMCOM.CURRENT.COLUMN ;

  17781 27 011577   000003 471500                    LDP1    3,,PR0
        27 011600   000134 721000 xsym               LXL1    COMCOM+92
        27 011601   100001 741100                    STX1    1,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:382  

     2192    17782    5                      ILS$$->ILS.ILL$->LINOI.PREV_LINE = COMCOM.CURRENT.LINE ;

  17782 27 011602   000003 471500                    LDP1    3,,PR0
        27 011603   000133 721000 xsym               LXL1    COMCOM+91
        27 011604   100000 441100                    SXL1    0,,PR1

     2193    17783    5                      ILS$$->ILS.ILL$->LINOI.LINE_NO = COMCOM.CURRENT.LINE ;

  17783 27 011605   000003 471500                    LDP1    3,,PR0
        27 011606   000133 721000 xsym               LXL1    COMCOM+91
        27 011607   100001 441100                    SXL1    1,,PR1

     2194    17784                           %RESERVE_ILS (ITEM=%OPN, POINTER=ILS$$->ILS.NEXT) ;

  17804 27 011610   000002 236000 7                  LDQ     ILS_+2
        27 011611   000004 036007                    ADLQ    4,DL
        27 011612   000003 116000 7                  CMPQ    ILS_+3
        27 011613   011624 602000 27                 TNC     s:17806

  17805 27 011614   000002 236000 28                 LDQ     2
        27 011615   000130 756000 0                  STQ     OPT_FLAG+1
        27 011616   000130 631400 0                  EPPR1   OPT_FLAG+1
        27 011617   000131 451400 0                  STP1    OPT_FLAG+2
        27 011620   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 011621   000001 631400 28                 EPPR1   1
        27 011622   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 011623   000000 011000                    NOP     0

  17806 27 011624   000002 236000 7                  LDQ     ILS_+2
        27 011625   000022 736000                    QLS     18
        27 011626   000001 036000 7                  ADLQ    ILS_+1
        27 011627   000060 470400 0                  LDP0    ILS$$
        27 011630   000002 756100                    STQ     2,,PR0

  17807 27 011631   000002 235000 7                  LDA     ILS_+2
        27 011632   000004 035007                    ADLA    4,DL
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:383  
        27 011633   000002 755000 7                  STA     ILS_+2

  17808 27 011634   000002 471500                    LDP1    2,,PR0
        27 011635   000740 220003                    LDX0    480,DU
        27 011636   100000 740100                    STX0    0,,PR1

  17809 27 011637   000002 471500                    LDP1    2,,PR0
        27 011640   000000 236000 28                 LDQ     0
        27 011641   100002 756100                    STQ     2,,PR1

     2195    17813    5                      ILS$$->ILS.NEXT->ILS.NEXT = NEXT_ILS$ ;

  17813 27 011642   000002 471500                    LDP1    2,,PR0
        27 011643   000002 236000 0                  LDQ     NEXT_ILS$
        27 011644   100002 756100                    STQ     2,,PR1

     2196    17814    5                      ILS$->ILS.NEXT = ILS$$ ;

  17814 27 011645   000060 236000 0                  LDQ     ILS$$
        27 011646   000000 471400 6                  LDP1    ILS$
        27 011647   100002 756100                    STQ     2,,PR1

     2197    17815                           %NEXT_ILS (POINTER=ILS$$) ;

  17817 27 011650   000002 236100                    LDQ     2,,PR0
        27 011651   000060 756000 0                  STQ     ILS$$

     2198    17820    5                      ILS$$->ILS.ILL$ = ILL$ ;

  17820 27 011652   000000 236000 10                 LDQ     ILL$
        27 011653   000060 470400 0                  LDP0    ILS$$
        27 011654   000003 756100                    STQ     3,,PR0

     2199    17821                           %RESERVE_ILL (ITEM=%DEFLB, POINTER=ILS$->ILS.ILL$) ;

  17823 27 011655   000120 235000 xsym               LDA     ILL_STEP+80
        27 011656   000000 755000 1                  STA     ITERATION
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:384  

  17824 27 011657   000002 236000 11                 LDQ     ILL_+2
        27 011660   000000 036000 1                  ADLQ    ITERATION
        27 011661   000003 116000 11                 CMPQ    ILL_+3
        27 011662   011673 604000 27                 TMI     s:17826

  17825 27 011663   000003 236000 28                 LDQ     3
        27 011664   000130 756000 0                  STQ     OPT_FLAG+1
        27 011665   000130 633400 0                  EPPR3   OPT_FLAG+1
        27 011666   000131 453400 0                  STP3    OPT_FLAG+2
        27 011667   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 011670   000001 631400 28                 EPPR1   1
        27 011671   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 011672   000000 011000                    NOP     0

  17826 27 011673   000002 236000 11                 LDQ     ILL_+2
        27 011674   000022 736000                    QLS     18
        27 011675   000001 036000 11                 ADLQ    ILL_+1
        27 011676   000000 470400 6                  LDP0    ILS$
        27 011677   000003 756100                    STQ     3,,PR0

  17827 27 011700   000002 236000 11                 LDQ     ILL_+2
        27 011701   000000 036000 1                  ADLQ    ITERATION
        27 011702   000002 756000 11                 STQ     ILL_+2

  17828 27 011703   000003 471500                    LDP1    3,,PR0
        27 011704   000346 220003                    LDX0    230,DU
        27 011705   100000 740100                    STX0    0,,PR1

     2200    17831    5                      ILS$->ILS.ILL$->ILL.LOP = EXIT_PROG$ ;

  17831 27 011706   000000 470400 6                  LDP0    ILS$
        27 011707   000003 471500                    LDP1    3,,PR0
        27 011710   000033 236000 0                  LDQ     EXIT_PROG$
        27 011711   100001 756100                    STQ     1,,PR1

     2201    17832    5                      EXIT_PROG$->LABEL.PREV_ILS$ = PREV_ILS$ ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:385  

  17832 27 011712   000001 236000 0                  LDQ     PREV_ILS$
        27 011713   000033 471400 0                  LDP1    EXIT_PROG$
        27 011714   100010 756100                    STQ     8,,PR1

     2202    17833                           %ASSIGN_LABEL_INFO (@ILL$=ILS$->ILS.ILL$) ;

  17835 27 011715   000057 234000 0                  SZN     DEFLB_AFTER_ENTRY
        27 011716   011723 605000 27                 TPL     s:17837

  17836 27 011717   000003 471500                    LDP1    3,,PR0
        27 011720   100001 473500                    LDP3    1,,PR1
        27 011721   400000 236003                    LDQ     -131072,DU
        27 011722   300003 256100                    ORSQ    3,,PR3

  17837 27 011723   000003 471500                    LDP1    3,,PR0
        27 011724   100001 473500                    LDP3    1,,PR1
        27 011725   300003 234100                    SZN     3,,PR3
        27 011726   011733 605000 27                 TPL     s:17842

  17839 27 011727   000000 236000 6                  LDQ     ILS$
        27 011730   000025 756000 0                  STQ     REF_DEFLB

  17840 27 011731   000001 235007                    LDA     1,DL
        27 011732   000053 755000 0                  STA     FALL_THRU_FLAG

  17842 27 011733   300000 221100                    LDX1    0,,PR3
        27 011734   000770 101003                    CMPX1   504,DU
        27 011735   011750 601000 27                 TNZ     s:17848

  17844 27 011736   100001 236100                    LDQ     1,,PR1
        27 011737   000003 756000 25                 STQ     O2COM+3

  17845 27 011740   000003 471500                    LDP1    3,,PR0
        27 011741   100001 473500                    LDP3    1,,PR1
        27 011742   300007 236100                    LDQ     7,,PR3
        27 011743   000000 116000 28                 CMPQ    0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:386  
        27 011744   011750 600000 27                 TZE     s:17848

  17846 27 011745   300007 474500                    LDP4    7,,PR3
        27 011746   400002 235100                    LDA     2,,PR4
        27 011747   000005 755000 25                 STA     O2COM+5

  17848 27 011750   000000 236000 6                  LDQ     ILS$
        27 011751   000002 756000 25                 STQ     O2COM+2

  17849 27 011752   000057 450000 0                  STZ     DEFLB_AFTER_ENTRY

     2203    17852    5                      IF FALL_THRU_FLAG ~= 0 THEN

  17852 27 011753   000053 235000 0                  LDA     FALL_THRU_FLAG
        27 011754   011760 600000 27                 TZE     s:17854

     2204    17853    5                        EXIT_PROG$->LABEL.B.FALL_THRU = TRUE ;

  17853 27 011755   000033 471400 0                  LDP1    EXIT_PROG$
        27 011756   002000 236003                    LDQ     1024,DU
        27 011757   100003 256100                    ORSQ    3,,PR1

     2205    17854    5                      EXIT_PROG$->LABEL.B.PHASE_2 = TRUE ;

  17854 27 011760   000033 471400 0                  LDP1    EXIT_PROG$
        27 011761   004000 236003                    LDQ     2048,DU
        27 011762   100003 256100                    ORSQ    3,,PR1

     2206    17855    5                      TEMP$ = ILS$$ ;

  17855 27 011763   000060 236000 0                  LDQ     ILS$$
        27 011764   000110 756000 0                  STQ     TEMP$

     2207    17856                           %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  17866 27 011765   000110 470400 0                  LDP0    TEMP$
        27 011766   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:387  
        27 011767   000110 756000 0                  STQ     TEMP$

  17869 27 011770   000110 470400 0                  LDP0    TEMP$
        27 011771   000003 236100                    LDQ     3,,PR0
        27 011772   000000 116000 28                 CMPQ    0
        27 011773   011765 600000 27                 TZE     s:17866
        27 011774   000003 471500                    LDP1    3,,PR0
        27 011775   100000 220100                    LDX0    0,,PR1
        27 011776   000343 100003                    CMPX0   227,DU
        27 011777   011765 600000 27                 TZE     s:17866
        27 012000   000422 100003                    CMPX0   274,DU
        27 012001   011765 600000 27                 TZE     s:17866
        27 012002   000446 100003                    CMPX0   294,DU
        27 012003   011765 600000 27                 TZE     s:17866
        27 012004   000336 100003                    CMPX0   222,DU
        27 012005   011765 600000 27                 TZE     s:17866
        27 012006   000420 100003                    CMPX0   272,DU
        27 012007   011765 600000 27                 TZE     s:17866
        27 012010   000373 100003                    CMPX0   251,DU
        27 012011   011765 600000 27                 TZE     s:17866

     2208    17871    5                      IF TEMP$->ILS.ILL$->ILL.ID = %DEFLB THEN

  17871 27 012012   000346 100003                    CMPX0   230,DU
        27 012013   012017 601000 27                 TNZ     s:17873

     2209    17872    5                        TEMP$->ILS.ILL$->ILL.LOP->LABEL.PREV_ILS$ = ILS$$ ;

  17872 27 012014   100001 473500                    LDP3    1,,PR1
        27 012015   000060 236000 0                  LDQ     ILS$$
        27 012016   300010 756100                    STQ     8,,PR3

     2210    17873    5                      EXIT_PROG_FOUND = TRUE ;

  17873 27 012017   400000 236003                    LDQ     -131072,DU
        27 012020   000034 756000 0                  STQ     EXIT_PROG_FOUND

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:388  
     2211    17874    5                      FALL_THRU_FLAG = 1 ;

  17874 27 012021   000001 235007                    LDA     1,DL
        27 012022   000053 755000 0                  STA     FALL_THRU_FLAG

     2212    17875    5                    END ;

     2213    17876    4                  CALL RESTORE_IO_CHAIN ;

  17876 27 012023   000512 701000 27                 TSX1    RESTORE_IO_CHAIN
        27 012024   000000 011000                    NOP     0

     2214    17877    4                  ILL$->ILL.LOP = CURRENT_PROC$ ;

  17877 27 012025   000111 236000 0                  LDQ     CURRENT_PROC$
        27 012026   000000 470400 10                 LDP0    ILL$
        27 012027   000001 756100                    STQ     1,,PR0

     2215    17878    4                  FALL_THRU_FLAG = 0 ; /* Fall thru not possible */

  17878 27 012030   000053 450000 0                  STZ     FALL_THRU_FLAG

     2216    17879    4                  PREV_ILS$ = ILS$ ;

  17879 27 012031   000000 236000 6                  LDQ     ILS$
        27 012032   000001 756000 0                  STQ     PREV_ILS$

     2217    17880    4                END ;

     2218    17881
     2219    17882    3                ILS$ = NEXT_ILS$ ;

  17882 27 012033   000002 236000 0                  LDQ     NEXT_ILS$
        27 012034   000000 756000 6                  STQ     ILS$
        27 012035   012101 710000 27                 TRA     s:17920

     2220    17883        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:389  
     2221    17884        /*V*
     2222    17885            NON_GENERATING -- For ILL items that cannot generate any code, just
     2223    17886                              go on to the next without touching FALL_THRU_FLAG.
     2224    17887        */
     2225    17888    3              CASE (%PREOFF,%PRESET,%P_A_PRESET,%PTR_SET,%PEND, %P_P_PRESET) ;

     2226    17889    3                PREV_ILS$ = ILS$ ;

  17889 27 012036   000000 236000 6                  LDQ     ILS$
        27 012037   000001 756000 0                  STQ     PREV_ILS$

     2227    17890    3                ILS$ = NEXT_ILS$ ;

  17890 27 012040   000002 236000 0                  LDQ     NEXT_ILS$
        27 012041   000000 756000 6                  STQ     ILS$
        27 012042   012101 710000 27                 TRA     s:17920

     2228    17891        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:390  
     2229    17892        /*V*
     2230    17893            END -- If necessary then insert a STOP or EXIT_PROG before it.
     2231    17894        */
     2232    17895    3              CASE (%END, %END_PROG) ;

     2233    17896    3                IF FALL_THRU_FLAG ~= 0

  17896 27 012043   000053 235000 0                  LDA     FALL_THRU_FLAG
        27 012044   012062 601000 27                 TNZ     s:17903
        27 012045   000034 234000 0                  SZN     EXIT_PROG_FOUND
        27 012046   012064 604000 27                 TMI     s:17904
        27 012047   000033 236000 0                  LDQ     EXIT_PROG$
        27 012050   000000 116000 28                 CMPQ    0
        27 012051   012064 600000 27                 TZE     s:17904
        27 012052   000111 471400 0                  LDP1    CURRENT_PROC$
        27 012053   100001 473500                    LDP3    1,,PR1
        27 012054   300001 236100                    LDQ     1,,PR3
        27 012055   000200 316007                    CANQ    128,DL
        27 012056   012064 600000 27                 TZE     s:17904
        27 012057   000107 235000 0                  LDA     ENTRY_TYPE
        27 012060   000001 115007                    CMPA    1,DL
        27 012061   012064 601000 27                 TNZ     s:17904

     2234    17897    3                    OR NOT EXIT_PROG_FOUND
     2235    17898    3                       AND EXIT_PROG$ ~= ADDR (NIL)
     2236    17899    3                       AND CURRENT_PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.
             17899                                EXIT_PROG_IN_DECL
     2237    17900                            %IF CP6 ;
     2238    17901    3                       AND ENTRY_TYPE = %SUBROUTINE
     2239    17902                            %ENDIF ;
     2240    17903    3                  THEN CALL INSERT_STOP_OR_EXIT ;

  17903 27 012062   000002 701000 27                 TSX1    INSERT_STOP_OR_EXIT
        27 012063   000000 011000                    NOP     0

     2241    17904    3                FALL_THRU_FLAG = -1 ; /* Beginning of next program if any */

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:391  
  17904 27 012064   000001 335007                    LCA     1,DL
        27 012065   000053 755000 0                  STA     FALL_THRU_FLAG

     2242    17905    3                PREV_ILS$ = ILS$ ;

  17905 27 012066   000000 236000 6                  LDQ     ILS$
        27 012067   000001 756000 0                  STQ     PREV_ILS$

     2243    17906    3                ILS$ = NEXT_ILS$ ;

  17906 27 012070   000002 236000 0                  LDQ     NEXT_ILS$
        27 012071   000000 756000 6                  STQ     ILS$
        27 012072   012101 710000 27                 TRA     s:17920

     2244    17907        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:392  
     2245    17908        /*V*
     2246    17909            ELSE -- If the item belongs to none of the above optimizations it is sent
     2247    17910                    here. Just skip to the next ILS item.
     2248    17911        */
     2249    17912    3              CASE (ELSE) ;

     2250    17913
     2251    17914    3                FALL_THRU_FLAG = 1 ; /* Fall thru possible */

  17914 27 012073   000001 235007                    LDA     1,DL
        27 012074   000053 755000 0                  STA     FALL_THRU_FLAG

     2252    17915    3                PREV_ILS$ = ILS$ ;

  17915 27 012075   000000 236000 6                  LDQ     ILS$
        27 012076   000001 756000 0                  STQ     PREV_ILS$

     2253    17916    3                ILS$ = NEXT_ILS$ ;

  17916 27 012077   000002 236000 0                  LDQ     NEXT_ILS$
        27 012100   000000 756000 6                  STQ     ILS$

     2254    17917
     2255    17918    3            END CASE_STMT ;

     2256    17919
     2257    17920    2          END CASE_LOOP ;

  17920 27 012101   000000 236000 6                  LDQ     ILS$
        27 012102   000000 116000 28                 CMPQ    0
        27 012103   002320 601000 27                 TNZ     CASE_LOOP

     2258    17921        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:393  
     2259    17922        /*V*
     2260    17923            SEQUENCING_PRESET --  If there were any PFORMs in the program then
     2261    17924                                  Z8FP$PFORM_CHECKING is called to operate on those
     2262    17925                                  items.  The initialization is done for the
     2263    17926                                  sequencing loop which includes assigning the
     2264    17927                                  starting ILS$(top of ILS), sequence number (1), and
     2265    17928                                  COMCOM.COMMON_REDEF (0).
     2266    17929        */
     2267    17930
     2268    17931    1          IF COMCOM.H_PFORM ~= ADDR(NIL) THEN

  17931 27 012104   000126 236000 xsym               LDQ     COMCOM+86
        27 012105   000000 116000 28                 CMPQ    0
        27 012106   012116 600000 27                 TZE     s:17941

     2269    17932    2            DO ;

     2270    17933    2              O2COM.PFORM_LIST$->ILS.ILL$->PFORM.PFORM_LIST$ = ADDR(NIL) ;

  17933 27 012107   000001 470400 25                 LDP0    O2COM+1
        27 012110   000003 471500                    LDP1    3,,PR0
        27 012111   000000 236000 28                 LDQ     0
        27 012112   100004 756100                    STQ     4,,PR1

     2271    17934    2              CALL Z8FP$PFORM_CHECKING ;

  17934 27 012113   000026 631400 28                 EPPR1   22
        27 012114   000000 701000 xent               TSX1    Z8FP$PFORM_CHECKING
        27 012115   000000 011000                    NOP     0

     2272    17935    2            END ;

     2273    17936
     2274    17937         /* If any overlayable segments exist, the count fields
     2275    17938            of the labels need to be set equal to the count field of the
     2276    17939            segment they belong to */
     2277    17940
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:394  
     2278    17941    1          IF COMCOM.SEGMENTC > 1 THEN

  17941 27 012116   000314 235000 xsym               LDA     COMCOM+204
        27 012117   000001 115007                    CMPA    1,DL
        27 012120   012160 604400 27                 TMOZ    s:17966

     2279    17942    2            DO;

     2280    17943    2              ILS$ = COMCOM.FIRST_ILS;

  17943 27 012121   000010 236000 xsym               LDQ     COMCOM+8
        27 012122   000000 756000 6                  STQ     ILS$

     2281    17944    2              CURRENT_SEG# = 0;

  17944 27 012123   000054 450000 0                  STZ     CURRENT_SEG#

     2282    17945
     2283    17946    3              DO WHILE (ILS$ ~= ADDR(NIL));

  17946 27 012124   012156 710000 27                 TRA     s:17963

     2284    17947
     2285    17948    3                IF ILS$ -> ILS.ILL$ ~= ADDR(NIL) AND

  17948 27 012125   000000 470400 6                  LDP0    ILS$
        27 012126   000003 236100                    LDQ     3,,PR0
        27 012127   000000 116000 28                 CMPQ    0
        27 012130   012153 600000 27                 TZE     s:17961
        27 012131   000003 471500                    LDP1    3,,PR0
        27 012132   100000 220100                    LDX0    0,,PR1
        27 012133   000346 100003                    CMPX0   230,DU
        27 012134   012153 601000 27                 TNZ     s:17961

     2286    17949    3                  ILS$ -> ILS.ILL$ -> ILL.ID = %DEFLB THEN
     2287    17950    4                  DO;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:395  
     2288    17951    4                    IF ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.ID = %SECTION AND

  17951 27 012135   100001 473500                    LDP3    1,,PR1
        27 012136   300000 221100                    LDX1    0,,PR3
        27 012137   000770 101003                    CMPX1   504,DU
        27 012140   012147 601000 27                 TNZ     s:17956
        27 012141   300007 236100                    LDQ     7,,PR3
        27 012142   000000 116000 28                 CMPQ    0
        27 012143   012147 600000 27                 TZE     s:17956

     2289    17952    4                     ILS$ -> ILS.ILL$ -> ILL.LOP -> SECTION.SEGMENT$ ~= ADDR(NIL) THEN
     2290    17953    4                      CURRENT_SEG# = ILS$ -> ILS.ILL$ -> ILL.LOP ->

  17953 27 012144   300007 474500                    LDP4    7,,PR3
        27 012145   400002 235100                    LDA     2,,PR4
        27 012146   000054 755000 0                  STA     CURRENT_SEG#

     2291    17954    4                            SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO#;
     2292    17955
     2293    17956    4                      ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.COUNT =

  17956 27 012147   000054 722000 0                  LXL2    CURRENT_SEG#
        27 012150   000150 474412 xsym               LDP4    COMCOM+104,X2
        27 012151   400000 236100                    LDQ     0,,PR4
        27 012152   300000 552104                    STBQ    0,'04'O,PR3

     2294    17957    4                          COMCOM.SEGMENT$(CURRENT_SEG#) -> SEGMENT.COUNT;
     2295    17958
     2296    17959    4                  END;

     2297    17960
     2298    17961    3                ILS$ = ILS$ -> ILS.NEXT;

  17961 27 012153   000000 470400 6                  LDP0    ILS$
        27 012154   000002 236100                    LDQ     2,,PR0
        27 012155   000000 756000 6                  STQ     ILS$

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:396  
     2299    17962
     2300    17963    3              END;   /* DO WHILE */

  17963 27 012156   000000 116000 28                 CMPQ    0
        27 012157   012125 601000 27                 TNZ     s:17948

     2301    17964    2          END;

     2302    17965
     2303    17966    1          ILS$ = COMCOM.FIRST_ILS ;

  17966 27 012160   000010 236000 xsym               LDQ     COMCOM+8
        27 012161   000000 756000 6                  STQ     ILS$

     2304    17967    1          PREV_ILS$ = ADDR(NIL) ;

  17967 27 012162   000000 236000 28                 LDQ     0
        27 012163   000001 756000 0                  STQ     PREV_ILS$

     2305    17968    1          VAL_END$ = ADDR(NIL) ;

  17968 27 012164   000031 756000 0                  STQ     VAL_END$

     2306    17969    1          COMCOM.H_ENTRY$ = ADDR(NIL) ;

  17969 27 012165   000423 756000 xsym               STQ     COMCOM+275

     2307    17970    1          COMCOM.H_LBL = ADDR(NIL) ;

  17970 27 012166   000321 756000 xsym               STQ     COMCOM+209

     2308    17971    1          COMCOM.COMMON_REDEF = 0 ;

  17971 27 012167   000373 450000 xsym               STZ     COMCOM+251

     2309    17972    1          COMCOM.FIRST_ENTRY_SEQ_NUM = 0 ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:397  
  17972 27 012170   000440 450000 xsym               STZ     COMCOM+288

     2310    17973    1          CURRENT_SEQ_NO = 1 ;

  17973 27 012171   000001 235007                    LDA     1,DL
        27 012172   000052 755000 0                  STA     CURRENT_SEQ_NO

     2311    17974        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:398  
     2312    17975    1          DOEND_FLAG = 1 ;

  17975 27 012173   000106 755000 0                  STA     DOEND_FLAG

     2313    17976    2          DO WHILE (ILS$ ~= ADDR(NIL)) ;

  17976 27 012174   014156 710000 27                 TRA     s:18561

     2314    17977
     2315    17978    3            DO CASE (ILS$->ILS.ID) ;

  17978 27 012175   000000 470400 6                  LDP0    ILS$
        27 012176   000000 236100                    LDQ     0,,PR0
        27 012177   000022 772000                    QRL     18
        27 012200   000741 136007                    SBLQ    481,DL
        27 012201   000002 116007                    CMPQ    2,DL
        27 012202   012204 602006 27                 TNC     s:17978+7,QL
        27 012203   012277 710000 27                 TRA     s:18038
        27 012204   012206 710000 27                 TRA     s:17989
        27 012205   012234 710000 27                 TRA     s:18008

     2316    17979
     2317    17980        /*V*
     2318    17981            SINGLE_REDEF -- Assign the data item's forward definition point in its
     2319    17982                            ST entry.
     2320    17983        */
     2321    17984
     2322    17985    3              CASE (%OPV) ;

     2323    17986
     2324    17987                     %FISH(TRIAD=ILS$->ILS.DNAME, RTN=ST$) ;

  17989 27 012206   000004 236100                    LDQ     4,,PR0
        27 012207   000000 756000 19                 STQ     ST$

  17990 27 012210   000000 471400 19                 LDP1    ST$
        27 012211   100000 220100                    LDX0    0,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:399  
        27 012212   000751 100003                    CMPX0   489,DU
        27 012213   012223 603000 27                 TRC     s:17995

  17991 27 012214   000000 470400 19                 LDP0    ST$
        27 012215   000001 236100                    LDQ     1,,PR0
        27 012216   000000 756000 19                 STQ     ST$

  17992 27 012217   000000 470400 19                 LDP0    ST$
        27 012220   000000 220100                    LDX0    0,,PR0
        27 012221   000751 100003                    CMPX0   489,DU
        27 012222   012214 602000 27                 TNC     s:17991

     2325    17995    3                ILS$->ILS.RDEF = ST$ -> VARIABLE.SEQ#.FD ;

  17995 27 012223   000000 470400 19                 LDP0    ST$
        27 012224   000010 220100                    LDX0    8,,PR0
        27 012225   000000 471400 6                  LDP1    ILS$
        27 012226   100001 440100                    SXL0    1,,PR1

     2326    17996    3                ST$->VARIABLE.SEQ#.FD = CURRENT_SEQ_NO ;

  17996 27 012227   000052 721000 0                  LXL1    CURRENT_SEQ_NO
        27 012230   000010 741100                    STX1    8,,PR0

     2327    17997    3                ST$->VARIABLE.SEQ#.BD = %MAX_SEQ# ;

  17997 27 012231   777777 220003                    LDX0    -1,DU
        27 012232   000010 440100                    SXL0    8,,PR0
        27 012233   012277 710000 27                 TRA     s:18038

     2328    17998
     2329    17999        /*V*
     2330    18000            MULTI_RDEF -- If the ILL item is GO_SUB or CALL then reassign the
     2331    18001                          field pointing to the previous GO_SUB or CALL item.
     2332    18002                          These items are identified by ILS.DEF = ADDR(NIL).
     2333    18003                          Search the DPI items and assign the forward defini-
     2334    18004                          tion point.
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:400  
     2335    18005        */
     2336    18006
     2337    18007    3              CASE (%OPA) ;

     2338    18008    3                DPI$$ = ILS$->ILS.DEF ;

  18008 27 012234   000004 236100                    LDQ     4,,PR0
        27 012235   000032 756000 0                  STQ     DPI$$

     2339    18009    3                IF DPI$$ = ADDR(NIL) THEN

  18009 27 012236   000000 116000 28                 CMPQ    0
        27 012237   012245 601000 27                 TNZ     s:18024

     2340    18010        /*N*
     2341    18011            CALL_IMPLEMENT -- When CALLs are implemented they must be included
     2342    18012                              in this IF statement, if ILS.DEF could be ~= ADDR(NIL).
     2343    18013        */
     2344    18014
     2345    18015    4                  DO ;

     2346    18016    4                    ILS$->ILS.RDEF = COMCOM.COMMON_REDEF ;

  18016 27 012240   000373 720000 xsym               LXL0    COMCOM+251
        27 012241   000001 440100                    SXL0    1,,PR0

     2347    18017    4                    COMCOM.COMMON_REDEF = CURRENT_SEQ_NO ;

  18017 27 012242   000052 235000 0                  LDA     CURRENT_SEQ_NO
        27 012243   000373 755000 xsym               STA     COMCOM+251

     2348    18018    4                  END ;

  18018 27 012244   012277 710000 27                 TRA     s:18038

     2349    18019
     2350    18020    4                ELSE DO UNTIL DPI$$ = ADDR(NIL) ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:401  

     2351    18021                            /* Let's go %FISHing */
     2352    18022                       %FISH(TRIAD=DPI$$->DPI.DNAME, RTN=ST$) ;

  18024 27 012245   000032 470400 0                  LDP0    DPI$$
        27 012246   000001 236100                    LDQ     1,,PR0
        27 012247   000000 756000 19                 STQ     ST$

  18025 27 012250   000000 471400 19                 LDP1    ST$
        27 012251   100000 220100                    LDX0    0,,PR1
        27 012252   000751 100003                    CMPX0   489,DU
        27 012253   012263 603000 27                 TRC     s:18030

  18026 27 012254   000000 470400 19                 LDP0    ST$
        27 012255   000001 236100                    LDQ     1,,PR0
        27 012256   000000 756000 19                 STQ     ST$

  18027 27 012257   000000 470400 19                 LDP0    ST$
        27 012260   000000 220100                    LDX0    0,,PR0
        27 012261   000751 100003                    CMPX0   489,DU
        27 012262   012254 602000 27                 TNC     s:18026

     2353    18030    4                  DPI$$->DPI.RDEF = ST$->VARIABLE.SEQ#.FD ;

  18030 27 012263   000000 470400 19                 LDP0    ST$
        27 012264   000010 220100                    LDX0    8,,PR0
        27 012265   000032 471400 0                  LDP1    DPI$$
        27 012266   100000 440100                    SXL0    0,,PR1

     2354    18031    4                  ST$->VARIABLE.SEQ#.FD = CURRENT_SEQ_NO ;

  18031 27 012267   000052 721000 0                  LXL1    CURRENT_SEQ_NO
        27 012270   000000 470400 19                 LDP0    ST$
        27 012271   000010 741100                    STX1    8,,PR0

     2355    18032    4                  ST$->VARIABLE.SEQ#.BD = CURRENT_SEQ_NO ;      /*#42183*/

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:402  
  18032 27 012272   000010 441100                    SXL1    8,,PR0

     2356    18033    4                  DPI$$ = DPI$$ -> DPI.NEXT;

  18033 27 012273   100002 236100                    LDQ     2,,PR1
        27 012274   000032 756000 0                  STQ     DPI$$

     2357    18034    4                END ;

  18034 27 012275   000000 116000 28                 CMPQ    0
        27 012276   012245 601000 27                 TNZ     s:18024

     2358    18035
     2359    18036    3            END /* Case of ILS ID */ ;

     2360    18037        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:403  
     2361    18038    2            NEXT_ILS$ = ILS$ ;

  18038 27 012277   000000 236000 6                  LDQ     ILS$
        27 012300   000002 756000 0                  STQ     NEXT_ILS$

     2362    18039                 %NEXT_ILS (POINTER=NEXT_ILS$) ;

  18041 27 012301   000002 470400 0                  LDP0    NEXT_ILS$
        27 012302   000002 236100                    LDQ     2,,PR0
        27 012303   000002 756000 0                  STQ     NEXT_ILS$

     2363    18044    2            ILL$ = ILS$->ILS.ILL$ ;

  18044 27 012304   000000 470400 6                  LDP0    ILS$
        27 012305   000003 236100                    LDQ     3,,PR0
        27 012306   000000 756000 10                 STQ     ILL$

     2364    18045    3            IF ILL$ ~= ADDR (NIL) THEN DO ;

  18045 27 012307   000000 116000 28                 CMPQ    0
        27 012310   013742 600000 27                 TZE     s:18509

     2365    18046        /*V*
     2366    18047            CHECK_INIT_PROC -- If the ILL item is %SCOPE then check the current
     2367    18048                               procedure's initialization procedure. If it exists but
     2368    18049                               is nil (it has nothing to initialize for CANCEL or
     2369    18050                               because of the INITIAL attribute) then delete it,
     2370    18051                               and set its pointer to show that there is now no
     2371    18052                               init proc.
     2372    18053        */
     2373    18054    4              IF ILL$->ILL.ID = %SCOPE THEN DO ;

  18054 27 012311   000000 471400 10                 LDP1    ILL$
        27 012312   100000 220100                    LDX0    0,,PR1
        27 012313   000445 100003                    CMPX0   293,DU
        27 012314   012504 601000 27                 TNZ     s:18132

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:404  
     2374    18055    4                CURRENT_PROC$ = ILL$->SCOPE.PROC$ ;

  18055 27 012315   100001 236100                    LDQ     1,,PR1
        27 012316   000111 756000 0                  STQ     CURRENT_PROC$

     2375    18056    5                IF CURRENT_PROC$ ~= ADDR (NIL) THEN DO ;

  18056 27 012317   000000 116000 28                 CMPQ    0
        27 012320   012600 600000 27                 TZE     s:18171

     2376    18057                       /* Current procedure is not itself an initialization proc */
     2377    18058    6                  IF CURRENT_PROC$->PROC_.B.INLINE THEN DO ;

  18058 27 012321   000111 473400 0                  LDP3    CURRENT_PROC$
        27 012322   300003 430100                    FSZN    3,,PR3
        27 012323   012360 605000 27                 TPL     s:18080

     2378    18059                         /* Procedure was optimized out. Now get rid of SCOPE,PEND. */
     2379    18060    6                    ILS$$ = ILS$ ;

  18060 27 012324   000000 236000 6                  LDQ     ILS$
        27 012325   000060 756000 0                  STQ     ILS$$

     2380    18061    6                    ILS$->ILS.ILL$ = ADDR(NIL) ; /* Optimize out SCOPE */

  18061 27 012326   000000 236000 28                 LDQ     0
        27 012327   000003 756100                    STQ     3,,PR0

     2381    18062                         %NEXT_NON_SUPPORT (POINTER=ILS$$) ;

  18072 27 012330   000060 470400 0                  LDP0    ILS$$
        27 012331   000002 236100                    LDQ     2,,PR0
        27 012332   000060 756000 0                  STQ     ILS$$

  18075 27 012333   000060 470400 0                  LDP0    ILS$$
        27 012334   000003 236100                    LDQ     3,,PR0
        27 012335   000000 116000 28                 CMPQ    0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:405  
        27 012336   012330 600000 27                 TZE     s:18072
        27 012337   000003 471500                    LDP1    3,,PR0
        27 012340   100000 220100                    LDX0    0,,PR1
        27 012341   000343 100003                    CMPX0   227,DU
        27 012342   012330 600000 27                 TZE     s:18072
        27 012343   000422 100003                    CMPX0   274,DU
        27 012344   012330 600000 27                 TZE     s:18072
        27 012345   000446 100003                    CMPX0   294,DU
        27 012346   012330 600000 27                 TZE     s:18072
        27 012347   000336 100003                    CMPX0   222,DU
        27 012350   012330 600000 27                 TZE     s:18072
        27 012351   000420 100003                    CMPX0   272,DU
        27 012352   012330 600000 27                 TZE     s:18072
        27 012353   000373 100003                    CMPX0   251,DU
        27 012354   012330 600000 27                 TZE     s:18072

     2382    18077    6                    ILS$$->ILS.ILL$ = ADDR(NIL) ; /* Also the PEND */

  18077 27 012355   000000 236000 28                 LDQ     0
        27 012356   000003 756100                    STQ     3,,PR0

     2383    18078    6                  END ;

  18078 27 012357   012600 710000 27                 TRA     s:18171

     2384    18079    6                  ELSE DO ;

     2385    18080    6                    ILS$$ = CURRENT_PROC$->PROC_.PROC_SUPP$->PROC_SUPP.INIT_PROC$ ;

  18080 27 012360   300001 474500                    LDP4    1,,PR3
        27 012361   400003 236100                    LDQ     3,,PR4
        27 012362   000060 756000 0                  STQ     ILS$$

     2386    18081    7                    IF ILS$$ ~= ADDR (NIL) THEN DO ; /* Init proc exists */

  18081 27 012363   000000 116000 28                 CMPQ    0
        27 012364   012600 600000 27                 TZE     s:18171
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:406  

     2387    18082    7                      SEARCH_ILS$ = ILS$$->ILS.ILL$-> /* PTR to PTR_SET */

  18082 27 012365   000060 475400 0                  LDP5    ILS$$
        27 012366   500003 476500                    LDP6    3,,PR5
        27 012367   600002 477500                    LDP7    2,,PR6
        27 012370   700010 236100                    LDQ     8,,PR7
        27 012371   000077 756000 0                  STQ     SEARCH_ILS$

     2388    18083    7                          PRESET.ROP->LABEL.PREV_ILS$ ;
     2389    18084                           /* PTR_SET items use the same template as PRESET. */
     2390    18085    8                      DO UNTIL SEARCH_ILS$->ILS.ILL$->ILL.ID = %USE_ENTRY ;

     2391    18086                             %NEXT_ILS (POINTER=SEARCH_ILS$) ;

  18088 27 012372   000077 470400 0                  LDP0    SEARCH_ILS$
        27 012373   000002 236100                    LDQ     2,,PR0
        27 012374   000077 756000 0                  STQ     SEARCH_ILS$

     2392    18091    8                      END ;

  18091 27 012375   000077 470400 0                  LDP0    SEARCH_ILS$
        27 012376   000003 471500                    LDP1    3,,PR0
        27 012377   100000 220100                    LDX0    0,,PR1
        27 012400   000364 100003                    CMPX0   244,DU
        27 012401   012372 601000 27                 TNZ     s:18088

     2393    18092    7                      TEMP$ = SEARCH_ILS$ ; /* Found beginning of init proc */

  18092 27 012402   000110 756000 0                  STQ     TEMP$

     2394    18093                           %NEXT_NON_LINOI (POINTER=TEMP$) ;

  18098 27 012403   000110 470400 0                  LDP0    TEMP$
        27 012404   000002 236100                    LDQ     2,,PR0
        27 012405   000110 756000 0                  STQ     TEMP$

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:407  
  18101 27 012406   000110 470400 0                  LDP0    TEMP$
        27 012407   000003 236100                    LDQ     3,,PR0
        27 012410   000000 116000 28                 CMPQ    0
        27 012411   012403 600000 27                 TZE     s:18098
        27 012412   000003 471500                    LDP1    3,,PR0
        27 012413   100000 220100                    LDX0    0,,PR1
        27 012414   000373 100003                    CMPX0   251,DU
        27 012415   012403 600000 27                 TZE     s:18098

     2395    18103    8                      IF TEMP$->ILS.ILL$->ILL.ID = %USE_END THEN DO ;

  18103 27 012416   000365 100003                    CMPX0   245,DU
        27 012417   012600 601000 27                 TNZ     s:18171

     2396    18104                             /* Nil init proc, nothing to initialize */
     2397    18105    8                        SEARCH_ILS$->ILS.ILL$ = ADDR (NIL) ; /* Optimize it out */

  18105 27 012420   000000 236000 28                 LDQ     0
        27 012421   000077 473400 0                  LDP3    SEARCH_ILS$
        27 012422   300003 756100                    STQ     3,,PR3

     2398    18106    8                        TEMP$->ILS.ILL$ = ADDR (NIL) ;

  18106 27 012423   000003 756100                    STQ     3,,PR0

     2399    18107    9                        IF ENTADDR_OF_NIL$ = ADDR (NIL) THEN DO ;

  18107 27 012424   000100 236000 0                  LDQ     ENTADDR_OF_NIL$
        27 012425   000000 116000 28                 CMPQ    0
        27 012426   012435 601000 27                 TNZ     s:18113

     2400    18108    9                          MKCN.CON = ENTADDR_OF_NIL_UBIN ;

  18108 27 012427   000000 235000 26                 LDA     ENTADDR_ENIL$
        27 012430   000000 755000 18                 STA     MKCN

     2401    18109    9                          CALL Z8AC$MAKE_CONST (ENTADDR_OF_NIL$) ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:408  

  18109 27 012431   000052 630400 28                 EPPR0   42
        27 012432   000001 631400 28                 EPPR1   1
        27 012433   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        27 012434   000000 011000                    NOP     0

     2402    18110    9                        END ;

     2403    18111                             %RESERVE_ILL (ITEM=%PREOFF, POINTER=TEMP$) ;

  18113 27 012435   000172 235000 xsym               LDA     ILL_STEP+122
        27 012436   000000 755000 1                  STA     ITERATION

  18114 27 012437   000002 236000 11                 LDQ     ILL_+2
        27 012440   000000 036000 1                  ADLQ    ITERATION
        27 012441   000003 116000 11                 CMPQ    ILL_+3
        27 012442   012453 604000 27                 TMI     s:18116

  18115 27 012443   000003 236000 28                 LDQ     3
        27 012444   000130 756000 0                  STQ     OPT_FLAG+1
        27 012445   000130 630400 0                  EPPR0   OPT_FLAG+1
        27 012446   000131 450400 0                  STP0    OPT_FLAG+2
        27 012447   000131 630400 0                  EPPR0   OPT_FLAG+2
        27 012450   000001 631400 28                 EPPR1   1
        27 012451   000000 701000 xent               TSX1    Z8AR$RESERVER
        27 012452   000000 011000                    NOP     0

  18116 27 012453   000002 236000 11                 LDQ     ILL_+2
        27 012454   000022 736000                    QLS     18
        27 012455   000001 036000 11                 ADLQ    ILL_+1
        27 012456   000110 756000 0                  STQ     TEMP$

  18117 27 012457   000002 236000 11                 LDQ     ILL_+2
        27 012460   000000 036000 1                  ADLQ    ITERATION
        27 012461   000002 756000 11                 STQ     ILL_+2

  18118 27 012462   000420 220003                    LDX0    272,DU
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:409  
        27 012463   000110 470400 0                  LDP0    TEMP$
        27 012464   000000 740100                    STX0    0,,PR0

     2404    18121                             /* Create PREOFF item to show there is no init proc */
     2405    18122    8                        TEMP$->PREOFF.OFFSET = ILS$$->ILS.ILL$->PRESET.OFFSET ;

  18122 27 012465   000060 471400 0                  LDP1    ILS$$
        27 012466   100003 473500                    LDP3    3,,PR1
        27 012467   300000 721100                    LXL1    0,,PR3
        27 012470   000000 441100                    SXL1    0,,PR0

     2406    18123    8                        TEMP$->PREOFF.LOP = ILS$$->ILS.ILL$->PRESET.LOP ;

  18123 27 012471   100003 473500                    LDP3    3,,PR1
        27 012472   300001 236100                    LDQ     1,,PR3
        27 012473   000001 756100                    STQ     1,,PR0

     2407    18124    8                        TEMP$->PREOFF.ROP = ENTADDR_OF_NIL$->ETT.LOP ;

  18124 27 012474   000100 473400 0                  LDP3    ENTADDR_OF_NIL$
        27 012475   300001 236100                    LDQ     1,,PR3
        27 012476   000002 756100                    STQ     2,,PR0

     2408    18125    8                        TEMP$->PREOFF.N = 1 ;

  18125 27 012477   000001 235007                    LDA     1,DL
        27 012500   000003 755100                    STA     3,,PR0

     2409    18126    8                        ILS$$->ILS.ILL$ = TEMP$ ;

  18126 27 012501   000110 236000 0                  LDQ     TEMP$
        27 012502   100003 756100                    STQ     3,,PR1

     2410    18127    8                      END ;

     2411    18128    7                    END ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:410  
     2412    18129    6                  END ;

     2413    18130    5                END ;

     2414    18131    4              END ;

  18131 27 012503   012600 710000 27                 TRA     s:18171

     2415    18132    4              ELSE IF ILL$->ILL.ID = %ENTRY THEN DO ;

  18132 27 012504   000353 100003                    CMPX0   235,DU
        27 012505   012517 601000 27                 TNZ     s:18142

     2416    18133        /*V*
     2417    18134            FIND_FIRST_ENTRY -- Notify later phases what the sequence number
     2418    18135                                is for the first ENTRY in the ILL.
     2419    18136        */
     2420    18137    4                IF COMCOM.FIRST_ENTRY_SEQ_NUM = 0 THEN

  18137 27 012506   000440 235000 xsym               LDA     COMCOM+288
        27 012507   012512 601000 27                 TNZ     s:18139

     2421    18138    4                  COMCOM.FIRST_ENTRY_SEQ_NUM = CURRENT_SEQ_NO ;

  18138 27 012510   000052 235000 0                  LDA     CURRENT_SEQ_NO
        27 012511   000440 755000 xsym               STA     COMCOM+288

     2422    18139    4                ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ = COMCOM.H_ENTRY$;

  18139 27 012512   000423 236000 xsym               LDQ     COMCOM+275
        27 012513   100003 756100                    STQ     3,,PR1

     2423    18140    4                COMCOM.H_ENTRY$ = ILS$;

  18140 27 012514   000000 236000 6                  LDQ     ILS$
        27 012515   000423 756000 xsym               STQ     COMCOM+275

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:411  
     2424    18141    4              END ;

  18141 27 012516   012600 710000 27                 TRA     s:18171

     2425    18142    4              ELSE IF ILL$->ILL.ID = %USE_ENTRY THEN DO;

  18142 27 012517   000364 100003                    CMPX0   244,DU
        27 012520   012526 601000 27                 TNZ     s:18146

     2426    18143    4                ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ = COMCOM.H_ENTRY$;

  18143 27 012521   000423 236000 xsym               LDQ     COMCOM+275
        27 012522   100003 756100                    STQ     3,,PR1

     2427    18144    4                COMCOM.H_ENTRY$ = ILS$;

  18144 27 012523   000000 236000 6                  LDQ     ILS$
        27 012524   000423 756000 xsym               STQ     COMCOM+275

     2428    18145    4              END;

  18145 27 012525   012600 710000 27                 TRA     s:18171

     2429    18146    3              ELSE IF ILL$->ILL.ID = %VAL_END AND VAL_END$ = ADDR(NIL) THEN

  18146 27 012526   000370 100003                    CMPX0   248,DU
        27 012527   012536 601000 27                 TNZ     s:18148
        27 012530   000031 236000 0                  LDQ     VAL_END$
        27 012531   000000 116000 28                 CMPQ    0
        27 012532   012536 601000 27                 TNZ     s:18148

     2430    18147    3                VAL_END$ = ILL$;

  18147 27 012533   000000 236000 10                 LDQ     ILL$
        27 012534   000031 756000 0                  STQ     VAL_END$
        27 012535   012600 710000 27                 TRA     s:18171

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:412  
     2431    18148    4              ELSE IF ILL$->ILL.ID = %LINOI AND VAL_END$ ~= ADDR(NIL) THEN DO;

  18148 27 012536   000373 100003                    CMPX0   251,DU
        27 012537   012551 601000 27                 TNZ     s:18158
        27 012540   000031 236000 0                  LDQ     VAL_END$
        27 012541   000000 116000 28                 CMPQ    0
        27 012542   012551 600000 27                 TZE     s:18158

     2432    18149    4                VAL_END$->VAL_END.LINOI$ = ILS$;

  18149 27 012543   000000 236000 6                  LDQ     ILS$
        27 012544   000031 473400 0                  LDP3    VAL_END$
        27 012545   300002 756100                    STQ     2,,PR3

     2433    18150    4                VAL_END$ = ADDR(NIL);

  18150 27 012546   000000 236000 28                 LDQ     0
        27 012547   000031 756000 0                  STQ     VAL_END$

     2434    18151    4              END;

  18151 27 012550   012600 710000 27                 TRA     s:18171

     2435    18152
     2436    18153        /*V*
     2437    18154            DEAD_CODE_CHECK -- After each unconditional or altered GO that is not in
     2438    18155                               a GO vector (GO TO DEPENDING) and each STOP, look for
     2439    18156                               unreachable code, flag it as such, and delete it.
     2440    18157        */
     2441    18158    4              ELSE IF ILL$->ILL.ID = %DEFLB THEN DO ;

  18158 27 012551   000346 100003                    CMPX0   230,DU
        27 012552   012600 601000 27                 TNZ     s:18171

     2442    18159    5                IF ILL$->ILL.LOP->LABEL.B.GO_VECTOR_START THEN DO ;

  18159 27 012553   100001 473500                    LDP3    1,,PR1
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:413  
        27 012554   300003 236100                    LDQ     3,,PR3
        27 012555   000004 316003                    CANQ    4,DU
        27 012556   012564 600000 27                 TZE     s:18163

     2443    18160    5                  GOTO_VECTOR = TRUE ;

  18160 27 012557   400000 236003                    LDQ     -131072,DU
        27 012560   000074 756000 0                  STQ     GOTO_VECTOR

     2444    18161    5                  VECTOR_END$ = ILL$->ILL.LOP->LABEL.P_END$ ;

  18161 27 012561   300001 236100                    LDQ     1,,PR3
        27 012562   000075 756000 0                  STQ     VECTOR_END$

     2445    18162    5                END ;

  18162 27 012563   012600 710000 27                 TRA     s:18171

     2446    18163    4                ELSE IF ILL$->ILL.LOP = VECTOR_END$

  18163 27 012564   100001 236100                    LDQ     1,,PR1
        27 012565   000075 116000 0                  CMPQ    VECTOR_END$
        27 012566   012571 601000 27                 TNZ     s:18165

     2447    18164    4                  THEN GOTO_VECTOR = FALSE ;

  18164 27 012567   000074 450000 0                  STZ     GOTO_VECTOR
        27 012570   012600 710000 27                 TRA     s:18171

     2448    18165    5                ELSE IF ILL$->ILL.LOP->LABEL.B.LABEL_AFTER_USE THEN DO ;

  18165 27 012571   300003 236100                    LDQ     3,,PR3
        27 012572   000100 316007                    CANQ    64,DL
        27 012573   012600 600000 27                 TZE     s:18171

     2449    18166    5                  ILL$->ENTRY_ILL.PREV_ENTRY_ILS$ = COMCOM.H_ENTRY$;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:414  
  18166 27 012574   000423 236000 xsym               LDQ     COMCOM+275
        27 012575   100003 756100                    STQ     3,,PR1

     2450    18167    5                  COMCOM.H_ENTRY$ = ILS$;

  18167 27 012576   000000 236000 6                  LDQ     ILS$
        27 012577   000423 756000 xsym               STQ     COMCOM+275

     2451    18168    5                END ;

     2452    18169    4              END ;

     2453    18170
     2454    18171    3              IF NOT GOTO_VECTOR THEN

  18171 27 012600   000074 234000 0                  SZN     GOTO_VECTOR
        27 012601   013742 604000 27                 TMI     s:18509

     2455    18172                          /* In a GOTO vector, suppress dead code check. */
     2456    18173    3                IF ILL$->ILL.ID = %STOP OR ILL$->ILL.ID = %EXIT_PROG

  18173 27 012602   000000 470400 10                 LDP0    ILL$
        27 012603   000000 220100                    LDX0    0,,PR0
        27 012604   000337 100003                    CMPX0   223,DU
        27 012605   012622 600000 27                 TZE     SCRAP_DEAD_CODE
        27 012606   000366 100003                    CMPX0   246,DU
        27 012607   012622 600000 27                 TZE     SCRAP_DEAD_CODE
        27 012610   000365 100003                    CMPX0   245,DU
        27 012611   012622 600000 27                 TZE     SCRAP_DEAD_CODE
        27 012612   000344 100003                    CMPX0   228,DU
        27 012613   012620 601000 27                 TNZ     s:18173+14
        27 012614   000000 721100                    LXL1    0,,PR0
        27 012615   012622 600000 27                 TZE     SCRAP_DEAD_CODE
        27 012616   000020 101003                    CMPX1   16,DU
        27 012617   012622 600000 27                 TZE     SCRAP_DEAD_CODE
        27 012620   000106 235000 0                  LDA     DOEND_FLAG
        27 012621   013742 605400 27                 TPNZ    s:18509
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:415  

     2457    18174    3                   OR ILL$->ILL.ID = %USE_END OR (ILL$->ILL.ID = %GO AND
     2458    18175    3                    (ILL$->ILL.CODE = %GO_UNCONDITIONAL OR
     2459    18176    3                     ILL$->ILL.CODE = %GO_ALTERED)) OR DOEND_FLAG <= 0 THEN
     2460    18177    4   SCRAP_DEAD_CODE: DO ;

  18177 27 012622                       SCRAP_DEAD_* null
     2461    18178    5                  IF ILL$->ILL.ID = %GO AND ILL$->ILL.CODE = %GO_ALTERED THEN DO ;

  18178 27 012622   000344 100003                    CMPX0   228,DU
        27 012623   012664 601000 27                 TNZ     s:18200
        27 012624   000000 721100                    LXL1    0,,PR0
        27 012625   000020 101003                    CMPX1   16,DU
        27 012626   012664 601000 27                 TNZ     s:18200

     2462    18179    5                    SEARCH_ILS$ = ILS$ ;

  18179 27 012627   000000 236000 6                  LDQ     ILS$
        27 012630   000077 756000 0                  STQ     SEARCH_ILS$

     2463    18180                         %NEXT_NON_SUPPORT (POINTER=SEARCH_ILS$) ;

  18190 27 012631   000077 470400 0                  LDP0    SEARCH_ILS$
        27 012632   000002 236100                    LDQ     2,,PR0
        27 012633   000077 756000 0                  STQ     SEARCH_ILS$

  18193 27 012634   000077 470400 0                  LDP0    SEARCH_ILS$
        27 012635   000003 236100                    LDQ     3,,PR0
        27 012636   000000 116000 28                 CMPQ    0
        27 012637   012631 600000 27                 TZE     s:18190
        27 012640   000003 471500                    LDP1    3,,PR0
        27 012641   100000 220100                    LDX0    0,,PR1
        27 012642   000343 100003                    CMPX0   227,DU
        27 012643   012631 600000 27                 TZE     s:18190
        27 012644   000422 100003                    CMPX0   274,DU
        27 012645   012631 600000 27                 TZE     s:18190
        27 012646   000446 100003                    CMPX0   294,DU
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:416  
        27 012647   012631 600000 27                 TZE     s:18190
        27 012650   000336 100003                    CMPX0   222,DU
        27 012651   012631 600000 27                 TZE     s:18190
        27 012652   000420 100003                    CMPX0   272,DU
        27 012653   012631 600000 27                 TZE     s:18190
        27 012654   000373 100003                    CMPX0   251,DU
        27 012655   012631 600000 27                 TZE     s:18190

     2464    18195    5                    IF SEARCH_ILS$->ILS.ILL$->ILL.ID = %DEFLB THEN

  18195 27 012656   000346 100003                    CMPX0   230,DU
        27 012657   012664 601000 27                 TNZ     s:18200

     2465    18196    5                      IF SEARCH_ILS$->ILS.ILL$->ILL.LOP->LABEL.B.PFORM_74_END

  18196 27 012660   100001 473500                    LDP3    1,,PR1
        27 012661   300003 236100                    LDQ     3,,PR3
        27 012662   000010 316003                    CANQ    8,DU
        27 012663   013742 601000 27                 TNZ     s:18509

     2466    18197    5                        THEN EXIT SCRAP_DEAD_CODE ;
     2467    18198                           /* End of CBL74 PERFORM, there is no dead code. */
     2468    18199    5                  END ;

     2469    18200    4                  DEAD_CODE_CHECK = MINIMUM (DOEND_FLAG, 0) ;

  18200 27 012664   000000 236003                    LDQ     0,DU
        27 012665   012670 604000 27                 TMI     s:18200+4
        27 012666   000106 116000 0                  CMPQ    DOEND_FLAG
        27 012667   012671 604400 27                 TMOZ    s:18200+5
        27 012670   000106 236000 0                  LDQ     DOEND_FLAG
        27 012671   000076 756000 0                  STQ     DEAD_CODE_CHECK

     2470    18201    4                  DOEND_FLAG = 1 ;

  18201 27 012672   000001 235007                    LDA     1,DL
        27 012673   000106 755000 0                  STA     DOEND_FLAG
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:417  

     2471    18202        /*             Explanation of DEAD_CODE_CHECK:
     2472    18203                       0 = Nothing of interest deleted (yet).
     2473    18204                       -1 = At least one executable statement has been deleted.
     2474    18205                            The dead code message has been issued. It may be
     2475    18206                            necessary to delete more, so continue scanning, but
     2476    18207                            disable printing of dead code messages for the current
     2477    18208                            %STOP or %GO.
     2478    18209                       +1 = Referenced label or end of program found. There is
     2479    18210                            no (more) dead code for the current %STOP or %GO.
     2480    18211        */
     2481    18212    4                  LINOI_FLAG = ILL$->ILL.ID = %USE_ENTRY ;

  18212 27 012674   400000 220003                    LDX0    -131072,DU
        27 012675   000000 470400 10                 LDP0    ILL$
        27 012676   000000 221100                    LDX1    0,,PR0
        27 012677   000364 101003                    CMPX1   244,DU
        27 012700   012702 600000 27                 TZE     s:18212+6
        27 012701   000000 220003                    LDX0    0,DU
        27 012702   000000 636010                    EAQ     0,X0
        27 012703   000102 756000 0                  STQ     LINOI_FLAG

     2482    18213    4                  LINOI_FLAG1 = LINOI_FLAG ;

  18213 27 012704   000102 236000 0                  LDQ     LINOI_FLAG
        27 012705   400000 376003                    ANQ     -131072,DU
        27 012706   000101 756000 0                  STQ     LINOI_FLAG1

     2483    18214    4                  USE_FLAG = LINOI_FLAG ;

  18214 27 012707   000103 756000 0                  STQ     USE_FLAG

     2484    18215    4                  SEARCH_ILS$ = ILS$ ;

  18215 27 012710   000000 236000 6                  LDQ     ILS$
        27 012711   000077 756000 0                  STQ     SEARCH_ILS$

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:418  
     2485    18216    5                  DO UNTIL DEAD_CODE_CHECK > 0 ;

     2486    18217                         %NEXT_ILS (POINTER=SEARCH_ILS$) ;

  18219 27 012712   000077 470400 0                  LDP0    SEARCH_ILS$
        27 012713   000002 236100                    LDQ     2,,PR0
        27 012714   000077 756000 0                  STQ     SEARCH_ILS$

     2487    18222    5                    ILL$ = SEARCH_ILS$->ILS.ILL$ ;

  18222 27 012715   000077 470400 0                  LDP0    SEARCH_ILS$
        27 012716   000003 236100                    LDQ     3,,PR0
        27 012717   000000 756000 10                 STQ     ILL$

     2488    18223    6                    IF ILL$ ~= ADDR (NIL) THEN DO CASE (ILL$->ILL.ID) ;

  18223 27 012720   000000 116000 28                 CMPQ    0
        27 012721   013740 600000 27                 TZE     s:18501

  18223 27 012722   000000 471400 10                 LDP1    ILL$
        27 012723   100000 236100                    LDQ     0,,PR1
        27 012724   000022 772000                    QRL     18
        27 012725   000336 136007                    SBLQ    222,DL
        27 012726   000111 116007                    CMPQ    73,DL
        27 012727   012731 602006 27                 TNC     s:18223+9,QL
        27 012730   013676 710000 27                 TRA     s:18481
        27 012731   013572 710000 27                 TRA     s:18432
        27 012732   013630 710000 27                 TRA     s:18458
        27 012733   013676 710000 27                 TRA     s:18481
        27 012734   013676 710000 27                 TRA     s:18481
        27 012735   013676 710000 27                 TRA     s:18481
        27 012736   013572 710000 27                 TRA     s:18432
        27 012737   013524 710000 27                 TRA     s:18407
        27 012740   013676 710000 27                 TRA     s:18481
        27 012741   013137 710000 27                 TRA     s:18269
        27 012742   013676 710000 27                 TRA     s:18481
        27 012743   013676 710000 27                 TRA     s:18481
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:419  
        27 012744   013676 710000 27                 TRA     s:18481
        27 012745   013676 710000 27                 TRA     s:18481
        27 012746   013134 710000 27                 TRA     s:18266
        27 012747   013676 710000 27                 TRA     s:18481
        27 012750   013676 710000 27                 TRA     s:18481
        27 012751   013676 710000 27                 TRA     s:18481
        27 012752   013676 710000 27                 TRA     s:18481
        27 012753   013740 710000 27                 TRA     s:18501
        27 012754   013740 710000 27                 TRA     s:18501
        27 012755   013676 710000 27                 TRA     s:18481
        27 012756   013676 710000 27                 TRA     s:18481
        27 012757   013572 710000 27                 TRA     s:18432
        27 012760   013572 710000 27                 TRA     s:18432
        27 012761   013630 710000 27                 TRA     s:18458
        27 012762   013676 710000 27                 TRA     s:18481
        27 012763   013601 710000 27                 TRA     s:18438
        27 012764   013676 710000 27                 TRA     s:18481
        27 012765   013676 710000 27                 TRA     s:18481
        27 012766   013042 710000 27                 TRA     s:18226
        27 012767   013625 710000 27                 TRA     s:18454
        27 012770   013171 710000 27                 TRA     s:18292
        27 012771   013171 710000 27                 TRA     s:18292
        27 012772   013171 710000 27                 TRA     s:18292
        27 012773   013171 710000 27                 TRA     s:18292
        27 012774   013171 710000 27                 TRA     s:18292
        27 012775   013676 710000 27                 TRA     s:18481
        27 012776   013447 710000 27                 TRA     s:18360
        27 012777   013676 710000 27                 TRA     s:18481
        27 013000   013676 710000 27                 TRA     s:18481
        27 013001   013676 710000 27                 TRA     s:18481
        27 013002   013676 710000 27                 TRA     s:18481
        27 013003   013676 710000 27                 TRA     s:18481
        27 013004   013676 710000 27                 TRA     s:18481
        27 013005   013676 710000 27                 TRA     s:18481
        27 013006   013676 710000 27                 TRA     s:18481
        27 013007   013676 710000 27                 TRA     s:18481
        27 013010   013676 710000 27                 TRA     s:18481
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:420  
        27 013011   013676 710000 27                 TRA     s:18481
        27 013012   013676 710000 27                 TRA     s:18481
        27 013013   013572 710000 27                 TRA     s:18432
        27 013014   013676 710000 27                 TRA     s:18481
        27 013015   013572 710000 27                 TRA     s:18432
        27 013016   013676 710000 27                 TRA     s:18481
        27 013017   013676 710000 27                 TRA     s:18481
        27 013020   013676 710000 27                 TRA     s:18481
        27 013021   013676 710000 27                 TRA     s:18481
        27 013022   013676 710000 27                 TRA     s:18481
        27 013023   013676 710000 27                 TRA     s:18481
        27 013024   013676 710000 27                 TRA     s:18481
        27 013025   013676 710000 27                 TRA     s:18481
        27 013026   013676 710000 27                 TRA     s:18481
        27 013027   013676 710000 27                 TRA     s:18481
        27 013030   013676 710000 27                 TRA     s:18481
        27 013031   013676 710000 27                 TRA     s:18481
        27 013032   013676 710000 27                 TRA     s:18481
        27 013033   013676 710000 27                 TRA     s:18481
        27 013034   013676 710000 27                 TRA     s:18481
        27 013035   013676 710000 27                 TRA     s:18481
        27 013036   013676 710000 27                 TRA     s:18481
        27 013037   013625 710000 27                 TRA     s:18454
        27 013040   013620 710000 27                 TRA     s:18449
        27 013041   013572 710000 27                 TRA     s:18432

     2489    18224
     2490    18225    6                      CASE (%LINOI) ;

     2491    18226    7                        IF ILL$->LINOI.TYPE = %S_TYPE_ENTRY THEN DO ;

  18226 27 013042   100002 220100                    LDX0    2,,PR1
        27 013043   000016 100003                    CMPX0   14,DU
        27 013044   013061 601000 27                 TNZ     s:18235

     2492    18227                               /* Found an IBM-style ENTRY, which cannot be
     2493    18228                                  dead code. */
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:421  
     2494    18229    7                          DEAD_CODE_CHECK = 1 ;

  18229 27 013045   000001 235007                    LDA     1,DL
        27 013046   000076 755000 0                  STA     DEAD_CODE_CHECK

     2495    18230    7                          NEXT_ILS$ = SEARCH_ILS$ ;

  18230 27 013047   000077 236000 0                  LDQ     SEARCH_ILS$
        27 013050   000002 756000 0                  STQ     NEXT_ILS$

     2496    18231    7                          IF SEARCH_ILS$->ILS.NEXT->ILS.ILL$->ILL.ID = %GO

  18231 27 013051   000002 473500                    LDP3    2,,PR0
        27 013052   300003 474500                    LDP4    3,,PR3
        27 013053   400000 221100                    LDX1    0,,PR4
        27 013054   000344 101003                    CMPX1   228,DU
        27 013055   013127 601000 27                 TNZ     s:18262

     2497    18232    7                            THEN SEARCH_ILS$->ILS.NEXT->ILS.ILL$ = ADDR (NIL) ;

  18232 27 013056   000000 236000 28                 LDQ     0
        27 013057   300003 756100                    STQ     3,,PR3

     2498    18233                                 /* Optimize out the unneeded GO around the ENTRY */
     2499    18234    7                        END ;

  18234 27 013060   013127 710000 27                 TRA     s:18262

     2500    18235    6                        ELSE IF (ILL$->LINOI.TYPE ~= %NO_STATEMENT_TYPE AND

  18235 27 013061   000000 100003                    CMPX0   0,DU
        27 013062   013065 600000 27                 TZE     s:18235+4
        27 013063   000103 234000 0                  SZN     USE_FLAG
        27 013064   013067 605000 27                 TPL     s:18237
        27 013065   000102 234000 0                  SZN     LINOI_FLAG
        27 013066   013127 604000 27                 TMI     s:18262

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:422  
     2501    18236    7                            NOT USE_FLAG) OR NOT LINOI_FLAG THEN DO ;

     2502    18237    8                          IF ILL$->LINOI.TYPE = %S_TYPE_LABEL_DEF THEN DO ;

  18237 27 013067   000075 100003                    CMPX0   61,DU
        27 013070   013100 601000 27                 TNZ     s:18243

     2503    18238                                 /* Check for GO to next SECTION; if found,
     2504    18239                                    quietly optimize it out. */
     2505    18240    8                            IF SEARCH_ILS$->ILS.NEXT->ILS.ILL$->ILL.ID = %GO THEN

  18240 27 013071   000002 473500                    LDP3    2,,PR0
        27 013072   300003 474500                    LDP4    3,,PR3
        27 013073   400000 221100                    LDX1    0,,PR4
        27 013074   000344 101003                    CMPX1   228,DU
        27 013075   013100 601000 27                 TNZ     s:18243

     2506    18241    8                              SEARCH_ILS$->ILS.NEXT->ILS.ILL$ = ADDR (NIL) ;

  18241 27 013076   000000 236000 28                 LDQ     0
        27 013077   300003 756100                    STQ     3,,PR3

     2507    18242    8                          END ;

     2508    18243    7                          TEMP$ = SEARCH_ILS$ ;

  18243 27 013100   000077 236000 0                  LDQ     SEARCH_ILS$
        27 013101   000110 756000 0                  STQ     TEMP$

     2509    18244                               %NEXT_ILS (POINTER=TEMP$) ;

  18246 27 013102   000110 473400 0                  LDP3    TEMP$
        27 013103   300002 236100                    LDQ     2,,PR3
        27 013104   000110 756000 0                  STQ     TEMP$

     2510    18249    7                          IF TEMP$->ILS.ILL$ ~= ADDR (NIL) THEN

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:423  
  18249 27 013105   000110 473400 0                  LDP3    TEMP$
        27 013106   300003 236100                    LDQ     3,,PR3
        27 013107   000000 116000 28                 CMPQ    0
        27 013110   013115 600000 27                 TZE     s:18253

     2511    18250    7                            IF TEMP$->ILS.ILL$->ILL.ID = %DO1 THEN EXIT ;

  18250 27 013111   300003 474500                    LDP4    3,,PR3
        27 013112   400000 220100                    LDX0    0,,PR4
        27 013113   000375 100003                    CMPX0   253,DU
        27 013114   013127 600000 27                 TZE     s:18262

     2512    18251                                 /* The above needed so the dead code message will
     2513    18252                                    be at a statement, not a label. */
     2514    18253    7                          LINOI_FLAG1 = TRUE ; /* We've found a LINOI */

  18253 27 013115   400000 236003                    LDQ     -131072,DU
        27 013116   000101 756000 0                  STQ     LINOI_FLAG1

     2515    18254    7                          COMCOM.CURRENT.LINE = ILL$->LINOI.LINE_NO ;

  18254 27 013117   100001 236100                    LDQ     1,,PR1
        27 013120   777777 376007                    ANQ     -1,DL
        27 013121   000133 756000 xsym               STQ     COMCOM+91

     2516    18255    7                          COMCOM.CURRENT.COLUMN = ILL$->LINOI.COLUMN_NO ;

  18255 27 013122   100001 236100                    LDQ     1,,PR1
        27 013123   000022 772000                    QRL     18
        27 013124   000134 756000 xsym               STQ     COMCOM+92

     2517    18256    7                          NEXT_ILS$ = SEARCH_ILS$ ;

  18256 27 013125   000077 236000 0                  LDQ     SEARCH_ILS$
        27 013126   000002 756000 0                  STQ     NEXT_ILS$

     2518    18257                               /* If dead code detected, will delete everything up to
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:424  
     2519    18258                                  but not including the LINOI of a DOEND or a
     2520    18259                                  referenced DEFLB. */
     2521    18260    7                        END ;

     2522    18261
     2523    18262    6                        IF ILL$->LINOI.TYPE ~= %NO_STATEMENT_TYPE

  18262 27 013127   100002 220100                    LDX0    2,,PR1
        27 013130   013740 600000 27                 TZE     s:18501

     2524    18263    6                          THEN LINOI_FLAG = TRUE ;

  18263 27 013131   400000 236003                    LDQ     -131072,DU
        27 013132   000102 756000 0                  STQ     LINOI_FLAG
        27 013133   013740 710000 27                 TRA     s:18501

     2525    18264
     2526    18265    6                      CASE (%ENTRY) ;

     2527    18266    6                        DEAD_CODE_CHECK = 1 ;

  18266 27 013134   000001 235007                    LDA     1,DL
        27 013135   000076 755000 0                  STA     DEAD_CODE_CHECK
        27 013136   013740 710000 27                 TRA     s:18501

     2528    18267
     2529    18268    6                      CASE (%DEFLB) ;

     2530    18269    6                        IF ILL$->ILL.LOP->LABEL.B.REFERENCED

  18269 27 013137   100001 473500                    LDP3    1,,PR1
        27 013140   300003 234100                    SZN     3,,PR3
        27 013141   013154 605000 27                 TPL     s:18274
        27 013142   300003 236100                    LDQ     3,,PR3
        27 013143   000200 316003                    CANQ    128,DU
        27 013144   013154 601000 27                 TNZ     s:18274
        27 013145   000010 316003                    CANQ    8,DU
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:425  
        27 013146   013154 601000 27                 TNZ     s:18274
        27 013147   040000 316007                    CANQ    16384,DL
        27 013150   013154 601000 27                 TNZ     s:18274

     2531    18270    6                            AND NOT ILL$->ILL.LOP->LABEL.B.PFORM_END
     2532    18271    6                            AND NOT ILL$->ILL.LOP->LABEL.B.PFORM_74_END
     2533    18272    6                            AND NOT ILL$->ILL.LOP->LABEL.B.ON_SIZE_ERROR
     2534    18273    6                          THEN DEAD_CODE_CHECK = 1 ;

  18273 27 013151   000001 235007                    LDA     1,DL
        27 013152   000076 755000 0                  STA     DEAD_CODE_CHECK
        27 013153   013740 710000 27                 TRA     s:18501

     2535    18274    6                        ELSE IF ILL$->ILL.LOP->LABEL.ID = %SECTION

  18274 27 013154   300000 220100                    LDX0    0,,PR3
        27 013155   000770 100003                    CMPX0   504,DU
        27 013156   013740 601000 27                 TNZ     s:18501
        27 013157   300007 236100                    LDQ     7,,PR3
        27 013160   000000 116000 28                 CMPQ    0
        27 013161   013740 600000 27                 TZE     s:18501

     2536    18275    6                            AND ILL$->ILL.LOP->LABEL.SEGMENT$ ~= ADDR(NIL) THEN
     2537    18276    7                          DO ;

     2538    18277                                 /* Do not optimize out numbered SECTION label */
     2539    18278    7                            DOEND_FLAG = DEAD_CODE_CHECK ;

  18278 27 013162   000076 235000 0                  LDA     DEAD_CODE_CHECK
        27 013163   000106 755000 0                  STA     DOEND_FLAG

     2540    18279    7                            NEXT_ILS$ = SEARCH_ILS$ ;

  18279 27 013164   000077 236000 0                  LDQ     SEARCH_ILS$
        27 013165   000002 756000 0                  STQ     NEXT_ILS$

     2541    18280    7                            DEAD_CODE_CHECK = 1 ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:426  

  18280 27 013166   000001 235007                    LDA     1,DL
        27 013167   000076 755000 0                  STA     DEAD_CODE_CHECK

     2542    18281    7                          END ;

  18281 27 013170   013740 710000 27                 TRA     s:18501

     2543    18282
     2544    18283    6                      CASE (%DO1, %DO2, %DO3, %DO4, %DO5/*, %DO6 */) ;

     2545    18284
     2546    18285        /*E*
     2547    18286              ERROR:  DEAD_CODE
     2548    18287            MESSAGE:  This statement generates code that cannot be reached.
     2549    18288        DESCRIPTION:  This warning is flagged if there is some dead code after
     2550    18289                      an unconditional GOTO or STOP RUN statement.
     2551    18290        */
     2552    18291
     2553    18292    7                        IF DEAD_CODE_CHECK = 0 THEN DO ;

  18292 27 013171   000076 235000 0                  LDA     DEAD_CODE_CHECK
        27 013172   013277 601000 27                 TNZ     s:18337

     2554    18293    8                          IF NOT LINOI_FLAG1 THEN DO ;

  18293 27 013173   000101 234000 0                  SZN     LINOI_FLAG1
        27 013174   013273 604000 27                 TMI     s:18335

     2555    18294    9                            IF ILL$->ILL.ID = %DO1 THEN DO ;

  18294 27 013175   100000 220100                    LDX0    0,,PR1
        27 013176   000375 100003                    CMPX0   253,DU
        27 013177   013243 601000 27                 TNZ     s:18322

     2556    18295    9                              TEMP$ = SEARCH_ILS$ ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:427  
  18295 27 013200   000077 236000 0                  LDQ     SEARCH_ILS$
        27 013201   000110 756000 0                  STQ     TEMP$

     2557    18296                                   %NEXT_NON_LINOI (POINTER=TEMP$) ;

  18301 27 013202   000110 470400 0                  LDP0    TEMP$
        27 013203   000002 236100                    LDQ     2,,PR0
        27 013204   000110 756000 0                  STQ     TEMP$

  18304 27 013205   000110 470400 0                  LDP0    TEMP$
        27 013206   000003 236100                    LDQ     3,,PR0
        27 013207   000000 116000 28                 CMPQ    0
        27 013210   013202 600000 27                 TZE     s:18301
        27 013211   000003 471500                    LDP1    3,,PR0
        27 013212   100000 220100                    LDX0    0,,PR1
        27 013213   000373 100003                    CMPX0   251,DU
        27 013214   013202 600000 27                 TZE     s:18301

     2558    18306   10                              DO UNTIL TEMP$->ILS.ILL$->ILL.ID = %LINOI

     2559    18307   10                                AND TEMP$->ILS.ILL$->LINOI.TYPE ~= %S_TYPE_LABEL_DEF ;
     2560    18308   11                                DO UNTIL TEMP$->ILS.ILL$ ~= ADDR (NIL) ;

     2561    18309                                       %NEXT_ILS (POINTER=TEMP$) ;

  18311 27 013215   000110 470400 0                  LDP0    TEMP$
        27 013216   000002 236100                    LDQ     2,,PR0
        27 013217   000110 756000 0                  STQ     TEMP$

     2562    18314   11                                END ;

  18314 27 013220   000110 470400 0                  LDP0    TEMP$
        27 013221   000003 236100                    LDQ     3,,PR0
        27 013222   000000 116000 28                 CMPQ    0
        27 013223   013215 600000 27                 TZE     s:18311

     2563    18315   10                              END ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:428  

  18315 27 013224   000003 471500                    LDP1    3,,PR0
        27 013225   100000 220100                    LDX0    0,,PR1
        27 013226   000373 100003                    CMPX0   251,DU
        27 013227   013215 601000 27                 TNZ     s:18311
        27 013230   100002 221100                    LDX1    2,,PR1
        27 013231   000075 101003                    CMPX1   61,DU
        27 013232   013215 600000 27                 TZE     s:18311

     2564    18316    9                              COMCOM.CURRENT.LINE = TEMP$->ILS.ILL$->LINOI.LINE_NO ;

  18316 27 013233   100001 236100                    LDQ     1,,PR1
        27 013234   777777 376007                    ANQ     -1,DL
        27 013235   000133 756000 xsym               STQ     COMCOM+91

     2565    18317    9                              COMCOM.CURRENT.COLUMN = TEMP$->ILS.ILL$->LINOI.COLUMN_NO
             18317                                       ;

  18317 27 013236   000003 471500                    LDP1    3,,PR0
        27 013237   100001 236100                    LDQ     1,,PR1
        27 013240   000022 772000                    QRL     18
        27 013241   000134 756000 xsym               STQ     COMCOM+92

     2566    18318    9                            END ;

  18318 27 013242   013273 710000 27                 TRA     s:18335

     2567    18319    8                            ELSE
     2568    18320                                   %FIND_LAST_LINOI ;

  18322 27 013243   000001 236000 0                  LDQ     PREV_ILS$
        27 013244   000110 756000 0                  STQ     TEMP$

  18323 27 013245   000110 473400 0                  LDP3    TEMP$
        27 013246   300003 474500                    LDP4    3,,PR3
        27 013247   400000 221100                    LDX1    0,,PR4
        27 013250   000373 101003                    CMPX1   251,DU
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:429  
        27 013251   013262 600000 27                 TZE     s:18330

  18326 27 013252   000110 470400 0                  LDP0    TEMP$
        27 013253   000002 236100                    LDQ     2,,PR0
        27 013254   000110 756000 0                  STQ     TEMP$

  18329 27 013255   000110 470400 0                  LDP0    TEMP$
        27 013256   000003 471500                    LDP1    3,,PR0
        27 013257   100000 220100                    LDX0    0,,PR1
        27 013260   000373 100003                    CMPX0   251,DU
        27 013261   013252 601000 27                 TNZ     s:18326

  18330 27 013262   000110 470400 0                  LDP0    TEMP$
        27 013263   000003 471500                    LDP1    3,,PR0
        27 013264   100001 236100                    LDQ     1,,PR1
        27 013265   777777 376007                    ANQ     -1,DL
        27 013266   000133 756000 xsym               STQ     COMCOM+91

  18331 27 013267   000003 471500                    LDP1    3,,PR0
        27 013270   100001 236100                    LDQ     1,,PR1
        27 013271   000022 772000                    QRL     18
        27 013272   000134 756000 xsym               STQ     COMCOM+92

     2569    18334    8                          END ;

     2570    18335    7                          CALL Z8AE$ERROR (%E$DEAD_CODE) ;

  18335 27 013273   000054 630400 28                 EPPR0   44
        27 013274   000001 631400 28                 EPPR1   1
        27 013275   000000 701000 xent               TSX1    Z8AE$ERROR
        27 013276   000000 011000                    NOP     0

     2571    18336    7                        END ;

     2572    18337    6                        DEAD_CODE_CHECK = -1 ; /* Disable dead code message */

  18337 27 013277   000001 335007                    LCA     1,DL
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:430  
        27 013300   000076 755000 0                  STA     DEAD_CODE_CHECK

     2573    18338    7                        DO UNTIL SEARCH_ILS$ = ILL$->DO_N.ITE ; /*#40751*/

     2574    18339    7                          TEMP$ = SEARCH_ILS$ ;

  18339 27 013301   000077 236000 0                  LDQ     SEARCH_ILS$
        27 013302   000110 756000 0                  STQ     TEMP$

     2575    18340    8                          DO UNTIL SEARCH_ILS$->ILS.ILL$ ~= ADDR(NIL) ;

     2576    18341                                 %NEXT_ILS (POINTER=SEARCH_ILS$) ;

  18343 27 013303   000077 470400 0                  LDP0    SEARCH_ILS$
        27 013304   000002 236100                    LDQ     2,,PR0
        27 013305   000077 756000 0                  STQ     SEARCH_ILS$

     2577    18346    8                          END ;

  18346 27 013306   000077 470400 0                  LDP0    SEARCH_ILS$
        27 013307   000003 236100                    LDQ     3,,PR0
        27 013310   000000 116000 28                 CMPQ    0
        27 013311   013303 600000 27                 TZE     s:18343

     2578    18347    8                          DO CASE (TEMP$->ILS.ILL$->ILL.ID);

  18347 27 013312   000110 471400 0                  LDP1    TEMP$
        27 013313   100003 473500                    LDP3    3,,PR1
        27 013314   300000 236100                    LDQ     0,,PR3
        27 013315   000022 772000                    QRL     18
        27 013316   000336 136007                    SBLQ    222,DL
        27 013317   000111 116007                    CMPQ    73,DL
        27 013320   013322 602006 27                 TNC     s:18347+8,QL
        27 013321   013442 710000 27                 TRA     s:18355
        27 013322   013433 710000 27                 TRA     s:18349
        27 013323   013442 710000 27                 TRA     s:18355
        27 013324   013442 710000 27                 TRA     s:18355
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:431  
        27 013325   013442 710000 27                 TRA     s:18355
        27 013326   013442 710000 27                 TRA     s:18355
        27 013327   013433 710000 27                 TRA     s:18349
        27 013330   013442 710000 27                 TRA     s:18355
        27 013331   013442 710000 27                 TRA     s:18355
        27 013332   013442 710000 27                 TRA     s:18355
        27 013333   013442 710000 27                 TRA     s:18355
        27 013334   013442 710000 27                 TRA     s:18355
        27 013335   013442 710000 27                 TRA     s:18355
        27 013336   013442 710000 27                 TRA     s:18355
        27 013337   013442 710000 27                 TRA     s:18355
        27 013340   013442 710000 27                 TRA     s:18355
        27 013341   013442 710000 27                 TRA     s:18355
        27 013342   013442 710000 27                 TRA     s:18355
        27 013343   013442 710000 27                 TRA     s:18355
        27 013344   013442 710000 27                 TRA     s:18355
        27 013345   013442 710000 27                 TRA     s:18355
        27 013346   013442 710000 27                 TRA     s:18355
        27 013347   013442 710000 27                 TRA     s:18355
        27 013350   013442 710000 27                 TRA     s:18355
        27 013351   013442 710000 27                 TRA     s:18355
        27 013352   013442 710000 27                 TRA     s:18355
        27 013353   013442 710000 27                 TRA     s:18355
        27 013354   013442 710000 27                 TRA     s:18355
        27 013355   013442 710000 27                 TRA     s:18355
        27 013356   013442 710000 27                 TRA     s:18355
        27 013357   013442 710000 27                 TRA     s:18355
        27 013360   013442 710000 27                 TRA     s:18355
        27 013361   013442 710000 27                 TRA     s:18355
        27 013362   013442 710000 27                 TRA     s:18355
        27 013363   013442 710000 27                 TRA     s:18355
        27 013364   013442 710000 27                 TRA     s:18355
        27 013365   013442 710000 27                 TRA     s:18355
        27 013366   013442 710000 27                 TRA     s:18355
        27 013367   013442 710000 27                 TRA     s:18355
        27 013370   013442 710000 27                 TRA     s:18355
        27 013371   013442 710000 27                 TRA     s:18355
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:432  
        27 013372   013442 710000 27                 TRA     s:18355
        27 013373   013442 710000 27                 TRA     s:18355
        27 013374   013442 710000 27                 TRA     s:18355
        27 013375   013442 710000 27                 TRA     s:18355
        27 013376   013442 710000 27                 TRA     s:18355
        27 013377   013442 710000 27                 TRA     s:18355
        27 013400   013442 710000 27                 TRA     s:18355
        27 013401   013442 710000 27                 TRA     s:18355
        27 013402   013442 710000 27                 TRA     s:18355
        27 013403   013442 710000 27                 TRA     s:18355
        27 013404   013433 710000 27                 TRA     s:18349
        27 013405   013442 710000 27                 TRA     s:18355
        27 013406   013433 710000 27                 TRA     s:18349
        27 013407   013442 710000 27                 TRA     s:18355
        27 013410   013442 710000 27                 TRA     s:18355
        27 013411   013442 710000 27                 TRA     s:18355
        27 013412   013442 710000 27                 TRA     s:18355
        27 013413   013442 710000 27                 TRA     s:18355
        27 013414   013442 710000 27                 TRA     s:18355
        27 013415   013442 710000 27                 TRA     s:18355
        27 013416   013442 710000 27                 TRA     s:18355
        27 013417   013442 710000 27                 TRA     s:18355
        27 013420   013442 710000 27                 TRA     s:18355
        27 013421   013442 710000 27                 TRA     s:18355
        27 013422   013442 710000 27                 TRA     s:18355
        27 013423   013442 710000 27                 TRA     s:18355
        27 013424   013442 710000 27                 TRA     s:18355
        27 013425   013442 710000 27                 TRA     s:18355
        27 013426   013442 710000 27                 TRA     s:18355
        27 013427   013442 710000 27                 TRA     s:18355
        27 013430   013442 710000 27                 TRA     s:18355
        27 013431   013442 710000 27                 TRA     s:18355
        27 013432   013433 710000 27                 TRA     s:18349

     2579    18348    8                           CASE (%PREOFF, %PRESET, %P_A_PRESET, %P_P_PRESET, %PTR_SET)
             18348                                     ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:433  
     2580    18349    8                              TEMP$->ILS.SEQNO = CURRENT_SEQ_NO ;

  18349 27 013433   000052 720000 0                  LXL0    CURRENT_SEQ_NO
        27 013434   100000 440100                    SXL0    0,,PR1

     2581    18350    8                              CURRENT_SEQ_NO = CURRENT_SEQ_NO + 1 ;

  18350 27 013435   000052 054000 0                  AOS     CURRENT_SEQ_NO

     2582    18351    8                              TEMP$->ILS.NEXT = PREV_ILS$ ;

  18351 27 013436   000001 236000 0                  LDQ     PREV_ILS$
        27 013437   100002 756100                    STQ     2,,PR1

     2583    18352    8                              PREV_ILS$ = TEMP$ ;

  18352 27 013440   000110 236000 0                  LDQ     TEMP$
        27 013441   000001 756000 0                  STQ     PREV_ILS$

     2584    18353                                   /* Do not optimize out the above. */
     2585    18354    8                          END ; /* CASE */

     2586    18355    7                        END ; /* UNTIL */

  18355 27 013442   000000 474400 10                 LDP4    ILL$
        27 013443   000077 236000 0                  LDQ     SEARCH_ILS$
        27 013444   400001 116100                    CMPQ    1,,PR4
        27 013445   013301 601000 27                 TNZ     s:18339
        27 013446   013740 710000 27                 TRA     s:18501

     2587    18356                             /* Optimize out everything thru and including the DOEND,
     2588    18357                                except PREOFFs and such */
     2589    18358
     2590    18359    6                      CASE (%DOEND) ;

     2591    18360    7                        IF ILL$->DO_N.ITB->ILS.ILL$->DO_N.ID = %DO1 THEN DO ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:434  
  18360 27 013447   100001 473500                    LDP3    1,,PR1
        27 013450   300003 474500                    LDP4    3,,PR3
        27 013451   400000 220100                    LDX0    0,,PR4
        27 013452   000375 100003                    CMPX0   253,DU
        27 013453   013461 601000 27                 TNZ     s:18368

     2592    18361    7                          DOEND_FLAG = DEAD_CODE_CHECK ;

  18361 27 013454   000076 235000 0                  LDA     DEAD_CODE_CHECK
        27 013455   000106 755000 0                  STA     DOEND_FLAG

     2593    18362                               /* Do not delete the DOEND from a GO optimization,
     2594    18363                                  and restart the dead code search on the next
     2595    18364                                  ILL item. */
     2596    18365    7                          NEXT_ILS$ = SEARCH_ILS$ ;

  18365 27 013456   000077 236000 0                  LDQ     SEARCH_ILS$
        27 013457   000002 756000 0                  STQ     NEXT_ILS$

     2597    18366    7                        END ;

  18366 27 013460   013521 710000 27                 TRA     s:18387

     2598    18367    7                        ELSE DO ;

     2599    18368    8                          IF DEAD_CODE_CHECK = 0 THEN DO ;

  18368 27 013461   000076 235000 0                  LDA     DEAD_CODE_CHECK
        27 013462   013521 601000 27                 TNZ     s:18387

     2600    18369    8                            IF NOT LINOI_FLAG1 THEN

  18369 27 013463   000101 234000 0                  SZN     LINOI_FLAG1
        27 013464   013515 604000 27                 TMI     s:18384

     2601    18370                                   %FIND_LAST_LINOI ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:435  
  18372 27 013465   000001 236000 0                  LDQ     PREV_ILS$
        27 013466   000110 756000 0                  STQ     TEMP$

  18373 27 013467   000110 475400 0                  LDP5    TEMP$
        27 013470   500003 476500                    LDP6    3,,PR5
        27 013471   600000 221100                    LDX1    0,,PR6
        27 013472   000373 101003                    CMPX1   251,DU
        27 013473   013504 600000 27                 TZE     s:18380

  18376 27 013474   000110 470400 0                  LDP0    TEMP$
        27 013475   000002 236100                    LDQ     2,,PR0
        27 013476   000110 756000 0                  STQ     TEMP$

  18379 27 013477   000110 470400 0                  LDP0    TEMP$
        27 013500   000003 471500                    LDP1    3,,PR0
        27 013501   100000 220100                    LDX0    0,,PR1
        27 013502   000373 100003                    CMPX0   251,DU
        27 013503   013474 601000 27                 TNZ     s:18376

  18380 27 013504   000110 470400 0                  LDP0    TEMP$
        27 013505   000003 471500                    LDP1    3,,PR0
        27 013506   100001 236100                    LDQ     1,,PR1
        27 013507   777777 376007                    ANQ     -1,DL
        27 013510   000133 756000 xsym               STQ     COMCOM+91

  18381 27 013511   000003 471500                    LDP1    3,,PR0
        27 013512   100001 236100                    LDQ     1,,PR1
        27 013513   000022 772000                    QRL     18
        27 013514   000134 756000 xsym               STQ     COMCOM+92

     2602    18384    8                            CALL Z8AE$ERROR (%E$DEAD_CODE) ;

  18384 27 013515   000054 630400 28                 EPPR0   44
        27 013516   000001 631400 28                 EPPR1   1
        27 013517   000000 701000 xent               TSX1    Z8AE$ERROR
        27 013520   000000 011000                    NOP     0

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:436  
     2603    18385    8                          END ;

     2604    18386    7                        END ;

     2605    18387    6                        DEAD_CODE_CHECK = 1 ;

  18387 27 013521   000001 235007                    LDA     1,DL
        27 013522   000076 755000 0                  STA     DEAD_CODE_CHECK
        27 013523   013740 710000 27                 TRA     s:18501

     2606    18388                             /* End of dead code. Don't get rid of DOEND, lest
     2607    18389                                Phase 3 find an unmatched DO. */
     2608    18390
     2609    18391    6                      CASE (%SUB_END, %SUB_PREP) ;

     2610    18392                             /* End of optimized PERFORM cannot be reached. This is
     2611    18393                                perfectly legal though perhaps a trifle offbeat.
     2612    18394                                Delete the SUB_END without any warning message.
     2613    18395                                If SUB_PREP, it means it turns out after all that it
     2614    18396                                is not possible to fall thru into the body of an
     2615    18397                                optimized PERFORM. The SUB_PREP should be quietly
     2616    18398                                deleted. */
     2617    18399
     2618    18400    6                      CASE (%GO) ;

     2619    18401                             /* An ALTERed GO, if in the user program, is always
     2620    18402                                preceded by a referenced label. Therefore, it can
     2621    18403                                occur here only if it is compiler-created as the
     2622    18404                                exit from a COBOL-74 PERFORM. As with SUB_END,
     2623    18405                                delete it without message. A GO with any code other
     2624    18406                                than %GO_ALTERED is genuine dead code. */
     2625    18407    7                        IF ILL$->ILL.CODE ~= %GO_ALTERED THEN DO;

  18407 27 013524   100000 720100                    LXL0    0,,PR1
        27 013525   000020 100003                    CMPX0   16,DU
        27 013526   013740 600000 27                 TZE     s:18501

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:437  
     2626    18408    8                          IF DEAD_CODE_CHECK = 0 THEN DO ;

  18408 27 013527   000076 235000 0                  LDA     DEAD_CODE_CHECK
        27 013530   013740 601000 27                 TNZ     s:18501

     2627    18409    8                            IF NOT LINOI_FLAG1 THEN

  18409 27 013531   000101 234000 0                  SZN     LINOI_FLAG1
        27 013532   013563 604000 27                 TMI     s:18424

     2628    18410                                   %FIND_LAST_LINOI ;

  18412 27 013533   000001 236000 0                  LDQ     PREV_ILS$
        27 013534   000110 756000 0                  STQ     TEMP$

  18413 27 013535   000110 473400 0                  LDP3    TEMP$
        27 013536   300003 474500                    LDP4    3,,PR3
        27 013537   400000 221100                    LDX1    0,,PR4
        27 013540   000373 101003                    CMPX1   251,DU
        27 013541   013552 600000 27                 TZE     s:18420

  18416 27 013542   000110 470400 0                  LDP0    TEMP$
        27 013543   000002 236100                    LDQ     2,,PR0
        27 013544   000110 756000 0                  STQ     TEMP$

  18419 27 013545   000110 470400 0                  LDP0    TEMP$
        27 013546   000003 471500                    LDP1    3,,PR0
        27 013547   100000 220100                    LDX0    0,,PR1
        27 013550   000373 100003                    CMPX0   251,DU
        27 013551   013542 601000 27                 TNZ     s:18416

  18420 27 013552   000110 470400 0                  LDP0    TEMP$
        27 013553   000003 471500                    LDP1    3,,PR0
        27 013554   100001 236100                    LDQ     1,,PR1
        27 013555   777777 376007                    ANQ     -1,DL
        27 013556   000133 756000 xsym               STQ     COMCOM+91

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:438  
  18421 27 013557   000003 471500                    LDP1    3,,PR0
        27 013560   100001 236100                    LDQ     1,,PR1
        27 013561   000022 772000                    QRL     18
        27 013562   000134 756000 xsym               STQ     COMCOM+92

     2629    18424    8                            CALL Z8AE$ERROR (%E$DEAD_CODE) ;

  18424 27 013563   000054 630400 28                 EPPR0   44
        27 013564   000001 631400 28                 EPPR1   1
        27 013565   000000 701000 xent               TSX1    Z8AE$ERROR
        27 013566   000000 011000                    NOP     0

     2630    18425    8                          DEAD_CODE_CHECK = -1 ;

  18425 27 013567   000001 335007                    LCA     1,DL
        27 013570   000076 755000 0                  STA     DEAD_CODE_CHECK

     2631    18426    8                          END ;

     2632    18427    7                        END ;

  18427 27 013571   013740 710000 27                 TRA     s:18501

     2633    18428
     2634    18429    6                      CASE (%USE_ENTRY, %USE_END, %PREOFF, %PRESET, %P_A_PRESET,

     2635    18430    6                            %PTR_SET, %P_P_PRESET) ;
     2636    18431                             /* These items must never be optimized out. */
     2637    18432    6                        DOEND_FLAG = DEAD_CODE_CHECK ;

  18432 27 013572   000076 235000 0                  LDA     DEAD_CODE_CHECK
        27 013573   000106 755000 0                  STA     DOEND_FLAG

     2638    18433                             /* Handle like a DOEND matched with a DO1. */
     2639    18434    6                        NEXT_ILS$ = SEARCH_ILS$ ;

  18434 27 013574   000077 236000 0                  LDQ     SEARCH_ILS$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:439  
        27 013575   000002 756000 0                  STQ     NEXT_ILS$

     2640    18435    6                        DEAD_CODE_CHECK = 1 ;

  18435 27 013576   000001 235007                    LDA     1,DL
        27 013577   000076 755000 0                  STA     DEAD_CODE_CHECK
        27 013600   013740 710000 27                 TRA     s:18501

     2641    18436
     2642    18437    6                      CASE (%VAL_END) ;

     2643    18438    6                        IF ILL$->VAL_END.VAL$->ILS.SEQNO ~= 0 THEN

  18438 27 013601   100001 473500                    LDP3    1,,PR1
        27 013602   300000 720100                    LXL0    0,,PR3
        27 013603   013740 600000 27                 TZE     s:18501

     2644    18439    7                          DO ;

     2645    18440                                 /* Do not optimize this out, either. */
     2646    18441    7                            IF VAL_END$ = ADDR(NIL) THEN

  18441 27 013604   000031 236000 0                  LDQ     VAL_END$
        27 013605   000000 116000 28                 CMPQ    0
        27 013606   013611 601000 27                 TNZ     s:18443

     2647    18442    7                              VAL_END$ = ILL$ ;

  18442 27 013607   000000 236000 10                 LDQ     ILL$
        27 013610   000031 756000 0                  STQ     VAL_END$

     2648    18443    7                            DOEND_FLAG = DEAD_CODE_CHECK ;

  18443 27 013611   000076 235000 0                  LDA     DEAD_CODE_CHECK
        27 013612   000106 755000 0                  STA     DOEND_FLAG

     2649    18444    7                            NEXT_ILS$ = SEARCH_ILS$ ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:440  

  18444 27 013613   000077 236000 0                  LDQ     SEARCH_ILS$
        27 013614   000002 756000 0                  STQ     NEXT_ILS$

     2650    18445    7                            DEAD_CODE_CHECK = 1 ;

  18445 27 013615   000001 235007                    LDA     1,DL
        27 013616   000076 755000 0                  STA     DEAD_CODE_CHECK

     2651    18446    7                          END ;

  18446 27 013617   013740 710000 27                 TRA     s:18501

     2652    18447
     2653    18448    6                      CASE (%SCOPE) ;

     2654    18449    6                        NEXT_ILS$ = SEARCH_ILS$ ;

  18449 27 013620   000077 236000 0                  LDQ     SEARCH_ILS$
        27 013621   000002 756000 0                  STQ     NEXT_ILS$

     2655    18450    6                        DEAD_CODE_CHECK = 1 ;

  18450 27 013622   000001 235007                    LDA     1,DL
        27 013623   000076 755000 0                  STA     DEAD_CODE_CHECK
        27 013624   013740 710000 27                 TRA     s:18501

     2656    18451                             /* Dead code thru end of program */
     2657    18452
     2658    18453    6                      CASE (%END_PROG, %END) ;

     2659    18454    6                        DEAD_CODE_CHECK = 1 ;

  18454 27 013625   000001 235007                    LDA     1,DL
        27 013626   000076 755000 0                  STA     DEAD_CODE_CHECK
        27 013627   013740 710000 27                 TRA     s:18501

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:441  
     2660    18455                             /* Dead code thru end of program, don't scrap LINOI */
     2661    18456
     2662    18457    6                      CASE (%STOP,%EXIT_PROG) ;

     2663    18458    7                        IF ILL$->ILL.CODE ~= %EXIT_PROG_PHASE2_CREATED THEN DO ;

  18458 27 013630   100000 720100                    LXL0    0,,PR1
        27 013631   000001 100003                    CMPX0   1,DU
        27 013632   013740 600000 27                 TZE     s:18501

     2664    18459    8                          IF DEAD_CODE_CHECK = 0 THEN DO ;

  18459 27 013633   000076 235000 0                  LDA     DEAD_CODE_CHECK
        27 013634   013673 601000 27                 TNZ     s:18477

     2665    18460    8                            IF NOT LINOI_FLAG1 THEN

  18460 27 013635   000101 234000 0                  SZN     LINOI_FLAG1
        27 013636   013667 604000 27                 TMI     s:18475

     2666    18461                                   %FIND_LAST_LINOI ;

  18463 27 013637   000001 236000 0                  LDQ     PREV_ILS$
        27 013640   000110 756000 0                  STQ     TEMP$

  18464 27 013641   000110 473400 0                  LDP3    TEMP$
        27 013642   300003 474500                    LDP4    3,,PR3
        27 013643   400000 221100                    LDX1    0,,PR4
        27 013644   000373 101003                    CMPX1   251,DU
        27 013645   013656 600000 27                 TZE     s:18471

  18467 27 013646   000110 470400 0                  LDP0    TEMP$
        27 013647   000002 236100                    LDQ     2,,PR0
        27 013650   000110 756000 0                  STQ     TEMP$

  18470 27 013651   000110 470400 0                  LDP0    TEMP$
        27 013652   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:442  
        27 013653   100000 220100                    LDX0    0,,PR1
        27 013654   000373 100003                    CMPX0   251,DU
        27 013655   013646 601000 27                 TNZ     s:18467

  18471 27 013656   000110 470400 0                  LDP0    TEMP$
        27 013657   000003 471500                    LDP1    3,,PR0
        27 013660   100001 236100                    LDQ     1,,PR1
        27 013661   777777 376007                    ANQ     -1,DL
        27 013662   000133 756000 xsym               STQ     COMCOM+91

  18472 27 013663   000003 471500                    LDP1    3,,PR0
        27 013664   100001 236100                    LDQ     1,,PR1
        27 013665   000022 772000                    QRL     18
        27 013666   000134 756000 xsym               STQ     COMCOM+92

     2667    18475    8                            CALL Z8AE$ERROR (%E$DEAD_CODE) ;

  18475 27 013667   000054 630400 28                 EPPR0   44
        27 013670   000001 631400 28                 EPPR1   1
        27 013671   000000 701000 xent               TSX1    Z8AE$ERROR
        27 013672   000000 011000                    NOP     0

     2668    18476    8                          END ;

     2669    18477    7                          DEAD_CODE_CHECK = -1 ;

  18477 27 013673   000001 335007                    LCA     1,DL
        27 013674   000076 755000 0                  STA     DEAD_CODE_CHECK

     2670    18478    7                        END ;

  18478 27 013675   013740 710000 27                 TRA     s:18501

     2671    18479
     2672    18480    6                      CASE (ELSE) ;

     2673    18481    7                        IF DEAD_CODE_CHECK = 0 THEN DO ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:443  

  18481 27 013676   000076 235000 0                  LDA     DEAD_CODE_CHECK
        27 013677   013736 601000 27                 TNZ     s:18499

     2674    18482    7                          IF NOT LINOI_FLAG1 THEN

  18482 27 013700   000101 234000 0                  SZN     LINOI_FLAG1
        27 013701   013732 604000 27                 TMI     s:18497

     2675    18483                                 %FIND_LAST_LINOI ;

  18485 27 013702   000001 236000 0                  LDQ     PREV_ILS$
        27 013703   000110 756000 0                  STQ     TEMP$

  18486 27 013704   000110 473400 0                  LDP3    TEMP$
        27 013705   300003 474500                    LDP4    3,,PR3
        27 013706   400000 220100                    LDX0    0,,PR4
        27 013707   000373 100003                    CMPX0   251,DU
        27 013710   013721 600000 27                 TZE     s:18493

  18489 27 013711   000110 470400 0                  LDP0    TEMP$
        27 013712   000002 236100                    LDQ     2,,PR0
        27 013713   000110 756000 0                  STQ     TEMP$

  18492 27 013714   000110 470400 0                  LDP0    TEMP$
        27 013715   000003 471500                    LDP1    3,,PR0
        27 013716   100000 220100                    LDX0    0,,PR1
        27 013717   000373 100003                    CMPX0   251,DU
        27 013720   013711 601000 27                 TNZ     s:18489

  18493 27 013721   000110 470400 0                  LDP0    TEMP$
        27 013722   000003 471500                    LDP1    3,,PR0
        27 013723   100001 236100                    LDQ     1,,PR1
        27 013724   777777 376007                    ANQ     -1,DL
        27 013725   000133 756000 xsym               STQ     COMCOM+91

  18494 27 013726   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:444  
        27 013727   100001 236100                    LDQ     1,,PR1
        27 013730   000022 772000                    QRL     18
        27 013731   000134 756000 xsym               STQ     COMCOM+92

     2676    18497    7                          CALL Z8AE$ERROR (%E$DEAD_CODE) ;

  18497 27 013732   000054 630400 28                 EPPR0   44
        27 013733   000001 631400 28                 EPPR1   1
        27 013734   000000 701000 xent               TSX1    Z8AE$ERROR
        27 013735   000000 011000                    NOP     0

     2677    18498    7                        END ;

     2678    18499    6                        DEAD_CODE_CHECK = -1 ;

  18499 27 013736   000001 335007                    LCA     1,DL
        27 013737   000076 755000 0                  STA     DEAD_CODE_CHECK

     2679    18500    6                    END ; /* CASE (ILL$->ILL.ID) */

     2680    18501    5                  END ; /* UNTIL DEAD_CODE_CHECK > 0 */

  18501 27 013740   000076 235000 0                  LDA     DEAD_CODE_CHECK
        27 013741   012712 604400 27                 TMOZ    s:18219

     2681    18502    4                END ; /* SCRAP_DEAD_CODE */

     2682    18503    3            END ;

     2683    18504        %EJECT ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:445  
     2684    18505        /*V*
     2685    18506            ASSIGN_SEQ_NO -- Assign the sequence numbers for the ILS.
     2686    18507        */
     2687    18508
     2688    18509    2            IF ILS$->ILS.ILL$ ~= ADDR (NIL) AND

  18509 27 013742   000000 470400 6                  LDP0    ILS$
        27 013743   000003 236100                    LDQ     3,,PR0
        27 013744   000000 116000 28                 CMPQ    0
        27 013745   014122 600000 27                 TZE     s:18540
        27 013746   000003 471500                    LDP1    3,,PR0
        27 013747   100000 220100                    LDX0    0,,PR1
        27 013750   000373 100003                    CMPX0   251,DU
        27 013751   013755 601000 27                 TNZ     s:18513
        27 013752   100002 221100                    LDX1    2,,PR1
        27 013753   000076 101003                    CMPX1   62,DU
        27 013754   014122 600000 27                 TZE     s:18540

     2689    18510                   /* TRUE in all cases except SCOPE for inline subroutine */
     2690    18511    2                (ILS$->ILS.ILL$->ILL.ID ~= %LINOI OR
     2691    18512    2                 ILS$->ILS.ILL$->LINOI.TYPE ~= %S_TYPE_VALUE_IS) THEN
     2692    18513    3              DO CASE (ILS$->ILS.ILL$->ILL.ID) ;

  18513 27 013755   100000 236100                    LDQ     0,,PR1
        27 013756   000022 772000                    QRL     18
        27 013757   000336 136007                    SBLQ    222,DL
        27 013760   000111 116007                    CMPQ    73,DL
        27 013761   013763 602006 27                 TNC     s:18513+6,QL
        27 013762   014074 710000 27                 TRA     s:18524
        27 013763   014122 710000 27                 TRA     s:18540
        27 013764   014074 710000 27                 TRA     s:18524
        27 013765   014074 710000 27                 TRA     s:18524
        27 013766   014074 710000 27                 TRA     s:18524
        27 013767   014074 710000 27                 TRA     s:18524
        27 013770   014122 710000 27                 TRA     s:18540
        27 013771   014074 710000 27                 TRA     s:18524
        27 013772   014074 710000 27                 TRA     s:18524
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:446  
        27 013773   014074 710000 27                 TRA     s:18524
        27 013774   014074 710000 27                 TRA     s:18524
        27 013775   014074 710000 27                 TRA     s:18524
        27 013776   014074 710000 27                 TRA     s:18524
        27 013777   014074 710000 27                 TRA     s:18524
        27 014000   014074 710000 27                 TRA     s:18524
        27 014001   014074 710000 27                 TRA     s:18524
        27 014002   014074 710000 27                 TRA     s:18524
        27 014003   014074 710000 27                 TRA     s:18524
        27 014004   014074 710000 27                 TRA     s:18524
        27 014005   014074 710000 27                 TRA     s:18524
        27 014006   014074 710000 27                 TRA     s:18524
        27 014007   014074 710000 27                 TRA     s:18524
        27 014010   014074 710000 27                 TRA     s:18524
        27 014011   014074 710000 27                 TRA     s:18524
        27 014012   014074 710000 27                 TRA     s:18524
        27 014013   014074 710000 27                 TRA     s:18524
        27 014014   014074 710000 27                 TRA     s:18524
        27 014015   014074 710000 27                 TRA     s:18524
        27 014016   014074 710000 27                 TRA     s:18524
        27 014017   014074 710000 27                 TRA     s:18524
        27 014020   014074 710000 27                 TRA     s:18524
        27 014021   014074 710000 27                 TRA     s:18524
        27 014022   014074 710000 27                 TRA     s:18524
        27 014023   014074 710000 27                 TRA     s:18524
        27 014024   014074 710000 27                 TRA     s:18524
        27 014025   014074 710000 27                 TRA     s:18524
        27 014026   014074 710000 27                 TRA     s:18524
        27 014027   014074 710000 27                 TRA     s:18524
        27 014030   014074 710000 27                 TRA     s:18524
        27 014031   014074 710000 27                 TRA     s:18524
        27 014032   014074 710000 27                 TRA     s:18524
        27 014033   014074 710000 27                 TRA     s:18524
        27 014034   014074 710000 27                 TRA     s:18524
        27 014035   014074 710000 27                 TRA     s:18524
        27 014036   014074 710000 27                 TRA     s:18524
        27 014037   014074 710000 27                 TRA     s:18524
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:447  
        27 014040   014074 710000 27                 TRA     s:18524
        27 014041   014074 710000 27                 TRA     s:18524
        27 014042   014074 710000 27                 TRA     s:18524
        27 014043   014074 710000 27                 TRA     s:18524
        27 014044   014074 710000 27                 TRA     s:18524
        27 014045   014122 710000 27                 TRA     s:18540
        27 014046   014074 710000 27                 TRA     s:18524
        27 014047   014122 710000 27                 TRA     s:18540
        27 014050   014074 710000 27                 TRA     s:18524
        27 014051   014074 710000 27                 TRA     s:18524
        27 014052   014074 710000 27                 TRA     s:18524
        27 014053   014074 710000 27                 TRA     s:18524
        27 014054   014074 710000 27                 TRA     s:18524
        27 014055   014074 710000 27                 TRA     s:18524
        27 014056   014074 710000 27                 TRA     s:18524
        27 014057   014074 710000 27                 TRA     s:18524
        27 014060   014074 710000 27                 TRA     s:18524
        27 014061   014074 710000 27                 TRA     s:18524
        27 014062   014074 710000 27                 TRA     s:18524
        27 014063   014074 710000 27                 TRA     s:18524
        27 014064   014074 710000 27                 TRA     s:18524
        27 014065   014074 710000 27                 TRA     s:18524
        27 014066   014074 710000 27                 TRA     s:18524
        27 014067   014074 710000 27                 TRA     s:18524
        27 014070   014074 710000 27                 TRA     s:18524
        27 014071   014074 710000 27                 TRA     s:18524
        27 014072   014074 710000 27                 TRA     s:18524
        27 014073   014122 710000 27                 TRA     s:18540

     2693    18514    3                CASE (%PRESET, %PREOFF, %PTR_SET, %P_A_PRESET, %P_P_PRESET) ;

     2694    18515                       /* ILS.SEQNO not needed */
     2695    18516    3                CASE (ELSE) ;

     2696    18517                       %IF GCOS;
     2702    18523                       %ENDIF;
     2703    18524    3                  ILS$->ILS.SEQNO = CURRENT_SEQ_NO ;
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:448  

  18524 27 014074   000052 721000 0                  LXL1    CURRENT_SEQ_NO
        27 014075   000000 441100                    SXL1    0,,PR0

     2704    18525    3                  CURRENT_SEQ_NO = CURRENT_SEQ_NO + 1 ;

  18525 27 014076   000052 054000 0                  AOS     CURRENT_SEQ_NO

     2705    18526    3                  IF CURRENT_SEQ_NO = %MAX_SEQ# THEN

  18526 27 014077   000052 235000 0                  LDA     CURRENT_SEQ_NO
        27 014100   777777 115007                    CMPA    -1,DL
        27 014101   014106 601000 27                 TNZ     s:18528

     2706    18527    3                    CALL Z8AE$ERROR (%E$SEQ_NO_OVERFLOW) ;

  18527 27 014102   000056 630400 28                 EPPR0   46
        27 014103   000001 631400 28                 EPPR1   1
        27 014104   000000 701000 xent               TSX1    Z8AE$ERROR
        27 014105   000000 011000                    NOP     0

     2707    18528    3                  IF ILS$->ILS.ILL$->ILL.ID = %DEFLB AND

  18528 27 014106   000000 470400 6                  LDP0    ILS$
        27 014107   000003 471500                    LDP1    3,,PR0
        27 014110   100000 220100                    LDX0    0,,PR1
        27 014111   000346 100003                    CMPX0   230,DU
        27 014112   014122 601000 27                 TNZ     s:18540
        27 014113   100001 473500                    LDP3    1,,PR1
        27 014114   300003 234100                    SZN     3,,PR3
        27 014115   014122 605000 27                 TPL     s:18540

     2708    18529    4                      ILS$->ILS.ILL$->ILL.LOP->LABEL.B.REFERENCED THEN DO;

     2709    18530                         /* Labels need to be linked in reverse order for phase 3. */
     2710    18531    4                    ILS$->ILS.ILL$->ILL.LBL = COMCOM.H_LBL ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:449  
  18531 27 014116   000321 236000 xsym               LDQ     COMCOM+209
        27 014117   100002 756100                    STQ     2,,PR1

     2711    18532    4                    COMCOM.H_LBL = ILS$ ;

  18532 27 014120   000000 236000 6                  LDQ     ILS$
        27 014121   000321 756000 xsym               STQ     COMCOM+209

     2712    18533    4                  END ;

     2713    18534    3              END ; /* CASE */

     2714    18535
     2715    18536        /*V*
     2716    18537            RELINK_ILS -- Relink the ILS in reverse order for Phase 3.
     2717    18538        */
     2718    18539
     2719    18540    2            IF NEXT_ILS$ ~= ADDR(NIL) THEN

  18540 27 014122   000002 236000 0                  LDQ     NEXT_ILS$
        27 014123   000000 116000 28                 CMPQ    0
        27 014124   014144 600000 27                 TZE     s:18555

     2720    18541    2              IF NEXT_ILS$->ILS.ILL$ = ADDR(NIL) THEN

  18541 27 014125   000002 471400 0                  LDP1    NEXT_ILS$
        27 014126   100003 236100                    LDQ     3,,PR1
        27 014127   000000 116000 28                 CMPQ    0
        27 014130   014144 601000 27                 TNZ     s:18555

     2721    18542    3                DO ;

     2722    18543
     2723    18544    4                  DO WHILE NEXT_ILS$->ILS.ILL$ = ADDR(NIL) ;

  18544 27 014131   014135 710000 27                 TRA     s:18550

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:450  
     2724    18545                         %NEXT_ILS (POINTER=NEXT_ILS$) ;

  18547 27 014132   000002 470400 0                  LDP0    NEXT_ILS$
        27 014133   000002 236100                    LDQ     2,,PR0
        27 014134   000002 756000 0                  STQ     NEXT_ILS$

     2725    18550    4                  END ;

  18550 27 014135   000002 470400 0                  LDP0    NEXT_ILS$
        27 014136   000003 236100                    LDQ     3,,PR0
        27 014137   000000 116000 28                 CMPQ    0
        27 014140   014132 600000 27                 TZE     s:18547

     2726    18551
     2727    18552    3                  ILS$->ILS.NEXT = NEXT_ILS$ ;

  18552 27 014141   000002 236000 0                  LDQ     NEXT_ILS$
        27 014142   000000 471400 6                  LDP1    ILS$
        27 014143   100002 756100                    STQ     2,,PR1

     2728    18553    3                END ;

     2729    18554
     2730    18555    3            IF ILS$->ILS.ILL$ ~= ADDR(NIL) THEN DO ;

  18555 27 014144   000000 470400 6                  LDP0    ILS$
        27 014145   000003 236100                    LDQ     3,,PR0
        27 014146   000000 116000 28                 CMPQ    0
        27 014147   014154 600000 27                 TZE     s:18559

     2731    18556    3              ILS$->ILS.NEXT = PREV_ILS$ ;

  18556 27 014150   000001 236000 0                  LDQ     PREV_ILS$
        27 014151   000002 756100                    STQ     2,,PR0

     2732    18557    3              PREV_ILS$ = ILS$ ;

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:451  
  18557 27 014152   000000 236000 6                  LDQ     ILS$
        27 014153   000001 756000 0                  STQ     PREV_ILS$

     2733    18558    3            END ;

     2734    18559    2            ILS$ = NEXT_ILS$ ;

  18559 27 014154   000002 236000 0                  LDQ     NEXT_ILS$
        27 014155   000000 756000 6                  STQ     ILS$

     2735    18560
     2736    18561    2          END /* DO WHILE */ ;

  18561 27 014156   000000 236000 6                  LDQ     ILS$
        27 014157   000000 116000 28                 CMPQ    0
        27 014160   012175 601000 27                 TNZ     s:17978

     2737    18562        /*V*
     2738    18563            WRAPUP -- The pointer to the top of the ILS link is assigned.  This is
     2739    18564                      in actuality the pointer to the END item.
     2740    18565        */
     2741    18566
     2742    18567    1          COMCOM.FIRST_ILS = PREV_ILS$ ;

  18567 27 014161   000001 236000 0                  LDQ     PREV_ILS$
        27 014162   000010 756000 xsym               STQ     COMCOM+8

     2743    18568
     2744    18569    1     END Z8FF$FLOW_ANALYSIS ;

  18569 27 014163   000000 221200 0                  LDX1  ! 0
        27 014164   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:452  
--  Include file information  --

   Z8F_O2COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STATEMNT.:Z8A6TOU  is referenced.
   Z8A_LEX_SYMB.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_STACKS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8E_NEW_ILL.:Z8A6TOU  is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DPI.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z9A_SUPP_MAC.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8FF$FLOW_ANALYSIS.
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:453  

 **** Variables and constants ****

  ****  Section 000  Data  Z8FF$FLOW_ANALYSIS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   115-0-0/w PTR         r     1 @CALLEE$                 104-0-0/b BIT         r     1 AFTER_USE
   122-0-0/w PTR         r     1 ARG$                     123-0-0/w PTR         r     1 BASE$
    *0-0-0/w PTR         r     1 CALLEE$                   62-0-0/b BIT               1 CDEF_FLAG
    35-0-0/w PTR         r     1 CONST$                    20-0-0/w PTR         r     1 COPY_ILS$
    30-0-0/w PTR         r     1 CREATED_LABEL$           111-0-0/w PTR         r     1 CURRENT_PROC$
    54-0-0/w SBIN        r     1 CURRENT_SEG#              52-0-0/w SBIN        r     1 CURRENT_SEQ_NO
    76-0-0/w SBIN        r     1 DEAD_CODE_CHECK           57-0-0/b BIT         r     1 DEFLB_AFTER_ENTRY
    55-0-0/b BIT         r     1 DEFLB_FOLLOWS            106-0-0/w SBIN        r     1 DOEND_FLAG
    13-0-0/w PTR         r     1 DOEND_ILS$                22-0-0/w PTR         r     1 DO_ILS$
    51-0-0/w SBIN        r     1 DO_LEVEL                  23-0-0/w PTR         r     1 DO_LINOI$
    32-0-0/w PTR         r     1 DPI$$                      7-0-0/w PTR         r     1 END_LABEL$
    10-0-0/w PTR         r     1 END_LABEL_ILS$           100-0-0/w PTR         r     1 ENTADDR_OF_NIL$
   124-0-0/w PTR         r     1 ENTRY$                   107-0-0/w UBIN        r     1 ENTRY_TYPE
    33-0-0/w PTR         r     1 EXIT_PROG$                34-0-0/b BIT         r     1 EXIT_PROG_FOUND
    53-0-0/w SBIN        r     1 FALL_THRU_FLAG            24-0-0/w PTR         r     1 FATHER_DO
   117-0-0/w PTR         r     1 FATHER_PROC$              14-0-0/w PTR         r     1 GOTO_DEST$
    74-0-0/b BIT         r     1 GOTO_VECTOR               50-0-0/w SBIN        r     1 GO_FLAG
    15-0-0/w PTR         r     1 GO_ILS$                   27-0-0/w PTR         r     1 GO_LABEL_ILS$
    26-0-0/w PTR         r     1 GO_LABEL_LINOI$           61-0-0/w PTR         r     1 ILL$$
    46-0-0/w UBIN        r     1 ILL_ID                    60-0-0/w PTR         r     1 ILS$$
    16-0-0/w PTR         r     1 INITIAL_ILS$              56-0-0/w PTR         r     1 LABEL_AFTER_PFORM$
   105-0-0/w PTR         r     1 LABEL_AFTER_USE           30-0-0/w PTR         r     1 LABEL_CHECK$
   102-0-0/b BIT         r     1 LINOI_FLAG               101-0-0/b BIT         r     1 LINOI_FLAG1
   126-0-0/w UBIN        r     1 N                         21-0-0/w PTR         r     1 NEXT_COPY$
     2-0-0/w PTR         r     1 NEXT_ILS$                 11-0-0/w PTR         r     1 NEXT_LABEL$
    12-0-0/w PTR         r     1 NULL_PFORM_CHECK$         36-0-0/w PTR         r     1 OPERAND$
    37-0-0/w UBIN        r     1 OPERAND_TYPE              45-0-0/b BIT         r     1 OPTIMIZE_DO3
   127-0-0/b BIT         r     1 OPT_FLAG                 121-0-0/w PTR         r     1 PARAM$
   120-0-0/w PTR         r     1 PARAMLIST$                 3-0-0/w PTR         r     1 PERF_LABEL_CHECK
     4-0-0/w PTR         r     1 PERF_STATEMENT_CHECK       1-0-0/w PTR         r     1 PREV_ILS$
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:454  
   116-0-0/w PTR         r     1 PROC1$                    25-0-0/w PTR         r     1 REF_DEFLB
    17-0-0/w PTR         r     1 SEARCH_DO$               125-0-0/w PTR         r     1 SEARCH_ILL$
    77-0-0/w PTR         r     1 SEARCH_ILS$                5-0-0/w PTR         r     1 START_LABEL$
     6-0-0/w PTR         r     1 START_LABEL_ILS$          47-0-0/w SBIN        r     1 STATEMENT_COUNT
   110-0-0/w PTR         r     1 TEMP$                     64-0-0/d STRC(288)   r     1 TEMP_ILS_LIST
    41-0-0/w SBIN        r     1 TEMP_SBIN                 42-0-0/c CHAR(12)    r     1 TEMP_STR
    40-0-0/w UBIN        r     1 TEMP_UBIN                103-0-0/b BIT         r     1 USE_FLAG
    31-0-0/w PTR         r     1 VAL_END$                  75-0-0/w PTR         r     1 VECTOR_END$

  ****  Section 001 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 002 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 003 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 004 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:455  
  ****  Section 005 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 006 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 007 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ILS_

  ****  Section 008 LblCom DPI$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DPI$

  ****  Section 009 LblCom DPI_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DPI_

  ****  Section 010 LblCom ILL$

PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:456  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 011 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ILL_

  ****  Section 012 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 013 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HEAD_ETT$

  ****  Section 014 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 015 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:457  

     0-0-0/w STRC(180)   r     1 ETT_

  ****  Section 016 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 017 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 LTS_

  ****  Section 018 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 MKCN

  ****  Section 019 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 020 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ST_
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:458  

  ****  Section 021 LblCom LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)  r     1 LEX_SYMBOL                 0-0-0/w STRC(3240)        1 LEX_SYMBOL_WORDS

  ****  Section 022 LblCom CURRENT_LEX_SYMBOL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_LEX_SYMBOL$

  ****  Section 023 LblCom TEMP_LEX_SYMBOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL

  ****  Section 024 LblCom TEMP_LEX_SYMBOL2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3240)        1 TEMP_LEX_SYMBOL2

  ****  Section 025 LblCom O2COM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 O2COM

  ****  Section 026 RoData Z8FF$FLOW_ANALYSIS
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:459  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 ENTADDR_ENIL$              0-0-0/w UBIN        r     1 ENTADDR_OF_NIL_UBIN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM                     0-0-0/w UBIN        r     1 ILL_STEP(0:144)
     0-0-0/w UBIN        r     1 ILS_STEP_TABLE(0:2)
     0-0-0/w UBIN              1 LTS_STEP(0:37)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(288)         1 ADD_STMT
     0-0-0/w STRC(396)         1 ALPHABET                   0-0-0/w STRC(144)         1 ALTER_LTS
     0-0-0/w STRC(3672)        1 ALT_KEY                    0-0-0/w STRC(36864) r     1 ARGLIST
     0-0-0/w STRC(396)         1 ARRAY                      0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS
     0-0-0/w PTR         r     1 BASED$PTR$                 0-0-0/w ASTR(324)   r     1 BASED_LEX_SYMBOL
     0-0-0/w STRC(360)         1 BASED_LEX_SYMBOL_WORDS
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)         1 BINARY_ILL
     0-0-0/w STRC(288)         1 BINARY_OP                  0-0-0/w STRC(396)         1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(288)         1 CALL_STMT                  0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(288)         1 COMPUTE_STMT
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)   r     1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(288)         1 DEFERED_IDENTIFIER
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:460  
     0-0-0/w STRC(252)         1 DEFERED_ID_TREE            0-0-0/w STRC(288)         1 DEFERED_QUAL_ID
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE
     0-0-0/w STRC(288)         1 DEFERED_SUM_CLAUSE_LIST
     0-0-0/w STRC(144)   r     1 DEFLB                      0-0-0/w STRC(288)         1 DELETE_STMT
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(288)         1 DIVIDE_STMT                0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w ASTR(180)   r     1 DNT
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)   r     1 DO_N
     0-0-0/w STRC(108)   r     1 DPI                        0-0-0/w STRC(180)   r     1 DV4I
     0-0-0/w STRC(180)   r     1 ENTRY_ILL                  0-0-0/w STRC(180)   r     1 ETT
     0-0-0/w STRC(108)         1 EVALU                      0-0-0/w STRC(73836)       1 EVALUATE
     0-0-0/w STRC(396)         1 FD                         0-0-0/w STRC(1692)        1 FILE_LTS
     0-0-0/w STRC(144)   r     1 GO                         0-0-0/w STRC(180)   r     1 ILL
     0-0-0/w STRC              1 ILL_NO_OPS                 0-0-0/w STRC(180)   r     1 ILS
     0-0-0/w STRC(288)   r     1 ILS_LIST                   0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(288)         1 INSPECT_1_STMT
     0-0-0/w STRC(288)         1 INSPECT_2_STMT             0-0-0/w STRC(288)         1 INSPECT_4_STMT
     0-0-0/w STRC(396)   r     1 INTDEF                     0-0-0/w STRC(180)   r     1 IO_RESTORE_CHAIN
     0-0-0/w STRC(144)         1 KEY                        0-0-0/w STRC(396)   r     1 LABEL
     0-0-0/w STRC(288)         1 LA_ITEM                    0-0-0/w STRC(36864)       1 LCNST
     0-0-0/w STRC(108)   r     1 LINOI                      0-0-0/w STRC(72)          1 LONG
     0-0-0/w STRC              1 LTS                        0-0-0/w STRC(360)         1 LTSS
     0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY              0-0-0/w STRC(504)         1 LX_CD_INPUT
     0-0-0/w STRC(324)         1 LX_CD_I_O                  0-0-0/w STRC(396)         1 LX_CD_OUTPUT
     0-0-0/w STRC(288)         1 LX_ETT_ITEM                0-0-0/w STRC(288)         1 LX_ITEM
     0-0-0/w STRC(288)         1 LX_LARGE                   0-0-0/w STRC(288)         1 LX_LIST
     0-0-0/w STRC(1224)        1 LX_REC_DECL                0-0-0/w STRC(864)         1 LX_REPORT_REC
     0-0-0/w STRC(288)         1 LX_TERMINAL                0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(288)         1 MULTIPLY_STMT
     0-0-0/w STRC(180)         1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)         1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
     0-0-0/w STRC(144)         1 NEL                        0-0-0/w STRC(216)         1 OPEN_LTS
     0-0-0/w STRC(144)   r     1 OPN                        0-0-0/w STRC(180)         1 OS_CALL
     0-0-0/w STRC(36864)       1 PAGE                       0-0-0/w STRC(396)         1 PARA
     0-0-0/w STRC(216)   r     1 PFORM                      0-0-0/w STRC(144)         1 PINC
     0-0-0/w STRC(144)   r     1 PREOFF                     0-0-0/w STRC(108)   r     1 PRESET
     0-0-0/w STRC(144)         1 PRIME                      0-0-0/w STRC(396)   r     1 PROC_
PL6.E3A0      #001=Z8FF$FLOW_ANALYSIS File=Z8FF.:Z8A6TSI                         SAT 08/09/97 13:06 Page:461  
     0-0-0/w STRC(396)   r     1 PROC_DEF                   0-0-0/w STRC(900)   r     1 PROC_SUPP
     0-0-0/w STRC(144)         1 P_A_PRESET                 0-0-0/w STRC(144)         1 P_P_PRESET
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(288)         1 READ_STMT
     0-0-0/w STRC(216)         1 REF                        0-0-0/w STRC(144)         1 REMEM
     0-0-0/w STRC(108)         1 RENAMES                    0-0-0/w STRC(720)         1 REPORT_01_LTS
     0-0-0/w STRC(432)         1 REPORT_ELEM_LTS            0-0-0/w STRC(252)         1 REPORT_GRP_LTS
     0-0-0/w STRC(1332)        1 REPORT_LTS                 0-0-0/w STRC(288)         1 REWRITE_STMT
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(396)         1 SCALAR
     0-0-0/w STRC(144)   r     1 SCOPE                      0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(216)         1 SEARCH_                    0-0-0/w STRC(396)   r     1 SECTION
     0-0-0/w STRC(396)   r     1 SEGMENT                    0-0-0/w STRC(360)   r     1 SEGMENT_LTS
     0-0-0/w STRC(396)   r     1 ST                         0-0-0/w STRC(288)         1 START_STMT
     0-0-0/w STRC(72)          1 STP2                       0-0-0/w STRC(252)         1 STRING_STMT
     0-0-0/w STRC(288)         1 SUBTRACT_STMT              0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)         1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)         1 TEMP                       0-0-0/w STRC(144)         1 TRINARY_ILL
     0-0-0/w STRC(72)          1 UNARY_ILL                  0-0-0/w STRC(288)         1 UNARY_OP
     0-0-0/w STRC(288)         1 UNSTRING_STMT              0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(216)   r     1 USER_CALL                  0-0-0/w STRC(252)         1 USE_SUPP
     0-0-0/w STRC(108)         1 VAL                        0-0-0/w STRC(108)   r     1 VAL_END
     0-0-0/w STRC(396)   r     1 VARIABLE                   0-0-0/w STRC(72)          1 WHEN
     0-0-0/w STRC(288)         1 WRITE_STMT


   Procedure Z8FF$FLOW_ANALYSIS requires 6261 words for executable code.
   Procedure Z8FF$FLOW_ANALYSIS is declared NOAUTO and requires 96 words of local(STATIC) storage.

    No errors detected in file Z8FF.:Z8A6TSI    .
