000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. CP6-ACCOUNTING.
000040 DATE-WRITTEN. JANUARY 1977.
000050 DATE-COMPILED. TODAY.
000060*REMARKS.
000070*    THIS PROGRAM IS USED TO PRODUCE DAILY MONTHLY AND
000080*    WEEKLY ACCOUNT REPORTS BASED ON THE JOBS( ONLINE AND
000090*    BATCH) RUN.  THERE ARE THREE (3) PRIMARY REPORT FORMS
000100*    (1) SUMMARY OF EACH ACCOUNT/NAME WITHIN A DEPARTMENT
000110*        SPECIFIED BY THE COST CENTER TABLE AND A TOTAL OF
000120*        THE DEPARTMENT USAGE.
000130*    (2) SUMMARY LISTING OF EACH DEPARTMENT TOTAL BROKEN
000140*        DOWN BY BATCH/TS (CPU,ELAP,AND PERCENTAGES) ALSO
000150*        CONTAINS THE OVERALL SYSTEM USAGE FIGURES FOR THE
000160*        SELECTED TIME PERIOD.
000170*    (3) A DETAIL LISTING/SUMMARY OF SELECTED ACCOUNTS
000180*        WITH * ALL * JOBS RUN IN THAT ACCOUNT FOR THE
000190*        SPECIFIED TIME. (OPTION: A LISTING/SUMMARY OF
000200*        * ALL * JOBS RUN IN ALL ACCOUNTS IS POSSIBLE
000210*        BUT DUE TO THE VOLUME OF OUTPUT IT SHOULD BE
000220*        USED ONLY ON VERY SPECIAL OCCASIONS IF THE TIME
000230*        PERIOD IS LONGER THAN ONE 24 HOUR PERIOD.
000240*    INPUT FOR THIS PROGRAM IS THE ACCOUNTING RECORD
000250*    PRODUCED BY THE MONITOR AND KEPT IN THE :ACCTLG
000260*    FILE IN :SYS.  THIS FILE IS DAILY MERGED WITH
000270*    THE TACCTLG FILE IN "ACCOUNT,USM" TO PRODUCE A
000280*    SUMMARY ACCOUNTING FILE. :ACCTLG IS THEN DELETED FOR
000290*    THE NEXT DAYS RUNS.  TO INCREASE THE SPEED OF THIS
000300*    PROGRAM, THE TACCTLG FILE SHOULD BE SORTED BY ACCOUNT
000310*    AND NAME PRIOR TO EXECUTION.  THE JCL FILE "SORTMONTH"
000320*    IN "ACCOUNT,USM" DOES THIS.  THUS, THE SORTED FILE
000330*     WILL BE IN "SORTED-FIL" IN ACCOUNT "ACCOUNT"
000340*    THE OUTPUT WILL BE IN FILES "FL1","FL2","FL3"
000350*    FOR THE RESPECTIVE REPORTS. VARIOUS TEMP FILES ARE
000360*    USED FOR SORTS AND SUCH BUT ARE RELEASED ON COMPLETION
000370*    PLEASE NOTE THAT THE SIZE OF TACCTLG AND SORTED-FIL ARE
000380*    EQUAL AND THEY CAN GROW TO HORRENDOUS SIZE OVER THE
000390*    MONTHS TIME.
000400*    NOTE ALSO THAT THESE FILES ARE CREATED AND MAINTAINED
000410*    BY PROGRAMS OTHER THAN THIS ONE.  NO DELETING OR
000420*    UPDATING IS DONE BY SIGMA9-ACCOUNTING.
000430 ENVIRONMENT DIVISION.
000440 CONFIGURATION SECTION.
000450 SOURCE-COMPUTER. LEVEL-66-ASCII.
000460 OBJECT-COMPUTER. LEVEL-66-ASCII.
000470 SPECIAL-NAMES.
000480     PAGE IS TOP-OF-PAGE
000490     SYSOUT IS PRINTER
000500     .
000510 INPUT-OUTPUT SECTION.
000520 FILE-CONTROL.
000530     SELECT ACCTLG
000540        ASSIGN TO DISC.
           SELECT GACFILE ASSIGN TO DISC.
           SELECT TEMPGACFILE ASSIGN TO DISC.
           SELECT NEWGACFILE ASSIGN TO DISC.
000550     SELECT SORT1FILE ASSIGN TO DISK.
000560     SELECT SORT2FILE ASSIGN TO DISK.
000570     SELECT JOBSRUN
000580        ASSIGN TO DISC.
000590     SELECT PHASEA
000600        ASSIGN TO DISC.
000610     SELECT PHASEB
000620        ASSIGN TO DISC.
000630     SELECT PRINTR
000640        ASSIGN TO PRINTER.
000650     SELECT PRINTR1
000660        ASSIGN TO PRINTER.
000670     SELECT PRINTR2
000680        ASSIGN TO PRINTER.
000690     SELECT DATER
000700        ASSIGN TO CARD-READER.
000710 DATA DIVISION.
000720 FILE SECTION.
       SD GACFILE.
       01 GACREC.
           02 GACCODE PIC X.
           02 FILLER PIC X.
           02 GACID PIC XX.
           02 GACACCT PIC X(8).
           02 SHELF-GRAN.
              03 BACK COMP-6.
              03 NOBACK COMP-6.
              03 STOW COMP-6.
           02 ONLINE-GRAN.
              03 BACK COMP-6.
              03 NOBACK COMP-6.
              03 STOW COMP-6.
       FD  TEMPGACFILE
           LABEL RECORDS ARE STANDARD
           DATA
           RECORD TEMPGACREC.
       01  TEMPGACREC.
           02 TEMPGACCODE PIC X.
           02 FILLER PIC X.
           02 TEMPGACID PIC XX.
           02 TEMPGACACCT PIC X(8).
           02 SHELF-GRAN.
               03 BACK COMP-6.
               03 NOBACK COMP-6.
               03 STOW COMP-6.
           02 ONLINE-GRAN.
               03 BACK COMP-6.
               03 NOBACK COMP-6.
               03 STOW COMP-6.
       FD  NEWGACFILE
           LABEL RECORDS ARE STANDARD
           DATA
           RECORD NEWGACREC.
       01  NEWGACREC.
           02 NEWGACCODE PIC X.
           02 FILLER PIC X.
           02 NEWGACID PIC XX.
           02 NEWGACACCT PIC X(8).
           02 SHELF-GRAN.
               03 BACK COMP-6.
               03 NOBACK COMP-6.
               03 STOW COMP-6.
           02 ONLINE-GRAN.
               03 BACK COMP-6.
               03 NOBACK COMP-6.
               03 STOW COMP-6.
000730 FD DATER
000740     LABEL RECORDS ARE OMITTED
000750     DATA
000760     RECORD DATE-CONTROL DATE-LABEL ACCOUNT-RECORD
000770     RATE-RECORD COMMAND-RECORD.
000780 01   COMMAND-RECORD.
000790      02  COMMAND-PLUS                 PIC X(5).
000800      02  FILLER             PIC X(75).
000810 01   DATE-LABEL.
000820      02  HEADING-DATE-START      PIC X(8).
000830      02  FILLER                  PIC XX.
000840      02  HEADING-DATE-END        PIC X(8).
000850      02  FILLER                  PIC X(62).
000860 01 DATE-CONTROL.
000870     02 JSTART-YEAR PIC 99.
000880     02 JSTART-DAY PIC 999.
000890     02 JEND-YEAR PIC 99.
000900     02 JEND-DAY PIC 999.
000910     02 JMONTH-TGD   PIC X(70).
000920 01  ACCOUNT-RECORD.
000930     02  AKOUNT              PIC X(8).
000940     02  FILLER              PIC X(72).
000950  01  RATE-RECORD.
000960     02 RES-MIN-DP-RATE        PIC 9V9999.
000990     02  FILLER              PIC X.
001000     02 PAGES-PRINTED-RATE   PIC 9V9999.
001010     02  FILLER              PIC X.
001020     02 IO-ACCESS-RATE       PIC 9V9999.
001030     02  FILLER              PIC X.
001040     02 CPU-TIME-RATE        PIC 999V99.
001050     02  FILLER              PIC X.
001060     02 ELAPSED-TIME-RATE    PIC 999V99.
001070     02  FILLER              PIC X.
001080     02 MEDIA-MOUNT-RATE      PIC 99V99.
001090 FD  JOBSRUN
001100     LABEL RECORDS STANDARD
001110     DATA
001120     RECORD IS JOBOUT.
001130 01  JOBOUT.
002240     02 OUTPUT-ACCTLG.
              10 ZCODE      PIC X.
              10 BATCH-FLAG  PIC X.
              10 ZFILLER    PIC XX.
              10 ZACCT      PIC X(8).
              10 ZUSERNAME  PIC X(12).
              10 FILLER     PIC X.
              10 ZJOBNAME   PIC X(31).
      *       10 ZJOBNAME   PIC X(8).
              10 ZWOO       PIC X(8).
              10 ZATITLE    PIC X(32).
              10 ZSUBMIT    COMP-6.
              10 ZSTART     COMP-6.
              10 ZELAPSED   COMP-6.
              10 ZHOLD-UTS  COMP-6.
              10 ZCUR-UTS   COMP-6.
              10 ZPRIO      PIC X.
              10 ZPART     PIC X.
              10 ZPART-MASK PIC XX.
              10 ZMODE      PIC X.
              10 ZTYPE      PIC X.
              10 ZSYSID     PIC XX.
              10 ZPROCNAME.
                 15 ZL      PIC X.
                 15 ZC      PIC X(31).
              10 ZRATETABLE.
                 15 ZL      PIC X.
                 15 ZC      PIC X(10).
              10 ZPRATETBLE.
                 15 ZL      PIC X.
                 15 ZC      PIC X(10).
              10 FILLER     PIC XX.
              10 ZRESPEAK   PIC XX.
              10 ZPKCO      PIC XX.
              10 ZSTEP      PIC XX.
              10 ZJORG      PIC XX.
              10 ZSTEPCC    PIC X.
              10 ZRNST      PIC X.
              10 ZXLIMFLG   PIC X.
              10 ZFILLER    PIC X.
              10 ZTSLINE.
                 15 ZFEX    PIC X.
                 15 ZSPEED  PIC X.
                 15 ZPORT   PIC XX.
                 15 FILLER   PIC X(8).
              10 ZTMDPPK    COMP-6.
              10 ZPRDPUSED  COMP-6.
              10 ZCHG       COMP-6.
              10 ZPCHG      COMP-6.
              10 ZUFTPS     COMP-6.
              10 ZPMEMTIM   COMP-6.
              10 ZUMEMTIM   COMP-6.
              10 ZMTTIM-CLK COMP-6.
              10 ZDPTIM-CLK COMP-6.
              10 ZORTIM-CLK COMP-6.
              10 ZMTTIM-CPU COMP-6.
              10 ZDPTIM-CPU COMP-6.
              10 ZORTIM-CPU COMP-6.
              10 ZCONNECT   COMP-6.
              10 ZMTACCESS  COMP-6.
              10 ZDPACCESS  COMP-6.
              10 ZORACCESS  COMP-6.
              10 ZMTMOUNT   COMP-6.
              10 ZDPMOUNT   COMP-6.
              10 ZORMOUNT   COMP-6.
              10 ZTINTER    COMP-6.
              10 ZPMMES     COMP-6.
              10 ZPEXEC     COMP-6.
              10 ZUEXEC     COMP-6.
              10 ZPSTIME    COMP-6.
              10 ZUSTIME    COMP-6.
              10 ZJSUNITS OCCURS 4 TIMES PIC XX.
              10 ZSUNIT-CHG OCCURS 4 TIMES COMP-6.
              10 ZINST OCCURS 8 TIMES COMP-6.
              10 ZSUDOX     COMP-6.
              10 ZSUDO-CNT  COMP-6.
              10 ZRESX      COMP-6.
              10 ZRES-CNT   COMP-6.
              10 ZFORMX     COMP-6.
              10 ZFORM-CNT  COMP-6.
002950     02 FILLER PIC X(4007).
001320 FD  PRINTR1
001330     LABEL RECORDS OMITTED
001340     DATA
001350     RECORD IS LINE-OUT.
001360 01  LINE-OUT.
001370     02 CARRIAGE-CONTROL-BYTE PIC X.
001380     02 FILLER               PIC X(58).
001390     02 ACCT-END             PIC X(13).
001400     02 FILLER               PIC X(70).
001410 FD  PRINTR2
001420     LABEL RECORDS OMITTED
001430     REPORTS DEPT-SUMMARY.
001440 FD  ACCTLG
001450     LABEL RECORDS ARE STANDARD
001460     DATA
001470     RECORD IS INPUT-ACCTLG PGRAN-REC GACID-REC.
001480 01  INPUT-ACCTLG.
001490     02 READ-INPUT-ACCTLG.
              10 ZCODE      PIC X.
              10 ZFILLER    PIC XXX.
              10 ZACCT      PIC X(8).
              10 ZUSERNAME  PIC X(12).
              10 FILLER     PIC X.
              10 ZJOBNAME   PIC X(31).
      *       10 ZJOBNAME   PIC X(8).
              10 ZWOO       PIC X(8).
              10 ZATITLE    PIC X(32).
              10 ZSUBMIT    COMP-6.
              10 ZSTART     COMP-6.
              10 ZELAPSED   COMP-6.
              10 ZHOLD-UTS  COMP-6.
              10 ZCUR-UTS   COMP-6.
              10 ZPRIO      PIC X.
              10 ZPART     PIC X.
              10 ZPART-MASK PIC XX.
              10 ZMODE      PIC X.
              10 ZTYPE      PIC X.
              10 ZSYSID     PIC XX.
              10 ZPROCNAME.
                 15 ZL      PIC X.
                 15 ZC      PIC X(31).
              10 ZRATETABLE.
                 15 ZL      PIC X.
                 15 ZC      PIC X(10).
              10 ZPRATETBLE.
                 15 ZL      PIC X.
                 15 ZC      PIC X(10).
              10 FILLER     PIC XX.
              10 ZRESPEAK   PIC XX.
              10 ZPKCO      PIC XX.
              10 ZSTEP      PIC XX.
              10 ZJORG      PIC XX.
              10 ZSTEPCC    PIC X.
              10 ZRNST      PIC X.
              10 ZXLIMFLG   PIC X.
              10 ZFILLER    PIC X.
              10 ZTSLINE.
                 15 ZFEX    PIC X.
                 15 ZSPEED  PIC X.
                 15 ZPORT   PIC XX.
                 15 FILLER   PIC X(8).
              10 ZTMDPPK    COMP-6.
              10 ZPRDPUSED  COMP-6.
              10 ZCHG       COMP-6.
              10 ZPCHG      COMP-6.
              10 ZUFTPS     COMP-6.
              10 ZPMEMTIM   COMP-6.
              10 ZUMEMTIM   COMP-6.
              10 ZMTTIM-CLK COMP-6.
              10 ZDPTIM-CLK COMP-6.
              10 ZORTIM-CLK COMP-6.
              10 ZMTTIM-CPU COMP-6.
              10 ZDPTIM-CPU COMP-6.
              10 ZORTIM-CPU COMP-6.
              10 ZCONNECT   COMP-6.
              10 ZMTACCESS  COMP-6.
              10 ZDPACCESS  COMP-6.
              10 ZORACCESS  COMP-6.
              10 ZMTMOUNT   COMP-6.
              10 ZDPMOUNT   COMP-6.
              10 ZORMOUNT   COMP-6.
              10 ZTINTER    COMP-6.
              10 ZPMMES     COMP-6.
              10 ZPEXEC     COMP-6.
              10 ZUEXEC     COMP-6.
              10 ZPSTIME    COMP-6.
              10 ZUSTIME    COMP-6.
              10 ZJSUNITS OCCURS 4 TIMES PIC XX.
              10 ZSUNIT-CHG OCCURS 4 TIMES COMP-6.
              10 ZINST OCCURS 8 TIMES COMP-6.
              10 ZSUDOX     COMP-6.
              10 ZSUDO-CNT  COMP-6.
              10 ZRESX      COMP-6.
              10 ZRES-CNT   COMP-6.
              10 ZFORMX     COMP-6.
              10 ZFORM-CNT  COMP-6.
002950     02 FILLER PIC X(4007).
       01  PGRAN-REC.
           02 CODE-P PIC X.
           02 FILLER PIC X.
           02 SYSID-P PIC XX.
           02 FILLER PIC X(20).
           02 ACCT-P PIC X(8).
           02 SHELF-GRAN.
              03 BACK COMP-6.
              03 NOBACK COMP-6.
              03 STOW COMP-6.
           02 ONLINE-GRAN.
              03 BACK COMP-6.
              03 NOBACK COMP-6.
              03 STOW COMP-6.
       01 GACID-REC.
           02 CODE-G PIC X.
           02 FLAG-G PIC X.
           02 SYSID-G PIC XX.
002200 SD  SORT1FILE
002210     DATA
002220     RECORD SORT1REC.
       01 DUMMY-4080-BYTE-REC    PIC X(4080).
002230 01 SORT1REC.
002240     02 SORT-RAW-ACCTLG.
              10 ZCODE      PIC X.
              10 BATCH-FLAG  PIC X.
              10 ZFILLER    PIC XX.
              10 ZACCT      PIC X(8).
              10 ZUSERNAME  PIC X(12).
              10 FILLER     PIC X.
              10 ZJOBNAME   PIC X(31).
      *       10 ZJOBNAME   PIC X(8).
              10 ZWOO       PIC X(8).
              10 ZATITLE    PIC X(32).
              10 ZSUBMIT    COMP-6.
              10 ZSTART     COMP-6.
              10 ZELAPSED   COMP-6.
              10 ZHOLD-UTS  COMP-6.
              10 ZCUR-UTS   COMP-6.
              10 ZPRIO      PIC X.
              10 ZPART     PIC X.
              10 ZPART-MASK PIC XX.
              10 ZMODE      PIC X.
              10 ZTYPE      PIC X.
              10 ZSYSID     PIC XX.
              10 ZPROCNAME.
                 15 ZL      PIC X.
                 15 ZC      PIC X(31).
              10 ZRATETABLE.
                 15 ZL      PIC X.
                 15 ZC      PIC X(10).
              10 ZPRATETBLE.
                 15 ZL      PIC X.
                 15 ZC      PIC X(10).
              10 FILLER     PIC XX.
              10 ZRESPEAK   PIC XX.
              10 ZPKCO      PIC XX.
              10 ZSTEP      PIC XX.
              10 ZJORG      PIC XX.
              10 ZSTEPCC    PIC X.
              10 ZRNST      PIC X.
              10 ZXLIMFLG   PIC X.
              10 ZFILLER    PIC X.
              10 ZTSLINE.
                 15 ZFEX    PIC X.
                 15 ZSPEED  PIC X.
                 15 ZPORT   PIC XX.
                 15 FILLER   PIC X(8).
              10 ZTMDPPK    COMP-6.
              10 ZPRDPUSED  COMP-6.
              10 ZCHG       COMP-6.
              10 ZPCHG      COMP-6.
              10 ZUFTPS     COMP-6.
              10 ZPMEMTIM   COMP-6.
              10 ZUMEMTIM   COMP-6.
              10 ZMTTIM-CLK COMP-6.
              10 ZDPTIM-CLK COMP-6.
              10 ZORTIM-CLK COMP-6.
              10 ZMTTIM-CPU COMP-6.
              10 ZDPTIM-CPU COMP-6.
              10 ZORTIM-CPU COMP-6.
              10 ZCONNECT   COMP-6.
              10 ZMTACCESS  COMP-6.
              10 ZDPACCESS  COMP-6.
              10 ZORACCESS  COMP-6.
              10 ZMTMOUNT   COMP-6.
              10 ZDPMOUNT   COMP-6.
              10 ZORMOUNT   COMP-6.
              10 ZTINTER    COMP-6.
              10 ZPMMES     COMP-6.
              10 ZPEXEC     COMP-6.
              10 ZUEXEC     COMP-6.
              10 ZPSTIME    COMP-6.
              10 ZUSTIME    COMP-6.
              10 ZJSUNITS OCCURS 4 TIMES PIC XX.
              10 ZSUNIT-CHG OCCURS 4 TIMES COMP-6.
              10 ZINST OCCURS 8 TIMES COMP-6.
              10 ZSUDOX     COMP-6.
              10 ZSUDO-CNT  COMP-6.
              10 ZRESX      COMP-6.
              10 ZRES-CNT   COMP-6.
              10 ZFORMX     COMP-6.
              10 ZFORM-CNT  COMP-6.
002950     02 FILLER PIC X(4007).
002960 FD  PHASEA
002970     LABEL RECORDS ARE STANDARD
002980     DATA
002990     RECORD PHASEAREC.
003000 01 PHASEAREC.
003010     02 DEPART-TITLE PIC X(36).
003020     02 ACCOUNT PIC X(8).
003030        02 USER-NAME.
003060            03 USER-COST-CENTER   PIC X(3).
                  03 USER-INITIALS PIC X(9).
003070     02 ACCT-TOTALS.
003080        03 ONLINE-SUMS.
003090           04 KOUNT USAGE COMP-6.
003100           04 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003110           04 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
003120           04 LINES-OUT PIC S9(15) USAGE COMP-3.
003130           04 CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
003140           04 ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
003150           04 IO-ACCESS PIC S9(15) USAGE COMP-3.
003160           04 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
003170           04 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
                 04 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
                 04 CARDS-OUT PIC S9(15) USAGE COMP-3.
                 04 TERM-INT PIC S9(15) USAGE COMP-3.
                 04 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003180        03 BATCH-SUMS.
003190           04 KOUNT USAGE COMP-6.
003200           04 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003210           04 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
003220           04 LINES-OUT PIC S9(15) USAGE COMP-3.
003230           04 CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
003240           04 ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
003250           04 IO-ACCESS PIC S9(15) USAGE COMP-3.
003260           04 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
003270           04 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
                 04 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
                 04 CARDS-OUT PIC S9(15) USAGE COMP-3.
                 04 TERM-INT PIC S9(15) USAGE COMP-3.
                 04 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003180        03 GHOST-SUMS.
003190           04 KOUNT USAGE COMP-6.
003200           04 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003210           04 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
003220           04 LINES-OUT PIC S9(15) USAGE COMP-3.
003230           04 CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
003240           04 ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
003250           04 IO-ACCESS PIC S9(15) USAGE COMP-3.
003260           04 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
003270           04 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
                 04 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
                 04 CARDS-OUT PIC S9(15) USAGE COMP-3.
                 04 TERM-INT PIC S9(15) USAGE COMP-3.
                 04 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003180        03 TP-SUMS.
003190           04 KOUNT USAGE COMP-6.
003200           04 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003210           04 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
003220           04 LINES-OUT PIC S9(15) USAGE COMP-3.
003230           04 CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
003240           04 ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
003250           04 IO-ACCESS PIC S9(15) USAGE COMP-3.
003260           04 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
003270           04 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
                 04 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
                 04 CARDS-OUT PIC S9(15) USAGE COMP-3.
                 04 TERM-INT PIC S9(15) USAGE COMP-3.
                 04 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003280        03 TOTAL-SUMS.
003290           04 KOUNT USAGE COMP-6.
003300           04 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003310           04 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
003320           04 LINES-OUT PIC S9(15) USAGE COMP-3.
003330           04 CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
003340           04 ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
003350           04 IO-ACCESS PIC S9(15) USAGE COMP-3.
003360           04 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
003370           04 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
                 04 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
                 04 CARDS-OUT PIC S9(15) USAGE COMP-3.
                 04 TERM-INT PIC S9(15) USAGE COMP-3.
                 04 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003380 SD  SORT2FILE
003390     DATA
003400     RECORD SORT2REC.
003410 01 SORT2REC.
003420     02 DEPART-TITLE PIC X(36).
003430     02 ACCOUNT PIC X(8).
003440     02 USER-NAME       PIC X(12).
003450     02  ONLINE-SUMS.
003460         03 KOUNT USAGE COMP-6.
003470         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003480         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
003490         03 LINES-OUT PIC S9(15) USAGE COMP-3.
003500         03   CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
003510         03   ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
003520         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
003530         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
003540         03 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003550     02  BATCH-SUMS.
003560         03 KOUNT USAGE COMP-6.
003570         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003580         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
003590         03 LINES-OUT PIC S9(15) USAGE COMP-3.
003600         03   CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
003610         03   ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
003620         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
003630         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
003640         03 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003550     02  GHOST-SUMS.
003560         03 KOUNT USAGE COMP-6.
003570         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003580         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
003590         03 LINES-OUT PIC S9(15) USAGE COMP-3.
003600         03   CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
003610         03   ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
003620         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
003630         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
003640         03 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003550     02  TP-SUMS.
003560         03 KOUNT USAGE COMP-6.
003570         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003580         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
003590         03 LINES-OUT PIC S9(15) USAGE COMP-3.
003600         03   CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
003610         03   ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
003620         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
003630         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
003640         03 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003650     02  TOTAL-SUMS.
003660         03 KOUNT USAGE COMP-6.
003670         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003680         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
003690         03 LINES-OUT PIC S9(15) USAGE COMP-3.
003700         03   CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
003710         03   ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
003720         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
003730         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
003740         03 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003750 FD  PHASEB
003760     LABEL RECORDS ARE STANDARD
003770     DATA
003780     RECORD PHASEBREC.
003790 01 PHASEBREC.
003800     02 DEPART-TITLE PIC X(36).
003810     02 ACCOUNT PIC X(8).
003820        02 USER-NAME.
003850            03 USER-COST-CENTER   PIC X(3).
                  03 USER-INITIALS PIC X(9).
003860     02  ONLINE-SUMS.
003870         03 KOUNT USAGE COMP-6.
003880         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003890         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
003900         03 LINES-OUT PIC S9(15) USAGE COMP-3.
003910         03   CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
003920         03   ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
003930         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
003940         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
003950         03 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003960     02  BATCH-SUMS.
003970         03 KOUNT USAGE COMP-6.
003980         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003990         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
004000         03 LINES-OUT PIC S9(15) USAGE COMP-3.
004010         03   CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
004020         03   ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
004030         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
004040         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
004050         03 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003960     02  GHOST-SUMS.
003970         03 KOUNT USAGE COMP-6.
003980         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003990         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
004000         03 LINES-OUT PIC S9(15) USAGE COMP-3.
004010         03   CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
004020         03   ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
004030         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
004040         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
004050         03 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
003960     02  TP-SUMS.
003970         03 KOUNT USAGE COMP-6.
003980         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
003990         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
004000         03 LINES-OUT PIC S9(15) USAGE COMP-3.
004010         03   CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
004020         03   ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
004030         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
004040         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
004050         03 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
004060     02  TOTAL-SUMS.
004070         03 KOUNT USAGE COMP-6.
004080         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
004090         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
004100         03 LINES-OUT PIC S9(15) USAGE COMP-3.
004110         03   CPU-TIME      PIC 9(6)V9(4)  USAGE COMP-3.
004120         03   ELAP-TIME    PIC 9(10)V9(4)  USAGE COMP-3.
004130         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
004140         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
004150         03 MEDIA-MOUNTS    PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
004160 FD  PRINTR
004170     LABEL RECORDS OMITTED
004180     REPORTS DEPT-DETAIL.
004190 WORKING-STORAGE SECTION.
       77  EOF-FLAG USAGE COMP-6 VALUE 0.
       77  GAC-FLAG USAGE COMP-6 VALUE 0.
       77 GACIDCODE USAGE COMP-6 VALUE 4.
       77 PGRANSCODE USAGE COMP-6 VALUE 2.
       77 CHECKFLAG USAGE COMP-6 VALUE 0.
       77  A USAGE COMP-6 VALUE 0.
       77  B USAGE COMP-6 VALUE 0.
       77  C USAGE COMP-6 VALUE 0.
       77  INT USAGE COMP-6 VALUE 0.
004200 77 SYEAR USAGE COMP-6.
004210 77 SDAY  USAGE COMP-6.
004220 77 EYEAR USAGE COMP-6.
004230 77 EDAY  USAGE COMP-6.
004240 77 HWVAL USAGE COMP-6 VALUE 65536 .
004250 77 BYTE0VAL USAGE COMP-6 VALUE   16777216  .
004260 77 MINYEAR USAGE COMP-6 VALUE 0.
004270 77 MAXYEAR USAGE COMP-6 VALUE  9999.
004280 77 MINDAY  USAGE COMP-6 VALUE  0.
004290 77 MAXDAY  USAGE COMP-6 VALUE  34359738367.
       77  FIRST-DATE USAGE COMP-6 VALUE 0.
       77  LAST-DATE USAGE COMP-6 VALUE 0.
       77  DATE-FLAG USAGE COMP-6 VALUE 0.
004300 77 MONTH-TGD   PIC X(70) VALUE "TOTAL LIST".
004310 77 PERCENT-CPU-TS  PIC 9(6)V9(4) USAGE COMP-3.
004320 77 PERCENT-CPU-BATCH PIC 9(6)V9(4) USAGE COMP-3.
004310 77 PERCENT-CPU-TP  PIC 9(6)V9(4) USAGE COMP-3.
004320 77 PERCENT-CPU-GHOST PIC 9(6)V9(4) USAGE COMP-3.
004330 77 ELAP-PER-JOB  PIC 9(6)V9(4) USAGE COMP-3.
004340 77 JOBS-IN-ERROR            PIC 9(6)V9(4) USAGE COMP-3 VALUE 0.
004350 77 LINECOUNTER   USAGE COMP-6.
004360 77  MAX-VALUE               USAGE COMP-6 VALUE 0.
       77  GACID-MAX-VALUE     USAGE COMP-6 VALUE 0.
004370 77  HOURS-24                PIC 9(4).
004380 77  MIN-24                  PIC 99V99.
004390 77  TVALUE                  PIC S9(4)V9(11) USAGE COMP-3 VALUE 0.
004400 77  DOLLAR             PIC S9(6)V9(9)  USAGE COMP-3 VALUE 0.
004410 77  DOLLAR-TOTAL            PIC S9(9)V99    USAGE COMP-3 VALUE 0.
004420 77  OVERALL-DOLR-TOTAL      PIC S9(9)V99 USAGE COMP-3 VALUE 0.
004430 77  SELECT-FLAG             PIC XXXX VALUE "NULL".
004440 77  ZTIME                    PIC X(11).
       77  THEADING-DATE-START     PIC X(8) VALUE "01/01/78".
       77  THEADING-DATE-END       PIC X(8) VALUE "12/12/99".
       77  DUM-ZPKCO PIC S9(15).
       01 BYTE-INIT-1 VALUE LOW-VALUE.
           03 FILLER PIC XXX.
           03 BYTE-INIT PIC X.
       01 BYTE REDEFINES BYTE-INIT-1 COMP-6.
       01 HALF-INIT-1   VALUE ZERO.
           03 FILLER PIC XX.
           03 HALF-INIT PIC XX.
       01 HALF REDEFINES HALF-INIT-1 COMP-6.
       77 HEXVALUE                 COMP-6.
       77 HEXSTRING                PIC X(4).
       01 HT-INIT VALUE "0123456789ABCDEF".
           02 HEXTABLE OCCURS 16 TIMES INDEXED BY J1 PIC X.
       77 CARDCNT                  COMP-6.
       77 FORMCNT                  COMP-6.
       77 PAGECNT                  COMP-6.
       01 RATE-FLAG PIC 9(5).
          88  SYSTEM-RATE VALUE 1.
          88  TABLE-RATE VALUE 0.
004450 01  RATE-SCHEDULE.
004460     02 RES-MIN-DP-RATE        PIC 9V99999 USAGE COMP-3 VALUE 0.3.
004460     02 RES-MIN-MT-RATE        PIC 9V99999 USAGE COMP-3 VALUE 0.3.
004460     02 PAGE-MINS-RATE        PIC 9V9999 USAGE COMP-3 VALUE 0.003.
004480     02 PAGES-PRINTED-RATE   PIC 9V99999 USAGE COMP-3 VALUE 0.015.
004490     02 IO-ACCESS-RATE       PIC 9V9999 USAGE COMP-3 VALUE 0.0003.
004500     02 CPU-TIME-RATE        PIC 99V999   USAGE COMP-3 VALUE 0.55.
004510     02 ELAPSED-TIME-RATE    PIC 99V999  USAGE COMP-3 VALUE 0.02.
004520     02 MEDIA-MOUNT-RATE      PIC 99V99 USAGE COMP-3 VALUE 2.00.
004520     02 FORM-MOUNTS-RATE      PIC 99V99 USAGE COMP-3 VALUE 2.00.
004480     02 CARDS-OUT-RATE   PIC 9V9999 USAGE COMP-3 VALUE 0.010.
004490     02 TERM-INT-RATE       PIC 9V9999 USAGE COMP-3 VALUE 0.01.
004530 01  DISPLAY-RATE-RECORD.
004540     02 FILLER               PIC X(53) VALUE
004550        "   BASED ON THESE RATES:                             ".
004560     02 FILLER              PIC X(7).
004570     02 FILLER               PIC X(2) VALUE
004580                             ")(".
004590     02 DP-RATE               PIC $9.9999.
004600     02 FILLER                PIC X(4) VALUE
004610                             ")  (".
004620     02 LP-RATE              PIC $9.9999.
004630     02 FILLER               PIC X(5) VALUE
004640                             ")  (".
004650     02 I-O-RATE              PIC $9.9999.
004660     02 FILLER               PIC X(2) VALUE
004670                             ")(".
004680     02 CPU                  PIC $$$9.99.
004690     02 FILLER               PIC X(2) VALUE
004700                             ")(".
004710     02 ELAP-RATE            PIC $$$9.99.
004720     02 FILLER               PIC X(4) VALUE
004730                             ")  (".
004740     02 TAPE-RATE            PIC $9.99.
004750     02 FILLER               PIC XXX VALUE
004760                             " ) ".
004770 01  GACID-TABLE.
004780     02  GACID-ENTRY  OCCURS 1 TO 50 TIMES
004790             DEPENDING ON GACID-MAX-VALUE
004800             ASCENDING GACID-NO INDEXED BY J2.
004810          03 GACID-NO             PIC X(2).
004770 01  ACCOUNT-TABLE.
004780     02  ACCOUNT-ENTRY  OCCURS 1 TO 50 TIMES
004790             DEPENDING ON MAX-VALUE
004800             ASCENDING ACCT-NO INDEXED BY J.
004810          03 ACCT-NO             PIC X(8).
004820 01  COST-CENTER-TABLE.
004830     02  CC-ENTRY OCCURS 41 TIMES INDEXED BY I
004840          ASCENDING CC-NUMBER.
004850         03  CC-NUMBER       PIC X(3).
004860         03  CC-TITLE        PIC X(33).
004870 01  CC-LITERAL-TABLE.
004880     02  CC0100 PIC X(36) VALUE
004890     "100 J93                             ".
004880     02  CC0101 PIC X(36) VALUE
004890     "101 J90                             ".
004880     02  CC0102 PIC X(36) VALUE
004890     "102 J91                             ".
004880     02  CC0103 PIC X(36) VALUE
004890     "103 J91                             ".
004880     02  CC0104 PIC X(36) VALUE
004890     "104 J91                             ".
004880     02  CC0106 PIC X(36) VALUE
004890     "106 J90                             ".
004880     02  CC0107 PIC X(36) VALUE
004890     "107 J93                             ".
004880     02  CC0109 PIC X(36) VALUE
004890     "109 J93                             ".
004880     02  CC0201 PIC X(36) VALUE
004890     "201 J92                             ".
004880     02  CC0200 PIC X(36) VALUE
004890     "200 J92                             ".
004880     02  CC0203 PIC X(36) VALUE
004890     "203 J92                             ".
004880     02  CC0204 PIC X(36) VALUE
004890     "204 J92                             ".
004880     02  CC0205 PIC X(36) VALUE
004890     "205 J92                             ".
004880     02  CC0206 PIC X(36) VALUE
004890     "206 J92                             ".
004880     02  CC0300 PIC X(36) VALUE
004890     "300 J40                             ".
004880     02  CC0301 PIC X(36) VALUE
004890     "301 J40                             ".
004880     02  CC0302 PIC X(36) VALUE
004890     "302 J40                             ".
004880     02  CC0303 PIC X(36) VALUE
004890     "303 J94                             ".
004880     02  CC0304 PIC X(36) VALUE
004890     "304 J94                             ".
004880     02  CC0320 PIC X(36) VALUE
004890     "320 J94                             ".
004880     02  CC0330 PIC X(36) VALUE
004890     "330 J94                             ".
004880     02  CC0340 PIC X(36) VALUE
004890     "340 J91                             ".
004880     02  CC0350 PIC X(36) VALUE
004890     "350 J94                             ".
004880     02  CC0463 PIC X(36) VALUE
004890     "463 J93                             ".
004880     02  CC0473 PIC X(36) VALUE
004890     "473 J93                             ".
004880     02  CC0500 PIC X(36) VALUE
004890     "500 P53                             ".
004880     02  CC0600 PIC X(36) VALUE
004890     "600 9625                            ".
004880     02  CC0710 PIC X(36) VALUE
004890     "710 XXX                             ".
004880     02  CC0720 PIC X(36) VALUE
004890     "720 J90                             ".
004880     02  CC0730 PIC X(36) VALUE
004890     "730 XXX                             ".
004880     02  CC0740 PIC X(36) VALUE
004890     "740 XXX                             ".
004880     02  CC0750 PIC X(36) VALUE
004890     "750 XXX                             ".
004880     02  CC0800 PIC X(36) VALUE
004890     "800 J10                             ".
004880     02  CC0810 PIC X(36) VALUE
004890     "810 J43                             ".
004880     02  CC0820 PIC X(36) VALUE
004890     "820 J42                             ".
004880     02  CC0900 PIC X(36) VALUE
004890     "900 XXX                             ".
004880     02  CC0901 PIC X(36) VALUE
004890     "901 XXX                             ".
004880     02  CC0902 PIC X(36) VALUE
004890     "902 XXX                             ".
004880     02  CC0903 PIC X(36) VALUE
004890     "903 XXX                             ".
004880     02  CC0904 PIC X(36) VALUE
004890     "904 XXX                             ".
004880     02  CC0999 PIC X(36) VALUE
004890     "999 *** UNASSIGNED ***              ".
005020 01  LPFJ       USAGE COMP-6 VALUE 0.
005030 01  LPFJ2    REDEFINES LPFJ.
005040     02   FILLER   PIC XXX.
005050     02   LAST-BYTE  PIC X.
005060 01 SUM-STORE.
005070      02 KOUNT USAGE COMP-6.
005080      02 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
005090      02 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
            02 LINES-OUT PIC S9(15) USAGE COMP-3.
005110      02      CPU-TIME     PIC 9(6)V9(4)  USAGE COMP-3.
005120      02      ELAP-TIME   PIC 9(10)V9(4)  USAGE COMP-3.
005130      02 IO-ACCESS PIC S9(15) USAGE COMP-3.
005140      02 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
005150      02 MEDIA-MOUNTS         PIC S9(15) USAGE COMP-3.
            02 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
            02 CARDS-OUT PIC S9(15) USAGE COMP-3.
            02 TERM-INT PIC S9(15) USAGE COMP-3.
            02 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
       01 GAC-ACCT-SUMS.
           02 GAC-SHELF-SUMS.
               03 BACK COMP-6.
               03 NOBACK COMP-6.
               03 STOW COMP-6.
           02 GAC-ONLINE-SUMS.
               03 BACK COMP-6.
               03 NOBACK COMP-6.
               03 STOW COMP-6.
005160 01 OVERALL-SUMS.
005170     02  ONLINE-SUMS.
005180         03 KOUNT USAGE COMP-6.
005190         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
005200         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
005210         03 LINES-OUT PIC S9(15) USAGE COMP-3.
005220         03   CPU-TIME     PIC 9(6)V9(4)  USAGE COMP-3.
005230         03   ELAP-TIME   PIC 9(10)V9(4)  USAGE COMP-3.
005240         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
005250         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
005260         03 MEDIA-MOUNTS         PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
005270     02 BATCH-SUMS.
005280         03 KOUNT USAGE COMP-6.
005290         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
005300         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
005310         03 LINES-OUT PIC S9(15) USAGE COMP-3.
005320         03   CPU-TIME     PIC 9(6)V9(4)  USAGE COMP-3.
005330         03   ELAP-TIME   PIC 9(10)V9(4)  USAGE COMP-3.
005340         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
005350         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
005360         03 MEDIA-MOUNTS         PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
005270     02 GHOST-SUMS.
005280         03 KOUNT USAGE COMP-6.
005290         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
005300         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
005310         03 LINES-OUT PIC S9(15) USAGE COMP-3.
005320         03   CPU-TIME     PIC 9(6)V9(4)  USAGE COMP-3.
005330         03   ELAP-TIME   PIC 9(10)V9(4)  USAGE COMP-3.
005340         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
005350         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
005360         03 MEDIA-MOUNTS         PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
005270     02 TP-SUMS.
005280         03 KOUNT USAGE COMP-6.
005290         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
005300         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
005310         03 LINES-OUT PIC S9(15) USAGE COMP-3.
005320         03   CPU-TIME     PIC 9(6)V9(4)  USAGE COMP-3.
005330         03   ELAP-TIME   PIC 9(10)V9(4)  USAGE COMP-3.
005340         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
005350         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
005360         03 MEDIA-MOUNTS         PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
005370     02 TOTAL-SUMS.
005380         03 KOUNT USAGE COMP-6.
005390         03 RES-MIN-MT PIC 9(10)V9(5) USAGE COMP-3.
005400         03 PAGE-MINS PIC 9(10)V9(5) USAGE COMP-3.
005410         03 LINES-OUT PIC S9(15) USAGE COMP-3.
005420         03   CPU-TIME     PIC 9(6)V9(4)  USAGE COMP-3.
005430         03   ELAP-TIME   PIC 9(10)V9(4)  USAGE COMP-3.
005440         03 IO-ACCESS PIC S9(15) USAGE COMP-3.
005450         03 RES-MIN-DP PIC 9(10)V9(5) USAGE COMP-3.
005460         03 MEDIA-MOUNTS         PIC S9(15) USAGE COMP-3.
               03 FORM-MOUNTS PIC S9(15) USAGE COMP-3.
               03 CARDS-OUT PIC S9(15) USAGE COMP-3.
               03 TERM-INT PIC S9(15) USAGE COMP-3.
               03 CHARGE PIC 9(10)V9(5) USAGE COMP-3.
005470 01 QUAL-KEY.
005480      02 ACCOUNT PIC X(8).
005490      02 BATCH-FLAG PIC X.
005500      02 USER-NAME      PIC X(12).
005510 01  TITLE.
005520     02  FILLER              PIC X(36) VALUE SPACES.
005530     02  LINE1               PIC X(34) VALUE SPACES.
005540     02  FILLER              PIC X(62) VALUE SPACES.
005550 01  TITLE1                  PIC X(34) VALUE
005560         "  LOS ANGELES DEVELOPMENT CNTR    ".
005570 01  TITLE2                      PIC X(34) VALUE
005580     "   DETAIL LISTING OF JOBS RUN     ".
005590 01  TITLE3.
005600     02  FILLER             PIC X(5) VALUE SPACES.
005610     02  STARTING-DATE           PIC X(8) VALUE "XXXXXXXX".
005620     02  T2                      PIC X(4) VALUE " TO ".
005630     02  ENDING-DATE             PIC X(8) VALUE "XXXXXXXX".
005640     02  FILLER                  PIC X(7) VALUE SPACES.
005650 01  TITLE4.
005660     02  FILLER        PIC XX VALUE SPACES.
005670     02  H1            PIC X(24) VALUE
005680        "   JOB IDENTIFICATION   ".
005690     02  FILLER        PIC XX VALUE SPACES.
005700     02  H2            PIC X(6) VALUE
005710        " LINE ".
005720     02  FILLER        PIC X VALUE SPACE.
005730     02  H3            PIC X(15) VALUE
005740       "------DATE-----".
005750     02  FILLER        PIC X(5) VALUE SPACES.
005760     02  H4            PIC X(16) VALUE
005770        " RES-MT   RES-DP".
005780     02  FILLER        PIC X(6) VALUE SPACES.
005790     02  H5            PIC X(5) VALUE
005800        "PAGES".
005810     02  FILLER        PIC X(5) VALUE SPACES.
005820     02  H6            PIC XXXX VALUE "I-O ".
005830     02  FILLER        PIC X(6) VALUE SPACES.
005840     02  H7            PIC XXX   VALUE "CPU".
005850     02  FILLER        PIC X(8) VALUE SPACES.
005860     02  H8            PIC XXXX VALUE "ELAP".
005870     02  FILLER              PIC X(5) VALUE SPACE.
005880     02  H9            PIC XXXXX VALUE "MEDIA".
005890     02 H10                  PIC X(9) VALUE "   PAGE  ".
005900 01  TITLE5.
005910     02  FILLER        PIC XX VALUE SPACES.
005920     02  H9            PIC X(20) VALUE
005930        "    ACCOUNT NUMBER  ".
005940     02  FILLER        PIC X(5) VALUE SPACES.
005950     02  H10           PIC X(6) VALUE
005960        "NUMBER".
005970     02  FILLER        PIC XX VALUE SPACES.
005980     02  H11           PIC X(15) VALUE
005990        "YR-DAY     TIME".
006000     02  FILLER        PIC X(8) VALUE SPACES.
006010     02  H12           PIC X(14) VALUE
006020        "MINS    MINS ".
006030     02  FILLER        PIC XXXX VALUE SPACES.
006040     02  H13           PIC X(9) VALUE
006050        "PRINTED ".
006060     02  FILLER        PIC XX VALUE SPACES.
006070     02  H14           PIC X(6) VALUE
006080        "ACCESS".
006090     02  FILLER        PIC  X(4) VALUE SPACES.
006100     02  H15           PIC XXXX VALUE
006110        "TIME".
006120     02  FILLER        PIC X(7) VALUE "-(MIN)-".
006130     02  H16           PIC XXXX VALUE
006140        "TIME".
006150     02  FILLER              PIC X(5) VALUE SPACE.
006160     02  H17           PIC XXXXXX VALUE "MOUNTS".
006170     02  H18                 PIC X(9) VALUE "  MINUTES".
006180 01  DETAIL-LINE-1.
006190     02  FILLER                  PIC X.
006200     02  JOB-COUNT                 PIC ZZZZ9.B.
006210     02  JOB-ID-COLUMN.
006220         03 ACCOUNT          PIC X(8).
006230         03 FILLER               PIC X.
006240         03 USER-NAME        PIC X(12).
006250     02  FILLER                  PIC X.
           02  LINE-NUMBER-COLUMN.
               03 ZFEP             PIC X.
               03 ZSPEED           PIC X VALUE "-".
               03 ZPORT            PIC X(4).
006270     02  BATCH-JOB REDEFINES LINE-NUMBER-COLUMN PIC X(6).
006280     02  ERROR-JOB REDEFINES LINE-NUMBER-COLUMN PIC ZZZZ.9.
006290     02  FILLER                  PIC X.
006300     02  YEAR-COLUMN             PIC X(8).
006330     02  FILLER                  PIC X(2).
006340     02  TIME-COLUMN.
006350         03  HOUR                PIC XX.
006360         03  COLON               PIC X.
006370         03  MINIT               PIC XX.
006390     02  RES-MIN-MT-COLUMN         PIC Z(7)9.9.
006410     02  RES-MIN-DP-COLUMN    PIC Z(7)9.9.
006420     02  FILLER                  PIC XX.
006430     02  PAGES-PRINTED-COLUMN    PIC Z(7)9.
006440     02  FILLER                  PIC XXX.
006450     02  IO-ACCESSES-COLUMN      PIC Z(7)9.
006460     02  FILLER                  PIC X.
006470     02  CPU-TIME-COLUMN         PIC Z(4).999.
006480     02  FILLER                  PIC XXX.
006490     02  ELAPSED-TIME-COLUMN     PIC Z(6)9.
006500     02  FILLER                  PIC X(6).
006510     02  MEDIA-MOUNT-COLUMN      PIC ZZ9.
006520     02  FILLER              PIC X(1).
006530     02 PAGE-MIN-COLUMN           PIC Z(7)9.9.
006540 01   CHARGE-LINE REDEFINES DETAIL-LINE-1.
006550     02  FILLER                  PIC X(52).
006560     02  FILLER-CHARGE         PIC X(8).
006570     02  FILLER                  PIC X.
006580     02  RES-MIN-DP-CHARGE    PIC $$$$9.99.
006590     02  FILLER                  PIC XXXX.
006600     02  PAGES-PRINTED-CHARGE    PIC $$$$9.99.
006610     02  FILLER                  PIC XXX.
006620     02  IO-ACCESSES-CHARGE      PIC $$$$9.99.
006630     02  FILLER                  PIC X.
006640     02  CPU-TIME-CHARGE         PIC $$$$9.99.
006650     02  FILLER                  PIC XX.
006660     02  ELAPSED-TIME-CHARGE     PIC $$$$9.99.
006670     02  FILLER                  PIC XXX.
006680     02  MEDIA-MOUNT-CHARGE      PIC $$9.99.
006690     02  FILLER              PIC X(10).
006700 01  TOTAL-LINE.
006710     02  NOTE-1              PIC X(29) VALUE
006720         "  TOTAL FOR THIS ACCOUNT IS: ".
006730     02 FILLER               PIC X(7) VALUE "------>".
006740     02 MONEY                PIC $$$,$$$,$$9.99 VALUE SPACE.
006750     02 ARROW                PIC X(6) VALUE " <----".
006760     02 FILLER               PIC X(70) VALUE SPACE.
006770 01  DASH-LINE.
006780     02  FILLER PIC X(56) VALUE SPACES.
006790     02  D1                 PIC X(6) VALUE "------".
006800     02  FILLER             PIC XXX VALUE SPACES.
006810     02  D2                 PIC X(6) VALUE "------".
004820     02  FILLER             PIC X(6) VALUE SPACES.
006830     02  D3                 PIC X(6) VALUE "------".
006840     02  FILLER             PIC X(5)  VALUE SPACES.
006850     02  D4                 PIC X(6) VALUE "------".
006860     02  FILLER             PIC XX  VALUE SPACES.
006870     02  D5                 PIC X(7) VALUE "-------".
006880     02  FILLER             PIC X(6) VALUE SPACES.
006890     02  D6                 PIC XXXX VALUE "----".
006900     02  FILLER              PIC X(6) VALUE SPACES.
006910     02  D7                  PIC XXX VALUE "---".
006840     02  FILLER             PIC X(3)  VALUE SPACES.
006830     02  D8                 PIC X(6) VALUE "------".
005570 01  TITLE20                      PIC X(34) VALUE
005580     "   DETAIL LISTING OF GAC RUNS     ".
005650 01  TITLE40.
005660     02  FILLER        PIC XX VALUE SPACES.
005670     02  H21            PIC X(8) VALUE
005680        "ACCOUNT".
005690     02  FILLER        PIC XX VALUE SPACES.
005700     02  H22            PIC X(8) VALUE
005710        "PACK SET".
005720     02  FILLER        PIC XX VALUE SPACE.
           02  H23            PIC X(34) VALUE
005740       "---------------SHELF---------------".
005750     02  FILLER        PIC X(15) VALUE SPACES.
005760     02  H24            PIC X(34) VALUE
               "--------------ONLINE--------------".
       01  TITLE50.
005780     02  FILLER        PIC X(20) VALUE SPACES.
           02  H25            PIC X(10) VALUE "  BACKUP  ".
005810     02  FILLER        PIC X(5) VALUE SPACES.
005820     02  H26            PIC X(10) VALUE " NO BACKUP ".
005830     02  FILLER        PIC X(5) VALUE SPACES.
005840     02  H27            PIC X(10)   VALUE "   STOW   ".
005850     02  FILLER        PIC X(5) VALUE SPACES.
           02  H28            PIC X(10) VALUE "  BACKUP  ".
005810     02  FILLER        PIC X(5) VALUE SPACES.
005820     02  H29            PIC X(10) VALUE " NO BACKUP ".
005830     02  FILLER        PIC X(5) VALUE SPACES.
005840     02  H30            PIC X(10)   VALUE "   STOW   ".
005850     02  FILLER        PIC X(5) VALUE SPACES.
006180 01  GAC-LINE-1.
006190     02  FILLER                  PIC XX.
           02  GAC-ACCT-COL                PIC X(8).
           02  FILLER         PIC XX.
           02  GAC-PACK-COL       PIC X(6).
006380     02  FILLER                  PIC XX.
           02  BACK-SHELF-COL          PIC Z(9)9.
006400     02  FILLER                  PIC X(5).
           02  NOBACK-SHELF-COL        PIC Z(9)9.
006420     02  FILLER                  PIC X(5).
           02  STOW-SHELF-COL          PIC Z(9)9.
006440     02  FILLER                  PIC X(5).
           02  BACK-ONLINE-COL         PIC Z(9)9.
006460     02  FILLER                  PIC X(5).
           02  NOBACK-ONLINE-COL       PIC Z(9)9.
006480     02  FILLER                  PIC X(5).
           02  STOW-ONLINE-COL         PIC Z(9)9.
006500     02  FILLER                  PIC X(5).
006920 REPORT SECTION.
006930 RD DEPT-SUMMARY
006940     PAGE 60 LINES HEADING 1 FIRST DETAIL 10
006950     LAST DETAIL 40
006960     FOOTING 45.
006970 01 TYPE REPORT HEADING.
006980     02 LINE 1  COLUMN 40 PIC X(29) VALUE
006990     "CPU UTILIZATION BY DEPARTMENT".
007000     02 LINE PLUS 1.
007010        03 COLUMN 38 PIC X(4) VALUE "DAY ".
007020        03 COLUMN 42 PIC X(8) SOURCE THEADING-DATE-START.
007050        03 COLUMN 50 PIC X(8) VALUE " TO DAY ".
007060        03 COLUMN 58 PIC X(8) SOURCE THEADING-DATE-END.
007100     02 LINE PLUS 5 COLUMN 5 PIC X(11) VALUE
007110     "DEPARTMENT ".
007120     02 COLUMN 62 PIC X(5) VALUE "BATCH".
007130     02 COLUMN 92 PIC X(3) VALUE "T/S".
007140     02 LINE PLUS 1 COLUMN 47 PIC X(28) VALUE
007150     "----------------------------".
007160     02 COLUMN 77 PIC X(28) VALUE
007170     "----------------------------".
007180     02 LINE PLUS 1 COLUMN 47 PIC X(10) VALUE "    JOBS  ".
007190     02 COLUMN 57 PIC X(10) VALUE "CPU USAGE".
007200     02 COLUMN 67 PIC X(10) VALUE "    %CPU  ".
007210     02 COLUMN 77 PIC X(10) VALUE "   LOGON  ".
007220     02 COLUMN 87 PIC X(10) VALUE "CPU USAGE".
007230     02 COLUMN 97 PIC X(10) VALUE "    %CPU".
007240 01 DEPT-SUMM TYPE DETAIL LINE PLUS 1.
007250     02 COLUMN 5 PIC X(36) SOURCE DEPART-TITLE IN SORT2REC.
007260     02 COLUMN 47 PIC Z(7)9 SOURCE
007270       KOUNT IN BATCH-SUMS IN SORT2REC.
007280     02 COLUMN 57 PIC Z(5).99 SOURCE
007290       CPU-TIME IN BATCH-SUMS IN SORT2REC.
007300     02 COLUMN 67 PIC Z(4)9.99 SOURCE
007310       PERCENT-CPU-BATCH.
007320     02 COLUMN  77 PIC Z(7)9 SOURCE
007330       KOUNT IN ONLINE-SUMS IN SORT2REC.
007340     02 COLUMN 87 PIC Z(5).99 SOURCE
007350       CPU-TIME IN ONLINE-SUMS IN SORT2REC.
007360     02 COLUMN 97 PIC Z(4)9.99 SOURCE
007370       PERCENT-CPU-TS.
007380 01 TYPE REPORT FOOTING.
           02 LINE PLUS 1 COLUMN 2 PIC X VALUE SPACES.
007390     02 LINE PLUS 10 COLUMN 5 PIC X(21) VALUE
007400     "OVERALL SUMMARY BATCH".
007410     02 COLUMN 75 PIC X(18) VALUE
007420     "OVERALL SUMMARY TS".
007430     02 LINE PLUS 1 COLUMN 5 PIC X(32) VALUE
007440     "--------------------------------".
007450     02 COLUMN 75 PIC X(32) VALUE
007460     "--------------------------------".
007470     02 LINE PLUS 1 COLUMN 5 PIC X(15) VALUE
007480     "TOTAL   OF JOBS".
007490     02 COLUMN 30 PIC Z(4),ZZ9 SOURCE KOUNT IN BATCH-SUMS
007500       IN OVERALL-SUMS.
007510     02 COLUMN 75 PIC  X(14) VALUE
007520     "TOTAL CPU TIME".
007530     02 COLUMN 99  PIC Z(5).99 SOURCE
007540      CPU-TIME IN ONLINE-SUMS IN OVERALL-SUMS.
007550     02 COLUMN 107 PIC X(3) VALUE "HRS".
007560     02 LINE PLUS 1 COLUMN 5 PIC X(14) VALUE
007570     "TOTAL CPU TIME".
007580     02 COLUMN 30 PIC Z(5).99 SOURCE
007590       CPU-TIME IN BATCH-SUMS IN OVERALL-SUMS.
007600     02 COLUMN 39 PIC X(3) VALUE "HRS".
007610     02 COLUMN 75 PIC X(17) VALUE
007620     "TOTAL   OF LOGONS".
007630     02 COLUMN 99  PIC Z(7)9 SOURCE
007640       KOUNT IN ONLINE-SUMS IN OVERALL-SUMS.
007740     02 LINE PLUS 1  COLUMN 5 PIC X(19) VALUE
007750       "TOTAL PAGES PRINTED".
007760     02 COLUMN 29 PIC Z,ZZZ,ZZ9 SOURCE
007770       LINES-OUT IN BATCH-SUMS IN OVERALL-SUMS.
007690     02  COLUMN 75 PIC X(18) VALUE
007700     "TOTAL CONNECT TIME".
007710     02 COLUMN 99  PIC Z(5).99 SOURCE
007720       ELAP-TIME IN ONLINE-SUMS IN OVERALL-SUMS.
007730     02 COLUMN 107 PIC X(4) VALUE "HRS ".
007820     02 LINE PLUS 1 COLUMN 5 PIC X(17) VALUE
007830        "AVG. RUN TIME/JOB".
007840     02 COLUMN 30 PIC Z(5).99 SOURCE ELAP-PER-JOB.
007850     02 COLUMN 39 PIC X(4) VALUE "MINS".
007860 RD DEPT-DETAIL CONTROLS ARE
007870     DEPART-TITLE IN SORT2REC
007880     USER-NAME IN SORT2REC
007890     PAGE 39 LINES HEADING 1 FIRST DETAIL 12
007900     LAST DETAIL 33
007910     FOOTING 36.
007920 01 TYPE REPORT HEADING.
007930     02 LINE 1 COLUMN 37 PIC X(35) VALUE
007940      " LADC COST CENTER COMPUTER USAGE ".
007950     02 LINE PLUS 1.
007960        03 COLUMN 38 PIC X(4) VALUE "DAY ".
               03 COLUMN 42 PIC X(8) SOURCE THEADING-DATE-START.
008000        03 COLUMN 50 PIC X(8) VALUE " TO DAY ".
               03 COLUMN 58 PIC X(8) SOURCE THEADING-DATE-END.
008040        03 COLUMN 69 PIC X(70) SOURCE MONTH-TGD.
008050 01 DEPT-HEAD TYPE PAGE    HEADING.
008060     02 LINE 5 COLUMN 16 PIC X(36)  JUSTIFIED RIGHT SOURCE
008070         DEPART-TITLE IN SORT2REC.
008080     02        COLUMN 53 PIC X(11) VALUE
008090     " DEPARTMENT".
008100     02  COLUMN 66 PIC X(70) SOURCE MONTH-TGD.
008110     02 LINE PLUS 4 COLUMN 11 PIC X(40) VALUE
008120     "     CPU      ELAP   RES-DP    RES-MT ".
008130     02 COLUMN 51 PIC X(50) VALUE
008140     "PAGE-MINS  PAGES  IO-ACCESS      JOBS      MEDIA".
008110     02 COLUMN 101 PIC X(30) VALUE
008120     "  FORM  CARDS  TINTER  BILLING".
008110     02 LINE PLUS 1 COLUMN 11 PIC X(40) VALUE
008160     " MINUTES   MINUTES   MINUTES   MINUTES  ".
008170     02 COLUMN 91     PIC X(10) VALUE "   MOUNT  ".
008110     02 COLUMN 101 PIC X(30) VALUE
008120     "  MOUNT                CHARGE ".
008180 01 ACCT-VAL TYPE DETAIL.
008190     02 ACCOUNT-NAME-LINE LINE PLUS 3.
008200        03 COLUMN 6 PIC X(8) SOURCE
008210           ACCOUNT IN SORT2REC.
008220        03 COLUMN 17 PIC X(12) SOURCE
008230            USER-NAME IN SORT2REC.
008240     02 ONLINE-DETAIL LINE PLUS 1.
008210         03 COLUMN 1 PIC X(6) VALUE "ONLINE".
008260         03 COLUMN 7 PIC Z(7).9999 SOURCE
008270         CPU-TIME IN ONLINE-SUMS IN SORT2REC.
008280         03 COLUMN 21 PIC Z(6).9  SOURCE
008290         ELAP-TIME IN ONLINE-SUMS IN SORT2REC.
008300         03 COLUMN 29 PIC Z(7)9.9 SOURCE
008310         RES-MIN-DP IN ONLINE-SUMS IN SORT2REC.
008320         03 COLUMN 39 PIC Z(7)9.9 SOURCE
008330         RES-MIN-MT IN ONLINE-SUMS IN SORT2REC.
008340         03 COLUMN 49 PIC Z(7)9.9 SOURCE
008350         PAGE-MINS IN ONLINE-SUMS IN SORT2REC.
008360         03 COLUMN 61 PIC Z(7)9 SOURCE
008370         LINES-OUT IN ONLINE-SUMS IN SORT2REC.
008380         03 COLUMN 69 PIC Z(7)9 SOURCE
008390         IO-ACCESS IN ONLINE-SUMS IN SORT2REC.
008400         03 COLUMN 80 PIC Z(7)9 SOURCE
008410         KOUNT IN ONLINE-SUMS IN SORT2REC.
008420         03 COLUMN 91  PIC Z(7)9 SOURCE
008430        MEDIA-MOUNTS IN ONLINE-SUMS IN SORT2REC.
008360         03 COLUMN 99 PIC Z(7)9 SOURCE
008370         FORM-MOUNTS IN ONLINE-SUMS IN SORT2REC.
008380         03 COLUMN 107 PIC Z(7)9 SOURCE
008390         CARDS-OUT IN ONLINE-SUMS IN SORT2REC.
008400         03 COLUMN 115 PIC Z(7)9 SOURCE
008410         TERM-INT IN ONLINE-SUMS IN SORT2REC.
008420         03 COLUMN 123  PIC $(7)9.99 SOURCE
008430        CHARGE IN ONLINE-SUMS IN SORT2REC.
008440     02 BATCH-DETAIL  LINE PLUS 1.
008450         03 COLUMN 1 PIC X(6) VALUE "BATCH ".
008460         03 COLUMN 7 PIC Z(7).9999 SOURCE
008470         CPU-TIME IN BATCH-SUMS  IN SORT2REC.
008480         03 COLUMN 21 PIC Z(6).9  SOURCE
008490         ELAP-TIME IN BATCH-SUMS  IN SORT2REC.
008500         03 COLUMN 29 PIC Z(7)9.9 SOURCE
008510         RES-MIN-DP IN BATCH-SUMS  IN SORT2REC.
008520         03 COLUMN 39 PIC Z(7)9.9 SOURCE
008530         RES-MIN-MT IN BATCH-SUMS  IN SORT2REC.
008540         03 COLUMN 49 PIC Z(7)9.9 SOURCE
008550         PAGE-MINS IN BATCH-SUMS  IN SORT2REC.
008560         03 COLUMN 61 PIC Z(7)9 SOURCE
008570         LINES-OUT IN BATCH-SUMS  IN SORT2REC.
008580         03 COLUMN 69 PIC Z(7)9 SOURCE
008590         IO-ACCESS IN BATCH-SUMS  IN SORT2REC.
008600         03 COLUMN 80 PIC Z(7)9 SOURCE
008610         KOUNT IN BATCH-SUMS  IN SORT2REC.
008620         03 COLUMN 91 PIC Z(7)9 SOURCE
008630        MEDIA-MOUNTS IN BATCH-SUMS IN SORT2REC.
008360         03 COLUMN 99 PIC Z(7)9 SOURCE
008370         FORM-MOUNTS IN BATCH-SUMS IN SORT2REC.
008380         03 COLUMN 107 PIC Z(7)9 SOURCE
008390         CARDS-OUT IN BATCH-SUMS IN SORT2REC.
008400         03 COLUMN 115 PIC Z(7)9 SOURCE
008410         TERM-INT IN BATCH-SUMS IN SORT2REC.
008420         03 COLUMN 123  PIC $(7)9.99 SOURCE
008430        CHARGE IN BATCH-SUMS IN SORT2REC.
008240     02 TP-DETAIL LINE PLUS 1.
008250         03 COLUMN 1 PIC X(6) VALUE "TP".
008260         03 COLUMN 7 PIC Z(7).9999 SOURCE
008270         CPU-TIME IN TP-SUMS IN SORT2REC.
008280         03 COLUMN 21 PIC Z(6).9  SOURCE
008290         ELAP-TIME IN TP-SUMS IN SORT2REC.
008300         03 COLUMN 29 PIC Z(7)9.9 SOURCE
008310         RES-MIN-DP IN TP-SUMS IN SORT2REC.
008320         03 COLUMN 39 PIC Z(7)9.9 SOURCE
008330         RES-MIN-MT IN TP-SUMS IN SORT2REC.
008340         03 COLUMN 49 PIC Z(7)9.9 SOURCE
008350         PAGE-MINS IN TP-SUMS IN SORT2REC.
008360         03 COLUMN 61 PIC Z(7)9 SOURCE
008370         LINES-OUT IN TP-SUMS IN SORT2REC.
008380         03 COLUMN 69 PIC Z(7)9 SOURCE
008390         IO-ACCESS IN TP-SUMS IN SORT2REC.
008400         03 COLUMN 80 PIC Z(7)9 SOURCE
008410         KOUNT IN TP-SUMS IN SORT2REC.
008420         03 COLUMN 91  PIC Z(7)9 SOURCE
008430        MEDIA-MOUNTS IN TP-SUMS IN SORT2REC.
008360         03 COLUMN 99 PIC Z(7)9 SOURCE
008370         FORM-MOUNTS IN TP-SUMS IN SORT2REC.
008380         03 COLUMN 107 PIC Z(7)9 SOURCE
008390         CARDS-OUT IN TP-SUMS IN SORT2REC.
008400         03 COLUMN 115 PIC Z(7)9 SOURCE
008410         TERM-INT IN TP-SUMS IN SORT2REC.
008420         03 COLUMN 123  PIC $(7)9.99 SOURCE
008430        CHARGE IN TP-SUMS IN SORT2REC.
008440     02 GHOST-DETAIL  LINE PLUS 1.
008450         03 COLUMN 1 PIC X(6) VALUE "GHOST ".
008460         03 COLUMN 7 PIC Z(7).9999 SOURCE
008470         CPU-TIME IN GHOST-SUMS  IN SORT2REC.
008480         03 COLUMN 21 PIC Z(6).9  SOURCE
008490         ELAP-TIME IN GHOST-SUMS  IN SORT2REC.
008500         03 COLUMN 29 PIC Z(7)9.9 SOURCE
008510         RES-MIN-DP IN GHOST-SUMS  IN SORT2REC.
008520         03 COLUMN 39 PIC Z(7)9.9 SOURCE
008530         RES-MIN-MT IN GHOST-SUMS  IN SORT2REC.
008540         03 COLUMN 49 PIC Z(7)9.9 SOURCE
008550         PAGE-MINS IN GHOST-SUMS  IN SORT2REC.
008560         03 COLUMN 61 PIC Z(7)9 SOURCE
008570         LINES-OUT IN GHOST-SUMS  IN SORT2REC.
008580         03 COLUMN 69 PIC Z(7)9 SOURCE
008590         IO-ACCESS IN GHOST-SUMS  IN SORT2REC.
008600         03 COLUMN 80 PIC Z(7)9 SOURCE
008610         KOUNT IN GHOST-SUMS  IN SORT2REC.
008620         03 COLUMN 91 PIC Z(7)9 SOURCE
008630        MEDIA-MOUNTS IN GHOST-SUMS IN SORT2REC.
008360         03 COLUMN 99 PIC Z(7)9 SOURCE
008370         FORM-MOUNTS IN GHOST-SUMS IN SORT2REC.
008380         03 COLUMN 107 PIC Z(7)9 SOURCE
008390         CARDS-OUT IN GHOST-SUMS IN SORT2REC.
008400         03 COLUMN 115 PIC Z(7)9 SOURCE
008410         TERM-INT IN GHOST-SUMS IN SORT2REC.
008420         03 COLUMN 123  PIC $(7)9.99 SOURCE
008430        CHARGE IN GHOST-SUMS IN SORT2REC.
008640     02 DASHED-LINE  LINE PLUS 1.
008650         03 COLUMN 11 PIC X(8) VALUE "--------".
008660         03 COLUMN 21 PIC X(8)   VALUE "--------".
008670         03 COLUMN 31 PIC X(8) VALUE "--------".
008680         03 COLUMN 41 PIC X(8) VALUE "--------".
008690         03 COLUMN 51 PIC X(8) VALUE "--------".
008700         03 COLUMN 60 PIC X(8) VALUE "--------".
008710         03 COLUMN 70 PIC X(8) VALUE "--------".
008720         03 COLUMN 80 PIC X(8) VALUE "--------".
008730         03 COLUMN 91 PIC X(8) VALUE "--------".
009430         03 COLUMN 99 PIC X(8) VALUE "  ------".
009440         03 COLUMN 107 PIC X(8) VALUE "  ------".
009450         03 COLUMN 115 PIC X(8) VALUE "  ------".
009460         03 COLUMN 123 PIC X(8) VALUE "  ------".
008740     02 TOTAL-DETAIL  LINE PLUS 1.
008750         03 COLUMN 1 PIC X(6) VALUE "TOTAL ".
008760         03 COLUMN 7 PIC Z(7).9999 SOURCE
008770         CPU-TIME IN TOTAL-SUMS  IN SORT2REC.
008780         03 COLUMN 21 PIC Z(6).9   SOURCE
008790         ELAP-TIME IN TOTAL-SUMS  IN SORT2REC.
008800         03 COLUMN 29 PIC Z(7)9.9 SOURCE
008810         RES-MIN-DP IN TOTAL-SUMS  IN SORT2REC.
008820         03 COLUMN 39 PIC Z(7)9.9 SOURCE
008830         RES-MIN-MT IN TOTAL-SUMS  IN SORT2REC.
008840         03 COLUMN 49 PIC Z(7)9.9 SOURCE
008850         PAGE-MINS IN TOTAL-SUMS  IN SORT2REC.
008860         03 COLUMN 61 PIC Z(7)9 SOURCE
008870         LINES-OUT IN TOTAL-SUMS  IN SORT2REC.
008880         03 COLUMN 69 PIC Z(7)9 SOURCE
008890         IO-ACCESS IN TOTAL-SUMS  IN SORT2REC.
008900         03 COLUMN 80 PIC Z(7)9 SOURCE
008910         KOUNT IN TOTAL-SUMS  IN SORT2REC.
008920        03 COLUMN 91 PIC Z(7)9 SOURCE
008930           MEDIA-MOUNTS IN TOTAL-SUMS IN SORT2REC.
008360         03 COLUMN 99 PIC Z(7)9 SOURCE
008370         FORM-MOUNTS IN TOTAL-SUMS IN SORT2REC.
008380         03 COLUMN 107 PIC Z(7)9 SOURCE
008390         CARDS-OUT IN TOTAL-SUMS IN SORT2REC.
008400         03 COLUMN 115 PIC Z(7)9 SOURCE
008410         TERM-INT IN TOTAL-SUMS IN SORT2REC.
008420         03 COLUMN 123  PIC $(7)9.99 SOURCE
008430        CHARGE IN TOTAL-SUMS IN SORT2REC.
008940 01 DEPT-FOOT TYPE CONTROL FOOTING
008950     DEPART-TITLE IN SORT2REC NEXT GROUP NEXT  PAGE.
008960     02 LINE PLUS 8 COLUMN 8  PIC X(26) VALUE
008970        "**TOTALS FOR COST CENTER**".
008980     02 ONLINE-DETAIL LINE PLUS 1.
008990         03 COLUMN 1 PIC X(6) VALUE "ONLINE".
009000         03 COLUMN 7 PIC Z(7).9999 SUM
009010         CPU-TIME IN ONLINE-SUMS IN SORT2REC.
009020         03 COLUMN 21 PIC Z(6).9  SUM
009030         ELAP-TIME IN ONLINE-SUMS IN SORT2REC.
009040         03 COLUMN 29 PIC Z(7)9.9 SUM
009050         RES-MIN-DP IN ONLINE-SUMS IN SORT2REC.
009060         03 COLUMN 39 PIC Z(7)9.9 SUM
009070         RES-MIN-MT IN ONLINE-SUMS IN SORT2REC.
009080         03 COLUMN 49 PIC Z(7)9.9 SUM
009090         PAGE-MINS IN ONLINE-SUMS IN SORT2REC.
009100         03 COLUMN 61 PIC Z(7)9 SUM
009110         LINES-OUT IN ONLINE-SUMS IN SORT2REC.
009120         03 COLUMN 69 PIC Z(7)9 SUM
009130         IO-ACCESS IN ONLINE-SUMS IN SORT2REC.
009140         03 COLUMN 80 PIC Z(7)9 SUM
009150         KOUNT IN ONLINE-SUMS IN SORT2REC.
009160         03 COLUMN 91 PIC Z(7)9 SUM
009170           MEDIA-MOUNTS IN ONLINE-SUMS IN SORT2REC.
008360         03 COLUMN 99 PIC Z(7)9 SUM
008370         FORM-MOUNTS IN ONLINE-SUMS IN SORT2REC.
008380         03 COLUMN 107 PIC Z(7)9 SUM
008390         CARDS-OUT IN ONLINE-SUMS IN SORT2REC.
008400         03 COLUMN 115 PIC Z(7)9 SUM
008410         TERM-INT IN ONLINE-SUMS IN SORT2REC.
008420         03 COLUMN 123  PIC $(7)9.99 SUM
008430        CHARGE IN ONLINE-SUMS IN SORT2REC.
009180     02 BATCH-DETAIL  LINE PLUS 1.
009190         03 COLUMN 1 PIC X(6) VALUE "BATCH ".
009200         03 COLUMN 7 PIC Z(7).9999 SUM
009210         CPU-TIME IN BATCH-SUMS  IN SORT2REC.
009220         03 COLUMN 21 PIC Z(6).9  SUM
009230         ELAP-TIME IN BATCH-SUMS  IN SORT2REC.
009240         03 COLUMN 29 PIC Z(7)9.9 SUM
009250         RES-MIN-DP IN BATCH-SUMS  IN SORT2REC.
009260         03 COLUMN 39 PIC Z(7)9.9 SUM
009270         RES-MIN-MT IN BATCH-SUMS  IN SORT2REC.
009280         03 COLUMN 49 PIC Z(7)9.9 SUM
009290         PAGE-MINS IN BATCH-SUMS  IN SORT2REC.
009300         03 COLUMN 61 PIC Z(7)9 SUM
009310         LINES-OUT IN BATCH-SUMS  IN SORT2REC.
009320         03 COLUMN 69 PIC Z(7)9 SUM
009330         IO-ACCESS IN BATCH-SUMS  IN SORT2REC.
009340         03 COLUMN 80 PIC Z(7)9 SUM
009350         KOUNT IN BATCH-SUMS  IN SORT2REC.
009360         03 COLUMN 91 PIC Z(7)9 SUM
009370           MEDIA-MOUNTS IN BATCH-SUMS IN SORT2REC.
008360         03 COLUMN 99 PIC Z(7)9 SUM
008370         FORM-MOUNTS IN BATCH-SUMS IN SORT2REC.
008380         03 COLUMN 107 PIC Z(7)9 SUM
008390         CARDS-OUT IN BATCH-SUMS IN SORT2REC.
008400         03 COLUMN 115 PIC Z(7)9 SUM
008410         TERM-INT IN BATCH-SUMS IN SORT2REC.
008420         03 COLUMN 123  PIC $(7)9.99 SUM
008430        CHARGE IN BATCH-SUMS IN SORT2REC.
008980     02 TP-DETAIL LINE PLUS 1.
008990         03 COLUMN 1 PIC X(6) VALUE "TP".
009000         03 COLUMN 7 PIC Z(7).9999 SUM
009010         CPU-TIME IN TP-SUMS IN SORT2REC.
009020         03 COLUMN 21 PIC Z(6).9  SUM
009030         ELAP-TIME IN TP-SUMS IN SORT2REC.
009040         03 COLUMN 29 PIC Z(7)9.9 SUM
009050         RES-MIN-DP IN TP-SUMS IN SORT2REC.
009060         03 COLUMN 39 PIC Z(7)9.9 SUM
009070         RES-MIN-MT IN TP-SUMS IN SORT2REC.
009080         03 COLUMN 49 PIC Z(7)9.9 SUM
009090         PAGE-MINS IN TP-SUMS IN SORT2REC.
009100         03 COLUMN 61 PIC Z(7)9 SUM
009110         LINES-OUT IN TP-SUMS IN SORT2REC.
009120         03 COLUMN 69 PIC Z(7)9 SUM
009130         IO-ACCESS IN TP-SUMS IN SORT2REC.
009140         03 COLUMN 80 PIC Z(7)9 SUM
009150         KOUNT IN TP-SUMS IN SORT2REC.
009160         03 COLUMN 91 PIC Z(7)9 SUM
009170           MEDIA-MOUNTS IN TP-SUMS IN SORT2REC.
008360         03 COLUMN 99 PIC Z(7)9 SUM
008370         FORM-MOUNTS IN TP-SUMS IN SORT2REC.
008380         03 COLUMN 107 PIC Z(7)9 SUM
008390         CARDS-OUT IN TP-SUMS IN SORT2REC.
008400         03 COLUMN 115 PIC Z(7)9 SUM
008410         TERM-INT IN TP-SUMS IN SORT2REC.
008420         03 COLUMN 123  PIC $(7)9.99 SUM
008430        CHARGE IN TP-SUMS IN SORT2REC.
009180     02 GHOST-DETAIL  LINE PLUS 1.
009190         03 COLUMN 1 PIC X(6) VALUE "GHOST ".
009200         03 COLUMN 7 PIC Z(7).9999 SUM
009210         CPU-TIME IN GHOST-SUMS  IN SORT2REC.
009220         03 COLUMN 21 PIC Z(6).9  SUM
009230         ELAP-TIME IN GHOST-SUMS  IN SORT2REC.
009240         03 COLUMN 29 PIC Z(7)9.9 SUM
009250         RES-MIN-DP IN GHOST-SUMS  IN SORT2REC.
009260         03 COLUMN 39 PIC Z(7)9.9 SUM
009270         RES-MIN-MT IN GHOST-SUMS  IN SORT2REC.
009280         03 COLUMN 49 PIC Z(7)9.9 SUM
009290         PAGE-MINS IN GHOST-SUMS  IN SORT2REC.
009300         03 COLUMN 61 PIC Z(7)9 SUM
009310         LINES-OUT IN GHOST-SUMS  IN SORT2REC.
009320         03 COLUMN 69 PIC Z(7)9 SUM
009330         IO-ACCESS IN GHOST-SUMS  IN SORT2REC.
009340         03 COLUMN 80 PIC Z(7)9 SUM
009350         KOUNT IN GHOST-SUMS  IN SORT2REC.
009360         03 COLUMN 91 PIC Z(7)9 SUM
009370           MEDIA-MOUNTS IN GHOST-SUMS IN SORT2REC.
008360         03 COLUMN 99 PIC Z(7)9 SUM
008370         FORM-MOUNTS IN GHOST-SUMS IN SORT2REC.
008380         03 COLUMN 107 PIC Z(7)9 SUM
008390         CARDS-OUT IN GHOST-SUMS IN SORT2REC.
008400         03 COLUMN 115 PIC Z(7)9 SUM
008410         TERM-INT IN GHOST-SUMS IN SORT2REC.
008420         03 COLUMN 123  PIC $(7)9.99 SUM
008430        CHARGE IN GHOST-SUMS IN SORT2REC.
009380     02 DASHED-LINE  LINE PLUS 1.
009390         03 COLUMN 11 PIC X(8) VALUE "--------".
009400         03 COLUMN 21 PIC X(8)   VALUE "--------".
009410         03 COLUMN 31 PIC X(8) VALUE "--------".
009420         03 COLUMN 41 PIC X(8) VALUE "--------".
009430         03 COLUMN 51 PIC X(8) VALUE "--------".
009440         03 COLUMN 60 PIC X(8) VALUE "--------".
009450         03 COLUMN 70 PIC X(8) VALUE "--------".
009460         03 COLUMN 80 PIC X(8) VALUE "--------".
009470        03 COLUMN 91 PIC X(8) VALUE "--------".
009430         03 COLUMN 99 PIC X(8) VALUE "  ------".
009440         03 COLUMN 107 PIC X(8) VALUE "  ------".
009450         03 COLUMN 115 PIC X(8) VALUE "  ------".
009460         03 COLUMN 123 PIC X(8) VALUE "  ------".
009480     02 TOTAL-DETAIL  LINE PLUS 1.
009490         03 COLUMN 1 PIC X(6) VALUE "TOTAL ".
009500         03 COLUMN 7 PIC Z(7).9999 SUM
009510         CPU-TIME IN TOTAL-SUMS  IN SORT2REC.
009520         03 COLUMN 21 PIC Z(6).9  SUM
009530         ELAP-TIME IN TOTAL-SUMS  IN SORT2REC.
009540         03 COLUMN 29 PIC Z(7)9.9 SUM
009550         RES-MIN-DP IN TOTAL-SUMS  IN SORT2REC.
009560         03 COLUMN 39 PIC Z(7)9.9 SUM
009570         RES-MIN-MT IN TOTAL-SUMS  IN SORT2REC.
009580         03 COLUMN 49 PIC Z(7)9.9 SUM
009590         PAGE-MINS IN TOTAL-SUMS  IN SORT2REC.
009600         03 COLUMN 61 PIC Z(7)9 SUM
009610         LINES-OUT IN TOTAL-SUMS  IN SORT2REC.
009620         03 COLUMN 69 PIC Z(7)9 SUM
009630         IO-ACCESS IN TOTAL-SUMS  IN SORT2REC.
009640         03 COLUMN 80 PIC Z(7)9 SUM
009650         KOUNT IN TOTAL-SUMS  IN SORT2REC.
009660         03 COLUMN 91 PIC Z(7)9 SUM
009670           MEDIA-MOUNTS IN TOTAL-SUMS IN SORT2REC.
008360         03 COLUMN 99 PIC Z(7)9 SUM
008370         FORM-MOUNTS IN TOTAL-SUMS IN SORT2REC.
008380         03 COLUMN 107 PIC Z(7)9 SUM
008390         CARDS-OUT IN TOTAL-SUMS IN SORT2REC.
008400         03 COLUMN 115 PIC Z(7)9 SUM
008410         TERM-INT IN TOTAL-SUMS IN SORT2REC.
008420         03 COLUMN 123  PIC $(7)9.99 SUM
008430        CHARGE IN TOTAL-SUMS IN SORT2REC.
009680     02 DASHED-LINE1 LINE PLUS 1.
009690         03 COLUMN 11 PIC X(8) VALUE "========".
009700         03 COLUMN 21 PIC X(8)   VALUE "========".
009710         03 COLUMN 31 PIC X(8) VALUE "========".
009720         03 COLUMN 41 PIC X(8) VALUE "========".
009730         03 COLUMN 51 PIC X(8) VALUE "========".
009740         03 COLUMN 60 PIC X(8) VALUE "========".
009750         03 COLUMN 70 PIC X(8) VALUE "========".
009760         03 COLUMN 80 PIC X(8) VALUE "========".
009770        03 COLUMN 91 PIC X(8) VALUE "========".
009430         03 COLUMN 99 PIC X(8) VALUE "  ======".
009440         03 COLUMN 107 PIC X(8) VALUE "  ======".
009450         03 COLUMN 115 PIC X(8) VALUE "  ======".
009460         03 COLUMN 123 PIC X(8) VALUE "  ======".
009780     02 DASHED-LINE2 LINE PLUS 1.
009790         03 COLUMN 11 PIC X(8) VALUE "========".
009800         03 COLUMN 21 PIC X(8)   VALUE "========".
009810         03 COLUMN 31 PIC X(8) VALUE "========".
009820         03 COLUMN 41 PIC X(8) VALUE "========".
009830         03 COLUMN 51 PIC X(8) VALUE "========".
009840         03 COLUMN 60 PIC X(8) VALUE "========".
009850         03 COLUMN 70 PIC X(8) VALUE "========".
009860         03 COLUMN 80 PIC X(8) VALUE "========".
009870        03 COLUMN 91 PIC X(8) VALUE "========".
009430         03 COLUMN 99 PIC X(8) VALUE "  ======".
009440         03 COLUMN 107 PIC X(8) VALUE "  ======".
009450         03 COLUMN 115 PIC X(8) VALUE "  ======".
009460         03 COLUMN 123 PIC X(8) VALUE "  ======".
009880 PROCEDURE DIVISION.
009890 CONTROLIT SECTION.
009900 START-PROGRAM.
           MOVE 0 TO BYTE.
           MOVE 0 TO HALF.
009920     OPEN INPUT DATER.
009930      DISPLAY "START"
009940        UPON PRINTER.
009950 READ-COMMANDS.
009960     MOVE SPACES TO COMMAND-RECORD.
009970     READ DATER AT END
009980        DISPLAY " +CARD(S) MISSING OR OUT OF SEQUENCE"
010000        UPON PRINTER
010010        STOP RUN.
010020     IF COMMAND-PLUS = "+DATE"
              MOVE 1 TO DATE-FLAG
010030        PERFORM READ-DATA-CARD
              MOVE HEADING-DATE-START TO THEADING-DATE-START
              MOVE HEADING-DATE-END TO THEADING-DATE-END
              MOVE "00:00:00.00" TO ZTIME
010040        CALL "CONTDAT" USING MINDAY ZTIME THEADING-DATE-START
              MOVE "23:59:59.99" TO ZTIME
010050        CALL "CONTDAT" USING MAXDAY ZTIME THEADING-DATE-END
010060        MOVE JMONTH-TGD TO MONTH-TGD
010070        DISPLAY DATE-CONTROL
010080        UPON PRINTER
010090        GO TO READ-COMMANDS
010100        ELSE
010110        IF COMMAND-PLUS = "+HEAD"
010120            PERFORM READ-DATA-CARD
010130            MOVE HEADING-DATE-START TO STARTING-DATE IN TITLE3
010140            MOVE HEADING-DATE-END TO ENDING-DATE
010150            GO TO READ-COMMANDS
010160            ELSE
010170            IF COMMAND-PLUS = "+RATE"
010180                PERFORM READ-DATA-CARD
                      IF COMMAND-PLUS = "SYSTE"
                      MOVE 1 TO RATE-FLAG
                      GO TO READ-COMMANDS
                      ELSE
                      MOVE 0 TO RATE-FLAG
010190                MOVE CORR RATE-RECORD TO RATE-SCHEDULE
010200                GO TO READ-COMMANDS
010210                ELSE
010220                IF COMMAND-PLUS = "+LIST"
010230                    PERFORM SEARCH-TABLE-BUILDER
010240                    GO TO READ-COMMANDS
010250                    ELSE
                          IF COMMAND-PLUS = "+GAC"
                              CALL "XFF_7INITL"
                              MOVE 1 TO GAC-FLAG
                              GO TO READ-COMMANDS
                              ELSE
010260                    IF COMMAND-PLUS NOT EQUAL TO "+RUN "
010270                        DISPLAY " UNDEFINED COMMAND IGNORED: "
                              COMMAND-PLUS
010280                        UPON PRINTER
010290                        GO TO READ-COMMANDS.
010300     CLOSE DATER.
010310     OPEN INPUT ACCTLG .
010320     OPEN OUTPUT PHASEA JOBSRUN.
010350 COMMANDS-DONE-START-WORK.
           MOVE THEADING-DATE-START TO STARTING-DATE IN TITLE3.
           MOVE THEADING-DATE-END TO ENDING-DATE IN TITLE3.
010360     MOVE CC-LITERAL-TABLE TO COST-CENTER-TABLE.
           IF GAC-FLAG NOT EQUAL 0
               PERFORM SORT-GAC
               GO TO DO-GAC.
           GO TO SORT-ACCT.
       SORT-GAC.
010330      DISPLAY "GACSORT1"
010340        UPON PRINTER.
010370     SORT GACFILE ASCENDING GACID IN GACREC
010390        ASCENDING GACCODE IN GACREC
              ASCENDING GACACCT IN GACREC
010400        INPUT PROCEDURE SORT-IN1
              GIVING TEMPGACFILE.
020330      DISPLAY "GACSORT2"
010340        UPON PRINTER.
010370     SORT GACFILE ASCENDING GACACCT IN GACREC
010400        INPUT PROCEDURE SORT-IN2
              GIVING NEWGACFILE.
       SORT-ACCT.
010330      DISPLAY "SORT1"
010340        UPON PRINTER.
010370     SORT SORT1FILE ASCENDING ZUSERNAME IN SORT1REC
010380        ASCENDING BATCH-FLAG IN SORT1REC
010390        ASCENDING ZSTART IN SORT1REC
010400        INPUT PROCEDURE RAW-INPUT
010410        OUTPUT PROCEDURE SUM-RAW.
              CLOSE JOBSRUN.
010420     IF JOBS-IN-ERROR = 0
010430        DISPLAY " NO RECORDS SELECTED FOR DATE SPECIFIED"
010440        UPON PRINTER
010450        DISPLAY " **** RUN TERMINATED ****"
010460        UPON PRINTER
010470        STOP RUN.
010480     MOVE ZERO TO JOBS-IN-ERROR.
010490     DISPLAY "SORT2"
010500        UPON PRINTER.
010510     SORT SORT2FILE
010520        ASCENDING DEPART-TITLE IN SORT2REC
010530        ASCENDING USER-NAME IN SORT2REC
010540        USING PHASEA
010550        OUTPUT PROCEDURE DETAIL-REPORT.
010560*    DISPLAY "SORT3"
010570*       UPON PRINTER.
010580*    SORT SORT2FILE
010590*       DESCENDING CPU-TIME IN TOTAL-SUMS IN SORT2REC
010600*       USING PHASEB
010610*       OUTPUT PROCEDURE SUMMARY-REPORT.
010620     IF SELECT-FLAG NOT EQUAL TO "NULL"
010630        DISPLAY "BEGINING DETAIL REPORT"
010640        UPON PRINTER
              SORT SORT1FILE ASCENDING ZACCT IN SORT1REC
                 ZUSERNAME IN SORT1REC
                 ZSTART IN SORT1REC
                 USING JOBSRUN
                 GIVING JOBSRUN
010650        PERFORM JD-OPEN THRU DUMMY-EXIT
010660        ELSE
010670        DISPLAY "NO DETAIL REPORT DONE"
010680        UPON PRINTER.
       DO-GAC.
010620     IF GAC-FLAG NOT EQUAL TO 0
010630        DISPLAY "BEGINING GAC REPORT"
010640        UPON PRINTER
010650        PERFORM GAC-OPEN THRU GAC-DUMMY-EXIT
010660        ELSE
010670        DISPLAY "NO GAC REPORT DONE"
010680        UPON PRINTER.
010690     STOP RUN.
010700 SEARCH-TABLE-BUILDER.
010710     READ DATER AT END
010720        DISPLAY "MAX TABLE VALUE MISSING"
010730        UPON PRINTER
010740        STOP RUN.
010750* DETAIL REPORT OF ALL JOBS RUN WILL BE PRINTED
010760* IF AKOUNT IS "ALL".....WARNING!!!!!!!!!!!!!!!
010770* THIS PRODUCES A HORRENDOUS AMOUNT OF OUTPUT!!
010780* USE ONLY ON SPECIAL OCCASIONS................
010790*
010800     IF AKOUNT = "ALL     "
010810        MOVE -1 TO MAX-VALUE
010820        ELSE
010830        IF AKOUNT = "NONE    "
010840            MOVE 0 TO MAX-VALUE
010850            ELSE
010860            MOVE JSTART-YEAR TO MAX-VALUE.
010870     SET J TO 1.
010880     PERFORM INPUT-ACCOUNT-LOOKUP MAX-VALUE TIMES.
010890 INPUT-ACCOUNT-LOOKUP.
010900     READ DATER AT END
010910        DISPLAY " ACCOUNT NOT = TABLE  "
010920        UPON PRINTER
010930        CLOSE DATER
010940        STOP RUN.
010950     MOVE AKOUNT TO ACCOUNT-ENTRY ( J ).
010960     SET J UP BY 1.
010970 READ-DATA-CARD.
010980     READ DATER AT END
010990        DISPLAY
011000        " +CARD ERROR (DATA SEGMENT" UPON PRINTER.
       SORT-IN1 SECTION.
           SET J2 TO 1.
           MOVE 0 TO GACID-MAX-VALUE.
       READGAC.
011030     READ ACCTLG AT END
011040        GO TO END-READGAC.
           MOVE ZCODE IN INPUT-ACCTLG TO BYTE-INIT.
           IF BYTE NOT EQUAL GACIDCODE
           AND BYTE NOT EQUAL PGRANSCODE
               GO TO READGAC.
           IF BYTE EQUAL TO GACIDCODE
               PERFORM MOVEGACID.
           IF BYTE EQUAL TO PGRANSCODE
               PERFORM MOVEPGRANS.
           RELEASE GACREC.
           GO TO READGAC.
       END-READGAC.
           EXIT.
       MOVEGACID.
           MOVE FLAG-G TO BYTE-INIT.
           IF BYTE > 255
               MOVE 3 TO GACCODE IN GACREC
               MOVE SYSID-G TO GACID-ENTRY(J2)
               SET J2 UP BY 1
               ADD 1 TO GACID-MAX-VALUE
               ELSE
               MOVE 1 TO GACCODE IN GACREC.
           MOVE SYSID-G TO GACID IN GACREC.
       MOVEPGRANS.
           MOVE 2 TO GACCODE IN GACREC.
           MOVE SYSID-P TO GACID IN GACREC.
           MOVE ACCT-P TO GACACCT.
           MOVE SHELF-GRAN IN PGRAN-REC
               TO SHELF-GRAN IN GACFILE.
           MOVE ONLINE-GRAN IN PGRAN-REC
               TO ONLINE-GRAN IN GACFILE.
       SORT-IN2 SECTION.
           OPEN INPUT TEMPGACFILE.
       READTEMPGAC.
           READ TEMPGACFILE AT END
               GO TO END-READTEMPGAC.
           MOVE TEMPGACID TO HALF-INIT.
           IF HALF = 0
               GO TO GOOD-GAC-REC.
           IF GACID-MAX-VALUE > 0
               SEARCH ALL GACID-ENTRY
               WHEN GACID-NO (J2) = TEMPGACID
               GO TO GOOD-GAC-REC
               ELSE
               GO TO READTEMPGAC.
       GOOD-GAC-REC.
           MOVE TEMPGACCODE TO BYTE.
           IF BYTE EQUAL 1
               MOVE ZERO TO NOBACK IN SHELF-GRAN IN GACREC
               MOVE ZERO TO BACK IN SHELF-GRAN IN GACREC
               MOVE ZERO TO STOW IN SHELF-GRAN IN GACREC
               MOVE ZERO TO NOBACK IN ONLINE-GRAN IN GACREC
               MOVE ZERO TO BACK IN ONLINE-GRAN IN GACREC
               MOVE ZERO TO STOW IN ONLINE-GRAN IN GACREC
               GO TO READTEMPGAC.
           IF BYTE EQUAL 2
               PERFORM COLLECT-PGRANS THRU COLLECT-PGRANS-END
               GO TO READTEMPGAC.
           IF BYTE EQUAL 3
               RELEASE GACREC
               GO TO READTEMPGAC.
       COLLECT-PGRANS.
           IF TEMPGACACCT = GACACCT GO TO SAME-ACCT.
           IF GACACCT NOT EQUAL " "
               RELEASE GACREC.
           MOVE ZERO TO NOBACK IN SHELF-GRAN IN GACREC.
           MOVE ZERO TO BACK IN SHELF-GRAN IN GACREC.
           MOVE ZERO TO STOW IN SHELF-GRAN IN GACREC.
           MOVE ZERO TO NOBACK IN ONLINE-GRAN IN GACREC.
           MOVE ZERO TO BACK IN ONLINE-GRAN IN GACREC.
           MOVE ZERO TO STOW IN ONLINE-GRAN IN GACREC.
       SAME-ACCT.
           MOVE NOBACK IN SHELF-GRAN IN TEMPGACREC TO B.
           MOVE NOBACK IN SHELF-GRAN IN GACREC TO C.
           CALL "ADDGAC" USING A B C.
           MOVE A TO NOBACK IN SHELF-GRAN IN GACREC.
           MOVE BACK IN SHELF-GRAN IN TEMPGACREC TO B.
           MOVE BACK IN SHELF-GRAN IN GACREC TO C.
           CALL "ADDGAC" USING A B C.
           MOVE A TO BACK IN SHELF-GRAN IN GACREC.
           MOVE STOW IN SHELF-GRAN IN TEMPGACREC TO B.
           MOVE STOW IN SHELF-GRAN IN GACREC TO C.
           CALL "ADDGAC" USING A B C.
           MOVE A TO STOW IN SHELF-GRAN IN GACREC.
           MOVE NOBACK IN ONLINE-GRAN IN TEMPGACREC TO B.
           MOVE NOBACK IN ONLINE-GRAN IN GACREC TO C.
           CALL "ADDGAC" USING A B C.
           MOVE A TO NOBACK IN ONLINE-GRAN IN GACREC.
           MOVE BACK IN ONLINE-GRAN IN TEMPGACREC TO B.
           MOVE BACK IN ONLINE-GRAN IN GACREC TO C.
           CALL "ADDGAC" USING A B C.
           MOVE A TO BACK IN ONLINE-GRAN IN GACREC.
           MOVE STOW IN ONLINE-GRAN IN TEMPGACREC TO B.
           MOVE STOW IN ONLINE-GRAN IN GACREC TO C.
           CALL "ADDGAC" USING A B C.
           MOVE A TO STOW IN ONLINE-GRAN IN GACREC.
           MOVE TEMPGACACCT TO GACACCT
       COLLECT-PGRANS-END.
       END-READTEMPGAC.
           EXIT.
011010 RAW-INPUT SECTION.
011020 READ-NEXT1.
011030     READ ACCTLG AT END
011040        GO TO ALL-DONE1.
           MOVE ZCODE IN INPUT-ACCTLG TO BYTE-INIT.
           IF BYTE NOT EQUAL TO 1
011090        GO TO READ-NEXT1.
           MOVE ZTYPE IN INPUT-ACCTLG TO BYTE-INIT.
           IF BYTE NOT EQUAL TO 2
011090        GO TO READ-NEXT1.
011100     ADD 1 TO JOBS-IN-ERROR.
           IF DATE-FLAG NOT EQUAL 0
               GO TO CHECK-DATE-END.
           IF FIRST-DATE = 0
               MOVE ZSTART IN INPUT-ACCTLG TO FIRST-DATE
               MOVE ZSTART IN INPUT-ACCTLG TO LAST-DATE.
           IF ZSTART IN INPUT-ACCTLG LESS THAN FIRST-DATE
               MOVE ZSTART IN INPUT-ACCTLG TO FIRST-DATE.
           IF ZSTART IN INPUT-ACCTLG GREATER THAN LAST-DATE
               MOVE ZSTART IN INPUT-ACCTLG TO LAST-DATE.
       CHECK-DATE-END.
011050     IF MINDAY > ZSTART IN INPUT-ACCTLG OR
011060        MAXDAY < ZSTART IN INPUT-ACCTLG
011070        GO TO READ-NEXT1.
011110     MOVE INPUT-ACCTLG TO SORT1REC.
           MOVE ZMODE IN INPUT-ACCTLG TO BYTE-INIT.
           IF BYTE = 1
011140        MOVE "B" TO BATCH-FLAG IN SORT1REC
           ELSE IF BYTE = 2
011140        MOVE "G" TO BATCH-FLAG IN SORT1REC
           ELSE IF BYTE = 3
011140        MOVE "O" TO BATCH-FLAG IN SORT1REC
           ELSE IF BYTE = 4
011140        MOVE "T" TO BATCH-FLAG IN SORT1REC
           ELSE GO TO READ-NEXT1.
011150     IF MAX-VALUE > 0
011530     MOVE ZACCT IN SORT1REC TO ACCOUNT IN QUAL-KEY
011160        SEARCH ALL ACCOUNT-ENTRY
011170        WHEN ACCT-NO ( J ) =
011180        ZACCT IN INPUT-ACCTLG
011190        WRITE JOBOUT FROM SORT1REC
011200        MOVE SPACES TO SELECT-FLAG
011210        ELSE
011220        IF MAX-VALUE < 0
011230            WRITE JOBOUT FROM SORT1REC
011240            MOVE SPACES TO SELECT-FLAG.
011250* USED ONLY IF "ALL" DETAILS ARE WANTED FOR ALL
011260* JOBS RUN FOR THE SPECIFIED PERIOD....AKOUNT WAS "ALL"
011270*
011280     RELEASE SORT1REC.
011290     GO TO READ-NEXT1.
011300 ALL-DONE1.
           IF DATE-FLAG EQUAL 0
           MOVE FIRST-DATE TO MINDAY
           CALL "CONTUTS" USING MINDAY ZTIME THEADING-DATE-START
           MOVE LAST-DATE TO MAXDAY
           CALL "CONTUTS" USING MAXDAY ZTIME THEADING-DATE-END.
011310     CLOSE ACCTLG.
011320 BYEBYE1. EXIT.
011330 SUM-RAW SECTION.
011340 SUM-RAW-START.
011350     RETURN SORT1FILE AT END GO TO ALL-OUT2.
011360     PERFORM BREAK-NAME.
011370     MOVE SUM-STORE TO ONLINE-SUMS IN PHASEAREC.
011380     MOVE SUM-STORE TO BATCH-SUMS IN PHASEAREC.
011380     MOVE SUM-STORE TO GHOST-SUMS IN PHASEAREC.
011380     MOVE SUM-STORE TO TP-SUMS IN PHASEAREC.
011390     MOVE SUM-STORE TO TOTAL-SUMS IN PHASEAREC.
011400     MOVE ACCT-TOTALS IN PHASEAREC TO OVERALL-SUMS.
011410     GO TO END-ZERO.
011420 BREAK-NAME.
011430     MOVE ZERO TO RES-MIN-MT IN SUM-STORE.
011440     MOVE ZERO TO PAGE-MINS IN SUM-STORE.
011450     MOVE ZERO TO LINES-OUT IN SUM-STORE.
011460     MOVE ZERO TO CPU-TIME IN SUM-STORE.
011470     MOVE ZERO TO ELAP-TIME IN SUM-STORE.
011480     MOVE ZERO TO IO-ACCESS IN SUM-STORE.
011490     MOVE ZERO TO RES-MIN-DP IN SUM-STORE.
011500     MOVE 0 TO KOUNT IN SUM-STORE.
011510     MOVE ZERO TO MEDIA-MOUNTS IN SUM-STORE.
011440     MOVE ZERO TO FORM-MOUNTS IN SUM-STORE.
011450     MOVE ZERO TO CARDS-OUT IN SUM-STORE.
011460     MOVE ZERO TO TERM-INT IN SUM-STORE.
011470     MOVE ZERO TO CHARGE IN SUM-STORE.
011520 END-ZERO.
011530     MOVE ZACCT IN SORT1REC TO ACCOUNT IN QUAL-KEY.
011540
011550        MOVE ZUSERNAME IN SORT1REC TO
011560        USER-NAME IN QUAL-KEY.
011570     MOVE BATCH-FLAG IN SORT1REC TO BATCH-FLAG IN QUAL-KEY.
011580 NO-BREAK.
           CALL "PAGES" USING PAGECNT CARDCNT FORMCNT SORT1REC.
           ADD PAGECNT TO LINES-OUT IN SUM-STORE.
           ADD CARDCNT TO CARDS-OUT IN SUM-STORE.
           ADD FORMCNT TO FORM-MOUNTS IN SUM-STORE.
           MOVE ZPKCO IN SORT1REC TO HALF-INIT.
011620     COMPUTE SYEAR =
011630        ZMTACCESS IN SORT1REC +
011640        ZDPACCESS IN SORT1REC +
011650        ZORACCESS IN SORT1REC .
011660     ADD SYEAR TO IO-ACCESS IN SUM-STORE.
011680     COMPUTE MEDIA-MOUNTS IN SUM-STORE =
011690        MEDIA-MOUNTS IN SUM-STORE +
011700        ZMTMOUNT IN SORT1REC +
011710        ZDPMOUNT IN SORT1REC +
011720        ZORMOUNT IN SORT1REC .
011680     COMPUTE CPU-TIME IN SUM-STORE =
011690        CPU-TIME IN SUM-STORE +
011700        ( ZPEXEC IN SORT1REC +
011710        ZPSTIME IN SORT1REC +
011720        ZUEXEC IN SORT1REC +
011730        ZUSTIME IN SORT1REC ) / 6000.0 .
011680     COMPUTE PAGE-MINS IN SUM-STORE =
011690        PAGE-MINS IN SUM-STORE +
011700        ( ZUMEMTIM IN SORT1REC +
011730        ZPMEMTIM IN SORT1REC ) / 6000.0 .
011740     COMPUTE RES-MIN-DP IN SUM-STORE =
011750        RES-MIN-DP IN SUM-STORE +
011760        ZDPTIM-CLK IN SORT1REC / 6000.0.
011740     COMPUTE RES-MIN-MT IN SUM-STORE =
011750        RES-MIN-MT IN SUM-STORE +
011760        ZMTTIM-CLK IN SORT1REC / 6000.0.
011770
011780        ADD 1 TO KOUNT IN SUM-STORE.
011790     COMPUTE ELAP-TIME IN SUM-STORE =
011800        ELAP-TIME IN SUM-STORE +
011810        ZELAPSED IN SORT1REC / 6000.0.
011680     COMPUTE TERM-INT IN SUM-STORE =
011690        TERM-INT IN SUM-STORE +
011700        ZTINTER IN SORT1REC.
011680     COMPUTE CHARGE IN SUM-STORE =
011690        CHARGE IN SUM-STORE +
011700        ZCHG IN SORT1REC.
011820
011830    TEST-BREAK.
011840     RETURN SORT1FILE AT END GO TO BROKEN.
011850     IF ZUSERNAME IN SORT1REC IS NOT EQUAL TO
011860        USER-NAME IN QUAL-KEY
011870        PERFORM BROKEN
011880        GO TO BREAK-NAME.
011890     IF BATCH-FLAG IN SORT1REC IS NOT EQUAL TO
011900        BATCH-FLAG IN QUAL-KEY
              PERFORM MOVE-SUM-STORE
011920        GO TO BREAK-NAME.
011930     GO TO NO-BREAK.
        MOVE-SUM-STORE.
           IF SYSTEM-RATE
               COMPUTE DOLLAR-TOTAL =
               CHARGE IN SUM-STORE / 10000
           ELSE
           PERFORM SUM-CHARGE.
           MOVE DOLLAR-TOTAL TO CHARGE IN SUM-STORE.
011950     IF BATCH-FLAG IN QUAL-KEY IS EQUAL TO "B"
011960        MOVE SUM-STORE TO BATCH-SUMS IN PHASEAREC
011950     ELSE IF BATCH-FLAG IN QUAL-KEY IS EQUAL TO "G"
011960        MOVE SUM-STORE TO GHOST-SUMS IN PHASEAREC
011950     ELSE IF BATCH-FLAG IN QUAL-KEY IS EQUAL TO "T"
011960        MOVE SUM-STORE TO TP-SUMS IN PHASEAREC
011950     ELSE IF BATCH-FLAG IN QUAL-KEY IS EQUAL TO "O"
011980        MOVE SUM-STORE TO ONLINE-SUMS IN PHASEAREC.
011940 BROKEN.
           IF SYSTEM-RATE
               COMPUTE DOLLAR-TOTAL =
               CHARGE IN SUM-STORE / 10000
           ELSE
           PERFORM SUM-CHARGE.
           MOVE DOLLAR-TOTAL TO CHARGE IN SUM-STORE.
011950     IF BATCH-FLAG IN QUAL-KEY IS EQUAL TO "B"
011960        MOVE SUM-STORE TO BATCH-SUMS IN PHASEAREC
011950     ELSE IF BATCH-FLAG IN QUAL-KEY IS EQUAL TO "G"
011960        MOVE SUM-STORE TO GHOST-SUMS IN PHASEAREC
011950     ELSE IF BATCH-FLAG IN QUAL-KEY IS EQUAL TO "T"
011960        MOVE SUM-STORE TO TP-SUMS IN PHASEAREC
011950     ELSE IF BATCH-FLAG IN QUAL-KEY IS EQUAL TO "O"
011980        MOVE SUM-STORE TO ONLINE-SUMS IN PHASEAREC.
011990     ADD RES-MIN-MT IN ONLINE-SUMS IN PHASEAREC
012000        RES-MIN-MT IN BATCH-SUMS IN PHASEAREC
012000        RES-MIN-MT IN GHOST-SUMS IN PHASEAREC
012000        RES-MIN-MT IN TP-SUMS IN PHASEAREC
012010        GIVING RES-MIN-MT IN TOTAL-SUMS IN PHASEAREC.
012020     ADD PAGE-MINS IN ONLINE-SUMS IN PHASEAREC
012030        PAGE-MINS IN BATCH-SUMS IN PHASEAREC
012030        PAGE-MINS IN GHOST-SUMS IN PHASEAREC
012030        PAGE-MINS IN TP-SUMS IN PHASEAREC
012040        GIVING PAGE-MINS IN TOTAL-SUMS IN PHASEAREC.
012050     ADD LINES-OUT IN ONLINE-SUMS IN PHASEAREC
012060        LINES-OUT IN BATCH-SUMS IN PHASEAREC
012060        LINES-OUT IN GHOST-SUMS IN PHASEAREC
012060        LINES-OUT IN TP-SUMS IN PHASEAREC
012070        GIVING LINES-OUT IN TOTAL-SUMS IN PHASEAREC.
012080     ADD CPU-TIME IN ONLINE-SUMS IN PHASEAREC
012090        CPU-TIME IN BATCH-SUMS IN PHASEAREC
012090        CPU-TIME IN GHOST-SUMS IN PHASEAREC
012090        CPU-TIME IN TP-SUMS IN PHASEAREC
012100        GIVING CPU-TIME IN TOTAL-SUMS IN PHASEAREC.
012110     ADD ELAP-TIME IN ONLINE-SUMS IN PHASEAREC
012120        ELAP-TIME IN BATCH-SUMS IN PHASEAREC
012120        ELAP-TIME IN GHOST-SUMS IN PHASEAREC
012120        ELAP-TIME IN TP-SUMS IN PHASEAREC
012130        GIVING ELAP-TIME IN TOTAL-SUMS IN PHASEAREC.
012140     ADD IO-ACCESS IN ONLINE-SUMS IN PHASEAREC
012150        IO-ACCESS IN BATCH-SUMS IN PHASEAREC
012150        IO-ACCESS IN GHOST-SUMS IN PHASEAREC
012150        IO-ACCESS IN TP-SUMS IN PHASEAREC
012160        GIVING IO-ACCESS IN TOTAL-SUMS IN PHASEAREC.
012170     ADD RES-MIN-DP IN ONLINE-SUMS IN PHASEAREC
012180        RES-MIN-DP IN BATCH-SUMS IN PHASEAREC
012180        RES-MIN-DP IN GHOST-SUMS IN PHASEAREC
012180        RES-MIN-DP IN TP-SUMS IN PHASEAREC
012190        GIVING RES-MIN-DP IN TOTAL-SUMS IN PHASEAREC.
012200     ADD KOUNT IN ONLINE-SUMS IN PHASEAREC
012210        KOUNT IN BATCH-SUMS IN PHASEAREC
012210        KOUNT IN GHOST-SUMS IN PHASEAREC
012210        KOUNT IN TP-SUMS IN PHASEAREC
012220        GIVING KOUNT IN TOTAL-SUMS IN PHASEAREC.
012230     ADD MEDIA-MOUNTS IN ONLINE-SUMS IN PHASEAREC
012240        MEDIA-MOUNTS IN BATCH-SUMS IN PHASEAREC
012240        MEDIA-MOUNTS IN GHOST-SUMS IN PHASEAREC
012240        MEDIA-MOUNTS IN TP-SUMS IN PHASEAREC
012250        GIVING MEDIA-MOUNTS IN TOTAL-SUMS IN PHASEAREC.
012140     ADD FORM-MOUNTS IN ONLINE-SUMS IN PHASEAREC
012150        FORM-MOUNTS IN BATCH-SUMS IN PHASEAREC
012150        FORM-MOUNTS IN GHOST-SUMS IN PHASEAREC
012150        FORM-MOUNTS IN TP-SUMS IN PHASEAREC
012160        GIVING FORM-MOUNTS IN TOTAL-SUMS IN PHASEAREC.
012170     ADD CARDS-OUT IN ONLINE-SUMS IN PHASEAREC
012180        CARDS-OUT IN BATCH-SUMS IN PHASEAREC
012180        CARDS-OUT IN GHOST-SUMS IN PHASEAREC
012180        CARDS-OUT IN TP-SUMS IN PHASEAREC
012190        GIVING CARDS-OUT IN TOTAL-SUMS IN PHASEAREC.
012200     ADD TERM-INT IN ONLINE-SUMS IN PHASEAREC
012210        TERM-INT IN BATCH-SUMS IN PHASEAREC
012210        TERM-INT IN GHOST-SUMS IN PHASEAREC
012210        TERM-INT IN TP-SUMS IN PHASEAREC
012220        GIVING TERM-INT IN TOTAL-SUMS IN PHASEAREC.
012230     ADD CHARGE IN ONLINE-SUMS IN PHASEAREC
012240        CHARGE IN BATCH-SUMS IN PHASEAREC
012240        CHARGE IN GHOST-SUMS IN PHASEAREC
012240        CHARGE IN TP-SUMS IN PHASEAREC
012250        GIVING CHARGE IN TOTAL-SUMS IN PHASEAREC.
012260     MOVE ACCOUNT IN QUAL-KEY TO ACCOUNT IN
012270        PHASEAREC.
012280     MOVE USER-NAME IN QUAL-KEY TO USER-NAME IN PHASEAREC.
012290     ADD CORR ONLINE-SUMS IN PHASEAREC TO
012300        ONLINE-SUMS IN OVERALL-SUMS.
012310     ADD CORR BATCH-SUMS IN PHASEAREC TO
012320        BATCH-SUMS IN OVERALL-SUMS.
012310     ADD CORR GHOST-SUMS IN PHASEAREC TO
012320        GHOST-SUMS IN OVERALL-SUMS.
012310     ADD CORR TP-SUMS IN PHASEAREC TO
012320        TP-SUMS IN OVERALL-SUMS.
012330     ADD CORR TOTAL-SUMS IN PHASEAREC TO
012340        TOTAL-SUMS IN OVERALL-SUMS.
012350     MOVE CC-TITLE ( 41 ) TO DEPART-TITLE IN PHASEAREC.
            SET I TO 1.
012360     SEARCH  CC-ENTRY
012370        WHEN CC-NUMBER ( I  )  =
012380        USER-COST-CENTER IN PHASEAREC
012390        MOVE CC-TITLE ( I ) TO DEPART-TITLE IN PHASEAREC.
012400     WRITE PHASEAREC.
012410     PERFORM BREAK-NAME.
012420     MOVE SUM-STORE TO ONLINE-SUMS IN PHASEAREC.
012430     MOVE SUM-STORE TO BATCH-SUMS IN PHASEAREC.
012420     MOVE SUM-STORE TO GHOST-SUMS IN PHASEAREC.
012430     MOVE SUM-STORE TO TP-SUMS IN PHASEAREC.
012440     MOVE SUM-STORE TO TOTAL-SUMS IN PHASEAREC.
012450     MOVE ZERO TO LPFJ.
012460     MOVE ZERO TO LAST-BYTE.
012470 ALL-OUT2.
012480     CLOSE PHASEA.
012490 BYEBYE2. EXIT.
012500 DETAIL-REPORT SECTION.
012510 START-DETAIL-REPORT.
012520     OPEN OUTPUT PRINTR PHASEB.
012530     INITIATE DEPT-DETAIL.
012540     RETURN SORT2FILE AT END GO TO END-DETAIL.
012550     PERFORM BREAK2.
012560 NEXT-DETAIL-LINE.
012680
012690        GENERATE ACCT-VAL.
012700     RETURN SORT2FILE AT END GO TO BREAK4.
012710     IF DEPART-TITLE IN SORT2REC IS EQUAL TO
012720        DEPART-TITLE IN PHASEBREC
012730        ADD CORR ONLINE-SUMS IN SORT2REC
012740        TO ONLINE-SUMS IN PHASEBREC
012750        ADD CORR BATCH-SUMS IN SORT2REC
012760        TO BATCH-SUMS IN PHASEBREC
012730        ADD CORR GHOST-SUMS IN SORT2REC
012740        TO GHOST-SUMS IN PHASEBREC
012750        ADD CORR TP-SUMS IN SORT2REC
012760        TO TP-SUMS IN PHASEBREC
012770        ADD CORR TOTAL-SUMS IN SORT2REC TO
012780        TOTAL-SUMS IN PHASEBREC
012790        GO TO NEXT-DETAIL-LINE.
012800     WRITE PHASEBREC.
012810 BREAK2.
012820     MOVE SPACES TO ACCOUNT IN PHASEBREC.
012830     MOVE SPACES TO USER-NAME IN PHASEBREC.
012840     MOVE SORT2REC TO PHASEBREC.
012850 BREAK3. GO TO NEXT-DETAIL-LINE.
012860 BREAK4.
012870     WRITE PHASEBREC.
012880 END-DETAIL.
012890     TERMINATE DEPT-DETAIL.
012900     CLOSE PRINTR PHASEB.
012910*SUMMARY-REPORT SECTION.
012920*START-SUMMARY-REPORT.
012930*    OPEN OUTPUT PRINTR2.
012940*    INITIATE DEPT-SUMMARY.
012950*NEXT-SUMMARY.
012960*    RETURN SORT2FILE AT END GO TO END-SUMMARY.
012970*    COMPUTE RES-MIN-DP IN ONLINE-SUMS IN SORT2REC
012980*       = RES-MIN-DP IN ONLINE-SUMS IN SORT2REC
012990*       / 60000.0
013000*    / CPU-TIME IN ONLINE-SUMS IN SORT2REC.
013010*    COMPUTE RES-MIN-DP IN BATCH-SUMS IN SORT2REC
013020*       = RES-MIN-DP IN BATCH-SUMS IN SORT2REC
013030*       / 60000.0
013040*    / CPU-TIME IN BATCH-SUMS IN SORT2REC.
012970*    COMPUTE RES-MIN-DP IN GHOST-SUMS IN SORT2REC
012980*       = RES-MIN-DP IN GHOST-SUMS IN SORT2REC
012990*       / 60000.0
013000*    / CPU-TIME IN GHOST-SUMS IN SORT2REC.
013010*    COMPUTE RES-MIN-DP IN TP-SUMS IN SORT2REC
013020*       = RES-MIN-DP IN TP-SUMS IN SORT2REC
013030*       / 60000.0
013040*    / CPU-TIME IN TP-SUMS IN SORT2REC.
013050*    COMPUTE PERCENT-CPU-BATCH ROUNDED = 100.0 *
013060*    CPU-TIME IN BATCH-SUMS IN SORT2REC /
013070*       CPU-TIME IN BATCH-SUMS IN OVERALL-SUMS.
013080*    COMPUTE PERCENT-CPU-TS ROUNDED = 100.0 *
013090*    CPU-TIME IN ONLINE-SUMS IN SORT2REC /
013100*       CPU-TIME IN ONLINE-SUMS IN OVERALL-SUMS.
013050*    COMPUTE PERCENT-CPU-TP ROUNDED = 100.0 *
013060*    CPU-TIME IN TP-SUMS IN SORT2REC /
013070*       CPU-TIME IN TP-SUMS IN OVERALL-SUMS.
013080*    COMPUTE PERCENT-CPU-GHOST ROUNDED = 100.0 *
013090*    CPU-TIME IN GHOST-SUMS IN SORT2REC /
013100*       CPU-TIME IN GHOST-SUMS IN OVERALL-SUMS.
013110*    DIVIDE 60.0 INTO CPU-TIME IN BATCH-SUMS IN SORT2REC
013120*    CPU-TIME IN ONLINE-SUMS IN SORT2REC
013120*    CPU-TIME IN GHOST-SUMS IN SORT2REC
013120*    CPU-TIME IN TP-SUMS IN SORT2REC.
013130*    GENERATE DEPT-SUMM.
013140*    GO TO NEXT-SUMMARY.
013150*END-SUMMARY.
013160*    IF KOUNT IN BATCH-SUMS IN OVERALL-SUMS IS = 0
013170*       COMPUTE ELAP-PER-JOB = 0
013180*       GO TO TGD-DIVIDE-TERMINATE.
013190*    COMPUTE ELAP-PER-JOB =
013200*       ELAP-TIME IN BATCH-SUMS IN OVERALL-SUMS /
013210*       KOUNT IN BATCH-SUMS IN OVERALL-SUMS.
013220*TGD-DIVIDE-TERMINATE.
013230*    DIVIDE 60.0 INTO CPU-TIME IN ONLINE-SUMS IN OVERALL-SUMS
013240*    CPU-TIME IN BATCH-SUMS IN OVERALL-SUMS
013240*    CPU-TIME IN GHOST-SUMS IN OVERALL-SUMS
013240*    CPU-TIME IN TP-SUMS IN OVERALL-SUMS
013250*       ELAP-TIME IN ONLINE-SUMS IN OVERALL-SUMS.
013260*    TERMINATE DEPT-SUMMARY.
013270*    CLOSE PRINTR2.
       SUM-CHARGE.
           MOVE ZERO TO DOLLAR-TOTAL.
014830     MULTIPLY PAGE-MINS-RATE IN RATE-SCHEDULE BY PAGE-MINS IN
014840        SUM-STORE GIVING DOLLAR.
014860     ADD DOLLAR TO DOLLAR-TOTAL .
014830     MULTIPLY RES-MIN-DP-RATE IN RATE-SCHEDULE BY RES-MIN-DP IN
014840        SUM-STORE GIVING DOLLAR.
014860     ADD DOLLAR TO DOLLAR-TOTAL .
014830     MULTIPLY RES-MIN-MT-RATE IN RATE-SCHEDULE BY RES-MIN-MT IN
014840        SUM-STORE GIVING DOLLAR.
014860     ADD DOLLAR TO DOLLAR-TOTAL .
014910     MULTIPLY PAGES-PRINTED-RATE IN RATE-SCHEDULE BY LINES-OUT
014920        OF SUM-STORE GIVING DOLLAR
014940     ADD DOLLAR TO DOLLAR-TOTAL .
014950     MULTIPLY IO-ACCESS-RATE IN RATE-SCHEDULE BY IO-ACCESS IN
014960        SUM-STORE GIVING DOLLAR
014980     ADD DOLLAR TO DOLLAR-TOTAL .
015010     MULTIPLY CPU-TIME-RATE IN RATE-SCHEDULE BY
015020        CPU-TIME IN SUM-STORE GIVING DOLLAR.
015040     ADD DOLLAR TO DOLLAR-TOTAL .
           IF BATCH-FLAG IN QUAL-KEY = "O"
015070     MULTIPLY ELAPSED-TIME-RATE IN RATE-SCHEDULE BY
015080        ELAP-TIME IN SUM-STORE GIVING DOLLAR
015100        ADD DOLLAR TO DOLLAR-TOTAL .
015110     MULTIPLY MEDIA-MOUNT-RATE IN RATE-SCHEDULE BY MEDIA-MOUNTS
015120        IN SUM-STORE GIVING
015130        DOLLAR .
015150     ADD DOLLAR-TOTAL TO OVERALL-DOLR-TOTAL.
015160     ADD DOLLAR TO DOLLAR-TOTAL .
014830     MULTIPLY FORM-MOUNTS-RATE IN RATE-SCHEDULE BY FORM-MOUNTS IN
014840        SUM-STORE GIVING DOLLAR.
014860     ADD DOLLAR TO DOLLAR-TOTAL .
014910     MULTIPLY CARDS-OUT-RATE IN RATE-SCHEDULE BY CARDS-OUT
014920        OF SUM-STORE GIVING DOLLAR
014940     ADD DOLLAR TO DOLLAR-TOTAL .
014950     MULTIPLY TERM-INT-RATE IN RATE-SCHEDULE BY TERM-INT IN
014960        SUM-STORE GIVING DOLLAR
014980     ADD DOLLAR TO DOLLAR-TOTAL .
013280 JOB-DETAIL SECTION.
013290 JD-OPEN.
013310     OPEN INPUT JOBSRUN OUTPUT PRINTR1.
013320     MOVE ALL SPACES TO LINE-OUT.
013330     MOVE ZEROES TO KOUNT IN TOTAL-SUMS IN OVERALL-SUMS.
013340     MOVE ZEROES TO RES-MIN-MT IN TOTAL-SUMS IN OVERALL-SUMS
013350        MOVE ZEROES TO RES-MIN-DP IN TOTAL-SUMS IN OVERALL-SUMS
013360        MOVE ZEROES TO LINES-OUT IN TOTAL-SUMS IN OVERALL-SUMS
013370        MOVE ZEROES TO CPU-TIME IN TOTAL-SUMS IN OVERALL-SUMS
013380        MOVE ZEROES TO ELAP-TIME IN TOTAL-SUMS IN OVERALL-SUMS
013390        MOVE ZEROES TO IO-ACCESS IN TOTAL-SUMS IN OVERALL-SUMS.
013400     MOVE ZEROES TO MEDIA-MOUNTS IN TOTAL-SUMS IN OVERALL-SUMS.
013410     MOVE RES-MIN-DP-RATE IN RATE-SCHEDULE TO DP-RATE.
013430     MOVE PAGES-PRINTED-RATE IN RATE-SCHEDULE TO LP-RATE.
013440     MOVE IO-ACCESS-RATE IN RATE-SCHEDULE TO I-O-RATE.
013450     MOVE CPU-TIME-RATE IN RATE-SCHEDULE TO CPU.
013460     MOVE ELAPSED-TIME-RATE IN RATE-SCHEDULE TO ELAP-RATE.
013470     MOVE MEDIA-MOUNT-RATE IN RATE-SCHEDULE TO TAPE-RATE.
013480 MAIN-HEADINGS.
013490     MOVE 0 TO LINECOUNTER.
013500     MOVE ALL " " TO LINE-OUT.
013510     MOVE " " TO CARRIAGE-CONTROL-BYTE.
013520     WRITE LINE-OUT AFTER ADVANCING TOP-OF-PAGE.
013530     MOVE SPACES TO LINE-OUT TITLE.
013540     MOVE TITLE1 TO LINE1.
013550     MOVE TITLE TO LINE-OUT.
013560     WRITE LINE-OUT AFTER ADVANCING 4 LINES.
013570     ADD 4 TO LINECOUNTER.
013580     MOVE SPACES TO TITLE.
013590     MOVE TITLE2 TO LINE1 .
013600     MOVE TITLE TO LINE-OUT.
013610     WRITE LINE-OUT AFTER ADVANCING 1 LINE.
013620     ADD 1 TO LINECOUNTER.
013630     MOVE SPACES TO TITLE.
013640     MOVE TITLE3 TO LINE1.
013650     WRITE LINE-OUT FROM TITLE AFTER ADVANCING 1 LINE.
013660     ADD 1 TO LINECOUNTER.
013670 MAIN-HEAD-END.
013680     PERFORM SECONDARY-HEADINGS.
013690     GO TO JD-READ.
013700 SECONDARY-HEADINGS.
013710     MOVE SPACES TO LINE-OUT.
013720     WRITE LINE-OUT FROM TITLE4 AFTER ADVANCING 2 LINES.
013730     ADD 2 TO LINECOUNTER.
013740     MOVE SPACES TO LINE-OUT.
013750     WRITE LINE-OUT FROM TITLE5 AFTER ADVANCING 1 LINE.
013760     ADD 1 TO LINECOUNTER.
013770     MOVE SPACES TO LINE-OUT.
013780     WRITE LINE-OUT AFTER ADVANCING 2 LINES.
013790     ADD 2 TO LINECOUNTER.
013800 JD-READ.
013810     READ JOBSRUN INTO SORT1REC AT END
013820        GO TO ACCOUNT-END.
013830     MOVE ZACCT IN SORT1REC TO ACCOUNT IN QUAL-KEY.
013840 JD-SUMMARY.
013850     PERFORM BREAK-NAME.
013860     MOVE ZEROES TO LPFJ.
013870     MOVE SPACES TO DETAIL-LINE-1.
013880     PERFORM NO-BREAK.
013890     PERFORM JOB-DETAILING.
013900 ACCT-LINE-DETAIL.
013910     WRITE LINE-OUT FROM DETAIL-LINE-1
013920        AFTER ADVANCING 1 LINES.
013930     ADD 1 TO LINECOUNTER.
013940     READ JOBSRUN INTO SORT1REC AT END
013950        GO TO ACCOUNT-END.
013960     IF ZACCT IN SORT1REC NOT EQUAL TO ACCOUNT IN QUAL-KEY
013970        PERFORM ACCOUNT-END
013980        PERFORM BREAK-NAME
013990        MOVE SUM-STORE TO TOTAL-SUMS IN OVERALL-SUMS
014000        PERFORM NO-BREAK
014010        PERFORM JOB-DETAILING
014020        MOVE ZACCT IN SORT1REC TO ACCOUNT IN QUAL-KEY
014030        PERFORM MAIN-HEADINGS
014040        PERFORM SECONDARY-HEADINGS
014050        GO TO ACCT-LINE-DETAIL.
014060 PAGER-ROUTINE.
014070     IF LINECOUNTER > 50
014080        MOVE 0 TO LINECOUNTER
014090        MOVE SPACES TO LINE-OUT
014100        WRITE LINE-OUT AFTER ADVANCING TOP-OF-PAGE
014110        PERFORM SECONDARY-HEADINGS.
014120     GO TO JD-SUMMARY.
014130 JOB-DETAILING.
           MOVE ZSTART IN SORT1REC TO MINDAY.
           CALL "CONTUTS" USING MINDAY ZTIME THEADING-DATE-START.
           MOVE THEADING-DATE-START TO YEAR-COLUMN.
           MOVE ZTIME TO TIME-COLUMN.
014190     MOVE ZTSLINE IN SORT1REC TO HEXVALUE.
           CALL "BINTHEX" USING HEXVALUE HEXSTRING.
           MOVE HEXSTRING TO ZPORT IN LINE-NUMBER-COLUMN.
           MOVE ZFEX IN SORT1REC TO BYTE-INIT.
           SET J1 TO BYTE.
           SET J1 UP BY 1.
           MOVE HEXTABLE(J1) TO ZFEP IN LINE-NUMBER-COLUMN.
           MOVE "-" TO ZSPEED IN LINE-NUMBER-COLUMN.
           MOVE ZMODE IN SORT1REC TO BYTE-INIT.
           IF BYTE = 1
014220        MOVE " BATCH" TO BATCH-JOB.
           IF BYTE = 2
024220        MOVE " GHOST" TO BATCH-JOB.
014230     MOVE ZACCT IN SORT1REC TO ACCOUNT IN JOB-ID-COLUMN.
014240     MOVE ZUSERNAME IN SORT1REC TO USER-NAME IN JOB-ID-COLUMN.
014250     MOVE RES-MIN-MT IN SUM-STORE TO RES-MIN-MT-COLUMN.
014260     MOVE RES-MIN-DP IN SUM-STORE TO RES-MIN-DP-COLUMN.
014270     MOVE LINES-OUT IN SUM-STORE TO PAGES-PRINTED-COLUMN
014280        MOVE CPU-TIME IN SUM-STORE TO CPU-TIME-COLUMN.
           IF ELAP-TIME IN SUM-STORE < 1
               MOVE 1 TO ELAP-TIME IN SUM-STORE.
014290     MOVE ELAP-TIME IN SUM-STORE TO ELAPSED-TIME-COLUMN.
           MOVE PAGE-MINS IN SUM-STORE TO PAGE-MIN-COLUMN.
014300     MOVE IO-ACCESS IN SUM-STORE TO IO-ACCESSES-COLUMN.
014310     MOVE MEDIA-MOUNTS IN SUM-STORE TO
014320        MEDIA-MOUNT-COLUMN.
014400     ADD CORR SUM-STORE TO TOTAL-SUMS IN OVERALL-SUMS.
           MOVE ZSYSID OF SORT1REC TO HALF-INIT.
           MOVE HALF TO JOB-COUNT.
014420     MOVE ZERO TO LPFJ.
014430     MOVE ZRNST OF SORT1REC TO LAST-BYTE.
014440     IF LPFJ NOT EQUAL TO ZERO
014460        ADD 1 TO JOBS-IN-ERROR.
014470 ACCOUNT-END.
014480     MOVE SPACES TO DETAIL-LINE-1.
014490     MOVE " *** ACCOUNT TOTALS: " TO JOB-ID-COLUMN.
014500     MOVE SPACES TO LINE-OUT.
014510     WRITE LINE-OUT FROM DASH-LINE AFTER ADVANCING 1 LINE.
           MOVE RES-MIN-DP IN TOTAL-SUMS IN OVERALL-SUMS TO
               RES-MIN-DP-COLUMN.
           MOVE RES-MIN-MT IN TOTAL-SUMS IN OVERALL-SUMS TO
               RES-MIN-MT-COLUMN.
014560     MOVE LINES-OUT IN TOTAL-SUMS IN OVERALL-SUMS TO
014570        PAGES-PRINTED-COLUMN.
014580     MOVE CPU-TIME IN TOTAL-SUMS IN OVERALL-SUMS TO
014590        CPU-TIME-COLUMN.
014600     MOVE ELAP-TIME IN TOTAL-SUMS IN OVERALL-SUMS TO
014610        ELAPSED-TIME-COLUMN.
014620     MOVE IO-ACCESS IN TOTAL-SUMS IN OVERALL-SUMS TO
014630        IO-ACCESSES-COLUMN.
014640     MOVE MEDIA-MOUNTS IN TOTAL-SUMS IN
014650        OVERALL-SUMS TO
014660        MEDIA-MOUNT-COLUMN.
014640     MOVE PAGE-MINS IN TOTAL-SUMS IN
014650        OVERALL-SUMS TO
014660        PAGE-MIN-COLUMN.
014670     WRITE LINE-OUT FROM DETAIL-LINE-1 AFTER
014680        ADVANCING 2 LINES.
014690     MOVE SPACES TO DETAIL-LINE-1.
014700     MOVE " *** NUMBER OF JOBS: " TO JOB-ID-COLUMN.
014710     MOVE KOUNT IN TOTAL-SUMS IN OVERALL-SUMS TO
014720        LINE-NUMBER-COLUMN.
014730     WRITE LINE-OUT FROM DETAIL-LINE-1 AFTER
014740        ADVANCING 2 LINES.
014750     MOVE SPACES TO LINE-OUT.
014760     MOVE SPACES TO DETAIL-LINE-1.
014770     MOVE "  %  JOBS IN ERROR: " TO JOB-ID-COLUMN.
014780     COMPUTE ERROR-JOB =
014790        (JOBS-IN-ERROR / KOUNT IN TOTAL-SUMS
014800        IN OVERALL-SUMS) * 100.
014810     WRITE LINE-OUT FROM DETAIL-LINE-1 AFTER 2 LINES.
014820     MOVE SPACES TO DETAIL-LINE-1.
014830     MULTIPLY RES-MIN-DP-RATE IN RATE-SCHEDULE BY RES-MIN-DP IN
014840        TOTAL-SUMS IN OVERALL-SUMS GIVING DOLLAR.
014850     MOVE DOLLAR TO RES-MIN-DP-CHARGE.
014860     ADD DOLLAR TO DOLLAR-TOTAL .
014910     MULTIPLY PAGES-PRINTED-RATE IN RATE-SCHEDULE BY LINES-OUT
014920        OF TOTAL-SUMS IN OVERALL-SUMS GIVING DOLLAR
014930        MOVE DOLLAR TO PAGES-PRINTED-CHARGE.
014940     ADD DOLLAR TO DOLLAR-TOTAL .
014950     MULTIPLY IO-ACCESS-RATE IN RATE-SCHEDULE BY IO-ACCESS IN
014960        TOTAL-SUMS IN OVERALL-SUMS GIVING DOLLAR
014970        MOVE DOLLAR TO IO-ACCESSES-CHARGE.
014980     ADD DOLLAR TO DOLLAR-TOTAL .
014990     DIVIDE CPU-TIME IN TOTAL-SUMS IN OVERALL-SUMS BY 60
015000        GIVING TVALUE.
015010     MULTIPLY CPU-TIME-RATE IN RATE-SCHEDULE BY TVALUE
015020        GIVING DOLLAR.
015030     MOVE DOLLAR TO CPU-TIME-CHARGE.
015040     ADD DOLLAR TO DOLLAR-TOTAL .
015050     DIVIDE ELAP-TIME IN TOTAL-SUMS IN OVERALL-SUMS BY 60
015060        GIVING TVALUE.
015070     MULTIPLY ELAPSED-TIME-RATE IN RATE-SCHEDULE BY TVALUE
015080        GIVING DOLLAR.
015090     MOVE DOLLAR TO ELAPSED-TIME-CHARGE.
015100     ADD DOLLAR TO DOLLAR-TOTAL .
015110     MULTIPLY MEDIA-MOUNT-RATE IN RATE-SCHEDULE BY MEDIA-MOUNTS
015120        IN TOTAL-SUMS IN OVERALL-SUMS GIVING
015130        DOLLAR .
015140     MOVE DOLLAR TO MEDIA-MOUNT-CHARGE.
015150     ADD DOLLAR-TOTAL TO OVERALL-DOLR-TOTAL.
015160     ADD DOLLAR TO DOLLAR-TOTAL .
015170     MOVE "  ESTIMATED COST OF COMPUTING SERVICES:----->----->"
015180        TO LINE-OUT.
015190     WRITE LINE-OUT AFTER 2.
015200     MOVE SPACES TO LINE-OUT.
015210     WRITE LINE-OUT FROM CHARGE-LINE BEFORE 2.
015220     MOVE SPACES TO LINE-OUT CHARGE-LINE.
015230     MOVE DOLLAR-TOTAL TO MONEY.
015240     WRITE LINE-OUT FROM TOTAL-LINE AFTER 2.
015250     MOVE SPACES TO LINE-OUT CHARGE-LINE.
015260     MOVE ZERO TO DOLLAR DOLLAR-TOTAL.
015270     WRITE LINE-OUT FROM DISPLAY-RATE-RECORD AFTER 1.
015280     MOVE ALL " " TO LINE-OUT.
015290     MOVE " ACCOUNT END " TO ACCT-END IN LINE-OUT.
015300     MOVE " " TO CARRIAGE-CONTROL-BYTE.
015310     WRITE LINE-OUT AFTER 1.
015320     MOVE SPACES TO LINE-OUT.
015330* FORCE SKIP TO TOP OF PAGE FOR NEXT ACCOUNT SUMMARY
015340     MOVE 55 TO LINECOUNTER.
015350     MOVE 0 TO JOBS-IN-ERROR.
015360  CLOSING-IT-UP.
           MOVE OVERALL-DOLR-TOTAL TO MONEY.
015380     MOVE SPACES TO LINE-OUT.
015390     WRITE LINE-OUT AFTER ADVANCING TOP-OF-PAGE.
015400     MOVE " TOTAL FOR SELECTED ACCOUNTS:" TO
015410        NOTE-1 IN TOTAL-LINE.
015420     WRITE LINE-OUT FROM TOTAL-LINE AFTER 2.
015430     CLOSE JOBSRUN PRINTR1.
       DUMMY-EXIT. EXIT.
013280 GAC-DETAIL SECTION.
013290 GAC-OPEN.
           CLOSE NEWGACFILE.
013310     OPEN INPUT NEWGACFILE OUTPUT PRINTR1.
013320     MOVE ALL SPACES TO LINE-OUT.
013480 GAC-MAIN-HEADINGS.
013490     MOVE 0 TO LINECOUNTER.
013500     MOVE ALL " " TO LINE-OUT.
013510     MOVE " " TO CARRIAGE-CONTROL-BYTE.
013520     WRITE LINE-OUT AFTER ADVANCING TOP-OF-PAGE.
013530     MOVE SPACES TO LINE-OUT TITLE.
013540     MOVE TITLE1 TO LINE1.
013550     MOVE TITLE TO LINE-OUT.
013560     WRITE LINE-OUT AFTER ADVANCING 4 LINES.
013570     ADD 4 TO LINECOUNTER.
013580     MOVE SPACES TO TITLE.
013590     MOVE TITLE20 TO LINE1 .
013600     MOVE TITLE TO LINE-OUT.
013610     WRITE LINE-OUT AFTER ADVANCING 1 LINE.
013620     ADD 1 TO LINECOUNTER.
013630     MOVE SPACES TO TITLE.
013640     MOVE TITLE3 TO LINE1.
013650     WRITE LINE-OUT FROM TITLE AFTER ADVANCING 1 LINE.
013660     ADD 1 TO LINECOUNTER.
013670 GAC-MAIN-HEAD-END.
013680     PERFORM GAC-SECOND-HEADINGS.
013690     GO TO GAC-READ.
013700 GAC-SECOND-HEADINGS.
013710     MOVE SPACES TO LINE-OUT.
013720     WRITE LINE-OUT FROM TITLE40 AFTER ADVANCING 2 LINES.
013730     ADD 2 TO LINECOUNTER.
013740     MOVE SPACES TO LINE-OUT.
013750     WRITE LINE-OUT FROM TITLE50 AFTER ADVANCING 1 LINE.
013760     ADD 1 TO LINECOUNTER.
013770     MOVE SPACES TO LINE-OUT.
013780     WRITE LINE-OUT AFTER ADVANCING 2 LINES.
013790     ADD 2 TO LINECOUNTER.
           MOVE 0 TO EOF-FLAG.
013800 GAC-READ.
013810     READ NEWGACFILE INTO NEWGACREC AT END
013820        GO TO GAC-ACCT-END.
013830     MOVE NEWGACACCT IN NEWGACREC TO ACCOUNT IN QUAL-KEY.
       NEXT-GAC-ACCT.
               MOVE ZERO TO NOBACK IN GAC-SHELF-SUMS IN GAC-ACCT-SUMS.
               MOVE ZERO TO BACK IN GAC-SHELF-SUMS IN GAC-ACCT-SUMS.
               MOVE ZERO TO STOW IN GAC-SHELF-SUMS IN GAC-ACCT-SUMS.
               MOVE ZERO TO NOBACK IN GAC-ONLINE-SUMS IN GAC-ACCT-SUMS.
               MOVE ZERO TO BACK IN GAC-ONLINE-SUMS IN GAC-ACCT-SUMS.
               MOVE ZERO TO STOW IN GAC-ONLINE-SUMS IN GAC-ACCT-SUMS.
           PERFORM GAC-SUM.
       NEXT-GAC-REC.
013940     READ NEWGACFILE INTO NEWGACREC AT END
               MOVE 1 TO EOF-FLAG
               GO TO GAC-ACCT-END.
       NEXT-GAC-SUM.
013960     IF NEWGACACCT IN NEWGACREC NOT EQUAL TO ACCOUNT IN QUAL-KEY
013970        PERFORM GAC-ACCT-END
               GO TO NEXT-GAC-ACCT.
           PERFORM GAC-SUM.
           GO TO NEXT-GAC-REC.
       GAC-ACCT-END.
           PERFORM GAC-DETAILING.
013910     WRITE LINE-OUT FROM GAC-LINE-1
013920        AFTER ADVANCING 1 LINES.
013930     ADD 1 TO LINECOUNTER.
           PERFORM GAC-PAGER-ROUTINE.
           IF EOF-FLAG NOT EQUAL 0
               GO TO GAC-END.
020        MOVE NEWGACACCT IN NEWGACREC TO ACCOUNT IN QUAL-KEY.
       GAC-SUM.
           MOVE NOBACK IN SHELF-GRAN IN NEWGACREC TO B.
           MOVE NOBACK IN GAC-SHELF-SUMS TO C.
           CALL "ADDGAC" USING A B C.
           MOVE A TO NOBACK IN GAC-SHELF-SUMS.
           MOVE BACK IN SHELF-GRAN IN NEWGACREC TO B.
           MOVE BACK IN GAC-SHELF-SUMS TO C.
           CALL "ADDGAC" USING A B C.
           MOVE A TO BACK IN GAC-SHELF-SUMS.
           MOVE STOW IN SHELF-GRAN IN NEWGACREC TO B.
           MOVE STOW IN GAC-SHELF-SUMS TO C.
           CALL "ADDGAC" USING A B C.
           MOVE A TO STOW IN GAC-SHELF-SUMS.
           MOVE NOBACK IN ONLINE-GRAN IN NEWGACREC TO B.
           MOVE NOBACK IN GAC-ONLINE-SUMS TO C.
           CALL "ADDGAC" USING A B C.
           MOVE A TO NOBACK IN GAC-ONLINE-SUMS.
           MOVE BACK IN ONLINE-GRAN IN NEWGACREC TO B.
           MOVE BACK IN GAC-ONLINE-SUMS TO C.
           CALL "ADDGAC" USING A B C.
           MOVE A TO BACK IN GAC-ONLINE-SUMS.
           MOVE STOW IN ONLINE-GRAN IN NEWGACREC TO B.
           MOVE STOW IN GAC-ONLINE-SUMS TO C.
           CALL "ADDGAC" USING A B C.
           MOVE A TO STOW IN GAC-ONLINE-SUMS.
014060 GAC-PAGER-ROUTINE.
014070     IF LINECOUNTER > 50
014080        MOVE 0 TO LINECOUNTER
014090        MOVE SPACES TO LINE-OUT
014100        WRITE LINE-OUT AFTER ADVANCING TOP-OF-PAGE
014110        PERFORM GAC-SECOND-HEADINGS.
014130 GAC-DETAILING.
014230     MOVE NEWGACACCT IN NEWGACREC TO GAC-ACCT-COL.
           MOVE BACK IN GAC-SHELF-SUMS TO A.
           CALL "CONVRT" USING A INT.
           IF INT NOT EQUAL 0 COMPUTE INT = INT / 360000.
           MOVE INT TO BACK-SHELF-COL.
           MOVE NOBACK IN GAC-SHELF-SUMS TO A.
           CALL "CONVRT" USING A INT.
           IF INT NOT EQUAL 0 COMPUTE INT = INT / 360000.
           MOVE INT TO NOBACK-SHELF-COL.
           MOVE STOW IN GAC-SHELF-SUMS TO A.
           CALL "CONVRT" USING A INT.
           IF INT NOT EQUAL 0 COMPUTE INT = INT / 360000.
           MOVE INT TO STOW-SHELF-COL.
           MOVE BACK IN GAC-ONLINE-SUMS TO A.
           CALL "CONVRT" USING A INT.
           IF INT NOT EQUAL 0 COMPUTE INT = INT / 360000.
           MOVE INT TO BACK-ONLINE-COL.
           MOVE NOBACK IN GAC-ONLINE-SUMS TO A.
           CALL "CONVRT" USING A INT.
           IF INT NOT EQUAL 0 COMPUTE INT = INT / 360000.
           MOVE INT TO NOBACK-ONLINE-COL.
           MOVE STOW IN GAC-ONLINE-SUMS TO A.
           CALL "CONVRT" USING A INT.
           MOVE INT TO STOW-ONLINE-COL.
       GAC-END.
           CLOSE NEWGACFILE PRINTR1.
       GAC-DUMMY-EXIT. EXIT.
