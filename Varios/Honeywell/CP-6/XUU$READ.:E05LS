VERSION E05

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:1    
        1        1        /*M* XUU$READ - Common update package */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*X* PLM=4,STI=0,IND=4,CTI=3,DCI=4,ECI=4,CSI=0,THI=0,DTI=0,
        9        9             ENI=4,CLM=0,SQB,NTB,MOC,CCI=3,NLB,MCL=0,EDMC */
       10       10
       11       11        /*E*
       12       12            ERROR: XUU-E$XUU#UN_SORTED-1
       13       13            MESSAGE: A previous plus record specified a range which illegally
       14       14                     overlaps the range of this plus record.
       15       15        */
       16       16        /*E*
       17       17            ERROR: XUU-E$XUU#BAD_UPDATE-1
       18       18            MESSAGE: Illegal syntax for plus record. A plus record should be:
       19       19                      +num[,num] comment
       20       20        */
       21       21        /*E*
       22       22            ERROR: XUU-E$XUU#BAD_OPEN_BITS-4
       23       23            MESSAGE: Processor error: Conflicting option flags specified to XUU$OPEN.
       24       24        */
       25       25        /*E*
       26       26            ERROR: XUU-E$XUU#NIL_OPEN_FPT-4
       27       27            MESSAGE: Processor error: Pointer to OPEN_FPT for include file is NIL.
       28       28        */
       29       29        /*E*
       30       30            ERROR: XUU-E$XUU#INCL_TOO_DEEP-2
       31       31            MESSAGE: Include file maximum nesting depth (10) has been exceeded.
       32       32        */
       33       33        /*E*
       34       34            ERROR: XUU-E$XUU#EXTRA_RECS-1
       35       35            MESSAGE: Update records found after the +END are illegal.
       36       36                     They have been ignored.
       37       37        */
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:2    
       38       38        /*E*
       39       39            ERROR: XUU-E$XUU#UPDATE_PAST_EOF-1
       40       40            MESSAGE: This update record illegally specifies a range past the
       41       41                     end of the source file. All updates following this one
       42       42                     have been ignored.
       43       43        */
       44       44        /*E*
       45       45            ERROR: XUU-E$XUU#UN_INITIALIZED-4
       46       46            MESSAGE: Processor error: XUU$READ called with no source file open.
       47       47        */
       48       48        /*E*
       49       49            ERROR: XUU-E$XUU#NO_XSA_MEM-4
       50       50            MESSAGE: XUU internal error: Not enough memory for XSA param blocks.
       51       51                     Please report this in STARLOG.
       52       52        */
       53       53        /*E*
       54       54            ERROR: XUU-E$XUU#BAD_REL-4
       55       55            MESSAGE: XUU internal error: XSA param blocks released out of order.
       56       56                     Please report this in STARLOG.
       57       57        */
       58       58        /*E*
       59       59            ERROR: XUU-E$XUU#BAD_PLUS_END-1
       60       60            MESSAGE: Illegal syntax for +END record. At least one blank must
       61       61                     separate END from any commentary on the record.
       62       62        */
       63       63        /*E*
       64       64            ERROR: XUU-E$XUU#PLUS_ONLY-1
       65       65            MESSAGE: Illegal syntax for plus record. A "+" was found with no
       66       66                     update range specified.
       67       67        */
       68       68        /*E*
       69       69            ERROR: XUU-E$XUU#BAD_RANGE-1
       70       70            MESSAGE: The ending line number of an update packet must be
       71       71                     greater than or equal to its starting line number.
       72       72        */
       73       73
       74       74        %EJECT;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:3    
       75       75        XUU$READ:PROC ( XUU_PARAM, P_BUF_ ) ALTRET;
       76       76
       77       77        %INCLUDE XUU_MACROS_C;
       78      221
       79      222        %PAGE( ARG=Includes );

               234        /*******************************************************************************
               235        *                                                                              *
               236        *        Includes              Includes                                            *
               237        *                                                                              *
               238        *******************************************************************************/

       80      242        %INCLUDE XU_MACRO_C;
       81     3348        %INCLUDE XU_PERR_C;
       82     3539        %INCLUDE XS_MACRO_C;
       83     3583        %INCLUDE CP_6;
       84     9142        %INCLUDE CP_6_SUBS;
       85     9682        %INCLUDE B_MICROPS_C;
       86     9854        %INCLUDE B_ERRORS_C;
       87    10981        %INCLUDE F$CP6V_C;
       88    11207
       89    11208        %PAGE( ARG=EQUs and SUBs );

             11220    1   /*******************************************************************************
             11221    1   *                                                                              *
             11222    1   *        EQUs and SUBs              EQUs and SUBs                                  *
             11223    1   *                                                                              *
             11224    1   *******************************************************************************/

       90    11228        %XUU_STATES;
       91    11236        %XUU_MISC;
       92    11262        %XUU$ALLOC_TYPES;
       93    11285        %SUB #MONERR = "B$TCB$->B$TCB.ALT$->B$ALT.ERR";
       94    11286        %SUB #USER_BUFFER = "USER_BUF$->BASED_BUFFER";
       95    11287        %EQU MAX_INCL_LEVEL = 10 ;
       96    11288        %EQU MAX_BUFFER_LEN = 255 ;
       97    11289        %EQU EDIT_KEY_SIZE = 3 ;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:4    
       98    11290        %EQU CLEAR_OUTPUT_FLAGS = '070770'O ;
       99    11291
      100    11292        %PAGE( ARG=Parameters );

             11304    1   /*******************************************************************************
             11305    1   *                                                                              *
             11306    1   *        Parameters              Parameters                                        *
             11307    1   *                                                                              *
             11308    1   *******************************************************************************/

      101    11312        %XUU_PARAM( FPTN=XUU_PARAM, STCLASS=" " );
      102    11747    1   DCL P_BUF_ VECTOR ALIGNED;
      103    11748
      104    11749        %PAGE( ARG=Entries );

             11761    1   /*******************************************************************************
             11762    1   *                                                                              *
             11763    1   *        Entries              Entries                                              *
             11764    1   *                                                                              *
             11765    1   *******************************************************************************/

      105    11769        %XUU_XSA_ENTRIES;
      106    11777
      107    11778        %PAGE( ARG=External Data );

             11790    1   /*******************************************************************************
             11791    1   *                                                                              *
             11792    1   *        External Data              External Data                                  *
             11793    1   *                                                                              *
             11794    1   *******************************************************************************/

      108    11798    1   DCL B$TCB$ PTR SYMREF;
      109    11799
      110    11800        %PAGE( ARG=Constant Data );

             11812    1   /*******************************************************************************
             11813    1   *                                                                              *
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:5    
             11814    1   *        Constant Data              Constant Data                                  *
             11815    1   *                                                                              *
             11816    1   *******************************************************************************/

      111    11820        %VLP_NAME( FPTN=SI_DCB_NAME, STCLASS="CONSTANT ALIGNED", NAME='M$SI' );
      112    11847        %VLP_NAME( FPTN=UI_DCB_NAME, STCLASS="CONSTANT ALIGNED", NAME='M$UI' );
      113    11874
      114    11875        %VLP_ERRCODE( FPTN=ERROR_CODE_BASE, STCLASS=CONSTANT, FCG='XU', MID='U' );
      115    11920
      116    11921        %FILE_INFO( NAME=FILE_INFO_BASE, STCLASS=CONSTANT );
      117    11955
      118    11956    1   DCL EDIT_MOPS(0:4) BIT(9) CALIGNED CONSTANT INIT(%MVZB4,%MVC1,%SES10,%INSB7,%MVC3);
      119    11957    1   DCL SEQ_MOPS(0:2) BIT(9) CALIGNED CONSTANT INIT(%INSM1,%MVZB7,%MVC1);
      120    11958    1   DCL SEARCH_TABLE(0:511) UBIN BYTE CALIGNED CONSTANT INIT
      121    11959    1    ( %#JUNK*9, %#BLANK, %#JUNK*22, %#BLANK, %#JUNK*11,
      122    11960    1    %#COMMA, %#JUNK*3, %#NUMERIC*10, %#JUNK*0 );
      123    11961
      124    11962        %PAGE( ARG=Static Data );

             11974    1   /*******************************************************************************
             11975    1   *                                                                              *
             11976    1   *        Static Data              Static Data                                      *
             11977    1   *                                                                              *
             11978    1   *******************************************************************************/

      125    11982        %FPT_READ( FPTN=READ_FPT, STCLASS=STATIC, KEYR=YES );
      126    12021
      127    12022    1   DCL XSA_PARAM_POOL_ VECTOR STATIC INIT(VECTOR(NIL));
      128    12023    1   DCL XSA_PARAM_POOL_NEXT$ PTR ALIGNED STATIC;
      129    12024
      130    12025        %FILE_INFO( NAME=SI_INFO, STCLASS=STATIC );
      131    12059        %FILE_INFO( NAME=UI_INFO, STCLASS=STATIC );
      132    12093        %FILE_INFO( NAME=SO_INFO, STCLASS=STATIC );
      133    12127        %FILE_INFO( NAME=LU_INFO, STCLASS=STATIC );
      134    12161        %FILE_INFO( NAME="INCL_INFO(0:%(MAX_INCL_LEVEL-1))", STCLASS=STATIC );
      135    12195
      136    12196    1   DCL NRECS_IN_SOURCE SBIN WORD STATIC INIT(0);
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:6    
      137    12197    1   DCL CURRENT_STATE UBIN HALF ALIGNED STATIC INIT( %#UNINITIALIZED );
      138    12198    1   DCL NEXT_UPDATE_POSITION SBIN WORD ALIGNED STATIC;
      139    12199    1   DCL SI_SKIP_COUNT SBIN WORD ALIGNED STATIC;
      140    12200    1   DCL INCL_LEVEL SBIN HALF HALIGNED STATIC;
      141    12201    1   DCL INCL_SAVE_STATE UBIN HALF ALIGNED STATIC INIT( %#UNINITIALIZED );
      142    12202    1   DCL 1 SAVED_UPDATE ALIGNED STATIC,
      143    12203    1         2 ARS UBIN BYTE CALIGNED,
      144    12204    1         2 KEY CHAR(9) CALIGNED,
      145    12205    1         2 TEXT CHAR(82) CALIGNED;
      146    12206
      147    12207        %PAGE( ARG=Based Data );

             12219    1   /*******************************************************************************
             12220    1   *                                                                              *
             12221    1   *        Based Data              Based Data                                        *
             12222    1   *                                                                              *
             12223    1   *******************************************************************************/

      148    12227        %B$TCB;
      149    12230        %B$ALT;
      150    12238        %F$DCB;
      151    12295        %XSA_PARAM( FPTN=XSA_PARAM, STCLASS=BASED );
      152    12325
      153    12326    1   DCL BASED_BUFFER CHAR( ARS ) CALIGNED BASED;
      154    12327    1   DCL BASED_CHARS CHAR( 256 ) CALIGNED BASED;
      155    12328
      156    12329        %PAGE( ARG=Local Data );

             12341    1   /*******************************************************************************
             12342    1   *                                                                              *
             12343    1   *        Local Data              Local Data                                        *
             12344    1   *                                                                              *
             12345    1   *******************************************************************************/

      157    12349        %VLP_ERRCODE( FPTN=ERROR_CODE, STCLASS=" " );
      158    12394    1   DCL GOT_RECORD BIT(1) ALIGNED;
      159    12395    1   DCL EOF BIT(1) ALIGNED;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:7    
      160    12396    1   DCL OPEN_SI BIT(1) ALIGNED;
      161    12397    1   DCL OPEN_UI BIT(1) ALIGNED;
      162    12398    1   DCL OPEN_INCL BIT(1) ALIGNED;
      163    12399    1   DCL ARS SBIN WORD ALIGNED;
      164    12400    1   DCL ERROR_SET BIT(1) ALIGNED;
      165    12401    1   DCL TEMP_INCL_LEVEL SBIN WORD ALIGNED;
      166    12402    1   DCL USER_BUF$ PTR ALIGNED;
      167    12403
      168    12404        %PAGE( ARG=XUU$READ, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:8    
             12416    1   /*******************************************************************************
             12417    1   *                                                                              *
             12418    1   *        XUU$READ              XUU$READ                                            *
             12419    1   *                                                                              *
             12420    1   *******************************************************************************/

      169    12424    1       ERROR_SET = %FALSE;
      170    12425    1       XUU_PARAM.DCB# = DCBNUM(NIL);
      171    12426    1       XUU_PARAM.LEVEL = 0;
      172    12427    1       READ_FPT.BUF_ = P_BUF_;
      173    12428    1       USER_BUF$ = VBASE( P_BUF_ );
      174    12429    1       GOT_RECORD = %FALSE;
      175    12430
      176    12431    1   READ_LOOP:
      177    12432    2       DO UNTIL GOT_RECORD;
      178    12433    2           XUU_PARAM.FLAGS = XUU_PARAM.FLAGS & %CLEAR_OUTPUT_FLAGS;
      179    12434    3           DO CASE CURRENT_STATE;
      180    12435    3           CASE ( %#UNINITIALIZED, ELSE );
      181    12436    3               CALL KILL_XUU_ERR( %E$XUU#UN_INITIALIZED );
      182    12437    3               GOTO XUU_ALTRET;
      183    12438
      184    12439    3           CASE ( %#READ_SOURCE );
      185    12440    3               XUU_PARAM.RE_ASCII_KEY.CHAR10 = ' ';
      186    12441    3               CALL READ( SI_INFO ) ALTRET ( SI_BETTER_BE_EOF );
      187    12442    3               GOT_RECORD = %TRUE;
      188    12443    3               XUU_PARAM.FLAGS.BASE# = %TRUE;
      189    12444    3               IF SI_INFO.RECORD_COUNT = NEXT_UPDATE_POSITION
      190    12445    4               THEN DO;
      191    12446    4                   CALL PRINT_SAVED_UPDATE ALTRET( XUU_ALTRET );
      192    12447    4                   CURRENT_STATE = %#READ_UPDATE;
      193    12448    4                   IF SI_SKIP_COUNT ~= 0
      194    12449    5                   THEN DO;
      195    12450    5                       CALL PRECORD( SI_INFO, SI_SKIP_COUNT ) ALTRET ( SI_SKIP_ERR );
      196    12451    5                       END;
      197    12452    4                   END;
      198    12453
      199    12454    3           CASE ( %#READ_SOURCE_NO_UPDATES );
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:9    
      200    12455    3               XUU_PARAM.RE_ASCII_KEY.CHAR10 = ' ';
      201    12456    3               CALL READ( SI_INFO ) ALTRET ( SI_BETTER_BE_EOF );
      202    12457    3               GOT_RECORD = %TRUE;
      203    12458    3               XUU_PARAM.FLAGS.BASE# = %TRUE;
      204    12459
      205    12460    3           CASE ( %#READ_FIRST_UPDATE );
      206    12461    3               XUU_PARAM.RE_ASCII_KEY.CHAR10 = '*';
      207    12462    3               CALL READ( UI_INFO ) ALTRET ( UI_READ_ERR );
      208    12463    3               XUU_PARAM.FLAGS.UP_DATE# = %TRUE;
      209    12464    3               XUU_PARAM.SEQ_REC#.UP_INCL# = UI_INFO.RECORD_COUNT;
      210    12465    3               IF ( ARS > 0 ) AND ( SUBSTR(#USER_BUFFER, 0, 1) = '+' )
      211    12466    4               THEN DO;
      212    12467    4                   CALL PARSE_AND_CHECK_PLUS ALTRET ( BAD_UPDATE );
      213    12468    4                   IF CURRENT_STATE ~= %#READ_SOURCE_NO_UPDATES
      214    12469    5                   THEN DO;
      215    12470    5                       IF NEXT_UPDATE_POSITION > 0
      216    12471    6                       THEN DO;
      217    12472    6                           CURRENT_STATE = %#READ_SOURCE;
      218    12473    6                           END;
      219    12474    6                       ELSE DO;
      220    12475    6                           IF SI_SKIP_COUNT ~= 0
      221    12476    7                           THEN DO;
      222    12477    7                               CALL PRECORD( SI_INFO, SI_SKIP_COUNT )
      223    12478    7                                  ALTRET ( SI_SKIP_ERR );
      224    12479    7                               END;
      225    12480    6                           CURRENT_STATE = %#READ_UPDATE;
      226    12481    6                           END;
      227    12482    5                       END;
      228    12483    4                   END;
      229    12484    4               ELSE DO;
      230    12485    4                   CURRENT_STATE = %#READ_UPDATE;
      231    12486    4                   GOT_RECORD = %TRUE;
      232    12487    4                   END;
      233    12488    3               IF CURRENT_STATE ~= %#READ_SOURCE
      234    12489    3               THEN
      235    12490    3                   CALL PRINT_UPDATE ALTRET ( XUU_ALTRET );
      236    12491    4               ELSE DO;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:10   
      237    12492    4                   SAVED_UPDATE.ARS = MINIMUM( ARS, LENGTHC(SAVED_UPDATE.TEXT) );
      238    12493    4                   SAVED_UPDATE.KEY = XUU_PARAM.RE_ASCII_KEY.CHAR1_9;
      239    12494    4                   SAVED_UPDATE.TEXT = SUBSTR( #USER_BUFFER, 0, ARS );
      240    12495    4                   END;
      241    12496
      242    12497    3           CASE ( %#READ_UPDATE );
      243    12498    3               XUU_PARAM.RE_ASCII_KEY.CHAR10 = '*';
      244    12499    3               CALL READ( UI_INFO ) ALTRET ( UI_READ_ERR );
      245    12500    3               XUU_PARAM.FLAGS.UP_DATE# = %TRUE;
      246    12501    3               XUU_PARAM.SEQ_REC#.UP_INCL# = UI_INFO.RECORD_COUNT;
      247    12502    3               IF ( ARS > 0 ) AND ( SUBSTR(#USER_BUFFER, 0, 1) = '+' )
      248    12503    4               THEN DO;
      249    12504    4                   CALL PARSE_AND_CHECK_PLUS ALTRET ( BAD_UPDATE );
      250    12505    4                   IF SI_INFO.RECORD_COUNT < NEXT_UPDATE_POSITION
      251    12506    5                   THEN DO;
      252    12507    5                       CURRENT_STATE = %#READ_SOURCE;
      253    12508    5                       END;
      254    12509    5                   ELSE DO;
      255    12510    5                       IF SI_SKIP_COUNT ~= 0
      256    12511    6                       THEN DO;
      257    12512    6                           CALL PRECORD( SI_INFO, SI_SKIP_COUNT )
      258    12513    6                              ALTRET ( SI_SKIP_ERR );
      259    12514    6                           END;
      260    12515    5                       END;
      261    12516    4                   END;
      262    12517    4               ELSE DO;
      263    12518    4                   GOT_RECORD = %TRUE;
      264    12519    4                   END;
      265    12520    3               IF CURRENT_STATE ~= %#READ_SOURCE
      266    12521    3               THEN
      267    12522    3                   CALL PRINT_UPDATE ALTRET ( XUU_ALTRET );
      268    12523    4               ELSE DO;
      269    12524    4                   SAVED_UPDATE.ARS = MINIMUM( ARS, LENGTHC(SAVED_UPDATE.TEXT) );
      270    12525    4                   SAVED_UPDATE.KEY = XUU_PARAM.RE_ASCII_KEY.CHAR1_9;
      271    12526    4                   SAVED_UPDATE.TEXT = SUBSTR( #USER_BUFFER, 0, ARS );
      272    12527    4                   END;
      273    12528
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:11   
      274    12529    3           CASE ( %#READ_INCLUDE );
      275    12530    3               XUU_PARAM.RE_ASCII_KEY.CHAR10 = '+';
      276    12531    3               CALL READ( INCL_INFO(INCL_LEVEL) )
      277    12532    4               WHENRETURN DO;
      278    12533    4                   GOT_RECORD = %TRUE;
      279    12534    4                   XUU_PARAM.FLAGS.INCLUDE# = %TRUE;
      280    12535    4                   XUU_PARAM.LEVEL = INCL_LEVEL + 1;
      281    12536    4                   XUU_PARAM.SEQ_REC#.UP_INCL# = INCL_INFO.RECORD_COUNT(INCL_LEVEL);
      282    12537    4                   END;
      283    12538    4               WHENALTRETURN DO;
      284    12539    4                   IF EOF
      285    12540    5                   THEN DO;
      286    12541    5                       CALL CLOSE ( INCL_INFO(INCL_LEVEL) ) ALTRET ( INCL_IO_ERR );
      287    12542    5                       INCL_LEVEL = INCL_LEVEL - 1;
      288    12543    5                       IF INCL_LEVEL < 0
      289    12544    6                       THEN DO;
      290    12545    6                           CURRENT_STATE = INCL_SAVE_STATE;
      291    12546         /* The following code is necessary because cobol needs to be able to
      292    12547            open an include file after the end of the source file has already
      293    12548            caused cleanup to occur. This code allows the termination of that
      294    12549            include file to occur even though no source file is around. Sigh!
      295    12550         */
      296    12551    6                           IF CURRENT_STATE = %#UNINITIALIZED
      297    12552    7                           THEN DO;
      298    12553    7                               INCL_LEVEL = 0;
      299    12554    7                               GOTO INCL_IO_ERR;
      300    12555    7                               END;
      301    12556    6                           END;
      302    12557    5                       END;
      303    12558    5                   ELSE DO;
      304    12559    5                       GOTO INCL_IO_ERR;
      305    12560    5                       END;
      306    12561    4                   END;
      307    12562    3               END;/* Case on state */
      308    12563
      309    12564    3           DO WHILE %FALSE;
      310    12565
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:12   
      311    12566    3   UI_READ_ERR: ;
      312    12567    3               IF EOF
      313    12568    4               THEN DO;
      314    12569    4                   CURRENT_STATE = %#READ_SOURCE_NO_UPDATES;
      315    12570    4                   GOTO RECOVER;
      316    12571    4                   END;
      317    12572    4               ELSE DO;
      318    12573    4                   GOTO UI_IO_ERR;
      319    12574    4                   END;
      320    12575
      321    12576    3   SI_SKIP_ERR: ;
      322    12577    3               IF EOF
      323    12578    4               THEN DO;
      324    12579    4                   CALL REC_XUU_ERR( %E$XUU#UPDATE_PAST_EOF, %FALSE ) ALTRET(
             12579                            XUU_ALTRET );
      325    12580    4                   CURRENT_STATE = %#READ_UPDATE;
      326    12581    4                   GOTO RECOVER;
      327    12582    4                   END;
      328    12583    4               ELSE DO;
      329    12584    4                   GOTO SI_IO_ERR;
      330    12585    4                   END;
      331    12586    3   RECOVER:    ;
      332    12587    3               END;
      333    12588
      334    12589    2           END READ_LOOP;
      335    12590
      336    12591    1       XUU_PARAM.ARS = ARS;
      337    12592    1       XUU_PARAM.FULL_ARS = ARS;
      338    12593    1       XUU_PARAM.SEQ_REC#.BASE# = SI_INFO.RECORD_COUNT;
      339    12594
      340    12595    1       IF XUU_PARAM.FLAGS.BLANK_FILL#
      341    12596    2       THEN DO;
      342    12597    2           IF ARS < VBOUND( P_BUF_ ) + 1
      343    12598    3           THEN DO;
      344    12599    3               SUBSTR( VBASE(P_BUF_)->BASED_CHARS, ARS, ( VBOUND(P_BUF_) + 1 - ARS ) )
             12599                        = ' ';
      345    12600    3               END;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:13   
      346    12601    2           END;
      347    12602
      348    12603    1       IF XUU_PARAM.FLAGS.SOURCE_OUT#
      349    12604    2       THEN DO;
      350    12605    2           CALL SOURCE_OUT ALTRET ( SOURCE_OUT_CRASH );
      351    12606    2           END;
      352    12607
      353    12608    1       RETURN;
      354    12609
      355    12610    1   SI_BETTER_BE_EOF: ;
      356    12611    1       IF EOF AND ( NEXT_UPDATE_POSITION > SI_INFO.RECORD_COUNT )
      357    12612    2       THEN DO;
      358    12613    2           CALL PRINT_SAVED_UPDATE;
      359    12614    2           CALL KILL_XUU_ERR( %E$XUU#UPDATE_PAST_EOF );
      360    12615    2           GOTO XUU_ALTRET;
      361    12616    2           END;
      362    12617    2       ELSE DO;
      363    12618    2           GOTO SI_IO_ERR;
      364    12619    2           END;
      365    12620
      366    12621    1   BAD_UPDATE: ;
      367    12622    1       GOTO XUU_ALTRET;
      368    12623
      369    12624    1   SOURCE_OUT_CRASH: ;
      370    12625    1       GOTO SO_IO_ERR;
      371    12626
      372    12627        %PAGE( ARG=XUU$OPEN, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:14   
             12639    1   /*******************************************************************************
             12640    1   *                                                                              *
             12641    1   *        XUU$OPEN              XUU$OPEN                                            *
             12642    1   *                                                                              *
             12643    1   *******************************************************************************/

      373    12647    1   XUU$OPEN: ENTRY( XUU_PARAM ) ALTRET;
      374    12648
      375    12649    1       ERROR_SET = %FALSE;
      376    12650
      377    12651    1       OPEN_SI = XUU_PARAM.FLAGS.BASE#;
      378    12652    1       OPEN_UI = XUU_PARAM.FLAGS.UP_DATE#;
      379    12653    1       OPEN_INCL = XUU_PARAM.FLAGS.INCLUDE#;
      380    12654
      381    12655    1       IF CURRENT_STATE = %#UNINITIALIZED
      382    12656    2       THEN DO;
      383    12657    2           CALL INITIALIZE_EVERYTHING;
      384    12658    2           END;
      385    12659
      386    12660    1       IF NOT ( OPEN_SI OR OPEN_UI OR OPEN_INCL )
      387    12661    2       THEN DO;
      388    12662    2           CALL KILL_XUU_ERR( %E$XUU#BAD_OPEN_BITS );
      389    12663    2           GOTO XUU_ALTRET;
      390    12664    2           END;
      391    12665
      392    12666    1       IF OPEN_INCL
      393    12667    2       THEN DO;
      394    12668    2           IF OPEN_SI OR OPEN_UI
      395    12669    3           THEN DO;
      396    12670    3               CALL KILL_XUU_ERR( %E$XUU#BAD_OPEN_BITS );
      397    12671    3               GOTO XUU_ALTRET;
      398    12672    3               END;
      399    12673    2           IF INCL_LEVEL < 0
      400    12674    3           THEN DO;
      401    12675    3               INCL_SAVE_STATE = CURRENT_STATE;
      402    12676    3               END;
      403    12677    2           TEMP_INCL_LEVEL = INCL_LEVEL + 1;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:15   
      404    12678    2           IF TEMP_INCL_LEVEL >= %MAX_INCL_LEVEL
      405    12679    3           THEN DO;
      406    12680    3               CALL SET_XUU_ERR( %E$XUU#INCL_TOO_DEEP, %FALSE );
      407    12681    3               GOTO XUU_ALTRET;
      408    12682    3               END;
      409    12683    3           ELSE DO;
      410    12684    3               INCL_INFO.FAST(TEMP_INCL_LEVEL) = XUU_PARAM.FLAGS.FAST_INCLUDE# ;
      411    12685    3               CALL GETDCB( INCL_INFO(TEMP_INCL_LEVEL) ) ALTRET ( INCL_OPEN_ERR );
      412    12686    3               CALL OPEN( INCL_INFO(TEMP_INCL_LEVEL), XUU_PARAM.O.FPT_PTR$, %#OPEN_INCL
             12686                        )
      413    12687    3                  ALTRET( INCL_OPEN_ERR );
      414    12688    3               CURRENT_STATE = %#READ_INCLUDE;
      415    12689    3               INCL_LEVEL = TEMP_INCL_LEVEL;
      416    12690    3               XUU_PARAM.LEVEL = INCL_LEVEL + 1;
      417    12691    3               END;
      418    12692    2           END;
      419    12693
      420    12694    1       IF OPEN_SI
      421    12695    2       THEN DO;
      422    12696    2           IF CURRENT_STATE ~= %#UNINITIALIZED
      423    12697    3           THEN DO;
      424    12698    3               CALL KILL_XUU_ERR( %E$XUU#BAD_OPEN_BITS );
      425    12699    3               GOTO XUU_ALTRET;
      426    12700    3               END;
      427    12701    2           SI_INFO.FAST = XUU_PARAM.FLAGS.FAST_BASE#;
      428    12702    2           CALL GETDCB( SI_INFO, SI_DCB_NAME ) ALTRET ( SI_OPEN_ERR );
      429    12703    2           CALL OPEN( SI_INFO, , %#OPEN_BASE ) ALTRET ( SI_OPEN_ERR );
      430    12704    2           IF SI_INFO.DCB$->F$DCB.ASN# = %FILE#
      431    12705    3           THEN DO;
      432    12706    3               NRECS_IN_SOURCE = SI_INFO.DCB$->F$DCB.NRECS#;
      433    12707    3               END;
      434    12708    3           ELSE DO;
      435    12709    3               NRECS_IN_SOURCE = BITBIN( '377777777777'O );
      436    12710    3               END;
      437    12711    2           CURRENT_STATE = %#READ_SOURCE_NO_UPDATES;
      438    12712    2           END;
      439    12713
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:16   
      440    12714    1       IF OPEN_UI
      441    12715    2       THEN DO;
      442    12716    2           IF NOT OPEN_SI
      443    12717    3           THEN DO;
      444    12718    3               CALL KILL_XUU_ERR( %E$XUU#BAD_OPEN_BITS );
      445    12719    3               GOTO XUU_ALTRET;
      446    12720    3               END;
      447    12721    2           UI_INFO.FAST = XUU_PARAM.FLAGS.FAST_UPDATE# ;
      448    12722    2           CALL GETDCB( UI_INFO, UI_DCB_NAME ) ALTRET ( UI_OPEN_ERR );
      449    12723    2           CALL OPEN( UI_INFO, , %#OPEN_UPDATE )
      450    12724    3           WHENRETURN DO;
      451    12725    3               IF XUU_PARAM.FLAGS.LU_FIRST# OR XUU_PARAM.FLAGS.LU_WHILE#
      452    12726    4               THEN DO;
      453    12727    4                   LU_INFO.FAST = %FALSE;
      454    12728    4                   LU_INFO.DCB# = XUU_PARAM.DCB#;
      455    12729    4                   LU_INFO.DCB$ = DCBADDR( LU_INFO.DCB# );
      456    12730    4                   END;
      457    12731    3               IF XUU_PARAM.FLAGS.LU_FIRST#
      458    12732    4               THEN DO;
      459    12733    4                   CALL PREPRINT_UPDATES ALTRET ( XUU_ALTRET );
      460    12734    4                   END;
      461    12735    3               CURRENT_STATE = %#READ_FIRST_UPDATE;
      462    12736    3               END;
      463    12737    3           WHENALTRETURN DO;
      464    12738    3               IF NOT ( ( ERROR_CODE.ERR# = %E$NOFILE ) AND XUU_PARAM.FLAGS.OPT_UI# )
      465    12739    4               THEN DO;
      466    12740    4                   GOTO UI_OPEN_ERR;
      467    12741    4                   END;
      468    12742    3               END;
      469    12743    2           END;
      470    12744
      471    12745    1       RETURN;
      472    12746
      473    12747    1   SI_OPEN_ERR: ;
      474    12748    1       GOTO SI_IO_ERR;
      475    12749
      476    12750    1   UI_OPEN_ERR: ;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:17   
      477    12751    1       GOTO UI_IO_ERR;
      478    12752
      479    12753    1   INCL_OPEN_ERR:;
      480    12754    1       CALL SET_IO_ERROR( %INCL_ERR, %FALSE );
      481    12755    1       GOTO XUU_ALTRET;
      482    12756
      483    12757        %PAGE( ARG=XUU$CLOSE, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:18   
             12769    1   /*******************************************************************************
             12770    1   *                                                                              *
             12771    1   *        XUU$CLOSE              XUU$CLOSE                                          *
             12772    1   *                                                                              *
             12773    1   *******************************************************************************/

      484    12777    1   XUU$CLOSE:ENTRY( XUU_PARAM ) ALTRET;
      485    12778
      486    12779    1       ERROR_SET = %FALSE;
      487    12780
      488    12781    1       IF XUU_PARAM.FLAGS.CLOSE_ALL# OR XUU_PARAM.FLAGS.BASE#
      489    12782    2       THEN DO;
      490    12783    2           CALL CLEANUP ALTRET ( BAD_CLEANUP );
      491    12784    2           END;
      492    12785    2       ELSE DO;
      493    12786    2           IF ( XUU_PARAM.FLAGS.INCLUDE# ) AND ( INCL_LEVEL >= 0 )
      494    12787    3           THEN DO;
      495    12788    3               CALL CLOSE( INCL_INFO(INCL_LEVEL) ) ALTRET ( INCL_CLOSE_PROBLEMS );
      496    12789    3               INCL_LEVEL = INCL_LEVEL - 1;
      497    12790    3               IF INCL_LEVEL < 0
      498    12791    4               THEN DO;
      499    12792    4                   CURRENT_STATE = INCL_SAVE_STATE;
      500    12793    4                   INCL_SAVE_STATE = %#UNINITIALIZED;
      501    12794    4                   END;
      502    12795    3               END;
      503    12796
      504    12797    2           IF XUU_PARAM.FLAGS.UP_DATE#
      505    12798    3           THEN DO;
      506    12799    3               INCL_SAVE_STATE = %#READ_SOURCE_NO_UPDATES;
      507    12800    3               IF ( CURRENT_STATE = %#READ_SOURCE )
      508    12801    3                  OR ( CURRENT_STATE = %#READ_UPDATE )
      509    12802    4               THEN DO;
      510    12803    4                   CURRENT_STATE = %#READ_SOURCE_NO_UPDATES;
      511    12804    4                   END;
      512    12805    3               END;
      513    12806
      514    12807    2           IF XUU_PARAM.FLAGS.SOURCE_OUT#
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:19   
      515    12808    3           THEN DO;
      516    12809    3               XUU_PARAM.FLAGS.SOURCE_OUT# = %FALSE;
      517    12810    3               END;
      518    12811
      519    12812    2           END;
      520    12813
      521    12814    1       RETURN;
      522    12815
      523    12816    1   INCL_CLOSE_PROBLEMS: ;
      524    12817    1       GOTO INCL_IO_ERR;
      525    12818
      526    12819    1   BAD_CLEANUP: ;
      527    12820    1       GOTO XUU_ALTRET;
      528    12821
      529    12822        %PAGE( ARG=Global IO error collection, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:20   
             12834    1   /*******************************************************************************
             12835    1   *                                                                              *
             12836    1   *        Global IO error collection              Global IO error collection        *
             12837    1   *                                                                              *
             12838    1   *******************************************************************************/

      530    12842    1   SI_IO_ERR: ;
      531    12843    1       CALL KILL_IO_ERR( %SI_ERR );
      532    12844    1       GOTO XUU_ALTRET;
      533    12845
      534    12846    1   UI_IO_ERR: ;
      535    12847    1       CALL KILL_IO_ERR( %UI_ERR );
      536    12848    1       GOTO XUU_ALTRET;
      537    12849
      538    12850    1   INCL_IO_ERR: ;
      539    12851    1       TEMP_INCL_LEVEL = INCL_LEVEL;
      540    12852    1       CALL KILL_IO_ERR( %INCL_ERR );
      541    12853    1       GOTO XUU_ALTRET;
      542    12854
      543    12855    1   SO_IO_ERR: ;
      544    12856    1       CALL KILL_IO_ERR( %SO_ERR );
      545    12857    1       GOTO XUU_ALTRET;
      546    12858
      547    12859    1   XUU_ALTRET: ;
      548    12860    1       ALTRETURN;
      549    12861
      550    12862        %PAGE( ARG=Internal procedures, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:21   
             12874    1   /*******************************************************************************
             12875    1   *                                                                              *
             12876    1   *        Internal procedures              Internal procedures                      *
             12877    1   *                                                                              *
             12878    1   *******************************************************************************/

      551    12882        %PAGE( ARG=INITIALIZE_EVERYTHING );

             12894    1   /*******************************************************************************
             12895    1   *                                                                              *
             12896    1   *        INITIALIZE_EVERYTHING              INITIALIZE_EVERYTHING                  *
             12897    1   *                                                                              *
             12898    1   *******************************************************************************/

      552    12902    1   INITIALIZE_EVERYTHING: PROC;
      553    12903
      554    12904    2   DCL I SBIN WORD;
      555    12905
      556    12906    3       DO I = 0 TO %(MAX_INCL_LEVEL-1);
      557    12907    3           INCL_INFO(I) = FILE_INFO_BASE;
      558    12908    3           END;
      559    12909
      560    12910    2       SO_INFO = FILE_INFO_BASE;
      561    12911    2       SO_INFO.RECORD_COUNT = 1;
      562    12912    2       UI_INFO = FILE_INFO_BASE;
      563    12913    2       SI_INFO = FILE_INFO_BASE;
      564    12914    2       LU_INFO = FILE_INFO_BASE;
      565    12915
      566    12916    2       CURRENT_STATE = %#UNINITIALIZED;
      567    12917    2       INCL_SAVE_STATE = %#UNINITIALIZED;
      568    12918
      569    12919    2       INCL_LEVEL = -1;
      570    12920
      571    12921    2       NEXT_UPDATE_POSITION = 0;
      572    12922
      573    12923    2       XSA_PARAM_POOL_ = VECTOR(NIL);
      574    12924
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:22   
      575    12925    2   END INITIALIZE_EVERYTHING;
      576    12926
      577    12927        %PAGE( ARG=PARSE_AND_CHECK_PLUS, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:23   
             12939    2   /*******************************************************************************
             12940    2   *                                                                              *
             12941    2   *        PARSE_AND_CHECK_PLUS              PARSE_AND_CHECK_PLUS                    *
             12942    2   *                                                                              *
             12943    2   *******************************************************************************/

      578    12947    1   PARSE_AND_CHECK_PLUS: PROC ALTRET;
      579    12948
      580    12949    2   DCL N SBIN WORD;
      581    12950    2   DCL M SBIN WORD;
      582    12951    2   DCL HALT_POS SBIN WORD;
      583    12952    2   DCL HALT_VALUE SBIN WORD;
      584    12953    2   DCL COMMA_POS SBIN WORD;
      585    12954    2   DCL GOT_N BIT(1) ALIGNED;
      586    12955    2   DCL GOT_M BIT(1) ALIGNED;
      587    12956
      588    12957    2       N = 0;
      589    12958    2       M = 0;
      590    12959    2       SI_SKIP_COUNT = 0;
      591    12960    2       COMMA_POS = 0;
      592    12961    2       GOT_N = %FALSE;
      593    12962    2       GOT_M = %FALSE;
      594    12963
      595    12964    2       IF ARS = 1
      596    12965    3       THEN DO;
      597    12966    3           CALL REC_XUU_ERR( %E$XUU#PLUS_ONLY, %TRUE ) ALTRET( BAD_UPDATE );
      598    12967    3           RETURN;
      599    12968    3           END;
      600    12969
      601    12970    2       IF ( ARS > 1 ) AND ( SUBSTR(#USER_BUFFER, 1, 1) = '*' )
      602    12971    3       THEN DO;
      603    12972    3           RETURN;
      604    12973    3           END;
      605    12974
      606    12975    2       IF ( ARS > 3) AND ( SUBSTR(#USER_BUFFER, 1, 3) = 'END' )
      607    12976    3       THEN DO;
      608    12977    3           IF ( ARS > 4 ) AND ( SUBSTR(#USER_BUFFER, 4, 1 ) ~= ' ' )
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:24   
      609    12978    4           THEN DO;
      610    12979    4               CALL REC_XUU_ERR( %E$XUU#BAD_PLUS_END, %TRUE ) ALTRET( BAD_UPDATE );
      611    12980    4               END;
      612    12981    3           CALL READ( UI_INFO )
      613    12982    4           WHENRETURN DO;
      614    12983    4               CALL REC_XUU_ERR( %E$XUU#EXTRA_RECS, %TRUE ) ALTRET( BAD_UPDATE );
      615    12984    4               END;
      616    12985    4           WHENALTRETURN DO;
      617    12986    4               IF NOT EOF
      618    12987    5               THEN DO;
      619    12988    5                   GOTO UI_IO_ERR;
      620    12989    5                   END;
      621    12990    4               END;
      622    12991    3           CALL CLOSE( UI_INFO ) ALTRET ( UI_IO_ERR );
      623    12992    3           CURRENT_STATE = %#READ_SOURCE_NO_UPDATES;
      624    12993    3           NEXT_UPDATE_POSITION = 0;
      625    12994    3           END;
      626    12995    3       ELSE DO;
      627    12996    3           CALL SEARCH( HALT_POS, HALT_VALUE, SEARCH_TABLE, #USER_BUFFER, 1);
      628    12997    3           IF ( HALT_POS > 1 )
      629    12998    4           THEN DO;
      630    12999    4               GOT_N = %TRUE;
      631    13000    4               CALL CHARBIN( N, SUBSTR(#USER_BUFFER, 1, HALT_POS-1) );
      632    13001    4               IF HALT_VALUE = %#COMMA
      633    13002    5               THEN DO;
      634    13003    5                   COMMA_POS = HALT_POS;
      635    13004    5                   CALL SEARCH( HALT_POS, HALT_VALUE, SEARCH_TABLE, #USER_BUFFER,
             13004                            COMMA_POS+1 );
      636    13005    5                   IF ( HALT_POS > ( COMMA_POS + 1 ) )
      637    13006    6                   THEN DO;
      638    13007    6                       IF ( HALT_VALUE ~= %#BLANK ) AND ( HALT_VALUE ~= %#NUMERIC )
      639    13008    7                       THEN DO;
      640    13009    7                           HALT_VALUE = %#JUNK;
      641    13010    7                           END;
      642    13011    6                       GOT_M = %TRUE;
      643    13012    6                       CALL CHARBIN( M, SUBSTR(#USER_BUFFER, COMMA_POS+1, HALT_POS-(
             13012                                COMMA_POS+1)) );
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:25   
      644    13013    6                       END;
      645    13014    6                   ELSE DO;
      646    13015    6                       HALT_VALUE = %#JUNK;
      647    13016    6                       END;
      648    13017    5                   END;
      649    13018    4               END;
      650    13019    4           ELSE DO;
      651    13020    4               HALT_VALUE = %#JUNK;
      652    13021    4               END;
      653    13022    3           IF ( HALT_VALUE = %#JUNK )
      654    13023    4           THEN DO;
      655    13024    4               CALL REC_XUU_ERR( %E$XUU#BAD_UPDATE, %TRUE ) ALTRET( BAD_UPDATE );
      656    13025    4               IF NOT GOT_M
      657    13026    5               THEN DO;
      658    13027    5                   IF NOT GOT_N
      659    13028    6                   THEN DO;
      660    13029    6                       N = SI_INFO.RECORD_COUNT;
      661    13030    6                       END;
      662    13031    6                   ELSE DO;
      663    13032    6                       IF ( COMMA_POS ~= 0 )
      664    13033    7                       THEN DO;
      665    13034    7                           M = N;
      666    13035    7                           END;
      667    13036    6                       END;
      668    13037    5                   END;
      669    13038    4               END;
      670    13039    3           IF ( M ~= 0 ) AND ( M < N )
      671    13040    4           THEN DO;
      672    13041    4               CALL REC_XUU_ERR( %E$XUU#BAD_RANGE, %TRUE ) ALTRET( BAD_UPDATE );
      673    13042    4               M = N;
      674    13043    4               END;
      675    13044    3           IF ( N > NRECS_IN_SOURCE ) OR ( M > NRECS_IN_SOURCE )
      676    13045    4           THEN DO;
      677    13046    4               CALL REC_XUU_ERR( %E$XUU#UPDATE_PAST_EOF, %TRUE ) ALTRET( BAD_UPDATE );
      678    13047    4               NEXT_UPDATE_POSITION = 0;
      679    13048    4               CURRENT_STATE = %#READ_SOURCE_NO_UPDATES;
      680    13049    4               RETURN;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:26   
      681    13050    4               END;
      682    13051    3           IF ( M = 0 )
      683    13052    4           THEN DO;
      684    13053    4               NEXT_UPDATE_POSITION = N;
      685    13054    4               SI_SKIP_COUNT = 0;
      686    13055    4               END;
      687    13056    4           ELSE DO;
      688    13057    4               NEXT_UPDATE_POSITION = N-1;
      689    13058    4               SI_SKIP_COUNT = ( M - N ) + 1;
      690    13059    4               END;
      691    13060    3           IF NEXT_UPDATE_POSITION < SI_INFO.RECORD_COUNT
      692    13061    4           THEN DO;
      693    13062    4               CALL REC_XUU_ERR( %E$XUU#UN_SORTED, %TRUE ) ALTRET( BAD_UPDATE );
      694    13063    4               NEXT_UPDATE_POSITION = SI_INFO.RECORD_COUNT;
      695    13064    4               IF ( M ~= 0 ) AND ( M > SI_INFO.RECORD_COUNT )
      696    13065    5               THEN DO;
      697    13066    5                   SI_SKIP_COUNT = ( M - NEXT_UPDATE_POSITION ) + 1;
      698    13067    5                   END;
      699    13068    5               ELSE DO;
      700    13069    5                   SI_SKIP_COUNT = 0;
      701    13070    5                   END;
      702    13071    4               END;
      703    13072    3           END;
      704    13073
      705    13074    2       RETURN;
      706    13075
      707    13076    2   UI_IO_ERR: ;
      708    13077    2       CALL KILL_IO_ERR( %UI_ERR );
      709    13078    2       ALTRETURN;
      710    13079
      711    13080    2   BAD_UPDATE: ;
      712    13081    2       ALTRETURN;
      713    13082
      714    13083    2   END PARSE_AND_CHECK_PLUS;
      715    13084
      716    13085        %PAGE( ARG=READ, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:27   
             13097    2   /*******************************************************************************
             13098    2   *                                                                              *
             13099    2   *        READ              READ                                                  *
             13100    2   *                                                                              *
             13101    2   *******************************************************************************/

      717    13105    1   READ: PROC( P_INFO ) ALTRET;
      718    13106
      719    13107        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
      720    13141    2   DCL TEMP_CHAR8 CHAR(8) DALIGNED;
      721    13142    2   DCL 1 KEY_BUF ALIGNED,
      722    13143    2         2 COUNT UBIN BYTE CALIGNED,
      723    13144    2         2 KEY UBIN(27) UNAL,
      724    13145    2         2 * CHAR(251) CALIGNED;
      725    13146    2   DCL ALT_FLAG BIT(1) ALIGNED;
      726    13147
      727    13148    2       EOF = %FALSE;
      728    13149    2       ALT_FLAG = %FALSE;
      729    13150    2       READ_FPT.V.DCB# = P_INFO.DCB#;
      730    13151    2       READ_FPT.KEY_ = VECTOR( KEY_BUF );
      731    13152
      732    13153    2       IF P_INFO.FAST
      733    13154    3       THEN DO;
      734    13155    3           CALL XSA$READ( READ_FPT, P_INFO.XSA_PARAM$->XSA_PARAM ) ALTRET (
             13155                    BAD_FAST_READ );
      735    13156    3           ARS = P_INFO.XSA_PARAM$->XSA_PARAM.ARS#;
      736    13157    3           END;
      737    13158    3       ELSE DO;
      738    13159    3           CALL M$READ( READ_FPT ) ALTRET ( BAD_NORMAL_READ );
      739    13160    3           ARS = P_INFO.DCB$->F$DCB.ARS#;
      740    13161    3           END;
      741    13162
      742    13163    3       DO WHILE %FALSE;
      743    13164    3   BAD_NORMAL_READ: ;
      744    13165    3           ERROR_CODE = #MONERR;
      745    13166    3           GOTO BAD_READ;
      746    13167
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:28   
      747    13168    3   BAD_FAST_READ: ;
      748    13169    3           ERROR_CODE = P_INFO.XSA_PARAM$ -> XSA_PARAM.ERR;
      749    13170
      750    13171    3   BAD_READ: ;
      751    13172    3           EOF = ( ERROR_CODE.ERR# = %E$EOF );
      752    13173    3           ALT_FLAG = %TRUE;
      753    13174    3           IF ERROR_CODE.ERR# = %E$LD
      754    13175    4           THEN DO;
      755    13176    4               ARS = VBOUND( BITVECT(READ_FPT.BUF_) );
      756    13177    4               CALL REC_IO_ERR( ERROR_CODE, %FALSE )
      757    13178    5               WHENRETURN DO;
      758    13179    5                   ALT_FLAG = %FALSE;
      759    13180    5                   END;
      760    13181    4               END;
      761    13182
      762    13183    3           END;
      763    13184
      764    13185    2       P_INFO.RECORD_COUNT = P_INFO.RECORD_COUNT + 1;
      765    13186
      766    13187    2       IF NOT EOF
      767    13188    3       THEN DO;
      768    13189    4           DO CASE ( P_INFO.KEY_TYPE );
      769    13190    4           CASE ( %#EDIT_KEY );
      770    13191    4               IF KEY_BUF.COUNT = %EDIT_KEY_SIZE
      771    13192    5               THEN DO;
      772    13193    5                   CALL BINCHAR( TEMP_CHAR8, KEY_BUF.KEY );
      773    13194    5                   CALL EDITCHAR( XUU_PARAM.RE_ASCII_KEY.CHAR1_9, 0, 9, EDIT_MOPS,
             13194                            TEMP_CHAR8 );
      774    13195    5                   XUU_PARAM.FLAGS.KEY_REC# = %TRUE;
      775    13196    5                   END;
      776    13197    5               ELSE DO;
      777    13198    5                   P_INFO.KEY_TYPE = %#CONSEC;
      778    13199    5                   GOTO CONSEC;
      779    13200    5                   END;
      780    13201    4           CASE ( %#CONSEC,ELSE );
      781    13202    4   CONSEC:     ;
      782    13203    4               CALL BINCHAR( TEMP_CHAR8, P_INFO.RECORD_COUNT );
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:29   
      783    13204    4               CALL EDITCHAR( XUU_PARAM.RE_ASCII_KEY.CHAR1_9, 0, 9, SEQ_MOPS,
             13204                        TEMP_CHAR8 );
      784    13205    4               END;
      785    13206    3           END;
      786    13207
      787    13208    2       IF ALT_FLAG
      788    13209    2       THEN ALTRETURN;
      789    13210    2       ELSE RETURN;
      790    13211
      791    13212    2   END READ;
      792    13213
      793    13214        %PAGE( ARG=WRITE, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:30   
             13226    2   /*******************************************************************************
             13227    2   *                                                                              *
             13228    2   *        WRITE              WRITE                                                  *
             13229    2   *                                                                              *
             13230    2   *******************************************************************************/

      794    13234    1   WRITE: PROC( P_INFO, P_WRITE_BUF_, P_KEY_ ) ALTRET;
      795    13235
      796    13236        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
      797    13270    2   DCL P_WRITE_BUF_ VECTOR DALIGNED;
      798    13271    2   DCL P_KEY_ VECTOR DALIGNED;
      799    13272
      800    13273        %FPT_WRITE( FPTN=CONST_WRITE_FPT, STCLASS=CONSTANT );
      801    13304        %FPT_WRITE( FPTN=WRITE_FPT, STCLASS=" " );
      802    13335
      803    13336
      804    13337    2       WRITE_FPT = CONST_WRITE_FPT;
      805    13338    2       WRITE_FPT.V_ = VECTOR( WRITE_FPT.V );
      806    13339    2       WRITE_FPT.V.DCB# = P_INFO.DCB#;
      807    13340
      808    13341    2       IF ADDR(P_WRITE_BUF_) = ADDR(NIL)
      809    13342    3       THEN DO;
      810    13343    3           IF ARS ~= 0
      811    13344    4           THEN DO;
      812    13345    4               WRITE_FPT.BUF_ = VECTOR( #USER_BUFFER );
      813    13346    4               END;
      814    13347    4           ELSE DO;
      815    13348    4               WRITE_FPT.BUF_ = VECTOR(NIL);
      816    13349    4               END;
      817    13350    3           END;
      818    13351    3       ELSE DO;
      819    13352    3           WRITE_FPT.BUF_ = P_WRITE_BUF_;
      820    13353    3           END;
      821    13354
      822    13355    2       IF ADDR(P_KEY_) ~= ADDR(NIL) AND
      823    13356    2          P_INFO.KEY_TYPE = %#EDIT_KEY
      824    13357    3       THEN DO;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:31   
      825    13358    3           WRITE_FPT.KEY_ = P_KEY_;
      826    13359    3           END;
      827    13360
      828    13361    2       IF P_INFO.FAST
      829    13362    3       THEN DO;
      830    13363    3           CALL XSA$WRITE( WRITE_FPT, P_INFO.XSA_PARAM$->XSA_PARAM ) ALTRET (
             13363                    BAD_FAST_WRITE );
      831    13364    3           END;
      832    13365    3       ELSE DO;
      833    13366    3           CALL M$WRITE( WRITE_FPT ) ALTRET ( BAD_NORMAL_WRITE );
      834    13367    3           END;
      835    13368
      836    13369    2       P_INFO.RECORD_COUNT = P_INFO.RECORD_COUNT + 1;
      837    13370
      838    13371    2       RETURN;
      839    13372
      840    13373    2   BAD_NORMAL_WRITE: ;
      841    13374    2       ERROR_CODE = #MONERR;
      842    13375    2       GOTO BAD_WRITE;
      843    13376
      844    13377    2   BAD_FAST_WRITE: ;
      845    13378    2       ERROR_CODE = P_INFO.XSA_PARAM$->XSA_PARAM.ERR;
      846    13379
      847    13380    2   BAD_WRITE: ;
      848    13381    2       ALTRETURN;
      849    13382
      850    13383    2   END WRITE;
      851    13384
      852    13385        %PAGE( ARG=PFIL, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:32   
             13397    2   /*******************************************************************************
             13398    2   *                                                                              *
             13399    2   *        PFIL              PFIL                                                  *
             13400    2   *                                                                              *
             13401    2   *******************************************************************************/

      853    13405    1   PFIL: PROC( P_INFO, P_DIRECTION ) ALTRET;
      854    13406
      855    13407        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
      856    13441    2   DCL P_DIRECTION UBIN WORD ALIGNED;
      857    13442        %FPT_PFIL( FPTN=CONST_PFIL_FPT, STCLASS=CONSTANT, BOF=YES );
      858    13457        %FPT_PFIL( FPTN=PFIL_FPT, STCLASS=" " );
      859    13472
      860    13473    2       PFIL_FPT = CONST_PFIL_FPT;
      861    13474    2       PFIL_FPT.V_ = VECTOR( PFIL_FPT.V );
      862    13475    2       PFIL_FPT.V.DCB# = P_INFO.DCB#;
      863    13476
      864    13477    3       DO CASE ( P_DIRECTION );
      865    13478    3       CASE ( %#PFIL_BOF );
      866    13479    3           PFIL_FPT.V.BOF# = %YES#;
      867    13480    3       CASE ( %#PFIL_EOF );
      868    13481    3           PFIL_FPT.V.BOF# = %NO#;
      869    13482    3       CASE ( ELSE );
      870    13483    3           ALTRETURN;
      871    13484    3           END;
      872    13485
      873    13486    2       IF P_INFO.FAST
      874    13487    3       THEN DO;
      875    13488    3           CALL XSA$PFIL( PFIL_FPT, P_INFO.XSA_PARAM$->XSA_PARAM ) ALTRET (
             13488                    BAD_FAST_PFIL );
      876    13489    3           END;
      877    13490    3       ELSE DO;
      878    13491    3           CALL M$PFIL( PFIL_FPT ) ALTRET ( BAD_NORMAL_PFIL );
      879    13492    3           END;
      880    13493
      881    13494    2       P_INFO.RECORD_COUNT = 0;
      882    13495
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:33   
      883    13496    2       RETURN;
      884    13497
      885    13498    2   BAD_NORMAL_PFIL: ;
      886    13499    2       ERROR_CODE = #MONERR;
      887    13500    2       GOTO BAD_PFIL;
      888    13501
      889    13502    2   BAD_FAST_PFIL: ;
      890    13503    2       ERROR_CODE = P_INFO.XSA_PARAM$ -> XSA_PARAM.ERR;
      891    13504
      892    13505    2   BAD_PFIL: ;
      893    13506    2       ALTRETURN;
      894    13507
      895    13508    2   END PFIL;
      896    13509
      897    13510        %PAGE( ARG=OPEN, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:34   
             13522    2   /*******************************************************************************
             13523    2   *                                                                              *
             13524    2   *        OPEN              OPEN                                                  *
             13525    2   *                                                                              *
             13526    2   *******************************************************************************/

      898    13530    1   OPEN: PROC( P_INFO, P_FPT$, P_OPEN_TYPE ) ALTRET;
      899    13531        /*N* Change OPEN so that the OPEN FPT can be set up globally and not
      900    13532             copied if not necessary */
      901    13533
      902    13534        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
      903    13568    2   DCL P_FPT$ PTR ALIGNED;
      904    13569    2   DCL P_OPEN_TYPE UBIN WORD ALIGNED;
      905    13570        %FPT_OPEN( FPTN=CONST_OPEN_FPT, STCLASS=CONSTANT );
      906    13679        %FPT_OPEN( FPTN=OPEN_FPT, STCLASS=" " );
      907    13788        %FPT_OPEN( FPTN=BASED_OPEN_FPT, STCLASS=BASED, PFMT="VECTOR" );
      908    13897        %FPT$OPEN_V( FPTN=BASED_OPEN_V );
      909    13912    2   DCL BUF_ VECTOR DALIGNED;
      910    13913    2   DCL PARAM$ PTR ALIGNED;
      911    13914    2   DCL ORG UBIN WORD;
      912    13915    2   DCL ALLOC_TYPE UBIN WORD ALIGNED;
      913    13916
      914    13917    2       IF ADDR(P_FPT$) = ADDR(NIL)
      915    13918    3       THEN DO;
      916    13919    3           OPEN_FPT = CONST_OPEN_FPT;
      917    13920    3           END;
      918    13921    3       ELSE DO;
      919    13922    3           IF P_FPT$ ~= ADDR(NIL)
      920    13923    4           THEN DO;
      921    13924    4               OPEN_FPT = P_FPT$->BASED_OPEN_FPT;
      922    13925    4               OPEN_FPT.V = VBASE(P_FPT$->BASED_OPEN_FPT.V_)->BASED_OPEN_V ;
      923    13926    4               END;
      924    13927    4           ELSE DO;
      925    13928    4               CALL SET_XUU_ERR( %E$XUU#NIL_OPEN_FPT, %FALSE );
      926    13929    4               GOTO BAD_OPEN;
      927    13930    4               END;
      928    13931    3           END;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:35   
      929    13932    2       OPEN_FPT.V_ = VECTOR( OPEN_FPT.V );
      930    13933    2       OPEN_FPT.V.DCB# = P_INFO.DCB#;
      931    13934    2       IF ADDR(P_OPEN_TYPE) ~= ADDR(NIL)
      932    13935    3       THEN DO;
      933    13936    4           DO CASE P_OPEN_TYPE;
      934    13937    4           CASE( %#OPEN_BASE );
      935    13938    4               ALLOC_TYPE = %XUU#N_PAGE_BASE;
      936    13939    4           CASE ( %#OPEN_UPDATE );
      937    13940    4               ALLOC_TYPE = %XUU#N_PAGE_UPDATE;
      938    13941    4           CASE ( %#OPEN_INCL );
      939    13942    4               ALLOC_TYPE = %XUU#N_PAGE_INCL;
      940    13943    4           CASE ( ELSE );
      941    13944    4               ALLOC_TYPE = %XUU#ONE_PAGE;
      942    13945    4               END;
      943    13946    3           END;
      944    13947    3       ELSE DO;
      945    13948    3           ALLOC_TYPE = %XUU#ONE_PAGE;
      946    13949    3           END;
      947    13950
      948    13951    2       IF P_INFO.FAST
      949    13952    3       THEN DO;
      950    13953    3           CALL GET_XSA_PARAM( PARAM$ ) ALTRET ( BAD_GET );
      951    13954    3           P_INFO.XSA_PARAM$ = PARAM$;
      952    13955    3           IF PARAM$ = ADDR(NIL)
      953    13956    3           THEN
      954    13957    3               P_INFO.FAST = '0'B;
      955    13958    3           END;
      956    13959
      957    13960    2       IF NOT P_INFO.FAST
      958    13961    3       THEN DO;
      959    13962    3           CALL M$OPEN( OPEN_FPT ) ALTRET ( BAD_NORMAL_OPEN );
      960    13963    3           ORG = P_INFO.DCB$->F$DCB.ORG#;
      961    13964    3           END;
      962    13965    3       ELSE DO;
      963    13966    3           CALL XSA$OPEN(OPEN_FPT, PARAM$->XSA_PARAM ) ALTRET ( BAD_FAST_OPEN );
      964    13967    3           IF PARAM$ -> XSA_PARAM.ORG ~= 0
      965    13968    4           THEN DO;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:36   
      966    13969    4               ORG = PARAM$ -> XSA_PARAM.ORG;
      967    13970    4               IF ORG ~= %KEYED#
      968    13971    5               THEN DO;
      969    13972    5                   ALLOC_TYPE = %XUU#ONE_PAGE;
      970    13973    5                   END;
      971    13974    4               CALL XUU_PARAM.ALLOCATE$$( BUF_, ALLOC_TYPE )
      972    13975    5               WHENALTRETURN DO;
      973    13976    5                   BUF_ = VECTOR(NIL);
      974    13977    5                   END;
      975    13978    4               PARAM$ -> XSA_PARAM.BBUF_ = BUF_;
      976    13979    4               IF ( ORG = %KEYED# ) OR ( ORG = %INDEXED# )
      977    13980    5               THEN DO;
      978    13981    5                   CALL XUU_PARAM.ALLOCATE$$( BUF_, %XUU#ONE_PAGE )
      979    13982    6                   WHENALTRETURN DO;
      980    13983    6                       BUF_ = VECTOR(NIL);
      981    13984    6                       END;
      982    13985    5                   PARAM$ -> XSA_PARAM.KBUF_ = BUF_;
      983    13986    5                   END;
      984    13987    4               END;
      985    13988    4           ELSE DO;
      986    13989    4               ORG = P_INFO.DCB$->F$DCB.ORG#;
      987    13990    4               END;
      988    13991    3           END;
      989    13992
      990    13993    2       IF ORG = %KEYED#
      991    13994    3       THEN DO;
      992    13995    3           P_INFO.KEY_TYPE = %#EDIT_KEY;
      993    13996    3           END;
      994    13997    3       ELSE DO;
      995    13998    3           P_INFO.KEY_TYPE = %#CONSEC;
      996    13999    3           END;
      997    14000
      998    14001    2       P_INFO.RECORD_COUNT = 0;
      999    14002
     1000    14003    2       RETURN;
     1001    14004
     1002    14005    2   BAD_NORMAL_OPEN: ;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:37   
     1003    14006    2       ERROR_CODE = #MONERR;
     1004    14007    2       GOTO BAD_OPEN;
     1005    14008
     1006    14009    2   BAD_FAST_OPEN: ;
     1007    14010    2       ERROR_CODE = PARAM$ -> XSA_PARAM.ERR;
     1008    14011    2       CALL RELEASE_XSA_PARAM( PARAM$ );
     1009    14012    2       P_INFO.XSA_PARAM$ = ADDR(NIL);
     1010    14013
     1011    14014    2   BAD_OPEN: ;
     1012    14015    2       ALTRETURN;
     1013    14016
     1014    14017    2   BAD_GET: ;
     1015    14018    2       ALTRETURN;
     1016    14019
     1017    14020    2   END OPEN;
     1018    14021
     1019    14022        %PAGE( ARG=CLOSE, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:38   
             14034    2   /*******************************************************************************
             14035    2   *                                                                              *
             14036    2   *        CLOSE              CLOSE                                                  *
             14037    2   *                                                                              *
             14038    2   *******************************************************************************/

     1020    14042    1   CLOSE: PROC( P_INFO ) ALTRET;
     1021    14043
     1022    14044        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
     1023    14078        %FPT_CLOSE( FPTN=CONST_CLOSE_FPT, STCLASS=CONSTANT, DISP=SAVE );
     1024    14120        %FPT_CLOSE( FPTN=CLOSE_FPT, STCLASS=" " );
     1025    14162    2   DCL PARAM$ PTR ALIGNED;
     1026    14163    2   DCL CLOSE_ERR BIT(1) ALIGNED;
     1027    14164
     1028    14165    2       CLOSE_ERR = %FALSE;
     1029    14166
     1030    14167    2       IF P_INFO.DCB# ~= DCBNUM(NIL)
     1031    14168    3       THEN DO;
     1032    14169    3           CLOSE_FPT = CONST_CLOSE_FPT;
     1033    14170    3           CLOSE_FPT.V_ = VECTOR( CLOSE_FPT.V );
     1034    14171    3           CLOSE_FPT.V.DCB# = P_INFO.DCB#;
     1035    14172    3           IF ( P_INFO.DCB$->F$DCB.FCD# )
     1036    14173    4           THEN DO;
     1037    14174    4               IF NOT P_INFO.FAST
     1038    14175    5               THEN DO;
     1039    14176    5                   CALL M$CLOSE( CLOSE_FPT )
     1040    14177    6                   WHENALTRETURN DO;
     1041    14178    6                       CLOSE_ERR = %TRUE;
     1042    14179    6                       ERROR_CODE = #MONERR;
     1043    14180    6                       END;
     1044    14181    5                   END;
     1045    14182    5               ELSE DO;
     1046    14183    5                   CALL XSA$CLOSE( CLOSE_FPT, P_INFO.XSA_PARAM$->XSA_PARAM )
     1047    14184    6                   WHENALTRETURN DO;
     1048    14185    6                       CLOSE_ERR = %TRUE;
     1049    14186    6                       ERROR_CODE = PARAM$ -> XSA_PARAM.ERR;
     1050    14187    6                       END;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:39   
     1051    14188    5                   END;
     1052    14189    4               END;
     1053    14190    3           IF P_INFO.XSA_PARAM$ ~= ADDR(NIL)
     1054    14191    4           THEN DO;
     1055    14192    4               PARAM$ = P_INFO.XSA_PARAM$;
     1056    14193    4               IF PARAM$ -> XSA_PARAM.KBUF_ ~= VECTOR(NIL)
     1057    14194    5               THEN DO;
     1058    14195    5                   CALL XUU_PARAM.RELEASE$$( PARAM$->XSA_PARAM.KBUF_ );
     1059    14196    5                   END;
     1060    14197    4               IF PARAM$->XSA_PARAM.BBUF_ ~= VECTOR(NIL)
     1061    14198    5               THEN DO;
     1062    14199    5                   CALL XUU_PARAM.RELEASE$$( PARAM$->XSA_PARAM.BBUF_ );
     1063    14200    5                   END;
     1064    14201    4               CALL RELEASE_XSA_PARAM( PARAM$ )
     1065    14202    5               WHENALTRETURN DO;
     1066    14203    5                   CLOSE_ERR = %TRUE;
     1067    14204    5                   END;
     1068    14205    4               P_INFO.XSA_PARAM$ = ADDR(NIL);
     1069    14206    4               END;
     1070    14207    3           END;
     1071    14208
     1072    14209    2       IF CLOSE_ERR
     1073    14210    2       THEN ALTRETURN;
     1074    14211    2       ELSE RETURN;
     1075    14212    2   END CLOSE;
     1076    14213
     1077    14214        %PAGE( ARG=PRECORD, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:40   
             14226    2   /*******************************************************************************
             14227    2   *                                                                              *
             14228    2   *        PRECORD              PRECORD                                              *
             14229    2   *                                                                              *
             14230    2   *******************************************************************************/

     1078    14234    1   PRECORD: PROC( P_INFO, P_COUNT ) ALTRET;
     1079    14235
     1080    14236        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
     1081    14270    2   DCL P_COUNT SBIN WORD ALIGNED;
     1082    14271        %FPT_PRECORD( FPTN=CONST_PRECORD_FPT, STCLASS=CONSTANT, KEYR=NO, KEYS=NO );
     1083    14292        %FPT_PRECORD( FPTN=PRECORD_FPT, STCLASS=" " );
     1084    14313
     1085    14314    2       EOF = %FALSE;
     1086    14315    2       PRECORD_FPT = CONST_PRECORD_FPT;
     1087    14316    2       PRECORD_FPT.V_ = VECTOR( PRECORD_FPT.V );
     1088    14317    2       PRECORD_FPT.V.N# = P_COUNT;
     1089    14318    2       PRECORD_FPT.V.DCB# = P_INFO.DCB#;
     1090    14319
     1091    14320    2       IF P_INFO.FAST
     1092    14321    3       THEN DO;
     1093    14322    3           CALL XSA$PRECORD( PRECORD_FPT, P_INFO.XSA_PARAM$->XSA_PARAM )
     1094    14323    3              ALTRET ( BAD_FAST_PRECORD );
     1095    14324    3           END;
     1096    14325    3       ELSE DO;
     1097    14326    3           CALL M$PRECORD( PRECORD_FPT ) ALTRET ( BAD_NORMAL_PRECORD );
     1098    14327    3           END;
     1099    14328
     1100    14329    2       P_INFO.RECORD_COUNT = P_INFO.RECORD_COUNT + P_COUNT;
     1101    14330
     1102    14331    2       RETURN;
     1103    14332
     1104    14333    2   BAD_NORMAL_PRECORD: ;
     1105    14334    2       ERROR_CODE = #MONERR;
     1106    14335    2       GOTO BAD_PRECORD;
     1107    14336
     1108    14337    2   BAD_FAST_PRECORD: ;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:41   
     1109    14338    2       ERROR_CODE = P_INFO.XSA_PARAM$ -> XSA_PARAM.ERR;
     1110    14339
     1111    14340    2   BAD_PRECORD: ;
     1112    14341    2       EOF = ( ERROR_CODE.ERR# = %E$EOF );
     1113    14342    2       ALTRETURN;
     1114    14343
     1115    14344    2   END PRECORD;
     1116    14345
     1117    14346        %PAGE( ARG=GETDCB, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:42   
             14358    2   /*******************************************************************************
             14359    2   *                                                                              *
             14360    2   *        GETDCB              GETDCB                                                *
             14361    2   *                                                                              *
             14362    2   *******************************************************************************/

     1118    14366    1   GETDCB: PROC( P_INFO, P_DCB_NAME ) ALTRET;
     1119    14367
     1120    14368        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
     1121    14402        %VLP_NAMEV( FPTN=P_DCB_NAME, STCLASS="ALIGNED" );
     1122    14409        %FPT_GETDCB( FPTN=CONST_GETDCB_FPT, STCLASS=CONSTANT );
     1123    14424        %FPT_GETDCB( FPTN=GETDCB_FPT, STCLASS=" " );
     1124    14439
     1125    14440    2       IF P_INFO.DCB# = DCBNUM( NIL )
     1126    14441    3       THEN DO;
     1127    14442    3           GETDCB_FPT = CONST_GETDCB_FPT;
     1128    14443    3           GETDCB_FPT.V_ = VECTOR( GETDCB_FPT.V );
     1129    14444    3           GETDCB_FPT.DCBNUM_ = VECTOR( P_INFO.DCB# );
     1130    14445    3           IF ADDR( P_DCB_NAME ) ~= ADDR(NIL)
     1131    14446    4           THEN DO;
     1132    14447    4               P_INFO.TEMP_DCB = %FALSE;
     1133    14448    4               GETDCB_FPT.DCBNAME_ = VECTOR( P_DCB_NAME );
     1134    14449    4               END;
     1135    14450    4           ELSE DO;
     1136    14451    4               P_INFO.TEMP_DCB = %TRUE;
     1137    14452    4               END;
     1138    14453    3           CALL M$GETDCB( GETDCB_FPT ) ALTRET ( BAD_GETDCB );
     1139    14454        /*N* If M$GETDCB allocated this dcb, set P_INFO.TEMP_DCB  See star#7900 */
     1140    14455    3           END;
     1141    14456
     1142    14457    2       P_INFO.DCB$ = DCBADDR( P_INFO.DCB# );
     1143    14458
     1144    14459    2       RETURN;
     1145    14460
     1146    14461    2   BAD_GETDCB: ;
     1147    14462    2       P_INFO.DCB# = DCBNUM(NIL);
     1148    14463    2       ERROR_CODE = #MONERR;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:43   
     1149    14464    2       ALTRETURN;
     1150    14465
     1151    14466    2   END GETDCB;
     1152    14467
     1153    14468        %PAGE( ARG=RELDCB, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:44   
             14480    2   /*******************************************************************************
             14481    2   *                                                                              *
             14482    2   *        RELDCB              RELDCB                                                *
             14483    2   *                                                                              *
             14484    2   *******************************************************************************/

     1154    14488    1   RELDCB: PROC( P_INFO ) ALTRET;
     1155    14489
     1156    14490        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
     1157    14524        %FPT_RELDCB( FPTN=CONST_RELDCB_FPT, STCLASS=CONSTANT );
     1158    14538        %FPT_RELDCB( FPTN=RELDCB_FPT, STCLASS=" " );
     1159    14552
     1160    14553    2       IF P_INFO.TEMP_DCB AND
     1161    14554    2          P_INFO.DCB# ~= DCBNUM( NIL ) AND
     1162    14555    2          NOT ( ERROR_SET AND P_INFO.DCB# = XUU_PARAM.DCB# )
     1163    14556    3       THEN DO;
     1164    14557    3           RELDCB_FPT = CONST_RELDCB_FPT;
     1165    14558    3           RELDCB_FPT.V_ = VECTOR( RELDCB_FPT.V );
     1166    14559    3           RELDCB_FPT.V.DCB# = P_INFO.DCB#;
     1167    14560    3           CALL M$RELDCB( RELDCB_FPT ) ALTRET ( BAD_RELDCB );
     1168    14561    3           END;
     1169    14562
     1170    14563    2       P_INFO = FILE_INFO_BASE;
     1171    14564    2       RETURN;
     1172    14565
     1173    14566    2   BAD_RELDCB: ;
     1174    14567    2       ERROR_CODE = #MONERR;
     1175    14568    2       ALTRETURN;
     1176    14569
     1177    14570    2   END RELDCB;
     1178    14571
     1179    14572        %PAGE( ARG=GET_XSA_PARAM, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:45   
             14584    2   /*******************************************************************************
             14585    2   *                                                                              *
             14586    2   *        GET_XSA_PARAM              GET_XSA_PARAM                                  *
             14587    2   *                                                                              *
             14588    2   *******************************************************************************/

     1180    14592    1   GET_XSA_PARAM: PROC( P_PARAM$ ) ALTRET;
     1181    14593
     1182    14594    2   DCL P_PARAM$ PTR ALIGNED;
     1183    14595        %XSA_PARAM( FPTN=CONST_XSA_PARAM, STCLASS=CONSTANT, BBUF=NIL, KBUF=NIL );
     1184    14625
     1185    14626    2       IF XSA_PARAM_POOL_ = VECTOR(NIL)
     1186    14627    3       THEN DO;
     1187    14628    3           CALL XUU_PARAM.ALLOCATE$$( XSA_PARAM_POOL_, %XUU#ONE_PAGE )
     1188    14629    4           WHENALTRETURN DO;
     1189    14630    4               XSA_PARAM_POOL_ = VECTOR( NIL );
     1190    14631    4               P_PARAM$ = ADDR(NIL);
     1191    14632    4               RETURN;
     1192    14633    4               END;
     1193    14634    3           XSA_PARAM_POOL_NEXT$ = VBASE(XSA_PARAM_POOL_);
     1194    14635    3           END;
     1195    14636
     1196    14637    2       IF ( POFFC( XSA_PARAM_POOL_NEXT$, VBASE(XSA_PARAM_POOL_) ) + SIZEC( XSA_PARAM )
             14637                )
     1197    14638    2          > VBOUND(XSA_PARAM_POOL_)
     1198    14639    3       THEN DO;
     1199    14640    3           P_PARAM$ = ADDR(NIL);
     1200    14641    3           CALL SET_XUU_ERR( %E$XUU#NO_XSA_MEM, %FALSE );
     1201    14642    3           ALTRETURN;
     1202    14643    3           END;
     1203    14644    3       ELSE DO;
     1204    14645    3           P_PARAM$ = XSA_PARAM_POOL_NEXT$;
     1205    14646    3           XSA_PARAM_POOL_NEXT$ = PINCRW( XSA_PARAM_POOL_NEXT$, SIZEW(XSA_PARAM) );
     1206    14647    3           P_PARAM$->XSA_PARAM = CONST_XSA_PARAM;
     1207    14648    3           END;
     1208    14649
     1209    14650    2   END GET_XSA_PARAM;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:46   
     1210    14651
     1211    14652        %PAGE( ARG=RELEASE_XSA_PARAM, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:47   
             14664    2   /*******************************************************************************
             14665    2   *                                                                              *
             14666    2   *        RELEASE_XSA_PARAM              RELEASE_XSA_PARAM                          *
             14667    2   *                                                                              *
             14668    2   *******************************************************************************/

     1212    14672    1   RELEASE_XSA_PARAM: PROC( P_PARAM$ ) ALTRET;
     1213    14673
     1214    14674    2   DCL P_PARAM$ PTR ALIGNED;
     1215    14675
     1216    14676    2       IF P_PARAM$ ~= ADDR(NIL)
     1217    14677    3       THEN DO;
     1218    14678    3           IF P_PARAM$ = PINCRW( XSA_PARAM_POOL_NEXT$, -SIZEW(XSA_PARAM) )
     1219    14679    4           THEN DO;
     1220    14680    4               XSA_PARAM_POOL_NEXT$ = PINCRW( XSA_PARAM_POOL_NEXT$, -SIZEW(XSA_PARAM) )
             14680                        ;
     1221    14681    4               END;
     1222    14682    4           ELSE DO;
     1223    14683    4               CALL SET_XUU_ERR( %E$XUU#BAD_REL, %FALSE );
     1224    14684    4               ALTRETURN;
     1225    14685    4               END;
     1226    14686    3           END;
     1227    14687
     1228    14688    2   END RELEASE_XSA_PARAM;
     1229    14689
     1230    14690        %PAGE( ARG=IO_ERR, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:48   
             14702    2   /*******************************************************************************
             14703    2   *                                                                              *
             14704    2   *        IO_ERR              IO_ERR                                                *
             14705    2   *                                                                              *
             14706    2   *******************************************************************************/

     1231    14710    1   IO_ERR: PROC ( P_FILE, P_PASS_BUF ) ALTRET;
     1232    14711
     1233    14712    2   DCL P_FILE UBIN WORD ALIGNED;
     1234    14713    2   DCL P_PASS_BUF BIT(1) ALIGNED;
     1235    14714
     1236    14715    2   REC_IO_ERR: ENTRY( P_FILE, P_PASS_BUF ) ALTRET;
     1237    14716
     1238    14717    2       CALL SET_IO_ERROR( P_FILE, %TRUE, P_PASS_BUF ) ALTRET( KILL );
     1239    14718
     1240    14719    2       RETURN;
     1241    14720
     1242    14721    2   KILL_IO_ERR: ENTRY( P_FILE ) ALTRET;
     1243    14722
     1244    14723    2       CALL SET_IO_ERROR( P_FILE, %FALSE );
     1245    14724
     1246    14725    2   KILL: ;
     1247    14726    2       CALL CLEANUP;
     1248    14727    2       ALTRETURN;
     1249    14728
     1250    14729    2   END IO_ERR;
     1251    14730
     1252    14731        %PAGE( ARG=XUU_ERR, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:49   
             14743    2   /*******************************************************************************
             14744    2   *                                                                              *
             14745    2   *        XUU_ERR              XUU_ERR                                              *
             14746    2   *                                                                              *
             14747    2   *******************************************************************************/

     1253    14751    1   XUU_ERR: PROC( P_ERROR_NUM, P_PASS_BUF ) ALTRET;
     1254    14752
     1255    14753    2   DCL P_ERROR_NUM UBIN WORD ALIGNED;
     1256    14754    2   DCL P_PASS_BUF BIT(1) ALIGNED;
     1257    14755
     1258    14756    2   REC_XUU_ERR: ENTRY( P_ERROR_NUM, P_PASS_BUF ) ALTRET;
     1259    14757
     1260    14758    2       CALL SET_XUU_ERR( P_ERROR_NUM, %TRUE, P_PASS_BUF ) ALTRET( KILL );
     1261    14759
     1262    14760    2       RETURN;
     1263    14761
     1264    14762    2   KILL_XUU_ERR: ENTRY( P_ERROR_NUM ) ALTRET;
     1265    14763
     1266    14764    2       CALL SET_XUU_ERR( P_ERROR_NUM, %FALSE );
     1267    14765
     1268    14766    2   KILL: ;
     1269    14767    2       CALL CLEANUP;
     1270    14768
     1271    14769    2       ALTRETURN;
     1272    14770
     1273    14771    2   END XUU_ERR;
     1274    14772
     1275    14773        %PAGE( ARG=SET_XUU_ERR, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:50   
             14785    2   /*******************************************************************************
             14786    2   *                                                                              *
             14787    2   *        SET_XUU_ERR              SET_XUU_ERR                                      *
             14788    2   *                                                                              *
             14789    2   *******************************************************************************/

     1276    14793    1   SET_XUU_ERR: PROC( P_ERROR_NUM, P_RECOVERABLE, P_PASS_BUF ) ALTRET;
     1277    14794
     1278    14795    2   DCL P_ERROR_NUM UBIN WORD ALIGNED;
     1279    14796    2   DCL P_RECOVERABLE BIT(1) ALIGNED;
     1280    14797    2   DCL P_PASS_BUF BIT(1) ALIGNED;
     1281    14798    2   DCL TEMP_VEC VECTOR;
     1282    14799        %VLP_ERRCODE( FPTN=TEMP_CODE, STCLASS=" " );
     1283    14844
     1284    14845
     1285    14846    2       TEMP_CODE = ERROR_CODE_BASE;
     1286    14847    2       TEMP_CODE.ERR# = P_ERROR_NUM;
     1287    14848
     1288    14849    2       IF ( P_RECOVERABLE = %TRUE ) AND
     1289    14850    2          ( XUU_PARAM.ERROR_PROC$$ ~= ENTADDR(NIL) )
     1290    14851    3       THEN DO;
     1291    14852    3           IF P_PASS_BUF
     1292    14853    4           THEN DO;
     1293    14854    4               TEMP_VEC = P_BUF_;
     1294    14855    4               VBOUND(TEMP_VEC) = ARS - 1;
     1295    14856    4               CALL XUU_PARAM.ERROR_PROC$$( TEMP_CODE, TEMP_VEC ) ALTRET( NICE_TRY );
     1296    14857    4               END;
     1297    14858    4           ELSE DO;
     1298    14859    4               CALL XUU_PARAM.ERROR_PROC$$( TEMP_CODE ) ALTRET( NICE_TRY );
     1299    14860    4               END;
     1300    14861    3           RETURN;
     1301    14862    3           END;
     1302    14863
     1303    14864    2   NICE_TRY: ;
     1304    14865
     1305    14866    2       IF NOT ERROR_SET
     1306    14867    3       THEN DO;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:51   
     1307    14868    3           ERROR_SET = %TRUE;
     1308    14869    3           XUU_PARAM.FLAGS = XUU_PARAM.FLAGS & %CLEAR_OUTPUT_FLAGS;
     1309    14870    3           XUU_PARAM.FLAGS.XUU_ERR# = %TRUE;
     1310    14871    3           XUU_PARAM.ERRCODE = TEMP_CODE;
     1311    14872    3           IF ADDR( P_PASS_BUF ) ~= ADDR(NIL)
     1312    14873    4           THEN DO;
     1313    14874    4               XUU_PARAM.FLAGS.BAD_UPDATE# = P_PASS_BUF;
     1314    14875    4               END;
     1315    14876    3           END;
     1316    14877
     1317    14878    2       ALTRETURN;
     1318    14879
     1319    14880    2   END SET_XUU_ERR;
     1320    14881
     1321    14882        %PAGE( ARG=SET_IO_ERROR, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:52   
             14894    2   /*******************************************************************************
             14895    2   *                                                                              *
             14896    2   *        SET_IO_ERROR              SET_IO_ERROR                                    *
             14897    2   *                                                                              *
             14898    2   *******************************************************************************/

     1322    14902    1   SET_IO_ERROR: PROC( P_FILE, P_RECOVERABLE, P_PASS_BUF ) ALTRET;
     1323    14903
     1324    14904    2   DCL P_FILE UBIN WORD ALIGNED;
     1325    14905    2   DCL P_RECOVERABLE BIT(1) ALIGNED;
     1326    14906    2   DCL P_PASS_BUF BIT(1) ALIGNED;
     1327    14907    2   DCL TEMP_VEC VECTOR;
     1328    14908
     1329    14909
     1330    14910    2       IF NOT ERROR_SET
     1331    14911    3       THEN DO;
     1332    14912    3           IF ( P_RECOVERABLE = %TRUE ) AND
     1333    14913    3              ( XUU_PARAM.ERROR_PROC$$ ~= ENTADDR(NIL) )
     1334    14914    4           THEN DO;
     1335    14915    4               IF P_PASS_BUF
     1336    14916    5               THEN DO;
     1337    14917    5                   TEMP_VEC = P_BUF_;
     1338    14918    5                   VBOUND(TEMP_VEC) = ARS - 1;
     1339    14919    5                   CALL XUU_PARAM.ERROR_PROC$$( ERROR_CODE, TEMP_VEC ) ALTRET (
             14919                            NICE_TRY );
     1340    14920    5                   END;
     1341    14921    5               ELSE DO;
     1342    14922    5                   CALL XUU_PARAM.ERROR_PROC$$( ERROR_CODE ) ALTRET ( NICE_TRY );
     1343    14923    5                   END;
     1344    14924    4               RETURN;
     1345    14925    4               END;
     1346    14926
     1347    14927    3   NICE_TRY: ;
     1348    14928
     1349    14929    3           ERROR_SET = %TRUE;
     1350    14930    3           XUU_PARAM.FLAGS = XUU_PARAM.FLAGS & %CLEAR_OUTPUT_FLAGS;
     1351    14931    3           XUU_PARAM.ERRCODE = ERROR_CODE;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:53   
     1352    14932
     1353    14933    4           DO CASE P_FILE;
     1354    14934    4           CASE ( %SI_ERR );
     1355    14935    4               XUU_PARAM.SI_ERRCODE = ERROR_CODE;
     1356    14936    4               XUU_PARAM.DCB# = SI_INFO.DCB#;
     1357    14937    4               XUU_PARAM.FLAGS.BASE# = %TRUE;
     1358    14938
     1359    14939    4           CASE ( %UI_ERR );
     1360    14940    4               XUU_PARAM.UI_ERRCODE = ERROR_CODE;
     1361    14941    4               XUU_PARAM.DCB# = UI_INFO.DCB#;
     1362    14942    4               XUU_PARAM.FLAGS.UP_DATE# = %TRUE;
     1363    14943
     1364    14944    4           CASE ( %LU_ERR );
     1365    14945    4               XUU_PARAM.UI_ERRCODE = ERROR_CODE;
     1366    14946    4               XUU_PARAM.DCB# = LU_INFO.DCB#;
     1367    14947    4               XUU_PARAM.FLAGS.UP_DATE# = %TRUE;
     1368    14948
     1369    14949    4           CASE ( %INCL_ERR );
     1370    14950    4               XUU_PARAM.O.INCL_ERRCODE = ERROR_CODE;
     1371    14951    4               XUU_PARAM.DCB# = INCL_INFO.DCB#(TEMP_INCL_LEVEL);
     1372    14952    4               XUU_PARAM.FLAGS.INCLUDE# = %TRUE;
     1373    14953
     1374    14954    4           CASE ( %SO_ERR );
     1375    14955    4               XUU_PARAM.C.SO_ERRCODE = ERROR_CODE;
     1376    14956    4               XUU_PARAM.DCB# = SO_INFO.DCB#;
     1377    14957    4               XUU_PARAM.FLAGS.SO_ERR# = %TRUE;
     1378    14958
     1379    14959    4           CASE ( ELSE );
     1380    14960    4               XUU_PARAM.ERRCODE = ERROR_CODE;
     1381    14961    4               XUU_PARAM.DCB# = DCBNUM(NIL);
     1382    14962    4               XUU_PARAM.FLAGS.XUU_ERR# = %TRUE;
     1383    14963
     1384    14964    4               END;
     1385    14965    3           END;
     1386    14966
     1387    14967    2       ALTRETURN;
     1388    14968
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:54   
     1389    14969    2   END SET_IO_ERROR;
     1390    14970
     1391    14971        %PAGE( ARG=CLEANUP_FILE, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:55   
             14983    2   /*******************************************************************************
             14984    2   *                                                                              *
             14985    2   *        CLEANUP_FILE              CLEANUP_FILE                                    *
             14986    2   *                                                                              *
             14987    2   *******************************************************************************/

     1392    14991    1   CLEANUP_FILE: PROC( P_INFO ) ALTRET;
     1393    14992
     1394    14993        %FILE_INFO( NAME=P_INFO,STCLASS=" " );
     1395    15027    2   DCL ALT_FLAG BIT(1) ALIGNED;
     1396    15028
     1397    15029    2       ALT_FLAG = %FALSE;
     1398    15030
     1399    15031    2       CALL CLOSE( P_INFO )
     1400    15032    3       WHENALTRETURN DO;
     1401    15033    3           ALT_FLAG = %TRUE;
     1402    15034    3           END;
     1403    15035
     1404    15036    2       CALL RELDCB( P_INFO )
     1405    15037    3       WHENALTRETURN DO;
     1406    15038    3           ALT_FLAG = %TRUE;
     1407    15039    3           END;
     1408    15040
     1409    15041    2       IF ALT_FLAG AND NOT ERROR_SET
     1410    15042    2       THEN ALTRETURN;
     1411    15043
     1412    15044    2   END CLEANUP_FILE;
     1413    15045
     1414    15046        %PAGE( ARG=CLEANUP, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:56   
             15058    2   /*******************************************************************************
             15059    2   *                                                                              *
             15060    2   *        CLEANUP              CLEANUP                                              *
             15061    2   *                                                                              *
             15062    2   *******************************************************************************/

     1415    15066    1   CLEANUP: PROC ALTRET;
     1416    15067
     1417    15068    2   DCL I SBIN WORD;
     1418    15069    2   DCL ALT_FLAG BIT(1) ALIGNED;
     1419    15070
     1420    15071    2       ALT_FLAG = %FALSE;
     1421    15072    2       CURRENT_STATE = %#UNINITIALIZED;
     1422    15073    2       INCL_SAVE_STATE = %#UNINITIALIZED;
     1423    15074
     1424    15075    3       DO I = %(MAX_INCL_LEVEL-1) DOWNTO 0;
     1425    15076    3           CALL CLEANUP_FILE( INCL_INFO(I) )
     1426    15077    4           WHENALTRETURN DO;
     1427    15078    4               TEMP_INCL_LEVEL = I;
     1428    15079    4               CALL SET_IO_ERROR( %INCL_ERR, %FALSE );
     1429    15080    4               ALT_FLAG = %TRUE;
     1430    15081    4               END;
     1431    15082    3           END;
     1432    15083
     1433    15084    2       CALL CLEANUP_FILE( SO_INFO )
     1434    15085    3       WHENALTRETURN DO;
     1435    15086    3           CALL SET_IO_ERROR( %SO_ERR, %FALSE );
     1436    15087    3           ALT_FLAG = %TRUE;
     1437    15088    3           END;
     1438    15089
     1439    15090    2       CALL CLEANUP_FILE( UI_INFO )
     1440    15091    3       WHENALTRETURN DO;
     1441    15092    3           CALL SET_IO_ERROR( %UI_ERR, %FALSE );
     1442    15093    3           ALT_FLAG = %TRUE;
     1443    15094    3           END;
     1444    15095
     1445    15096    2       CALL CLEANUP_FILE( SI_INFO )
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:57   
     1446    15097    3       WHENALTRETURN DO;
     1447    15098    3           CALL SET_IO_ERROR ( %SI_ERR, %FALSE );
     1448    15099    3           ALT_FLAG = %TRUE;
     1449    15100    3           END;
     1450    15101
     1451    15102    2       IF XSA_PARAM_POOL_ ~= VECTOR(NIL)
     1452    15103    3       THEN DO;
     1453    15104    3           CALL XUU_PARAM.RELEASE$$( XSA_PARAM_POOL_ );
     1454    15105    3           XSA_PARAM_POOL_ = VECTOR(NIL);
     1455    15106    3           END;
     1456    15107
     1457    15108    2       IF ALT_FLAG
     1458    15109    2       THEN ALTRETURN;
     1459    15110
     1460    15111    2   END CLEANUP;
     1461    15112
     1462    15113        %PAGE( ARG=PRINT_UPDATE, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:58   
             15125    2   /*******************************************************************************
             15126    2   *                                                                              *
             15127    2   *        PRINT_UPDATE              PRINT_UPDATE                                    *
             15128    2   *                                                                              *
             15129    2   *******************************************************************************/

     1463    15133        /*N* Try to help this out some by using REC_IO_ERR for recoverable
     1464    15134            sorts of problems and doing something intelligent about leaving
     1465    15135            things in a usable state. Also need to report a message saying
     1466    15136            what is being done.
     1467    15137        */
     1468    15138    1   PRINT_UPDATE: PROC ALTRET;
     1469    15139
     1470    15140        %FILE_INFO( NAME=UI_SCRATCH_INFO, STCLASS=AUTO );
     1471    15174        %FPT_OPEN( FPTN=OPEN_SCRATCH, STCLASS=CONSTANT, ASN=FILE, DISP=SCRATCH, FUN=CREATE,
             15174            ORG=CONSEC );
     1472    15283
     1473    15284    2   DCL 1 LU_BUF ALIGNED,
     1474    15285    2         2 HEAD,
     1475    15286    2           3 KEY CHAR(9) CALIGNED,
     1476    15287    2           3 SP CHAR(3) CALIGNED,
     1477    15288    2         2 BUF CHAR(256) ALIGNED;
     1478    15289
     1479    15290    2   DCL LEN SBIN;
     1480    15291    2   DCL BUF_VECT VECTOR;
     1481    15292    2   DCL WRITE_TEMP BIT(1) ALIGNED;
     1482    15293
     1483    15294
     1484    15295    2       IF LU_INFO.DCB# ~= DCBNUM(NIL)
     1485    15296    3       THEN DO;
     1486    15297    3           LU_BUF.HEAD.SP = ' ';
     1487    15298    3           LU_BUF.BUF = #USER_BUFFER;
     1488    15299    3           LU_BUF.HEAD.KEY = XUU_PARAM.RE_ASCII_KEY.CHAR1_9;
     1489    15300    3           LEN = ARS;
     1490    15301    3           CALL DUMP_LU_BUF ALTRET ( LU_PRINT_ERR );
     1491    15302    3           END;
     1492    15303
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:59   
     1493    15304    2       RETURN;
     1494    15305
     1495    15306    2   PRINT_SAVED_UPDATE: ENTRY ALTRET;
     1496    15307
     1497    15308    2       IF LU_INFO.DCB# ~= DCBNUM(NIL)
     1498    15309    3       THEN DO;
     1499    15310    3           LU_BUF.HEAD.KEY = SAVED_UPDATE.KEY;
     1500    15311    3           LU_BUF.HEAD.SP = ' ';
     1501    15312    3           LU_BUF.BUF = SAVED_UPDATE.TEXT;
     1502    15313    3           LEN = SAVED_UPDATE.ARS;
     1503    15314    3           CALL DUMP_LU_BUF ALTRET( LU_PRINT_ERR );
     1504    15315    3           END;
     1505    15316
     1506    15317    2       RETURN;
     1507    15318
     1508    15319    2   PREPRINT_UPDATES:ENTRY ALTRET;
     1509    15320
     1510    15321    2       LU_BUF.HEAD.SP = ' ';
     1511    15322    2       READ_FPT.BUF_ = VECTOR( LU_BUF.BUF );
     1512    15323    2       BUF_VECT = VECTOR( LU_BUF.BUF );
     1513    15324    2       UI_SCRATCH_INFO = FILE_INFO_BASE;
     1514    15325
     1515    15326    2       IF ( UI_INFO.DCB$->F$DCB.ASN# = %FILE# )
     1516    15327    2          OR ( UI_INFO.DCB$->F$DCB.ASN# = %TAPE# )
     1517    15328    3       THEN DO;
     1518    15329    3           WRITE_TEMP = %FALSE;
     1519    15330    3           END;
     1520    15331    3       ELSE DO;
     1521    15332    3           UI_SCRATCH_INFO.FAST = %FALSE;
     1522    15333    3           CALL GETDCB( UI_SCRATCH_INFO ) ALTRET ( UI_ERR );
     1523    15334    3           CALL OPEN( UI_SCRATCH_INFO, ADDR(OPEN_SCRATCH) ) ALTRET ( UI_ERR );
     1524    15335    3           WRITE_TEMP = %TRUE;
     1525    15336    3           END;
     1526    15337
     1527    15338    2   PREPRINT_LOOP:
     1528    15339    3       DO WHILE %TRUE;
     1529    15340    3           CALL READ( UI_INFO ) ALTRET ( BETTER_BE_EOF );
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:60   
     1530    15341    3           LU_BUF.HEAD.KEY = XUU_PARAM.RE_ASCII_KEY.CHAR1_9;
     1531    15342    3           LEN = ARS;
     1532    15343    3           CALL DUMP_LU_BUF ALTRET ( LU_ERR );
     1533    15344    3           IF WRITE_TEMP
     1534    15345    4           THEN DO;
     1535    15346    4               IF ARS ~= 0
     1536    15347    5               THEN DO;
     1537    15348    5                   VBOUND( BUF_VECT ) = ARS - 1;
     1538    15349    5                   CALL WRITE( UI_SCRATCH_INFO, BUF_VECT ) ALTRET ( LU_ERR );
     1539    15350    5                   END;
     1540    15351    5               ELSE DO;
     1541    15352    5                   CALL WRITE( UI_SCRATCH_INFO, VECTOR(NIL) ) ALTRET ( LU_ERR );
     1542    15353    5                   END;
     1543    15354    4               END;
     1544    15355    3           END PREPRINT_LOOP;
     1545    15356
     1546    15357    2   BETTER_BE_EOF: ;
     1547    15358    2       IF NOT EOF
     1548    15359    3       THEN DO;
     1549    15360    3           GOTO UI_ERR;
     1550    15361    3           END;
     1551    15362
     1552    15363    2       IF WRITE_TEMP
     1553    15364    3       THEN DO;
     1554    15365    3           CALL CLEANUP_FILE( UI_INFO ) ALTRET ( UI_ERR );
     1555    15366    3           UI_INFO = UI_SCRATCH_INFO;
     1556    15367    3           END;
     1557    15368
     1558    15369    2       CALL PFIL ( UI_INFO, %#PFIL_BOF ) ALTRET ( UI_ERR );
     1559    15370
     1560    15371    2       LU_INFO = FILE_INFO_BASE;
     1561    15372
     1562    15373    2       RETURN;
     1563    15374
     1564    15375    2   LU_PRINT_ERR: ;
     1565    15376    2       CALL KILL_IO_ERR( %LU_ERR );
     1566    15377    2       GOTO BAD_PRINT;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:61   
     1567    15378
     1568    15379    2   UI_ERR: ;
     1569    15380    2       CALL CLEANUP_FILE( UI_SCRATCH_INFO );
     1570    15381    2       CALL KILL_IO_ERR( %UI_ERR );
     1571    15382    2       GOTO BAD_PRINT;
     1572    15383
     1573    15384    2   LU_ERR: ;
     1574    15385    2       CALL CLEANUP_FILE( UI_SCRATCH_INFO );
     1575    15386    2       CALL KILL_IO_ERR( %LU_ERR );
     1576    15387    2       GOTO BAD_PRINT;
     1577    15388
     1578    15389    2   BAD_PRINT: ;
     1579    15390    2       ALTRETURN;
     1580    15391
     1581    15392
     1582    15393    2   DUMP_LU_BUF: PROC ALTRET;
     1583    15394
     1584    15395    3   DCL TEMP_VECT VECTOR;
     1585    15396
     1586    15397    3       TEMP_VECT = VECTOR( LU_BUF );
     1587    15398    3       VBOUND( TEMP_VECT ) = LEN + LENGTHC( LU_BUF.HEAD ) - 1;
     1588    15399    3       CALL WRITE( LU_INFO, TEMP_VECT ) ALTRET ( BAD_LU );
     1589    15400    3       RETURN;
     1590    15401
     1591    15402    3   BAD_LU: ;
     1592    15403    3       ALTRETURN;
     1593    15404
     1594    15405    3   END DUMP_LU_BUF;
     1595    15406
     1596    15407    2   END PRINT_UPDATE;
     1597    15408
     1598    15409        %PAGE( ARG=SOURCE_OUT, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:62   
             15421    2   /*******************************************************************************
             15422    2   *                                                                              *
             15423    2   *        SOURCE_OUT              SOURCE_OUT                                        *
             15424    2   *                                                                              *
             15425    2   *******************************************************************************/

     1599    15429        /*N* Try to help this out some by using REC_IO_ERR for recoverable
     1600    15430            sorts of problems and doing something intelligent about leaving
     1601    15431            things in a usable state. Also need to report a message saying
     1602    15432            what is being done.
     1603    15433        */
     1604    15434    1   SOURCE_OUT: PROC ALTRET;
     1605    15435
     1606    15436        %FPT_OPEN( FPTN=OPEN_SO, STCLASS="CONSTANT", FUN=CREATE );
     1607    15545        %VLP_NAME( FPTN=SO_DCB_NAME, STCLASS="CONSTANT ALIGNED", NAME='M$SO' );
     1608    15572    2   DCL TEMP_CHAR8 CHAR(8) DALIGNED;
     1609    15573    2   DCL 1 KEY ALIGNED,
     1610    15574    2         2 LEN UBIN BYTE CALIGNED,
     1611    15575    2         2 K UBIN(27) UNAL;
     1612    15576
     1613    15577    2       IF XUU_PARAM.FLAGS.INCLUDE#
     1614    15578    2       THEN RETURN;
     1615    15579
     1616    15580    2       IF SO_INFO.DCB# = DCBNUM(NIL)
     1617    15581    3       THEN DO;
     1618    15582    3           CALL GETDCB( SO_INFO, SO_DCB_NAME ) ALTRET ( BAD_SOURCE_OUT );
     1619    15583    3           SO_INFO.FAST = %FALSE;
     1620    15584    3           IF NOT ( SO_INFO.DCB$->F$DCB.FCD# )
     1621    15585    4           THEN DO;
     1622    15586    4               CALL OPEN( SO_INFO, ADDR(OPEN_SO) ) ALTRET ( BAD_SOURCE_OUT );
     1623    15587    4               SO_INFO.RECORD_COUNT = 1;
     1624    15588    4               END;
     1625    15589    3           IF SO_INFO.DCB$->F$DCB.ORG# = %KEYED#
     1626    15590    4           THEN DO;
     1627    15591    4               SO_INFO.KEY_TYPE = %#EDIT_KEY;
     1628    15592    4               END;
     1629    15593    3           END;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:63   
     1630    15594
     1631    15595    2       XUU_PARAM.RE_ASCII_KEY.CHAR10 = ' ';
     1632    15596
     1633    15597    2       IF SO_INFO.KEY_TYPE = %#CONSEC
     1634    15598    3       THEN DO;
     1635    15599    3           CALL BINCHAR( TEMP_CHAR8, SO_INFO.RECORD_COUNT );
     1636    15600    3           CALL EDITCHAR( XUU_PARAM.RE_ASCII_KEY.CHAR1_9, 0, 9, SEQ_MOPS, TEMP_CHAR8 );
     1637    15601    3           CALL WRITE( SO_INFO ) ALTRET ( BAD_SOURCE_OUT );
     1638    15602    3           END;
     1639    15603    3       ELSE DO;
     1640    15604    3           CALL BINCHAR( TEMP_CHAR8, SO_INFO.RECORD_COUNT*1000 );
     1641    15605    3           CALL EDITCHAR( XUU_PARAM.RE_ASCII_KEY.CHAR1_9, 0, 9, EDIT_MOPS, TEMP_CHAR8 )
             15605                    ;
     1642    15606    3           KEY.LEN = 3;
     1643    15607    3           KEY.K = SO_INFO.RECORD_COUNT * 1000;
     1644    15608
     1645    15609    3           CALL WRITE( SO_INFO, ,VECTOR(KEY) ) ALTRET ( BAD_SOURCE_OUT );
     1646    15610    3           END;
     1647    15611
     1648    15612    2       RETURN;
     1649    15613
     1650    15614    2   BAD_SOURCE_OUT: ;
     1651    15615    2       ALTRETURN;
     1652    15616
     1653    15617    2   END SOURCE_OUT;
     1654    15618
     1655    15619    1   END XUU$READ;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:64   
--  Include file information  --

   F$CP6V_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XUU_MACROS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUU$READ.

   Procedure XUU$READ requires 2204 words for executable code.
   Procedure XUU$READ requires 226 words of local(AUTO) storage.

    No errors detected in file XUU$READ.:E05TSI    .

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:65   

 Object Unit name= XUU$READ                                   File name= XUU$READ.:E05TOU
 UTS= JUL 30 '97 09:44:13.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    399    617  XUU$READ
    2   Data  even  none   102    146  XUU$READ
    3   Proc  even  none  2204   4234  XUU$READ
    4  RoData even  none    63     77  XUU$READ

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        2  XUU$READ
     3    461          yes     yes      Std        1  XUU$OPEN
     3    776          yes     yes      Std        1  XUU$CLOSE
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:66   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XSA$READ
 yes     yes           Std       2 XSA$WRITE
 yes     yes           Std       2 XSA$PFIL
 yes     yes           Std       2 XSA$OPEN
 yes     yes           Std       2 XSA$CLOSE
 yes     yes           Std       2 XSA$PRECORD
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:67   


        1        1        /*M* XUU$READ - Common update package */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*X* PLM=4,STI=0,IND=4,CTI=3,DCI=4,ECI=4,CSI=0,THI=0,DTI=0,
        9        9             ENI=4,CLM=0,SQB,NTB,MOC,CCI=3,NLB,MCL=0,EDMC */
       10       10
       11       11        /*E*
       12       12            ERROR: XUU-E$XUU#UN_SORTED-1
       13       13            MESSAGE: A previous plus record specified a range which illegally
       14       14                     overlaps the range of this plus record.
       15       15        */
       16       16        /*E*
       17       17            ERROR: XUU-E$XUU#BAD_UPDATE-1
       18       18            MESSAGE: Illegal syntax for plus record. A plus record should be:
       19       19                      +num[,num] comment
       20       20        */
       21       21        /*E*
       22       22            ERROR: XUU-E$XUU#BAD_OPEN_BITS-4
       23       23            MESSAGE: Processor error: Conflicting option flags specified to XUU$OPEN.
       24       24        */
       25       25        /*E*
       26       26            ERROR: XUU-E$XUU#NIL_OPEN_FPT-4
       27       27            MESSAGE: Processor error: Pointer to OPEN_FPT for include file is NIL.
       28       28        */
       29       29        /*E*
       30       30            ERROR: XUU-E$XUU#INCL_TOO_DEEP-2
       31       31            MESSAGE: Include file maximum nesting depth (10) has been exceeded.
       32       32        */
       33       33        /*E*
       34       34            ERROR: XUU-E$XUU#EXTRA_RECS-1
       35       35            MESSAGE: Update records found after the +END are illegal.
       36       36                     They have been ignored.
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:68   
       37       37        */
       38       38        /*E*
       39       39            ERROR: XUU-E$XUU#UPDATE_PAST_EOF-1
       40       40            MESSAGE: This update record illegally specifies a range past the
       41       41                     end of the source file. All updates following this one
       42       42                     have been ignored.
       43       43        */
       44       44        /*E*
       45       45            ERROR: XUU-E$XUU#UN_INITIALIZED-4
       46       46            MESSAGE: Processor error: XUU$READ called with no source file open.
       47       47        */
       48       48        /*E*
       49       49            ERROR: XUU-E$XUU#NO_XSA_MEM-4
       50       50            MESSAGE: XUU internal error: Not enough memory for XSA param blocks.
       51       51                     Please report this in STARLOG.
       52       52        */
       53       53        /*E*
       54       54            ERROR: XUU-E$XUU#BAD_REL-4
       55       55            MESSAGE: XUU internal error: XSA param blocks released out of order.
       56       56                     Please report this in STARLOG.
       57       57        */
       58       58        /*E*
       59       59            ERROR: XUU-E$XUU#BAD_PLUS_END-1
       60       60            MESSAGE: Illegal syntax for +END record. At least one blank must
       61       61                     separate END from any commentary on the record.
       62       62        */
       63       63        /*E*
       64       64            ERROR: XUU-E$XUU#PLUS_ONLY-1
       65       65            MESSAGE: Illegal syntax for plus record. A "+" was found with no
       66       66                     update range specified.
       67       67        */
       68       68        /*E*
       69       69            ERROR: XUU-E$XUU#BAD_RANGE-1
       70       70            MESSAGE: The ending line number of an update packet must be
       71       71                     greater than or equal to its starting line number.
       72       72        */
       73       73
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:69   
       74       74        %EJECT;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:70   
       75       75        XUU$READ:PROC ( XUU_PARAM, P_BUF_ ) ALTRET;

     75  3 000000   000000 700200 xent  XUU$READ     TSX0  ! X66_AUTO_2
         3 000001   000342 000002                    ZERO    226,2

       76       76
       77       77        %INCLUDE XUU_MACROS_C;
       78      221
       79      222        %PAGE( ARG=Includes );

               234        /*******************************************************************************
               235        *                                                                              *
               236        *        Includes              Includes                                           *
               237        *                                                                              *
               238        *******************************************************************************/

       80      242        %INCLUDE XU_MACRO_C;
       81     3348        %INCLUDE XU_PERR_C;
       82     3539        %INCLUDE XS_MACRO_C;
       83     3583        %INCLUDE CP_6;
       84     9142        %INCLUDE CP_6_SUBS;
       85     9682        %INCLUDE B_MICROPS_C;
       86     9854        %INCLUDE B_ERRORS_C;
       87    10981        %INCLUDE F$CP6V_C;
       88    11207
       89    11208        %PAGE( ARG=EQUs and SUBs );

             11220    1   /*******************************************************************************
             11221    1   *                                                                              *
             11222    1   *        EQUs and SUBs              EQUs and SUBs                                 *
             11223    1   *                                                                              *
             11224    1   *******************************************************************************/

       90    11228        %XUU_STATES;
       91    11236        %XUU_MISC;
       92    11262        %XUU$ALLOC_TYPES;
       93    11285        %SUB #MONERR = "B$TCB$->B$TCB.ALT$->B$ALT.ERR";
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:71   
       94    11286        %SUB #USER_BUFFER = "USER_BUF$->BASED_BUFFER";
       95    11287        %EQU MAX_INCL_LEVEL = 10 ;
       96    11288        %EQU MAX_BUFFER_LEN = 255 ;
       97    11289        %EQU EDIT_KEY_SIZE = 3 ;
       98    11290        %EQU CLEAR_OUTPUT_FLAGS = '070770'O ;
       99    11291
      100    11292        %PAGE( ARG=Parameters );

             11304    1   /*******************************************************************************
             11305    1   *                                                                              *
             11306    1   *        Parameters              Parameters                                       *
             11307    1   *                                                                              *
             11308    1   *******************************************************************************/

      101    11312        %XUU_PARAM( FPTN=XUU_PARAM, STCLASS=" " );
      102    11747    1   DCL P_BUF_ VECTOR ALIGNED;
      103    11748
      104    11749        %PAGE( ARG=Entries );

             11761    1   /*******************************************************************************
             11762    1   *                                                                              *
             11763    1   *        Entries              Entries                                             *
             11764    1   *                                                                              *
             11765    1   *******************************************************************************/

      105    11769        %XUU_XSA_ENTRIES;
      106    11777
      107    11778        %PAGE( ARG=External Data );

             11790    1   /*******************************************************************************
             11791    1   *                                                                              *
             11792    1   *        External Data              External Data                                 *
             11793    1   *                                                                              *
             11794    1   *******************************************************************************/

      108    11798    1   DCL B$TCB$ PTR SYMREF;
      109    11799
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:72   
      110    11800        %PAGE( ARG=Constant Data );

             11812    1   /*******************************************************************************
             11813    1   *                                                                              *
             11814    1   *        Constant Data              Constant Data                                 *
             11815    1   *                                                                              *
             11816    1   *******************************************************************************/

      111    11820        %VLP_NAME( FPTN=SI_DCB_NAME, STCLASS="CONSTANT ALIGNED", NAME='M$SI' );
      112    11847        %VLP_NAME( FPTN=UI_DCB_NAME, STCLASS="CONSTANT ALIGNED", NAME='M$UI' );
      113    11874
      114    11875        %VLP_ERRCODE( FPTN=ERROR_CODE_BASE, STCLASS=CONSTANT, FCG='XU', MID='U' );
      115    11920
      116    11921        %FILE_INFO( NAME=FILE_INFO_BASE, STCLASS=CONSTANT );
      117    11955
      118    11956    1   DCL EDIT_MOPS(0:4) BIT(9) CALIGNED CONSTANT INIT(%MVZB4,%MVC1,%SES10,%INSB7,%MVC3);
      119    11957    1   DCL SEQ_MOPS(0:2) BIT(9) CALIGNED CONSTANT INIT(%INSM1,%MVZB7,%MVC1);
      120    11958    1   DCL SEARCH_TABLE(0:511) UBIN BYTE CALIGNED CONSTANT INIT
      121    11959    1    ( %#JUNK*9, %#BLANK, %#JUNK*22, %#BLANK, %#JUNK*11,
      122    11960    1    %#COMMA, %#JUNK*3, %#NUMERIC*10, %#JUNK*0 );
      123    11961
      124    11962        %PAGE( ARG=Static Data );

             11974    1   /*******************************************************************************
             11975    1   *                                                                              *
             11976    1   *        Static Data              Static Data                                     *
             11977    1   *                                                                              *
             11978    1   *******************************************************************************/

      125    11982        %FPT_READ( FPTN=READ_FPT, STCLASS=STATIC, KEYR=YES );
      126    12021
      127    12022    1   DCL XSA_PARAM_POOL_ VECTOR STATIC INIT(VECTOR(NIL));
      128    12023    1   DCL XSA_PARAM_POOL_NEXT$ PTR ALIGNED STATIC;
      129    12024
      130    12025        %FILE_INFO( NAME=SI_INFO, STCLASS=STATIC );
      131    12059        %FILE_INFO( NAME=UI_INFO, STCLASS=STATIC );
      132    12093        %FILE_INFO( NAME=SO_INFO, STCLASS=STATIC );
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:73   
      133    12127        %FILE_INFO( NAME=LU_INFO, STCLASS=STATIC );
      134    12161        %FILE_INFO( NAME="INCL_INFO(0:%(MAX_INCL_LEVEL-1))", STCLASS=STATIC );
      135    12195
      136    12196    1   DCL NRECS_IN_SOURCE SBIN WORD STATIC INIT(0);
      137    12197    1   DCL CURRENT_STATE UBIN HALF ALIGNED STATIC INIT( %#UNINITIALIZED );
      138    12198    1   DCL NEXT_UPDATE_POSITION SBIN WORD ALIGNED STATIC;
      139    12199    1   DCL SI_SKIP_COUNT SBIN WORD ALIGNED STATIC;
      140    12200    1   DCL INCL_LEVEL SBIN HALF HALIGNED STATIC;
      141    12201    1   DCL INCL_SAVE_STATE UBIN HALF ALIGNED STATIC INIT( %#UNINITIALIZED );
      142    12202    1   DCL 1 SAVED_UPDATE ALIGNED STATIC,
      143    12203    1         2 ARS UBIN BYTE CALIGNED,
      144    12204    1         2 KEY CHAR(9) CALIGNED,
      145    12205    1         2 TEXT CHAR(82) CALIGNED;
      146    12206
      147    12207        %PAGE( ARG=Based Data );

             12219    1   /*******************************************************************************
             12220    1   *                                                                              *
             12221    1   *        Based Data              Based Data                                       *
             12222    1   *                                                                              *
             12223    1   *******************************************************************************/

      148    12227        %B$TCB;
      149    12230        %B$ALT;
      150    12238        %F$DCB;
      151    12295        %XSA_PARAM( FPTN=XSA_PARAM, STCLASS=BASED );
      152    12325
      153    12326    1   DCL BASED_BUFFER CHAR( ARS ) CALIGNED BASED;
      154    12327    1   DCL BASED_CHARS CHAR( 256 ) CALIGNED BASED;
      155    12328
      156    12329        %PAGE( ARG=Local Data );

             12341    1   /*******************************************************************************
             12342    1   *                                                                              *
             12343    1   *        Local Data              Local Data                                       *
             12344    1   *                                                                              *
             12345    1   *******************************************************************************/
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:74   

      157    12349        %VLP_ERRCODE( FPTN=ERROR_CODE, STCLASS=" " );
      158    12394    1   DCL GOT_RECORD BIT(1) ALIGNED;
      159    12395    1   DCL EOF BIT(1) ALIGNED;
      160    12396    1   DCL OPEN_SI BIT(1) ALIGNED;
      161    12397    1   DCL OPEN_UI BIT(1) ALIGNED;
      162    12398    1   DCL OPEN_INCL BIT(1) ALIGNED;
      163    12399    1   DCL ARS SBIN WORD ALIGNED;
      164    12400    1   DCL ERROR_SET BIT(1) ALIGNED;
      165    12401    1   DCL TEMP_INCL_LEVEL SBIN WORD ALIGNED;
      166    12402    1   DCL USER_BUF$ PTR ALIGNED;
      167    12403
      168    12404        %PAGE( ARG=XUU$READ, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:75   
             12416    1   /*******************************************************************************
             12417    1   *                                                                              *
             12418    1   *        XUU$READ              XUU$READ                                           *
             12419    1   *                                                                              *
             12420    1   *******************************************************************************/

      169    12424    1       ERROR_SET = %FALSE;

  12424  3 000002   200014 450100                    STZ     ERROR_SET,,AUTO

      170    12425    1       XUU_PARAM.DCB# = DCBNUM(NIL);

  12425  3 000003   000000 220003                    LDX0    0,DU
         3 000004   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000005   000005 440100                    SXL0    5,,PR0

      171    12426    1       XUU_PARAM.LEVEL = 0;

  12426  3 000006   000000 236003                    LDQ     0,DU
         3 000007   000000 552110                    STBQ    0,'10'O,PR0

      172    12427    1       READ_FPT.BUF_ = P_BUF_;

  12427  3 000010   200004 471500                    LDP1    @P_BUF_,,AUTO
         3 000011   000000 100500                    MLR     fill='000'O
         3 000012   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         3 000013   000004 000010 2                  ADSC9   READ_FPT+4               cn=0,n=8

      173    12428    1       USER_BUF$ = VBASE( P_BUF_ );

  12428  3 000014   100001 236100                    LDQ     1,,PR1
         3 000015   200016 756100                    STQ     USER_BUF$,,AUTO

      174    12429    1       GOT_RECORD = %FALSE;

  12429  3 000016   200006 450100                    STZ     GOT_RECORD,,AUTO

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:76   
      175    12430
      176    12431    1   READ_LOOP:
      177    12432    2       DO UNTIL GOT_RECORD;

  12432  3 000017                       READ_LOOP    null
      178    12433    2           XUU_PARAM.FLAGS = XUU_PARAM.FLAGS & %CLEAR_OUTPUT_FLAGS;

  12433  3 000017   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000020   000000 220100                    LDX0    0,,PR0
         3 000021   070770 360003                    ANX0    29176,DU
         3 000022   000000 740100                    STX0    0,,PR0

      179    12434    3           DO CASE CURRENT_STATE;

  12434  3 000023   000112 221000 2                  LDX1    CURRENT_STATE
         3 000024   000006 101003                    CMPX1   6,DU
         3 000025   000027 602011 3                  TNC     s:12434+4,X1
         3 000026   000035 710000 3                  TRA     s:12436
         3 000027   000035 710000 3                  TRA     s:12436
         3 000030   000042 710000 3                  TRA     s:12440
         3 000031   000074 710000 3                  TRA     s:12455
         3 000032   000107 710000 3                  TRA     s:12461
         3 000033   000211 710000 3                  TRA     s:12498
         3 000034   000305 710000 3                  TRA     s:12530

      180    12435    3           CASE ( %#UNINITIALIZED, ELSE );

      181    12436    3               CALL KILL_XUU_ERR( %E$XUU#UN_INITIALIZED );

  12436  3 000035   000001 236000 4                  LDQ     1
         3 000036   200031 756100                    STQ     GOT_M+2,,AUTO
         3 000037   003121 701000 3                  TSX1    KILL_XUU_ERR
         3 000040   000000 011000                    NOP     0

      182    12437    3               GOTO XUU_ALTRET;

  12437  3 000041   001107 710000 3                  TRA     XUU_ALTRET
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:77   

      183    12438
      184    12439    3           CASE ( %#READ_SOURCE );

      185    12440    3               XUU_PARAM.RE_ASCII_KEY.CHAR10 = ' ';

  12440  3 000042   000040 236003                    LDQ     32,DU
         3 000043   000005 552120                    STBQ    5,'20'O,PR0

      186    12441    3               CALL READ( SI_INFO ) ALTRET ( SI_BETTER_BE_EOF );

  12441  3 000044   000002 236000 4                  LDQ     2
         3 000045   200137 756100                    STQ     WRITE_TEMP+3,,AUTO
         3 000046   001507 701000 3                  TSX1    READ
         3 000047   000442 702000 3                  TSX2    SI_BETTER_BE_EOF

      187    12442    3               GOT_RECORD = %TRUE;

  12442  3 000050   400000 236003                    LDQ     -131072,DU
         3 000051   200006 756100                    STQ     GOT_RECORD,,AUTO

      188    12443    3               XUU_PARAM.FLAGS.BASE# = %TRUE;

  12443  3 000052   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000053   000000 256100                    ORSQ    0,,PR0

      189    12444    3               IF SI_INFO.RECORD_COUNT = NEXT_UPDATE_POSITION

  12444  3 000054   000022 236000 2                  LDQ     SI_INFO+1
         3 000055   000113 116000 2                  CMPQ    NEXT_UPDATE_POSITION
         3 000056   000362 601000 3                  TNZ     s:12564

      190    12445    4               THEN DO;

      191    12446    4                   CALL PRINT_SAVED_UPDATE ALTRET( XUU_ALTRET );

  12446  3 000057   003621 701000 3                  TSX1    PRINT_SAVED_UPDATE
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:78   
         3 000060   001107 702000 3                  TSX2    XUU_ALTRET

      192    12447    4                   CURRENT_STATE = %#READ_UPDATE;

  12447  3 000061   000004 220003                    LDX0    4,DU
         3 000062   000112 740000 2                  STX0    CURRENT_STATE

      193    12448    4                   IF SI_SKIP_COUNT ~= 0

  12448  3 000063   000114 235000 2                  LDA     SI_SKIP_COUNT
         3 000064   000362 600000 3                  TZE     s:12564

      194    12449    5                   THEN DO;

      195    12450    5                       CALL PRECORD( SI_INFO, SI_SKIP_COUNT ) ALTRET ( SI_SKIP_ERR );

  12450  3 000065   000003 236000 4                  LDQ     3
         3 000066   200022 756100                    STQ     UI_SCRATCH_INFO+1,,AUTO
         3 000067   000002 236000 4                  LDQ     2
         3 000070   200021 756100                    STQ     USER_BUF$+3,,AUTO
         3 000071   002513 701000 3                  TSX1    PRECORD
         3 000072   000371 702000 3                  TSX2    SI_SKIP_ERR

      196    12451    5                       END;

      197    12452    4                   END;

  12452  3 000073   000362 710000 3                  TRA     s:12564

      198    12453
      199    12454    3           CASE ( %#READ_SOURCE_NO_UPDATES );

      200    12455    3               XUU_PARAM.RE_ASCII_KEY.CHAR10 = ' ';

  12455  3 000074   000040 236003                    LDQ     32,DU
         3 000075   000005 552120                    STBQ    5,'20'O,PR0

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:79   
      201    12456    3               CALL READ( SI_INFO ) ALTRET ( SI_BETTER_BE_EOF );

  12456  3 000076   000002 236000 4                  LDQ     2
         3 000077   200137 756100                    STQ     WRITE_TEMP+3,,AUTO
         3 000100   001507 701000 3                  TSX1    READ
         3 000101   000442 702000 3                  TSX2    SI_BETTER_BE_EOF

      202    12457    3               GOT_RECORD = %TRUE;

  12457  3 000102   400000 236003                    LDQ     -131072,DU
         3 000103   200006 756100                    STQ     GOT_RECORD,,AUTO

      203    12458    3               XUU_PARAM.FLAGS.BASE# = %TRUE;

  12458  3 000104   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000105   000000 256100                    ORSQ    0,,PR0
         3 000106   000362 710000 3                  TRA     s:12564

      204    12459
      205    12460    3           CASE ( %#READ_FIRST_UPDATE );

      206    12461    3               XUU_PARAM.RE_ASCII_KEY.CHAR10 = '*';

  12461  3 000107   000052 236003                    LDQ     42,DU
         3 000110   000005 552120                    STBQ    5,'20'O,PR0

      207    12462    3               CALL READ( UI_INFO ) ALTRET ( UI_READ_ERR );

  12462  3 000111   000004 236000 4                  LDQ     4
         3 000112   200137 756100                    STQ     WRITE_TEMP+3,,AUTO
         3 000113   001507 701000 3                  TSX1    READ
         3 000114   000363 702000 3                  TSX2    UI_READ_ERR

      208    12463    3               XUU_PARAM.FLAGS.UP_DATE# = %TRUE;

  12463  3 000115   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000116   200000 236003                    LDQ     65536,DU
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:80   
         3 000117   000000 256100                    ORSQ    0,,PR0

      209    12464    3               XUU_PARAM.SEQ_REC#.UP_INCL# = UI_INFO.RECORD_COUNT;

  12464  3 000120   000026 720000 2                  LXL0    UI_INFO+1
         3 000121   000001 440100                    SXL0    1,,PR0

      210    12465    3               IF ( ARS > 0 ) AND ( SUBSTR(#USER_BUFFER, 0, 1) = '+' )

  12465  3 000122   200013 235100                    LDA     ARS,,AUTO
         3 000123   000156 604400 3                  TMOZ    s:12485
         3 000124   200016 471500                    LDP1    USER_BUF$,,AUTO
         3 000125   040000 106500                    CMPC    fill='040'O
         3 000126   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         3 000127   000005 000001 4                  ADSC9   5                        cn=0,n=1
         3 000130   000156 601000 3                  TNZ     s:12485

      211    12466    4               THEN DO;

      212    12467    4                   CALL PARSE_AND_CHECK_PLUS ALTRET ( BAD_UPDATE );

  12467  3 000131   001153 701000 3                  TSX1    PARSE_AND_CHECK_PLUS
         3 000132   000457 702000 3                  TSX2    BAD_UPDATE

      213    12468    4                   IF CURRENT_STATE ~= %#READ_SOURCE_NO_UPDATES

  12468  3 000133   000112 220000 2                  LDX0    CURRENT_STATE
         3 000134   000002 100003                    CMPX0   2,DU
         3 000135   000162 600000 3                  TZE     s:12488

      214    12469    5                   THEN DO;

      215    12470    5                       IF NEXT_UPDATE_POSITION > 0

  12470  3 000136   000113 235000 2                  LDA     NEXT_UPDATE_POSITION
         3 000137   000143 604400 3                  TMOZ    s:12475

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:81   
      216    12471    6                       THEN DO;

      217    12472    6                           CURRENT_STATE = %#READ_SOURCE;

  12472  3 000140   000001 221003                    LDX1    1,DU
         3 000141   000112 741000 2                  STX1    CURRENT_STATE

      218    12473    6                           END;

  12473  3 000142   000162 710000 3                  TRA     s:12488

      219    12474    6                       ELSE DO;

      220    12475    6                           IF SI_SKIP_COUNT ~= 0

  12475  3 000143   000114 236000 2                  LDQ     SI_SKIP_COUNT
         3 000144   000153 600000 3                  TZE     s:12480

      221    12476    7                           THEN DO;

      222    12477    7                               CALL PRECORD( SI_INFO, SI_SKIP_COUNT )

  12477  3 000145   000003 236000 4                  LDQ     3
         3 000146   200022 756100                    STQ     UI_SCRATCH_INFO+1,,AUTO
         3 000147   000002 236000 4                  LDQ     2
         3 000150   200021 756100                    STQ     USER_BUF$+3,,AUTO
         3 000151   002513 701000 3                  TSX1    PRECORD
         3 000152   000371 702000 3                  TSX2    SI_SKIP_ERR

      223    12478    7                                  ALTRET ( SI_SKIP_ERR );
      224    12479    7                               END;

      225    12480    6                           CURRENT_STATE = %#READ_UPDATE;

  12480  3 000153   000004 220003                    LDX0    4,DU
         3 000154   000112 740000 2                  STX0    CURRENT_STATE

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:82   
      226    12481    6                           END;

      227    12482    5                       END;

      228    12483    4                   END;

  12483  3 000155   000162 710000 3                  TRA     s:12488

      229    12484    4               ELSE DO;

      230    12485    4                   CURRENT_STATE = %#READ_UPDATE;

  12485  3 000156   000004 221003                    LDX1    4,DU
         3 000157   000112 741000 2                  STX1    CURRENT_STATE

      231    12486    4                   GOT_RECORD = %TRUE;

  12486  3 000160   400000 236003                    LDQ     -131072,DU
         3 000161   200006 756100                    STQ     GOT_RECORD,,AUTO

      232    12487    4                   END;

      233    12488    3               IF CURRENT_STATE ~= %#READ_SOURCE

  12488  3 000162   000112 220000 2                  LDX0    CURRENT_STATE
         3 000163   000001 100003                    CMPX0   1,DU
         3 000164   000170 600000 3                  TZE     s:12492

      234    12489    3               THEN
      235    12490    3                   CALL PRINT_UPDATE ALTRET ( XUU_ALTRET );

  12490  3 000165   003575 701000 3                  TSX1    PRINT_UPDATE
         3 000166   001107 702000 3                  TSX2    XUU_ALTRET
         3 000167   000362 710000 3                  TRA     s:12564

      236    12491    4               ELSE DO;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:83   
      237    12492    4                   SAVED_UPDATE.ARS = MINIMUM( ARS, LENGTHC(SAVED_UPDATE.TEXT) );

  12492  3 000170   000122 236007                    LDQ     82,DL
         3 000171   000174 604000 3                  TMI     s:12492+4
         3 000172   200013 116100                    CMPQ    ARS,,AUTO
         3 000173   000175 604400 3                  TMOZ    s:12492+5
         3 000174   200013 236100                    LDQ     ARS,,AUTO
         3 000175   000033 736000                    QLS     27
         3 000176   000117 552040 2                  STBQ    SAVED_UPDATE,'40'O

      238    12493    4                   SAVED_UPDATE.KEY = XUU_PARAM.RE_ASCII_KEY.CHAR1_9;

  12493  3 000177   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000200   040000 100500                    MLR     fill='040'O
         3 000201   000003 000011                    ADSC9   3,,PR0                   cn=0,n=9
         3 000202   000117 200011 2                  ADSC9   SAVED_UPDATE             cn=1,n=9

      239    12494    4                   SAVED_UPDATE.TEXT = SUBSTR( #USER_BUFFER, 0, ARS );

  12494  3 000203   200016 471500                    LDP1    USER_BUF$,,AUTO
         3 000204   200013 721100                    LXL1    ARS,,AUTO
         3 000205   040000 100540                    MLR     fill='040'O
         3 000206   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         3 000207   000121 400122 2                  ADSC9   SAVED_UPDATE+2           cn=2,n=82

      240    12495    4                   END;

  12495  3 000210   000362 710000 3                  TRA     s:12564

      241    12496
      242    12497    3           CASE ( %#READ_UPDATE );

      243    12498    3               XUU_PARAM.RE_ASCII_KEY.CHAR10 = '*';

  12498  3 000211   000052 236003                    LDQ     42,DU
         3 000212   000005 552120                    STBQ    5,'20'O,PR0

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:84   
      244    12499    3               CALL READ( UI_INFO ) ALTRET ( UI_READ_ERR );

  12499  3 000213   000004 236000 4                  LDQ     4
         3 000214   200137 756100                    STQ     WRITE_TEMP+3,,AUTO
         3 000215   001507 701000 3                  TSX1    READ
         3 000216   000363 702000 3                  TSX2    UI_READ_ERR

      245    12500    3               XUU_PARAM.FLAGS.UP_DATE# = %TRUE;

  12500  3 000217   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000220   200000 236003                    LDQ     65536,DU
         3 000221   000000 256100                    ORSQ    0,,PR0

      246    12501    3               XUU_PARAM.SEQ_REC#.UP_INCL# = UI_INFO.RECORD_COUNT;

  12501  3 000222   000026 720000 2                  LXL0    UI_INFO+1
         3 000223   000001 440100                    SXL0    1,,PR0

      247    12502    3               IF ( ARS > 0 ) AND ( SUBSTR(#USER_BUFFER, 0, 1) = '+' )

  12502  3 000224   200013 235100                    LDA     ARS,,AUTO
         3 000225   000254 604400 3                  TMOZ    s:12518
         3 000226   200016 471500                    LDP1    USER_BUF$,,AUTO
         3 000227   040000 106500                    CMPC    fill='040'O
         3 000230   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         3 000231   000005 000001 4                  ADSC9   5                        cn=0,n=1
         3 000232   000254 601000 3                  TNZ     s:12518

      248    12503    4               THEN DO;

      249    12504    4                   CALL PARSE_AND_CHECK_PLUS ALTRET ( BAD_UPDATE );

  12504  3 000233   001153 701000 3                  TSX1    PARSE_AND_CHECK_PLUS
         3 000234   000457 702000 3                  TSX2    BAD_UPDATE

      250    12505    4                   IF SI_INFO.RECORD_COUNT < NEXT_UPDATE_POSITION

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:85   
  12505  3 000235   000022 236000 2                  LDQ     SI_INFO+1
         3 000236   000113 116000 2                  CMPQ    NEXT_UPDATE_POSITION
         3 000237   000243 605000 3                  TPL     s:12510

      251    12506    5                   THEN DO;

      252    12507    5                       CURRENT_STATE = %#READ_SOURCE;

  12507  3 000240   000001 220003                    LDX0    1,DU
         3 000241   000112 740000 2                  STX0    CURRENT_STATE

      253    12508    5                       END;

  12508  3 000242   000256 710000 3                  TRA     s:12520

      254    12509    5                   ELSE DO;

      255    12510    5                       IF SI_SKIP_COUNT ~= 0

  12510  3 000243   000114 235000 2                  LDA     SI_SKIP_COUNT
         3 000244   000256 600000 3                  TZE     s:12520

      256    12511    6                       THEN DO;

      257    12512    6                           CALL PRECORD( SI_INFO, SI_SKIP_COUNT )

  12512  3 000245   000003 236000 4                  LDQ     3
         3 000246   200022 756100                    STQ     UI_SCRATCH_INFO+1,,AUTO
         3 000247   000002 236000 4                  LDQ     2
         3 000250   200021 756100                    STQ     USER_BUF$+3,,AUTO
         3 000251   002513 701000 3                  TSX1    PRECORD
         3 000252   000371 702000 3                  TSX2    SI_SKIP_ERR

      258    12513    6                              ALTRET ( SI_SKIP_ERR );
      259    12514    6                           END;

      260    12515    5                       END;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:86   

      261    12516    4                   END;

  12516  3 000253   000256 710000 3                  TRA     s:12520

      262    12517    4               ELSE DO;

      263    12518    4                   GOT_RECORD = %TRUE;

  12518  3 000254   400000 236003                    LDQ     -131072,DU
         3 000255   200006 756100                    STQ     GOT_RECORD,,AUTO

      264    12519    4                   END;

      265    12520    3               IF CURRENT_STATE ~= %#READ_SOURCE

  12520  3 000256   000112 220000 2                  LDX0    CURRENT_STATE
         3 000257   000001 100003                    CMPX0   1,DU
         3 000260   000264 600000 3                  TZE     s:12524

      266    12521    3               THEN
      267    12522    3                   CALL PRINT_UPDATE ALTRET ( XUU_ALTRET );

  12522  3 000261   003575 701000 3                  TSX1    PRINT_UPDATE
         3 000262   001107 702000 3                  TSX2    XUU_ALTRET
         3 000263   000362 710000 3                  TRA     s:12564

      268    12523    4               ELSE DO;

      269    12524    4                   SAVED_UPDATE.ARS = MINIMUM( ARS, LENGTHC(SAVED_UPDATE.TEXT) );

  12524  3 000264   000122 236007                    LDQ     82,DL
         3 000265   000270 604000 3                  TMI     s:12524+4
         3 000266   200013 116100                    CMPQ    ARS,,AUTO
         3 000267   000271 604400 3                  TMOZ    s:12524+5
         3 000270   200013 236100                    LDQ     ARS,,AUTO
         3 000271   000033 736000                    QLS     27
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:87   
         3 000272   000117 552040 2                  STBQ    SAVED_UPDATE,'40'O

      270    12525    4                   SAVED_UPDATE.KEY = XUU_PARAM.RE_ASCII_KEY.CHAR1_9;

  12525  3 000273   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000274   040000 100500                    MLR     fill='040'O
         3 000275   000003 000011                    ADSC9   3,,PR0                   cn=0,n=9
         3 000276   000117 200011 2                  ADSC9   SAVED_UPDATE             cn=1,n=9

      271    12526    4                   SAVED_UPDATE.TEXT = SUBSTR( #USER_BUFFER, 0, ARS );

  12526  3 000277   200016 471500                    LDP1    USER_BUF$,,AUTO
         3 000300   200013 721100                    LXL1    ARS,,AUTO
         3 000301   040000 100540                    MLR     fill='040'O
         3 000302   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         3 000303   000121 400122 2                  ADSC9   SAVED_UPDATE+2           cn=2,n=82

      272    12527    4                   END;

  12527  3 000304   000362 710000 3                  TRA     s:12564

      273    12528
      274    12529    3           CASE ( %#READ_INCLUDE );

      275    12530    3               XUU_PARAM.RE_ASCII_KEY.CHAR10 = '+';

  12530  3 000305   000053 236003                    LDQ     43,DU
         3 000306   000005 552120                    STBQ    5,'20'O,PR0

      276    12531    3               CALL READ( INCL_INFO(INCL_LEVEL) )

  12531  3 000307   000115 236000 2                  LDQ     INCL_LEVEL
         3 000310   777777 376003                    ANQ     -1,DU
         3 000311   000002 736000                    QLS     2
         3 000312   000006 036000 4                  ADLQ    6
         3 000313   200137 756100                    STQ     WRITE_TEMP+3,,AUTO
         3 000314   001507 701000 3                  TSX1    READ
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:88   
         3 000315   000336 702000 3                  TSX2    s:12539

      277    12532    4               WHENRETURN DO;

      278    12533    4                   GOT_RECORD = %TRUE;

  12533  3 000316   400000 236003                    LDQ     -131072,DU
         3 000317   200006 756100                    STQ     GOT_RECORD,,AUTO

      279    12534    4                   XUU_PARAM.FLAGS.INCLUDE# = %TRUE;

  12534  3 000320   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000321   100000 236003                    LDQ     32768,DU
         3 000322   000000 256100                    ORSQ    0,,PR0

      280    12535    4                   XUU_PARAM.LEVEL = INCL_LEVEL + 1;

  12535  3 000323   000115 236000 2                  LDQ     INCL_LEVEL
         3 000324   000022 732000                    QRS     18
         3 000325   000001 036007                    ADLQ    1,DL
         3 000326   000011 736000                    QLS     9
         3 000327   000000 552110                    STBQ    0,'10'O,PR0

      281    12536    4                   XUU_PARAM.SEQ_REC#.UP_INCL# = INCL_INFO.RECORD_COUNT(INCL_LEVEL);

  12536  3 000330   000115 235000 2                  LDA     INCL_LEVEL
         3 000331   777777 375003                    ANA     -1,DU
         3 000332   000020 731000                    ARS     16
         3 000333   000042 720005 2                  LXL0    INCL_INFO+1,AL
         3 000334   000001 440100                    SXL0    1,,PR0

      282    12537    4                   END;

  12537  3 000335   000362 710000 3                  TRA     s:12564

      283    12538    4               WHENALTRETURN DO;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:89   
      284    12539    4                   IF EOF

  12539  3 000336   200007 234100                    SZN     EOF,,AUTO
         3 000337   000361 605000 3                  TPL     s:12559

      285    12540    5                   THEN DO;

      286    12541    5                       CALL CLOSE ( INCL_INFO(INCL_LEVEL) ) ALTRET ( INCL_IO_ERR );

  12541  3 000340   000115 236000 2                  LDQ     INCL_LEVEL
         3 000341   777777 376003                    ANQ     -1,DU
         3 000342   000002 736000                    QLS     2
         3 000343   000006 036000 4                  ADLQ    6
         3 000344   200261 756100                    STQ     TEMP_VEC+1,,AUTO
         3 000345   002355 701000 3                  TSX1    CLOSE
         3 000346   001072 702000 3                  TSX2    INCL_IO_ERR

      287    12542    5                       INCL_LEVEL = INCL_LEVEL - 1;

  12542  3 000347   000115 220000 2                  LDX0    INCL_LEVEL
         3 000350   777777 621010                    EAX1    -1,X0
         3 000351   000115 741000 2                  STX1    INCL_LEVEL

      288    12543    5                       IF INCL_LEVEL < 0

  12543  3 000352   000362 605000 3                  TPL     s:12564

      289    12544    6                       THEN DO;

      290    12545    6                           CURRENT_STATE = INCL_SAVE_STATE;

  12545  3 000353   000116 220000 2                  LDX0    INCL_SAVE_STATE
         3 000354   000112 740000 2                  STX0    CURRENT_STATE

      291    12546         /* The following code is necessary because cobol needs to be able to
      292    12547            open an include file after the end of the source file has already
      293    12548            caused cleanup to occur. This code allows the termination of that
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:90   
      294    12549            include file to occur even though no source file is around. Sigh!
      295    12550         */
      296    12551    6                           IF CURRENT_STATE = %#UNINITIALIZED

  12551  3 000355   000362 601000 3                  TNZ     s:12564

      297    12552    7                           THEN DO;

      298    12553    7                               INCL_LEVEL = 0;

  12553  3 000356   000000 222003                    LDX2    0,DU
         3 000357   000115 742000 2                  STX2    INCL_LEVEL

      299    12554    7                               GOTO INCL_IO_ERR;

  12554  3 000360   001072 710000 3                  TRA     INCL_IO_ERR

      300    12555    7                               END;
      301    12556    6                           END;
      302    12557    5                       END;
      303    12558    5                   ELSE DO;

      304    12559    5                       GOTO INCL_IO_ERR;

  12559  3 000361   001072 710000 3                  TRA     INCL_IO_ERR

      305    12560    5                       END;
      306    12561    4                   END;
      307    12562    3               END;/* Case on state */

      308    12563
      309    12564    3           DO WHILE %FALSE;

  12564  3 000362   000405 710000 3                  TRA     RECOVER

  12552  3 000363                       UI_READ_ERR  null
      310    12565
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:91   
      311    12566    3   UI_READ_ERR: ;
      312    12567    3               IF EOF

  12567  3 000363   200007 234100                    SZN     EOF,,AUTO
         3 000364   000370 605000 3                  TPL     s:12573

      313    12568    4               THEN DO;

      314    12569    4                   CURRENT_STATE = %#READ_SOURCE_NO_UPDATES;

  12569  3 000365   000002 220003                    LDX0    2,DU
         3 000366   000112 740000 2                  STX0    CURRENT_STATE

      315    12570    4                   GOTO RECOVER;

  12570  3 000367   000405 710000 3                  TRA     RECOVER

      316    12571    4                   END;
      317    12572    4               ELSE DO;

      318    12573    4                   GOTO UI_IO_ERR;

  12573  3 000370   001065 710000 3                  TRA     UI_IO_ERR

  12567  3 000371                       SI_SKIP_ERR  null
      319    12574    4                   END;
      320    12575
      321    12576    3   SI_SKIP_ERR: ;
      322    12577    3               IF EOF

  12577  3 000371   200007 234100                    SZN     EOF,,AUTO
         3 000372   000404 605000 3                  TPL     s:12584

      323    12578    4               THEN DO;

      324    12579    4                   CALL REC_XUU_ERR( %E$XUU#UPDATE_PAST_EOF, %FALSE ) ALTRET(
             12579                            XUU_ALTRET );
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:92   

  12579  3 000373   000010 236000 4                  LDQ     8
         3 000374   200032 756100                    STQ     @P_ERROR_NUM+1,,AUTO
         3 000375   000011 236000 4                  LDQ     9
         3 000376   200031 756100                    STQ     GOT_M+2,,AUTO
         3 000377   003107 701000 3                  TSX1    REC_XUU_ERR
         3 000400   001107 702000 3                  TSX2    XUU_ALTRET

      325    12580    4                   CURRENT_STATE = %#READ_UPDATE;

  12580  3 000401   000004 220003                    LDX0    4,DU
         3 000402   000112 740000 2                  STX0    CURRENT_STATE

      326    12581    4                   GOTO RECOVER;

  12581  3 000403   000405 710000 3                  TRA     RECOVER

      327    12582    4                   END;
      328    12583    4               ELSE DO;

      329    12584    4                   GOTO SI_IO_ERR;

  12584  3 000404   001060 710000 3                  TRA     SI_IO_ERR

  12577  3 000405                       RECOVER      null
      330    12585    4                   END;
      331    12586    3   RECOVER:    ;
      332    12587    3               END;

      333    12588
      334    12589    2           END READ_LOOP;

  12589  3 000405   200006 234100                    SZN     GOT_RECORD,,AUTO
         3 000406   000017 605000 3                  TPL     READ_LOOP

      335    12590
      336    12591    1       XUU_PARAM.ARS = ARS;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:93   

  12591  3 000407   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000410   200013 236100                    LDQ     ARS,,AUTO
         3 000411   000000 552104                    STBQ    0,'04'O,PR0

      337    12592    1       XUU_PARAM.FULL_ARS = ARS;

  12592  3 000412   000011 756100                    STQ     9,,PR0

      338    12593    1       XUU_PARAM.SEQ_REC#.BASE# = SI_INFO.RECORD_COUNT;

  12593  3 000413   000022 720000 2                  LXL0    SI_INFO+1
         3 000414   000001 740100                    STX0    1,,PR0

      339    12594
      340    12595    1       IF XUU_PARAM.FLAGS.BLANK_FILL#

  12595  3 000415   000000 236100                    LDQ     0,,PR0
         3 000416   040000 316003                    CANQ    16384,DU
         3 000417   000434 600000 3                  TZE     s:12603

      341    12596    2       THEN DO;

      342    12597    2           IF ARS < VBOUND( P_BUF_ ) + 1

  12597  3 000420   200004 471500                    LDP1    @P_BUF_,,AUTO
         3 000421   100000 236100                    LDQ     0,,PR1
         3 000422   000020 772000                    QRL     16
         3 000423   200013 116100                    CMPQ    ARS,,AUTO
         3 000424   000434 604000 3                  TMI     s:12603

      343    12598    3           THEN DO;

      344    12599    3               SUBSTR( VBASE(P_BUF_)->BASED_CHARS, ARS, ( VBOUND(P_BUF_) + 1 - ARS ) )
             12599                        = ' ';

  12599  3 000425   100001 473500                    LDP3    1,,PR1
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:94   
         3 000426   200013 136100                    SBLQ    ARS,,AUTO
         3 000427   000001 621006                    EAX1    1,QL
         3 000430   200013 235100                    LDA     ARS,,AUTO
         3 000431   040145 100400                    MLR     fill='040'O
         3 000432   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000433   300000 000011                    ADSC9   0,A,PR3                  cn=0,n=*X1

      345    12600    3               END;

      346    12601    2           END;

      347    12602
      348    12603    1       IF XUU_PARAM.FLAGS.SOURCE_OUT#

  12603  3 000434   000000 236100                    LDQ     0,,PR0
         3 000435   020000 316003                    CANQ    8192,DU
         3 000436   000441 600000 3                  TZE     s:12608

      349    12604    2       THEN DO;

      350    12605    2           CALL SOURCE_OUT ALTRET ( SOURCE_OUT_CRASH );

  12605  3 000437   004077 701000 3                  TSX1    SOURCE_OUT
         3 000440   000460 702000 3                  TSX2    SOURCE_OUT_CRASH

      351    12606    2           END;

      352    12607
      353    12608    1       RETURN;

  12608  3 000441   000000 702200 xent               TSX2  ! X66_ARET

  12603  3 000442                       SI_BETTER_B* null
      354    12609
      355    12610    1   SI_BETTER_BE_EOF: ;
      356    12611    1       IF EOF AND ( NEXT_UPDATE_POSITION > SI_INFO.RECORD_COUNT )

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:95   
  12611  3 000442   200007 234100                    SZN     EOF,,AUTO
         3 000443   000456 605000 3                  TPL     s:12618
         3 000444   000113 236000 2                  LDQ     NEXT_UPDATE_POSITION
         3 000445   000022 116000 2                  CMPQ    SI_INFO+1
         3 000446   000456 604400 3                  TMOZ    s:12618

      357    12612    2       THEN DO;

      358    12613    2           CALL PRINT_SAVED_UPDATE;

  12613  3 000447   003621 701000 3                  TSX1    PRINT_SAVED_UPDATE
         3 000450   000000 011000                    NOP     0

      359    12614    2           CALL KILL_XUU_ERR( %E$XUU#UPDATE_PAST_EOF );

  12614  3 000451   000011 236000 4                  LDQ     9
         3 000452   200031 756100                    STQ     GOT_M+2,,AUTO
         3 000453   003121 701000 3                  TSX1    KILL_XUU_ERR
         3 000454   000000 011000                    NOP     0

      360    12615    2           GOTO XUU_ALTRET;

  12615  3 000455   001107 710000 3                  TRA     XUU_ALTRET

      361    12616    2           END;
      362    12617    2       ELSE DO;

      363    12618    2           GOTO SI_IO_ERR;

  12618  3 000456   001060 710000 3                  TRA     SI_IO_ERR

  12611  3 000457                       BAD_UPDATE   null
      364    12619    2           END;
      365    12620
      366    12621    1   BAD_UPDATE: ;
      367    12622    1       GOTO XUU_ALTRET;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:96   
  12622  3 000457   001107 710000 3                  TRA     XUU_ALTRET

  12611  3 000460                       SOURCE_OUT_* null
      368    12623
      369    12624    1   SOURCE_OUT_CRASH: ;
      370    12625    1       GOTO SO_IO_ERR;

  12625  3 000460   001102 710000 3                  TRA     SO_IO_ERR

      371    12626
      372    12627        %PAGE( ARG=XUU$OPEN, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:97   
             12639    1   /*******************************************************************************
             12640    1   *                                                                              *
             12641    1   *        XUU$OPEN              XUU$OPEN                                           *
             12642    1   *                                                                              *
             12643    1   *******************************************************************************/

      373    12647    1   XUU$OPEN: ENTRY( XUU_PARAM ) ALTRET;

  12647  3 000461   000000 700200 xent  XUU$OPEN     TSX0  ! X66_AUTO_2
         3 000462   000342 000002                    ZERO    226,2

      374    12648
      375    12649    1       ERROR_SET = %FALSE;

  12649  3 000463   200014 450100                    STZ     ERROR_SET,,AUTO

      376    12650
      377    12651    1       OPEN_SI = XUU_PARAM.FLAGS.BASE#;

  12651  3 000464   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000465   000000 236100                    LDQ     0,,PR0
         3 000466   400000 376003                    ANQ     -131072,DU
         3 000467   200010 756100                    STQ     OPEN_SI,,AUTO

      378    12652    1       OPEN_UI = XUU_PARAM.FLAGS.UP_DATE#;

  12652  3 000470   000000 236100                    LDQ     0,,PR0
         3 000471   000001 736000                    QLS     1
         3 000472   400000 376003                    ANQ     -131072,DU
         3 000473   200011 756100                    STQ     OPEN_UI,,AUTO

      379    12653    1       OPEN_INCL = XUU_PARAM.FLAGS.INCLUDE#;

  12653  3 000474   000000 236100                    LDQ     0,,PR0
         3 000475   000002 736000                    QLS     2
         3 000476   400000 376003                    ANQ     -131072,DU
         3 000477   200012 756100                    STQ     OPEN_INCL,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:98   

      380    12654
      381    12655    1       IF CURRENT_STATE = %#UNINITIALIZED

  12655  3 000500   000112 220000 2                  LDX0    CURRENT_STATE
         3 000501   000504 601000 3                  TNZ     s:12660

      382    12656    2       THEN DO;

      383    12657    2           CALL INITIALIZE_EVERYTHING;

  12657  3 000502   001110 701000 3                  TSX1    INITIALIZE_EVERYTHING
         3 000503   000000 011000                    NOP     0

      384    12658    2           END;

      385    12659
      386    12660    1       IF NOT ( OPEN_SI OR OPEN_UI OR OPEN_INCL )

  12660  3 000504   200010 234100                    SZN     OPEN_SI,,AUTO
         3 000505   000517 604000 3                  TMI     s:12666
         3 000506   200011 234100                    SZN     OPEN_UI,,AUTO
         3 000507   000517 604000 3                  TMI     s:12666
         3 000510   200012 234100                    SZN     OPEN_INCL,,AUTO
         3 000511   000517 604000 3                  TMI     s:12666

      387    12661    2       THEN DO;

      388    12662    2           CALL KILL_XUU_ERR( %E$XUU#BAD_OPEN_BITS );

  12662  3 000512   000013 236000 4                  LDQ     11
         3 000513   200031 756100                    STQ     GOT_M+2,,AUTO
         3 000514   003121 701000 3                  TSX1    KILL_XUU_ERR
         3 000515   000000 011000                    NOP     0

      389    12663    2           GOTO XUU_ALTRET;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:99   
  12663  3 000516   001107 710000 3                  TRA     XUU_ALTRET

      390    12664    2           END;
      391    12665
      392    12666    1       IF OPEN_INCL

  12666  3 000517   200012 234100                    SZN     OPEN_INCL,,AUTO
         3 000520   000620 605000 3                  TPL     s:12694

      393    12667    2       THEN DO;

      394    12668    2           IF OPEN_SI OR OPEN_UI

  12668  3 000521   200010 234100                    SZN     OPEN_SI,,AUTO
         3 000522   000525 604000 3                  TMI     s:12670
         3 000523   200011 234100                    SZN     OPEN_UI,,AUTO
         3 000524   000532 605000 3                  TPL     s:12673

      395    12669    3           THEN DO;

      396    12670    3               CALL KILL_XUU_ERR( %E$XUU#BAD_OPEN_BITS );

  12670  3 000525   000013 236000 4                  LDQ     11
         3 000526   200031 756100                    STQ     GOT_M+2,,AUTO
         3 000527   003121 701000 3                  TSX1    KILL_XUU_ERR
         3 000530   000000 011000                    NOP     0

      397    12671    3               GOTO XUU_ALTRET;

  12671  3 000531   001107 710000 3                  TRA     XUU_ALTRET

      398    12672    3               END;
      399    12673    2           IF INCL_LEVEL < 0

  12673  3 000532   000115 220000 2                  LDX0    INCL_LEVEL
         3 000533   000536 605000 3                  TPL     s:12677

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:100  
      400    12674    3           THEN DO;

      401    12675    3               INCL_SAVE_STATE = CURRENT_STATE;

  12675  3 000534   000112 221000 2                  LDX1    CURRENT_STATE
         3 000535   000116 741000 2                  STX1    INCL_SAVE_STATE

      402    12676    3               END;

      403    12677    2           TEMP_INCL_LEVEL = INCL_LEVEL + 1;

  12677  3 000536   000115 235000 2                  LDA     INCL_LEVEL
         3 000537   000022 731000                    ARS     18
         3 000540   000001 035007                    ADLA    1,DL
         3 000541   200015 755100                    STA     TEMP_INCL_LEVEL,,AUTO

      404    12678    2           IF TEMP_INCL_LEVEL >= %MAX_INCL_LEVEL

  12678  3 000542   000012 115007                    CMPA    10,DL
         3 000543   000554 604000 3                  TMI     s:12684

      405    12679    3           THEN DO;

      406    12680    3               CALL SET_XUU_ERR( %E$XUU#INCL_TOO_DEEP, %FALSE );

  12680  3 000544   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000545   000010 235000 4                  LDA     8
         3 000546   200326 757100                    STAQ    @P_ERROR_NUM+1,,AUTO
         3 000547   000015 236000 4                  LDQ     13
         3 000550   200325 756100                    STQ     @P_PARAM$+2,,AUTO
         3 000551   003135 701000 3                  TSX1    SET_XUU_ERR
         3 000552   000000 011000                    NOP     0

      407    12681    3               GOTO XUU_ALTRET;

  12681  3 000553   001107 710000 3                  TRA     XUU_ALTRET

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:101  
      408    12682    3               END;
      409    12683    3           ELSE DO;

      410    12684    3               INCL_INFO.FAST(TEMP_INCL_LEVEL) = XUU_PARAM.FLAGS.FAST_INCLUDE# ;

  12684  3 000554   000002 735000                    ALS     2
         3 000555   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000556   000000 236100                    LDQ     0,,PR0
         3 000557   000016 736000                    QLS     14
         3 000560   000044 676005 2                  ERQ     INCL_INFO+3,AL
         3 000561   400000 376003                    ANQ     -131072,DU
         3 000562   000044 656005 2                  ERSQ    INCL_INFO+3,AL

      411    12685    3               CALL GETDCB( INCL_INFO(TEMP_INCL_LEVEL) ) ALTRET ( INCL_OPEN_ERR );

  12685  3 000563   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000564   200140 756100                    STQ     @P_INFO+1,,AUTO
         3 000565   200015 236100                    LDQ     TEMP_INCL_LEVEL,,AUTO
         3 000566   000024 736000                    QLS     20
         3 000567   000006 036000 4                  ADLQ    6
         3 000570   200137 756100                    STQ     WRITE_TEMP+3,,AUTO
         3 000571   002604 701000 3                  TSX1    GETDCB
         3 000572   000766 702000 3                  TSX2    INCL_OPEN_ERR

      412    12686    3              CALL OPEN( INCL_INFO(TEMP_INCL_LEVEL), XUU_PARAM.O.FPT_PTR$, %#OPEN_INCL
             12686                        )

  12686  3 000573   000016 236000 4                  LDQ     14
         3 000574   200141 756100                    STQ     TEMP_VECT+1,,AUTO
         3 000575   200003 236100                    LDQ     @XUU_PARAM,,AUTO
         3 000576   000004 036003                    ADLQ    4,DU
         3 000577   200140 756100                    STQ     @P_INFO+1,,AUTO
         3 000600   200015 236100                    LDQ     TEMP_INCL_LEVEL,,AUTO
         3 000601   000024 736000                    QLS     20
         3 000602   000006 036000 4                  ADLQ    6
         3 000603   200137 756100                    STQ     WRITE_TEMP+3,,AUTO
         3 000604   002067 701000 3                  TSX1    OPEN
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:102  
         3 000605   000766 702000 3                  TSX2    INCL_OPEN_ERR

      413    12687    3                  ALTRET( INCL_OPEN_ERR );
      414    12688    3               CURRENT_STATE = %#READ_INCLUDE;

  12688  3 000606   000005 220003                    LDX0    5,DU
         3 000607   000112 740000 2                  STX0    CURRENT_STATE

      415    12689    3               INCL_LEVEL = TEMP_INCL_LEVEL;

  12689  3 000610   200015 721100                    LXL1    TEMP_INCL_LEVEL,,AUTO
         3 000611   000115 741000 2                  STX1    INCL_LEVEL

      416    12690    3               XUU_PARAM.LEVEL = INCL_LEVEL + 1;

  12690  3 000612   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000613   000115 236000 2                  LDQ     INCL_LEVEL
         3 000614   000022 732000                    QRS     18
         3 000615   000001 036007                    ADLQ    1,DL
         3 000616   000011 736000                    QLS     9
         3 000617   000000 552110                    STBQ    0,'10'O,PR0

      417    12691    3               END;

      418    12692    2           END;

      419    12693
      420    12694    1       IF OPEN_SI

  12694  3 000620   200010 234100                    SZN     OPEN_SI,,AUTO
         3 000621   000670 605000 3                  TPL     s:12714

      421    12695    2       THEN DO;

      422    12696    2           IF CURRENT_STATE ~= %#UNINITIALIZED

  12696  3 000622   000112 220000 2                  LDX0    CURRENT_STATE
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:103  
         3 000623   000631 600000 3                  TZE     s:12701

      423    12697    3           THEN DO;

      424    12698    3               CALL KILL_XUU_ERR( %E$XUU#BAD_OPEN_BITS );

  12698  3 000624   000013 236000 4                  LDQ     11
         3 000625   200031 756100                    STQ     GOT_M+2,,AUTO
         3 000626   003121 701000 3                  TSX1    KILL_XUU_ERR
         3 000627   000000 011000                    NOP     0

      425    12699    3               GOTO XUU_ALTRET;

  12699  3 000630   001107 710000 3                  TRA     XUU_ALTRET

      426    12700    3               END;
      427    12701    2           SI_INFO.FAST = XUU_PARAM.FLAGS.FAST_BASE#;

  12701  3 000631   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000632   000000 236100                    LDQ     0,,PR0
         3 000633   000014 736000                    QLS     12
         3 000634   000024 676000 2                  ERQ     SI_INFO+3
         3 000635   400000 376003                    ANQ     -131072,DU
         3 000636   000024 656000 2                  ERSQ    SI_INFO+3

      428    12702    2           CALL GETDCB( SI_INFO, SI_DCB_NAME ) ALTRET ( SI_OPEN_ERR );

  12702  3 000637   000017 236000 4                  LDQ     15
         3 000640   200140 756100                    STQ     @P_INFO+1,,AUTO
         3 000641   000002 236000 4                  LDQ     2
         3 000642   200137 756100                    STQ     WRITE_TEMP+3,,AUTO
         3 000643   002604 701000 3                  TSX1    GETDCB
         3 000644   000764 702000 3                  TSX2    SI_OPEN_ERR

      429    12703    2           CALL OPEN( SI_INFO, , %#OPEN_BASE ) ALTRET ( SI_OPEN_ERR );

  12703  3 000645   000020 236000 4                  LDQ     16
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:104  
         3 000646   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000647   200140 757100                    STAQ    @P_INFO+1,,AUTO
         3 000650   000002 236000 4                  LDQ     2
         3 000651   200137 756100                    STQ     WRITE_TEMP+3,,AUTO
         3 000652   002067 701000 3                  TSX1    OPEN
         3 000653   000764 702000 3                  TSX2    SI_OPEN_ERR

      430    12704    2           IF SI_INFO.DCB$->F$DCB.ASN# = %FILE#

  12704  3 000654   000023 470400 2                  LDP0    SI_INFO+2
         3 000655   000032 236100                    LDQ     26,,PR0
         3 000656   777000 376007                    ANQ     -512,DL
         3 000657   001000 116007                    CMPQ    512,DL
         3 000660   000664 601000 3                  TNZ     s:12709

      431    12705    3           THEN DO;

      432    12706    3               NRECS_IN_SOURCE = SI_INFO.DCB$->F$DCB.NRECS#;

  12706  3 000661   000042 235100                    LDA     34,,PR0
         3 000662   000111 755000 2                  STA     NRECS_IN_SOURCE

      433    12707    3               END;

  12707  3 000663   000666 710000 3                  TRA     s:12711

      434    12708    3           ELSE DO;

      435    12709    3               NRECS_IN_SOURCE = BITBIN( '377777777777'O );

  12709  3 000664   000031 235000 xsym               LDA     B_VECTNIL+25
         3 000665   000111 755000 2                  STA     NRECS_IN_SOURCE

      436    12710    3               END;

      437    12711    2           CURRENT_STATE = %#READ_SOURCE_NO_UPDATES;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:105  
  12711  3 000666   000002 220003                    LDX0    2,DU
         3 000667   000112 740000 2                  STX0    CURRENT_STATE

      438    12712    2           END;

      439    12713
      440    12714    1       IF OPEN_UI

  12714  3 000670   200011 234100                    SZN     OPEN_UI,,AUTO
         3 000671   000763 605000 3                  TPL     s:12745

      441    12715    2       THEN DO;

      442    12716    2           IF NOT OPEN_SI

  12716  3 000672   200010 234100                    SZN     OPEN_SI,,AUTO
         3 000673   000701 604000 3                  TMI     s:12721

      443    12717    3           THEN DO;

      444    12718    3               CALL KILL_XUU_ERR( %E$XUU#BAD_OPEN_BITS );

  12718  3 000674   000013 236000 4                  LDQ     11
         3 000675   200031 756100                    STQ     GOT_M+2,,AUTO
         3 000676   003121 701000 3                  TSX1    KILL_XUU_ERR
         3 000677   000000 011000                    NOP     0

      445    12719    3               GOTO XUU_ALTRET;

  12719  3 000700   001107 710000 3                  TRA     XUU_ALTRET

      446    12720    3               END;
      447    12721    2           UI_INFO.FAST = XUU_PARAM.FLAGS.FAST_UPDATE# ;

  12721  3 000701   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000702   000000 236100                    LDQ     0,,PR0
         3 000703   000015 736000                    QLS     13
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:106  
         3 000704   000030 676000 2                  ERQ     UI_INFO+3
         3 000705   400000 376003                    ANQ     -131072,DU
         3 000706   000030 656000 2                  ERSQ    UI_INFO+3

      448    12722    2           CALL GETDCB( UI_INFO, UI_DCB_NAME ) ALTRET ( UI_OPEN_ERR );

  12722  3 000707   000021 236000 4                  LDQ     17
         3 000710   200140 756100                    STQ     @P_INFO+1,,AUTO
         3 000711   000004 236000 4                  LDQ     4
         3 000712   200137 756100                    STQ     WRITE_TEMP+3,,AUTO
         3 000713   002604 701000 3                  TSX1    GETDCB
         3 000714   000765 702000 3                  TSX2    UI_OPEN_ERR

      449    12723    2           CALL OPEN( UI_INFO, , %#OPEN_UPDATE )

  12723  3 000715   000022 236000 4                  LDQ     18
         3 000716   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000717   200140 757100                    STAQ    @P_INFO+1,,AUTO
         3 000720   000004 236000 4                  LDQ     4
         3 000721   200137 756100                    STQ     WRITE_TEMP+3,,AUTO
         3 000722   002067 701000 3                  TSX1    OPEN
         3 000723   000752 702000 3                  TSX2    s:12738

      450    12724    3           WHENRETURN DO;

      451    12725    3               IF XUU_PARAM.FLAGS.LU_FIRST# OR XUU_PARAM.FLAGS.LU_WHILE#

  12725  3 000724   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000725   000000 236100                    LDQ     0,,PR0
         3 000726   000400 316003                    CANQ    256,DU
         3 000727   000732 601000 3                  TNZ     s:12727
         3 000730   000200 316003                    CANQ    128,DU
         3 000731   000742 600000 3                  TZE     s:12731

      452    12726    4               THEN DO;

      453    12727    4                   LU_INFO.FAST = %FALSE;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:107  

  12727  3 000732   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 000733   000040 356000 2                  ANSQ    LU_INFO+3

      454    12728    4                   LU_INFO.DCB# = XUU_PARAM.DCB#;

  12728  3 000734   000005 720100                    LXL0    5,,PR0
         3 000735   000040 440000 2                  SXL0    LU_INFO+3

      455    12729    4                   LU_INFO.DCB$ = DCBADDR( LU_INFO.DCB# );

  12729  3 000736   000023 471400 4                  LDP1    19
         3 000737   100000 473500                    LDP3    0,,PR1
         3 000740   300000 236110                    LDQ     0,X0,PR3
         3 000741   000037 756000 2                  STQ     LU_INFO+2

      456    12730    4                   END;

      457    12731    3               IF XUU_PARAM.FLAGS.LU_FIRST#

  12731  3 000742   000000 236100                    LDQ     0,,PR0
         3 000743   000400 316003                    CANQ    256,DU
         3 000744   000747 600000 3                  TZE     s:12735

      458    12732    4               THEN DO;

      459    12733    4                   CALL PREPRINT_UPDATES ALTRET ( XUU_ALTRET );

  12733  3 000745   003643 701000 3                  TSX1    PREPRINT_UPDATES
         3 000746   001107 702000 3                  TSX2    XUU_ALTRET

      460    12734    4                   END;

      461    12735    3               CURRENT_STATE = %#READ_FIRST_UPDATE;

  12735  3 000747   000003 220003                    LDX0    3,DU
         3 000750   000112 740000 2                  STX0    CURRENT_STATE
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:108  

      462    12736    3               END;

  12736  3 000751   000763 710000 3                  TRA     s:12745

      463    12737    3           WHENALTRETURN DO;

      464    12738    3               IF NOT ( ( ERROR_CODE.ERR# = %E$NOFILE ) AND XUU_PARAM.FLAGS.OPT_UI# )

  12738  3 000752   200005 236100                    LDQ     ERROR_CODE,,AUTO
         3 000753   377770 376007                    ANQ     131064,DL
         3 000754   001610 116007                    CMPQ    904,DL
         3 000755   000762 601000 3                  TNZ     s:12740
         3 000756   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 000757   000000 236100                    LDQ     0,,PR0
         3 000760   000100 316003                    CANQ    64,DU
         3 000761   000763 601000 3                  TNZ     s:12745

      465    12739    4               THEN DO;

      466    12740    4                   GOTO UI_OPEN_ERR;

  12740  3 000762   000765 710000 3                  TRA     UI_OPEN_ERR

      467    12741    4                   END;
      468    12742    3               END;
      469    12743    2           END;

      470    12744
      471    12745    1       RETURN;

  12745  3 000763   000000 702200 xent               TSX2  ! X66_ARET

  12745  3 000764                       SI_OPEN_ERR  null
      472    12746
      473    12747    1   SI_OPEN_ERR: ;
      474    12748    1       GOTO SI_IO_ERR;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:109  

  12748  3 000764   001060 710000 3                  TRA     SI_IO_ERR

  12745  3 000765                       UI_OPEN_ERR  null
      475    12749
      476    12750    1   UI_OPEN_ERR: ;
      477    12751    1       GOTO UI_IO_ERR;

  12751  3 000765   001065 710000 3                  TRA     UI_IO_ERR

  12745  3 000766                       INCL_OPEN_E* null
      478    12752
      479    12753    1   INCL_OPEN_ERR:;
      480    12754    1       CALL SET_IO_ERROR( %INCL_ERR, %FALSE );

  12754  3 000766   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000767   000010 235000 4                  LDA     8
         3 000770   200256 757100                    STAQ    @P_INFO+1,,AUTO
         3 000771   000016 236000 4                  LDQ     14
         3 000772   200255 756100                    STQ     ALT_FLAG+3,,AUTO
         3 000773   003244 701000 3                  TSX1    SET_IO_ERROR
         3 000774   000000 011000                    NOP     0

      481    12755    1       GOTO XUU_ALTRET;

  12755  3 000775   001107 710000 3                  TRA     XUU_ALTRET

      482    12756
      483    12757        %PAGE( ARG=XUU$CLOSE, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:110  
             12769    1   /*******************************************************************************
             12770    1   *                                                                              *
             12771    1   *        XUU$CLOSE              XUU$CLOSE                                         *
             12772    1   *                                                                              *
             12773    1   *******************************************************************************/

      484    12777    1   XUU$CLOSE:ENTRY( XUU_PARAM ) ALTRET;

  12777  3 000776   000000 700200 xent  XUU$CLOSE    TSX0  ! X66_AUTO_2
         3 000777   000342 000002                    ZERO    226,2

      485    12778
      486    12779    1       ERROR_SET = %FALSE;

  12779  3 001000   200014 450100                    STZ     ERROR_SET,,AUTO

      487    12780
      488    12781    1       IF XUU_PARAM.FLAGS.CLOSE_ALL# OR XUU_PARAM.FLAGS.BASE#

  12781  3 001001   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 001002   000000 236100                    LDQ     0,,PR0
         3 001003   010000 316003                    CANQ    4096,DU
         3 001004   001007 601000 3                  TNZ     s:12783
         3 001005   000000 234100                    SZN     0,,PR0
         3 001006   001012 605000 3                  TPL     s:12786

      489    12782    2       THEN DO;

      490    12783    2           CALL CLEANUP ALTRET ( BAD_CLEANUP );

  12783  3 001007   003446 701000 3                  TSX1    CLEANUP
         3 001010   001057 702000 3                  TSX2    BAD_CLEANUP

      491    12784    2           END;

  12784  3 001011   001055 710000 3                  TRA     s:12814

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:111  
      492    12785    2       ELSE DO;

      493    12786    2           IF ( XUU_PARAM.FLAGS.INCLUDE# ) AND ( INCL_LEVEL >= 0 )

  12786  3 001012   100000 316003                    CANQ    32768,DU
         3 001013   001035 600000 3                  TZE     s:12797
         3 001014   000115 220000 2                  LDX0    INCL_LEVEL
         3 001015   001035 604000 3                  TMI     s:12797

      494    12787    3           THEN DO;

      495    12788    3               CALL CLOSE( INCL_INFO(INCL_LEVEL) ) ALTRET ( INCL_CLOSE_PROBLEMS );

  12788  3 001016   000115 236000 2                  LDQ     INCL_LEVEL
         3 001017   777777 376003                    ANQ     -1,DU
         3 001020   000002 736000                    QLS     2
         3 001021   000006 036000 4                  ADLQ    6
         3 001022   200261 756100                    STQ     TEMP_VEC+1,,AUTO
         3 001023   002355 701000 3                  TSX1    CLOSE
         3 001024   001056 702000 3                  TSX2    INCL_CLOSE_PROBLEMS

      496    12789    3               INCL_LEVEL = INCL_LEVEL - 1;

  12789  3 001025   000115 220000 2                  LDX0    INCL_LEVEL
         3 001026   777777 621010                    EAX1    -1,X0
         3 001027   000115 741000 2                  STX1    INCL_LEVEL

      497    12790    3               IF INCL_LEVEL < 0

  12790  3 001030   001035 605000 3                  TPL     s:12797

      498    12791    4               THEN DO;

      499    12792    4                   CURRENT_STATE = INCL_SAVE_STATE;

  12792  3 001031   000116 220000 2                  LDX0    INCL_SAVE_STATE
         3 001032   000112 740000 2                  STX0    CURRENT_STATE
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:112  

      500    12793    4                   INCL_SAVE_STATE = %#UNINITIALIZED;

  12793  3 001033   000000 222003                    LDX2    0,DU
         3 001034   000116 742000 2                  STX2    INCL_SAVE_STATE

      501    12794    4                   END;

      502    12795    3               END;

      503    12796
      504    12797    2           IF XUU_PARAM.FLAGS.UP_DATE#

  12797  3 001035   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 001036   000000 236100                    LDQ     0,,PR0
         3 001037   200000 316003                    CANQ    65536,DU
         3 001040   001051 600000 3                  TZE     s:12807

      505    12798    3           THEN DO;

      506    12799    3               INCL_SAVE_STATE = %#READ_SOURCE_NO_UPDATES;

  12799  3 001041   000002 220003                    LDX0    2,DU
         3 001042   000116 740000 2                  STX0    INCL_SAVE_STATE

      507    12800    3               IF ( CURRENT_STATE = %#READ_SOURCE )

  12800  3 001043   000112 221000 2                  LDX1    CURRENT_STATE
         3 001044   000001 101003                    CMPX1   1,DU
         3 001045   001050 600000 3                  TZE     s:12803
         3 001046   000004 101003                    CMPX1   4,DU
         3 001047   001051 601000 3                  TNZ     s:12807

      508    12801    3                  OR ( CURRENT_STATE = %#READ_UPDATE )
      509    12802    4               THEN DO;

      510    12803    4                   CURRENT_STATE = %#READ_SOURCE_NO_UPDATES;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:113  

  12803  3 001050   000112 740000 2                  STX0    CURRENT_STATE

      511    12804    4                   END;

      512    12805    3               END;

      513    12806
      514    12807    2           IF XUU_PARAM.FLAGS.SOURCE_OUT#

  12807  3 001051   020000 316003                    CANQ    8192,DU
         3 001052   001055 600000 3                  TZE     s:12814

      515    12808    3           THEN DO;

      516    12809    3               XUU_PARAM.FLAGS.SOURCE_OUT# = %FALSE;

  12809  3 001053   000024 236000 4                  LDQ     20
         3 001054   000000 356100                    ANSQ    0,,PR0

      517    12810    3               END;

      518    12811
      519    12812    2           END;

      520    12813
      521    12814    1       RETURN;

  12814  3 001055   000000 702200 xent               TSX2  ! X66_ARET

  12801  3 001056                       INCL_CLOSE_* null
      522    12815
      523    12816    1   INCL_CLOSE_PROBLEMS: ;
      524    12817    1       GOTO INCL_IO_ERR;

  12817  3 001056   001072 710000 3                  TRA     INCL_IO_ERR

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:114  
  12801  3 001057                       BAD_CLEANUP  null
      525    12818
      526    12819    1   BAD_CLEANUP: ;
      527    12820    1       GOTO XUU_ALTRET;

  12820  3 001057   001107 710000 3                  TRA     XUU_ALTRET

      528    12821
      529    12822        %PAGE( ARG=Global IO error collection, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:115  
             12834    1   /*******************************************************************************
             12835    1   *                                                                              *
             12836    1   *        Global IO error collection              Global IO error collection       *
             12837    1   *                                                                              *
             12838    1   *******************************************************************************/

      530    12842    1   SI_IO_ERR: ;

  12842  3 001060                       SI_IO_ERR    null
      531    12843    1       CALL KILL_IO_ERR( %SI_ERR );

  12843  3 001060   000020 236000 4                  LDQ     16
         3 001061   200245 756100                    STQ     @P_PARAM$+2,,AUTO
         3 001062   003071 701000 3                  TSX1    KILL_IO_ERR
         3 001063   000000 011000                    NOP     0

      532    12844    1       GOTO XUU_ALTRET;

  12844  3 001064   001107 710000 3                  TRA     XUU_ALTRET

  12842  3 001065                       UI_IO_ERR    null
      533    12845
      534    12846    1   UI_IO_ERR: ;
      535    12847    1       CALL KILL_IO_ERR( %UI_ERR );

  12847  3 001065   000022 236000 4                  LDQ     18
         3 001066   200245 756100                    STQ     @P_PARAM$+2,,AUTO
         3 001067   003071 701000 3                  TSX1    KILL_IO_ERR
         3 001070   000000 011000                    NOP     0

      536    12848    1       GOTO XUU_ALTRET;

  12848  3 001071   001107 710000 3                  TRA     XUU_ALTRET

  12842  3 001072                       INCL_IO_ERR  null
      537    12849
      538    12850    1   INCL_IO_ERR: ;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:116  
      539    12851    1       TEMP_INCL_LEVEL = INCL_LEVEL;

  12851  3 001072   000115 235000 2                  LDA     INCL_LEVEL
         3 001073   000022 731000                    ARS     18
         3 001074   200015 755100                    STA     TEMP_INCL_LEVEL,,AUTO

      540    12852    1       CALL KILL_IO_ERR( %INCL_ERR );

  12852  3 001075   000016 236000 4                  LDQ     14
         3 001076   200245 756100                    STQ     @P_PARAM$+2,,AUTO
         3 001077   003071 701000 3                  TSX1    KILL_IO_ERR
         3 001100   000000 011000                    NOP     0

      541    12853    1       GOTO XUU_ALTRET;

  12853  3 001101   001107 710000 3                  TRA     XUU_ALTRET

  12851  3 001102                       SO_IO_ERR    null
      542    12854
      543    12855    1   SO_IO_ERR: ;
      544    12856    1       CALL KILL_IO_ERR( %SO_ERR );

  12856  3 001102   000025 236000 4                  LDQ     21
         3 001103   200245 756100                    STQ     @P_PARAM$+2,,AUTO
         3 001104   003071 701000 3                  TSX1    KILL_IO_ERR
         3 001105   000000 011000                    NOP     0

      545    12857    1       GOTO XUU_ALTRET;

  12857  3 001106   001107 710000 3                  TRA     XUU_ALTRET

  12851  3 001107                       XUU_ALTRET   null
      546    12858
      547    12859    1   XUU_ALTRET: ;
      548    12860    1       ALTRETURN;

  12860  3 001107   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:117  

      549    12861
      550    12862        %PAGE( ARG=Internal procedures, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:118  
             12874    1   /*******************************************************************************
             12875    1   *                                                                              *
             12876    1   *        Internal procedures              Internal procedures                     *
             12877    1   *                                                                              *
             12878    1   *******************************************************************************/

      551    12882        %PAGE( ARG=INITIALIZE_EVERYTHING );

             12894    1   /*******************************************************************************
             12895    1   *                                                                              *
             12896    1   *        INITIALIZE_EVERYTHING              INITIALIZE_EVERYTHING                 *
             12897    1   *                                                                              *
             12898    1   *******************************************************************************/

      552    12902    1   INITIALIZE_EVERYTHING: PROC;

  12902  3 001110   200020 741300       INITIALIZE_* STX1  ! USER_BUF$+2,,AUTO

      553    12903
      554    12904    2   DCL I SBIN WORD;
      555    12905
      556    12906    3       DO I = 0 TO %(MAX_INCL_LEVEL-1);

  12906  3 001111   200021 450100                    STZ     I,,AUTO

      557    12907    3           INCL_INFO(I) = FILE_INFO_BASE;

  12907  3 001112   200021 235100                    LDA     I,,AUTO
         3 001113   000004 735000                    ALS     4
         3 001114   000005 100400                    MLR     fill='000'O
         3 001115   000005 000020 1                  ADSC9   FILE_INFO_BASE           cn=0,n=16
         3 001116   000041 000020 2                  ADSC9   INCL_INFO,A              cn=0,n=16

      558    12908    3           END;

  12908  3 001117   200021 054100                    AOS     I,,AUTO
         3 001120   200021 235100                    LDA     I,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:119  
         3 001121   000011 115007                    CMPA    9,DL
         3 001122   001112 604400 3                  TMOZ    s:12907

      559    12909
      560    12910    2       SO_INFO = FILE_INFO_BASE;

  12910  3 001123   000000 100400                    MLR     fill='000'O
         3 001124   000005 000020 1                  ADSC9   FILE_INFO_BASE           cn=0,n=16
         3 001125   000031 000020 2                  ADSC9   SO_INFO                  cn=0,n=16

      561    12911    2       SO_INFO.RECORD_COUNT = 1;

  12911  3 001126   000001 236007                    LDQ     1,DL
         3 001127   000032 756000 2                  STQ     SO_INFO+1

      562    12912    2       UI_INFO = FILE_INFO_BASE;

  12912  3 001130   000000 100400                    MLR     fill='000'O
         3 001131   000005 000020 1                  ADSC9   FILE_INFO_BASE           cn=0,n=16
         3 001132   000025 000020 2                  ADSC9   UI_INFO                  cn=0,n=16

      563    12913    2       SI_INFO = FILE_INFO_BASE;

  12913  3 001133   000000 100400                    MLR     fill='000'O
         3 001134   000005 000020 1                  ADSC9   FILE_INFO_BASE           cn=0,n=16
         3 001135   000021 000020 2                  ADSC9   SI_INFO                  cn=0,n=16

      564    12914    2       LU_INFO = FILE_INFO_BASE;

  12914  3 001136   000000 100400                    MLR     fill='000'O
         3 001137   000005 000020 1                  ADSC9   FILE_INFO_BASE           cn=0,n=16
         3 001140   000035 000020 2                  ADSC9   LU_INFO                  cn=0,n=16

      565    12915
      566    12916    2       CURRENT_STATE = %#UNINITIALIZED;

  12916  3 001141   000000 220003                    LDX0    0,DU
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:120  
         3 001142   000112 740000 2                  STX0    CURRENT_STATE

      567    12917    2       INCL_SAVE_STATE = %#UNINITIALIZED;

  12917  3 001143   000116 740000 2                  STX0    INCL_SAVE_STATE

      568    12918
      569    12919    2       INCL_LEVEL = -1;

  12919  3 001144   777777 221003                    LDX1    -1,DU
         3 001145   000115 741000 2                  STX1    INCL_LEVEL

      570    12920
      571    12921    2       NEXT_UPDATE_POSITION = 0;

  12921  3 001146   000113 450000 2                  STZ     NEXT_UPDATE_POSITION

      572    12922
      573    12923    2       XSA_PARAM_POOL_ = VECTOR(NIL);

  12923  3 001147   000026 237000 4                  LDAQ    22
         3 001150   000016 757000 2                  STAQ    XSA_PARAM_POOL_

      574    12924
      575    12925    2   END INITIALIZE_EVERYTHING;

  12925  3 001151   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 001152   000001 702211                    TSX2  ! 1,X1

      576    12926
      577    12927        %PAGE( ARG=PARSE_AND_CHECK_PLUS, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:121  
             12939    2   /*******************************************************************************
             12940    2   *                                                                              *
             12941    2   *        PARSE_AND_CHECK_PLUS              PARSE_AND_CHECK_PLUS                   *
             12942    2   *                                                                              *
             12943    2   *******************************************************************************/

      578    12947    1   PARSE_AND_CHECK_PLUS: PROC ALTRET;

  12947  3 001153   200020 741300       PARSE_AND_C* STX1  ! USER_BUF$+2,,AUTO

      579    12948
      580    12949    2   DCL N SBIN WORD;
      581    12950    2   DCL M SBIN WORD;
      582    12951    2   DCL HALT_POS SBIN WORD;
      583    12952    2   DCL HALT_VALUE SBIN WORD;
      584    12953    2   DCL COMMA_POS SBIN WORD;
      585    12954    2   DCL GOT_N BIT(1) ALIGNED;
      586    12955    2   DCL GOT_M BIT(1) ALIGNED;
      587    12956
      588    12957    2       N = 0;

  12957  3 001154   200021 450100                    STZ     N,,AUTO

      589    12958    2       M = 0;

  12958  3 001155   200022 450100                    STZ     M,,AUTO

      590    12959    2       SI_SKIP_COUNT = 0;

  12959  3 001156   000114 450000 2                  STZ     SI_SKIP_COUNT

      591    12960    2       COMMA_POS = 0;

  12960  3 001157   200025 450100                    STZ     COMMA_POS,,AUTO

      592    12961    2       GOT_N = %FALSE;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:122  
  12961  3 001160   200026 450100                    STZ     GOT_N,,AUTO

      593    12962    2       GOT_M = %FALSE;

  12962  3 001161   200027 450100                    STZ     GOT_M,,AUTO

      594    12963
      595    12964    2       IF ARS = 1

  12964  3 001162   200013 235100                    LDA     ARS,,AUTO
         3 001163   000001 115007                    CMPA    1,DL
         3 001164   001175 601000 3                  TNZ     s:12970

      596    12965    3       THEN DO;

      597    12966    3           CALL REC_XUU_ERR( %E$XUU#PLUS_ONLY, %TRUE ) ALTRET( BAD_UPDATE );

  12966  3 001165   000031 236000 4                  LDQ     25
         3 001166   200032 756100                    STQ     @P_ERROR_NUM+1,,AUTO
         3 001167   000032 236000 4                  LDQ     26
         3 001170   200031 756100                    STQ     GOT_M+2,,AUTO
         3 001171   003107 701000 3                  TSX1    REC_XUU_ERR
         3 001172   001505 702000 3                  TSX2    BAD_UPDATE

      598    12967    3           RETURN;

  12967  3 001173   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 001174   000001 702211                    TSX2  ! 1,X1

      599    12968    3           END;
      600    12969
      601    12970    2       IF ( ARS > 1 ) AND ( SUBSTR(#USER_BUFFER, 1, 1) = '*' )

  12970  3 001175   001204 604400 3                  TMOZ    s:12975
         3 001176   200016 470500                    LDP0    USER_BUF$,,AUTO
         3 001177   040000 106500                    CMPC    fill='040'O
         3 001200   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:123  
         3 001201   000033 000001 4                  ADSC9   27                       cn=0,n=1
         3 001202   001204 601000 3                  TNZ     s:12975

      602    12971    3       THEN DO;

      603    12972    3           RETURN;

  12972  3 001203   000001 702211                    TSX2  ! 1,X1

      604    12973    3           END;
      605    12974
      606    12975    2       IF ( ARS > 3) AND ( SUBSTR(#USER_BUFFER, 1, 3) = 'END' )

  12975  3 001204   000003 115007                    CMPA    3,DL
         3 001205   001255 604400 3                  TMOZ    s:12996
         3 001206   200016 470500                    LDP0    USER_BUF$,,AUTO
         3 001207   040000 106500                    CMPC    fill='040'O
         3 001210   000000 200003                    ADSC9   0,,PR0                   cn=1,n=3
         3 001211   000616 000003 1                  ADSC9   SO_DCB_NAME+2            cn=0,n=3
         3 001212   001255 601000 3                  TNZ     s:12996

      607    12976    3       THEN DO;

      608    12977    3           IF ( ARS > 4 ) AND ( SUBSTR(#USER_BUFFER, 4, 1 ) ~= ' ' )

  12977  3 001213   000004 115007                    CMPA    4,DL
         3 001214   001227 604400 3                  TMOZ    s:12981
         3 001215   040000 106500                    CMPC    fill='040'O
         3 001216   000001 000001                    ADSC9   1,,PR0                   cn=0,n=1
         3 001217   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001220   001227 600000 3                  TZE     s:12981

      609    12978    4           THEN DO;

      610    12979    4               CALL REC_XUU_ERR( %E$XUU#BAD_PLUS_END, %TRUE ) ALTRET( BAD_UPDATE );

  12979  3 001221   000031 236000 4                  LDQ     25
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:124  
         3 001222   200032 756100                    STQ     @P_ERROR_NUM+1,,AUTO
         3 001223   000035 236000 4                  LDQ     29
         3 001224   200031 756100                    STQ     GOT_M+2,,AUTO
         3 001225   003107 701000 3                  TSX1    REC_XUU_ERR
         3 001226   001505 702000 3                  TSX2    BAD_UPDATE

      611    12980    4               END;

      612    12981    3           CALL READ( UI_INFO )

  12981  3 001227   000004 236000 4                  LDQ     4
         3 001230   200137 756100                    STQ     WRITE_TEMP+3,,AUTO
         3 001231   001507 701000 3                  TSX1    READ
         3 001232   001242 702000 3                  TSX2    s:12986

      613    12982    4           WHENRETURN DO;

      614    12983    4               CALL REC_XUU_ERR( %E$XUU#EXTRA_RECS, %TRUE ) ALTRET( BAD_UPDATE );

  12983  3 001233   000031 236000 4                  LDQ     25
         3 001234   200032 756100                    STQ     @P_ERROR_NUM+1,,AUTO
         3 001235   000037 236000 4                  LDQ     31
         3 001236   200031 756100                    STQ     GOT_M+2,,AUTO
         3 001237   003107 701000 3                  TSX1    REC_XUU_ERR
         3 001240   001505 702000 3                  TSX2    BAD_UPDATE

      615    12984    4               END;

  12984  3 001241   001245 710000 3                  TRA     s:12991

      616    12985    4           WHENALTRETURN DO;

      617    12986    4               IF NOT EOF

  12986  3 001242   200007 234100                    SZN     EOF,,AUTO
         3 001243   001245 604000 3                  TMI     s:12991

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:125  
      618    12987    5               THEN DO;

      619    12988    5                   GOTO UI_IO_ERR;

  12988  3 001244   001477 710000 3                  TRA     UI_IO_ERR

      620    12989    5                   END;
      621    12990    4               END;
      622    12991    3           CALL CLOSE( UI_INFO ) ALTRET ( UI_IO_ERR );

  12991  3 001245   000004 236000 4                  LDQ     4
         3 001246   200261 756100                    STQ     TEMP_VEC+1,,AUTO
         3 001247   002355 701000 3                  TSX1    CLOSE
         3 001250   001477 702000 3                  TSX2    UI_IO_ERR

      623    12992    3           CURRENT_STATE = %#READ_SOURCE_NO_UPDATES;

  12992  3 001251   000002 220003                    LDX0    2,DU
         3 001252   000112 740000 2                  STX0    CURRENT_STATE

      624    12993    3           NEXT_UPDATE_POSITION = 0;

  12993  3 001253   000113 450000 2                  STZ     NEXT_UPDATE_POSITION

      625    12994    3           END;

  12994  3 001254   001475 710000 3                  TRA     s:13074

      626    12995    3       ELSE DO;

      627    12996    3           CALL SEARCH( HALT_POS, HALT_VALUE, SEARCH_TABLE, #USER_BUFFER, 1);

  12996  3 001255   777777 620005                    EAX0    -1,AL
         3 001256   200016 470500                    LDP0    USER_BUF$,,AUTO
         3 001257   000000 164540                    TCT
         3 001260   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         3 001261   000014 000000 1                  ARG     SEARCH_TABLE
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:126  
         3 001262   200023 000100                    ARG     HALT_POS,,AUTO
         3 001263   200023 236100                    LDQ     HALT_POS,,AUTO
         3 001264   000044 737000                    LLS     36
         3 001265   000033 771000                    ARL     27
         3 001266   200024 755100                    STA     HALT_VALUE,,AUTO
         3 001267   200023 551140                    STBA    HALT_POS,'40'O,AUTO
         3 001270   200023 054100                    AOS     HALT_POS,,AUTO

      628    12997    3           IF ( HALT_POS > 1 )

  12997  3 001271   200023 236100                    LDQ     HALT_POS,,AUTO
         3 001272   000001 116007                    CMPQ    1,DL
         3 001273   001352 604400 3                  TMOZ    s:13020

      629    12998    4           THEN DO;

      630    12999    4               GOT_N = %TRUE;

  12999  3 001274   400000 236003                    LDQ     -131072,DU
         3 001275   200026 756100                    STQ     GOT_N,,AUTO

      631    13000    4               CALL CHARBIN( N, SUBSTR(#USER_BUFFER, 1, HALT_POS-1) );

  13000  3 001276   200023 722100                    LXL2    HALT_POS,,AUTO
         3 001277   777777 623012                    EAX3    -1,X2
         3 001300   000100 305540                    DTB
         3 001301   000000 230013                    NDSC9   0,,PR0                   cn=1,s=nosgn,sf=0,n=*X3
         3 001302   200021 000004                    NDSC9   N,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      632    13001    4               IF HALT_VALUE = %#COMMA

  13001  3 001303   000001 115007                    CMPA    1,DL
         3 001304   001354 601000 3                  TNZ     s:13022

      633    13002    5               THEN DO;

      634    13003    5                   COMMA_POS = HALT_POS;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:127  

  13003  3 001305   200023 235100                    LDA     HALT_POS,,AUTO
         3 001306   200025 755100                    STA     COMMA_POS,,AUTO

      635    13004    5                   CALL SEARCH( HALT_POS, HALT_VALUE, SEARCH_TABLE, #USER_BUFFER,
             13004                            COMMA_POS+1 );

  13004  3 001307   200013 236100                    LDQ     ARS,,AUTO
         3 001310   200025 136100                    SBLQ    COMMA_POS,,AUTO
         3 001311   777777 624006                    EAX4    -1,QL
         3 001312   200025 236100                    LDQ     COMMA_POS,,AUTO
         3 001313   000001 036007                    ADLQ    1,DL
         3 001314   000000 164545                    TCT
         3 001315   000000 200014                    ADSC9   0,A,PR0                  cn=1,n=*X4
         3 001316   000014 000000 1                  ARG     SEARCH_TABLE
         3 001317   200023 000100                    ARG     HALT_POS,,AUTO
         3 001320   200023 235100                    LDA     HALT_POS,,AUTO
         3 001321   000033 771000                    ARL     27
         3 001322   200024 755100                    STA     HALT_VALUE,,AUTO
         3 001323   200023 551140                    STBA    HALT_POS,'40'O,AUTO
         3 001324   200023 056100                    ASQ     HALT_POS,,AUTO

      636    13005    5                   IF ( HALT_POS > ( COMMA_POS + 1 ) )

  13005  3 001325   200023 116100                    CMPQ    HALT_POS,,AUTO
         3 001326   001347 605000 3                  TPL     s:13015

      637    13006    6                   THEN DO;

      638    13007    6                       IF ( HALT_VALUE ~= %#BLANK ) AND ( HALT_VALUE ~= %#NUMERIC )

  13007  3 001327   000002 115007                    CMPA    2,DL
         3 001330   001335 600000 3                  TZE     s:13011
         3 001331   000000 115003                    CMPA    0,DU
         3 001332   001335 600000 3                  TZE     s:13011

      639    13008    7                       THEN DO;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:128  

      640    13009    7                           HALT_VALUE = %#JUNK;

  13009  3 001333   000003 235007                    LDA     3,DL
         3 001334   200024 755100                    STA     HALT_VALUE,,AUTO

      641    13010    7                           END;

      642    13011    6                       GOT_M = %TRUE;

  13011  3 001335   400000 236003                    LDQ     -131072,DU
         3 001336   200027 756100                    STQ     GOT_M,,AUTO

      643    13012    6                       CALL CHARBIN( M, SUBSTR(#USER_BUFFER, COMMA_POS+1, HALT_POS-(
             13012                                COMMA_POS+1)) );

  13012  3 001337   200023 236100                    LDQ     HALT_POS,,AUTO
         3 001340   200025 136100                    SBLQ    COMMA_POS,,AUTO
         3 001341   777777 622006                    EAX2    -1,QL
         3 001342   200025 236100                    LDQ     COMMA_POS,,AUTO
         3 001343   000100 305546                    DTB
         3 001344   000000 230012                    NDSC9   0,Q,PR0                  cn=1,s=nosgn,sf=0,n=*X2
         3 001345   200022 000004                    NDSC9   M,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      644    13013    6                       END;

  13013  3 001346   001354 710000 3                  TRA     s:13022

      645    13014    6                   ELSE DO;

      646    13015    6                       HALT_VALUE = %#JUNK;

  13015  3 001347   000003 235007                    LDA     3,DL
         3 001350   200024 755100                    STA     HALT_VALUE,,AUTO

      647    13016    6                       END;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:129  
      648    13017    5                   END;

      649    13018    4               END;

  13018  3 001351   001354 710000 3                  TRA     s:13022

      650    13019    4           ELSE DO;

      651    13020    4               HALT_VALUE = %#JUNK;

  13020  3 001352   000003 235007                    LDA     3,DL
         3 001353   200024 755100                    STA     HALT_VALUE,,AUTO

      652    13021    4               END;

      653    13022    3           IF ( HALT_VALUE = %#JUNK )

  13022  3 001354   000003 115007                    CMPA    3,DL
         3 001355   001377 601000 3                  TNZ     s:13039

      654    13023    4           THEN DO;

      655    13024    4               CALL REC_XUU_ERR( %E$XUU#BAD_UPDATE, %TRUE ) ALTRET( BAD_UPDATE );

  13024  3 001356   000031 236000 4                  LDQ     25
         3 001357   200032 756100                    STQ     @P_ERROR_NUM+1,,AUTO
         3 001360   000041 236000 4                  LDQ     33
         3 001361   200031 756100                    STQ     GOT_M+2,,AUTO
         3 001362   003107 701000 3                  TSX1    REC_XUU_ERR
         3 001363   001505 702000 3                  TSX2    BAD_UPDATE

      656    13025    4               IF NOT GOT_M

  13025  3 001364   200027 234100                    SZN     GOT_M,,AUTO
         3 001365   001377 604000 3                  TMI     s:13039

      657    13026    5               THEN DO;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:130  

      658    13027    5                   IF NOT GOT_N

  13027  3 001366   200026 234100                    SZN     GOT_N,,AUTO
         3 001367   001373 604000 3                  TMI     s:13032

      659    13028    6                   THEN DO;

      660    13029    6                       N = SI_INFO.RECORD_COUNT;

  13029  3 001370   000022 235000 2                  LDA     SI_INFO+1
         3 001371   200021 755100                    STA     N,,AUTO

      661    13030    6                       END;

  13030  3 001372   001377 710000 3                  TRA     s:13039

      662    13031    6                   ELSE DO;

      663    13032    6                       IF ( COMMA_POS ~= 0 )

  13032  3 001373   200025 235100                    LDA     COMMA_POS,,AUTO
         3 001374   001377 600000 3                  TZE     s:13039

      664    13033    7                       THEN DO;

      665    13034    7                           M = N;

  13034  3 001375   200021 236100                    LDQ     N,,AUTO
         3 001376   200022 756100                    STQ     M,,AUTO

      666    13035    7                           END;

      667    13036    6                       END;

      668    13037    5                   END;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:131  
      669    13038    4               END;

      670    13039    3           IF ( M ~= 0 ) AND ( M < N )

  13039  3 001377   200022 235100                    LDA     M,,AUTO
         3 001400   001414 600000 3                  TZE     s:13044
         3 001401   200022 236100                    LDQ     M,,AUTO
         3 001402   200021 116100                    CMPQ    N,,AUTO
         3 001403   001414 605000 3                  TPL     s:13044

      671    13040    4           THEN DO;

      672    13041    4               CALL REC_XUU_ERR( %E$XUU#BAD_RANGE, %TRUE ) ALTRET( BAD_UPDATE );

  13041  3 001404   000031 236000 4                  LDQ     25
         3 001405   200032 756100                    STQ     @P_ERROR_NUM+1,,AUTO
         3 001406   000043 236000 4                  LDQ     35
         3 001407   200031 756100                    STQ     GOT_M+2,,AUTO
         3 001410   003107 701000 3                  TSX1    REC_XUU_ERR
         3 001411   001505 702000 3                  TSX2    BAD_UPDATE

      673    13042    4               M = N;

  13042  3 001412   200021 235100                    LDA     N,,AUTO
         3 001413   200022 755100                    STA     M,,AUTO

      674    13043    4               END;

      675    13044    3           IF ( N > NRECS_IN_SOURCE ) OR ( M > NRECS_IN_SOURCE )

  13044  3 001414   200021 236100                    LDQ     N,,AUTO
         3 001415   000111 116000 2                  CMPQ    NRECS_IN_SOURCE
         3 001416   001422 605400 3                  TPNZ    s:13046
         3 001417   200022 236100                    LDQ     M,,AUTO
         3 001420   000111 116000 2                  CMPQ    NRECS_IN_SOURCE
         3 001421   001435 604400 3                  TMOZ    s:13051

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:132  
      676    13045    4           THEN DO;

      677    13046    4               CALL REC_XUU_ERR( %E$XUU#UPDATE_PAST_EOF, %TRUE ) ALTRET( BAD_UPDATE );

  13046  3 001422   000031 236000 4                  LDQ     25
         3 001423   200032 756100                    STQ     @P_ERROR_NUM+1,,AUTO
         3 001424   000011 236000 4                  LDQ     9
         3 001425   200031 756100                    STQ     GOT_M+2,,AUTO
         3 001426   003107 701000 3                  TSX1    REC_XUU_ERR
         3 001427   001505 702000 3                  TSX2    BAD_UPDATE

      678    13047    4               NEXT_UPDATE_POSITION = 0;

  13047  3 001430   000113 450000 2                  STZ     NEXT_UPDATE_POSITION

      679    13048    4               CURRENT_STATE = %#READ_SOURCE_NO_UPDATES;

  13048  3 001431   000002 220003                    LDX0    2,DU
         3 001432   000112 740000 2                  STX0    CURRENT_STATE

      680    13049    4               RETURN;

  13049  3 001433   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 001434   000001 702211                    TSX2  ! 1,X1

      681    13050    4               END;
      682    13051    3           IF ( M = 0 )

  13051  3 001435   000000 116003                    CMPQ    0,DU
         3 001436   001443 601000 3                  TNZ     s:13057

      683    13052    4           THEN DO;

      684    13053    4               NEXT_UPDATE_POSITION = N;

  13053  3 001437   200021 235100                    LDA     N,,AUTO
         3 001440   000113 755000 2                  STA     NEXT_UPDATE_POSITION
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:133  

      685    13054    4               SI_SKIP_COUNT = 0;

  13054  3 001441   000114 450000 2                  STZ     SI_SKIP_COUNT

      686    13055    4               END;

  13055  3 001442   001451 710000 3                  TRA     s:13060

      687    13056    4           ELSE DO;

      688    13057    4               NEXT_UPDATE_POSITION = N-1;

  13057  3 001443   200021 235100                    LDA     N,,AUTO
         3 001444   000001 135007                    SBLA    1,DL
         3 001445   000113 755000 2                  STA     NEXT_UPDATE_POSITION

      689    13058    4               SI_SKIP_COUNT = ( M - N ) + 1;

  13058  3 001446   200021 136100                    SBLQ    N,,AUTO
         3 001447   000001 036007                    ADLQ    1,DL
         3 001450   000114 756000 2                  STQ     SI_SKIP_COUNT

      690    13059    4               END;

      691    13060    3           IF NEXT_UPDATE_POSITION < SI_INFO.RECORD_COUNT

  13060  3 001451   000113 236000 2                  LDQ     NEXT_UPDATE_POSITION
         3 001452   000022 116000 2                  CMPQ    SI_INFO+1
         3 001453   001475 605000 3                  TPL     s:13074

      692    13061    4           THEN DO;

      693    13062    4               CALL REC_XUU_ERR( %E$XUU#UN_SORTED, %TRUE ) ALTRET( BAD_UPDATE );

  13062  3 001454   000031 236000 4                  LDQ     25
         3 001455   200032 756100                    STQ     @P_ERROR_NUM+1,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:134  
         3 001456   000045 236000 4                  LDQ     37
         3 001457   200031 756100                    STQ     GOT_M+2,,AUTO
         3 001460   003107 701000 3                  TSX1    REC_XUU_ERR
         3 001461   001505 702000 3                  TSX2    BAD_UPDATE

      694    13063    4               NEXT_UPDATE_POSITION = SI_INFO.RECORD_COUNT;

  13063  3 001462   000022 235000 2                  LDA     SI_INFO+1
         3 001463   000113 755000 2                  STA     NEXT_UPDATE_POSITION

      695    13064    4               IF ( M ~= 0 ) AND ( M > SI_INFO.RECORD_COUNT )

  13064  3 001464   200022 236100                    LDQ     M,,AUTO
         3 001465   001474 600000 3                  TZE     s:13069
         3 001466   000022 116000 2                  CMPQ    SI_INFO+1
         3 001467   001474 604400 3                  TMOZ    s:13069

      696    13065    5               THEN DO;

      697    13066    5                   SI_SKIP_COUNT = ( M - NEXT_UPDATE_POSITION ) + 1;

  13066  3 001470   000113 136000 2                  SBLQ    NEXT_UPDATE_POSITION
         3 001471   000001 036007                    ADLQ    1,DL
         3 001472   000114 756000 2                  STQ     SI_SKIP_COUNT

      698    13067    5                   END;

  13067  3 001473   001475 710000 3                  TRA     s:13074

      699    13068    5               ELSE DO;

      700    13069    5                   SI_SKIP_COUNT = 0;

  13069  3 001474   000114 450000 2                  STZ     SI_SKIP_COUNT

      701    13070    5                   END;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:135  
      702    13071    4               END;

      703    13072    3           END;

      704    13073
      705    13074    2       RETURN;

  13074  3 001475   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 001476   000001 702211                    TSX2  ! 1,X1

  13066  3 001477                       UI_IO_ERR    null
      706    13075
      707    13076    2   UI_IO_ERR: ;
      708    13077    2       CALL KILL_IO_ERR( %UI_ERR );

  13077  3 001477   000022 236000 4                  LDQ     18
         3 001500   200245 756100                    STQ     @P_PARAM$+2,,AUTO
         3 001501   003071 701000 3                  TSX1    KILL_IO_ERR
         3 001502   000000 011000                    NOP     0

      709    13078    2       ALTRETURN;

  13078  3 001503   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 001504   000000 702211                    TSX2  ! 0,X1

  13066  3 001505                       BAD_UPDATE   null
      710    13079
      711    13080    2   BAD_UPDATE: ;
      712    13081    2       ALTRETURN;

  13081  3 001505   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 001506   000000 702211                    TSX2  ! 0,X1

      713    13082
      714    13083    2   END PARSE_AND_CHECK_PLUS;
      715    13084
      716    13085        %PAGE( ARG=READ, PAGE=YES );
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:136  

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:137  
             13097    2   /*******************************************************************************
             13098    2   *                                                                              *
             13099    2   *        READ              READ                                                  *
             13100    2   *                                                                              *
             13101    2   *******************************************************************************/

      717    13105    1   READ: PROC( P_INFO ) ALTRET;

  13105  3 001507   200136 741300       READ         STX1  ! WRITE_TEMP+2,,AUTO

      718    13106
      719    13107        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
      720    13141    2   DCL TEMP_CHAR8 CHAR(8) DALIGNED;
      721    13142    2   DCL 1 KEY_BUF ALIGNED,
      722    13143    2         2 COUNT UBIN BYTE CALIGNED,
      723    13144    2         2 KEY UBIN(27) UNAL,
      724    13145    2         2 * CHAR(251) CALIGNED;
      725    13146    2   DCL ALT_FLAG BIT(1) ALIGNED;
      726    13147
      727    13148    2       EOF = %FALSE;

  13148  3 001510   200007 450100                    STZ     EOF,,AUTO

      728    13149    2       ALT_FLAG = %FALSE;

  13149  3 001511   200242 450100                    STZ     ALT_FLAG,,AUTO

      729    13150    2       READ_FPT.V.DCB# = P_INFO.DCB#;

  13150  3 001512   200137 470500                    LDP0    @P_INFO,,AUTO
         3 001513   000003 720100                    LXL0    3,,PR0
         3 001514   000010 740000 2                  STX0    READ_FPT+8

      730    13151    2       READ_FPT.KEY_ = VECTOR( KEY_BUF );

  13151  3 001515   000046 235000 4                  LDA     38
         3 001516   200334 452500                    STP2    TEMP_CODE+2,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:138  
         3 001517   200334 236100                    LDQ     TEMP_CODE+2,,AUTO
         3 001520   000142 036003                    ADLQ    98,DU
         3 001521   000002 757000 2                  STAQ    READ_FPT+2

      731    13152
      732    13153    2       IF P_INFO.FAST

  13153  3 001522   000003 234100                    SZN     3,,PR0
         3 001523   001541 605000 3                  TPL     s:13159

      733    13154    3       THEN DO;

      734    13155    3           CALL XSA$READ( READ_FPT, P_INFO.XSA_PARAM$->XSA_PARAM ) ALTRET (
             13155                    BAD_FAST_READ );

  13155  3 001524   000000 471500                    LDP1    0,,PR0
         3 001525   200335 451500                    STP1    TEMP_CODE+3,,AUTO
         3 001526   000047 236000 4                  LDQ     39
         3 001527   200334 756100                    STQ     TEMP_CODE+2,,AUTO
         3 001530   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 001531   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001532   000000 701000 xent               TSX1    XSA$READ
         3 001533   001557 702000 3                  TSX2    BAD_FAST_READ

      735    13156    3           ARS = P_INFO.XSA_PARAM$->XSA_PARAM.ARS#;

  13156  3 001534   200137 470500                    LDP0    @P_INFO,,AUTO
         3 001535   000000 471500                    LDP1    0,,PR0
         3 001536   100000 235100                    LDA     0,,PR1
         3 001537   200013 755100                    STA     ARS,,AUTO

      736    13157    3           END;

  13157  3 001540   001551 710000 3                  TRA     s:13163

      737    13158    3       ELSE DO;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:139  
      738    13159    3           CALL M$READ( READ_FPT ) ALTRET ( BAD_NORMAL_READ );

  13159  3 001541   000000 630400 2                  EPPR0   READ_FPT
         3 001542   440000 713400                    CLIMB   alt,read
         3 001543   401400 401760                    pmme    nvectors=4
         3 001544   001552 702000 3                  TSX2    BAD_NORMAL_READ

      739    13160    3           ARS = P_INFO.DCB$->F$DCB.ARS#;

  13160  3 001545   200137 470500                    LDP0    @P_INFO,,AUTO
         3 001546   000002 471500                    LDP1    2,,PR0
         3 001547   100000 235100                    LDA     0,,PR1
         3 001550   200013 755100                    STA     ARS,,AUTO

      740    13161    3           END;

      741    13162
      742    13163    3       DO WHILE %FALSE;

  13163  3 001551   001613 710000 3                  TRA     s:13185

  13160  3 001552                       BAD_NORMAL_* null
      743    13164    3   BAD_NORMAL_READ: ;
      744    13165    3           ERROR_CODE = #MONERR;

  13165  3 001552   000000 470400 xsym               LDP0    B$TCB$
         3 001553   000000 471500                    LDP1    0,,PR0
         3 001554   100102 236100                    LDQ     66,,PR1
         3 001555   200005 756100                    STQ     ERROR_CODE,,AUTO

      745    13166    3           GOTO BAD_READ;

  13166  3 001556   001563 710000 3                  TRA     BAD_READ

  13165  3 001557                       BAD_FAST_RE* null
      746    13167
      747    13168    3   BAD_FAST_READ: ;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:140  
      748    13169    3           ERROR_CODE = P_INFO.XSA_PARAM$ -> XSA_PARAM.ERR;

  13169  3 001557   200137 470500                    LDP0    @P_INFO,,AUTO
         3 001560   000000 471500                    LDP1    0,,PR0
         3 001561   100001 236100                    LDQ     1,,PR1
         3 001562   200005 756100                    STQ     ERROR_CODE,,AUTO

  13169  3 001563                       BAD_READ     null
      749    13170
      750    13171    3   BAD_READ: ;
      751    13172    3           EOF = ( ERROR_CODE.ERR# = %E$EOF );

  13172  3 001563   400000 220003                    LDX0    -131072,DU
         3 001564   200005 236100                    LDQ     ERROR_CODE,,AUTO
         3 001565   377770 376007                    ANQ     131064,DL
         3 001566   000060 116007                    CMPQ    48,DL
         3 001567   001571 600000 3                  TZE     BAD_READ+6
         3 001570   000000 220003                    LDX0    0,DU
         3 001571   000000 636010                    EAQ     0,X0
         3 001572   200007 756100                    STQ     EOF,,AUTO

      752    13173    3           ALT_FLAG = %TRUE;

  13173  3 001573   400000 236003                    LDQ     -131072,DU
         3 001574   200242 756100                    STQ     ALT_FLAG,,AUTO

      753    13174    3           IF ERROR_CODE.ERR# = %E$LD

  13174  3 001575   200005 236100                    LDQ     ERROR_CODE,,AUTO
         3 001576   377770 376007                    ANQ     131064,DL
         3 001577   000070 116007                    CMPQ    56,DL
         3 001600   001613 601000 3                  TNZ     s:13185

      754    13175    4           THEN DO;

      755    13176    4               ARS = VBOUND( BITVECT(READ_FPT.BUF_) );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:141  
  13176  3 001601   000004 236000 2                  LDQ     READ_FPT+4
         3 001602   000020 772000                    QRL     16
         3 001603   200013 756100                    STQ     ARS,,AUTO

      756    13177    4               CALL REC_IO_ERR( ERROR_CODE, %FALSE )

  13177  3 001604   000010 236000 4                  LDQ     8
         3 001605   200246 756100                    STQ     @P_FILE+1,,AUTO
         3 001606   200005 630500                    EPPR0   ERROR_CODE,,AUTO
         3 001607   200245 450500                    STP0    @P_PARAM$+2,,AUTO
         3 001610   003057 701000 3                  TSX1    REC_IO_ERR
         3 001611   001613 702000 3                  TSX2    s:13185

      757    13178    5               WHENRETURN DO;

      758    13179    5                   ALT_FLAG = %FALSE;

  13179  3 001612   200242 450100                    STZ     ALT_FLAG,,AUTO

      759    13180    5                   END;

      760    13181    4               END;

      761    13182
      762    13183    3           END;

      763    13184
      764    13185    2       P_INFO.RECORD_COUNT = P_INFO.RECORD_COUNT + 1;

  13185  3 001613   200137 470500                    LDP0    @P_INFO,,AUTO
         3 001614   000001 054100                    AOS     1,,PR0

      765    13186
      766    13187    2       IF NOT EOF

  13187  3 001615   200007 234100                    SZN     EOF,,AUTO
         3 001616   001664 604000 3                  TMI     s:13208
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:142  

      767    13188    3       THEN DO;

      768    13189    4           DO CASE ( P_INFO.KEY_TYPE );

  13189  3 001617   000003 220100                    LDX0    3,,PR0
         3 001620   000777 360003                    ANX0    511,DU
         3 001621   000002 100003                    CMPX0   2,DU
         3 001622   001624 602010 3                  TNC     s:13189+5,X0
         3 001623   001654 710000 3                  TRA     CONSEC
         3 001624   001654 710000 3                  TRA     CONSEC
         3 001625   001626 710000 3                  TRA     s:13191

      769    13190    4           CASE ( %#EDIT_KEY );

      770    13191    4               IF KEY_BUF.COUNT = %EDIT_KEY_SIZE

  13191  3 001626   200142 236100                    LDQ     KEY_BUF,,AUTO
         3 001627   777000 376003                    ANQ     -512,DU
         3 001630   003000 116003                    CMPQ    1536,DU
         3 001631   001651 601000 3                  TNZ     s:13198

      771    13192    5               THEN DO;

      772    13193    5                   CALL BINCHAR( TEMP_CHAR8, KEY_BUF.KEY );

  13193  3 001632   200142 236100                    LDQ     KEY_BUF,,AUTO
         3 001633   000032 376000 xsym               ANQ     B_VECTNIL+26
         3 001634   000000 235003                    LDA     0,DU
         3 001635   200334 757100                    STAQ    TEMP_CODE+2,,AUTO
         3 001636   000100 301500                    BTD
         3 001637   200334 000010                    NDSC9   TEMP_CODE+2,,AUTO        cn=0,s=lsgnf,sf=0,n=8
         3 001640   200140 030010                    NDSC9   TEMP_CHAR8,,AUTO         cn=0,s=nosgn,sf=0,n=8

      773    13194    5                   CALL EDITCHAR( XUU_PARAM.RE_ASCII_KEY.CHAR1_9, 0, 9, EDIT_MOPS,
             13194                            TEMP_CHAR8 );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:143  
  13194  3 001641   200003 471500                    LDP1    @XUU_PARAM,,AUTO
         3 001642   100000 024500                    MVNE
         3 001643   200140 030010                    NDSC9   TEMP_CHAR8,,AUTO         cn=0,s=nosgn,sf=0,n=8
         3 001644   000011 000005 1                  ADSC9   EDIT_MOPS                cn=0,n=5
         3 001645   100003 000011                    ADSC9   3,,PR1                   cn=0,n=9

      774    13195    5                   XUU_PARAM.FLAGS.KEY_REC# = %TRUE;

  13195  3 001646   004000 236003                    LDQ     2048,DU
         3 001647   100000 256100                    ORSQ    0,,PR1

      775    13196    5                   END;

  13196  3 001650   001664 710000 3                  TRA     s:13208

      776    13197    5               ELSE DO;

      777    13198    5                   P_INFO.KEY_TYPE = %#CONSEC;

  13198  3 001651   000002 236003                    LDQ     2,DU
         3 001652   000003 552120                    STBQ    3,'20'O,PR0

      778    13199    5                   GOTO CONSEC;

  13199  3 001653   001654 710000 3                  TRA     CONSEC

      779    13200    5                   END;
      780    13201    4           CASE ( %#CONSEC,ELSE );

  13199  3 001654                       CONSEC       null
      781    13202    4   CONSEC:     ;
      782    13203    4               CALL BINCHAR( TEMP_CHAR8, P_INFO.RECORD_COUNT );

  13203  3 001654   000100 301500                    BTD
         3 001655   000001 000004                    NDSC9   1,,PR0                   cn=0,s=lsgnf,sf=0,n=4
         3 001656   200140 030010                    NDSC9   TEMP_CHAR8,,AUTO         cn=0,s=nosgn,sf=0,n=8

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:144  
      783    13204    4               CALL EDITCHAR( XUU_PARAM.RE_ASCII_KEY.CHAR1_9, 0, 9, SEQ_MOPS,
             13204                        TEMP_CHAR8 );

  13204  3 001657   200003 471500                    LDP1    @XUU_PARAM,,AUTO
         3 001660   100000 024500                    MVNE
         3 001661   200140 030010                    NDSC9   TEMP_CHAR8,,AUTO         cn=0,s=nosgn,sf=0,n=8
         3 001662   000013 000003 1                  ADSC9   SEQ_MOPS                 cn=0,n=3
         3 001663   100003 000011                    ADSC9   3,,PR1                   cn=0,n=9

      784    13205    4               END;

      785    13206    3           END;

      786    13207
      787    13208    2       IF ALT_FLAG

  13208  3 001664   200242 234100                    SZN     ALT_FLAG,,AUTO
         3 001665   001670 605000 3                  TPL     s:13210

      788    13209    2       THEN ALTRETURN;

  13209  3 001666   200136 221300                    LDX1  ! WRITE_TEMP+2,,AUTO
         3 001667   000000 702211                    TSX2  ! 0,X1

      789    13210    2       ELSE RETURN;

  13210  3 001670   200136 221300                    LDX1  ! WRITE_TEMP+2,,AUTO
         3 001671   000001 702211                    TSX2  ! 1,X1

      790    13211
      791    13212    2   END READ;
      792    13213
      793    13214        %PAGE( ARG=WRITE, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:145  
             13226    2   /*******************************************************************************
             13227    2   *                                                                              *
             13228    2   *        WRITE              WRITE                                                 *
             13229    2   *                                                                              *
             13230    2   *******************************************************************************/

      794    13234    1   WRITE: PROC( P_INFO, P_WRITE_BUF_, P_KEY_ ) ALTRET;

  13234  3 001672   200142 741300       WRITE        STX1  ! KEY_BUF,,AUTO

      795    13235
      796    13236        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
      797    13270    2   DCL P_WRITE_BUF_ VECTOR DALIGNED;
      798    13271    2   DCL P_KEY_ VECTOR DALIGNED;
      799    13272
      800    13273        %FPT_WRITE( FPTN=CONST_WRITE_FPT, STCLASS=CONSTANT );
      801    13304        %FPT_WRITE( FPTN=WRITE_FPT, STCLASS=" " );
      802    13335
      803    13336
      804    13337    2       WRITE_FPT = CONST_WRITE_FPT;

  13337  3 001673   000100 100400                    MLR     fill='000'O
         3 001674   000214 000060 1                  ADSC9   CONST_WRITE_FPT          cn=0,n=48
         3 001675   200146 000060                    ADSC9   WRITE_FPT,,AUTO          cn=0,n=48

      805    13338    2       WRITE_FPT.V_ = VECTOR( WRITE_FPT.V );

  13338  3 001676   000050 235000 4                  LDA     40
         3 001677   200334 452500                    STP2    TEMP_CODE+2,,AUTO
         3 001700   200334 236100                    LDQ     TEMP_CODE+2,,AUTO
         3 001701   000156 036003                    ADLQ    110,DU
         3 001702   200146 757100                    STAQ    WRITE_FPT,,AUTO

      806    13339    2       WRITE_FPT.V.DCB# = P_INFO.DCB#;

  13339  3 001703   200143 470500                    LDP0    @P_INFO,,AUTO
         3 001704   000003 720100                    LXL0    3,,PR0
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:146  
         3 001705   200156 740100                    STX0    WRITE_FPT+8,,AUTO

      807    13340
      808    13341    2       IF ADDR(P_WRITE_BUF_) = ADDR(NIL)

  13341  3 001706   200144 236100                    LDQ     @P_WRITE_BUF_,,AUTO
         3 001707   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 001710   001723 601000 3                  TNZ     s:13352

      809    13342    3       THEN DO;

      810    13343    3           IF ARS ~= 0

  13343  3 001711   200013 235100                    LDA     ARS,,AUTO
         3 001712   001720 600000 3                  TZE     s:13348

      811    13344    4           THEN DO;

      812    13345    4               WRITE_FPT.BUF_ = VECTOR( #USER_BUFFER );

  13345  3 001713   000020 735000                    ALS     16
         3 001714   000140 135007                    SBLA    96,DL
         3 001715   200016 236100                    LDQ     USER_BUF$,,AUTO
         3 001716   200152 757100                    STAQ    WRITE_FPT+4,,AUTO

      813    13346    4               END;

  13346  3 001717   001726 710000 3                  TRA     s:13355

      814    13347    4           ELSE DO;

      815    13348    4               WRITE_FPT.BUF_ = VECTOR(NIL);

  13348  3 001720   000026 237000 4                  LDAQ    22
         3 001721   200152 757100                    STAQ    WRITE_FPT+4,,AUTO

      816    13349    4               END;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:147  

      817    13350    3           END;

  13350  3 001722   001726 710000 3                  TRA     s:13355

      818    13351    3       ELSE DO;

      819    13352    3           WRITE_FPT.BUF_ = P_WRITE_BUF_;

  13352  3 001723   200144 471500                    LDP1    @P_WRITE_BUF_,,AUTO
         3 001724   100000 237100                    LDAQ    0,,PR1
         3 001725   200152 757100                    STAQ    WRITE_FPT+4,,AUTO

      820    13353    3           END;

      821    13354
      822    13355    2       IF ADDR(P_KEY_) ~= ADDR(NIL) AND

  13355  3 001726   200145 236100                    LDQ     @P_KEY_,,AUTO
         3 001727   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 001730   001740 600000 3                  TZE     s:13361
         3 001731   000003 236100                    LDQ     3,,PR0
         3 001732   000777 376003                    ANQ     511,DU
         3 001733   000001 116003                    CMPQ    1,DU
         3 001734   001740 601000 3                  TNZ     s:13361

      823    13356    2          P_INFO.KEY_TYPE = %#EDIT_KEY
      824    13357    3       THEN DO;

      825    13358    3           WRITE_FPT.KEY_ = P_KEY_;

  13358  3 001735   200145 471500                    LDP1    @P_KEY_,,AUTO
         3 001736   100000 237100                    LDAQ    0,,PR1
         3 001737   200150 757100                    STAQ    WRITE_FPT+2,,AUTO

      826    13359    3           END;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:148  
      827    13360
      828    13361    2       IF P_INFO.FAST

  13361  3 001740   000003 234100                    SZN     3,,PR0
         3 001741   001753 605000 3                  TPL     s:13366

      829    13362    3       THEN DO;

      830    13363    3           CALL XSA$WRITE( WRITE_FPT, P_INFO.XSA_PARAM$->XSA_PARAM ) ALTRET (
             13363                    BAD_FAST_WRITE );

  13363  3 001742   000000 471500                    LDP1    0,,PR0
         3 001743   200335 451500                    STP1    TEMP_CODE+3,,AUTO
         3 001744   200146 633500                    EPPR3   WRITE_FPT,,AUTO
         3 001745   200334 453500                    STP3    TEMP_CODE+2,,AUTO
         3 001746   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 001747   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001750   000000 701000 xent               TSX1    XSA$WRITE
         3 001751   001770 702000 3                  TSX2    BAD_FAST_WRITE

      831    13364    3           END;

  13364  3 001752   001757 710000 3                  TRA     s:13369

      832    13365    3       ELSE DO;

      833    13366    3           CALL M$WRITE( WRITE_FPT ) ALTRET ( BAD_NORMAL_WRITE );

  13366  3 001753   200146 630500                    EPPR0   WRITE_FPT,,AUTO
         3 001754   440001 713400                    CLIMB   alt,write
         3 001755   401400 401760                    pmme    nvectors=4
         3 001756   001763 702000 3                  TSX2    BAD_NORMAL_WRITE

      834    13367    3           END;

      835    13368
      836    13369    2       P_INFO.RECORD_COUNT = P_INFO.RECORD_COUNT + 1;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:149  

  13369  3 001757   200143 470500                    LDP0    @P_INFO,,AUTO
         3 001760   000001 054100                    AOS     1,,PR0

      837    13370
      838    13371    2       RETURN;

  13371  3 001761   200142 221300                    LDX1  ! KEY_BUF,,AUTO
         3 001762   000001 702211                    TSX2  ! 1,X1

  13369  3 001763                       BAD_NORMAL_* null
      839    13372
      840    13373    2   BAD_NORMAL_WRITE: ;
      841    13374    2       ERROR_CODE = #MONERR;

  13374  3 001763   000000 470400 xsym               LDP0    B$TCB$
         3 001764   000000 471500                    LDP1    0,,PR0
         3 001765   100102 236100                    LDQ     66,,PR1
         3 001766   200005 756100                    STQ     ERROR_CODE,,AUTO

      842    13375    2       GOTO BAD_WRITE;

  13375  3 001767   001774 710000 3                  TRA     BAD_WRITE

  13374  3 001770                       BAD_FAST_WR* null
      843    13376
      844    13377    2   BAD_FAST_WRITE: ;
      845    13378    2       ERROR_CODE = P_INFO.XSA_PARAM$->XSA_PARAM.ERR;

  13378  3 001770   200143 470500                    LDP0    @P_INFO,,AUTO
         3 001771   000000 471500                    LDP1    0,,PR0
         3 001772   100001 236100                    LDQ     1,,PR1
         3 001773   200005 756100                    STQ     ERROR_CODE,,AUTO

  13378  3 001774                       BAD_WRITE    null
      846    13379
      847    13380    2   BAD_WRITE: ;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:150  
      848    13381    2       ALTRETURN;

  13381  3 001774   200142 221300                    LDX1  ! KEY_BUF,,AUTO
         3 001775   000000 702211                    TSX2  ! 0,X1

      849    13382
      850    13383    2   END WRITE;
      851    13384
      852    13385        %PAGE( ARG=PFIL, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:151  
             13397    2   /*******************************************************************************
             13398    2   *                                                                              *
             13399    2   *        PFIL              PFIL                                                  *
             13400    2   *                                                                              *
             13401    2   *******************************************************************************/

      853    13405    1   PFIL: PROC( P_INFO, P_DIRECTION ) ALTRET;

  13405  3 001776   200136 741300       PFIL         STX1  ! WRITE_TEMP+2,,AUTO

      854    13406
      855    13407        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
      856    13441    2   DCL P_DIRECTION UBIN WORD ALIGNED;
      857    13442        %FPT_PFIL( FPTN=CONST_PFIL_FPT, STCLASS=CONSTANT, BOF=YES );
      858    13457        %FPT_PFIL( FPTN=PFIL_FPT, STCLASS=" " );
      859    13472
      860    13473    2       PFIL_FPT = CONST_PFIL_FPT;

  13473  3 001777   000100 100400                    MLR     fill='000'O
         3 002000   000230 000020 1                  ADSC9   CONST_PFIL_FPT           cn=0,n=16
         3 002001   200142 000020                    ADSC9   PFIL_FPT,,AUTO           cn=0,n=16

      861    13474    2       PFIL_FPT.V_ = VECTOR( PFIL_FPT.V );

  13474  3 002002   000051 235000 4                  LDA     41
         3 002003   200334 452500                    STP2    TEMP_CODE+2,,AUTO
         3 002004   200334 236100                    LDQ     TEMP_CODE+2,,AUTO
         3 002005   000144 036003                    ADLQ    100,DU
         3 002006   200142 757100                    STAQ    PFIL_FPT,,AUTO

      862    13475    2       PFIL_FPT.V.DCB# = P_INFO.DCB#;

  13475  3 002007   200137 470500                    LDP0    @P_INFO,,AUTO
         3 002010   000003 720100                    LXL0    3,,PR0
         3 002011   200144 740100                    STX0    @P_WRITE_BUF_,,AUTO

      863    13476
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:152  
      864    13477    3       DO CASE ( P_DIRECTION );

  13477  3 002012   200140 471500                    LDP1    @P_DIRECTION,,AUTO
         3 002013   100000 235100                    LDA     0,,PR1
         3 002014   000003 115007                    CMPA    3,DL
         3 002015   002017 602005 3                  TNC     s:13477+5,AL
         3 002016   002030 710000 3                  TRA     s:13483
         3 002017   002030 710000 3                  TRA     s:13483
         3 002020   002022 710000 3                  TRA     s:13479
         3 002021   002025 710000 3                  TRA     s:13481

      865    13478    3       CASE ( %#PFIL_BOF );

      866    13479    3           PFIL_FPT.V.BOF# = %YES#;

  13479  3 002022   400000 236007                    LDQ     -131072,DL
         3 002023   200144 256100                    ORSQ    @P_WRITE_BUF_,,AUTO
         3 002024   002031 710000 3                  TRA     s:13486

      867    13480    3       CASE ( %#PFIL_EOF );

      868    13481    3           PFIL_FPT.V.BOF# = %NO#;

  13481  3 002025   000052 236000 4                  LDQ     42
         3 002026   200144 356100                    ANSQ    @P_WRITE_BUF_,,AUTO
         3 002027   002031 710000 3                  TRA     s:13486

      869    13482    3       CASE ( ELSE );

      870    13483    3           ALTRETURN;

  13483  3 002030   000000 702211                    TSX2  ! 0,X1

      871    13484    3           END;

      872    13485
      873    13486    2       IF P_INFO.FAST
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:153  

  13486  3 002031   000003 234100                    SZN     3,,PR0
         3 002032   002044 605000 3                  TPL     s:13491

      874    13487    3       THEN DO;

      875    13488    3           CALL XSA$PFIL( PFIL_FPT, P_INFO.XSA_PARAM$->XSA_PARAM ) ALTRET (
             13488                    BAD_FAST_PFIL );

  13488  3 002033   000000 473500                    LDP3    0,,PR0
         3 002034   200335 453500                    STP3    TEMP_CODE+3,,AUTO
         3 002035   200142 634500                    EPPR4   PFIL_FPT,,AUTO
         3 002036   200334 454500                    STP4    TEMP_CODE+2,,AUTO
         3 002037   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 002040   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 002041   000000 701000 xent               TSX1    XSA$PFIL
         3 002042   002061 702000 3                  TSX2    BAD_FAST_PFIL

      876    13489    3           END;

  13489  3 002043   002050 710000 3                  TRA     s:13494

      877    13490    3       ELSE DO;

      878    13491    3           CALL M$PFIL( PFIL_FPT ) ALTRET ( BAD_NORMAL_PFIL );

  13491  3 002044   200142 630500                    EPPR0   PFIL_FPT,,AUTO
         3 002045   440004 713400                    CLIMB   alt,+16388
         3 002046   400000 401760                    pmme    nvectors=1
         3 002047   002054 702000 3                  TSX2    BAD_NORMAL_PFIL

      879    13492    3           END;

      880    13493
      881    13494    2       P_INFO.RECORD_COUNT = 0;

  13494  3 002050   200137 470500                    LDP0    @P_INFO,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:154  
         3 002051   000001 450100                    STZ     1,,PR0

      882    13495
      883    13496    2       RETURN;

  13496  3 002052   200136 221300                    LDX1  ! WRITE_TEMP+2,,AUTO
         3 002053   000001 702211                    TSX2  ! 1,X1

  13494  3 002054                       BAD_NORMAL_* null
      884    13497
      885    13498    2   BAD_NORMAL_PFIL: ;
      886    13499    2       ERROR_CODE = #MONERR;

  13499  3 002054   000000 470400 xsym               LDP0    B$TCB$
         3 002055   000000 471500                    LDP1    0,,PR0
         3 002056   100102 236100                    LDQ     66,,PR1
         3 002057   200005 756100                    STQ     ERROR_CODE,,AUTO

      887    13500    2       GOTO BAD_PFIL;

  13500  3 002060   002065 710000 3                  TRA     BAD_PFIL

  13499  3 002061                       BAD_FAST_PF* null
      888    13501
      889    13502    2   BAD_FAST_PFIL: ;
      890    13503    2       ERROR_CODE = P_INFO.XSA_PARAM$ -> XSA_PARAM.ERR;

  13503  3 002061   200137 470500                    LDP0    @P_INFO,,AUTO
         3 002062   000000 471500                    LDP1    0,,PR0
         3 002063   100001 236100                    LDQ     1,,PR1
         3 002064   200005 756100                    STQ     ERROR_CODE,,AUTO

  13503  3 002065                       BAD_PFIL     null
      891    13504
      892    13505    2   BAD_PFIL: ;
      893    13506    2       ALTRETURN;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:155  
  13506  3 002065   200136 221300                    LDX1  ! WRITE_TEMP+2,,AUTO
         3 002066   000000 702211                    TSX2  ! 0,X1

      894    13507
      895    13508    2   END PFIL;
      896    13509
      897    13510        %PAGE( ARG=OPEN, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:156  
             13522    2   /*******************************************************************************
             13523    2   *                                                                              *
             13524    2   *        OPEN              OPEN                                                  *
             13525    2   *                                                                              *
             13526    2   *******************************************************************************/

      898    13530    1   OPEN: PROC( P_INFO, P_FPT$, P_OPEN_TYPE ) ALTRET;

  13530  3 002067   200136 741300       OPEN         STX1  ! WRITE_TEMP+2,,AUTO

      899    13531        /*N* Change OPEN so that the OPEN FPT can be set up globally and not
      900    13532             copied if not necessary */
      901    13533
      902    13534        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
      903    13568    2   DCL P_FPT$ PTR ALIGNED;
      904    13569    2   DCL P_OPEN_TYPE UBIN WORD ALIGNED;
      905    13570        %FPT_OPEN( FPTN=CONST_OPEN_FPT, STCLASS=CONSTANT );
      906    13679        %FPT_OPEN( FPTN=OPEN_FPT, STCLASS=" " );
      907    13788        %FPT_OPEN( FPTN=BASED_OPEN_FPT, STCLASS=BASED, PFMT="VECTOR" );
      908    13897        %FPT$OPEN_V( FPTN=BASED_OPEN_V );
      909    13912    2   DCL BUF_ VECTOR DALIGNED;
      910    13913    2   DCL PARAM$ PTR ALIGNED;
      911    13914    2   DCL ORG UBIN WORD;
      912    13915    2   DCL ALLOC_TYPE UBIN WORD ALIGNED;
      913    13916
      914    13917    2       IF ADDR(P_FPT$) = ADDR(NIL)

  13917  3 002070   200140 236100                    LDQ     @P_FPT$,,AUTO
         3 002071   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 002072   002077 601000 3                  TNZ     s:13922

      915    13918    3       THEN DO;

      916    13919    3           OPEN_FPT = CONST_OPEN_FPT;

  13919  3 002073   000100 100400                    MLR     fill='000'O
         3 002074   000234 000350 1                  ADSC9   CONST_OPEN_FPT           cn=0,n=232
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:157  
         3 002075   200142 000350                    ADSC9   OPEN_FPT,,AUTO           cn=0,n=232

      917    13920    3           END;

  13920  3 002076   002125 710000 3                  TRA     s:13932

      918    13921    3       ELSE DO;

      919    13922    3           IF P_FPT$ ~= ADDR(NIL)

  13922  3 002077   200140 470500                    LDP0    @P_FPT$,,AUTO
         3 002100   000000 236100                    LDQ     0,,PR0
         3 002101   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 002102   002115 600000 3                  TZE     s:13928

      920    13923    4           THEN DO;

      921    13924    4               OPEN_FPT = P_FPT$->BASED_OPEN_FPT;

  13924  3 002103   000000 471500                    LDP1    0,,PR0
         3 002104   000100 100500                    MLR     fill='000'O
         3 002105   100000 000350                    ADSC9   0,,PR1                   cn=0,n=232
         3 002106   200142 000350                    ADSC9   OPEN_FPT,,AUTO           cn=0,n=232

      922    13925    4               OPEN_FPT.V = VBASE(P_FPT$->BASED_OPEN_FPT.V_)->BASED_OPEN_V ;

  13925  3 002107   000000 471500                    LDP1    0,,PR0
         3 002110   100001 473500                    LDP3    1,,PR1
         3 002111   000100 100500                    MLR     fill='000'O
         3 002112   300000 000124                    ADSC9   0,,PR3                   cn=0,n=84
         3 002113   200206 000124                    ADSC9   WRITE_FPT+32,,AUTO       cn=0,n=84

      923    13926    4               END;

  13926  3 002114   002125 710000 3                  TRA     s:13932

      924    13927    4           ELSE DO;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:158  

      925    13928    4               CALL SET_XUU_ERR( %E$XUU#NIL_OPEN_FPT, %FALSE );

  13928  3 002115   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 002116   000010 235000 4                  LDA     8
         3 002117   200326 757100                    STAQ    @P_ERROR_NUM+1,,AUTO
         3 002120   000054 236000 4                  LDQ     44
         3 002121   200325 756100                    STQ     @P_PARAM$+2,,AUTO
         3 002122   003135 701000 3                  TSX1    SET_XUU_ERR
         3 002123   000000 011000                    NOP     0

      926    13929    4               GOTO BAD_OPEN;

  13929  3 002124   002351 710000 3                  TRA     BAD_OPEN

      927    13930    4               END;
      928    13931    3           END;
      929    13932    2       OPEN_FPT.V_ = VECTOR( OPEN_FPT.V );

  13932  3 002125   000055 235000 4                  LDA     45
         3 002126   200334 452500                    STP2    TEMP_CODE+2,,AUTO
         3 002127   200334 236100                    LDQ     TEMP_CODE+2,,AUTO
         3 002130   000206 036003                    ADLQ    134,DU
         3 002131   200142 757100                    STAQ    OPEN_FPT,,AUTO

      930    13933    2       OPEN_FPT.V.DCB# = P_INFO.DCB#;

  13933  3 002132   200137 470500                    LDP0    @P_INFO,,AUTO
         3 002133   000003 720100                    LXL0    3,,PR0
         3 002134   200206 740100                    STX0    WRITE_FPT+32,,AUTO

      931    13934    2       IF ADDR(P_OPEN_TYPE) ~= ADDR(NIL)

  13934  3 002135   200141 236100                    LDQ     @P_OPEN_TYPE,,AUTO
         3 002136   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 002137   002164 600000 3                  TZE     s:13948

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:159  
      932    13935    3       THEN DO;

      933    13936    4           DO CASE P_OPEN_TYPE;

  13936  3 002140   200141 471500                    LDP1    @P_OPEN_TYPE,,AUTO
         3 002141   100000 235100                    LDA     0,,PR1
         3 002142   000004 115007                    CMPA    4,DL
         3 002143   002145 602005 3                  TNC     s:13936+5,AL
         3 002144   002162 710000 3                  TRA     s:13944
         3 002145   002162 710000 3                  TRA     s:13944
         3 002146   002151 710000 3                  TRA     s:13938
         3 002147   002154 710000 3                  TRA     s:13940
         3 002150   002157 710000 3                  TRA     s:13942

      934    13937    4           CASE( %#OPEN_BASE );

      935    13938    4               ALLOC_TYPE = %XUU#N_PAGE_BASE;

  13938  3 002151   000001 235007                    LDA     1,DL
         3 002152   200240 755100                    STA     ALLOC_TYPE,,AUTO
         3 002153   002165 710000 3                  TRA     s:13951

      936    13939    4           CASE ( %#OPEN_UPDATE );

      937    13940    4               ALLOC_TYPE = %XUU#N_PAGE_UPDATE;

  13940  3 002154   000002 235007                    LDA     2,DL
         3 002155   200240 755100                    STA     ALLOC_TYPE,,AUTO
         3 002156   002165 710000 3                  TRA     s:13951

      938    13941    4           CASE ( %#OPEN_INCL );

      939    13942    4               ALLOC_TYPE = %XUU#N_PAGE_INCL;

  13942  3 002157   000003 235007                    LDA     3,DL
         3 002160   200240 755100                    STA     ALLOC_TYPE,,AUTO
         3 002161   002165 710000 3                  TRA     s:13951
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:160  

      940    13943    4           CASE ( ELSE );

      941    13944    4               ALLOC_TYPE = %XUU#ONE_PAGE;

  13944  3 002162   200240 450100                    STZ     ALLOC_TYPE,,AUTO

      942    13945    4               END;

      943    13946    3           END;

  13946  3 002163   002165 710000 3                  TRA     s:13951

      944    13947    3       ELSE DO;

      945    13948    3           ALLOC_TYPE = %XUU#ONE_PAGE;

  13948  3 002164   200240 450100                    STZ     ALLOC_TYPE,,AUTO

      946    13949    3           END;

      947    13950
      948    13951    2       IF P_INFO.FAST

  13951  3 002165   000003 234100                    SZN     3,,PR0
         3 002166   002203 605000 3                  TPL     s:13960

      949    13952    3       THEN DO;

      950    13953    3           CALL GET_XSA_PARAM( PARAM$ ) ALTRET ( BAD_GET );

  13953  3 002167   200236 631500                    EPPR1   PARAM$,,AUTO
         3 002170   200243 451500                    STP1    ALT_FLAG+1,,AUTO
         3 002171   002741 701000 3                  TSX1    GET_XSA_PARAM
         3 002172   002353 702000 3                  TSX2    BAD_GET

      951    13954    3           P_INFO.XSA_PARAM$ = PARAM$;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:161  

  13954  3 002173   200236 236100                    LDQ     PARAM$,,AUTO
         3 002174   200137 470500                    LDP0    @P_INFO,,AUTO
         3 002175   000000 756100                    STQ     0,,PR0

      952    13955    3           IF PARAM$ = ADDR(NIL)

  13955  3 002176   200236 236100                    LDQ     PARAM$,,AUTO
         3 002177   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 002200   002203 601000 3                  TNZ     s:13960

      953    13956    3           THEN
      954    13957    3               P_INFO.FAST = '0'B;

  13957  3 002201   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 002202   000003 356100                    ANSQ    3,,PR0

      955    13958    3           END;

      956    13959
      957    13960    2       IF NOT P_INFO.FAST

  13960  3 002203   000003 234100                    SZN     3,,PR0
         3 002204   002217 604000 3                  TMI     s:13966

      958    13961    3       THEN DO;

      959    13962    3           CALL M$OPEN( OPEN_FPT ) ALTRET ( BAD_NORMAL_OPEN );

  13962  3 002205   200142 630500                    EPPR0   OPEN_FPT,,AUTO
         3 002206   450000 713400                    CLIMB   alt,open
         3 002207   410400 401760                    pmme    nvectors=18
         3 002210   002332 702000 3                  TSX2    BAD_NORMAL_OPEN

      960    13963    3           ORG = P_INFO.DCB$->F$DCB.ORG#;

  13963  3 002211   200137 470500                    LDP0    @P_INFO,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:162  
         3 002212   000002 471500                    LDP1    2,,PR0
         3 002213   100032 236100                    LDQ     26,,PR1
         3 002214   000033 772000                    QRL     27
         3 002215   200237 756100                    STQ     ORG,,AUTO

      961    13964    3           END;

  13964  3 002216   002315 710000 3                  TRA     s:13993

      962    13965    3       ELSE DO;

      963    13966    3           CALL XSA$OPEN(OPEN_FPT, PARAM$->XSA_PARAM ) ALTRET ( BAD_FAST_OPEN );

  13966  3 002217   200236 236100                    LDQ     PARAM$,,AUTO
         3 002220   200335 756100                    STQ     TEMP_CODE+3,,AUTO
         3 002221   200142 631500                    EPPR1   OPEN_FPT,,AUTO
         3 002222   200334 451500                    STP1    TEMP_CODE+2,,AUTO
         3 002223   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 002224   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 002225   000000 701000 xent               TSX1    XSA$OPEN
         3 002226   002337 702000 3                  TSX2    BAD_FAST_OPEN

      964    13967    3           IF PARAM$ -> XSA_PARAM.ORG ~= 0

  13967  3 002227   200236 470500                    LDP0    PARAM$,,AUTO
         3 002230   000014 236100                    LDQ     12,,PR0
         3 002231   000777 316003                    CANQ    511,DU
         3 002232   002310 600000 3                  TZE     s:13989

      965    13968    4           THEN DO;

      966    13969    4               ORG = PARAM$ -> XSA_PARAM.ORG;

  13969  3 002233   000014 236100                    LDQ     12,,PR0
         3 002234   000022 772000                    QRL     18
         3 002235   000777 376007                    ANQ     511,DL
         3 002236   200237 756100                    STQ     ORG,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:163  

      967    13970    4               IF ORG ~= %KEYED#

  13970  3 002237   000002 116007                    CMPQ    2,DL
         3 002240   002242 600000 3                  TZE     s:13974

      968    13971    5               THEN DO;

      969    13972    5                   ALLOC_TYPE = %XUU#ONE_PAGE;

  13972  3 002241   200240 450100                    STZ     ALLOC_TYPE,,AUTO

      970    13973    5                   END;

      971    13974    4               CALL XUU_PARAM.ALLOCATE$$( BUF_, ALLOC_TYPE )

  13974  3 002242   200240 631500                    EPPR1   ALLOC_TYPE,,AUTO
         3 002243   200335 451500                    STP1    TEMP_CODE+3,,AUTO
         3 002244   200234 633500                    EPPR3   BUF_,,AUTO
         3 002245   200334 453500                    STP3    TEMP_CODE+2,,AUTO
         3 002246   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 002247   200003 474500                    LDP4    @XUU_PARAM,,AUTO
         3 002250   400006 220100                    LDX0    6,,PR4
         3 002251   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 002252   000000 701010                    TSX1    0,X0
         3 002253   002255 702000 3                  TSX2    s:13976
         3 002254   002257 710000 3                  TRA     s:13978

      972    13975    5               WHENALTRETURN DO;

      973    13976    5                   BUF_ = VECTOR(NIL);

  13976  3 002255   000026 237000 4                  LDAQ    22
         3 002256   200234 757100                    STAQ    BUF_,,AUTO

      974    13977    5                   END;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:164  
      975    13978    4               PARAM$ -> XSA_PARAM.BBUF_ = BUF_;

  13978  3 002257   200234 237100                    LDAQ    BUF_,,AUTO
         3 002260   200236 470500                    LDP0    PARAM$,,AUTO
         3 002261   000004 757100                    STAQ    4,,PR0

      976    13979    4               IF ( ORG = %KEYED# ) OR ( ORG = %INDEXED# )

  13979  3 002262   200237 235100                    LDA     ORG,,AUTO
         3 002263   000002 115007                    CMPA    2,DL
         3 002264   002267 600000 3                  TZE     s:13981
         3 002265   000006 115007                    CMPA    6,DL
         3 002266   002315 601000 3                  TNZ     s:13993

      977    13980    5               THEN DO;

      978    13981    5                   CALL XUU_PARAM.ALLOCATE$$( BUF_, %XUU#ONE_PAGE )

  13981  3 002267   000010 236000 4                  LDQ     8
         3 002270   200335 756100                    STQ     TEMP_CODE+3,,AUTO
         3 002271   200234 630500                    EPPR0   BUF_,,AUTO
         3 002272   200334 450500                    STP0    TEMP_CODE+2,,AUTO
         3 002273   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 002274   200003 471500                    LDP1    @XUU_PARAM,,AUTO
         3 002275   100006 220100                    LDX0    6,,PR1
         3 002276   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 002277   000000 701010                    TSX1    0,X0
         3 002300   002302 702000 3                  TSX2    s:13983
         3 002301   002304 710000 3                  TRA     s:13985

      979    13982    6                   WHENALTRETURN DO;

      980    13983    6                       BUF_ = VECTOR(NIL);

  13983  3 002302   000026 237000 4                  LDAQ    22
         3 002303   200234 757100                    STAQ    BUF_,,AUTO

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:165  
      981    13984    6                       END;

      982    13985    5                   PARAM$ -> XSA_PARAM.KBUF_ = BUF_;

  13985  3 002304   200234 237100                    LDAQ    BUF_,,AUTO
         3 002305   200236 470500                    LDP0    PARAM$,,AUTO
         3 002306   000002 757100                    STAQ    2,,PR0

      983    13986    5                   END;

      984    13987    4               END;

  13987  3 002307   002315 710000 3                  TRA     s:13993

      985    13988    4           ELSE DO;

      986    13989    4               ORG = P_INFO.DCB$->F$DCB.ORG#;

  13989  3 002310   200137 471500                    LDP1    @P_INFO,,AUTO
         3 002311   100002 473500                    LDP3    2,,PR1
         3 002312   300032 236100                    LDQ     26,,PR3
         3 002313   000033 772000                    QRL     27
         3 002314   200237 756100                    STQ     ORG,,AUTO

      987    13990    4               END;

      988    13991    3           END;

      989    13992
      990    13993    2       IF ORG = %KEYED#

  13993  3 002315   200237 235100                    LDA     ORG,,AUTO
         3 002316   000002 115007                    CMPA    2,DL
         3 002317   002324 601000 3                  TNZ     s:13998

      991    13994    3       THEN DO;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:166  
      992    13995    3           P_INFO.KEY_TYPE = %#EDIT_KEY;

  13995  3 002320   200137 470500                    LDP0    @P_INFO,,AUTO
         3 002321   000001 236003                    LDQ     1,DU
         3 002322   000003 552120                    STBQ    3,'20'O,PR0

      993    13996    3           END;

  13996  3 002323   002327 710000 3                  TRA     s:14001

      994    13997    3       ELSE DO;

      995    13998    3           P_INFO.KEY_TYPE = %#CONSEC;

  13998  3 002324   200137 470500                    LDP0    @P_INFO,,AUTO
         3 002325   000002 236003                    LDQ     2,DU
         3 002326   000003 552120                    STBQ    3,'20'O,PR0

      996    13999    3           END;

      997    14000
      998    14001    2       P_INFO.RECORD_COUNT = 0;

  14001  3 002327   000001 450100                    STZ     1,,PR0

      999    14002
     1000    14003    2       RETURN;

  14003  3 002330   200136 221300                    LDX1  ! WRITE_TEMP+2,,AUTO
         3 002331   000001 702211                    TSX2  ! 1,X1

  14001  3 002332                       BAD_NORMAL_* null
     1001    14004
     1002    14005    2   BAD_NORMAL_OPEN: ;
     1003    14006    2       ERROR_CODE = #MONERR;

  14006  3 002332   000000 470400 xsym               LDP0    B$TCB$
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:167  
         3 002333   000000 471500                    LDP1    0,,PR0
         3 002334   100102 236100                    LDQ     66,,PR1
         3 002335   200005 756100                    STQ     ERROR_CODE,,AUTO

     1004    14007    2       GOTO BAD_OPEN;

  14007  3 002336   002351 710000 3                  TRA     BAD_OPEN

  14006  3 002337                       BAD_FAST_OP* null
     1005    14008
     1006    14009    2   BAD_FAST_OPEN: ;
     1007    14010    2       ERROR_CODE = PARAM$ -> XSA_PARAM.ERR;

  14010  3 002337   200236 470500                    LDP0    PARAM$,,AUTO
         3 002340   000001 236100                    LDQ     1,,PR0
         3 002341   200005 756100                    STQ     ERROR_CODE,,AUTO

     1008    14011    2       CALL RELEASE_XSA_PARAM( PARAM$ );

  14011  3 002342   200236 631500                    EPPR1   PARAM$,,AUTO
         3 002343   200323 451500                    STP1    CLOSE_ERR+2,,AUTO
         3 002344   003030 701000 3                  TSX1    RELEASE_XSA_PARAM
         3 002345   000000 011000                    NOP     0

     1009    14012    2       P_INFO.XSA_PARAM$ = ADDR(NIL);

  14012  3 002346   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 002347   200137 470500                    LDP0    @P_INFO,,AUTO
         3 002350   000000 756100                    STQ     0,,PR0

  14012  3 002351                       BAD_OPEN     null
     1010    14013
     1011    14014    2   BAD_OPEN: ;
     1012    14015    2       ALTRETURN;

  14015  3 002351   200136 221300                    LDX1  ! WRITE_TEMP+2,,AUTO
         3 002352   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:168  

  14012  3 002353                       BAD_GET      null
     1013    14016
     1014    14017    2   BAD_GET: ;
     1015    14018    2       ALTRETURN;

  14018  3 002353   200136 221300                    LDX1  ! WRITE_TEMP+2,,AUTO
         3 002354   000000 702211                    TSX2  ! 0,X1

     1016    14019
     1017    14020    2   END OPEN;
     1018    14021
     1019    14022        %PAGE( ARG=CLOSE, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:169  
             14034    2   /*******************************************************************************
             14035    2   *                                                                              *
             14036    2   *        CLOSE              CLOSE                                                 *
             14037    2   *                                                                              *
             14038    2   *******************************************************************************/

     1020    14042    1   CLOSE: PROC( P_INFO ) ALTRET;

  14042  3 002355   200260 741300       CLOSE        STX1  ! @P_PASS_BUF+1,,AUTO

     1021    14043
     1022    14044        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
     1023    14078        %FPT_CLOSE( FPTN=CONST_CLOSE_FPT, STCLASS=CONSTANT, DISP=SAVE );
     1024    14120        %FPT_CLOSE( FPTN=CLOSE_FPT, STCLASS=" " );
     1025    14162    2   DCL PARAM$ PTR ALIGNED;
     1026    14163    2   DCL CLOSE_ERR BIT(1) ALIGNED;
     1027    14164
     1028    14165    2       CLOSE_ERR = %FALSE;

  14165  3 002356   200321 450100                    STZ     CLOSE_ERR,,AUTO

     1029    14166
     1030    14167    2       IF P_INFO.DCB# ~= DCBNUM(NIL)

  14167  3 002357   200261 470500                    LDP0    @P_INFO,,AUTO
         3 002360   000003 720100                    LXL0    3,,PR0
         3 002361   002505 600000 3                  TZE     s:14209

     1031    14168    3       THEN DO;

     1032    14169    3           CLOSE_FPT = CONST_CLOSE_FPT;

  14169  3 002362   000100 100400                    MLR     fill='000'O
         3 002363   000326 000170 1                  ADSC9   CONST_CLOSE_FPT          cn=0,n=120
         3 002364   200262 000170                    ADSC9   CLOSE_FPT,,AUTO          cn=0,n=120

     1033    14170    3           CLOSE_FPT.V_ = VECTOR( CLOSE_FPT.V );
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:170  

  14170  3 002365   000050 235000 4                  LDA     40
         3 002366   200334 452500                    STP2    TEMP_CODE+2,,AUTO
         3 002367   200334 236100                    LDQ     TEMP_CODE+2,,AUTO
         3 002370   000314 036003                    ADLQ    204,DU
         3 002371   200262 757100                    STAQ    CLOSE_FPT,,AUTO

     1034    14171    3           CLOSE_FPT.V.DCB# = P_INFO.DCB#;

  14171  3 002372   000003 720100                    LXL0    3,,PR0
         3 002373   200314 740100                    STX0    RELDCB_FPT+26,,AUTO

     1035    14172    3           IF ( P_INFO.DCB$->F$DCB.FCD# )

  14172  3 002374   000002 471500                    LDP1    2,,PR0
         3 002375   100031 236100                    LDQ     25,,PR1
         3 002376   020000 316007                    CANQ    8192,DL
         3 002377   002434 600000 3                  TZE     s:14190

     1036    14173    4           THEN DO;

     1037    14174    4               IF NOT P_INFO.FAST

  14174  3 002400   000003 234100                    SZN     3,,PR0
         3 002401   002416 604000 3                  TMI     s:14183

     1038    14175    5               THEN DO;

     1039    14176    5                   CALL M$CLOSE( CLOSE_FPT )

  14176  3 002402   200262 630500                    EPPR0   CLOSE_FPT,,AUTO
         3 002403   450001 713400                    CLIMB   alt,close
         3 002404   406000 401760                    pmme    nvectors=13
         3 002405   002407 702000 3                  TSX2    s:14178
         3 002406   002415 710000 3                  TRA     s:14181

     1040    14177    6                   WHENALTRETURN DO;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:171  

     1041    14178    6                       CLOSE_ERR = %TRUE;

  14178  3 002407   400000 236003                    LDQ     -131072,DU
         3 002410   200321 756100                    STQ     CLOSE_ERR,,AUTO

     1042    14179    6                       ERROR_CODE = #MONERR;

  14179  3 002411   000000 470400 xsym               LDP0    B$TCB$
         3 002412   000000 471500                    LDP1    0,,PR0
         3 002413   100102 236100                    LDQ     66,,PR1
         3 002414   200005 756100                    STQ     ERROR_CODE,,AUTO

     1043    14180    6                       END;

     1044    14181    5                   END;

  14181  3 002415   002434 710000 3                  TRA     s:14190

     1045    14182    5               ELSE DO;

     1046    14183    5                   CALL XSA$CLOSE( CLOSE_FPT, P_INFO.XSA_PARAM$->XSA_PARAM )

  14183  3 002416   000000 473500                    LDP3    0,,PR0
         3 002417   200335 453500                    STP3    TEMP_CODE+3,,AUTO
         3 002420   200262 631500                    EPPR1   CLOSE_FPT,,AUTO
         3 002421   200334 451500                    STP1    TEMP_CODE+2,,AUTO
         3 002422   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 002423   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 002424   000000 701000 xent               TSX1    XSA$CLOSE
         3 002425   002427 702000 3                  TSX2    s:14185
         3 002426   002434 710000 3                  TRA     s:14190

     1047    14184    6                   WHENALTRETURN DO;

     1048    14185    6                       CLOSE_ERR = %TRUE;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:172  
  14185  3 002427   400000 236003                    LDQ     -131072,DU
         3 002430   200321 756100                    STQ     CLOSE_ERR,,AUTO

     1049    14186    6                       ERROR_CODE = PARAM$ -> XSA_PARAM.ERR;

  14186  3 002431   200320 470500                    LDP0    PARAM$,,AUTO
         3 002432   000001 236100                    LDQ     1,,PR0
         3 002433   200005 756100                    STQ     ERROR_CODE,,AUTO

     1050    14187    6                       END;

     1051    14188    5                   END;

     1052    14189    4               END;

     1053    14190    3           IF P_INFO.XSA_PARAM$ ~= ADDR(NIL)

  14190  3 002434   200261 470500                    LDP0    @P_INFO,,AUTO
         3 002435   000000 236100                    LDQ     0,,PR0
         3 002436   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 002437   002505 600000 3                  TZE     s:14209

     1054    14191    4           THEN DO;

     1055    14192    4               PARAM$ = P_INFO.XSA_PARAM$;

  14192  3 002440   200320 756100                    STQ     PARAM$,,AUTO

     1056    14193    4               IF PARAM$ -> XSA_PARAM.KBUF_ ~= VECTOR(NIL)

  14193  3 002441   200320 471500                    LDP1    PARAM$,,AUTO
         3 002442   100002 237100                    LDAQ    2,,PR1
         3 002443   000026 117000 4                  CMPAQ   22
         3 002444   002456 600000 3                  TZE     s:14197

     1057    14194    5               THEN DO;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:173  
     1058    14195    5                   CALL XUU_PARAM.RELEASE$$( PARAM$->XSA_PARAM.KBUF_ );

  14195  3 002445   200320 236100                    LDQ     PARAM$,,AUTO
         3 002446   000002 036003                    ADLQ    2,DU
         3 002447   200334 756100                    STQ     TEMP_CODE+2,,AUTO
         3 002450   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 002451   200003 473500                    LDP3    @XUU_PARAM,,AUTO
         3 002452   300007 220100                    LDX0    7,,PR3
         3 002453   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002454   000000 701010                    TSX1    0,X0
         3 002455   000000 011000                    NOP     0

     1059    14196    5                   END;

     1060    14197    4               IF PARAM$->XSA_PARAM.BBUF_ ~= VECTOR(NIL)

  14197  3 002456   200320 470500                    LDP0    PARAM$,,AUTO
         3 002457   000004 237100                    LDAQ    4,,PR0
         3 002460   000026 117000 4                  CMPAQ   22
         3 002461   002473 600000 3                  TZE     s:14201

     1061    14198    5               THEN DO;

     1062    14199    5                   CALL XUU_PARAM.RELEASE$$( PARAM$->XSA_PARAM.BBUF_ );

  14199  3 002462   200320 236100                    LDQ     PARAM$,,AUTO
         3 002463   000004 036003                    ADLQ    4,DU
         3 002464   200334 756100                    STQ     TEMP_CODE+2,,AUTO
         3 002465   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 002466   200003 471500                    LDP1    @XUU_PARAM,,AUTO
         3 002467   100007 220100                    LDX0    7,,PR1
         3 002470   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002471   000000 701010                    TSX1    0,X0
         3 002472   000000 011000                    NOP     0

     1063    14200    5                   END;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:174  
     1064    14201    4               CALL RELEASE_XSA_PARAM( PARAM$ )

  14201  3 002473   200320 630500                    EPPR0   PARAM$,,AUTO
         3 002474   200323 450500                    STP0    CLOSE_ERR+2,,AUTO
         3 002475   003030 701000 3                  TSX1    RELEASE_XSA_PARAM
         3 002476   002500 702000 3                  TSX2    s:14203
         3 002477   002502 710000 3                  TRA     s:14205

     1065    14202    5               WHENALTRETURN DO;

     1066    14203    5                   CLOSE_ERR = %TRUE;

  14203  3 002500   400000 236003                    LDQ     -131072,DU
         3 002501   200321 756100                    STQ     CLOSE_ERR,,AUTO

     1067    14204    5                   END;

     1068    14205    4               P_INFO.XSA_PARAM$ = ADDR(NIL);

  14205  3 002502   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 002503   200261 470500                    LDP0    @P_INFO,,AUTO
         3 002504   000000 756100                    STQ     0,,PR0

     1069    14206    4               END;

     1070    14207    3           END;

     1071    14208
     1072    14209    2       IF CLOSE_ERR

  14209  3 002505   200321 234100                    SZN     CLOSE_ERR,,AUTO
         3 002506   002511 605000 3                  TPL     s:14211

     1073    14210    2       THEN ALTRETURN;

  14210  3 002507   200260 221300                    LDX1  ! @P_PASS_BUF+1,,AUTO
         3 002510   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:175  

     1074    14211    2       ELSE RETURN;

  14211  3 002511   200260 221300                    LDX1  ! @P_PASS_BUF+1,,AUTO
         3 002512   000001 702211                    TSX2  ! 1,X1

     1075    14212    2   END CLOSE;
     1076    14213
     1077    14214        %PAGE( ARG=PRECORD, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:176  
             14226    2   /*******************************************************************************
             14227    2   *                                                                              *
             14228    2   *        PRECORD              PRECORD                                             *
             14229    2   *                                                                              *
             14230    2   *******************************************************************************/

     1078    14234    1   PRECORD: PROC( P_INFO, P_COUNT ) ALTRET;

  14234  3 002513   200020 741300       PRECORD      STX1  ! USER_BUF$+2,,AUTO

     1079    14235
     1080    14236        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
     1081    14270    2   DCL P_COUNT SBIN WORD ALIGNED;
     1082    14271        %FPT_PRECORD( FPTN=CONST_PRECORD_FPT, STCLASS=CONSTANT, KEYR=NO, KEYS=NO );
     1083    14292        %FPT_PRECORD( FPTN=PRECORD_FPT, STCLASS=" " );
     1084    14313
     1085    14314    2       EOF = %FALSE;

  14314  3 002514   200007 450100                    STZ     EOF,,AUTO

     1086    14315    2       PRECORD_FPT = CONST_PRECORD_FPT;

  14315  3 002515   000100 100400                    MLR     fill='000'O
         3 002516   000364 000050 1                  ADSC9   CONST_PRECORD_FPT        cn=0,n=40
         3 002517   200024 000050                    ADSC9   PRECORD_FPT,,AUTO        cn=0,n=40

     1087    14316    2       PRECORD_FPT.V_ = VECTOR( PRECORD_FPT.V );

  14316  3 002520   000050 235000 4                  LDA     40
         3 002521   200334 452500                    STP2    TEMP_CODE+2,,AUTO
         3 002522   200334 236100                    LDQ     TEMP_CODE+2,,AUTO
         3 002523   000032 036003                    ADLQ    26,DU
         3 002524   200024 757100                    STAQ    PRECORD_FPT,,AUTO

     1088    14317    2       PRECORD_FPT.V.N# = P_COUNT;

  14317  3 002525   200022 470500                    LDP0    @P_COUNT,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:177  
         3 002526   000000 235100                    LDA     0,,PR0
         3 002527   200033 755100                    STA     @P_PASS_BUF+1,,AUTO

     1089    14318    2       PRECORD_FPT.V.DCB# = P_INFO.DCB#;

  14318  3 002530   200021 471500                    LDP1    @P_INFO,,AUTO
         3 002531   100003 720100                    LXL0    3,,PR1
         3 002532   200032 740100                    STX0    @P_ERROR_NUM+1,,AUTO

     1090    14319
     1091    14320    2       IF P_INFO.FAST

  14320  3 002533   100003 234100                    SZN     3,,PR1
         3 002534   002546 605000 3                  TPL     s:14326

     1092    14321    3       THEN DO;

     1093    14322    3           CALL XSA$PRECORD( PRECORD_FPT, P_INFO.XSA_PARAM$->XSA_PARAM )

  14322  3 002535   100000 473500                    LDP3    0,,PR1
         3 002536   200335 453500                    STP3    TEMP_CODE+3,,AUTO
         3 002537   200024 634500                    EPPR4   PRECORD_FPT,,AUTO
         3 002540   200334 454500                    STP4    TEMP_CODE+2,,AUTO
         3 002541   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 002542   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 002543   000000 701000 xent               TSX1    XSA$PRECORD
         3 002544   002566 702000 3                  TSX2    BAD_FAST_PRECORD

     1094    14323    3              ALTRET ( BAD_FAST_PRECORD );
     1095    14324    3           END;

  14324  3 002545   002552 710000 3                  TRA     s:14329

     1096    14325    3       ELSE DO;

     1097    14326    3           CALL M$PRECORD( PRECORD_FPT ) ALTRET ( BAD_NORMAL_PRECORD );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:178  
  14326  3 002546   200024 630500                    EPPR0   PRECORD_FPT,,AUTO
         3 002547   440003 713400                    CLIMB   alt,+16387
         3 002550   401000 401760                    pmme    nvectors=3
         3 002551   002561 702000 3                  TSX2    BAD_NORMAL_PRECORD

     1098    14327    3           END;

     1099    14328
     1100    14329    2       P_INFO.RECORD_COUNT = P_INFO.RECORD_COUNT + P_COUNT;

  14329  3 002552   200021 470500                    LDP0    @P_INFO,,AUTO
         3 002553   200022 471500                    LDP1    @P_COUNT,,AUTO
         3 002554   000001 236100                    LDQ     1,,PR0
         3 002555   100000 036100                    ADLQ    0,,PR1
         3 002556   000001 756100                    STQ     1,,PR0

     1101    14330
     1102    14331    2       RETURN;

  14331  3 002557   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 002560   000001 702211                    TSX2  ! 1,X1

  14329  3 002561                       BAD_NORMAL_* null
     1103    14332
     1104    14333    2   BAD_NORMAL_PRECORD: ;
     1105    14334    2       ERROR_CODE = #MONERR;

  14334  3 002561   000000 470400 xsym               LDP0    B$TCB$
         3 002562   000000 471500                    LDP1    0,,PR0
         3 002563   100102 236100                    LDQ     66,,PR1
         3 002564   200005 756100                    STQ     ERROR_CODE,,AUTO

     1106    14335    2       GOTO BAD_PRECORD;

  14335  3 002565   002572 710000 3                  TRA     BAD_PRECORD

  14334  3 002566                       BAD_FAST_PR* null
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:179  
     1107    14336
     1108    14337    2   BAD_FAST_PRECORD: ;
     1109    14338    2       ERROR_CODE = P_INFO.XSA_PARAM$ -> XSA_PARAM.ERR;

  14338  3 002566   200021 470500                    LDP0    @P_INFO,,AUTO
         3 002567   000000 471500                    LDP1    0,,PR0
         3 002570   100001 236100                    LDQ     1,,PR1
         3 002571   200005 756100                    STQ     ERROR_CODE,,AUTO

  14338  3 002572                       BAD_PRECORD  null
     1110    14339
     1111    14340    2   BAD_PRECORD: ;
     1112    14341    2       EOF = ( ERROR_CODE.ERR# = %E$EOF );

  14341  3 002572   400000 220003                    LDX0    -131072,DU
         3 002573   200005 236100                    LDQ     ERROR_CODE,,AUTO
         3 002574   377770 376007                    ANQ     131064,DL
         3 002575   000060 116007                    CMPQ    48,DL
         3 002576   002600 600000 3                  TZE     BAD_PRECORD+6
         3 002577   000000 220003                    LDX0    0,DU
         3 002600   000000 636010                    EAQ     0,X0
         3 002601   200007 756100                    STQ     EOF,,AUTO

     1113    14342    2       ALTRETURN;

  14342  3 002602   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 002603   000000 702211                    TSX2  ! 0,X1

     1114    14343
     1115    14344    2   END PRECORD;
     1116    14345
     1117    14346        %PAGE( ARG=GETDCB, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:180  
             14358    2   /*******************************************************************************
             14359    2   *                                                                              *
             14360    2   *        GETDCB              GETDCB                                               *
             14361    2   *                                                                              *
             14362    2   *******************************************************************************/

     1118    14366    1   GETDCB: PROC( P_INFO, P_DCB_NAME ) ALTRET;

  14366  3 002604   200136 741300       GETDCB       STX1  ! WRITE_TEMP+2,,AUTO

     1119    14367
     1120    14368        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
     1121    14402        %VLP_NAMEV( FPTN=P_DCB_NAME, STCLASS="ALIGNED" );
     1122    14409        %FPT_GETDCB( FPTN=CONST_GETDCB_FPT, STCLASS=CONSTANT );
     1123    14424        %FPT_GETDCB( FPTN=GETDCB_FPT, STCLASS=" " );
     1124    14439
     1125    14440    2       IF P_INFO.DCB# = DCBNUM( NIL )

  14440  3 002605   200137 470500                    LDP0    @P_INFO,,AUTO
         3 002606   000003 720100                    LXL0    3,,PR0
         3 002607   002651 601000 3                  TNZ     s:14457

     1126    14441    3       THEN DO;

     1127    14442    3           GETDCB_FPT = CONST_GETDCB_FPT;

  14442  3 002610   000100 100400                    MLR     fill='000'O
         3 002611   000376 000040 1                  ADSC9   CONST_GETDCB_FPT         cn=0,n=32
         3 002612   200142 000040                    ADSC9   GETDCB_FPT,,AUTO         cn=0,n=32

     1128    14443    3           GETDCB_FPT.V_ = VECTOR( GETDCB_FPT.V );

  14443  3 002613   000051 235000 4                  LDA     41
         3 002614   200334 452500                    STP2    TEMP_CODE+2,,AUTO
         3 002615   200334 236100                    LDQ     TEMP_CODE+2,,AUTO
         3 002616   000150 036003                    ADLQ    104,DU
         3 002617   200142 757100                    STAQ    GETDCB_FPT,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:181  

     1129    14444    3           GETDCB_FPT.DCBNUM_ = VECTOR( P_INFO.DCB# );

  14444  3 002620   377640 235007                    LDA     130976,DL
         3 002621   200137 236100                    LDQ     @P_INFO,,AUTO
         3 002622   000056 036000 4                  ADLQ    46
         3 002623   200146 757100                    STAQ    WRITE_FPT,,AUTO

     1130    14445    3           IF ADDR( P_DCB_NAME ) ~= ADDR(NIL)

  14445  3 002624   200140 236100                    LDQ     @P_DCB_NAME,,AUTO
         3 002625   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 002626   002643 600000 3                  TZE     s:14451

     1131    14446    4           THEN DO;

     1132    14447    4               P_INFO.TEMP_DCB = %FALSE;

  14447  3 002627   000057 236000 4                  LDQ     47
         3 002630   000003 356100                    ANSQ    3,,PR0

     1133    14448    4               GETDCB_FPT.DCBNAME_ = VECTOR( P_DCB_NAME );

  14448  3 002631   200140 471500                    LDP1    @P_DCB_NAME,,AUTO
         3 002632   100000 236100                    LDQ     0,,PR1
         3 002633   000033 772000                    QRL     27
         3 002634   000001 620006                    EAX0    1,QL
         3 002635   000000 635010                    EAA     0,X0
         3 002636   000002 771000                    ARL     2
         3 002637   000140 135007                    SBLA    96,DL
         3 002640   200140 236100                    LDQ     @P_DCB_NAME,,AUTO
         3 002641   200144 757100                    STAQ    @P_WRITE_BUF_,,AUTO

     1134    14449    4               END;

  14449  3 002642   002645 710000 3                  TRA     s:14453

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:182  
     1135    14450    4           ELSE DO;

     1136    14451    4               P_INFO.TEMP_DCB = %TRUE;

  14451  3 002643   200000 236003                    LDQ     65536,DU
         3 002644   000003 256100                    ORSQ    3,,PR0

     1137    14452    4               END;

     1138    14453    3           CALL M$GETDCB( GETDCB_FPT ) ALTRET ( BAD_GETDCB );

  14453  3 002645   200142 630500                    EPPR0   GETDCB_FPT,,AUTO
         3 002646   460002 713400                    CLIMB   alt,+24578
         3 002647   401000 401760                    pmme    nvectors=3
         3 002650   002661 702000 3                  TSX2    BAD_GETDCB

     1139    14454        /*N* If M$GETDCB allocated this dcb, set P_INFO.TEMP_DCB  See star#7900 */
     1140    14455    3           END;

     1141    14456
     1142    14457    2       P_INFO.DCB$ = DCBADDR( P_INFO.DCB# );

  14457  3 002651   000023 470400 4                  LDP0    19
         3 002652   000000 471500                    LDP1    0,,PR0
         3 002653   200137 473500                    LDP3    @P_INFO,,AUTO
         3 002654   300003 720100                    LXL0    3,,PR3
         3 002655   100000 236110                    LDQ     0,X0,PR1
         3 002656   300002 756100                    STQ     2,,PR3

     1143    14458
     1144    14459    2       RETURN;

  14459  3 002657   200136 221300                    LDX1  ! WRITE_TEMP+2,,AUTO
         3 002660   000001 702211                    TSX2  ! 1,X1

  14457  3 002661                       BAD_GETDCB   null
     1145    14460
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:183  
     1146    14461    2   BAD_GETDCB: ;
     1147    14462    2       P_INFO.DCB# = DCBNUM(NIL);

  14462  3 002661   000000 220003                    LDX0    0,DU
         3 002662   200137 470500                    LDP0    @P_INFO,,AUTO
         3 002663   000003 440100                    SXL0    3,,PR0

     1148    14463    2       ERROR_CODE = #MONERR;

  14463  3 002664   000000 471400 xsym               LDP1    B$TCB$
         3 002665   100000 473500                    LDP3    0,,PR1
         3 002666   300102 236100                    LDQ     66,,PR3
         3 002667   200005 756100                    STQ     ERROR_CODE,,AUTO

     1149    14464    2       ALTRETURN;

  14464  3 002670   200136 221300                    LDX1  ! WRITE_TEMP+2,,AUTO
         3 002671   000000 702211                    TSX2  ! 0,X1

     1150    14465
     1151    14466    2   END GETDCB;
     1152    14467
     1153    14468        %PAGE( ARG=RELDCB, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:184  
             14480    2   /*******************************************************************************
             14481    2   *                                                                              *
             14482    2   *        RELDCB              RELDCB                                               *
             14483    2   *                                                                              *
             14484    2   *******************************************************************************/

     1154    14488    1   RELDCB: PROC( P_INFO ) ALTRET;

  14488  3 002672   200260 741300       RELDCB       STX1  ! @P_PASS_BUF+1,,AUTO

     1155    14489
     1156    14490        %FILE_INFO( NAME=P_INFO, STCLASS=" " );
     1157    14524        %FPT_RELDCB( FPTN=CONST_RELDCB_FPT, STCLASS=CONSTANT );
     1158    14538        %FPT_RELDCB( FPTN=RELDCB_FPT, STCLASS=" " );
     1159    14552
     1160    14553    2       IF P_INFO.TEMP_DCB AND

  14553  3 002673   200261 470500                    LDP0    @P_INFO,,AUTO
         3 002674   000003 236100                    LDQ     3,,PR0
         3 002675   200000 316003                    CANQ    65536,DU
         3 002676   002725 600000 3                  TZE     s:14563
         3 002677   000003 720100                    LXL0    3,,PR0
         3 002700   002725 600000 3                  TZE     s:14563
         3 002701   200014 234100                    SZN     ERROR_SET,,AUTO
         3 002702   002707 605000 3                  TPL     s:14557
         3 002703   200003 471500                    LDP1    @XUU_PARAM,,AUTO
         3 002704   100005 676100                    ERQ     5,,PR1
         3 002705   777777 376007                    ANQ     -1,DL
         3 002706   002725 600000 3                  TZE     s:14563

     1161    14554    2          P_INFO.DCB# ~= DCBNUM( NIL ) AND
     1162    14555    2          NOT ( ERROR_SET AND P_INFO.DCB# = XUU_PARAM.DCB# )
     1163    14556    3       THEN DO;

     1164    14557    3           RELDCB_FPT = CONST_RELDCB_FPT;

  14557  3 002707   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:185  
         3 002710   000406 000020 1                  ADSC9   CONST_RELDCB_FPT         cn=0,n=16
         3 002711   200262 000020                    ADSC9   RELDCB_FPT,,AUTO         cn=0,n=16

     1165    14558    3           RELDCB_FPT.V_ = VECTOR( RELDCB_FPT.V );

  14558  3 002712   000051 235000 4                  LDA     41
         3 002713   200334 452500                    STP2    TEMP_CODE+2,,AUTO
         3 002714   200334 236100                    LDQ     TEMP_CODE+2,,AUTO
         3 002715   000264 036003                    ADLQ    180,DU
         3 002716   200262 757100                    STAQ    RELDCB_FPT,,AUTO

     1166    14559    3           RELDCB_FPT.V.DCB# = P_INFO.DCB#;

  14559  3 002717   000003 720100                    LXL0    3,,PR0
         3 002720   200264 740100                    STX0    RELDCB_FPT+2,,AUTO

     1167    14560    3           CALL M$RELDCB( RELDCB_FPT ) ALTRET ( BAD_RELDCB );

  14560  3 002721   200262 630500                    EPPR0   RELDCB_FPT,,AUTO
         3 002722   460003 713400                    CLIMB   alt,+24579
         3 002723   400000 401760                    pmme    nvectors=1
         3 002724   002733 702000 3                  TSX2    BAD_RELDCB

     1168    14561    3           END;

     1169    14562
     1170    14563    2       P_INFO = FILE_INFO_BASE;

  14563  3 002725   200261 470500                    LDP0    @P_INFO,,AUTO
         3 002726   000100 100400                    MLR     fill='000'O
         3 002727   000005 000020 1                  ADSC9   FILE_INFO_BASE           cn=0,n=16
         3 002730   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

     1171    14564    2       RETURN;

  14564  3 002731   200260 221300                    LDX1  ! @P_PASS_BUF+1,,AUTO
         3 002732   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:186  

  14563  3 002733                       BAD_RELDCB   null
     1172    14565
     1173    14566    2   BAD_RELDCB: ;
     1174    14567    2       ERROR_CODE = #MONERR;

  14567  3 002733   000000 470400 xsym               LDP0    B$TCB$
         3 002734   000000 471500                    LDP1    0,,PR0
         3 002735   100102 236100                    LDQ     66,,PR1
         3 002736   200005 756100                    STQ     ERROR_CODE,,AUTO

     1175    14568    2       ALTRETURN;

  14568  3 002737   200260 221300                    LDX1  ! @P_PASS_BUF+1,,AUTO
         3 002740   000000 702211                    TSX2  ! 0,X1

     1176    14569
     1177    14570    2   END RELDCB;
     1178    14571
     1179    14572        %PAGE( ARG=GET_XSA_PARAM, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:187  
             14584    2   /*******************************************************************************
             14585    2   *                                                                              *
             14586    2   *        GET_XSA_PARAM              GET_XSA_PARAM                                 *
             14587    2   *                                                                              *
             14588    2   *******************************************************************************/

     1180    14592    1   GET_XSA_PARAM: PROC( P_PARAM$ ) ALTRET;

  14592  3 002741   200242 741300       GET_XSA_PAR* STX1  ! ALT_FLAG,,AUTO

     1181    14593
     1182    14594    2   DCL P_PARAM$ PTR ALIGNED;
     1183    14595        %XSA_PARAM( FPTN=CONST_XSA_PARAM, STCLASS=CONSTANT, BBUF=NIL, KBUF=NIL );
     1184    14625
     1185    14626    2       IF XSA_PARAM_POOL_ = VECTOR(NIL)

  14626  3 002742   000016 237000 2                  LDAQ    XSA_PARAM_POOL_
         3 002743   000026 117000 4                  CMPAQ   22
         3 002744   002765 601000 3                  TNZ     s:14637

     1186    14627    3       THEN DO;

     1187    14628    3           CALL XUU_PARAM.ALLOCATE$$( XSA_PARAM_POOL_, %XUU#ONE_PAGE )

  14628  3 002745   000060 630400 4                  EPPR0   48
         3 002746   200003 471500                    LDP1    @XUU_PARAM,,AUTO
         3 002747   100006 220100                    LDX0    6,,PR1
         3 002750   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 002751   000000 701010                    TSX1    0,X0
         3 002752   002754 702000 3                  TSX2    s:14630
         3 002753   002763 710000 3                  TRA     s:14634

     1188    14629    4           WHENALTRETURN DO;

     1189    14630    4               XSA_PARAM_POOL_ = VECTOR( NIL );

  14630  3 002754   000026 237000 4                  LDAQ    22
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:188  
         3 002755   000016 757000 2                  STAQ    XSA_PARAM_POOL_

     1190    14631    4               P_PARAM$ = ADDR(NIL);

  14631  3 002756   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 002757   200243 470500                    LDP0    @P_PARAM$,,AUTO
         3 002760   000000 756100                    STQ     0,,PR0

     1191    14632    4               RETURN;

  14632  3 002761   200242 221300                    LDX1  ! ALT_FLAG,,AUTO
         3 002762   000001 702211                    TSX2  ! 1,X1

     1192    14633    4               END;
     1193    14634    3           XSA_PARAM_POOL_NEXT$ = VBASE(XSA_PARAM_POOL_);

  14634  3 002763   000017 236000 2                  LDQ     XSA_PARAM_POOL_+1
         3 002764   000020 756000 2                  STQ     XSA_PARAM_POOL_NEXT$

     1194    14635    3           END;

     1195    14636
     1196    14637    2       IF ( POFFC( XSA_PARAM_POOL_NEXT$, VBASE(XSA_PARAM_POOL_) ) + SIZEC( XSA_PARAM )
             14637                )

  14637  3 002765   000017 236000 2                  LDQ     XSA_PARAM_POOL_+1
         3 002766   000020 772000                    QRL     16
         3 002767   200334 756100                    STQ     TEMP_CODE+2,,AUTO
         3 002770   000020 236000 2                  LDQ     XSA_PARAM_POOL_NEXT$
         3 002771   000020 772000                    QRL     16
         3 002772   200334 136100                    SBLQ    TEMP_CODE+2,,AUTO
         3 002773   000070 036007                    ADLQ    56,DL
         3 002774   200335 756100                    STQ     TEMP_CODE+3,,AUTO
         3 002775   000016 236000 2                  LDQ     XSA_PARAM_POOL_
         3 002776   000020 772000                    QRL     16
         3 002777   200335 116100                    CMPQ    TEMP_CODE+3,,AUTO
         3 003000   003015 605000 3                  TPL     s:14645
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:189  

     1197    14638    2          > VBOUND(XSA_PARAM_POOL_)
     1198    14639    3       THEN DO;

     1199    14640    3           P_PARAM$ = ADDR(NIL);

  14640  3 003001   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003002   200243 470500                    LDP0    @P_PARAM$,,AUTO
         3 003003   000000 756100                    STQ     0,,PR0

     1200    14641    3           CALL SET_XUU_ERR( %E$XUU#NO_XSA_MEM, %FALSE );

  14641  3 003004   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003005   000010 235000 4                  LDA     8
         3 003006   200326 757100                    STAQ    @P_ERROR_NUM+1,,AUTO
         3 003007   000063 236000 4                  LDQ     51
         3 003010   200325 756100                    STQ     @P_PARAM$+2,,AUTO
         3 003011   003135 701000 3                  TSX1    SET_XUU_ERR
         3 003012   000000 011000                    NOP     0

     1201    14642    3           ALTRETURN;

  14642  3 003013   200242 221300                    LDX1  ! ALT_FLAG,,AUTO
         3 003014   000000 702211                    TSX2  ! 0,X1

     1202    14643    3           END;
     1203    14644    3       ELSE DO;

     1204    14645    3           P_PARAM$ = XSA_PARAM_POOL_NEXT$;

  14645  3 003015   000020 236000 2                  LDQ     XSA_PARAM_POOL_NEXT$
         3 003016   200243 470500                    LDP0    @P_PARAM$,,AUTO
         3 003017   000000 756100                    STQ     0,,PR0

     1205    14646    3           XSA_PARAM_POOL_NEXT$ = PINCRW( XSA_PARAM_POOL_NEXT$, SIZEW(XSA_PARAM) );

  14646  3 003020   000016 036003                    ADLQ    14,DU
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:190  
         3 003021   000020 756000 2                  STQ     XSA_PARAM_POOL_NEXT$

     1206    14647    3           P_PARAM$->XSA_PARAM = CONST_XSA_PARAM;

  14647  3 003022   000000 471500                    LDP1    0,,PR0
         3 003023   000100 100400                    MLR     fill='000'O
         3 003024   000412 000070 1                  ADSC9   CONST_XSA_PARAM          cn=0,n=56
         3 003025   100000 000070                    ADSC9   0,,PR1                   cn=0,n=56

     1207    14648    3           END;

     1208    14649
     1209    14650    2   END GET_XSA_PARAM;

  14650  3 003026   200242 221300                    LDX1  ! ALT_FLAG,,AUTO
         3 003027   000001 702211                    TSX2  ! 1,X1

     1210    14651
     1211    14652        %PAGE( ARG=RELEASE_XSA_PARAM, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:191  
             14664    2   /*******************************************************************************
             14665    2   *                                                                              *
             14666    2   *        RELEASE_XSA_PARAM              RELEASE_XSA_PARAM                         *
             14667    2   *                                                                              *
             14668    2   *******************************************************************************/

     1212    14672    1   RELEASE_XSA_PARAM: PROC( P_PARAM$ ) ALTRET;

  14672  3 003030   200322 741300       RELEASE_XSA* STX1  ! CLOSE_ERR+1,,AUTO

     1213    14673
     1214    14674    2   DCL P_PARAM$ PTR ALIGNED;
     1215    14675
     1216    14676    2       IF P_PARAM$ ~= ADDR(NIL)

  14676  3 003031   200323 470500                    LDP0    @P_PARAM$,,AUTO
         3 003032   000000 236100                    LDQ     0,,PR0
         3 003033   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 003034   003054 600000 3                  TZE     s:14688

     1217    14677    3       THEN DO;

     1218    14678    3           IF P_PARAM$ = PINCRW( XSA_PARAM_POOL_NEXT$, -SIZEW(XSA_PARAM) )

  14678  3 003035   000020 236000 2                  LDQ     XSA_PARAM_POOL_NEXT$
         3 003036   777762 036003                    ADLQ    -14,DU
         3 003037   000000 116100                    CMPQ    0,,PR0
         3 003040   003043 601000 3                  TNZ     s:14683

     1219    14679    4           THEN DO;

     1220    14680    4              XSA_PARAM_POOL_NEXT$ = PINCRW( XSA_PARAM_POOL_NEXT$, -SIZEW(XSA_PARAM) )
             14680                        ;

  14680  3 003041   000020 756000 2                  STQ     XSA_PARAM_POOL_NEXT$

     1221    14681    4               END;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:192  

  14681  3 003042   003054 710000 3                  TRA     s:14688

     1222    14682    4           ELSE DO;

     1223    14683    4               CALL SET_XUU_ERR( %E$XUU#BAD_REL, %FALSE );

  14683  3 003043   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003044   000010 235000 4                  LDA     8
         3 003045   200326 757100                    STAQ    @P_ERROR_NUM+1,,AUTO
         3 003046   000065 236000 4                  LDQ     53
         3 003047   200325 756100                    STQ     @P_PARAM$+2,,AUTO
         3 003050   003135 701000 3                  TSX1    SET_XUU_ERR
         3 003051   000000 011000                    NOP     0

     1224    14684    4               ALTRETURN;

  14684  3 003052   200322 221300                    LDX1  ! CLOSE_ERR+1,,AUTO
         3 003053   000000 702211                    TSX2  ! 0,X1

     1225    14685    4               END;
     1226    14686    3           END;
     1227    14687
     1228    14688    2   END RELEASE_XSA_PARAM;

  14688  3 003054   000001 702211                    TSX2  ! 1,X1

     1229    14689
     1230    14690        %PAGE( ARG=IO_ERR, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:193  
             14702    2   /*******************************************************************************
             14703    2   *                                                                              *
             14704    2   *        IO_ERR              IO_ERR                                               *
             14705    2   *                                                                              *
             14706    2   *******************************************************************************/

     1231    14710    1   IO_ERR: PROC ( P_FILE, P_PASS_BUF ) ALTRET;

  14710  3 003055   200244 741300       IO_ERR       STX1  ! @P_PARAM$+1,,AUTO
         3 003056   003060 710000 3                  TRA     s:14717

     1232    14711
     1233    14712    2   DCL P_FILE UBIN WORD ALIGNED;
     1234    14713    2   DCL P_PASS_BUF BIT(1) ALIGNED;
     1235    14714
     1236    14715    2   REC_IO_ERR: ENTRY( P_FILE, P_PASS_BUF ) ALTRET;

  14715  3 003057   200244 741300       REC_IO_ERR   STX1  ! @P_PARAM$+1,,AUTO

     1237    14716
     1238    14717    2       CALL SET_IO_ERROR( P_FILE, %TRUE, P_PASS_BUF ) ALTRET( KILL );

  14717  3 003060   200246 236100                    LDQ     @P_PASS_BUF,,AUTO
         3 003061   000031 235000 4                  LDA     25
         3 003062   200256 757100                    STAQ    @P_INFO+1,,AUTO
         3 003063   200245 236100                    LDQ     @P_FILE,,AUTO
         3 003064   200255 756100                    STQ     ALT_FLAG+3,,AUTO
         3 003065   003244 701000 3                  TSX1    SET_IO_ERROR
         3 003066   003101 702000 3                  TSX2    KILL

     1239    14718
     1240    14719    2       RETURN;

  14719  3 003067   200244 221300                    LDX1  ! @P_PARAM$+1,,AUTO
         3 003070   000001 702211                    TSX2  ! 1,X1

     1241    14720
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:194  
     1242    14721    2   KILL_IO_ERR: ENTRY( P_FILE ) ALTRET;

  14721  3 003071   200244 741300       KILL_IO_ERR  STX1  ! @P_PARAM$+1,,AUTO

     1243    14722
     1244    14723    2       CALL SET_IO_ERROR( P_FILE, %FALSE );

  14723  3 003072   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003073   000010 235000 4                  LDA     8
         3 003074   200256 757100                    STAQ    @P_INFO+1,,AUTO
         3 003075   200245 236100                    LDQ     @P_FILE,,AUTO
         3 003076   200255 756100                    STQ     ALT_FLAG+3,,AUTO
         3 003077   003244 701000 3                  TSX1    SET_IO_ERROR
         3 003100   000000 011000                    NOP     0

  14715  3 003101                       KILL         null
     1245    14724
     1246    14725    2   KILL: ;
     1247    14726    2       CALL CLEANUP;

  14726  3 003101   003446 701000 3                  TSX1    CLEANUP
         3 003102   000000 011000                    NOP     0

     1248    14727    2       ALTRETURN;

  14727  3 003103   200244 221300                    LDX1  ! @P_PARAM$+1,,AUTO
         3 003104   000000 702211                    TSX2  ! 0,X1

     1249    14728
     1250    14729    2   END IO_ERR;
     1251    14730
     1252    14731        %PAGE( ARG=XUU_ERR, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:195  
             14743    2   /*******************************************************************************
             14744    2   *                                                                              *
             14745    2   *        XUU_ERR              XUU_ERR                                             *
             14746    2   *                                                                              *
             14747    2   *******************************************************************************/

     1253    14751    1   XUU_ERR: PROC( P_ERROR_NUM, P_PASS_BUF ) ALTRET;

  14751  3 003105   200030 741300       XUU_ERR      STX1  ! GOT_M+1,,AUTO
         3 003106   003110 710000 3                  TRA     s:14758

     1254    14752
     1255    14753    2   DCL P_ERROR_NUM UBIN WORD ALIGNED;
     1256    14754    2   DCL P_PASS_BUF BIT(1) ALIGNED;
     1257    14755
     1258    14756    2   REC_XUU_ERR: ENTRY( P_ERROR_NUM, P_PASS_BUF ) ALTRET;

  14756  3 003107   200030 741300       REC_XUU_ERR  STX1  ! GOT_M+1,,AUTO

     1259    14757
     1260    14758    2       CALL SET_XUU_ERR( P_ERROR_NUM, %TRUE, P_PASS_BUF ) ALTRET( KILL );

  14758  3 003110   200032 236100                    LDQ     @P_PASS_BUF,,AUTO
         3 003111   000031 235000 4                  LDA     25
         3 003112   200326 757100                    STAQ    @P_ERROR_NUM+1,,AUTO
         3 003113   200031 236100                    LDQ     @P_ERROR_NUM,,AUTO
         3 003114   200325 756100                    STQ     @P_PARAM$+2,,AUTO
         3 003115   003135 701000 3                  TSX1    SET_XUU_ERR
         3 003116   003131 702000 3                  TSX2    KILL

     1261    14759
     1262    14760    2       RETURN;

  14760  3 003117   200030 221300                    LDX1  ! GOT_M+1,,AUTO
         3 003120   000001 702211                    TSX2  ! 1,X1

     1263    14761
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:196  
     1264    14762    2   KILL_XUU_ERR: ENTRY( P_ERROR_NUM ) ALTRET;

  14762  3 003121   200030 741300       KILL_XUU_ERR STX1  ! GOT_M+1,,AUTO

     1265    14763
     1266    14764    2       CALL SET_XUU_ERR( P_ERROR_NUM, %FALSE );

  14764  3 003122   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003123   000010 235000 4                  LDA     8
         3 003124   200326 757100                    STAQ    @P_ERROR_NUM+1,,AUTO
         3 003125   200031 236100                    LDQ     @P_ERROR_NUM,,AUTO
         3 003126   200325 756100                    STQ     @P_PARAM$+2,,AUTO
         3 003127   003135 701000 3                  TSX1    SET_XUU_ERR
         3 003130   000000 011000                    NOP     0

  14756  3 003131                       KILL         null
     1267    14765
     1268    14766    2   KILL: ;
     1269    14767    2       CALL CLEANUP;

  14767  3 003131   003446 701000 3                  TSX1    CLEANUP
         3 003132   000000 011000                    NOP     0

     1270    14768
     1271    14769    2       ALTRETURN;

  14769  3 003133   200030 221300                    LDX1  ! GOT_M+1,,AUTO
         3 003134   000000 702211                    TSX2  ! 0,X1

     1272    14770
     1273    14771    2   END XUU_ERR;
     1274    14772
     1275    14773        %PAGE( ARG=SET_XUU_ERR, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:197  
             14785    2   /*******************************************************************************
             14786    2   *                                                                              *
             14787    2   *        SET_XUU_ERR              SET_XUU_ERR                                     *
             14788    2   *                                                                              *
             14789    2   *******************************************************************************/

     1276    14793    1   SET_XUU_ERR: PROC( P_ERROR_NUM, P_RECOVERABLE, P_PASS_BUF ) ALTRET;

  14793  3 003135   200324 741300       SET_XUU_ERR  STX1  ! @P_PARAM$+1,,AUTO

     1277    14794
     1278    14795    2   DCL P_ERROR_NUM UBIN WORD ALIGNED;
     1279    14796    2   DCL P_RECOVERABLE BIT(1) ALIGNED;
     1280    14797    2   DCL P_PASS_BUF BIT(1) ALIGNED;
     1281    14798    2   DCL TEMP_VEC VECTOR;
     1282    14799        %VLP_ERRCODE( FPTN=TEMP_CODE, STCLASS=" " );
     1283    14844
     1284    14845
     1285    14846    2       TEMP_CODE = ERROR_CODE_BASE;

  14846  3 003136   000004 236000 1                  LDQ     ERROR_CODE_BASE
         3 003137   200332 756100                    STQ     TEMP_CODE,,AUTO

     1286    14847    2       TEMP_CODE.ERR# = P_ERROR_NUM;

  14847  3 003140   200325 470500                    LDP0    @P_ERROR_NUM,,AUTO
         3 003141   000000 236100                    LDQ     0,,PR0
         3 003142   000003 736000                    QLS     3
         3 003143   200332 676100                    ERQ     TEMP_CODE,,AUTO
         3 003144   377770 376007                    ANQ     131064,DL
         3 003145   200332 656100                    ERSQ    TEMP_CODE,,AUTO

     1287    14848
     1288    14849    2       IF ( P_RECOVERABLE = %TRUE ) AND

  14849  3 003146   200326 471500                    LDP1    @P_RECOVERABLE,,AUTO
         3 003147   100000 234100                    SZN     0,,PR1
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:198  
         3 003150   003215 605000 3                  TPL     NICE_TRY
         3 003151   200003 473500                    LDP3    @XUU_PARAM,,AUTO
         3 003152   300010 236100                    LDQ     8,,PR3
         3 003153   000002 116000 xsym               CMPQ    B_VECTNIL+2
         3 003154   003215 600000 3                  TZE     NICE_TRY

     1289    14850    2          ( XUU_PARAM.ERROR_PROC$$ ~= ENTADDR(NIL) )
     1290    14851    3       THEN DO;

     1291    14852    3           IF P_PASS_BUF

  14852  3 003155   200327 474500                    LDP4    @P_PASS_BUF,,AUTO
         3 003156   400000 234100                    SZN     0,,PR4
         3 003157   003204 605000 3                  TPL     s:14859

     1292    14853    4           THEN DO;

     1293    14854    4               TEMP_VEC = P_BUF_;

  14854  3 003160   200004 475500                    LDP5    @P_BUF_,,AUTO
         3 003161   000100 100500                    MLR     fill='000'O
         3 003162   500000 000010                    ADSC9   0,,PR5                   cn=0,n=8
         3 003163   200330 000010                    ADSC9   TEMP_VEC,,AUTO           cn=0,n=8

     1294    14855    4               VBOUND(TEMP_VEC) = ARS - 1;

  14855  3 003164   200013 236100                    LDQ     ARS,,AUTO
         3 003165   000001 136007                    SBLQ    1,DL
         3 003166   000020 736000                    QLS     16
         3 003167   200330 676100                    ERQ     TEMP_VEC,,AUTO
         3 003170   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 003171   200330 656100                    ERSQ    TEMP_VEC,,AUTO

     1295    14856    4               CALL XUU_PARAM.ERROR_PROC$$( TEMP_CODE, TEMP_VEC ) ALTRET( NICE_TRY );

  14856  3 003172   200330 636500                    EPPR6   TEMP_VEC,,AUTO
         3 003173   200335 456500                    STP6    TEMP_CODE+3,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:199  
         3 003174   200332 637500                    EPPR7   TEMP_CODE,,AUTO
         3 003175   200334 457500                    STP7    TEMP_CODE+2,,AUTO
         3 003176   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 003177   300010 220100                    LDX0    8,,PR3
         3 003200   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 003201   000000 701010                    TSX1    0,X0
         3 003202   003215 702000 3                  TSX2    NICE_TRY

     1296    14857    4               END;

  14857  3 003203   003213 710000 3                  TRA     s:14861

     1297    14858    4           ELSE DO;

     1298    14859    4               CALL XUU_PARAM.ERROR_PROC$$( TEMP_CODE ) ALTRET( NICE_TRY );

  14859  3 003204   200332 635500                    EPPR5   TEMP_CODE,,AUTO
         3 003205   200334 455500                    STP5    TEMP_CODE+2,,AUTO
         3 003206   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 003207   300010 220100                    LDX0    8,,PR3
         3 003210   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003211   000000 701010                    TSX1    0,X0
         3 003212   003215 702000 3                  TSX2    NICE_TRY

     1299    14860    4               END;

     1300    14861    3           RETURN;

  14861  3 003213   200324 221300                    LDX1  ! @P_PARAM$+1,,AUTO
         3 003214   000001 702211                    TSX2  ! 1,X1

  14857  3 003215                       NICE_TRY     null
     1301    14862    3           END;
     1302    14863
     1303    14864    2   NICE_TRY: ;
     1304    14865
     1305    14866    2       IF NOT ERROR_SET
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:200  

  14866  3 003215   200014 234100                    SZN     ERROR_SET,,AUTO
         3 003216   003242 604000 3                  TMI     s:14878

     1306    14867    3       THEN DO;

     1307    14868    3           ERROR_SET = %TRUE;

  14868  3 003217   400000 236003                    LDQ     -131072,DU
         3 003220   200014 756100                    STQ     ERROR_SET,,AUTO

     1308    14869    3           XUU_PARAM.FLAGS = XUU_PARAM.FLAGS & %CLEAR_OUTPUT_FLAGS;

  14869  3 003221   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 003222   000000 220100                    LDX0    0,,PR0
         3 003223   070770 360003                    ANX0    29176,DU
         3 003224   000000 740100                    STX0    0,,PR0

     1309    14870    3           XUU_PARAM.FLAGS.XUU_ERR# = %TRUE;

  14870  3 003225   001000 236003                    LDQ     512,DU
         3 003226   000000 256100                    ORSQ    0,,PR0

     1310    14871    3           XUU_PARAM.ERRCODE = TEMP_CODE;

  14871  3 003227   200332 236100                    LDQ     TEMP_CODE,,AUTO
         3 003230   000002 756100                    STQ     2,,PR0

     1311    14872    3           IF ADDR( P_PASS_BUF ) ~= ADDR(NIL)

  14872  3 003231   200327 236100                    LDQ     @P_PASS_BUF,,AUTO
         3 003232   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 003233   003242 600000 3                  TZE     s:14878

     1312    14873    4           THEN DO;

     1313    14874    4               XUU_PARAM.FLAGS.BAD_UPDATE# = P_PASS_BUF;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:201  

  14874  3 003234   200327 471500                    LDP1    @P_PASS_BUF,,AUTO
         3 003235   100000 236100                    LDQ     0,,PR1
         3 003236   000020 772000                    QRL     16
         3 003237   000000 676100                    ERQ     0,,PR0
         3 003240   000002 376003                    ANQ     2,DU
         3 003241   000000 656100                    ERSQ    0,,PR0

     1314    14875    4               END;

     1315    14876    3           END;

     1316    14877
     1317    14878    2       ALTRETURN;

  14878  3 003242   200324 221300                    LDX1  ! @P_PARAM$+1,,AUTO
         3 003243   000000 702211                    TSX2  ! 0,X1

     1318    14879
     1319    14880    2   END SET_XUU_ERR;
     1320    14881
     1321    14882        %PAGE( ARG=SET_IO_ERROR, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:202  
             14894    2   /*******************************************************************************
             14895    2   *                                                                              *
             14896    2   *        SET_IO_ERROR              SET_IO_ERROR                                   *
             14897    2   *                                                                              *
             14898    2   *******************************************************************************/

     1322    14902    1   SET_IO_ERROR: PROC( P_FILE, P_RECOVERABLE, P_PASS_BUF ) ALTRET;

  14902  3 003244   200254 741300       SET_IO_ERROR STX1  ! ALT_FLAG+2,,AUTO

     1323    14903
     1324    14904    2   DCL P_FILE UBIN WORD ALIGNED;
     1325    14905    2   DCL P_RECOVERABLE BIT(1) ALIGNED;
     1326    14906    2   DCL P_PASS_BUF BIT(1) ALIGNED;
     1327    14907    2   DCL TEMP_VEC VECTOR;
     1328    14908
     1329    14909
     1330    14910    2       IF NOT ERROR_SET

  14910  3 003245   200014 234100                    SZN     ERROR_SET,,AUTO
         3 003246   003414 604000 3                  TMI     s:14967

     1331    14911    3       THEN DO;

     1332    14912    3           IF ( P_RECOVERABLE = %TRUE ) AND

  14912  3 003247   200256 470500                    LDP0    @P_RECOVERABLE,,AUTO
         3 003250   000000 234100                    SZN     0,,PR0
         3 003251   003316 605000 3                  TPL     NICE_TRY
         3 003252   200003 471500                    LDP1    @XUU_PARAM,,AUTO
         3 003253   100010 236100                    LDQ     8,,PR1
         3 003254   000002 116000 xsym               CMPQ    B_VECTNIL+2
         3 003255   003316 600000 3                  TZE     NICE_TRY

     1333    14913    3              ( XUU_PARAM.ERROR_PROC$$ ~= ENTADDR(NIL) )
     1334    14914    4           THEN DO;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:203  
     1335    14915    4               IF P_PASS_BUF

  14915  3 003256   200257 473500                    LDP3    @P_PASS_BUF,,AUTO
         3 003257   300000 234100                    SZN     0,,PR3
         3 003260   003305 605000 3                  TPL     s:14922

     1336    14916    5               THEN DO;

     1337    14917    5                   TEMP_VEC = P_BUF_;

  14917  3 003261   200004 474500                    LDP4    @P_BUF_,,AUTO
         3 003262   000100 100500                    MLR     fill='000'O
         3 003263   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8
         3 003264   200260 000010                    ADSC9   TEMP_VEC,,AUTO           cn=0,n=8

     1338    14918    5                   VBOUND(TEMP_VEC) = ARS - 1;

  14918  3 003265   200013 236100                    LDQ     ARS,,AUTO
         3 003266   000001 136007                    SBLQ    1,DL
         3 003267   000020 736000                    QLS     16
         3 003270   200260 676100                    ERQ     TEMP_VEC,,AUTO
         3 003271   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 003272   200260 656100                    ERSQ    TEMP_VEC,,AUTO

     1339    14919    5                   CALL XUU_PARAM.ERROR_PROC$$( ERROR_CODE, TEMP_VEC ) ALTRET (
             14919                            NICE_TRY );

  14919  3 003273   200260 635500                    EPPR5   TEMP_VEC,,AUTO
         3 003274   200335 455500                    STP5    TEMP_CODE+3,,AUTO
         3 003275   200005 636500                    EPPR6   ERROR_CODE,,AUTO
         3 003276   200334 456500                    STP6    TEMP_CODE+2,,AUTO
         3 003277   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 003300   100010 220100                    LDX0    8,,PR1
         3 003301   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 003302   000000 701010                    TSX1    0,X0
         3 003303   003316 702000 3                  TSX2    NICE_TRY

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:204  
     1340    14920    5                   END;

  14920  3 003304   003314 710000 3                  TRA     s:14924

     1341    14921    5               ELSE DO;

     1342    14922    5                   CALL XUU_PARAM.ERROR_PROC$$( ERROR_CODE ) ALTRET ( NICE_TRY );

  14922  3 003305   200005 634500                    EPPR4   ERROR_CODE,,AUTO
         3 003306   200334 454500                    STP4    TEMP_CODE+2,,AUTO
         3 003307   200334 630500                    EPPR0   TEMP_CODE+2,,AUTO
         3 003310   100010 220100                    LDX0    8,,PR1
         3 003311   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003312   000000 701010                    TSX1    0,X0
         3 003313   003316 702000 3                  TSX2    NICE_TRY

     1343    14923    5                   END;

     1344    14924    4               RETURN;

  14924  3 003314   200254 221300                    LDX1  ! ALT_FLAG+2,,AUTO
         3 003315   000001 702211                    TSX2  ! 1,X1

  14922  3 003316                       NICE_TRY     null
     1345    14925    4               END;
     1346    14926
     1347    14927    3   NICE_TRY: ;
     1348    14928
     1349    14929    3           ERROR_SET = %TRUE;

  14929  3 003316   400000 236003                    LDQ     -131072,DU
         3 003317   200014 756100                    STQ     ERROR_SET,,AUTO

     1350    14930    3           XUU_PARAM.FLAGS = XUU_PARAM.FLAGS & %CLEAR_OUTPUT_FLAGS;

  14930  3 003320   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 003321   000000 220100                    LDX0    0,,PR0
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:205  
         3 003322   070770 360003                    ANX0    29176,DU
         3 003323   000000 740100                    STX0    0,,PR0

     1351    14931    3           XUU_PARAM.ERRCODE = ERROR_CODE;

  14931  3 003324   200005 236100                    LDQ     ERROR_CODE,,AUTO
         3 003325   000002 756100                    STQ     2,,PR0

     1352    14932
     1353    14933    4           DO CASE P_FILE;

  14933  3 003326   200255 471500                    LDP1    @P_FILE,,AUTO
         3 003327   100000 235100                    LDA     0,,PR1
         3 003330   000006 115007                    CMPA    6,DL
         3 003331   003333 602005 3                  TNC     s:14933+5,AL
         3 003332   003406 710000 3                  TRA     s:14960
         3 003333   003406 710000 3                  TRA     s:14960
         3 003334   003341 710000 3                  TRA     s:14935
         3 003335   003350 710000 3                  TRA     s:14940
         3 003336   003366 710000 3                  TRA     s:14950
         3 003337   003377 710000 3                  TRA     s:14955
         3 003340   003357 710000 3                  TRA     s:14945

     1354    14934    4           CASE ( %SI_ERR );

     1355    14935    4               XUU_PARAM.SI_ERRCODE = ERROR_CODE;

  14935  3 003341   200005 236100                    LDQ     ERROR_CODE,,AUTO
         3 003342   000001 756100                    STQ     1,,PR0

     1356    14936    4               XUU_PARAM.DCB# = SI_INFO.DCB#;

  14936  3 003343   000024 721000 2                  LXL1    SI_INFO+3
         3 003344   000005 441100                    SXL1    5,,PR0

     1357    14937    4               XUU_PARAM.FLAGS.BASE# = %TRUE;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:206  
  14937  3 003345   400000 236003                    LDQ     -131072,DU
         3 003346   000000 256100                    ORSQ    0,,PR0
         3 003347   003414 710000 3                  TRA     s:14967

     1358    14938
     1359    14939    4           CASE ( %UI_ERR );

     1360    14940    4               XUU_PARAM.UI_ERRCODE = ERROR_CODE;

  14940  3 003350   200005 236100                    LDQ     ERROR_CODE,,AUTO
         3 003351   000002 756100                    STQ     2,,PR0

     1361    14941    4               XUU_PARAM.DCB# = UI_INFO.DCB#;

  14941  3 003352   000030 721000 2                  LXL1    UI_INFO+3
         3 003353   000005 441100                    SXL1    5,,PR0

     1362    14942    4               XUU_PARAM.FLAGS.UP_DATE# = %TRUE;

  14942  3 003354   200000 236003                    LDQ     65536,DU
         3 003355   000000 256100                    ORSQ    0,,PR0
         3 003356   003414 710000 3                  TRA     s:14967

     1363    14943
     1364    14944    4           CASE ( %LU_ERR );

     1365    14945    4               XUU_PARAM.UI_ERRCODE = ERROR_CODE;

  14945  3 003357   200005 236100                    LDQ     ERROR_CODE,,AUTO
         3 003360   000002 756100                    STQ     2,,PR0

     1366    14946    4               XUU_PARAM.DCB# = LU_INFO.DCB#;

  14946  3 003361   000040 721000 2                  LXL1    LU_INFO+3
         3 003362   000005 441100                    SXL1    5,,PR0

     1367    14947    4               XUU_PARAM.FLAGS.UP_DATE# = %TRUE;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:207  

  14947  3 003363   200000 236003                    LDQ     65536,DU
         3 003364   000000 256100                    ORSQ    0,,PR0
         3 003365   003414 710000 3                  TRA     s:14967

     1368    14948
     1369    14949    4           CASE ( %INCL_ERR );

     1370    14950    4               XUU_PARAM.O.INCL_ERRCODE = ERROR_CODE;

  14950  3 003366   200005 236100                    LDQ     ERROR_CODE,,AUTO
         3 003367   000003 756100                    STQ     3,,PR0

     1371    14951    4               XUU_PARAM.DCB# = INCL_INFO.DCB#(TEMP_INCL_LEVEL);

  14951  3 003370   200015 235100                    LDA     TEMP_INCL_LEVEL,,AUTO
         3 003371   000002 735000                    ALS     2
         3 003372   000044 721005 2                  LXL1    INCL_INFO+3,AL
         3 003373   000005 441100                    SXL1    5,,PR0

     1372    14952    4               XUU_PARAM.FLAGS.INCLUDE# = %TRUE;

  14952  3 003374   100000 236003                    LDQ     32768,DU
         3 003375   000000 256100                    ORSQ    0,,PR0
         3 003376   003414 710000 3                  TRA     s:14967

     1373    14953
     1374    14954    4           CASE ( %SO_ERR );

     1375    14955    4               XUU_PARAM.C.SO_ERRCODE = ERROR_CODE;

  14955  3 003377   200005 236100                    LDQ     ERROR_CODE,,AUTO
         3 003400   000004 756100                    STQ     4,,PR0

     1376    14956    4               XUU_PARAM.DCB# = SO_INFO.DCB#;

  14956  3 003401   000034 721000 2                  LXL1    SO_INFO+3
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:208  
         3 003402   000005 441100                    SXL1    5,,PR0

     1377    14957    4               XUU_PARAM.FLAGS.SO_ERR# = %TRUE;

  14957  3 003403   002000 236003                    LDQ     1024,DU
         3 003404   000000 256100                    ORSQ    0,,PR0
         3 003405   003414 710000 3                  TRA     s:14967

     1378    14958
     1379    14959    4           CASE ( ELSE );

     1380    14960    4               XUU_PARAM.ERRCODE = ERROR_CODE;

  14960  3 003406   200005 236100                    LDQ     ERROR_CODE,,AUTO
         3 003407   000002 756100                    STQ     2,,PR0

     1381    14961    4               XUU_PARAM.DCB# = DCBNUM(NIL);

  14961  3 003410   000000 221003                    LDX1    0,DU
         3 003411   000005 441100                    SXL1    5,,PR0

     1382    14962    4               XUU_PARAM.FLAGS.XUU_ERR# = %TRUE;

  14962  3 003412   001000 236003                    LDQ     512,DU
         3 003413   000000 256100                    ORSQ    0,,PR0

     1383    14963
     1384    14964    4               END;

     1385    14965    3           END;

     1386    14966
     1387    14967    2       ALTRETURN;

  14967  3 003414   200254 221300                    LDX1  ! ALT_FLAG+2,,AUTO
         3 003415   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:209  
     1388    14968
     1389    14969    2   END SET_IO_ERROR;
     1390    14970
     1391    14971        %PAGE( ARG=CLEANUP_FILE, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:210  
             14983    2   /*******************************************************************************
             14984    2   *                                                                              *
             14985    2   *        CLEANUP_FILE              CLEANUP_FILE                                   *
             14986    2   *                                                                              *
             14987    2   *******************************************************************************/

     1392    14991    1   CLEANUP_FILE: PROC( P_INFO ) ALTRET;

  14991  3 003416   200254 741300       CLEANUP_FILE STX1  ! ALT_FLAG+2,,AUTO

     1393    14992
     1394    14993        %FILE_INFO( NAME=P_INFO,STCLASS=" " );
     1395    15027    2   DCL ALT_FLAG BIT(1) ALIGNED;
     1396    15028
     1397    15029    2       ALT_FLAG = %FALSE;

  15029  3 003417   200256 450100                    STZ     ALT_FLAG,,AUTO

     1398    15030
     1399    15031    2       CALL CLOSE( P_INFO )

  15031  3 003420   200255 236100                    LDQ     @P_INFO,,AUTO
         3 003421   200261 756100                    STQ     @P_INFO,,AUTO
         3 003422   002355 701000 3                  TSX1    CLOSE
         3 003423   003425 702000 3                  TSX2    s:15033
         3 003424   003427 710000 3                  TRA     s:15036

     1400    15032    3       WHENALTRETURN DO;

     1401    15033    3           ALT_FLAG = %TRUE;

  15033  3 003425   400000 236003                    LDQ     -131072,DU
         3 003426   200256 756100                    STQ     ALT_FLAG,,AUTO

     1402    15034    3           END;

     1403    15035
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:211  
     1404    15036    2       CALL RELDCB( P_INFO )

  15036  3 003427   200255 236100                    LDQ     @P_INFO,,AUTO
         3 003430   200261 756100                    STQ     @P_INFO,,AUTO
         3 003431   002672 701000 3                  TSX1    RELDCB
         3 003432   003434 702000 3                  TSX2    s:15038
         3 003433   003436 710000 3                  TRA     s:15041

     1405    15037    3       WHENALTRETURN DO;

     1406    15038    3           ALT_FLAG = %TRUE;

  15038  3 003434   400000 236003                    LDQ     -131072,DU
         3 003435   200256 756100                    STQ     ALT_FLAG,,AUTO

     1407    15039    3           END;

     1408    15040
     1409    15041    2       IF ALT_FLAG AND NOT ERROR_SET

  15041  3 003436   200256 234100                    SZN     ALT_FLAG,,AUTO
         3 003437   003444 605000 3                  TPL     s:15044
         3 003440   200014 234100                    SZN     ERROR_SET,,AUTO
         3 003441   003444 604000 3                  TMI     s:15044

     1410    15042    2       THEN ALTRETURN;

  15042  3 003442   200254 221300                    LDX1  ! ALT_FLAG+2,,AUTO
         3 003443   000000 702211                    TSX2  ! 0,X1

     1411    15043
     1412    15044    2   END CLEANUP_FILE;

  15044  3 003444   200254 221300                    LDX1  ! ALT_FLAG+2,,AUTO
         3 003445   000001 702211                    TSX2  ! 1,X1

     1413    15045
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:212  
     1414    15046        %PAGE( ARG=CLEANUP, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:213  
             15058    2   /*******************************************************************************
             15059    2   *                                                                              *
             15060    2   *        CLEANUP              CLEANUP                                             *
             15061    2   *                                                                              *
             15062    2   *******************************************************************************/

     1415    15066    1   CLEANUP: PROC ALTRET;

  15066  3 003446   200250 741300       CLEANUP      STX1  ! @P_PASS_BUF+2,,AUTO

     1416    15067
     1417    15068    2   DCL I SBIN WORD;
     1418    15069    2   DCL ALT_FLAG BIT(1) ALIGNED;
     1419    15070
     1420    15071    2       ALT_FLAG = %FALSE;

  15071  3 003447   200252 450100                    STZ     ALT_FLAG,,AUTO

     1421    15072    2       CURRENT_STATE = %#UNINITIALIZED;

  15072  3 003450   000000 220003                    LDX0    0,DU
         3 003451   000112 740000 2                  STX0    CURRENT_STATE

     1422    15073    2       INCL_SAVE_STATE = %#UNINITIALIZED;

  15073  3 003452   000116 740000 2                  STX0    INCL_SAVE_STATE

     1423    15074
     1424    15075    3       DO I = %(MAX_INCL_LEVEL-1) DOWNTO 0;

  15075  3 003453   000011 235007                    LDA     9,DL
         3 003454   200251 755100                    STA     I,,AUTO

     1425    15076    3           CALL CLEANUP_FILE( INCL_INFO(I) )

  15076  3 003455   200251 236100                    LDQ     I,,AUTO
         3 003456   000024 736000                    QLS     20
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:214  
         3 003457   000006 036000 4                  ADLQ    6
         3 003460   200255 756100                    STQ     @P_INFO,,AUTO
         3 003461   003416 701000 3                  TSX1    CLEANUP_FILE
         3 003462   003464 702000 3                  TSX2    s:15078
         3 003463   003477 710000 3                  TRA     s:15082

     1426    15077    4           WHENALTRETURN DO;

     1427    15078    4               TEMP_INCL_LEVEL = I;

  15078  3 003464   200251 235100                    LDA     I,,AUTO
         3 003465   200015 755100                    STA     TEMP_INCL_LEVEL,,AUTO

     1428    15079    4               CALL SET_IO_ERROR( %INCL_ERR, %FALSE );

  15079  3 003466   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003467   000010 235000 4                  LDA     8
         3 003470   200256 757100                    STAQ    ALT_FLAG,,AUTO
         3 003471   000016 236000 4                  LDQ     14
         3 003472   200255 756100                    STQ     @P_INFO,,AUTO
         3 003473   003244 701000 3                  TSX1    SET_IO_ERROR
         3 003474   000000 011000                    NOP     0

     1429    15080    4               ALT_FLAG = %TRUE;

  15080  3 003475   400000 236003                    LDQ     -131072,DU
         3 003476   200252 756100                    STQ     ALT_FLAG,,AUTO

     1430    15081    4               END;

     1431    15082    3           END;

  15082  3 003477   000001 336007                    LCQ     1,DL
         3 003500   200251 056100                    ASQ     I,,AUTO
         3 003501   003455 605000 3                  TPL     s:15076

     1432    15083
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:215  
     1433    15084    2       CALL CLEANUP_FILE( SO_INFO )

  15084  3 003502   000066 236000 4                  LDQ     54
         3 003503   200255 756100                    STQ     @P_INFO,,AUTO
         3 003504   003416 701000 3                  TSX1    CLEANUP_FILE
         3 003505   003507 702000 3                  TSX2    s:15086
         3 003506   003520 710000 3                  TRA     s:15090

     1434    15085    3       WHENALTRETURN DO;

     1435    15086    3           CALL SET_IO_ERROR( %SO_ERR, %FALSE );

  15086  3 003507   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003510   000010 235000 4                  LDA     8
         3 003511   200256 757100                    STAQ    ALT_FLAG,,AUTO
         3 003512   000025 236000 4                  LDQ     21
         3 003513   200255 756100                    STQ     @P_INFO,,AUTO
         3 003514   003244 701000 3                  TSX1    SET_IO_ERROR
         3 003515   000000 011000                    NOP     0

     1436    15087    3           ALT_FLAG = %TRUE;

  15087  3 003516   400000 236003                    LDQ     -131072,DU
         3 003517   200252 756100                    STQ     ALT_FLAG,,AUTO

     1437    15088    3           END;

     1438    15089
     1439    15090    2       CALL CLEANUP_FILE( UI_INFO )

  15090  3 003520   000004 236000 4                  LDQ     4
         3 003521   200255 756100                    STQ     @P_INFO,,AUTO
         3 003522   003416 701000 3                  TSX1    CLEANUP_FILE
         3 003523   003525 702000 3                  TSX2    s:15092
         3 003524   003536 710000 3                  TRA     s:15096

     1440    15091    3       WHENALTRETURN DO;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:216  

     1441    15092    3           CALL SET_IO_ERROR( %UI_ERR, %FALSE );

  15092  3 003525   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003526   000010 235000 4                  LDA     8
         3 003527   200256 757100                    STAQ    ALT_FLAG,,AUTO
         3 003530   000022 236000 4                  LDQ     18
         3 003531   200255 756100                    STQ     @P_INFO,,AUTO
         3 003532   003244 701000 3                  TSX1    SET_IO_ERROR
         3 003533   000000 011000                    NOP     0

     1442    15093    3           ALT_FLAG = %TRUE;

  15093  3 003534   400000 236003                    LDQ     -131072,DU
         3 003535   200252 756100                    STQ     ALT_FLAG,,AUTO

     1443    15094    3           END;

     1444    15095
     1445    15096    2       CALL CLEANUP_FILE( SI_INFO )

  15096  3 003536   000002 236000 4                  LDQ     2
         3 003537   200255 756100                    STQ     @P_INFO,,AUTO
         3 003540   003416 701000 3                  TSX1    CLEANUP_FILE
         3 003541   003543 702000 3                  TSX2    s:15098
         3 003542   003554 710000 3                  TRA     s:15102

     1446    15097    3       WHENALTRETURN DO;

     1447    15098    3           CALL SET_IO_ERROR ( %SI_ERR, %FALSE );

  15098  3 003543   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003544   000010 235000 4                  LDA     8
         3 003545   200256 757100                    STAQ    ALT_FLAG,,AUTO
         3 003546   000020 236000 4                  LDQ     16
         3 003547   200255 756100                    STQ     @P_INFO,,AUTO
         3 003550   003244 701000 3                  TSX1    SET_IO_ERROR
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:217  
         3 003551   000000 011000                    NOP     0

     1448    15099    3           ALT_FLAG = %TRUE;

  15099  3 003552   400000 236003                    LDQ     -131072,DU
         3 003553   200252 756100                    STQ     ALT_FLAG,,AUTO

     1449    15100    3           END;

     1450    15101
     1451    15102    2       IF XSA_PARAM_POOL_ ~= VECTOR(NIL)

  15102  3 003554   000016 237000 2                  LDAQ    XSA_PARAM_POOL_
         3 003555   000026 117000 4                  CMPAQ   22
         3 003556   003567 600000 3                  TZE     s:15108

     1452    15103    3       THEN DO;

     1453    15104    3           CALL XUU_PARAM.RELEASE$$( XSA_PARAM_POOL_ );

  15104  3 003557   000060 630400 4                  EPPR0   48
         3 003560   200003 471500                    LDP1    @XUU_PARAM,,AUTO
         3 003561   100007 220100                    LDX0    7,,PR1
         3 003562   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003563   000000 701010                    TSX1    0,X0
         3 003564   000000 011000                    NOP     0

     1454    15105    3           XSA_PARAM_POOL_ = VECTOR(NIL);

  15105  3 003565   000026 237000 4                  LDAQ    22
         3 003566   000016 757000 2                  STAQ    XSA_PARAM_POOL_

     1455    15106    3           END;

     1456    15107
     1457    15108    2       IF ALT_FLAG

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:218  
  15108  3 003567   200252 234100                    SZN     ALT_FLAG,,AUTO
         3 003570   003573 605000 3                  TPL     s:15111

     1458    15109    2       THEN ALTRETURN;

  15109  3 003571   200250 221300                    LDX1  ! @P_PASS_BUF+2,,AUTO
         3 003572   000000 702211                    TSX2  ! 0,X1

     1459    15110
     1460    15111    2   END CLEANUP;

  15111  3 003573   200250 221300                    LDX1  ! @P_PASS_BUF+2,,AUTO
         3 003574   000001 702211                    TSX2  ! 1,X1

     1461    15112
     1462    15113        %PAGE( ARG=PRINT_UPDATE, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:219  
             15125    2   /*******************************************************************************
             15126    2   *                                                                              *
             15127    2   *        PRINT_UPDATE              PRINT_UPDATE                                   *
             15128    2   *                                                                              *
             15129    2   *******************************************************************************/

     1463    15133        /*N* Try to help this out some by using REC_IO_ERR for recoverable
     1464    15134            sorts of problems and doing something intelligent about leaving
     1465    15135            things in a usable state. Also need to report a message saying
     1466    15136            what is being done.
     1467    15137        */
     1468    15138    1   PRINT_UPDATE: PROC ALTRET;

  15138  3 003575   200020 741300       PRINT_UPDATE STX1  ! USER_BUF$+2,,AUTO

     1469    15139
     1470    15140        %FILE_INFO( NAME=UI_SCRATCH_INFO, STCLASS=AUTO );
     1471    15174        %FPT_OPEN( FPTN=OPEN_SCRATCH, STCLASS=CONSTANT, ASN=FILE, DISP=SCRATCH, FUN=CREATE,
             15174            ORG=CONSEC );
     1472    15283
     1473    15284    2   DCL 1 LU_BUF ALIGNED,
     1474    15285    2         2 HEAD,
     1475    15286    2           3 KEY CHAR(9) CALIGNED,
     1476    15287    2           3 SP CHAR(3) CALIGNED,
     1477    15288    2         2 BUF CHAR(256) ALIGNED;
     1478    15289
     1479    15290    2   DCL LEN SBIN;
     1480    15291    2   DCL BUF_VECT VECTOR;
     1481    15292    2   DCL WRITE_TEMP BIT(1) ALIGNED;
     1482    15293
     1483    15294
     1484    15295    2       IF LU_INFO.DCB# ~= DCBNUM(NIL)

  15295  3 003576   000040 720000 2                  LXL0    LU_INFO+3
         3 003577   003617 600000 3                  TZE     s:15304

     1485    15296    3       THEN DO;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:220  

     1486    15297    3           LU_BUF.HEAD.SP = ' ';

  15297  3 003600   000067 236000 4                  LDQ     55
         3 003601   200027 552134                    STBQ    GOT_M,'34'O,AUTO

     1487    15298    3           LU_BUF.BUF = #USER_BUFFER;

  15298  3 003602   200016 470500                    LDP0    USER_BUF$,,AUTO
         3 003603   200013 722100                    LXL2    ARS,,AUTO
         3 003604   040100 100540                    MLR     fill='040'O
         3 003605   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
         3 003606   200030 000400                    ADSC9   GOT_M+1,,AUTO            cn=0,n=256

     1488    15299    3           LU_BUF.HEAD.KEY = XUU_PARAM.RE_ASCII_KEY.CHAR1_9;

  15299  3 003607   200003 471500                    LDP1    @XUU_PARAM,,AUTO
         3 003610   040100 100500                    MLR     fill='040'O
         3 003611   100003 000011                    ADSC9   3,,PR1                   cn=0,n=9
         3 003612   200025 000011                    ADSC9   LU_BUF,,AUTO             cn=0,n=9

     1489    15300    3           LEN = ARS;

  15300  3 003613   200013 235100                    LDA     ARS,,AUTO
         3 003614   200130 755100                    STA     LEN,,AUTO

     1490    15301    3           CALL DUMP_LU_BUF ALTRET ( LU_PRINT_ERR );

  15301  3 003615   004047 701000 3                  TSX1    DUMP_LU_BUF
         3 003616   004016 702000 3                  TSX2    LU_PRINT_ERR

     1491    15302    3           END;

     1492    15303
     1493    15304    2       RETURN;

  15304  3 003617   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:221  
         3 003620   000001 702211                    TSX2  ! 1,X1

     1494    15305
     1495    15306    2   PRINT_SAVED_UPDATE: ENTRY ALTRET;

  15306  3 003621   200020 741300       PRINT_SAVED* STX1  ! USER_BUF$+2,,AUTO

     1496    15307
     1497    15308    2       IF LU_INFO.DCB# ~= DCBNUM(NIL)

  15308  3 003622   000040 720000 2                  LXL0    LU_INFO+3
         3 003623   003641 600000 3                  TZE     s:15317

     1498    15309    3       THEN DO;

     1499    15310    3           LU_BUF.HEAD.KEY = SAVED_UPDATE.KEY;

  15310  3 003624   040100 100400                    MLR     fill='040'O
         3 003625   000117 200011 2                  ADSC9   SAVED_UPDATE             cn=1,n=9
         3 003626   200025 000011                    ADSC9   LU_BUF,,AUTO             cn=0,n=9

     1500    15311    3           LU_BUF.HEAD.SP = ' ';

  15311  3 003627   000067 236000 4                  LDQ     55
         3 003630   200027 552134                    STBQ    GOT_M,'34'O,AUTO

     1501    15312    3           LU_BUF.BUF = SAVED_UPDATE.TEXT;

  15312  3 003631   040100 100400                    MLR     fill='040'O
         3 003632   000121 400122 2                  ADSC9   SAVED_UPDATE+2           cn=2,n=82
         3 003633   200030 000400                    ADSC9   GOT_M+1,,AUTO            cn=0,n=256

     1502    15313    3           LEN = SAVED_UPDATE.ARS;

  15313  3 003634   000117 236000 2                  LDQ     SAVED_UPDATE
         3 003635   000033 772000                    QRL     27
         3 003636   200130 756100                    STQ     LEN,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:222  

     1503    15314    3           CALL DUMP_LU_BUF ALTRET( LU_PRINT_ERR );

  15314  3 003637   004047 701000 3                  TSX1    DUMP_LU_BUF
         3 003640   004016 702000 3                  TSX2    LU_PRINT_ERR

     1504    15315    3           END;

     1505    15316
     1506    15317    2       RETURN;

  15317  3 003641   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 003642   000001 702211                    TSX2  ! 1,X1

     1507    15318
     1508    15319    2   PREPRINT_UPDATES:ENTRY ALTRET;

  15319  3 003643   200020 741300       PREPRINT_UP* STX1  ! USER_BUF$+2,,AUTO

     1509    15320
     1510    15321    2       LU_BUF.HEAD.SP = ' ';

  15321  3 003644   000067 236000 4                  LDQ     55
         3 003645   200027 552134                    STBQ    GOT_M,'34'O,AUTO

     1511    15322    2       READ_FPT.BUF_ = VECTOR( LU_BUF.BUF );

  15322  3 003646   000046 235000 4                  LDA     38
         3 003647   200334 452500                    STP2    TEMP_CODE+2,,AUTO
         3 003650   200334 236100                    LDQ     TEMP_CODE+2,,AUTO
         3 003651   000030 036003                    ADLQ    24,DU
         3 003652   000004 757000 2                  STAQ    READ_FPT+4

     1512    15323    2       BUF_VECT = VECTOR( LU_BUF.BUF );

  15323  3 003653   000046 235000 4                  LDA     38
         3 003654   200334 452500                    STP2    TEMP_CODE+2,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:223  
         3 003655   200334 236100                    LDQ     TEMP_CODE+2,,AUTO
         3 003656   000030 036003                    ADLQ    24,DU
         3 003657   200132 757100                    STAQ    BUF_VECT,,AUTO

     1513    15324    2       UI_SCRATCH_INFO = FILE_INFO_BASE;

  15324  3 003660   000100 100400                    MLR     fill='000'O
         3 003661   000005 000020 1                  ADSC9   FILE_INFO_BASE           cn=0,n=16
         3 003662   200021 000020                    ADSC9   UI_SCRATCH_INFO,,AUTO    cn=0,n=16

     1514    15325
     1515    15326    2       IF ( UI_INFO.DCB$->F$DCB.ASN# = %FILE# )

  15326  3 003663   000027 470400 2                  LDP0    UI_INFO+2
         3 003664   000032 236100                    LDQ     26,,PR0
         3 003665   777000 376007                    ANQ     -512,DL
         3 003666   001000 116007                    CMPQ    512,DL
         3 003667   003672 600000 3                  TZE     s:15329
         3 003670   002000 116007                    CMPQ    1024,DL
         3 003671   003674 601000 3                  TNZ     s:15332

     1516    15327    2          OR ( UI_INFO.DCB$->F$DCB.ASN# = %TAPE# )
     1517    15328    3       THEN DO;

     1518    15329    3           WRITE_TEMP = %FALSE;

  15329  3 003672   200134 450100                    STZ     WRITE_TEMP,,AUTO

     1519    15330    3           END;

  15330  3 003673   003720 710000 3                  TRA     PREPRINT_LOOP

     1520    15331    3       ELSE DO;

     1521    15332    3           UI_SCRATCH_INFO.FAST = %FALSE;

  15332  3 003674   000031 236000 xsym               LDQ     B_VECTNIL+25
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:224  
         3 003675   200024 356100                    ANSQ    PRECORD_FPT,,AUTO

     1522    15333    3           CALL GETDCB( UI_SCRATCH_INFO ) ALTRET ( UI_ERR );

  15333  3 003676   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003677   200140 756100                    STQ     @P_DCB_NAME,,AUTO
         3 003700   200021 631500                    EPPR1   UI_SCRATCH_INFO,,AUTO
         3 003701   200137 451500                    STP1    @P_INFO,,AUTO
         3 003702   002604 701000 3                  TSX1    GETDCB
         3 003703   004023 702000 3                  TSX2    UI_ERR

     1523    15334    3           CALL OPEN( UI_SCRATCH_INFO, ADDR(OPEN_SCRATCH) ) ALTRET ( UI_ERR );

  15334  3 003704   000070 236000 4                  LDQ     56
         3 003705   200336 756100                    STQ     TEMP_CODE+4,,AUTO
         3 003706   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003707   200141 756100                    STQ     @P_OPEN_TYPE,,AUTO
         3 003710   200336 630500                    EPPR0   TEMP_CODE+4,,AUTO
         3 003711   200140 450500                    STP0    @P_DCB_NAME,,AUTO
         3 003712   200021 631500                    EPPR1   UI_SCRATCH_INFO,,AUTO
         3 003713   200137 451500                    STP1    @P_INFO,,AUTO
         3 003714   002067 701000 3                  TSX1    OPEN
         3 003715   004023 702000 3                  TSX2    UI_ERR

     1524    15335    3           WRITE_TEMP = %TRUE;

  15335  3 003716   400000 236003                    LDQ     -131072,DU
         3 003717   200134 756100                    STQ     WRITE_TEMP,,AUTO

     1525    15336    3           END;

     1526    15337
     1527    15338    2   PREPRINT_LOOP:
     1528    15339    3       DO WHILE %TRUE;

  15339  3 003720                       PREPRINT_LO* null
     1529    15340    3           CALL READ( UI_INFO ) ALTRET ( BETTER_BE_EOF );
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:225  

  15340  3 003720   000004 236000 4                  LDQ     4
         3 003721   200137 756100                    STQ     @P_INFO,,AUTO
         3 003722   001507 701000 3                  TSX1    READ
         3 003723   003767 702000 3                  TSX2    BETTER_BE_EOF

     1530    15341    3           LU_BUF.HEAD.KEY = XUU_PARAM.RE_ASCII_KEY.CHAR1_9;

  15341  3 003724   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 003725   040100 100500                    MLR     fill='040'O
         3 003726   000003 000011                    ADSC9   3,,PR0                   cn=0,n=9
         3 003727   200025 000011                    ADSC9   LU_BUF,,AUTO             cn=0,n=9

     1531    15342    3           LEN = ARS;

  15342  3 003730   200013 235100                    LDA     ARS,,AUTO
         3 003731   200130 755100                    STA     LEN,,AUTO

     1532    15343    3           CALL DUMP_LU_BUF ALTRET ( LU_ERR );

  15343  3 003732   004047 701000 3                  TSX1    DUMP_LU_BUF
         3 003733   004034 702000 3                  TSX2    LU_ERR

     1533    15344    3           IF WRITE_TEMP

  15344  3 003734   200134 234100                    SZN     WRITE_TEMP,,AUTO
         3 003735   003720 605000 3                  TPL     PREPRINT_LOOP

     1534    15345    4           THEN DO;

     1535    15346    4               IF ARS ~= 0

  15346  3 003736   200013 235100                    LDA     ARS,,AUTO
         3 003737   003757 600000 3                  TZE     s:15352

     1536    15347    5               THEN DO;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:226  
     1537    15348    5                   VBOUND( BUF_VECT ) = ARS - 1;

  15348  3 003740   200013 236100                    LDQ     ARS,,AUTO
         3 003741   000001 136007                    SBLQ    1,DL
         3 003742   000020 736000                    QLS     16
         3 003743   200132 676100                    ERQ     BUF_VECT,,AUTO
         3 003744   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 003745   200132 656100                    ERSQ    BUF_VECT,,AUTO

     1538    15349    5                   CALL WRITE( UI_SCRATCH_INFO, BUF_VECT ) ALTRET ( LU_ERR );

  15349  3 003746   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003747   200145 756100                    STQ     @P_KEY_,,AUTO
         3 003750   200132 630500                    EPPR0   BUF_VECT,,AUTO
         3 003751   200144 450500                    STP0    @P_WRITE_BUF_,,AUTO
         3 003752   200021 631500                    EPPR1   UI_SCRATCH_INFO,,AUTO
         3 003753   200143 451500                    STP1    @P_INFO,,AUTO
         3 003754   001672 701000 3                  TSX1    WRITE
         3 003755   004034 702000 3                  TSX2    LU_ERR

     1539    15350    5                   END;

  15350  3 003756   003720 710000 3                  TRA     PREPRINT_LOOP

     1540    15351    5               ELSE DO;

     1541    15352    5                   CALL WRITE( UI_SCRATCH_INFO, VECTOR(NIL) ) ALTRET ( LU_ERR );

  15352  3 003757   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 003760   000071 235000 4                  LDA     57
         3 003761   200144 757100                    STAQ    @P_WRITE_BUF_,,AUTO
         3 003762   200021 630500                    EPPR0   UI_SCRATCH_INFO,,AUTO
         3 003763   200143 450500                    STP0    @P_INFO,,AUTO
         3 003764   001672 701000 3                  TSX1    WRITE
         3 003765   004034 702000 3                  TSX2    LU_ERR

     1542    15353    5                   END;
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:227  

     1543    15354    4               END;

     1544    15355    3           END PREPRINT_LOOP;

  15355  3 003766   003720 710000 3                  TRA     PREPRINT_LOOP

  15352  3 003767                       BETTER_BE_E* null
     1545    15356
     1546    15357    2   BETTER_BE_EOF: ;
     1547    15358    2       IF NOT EOF

  15358  3 003767   200007 234100                    SZN     EOF,,AUTO
         3 003770   003772 604000 3                  TMI     s:15363

     1548    15359    3       THEN DO;

     1549    15360    3           GOTO UI_ERR;

  15360  3 003771   004023 710000 3                  TRA     UI_ERR

     1550    15361    3           END;
     1551    15362
     1552    15363    2       IF WRITE_TEMP

  15363  3 003772   200134 234100                    SZN     WRITE_TEMP,,AUTO
         3 003773   004003 605000 3                  TPL     s:15369

     1553    15364    3       THEN DO;

     1554    15365    3           CALL CLEANUP_FILE( UI_INFO ) ALTRET ( UI_ERR );

  15365  3 003774   000004 236000 4                  LDQ     4
         3 003775   200255 756100                    STQ     @P_INFO,,AUTO
         3 003776   003416 701000 3                  TSX1    CLEANUP_FILE
         3 003777   004023 702000 3                  TSX2    UI_ERR

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:228  
     1555    15366    3           UI_INFO = UI_SCRATCH_INFO;

  15366  3 004000   000000 100500                    MLR     fill='000'O
         3 004001   200021 000020                    ADSC9   UI_SCRATCH_INFO,,AUTO    cn=0,n=16
         3 004002   000025 000020 2                  ADSC9   UI_INFO                  cn=0,n=16

     1556    15367    3           END;

     1557    15368
     1558    15369    2       CALL PFIL ( UI_INFO, %#PFIL_BOF ) ALTRET ( UI_ERR );

  15369  3 004003   000020 236000 4                  LDQ     16
         3 004004   200140 756100                    STQ     @P_DCB_NAME,,AUTO
         3 004005   000004 236000 4                  LDQ     4
         3 004006   200137 756100                    STQ     @P_INFO,,AUTO
         3 004007   001776 701000 3                  TSX1    PFIL
         3 004010   004023 702000 3                  TSX2    UI_ERR

     1559    15370
     1560    15371    2       LU_INFO = FILE_INFO_BASE;

  15371  3 004011   000000 100400                    MLR     fill='000'O
         3 004012   000005 000020 1                  ADSC9   FILE_INFO_BASE           cn=0,n=16
         3 004013   000035 000020 2                  ADSC9   LU_INFO                  cn=0,n=16

     1561    15372
     1562    15373    2       RETURN;

  15373  3 004014   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 004015   000001 702211                    TSX2  ! 1,X1

  15371  3 004016                       LU_PRINT_ERR null
     1563    15374
     1564    15375    2   LU_PRINT_ERR: ;
     1565    15376    2       CALL KILL_IO_ERR( %LU_ERR );

  15376  3 004016   000072 236000 4                  LDQ     58
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:229  
         3 004017   200245 756100                    STQ     @P_FILE,,AUTO
         3 004020   003071 701000 3                  TSX1    KILL_IO_ERR
         3 004021   000000 011000                    NOP     0

     1566    15377    2       GOTO BAD_PRINT;

  15377  3 004022   004045 710000 3                  TRA     BAD_PRINT

  15371  3 004023                       UI_ERR       null
     1567    15378
     1568    15379    2   UI_ERR: ;
     1569    15380    2       CALL CLEANUP_FILE( UI_SCRATCH_INFO );

  15380  3 004023   200021 630500                    EPPR0   UI_SCRATCH_INFO,,AUTO
         3 004024   200255 450500                    STP0    @P_INFO,,AUTO
         3 004025   003416 701000 3                  TSX1    CLEANUP_FILE
         3 004026   000000 011000                    NOP     0

     1570    15381    2       CALL KILL_IO_ERR( %UI_ERR );

  15381  3 004027   000022 236000 4                  LDQ     18
         3 004030   200245 756100                    STQ     @P_FILE,,AUTO
         3 004031   003071 701000 3                  TSX1    KILL_IO_ERR
         3 004032   000000 011000                    NOP     0

     1571    15382    2       GOTO BAD_PRINT;

  15382  3 004033   004045 710000 3                  TRA     BAD_PRINT

  15371  3 004034                       LU_ERR       null
     1572    15383
     1573    15384    2   LU_ERR: ;
     1574    15385    2       CALL CLEANUP_FILE( UI_SCRATCH_INFO );

  15385  3 004034   200021 630500                    EPPR0   UI_SCRATCH_INFO,,AUTO
         3 004035   200255 450500                    STP0    @P_INFO,,AUTO
         3 004036   003416 701000 3                  TSX1    CLEANUP_FILE
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:230  
         3 004037   000000 011000                    NOP     0

     1575    15386    2       CALL KILL_IO_ERR( %LU_ERR );

  15386  3 004040   000072 236000 4                  LDQ     58
         3 004041   200245 756100                    STQ     @P_FILE,,AUTO
         3 004042   003071 701000 3                  TSX1    KILL_IO_ERR
         3 004043   000000 011000                    NOP     0

     1576    15387    2       GOTO BAD_PRINT;

  15387  3 004044   004045 710000 3                  TRA     BAD_PRINT

  15387  3 004045                       BAD_PRINT    null
     1577    15388
     1578    15389    2   BAD_PRINT: ;
     1579    15390    2       ALTRETURN;

  15390  3 004045   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 004046   000000 702211                    TSX2  ! 0,X1

     1580    15391
     1581    15392
     1582    15393    2   DUMP_LU_BUF: PROC ALTRET;

  15393  3 004047   200136 741300       DUMP_LU_BUF  STX1  ! WRITE_TEMP+2,,AUTO

     1583    15394
     1584    15395    3   DCL TEMP_VECT VECTOR;
     1585    15396
     1586    15397    3       TEMP_VECT = VECTOR( LU_BUF );

  15397  3 004050   000073 235000 4                  LDA     59
         3 004051   200334 452500                    STP2    TEMP_CODE+2,,AUTO
         3 004052   200334 236100                    LDQ     TEMP_CODE+2,,AUTO
         3 004053   000025 036003                    ADLQ    21,DU
         3 004054   200140 757100                    STAQ    TEMP_VECT,,AUTO
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:231  

     1587    15398    3       VBOUND( TEMP_VECT ) = LEN + LENGTHC( LU_BUF.HEAD ) - 1;

  15398  3 004055   200130 236100                    LDQ     LEN,,AUTO
         3 004056   000013 036007                    ADLQ    11,DL
         3 004057   000020 736000                    QLS     16
         3 004060   200140 676100                    ERQ     TEMP_VECT,,AUTO
         3 004061   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 004062   200140 656100                    ERSQ    TEMP_VECT,,AUTO

     1588    15399    3       CALL WRITE( LU_INFO, TEMP_VECT ) ALTRET ( BAD_LU );

  15399  3 004063   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 004064   200145 756100                    STQ     @P_KEY_,,AUTO
         3 004065   200140 630500                    EPPR0   TEMP_VECT,,AUTO
         3 004066   200144 450500                    STP0    @P_WRITE_BUF_,,AUTO
         3 004067   000074 236000 4                  LDQ     60
         3 004070   200143 756100                    STQ     @P_INFO,,AUTO
         3 004071   001672 701000 3                  TSX1    WRITE
         3 004072   004075 702000 3                  TSX2    BAD_LU

     1589    15400    3       RETURN;

  15400  3 004073   200136 221300                    LDX1  ! WRITE_TEMP+2,,AUTO
         3 004074   000001 702211                    TSX2  ! 1,X1

  15398  3 004075                       BAD_LU       null
     1590    15401
     1591    15402    3   BAD_LU: ;
     1592    15403    3       ALTRETURN;

  15403  3 004075   200136 221300                    LDX1  ! WRITE_TEMP+2,,AUTO
         3 004076   000000 702211                    TSX2  ! 0,X1

     1593    15404
     1594    15405    3   END DUMP_LU_BUF;
     1595    15406
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:232  
     1596    15407    2   END PRINT_UPDATE;
     1597    15408
     1598    15409        %PAGE( ARG=SOURCE_OUT, PAGE=YES );

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:233  
             15421    2   /*******************************************************************************
             15422    2   *                                                                              *
             15423    2   *        SOURCE_OUT              SOURCE_OUT                                       *
             15424    2   *                                                                              *
             15425    2   *******************************************************************************/

     1599    15429        /*N* Try to help this out some by using REC_IO_ERR for recoverable
     1600    15430            sorts of problems and doing something intelligent about leaving
     1601    15431            things in a usable state. Also need to report a message saying
     1602    15432            what is being done.
     1603    15433        */
     1604    15434    1   SOURCE_OUT: PROC ALTRET;

  15434  3 004077   200020 741300       SOURCE_OUT   STX1  ! USER_BUF$+2,,AUTO

     1605    15435
     1606    15436        %FPT_OPEN( FPTN=OPEN_SO, STCLASS="CONSTANT", FUN=CREATE );
     1607    15545        %VLP_NAME( FPTN=SO_DCB_NAME, STCLASS="CONSTANT ALIGNED", NAME='M$SO' );
     1608    15572    2   DCL TEMP_CHAR8 CHAR(8) DALIGNED;
     1609    15573    2   DCL 1 KEY ALIGNED,
     1610    15574    2         2 LEN UBIN BYTE CALIGNED,
     1611    15575    2         2 K UBIN(27) UNAL;
     1612    15576
     1613    15577    2       IF XUU_PARAM.FLAGS.INCLUDE#

  15577  3 004100   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 004101   000000 236100                    LDQ     0,,PR0
         3 004102   100000 316003                    CANQ    32768,DU
         3 004103   004105 600000 3                  TZE     s:15580

     1614    15578    2       THEN RETURN;

  15578  3 004104   000001 702211                    TSX2  ! 1,X1

     1615    15579
     1616    15580    2       IF SO_INFO.DCB# = DCBNUM(NIL)

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:234  
  15580  3 004105   000034 720000 2                  LXL0    SO_INFO+3
         3 004106   004146 601000 3                  TNZ     s:15595

     1617    15581    3       THEN DO;

     1618    15582    3           CALL GETDCB( SO_INFO, SO_DCB_NAME ) ALTRET ( BAD_SOURCE_OUT );

  15582  3 004107   000075 236000 4                  LDQ     61
         3 004110   200140 756100                    STQ     TEMP_VECT,,AUTO
         3 004111   000066 236000 4                  LDQ     54
         3 004112   200137 756100                    STQ     @P_INFO,,AUTO
         3 004113   002604 701000 3                  TSX1    GETDCB
         3 004114   004232 702000 3                  TSX2    BAD_SOURCE_OUT

     1619    15583    3           SO_INFO.FAST = %FALSE;

  15583  3 004115   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 004116   000034 356000 2                  ANSQ    SO_INFO+3

     1620    15584    3           IF NOT ( SO_INFO.DCB$->F$DCB.FCD# )

  15584  3 004117   000033 470400 2                  LDP0    SO_INFO+2
         3 004120   000031 236100                    LDQ     25,,PR0
         3 004121   020000 316007                    CANQ    8192,DL
         3 004122   004137 601000 3                  TNZ     s:15589

     1621    15585    4           THEN DO;

     1622    15586    4               CALL OPEN( SO_INFO, ADDR(OPEN_SO) ) ALTRET ( BAD_SOURCE_OUT );

  15586  3 004123   000076 236000 4                  LDQ     62
         3 004124   200337 756100                    STQ     TEMP_CODE+5,,AUTO
         3 004125   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 004126   200141 756100                    STQ     @P_OPEN_TYPE,,AUTO
         3 004127   200337 631500                    EPPR1   TEMP_CODE+5,,AUTO
         3 004130   200140 451500                    STP1    TEMP_VECT,,AUTO
         3 004131   000066 236000 4                  LDQ     54
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:235  
         3 004132   200137 756100                    STQ     @P_INFO,,AUTO
         3 004133   002067 701000 3                  TSX1    OPEN
         3 004134   004232 702000 3                  TSX2    BAD_SOURCE_OUT

     1623    15587    4               SO_INFO.RECORD_COUNT = 1;

  15587  3 004135   000001 235007                    LDA     1,DL
         3 004136   000032 755000 2                  STA     SO_INFO+1

     1624    15588    4               END;

     1625    15589    3           IF SO_INFO.DCB$->F$DCB.ORG# = %KEYED#

  15589  3 004137   000033 470400 2                  LDP0    SO_INFO+2
         3 004140   000032 236100                    LDQ     26,,PR0
         3 004141   777000 376003                    ANQ     -512,DU
         3 004142   002000 116003                    CMPQ    1024,DU
         3 004143   004146 601000 3                  TNZ     s:15595

     1626    15590    4           THEN DO;

     1627    15591    4               SO_INFO.KEY_TYPE = %#EDIT_KEY;

  15591  3 004144   000001 236003                    LDQ     1,DU
         3 004145   000034 552020 2                  STBQ    SO_INFO+3,'20'O

     1628    15592    4               END;

     1629    15593    3           END;

     1630    15594
     1631    15595    2       XUU_PARAM.RE_ASCII_KEY.CHAR10 = ' ';

  15595  3 004146   200003 470500                    LDP0    @XUU_PARAM,,AUTO
         3 004147   000040 236003                    LDQ     32,DU
         3 004150   000005 552120                    STBQ    5,'20'O,PR0

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:236  
     1632    15596
     1633    15597    2       IF SO_INFO.KEY_TYPE = %#CONSEC

  15597  3 004151   000034 236000 2                  LDQ     SO_INFO+3
         3 004152   000777 376003                    ANQ     511,DU
         3 004153   000002 116003                    CMPQ    2,DU
         3 004154   004174 601000 3                  TNZ     s:15604

     1634    15598    3       THEN DO;

     1635    15599    3           CALL BINCHAR( TEMP_CHAR8, SO_INFO.RECORD_COUNT );

  15599  3 004155   000100 301400                    BTD
         3 004156   000032 000004 2                  NDSC9   SO_INFO+1                cn=0,s=lsgnf,sf=0,n=4
         3 004157   200022 030010                    NDSC9   TEMP_CHAR8,,AUTO         cn=0,s=nosgn,sf=0,n=8

     1636    15600    3          CALL EDITCHAR( XUU_PARAM.RE_ASCII_KEY.CHAR1_9, 0, 9, SEQ_MOPS, TEMP_CHAR8 );

  15600  3 004160   100000 024500                    MVNE
         3 004161   200022 030010                    NDSC9   TEMP_CHAR8,,AUTO         cn=0,s=nosgn,sf=0,n=8
         3 004162   000013 000003 1                  ADSC9   SEQ_MOPS                 cn=0,n=3
         3 004163   000003 000011                    ADSC9   3,,PR0                   cn=0,n=9

     1637    15601    3           CALL WRITE( SO_INFO ) ALTRET ( BAD_SOURCE_OUT );

  15601  3 004164   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 004165   000001 235000 xsym               LDA     B_VECTNIL+1
         3 004166   200144 757100                    STAQ    @P_WRITE_BUF_,,AUTO
         3 004167   000066 236000 4                  LDQ     54
         3 004170   200143 756100                    STQ     @P_INFO,,AUTO
         3 004171   001672 701000 3                  TSX1    WRITE
         3 004172   004232 702000 3                  TSX2    BAD_SOURCE_OUT

     1638    15602    3           END;

  15602  3 004173   004230 710000 3                  TRA     s:15612

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:237  
     1639    15603    3       ELSE DO;

     1640    15604    3           CALL BINCHAR( TEMP_CHAR8, SO_INFO.RECORD_COUNT*1000 );

  15604  3 004174   000032 236000 2                  LDQ     SO_INFO+1
         3 004175   001750 402007                    MPY     1000,DL
         3 004176   200334 756100                    STQ     TEMP_CODE+2,,AUTO
         3 004177   000100 301500                    BTD
         3 004200   200334 000004                    NDSC9   TEMP_CODE+2,,AUTO        cn=0,s=lsgnf,sf=0,n=4
         3 004201   200022 030010                    NDSC9   TEMP_CHAR8,,AUTO         cn=0,s=nosgn,sf=0,n=8

     1641    15605    3          CALL EDITCHAR( XUU_PARAM.RE_ASCII_KEY.CHAR1_9, 0, 9, EDIT_MOPS, TEMP_CHAR8 )
             15605                    ;

  15605  3 004202   100000 024500                    MVNE
         3 004203   200022 030010                    NDSC9   TEMP_CHAR8,,AUTO         cn=0,s=nosgn,sf=0,n=8
         3 004204   000011 000005 1                  ADSC9   EDIT_MOPS                cn=0,n=5
         3 004205   000003 000011                    ADSC9   3,,PR0                   cn=0,n=9

     1642    15606    3           KEY.LEN = 3;

  15606  3 004206   003000 236003                    LDQ     1536,DU
         3 004207   200024 552140                    STBQ    KEY,'40'O,AUTO

     1643    15607    3           KEY.K = SO_INFO.RECORD_COUNT * 1000;

  15607  3 004210   000032 236000 2                  LDQ     SO_INFO+1
         3 004211   001750 402007                    MPY     1000,DL
         3 004212   200024 552134                    STBQ    KEY,'34'O,AUTO

     1644    15608
     1645    15609    3           CALL WRITE( SO_INFO, ,VECTOR(KEY) ) ALTRET ( BAD_SOURCE_OUT );

  15609  3 004213   777640 235007                    LDA     -96,DL
         3 004214   200334 452500                    STP2    TEMP_CODE+2,,AUTO
         3 004215   200334 236100                    LDQ     TEMP_CODE+2,,AUTO
         3 004216   000024 036003                    ADLQ    20,DU
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:238  
         3 004217   200340 757100                    STAQ    TEMP_CODE+6,,AUTO
         3 004220   200340 631500                    EPPR1   TEMP_CODE+6,,AUTO
         3 004221   200145 451500                    STP1    @P_KEY_,,AUTO
         3 004222   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 004223   200144 756100                    STQ     @P_WRITE_BUF_,,AUTO
         3 004224   000066 236000 4                  LDQ     54
         3 004225   200143 756100                    STQ     @P_INFO,,AUTO
         3 004226   001672 701000 3                  TSX1    WRITE
         3 004227   004232 702000 3                  TSX2    BAD_SOURCE_OUT

     1646    15610    3           END;

     1647    15611
     1648    15612    2       RETURN;

  15612  3 004230   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 004231   000001 702211                    TSX2  ! 1,X1

  15609  3 004232                       BAD_SOURCE_* null
     1649    15613
     1650    15614    2   BAD_SOURCE_OUT: ;
     1651    15615    2       ALTRETURN;

  15615  3 004232   200020 221300                    LDX1  ! USER_BUF$+2,,AUTO
         3 004233   000000 702211                    TSX2  ! 0,X1

SI_DCB_NAME
 Sect OctLoc
   1     000   004115 044123   111*** ******                                    .M$SI...

UI_DCB_NAME
 Sect OctLoc
   1     002   004115 044125   111*** ******                                    .M$UI...

ERROR_CODE_BASE
 Sect OctLoc
   1     004   302525 000000                                                    ....
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:239  

FILE_INFO_BASE
 Sect OctLoc
   1     005   000000 006014   000000 000000   000000 006014   000002 000000    ................

EDIT_MOPS
 Sect OctLoc
   1     011   104321 070207   323*** ******                                    D.8.....

SEQ_MOPS
 Sect OctLoc
   1     013   021107 321***                                                    .G..

SEARCH_TABLE
 Sect OctLoc
   1     014   003003 003003   003003 003003   003002 003003   003003 003003    ................
   1     020   003003 003003   003003 003003   003003 003003   003003 003003    ................
   1     024   002003 003003   003003 003003   003003 003003   001003 003003    ................
   1     030   000000 000000   000000 000000   000000 003003   003003 003003    ................
   1     034   003003 003003   003003 003003   003003 003003   003003 003003    ................
   1     210*  003003 003003   003003 003003   003003 003003   003003 003003    ................

CONST_WRITE_FPT
 Sect OctLoc
   1     214   000003 777640   000224 006000   000000 177640   000000 006014    ................
   1     220   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     224   000000 400400   000000 000000   000000 000000   000000 000000    ................

CONST_PFIL_FPT
 Sect OctLoc
   1     230   000001 777640   000232 006000   000000 400000   000000 000000    ................

CONST_OPEN_FPT
 Sect OctLoc
   1     234   000025 777640   000300 006000   000000 177640   000000 006014    ................
   1     240   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     300*  000000 000042   000000 000000   252525 000000   000040 252520    ..."......... ..
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:240  
   1     304   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     310   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     314   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     320   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     324   000000 000000   ****** ******                                    ........

CONST_CLOSE_FPT
 Sect OctLoc
   1     326   000003 777640   000360 006000   000000 177640   000000 006014    ................
   1     332   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     356*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   1     362   000220 000000   000000 000000                                    ........

CONST_PRECORD_FPT
 Sect OctLoc
   1     364   000003 777640   000372 006000   000000 177640   000000 006014    ................
   1     370   000000 177640   000000 006014   000000 000000   000000 000000    ................
   1     374   000000 000000   0***** ******                                    ........

CONST_GETDCB_FPT
 Sect OctLoc
   1     376   000001 777640   000404 006000   000000 177640   000000 006014    ................
   1     402   000000 177640   000000 006014   000000 000000   000000 000000    ................

CONST_RELDCB_FPT
 Sect OctLoc
   1     406   000001 777640   000410 006000   000000 000000   000000 000000    ................

CONST_XSA_PARAM
 Sect OctLoc
   1     412   000000 000000   000000 000000   000000 177640   000000 006014    ................
   1     416   000000 177640   000000 006014   125116 106101   123124 041077    ........UNFAST!?
   1     422   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     426   000000 000000   040000 000000                                    .... ...

OPEN_SCRATCH
 Sect OctLoc
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:241  
   1     430   000025 777640   000474 006000   000000 177640   000000 006014    ................
   1     434   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     474*  000000 000042   000000 003001   252525 001000   000040 252520    ..."......... ..
   1     500   000040 040040   000000 000001   000000 777777   000000 000000    .   ............
   1     504   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     510   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     514   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     520   000000 000000   ****** ******                                    ........

OPEN_SO
 Sect OctLoc
   1     522   000025 777640   000566 006000   000000 177640   000000 006014    ................
   1     526   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     566*  000000 000042   000000 003000   252525 000000   000040 252520    ..."......... ..
   1     572   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     576   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     602   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     606   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     612   000000 000000   ****** ******                                    ........

SO_DCB_NAME
 Sect OctLoc
   1     614   004115 044123   117*** ******                                    .M$SO...

(unnamed)
 Sect OctLoc
   1     616   105116 104040                                                    END

READ_FPT
 Sect OctLoc
   2     000   000005 777640   000010 006000   000000 177640   000000 006014    ................
   2     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   2     010   000000 500000   000000 000000   000000 000000   000000 000000    ................
   2     014   000000 000000   000000 000000                                    ........

(unnamed)
 Sect OctLoc
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:242  
   2     016   000000 177640   000000 006014                                    ........

SI_INFO
 Sect OctLoc
   2     021   000000 006014   000000 000000   000000 006014   000002 000000    ................

UI_INFO
 Sect OctLoc
   2     025   000000 006014   000000 000000   000000 006014   000002 000000    ................

SO_INFO
 Sect OctLoc
   2     031   000000 006014   000000 000000   000000 006014   000002 000000    ................

LU_INFO
 Sect OctLoc
   2     035   000000 006014   000000 000000   000000 006014   000002 000000    ................

INCL_INFO
 Sect OctLoc
   2     041   000000 006014   000000 000000   000000 006014   000002 000000    ................
   2     105*  000000 006014   000000 000000   000000 006014   000002 000000    ................

NRECS_IN_SOURCE
 Sect OctLoc
   2     111   000000 000000                                                    ....

CURRENT_STATE
 Sect OctLoc
   2     112   000000 ******                                                    ....

INCL_SAVE_STATE
 Sect OctLoc
   2     116   000000 ******                                                    ....

SAVED_UPDATE
 Sect OctLoc
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:243  
   2     117   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
   4     000   000000 000154   000000 006000   000021 006000   000114 006000    ...l.........L..
   4     004   000025 006000   053040 040040   000041 006000   000000 000153    ....+   .!.....k
   4     010   000002 006000   000007 006000   000000 000146   000012 006000    ...........f....
   4     014   000000 000150   000014 006000   000005 006000   000000 006000    ...h............
   4     020   000003 006000   000002 006000   000004 006000   000000 006003    ................
   4     024   757777 777777   000006 006000   000000 177640   000000 006014    ................
   4     030   000000 000160   000030 006000   000030 006000   052040 040040    ...p........*
   4     034   000000 000157   000034 006000   000000 000152   000036 006000    ...o.......j....
   4     040   000000 000145   000040 006000   000000 000161   000042 006000    ...e. .....q."..
   4     044   000000 000144   000044 006000   000077 777640   000000 006000    ...d.$...?......
   4     050   000003 777640   000001 777640   777777 377777   000000 000147    ...............g
   4     054   000053 006000   000025 777640   000003 400000   577777 777777    .+..............
   4     060   000016 006000   000002 006000   000000 000155   000062 006000    ...........m.2..
   4     064   000000 000156   000064 006000   000031 006000   000040 040040    ...n.4.......
   4     070   000430 006000   000026 006000   000007 006000   000102 777640    .............B..
   4     074   000035 006000   000614 006000   000522 006000                    ............
     1652    15616
     1653    15617    2   END SOURCE_OUT;
     1654    15618
     1655    15619    1   END XUU$READ;

PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:244  
--  Include file information  --

   F$CP6V_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XUU_MACROS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUU$READ.

   Procedure XUU$READ requires 2204 words for executable code.
   Procedure XUU$READ requires 226 words of local(AUTO) storage.

    No errors detected in file XUU$READ.:E05TSI    .
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:245  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:246  
          MINI XREF LISTING

ALLOC_TYPE IN PROCEDURE OPEN
     13915**DCL     13938<<ASSIGN  13940<<ASSIGN  13942<<ASSIGN  13944<<ASSIGN  13948<<ASSIGN  13972<<ASSIGN
     13974<>CALL
ALT_FLAG IN PROCEDURE CLEANUP
     15069**DCL     15071<<ASSIGN  15080<<ASSIGN  15087<<ASSIGN  15093<<ASSIGN  15099<<ASSIGN  15108>>IF
ALT_FLAG IN PROCEDURE CLEANUP_FILE
     15027**DCL     15029<<ASSIGN  15033<<ASSIGN  15038<<ASSIGN  15041>>IF
ALT_FLAG IN PROCEDURE READ
     13146**DCL     13149<<ASSIGN  13173<<ASSIGN  13179<<ASSIGN  13208>>IF
ARS
     12399**DCL     12326--IMP-SIZ 12465>>IF      12465>>IF      12492>>ASSIGN  12494>>ASSIGN  12494>>ASSIGN
     12502>>IF      12502>>IF      12524>>ASSIGN  12526>>ASSIGN  12526>>ASSIGN  12591>>ASSIGN  12592>>ASSIGN
     12597>>IF      12599>>ASSIGN  12599>>ASSIGN  12964>>IF      12970>>IF      12970>>IF      12975>>IF
     12975>>IF      12977>>IF      12977>>IF      12996>>CALLBLT 13000>>CALLBLT 13004>>CALLBLT 13012>>CALLBLT
     13156<<ASSIGN  13160<<ASSIGN  13176<<ASSIGN  13343>>IF      13345>>ASSIGN  14855>>ASSIGN  14918>>ASSIGN
     15298>>ASSIGN  15300>>ASSIGN  15342>>ASSIGN  15346>>IF      15348>>ASSIGN
B$ALT.CODE
     12232**DCL     12232--REDEF   12233--REDEF   12233--REDEF
B$ALT.ERR
     12233**DCL     13165>>ASSIGN  13374>>ASSIGN  13499>>ASSIGN  14006>>ASSIGN  14179>>ASSIGN  14334>>ASSIGN
     14463>>ASSIGN  14567>>ASSIGN
B$ALT.ERR.ERR#
     12234**DCL     12234--REDEF
B$ALT.EVID
     12233**DCL     12233--REDEF   12233--REDEF
B$TCB.ALT$
     12228**DCL     13165>>ASSIGN  13374>>ASSIGN  13499>>ASSIGN  14006>>ASSIGN  14179>>ASSIGN  14334>>ASSIGN
     14463>>ASSIGN  14567>>ASSIGN
B$TCB$
     11798**DCL     13165>>ASSIGN  13374>>ASSIGN  13499>>ASSIGN  14006>>ASSIGN  14179>>ASSIGN  14334>>ASSIGN
     14463>>ASSIGN  14567>>ASSIGN
BAD_CLEANUP
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:247  
     12801**LABEL   12783--CALLALT
BAD_FAST_OPEN IN PROCEDURE OPEN
     14006**LABEL   13966--CALLALT
BAD_FAST_PFIL IN PROCEDURE PFIL
     13499**LABEL   13488--CALLALT
BAD_FAST_PRECORD IN PROCEDURE PRECORD
     14334**LABEL   14322--CALLALT
BAD_FAST_READ IN PROCEDURE READ
     13165**LABEL   13155--CALLALT
BAD_FAST_WRITE IN PROCEDURE WRITE
     13374**LABEL   13363--CALLALT
BAD_GET IN PROCEDURE OPEN
     14012**LABEL   13953--CALLALT
BAD_GETDCB IN PROCEDURE GETDCB
     14457**LABEL   14453--CALLALT
BAD_LU IN PROCEDURE DUMP_LU_BUF
     15398**LABEL   15399--CALLALT
BAD_NORMAL_OPEN IN PROCEDURE OPEN
     14001**LABEL   13962--CALLALT
BAD_NORMAL_PFIL IN PROCEDURE PFIL
     13494**LABEL   13491--CALLALT
BAD_NORMAL_PRECORD IN PROCEDURE PRECORD
     14329**LABEL   14326--CALLALT
BAD_NORMAL_READ IN PROCEDURE READ
     13160**LABEL   13159--CALLALT
BAD_NORMAL_WRITE IN PROCEDURE WRITE
     13369**LABEL   13366--CALLALT
BAD_OPEN IN PROCEDURE OPEN
     14012**LABEL   13929--GOTO    14007--GOTO
BAD_PFIL IN PROCEDURE PFIL
     13503**LABEL   13500--GOTO
BAD_PRECORD IN PROCEDURE PRECORD
     14338**LABEL   14335--GOTO
BAD_PRINT IN PROCEDURE PRINT_UPDATE
     15387**LABEL   15377--GOTO    15382--GOTO    15387--GOTO
BAD_READ IN PROCEDURE READ
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:248  
     13169**LABEL   13166--GOTO
BAD_RELDCB IN PROCEDURE RELDCB
     14563**LABEL   14560--CALLALT
BAD_SOURCE_OUT IN PROCEDURE SOURCE_OUT
     15609**LABEL   15582--CALLALT 15586--CALLALT 15601--CALLALT 15609--CALLALT
BAD_UPDATE
     12611**LABEL   12467--CALLALT 12504--CALLALT
BAD_UPDATE IN PROCEDURE PARSE_AND_CHECK_PLUS
     13066**LABEL   12966--CALLALT 12979--CALLALT 12983--CALLALT 13024--CALLALT 13041--CALLALT 13046--CALLALT
     13062--CALLALT
BAD_WRITE IN PROCEDURE WRITE
     13378**LABEL   13375--GOTO
BASED_BUFFER
     12326**DCL     12465>>IF      12494>>ASSIGN  12502>>IF      12526>>ASSIGN  12970>>IF      12975>>IF
     12977>>IF      12996>>CALLBLT 13000>>CALLBLT 13004>>CALLBLT 13012>>CALLBLT 13345--ASSIGN  15298>>ASSIGN
BASED_CHARS
     12327**DCL     12599<<ASSIGN
BASED_OPEN_FPT IN PROCEDURE OPEN
     13853**DCL     13924>>ASSIGN
BASED_OPEN_FPT.ACSVEH_ IN PROCEDURE OPEN
     13855**DCL     13856--REDEF
BASED_OPEN_FPT.ALTKEYS_ IN PROCEDURE OPEN
     13861**DCL     13862--REDEF   13862--REDEF
BASED_OPEN_FPT.HDR_ IN PROCEDURE OPEN
     13860**DCL     13861--REDEF
BASED_OPEN_FPT.TAB_ IN PROCEDURE OPEN
     13859**DCL     13860--REDEF
BASED_OPEN_FPT.UHL_ IN PROCEDURE OPEN
     13853**DCL     13854--REDEF   13854--REDEF
BASED_OPEN_FPT.V.FSN# IN PROCEDURE OPEN
     13893**DCL     13893--REDEF   13893--REDEF
BASED_OPEN_FPT.V_ IN PROCEDURE OPEN
     13853**DCL     13925>>ASSIGN
BASED_OPEN_FPT.WSN_ IN PROCEDURE OPEN
     13859**DCL     13859--REDEF
BASED_OPEN_V IN PROCEDURE OPEN
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:249  
     13898**DCL     13925>>ASSIGN
BASED_OPEN_V.FSN IN PROCEDURE OPEN
     13908**DCL     13908--REDEF   13909--REDEF
BETTER_BE_EOF IN PROCEDURE PRINT_UPDATE
     15352**LABEL   15340--CALLALT
BUF_ IN PROCEDURE OPEN
     13912**DCL     13974<>CALL    13976<<ASSIGN  13978>>ASSIGN  13981<>CALL    13983<<ASSIGN  13985>>ASSIGN
BUF_VECT IN PROCEDURE PRINT_UPDATE
     15291**DCL     15323<<ASSIGN  15348<<ASSIGN  15349<>CALL
CLEANUP
     15066**PROC    12783--CALL    14726--CALL    14767--CALL
CLEANUP_FILE
     14991**PROC    15076--CALL    15084--CALL    15090--CALL    15096--CALL    15365--CALL    15380--CALL
     15385--CALL
CLOSE
     14042**PROC    12541--CALL    12788--CALL    12991--CALL    15031--CALL
CLOSE_ERR IN PROCEDURE CLOSE
     14163**DCL     14165<<ASSIGN  14178<<ASSIGN  14185<<ASSIGN  14203<<ASSIGN  14209>>IF
CLOSE_FPT IN PROCEDURE CLOSE
     14143**DCL     14169<<ASSIGN  14176<>CALL    14183<>CALL
CLOSE_FPT.SN_ IN PROCEDURE CLOSE
     14143**DCL     14143--REDEF
CLOSE_FPT.UTL_ IN PROCEDURE CLOSE
     14144**DCL     14144--REDEF
CLOSE_FPT.V IN PROCEDURE CLOSE
     14148**DCL     14170--ASSIGN
CLOSE_FPT.V.DCB# IN PROCEDURE CLOSE
     14149**DCL     14171<<ASSIGN
CLOSE_FPT.V.EXPIRE# IN PROCEDURE CLOSE
     14158**DCL     14158--REDEF
CLOSE_FPT.V.TYPE# IN PROCEDURE CLOSE
     14156**DCL     14156--REDEF
CLOSE_FPT.V.XTNSIZE# IN PROCEDURE CLOSE
     14153**DCL     14153--REDEF   14155--REDEF
CLOSE_FPT.V_ IN PROCEDURE CLOSE
     14143**DCL     14170<<ASSIGN
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:250  
COMMA_POS IN PROCEDURE PARSE_AND_CHECK_PLUS
     12953**DCL     12960<<ASSIGN  13003<<ASSIGN  13004>>CALLBLT 13005>>IF      13012>>CALLBLT 13012>>CALLBLT
     13032>>IF
CONSEC IN PROCEDURE READ
     13199**LABEL   13199--GOTO
CONST_CLOSE_FPT IN PROCEDURE CLOSE
     14101**DCL     14169>>ASSIGN
CONST_CLOSE_FPT.SN_ IN PROCEDURE CLOSE
     14101**DCL     14101--REDEF
CONST_CLOSE_FPT.UTL_ IN PROCEDURE CLOSE
     14102**DCL     14102--REDEF
CONST_CLOSE_FPT.V IN PROCEDURE CLOSE
     14106**DCL     14101--DCLINIT
CONST_CLOSE_FPT.V.EXPIRE# IN PROCEDURE CLOSE
     14116**DCL     14116--REDEF
CONST_CLOSE_FPT.V.TYPE# IN PROCEDURE CLOSE
     14114**DCL     14114--REDEF
CONST_CLOSE_FPT.V.XTNSIZE# IN PROCEDURE CLOSE
     14111**DCL     14111--REDEF   14113--REDEF
CONST_GETDCB_FPT IN PROCEDURE GETDCB
     14420**DCL     14442>>ASSIGN
CONST_GETDCB_FPT.V IN PROCEDURE GETDCB
     14421**DCL     14420--DCLINIT
CONST_OPEN_FPT IN PROCEDURE OPEN
     13635**DCL     13919>>ASSIGN
CONST_OPEN_FPT.ACSVEH_ IN PROCEDURE OPEN
     13637**DCL     13638--REDEF
CONST_OPEN_FPT.ALTKEYS_ IN PROCEDURE OPEN
     13643**DCL     13644--REDEF   13644--REDEF
CONST_OPEN_FPT.HDR_ IN PROCEDURE OPEN
     13642**DCL     13643--REDEF
CONST_OPEN_FPT.TAB_ IN PROCEDURE OPEN
     13641**DCL     13642--REDEF
CONST_OPEN_FPT.UHL_ IN PROCEDURE OPEN
     13635**DCL     13636--REDEF   13636--REDEF
CONST_OPEN_FPT.V IN PROCEDURE OPEN
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:251  
     13644**DCL     13635--DCLINIT
CONST_OPEN_FPT.V.FSN# IN PROCEDURE OPEN
     13675**DCL     13675--REDEF   13675--REDEF
CONST_OPEN_FPT.WSN_ IN PROCEDURE OPEN
     13641**DCL     13641--REDEF
CONST_PFIL_FPT IN PROCEDURE PFIL
     13453**DCL     13473>>ASSIGN
CONST_PFIL_FPT.V IN PROCEDURE PFIL
     13453**DCL     13453--DCLINIT
CONST_PRECORD_FPT IN PROCEDURE PRECORD
     14282**DCL     14315>>ASSIGN
CONST_PRECORD_FPT.V IN PROCEDURE PRECORD
     14284**DCL     14282--DCLINIT
CONST_RELDCB_FPT IN PROCEDURE RELDCB
     14535**DCL     14557>>ASSIGN
CONST_RELDCB_FPT.V IN PROCEDURE RELDCB
     14535**DCL     14535--DCLINIT
CONST_WRITE_FPT IN PROCEDURE WRITE
     13290**DCL     13337>>ASSIGN
CONST_WRITE_FPT.STATION_ IN PROCEDURE WRITE
     13292**DCL     13292--REDEF
CONST_WRITE_FPT.V IN PROCEDURE WRITE
     13293**DCL     13290--DCLINIT
CONST_WRITE_FPT.V.DVBYTE.VFC# IN PROCEDURE WRITE
     13299**DCL     13299--REDEF
CONST_XSA_PARAM IN PROCEDURE GET_XSA_PARAM
     14603**DCL     14647>>ASSIGN
CONST_XSA_PARAM.EOMCHAR# IN PROCEDURE GET_XSA_PARAM
     14619**DCL     14620--REDEF
CONST_XSA_PARAM.SIG1 IN PROCEDURE GET_XSA_PARAM
     14613**DCL     14613--REDEF
CONST_XSA_PARAM.SIG2 IN PROCEDURE GET_XSA_PARAM
     14613**DCL     14614--REDEF
CURRENT_STATE
     12197**DCL     12434>>DOCASE  12447<<ASSIGN  12468>>IF      12472<<ASSIGN  12480<<ASSIGN  12485<<ASSIGN
     12488>>IF      12507<<ASSIGN  12520>>IF      12545<<ASSIGN  12551>>IF      12569<<ASSIGN  12580<<ASSIGN
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:252  
     12655>>IF      12675>>ASSIGN  12688<<ASSIGN  12696>>IF      12711<<ASSIGN  12735<<ASSIGN  12792<<ASSIGN
     12800>>IF      12800>>IF      12803<<ASSIGN  12916<<ASSIGN  12992<<ASSIGN  13048<<ASSIGN  15072<<ASSIGN
DUMP_LU_BUF IN PROCEDURE PRINT_UPDATE
     15393**PROC    15301--CALL    15314--CALL    15343--CALL
EDIT_MOPS
     11956**DCL     13194>>CALLBLT 15605>>CALLBLT
EOF
     12395**DCL     12539>>IF      12567>>IF      12577>>IF      12611>>IF      12986>>IF      13148<<ASSIGN
     13172<<ASSIGN  13187>>IF      14314<<ASSIGN  14341<<ASSIGN  15358>>IF
ERROR_CODE
     12361**DCL     13165<<ASSIGN  13169<<ASSIGN  13177<>CALL    13374<<ASSIGN  13378<<ASSIGN  13499<<ASSIGN
     13503<<ASSIGN  14006<<ASSIGN  14010<<ASSIGN  14179<<ASSIGN  14186<<ASSIGN  14334<<ASSIGN  14338<<ASSIGN
     14463<<ASSIGN  14567<<ASSIGN  14919<>CALL    14922<>CALL    14931>>ASSIGN  14935>>ASSIGN  14940>>ASSIGN
     14945>>ASSIGN  14950>>ASSIGN  14955>>ASSIGN  14960>>ASSIGN
ERROR_CODE.ERR#
     12391**DCL     12738>>IF      13172>>ASSIGN  13174>>IF      14341>>ASSIGN
ERROR_CODE_BASE
     11887**DCL     14846>>ASSIGN
ERROR_SET
     12400**DCL     12424<<ASSIGN  12649<<ASSIGN  12779<<ASSIGN  14553>>IF      14866>>IF      14868<<ASSIGN
     14910>>IF      14929<<ASSIGN  15041>>IF
F$DCB.ACTPOS
     12271**DCL     12271--REDEF
F$DCB.ARS#
     12245**DCL     12245--REDEF   13160>>ASSIGN
F$DCB.ASN#
     12260**DCL     12704>>IF      15326>>IF      15326>>IF
F$DCB.ATTR
     12264**DCL     12265--REDEF
F$DCB.BORROW
     12279**DCL     12279--REDEF   12279--REDEF   12279--REDEF
F$DCB.DCBNAME.L
     12293**DCL     12293--IMP-SIZ
F$DCB.EOMCHAR#
     12249**DCL     12249--REDEF
F$DCB.FCD#
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:253  
     12258**DCL     14172>>IF      15584>>IF
F$DCB.FLDID
     12274**DCL     12274--REDEF
F$DCB.FORM$
     12268**DCL     12268--REDEF
F$DCB.FSECT
     12284**DCL     12284--REDEF
F$DCB.FSN#
     12261**DCL     12261--REDEF   12261--REDEF   12262--REDEF
F$DCB.HEADER$
     12267**DCL     12267--REDEF
F$DCB.IXTNSIZE#
     12265**DCL     12265--REDEF
F$DCB.LASTSTA$
     12254**DCL     12254--REDEF
F$DCB.LVL
     12280**DCL     12280--REDEF
F$DCB.NAME#.C
     12255**DCL     12255--REDEF
F$DCB.NOEOF
     12277**DCL     12277--REDEF
F$DCB.NRECS#
     12266**DCL     12266--REDEF   12706>>ASSIGN
F$DCB.NRECX
     12285**DCL     12285--REDEF
F$DCB.OHDR
     12277**DCL     12277--REDEF
F$DCB.ORG#
     12260**DCL     12260--REDEF   13963>>ASSIGN  13989>>ASSIGN  15589>>IF
F$DCB.PRECNO
     12283**DCL     12283--REDEF
F$DCB.RCSZ
     12289**DCL     12289--REDEF
F$DCB.RES#
     12256**DCL     12256--REDEF
F$DCB.SETX
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:254  
     12268**DCL     12268--REDEF
F$DCB.TAB$
     12268**DCL     12268--REDEF
F$DCB.TDA
     12282**DCL     12283--REDEF
F$DCB.WSN#
     12256**DCL     12256--REDEF
FILE_INFO_BASE
     11934**DCL     12907>>ASSIGN  12910>>ASSIGN  12912>>ASSIGN  12913>>ASSIGN  12914>>ASSIGN  14563>>ASSIGN
     15324>>ASSIGN  15371>>ASSIGN
GETDCB
     14366**PROC    12685--CALL    12702--CALL    12722--CALL    15333--CALL    15582--CALL
GETDCB_FPT IN PROCEDURE GETDCB
     14435**DCL     14442<<ASSIGN  14453<>CALL
GETDCB_FPT.DCBNAME_ IN PROCEDURE GETDCB
     14435**DCL     14448<<ASSIGN
GETDCB_FPT.DCBNUM_ IN PROCEDURE GETDCB
     14435**DCL     14444<<ASSIGN
GETDCB_FPT.V IN PROCEDURE GETDCB
     14436**DCL     14443--ASSIGN
GETDCB_FPT.V_ IN PROCEDURE GETDCB
     14435**DCL     14443<<ASSIGN
GET_XSA_PARAM
     14592**PROC    13953--CALL
GOT_M IN PROCEDURE PARSE_AND_CHECK_PLUS
     12955**DCL     12962<<ASSIGN  13011<<ASSIGN  13025>>IF
GOT_N IN PROCEDURE PARSE_AND_CHECK_PLUS
     12954**DCL     12961<<ASSIGN  12999<<ASSIGN  13027>>IF
GOT_RECORD
     12394**DCL     12429<<ASSIGN  12432>>DOUNTIL 12442<<ASSIGN  12457<<ASSIGN  12486<<ASSIGN  12518<<ASSIGN
     12533<<ASSIGN
HALT_POS IN PROCEDURE PARSE_AND_CHECK_PLUS
     12951**DCL     12996<<CALLBLT 12997>>IF      13000>>CALLBLT 13003>>ASSIGN  13004<<CALLBLT 13005>>IF
     13012>>CALLBLT
HALT_VALUE IN PROCEDURE PARSE_AND_CHECK_PLUS
     12952**DCL     12996<<CALLBLT 13001>>IF      13004<<CALLBLT 13007>>IF      13007>>IF      13009<<ASSIGN
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:255  
     13015<<ASSIGN  13020<<ASSIGN  13022>>IF
I IN PROCEDURE CLEANUP
     15068**DCL     15075<<DOINDEX 15076>>CALL    15078>>ASSIGN
I IN PROCEDURE INITIALIZE_EVERYTHING
     12904**DCL     12906<<DOINDEX 12907>>ASSIGN
INCL_CLOSE_PROBLEMS
     12801**LABEL   12788--CALLALT
INCL_INFO
     12174**DCL     12531<>CALL    12541<>CALL    12685<>CALL    12686<>CALL    12788<>CALL    12907<<ASSIGN
     15076<>CALL
INCL_INFO.DCB#
     12192**DCL     14951>>ASSIGN
INCL_INFO.FAST
     12184**DCL     12684<<ASSIGN
INCL_INFO.RECORD_COUNT
     12180**DCL     12536>>ASSIGN
INCL_IO_ERR
     12842**LABEL   12541--CALLALT 12554--GOTO    12559--GOTO    12817--GOTO
INCL_LEVEL
     12200**DCL     12531>>CALL    12535>>ASSIGN  12536>>ASSIGN  12541>>CALL    12542<<ASSIGN  12542>>ASSIGN
     12543>>IF      12553<<ASSIGN  12673>>IF      12677>>ASSIGN  12689<<ASSIGN  12690>>ASSIGN  12786>>IF
     12788>>CALL    12789<<ASSIGN  12789>>ASSIGN  12790>>IF      12851>>ASSIGN  12919<<ASSIGN
INCL_OPEN_ERR
     12745**LABEL   12685--CALLALT 12686--CALLALT
INCL_SAVE_STATE
     12201**DCL     12545>>ASSIGN  12675<<ASSIGN  12792>>ASSIGN  12793<<ASSIGN  12799<<ASSIGN  12917<<ASSIGN
     15073<<ASSIGN
INITIALIZE_EVERYTHING
     12902**PROC    12657--CALL
KEY IN PROCEDURE SOURCE_OUT
     15573**DCL     15609--CALL
KEY.K IN PROCEDURE SOURCE_OUT
     15575**DCL     15607<<ASSIGN
KEY.LEN IN PROCEDURE SOURCE_OUT
     15574**DCL     15606<<ASSIGN
KEY_BUF IN PROCEDURE READ
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:256  
     13142**DCL     13151--ASSIGN
KEY_BUF.COUNT IN PROCEDURE READ
     13143**DCL     13191>>IF
KEY_BUF.KEY IN PROCEDURE READ
     13144**DCL     13193>>CALLBLT
KILL IN PROCEDURE IO_ERR
     14715**LABEL   14717--CALLALT
KILL IN PROCEDURE XUU_ERR
     14756**LABEL   14758--CALLALT
KILL_IO_ERR IN PROCEDURE IO_ERR
     14721**ENTRY   12843--CALL    12847--CALL    12852--CALL    12856--CALL    13077--CALL    15376--CALL
     15381--CALL    15386--CALL
KILL_XUU_ERR IN PROCEDURE XUU_ERR
     14762**ENTRY   12436--CALL    12614--CALL    12662--CALL    12670--CALL    12698--CALL    12718--CALL
LEN IN PROCEDURE PRINT_UPDATE
     15290**DCL     15300<<ASSIGN  15313<<ASSIGN  15342<<ASSIGN  15398>>ASSIGN
LU_BUF IN PROCEDURE PRINT_UPDATE
     15284**DCL     15397--ASSIGN
LU_BUF.BUF IN PROCEDURE PRINT_UPDATE
     15288**DCL     15298<<ASSIGN  15312<<ASSIGN  15322--ASSIGN  15323--ASSIGN
LU_BUF.HEAD IN PROCEDURE PRINT_UPDATE
     15285**DCL     15398--ASSIGN
LU_BUF.HEAD.KEY IN PROCEDURE PRINT_UPDATE
     15286**DCL     15299<<ASSIGN  15310<<ASSIGN  15341<<ASSIGN
LU_BUF.HEAD.SP IN PROCEDURE PRINT_UPDATE
     15287**DCL     15297<<ASSIGN  15311<<ASSIGN  15321<<ASSIGN
LU_ERR IN PROCEDURE PRINT_UPDATE
     15371**LABEL   15343--CALLALT 15349--CALLALT 15352--CALLALT
LU_INFO
     12140**DCL     12914<<ASSIGN  15371<<ASSIGN  15399<>CALL
LU_INFO.DCB#
     12158**DCL     12728<<ASSIGN  12729--ASSIGN  14946>>ASSIGN  15295>>IF      15308>>IF
LU_INFO.DCB$
     12148**DCL     12729<<ASSIGN
LU_INFO.FAST
     12150**DCL     12727<<ASSIGN
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:257  
LU_PRINT_ERR IN PROCEDURE PRINT_UPDATE
     15371**LABEL   15301--CALLALT 15314--CALLALT
M IN PROCEDURE PARSE_AND_CHECK_PLUS
     12950**DCL     12958<<ASSIGN  13012<<CALLBLT 13034<<ASSIGN  13039>>IF      13039>>IF      13042<<ASSIGN
     13044>>IF      13051>>IF      13058>>ASSIGN  13064>>IF      13064>>IF      13066>>ASSIGN
M$CLOSE
      9070**DCL-ENT 14176--CALL
M$GETDCB
      9076**DCL-ENT 14453--CALL
M$OPEN
      9070**DCL-ENT 13962--CALL
M$PFIL
      9072**DCL-ENT 13491--CALL
M$PRECORD
      9074**DCL-ENT 14326--CALL
M$READ
      9071**DCL-ENT 13159--CALL
M$RELDCB
      9076**DCL-ENT 14560--CALL
M$WRITE
      9071**DCL-ENT 13366--CALL
N IN PROCEDURE PARSE_AND_CHECK_PLUS
     12949**DCL     12957<<ASSIGN  13000<<CALLBLT 13029<<ASSIGN  13034>>ASSIGN  13039>>IF      13042>>ASSIGN
     13044>>IF      13053>>ASSIGN  13057>>ASSIGN  13058>>ASSIGN
NEXT_UPDATE_POSITION
     12198**DCL     12444>>IF      12470>>IF      12505>>IF      12611>>IF      12921<<ASSIGN  12993<<ASSIGN
     13047<<ASSIGN  13053<<ASSIGN  13057<<ASSIGN  13060>>IF      13063<<ASSIGN  13066>>ASSIGN
NICE_TRY IN PROCEDURE SET_IO_ERROR
     14922**LABEL   14919--CALLALT 14922--CALLALT
NICE_TRY IN PROCEDURE SET_XUU_ERR
     14857**LABEL   14856--CALLALT 14859--CALLALT
NRECS_IN_SOURCE
     12196**DCL     12706<<ASSIGN  12709<<ASSIGN  13044>>IF      13044>>IF
OPEN
     13530**PROC    12686--CALL    12703--CALL    12723--CALL    15334--CALL    15586--CALL
OPEN_FPT IN PROCEDURE OPEN
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:258  
     13744**DCL     13919<<ASSIGN  13924<<ASSIGN  13962<>CALL    13966<>CALL
OPEN_FPT.ACSVEH_ IN PROCEDURE OPEN
     13746**DCL     13747--REDEF
OPEN_FPT.ALTKEYS_ IN PROCEDURE OPEN
     13752**DCL     13753--REDEF   13753--REDEF
OPEN_FPT.HDR_ IN PROCEDURE OPEN
     13751**DCL     13752--REDEF
OPEN_FPT.TAB_ IN PROCEDURE OPEN
     13750**DCL     13751--REDEF
OPEN_FPT.UHL_ IN PROCEDURE OPEN
     13744**DCL     13745--REDEF   13745--REDEF
OPEN_FPT.V IN PROCEDURE OPEN
     13753**DCL     13925<<ASSIGN  13932--ASSIGN
OPEN_FPT.V.DCB# IN PROCEDURE OPEN
     13753**DCL     13933<<ASSIGN
OPEN_FPT.V.FSN# IN PROCEDURE OPEN
     13784**DCL     13784--REDEF   13784--REDEF
OPEN_FPT.V_ IN PROCEDURE OPEN
     13744**DCL     13932<<ASSIGN
OPEN_FPT.WSN_ IN PROCEDURE OPEN
     13750**DCL     13750--REDEF
OPEN_INCL
     12398**DCL     12653<<ASSIGN  12660>>IF      12666>>IF
OPEN_SCRATCH IN PROCEDURE PRINT_UPDATE
     15239**DCL     15334--CALL
OPEN_SCRATCH.ACSVEH_ IN PROCEDURE PRINT_UPDATE
     15241**DCL     15242--REDEF
OPEN_SCRATCH.ALTKEYS_ IN PROCEDURE PRINT_UPDATE
     15247**DCL     15248--REDEF   15248--REDEF
OPEN_SCRATCH.HDR_ IN PROCEDURE PRINT_UPDATE
     15246**DCL     15247--REDEF
OPEN_SCRATCH.TAB_ IN PROCEDURE PRINT_UPDATE
     15245**DCL     15246--REDEF
OPEN_SCRATCH.UHL_ IN PROCEDURE PRINT_UPDATE
     15239**DCL     15240--REDEF   15240--REDEF
OPEN_SCRATCH.V IN PROCEDURE PRINT_UPDATE
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:259  
     15248**DCL     15239--DCLINIT
OPEN_SCRATCH.V.FSN# IN PROCEDURE PRINT_UPDATE
     15279**DCL     15279--REDEF   15279--REDEF
OPEN_SCRATCH.WSN_ IN PROCEDURE PRINT_UPDATE
     15245**DCL     15245--REDEF
OPEN_SI
     12396**DCL     12651<<ASSIGN  12660>>IF      12668>>IF      12694>>IF      12716>>IF
OPEN_SO IN PROCEDURE SOURCE_OUT
     15501**DCL     15586--CALL
OPEN_SO.ACSVEH_ IN PROCEDURE SOURCE_OUT
     15503**DCL     15504--REDEF
OPEN_SO.ALTKEYS_ IN PROCEDURE SOURCE_OUT
     15509**DCL     15510--REDEF   15510--REDEF
OPEN_SO.HDR_ IN PROCEDURE SOURCE_OUT
     15508**DCL     15509--REDEF
OPEN_SO.TAB_ IN PROCEDURE SOURCE_OUT
     15507**DCL     15508--REDEF
OPEN_SO.UHL_ IN PROCEDURE SOURCE_OUT
     15501**DCL     15502--REDEF   15502--REDEF
OPEN_SO.V IN PROCEDURE SOURCE_OUT
     15510**DCL     15501--DCLINIT
OPEN_SO.V.FSN# IN PROCEDURE SOURCE_OUT
     15541**DCL     15541--REDEF   15541--REDEF
OPEN_SO.WSN_ IN PROCEDURE SOURCE_OUT
     15507**DCL     15507--REDEF
OPEN_UI
     12397**DCL     12652<<ASSIGN  12660>>IF      12668>>IF      12714>>IF
ORG IN PROCEDURE OPEN
     13914**DCL     13963<<ASSIGN  13969<<ASSIGN  13970>>IF      13979>>IF      13979>>IF      13989<<ASSIGN
     13993>>IF
PARAM$ IN PROCEDURE CLOSE
     14162**DCL     14186>>ASSIGN  14192<<ASSIGN  14193>>IF      14195>>CALL    14197>>IF      14199>>CALL
     14201<>CALL
PARAM$ IN PROCEDURE OPEN
     13913**DCL     13953<>CALL    13954>>ASSIGN  13955>>IF      13966>>CALL    13967>>IF      13969>>ASSIGN
     13978>>ASSIGN  13985>>ASSIGN  14010>>ASSIGN  14011<>CALL
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:260  
PARSE_AND_CHECK_PLUS
     12947**PROC    12467--CALL    12504--CALL
PFIL
     13405**PROC    15369--CALL
PFIL_FPT IN PROCEDURE PFIL
     13468**DCL     13473<<ASSIGN  13488<>CALL    13491<>CALL
PFIL_FPT.V IN PROCEDURE PFIL
     13468**DCL     13474--ASSIGN
PFIL_FPT.V.BOF# IN PROCEDURE PFIL
     13469**DCL     13479<<ASSIGN  13481<<ASSIGN
PFIL_FPT.V.DCB# IN PROCEDURE PFIL
     13468**DCL     13475<<ASSIGN
PFIL_FPT.V_ IN PROCEDURE PFIL
     13468**DCL     13474<<ASSIGN
PRECORD
     14234**PROC    12450--CALL    12477--CALL    12512--CALL
PRECORD_FPT IN PROCEDURE PRECORD
     14303**DCL     14315<<ASSIGN  14322<>CALL    14326<>CALL
PRECORD_FPT.V IN PROCEDURE PRECORD
     14305**DCL     14316--ASSIGN
PRECORD_FPT.V.DCB# IN PROCEDURE PRECORD
     14305**DCL     14318<<ASSIGN
PRECORD_FPT.V.N# IN PROCEDURE PRECORD
     14309**DCL     14317<<ASSIGN
PRECORD_FPT.V_ IN PROCEDURE PRECORD
     14303**DCL     14316<<ASSIGN
PREPRINT_UPDATES IN PROCEDURE PRINT_UPDATE
     15319**ENTRY   12733--CALL
PRINT_SAVED_UPDATE IN PROCEDURE PRINT_UPDATE
     15306**ENTRY   12446--CALL    12613--CALL
PRINT_UPDATE
     15138**PROC    12490--CALL    12522--CALL
P_BUF_
     11747**DCL        75--PROC    12427>>ASSIGN  12428>>ASSIGN  12597>>IF      12599>>ASSIGN  12599>>ASSIGN
     14854>>ASSIGN  14917>>ASSIGN
P_COUNT IN PROCEDURE PRECORD
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:261  
     14270**DCL     14234--PROC    14317>>ASSIGN  14329>>ASSIGN
P_DCB_NAME IN PROCEDURE GETDCB
     14407**DCL     14366--PROC    14445--IF      14448--ASSIGN
P_DCB_NAME.L# IN PROCEDURE GETDCB
     14407**DCL     14407--IMP-SIZ 14448>>ASSIGN
P_DIRECTION IN PROCEDURE PFIL
     13441**DCL     13405--PROC    13477>>DOCASE
P_ERROR_NUM IN PROCEDURE SET_XUU_ERR
     14795**DCL     14793--PROC    14847>>ASSIGN
P_ERROR_NUM IN PROCEDURE XUU_ERR
     14753**DCL     14751--PROC    14756--ENTRY   14758<>CALL    14762--ENTRY   14764<>CALL
P_FILE IN PROCEDURE IO_ERR
     14712**DCL     14710--PROC    14715--ENTRY   14717<>CALL    14721--ENTRY   14723<>CALL
P_FILE IN PROCEDURE SET_IO_ERROR
     14904**DCL     14902--PROC    14933>>DOCASE
P_FPT$ IN PROCEDURE OPEN
     13568**DCL     13530--PROC    13917--IF      13922>>IF      13924>>ASSIGN  13925>>ASSIGN
P_INFO IN PROCEDURE CLEANUP_FILE
     15006**DCL     14991--PROC    15031<>CALL    15036<>CALL
P_INFO IN PROCEDURE CLOSE
     14057**DCL     14042--PROC
P_INFO.DCB# IN PROCEDURE CLOSE
     14075**DCL     14167>>IF      14171>>ASSIGN
P_INFO.DCB$ IN PROCEDURE CLOSE
     14065**DCL     14172>>IF
P_INFO.FAST IN PROCEDURE CLOSE
     14067**DCL     14174>>IF
P_INFO.XSA_PARAM$ IN PROCEDURE CLOSE
     14061**DCL     14183>>CALL    14190>>IF      14192>>ASSIGN  14205<<ASSIGN
P_INFO IN PROCEDURE GETDCB
     14381**DCL     14366--PROC
P_INFO.DCB# IN PROCEDURE GETDCB
     14399**DCL     14440>>IF      14444--ASSIGN  14457--ASSIGN  14462<<ASSIGN
P_INFO.DCB$ IN PROCEDURE GETDCB
     14389**DCL     14457<<ASSIGN
P_INFO.TEMP_DCB IN PROCEDURE GETDCB
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:262  
     14393**DCL     14447<<ASSIGN  14451<<ASSIGN
P_INFO IN PROCEDURE OPEN
     13547**DCL     13530--PROC
P_INFO.DCB# IN PROCEDURE OPEN
     13565**DCL     13933>>ASSIGN
P_INFO.DCB$ IN PROCEDURE OPEN
     13555**DCL     13963>>ASSIGN  13989>>ASSIGN
P_INFO.FAST IN PROCEDURE OPEN
     13557**DCL     13951>>IF      13957<<ASSIGN  13960>>IF
P_INFO.KEY_TYPE IN PROCEDURE OPEN
     13563**DCL     13995<<ASSIGN  13998<<ASSIGN
P_INFO.RECORD_COUNT IN PROCEDURE OPEN
     13553**DCL     14001<<ASSIGN
P_INFO.XSA_PARAM$ IN PROCEDURE OPEN
     13551**DCL     13954<<ASSIGN  14012<<ASSIGN
P_INFO IN PROCEDURE PFIL
     13420**DCL     13405--PROC
P_INFO.DCB# IN PROCEDURE PFIL
     13438**DCL     13475>>ASSIGN
P_INFO.FAST IN PROCEDURE PFIL
     13430**DCL     13486>>IF
P_INFO.RECORD_COUNT IN PROCEDURE PFIL
     13426**DCL     13494<<ASSIGN
P_INFO.XSA_PARAM$ IN PROCEDURE PFIL
     13424**DCL     13488>>CALL    13503>>ASSIGN
P_INFO IN PROCEDURE PRECORD
     14249**DCL     14234--PROC
P_INFO.DCB# IN PROCEDURE PRECORD
     14267**DCL     14318>>ASSIGN
P_INFO.FAST IN PROCEDURE PRECORD
     14259**DCL     14320>>IF
P_INFO.RECORD_COUNT IN PROCEDURE PRECORD
     14255**DCL     14329<<ASSIGN  14329>>ASSIGN
P_INFO.XSA_PARAM$ IN PROCEDURE PRECORD
     14253**DCL     14322>>CALL    14338>>ASSIGN
P_INFO IN PROCEDURE READ
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:263  
     13120**DCL     13105--PROC
P_INFO.DCB# IN PROCEDURE READ
     13138**DCL     13150>>ASSIGN
P_INFO.DCB$ IN PROCEDURE READ
     13128**DCL     13160>>ASSIGN
P_INFO.FAST IN PROCEDURE READ
     13130**DCL     13153>>IF
P_INFO.KEY_TYPE IN PROCEDURE READ
     13136**DCL     13189>>DOCASE  13198<<ASSIGN
P_INFO.RECORD_COUNT IN PROCEDURE READ
     13126**DCL     13185<<ASSIGN  13185>>ASSIGN  13203>>CALLBLT
P_INFO.XSA_PARAM$ IN PROCEDURE READ
     13124**DCL     13155>>CALL    13156>>ASSIGN  13169>>ASSIGN
P_INFO IN PROCEDURE RELDCB
     14503**DCL     14488--PROC    14563<<ASSIGN
P_INFO.DCB# IN PROCEDURE RELDCB
     14521**DCL     14553>>IF      14553>>IF      14559>>ASSIGN
P_INFO.TEMP_DCB IN PROCEDURE RELDCB
     14515**DCL     14553>>IF
P_INFO IN PROCEDURE WRITE
     13249**DCL     13234--PROC
P_INFO.DCB# IN PROCEDURE WRITE
     13267**DCL     13339>>ASSIGN
P_INFO.FAST IN PROCEDURE WRITE
     13259**DCL     13361>>IF
P_INFO.KEY_TYPE IN PROCEDURE WRITE
     13265**DCL     13355>>IF
P_INFO.RECORD_COUNT IN PROCEDURE WRITE
     13255**DCL     13369<<ASSIGN  13369>>ASSIGN
P_INFO.XSA_PARAM$ IN PROCEDURE WRITE
     13253**DCL     13363>>CALL    13378>>ASSIGN
P_KEY_ IN PROCEDURE WRITE
     13271**DCL     13234--PROC    13355--IF      13358>>ASSIGN
P_OPEN_TYPE IN PROCEDURE OPEN
     13569**DCL     13530--PROC    13934--IF      13936>>DOCASE
P_PARAM$ IN PROCEDURE GET_XSA_PARAM
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:264  
     14594**DCL     14592--PROC    14631<<ASSIGN  14640<<ASSIGN  14645<<ASSIGN  14647>>ASSIGN
P_PARAM$ IN PROCEDURE RELEASE_XSA_PARAM
     14674**DCL     14672--PROC    14676>>IF      14678>>IF
P_PASS_BUF IN PROCEDURE IO_ERR
     14713**DCL     14710--PROC    14715--ENTRY   14717<>CALL
P_PASS_BUF IN PROCEDURE SET_IO_ERROR
     14906**DCL     14902--PROC    14915>>IF
P_PASS_BUF IN PROCEDURE SET_XUU_ERR
     14797**DCL     14793--PROC    14852>>IF      14872--IF      14874>>ASSIGN
P_PASS_BUF IN PROCEDURE XUU_ERR
     14754**DCL     14751--PROC    14756--ENTRY   14758<>CALL
P_RECOVERABLE IN PROCEDURE SET_IO_ERROR
     14905**DCL     14902--PROC    14912>>IF
P_RECOVERABLE IN PROCEDURE SET_XUU_ERR
     14796**DCL     14793--PROC    14849>>IF
P_WRITE_BUF_ IN PROCEDURE WRITE
     13270**DCL     13234--PROC    13341--IF      13352>>ASSIGN
READ
     13105**PROC    12441--CALL    12456--CALL    12462--CALL    12499--CALL    12531--CALL    12981--CALL
     15340--CALL
READ_FPT
     11999**DCL     13155<>CALL    13159<>CALL
READ_FPT.BUF_
     12001**DCL     12427<<ASSIGN  13176>>ASSIGN  15322<<ASSIGN
READ_FPT.KEY_
     11999**DCL     13151<<ASSIGN
READ_FPT.STATION_
     12002**DCL     12003--REDEF
READ_FPT.V
     12003**DCL     11999--DCLINIT
READ_FPT.V.DCB#
     12003**DCL     13150<<ASSIGN
READ_FPT.V.DVBYTE.REREAD#
     12014**DCL     12014--REDEF
READ_FPT.V.INDX#
     12012**DCL     12012--REDEF
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:265  
RECOVER
     12577**LABEL   12570--GOTO    12581--GOTO
REC_IO_ERR IN PROCEDURE IO_ERR
     14715**ENTRY   13177--CALL
REC_XUU_ERR IN PROCEDURE XUU_ERR
     14756**ENTRY   12579--CALL    12966--CALL    12979--CALL    12983--CALL    13024--CALL    13041--CALL
     13046--CALL    13062--CALL
RELDCB
     14488**PROC    15036--CALL
RELDCB_FPT IN PROCEDURE RELDCB
     14549**DCL     14557<<ASSIGN  14560<>CALL
RELDCB_FPT.V IN PROCEDURE RELDCB
     14549**DCL     14558--ASSIGN
RELDCB_FPT.V.DCB# IN PROCEDURE RELDCB
     14549**DCL     14559<<ASSIGN
RELDCB_FPT.V_ IN PROCEDURE RELDCB
     14549**DCL     14558<<ASSIGN
RELEASE_XSA_PARAM
     14672**PROC    14011--CALL    14201--CALL
SAVED_UPDATE.ARS
     12203**DCL     12492<<ASSIGN  12524<<ASSIGN  15313>>ASSIGN
SAVED_UPDATE.KEY
     12204**DCL     12493<<ASSIGN  12525<<ASSIGN  15310>>ASSIGN
SAVED_UPDATE.TEXT
     12205**DCL     12492--ASSIGN  12494<<ASSIGN  12524--ASSIGN  12526<<ASSIGN  15312>>ASSIGN
SEARCH_TABLE
     11958**DCL     12996>>CALLBLT 13004>>CALLBLT
SEQ_MOPS
     11957**DCL     13204>>CALLBLT 15600>>CALLBLT
SET_IO_ERROR
     14902**PROC    12754--CALL    14717--CALL    14723--CALL    15079--CALL    15086--CALL    15092--CALL
     15098--CALL
SET_XUU_ERR
     14793**PROC    12680--CALL    13928--CALL    14641--CALL    14683--CALL    14758--CALL    14764--CALL
SI_BETTER_BE_EOF
     12603**LABEL   12441--CALLALT 12456--CALLALT
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:266  
SI_DCB_NAME
     11845**DCL     12702<>CALL
SI_INFO
     12038**DCL     12441<>CALL    12450<>CALL    12456<>CALL    12477<>CALL    12512<>CALL    12702<>CALL
     12703<>CALL    12913<<ASSIGN  15096<>CALL
SI_INFO.DCB#
     12056**DCL     14936>>ASSIGN
SI_INFO.DCB$
     12046**DCL     12704>>IF      12706>>ASSIGN
SI_INFO.FAST
     12048**DCL     12701<<ASSIGN
SI_INFO.RECORD_COUNT
     12044**DCL     12444>>IF      12505>>IF      12593>>ASSIGN  12611>>IF      13029>>ASSIGN  13060>>IF
     13063>>ASSIGN  13064>>IF
SI_IO_ERR
     12842**LABEL   12584--GOTO    12618--GOTO    12748--GOTO
SI_OPEN_ERR
     12745**LABEL   12702--CALLALT 12703--CALLALT
SI_SKIP_COUNT
     12199**DCL     12448>>IF      12450<>CALL    12475>>IF      12477<>CALL    12510>>IF      12512<>CALL
     12959<<ASSIGN  13054<<ASSIGN  13058<<ASSIGN  13066<<ASSIGN  13069<<ASSIGN
SI_SKIP_ERR
     12567**LABEL   12450--CALLALT 12477--CALLALT 12512--CALLALT
SOURCE_OUT
     15434**PROC    12605--CALL
SOURCE_OUT_CRASH
     12611**LABEL   12605--CALLALT
SO_DCB_NAME IN PROCEDURE SOURCE_OUT
     15570**DCL     15582<>CALL
SO_INFO
     12106**DCL     12910<<ASSIGN  15084<>CALL    15582<>CALL    15586<>CALL    15601<>CALL    15609<>CALL
SO_INFO.DCB#
     12124**DCL     14956>>ASSIGN  15580>>IF
SO_INFO.DCB$
     12114**DCL     15584>>IF      15589>>IF
SO_INFO.FAST
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:267  
     12116**DCL     15583<<ASSIGN
SO_INFO.KEY_TYPE
     12122**DCL     15591<<ASSIGN  15597>>IF
SO_INFO.RECORD_COUNT
     12112**DCL     12911<<ASSIGN  15587<<ASSIGN  15599>>CALLBLT 15604>>CALLBLT 15607>>ASSIGN
SO_IO_ERR
     12851**LABEL   12625--GOTO
TEMP_CHAR8 IN PROCEDURE READ
     13141**DCL     13193<<CALLBLT 13194>>CALLBLT 13203<<CALLBLT 13204>>CALLBLT
TEMP_CHAR8 IN PROCEDURE SOURCE_OUT
     15572**DCL     15599<<CALLBLT 15600>>CALLBLT 15604<<CALLBLT 15605>>CALLBLT
TEMP_CODE IN PROCEDURE SET_XUU_ERR
     14811**DCL     14846<<ASSIGN  14856<>CALL    14859<>CALL    14871>>ASSIGN
TEMP_CODE.ERR# IN PROCEDURE SET_XUU_ERR
     14841**DCL     14847<<ASSIGN
TEMP_INCL_LEVEL
     12401**DCL     12677<<ASSIGN  12678>>IF      12684>>ASSIGN  12685>>CALL    12686>>CALL    12689>>ASSIGN
     12851<<ASSIGN  14951>>ASSIGN  15078<<ASSIGN
TEMP_VEC IN PROCEDURE SET_IO_ERROR
     14907**DCL     14917<<ASSIGN  14918<<ASSIGN  14919<>CALL
TEMP_VEC IN PROCEDURE SET_XUU_ERR
     14798**DCL     14854<<ASSIGN  14855<<ASSIGN  14856<>CALL
TEMP_VECT IN PROCEDURE DUMP_LU_BUF
     15395**DCL     15397<<ASSIGN  15398<<ASSIGN  15399<>CALL
UI_DCB_NAME
     11872**DCL     12722<>CALL
UI_ERR IN PROCEDURE PRINT_UPDATE
     15371**LABEL   15333--CALLALT 15334--CALLALT 15360--GOTO    15365--CALLALT 15369--CALLALT
UI_INFO
     12072**DCL     12462<>CALL    12499<>CALL    12722<>CALL    12723<>CALL    12912<<ASSIGN  12981<>CALL
     12991<>CALL    15090<>CALL    15340<>CALL    15365<>CALL    15366<<ASSIGN  15369<>CALL
UI_INFO.DCB#
     12090**DCL     14941>>ASSIGN
UI_INFO.DCB$
     12080**DCL     15326>>IF      15326>>IF
UI_INFO.FAST
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:268  
     12082**DCL     12721<<ASSIGN
UI_INFO.RECORD_COUNT
     12078**DCL     12464>>ASSIGN  12501>>ASSIGN
UI_IO_ERR
     12842**LABEL   12573--GOTO    12751--GOTO
UI_IO_ERR IN PROCEDURE PARSE_AND_CHECK_PLUS
     13066**LABEL   12988--GOTO    12991--CALLALT
UI_OPEN_ERR
     12745**LABEL   12722--CALLALT 12740--GOTO
UI_READ_ERR
     12552**LABEL   12462--CALLALT 12499--CALLALT
UI_SCRATCH_INFO IN PROCEDURE PRINT_UPDATE
     15153**DCL     15324<<ASSIGN  15333<>CALL    15334<>CALL    15349<>CALL    15352<>CALL    15366>>ASSIGN
     15380<>CALL    15385<>CALL
UI_SCRATCH_INFO.FAST IN PROCEDURE PRINT_UPDATE
     15163**DCL     15332<<ASSIGN
USER_BUF$
     12402**DCL     12428<<ASSIGN  12465>>IF      12494>>ASSIGN  12502>>IF      12526>>ASSIGN  12970>>IF
     12975>>IF      12977>>IF      12996>>CALLBLT 13000>>CALLBLT 13004>>CALLBLT 13012>>CALLBLT 13345>>ASSIGN
     15298>>ASSIGN
WRITE
     13234**PROC    15349--CALL    15352--CALL    15399--CALL    15601--CALL    15609--CALL
WRITE_FPT IN PROCEDURE WRITE
     13321**DCL     13337<<ASSIGN  13363<>CALL    13366<>CALL
WRITE_FPT.BUF_ IN PROCEDURE WRITE
     13321**DCL     13345<<ASSIGN  13348<<ASSIGN  13352<<ASSIGN
WRITE_FPT.KEY_ IN PROCEDURE WRITE
     13321**DCL     13358<<ASSIGN
WRITE_FPT.STATION_ IN PROCEDURE WRITE
     13323**DCL     13323--REDEF
WRITE_FPT.V IN PROCEDURE WRITE
     13324**DCL     13338--ASSIGN
WRITE_FPT.V.DCB# IN PROCEDURE WRITE
     13324**DCL     13339<<ASSIGN
WRITE_FPT.V.DVBYTE.VFC# IN PROCEDURE WRITE
     13330**DCL     13330--REDEF
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:269  
WRITE_FPT.V_ IN PROCEDURE WRITE
     13321**DCL     13338<<ASSIGN
WRITE_TEMP IN PROCEDURE PRINT_UPDATE
     15292**DCL     15329<<ASSIGN  15335<<ASSIGN  15344>>IF      15363>>IF
XSA$CLOSE
     11771**DCL-ENT 14183--CALL
XSA$OPEN
     11770**DCL-ENT 13966--CALL
XSA$PFIL
     11774**DCL-ENT 13488--CALL
XSA$PRECORD
     11775**DCL-ENT 14322--CALL
XSA$READ
     11772**DCL-ENT 13155--CALL
XSA$WRITE
     11773**DCL-ENT 13363--CALL
XSA_PARAM
     12303**DCL     13155<>CALL    13363<>CALL    13488<>CALL    13966<>CALL    14183<>CALL    14322<>CALL
     14637--IF      14646--ASSIGN  14647<<ASSIGN  14678--IF      14680--ASSIGN
XSA_PARAM.ARS#
     12307**DCL     13156>>ASSIGN
XSA_PARAM.BBUF_
     12311**DCL     13978<<ASSIGN  14197>>IF      14199<>CALL
XSA_PARAM.EOMCHAR#
     12319**DCL     12320--REDEF
XSA_PARAM.ERR
     12307**DCL     13169>>ASSIGN  13378>>ASSIGN  13503>>ASSIGN  14010>>ASSIGN  14186>>ASSIGN  14338>>ASSIGN
XSA_PARAM.KBUF_
     12309**DCL     13985<<ASSIGN  14193>>IF      14195<>CALL
XSA_PARAM.ORG
     12318**DCL     13967>>IF      13969>>ASSIGN
XSA_PARAM.SIG1
     12313**DCL     12313--REDEF
XSA_PARAM.SIG2
     12313**DCL     12314--REDEF
XSA_PARAM_POOL_
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:270  
     12022**DCL     12923<<ASSIGN  14626>>IF      14628<>CALL    14630<<ASSIGN  14634>>ASSIGN  14637>>IF
     14637>>IF      15102>>IF      15104<>CALL    15105<<ASSIGN
XSA_PARAM_POOL_NEXT$
     12023**DCL     14634<<ASSIGN  14637>>IF      14645>>ASSIGN  14646<<ASSIGN  14646>>ASSIGN  14678>>IF
     14680<<ASSIGN  14680>>ASSIGN
XUU_ALTRET
     12851**LABEL   12437--GOTO    12446--CALLALT 12490--CALLALT 12522--CALLALT 12579--CALLALT 12615--GOTO
     12622--GOTO    12663--GOTO    12671--GOTO    12681--GOTO    12699--GOTO    12719--GOTO    12733--CALLALT
     12755--GOTO    12820--GOTO    12844--GOTO    12848--GOTO    12853--GOTO    12857--GOTO
XUU_PARAM
     11321**DCL        75--PROC    12647--ENTRY   12777--ENTRY
XUU_PARAM.ALLOCATE$$
     11674**DCL     13974>>CALL    13981>>CALL    14628>>CALL
XUU_PARAM.ARS
     11524**DCL     12591<<ASSIGN
XUU_PARAM.ASCII_KEY
     11587**DCL     11593--REDEF   11607--REDEF   11630--REDEF
XUU_PARAM.C.SO_ERRCODE
     11644**DCL     14955<<ASSIGN
XUU_PARAM.DCB#
     11658**DCL     12425<<ASSIGN  12728>>ASSIGN  14553>>IF      14936<<ASSIGN  14941<<ASSIGN  14946<<ASSIGN
     14951<<ASSIGN  14956<<ASSIGN  14961<<ASSIGN
XUU_PARAM.ERRCODE
     11567**DCL     14871<<ASSIGN  14931<<ASSIGN  14960<<ASSIGN
XUU_PARAM.ERROR_PROC$$
     11724**DCL     14849>>IF      14856>>CALL    14859>>CALL    14912>>IF      14919>>CALL    14922>>CALL
XUU_PARAM.FLAGS
     11322**DCL     12433<<ASSIGN  12433>>ASSIGN  14869<<ASSIGN  14869>>ASSIGN  14930<<ASSIGN  14930>>ASSIGN
XUU_PARAM.FLAGS.BAD_UPDATE#
     11507**DCL     14874<<ASSIGN
XUU_PARAM.FLAGS.BASE#
     11323**DCL     12443<<ASSIGN  12458<<ASSIGN  12651>>ASSIGN  12781>>IF      14937<<ASSIGN
XUU_PARAM.FLAGS.BLANK_FILL#
     11374**DCL     12595>>IF
XUU_PARAM.FLAGS.CLOSE_ALL#
     11402**DCL     12781>>IF
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:271  
XUU_PARAM.FLAGS.FAST_BASE#
     11473**DCL     12701>>ASSIGN
XUU_PARAM.FLAGS.FAST_INCLUDE#
     11495**DCL     12684>>ASSIGN
XUU_PARAM.FLAGS.FAST_UPDATE#
     11484**DCL     12721>>ASSIGN
XUU_PARAM.FLAGS.INCLUDE#
     11354**DCL     12534<<ASSIGN  12653>>ASSIGN  12786>>IF      14952<<ASSIGN  15577>>IF
XUU_PARAM.FLAGS.KEY_REC#
     11410**DCL     13195<<ASSIGN
XUU_PARAM.FLAGS.LU_FIRST#
     11428**DCL     12725>>IF      12731>>IF
XUU_PARAM.FLAGS.LU_WHILE#
     11446**DCL     12725>>IF
XUU_PARAM.FLAGS.OPT_UI#
     11464**DCL     12738>>IF
XUU_PARAM.FLAGS.SOURCE_OUT#
     11383**DCL     12603>>IF      12807>>IF      12809<<ASSIGN
XUU_PARAM.FLAGS.SO_ERR#
     11415**DCL     14957<<ASSIGN
XUU_PARAM.FLAGS.UP_DATE#
     11337**DCL     12463<<ASSIGN  12500<<ASSIGN  12652>>ASSIGN  12797>>IF      14942<<ASSIGN  14947<<ASSIGN
XUU_PARAM.FLAGS.XUU_ERR#
     11421**DCL     14870<<ASSIGN  14962<<ASSIGN
XUU_PARAM.FULL_ARS
     11739**DCL     12592<<ASSIGN
XUU_PARAM.LEVEL
     11514**DCL     12426<<ASSIGN  12535<<ASSIGN  12690<<ASSIGN
XUU_PARAM.O.FPT_PTR$
     11621**DCL     12686<>CALL
XUU_PARAM.O.INCL_ERRCODE
     11608**DCL     14950<<ASSIGN
XUU_PARAM.RELEASE$$
     11700**DCL     14195>>CALL    14199>>CALL    15104>>CALL
XUU_PARAM.RE_ASCII_KEY.CHAR10
     11606**DCL     12440<<ASSIGN  12455<<ASSIGN  12461<<ASSIGN  12498<<ASSIGN  12530<<ASSIGN  15595<<ASSIGN
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:272  
XUU_PARAM.RE_ASCII_KEY.CHAR1_9
     11605**DCL     12493>>ASSIGN  12525>>ASSIGN  13194<<CALLBLT 13204<<CALLBLT 15299>>ASSIGN  15341>>ASSIGN
     15600<<CALLBLT 15605<<CALLBLT
XUU_PARAM.SEQ_REC#.BASE#
     11543**DCL     12593<<ASSIGN
XUU_PARAM.SEQ_REC#.UP_INCL#
     11548**DCL     12464<<ASSIGN  12501<<ASSIGN  12536<<ASSIGN
XUU_PARAM.SI_ERRCODE
     11529**DCL     11542--REDEF   14935<<ASSIGN
XUU_PARAM.UI_ERRCODE
     11554**DCL     11567--REDEF   14940<<ASSIGN  14945<<ASSIGN
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:273  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:274  
              MINI UREF LISTING

IO_ERR   14710**PROC
M$ACCT    9087**DCL-ENT
M$ACTIVATE    9090**DCL-ENT
M$ALIB    9083**DCL-ENT
M$ASUSER    9085**DCL-ENT
M$ATTACH    9092**DCL-ENT
M$BADPP    9110**DCL-ENT
M$CGCTL    9091**DCL-ENT
M$CGINFO    9091**DCL-ENT
M$CHECK    9072**DCL-ENT
M$CHGUNIT    9130**DCL-ENT
M$CLRSTK    9128**DCL-ENT
M$CMDVAR    9139**DCL-ENT
M$CONFIG    9100**DCL-ENT
M$CORRES    9075**DCL-ENT
M$CPEXIT    9084**DCL-ENT
M$CVM    9108**DCL-ENT
M$CVOL    9073**DCL-ENT
M$DCLFLD    9100**DCL-ENT
M$DEACTIVATE    9090**DCL-ENT
M$DELREC    9072**DCL-ENT
M$DEQ    9137**DCL-ENT
M$DETACH    9092**DCL-ENT
M$DEVICE    9074**DCL-ENT
M$DISPLAY    9137**DCL-ENT
M$DISPRES    9077**DCL-ENT
M$DLIB    9083**DCL-ENT
M$DRIBBLE    9100**DCL-ENT
M$DRTN    9128**DCL-ENT
M$DSUSER    9085**DCL-ENT
M$ENQ    9136**DCL-ENT
M$EOM    9095**DCL-ENT
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:275  
M$ERASE    9101**DCL-ENT
M$ERR    9082**DCL-ENT
M$ERRMSG    9133**DCL-ENT
M$EVENT    9125**DCL-ENT
M$EXHUME    9134**DCL-ENT
M$EXIT    9082**DCL-ENT
M$EXTEND    9074**DCL-ENT
M$FDP    9106**DCL-ENT
M$FDS    9105**DCL-ENT
M$FEBOOT    9098**DCL-ENT
M$FECTL    9099**DCL-ENT
M$FEDUMP    9098**DCL-ENT
M$FID    9133**DCL-ENT
M$FINDPROC    9087**DCL-ENT
M$FSUSER    9085**DCL-ENT
M$FVP    9107**DCL-ENT
M$FWCG    9091**DCL-ENT
M$GBPL    9111**DCL-ENT
M$GDDL    9107**DCL-ENT
M$GDP    9106**DCL-ENT
M$GDS    9105**DCL-ENT
M$GETMOUSE    9116**DCL-ENT
M$GETPM    9117**DCL-ENT
M$GJOB    9135**DCL-ENT
M$GLINEATTR    9095**DCL-ENT
M$GOODPP    9110**DCL-ENT
M$GPLATEN    9103**DCL-ENT
M$GPROMPT    9102**DCL-ENT
M$GTRMATTR    9096**DCL-ENT
M$GTRMCTL    9094**DCL-ENT
M$GTRMTAB    9097**DCL-ENT
M$GVP    9106**DCL-ENT
M$HELP    9133**DCL-ENT
M$INT    9125**DCL-ENT
M$INTRTN    9086**DCL-ENT
M$IOQ    9121**DCL-ENT
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:276  
M$JOBSTATS    9135**DCL-ENT
M$KEYIN    9075**DCL-ENT
M$LDEV    9070**DCL-ENT
M$LDTRC    9083**DCL-ENT
M$LIMIT    9076**DCL-ENT
M$LINES    9075**DCL-ENT
M$LINK    9082**DCL-ENT
M$MADMUCK    9078**DCL-ENT
M$MAKUSER    9109**DCL-ENT
M$MBS    9077**DCL-ENT
M$MDFFLD    9101**DCL-ENT
M$MERC    9126**DCL-ENT
M$MERCS    9127**DCL-ENT
M$MIRROR    9121**DCL-ENT
M$MONINFO    9138**DCL-ENT
M$MPL    9111**DCL-ENT
M$NODEINFO    9102**DCL-ENT
M$NXTUSR    9136**DCL-ENT
M$OCMSG    9134**DCL-ENT
M$OLAY    9082**DCL-ENT
M$PAS    9111**DCL-ENT
M$PATHCON    9134**DCL-ENT
M$PDS    9105**DCL-ENT
M$PLATEN    9096**DCL-ENT
M$PROCNAME    9087**DCL-ENT
M$PROFILE    9098**DCL-ENT
M$PROMPT    9094**DCL-ENT
M$RACST    9078**DCL-ENT
M$RDSYSLOG    9119**DCL-ENT
M$RELRES    9077**DCL-ENT
M$RELSTARF    9079**DCL-ENT
M$REM    9079**DCL-ENT
M$RENV    9126**DCL-ENT
M$REQUIRE    9078**DCL-ENT
M$RETRY    9127**DCL-ENT
M$RETRYS    9127**DCL-ENT
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:277  
M$REW    9073**DCL-ENT
M$RLSFLD    9101**DCL-ENT
M$RPRIV    9129**DCL-ENT
M$RSPP    9108**DCL-ENT
M$RSWITCH    9130**DCL-ENT
M$RUE    9136**DCL-ENT
M$SAD    9109**DCL-ENT
M$SAVE    9085**DCL-ENT
M$SCON    9086**DCL-ENT
M$SCREECH    9084**DCL-ENT
M$SENV    9126**DCL-ENT
M$SETFMA    9070**DCL-ENT
M$SETFP    9099**DCL-ENT
M$SINPUT    9097**DCL-ENT
M$SLCFLD    9102**DCL-ENT
M$SMOUSE    9116**DCL-ENT
M$SMPRT    9108**DCL-ENT
M$SPRIV    9129**DCL-ENT
M$SSC    9109**DCL-ENT
M$SSWITCH    9129**DCL-ENT
M$STATE    9138**DCL-ENT
M$STD    9110**DCL-ENT
M$STIMER    9124**DCL-ENT
M$STLPP    9107**DCL-ENT
M$STRAP    9124**DCL-ENT
M$STRMATTR    9096**DCL-ENT
M$STRMCTL    9094**DCL-ENT
M$STRMTAB    9097**DCL-ENT
M$SYMBIO    9135**DCL-ENT
M$SYSCON    9121**DCL-ENT
M$SYSID    9139**DCL-ENT
M$TDCLOSE    9120**DCL-ENT
M$TDIO    9120**DCL-ENT
M$TDOPEN    9119**DCL-ENT
M$TDREQCPU    9120**DCL-ENT
M$TEMPWROC    9114**DCL-ENT
PL6.E3A0      #001=XUU$READ File=XUU$READ.:E05TSI                                WED 07/30/97 09:44 Page:278  
M$TIME    9137**DCL-ENT
M$TRAP    9124**DCL-ENT
M$TRMISC    9099**DCL-ENT
M$TRMPRG    9095**DCL-ENT
M$TRTN    9128**DCL-ENT
M$TRUNC    9071**DCL-ENT
M$TTIMER    9124**DCL-ENT
M$UC    9094**DCL
M$UMPL    9111**DCL-ENT
M$UNFID    9133**DCL-ENT
M$UNLATCH    9090**DCL-ENT
M$UNSHARE    9087**DCL-ENT
M$USRFIELD    9130**DCL-ENT
M$VIRTUAL    9105**DCL-ENT
M$WAIT    9128**DCL-ENT
M$WEOF    9073**DCL-ENT
M$WRSYSLOG    9119**DCL-ENT
M$XCON    9125**DCL-ENT
M$XCONRTN    9086**DCL-ENT
M$XEQTIME    9138**DCL-ENT
M$XFLUSH    9079**DCL-ENT
M$XMOUSE    9116**DCL-ENT
M$XXX    9082**DCL-ENT
M$YC    9084**DCL-ENT
PREPRINT_LOOP IN PROCEDURE PRINT_UPDATE  15339**LABEL
READ_LOOP   12432**LABEL
XUU$CLOSE   12777**ENTRY
XUU$OPEN   12647**ENTRY
XUU$READ      75**PROC
XUU_ERR   14751**PROC
