VERSION A06

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:1    
        1        1        /*M* Z8HC$SPECIAL_CASES - Code generation special case handler */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8             NAME: Z8HC$SPECIAL_CASES
        9        9             PURPOSE:
       10       10                  To provide the special case functions that cannot otherwise be
       11       11                  performed by existing pseudo-code directives.
       12       12             DESCRIPTION:
       13       13                  One big DO CASE, driven by the ID of the current triad (PILL).
       14       14                  Sometimes, more than one CASE directive must be interpreted
       15       15                  per ILL/ETT pseudo-code group.  For this reason, a CASE_PASS
       16       16                  must be maintained.
       17       17             REFERENCE:
       18       18                  Z8HD$DOCUMENT
       19       19        */
       20       20        /*F*
       21       21             NAME: Z8HC$SPECIAL_CASES
       22       22             PURPOSE:
       23       23                  To provide the special case functions that cannot otherwise be
       24       24                  performed by existing pseudo-code directives.
       25       25             DESCRIPTION:
       26       26                  Same as for *P* comment in Z8HC$SPECIAL_CASES
       27       27             REFERENCE:
       28       28                  Z8HD$DOCUMENT
       29       29        */
       30       30        /*D*
       31       31             NAME: Z8HC$SPECIAL_CASES
       32       32             CALL:
       33       33                  CALL Z8HC$SPECIAL_CASES(PILL, PCOM, CASE_PASS);
       34       34             PARAMETERS:
       35       35                  PILL     - Triad whose pseudo-code is now being processed.
       36       36
       37       37                  PCOM     - Program communication variables:
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:2    
       38       38
       39       39                                 AABS - ZABS   (SBIN WORD)
       40       40                                 EOPND- ZOPND  (PTR      )
       41       41
       42       42                             PCOM is automatic so that each recursion level
       43       43                             has its own fresh copy to work with.  This is
       44       44                             an improvement over COBOL-74, whose communication
       45       45                             variables are all static, and thus very vulnerable
       46       46                             to attack.
       47       47
       48       48                  CASE_PASS- It is sometimes necessary to enter this routine
       49       49                             more than once at the same interpretation level.
       50       50                             This just indicates which pass we're making.
       51       51
       52       52             INTERFACE:
       53       53                  Z8HU$WALK
       54       54                  Z8HI$BURST
       55       55                  Z8HU$DEC_COUNT
       56       56                  Z8HU$INCCNT
       57       57                  Z8HG$USE_REGISTER
       58       58                  Z8HG$FREE_REGISTER
       59       59                  Z8HG$FREE_ALL_REGISTERS
       60       60                  Z8HG$SAVE
       61       61                  Z8AE$ERROR
       62       62                  Z8AH$NEW_DNT
       63       63                  Z8AU$TYPE_DESCRIPTOR
       64       64                  Z8HU$POOL
       65       65                  Z8HU$POOL_PRIME
       66       66                  Z8HU$ALLOT_TEMP
       67       67                  Z8HU$FORCE_BOUNDARY
       68       68                  Z9AU$MOVE_NUMERIC
       69       69                  Z9AU$MOVE_C3_NUMERIC
       70       70                  Z9AU$MOVE_EBCDIC
       71       71                  Z9AU$MOVE_GBCD
       72       72                  Z8AC$MAKE_CONST
       73       73                  Z8AC$MAKE_TYA_CONST
       74       74                  Z8AF$FORME
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:3    
       75       75                  Z8AU$LENGTH_ETT
       76       76             ENVIRONMENT:
       77       77                  None.
       78       78             INPUT:
       79       79                  PILL
       80       80                      Points to current triad, the ID of which is used to drive
       81       81                      the selection process (DO CASE).
       82       82
       83       83                  PCOM
       84       84                      Automatic storage for Generator communication during a single
       85       85                      call to Z8HI$BURST. For example, the ADI triad has its own
       86       86                      fresh copy of communication variables; if ETT triads below this
       87       87                      ADI are evaluated, they too get their own copy, when the ADI is
       88       88                      returned to, its PCOM variables are intact. (This is an
       89       89                      improvement over COBOL74, whose communication variables are all
       90       90                      static, and very vulnerable to attack).
       91       91
       92       92                  CASE_PASS
       93       93                      Indicates the number of the CASE to be executed for this ILL/ETT
       94       94                      pseudo-code group.
       95       95             OUTPUT:
       96       96                  Some PCOM variables are changed.  But only those that are expected
       97       97                  to be changed in subsequent pseudo-code.
       98       98             SCRATCH:
       99       99                  Any variables that are not passed explicitly, or those that are in
      100      100                  PCOM.
      101      101             DESCRIPTION:
      102      102                  This routine handles *all* of the functions of the CASE
      103      103                  pseudo-code directive.  No PCOM variables are really *passed*
      104      104                  to this routine.  There are some assumptions made. For
      105      105                  example:
      106      106
      107      107                  consider the following hypothetical CASE directive:
      108      108
      109      109                         CASE    TABS,SABS,SOPND
      110      110
      111      111                  the operand portion of the CASE directive is strictly
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:4    
      112      112                  documentation. Thus, changing TABS to DABS will do nothing
      113      113                  to affect what PCOM variables are affected or *returned*
      114      114                  by Z8HC$SPECIAL_CASES.  References to TABS, SABS, and SOPND
      115      115                  are hard-coded into Z8HC$SPECIAL_CASES.
      116      116
      117      117                     The concept of what this thing does is very simple, it
      118      118                  sets up variables that the pseudo-code can later reference,
      119      119                  such as pointers to temps, or reducing a bunch of bits into
      120      120                  a code for use in a JMPDV directive.
      121      121        */
      122      122        /*N*   Future possibility - Currently, all PCOM variables affected
      123      123                    are hard-coded in Z8HC$SPECIAL_CASES. It would be
      124      124                    desirable to be able to change the pseudo_code CASE
      125      125                    directive to directly affect a give PCOM variable. The
      126      126                    reason that it is not done now, is because it would make
      127      127                    the CASE directive a variable length pseudo-code
      128      128                    directive.  At present, I am making an attempt to leave
      129      129                    the lengths either 1 to 2 words long.
      130      130         */
      131      131         %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:5    
      132      132        Z8HC$SPECIAL_CASES:PROC(PILL,PCOM,CASE_PASS);
      133      133
      134      134    1        DCL PILL PTR;
      135      135    1        DCL CASE_PASS SBIN WORD;
      136      136
      137      137
      138      138    1        DCL Z8HU$WALK ENTRY(1);
      139      139    1        DCL Z8HU$TAG ENTRY(2);
      140      140    1        DCL Z8HI$BURST ENTRY(2);
      141      141    1        DCL Z8HU$DEC_COUNT ENTRY(2);
      142      142    1        DCL Z8HU$DECCNT_WITHOUT_IMPL_REF ENTRY(2);
      143      143    1        DCL Z8HU$INCCNT ENTRY(2);
      144      144    1        DCL Z8HG$USE_REGISTER ENTRY(2);
      145      145    1        DCL Z8HG$FREE_REGISTER ENTRY(1);
      146      146    1        DCL Z8HG$SAVE ENTRY(1) ALTRET;
      147      147    1        DCL Z8HG$FREE_ALL_REGISTERS ENTRY;
      148      148    1        DCL Z8AE$ERROR ENTRY(12);
      149      149    1        DCL Z8AH$NEW_DNT ENTRY(3);
      150      150    1        DCL Z8AU$TYPE_DESCRIPTOR ENTRY(2);
      151      151    1        DCL Z8HU$POOL_PRIME ENTRY(1);
      152      152    1        DCL Z8HU$POOL ENTRY(1);
      153      153    1        DCL Z8HU$ALLOT_TEMP ENTRY(4);
      154      154    1        DCL Z8HU$FORCE_BOUNDARY ENTRY(1);
      155      155    1        DCL Z9AU$MOVE_NUMERIC ENTRY(4);
      156      156    1        DCL Z9AU$MOVE_EBCDIC ENTRY(4);
      157      157    1        DCL Z9AU$MOVE_GBCD ENTRY(4);
      158      158    1        DCL Z9AU$MOVE_C3_NUMERIC ENTRY(4);
      159      159    1        DCL Z8AC$MAKE_CONST ENTRY(1);
      160      160    1        DCL Z8AC$MAKE_TYA_CONST ENTRY(4);
      161      161    1        DCL Z8AF$FORME ENTRY(4);
      162      162    1        DCL Z8AU$LENGTH_ETT ENTRY(2);
      163      163
      164      164
      165      165             %EQU PHASE = 4;
      166      166             %INCLUDE Z8A_DEFC;
      167      234             %INCLUDE Z8A_SUPP_MAC;
      168     2634             %INCLUDE Z8H_PCOM;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:6    
      169     2783             %INCLUDE Z8A_SYS_FILE;
      170     9058             %INCLUDE Z8A_ILL;
      171     9751             %INCLUDE Z8A_ETT;
      172    10052             %INCLUDE Z8A_TYPES;
      173    10226             %INCLUDE Z8A_ST;
      174    13885             %INCLUDE Z8H_SUPPORT;
      175    14333             %INCLUDE Z8H_DEP;
      176    14440             %INCLUDE Z8H_RAT;
      177    14531             %INCLUDE Z8H_EXT;
      178    14582             %INCLUDE Z8H_CODE;
      179    14712             %INCLUDE Z8H_PASSES;
      180    14724             %INCLUDE Z8H_TEMP;
      181    14772             %INCLUDE Z8A_DESC;
      182    14818             %INCLUDE Z8A_ERR_NUMS;
      183    15582             %INCLUDE Z8H_OPCODES;
      184    16085             %INCLUDE Z8A_COMCOM;
      185    16735             %INCLUDE Z8A_MKCN;
      186    16752             %INCLUDE Z8A_OBJ;
      187    17249             %INCLUDE Z8A_QLT;
      188    17355             %INCLUDE Z8A_LTS;
      189    19432             %INCLUDE Z8A_ILS;
      190    19541             %INCLUDE Z8A_LIBRARY;
      191    19755             %INCLUDE Z8A_NOP_OPTS;
      192    19778         %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:7    
      193    19779    1        DCL P$ PTR;
      194    19780    1        DCL I SBIN WORD;
      195    19781    1        DCL J SBIN WORD;
      196    19782    1        DCL K SBIN WORD;
      197    19783    1        DCL TEMP_CHAR CHAR (12);
      198    19784
      199    19785    1        DCL NODE_ID   UBIN WORD;
      200    19786    1        DCL REGISTER  UBIN WORD;
      201    19787
      202    19788    1        DCL NEXT$     PTR;
      203    19789    1        DCL PRIME$    PTR;
      204    19790
      205    19791    1        DCL LOP_LEN   SBIN WORD;
      206    19792    1        DCL ROP_LEN   SBIN WORD;
      207    19793    1        DCL LOP_REF$  PTR;
      208    19794    1        DCL ROP_REF$  PTR;
      209    19795
      210    19796
      211    19797    1        DCL SSOP_SIZ_BUFFER(0:3) PTR;
      212    19798    1        DCL SSOP_SIZ_IDX SBIN WORD;
      213    19799
      214    19800    1        DCL 1 TYPE_DESC ALIGNED,
      215    19801                   %TYPE_DESC;
      216    19835
      217    19836    1        DCL TAGS(0:8) SBIN WORD CONSTANT INIT(
      218    19837
      219    19838    1                   %(BITBIN('40'O)),     /* BYTE 0   */
      220    19839    1                   %(BITBIN('20'O)),     /* BYTE 1   */
      221    19840    1                   %(BITBIN('10'O)),     /* BYTE 2   */
      222    19841    1                   %(BITBIN('04'O)),     /* BYTE 3   */
      223    19842    1                   %(BITBIN('30'O)),     /* BYTES 1 & 2 */
      224    19843    1                   %(BITBIN('70'O)),     /* BYTES 0 - 2 */
      225    19844    1                   %(BITBIN('34'O)),     /* BYTES 1 - 3 */
      226    19845    1                   %(BITBIN('60'O)),     /* BYTES 0 & 1 */
      227    19846    1                   %(BITBIN('14'O)));    /* BYTES 2 & 3 */
      228    19847
      229    19848
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:8    
      230    19849        /* These declarations are for the MVAN ILL item only */
      231    19850
      232    19851    1        DCL ITERS       SBIN WORD;
      233    19852    1        DCL REMAIN      SBIN WORD;
      234    19853
      235    19854        /* end of dedicated declarations for MVAN */
      236    19855
      237    19856
      238    19857
      239    19858        /* Beginning of dedicated declarations for SSOP  */
      240    19859
      241    19860    1        DCL REF$      PTR;
      242    19861    1        DCL NODE$    PTR;
      243    19862
      244    19863        /* End of dedicated declarations for SSOP        */
      245    19864
      246    19865
      247    19866        /* Beginning of dedicated declarations for DISPL */
      248    19867
      249    19868    1        DCL ARGLIST$           PTR;
      250    19869    1        DCL NUMBER_OF_ARGS  SBIN WORD;
      251    19870
      252    19871        /* End of dedicated declarations for DISPL */
      253    19872
      254    19873        /* Beginning of dedicated declarations for DO3, DOEND */
      255    19874
      256    19875    1        DCL ZERO_WORD SBIN CONSTANT INIT (0);
      257    19876    1        DCL ZERO_PTR$ REDEF ZERO_WORD PTR;
      258    19877    1        DCL GLIST$ PTR;
      259    19878
      260    19879        /* End of dedicated declarations for DO3, DOEND */
      261    19880
      262    19881
      263    19882        /* Beginning of dedicated declarations for MVDO */
      264    19883
      265    19884    1        DCL WORDS_FOR_TEMP SBIN WORD;
      266    19885    1        DCL TEMP$          PTR;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:9    
      267    19886    1        DCL BOUNDS         SBIN WORD;
      268    19887
      269    19888    1        DCL LDAQ_OFFSET  SBIN WORD;
      270    19889    1        DCL MVN_OFFSET   SBIN WORD;
      271    19890    1        DCL LOP_SIGN     BIT(2) ALIGNED;
      272    19891
      273    19892    1        DCL ROP_SIGN     BIT(2) ALIGNED;
      274    19893
      275    19894        /* End of dedicated declarations for MVDO */
      276    19895
      277    19896        /* Beginning of dedicated declarations for PRESET and constant gen */
      278    19897
      279    19898    1        DCL LENGTH_IN_WORDS SBIN WORD;
      280    19899    1        DCL STRING$    PTR;
      281    19900    1        DCL TARGET$    PTR;
      282    19901    1        DCL CONSTANT$  PTR STATIC;
      283    19902    1        DCL OFFSET     SBIN WORD;
      284    19903    1        DCL TOTAL_MOVED SBIN WORD;
      285    19904    1        DCL SOURCE      SBIN WORD;
      286    19905    1        DCL TARGET      SBIN WORD STATIC INIT(0);
      287    19906    1        DCL TARGET_LENGTH  SBIN WORD;
      288    19907    1        DCL BITS_IN_BUFFER SBIN WORD STATIC INIT(0);
      289    19908    1        DCL BOTTOM_HALF  SBIN HALF;
      290    19909
      291    19910    1        DCL BUFFER  SBIN WORD STATIC INIT(0);
      292    19911    1        DCL CHAR_BUFFER REDEF BUFFER CHAR(4);
      293    19912    1        DCL BCD_BUFFER (0:5) REDEF BUFFER BIT (6);
      294    19913    1        DCL BCD$CHARS (0:63) BIT (6) BASED;
      295    19914    1        DCL FLUSH_BLK$  PTR STATIC INIT(ADDR(NIL));
      296    19915
      297    19916    1        DCL MVN_BUFFER(0:63) SBIN WORD;
      298    19917    1        DCL CURRENT_SA  SBIN WORD;
      299    19918    1        DCL OLD_SA      SBIN WORD STATIC INIT(0);
      300    19919    1        DCL GO_EXPR$    PTR;
      301    19920
      302    19921
      303    19922        /* End of dedicated declarations for PRESET and constant gen */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:10   
      304    19923
      305    19924         /* Beginning of constants used by PTR_SET */
      306    19925
      307    19926
      308    19927    1        DCL VALUE_OF_NIL PTR CONSTANT INIT(ADDR(NIL));
      309    19928    1        DCL BINARY_VALUE_OF_NIL REDEF VALUE_OF_NIL UBIN WORD;
      310    19929             %IF CP6;
      311    19930    1        DCL NIL_EPTR EPTR CONSTANT INIT(ENTADDR(NIL));
      312    19931    1        DCL BINARY_VALUE_OF_NIL_EPTR REDEF NIL_EPTR UBIN WORD;
      313    19932    1        DCL NIL_EPTR$ REDEF NIL_EPTR PTR;
      314    19933             %ENDIF;
      315    19934    1        DCL SENDING$ PTR;
      316    19935
      317    19936         /* End of constants used by PTR_SET */
      318    19937
      319    19938         /* Beginning of declarations for ENTRY */
      320    19939
      321    19940    1        DCL DEF$ PTR;
      322    19941    1        DCL AVOID_DEFLAB UBIN;
      323    19942             %EQU MAIN_ENTRY     = 0;
      324    19943             %EQU SUBENT_UNMANAGED = 1;
      325    19944             %EQU SUBENT_MANAGED   = 3;
      326    19945             %EQU ZERO_ARG         = 0;
      327    19946             %EQU ONE_ARG          = 1;
      328    19947             %EQU TWO_ARG          = 2;
      329    19948             %EQU THREE_ARG        = 3;
      330    19949
      331    19950    1        DCL OPTWRD UBIN WORD;
      332    19951    1        DCL OPTCONST$ PTR;
      333    19952
      334    19953             %IF GCOS;
      335    19954 C           DCL CURRENT_ENTRY$ PTR;
      336    19955 C           DCL PREV_ENTRY$ PTR;
      337    19956             %ENDIF;
      338    19957
      339    19958         /* End of declarations for ENTRY */
      340    19959
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:11   
      341    19960         %IF CP6;
      342    19961         /* Beginning of declarations for USE_ENTRY */
      343    19962
      344    19963    1        DCL DML_IA$ PTR STATIC;
      345    19964
      346    19965         /* End of declarations for USE_ENTRY */
      347    19966         %ENDIF;
      348    19967
      349    19968         /* Beginning of dedicated declarations for EVAL */
      350    19969
      351    19970    1        DCL EVAL$ PTR;
      352    19971
      353    19972         /* End of declarations for EVAL */
      354    19973
      355    19974         /* Beginning of dedicated declarations for CVDDD */
      356    19975
      357    19976    1        DCL CURRENCY_SIGN CHAR(1) ALIGNED;
      358    19977
      359    19978         /* End of declarations for CVDDD */
      360    19979
      361    19980         /* Beginning of dedicated declarations for USER_CALL */
      362    19981
      363    19982    1        DCL DEST_PROC$ PTR;
      364    19983
      365    19984         /* End of declarations for USER_CALL */
      366    19985
      367    19986    1      DCL  ARGP_LOP$       PTR;
      368    19987    1      DCL  LTS$$           PTR;
      369    19988    1      DCL  ST$$            PTR;
      370    19989    1      DCL  P2$             PTR;
      371    19990    1      DCL  POOL_LOP_ARGP   BOOLEAN STATIC;
      372    19991    1      DCL UPPER$       PTR;
      373    19992    1      DCL LOWER$       PTR;
      374    19993
      375    19994        %EQU LOP_ARGP_PR       = 0;
      376    19995        %EQU LOP_ARGP_NO_PR    = 1;
      377    19996        %EQU LOP_ST            = 2;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:12   
      378    19997        %EQU ROP_ADDR_PR       = 0;
      379    19998        %EQU ROP_ARGP_PR       = 3;
      380    19999        %EQU ROP_ARGP_NO_PR    = 6;
      381    20000        %EQU ROP_REGULAR_PR    = 9;
      382    20001        %EQU ROP_REGULAR_ARA   = 12;
      383    20002        %EQU ROP_REGULAR_ARQ   = 15;
      384    20003        %EQU ROP_REGULAR_ST    = 18;
      385    20004        %EQU LOP_ROP_ALIAS     = 21;
      386    20005
      387    20006        %EQU MVPP0     = 0;
      388    20007        %EQU MVPP1     = 1;
      389    20008        %EQU MVPP2     = 2;
      390    20009        %EQU MVPP3     = 3;
      391    20010        %EQU MVPPAA    = 4;
      392    20011        %EQU MVPPSQ    = 5;
      393    20012        %EQU MVPPSA    = 6;
      394    20013        %EQU MVPPSS    = 7;
      395    20014
      396    20015
      397    20016    1   DCL 1 MVPP EXT,
      398    20017    1         2 STAR$      PTR,
      399    20018    1         2 ACTION#    SBIN WORD,
      400    20019    1         2 LOP_ARGP$  PTR,
      401    20020    1         2 ROP_ARGP$  PTR;
      402    20021
      403    20022    1   DCL MVPP_VEC (0:%LOP_ROP_ALIAS) UBIN WORD STATIC
      404    20023    1     INIT(
      405    20024    1   %MVPP0, /* LOP_ARGP_PR       + ROP_ADDR_PR ,0 */
      406    20025    1   %MVPP2, /* LOP_ARGP_NO_PR    + ROP_ADDR_PR ,1 */
      407    20026    1   %MVPP2, /* LOP_ST            + ROP_ADDR_PR ,2 */
      408    20027    1   %MVPP1, /* LOP_ARGP_PR       + ROP_ARG_PR  ,3 */
      409    20028    1   %MVPP3, /* LOP_ARGP_NO_PR    + ROP_ARGP_PR ,4 */
      410    20029    1   %MVPP3, /* LOP_ST            + ROP_ARGP_PR ,5 */
      411    20030    1   %MVPP1, /* LOP_ARGP_PR    + ROP_ARGP_NO_PR ,6 */
      412    20031    1   %MVPPSS,/* LOP_ARGP_NO_PR + ROP_ARGP_NO_PR ,7 */
      413    20032    1   %MVPPSS,/* LOP_ST         + ROP_ARGP_NO_PR ,8 */
      414    20033    1   %MVPP1, /* LOP_ARGP_PR     + ROP_REGULAR_PR,9 */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:13   
      415    20034    1   %MVPP2, /* LOP_ARGP_NO_PR  + ROP_REGULAR_PR,10*/
      416    20035    1   %MVPP2, /* LOP_ST          + ROP_REGULAR_PR,11*/
      417    20036    1   %MVPP1, /* LOP_ARGP_PR    + ROP_REGULAR_ARA,12*/
      418    20037    1   %MVPPSA,/* LOP_ARGP_NO_PR + ROP_REGULAR_ARA,13*/
      419    20038    1   %MVPPSA,/* LOP_ST         + ROP_REGULAR_ARA,14*/
      420    20039    1   %MVPP1 ,/* LOP_ARGP_PR    + ROP_REGULAR_ARQ,15*/
      421    20040    1   %MVPPSQ,/* LOP_ARGP_NO_PR + ROP_REGULAR_ARQ,16*/
      422    20041    1   %MVPPSQ,/* LOP_ST         + ROP_REGULAR_ARQ,17*/
      423    20042    1   %MVPP1 ,/* LOP_ARGP_PR    + ROP_REGULAR_ST ,18*/
      424    20043    1   %MVPPSS,/* LOP_ARGP_NO_PR + ROP_REGULAR_ST ,19*/
      425    20044    1   %MVPPSS,/* LOP_ST         + ROP_REGULAR_ST ,20*/
      426    20045    1   %MVPPAA /* LOP_ROP_ALIAS                   ,21*/);
      427    20046
      428    20047        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:14   
      429    20048    2        DO CASE(PILL -> ETT.ID);
      430    20049
      431    20050        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:15   
      432    20051    2   CASE(%AD2D, %AD2DR, %DV2D, %DV2DR, %MP2D, %MP2DR, %SB2D, %SB2DR);
      433    20052
      434    20053    2        CALL FREE_REGISTER_CHECK (PILL);
      435    20054
      436    20055    2   CASE(%AD3D, %AD3DR, %DV3D, %DV3DR, %MP3D, %MP3DR, %SB3D, %SB3DR);
      437    20056
      438    20057    2        CALL FREE_REGISTER_CHECK_3 (PILL);
      439    20058
      440    20059        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:16   
      441    20060    2   CASE(%AD2O, %AD2OR, %DV2O, %DV2OR, %MP2O, %MP2OR, %SB2O, %SB2OR);
      442    20061
      443    20062    2        LOP_REF$ = PILL -> ILL.LOP -> ETT.REF$;
      444    20063
      445    20064    2        IF LOP_REF$ -> REF.NDSC.TN = %NDSC9 AND
      446    20065    2           LOP_REF$ -> REF.NDSC.S = %NO_SIGN THEN
      447    20066    2          PCOM.EABS = 1;
      448    20067    2        ELSE
      449    20068    2          PCOM.EABS = 0;
      450    20069
      451    20070    2        IF LOP_REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYF THEN
      452    20071    2          PCOM.IABS = 0;
      453    20072    2        ELSE
      454    20073    2          PCOM.IABS = 1;
      455    20074        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:17   
      456    20075    2   CASE(%AD3O, %AD3OR, %DV3O, %DV3OR, %MP3O, %MP3OR, %SB3O, %SB3OR);
      457    20076
      458    20077    2        LOP_REF$ = PILL -> TRINARY_ILL.TO_ -> ETT.REF$;
      459    20078
      460    20079    2        IF LOP_REF$ -> REF.NDSC.TN = %NDSC9 AND
      461    20080    2           LOP_REF$ -> REF.NDSC.S = %NO_SIGN THEN
      462    20081    2          PCOM.EABS = 1;
      463    20082    2        ELSE
      464    20083    2          PCOM.EABS = 0;
      465    20084
      466    20085    2        IF LOP_REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYF THEN
      467    20086    2          PCOM.IABS = 0;
      468    20087    2        ELSE
      469    20088    2          PCOM.IABS = 1;
      470    20089        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:18   
      471    20090    2   CASE(%ADO, %SBO, %DVO, %MPO, %DVOR);
      472    20091
      473    20092    2        ROP_REF$ = PILL -> ETT.ROP -> ETT.REF$;
      474    20093    2        LOP_REF$ = PILL -> ETT.LOP -> ETT.REF$;
      475    20094
      476    20095    2        PCOM.EABS = 0;
      477    20096
      478    20097    2        IF (LOP_REF$ -> REF.NDSC.S = %NO_SIGN) AND
      479    20098    2           (LOP_REF$ -> REF.NDSC.TN = %NDSC9) THEN
      480    20099    2          PCOM.EABS = 1;
      481    20100    2        ELSE
      482    20101    2          IF (ROP_REF$ -> REF.NDSC.S = %NO_SIGN) AND
      483    20102    2             (ROP_REF$ -> REF.NDSC.TN = %NDSC9) THEN
      484    20103    2            PCOM.EABS = 2;
      485    20104
      486    20105        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:19   
      487    20106    2   CASE(%ARGP);
      488    20107        /*V*
      489    20108                ARGP
      490    20109
      491    20110                   An argp triad normally just generates a pointer load.
      492    20111                When referencing a parameter that has an offset within a
      493    20112                record greater than 16k, a EAX0 and a AWDX is needed in
      494    20113                addition to the LDP.
      495    20114        */
      496    20115
      497    20116    3      DO CASE ( CASE_PASS );
      498    20117
      499    20118    3        CASE( %FIRST_PASS );
      500    20119
      501    20120               %IF %USING_HALF_WORD_RELOCATION;
      502    20121    3            PCOM.JABS = %HALF_WORD_REL;
      503    20122               %ELSE;
      504    20123 C
      505    20124 C               IF PILL -> ETT.B.ESC_LIST          THEN
      506    20125 C                 DO;
      507    20126 C                   PCOM.JABS = %ON_ESC_LIST;
      508    20127 C                   PCOM.CABS = PILL -> ETT.B.PR#;
      509    20128 C                   PCOM.BABS = PILL -> ETT.B.OPTION;
      510    20129 C                 END;
      511    20130 C               ELSE
      512    20131 C                 PCOM.JABS = %NOT_ON_ESC_LIST;
      513    20132 C
      514    20133 C               PCOM.GABS = %#16K + PILL -> ETT.REF$ -> REF.SA;
      515    20134 C
      516    20135               %ENDIF;
      517    20136
      518    20137    3        CASE( %SECOND_PASS );
      519    20138
      520    20139    3            IF PILL -> ETT.ESCINF.BLK# ~= 0     THEN
      521    20140    4              DO;
      522    20141
      523    20142                     /* Generate an EAX0 */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:20   
      524    20143    4                CALL Z8HG$FREE_REGISTER(%XR0);
      525    20144
      526    20145    4                INST_WORD = '0'O;
      527    20146    4                INST_WORD.LOW.OP_CODE = %EAX0_OP + (%XR0 - 8);
      528    20147    4                INST_WORD.SA = %#16K * PILL -> ETT.ESCINF.BLK#;
      529    20148
      530    20149    4                MOD_KEY.KEY = 0;
      531    20150    4                MOD_KEY.B.RESOLVE_ADDRESS = FALSE;
      532    20151
      533    20152                     %NEW_WORD(@OU_WORD = INST_WORD,
      534    20153                               @KEY = MOD_KEY.KEY);
      535    20200
      536    20201
      537    20202                     /* Generate AWDX using X0 */
      538    20203    4                INST_WORD = '0'O;
      539    20204    4                INST_WORD.LOW.OP_CODE = %AWD_OP;
      540    20205    4                INST_WORD.LOW.MF.TAG = %XR0;
      541    20206    4                INST_WORD.Y.AR# = PILL -> ETT.STATE - 20;
      542    20207    4                INST_WORD.LOW.MF.AR = TRUE;
      543    20208    4                INST_WORD.LOW.EIS = TRUE;
      544    20209
      545    20210                     %NEW_WORD(@OU_WORD = INST_WORD);
      546    20257    4              END;
      547    20258
      548    20259    3      END;    /*  CASE  PASS  */
      549    20260        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:21   
      550    20261    2   CASE(%CCOSU);
      551    20262        /*V*
      552    20263                      CCOSU
      553    20264
      554    20265             This case is entered only by CCOSU items that have the
      555    20266             CCOSU.B.VAL_FREEZE bit set.  The purpose is to store the
      556    20267             CCOSUed item in a temp so that all following references
      557    20268             to the ETT item will use the temp, not the potentially
      558    20269             redefined item under the ETT item.  Since only reference
      559    20270             triads can be over redefinable items, they are the only
      560    20271             ones that will be moved to temps; other ETT items will
      561    20272             always be temp contained or register contained anyway.
      562    20273        */
      563    20274
      564    20275    3        DO CASE(CASE_PASS);
      565    20276    3          CASE(%FIRST_PASS);
      566    20277
      567    20278    3            PCOM.ROPND = PILL -> CCOSU.EVEX;
      568    20279
      569    20280    3            IF PCOM.ROPND -> ETT.ID = %EVAL THEN
      570    20281    3              NODE_ID = PCOM.ROPND -> ETT.LOP -> ETT.ID;
      571    20282    3            ELSE
      572    20283    3              NODE_ID = PCOM.ROPND -> ETT.ID;
      573    20284
      574    20285    3            PCOM.ROPND -> ETT.COUNT = PILL -> CCOSU.CNTE;
      575    20286    3            CALL Z8HU$WALK(PCOM.ROPND);
      576    20287
      577    20288    3            IF PILL -> CCOSU.B.EVAL THEN
      578    20289    3              PCOM.XABS = 1;
      579    20290    3            ELSE
      580    20291    3              PCOM.XABS = 0;
      581    20292
      582    20293    3            PCOM.JABS = 0;
      583    20294
      584    20295    3            IF NODE_ID <= %LAST_REFERENCE_TRIAD THEN
      585    20296    4              DO;
      586    20297                     /* DECCNT by (CNTE - 1) because there now will be
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:22   
      587    20298                        only one implied reference to REF.XXX_TAG$  */
      588    20299    4                CALL Z8HU$DEC_COUNT(PCOM.ROPND, (PILL -> CCOSU.CNTE -1));
      589    20300
      590    20301    4                CALL Z8AU$TYPE_DESCRIPTOR(PCOM.ROPND, TYPE_DESC);
      591    20302
      592    20303    5                DO CASE(TYPE_DESC.TYPE);
      593    20304    5                  CASE(%TYO, %TYF, %TYC);
      594    20305    5                    PCOM.JABS = 5;
      595    20306
      596    20307                         %#DNA#( @FROM = PCOM.ROPND,
      597    20308                                 @TO   = PCOM.KOPND );
      598    20393
      599    20394    5                  CASE(%TYQ);
      600    20395    5                    PCOM.JABS = 4;
      601    20396
      602    20397    5                  CASE(%TYI, %TYR);
      603    20398    5                    PCOM.JABS = 3;
      604    20399
      605    20400    5                  CASE(%TYD);
      606    20401    5                    PCOM.JABS = 2;
      607    20402
      608    20403    5                  CASE(ELSE);
      609    20404    5                    PCOM.JABS = 1;
      610    20405    5                END; /* Case */
      611    20406    4              END;
      612    20407    3            IF PCOM.ROPND -> ETT.STATE > %REF_T THEN
      613    20408    4              DO;
      614    20409    4                CALL Z8HG$SAVE(PCOM.ROPND);
      615    20410    4                CALL Z8HG$FREE_REGISTER(PCOM.ROPND -> ETT.STATE);
      616    20411    4              END;
      617    20412
      618    20413
      619    20414    3          CASE(%SECOND_PASS);
      620    20415    3            IF PCOM.ROPND -> ETT.REF$ -> REF.ST$ -> ST.TYPE = %TYO OR
      621    20416    3                PCOM.ROPND -> ETT.REF$ -> REF.ST$ -> ST.TYPE = %TYF OR
      622    20417    3                PCOM.ROPND -> ETT.REF$ -> REF.ST$ -> ST.TYPE = %TYC THEN
      623    20418                   %#DNA# ( @FROM = PCOM.LOPND,
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:23   
      624    20419                            @TO   = PCOM.TOPND );
      625    20504
      626    20505    3          CASE(%THIRD_PASS);
      627    20506    3            IF PCOM.LOPND -> ETT.ID = %SIZ THEN
      628    20507    3              CALL Z8HU$POOL (PCOM.LOPND -> ETT.LOP);
      629    20508
      630    20509    3            PILL -> CCOSU.EVEX -> ETT.COUNT = PILL -> CCOSU.CNTE;
      631    20510
      632    20511    3            PILL -> CCOSU.EVEX -> ETT.STATE = %REF_T;
      633    20512
      634    20513    3            PILL -> CCOSU.EVEX -> ETT.REF$ = PCOM.LOPND -> ETT.REF$;
      635    20514    3            PILL -> CCOSU.EVEX -> ETT.REF$ -> REF.ST$ -> TEMP.REFERENCES
      636    20515    3                   = PILL -> CCOSU.EVEX -> ETT.COUNT;
      637    20516
      638    20517                 %INSERT_INTO_SL_LIST( PTR = PCOM.LOPND,
      639    20518                                       ITEM = ETT,
      640    20519                                       HEAD = HEAD_ETT$,
      641    20520                                       NEXT = NEXT$ );
      642    20533
      643    20534    3        END; /* CASE (CASE_PASS) */
      644    20535
      645    20536        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:24   
      646    20537    2   CASE(%CMPAO);
      647    20538
      648    20539        %EQU CMPA_LOP_EQ_ROP = 66;
      649    20540
      650    20541    3        DO CASE(CASE_PASS);
      651    20542
      652    20543    3          CASE(%FIRST_PASS);
      653    20544
      654    20545    3            PCOM.ROPND = PILL -> ETT.ROP -> ETT.LOP;
      655    20546    3            IF PCOM.ROPND -> ETT.STATE >= %ARA AND
      656    20547    3                PCOM.ROPND -> ETT.STATE = PILL -> ETT.LOP -> ETT.STATE OR
      657    20548    3                PCOM.ROPND = PILL -> ETT.LOP THEN
      658    20549    3              PCOM.CABS = %CMPA_LOP_EQ_ROP;
      659    20550    3            ELSE
      660    20551    4            DO CASE(PILL -> ETT.ROP -> ETT.ROPCON);
      661    20552    4              CASE(%MVANO_UPPER_TO_UPPER);
      662    20553
      663    20554    4                IF PILL -> ETT.LOP -> ETT.STATE >= %ARA THEN
      664    20555    5                  DO;
      665    20556    5                    IF PILL -> ETT.LOP -> ETT.STATE < %XR0 THEN
      666    20557    6                      DO;
      667    20558    6                        PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 1);
      668    20559    6                        IF PILL -> ETT.LOP -> ETT.STATE = %ARA THEN
      669    20560    6                          PCOM.GABS = 1; /* ,QU modification */
      670    20561    6                        ELSE
      671    20562    6                          PCOM.GABS = 2; /* ,AU modification */
      672    20563    6                      END;
      673    20564    5                    ELSE
      674    20565    5                      PCOM.CABS = %(MVANO_UPPER_TO_UPPER * 3 + 1);
      675    20566    5                    IF PCOM.ROPND -> ETT.STATE >= %ARA THEN
      676    20567    5                      CALL Z8HG$SAVE (PCOM.ROPND);
      677    20568    5                  END;
      678    20569    4                ELSE IF PCOM.ROPND -> ETT.STATE >= %XR0 AND
      679    20570    4                    PCOM.ROPND -> ETT.STATE <= %XR7 THEN
      680    20571    5                  DO;
      681    20572    5                    PCOM.CABS = %(MVANO_UPPER_TO_UPPER * 3 + 2);
      682    20573    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:25   
      683    20574    5                  END;
      684    20575    4                ELSE
      685    20576    4                  PCOM.CABS = %(MVANO_UPPER_TO_UPPER * 3);
      686    20577
      687    20578    4              CASE(%MVANO_UPPER_TO_LOWER);
      688    20579
      689    20580    4                IF PCOM.ROPND -> ETT.STATE >= %ARA THEN
      690    20581    4                  CALL Z8HG$SAVE (PCOM.ROPND);
      691    20582    4                IF PILL -> ETT.LOP -> ETT.STATE >= %ARA THEN
      692    20583    4                  IF PILL -> ETT.LOP -> ETT.STATE < %XR0 THEN
      693    20584    4                    PCOM.CABS = %(MVANO_UPPER_TO_LOWER * 3 + 2);
      694    20585    4                  ELSE
      695    20586    4                    PCOM.CABS = %(MVANO_UPPER_TO_LOWER * 3 + 1);
      696    20587    4                ELSE
      697    20588    4                  PCOM.CABS = %(MVANO_UPPER_TO_LOWER * 3);
      698    20589
      699    20590    4              CASE(%MVANO_LOWER_TO_UPPER);
      700    20591
      701    20592    4                IF PILL -> ETT.LOP -> ETT.STATE >= %ARA THEN
      702    20593    4                  CALL Z8HG$SAVE (PILL -> ETT.LOP);
      703    20594    4                IF PCOM.ROPND -> ETT.STATE >= %ARA THEN
      704    20595    4                  IF PCOM.ROPND -> ETT.STATE < %XR0 THEN
      705    20596    4                    PCOM.CABS = %(MVANO_LOWER_TO_UPPER * 3 + 1);
      706    20597    4                  ELSE
      707    20598    4                    PCOM.CABS = %(MVANO_LOWER_TO_UPPER * 3 + 2);
      708    20599    4                ELSE
      709    20600    4                  PCOM.CABS = %(MVANO_LOWER_TO_UPPER * 3);
      710    20601    4                PILL -> ETT.B.REVERSED_RELATE = TRUE;
      711    20602
      712    20603    4              CASE(%MVANO_LOWER_TO_LOWER);
      713    20604
      714    20605    4                IF PILL -> ETT.LOP -> ETT.STATE >= %ARA THEN
      715    20606    5                  DO;
      716    20607    5                    IF PCOM.ROPND -> ETT.STATE >= %ARA THEN
      717    20608    5                      CALL Z8HG$SAVE (PCOM.ROPND);
      718    20609    5                    IF PILL -> ETT.LOP -> ETT.STATE < %XR0 THEN
      719    20610    5                      PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 2);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:26   
      720    20611    5                    ELSE
      721    20612    5                      PCOM.CABS = %(MVANO_LOWER_TO_LOWER * 3 + 1);
      722    20613    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
      723    20614    5                  END;
      724    20615    4                ELSE IF PCOM.ROPND -> ETT.STATE >= %XR0 AND
      725    20616    4                    PCOM.ROPND -> ETT.STATE <= %XR7 THEN
      726    20617    4                  PCOM.CABS = %(MVANO_LOWER_TO_LOWER * 3 + 2);
      727    20618    4                ELSE
      728    20619    4                  PCOM.CABS = %(MVANO_LOWER_TO_LOWER * 3);
      729    20620
      730    20621    4              CASE(%MVANO_WORD_TO_WORD);
      731    20622
      732    20623    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR
      733    20624    4                    PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      734    20625    5                  DO;
      735    20626    5                    PCOM.CABS = %(MVANO_WORD_TO_WORD * 3 + 1);
      736    20627    5                    IF PCOM.ROPND -> ETT.STATE = %ARA OR
      737    20628    5                        PCOM.ROPND -> ETT.STATE = %ARQ THEN
      738    20629    5                      CALL Z8HG$SAVE (PCOM.ROPND);
      739    20630    5                  END;
      740    20631    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARA OR
      741    20632    4                    PCOM.ROPND -> ETT.STATE = %ARQ THEN
      742    20633    5                  DO;
      743    20634    5                    PCOM.CABS = %(MVANO_WORD_TO_WORD * 3 + 2);
      744    20635    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
      745    20636    5                  END;
      746    20637    4                ELSE
      747    20638    4                  PCOM.CABS = %(MVANO_WORD_TO_WORD * 3);
      748    20639
      749    20640    4              CASE(%MVANO_EVEN_TO_EVEN);
      750    20641
      751    20642    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARAQ THEN
      752    20643    4                  PCOM.CABS = %(MVANO_EVEN_TO_EVEN * 3 + 1);
      753    20644    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARAQ THEN
      754    20645    5                  DO;
      755    20646    5                    PCOM.CABS = %(MVANO_EVEN_TO_EVEN * 3 + 2);
      756    20647    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:27   
      757    20648    5                  END;
      758    20649    4                ELSE
      759    20650    4                  PCOM.CABS = %(MVANO_EVEN_TO_EVEN * 3);
      760    20651
      761    20652    4              CASE(%MVANO_EVEN_TO_ODD);
      762    20653
      763    20654    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARAQ THEN
      764    20655    4                  PCOM.CABS = %(MVANO_EVEN_TO_ODD * 3 + 1);
      765    20656    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARAQ THEN
      766    20657    5                  DO;
      767    20658    5                    PCOM.CABS = %(MVANO_EVEN_TO_ODD * 3 + 2);
      768    20659    5                    PCOM.OABS = 1;
      769    20660    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
      770    20661    5                  END;
      771    20662    4                ELSE
      772    20663    5                  DO;
      773    20664    5                    PCOM.CABS = %(MVANO_EVEN_TO_ODD * 3);
      774    20665    5                    PCOM.OABS = 1;
      775    20666    5                  END;
      776    20667
      777    20668    4              CASE(%MVANO_ODD_TO_EVEN);
      778    20669
      779    20670    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARAQ THEN
      780    20671    5                  DO;
      781    20672    5                    PCOM.CABS = %(MVANO_ODD_TO_EVEN * 3 + 1);
      782    20673    5                    PCOM.OABS = 1;
      783    20674    5                  END;
      784    20675    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARAQ THEN
      785    20676    5                  DO;
      786    20677    5                    PCOM.CABS = %(MVANO_ODD_TO_EVEN * 3 + 2);
      787    20678    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
      788    20679    5                  END;
      789    20680    4                ELSE
      790    20681    5                  DO;
      791    20682    5                    PCOM.CABS = %(MVANO_ODD_TO_EVEN * 3);
      792    20683    5                    PCOM.OABS = 1;
      793    20684    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:28   
      794    20685    5                  END;
      795    20686
      796    20687    4              CASE(%MVANO_ODD_TO_ODD);
      797    20688
      798    20689    4                PCOM.OABS = 1;
      799    20690    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARAQ THEN
      800    20691    4                  PCOM.CABS = %(MVANO_ODD_TO_ODD * 3 + 1);
      801    20692    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARAQ THEN
      802    20693    5                  DO;
      803    20694    5                    PCOM.CABS = %(MVANO_ODD_TO_ODD * 3 + 2);
      804    20695    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
      805    20696    5                  END;
      806    20697    4                ELSE
      807    20698    4                  PCOM.CABS = %(MVANO_ODD_TO_ODD * 3);
      808    20699
      809    20700    4              CASE(%MVANO_BYTE_0);
      810    20701
      811    20702    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR
      812    20703    4                    PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      813    20704    5                  DO;
      814    20705    5                    PCOM.CABS = %(MVANO_BYTE_0 * 3 + 1);
      815    20706    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
      816    20707    5                    IF PCOM.ROPND -> ETT.STATE = %ARA OR
      817    20708    5                        PCOM.ROPND -> ETT.STATE = %ARQ THEN
      818    20709    5                      CALL Z8HG$SAVE (PCOM.ROPND);
      819    20710    5                  END;
      820    20711    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARA OR
      821    20712    4                    PCOM.ROPND -> ETT.STATE = %ARQ THEN
      822    20713    4                  PCOM.CABS = %(MVANO_BYTE_0 * 3 + 2);
      823    20714    4                ELSE IF PCOM.ROPND -> ETT.ID = %TRIAD THEN
      824    20715    4                  PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 3);
      825    20716    4                ELSE IF PILL -> ETT.LOP -> ETT.ID = %TRIAD THEN
      826    20717    5                  DO;
      827    20718    5                    PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 9);
      828    20719    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
      829    20720    5                  END;
      830    20721    4                ELSE
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:29   
      831    20722    4                  PCOM.CABS = %(MVANO_BYTE_0 * 3);
      832    20723
      833    20724    4              CASE(%MVANO_BYTE_1,
      834    20725    4                   %MVANO_BYTE_2,
      835    20726    4                   %MVANO_BYTE_3);
      836    20727
      837    20728    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR
      838    20729    4                    PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      839    20730    5                  DO;
      840    20731    5                    PCOM.CABS = PILL -> ETT.ROP -> ETT.ROPCON * 3 + 1;
      841    20732    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
      842    20733    5                    IF PCOM.ROPND -> ETT.STATE = %ARA OR
      843    20734    5                        PCOM.ROPND -> ETT.STATE = %ARQ THEN
      844    20735    5                      CALL Z8HG$SAVE (PCOM.ROPND);
      845    20736    5                  END;
      846    20737    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARA OR
      847    20738    4                    PCOM.ROPND -> ETT.STATE = %ARQ THEN
      848    20739    4                  PCOM.CABS = PILL -> ETT.ROP -> ETT.ROPCON * 3 + 2;
      849    20740    4                ELSE IF PCOM.ROPND -> ETT.ID = %TRIAD THEN
      850    20741    4                  PCOM.CABS = %(MVANO_BYTES_2_3 * 3 - MVANO_BYTE_0 + 3)
      851    20742    4                      + PILL -> ETT.ROP -> ETT.ROPCON;
      852    20743    4                ELSE IF PILL -> ILL.LOP -> ETT.ID = %TRIAD THEN
      853    20744    5                  DO;
      854    20745    5                    PCOM.CABS = %(MVANO_BYTES_2_3 * 3 - MVANO_BYTE_0 + 9)
      855    20746    5                        + PILL -> ETT.ROP -> ETT.ROPCON;
      856    20747    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
      857    20748    5                  END;
      858    20749    4                ELSE
      859    20750    4                  PCOM.CABS = PILL -> ETT.ROP -> ETT.ROPCON * 3;
      860    20751
      861    20752    4              CASE(%MVANO_BYTES_1_2);
      862    20753
      863    20754    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR
      864    20755    4                    PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      865    20756    5                  DO;
      866    20757    5                    IF PCOM.ROPND -> ETT.STATE = %ARA OR
      867    20758    5                        PCOM.ROPND -> ETT.STATE = %ARQ THEN
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:30   
      868    20759    5                      PCOM.CABS = %(MVANO_BYTES_0_1 * 3 + 2);
      869    20760    5                    ELSE
      870    20761    6                      DO;
      871    20762    6                        PCOM.CABS = %(MVANO_BYTES_1_2 * 3 + 1);
      872    20763    6                        IF PILL -> ETT.LOP -> ETT.STATE = %ARA THEN
      873    20764    6                          CALL Z8HG$FREE_REGISTER (%ARQ);
      874    20765    6                        ELSE
      875    20766    6                          CALL Z8HG$FREE_REGISTER (%ARA);
      876    20767    6                      END;
      877    20768    5                  END;
      878    20769    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARA OR
      879    20770    4                    PCOM.ROPND -> ETT.STATE = %ARQ THEN
      880    20771    5                  DO;
      881    20772    5                    PCOM.CABS = %(MVANO_BYTES_1_2 * 3 + 2);
      882    20773    5                    IF PCOM.ROPND -> ETT.STATE = %ARA THEN
      883    20774    5                      CALL Z8HG$FREE_REGISTER (%ARQ);
      884    20775    5                    ELSE
      885    20776    5                      CALL Z8HG$FREE_REGISTER (%ARA);
      886    20777    5                  END;
      887    20778    4                ELSE
      888    20779    4                  PCOM.CABS = %(MVANO_BYTES_1_2 * 3);
      889    20780
      890    20781    4              CASE(%MVANO_BYTES_0_2);
      891    20782
      892    20783    4                IF PCOM.ROPND -> ETT.STATE = %ARA OR
      893    20784    4                    PCOM.ROPND -> ETT.STATE = %ARQ THEN
      894    20785    5                  DO;
      895    20786    5                    PCOM.CABS = %(MVANO_BYTES_0_2 * 3 + 2);
      896    20787    5                    IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR
      897    20788    5                        PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      898    20789    5                      CALL Z8HG$SAVE (PILL -> ETT.LOP);
      899    20790    5                  END;
      900    20791    4                ELSE IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR
      901    20792    4                    PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      902    20793    5                  DO;
      903    20794    5                    PCOM.CABS = %(MVANO_BYTES_0_2 * 3 + 1);
      904    20795    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:31   
      905    20796    5                  END;
      906    20797    4                ELSE IF PCOM.ROPND -> ETT.ID = %TRIAD THEN
      907    20798    4                  PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 7);
      908    20799    4                ELSE IF PILL -> ETT.LOP -> ETT.ID = %TRIAD THEN
      909    20800    5                  DO;
      910    20801    5                    PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 13);
      911    20802    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
      912    20803    5                  END;
      913    20804    4                ELSE
      914    20805    4                  PCOM.CABS = %(MVANO_BYTES_0_2 * 3);
      915    20806
      916    20807    4              CASE(%MVANO_BYTES_1_3);
      917    20808
      918    20809    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR
      919    20810    4                    PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      920    20811    5                  DO;
      921    20812    5                    IF PCOM.ROPND -> ETT.STATE = %ARA OR
      922    20813    5                        PCOM.ROPND -> ETT.STATE = %ARQ THEN
      923    20814    5                      PCOM.CABS = %(MVANO_BYTES_1_3 * 3 + 4);
      924    20815    5                    ELSE
      925    20816    5                      PCOM.CABS = %(MVANO_BYTES_1_3 * 3 + 1);
      926    20817    5                  END;
      927    20818    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARA OR
      928    20819    4                    PCOM.ROPND -> ETT.STATE = %ARQ THEN
      929    20820    4                  PCOM.CABS = %(MVANO_BYTES_1_3 * 3 + 2);
      930    20821    4                ELSE IF PCOM.ROPND -> ETT.ID = %TRIAD THEN
      931    20822    4                  PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 8);
      932    20823    4                ELSE IF PILL -> ETT.LOP -> ETT.ID = %TRIAD THEN
      933    20824    5                  DO;
      934    20825    5                    PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 14);
      935    20826    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
      936    20827    5                  END;
      937    20828    4                ELSE
      938    20829    4                  PCOM.CABS = %(MVANO_BYTES_1_3 * 3);
      939    20830
      940    20831    4              CASE(%MVANO_BYTES_0_1); /* ROPND is always register-contained */
      941    20832
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:32   
      942    20833    4                IF PILL -> ETT.LOP -> ETT.STATE >= %ARA THEN
      943    20834    4                  CALL Z8HG$SAVE (PILL -> ETT.LOP);
      944    20835    4                PCOM.CABS = %(MVANO_BYTES_0_1 * 3);
      945    20836    4                IF PCOM.ROPND -> ETT.STATE = %ARA
      946    20837    4                  THEN PCOM.GABS = 1; /* ,AU modification */
      947    20838    4                  ELSE PCOM.GABS = 2; /* ,QU modification */
      948    20839    4                PILL -> ETT.B.REVERSED_RELATE = TRUE;
      949    20840
      950    20841    4              CASE(%MVANO_BYTES_2_3); /* ROPND is always register-contained */
      951    20842
      952    20843    4                IF PILL -> ETT.LOP -> ETT.STATE >= %ARA THEN
      953    20844    4                  CALL Z8HG$SAVE (PILL -> ETT.LOP);
      954    20845    4                PCOM.CABS = %(MVANO_BYTES_2_3 * 3);
      955    20846
      956    20847    4            END; /* CASE */
      957    20848
      958    20849    3          CASE(%SECOND_PASS);
      959    20850
      960    20851                 %NEW_ORG (@ST$ = COMCOM.LAST_BLOCK$);
      961    20887
      962    20888    3            IF PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 8) OR
      963    20889    3                PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 14)
      964    20890    3              THEN INST_WORD = '000777777777'O;
      965    20891    3              ELSE INST_WORD = '777777777000'O;
      966    20892                 %NEW_WORD (@OU_WORD = INST_WORD,
      967    20893                            @OFFSET = PCOM.NOPND -> ETT.LOP -> TEMP.SA,
      968    20894                            @ADVANCE_BLOCK_SIZE = NO);
      969    20941
      970    20942                 %NEW_ORG (@ST$ = "COMCOM.SEGMENT$(%PROC)");
      971    20978
      972    20979    3        END; /* CASE */
      973    20980
      974    20981        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:33   
      975    20982    2   CASE(%CMPC);
      976    20983
      977    20984    2        IF PILL -> ILL.ROP -> ETT.ID = %TRIAD THEN
      978    20985    2          PCOM.DABS = 0;
      979    20986    2        ELSE
      980    20987    2          PCOM.DABS = 1;
      981    20988
      982    20989        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:34   
      983    20990    2   CASE(%CMPO);
      984    20991
      985    20992    2        IF PILL -> ILL.LOP -> ETT.REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYO OR /*#42747*/
      986    20993    2            PILL -> ILL.ROP -> ETT.REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYO
      987    20994    2          THEN PCOM.GABS = BITBIN ('400000000000'O); /* ASCII */
      988    20995        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:35   
      989    20996    2   CASE(%CMPR, %CMPQ, %CMPI);
      990    20997        /*V*
      991    20998                   CMPR   CMPQ   CMPI
      992    20999
      993    21000                   If the rop of the comparison triad is register contained
      994    21001                and the lop is storage contained, we will generate the
      995    21002                reverse comparison to avoid an extra store instruction.
      996    21003                The transfer generated by the go item will also have to
      997    21004                be reversed if the ETT.B.REVERSED_RELATE bit is set.
      998    21005                This only applies to non-EIS comparisons.
      999    21006        */
     1000    21007    2        PILL -> ETT.B.REVERSED_RELATE = TRUE;
     1001    21008
     1002    21009        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:36   
     1003    21010    2   CASE(%CVDDD);
     1004    21011        /*V*
     1005    21012                   CVDDD
     1006    21013
     1007    21014                 Convert decimal edited to unedited decimal.  This requires
     1008    21015              a call to the library, most of which is handled in pseudo-code.
     1009    21016              The library routine needs the current currency sign, which
     1010    21017              comes from the PROC_ item of the current scope.
     1011    21018        */
     1012    21019
     1013    21020    2        CURRENCY_SIGN = CURRENT_SCOPE$ -> PROC_.PROC_SUPP$ ->
     1014    21021    2                               PROC_SUPP.CURRENCY_SIGN;
     1015    21022
     1016    21023    2        CALL Z8AC$MAKE_TYA_CONST(CURRENCY_SIGN, 1, 0, PCOM.SOPND);
     1017    21024        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:37   
     1018    21025    2   CASE(%CVDF, %CVDO);
     1019    21026
     1020    21027    2        TYPE_DESC.SIZ$ = ADDR(NIL);
     1021    21028    2        TYPE_DESC.SSOP$ = ADDR(NIL);
     1022    21029
     1023    21030    2        IF PILL -> ETT.ID = %CVDF THEN
     1024    21031    3          DO;
     1025    21032    3            IF PILL -> ETT.DESC.NDSC.S = %NO_SIGN
     1026    21033    3              THEN PCOM.IABS = 2;
     1027    21034    3              ELSE PCOM.IABS = 0;
     1028    21035    3          END;
     1029    21036    2        ELSE
     1030    21037    2          PCOM.IABS = 1;
     1031    21038
     1032    21039    2        IF COMCOM.OB.ELS   THEN
     1033    21040    3          DO;
     1034    21041    3            IF PILL -> ETT.ID = %CVDO THEN
     1035    21042    3              PCOM.EABS = 0;
     1036    21043    3            ELSE
     1037    21044    4              DO; /* %CVDF */
     1038    21045    4                LOP_REF$ = PILL -> ETT.LOP -> ETT.REF$;
     1039    21046    4                LOP_SIGN = LOP_REF$ -> REF.NDSC.S;
     1040    21047
     1041    21048    4                IF LOP_SIGN ~= %NO_SIGN THEN
     1042    21049    5                  DO;    /* We need first to do an MVN then the
     1043    21050                                 MVNX because MVNX does not handle signed
     1044    21051                                 ASCII to EBCDIC moves. We need a temp to hold the
     1045    21052                                 results of the MVN. */
     1046    21053    5                    SCALE = LOP_REF$ -> REF.NDSC.SF;
     1047    21054    5                    PCOM.EABS = 1;
     1048    21055    5                    LOP_LEN = LOP_REF$ -> REF.NDSC.N;
     1049    21056    5                    TN = %NDSC4;
     1050    21057    5                    TYPE_DESC.TYPE = %TYD;
     1051    21058    5                    BOUNDS = %NEXT;
     1052    21059
     1053    21060                         %PACK_NDSC(@DESC = TYPE_DESC.DESC,
     1054    21061                                    @LENGTH = LOP_LEN,
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:38   
     1055    21062                                    @TN = TN,
     1056    21063                                    @SCALE = SCALE,
     1057    21064                                    @SIGN = ROP_SIGN);
     1058    21113
     1059    21114    5                    CALL Z8HU$ALLOT_TEMP(%N          ,/* FORMAT     */
     1060    21115    5                                         BOUNDS      ,/* BOUNDARY   */
     1061    21116    5                                         TYPE_DESC   ,/* DESCRIPTOR */
     1062    21117    5                                         %STALE     );/* FRESHNESS  */
     1063    21118    5                    PCOM.EOPND = ETT$;
     1064    21119    5                  END;
     1065    21120    4                ELSE
     1066    21121    4                  PCOM.EABS = 0;
     1067    21122    4              END;
     1068    21123    3          END; /* ELS */
     1069    21124    2        ELSE
     1070    21125    3          DO;
     1071    21126
     1072    21127    3            LOP_LEN = PILL -> ETT.DESC.NDSC.N;
     1073    21128    3            SCALE = PILL -> ETT.DESC.NDSC.SF;
     1074    21129    3            LOP_SIGN = PILL -> ETT.DESC.NDSC.S;
     1075    21130
     1076    21131    3            IF LOP_SIGN = %LEADING_SIGN THEN
     1077    21132    4              DO;
     1078    21133    4                PCOM.JABS = 0; /* Flag, leading sign */
     1079    21134    4                WORDS_FOR_TEMP = ((LOP_LEN + 14) / 8);
     1080    21135    4                BOUNDS = %EVEN;
     1081    21136    4                LDAQ_OFFSET = 0; /* Word offset to doubleword with sign, first digit */
     1082    21137    4                MVN_OFFSET = 7; /* Digit offset to sign */
     1083    21138    4              END;
     1084    21139    3            ELSE
     1085    21140    4              DO;
     1086    21141    4                PCOM.JABS = 1; /* Flag, trailing sign */
     1087    21142    4                WORDS_FOR_TEMP = ((LOP_LEN + 15) / 8);
     1088    21143
     1089    21144    4                IF MOD(WORDS_FOR_TEMP,2) = 0 THEN
     1090    21145    4                  BOUNDS = %EVEN;
     1091    21146    4                ELSE
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:39   
     1092    21147    4                  BOUNDS = %ODD;
     1093    21148
     1094    21149    4                LDAQ_OFFSET = WORDS_FOR_TEMP - 2;
             21149                         /* Word offset to doubleword with last digit, sign */
     1095    21150    4                MVN_OFFSET = ((WORDS_FOR_TEMP - 1) * 8) - LOP_LEN;
             21150                         /* Digit offset to sign */
     1096    21151    4              END;
     1097    21152
     1098    21153    3            TN = %NDSC4;
     1099    21154    3            TYPE_DESC.TYPE = %TYO;
     1100    21155    3            LENGTH = WORDS_FOR_TEMP *  8;
     1101    21156
     1102    21157                 %PACK_NDSC ( @DESC      = TYPE_DESC.DESC ,
     1103    21158                              @LENGTH    = LENGTH ,
     1104    21159                              @SIGN      = SIGN ,
     1105    21160                              @TN        = TN ,
     1106    21161                              @SCALE     = SCALE );
     1107    21210
     1108    21211    3            CALL Z8HU$ALLOT_TEMP(%N               ,/* Format          */
     1109    21212    3                                 BOUNDS           ,/* Boundary        */
     1110    21213    3                                 TYPE_DESC        ,/* Descriptor      */
     1111    21214    3                                 %STALE          );/* Reuse a temp    */
     1112    21215
     1113    21216    3            TEMP$ = ETT$;
     1114    21217
     1115    21218                 %#OFF#(@FROM=TEMP$,@TO=PCOM.LOPND,@VALUE=LDAQ_OFFSET,@TYPE=%WORD_);
     1116    21298
     1117    21299                 %#OFF#(@FROM=TEMP$,@TO=PCOM.MOPND,@VALUE=MVN_OFFSET,@TYPE=%NUMERIC4);
     1118    21379
     1119    21380                 %#DESC#_NDSC(@FROM=PCOM.MOPND,@TO=PCOM.UOPND,@LENGTH=LOP_LEN,@SIGN=LOP_SIGN
             21380                     );
     1120    21592
     1121    21593                 %#DESC#_NDSC(@FROM=PCOM.IOPND,@TO=PCOM.NOPND,@LENGTH=LOP_LEN,@SIGN=%NO_SIGN
             21593                     );
     1122    21805
     1123    21806    3            IF LOP_SIGN = %LEADING_SIGN THEN
     1124    21807    3              I = 0;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:40   
     1125    21808    3            ELSE
     1126    21809    3              I = PILL -> ETT.DESC.NDSC.N - 1;
     1127    21810
     1128    21811                 %#DNA#(@FROM=PCOM.IOPND,@TO=PCOM.YOPND);
     1129    21896                 %#DESC#_ADSC(@FROM=PCOM.YOPND,@TO=PCOM.FOPND,@LENGTH=1);
     1130    22041                 %#OFF#(@FROM=PCOM.FOPND,@TO=PCOM.OOPND,@VALUE=I,@TYPE=%ALPHA9);
     1131    22121
     1132    22122    3            CALL Z8HU$DEC_COUNT(TEMP$, 2);
     1133    22123    3            CALL Z8HU$DEC_COUNT(PCOM.MOPND,1);
     1134    22124    3            IF PILL -> ETT.ID = %CVDF
     1135    22125    3              THEN CALL Z8HU$INCCNT(PCOM.YOPND,1);
     1136    22126    3              ELSE CALL Z8HU$DEC_COUNT(PCOM.YOPND,1);
     1137    22127    3            CALL Z8HU$DEC_COUNT(PCOM.FOPND,1);
     1138    22128    3          END;
     1139    22129
     1140    22130        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:41   
     1141    22131    2   CASE(%CVDQR);
     1142    22132    2        PCOM.SOPND = PILL -> ETT.LOP;
     1143    22133    2        PCOM.JOPND = PILL -> ETT.LOP;
     1144    22134
     1145    22135    2        CALL Z8HU$INCCNT(PILL -> ETT.LOP,1);
     1146    22136
     1147    22137
     1148    22138    2   CASE(%CVDRR);
     1149    22139    2        PCOM.SOPND = PILL -> ETT.LOP;
     1150    22140    2        PCOM.JOPND = PILL -> ETT.LOP;
     1151    22141
     1152    22142    2        CALL Z8HU$INCCNT(PILL -> ETT.LOP,1);
     1153    22143
     1154    22144
     1155    22145        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:42   
     1156    22146    2   CASE(%CVDSF);
     1157    22147
     1158    22148        /*V*
     1159    22149
     1160    22150                         CVDSF
     1161    22151
     1162    22152                Convert decimal scale factor to zero.
     1163    22153
     1164    22154                Certain of the instructions on the Level 66 require
     1165    22155             a scale factor of zero in order to properly perform
     1166    22156             the operation. A CVDSF triad will be found below any
     1167    22157             triad that will generate one of these demanding
     1168    22158             instructions (CVDI is one such triad).
     1169    22159
     1170    22160             OPERATION:
     1171    22161
     1172    22162                If a zero scale factor is already present, no code
     1173    22163             need be generated.  However, if the scale factor is non-zero,
     1174    22164             an MVN instruction will be generated, moving the data to
     1175    22165             a zero scale factor, leading sign temp.
     1176    22166
     1177    22167        */
     1178    22168    2        P$ = PILL -> ETT.LOP -> ETT.REF$;
     1179    22169
     1180    22170    2        IF P$ -> REF.NDSC.SF ~= 0
     1181    22171    2        OR P$ -> REF.NDSC.S = %FLOATING_POINT_LEADING_SIGN THEN
     1182    22172    2          PCOM.CABS = 1;
     1183    22173    2        ELSE
     1184    22174    3          DO;
     1185    22175    3            PCOM.CABS = 0;
     1186    22176
     1187    22177                 %NEW_REF;
     1188    22286
     1189    22287    3            LTS$ -> REF = P$ -> REF;
     1190    22288
     1191    22289                 %IMPLIED_REF(REF$=LTS$, CNT=PILL -> ETT.COUNT);
     1192    22303
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:43   
     1193    22304    3            PILL -> ETT.REF$ = LTS$;
     1194    22305    3            PILL -> ETT.STATE = %REF_T;
     1195    22306    3          END;
     1196    22307
     1197    22308        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:44   
     1198    22309    2   CASE(%CVOD4,%CVOD9);
     1199    22310
     1200    22311    3        DO CASE(CASE_PASS);
     1201    22312    3          CASE(%FIRST_PASS);
     1202    22313    3            LOP_REF$ = PILL -> ETT.LOP -> ETT.REF$;
     1203    22314
     1204    22315    3            IF LOP_REF$ ->REF.ST$ -> ST.TYPE = %TYF
     1205    22316    3              THEN PCOM.IABS = 0; /* Flag for EBCDIC */
     1206    22317    3              ELSE PCOM.IABS = 1; /* Flag for ASCII */
     1207    22318
     1208    22319    3            IF NOT COMCOM.OB.ELS THEN
     1209    22320    4              DO;
     1210    22321    4                SIGN = LOP_REF$ -> REF.NDSC.S;
     1211    22322
     1212    22323    4                IF SIGN = %LEADING_SIGN THEN
     1213    22324    4                  PCOM.TABS = 0;
     1214    22325    4                ELSE
     1215    22326    4                  PCOM.TABS = 1;
     1216    22327
     1217    22328    4                IF PCOM.IABS = 0 /* EBCDIC */ THEN
     1218    22329                       %#DNA#(@FROM=PILL -> ETT.LOP,@TO=PCOM.XOPND);
     1219    22414    4                ELSE
     1220    22415                       %#DNA#(@FROM=PILL -> ETT.LOP,@TO=PCOM.OOPND);
     1221    22500    4              END;
     1222    22501
     1223    22502    3          CASE(%SECOND_PASS);
     1224    22503                 %#DNA#(@FROM=PCOM.NOPND,@TO=PCOM.XOPND);
     1225    22588
     1226    22589    3        END /* Case */;
     1227    22590        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:45   
     1228    22591    2   CASE(%CVQD4,%CVQD9);
     1229    22592    2        PCOM.SOPND = PILL -> ETT.LOP;
     1230    22593    2        PCOM.JOPND = PCOM.ROPND;
     1231    22594
     1232    22595    2        CALL Z8HU$INCCNT(PCOM.ROPND,1);
     1233    22596
     1234    22597
     1235    22598    2   CASE(%CVRD4,%CVRD9);
     1236    22599    2        PCOM.SOPND = PILL -> ETT.LOP;
     1237    22600    2        PCOM.JOPND = PCOM.ROPND;
     1238    22601
     1239    22602    2        CALL Z8HU$INCCNT(PCOM.ROPND,1);
     1240    22603
     1241    22604
     1242    22605        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:46   
     1243    22606    2   CASE(%CVRQ);
     1244    22607        /*V*
     1245    22608
     1246    22609                                       CVRQ
     1247    22610
     1248    22611            PURPOSE: Determine if ARQ register was used for other than for floating point
     1249    22612                     generation.
     1250    22613        DESCRIPTION: Before performing conversion from single to double precision,
     1251    22614                     it must be determined if the ARQ has been used for other than
     1252    22615                     floating point operations.  This is done because if the register
     1253    22616                     has been used, it must be reset to zero before double
     1254    22617                     precision operations can be performed.
     1255    22618
     1256    22619                     Examples::
     1257    22620
     1258    22621                         Used  MOVE R TO Q(I).     Unused  MOVE Q TO R.
     1259    22622                         ====                      ======
     1260    22623
     1261    22624                         FLD     R                 FLD      R
     1262    22625                         LDQ     I                 DFSTR    Q
     1263    22626                         QLS     1
     1264    22627                         EAX7    0,QL
     1265    22628                         LDQ     0,DL *
     1266    22629                         DFSTR   Q,X7
     1267    22630
     1268    22631
     1269    22632                         Dirty               Not Dirty
     1270    22633         PCOM.XABS         1                     0
     1271    22634
     1272    22635        */
     1273    22636
     1274    22637    2        IF RAT.B.DIRTY_ARQ(%AREA) THEN
     1275    22638    2          PCOM.XABS = 1;
     1276    22639    2        ELSE
     1277    22640    2          PCOM.XABS = 0;
     1278    22641
     1279    22642        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:47   
     1280    22643        %IF GCOS;
     1281    22644 C      CASE(%CVT);
     1282    22645 C
     1283    22646 C           IF PILL -> ETT.ROP -> ETT.ID = %TRIAD
     1284    22647 C               OR PILL -> ETT.ROP -> ETT.ID = %BASE THEN
     1285    22648 C             PCOM.DABS = 0;
     1286    22649 C           ELSE
     1287    22650 C             PCOM.DABS = 1;
     1288    22651 C
     1289    22652 C      %EJECT;
     1290    22653        %ENDIF;
     1291    22654    2   CASE(%DEFLB);
     1292    22655
     1293    22656            %IF GCOS;
     1294    22657 C          IF PILL -> ILL.LOP -> LABEL.B.EXIT_PROG_LABEL THEN
     1295    22658 C            CALL RESTORE_GLOBAL_REGISTERS;
     1296    22659            %ENDIF;
     1297    22660
     1298    22661        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:48   
     1299    22662    2   CASE(%DISPL);
     1300    22663
     1301    22664    2        ARGLIST$ = PILL -> ETT.ROP;
     1302    22665    2        NUMBER_OF_ARGS = ARGLIST$ -> LTS.N - 1;
     1303    22666
     1304    22667    3        DO CASE(CASE_PASS);
     1305    22668    3          CASE(%FIRST_PASS);
     1306    22669    3            PCOM.OABS = 0;
     1307    22670
     1308    22671    3            PCOM.DABS = NUMBER_OF_ARGS;
     1309    22672
     1310    22673    3          CASE(%SECOND_PASS);
     1311    22674    4            DO I = 0 TO NUMBER_OF_ARGS - 1;
     1312    22675    4              CALL Z8HU$DEC_COUNT(ARGLIST$ -> ARGLIST.ARG$(I),1);
     1313    22676    4            END;
     1314    22677
     1315    22678    3        END /* Case */;
     1316    22679        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:49   
     1317    22680    2   CASE(%DOEND);
     1318    22681
     1319    22682        /*V*
     1320    22683
     1321    22684                       DOEND
     1322    22685
     1323    22686               See individual DO items (DO1, DO2, etc.).
     1324    22687
     1325    22688        */
     1326    22689
     1327    22690    2        PCOM.IABS = PILL -> DO_N.ITB -> ILS.ILL$ -> DO_N.ID - %DO1;
     1328    22691    2        IF PCOM.IABS = %(DO3 - DO1) THEN
     1329    22692    3          DO;
     1330    22693    3            GLIST$ = PILL -> DO_N.ITB -> ILS.ILL$ -> DO_N.GLIST;
     1331    22694    3            IF GLIST$ ~= ZERO_PTR$ AND
     1332    22695    4                GLIST$ ~= ADDR (NIL) THEN DO;
     1333    22696    4              J = GLIST$ -> LTS_PTR_ARRAY.N - 3;
     1334    22697    5              DO I = 0 TO J;
     1335    22698    6                IF GLIST$ -> LTS_PTR_ARRAY.P$ (I) ~= ADDR (NIL) THEN DO;
     1336    22699    6                  GLIST$ -> LTS_PTR_ARRAY.P$ (I) -> ETT.B.OPT_SEARCH = FALSE;
     1337    22700    6                  REGISTER = GLIST$ -> LTS_PTR_ARRAY.P$ (I) -> ETT.STATE;
     1338    22701    6                  RAT.CLASS (REGISTER) = %DEMAND;
     1339    22702    6                  CALL Z8HU$DEC_COUNT(GLIST$ -> LTS_PTR_ARRAY.P$ (I),
     1340    22703    6                                      1);
     1341    22704    6                END;
     1342    22705    5              END; /* DO I = 0 TO J */
     1343    22706    4            END; /* DO_N.GLIST ~= 0 OR ADDR (NIL) */
     1344    22707    3          END; /* IABS = %(DO3 - DO1) */
     1345    22708    2        PCOM.XOPND = PILL -> DO_N.ITB -> ILS.ILL$ -> DO_N.TEMP;
     1346    22709    2        PCOM.QOPND = PILL -> DO_N.ITB -> ILS.ILL$ -> DO_N.LABEL;
     1347    22710    2        PCOM.EOPND = PILL -> DO_N.ITB -> ILS.ILL$ -> DO_N.END_LAB$;
     1348    22711
     1349    22712    2        CUR_LOOP_LEVEL = CUR_LOOP_LEVEL - 1;
     1350    22713
     1351    22714        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:50   
     1352    22715    2   CASE(%DO1, %DO4, %DO5);
     1353    22716
     1354    22717    2        CUR_LOOP_LEVEL = CUR_LOOP_LEVEL + 1;
     1355    22718
     1356    22719        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:51   
     1357    22720    2   CASE(%DO3);
     1358    22721
     1359    22722        /*V*
     1360    22723                         DO3
     1361    22724
     1362    22725                If this DO3 is for the SEARCH statement then there may be up to
     1363    22726             3 ESC/ARGP triads that require special handling. If one is already
     1364    22727             assigned global, delete it from the list. Otherwise load it if
     1365    22728             necessary and mark it temporarily global until the DOEND.
     1366    22729
     1367    22730        */
     1368    22731
     1369    22732    2        CUR_LOOP_LEVEL = CUR_LOOP_LEVEL + 1;
     1370    22733
     1371    22734    2        GLIST$ = PILL -> DO_N.GLIST;
     1372    22735    2        IF GLIST$ ~= ZERO_PTR$ AND
     1373    22736    3            GLIST$ ~= ADDR (NIL) THEN DO;
     1374    22737    3          J = GLIST$ -> LTS_PTR_ARRAY.N - 3;
     1375    22738    4          DO I = 0 TO J;
     1376    22739    5            IF GLIST$ -> LTS_PTR_ARRAY.P$ (I) ~= ADDR (NIL) THEN DO;
     1377    22740    5              REGISTER = GLIST$ -> LTS_PTR_ARRAY.P$ (I) -> ETT.STATE;
     1378    22741    6              IF REGISTER < %PR0 OR RAT.CLASS (REGISTER) = %DEMAND THEN DO;
     1379    22742    6                GLIST$ -> LTS_PTR_ARRAY.P$ (I) -> ETT.B.OPT_SEARCH = TRUE;
     1380    22743    6                CALL Z8HU$INCCNT(GLIST$ -> LTS_PTR_ARRAY.P$ (I),
     1381    22744    6                                 1);
     1382    22745    7                IF REGISTER < %PR0 THEN DO;
     1383    22746    7                  K = GLIST$ -> LTS_PTR_ARRAY.P$ (I) -> ETT.ID;
     1384    22747    7                  CALL Z8HI$BURST (GLIST$ -> LTS_PTR_ARRAY.P$ (I),
     1385    22748    7                                   PEPD (K));
     1386    22749    7                  REGISTER = GLIST$ -> LTS_PTR_ARRAY.P$ (I) -> ETT.STATE;
     1387    22750    7                END;
     1388    22751    6                RAT.CLASS (REGISTER) = %GLOBAL; /* Temporarily GLOBAL until DOEND */
     1389    22752    6              END;
     1390    22753    5              ELSE /* Already GLOBAL */
     1391    22754    5                GLIST$ -> LTS_PTR_ARRAY.P$ (I) = ADDR (NIL);
     1392    22755    5            END; /* IF LTS_PTR_ARRAY.P$ (I) ~= ADDR (NIL) */
     1393    22756    4          END; /* I = 0 TO J */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:52   
     1394    22757    3        END; /* DO_N.GLIST ~= ZERO_PTR$ AND ADDR (NIL) */
     1395    22758
     1396    22759        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:53   
     1397    22760    2   CASE(%DO2);
     1398    22761
     1399    22762        /*V*
     1400    22763                         DO2
     1401    22764
     1402    22765                After all of the pre-loop code is generated, we have
     1403    22766             to save away the loop iteration temp address as well as the
     1404    22767             beginning of loop address, both necessary at DOEND time
     1405    22768             (the DOEND generates the post-loop code).
     1406    22769
     1407    22770        */
     1408    22771
     1409    22772
     1410    22773    2        PILL -> DO_N.TEMP = PCOM.XOPND;
     1411    22774    2        PILL -> DO_N.LABEL = PCOM.QOPND;
     1412    22775    2        PILL -> DO_N.END_LAB$ = PCOM.EOPND;
     1413    22776
     1414    22777    2        CUR_LOOP_LEVEL = CUR_LOOP_LEVEL + 1;
     1415    22778
     1416    22779        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:54   
     1417    22780    2   CASE(%END);
     1418    22781        /*V*
     1419    22782                  END
     1420    22783
     1421    22784                First Pass -
     1422    22785                    Check to see if there is pending preset data.  If
     1423    22786                    there is any then we have a problem because the
     1424    22787                    linker claims that we can only write into ou locations
     1425    22788                    beyond the current point.  It is likely that pending
     1426    22789                    preset data will be for a location somewhere prior
     1427    22790                    to the current bottom of the ou
     1428    22791
     1429    22792                Second Pass -
     1430    22793                    Clean up:  Check for correct pooling of generator
     1431    22794                    items and check storage allocation.
     1432    22795        */
     1433    22796
     1434    22797    3        DO CASE(CASE_PASS);
     1435    22798    3          CASE(%FIRST_PASS);
     1436    22799
     1437    22800                 /* ROOT_PROC_BLOCK$ points to the fixed permanent segment */
     1438    22801    3            COMCOM.SEGMENT$(%PROC) = ROOT_PROC_BLOCK$;
     1439    22802
     1440    22803    3            IF BITS_IN_BUFFER ~= 0 THEN
     1441    22804    4              DO;
     1442    22805    4                CALL Z8AE$ERROR(%E$PRESET_BUFFER_NOT_EMPTY);
     1443    22806
     1444    22807                     /* Flush pending preset data and see what
     1445    22808                        happens */
     1446    22809    4                CALL FLUSH_BUFFER(OLD_SA);
     1447    22810    4              END;
     1448    22811
     1449    22812    3          CASE(%SECOND_PASS);
     1450    22813    3            COMCOM.PROC_END = COMCOM.SEGMENT$(%PROC) -> SEGMENT.SIZE - 1;
     1451    22814
     1452    22815             %IF ~USING_HALF_WORD_RELOCATION;
     1453    22816 C
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:55   
     1454    22817 C               IF COMCOM.SEGMENTC > 1 THEN
     1455    22818 C                 DO;
     1456    22819 C                   DO WHILE (ROOT_PROC_BLOCK$ ~= ADDR(NIL));
     1457    22820 C
     1458    22821 C                    COMCOM.SEGMENT$(ROOT_PROC_BLOCK$ -> SEGMENT.COUNT) = ROOT_PROC_BLOCK$;
     1459    22822 C                     ROOT_PROC_BLOCK$ = ROOT_PROC_BLOCK$ -> SEGMENT.NEXT;
     1460    22823 C
     1461    22824 C                   END;
     1462    22825 C                 END;
     1463    22826             %ENDIF;
     1464    22827
     1465    22828    4            DO WHILE(CONST$ ~= ADDR(NIL));
     1466    22829
     1467    22830                   %IF ~USING_HALF_WORD_RELOCATION;
     1468    22831 C
     1469    22832 C                   IF COMCOM.SEGMENTC > 1 THEN
     1470    22833 C                     IF CURRENT_BLOCK$ ~=
     1471    22834 C                       COMCOM.SEGMENT$(CONST$ -> CONST.COUNT) THEN
     1472    22835 C                       DO;
     1473    22836 C                         CURRENT_BLOCK$ = COMCOM.SEGMENT$(CONST$ -> CONST.COUNT);
     1474    22837 C
     1475    22838 C                         %NEW_ORG (@ST$ = CURRENT_BLOCK$);
     1476    22839 C
     1477    22840 C                       END;
     1478    22841 C
     1479    22842                   %ENDIF;
     1480    22843
     1481    22844    4              MOD_KEY.B = '0'O;
     1482    22845
     1483    22846    4              LENGTH = 1;
     1484    22847
     1485    22848    4              IF CONST$ -> CONST.B.TWO_WORD THEN
     1486    22849    5                DO;
     1487    22850    5                  LENGTH = 2;
     1488    22851    5                  CALL Z8HU$FORCE_BOUNDARY(%EVEN);
     1489    22852    5                END;
     1490    22853    4              ELSE
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:56   
     1491    22854    4                IF CONST$ -> CONST.B.LONG_CONSTANT THEN
     1492    22855    4                  LENGTH = (CONST$ -> CONST.CONST$.PTR$ -> LCNST.N - 1);
     1493    22856
     1494    22857                   %GET_CONSTANT_ADDRESS ( @CONSTANT=CONST$, @STRING=STRING$);
     1495    22865
     1496    22866    4              CALL FLUSH(CONST$,STRING$,BINBIT(CURRENT_BLOCK$->SEGMENT.SIZE,36),LENGTH)
             22866                       ;
     1497    22867
     1498    22868    4              CONST$ -> CONST.SA = CURRENT_BLOCK$ -> BLOCK.SIZE;
     1499    22869    4              LENGTH = CURRENT_BLOCK$ -> BLOCK.SIZE + LENGTH;
     1500    22870    4              IF LENGTH >= %#256K THEN
     1501    22871    4                CALL Z8AE$ERROR (%E$CODE_LIMIT);
     1502    22872    4              CURRENT_BLOCK$ -> BLOCK.SIZE = LENGTH;
     1503    22873
     1504    22874    4              CONST$ = CONST$ -> CONST.ALLOC_LINK;
     1505    22875    4            END;
     1506    22876
     1507    22877               %IF ~USING_HALF_WORD_RELOCATION;
     1508    22878 C               GENERATING_PTRS = TRUE;
     1509    22879 C
     1510    22880 C      /* Generate a pointer constant for each data block. If Cobol
     1511    22881 C         segmentation exists, the pointer constant must appear in the
     1512    22882 C         segment that references data in that data block. For this
     1513    22883 C         pointer constant to be generated in the appropriate segment, a
     1514    22884 C         redundant block item of that data block is created and its
     1515    22885 C         .B.SCOUNT field is set to the segment number it belongs to.
     1516    22886 C         For more details, look into the macro call %SEGMENTED_BLOCK_CHECK
     1517    22887 C         which is used in Z8HI. All the redundant block items will be removed
     1518    22888 C         immediately after the pointer constants have been generated, so
     1519    22889 C         phase 5 Z9IO won't generate redundant SECTDEFs.
     1520    22890 C      */
     1521    22891 C
     1522    22892 C               CURRENT_BLOCK$ = COMCOM.SEGMENT$(%PROC);
     1523    22893 C               IF COMCOM.SEGMENTC > 1 THEN
     1524    22894 C                 %NEW_ORG(@ST$ = CURRENT_BLOCK$);
     1525    22895 C               P$ = COMCOM.BLOCK$;
     1526    22896 C
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:57   
     1527    22897 C               DO WHILE(P$ ~= ADDR(NIL));
     1528    22898 C
     1529    22899 C                 IF COMCOM.SEGMENTC > 1 AND
     1530    22900 C                   CURRENT_BLOCK$ ~= COMCOM.SEGMENT$(P$ -> BLOCK.B.SCOUNT) THEN
     1531    22901 C                   DO;
     1532    22902 C                     CURRENT_BLOCK$ = COMCOM.SEGMENT$(P$ -> BLOCK.B.SCOUNT);
     1533    22903 C
     1534    22904 C                     %NEW_ORG (@ST$ = CURRENT_BLOCK$);
     1535    22905 C                   END;
     1536    22906 C
     1537    22907 C                 IF P$ -> BLOCK.B.SZIE_256K
     1538    22908 C                   THEN K = %#256K
     1539    22909 C                   ELSE K = P$ -> BLOCK.SIZE;
     1540    22910 C
     1541    22911 C                 I = CURRENT_BLOCK$ -> SEGMENT.SIZE;
     1542    22912 C
     1543    22913 C                 /* Add a word to be sure .DATA. ends on a full word. */
     1544    22914 C
     1545    22915 C                 IF SUBSTR (P$ -> BLOCK.DNT$ -> DNT.TEXT.NAME, 0, 2) = '.D'
     1546    22916 C                     AND K < %(#256K - 1) THEN
     1547    22917 C                   P$ -> BLOCK.SIZE = P$ -> BLOCK.SIZE + 1;
     1548    22918 C
     1549    22919 C                 DO J = 0 TO K BY %#16K;
     1550    22920 C                   SUPP_DATA.WRD = J * %#256K;
     1551    22921 C                   CALL Z8HI$BURST(P$,DEP.BDEP);
     1552    22922 C                 END;
     1553    22923 C
     1554    22924 C                 P$ -> BLOCK.SA = I;
     1555    22925 C
     1556    22926 C                 P$ = P$ -> BLOCK.NEXT;
     1557    22927 C               END;
     1558    22928 C
     1559    22929 C       /*  Remove redundant block items from the block chain */
     1560    22930 C
     1561    22931 C               CURRENT_BLOCK$ = COMCOM.BLOCK$;
     1562    22932 C               P$ = CURRENT_BLOCK$ -> BLOCK.NEXT; /* first block item is good */
     1563    22933 C
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:58   
     1564    22934 C               DO WHILE (P$ ~= ADDR(NIL));
     1565    22935 C                 IF P$ -> BLOCK.B.SCOUNT ~= %PROC THEN
     1566    22936 C                   CURRENT_BLOCK$ -> BLOCK.NEXT = P$ -> BLOCK.NEXT;
     1567    22937 C                 ELSE
     1568    22938 C                   CURRENT_BLOCK$ = P$;
     1569    22939 C
     1570    22940 C                 P$ = P$ -> BLOCK.NEXT;
     1571    22941 C               END;
     1572    22942 C
     1573    22943 C               CURRENT_BLOCK$ = COMCOM.SEGMENT$(%PROC);
     1574    22944 C               IF COMCOM.SEGMENTC > 1 THEN
     1575    22945 C                 %NEW_ORG(@ST$ = CURRENT_BLOCK$);
     1576    22946 C
     1577    22947 C               P$ = COMCOM.SYMREF$;
     1578    22948 C
     1579    22949 C               DO WHILE (P$ ~= ADDR(NIL));
     1580    22950 C
     1581    22951 C                 IF COMCOM.SEGMENTC > 1 AND
     1582    22952 C                   CURRENT_BLOCK$ ~= COMCOM.SEGMENT$(P$ -> SYMREF_.B.SCOUNT) THEN
     1583    22953 C                   DO;
     1584    22954 C                     CURRENT_BLOCK$ = COMCOM.SEGMENT$(P$ -> SYMREF_.B.SCOUNT);
     1585    22955 C
     1586    22956 C                     %NEW_ORG (@ST$ = CURRENT_BLOCK$);
     1587    22957 C                   END;
     1588    22958 C
     1589    22959 C                 I = COMCOM.BLOCK$ -> SEGMENT.SIZE;
     1590    22960 C
     1591    22961 C                 CALL Z8HI$BURST(P$,DEP.BDEP);
     1592    22962 C
     1593    22963 C                 P$ -> SYMREF_.SA = I;
     1594    22964 C
     1595    22965 C                 P$ = P$ -> SYMREF_.NEXT;
     1596    22966 C               END;
     1597    22967 C
     1598    22968 C               I = COMCOM.SEGMENT$(%PROC) -> SEGMENT.SIZE;
     1599    22969 C               P$ = COMCOM.SEGMENT$(%PROC);
     1600    22970 C               CURRENT_BLOCK$ = P$;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:59   
     1601    22971 C
     1602    22972 C               %NEW_ORG (@ST$ = P$);
     1603    22973 C
     1604    22974 C               DO J = 0 TO P$ -> SEGMENT.SIZE BY %#16K;
     1605    22975 C                 SUPP_DATA.WRD = J * %#256K;
     1606    22976 C                 CALL Z8HI$BURST(P$,DEP.BDEP);
     1607    22977 C               END;
     1608    22978 C
     1609    22979 C               P$ -> SEGMENT.SA = I;
     1610    22980 C
     1611    22981 C               IF COMCOM.SEGMENTC > 1 THEN
     1612    22982 C                 DO;
     1613    22983 C                   DO K = 1 TO COMCOM.SEGMENTC - 1;
     1614    22984 C                     CURRENT_BLOCK$ = COMCOM.SEGMENT$(K);
     1615    22985 C                     I = CURRENT_BLOCK$ -> SEGMENT.SIZE;
     1616    22986 C
     1617    22987 C                     %NEW_ORG (@ST$ = CURRENT_BLOCK$);
     1618    22988 C
     1619    22989 C                     DO J = 0 TO CURRENT_BLOCK$ -> SEGMENT.SIZE BY %#16K;
     1620    22990 C                       SUPP_DATA.WRD = J * %#256K;
     1621    22991 C                       CALL Z8HI$BURST(CURRENT_BLOCK$,DEP.BDEP);
     1622    22992 C                     END;
     1623    22993 C
     1624    22994 C                     CURRENT_BLOCK$ -> SEGMENT.SA = I;
     1625    22995 C                   END; /* DO K = 1 ... */
     1626    22996 C                 END; /* IF DO ... */
     1627    22997 C
     1628    22998 C               GENERATING_PTRS = FALSE;
     1629    22999               %ENDIF;
     1630    23000
     1631    23001
     1632    23002            /*V*
     1633    23003                          CLEAN_UP
     1634    23004
     1635    23005                   This section does storage allocation checking and
     1636    23006                 some global count zeroing.  If all allocated generator
     1637    23007                 items are not pooled, we have a bug.  A fatal error
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:60   
     1638    23008                 message is issued to force the user to inform maintenance.
     1639    23009
     1640    23010            */
     1641    23011
     1642    23012    3            CALL Z8HU$POOL_PRIME( COMCOM.ESC );
     1643    23013    3            CALL Z8HU$POOL( COMCOM.ESC );
     1644    23014
     1645    23015    3            I = 0;
     1646    23016
     1647    23017    4            DO WHILE((I <= 3) AND (COMCOM.ESC_LIST.ESC$(I) ~= ADDR(NIL)));
     1648    23018    4              COMCOM.ESC_LIST.ESC$(I) -> ETT.COUNT = 0;
     1649    23019
     1650    23020    4              REGISTER = COMCOM.ESC_LIST.PR#(I);
     1651    23021    4              PRIME$ = RAT.PRIMES (REGISTER);
     1652    23022
     1653    23023    5              DO WHILE PRIME$ ~= ADDR(NIL);
     1654    23024    5                NEXT$ = PRIME$ -> PRIME.NEXT;
     1655    23025    5                CALL Z8HU$POOL_PRIME (PRIME$ -> PRIME.TRIAD);
     1656    23026    5                CALL Z8HU$POOL (PRIME$ -> PRIME.TRIAD);
     1657    23027    5                PRIME$ = NEXT$;
     1658    23028    5              END; /* Do While more PRIMEs */
     1659    23029
     1660    23030    4              I = I + 1;
     1661    23031    4            END;
     1662    23032
     1663    23033    3            CALL Z8HG$FREE_ALL_REGISTERS;
     1664    23034
     1665    23035
     1666    23036    3            IF NUMBER_OF_PRIMES ~= 0 THEN
     1667    23037    3              CALL Z8AE$ERROR(%E$UNPOOLED_PRIMES,COMCOM.CURRENT.LINE,0);
     1668    23038
     1669    23039    3            IF NUMBER_OF_REFS ~= 0 THEN
     1670    23040    3              CALL Z8AE$ERROR(%E$UNPOOLED_REFS,COMCOM.CURRENT.LINE,0);
     1671    23041
     1672    23042    3            IF NUMBER_OF_TEMPS ~= 0 THEN
     1673    23043    3              CALL Z8AE$ERROR(%E$UNPOOLED_TEMPS,COMCOM.CURRENT.LINE,0);
     1674    23044    3        END /* Case */;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:61   
     1675    23045
     1676    23046        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:62   
     1677    23047    2   CASE(%ENTRY);
     1678    23048
     1679    23049        /*V*
     1680    23050
     1681    23051                           ENTRY
     1682    23052
     1683    23053                This case is entered more than once per ENTRY
     1684    23054             (more than one CASE pseudo-code operation encountered in the
     1685    23055             ENTRY ILL item pseudo-code entry).  All types of entry will
     1686    23056             not use all possible passes (unmanaged routines will only go
     1687    23057             through the first pass).
     1688    23058
     1689    23059               First pass: Get type of entry (Main, subroutine or subroutine-
     1690    23060                     entry).  If subroutine or subroutine entry then set
     1691    23061                     up for call to entry operator and possibly call to
     1692    23062                     call manager in library.
     1693    23063
     1694    23064               Second pass: Put options in SUPP_DATA.
     1695    23065
     1696    23066               Third pass: Set up global registers.
     1697    23067
     1698    23068        */
     1699    23069    3        DO CASE(CASE_PASS);
     1700    23070    3          CASE(%FIRST_PASS);
     1701    23071
     1702    23072    3            PCOM.XOPND = COMCOM.ESC;
     1703    23073    3            PCOM.ZOPND = COMCOM.ESC -> ETT.LOP;
     1704    23074    3            COMCOM.ESC -> ETT.STATE = %PR5;
     1705    23075    3            COMCOM.ESC -> ETT.COUNT = %DONT_MESS;
     1706    23076    3            COMCOM.ESC -> ETT.B.ESC_LIST = %TRUE;
     1707    23077
     1708    23078    4            DO CASE( PILL -> ENTRY_ILL.CODE );
     1709    23079    4              CASE( %MAIN_PROGRAM );
     1710    23080    4                PCOM.EABS = %MAIN_ENTRY;
     1711    23081
     1712    23082    4              CASE( %SUBROUTINE, %SUBROUTINE_ENTRY );
     1713    23083    4                DEF$ = PILL -> ENTRY_ILL.LOP;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:63   
     1714    23084
     1715    23085    4                IF PILL -> ILL.CODE = %SUBROUTINE_ENTRY THEN
     1716    23086    5                  DO;
     1717    23087    5                    DEF$ -> LABEL.DESC.SA = CURRENT_BLOCK$ -> BLOCK.SIZE;
     1718    23088    5                    AVOID_DEFLAB = 1;
     1719    23089    5                  END;
     1720    23090    4                ELSE
     1721    23091    4                  AVOID_DEFLAB = 0;
     1722    23092
     1723    23093    4                IF DEF$ -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.
             23093                         EXIT_PROG_IN_DECL THEN
     1724    23094    5                  DO;
     1725    23095    5                    PCOM.DABS = 1;
     1726    23096    5                    PCOM.POPND = PILL -> ENTRY_ILL.EXIT_PROG$;
     1727    23097    5                  END;
     1728    23098    4                ELSE
     1729    23099    4                  PCOM.DABS = 0;
     1730    23100
     1731    23101    4                IF COMCOM.OB.COBOL_74    THEN
     1732    23102    4                   PCOM.OABS = 1;
     1733    23103    4                ELSE
     1734    23104    4                   PCOM.OABS = 0;
     1735    23105
     1736    23106    4                IF COMCOM.OB.PARAMETER_CHECK  THEN
     1737    23107    4                  PCOM.CABS = 1;
     1738    23108    4                ELSE
     1739    23109    4                  PCOM.CABS = 0;
     1740    23110
     1741    23111    4                IF DEF$ -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.P2_SAVE$ =
             23111                         ADDR(NIL)   THEN
     1742    23112    4                  PCOM.SABS = 0;
     1743    23113    4                ELSE
     1744    23114    5                  DO;
     1745    23115    5                    PCOM.SABS = 1;
     1746    23116    5                    PCOM.UOPND = DEF$ -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP
             23116                             .P2_SAVE$;
     1747    23117    5                  END;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:64   
     1748    23118
     1749    23119    4                IF DEF$ -> SYMDEF_.ARGLIST$ ~= ADDR(NIL) THEN
     1750    23120    4                  PCOM.NABS = DEF$ -> SYMDEF_.ARGLIST$ -> ARGLIST.N - 1;
     1751    23121    4                ELSE
     1752    23122    4                  PCOM.NABS = 0;
     1753    23123
     1754    23124    4                PCOM.SOPND = DEF$ -> SYMDEF_.PROC$ -> PROC_.PSEUDO_STACK$;
     1755    23125
     1756    23126    5                DO CASE(PCOM.NABS);
     1757    23127    5                  CASE(%ZERO_ARG);
     1758    23128    5                    PCOM.EOPND = COMCOM.X66_STATIC_0$;
     1759    23129    5                  CASE(%ONE_ARG);
     1760    23130    5                    PCOM.EOPND = COMCOM.X66_STATIC_1$;
     1761    23131    5                  CASE(%TWO_ARG);
     1762    23132    5                    PCOM.EOPND = COMCOM.X66_STATIC_2$;
     1763    23133    5                  CASE(%THREE_ARG);
     1764    23134    5                    PCOM.EOPND = COMCOM.X66_STATIC_3$;
     1765    23135    5                  CASE(ELSE);
     1766    23136    5                    PCOM.EOPND = COMCOM.X66_STATIC_N$;
     1767    23137    5                END; /* CASE (NABS) */
     1768    23138
     1769    23139            /*       IF (DEF$ -> ST.ID = %INTDEF) AND
     1770    23140                        NOT COMCOM.CANCEL_ID                       AND
     1771    23141                        NOT DEF$ -> INTDEF.PROC$ -> PROC_.B.CANCELED AND
     1772    23142                        NOT DEF$ -> INTDEF.PROC$ -> PROC_.B.INITIAL AND
     1773    23143                        NOT COMCOM.COMMA_DECIMAL_PRESENT     THEN
     1774    23144                       PCOM.EABS = %SUBENT_UNMANAGED + AVOID_DEFLAB;
     1775    23145                     ELSE
     1776    23146                       DO;   */
     1777    23147    4                    PCOM.EABS = %SUBENT_MANAGED + AVOID_DEFLAB;
     1778    23148    4                    PCOM.KOPND = DEF$ -> SYMDEF_.PROC$ -> PROC_.CSIB$;
     1779    23149    4                    DEF$ -> SYMDEF_.PROC$ -> PROC_.B.MANAGED = TRUE;
     1780    23150            /*         END;  */
     1781    23151
     1782    23152    4              CASE(ELSE);
     1783    23153    4                CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);
     1784    23154    4            END; /* CASE (CODE) */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:65   
     1785    23155
     1786    23156
     1787    23157    3          CASE(%SECOND_PASS);
     1788    23158    3            IF PILL -> ENTRY_ILL.CODE = %MAIN_PROGRAM THEN
     1789    23159    4              DO;
     1790    23160    4                OPTWRD = 0;
     1791    23161    4                ADDR(OPTWRD) -> NOP.EXIT_PROG_IN_DECL = PILL -> ENTRY_ILL.LOP
     1792    23162    4                    -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.EXIT_PROG_IN_DECL
             23162                             ;
     1793    23163    4                ADDR(OPTWRD) -> NOP.COBOL_74 = COMCOM.OB.COBOL_74;
     1794    23164    4                ADDR(OPTWRD) -> NOP.CONTINUE = COMCOM.OB.CONTINUE;
     1795    23165    4                ADDR(OPTWRD) -> NOP.STATS   = COMCOM.OB.STATS;
     1796    23166    4                ADDR(OPTWRD) -> NOP.COMMA_DECIMAL =
     1797    23167    4                  ENTRY_ILL.LOP -> SYMDEF_.PROC$ -> PROC_.B.OBJECT_IS_COMMA;
     1798    23168
     1799    23169    4                PCOM.GABS = OPTWRD;
     1800    23170    4              END;
     1801    23171
     1802    23172    3          CASE(%THIRD_PASS);
     1803    23173    4            DO CASE( PILL -> ENTRY_ILL.CODE );
     1804    23174    4              CASE( %SUBROUTINE, %MAIN_PROGRAM );
     1805    23175    4                CALL LOAD_GLOBAL_REGISTERS;
     1806    23176
     1807    23177    4              CASE( %SUBROUTINE_ENTRY );
     1808    23178    4                CALL RESTORE_GLOBAL_REGISTERS;
     1809    23179    4            END; /* CASE (CODE) */
     1810    23180
     1811    23181    3        END /* Case */;
     1812    23182        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:66   
     1813    23183    2   CASE(%ESC);
     1814    23184        /*V*
     1815    23185                ESC
     1816    23186
     1817    23187                   An escape triad normally just generates a pointer load.
     1818    23188                The loaded pointer will point to the beginning of a block.
     1819    23189                However, when the Lop of the escape points to .PROC.
     1820    23190                the ROP will point to a label item in .PROC.. The pointer
     1821    23191                register is set to point at this label in this special case.
     1822    23192                An example of when this is used is in the GO TO DEPENDING
     1823    23193                verb.
     1824    23194        */
     1825    23195
     1826    23196    3      DO CASE( CASE_PASS );
     1827    23197
     1828    23198    3        CASE( %FIRST_PASS );
     1829    23199
     1830    23200               %IF %USING_HALF_WORD_RELOCATION;
     1831    23201    3            PCOM.JABS = %HALF_WORD_REL;
     1832    23202               %ELSEIF;
     1833    23203 C
     1834    23204 C             IF PILL -> ETT.LOP -> ETT.ID = %BASE THEN
     1835    23205 C               DO;
     1836    23206 C                 CALL Z8HI$BURST(PILL -> ETT.LOP,
     1837    23207 C                                 PEPD(PILL -> ETT.LOP -> ETT.ID));
     1838    23208 C
     1839    23209 C                   /* This is an item based on the pointer */
     1840    23210 C
     1841    23211 C                 PCOM.JABS = %BASEP;
     1842    23212 C               END;
     1843    23213 C             ELSE
     1844    23214 C
     1845    23215 C               IF PILL -> ETT.B.ESC_LIST       THEN
     1846    23216 C                 DO;
     1847    23217 C                   PCOM.JABS = %ON_ESC_LIST;
     1848    23218 C                   PCOM.CABS = PILL -> ETT.B.PR#;
     1849    23219 C                   PCOM.BABS = PILL -> ETT.B.OPTION;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:67   
     1850    23220 C                 END;
     1851    23221 C               ELSE
     1852    23222 C
     1853    23223 C                 IF PILL -> ETT.LOP -> ST.ID = %SYMREF_   THEN
     1854    23224 C                   PCOM.JABS = %LIB_CALL;
     1855    23225 C                 ELSE
     1856    23226 C
     1857    23227 C                   IF PILL -> ETT.LOP -> ST.R = %PROGRAM     THEN
     1858    23228 C                     PCOM.JABS = %LDP;
     1859    23229 C                   ELSE
     1860    23230 C                     PCOM.JABS = %NOT_ON_ESC_LIST;
     1861    23231 C
     1862    23232               %ENDIF;
     1863    23233    3        CASE( %SECOND_PASS );
     1864    23234
     1865    23235                 /* Generate an EAX0 */
     1866    23236    3            CALL Z8HG$FREE_REGISTER(%XR0);
     1867    23237
     1868    23238    3            INST_WORD = '0'O;
     1869    23239    3            INST_WORD.LOW.OP_CODE = %EAX0_OP + (%XR0 - 8);
     1870    23240
     1871    23241    3            MOD_KEY.KEY = 0;
     1872    23242    3            MOD_KEY.B.RESOLVE_ADDRESS = TRUE;
     1873    23243
     1874    23244                 %NEW_WORD(@OU_WORD = INST_WORD,
     1875    23245                           @ST$ = PILL -> ETT.ROP,
     1876    23246                           @KEY = MOD_KEY.KEY);
     1877    23293
     1878    23294
     1879    23295                 /* Generate AWDX using X0 */
     1880    23296    3            INST_WORD = '0'O;
     1881    23297    3            INST_WORD.LOW.OP_CODE = %AWD_OP;
     1882    23298    3            INST_WORD.LOW.MF.TAG = %XR0;
     1883    23299    3            INST_WORD.Y.AR# = PILL -> ETT.STATE - 20;
     1884    23300    3            INST_WORD.LOW.MF.AR = TRUE;
     1885    23301    3            INST_WORD.LOW.EIS = TRUE;
     1886    23302
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:68   
     1887    23303                 %NEW_WORD(@OU_WORD = INST_WORD);
     1888    23350
     1889    23351    3      END;  /*  CASE PASS */
     1890    23352        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:69   
     1891    23353    2   CASE(%EVAL);
     1892    23354
     1893    23355        /*V*
     1894    23356                           EVAL
     1895    23357
     1896    23358             EVAL is used to make a value constant over a range.  See
     1897    23359             phase one and three documentation for details.  In phase
     1898    23360             four the triad under the eval will be walked and its state will
     1899    23361             tranferred to the EVAL.  This will ensure its uniqueness
     1900    23362             over the range,  and hopefully won't cause problems in
     1901    23363             other circumstances.
     1902    23364        */
     1903    23365    2        EVAL$ = PILL -> ETT.LOP;
     1904    23366
     1905    23367    2        PILL -> ETT.STATE = EVAL$ -> ETT.STATE;
     1906    23368
     1907    23369    2        REGISTER = EVAL$ -> ETT.STATE;
     1908    23370    2        IF REGISTER > %REF_T THEN
     1909    23371    2          CALL Z8HG$USE_REGISTER(PILL, REGISTER);
     1910    23372
     1911    23373    2        IF EVAL$ -> ETT.REF$ ~= ADDR(NIL) THEN
     1912    23374    3          DO;
     1913    23375
     1914    23376                 %EQU ONE_FOR_REFERENCE_TO_LOP = 1;
     1915    23377
     1916    23378    3            IF EVAL$ -> ETT.REF$ -> REF.ST$ -> ST.ID = %TEMP THEN
     1917    23379    3              EVAL$ -> ETT.REF$ -> REF.ST$ -> TEMP.REFERENCES =
     1918    23380    3                EVAL$ -> ETT.REF$ -> REF.ST$ -> TEMP.REFERENCES +
     1919    23381    3                PILL -> ETT.COUNT - %ONE_FOR_REFERENCE_TO_LOP;
     1920    23382
     1921    23383                 %NEW_REF(@POINTER=P$);
     1922    23492
     1923    23493    3            P$ -> REF = EVAL$ -> ETT.REF$ -> REF;
     1924    23494    3            PILL -> ETT.REF$ = P$;
     1925    23495    3          END;
     1926    23496
     1927    23497    2        CALL Z8HU$DECCNT_WITHOUT_IMPL_REF(EVAL$, 1);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:70   
     1928    23498        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:71   
     1929    23499    2   CASE(%EVALP);
     1930    23500    2        CALL BINCHAR (TEMP_CHAR, COMCOM.CURRENT.LINE);
     1931    23501    2        I = 0;
     1932    23502    3        DO WHILE SUBSTR (TEMP_CHAR, I, 1) = '0';
     1933    23503    3          I = I + 1;
     1934    23504    3        END;
     1935    23505    2        CALL Z8AH$NEW_DNT (SUBSTR (TEMP_CHAR, I), 12 - I, P$);
     1936    23506    2        CALL Z8AE$ERROR (%E$EVALP_NOT_DELETED,,, P$);
     1937    23507
     1938    23508        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:72   
     1939    23509    2   CASE(%EXDD);
     1940    23510    2        PCOM.IABS = 0;
     1941    23511
     1942    23512    2   CASE(%EXDI);
     1943    23513    2        PCOM.IABS = 1;
     1944    23514
     1945    23515        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:73   
     1946    23516    2   CASE(%EXIT_PROG);
     1947    23517
     1948    23518             %IF CP6;
     1949    23519    2        PCOM.EABS = 1;
     1950    23520    2        PCOM.SOPND = PILL -> ILL.LOP -> PROC_.PSEUDO_STACK$;
     1951    23521             %ENDIF;
     1952    23522             %IF GCOS;
     1953    23523 C           IF COMCOM.OB.FAST_ENT THEN
     1954    23524 C             PCOM.AABS = 0;
     1955    23525 C           ELSE
     1956    23526 C             PCOM.AABS = 1;
     1957    23527 C           PCOM.AABS = 1;
     1958    23528 C           IF COMCOM.OB.TP8 THEN
     1959    23529 C             IF PILL -> ILL.CODE = %EXIT_PROG_TP8 THEN
     1960    23530 C               PCOM.EABS = 1;
     1961    23531 C             ELSE
     1962    23532 C               PCOM.EABS = 0;
     1963    23533 C           ELSE
     1964    23534 C             PCOM.EABS = 2;
     1965    23535             %ENDIF;
     1966    23536    2        PCOM.KOPND = PILL -> ILL.LOP -> PROC_.CSIB$;
     1967    23537
     1968    23538        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:74   
     1969    23539    2   CASE(%GO, %MULTI_GO);
     1970    23540
     1971    23541    3        DO CASE(CASE_PASS);
     1972    23542    3           CASE(%FIRST_PASS);
     1973    23543    3               PCOM.XABS = PILL -> ILL.CODE;
     1974    23544
     1975    23545    3               IF PILL -> ILL.ID = %GO THEN
     1976    23546    3                 GO_EXPR$ = PILL  -> GO.EXPR$;
     1977    23547    3               ELSE
     1978    23548    3                 GO_EXPR$ = PILL -> MULTI_GO.EXPR$;
     1979    23549    3               IF GO_EXPR$ ~= ADDR(NIL) THEN
     1980    23550    3                 IF GO_EXPR$ -> ETT.B.REVERSED_RELATE THEN
     1981    23551                        %SWAP_RELATIONAL(OP_CODE=PCOM.XABS);
     1982    23577
     1983    23578    4               DO CASE(PCOM.XABS);
     1984    23579    4                 CASE(%GO_LESS_THAN);
     1985    23580    5                   DO CASE(GO_EXPR$ -> ETT.ID);
     1986    23581    5                     CASE(
     1987    23582                               %SET_OF_ALPHANUM_COMPARISONS;
     1988    23585    5                                                       );
     1989    23586    5                       PCOM.XABS = %GO_LESS_THAN_ALPHA;
     1990    23587
     1991    23588    5                     CASE(ELSE);
     1992    23589    5                       PCOM.XABS = %GO_LESS_THAN_ARITH;
     1993    23590    5                   END /* Case */;
     1994    23591
     1995    23592    4                 CASE(%GO_GREATER_THAN);
     1996    23593    5                   DO CASE(GO_EXPR$ -> ETT.ID);
     1997    23594    5                     CASE(
     1998    23595                               %SET_OF_ALPHANUM_COMPARISONS;
     1999    23598    5                                                       );
     2000    23599    5                       PCOM.XABS = %GO_GREATER_THAN_ALPHA;
     2001    23600
     2002    23601    5                     CASE(ELSE);
     2003    23602    5                       PCOM.XABS = %GO_GREATER_THAN_ARITH;
     2004    23603    5                   END /* Case */;
     2005    23604
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:75   
     2006    23605    4                 CASE(%GO_LESS_THAN_OR_EQUAL);
     2007    23606    5                   DO CASE(GO_EXPR$ -> ETT.ID);
     2008    23607    5                     CASE(
     2009    23608                               %SET_OF_ALPHANUM_COMPARISONS;
     2010    23611    5                                                       );
     2011    23612    5                       PCOM.XABS = %GO_LESS_THAN_OR_EQUAL_ALPHA;
     2012    23613
     2013    23614    5                     CASE(ELSE);
     2014    23615    5                       PCOM.XABS = %GO_LESS_THAN_OR_EQUAL_ARITH;
     2015    23616    5                   END /* Case */;
     2016    23617
     2017    23618    4                 CASE(%GO_GREATER_THAN_OR_EQUAL);
     2018    23619    5                   DO CASE(GO_EXPR$ -> ETT.ID);
     2019    23620    5                     CASE(
     2020    23621                               %SET_OF_ALPHANUM_COMPARISONS;
     2021    23624    5                                                       );
     2022    23625    5                       PCOM.XABS = %GO_GREATER_THAN_OR_EQUAL_ALPHA;
     2023    23626
     2024    23627    5                     CASE(ELSE);
     2025    23628    5                       PCOM.XABS = %GO_GREATER_THAN_OR_EQUAL_ARITH;
     2026    23629    5                   END /* Case */;
     2027    23630    4               END /* Case */;
     2028    23631
     2029    23632    3           CASE(%SECOND_PASS);
     2030    23633    4              DO CASE(PILL -> ILL.CODE); /* Subroutine call, Z8HP to Z9HP */
     2031    23634    4                  CASE(%GO_SWITCH_ON);
     2032    23635    4                       CALL Z8HI$BURST(PILL,DEP.TDEP);
     2033    23636
     2034    23637    4                  CASE(%GO_SWITCH_OFF);
     2035    23638    4                       CALL Z8HI$BURST(PILL,DEP.UDEP);
     2036    23639
     2037    23640    4                  CASE(ELSE);
     2038    23641    4                      CALL Z8AE$ERROR(%E$UNEXPECTED_CASE,
     2039    23642    4                              COMCOM.CURRENT.LINE,0);
     2040    23643    4              END; /* CASE */
     2041    23644
     2042    23645    3        END; /* CASE */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:76   
     2043    23646
     2044    23647        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:77   
     2045    23648    2   CASE(%INCRV);
     2046    23649
     2047    23650    2        PILL -> ETT.ROP -> ETT.COUNT = 0;
     2048    23651
     2049    23652        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:78   
     2050    23653    2   CASE(%INDEX);
     2051    23654
     2052    23655    2        CALL Z8AU$LENGTH_ETT(PILL -> ETT.LOP, PCOM.LOPND);
     2053    23656
     2054    23657    2        IF PCOM.LOPND -> ETT.ID = %TRIAD
     2055    23658    2           AND (PCOM.LOPND -> ETT.LOP -> CONST.CONSTI.WORD1 < 3) THEN
     2056    23659    3          DO CASE(PCOM.LOPND -> ETT.LOP -> CONST.CONSTI.WORD1);
     2057    23660    3            CASE(1);
     2058    23661    3              PCOM.JABS = 0;
     2059    23662
     2060    23663    3            CASE(2);
     2061    23664    3              PCOM.JABS = 1;
     2062    23665
     2063    23666    3            CASE(ELSE);
     2064    23667    3              CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);
     2065    23668
     2066    23669    3          END /* Case */;
     2067    23670    2        ELSE
     2068    23671    3          DO;
     2069    23672    3            PCOM.JABS = 2;
     2070    23673
     2071    23674    3            CALL Z8AU$LENGTH_ETT(PILL -> ETT.ROP, PCOM.ROPND);
     2072    23675
     2073    23676                         /* Initialize count field of LOPND and ROPND
     2074    23677                            because we can't be sure that Z8AU gives
     2075    23678                            us a 'clean' triad.
     2076    23679                         */
     2077    23680    3            IF PCOM.LOPND -> ETT.ID = %TRIAD THEN
     2078    23681    3              PCOM.LOPND -> ETT.COUNT = 0;
     2079    23682    3            IF PCOM.ROPND -> ETT.ID = %TRIAD THEN
     2080    23683    3              PCOM.ROPND -> ETT.COUNT = 0;
     2081    23684
     2082    23685    3            CALL Z8HU$INCCNT(PCOM.ROPND, 1);
     2083    23686    3            CALL Z8HU$INCCNT(PCOM.LOPND, 1);
     2084    23687
     2085    23688    3            CALL Z8AF$FORME(%SBI, PCOM.ROPND, PCOM.LOPND, P$);
     2086    23689    3            CALL Z8AF$FORME(%ADI, P$, COMCOM.VALUE_1, PCOM.IOPND);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:79   
     2087    23690    3          END;
     2088    23691
     2089    23692        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:80   
     2090    23693    2   CASE(%INITV);
     2091    23694
     2092    23695    2        PILL -> ETT.ROP -> ETT.COUNT = %DONT_MESS;
     2093    23696    2        PILL -> ETT.ROP -> ETT.REF$ = ADDR(NIL);
     2094    23697
     2095    23698        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:81   
     2096    23699    2   CASE(%LINOI);
     2097    23700        /*V*
     2098    23701
     2099    23702                                         LINOI
     2100    23703
     2101    23704             Passes line info on to the Annotator.  If this LINOI is the same
     2102    23705             as the one previous, we do *not* generate another LINE item.
     2103    23706
     2104    23707        */
     2105    23708
     2106    23709    2        IF PILL -> LINOI.TYPE ~= %NO_STATEMENT_TYPE THEN
     2107    23710    3          DO;
     2108    23711                 %NEW_LINE ( @OFFSET = "COMCOM.SEGMENT$(%PROC) -> SEGMENT.SIZE" ,
     2109    23712                             @TYPE   = PILL -> LINOI.TYPE ,
     2110    23713                             @COLUMN = PILL -> LINOI.COLUMN_NO ,
     2111    23714                             @NUMBER = PILL -> LINOI.LINE_NO );
     2112    23768
     2113    23769    3            IF PILL -> LINOI.LINE_NO ~= 0 THEN
     2114    23770    4              DO;
     2115    23771    4                COMCOM.CURRENT.LINE = PILL -> LINOI.LINE_NO;
     2116    23772    4                COMCOM.CURRENT.COLUMN = PILL -> LINOI.COLUMN_NO;
     2117    23773    4              END;
     2118    23774    3          END;
     2119    23775
     2120    23776        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:82   
     2121    23777    2   CASE(%MFILL);
     2122    23778
     2123    23779    2        CALL Z8AU$TYPE_DESCRIPTOR (PILL -> ILL.LOP, TYPE_DESC);
     2124    23780             %FISH (TRIAD=PILL -> ILL.LOP, RTN=P$);
     2125    23788
     2126    23789    2        IF (NOT P$ -> VARIABLE.B.ELEMENTARY
     2127    23790    2             OR P$ -> VARIABLE.TYPE ~= %TYD
     2128    23791    2             OR P$ -> VARIABLE.NDSC.TN = %NDSC9
     2129    23792    2             OR P$ -> VARIABLE.B.REDEF_SUB
     2130    23793    2             OR P$ -> VARIABLE.B.REDEF_OBJ
     2131    23794    2             OR P$ -> VARIABLE.QLT$ -> QLT.B.RENAMES)
     2132    23795    2         AND (PILL -> ILL.LOP -> ETT.STATE = %UNEVAL_T OR
     2133    23796    2              PILL -> ILL.LOP -> ETT.STATE = %REF_T) THEN
     2134    23797    3          DO;
     2135    23798    3            J = TYPE_DESC.DESC.SA * 8 + TYPE_DESC.DESC.NDSC.CN;
     2136    23799    3            IF P$ -> VARIABLE.B.CLASS = %CLASS_NUMERIC THEN
     2137    23800    4              DO;
     2138    23801    4                LOP_LEN = P$ -> VARIABLE.NDSC.N;
     2139    23802    4                IF P$ -> VARIABLE.NDSC.TN = %NDSC9 THEN
     2140    23803    4                  LOP_LEN = LOP_LEN * 2; /* Convert to digits */
     2141    23804    4              END;
     2142    23805    3            ELSE
     2143    23806    4              DO;
     2144    23807                     %GET_ADSC_LEN (ST$ = P$, RTN = LOP_LEN);
     2145    23818    4                IF P$ -> VARIABLE.TYPE = %TYB THEN
     2146    23819    4                  LOP_LEN = LOP_LEN * 4 / 3; /* Convert to digits */
     2147    23820    4                ELSE
     2148    23821    4                  LOP_LEN = LOP_LEN * 2;
     2149    23822    4              END;
     2150    23823    3            IF P$ -> VARIABLE.B.LINKAGE THEN
     2151    23824    4              DO;
     2152    23825    4                QLT$ = P$ -> VARIABLE.QLT$;
     2153    23826    5                DO WHILE QLT$ -> QLT.LEVEL_NO > 1;
     2154    23827    5                  QLT$ = QLT$ -> QLT.FATHER;
     2155    23828    5                END;
     2156    23829                     %GET_LTS (@ID = %BASE_LTS, @ST$ = QLT$ -> QLT.ST$, @RETURN$ = LTS$$);
     2157    23872    4              END;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:83   
     2158    23873    4            DO I = %ARA TO %AREAQ; /* Free A, Q, X0 - 7 */
     2159    23874    4              CALL FREE_REG_IF_NEED (P$, LOP_LEN, J, LTS$$, I);
     2160    23875    4            END;
     2161    23876    3          END;
     2162    23877
     2163    23878    2   CASE(%MPI);
     2164    23879        /*V*
     2165    23880                                              MPI
     2166    23881            Sets the greater_256K bit to prevent the result from being moved to an
     2167    23882            index register, unless the result cannot possibly be too large to fit
     2168    23883            in one.
     2169    23884        */
     2170    23885    2        IF PILL -> ETT.ROP -> ETT.ID = %TRIAD AND
     2171    23886    2            PILL -> ETT.LOP -> ETT.ID = %CVDI AND
     2172    23887    3            PILL -> ETT.LOP -> ETT.LOP -> ETT.ID = %CVDSF THEN DO;
     2173    23888    3          I = PILL -> ETT.ROP -> ETT.LOP -> CONST.CONSTI.WORD1;
     2174    23889    4          DO J = PILL -> ETT.LOP -> ETT.LOP -> ETT.DESC.NDSC.N DOWNTO 1;
     2175    23890    4            I = I * 10;
     2176    23891    4          END;
     2177    23892    3          IF PILL -> ETT.LOP -> ETT.LOP -> ETT.DESC.NDSC.S = %NO_SIGN AND
     2178    23893    3              I > 262144 OR
     2179    23894    3             I > 2621440 THEN; /* OK */
     2180    23895    3          ELSE RETURN; /* Result can fit in index reg */
     2181    23896    3        END;
     2182    23897    2        RAT.B.GREATER_256K (PILL -> ETT.STATE) = TRUE;
     2183    23898        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:84   
     2184    23899    2   CASE(%MPI2,%SHIFT_L);
     2185    23900
     2186    23901    2        IF PILL -> ETT.LOP -> ETT.ID = %CVDI AND
     2187    23902    3            PILL -> ETT.LOP -> ETT.LOP -> ETT.ID = %CVDSF THEN DO;
     2188    23903    3          I = PILL -> ETT.ROPCON + PILL -> ETT.LOP -> ETT.LOP -> ETT.DESC.NDSC.N;
     2189    23904    3          IF PILL -> ETT.LOP -> ETT.LOP -> ETT.DESC.NDSC.S = %NO_SIGN AND
     2190    23905    3              I > 5 OR
     2191    23906    3             I > 6 THEN; /* OK */
     2192    23907    3          ELSE RETURN; /* Result can fit in an index reg */
     2193    23908    3        END;
     2194    23909    2        RAT.B.GREATER_256K (PILL -> ETT.STATE) = TRUE;
     2195    23910        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:85   
     2196    23911    2   CASE(%MVAN);
     2197    23912
     2198    23913    2        CALL FREE_REGISTER_CHECK (PILL);
     2199    23914    2        IF PILL -> ILL.ROP -> ETT.REF$ = ADDR (NIL) AND
     2200    23915    2            PILL -> ILL.ROP -> ETT.STATE > %REF_T THEN
     2201    23916    2          CALL Z8HG$SAVE (PILL -> ILL.ROP);
     2202    23917        %IF GCOS;
     2203    23918 C
     2204    23919 C           IF PILL -> ILL.ROP -> ST.ID = %SYMREF_ THEN
     2205    23920 C             PCOM.DABS = 1;
     2206    23921 C           ELSE
     2207    23922 C             PCOM.DABS = 0;
     2208    23923 C
     2209    23924 C      %EJECT;
     2210    23925        %ENDIF;
     2211    23926    2   CASE(%MVANO);
     2212    23927
     2213    23928        %EQU #2BYTES_UTOU       = 00;
     2214    23929        %EQU #2BYTES_UTOL       = 01;
     2215    23930        %EQU #2BYTES_LTOU       = 02;
     2216    23931        %EQU #2BYTES_LTOL       = 03;
     2217    23932        %EQU #4BYTES            = 04;
     2218    23933        %EQU #8BYTES_ETOE       = 05;
     2219    23934        %EQU #8BYTES_ETOO       = 06;
     2220    23935        %EQU #8BYTES_OTOE       = 07;
     2221    23936        %EQU #8BYTES_OTOO       = 08;
     2222    23937        %EQU #1BYTE_BYTE0       = 09;
     2223    23938        %EQU #1BYTE_BYTE1       = 10;
     2224    23939        %EQU #1BYTE_BYTE2       = 11;
     2225    23940        %EQU #1BYTE_BYTE3       = 12;
     2226    23941        %EQU #2BYTES_BYTES1AND2 = 13;
     2227    23942        %EQU #3BYTES_BYTES0TO2  = 14;
     2228    23943        %EQU #3BYTES_BYTES1TO3  = 15;
     2229    23944        %EQU #2BYTES_BYTES0AND1 = 16;
     2230    23945        %EQU #2BYTES_BYTES2AND3 = 17;
     2231    23946        %EQU LOP_EQ_ROP         = 36;
     2232    23947
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:86   
     2233    23948    2        IF PILL -> ILL.CODE < %MVANO_BYTE_0 OR PILL -> ILL.CODE > %MVANO_BYTE_3 THEN
     2234    23949    2          CALL FREE_REGISTER_CHECK (PILL);
     2235    23950
     2236    23951    3        DO CASE(PILL -> ILL.CODE);
     2237    23952    3          CASE(%#2BYTES_UTOU,%#2BYTES_UTOL,%#2BYTES_LTOU,%#2BYTES_LTOL);
     2238    23953    3            IF PILL -> ILL.ROP -> ETT.STATE >= %XR0
     2239    23954    3            AND PILL -> ILL.ROP -> ETT.STATE <= %XR7 THEN
     2240    23955    4              DO;
     2241    23956    4                IF PILL -> ETT.LOP -> ETT.STATE = PILL -> ETT.ROP -> ETT.STATE THEN
     2242    23957    4                  PCOM.CABS = %LOP_EQ_ROP;
     2243    23958    4                ELSE
     2244    23959    4                  PCOM.CABS = PILL -> ILL.CODE * 2 + 1;
     2245    23960    4              END;
     2246    23961    3            ELSE
     2247    23962    3              PCOM.CABS = PILL -> ILL.CODE * 2;
     2248    23963
     2249    23964
     2250    23965    3          CASE(%#4BYTES);
     2251    23966
     2252    23967    3            IF PILL -> ILL.ROP -> ETT.STATE = %ARA
     2253    23968    3            OR PILL -> ILL.ROP -> ETT.STATE = %ARQ THEN
     2254    23969    4              DO;
     2255    23970    4                IF PILL -> ETT.LOP -> ETT.STATE = PILL -> ETT.ROP -> ETT.STATE THEN
     2256    23971    4                  PCOM.CABS = %LOP_EQ_ROP;
     2257    23972    4                ELSE
     2258    23973    4                  PCOM.CABS = %#4BYTES * 2 + 1;
     2259    23974    4              END;
     2260    23975    3            ELSE
     2261    23976    3              PCOM.CABS = %#4BYTES * 2;
     2262    23977
     2263    23978    3          CASE(%#8BYTES_ETOE,%#8BYTES_ETOO,%#8BYTES_OTOE,%#8BYTES_OTOO);
     2264    23979
     2265    23980    3            IF PILL -> ILL.ROP -> ETT.STATE = %ARAQ THEN
     2266    23981    4              DO;
     2267    23982    4                IF PILL -> ETT.LOP -> ETT.STATE = PILL -> ETT.ROP -> ETT.STATE THEN
     2268    23983    4                  PCOM.CABS = %LOP_EQ_ROP;
     2269    23984    4                ELSE
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:87   
     2270    23985    4                  PCOM.CABS = PILL -> ILL.CODE * 2 + 1;
     2271    23986    4              END;
     2272    23987    3            ELSE
     2273    23988    3              PCOM.CABS = PILL -> ILL.CODE * 2;
     2274    23989
     2275    23990    3            PCOM.OABS = 1;
     2276    23991
     2277    23992    3          CASE(%#1BYTE_BYTE0,%#1BYTE_BYTE1,%#1BYTE_BYTE2,
     2278    23993    3               %#1BYTE_BYTE3,%#2BYTES_BYTES1AND2,%#3BYTES_BYTES0TO2,
     2279    23994    3               %#3BYTES_BYTES1TO3,%#2BYTES_BYTES0AND1,%#2BYTES_BYTES2AND3);
     2280    23995
     2281    23996    3            IF PILL -> ILL.ROP -> ETT.STATE = %ARA
     2282    23997    3            OR PILL -> ILL.ROP -> ETT.STATE = %ARQ THEN
     2283    23998    4              DO;
     2284    23999    4                IF PILL -> ETT.LOP -> ETT.STATE = PILL -> ETT.ROP -> ETT.STATE THEN
     2285    24000    4                  PCOM.CABS = %LOP_EQ_ROP;
     2286    24001    4                ELSE
     2287    24002    4                  PCOM.CABS = PILL -> ILL.CODE * 2 + 1;
     2288    24003    4              END;
     2289    24004    3            ELSE
     2290    24005    3              PCOM.CABS = PILL -> ILL.CODE * 2;
     2291    24006
     2292    24007    3            PCOM.TABS = TAGS(PILL -> ILL.CODE - 9);
     2293    24008
     2294    24009    3        END /* Case */;
     2295    24010        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:88   
     2296    24011    2   CASE(%MVDD,%MVDDR);
     2297    24012
     2298    24013    2        CALL FREE_REGISTER_CHECK (PILL);
     2299    24014
     2300    24015    2        IF PILL -> ETT.ROP -> ETT.REF$ -> REF.SIZ_TAG$ ~= ADDR (NIL)
     2301    24016    2            AND PILL -> ETT.ROP -> ETT.REF$ -> REF.SIZ_TAG$ -> ETT.ID ~= %TRIAD THEN
     2302    24017    3          DO;
     2303    24018    3            PCOM.LABS = 1;        /* Variable-length sending operand */
     2304    24019    3            PCOM.ROPND = PILL -> ETT.ROP -> ETT.REF$ -> REF.SIZ_TAG$;
     2305    24020    4            DO CASE (PCOM.ROPND -> ETT.STATE);
     2306    24021    4              CASE (%ARA);
     2307    24022    4                PCOM.XABS = 0;
     2308    24023    4              CASE (%ARQ);
     2309    24024    4                PCOM.XABS = 1;
     2310    24025    4              CASE (ELSE); /* X register */
     2311    24026    4                PCOM.XABS = 2;
     2312    24027    4            END; /* CASE */
     2313    24028    3          END;
     2314    24029    2        ELSE
     2315    24030    2          PCOM.LABS = 0; /* Fixed-length sending operand */
     2316    24031        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:89   
     2317    24032    2   CASE(%MVDO,%MVDOR);
     2318    24033
     2319    24034    2        CALL FREE_REGISTER_CHECK (PILL);
     2320    24035
     2321    24036    2        IF PILL -> ETT.ROP -> ETT.REF$ -> REF.SIZ_TAG$ ~= ADDR (NIL)
     2322    24037    2            AND PILL -> ETT.ROP -> ETT.REF$ -> REF.SIZ_TAG$ -> ETT.ID ~= %TRIAD THEN
     2323    24038    3          DO;
     2324    24039    3            PCOM.LABS = 1;        /* Variable-length sending operand */
     2325    24040    3            PCOM.ROPND = PILL -> ETT.ROP -> ETT.REF$ -> REF.SIZ_TAG$;
     2326    24041    4            DO CASE (PCOM.ROPND -> ETT.STATE);
     2327    24042    4              CASE (%ARA);
     2328    24043    4                PCOM.XABS = 0;
     2329    24044    4              CASE (%ARQ);
     2330    24045    4                PCOM.XABS = 1;
     2331    24046    4              CASE (ELSE); /* X register */
     2332    24047    4                PCOM.XABS = 2;
     2333    24048    4            END; /* CASE */
     2334    24049    3          END;
     2335    24050    2        ELSE
     2336    24051    2          PCOM.LABS = 0; /* Fixed-length sending operand */
     2337    24052
     2338    24053    3        DO CASE (PILL -> ETT.ID);
     2339    24054
     2340    24055    3           CASE(%MVDO);
     2341    24056    3               PCOM.ZABS = 0;
     2342    24057
     2343    24058    3           CASE(%MVDOR);
     2344    24059    3               PCOM.ZABS = 1;
     2345    24060    3        END;
     2346    24061
     2347    24062    2        LOP_REF$ = PILL -> ETT.LOP -> ETT.REF$;
     2348    24063    2        TYPE_DESC.SIZ$ = ADDR(NIL);
     2349    24064    2        TYPE_DESC.SSOP$ = ADDR(NIL);
     2350    24065    2        IF LOP_REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYF THEN
     2351    24066    3          DO;
     2352    24067    3            IF LOP_REF$ -> REF.NDSC.S = %NO_SIGN
     2353    24068    3              THEN PCOM.IABS = 2;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:90   
     2354    24069    3              ELSE PCOM.IABS = 0;
     2355    24070    3          END;
     2356    24071    2        ELSE
     2357    24072    2          PCOM.IABS = 1;
     2358    24073
     2359    24074    2        IF COMCOM.OB.ELS   THEN
     2360    24075    3          DO;
     2361    24076    3            ROP_REF$ = PILL -> ETT.ROP -> ETT.REF$;
     2362    24077    3            ROP_SIGN = ROP_REF$ -> REF.NDSC.S;
     2363    24078    3            TN = ROP_REF$ -> REF.NDSC.TN;
     2364    24079
     2365    24080    3            IF ROP_SIGN ~= %NO_SIGN AND TN = %NDSC9 AND PCOM.IABS ~= 1 THEN
     2366    24081    4              DO;    /* We need to first do an MVN then the
     2367    24082                             MVNX because MVNX does not handle signed
     2368    24083                             ASCII to EBCDIC moves.  We need a temp to hold the
     2369    24084                             results of the MVN. */
     2370    24085    4                SCALE = ROP_REF$ -> REF.NDSC.SF;
     2371    24086    4                PCOM.EABS = 1;
     2372    24087    4                ROP_LEN = ROP_REF$ -> REF.NDSC.N;
     2373    24088    4                TN = %NDSC4;
     2374    24089    4                TYPE_DESC.TYPE = %TYD;
     2375    24090    4                BOUNDS = %NEXT;
     2376    24091
     2377    24092                     %PACK_NDSC(@DESC = TYPE_DESC.DESC,
     2378    24093                                @LENGTH = ROP_LEN,
     2379    24094                                @TN = TN,
     2380    24095                                @SCALE = SCALE,
     2381    24096                                @SIGN = ROP_SIGN);
     2382    24145
     2383    24146    4                CALL Z8HU$ALLOT_TEMP(%N          ,/* FORMAT     */
     2384    24147    4                                     BOUNDS      ,/* BOUNDARY   */
     2385    24148    4                                     TYPE_DESC   ,/* DESCRIPTOR */
     2386    24149    4                                     %STALE     );/* FRESHNESS  */
     2387    24150    4                PCOM.EOPND = ETT$;
     2388    24151    4              END;
     2389    24152    3            ELSE
     2390    24153    3              PCOM.EABS = 0;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:91   
     2391    24154    3          END;
     2392    24155    2        ELSE
     2393    24156    3          DO;
     2394    24157
     2395    24158             /*   A %MVDOR should never be generated unless the ELS option is specified.  */
     2396    24159    3            IF PILL -> ETT.ID = %MVDOR      THEN
     2397    24160    3                CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);
     2398    24161
     2399    24162
     2400    24163    3            LOP_LEN = LOP_REF$ -> REF.NDSC.N;
     2401    24164    3            SCALE = LOP_REF$ -> REF.NDSC.SF;
     2402    24165    3            LOP_SIGN = LOP_REF$ -> REF.NDSC.S;
     2403    24166
     2404    24167    3            IF LOP_SIGN = %LEADING_SIGN THEN
     2405    24168    4              DO;
     2406    24169    4                PCOM.TABS = 0; /* Flag, leading sign */
     2407    24170    4                WORDS_FOR_TEMP = ((LOP_LEN + 14) / 8);
     2408    24171    4                BOUNDS = %EVEN;
     2409    24172    4                LDAQ_OFFSET = 0; /* Word offset to doubleword with sign, first digit */
     2410    24173    4                MVN_OFFSET  = 7; /* Digit offset to sign */
     2411    24174    4              END;
     2412    24175    3            ELSE
     2413    24176    4              DO;
     2414    24177    4                PCOM.TABS = 1; /* Flag, trailing sign */
     2415    24178    4                WORDS_FOR_TEMP = ((LOP_LEN + 15) / 8);
     2416    24179
     2417    24180    4                IF MOD(WORDS_FOR_TEMP,2) = 0 THEN
     2418    24181    4                  BOUNDS = %EVEN;
     2419    24182    4                ELSE
     2420    24183    4                  BOUNDS = %ODD;
     2421    24184
     2422    24185    4                LDAQ_OFFSET = WORDS_FOR_TEMP - 2;
             24185                         /* Word offset to doubleword with last digit, sign */
     2423    24186    4                MVN_OFFSET = (((WORDS_FOR_TEMP - 1) * 8) - LOP_LEN);
             24186                         /* Digit offset to sign */
     2424    24187    4              END;
     2425    24188
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:92   
     2426    24189    3            TN = %NDSC4;
     2427    24190    3            TYPE_DESC.TYPE = %TYO;
     2428    24191    3            LENGTH = WORDS_FOR_TEMP * 8;
     2429    24192
     2430    24193                 %PACK_NDSC ( @DESC      = TYPE_DESC.DESC ,
     2431    24194                              @LENGTH    = LENGTH ,
     2432    24195                              @SIGN      = LOP_SIGN ,
     2433    24196                              @TN        = TN ,
     2434    24197                              @SCALE     = SCALE );
     2435    24246
     2436    24247    3            CALL Z8HU$ALLOT_TEMP(%N               ,/* Format          */
     2437    24248    3                                 BOUNDS           ,/* Boundary        */
     2438    24249    3                                 TYPE_DESC        ,/* Descriptor      */
     2439    24250    3                                 %STALE          );/* Reuse a temp    */
     2440    24251
     2441    24252    3            TEMP$ = ETT$;
     2442    24253
     2443    24254                 %#OFF#(@FROM=TEMP$,@TO=PCOM.LOPND,@VALUE=LDAQ_OFFSET,@TYPE=%WORD_);
     2444    24334
     2445    24335                 %#OFF#(@FROM=TEMP$,@TO=PCOM.MOPND,@VALUE=MVN_OFFSET,@TYPE=%NUMERIC4);
     2446    24415
     2447    24416                 %#DESC#_NDSC(@FROM=PCOM.MOPND,@TO=PCOM.UOPND,@LENGTH=LOP_LEN,@SIGN=LOP_SIGN
             24416                     );
     2448    24628
     2449    24629                 %#DESC#_NDSC(@FROM=PILL->ETT.LOP,@TO=PCOM.NOPND,@LENGTH=LOP_LEN,@SIGN=
             24629                     %NO_SIGN);
     2450    24841
     2451    24842    3            IF LOP_SIGN = %LEADING_SIGN THEN
     2452    24843    3              I = 0;
     2453    24844    3            ELSE
     2454    24845    3              I = PILL -> ETT.LOP -> ETT.REF$ -> REF.NDSC.N - 1;
     2455    24846
     2456    24847                 %#DNA#(@FROM=PILL -> ETT.LOP,@TO=PCOM.YOPND);
     2457    24932                 %#DESC#_ADSC(@FROM=PCOM.YOPND,@TO=PCOM.FOPND,@LENGTH=1);
     2458    25077                 %#OFF#(@FROM=PCOM.FOPND,@TO=PCOM.OOPND,@VALUE=I,@TYPE=%ALPHA9);
     2459    25157
     2460    25158
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:93   
     2461    25159    3            CALL Z8HU$DEC_COUNT(TEMP$, 2);
     2462    25160    3            CALL Z8HU$DEC_COUNT(PCOM.MOPND,1);
     2463    25161    3            IF PCOM.IABS = 1 /* %TYD */
     2464    25162    3              THEN CALL Z8HU$DEC_COUNT(PCOM.YOPND,1);
     2465    25163    3              ELSE CALL Z8HU$INCCNT(PCOM.YOPND,1);
     2466    25164    3            CALL Z8HU$DEC_COUNT(PCOM.FOPND,1);
     2467    25165    3          END;
     2468    25166
     2469    25167        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:94   
     2470    25168    2   CASE(%MVDQ);
     2471    25169    2        PCOM.SOPND = PILL -> ETT.ROP;
     2472    25170    2        PCOM.ROPND = PILL -> ETT.LOP;
     2473    25171    2        PCOM.JOPND = PILL -> ETT.ROP;
     2474    25172
     2475    25173    2        CALL Z8HU$INCCNT(PILL -> ETT.ROP,1);
     2476    25174
     2477    25175
     2478    25176    2   CASE(%MVDR);
     2479    25177    2        PCOM.SOPND = PILL -> ETT.ROP;
     2480    25178    2        PCOM.ROPND = PILL -> ETT.LOP;
     2481    25179    2        PCOM.JOPND = PILL -> ETT.ROP;
     2482    25180
     2483    25181    2        CALL Z8HU$INCCNT(PILL -> ETT.ROP,1);
     2484    25182
     2485    25183        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:95   
     2486    25184    2   CASE(%MVEAN, %MVEDD);
     2487    25185
     2488    25186    2        CALL FREE_REGISTER_CHECK_3 (PILL);
     2489    25187
     2490    25188        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:96   
     2491    25189    2   CASE(%MVFIL);
     2492    25190
     2493    25191    2        CALL FREE_REGISTER_CHECK (PILL);
     2494    25192
     2495    25193    2        PCOM.DABS = PILL -> MVFIL.CODE;
     2496    25194             /* %MLRFIL = 0; %MRLFIL = 1 */
     2497    25195    2        CALL INSERT (PCOM.CHAR_GABS, 0, 1, PILL -> MVFIL.FILL);
     2498    25196
     2499    25197        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:97   
     2500    25198    2   CASE(%MVID,%MVII,%MVRL);
     2501    25199
     2502    25200    2          CALL FREE_REGISTER_CHECK (PILL);
     2503    25201
     2504    25202        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:98   
     2505    25203    2   CASE(%MVIH);
     2506    25204
     2507    25205    2          IF PILL -> ETT.ROP -> ETT.STATE >= %XR0
     2508    25206    2          AND PILL -> ETT.ROP -> ETT.STATE <= %XR7 THEN
     2509    25207    2            PCOM.XABS = 0;
     2510    25208    2          ELSE
     2511    25209    2            PCOM.XABS = 1;
     2512    25210
     2513    25211        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:99   
     2514    25212    2   CASE(%MVOD, %MVODR);
     2515    25213
     2516    25214    2            CALL FREE_REGISTER_CHECK (PILL);
     2517    25215
     2518    25216    2            LOP_REF$ = PILL -> ETT.LOP -> ETT.REF$;
     2519    25217
     2520    25218    2            IF LOP_REF$ -> REF.NDSC.TN = %NDSC9 AND
     2521    25219    2               LOP_REF$ -> REF.NDSC.S = %NO_SIGN THEN
     2522    25220    2              PCOM.EABS = 1;
     2523    25221    2            ELSE
     2524    25222    2              PCOM.EABS = 0;
     2525    25223
     2526    25224    2            IF LOP_REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYF THEN
     2527    25225    2              PCOM.IABS = 0;
     2528    25226    2            ELSE
     2529    25227    2              PCOM.IABS = 1;
     2530    25228
     2531    25229    2            IF PILL -> ETT.ID = %MVOD   THEN
     2532    25230    2              PCOM.ZABS = 0;
     2533    25231    2            ELSE
     2534    25232    2              PCOM.ZABS = 1;
     2535    25233         %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:100  
     2536    25234    2   CASE(%MVOO, %MVOOR);
     2537    25235
     2538    25236    2        CALL FREE_REGISTER_CHECK (PILL);
     2539    25237
     2540    25238          /*  These should never be generated unless you have ELS option  */
     2541    25239
     2542    25240    2       IF NOT COMCOM.OB.ELS                 THEN
     2543    25241    2           CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);
     2544    25242
     2545    25243    2        LOP_REF$ = PILL -> ETT.LOP -> ETT.REF$;
     2546    25244    2        IF LOP_REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYF THEN
     2547    25245    3          DO;
     2548    25246    3            IF LOP_REF$ -> REF.NDSC.S = %NO_SIGN
     2549    25247    3              THEN PCOM.IABS = 2;
     2550    25248    3              ELSE PCOM.IABS = 0;
     2551    25249    3          END;
     2552    25250    2        ELSE
     2553    25251    2          PCOM.IABS = 1;
     2554    25252        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:101  
     2555    25253    2   CASE( %MVQD, %MVRD );
     2556    25254
     2557    25255    3     DO CASE( CASE_PASS );
     2558    25256
     2559    25257    3       CASE( %FIRST_PASS );
     2560    25258    3         PCOM.XABS = PILL -> ILL.CODE;
     2561    25259
     2562    25260    3       CASE( %SECOND_PASS );
     2563    25261    3         PCOM.SOPND = PILL -> ETT.ROP;
     2564    25262    3         PCOM.ROPND = PILL -> ETT.LOP;
     2565    25263    3         PCOM.JOPND = PILL -> ETT.LOP;
     2566    25264
     2567    25265    3         CALL Z8HU$INCCNT(PILL -> ETT.LOP,1);
     2568    25266
     2569    25267    3     END;  /*   CASE_PASS   */
     2570    25268        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:102  
     2571    25269    2    CASE(%MVPP);
     2572    25270
     2573    25271    3      DO CASE(CASE_PASS);
     2574    25272    3       CASE(%FIRST_PASS);
     2575    25273
     2576    25274               /* Get Lop state and Lop action number */
     2577    25275
     2578    25276    3        POOL_LOP_ARGP = FALSE;
     2579    25277
     2580    25278             %FISH(TRIAD = PILL -> ETT.LOP,
     2581    25279                   RTN   = ST$$);
     2582    25287
     2583    25288    3        LTS$$ = ST$$ -> VARIABLE.LTS$;
     2584    25289
     2585    25290    3        IF NOT ST$$ -> VARIABLE.B.COMPILER_CREATED OR
     2586    25291    3           LTS$$ = ADDR(NIL) OR
     2587    25292    3           LTS$$ -> LTS.ID ~= %BASE_LTS OR
     2588    25293    3           LTS$$ -> BASE_LTS.ARGP$ = ADDR(NIL) THEN
     2589    25294    3          MVPP.ACTION# = %LOP_ST;
     2590    25295    3        ELSE
     2591    25296    4          DO;
     2592    25297    4            MVPP.LOP_ARGP$ = LTS$$ -> BASE_LTS.ARGP$;
     2593    25298    4            IF MVPP.LOP_ARGP$ -> ETT.STATE >= %PR0 AND
     2594    25299    4               MVPP.LOP_ARGP$ -> ETT.STATE <= %PR7 THEN
     2595    25300    5              DO;
     2596    25301                       /* If Lop ARGP is on the ESC_LIST, the register */
     2597    25302                       /* is dedicated to this ARGP forever and should */
     2598    25303                       /* not be relieved, else the prime is pooled    */
     2599    25304                       /* and its state is reset.                      */
     2600    25305
     2601    25306    5                IF MVPP.LOP_ARGP$ -> ETT.B.ESC_LIST THEN
     2602    25307    6                  DO;
     2603    25308    6                    MVPP.ACTION# = %LOP_ARGP_PR;
     2604    25309    6                    MVPP.STAR$ = MVPP.LOP_ARGP$;
     2605    25310    6                  END;
     2606    25311    5                ELSE
     2607    25312    6                  DO;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:103  
     2608    25313    6                    MVPP.ACTION# = %LOP_ARGP_NO_PR;
     2609    25314
     2610    25315    6                    POOL_LOP_ARGP = TRUE;
     2611    25316    6                  END;
     2612    25317    5              END;
     2613    25318    4            ELSE
     2614    25319    4              MVPP.ACTION# = %LOP_ARGP_NO_PR;
     2615    25320    4          END;
     2616    25321
     2617    25322               /* get Rop state and Rop action number, add Rop action */
     2618    25323               /* number to the Lop action number and then used the   */
     2619    25324               /* sum to retrieve the JMPDV value in array MVPP_VEC   */
     2620    25325
     2621    25326    3    ROP_CASE:
     2622    25327    4      DO;
     2623    25328    4        IF PILL -> ILL.ROP -> ETT.ID = %ADDR THEN
     2624    25329    5          DO;
     2625    25330    5            IF PILL -> ILL.ROP -> ETT.REF$ = ADDR(NIL) AND
     2626    25331    5              MVPP.ACTION# = %LOP_ARGP_PR AND
     2627    25332    5              PILL -> ILL.ROP -> ETT.STATE >= %PR0 AND
     2628    25333    5              PILL -> ILL.ROP -> ETT.STATE <= %PR7 THEN
     2629    25334    6              DO;
     2630    25335    6                IF POOL_LOP_ARGP AND PILL -> ILL.ROP -> ETT.STATE =
     2631    25336    6                   MVPP.LOP_ARGP$ -> ETT.STATE THEN
     2632    25337    7                  DO;
     2633    25338    7                    MVPP.ACTION# = %LOP_ROP_ALIAS;
     2634    25339    7                    POOL_LOP_ARGP = FALSE;
     2635    25340    7                  END;
     2636    25341    6                ELSE
     2637    25342    6                  MVPP.ACTION# = MVPP.ACTION# + %ROP_ADDR_PR;
     2638    25343
     2639    25344    6                EXIT ROP_CASE;
     2640    25345    6              END;
     2641    25346    5          END;
     2642    25347    4        ELSE
     2643    25348    5          DO;
     2644    25349                 %FISH (TRIAD = PILL -> ETT.ROP, RTN = ST$$);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:104  
     2645    25357
     2646    25358    5            LTS$$ = ST$$ -> VARIABLE.LTS$;
     2647    25359
     2648    25360    5            IF ST$$ -> VARIABLE.B.COMPILER_CREATED AND
     2649    25361    5               LTS$$ ~= ADDR(NIL) AND
     2650    25362    5              LTS$$ -> LTS.ID = %BASE_LTS AND
     2651    25363    5              LTS$$ -> BASE_LTS.ARGP$ ~= ADDR(NIL) THEN
     2652    25364    6              DO;
     2653    25365    6                MVPP.ROP_ARGP$ = LTS$$ -> BASE_LTS.ARGP$;
     2654    25366
     2655    25367    6                IF MVPP.ROP_ARGP$ -> ETT.STATE >= %PR0 AND
     2656    25368    6                   MVPP.ROP_ARGP$ -> ETT.STATE <= %PR7 THEN
     2657    25369    7                  DO;
     2658    25370    7                    IF MVPP.ACTION# ~= %LOP_ARGP_PR THEN
     2659    25371    7                      MVPP.STAR$ = MVPP.ROP_ARGP$;
     2660    25372
     2661    25373    7                    IF POOL_LOP_ARGP AND MVPP.ROP_ARGP$ -> ETT.STATE =
     2662    25374    7                       MVPP.LOP_ARGP$ -> ETT.STATE THEN
     2663    25375    8                      DO;
     2664    25376    8                        MVPP.ACTION# = %LOP_ROP_ALIAS;
     2665    25377    8                        POOL_LOP_ARGP = FALSE;
     2666    25378    8                      END;
     2667    25379    7                    ELSE
     2668    25380    7                      MVPP.ACTION# =  MVPP.ACTION# + %ROP_ARGP_PR;
     2669    25381
     2670    25382    7                    EXIT ROP_CASE;
     2671    25383    7                  END;
     2672    25384    6                ELSE
     2673    25385    6                  IF MVPP.ACTION# = %LOP_ARGP_PR THEN
     2674    25386    7                    DO;
     2675    25387    7                      MVPP.ACTION# = MVPP.ACTION# + %ROP_ARGP_NO_PR;
     2676    25388    7                      EXIT ROP_CASE;
     2677    25389    7                    END;
     2678    25390    6              END;
     2679    25391    5          END;     /* ROP is not %ADDR */
     2680    25392
     2681    25393    5        DO CASE (PILL -> ILL.ROP -> ETT.STATE);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:105  
     2682    25394    5          CASE(%ARA);
     2683    25395    5              MVPP.ACTION# = MVPP.ACTION# + %ROP_REGULAR_ARA;
     2684    25396
     2685    25397    5          CASE(%ARQ);
     2686    25398    5              MVPP.ACTION# = MVPP.ACTION# + %ROP_REGULAR_ARQ;
     2687    25399
     2688    25400    5          CASE(%PR0,%PR1,%PR2,%PR3,%PR4,%PR5,%PR6,%PR7);
     2689    25401    5              IF POOL_LOP_ARGP AND PILL -> ILL.ROP -> ETT.STATE =
     2690    25402    5                 MVPP.LOP_ARGP$ -> ETT.STATE THEN
     2691    25403    6                DO;
     2692    25404    6                  MVPP.ACTION# = %LOP_ROP_ALIAS;
     2693    25405    6                  POOL_LOP_ARGP = FALSE;
     2694    25406    6                END;
     2695    25407    5              ELSE
     2696    25408    5                MVPP.ACTION# = MVPP.ACTION# + %ROP_REGULAR_PR;
     2697    25409
     2698    25410    5          CASE(ELSE);
     2699    25411    5              MVPP.ACTION# = MVPP.ACTION# + %ROP_REGULAR_ST;
     2700    25412
     2701    25413    5        END; /* DO CASE */
     2702    25414    4      END ROP_CASE;
     2703    25415
     2704    25416
     2705    25417    4        DO CASE(MVPP.ACTION#);
     2706    25418
     2707    25419    4          CASE(3);
     2708    25420    4            IF MVPP.LOP_ARGP$ -> ETT.STATE = MVPP.ROP_ARGP$ -> ETT.STATE THEN
     2709    25421    4              MVPP.ACTION# = %LOP_ROP_ALIAS;
     2710    25422
     2711    25423    4          CASE(4,5);
     2712    25424    4            IF MVPP.ROP_ARGP$ -> ETT.STATE = PILL -> ILL.LOP -> ETT.STATE THEN
     2713    25425    4              MVPP.ACTION# = %LOP_ROP_ALIAS;
     2714    25426
     2715    25427    4          CASE(0,6,9);
     2716    25428    4            IF MVPP.LOP_ARGP$ -> ETT.STATE = PILL -> ILL.ROP -> ETT.STATE THEN
     2717    25429    4              MVPP.ACTION# = %LOP_ROP_ALIAS;
     2718    25430
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:106  
     2719    25431    4          CASE(ELSE);
     2720    25432    4            IF PILL -> ILL.LOP -> ETT.STATE > %REF_T AND
     2721    25433    4              PILL -> ILL.LOP -> ETT.STATE = PILL -> ILL.ROP -> ETT.STATE
     2722    25434    4              THEN
     2723    25435    4                MVPP.ACTION# = %LOP_ROP_ALIAS;
     2724    25436
     2725    25437    4        END; /* DO CASE */
     2726    25438
     2727    25439
     2728    25440    3        PCOM.XABS = MVPP_VEC(MVPP.ACTION#);
     2729    25441
     2730    25442    3      CASE(%SECOND_PASS);
     2731    25443
     2732    25444    3        IF POOL_LOP_ARGP THEN
     2733    25445    4          DO;
     2734    25446    4            CALL Z8HU$POOL_PRIME(MVPP.LOP_ARGP$);
     2735    25447    4            CALL Z8HU$POOL(MVPP.LOP_ARGP$);
     2736    25448    4          END;
     2737    25449
     2738    25450    4        DO CASE(MVPP.ACTION#);
     2739    25451    4          CASE(0,3,6,9,12,15,18);
     2740    25452                   /* relieve the triads from the register just updated */
     2741    25453    4              P$ = RAT.PRIMES(MVPP.LOP_ARGP$ -> ETT.STATE);
     2742    25454
     2743    25455    5              DO WHILE ( P$ ~= ADDR(NIL) );
     2744    25456    5                P2$ = P$ -> PRIME.NEXT;
     2745    25457
     2746    25458    5                IF P$ -> PRIME.TRIAD ~= MVPP.LOP_ARGP$ THEN
     2747    25459    6                  DO;
     2748    25460    6                    CALL Z8HU$POOL_PRIME(P$);
     2749    25461    6                    IF P$ -> PRIME.TRIAD -> ETT.ID = %ARGP OR
     2750    25462    6                       P$ -> PRIME.TRIAD -> ETT.ID = %ESC THEN
     2751    25463    6                      CALL Z8HU$POOL(P$);
     2752    25464    6                  END;
     2753    25465
     2754    25466
     2755    25467    5                P$ = P2$;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:107  
     2756    25468    5              END;
     2757    25469
     2758    25470    4              IF MVPP.ACTION# = 6 THEN
     2759    25471    5                DO;
     2760    25472    5                  REGID = MVPP.LOP_ARGP$ -> ETT.STATE;
     2761    25473
     2762    25474    5                  CALL Z8HG$USE_REGISTER(MVPP.ROP_ARGP$, REGID);
     2763    25475
     2764    25476    5                  IF MVPP.ROP_ARGP$ -> ETT.REF$ = ADDR(NIL) THEN
     2765    25477    5                    CALL Z8HI$BURST(MVPP.ROP_ARGP$,
     2766    25478    5                                    PEPD(%TRIAD));
     2767    25479
     2768    25480    5                END;
     2769    25481
     2770    25482    4          CASE(1,4,10);
     2771    25483
     2772    25484    4              IF MVPP.ACTION# = 4 THEN
     2773    25485    4                REGID = MVPP.ROP_ARGP$ -> ETT.STATE;
     2774    25486    4              ELSE
     2775    25487    4                 REGID = PILL -> ILL.ROP -> ETT.STATE;
     2776    25488
     2777    25489    4              CALL Z8HG$USE_REGISTER(MVPP.LOP_ARGP$, REGID);
     2778    25490
     2779    25491    4              IF MVPP.LOP_ARGP$ -> ETT.REF$ = ADDR(NIL) THEN
     2780    25492    4                CALL Z8HI$BURST(MVPP.LOP_ARGP$,
     2781    25493    4                                PEPD(%TRIAD));
     2782    25494
     2783    25495
     2784    25496    4          CASE(2,5,11);
     2785    25497
     2786    25498    4              IF MVPP.ACTION# = 5 THEN
     2787    25499    4                REGID = MVPP.ROP_ARGP$ -> ETT.STATE;
     2788    25500    4              ELSE
     2789    25501    4                REGID = PILL -> ILL.ROP -> ETT.STATE;
     2790    25502
     2791    25503    4              CALL Z8HG$USE_REGISTER(PILL -> ILL.LOP, REGID);
     2792    25504
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:108  
     2793    25505    4          CASE(ELSE);
     2794    25506
     2795    25507                   /* ETT.STATE already updated */
     2796    25508
     2797    25509    4        END; /* DO CASE MVPP.ACTION# */
     2798    25510
     2799    25511    3      CASE(ELSE);
     2800    25512
     2801    25513              /* Error, there should have been only two passes */
     2802    25514
     2803    25515    3    END; /* DO CASE CASE_PASS */
     2804    25516        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:109  
     2805    25517    2   CASE(%MVT);
     2806    25518
     2807    25519             %IF GCOS;
     2808    25520 C           IF PILL -> ILL.ROP -> ETT.ID = %TRIAD OR
     2809    25521 C               PILL -> ILL.ROP -> ETT.ID = %BASE THEN
     2810    25522 C             PCOM.DABS = 0;
     2811    25523 C           ELSE
     2812    25524 C             PCOM.DABS = 1;
     2813    25525             %ENDIF;
     2814    25526
     2815    25527    2        CALL FREE_REGISTER_CHECK_3 (PILL);
     2816    25528
     2817    25529        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:110  
     2818    25530    2   CASE( %OCCHK );
     2819    25531
     2820    25532    2     PCOM.CABS = BITBIN( %GCOS );
     2821    25533    2     PCOM.ZOPND = COMCOM.ESC -> ETT.LOP;
     2822    25534
     2823    25535        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:111  
     2824    25536    2   CASE(%OS_CALL);
     2825    25537
     2826    25538    2        ARGLIST$ = PILL -> ETT.LOP;
     2827    25539    2        NUMBER_OF_ARGS = ARGLIST$ -> LTS.N - 1;
     2828    25540
     2829    25541    3        DO CASE(CASE_PASS);
     2830    25542    3          CASE(%FIRST_PASS);
     2831    25543
     2832    25544    3            PCOM.OABS = 0;
     2833    25545
     2834    25546    3            PCOM.DABS = NUMBER_OF_ARGS;
     2835    25547                 %IF GCOS;
     2836    25548 C               PCOM.MABS = NUMBER_OF_ARGS;
     2837    25549 C               PCOM.LABS = -1;
     2838    25550 C               IF PILL -> ILL.CODE = %OP_CALL_ID OR
     2839    25551 C                  PILL -> ILL.CODE = %OP_CANCEL THEN
     2840    25552 C                 PCOM.VABS = 0;                        /* DESC Needed */
     2841    25553 C               ELSE
     2842    25554 C                 PCOM.VABS = 1;                        /* No DESC     */
     2843    25555                 %ENDIF;
     2844    25556
     2845    25557
     2846    25558    4            IF PILL->OS_CALL.ALTRET$ = ADDR(NIL) THEN DO;
     2847    25559    4              PCOM.EABS = 0;
     2848    25560                   %IF GCOS;
     2849    25561 C                 PCOM.RABS = 0;
     2850    25562                   %ENDIF;
     2851    25563    4            END;
     2852    25564    4            ELSE DO;
     2853    25565    4              PCOM.EABS = 1;
     2854    25566                   %IF GCOS;
     2855    25567 C                 DO CASE (PILL -> ILL.CODE);
     2856    25568 C                   CASE (%OP_DELETE_IND, %OP_DELETE_REL, %OP_REWRITE_IND,
     2857    25569 C                         %OP_REWRITE_REL, %OP_START_IND, %OP_START_REL,
     2858    25570 C                         %OP_WRITE_SEQ, %OP_WRITE_IND, %OP_WRITE_REL);
     2859    25571 C                     PCOM.RABS = 1; /* RETURN$, not ALTRET$ */
     2860    25572 C                   CASE (ELSE);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:112  
     2861    25573 C                     PCOM.RABS = 0;
     2862    25574 C                 END; /* CASE */
     2863    25575                   %ENDIF;
     2864    25576    4            END;
     2865    25577
     2866    25578    3            IF NUMBER_OF_ARGS = 0 THEN
     2867    25579    3              PCOM.WABS = 0;
     2868    25580    3            ELSE
     2869    25581    3              PCOM.WABS = 1;
     2870    25582
     2871    25583    3          CASE(%SECOND_PASS);
     2872    25584    4            DO I = 0 TO NUMBER_OF_ARGS - 1;
     2873    25585    4              CALL Z8HU$DEC_COUNT(ARGLIST$ -> ARGLIST.ARG$(I),1);
     2874    25586    4            END;
     2875    25587
     2876    25588    3        END /* Case */;
     2877    25589        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:113  
     2878    25590    2   CASE( %PINC );                                /*#28298*/
     2879    25591
     2880    25592    2     PCOM.GABS = PILL -> PINC.ROPCON;
     2881    25593
     2882    25594    2     IF PILL -> ETT.ROP -> ST.NDSC.TN   THEN
     2883    25595    3       DO;
     2884    25596    3         PCOM.JABS = 1;
     2885    25597    3         PCOM.GABS = PCOM.GABS * 8;
     2886    25598    3         PCOM.GABS = PCOM.GABS + PILL -> ETT.ROP -> ST.NDSC.CN;
     2887    25599    3       END;
     2888    25600    2     ELSE
     2889    25601    3       DO;
     2890    25602    3         PCOM.JABS = 0;
     2891    25603    3         PCOM.GABS = PCOM.GABS * 4;
     2892    25604    3         PCOM.GABS = PCOM.GABS + PILL -> ETT.ROP -> ST.ADSC.CN;
     2893    25605    3       END;
     2894    25606
     2895    25607    2     PILL -> ETT.ROP = ADDR(NIL);
     2896    25608
     2897    25609        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:114  
     2898    25610    2   CASE(%P_A_PRESET);
     2899    25611        /*V*
     2900    25612                      P_A_PRESET
     2901    25613
     2902    25614             Preset a word.  The top half of the word will contain
     2903    25615             the address of the ST item pointed to by P_A_PRESET.LOP.
     2904    25616             The bottom half of the word will be preset to the value of
     2905    25617             P_A_PRESET.ROPCON.  The receiving address will be the
     2906    25618             address of the ST item pointed to by P_A_PRESET.TO_ plus
     2907    25619             P_A_PRESET.OFFSET.
     2908    25620        */
     2909    25621    2        TARGET$ = PILL -> P_A_PRESET.TO_;
     2910    25622    2        SENDING$ = PILL -> P_A_PRESET.LOP;
     2911    25623
     2912    25624    2        CURRENT_SA = TARGET$ -> VARIABLE.SA + PILL -> P_A_PRESET.OFFSET;
     2913    25625
     2914    25626    2        IF BITS_IN_BUFFER ~= 0 THEN
     2915    25627    2            CALL FLUSH_BUFFER(OLD_SA);
     2916    25628
     2917    25629    2        IF PILL -> P_A_PRESET.OFFSET = 0 THEN
     2918    25630               %NEW_LAB(@ST$ = TARGET$);
     2919    25666
     2920    25667    2        BOTTOM_HALF = PILL -> P_A_PRESET.ROPCON;
     2921    25668
     2922    25669    2        MOD_KEY.KEY = 0;
     2923    25670    2        INST_WORD = '0'O;
     2924    25671    2        INST_WORD.LOW = BINBIT(BOTTOM_HALF,18);
     2925    25672
     2926    25673    2        IF SENDING$ ~= ADDR(NIL) THEN
     2927    25674    3          DO;
     2928    25675    3            IF SENDING$ -> ST.ID = %CONST AND
     2929    25676    3              NOT SENDING$ -> CONST.B.ALLOCATED THEN
     2930    25677    4              DO;
     2931    25678    4                SENDING$ -> CONST.B.ALLOCATED = TRUE;
     2932    25679    4                SENDING$ -> CONST.ALLOC_LINK = CONST$;
     2933    25680    4                CONST$ = SENDING$;
     2934    25681    4              END;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:115  
     2935    25682    3            MOD_KEY.B.HALF_REL = TRUE;
     2936    25683    3            MOD_KEY.B.RESOLVE_ADDRESS = TRUE;
     2937    25684    3          END;
     2938    25685
     2939    25686             %NEW_WORD( @OU_WORD = INST_WORD,
     2940    25687                        @KEY = MOD_KEY.KEY,
     2941    25688                        @ST$ = SENDING$,
     2942    25689                        @OFFSET = CURRENT_SA,
     2943    25690                        @ADVANCE_BLOCK_SIZE = NO);
     2944    25737
     2945    25738    2        OLD_SA = CURRENT_SA;
     2946    25739        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:116  
     2947    25740    2   CASE( %P_P_PRESET );
     2948    25741
     2949    25742    2       UPPER$ = PILL -> P_P_PRESET.LOP;
     2950    25743    2       LOWER$ = PILL -> P_P_PRESET.ROP;
     2951    25744    2       TARGET$ = PILL -> P_P_PRESET.TO_;
     2952    25745
     2953    25746    2       CURRENT_SA = TARGET$ -> VARIABLE.SA + PILL -> P_P_PRESET.OFFSET;
     2954    25747
     2955    25748    2       IF BITS_IN_BUFFER ~= 0    THEN
     2956    25749    2         CALL FLUSH_BUFFER( OLD_SA );
     2957    25750
     2958    25751    2       IF PILL -> P_P_PRESET.OFFSET = 0  THEN
     2959    25752
     2960    25753              %NEW_LAB( @ST$ = TARGET$);
     2961    25789
     2962    25790    2       MOD_KEY.KEY = 0;
     2963    25791    2       MOD_KEY.B.BOTH_REL = TRUE;
     2964    25792    2       MOD_KEY.B.RESOLVE_ADDRESS = TRUE;
     2965    25793
     2966    25794            %NEW_WORD( @KEY = MOD_KEY.KEY,
     2967    25795                       @ST$ = UPPER$,
     2968    25796                       @ST2$ = LOWER$,
     2969    25797                       @OFFSET = CURRENT_SA,
     2970    25798                       @ADVANCE_BLOCK_SIZE = NO);
     2971    25845
     2972    25846        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:117  
     2973    25847    2   CASE(%PEND);
     2974    25848        /*V*
     2975    25849                     PEND
     2976    25850
     2977    25851             A PEND item marks the end of the preset items for a data
     2978    25852             division.  The PEND item causes the preset BUFFER to be
     2979    25853             flushed.  This is done to prevent writing backward in
     2980    25854             the object unit, as might be necessary if we waited
     2981    25855             until the end of the program to flush the buffer.
     2982    25856        */
     2983    25857
     2984    25858    2        MOD_KEY.B = '0'O;
     2985    25859    2        IF BITS_IN_BUFFER ~= 0 THEN
     2986    25860    2            CALL FLUSH_BUFFER(OLD_SA);
     2987    25861    2        ELSE                                                  /*#31015*/
     2988    25862    2          FLUSH_BLK$ = ADDR(NIL);                             /*#31015*/
     2989    25863
     2990    25864
     2991    25865        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:118  
     2992    25866    2   CASE(%PREOFF);
     2993    25867
     2994    25868    2        MOD_KEY.B = '0'O;
     2995    25869
     2996    25870    2         TARGET$ = PILL -> ETT.LOP;
     2997    25871    2        CURRENT_SA = TARGET$ -> VARIABLE.SA + PILL -> PREOFF.OFFSET;
     2998    25872
     2999    25873    2        IF OLD_SA ~= CURRENT_SA AND BITS_IN_BUFFER ~= 0 THEN
     3000    25874    2          CALL FLUSH_BUFFER(OLD_SA);
     3001    25875
     3002    25876    2        CONSTANT$ = PILL -> ETT.ROP;
     3003    25877
     3004    25878             %GET_CONSTANT_ADDRESS (@CONSTANT=CONSTANT$, @STRING=STRING$);
     3005    25886
     3006    25887    2        IF PILL -> PREOFF.OFFSET = 0 THEN
     3007    25888               %NEW_LAB ( @ST$ = TARGET$ );
     3008    25924
     3009    25925             /* ASSUME CN OF 0 */
     3010    25926
     3011    25927    2        SOURCE = 0;
     3012    25928    2        TOTAL_MOVED = 0;
     3013    25929    2        TARGET = 0;
     3014    25930
     3015    25931    3        DO WHILE TOTAL_MOVED < PILL -> PREOFF.N;
     3016    25932
     3017    25933    3          SUBSTR(CHAR_BUFFER,TARGET,1) = SUBSTR(STRING$->CHARS,SOURCE,1);
     3018    25934
     3019    25935    3          SOURCE = SOURCE + 1;
     3020    25936    3          TARGET = TARGET + 1;
     3021    25937
     3022    25938    3          IF TARGET = 4 THEN
     3023    25939    4            DO;
     3024    25940    4              CALL FLUSH_BUFFER(CURRENT_SA);
     3025    25941    4              TARGET = 0;
     3026    25942    4              CURRENT_SA = CURRENT_SA + 1;
     3027    25943    4              TOTAL_MOVED = TOTAL_MOVED + 1;
     3028    25944    4            END;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:119  
     3029    25945    3        END;
     3030    25946
     3031    25947    2        BITS_IN_BUFFER = TARGET * 9;
     3032    25948    2        OLD_SA = CURRENT_SA;
     3033    25949    2        IF BITS_IN_BUFFER ~= 0  THEN
     3034    25950    2          FLUSH_BLK$ = CURRENT_BLOCK$;
     3035    25951
     3036    25952        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:120  
     3037    25953    2   CASE(%PRESET);
     3038    25954
     3039    25955    2        MOD_KEY.B = '0'O;
     3040    25956
     3041    25957    2        TARGET$ = PILL -> ETT.LOP;
     3042    25958
     3043    25959    2        CURRENT_SA = TARGET$ -> VARIABLE.SA + PILL -> PRESET.OFFSET;
     3044    25960
     3045    25961    2        IF (OLD_SA ~= CURRENT_SA  OR  FLUSH_BLK$ ~= CURRENT_BLOCK$) AND BITS_IN_BUFFER
             25961                 ~= 0 THEN
     3046    25962    2          CALL FLUSH_BUFFER(OLD_SA);
     3047    25963
     3048    25964    2        CONSTANT$ = PILL -> ETT.ROP;
     3049    25965
     3050    25966             %GET_CONSTANT_ADDRESS ( @CONSTANT=CONSTANT$, @STRING=STRING$);
     3051    25974
     3052    25975             %NEW_LAB( @ST$ = TARGET$ );
     3053    26011
     3054    26012    3        DO CASE(TARGET$ -> VARIABLE.TYPE);
     3055    26013    3          CASE(%TYI,%TYR,%TYQ);
     3056    26014    3            CALL FLUSH(CONSTANT$,STRING$,CURRENT_SA,(CONSTANT$->CONST.NDSC.N/4));
     3057    26015
     3058    26016    3            BITS_IN_BUFFER = 0;
     3059    26017    3            OLD_SA = CURRENT_SA;
     3060    26018
     3061    26019    3          CASE(%TYO,%TYH,%TYJ,%TYK);
     3062    26020    3            IF PILL -> PRESET.OFFSET = 0   THEN
     3063    26021    3                CALL ALPHANUMERIC_PRESET(BINBIT(TARGET$ -> VARIABLE.NDSC.N, 36));
     3064    26022    3            ELSE
     3065    26023    3                CALL ALPHANUMERIC_PRESET(BINBIT(CONSTANT$ -> VARIABLE.NDSC.N,36));
     3066    26024
     3067    26025    3          CASE(%TYA, %TYN, %TYE);
     3068    26026    3            IF PILL -> PRESET.OFFSET = 0  THEN
     3069    26027                     %GET_ADSC_LEN(ST$ = TARGET$, RTN = TARGET_LENGTH);
     3070    26038    3            ELSE
     3071    26039    3                TARGET_LENGTH = CONSTANT$ -> VARIABLE.ADSC.N;
     3072    26040    3            CALL ALPHANUMERIC_PRESET(TARGET_LENGTH);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:121  
     3073    26041
     3074    26042    3          CASE(%TYD);
     3075    26043    3            IF NOT TARGET$ -> VARIABLE.B.SUB_CLASS.EDITED THEN
     3076    26044    4              DO;
     3077    26045    5                DO I=1 TO 63;
     3078    26046    5                  MVN_BUFFER(I) = 0;
     3079    26047    5                END;
     3080    26048    4                MVN_BUFFER(0) = BUFFER;
     3081    26049
     3082    26050    4                IF PILL -> PRESET.OFFSET = 0  THEN
     3083    26051    5                  DO;
     3084    26052    5                    IF TARGET$ -> VARIABLE.B.P     THEN
     3085    26053    5                      CALL Z9AU$MOVE_C3_NUMERIC(CONSTANT$->CONST.NDSC,TARGET$->VARIABLE
             26053                               .NDSC,STRING$,ADDR(MVN_BUFFER));
     3086    26054    5                    ELSE
     3087    26055    5                      CALL Z9AU$MOVE_NUMERIC(CONSTANT$ -> CONST.NDSC,TARGET$ ->
             26055                               VARIABLE.NDSC,STRING$,ADDR(MVN_BUFFER));
     3088    26056
     3089    26057    5                    IF TARGET$ -> VARIABLE.NDSC.TN = %NDSC4 THEN
     3090    26058    5                      BITS_IN_BUFFER = ((TARGET$ -> VARIABLE.NDSC.N + TARGET$ ->
             26058                               VARIABLE.NDSC.CN) * 9 + 1) / 2;
     3091    26059    5                    ELSE
     3092    26060    5                      BITS_IN_BUFFER = ((TARGET$ -> VARIABLE.NDSC.N + TARGET$ ->
             26060                               VARIABLE.ADSC.CN) * 9);
     3093    26061    5                  END;
     3094    26062    4                ELSE
     3095    26063    5                  DO;
     3096    26064    5                    IF TARGET$ -> VARIABLE.B.P    THEN
     3097    26065    5                      CALL Z9AU$MOVE_C3_NUMERIC(CONSTANT$ -> CONST.NDSC,CONSTANT$ ->
             26065                               VARIABLE.NDSC,STRING$,ADDR(MVN_BUFFER));
     3098    26066    5                    ELSE
     3099    26067    5                      CALL Z9AU$MOVE_NUMERIC(CONSTANT$ -> CONST.NDSC,CONSTANT$ ->
             26067                               VARIABLE.NDSC,STRING$,ADDR(MVN_BUFFER));
     3100    26068    5                    IF CONSTANT$ -> VARIABLE.NDSC.TN = %NDSC4 THEN
     3101    26069    5                      BITS_IN_BUFFER = ((CONSTANT$ -> VARIABLE.NDSC.N + CONSTANT$ ->
             26069                               VARIABLE.NDSC.CN) * 9 + 1) / 2;
     3102    26070    5                    ELSE
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:122  
     3103    26071    5                      BITS_IN_BUFFER = ((CONSTANT$ -> VARIABLE.NDSC.N + CONSTANT$ ->
             26071                               VARIABLE.ADSC.CN) * 9);
     3104    26072    5                  END;
     3105    26073
     3106    26074    4                LENGTH_IN_WORDS = BITS_IN_BUFFER / 36;
     3107    26075
     3108    26076    4                CALL FLUSH(CONSTANT$,ADDR(MVN_BUFFER),CURRENT_SA,LENGTH_IN_WORDS);
     3109    26077
     3110    26078    4                BUFFER = MVN_BUFFER(LENGTH_IN_WORDS);
     3111    26079    4                OLD_SA = CURRENT_SA + (LENGTH_IN_WORDS);
     3112    26080    4                BITS_IN_BUFFER = MOD(BITS_IN_BUFFER, 36);
     3113    26081    4              END;
     3114    26082    3            ELSE
     3115    26083    3              IF PILL -> PRESET.OFFSET = 0  THEN
     3116    26084    3                  CALL ALPHANUMERIC_PRESET(BINBIT(TARGET$ -> VARIABLE.NDSC.N, 36));
     3117    26085    3               ELSE
     3118    26086    3                  CALL ALPHANUMERIC_PRESET(BINBIT(CONSTANT$ -> VARIABLE.NDSC.N, 36));
     3119    26087
     3120    26088    3          CASE(%TYF); /* Preset EBCDIC numeric */
     3121    26089    4            DO I = 1 TO 63;
     3122    26090    4              MVN_BUFFER(I) = 0;
     3123    26091    4            END;
     3124    26092    3            MVN_BUFFER(0) = BUFFER;
     3125    26093
     3126    26094    3            IF PILL -> PRESET.OFFSET = 0 THEN
     3127    26095    4              DO;
     3128    26096    4                CALL Z9AU$MOVE_EBCDIC(CONSTANT$ -> CONST.NDSC, TARGET$ -> VARIABLE.NDSC
             26096                         ,STRING$,ADDR(MVN_BUFFER));
     3129    26097    4                BITS_IN_BUFFER = ((TARGET$ -> VARIABLE.NDSC.N + TARGET$ -> VARIABLE.
             26097                         ADSC.CN) * 9);
     3130    26098    4              END;
     3131    26099    3            ELSE
     3132    26100    4              DO;
     3133    26101    4                CALL Z9AU$MOVE_EBCDIC(CONSTANT$ -> CONST.NDSC,CONSTANT$ -> VARIABLE.
             26101                         NDSC,STRING$,ADDR(MVN_BUFFER));
     3134    26102    4                BITS_IN_BUFFER = ((CONSTANT$ -> VARIABLE.NDSC.N + CONSTANT$ -> VARIABLE
             26102                         .ADSC.CN) * 9);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:123  
     3135    26103    4              END;
     3136    26104
     3137    26105    3            LENGTH_IN_WORDS = BITS_IN_BUFFER / 36;
     3138    26106
     3139    26107    3            CALL FLUSH(CONSTANT$,ADDR(MVN_BUFFER),CURRENT_SA,LENGTH_IN_WORDS);
     3140    26108
     3141    26109    3            BUFFER = MVN_BUFFER(LENGTH_IN_WORDS);
     3142    26110    3            OLD_SA = CURRENT_SA + (LENGTH_IN_WORDS);
     3143    26111    3            BITS_IN_BUFFER = MOD(BITS_IN_BUFFER, 36);
     3144    26112
     3145    26113    3          CASE(%TYC); /* Preset GBCD numeric */
     3146    26114    4            DO I = 1 TO 63;
     3147    26115    4              MVN_BUFFER(I) = 0;
     3148    26116    4            END;
     3149    26117    3            MVN_BUFFER(0) = BUFFER;
     3150    26118
     3151    26119    3            CALL Z9AU$MOVE_GBCD(CONSTANT$ -> CONST.NDSC,TARGET$ -> VARIABLE.NDSC,
             26119                     STRING$,ADDR(MVN_BUFFER));
     3152    26120
     3153    26121    3            BITS_IN_BUFFER = ((TARGET$ -> VARIABLE.NDSC.N + TARGET$ -> VARIABLE.NDSC.CN
             26121                     ) * 6);
     3154    26122
     3155    26123    3            LENGTH_IN_WORDS = BITS_IN_BUFFER / 36;
     3156    26124
     3157    26125    3            CALL FLUSH(CONSTANT$,ADDR(MVN_BUFFER),CURRENT_SA,LENGTH_IN_WORDS);
     3158    26126
     3159    26127    3            BUFFER = MVN_BUFFER(LENGTH_IN_WORDS);
     3160    26128    3            OLD_SA = CURRENT_SA + (LENGTH_IN_WORDS);
     3161    26129    3            BITS_IN_BUFFER = MOD(BITS_IN_BUFFER, 36);
     3162    26130
     3163    26131    3          CASE(%TYB); /* Preset GBCD */
     3164    26132    3            IF PILL -> PRESET.OFFSET = 0 THEN
     3165    26133                   %GET_ADSC_LEN(ST$ = TARGET$, RTN = TARGET_LENGTH);
     3166    26144    3            ELSE
     3167    26145    3              TARGET_LENGTH = CONSTANT$ -> VARIABLE.ADSC.N;
     3168    26146    3            CALL GBCD_PRESET(TARGET_LENGTH);
     3169    26147
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:124  
     3170    26148    3          CASE(%TYP);
     3171    26149
     3172    26150    3            IF CONSTANT$ -> ST.ID = %CONST AND
     3173    26151    3              CONSTANT$ -> CONST.TYPE = %TYI THEN
     3174    26152    4              DO;
     3175    26153    4                CALL FLUSH(CONSTANT$,STRING$,CURRENT_SA,(CONSTANT$->CONST.NDSC.N/4));
     3176    26154    4              END;
     3177    26155    3            ELSE
     3178    26156    4              DO;
     3179    26157                     %NEW_ORG ( @ST$ = COMCOM.BLOCK$ );
     3180    26193    4                CURRENT_BLOCK$ = COMCOM.BLOCK$;
     3181    26194
     3182    26195    4                INST_WORD = '0'O;
     3183    26196
     3184    26197    4                MOD_KEY.KEY = 0;
     3185    26198    4                MOD_KEY.B.WORD_REL = TRUE;
     3186    26199    4                MOD_KEY.B.RESOLVE_ADDRESS = TRUE;
     3187    26200
     3188    26201                     %NEW_WORD( @OU_WORD = INST_WORD ,
     3189    26202                                @KEY     = MOD_KEY.KEY ,
     3190    26203                                @ST$     = PILL -> ETT.ROP ,
     3191    26204                                @OFFSET  =
             26204                                    PILL -> ETT.LOP -> VARIABLE.SA + PILL -> PRESET.OFFSET ,
     3192    26205                                @ADVANCE_BLOCK_SIZE = NO);
     3193    26252
     3194    26253                     %NEW_ORG ( @ST$ = "COMCOM.SEGMENT$(%PROC)" );
     3195    26289    4                CURRENT_BLOCK$ = COMCOM.SEGMENT$(%PROC);
     3196    26290
     3197    26291    4             END;
     3198    26292
     3199    26293    3            BITS_IN_BUFFER = 0;
     3200    26294    3            OLD_SA = CURRENT_SA;
     3201    26295    3        END /* Case */;
     3202    26296
     3203    26297    2        IF BITS_IN_BUFFER = 0 THEN
     3204    26298    3          DO;
     3205    26299    3            FLUSH_BLK$ = ADDR(NIL);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:125  
     3206    26300    3            BUFFER = 0;
     3207    26301    3          END;
     3208    26302    2        ELSE
     3209    26303    2          FLUSH_BLK$ = CURRENT_BLOCK$;
     3210    26304
     3211    26305
     3212    26306    2        IF TARGET$ -> VARIABLE.B.ARRAY_PRESET THEN
     3213    26307    3            DO;
     3214    26308    3              TARGET$ -> VARIABLE.QLT$ -> QLT.B.ARRAY_VALUED = TRUE;
     3215    26309
     3216    26310                   %NEW_ARRAY_PRESET_LTS (@CONSTANT$ = CONSTANT$,
     3217    26311                                          @STRING$   = STRING$,
     3218    26312                                          @BITS_LEFT = BITS_IN_BUFFER);
     3219    26408
     3220    26409    3              IF BITS_IN_BUFFER = 0 THEN
     3221    26410    3                LTS$ -> ARRAY_PRESET_LTS.LAST_OFFSET = OBJ$ -> OBJ_WORD.OFFSET;
     3222    26411    3              ELSE
     3223    26412    3                LTS$ -> ARRAY_PRESET_LTS.LAST_OFFSET = OLD_SA;
     3224    26413
     3225    26414    3              QLT$ = TARGET$ -> VARIABLE.QLT$;
     3226    26415    3              QLT$ -> QLT.ARRAY_VALUE$ = LTS$;
     3227    26416
     3228    26417    4              DO WHILE (QLT$ -> QLT.FATHER ~= ADDR(NIL));
     3229    26418    4                QLT$ = QLT$ -> QLT.FATHER;
     3230    26419    4              END;
     3231    26420
     3232    26421                /* save the last obj_word address of this data structure
     3233    26422                   on the top QLT of this data structure                 */
     3234    26423
     3235    26424    3              QLT$ -> QLT.ARRAY_VALUE$ = LTS$;
     3236    26425
     3237    26426    3            END;
     3238    26427
     3239    26428
     3240    26429        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:126  
     3241    26430    2   CASE(%PTR_SET);
     3242    26431
     3243    26432    2        IF BITS_IN_BUFFER ~= 0 THEN
     3244    26433    2            CALL FLUSH_BUFFER(OLD_SA);
     3245    26434
     3246    26435    2        TARGET$ = PILL -> ILL.LOP;
     3247    26436    2        SENDING$ = PILL -> ILL.ROP;
     3248    26437
     3249    26438    2        CURRENT_SA = TARGET$ -> VARIABLE.SA + PILL -> PRESET.OFFSET;
     3250    26439
     3251    26440    2        IF PILL -> PRESET.OFFSET = 0 THEN
     3252    26441               %NEW_LAB( @ST$ = TARGET$ );
     3253    26477
     3254    26478
     3255    26479    2        INST_WORD = '0'O;
     3256    26480    2        MOD_KEY.KEY = 0;
     3257    26481
     3258    26482    2        IF SENDING$ = ADDR(NIL) THEN
     3259    26483    2          INST_WORD = BINBIT(BINARY_VALUE_OF_NIL,36);
     3260    26484             %IF CP6;
     3261    26485    2        ELSE IF SENDING$ = NIL_EPTR$ THEN
     3262    26486    2          INST_WORD = BINBIT(BINARY_VALUE_OF_NIL_EPTR,36);
     3263    26487             %ENDIF;
     3264    26488    2        ELSE
     3265    26489
     3266    26490    2          IF SENDING$ -> ST.ID = %DCB_ THEN
     3267    26491    2            MOD_KEY.B.WORD_REL = TRUE;
     3268    26492    2          ELSE
     3269    26493    3            DO;
     3270    26494    3              MOD_KEY.B.WORD_REL = TRUE;
     3271    26495    3              MOD_KEY.B.SEGID_REL_LOW = TRUE;
     3272    26496    3              MOD_KEY.B.RESOLVE_ADDRESS = %TRUE;
     3273    26497
     3274    26498                   /* Calculate the Byte/bit portion of the pointer */
     3275    26499    3              IF SENDING$ -> ST.TYPE = %TYD THEN
     3276    26500    4                DO;
     3277    26501    4                  INST_WORD.BDSC.C = SENDING$ -> ST.NDSC.CN / 2;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:127  
     3278    26502    4                  INST_WORD.BDSC.B = MOD(SENDING$ -> ST.NDSC.CN,2) * 5;
     3279    26503    4                END;
     3280    26504    3              ELSE
     3281    26505    3                INST_WORD.BDSC.C = SENDING$ -> ST.ADSC.CN;
     3282    26506
     3283    26507    3              IF (SENDING$ -> ST.ID = %CONST) AND
     3284    26508    3                  NOT SENDING$ -> CONST.B.ALLOCATED THEN
     3285    26509    4                DO;
     3286    26510    4                  SENDING$ -> CONST.B.ALLOCATED = TRUE;
     3287    26511    4                  SENDING$ -> CONST.ALLOC_LINK = CONST$;
     3288    26512    4                  CONST$ = SENDING$;
     3289    26513    4                END;
     3290    26514    3            END;
     3291    26515
     3292    26516             %NEW_WORD(@OU_WORD = INST_WORD,
     3293    26517                       @KEY = MOD_KEY.KEY,
     3294    26518                       @ST$ = SENDING$,
     3295    26519                       @OFFSET = CURRENT_SA,
     3296    26520                       @ADVANCE_BLOCK_SIZE=NO);
     3297    26567
     3298    26568    2        OLD_SA = CURRENT_SA;
     3299    26569
     3300    26570        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:128  
     3301    26571    2   CASE(%SCOPE);
     3302    26572        /*V*
     3303    26573                       SCOPE
     3304    26574               Issue an OBJ_SCOPE item if we are entering a new scope and
     3305    26575             the type is %PROGRAM_SCOPE. No action is needed for other types.
     3306    26576             Not all SCOPE ILL items indicate that we are entering a new
     3307    26577             scope.  The first scope comes from COMCOM.FIRST_PROC$.
     3308    26578        */
     3309    26579
     3310    26580    3        DO CASE(PILL -> SCOPE.CODE);
     3311    26581    3          CASE(%PROGRAM_SCOPE);
     3312    26582    3            IF PILL -> SCOPE.PROC$ ~= CURRENT_SCOPE$ THEN
     3313    26583    4              DO;
     3314    26584                     %NEW_SCOPE( @PROC$ = PILL -> SCOPE.PROC$ );
     3315    26620
     3316    26621    4                CURRENT_SCOPE$ = PILL -> SCOPE.PROC$;
     3317    26622    4                COMCOM.LOGICAL_BLOCK_CNT = COMCOM.LOGICAL_BLOCK_CNT + 1;
     3318    26623    4              END;
     3319    26624
     3320    26625    3            IF COMCOM.SEGMENT$(%PROC) ~= ROOT_PROC_BLOCK$ THEN
     3321    26626    4              DO;
     3322    26627    4                COMCOM.SEGMENT$ (%PROC) = ROOT_PROC_BLOCK$;
     3323    26628    4                CURRENT_BLOCK$ = ROOT_PROC_BLOCK$;
     3324    26629
     3325    26630                     %NEW_ORG (@ST$ = CURRENT_BLOCK$);
     3326    26666    4              END;
     3327    26667    3          CASE(%INIT_SCOPE, %DECLARATIVES_SCOPE);
     3328    26668                  /* NULL */
     3329    26669    3        END; /* Case */
     3330    26670
     3331    26671        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:129  
     3332    26672    2   CASE(%SEARCH);
     3333    26673
     3334    26674    3        DO CASE(CASE_PASS);
     3335    26675    3           CASE(%FIRST_PASS);
     3336    26676                    /* Was TABLEVAL specified */
     3337    26677    3               IF PILL -> SEARCH_.TABLEVAL = ADDR(NIL) THEN
     3338    26678    3                 PCOM.TABS = 1;
     3339    26679    3               ELSE
     3340    26680    4                 DO;
     3341    26681    4                   PCOM.TABS = 0;
     3342    26682    4                   PCOM.TOPND = PILL -> SEARCH_.TABLEVAL;
     3343    26683    4                 END;
     3344    26684
     3345    26685                    /* Was ALTRET specified */
     3346    26686    3               IF PILL -> SEARCH_.ALTRET_ = ADDR(NIL) THEN
     3347    26687    3                 PCOM.RABS = 1;
     3348    26688    3               ELSE
     3349    26689    4                 DO;
     3350    26690    4                   PCOM.RABS = 0;
     3351    26691    4                   PCOM.ROPND = PILL -> SEARCH_.ALTRET_;
     3352    26692    4                 END;
     3353    26693
     3354    26694    3           CASE(%SECOND_PASS);
     3355    26695
     3356    26696                    /* Y field of arg may need adjustment if table of
     3357    26697                       TCT instruction is to be put into .PROC. */
     3358    26698    3               IF PILL -> SEARCH_.ROP -> ETT.ID = %TRIAD THEN
     3359    26699    3                 PCOM.GABS = BITBIN('2000000'O);
     3360    26700
     3361    26701    3        END; /* CASE */
     3362    26702
     3363    26703        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:130  
     3364    26704    2   CASE(%SIZ, %REFMOD);  /*#28637*/
     3365    26705
     3366    26706    2        IF PILL -> ETT.ROP -> ETT.ID = %TRIAD AND
     3367    26707    2            PILL -> ETT.ROP -> ETT.LOP -> CONST.CONSTI.WORD1 < %#256K THEN
     3368    26708    2          CALL Z8HU$TAG(PILL -> ETT.ROP, FALSE);
     3369    26709    2        ELSE
     3370    26710    3          DO;
     3371    26711    3            REF$ = PILL -> ETT.LOP -> ETT.REF$;
     3372    26712
     3373    26713    3            CALL Z8HU$TAG(PILL -> ETT.ROP, REF$ -> REF.ST$ -> VARIABLE.B.GREATER_256K =
             26713                     TRUE);
     3374    26714    3          END;
     3375    26715
     3376    26716        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:131  
     3377    26717    2   CASE(%SSOP);
     3378    26718
     3379    26719    3    DO CASE(CASE_PASS);
     3380    26720    3      CASE(%FIRST_PASS);
     3381    26721    3        P$ = PILL -> ILL.ROP;
     3382    26722    4        DO WHILE P$ -> ETT.ID ~= %CVDI AND P$ -> ETT.ID < %FIRST_ST
     3383    26723    4            AND P$ -> ETT.STATE = 0;
     3384    26724    4          P$ = P$ -> ETT.LOP;
     3385    26725    4        END;
     3386    26726    3        IF P$ -> ETT.ID = %CVDI AND P$ -> ETT.STATE = 0 THEN
     3387    26727    3          CALL Z8HU$WALK (P$);
     3388    26728    3      CASE(%SECOND_PASS);
     3389    26729    3        REF$ = PILL -> ETT.REF$;
     3390    26730
     3391    26731    3        IF REF$ -> REF.PR_TAG$ ~= ADDR(NIL)
     3392    26732    3            AND (REF$ -> REF.SIGNED_SA >   %#16K
     3393    26733    3                 OR REF$ -> REF.SIGNED_SA < - %#16K) THEN
     3394    26734    4          DO;
     3395    26735    5            DO CASE(PILL -> ETT.LOP -> ETT.OFFSET.TYPE);
     3396    26736    5              CASE(%NUMERIC4, %ALPHA4);
     3397    26737    5                MKCN.CON = (REF$ -> REF.SIGNED_SA) * 8;
     3398    26738
     3399    26739    5              CASE(%ALPHA6);
     3400    26740    5                MKCN.CON = (REF$ -> REF.SIGNED_SA) * 6;
     3401    26741
     3402    26742    5              CASE(%NUMERIC9, %ALPHA9);
     3403    26743    5                MKCN.CON = (REF$ -> REF.SIGNED_SA) * 4;
     3404    26744
     3405    26745    5              CASE(%WORD_);
     3406    26746    5                MKCN.CON = REF$ -> REF.SIGNED_SA;
     3407    26747    5            END /* Case */;
     3408    26748
     3409    26749    4            CALL Z8AC$MAKE_CONST(NODE$);
     3410    26750    4            CALL Z8AF$FORME(%ADI, PILL -> ETT.ROP, NODE$, P$);
     3411    26751
     3412    26752    4            REF$ -> REF.SSOP_TAG$ = P$;
     3413    26753    4            P$ -> ETT.COUNT = PILL -> ETT.COUNT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:132  
     3414    26754    4            REF$ -> REF.SA = 0;
     3415    26755
     3416    26756    4            CALL Z8HU$TAG(P$, REF$ -> REF.ST$ -> VARIABLE.B.GREATER_256K = TRUE);
     3417    26757
     3418    26758    4            CALL Z8HU$DEC_COUNT(PILL -> ETT.ROP, (PILL -> ETT.COUNT -1));
     3419    26759    4          END;
     3420    26760    3        ELSE
     3421    26761    3          CALL Z8HU$TAG(PILL -> ETT.ROP, REF$ -> REF.ST$ -> VARIABLE.B.GREATER_256K =
             26761                   TRUE);
     3422    26762    3    END; /* CASE */
     3423    26763
     3424    26764        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:133  
     3425    26765    2   CASE(%SUB_ENTRY,%SUB_END);
     3426    26766
     3427    26767    2        PCOM.DABS = BITBIN(PILL->ILL.LOP->PARA.B.PFORM_NESTED);
     3428    26768
     3429    26769        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:134  
     3430    26770    2   CASE(%USER_CALL);
     3431    26771
     3432    26772    2        ARGLIST$ = PILL -> ETT.LOP;
     3433    26773    2        NUMBER_OF_ARGS = ARGLIST$ -> LTS.N - 1;
     3434    26774
     3435    26775    3        DO CASE(CASE_PASS);
     3436    26776    3          CASE(%FIRST_PASS);
     3437    26777
     3438    26778    3            PCOM.OABS = 0;
     3439    26779
     3440    26780    3            PCOM.DABS = NUMBER_OF_ARGS;
     3441    26781
     3442    26782    3            IF PILL -> USER_CALL.ALTRET$ = ADDR(NIL) THEN
     3443    26783    3              PCOM.EABS = 0;
     3444    26784    3            ELSE
     3445    26785    3              PCOM.EABS = 1;
     3446    26786
     3447    26787
     3448    26788    3            IF NUMBER_OF_ARGS = 0 THEN
     3449    26789    3              PCOM.WABS = 0;
     3450    26790    3            ELSE
     3451    26791    3              PCOM.WABS = 1;
     3452    26792
     3453    26793    3          CASE(%SECOND_PASS);
     3454    26794    4            DO I = 0 TO NUMBER_OF_ARGS - 1;
     3455    26795    4              CALL Z8HU$DEC_COUNT(ARGLIST$ -> ARGLIST.ARG$(I),1);
     3456    26796    4            END;
     3457    26797
     3458    26798    3        END /* Case */;
     3459    26799        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:135  
     3460    26800    2   CASE(%USE_END);
     3461    26801
     3462    26802    2        PCOM.YOPND = USE_PROC_RETURN;
     3463    26803    2        PCOM.NABS = PILL -> ILL.CODE;
     3464    26804    2        IF PCOM.NABS >= %USE_GLOBAL THEN /* GLOBAL */
     3465    26805    3          DO;
     3466    26806    3            PCOM.NABS = PCOM.NABS - %USE_GLOBAL;
     3467    26807    3            IF PILL -> ILL.LOP -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.
             26807                     EXIT_PROG_IN_DECL THEN
     3468    26808    3              PCOM.DABS = 1;
     3469    26809    3            ELSE
     3470    26810    3              PCOM.DABS = 0;
     3471    26811    3          END;
     3472    26812    2        ELSE
     3473    26813    2          PCOM.DABS = 0;
     3474    26814
     3475    26815             %IF GCOS;
     3476    26816 C           CURRENT_ENTRY$ = PREV_ENTRY$;
     3477    26817 C
     3478    26818 C
     3479    26819 C           P2$ = PILL -> ILL.LOP ;
     3480    26820 C           IF P2$ ~= ADDR(NIL)  THEN
     3481    26821 C             P2$ = P2$ -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.P2_SAVE$;
     3482    26822 C
     3483    26823 C           IF P2$ ~= ADDR(NIL)  THEN
     3484    26824 C             DO;
     3485    26825 C               PCOM.BABS = %STACK_HEADER_SIZE + %#16K;
     3486    26826 C               PCOM.CABS = 1;
     3487    26827 C               PCOM.JOPND = P2$;
     3488    26828 C               PCOM.MABS = ((NUMBER_OF_ARGS / 2) + 1) / 2;  /* REMOVE DESC & EVEN */
     3489    26829 C             END;
     3490    26830 C           ELSE
     3491    26831 C             PCOM.CABS = 0;
     3492    26832             %ENDIF;
     3493    26833             %IF CP6;
     3494    26834    2        IF DML_IA$ = ADDR (NIL) THEN
     3495    26835    2          PCOM.RABS = 0; /* Report writer USE proc */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:136  
     3496    26836    2        ELSE
     3497    26837    3          DO;
     3498    26838    3            PCOM.RABS = 1; /* DML USE proc */
     3499    26839    3            PCOM.ROPND = DML_IA$;
     3500    26840    3          END;
     3501    26841             %ENDIF;
     3502    26842
     3503    26843    2   CASE(%USE_ENTRY);
     3504    26844
     3505    26845             %IF GCOS;
     3506    26846 C           DO CASE( CASE_PASS );
     3507    26847 C
     3508    26848 C             CASE( %FIRST_PASS );
     3509    26849                 %ENDIF;
     3510    26850    2            PCOM.NABS = PILL -> ILL.CODE;
     3511    26851    2            IF PCOM.NABS >= %USE_GLOBAL THEN /* GLOBAL */
     3512    26852    3              DO;
     3513    26853    3                PCOM.NABS = PCOM.NABS - %USE_GLOBAL;
     3514    26854    3                IF PILL -> ILL.LOP -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.
             26854                         EXIT_PROG_IN_DECL THEN
     3515    26855    4                  DO;
     3516    26856    4                    PCOM.DABS = 1;
     3517    26857    4                    PCOM.POPND = PILL -> ENTRY_ILL.EXIT_PROG$;
     3518    26858    4                  END;
     3519    26859    3                ELSE
     3520    26860    3                  PCOM.DABS = 0;
     3521    26861    3              END;
     3522    26862    2            ELSE
     3523    26863    3              DO;
     3524    26864    3                IF PCOM.NABS = %INIT_PROC
     3525    26865    3                  THEN PCOM.NABS = %USE_PROC;
     3526    26866    3                PCOM.DABS = 0;
     3527    26867    3              END;
     3528    26868                 %IF CP6;
     3529    26869    2            IF PILL -> ILL.ROPCON = 0 THEN
     3530    26870    3              DO;
     3531    26871    3                PCOM.RABS = 0; /* Report writer USE proc */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:137  
     3532    26872    3                DML_IA$ = ADDR (NIL);
     3533    26873    3              END;
     3534    26874    2            ELSE
     3535    26875    3              DO;
     3536    26876    3                PCOM.RABS = 1; /* DML USE proc */
     3537    26877    3                DML_IA$ = PILL -> ILL.ROP;
     3538    26878    3              END;
     3539    26879                 %ENDIF;
     3540    26880                 %IF GCOS;
     3541    26881 C               PCOM.ZOPND = COMCOM.ESC -> ETT.LOP;
     3542    26882 C               PCOM.HABS = COMCOM.ESC -> ETT.ROPCON;
     3543    26883 C               IF COMCOM.OB.MS_DATA   THEN
     3544    26884 C                 PCOM.TABS = 0;
     3545    26885 C               ELSE
     3546    26886 C                 PCOM.TABS = 1;
     3547    26887 C
     3548    26888 C               PREV_ENTRY$ = CURRENT_ENTRY$;
     3549    26889 C               CURRENT_ENTRY$ = PILL;
     3550    26890 C
     3551    26891 C             CASE( %SECOND_PASS );
     3552    26892 C
     3553    26893 C               P2$ = PILL -> ILL.LOP ;
     3554    26894 C               IF P2$ ~= ADDR(NIL) THEN
     3555    26895 C                 P2$ = P2$ -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.P2_SAVE$;
     3556    26896 C
     3557    26897 C               IF P2$ ~= ADDR(NIL)   THEN
     3558    26898 C                 DO;
     3559    26899 C                   PCOM.BABS = %STACK_HEADER_SIZE + %#16K;
     3560    26900 C                   PCOM.CABS = 1;
     3561    26901 C                   PCOM.JOPND = P2$;
     3562    26902 C                   PCOM.PABS = PILL -> ILL.LOP -> SYMDEF_.PROC$ -> PROC_.B.ARG_COUNT;
     3563    26903 C                   PCOM.PABS = (PCOM.PABS + 1) / 2;      /* LDAQ  &  STAQ */
     3564    26904 C                 END;
     3565    26905 C               ELSE
     3566    26906 C                 PCOM.CABS = 0;
     3567    26907                 %ENDIF;
     3568    26908    2            CALL RESTORE_GLOBAL_REGISTERS;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:138  
     3569    26909
     3570    26910    2            USE_PROC_RETURN = PCOM.YOPND;
     3571    26911
     3572    26912               %IF GCOS;
     3573    26913 C             CASE( %THIRD_PASS, %FOURTH_PASS );
     3574    26914 C
     3575    26915 C               CALL RESTORE_GLOBAL_REGISTERS;
     3576    26916 C
     3577    26917 C           END; /* CASE_PASS */
     3578    26918             %ENDIF;
     3579    26919
     3580    26920        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:139  
     3581    26921    2   CASE(ELSE);
     3582    26922    2       CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);
     3583    26923        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:140  
     3584    26924    2   END /* Case */;
     3585    26925        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:141  
     3586    26926    1   ALPHANUMERIC_PRESET:PROC(TARGET_LENGTH);
     3587    26927        /*I*
     3588    26928             NAME: ALPHANUMERIC_PRESET
     3589    26929             PURPOSE:
     3590    26930                  Alphanumeric preset.
     3591    26931             CALL:
     3592    26932                  CALL ALPHANUMERIC_PRESET (TARGET_LENGTH);
     3593    26933             PARAMETERS:
     3594    26934                  TARGET_LENGTH - Length in characters of the receiving guy.
     3595    26935             DESCRIPTION:
     3596    26936                  Move one character at a time into the receiving guy.
     3597    26937                  When a word is full, call FLUSH.  If the receiving
     3598    26938                  guy is shorter than the sending guy, then truncate.
     3599    26939                  If the receiving guy is longer than the sending guy
     3600    26940                  and the ALL bit in the sending guy is set, then
     3601    26941                  move as many copies of the sending item in as will fit,
     3602    26942                  maybe with truncation of the last one moved in.  If
     3603    26943                  the receiving guy is shorter and no ALL bit is set
     3604    26944                  then blank fill.
     3605    26945        */
     3606    26946
     3607    26947    2        DCL TARGET_LENGTH       SBIN WORD;
     3608    26948
     3609    26949    2        TOTAL_MOVED = 0;
     3610    26950    2        SOURCE      = 0;
     3611    26951
     3612    26952
     3613    26953    2        TARGET = TARGET$ -> VARIABLE.NDSC.CN / 2;
     3614    26954
     3615    26955    3   LP:  DO WHILE(TOTAL_MOVED < TARGET_LENGTH);
     3616    26956    3          IF SOURCE >= CONSTANT$ -> CONST.ADSC.N THEN
     3617    26957    3            IF CONSTANT$ -> CONST.B.ALL THEN
     3618    26958    3              SOURCE = 0;
     3619    26959    3            ELSE
     3620    26960    4              DO;
     3621    26961    5                DO WHILE(TARGET_LENGTH > TOTAL_MOVED);
     3622    26962    6                  DO CASE (TARGET$ -> SCALAR.TYPE);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:142  
     3623    26963    6                    CASE (%TYN);
     3624    26964    6                      SUBSTR(CHAR_BUFFER,TARGET,1) = %KANJI_SPACE ;
     3625    26965    6                    CASE (%TYA);
     3626    26966    6                      SUBSTR(CHAR_BUFFER,TARGET,1) = ' ';
     3627    26967    6                    CASE (%TYE);
     3628    26968    6                      SUBSTR(CHAR_BUFFER,TARGET,1) = BITASC ('100'O);
     3629    26969    6                  END;
     3630    26970
     3631    26971    5                  TARGET = TARGET + 1;
     3632    26972    5                  TOTAL_MOVED = TOTAL_MOVED + 1;
     3633    26973
     3634    26974    5                  IF TARGET = 4 THEN
     3635    26975    6                    DO;
     3636    26976    6                      CALL FLUSH_BUFFER(CURRENT_SA);
     3637    26977    6                      TARGET = 0;
     3638    26978    6                      CURRENT_SA = CURRENT_SA + 1;
     3639    26979    6                    END;
     3640    26980    5                END /* While */;
     3641    26981
     3642    26982    4                EXIT LP;
     3643    26983    4              END;
     3644    26984
     3645    26985    3          SUBSTR(CHAR_BUFFER,TARGET,1) = SUBSTR(STRING$ -> CHARS,SOURCE,1);
     3646    26986
     3647    26987    3          TOTAL_MOVED = TOTAL_MOVED + 1;
     3648    26988    3          SOURCE = SOURCE + 1;
     3649    26989    3          TARGET = TARGET + 1;
     3650    26990
     3651    26991    3          IF TARGET = 4 THEN
     3652    26992    4            DO;
     3653    26993    4              CALL FLUSH_BUFFER(CURRENT_SA);
     3654    26994    4              TARGET = 0;
     3655    26995    4              CURRENT_SA = CURRENT_SA + 1;
     3656    26996    4            END;
     3657    26997
     3658    26998    3        END /* While */;
     3659    26999
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:143  
     3660    27000    2        BITS_IN_BUFFER = TARGET * 9;
     3661    27001    2        OLD_SA = CURRENT_SA;
     3662    27002
     3663    27003
     3664    27004    2   END ALPHANUMERIC_PRESET;
     3665    27005        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:144  
     3666    27006    1   GBCD_PRESET:PROC(TARGET_LENGTH);
     3667    27007        /*I*
     3668    27008             NAME: GBCD_PRESET
     3669    27009             PURPOSE:
     3670    27010                  GBCD preset.
     3671    27011             CALL:
     3672    27012                  CALL GBCD_PRESET (TARGET_LENGTH);
     3673    27013             PARAMETERS:
     3674    27014                  TARGET_LENGTH - Length in characters of the receiving guy.
     3675    27015             DESCRIPTION:
     3676    27016                  Move one character at a time into the receiving guy.
     3677    27017                  When a word is full, call FLUSH.  If the receiving
     3678    27018                  guy is shorter than the sending guy, then truncate.
     3679    27019                  If the receiving guy is longer than the sending guy
     3680    27020                  and the ALL bit in the sending guy is set, then
     3681    27021                  move as many copies of the sending item in as will fit,
     3682    27022                  maybe with truncation of the last one moved in.  If
     3683    27023                  the receiving guy is shorter and no ALL bit is set
     3684    27024                  then blank fill.
     3685    27025        */
     3686    27026
     3687    27027    2        DCL TARGET_LENGTH       SBIN WORD;
     3688    27028
     3689    27029    2        TOTAL_MOVED = 0;
     3690    27030    2        SOURCE      = 0;
     3691    27031
     3692    27032    2        TARGET = TARGET$ -> VARIABLE.NDSC.CN;
     3693    27033
     3694    27034    3   LP:  DO WHILE(TOTAL_MOVED < TARGET_LENGTH);
     3695    27035    3          IF SOURCE >= CONSTANT$ -> CONST.ADSC.N THEN
     3696    27036    3            IF CONSTANT$ -> CONST.B.ALL THEN
     3697    27037    3              SOURCE = 0;
     3698    27038    3            ELSE
     3699    27039    4              DO;
     3700    27040    5                DO WHILE(TARGET_LENGTH > TOTAL_MOVED);
     3701    27041    5                  BCD_BUFFER(TARGET) = '20'O; /* BCD space */
     3702    27042
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:145  
     3703    27043    5                  TARGET = TARGET + 1;
     3704    27044    5                  TOTAL_MOVED = TOTAL_MOVED + 1;
     3705    27045
     3706    27046    5                  IF TARGET = 6 THEN
     3707    27047    6                    DO;
     3708    27048    6                      CALL FLUSH_BUFFER(CURRENT_SA);
     3709    27049    6                      TARGET = 0;
     3710    27050    6                      CURRENT_SA = CURRENT_SA + 1;
     3711    27051    6                    END;
     3712    27052    5                END /* While */;
     3713    27053
     3714    27054    4                EXIT LP;
     3715    27055    4              END;
     3716    27056
     3717    27057    3          BCD_BUFFER(TARGET) = STRING$ -> BCD$CHARS(SOURCE);
     3718    27058    3          TOTAL_MOVED = TOTAL_MOVED + 1;
     3719    27059    3          SOURCE = SOURCE + 1;
     3720    27060    3          TARGET = TARGET + 1;
     3721    27061
     3722    27062    3          IF TARGET = 6 THEN
     3723    27063    4            DO;
     3724    27064    4              CALL FLUSH_BUFFER(CURRENT_SA);
     3725    27065    4              TARGET = 0;
     3726    27066    4              CURRENT_SA = CURRENT_SA + 1;
     3727    27067    4            END;
     3728    27068
     3729    27069    3        END /* While */;
     3730    27070
     3731    27071    2        BITS_IN_BUFFER = TARGET * 6;
     3732    27072    2        OLD_SA = CURRENT_SA;
     3733    27073
     3734    27074    2   END GBCD_PRESET;
     3735    27075         %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:146  
     3736    27076    1   FLUSH_BUFFER:PROC(BUFFER_SA);
     3737    27077        /*I*
     3738    27078              NAME:  FLUSH_BUFFER
     3739    27079              PURPOSE:
     3740    27080                     CHECKS TO SEE IF THE BITS IS THE BUFFER ARE FROM
     3741    27081                     THE CURRENT BLOCK
     3742    27082              CALL:
     3743    27083                     CALL FLUSH_BUFFER (BUFFER_SA)
     3744    27084              PARAMETERS:
     3745    27085                     BUFFER_SA - LOCATION TO BE PRESET. IS PASSED TO FLUSH.
     3746    27086              DESCRIPTION:
     3747    27087                     CREATES NEW ORG WHEN NEEDED AND CALLS FLUSH
     3748    27088        */
     3749    27089
     3750    27090    2         DCL BUFFER_SA   PTR;
     3751    27091
     3752    27092    2         IF (FLUSH_BLK$ ~= CURRENT_BLOCK$) AND
     3753    27093    2                      (FLUSH_BLK$ ~= ADDR(NIL))  THEN
     3754    27094                %NEW_ORG ( @ST$ = FLUSH_BLK$);
     3755    27130
     3756    27131    2         CALL FLUSH(CONSTANT$,ADDR(CHAR_BUFFER),BUFFER_SA,1);
     3757    27132
     3758    27133    2         IF (FLUSH_BLK$ ~= CURRENT_BLOCK$) AND
     3759    27134    2                      (FLUSH_BLK$ ~= ADDR(NIL))  THEN
     3760    27135                %NEW_ORG ( @ST$ = CURRENT_BLOCK$);
     3761    27171
     3762    27172    2         FLUSH_BLK$ = ADDR(NIL);
     3763    27173    2         BUFFER = 0;
     3764    27174    2         BITS_IN_BUFFER = 0;
     3765    27175
     3766    27176    2   END FLUSH_BUFFER;
     3767    27177        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:147  
     3768    27178    1   FLUSH:PROC(CONSTANT$,STRING$,OFFSET,LENGTH);
     3769    27179        /*I*
     3770    27180             NAME: FLUSH
     3771    27181             PURPOSE:
     3772    27182                  Put preset words into the OBJ table.
     3773    27183             CALL:
     3774    27184                  CALL FLUSH (CONSTANT$, STRING$, OFFSET, LENGTH)
     3775    27185             PARAMETERS:
     3776    27186                  CONSTANT$ - ST item of constant from which item was preset
     3777    27187                  STRING$   - String containing words to be put into OBJ.
     3778    27188                  OFFSET    - Location to be preset.
     3779    27189                  LENGTH    - Length in words of item pointed to by STRING$.
     3780    27190             DESCRIPTION:
     3781    27191                  Created OBJ items one word at time for each word in buffer.
     3782    27192        */
     3783    27193
     3784    27194    2        DCL CONSTANT$   PTR;
     3785    27195    2        DCL STRING$  PTR;
     3786    27196    2        DCL OFFSET   SBIN WORD;
     3787    27197    2        DCL LENGTH   SBIN WORD;
     3788    27198    2        DCL I        SBIN WORD;
     3789    27199
     3790    27200    2        DCL 1 STRING ALIGNED BASED(STRING$),
     3791    27201    2               2 WORDS(0:%PAGE_SIZE) BIT(36) UNAL;
     3792    27202
     3793    27203
     3794    27204    3        DO I = 0 TO LENGTH - 1;
     3795    27205               %NEW_WORD( @OU_WORD = "STRING.WORDS(I)" ,
     3796    27206                          @OFFSET  = "OFFSET + I" ,
     3797    27207                          @ST$     = CONSTANT$ ,
     3798    27208                          @KEY     = MOD_KEY.KEY ,
     3799    27209                          @ADVANCE_BLOCK_SIZE=NO);
     3800    27256
     3801    27257    3          MOD_KEY.B.ETC = TRUE;
     3802    27258    3        END;
     3803    27259
     3804    27260
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:148  
     3805    27261
     3806    27262    2   END FLUSH;
     3807    27263        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:149  
     3808    27264        /*I*
     3809    27265             NAME: BUFFER_TOP_SSOPS_AND_SIZS
     3810    27266             PURPOSE:
     3811    27267                  To buffer all unevaluated SSOP and SIZ triads that are directly
     3812    27268                  below the ILL item (top SSOPs and SIZs of total tree).
     3813    27269             CALL:
     3814    27270                  CALL BUFFER_TOP_SSOPS_AND_SIZS(=triad);
     3815    27271             DATA:
     3816    27272                  P$
     3817    27273                       Used to protect the integrity of the passed parameter.
     3818    27274             DESCRIPTION:
     3819    27275                  Slide down the LOP of the sub-tree, collecting all of the
     3820    27276                  SSOP and SIZ triad addresses into SSOP_SIZ_BUFFER until a
     3821    27277                  non-SSOP or non-SIZ triad is encountered.
     3822    27278        */
     3823    27279    1   BUFFER_TOP_SSOPS_AND_SIZS:PROC(TRIAD);
     3824    27280
     3825    27281    2        DCL TRIAD PTR;
     3826    27282    2        DCL P$ PTR;
     3827    27283
     3828    27284    2        P$ = TRIAD;
     3829    27285
     3830    27286    3        DO WHILE (P$ -> ETT.ID = %SSOP  /*#28637*/
     3831    27287    3               OR P$ -> ETT.ID = %SIZ
     3832    27288    3               OR P$ -> ETT.ID = %REFMOD);
     3833    27289    3          IF P$ -> ETT.STATE = %UNEVAL_T THEN
     3834    27290    4            DO;
     3835    27291    4              SSOP_SIZ_BUFFER(SSOP_SIZ_IDX) = P$;
     3836    27292    4              SSOP_SIZ_IDX = SSOP_SIZ_IDX + 1;
     3837    27293    4            END;
     3838    27294    3          ELSE
     3839    27295    3            EXIT;
     3840    27296
     3841    27297    3          P$ = P$ -> ETT.LOP;
     3842    27298    3        END;
     3843    27299
     3844    27300    2   END BUFFER_TOP_SSOPS_AND_SIZS;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:150  
     3845    27301        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:151  
     3846    27302    1   LOAD_GLOBAL_REGISTERS: PROC;
     3847    27303        /*I*
     3848    27304             NAME: LOAD_GLOBAL_REGISTERS
     3849    27305             PURPOSE:
     3850    27306                  LOAD GLOBAL REGISTERS!
     3851    27307             CALL:
     3852    27308                   CALL LOAD_GLOBAL_REGISTERS;
     3853    27309             DATA:
     3854    27310                   COMCOM.ESC_LIST
     3855    27311             DESCRIPTION:
     3856    27312                   Load the registers and mark the registers that are
     3857    27313                   to be assigned global.
     3858    27314        */
     3859    27315
     3860    27316    2       DCL I SBIN WORD;
     3861    27317
     3862    27318            %EQU ESC_LIST_LENGTH = 4;
     3863    27319
     3864    27320    2       I = 0;
     3865    27321
     3866    27322    3       DO WHILE (I <= %ESC_LIST_LENGTH) AND
     3867    27323    3                           (COMCOM.ESC_LIST.ESC$(I) ~= ADDR(NIL));
     3868    27324    3         COMCOM.ESC_LIST.ESC$(I) -> ETT.COUNT = %DONT_MESS;
     3869    27325    3         COMCOM.ESC_LIST.ESC$(I) -> ETT.B.PR# = COMCOM.ESC_LIST.PR#(I) - %PR3;
     3870    27326    3         COMCOM.ESC_LIST.ESC$(I) -> ETT.B.OPTION = COMCOM.ESC_LIST.OPTION(I);
     3871    27327    3         COMCOM.ESC_LIST.ESC$(I) -> ETT.B.ESC_LIST = %TRUE;
     3872    27328    3         CALL Z8HI$BURST(COMCOM.ESC_LIST.ESC$(I),DEP.GDEP);
     3873    27329    3         I = I + 1;
     3874    27330    3       END;
     3875    27331
     3876    27332    2   END LOAD_GLOBAL_REGISTERS;
     3877    27333        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:152  
     3878    27334    1   RESTORE_GLOBAL_REGISTERS: PROC;
     3879    27335        /*I*
     3880    27336             NAME: RESTORE_GLOBAL_REGISTERS
     3881    27337             PURPOSE:
     3882    27338                  RESTORE GLOBAL REGISTERS!
     3883    27339             CALL:
     3884    27340                   CALL RESTORE_GLOBAL_REGISTERS;
     3885    27341             DATA:
     3886    27342                   COMCOM.ESC_LIST
     3887    27343             DESCRIPTION:
     3888    27344                   Step through COMCOM.ESC_LIST and restore the globally
     3889    27345                   assigned pointer registers.
     3890    27346        */
     3891    27347
     3892    27348    2       DCL I SBIN WORD;
     3893    27349
     3894    27350
     3895    27351    2       I = 0;
     3896    27352
     3897    27353    3       DO WHILE (I <= %ESC_LIST_LENGTH) AND
     3898    27354    3                (COMCOM.ESC_LIST.ESC$(I) ~= ADDR(NIL));
     3899    27355    3         IF COMCOM.ESC_LIST.ESC$(I) -> ETT.ID ~= %ARGP
     3900    27356              %IF GCOS;
     3901    27357 C            OR ((PILL -> ETT.ID ~= %USE_ENTRY
     3902    27358 C                 OR PILL -> ETT.CODE ~= %INIT_PROC)
     3903    27359 C                AND (PILL -> ETT.ID ~= %OS_CALL
     3904    27360 C                 OR PILL -> ETT.CODE ~= %OP_CLOSE_CANCEL)
     3905    27361 C            AND CURRENT_ENTRY$ -> ENTRY_ILL.LOP -> ST.ID = %SYMDEF_)
     3906    27362              %ENDIF;
     3907    27363    3         THEN
     3908    27364    3           CALL Z8HI$BURST(COMCOM.ESC_LIST.ESC$(I),DEP.HDEP);
     3909    27365    3         I = I + 1;
     3910    27366    3       END;
     3911    27367
     3912    27368    2   END RESTORE_GLOBAL_REGISTERS;
     3913    27369        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:153  
     3914    27370        /*-------------------*/
     3915    27371    1     FREE_REGISTER_CHECK: PROC (PILL);
     3916    27372        /*-------------------*/
     3917    27373        /*I*
     3918    27374            NAME: FREE_REGISTER_CHECK
     3919    27375            PURPOSE:
     3920    27376                 Check for group MOVE, etc., for possible register purge.
     3921    27377            CALL:
     3922    27378                 CALL FREE_REGISTER_CHECK (PILL);
     3923    27379            DESCRIPTION:
     3924    27380                 Check the LOP of the ILL item pointer to by PILL to see
     3925    27381                 if it is a group or part of REDEFINES or RENAMES. A POINTER
     3926    27382                 will not always have a non-null QLT$ but it will never
     3927    27383                 be associated with a redefinition or a renaming.
     3928    27384        */
     3929    27385    2        DCL PILL  PTR;  /* Pointer to ILL move item         */
     3930    27386    2        DCL SEND$ PTR; /* Pointer to sending operand */
     3931    27387    2        DCL REC$  PTR; /* Pointer to destination operand */
     3932    27388    2        DCL P$    PTR;  /* Pointer to LOP Symbol Table item */
     3933    27389    2        DCL N_OPNDS UBIN;
     3934    27390
     3935    27391    2        REC$ = PILL -> ILL.LOP;
     3936    27392    3        IF PILL -> ILL.ID ~= %MFILL THEN DO;
     3937    27393    3          SEND$ = PILL -> ILL.ROP;
     3938    27394    3          N_OPNDS = 2;
     3939    27395    3        END;
     3940    27396    2        ELSE N_OPNDS = 1;
     3941    27397    2        GOTO COMMON_REG_CHECK;
     3942    27398    2   FREE_REGISTER_CHECK_3: ENTRY (PILL);
     3943    27399    2        REC$ = PILL -> ILL.TO_;
     3944    27400    2        SEND$ = PILL -> ILL.LOP;
     3945    27401    2        N_OPNDS = 3;
     3946    27402    2   COMMON_REG_CHECK:
     3947    27403    2        CALL Z8AU$TYPE_DESCRIPTOR (REC$, TYPE_DESC);
     3948    27404             %FISH (TRIAD = REC$, RTN = P$);
     3949    27412    2        IF P$ -> VARIABLE.ID ~= %POINTER
     3950    27413    2         AND (NOT P$ -> VARIABLE.B.ELEMENTARY
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:154  
     3951    27414    2             OR P$ -> VARIABLE.TYPE ~= %TYD
     3952    27415    2             OR P$ -> VARIABLE.NDSC.TN = %NDSC9
     3953    27416    2             OR P$ -> VARIABLE.B.REDEF_SUB
     3954    27417    2             OR P$ -> VARIABLE.B.REDEF_OBJ
     3955    27418    2             OR P$ -> VARIABLE.QLT$ -> QLT.B.RENAMES)
     3956    27419    2         AND REC$ -> ETT.ID ~= %SSOP
     3957    27420    2         AND (REC$ -> ETT.ID ~= %SIZ
     3958    27421    2             OR REC$ -> ETT.LOP -> ETT.ID ~= %SSOP)
     3959    27422    2         AND (PILL -> ILL.ID = %MFILL
     3960    27423    2           OR N_OPNDS = 3
     3961    27424    2           OR REC$ -> ETT.STATE ~= SEND$ -> ETT.STATE
     3962    27425    2           OR REC$ -> ETT.STATE = %UNEVAL_T
     3963    27426    2           OR REC$ -> ETT.STATE = %REF_T) THEN
     3964    27427    3          DO;
     3965    27428    3            J = TYPE_DESC.DESC.SA * 8 + TYPE_DESC.DESC.NDSC.CN;
     3966    27429    3            IF PILL -> ILL.ID = %MVANO AND
     3967    27430    3                (PILL -> ILL.CODE = %MVANO_UPPER_TO_LOWER OR
     3968    27431    3                 PILL -> ILL.CODE = %MVANO_LOWER_TO_LOWER) AND
     3969    27432    3                TYPE_DESC.DESC.ADSC.CN = 0 THEN
     3970    27433    3              J = J + 4;
     3971    27434    3            IF P$ -> VARIABLE.B.CLASS = %CLASS_NUMERIC THEN
     3972    27435    4              DO;
     3973    27436    4                LOP_LEN = P$ -> VARIABLE.NDSC.N;
     3974    27437    4                IF P$ -> VARIABLE.TYPE = %TYC THEN
     3975    27438    4                  LOP_LEN = LOP_LEN * 4 / 3; /* Convert to digits */
     3976    27439    4                ELSE IF P$ -> VARIABLE.TYPE ~= %TYD OR
     3977    27440    4                    P$ -> VARIABLE.NDSC.TN = %NDSC9 THEN
     3978    27441    4                  LOP_LEN = LOP_LEN * 2; /* Convert to digits */
     3979    27442    4              END;
     3980    27443    3            ELSE
     3981    27444    4              DO;
     3982    27445                     %GET_ADSC_LEN (ST$ = P$, RTN = LOP_LEN);
     3983    27456    4                IF P$ -> VARIABLE.TYPE = %TYB THEN
     3984    27457    4                  LOP_LEN = LOP_LEN * 4 / 3; /* Convert to digits */
     3985    27458    4                ELSE
     3986    27459    4                  LOP_LEN = LOP_LEN * 2;
     3987    27460    4              END;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:155  
     3988    27461    3            IF P$ -> VARIABLE.B.LINKAGE THEN
     3989    27462    4              DO;
     3990    27463    4                QLT$ = P$ -> VARIABLE.QLT$;
     3991    27464    5                DO WHILE QLT$ -> QLT.LEVEL_NO > 1;
     3992    27465    5                  QLT$ = QLT$ -> QLT.FATHER;
     3993    27466    5                END; /* BASE_LTS pointer is in level 01 ST item */
     3994    27467                     %GET_LTS (@ID = %BASE_LTS, @ST$ = QLT$ -> QLT.ST$, @RETURN$ = LTS$$);
     3995    27510    4              END;
     3996    27511    4            DO I = %ARA TO %AREAQ;
     3997    27512    4              CALL FREE_REG_IF_NEED (P$, LOP_LEN, J, LTS$$, I);
     3998    27513    4            END;
     3999    27514    3          END;
     4000    27515
     4001    27516    2   END FREE_REGISTER_CHECK;
     4002    27517        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:156  
     4003    27518        /*----------------*/
     4004    27519    1     FREE_REG_IF_NEED: PROC (OPND$, LEN, ORG, BASE_LTS$, REGISTER);
     4005    27520        /*----------------*/
     4006    27521        /*I*
     4007    27522            NAME: FREE_REG_IF_NEED
     4008    27523            PURPOSE: Spoil a register if it contains a subfield of the
     4009    27524                     receiving field of a MOVE.
     4010    27525            DESCRIPTION: Check to find out if one of the definitions of a
     4011    27526                         register begins within range of the receiving field
     4012    27527                         of a MOVE. If so then delete that one definition.
     4013    27528        */
     4014    27529    2   DCL OPND$     PTR;
     4015    27530    2   DCL LEN       UBIN;
     4016    27531    2   DCL ORG       UBIN;
     4017    27532    2   DCL BASE_LTS$ PTR;
     4018    27533    2   DCL REGISTER  UBIN;
     4019    27534
     4020    27535    2   DCL PRIME$    PTR;
     4021    27536    2   DCL ST$$      PTR;
     4022    27537    2   DCL LTS$$     PTR;
     4023    27538    2   DCL ORG1      UBIN;
     4024    27539
     4025    27540    2       PRIME$ = RAT.PRIMES (REGISTER);
     4026    27541    3       DO WHILE PRIME$ ~= ADDR (NIL);
     4027    27542    3         NEXT$ = PRIME$ -> PRIME.NEXT;                        /*#42937*/
     4028    27543    3         IF PRIME$ -> PRIME.TRIAD -> ETT.ID <= %LAST_REFERENCE_TRIAD
     4029    27544    3             AND PRIME$ -> PRIME.TRIAD -> ETT.ID ~= %SSOP OR
     4030    27545    3                 PRIME$ -> PRIME.TRIAD -> ETT.ID = %CVT THEN
     4031    27546    4           DO;
     4032    27547    4             CALL Z8AU$TYPE_DESCRIPTOR (PRIME$ -> PRIME.TRIAD, TYPE_DESC);
     4033    27548                  %FISH (TRIAD = PRIME$ -> PRIME.TRIAD, RTN = ST$$);
     4034    27556    4   CHECK_PRIME:
     4035    27557    5               DO;
     4036    27558    5                 IF OPND$ -> VARIABLE.B.LINKAGE AND ST$$ -> VARIABLE.B.LINKAGE THEN
     4037    27559    6                   DO;
     4038    27560    6                     QLT$ = ST$$ -> VARIABLE.QLT$;
     4039    27561    7                     DO WHILE QLT$ -> QLT.LEVEL_NO > 1;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:157  
     4040    27562    7                       QLT$ = QLT$ -> QLT.FATHER;
     4041    27563    7                     END; /* BASE_LTS pointer is in level 01 ST item */
     4042    27564                          %GET_LTS (@ID = %BASE_LTS, @ST$ = QLT$ -> QLT.ST$, @RETURN$ =
             27564                              LTS$$);
     4043    27607    6                     IF BASE_LTS$ -> BASE_LTS.SEQ# ~= LTS$$ -> BASE_LTS.SEQ# THEN
     4044    27608    6                       EXIT CHECK_PRIME;
     4045    27609    6                   END;
     4046    27610    5                 ELSE IF OPND$ -> VARIABLE.B.LINKAGE OR ST$$ -> VARIABLE.B.LINKAGE THEN
     4047    27611    5                   EXIT CHECK_PRIME;
     4048    27612    5                 ELSE IF OPND$ -> VARIABLE.COUNT ~= ST$$ -> VARIABLE.COUNT THEN
     4049    27613    5                   EXIT CHECK_PRIME;
     4050    27614    5                 ORG1 = TYPE_DESC.DESC.SA * 8 + TYPE_DESC.DESC.NDSC.CN;
     4051    27615    5                 IF ORG1 >= ORG AND ORG1 < ORG + LEN THEN
     4052    27616    5                   CALL Z8HU$POOL_PRIME (PRIME$ -> PRIME.TRIAD);
     4053    27617    5               END; /* CHECK_PRIME */
     4054    27618    4             END;
     4055    27619    3         PRIME$ = NEXT$;                                      /*#42937*/
     4056    27620    3       END; /* WHILE PRIME$ ~= ADDR (NIL) */
     4057    27621    2   END FREE_REG_IF_NEED;
     4058    27622
     4059    27623    1   END Z8HC$SPECIAL_CASES;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:158  
--  Include file information  --

   Z8A_NOP_OPTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LIBRARY.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_OBJ.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8H_OPCODES.:Z8A6TOU  is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DESC.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8H_TEMP.:Z8A6TOU  is referenced.
   Z8H_PASSES.:Z8A6TOU  is referenced.
   Z8H_CODE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8H_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8H_RAT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8H_DEP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8H_SUPPORT.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
   Z8H_PCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8HC$SPECIAL_CASES.
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:159  

   Procedure Z8HC$SPECIAL_CASES requires 9685 words for executable code.
   Procedure Z8HC$SPECIAL_CASES requires 218 words of local(AUTO) storage.

    No errors detected in file Z8HC.:Z8A6TSI    .

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:160  

 Object Unit name= Z8HC$SPECIAL_CASES                         File name= Z8HC.:Z8A6TOU
 UTS= AUG 26 '97 07:51:48.40 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  ITERATION
    1  LblCom even  none     1      1  SUPP_DATA
    2   DCB   even  none     0      0  M$UC
    3  LblCom even  none     1      1  ILL$
    4  LblCom even  none     5      5  ILL_
    5  LblCom even  none     1      1  ETT$
    6  LblCom even  none     1      1  HEAD_ETT$
    7  LblCom even  none   512   1000  ETT_BUCKETS
    8  LblCom even  none     5      5  ETT_
    9  LblCom even  none     1      1  ST$
   10  LblCom even  none     5      5  ST_
   11  LblCom even  none    48     60  DEP
   12  LblCom even  none   112    160  RAT
   13  LblCom even  none     1      1  NUMBER_OF_PRIMES
   14  LblCom even  none     1      1  NUMBER_OF_TEMPS
   15  LblCom even  none     1      1  NUMBER_OF_REFS
   16  LblCom even  none     1      1  GENERATING_PTRS
   17  LblCom even  none     1      1  USE_PROC_RETURN
   18  LblCom even  none     1      1  CURRENT_SCOPE$
   19  LblCom even  none     1      1  HEAD_REF$
   20  LblCom even  none     1      1  HEAD_TEMP$
   21  LblCom even  none     1      1  CONST$
   22  LblCom even  none     1      1  HEAD_PRIMES$
   23  LblCom even  none     1      1  CUR_LOOP_LEVEL
   24  LblCom even  none     2      2  PEPD
   25   Data  even  none    31     37  Z8HC$SPECIAL_CASES
   26  LblCom even  none     1      1  CURRENT_BLOCK$
   27  LblCom even  none     1      1  ROOT_PROC_BLOCK$
   28  LblCom even  none     2      2  MKCN
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:161  
   29  LblCom even  none     1      1  OBJ$
   30  LblCom even  none     1      1  PAGING_OBJ
   31  LblCom even  none     1      1  OBJ_PAGE_COUNT
   32  LblCom even  none     1      1  OBJ_FINISHED
   33  LblCom even  none     1      1  OBJ_SEG_SIZE
   34  LblCom even  none     1      1  OBJ_TOP_NEW_SEG
   35  LblCom even  none     1      1  OBJ_LAST_REGULAR_PAGE
   36  LblCom even  none     5      5  OBJ_
   37  LblCom even  none     1      1  QLT$
   38  LblCom even  none     1      1  PREV_01_QLT$
   39  LblCom even  none     5      5  QLT_
   40  LblCom even  none     1      1  LTS$
   41  LblCom even  none     5      5  LTS_
   42  LblCom even  none     1      1  ILS$
   43  LblCom even  none     5      5  ILS_
   44  RoData even  UTS     16     20  Z8HC$SPECIAL_CASES
   45  LblCom even  none     4      4  MVPP
   46   Proc  even  none  9685  22725  Z8HC$SPECIAL_CASES
   47  RoData even  none    82    122  Z8HC$SPECIAL_CASES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    46      0   yes            yes      Std        3  Z8HC$SPECIAL_CASES
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:162  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
         yes           Std       4 Z8AC$MAKE_TYA_CONST
         yes           Std       1 Z8HU$POOL_PRIME
         yes           Std       4 Z9AU$MOVE_NUMERIC
         yes           Std       0 Z8HG$FREE_ALL_REGISTERS
         yes           Std       1 Z9HF$WRITE_OBJ_PAGE
         yes           Std       0 Z9HF$GET_OBJ_PAGE
         yes           Std       1 Z8HU$WALK
         yes           Std       2 Z8HU$DECCNT_WITHOUT_IMPL_REF
         yes           Std       2 Z8HU$DEC_COUNT
         yes           Std       2 Z8AU$TYPE_DESCRIPTOR
         yes           Std       2 Z8AU$LENGTH_ETT
         yes           Std       2 Z8HU$INCCNT
         yes           Std       3 Z8AH$NEW_DNT
         yes           Std       4 Z9AU$MOVE_C3_NUMERIC
         yes           Std       2 Z8HU$TAG
         yes           Std       1 Z8AR$RESERVER
         yes           Std       1 Z8HG$FREE_REGISTER
         yes           Std       4 Z8HU$ALLOT_TEMP
         yes           Std       4 Z9AU$MOVE_GBCD
 yes     yes           Std       1 Z8HG$SAVE
         yes           Std       1 Z8HU$POOL
         yes           Std       2 Z8HI$BURST
         yes           Std       4 Z8AF$FORME
         yes           Std       4 Z9AU$MOVE_EBCDIC
         yes           Std       1 Z8HU$FORCE_BOUNDARY
         yes           Std       1 Z8AC$MAKE_CONST
         yes           Std       2 Z8HG$USE_REGISTER
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:163  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    ILL_STEP                              COMCOM
r    OBJ_STEP                         r    LTS_STEP                         r    ILS_STEP_TABLE

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:164  


        1        1        /*M* Z8HC$SPECIAL_CASES - Code generation special case handler */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8             NAME: Z8HC$SPECIAL_CASES
        9        9             PURPOSE:
       10       10                  To provide the special case functions that cannot otherwise be
       11       11                  performed by existing pseudo-code directives.
       12       12             DESCRIPTION:
       13       13                  One big DO CASE, driven by the ID of the current triad (PILL).
       14       14                  Sometimes, more than one CASE directive must be interpreted
       15       15                  per ILL/ETT pseudo-code group.  For this reason, a CASE_PASS
       16       16                  must be maintained.
       17       17             REFERENCE:
       18       18                  Z8HD$DOCUMENT
       19       19        */
       20       20        /*F*
       21       21             NAME: Z8HC$SPECIAL_CASES
       22       22             PURPOSE:
       23       23                  To provide the special case functions that cannot otherwise be
       24       24                  performed by existing pseudo-code directives.
       25       25             DESCRIPTION:
       26       26                  Same as for *P* comment in Z8HC$SPECIAL_CASES
       27       27             REFERENCE:
       28       28                  Z8HD$DOCUMENT
       29       29        */
       30       30        /*D*
       31       31             NAME: Z8HC$SPECIAL_CASES
       32       32             CALL:
       33       33                  CALL Z8HC$SPECIAL_CASES(PILL, PCOM, CASE_PASS);
       34       34             PARAMETERS:
       35       35                  PILL     - Triad whose pseudo-code is now being processed.
       36       36
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:165  
       37       37                  PCOM     - Program communication variables:
       38       38
       39       39                                 AABS - ZABS   (SBIN WORD)
       40       40                                 EOPND- ZOPND  (PTR      )
       41       41
       42       42                             PCOM is automatic so that each recursion level
       43       43                             has its own fresh copy to work with.  This is
       44       44                             an improvement over COBOL-74, whose communication
       45       45                             variables are all static, and thus very vulnerable
       46       46                             to attack.
       47       47
       48       48                  CASE_PASS- It is sometimes necessary to enter this routine
       49       49                             more than once at the same interpretation level.
       50       50                             This just indicates which pass we're making.
       51       51
       52       52             INTERFACE:
       53       53                  Z8HU$WALK
       54       54                  Z8HI$BURST
       55       55                  Z8HU$DEC_COUNT
       56       56                  Z8HU$INCCNT
       57       57                  Z8HG$USE_REGISTER
       58       58                  Z8HG$FREE_REGISTER
       59       59                  Z8HG$FREE_ALL_REGISTERS
       60       60                  Z8HG$SAVE
       61       61                  Z8AE$ERROR
       62       62                  Z8AH$NEW_DNT
       63       63                  Z8AU$TYPE_DESCRIPTOR
       64       64                  Z8HU$POOL
       65       65                  Z8HU$POOL_PRIME
       66       66                  Z8HU$ALLOT_TEMP
       67       67                  Z8HU$FORCE_BOUNDARY
       68       68                  Z9AU$MOVE_NUMERIC
       69       69                  Z9AU$MOVE_C3_NUMERIC
       70       70                  Z9AU$MOVE_EBCDIC
       71       71                  Z9AU$MOVE_GBCD
       72       72                  Z8AC$MAKE_CONST
       73       73                  Z8AC$MAKE_TYA_CONST
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:166  
       74       74                  Z8AF$FORME
       75       75                  Z8AU$LENGTH_ETT
       76       76             ENVIRONMENT:
       77       77                  None.
       78       78             INPUT:
       79       79                  PILL
       80       80                      Points to current triad, the ID of which is used to drive
       81       81                      the selection process (DO CASE).
       82       82
       83       83                  PCOM
       84       84                      Automatic storage for Generator communication during a single
       85       85                      call to Z8HI$BURST. For example, the ADI triad has its own
       86       86                      fresh copy of communication variables; if ETT triads below this
       87       87                      ADI are evaluated, they too get their own copy, when the ADI is
       88       88                      returned to, its PCOM variables are intact. (This is an
       89       89                      improvement over COBOL74, whose communication variables are all
       90       90                      static, and very vulnerable to attack).
       91       91
       92       92                  CASE_PASS
       93       93                      Indicates the number of the CASE to be executed for this ILL/ETT
       94       94                      pseudo-code group.
       95       95             OUTPUT:
       96       96                  Some PCOM variables are changed.  But only those that are expected
       97       97                  to be changed in subsequent pseudo-code.
       98       98             SCRATCH:
       99       99                  Any variables that are not passed explicitly, or those that are in
      100      100                  PCOM.
      101      101             DESCRIPTION:
      102      102                  This routine handles *all* of the functions of the CASE
      103      103                  pseudo-code directive.  No PCOM variables are really *passed*
      104      104                  to this routine.  There are some assumptions made. For
      105      105                  example:
      106      106
      107      107                  consider the following hypothetical CASE directive:
      108      108
      109      109                         CASE    TABS,SABS,SOPND
      110      110
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:167  
      111      111                  the operand portion of the CASE directive is strictly
      112      112                  documentation. Thus, changing TABS to DABS will do nothing
      113      113                  to affect what PCOM variables are affected or *returned*
      114      114                  by Z8HC$SPECIAL_CASES.  References to TABS, SABS, and SOPND
      115      115                  are hard-coded into Z8HC$SPECIAL_CASES.
      116      116
      117      117                     The concept of what this thing does is very simple, it
      118      118                  sets up variables that the pseudo-code can later reference,
      119      119                  such as pointers to temps, or reducing a bunch of bits into
      120      120                  a code for use in a JMPDV directive.
      121      121        */
      122      122        /*N*   Future possibility - Currently, all PCOM variables affected
      123      123                    are hard-coded in Z8HC$SPECIAL_CASES. It would be
      124      124                    desirable to be able to change the pseudo_code CASE
      125      125                    directive to directly affect a give PCOM variable. The
      126      126                    reason that it is not done now, is because it would make
      127      127                    the CASE directive a variable length pseudo-code
      128      128                    directive.  At present, I am making an attempt to leave
      129      129                    the lengths either 1 to 2 words long.
      130      130         */
      131      131         %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:168  
      132      132        Z8HC$SPECIAL_CASES:PROC(PILL,PCOM,CASE_PASS);

    132 46 000000   000000 700200 xent  Z8HC$SPECIA* TSX0  ! X66_AUTO_3
        46 000001   000332 000003                    ZERO    218,3

      133      133
      134      134    1        DCL PILL PTR;
      135      135    1        DCL CASE_PASS SBIN WORD;
      136      136
      137      137
      138      138    1        DCL Z8HU$WALK ENTRY(1);
      139      139    1        DCL Z8HU$TAG ENTRY(2);
      140      140    1        DCL Z8HI$BURST ENTRY(2);
      141      141    1        DCL Z8HU$DEC_COUNT ENTRY(2);
      142      142    1        DCL Z8HU$DECCNT_WITHOUT_IMPL_REF ENTRY(2);
      143      143    1        DCL Z8HU$INCCNT ENTRY(2);
      144      144    1        DCL Z8HG$USE_REGISTER ENTRY(2);
      145      145    1        DCL Z8HG$FREE_REGISTER ENTRY(1);
      146      146    1        DCL Z8HG$SAVE ENTRY(1) ALTRET;
      147      147    1        DCL Z8HG$FREE_ALL_REGISTERS ENTRY;
      148      148    1        DCL Z8AE$ERROR ENTRY(12);
      149      149    1        DCL Z8AH$NEW_DNT ENTRY(3);
      150      150    1        DCL Z8AU$TYPE_DESCRIPTOR ENTRY(2);
      151      151    1        DCL Z8HU$POOL_PRIME ENTRY(1);
      152      152    1        DCL Z8HU$POOL ENTRY(1);
      153      153    1        DCL Z8HU$ALLOT_TEMP ENTRY(4);
      154      154    1        DCL Z8HU$FORCE_BOUNDARY ENTRY(1);
      155      155    1        DCL Z9AU$MOVE_NUMERIC ENTRY(4);
      156      156    1        DCL Z9AU$MOVE_EBCDIC ENTRY(4);
      157      157    1        DCL Z9AU$MOVE_GBCD ENTRY(4);
      158      158    1        DCL Z9AU$MOVE_C3_NUMERIC ENTRY(4);
      159      159    1        DCL Z8AC$MAKE_CONST ENTRY(1);
      160      160    1        DCL Z8AC$MAKE_TYA_CONST ENTRY(4);
      161      161    1        DCL Z8AF$FORME ENTRY(4);
      162      162    1        DCL Z8AU$LENGTH_ETT ENTRY(2);
      163      163
      164      164
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:169  
      165      165             %EQU PHASE = 4;
      166      166             %INCLUDE Z8A_DEFC;
      167      234             %INCLUDE Z8A_SUPP_MAC;
      168     2634             %INCLUDE Z8H_PCOM;
      169     2783             %INCLUDE Z8A_SYS_FILE;
      170     9058             %INCLUDE Z8A_ILL;
      171     9751             %INCLUDE Z8A_ETT;
      172    10052             %INCLUDE Z8A_TYPES;
      173    10226             %INCLUDE Z8A_ST;
      174    13885             %INCLUDE Z8H_SUPPORT;
      175    14333             %INCLUDE Z8H_DEP;
      176    14440             %INCLUDE Z8H_RAT;
      177    14531             %INCLUDE Z8H_EXT;
      178    14582             %INCLUDE Z8H_CODE;
      179    14712             %INCLUDE Z8H_PASSES;
      180    14724             %INCLUDE Z8H_TEMP;
      181    14772             %INCLUDE Z8A_DESC;
      182    14818             %INCLUDE Z8A_ERR_NUMS;
      183    15582             %INCLUDE Z8H_OPCODES;
      184    16085             %INCLUDE Z8A_COMCOM;
      185    16735             %INCLUDE Z8A_MKCN;
      186    16752             %INCLUDE Z8A_OBJ;
      187    17249             %INCLUDE Z8A_QLT;
      188    17355             %INCLUDE Z8A_LTS;
      189    19432             %INCLUDE Z8A_ILS;
      190    19541             %INCLUDE Z8A_LIBRARY;
      191    19755             %INCLUDE Z8A_NOP_OPTS;
      192    19778         %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:170  
      193    19779    1        DCL P$ PTR;
      194    19780    1        DCL I SBIN WORD;
      195    19781    1        DCL J SBIN WORD;
      196    19782    1        DCL K SBIN WORD;
      197    19783    1        DCL TEMP_CHAR CHAR (12);
      198    19784
      199    19785    1        DCL NODE_ID   UBIN WORD;
      200    19786    1        DCL REGISTER  UBIN WORD;
      201    19787
      202    19788    1        DCL NEXT$     PTR;
      203    19789    1        DCL PRIME$    PTR;
      204    19790
      205    19791    1        DCL LOP_LEN   SBIN WORD;
      206    19792    1        DCL ROP_LEN   SBIN WORD;
      207    19793    1        DCL LOP_REF$  PTR;
      208    19794    1        DCL ROP_REF$  PTR;
      209    19795
      210    19796
      211    19797    1        DCL SSOP_SIZ_BUFFER(0:3) PTR;
      212    19798    1        DCL SSOP_SIZ_IDX SBIN WORD;
      213    19799
      214    19800    1        DCL 1 TYPE_DESC ALIGNED,
      215    19801                   %TYPE_DESC;
      216    19835
      217    19836    1        DCL TAGS(0:8) SBIN WORD CONSTANT INIT(
      218    19837
      219    19838    1                   %(BITBIN('40'O)),     /* BYTE 0   */
      220    19839    1                   %(BITBIN('20'O)),     /* BYTE 1   */
      221    19840    1                   %(BITBIN('10'O)),     /* BYTE 2   */
      222    19841    1                   %(BITBIN('04'O)),     /* BYTE 3   */
      223    19842    1                   %(BITBIN('30'O)),     /* BYTES 1 & 2 */
      224    19843    1                   %(BITBIN('70'O)),     /* BYTES 0 - 2 */
      225    19844    1                   %(BITBIN('34'O)),     /* BYTES 1 - 3 */
      226    19845    1                   %(BITBIN('60'O)),     /* BYTES 0 & 1 */
      227    19846    1                   %(BITBIN('14'O)));    /* BYTES 2 & 3 */
      228    19847
      229    19848
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:171  
      230    19849        /* These declarations are for the MVAN ILL item only */
      231    19850
      232    19851    1        DCL ITERS       SBIN WORD;
      233    19852    1        DCL REMAIN      SBIN WORD;
      234    19853
      235    19854        /* end of dedicated declarations for MVAN */
      236    19855
      237    19856
      238    19857
      239    19858        /* Beginning of dedicated declarations for SSOP  */
      240    19859
      241    19860    1        DCL REF$      PTR;
      242    19861    1        DCL NODE$    PTR;
      243    19862
      244    19863        /* End of dedicated declarations for SSOP        */
      245    19864
      246    19865
      247    19866        /* Beginning of dedicated declarations for DISPL */
      248    19867
      249    19868    1        DCL ARGLIST$           PTR;
      250    19869    1        DCL NUMBER_OF_ARGS  SBIN WORD;
      251    19870
      252    19871        /* End of dedicated declarations for DISPL */
      253    19872
      254    19873        /* Beginning of dedicated declarations for DO3, DOEND */
      255    19874
      256    19875    1        DCL ZERO_WORD SBIN CONSTANT INIT (0);
      257    19876    1        DCL ZERO_PTR$ REDEF ZERO_WORD PTR;
      258    19877    1        DCL GLIST$ PTR;
      259    19878
      260    19879        /* End of dedicated declarations for DO3, DOEND */
      261    19880
      262    19881
      263    19882        /* Beginning of dedicated declarations for MVDO */
      264    19883
      265    19884    1        DCL WORDS_FOR_TEMP SBIN WORD;
      266    19885    1        DCL TEMP$          PTR;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:172  
      267    19886    1        DCL BOUNDS         SBIN WORD;
      268    19887
      269    19888    1        DCL LDAQ_OFFSET  SBIN WORD;
      270    19889    1        DCL MVN_OFFSET   SBIN WORD;
      271    19890    1        DCL LOP_SIGN     BIT(2) ALIGNED;
      272    19891
      273    19892    1        DCL ROP_SIGN     BIT(2) ALIGNED;
      274    19893
      275    19894        /* End of dedicated declarations for MVDO */
      276    19895
      277    19896        /* Beginning of dedicated declarations for PRESET and constant gen */
      278    19897
      279    19898    1        DCL LENGTH_IN_WORDS SBIN WORD;
      280    19899    1        DCL STRING$    PTR;
      281    19900    1        DCL TARGET$    PTR;
      282    19901    1        DCL CONSTANT$  PTR STATIC;
      283    19902    1        DCL OFFSET     SBIN WORD;
      284    19903    1        DCL TOTAL_MOVED SBIN WORD;
      285    19904    1        DCL SOURCE      SBIN WORD;
      286    19905    1        DCL TARGET      SBIN WORD STATIC INIT(0);
      287    19906    1        DCL TARGET_LENGTH  SBIN WORD;
      288    19907    1        DCL BITS_IN_BUFFER SBIN WORD STATIC INIT(0);
      289    19908    1        DCL BOTTOM_HALF  SBIN HALF;
      290    19909
      291    19910    1        DCL BUFFER  SBIN WORD STATIC INIT(0);
      292    19911    1        DCL CHAR_BUFFER REDEF BUFFER CHAR(4);
      293    19912    1        DCL BCD_BUFFER (0:5) REDEF BUFFER BIT (6);
      294    19913    1        DCL BCD$CHARS (0:63) BIT (6) BASED;
      295    19914    1        DCL FLUSH_BLK$  PTR STATIC INIT(ADDR(NIL));
      296    19915
      297    19916    1        DCL MVN_BUFFER(0:63) SBIN WORD;
      298    19917    1        DCL CURRENT_SA  SBIN WORD;
      299    19918    1        DCL OLD_SA      SBIN WORD STATIC INIT(0);
      300    19919    1        DCL GO_EXPR$    PTR;
      301    19920
      302    19921
      303    19922        /* End of dedicated declarations for PRESET and constant gen */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:173  
      304    19923
      305    19924         /* Beginning of constants used by PTR_SET */
      306    19925
      307    19926
      308    19927    1        DCL VALUE_OF_NIL PTR CONSTANT INIT(ADDR(NIL));
      309    19928    1        DCL BINARY_VALUE_OF_NIL REDEF VALUE_OF_NIL UBIN WORD;
      310    19929             %IF CP6;
      311    19930    1        DCL NIL_EPTR EPTR CONSTANT INIT(ENTADDR(NIL));
      312    19931    1        DCL BINARY_VALUE_OF_NIL_EPTR REDEF NIL_EPTR UBIN WORD;
      313    19932    1        DCL NIL_EPTR$ REDEF NIL_EPTR PTR;
      314    19933             %ENDIF;
      315    19934    1        DCL SENDING$ PTR;
      316    19935
      317    19936         /* End of constants used by PTR_SET */
      318    19937
      319    19938         /* Beginning of declarations for ENTRY */
      320    19939
      321    19940    1        DCL DEF$ PTR;
      322    19941    1        DCL AVOID_DEFLAB UBIN;
      323    19942             %EQU MAIN_ENTRY     = 0;
      324    19943             %EQU SUBENT_UNMANAGED = 1;
      325    19944             %EQU SUBENT_MANAGED   = 3;
      326    19945             %EQU ZERO_ARG         = 0;
      327    19946             %EQU ONE_ARG          = 1;
      328    19947             %EQU TWO_ARG          = 2;
      329    19948             %EQU THREE_ARG        = 3;
      330    19949
      331    19950    1        DCL OPTWRD UBIN WORD;
      332    19951    1        DCL OPTCONST$ PTR;
      333    19952
      334    19953             %IF GCOS;
      335    19954 C           DCL CURRENT_ENTRY$ PTR;
      336    19955 C           DCL PREV_ENTRY$ PTR;
      337    19956             %ENDIF;
      338    19957
      339    19958         /* End of declarations for ENTRY */
      340    19959
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:174  
      341    19960         %IF CP6;
      342    19961         /* Beginning of declarations for USE_ENTRY */
      343    19962
      344    19963    1        DCL DML_IA$ PTR STATIC;
      345    19964
      346    19965         /* End of declarations for USE_ENTRY */
      347    19966         %ENDIF;
      348    19967
      349    19968         /* Beginning of dedicated declarations for EVAL */
      350    19969
      351    19970    1        DCL EVAL$ PTR;
      352    19971
      353    19972         /* End of declarations for EVAL */
      354    19973
      355    19974         /* Beginning of dedicated declarations for CVDDD */
      356    19975
      357    19976    1        DCL CURRENCY_SIGN CHAR(1) ALIGNED;
      358    19977
      359    19978         /* End of declarations for CVDDD */
      360    19979
      361    19980         /* Beginning of dedicated declarations for USER_CALL */
      362    19981
      363    19982    1        DCL DEST_PROC$ PTR;
      364    19983
      365    19984         /* End of declarations for USER_CALL */
      366    19985
      367    19986    1      DCL  ARGP_LOP$       PTR;
      368    19987    1      DCL  LTS$$           PTR;
      369    19988    1      DCL  ST$$            PTR;
      370    19989    1      DCL  P2$             PTR;
      371    19990    1      DCL  POOL_LOP_ARGP   BOOLEAN STATIC;
      372    19991    1      DCL UPPER$       PTR;
      373    19992    1      DCL LOWER$       PTR;
      374    19993
      375    19994        %EQU LOP_ARGP_PR       = 0;
      376    19995        %EQU LOP_ARGP_NO_PR    = 1;
      377    19996        %EQU LOP_ST            = 2;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:175  
      378    19997        %EQU ROP_ADDR_PR       = 0;
      379    19998        %EQU ROP_ARGP_PR       = 3;
      380    19999        %EQU ROP_ARGP_NO_PR    = 6;
      381    20000        %EQU ROP_REGULAR_PR    = 9;
      382    20001        %EQU ROP_REGULAR_ARA   = 12;
      383    20002        %EQU ROP_REGULAR_ARQ   = 15;
      384    20003        %EQU ROP_REGULAR_ST    = 18;
      385    20004        %EQU LOP_ROP_ALIAS     = 21;
      386    20005
      387    20006        %EQU MVPP0     = 0;
      388    20007        %EQU MVPP1     = 1;
      389    20008        %EQU MVPP2     = 2;
      390    20009        %EQU MVPP3     = 3;
      391    20010        %EQU MVPPAA    = 4;
      392    20011        %EQU MVPPSQ    = 5;
      393    20012        %EQU MVPPSA    = 6;
      394    20013        %EQU MVPPSS    = 7;
      395    20014
      396    20015
      397    20016    1   DCL 1 MVPP EXT,
      398    20017    1         2 STAR$      PTR,
      399    20018    1         2 ACTION#    SBIN WORD,
      400    20019    1         2 LOP_ARGP$  PTR,
      401    20020    1         2 ROP_ARGP$  PTR;
      402    20021
      403    20022    1   DCL MVPP_VEC (0:%LOP_ROP_ALIAS) UBIN WORD STATIC
      404    20023    1     INIT(
      405    20024    1   %MVPP0, /* LOP_ARGP_PR       + ROP_ADDR_PR ,0 */
      406    20025    1   %MVPP2, /* LOP_ARGP_NO_PR    + ROP_ADDR_PR ,1 */
      407    20026    1   %MVPP2, /* LOP_ST            + ROP_ADDR_PR ,2 */
      408    20027    1   %MVPP1, /* LOP_ARGP_PR       + ROP_ARG_PR  ,3 */
      409    20028    1   %MVPP3, /* LOP_ARGP_NO_PR    + ROP_ARGP_PR ,4 */
      410    20029    1   %MVPP3, /* LOP_ST            + ROP_ARGP_PR ,5 */
      411    20030    1   %MVPP1, /* LOP_ARGP_PR    + ROP_ARGP_NO_PR ,6 */
      412    20031    1   %MVPPSS,/* LOP_ARGP_NO_PR + ROP_ARGP_NO_PR ,7 */
      413    20032    1   %MVPPSS,/* LOP_ST         + ROP_ARGP_NO_PR ,8 */
      414    20033    1   %MVPP1, /* LOP_ARGP_PR     + ROP_REGULAR_PR,9 */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:176  
      415    20034    1   %MVPP2, /* LOP_ARGP_NO_PR  + ROP_REGULAR_PR,10*/
      416    20035    1   %MVPP2, /* LOP_ST          + ROP_REGULAR_PR,11*/
      417    20036    1   %MVPP1, /* LOP_ARGP_PR    + ROP_REGULAR_ARA,12*/
      418    20037    1   %MVPPSA,/* LOP_ARGP_NO_PR + ROP_REGULAR_ARA,13*/
      419    20038    1   %MVPPSA,/* LOP_ST         + ROP_REGULAR_ARA,14*/
      420    20039    1   %MVPP1 ,/* LOP_ARGP_PR    + ROP_REGULAR_ARQ,15*/
      421    20040    1   %MVPPSQ,/* LOP_ARGP_NO_PR + ROP_REGULAR_ARQ,16*/
      422    20041    1   %MVPPSQ,/* LOP_ST         + ROP_REGULAR_ARQ,17*/
      423    20042    1   %MVPP1 ,/* LOP_ARGP_PR    + ROP_REGULAR_ST ,18*/
      424    20043    1   %MVPPSS,/* LOP_ARGP_NO_PR + ROP_REGULAR_ST ,19*/
      425    20044    1   %MVPPSS,/* LOP_ST         + ROP_REGULAR_ST ,20*/
      426    20045    1   %MVPPAA /* LOP_ROP_ALIAS                   ,21*/);
      427    20046
      428    20047        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:177  
      429    20048    2        DO CASE(PILL -> ETT.ID);

  20048 46 000002   200003 470500                    LDP0    @PILL,,AUTO
        46 000003   000000 471500                    LDP1    0,,PR0
        46 000004   100000 236100                    LDQ     0,,PR1
        46 000005   000022 772000                    QRL     18
        46 000006   000004 136007                    SBLQ    4,DL
        46 000007   000443 116007                    CMPQ    291,DL
        46 000010   000012 602006 46                 TNC     s:20048+8,QL
        46 000011   021303 710000 46                 TRA     s:26922
        46 000012   020571 710000 46                 TRA     s:26706
        46 000013   020641 710000 46                 TRA     s:26719
        46 000014   021303 710000 46                 TRA     s:26922
        46 000015   021303 710000 46                 TRA     s:26922
        46 000016   021303 710000 46                 TRA     s:26922
        46 000017   021303 710000 46                 TRA     s:26922
        46 000020   020571 710000 46                 TRA     s:26706
        46 000021   021303 710000 46                 TRA     s:26922
        46 000022   021303 710000 46                 TRA     s:26922
        46 000023   021303 710000 46                 TRA     s:26922
        46 000024   000607 710000 46                 TRA     s:20116
        46 000025   007402 710000 46                 TRA     s:23196
        46 000026   003157 710000 46                 TRA     s:21027
        46 000027   021303 710000 46                 TRA     s:26922
        46 000030   021303 710000 46                 TRA     s:26922
        46 000031   021303 710000 46                 TRA     s:26922
        46 000032   021303 710000 46                 TRA     s:26922
        46 000033   021303 710000 46                 TRA     s:26922
        46 000034   003134 710000 46                 TRA     s:21020
        46 000035   021303 710000 46                 TRA     s:26922
        46 000036   016026 710000 46                 TRA     s:25532
        46 000037   021303 710000 46                 TRA     s:26922
        46 000040   021303 710000 46                 TRA     s:26922
        46 000041   003131 710000 46                 TRA     s:21007
        46 000042   021303 710000 46                 TRA     s:26922
        46 000043   021303 710000 46                 TRA     s:26922
        46 000044   021303 710000 46                 TRA     s:26922
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:178  
        46 000045   005336 710000 46                 TRA     s:22168
        46 000046   021303 710000 46                 TRA     s:26922
        46 000047   021303 710000 46                 TRA     s:26922
        46 000050   021303 710000 46                 TRA     s:26922
        46 000051   021303 710000 46                 TRA     s:26922
        46 000052   021303 710000 46                 TRA     s:26922
        46 000053   021303 710000 46                 TRA     s:26922
        46 000054   021303 710000 46                 TRA     s:26922
        46 000055   021303 710000 46                 TRA     s:26922
        46 000056   021303 710000 46                 TRA     s:26922
        46 000057   021303 710000 46                 TRA     s:26922
        46 000060   011733 710000 46                 TRA     s:23901
        46 000061   021303 710000 46                 TRA     s:26922
        46 000062   021303 710000 46                 TRA     s:26922
        46 000063   021303 710000 46                 TRA     s:26922
        46 000064   021303 710000 46                 TRA     s:26922
        46 000065   021303 710000 46                 TRA     s:26922
        46 000066   011650 710000 46                 TRA     s:23885
        46 000067   021303 710000 46                 TRA     s:26922
        46 000070   021303 710000 46                 TRA     s:26922
        46 000071   021303 710000 46                 TRA     s:26922
        46 000072   021303 710000 46                 TRA     s:26922
        46 000073   021303 710000 46                 TRA     s:26922
        46 000074   021303 710000 46                 TRA     s:26922
        46 000075   021303 710000 46                 TRA     s:26922
        46 000076   021303 710000 46                 TRA     s:26922
        46 000077   021303 710000 46                 TRA     s:26922
        46 000100   021303 710000 46                 TRA     s:26922
        46 000101   021303 710000 46                 TRA     s:26922
        46 000102   003157 710000 46                 TRA     s:21027
        46 000103   021303 710000 46                 TRA     s:26922
        46 000104   010006 710000 46                 TRA     s:23513
        46 000105   010003 710000 46                 TRA     s:23510
        46 000106   021303 710000 46                 TRA     s:26922
        46 000107   021303 710000 46                 TRA     s:26922
        46 000110   021303 710000 46                 TRA     s:26922
        46 000111   021303 710000 46                 TRA     s:26922
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:179  
        46 000112   021303 710000 46                 TRA     s:26922
        46 000113   021303 710000 46                 TRA     s:26922
        46 000114   003131 710000 46                 TRA     s:21007
        46 000115   021303 710000 46                 TRA     s:26922
        46 000116   003076 710000 46                 TRA     s:20984
        46 000117   021303 710000 46                 TRA     s:26922
        46 000120   003131 710000 46                 TRA     s:21007
        46 000121   021303 710000 46                 TRA     s:26922
        46 000122   021303 710000 46                 TRA     s:26922
        46 000123   021303 710000 46                 TRA     s:26922
        46 000124   021303 710000 46                 TRA     s:26922
        46 000125   021303 710000 46                 TRA     s:26922
        46 000126   021303 710000 46                 TRA     s:26922
        46 000127   001603 710000 46                 TRA     s:20541
        46 000130   021303 710000 46                 TRA     s:26922
        46 000131   021303 710000 46                 TRA     s:26922
        46 000132   021303 710000 46                 TRA     s:26922
        46 000133   021303 710000 46                 TRA     s:26922
        46 000134   021303 710000 46                 TRA     s:26922
        46 000135   005535 710000 46                 TRA     s:22311
        46 000136   006270 710000 46                 TRA     s:22599
        46 000137   006251 710000 46                 TRA     s:22592
        46 000140   021303 710000 46                 TRA     s:26922
        46 000141   021303 710000 46                 TRA     s:26922
        46 000142   021303 710000 46                 TRA     s:26922
        46 000143   021303 710000 46                 TRA     s:26922
        46 000144   021303 710000 46                 TRA     s:26922
        46 000145   005316 710000 46                 TRA     s:22139
        46 000146   021303 710000 46                 TRA     s:26922
        46 000147   021303 710000 46                 TRA     s:26922
        46 000150   005276 710000 46                 TRA     s:22132
        46 000151   021303 710000 46                 TRA     s:26922
        46 000152   006307 710000 46                 TRA     s:22637
        46 000153   021303 710000 46                 TRA     s:26922
        46 000154   021303 710000 46                 TRA     s:26922
        46 000155   005535 710000 46                 TRA     s:22311
        46 000156   006251 710000 46                 TRA     s:22592
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:180  
        46 000157   006270 710000 46                 TRA     s:22599
        46 000160   011152 710000 46                 TRA     s:23655
        46 000161   021303 710000 46                 TRA     s:26922
        46 000162   021303 710000 46                 TRA     s:26922
        46 000163   021303 710000 46                 TRA     s:26922
        46 000164   021303 710000 46                 TRA     s:26922
        46 000165   021303 710000 46                 TRA     s:26922
        46 000166   021303 710000 46                 TRA     s:26922
        46 000167   011733 710000 46                 TRA     s:23901
        46 000170   021303 710000 46                 TRA     s:26922
        46 000171   000551 710000 46                 TRA     s:20092
        46 000172   000551 710000 46                 TRA     s:20092
        46 000173   000551 710000 46                 TRA     s:20092
        46 000174   000551 710000 46                 TRA     s:20092
        46 000175   000551 710000 46                 TRA     s:20092
        46 000176   003111 710000 46                 TRA     s:20992
        46 000177   007604 710000 46                 TRA     s:23365
        46 000200   021303 710000 46                 TRA     s:26922
        46 000201   021303 710000 46                 TRA     s:26922
        46 000202   021303 710000 46                 TRA     s:26922
        46 000203   021303 710000 46                 TRA     s:26922
        46 000204   021303 710000 46                 TRA     s:26922
        46 000205   021303 710000 46                 TRA     s:26922
        46 000206   021303 710000 46                 TRA     s:26922
        46 000207   021303 710000 46                 TRA     s:26922
        46 000210   021303 710000 46                 TRA     s:26922
        46 000211   021303 710000 46                 TRA     s:26922
        46 000212   021303 710000 46                 TRA     s:26922
        46 000213   021303 710000 46                 TRA     s:26922
        46 000214   021303 710000 46                 TRA     s:26922
        46 000215   021303 710000 46                 TRA     s:26922
        46 000216   021303 710000 46                 TRA     s:26922
        46 000217   021303 710000 46                 TRA     s:26922
        46 000220   021303 710000 46                 TRA     s:26922
        46 000221   021303 710000 46                 TRA     s:26922
        46 000222   021303 710000 46                 TRA     s:26922
        46 000223   021303 710000 46                 TRA     s:26922
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:181  
        46 000224   021303 710000 46                 TRA     s:26922
        46 000225   021303 710000 46                 TRA     s:26922
        46 000226   021303 710000 46                 TRA     s:26922
        46 000227   021303 710000 46                 TRA     s:26922
        46 000230   021303 710000 46                 TRA     s:26922
        46 000231   021303 710000 46                 TRA     s:26922
        46 000232   021303 710000 46                 TRA     s:26922
        46 000233   021303 710000 46                 TRA     s:26922
        46 000234   000455 710000 46                 TRA     s:20053
        46 000235   000455 710000 46                 TRA     s:20053
        46 000236   021303 710000 46                 TRA     s:26922
        46 000237   000455 710000 46                 TRA     s:20053
        46 000240   000455 710000 46                 TRA     s:20053
        46 000241   021303 710000 46                 TRA     s:26922
        46 000242   000455 710000 46                 TRA     s:20053
        46 000243   000455 710000 46                 TRA     s:20053
        46 000244   021303 710000 46                 TRA     s:26922
        46 000245   000455 710000 46                 TRA     s:20053
        46 000246   000455 710000 46                 TRA     s:20053
        46 000247   021303 710000 46                 TRA     s:26922
        46 000250   021303 710000 46                 TRA     s:26922
        46 000251   012236 710000 46                 TRA     s:24013
        46 000252   012236 710000 46                 TRA     s:24013
        46 000253   015004 710000 46                 TRA     s:25200
        46 000254   021303 710000 46                 TRA     s:26922
        46 000255   021303 710000 46                 TRA     s:26922
        46 000256   015004 710000 46                 TRA     s:25200
        46 000257   021303 710000 46                 TRA     s:26922
        46 000260   015004 710000 46                 TRA     s:25200
        46 000261   015011 710000 46                 TRA     s:25205
        46 000262   011774 710000 46                 TRA     s:23913
        46 000263   012020 710000 46                 TRA     s:23948
        46 000264   021303 710000 46                 TRA     s:26922
        46 000265   015026 710000 46                 TRA     s:25214
        46 000266   015140 710000 46                 TRA     s:25255
        46 000267   015140 710000 46                 TRA     s:25255
        46 000270   021303 710000 46                 TRA     s:26922
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:182  
        46 000271   012310 710000 46                 TRA     s:24034
        46 000272   014712 710000 46                 TRA     s:25169
        46 000273   014735 710000 46                 TRA     s:25177
        46 000274   021303 710000 46                 TRA     s:26922
        46 000275   021303 710000 46                 TRA     s:26922
        46 000276   011414 710000 46                 TRA     s:23779
        46 000277   021303 710000 46                 TRA     s:26922
        46 000300   021303 710000 46                 TRA     s:26922
        46 000301   021303 710000 46                 TRA     s:26922
        46 000302   016116 710000 46                 TRA     s:25592
        46 000303   015177 710000 46                 TRA     s:25271
        46 000304   021303 710000 46                 TRA     s:26922
        46 000305   021303 710000 46                 TRA     s:26922
        46 000306   021303 710000 46                 TRA     s:26922
        46 000307   021303 710000 46                 TRA     s:26922
        46 000310   021303 710000 46                 TRA     s:26922
        46 000311   021303 710000 46                 TRA     s:26922
        46 000312   021303 710000 46                 TRA     s:26922
        46 000313   021303 710000 46                 TRA     s:26922
        46 000314   021303 710000 46                 TRA     s:26922
        46 000315   021303 710000 46                 TRA     s:26922
        46 000316   021303 710000 46                 TRA     s:26922
        46 000317   021303 710000 46                 TRA     s:26922
        46 000320   021303 710000 46                 TRA     s:26922
        46 000321   021303 710000 46                 TRA     s:26922
        46 000322   021303 710000 46                 TRA     s:26922
        46 000323   021303 710000 46                 TRA     s:26922
        46 000324   021303 710000 46                 TRA     s:26922
        46 000325   014760 710000 46                 TRA     s:25186
        46 000326   014760 710000 46                 TRA     s:25186
        46 000327   000462 710000 46                 TRA     s:20057
        46 000330   000462 710000 46                 TRA     s:20057
        46 000331   000462 710000 46                 TRA     s:20057
        46 000332   000462 710000 46                 TRA     s:20057
        46 000333   000462 710000 46                 TRA     s:20057
        46 000334   000462 710000 46                 TRA     s:20057
        46 000335   000462 710000 46                 TRA     s:20057
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:183  
        46 000336   000462 710000 46                 TRA     s:20057
        46 000337   021303 710000 46                 TRA     s:26922
        46 000340   021303 710000 46                 TRA     s:26922
        46 000341   021303 710000 46                 TRA     s:26922
        46 000342   021303 710000 46                 TRA     s:26922
        46 000343   021303 710000 46                 TRA     s:26922
        46 000344   016341 710000 46                 TRA     s:25742
        46 000345   021303 710000 46                 TRA     s:26922
        46 000346   021303 710000 46                 TRA     s:26922
        46 000347   007734 710000 46                 TRA     s:23500
        46 000350   001020 710000 46                 TRA     s:20275
        46 000351   020167 710000 46                 TRA     s:26432
        46 000352   010026 710000 46                 TRA     s:23541
        46 000353   010026 710000 46                 TRA     s:23541
        46 000354   021307 710000 46                 TRA     s:26924
        46 000355   011322 710000 46                 TRA     s:23695
        46 000356   011146 710000 46                 TRA     s:23650
        46 000357   021303 710000 46                 TRA     s:26922
        46 000360   021303 710000 46                 TRA     s:26922
        46 000361   007112 710000 46                 TRA     s:23069
        46 000362   021303 710000 46                 TRA     s:26922
        46 000363   021303 710000 46                 TRA     s:26922
        46 000364   021303 710000 46                 TRA     s:26922
        46 000365   021074 710000 46                 TRA     s:26767
        46 000366   021074 710000 46                 TRA     s:26767
        46 000367   021303 710000 46                 TRA     s:26922
        46 000370   016034 710000 46                 TRA     s:25538
        46 000371   021103 710000 46                 TRA     s:26772
        46 000372   021226 710000 46                 TRA     s:26850
        46 000373   021165 710000 46                 TRA     s:26802
        46 000374   010012 710000 46                 TRA     s:23519
        46 000375   021303 710000 46                 TRA     s:26922
        46 000376   021303 710000 46                 TRA     s:26922
        46 000377   021303 710000 46                 TRA     s:26922
        46 000400   006321 710000 46                 TRA     s:22664
        46 000401   011332 710000 46                 TRA     s:23709
        46 000402   006640 710000 46                 TRA     s:22797
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:184  
        46 000403   006501 710000 46                 TRA     s:22717
        46 000404   006625 710000 46                 TRA     s:22773
        46 000405   006503 710000 46                 TRA     s:22732
        46 000406   006501 710000 46                 TRA     s:22717
        46 000407   006501 710000 46                 TRA     s:22717
        46 000410   014765 710000 46                 TRA     s:25191
        46 000411   006365 710000 46                 TRA     s:22690
        46 000412   021303 710000 46                 TRA     s:26922
        46 000413   021303 710000 46                 TRA     s:26922
        46 000414   021303 710000 46                 TRA     s:26922
        46 000415   021303 710000 46                 TRA     s:26922
        46 000416   021303 710000 46                 TRA     s:26922
        46 000417   021303 710000 46                 TRA     s:26922
        46 000420   021303 710000 46                 TRA     s:26922
        46 000421   020521 710000 46                 TRA     s:26674
        46 000422   016021 710000 46                 TRA     s:25527
        46 000423   015075 710000 46                 TRA     s:25236
        46 000424   012310 710000 46                 TRA     s:24034
        46 000425   015026 710000 46                 TRA     s:25214
        46 000426   016504 710000 46                 TRA     s:25868
        46 000427   016471 710000 46                 TRA     s:25858
        46 000430   016653 710000 46                 TRA     s:25955
        46 000431   015075 710000 46                 TRA     s:25236
        46 000432   000467 710000 46                 TRA     s:20062
        46 000433   000467 710000 46                 TRA     s:20062
        46 000434   000520 710000 46                 TRA     s:20077
        46 000435   000520 710000 46                 TRA     s:20077
        46 000436   000467 710000 46                 TRA     s:20062
        46 000437   000467 710000 46                 TRA     s:20062
        46 000440   000520 710000 46                 TRA     s:20077
        46 000441   000520 710000 46                 TRA     s:20077
        46 000442   000467 710000 46                 TRA     s:20062
        46 000443   000467 710000 46                 TRA     s:20062
        46 000444   000520 710000 46                 TRA     s:20077
        46 000445   000520 710000 46                 TRA     s:20077
        46 000446   000467 710000 46                 TRA     s:20062
        46 000447   000467 710000 46                 TRA     s:20062
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:185  
        46 000450   000520 710000 46                 TRA     s:20077
        46 000451   000520 710000 46                 TRA     s:20077
        46 000452   021303 710000 46                 TRA     s:26922
        46 000453   020410 710000 46                 TRA     s:26580
        46 000454   016162 710000 46                 TRA     s:25621

      430    20049
      431    20050        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:186  
      432    20051    2   CASE(%AD2D, %AD2DR, %DV2D, %DV2DR, %MP2D, %MP2DR, %SB2D, %SB2DR);

      433    20052
      434    20053    2        CALL FREE_REGISTER_CHECK (PILL);

  20053 46 000455   200003 236100                    LDQ     @PILL,,AUTO
        46 000456   200263 756100                    STQ     LOWER$+2,,AUTO
        46 000457   022152 701000 46                 TSX1    FREE_REGISTER_CHECK
        46 000460   000000 011000                    NOP     0
        46 000461   021307 710000 46                 TRA     s:26924

      435    20054
      436    20055    2   CASE(%AD3D, %AD3DR, %DV3D, %DV3DR, %MP3D, %MP3DR, %SB3D, %SB3DR);

      437    20056
      438    20057    2        CALL FREE_REGISTER_CHECK_3 (PILL);

  20057 46 000462   200003 236100                    LDQ     @PILL,,AUTO
        46 000463   200263 756100                    STQ     LOWER$+2,,AUTO
        46 000464   022173 701000 46                 TSX1    FREE_REGISTER_CHECK_3
        46 000465   000000 011000                    NOP     0
        46 000466   021307 710000 46                 TRA     s:26924

      439    20058
      440    20059        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:187  
      441    20060    2   CASE(%AD2O, %AD2OR, %DV2O, %DV2OR, %MP2O, %MP2OR, %SB2O, %SB2OR);

      442    20061
      443    20062    2        LOP_REF$ = PILL -> ILL.LOP -> ETT.REF$;

  20062 46 000467   100001 473500                    LDP3    1,,PR1
        46 000470   300003 236100                    LDQ     3,,PR3
        46 000471   200101 756100                    STQ     LOP_REF$,,AUTO

      444    20063
      445    20064    2        IF LOP_REF$ -> REF.NDSC.TN = %NDSC9 AND

  20064 46 000472   200101 474500                    LDP4    LOP_REF$,,AUTO
        46 000473   400001 236100                    LDQ     1,,PR4
        46 000474   040000 316007                    CANQ    16384,DL
        46 000475   000505 601000 46                 TNZ     s:20068
        46 000476   030000 376007                    ANQ     12288,DL
        46 000477   030000 116007                    CMPQ    12288,DL
        46 000500   000505 601000 46                 TNZ     s:20068

      446    20065    2           LOP_REF$ -> REF.NDSC.S = %NO_SIGN THEN
      447    20066    2          PCOM.EABS = 1;

  20066 46 000501   000001 235007                    LDA     1,DL
        46 000502   200004 475500                    LDP5    @PCOM,,AUTO
        46 000503   500004 755100                    STA     4,,PR5
        46 000504   000507 710000 46                 TRA     s:20070

      448    20067    2        ELSE
      449    20068    2          PCOM.EABS = 0;

  20068 46 000505   200004 475500                    LDP5    @PCOM,,AUTO
        46 000506   500004 450100                    STZ     4,,PR5

      450    20069
      451    20070    2        IF LOP_REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYF THEN

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:188  
  20070 46 000507   400005 471500                    LDP1    5,,PR4
        46 000510   100002 220100                    LDX0    2,,PR1
        46 000511   000013 100003                    CMPX0   11,DU
        46 000512   000515 601000 46                 TNZ     s:20073

      452    20071    2          PCOM.IABS = 0;

  20071 46 000513   500010 450100                    STZ     8,,PR5
        46 000514   021307 710000 46                 TRA     s:26924

      453    20072    2        ELSE
      454    20073    2          PCOM.IABS = 1;

  20073 46 000515   000001 235007                    LDA     1,DL
        46 000516   500010 755100                    STA     8,,PR5
        46 000517   021307 710000 46                 TRA     s:26924

      455    20074        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:189  
      456    20075    2   CASE(%AD3O, %AD3OR, %DV3O, %DV3OR, %MP3O, %MP3OR, %SB3O, %SB3OR);

      457    20076
      458    20077    2        LOP_REF$ = PILL -> TRINARY_ILL.TO_ -> ETT.REF$;

  20077 46 000520   100003 473500                    LDP3    3,,PR1
        46 000521   300003 236100                    LDQ     3,,PR3
        46 000522   200101 756100                    STQ     LOP_REF$,,AUTO

      459    20078
      460    20079    2        IF LOP_REF$ -> REF.NDSC.TN = %NDSC9 AND

  20079 46 000523   200101 474500                    LDP4    LOP_REF$,,AUTO
        46 000524   400001 236100                    LDQ     1,,PR4
        46 000525   040000 316007                    CANQ    16384,DL
        46 000526   000536 601000 46                 TNZ     s:20083
        46 000527   030000 376007                    ANQ     12288,DL
        46 000530   030000 116007                    CMPQ    12288,DL
        46 000531   000536 601000 46                 TNZ     s:20083

      461    20080    2           LOP_REF$ -> REF.NDSC.S = %NO_SIGN THEN
      462    20081    2          PCOM.EABS = 1;

  20081 46 000532   000001 235007                    LDA     1,DL
        46 000533   200004 475500                    LDP5    @PCOM,,AUTO
        46 000534   500004 755100                    STA     4,,PR5
        46 000535   000540 710000 46                 TRA     s:20085

      463    20082    2        ELSE
      464    20083    2          PCOM.EABS = 0;

  20083 46 000536   200004 475500                    LDP5    @PCOM,,AUTO
        46 000537   500004 450100                    STZ     4,,PR5

      465    20084
      466    20085    2        IF LOP_REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYF THEN

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:190  
  20085 46 000540   400005 471500                    LDP1    5,,PR4
        46 000541   100002 220100                    LDX0    2,,PR1
        46 000542   000013 100003                    CMPX0   11,DU
        46 000543   000546 601000 46                 TNZ     s:20088

      467    20086    2          PCOM.IABS = 0;

  20086 46 000544   500010 450100                    STZ     8,,PR5
        46 000545   021307 710000 46                 TRA     s:26924

      468    20087    2        ELSE
      469    20088    2          PCOM.IABS = 1;

  20088 46 000546   000001 235007                    LDA     1,DL
        46 000547   500010 755100                    STA     8,,PR5
        46 000550   021307 710000 46                 TRA     s:26924

      470    20089        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:191  
      471    20090    2   CASE(%ADO, %SBO, %DVO, %MPO, %DVOR);

      472    20091
      473    20092    2        ROP_REF$ = PILL -> ETT.ROP -> ETT.REF$;

  20092 46 000551   100002 473500                    LDP3    2,,PR1
        46 000552   300003 236100                    LDQ     3,,PR3
        46 000553   200102 756100                    STQ     ROP_REF$,,AUTO

      474    20093    2        LOP_REF$ = PILL -> ETT.LOP -> ETT.REF$;

  20093 46 000554   100001 474500                    LDP4    1,,PR1
        46 000555   400003 236100                    LDQ     3,,PR4
        46 000556   200101 756100                    STQ     LOP_REF$,,AUTO

      475    20094
      476    20095    2        PCOM.EABS = 0;

  20095 46 000557   200004 475500                    LDP5    @PCOM,,AUTO
        46 000560   500004 450100                    STZ     4,,PR5

      477    20096
      478    20097    2        IF (LOP_REF$ -> REF.NDSC.S = %NO_SIGN) AND

  20097 46 000561   200101 471500                    LDP1    LOP_REF$,,AUTO
        46 000562   100001 236100                    LDQ     1,,PR1
        46 000563   030000 376007                    ANQ     12288,DL
        46 000564   030000 116007                    CMPQ    12288,DL
        46 000565   000574 601000 46                 TNZ     s:20101
        46 000566   100001 236100                    LDQ     1,,PR1
        46 000567   040000 316007                    CANQ    16384,DL
        46 000570   000574 601000 46                 TNZ     s:20101

      479    20098    2           (LOP_REF$ -> REF.NDSC.TN = %NDSC9) THEN
      480    20099    2          PCOM.EABS = 1;

  20099 46 000571   000001 235007                    LDA     1,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:192  
        46 000572   500004 755100                    STA     4,,PR5
        46 000573   021307 710000 46                 TRA     s:26924

      481    20100    2        ELSE
      482    20101    2          IF (ROP_REF$ -> REF.NDSC.S = %NO_SIGN) AND

  20101 46 000574   200102 473500                    LDP3    ROP_REF$,,AUTO
        46 000575   300001 236100                    LDQ     1,,PR3
        46 000576   030000 376007                    ANQ     12288,DL
        46 000577   030000 116007                    CMPQ    12288,DL
        46 000600   021307 601000 46                 TNZ     s:26924
        46 000601   300001 236100                    LDQ     1,,PR3
        46 000602   040000 316007                    CANQ    16384,DL
        46 000603   021307 601000 46                 TNZ     s:26924

      483    20102    2             (ROP_REF$ -> REF.NDSC.TN = %NDSC9) THEN
      484    20103    2            PCOM.EABS = 2;

  20103 46 000604   000002 235007                    LDA     2,DL
        46 000605   500004 755100                    STA     4,,PR5
        46 000606   021307 710000 46                 TRA     s:26924

      485    20104
      486    20105        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:193  
      487    20106    2   CASE(%ARGP);

      488    20107        /*V*
      489    20108                ARGP
      490    20109
      491    20110                   An argp triad normally just generates a pointer load.
      492    20111                When referencing a parameter that has an offset within a
      493    20112                record greater than 16k, a EAX0 and a AWDX is needed in
      494    20113                addition to the LDP.
      495    20114        */
      496    20115
      497    20116    3      DO CASE ( CASE_PASS );

  20116 46 000607   200005 473500                    LDP3    @CASE_PASS,,AUTO
        46 000610   300000 235100                    LDA     0,,PR3
        46 000611   000002 115007                    CMPA    2,DL
        46 000612   000614 602005 46                 TNC     s:20116+5,AL
        46 000613   021307 710000 46                 TRA     s:26924
        46 000614   000616 710000 46                 TRA     s:20121
        46 000615   000621 710000 46                 TRA     s:20139

      498    20117
      499    20118    3        CASE( %FIRST_PASS );

      500    20119
      501    20120               %IF %USING_HALF_WORD_RELOCATION;
      502    20121    3            PCOM.JABS = %HALF_WORD_REL;

  20121 46 000616   200004 474500                    LDP4    @PCOM,,AUTO
        46 000617   400011 450100                    STZ     9,,PR4
        46 000620   021307 710000 46                 TRA     s:26924

      503    20122               %ELSE;
      504    20123 C
      505    20124 C               IF PILL -> ETT.B.ESC_LIST          THEN
      506    20125 C                 DO;
      507    20126 C                   PCOM.JABS = %ON_ESC_LIST;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:194  
      508    20127 C                   PCOM.CABS = PILL -> ETT.B.PR#;
      509    20128 C                   PCOM.BABS = PILL -> ETT.B.OPTION;
      510    20129 C                 END;
      511    20130 C               ELSE
      512    20131 C                 PCOM.JABS = %NOT_ON_ESC_LIST;
      513    20132 C
      514    20133 C               PCOM.GABS = %#16K + PILL -> ETT.REF$ -> REF.SA;
      515    20134 C
      516    20135               %ENDIF;
      517    20136
      518    20137    3        CASE( %SECOND_PASS );

      519    20138
      520    20139    3            IF PILL -> ETT.ESCINF.BLK# ~= 0     THEN

  20139 46 000621   100002 720100                    LXL0    2,,PR1
        46 000622   021307 600000 46                 TZE     s:26924

      521    20140    4              DO;

      522    20141
      523    20142                     /* Generate an EAX0 */
      524    20143    4                CALL Z8HG$FREE_REGISTER(%XR0);

  20143 46 000623   000002 630400 47                 EPPR0   2
        46 000624   000000 631400 47                 EPPR1   0
        46 000625   000000 701000 xent               TSX1    Z8HG$FREE_REGISTER
        46 000626   000000 011000                    NOP     0

      525    20144
      526    20145    4                INST_WORD = '0'O;

  20145 46 000627   200012 450100                    STZ     INST_WORD,,AUTO

      527    20146    4                INST_WORD.LOW.OP_CODE = %EAX0_OP + (%XR0 - 8);

  20146 46 000630   620000 236007                    LDQ     -57344,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:195  
        46 000631   200012 552110                    STBQ    INST_WORD,'10'O,AUTO

      528    20147    4                INST_WORD.SA = %#16K * PILL -> ETT.ESCINF.BLK#;

  20147 46 000632   200003 470500                    LDP0    @PILL,,AUTO
        46 000633   000000 471500                    LDP1    0,,PR0
        46 000634   100002 236100                    LDQ     2,,PR1
        46 000635   000016 736000                    QLS     14
        46 000636   000003 376000 47                 ANQ     3
        46 000637   000000 620006                    EAX0    0,QL
        46 000640   200012 740100                    STX0    INST_WORD,,AUTO

      529    20148
      530    20149    4                MOD_KEY.KEY = 0;

  20149 46 000641   000000 450000 25                 STZ     MOD_KEY

      531    20150    4                MOD_KEY.B.RESOLVE_ADDRESS = FALSE;

  20150 46 000642   000004 236000 47                 LDQ     4
        46 000643   000000 356000 25                 ANSQ    MOD_KEY

      532    20151
      533    20152                     %NEW_WORD(@OU_WORD = INST_WORD,
      534    20153                               @KEY = MOD_KEY.KEY);

  20172 46 000644   000002 236000 36                 LDQ     OBJ_+2
        46 000645   000004 036007                    ADLQ    4,DL
        46 000646   000003 116000 36                 CMPQ    OBJ_+3
        46 000647   000661 604000 46                 TMI     s:20178

  20174 46 000650   000000 234000 30                 SZN     PAGING_OBJ
        46 000651   000656 605000 46                 TPL     s:20176

  20175 46 000652   000006 630400 47                 EPPR0   6
        46 000653   000000 631400 47                 EPPR1   0
        46 000654   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:196  
        46 000655   000000 011000                    NOP     0

  20176 46 000656   000007 631400 47                 EPPR1   7
        46 000657   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 000660   000000 011000                    NOP     0

  20178 46 000661   000002 236000 36                 LDQ     OBJ_+2
        46 000662   000022 736000                    QLS     18
        46 000663   000001 036000 36                 ADLQ    OBJ_+1
        46 000664   000000 756000 29                 STQ     OBJ$

  20179 46 000665   000004 236007                    LDQ     4,DL
        46 000666   000002 056000 36                 ASQ     OBJ_+2

  20180 46 000667   001012 220003                    LDX0    522,DU
        46 000670   000000 470400 29                 LDP0    OBJ$
        46 000671   000000 740100                    STX0    0,,PR0

  20183 46 000672   000005 236000 47                 LDQ     5
        46 000673   000000 470400 29                 LDP0    OBJ$
        46 000674   000002 756100                    STQ     2,,PR0

  20184 46 000675   000000 471400 26                 LDP1    CURRENT_BLOCK$
        46 000676   100002 236100                    LDQ     2,,PR1
        46 000677   000022 772000                    QRL     18
        46 000700   000001 756100                    STQ     1,,PR0

  20185 46 000701   000000 236000 25                 LDQ     MOD_KEY
        46 000702   000011 736000                    QLS     9
        46 000703   000000 552110                    STBQ    0,'10'O,PR0

  20187 46 000704   200012 236100                    LDQ     INST_WORD,,AUTO
        46 000705   000000 470400 29                 LDP0    OBJ$
        46 000706   000003 756100                    STQ     3,,PR0

  20194 46 000707   000000 471400 26                 LDP1    CURRENT_BLOCK$
        46 000710   100002 221100                    LDX1    2,,PR1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:197  
        46 000711   000001 622011                    EAX2    1,X1
        46 000712   100002 742100                    STX2    2,,PR1

  20195 46 000713   000720 601000 46                 TNZ     s:20203

  20196 46 000714   000011 630400 47                 EPPR0   9
        46 000715   000000 631400 47                 EPPR1   0
        46 000716   000000 701000 xent               TSX1    Z8AE$ERROR
        46 000717   000000 011000                    NOP     0

      535    20200
      536    20201
      537    20202                     /* Generate AWDX using X0 */
      538    20203    4                INST_WORD = '0'O;

  20203 46 000720   200012 450100                    STZ     INST_WORD,,AUTO

      539    20204    4                INST_WORD.LOW.OP_CODE = %AWD_OP;

  20204 46 000721   507000 236007                    LDQ     -94720,DL
        46 000722   200012 552110                    STBQ    INST_WORD,'10'O,AUTO

      540    20205    4                INST_WORD.LOW.MF.TAG = %XR0;

  20205 46 000723   200012 236100                    LDQ     INST_WORD,,AUTO
        46 000724   000012 376000 47                 ANQ     10
        46 000725   000010 276007                    ORQ     8,DL
        46 000726   200012 756100                    STQ     INST_WORD,,AUTO

      541    20206    4                INST_WORD.Y.AR# = PILL -> ETT.STATE - 20;

  20206 46 000727   200003 470500                    LDP0    @PILL,,AUTO
        46 000730   000000 471500                    LDP1    0,,PR0
        46 000731   100004 236100                    LDQ     4,,PR1
        46 000732   000022 772000                    QRL     18
        46 000733   000024 136007                    SBLQ    20,DL
        46 000734   000041 736000                    QLS     33
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:198  
        46 000735   200012 676100                    ERQ     INST_WORD,,AUTO
        46 000736   700000 376003                    ANQ     -32768,DU
        46 000737   200012 656100                    ERSQ    INST_WORD,,AUTO

      542    20207    4                INST_WORD.LOW.MF.AR = TRUE;

  20207 46 000740   000100 236007                    LDQ     64,DL
        46 000741   200012 256100                    ORSQ    INST_WORD,,AUTO

      543    20208    4                INST_WORD.LOW.EIS = TRUE;

  20208 46 000742   000400 236007                    LDQ     256,DL
        46 000743   200012 256100                    ORSQ    INST_WORD,,AUTO

      544    20209
      545    20210                     %NEW_WORD(@OU_WORD = INST_WORD);

  20229 46 000744   000002 236000 36                 LDQ     OBJ_+2
        46 000745   000004 036007                    ADLQ    4,DL
        46 000746   000003 116000 36                 CMPQ    OBJ_+3
        46 000747   000761 604000 46                 TMI     s:20235

  20231 46 000750   000000 234000 30                 SZN     PAGING_OBJ
        46 000751   000756 605000 46                 TPL     s:20233

  20232 46 000752   000006 630400 47                 EPPR0   6
        46 000753   000000 631400 47                 EPPR1   0
        46 000754   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 000755   000000 011000                    NOP     0

  20233 46 000756   000007 631400 47                 EPPR1   7
        46 000757   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 000760   000000 011000                    NOP     0

  20235 46 000761   000002 236000 36                 LDQ     OBJ_+2
        46 000762   000022 736000                    QLS     18
        46 000763   000001 036000 36                 ADLQ    OBJ_+1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:199  
        46 000764   000000 756000 29                 STQ     OBJ$

  20236 46 000765   000004 236007                    LDQ     4,DL
        46 000766   000002 056000 36                 ASQ     OBJ_+2

  20237 46 000767   001012 220003                    LDX0    522,DU
        46 000770   000000 470400 29                 LDP0    OBJ$
        46 000771   000000 740100                    STX0    0,,PR0

  20240 46 000772   000005 236000 47                 LDQ     5
        46 000773   000000 470400 29                 LDP0    OBJ$
        46 000774   000002 756100                    STQ     2,,PR0

  20241 46 000775   000000 471400 26                 LDP1    CURRENT_BLOCK$
        46 000776   100002 236100                    LDQ     2,,PR1
        46 000777   000022 772000                    QRL     18
        46 001000   000001 756100                    STQ     1,,PR0

  20242 46 001001   000000 236003                    LDQ     0,DU
        46 001002   000000 552110                    STBQ    0,'10'O,PR0

  20244 46 001003   200012 236100                    LDQ     INST_WORD,,AUTO
        46 001004   000000 470400 29                 LDP0    OBJ$
        46 001005   000003 756100                    STQ     3,,PR0

  20251 46 001006   000000 471400 26                 LDP1    CURRENT_BLOCK$
        46 001007   100002 221100                    LDX1    2,,PR1
        46 001010   000001 622011                    EAX2    1,X1
        46 001011   100002 742100                    STX2    2,,PR1

  20252 46 001012   021307 601000 46                 TNZ     s:26924

  20253 46 001013   000011 630400 47                 EPPR0   9
        46 001014   000000 631400 47                 EPPR1   0
        46 001015   000000 701000 xent               TSX1    Z8AE$ERROR
        46 001016   000000 011000                    NOP     0

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:200  
      546    20257    4              END;

      547    20258
      548    20259    3      END;    /*  CASE  PASS  */

  20259 46 001017   021307 710000 46                 TRA     s:26924

      549    20260        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:201  
      550    20261    2   CASE(%CCOSU);

      551    20262        /*V*
      552    20263                      CCOSU
      553    20264
      554    20265             This case is entered only by CCOSU items that have the
      555    20266             CCOSU.B.VAL_FREEZE bit set.  The purpose is to store the
      556    20267             CCOSUed item in a temp so that all following references
      557    20268             to the ETT item will use the temp, not the potentially
      558    20269             redefined item under the ETT item.  Since only reference
      559    20270             triads can be over redefinable items, they are the only
      560    20271             ones that will be moved to temps; other ETT items will
      561    20272             always be temp contained or register contained anyway.
      562    20273        */
      563    20274
      564    20275    3        DO CASE(CASE_PASS);

  20275 46 001020   200005 473500                    LDP3    @CASE_PASS,,AUTO
        46 001021   300000 235100                    LDA     0,,PR3
        46 001022   000003 115007                    CMPA    3,DL
        46 001023   001025 602005 46                 TNC     s:20275+5,AL
        46 001024   021307 710000 46                 TRA     s:26924
        46 001025   001030 710000 46                 TRA     s:20278
        46 001026   001364 710000 46                 TRA     s:20415
        46 001027   001535 710000 46                 TRA     s:20506

      565    20276    3          CASE(%FIRST_PASS);

      566    20277
      567    20278    3            PCOM.ROPND = PILL -> CCOSU.EVEX;

  20278 46 001030   100004 236100                    LDQ     4,,PR1
        46 001031   200004 474500                    LDP4    @PCOM,,AUTO
        46 001032   400053 756100                    STQ     43,,PR4

      568    20279
      569    20280    3            IF PCOM.ROPND -> ETT.ID = %EVAL THEN
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:202  

  20280 46 001033   400053 471500                    LDP1    43,,PR4
        46 001034   100000 220100                    LDX0    0,,PR1
        46 001035   000171 100003                    CMPX0   121,DU
        46 001036   001044 601000 46                 TNZ     s:20283

      570    20281    3              NODE_ID = PCOM.ROPND -> ETT.LOP -> ETT.ID;

  20281 46 001037   100001 475500                    LDP5    1,,PR1
        46 001040   500000 236100                    LDQ     0,,PR5
        46 001041   000022 772000                    QRL     18
        46 001042   200073 756100                    STQ     NODE_ID,,AUTO
        46 001043   001047 710000 46                 TRA     s:20285

      571    20282    3            ELSE
      572    20283    3              NODE_ID = PCOM.ROPND -> ETT.ID;

  20283 46 001044   100000 236100                    LDQ     0,,PR1
        46 001045   000022 772000                    QRL     18
        46 001046   200073 756100                    STQ     NODE_ID,,AUTO

      573    20284
      574    20285    3            PCOM.ROPND -> ETT.COUNT = PILL -> CCOSU.CNTE;

  20285 46 001047   000000 475500                    LDP5    0,,PR0
        46 001050   500000 721100                    LXL1    0,,PR5
        46 001051   100000 441100                    SXL1    0,,PR1

      575    20286    3            CALL Z8HU$WALK(PCOM.ROPND);

  20286 46 001052   200004 236100                    LDQ     @PCOM,,AUTO
        46 001053   000053 036003                    ADLQ    43,DU
        46 001054   200302 756100                    STQ     ORG1+1,,AUTO
        46 001055   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 001056   000000 631400 47                 EPPR1   0
        46 001057   000000 701000 xent               TSX1    Z8HU$WALK
        46 001060   000000 011000                    NOP     0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:203  

      576    20287
      577    20288    3            IF PILL -> CCOSU.B.EVAL THEN

  20288 46 001061   200003 470500                    LDP0    @PILL,,AUTO
        46 001062   000000 471500                    LDP1    0,,PR0
        46 001063   100002 236100                    LDQ     2,,PR1
        46 001064   000004 316007                    CANQ    4,DL
        46 001065   001072 600000 46                 TZE     s:20291

      578    20289    3              PCOM.XABS = 1;

  20289 46 001066   000001 235007                    LDA     1,DL
        46 001067   200004 473500                    LDP3    @PCOM,,AUTO
        46 001070   300027 755100                    STA     23,,PR3
        46 001071   001074 710000 46                 TRA     s:20293

      579    20290    3            ELSE
      580    20291    3              PCOM.XABS = 0;

  20291 46 001072   200004 473500                    LDP3    @PCOM,,AUTO
        46 001073   300027 450100                    STZ     23,,PR3

      581    20292
      582    20293    3            PCOM.JABS = 0;

  20293 46 001074   300011 450100                    STZ     9,,PR3

      583    20294
      584    20295    3            IF NODE_ID <= %LAST_REFERENCE_TRIAD THEN

  20295 46 001075   200073 235100                    LDA     NODE_ID,,AUTO
        46 001076   000020 115007                    CMPA    16,DL
        46 001077   001337 603000 46                 TRC     s:20407

      585    20296    4              DO;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:204  
      586    20297                     /* DECCNT by (CNTE - 1) because there now will be
      587    20298                        only one implied reference to REF.XXX_TAG$  */
      588    20299    4                CALL Z8HU$DEC_COUNT(PCOM.ROPND, (PILL -> CCOSU.CNTE -1));

  20299 46 001100   000000 471500                    LDP1    0,,PR0
        46 001101   100000 236100                    LDQ     0,,PR1
        46 001102   000022 736000                    QLS     18
        46 001103   000022 732000                    QRS     18
        46 001104   000001 136007                    SBLQ    1,DL
        46 001105   200302 756100                    STQ     ORG1+1,,AUTO
        46 001106   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 001107   200305 451500                    STP1    ORG1+4,,AUTO
        46 001110   200004 236100                    LDQ     @PCOM,,AUTO
        46 001111   000053 036003                    ADLQ    43,DU
        46 001112   200304 756100                    STQ     ORG1+3,,AUTO
        46 001113   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 001114   000013 631400 47                 EPPR1   11
        46 001115   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 001116   000000 011000                    NOP     0

      589    20300
      590    20301    4                CALL Z8AU$TYPE_DESCRIPTOR(PCOM.ROPND, TYPE_DESC);

  20301 46 001117   200110 630500                    EPPR0   TYPE_DESC,,AUTO
        46 001120   200303 450500                    STP0    ORG1+2,,AUTO
        46 001121   200004 236100                    LDQ     @PCOM,,AUTO
        46 001122   000053 036003                    ADLQ    43,DU
        46 001123   200302 756100                    STQ     ORG1+1,,AUTO
        46 001124   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 001125   000013 631400 47                 EPPR1   11
        46 001126   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        46 001127   000000 011000                    NOP     0

      591    20302
      592    20303    5                DO CASE(TYPE_DESC.TYPE);

  20303 46 001130   200110 235100                    LDA     TYPE_DESC,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:205  
        46 001131   000024 115007                    CMPA    20,DL
        46 001132   001134 602005 46                 TNC     s:20303+4,AL
        46 001133   001334 710000 46                 TRA     s:20404
        46 001134   001330 710000 46                 TRA     s:20401
        46 001135   001324 710000 46                 TRA     s:20398
        46 001136   001334 710000 46                 TRA     s:20404
        46 001137   001160 710000 46                 TRA     s:20305
        46 001140   001324 710000 46                 TRA     s:20398
        46 001141   001320 710000 46                 TRA     s:20395
        46 001142   001334 710000 46                 TRA     s:20404
        46 001143   001334 710000 46                 TRA     s:20404
        46 001144   001334 710000 46                 TRA     s:20404
        46 001145   001334 710000 46                 TRA     s:20404
        46 001146   001334 710000 46                 TRA     s:20404
        46 001147   001160 710000 46                 TRA     s:20305
        46 001150   001334 710000 46                 TRA     s:20404
        46 001151   001334 710000 46                 TRA     s:20404
        46 001152   001334 710000 46                 TRA     s:20404
        46 001153   001334 710000 46                 TRA     s:20404
        46 001154   001334 710000 46                 TRA     s:20404
        46 001155   001334 710000 46                 TRA     s:20404
        46 001156   001334 710000 46                 TRA     s:20404
        46 001157   001160 710000 46                 TRA     s:20305

      593    20304    5                  CASE(%TYO, %TYF, %TYC);

      594    20305    5                    PCOM.JABS = 5;

  20305 46 001160   000005 236007                    LDQ     5,DL
        46 001161   200004 470500                    LDP0    @PCOM,,AUTO
        46 001162   000011 756100                    STQ     9,,PR0

      595    20306
      596    20307                         %#DNA#( @FROM = PCOM.ROPND,
      597    20308                                 @TO   = PCOM.KOPND );

  20310 46 001163   000053 471500                    LDP1    43,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:206  
        46 001164   100003 473500                    LDP3    3,,PR1
        46 001165   300001 236100                    LDQ     1,,PR3
        46 001166   000077 376007                    ANQ     63,DL
        46 001167   200066 756100                    STQ     J,,AUTO

  20318 46 001170   000000 236000 6                  LDQ     HEAD_ETT$
        46 001171   000005 116000 47                 CMPQ    5
        46 001172   001217 601000 46                 TNZ     s:20330

  20320 46 001173   000002 236000 8                  LDQ     ETT_+2
        46 001174   000005 036007                    ADLQ    5,DL
        46 001175   000003 116000 8                  CMPQ    ETT_+3
        46 001176   001207 604000 46                 TMI     s:20322

  20321 46 001177   000014 236000 47                 LDQ     12
        46 001200   200302 756100                    STQ     ORG1+1,,AUTO
        46 001201   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 001202   200303 451500                    STP1    ORG1+2,,AUTO
        46 001203   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 001204   000000 631400 47                 EPPR1   0
        46 001205   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 001206   000000 011000                    NOP     0

  20322 46 001207   000002 236000 8                  LDQ     ETT_+2
        46 001210   000022 736000                    QLS     18
        46 001211   000001 036000 8                  ADLQ    ETT_+1
        46 001212   200004 470500                    LDP0    @PCOM,,AUTO
        46 001213   000044 756100                    STQ     36,,PR0

  20323 46 001214   000005 236007                    LDQ     5,DL
        46 001215   000002 056000 8                  ASQ     ETT_+2

  20324 46 001216   001223 710000 46                 TRA     s:20340

  20330 46 001217   000044 756100                    STQ     36,,PR0

  20331 46 001220   000000 471400 6                  LDP1    HEAD_ETT$
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:207  
        46 001221   100003 236100                    LDQ     3,,PR1
        46 001222   000000 756000 6                  STQ     HEAD_ETT$

  20340 46 001223   000044 471500                    LDP1    36,,PR0
        46 001224   000007 220003                    LDX0    7,DU
        46 001225   100000 740100                    STX0    0,,PR1

  20345 46 001226   000044 471500                    LDP1    36,,PR0
        46 001227   000053 236100                    LDQ     43,,PR0
        46 001230   100001 756100                    STQ     1,,PR1

  20354 46 001231   000044 471500                    LDP1    36,,PR0
        46 001232   200066 235100                    LDA     J,,AUTO
        46 001233   100002 755100                    STA     2,,PR1

  20356 46 001234   000044 471500                    LDP1    36,,PR0
        46 001235   000000 221003                    LDX1    0,DU
        46 001236   100004 441100                    SXL1    4,,PR1

  20357 46 001237   000044 471500                    LDP1    36,,PR0
        46 001240   000001 236007                    LDQ     1,DL
        46 001241   100004 256100                    ORSQ    4,,PR1

  20358 46 001242   000044 471500                    LDP1    36,,PR0
        46 001243   000000 222003                    LDX2    0,DU
        46 001244   100000 442100                    SXL2    0,,PR1

  20359 46 001245   000044 471500                    LDP1    36,,PR0
        46 001246   100004 742100                    STX2    4,,PR1

  20360 46 001247   000044 471500                    LDP1    36,,PR0
        46 001250   000005 236000 47                 LDQ     5
        46 001251   100003 756100                    STQ     3,,PR1

  20384 46 001252   000016 236000 47                 LDQ     14
        46 001253   200303 756100                    STQ     ORG1+2,,AUTO
        46 001254   200004 236100                    LDQ     @PCOM,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:208  
        46 001255   000053 036003                    ADLQ    43,DU
        46 001256   200302 756100                    STQ     ORG1+1,,AUTO
        46 001257   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 001260   000013 631400 47                 EPPR1   11
        46 001261   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 001262   000000 011000                    NOP     0

  20385 46 001263   200004 236100                    LDQ     @PCOM,,AUTO
        46 001264   000044 036003                    ADLQ    36,DU
        46 001265   200302 756100                    STQ     ORG1+1,,AUTO
        46 001266   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 001267   000000 631400 47                 EPPR1   0
        46 001270   000000 701000 xent               TSX1    Z8HU$WALK
        46 001271   000000 011000                    NOP     0

  20386 46 001272   200004 470500                    LDP0    @PCOM,,AUTO
        46 001273   000053 471500                    LDP1    43,,PR0
        46 001274   100003 473500                    LDP3    3,,PR1
        46 001275   300001 236100                    LDQ     1,,PR3
        46 001276   040000 316007                    CANQ    16384,DL
        46 001277   001313 600000 46                 TZE     s:20390
        46 001300   300005 474500                    LDP4    5,,PR3
        46 001301   400002 220100                    LDX0    2,,PR4
        46 001302   000013 100003                    CMPX0   11,DU
        46 001303   001313 600000 46                 TZE     s:20390

  20388 46 001304   000044 475500                    LDP5    36,,PR0
        46 001305   500003 476500                    LDP6    3,,PR5
        46 001306   600001 236100                    LDQ     1,,PR6
        46 001307   000017 376000 47                 ANQ     15
        46 001310   040000 276007                    ORQ     16384,DL
        46 001311   600001 756100                    STQ     1,,PR6
        46 001312   001337 710000 46                 TRA     s:20407

  20390 46 001313   000044 474500                    LDP4    36,,PR0
        46 001314   400003 475500                    LDP5    3,,PR4
        46 001315   000017 236000 47                 LDQ     15
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:209  
        46 001316   500001 356100                    ANSQ    1,,PR5

  20391 46 001317   001337 710000 46                 TRA     s:20407

      598    20393
      599    20394    5                  CASE(%TYQ);

      600    20395    5                    PCOM.JABS = 4;

  20395 46 001320   000004 236007                    LDQ     4,DL
        46 001321   200004 470500                    LDP0    @PCOM,,AUTO
        46 001322   000011 756100                    STQ     9,,PR0
        46 001323   001337 710000 46                 TRA     s:20407

      601    20396
      602    20397    5                  CASE(%TYI, %TYR);

      603    20398    5                    PCOM.JABS = 3;

  20398 46 001324   000003 236007                    LDQ     3,DL
        46 001325   200004 470500                    LDP0    @PCOM,,AUTO
        46 001326   000011 756100                    STQ     9,,PR0
        46 001327   001337 710000 46                 TRA     s:20407

      604    20399
      605    20400    5                  CASE(%TYD);

      606    20401    5                    PCOM.JABS = 2;

  20401 46 001330   000002 236007                    LDQ     2,DL
        46 001331   200004 470500                    LDP0    @PCOM,,AUTO
        46 001332   000011 756100                    STQ     9,,PR0
        46 001333   001337 710000 46                 TRA     s:20407

      607    20402
      608    20403    5                  CASE(ELSE);

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:210  
      609    20404    5                    PCOM.JABS = 1;

  20404 46 001334   000001 236007                    LDQ     1,DL
        46 001335   200004 470500                    LDP0    @PCOM,,AUTO
        46 001336   000011 756100                    STQ     9,,PR0

      610    20405    5                END; /* Case */

      611    20406    4              END;

      612    20407    3            IF PCOM.ROPND -> ETT.STATE > %REF_T THEN

  20407 46 001337   200004 470500                    LDP0    @PCOM,,AUTO
        46 001340   000053 471500                    LDP1    43,,PR0
        46 001341   100004 220100                    LDX0    4,,PR1
        46 001342   000005 100003                    CMPX0   5,DU
        46 001343   021307 602000 46                 TNC     s:26924

      613    20408    4              DO;

      614    20409    4                CALL Z8HG$SAVE(PCOM.ROPND);

  20409 46 001344   200004 236100                    LDQ     @PCOM,,AUTO
        46 001345   000053 036003                    ADLQ    43,DU
        46 001346   200302 756100                    STQ     ORG1+1,,AUTO
        46 001347   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 001350   000000 631400 47                 EPPR1   0
        46 001351   000000 701000 xent               TSX1    Z8HG$SAVE
        46 001352   000000 011000                    NOP     0

      615    20410    4                CALL Z8HG$FREE_REGISTER(PCOM.ROPND -> ETT.STATE);

  20410 46 001353   200004 470500                    LDP0    @PCOM,,AUTO
        46 001354   000053 471500                    LDP1    43,,PR0
        46 001355   100004 633500                    EPPR3   4,,PR1
        46 001356   200302 453500                    STP3    ORG1+1,,AUTO
        46 001357   200302 630500                    EPPR0   ORG1+1,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:211  
        46 001360   000000 631400 47                 EPPR1   0
        46 001361   000000 701000 xent               TSX1    Z8HG$FREE_REGISTER
        46 001362   000000 011000                    NOP     0

      616    20411    4              END;

  20411 46 001363   021307 710000 46                 TRA     s:26924

      617    20412
      618    20413
      619    20414    3          CASE(%SECOND_PASS);

      620    20415    3            IF PCOM.ROPND -> ETT.REF$ -> REF.ST$ -> ST.TYPE = %TYO OR

  20415 46 001364   200004 474500                    LDP4    @PCOM,,AUTO
        46 001365   400053 475500                    LDP5    43,,PR4
        46 001366   500003 476500                    LDP6    3,,PR5
        46 001367   600005 477500                    LDP7    5,,PR6
        46 001370   700002 220100                    LDX0    2,,PR7
        46 001371   000003 100003                    CMPX0   3,DU
        46 001372   001377 600000 46                 TZE     s:20421
        46 001373   000013 100003                    CMPX0   11,DU
        46 001374   001377 600000 46                 TZE     s:20421
        46 001375   000023 100003                    CMPX0   19,DU
        46 001376   021307 601000 46                 TNZ     s:26924

      621    20416    3                PCOM.ROPND -> ETT.REF$ -> REF.ST$ -> ST.TYPE = %TYF OR
      622    20417    3                PCOM.ROPND -> ETT.REF$ -> REF.ST$ -> ST.TYPE = %TYC THEN
      623    20418                   %#DNA# ( @FROM = PCOM.LOPND,
      624    20419                            @TO   = PCOM.TOPND );

  20421 46 001377   400045 470500                    LDP0    37,,PR4
        46 001400   000003 471500                    LDP1    3,,PR0
        46 001401   100001 236100                    LDQ     1,,PR1
        46 001402   000077 376007                    ANQ     63,DL
        46 001403   200066 756100                    STQ     J,,AUTO

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:212  
  20429 46 001404   000000 236000 6                  LDQ     HEAD_ETT$
        46 001405   000005 116000 47                 CMPQ    5
        46 001406   001433 601000 46                 TNZ     s:20441

  20431 46 001407   000002 236000 8                  LDQ     ETT_+2
        46 001410   000005 036007                    ADLQ    5,DL
        46 001411   000003 116000 8                  CMPQ    ETT_+3
        46 001412   001423 604000 46                 TMI     s:20433

  20432 46 001413   000014 236000 47                 LDQ     12
        46 001414   200302 756100                    STQ     ORG1+1,,AUTO
        46 001415   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 001416   200303 450500                    STP0    ORG1+2,,AUTO
        46 001417   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 001420   000000 631400 47                 EPPR1   0
        46 001421   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 001422   000000 011000                    NOP     0

  20433 46 001423   000002 236000 8                  LDQ     ETT_+2
        46 001424   000022 736000                    QLS     18
        46 001425   000001 036000 8                  ADLQ    ETT_+1
        46 001426   200004 470500                    LDP0    @PCOM,,AUTO
        46 001427   000055 756100                    STQ     45,,PR0

  20434 46 001430   000005 236007                    LDQ     5,DL
        46 001431   000002 056000 8                  ASQ     ETT_+2

  20435 46 001432   001437 710000 46                 TRA     s:20451

  20441 46 001433   400055 756100                    STQ     45,,PR4

  20442 46 001434   000000 470400 6                  LDP0    HEAD_ETT$
        46 001435   000003 236100                    LDQ     3,,PR0
        46 001436   000000 756000 6                  STQ     HEAD_ETT$

  20451 46 001437   200004 470500                    LDP0    @PCOM,,AUTO
        46 001440   000055 471500                    LDP1    45,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:213  
        46 001441   000007 220003                    LDX0    7,DU
        46 001442   100000 740100                    STX0    0,,PR1

  20456 46 001443   000055 471500                    LDP1    45,,PR0
        46 001444   000045 236100                    LDQ     37,,PR0
        46 001445   100001 756100                    STQ     1,,PR1

  20465 46 001446   000055 471500                    LDP1    45,,PR0
        46 001447   200066 235100                    LDA     J,,AUTO
        46 001450   100002 755100                    STA     2,,PR1

  20467 46 001451   000055 471500                    LDP1    45,,PR0
        46 001452   000000 221003                    LDX1    0,DU
        46 001453   100004 441100                    SXL1    4,,PR1

  20468 46 001454   000055 471500                    LDP1    45,,PR0
        46 001455   000001 236007                    LDQ     1,DL
        46 001456   100004 256100                    ORSQ    4,,PR1

  20469 46 001457   000055 471500                    LDP1    45,,PR0
        46 001460   000000 222003                    LDX2    0,DU
        46 001461   100000 442100                    SXL2    0,,PR1

  20470 46 001462   000055 471500                    LDP1    45,,PR0
        46 001463   100004 742100                    STX2    4,,PR1

  20471 46 001464   000055 471500                    LDP1    45,,PR0
        46 001465   000005 236000 47                 LDQ     5
        46 001466   100003 756100                    STQ     3,,PR1

  20495 46 001467   000016 236000 47                 LDQ     14
        46 001470   200303 756100                    STQ     ORG1+2,,AUTO
        46 001471   200004 236100                    LDQ     @PCOM,,AUTO
        46 001472   000045 036003                    ADLQ    37,DU
        46 001473   200302 756100                    STQ     ORG1+1,,AUTO
        46 001474   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 001475   000013 631400 47                 EPPR1   11
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:214  
        46 001476   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 001477   000000 011000                    NOP     0

  20496 46 001500   200004 236100                    LDQ     @PCOM,,AUTO
        46 001501   000055 036003                    ADLQ    45,DU
        46 001502   200302 756100                    STQ     ORG1+1,,AUTO
        46 001503   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 001504   000000 631400 47                 EPPR1   0
        46 001505   000000 701000 xent               TSX1    Z8HU$WALK
        46 001506   000000 011000                    NOP     0

  20497 46 001507   200004 470500                    LDP0    @PCOM,,AUTO
        46 001510   000045 471500                    LDP1    37,,PR0
        46 001511   100003 473500                    LDP3    3,,PR1
        46 001512   300001 236100                    LDQ     1,,PR3
        46 001513   040000 316007                    CANQ    16384,DL
        46 001514   001530 600000 46                 TZE     s:20501
        46 001515   300005 474500                    LDP4    5,,PR3
        46 001516   400002 220100                    LDX0    2,,PR4
        46 001517   000013 100003                    CMPX0   11,DU
        46 001520   001530 600000 46                 TZE     s:20501

  20499 46 001521   000055 475500                    LDP5    45,,PR0
        46 001522   500003 476500                    LDP6    3,,PR5
        46 001523   600001 236100                    LDQ     1,,PR6
        46 001524   000017 376000 47                 ANQ     15
        46 001525   040000 276007                    ORQ     16384,DL
        46 001526   600001 756100                    STQ     1,,PR6
        46 001527   021307 710000 46                 TRA     s:26924

  20501 46 001530   000055 474500                    LDP4    45,,PR0
        46 001531   400003 475500                    LDP5    3,,PR4
        46 001532   000017 236000 47                 LDQ     15
        46 001533   500001 356100                    ANSQ    1,,PR5

  20502 46 001534   021307 710000 46                 TRA     s:26924

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:215  
      625    20504
      626    20505    3          CASE(%THIRD_PASS);

      627    20506    3            IF PCOM.LOPND -> ETT.ID = %SIZ THEN

  20506 46 001535   200004 474500                    LDP4    @PCOM,,AUTO
        46 001536   400045 475500                    LDP5    37,,PR4
        46 001537   500000 220100                    LDX0    0,,PR5
        46 001540   000004 100003                    CMPX0   4,DU
        46 001541   001550 601000 46                 TNZ     s:20509

      628    20507    3              CALL Z8HU$POOL (PCOM.LOPND -> ETT.LOP);

  20507 46 001542   500001 636500                    EPPR6   1,,PR5
        46 001543   200302 456500                    STP6    ORG1+1,,AUTO
        46 001544   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 001545   000000 631400 47                 EPPR1   0
        46 001546   000000 701000 xent               TSX1    Z8HU$POOL
        46 001547   000000 011000                    NOP     0

      629    20508
      630    20509    3            PILL -> CCOSU.EVEX -> ETT.COUNT = PILL -> CCOSU.CNTE;

  20509 46 001550   200003 470500                    LDP0    @PILL,,AUTO
        46 001551   000000 471500                    LDP1    0,,PR0
        46 001552   100004 473500                    LDP3    4,,PR1
        46 001553   100000 720100                    LXL0    0,,PR1
        46 001554   300000 440100                    SXL0    0,,PR3

      631    20510
      632    20511    3            PILL -> CCOSU.EVEX -> ETT.STATE = %REF_T;

  20511 46 001555   000000 471500                    LDP1    0,,PR0
        46 001556   100004 473500                    LDP3    4,,PR1
        46 001557   000004 220003                    LDX0    4,DU
        46 001560   300004 740100                    STX0    4,,PR3

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:216  
      633    20512
      634    20513    3            PILL -> CCOSU.EVEX -> ETT.REF$ = PCOM.LOPND -> ETT.REF$;

  20513 46 001561   000000 471500                    LDP1    0,,PR0
        46 001562   100004 473500                    LDP3    4,,PR1
        46 001563   200004 474500                    LDP4    @PCOM,,AUTO
        46 001564   400045 475500                    LDP5    37,,PR4
        46 001565   500003 236100                    LDQ     3,,PR5
        46 001566   300003 756100                    STQ     3,,PR3

      635    20514    3            PILL -> CCOSU.EVEX -> ETT.REF$ -> REF.ST$ -> TEMP.REFERENCES

  20514 46 001567   000000 471500                    LDP1    0,,PR0
        46 001570   100004 473500                    LDP3    4,,PR1
        46 001571   300003 475500                    LDP5    3,,PR3
        46 001572   500005 476500                    LDP6    5,,PR5
        46 001573   300000 721100                    LXL1    0,,PR3
        46 001574   600004 741100                    STX1    4,,PR6

      636    20515    3                   = PILL -> CCOSU.EVEX -> ETT.COUNT;
      637    20516
      638    20517                 %INSERT_INTO_SL_LIST( PTR = PCOM.LOPND,
      639    20518                                       ITEM = ETT,
      640    20519                                       HEAD = HEAD_ETT$,
      641    20520                                       NEXT = NEXT$ );

  20523 46 001575   400045 471500                    LDP1    37,,PR4
        46 001576   000000 236000 6                  LDQ     HEAD_ETT$
        46 001577   100003 756100                    STQ     3,,PR1

  20524 46 001600   400045 236100                    LDQ     37,,PR4
        46 001601   000000 756000 6                  STQ     HEAD_ETT$

      642    20533
      643    20534    3        END; /* CASE (CASE_PASS) */

  20534 46 001602   021307 710000 46                 TRA     s:26924
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:217  

      644    20535
      645    20536        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:218  
      646    20537    2   CASE(%CMPAO);

      647    20538
      648    20539        %EQU CMPA_LOP_EQ_ROP = 66;
      649    20540
      650    20541    3        DO CASE(CASE_PASS);

  20541 46 001603   200005 473500                    LDP3    @CASE_PASS,,AUTO
        46 001604   300000 235100                    LDA     0,,PR3
        46 001605   000002 115007                    CMPA    2,DL
        46 001606   001610 602005 46                 TNC     s:20541+5,AL
        46 001607   021307 710000 46                 TRA     s:26924
        46 001610   001612 710000 46                 TRA     s:20545
        46 001611   002734 710000 46                 TRA     s:20869

      651    20542
      652    20543    3          CASE(%FIRST_PASS);

      653    20544
      654    20545    3            PCOM.ROPND = PILL -> ETT.ROP -> ETT.LOP;

  20545 46 001612   100002 474500                    LDP4    2,,PR1
        46 001613   400001 236100                    LDQ     1,,PR4
        46 001614   200004 475500                    LDP5    @PCOM,,AUTO
        46 001615   500053 756100                    STQ     43,,PR5

      655    20546    3            IF PCOM.ROPND -> ETT.STATE >= %ARA AND

  20546 46 001616   500053 471500                    LDP1    43,,PR5
        46 001617   100004 220100                    LDX0    4,,PR1
        46 001620   000005 100003                    CMPX0   5,DU
        46 001621   001626 602000 46                 TNC     s:20546+8
        46 001622   000000 474500                    LDP4    0,,PR0
        46 001623   400001 476500                    LDP6    1,,PR4
        46 001624   600004 100100                    CMPX0   4,,PR6
        46 001625   001631 600000 46                 TZE     s:20549
        46 001626   000000 474500                    LDP4    0,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:219  
        46 001627   400001 116100                    CMPQ    1,,PR4
        46 001630   001634 601000 46                 TNZ     s:20551

      656    20547    3                PCOM.ROPND -> ETT.STATE = PILL -> ETT.LOP -> ETT.STATE OR
      657    20548    3                PCOM.ROPND = PILL -> ETT.LOP THEN
      658    20549    3              PCOM.CABS = %CMPA_LOP_EQ_ROP;

  20549 46 001631   000102 235007                    LDA     66,DL
        46 001632   500002 755100                    STA     2,,PR5
        46 001633   021307 710000 46                 TRA     s:26924

      659    20550    3            ELSE
      660    20551    4            DO CASE(PILL -> ETT.ROP -> ETT.ROPCON);

  20551 46 001634   400002 476500                    LDP6    2,,PR4
        46 001635   600002 235100                    LDA     2,,PR6
        46 001636   000022 115007                    CMPA    18,DL
        46 001637   001641 602005 46                 TNC     s:20551+5,AL
        46 001640   021307 710000 46                 TRA     s:26924
        46 001641   001663 710000 46                 TRA     s:20554
        46 001642   001737 710000 46                 TRA     s:20580
        46 001643   001774 710000 46                 TRA     s:20592
        46 001644   002032 710000 46                 TRA     s:20605
        46 001645   002102 710000 46                 TRA     s:20623
        46 001646   002144 710000 46                 TRA     s:20642
        46 001647   002166 710000 46                 TRA     s:20654
        46 001650   002214 710000 46                 TRA     s:20670
        46 001651   002245 710000 46                 TRA     s:20689
        46 001652   002273 710000 46                 TRA     s:20702
        46 001653   002355 710000 46                 TRA     s:20728
        46 001654   002355 710000 46                 TRA     s:20728
        46 001655   002355 710000 46                 TRA     s:20728
        46 001656   002444 710000 46                 TRA     s:20754
        46 001657   002530 710000 46                 TRA     s:20783
        46 001660   002612 710000 46                 TRA     s:20809
        46 001661   002663 710000 46                 TRA     s:20833
        46 001662   002716 710000 46                 TRA     s:20843
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:220  

      661    20552    4              CASE(%MVANO_UPPER_TO_UPPER);

      662    20553
      663    20554    4                IF PILL -> ETT.LOP -> ETT.STATE >= %ARA THEN

  20554 46 001663   400001 477500                    LDP7    1,,PR4
        46 001664   700004 221100                    LDX1    4,,PR7
        46 001665   000005 101003                    CMPX1   5,DU
        46 001666   001723 602000 46                 TNC     s:20569

      664    20555    5                  DO;

      665    20556    5                    IF PILL -> ETT.LOP -> ETT.STATE < %XR0 THEN

  20556 46 001667   000010 101003                    CMPX1   8,DU
        46 001670   001706 603000 46                 TRC     s:20565

      666    20557    6                      DO;

      667    20558    6                        PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 1);

  20558 46 001671   000064 235007                    LDA     52,DL
        46 001672   500002 755100                    STA     2,,PR5

      668    20559    6                        IF PILL -> ETT.LOP -> ETT.STATE = %ARA THEN

  20559 46 001673   000000 474500                    LDP4    0,,PR0
        46 001674   400001 476500                    LDP6    1,,PR4
        46 001675   600004 220100                    LDX0    4,,PR6
        46 001676   000005 100003                    CMPX0   5,DU
        46 001677   001703 601000 46                 TNZ     s:20562

      669    20560    6                          PCOM.GABS = 1; /* ,QU modification */

  20560 46 001700   000001 235007                    LDA     1,DL
        46 001701   500006 755100                    STA     6,,PR5
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:221  
        46 001702   001710 710000 46                 TRA     s:20566

      670    20561    6                        ELSE
      671    20562    6                          PCOM.GABS = 2; /* ,AU modification */

  20562 46 001703   000002 235007                    LDA     2,DL
        46 001704   500006 755100                    STA     6,,PR5

      672    20563    6                      END;

  20563 46 001705   001710 710000 46                 TRA     s:20566

      673    20564    5                    ELSE
      674    20565    5                      PCOM.CABS = %(MVANO_UPPER_TO_UPPER * 3 + 1);

  20565 46 001706   000001 235007                    LDA     1,DL
        46 001707   500002 755100                    STA     2,,PR5

      675    20566    5                    IF PCOM.ROPND -> ETT.STATE >= %ARA THEN

  20566 46 001710   100004 220100                    LDX0    4,,PR1
        46 001711   000005 100003                    CMPX0   5,DU
        46 001712   021307 602000 46                 TNC     s:26924

      676    20567    5                      CALL Z8HG$SAVE (PCOM.ROPND);

  20567 46 001713   200004 236100                    LDQ     @PCOM,,AUTO
        46 001714   000053 036003                    ADLQ    43,DU
        46 001715   200302 756100                    STQ     ORG1+1,,AUTO
        46 001716   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 001717   000000 631400 47                 EPPR1   0
        46 001720   000000 701000 xent               TSX1    Z8HG$SAVE
        46 001721   000000 011000                    NOP     0

      677    20568    5                  END;

  20568 46 001722   021307 710000 46                 TRA     s:26924
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:222  

      678    20569    4                ELSE IF PCOM.ROPND -> ETT.STATE >= %XR0 AND

  20569 46 001723   000010 100003                    CMPX0   8,DU
        46 001724   001735 602000 46                 TNC     s:20576
        46 001725   000020 100003                    CMPX0   16,DU
        46 001726   001735 603000 46                 TRC     s:20576

      679    20570    4                    PCOM.ROPND -> ETT.STATE <= %XR7 THEN
      680    20571    5                  DO;

      681    20572    5                    PCOM.CABS = %(MVANO_UPPER_TO_UPPER * 3 + 2);

  20572 46 001727   000002 235007                    LDA     2,DL
        46 001730   500002 755100                    STA     2,,PR5

      682    20573    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20573 46 001731   000000 474500                    LDP4    0,,PR0
        46 001732   000004 236007                    LDQ     4,DL
        46 001733   400004 256100                    ORSQ    4,,PR4

      683    20574    5                  END;

  20574 46 001734   021307 710000 46                 TRA     s:26924

      684    20575    4                ELSE
      685    20576    4                  PCOM.CABS = %(MVANO_UPPER_TO_UPPER * 3);

  20576 46 001735   500002 450100                    STZ     2,,PR5
        46 001736   021307 710000 46                 TRA     s:26924

      686    20577
      687    20578    4              CASE(%MVANO_UPPER_TO_LOWER);

      688    20579
      689    20580    4                IF PCOM.ROPND -> ETT.STATE >= %ARA THEN
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:223  

  20580 46 001737   000005 100003                    CMPX0   5,DU
        46 001740   001750 602000 46                 TNC     s:20582

      690    20581    4                  CALL Z8HG$SAVE (PCOM.ROPND);

  20581 46 001741   200004 236100                    LDQ     @PCOM,,AUTO
        46 001742   000053 036003                    ADLQ    43,DU
        46 001743   200302 756100                    STQ     ORG1+1,,AUTO
        46 001744   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 001745   000000 631400 47                 EPPR1   0
        46 001746   000000 701000 xent               TSX1    Z8HG$SAVE
        46 001747   000000 011000                    NOP     0

      691    20582    4                IF PILL -> ETT.LOP -> ETT.STATE >= %ARA THEN

  20582 46 001750   200003 470500                    LDP0    @PILL,,AUTO
        46 001751   000000 471500                    LDP1    0,,PR0
        46 001752   100001 473500                    LDP3    1,,PR1
        46 001753   300004 220100                    LDX0    4,,PR3
        46 001754   000005 100003                    CMPX0   5,DU
        46 001755   001770 602000 46                 TNC     s:20588

      692    20583    4                  IF PILL -> ETT.LOP -> ETT.STATE < %XR0 THEN

  20583 46 001756   000010 100003                    CMPX0   8,DU
        46 001757   001764 603000 46                 TRC     s:20586

      693    20584    4                    PCOM.CABS = %(MVANO_UPPER_TO_LOWER * 3 + 2);

  20584 46 001760   000005 235007                    LDA     5,DL
        46 001761   200004 474500                    LDP4    @PCOM,,AUTO
        46 001762   400002 755100                    STA     2,,PR4
        46 001763   021307 710000 46                 TRA     s:26924

      694    20585    4                  ELSE
      695    20586    4                    PCOM.CABS = %(MVANO_UPPER_TO_LOWER * 3 + 1);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:224  

  20586 46 001764   000004 235007                    LDA     4,DL
        46 001765   200004 474500                    LDP4    @PCOM,,AUTO
        46 001766   400002 755100                    STA     2,,PR4
        46 001767   021307 710000 46                 TRA     s:26924

      696    20587    4                ELSE
      697    20588    4                  PCOM.CABS = %(MVANO_UPPER_TO_LOWER * 3);

  20588 46 001770   000003 235007                    LDA     3,DL
        46 001771   200004 474500                    LDP4    @PCOM,,AUTO
        46 001772   400002 755100                    STA     2,,PR4
        46 001773   021307 710000 46                 TRA     s:26924

      698    20589
      699    20590    4              CASE(%MVANO_LOWER_TO_UPPER);

      700    20591
      701    20592    4                IF PILL -> ETT.LOP -> ETT.STATE >= %ARA THEN

  20592 46 001774   400001 477500                    LDP7    1,,PR4
        46 001775   700004 221100                    LDX1    4,,PR7
        46 001776   000005 101003                    CMPX1   5,DU
        46 001777   002006 602000 46                 TNC     s:20594

      702    20593    4                  CALL Z8HG$SAVE (PILL -> ETT.LOP);

  20593 46 002000   400001 630500                    EPPR0   1,,PR4
        46 002001   200302 450500                    STP0    ORG1+1,,AUTO
        46 002002   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 002003   000000 631400 47                 EPPR1   0
        46 002004   000000 701000 xent               TSX1    Z8HG$SAVE
        46 002005   000000 011000                    NOP     0

      703    20594    4                IF PCOM.ROPND -> ETT.STATE >= %ARA THEN

  20594 46 002006   200004 470500                    LDP0    @PCOM,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:225  
        46 002007   000053 471500                    LDP1    43,,PR0
        46 002010   100004 220100                    LDX0    4,,PR1
        46 002011   000005 100003                    CMPX0   5,DU
        46 002012   002023 602000 46                 TNC     s:20600

      704    20595    4                  IF PCOM.ROPND -> ETT.STATE < %XR0 THEN

  20595 46 002013   000010 100003                    CMPX0   8,DU
        46 002014   002020 603000 46                 TRC     s:20598

      705    20596    4                    PCOM.CABS = %(MVANO_LOWER_TO_UPPER * 3 + 1);

  20596 46 002015   000007 235007                    LDA     7,DL
        46 002016   000002 755100                    STA     2,,PR0
        46 002017   002025 710000 46                 TRA     s:20601

      706    20597    4                  ELSE
      707    20598    4                    PCOM.CABS = %(MVANO_LOWER_TO_UPPER * 3 + 2);

  20598 46 002020   000010 235007                    LDA     8,DL
        46 002021   000002 755100                    STA     2,,PR0
        46 002022   002025 710000 46                 TRA     s:20601

      708    20599    4                ELSE
      709    20600    4                  PCOM.CABS = %(MVANO_LOWER_TO_UPPER * 3);

  20600 46 002023   000006 235007                    LDA     6,DL
        46 002024   000002 755100                    STA     2,,PR0

      710    20601    4                PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20601 46 002025   200003 473500                    LDP3    @PILL,,AUTO
        46 002026   300000 474500                    LDP4    0,,PR3
        46 002027   000004 236007                    LDQ     4,DL
        46 002030   400004 256100                    ORSQ    4,,PR4
        46 002031   021307 710000 46                 TRA     s:26924

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:226  
      711    20602
      712    20603    4              CASE(%MVANO_LOWER_TO_LOWER);

      713    20604
      714    20605    4                IF PILL -> ETT.LOP -> ETT.STATE >= %ARA THEN

  20605 46 002032   400001 477500                    LDP7    1,,PR4
        46 002033   700004 221100                    LDX1    4,,PR7
        46 002034   000005 101003                    CMPX1   5,DU
        46 002035   002070 602000 46                 TNC     s:20615

      715    20606    5                  DO;

      716    20607    5                    IF PCOM.ROPND -> ETT.STATE >= %ARA THEN

  20607 46 002036   000005 100003                    CMPX0   5,DU
        46 002037   002047 602000 46                 TNC     s:20609

      717    20608    5                      CALL Z8HG$SAVE (PCOM.ROPND);

  20608 46 002040   200004 236100                    LDQ     @PCOM,,AUTO
        46 002041   000053 036003                    ADLQ    43,DU
        46 002042   200302 756100                    STQ     ORG1+1,,AUTO
        46 002043   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 002044   000000 631400 47                 EPPR1   0
        46 002045   000000 701000 xent               TSX1    Z8HG$SAVE
        46 002046   000000 011000                    NOP     0

      718    20609    5                    IF PILL -> ETT.LOP -> ETT.STATE < %XR0 THEN

  20609 46 002047   200003 470500                    LDP0    @PILL,,AUTO
        46 002050   000000 471500                    LDP1    0,,PR0
        46 002051   100001 473500                    LDP3    1,,PR1
        46 002052   300004 220100                    LDX0    4,,PR3
        46 002053   000010 100003                    CMPX0   8,DU
        46 002054   002061 603000 46                 TRC     s:20612

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:227  
      719    20610    5                      PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 2);

  20610 46 002055   000065 235007                    LDA     53,DL
        46 002056   200004 474500                    LDP4    @PCOM,,AUTO
        46 002057   400002 755100                    STA     2,,PR4
        46 002060   002064 710000 46                 TRA     s:20613

      720    20611    5                    ELSE
      721    20612    5                      PCOM.CABS = %(MVANO_LOWER_TO_LOWER * 3 + 1);

  20612 46 002061   000012 235007                    LDA     10,DL
        46 002062   200004 474500                    LDP4    @PCOM,,AUTO
        46 002063   400002 755100                    STA     2,,PR4

      722    20613    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20613 46 002064   000000 471500                    LDP1    0,,PR0
        46 002065   000004 236007                    LDQ     4,DL
        46 002066   100004 256100                    ORSQ    4,,PR1

      723    20614    5                  END;

  20614 46 002067   021307 710000 46                 TRA     s:26924

      724    20615    4                ELSE IF PCOM.ROPND -> ETT.STATE >= %XR0 AND

  20615 46 002070   000010 100003                    CMPX0   8,DU
        46 002071   002077 602000 46                 TNC     s:20619
        46 002072   000020 100003                    CMPX0   16,DU
        46 002073   002077 603000 46                 TRC     s:20619

      725    20616    4                    PCOM.ROPND -> ETT.STATE <= %XR7 THEN
      726    20617    4                  PCOM.CABS = %(MVANO_LOWER_TO_LOWER * 3 + 2);

  20617 46 002074   000013 235007                    LDA     11,DL
        46 002075   500002 755100                    STA     2,,PR5
        46 002076   021307 710000 46                 TRA     s:26924
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:228  

      727    20618    4                ELSE
      728    20619    4                  PCOM.CABS = %(MVANO_LOWER_TO_LOWER * 3);

  20619 46 002077   000011 235007                    LDA     9,DL
        46 002100   500002 755100                    STA     2,,PR5
        46 002101   021307 710000 46                 TRA     s:26924

      729    20620
      730    20621    4              CASE(%MVANO_WORD_TO_WORD);

      731    20622
      732    20623    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR

  20623 46 002102   400001 477500                    LDP7    1,,PR4
        46 002103   700004 221100                    LDX1    4,,PR7
        46 002104   000005 101003                    CMPX1   5,DU
        46 002105   002110 600000 46                 TZE     s:20626
        46 002106   000006 101003                    CMPX1   6,DU
        46 002107   002127 601000 46                 TNZ     s:20631

      733    20624    4                    PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      734    20625    5                  DO;

      735    20626    5                    PCOM.CABS = %(MVANO_WORD_TO_WORD * 3 + 1);

  20626 46 002110   000015 235007                    LDA     13,DL
        46 002111   500002 755100                    STA     2,,PR5

      736    20627    5                    IF PCOM.ROPND -> ETT.STATE = %ARA OR

  20627 46 002112   100004 220100                    LDX0    4,,PR1
        46 002113   000005 100003                    CMPX0   5,DU
        46 002114   002117 600000 46                 TZE     s:20629
        46 002115   000006 100003                    CMPX0   6,DU
        46 002116   021307 601000 46                 TNZ     s:26924

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:229  
      737    20628    5                        PCOM.ROPND -> ETT.STATE = %ARQ THEN
      738    20629    5                      CALL Z8HG$SAVE (PCOM.ROPND);

  20629 46 002117   200004 236100                    LDQ     @PCOM,,AUTO
        46 002120   000053 036003                    ADLQ    43,DU
        46 002121   200302 756100                    STQ     ORG1+1,,AUTO
        46 002122   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 002123   000000 631400 47                 EPPR1   0
        46 002124   000000 701000 xent               TSX1    Z8HG$SAVE
        46 002125   000000 011000                    NOP     0

      739    20630    5                  END;

  20630 46 002126   021307 710000 46                 TRA     s:26924

      740    20631    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARA OR

  20631 46 002127   000005 100003                    CMPX0   5,DU
        46 002130   002133 600000 46                 TZE     s:20634
        46 002131   000006 100003                    CMPX0   6,DU
        46 002132   002141 601000 46                 TNZ     s:20638

      741    20632    4                    PCOM.ROPND -> ETT.STATE = %ARQ THEN
      742    20633    5                  DO;

      743    20634    5                    PCOM.CABS = %(MVANO_WORD_TO_WORD * 3 + 2);

  20634 46 002133   000016 235007                    LDA     14,DL
        46 002134   500002 755100                    STA     2,,PR5

      744    20635    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20635 46 002135   000000 474500                    LDP4    0,,PR0
        46 002136   000004 236007                    LDQ     4,DL
        46 002137   400004 256100                    ORSQ    4,,PR4

      745    20636    5                  END;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:230  

  20636 46 002140   021307 710000 46                 TRA     s:26924

      746    20637    4                ELSE
      747    20638    4                  PCOM.CABS = %(MVANO_WORD_TO_WORD * 3);

  20638 46 002141   000014 235007                    LDA     12,DL
        46 002142   500002 755100                    STA     2,,PR5
        46 002143   021307 710000 46                 TRA     s:26924

      748    20639
      749    20640    4              CASE(%MVANO_EVEN_TO_EVEN);

      750    20641
      751    20642    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARAQ THEN

  20642 46 002144   400001 477500                    LDP7    1,,PR4
        46 002145   700004 221100                    LDX1    4,,PR7
        46 002146   000007 101003                    CMPX1   7,DU
        46 002147   002153 601000 46                 TNZ     s:20644

      752    20643    4                  PCOM.CABS = %(MVANO_EVEN_TO_EVEN * 3 + 1);

  20643 46 002150   000020 235007                    LDA     16,DL
        46 002151   500002 755100                    STA     2,,PR5
        46 002152   021307 710000 46                 TRA     s:26924

      753    20644    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARAQ THEN

  20644 46 002153   000007 100003                    CMPX0   7,DU
        46 002154   002163 601000 46                 TNZ     s:20650

      754    20645    5                  DO;

      755    20646    5                    PCOM.CABS = %(MVANO_EVEN_TO_EVEN * 3 + 2);

  20646 46 002155   000021 235007                    LDA     17,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:231  
        46 002156   500002 755100                    STA     2,,PR5

      756    20647    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20647 46 002157   000000 474500                    LDP4    0,,PR0
        46 002160   000004 236007                    LDQ     4,DL
        46 002161   400004 256100                    ORSQ    4,,PR4

      757    20648    5                  END;

  20648 46 002162   021307 710000 46                 TRA     s:26924

      758    20649    4                ELSE
      759    20650    4                  PCOM.CABS = %(MVANO_EVEN_TO_EVEN * 3);

  20650 46 002163   000017 235007                    LDA     15,DL
        46 002164   500002 755100                    STA     2,,PR5
        46 002165   021307 710000 46                 TRA     s:26924

      760    20651
      761    20652    4              CASE(%MVANO_EVEN_TO_ODD);

      762    20653
      763    20654    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARAQ THEN

  20654 46 002166   400001 477500                    LDP7    1,,PR4
        46 002167   700004 221100                    LDX1    4,,PR7
        46 002170   000007 101003                    CMPX1   7,DU
        46 002171   002175 601000 46                 TNZ     s:20656

      764    20655    4                  PCOM.CABS = %(MVANO_EVEN_TO_ODD * 3 + 1);

  20655 46 002172   000023 235007                    LDA     19,DL
        46 002173   500002 755100                    STA     2,,PR5
        46 002174   021307 710000 46                 TRA     s:26924

      765    20656    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARAQ THEN
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:232  

  20656 46 002175   000007 100003                    CMPX0   7,DU
        46 002176   002207 601000 46                 TNZ     s:20664

      766    20657    5                  DO;

      767    20658    5                    PCOM.CABS = %(MVANO_EVEN_TO_ODD * 3 + 2);

  20658 46 002177   000024 235007                    LDA     20,DL
        46 002200   500002 755100                    STA     2,,PR5

      768    20659    5                    PCOM.OABS = 1;

  20659 46 002201   000001 235007                    LDA     1,DL
        46 002202   500016 755100                    STA     14,,PR5

      769    20660    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20660 46 002203   000000 474500                    LDP4    0,,PR0
        46 002204   000004 236007                    LDQ     4,DL
        46 002205   400004 256100                    ORSQ    4,,PR4

      770    20661    5                  END;

  20661 46 002206   021307 710000 46                 TRA     s:26924

      771    20662    4                ELSE
      772    20663    5                  DO;

      773    20664    5                    PCOM.CABS = %(MVANO_EVEN_TO_ODD * 3);

  20664 46 002207   000022 235007                    LDA     18,DL
        46 002210   500002 755100                    STA     2,,PR5

      774    20665    5                    PCOM.OABS = 1;

  20665 46 002211   000001 235007                    LDA     1,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:233  
        46 002212   500016 755100                    STA     14,,PR5

      775    20666    5                  END;

  20666 46 002213   021307 710000 46                 TRA     s:26924

      776    20667
      777    20668    4              CASE(%MVANO_ODD_TO_EVEN);

      778    20669
      779    20670    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARAQ THEN

  20670 46 002214   400001 477500                    LDP7    1,,PR4
        46 002215   700004 221100                    LDX1    4,,PR7
        46 002216   000007 101003                    CMPX1   7,DU
        46 002217   002225 601000 46                 TNZ     s:20675

      780    20671    5                  DO;

      781    20672    5                    PCOM.CABS = %(MVANO_ODD_TO_EVEN * 3 + 1);

  20672 46 002220   000026 235007                    LDA     22,DL
        46 002221   500002 755100                    STA     2,,PR5

      782    20673    5                    PCOM.OABS = 1;

  20673 46 002222   000001 235007                    LDA     1,DL
        46 002223   500016 755100                    STA     14,,PR5

      783    20674    5                  END;

  20674 46 002224   021307 710000 46                 TRA     s:26924

      784    20675    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARAQ THEN

  20675 46 002225   000007 100003                    CMPX0   7,DU
        46 002226   002235 601000 46                 TNZ     s:20682
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:234  

      785    20676    5                  DO;

      786    20677    5                    PCOM.CABS = %(MVANO_ODD_TO_EVEN * 3 + 2);

  20677 46 002227   000027 235007                    LDA     23,DL
        46 002230   500002 755100                    STA     2,,PR5

      787    20678    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20678 46 002231   000000 474500                    LDP4    0,,PR0
        46 002232   000004 236007                    LDQ     4,DL
        46 002233   400004 256100                    ORSQ    4,,PR4

      788    20679    5                  END;

  20679 46 002234   021307 710000 46                 TRA     s:26924

      789    20680    4                ELSE
      790    20681    5                  DO;

      791    20682    5                    PCOM.CABS = %(MVANO_ODD_TO_EVEN * 3);

  20682 46 002235   000025 235007                    LDA     21,DL
        46 002236   500002 755100                    STA     2,,PR5

      792    20683    5                    PCOM.OABS = 1;

  20683 46 002237   000001 235007                    LDA     1,DL
        46 002240   500016 755100                    STA     14,,PR5

      793    20684    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20684 46 002241   000000 474500                    LDP4    0,,PR0
        46 002242   000004 236007                    LDQ     4,DL
        46 002243   400004 256100                    ORSQ    4,,PR4

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:235  
      794    20685    5                  END;

  20685 46 002244   021307 710000 46                 TRA     s:26924

      795    20686
      796    20687    4              CASE(%MVANO_ODD_TO_ODD);

      797    20688
      798    20689    4                PCOM.OABS = 1;

  20689 46 002245   000001 235007                    LDA     1,DL
        46 002246   500016 755100                    STA     14,,PR5

      799    20690    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARAQ THEN

  20690 46 002247   000000 474500                    LDP4    0,,PR0
        46 002250   400001 476500                    LDP6    1,,PR4
        46 002251   600004 220100                    LDX0    4,,PR6
        46 002252   000007 100003                    CMPX0   7,DU
        46 002253   002257 601000 46                 TNZ     s:20692

      800    20691    4                  PCOM.CABS = %(MVANO_ODD_TO_ODD * 3 + 1);

  20691 46 002254   000031 235007                    LDA     25,DL
        46 002255   500002 755100                    STA     2,,PR5
        46 002256   021307 710000 46                 TRA     s:26924

      801    20692    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARAQ THEN

  20692 46 002257   100004 221100                    LDX1    4,,PR1
        46 002260   000007 101003                    CMPX1   7,DU
        46 002261   002270 601000 46                 TNZ     s:20698

      802    20693    5                  DO;

      803    20694    5                    PCOM.CABS = %(MVANO_ODD_TO_ODD * 3 + 2);

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:236  
  20694 46 002262   000032 235007                    LDA     26,DL
        46 002263   500002 755100                    STA     2,,PR5

      804    20695    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20695 46 002264   000000 474500                    LDP4    0,,PR0
        46 002265   000004 236007                    LDQ     4,DL
        46 002266   400004 256100                    ORSQ    4,,PR4

      805    20696    5                  END;

  20696 46 002267   021307 710000 46                 TRA     s:26924

      806    20697    4                ELSE
      807    20698    4                  PCOM.CABS = %(MVANO_ODD_TO_ODD * 3);

  20698 46 002270   000030 235007                    LDA     24,DL
        46 002271   500002 755100                    STA     2,,PR5
        46 002272   021307 710000 46                 TRA     s:26924

      808    20699
      809    20700    4              CASE(%MVANO_BYTE_0);

      810    20701
      811    20702    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR

  20702 46 002273   400001 477500                    LDP7    1,,PR4
        46 002274   700004 221100                    LDX1    4,,PR7
        46 002275   000005 101003                    CMPX1   5,DU
        46 002276   002301 600000 46                 TZE     s:20705
        46 002277   000006 101003                    CMPX1   6,DU
        46 002300   002324 601000 46                 TNZ     s:20711

      812    20703    4                    PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      813    20704    5                  DO;

      814    20705    5                    PCOM.CABS = %(MVANO_BYTE_0 * 3 + 1);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:237  

  20705 46 002301   000034 235007                    LDA     28,DL
        46 002302   500002 755100                    STA     2,,PR5

      815    20706    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20706 46 002303   000000 474500                    LDP4    0,,PR0
        46 002304   000004 236007                    LDQ     4,DL
        46 002305   400004 256100                    ORSQ    4,,PR4

      816    20707    5                    IF PCOM.ROPND -> ETT.STATE = %ARA OR

  20707 46 002306   500053 471500                    LDP1    43,,PR5
        46 002307   100004 220100                    LDX0    4,,PR1
        46 002310   000005 100003                    CMPX0   5,DU
        46 002311   002314 600000 46                 TZE     s:20709
        46 002312   000006 100003                    CMPX0   6,DU
        46 002313   021307 601000 46                 TNZ     s:26924

      817    20708    5                        PCOM.ROPND -> ETT.STATE = %ARQ THEN
      818    20709    5                      CALL Z8HG$SAVE (PCOM.ROPND);

  20709 46 002314   200004 236100                    LDQ     @PCOM,,AUTO
        46 002315   000053 036003                    ADLQ    43,DU
        46 002316   200302 756100                    STQ     ORG1+1,,AUTO
        46 002317   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 002320   000000 631400 47                 EPPR1   0
        46 002321   000000 701000 xent               TSX1    Z8HG$SAVE
        46 002322   000000 011000                    NOP     0

      819    20710    5                  END;

  20710 46 002323   021307 710000 46                 TRA     s:26924

      820    20711    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARA OR

  20711 46 002324   000005 100003                    CMPX0   5,DU
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:238  
        46 002325   002330 600000 46                 TZE     s:20713
        46 002326   000006 100003                    CMPX0   6,DU
        46 002327   002333 601000 46                 TNZ     s:20714

      821    20712    4                    PCOM.ROPND -> ETT.STATE = %ARQ THEN
      822    20713    4                  PCOM.CABS = %(MVANO_BYTE_0 * 3 + 2);

  20713 46 002330   000035 235007                    LDA     29,DL
        46 002331   500002 755100                    STA     2,,PR5
        46 002332   021307 710000 46                 TRA     s:26924

      823    20714    4                ELSE IF PCOM.ROPND -> ETT.ID = %TRIAD THEN

  20714 46 002333   100000 222100                    LDX2    0,,PR1
        46 002334   000015 102003                    CMPX2   13,DU
        46 002335   002341 601000 46                 TNZ     s:20716

      824    20715    4                  PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 3);

  20715 46 002336   000066 235007                    LDA     54,DL
        46 002337   500002 755100                    STA     2,,PR5
        46 002340   021307 710000 46                 TRA     s:26924

      825    20716    4                ELSE IF PILL -> ETT.LOP -> ETT.ID = %TRIAD THEN

  20716 46 002341   700000 223100                    LDX3    0,,PR7
        46 002342   000015 103003                    CMPX3   13,DU
        46 002343   002352 601000 46                 TNZ     s:20722

      826    20717    5                  DO;

      827    20718    5                    PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 9);

  20718 46 002344   000074 235007                    LDA     60,DL
        46 002345   500002 755100                    STA     2,,PR5

      828    20719    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:239  

  20719 46 002346   000000 474500                    LDP4    0,,PR0
        46 002347   000004 236007                    LDQ     4,DL
        46 002350   400004 256100                    ORSQ    4,,PR4

      829    20720    5                  END;

  20720 46 002351   021307 710000 46                 TRA     s:26924

      830    20721    4                ELSE
      831    20722    4                  PCOM.CABS = %(MVANO_BYTE_0 * 3);

  20722 46 002352   000033 235007                    LDA     27,DL
        46 002353   500002 755100                    STA     2,,PR5
        46 002354   021307 710000 46                 TRA     s:26924

      832    20723
      833    20724    4              CASE(%MVANO_BYTE_1,

      834    20725    4                   %MVANO_BYTE_2,
      835    20726    4                   %MVANO_BYTE_3);
      836    20727
      837    20728    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR

  20728 46 002355   400001 477500                    LDP7    1,,PR4
        46 002356   700004 221100                    LDX1    4,,PR7
        46 002357   000005 101003                    CMPX1   5,DU
        46 002360   002363 600000 46                 TZE     s:20731
        46 002361   000006 101003                    CMPX1   6,DU
        46 002362   002410 601000 46                 TNZ     s:20737

      838    20729    4                    PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      839    20730    5                  DO;

      840    20731    5                    PCOM.CABS = PILL -> ETT.ROP -> ETT.ROPCON * 3 + 1;

  20731 46 002363   600002 236100                    LDQ     2,,PR6
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:240  
        46 002364   000003 402007                    MPY     3,DL
        46 002365   000001 036007                    ADLQ    1,DL
        46 002366   500002 756100                    STQ     2,,PR5

      841    20732    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20732 46 002367   000000 474500                    LDP4    0,,PR0
        46 002370   000004 236007                    LDQ     4,DL
        46 002371   400004 256100                    ORSQ    4,,PR4

      842    20733    5                    IF PCOM.ROPND -> ETT.STATE = %ARA OR

  20733 46 002372   500053 471500                    LDP1    43,,PR5
        46 002373   100004 220100                    LDX0    4,,PR1
        46 002374   000005 100003                    CMPX0   5,DU
        46 002375   002400 600000 46                 TZE     s:20735
        46 002376   000006 100003                    CMPX0   6,DU
        46 002377   021307 601000 46                 TNZ     s:26924

      843    20734    5                        PCOM.ROPND -> ETT.STATE = %ARQ THEN
      844    20735    5                      CALL Z8HG$SAVE (PCOM.ROPND);

  20735 46 002400   200004 236100                    LDQ     @PCOM,,AUTO
        46 002401   000053 036003                    ADLQ    43,DU
        46 002402   200302 756100                    STQ     ORG1+1,,AUTO
        46 002403   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 002404   000000 631400 47                 EPPR1   0
        46 002405   000000 701000 xent               TSX1    Z8HG$SAVE
        46 002406   000000 011000                    NOP     0

      845    20736    5                  END;

  20736 46 002407   021307 710000 46                 TRA     s:26924

      846    20737    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARA OR

  20737 46 002410   000005 100003                    CMPX0   5,DU
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:241  
        46 002411   002414 600000 46                 TZE     s:20739
        46 002412   000006 100003                    CMPX0   6,DU
        46 002413   002421 601000 46                 TNZ     s:20740

      847    20738    4                    PCOM.ROPND -> ETT.STATE = %ARQ THEN
      848    20739    4                  PCOM.CABS = PILL -> ETT.ROP -> ETT.ROPCON * 3 + 2;

  20739 46 002414   600002 236100                    LDQ     2,,PR6
        46 002415   000003 402007                    MPY     3,DL
        46 002416   000002 036007                    ADLQ    2,DL
        46 002417   500002 756100                    STQ     2,,PR5
        46 002420   021307 710000 46                 TRA     s:26924

      849    20740    4                ELSE IF PCOM.ROPND -> ETT.ID = %TRIAD THEN

  20740 46 002421   100000 222100                    LDX2    0,,PR1
        46 002422   000015 102003                    CMPX2   13,DU
        46 002423   002427 601000 46                 TNZ     s:20743

      850    20741    4                  PCOM.CABS = %(MVANO_BYTES_2_3 * 3 - MVANO_BYTE_0 + 3)

  20741 46 002424   000055 035007                    ADLA    45,DL
        46 002425   500002 755100                    STA     2,,PR5
        46 002426   021307 710000 46                 TRA     s:26924

      851    20742    4                      + PILL -> ETT.ROP -> ETT.ROPCON;
      852    20743    4                ELSE IF PILL -> ILL.LOP -> ETT.ID = %TRIAD THEN

  20743 46 002427   700000 223100                    LDX3    0,,PR7
        46 002430   000015 103003                    CMPX3   13,DU
        46 002431   002440 601000 46                 TNZ     s:20750

      853    20744    5                  DO;

      854    20745    5                    PCOM.CABS = %(MVANO_BYTES_2_3 * 3 - MVANO_BYTE_0 + 9)

  20745 46 002432   000063 035007                    ADLA    51,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:242  
        46 002433   500002 755100                    STA     2,,PR5

      855    20746    5                        + PILL -> ETT.ROP -> ETT.ROPCON;
      856    20747    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20747 46 002434   000000 474500                    LDP4    0,,PR0
        46 002435   000004 236007                    LDQ     4,DL
        46 002436   400004 256100                    ORSQ    4,,PR4

      857    20748    5                  END;

  20748 46 002437   021307 710000 46                 TRA     s:26924

      858    20749    4                ELSE
      859    20750    4                  PCOM.CABS = PILL -> ETT.ROP -> ETT.ROPCON * 3;

  20750 46 002440   600002 236100                    LDQ     2,,PR6
        46 002441   000003 402007                    MPY     3,DL
        46 002442   500002 756100                    STQ     2,,PR5
        46 002443   021307 710000 46                 TRA     s:26924

      860    20751
      861    20752    4              CASE(%MVANO_BYTES_1_2);

      862    20753
      863    20754    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR

  20754 46 002444   400001 477500                    LDP7    1,,PR4
        46 002445   700004 221100                    LDX1    4,,PR7
        46 002446   000005 101003                    CMPX1   5,DU
        46 002447   002452 600000 46                 TZE     s:20757
        46 002450   000006 101003                    CMPX1   6,DU
        46 002451   002502 601000 46                 TNZ     s:20769

      864    20755    4                    PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      865    20756    5                  DO;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:243  
      866    20757    5                    IF PCOM.ROPND -> ETT.STATE = %ARA OR

  20757 46 002452   000005 100003                    CMPX0   5,DU
        46 002453   002456 600000 46                 TZE     s:20759
        46 002454   000006 100003                    CMPX0   6,DU
        46 002455   002461 601000 46                 TNZ     s:20762

      867    20758    5                        PCOM.ROPND -> ETT.STATE = %ARQ THEN
      868    20759    5                      PCOM.CABS = %(MVANO_BYTES_0_1 * 3 + 2);

  20759 46 002456   000062 235007                    LDA     50,DL
        46 002457   500002 755100                    STA     2,,PR5
        46 002460   021307 710000 46                 TRA     s:26924

      869    20760    5                    ELSE
      870    20761    6                      DO;

      871    20762    6                        PCOM.CABS = %(MVANO_BYTES_1_2 * 3 + 1);

  20762 46 002461   000050 235007                    LDA     40,DL
        46 002462   500002 755100                    STA     2,,PR5

      872    20763    6                        IF PILL -> ETT.LOP -> ETT.STATE = %ARA THEN

  20763 46 002463   000000 474500                    LDP4    0,,PR0
        46 002464   400001 476500                    LDP6    1,,PR4
        46 002465   600004 220100                    LDX0    4,,PR6
        46 002466   000005 100003                    CMPX0   5,DU
        46 002467   002475 601000 46                 TNZ     s:20766

      873    20764    6                          CALL Z8HG$FREE_REGISTER (%ARQ);

  20764 46 002470   000021 630400 47                 EPPR0   17
        46 002471   000000 631400 47                 EPPR1   0
        46 002472   000000 701000 xent               TSX1    Z8HG$FREE_REGISTER
        46 002473   000000 011000                    NOP     0
        46 002474   021307 710000 46                 TRA     s:26924
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:244  

      874    20765    6                        ELSE
      875    20766    6                          CALL Z8HG$FREE_REGISTER (%ARA);

  20766 46 002475   000023 630400 47                 EPPR0   19
        46 002476   000000 631400 47                 EPPR1   0
        46 002477   000000 701000 xent               TSX1    Z8HG$FREE_REGISTER
        46 002500   000000 011000                    NOP     0

      876    20767    6                      END;

      877    20768    5                  END;

  20768 46 002501   021307 710000 46                 TRA     s:26924

      878    20769    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARA OR

  20769 46 002502   000005 100003                    CMPX0   5,DU
        46 002503   002506 600000 46                 TZE     s:20772
        46 002504   000006 100003                    CMPX0   6,DU
        46 002505   002525 601000 46                 TNZ     s:20779

      879    20770    4                    PCOM.ROPND -> ETT.STATE = %ARQ THEN
      880    20771    5                  DO;

      881    20772    5                    PCOM.CABS = %(MVANO_BYTES_1_2 * 3 + 2);

  20772 46 002506   000051 235007                    LDA     41,DL
        46 002507   500002 755100                    STA     2,,PR5

      882    20773    5                    IF PCOM.ROPND -> ETT.STATE = %ARA THEN

  20773 46 002510   100004 220100                    LDX0    4,,PR1
        46 002511   000005 100003                    CMPX0   5,DU
        46 002512   002520 601000 46                 TNZ     s:20776

      883    20774    5                      CALL Z8HG$FREE_REGISTER (%ARQ);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:245  

  20774 46 002513   000021 630400 47                 EPPR0   17
        46 002514   000000 631400 47                 EPPR1   0
        46 002515   000000 701000 xent               TSX1    Z8HG$FREE_REGISTER
        46 002516   000000 011000                    NOP     0
        46 002517   021307 710000 46                 TRA     s:26924

      884    20775    5                    ELSE
      885    20776    5                      CALL Z8HG$FREE_REGISTER (%ARA);

  20776 46 002520   000023 630400 47                 EPPR0   19
        46 002521   000000 631400 47                 EPPR1   0
        46 002522   000000 701000 xent               TSX1    Z8HG$FREE_REGISTER
        46 002523   000000 011000                    NOP     0

      886    20777    5                  END;

  20777 46 002524   021307 710000 46                 TRA     s:26924

      887    20778    4                ELSE
      888    20779    4                  PCOM.CABS = %(MVANO_BYTES_1_2 * 3);

  20779 46 002525   000047 235007                    LDA     39,DL
        46 002526   500002 755100                    STA     2,,PR5
        46 002527   021307 710000 46                 TRA     s:26924

      889    20780
      890    20781    4              CASE(%MVANO_BYTES_0_2);

      891    20782
      892    20783    4                IF PCOM.ROPND -> ETT.STATE = %ARA OR

  20783 46 002530   000005 100003                    CMPX0   5,DU
        46 002531   002534 600000 46                 TZE     s:20786
        46 002532   000006 100003                    CMPX0   6,DU
        46 002533   002554 601000 46                 TNZ     s:20791

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:246  
      893    20784    4                    PCOM.ROPND -> ETT.STATE = %ARQ THEN
      894    20785    5                  DO;

      895    20786    5                    PCOM.CABS = %(MVANO_BYTES_0_2 * 3 + 2);

  20786 46 002534   000054 235007                    LDA     44,DL
        46 002535   500002 755100                    STA     2,,PR5

      896    20787    5                    IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR

  20787 46 002536   000000 474500                    LDP4    0,,PR0
        46 002537   400001 476500                    LDP6    1,,PR4
        46 002540   600004 220100                    LDX0    4,,PR6
        46 002541   000005 100003                    CMPX0   5,DU
        46 002542   002545 600000 46                 TZE     s:20789
        46 002543   000006 100003                    CMPX0   6,DU
        46 002544   021307 601000 46                 TNZ     s:26924

      897    20788    5                        PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      898    20789    5                      CALL Z8HG$SAVE (PILL -> ETT.LOP);

  20789 46 002545   400001 637500                    EPPR7   1,,PR4
        46 002546   200302 457500                    STP7    ORG1+1,,AUTO
        46 002547   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 002550   000000 631400 47                 EPPR1   0
        46 002551   000000 701000 xent               TSX1    Z8HG$SAVE
        46 002552   000000 011000                    NOP     0

      899    20790    5                  END;

  20790 46 002553   021307 710000 46                 TRA     s:26924

      900    20791    4                ELSE IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR

  20791 46 002554   400001 477500                    LDP7    1,,PR4
        46 002555   700004 221100                    LDX1    4,,PR7
        46 002556   000005 101003                    CMPX1   5,DU
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:247  
        46 002557   002562 600000 46                 TZE     s:20794
        46 002560   000006 101003                    CMPX1   6,DU
        46 002561   002570 601000 46                 TNZ     s:20797

      901    20792    4                    PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      902    20793    5                  DO;

      903    20794    5                    PCOM.CABS = %(MVANO_BYTES_0_2 * 3 + 1);

  20794 46 002562   000053 235007                    LDA     43,DL
        46 002563   500002 755100                    STA     2,,PR5

      904    20795    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20795 46 002564   000000 474500                    LDP4    0,,PR0
        46 002565   000004 236007                    LDQ     4,DL
        46 002566   400004 256100                    ORSQ    4,,PR4

      905    20796    5                  END;

  20796 46 002567   021307 710000 46                 TRA     s:26924

      906    20797    4                ELSE IF PCOM.ROPND -> ETT.ID = %TRIAD THEN

  20797 46 002570   100000 222100                    LDX2    0,,PR1
        46 002571   000015 102003                    CMPX2   13,DU
        46 002572   002576 601000 46                 TNZ     s:20799

      907    20798    4                  PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 7);

  20798 46 002573   000072 235007                    LDA     58,DL
        46 002574   500002 755100                    STA     2,,PR5
        46 002575   021307 710000 46                 TRA     s:26924

      908    20799    4                ELSE IF PILL -> ETT.LOP -> ETT.ID = %TRIAD THEN

  20799 46 002576   700000 223100                    LDX3    0,,PR7
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:248  
        46 002577   000015 103003                    CMPX3   13,DU
        46 002600   002607 601000 46                 TNZ     s:20805

      909    20800    5                  DO;

      910    20801    5                    PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 13);

  20801 46 002601   000100 235007                    LDA     64,DL
        46 002602   500002 755100                    STA     2,,PR5

      911    20802    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20802 46 002603   000000 474500                    LDP4    0,,PR0
        46 002604   000004 236007                    LDQ     4,DL
        46 002605   400004 256100                    ORSQ    4,,PR4

      912    20803    5                  END;

  20803 46 002606   021307 710000 46                 TRA     s:26924

      913    20804    4                ELSE
      914    20805    4                  PCOM.CABS = %(MVANO_BYTES_0_2 * 3);

  20805 46 002607   000052 235007                    LDA     42,DL
        46 002610   500002 755100                    STA     2,,PR5
        46 002611   021307 710000 46                 TRA     s:26924

      915    20806
      916    20807    4              CASE(%MVANO_BYTES_1_3);

      917    20808
      918    20809    4                IF PILL -> ETT.LOP -> ETT.STATE = %ARA OR

  20809 46 002612   400001 477500                    LDP7    1,,PR4
        46 002613   700004 221100                    LDX1    4,,PR7
        46 002614   000005 101003                    CMPX1   5,DU
        46 002615   002620 600000 46                 TZE     s:20812
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:249  
        46 002616   000006 101003                    CMPX1   6,DU
        46 002617   002632 601000 46                 TNZ     s:20818

      919    20810    4                    PILL -> ETT.LOP -> ETT.STATE = %ARQ THEN
      920    20811    5                  DO;

      921    20812    5                    IF PCOM.ROPND -> ETT.STATE = %ARA OR

  20812 46 002620   000005 100003                    CMPX0   5,DU
        46 002621   002624 600000 46                 TZE     s:20814
        46 002622   000006 100003                    CMPX0   6,DU
        46 002623   002627 601000 46                 TNZ     s:20816

      922    20813    5                        PCOM.ROPND -> ETT.STATE = %ARQ THEN
      923    20814    5                      PCOM.CABS = %(MVANO_BYTES_1_3 * 3 + 4);

  20814 46 002624   000061 235007                    LDA     49,DL
        46 002625   500002 755100                    STA     2,,PR5
        46 002626   021307 710000 46                 TRA     s:26924

      924    20815    5                    ELSE
      925    20816    5                      PCOM.CABS = %(MVANO_BYTES_1_3 * 3 + 1);

  20816 46 002627   000056 235007                    LDA     46,DL
        46 002630   500002 755100                    STA     2,,PR5

      926    20817    5                  END;

  20817 46 002631   021307 710000 46                 TRA     s:26924

      927    20818    4                ELSE IF PCOM.ROPND -> ETT.STATE = %ARA OR

  20818 46 002632   000005 100003                    CMPX0   5,DU
        46 002633   002636 600000 46                 TZE     s:20820
        46 002634   000006 100003                    CMPX0   6,DU
        46 002635   002641 601000 46                 TNZ     s:20821

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:250  
      928    20819    4                    PCOM.ROPND -> ETT.STATE = %ARQ THEN
      929    20820    4                  PCOM.CABS = %(MVANO_BYTES_1_3 * 3 + 2);

  20820 46 002636   000057 235007                    LDA     47,DL
        46 002637   500002 755100                    STA     2,,PR5
        46 002640   021307 710000 46                 TRA     s:26924

      930    20821    4                ELSE IF PCOM.ROPND -> ETT.ID = %TRIAD THEN

  20821 46 002641   100000 222100                    LDX2    0,,PR1
        46 002642   000015 102003                    CMPX2   13,DU
        46 002643   002647 601000 46                 TNZ     s:20823

      931    20822    4                  PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 8);

  20822 46 002644   000073 235007                    LDA     59,DL
        46 002645   500002 755100                    STA     2,,PR5
        46 002646   021307 710000 46                 TRA     s:26924

      932    20823    4                ELSE IF PILL -> ETT.LOP -> ETT.ID = %TRIAD THEN

  20823 46 002647   700000 223100                    LDX3    0,,PR7
        46 002650   000015 103003                    CMPX3   13,DU
        46 002651   002660 601000 46                 TNZ     s:20829

      933    20824    5                  DO;

      934    20825    5                    PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 14);

  20825 46 002652   000101 235007                    LDA     65,DL
        46 002653   500002 755100                    STA     2,,PR5

      935    20826    5                    PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20826 46 002654   000000 474500                    LDP4    0,,PR0
        46 002655   000004 236007                    LDQ     4,DL
        46 002656   400004 256100                    ORSQ    4,,PR4
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:251  

      936    20827    5                  END;

  20827 46 002657   021307 710000 46                 TRA     s:26924

      937    20828    4                ELSE
      938    20829    4                  PCOM.CABS = %(MVANO_BYTES_1_3 * 3);

  20829 46 002660   000055 235007                    LDA     45,DL
        46 002661   500002 755100                    STA     2,,PR5
        46 002662   021307 710000 46                 TRA     s:26924

      939    20830
      940    20831    4              CASE(%MVANO_BYTES_0_1); /* ROPND is always register-contained */

      941    20832
      942    20833    4                IF PILL -> ETT.LOP -> ETT.STATE >= %ARA THEN

  20833 46 002663   400001 477500                    LDP7    1,,PR4
        46 002664   700004 221100                    LDX1    4,,PR7
        46 002665   000005 101003                    CMPX1   5,DU
        46 002666   002675 602000 46                 TNC     s:20835

      943    20834    4                  CALL Z8HG$SAVE (PILL -> ETT.LOP);

  20834 46 002667   400001 630500                    EPPR0   1,,PR4
        46 002670   200302 450500                    STP0    ORG1+1,,AUTO
        46 002671   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 002672   000000 631400 47                 EPPR1   0
        46 002673   000000 701000 xent               TSX1    Z8HG$SAVE
        46 002674   000000 011000                    NOP     0

      944    20835    4                PCOM.CABS = %(MVANO_BYTES_0_1 * 3);

  20835 46 002675   000060 235007                    LDA     48,DL
        46 002676   200004 470500                    LDP0    @PCOM,,AUTO
        46 002677   000002 755100                    STA     2,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:252  

      945    20836    4                IF PCOM.ROPND -> ETT.STATE = %ARA

  20836 46 002700   000053 471500                    LDP1    43,,PR0
        46 002701   100004 220100                    LDX0    4,,PR1
        46 002702   000005 100003                    CMPX0   5,DU
        46 002703   002707 601000 46                 TNZ     s:20838

      946    20837    4                  THEN PCOM.GABS = 1; /* ,AU modification */

  20837 46 002704   000001 236007                    LDQ     1,DL
        46 002705   000006 756100                    STQ     6,,PR0
        46 002706   002711 710000 46                 TRA     s:20839

      947    20838    4                  ELSE PCOM.GABS = 2; /* ,QU modification */

  20838 46 002707   000002 236007                    LDQ     2,DL
        46 002710   000006 756100                    STQ     6,,PR0

      948    20839    4                PILL -> ETT.B.REVERSED_RELATE = TRUE;

  20839 46 002711   200003 473500                    LDP3    @PILL,,AUTO
        46 002712   300000 474500                    LDP4    0,,PR3
        46 002713   000004 236007                    LDQ     4,DL
        46 002714   400004 256100                    ORSQ    4,,PR4
        46 002715   021307 710000 46                 TRA     s:26924

      949    20840
      950    20841    4              CASE(%MVANO_BYTES_2_3); /* ROPND is always register-contained */

      951    20842
      952    20843    4                IF PILL -> ETT.LOP -> ETT.STATE >= %ARA THEN

  20843 46 002716   400001 477500                    LDP7    1,,PR4
        46 002717   700004 221100                    LDX1    4,,PR7
        46 002720   000005 101003                    CMPX1   5,DU
        46 002721   002730 602000 46                 TNC     s:20845
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:253  

      953    20844    4                  CALL Z8HG$SAVE (PILL -> ETT.LOP);

  20844 46 002722   400001 630500                    EPPR0   1,,PR4
        46 002723   200302 450500                    STP0    ORG1+1,,AUTO
        46 002724   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 002725   000000 631400 47                 EPPR1   0
        46 002726   000000 701000 xent               TSX1    Z8HG$SAVE
        46 002727   000000 011000                    NOP     0

      954    20845    4                PCOM.CABS = %(MVANO_BYTES_2_3 * 3);

  20845 46 002730   000063 235007                    LDA     51,DL
        46 002731   200004 470500                    LDP0    @PCOM,,AUTO
        46 002732   000002 755100                    STA     2,,PR0

      955    20846
      956    20847    4            END; /* CASE */

  20847 46 002733   021307 710000 46                 TRA     s:26924

      957    20848
      958    20849    3          CASE(%SECOND_PASS);

      959    20850
      960    20851                 %NEW_ORG (@ST$ = COMCOM.LAST_BLOCK$);

  20869 46 002734   000002 236000 36                 LDQ     OBJ_+2
        46 002735   000002 036007                    ADLQ    2,DL
        46 002736   000003 116000 36                 CMPQ    OBJ_+3
        46 002737   002751 604000 46                 TMI     s:20875

  20871 46 002740   000000 234000 30                 SZN     PAGING_OBJ
        46 002741   002746 605000 46                 TPL     s:20873

  20872 46 002742   000006 630400 47                 EPPR0   6
        46 002743   000000 631400 47                 EPPR1   0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:254  
        46 002744   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 002745   000000 011000                    NOP     0

  20873 46 002746   000007 631400 47                 EPPR1   7
        46 002747   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 002750   000000 011000                    NOP     0

  20875 46 002751   000002 236000 36                 LDQ     OBJ_+2
        46 002752   000022 736000                    QLS     18
        46 002753   000001 036000 36                 ADLQ    OBJ_+1
        46 002754   000000 756000 29                 STQ     OBJ$

  20876 46 002755   000002 236007                    LDQ     2,DL
        46 002756   000002 056000 36                 ASQ     OBJ_+2

  20877 46 002757   001013 220003                    LDX0    523,DU
        46 002760   000000 470400 29                 LDP0    OBJ$
        46 002761   000000 740100                    STX0    0,,PR0

  20881 46 002762   000375 236000 xsym               LDQ     COMCOM+253
        46 002763   000000 470400 29                 LDP0    OBJ$
        46 002764   000001 756100                    STQ     1,,PR0

      961    20887
      962    20888    3            IF PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 8) OR

  20888 46 002765   200004 471500                    LDP1    @PCOM,,AUTO
        46 002766   100002 235100                    LDA     2,,PR1
        46 002767   000073 115007                    CMPA    59,DL
        46 002770   002773 600000 46                 TZE     s:20890
        46 002771   000101 115007                    CMPA    65,DL
        46 002772   002776 601000 46                 TNZ     s:20891

      963    20889    3                PCOM.CABS = %(MVANO_BYTES_2_3 * 3 + 14)
      964    20890    3              THEN INST_WORD = '000777777777'O;

  20890 46 002773   000014 236000 44                 LDQ     NIL_EPTR+1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:255  
        46 002774   200012 756100                    STQ     INST_WORD,,AUTO
        46 002775   003000 710000 46                 TRA     s:20913

      965    20891    3              ELSE INST_WORD = '777777777000'O;

  20891 46 002776   000015 236000 44                 LDQ     NIL_EPTR+2
        46 002777   200012 756100                    STQ     INST_WORD,,AUTO

      966    20892                 %NEW_WORD (@OU_WORD = INST_WORD,
      967    20893                            @OFFSET = PCOM.NOPND -> ETT.LOP -> TEMP.SA,
      968    20894                            @ADVANCE_BLOCK_SIZE = NO);

  20913 46 003000   000002 236000 36                 LDQ     OBJ_+2
        46 003001   000004 036007                    ADLQ    4,DL
        46 003002   000003 116000 36                 CMPQ    OBJ_+3
        46 003003   003015 604000 46                 TMI     s:20919

  20915 46 003004   000000 234000 30                 SZN     PAGING_OBJ
        46 003005   003012 605000 46                 TPL     s:20917

  20916 46 003006   000006 630400 47                 EPPR0   6
        46 003007   000000 631400 47                 EPPR1   0
        46 003010   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 003011   000000 011000                    NOP     0

  20917 46 003012   000007 631400 47                 EPPR1   7
        46 003013   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 003014   000000 011000                    NOP     0

  20919 46 003015   000002 236000 36                 LDQ     OBJ_+2
        46 003016   000022 736000                    QLS     18
        46 003017   000001 036000 36                 ADLQ    OBJ_+1
        46 003020   000000 756000 29                 STQ     OBJ$

  20920 46 003021   000004 236007                    LDQ     4,DL
        46 003022   000002 056000 36                 ASQ     OBJ_+2

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:256  
  20921 46 003023   001012 220003                    LDX0    522,DU
        46 003024   000000 470400 29                 LDP0    OBJ$
        46 003025   000000 740100                    STX0    0,,PR0

  20924 46 003026   000005 236000 47                 LDQ     5
        46 003027   000000 470400 29                 LDP0    OBJ$
        46 003030   000002 756100                    STQ     2,,PR0

  20925 46 003031   200004 471500                    LDP1    @PCOM,,AUTO
        46 003032   100047 473500                    LDP3    39,,PR1
        46 003033   300001 474500                    LDP4    1,,PR3
        46 003034   400001 236100                    LDQ     1,,PR4
        46 003035   000022 772000                    QRL     18
        46 003036   000001 756100                    STQ     1,,PR0

  20926 46 003037   000000 236003                    LDQ     0,DU
        46 003040   000000 552110                    STBQ    0,'10'O,PR0

  20928 46 003041   200012 236100                    LDQ     INST_WORD,,AUTO
        46 003042   000000 470400 29                 LDP0    OBJ$
        46 003043   000003 756100                    STQ     3,,PR0

      969    20941
      970    20942                 %NEW_ORG (@ST$ = "COMCOM.SEGMENT$(%PROC)");

  20960 46 003044   000002 236000 36                 LDQ     OBJ_+2
        46 003045   000002 036007                    ADLQ    2,DL
        46 003046   000003 116000 36                 CMPQ    OBJ_+3
        46 003047   003061 604000 46                 TMI     s:20966

  20962 46 003050   000000 234000 30                 SZN     PAGING_OBJ
        46 003051   003056 605000 46                 TPL     s:20964

  20963 46 003052   000006 630400 47                 EPPR0   6
        46 003053   000000 631400 47                 EPPR1   0
        46 003054   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 003055   000000 011000                    NOP     0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:257  

  20964 46 003056   000007 631400 47                 EPPR1   7
        46 003057   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 003060   000000 011000                    NOP     0

  20966 46 003061   000002 236000 36                 LDQ     OBJ_+2
        46 003062   000022 736000                    QLS     18
        46 003063   000001 036000 36                 ADLQ    OBJ_+1
        46 003064   000000 756000 29                 STQ     OBJ$

  20967 46 003065   000002 236007                    LDQ     2,DL
        46 003066   000002 056000 36                 ASQ     OBJ_+2

  20968 46 003067   001013 220003                    LDX0    523,DU
        46 003070   000000 470400 29                 LDP0    OBJ$
        46 003071   000000 740100                    STX0    0,,PR0

  20972 46 003072   000150 236000 xsym               LDQ     COMCOM+104
        46 003073   000000 470400 29                 LDP0    OBJ$
        46 003074   000001 756100                    STQ     1,,PR0

      971    20978
      972    20979    3        END; /* CASE */

  20979 46 003075   021307 710000 46                 TRA     s:26924

      973    20980
      974    20981        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:258  
      975    20982    2   CASE(%CMPC);

      976    20983
      977    20984    2        IF PILL -> ILL.ROP -> ETT.ID = %TRIAD THEN

  20984 46 003076   100002 473500                    LDP3    2,,PR1
        46 003077   300000 220100                    LDX0    0,,PR3
        46 003100   000015 100003                    CMPX0   13,DU
        46 003101   003105 601000 46                 TNZ     s:20987

      978    20985    2          PCOM.DABS = 0;

  20985 46 003102   200004 474500                    LDP4    @PCOM,,AUTO
        46 003103   400003 450100                    STZ     3,,PR4
        46 003104   021307 710000 46                 TRA     s:26924

      979    20986    2        ELSE
      980    20987    2          PCOM.DABS = 1;

  20987 46 003105   000001 235007                    LDA     1,DL
        46 003106   200004 474500                    LDP4    @PCOM,,AUTO
        46 003107   400003 755100                    STA     3,,PR4
        46 003110   021307 710000 46                 TRA     s:26924

      981    20988
      982    20989        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:259  
      983    20990    2   CASE(%CMPO);

      984    20991
      985    20992    2       IF PILL -> ILL.LOP -> ETT.REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYO OR /*#42747*/

  20992 46 003111   100001 473500                    LDP3    1,,PR1
        46 003112   300003 474500                    LDP4    3,,PR3
        46 003113   400005 475500                    LDP5    5,,PR4
        46 003114   500002 220100                    LDX0    2,,PR5
        46 003115   000003 100003                    CMPX0   3,DU
        46 003116   003125 600000 46                 TZE     s:20994
        46 003117   100002 476500                    LDP6    2,,PR1
        46 003120   600003 477500                    LDP7    3,,PR6
        46 003121   700005 470500                    LDP0    5,,PR7
        46 003122   000002 220100                    LDX0    2,,PR0
        46 003123   000003 100003                    CMPX0   3,DU
        46 003124   021307 601000 46                 TNZ     s:26924

      986    20993    2            PILL -> ILL.ROP -> ETT.REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYO
      987    20994    2          THEN PCOM.GABS = BITBIN ('400000000000'O); /* ASCII */

  20994 46 003125   000016 235000 44                 LDA     NIL_EPTR+3
        46 003126   200004 470500                    LDP0    @PCOM,,AUTO
        46 003127   000006 755100                    STA     6,,PR0
        46 003130   021307 710000 46                 TRA     s:26924

      988    20995        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:260  
      989    20996    2   CASE(%CMPR, %CMPQ, %CMPI);

      990    20997        /*V*
      991    20998                   CMPR   CMPQ   CMPI
      992    20999
      993    21000                   If the rop of the comparison triad is register contained
      994    21001                and the lop is storage contained, we will generate the
      995    21002                reverse comparison to avoid an extra store instruction.
      996    21003                The transfer generated by the go item will also have to
      997    21004                be reversed if the ETT.B.REVERSED_RELATE bit is set.
      998    21005                This only applies to non-EIS comparisons.
      999    21006        */
     1000    21007    2        PILL -> ETT.B.REVERSED_RELATE = TRUE;

  21007 46 003131   000004 236007                    LDQ     4,DL
        46 003132   100004 256100                    ORSQ    4,,PR1
        46 003133   021307 710000 46                 TRA     s:26924

     1001    21008
     1002    21009        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:261  
     1003    21010    2   CASE(%CVDDD);

     1004    21011        /*V*
     1005    21012                   CVDDD
     1006    21013
     1007    21014                 Convert decimal edited to unedited decimal.  This requires
     1008    21015              a call to the library, most of which is handled in pseudo-code.
     1009    21016              The library routine needs the current currency sign, which
     1010    21017              comes from the PROC_ item of the current scope.
     1011    21018        */
     1012    21019
     1013    21020    2        CURRENCY_SIGN = CURRENT_SCOPE$ -> PROC_.PROC_SUPP$ ->

  21020 46 003134   000000 473400 18                 LDP3    CURRENT_SCOPE$
        46 003135   300001 474500                    LDP4    1,,PR3
        46 003136   400001 236100                    LDQ     1,,PR4
        46 003137   777000 376003                    ANQ     -512,DU
        46 003140   000024 276000 47                 ORQ     20
        46 003141   200252 756100                    STQ     CURRENCY_SIGN,,AUTO

     1014    21021    2                               PROC_SUPP.CURRENCY_SIGN;
     1015    21022
     1016    21023    2        CALL Z8AC$MAKE_TYA_CONST(CURRENCY_SIGN, 1, 0, PCOM.SOPND);

  21023 46 003142   200004 236100                    LDQ     @PCOM,,AUTO
        46 003143   000054 036003                    ADLQ    44,DU
        46 003144   000026 235000 47                 LDA     22
        46 003145   200304 757100                    STAQ    ORG1+3,,AUTO
        46 003146   000016 236000 47                 LDQ     14
        46 003147   200303 756100                    STQ     ORG1+2,,AUTO
        46 003150   200252 631500                    EPPR1   CURRENCY_SIGN,,AUTO
        46 003151   200302 451500                    STP1    ORG1+1,,AUTO
        46 003152   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 003153   000025 631400 47                 EPPR1   21
        46 003154   000000 701000 xent               TSX1    Z8AC$MAKE_TYA_CONST
        46 003155   000000 011000                    NOP     0
        46 003156   021307 710000 46                 TRA     s:26924
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:262  

     1017    21024        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:263  
     1018    21025    2   CASE(%CVDF, %CVDO);

     1019    21026
     1020    21027    2        TYPE_DESC.SIZ$ = ADDR(NIL);

  21027 46 003157   000005 236000 47                 LDQ     5
        46 003160   200112 756100                    STQ     TYPE_DESC+2,,AUTO

     1021    21028    2        TYPE_DESC.SSOP$ = ADDR(NIL);

  21028 46 003161   200113 756100                    STQ     TYPE_DESC+3,,AUTO

     1022    21029
     1023    21030    2        IF PILL -> ETT.ID = %CVDF THEN

  21030 46 003162   000000 471500                    LDP1    0,,PR0
        46 003163   100000 220100                    LDX0    0,,PR1
        46 003164   000020 100003                    CMPX0   16,DU
        46 003165   003201 601000 46                 TNZ     s:21037

     1024    21031    3          DO;

     1025    21032    3            IF PILL -> ETT.DESC.NDSC.S = %NO_SIGN

  21032 46 003166   100002 236100                    LDQ     2,,PR1
        46 003167   030000 376007                    ANQ     12288,DL
        46 003170   030000 116007                    CMPQ    12288,DL
        46 003171   003176 601000 46                 TNZ     s:21034

     1026    21033    3              THEN PCOM.IABS = 2;

  21033 46 003172   000002 235007                    LDA     2,DL
        46 003173   200004 473500                    LDP3    @PCOM,,AUTO
        46 003174   300010 755100                    STA     8,,PR3
        46 003175   003204 710000 46                 TRA     s:21039

     1027    21034    3              ELSE PCOM.IABS = 0;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:264  

  21034 46 003176   200004 473500                    LDP3    @PCOM,,AUTO
        46 003177   300010 450100                    STZ     8,,PR3

     1028    21035    3          END;

  21035 46 003200   003204 710000 46                 TRA     s:21039

     1029    21036    2        ELSE
     1030    21037    2          PCOM.IABS = 1;

  21037 46 003201   000001 235007                    LDA     1,DL
        46 003202   200004 473500                    LDP3    @PCOM,,AUTO
        46 003203   300010 755100                    STA     8,,PR3

     1031    21038
     1032    21039    2        IF COMCOM.OB.ELS   THEN

  21039 46 003204   000026 234000 xsym               SZN     COMCOM+22
        46 003205   003341 605000 46                 TPL     s:21127

     1033    21040    3          DO;

     1034    21041    3            IF PILL -> ETT.ID = %CVDO THEN

  21041 46 003206   000000 471500                    LDP1    0,,PR0
        46 003207   100000 220100                    LDX0    0,,PR1
        46 003210   000074 100003                    CMPX0   60,DU
        46 003211   003214 601000 46                 TNZ     s:21045

     1035    21042    3              PCOM.EABS = 0;

  21042 46 003212   300004 450100                    STZ     4,,PR3
        46 003213   021307 710000 46                 TRA     s:26924

     1036    21043    3            ELSE
     1037    21044    4              DO; /* %CVDF */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:265  

     1038    21045    4                LOP_REF$ = PILL -> ETT.LOP -> ETT.REF$;

  21045 46 003214   100001 474500                    LDP4    1,,PR1
        46 003215   400003 236100                    LDQ     3,,PR4
        46 003216   200101 756100                    STQ     LOP_REF$,,AUTO

     1039    21046    4                LOP_SIGN = LOP_REF$ -> REF.NDSC.S;

  21046 46 003217   200101 475500                    LDP5    LOP_REF$,,AUTO
        46 003220   500001 236100                    LDQ     1,,PR5
        46 003221   000026 736000                    QLS     22
        46 003222   600000 376003                    ANQ     -65536,DU
        46 003223   200130 756100                    STQ     LOP_SIGN,,AUTO

     1040    21047
     1041    21048    4                IF LOP_SIGN ~= %NO_SIGN THEN

  21048 46 003224   200130 236100                    LDQ     LOP_SIGN,,AUTO
        46 003225   600000 376003                    ANQ     -65536,DU
        46 003226   600000 116003                    CMPQ    -65536,DU
        46 003227   003337 600000 46                 TZE     s:21121

     1042    21049    5                  DO;    /* We need first to do an MVN then the

     1043    21050                                 MVNX because MVNX does not handle signed
     1044    21051                                 ASCII to EBCDIC moves. We need a temp to hold the
     1045    21052                                 results of the MVN. */
     1046    21053    5                    SCALE = LOP_REF$ -> REF.NDSC.SF;

  21053 46 003230   500001 236100                    LDQ     1,,PR5
        46 003231   000030 736000                    QLS     24
        46 003232   000036 732000                    QRS     30
        46 003233   200047 756100                    STQ     SCALE,,AUTO

     1047    21054    5                    PCOM.EABS = 1;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:266  
  21054 46 003234   000001 235007                    LDA     1,DL
        46 003235   300004 755100                    STA     4,,PR3

     1048    21055    5                    LOP_LEN = LOP_REF$ -> REF.NDSC.N;

  21055 46 003236   500001 236100                    LDQ     1,,PR5
        46 003237   000077 376007                    ANQ     63,DL
        46 003240   200077 756100                    STQ     LOP_LEN,,AUTO

     1049    21056    5                    TN = %NDSC4;

  21056 46 003241   400000 236003                    LDQ     -131072,DU
        46 003242   200045 756100                    STQ     TN,,AUTO

     1050    21057    5                    TYPE_DESC.TYPE = %TYD;

  21057 46 003243   200110 450100                    STZ     TYPE_DESC,,AUTO

     1051    21058    5                    BOUNDS = %NEXT;

  21058 46 003244   200125 450100                    STZ     BOUNDS,,AUTO

     1052    21059
     1053    21060                         %PACK_NDSC(@DESC = TYPE_DESC.DESC,
     1054    21061                                    @LENGTH = LOP_LEN,
     1055    21062                                    @TN = TN,
     1056    21063                                    @SCALE = SCALE,
     1057    21064                                    @SIGN = ROP_SIGN);

  21069 46 003245   000000 220003                    LDX0    0,DU
        46 003246   200111 740100                    STX0    TYPE_DESC+1,,AUTO

  21070 46 003247   000027 236000 47                 LDQ     23
        46 003250   200111 356100                    ANSQ    TYPE_DESC+1,,AUTO

  21071 46 003251   200045 236100                    LDQ     TN,,AUTO
        46 003252   000025 772000                    QRL     21
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:267  
        46 003253   200111 676100                    ERQ     TYPE_DESC+1,,AUTO
        46 003254   040000 376007                    ANQ     16384,DL
        46 003255   200111 656100                    ERSQ    TYPE_DESC+1,,AUTO

  21072 46 003256   200131 236100                    LDQ     ROP_SIGN,,AUTO
        46 003257   000026 772000                    QRL     22
        46 003260   200111 676100                    ERQ     TYPE_DESC+1,,AUTO
        46 003261   030000 376007                    ANQ     12288,DL
        46 003262   200111 656100                    ERSQ    TYPE_DESC+1,,AUTO

  21073 46 003263   200047 236100                    LDQ     SCALE,,AUTO
        46 003264   000006 736000                    QLS     6
        46 003265   200111 752102                    STCQ    TYPE_DESC+1,'02'O,AUTO

  21074 46 003266   200131 236100                    LDQ     ROP_SIGN,,AUTO
        46 003267   000042 772000                    QRL     34
        46 003270   000004 116007                    CMPQ    4,DL
        46 003271   003273 602006 46                 TNC     s:21074+5,QL
        46 003272   003317 710000 46                 TRA     s:21114
        46 003273   003306 710000 46                 TRA     s:21100
        46 003274   003302 710000 46                 TRA     s:21081
        46 003275   003302 710000 46                 TRA     s:21081
        46 003276   003277 710000 46                 TRA     s:21076

  21076 46 003277   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 003300   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO
        46 003301   003317 710000 46                 TRA     s:21114

  21081 46 003302   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 003303   000001 036007                    ADLQ    1,DL
        46 003304   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO
        46 003305   003317 710000 46                 TRA     s:21114

  21100 46 003306   200045 234100                    SZN     TN,,AUTO
        46 003307   003314 605000 46                 TPL     s:21103

  21101 46 003310   200077 236100                    LDQ     LOP_LEN,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:268  
        46 003311   000003 036007                    ADLQ    3,DL
        46 003312   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO
        46 003313   003317 710000 46                 TRA     s:21114

  21103 46 003314   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 003315   000002 036007                    ADLQ    2,DL
        46 003316   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO

     1058    21113
     1059    21114    5                    CALL Z8HU$ALLOT_TEMP(%N          ,/* FORMAT     */

  21114 46 003317   000026 236000 47                 LDQ     22
        46 003320   200305 756100                    STQ     ORG1+4,,AUTO
        46 003321   200110 631500                    EPPR1   TYPE_DESC,,AUTO
        46 003322   200304 451500                    STP1    ORG1+3,,AUTO
        46 003323   200125 634500                    EPPR4   BOUNDS,,AUTO
        46 003324   200303 454500                    STP4    ORG1+2,,AUTO
        46 003325   000016 236000 47                 LDQ     14
        46 003326   200302 756100                    STQ     ORG1+1,,AUTO
        46 003327   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 003330   000025 631400 47                 EPPR1   21
        46 003331   000000 701000 xent               TSX1    Z8HU$ALLOT_TEMP
        46 003332   000000 011000                    NOP     0

     1060    21115    5                                         BOUNDS      ,/* BOUNDARY   */
     1061    21116    5                                         TYPE_DESC   ,/* DESCRIPTOR */
     1062    21117    5                                         %STALE     );/* FRESHNESS  */
     1063    21118    5                    PCOM.EOPND = ETT$;

  21118 46 003333   000000 236000 5                  LDQ     ETT$
        46 003334   200004 470500                    LDP0    @PCOM,,AUTO
        46 003335   000036 756100                    STQ     30,,PR0

     1064    21119    5                  END;

  21119 46 003336   021307 710000 46                 TRA     s:26924

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:269  
     1065    21120    4                ELSE
     1066    21121    4                  PCOM.EABS = 0;

  21121 46 003337   300004 450100                    STZ     4,,PR3

     1067    21122    4              END;

     1068    21123    3          END; /* ELS */

  21123 46 003340   021307 710000 46                 TRA     s:26924

     1069    21124    2        ELSE
     1070    21125    3          DO;

     1071    21126
     1072    21127    3            LOP_LEN = PILL -> ETT.DESC.NDSC.N;

  21127 46 003341   000000 471500                    LDP1    0,,PR0
        46 003342   100002 236100                    LDQ     2,,PR1
        46 003343   000077 376007                    ANQ     63,DL
        46 003344   200077 756100                    STQ     LOP_LEN,,AUTO

     1073    21128    3            SCALE = PILL -> ETT.DESC.NDSC.SF;

  21128 46 003345   000000 471500                    LDP1    0,,PR0
        46 003346   100002 236100                    LDQ     2,,PR1
        46 003347   000030 736000                    QLS     24
        46 003350   000036 732000                    QRS     30
        46 003351   200047 756100                    STQ     SCALE,,AUTO

     1074    21129    3            LOP_SIGN = PILL -> ETT.DESC.NDSC.S;

  21129 46 003352   100002 236100                    LDQ     2,,PR1
        46 003353   000026 736000                    QLS     22
        46 003354   600000 376003                    ANQ     -65536,DU
        46 003355   200130 756100                    STQ     LOP_SIGN,,AUTO

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:270  
     1075    21130
     1076    21131    3            IF LOP_SIGN = %LEADING_SIGN THEN

  21131 46 003356   200130 236100                    LDQ     LOP_SIGN,,AUTO
        46 003357   600000 376003                    ANQ     -65536,DU
        46 003360   200000 116003                    CMPQ    65536,DU
        46 003361   003375 601000 46                 TNZ     s:21141

     1077    21132    4              DO;

     1078    21133    4                PCOM.JABS = 0; /* Flag, leading sign */

  21133 46 003362   300011 450100                    STZ     9,,PR3

     1079    21134    4                WORDS_FOR_TEMP = ((LOP_LEN + 14) / 8);

  21134 46 003363   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 003364   000016 036007                    ADLQ    14,DL
        46 003365   000010 506007                    DIV     8,DL
        46 003366   200123 756100                    STQ     WORDS_FOR_TEMP,,AUTO

     1080    21135    4                BOUNDS = %EVEN;

  21135 46 003367   000002 235007                    LDA     2,DL
        46 003370   200125 755100                    STA     BOUNDS,,AUTO

     1081    21136    4               LDAQ_OFFSET = 0; /* Word offset to doubleword with sign, first digit */

  21136 46 003371   200126 450100                    STZ     LDAQ_OFFSET,,AUTO

     1082    21137    4                MVN_OFFSET = 7; /* Digit offset to sign */

  21137 46 003372   000007 235007                    LDA     7,DL
        46 003373   200127 755100                    STA     MVN_OFFSET,,AUTO

     1083    21138    4              END;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:271  
  21138 46 003374   003425 710000 46                 TRA     s:21153

     1084    21139    3            ELSE
     1085    21140    4              DO;

     1086    21141    4                PCOM.JABS = 1; /* Flag, trailing sign */

  21141 46 003375   000001 235007                    LDA     1,DL
        46 003376   300011 755100                    STA     9,,PR3

     1087    21142    4                WORDS_FOR_TEMP = ((LOP_LEN + 15) / 8);

  21142 46 003377   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 003400   000017 036007                    ADLQ    15,DL
        46 003401   000010 506007                    DIV     8,DL
        46 003402   200123 756100                    STQ     WORDS_FOR_TEMP,,AUTO

     1088    21143
     1089    21144    4                IF MOD(WORDS_FOR_TEMP,2) = 0 THEN

  21144 46 003403   000002 506007                    DIV     2,DL
        46 003404   000044 733000                    LRS     36
        46 003405   000000 116003                    CMPQ    0,DU
        46 003406   003412 601000 46                 TNZ     s:21147

     1090    21145    4                  BOUNDS = %EVEN;

  21145 46 003407   000002 235007                    LDA     2,DL
        46 003410   200125 755100                    STA     BOUNDS,,AUTO
        46 003411   003414 710000 46                 TRA     s:21149

     1091    21146    4                ELSE
     1092    21147    4                  BOUNDS = %ODD;

  21147 46 003412   000001 235007                    LDA     1,DL
        46 003413   200125 755100                    STA     BOUNDS,,AUTO

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:272  
     1093    21148
     1094    21149    4                LDAQ_OFFSET = WORDS_FOR_TEMP - 2;
             21149                         /* Word offset to doubleword with last digit, sign */

  21149 46 003414   200123 236100                    LDQ     WORDS_FOR_TEMP,,AUTO
        46 003415   000002 136007                    SBLQ    2,DL
        46 003416   200126 756100                    STQ     LDAQ_OFFSET,,AUTO

     1095    21150    4                MVN_OFFSET = ((WORDS_FOR_TEMP - 1) * 8) - LOP_LEN;
             21150                         /* Digit offset to sign */

  21150 46 003417   200123 336100                    LCQ     WORDS_FOR_TEMP,,AUTO
        46 003420   000003 736000                    QLS     3
        46 003421   200077 036100                    ADLQ    LOP_LEN,,AUTO
        46 003422   000030 676000 47                 ERQ     24
        46 003423   000007 136007                    SBLQ    7,DL
        46 003424   200127 756100                    STQ     MVN_OFFSET,,AUTO

     1096    21151    4              END;

     1097    21152
     1098    21153    3            TN = %NDSC4;

  21153 46 003425   400000 236003                    LDQ     -131072,DU
        46 003426   200045 756100                    STQ     TN,,AUTO

     1099    21154    3            TYPE_DESC.TYPE = %TYO;

  21154 46 003427   000003 235007                    LDA     3,DL
        46 003430   200110 755100                    STA     TYPE_DESC,,AUTO

     1100    21155    3            LENGTH = WORDS_FOR_TEMP *  8;

  21155 46 003431   200123 235100                    LDA     WORDS_FOR_TEMP,,AUTO
        46 003432   000003 735000                    ALS     3
        46 003433   200050 755100                    STA     LENGTH,,AUTO

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:273  
     1101    21156
     1102    21157                 %PACK_NDSC ( @DESC      = TYPE_DESC.DESC ,
     1103    21158                              @LENGTH    = LENGTH ,
     1104    21159                              @SIGN      = SIGN ,
     1105    21160                              @TN        = TN ,
     1106    21161                              @SCALE     = SCALE );

  21166 46 003434   000000 220003                    LDX0    0,DU
        46 003435   200111 740100                    STX0    TYPE_DESC+1,,AUTO

  21167 46 003436   000027 236000 47                 LDQ     23
        46 003437   200111 356100                    ANSQ    TYPE_DESC+1,,AUTO

  21168 46 003440   200045 236100                    LDQ     TN,,AUTO
        46 003441   000025 772000                    QRL     21
        46 003442   200111 676100                    ERQ     TYPE_DESC+1,,AUTO
        46 003443   040000 376007                    ANQ     16384,DL
        46 003444   200111 656100                    ERSQ    TYPE_DESC+1,,AUTO

  21169 46 003445   200044 236100                    LDQ     SIGN,,AUTO
        46 003446   000026 772000                    QRL     22
        46 003447   200111 676100                    ERQ     TYPE_DESC+1,,AUTO
        46 003450   030000 376007                    ANQ     12288,DL
        46 003451   200111 656100                    ERSQ    TYPE_DESC+1,,AUTO

  21170 46 003452   200047 236100                    LDQ     SCALE,,AUTO
        46 003453   000006 736000                    QLS     6
        46 003454   200111 752102                    STCQ    TYPE_DESC+1,'02'O,AUTO

  21171 46 003455   200044 236100                    LDQ     SIGN,,AUTO
        46 003456   000042 772000                    QRL     34
        46 003457   000004 116007                    CMPQ    4,DL
        46 003460   003462 602006 46                 TNC     s:21171+5,QL
        46 003461   003506 710000 46                 TRA     s:21211
        46 003462   003475 710000 46                 TRA     s:21197
        46 003463   003471 710000 46                 TRA     s:21178
        46 003464   003471 710000 46                 TRA     s:21178
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:274  
        46 003465   003466 710000 46                 TRA     s:21173

  21173 46 003466   200050 236100                    LDQ     LENGTH,,AUTO
        46 003467   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO
        46 003470   003506 710000 46                 TRA     s:21211

  21178 46 003471   200050 236100                    LDQ     LENGTH,,AUTO
        46 003472   000001 036007                    ADLQ    1,DL
        46 003473   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO
        46 003474   003506 710000 46                 TRA     s:21211

  21197 46 003475   200045 234100                    SZN     TN,,AUTO
        46 003476   003503 605000 46                 TPL     s:21200

  21198 46 003477   200050 236100                    LDQ     LENGTH,,AUTO
        46 003500   000003 036007                    ADLQ    3,DL
        46 003501   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO
        46 003502   003506 710000 46                 TRA     s:21211

  21200 46 003503   200050 236100                    LDQ     LENGTH,,AUTO
        46 003504   000002 036007                    ADLQ    2,DL
        46 003505   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO

     1107    21210
     1108    21211    3            CALL Z8HU$ALLOT_TEMP(%N               ,/* Format          */

  21211 46 003506   000026 236000 47                 LDQ     22
        46 003507   200305 756100                    STQ     ORG1+4,,AUTO
        46 003510   200110 631500                    EPPR1   TYPE_DESC,,AUTO
        46 003511   200304 451500                    STP1    ORG1+3,,AUTO
        46 003512   200125 634500                    EPPR4   BOUNDS,,AUTO
        46 003513   200303 454500                    STP4    ORG1+2,,AUTO
        46 003514   000016 236000 47                 LDQ     14
        46 003515   200302 756100                    STQ     ORG1+1,,AUTO
        46 003516   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 003517   000025 631400 47                 EPPR1   21
        46 003520   000000 701000 xent               TSX1    Z8HU$ALLOT_TEMP
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:275  
        46 003521   000000 011000                    NOP     0

     1109    21212    3                                 BOUNDS           ,/* Boundary        */
     1110    21213    3                                 TYPE_DESC        ,/* Descriptor      */
     1111    21214    3                                 %STALE          );/* Reuse a temp    */
     1112    21215
     1113    21216    3            TEMP$ = ETT$;

  21216 46 003522   000000 236000 5                  LDQ     ETT$
        46 003523   200124 756100                    STQ     TEMP$,,AUTO

     1114    21217
     1115    21218                 %#OFF#(@FROM=TEMP$,@TO=PCOM.LOPND,@VALUE=LDAQ_OFFSET,@TYPE=%WORD_);

  21226 46 003524   000000 236000 6                  LDQ     HEAD_ETT$
        46 003525   000005 116000 47                 CMPQ    5
        46 003526   003553 601000 46                 TNZ     s:21238

  21228 46 003527   000002 236000 8                  LDQ     ETT_+2
        46 003530   000005 036007                    ADLQ    5,DL
        46 003531   000003 116000 8                  CMPQ    ETT_+3
        46 003532   003543 604000 46                 TMI     s:21230

  21229 46 003533   000014 236000 47                 LDQ     12
        46 003534   200302 756100                    STQ     ORG1+1,,AUTO
        46 003535   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 003536   200303 450500                    STP0    ORG1+2,,AUTO
        46 003537   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 003540   000000 631400 47                 EPPR1   0
        46 003541   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 003542   000000 011000                    NOP     0

  21230 46 003543   000002 236000 8                  LDQ     ETT_+2
        46 003544   000022 736000                    QLS     18
        46 003545   000001 036000 8                  ADLQ    ETT_+1
        46 003546   200004 470500                    LDP0    @PCOM,,AUTO
        46 003547   000045 756100                    STQ     37,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:276  

  21231 46 003550   000005 236007                    LDQ     5,DL
        46 003551   000002 056000 8                  ASQ     ETT_+2

  21232 46 003552   003560 710000 46                 TRA     s:21248

  21238 46 003553   200004 470500                    LDP0    @PCOM,,AUTO
        46 003554   000045 756100                    STQ     37,,PR0

  21239 46 003555   000000 471400 6                  LDP1    HEAD_ETT$
        46 003556   100003 236100                    LDQ     3,,PR1
        46 003557   000000 756000 6                  STQ     HEAD_ETT$

  21248 46 003560   000045 471500                    LDP1    37,,PR0
        46 003561   000003 220003                    LDX0    3,DU
        46 003562   100000 740100                    STX0    0,,PR1

  21253 46 003563   000045 471500                    LDP1    37,,PR0
        46 003564   200124 236100                    LDQ     TEMP$,,AUTO
        46 003565   100001 756100                    STQ     1,,PR1

  21256 46 003566   000045 471500                    LDP1    37,,PR0
        46 003567   000005 236000 47                 LDQ     5
        46 003570   100002 756100                    STQ     2,,PR1

  21264 46 003571   000045 471500                    LDP1    37,,PR0
        46 003572   000000 221003                    LDX1    0,DU
        46 003573   100004 441100                    SXL1    4,,PR1

  21265 46 003574   000045 471500                    LDP1    37,,PR0
        46 003575   000001 236007                    LDQ     1,DL
        46 003576   100004 256100                    ORSQ    4,,PR1

  21266 46 003577   000045 471500                    LDP1    37,,PR0
        46 003600   000000 222003                    LDX2    0,DU
        46 003601   100000 442100                    SXL2    0,,PR1

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:277  
  21267 46 003602   000045 471500                    LDP1    37,,PR0
        46 003603   100004 742100                    STX2    4,,PR1

  21268 46 003604   000045 471500                    LDP1    37,,PR0
        46 003605   000005 236000 47                 LDQ     5
        46 003606   100003 756100                    STQ     3,,PR1

  21292 46 003607   000045 471500                    LDP1    37,,PR0
        46 003610   200126 723100                    LXL3    LDAQ_OFFSET,,AUTO
        46 003611   100002 743100                    STX3    2,,PR1

  21293 46 003612   000045 471500                    LDP1    37,,PR0
        46 003613   000006 224003                    LDX4    6,DU
        46 003614   100002 444100                    SXL4    2,,PR1

  21294 46 003615   000016 236000 47                 LDQ     14
        46 003616   200303 756100                    STQ     ORG1+2,,AUTO
        46 003617   200124 631500                    EPPR1   TEMP$,,AUTO
        46 003620   200302 451500                    STP1    ORG1+1,,AUTO
        46 003621   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 003622   000013 631400 47                 EPPR1   11
        46 003623   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 003624   000000 011000                    NOP     0

  21295 46 003625   200004 236100                    LDQ     @PCOM,,AUTO
        46 003626   000045 036003                    ADLQ    37,DU
        46 003627   200302 756100                    STQ     ORG1+1,,AUTO
        46 003630   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 003631   000000 631400 47                 EPPR1   0
        46 003632   000000 701000 xent               TSX1    Z8HU$WALK
        46 003633   000000 011000                    NOP     0

     1116    21298
     1117    21299                 %#OFF#(@FROM=TEMP$,@TO=PCOM.MOPND,@VALUE=MVN_OFFSET,@TYPE=%NUMERIC4);

  21307 46 003634   000000 236000 6                  LDQ     HEAD_ETT$
        46 003635   000005 116000 47                 CMPQ    5
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:278  
        46 003636   003663 601000 46                 TNZ     s:21319

  21309 46 003637   000002 236000 8                  LDQ     ETT_+2
        46 003640   000005 036007                    ADLQ    5,DL
        46 003641   000003 116000 8                  CMPQ    ETT_+3
        46 003642   003653 604000 46                 TMI     s:21311

  21310 46 003643   000014 236000 47                 LDQ     12
        46 003644   200302 756100                    STQ     ORG1+1,,AUTO
        46 003645   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 003646   200303 450500                    STP0    ORG1+2,,AUTO
        46 003647   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 003650   000000 631400 47                 EPPR1   0
        46 003651   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 003652   000000 011000                    NOP     0

  21311 46 003653   000002 236000 8                  LDQ     ETT_+2
        46 003654   000022 736000                    QLS     18
        46 003655   000001 036000 8                  ADLQ    ETT_+1
        46 003656   200004 470500                    LDP0    @PCOM,,AUTO
        46 003657   000046 756100                    STQ     38,,PR0

  21312 46 003660   000005 236007                    LDQ     5,DL
        46 003661   000002 056000 8                  ASQ     ETT_+2

  21313 46 003662   003670 710000 46                 TRA     s:21329

  21319 46 003663   200004 470500                    LDP0    @PCOM,,AUTO
        46 003664   000046 756100                    STQ     38,,PR0

  21320 46 003665   000000 471400 6                  LDP1    HEAD_ETT$
        46 003666   100003 236100                    LDQ     3,,PR1
        46 003667   000000 756000 6                  STQ     HEAD_ETT$

  21329 46 003670   000046 471500                    LDP1    38,,PR0
        46 003671   000003 220003                    LDX0    3,DU
        46 003672   100000 740100                    STX0    0,,PR1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:279  

  21334 46 003673   000046 471500                    LDP1    38,,PR0
        46 003674   200124 236100                    LDQ     TEMP$,,AUTO
        46 003675   100001 756100                    STQ     1,,PR1

  21337 46 003676   000046 471500                    LDP1    38,,PR0
        46 003677   000005 236000 47                 LDQ     5
        46 003700   100002 756100                    STQ     2,,PR1

  21345 46 003701   000046 471500                    LDP1    38,,PR0
        46 003702   000000 221003                    LDX1    0,DU
        46 003703   100004 441100                    SXL1    4,,PR1

  21346 46 003704   000046 471500                    LDP1    38,,PR0
        46 003705   000001 236007                    LDQ     1,DL
        46 003706   100004 256100                    ORSQ    4,,PR1

  21347 46 003707   000046 471500                    LDP1    38,,PR0
        46 003710   000000 222003                    LDX2    0,DU
        46 003711   100000 442100                    SXL2    0,,PR1

  21348 46 003712   000046 471500                    LDP1    38,,PR0
        46 003713   100004 742100                    STX2    4,,PR1

  21349 46 003714   000046 471500                    LDP1    38,,PR0
        46 003715   000005 236000 47                 LDQ     5
        46 003716   100003 756100                    STQ     3,,PR1

  21373 46 003717   000046 471500                    LDP1    38,,PR0
        46 003720   200127 723100                    LXL3    MVN_OFFSET,,AUTO
        46 003721   100002 743100                    STX3    2,,PR1

  21374 46 003722   000046 471500                    LDP1    38,,PR0
        46 003723   000001 224003                    LDX4    1,DU
        46 003724   100002 444100                    SXL4    2,,PR1

  21375 46 003725   000016 236000 47                 LDQ     14
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:280  
        46 003726   200303 756100                    STQ     ORG1+2,,AUTO
        46 003727   200124 631500                    EPPR1   TEMP$,,AUTO
        46 003730   200302 451500                    STP1    ORG1+1,,AUTO
        46 003731   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 003732   000013 631400 47                 EPPR1   11
        46 003733   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 003734   000000 011000                    NOP     0

  21376 46 003735   200004 236100                    LDQ     @PCOM,,AUTO
        46 003736   000046 036003                    ADLQ    38,DU
        46 003737   200302 756100                    STQ     ORG1+1,,AUTO
        46 003740   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 003741   000000 631400 47                 EPPR1   0
        46 003742   000000 701000 xent               TSX1    Z8HU$WALK
        46 003743   000000 011000                    NOP     0

     1118    21379
     1119    21380                %#DESC#_NDSC(@FROM=PCOM.MOPND,@TO=PCOM.UOPND,@LENGTH=LOP_LEN,@SIGN=LOP_SIGN
             21380                     );

  21388 46 003744   000000 236000 6                  LDQ     HEAD_ETT$
        46 003745   000005 116000 47                 CMPQ    5
        46 003746   003773 601000 46                 TNZ     s:21400

  21390 46 003747   000002 236000 8                  LDQ     ETT_+2
        46 003750   000005 036007                    ADLQ    5,DL
        46 003751   000003 116000 8                  CMPQ    ETT_+3
        46 003752   003763 604000 46                 TMI     s:21392

  21391 46 003753   000014 236000 47                 LDQ     12
        46 003754   200302 756100                    STQ     ORG1+1,,AUTO
        46 003755   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 003756   200303 450500                    STP0    ORG1+2,,AUTO
        46 003757   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 003760   000000 631400 47                 EPPR1   0
        46 003761   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 003762   000000 011000                    NOP     0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:281  

  21392 46 003763   000002 236000 8                  LDQ     ETT_+2
        46 003764   000022 736000                    QLS     18
        46 003765   000001 036000 8                  ADLQ    ETT_+1
        46 003766   200004 470500                    LDP0    @PCOM,,AUTO
        46 003767   000056 756100                    STQ     46,,PR0

  21393 46 003770   000005 236007                    LDQ     5,DL
        46 003771   000002 056000 8                  ASQ     ETT_+2

  21394 46 003772   004000 710000 46                 TRA     s:21410

  21400 46 003773   200004 470500                    LDP0    @PCOM,,AUTO
        46 003774   000056 756100                    STQ     46,,PR0

  21401 46 003775   000000 471400 6                  LDP1    HEAD_ETT$
        46 003776   100003 236100                    LDQ     3,,PR1
        46 003777   000000 756000 6                  STQ     HEAD_ETT$

  21410 46 004000   000056 471500                    LDP1    46,,PR0
        46 004001   000010 220003                    LDX0    8,DU
        46 004002   100000 740100                    STX0    0,,PR1

  21415 46 004003   000056 471500                    LDP1    46,,PR0
        46 004004   000046 236100                    LDQ     38,,PR0
        46 004005   100001 756100                    STQ     1,,PR1

  21418 46 004006   000056 471500                    LDP1    46,,PR0
        46 004007   000005 236000 47                 LDQ     5
        46 004010   100002 756100                    STQ     2,,PR1

  21426 46 004011   000056 471500                    LDP1    46,,PR0
        46 004012   000000 221003                    LDX1    0,DU
        46 004013   100004 441100                    SXL1    4,,PR1

  21427 46 004014   000056 471500                    LDP1    46,,PR0
        46 004015   000001 236007                    LDQ     1,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:282  
        46 004016   100004 256100                    ORSQ    4,,PR1

  21428 46 004017   000056 471500                    LDP1    46,,PR0
        46 004020   000000 222003                    LDX2    0,DU
        46 004021   100000 442100                    SXL2    0,,PR1

  21429 46 004022   000056 471500                    LDP1    46,,PR0
        46 004023   100004 742100                    STX2    4,,PR1

  21430 46 004024   000056 471500                    LDP1    46,,PR0
        46 004025   000005 236000 47                 LDQ     5
        46 004026   100003 756100                    STQ     3,,PR1

  21454 46 004027   000056 471500                    LDP1    46,,PR0
        46 004030   000046 473500                    LDP3    38,,PR0
        46 004031   300003 474500                    LDP4    3,,PR3
        46 004032   400001 223100                    LDX3    1,,PR4
        46 004033   100002 743100                    STX3    2,,PR1

  21469 46 004034   000046 471500                    LDP1    38,,PR0
        46 004035   100003 473500                    LDP3    3,,PR1
        46 004036   300001 236100                    LDQ     1,,PR3
        46 004037   000014 772000                    QRL     12
        46 004040   000003 376007                    ANQ     3,DL
        46 004041   000004 116007                    CMPQ    4,DL
        46 004042   004044 602006 46                 TNC     s:21469+8,QL
        46 004043   004075 710000 46                 TRA     s:21500
        46 004044   004061 710000 46                 TRA     s:21493
        46 004045   004054 710000 46                 TRA     s:21476
        46 004046   004054 710000 46                 TRA     s:21476
        46 004047   004050 710000 46                 TRA     s:21471

  21471 46 004050   300001 236100                    LDQ     1,,PR3
        46 004051   000077 376007                    ANQ     63,DL
        46 004052   200050 756100                    STQ     LENGTH,,AUTO
        46 004053   004075 710000 46                 TRA     s:21500

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:283  
  21476 46 004054   300001 236100                    LDQ     1,,PR3
        46 004055   000077 376007                    ANQ     63,DL
        46 004056   000001 136007                    SBLQ    1,DL
        46 004057   200050 756100                    STQ     LENGTH,,AUTO
        46 004060   004075 710000 46                 TRA     s:21500

  21493 46 004061   300001 236100                    LDQ     1,,PR3
        46 004062   040000 316007                    CANQ    16384,DL
        46 004063   004071 600000 46                 TZE     s:21496

  21494 46 004064   300001 236100                    LDQ     1,,PR3
        46 004065   000077 376007                    ANQ     63,DL
        46 004066   000003 136007                    SBLQ    3,DL
        46 004067   200050 756100                    STQ     LENGTH,,AUTO
        46 004070   004075 710000 46                 TRA     s:21500

  21496 46 004071   300001 236100                    LDQ     1,,PR3
        46 004072   000077 376007                    ANQ     63,DL
        46 004073   000002 136007                    SBLQ    2,DL
        46 004074   200050 756100                    STQ     LENGTH,,AUTO

  21500 46 004075   000046 471500                    LDP1    38,,PR0
        46 004076   100003 473500                    LDP3    3,,PR1
        46 004077   300001 236100                    LDQ     1,,PR3
        46 004100   000022 772000                    QRL     18
        46 004101   200052 756100                    STQ     SA,,AUTO

  21503 46 004102   300001 236100                    LDQ     1,,PR3
        46 004103   000017 772000                    QRL     15
        46 004104   000007 376007                    ANQ     7,DL
        46 004105   200051 756100                    STQ     CN,,AUTO

  21506 46 004106   300001 236100                    LDQ     1,,PR3
        46 004107   000025 736000                    QLS     21
        46 004110   400000 376003                    ANQ     -131072,DU
        46 004111   200045 756100                    STQ     TN,,AUTO

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:284  
  21509 46 004112   300001 236100                    LDQ     1,,PR3
        46 004113   000030 736000                    QLS     24
        46 004114   000036 732000                    QRS     30
        46 004115   200047 756100                    STQ     SCALE,,AUTO

  21512 46 004116   300001 236100                    LDQ     1,,PR3
        46 004117   000026 736000                    QLS     22
        46 004120   600000 376003                    ANQ     -65536,DU
        46 004121   200044 756100                    STQ     SIGN,,AUTO

  21518 46 004122   200077 235100                    LDA     LOP_LEN,,AUTO
        46 004123   200050 755100                    STA     LENGTH,,AUTO

  21530 46 004124   200130 236100                    LDQ     LOP_SIGN,,AUTO
        46 004125   600000 376003                    ANQ     -65536,DU
        46 004126   200044 756100                    STQ     SIGN,,AUTO

  21544 46 004127   000056 471500                    LDP1    46,,PR0
        46 004130   200052 723100                    LXL3    SA,,AUTO
        46 004131   100002 743100                    STX3    2,,PR1

  21545 46 004132   000056 471500                    LDP1    46,,PR0
        46 004133   200051 236100                    LDQ     CN,,AUTO
        46 004134   000017 736000                    QLS     15
        46 004135   100002 676100                    ERQ     2,,PR1
        46 004136   700000 376007                    ANQ     -32768,DL
        46 004137   100002 656100                    ERSQ    2,,PR1

  21546 46 004140   000056 471500                    LDP1    46,,PR0
        46 004141   200045 236100                    LDQ     TN,,AUTO
        46 004142   000025 772000                    QRL     21
        46 004143   100002 676100                    ERQ     2,,PR1
        46 004144   040000 376007                    ANQ     16384,DL
        46 004145   100002 656100                    ERSQ    2,,PR1

  21547 46 004146   000056 471500                    LDP1    46,,PR0
        46 004147   200044 236100                    LDQ     SIGN,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:285  
        46 004150   000026 772000                    QRL     22
        46 004151   100002 676100                    ERQ     2,,PR1
        46 004152   030000 376007                    ANQ     12288,DL
        46 004153   100002 656100                    ERSQ    2,,PR1

  21548 46 004154   000056 471500                    LDP1    46,,PR0
        46 004155   200047 236100                    LDQ     SCALE,,AUTO
        46 004156   000006 736000                    QLS     6
        46 004157   100002 752102                    STCQ    2,'02'O,PR1

  21549 46 004160   200044 236100                    LDQ     SIGN,,AUTO
        46 004161   000042 772000                    QRL     34
        46 004162   000004 116007                    CMPQ    4,DL
        46 004163   004165 602006 46                 TNC     s:21549+5,QL
        46 004164   004215 710000 46                 TRA     s:21588
        46 004165   004202 710000 46                 TRA     s:21575
        46 004166   004175 710000 46                 TRA     s:21556
        46 004167   004175 710000 46                 TRA     s:21556
        46 004170   004171 710000 46                 TRA     s:21551

  21551 46 004171   000056 471500                    LDP1    46,,PR0
        46 004172   200050 236100                    LDQ     LENGTH,,AUTO
        46 004173   100002 752101                    STCQ    2,'01'O,PR1
        46 004174   004215 710000 46                 TRA     s:21588

  21556 46 004175   000056 471500                    LDP1    46,,PR0
        46 004176   200050 236100                    LDQ     LENGTH,,AUTO
        46 004177   000001 036007                    ADLQ    1,DL
        46 004200   100002 752101                    STCQ    2,'01'O,PR1
        46 004201   004215 710000 46                 TRA     s:21588

  21575 46 004202   200045 234100                    SZN     TN,,AUTO
        46 004203   004211 605000 46                 TPL     s:21578

  21576 46 004204   000056 471500                    LDP1    46,,PR0
        46 004205   200050 236100                    LDQ     LENGTH,,AUTO
        46 004206   000003 036007                    ADLQ    3,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:286  
        46 004207   100002 752101                    STCQ    2,'01'O,PR1
        46 004210   004215 710000 46                 TRA     s:21588

  21578 46 004211   000056 471500                    LDP1    46,,PR0
        46 004212   200050 236100                    LDQ     LENGTH,,AUTO
        46 004213   000002 036007                    ADLQ    2,DL
        46 004214   100002 752101                    STCQ    2,'01'O,PR1

  21588 46 004215   000016 236000 47                 LDQ     14
        46 004216   200303 756100                    STQ     ORG1+2,,AUTO
        46 004217   200004 236100                    LDQ     @PCOM,,AUTO
        46 004220   000046 036003                    ADLQ    38,DU
        46 004221   200302 756100                    STQ     ORG1+1,,AUTO
        46 004222   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 004223   000013 631400 47                 EPPR1   11
        46 004224   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 004225   000000 011000                    NOP     0

  21589 46 004226   200004 236100                    LDQ     @PCOM,,AUTO
        46 004227   000056 036003                    ADLQ    46,DU
        46 004230   200302 756100                    STQ     ORG1+1,,AUTO
        46 004231   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 004232   000000 631400 47                 EPPR1   0
        46 004233   000000 701000 xent               TSX1    Z8HU$WALK
        46 004234   000000 011000                    NOP     0

     1120    21592
     1121    21593                %#DESC#_NDSC(@FROM=PCOM.IOPND,@TO=PCOM.NOPND,@LENGTH=LOP_LEN,@SIGN=%NO_SIGN
             21593                     );

  21601 46 004235   000000 236000 6                  LDQ     HEAD_ETT$
        46 004236   000005 116000 47                 CMPQ    5
        46 004237   004264 601000 46                 TNZ     s:21613

  21603 46 004240   000002 236000 8                  LDQ     ETT_+2
        46 004241   000005 036007                    ADLQ    5,DL
        46 004242   000003 116000 8                  CMPQ    ETT_+3
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:287  
        46 004243   004254 604000 46                 TMI     s:21605

  21604 46 004244   000014 236000 47                 LDQ     12
        46 004245   200302 756100                    STQ     ORG1+1,,AUTO
        46 004246   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 004247   200303 450500                    STP0    ORG1+2,,AUTO
        46 004250   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 004251   000000 631400 47                 EPPR1   0
        46 004252   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 004253   000000 011000                    NOP     0

  21605 46 004254   000002 236000 8                  LDQ     ETT_+2
        46 004255   000022 736000                    QLS     18
        46 004256   000001 036000 8                  ADLQ    ETT_+1
        46 004257   200004 470500                    LDP0    @PCOM,,AUTO
        46 004260   000047 756100                    STQ     39,,PR0

  21606 46 004261   000005 236007                    LDQ     5,DL
        46 004262   000002 056000 8                  ASQ     ETT_+2

  21607 46 004263   004271 710000 46                 TRA     s:21623

  21613 46 004264   200004 470500                    LDP0    @PCOM,,AUTO
        46 004265   000047 756100                    STQ     39,,PR0

  21614 46 004266   000000 471400 6                  LDP1    HEAD_ETT$
        46 004267   100003 236100                    LDQ     3,,PR1
        46 004270   000000 756000 6                  STQ     HEAD_ETT$

  21623 46 004271   000047 471500                    LDP1    39,,PR0
        46 004272   000010 220003                    LDX0    8,DU
        46 004273   100000 740100                    STX0    0,,PR1

  21628 46 004274   000047 471500                    LDP1    39,,PR0
        46 004275   000042 236100                    LDQ     34,,PR0
        46 004276   100001 756100                    STQ     1,,PR1

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:288  
  21631 46 004277   000047 471500                    LDP1    39,,PR0
        46 004300   000005 236000 47                 LDQ     5
        46 004301   100002 756100                    STQ     2,,PR1

  21639 46 004302   000047 471500                    LDP1    39,,PR0
        46 004303   000000 221003                    LDX1    0,DU
        46 004304   100004 441100                    SXL1    4,,PR1

  21640 46 004305   000047 471500                    LDP1    39,,PR0
        46 004306   000001 236007                    LDQ     1,DL
        46 004307   100004 256100                    ORSQ    4,,PR1

  21641 46 004310   000047 471500                    LDP1    39,,PR0
        46 004311   000000 222003                    LDX2    0,DU
        46 004312   100000 442100                    SXL2    0,,PR1

  21642 46 004313   000047 471500                    LDP1    39,,PR0
        46 004314   100004 742100                    STX2    4,,PR1

  21643 46 004315   000047 471500                    LDP1    39,,PR0
        46 004316   000005 236000 47                 LDQ     5
        46 004317   100003 756100                    STQ     3,,PR1

  21667 46 004320   000047 471500                    LDP1    39,,PR0
        46 004321   000042 473500                    LDP3    34,,PR0
        46 004322   300003 474500                    LDP4    3,,PR3
        46 004323   400001 223100                    LDX3    1,,PR4
        46 004324   100002 743100                    STX3    2,,PR1

  21682 46 004325   000042 471500                    LDP1    34,,PR0
        46 004326   100003 473500                    LDP3    3,,PR1
        46 004327   300001 236100                    LDQ     1,,PR3
        46 004330   000014 772000                    QRL     12
        46 004331   000003 376007                    ANQ     3,DL
        46 004332   000004 116007                    CMPQ    4,DL
        46 004333   004335 602006 46                 TNC     s:21682+8,QL
        46 004334   004366 710000 46                 TRA     s:21713
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:289  
        46 004335   004352 710000 46                 TRA     s:21706
        46 004336   004345 710000 46                 TRA     s:21689
        46 004337   004345 710000 46                 TRA     s:21689
        46 004340   004341 710000 46                 TRA     s:21684

  21684 46 004341   300001 236100                    LDQ     1,,PR3
        46 004342   000077 376007                    ANQ     63,DL
        46 004343   200050 756100                    STQ     LENGTH,,AUTO
        46 004344   004366 710000 46                 TRA     s:21713

  21689 46 004345   300001 236100                    LDQ     1,,PR3
        46 004346   000077 376007                    ANQ     63,DL
        46 004347   000001 136007                    SBLQ    1,DL
        46 004350   200050 756100                    STQ     LENGTH,,AUTO
        46 004351   004366 710000 46                 TRA     s:21713

  21706 46 004352   300001 236100                    LDQ     1,,PR3
        46 004353   040000 316007                    CANQ    16384,DL
        46 004354   004362 600000 46                 TZE     s:21709

  21707 46 004355   300001 236100                    LDQ     1,,PR3
        46 004356   000077 376007                    ANQ     63,DL
        46 004357   000003 136007                    SBLQ    3,DL
        46 004360   200050 756100                    STQ     LENGTH,,AUTO
        46 004361   004366 710000 46                 TRA     s:21713

  21709 46 004362   300001 236100                    LDQ     1,,PR3
        46 004363   000077 376007                    ANQ     63,DL
        46 004364   000002 136007                    SBLQ    2,DL
        46 004365   200050 756100                    STQ     LENGTH,,AUTO

  21713 46 004366   000042 471500                    LDP1    34,,PR0
        46 004367   100003 473500                    LDP3    3,,PR1
        46 004370   300001 236100                    LDQ     1,,PR3
        46 004371   000022 772000                    QRL     18
        46 004372   200052 756100                    STQ     SA,,AUTO

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:290  
  21716 46 004373   300001 236100                    LDQ     1,,PR3
        46 004374   000017 772000                    QRL     15
        46 004375   000007 376007                    ANQ     7,DL
        46 004376   200051 756100                    STQ     CN,,AUTO

  21719 46 004377   300001 236100                    LDQ     1,,PR3
        46 004400   000025 736000                    QLS     21
        46 004401   400000 376003                    ANQ     -131072,DU
        46 004402   200045 756100                    STQ     TN,,AUTO

  21722 46 004403   300001 236100                    LDQ     1,,PR3
        46 004404   000030 736000                    QLS     24
        46 004405   000036 732000                    QRS     30
        46 004406   200047 756100                    STQ     SCALE,,AUTO

  21725 46 004407   300001 236100                    LDQ     1,,PR3
        46 004410   000026 736000                    QLS     22
        46 004411   600000 376003                    ANQ     -65536,DU
        46 004412   200044 756100                    STQ     SIGN,,AUTO

  21731 46 004413   200077 235100                    LDA     LOP_LEN,,AUTO
        46 004414   200050 755100                    STA     LENGTH,,AUTO

  21743 46 004415   600000 236003                    LDQ     -65536,DU
        46 004416   200044 756100                    STQ     SIGN,,AUTO

  21757 46 004417   000047 471500                    LDP1    39,,PR0
        46 004420   200052 723100                    LXL3    SA,,AUTO
        46 004421   100002 743100                    STX3    2,,PR1

  21758 46 004422   000047 471500                    LDP1    39,,PR0
        46 004423   200051 236100                    LDQ     CN,,AUTO
        46 004424   000017 736000                    QLS     15
        46 004425   100002 676100                    ERQ     2,,PR1
        46 004426   700000 376007                    ANQ     -32768,DL
        46 004427   100002 656100                    ERSQ    2,,PR1

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:291  
  21759 46 004430   000047 471500                    LDP1    39,,PR0
        46 004431   200045 236100                    LDQ     TN,,AUTO
        46 004432   000025 772000                    QRL     21
        46 004433   100002 676100                    ERQ     2,,PR1
        46 004434   040000 376007                    ANQ     16384,DL
        46 004435   100002 656100                    ERSQ    2,,PR1

  21760 46 004436   000047 471500                    LDP1    39,,PR0
        46 004437   200044 236100                    LDQ     SIGN,,AUTO
        46 004440   000026 772000                    QRL     22
        46 004441   100002 676100                    ERQ     2,,PR1
        46 004442   030000 376007                    ANQ     12288,DL
        46 004443   100002 656100                    ERSQ    2,,PR1

  21761 46 004444   000047 471500                    LDP1    39,,PR0
        46 004445   200047 236100                    LDQ     SCALE,,AUTO
        46 004446   000006 736000                    QLS     6
        46 004447   100002 752102                    STCQ    2,'02'O,PR1

  21762 46 004450   200044 236100                    LDQ     SIGN,,AUTO
        46 004451   000042 772000                    QRL     34
        46 004452   000004 116007                    CMPQ    4,DL
        46 004453   004455 602006 46                 TNC     s:21762+5,QL
        46 004454   004505 710000 46                 TRA     s:21801
        46 004455   004472 710000 46                 TRA     s:21788
        46 004456   004465 710000 46                 TRA     s:21769
        46 004457   004465 710000 46                 TRA     s:21769
        46 004460   004461 710000 46                 TRA     s:21764

  21764 46 004461   000047 471500                    LDP1    39,,PR0
        46 004462   200050 236100                    LDQ     LENGTH,,AUTO
        46 004463   100002 752101                    STCQ    2,'01'O,PR1
        46 004464   004505 710000 46                 TRA     s:21801

  21769 46 004465   000047 471500                    LDP1    39,,PR0
        46 004466   200050 236100                    LDQ     LENGTH,,AUTO
        46 004467   000001 036007                    ADLQ    1,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:292  
        46 004470   100002 752101                    STCQ    2,'01'O,PR1
        46 004471   004505 710000 46                 TRA     s:21801

  21788 46 004472   200045 234100                    SZN     TN,,AUTO
        46 004473   004501 605000 46                 TPL     s:21791

  21789 46 004474   000047 471500                    LDP1    39,,PR0
        46 004475   200050 236100                    LDQ     LENGTH,,AUTO
        46 004476   000003 036007                    ADLQ    3,DL
        46 004477   100002 752101                    STCQ    2,'01'O,PR1
        46 004500   004505 710000 46                 TRA     s:21801

  21791 46 004501   000047 471500                    LDP1    39,,PR0
        46 004502   200050 236100                    LDQ     LENGTH,,AUTO
        46 004503   000002 036007                    ADLQ    2,DL
        46 004504   100002 752101                    STCQ    2,'01'O,PR1

  21801 46 004505   000016 236000 47                 LDQ     14
        46 004506   200303 756100                    STQ     ORG1+2,,AUTO
        46 004507   200004 236100                    LDQ     @PCOM,,AUTO
        46 004510   000042 036003                    ADLQ    34,DU
        46 004511   200302 756100                    STQ     ORG1+1,,AUTO
        46 004512   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 004513   000013 631400 47                 EPPR1   11
        46 004514   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 004515   000000 011000                    NOP     0

  21802 46 004516   200004 236100                    LDQ     @PCOM,,AUTO
        46 004517   000047 036003                    ADLQ    39,DU
        46 004520   200302 756100                    STQ     ORG1+1,,AUTO
        46 004521   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 004522   000000 631400 47                 EPPR1   0
        46 004523   000000 701000 xent               TSX1    Z8HU$WALK
        46 004524   000000 011000                    NOP     0

     1122    21805
     1123    21806    3            IF LOP_SIGN = %LEADING_SIGN THEN
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:293  

  21806 46 004525   200130 236100                    LDQ     LOP_SIGN,,AUTO
        46 004526   600000 376003                    ANQ     -65536,DU
        46 004527   200000 116003                    CMPQ    65536,DU
        46 004530   004533 601000 46                 TNZ     s:21809

     1124    21807    3              I = 0;

  21807 46 004531   200065 450100                    STZ     I,,AUTO
        46 004532   004541 710000 46                 TRA     s:21813

     1125    21808    3            ELSE
     1126    21809    3              I = PILL -> ETT.DESC.NDSC.N - 1;

  21809 46 004533   200003 470500                    LDP0    @PILL,,AUTO
        46 004534   000000 471500                    LDP1    0,,PR0
        46 004535   100002 236100                    LDQ     2,,PR1
        46 004536   000077 376007                    ANQ     63,DL
        46 004537   000001 136007                    SBLQ    1,DL
        46 004540   200065 756100                    STQ     I,,AUTO

     1127    21810
     1128    21811                 %#DNA#(@FROM=PCOM.IOPND,@TO=PCOM.YOPND);

  21813 46 004541   200004 470500                    LDP0    @PCOM,,AUTO
        46 004542   000042 471500                    LDP1    34,,PR0
        46 004543   100003 473500                    LDP3    3,,PR1
        46 004544   300001 236100                    LDQ     1,,PR3
        46 004545   000077 376007                    ANQ     63,DL
        46 004546   200066 756100                    STQ     J,,AUTO

  21821 46 004547   000000 236000 6                  LDQ     HEAD_ETT$
        46 004550   000005 116000 47                 CMPQ    5
        46 004551   004576 601000 46                 TNZ     s:21833

  21823 46 004552   000002 236000 8                  LDQ     ETT_+2
        46 004553   000005 036007                    ADLQ    5,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:294  
        46 004554   000003 116000 8                  CMPQ    ETT_+3
        46 004555   004566 604000 46                 TMI     s:21825

  21824 46 004556   000014 236000 47                 LDQ     12
        46 004557   200302 756100                    STQ     ORG1+1,,AUTO
        46 004560   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 004561   200303 451500                    STP1    ORG1+2,,AUTO
        46 004562   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 004563   000000 631400 47                 EPPR1   0
        46 004564   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 004565   000000 011000                    NOP     0

  21825 46 004566   000002 236000 8                  LDQ     ETT_+2
        46 004567   000022 736000                    QLS     18
        46 004570   000001 036000 8                  ADLQ    ETT_+1
        46 004571   200004 470500                    LDP0    @PCOM,,AUTO
        46 004572   000062 756100                    STQ     50,,PR0

  21826 46 004573   000005 236007                    LDQ     5,DL
        46 004574   000002 056000 8                  ASQ     ETT_+2

  21827 46 004575   004602 710000 46                 TRA     s:21843

  21833 46 004576   000062 756100                    STQ     50,,PR0

  21834 46 004577   000000 471400 6                  LDP1    HEAD_ETT$
        46 004600   100003 236100                    LDQ     3,,PR1
        46 004601   000000 756000 6                  STQ     HEAD_ETT$

  21843 46 004602   000062 471500                    LDP1    50,,PR0
        46 004603   000007 220003                    LDX0    7,DU
        46 004604   100000 740100                    STX0    0,,PR1

  21848 46 004605   000062 471500                    LDP1    50,,PR0
        46 004606   000042 236100                    LDQ     34,,PR0
        46 004607   100001 756100                    STQ     1,,PR1

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:295  
  21857 46 004610   000062 471500                    LDP1    50,,PR0
        46 004611   200066 235100                    LDA     J,,AUTO
        46 004612   100002 755100                    STA     2,,PR1

  21859 46 004613   000062 471500                    LDP1    50,,PR0
        46 004614   000000 221003                    LDX1    0,DU
        46 004615   100004 441100                    SXL1    4,,PR1

  21860 46 004616   000062 471500                    LDP1    50,,PR0
        46 004617   000001 236007                    LDQ     1,DL
        46 004620   100004 256100                    ORSQ    4,,PR1

  21861 46 004621   000062 471500                    LDP1    50,,PR0
        46 004622   000000 222003                    LDX2    0,DU
        46 004623   100000 442100                    SXL2    0,,PR1

  21862 46 004624   000062 471500                    LDP1    50,,PR0
        46 004625   100004 742100                    STX2    4,,PR1

  21863 46 004626   000062 471500                    LDP1    50,,PR0
        46 004627   000005 236000 47                 LDQ     5
        46 004630   100003 756100                    STQ     3,,PR1

  21887 46 004631   000016 236000 47                 LDQ     14
        46 004632   200303 756100                    STQ     ORG1+2,,AUTO
        46 004633   200004 236100                    LDQ     @PCOM,,AUTO
        46 004634   000042 036003                    ADLQ    34,DU
        46 004635   200302 756100                    STQ     ORG1+1,,AUTO
        46 004636   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 004637   000013 631400 47                 EPPR1   11
        46 004640   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 004641   000000 011000                    NOP     0

  21888 46 004642   200004 236100                    LDQ     @PCOM,,AUTO
        46 004643   000062 036003                    ADLQ    50,DU
        46 004644   200302 756100                    STQ     ORG1+1,,AUTO
        46 004645   200302 630500                    EPPR0   ORG1+1,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:296  
        46 004646   000000 631400 47                 EPPR1   0
        46 004647   000000 701000 xent               TSX1    Z8HU$WALK
        46 004650   000000 011000                    NOP     0

  21889 46 004651   200004 470500                    LDP0    @PCOM,,AUTO
        46 004652   000042 471500                    LDP1    34,,PR0
        46 004653   100003 473500                    LDP3    3,,PR1
        46 004654   300001 236100                    LDQ     1,,PR3
        46 004655   040000 316007                    CANQ    16384,DL
        46 004656   004672 600000 46                 TZE     s:21893
        46 004657   300005 474500                    LDP4    5,,PR3
        46 004660   400002 220100                    LDX0    2,,PR4
        46 004661   000013 100003                    CMPX0   11,DU
        46 004662   004672 600000 46                 TZE     s:21893

  21891 46 004663   000062 475500                    LDP5    50,,PR0
        46 004664   500003 476500                    LDP6    3,,PR5
        46 004665   600001 236100                    LDQ     1,,PR6
        46 004666   000017 376000 47                 ANQ     15
        46 004667   040000 276007                    ORQ     16384,DL
        46 004670   600001 756100                    STQ     1,,PR6
        46 004671   004676 710000 46                 TRA     s:21904

  21893 46 004672   000062 474500                    LDP4    50,,PR0
        46 004673   400003 475500                    LDP5    3,,PR4
        46 004674   000017 236000 47                 LDQ     15
        46 004675   500001 356100                    ANSQ    1,,PR5

     1129    21896                 %#DESC#_ADSC(@FROM=PCOM.YOPND,@TO=PCOM.FOPND,@LENGTH=1);

  21904 46 004676   000000 236000 6                  LDQ     HEAD_ETT$
        46 004677   000005 116000 47                 CMPQ    5
        46 004700   004725 601000 46                 TNZ     s:21916

  21906 46 004701   000002 236000 8                  LDQ     ETT_+2
        46 004702   000005 036007                    ADLQ    5,DL
        46 004703   000003 116000 8                  CMPQ    ETT_+3
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:297  
        46 004704   004715 604000 46                 TMI     s:21908

  21907 46 004705   000014 236000 47                 LDQ     12
        46 004706   200302 756100                    STQ     ORG1+1,,AUTO
        46 004707   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 004710   200303 451500                    STP1    ORG1+2,,AUTO
        46 004711   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 004712   000000 631400 47                 EPPR1   0
        46 004713   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 004714   000000 011000                    NOP     0

  21908 46 004715   000002 236000 8                  LDQ     ETT_+2
        46 004716   000022 736000                    QLS     18
        46 004717   000001 036000 8                  ADLQ    ETT_+1
        46 004720   200004 470500                    LDP0    @PCOM,,AUTO
        46 004721   000037 756100                    STQ     31,,PR0

  21909 46 004722   000005 236007                    LDQ     5,DL
        46 004723   000002 056000 8                  ASQ     ETT_+2

  21910 46 004724   004731 710000 46                 TRA     s:21926

  21916 46 004725   000037 756100                    STQ     31,,PR0

  21917 46 004726   000000 471400 6                  LDP1    HEAD_ETT$
        46 004727   100003 236100                    LDQ     3,,PR1
        46 004730   000000 756000 6                  STQ     HEAD_ETT$

  21926 46 004731   000037 471500                    LDP1    31,,PR0
        46 004732   000010 220003                    LDX0    8,DU
        46 004733   100000 740100                    STX0    0,,PR1

  21931 46 004734   000037 471500                    LDP1    31,,PR0
        46 004735   000062 236100                    LDQ     50,,PR0
        46 004736   100001 756100                    STQ     1,,PR1

  21934 46 004737   000037 471500                    LDP1    31,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:298  
        46 004740   000005 236000 47                 LDQ     5
        46 004741   100002 756100                    STQ     2,,PR1

  21942 46 004742   000037 471500                    LDP1    31,,PR0
        46 004743   000000 221003                    LDX1    0,DU
        46 004744   100004 441100                    SXL1    4,,PR1

  21943 46 004745   000037 471500                    LDP1    31,,PR0
        46 004746   000001 236007                    LDQ     1,DL
        46 004747   100004 256100                    ORSQ    4,,PR1

  21944 46 004750   000037 471500                    LDP1    31,,PR0
        46 004751   000000 222003                    LDX2    0,DU
        46 004752   100000 442100                    SXL2    0,,PR1

  21945 46 004753   000037 471500                    LDP1    31,,PR0
        46 004754   100004 742100                    STX2    4,,PR1

  21946 46 004755   000037 471500                    LDP1    31,,PR0
        46 004756   000005 236000 47                 LDQ     5
        46 004757   100003 756100                    STQ     3,,PR1

  21970 46 004760   000037 471500                    LDP1    31,,PR0
        46 004761   000062 473500                    LDP3    50,,PR0
        46 004762   300003 474500                    LDP4    3,,PR3
        46 004763   400001 223100                    LDX3    1,,PR4
        46 004764   100002 743100                    STX3    2,,PR1

  21983 46 004765   000062 471500                    LDP1    50,,PR0
        46 004766   100003 473500                    LDP3    3,,PR1
        46 004767   300001 236100                    LDQ     1,,PR3
        46 004770   000022 772000                    QRL     18
        46 004771   200052 756100                    STQ     SA,,AUTO

  21986 46 004772   300001 236100                    LDQ     1,,PR3
        46 004773   007777 376007                    ANQ     4095,DL
        46 004774   200050 756100                    STQ     LENGTH,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:299  

  21989 46 004775   100003 473500                    LDP3    3,,PR1
        46 004776   300001 236100                    LDQ     1,,PR3
        46 004777   060000 316007                    CANQ    24576,DL
        46 005000   005006 601000 46                 TNZ     s:21991

  21990 46 005001   300001 236100                    LDQ     1,,PR3
        46 005002   000020 772000                    QRL     16
        46 005003   000003 376007                    ANQ     3,DL
        46 005004   200051 756100                    STQ     CN,,AUTO
        46 005005   005012 710000 46                 TRA     s:21994

  21991 46 005006   300001 236100                    LDQ     1,,PR3
        46 005007   000017 772000                    QRL     15
        46 005010   000007 376007                    ANQ     7,DL
        46 005011   200051 756100                    STQ     CN,,AUTO

  21994 46 005012   300001 236100                    LDQ     1,,PR3
        46 005013   000025 736000                    QLS     21
        46 005014   600000 376003                    ANQ     -65536,DU
        46 005015   200046 756100                    STQ     TA,,AUTO

  22000 46 005016   000001 235007                    LDA     1,DL
        46 005017   200050 755100                    STA     LENGTH,,AUTO

  22017 46 005020   000037 473500                    LDP3    31,,PR0
        46 005021   200052 723100                    LXL3    SA,,AUTO
        46 005022   300002 743100                    STX3    2,,PR3

  22024 46 005023   200046 236100                    LDQ     TA,,AUTO
        46 005024   600000 316003                    CANQ    -65536,DU
        46 005025   005040 601000 46                 TNZ     s:22030

  22026 46 005026   000037 471500                    LDP1    31,,PR0
        46 005027   200051 236100                    LDQ     CN,,AUTO
        46 005030   000020 736000                    QLS     16
        46 005031   100002 676100                    ERQ     2,,PR1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:300  
        46 005032   600000 376007                    ANQ     -65536,DL
        46 005033   100002 656100                    ERSQ    2,,PR1

  22027 46 005034   000037 471500                    LDP1    31,,PR0
        46 005035   000031 236000 47                 LDQ     25
        46 005036   100002 356100                    ANSQ    2,,PR1

  22028 46 005037   005046 710000 46                 TRA     s:22032

  22030 46 005040   000037 471500                    LDP1    31,,PR0
        46 005041   200051 236100                    LDQ     CN,,AUTO
        46 005042   000017 736000                    QLS     15
        46 005043   100002 676100                    ERQ     2,,PR1
        46 005044   700000 376007                    ANQ     -32768,DL
        46 005045   100002 656100                    ERSQ    2,,PR1

  22032 46 005046   000037 471500                    LDP1    31,,PR0
        46 005047   200046 236100                    LDQ     TA,,AUTO
        46 005050   000025 772000                    QRL     21
        46 005051   100002 676100                    ERQ     2,,PR1
        46 005052   060000 376007                    ANQ     24576,DL
        46 005053   100002 656100                    ERSQ    2,,PR1

  22033 46 005054   000037 471500                    LDP1    31,,PR0
        46 005055   000032 236000 47                 LDQ     26
        46 005056   100002 356100                    ANSQ    2,,PR1

  22034 46 005057   000037 471500                    LDP1    31,,PR0
        46 005060   200050 236100                    LDQ     LENGTH,,AUTO
        46 005061   100002 752103                    STCQ    2,'03'O,PR1

  22037 46 005062   000016 236000 47                 LDQ     14
        46 005063   200303 756100                    STQ     ORG1+2,,AUTO
        46 005064   200004 236100                    LDQ     @PCOM,,AUTO
        46 005065   000062 036003                    ADLQ    50,DU
        46 005066   200302 756100                    STQ     ORG1+1,,AUTO
        46 005067   200302 630500                    EPPR0   ORG1+1,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:301  
        46 005070   000013 631400 47                 EPPR1   11
        46 005071   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 005072   000000 011000                    NOP     0

  22038 46 005073   200004 236100                    LDQ     @PCOM,,AUTO
        46 005074   000037 036003                    ADLQ    31,DU
        46 005075   200302 756100                    STQ     ORG1+1,,AUTO
        46 005076   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005077   000000 631400 47                 EPPR1   0
        46 005100   000000 701000 xent               TSX1    Z8HU$WALK
        46 005101   000000 011000                    NOP     0

     1130    22041                 %#OFF#(@FROM=PCOM.FOPND,@TO=PCOM.OOPND,@VALUE=I,@TYPE=%ALPHA9);

  22049 46 005102   000000 236000 6                  LDQ     HEAD_ETT$
        46 005103   000005 116000 47                 CMPQ    5
        46 005104   005131 601000 46                 TNZ     s:22061

  22051 46 005105   000002 236000 8                  LDQ     ETT_+2
        46 005106   000005 036007                    ADLQ    5,DL
        46 005107   000003 116000 8                  CMPQ    ETT_+3
        46 005110   005121 604000 46                 TMI     s:22053

  22052 46 005111   000014 236000 47                 LDQ     12
        46 005112   200302 756100                    STQ     ORG1+1,,AUTO
        46 005113   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005114   200303 450500                    STP0    ORG1+2,,AUTO
        46 005115   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 005116   000000 631400 47                 EPPR1   0
        46 005117   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 005120   000000 011000                    NOP     0

  22053 46 005121   000002 236000 8                  LDQ     ETT_+2
        46 005122   000022 736000                    QLS     18
        46 005123   000001 036000 8                  ADLQ    ETT_+1
        46 005124   200004 470500                    LDP0    @PCOM,,AUTO
        46 005125   000050 756100                    STQ     40,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:302  

  22054 46 005126   000005 236007                    LDQ     5,DL
        46 005127   000002 056000 8                  ASQ     ETT_+2

  22055 46 005130   005136 710000 46                 TRA     s:22071

  22061 46 005131   200004 470500                    LDP0    @PCOM,,AUTO
        46 005132   000050 756100                    STQ     40,,PR0

  22062 46 005133   000000 471400 6                  LDP1    HEAD_ETT$
        46 005134   100003 236100                    LDQ     3,,PR1
        46 005135   000000 756000 6                  STQ     HEAD_ETT$

  22071 46 005136   000050 471500                    LDP1    40,,PR0
        46 005137   000003 220003                    LDX0    3,DU
        46 005140   100000 740100                    STX0    0,,PR1

  22076 46 005141   000050 471500                    LDP1    40,,PR0
        46 005142   000037 236100                    LDQ     31,,PR0
        46 005143   100001 756100                    STQ     1,,PR1

  22079 46 005144   000050 471500                    LDP1    40,,PR0
        46 005145   000005 236000 47                 LDQ     5
        46 005146   100002 756100                    STQ     2,,PR1

  22087 46 005147   000050 471500                    LDP1    40,,PR0
        46 005150   000000 221003                    LDX1    0,DU
        46 005151   100004 441100                    SXL1    4,,PR1

  22088 46 005152   000050 471500                    LDP1    40,,PR0
        46 005153   000001 236007                    LDQ     1,DL
        46 005154   100004 256100                    ORSQ    4,,PR1

  22089 46 005155   000050 471500                    LDP1    40,,PR0
        46 005156   000000 222003                    LDX2    0,DU
        46 005157   100000 442100                    SXL2    0,,PR1

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:303  
  22090 46 005160   000050 471500                    LDP1    40,,PR0
        46 005161   100004 742100                    STX2    4,,PR1

  22091 46 005162   000050 471500                    LDP1    40,,PR0
        46 005163   000005 236000 47                 LDQ     5
        46 005164   100003 756100                    STQ     3,,PR1

  22115 46 005165   000050 471500                    LDP1    40,,PR0
        46 005166   200065 723100                    LXL3    I,,AUTO
        46 005167   100002 743100                    STX3    2,,PR1

  22116 46 005170   000050 471500                    LDP1    40,,PR0
        46 005171   000005 223003                    LDX3    5,DU
        46 005172   100002 443100                    SXL3    2,,PR1

  22117 46 005173   000016 236000 47                 LDQ     14
        46 005174   200303 756100                    STQ     ORG1+2,,AUTO
        46 005175   200004 236100                    LDQ     @PCOM,,AUTO
        46 005176   000037 036003                    ADLQ    31,DU
        46 005177   200302 756100                    STQ     ORG1+1,,AUTO
        46 005200   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005201   000013 631400 47                 EPPR1   11
        46 005202   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 005203   000000 011000                    NOP     0

  22118 46 005204   200004 236100                    LDQ     @PCOM,,AUTO
        46 005205   000050 036003                    ADLQ    40,DU
        46 005206   200302 756100                    STQ     ORG1+1,,AUTO
        46 005207   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005210   000000 631400 47                 EPPR1   0
        46 005211   000000 701000 xent               TSX1    Z8HU$WALK
        46 005212   000000 011000                    NOP     0

     1131    22121
     1132    22122    3            CALL Z8HU$DEC_COUNT(TEMP$, 2);

  22122 46 005213   000034 236000 47                 LDQ     28
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:304  
        46 005214   200303 756100                    STQ     ORG1+2,,AUTO
        46 005215   200124 630500                    EPPR0   TEMP$,,AUTO
        46 005216   200302 450500                    STP0    ORG1+1,,AUTO
        46 005217   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005220   000013 631400 47                 EPPR1   11
        46 005221   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 005222   000000 011000                    NOP     0

     1133    22123    3            CALL Z8HU$DEC_COUNT(PCOM.MOPND,1);

  22123 46 005223   000016 236000 47                 LDQ     14
        46 005224   200303 756100                    STQ     ORG1+2,,AUTO
        46 005225   200004 236100                    LDQ     @PCOM,,AUTO
        46 005226   000046 036003                    ADLQ    38,DU
        46 005227   200302 756100                    STQ     ORG1+1,,AUTO
        46 005230   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005231   000013 631400 47                 EPPR1   11
        46 005232   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 005233   000000 011000                    NOP     0

     1134    22124    3            IF PILL -> ETT.ID = %CVDF

  22124 46 005234   200003 470500                    LDP0    @PILL,,AUTO
        46 005235   000000 471500                    LDP1    0,,PR0
        46 005236   100000 220100                    LDX0    0,,PR1
        46 005237   000020 100003                    CMPX0   16,DU
        46 005240   005253 601000 46                 TNZ     s:22126

     1135    22125    3              THEN CALL Z8HU$INCCNT(PCOM.YOPND,1);

  22125 46 005241   000016 236000 47                 LDQ     14
        46 005242   200303 756100                    STQ     ORG1+2,,AUTO
        46 005243   200004 236100                    LDQ     @PCOM,,AUTO
        46 005244   000062 036003                    ADLQ    50,DU
        46 005245   200302 756100                    STQ     ORG1+1,,AUTO
        46 005246   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005247   000013 631400 47                 EPPR1   11
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:305  
        46 005250   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 005251   000000 011000                    NOP     0
        46 005252   005264 710000 46                 TRA     s:22127

     1136    22126    3              ELSE CALL Z8HU$DEC_COUNT(PCOM.YOPND,1);

  22126 46 005253   000016 236000 47                 LDQ     14
        46 005254   200303 756100                    STQ     ORG1+2,,AUTO
        46 005255   200004 236100                    LDQ     @PCOM,,AUTO
        46 005256   000062 036003                    ADLQ    50,DU
        46 005257   200302 756100                    STQ     ORG1+1,,AUTO
        46 005260   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005261   000013 631400 47                 EPPR1   11
        46 005262   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 005263   000000 011000                    NOP     0

     1137    22127    3            CALL Z8HU$DEC_COUNT(PCOM.FOPND,1);

  22127 46 005264   000016 236000 47                 LDQ     14
        46 005265   200303 756100                    STQ     ORG1+2,,AUTO
        46 005266   200004 236100                    LDQ     @PCOM,,AUTO
        46 005267   000037 036003                    ADLQ    31,DU
        46 005270   200302 756100                    STQ     ORG1+1,,AUTO
        46 005271   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005272   000013 631400 47                 EPPR1   11
        46 005273   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 005274   000000 011000                    NOP     0

     1138    22128    3          END;

  22128 46 005275   021307 710000 46                 TRA     s:26924

     1139    22129
     1140    22130        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:306  
     1141    22131    2   CASE(%CVDQR);

     1142    22132    2        PCOM.SOPND = PILL -> ETT.LOP;

  22132 46 005276   100001 236100                    LDQ     1,,PR1
        46 005277   200004 473500                    LDP3    @PCOM,,AUTO
        46 005300   300054 756100                    STQ     44,,PR3

     1143    22133    2        PCOM.JOPND = PILL -> ETT.LOP;

  22133 46 005301   000000 471500                    LDP1    0,,PR0
        46 005302   100001 236100                    LDQ     1,,PR1
        46 005303   300043 756100                    STQ     35,,PR3

     1144    22134
     1145    22135    2        CALL Z8HU$INCCNT(PILL -> ETT.LOP,1);

  22135 46 005304   000000 471500                    LDP1    0,,PR0
        46 005305   000016 236000 47                 LDQ     14
        46 005306   200303 756100                    STQ     ORG1+2,,AUTO
        46 005307   100001 634500                    EPPR4   1,,PR1
        46 005310   200302 454500                    STP4    ORG1+1,,AUTO
        46 005311   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005312   000013 631400 47                 EPPR1   11
        46 005313   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 005314   000000 011000                    NOP     0
        46 005315   021307 710000 46                 TRA     s:26924

     1146    22136
     1147    22137
     1148    22138    2   CASE(%CVDRR);

     1149    22139    2        PCOM.SOPND = PILL -> ETT.LOP;

  22139 46 005316   100001 236100                    LDQ     1,,PR1
        46 005317   200004 473500                    LDP3    @PCOM,,AUTO
        46 005320   300054 756100                    STQ     44,,PR3
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:307  

     1150    22140    2        PCOM.JOPND = PILL -> ETT.LOP;

  22140 46 005321   000000 471500                    LDP1    0,,PR0
        46 005322   100001 236100                    LDQ     1,,PR1
        46 005323   300043 756100                    STQ     35,,PR3

     1151    22141
     1152    22142    2        CALL Z8HU$INCCNT(PILL -> ETT.LOP,1);

  22142 46 005324   000000 471500                    LDP1    0,,PR0
        46 005325   000016 236000 47                 LDQ     14
        46 005326   200303 756100                    STQ     ORG1+2,,AUTO
        46 005327   100001 634500                    EPPR4   1,,PR1
        46 005330   200302 454500                    STP4    ORG1+1,,AUTO
        46 005331   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005332   000013 631400 47                 EPPR1   11
        46 005333   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 005334   000000 011000                    NOP     0
        46 005335   021307 710000 46                 TRA     s:26924

     1153    22143
     1154    22144
     1155    22145        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:308  
     1156    22146    2   CASE(%CVDSF);

     1157    22147
     1158    22148        /*V*
     1159    22149
     1160    22150                         CVDSF
     1161    22151
     1162    22152                Convert decimal scale factor to zero.
     1163    22153
     1164    22154                Certain of the instructions on the Level 66 require
     1165    22155             a scale factor of zero in order to properly perform
     1166    22156             the operation. A CVDSF triad will be found below any
     1167    22157             triad that will generate one of these demanding
     1168    22158             instructions (CVDI is one such triad).
     1169    22159
     1170    22160             OPERATION:
     1171    22161
     1172    22162                If a zero scale factor is already present, no code
     1173    22163             need be generated.  However, if the scale factor is non-zero,
     1174    22164             an MVN instruction will be generated, moving the data to
     1175    22165             a zero scale factor, leading sign temp.
     1176    22166
     1177    22167        */
     1178    22168    2        P$ = PILL -> ETT.LOP -> ETT.REF$;

  22168 46 005336   100001 473500                    LDP3    1,,PR1
        46 005337   300003 236100                    LDQ     3,,PR3
        46 005340   200064 756100                    STQ     P$,,AUTO

     1179    22169
     1180    22170    2        IF P$ -> REF.NDSC.SF ~= 0

  22170 46 005341   200064 471500                    LDP1    P$,,AUTO
        46 005342   100001 236100                    LDQ     1,,PR1
        46 005343   007700 316007                    CANQ    4032,DL
        46 005344   005347 601000 46                 TNZ     s:22172
        46 005345   030000 316007                    CANQ    12288,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:309  
        46 005346   005353 601000 46                 TNZ     s:22175

     1181    22171    2        OR P$ -> REF.NDSC.S = %FLOATING_POINT_LEADING_SIGN THEN
     1182    22172    2          PCOM.CABS = 1;

  22172 46 005347   000001 235007                    LDA     1,DL
        46 005350   200004 473500                    LDP3    @PCOM,,AUTO
        46 005351   300002 755100                    STA     2,,PR3
        46 005352   021307 710000 46                 TRA     s:26924

     1183    22173    2        ELSE
     1184    22174    3          DO;

     1185    22175    3            PCOM.CABS = 0;

  22175 46 005353   200004 473500                    LDP3    @PCOM,,AUTO
        46 005354   300002 450100                    STZ     2,,PR3

     1186    22176
     1187    22177                 %NEW_REF;

  22179 46 005355   000000 236000 19                 LDQ     HEAD_REF$
        46 005356   000005 116000 47                 CMPQ    5
        46 005357   005406 601000 46                 TNZ     s:22273

  22257 46 005360   000002 236000 41                 LDQ     LTS_+2
        46 005361   000006 036007                    ADLQ    6,DL
        46 005362   000003 116000 41                 CMPQ    LTS_+3
        46 005363   005374 604000 46                 TMI     s:22259

  22258 46 005364   000035 236000 47                 LDQ     29
        46 005365   200302 756100                    STQ     ORG1+1,,AUTO
        46 005366   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 005367   200303 451500                    STP1    ORG1+2,,AUTO
        46 005370   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 005371   000000 631400 47                 EPPR1   0
        46 005372   000000 701000 xent               TSX1    Z8AR$RESERVER
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:310  
        46 005373   000000 011000                    NOP     0

  22259 46 005374   000002 236000 41                 LDQ     LTS_+2
        46 005375   000022 736000                    QLS     18
        46 005376   000001 036000 41                 ADLQ    LTS_+1
        46 005377   000000 756000 40                 STQ     LTS$

  22260 46 005400   000006 236007                    LDQ     6,DL
        46 005401   000002 056000 41                 ASQ     LTS_+2

  22261 46 005402   001111 220003                    LDX0    585,DU
        46 005403   000000 470400 40                 LDP0    LTS$
        46 005404   000000 740100                    STX0    0,,PR0

  22265 46 005405   005412 710000 46                 TRA     s:22283

  22273 46 005406   000000 756000 40                 STQ     LTS$

  22274 46 005407   000000 471400 19                 LDP1    HEAD_REF$
        46 005410   100002 236100                    LDQ     2,,PR1
        46 005411   000000 756000 19                 STQ     HEAD_REF$

  22283 46 005412   000000 054000 15                 AOS     NUMBER_OF_REFS

     1188    22286
     1189    22287    3            LTS$ -> REF = P$ -> REF;

  22287 46 005413   200064 470500                    LDP0    P$,,AUTO
        46 005414   000000 471400 40                 LDP1    LTS$
        46 005415   000100 100500                    MLR     fill='000'O
        46 005416   000000 000030                    ADSC9   0,,PR0                   cn=0,n=24
        46 005417   100000 000030                    ADSC9   0,,PR1                   cn=0,n=24

     1190    22288
     1191    22289                 %IMPLIED_REF(REF$=LTS$, CNT=PILL -> ETT.COUNT);

  22291 46 005420   000000 470400 40                 LDP0    LTS$
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:311  
        46 005421   000002 236100                    LDQ     2,,PR0
        46 005422   000005 116000 47                 CMPQ    5
        46 005423   005442 600000 46                 TZE     s:22293

  22292 46 005424   200003 471500                    LDP1    @PILL,,AUTO
        46 005425   100000 473500                    LDP3    0,,PR1
        46 005426   300000 236100                    LDQ     0,,PR3
        46 005427   777777 376007                    ANQ     -1,DL
        46 005430   200302 756100                    STQ     ORG1+1,,AUTO
        46 005431   200302 633500                    EPPR3   ORG1+1,,AUTO
        46 005432   200305 453500                    STP3    ORG1+4,,AUTO
        46 005433   000000 236000 40                 LDQ     LTS$
        46 005434   000002 036003                    ADLQ    2,DU
        46 005435   200304 756100                    STQ     ORG1+3,,AUTO
        46 005436   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 005437   000013 631400 47                 EPPR1   11
        46 005440   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 005441   000000 011000                    NOP     0

  22293 46 005442   000000 470400 40                 LDP0    LTS$
        46 005443   000003 236100                    LDQ     3,,PR0
        46 005444   000005 116000 47                 CMPQ    5
        46 005445   005464 600000 46                 TZE     s:22295

  22294 46 005446   200003 471500                    LDP1    @PILL,,AUTO
        46 005447   100000 473500                    LDP3    0,,PR1
        46 005450   300000 236100                    LDQ     0,,PR3
        46 005451   777777 376007                    ANQ     -1,DL
        46 005452   200302 756100                    STQ     ORG1+1,,AUTO
        46 005453   200302 633500                    EPPR3   ORG1+1,,AUTO
        46 005454   200305 453500                    STP3    ORG1+4,,AUTO
        46 005455   000000 236000 40                 LDQ     LTS$
        46 005456   000003 036003                    ADLQ    3,DU
        46 005457   200304 756100                    STQ     ORG1+3,,AUTO
        46 005460   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 005461   000013 631400 47                 EPPR1   11
        46 005462   000000 701000 xent               TSX1    Z8HU$INCCNT
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:312  
        46 005463   000000 011000                    NOP     0

  22295 46 005464   000000 470400 40                 LDP0    LTS$
        46 005465   000005 471500                    LDP1    5,,PR0
        46 005466   100000 220100                    LDX0    0,,PR1
        46 005467   000760 100003                    CMPX0   496,DU
        46 005470   005504 601000 46                 TNZ     s:22299

  22296 46 005471   200003 473500                    LDP3    @PILL,,AUTO
        46 005472   300000 474500                    LDP4    0,,PR3
        46 005473   400000 236100                    LDQ     0,,PR4
        46 005474   777777 376007                    ANQ     -1,DL
        46 005475   200302 756100                    STQ     ORG1+1,,AUTO
        46 005476   100004 236100                    LDQ     4,,PR1
        46 005477   000022 732000                    QRS     18
        46 005500   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 005501   000000 620006                    EAX0    0,QL
        46 005502   100004 740100                    STX0    4,,PR1
        46 005503   005525 710000 46                 TRA     s:22304

  22299 46 005504   000004 236100                    LDQ     4,,PR0
        46 005505   000005 116000 47                 CMPQ    5
        46 005506   005525 600000 46                 TZE     s:22304

  22300 46 005507   200003 473500                    LDP3    @PILL,,AUTO
        46 005510   300000 474500                    LDP4    0,,PR3
        46 005511   400000 236100                    LDQ     0,,PR4
        46 005512   777777 376007                    ANQ     -1,DL
        46 005513   200302 756100                    STQ     ORG1+1,,AUTO
        46 005514   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 005515   200305 451500                    STP1    ORG1+4,,AUTO
        46 005516   000000 236000 40                 LDQ     LTS$
        46 005517   000004 036003                    ADLQ    4,DU
        46 005520   200304 756100                    STQ     ORG1+3,,AUTO
        46 005521   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 005522   000013 631400 47                 EPPR1   11
        46 005523   000000 701000 xent               TSX1    Z8HU$INCCNT
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:313  
        46 005524   000000 011000                    NOP     0

     1192    22303
     1193    22304    3            PILL -> ETT.REF$ = LTS$;

  22304 46 005525   200003 470500                    LDP0    @PILL,,AUTO
        46 005526   000000 471500                    LDP1    0,,PR0
        46 005527   000000 236000 40                 LDQ     LTS$
        46 005530   100003 756100                    STQ     3,,PR1

     1194    22305    3            PILL -> ETT.STATE = %REF_T;

  22305 46 005531   000000 471500                    LDP1    0,,PR0
        46 005532   000004 220003                    LDX0    4,DU
        46 005533   100004 740100                    STX0    4,,PR1

     1195    22306    3          END;

  22306 46 005534   021307 710000 46                 TRA     s:26924

     1196    22307
     1197    22308        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:314  
     1198    22309    2   CASE(%CVOD4,%CVOD9);

     1199    22310
     1200    22311    3        DO CASE(CASE_PASS);

  22311 46 005535   200005 473500                    LDP3    @CASE_PASS,,AUTO
        46 005536   300000 235100                    LDA     0,,PR3
        46 005537   000002 115007                    CMPA    2,DL
        46 005540   005542 602005 46                 TNC     s:22311+5,AL
        46 005541   021307 710000 46                 TRA     s:26924
        46 005542   005544 710000 46                 TRA     s:22313
        46 005543   006112 710000 46                 TRA     s:22505

     1201    22312    3          CASE(%FIRST_PASS);

     1202    22313    3            LOP_REF$ = PILL -> ETT.LOP -> ETT.REF$;

  22313 46 005544   100001 474500                    LDP4    1,,PR1
        46 005545   400003 236100                    LDQ     3,,PR4
        46 005546   200101 756100                    STQ     LOP_REF$,,AUTO

     1203    22314
     1204    22315    3            IF LOP_REF$ ->REF.ST$ -> ST.TYPE = %TYF

  22315 46 005547   200101 475500                    LDP5    LOP_REF$,,AUTO
        46 005550   500005 476500                    LDP6    5,,PR5
        46 005551   600002 220100                    LDX0    2,,PR6
        46 005552   000013 100003                    CMPX0   11,DU
        46 005553   005557 601000 46                 TNZ     s:22317

     1205    22316    3              THEN PCOM.IABS = 0; /* Flag for EBCDIC */

  22316 46 005554   200004 477500                    LDP7    @PCOM,,AUTO
        46 005555   700010 450100                    STZ     8,,PR7
        46 005556   005562 710000 46                 TRA     s:22319

     1206    22317    3              ELSE PCOM.IABS = 1; /* Flag for ASCII */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:315  

  22317 46 005557   000001 235007                    LDA     1,DL
        46 005560   200004 477500                    LDP7    @PCOM,,AUTO
        46 005561   700010 755100                    STA     8,,PR7

     1207    22318
     1208    22319    3            IF NOT COMCOM.OB.ELS THEN

  22319 46 005562   000026 234000 xsym               SZN     COMCOM+22
        46 005563   021307 604000 46                 TMI     s:26924

     1209    22320    4              DO;

     1210    22321    4                SIGN = LOP_REF$ -> REF.NDSC.S;

  22321 46 005564   500001 236100                    LDQ     1,,PR5
        46 005565   000026 736000                    QLS     22
        46 005566   600000 376003                    ANQ     -65536,DU
        46 005567   200044 756100                    STQ     SIGN,,AUTO

     1211    22322
     1212    22323    4                IF SIGN = %LEADING_SIGN THEN

  22323 46 005570   200044 236100                    LDQ     SIGN,,AUTO
        46 005571   600000 376003                    ANQ     -65536,DU
        46 005572   200000 116003                    CMPQ    65536,DU
        46 005573   005576 601000 46                 TNZ     s:22326

     1213    22324    4                  PCOM.TABS = 0;

  22324 46 005574   700023 450100                    STZ     19,,PR7
        46 005575   005600 710000 46                 TRA     s:22328

     1214    22325    4                ELSE
     1215    22326    4                  PCOM.TABS = 1;

  22326 46 005576   000001 235007                    LDA     1,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:316  
        46 005577   700023 755100                    STA     19,,PR7

     1216    22327
     1217    22328    4                IF PCOM.IABS = 0 /* EBCDIC */ THEN

  22328 46 005600   700010 235100                    LDA     8,,PR7
        46 005601   005746 601000 46                 TNZ     s:22417

     1218    22329                       %#DNA#(@FROM=PILL -> ETT.LOP,@TO=PCOM.XOPND);

  22331 46 005602   000000 471500                    LDP1    0,,PR0
        46 005603   100001 474500                    LDP4    1,,PR1
        46 005604   400003 476500                    LDP6    3,,PR4
        46 005605   600001 236100                    LDQ     1,,PR6
        46 005606   000077 376007                    ANQ     63,DL
        46 005607   200066 756100                    STQ     J,,AUTO

  22339 46 005610   000000 236000 6                  LDQ     HEAD_ETT$
        46 005611   000005 116000 47                 CMPQ    5
        46 005612   005637 601000 46                 TNZ     s:22351

  22341 46 005613   000002 236000 8                  LDQ     ETT_+2
        46 005614   000005 036007                    ADLQ    5,DL
        46 005615   000003 116000 8                  CMPQ    ETT_+3
        46 005616   005627 604000 46                 TMI     s:22343

  22342 46 005617   000014 236000 47                 LDQ     12
        46 005620   200302 756100                    STQ     ORG1+1,,AUTO
        46 005621   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 005622   200303 451500                    STP1    ORG1+2,,AUTO
        46 005623   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 005624   000000 631400 47                 EPPR1   0
        46 005625   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 005626   000000 011000                    NOP     0

  22343 46 005627   000002 236000 8                  LDQ     ETT_+2
        46 005630   000022 736000                    QLS     18
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:317  
        46 005631   000001 036000 8                  ADLQ    ETT_+1
        46 005632   200004 470500                    LDP0    @PCOM,,AUTO
        46 005633   000061 756100                    STQ     49,,PR0

  22344 46 005634   000005 236007                    LDQ     5,DL
        46 005635   000002 056000 8                  ASQ     ETT_+2

  22345 46 005636   005643 710000 46                 TRA     s:22361

  22351 46 005637   700061 756100                    STQ     49,,PR7

  22352 46 005640   000000 471400 6                  LDP1    HEAD_ETT$
        46 005641   100003 236100                    LDQ     3,,PR1
        46 005642   000000 756000 6                  STQ     HEAD_ETT$

  22361 46 005643   200004 470500                    LDP0    @PCOM,,AUTO
        46 005644   000061 471500                    LDP1    49,,PR0
        46 005645   000007 220003                    LDX0    7,DU
        46 005646   100000 740100                    STX0    0,,PR1

  22366 46 005647   000061 471500                    LDP1    49,,PR0
        46 005650   200003 473500                    LDP3    @PILL,,AUTO
        46 005651   300000 474500                    LDP4    0,,PR3
        46 005652   400001 236100                    LDQ     1,,PR4
        46 005653   100001 756100                    STQ     1,,PR1

  22375 46 005654   000061 471500                    LDP1    49,,PR0
        46 005655   200066 235100                    LDA     J,,AUTO
        46 005656   100002 755100                    STA     2,,PR1

  22377 46 005657   000061 471500                    LDP1    49,,PR0
        46 005660   000000 221003                    LDX1    0,DU
        46 005661   100004 441100                    SXL1    4,,PR1

  22378 46 005662   000061 471500                    LDP1    49,,PR0
        46 005663   000001 236007                    LDQ     1,DL
        46 005664   100004 256100                    ORSQ    4,,PR1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:318  

  22379 46 005665   000061 471500                    LDP1    49,,PR0
        46 005666   000000 222003                    LDX2    0,DU
        46 005667   100000 442100                    SXL2    0,,PR1

  22380 46 005670   000061 471500                    LDP1    49,,PR0
        46 005671   100004 742100                    STX2    4,,PR1

  22381 46 005672   000061 471500                    LDP1    49,,PR0
        46 005673   000005 236000 47                 LDQ     5
        46 005674   100003 756100                    STQ     3,,PR1

  22405 46 005675   300000 471500                    LDP1    0,,PR3
        46 005676   000016 236000 47                 LDQ     14
        46 005677   200303 756100                    STQ     ORG1+2,,AUTO
        46 005700   100001 634500                    EPPR4   1,,PR1
        46 005701   200302 454500                    STP4    ORG1+1,,AUTO
        46 005702   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005703   000013 631400 47                 EPPR1   11
        46 005704   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 005705   000000 011000                    NOP     0

  22406 46 005706   200004 236100                    LDQ     @PCOM,,AUTO
        46 005707   000061 036003                    ADLQ    49,DU
        46 005710   200302 756100                    STQ     ORG1+1,,AUTO
        46 005711   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 005712   000000 631400 47                 EPPR1   0
        46 005713   000000 701000 xent               TSX1    Z8HU$WALK
        46 005714   000000 011000                    NOP     0

  22407 46 005715   200003 470500                    LDP0    @PILL,,AUTO
        46 005716   000000 471500                    LDP1    0,,PR0
        46 005717   100001 473500                    LDP3    1,,PR1
        46 005720   300003 474500                    LDP4    3,,PR3
        46 005721   400001 236100                    LDQ     1,,PR4
        46 005722   040000 316007                    CANQ    16384,DL
        46 005723   005740 600000 46                 TZE     s:22411
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:319  
        46 005724   400005 475500                    LDP5    5,,PR4
        46 005725   500002 220100                    LDX0    2,,PR5
        46 005726   000013 100003                    CMPX0   11,DU
        46 005727   005740 600000 46                 TZE     s:22411

  22409 46 005730   200004 476500                    LDP6    @PCOM,,AUTO
        46 005731   600061 477500                    LDP7    49,,PR6
        46 005732   700003 470500                    LDP0    3,,PR7
        46 005733   000001 236100                    LDQ     1,,PR0
        46 005734   000017 376000 47                 ANQ     15
        46 005735   040000 276007                    ORQ     16384,DL
        46 005736   000001 756100                    STQ     1,,PR0
        46 005737   021307 710000 46                 TRA     s:26924

  22411 46 005740   200004 475500                    LDP5    @PCOM,,AUTO
        46 005741   500061 476500                    LDP6    49,,PR5
        46 005742   600003 477500                    LDP7    3,,PR6
        46 005743   000017 236000 47                 LDQ     15
        46 005744   700001 356100                    ANSQ    1,,PR7

  22412 46 005745   021307 710000 46                 TRA     s:26924

     1219    22414    4                ELSE
     1220    22415                       %#DNA#(@FROM=PILL -> ETT.LOP,@TO=PCOM.OOPND);

  22417 46 005746   000000 471500                    LDP1    0,,PR0
        46 005747   100001 474500                    LDP4    1,,PR1
        46 005750   400003 476500                    LDP6    3,,PR4
        46 005751   600001 236100                    LDQ     1,,PR6
        46 005752   000077 376007                    ANQ     63,DL
        46 005753   200066 756100                    STQ     J,,AUTO

  22425 46 005754   000000 236000 6                  LDQ     HEAD_ETT$
        46 005755   000005 116000 47                 CMPQ    5
        46 005756   006003 601000 46                 TNZ     s:22437

  22427 46 005757   000002 236000 8                  LDQ     ETT_+2
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:320  
        46 005760   000005 036007                    ADLQ    5,DL
        46 005761   000003 116000 8                  CMPQ    ETT_+3
        46 005762   005773 604000 46                 TMI     s:22429

  22428 46 005763   000014 236000 47                 LDQ     12
        46 005764   200302 756100                    STQ     ORG1+1,,AUTO
        46 005765   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 005766   200303 451500                    STP1    ORG1+2,,AUTO
        46 005767   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 005770   000000 631400 47                 EPPR1   0
        46 005771   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 005772   000000 011000                    NOP     0

  22429 46 005773   000002 236000 8                  LDQ     ETT_+2
        46 005774   000022 736000                    QLS     18
        46 005775   000001 036000 8                  ADLQ    ETT_+1
        46 005776   200004 470500                    LDP0    @PCOM,,AUTO
        46 005777   000050 756100                    STQ     40,,PR0

  22430 46 006000   000005 236007                    LDQ     5,DL
        46 006001   000002 056000 8                  ASQ     ETT_+2

  22431 46 006002   006007 710000 46                 TRA     s:22447

  22437 46 006003   700050 756100                    STQ     40,,PR7

  22438 46 006004   000000 471400 6                  LDP1    HEAD_ETT$
        46 006005   100003 236100                    LDQ     3,,PR1
        46 006006   000000 756000 6                  STQ     HEAD_ETT$

  22447 46 006007   200004 470500                    LDP0    @PCOM,,AUTO
        46 006010   000050 471500                    LDP1    40,,PR0
        46 006011   000007 220003                    LDX0    7,DU
        46 006012   100000 740100                    STX0    0,,PR1

  22452 46 006013   000050 471500                    LDP1    40,,PR0
        46 006014   200003 473500                    LDP3    @PILL,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:321  
        46 006015   300000 474500                    LDP4    0,,PR3
        46 006016   400001 236100                    LDQ     1,,PR4
        46 006017   100001 756100                    STQ     1,,PR1

  22461 46 006020   000050 471500                    LDP1    40,,PR0
        46 006021   200066 235100                    LDA     J,,AUTO
        46 006022   100002 755100                    STA     2,,PR1

  22463 46 006023   000050 471500                    LDP1    40,,PR0
        46 006024   000000 221003                    LDX1    0,DU
        46 006025   100004 441100                    SXL1    4,,PR1

  22464 46 006026   000050 471500                    LDP1    40,,PR0
        46 006027   000001 236007                    LDQ     1,DL
        46 006030   100004 256100                    ORSQ    4,,PR1

  22465 46 006031   000050 471500                    LDP1    40,,PR0
        46 006032   000000 222003                    LDX2    0,DU
        46 006033   100000 442100                    SXL2    0,,PR1

  22466 46 006034   000050 471500                    LDP1    40,,PR0
        46 006035   100004 742100                    STX2    4,,PR1

  22467 46 006036   000050 471500                    LDP1    40,,PR0
        46 006037   000005 236000 47                 LDQ     5
        46 006040   100003 756100                    STQ     3,,PR1

  22491 46 006041   300000 471500                    LDP1    0,,PR3
        46 006042   000016 236000 47                 LDQ     14
        46 006043   200303 756100                    STQ     ORG1+2,,AUTO
        46 006044   100001 634500                    EPPR4   1,,PR1
        46 006045   200302 454500                    STP4    ORG1+1,,AUTO
        46 006046   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 006047   000013 631400 47                 EPPR1   11
        46 006050   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 006051   000000 011000                    NOP     0

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:322  
  22492 46 006052   200004 236100                    LDQ     @PCOM,,AUTO
        46 006053   000050 036003                    ADLQ    40,DU
        46 006054   200302 756100                    STQ     ORG1+1,,AUTO
        46 006055   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 006056   000000 631400 47                 EPPR1   0
        46 006057   000000 701000 xent               TSX1    Z8HU$WALK
        46 006060   000000 011000                    NOP     0

  22493 46 006061   200003 470500                    LDP0    @PILL,,AUTO
        46 006062   000000 471500                    LDP1    0,,PR0
        46 006063   100001 473500                    LDP3    1,,PR1
        46 006064   300003 474500                    LDP4    3,,PR3
        46 006065   400001 236100                    LDQ     1,,PR4
        46 006066   040000 316007                    CANQ    16384,DL
        46 006067   006104 600000 46                 TZE     s:22497
        46 006070   400005 475500                    LDP5    5,,PR4
        46 006071   500002 220100                    LDX0    2,,PR5
        46 006072   000013 100003                    CMPX0   11,DU
        46 006073   006104 600000 46                 TZE     s:22497

  22495 46 006074   200004 476500                    LDP6    @PCOM,,AUTO
        46 006075   600050 477500                    LDP7    40,,PR6
        46 006076   700003 470500                    LDP0    3,,PR7
        46 006077   000001 236100                    LDQ     1,,PR0
        46 006100   000017 376000 47                 ANQ     15
        46 006101   040000 276007                    ORQ     16384,DL
        46 006102   000001 756100                    STQ     1,,PR0
        46 006103   021307 710000 46                 TRA     s:26924

  22497 46 006104   200004 475500                    LDP5    @PCOM,,AUTO
        46 006105   500050 476500                    LDP6    40,,PR5
        46 006106   600003 477500                    LDP7    3,,PR6
        46 006107   000017 236000 47                 LDQ     15
        46 006110   700001 356100                    ANSQ    1,,PR7

     1221    22500    4              END;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:323  
  22500 46 006111   021307 710000 46                 TRA     s:26924

     1222    22501
     1223    22502    3          CASE(%SECOND_PASS);

     1224    22503                 %#DNA#(@FROM=PCOM.NOPND,@TO=PCOM.XOPND);

  22505 46 006112   200004 474500                    LDP4    @PCOM,,AUTO
        46 006113   400047 475500                    LDP5    39,,PR4
        46 006114   500003 476500                    LDP6    3,,PR5
        46 006115   600001 236100                    LDQ     1,,PR6
        46 006116   000077 376007                    ANQ     63,DL
        46 006117   200066 756100                    STQ     J,,AUTO

  22513 46 006120   000000 236000 6                  LDQ     HEAD_ETT$
        46 006121   000005 116000 47                 CMPQ    5
        46 006122   006147 601000 46                 TNZ     s:22525

  22515 46 006123   000002 236000 8                  LDQ     ETT_+2
        46 006124   000005 036007                    ADLQ    5,DL
        46 006125   000003 116000 8                  CMPQ    ETT_+3
        46 006126   006137 604000 46                 TMI     s:22517

  22516 46 006127   000014 236000 47                 LDQ     12
        46 006130   200302 756100                    STQ     ORG1+1,,AUTO
        46 006131   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 006132   200303 451500                    STP1    ORG1+2,,AUTO
        46 006133   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 006134   000000 631400 47                 EPPR1   0
        46 006135   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 006136   000000 011000                    NOP     0

  22517 46 006137   000002 236000 8                  LDQ     ETT_+2
        46 006140   000022 736000                    QLS     18
        46 006141   000001 036000 8                  ADLQ    ETT_+1
        46 006142   200004 470500                    LDP0    @PCOM,,AUTO
        46 006143   000061 756100                    STQ     49,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:324  

  22518 46 006144   000005 236007                    LDQ     5,DL
        46 006145   000002 056000 8                  ASQ     ETT_+2

  22519 46 006146   006153 710000 46                 TRA     s:22535

  22525 46 006147   400061 756100                    STQ     49,,PR4

  22526 46 006150   000000 471400 6                  LDP1    HEAD_ETT$
        46 006151   100003 236100                    LDQ     3,,PR1
        46 006152   000000 756000 6                  STQ     HEAD_ETT$

  22535 46 006153   200004 470500                    LDP0    @PCOM,,AUTO
        46 006154   000061 471500                    LDP1    49,,PR0
        46 006155   000007 220003                    LDX0    7,DU
        46 006156   100000 740100                    STX0    0,,PR1

  22540 46 006157   000061 471500                    LDP1    49,,PR0
        46 006160   000047 236100                    LDQ     39,,PR0
        46 006161   100001 756100                    STQ     1,,PR1

  22549 46 006162   000061 471500                    LDP1    49,,PR0
        46 006163   200066 235100                    LDA     J,,AUTO
        46 006164   100002 755100                    STA     2,,PR1

  22551 46 006165   000061 471500                    LDP1    49,,PR0
        46 006166   000000 221003                    LDX1    0,DU
        46 006167   100004 441100                    SXL1    4,,PR1

  22552 46 006170   000061 471500                    LDP1    49,,PR0
        46 006171   000001 236007                    LDQ     1,DL
        46 006172   100004 256100                    ORSQ    4,,PR1

  22553 46 006173   000061 471500                    LDP1    49,,PR0
        46 006174   000000 222003                    LDX2    0,DU
        46 006175   100000 442100                    SXL2    0,,PR1

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:325  
  22554 46 006176   000061 471500                    LDP1    49,,PR0
        46 006177   100004 742100                    STX2    4,,PR1

  22555 46 006200   000061 471500                    LDP1    49,,PR0
        46 006201   000005 236000 47                 LDQ     5
        46 006202   100003 756100                    STQ     3,,PR1

  22579 46 006203   000016 236000 47                 LDQ     14
        46 006204   200303 756100                    STQ     ORG1+2,,AUTO
        46 006205   200004 236100                    LDQ     @PCOM,,AUTO
        46 006206   000047 036003                    ADLQ    39,DU
        46 006207   200302 756100                    STQ     ORG1+1,,AUTO
        46 006210   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 006211   000013 631400 47                 EPPR1   11
        46 006212   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 006213   000000 011000                    NOP     0

  22580 46 006214   200004 236100                    LDQ     @PCOM,,AUTO
        46 006215   000061 036003                    ADLQ    49,DU
        46 006216   200302 756100                    STQ     ORG1+1,,AUTO
        46 006217   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 006220   000000 631400 47                 EPPR1   0
        46 006221   000000 701000 xent               TSX1    Z8HU$WALK
        46 006222   000000 011000                    NOP     0

  22581 46 006223   200004 470500                    LDP0    @PCOM,,AUTO
        46 006224   000047 471500                    LDP1    39,,PR0
        46 006225   100003 473500                    LDP3    3,,PR1
        46 006226   300001 236100                    LDQ     1,,PR3
        46 006227   040000 316007                    CANQ    16384,DL
        46 006230   006244 600000 46                 TZE     s:22585
        46 006231   300005 474500                    LDP4    5,,PR3
        46 006232   400002 220100                    LDX0    2,,PR4
        46 006233   000013 100003                    CMPX0   11,DU
        46 006234   006244 600000 46                 TZE     s:22585

  22583 46 006235   000061 475500                    LDP5    49,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:326  
        46 006236   500003 476500                    LDP6    3,,PR5
        46 006237   600001 236100                    LDQ     1,,PR6
        46 006240   000017 376000 47                 ANQ     15
        46 006241   040000 276007                    ORQ     16384,DL
        46 006242   600001 756100                    STQ     1,,PR6
        46 006243   021307 710000 46                 TRA     s:26924

  22585 46 006244   000061 474500                    LDP4    49,,PR0
        46 006245   400003 475500                    LDP5    3,,PR4
        46 006246   000017 236000 47                 LDQ     15
        46 006247   500001 356100                    ANSQ    1,,PR5

     1225    22588
     1226    22589    3        END /* Case */;

  22589 46 006250   021307 710000 46                 TRA     s:26924

     1227    22590        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:327  
     1228    22591    2   CASE(%CVQD4,%CVQD9);

     1229    22592    2        PCOM.SOPND = PILL -> ETT.LOP;

  22592 46 006251   100001 236100                    LDQ     1,,PR1
        46 006252   200004 473500                    LDP3    @PCOM,,AUTO
        46 006253   300054 756100                    STQ     44,,PR3

     1230    22593    2        PCOM.JOPND = PCOM.ROPND;

  22593 46 006254   300053 236100                    LDQ     43,,PR3
        46 006255   300043 756100                    STQ     35,,PR3

     1231    22594
     1232    22595    2        CALL Z8HU$INCCNT(PCOM.ROPND,1);

  22595 46 006256   000016 236000 47                 LDQ     14
        46 006257   200303 756100                    STQ     ORG1+2,,AUTO
        46 006260   200004 236100                    LDQ     @PCOM,,AUTO
        46 006261   000053 036003                    ADLQ    43,DU
        46 006262   200302 756100                    STQ     ORG1+1,,AUTO
        46 006263   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 006264   000013 631400 47                 EPPR1   11
        46 006265   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 006266   000000 011000                    NOP     0
        46 006267   021307 710000 46                 TRA     s:26924

     1233    22596
     1234    22597
     1235    22598    2   CASE(%CVRD4,%CVRD9);

     1236    22599    2        PCOM.SOPND = PILL -> ETT.LOP;

  22599 46 006270   100001 236100                    LDQ     1,,PR1
        46 006271   200004 473500                    LDP3    @PCOM,,AUTO
        46 006272   300054 756100                    STQ     44,,PR3

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:328  
     1237    22600    2        PCOM.JOPND = PCOM.ROPND;

  22600 46 006273   300053 236100                    LDQ     43,,PR3
        46 006274   300043 756100                    STQ     35,,PR3

     1238    22601
     1239    22602    2        CALL Z8HU$INCCNT(PCOM.ROPND,1);

  22602 46 006275   000016 236000 47                 LDQ     14
        46 006276   200303 756100                    STQ     ORG1+2,,AUTO
        46 006277   200004 236100                    LDQ     @PCOM,,AUTO
        46 006300   000053 036003                    ADLQ    43,DU
        46 006301   200302 756100                    STQ     ORG1+1,,AUTO
        46 006302   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 006303   000013 631400 47                 EPPR1   11
        46 006304   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 006305   000000 011000                    NOP     0
        46 006306   021307 710000 46                 TRA     s:26924

     1240    22603
     1241    22604
     1242    22605        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:329  
     1243    22606    2   CASE(%CVRQ);

     1244    22607        /*V*
     1245    22608
     1246    22609                                       CVRQ
     1247    22610
     1248    22611            PURPOSE: Determine if ARQ register was used for other than for floating point
     1249    22612                     generation.
     1250    22613        DESCRIPTION: Before performing conversion from single to double precision,
     1251    22614                     it must be determined if the ARQ has been used for other than
     1252    22615                     floating point operations.  This is done because if the register
     1253    22616                     has been used, it must be reset to zero before double
     1254    22617                     precision operations can be performed.
     1255    22618
     1256    22619                     Examples::
     1257    22620
     1258    22621                         Used  MOVE R TO Q(I).     Unused  MOVE Q TO R.
     1259    22622                         ====                      ======
     1260    22623
     1261    22624                         FLD     R                 FLD      R
     1262    22625                         LDQ     I                 DFSTR    Q
     1263    22626                         QLS     1
     1264    22627                         EAX7    0,QL
     1265    22628                         LDQ     0,DL *
     1266    22629                         DFSTR   Q,X7
     1267    22630
     1268    22631
     1269    22632                         Dirty               Not Dirty
     1270    22633         PCOM.XABS         1                     0
     1271    22634
     1272    22635        */
     1273    22636
     1274    22637    2        IF RAT.B.DIRTY_ARQ(%AREA) THEN

  22637 46 006307   000105 236000 12                 LDQ     RAT+69
        46 006310   040000 316003                    CANQ    16384,DU
        46 006311   006316 600000 46                 TZE     s:22640
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:330  

     1275    22638    2          PCOM.XABS = 1;

  22638 46 006312   000001 235007                    LDA     1,DL
        46 006313   200004 473500                    LDP3    @PCOM,,AUTO
        46 006314   300027 755100                    STA     23,,PR3
        46 006315   021307 710000 46                 TRA     s:26924

     1276    22639    2        ELSE
     1277    22640    2          PCOM.XABS = 0;

  22640 46 006316   200004 473500                    LDP3    @PCOM,,AUTO
        46 006317   300027 450100                    STZ     23,,PR3
        46 006320   021307 710000 46                 TRA     s:26924

     1278    22641
     1279    22642        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:331  
     1280    22643        %IF GCOS;
     1281    22644 C      CASE(%CVT);
     1282    22645 C
     1283    22646 C           IF PILL -> ETT.ROP -> ETT.ID = %TRIAD
     1284    22647 C               OR PILL -> ETT.ROP -> ETT.ID = %BASE THEN
     1285    22648 C             PCOM.DABS = 0;
     1286    22649 C           ELSE
     1287    22650 C             PCOM.DABS = 1;
     1288    22651 C
     1289    22652 C      %EJECT;
     1290    22653        %ENDIF;
     1291    22654    2   CASE(%DEFLB);

     1292    22655
     1293    22656            %IF GCOS;
     1294    22657 C          IF PILL -> ILL.LOP -> LABEL.B.EXIT_PROG_LABEL THEN
     1295    22658 C            CALL RESTORE_GLOBAL_REGISTERS;
     1296    22659            %ENDIF;
     1297    22660
     1298    22661        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:332  
     1299    22662    2   CASE(%DISPL);

     1300    22663
     1301    22664    2        ARGLIST$ = PILL -> ETT.ROP;

  22664 46 006321   100002 236100                    LDQ     2,,PR1
        46 006322   200120 756100                    STQ     ARGLIST$,,AUTO

     1302    22665    2        NUMBER_OF_ARGS = ARGLIST$ -> LTS.N - 1;

  22665 46 006323   200120 473500                    LDP3    ARGLIST$,,AUTO
        46 006324   300000 236100                    LDQ     0,,PR3
        46 006325   777777 376007                    ANQ     -1,DL
        46 006326   000001 136007                    SBLQ    1,DL
        46 006327   200121 756100                    STQ     NUMBER_OF_ARGS,,AUTO

     1303    22666
     1304    22667    3        DO CASE(CASE_PASS);

  22667 46 006330   200005 474500                    LDP4    @CASE_PASS,,AUTO
        46 006331   400000 235100                    LDA     0,,PR4
        46 006332   000002 115007                    CMPA    2,DL
        46 006333   006335 602005 46                 TNC     s:22667+5,AL
        46 006334   021307 710000 46                 TRA     s:26924
        46 006335   006337 710000 46                 TRA     s:22669
        46 006336   006343 710000 46                 TRA     s:22674

     1305    22668    3          CASE(%FIRST_PASS);

     1306    22669    3            PCOM.OABS = 0;

  22669 46 006337   200004 475500                    LDP5    @PCOM,,AUTO
        46 006340   500016 450100                    STZ     14,,PR5

     1307    22670
     1308    22671    3            PCOM.DABS = NUMBER_OF_ARGS;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:333  
  22671 46 006341   500003 756100                    STQ     3,,PR5
        46 006342   021307 710000 46                 TRA     s:26924

     1309    22672
     1310    22673    3          CASE(%SECOND_PASS);

     1311    22674    4            DO I = 0 TO NUMBER_OF_ARGS - 1;

  22674 46 006343   200065 450100                    STZ     I,,AUTO
        46 006344   006361 710000 46                 TRA     s:22676+1

     1312    22675    4              CALL Z8HU$DEC_COUNT(ARGLIST$ -> ARGLIST.ARG$(I),1);

  22675 46 006345   000016 236000 47                 LDQ     14
        46 006346   200303 756100                    STQ     ORG1+2,,AUTO
        46 006347   200065 236100                    LDQ     I,,AUTO
        46 006350   000022 736000                    QLS     18
        46 006351   000001 036003                    ADLQ    1,DU
        46 006352   200120 036100                    ADLQ    ARGLIST$,,AUTO
        46 006353   200302 756100                    STQ     ORG1+1,,AUTO
        46 006354   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 006355   000013 631400 47                 EPPR1   11
        46 006356   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 006357   000000 011000                    NOP     0

     1313    22676    4            END;

  22676 46 006360   200065 054100                    AOS     I,,AUTO
        46 006361   200065 236100                    LDQ     I,,AUTO
        46 006362   200121 116100                    CMPQ    NUMBER_OF_ARGS,,AUTO
        46 006363   006345 604000 46                 TMI     s:22675

     1314    22677
     1315    22678    3        END /* Case */;

  22678 46 006364   021307 710000 46                 TRA     s:26924

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:334  
     1316    22679        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:335  
     1317    22680    2   CASE(%DOEND);

     1318    22681
     1319    22682        /*V*
     1320    22683
     1321    22684                       DOEND
     1322    22685
     1323    22686               See individual DO items (DO1, DO2, etc.).
     1324    22687
     1325    22688        */
     1326    22689
     1327    22690    2        PCOM.IABS = PILL -> DO_N.ITB -> ILS.ILL$ -> DO_N.ID - %DO1;

  22690 46 006365   100001 473500                    LDP3    1,,PR1
        46 006366   300003 474500                    LDP4    3,,PR3
        46 006367   400000 236100                    LDQ     0,,PR4
        46 006370   000022 772000                    QRL     18
        46 006371   000375 136007                    SBLQ    253,DL
        46 006372   200004 475500                    LDP5    @PCOM,,AUTO
        46 006373   500010 756100                    STQ     8,,PR5

     1328    22691    2        IF PCOM.IABS = %(DO3 - DO1) THEN

  22691 46 006374   000002 116007                    CMPQ    2,DL
        46 006375   006455 601000 46                 TNZ     s:22708

     1329    22692    3          DO;

     1330    22693    3            GLIST$ = PILL -> DO_N.ITB -> ILS.ILL$ -> DO_N.GLIST;

  22693 46 006376   000000 471500                    LDP1    0,,PR0
        46 006377   100001 473500                    LDP3    1,,PR1
        46 006400   300003 474500                    LDP4    3,,PR3
        46 006401   400002 236100                    LDQ     2,,PR4
        46 006402   200122 756100                    STQ     GLIST$,,AUTO

     1331    22694    3            IF GLIST$ ~= ZERO_PTR$ AND
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:336  

  22694 46 006403   000011 116000 44                 CMPQ    ZERO_WORD
        46 006404   006455 600000 46                 TZE     s:22708
        46 006405   000005 116000 47                 CMPQ    5
        46 006406   006455 600000 46                 TZE     s:22708

     1332    22695    4                GLIST$ ~= ADDR (NIL) THEN DO;

     1333    22696    4              J = GLIST$ -> LTS_PTR_ARRAY.N - 3;

  22696 46 006407   200122 476500                    LDP6    GLIST$,,AUTO
        46 006410   600000 236100                    LDQ     0,,PR6
        46 006411   777777 376007                    ANQ     -1,DL
        46 006412   000003 136007                    SBLQ    3,DL
        46 006413   200066 756100                    STQ     J,,AUTO

     1334    22697    5              DO I = 0 TO J;

  22697 46 006414   200065 450100                    STZ     I,,AUTO
        46 006415   006452 710000 46                 TRA     s:22705+1

     1335    22698    6                IF GLIST$ -> LTS_PTR_ARRAY.P$ (I) ~= ADDR (NIL) THEN DO;

  22698 46 006416   200122 470500                    LDP0    GLIST$,,AUTO
        46 006417   200065 720100                    LXL0    I,,AUTO
        46 006420   000002 236110                    LDQ     2,X0,PR0
        46 006421   000005 116000 47                 CMPQ    5
        46 006422   006451 600000 46                 TZE     s:22705

     1336    22699    6                  GLIST$ -> LTS_PTR_ARRAY.P$ (I) -> ETT.B.OPT_SEARCH = FALSE;

  22699 46 006423   000002 471510                    LDP1    2,X0,PR0
        46 006424   000004 236000 47                 LDQ     4
        46 006425   100004 356100                    ANSQ    4,,PR1

     1337    22700    6                  REGISTER = GLIST$ -> LTS_PTR_ARRAY.P$ (I) -> ETT.STATE;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:337  
  22700 46 006426   200065 720100                    LXL0    I,,AUTO
        46 006427   000002 471510                    LDP1    2,X0,PR0
        46 006430   100004 236100                    LDQ     4,,PR1
        46 006431   000022 772000                    QRL     18
        46 006432   200074 756100                    STQ     REGISTER,,AUTO

     1338    22701    6                  RAT.CLASS (REGISTER) = %DEMAND;

  22701 46 006433   200074 235100                    LDA     REGISTER,,AUTO
        46 006434   000002 735000                    ALS     2
        46 006435   000003 450005 12                 STZ     RAT+3,AL

     1339    22702    6                  CALL Z8HU$DEC_COUNT(GLIST$ -> LTS_PTR_ARRAY.P$ (I),

  22702 46 006436   000016 236000 47                 LDQ     14
        46 006437   200303 756100                    STQ     ORG1+2,,AUTO
        46 006440   200065 236100                    LDQ     I,,AUTO
        46 006441   000022 736000                    QLS     18
        46 006442   000002 036003                    ADLQ    2,DU
        46 006443   200122 036100                    ADLQ    GLIST$,,AUTO
        46 006444   200302 756100                    STQ     ORG1+1,,AUTO
        46 006445   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 006446   000013 631400 47                 EPPR1   11
        46 006447   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 006450   000000 011000                    NOP     0

     1340    22703    6                                      1);
     1341    22704    6                END;

     1342    22705    5              END; /* DO I = 0 TO J */

  22705 46 006451   200065 054100                    AOS     I,,AUTO
        46 006452   200065 236100                    LDQ     I,,AUTO
        46 006453   200066 116100                    CMPQ    J,,AUTO
        46 006454   006416 604400 46                 TMOZ    s:22698

     1343    22706    4            END; /* DO_N.GLIST ~= 0 OR ADDR (NIL) */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:338  

     1344    22707    3          END; /* IABS = %(DO3 - DO1) */

     1345    22708    2        PCOM.XOPND = PILL -> DO_N.ITB -> ILS.ILL$ -> DO_N.TEMP;

  22708 46 006455   200003 470500                    LDP0    @PILL,,AUTO
        46 006456   000000 471500                    LDP1    0,,PR0
        46 006457   100001 473500                    LDP3    1,,PR1
        46 006460   300003 474500                    LDP4    3,,PR3
        46 006461   400006 236100                    LDQ     6,,PR4
        46 006462   200004 475500                    LDP5    @PCOM,,AUTO
        46 006463   500061 756100                    STQ     49,,PR5

     1346    22709    2        PCOM.QOPND = PILL -> DO_N.ITB -> ILS.ILL$ -> DO_N.LABEL;

  22709 46 006464   000000 471500                    LDP1    0,,PR0
        46 006465   100001 473500                    LDP3    1,,PR1
        46 006466   300003 474500                    LDP4    3,,PR3
        46 006467   400003 236100                    LDQ     3,,PR4
        46 006470   500052 756100                    STQ     42,,PR5

     1347    22710    2        PCOM.EOPND = PILL -> DO_N.ITB -> ILS.ILL$ -> DO_N.END_LAB$;

  22710 46 006471   000000 471500                    LDP1    0,,PR0
        46 006472   100001 473500                    LDP3    1,,PR1
        46 006473   300003 474500                    LDP4    3,,PR3
        46 006474   400010 236100                    LDQ     8,,PR4
        46 006475   500036 756100                    STQ     30,,PR5

     1348    22711
     1349    22712    2        CUR_LOOP_LEVEL = CUR_LOOP_LEVEL - 1;

  22712 46 006476   000001 336007                    LCQ     1,DL
        46 006477   000000 056000 23                 ASQ     CUR_LOOP_LEVEL
        46 006500   021307 710000 46                 TRA     s:26924

     1350    22713
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:339  
     1351    22714        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:340  
     1352    22715    2   CASE(%DO1, %DO4, %DO5);

     1353    22716
     1354    22717    2        CUR_LOOP_LEVEL = CUR_LOOP_LEVEL + 1;

  22717 46 006501   000000 054000 23                 AOS     CUR_LOOP_LEVEL
        46 006502   021307 710000 46                 TRA     s:26924

     1355    22718
     1356    22719        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:341  
     1357    22720    2   CASE(%DO3);

     1358    22721
     1359    22722        /*V*
     1360    22723                         DO3
     1361    22724
     1362    22725                If this DO3 is for the SEARCH statement then there may be up to
     1363    22726             3 ESC/ARGP triads that require special handling. If one is already
     1364    22727             assigned global, delete it from the list. Otherwise load it if
     1365    22728             necessary and mark it temporarily global until the DOEND.
     1366    22729
     1367    22730        */
     1368    22731
     1369    22732    2        CUR_LOOP_LEVEL = CUR_LOOP_LEVEL + 1;

  22732 46 006503   000000 054000 23                 AOS     CUR_LOOP_LEVEL

     1370    22733
     1371    22734    2        GLIST$ = PILL -> DO_N.GLIST;

  22734 46 006504   000000 471500                    LDP1    0,,PR0
        46 006505   100002 236100                    LDQ     2,,PR1
        46 006506   200122 756100                    STQ     GLIST$,,AUTO

     1372    22735    2        IF GLIST$ ~= ZERO_PTR$ AND

  22735 46 006507   000011 116000 44                 CMPQ    ZERO_WORD
        46 006510   021307 600000 46                 TZE     s:26924
        46 006511   000005 116000 47                 CMPQ    5
        46 006512   021307 600000 46                 TZE     s:26924

     1373    22736    3            GLIST$ ~= ADDR (NIL) THEN DO;

     1374    22737    3          J = GLIST$ -> LTS_PTR_ARRAY.N - 3;

  22737 46 006513   200122 473500                    LDP3    GLIST$,,AUTO
        46 006514   300000 236100                    LDQ     0,,PR3
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:342  
        46 006515   777777 376007                    ANQ     -1,DL
        46 006516   000003 136007                    SBLQ    3,DL
        46 006517   200066 756100                    STQ     J,,AUTO

     1375    22738    4          DO I = 0 TO J;

  22738 46 006520   200065 450100                    STZ     I,,AUTO
        46 006521   006621 710000 46                 TRA     s:22756+1

     1376    22739    5            IF GLIST$ -> LTS_PTR_ARRAY.P$ (I) ~= ADDR (NIL) THEN DO;

  22739 46 006522   200122 470500                    LDP0    GLIST$,,AUTO
        46 006523   200065 720100                    LXL0    I,,AUTO
        46 006524   000002 236110                    LDQ     2,X0,PR0
        46 006525   000005 116000 47                 CMPQ    5
        46 006526   006620 600000 46                 TZE     s:22756

     1377    22740    5              REGISTER = GLIST$ -> LTS_PTR_ARRAY.P$ (I) -> ETT.STATE;

  22740 46 006527   000002 471510                    LDP1    2,X0,PR0
        46 006530   100004 236100                    LDQ     4,,PR1
        46 006531   000022 772000                    QRL     18
        46 006532   200074 756100                    STQ     REGISTER,,AUTO

     1378    22741    6              IF REGISTER < %PR0 OR RAT.CLASS (REGISTER) = %DEMAND THEN DO;

  22741 46 006533   000024 116007                    CMPQ    20,DL
        46 006534   006541 602000 46                 TNC     s:22742
        46 006535   200074 235100                    LDA     REGISTER,,AUTO
        46 006536   000002 735000                    ALS     2
        46 006537   000003 235005 12                 LDA     RAT+3,AL
        46 006540   006616 601000 46                 TNZ     s:22754

     1379    22742    6                GLIST$ -> LTS_PTR_ARRAY.P$ (I) -> ETT.B.OPT_SEARCH = TRUE;

  22742 46 006541   000002 471510                    LDP1    2,X0,PR0
        46 006542   000020 236007                    LDQ     16,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:343  
        46 006543   100004 256100                    ORSQ    4,,PR1

     1380    22743    6                CALL Z8HU$INCCNT(GLIST$ -> LTS_PTR_ARRAY.P$ (I),

  22743 46 006544   000016 236000 47                 LDQ     14
        46 006545   200303 756100                    STQ     ORG1+2,,AUTO
        46 006546   200065 236100                    LDQ     I,,AUTO
        46 006547   000022 736000                    QLS     18
        46 006550   000002 036003                    ADLQ    2,DU
        46 006551   200122 036100                    ADLQ    GLIST$,,AUTO
        46 006552   200302 756100                    STQ     ORG1+1,,AUTO
        46 006553   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 006554   000013 631400 47                 EPPR1   11
        46 006555   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 006556   000000 011000                    NOP     0

     1381    22744    6                                 1);
     1382    22745    7                IF REGISTER < %PR0 THEN DO;

  22745 46 006557   200074 235100                    LDA     REGISTER,,AUTO
        46 006560   000024 115007                    CMPA    20,DL
        46 006561   006611 603000 46                 TRC     s:22751

     1383    22746    7                  K = GLIST$ -> LTS_PTR_ARRAY.P$ (I) -> ETT.ID;

  22746 46 006562   200122 470500                    LDP0    GLIST$,,AUTO
        46 006563   200065 720100                    LXL0    I,,AUTO
        46 006564   000002 471510                    LDP1    2,X0,PR0
        46 006565   100000 236100                    LDQ     0,,PR1
        46 006566   000022 772000                    QRL     18
        46 006567   200067 756100                    STQ     K,,AUTO

     1384    22747    7                  CALL Z8HI$BURST (GLIST$ -> LTS_PTR_ARRAY.P$ (I),

  22747 46 006570   000000 633406 24                 EPPR3   PEPD,QL
        46 006571   200303 453500                    STP3    ORG1+2,,AUTO
        46 006572   200065 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:344  
        46 006573   000022 736000                    QLS     18
        46 006574   000002 036003                    ADLQ    2,DU
        46 006575   200122 036100                    ADLQ    GLIST$,,AUTO
        46 006576   200302 756100                    STQ     ORG1+1,,AUTO
        46 006577   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 006600   000013 631400 47                 EPPR1   11
        46 006601   000000 701000 xent               TSX1    Z8HI$BURST
        46 006602   000000 011000                    NOP     0

     1385    22748    7                                   PEPD (K));
     1386    22749    7                  REGISTER = GLIST$ -> LTS_PTR_ARRAY.P$ (I) -> ETT.STATE;

  22749 46 006603   200122 470500                    LDP0    GLIST$,,AUTO
        46 006604   200065 720100                    LXL0    I,,AUTO
        46 006605   000002 471510                    LDP1    2,X0,PR0
        46 006606   100004 236100                    LDQ     4,,PR1
        46 006607   000022 772000                    QRL     18
        46 006610   200074 756100                    STQ     REGISTER,,AUTO

     1387    22750    7                END;

     1388    22751    6                RAT.CLASS (REGISTER) = %GLOBAL; /* Temporarily GLOBAL until DOEND */

  22751 46 006611   200074 235100                    LDA     REGISTER,,AUTO
        46 006612   000002 735000                    ALS     2
        46 006613   000001 236007                    LDQ     1,DL
        46 006614   000003 756005 12                 STQ     RAT+3,AL

     1389    22752    6              END;

  22752 46 006615   006620 710000 46                 TRA     s:22756

     1390    22753    5              ELSE /* Already GLOBAL */
     1391    22754    5                GLIST$ -> LTS_PTR_ARRAY.P$ (I) = ADDR (NIL);

  22754 46 006616   000005 236000 47                 LDQ     5
        46 006617   000002 756110                    STQ     2,X0,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:345  

     1392    22755    5            END; /* IF LTS_PTR_ARRAY.P$ (I) ~= ADDR (NIL) */

     1393    22756    4          END; /* I = 0 TO J */

  22756 46 006620   200065 054100                    AOS     I,,AUTO
        46 006621   200065 236100                    LDQ     I,,AUTO
        46 006622   200066 116100                    CMPQ    J,,AUTO
        46 006623   006522 604400 46                 TMOZ    s:22739

     1394    22757    3        END; /* DO_N.GLIST ~= ZERO_PTR$ AND ADDR (NIL) */

  22757 46 006624   021307 710000 46                 TRA     s:26924

     1395    22758
     1396    22759        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:346  
     1397    22760    2   CASE(%DO2);

     1398    22761
     1399    22762        /*V*
     1400    22763                         DO2
     1401    22764
     1402    22765                After all of the pre-loop code is generated, we have
     1403    22766             to save away the loop iteration temp address as well as the
     1404    22767             beginning of loop address, both necessary at DOEND time
     1405    22768             (the DOEND generates the post-loop code).
     1406    22769
     1407    22770        */
     1408    22771
     1409    22772
     1410    22773    2        PILL -> DO_N.TEMP = PCOM.XOPND;

  22773 46 006625   200004 473500                    LDP3    @PCOM,,AUTO
        46 006626   300061 236100                    LDQ     49,,PR3
        46 006627   100006 756100                    STQ     6,,PR1

     1411    22774    2        PILL -> DO_N.LABEL = PCOM.QOPND;

  22774 46 006630   000000 471500                    LDP1    0,,PR0
        46 006631   300052 236100                    LDQ     42,,PR3
        46 006632   100003 756100                    STQ     3,,PR1

     1412    22775    2        PILL -> DO_N.END_LAB$ = PCOM.EOPND;

  22775 46 006633   000000 471500                    LDP1    0,,PR0
        46 006634   300036 236100                    LDQ     30,,PR3
        46 006635   100010 756100                    STQ     8,,PR1

     1413    22776
     1414    22777    2        CUR_LOOP_LEVEL = CUR_LOOP_LEVEL + 1;

  22777 46 006636   000000 054000 23                 AOS     CUR_LOOP_LEVEL
        46 006637   021307 710000 46                 TRA     s:26924
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:347  

     1415    22778
     1416    22779        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:348  
     1417    22780    2   CASE(%END);

     1418    22781        /*V*
     1419    22782                  END
     1420    22783
     1421    22784                First Pass -
     1422    22785                    Check to see if there is pending preset data.  If
     1423    22786                    there is any then we have a problem because the
     1424    22787                    linker claims that we can only write into ou locations
     1425    22788                    beyond the current point.  It is likely that pending
     1426    22789                    preset data will be for a location somewhere prior
     1427    22790                    to the current bottom of the ou
     1428    22791
     1429    22792                Second Pass -
     1430    22793                    Clean up:  Check for correct pooling of generator
     1431    22794                    items and check storage allocation.
     1432    22795        */
     1433    22796
     1434    22797    3        DO CASE(CASE_PASS);

  22797 46 006640   200005 473500                    LDP3    @CASE_PASS,,AUTO
        46 006641   300000 235100                    LDA     0,,PR3
        46 006642   000002 115007                    CMPA    2,DL
        46 006643   006645 602005 46                 TNC     s:22797+5,AL
        46 006644   021307 710000 46                 TRA     s:26924
        46 006645   006647 710000 46                 TRA     s:22801
        46 006646   006664 710000 46                 TRA     s:22813

     1435    22798    3          CASE(%FIRST_PASS);

     1436    22799
     1437    22800                 /* ROOT_PROC_BLOCK$ points to the fixed permanent segment */
     1438    22801    3            COMCOM.SEGMENT$(%PROC) = ROOT_PROC_BLOCK$;

  22801 46 006647   000000 236000 27                 LDQ     ROOT_PROC_BLOCK$
        46 006650   000150 756000 xsym               STQ     COMCOM+104

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:349  
     1439    22802
     1440    22803    3            IF BITS_IN_BUFFER ~= 0 THEN

  22803 46 006651   000003 235000 25                 LDA     BITS_IN_BUFFER
        46 006652   021307 600000 46                 TZE     s:26924

     1441    22804    4              DO;

     1442    22805    4                CALL Z8AE$ERROR(%E$PRESET_BUFFER_NOT_EMPTY);

  22805 46 006653   000037 630400 47                 EPPR0   31
        46 006654   000000 631400 47                 EPPR1   0
        46 006655   000000 701000 xent               TSX1    Z8AE$ERROR
        46 006656   000000 011000                    NOP     0

     1443    22806
     1444    22807                     /* Flush pending preset data and see what
     1445    22808                        happens */
     1446    22809    4                CALL FLUSH_BUFFER(OLD_SA);

  22809 46 006657   000040 236000 47                 LDQ     32
        46 006660   200265 756100                    STQ     SEND$+1,,AUTO
        46 006661   021605 701000 46                 TSX1    FLUSH_BUFFER
        46 006662   000000 011000                    NOP     0

     1447    22810    4              END;

  22810 46 006663   021307 710000 46                 TRA     s:26924

     1448    22811
     1449    22812    3          CASE(%SECOND_PASS);

     1450    22813    3            COMCOM.PROC_END = COMCOM.SEGMENT$(%PROC) -> SEGMENT.SIZE - 1;

  22813 46 006664   000150 474400 xsym               LDP4    COMCOM+104
        46 006665   400002 236100                    LDQ     2,,PR4
        46 006666   000022 772000                    QRL     18
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:350  
        46 006667   000001 136007                    SBLQ    1,DL
        46 006670   000147 756000 xsym               STQ     COMCOM+103

     1451    22814
     1452    22815             %IF ~USING_HALF_WORD_RELOCATION;
     1453    22816 C
     1454    22817 C               IF COMCOM.SEGMENTC > 1 THEN
     1455    22818 C                 DO;
     1456    22819 C                   DO WHILE (ROOT_PROC_BLOCK$ ~= ADDR(NIL));
     1457    22820 C
     1458    22821 C                   COMCOM.SEGMENT$(ROOT_PROC_BLOCK$ -> SEGMENT.COUNT) = ROOT_PROC_BLOCK$;
     1459    22822 C                     ROOT_PROC_BLOCK$ = ROOT_PROC_BLOCK$ -> SEGMENT.NEXT;
     1460    22823 C
     1461    22824 C                   END;
     1462    22825 C                 END;
     1463    22826             %ENDIF;
     1464    22827
     1465    22828    4            DO WHILE(CONST$ ~= ADDR(NIL));

  22828 46 006671   006773 710000 46                 TRA     s:22875

     1466    22829
     1467    22830                   %IF ~USING_HALF_WORD_RELOCATION;
     1468    22831 C
     1469    22832 C                   IF COMCOM.SEGMENTC > 1 THEN
     1470    22833 C                     IF CURRENT_BLOCK$ ~=
     1471    22834 C                       COMCOM.SEGMENT$(CONST$ -> CONST.COUNT) THEN
     1472    22835 C                       DO;
     1473    22836 C                         CURRENT_BLOCK$ = COMCOM.SEGMENT$(CONST$ -> CONST.COUNT);
     1474    22837 C
     1475    22838 C                         %NEW_ORG (@ST$ = CURRENT_BLOCK$);
     1476    22839 C
     1477    22840 C                       END;
     1478    22841 C
     1479    22842                   %ENDIF;
     1480    22843
     1481    22844    4              MOD_KEY.B = '0'O;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:351  

  22844 46 006672   000000 450000 25                 STZ     MOD_KEY

     1482    22845
     1483    22846    4              LENGTH = 1;

  22846 46 006673   000001 235007                    LDA     1,DL
        46 006674   200050 755100                    STA     LENGTH,,AUTO

     1484    22847
     1485    22848    4              IF CONST$ -> CONST.B.TWO_WORD THEN

  22848 46 006675   000000 470400 21                 LDP0    CONST$
        46 006676   000003 236100                    LDQ     3,,PR0
        46 006677   200000 316003                    CANQ    65536,DU
        46 006700   006710 600000 46                 TZE     s:22854

     1486    22849    5                DO;

     1487    22850    5                  LENGTH = 2;

  22850 46 006701   000002 235007                    LDA     2,DL
        46 006702   200050 755100                    STA     LENGTH,,AUTO

     1488    22851    5                  CALL Z8HU$FORCE_BOUNDARY(%EVEN);

  22851 46 006703   000034 630400 47                 EPPR0   28
        46 006704   000000 631400 47                 EPPR1   0
        46 006705   000000 701000 xent               TSX1    Z8HU$FORCE_BOUNDARY
        46 006706   000000 011000                    NOP     0

     1489    22852    5                END;

  22852 46 006707   006717 710000 46                 TRA     s:22859

     1490    22853    4              ELSE
     1491    22854    4                IF CONST$ -> CONST.B.LONG_CONSTANT THEN
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:352  

  22854 46 006710   000003 234100                    SZN     3,,PR0
        46 006711   006717 605000 46                 TPL     s:22859

     1492    22855    4                  LENGTH = (CONST$ -> CONST.CONST$.PTR$ -> LCNST.N - 1);

  22855 46 006712   000010 471500                    LDP1    8,,PR0
        46 006713   100000 236100                    LDQ     0,,PR1
        46 006714   777777 376007                    ANQ     -1,DL
        46 006715   000001 136007                    SBLQ    1,DL
        46 006716   200050 756100                    STQ     LENGTH,,AUTO

     1493    22856
     1494    22857                   %GET_CONSTANT_ADDRESS ( @CONSTANT=CONST$, @STRING=STRING$);

  22859 46 006717   000000 470400 21                 LDP0    CONST$
        46 006720   000003 234100                    SZN     3,,PR0
        46 006721   006726 605000 46                 TPL     s:22862

  22860 46 006722   000010 471500                    LDP1    8,,PR0
        46 006723   100001 633500                    EPPR3   1,,PR1
        46 006724   200133 453500                    STP3    STRING$,,AUTO
        46 006725   006731 710000 46                 TRA     s:22866

  22862 46 006726   000000 236000 21                 LDQ     CONST$
        46 006727   000010 036003                    ADLQ    8,DU
        46 006730   200133 756100                    STQ     STRING$,,AUTO

     1495    22865
     1496    22866    4             CALL FLUSH(CONST$,STRING$,BINBIT(CURRENT_BLOCK$->SEGMENT.SIZE,36),LENGTH)
             22866                       ;

  22866 46 006731   000000 471400 26                 LDP1    CURRENT_BLOCK$
        46 006732   100002 236100                    LDQ     2,,PR1
        46 006733   000022 772000                    QRL     18
        46 006734   200310 756100                    STQ     ORG1+7,,AUTO
        46 006735   200050 633500                    EPPR3   LENGTH,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:353  
        46 006736   200272 453500                    STP3    @OPND$+1,,AUTO
        46 006737   200310 634500                    EPPR4   ORG1+7,,AUTO
        46 006740   200271 454500                    STP4    @STRING$+1,,AUTO
        46 006741   200133 635500                    EPPR5   STRING$,,AUTO
        46 006742   200270 455500                    STP5    N_OPNDS+1,,AUTO
        46 006743   000041 236000 47                 LDQ     33
        46 006744   200267 756100                    STQ     P$+1,,AUTO
        46 006745   021724 701000 46                 TSX1    FLUSH
        46 006746   000000 011000                    NOP     0

     1497    22867
     1498    22868    4              CONST$ -> CONST.SA = CURRENT_BLOCK$ -> BLOCK.SIZE;

  22868 46 006747   000000 470400 26                 LDP0    CURRENT_BLOCK$
        46 006750   000002 220100                    LDX0    2,,PR0
        46 006751   000000 471400 21                 LDP1    CONST$
        46 006752   100001 740100                    STX0    1,,PR1

     1499    22869    4              LENGTH = CURRENT_BLOCK$ -> BLOCK.SIZE + LENGTH;

  22869 46 006753   000002 236100                    LDQ     2,,PR0
        46 006754   000022 772000                    QRL     18
        46 006755   200050 036100                    ADLQ    LENGTH,,AUTO
        46 006756   200050 756100                    STQ     LENGTH,,AUTO

     1500    22870    4              IF LENGTH >= %#256K THEN

  22870 46 006757   000001 116003                    CMPQ    1,DU
        46 006760   006765 604000 46                 TMI     s:22872

     1501    22871    4                CALL Z8AE$ERROR (%E$CODE_LIMIT);

  22871 46 006761   000011 630400 47                 EPPR0   9
        46 006762   000000 631400 47                 EPPR1   0
        46 006763   000000 701000 xent               TSX1    Z8AE$ERROR
        46 006764   000000 011000                    NOP     0

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:354  
     1502    22872    4              CURRENT_BLOCK$ -> BLOCK.SIZE = LENGTH;

  22872 46 006765   200050 720100                    LXL0    LENGTH,,AUTO
        46 006766   000000 470400 26                 LDP0    CURRENT_BLOCK$
        46 006767   000002 740100                    STX0    2,,PR0

     1503    22873
     1504    22874    4              CONST$ = CONST$ -> CONST.ALLOC_LINK;

  22874 46 006770   000000 471400 21                 LDP1    CONST$
        46 006771   100005 236100                    LDQ     5,,PR1
        46 006772   000000 756000 21                 STQ     CONST$

     1505    22875    4            END;

  22875 46 006773   000000 236000 21                 LDQ     CONST$
        46 006774   000005 116000 47                 CMPQ    5
        46 006775   006672 601000 46                 TNZ     s:22844

     1506    22876
     1507    22877               %IF ~USING_HALF_WORD_RELOCATION;
     1508    22878 C               GENERATING_PTRS = TRUE;
     1509    22879 C
     1510    22880 C      /* Generate a pointer constant for each data block. If Cobol
     1511    22881 C         segmentation exists, the pointer constant must appear in the
     1512    22882 C         segment that references data in that data block. For this
     1513    22883 C         pointer constant to be generated in the appropriate segment, a
     1514    22884 C         redundant block item of that data block is created and its
     1515    22885 C         .B.SCOUNT field is set to the segment number it belongs to.
     1516    22886 C         For more details, look into the macro call %SEGMENTED_BLOCK_CHECK
     1517    22887 C         which is used in Z8HI. All the redundant block items will be removed
     1518    22888 C         immediately after the pointer constants have been generated, so
     1519    22889 C         phase 5 Z9IO won't generate redundant SECTDEFs.
     1520    22890 C      */
     1521    22891 C
     1522    22892 C               CURRENT_BLOCK$ = COMCOM.SEGMENT$(%PROC);
     1523    22893 C               IF COMCOM.SEGMENTC > 1 THEN
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:355  
     1524    22894 C                 %NEW_ORG(@ST$ = CURRENT_BLOCK$);
     1525    22895 C               P$ = COMCOM.BLOCK$;
     1526    22896 C
     1527    22897 C               DO WHILE(P$ ~= ADDR(NIL));
     1528    22898 C
     1529    22899 C                 IF COMCOM.SEGMENTC > 1 AND
     1530    22900 C                   CURRENT_BLOCK$ ~= COMCOM.SEGMENT$(P$ -> BLOCK.B.SCOUNT) THEN
     1531    22901 C                   DO;
     1532    22902 C                     CURRENT_BLOCK$ = COMCOM.SEGMENT$(P$ -> BLOCK.B.SCOUNT);
     1533    22903 C
     1534    22904 C                     %NEW_ORG (@ST$ = CURRENT_BLOCK$);
     1535    22905 C                   END;
     1536    22906 C
     1537    22907 C                 IF P$ -> BLOCK.B.SZIE_256K
     1538    22908 C                   THEN K = %#256K
     1539    22909 C                   ELSE K = P$ -> BLOCK.SIZE;
     1540    22910 C
     1541    22911 C                 I = CURRENT_BLOCK$ -> SEGMENT.SIZE;
     1542    22912 C
     1543    22913 C                 /* Add a word to be sure .DATA. ends on a full word. */
     1544    22914 C
     1545    22915 C                 IF SUBSTR (P$ -> BLOCK.DNT$ -> DNT.TEXT.NAME, 0, 2) = '.D'
     1546    22916 C                     AND K < %(#256K - 1) THEN
     1547    22917 C                   P$ -> BLOCK.SIZE = P$ -> BLOCK.SIZE + 1;
     1548    22918 C
     1549    22919 C                 DO J = 0 TO K BY %#16K;
     1550    22920 C                   SUPP_DATA.WRD = J * %#256K;
     1551    22921 C                   CALL Z8HI$BURST(P$,DEP.BDEP);
     1552    22922 C                 END;
     1553    22923 C
     1554    22924 C                 P$ -> BLOCK.SA = I;
     1555    22925 C
     1556    22926 C                 P$ = P$ -> BLOCK.NEXT;
     1557    22927 C               END;
     1558    22928 C
     1559    22929 C       /*  Remove redundant block items from the block chain */
     1560    22930 C
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:356  
     1561    22931 C               CURRENT_BLOCK$ = COMCOM.BLOCK$;
     1562    22932 C               P$ = CURRENT_BLOCK$ -> BLOCK.NEXT; /* first block item is good */
     1563    22933 C
     1564    22934 C               DO WHILE (P$ ~= ADDR(NIL));
     1565    22935 C                 IF P$ -> BLOCK.B.SCOUNT ~= %PROC THEN
     1566    22936 C                   CURRENT_BLOCK$ -> BLOCK.NEXT = P$ -> BLOCK.NEXT;
     1567    22937 C                 ELSE
     1568    22938 C                   CURRENT_BLOCK$ = P$;
     1569    22939 C
     1570    22940 C                 P$ = P$ -> BLOCK.NEXT;
     1571    22941 C               END;
     1572    22942 C
     1573    22943 C               CURRENT_BLOCK$ = COMCOM.SEGMENT$(%PROC);
     1574    22944 C               IF COMCOM.SEGMENTC > 1 THEN
     1575    22945 C                 %NEW_ORG(@ST$ = CURRENT_BLOCK$);
     1576    22946 C
     1577    22947 C               P$ = COMCOM.SYMREF$;
     1578    22948 C
     1579    22949 C               DO WHILE (P$ ~= ADDR(NIL));
     1580    22950 C
     1581    22951 C                 IF COMCOM.SEGMENTC > 1 AND
     1582    22952 C                   CURRENT_BLOCK$ ~= COMCOM.SEGMENT$(P$ -> SYMREF_.B.SCOUNT) THEN
     1583    22953 C                   DO;
     1584    22954 C                     CURRENT_BLOCK$ = COMCOM.SEGMENT$(P$ -> SYMREF_.B.SCOUNT);
     1585    22955 C
     1586    22956 C                     %NEW_ORG (@ST$ = CURRENT_BLOCK$);
     1587    22957 C                   END;
     1588    22958 C
     1589    22959 C                 I = COMCOM.BLOCK$ -> SEGMENT.SIZE;
     1590    22960 C
     1591    22961 C                 CALL Z8HI$BURST(P$,DEP.BDEP);
     1592    22962 C
     1593    22963 C                 P$ -> SYMREF_.SA = I;
     1594    22964 C
     1595    22965 C                 P$ = P$ -> SYMREF_.NEXT;
     1596    22966 C               END;
     1597    22967 C
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:357  
     1598    22968 C               I = COMCOM.SEGMENT$(%PROC) -> SEGMENT.SIZE;
     1599    22969 C               P$ = COMCOM.SEGMENT$(%PROC);
     1600    22970 C               CURRENT_BLOCK$ = P$;
     1601    22971 C
     1602    22972 C               %NEW_ORG (@ST$ = P$);
     1603    22973 C
     1604    22974 C               DO J = 0 TO P$ -> SEGMENT.SIZE BY %#16K;
     1605    22975 C                 SUPP_DATA.WRD = J * %#256K;
     1606    22976 C                 CALL Z8HI$BURST(P$,DEP.BDEP);
     1607    22977 C               END;
     1608    22978 C
     1609    22979 C               P$ -> SEGMENT.SA = I;
     1610    22980 C
     1611    22981 C               IF COMCOM.SEGMENTC > 1 THEN
     1612    22982 C                 DO;
     1613    22983 C                   DO K = 1 TO COMCOM.SEGMENTC - 1;
     1614    22984 C                     CURRENT_BLOCK$ = COMCOM.SEGMENT$(K);
     1615    22985 C                     I = CURRENT_BLOCK$ -> SEGMENT.SIZE;
     1616    22986 C
     1617    22987 C                     %NEW_ORG (@ST$ = CURRENT_BLOCK$);
     1618    22988 C
     1619    22989 C                     DO J = 0 TO CURRENT_BLOCK$ -> SEGMENT.SIZE BY %#16K;
     1620    22990 C                       SUPP_DATA.WRD = J * %#256K;
     1621    22991 C                       CALL Z8HI$BURST(CURRENT_BLOCK$,DEP.BDEP);
     1622    22992 C                     END;
     1623    22993 C
     1624    22994 C                     CURRENT_BLOCK$ -> SEGMENT.SA = I;
     1625    22995 C                   END; /* DO K = 1 ... */
     1626    22996 C                 END; /* IF DO ... */
     1627    22997 C
     1628    22998 C               GENERATING_PTRS = FALSE;
     1629    22999               %ENDIF;
     1630    23000
     1631    23001
     1632    23002            /*V*
     1633    23003                          CLEAN_UP
     1634    23004
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:358  
     1635    23005                   This section does storage allocation checking and
     1636    23006                 some global count zeroing.  If all allocated generator
     1637    23007                 items are not pooled, we have a bug.  A fatal error
     1638    23008                 message is issued to force the user to inform maintenance.
     1639    23009
     1640    23010            */
     1641    23011
     1642    23012    3            CALL Z8HU$POOL_PRIME( COMCOM.ESC );

  23012 46 006776   000042 630400 47                 EPPR0   34
        46 006777   000000 631400 47                 EPPR1   0
        46 007000   000000 701000 xent               TSX1    Z8HU$POOL_PRIME
        46 007001   000000 011000                    NOP     0

     1643    23013    3            CALL Z8HU$POOL( COMCOM.ESC );

  23013 46 007002   000042 630400 47                 EPPR0   34
        46 007003   000000 631400 47                 EPPR1   0
        46 007004   000000 701000 xent               TSX1    Z8HU$POOL
        46 007005   000000 011000                    NOP     0

     1644    23014
     1645    23015    3            I = 0;

  23015 46 007006   200065 450100                    STZ     I,,AUTO

     1646    23016
     1647    23017    4            DO WHILE((I <= 3) AND (COMCOM.ESC_LIST.ESC$(I) ~= ADDR(NIL)));

  23017 46 007007   007055 710000 46                 TRA     s:23031

     1648    23018    4              COMCOM.ESC_LIST.ESC$(I) -> ETT.COUNT = 0;

  23018 46 007010   200065 235100                    LDA     I,,AUTO
        46 007011   000001 735000                    ALS     1
        46 007012   000545 470405 xsym               LDP0    COMCOM+357,AL
        46 007013   000000 220003                    LDX0    0,DU
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:359  
        46 007014   000000 440100                    SXL0    0,,PR0

     1649    23019
     1650    23020    4              REGISTER = COMCOM.ESC_LIST.PR#(I);

  23020 46 007015   200065 235100                    LDA     I,,AUTO
        46 007016   000001 735000                    ALS     1
        46 007017   000546 236005 xsym               LDQ     COMCOM+358,AL
        46 007020   000022 732000                    QRS     18
        46 007021   200074 756100                    STQ     REGISTER,,AUTO

     1651    23021    4              PRIME$ = RAT.PRIMES (REGISTER);

  23021 46 007022   200074 235100                    LDA     REGISTER,,AUTO
        46 007023   000002 735000                    ALS     2
        46 007024   000000 236005 12                 LDQ     RAT,AL
        46 007025   200076 756100                    STQ     PRIME$,,AUTO

     1652    23022
     1653    23023    5              DO WHILE PRIME$ ~= ADDR(NIL);

  23023 46 007026   007052 710000 46                 TRA     s:23028

     1654    23024    5                NEXT$ = PRIME$ -> PRIME.NEXT;

  23024 46 007027   200076 470500                    LDP0    PRIME$,,AUTO
        46 007030   000003 236100                    LDQ     3,,PR0
        46 007031   200075 756100                    STQ     NEXT$,,AUTO

     1655    23025    5                CALL Z8HU$POOL_PRIME (PRIME$ -> PRIME.TRIAD);

  23025 46 007032   200076 236100                    LDQ     PRIME$,,AUTO
        46 007033   000001 036003                    ADLQ    1,DU
        46 007034   200302 756100                    STQ     ORG1+1,,AUTO
        46 007035   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 007036   000000 631400 47                 EPPR1   0
        46 007037   000000 701000 xent               TSX1    Z8HU$POOL_PRIME
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:360  
        46 007040   000000 011000                    NOP     0

     1656    23026    5                CALL Z8HU$POOL (PRIME$ -> PRIME.TRIAD);

  23026 46 007041   200076 236100                    LDQ     PRIME$,,AUTO
        46 007042   000001 036003                    ADLQ    1,DU
        46 007043   200302 756100                    STQ     ORG1+1,,AUTO
        46 007044   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 007045   000000 631400 47                 EPPR1   0
        46 007046   000000 701000 xent               TSX1    Z8HU$POOL
        46 007047   000000 011000                    NOP     0

     1657    23027    5                PRIME$ = NEXT$;

  23027 46 007050   200075 236100                    LDQ     NEXT$,,AUTO
        46 007051   200076 756100                    STQ     PRIME$,,AUTO

     1658    23028    5              END; /* Do While more PRIMEs */

  23028 46 007052   000005 116000 47                 CMPQ    5
        46 007053   007027 601000 46                 TNZ     s:23024

     1659    23029
     1660    23030    4              I = I + 1;

  23030 46 007054   200065 054100                    AOS     I,,AUTO

     1661    23031    4            END;

  23031 46 007055   200065 235100                    LDA     I,,AUTO
        46 007056   000003 115007                    CMPA    3,DL
        46 007057   007064 605400 46                 TPNZ    s:23033
        46 007060   000001 735000                    ALS     1
        46 007061   000545 236005 xsym               LDQ     COMCOM+357,AL
        46 007062   000005 116000 47                 CMPQ    5
        46 007063   007010 601000 46                 TNZ     s:23018

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:361  
     1662    23032
     1663    23033    3            CALL Z8HG$FREE_ALL_REGISTERS;

  23033 46 007064   000007 631400 47                 EPPR1   7
        46 007065   000000 701000 xent               TSX1    Z8HG$FREE_ALL_REGISTERS
        46 007066   000000 011000                    NOP     0

     1664    23034
     1665    23035
     1666    23036    3            IF NUMBER_OF_PRIMES ~= 0 THEN

  23036 46 007067   000000 235000 13                 LDA     NUMBER_OF_PRIMES
        46 007070   007075 600000 46                 TZE     s:23039

     1667    23037    3              CALL Z8AE$ERROR(%E$UNPOOLED_PRIMES,COMCOM.CURRENT.LINE,0);

  23037 46 007071   000045 630400 47                 EPPR0   37
        46 007072   000043 631400 47                 EPPR1   35
        46 007073   000000 701000 xent               TSX1    Z8AE$ERROR
        46 007074   000000 011000                    NOP     0

     1668    23038
     1669    23039    3            IF NUMBER_OF_REFS ~= 0 THEN

  23039 46 007075   000000 235000 15                 LDA     NUMBER_OF_REFS
        46 007076   007103 600000 46                 TZE     s:23042

     1670    23040    3              CALL Z8AE$ERROR(%E$UNPOOLED_REFS,COMCOM.CURRENT.LINE,0);

  23040 46 007077   000051 630400 47                 EPPR0   41
        46 007100   000043 631400 47                 EPPR1   35
        46 007101   000000 701000 xent               TSX1    Z8AE$ERROR
        46 007102   000000 011000                    NOP     0

     1671    23041
     1672    23042    3            IF NUMBER_OF_TEMPS ~= 0 THEN

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:362  
  23042 46 007103   000000 235000 14                 LDA     NUMBER_OF_TEMPS
        46 007104   021307 600000 46                 TZE     s:26924

     1673    23043    3              CALL Z8AE$ERROR(%E$UNPOOLED_TEMPS,COMCOM.CURRENT.LINE,0);

  23043 46 007105   000055 630400 47                 EPPR0   45
        46 007106   000043 631400 47                 EPPR1   35
        46 007107   000000 701000 xent               TSX1    Z8AE$ERROR
        46 007110   000000 011000                    NOP     0

     1674    23044    3        END /* Case */;

  23044 46 007111   021307 710000 46                 TRA     s:26924

     1675    23045
     1676    23046        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:363  
     1677    23047    2   CASE(%ENTRY);

     1678    23048
     1679    23049        /*V*
     1680    23050
     1681    23051                           ENTRY
     1682    23052
     1683    23053                This case is entered more than once per ENTRY
     1684    23054             (more than one CASE pseudo-code operation encountered in the
     1685    23055             ENTRY ILL item pseudo-code entry).  All types of entry will
     1686    23056             not use all possible passes (unmanaged routines will only go
     1687    23057             through the first pass).
     1688    23058
     1689    23059               First pass: Get type of entry (Main, subroutine or subroutine-
     1690    23060                     entry).  If subroutine or subroutine entry then set
     1691    23061                     up for call to entry operator and possibly call to
     1692    23062                     call manager in library.
     1693    23063
     1694    23064               Second pass: Put options in SUPP_DATA.
     1695    23065
     1696    23066               Third pass: Set up global registers.
     1697    23067
     1698    23068        */
     1699    23069    3        DO CASE(CASE_PASS);

  23069 46 007112   200005 473500                    LDP3    @CASE_PASS,,AUTO
        46 007113   300000 235100                    LDA     0,,PR3
        46 007114   000003 115007                    CMPA    3,DL
        46 007115   007117 602005 46                 TNC     s:23069+5,AL
        46 007116   021307 710000 46                 TRA     s:26924
        46 007117   007122 710000 46                 TRA     s:23072
        46 007120   007316 710000 46                 TRA     s:23158
        46 007121   007365 710000 46                 TRA     s:23173

     1700    23070    3          CASE(%FIRST_PASS);

     1701    23071
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:364  
     1702    23072    3            PCOM.XOPND = COMCOM.ESC;

  23072 46 007122   000007 236000 xsym               LDQ     COMCOM+7
        46 007123   200004 474500                    LDP4    @PCOM,,AUTO
        46 007124   400061 756100                    STQ     49,,PR4

     1703    23073    3            PCOM.ZOPND = COMCOM.ESC -> ETT.LOP;

  23073 46 007125   000007 471400 xsym               LDP1    COMCOM+7
        46 007126   100001 236100                    LDQ     1,,PR1
        46 007127   400063 756100                    STQ     51,,PR4

     1704    23074    3            COMCOM.ESC -> ETT.STATE = %PR5;

  23074 46 007130   000031 220003                    LDX0    25,DU
        46 007131   100004 740100                    STX0    4,,PR1

     1705    23075    3            COMCOM.ESC -> ETT.COUNT = %DONT_MESS;

  23075 46 007132   777777 221003                    LDX1    -1,DU
        46 007133   000007 471400 xsym               LDP1    COMCOM+7
        46 007134   100000 441100                    SXL1    0,,PR1

     1706    23076    3            COMCOM.ESC -> ETT.B.ESC_LIST = %TRUE;

  23076 46 007135   000007 471400 xsym               LDP1    COMCOM+7
        46 007136   400000 236007                    LDQ     -131072,DL
        46 007137   100004 256100                    ORSQ    4,,PR1

     1707    23077
     1708    23078    4            DO CASE( PILL -> ENTRY_ILL.CODE );

  23078 46 007140   000000 471500                    LDP1    0,,PR0
        46 007141   100000 722100                    LXL2    0,,PR1
        46 007142   000003 102003                    CMPX2   3,DU
        46 007143   007145 602012 46                 TNC     s:23078+5,X2
        46 007144   007311 710000 46                 TRA     s:23153
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:365  
        46 007145   007150 710000 46                 TRA     s:23080
        46 007146   007152 710000 46                 TRA     s:23083
        46 007147   007152 710000 46                 TRA     s:23083

     1709    23079    4              CASE( %MAIN_PROGRAM );

     1710    23080    4                PCOM.EABS = %MAIN_ENTRY;

  23080 46 007150   400004 450100                    STZ     4,,PR4
        46 007151   021307 710000 46                 TRA     s:26924

     1711    23081
     1712    23082    4              CASE( %SUBROUTINE, %SUBROUTINE_ENTRY );

     1713    23083    4                DEF$ = PILL -> ENTRY_ILL.LOP;

  23083 46 007152   100001 236100                    LDQ     1,,PR1
        46 007153   200245 756100                    STQ     DEF$,,AUTO

     1714    23084
     1715    23085    4                IF PILL -> ILL.CODE = %SUBROUTINE_ENTRY THEN

  23085 46 007154   000002 102003                    CMPX2   2,DU
        46 007155   007165 601000 46                 TNZ     s:23091

     1716    23086    5                  DO;

     1717    23087    5                    DEF$ -> LABEL.DESC.SA = CURRENT_BLOCK$ -> BLOCK.SIZE;

  23087 46 007156   000000 475400 26                 LDP5    CURRENT_BLOCK$
        46 007157   500002 223100                    LDX3    2,,PR5
        46 007160   200245 476500                    LDP6    DEF$,,AUTO
        46 007161   600001 743100                    STX3    1,,PR6

     1718    23088    5                    AVOID_DEFLAB = 1;

  23088 46 007162   000001 235007                    LDA     1,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:366  
        46 007163   200246 755100                    STA     AVOID_DEFLAB,,AUTO

     1719    23089    5                  END;

  23089 46 007164   007166 710000 46                 TRA     s:23093

     1720    23090    4                ELSE
     1721    23091    4                  AVOID_DEFLAB = 0;

  23091 46 007165   200246 450100                    STZ     AVOID_DEFLAB,,AUTO

     1722    23092
     1723    23093    4                IF DEF$ -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.
             23093                         EXIT_PROG_IN_DECL THEN

  23093 46 007166   200245 471500                    LDP1    DEF$,,AUTO
        46 007167   100011 475500                    LDP5    9,,PR1
        46 007170   500001 476500                    LDP6    1,,PR5
        46 007171   600001 236100                    LDQ     1,,PR6
        46 007172   000200 316007                    CANQ    128,DL
        46 007173   007202 600000 46                 TZE     s:23099

     1724    23094    5                  DO;

     1725    23095    5                    PCOM.DABS = 1;

  23095 46 007174   000001 235007                    LDA     1,DL
        46 007175   400003 755100                    STA     3,,PR4

     1726    23096    5                    PCOM.POPND = PILL -> ENTRY_ILL.EXIT_PROG$;

  23096 46 007176   000000 475500                    LDP5    0,,PR0
        46 007177   500004 236100                    LDQ     4,,PR5
        46 007200   400051 756100                    STQ     41,,PR4

     1727    23097    5                  END;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:367  
  23097 46 007201   007203 710000 46                 TRA     s:23101

     1728    23098    4                ELSE
     1729    23099    4                  PCOM.DABS = 0;

  23099 46 007202   400003 450100                    STZ     3,,PR4

     1730    23100
     1731    23101    4                IF COMCOM.OB.COBOL_74    THEN

  23101 46 007203   000015 234000 xsym               SZN     COMCOM+13
        46 007204   007210 605000 46                 TPL     s:23104

     1732    23102    4                   PCOM.OABS = 1;

  23102 46 007205   000001 235007                    LDA     1,DL
        46 007206   400016 755100                    STA     14,,PR4
        46 007207   007211 710000 46                 TRA     s:23106

     1733    23103    4                ELSE
     1734    23104    4                   PCOM.OABS = 0;

  23104 46 007210   400016 450100                    STZ     14,,PR4

     1735    23105
     1736    23106    4                IF COMCOM.OB.PARAMETER_CHECK  THEN

  23106 46 007211   000115 234000 xsym               SZN     COMCOM+77
        46 007212   007216 605000 46                 TPL     s:23109

     1737    23107    4                  PCOM.CABS = 1;

  23107 46 007213   000001 235007                    LDA     1,DL
        46 007214   400002 755100                    STA     2,,PR4
        46 007215   007217 710000 46                 TRA     s:23111

     1738    23108    4                ELSE
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:368  
     1739    23109    4                  PCOM.CABS = 0;

  23109 46 007216   400002 450100                    STZ     2,,PR4

     1740    23110
     1741    23111    4                IF DEF$ -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.P2_SAVE$ =
             23111                         ADDR(NIL)   THEN

  23111 46 007217   100011 475500                    LDP5    9,,PR1
        46 007220   500001 476500                    LDP6    1,,PR5
        46 007221   600024 236100                    LDQ     20,,PR6
        46 007222   000005 116000 47                 CMPQ    5
        46 007223   007226 601000 46                 TNZ     s:23115

     1742    23112    4                  PCOM.SABS = 0;

  23112 46 007224   400022 450100                    STZ     18,,PR4
        46 007225   007234 710000 46                 TRA     s:23119

     1743    23113    4                ELSE
     1744    23114    5                  DO;

     1745    23115    5                    PCOM.SABS = 1;

  23115 46 007226   000001 235007                    LDA     1,DL
        46 007227   400022 755100                    STA     18,,PR4

     1746    23116    5                   PCOM.UOPND = DEF$ -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP
             23116                             .P2_SAVE$;

  23116 46 007230   100011 475500                    LDP5    9,,PR1
        46 007231   500001 476500                    LDP6    1,,PR5
        46 007232   600024 236100                    LDQ     20,,PR6
        46 007233   400056 756100                    STQ     46,,PR4

     1747    23117    5                  END;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:369  
     1748    23118
     1749    23119    4                IF DEF$ -> SYMDEF_.ARGLIST$ ~= ADDR(NIL) THEN

  23119 46 007234   100005 236100                    LDQ     5,,PR1
        46 007235   000005 116000 47                 CMPQ    5
        46 007236   007245 600000 46                 TZE     s:23122

     1750    23120    4                  PCOM.NABS = DEF$ -> SYMDEF_.ARGLIST$ -> ARGLIST.N - 1;

  23120 46 007237   100005 475500                    LDP5    5,,PR1
        46 007240   500000 236100                    LDQ     0,,PR5
        46 007241   777777 376007                    ANQ     -1,DL
        46 007242   000001 136007                    SBLQ    1,DL
        46 007243   400015 756100                    STQ     13,,PR4
        46 007244   007246 710000 46                 TRA     s:23124

     1751    23121    4                ELSE
     1752    23122    4                  PCOM.NABS = 0;

  23122 46 007245   400015 450100                    STZ     13,,PR4

     1753    23123
     1754    23124    4                PCOM.SOPND = DEF$ -> SYMDEF_.PROC$ -> PROC_.PSEUDO_STACK$;

  23124 46 007246   100011 475500                    LDP5    9,,PR1
        46 007247   500004 236100                    LDQ     4,,PR5
        46 007250   400054 756100                    STQ     44,,PR4

     1755    23125
     1756    23126    5                DO CASE(PCOM.NABS);

  23126 46 007251   400015 235100                    LDA     13,,PR4
        46 007252   000004 115007                    CMPA    4,DL
        46 007253   007255 602005 46                 TNC     s:23126+4,AL
        46 007254   007275 710000 46                 TRA     s:23136
        46 007255   007261 710000 46                 TRA     s:23128
        46 007256   007264 710000 46                 TRA     s:23130
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:370  
        46 007257   007267 710000 46                 TRA     s:23132
        46 007260   007272 710000 46                 TRA     s:23134

     1757    23127    5                  CASE(%ZERO_ARG);

     1758    23128    5                    PCOM.EOPND = COMCOM.X66_STATIC_0$;

  23128 46 007261   000464 236000 xsym               LDQ     COMCOM+308
        46 007262   400036 756100                    STQ     30,,PR4
        46 007263   007277 710000 46                 TRA     s:23147

     1759    23129    5                  CASE(%ONE_ARG);

     1760    23130    5                    PCOM.EOPND = COMCOM.X66_STATIC_1$;

  23130 46 007264   000465 236000 xsym               LDQ     COMCOM+309
        46 007265   400036 756100                    STQ     30,,PR4
        46 007266   007277 710000 46                 TRA     s:23147

     1761    23131    5                  CASE(%TWO_ARG);

     1762    23132    5                    PCOM.EOPND = COMCOM.X66_STATIC_2$;

  23132 46 007267   000466 236000 xsym               LDQ     COMCOM+310
        46 007270   400036 756100                    STQ     30,,PR4
        46 007271   007277 710000 46                 TRA     s:23147

     1763    23133    5                  CASE(%THREE_ARG);

     1764    23134    5                    PCOM.EOPND = COMCOM.X66_STATIC_3$;

  23134 46 007272   000467 236000 xsym               LDQ     COMCOM+311
        46 007273   400036 756100                    STQ     30,,PR4
        46 007274   007277 710000 46                 TRA     s:23147

     1765    23135    5                  CASE(ELSE);

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:371  
     1766    23136    5                    PCOM.EOPND = COMCOM.X66_STATIC_N$;

  23136 46 007275   000470 236000 xsym               LDQ     COMCOM+312
        46 007276   400036 756100                    STQ     30,,PR4

     1767    23137    5                END; /* CASE (NABS) */

     1768    23138
     1769    23139            /*       IF (DEF$ -> ST.ID = %INTDEF) AND
     1770    23140                        NOT COMCOM.CANCEL_ID                       AND
     1771    23141                        NOT DEF$ -> INTDEF.PROC$ -> PROC_.B.CANCELED AND
     1772    23142                        NOT DEF$ -> INTDEF.PROC$ -> PROC_.B.INITIAL AND
     1773    23143                        NOT COMCOM.COMMA_DECIMAL_PRESENT     THEN
     1774    23144                       PCOM.EABS = %SUBENT_UNMANAGED + AVOID_DEFLAB;
     1775    23145                     ELSE
     1776    23146                       DO;   */
     1777    23147    4                    PCOM.EABS = %SUBENT_MANAGED + AVOID_DEFLAB;

  23147 46 007277   200246 235100                    LDA     AVOID_DEFLAB,,AUTO
        46 007300   000003 035007                    ADLA    3,DL
        46 007301   400004 755100                    STA     4,,PR4

     1778    23148    4                    PCOM.KOPND = DEF$ -> SYMDEF_.PROC$ -> PROC_.CSIB$;

  23148 46 007302   100011 475500                    LDP5    9,,PR1
        46 007303   500005 236100                    LDQ     5,,PR5
        46 007304   400044 756100                    STQ     36,,PR4

     1779    23149    4                    DEF$ -> SYMDEF_.PROC$ -> PROC_.B.MANAGED = TRUE;

  23149 46 007305   100011 475500                    LDP5    9,,PR1
        46 007306   040000 236003                    LDQ     16384,DU
        46 007307   500003 256100                    ORSQ    3,,PR5
        46 007310   021307 710000 46                 TRA     s:26924

     1780    23150            /*         END;  */
     1781    23151
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:372  
     1782    23152    4              CASE(ELSE);

     1783    23153    4                CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);

  23153 46 007311   000061 630400 47                 EPPR0   49
        46 007312   000000 631400 47                 EPPR1   0
        46 007313   000000 701000 xent               TSX1    Z8AE$ERROR
        46 007314   000000 011000                    NOP     0

     1784    23154    4            END; /* CASE (CODE) */

  23154 46 007315   021307 710000 46                 TRA     s:26924

     1785    23155
     1786    23156
     1787    23157    3          CASE(%SECOND_PASS);

     1788    23158    3            IF PILL -> ENTRY_ILL.CODE = %MAIN_PROGRAM THEN

  23158 46 007316   100000 720100                    LXL0    0,,PR1
        46 007317   021307 601000 46                 TNZ     s:26924

     1789    23159    4              DO;

     1790    23160    4                OPTWRD = 0;

  23160 46 007320   200247 450100                    STZ     OPTWRD,,AUTO

     1791    23161    4                ADDR(OPTWRD) -> NOP.EXIT_PROG_IN_DECL = PILL -> ENTRY_ILL.LOP

  23161 46 007321   000000 471500                    LDP1    0,,PR0
        46 007322   100001 474500                    LDP4    1,,PR1
        46 007323   400011 475500                    LDP5    9,,PR4
        46 007324   500001 476500                    LDP6    1,,PR5
        46 007325   600001 236100                    LDQ     1,,PR6
        46 007326   000022 736000                    QLS     18
        46 007327   200247 676100                    ERQ     OPTWRD,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:373  
        46 007330   000200 376003                    ANQ     128,DU
        46 007331   200247 656100                    ERSQ    OPTWRD,,AUTO

     1792    23162    4                   -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.EXIT_PROG_IN_DECL
             23162                             ;
     1793    23163    4                ADDR(OPTWRD) -> NOP.COBOL_74 = COMCOM.OB.COBOL_74;

  23163 46 007332   000015 236000 xsym               LDQ     COMCOM+13
        46 007333   000021 772000                    QRL     17
        46 007334   200247 676100                    ERQ     OPTWRD,,AUTO
        46 007335   000001 376003                    ANQ     1,DU
        46 007336   200247 656100                    ERSQ    OPTWRD,,AUTO

     1794    23164    4                ADDR(OPTWRD) -> NOP.CONTINUE = COMCOM.OB.CONTINUE;

  23164 46 007337   000100 236000 xsym               LDQ     COMCOM+64
        46 007340   000020 772000                    QRL     16
        46 007341   200247 676100                    ERQ     OPTWRD,,AUTO
        46 007342   000002 376003                    ANQ     2,DU
        46 007343   200247 656100                    ERSQ    OPTWRD,,AUTO

     1795    23165    4                ADDR(OPTWRD) -> NOP.STATS   = COMCOM.OB.STATS;

  23165 46 007344   000052 236000 xsym               LDQ     COMCOM+42
        46 007345   000017 772000                    QRL     15
        46 007346   200247 676100                    ERQ     OPTWRD,,AUTO
        46 007347   000004 376003                    ANQ     4,DU
        46 007350   200247 656100                    ERSQ    OPTWRD,,AUTO

     1796    23166    4                ADDR(OPTWRD) -> NOP.COMMA_DECIMAL =

  23166 46 007351   000000 471400 3                  LDP1    ILL$
        46 007352   100001 474500                    LDP4    1,,PR1
        46 007353   400011 475500                    LDP5    9,,PR4
        46 007354   500003 236100                    LDQ     3,,PR5
        46 007355   000007 772000                    QRL     7
        46 007356   200247 676100                    ERQ     OPTWRD,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:374  
        46 007357   000010 376003                    ANQ     8,DU
        46 007360   200247 656100                    ERSQ    OPTWRD,,AUTO

     1797    23167    4                  ENTRY_ILL.LOP -> SYMDEF_.PROC$ -> PROC_.B.OBJECT_IS_COMMA;
     1798    23168
     1799    23169    4                PCOM.GABS = OPTWRD;

  23169 46 007361   200247 235100                    LDA     OPTWRD,,AUTO
        46 007362   200004 474500                    LDP4    @PCOM,,AUTO
        46 007363   400006 755100                    STA     6,,PR4

     1800    23170    4              END;

  23170 46 007364   021307 710000 46                 TRA     s:26924

     1801    23171
     1802    23172    3          CASE(%THIRD_PASS);

     1803    23173    4            DO CASE( PILL -> ENTRY_ILL.CODE );

  23173 46 007365   100000 720100                    LXL0    0,,PR1
        46 007366   000003 100003                    CMPX0   3,DU
        46 007367   007371 602010 46                 TNC     s:23173+4,X0
        46 007370   021307 710000 46                 TRA     s:26924
        46 007371   007374 710000 46                 TRA     s:23175
        46 007372   007374 710000 46                 TRA     s:23175
        46 007373   007377 710000 46                 TRA     s:23178

     1804    23174    4              CASE( %SUBROUTINE, %MAIN_PROGRAM );

     1805    23175    4                CALL LOAD_GLOBAL_REGISTERS;

  23175 46 007374   022040 701000 46                 TSX1    LOAD_GLOBAL_REGISTERS
        46 007375   000000 011000                    NOP     0
        46 007376   021307 710000 46                 TRA     s:26924

     1806    23176
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:375  
     1807    23177    4              CASE( %SUBROUTINE_ENTRY );

     1808    23178    4                CALL RESTORE_GLOBAL_REGISTERS;

  23178 46 007377   022115 701000 46                 TSX1    RESTORE_GLOBAL_REGISTERS
        46 007400   000000 011000                    NOP     0

     1809    23179    4            END; /* CASE (CODE) */

     1810    23180
     1811    23181    3        END /* Case */;

  23181 46 007401   021307 710000 46                 TRA     s:26924

     1812    23182        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:376  
     1813    23183    2   CASE(%ESC);

     1814    23184        /*V*
     1815    23185                ESC
     1816    23186
     1817    23187                   An escape triad normally just generates a pointer load.
     1818    23188                The loaded pointer will point to the beginning of a block.
     1819    23189                However, when the Lop of the escape points to .PROC.
     1820    23190                the ROP will point to a label item in .PROC.. The pointer
     1821    23191                register is set to point at this label in this special case.
     1822    23192                An example of when this is used is in the GO TO DEPENDING
     1823    23193                verb.
     1824    23194        */
     1825    23195
     1826    23196    3      DO CASE( CASE_PASS );

  23196 46 007402   200005 473500                    LDP3    @CASE_PASS,,AUTO
        46 007403   300000 235100                    LDA     0,,PR3
        46 007404   000002 115007                    CMPA    2,DL
        46 007405   007407 602005 46                 TNC     s:23196+5,AL
        46 007406   021307 710000 46                 TRA     s:26924
        46 007407   007411 710000 46                 TRA     s:23201
        46 007410   007414 710000 46                 TRA     s:23236

     1827    23197
     1828    23198    3        CASE( %FIRST_PASS );

     1829    23199
     1830    23200               %IF %USING_HALF_WORD_RELOCATION;
     1831    23201    3            PCOM.JABS = %HALF_WORD_REL;

  23201 46 007411   200004 474500                    LDP4    @PCOM,,AUTO
        46 007412   400011 450100                    STZ     9,,PR4
        46 007413   021307 710000 46                 TRA     s:26924

     1832    23202               %ELSEIF;
     1833    23203 C
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:377  
     1834    23204 C             IF PILL -> ETT.LOP -> ETT.ID = %BASE THEN
     1835    23205 C               DO;
     1836    23206 C                 CALL Z8HI$BURST(PILL -> ETT.LOP,
     1837    23207 C                                 PEPD(PILL -> ETT.LOP -> ETT.ID));
     1838    23208 C
     1839    23209 C                   /* This is an item based on the pointer */
     1840    23210 C
     1841    23211 C                 PCOM.JABS = %BASEP;
     1842    23212 C               END;
     1843    23213 C             ELSE
     1844    23214 C
     1845    23215 C               IF PILL -> ETT.B.ESC_LIST       THEN
     1846    23216 C                 DO;
     1847    23217 C                   PCOM.JABS = %ON_ESC_LIST;
     1848    23218 C                   PCOM.CABS = PILL -> ETT.B.PR#;
     1849    23219 C                   PCOM.BABS = PILL -> ETT.B.OPTION;
     1850    23220 C                 END;
     1851    23221 C               ELSE
     1852    23222 C
     1853    23223 C                 IF PILL -> ETT.LOP -> ST.ID = %SYMREF_   THEN
     1854    23224 C                   PCOM.JABS = %LIB_CALL;
     1855    23225 C                 ELSE
     1856    23226 C
     1857    23227 C                   IF PILL -> ETT.LOP -> ST.R = %PROGRAM     THEN
     1858    23228 C                     PCOM.JABS = %LDP;
     1859    23229 C                   ELSE
     1860    23230 C                     PCOM.JABS = %NOT_ON_ESC_LIST;
     1861    23231 C
     1862    23232               %ENDIF;
     1863    23233    3        CASE( %SECOND_PASS );

     1864    23234
     1865    23235                 /* Generate an EAX0 */
     1866    23236    3            CALL Z8HG$FREE_REGISTER(%XR0);

  23236 46 007414   000002 630400 47                 EPPR0   2
        46 007415   000000 631400 47                 EPPR1   0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:378  
        46 007416   000000 701000 xent               TSX1    Z8HG$FREE_REGISTER
        46 007417   000000 011000                    NOP     0

     1867    23237
     1868    23238    3            INST_WORD = '0'O;

  23238 46 007420   200012 450100                    STZ     INST_WORD,,AUTO

     1869    23239    3            INST_WORD.LOW.OP_CODE = %EAX0_OP + (%XR0 - 8);

  23239 46 007421   620000 236007                    LDQ     -57344,DL
        46 007422   200012 552110                    STBQ    INST_WORD,'10'O,AUTO

     1870    23240
     1871    23241    3            MOD_KEY.KEY = 0;

  23241 46 007423   000000 450000 25                 STZ     MOD_KEY

     1872    23242    3            MOD_KEY.B.RESOLVE_ADDRESS = TRUE;

  23242 46 007424   000020 236007                    LDQ     16,DL
        46 007425   000000 256000 25                 ORSQ    MOD_KEY

     1873    23243
     1874    23244                 %NEW_WORD(@OU_WORD = INST_WORD,
     1875    23245                           @ST$ = PILL -> ETT.ROP,
     1876    23246                           @KEY = MOD_KEY.KEY);

  23265 46 007426   000002 236000 36                 LDQ     OBJ_+2
        46 007427   000004 036007                    ADLQ    4,DL
        46 007430   000003 116000 36                 CMPQ    OBJ_+3
        46 007431   007443 604000 46                 TMI     s:23271

  23267 46 007432   000000 234000 30                 SZN     PAGING_OBJ
        46 007433   007440 605000 46                 TPL     s:23269

  23268 46 007434   000006 630400 47                 EPPR0   6
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:379  
        46 007435   000000 631400 47                 EPPR1   0
        46 007436   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 007437   000000 011000                    NOP     0

  23269 46 007440   000007 631400 47                 EPPR1   7
        46 007441   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 007442   000000 011000                    NOP     0

  23271 46 007443   000002 236000 36                 LDQ     OBJ_+2
        46 007444   000022 736000                    QLS     18
        46 007445   000001 036000 36                 ADLQ    OBJ_+1
        46 007446   000000 756000 29                 STQ     OBJ$

  23272 46 007447   000004 236007                    LDQ     4,DL
        46 007450   000002 056000 36                 ASQ     OBJ_+2

  23273 46 007451   001012 220003                    LDX0    522,DU
        46 007452   000000 470400 29                 LDP0    OBJ$
        46 007453   000000 740100                    STX0    0,,PR0

  23276 46 007454   200003 470500                    LDP0    @PILL,,AUTO
        46 007455   000000 471500                    LDP1    0,,PR0
        46 007456   100002 236100                    LDQ     2,,PR1
        46 007457   000000 473400 29                 LDP3    OBJ$
        46 007460   300002 756100                    STQ     2,,PR3

  23277 46 007461   000000 471400 26                 LDP1    CURRENT_BLOCK$
        46 007462   100002 236100                    LDQ     2,,PR1
        46 007463   000022 772000                    QRL     18
        46 007464   300001 756100                    STQ     1,,PR3

  23278 46 007465   000000 236000 25                 LDQ     MOD_KEY
        46 007466   000011 736000                    QLS     9
        46 007467   300000 552110                    STBQ    0,'10'O,PR3

  23280 46 007470   200012 236100                    LDQ     INST_WORD,,AUTO
        46 007471   000000 471400 29                 LDP1    OBJ$
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:380  
        46 007472   100003 756100                    STQ     3,,PR1

  23287 46 007473   000000 473400 26                 LDP3    CURRENT_BLOCK$
        46 007474   300002 221100                    LDX1    2,,PR3
        46 007475   000001 622011                    EAX2    1,X1
        46 007476   300002 742100                    STX2    2,,PR3

  23288 46 007477   007504 601000 46                 TNZ     s:23296

  23289 46 007500   000011 630400 47                 EPPR0   9
        46 007501   000000 631400 47                 EPPR1   0
        46 007502   000000 701000 xent               TSX1    Z8AE$ERROR
        46 007503   000000 011000                    NOP     0

     1877    23293
     1878    23294
     1879    23295                 /* Generate AWDX using X0 */
     1880    23296    3            INST_WORD = '0'O;

  23296 46 007504   200012 450100                    STZ     INST_WORD,,AUTO

     1881    23297    3            INST_WORD.LOW.OP_CODE = %AWD_OP;

  23297 46 007505   507000 236007                    LDQ     -94720,DL
        46 007506   200012 552110                    STBQ    INST_WORD,'10'O,AUTO

     1882    23298    3            INST_WORD.LOW.MF.TAG = %XR0;

  23298 46 007507   200012 236100                    LDQ     INST_WORD,,AUTO
        46 007510   000012 376000 47                 ANQ     10
        46 007511   000010 276007                    ORQ     8,DL
        46 007512   200012 756100                    STQ     INST_WORD,,AUTO

     1883    23299    3            INST_WORD.Y.AR# = PILL -> ETT.STATE - 20;

  23299 46 007513   200003 470500                    LDP0    @PILL,,AUTO
        46 007514   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:381  
        46 007515   100004 236100                    LDQ     4,,PR1
        46 007516   000022 772000                    QRL     18
        46 007517   000024 136007                    SBLQ    20,DL
        46 007520   000041 736000                    QLS     33
        46 007521   200012 676100                    ERQ     INST_WORD,,AUTO
        46 007522   700000 376003                    ANQ     -32768,DU
        46 007523   200012 656100                    ERSQ    INST_WORD,,AUTO

     1884    23300    3            INST_WORD.LOW.MF.AR = TRUE;

  23300 46 007524   000100 236007                    LDQ     64,DL
        46 007525   200012 256100                    ORSQ    INST_WORD,,AUTO

     1885    23301    3            INST_WORD.LOW.EIS = TRUE;

  23301 46 007526   000400 236007                    LDQ     256,DL
        46 007527   200012 256100                    ORSQ    INST_WORD,,AUTO

     1886    23302
     1887    23303                 %NEW_WORD(@OU_WORD = INST_WORD);

  23322 46 007530   000002 236000 36                 LDQ     OBJ_+2
        46 007531   000004 036007                    ADLQ    4,DL
        46 007532   000003 116000 36                 CMPQ    OBJ_+3
        46 007533   007545 604000 46                 TMI     s:23328

  23324 46 007534   000000 234000 30                 SZN     PAGING_OBJ
        46 007535   007542 605000 46                 TPL     s:23326

  23325 46 007536   000006 630400 47                 EPPR0   6
        46 007537   000000 631400 47                 EPPR1   0
        46 007540   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 007541   000000 011000                    NOP     0

  23326 46 007542   000007 631400 47                 EPPR1   7
        46 007543   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 007544   000000 011000                    NOP     0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:382  

  23328 46 007545   000002 236000 36                 LDQ     OBJ_+2
        46 007546   000022 736000                    QLS     18
        46 007547   000001 036000 36                 ADLQ    OBJ_+1
        46 007550   000000 756000 29                 STQ     OBJ$

  23329 46 007551   000004 236007                    LDQ     4,DL
        46 007552   000002 056000 36                 ASQ     OBJ_+2

  23330 46 007553   001012 220003                    LDX0    522,DU
        46 007554   000000 470400 29                 LDP0    OBJ$
        46 007555   000000 740100                    STX0    0,,PR0

  23333 46 007556   000005 236000 47                 LDQ     5
        46 007557   000000 470400 29                 LDP0    OBJ$
        46 007560   000002 756100                    STQ     2,,PR0

  23334 46 007561   000000 471400 26                 LDP1    CURRENT_BLOCK$
        46 007562   100002 236100                    LDQ     2,,PR1
        46 007563   000022 772000                    QRL     18
        46 007564   000001 756100                    STQ     1,,PR0

  23335 46 007565   000000 236003                    LDQ     0,DU
        46 007566   000000 552110                    STBQ    0,'10'O,PR0

  23337 46 007567   200012 236100                    LDQ     INST_WORD,,AUTO
        46 007570   000000 470400 29                 LDP0    OBJ$
        46 007571   000003 756100                    STQ     3,,PR0

  23344 46 007572   000000 471400 26                 LDP1    CURRENT_BLOCK$
        46 007573   100002 221100                    LDX1    2,,PR1
        46 007574   000001 622011                    EAX2    1,X1
        46 007575   100002 742100                    STX2    2,,PR1

  23345 46 007576   021307 601000 46                 TNZ     s:26924

  23346 46 007577   000011 630400 47                 EPPR0   9
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:383  
        46 007600   000000 631400 47                 EPPR1   0
        46 007601   000000 701000 xent               TSX1    Z8AE$ERROR
        46 007602   000000 011000                    NOP     0

     1888    23350
     1889    23351    3      END;  /*  CASE PASS */

  23351 46 007603   021307 710000 46                 TRA     s:26924

     1890    23352        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:384  
     1891    23353    2   CASE(%EVAL);

     1892    23354
     1893    23355        /*V*
     1894    23356                           EVAL
     1895    23357
     1896    23358             EVAL is used to make a value constant over a range.  See
     1897    23359             phase one and three documentation for details.  In phase
     1898    23360             four the triad under the eval will be walked and its state will
     1899    23361             tranferred to the EVAL.  This will ensure its uniqueness
     1900    23362             over the range,  and hopefully won't cause problems in
     1901    23363             other circumstances.
     1902    23364        */
     1903    23365    2        EVAL$ = PILL -> ETT.LOP;

  23365 46 007604   100001 236100                    LDQ     1,,PR1
        46 007605   200251 756100                    STQ     EVAL$,,AUTO

     1904    23366
     1905    23367    2        PILL -> ETT.STATE = EVAL$ -> ETT.STATE;

  23367 46 007606   000000 471500                    LDP1    0,,PR0
        46 007607   200251 473500                    LDP3    EVAL$,,AUTO
        46 007610   300004 220100                    LDX0    4,,PR3
        46 007611   100004 740100                    STX0    4,,PR1

     1906    23368
     1907    23369    2        REGISTER = EVAL$ -> ETT.STATE;

  23369 46 007612   200251 471500                    LDP1    EVAL$,,AUTO
        46 007613   100004 236100                    LDQ     4,,PR1
        46 007614   000022 772000                    QRL     18
        46 007615   200074 756100                    STQ     REGISTER,,AUTO

     1908    23370    2        IF REGISTER > %REF_T THEN

  23370 46 007616   000005 116007                    CMPQ    5,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:385  
        46 007617   007630 602000 46                 TNC     s:23373

     1909    23371    2          CALL Z8HG$USE_REGISTER(PILL, REGISTER);

  23371 46 007620   200074 633500                    EPPR3   REGISTER,,AUTO
        46 007621   200303 453500                    STP3    ORG1+2,,AUTO
        46 007622   200003 236100                    LDQ     @PILL,,AUTO
        46 007623   200302 756100                    STQ     ORG1+1,,AUTO
        46 007624   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 007625   000013 631400 47                 EPPR1   11
        46 007626   000000 701000 xent               TSX1    Z8HG$USE_REGISTER
        46 007627   000000 011000                    NOP     0

     1910    23372
     1911    23373    2        IF EVAL$ -> ETT.REF$ ~= ADDR(NIL) THEN

  23373 46 007630   200251 470500                    LDP0    EVAL$,,AUTO
        46 007631   000003 236100                    LDQ     3,,PR0
        46 007632   000005 116000 47                 CMPQ    5
        46 007633   007723 600000 46                 TZE     s:23497

     1912    23374    3          DO;

     1913    23375
     1914    23376                 %EQU ONE_FOR_REFERENCE_TO_LOP = 1;
     1915    23377
     1916    23378    3            IF EVAL$ -> ETT.REF$ -> REF.ST$ -> ST.ID = %TEMP THEN

  23378 46 007634   000003 471500                    LDP1    3,,PR0
        46 007635   100005 473500                    LDP3    5,,PR1
        46 007636   300000 220100                    LDX0    0,,PR3
        46 007637   000760 100003                    CMPX0   496,DU
        46 007640   007653 601000 46                 TNZ     s:23385

     1917    23379    3              EVAL$ -> ETT.REF$ -> REF.ST$ -> TEMP.REFERENCES =

  23379 46 007641   200003 474500                    LDP4    @PILL,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:386  
        46 007642   400000 475500                    LDP5    0,,PR4
        46 007643   500000 236100                    LDQ     0,,PR5
        46 007644   777777 376007                    ANQ     -1,DL
        46 007645   200302 756100                    STQ     ORG1+1,,AUTO
        46 007646   300004 236100                    LDQ     4,,PR3
        46 007647   000022 732000                    QRS     18
        46 007650   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 007651   777777 620006                    EAX0    -1,QL
        46 007652   300004 740100                    STX0    4,,PR3

     1918    23380    3                EVAL$ -> ETT.REF$ -> REF.ST$ -> TEMP.REFERENCES +
     1919    23381    3                PILL -> ETT.COUNT - %ONE_FOR_REFERENCE_TO_LOP;
     1920    23382
     1921    23383                 %NEW_REF(@POINTER=P$);

  23385 46 007653   000000 236000 19                 LDQ     HEAD_REF$
        46 007654   000005 116000 47                 CMPQ    5
        46 007655   007704 601000 46                 TNZ     s:23479

  23463 46 007656   000002 236000 41                 LDQ     LTS_+2
        46 007657   000006 036007                    ADLQ    6,DL
        46 007660   000003 116000 41                 CMPQ    LTS_+3
        46 007661   007672 604000 46                 TMI     s:23465

  23464 46 007662   000035 236000 47                 LDQ     29
        46 007663   200302 756100                    STQ     ORG1+1,,AUTO
        46 007664   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 007665   200303 450500                    STP0    ORG1+2,,AUTO
        46 007666   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 007667   000000 631400 47                 EPPR1   0
        46 007670   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 007671   000000 011000                    NOP     0

  23465 46 007672   000002 236000 41                 LDQ     LTS_+2
        46 007673   000022 736000                    QLS     18
        46 007674   000001 036000 41                 ADLQ    LTS_+1
        46 007675   200064 756100                    STQ     P$,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:387  

  23466 46 007676   000006 236007                    LDQ     6,DL
        46 007677   000002 056000 41                 ASQ     LTS_+2

  23467 46 007700   001111 220003                    LDX0    585,DU
        46 007701   200064 470500                    LDP0    P$,,AUTO
        46 007702   000000 740100                    STX0    0,,PR0

  23471 46 007703   007710 710000 46                 TRA     s:23489

  23479 46 007704   200064 756100                    STQ     P$,,AUTO

  23480 46 007705   000000 470400 19                 LDP0    HEAD_REF$
        46 007706   000002 236100                    LDQ     2,,PR0
        46 007707   000000 756000 19                 STQ     HEAD_REF$

  23489 46 007710   000000 054000 15                 AOS     NUMBER_OF_REFS

     1922    23492
     1923    23493    3            P$ -> REF = EVAL$ -> ETT.REF$ -> REF;

  23493 46 007711   200251 470500                    LDP0    EVAL$,,AUTO
        46 007712   000003 471500                    LDP1    3,,PR0
        46 007713   200064 473500                    LDP3    P$,,AUTO
        46 007714   000100 100500                    MLR     fill='000'O
        46 007715   100000 000030                    ADSC9   0,,PR1                   cn=0,n=24
        46 007716   300000 000030                    ADSC9   0,,PR3                   cn=0,n=24

     1924    23494    3            PILL -> ETT.REF$ = P$;

  23494 46 007717   200003 470500                    LDP0    @PILL,,AUTO
        46 007720   000000 471500                    LDP1    0,,PR0
        46 007721   200064 236100                    LDQ     P$,,AUTO
        46 007722   100003 756100                    STQ     3,,PR1

     1925    23495    3          END;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:388  
     1926    23496
     1927    23497    2        CALL Z8HU$DECCNT_WITHOUT_IMPL_REF(EVAL$, 1);

  23497 46 007723   000016 236000 47                 LDQ     14
        46 007724   200303 756100                    STQ     ORG1+2,,AUTO
        46 007725   200251 630500                    EPPR0   EVAL$,,AUTO
        46 007726   200302 450500                    STP0    ORG1+1,,AUTO
        46 007727   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 007730   000013 631400 47                 EPPR1   11
        46 007731   000000 701000 xent               TSX1    Z8HU$DECCNT_WITHOUT_IMPL_REF
        46 007732   000000 011000                    NOP     0
        46 007733   021307 710000 46                 TRA     s:26924

     1928    23498        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:389  
     1929    23499    2   CASE(%EVALP);

     1930    23500    2        CALL BINCHAR (TEMP_CHAR, COMCOM.CURRENT.LINE);

  23500 46 007734   000100 301400                    BTD
        46 007735   000133 000004 xsym               NDSC9   COMCOM+91                cn=0,s=lsgnf,sf=0,n=4
        46 007736   200070 030014                    NDSC9   TEMP_CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=12

     1931    23501    2        I = 0;

  23501 46 007737   200065 450100                    STZ     I,,AUTO

     1932    23502    3        DO WHILE SUBSTR (TEMP_CHAR, I, 1) = '0';

  23502 46 007740   007742 710000 46                 TRA     s:23504

     1933    23503    3          I = I + 1;

  23503 46 007741   200065 054100                    AOS     I,,AUTO

     1934    23504    3        END;

  23504 46 007742   200065 235100                    LDA     I,,AUTO
        46 007743   040000 106505                    CMPC    fill='040'O
        46 007744   200070 000001                    ADSC9   TEMP_CHAR,A,AUTO         cn=0,n=1
        46 007745   000062 000001 47                 ADSC9   50                       cn=0,n=1
        46 007746   007741 600000 46                 TZE     s:23503

     1935    23505    2        CALL Z8AH$NEW_DNT (SUBSTR (TEMP_CHAR, I), 12 - I, P$);

  23505 46 007747   000030 675000 47                 ERA     24
        46 007750   000015 035007                    ADLA    13,DL
        46 007751   200302 755100                    STA     ORG1+1,,AUTO
        46 007752   200064 630500                    EPPR0   P$,,AUTO
        46 007753   200305 450500                    STP0    ORG1+4,,AUTO
        46 007754   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 007755   200304 451500                    STP1    ORG1+3,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:390  
        46 007756   200306 452500                    STP2    ORG1+5,,AUTO
        46 007757   200065 236100                    LDQ     I,,AUTO
        46 007760   000020 736000                    QLS     16
        46 007761   000070 036003                    ADLQ    56,DU
        46 007762   200306 036100                    ADLQ    ORG1+5,,AUTO
        46 007763   200303 756100                    STQ     ORG1+2,,AUTO
        46 007764   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 007765   000043 631400 47                 EPPR1   35
        46 007766   000000 701000 xent               TSX1    Z8AH$NEW_DNT
        46 007767   000000 011000                    NOP     0

     1936    23506    2        CALL Z8AE$ERROR (%E$EVALP_NOT_DELETED,,, P$);

  23506 46 007770   200064 630500                    EPPR0   P$,,AUTO
        46 007771   200305 450500                    STP0    ORG1+4,,AUTO
        46 007772   000005 236000 47                 LDQ     5
        46 007773   200304 756100                    STQ     ORG1+3,,AUTO
        46 007774   000064 235000 47                 LDA     52
        46 007775   200302 757100                    STAQ    ORG1+1,,AUTO
        46 007776   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 007777   000025 631400 47                 EPPR1   21
        46 010000   000000 701000 xent               TSX1    Z8AE$ERROR
        46 010001   000000 011000                    NOP     0
        46 010002   021307 710000 46                 TRA     s:26924

     1937    23507
     1938    23508        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:391  
     1939    23509    2   CASE(%EXDD);

     1940    23510    2        PCOM.IABS = 0;

  23510 46 010003   200004 473500                    LDP3    @PCOM,,AUTO
        46 010004   300010 450100                    STZ     8,,PR3
        46 010005   021307 710000 46                 TRA     s:26924

     1941    23511
     1942    23512    2   CASE(%EXDI);

     1943    23513    2        PCOM.IABS = 1;

  23513 46 010006   000001 235007                    LDA     1,DL
        46 010007   200004 473500                    LDP3    @PCOM,,AUTO
        46 010010   300010 755100                    STA     8,,PR3
        46 010011   021307 710000 46                 TRA     s:26924

     1944    23514
     1945    23515        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:392  
     1946    23516    2   CASE(%EXIT_PROG);

     1947    23517
     1948    23518             %IF CP6;
     1949    23519    2        PCOM.EABS = 1;

  23519 46 010012   000001 235007                    LDA     1,DL
        46 010013   200004 473500                    LDP3    @PCOM,,AUTO
        46 010014   300004 755100                    STA     4,,PR3

     1950    23520    2        PCOM.SOPND = PILL -> ILL.LOP -> PROC_.PSEUDO_STACK$;

  23520 46 010015   000000 471500                    LDP1    0,,PR0
        46 010016   100001 474500                    LDP4    1,,PR1
        46 010017   400004 236100                    LDQ     4,,PR4
        46 010020   300054 756100                    STQ     44,,PR3

     1951    23521             %ENDIF;
     1952    23522             %IF GCOS;
     1953    23523 C           IF COMCOM.OB.FAST_ENT THEN
     1954    23524 C             PCOM.AABS = 0;
     1955    23525 C           ELSE
     1956    23526 C             PCOM.AABS = 1;
     1957    23527 C           PCOM.AABS = 1;
     1958    23528 C           IF COMCOM.OB.TP8 THEN
     1959    23529 C             IF PILL -> ILL.CODE = %EXIT_PROG_TP8 THEN
     1960    23530 C               PCOM.EABS = 1;
     1961    23531 C             ELSE
     1962    23532 C               PCOM.EABS = 0;
     1963    23533 C           ELSE
     1964    23534 C             PCOM.EABS = 2;
     1965    23535             %ENDIF;
     1966    23536    2        PCOM.KOPND = PILL -> ILL.LOP -> PROC_.CSIB$;

  23536 46 010021   000000 471500                    LDP1    0,,PR0
        46 010022   100001 474500                    LDP4    1,,PR1
        46 010023   400005 236100                    LDQ     5,,PR4
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:393  
        46 010024   300044 756100                    STQ     36,,PR3
        46 010025   021307 710000 46                 TRA     s:26924

     1967    23537
     1968    23538        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:394  
     1969    23539    2   CASE(%GO, %MULTI_GO);

     1970    23540
     1971    23541    3        DO CASE(CASE_PASS);

  23541 46 010026   200005 473500                    LDP3    @CASE_PASS,,AUTO
        46 010027   300000 235100                    LDA     0,,PR3
        46 010030   000002 115007                    CMPA    2,DL
        46 010031   010033 602005 46                 TNC     s:23541+5,AL
        46 010032   021307 710000 46                 TRA     s:26924
        46 010033   010035 710000 46                 TRA     s:23543
        46 010034   011111 710000 46                 TRA     s:23633

     1972    23542    3           CASE(%FIRST_PASS);

     1973    23543    3               PCOM.XABS = PILL -> ILL.CODE;

  23543 46 010035   100000 236100                    LDQ     0,,PR1
        46 010036   777777 376007                    ANQ     -1,DL
        46 010037   200004 474500                    LDP4    @PCOM,,AUTO
        46 010040   400027 756100                    STQ     23,,PR4

     1974    23544
     1975    23545    3               IF PILL -> ILL.ID = %GO THEN

  23545 46 010041   000000 471500                    LDP1    0,,PR0
        46 010042   100000 220100                    LDX0    0,,PR1
        46 010043   000344 100003                    CMPX0   228,DU
        46 010044   010050 601000 46                 TNZ     s:23548

     1976    23546    3                 GO_EXPR$ = PILL  -> GO.EXPR$;

  23546 46 010045   100002 236100                    LDQ     2,,PR1
        46 010046   200243 756100                    STQ     GO_EXPR$,,AUTO
        46 010047   010052 710000 46                 TRA     s:23549

     1977    23547    3               ELSE
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:395  
     1978    23548    3                 GO_EXPR$ = PILL -> MULTI_GO.EXPR$;

  23548 46 010050   100004 236100                    LDQ     4,,PR1
        46 010051   200243 756100                    STQ     GO_EXPR$,,AUTO

     1979    23549    3               IF GO_EXPR$ ~= ADDR(NIL) THEN

  23549 46 010052   000005 116000 47                 CMPQ    5
        46 010053   010125 600000 46                 TZE     s:23578

     1980    23550    3                 IF GO_EXPR$ -> ETT.B.REVERSED_RELATE THEN

  23550 46 010054   200243 475500                    LDP5    GO_EXPR$,,AUTO
        46 010055   500004 236100                    LDQ     4,,PR5
        46 010056   000004 316007                    CANQ    4,DL
        46 010057   010125 600000 46                 TZE     s:23578

     1981    23551                        %SWAP_RELATIONAL(OP_CODE=PCOM.XABS);

  23553 46 010060   400027 235100                    LDA     23,,PR4
        46 010061   000011 115007                    CMPA    9,DL
        46 010062   010064 602005 46                 TNC     s:23553+4,AL
        46 010063   010125 710000 46                 TRA     s:23578
        46 010064   010125 710000 46                 TRA     s:23578
        46 010065   010075 710000 46                 TRA     s:23555
        46 010066   010100 710000 46                 TRA     s:23557
        46 010067   010103 710000 46                 TRA     s:23559
        46 010070   010106 710000 46                 TRA     s:23561
        46 010071   010111 710000 46                 TRA     s:23563
        46 010072   010114 710000 46                 TRA     s:23565
        46 010073   010117 710000 46                 TRA     s:23567
        46 010074   010122 710000 46                 TRA     s:23569

  23555 46 010075   000003 235007                    LDA     3,DL
        46 010076   400027 755100                    STA     23,,PR4
        46 010077   010125 710000 46                 TRA     s:23578

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:396  
  23557 46 010100   000004 235007                    LDA     4,DL
        46 010101   400027 755100                    STA     23,,PR4
        46 010102   010125 710000 46                 TRA     s:23578

  23559 46 010103   000001 235007                    LDA     1,DL
        46 010104   400027 755100                    STA     23,,PR4
        46 010105   010125 710000 46                 TRA     s:23578

  23561 46 010106   000002 235007                    LDA     2,DL
        46 010107   400027 755100                    STA     23,,PR4
        46 010110   010125 710000 46                 TRA     s:23578

  23563 46 010111   000007 235007                    LDA     7,DL
        46 010112   400027 755100                    STA     23,,PR4
        46 010113   010125 710000 46                 TRA     s:23578

  23565 46 010114   000010 235007                    LDA     8,DL
        46 010115   400027 755100                    STA     23,,PR4
        46 010116   010125 710000 46                 TRA     s:23578

  23567 46 010117   000005 235007                    LDA     5,DL
        46 010120   400027 755100                    STA     23,,PR4
        46 010121   010125 710000 46                 TRA     s:23578

  23569 46 010122   000006 235007                    LDA     6,DL
        46 010123   400027 755100                    STA     23,,PR4
        46 010124   010125 710000 46                 TRA     s:23578

     1982    23577
     1983    23578    4               DO CASE(PCOM.XABS);

  23578 46 010125   400027 235100                    LDA     23,,PR4
        46 010126   000010 115007                    CMPA    8,DL
        46 010127   010131 602005 46                 TNC     s:23578+4,AL
        46 010130   021307 710000 46                 TRA     s:26924
        46 010131   011110 710000 46                 TRA     s:23630
        46 010132   010141 710000 46                 TRA     s:23580
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:397  
        46 010133   011110 710000 46                 TRA     s:23630
        46 010134   010333 710000 46                 TRA     s:23593
        46 010135   011110 710000 46                 TRA     s:23630
        46 010136   010525 710000 46                 TRA     s:23606
        46 010137   011110 710000 46                 TRA     s:23630
        46 010140   010717 710000 46                 TRA     s:23619

     1984    23579    4                 CASE(%GO_LESS_THAN);

     1985    23580    5                   DO CASE(GO_EXPR$ -> ETT.ID);

  23580 46 010141   200243 471500                    LDP1    GO_EXPR$,,AUTO
        46 010142   100000 236100                    LDQ     0,,PR1
        46 010143   000022 772000                    QRL     18
        46 010144   000025 136007                    SBLQ    21,DL
        46 010145   000155 116007                    CMPQ    109,DL
        46 010146   010150 602006 46                 TNC     s:23580+7,QL
        46 010147   010330 710000 46                 TRA     s:23589
        46 010150   010325 710000 46                 TRA     s:23586
        46 010151   010330 710000 46                 TRA     s:23589
        46 010152   010330 710000 46                 TRA     s:23589
        46 010153   010330 710000 46                 TRA     s:23589
        46 010154   010330 710000 46                 TRA     s:23589
        46 010155   010330 710000 46                 TRA     s:23589
        46 010156   010330 710000 46                 TRA     s:23589
        46 010157   010330 710000 46                 TRA     s:23589
        46 010160   010330 710000 46                 TRA     s:23589
        46 010161   010330 710000 46                 TRA     s:23589
        46 010162   010330 710000 46                 TRA     s:23589
        46 010163   010330 710000 46                 TRA     s:23589
        46 010164   010330 710000 46                 TRA     s:23589
        46 010165   010330 710000 46                 TRA     s:23589
        46 010166   010330 710000 46                 TRA     s:23589
        46 010167   010330 710000 46                 TRA     s:23589
        46 010170   010330 710000 46                 TRA     s:23589
        46 010171   010330 710000 46                 TRA     s:23589
        46 010172   010330 710000 46                 TRA     s:23589
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:398  
        46 010173   010330 710000 46                 TRA     s:23589
        46 010174   010330 710000 46                 TRA     s:23589
        46 010175   010330 710000 46                 TRA     s:23589
        46 010176   010330 710000 46                 TRA     s:23589
        46 010177   010330 710000 46                 TRA     s:23589
        46 010200   010330 710000 46                 TRA     s:23589
        46 010201   010330 710000 46                 TRA     s:23589
        46 010202   010330 710000 46                 TRA     s:23589
        46 010203   010330 710000 46                 TRA     s:23589
        46 010204   010330 710000 46                 TRA     s:23589
        46 010205   010330 710000 46                 TRA     s:23589
        46 010206   010330 710000 46                 TRA     s:23589
        46 010207   010330 710000 46                 TRA     s:23589
        46 010210   010330 710000 46                 TRA     s:23589
        46 010211   010330 710000 46                 TRA     s:23589
        46 010212   010330 710000 46                 TRA     s:23589
        46 010213   010330 710000 46                 TRA     s:23589
        46 010214   010330 710000 46                 TRA     s:23589
        46 010215   010330 710000 46                 TRA     s:23589
        46 010216   010330 710000 46                 TRA     s:23589
        46 010217   010330 710000 46                 TRA     s:23589
        46 010220   010330 710000 46                 TRA     s:23589
        46 010221   010330 710000 46                 TRA     s:23589
        46 010222   010330 710000 46                 TRA     s:23589
        46 010223   010330 710000 46                 TRA     s:23589
        46 010224   010330 710000 46                 TRA     s:23589
        46 010225   010330 710000 46                 TRA     s:23589
        46 010226   010330 710000 46                 TRA     s:23589
        46 010227   010330 710000 46                 TRA     s:23589
        46 010230   010330 710000 46                 TRA     s:23589
        46 010231   010330 710000 46                 TRA     s:23589
        46 010232   010330 710000 46                 TRA     s:23589
        46 010233   010330 710000 46                 TRA     s:23589
        46 010234   010325 710000 46                 TRA     s:23586
        46 010235   010330 710000 46                 TRA     s:23589
        46 010236   010330 710000 46                 TRA     s:23589
        46 010237   010330 710000 46                 TRA     s:23589
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:399  
        46 010240   010330 710000 46                 TRA     s:23589
        46 010241   010325 710000 46                 TRA     s:23586
        46 010242   010330 710000 46                 TRA     s:23589
        46 010243   010330 710000 46                 TRA     s:23589
        46 010244   010325 710000 46                 TRA     s:23586
        46 010245   010330 710000 46                 TRA     s:23589
        46 010246   010330 710000 46                 TRA     s:23589
        46 010247   010330 710000 46                 TRA     s:23589
        46 010250   010330 710000 46                 TRA     s:23589
        46 010251   010330 710000 46                 TRA     s:23589
        46 010252   010330 710000 46                 TRA     s:23589
        46 010253   010330 710000 46                 TRA     s:23589
        46 010254   010330 710000 46                 TRA     s:23589
        46 010255   010330 710000 46                 TRA     s:23589
        46 010256   010330 710000 46                 TRA     s:23589
        46 010257   010330 710000 46                 TRA     s:23589
        46 010260   010330 710000 46                 TRA     s:23589
        46 010261   010330 710000 46                 TRA     s:23589
        46 010262   010330 710000 46                 TRA     s:23589
        46 010263   010330 710000 46                 TRA     s:23589
        46 010264   010330 710000 46                 TRA     s:23589
        46 010265   010330 710000 46                 TRA     s:23589
        46 010266   010330 710000 46                 TRA     s:23589
        46 010267   010330 710000 46                 TRA     s:23589
        46 010270   010330 710000 46                 TRA     s:23589
        46 010271   010330 710000 46                 TRA     s:23589
        46 010272   010330 710000 46                 TRA     s:23589
        46 010273   010330 710000 46                 TRA     s:23589
        46 010274   010330 710000 46                 TRA     s:23589
        46 010275   010330 710000 46                 TRA     s:23589
        46 010276   010330 710000 46                 TRA     s:23589
        46 010277   010330 710000 46                 TRA     s:23589
        46 010300   010330 710000 46                 TRA     s:23589
        46 010301   010330 710000 46                 TRA     s:23589
        46 010302   010330 710000 46                 TRA     s:23589
        46 010303   010325 710000 46                 TRA     s:23586
        46 010304   010330 710000 46                 TRA     s:23589
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:400  
        46 010305   010330 710000 46                 TRA     s:23589
        46 010306   010330 710000 46                 TRA     s:23589
        46 010307   010330 710000 46                 TRA     s:23589
        46 010310   010330 710000 46                 TRA     s:23589
        46 010311   010330 710000 46                 TRA     s:23589
        46 010312   010330 710000 46                 TRA     s:23589
        46 010313   010330 710000 46                 TRA     s:23589
        46 010314   010330 710000 46                 TRA     s:23589
        46 010315   010330 710000 46                 TRA     s:23589
        46 010316   010330 710000 46                 TRA     s:23589
        46 010317   010330 710000 46                 TRA     s:23589
        46 010320   010330 710000 46                 TRA     s:23589
        46 010321   010330 710000 46                 TRA     s:23589
        46 010322   010330 710000 46                 TRA     s:23589
        46 010323   010330 710000 46                 TRA     s:23589
        46 010324   010325 710000 46                 TRA     s:23586

     1986    23581    5                     CASE(

     1987    23582                               %SET_OF_ALPHANUM_COMPARISONS;
     1988    23585    5                                                       );
     1989    23586    5                       PCOM.XABS = %GO_LESS_THAN_ALPHA;

  23586 46 010325   000002 235007                    LDA     2,DL
        46 010326   400027 755100                    STA     23,,PR4
        46 010327   021307 710000 46                 TRA     s:26924

     1990    23587
     1991    23588    5                     CASE(ELSE);

     1992    23589    5                       PCOM.XABS = %GO_LESS_THAN_ARITH;

  23589 46 010330   000001 235007                    LDA     1,DL
        46 010331   400027 755100                    STA     23,,PR4

     1993    23590    5                   END /* Case */;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:401  
  23590 46 010332   021307 710000 46                 TRA     s:26924

     1994    23591
     1995    23592    4                 CASE(%GO_GREATER_THAN);

     1996    23593    5                   DO CASE(GO_EXPR$ -> ETT.ID);

  23593 46 010333   200243 471500                    LDP1    GO_EXPR$,,AUTO
        46 010334   100000 236100                    LDQ     0,,PR1
        46 010335   000022 772000                    QRL     18
        46 010336   000025 136007                    SBLQ    21,DL
        46 010337   000155 116007                    CMPQ    109,DL
        46 010340   010342 602006 46                 TNC     s:23593+7,QL
        46 010341   010522 710000 46                 TRA     s:23602
        46 010342   010517 710000 46                 TRA     s:23599
        46 010343   010522 710000 46                 TRA     s:23602
        46 010344   010522 710000 46                 TRA     s:23602
        46 010345   010522 710000 46                 TRA     s:23602
        46 010346   010522 710000 46                 TRA     s:23602
        46 010347   010522 710000 46                 TRA     s:23602
        46 010350   010522 710000 46                 TRA     s:23602
        46 010351   010522 710000 46                 TRA     s:23602
        46 010352   010522 710000 46                 TRA     s:23602
        46 010353   010522 710000 46                 TRA     s:23602
        46 010354   010522 710000 46                 TRA     s:23602
        46 010355   010522 710000 46                 TRA     s:23602
        46 010356   010522 710000 46                 TRA     s:23602
        46 010357   010522 710000 46                 TRA     s:23602
        46 010360   010522 710000 46                 TRA     s:23602
        46 010361   010522 710000 46                 TRA     s:23602
        46 010362   010522 710000 46                 TRA     s:23602
        46 010363   010522 710000 46                 TRA     s:23602
        46 010364   010522 710000 46                 TRA     s:23602
        46 010365   010522 710000 46                 TRA     s:23602
        46 010366   010522 710000 46                 TRA     s:23602
        46 010367   010522 710000 46                 TRA     s:23602
        46 010370   010522 710000 46                 TRA     s:23602
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:402  
        46 010371   010522 710000 46                 TRA     s:23602
        46 010372   010522 710000 46                 TRA     s:23602
        46 010373   010522 710000 46                 TRA     s:23602
        46 010374   010522 710000 46                 TRA     s:23602
        46 010375   010522 710000 46                 TRA     s:23602
        46 010376   010522 710000 46                 TRA     s:23602
        46 010377   010522 710000 46                 TRA     s:23602
        46 010400   010522 710000 46                 TRA     s:23602
        46 010401   010522 710000 46                 TRA     s:23602
        46 010402   010522 710000 46                 TRA     s:23602
        46 010403   010522 710000 46                 TRA     s:23602
        46 010404   010522 710000 46                 TRA     s:23602
        46 010405   010522 710000 46                 TRA     s:23602
        46 010406   010522 710000 46                 TRA     s:23602
        46 010407   010522 710000 46                 TRA     s:23602
        46 010410   010522 710000 46                 TRA     s:23602
        46 010411   010522 710000 46                 TRA     s:23602
        46 010412   010522 710000 46                 TRA     s:23602
        46 010413   010522 710000 46                 TRA     s:23602
        46 010414   010522 710000 46                 TRA     s:23602
        46 010415   010522 710000 46                 TRA     s:23602
        46 010416   010522 710000 46                 TRA     s:23602
        46 010417   010522 710000 46                 TRA     s:23602
        46 010420   010522 710000 46                 TRA     s:23602
        46 010421   010522 710000 46                 TRA     s:23602
        46 010422   010522 710000 46                 TRA     s:23602
        46 010423   010522 710000 46                 TRA     s:23602
        46 010424   010522 710000 46                 TRA     s:23602
        46 010425   010522 710000 46                 TRA     s:23602
        46 010426   010517 710000 46                 TRA     s:23599
        46 010427   010522 710000 46                 TRA     s:23602
        46 010430   010522 710000 46                 TRA     s:23602
        46 010431   010522 710000 46                 TRA     s:23602
        46 010432   010522 710000 46                 TRA     s:23602
        46 010433   010517 710000 46                 TRA     s:23599
        46 010434   010522 710000 46                 TRA     s:23602
        46 010435   010522 710000 46                 TRA     s:23602
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:403  
        46 010436   010517 710000 46                 TRA     s:23599
        46 010437   010522 710000 46                 TRA     s:23602
        46 010440   010522 710000 46                 TRA     s:23602
        46 010441   010522 710000 46                 TRA     s:23602
        46 010442   010522 710000 46                 TRA     s:23602
        46 010443   010522 710000 46                 TRA     s:23602
        46 010444   010522 710000 46                 TRA     s:23602
        46 010445   010522 710000 46                 TRA     s:23602
        46 010446   010522 710000 46                 TRA     s:23602
        46 010447   010522 710000 46                 TRA     s:23602
        46 010450   010522 710000 46                 TRA     s:23602
        46 010451   010522 710000 46                 TRA     s:23602
        46 010452   010522 710000 46                 TRA     s:23602
        46 010453   010522 710000 46                 TRA     s:23602
        46 010454   010522 710000 46                 TRA     s:23602
        46 010455   010522 710000 46                 TRA     s:23602
        46 010456   010522 710000 46                 TRA     s:23602
        46 010457   010522 710000 46                 TRA     s:23602
        46 010460   010522 710000 46                 TRA     s:23602
        46 010461   010522 710000 46                 TRA     s:23602
        46 010462   010522 710000 46                 TRA     s:23602
        46 010463   010522 710000 46                 TRA     s:23602
        46 010464   010522 710000 46                 TRA     s:23602
        46 010465   010522 710000 46                 TRA     s:23602
        46 010466   010522 710000 46                 TRA     s:23602
        46 010467   010522 710000 46                 TRA     s:23602
        46 010470   010522 710000 46                 TRA     s:23602
        46 010471   010522 710000 46                 TRA     s:23602
        46 010472   010522 710000 46                 TRA     s:23602
        46 010473   010522 710000 46                 TRA     s:23602
        46 010474   010522 710000 46                 TRA     s:23602
        46 010475   010517 710000 46                 TRA     s:23599
        46 010476   010522 710000 46                 TRA     s:23602
        46 010477   010522 710000 46                 TRA     s:23602
        46 010500   010522 710000 46                 TRA     s:23602
        46 010501   010522 710000 46                 TRA     s:23602
        46 010502   010522 710000 46                 TRA     s:23602
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:404  
        46 010503   010522 710000 46                 TRA     s:23602
        46 010504   010522 710000 46                 TRA     s:23602
        46 010505   010522 710000 46                 TRA     s:23602
        46 010506   010522 710000 46                 TRA     s:23602
        46 010507   010522 710000 46                 TRA     s:23602
        46 010510   010522 710000 46                 TRA     s:23602
        46 010511   010522 710000 46                 TRA     s:23602
        46 010512   010522 710000 46                 TRA     s:23602
        46 010513   010522 710000 46                 TRA     s:23602
        46 010514   010522 710000 46                 TRA     s:23602
        46 010515   010522 710000 46                 TRA     s:23602
        46 010516   010517 710000 46                 TRA     s:23599

     1997    23594    5                     CASE(

     1998    23595                               %SET_OF_ALPHANUM_COMPARISONS;
     1999    23598    5                                                       );
     2000    23599    5                       PCOM.XABS = %GO_GREATER_THAN_ALPHA;

  23599 46 010517   000004 235007                    LDA     4,DL
        46 010520   400027 755100                    STA     23,,PR4
        46 010521   021307 710000 46                 TRA     s:26924

     2001    23600
     2002    23601    5                     CASE(ELSE);

     2003    23602    5                       PCOM.XABS = %GO_GREATER_THAN_ARITH;

  23602 46 010522   000003 235007                    LDA     3,DL
        46 010523   400027 755100                    STA     23,,PR4

     2004    23603    5                   END /* Case */;

  23603 46 010524   021307 710000 46                 TRA     s:26924

     2005    23604
     2006    23605    4                 CASE(%GO_LESS_THAN_OR_EQUAL);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:405  

     2007    23606    5                   DO CASE(GO_EXPR$ -> ETT.ID);

  23606 46 010525   200243 471500                    LDP1    GO_EXPR$,,AUTO
        46 010526   100000 236100                    LDQ     0,,PR1
        46 010527   000022 772000                    QRL     18
        46 010530   000025 136007                    SBLQ    21,DL
        46 010531   000155 116007                    CMPQ    109,DL
        46 010532   010534 602006 46                 TNC     s:23606+7,QL
        46 010533   010714 710000 46                 TRA     s:23615
        46 010534   010711 710000 46                 TRA     s:23612
        46 010535   010714 710000 46                 TRA     s:23615
        46 010536   010714 710000 46                 TRA     s:23615
        46 010537   010714 710000 46                 TRA     s:23615
        46 010540   010714 710000 46                 TRA     s:23615
        46 010541   010714 710000 46                 TRA     s:23615
        46 010542   010714 710000 46                 TRA     s:23615
        46 010543   010714 710000 46                 TRA     s:23615
        46 010544   010714 710000 46                 TRA     s:23615
        46 010545   010714 710000 46                 TRA     s:23615
        46 010546   010714 710000 46                 TRA     s:23615
        46 010547   010714 710000 46                 TRA     s:23615
        46 010550   010714 710000 46                 TRA     s:23615
        46 010551   010714 710000 46                 TRA     s:23615
        46 010552   010714 710000 46                 TRA     s:23615
        46 010553   010714 710000 46                 TRA     s:23615
        46 010554   010714 710000 46                 TRA     s:23615
        46 010555   010714 710000 46                 TRA     s:23615
        46 010556   010714 710000 46                 TRA     s:23615
        46 010557   010714 710000 46                 TRA     s:23615
        46 010560   010714 710000 46                 TRA     s:23615
        46 010561   010714 710000 46                 TRA     s:23615
        46 010562   010714 710000 46                 TRA     s:23615
        46 010563   010714 710000 46                 TRA     s:23615
        46 010564   010714 710000 46                 TRA     s:23615
        46 010565   010714 710000 46                 TRA     s:23615
        46 010566   010714 710000 46                 TRA     s:23615
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:406  
        46 010567   010714 710000 46                 TRA     s:23615
        46 010570   010714 710000 46                 TRA     s:23615
        46 010571   010714 710000 46                 TRA     s:23615
        46 010572   010714 710000 46                 TRA     s:23615
        46 010573   010714 710000 46                 TRA     s:23615
        46 010574   010714 710000 46                 TRA     s:23615
        46 010575   010714 710000 46                 TRA     s:23615
        46 010576   010714 710000 46                 TRA     s:23615
        46 010577   010714 710000 46                 TRA     s:23615
        46 010600   010714 710000 46                 TRA     s:23615
        46 010601   010714 710000 46                 TRA     s:23615
        46 010602   010714 710000 46                 TRA     s:23615
        46 010603   010714 710000 46                 TRA     s:23615
        46 010604   010714 710000 46                 TRA     s:23615
        46 010605   010714 710000 46                 TRA     s:23615
        46 010606   010714 710000 46                 TRA     s:23615
        46 010607   010714 710000 46                 TRA     s:23615
        46 010610   010714 710000 46                 TRA     s:23615
        46 010611   010714 710000 46                 TRA     s:23615
        46 010612   010714 710000 46                 TRA     s:23615
        46 010613   010714 710000 46                 TRA     s:23615
        46 010614   010714 710000 46                 TRA     s:23615
        46 010615   010714 710000 46                 TRA     s:23615
        46 010616   010714 710000 46                 TRA     s:23615
        46 010617   010714 710000 46                 TRA     s:23615
        46 010620   010711 710000 46                 TRA     s:23612
        46 010621   010714 710000 46                 TRA     s:23615
        46 010622   010714 710000 46                 TRA     s:23615
        46 010623   010714 710000 46                 TRA     s:23615
        46 010624   010714 710000 46                 TRA     s:23615
        46 010625   010711 710000 46                 TRA     s:23612
        46 010626   010714 710000 46                 TRA     s:23615
        46 010627   010714 710000 46                 TRA     s:23615
        46 010630   010711 710000 46                 TRA     s:23612
        46 010631   010714 710000 46                 TRA     s:23615
        46 010632   010714 710000 46                 TRA     s:23615
        46 010633   010714 710000 46                 TRA     s:23615
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:407  
        46 010634   010714 710000 46                 TRA     s:23615
        46 010635   010714 710000 46                 TRA     s:23615
        46 010636   010714 710000 46                 TRA     s:23615
        46 010637   010714 710000 46                 TRA     s:23615
        46 010640   010714 710000 46                 TRA     s:23615
        46 010641   010714 710000 46                 TRA     s:23615
        46 010642   010714 710000 46                 TRA     s:23615
        46 010643   010714 710000 46                 TRA     s:23615
        46 010644   010714 710000 46                 TRA     s:23615
        46 010645   010714 710000 46                 TRA     s:23615
        46 010646   010714 710000 46                 TRA     s:23615
        46 010647   010714 710000 46                 TRA     s:23615
        46 010650   010714 710000 46                 TRA     s:23615
        46 010651   010714 710000 46                 TRA     s:23615
        46 010652   010714 710000 46                 TRA     s:23615
        46 010653   010714 710000 46                 TRA     s:23615
        46 010654   010714 710000 46                 TRA     s:23615
        46 010655   010714 710000 46                 TRA     s:23615
        46 010656   010714 710000 46                 TRA     s:23615
        46 010657   010714 710000 46                 TRA     s:23615
        46 010660   010714 710000 46                 TRA     s:23615
        46 010661   010714 710000 46                 TRA     s:23615
        46 010662   010714 710000 46                 TRA     s:23615
        46 010663   010714 710000 46                 TRA     s:23615
        46 010664   010714 710000 46                 TRA     s:23615
        46 010665   010714 710000 46                 TRA     s:23615
        46 010666   010714 710000 46                 TRA     s:23615
        46 010667   010711 710000 46                 TRA     s:23612
        46 010670   010714 710000 46                 TRA     s:23615
        46 010671   010714 710000 46                 TRA     s:23615
        46 010672   010714 710000 46                 TRA     s:23615
        46 010673   010714 710000 46                 TRA     s:23615
        46 010674   010714 710000 46                 TRA     s:23615
        46 010675   010714 710000 46                 TRA     s:23615
        46 010676   010714 710000 46                 TRA     s:23615
        46 010677   010714 710000 46                 TRA     s:23615
        46 010700   010714 710000 46                 TRA     s:23615
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:408  
        46 010701   010714 710000 46                 TRA     s:23615
        46 010702   010714 710000 46                 TRA     s:23615
        46 010703   010714 710000 46                 TRA     s:23615
        46 010704   010714 710000 46                 TRA     s:23615
        46 010705   010714 710000 46                 TRA     s:23615
        46 010706   010714 710000 46                 TRA     s:23615
        46 010707   010714 710000 46                 TRA     s:23615
        46 010710   010711 710000 46                 TRA     s:23612

     2008    23607    5                     CASE(

     2009    23608                               %SET_OF_ALPHANUM_COMPARISONS;
     2010    23611    5                                                       );
     2011    23612    5                       PCOM.XABS = %GO_LESS_THAN_OR_EQUAL_ALPHA;

  23612 46 010711   000006 235007                    LDA     6,DL
        46 010712   400027 755100                    STA     23,,PR4
        46 010713   021307 710000 46                 TRA     s:26924

     2012    23613
     2013    23614    5                     CASE(ELSE);

     2014    23615    5                       PCOM.XABS = %GO_LESS_THAN_OR_EQUAL_ARITH;

  23615 46 010714   000005 235007                    LDA     5,DL
        46 010715   400027 755100                    STA     23,,PR4

     2015    23616    5                   END /* Case */;

  23616 46 010716   021307 710000 46                 TRA     s:26924

     2016    23617
     2017    23618    4                 CASE(%GO_GREATER_THAN_OR_EQUAL);

     2018    23619    5                   DO CASE(GO_EXPR$ -> ETT.ID);

  23619 46 010717   200243 471500                    LDP1    GO_EXPR$,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:409  
        46 010720   100000 236100                    LDQ     0,,PR1
        46 010721   000022 772000                    QRL     18
        46 010722   000025 136007                    SBLQ    21,DL
        46 010723   000155 116007                    CMPQ    109,DL
        46 010724   010726 602006 46                 TNC     s:23619+7,QL
        46 010725   011106 710000 46                 TRA     s:23628
        46 010726   011103 710000 46                 TRA     s:23625
        46 010727   011106 710000 46                 TRA     s:23628
        46 010730   011106 710000 46                 TRA     s:23628
        46 010731   011106 710000 46                 TRA     s:23628
        46 010732   011106 710000 46                 TRA     s:23628
        46 010733   011106 710000 46                 TRA     s:23628
        46 010734   011106 710000 46                 TRA     s:23628
        46 010735   011106 710000 46                 TRA     s:23628
        46 010736   011106 710000 46                 TRA     s:23628
        46 010737   011106 710000 46                 TRA     s:23628
        46 010740   011106 710000 46                 TRA     s:23628
        46 010741   011106 710000 46                 TRA     s:23628
        46 010742   011106 710000 46                 TRA     s:23628
        46 010743   011106 710000 46                 TRA     s:23628
        46 010744   011106 710000 46                 TRA     s:23628
        46 010745   011106 710000 46                 TRA     s:23628
        46 010746   011106 710000 46                 TRA     s:23628
        46 010747   011106 710000 46                 TRA     s:23628
        46 010750   011106 710000 46                 TRA     s:23628
        46 010751   011106 710000 46                 TRA     s:23628
        46 010752   011106 710000 46                 TRA     s:23628
        46 010753   011106 710000 46                 TRA     s:23628
        46 010754   011106 710000 46                 TRA     s:23628
        46 010755   011106 710000 46                 TRA     s:23628
        46 010756   011106 710000 46                 TRA     s:23628
        46 010757   011106 710000 46                 TRA     s:23628
        46 010760   011106 710000 46                 TRA     s:23628
        46 010761   011106 710000 46                 TRA     s:23628
        46 010762   011106 710000 46                 TRA     s:23628
        46 010763   011106 710000 46                 TRA     s:23628
        46 010764   011106 710000 46                 TRA     s:23628
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:410  
        46 010765   011106 710000 46                 TRA     s:23628
        46 010766   011106 710000 46                 TRA     s:23628
        46 010767   011106 710000 46                 TRA     s:23628
        46 010770   011106 710000 46                 TRA     s:23628
        46 010771   011106 710000 46                 TRA     s:23628
        46 010772   011106 710000 46                 TRA     s:23628
        46 010773   011106 710000 46                 TRA     s:23628
        46 010774   011106 710000 46                 TRA     s:23628
        46 010775   011106 710000 46                 TRA     s:23628
        46 010776   011106 710000 46                 TRA     s:23628
        46 010777   011106 710000 46                 TRA     s:23628
        46 011000   011106 710000 46                 TRA     s:23628
        46 011001   011106 710000 46                 TRA     s:23628
        46 011002   011106 710000 46                 TRA     s:23628
        46 011003   011106 710000 46                 TRA     s:23628
        46 011004   011106 710000 46                 TRA     s:23628
        46 011005   011106 710000 46                 TRA     s:23628
        46 011006   011106 710000 46                 TRA     s:23628
        46 011007   011106 710000 46                 TRA     s:23628
        46 011010   011106 710000 46                 TRA     s:23628
        46 011011   011106 710000 46                 TRA     s:23628
        46 011012   011103 710000 46                 TRA     s:23625
        46 011013   011106 710000 46                 TRA     s:23628
        46 011014   011106 710000 46                 TRA     s:23628
        46 011015   011106 710000 46                 TRA     s:23628
        46 011016   011106 710000 46                 TRA     s:23628
        46 011017   011103 710000 46                 TRA     s:23625
        46 011020   011106 710000 46                 TRA     s:23628
        46 011021   011106 710000 46                 TRA     s:23628
        46 011022   011103 710000 46                 TRA     s:23625
        46 011023   011106 710000 46                 TRA     s:23628
        46 011024   011106 710000 46                 TRA     s:23628
        46 011025   011106 710000 46                 TRA     s:23628
        46 011026   011106 710000 46                 TRA     s:23628
        46 011027   011106 710000 46                 TRA     s:23628
        46 011030   011106 710000 46                 TRA     s:23628
        46 011031   011106 710000 46                 TRA     s:23628
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:411  
        46 011032   011106 710000 46                 TRA     s:23628
        46 011033   011106 710000 46                 TRA     s:23628
        46 011034   011106 710000 46                 TRA     s:23628
        46 011035   011106 710000 46                 TRA     s:23628
        46 011036   011106 710000 46                 TRA     s:23628
        46 011037   011106 710000 46                 TRA     s:23628
        46 011040   011106 710000 46                 TRA     s:23628
        46 011041   011106 710000 46                 TRA     s:23628
        46 011042   011106 710000 46                 TRA     s:23628
        46 011043   011106 710000 46                 TRA     s:23628
        46 011044   011106 710000 46                 TRA     s:23628
        46 011045   011106 710000 46                 TRA     s:23628
        46 011046   011106 710000 46                 TRA     s:23628
        46 011047   011106 710000 46                 TRA     s:23628
        46 011050   011106 710000 46                 TRA     s:23628
        46 011051   011106 710000 46                 TRA     s:23628
        46 011052   011106 710000 46                 TRA     s:23628
        46 011053   011106 710000 46                 TRA     s:23628
        46 011054   011106 710000 46                 TRA     s:23628
        46 011055   011106 710000 46                 TRA     s:23628
        46 011056   011106 710000 46                 TRA     s:23628
        46 011057   011106 710000 46                 TRA     s:23628
        46 011060   011106 710000 46                 TRA     s:23628
        46 011061   011103 710000 46                 TRA     s:23625
        46 011062   011106 710000 46                 TRA     s:23628
        46 011063   011106 710000 46                 TRA     s:23628
        46 011064   011106 710000 46                 TRA     s:23628
        46 011065   011106 710000 46                 TRA     s:23628
        46 011066   011106 710000 46                 TRA     s:23628
        46 011067   011106 710000 46                 TRA     s:23628
        46 011070   011106 710000 46                 TRA     s:23628
        46 011071   011106 710000 46                 TRA     s:23628
        46 011072   011106 710000 46                 TRA     s:23628
        46 011073   011106 710000 46                 TRA     s:23628
        46 011074   011106 710000 46                 TRA     s:23628
        46 011075   011106 710000 46                 TRA     s:23628
        46 011076   011106 710000 46                 TRA     s:23628
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:412  
        46 011077   011106 710000 46                 TRA     s:23628
        46 011100   011106 710000 46                 TRA     s:23628
        46 011101   011106 710000 46                 TRA     s:23628
        46 011102   011103 710000 46                 TRA     s:23625

     2019    23620    5                     CASE(

     2020    23621                               %SET_OF_ALPHANUM_COMPARISONS;
     2021    23624    5                                                       );
     2022    23625    5                       PCOM.XABS = %GO_GREATER_THAN_OR_EQUAL_ALPHA;

  23625 46 011103   000010 235007                    LDA     8,DL
        46 011104   400027 755100                    STA     23,,PR4
        46 011105   021307 710000 46                 TRA     s:26924

     2023    23626
     2024    23627    5                     CASE(ELSE);

     2025    23628    5                       PCOM.XABS = %GO_GREATER_THAN_OR_EQUAL_ARITH;

  23628 46 011106   000007 235007                    LDA     7,DL
        46 011107   400027 755100                    STA     23,,PR4

     2026    23629    5                   END /* Case */;

     2027    23630    4               END /* Case */;

  23630 46 011110   021307 710000 46                 TRA     s:26924

     2028    23631
     2029    23632    3           CASE(%SECOND_PASS);

     2030    23633    4              DO CASE(PILL -> ILL.CODE); /* Subroutine call, Z8HP to Z9HP */

  23633 46 011111   100000 236100                    LDQ     0,,PR1
        46 011112   777777 376007                    ANQ     -1,DL
        46 011113   000025 136007                    SBLQ    21,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:413  
        46 011114   000002 116007                    CMPQ    2,DL
        46 011115   011117 602006 46                 TNC     s:23633+6,QL
        46 011116   011141 710000 46                 TRA     s:23641
        46 011117   011121 710000 46                 TRA     s:23635
        46 011120   011131 710000 46                 TRA     s:23638

     2031    23634    4                  CASE(%GO_SWITCH_ON);

     2032    23635    4                       CALL Z8HI$BURST(PILL,DEP.TDEP);

  23635 46 011121   000065 236000 47                 LDQ     53
        46 011122   200003 235100                    LDA     @PILL,,AUTO
        46 011123   200302 757100                    STAQ    ORG1+1,,AUTO
        46 011124   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 011125   000013 631400 47                 EPPR1   11
        46 011126   000000 701000 xent               TSX1    Z8HI$BURST
        46 011127   000000 011000                    NOP     0
        46 011130   021307 710000 46                 TRA     s:26924

     2033    23636
     2034    23637    4                  CASE(%GO_SWITCH_OFF);

     2035    23638    4                       CALL Z8HI$BURST(PILL,DEP.UDEP);

  23638 46 011131   000066 236000 47                 LDQ     54
        46 011132   200003 235100                    LDA     @PILL,,AUTO
        46 011133   200302 757100                    STAQ    ORG1+1,,AUTO
        46 011134   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 011135   000013 631400 47                 EPPR1   11
        46 011136   000000 701000 xent               TSX1    Z8HI$BURST
        46 011137   000000 011000                    NOP     0
        46 011140   021307 710000 46                 TRA     s:26924

     2036    23639
     2037    23640    4                  CASE(ELSE);

     2038    23641    4                      CALL Z8AE$ERROR(%E$UNEXPECTED_CASE,
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:414  

  23641 46 011141   000067 630400 47                 EPPR0   55
        46 011142   000043 631400 47                 EPPR1   35
        46 011143   000000 701000 xent               TSX1    Z8AE$ERROR
        46 011144   000000 011000                    NOP     0

     2039    23642    4                              COMCOM.CURRENT.LINE,0);
     2040    23643    4              END; /* CASE */

     2041    23644
     2042    23645    3        END; /* CASE */

  23645 46 011145   021307 710000 46                 TRA     s:26924

     2043    23646
     2044    23647        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:415  
     2045    23648    2   CASE(%INCRV);

     2046    23649
     2047    23650    2        PILL -> ETT.ROP -> ETT.COUNT = 0;

  23650 46 011146   100002 473500                    LDP3    2,,PR1
        46 011147   000000 220003                    LDX0    0,DU
        46 011150   300000 440100                    SXL0    0,,PR3
        46 011151   021307 710000 46                 TRA     s:26924

     2048    23651
     2049    23652        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:416  
     2050    23653    2   CASE(%INDEX);

     2051    23654
     2052    23655    2        CALL Z8AU$LENGTH_ETT(PILL -> ETT.LOP, PCOM.LOPND);

  23655 46 011152   200004 236100                    LDQ     @PCOM,,AUTO
        46 011153   000045 036003                    ADLQ    37,DU
        46 011154   200303 756100                    STQ     ORG1+2,,AUTO
        46 011155   100001 633500                    EPPR3   1,,PR1
        46 011156   200302 453500                    STP3    ORG1+1,,AUTO
        46 011157   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 011160   000013 631400 47                 EPPR1   11
        46 011161   000000 701000 xent               TSX1    Z8AU$LENGTH_ETT
        46 011162   000000 011000                    NOP     0

     2053    23656
     2054    23657    2        IF PCOM.LOPND -> ETT.ID = %TRIAD

  23657 46 011163   200004 470500                    LDP0    @PCOM,,AUTO
        46 011164   000045 471500                    LDP1    37,,PR0
        46 011165   100000 220100                    LDX0    0,,PR1
        46 011166   000015 100003                    CMPX0   13,DU
        46 011167   011214 601000 46                 TNZ     s:23672
        46 011170   100001 473500                    LDP3    1,,PR1
        46 011171   300010 235100                    LDA     8,,PR3
        46 011172   000003 115007                    CMPA    3,DL
        46 011173   011214 605000 46                 TPL     s:23672

     2055    23658    2           AND (PCOM.LOPND -> ETT.LOP -> CONST.CONSTI.WORD1 < 3) THEN
     2056    23659    3          DO CASE(PCOM.LOPND -> ETT.LOP -> CONST.CONSTI.WORD1);

  23659 46 011174   000003 115007                    CMPA    3,DL
        46 011175   011177 602005 46                 TNC     s:23659+3,AL
        46 011176   011207 710000 46                 TRA     s:23667
        46 011177   011207 710000 46                 TRA     s:23667
        46 011200   011202 710000 46                 TRA     s:23661
        46 011201   011204 710000 46                 TRA     s:23664
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:417  

     2057    23660    3            CASE(1);

     2058    23661    3              PCOM.JABS = 0;

  23661 46 011202   000011 450100                    STZ     9,,PR0
        46 011203   021307 710000 46                 TRA     s:26924

     2059    23662
     2060    23663    3            CASE(2);

     2061    23664    3              PCOM.JABS = 1;

  23664 46 011204   000001 236007                    LDQ     1,DL
        46 011205   000011 756100                    STQ     9,,PR0
        46 011206   021307 710000 46                 TRA     s:26924

     2062    23665
     2063    23666    3            CASE(ELSE);

     2064    23667    3              CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);

  23667 46 011207   000061 630400 47                 EPPR0   49
        46 011210   000000 631400 47                 EPPR1   0
        46 011211   000000 701000 xent               TSX1    Z8AE$ERROR
        46 011212   000000 011000                    NOP     0

     2065    23668
     2066    23669    3          END /* Case */;

  23669 46 011213   021307 710000 46                 TRA     s:26924

     2067    23670    2        ELSE
     2068    23671    3          DO;

     2069    23672    3            PCOM.JABS = 2;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:418  
  23672 46 011214   000002 235007                    LDA     2,DL
        46 011215   000011 755100                    STA     9,,PR0

     2070    23673
     2071    23674    3            CALL Z8AU$LENGTH_ETT(PILL -> ETT.ROP, PCOM.ROPND);

  23674 46 011216   200003 473500                    LDP3    @PILL,,AUTO
        46 011217   300000 474500                    LDP4    0,,PR3
        46 011220   200004 236100                    LDQ     @PCOM,,AUTO
        46 011221   000053 036003                    ADLQ    43,DU
        46 011222   200303 756100                    STQ     ORG1+2,,AUTO
        46 011223   400002 631500                    EPPR1   2,,PR4
        46 011224   200302 451500                    STP1    ORG1+1,,AUTO
        46 011225   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 011226   000013 631400 47                 EPPR1   11
        46 011227   000000 701000 xent               TSX1    Z8AU$LENGTH_ETT
        46 011230   000000 011000                    NOP     0

     2072    23675
     2073    23676                         /* Initialize count field of LOPND and ROPND
     2074    23677                            because we can't be sure that Z8AU gives
     2075    23678                            us a 'clean' triad.
     2076    23679                         */
     2077    23680    3            IF PCOM.LOPND -> ETT.ID = %TRIAD THEN

  23680 46 011231   200004 470500                    LDP0    @PCOM,,AUTO
        46 011232   000045 471500                    LDP1    37,,PR0
        46 011233   100000 220100                    LDX0    0,,PR1
        46 011234   000015 100003                    CMPX0   13,DU
        46 011235   011240 601000 46                 TNZ     s:23682

     2078    23681    3              PCOM.LOPND -> ETT.COUNT = 0;

  23681 46 011236   000000 221003                    LDX1    0,DU
        46 011237   100000 441100                    SXL1    0,,PR1

     2079    23682    3            IF PCOM.ROPND -> ETT.ID = %TRIAD THEN
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:419  

  23682 46 011240   000053 471500                    LDP1    43,,PR0
        46 011241   100000 220100                    LDX0    0,,PR1
        46 011242   000015 100003                    CMPX0   13,DU
        46 011243   011246 601000 46                 TNZ     s:23685

     2080    23683    3              PCOM.ROPND -> ETT.COUNT = 0;

  23683 46 011244   000000 221003                    LDX1    0,DU
        46 011245   100000 441100                    SXL1    0,,PR1

     2081    23684
     2082    23685    3            CALL Z8HU$INCCNT(PCOM.ROPND, 1);

  23685 46 011246   000016 236000 47                 LDQ     14
        46 011247   200303 756100                    STQ     ORG1+2,,AUTO
        46 011250   200004 236100                    LDQ     @PCOM,,AUTO
        46 011251   000053 036003                    ADLQ    43,DU
        46 011252   200302 756100                    STQ     ORG1+1,,AUTO
        46 011253   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 011254   000013 631400 47                 EPPR1   11
        46 011255   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 011256   000000 011000                    NOP     0

     2083    23686    3            CALL Z8HU$INCCNT(PCOM.LOPND, 1);

  23686 46 011257   000016 236000 47                 LDQ     14
        46 011260   200303 756100                    STQ     ORG1+2,,AUTO
        46 011261   200004 236100                    LDQ     @PCOM,,AUTO
        46 011262   000045 036003                    ADLQ    37,DU
        46 011263   200302 756100                    STQ     ORG1+1,,AUTO
        46 011264   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 011265   000013 631400 47                 EPPR1   11
        46 011266   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 011267   000000 011000                    NOP     0

     2084    23687
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:420  
     2085    23688    3            CALL Z8AF$FORME(%SBI, PCOM.ROPND, PCOM.LOPND, P$);

  23688 46 011270   200064 630500                    EPPR0   P$,,AUTO
        46 011271   200305 450500                    STP0    ORG1+4,,AUTO
        46 011272   200004 236100                    LDQ     @PCOM,,AUTO
        46 011273   000045 036003                    ADLQ    37,DU
        46 011274   200304 756100                    STQ     ORG1+3,,AUTO
        46 011275   200004 236100                    LDQ     @PCOM,,AUTO
        46 011276   000053 036003                    ADLQ    43,DU
        46 011277   000073 235000 47                 LDA     59
        46 011300   200302 757100                    STAQ    ORG1+1,,AUTO
        46 011301   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 011302   000025 631400 47                 EPPR1   21
        46 011303   000000 701000 xent               TSX1    Z8AF$FORME
        46 011304   000000 011000                    NOP     0

     2086    23689    3            CALL Z8AF$FORME(%ADI, P$, COMCOM.VALUE_1, PCOM.IOPND);

  23689 46 011305   200004 236100                    LDQ     @PCOM,,AUTO
        46 011306   000042 036003                    ADLQ    34,DU
        46 011307   000075 235000 47                 LDA     61
        46 011310   200304 757100                    STAQ    ORG1+3,,AUTO
        46 011311   200064 630500                    EPPR0   P$,,AUTO
        46 011312   200303 450500                    STP0    ORG1+2,,AUTO
        46 011313   000076 236000 47                 LDQ     62
        46 011314   200302 756100                    STQ     ORG1+1,,AUTO
        46 011315   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 011316   000025 631400 47                 EPPR1   21
        46 011317   000000 701000 xent               TSX1    Z8AF$FORME
        46 011320   000000 011000                    NOP     0

     2087    23690    3          END;

  23690 46 011321   021307 710000 46                 TRA     s:26924

     2088    23691
     2089    23692        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:421  
     2090    23693    2   CASE(%INITV);

     2091    23694
     2092    23695    2        PILL -> ETT.ROP -> ETT.COUNT = %DONT_MESS;

  23695 46 011322   100002 473500                    LDP3    2,,PR1
        46 011323   777777 220003                    LDX0    -1,DU
        46 011324   300000 440100                    SXL0    0,,PR3

     2093    23696    2        PILL -> ETT.ROP -> ETT.REF$ = ADDR(NIL);

  23696 46 011325   000000 471500                    LDP1    0,,PR0
        46 011326   100002 473500                    LDP3    2,,PR1
        46 011327   000005 236000 47                 LDQ     5
        46 011330   300003 756100                    STQ     3,,PR3
        46 011331   021307 710000 46                 TRA     s:26924

     2094    23697
     2095    23698        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:422  
     2096    23699    2   CASE(%LINOI);

     2097    23700        /*V*
     2098    23701
     2099    23702                                         LINOI
     2100    23703
     2101    23704             Passes line info on to the Annotator.  If this LINOI is the same
     2102    23705             as the one previous, we do *not* generate another LINE item.
     2103    23706
     2104    23707        */
     2105    23708
     2106    23709    2        IF PILL -> LINOI.TYPE ~= %NO_STATEMENT_TYPE THEN

  23709 46 011332   100002 220100                    LDX0    2,,PR1
        46 011333   021307 600000 46                 TZE     s:26924

     2107    23710    3          DO;

     2108    23711                 %NEW_LINE ( @OFFSET = "COMCOM.SEGMENT$(%PROC) -> SEGMENT.SIZE" ,
     2109    23712                             @TYPE   = PILL -> LINOI.TYPE ,
     2110    23713                             @COLUMN = PILL -> LINOI.COLUMN_NO ,
     2111    23714                             @NUMBER = PILL -> LINOI.LINE_NO );

  23735 46 011334   000002 236000 36                 LDQ     OBJ_+2
        46 011335   000003 036007                    ADLQ    3,DL
        46 011336   000003 116000 36                 CMPQ    OBJ_+3
        46 011337   011351 604000 46                 TMI     s:23741

  23737 46 011340   000000 234000 30                 SZN     PAGING_OBJ
        46 011341   011346 605000 46                 TPL     s:23739

  23738 46 011342   000006 630400 47                 EPPR0   6
        46 011343   000000 631400 47                 EPPR1   0
        46 011344   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 011345   000000 011000                    NOP     0

  23739 46 011346   000007 631400 47                 EPPR1   7
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:423  
        46 011347   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 011350   000000 011000                    NOP     0

  23741 46 011351   000002 236000 36                 LDQ     OBJ_+2
        46 011352   000022 736000                    QLS     18
        46 011353   000001 036000 36                 ADLQ    OBJ_+1
        46 011354   000000 756000 29                 STQ     OBJ$

  23742 46 011355   000003 236007                    LDQ     3,DL
        46 011356   000002 056000 36                 ASQ     OBJ_+2

  23743 46 011357   001010 220003                    LDX0    520,DU
        46 011360   000000 470400 29                 LDP0    OBJ$
        46 011361   000000 740100                    STX0    0,,PR0

  23747 46 011362   000150 470400 xsym               LDP0    COMCOM+104
        46 011363   000002 236100                    LDQ     2,,PR0
        46 011364   000022 772000                    QRL     18
        46 011365   000000 471400 29                 LDP1    OBJ$
        46 011366   100001 756100                    STQ     1,,PR1

  23752 46 011367   200003 470500                    LDP0    @PILL,,AUTO
        46 011370   000000 473500                    LDP3    0,,PR0
        46 011371   300001 221100                    LDX1    1,,PR3
        46 011372   100002 741100                    STX1    2,,PR1

  23757 46 011373   000000 473500                    LDP3    0,,PR0
        46 011374   300001 722100                    LXL2    1,,PR3
        46 011375   100002 442100                    SXL2    2,,PR1

  23762 46 011376   000000 473500                    LDP3    0,,PR0
        46 011377   300002 223100                    LDX3    2,,PR3
        46 011400   100000 443100                    SXL3    0,,PR1

     2112    23768
     2113    23769    3            IF PILL -> LINOI.LINE_NO ~= 0 THEN

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:424  
  23769 46 011401   000000 471500                    LDP1    0,,PR0
        46 011402   100001 721100                    LXL1    1,,PR1
        46 011403   021307 600000 46                 TZE     s:26924

     2114    23770    4              DO;

     2115    23771    4                COMCOM.CURRENT.LINE = PILL -> LINOI.LINE_NO;

  23771 46 011404   100001 236100                    LDQ     1,,PR1
        46 011405   777777 376007                    ANQ     -1,DL
        46 011406   000133 756000 xsym               STQ     COMCOM+91

     2116    23772    4                COMCOM.CURRENT.COLUMN = PILL -> LINOI.COLUMN_NO;

  23772 46 011407   000000 471500                    LDP1    0,,PR0
        46 011410   100001 236100                    LDQ     1,,PR1
        46 011411   000022 772000                    QRL     18
        46 011412   000134 756000 xsym               STQ     COMCOM+92

     2117    23773    4              END;

     2118    23774    3          END;

  23774 46 011413   021307 710000 46                 TRA     s:26924

     2119    23775
     2120    23776        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:425  
     2121    23777    2   CASE(%MFILL);

     2122    23778
     2123    23779    2        CALL Z8AU$TYPE_DESCRIPTOR (PILL -> ILL.LOP, TYPE_DESC);

  23779 46 011414   200110 633500                    EPPR3   TYPE_DESC,,AUTO
        46 011415   200303 453500                    STP3    ORG1+2,,AUTO
        46 011416   100001 634500                    EPPR4   1,,PR1
        46 011417   200302 454500                    STP4    ORG1+1,,AUTO
        46 011420   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 011421   000013 631400 47                 EPPR1   11
        46 011422   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        46 011423   000000 011000                    NOP     0

     2124    23780             %FISH (TRIAD=PILL -> ILL.LOP, RTN=P$);

  23782 46 011424   200003 470500                    LDP0    @PILL,,AUTO
        46 011425   000000 471500                    LDP1    0,,PR0
        46 011426   100001 236100                    LDQ     1,,PR1
        46 011427   200064 756100                    STQ     P$,,AUTO

  23783 46 011430   200064 471500                    LDP1    P$,,AUTO
        46 011431   100000 220100                    LDX0    0,,PR1
        46 011432   000751 100003                    CMPX0   489,DU
        46 011433   011443 603000 46                 TRC     s:23789

  23784 46 011434   200064 470500                    LDP0    P$,,AUTO
        46 011435   000001 236100                    LDQ     1,,PR0
        46 011436   200064 756100                    STQ     P$,,AUTO

  23785 46 011437   200064 470500                    LDP0    P$,,AUTO
        46 011440   000000 220100                    LDX0    0,,PR0
        46 011441   000751 100003                    CMPX0   489,DU
        46 011442   011434 602000 46                 TNC     s:23784

     2125    23788
     2126    23789    2        IF (NOT P$ -> VARIABLE.B.ELEMENTARY
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:426  

  23789 46 011443   200064 470500                    LDP0    P$,,AUTO
        46 011444   000003 236100                    LDQ     3,,PR0
        46 011445   010000 316003                    CANQ    4096,DU
        46 011446   011465 600000 46                 TZE     s:23789+18
        46 011447   000002 220100                    LDX0    2,,PR0
        46 011450   011465 601000 46                 TNZ     s:23789+18
        46 011451   000001 236100                    LDQ     1,,PR0
        46 011452   040000 316007                    CANQ    16384,DL
        46 011453   011465 600000 46                 TZE     s:23789+18
        46 011454   000003 430100                    FSZN    3,,PR0
        46 011455   011465 604000 46                 TMI     s:23789+18
        46 011456   000003 236100                    LDQ     3,,PR0
        46 011457   000400 316003                    CANQ    256,DU
        46 011460   011465 601000 46                 TNZ     s:23789+18
        46 011461   000007 471500                    LDP1    7,,PR0
        46 011462   100000 236100                    LDQ     0,,PR1
        46 011463   040000 316007                    CANQ    16384,DL
        46 011464   021307 600000 46                 TZE     s:26924
        46 011465   200003 471500                    LDP1    @PILL,,AUTO
        46 011466   100000 473500                    LDP3    0,,PR1
        46 011467   300001 474500                    LDP4    1,,PR3
        46 011470   400004 220100                    LDX0    4,,PR4
        46 011471   011474 600000 46                 TZE     s:23798
        46 011472   000004 100003                    CMPX0   4,DU
        46 011473   021307 601000 46                 TNZ     s:26924

     2127    23790    2             OR P$ -> VARIABLE.TYPE ~= %TYD
     2128    23791    2             OR P$ -> VARIABLE.NDSC.TN = %NDSC9
     2129    23792    2             OR P$ -> VARIABLE.B.REDEF_SUB
     2130    23793    2             OR P$ -> VARIABLE.B.REDEF_OBJ
     2131    23794    2             OR P$ -> VARIABLE.QLT$ -> QLT.B.RENAMES)
     2132    23795    2         AND (PILL -> ILL.LOP -> ETT.STATE = %UNEVAL_T OR
     2133    23796    2              PILL -> ILL.LOP -> ETT.STATE = %REF_T) THEN
     2134    23797    3          DO;

     2135    23798    3            J = TYPE_DESC.DESC.SA * 8 + TYPE_DESC.DESC.NDSC.CN;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:427  

  23798 46 011474   200111 236100                    LDQ     TYPE_DESC+1,,AUTO
        46 011475   000017 772000                    QRL     15
        46 011476   000007 376007                    ANQ     7,DL
        46 011477   200302 756100                    STQ     ORG1+1,,AUTO
        46 011500   200111 236100                    LDQ     TYPE_DESC+1,,AUTO
        46 011501   777777 376003                    ANQ     -1,DU
        46 011502   000017 772000                    QRL     15
        46 011503   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 011504   200066 756100                    STQ     J,,AUTO

     2136    23799    3            IF P$ -> VARIABLE.B.CLASS = %CLASS_NUMERIC THEN

  23799 46 011505   000003 236100                    LDQ     3,,PR0
        46 011506   000007 376007                    ANQ     7,DL
        46 011507   000001 116007                    CMPQ    1,DL
        46 011510   011522 601000 46                 TNZ     s:23809

     2137    23800    4              DO;

     2138    23801    4                LOP_LEN = P$ -> VARIABLE.NDSC.N;

  23801 46 011511   000001 236100                    LDQ     1,,PR0
        46 011512   000077 376007                    ANQ     63,DL
        46 011513   200077 756100                    STQ     LOP_LEN,,AUTO

     2139    23802    4                IF P$ -> VARIABLE.NDSC.TN = %NDSC9 THEN

  23802 46 011514   000001 236100                    LDQ     1,,PR0
        46 011515   040000 316007                    CANQ    16384,DL
        46 011516   011555 601000 46                 TNZ     s:23823

     2140    23803    4                  LOP_LEN = LOP_LEN * 2; /* Convert to digits */

  23803 46 011517   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 011520   200077 056100                    ASQ     LOP_LEN,,AUTO

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:428  
     2141    23804    4              END;

  23804 46 011521   011555 710000 46                 TRA     s:23823

     2142    23805    3            ELSE
     2143    23806    4              DO;

     2144    23807                     %GET_ADSC_LEN (ST$ = P$, RTN = LOP_LEN);

  23809 46 011522   000003 236100                    LDQ     3,,PR0
        46 011523   004000 316003                    CANQ    2048,DU
        46 011524   011540 600000 46                 TZE     s:23815

  23810 46 011525   000005 473500                    LDP3    5,,PR0
        46 011526   300000 220100                    LDX0    0,,PR3
        46 011527   001105 100003                    CMPX0   581,DU
        46 011530   011535 601000 46                 TNZ     s:23813

  23811 46 011531   300003 474500                    LDP4    3,,PR3
        46 011532   400001 235100                    LDA     1,,PR4
        46 011533   200077 755100                    STA     LOP_LEN,,AUTO
        46 011534   011543 710000 46                 TRA     s:23818

  23813 46 011535   300001 235100                    LDA     1,,PR3
        46 011536   200077 755100                    STA     LOP_LEN,,AUTO
        46 011537   011543 710000 46                 TRA     s:23818

  23815 46 011540   000001 236100                    LDQ     1,,PR0
        46 011541   007777 376007                    ANQ     4095,DL
        46 011542   200077 756100                    STQ     LOP_LEN,,AUTO

     2145    23818    4                IF P$ -> VARIABLE.TYPE = %TYB THEN

  23818 46 011543   000002 220100                    LDX0    2,,PR0
        46 011544   000014 100003                    CMPX0   12,DU
        46 011545   011553 601000 46                 TNZ     s:23821

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:429  
     2146    23819    4                  LOP_LEN = LOP_LEN * 4 / 3; /* Convert to digits */

  23819 46 011546   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 011547   000002 736000                    QLS     2
        46 011550   000003 506007                    DIV     3,DL
        46 011551   200077 756100                    STQ     LOP_LEN,,AUTO
        46 011552   011555 710000 46                 TRA     s:23823

     2147    23820    4                ELSE
     2148    23821    4                  LOP_LEN = LOP_LEN * 2;

  23821 46 011553   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 011554   200077 056100                    ASQ     LOP_LEN,,AUTO

     2149    23822    4              END;

     2150    23823    3            IF P$ -> VARIABLE.B.LINKAGE THEN

  23823 46 011555   000003 236100                    LDQ     3,,PR0
        46 011556   000002 316003                    CANQ    2,DU
        46 011557   011625 600000 46                 TZE     s:23873

     2151    23824    4              DO;

     2152    23825    4                QLT$ = P$ -> VARIABLE.QLT$;

  23825 46 011560   000007 236100                    LDQ     7,,PR0
        46 011561   000000 756000 37                 STQ     QLT$

     2153    23826    5                DO WHILE QLT$ -> QLT.LEVEL_NO > 1;

  23826 46 011562   000000 473400 37                 LDP3    QLT$
        46 011563   300000 236100                    LDQ     0,,PR3
        46 011564   000777 376007                    ANQ     511,DL
        46 011565   000002 116007                    CMPQ    2,DL
        46 011566   011577 602000 46                 TNC     s:23831

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:430  
     2154    23827    5                  QLT$ = QLT$ -> QLT.FATHER;

  23827 46 011567   000000 470400 37                 LDP0    QLT$
        46 011570   000001 236100                    LDQ     1,,PR0
        46 011571   000000 756000 37                 STQ     QLT$

     2155    23828    5                END;

  23828 46 011572   000000 470400 37                 LDP0    QLT$
        46 011573   000000 236100                    LDQ     0,,PR0
        46 011574   000777 376007                    ANQ     511,DL
        46 011575   000002 116007                    CMPQ    2,DL
        46 011576   011567 603000 46                 TRC     s:23827

     2156    23829                     %GET_LTS (@ID = %BASE_LTS, @ST$ = QLT$ -> QLT.ST$, @RETURN$ = LTS$$);

  23831 46 011577   000000 470400 37                 LDP0    QLT$
        46 011600   000004 471500                    LDP1    4,,PR0
        46 011601   100005 236100                    LDQ     5,,PR1
        46 011602   000005 116000 47                 CMPQ    5
        46 011603   011613 600000 46                 TZE     s:23865
        46 011604   100005 473500                    LDP3    5,,PR1
        46 011605   300000 220100                    LDX0    0,,PR3
        46 011606   001105 100003                    CMPX0   581,DU
        46 011607   011613 601000 46                 TNZ     s:23865

  23859 46 011610   300010 236100                    LDQ     8,,PR3
        46 011611   200255 756100                    STQ     LTS$$,,AUTO

  23863 46 011612   011625 710000 46                 TRA     s:23873

  23865 46 011613   000005 116000 47                 CMPQ    5
        46 011614   011623 600000 46                 TZE     s:23869
        46 011615   100005 473500                    LDP3    5,,PR1
        46 011616   300000 220100                    LDX0    0,,PR3
        46 011617   001066 100003                    CMPX0   566,DU
        46 011620   011623 601000 46                 TNZ     s:23869
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:431  

  23867 46 011621   200255 756100                    STQ     LTS$$,,AUTO
        46 011622   011625 710000 46                 TRA     s:23873

  23869 46 011623   000005 236000 47                 LDQ     5
        46 011624   200255 756100                    STQ     LTS$$,,AUTO

     2157    23872    4              END;

     2158    23873    4            DO I = %ARA TO %AREAQ; /* Free A, Q, X0 - 7 */

  23873 46 011625   000005 235007                    LDA     5,DL
        46 011626   200065 755100                    STA     I,,AUTO

     2159    23874    4              CALL FREE_REG_IF_NEED (P$, LOP_LEN, J, LTS$$, I);

  23874 46 011627   200065 630500                    EPPR0   I,,AUTO
        46 011630   200275 450500                    STP0    @BASE_LTS$+1,,AUTO
        46 011631   200255 631500                    EPPR1   LTS$$,,AUTO
        46 011632   200274 451500                    STP1    @ORG+1,,AUTO
        46 011633   200066 633500                    EPPR3   J,,AUTO
        46 011634   200273 453500                    STP3    @LEN+1,,AUTO
        46 011635   200077 634500                    EPPR4   LOP_LEN,,AUTO
        46 011636   200272 454500                    STP4    @OPND$+1,,AUTO
        46 011637   200064 635500                    EPPR5   P$,,AUTO
        46 011640   200271 455500                    STP5    @STRING$+1,,AUTO
        46 011641   022513 701000 46                 TSX1    FREE_REG_IF_NEED
        46 011642   000000 011000                    NOP     0

     2160    23875    4            END;

  23875 46 011643   200065 054100                    AOS     I,,AUTO
        46 011644   200065 235100                    LDA     I,,AUTO
        46 011645   000022 115007                    CMPA    18,DL
        46 011646   011627 604400 46                 TMOZ    s:23874

     2161    23876    3          END;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:432  

  23876 46 011647   021307 710000 46                 TRA     s:26924

     2162    23877
     2163    23878    2   CASE(%MPI);

     2164    23879        /*V*
     2165    23880                                              MPI
     2166    23881            Sets the greater_256K bit to prevent the result from being moved to an
     2167    23882            index register, unless the result cannot possibly be too large to fit
     2168    23883            in one.
     2169    23884        */
     2170    23885    2        IF PILL -> ETT.ROP -> ETT.ID = %TRIAD AND

  23885 46 011650   100002 473500                    LDP3    2,,PR1
        46 011651   300000 220100                    LDX0    0,,PR3
        46 011652   000015 100003                    CMPX0   13,DU
        46 011653   011724 601000 46                 TNZ     s:23897
        46 011654   100001 474500                    LDP4    1,,PR1
        46 011655   400000 221100                    LDX1    0,,PR4
        46 011656   000132 101003                    CMPX1   90,DU
        46 011657   011724 601000 46                 TNZ     s:23897
        46 011660   400001 475500                    LDP5    1,,PR4
        46 011661   500000 222100                    LDX2    0,,PR5
        46 011662   000037 102003                    CMPX2   31,DU
        46 011663   011724 601000 46                 TNZ     s:23897

     2171    23886    2            PILL -> ETT.LOP -> ETT.ID = %CVDI AND
     2172    23887    3            PILL -> ETT.LOP -> ETT.LOP -> ETT.ID = %CVDSF THEN DO;

     2173    23888    3          I = PILL -> ETT.ROP -> ETT.LOP -> CONST.CONSTI.WORD1;

  23888 46 011664   300001 476500                    LDP6    1,,PR3
        46 011665   600010 235100                    LDA     8,,PR6
        46 011666   200065 755100                    STA     I,,AUTO

     2174    23889    4          DO J = PILL -> ETT.LOP -> ETT.LOP -> ETT.DESC.NDSC.N DOWNTO 1;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:433  

  23889 46 011667   000000 471500                    LDP1    0,,PR0
        46 011670   100001 473500                    LDP3    1,,PR1
        46 011671   300001 474500                    LDP4    1,,PR3
        46 011672   400002 236100                    LDQ     2,,PR4
        46 011673   000077 376007                    ANQ     63,DL
        46 011674   200066 756100                    STQ     J,,AUTO
        46 011675   011703 710000 46                 TRA     s:23891+2

     2175    23890    4            I = I * 10;

  23890 46 011676   200065 236100                    LDQ     I,,AUTO
        46 011677   000012 402007                    MPY     10,DL
        46 011700   200065 756100                    STQ     I,,AUTO

     2176    23891    4          END;

  23891 46 011701   000001 336007                    LCQ     1,DL
        46 011702   200066 056100                    ASQ     J,,AUTO
        46 011703   200066 235100                    LDA     J,,AUTO
        46 011704   011676 605400 46                 TPNZ    s:23890

     2177    23892    3          IF PILL -> ETT.LOP -> ETT.LOP -> ETT.DESC.NDSC.S = %NO_SIGN AND

  23892 46 011705   200003 470500                    LDP0    @PILL,,AUTO
        46 011706   000000 471500                    LDP1    0,,PR0
        46 011707   100001 473500                    LDP3    1,,PR1
        46 011710   300001 474500                    LDP4    1,,PR3
        46 011711   400002 236100                    LDQ     2,,PR4
        46 011712   030000 376007                    ANQ     12288,DL
        46 011713   030000 116007                    CMPQ    12288,DL
        46 011714   011720 601000 46                 TNZ     s:23892+11
        46 011715   200065 236100                    LDQ     I,,AUTO
        46 011716   000001 116003                    CMPQ    1,DU
        46 011717   011724 605400 46                 TPNZ    s:23897
        46 011720   200065 236100                    LDQ     I,,AUTO
        46 011721   000012 116003                    CMPQ    10,DU
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:434  
        46 011722   011724 605400 46                 TPNZ    s:23897

     2178    23893    3              I > 262144 OR
     2179    23894    3             I > 2621440 THEN; /* OK */
     2180    23895    3          ELSE RETURN; /* Result can fit in index reg */

  23895 46 011723   000000 702200 xent               TSX2  ! X66_ARET

     2181    23896    3        END;
     2182    23897    2        RAT.B.GREATER_256K (PILL -> ETT.STATE) = TRUE;

  23897 46 011724   100004 220100                    LDX0    4,,PR1
        46 011725   100004 020100                    ADLX0   4,,PR1
        46 011726   000000 635010                    EAA     0,X0
        46 011727   000021 771000                    ARL     17
        46 011730   200000 236003                    LDQ     65536,DU
        46 011731   000001 256005 12                 ORSQ    RAT+1,AL
        46 011732   021307 710000 46                 TRA     s:26924

     2183    23898        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:435  
     2184    23899    2   CASE(%MPI2,%SHIFT_L);

     2185    23900
     2186    23901    2        IF PILL -> ETT.LOP -> ETT.ID = %CVDI AND

  23901 46 011733   100001 473500                    LDP3    1,,PR1
        46 011734   300000 220100                    LDX0    0,,PR3
        46 011735   000132 100003                    CMPX0   90,DU
        46 011736   011765 601000 46                 TNZ     s:23909
        46 011737   300001 474500                    LDP4    1,,PR3
        46 011740   400000 221100                    LDX1    0,,PR4
        46 011741   000037 101003                    CMPX1   31,DU
        46 011742   011765 601000 46                 TNZ     s:23909

     2187    23902    3            PILL -> ETT.LOP -> ETT.LOP -> ETT.ID = %CVDSF THEN DO;

     2188    23903    3          I = PILL -> ETT.ROPCON + PILL -> ETT.LOP -> ETT.LOP -> ETT.DESC.NDSC.N;

  23903 46 011743   400002 236100                    LDQ     2,,PR4
        46 011744   000077 376007                    ANQ     63,DL
        46 011745   100002 036100                    ADLQ    2,,PR1
        46 011746   200065 756100                    STQ     I,,AUTO

     2189    23904    3          IF PILL -> ETT.LOP -> ETT.LOP -> ETT.DESC.NDSC.S = %NO_SIGN AND

  23904 46 011747   000000 471500                    LDP1    0,,PR0
        46 011750   100001 473500                    LDP3    1,,PR1
        46 011751   300001 474500                    LDP4    1,,PR3
        46 011752   400002 236100                    LDQ     2,,PR4
        46 011753   030000 376007                    ANQ     12288,DL
        46 011754   030000 116007                    CMPQ    12288,DL
        46 011755   011761 601000 46                 TNZ     s:23904+10
        46 011756   200065 235100                    LDA     I,,AUTO
        46 011757   000005 115007                    CMPA    5,DL
        46 011760   011765 605400 46                 TPNZ    s:23909
        46 011761   200065 235100                    LDA     I,,AUTO
        46 011762   000006 115007                    CMPA    6,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:436  
        46 011763   011765 605400 46                 TPNZ    s:23909

     2190    23905    3              I > 5 OR
     2191    23906    3             I > 6 THEN; /* OK */
     2192    23907    3          ELSE RETURN; /* Result can fit in an index reg */

  23907 46 011764   000000 702200 xent               TSX2  ! X66_ARET

     2193    23908    3        END;
     2194    23909    2        RAT.B.GREATER_256K (PILL -> ETT.STATE) = TRUE;

  23909 46 011765   100004 220100                    LDX0    4,,PR1
        46 011766   100004 020100                    ADLX0   4,,PR1
        46 011767   000000 635010                    EAA     0,X0
        46 011770   000021 771000                    ARL     17
        46 011771   200000 236003                    LDQ     65536,DU
        46 011772   000001 256005 12                 ORSQ    RAT+1,AL
        46 011773   021307 710000 46                 TRA     s:26924

     2195    23910        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:437  
     2196    23911    2   CASE(%MVAN);

     2197    23912
     2198    23913    2        CALL FREE_REGISTER_CHECK (PILL);

  23913 46 011774   200003 236100                    LDQ     @PILL,,AUTO
        46 011775   200263 756100                    STQ     LOWER$+2,,AUTO
        46 011776   022152 701000 46                 TSX1    FREE_REGISTER_CHECK
        46 011777   000000 011000                    NOP     0

     2199    23914    2        IF PILL -> ILL.ROP -> ETT.REF$ = ADDR (NIL) AND

  23914 46 012000   200003 470500                    LDP0    @PILL,,AUTO
        46 012001   000000 471500                    LDP1    0,,PR0
        46 012002   100002 473500                    LDP3    2,,PR1
        46 012003   300003 236100                    LDQ     3,,PR3
        46 012004   000005 116000 47                 CMPQ    5
        46 012005   021307 601000 46                 TNZ     s:26924
        46 012006   300004 220100                    LDX0    4,,PR3
        46 012007   000005 100003                    CMPX0   5,DU
        46 012010   021307 602000 46                 TNC     s:26924

     2200    23915    2            PILL -> ILL.ROP -> ETT.STATE > %REF_T THEN
     2201    23916    2          CALL Z8HG$SAVE (PILL -> ILL.ROP);

  23916 46 012011   100002 634500                    EPPR4   2,,PR1
        46 012012   200302 454500                    STP4    ORG1+1,,AUTO
        46 012013   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 012014   000000 631400 47                 EPPR1   0
        46 012015   000000 701000 xent               TSX1    Z8HG$SAVE
        46 012016   000000 011000                    NOP     0
        46 012017   021307 710000 46                 TRA     s:26924

     2202    23917        %IF GCOS;
     2203    23918 C
     2204    23919 C           IF PILL -> ILL.ROP -> ST.ID = %SYMREF_ THEN
     2205    23920 C             PCOM.DABS = 1;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:438  
     2206    23921 C           ELSE
     2207    23922 C             PCOM.DABS = 0;
     2208    23923 C
     2209    23924 C      %EJECT;
     2210    23925        %ENDIF;
     2211    23926    2   CASE(%MVANO);

     2212    23927
     2213    23928        %EQU #2BYTES_UTOU       = 00;
     2214    23929        %EQU #2BYTES_UTOL       = 01;
     2215    23930        %EQU #2BYTES_LTOU       = 02;
     2216    23931        %EQU #2BYTES_LTOL       = 03;
     2217    23932        %EQU #4BYTES            = 04;
     2218    23933        %EQU #8BYTES_ETOE       = 05;
     2219    23934        %EQU #8BYTES_ETOO       = 06;
     2220    23935        %EQU #8BYTES_OTOE       = 07;
     2221    23936        %EQU #8BYTES_OTOO       = 08;
     2222    23937        %EQU #1BYTE_BYTE0       = 09;
     2223    23938        %EQU #1BYTE_BYTE1       = 10;
     2224    23939        %EQU #1BYTE_BYTE2       = 11;
     2225    23940        %EQU #1BYTE_BYTE3       = 12;
     2226    23941        %EQU #2BYTES_BYTES1AND2 = 13;
     2227    23942        %EQU #3BYTES_BYTES0TO2  = 14;
     2228    23943        %EQU #3BYTES_BYTES1TO3  = 15;
     2229    23944        %EQU #2BYTES_BYTES0AND1 = 16;
     2230    23945        %EQU #2BYTES_BYTES2AND3 = 17;
     2231    23946        %EQU LOP_EQ_ROP         = 36;
     2232    23947
     2233    23948    2        IF PILL -> ILL.CODE < %MVANO_BYTE_0 OR PILL -> ILL.CODE > %MVANO_BYTE_3 THEN

  23948 46 012020   100000 720100                    LXL0    0,,PR1
        46 012021   000011 100003                    CMPX0   9,DU
        46 012022   012025 602000 46                 TNC     s:23949
        46 012023   000015 100003                    CMPX0   13,DU
        46 012024   012031 602000 46                 TNC     s:23951

     2234    23949    2          CALL FREE_REGISTER_CHECK (PILL);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:439  

  23949 46 012025   200003 236100                    LDQ     @PILL,,AUTO
        46 012026   200263 756100                    STQ     LOWER$+2,,AUTO
        46 012027   022152 701000 46                 TSX1    FREE_REGISTER_CHECK
        46 012030   000000 011000                    NOP     0

     2235    23950
     2236    23951    3        DO CASE(PILL -> ILL.CODE);

  23951 46 012031   200003 470500                    LDP0    @PILL,,AUTO
        46 012032   000000 471500                    LDP1    0,,PR0
        46 012033   100000 720100                    LXL0    0,,PR1
        46 012034   000022 100003                    CMPX0   18,DU
        46 012035   012037 602010 46                 TNC     s:23951+6,X0
        46 012036   021307 710000 46                 TRA     s:26924
        46 012037   012061 710000 46                 TRA     s:23953
        46 012040   012061 710000 46                 TRA     s:23953
        46 012041   012061 710000 46                 TRA     s:23953
        46 012042   012061 710000 46                 TRA     s:23953
        46 012043   012114 710000 46                 TRA     s:23967
        46 012044   012142 710000 46                 TRA     s:23980
        46 012045   012142 710000 46                 TRA     s:23980
        46 012046   012142 710000 46                 TRA     s:23980
        46 012047   012142 710000 46                 TRA     s:23980
        46 012050   012176 710000 46                 TRA     s:23996
        46 012051   012176 710000 46                 TRA     s:23996
        46 012052   012176 710000 46                 TRA     s:23996
        46 012053   012176 710000 46                 TRA     s:23996
        46 012054   012176 710000 46                 TRA     s:23996
        46 012055   012176 710000 46                 TRA     s:23996
        46 012056   012176 710000 46                 TRA     s:23996
        46 012057   012176 710000 46                 TRA     s:23996
        46 012060   012176 710000 46                 TRA     s:23996

     2237    23952    3          CASE(%#2BYTES_UTOU,%#2BYTES_UTOL,%#2BYTES_LTOU,%#2BYTES_LTOL);

     2238    23953    3            IF PILL -> ILL.ROP -> ETT.STATE >= %XR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:440  

  23953 46 012061   100002 473500                    LDP3    2,,PR1
        46 012062   300004 221100                    LDX1    4,,PR3
        46 012063   000010 101003                    CMPX1   8,DU
        46 012064   012106 602000 46                 TNC     s:23962
        46 012065   000020 101003                    CMPX1   16,DU
        46 012066   012106 603000 46                 TRC     s:23962

     2239    23954    3            AND PILL -> ILL.ROP -> ETT.STATE <= %XR7 THEN
     2240    23955    4              DO;

     2241    23956    4                IF PILL -> ETT.LOP -> ETT.STATE = PILL -> ETT.ROP -> ETT.STATE THEN

  23956 46 012067   100001 474500                    LDP4    1,,PR1
        46 012070   400004 222100                    LDX2    4,,PR4
        46 012071   300004 102100                    CMPX2   4,,PR3
        46 012072   012077 601000 46                 TNZ     s:23959

     2242    23957    4                  PCOM.CABS = %LOP_EQ_ROP;

  23957 46 012073   000044 235007                    LDA     36,DL
        46 012074   200004 475500                    LDP5    @PCOM,,AUTO
        46 012075   500002 755100                    STA     2,,PR5
        46 012076   021307 710000 46                 TRA     s:26924

     2243    23958    4                ELSE
     2244    23959    4                  PCOM.CABS = PILL -> ILL.CODE * 2 + 1;

  23959 46 012077   100000 236100                    LDQ     0,,PR1
        46 012100   000001 736000                    QLS     1
        46 012101   000077 376000 47                 ANQ     63
        46 012102   000001 036007                    ADLQ    1,DL
        46 012103   200004 475500                    LDP5    @PCOM,,AUTO
        46 012104   500002 756100                    STQ     2,,PR5

     2245    23960    4              END;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:441  
  23960 46 012105   021307 710000 46                 TRA     s:26924

     2246    23961    3            ELSE
     2247    23962    3              PCOM.CABS = PILL -> ILL.CODE * 2;

  23962 46 012106   100000 236100                    LDQ     0,,PR1
        46 012107   000001 736000                    QLS     1
        46 012110   000077 376000 47                 ANQ     63
        46 012111   200004 474500                    LDP4    @PCOM,,AUTO
        46 012112   400002 756100                    STQ     2,,PR4
        46 012113   021307 710000 46                 TRA     s:26924

     2248    23963
     2249    23964
     2250    23965    3          CASE(%#4BYTES);

     2251    23966
     2252    23967    3            IF PILL -> ILL.ROP -> ETT.STATE = %ARA

  23967 46 012114   100002 473500                    LDP3    2,,PR1
        46 012115   300004 221100                    LDX1    4,,PR3
        46 012116   000005 101003                    CMPX1   5,DU
        46 012117   012122 600000 46                 TZE     s:23970
        46 012120   000006 101003                    CMPX1   6,DU
        46 012121   012136 601000 46                 TNZ     s:23976

     2253    23968    3            OR PILL -> ILL.ROP -> ETT.STATE = %ARQ THEN
     2254    23969    4              DO;

     2255    23970    4                IF PILL -> ETT.LOP -> ETT.STATE = PILL -> ETT.ROP -> ETT.STATE THEN

  23970 46 012122   100001 474500                    LDP4    1,,PR1
        46 012123   400004 222100                    LDX2    4,,PR4
        46 012124   300004 102100                    CMPX2   4,,PR3
        46 012125   012132 601000 46                 TNZ     s:23973

     2256    23971    4                  PCOM.CABS = %LOP_EQ_ROP;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:442  

  23971 46 012126   000044 235007                    LDA     36,DL
        46 012127   200004 475500                    LDP5    @PCOM,,AUTO
        46 012130   500002 755100                    STA     2,,PR5
        46 012131   021307 710000 46                 TRA     s:26924

     2257    23972    4                ELSE
     2258    23973    4                  PCOM.CABS = %#4BYTES * 2 + 1;

  23973 46 012132   000011 235007                    LDA     9,DL
        46 012133   200004 475500                    LDP5    @PCOM,,AUTO
        46 012134   500002 755100                    STA     2,,PR5

     2259    23974    4              END;

  23974 46 012135   021307 710000 46                 TRA     s:26924

     2260    23975    3            ELSE
     2261    23976    3              PCOM.CABS = %#4BYTES * 2;

  23976 46 012136   000010 235007                    LDA     8,DL
        46 012137   200004 474500                    LDP4    @PCOM,,AUTO
        46 012140   400002 755100                    STA     2,,PR4
        46 012141   021307 710000 46                 TRA     s:26924

     2262    23977
     2263    23978    3          CASE(%#8BYTES_ETOE,%#8BYTES_ETOO,%#8BYTES_OTOE,%#8BYTES_OTOO);

     2264    23979
     2265    23980    3            IF PILL -> ILL.ROP -> ETT.STATE = %ARAQ THEN

  23980 46 012142   100002 473500                    LDP3    2,,PR1
        46 012143   300004 221100                    LDX1    4,,PR3
        46 012144   000007 101003                    CMPX1   7,DU
        46 012145   012165 601000 46                 TNZ     s:23988

     2266    23981    4              DO;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:443  

     2267    23982    4                IF PILL -> ETT.LOP -> ETT.STATE = PILL -> ETT.ROP -> ETT.STATE THEN

  23982 46 012146   100001 474500                    LDP4    1,,PR1
        46 012147   400004 222100                    LDX2    4,,PR4
        46 012150   300004 102100                    CMPX2   4,,PR3
        46 012151   012156 601000 46                 TNZ     s:23985

     2268    23983    4                  PCOM.CABS = %LOP_EQ_ROP;

  23983 46 012152   000044 235007                    LDA     36,DL
        46 012153   200004 475500                    LDP5    @PCOM,,AUTO
        46 012154   500002 755100                    STA     2,,PR5
        46 012155   012172 710000 46                 TRA     s:23990

     2269    23984    4                ELSE
     2270    23985    4                  PCOM.CABS = PILL -> ILL.CODE * 2 + 1;

  23985 46 012156   100000 236100                    LDQ     0,,PR1
        46 012157   000001 736000                    QLS     1
        46 012160   000077 376000 47                 ANQ     63
        46 012161   000001 036007                    ADLQ    1,DL
        46 012162   200004 475500                    LDP5    @PCOM,,AUTO
        46 012163   500002 756100                    STQ     2,,PR5

     2271    23986    4              END;

  23986 46 012164   012172 710000 46                 TRA     s:23990

     2272    23987    3            ELSE
     2273    23988    3              PCOM.CABS = PILL -> ILL.CODE * 2;

  23988 46 012165   100000 236100                    LDQ     0,,PR1
        46 012166   000001 736000                    QLS     1
        46 012167   000077 376000 47                 ANQ     63
        46 012170   200004 474500                    LDP4    @PCOM,,AUTO
        46 012171   400002 756100                    STQ     2,,PR4
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:444  

     2274    23989
     2275    23990    3            PCOM.OABS = 1;

  23990 46 012172   000001 235007                    LDA     1,DL
        46 012173   200004 471500                    LDP1    @PCOM,,AUTO
        46 012174   100016 755100                    STA     14,,PR1
        46 012175   021307 710000 46                 TRA     s:26924

     2276    23991
     2277    23992    3          CASE(%#1BYTE_BYTE0,%#1BYTE_BYTE1,%#1BYTE_BYTE2,

     2278    23993    3               %#1BYTE_BYTE3,%#2BYTES_BYTES1AND2,%#3BYTES_BYTES0TO2,
     2279    23994    3               %#3BYTES_BYTES1TO3,%#2BYTES_BYTES0AND1,%#2BYTES_BYTES2AND3);
     2280    23995
     2281    23996    3            IF PILL -> ILL.ROP -> ETT.STATE = %ARA

  23996 46 012176   100002 473500                    LDP3    2,,PR1
        46 012177   300004 221100                    LDX1    4,,PR3
        46 012200   000005 101003                    CMPX1   5,DU
        46 012201   012204 600000 46                 TZE     s:23999
        46 012202   000006 101003                    CMPX1   6,DU
        46 012203   012223 601000 46                 TNZ     s:24005

     2282    23997    3            OR PILL -> ILL.ROP -> ETT.STATE = %ARQ THEN
     2283    23998    4              DO;

     2284    23999    4                IF PILL -> ETT.LOP -> ETT.STATE = PILL -> ETT.ROP -> ETT.STATE THEN

  23999 46 012204   100001 474500                    LDP4    1,,PR1
        46 012205   400004 222100                    LDX2    4,,PR4
        46 012206   300004 102100                    CMPX2   4,,PR3
        46 012207   012214 601000 46                 TNZ     s:24002

     2285    24000    4                  PCOM.CABS = %LOP_EQ_ROP;

  24000 46 012210   000044 235007                    LDA     36,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:445  
        46 012211   200004 475500                    LDP5    @PCOM,,AUTO
        46 012212   500002 755100                    STA     2,,PR5
        46 012213   012230 710000 46                 TRA     s:24007

     2286    24001    4                ELSE
     2287    24002    4                  PCOM.CABS = PILL -> ILL.CODE * 2 + 1;

  24002 46 012214   100000 236100                    LDQ     0,,PR1
        46 012215   000001 736000                    QLS     1
        46 012216   000077 376000 47                 ANQ     63
        46 012217   000001 036007                    ADLQ    1,DL
        46 012220   200004 475500                    LDP5    @PCOM,,AUTO
        46 012221   500002 756100                    STQ     2,,PR5

     2288    24003    4              END;

  24003 46 012222   012230 710000 46                 TRA     s:24007

     2289    24004    3            ELSE
     2290    24005    3              PCOM.CABS = PILL -> ILL.CODE * 2;

  24005 46 012223   100000 236100                    LDQ     0,,PR1
        46 012224   000001 736000                    QLS     1
        46 012225   000077 376000 47                 ANQ     63
        46 012226   200004 474500                    LDP4    @PCOM,,AUTO
        46 012227   400002 756100                    STQ     2,,PR4

     2291    24006
     2292    24007    3            PCOM.TABS = TAGS(PILL -> ILL.CODE - 9);

  24007 46 012230   000000 471500                    LDP1    0,,PR0
        46 012231   100000 720100                    LXL0    0,,PR1
        46 012232   200004 473500                    LDP3    @PCOM,,AUTO
        46 012233   777767 235010 44                 LDA     NIL_EPTR-20,X0
        46 012234   300023 755100                    STA     19,,PR3

     2293    24008
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:446  
     2294    24009    3        END /* Case */;

  24009 46 012235   021307 710000 46                 TRA     s:26924

     2295    24010        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:447  
     2296    24011    2   CASE(%MVDD,%MVDDR);

     2297    24012
     2298    24013    2        CALL FREE_REGISTER_CHECK (PILL);

  24013 46 012236   200003 236100                    LDQ     @PILL,,AUTO
        46 012237   200263 756100                    STQ     LOWER$+2,,AUTO
        46 012240   022152 701000 46                 TSX1    FREE_REGISTER_CHECK
        46 012241   000000 011000                    NOP     0

     2299    24014
     2300    24015    2        IF PILL -> ETT.ROP -> ETT.REF$ -> REF.SIZ_TAG$ ~= ADDR (NIL)

  24015 46 012242   200003 470500                    LDP0    @PILL,,AUTO
        46 012243   000000 471500                    LDP1    0,,PR0
        46 012244   100002 473500                    LDP3    2,,PR1
        46 012245   300003 474500                    LDP4    3,,PR3
        46 012246   400003 236100                    LDQ     3,,PR4
        46 012247   000005 116000 47                 CMPQ    5
        46 012250   012305 600000 46                 TZE     s:24030
        46 012251   400003 475500                    LDP5    3,,PR4
        46 012252   500000 220100                    LDX0    0,,PR5
        46 012253   000015 100003                    CMPX0   13,DU
        46 012254   012305 600000 46                 TZE     s:24030

     2301    24016    2            AND PILL -> ETT.ROP -> ETT.REF$ -> REF.SIZ_TAG$ -> ETT.ID ~= %TRIAD THEN
     2302    24017    3          DO;

     2303    24018    3            PCOM.LABS = 1;        /* Variable-length sending operand */

  24018 46 012255   000001 235007                    LDA     1,DL
        46 012256   200004 476500                    LDP6    @PCOM,,AUTO
        46 012257   600013 755100                    STA     11,,PR6

     2304    24019    3            PCOM.ROPND = PILL -> ETT.ROP -> ETT.REF$ -> REF.SIZ_TAG$;

  24019 46 012260   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:448  
        46 012261   100002 473500                    LDP3    2,,PR1
        46 012262   300003 474500                    LDP4    3,,PR3
        46 012263   400003 236100                    LDQ     3,,PR4
        46 012264   600053 756100                    STQ     43,,PR6

     2305    24020    4            DO CASE (PCOM.ROPND -> ETT.STATE);

  24020 46 012265   600053 471500                    LDP1    43,,PR6
        46 012266   100004 236100                    LDQ     4,,PR1
        46 012267   000022 772000                    QRL     18
        46 012270   000005 136007                    SBLQ    5,DL
        46 012271   000002 116007                    CMPQ    2,DL
        46 012272   012274 602006 46                 TNC     s:24020+7,QL
        46 012273   012302 710000 46                 TRA     s:24026
        46 012274   012276 710000 46                 TRA     s:24022
        46 012275   012300 710000 46                 TRA     s:24024

     2306    24021    4              CASE (%ARA);

     2307    24022    4                PCOM.XABS = 0;

  24022 46 012276   600027 450100                    STZ     23,,PR6
        46 012277   021307 710000 46                 TRA     s:26924

     2308    24023    4              CASE (%ARQ);

     2309    24024    4                PCOM.XABS = 1;

  24024 46 012300   600027 755100                    STA     23,,PR6
        46 012301   021307 710000 46                 TRA     s:26924

     2310    24025    4              CASE (ELSE); /* X register */

     2311    24026    4                PCOM.XABS = 2;

  24026 46 012302   000002 235007                    LDA     2,DL
        46 012303   600027 755100                    STA     23,,PR6
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:449  

     2312    24027    4            END; /* CASE */

     2313    24028    3          END;

  24028 46 012304   021307 710000 46                 TRA     s:26924

     2314    24029    2        ELSE
     2315    24030    2          PCOM.LABS = 0; /* Fixed-length sending operand */

  24030 46 012305   200004 475500                    LDP5    @PCOM,,AUTO
        46 012306   500013 450100                    STZ     11,,PR5
        46 012307   021307 710000 46                 TRA     s:26924

     2316    24031        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:450  
     2317    24032    2   CASE(%MVDO,%MVDOR);

     2318    24033
     2319    24034    2        CALL FREE_REGISTER_CHECK (PILL);

  24034 46 012310   200003 236100                    LDQ     @PILL,,AUTO
        46 012311   200263 756100                    STQ     LOWER$+2,,AUTO
        46 012312   022152 701000 46                 TSX1    FREE_REGISTER_CHECK
        46 012313   000000 011000                    NOP     0

     2320    24035
     2321    24036    2        IF PILL -> ETT.ROP -> ETT.REF$ -> REF.SIZ_TAG$ ~= ADDR (NIL)

  24036 46 012314   200003 470500                    LDP0    @PILL,,AUTO
        46 012315   000000 471500                    LDP1    0,,PR0
        46 012316   100002 473500                    LDP3    2,,PR1
        46 012317   300003 474500                    LDP4    3,,PR3
        46 012320   400003 236100                    LDQ     3,,PR4
        46 012321   000005 116000 47                 CMPQ    5
        46 012322   012357 600000 46                 TZE     s:24051
        46 012323   400003 475500                    LDP5    3,,PR4
        46 012324   500000 220100                    LDX0    0,,PR5
        46 012325   000015 100003                    CMPX0   13,DU
        46 012326   012357 600000 46                 TZE     s:24051

     2322    24037    2            AND PILL -> ETT.ROP -> ETT.REF$ -> REF.SIZ_TAG$ -> ETT.ID ~= %TRIAD THEN
     2323    24038    3          DO;

     2324    24039    3            PCOM.LABS = 1;        /* Variable-length sending operand */

  24039 46 012327   000001 235007                    LDA     1,DL
        46 012330   200004 476500                    LDP6    @PCOM,,AUTO
        46 012331   600013 755100                    STA     11,,PR6

     2325    24040    3            PCOM.ROPND = PILL -> ETT.ROP -> ETT.REF$ -> REF.SIZ_TAG$;

  24040 46 012332   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:451  
        46 012333   100002 473500                    LDP3    2,,PR1
        46 012334   300003 474500                    LDP4    3,,PR3
        46 012335   400003 236100                    LDQ     3,,PR4
        46 012336   600053 756100                    STQ     43,,PR6

     2326    24041    4            DO CASE (PCOM.ROPND -> ETT.STATE);

  24041 46 012337   600053 471500                    LDP1    43,,PR6
        46 012340   100004 236100                    LDQ     4,,PR1
        46 012341   000022 772000                    QRL     18
        46 012342   000005 136007                    SBLQ    5,DL
        46 012343   000002 116007                    CMPQ    2,DL
        46 012344   012346 602006 46                 TNC     s:24041+7,QL
        46 012345   012354 710000 46                 TRA     s:24047
        46 012346   012350 710000 46                 TRA     s:24043
        46 012347   012352 710000 46                 TRA     s:24045

     2327    24042    4              CASE (%ARA);

     2328    24043    4                PCOM.XABS = 0;

  24043 46 012350   600027 450100                    STZ     23,,PR6
        46 012351   012361 710000 46                 TRA     s:24053

     2329    24044    4              CASE (%ARQ);

     2330    24045    4                PCOM.XABS = 1;

  24045 46 012352   600027 755100                    STA     23,,PR6
        46 012353   012361 710000 46                 TRA     s:24053

     2331    24046    4              CASE (ELSE); /* X register */

     2332    24047    4                PCOM.XABS = 2;

  24047 46 012354   000002 235007                    LDA     2,DL
        46 012355   600027 755100                    STA     23,,PR6
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:452  

     2333    24048    4            END; /* CASE */

     2334    24049    3          END;

  24049 46 012356   012361 710000 46                 TRA     s:24053

     2335    24050    2        ELSE
     2336    24051    2          PCOM.LABS = 0; /* Fixed-length sending operand */

  24051 46 012357   200004 475500                    LDP5    @PCOM,,AUTO
        46 012360   500013 450100                    STZ     11,,PR5

     2337    24052
     2338    24053    3        DO CASE (PILL -> ETT.ID);

  24053 46 012361   000000 471500                    LDP1    0,,PR0
        46 012362   100000 236100                    LDQ     0,,PR1
        46 012363   000022 772000                    QRL     18
        46 012364   000263 136007                    SBLQ    179,DL
        46 012365   000134 116007                    CMPQ    92,DL
        46 012366   012370 602006 46                 TNC     s:24053+7,QL
        46 012367   012532 710000 46                 TRA     s:24062
        46 012370   012524 710000 46                 TRA     s:24056
        46 012371   012532 710000 46                 TRA     s:24062
        46 012372   012532 710000 46                 TRA     s:24062
        46 012373   012532 710000 46                 TRA     s:24062
        46 012374   012532 710000 46                 TRA     s:24062
        46 012375   012532 710000 46                 TRA     s:24062
        46 012376   012532 710000 46                 TRA     s:24062
        46 012377   012532 710000 46                 TRA     s:24062
        46 012400   012532 710000 46                 TRA     s:24062
        46 012401   012532 710000 46                 TRA     s:24062
        46 012402   012532 710000 46                 TRA     s:24062
        46 012403   012532 710000 46                 TRA     s:24062
        46 012404   012532 710000 46                 TRA     s:24062
        46 012405   012532 710000 46                 TRA     s:24062
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:453  
        46 012406   012532 710000 46                 TRA     s:24062
        46 012407   012532 710000 46                 TRA     s:24062
        46 012410   012532 710000 46                 TRA     s:24062
        46 012411   012532 710000 46                 TRA     s:24062
        46 012412   012532 710000 46                 TRA     s:24062
        46 012413   012532 710000 46                 TRA     s:24062
        46 012414   012532 710000 46                 TRA     s:24062
        46 012415   012532 710000 46                 TRA     s:24062
        46 012416   012532 710000 46                 TRA     s:24062
        46 012417   012532 710000 46                 TRA     s:24062
        46 012420   012532 710000 46                 TRA     s:24062
        46 012421   012532 710000 46                 TRA     s:24062
        46 012422   012532 710000 46                 TRA     s:24062
        46 012423   012532 710000 46                 TRA     s:24062
        46 012424   012532 710000 46                 TRA     s:24062
        46 012425   012532 710000 46                 TRA     s:24062
        46 012426   012532 710000 46                 TRA     s:24062
        46 012427   012532 710000 46                 TRA     s:24062
        46 012430   012532 710000 46                 TRA     s:24062
        46 012431   012532 710000 46                 TRA     s:24062
        46 012432   012532 710000 46                 TRA     s:24062
        46 012433   012532 710000 46                 TRA     s:24062
        46 012434   012532 710000 46                 TRA     s:24062
        46 012435   012532 710000 46                 TRA     s:24062
        46 012436   012532 710000 46                 TRA     s:24062
        46 012437   012532 710000 46                 TRA     s:24062
        46 012440   012532 710000 46                 TRA     s:24062
        46 012441   012532 710000 46                 TRA     s:24062
        46 012442   012532 710000 46                 TRA     s:24062
        46 012443   012532 710000 46                 TRA     s:24062
        46 012444   012532 710000 46                 TRA     s:24062
        46 012445   012532 710000 46                 TRA     s:24062
        46 012446   012532 710000 46                 TRA     s:24062
        46 012447   012532 710000 46                 TRA     s:24062
        46 012450   012532 710000 46                 TRA     s:24062
        46 012451   012532 710000 46                 TRA     s:24062
        46 012452   012532 710000 46                 TRA     s:24062
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:454  
        46 012453   012532 710000 46                 TRA     s:24062
        46 012454   012532 710000 46                 TRA     s:24062
        46 012455   012532 710000 46                 TRA     s:24062
        46 012456   012532 710000 46                 TRA     s:24062
        46 012457   012532 710000 46                 TRA     s:24062
        46 012460   012532 710000 46                 TRA     s:24062
        46 012461   012532 710000 46                 TRA     s:24062
        46 012462   012532 710000 46                 TRA     s:24062
        46 012463   012532 710000 46                 TRA     s:24062
        46 012464   012532 710000 46                 TRA     s:24062
        46 012465   012532 710000 46                 TRA     s:24062
        46 012466   012532 710000 46                 TRA     s:24062
        46 012467   012532 710000 46                 TRA     s:24062
        46 012470   012532 710000 46                 TRA     s:24062
        46 012471   012532 710000 46                 TRA     s:24062
        46 012472   012532 710000 46                 TRA     s:24062
        46 012473   012532 710000 46                 TRA     s:24062
        46 012474   012532 710000 46                 TRA     s:24062
        46 012475   012532 710000 46                 TRA     s:24062
        46 012476   012532 710000 46                 TRA     s:24062
        46 012477   012532 710000 46                 TRA     s:24062
        46 012500   012532 710000 46                 TRA     s:24062
        46 012501   012532 710000 46                 TRA     s:24062
        46 012502   012532 710000 46                 TRA     s:24062
        46 012503   012532 710000 46                 TRA     s:24062
        46 012504   012532 710000 46                 TRA     s:24062
        46 012505   012532 710000 46                 TRA     s:24062
        46 012506   012532 710000 46                 TRA     s:24062
        46 012507   012532 710000 46                 TRA     s:24062
        46 012510   012532 710000 46                 TRA     s:24062
        46 012511   012532 710000 46                 TRA     s:24062
        46 012512   012532 710000 46                 TRA     s:24062
        46 012513   012532 710000 46                 TRA     s:24062
        46 012514   012532 710000 46                 TRA     s:24062
        46 012515   012532 710000 46                 TRA     s:24062
        46 012516   012532 710000 46                 TRA     s:24062
        46 012517   012532 710000 46                 TRA     s:24062
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:455  
        46 012520   012532 710000 46                 TRA     s:24062
        46 012521   012532 710000 46                 TRA     s:24062
        46 012522   012532 710000 46                 TRA     s:24062
        46 012523   012527 710000 46                 TRA     s:24059

     2339    24054
     2340    24055    3           CASE(%MVDO);

     2341    24056    3               PCOM.ZABS = 0;

  24056 46 012524   200004 473500                    LDP3    @PCOM,,AUTO
        46 012525   300031 450100                    STZ     25,,PR3
        46 012526   012532 710000 46                 TRA     s:24062

     2342    24057
     2343    24058    3           CASE(%MVDOR);

     2344    24059    3               PCOM.ZABS = 1;

  24059 46 012527   000001 235007                    LDA     1,DL
        46 012530   200004 473500                    LDP3    @PCOM,,AUTO
        46 012531   300031 755100                    STA     25,,PR3

     2345    24060    3        END;

     2346    24061
     2347    24062    2        LOP_REF$ = PILL -> ETT.LOP -> ETT.REF$;

  24062 46 012532   000000 471500                    LDP1    0,,PR0
        46 012533   100001 473500                    LDP3    1,,PR1
        46 012534   300003 236100                    LDQ     3,,PR3
        46 012535   200101 756100                    STQ     LOP_REF$,,AUTO

     2348    24063    2        TYPE_DESC.SIZ$ = ADDR(NIL);

  24063 46 012536   000005 236000 47                 LDQ     5
        46 012537   200112 756100                    STQ     TYPE_DESC+2,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:456  

     2349    24064    2        TYPE_DESC.SSOP$ = ADDR(NIL);

  24064 46 012540   200113 756100                    STQ     TYPE_DESC+3,,AUTO

     2350    24065    2        IF LOP_REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYF THEN

  24065 46 012541   200101 471500                    LDP1    LOP_REF$,,AUTO
        46 012542   100005 473500                    LDP3    5,,PR1
        46 012543   300002 220100                    LDX0    2,,PR3
        46 012544   000013 100003                    CMPX0   11,DU
        46 012545   012561 601000 46                 TNZ     s:24072

     2351    24066    3          DO;

     2352    24067    3            IF LOP_REF$ -> REF.NDSC.S = %NO_SIGN

  24067 46 012546   100001 236100                    LDQ     1,,PR1
        46 012547   030000 376007                    ANQ     12288,DL
        46 012550   030000 116007                    CMPQ    12288,DL
        46 012551   012556 601000 46                 TNZ     s:24069

     2353    24068    3              THEN PCOM.IABS = 2;

  24068 46 012552   000002 235007                    LDA     2,DL
        46 012553   200004 474500                    LDP4    @PCOM,,AUTO
        46 012554   400010 755100                    STA     8,,PR4
        46 012555   012564 710000 46                 TRA     s:24074

     2354    24069    3              ELSE PCOM.IABS = 0;

  24069 46 012556   200004 474500                    LDP4    @PCOM,,AUTO
        46 012557   400010 450100                    STZ     8,,PR4

     2355    24070    3          END;

  24070 46 012560   012564 710000 46                 TRA     s:24074
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:457  

     2356    24071    2        ELSE
     2357    24072    2          PCOM.IABS = 1;

  24072 46 012561   000001 235007                    LDA     1,DL
        46 012562   200004 474500                    LDP4    @PCOM,,AUTO
        46 012563   400010 755100                    STA     8,,PR4

     2358    24073
     2359    24074    2        IF COMCOM.OB.ELS   THEN

  24074 46 012564   000026 234000 xsym               SZN     COMCOM+22
        46 012565   012725 605000 46                 TPL     s:24159

     2360    24075    3          DO;

     2361    24076    3            ROP_REF$ = PILL -> ETT.ROP -> ETT.REF$;

  24076 46 012566   000000 473500                    LDP3    0,,PR0
        46 012567   300002 475500                    LDP5    2,,PR3
        46 012570   500003 236100                    LDQ     3,,PR5
        46 012571   200102 756100                    STQ     ROP_REF$,,AUTO

     2362    24077    3            ROP_SIGN = ROP_REF$ -> REF.NDSC.S;

  24077 46 012572   200102 476500                    LDP6    ROP_REF$,,AUTO
        46 012573   600001 236100                    LDQ     1,,PR6
        46 012574   000026 736000                    QLS     22
        46 012575   600000 376003                    ANQ     -65536,DU
        46 012576   200131 756100                    STQ     ROP_SIGN,,AUTO

     2363    24078    3            TN = ROP_REF$ -> REF.NDSC.TN;

  24078 46 012577   600001 236100                    LDQ     1,,PR6
        46 012600   000025 736000                    QLS     21
        46 012601   400000 376003                    ANQ     -131072,DU
        46 012602   200045 756100                    STQ     TN,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:458  

     2364    24079
     2365    24080    3            IF ROP_SIGN ~= %NO_SIGN AND TN = %NDSC9 AND PCOM.IABS ~= 1 THEN

  24080 46 012603   200131 236100                    LDQ     ROP_SIGN,,AUTO
        46 012604   600000 376003                    ANQ     -65536,DU
        46 012605   600000 116003                    CMPQ    -65536,DU
        46 012606   012723 600000 46                 TZE     s:24153
        46 012607   200045 234100                    SZN     TN,,AUTO
        46 012610   012723 604000 46                 TMI     s:24153
        46 012611   400010 235100                    LDA     8,,PR4
        46 012612   000001 115007                    CMPA    1,DL
        46 012613   012723 600000 46                 TZE     s:24153

     2366    24081    4              DO;    /* We need to first do an MVN then the

     2367    24082                             MVNX because MVNX does not handle signed
     2368    24083                             ASCII to EBCDIC moves.  We need a temp to hold the
     2369    24084                             results of the MVN. */
     2370    24085    4                SCALE = ROP_REF$ -> REF.NDSC.SF;

  24085 46 012614   600001 236100                    LDQ     1,,PR6
        46 012615   000030 736000                    QLS     24
        46 012616   000036 732000                    QRS     30
        46 012617   200047 756100                    STQ     SCALE,,AUTO

     2371    24086    4                PCOM.EABS = 1;

  24086 46 012620   000001 235007                    LDA     1,DL
        46 012621   400004 755100                    STA     4,,PR4

     2372    24087    4                ROP_LEN = ROP_REF$ -> REF.NDSC.N;

  24087 46 012622   600001 236100                    LDQ     1,,PR6
        46 012623   000077 376007                    ANQ     63,DL
        46 012624   200100 756100                    STQ     ROP_LEN,,AUTO

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:459  
     2373    24088    4                TN = %NDSC4;

  24088 46 012625   400000 236003                    LDQ     -131072,DU
        46 012626   200045 756100                    STQ     TN,,AUTO

     2374    24089    4                TYPE_DESC.TYPE = %TYD;

  24089 46 012627   200110 450100                    STZ     TYPE_DESC,,AUTO

     2375    24090    4                BOUNDS = %NEXT;

  24090 46 012630   200125 450100                    STZ     BOUNDS,,AUTO

     2376    24091
     2377    24092                     %PACK_NDSC(@DESC = TYPE_DESC.DESC,
     2378    24093                                @LENGTH = ROP_LEN,
     2379    24094                                @TN = TN,
     2380    24095                                @SCALE = SCALE,
     2381    24096                                @SIGN = ROP_SIGN);

  24101 46 012631   000000 220003                    LDX0    0,DU
        46 012632   200111 740100                    STX0    TYPE_DESC+1,,AUTO

  24102 46 012633   000027 236000 47                 LDQ     23
        46 012634   200111 356100                    ANSQ    TYPE_DESC+1,,AUTO

  24103 46 012635   200045 236100                    LDQ     TN,,AUTO
        46 012636   000025 772000                    QRL     21
        46 012637   200111 676100                    ERQ     TYPE_DESC+1,,AUTO
        46 012640   040000 376007                    ANQ     16384,DL
        46 012641   200111 656100                    ERSQ    TYPE_DESC+1,,AUTO

  24104 46 012642   200131 236100                    LDQ     ROP_SIGN,,AUTO
        46 012643   000026 772000                    QRL     22
        46 012644   200111 676100                    ERQ     TYPE_DESC+1,,AUTO
        46 012645   030000 376007                    ANQ     12288,DL
        46 012646   200111 656100                    ERSQ    TYPE_DESC+1,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:460  

  24105 46 012647   200047 236100                    LDQ     SCALE,,AUTO
        46 012650   000006 736000                    QLS     6
        46 012651   200111 752102                    STCQ    TYPE_DESC+1,'02'O,AUTO

  24106 46 012652   200131 236100                    LDQ     ROP_SIGN,,AUTO
        46 012653   000042 772000                    QRL     34
        46 012654   000004 116007                    CMPQ    4,DL
        46 012655   012657 602006 46                 TNC     s:24106+5,QL
        46 012656   012703 710000 46                 TRA     s:24146
        46 012657   012672 710000 46                 TRA     s:24132
        46 012660   012666 710000 46                 TRA     s:24113
        46 012661   012666 710000 46                 TRA     s:24113
        46 012662   012663 710000 46                 TRA     s:24108

  24108 46 012663   200100 236100                    LDQ     ROP_LEN,,AUTO
        46 012664   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO
        46 012665   012703 710000 46                 TRA     s:24146

  24113 46 012666   200100 236100                    LDQ     ROP_LEN,,AUTO
        46 012667   000001 036007                    ADLQ    1,DL
        46 012670   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO
        46 012671   012703 710000 46                 TRA     s:24146

  24132 46 012672   200045 234100                    SZN     TN,,AUTO
        46 012673   012700 605000 46                 TPL     s:24135

  24133 46 012674   200100 236100                    LDQ     ROP_LEN,,AUTO
        46 012675   000003 036007                    ADLQ    3,DL
        46 012676   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO
        46 012677   012703 710000 46                 TRA     s:24146

  24135 46 012700   200100 236100                    LDQ     ROP_LEN,,AUTO
        46 012701   000002 036007                    ADLQ    2,DL
        46 012702   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO

     2382    24145
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:461  
     2383    24146    4                CALL Z8HU$ALLOT_TEMP(%N          ,/* FORMAT     */

  24146 46 012703   000026 236000 47                 LDQ     22
        46 012704   200305 756100                    STQ     ORG1+4,,AUTO
        46 012705   200110 633500                    EPPR3   TYPE_DESC,,AUTO
        46 012706   200304 453500                    STP3    ORG1+3,,AUTO
        46 012707   200125 635500                    EPPR5   BOUNDS,,AUTO
        46 012710   200303 455500                    STP5    ORG1+2,,AUTO
        46 012711   000016 236000 47                 LDQ     14
        46 012712   200302 756100                    STQ     ORG1+1,,AUTO
        46 012713   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 012714   000025 631400 47                 EPPR1   21
        46 012715   000000 701000 xent               TSX1    Z8HU$ALLOT_TEMP
        46 012716   000000 011000                    NOP     0

     2384    24147    4                                     BOUNDS      ,/* BOUNDARY   */
     2385    24148    4                                     TYPE_DESC   ,/* DESCRIPTOR */
     2386    24149    4                                     %STALE     );/* FRESHNESS  */
     2387    24150    4                PCOM.EOPND = ETT$;

  24150 46 012717   000000 236000 5                  LDQ     ETT$
        46 012720   200004 470500                    LDP0    @PCOM,,AUTO
        46 012721   000036 756100                    STQ     30,,PR0

     2388    24151    4              END;

  24151 46 012722   021307 710000 46                 TRA     s:26924

     2389    24152    3            ELSE
     2390    24153    3              PCOM.EABS = 0;

  24153 46 012723   400004 450100                    STZ     4,,PR4

     2391    24154    3          END;

  24154 46 012724   021307 710000 46                 TRA     s:26924

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:462  
     2392    24155    2        ELSE
     2393    24156    3          DO;

     2394    24157
     2395    24158             /*   A %MVDOR should never be generated unless the ELS option is specified. */
     2396    24159    3            IF PILL -> ETT.ID = %MVDOR      THEN

  24159 46 012725   000000 473500                    LDP3    0,,PR0
        46 012726   300000 220100                    LDX0    0,,PR3
        46 012727   000416 100003                    CMPX0   270,DU
        46 012730   012735 601000 46                 TNZ     s:24163

     2397    24160    3                CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);

  24160 46 012731   000061 630400 47                 EPPR0   49
        46 012732   000000 631400 47                 EPPR1   0
        46 012733   000000 701000 xent               TSX1    Z8AE$ERROR
        46 012734   000000 011000                    NOP     0

     2398    24161
     2399    24162
     2400    24163    3            LOP_LEN = LOP_REF$ -> REF.NDSC.N;

  24163 46 012735   200101 470500                    LDP0    LOP_REF$,,AUTO
        46 012736   000001 236100                    LDQ     1,,PR0
        46 012737   000077 376007                    ANQ     63,DL
        46 012740   200077 756100                    STQ     LOP_LEN,,AUTO

     2401    24164    3            SCALE = LOP_REF$ -> REF.NDSC.SF;

  24164 46 012741   000001 236100                    LDQ     1,,PR0
        46 012742   000030 736000                    QLS     24
        46 012743   000036 732000                    QRS     30
        46 012744   200047 756100                    STQ     SCALE,,AUTO

     2402    24165    3            LOP_SIGN = LOP_REF$ -> REF.NDSC.S;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:463  
  24165 46 012745   000001 236100                    LDQ     1,,PR0
        46 012746   000026 736000                    QLS     22
        46 012747   600000 376003                    ANQ     -65536,DU
        46 012750   200130 756100                    STQ     LOP_SIGN,,AUTO

     2403    24166
     2404    24167    3            IF LOP_SIGN = %LEADING_SIGN THEN

  24167 46 012751   200130 236100                    LDQ     LOP_SIGN,,AUTO
        46 012752   600000 376003                    ANQ     -65536,DU
        46 012753   200000 116003                    CMPQ    65536,DU
        46 012754   012771 601000 46                 TNZ     s:24177

     2405    24168    4              DO;

     2406    24169    4                PCOM.TABS = 0; /* Flag, leading sign */

  24169 46 012755   200004 471500                    LDP1    @PCOM,,AUTO
        46 012756   100023 450100                    STZ     19,,PR1

     2407    24170    4                WORDS_FOR_TEMP = ((LOP_LEN + 14) / 8);

  24170 46 012757   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 012760   000016 036007                    ADLQ    14,DL
        46 012761   000010 506007                    DIV     8,DL
        46 012762   200123 756100                    STQ     WORDS_FOR_TEMP,,AUTO

     2408    24171    4                BOUNDS = %EVEN;

  24171 46 012763   000002 235007                    LDA     2,DL
        46 012764   200125 755100                    STA     BOUNDS,,AUTO

     2409    24172    4               LDAQ_OFFSET = 0; /* Word offset to doubleword with sign, first digit */

  24172 46 012765   200126 450100                    STZ     LDAQ_OFFSET,,AUTO

     2410    24173    4                MVN_OFFSET  = 7; /* Digit offset to sign */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:464  

  24173 46 012766   000007 235007                    LDA     7,DL
        46 012767   200127 755100                    STA     MVN_OFFSET,,AUTO

     2411    24174    4              END;

  24174 46 012770   013022 710000 46                 TRA     s:24189

     2412    24175    3            ELSE
     2413    24176    4              DO;

     2414    24177    4                PCOM.TABS = 1; /* Flag, trailing sign */

  24177 46 012771   000001 235007                    LDA     1,DL
        46 012772   200004 471500                    LDP1    @PCOM,,AUTO
        46 012773   100023 755100                    STA     19,,PR1

     2415    24178    4                WORDS_FOR_TEMP = ((LOP_LEN + 15) / 8);

  24178 46 012774   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 012775   000017 036007                    ADLQ    15,DL
        46 012776   000010 506007                    DIV     8,DL
        46 012777   200123 756100                    STQ     WORDS_FOR_TEMP,,AUTO

     2416    24179
     2417    24180    4                IF MOD(WORDS_FOR_TEMP,2) = 0 THEN

  24180 46 013000   000002 506007                    DIV     2,DL
        46 013001   000044 733000                    LRS     36
        46 013002   000000 116003                    CMPQ    0,DU
        46 013003   013007 601000 46                 TNZ     s:24183

     2418    24181    4                  BOUNDS = %EVEN;

  24181 46 013004   000002 235007                    LDA     2,DL
        46 013005   200125 755100                    STA     BOUNDS,,AUTO
        46 013006   013011 710000 46                 TRA     s:24185
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:465  

     2419    24182    4                ELSE
     2420    24183    4                  BOUNDS = %ODD;

  24183 46 013007   000001 235007                    LDA     1,DL
        46 013010   200125 755100                    STA     BOUNDS,,AUTO

     2421    24184
     2422    24185    4                LDAQ_OFFSET = WORDS_FOR_TEMP - 2;
             24185                         /* Word offset to doubleword with last digit, sign */

  24185 46 013011   200123 236100                    LDQ     WORDS_FOR_TEMP,,AUTO
        46 013012   000002 136007                    SBLQ    2,DL
        46 013013   200126 756100                    STQ     LDAQ_OFFSET,,AUTO

     2423    24186    4                MVN_OFFSET = (((WORDS_FOR_TEMP - 1) * 8) - LOP_LEN);
             24186                         /* Digit offset to sign */

  24186 46 013014   200123 336100                    LCQ     WORDS_FOR_TEMP,,AUTO
        46 013015   000003 736000                    QLS     3
        46 013016   200077 036100                    ADLQ    LOP_LEN,,AUTO
        46 013017   000030 676000 47                 ERQ     24
        46 013020   000007 136007                    SBLQ    7,DL
        46 013021   200127 756100                    STQ     MVN_OFFSET,,AUTO

     2424    24187    4              END;

     2425    24188
     2426    24189    3            TN = %NDSC4;

  24189 46 013022   400000 236003                    LDQ     -131072,DU
        46 013023   200045 756100                    STQ     TN,,AUTO

     2427    24190    3            TYPE_DESC.TYPE = %TYO;

  24190 46 013024   000003 235007                    LDA     3,DL
        46 013025   200110 755100                    STA     TYPE_DESC,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:466  

     2428    24191    3            LENGTH = WORDS_FOR_TEMP * 8;

  24191 46 013026   200123 235100                    LDA     WORDS_FOR_TEMP,,AUTO
        46 013027   000003 735000                    ALS     3
        46 013030   200050 755100                    STA     LENGTH,,AUTO

     2429    24192
     2430    24193                 %PACK_NDSC ( @DESC      = TYPE_DESC.DESC ,
     2431    24194                              @LENGTH    = LENGTH ,
     2432    24195                              @SIGN      = LOP_SIGN ,
     2433    24196                              @TN        = TN ,
     2434    24197                              @SCALE     = SCALE );

  24202 46 013031   000000 220003                    LDX0    0,DU
        46 013032   200111 740100                    STX0    TYPE_DESC+1,,AUTO

  24203 46 013033   000027 236000 47                 LDQ     23
        46 013034   200111 356100                    ANSQ    TYPE_DESC+1,,AUTO

  24204 46 013035   200045 236100                    LDQ     TN,,AUTO
        46 013036   000025 772000                    QRL     21
        46 013037   200111 676100                    ERQ     TYPE_DESC+1,,AUTO
        46 013040   040000 376007                    ANQ     16384,DL
        46 013041   200111 656100                    ERSQ    TYPE_DESC+1,,AUTO

  24205 46 013042   200130 236100                    LDQ     LOP_SIGN,,AUTO
        46 013043   000026 772000                    QRL     22
        46 013044   200111 676100                    ERQ     TYPE_DESC+1,,AUTO
        46 013045   030000 376007                    ANQ     12288,DL
        46 013046   200111 656100                    ERSQ    TYPE_DESC+1,,AUTO

  24206 46 013047   200047 236100                    LDQ     SCALE,,AUTO
        46 013050   000006 736000                    QLS     6
        46 013051   200111 752102                    STCQ    TYPE_DESC+1,'02'O,AUTO

  24207 46 013052   200130 236100                    LDQ     LOP_SIGN,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:467  
        46 013053   000042 772000                    QRL     34
        46 013054   000004 116007                    CMPQ    4,DL
        46 013055   013057 602006 46                 TNC     s:24207+5,QL
        46 013056   013103 710000 46                 TRA     s:24247
        46 013057   013072 710000 46                 TRA     s:24233
        46 013060   013066 710000 46                 TRA     s:24214
        46 013061   013066 710000 46                 TRA     s:24214
        46 013062   013063 710000 46                 TRA     s:24209

  24209 46 013063   200050 236100                    LDQ     LENGTH,,AUTO
        46 013064   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO
        46 013065   013103 710000 46                 TRA     s:24247

  24214 46 013066   200050 236100                    LDQ     LENGTH,,AUTO
        46 013067   000001 036007                    ADLQ    1,DL
        46 013070   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO
        46 013071   013103 710000 46                 TRA     s:24247

  24233 46 013072   200045 234100                    SZN     TN,,AUTO
        46 013073   013100 605000 46                 TPL     s:24236

  24234 46 013074   200050 236100                    LDQ     LENGTH,,AUTO
        46 013075   000003 036007                    ADLQ    3,DL
        46 013076   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO
        46 013077   013103 710000 46                 TRA     s:24247

  24236 46 013100   200050 236100                    LDQ     LENGTH,,AUTO
        46 013101   000002 036007                    ADLQ    2,DL
        46 013102   200111 752101                    STCQ    TYPE_DESC+1,'01'O,AUTO

     2435    24246
     2436    24247    3            CALL Z8HU$ALLOT_TEMP(%N               ,/* Format          */

  24247 46 013103   000026 236000 47                 LDQ     22
        46 013104   200305 756100                    STQ     ORG1+4,,AUTO
        46 013105   200110 633500                    EPPR3   TYPE_DESC,,AUTO
        46 013106   200304 453500                    STP3    ORG1+3,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:468  
        46 013107   200125 634500                    EPPR4   BOUNDS,,AUTO
        46 013110   200303 454500                    STP4    ORG1+2,,AUTO
        46 013111   000016 236000 47                 LDQ     14
        46 013112   200302 756100                    STQ     ORG1+1,,AUTO
        46 013113   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 013114   000025 631400 47                 EPPR1   21
        46 013115   000000 701000 xent               TSX1    Z8HU$ALLOT_TEMP
        46 013116   000000 011000                    NOP     0

     2437    24248    3                                 BOUNDS           ,/* Boundary        */
     2438    24249    3                                 TYPE_DESC        ,/* Descriptor      */
     2439    24250    3                                 %STALE          );/* Reuse a temp    */
     2440    24251
     2441    24252    3            TEMP$ = ETT$;

  24252 46 013117   000000 236000 5                  LDQ     ETT$
        46 013120   200124 756100                    STQ     TEMP$,,AUTO

     2442    24253
     2443    24254                 %#OFF#(@FROM=TEMP$,@TO=PCOM.LOPND,@VALUE=LDAQ_OFFSET,@TYPE=%WORD_);

  24262 46 013121   000000 236000 6                  LDQ     HEAD_ETT$
        46 013122   000005 116000 47                 CMPQ    5
        46 013123   013150 601000 46                 TNZ     s:24274

  24264 46 013124   000002 236000 8                  LDQ     ETT_+2
        46 013125   000005 036007                    ADLQ    5,DL
        46 013126   000003 116000 8                  CMPQ    ETT_+3
        46 013127   013140 604000 46                 TMI     s:24266

  24265 46 013130   000014 236000 47                 LDQ     12
        46 013131   200302 756100                    STQ     ORG1+1,,AUTO
        46 013132   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 013133   200303 450500                    STP0    ORG1+2,,AUTO
        46 013134   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 013135   000000 631400 47                 EPPR1   0
        46 013136   000000 701000 xent               TSX1    Z8AR$RESERVER
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:469  
        46 013137   000000 011000                    NOP     0

  24266 46 013140   000002 236000 8                  LDQ     ETT_+2
        46 013141   000022 736000                    QLS     18
        46 013142   000001 036000 8                  ADLQ    ETT_+1
        46 013143   200004 470500                    LDP0    @PCOM,,AUTO
        46 013144   000045 756100                    STQ     37,,PR0

  24267 46 013145   000005 236007                    LDQ     5,DL
        46 013146   000002 056000 8                  ASQ     ETT_+2

  24268 46 013147   013155 710000 46                 TRA     s:24284

  24274 46 013150   200004 470500                    LDP0    @PCOM,,AUTO
        46 013151   000045 756100                    STQ     37,,PR0

  24275 46 013152   000000 471400 6                  LDP1    HEAD_ETT$
        46 013153   100003 236100                    LDQ     3,,PR1
        46 013154   000000 756000 6                  STQ     HEAD_ETT$

  24284 46 013155   000045 471500                    LDP1    37,,PR0
        46 013156   000003 220003                    LDX0    3,DU
        46 013157   100000 740100                    STX0    0,,PR1

  24289 46 013160   000045 471500                    LDP1    37,,PR0
        46 013161   200124 236100                    LDQ     TEMP$,,AUTO
        46 013162   100001 756100                    STQ     1,,PR1

  24292 46 013163   000045 471500                    LDP1    37,,PR0
        46 013164   000005 236000 47                 LDQ     5
        46 013165   100002 756100                    STQ     2,,PR1

  24300 46 013166   000045 471500                    LDP1    37,,PR0
        46 013167   000000 221003                    LDX1    0,DU
        46 013170   100004 441100                    SXL1    4,,PR1

  24301 46 013171   000045 471500                    LDP1    37,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:470  
        46 013172   000001 236007                    LDQ     1,DL
        46 013173   100004 256100                    ORSQ    4,,PR1

  24302 46 013174   000045 471500                    LDP1    37,,PR0
        46 013175   000000 222003                    LDX2    0,DU
        46 013176   100000 442100                    SXL2    0,,PR1

  24303 46 013177   000045 471500                    LDP1    37,,PR0
        46 013200   100004 742100                    STX2    4,,PR1

  24304 46 013201   000045 471500                    LDP1    37,,PR0
        46 013202   000005 236000 47                 LDQ     5
        46 013203   100003 756100                    STQ     3,,PR1

  24328 46 013204   000045 471500                    LDP1    37,,PR0
        46 013205   200126 723100                    LXL3    LDAQ_OFFSET,,AUTO
        46 013206   100002 743100                    STX3    2,,PR1

  24329 46 013207   000045 471500                    LDP1    37,,PR0
        46 013210   000006 224003                    LDX4    6,DU
        46 013211   100002 444100                    SXL4    2,,PR1

  24330 46 013212   000016 236000 47                 LDQ     14
        46 013213   200303 756100                    STQ     ORG1+2,,AUTO
        46 013214   200124 631500                    EPPR1   TEMP$,,AUTO
        46 013215   200302 451500                    STP1    ORG1+1,,AUTO
        46 013216   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 013217   000013 631400 47                 EPPR1   11
        46 013220   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 013221   000000 011000                    NOP     0

  24331 46 013222   200004 236100                    LDQ     @PCOM,,AUTO
        46 013223   000045 036003                    ADLQ    37,DU
        46 013224   200302 756100                    STQ     ORG1+1,,AUTO
        46 013225   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 013226   000000 631400 47                 EPPR1   0
        46 013227   000000 701000 xent               TSX1    Z8HU$WALK
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:471  
        46 013230   000000 011000                    NOP     0

     2444    24334
     2445    24335                 %#OFF#(@FROM=TEMP$,@TO=PCOM.MOPND,@VALUE=MVN_OFFSET,@TYPE=%NUMERIC4);

  24343 46 013231   000000 236000 6                  LDQ     HEAD_ETT$
        46 013232   000005 116000 47                 CMPQ    5
        46 013233   013260 601000 46                 TNZ     s:24355

  24345 46 013234   000002 236000 8                  LDQ     ETT_+2
        46 013235   000005 036007                    ADLQ    5,DL
        46 013236   000003 116000 8                  CMPQ    ETT_+3
        46 013237   013250 604000 46                 TMI     s:24347

  24346 46 013240   000014 236000 47                 LDQ     12
        46 013241   200302 756100                    STQ     ORG1+1,,AUTO
        46 013242   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 013243   200303 450500                    STP0    ORG1+2,,AUTO
        46 013244   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 013245   000000 631400 47                 EPPR1   0
        46 013246   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 013247   000000 011000                    NOP     0

  24347 46 013250   000002 236000 8                  LDQ     ETT_+2
        46 013251   000022 736000                    QLS     18
        46 013252   000001 036000 8                  ADLQ    ETT_+1
        46 013253   200004 470500                    LDP0    @PCOM,,AUTO
        46 013254   000046 756100                    STQ     38,,PR0

  24348 46 013255   000005 236007                    LDQ     5,DL
        46 013256   000002 056000 8                  ASQ     ETT_+2

  24349 46 013257   013265 710000 46                 TRA     s:24365

  24355 46 013260   200004 470500                    LDP0    @PCOM,,AUTO
        46 013261   000046 756100                    STQ     38,,PR0

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:472  
  24356 46 013262   000000 471400 6                  LDP1    HEAD_ETT$
        46 013263   100003 236100                    LDQ     3,,PR1
        46 013264   000000 756000 6                  STQ     HEAD_ETT$

  24365 46 013265   000046 471500                    LDP1    38,,PR0
        46 013266   000003 220003                    LDX0    3,DU
        46 013267   100000 740100                    STX0    0,,PR1

  24370 46 013270   000046 471500                    LDP1    38,,PR0
        46 013271   200124 236100                    LDQ     TEMP$,,AUTO
        46 013272   100001 756100                    STQ     1,,PR1

  24373 46 013273   000046 471500                    LDP1    38,,PR0
        46 013274   000005 236000 47                 LDQ     5
        46 013275   100002 756100                    STQ     2,,PR1

  24381 46 013276   000046 471500                    LDP1    38,,PR0
        46 013277   000000 221003                    LDX1    0,DU
        46 013300   100004 441100                    SXL1    4,,PR1

  24382 46 013301   000046 471500                    LDP1    38,,PR0
        46 013302   000001 236007                    LDQ     1,DL
        46 013303   100004 256100                    ORSQ    4,,PR1

  24383 46 013304   000046 471500                    LDP1    38,,PR0
        46 013305   000000 222003                    LDX2    0,DU
        46 013306   100000 442100                    SXL2    0,,PR1

  24384 46 013307   000046 471500                    LDP1    38,,PR0
        46 013310   100004 742100                    STX2    4,,PR1

  24385 46 013311   000046 471500                    LDP1    38,,PR0
        46 013312   000005 236000 47                 LDQ     5
        46 013313   100003 756100                    STQ     3,,PR1

  24409 46 013314   000046 471500                    LDP1    38,,PR0
        46 013315   200127 723100                    LXL3    MVN_OFFSET,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:473  
        46 013316   100002 743100                    STX3    2,,PR1

  24410 46 013317   000046 471500                    LDP1    38,,PR0
        46 013320   000001 224003                    LDX4    1,DU
        46 013321   100002 444100                    SXL4    2,,PR1

  24411 46 013322   000016 236000 47                 LDQ     14
        46 013323   200303 756100                    STQ     ORG1+2,,AUTO
        46 013324   200124 631500                    EPPR1   TEMP$,,AUTO
        46 013325   200302 451500                    STP1    ORG1+1,,AUTO
        46 013326   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 013327   000013 631400 47                 EPPR1   11
        46 013330   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 013331   000000 011000                    NOP     0

  24412 46 013332   200004 236100                    LDQ     @PCOM,,AUTO
        46 013333   000046 036003                    ADLQ    38,DU
        46 013334   200302 756100                    STQ     ORG1+1,,AUTO
        46 013335   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 013336   000000 631400 47                 EPPR1   0
        46 013337   000000 701000 xent               TSX1    Z8HU$WALK
        46 013340   000000 011000                    NOP     0

     2446    24415
     2447    24416                %#DESC#_NDSC(@FROM=PCOM.MOPND,@TO=PCOM.UOPND,@LENGTH=LOP_LEN,@SIGN=LOP_SIGN
             24416                     );

  24424 46 013341   000000 236000 6                  LDQ     HEAD_ETT$
        46 013342   000005 116000 47                 CMPQ    5
        46 013343   013370 601000 46                 TNZ     s:24436

  24426 46 013344   000002 236000 8                  LDQ     ETT_+2
        46 013345   000005 036007                    ADLQ    5,DL
        46 013346   000003 116000 8                  CMPQ    ETT_+3
        46 013347   013360 604000 46                 TMI     s:24428

  24427 46 013350   000014 236000 47                 LDQ     12
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:474  
        46 013351   200302 756100                    STQ     ORG1+1,,AUTO
        46 013352   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 013353   200303 450500                    STP0    ORG1+2,,AUTO
        46 013354   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 013355   000000 631400 47                 EPPR1   0
        46 013356   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 013357   000000 011000                    NOP     0

  24428 46 013360   000002 236000 8                  LDQ     ETT_+2
        46 013361   000022 736000                    QLS     18
        46 013362   000001 036000 8                  ADLQ    ETT_+1
        46 013363   200004 470500                    LDP0    @PCOM,,AUTO
        46 013364   000056 756100                    STQ     46,,PR0

  24429 46 013365   000005 236007                    LDQ     5,DL
        46 013366   000002 056000 8                  ASQ     ETT_+2

  24430 46 013367   013375 710000 46                 TRA     s:24446

  24436 46 013370   200004 470500                    LDP0    @PCOM,,AUTO
        46 013371   000056 756100                    STQ     46,,PR0

  24437 46 013372   000000 471400 6                  LDP1    HEAD_ETT$
        46 013373   100003 236100                    LDQ     3,,PR1
        46 013374   000000 756000 6                  STQ     HEAD_ETT$

  24446 46 013375   000056 471500                    LDP1    46,,PR0
        46 013376   000010 220003                    LDX0    8,DU
        46 013377   100000 740100                    STX0    0,,PR1

  24451 46 013400   000056 471500                    LDP1    46,,PR0
        46 013401   000046 236100                    LDQ     38,,PR0
        46 013402   100001 756100                    STQ     1,,PR1

  24454 46 013403   000056 471500                    LDP1    46,,PR0
        46 013404   000005 236000 47                 LDQ     5
        46 013405   100002 756100                    STQ     2,,PR1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:475  

  24462 46 013406   000056 471500                    LDP1    46,,PR0
        46 013407   000000 221003                    LDX1    0,DU
        46 013410   100004 441100                    SXL1    4,,PR1

  24463 46 013411   000056 471500                    LDP1    46,,PR0
        46 013412   000001 236007                    LDQ     1,DL
        46 013413   100004 256100                    ORSQ    4,,PR1

  24464 46 013414   000056 471500                    LDP1    46,,PR0
        46 013415   000000 222003                    LDX2    0,DU
        46 013416   100000 442100                    SXL2    0,,PR1

  24465 46 013417   000056 471500                    LDP1    46,,PR0
        46 013420   100004 742100                    STX2    4,,PR1

  24466 46 013421   000056 471500                    LDP1    46,,PR0
        46 013422   000005 236000 47                 LDQ     5
        46 013423   100003 756100                    STQ     3,,PR1

  24490 46 013424   000056 471500                    LDP1    46,,PR0
        46 013425   000046 473500                    LDP3    38,,PR0
        46 013426   300003 474500                    LDP4    3,,PR3
        46 013427   400001 223100                    LDX3    1,,PR4
        46 013430   100002 743100                    STX3    2,,PR1

  24505 46 013431   000046 471500                    LDP1    38,,PR0
        46 013432   100003 473500                    LDP3    3,,PR1
        46 013433   300001 236100                    LDQ     1,,PR3
        46 013434   000014 772000                    QRL     12
        46 013435   000003 376007                    ANQ     3,DL
        46 013436   000004 116007                    CMPQ    4,DL
        46 013437   013441 602006 46                 TNC     s:24505+8,QL
        46 013440   013472 710000 46                 TRA     s:24536
        46 013441   013456 710000 46                 TRA     s:24529
        46 013442   013451 710000 46                 TRA     s:24512
        46 013443   013451 710000 46                 TRA     s:24512
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:476  
        46 013444   013445 710000 46                 TRA     s:24507

  24507 46 013445   300001 236100                    LDQ     1,,PR3
        46 013446   000077 376007                    ANQ     63,DL
        46 013447   200050 756100                    STQ     LENGTH,,AUTO
        46 013450   013472 710000 46                 TRA     s:24536

  24512 46 013451   300001 236100                    LDQ     1,,PR3
        46 013452   000077 376007                    ANQ     63,DL
        46 013453   000001 136007                    SBLQ    1,DL
        46 013454   200050 756100                    STQ     LENGTH,,AUTO
        46 013455   013472 710000 46                 TRA     s:24536

  24529 46 013456   300001 236100                    LDQ     1,,PR3
        46 013457   040000 316007                    CANQ    16384,DL
        46 013460   013466 600000 46                 TZE     s:24532

  24530 46 013461   300001 236100                    LDQ     1,,PR3
        46 013462   000077 376007                    ANQ     63,DL
        46 013463   000003 136007                    SBLQ    3,DL
        46 013464   200050 756100                    STQ     LENGTH,,AUTO
        46 013465   013472 710000 46                 TRA     s:24536

  24532 46 013466   300001 236100                    LDQ     1,,PR3
        46 013467   000077 376007                    ANQ     63,DL
        46 013470   000002 136007                    SBLQ    2,DL
        46 013471   200050 756100                    STQ     LENGTH,,AUTO

  24536 46 013472   000046 471500                    LDP1    38,,PR0
        46 013473   100003 473500                    LDP3    3,,PR1
        46 013474   300001 236100                    LDQ     1,,PR3
        46 013475   000022 772000                    QRL     18
        46 013476   200052 756100                    STQ     SA,,AUTO

  24539 46 013477   300001 236100                    LDQ     1,,PR3
        46 013500   000017 772000                    QRL     15
        46 013501   000007 376007                    ANQ     7,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:477  
        46 013502   200051 756100                    STQ     CN,,AUTO

  24542 46 013503   300001 236100                    LDQ     1,,PR3
        46 013504   000025 736000                    QLS     21
        46 013505   400000 376003                    ANQ     -131072,DU
        46 013506   200045 756100                    STQ     TN,,AUTO

  24545 46 013507   300001 236100                    LDQ     1,,PR3
        46 013510   000030 736000                    QLS     24
        46 013511   000036 732000                    QRS     30
        46 013512   200047 756100                    STQ     SCALE,,AUTO

  24548 46 013513   300001 236100                    LDQ     1,,PR3
        46 013514   000026 736000                    QLS     22
        46 013515   600000 376003                    ANQ     -65536,DU
        46 013516   200044 756100                    STQ     SIGN,,AUTO

  24554 46 013517   200077 235100                    LDA     LOP_LEN,,AUTO
        46 013520   200050 755100                    STA     LENGTH,,AUTO

  24566 46 013521   200130 236100                    LDQ     LOP_SIGN,,AUTO
        46 013522   600000 376003                    ANQ     -65536,DU
        46 013523   200044 756100                    STQ     SIGN,,AUTO

  24580 46 013524   000056 471500                    LDP1    46,,PR0
        46 013525   200052 723100                    LXL3    SA,,AUTO
        46 013526   100002 743100                    STX3    2,,PR1

  24581 46 013527   000056 471500                    LDP1    46,,PR0
        46 013530   200051 236100                    LDQ     CN,,AUTO
        46 013531   000017 736000                    QLS     15
        46 013532   100002 676100                    ERQ     2,,PR1
        46 013533   700000 376007                    ANQ     -32768,DL
        46 013534   100002 656100                    ERSQ    2,,PR1

  24582 46 013535   000056 471500                    LDP1    46,,PR0
        46 013536   200045 236100                    LDQ     TN,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:478  
        46 013537   000025 772000                    QRL     21
        46 013540   100002 676100                    ERQ     2,,PR1
        46 013541   040000 376007                    ANQ     16384,DL
        46 013542   100002 656100                    ERSQ    2,,PR1

  24583 46 013543   000056 471500                    LDP1    46,,PR0
        46 013544   200044 236100                    LDQ     SIGN,,AUTO
        46 013545   000026 772000                    QRL     22
        46 013546   100002 676100                    ERQ     2,,PR1
        46 013547   030000 376007                    ANQ     12288,DL
        46 013550   100002 656100                    ERSQ    2,,PR1

  24584 46 013551   000056 471500                    LDP1    46,,PR0
        46 013552   200047 236100                    LDQ     SCALE,,AUTO
        46 013553   000006 736000                    QLS     6
        46 013554   100002 752102                    STCQ    2,'02'O,PR1

  24585 46 013555   200044 236100                    LDQ     SIGN,,AUTO
        46 013556   000042 772000                    QRL     34
        46 013557   000004 116007                    CMPQ    4,DL
        46 013560   013562 602006 46                 TNC     s:24585+5,QL
        46 013561   013612 710000 46                 TRA     s:24624
        46 013562   013577 710000 46                 TRA     s:24611
        46 013563   013572 710000 46                 TRA     s:24592
        46 013564   013572 710000 46                 TRA     s:24592
        46 013565   013566 710000 46                 TRA     s:24587

  24587 46 013566   000056 471500                    LDP1    46,,PR0
        46 013567   200050 236100                    LDQ     LENGTH,,AUTO
        46 013570   100002 752101                    STCQ    2,'01'O,PR1
        46 013571   013612 710000 46                 TRA     s:24624

  24592 46 013572   000056 471500                    LDP1    46,,PR0
        46 013573   200050 236100                    LDQ     LENGTH,,AUTO
        46 013574   000001 036007                    ADLQ    1,DL
        46 013575   100002 752101                    STCQ    2,'01'O,PR1
        46 013576   013612 710000 46                 TRA     s:24624
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:479  

  24611 46 013577   200045 234100                    SZN     TN,,AUTO
        46 013600   013606 605000 46                 TPL     s:24614

  24612 46 013601   000056 471500                    LDP1    46,,PR0
        46 013602   200050 236100                    LDQ     LENGTH,,AUTO
        46 013603   000003 036007                    ADLQ    3,DL
        46 013604   100002 752101                    STCQ    2,'01'O,PR1
        46 013605   013612 710000 46                 TRA     s:24624

  24614 46 013606   000056 471500                    LDP1    46,,PR0
        46 013607   200050 236100                    LDQ     LENGTH,,AUTO
        46 013610   000002 036007                    ADLQ    2,DL
        46 013611   100002 752101                    STCQ    2,'01'O,PR1

  24624 46 013612   000016 236000 47                 LDQ     14
        46 013613   200303 756100                    STQ     ORG1+2,,AUTO
        46 013614   200004 236100                    LDQ     @PCOM,,AUTO
        46 013615   000046 036003                    ADLQ    38,DU
        46 013616   200302 756100                    STQ     ORG1+1,,AUTO
        46 013617   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 013620   000013 631400 47                 EPPR1   11
        46 013621   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 013622   000000 011000                    NOP     0

  24625 46 013623   200004 236100                    LDQ     @PCOM,,AUTO
        46 013624   000056 036003                    ADLQ    46,DU
        46 013625   200302 756100                    STQ     ORG1+1,,AUTO
        46 013626   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 013627   000000 631400 47                 EPPR1   0
        46 013630   000000 701000 xent               TSX1    Z8HU$WALK
        46 013631   000000 011000                    NOP     0

     2448    24628
     2449    24629                 %#DESC#_NDSC(@FROM=PILL->ETT.LOP,@TO=PCOM.NOPND,@LENGTH=LOP_LEN,@SIGN=
             24629                     %NO_SIGN);

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:480  
  24637 46 013632   000000 236000 6                  LDQ     HEAD_ETT$
        46 013633   000005 116000 47                 CMPQ    5
        46 013634   013661 601000 46                 TNZ     s:24649

  24639 46 013635   000002 236000 8                  LDQ     ETT_+2
        46 013636   000005 036007                    ADLQ    5,DL
        46 013637   000003 116000 8                  CMPQ    ETT_+3
        46 013640   013651 604000 46                 TMI     s:24641

  24640 46 013641   000014 236000 47                 LDQ     12
        46 013642   200302 756100                    STQ     ORG1+1,,AUTO
        46 013643   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 013644   200303 450500                    STP0    ORG1+2,,AUTO
        46 013645   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 013646   000000 631400 47                 EPPR1   0
        46 013647   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 013650   000000 011000                    NOP     0

  24641 46 013651   000002 236000 8                  LDQ     ETT_+2
        46 013652   000022 736000                    QLS     18
        46 013653   000001 036000 8                  ADLQ    ETT_+1
        46 013654   200004 470500                    LDP0    @PCOM,,AUTO
        46 013655   000047 756100                    STQ     39,,PR0

  24642 46 013656   000005 236007                    LDQ     5,DL
        46 013657   000002 056000 8                  ASQ     ETT_+2

  24643 46 013660   013666 710000 46                 TRA     s:24659

  24649 46 013661   200004 470500                    LDP0    @PCOM,,AUTO
        46 013662   000047 756100                    STQ     39,,PR0

  24650 46 013663   000000 471400 6                  LDP1    HEAD_ETT$
        46 013664   100003 236100                    LDQ     3,,PR1
        46 013665   000000 756000 6                  STQ     HEAD_ETT$

  24659 46 013666   000047 471500                    LDP1    39,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:481  
        46 013667   000010 220003                    LDX0    8,DU
        46 013670   100000 740100                    STX0    0,,PR1

  24664 46 013671   000047 471500                    LDP1    39,,PR0
        46 013672   200003 473500                    LDP3    @PILL,,AUTO
        46 013673   300000 474500                    LDP4    0,,PR3
        46 013674   400001 236100                    LDQ     1,,PR4
        46 013675   100001 756100                    STQ     1,,PR1

  24667 46 013676   000047 471500                    LDP1    39,,PR0
        46 013677   000005 236000 47                 LDQ     5
        46 013700   100002 756100                    STQ     2,,PR1

  24675 46 013701   000047 471500                    LDP1    39,,PR0
        46 013702   000000 221003                    LDX1    0,DU
        46 013703   100004 441100                    SXL1    4,,PR1

  24676 46 013704   000047 471500                    LDP1    39,,PR0
        46 013705   000001 236007                    LDQ     1,DL
        46 013706   100004 256100                    ORSQ    4,,PR1

  24677 46 013707   000047 471500                    LDP1    39,,PR0
        46 013710   000000 222003                    LDX2    0,DU
        46 013711   100000 442100                    SXL2    0,,PR1

  24678 46 013712   000047 471500                    LDP1    39,,PR0
        46 013713   100004 742100                    STX2    4,,PR1

  24679 46 013714   000047 471500                    LDP1    39,,PR0
        46 013715   000005 236000 47                 LDQ     5
        46 013716   100003 756100                    STQ     3,,PR1

  24703 46 013717   000047 471500                    LDP1    39,,PR0
        46 013720   300000 474500                    LDP4    0,,PR3
        46 013721   400001 475500                    LDP5    1,,PR4
        46 013722   500003 476500                    LDP6    3,,PR5
        46 013723   600001 223100                    LDX3    1,,PR6
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:482  
        46 013724   100002 743100                    STX3    2,,PR1

  24718 46 013725   300000 471500                    LDP1    0,,PR3
        46 013726   100001 474500                    LDP4    1,,PR1
        46 013727   400003 475500                    LDP5    3,,PR4
        46 013730   500001 236100                    LDQ     1,,PR5
        46 013731   000014 772000                    QRL     12
        46 013732   000003 376007                    ANQ     3,DL
        46 013733   000004 116007                    CMPQ    4,DL
        46 013734   013736 602006 46                 TNC     s:24718+9,QL
        46 013735   013767 710000 46                 TRA     s:24749
        46 013736   013753 710000 46                 TRA     s:24742
        46 013737   013746 710000 46                 TRA     s:24725
        46 013740   013746 710000 46                 TRA     s:24725
        46 013741   013742 710000 46                 TRA     s:24720

  24720 46 013742   500001 236100                    LDQ     1,,PR5
        46 013743   000077 376007                    ANQ     63,DL
        46 013744   200050 756100                    STQ     LENGTH,,AUTO
        46 013745   013767 710000 46                 TRA     s:24749

  24725 46 013746   500001 236100                    LDQ     1,,PR5
        46 013747   000077 376007                    ANQ     63,DL
        46 013750   000001 136007                    SBLQ    1,DL
        46 013751   200050 756100                    STQ     LENGTH,,AUTO
        46 013752   013767 710000 46                 TRA     s:24749

  24742 46 013753   500001 236100                    LDQ     1,,PR5
        46 013754   040000 316007                    CANQ    16384,DL
        46 013755   013763 600000 46                 TZE     s:24745

  24743 46 013756   500001 236100                    LDQ     1,,PR5
        46 013757   000077 376007                    ANQ     63,DL
        46 013760   000003 136007                    SBLQ    3,DL
        46 013761   200050 756100                    STQ     LENGTH,,AUTO
        46 013762   013767 710000 46                 TRA     s:24749

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:483  
  24745 46 013763   500001 236100                    LDQ     1,,PR5
        46 013764   000077 376007                    ANQ     63,DL
        46 013765   000002 136007                    SBLQ    2,DL
        46 013766   200050 756100                    STQ     LENGTH,,AUTO

  24749 46 013767   300000 471500                    LDP1    0,,PR3
        46 013770   100001 474500                    LDP4    1,,PR1
        46 013771   400003 475500                    LDP5    3,,PR4
        46 013772   500001 236100                    LDQ     1,,PR5
        46 013773   000022 772000                    QRL     18
        46 013774   200052 756100                    STQ     SA,,AUTO

  24752 46 013775   500001 236100                    LDQ     1,,PR5
        46 013776   000017 772000                    QRL     15
        46 013777   000007 376007                    ANQ     7,DL
        46 014000   200051 756100                    STQ     CN,,AUTO

  24755 46 014001   500001 236100                    LDQ     1,,PR5
        46 014002   000025 736000                    QLS     21
        46 014003   400000 376003                    ANQ     -131072,DU
        46 014004   200045 756100                    STQ     TN,,AUTO

  24758 46 014005   500001 236100                    LDQ     1,,PR5
        46 014006   000030 736000                    QLS     24
        46 014007   000036 732000                    QRS     30
        46 014010   200047 756100                    STQ     SCALE,,AUTO

  24761 46 014011   500001 236100                    LDQ     1,,PR5
        46 014012   000026 736000                    QLS     22
        46 014013   600000 376003                    ANQ     -65536,DU
        46 014014   200044 756100                    STQ     SIGN,,AUTO

  24767 46 014015   200077 235100                    LDA     LOP_LEN,,AUTO
        46 014016   200050 755100                    STA     LENGTH,,AUTO

  24779 46 014017   600000 236003                    LDQ     -65536,DU
        46 014020   200044 756100                    STQ     SIGN,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:484  

  24793 46 014021   000047 471500                    LDP1    39,,PR0
        46 014022   200052 723100                    LXL3    SA,,AUTO
        46 014023   100002 743100                    STX3    2,,PR1

  24794 46 014024   000047 471500                    LDP1    39,,PR0
        46 014025   200051 236100                    LDQ     CN,,AUTO
        46 014026   000017 736000                    QLS     15
        46 014027   100002 676100                    ERQ     2,,PR1
        46 014030   700000 376007                    ANQ     -32768,DL
        46 014031   100002 656100                    ERSQ    2,,PR1

  24795 46 014032   000047 471500                    LDP1    39,,PR0
        46 014033   200045 236100                    LDQ     TN,,AUTO
        46 014034   000025 772000                    QRL     21
        46 014035   100002 676100                    ERQ     2,,PR1
        46 014036   040000 376007                    ANQ     16384,DL
        46 014037   100002 656100                    ERSQ    2,,PR1

  24796 46 014040   000047 471500                    LDP1    39,,PR0
        46 014041   200044 236100                    LDQ     SIGN,,AUTO
        46 014042   000026 772000                    QRL     22
        46 014043   100002 676100                    ERQ     2,,PR1
        46 014044   030000 376007                    ANQ     12288,DL
        46 014045   100002 656100                    ERSQ    2,,PR1

  24797 46 014046   000047 471500                    LDP1    39,,PR0
        46 014047   200047 236100                    LDQ     SCALE,,AUTO
        46 014050   000006 736000                    QLS     6
        46 014051   100002 752102                    STCQ    2,'02'O,PR1

  24798 46 014052   200044 236100                    LDQ     SIGN,,AUTO
        46 014053   000042 772000                    QRL     34
        46 014054   000004 116007                    CMPQ    4,DL
        46 014055   014057 602006 46                 TNC     s:24798+5,QL
        46 014056   014107 710000 46                 TRA     s:24837
        46 014057   014074 710000 46                 TRA     s:24824
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:485  
        46 014060   014067 710000 46                 TRA     s:24805
        46 014061   014067 710000 46                 TRA     s:24805
        46 014062   014063 710000 46                 TRA     s:24800

  24800 46 014063   000047 471500                    LDP1    39,,PR0
        46 014064   200050 236100                    LDQ     LENGTH,,AUTO
        46 014065   100002 752101                    STCQ    2,'01'O,PR1
        46 014066   014107 710000 46                 TRA     s:24837

  24805 46 014067   000047 471500                    LDP1    39,,PR0
        46 014070   200050 236100                    LDQ     LENGTH,,AUTO
        46 014071   000001 036007                    ADLQ    1,DL
        46 014072   100002 752101                    STCQ    2,'01'O,PR1
        46 014073   014107 710000 46                 TRA     s:24837

  24824 46 014074   200045 234100                    SZN     TN,,AUTO
        46 014075   014103 605000 46                 TPL     s:24827

  24825 46 014076   000047 471500                    LDP1    39,,PR0
        46 014077   200050 236100                    LDQ     LENGTH,,AUTO
        46 014100   000003 036007                    ADLQ    3,DL
        46 014101   100002 752101                    STCQ    2,'01'O,PR1
        46 014102   014107 710000 46                 TRA     s:24837

  24827 46 014103   000047 471500                    LDP1    39,,PR0
        46 014104   200050 236100                    LDQ     LENGTH,,AUTO
        46 014105   000002 036007                    ADLQ    2,DL
        46 014106   100002 752101                    STCQ    2,'01'O,PR1

  24837 46 014107   300000 471500                    LDP1    0,,PR3
        46 014110   000016 236000 47                 LDQ     14
        46 014111   200303 756100                    STQ     ORG1+2,,AUTO
        46 014112   100001 634500                    EPPR4   1,,PR1
        46 014113   200302 454500                    STP4    ORG1+1,,AUTO
        46 014114   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014115   000013 631400 47                 EPPR1   11
        46 014116   000000 701000 xent               TSX1    Z8HU$INCCNT
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:486  
        46 014117   000000 011000                    NOP     0

  24838 46 014120   200004 236100                    LDQ     @PCOM,,AUTO
        46 014121   000047 036003                    ADLQ    39,DU
        46 014122   200302 756100                    STQ     ORG1+1,,AUTO
        46 014123   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014124   000000 631400 47                 EPPR1   0
        46 014125   000000 701000 xent               TSX1    Z8HU$WALK
        46 014126   000000 011000                    NOP     0

     2450    24841
     2451    24842    3            IF LOP_SIGN = %LEADING_SIGN THEN

  24842 46 014127   200130 236100                    LDQ     LOP_SIGN,,AUTO
        46 014130   600000 376003                    ANQ     -65536,DU
        46 014131   200000 116003                    CMPQ    65536,DU
        46 014132   014135 601000 46                 TNZ     s:24845

     2452    24843    3              I = 0;

  24843 46 014133   200065 450100                    STZ     I,,AUTO
        46 014134   014145 710000 46                 TRA     s:24849

     2453    24844    3            ELSE
     2454    24845    3              I = PILL -> ETT.LOP -> ETT.REF$ -> REF.NDSC.N - 1;

  24845 46 014135   200003 470500                    LDP0    @PILL,,AUTO
        46 014136   000000 471500                    LDP1    0,,PR0
        46 014137   100001 473500                    LDP3    1,,PR1
        46 014140   300003 474500                    LDP4    3,,PR3
        46 014141   400001 236100                    LDQ     1,,PR4
        46 014142   000077 376007                    ANQ     63,DL
        46 014143   000001 136007                    SBLQ    1,DL
        46 014144   200065 756100                    STQ     I,,AUTO

     2455    24846
     2456    24847                 %#DNA#(@FROM=PILL -> ETT.LOP,@TO=PCOM.YOPND);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:487  

  24849 46 014145   200003 470500                    LDP0    @PILL,,AUTO
        46 014146   000000 471500                    LDP1    0,,PR0
        46 014147   100001 473500                    LDP3    1,,PR1
        46 014150   300003 474500                    LDP4    3,,PR3
        46 014151   400001 236100                    LDQ     1,,PR4
        46 014152   000077 376007                    ANQ     63,DL
        46 014153   200066 756100                    STQ     J,,AUTO

  24857 46 014154   000000 236000 6                  LDQ     HEAD_ETT$
        46 014155   000005 116000 47                 CMPQ    5
        46 014156   014203 601000 46                 TNZ     s:24869

  24859 46 014157   000002 236000 8                  LDQ     ETT_+2
        46 014160   000005 036007                    ADLQ    5,DL
        46 014161   000003 116000 8                  CMPQ    ETT_+3
        46 014162   014173 604000 46                 TMI     s:24861

  24860 46 014163   000014 236000 47                 LDQ     12
        46 014164   200302 756100                    STQ     ORG1+1,,AUTO
        46 014165   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 014166   200303 451500                    STP1    ORG1+2,,AUTO
        46 014167   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 014170   000000 631400 47                 EPPR1   0
        46 014171   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 014172   000000 011000                    NOP     0

  24861 46 014173   000002 236000 8                  LDQ     ETT_+2
        46 014174   000022 736000                    QLS     18
        46 014175   000001 036000 8                  ADLQ    ETT_+1
        46 014176   200004 470500                    LDP0    @PCOM,,AUTO
        46 014177   000062 756100                    STQ     50,,PR0

  24862 46 014200   000005 236007                    LDQ     5,DL
        46 014201   000002 056000 8                  ASQ     ETT_+2

  24863 46 014202   014210 710000 46                 TRA     s:24879
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:488  

  24869 46 014203   200004 471500                    LDP1    @PCOM,,AUTO
        46 014204   100062 756100                    STQ     50,,PR1

  24870 46 014205   000000 473400 6                  LDP3    HEAD_ETT$
        46 014206   300003 236100                    LDQ     3,,PR3
        46 014207   000000 756000 6                  STQ     HEAD_ETT$

  24879 46 014210   200004 470500                    LDP0    @PCOM,,AUTO
        46 014211   000062 471500                    LDP1    50,,PR0
        46 014212   000007 220003                    LDX0    7,DU
        46 014213   100000 740100                    STX0    0,,PR1

  24884 46 014214   000062 471500                    LDP1    50,,PR0
        46 014215   200003 473500                    LDP3    @PILL,,AUTO
        46 014216   300000 474500                    LDP4    0,,PR3
        46 014217   400001 236100                    LDQ     1,,PR4
        46 014220   100001 756100                    STQ     1,,PR1

  24893 46 014221   000062 471500                    LDP1    50,,PR0
        46 014222   200066 235100                    LDA     J,,AUTO
        46 014223   100002 755100                    STA     2,,PR1

  24895 46 014224   000062 471500                    LDP1    50,,PR0
        46 014225   000000 221003                    LDX1    0,DU
        46 014226   100004 441100                    SXL1    4,,PR1

  24896 46 014227   000062 471500                    LDP1    50,,PR0
        46 014230   000001 236007                    LDQ     1,DL
        46 014231   100004 256100                    ORSQ    4,,PR1

  24897 46 014232   000062 471500                    LDP1    50,,PR0
        46 014233   000000 222003                    LDX2    0,DU
        46 014234   100000 442100                    SXL2    0,,PR1

  24898 46 014235   000062 471500                    LDP1    50,,PR0
        46 014236   100004 742100                    STX2    4,,PR1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:489  

  24899 46 014237   000062 471500                    LDP1    50,,PR0
        46 014240   000005 236000 47                 LDQ     5
        46 014241   100003 756100                    STQ     3,,PR1

  24923 46 014242   300000 471500                    LDP1    0,,PR3
        46 014243   000016 236000 47                 LDQ     14
        46 014244   200303 756100                    STQ     ORG1+2,,AUTO
        46 014245   100001 634500                    EPPR4   1,,PR1
        46 014246   200302 454500                    STP4    ORG1+1,,AUTO
        46 014247   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014250   000013 631400 47                 EPPR1   11
        46 014251   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 014252   000000 011000                    NOP     0

  24924 46 014253   200004 236100                    LDQ     @PCOM,,AUTO
        46 014254   000062 036003                    ADLQ    50,DU
        46 014255   200302 756100                    STQ     ORG1+1,,AUTO
        46 014256   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014257   000000 631400 47                 EPPR1   0
        46 014260   000000 701000 xent               TSX1    Z8HU$WALK
        46 014261   000000 011000                    NOP     0

  24925 46 014262   200003 470500                    LDP0    @PILL,,AUTO
        46 014263   000000 471500                    LDP1    0,,PR0
        46 014264   100001 473500                    LDP3    1,,PR1
        46 014265   300003 474500                    LDP4    3,,PR3
        46 014266   400001 236100                    LDQ     1,,PR4
        46 014267   040000 316007                    CANQ    16384,DL
        46 014270   014305 600000 46                 TZE     s:24929
        46 014271   400005 475500                    LDP5    5,,PR4
        46 014272   500002 220100                    LDX0    2,,PR5
        46 014273   000013 100003                    CMPX0   11,DU
        46 014274   014305 600000 46                 TZE     s:24929

  24927 46 014275   200004 476500                    LDP6    @PCOM,,AUTO
        46 014276   600062 477500                    LDP7    50,,PR6
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:490  
        46 014277   700003 470500                    LDP0    3,,PR7
        46 014300   000001 236100                    LDQ     1,,PR0
        46 014301   000017 376000 47                 ANQ     15
        46 014302   040000 276007                    ORQ     16384,DL
        46 014303   000001 756100                    STQ     1,,PR0
        46 014304   014312 710000 46                 TRA     s:24940

  24929 46 014305   200004 475500                    LDP5    @PCOM,,AUTO
        46 014306   500062 476500                    LDP6    50,,PR5
        46 014307   600003 477500                    LDP7    3,,PR6
        46 014310   000017 236000 47                 LDQ     15
        46 014311   700001 356100                    ANSQ    1,,PR7

     2457    24932                 %#DESC#_ADSC(@FROM=PCOM.YOPND,@TO=PCOM.FOPND,@LENGTH=1);

  24940 46 014312   000000 236000 6                  LDQ     HEAD_ETT$
        46 014313   000005 116000 47                 CMPQ    5
        46 014314   014341 601000 46                 TNZ     s:24952

  24942 46 014315   000002 236000 8                  LDQ     ETT_+2
        46 014316   000005 036007                    ADLQ    5,DL
        46 014317   000003 116000 8                  CMPQ    ETT_+3
        46 014320   014331 604000 46                 TMI     s:24944

  24943 46 014321   000014 236000 47                 LDQ     12
        46 014322   200302 756100                    STQ     ORG1+1,,AUTO
        46 014323   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014324   200303 450500                    STP0    ORG1+2,,AUTO
        46 014325   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 014326   000000 631400 47                 EPPR1   0
        46 014327   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 014330   000000 011000                    NOP     0

  24944 46 014331   000002 236000 8                  LDQ     ETT_+2
        46 014332   000022 736000                    QLS     18
        46 014333   000001 036000 8                  ADLQ    ETT_+1
        46 014334   200004 470500                    LDP0    @PCOM,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:491  
        46 014335   000037 756100                    STQ     31,,PR0

  24945 46 014336   000005 236007                    LDQ     5,DL
        46 014337   000002 056000 8                  ASQ     ETT_+2

  24946 46 014340   014346 710000 46                 TRA     s:24962

  24952 46 014341   200004 470500                    LDP0    @PCOM,,AUTO
        46 014342   000037 756100                    STQ     31,,PR0

  24953 46 014343   000000 471400 6                  LDP1    HEAD_ETT$
        46 014344   100003 236100                    LDQ     3,,PR1
        46 014345   000000 756000 6                  STQ     HEAD_ETT$

  24962 46 014346   000037 471500                    LDP1    31,,PR0
        46 014347   000010 220003                    LDX0    8,DU
        46 014350   100000 740100                    STX0    0,,PR1

  24967 46 014351   000037 471500                    LDP1    31,,PR0
        46 014352   000062 236100                    LDQ     50,,PR0
        46 014353   100001 756100                    STQ     1,,PR1

  24970 46 014354   000037 471500                    LDP1    31,,PR0
        46 014355   000005 236000 47                 LDQ     5
        46 014356   100002 756100                    STQ     2,,PR1

  24978 46 014357   000037 471500                    LDP1    31,,PR0
        46 014360   000000 221003                    LDX1    0,DU
        46 014361   100004 441100                    SXL1    4,,PR1

  24979 46 014362   000037 471500                    LDP1    31,,PR0
        46 014363   000001 236007                    LDQ     1,DL
        46 014364   100004 256100                    ORSQ    4,,PR1

  24980 46 014365   000037 471500                    LDP1    31,,PR0
        46 014366   000000 222003                    LDX2    0,DU
        46 014367   100000 442100                    SXL2    0,,PR1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:492  

  24981 46 014370   000037 471500                    LDP1    31,,PR0
        46 014371   100004 742100                    STX2    4,,PR1

  24982 46 014372   000037 471500                    LDP1    31,,PR0
        46 014373   000005 236000 47                 LDQ     5
        46 014374   100003 756100                    STQ     3,,PR1

  25006 46 014375   000037 471500                    LDP1    31,,PR0
        46 014376   000062 473500                    LDP3    50,,PR0
        46 014377   300003 474500                    LDP4    3,,PR3
        46 014400   400001 223100                    LDX3    1,,PR4
        46 014401   100002 743100                    STX3    2,,PR1

  25019 46 014402   000062 471500                    LDP1    50,,PR0
        46 014403   100003 473500                    LDP3    3,,PR1
        46 014404   300001 236100                    LDQ     1,,PR3
        46 014405   000022 772000                    QRL     18
        46 014406   200052 756100                    STQ     SA,,AUTO

  25022 46 014407   300001 236100                    LDQ     1,,PR3
        46 014410   007777 376007                    ANQ     4095,DL
        46 014411   200050 756100                    STQ     LENGTH,,AUTO

  25025 46 014412   100003 473500                    LDP3    3,,PR1
        46 014413   300001 236100                    LDQ     1,,PR3
        46 014414   060000 316007                    CANQ    24576,DL
        46 014415   014423 601000 46                 TNZ     s:25027

  25026 46 014416   300001 236100                    LDQ     1,,PR3
        46 014417   000020 772000                    QRL     16
        46 014420   000003 376007                    ANQ     3,DL
        46 014421   200051 756100                    STQ     CN,,AUTO
        46 014422   014427 710000 46                 TRA     s:25030

  25027 46 014423   300001 236100                    LDQ     1,,PR3
        46 014424   000017 772000                    QRL     15
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:493  
        46 014425   000007 376007                    ANQ     7,DL
        46 014426   200051 756100                    STQ     CN,,AUTO

  25030 46 014427   300001 236100                    LDQ     1,,PR3
        46 014430   000025 736000                    QLS     21
        46 014431   600000 376003                    ANQ     -65536,DU
        46 014432   200046 756100                    STQ     TA,,AUTO

  25036 46 014433   000001 235007                    LDA     1,DL
        46 014434   200050 755100                    STA     LENGTH,,AUTO

  25053 46 014435   000037 473500                    LDP3    31,,PR0
        46 014436   200052 723100                    LXL3    SA,,AUTO
        46 014437   300002 743100                    STX3    2,,PR3

  25060 46 014440   200046 236100                    LDQ     TA,,AUTO
        46 014441   600000 316003                    CANQ    -65536,DU
        46 014442   014455 601000 46                 TNZ     s:25066

  25062 46 014443   000037 471500                    LDP1    31,,PR0
        46 014444   200051 236100                    LDQ     CN,,AUTO
        46 014445   000020 736000                    QLS     16
        46 014446   100002 676100                    ERQ     2,,PR1
        46 014447   600000 376007                    ANQ     -65536,DL
        46 014450   100002 656100                    ERSQ    2,,PR1

  25063 46 014451   000037 471500                    LDP1    31,,PR0
        46 014452   000031 236000 47                 LDQ     25
        46 014453   100002 356100                    ANSQ    2,,PR1

  25064 46 014454   014463 710000 46                 TRA     s:25068

  25066 46 014455   000037 471500                    LDP1    31,,PR0
        46 014456   200051 236100                    LDQ     CN,,AUTO
        46 014457   000017 736000                    QLS     15
        46 014460   100002 676100                    ERQ     2,,PR1
        46 014461   700000 376007                    ANQ     -32768,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:494  
        46 014462   100002 656100                    ERSQ    2,,PR1

  25068 46 014463   000037 471500                    LDP1    31,,PR0
        46 014464   200046 236100                    LDQ     TA,,AUTO
        46 014465   000025 772000                    QRL     21
        46 014466   100002 676100                    ERQ     2,,PR1
        46 014467   060000 376007                    ANQ     24576,DL
        46 014470   100002 656100                    ERSQ    2,,PR1

  25069 46 014471   000037 471500                    LDP1    31,,PR0
        46 014472   000032 236000 47                 LDQ     26
        46 014473   100002 356100                    ANSQ    2,,PR1

  25070 46 014474   000037 471500                    LDP1    31,,PR0
        46 014475   200050 236100                    LDQ     LENGTH,,AUTO
        46 014476   100002 752103                    STCQ    2,'03'O,PR1

  25073 46 014477   000016 236000 47                 LDQ     14
        46 014500   200303 756100                    STQ     ORG1+2,,AUTO
        46 014501   200004 236100                    LDQ     @PCOM,,AUTO
        46 014502   000062 036003                    ADLQ    50,DU
        46 014503   200302 756100                    STQ     ORG1+1,,AUTO
        46 014504   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014505   000013 631400 47                 EPPR1   11
        46 014506   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 014507   000000 011000                    NOP     0

  25074 46 014510   200004 236100                    LDQ     @PCOM,,AUTO
        46 014511   000037 036003                    ADLQ    31,DU
        46 014512   200302 756100                    STQ     ORG1+1,,AUTO
        46 014513   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014514   000000 631400 47                 EPPR1   0
        46 014515   000000 701000 xent               TSX1    Z8HU$WALK
        46 014516   000000 011000                    NOP     0

     2458    25077                 %#OFF#(@FROM=PCOM.FOPND,@TO=PCOM.OOPND,@VALUE=I,@TYPE=%ALPHA9);

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:495  
  25085 46 014517   000000 236000 6                  LDQ     HEAD_ETT$
        46 014520   000005 116000 47                 CMPQ    5
        46 014521   014546 601000 46                 TNZ     s:25097

  25087 46 014522   000002 236000 8                  LDQ     ETT_+2
        46 014523   000005 036007                    ADLQ    5,DL
        46 014524   000003 116000 8                  CMPQ    ETT_+3
        46 014525   014536 604000 46                 TMI     s:25089

  25088 46 014526   000014 236000 47                 LDQ     12
        46 014527   200302 756100                    STQ     ORG1+1,,AUTO
        46 014530   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014531   200303 450500                    STP0    ORG1+2,,AUTO
        46 014532   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 014533   000000 631400 47                 EPPR1   0
        46 014534   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 014535   000000 011000                    NOP     0

  25089 46 014536   000002 236000 8                  LDQ     ETT_+2
        46 014537   000022 736000                    QLS     18
        46 014540   000001 036000 8                  ADLQ    ETT_+1
        46 014541   200004 470500                    LDP0    @PCOM,,AUTO
        46 014542   000050 756100                    STQ     40,,PR0

  25090 46 014543   000005 236007                    LDQ     5,DL
        46 014544   000002 056000 8                  ASQ     ETT_+2

  25091 46 014545   014553 710000 46                 TRA     s:25107

  25097 46 014546   200004 470500                    LDP0    @PCOM,,AUTO
        46 014547   000050 756100                    STQ     40,,PR0

  25098 46 014550   000000 471400 6                  LDP1    HEAD_ETT$
        46 014551   100003 236100                    LDQ     3,,PR1
        46 014552   000000 756000 6                  STQ     HEAD_ETT$

  25107 46 014553   000050 471500                    LDP1    40,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:496  
        46 014554   000003 220003                    LDX0    3,DU
        46 014555   100000 740100                    STX0    0,,PR1

  25112 46 014556   000050 471500                    LDP1    40,,PR0
        46 014557   000037 236100                    LDQ     31,,PR0
        46 014560   100001 756100                    STQ     1,,PR1

  25115 46 014561   000050 471500                    LDP1    40,,PR0
        46 014562   000005 236000 47                 LDQ     5
        46 014563   100002 756100                    STQ     2,,PR1

  25123 46 014564   000050 471500                    LDP1    40,,PR0
        46 014565   000000 221003                    LDX1    0,DU
        46 014566   100004 441100                    SXL1    4,,PR1

  25124 46 014567   000050 471500                    LDP1    40,,PR0
        46 014570   000001 236007                    LDQ     1,DL
        46 014571   100004 256100                    ORSQ    4,,PR1

  25125 46 014572   000050 471500                    LDP1    40,,PR0
        46 014573   000000 222003                    LDX2    0,DU
        46 014574   100000 442100                    SXL2    0,,PR1

  25126 46 014575   000050 471500                    LDP1    40,,PR0
        46 014576   100004 742100                    STX2    4,,PR1

  25127 46 014577   000050 471500                    LDP1    40,,PR0
        46 014600   000005 236000 47                 LDQ     5
        46 014601   100003 756100                    STQ     3,,PR1

  25151 46 014602   000050 471500                    LDP1    40,,PR0
        46 014603   200065 723100                    LXL3    I,,AUTO
        46 014604   100002 743100                    STX3    2,,PR1

  25152 46 014605   000050 471500                    LDP1    40,,PR0
        46 014606   000005 223003                    LDX3    5,DU
        46 014607   100002 443100                    SXL3    2,,PR1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:497  

  25153 46 014610   000016 236000 47                 LDQ     14
        46 014611   200303 756100                    STQ     ORG1+2,,AUTO
        46 014612   200004 236100                    LDQ     @PCOM,,AUTO
        46 014613   000037 036003                    ADLQ    31,DU
        46 014614   200302 756100                    STQ     ORG1+1,,AUTO
        46 014615   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014616   000013 631400 47                 EPPR1   11
        46 014617   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 014620   000000 011000                    NOP     0

  25154 46 014621   200004 236100                    LDQ     @PCOM,,AUTO
        46 014622   000050 036003                    ADLQ    40,DU
        46 014623   200302 756100                    STQ     ORG1+1,,AUTO
        46 014624   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014625   000000 631400 47                 EPPR1   0
        46 014626   000000 701000 xent               TSX1    Z8HU$WALK
        46 014627   000000 011000                    NOP     0

     2459    25157
     2460    25158
     2461    25159    3            CALL Z8HU$DEC_COUNT(TEMP$, 2);

  25159 46 014630   000034 236000 47                 LDQ     28
        46 014631   200303 756100                    STQ     ORG1+2,,AUTO
        46 014632   200124 630500                    EPPR0   TEMP$,,AUTO
        46 014633   200302 450500                    STP0    ORG1+1,,AUTO
        46 014634   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014635   000013 631400 47                 EPPR1   11
        46 014636   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 014637   000000 011000                    NOP     0

     2462    25160    3            CALL Z8HU$DEC_COUNT(PCOM.MOPND,1);

  25160 46 014640   000016 236000 47                 LDQ     14
        46 014641   200303 756100                    STQ     ORG1+2,,AUTO
        46 014642   200004 236100                    LDQ     @PCOM,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:498  
        46 014643   000046 036003                    ADLQ    38,DU
        46 014644   200302 756100                    STQ     ORG1+1,,AUTO
        46 014645   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014646   000013 631400 47                 EPPR1   11
        46 014647   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 014650   000000 011000                    NOP     0

     2463    25161    3            IF PCOM.IABS = 1 /* %TYD */

  25161 46 014651   200004 470500                    LDP0    @PCOM,,AUTO
        46 014652   000010 235100                    LDA     8,,PR0
        46 014653   000001 115007                    CMPA    1,DL
        46 014654   014667 601000 46                 TNZ     s:25163

     2464    25162    3              THEN CALL Z8HU$DEC_COUNT(PCOM.YOPND,1);

  25162 46 014655   000016 236000 47                 LDQ     14
        46 014656   200303 756100                    STQ     ORG1+2,,AUTO
        46 014657   200004 236100                    LDQ     @PCOM,,AUTO
        46 014660   000062 036003                    ADLQ    50,DU
        46 014661   200302 756100                    STQ     ORG1+1,,AUTO
        46 014662   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014663   000013 631400 47                 EPPR1   11
        46 014664   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 014665   000000 011000                    NOP     0
        46 014666   014700 710000 46                 TRA     s:25164

     2465    25163    3              ELSE CALL Z8HU$INCCNT(PCOM.YOPND,1);

  25163 46 014667   000016 236000 47                 LDQ     14
        46 014670   200303 756100                    STQ     ORG1+2,,AUTO
        46 014671   200004 236100                    LDQ     @PCOM,,AUTO
        46 014672   000062 036003                    ADLQ    50,DU
        46 014673   200302 756100                    STQ     ORG1+1,,AUTO
        46 014674   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014675   000013 631400 47                 EPPR1   11
        46 014676   000000 701000 xent               TSX1    Z8HU$INCCNT
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:499  
        46 014677   000000 011000                    NOP     0

     2466    25164    3            CALL Z8HU$DEC_COUNT(PCOM.FOPND,1);

  25164 46 014700   000016 236000 47                 LDQ     14
        46 014701   200303 756100                    STQ     ORG1+2,,AUTO
        46 014702   200004 236100                    LDQ     @PCOM,,AUTO
        46 014703   000037 036003                    ADLQ    31,DU
        46 014704   200302 756100                    STQ     ORG1+1,,AUTO
        46 014705   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014706   000013 631400 47                 EPPR1   11
        46 014707   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 014710   000000 011000                    NOP     0

     2467    25165    3          END;

  25165 46 014711   021307 710000 46                 TRA     s:26924

     2468    25166
     2469    25167        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:500  
     2470    25168    2   CASE(%MVDQ);

     2471    25169    2        PCOM.SOPND = PILL -> ETT.ROP;

  25169 46 014712   100002 236100                    LDQ     2,,PR1
        46 014713   200004 473500                    LDP3    @PCOM,,AUTO
        46 014714   300054 756100                    STQ     44,,PR3

     2472    25170    2        PCOM.ROPND = PILL -> ETT.LOP;

  25170 46 014715   000000 471500                    LDP1    0,,PR0
        46 014716   100001 236100                    LDQ     1,,PR1
        46 014717   300053 756100                    STQ     43,,PR3

     2473    25171    2        PCOM.JOPND = PILL -> ETT.ROP;

  25171 46 014720   000000 471500                    LDP1    0,,PR0
        46 014721   100002 236100                    LDQ     2,,PR1
        46 014722   300043 756100                    STQ     35,,PR3

     2474    25172
     2475    25173    2        CALL Z8HU$INCCNT(PILL -> ETT.ROP,1);

  25173 46 014723   000000 471500                    LDP1    0,,PR0
        46 014724   000016 236000 47                 LDQ     14
        46 014725   200303 756100                    STQ     ORG1+2,,AUTO
        46 014726   100002 634500                    EPPR4   2,,PR1
        46 014727   200302 454500                    STP4    ORG1+1,,AUTO
        46 014730   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014731   000013 631400 47                 EPPR1   11
        46 014732   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 014733   000000 011000                    NOP     0
        46 014734   021307 710000 46                 TRA     s:26924

     2476    25174
     2477    25175
     2478    25176    2   CASE(%MVDR);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:501  

     2479    25177    2        PCOM.SOPND = PILL -> ETT.ROP;

  25177 46 014735   100002 236100                    LDQ     2,,PR1
        46 014736   200004 473500                    LDP3    @PCOM,,AUTO
        46 014737   300054 756100                    STQ     44,,PR3

     2480    25178    2        PCOM.ROPND = PILL -> ETT.LOP;

  25178 46 014740   000000 471500                    LDP1    0,,PR0
        46 014741   100001 236100                    LDQ     1,,PR1
        46 014742   300053 756100                    STQ     43,,PR3

     2481    25179    2        PCOM.JOPND = PILL -> ETT.ROP;

  25179 46 014743   000000 471500                    LDP1    0,,PR0
        46 014744   100002 236100                    LDQ     2,,PR1
        46 014745   300043 756100                    STQ     35,,PR3

     2482    25180
     2483    25181    2        CALL Z8HU$INCCNT(PILL -> ETT.ROP,1);

  25181 46 014746   000000 471500                    LDP1    0,,PR0
        46 014747   000016 236000 47                 LDQ     14
        46 014750   200303 756100                    STQ     ORG1+2,,AUTO
        46 014751   100002 634500                    EPPR4   2,,PR1
        46 014752   200302 454500                    STP4    ORG1+1,,AUTO
        46 014753   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 014754   000013 631400 47                 EPPR1   11
        46 014755   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 014756   000000 011000                    NOP     0
        46 014757   021307 710000 46                 TRA     s:26924

     2484    25182
     2485    25183        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:502  
     2486    25184    2   CASE(%MVEAN, %MVEDD);

     2487    25185
     2488    25186    2        CALL FREE_REGISTER_CHECK_3 (PILL);

  25186 46 014760   200003 236100                    LDQ     @PILL,,AUTO
        46 014761   200263 756100                    STQ     LOWER$+2,,AUTO
        46 014762   022173 701000 46                 TSX1    FREE_REGISTER_CHECK_3
        46 014763   000000 011000                    NOP     0
        46 014764   021307 710000 46                 TRA     s:26924

     2489    25187
     2490    25188        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:503  
     2491    25189    2   CASE(%MVFIL);

     2492    25190
     2493    25191    2        CALL FREE_REGISTER_CHECK (PILL);

  25191 46 014765   200003 236100                    LDQ     @PILL,,AUTO
        46 014766   200263 756100                    STQ     LOWER$+2,,AUTO
        46 014767   022152 701000 46                 TSX1    FREE_REGISTER_CHECK
        46 014770   000000 011000                    NOP     0

     2494    25192
     2495    25193    2        PCOM.DABS = PILL -> MVFIL.CODE;

  25193 46 014771   200003 470500                    LDP0    @PILL,,AUTO
        46 014772   000000 471500                    LDP1    0,,PR0
        46 014773   100000 236100                    LDQ     0,,PR1
        46 014774   000777 376007                    ANQ     511,DL
        46 014775   200004 473500                    LDP3    @PCOM,,AUTO
        46 014776   300003 756100                    STQ     3,,PR3

     2496    25194             /* %MLRFIL = 0; %MRLFIL = 1 */
     2497    25195    2        CALL INSERT (PCOM.CHAR_GABS, 0, 1, PILL -> MVFIL.FILL);

  25195 46 014777   000000 471500                    LDP1    0,,PR0
        46 015000   100000 236100                    LDQ     0,,PR1
        46 015001   000022 736000                    QLS     18
        46 015002   300006 552140                    STBQ    6,'40'O,PR3
        46 015003   021307 710000 46                 TRA     s:26924

     2498    25196
     2499    25197        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:504  
     2500    25198    2   CASE(%MVID,%MVII,%MVRL);

     2501    25199
     2502    25200    2          CALL FREE_REGISTER_CHECK (PILL);

  25200 46 015004   200003 236100                    LDQ     @PILL,,AUTO
        46 015005   200263 756100                    STQ     LOWER$+2,,AUTO
        46 015006   022152 701000 46                 TSX1    FREE_REGISTER_CHECK
        46 015007   000000 011000                    NOP     0
        46 015010   021307 710000 46                 TRA     s:26924

     2503    25201
     2504    25202        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:505  
     2505    25203    2   CASE(%MVIH);

     2506    25204
     2507    25205    2          IF PILL -> ETT.ROP -> ETT.STATE >= %XR0

  25205 46 015011   100002 473500                    LDP3    2,,PR1
        46 015012   300004 220100                    LDX0    4,,PR3
        46 015013   000010 100003                    CMPX0   8,DU
        46 015014   015022 602000 46                 TNC     s:25209
        46 015015   000020 100003                    CMPX0   16,DU
        46 015016   015022 603000 46                 TRC     s:25209

     2508    25206    2          AND PILL -> ETT.ROP -> ETT.STATE <= %XR7 THEN
     2509    25207    2            PCOM.XABS = 0;

  25207 46 015017   200004 474500                    LDP4    @PCOM,,AUTO
        46 015020   400027 450100                    STZ     23,,PR4
        46 015021   021307 710000 46                 TRA     s:26924

     2510    25208    2          ELSE
     2511    25209    2            PCOM.XABS = 1;

  25209 46 015022   000001 235007                    LDA     1,DL
        46 015023   200004 474500                    LDP4    @PCOM,,AUTO
        46 015024   400027 755100                    STA     23,,PR4
        46 015025   021307 710000 46                 TRA     s:26924

     2512    25210
     2513    25211        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:506  
     2514    25212    2   CASE(%MVOD, %MVODR);

     2515    25213
     2516    25214    2            CALL FREE_REGISTER_CHECK (PILL);

  25214 46 015026   200003 236100                    LDQ     @PILL,,AUTO
        46 015027   200263 756100                    STQ     LOWER$+2,,AUTO
        46 015030   022152 701000 46                 TSX1    FREE_REGISTER_CHECK
        46 015031   000000 011000                    NOP     0

     2517    25215
     2518    25216    2            LOP_REF$ = PILL -> ETT.LOP -> ETT.REF$;

  25216 46 015032   200003 470500                    LDP0    @PILL,,AUTO
        46 015033   000000 471500                    LDP1    0,,PR0
        46 015034   100001 473500                    LDP3    1,,PR1
        46 015035   300003 236100                    LDQ     3,,PR3
        46 015036   200101 756100                    STQ     LOP_REF$,,AUTO

     2519    25217
     2520    25218    2            IF LOP_REF$ -> REF.NDSC.TN = %NDSC9 AND

  25218 46 015037   200101 474500                    LDP4    LOP_REF$,,AUTO
        46 015040   400001 236100                    LDQ     1,,PR4
        46 015041   040000 316007                    CANQ    16384,DL
        46 015042   015052 601000 46                 TNZ     s:25222
        46 015043   030000 376007                    ANQ     12288,DL
        46 015044   030000 116007                    CMPQ    12288,DL
        46 015045   015052 601000 46                 TNZ     s:25222

     2521    25219    2               LOP_REF$ -> REF.NDSC.S = %NO_SIGN THEN
     2522    25220    2              PCOM.EABS = 1;

  25220 46 015046   000001 235007                    LDA     1,DL
        46 015047   200004 475500                    LDP5    @PCOM,,AUTO
        46 015050   500004 755100                    STA     4,,PR5
        46 015051   015054 710000 46                 TRA     s:25224
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:507  

     2523    25221    2            ELSE
     2524    25222    2              PCOM.EABS = 0;

  25222 46 015052   200004 475500                    LDP5    @PCOM,,AUTO
        46 015053   500004 450100                    STZ     4,,PR5

     2525    25223
     2526    25224    2            IF LOP_REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYF THEN

  25224 46 015054   400005 471500                    LDP1    5,,PR4
        46 015055   100002 220100                    LDX0    2,,PR1
        46 015056   000013 100003                    CMPX0   11,DU
        46 015057   015062 601000 46                 TNZ     s:25227

     2527    25225    2              PCOM.IABS = 0;

  25225 46 015060   500010 450100                    STZ     8,,PR5
        46 015061   015064 710000 46                 TRA     s:25229

     2528    25226    2            ELSE
     2529    25227    2              PCOM.IABS = 1;

  25227 46 015062   000001 235007                    LDA     1,DL
        46 015063   500010 755100                    STA     8,,PR5

     2530    25228
     2531    25229    2            IF PILL -> ETT.ID = %MVOD   THEN

  25229 46 015064   000000 471500                    LDP1    0,,PR0
        46 015065   100000 220100                    LDX0    0,,PR1
        46 015066   000257 100003                    CMPX0   175,DU
        46 015067   015072 601000 46                 TNZ     s:25232

     2532    25230    2              PCOM.ZABS = 0;

  25230 46 015070   500031 450100                    STZ     25,,PR5
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:508  
        46 015071   021307 710000 46                 TRA     s:26924

     2533    25231    2            ELSE
     2534    25232    2              PCOM.ZABS = 1;

  25232 46 015072   000001 235007                    LDA     1,DL
        46 015073   500031 755100                    STA     25,,PR5
        46 015074   021307 710000 46                 TRA     s:26924

     2535    25233         %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:509  
     2536    25234    2   CASE(%MVOO, %MVOOR);

     2537    25235
     2538    25236    2        CALL FREE_REGISTER_CHECK (PILL);

  25236 46 015075   200003 236100                    LDQ     @PILL,,AUTO
        46 015076   200263 756100                    STQ     LOWER$+2,,AUTO
        46 015077   022152 701000 46                 TSX1    FREE_REGISTER_CHECK
        46 015100   000000 011000                    NOP     0

     2539    25237
     2540    25238          /*  These should never be generated unless you have ELS option  */
     2541    25239
     2542    25240    2       IF NOT COMCOM.OB.ELS                 THEN

  25240 46 015101   000026 234000 xsym               SZN     COMCOM+22
        46 015102   015107 604000 46                 TMI     s:25243

     2543    25241    2           CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);

  25241 46 015103   000061 630400 47                 EPPR0   49
        46 015104   000000 631400 47                 EPPR1   0
        46 015105   000000 701000 xent               TSX1    Z8AE$ERROR
        46 015106   000000 011000                    NOP     0

     2544    25242
     2545    25243    2        LOP_REF$ = PILL -> ETT.LOP -> ETT.REF$;

  25243 46 015107   200003 470500                    LDP0    @PILL,,AUTO
        46 015110   000000 471500                    LDP1    0,,PR0
        46 015111   100001 473500                    LDP3    1,,PR1
        46 015112   300003 236100                    LDQ     3,,PR3
        46 015113   200101 756100                    STQ     LOP_REF$,,AUTO

     2546    25244    2        IF LOP_REF$ -> REF.ST$ -> VARIABLE.TYPE = %TYF THEN

  25244 46 015114   200101 474500                    LDP4    LOP_REF$,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:510  
        46 015115   400005 475500                    LDP5    5,,PR4
        46 015116   500002 220100                    LDX0    2,,PR5
        46 015117   000013 100003                    CMPX0   11,DU
        46 015120   015134 601000 46                 TNZ     s:25251

     2547    25245    3          DO;

     2548    25246    3            IF LOP_REF$ -> REF.NDSC.S = %NO_SIGN

  25246 46 015121   400001 236100                    LDQ     1,,PR4
        46 015122   030000 376007                    ANQ     12288,DL
        46 015123   030000 116007                    CMPQ    12288,DL
        46 015124   015131 601000 46                 TNZ     s:25248

     2549    25247    3              THEN PCOM.IABS = 2;

  25247 46 015125   000002 235007                    LDA     2,DL
        46 015126   200004 476500                    LDP6    @PCOM,,AUTO
        46 015127   600010 755100                    STA     8,,PR6
        46 015130   021307 710000 46                 TRA     s:26924

     2550    25248    3              ELSE PCOM.IABS = 0;

  25248 46 015131   200004 476500                    LDP6    @PCOM,,AUTO
        46 015132   600010 450100                    STZ     8,,PR6

     2551    25249    3          END;

  25249 46 015133   021307 710000 46                 TRA     s:26924

     2552    25250    2        ELSE
     2553    25251    2          PCOM.IABS = 1;

  25251 46 015134   000001 235007                    LDA     1,DL
        46 015135   200004 476500                    LDP6    @PCOM,,AUTO
        46 015136   600010 755100                    STA     8,,PR6
        46 015137   021307 710000 46                 TRA     s:26924
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:511  

     2554    25252        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:512  
     2555    25253    2   CASE( %MVQD, %MVRD );

     2556    25254
     2557    25255    3     DO CASE( CASE_PASS );

  25255 46 015140   200005 473500                    LDP3    @CASE_PASS,,AUTO
        46 015141   300000 235100                    LDA     0,,PR3
        46 015142   000002 115007                    CMPA    2,DL
        46 015143   015145 602005 46                 TNC     s:25255+5,AL
        46 015144   021307 710000 46                 TRA     s:26924
        46 015145   015147 710000 46                 TRA     s:25258
        46 015146   015154 710000 46                 TRA     s:25261

     2558    25256
     2559    25257    3       CASE( %FIRST_PASS );

     2560    25258    3         PCOM.XABS = PILL -> ILL.CODE;

  25258 46 015147   100000 236100                    LDQ     0,,PR1
        46 015150   777777 376007                    ANQ     -1,DL
        46 015151   200004 474500                    LDP4    @PCOM,,AUTO
        46 015152   400027 756100                    STQ     23,,PR4
        46 015153   021307 710000 46                 TRA     s:26924

     2561    25259
     2562    25260    3       CASE( %SECOND_PASS );

     2563    25261    3         PCOM.SOPND = PILL -> ETT.ROP;

  25261 46 015154   100002 236100                    LDQ     2,,PR1
        46 015155   200004 474500                    LDP4    @PCOM,,AUTO
        46 015156   400054 756100                    STQ     44,,PR4

     2564    25262    3         PCOM.ROPND = PILL -> ETT.LOP;

  25262 46 015157   000000 471500                    LDP1    0,,PR0
        46 015160   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:513  
        46 015161   400053 756100                    STQ     43,,PR4

     2565    25263    3         PCOM.JOPND = PILL -> ETT.LOP;

  25263 46 015162   000000 471500                    LDP1    0,,PR0
        46 015163   100001 236100                    LDQ     1,,PR1
        46 015164   400043 756100                    STQ     35,,PR4

     2566    25264
     2567    25265    3         CALL Z8HU$INCCNT(PILL -> ETT.LOP,1);

  25265 46 015165   000000 471500                    LDP1    0,,PR0
        46 015166   000016 236000 47                 LDQ     14
        46 015167   200303 756100                    STQ     ORG1+2,,AUTO
        46 015170   100001 635500                    EPPR5   1,,PR1
        46 015171   200302 455500                    STP5    ORG1+1,,AUTO
        46 015172   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 015173   000013 631400 47                 EPPR1   11
        46 015174   000000 701000 xent               TSX1    Z8HU$INCCNT
        46 015175   000000 011000                    NOP     0

     2568    25266
     2569    25267    3     END;  /*   CASE_PASS   */

  25267 46 015176   021307 710000 46                 TRA     s:26924

     2570    25268        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:514  
     2571    25269    2    CASE(%MVPP);

     2572    25270
     2573    25271    3      DO CASE(CASE_PASS);

  25271 46 015177   200005 473500                    LDP3    @CASE_PASS,,AUTO
        46 015200   300000 235100                    LDA     0,,PR3
        46 015201   000002 115007                    CMPA    2,DL
        46 015202   015204 602005 46                 TNC     s:25271+5,AL
        46 015203   021307 710000 46                 TRA     s:26924
        46 015204   015206 710000 46                 TRA     s:25276
        46 015205   015574 710000 46                 TRA     s:25444

     2574    25272    3       CASE(%FIRST_PASS);

     2575    25273
     2576    25274               /* Get Lop state and Lop action number */
     2577    25275
     2578    25276    3        POOL_LOP_ARGP = FALSE;

  25276 46 015206   000010 450000 25                 STZ     POOL_LOP_ARGP

     2579    25277
     2580    25278             %FISH(TRIAD = PILL -> ETT.LOP,
     2581    25279                   RTN   = ST$$);

  25281 46 015207   100001 236100                    LDQ     1,,PR1
        46 015210   200256 756100                    STQ     ST$$,,AUTO

  25282 46 015211   200256 474500                    LDP4    ST$$,,AUTO
        46 015212   400000 220100                    LDX0    0,,PR4
        46 015213   000751 100003                    CMPX0   489,DU
        46 015214   015224 603000 46                 TRC     s:25288

  25283 46 015215   200256 470500                    LDP0    ST$$,,AUTO
        46 015216   000001 236100                    LDQ     1,,PR0
        46 015217   200256 756100                    STQ     ST$$,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:515  

  25284 46 015220   200256 470500                    LDP0    ST$$,,AUTO
        46 015221   000000 220100                    LDX0    0,,PR0
        46 015222   000751 100003                    CMPX0   489,DU
        46 015223   015215 602000 46                 TNC     s:25283

     2582    25287
     2583    25288    3        LTS$$ = ST$$ -> VARIABLE.LTS$;

  25288 46 015224   200256 470500                    LDP0    ST$$,,AUTO
        46 015225   000005 236100                    LDQ     5,,PR0
        46 015226   200255 756100                    STQ     LTS$$,,AUTO

     2584    25289
     2585    25290    3        IF NOT ST$$ -> VARIABLE.B.COMPILER_CREATED OR

  25290 46 015227   000003 236100                    LDQ     3,,PR0
        46 015230   100000 316003                    CANQ    32768,DU
        46 015231   015244 600000 46                 TZE     s:25294
        46 015232   200255 236100                    LDQ     LTS$$,,AUTO
        46 015233   000005 116000 47                 CMPQ    5
        46 015234   015244 600000 46                 TZE     s:25294
        46 015235   200255 471500                    LDP1    LTS$$,,AUTO
        46 015236   100000 220100                    LDX0    0,,PR1
        46 015237   001066 100003                    CMPX0   566,DU
        46 015240   015244 601000 46                 TNZ     s:25294
        46 015241   100007 236100                    LDQ     7,,PR1
        46 015242   000005 116000 47                 CMPQ    5
        46 015243   015247 601000 46                 TNZ     s:25297

     2586    25291    3           LTS$$ = ADDR(NIL) OR
     2587    25292    3           LTS$$ -> LTS.ID ~= %BASE_LTS OR
     2588    25293    3           LTS$$ -> BASE_LTS.ARGP$ = ADDR(NIL) THEN
     2589    25294    3          MVPP.ACTION# = %LOP_ST;

  25294 46 015244   000002 235007                    LDA     2,DL
        46 015245   000001 755000 45                 STA     MVPP+1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:516  
        46 015246   015274 710000 46                 TRA     ROP_CASE

     2590    25295    3        ELSE
     2591    25296    4          DO;

     2592    25297    4            MVPP.LOP_ARGP$ = LTS$$ -> BASE_LTS.ARGP$;

  25297 46 015247   000002 756000 45                 STQ     MVPP+2

     2593    25298    4            IF MVPP.LOP_ARGP$ -> ETT.STATE >= %PR0 AND

  25298 46 015250   000002 473400 45                 LDP3    MVPP+2
        46 015251   300004 220100                    LDX0    4,,PR3
        46 015252   000024 100003                    CMPX0   20,DU
        46 015253   015272 602000 46                 TNC     s:25319
        46 015254   000034 100003                    CMPX0   28,DU
        46 015255   015272 603000 46                 TRC     s:25319

     2594    25299    4               MVPP.LOP_ARGP$ -> ETT.STATE <= %PR7 THEN
     2595    25300    5              DO;

     2596    25301                       /* If Lop ARGP is on the ESC_LIST, the register */
     2597    25302                       /* is dedicated to this ARGP forever and should */
     2598    25303                       /* not be relieved, else the prime is pooled    */
     2599    25304                       /* and its state is reset.                      */
     2600    25305
     2601    25306    5                IF MVPP.LOP_ARGP$ -> ETT.B.ESC_LIST THEN

  25306 46 015256   300004 236100                    LDQ     4,,PR3
        46 015257   400000 316007                    CANQ    -131072,DL
        46 015260   015265 600000 46                 TZE     s:25313

     2602    25307    6                  DO;

     2603    25308    6                    MVPP.ACTION# = %LOP_ARGP_PR;

  25308 46 015261   000001 450000 45                 STZ     MVPP+1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:517  

     2604    25309    6                    MVPP.STAR$ = MVPP.LOP_ARGP$;

  25309 46 015262   000002 236000 45                 LDQ     MVPP+2
        46 015263   000000 756000 45                 STQ     MVPP

     2605    25310    6                  END;

  25310 46 015264   015274 710000 46                 TRA     ROP_CASE

     2606    25311    5                ELSE
     2607    25312    6                  DO;

     2608    25313    6                    MVPP.ACTION# = %LOP_ARGP_NO_PR;

  25313 46 015265   000001 235007                    LDA     1,DL
        46 015266   000001 755000 45                 STA     MVPP+1

     2609    25314
     2610    25315    6                    POOL_LOP_ARGP = TRUE;

  25315 46 015267   400000 236003                    LDQ     -131072,DU
        46 015270   000010 756000 25                 STQ     POOL_LOP_ARGP

     2611    25316    6                  END;

     2612    25317    5              END;

  25317 46 015271   015274 710000 46                 TRA     ROP_CASE

     2613    25318    4            ELSE
     2614    25319    4              MVPP.ACTION# = %LOP_ARGP_NO_PR;

  25319 46 015272   000001 235007                    LDA     1,DL
        46 015273   000001 755000 45                 STA     MVPP+1

     2615    25320    4          END;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:518  

     2616    25321
     2617    25322               /* get Rop state and Rop action number, add Rop action */
     2618    25323               /* number to the Lop action number and then used the   */
     2619    25324               /* sum to retrieve the JMPDV value in array MVPP_VEC   */
     2620    25325
     2621    25326    3    ROP_CASE:
     2622    25327    4      DO;

  25327 46 015274                       ROP_CASE     null
     2623    25328    4        IF PILL -> ILL.ROP -> ETT.ID = %ADDR THEN

  25328 46 015274   200003 471500                    LDP1    @PILL,,AUTO
        46 015275   100000 473500                    LDP3    0,,PR1
        46 015276   300002 474500                    LDP4    2,,PR3
        46 015277   400000 220100                    LDX0    0,,PR4
        46 015300   000175 100003                    CMPX0   125,DU
        46 015301   015326 601000 46                 TNZ     s:25351

     2624    25329    5          DO;

     2625    25330    5            IF PILL -> ILL.ROP -> ETT.REF$ = ADDR(NIL) AND

  25330 46 015302   400003 236100                    LDQ     3,,PR4
        46 015303   000005 116000 47                 CMPQ    5
        46 015304   015415 601000 46                 TNZ     s:25393
        46 015305   000001 235000 45                 LDA     MVPP+1
        46 015306   015415 601000 46                 TNZ     s:25393
        46 015307   400004 221100                    LDX1    4,,PR4
        46 015310   000024 101003                    CMPX1   20,DU
        46 015311   015415 602000 46                 TNC     s:25393
        46 015312   000034 101003                    CMPX1   28,DU
        46 015313   015415 603000 46                 TRC     s:25393

     2626    25331    5              MVPP.ACTION# = %LOP_ARGP_PR AND
     2627    25332    5              PILL -> ILL.ROP -> ETT.STATE >= %PR0 AND
     2628    25333    5              PILL -> ILL.ROP -> ETT.STATE <= %PR7 THEN
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:519  
     2629    25334    6              DO;

     2630    25335    6                IF POOL_LOP_ARGP AND PILL -> ILL.ROP -> ETT.STATE =

  25335 46 015314   000010 234000 25                 SZN     POOL_LOP_ARGP
        46 015315   015325 605000 46                 TPL     s:25344
        46 015316   000002 475400 45                 LDP5    MVPP+2
        46 015317   500004 101100                    CMPX1   4,,PR5
        46 015320   015325 601000 46                 TNZ     s:25344

     2631    25336    6                   MVPP.LOP_ARGP$ -> ETT.STATE THEN
     2632    25337    7                  DO;

     2633    25338    7                    MVPP.ACTION# = %LOP_ROP_ALIAS;

  25338 46 015321   000025 235007                    LDA     21,DL
        46 015322   000001 755000 45                 STA     MVPP+1

     2634    25339    7                    POOL_LOP_ARGP = FALSE;

  25339 46 015323   000010 450000 25                 STZ     POOL_LOP_ARGP

     2635    25340    7                  END;

  25340 46 015324   015325 710000 46                 TRA     s:25344

     2636    25341    6                ELSE
     2637    25342    6                  MVPP.ACTION# = MVPP.ACTION# + %ROP_ADDR_PR;

     2638    25343
     2639    25344    6                EXIT ROP_CASE;

  25344 46 015325   015502 710000 46                 TRA     s:25417

     2640    25345    6              END;
     2641    25346    5          END;
     2642    25347    4        ELSE
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:520  
     2643    25348    5          DO;

     2644    25349                 %FISH (TRIAD = PILL -> ETT.ROP, RTN = ST$$);

  25351 46 015326   300002 236100                    LDQ     2,,PR3
        46 015327   200256 756100                    STQ     ST$$,,AUTO

  25352 46 015330   200256 470500                    LDP0    ST$$,,AUTO
        46 015331   000000 221100                    LDX1    0,,PR0
        46 015332   000751 101003                    CMPX1   489,DU
        46 015333   015343 603000 46                 TRC     s:25358

  25353 46 015334   200256 470500                    LDP0    ST$$,,AUTO
        46 015335   000001 236100                    LDQ     1,,PR0
        46 015336   200256 756100                    STQ     ST$$,,AUTO

  25354 46 015337   200256 470500                    LDP0    ST$$,,AUTO
        46 015340   000000 220100                    LDX0    0,,PR0
        46 015341   000751 100003                    CMPX0   489,DU
        46 015342   015334 602000 46                 TNC     s:25353

     2645    25357
     2646    25358    5            LTS$$ = ST$$ -> VARIABLE.LTS$;

  25358 46 015343   000005 236100                    LDQ     5,,PR0
        46 015344   200255 756100                    STQ     LTS$$,,AUTO

     2647    25359
     2648    25360    5            IF ST$$ -> VARIABLE.B.COMPILER_CREATED AND

  25360 46 015345   000003 236100                    LDQ     3,,PR0
        46 015346   100000 316003                    CANQ    32768,DU
        46 015347   015415 600000 46                 TZE     s:25393
        46 015350   200255 236100                    LDQ     LTS$$,,AUTO
        46 015351   000005 116000 47                 CMPQ    5
        46 015352   015415 600000 46                 TZE     s:25393
        46 015353   200255 471500                    LDP1    LTS$$,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:521  
        46 015354   100000 220100                    LDX0    0,,PR1
        46 015355   001066 100003                    CMPX0   566,DU
        46 015356   015415 601000 46                 TNZ     s:25393
        46 015357   100007 236100                    LDQ     7,,PR1
        46 015360   000005 116000 47                 CMPQ    5
        46 015361   015415 600000 46                 TZE     s:25393

     2649    25361    5               LTS$$ ~= ADDR(NIL) AND
     2650    25362    5              LTS$$ -> LTS.ID = %BASE_LTS AND
     2651    25363    5              LTS$$ -> BASE_LTS.ARGP$ ~= ADDR(NIL) THEN
     2652    25364    6              DO;

     2653    25365    6                MVPP.ROP_ARGP$ = LTS$$ -> BASE_LTS.ARGP$;

  25365 46 015362   000003 756000 45                 STQ     MVPP+3

     2654    25366
     2655    25367    6                IF MVPP.ROP_ARGP$ -> ETT.STATE >= %PR0 AND

  25367 46 015363   000003 473400 45                 LDP3    MVPP+3
        46 015364   300004 220100                    LDX0    4,,PR3
        46 015365   000024 100003                    CMPX0   20,DU
        46 015366   015410 602000 46                 TNC     s:25385
        46 015367   000034 100003                    CMPX0   28,DU
        46 015370   015410 603000 46                 TRC     s:25385

     2656    25368    6                   MVPP.ROP_ARGP$ -> ETT.STATE <= %PR7 THEN
     2657    25369    7                  DO;

     2658    25370    7                    IF MVPP.ACTION# ~= %LOP_ARGP_PR THEN

  25370 46 015371   000001 235000 45                 LDA     MVPP+1
        46 015372   015374 600000 46                 TZE     s:25373

     2659    25371    7                      MVPP.STAR$ = MVPP.ROP_ARGP$;

  25371 46 015373   000000 756000 45                 STQ     MVPP
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:522  

     2660    25372
     2661    25373    7                    IF POOL_LOP_ARGP AND MVPP.ROP_ARGP$ -> ETT.STATE =

  25373 46 015374   000010 234000 25                 SZN     POOL_LOP_ARGP
        46 015375   015405 605000 46                 TPL     s:25380
        46 015376   000002 474400 45                 LDP4    MVPP+2
        46 015377   400004 100100                    CMPX0   4,,PR4
        46 015400   015405 601000 46                 TNZ     s:25380

     2662    25374    7                       MVPP.LOP_ARGP$ -> ETT.STATE THEN
     2663    25375    8                      DO;

     2664    25376    8                        MVPP.ACTION# = %LOP_ROP_ALIAS;

  25376 46 015401   000025 235007                    LDA     21,DL
        46 015402   000001 755000 45                 STA     MVPP+1

     2665    25377    8                        POOL_LOP_ARGP = FALSE;

  25377 46 015403   000010 450000 25                 STZ     POOL_LOP_ARGP

     2666    25378    8                      END;

  25378 46 015404   015407 710000 46                 TRA     s:25382

     2667    25379    7                    ELSE
     2668    25380    7                      MVPP.ACTION# =  MVPP.ACTION# + %ROP_ARGP_PR;

  25380 46 015405   000003 236007                    LDQ     3,DL
        46 015406   000001 056000 45                 ASQ     MVPP+1

     2669    25381
     2670    25382    7                    EXIT ROP_CASE;

  25382 46 015407   015502 710000 46                 TRA     s:25417

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:523  
     2671    25383    7                  END;
     2672    25384    6                ELSE
     2673    25385    6                  IF MVPP.ACTION# = %LOP_ARGP_PR THEN

  25385 46 015410   000001 235000 45                 LDA     MVPP+1
        46 015411   015415 601000 46                 TNZ     s:25393

     2674    25386    7                    DO;

     2675    25387    7                      MVPP.ACTION# = MVPP.ACTION# + %ROP_ARGP_NO_PR;

  25387 46 015412   000006 236007                    LDQ     6,DL
        46 015413   000001 056000 45                 ASQ     MVPP+1

     2676    25388    7                      EXIT ROP_CASE;

  25388 46 015414   015502 710000 46                 TRA     s:25417

     2677    25389    7                    END;
     2678    25390    6              END;
     2679    25391    5          END;     /* ROP is not %ADDR */
     2680    25392
     2681    25393    5        DO CASE (PILL -> ILL.ROP -> ETT.STATE);

  25393 46 015415   200003 471500                    LDP1    @PILL,,AUTO
        46 015416   100000 473500                    LDP3    0,,PR1
        46 015417   300002 474500                    LDP4    2,,PR3
        46 015420   400004 236100                    LDQ     4,,PR4
        46 015421   000022 772000                    QRL     18
        46 015422   000005 136007                    SBLQ    5,DL
        46 015423   000027 116007                    CMPQ    23,DL
        46 015424   015426 602006 46                 TNC     s:25393+9,QL
        46 015425   015500 710000 46                 TRA     s:25411
        46 015426   015455 710000 46                 TRA     s:25395
        46 015427   015460 710000 46                 TRA     s:25398
        46 015430   015500 710000 46                 TRA     s:25411
        46 015431   015500 710000 46                 TRA     s:25411
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:524  
        46 015432   015500 710000 46                 TRA     s:25411
        46 015433   015500 710000 46                 TRA     s:25411
        46 015434   015500 710000 46                 TRA     s:25411
        46 015435   015500 710000 46                 TRA     s:25411
        46 015436   015500 710000 46                 TRA     s:25411
        46 015437   015500 710000 46                 TRA     s:25411
        46 015440   015500 710000 46                 TRA     s:25411
        46 015441   015500 710000 46                 TRA     s:25411
        46 015442   015500 710000 46                 TRA     s:25411
        46 015443   015500 710000 46                 TRA     s:25411
        46 015444   015500 710000 46                 TRA     s:25411
        46 015445   015463 710000 46                 TRA     s:25401
        46 015446   015463 710000 46                 TRA     s:25401
        46 015447   015463 710000 46                 TRA     s:25401
        46 015450   015463 710000 46                 TRA     s:25401
        46 015451   015463 710000 46                 TRA     s:25401
        46 015452   015463 710000 46                 TRA     s:25401
        46 015453   015463 710000 46                 TRA     s:25401
        46 015454   015463 710000 46                 TRA     s:25401

     2682    25394    5          CASE(%ARA);

     2683    25395    5              MVPP.ACTION# = MVPP.ACTION# + %ROP_REGULAR_ARA;

  25395 46 015455   000014 236007                    LDQ     12,DL
        46 015456   000001 056000 45                 ASQ     MVPP+1
        46 015457   015502 710000 46                 TRA     s:25417

     2684    25396
     2685    25397    5          CASE(%ARQ);

     2686    25398    5              MVPP.ACTION# = MVPP.ACTION# + %ROP_REGULAR_ARQ;

  25398 46 015460   000017 236007                    LDQ     15,DL
        46 015461   000001 056000 45                 ASQ     MVPP+1
        46 015462   015502 710000 46                 TRA     s:25417

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:525  
     2687    25399
     2688    25400    5          CASE(%PR0,%PR1,%PR2,%PR3,%PR4,%PR5,%PR6,%PR7);

     2689    25401    5              IF POOL_LOP_ARGP AND PILL -> ILL.ROP -> ETT.STATE =

  25401 46 015463   000010 234000 25                 SZN     POOL_LOP_ARGP
        46 015464   015475 605000 46                 TPL     s:25408
        46 015465   400004 220100                    LDX0    4,,PR4
        46 015466   000002 475400 45                 LDP5    MVPP+2
        46 015467   500004 100100                    CMPX0   4,,PR5
        46 015470   015475 601000 46                 TNZ     s:25408

     2690    25402    5                 MVPP.LOP_ARGP$ -> ETT.STATE THEN
     2691    25403    6                DO;

     2692    25404    6                  MVPP.ACTION# = %LOP_ROP_ALIAS;

  25404 46 015471   000025 235007                    LDA     21,DL
        46 015472   000001 755000 45                 STA     MVPP+1

     2693    25405    6                  POOL_LOP_ARGP = FALSE;

  25405 46 015473   000010 450000 25                 STZ     POOL_LOP_ARGP

     2694    25406    6                END;

  25406 46 015474   015502 710000 46                 TRA     s:25417

     2695    25407    5              ELSE
     2696    25408    5                MVPP.ACTION# = MVPP.ACTION# + %ROP_REGULAR_PR;

  25408 46 015475   000011 236007                    LDQ     9,DL
        46 015476   000001 056000 45                 ASQ     MVPP+1
        46 015477   015502 710000 46                 TRA     s:25417

     2697    25409
     2698    25410    5          CASE(ELSE);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:526  

     2699    25411    5              MVPP.ACTION# = MVPP.ACTION# + %ROP_REGULAR_ST;

  25411 46 015500   000022 236007                    LDQ     18,DL
        46 015501   000001 056000 45                 ASQ     MVPP+1

     2700    25412
     2701    25413    5        END; /* DO CASE */

     2702    25414    4      END ROP_CASE;

     2703    25415
     2704    25416
     2705    25417    4        DO CASE(MVPP.ACTION#);

  25417 46 015502   000001 235000 45                 LDA     MVPP+1
        46 015503   000012 115007                    CMPA    10,DL
        46 015504   015506 602005 46                 TNC     s:25417+4,AL
        46 015505   015554 710000 46                 TRA     s:25432
        46 015506   015542 710000 46                 TRA     s:25428
        46 015507   015554 710000 46                 TRA     s:25432
        46 015510   015554 710000 46                 TRA     s:25432
        46 015511   015520 710000 46                 TRA     s:25420
        46 015512   015530 710000 46                 TRA     s:25424
        46 015513   015530 710000 46                 TRA     s:25424
        46 015514   015542 710000 46                 TRA     s:25428
        46 015515   015554 710000 46                 TRA     s:25432
        46 015516   015554 710000 46                 TRA     s:25432
        46 015517   015542 710000 46                 TRA     s:25428

     2706    25418
     2707    25419    4          CASE(3);

     2708    25420    4            IF MVPP.LOP_ARGP$ -> ETT.STATE = MVPP.ROP_ARGP$ -> ETT.STATE THEN

  25420 46 015520   000002 471400 45                 LDP1    MVPP+2
        46 015521   100004 220100                    LDX0    4,,PR1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:527  
        46 015522   000003 473400 45                 LDP3    MVPP+3
        46 015523   300004 100100                    CMPX0   4,,PR3
        46 015524   015567 601000 46                 TNZ     s:25440

     2709    25421    4              MVPP.ACTION# = %LOP_ROP_ALIAS;

  25421 46 015525   000025 236007                    LDQ     21,DL
        46 015526   000001 756000 45                 STQ     MVPP+1
        46 015527   015567 710000 46                 TRA     s:25440

     2710    25422
     2711    25423    4          CASE(4,5);

     2712    25424    4            IF MVPP.ROP_ARGP$ -> ETT.STATE = PILL -> ILL.LOP -> ETT.STATE THEN

  25424 46 015530   200003 471500                    LDP1    @PILL,,AUTO
        46 015531   100000 473500                    LDP3    0,,PR1
        46 015532   300001 474500                    LDP4    1,,PR3
        46 015533   000003 475400 45                 LDP5    MVPP+3
        46 015534   500004 220100                    LDX0    4,,PR5
        46 015535   400004 100100                    CMPX0   4,,PR4
        46 015536   015567 601000 46                 TNZ     s:25440

     2713    25425    4              MVPP.ACTION# = %LOP_ROP_ALIAS;

  25425 46 015537   000025 236007                    LDQ     21,DL
        46 015540   000001 756000 45                 STQ     MVPP+1
        46 015541   015567 710000 46                 TRA     s:25440

     2714    25426
     2715    25427    4          CASE(0,6,9);

     2716    25428    4            IF MVPP.LOP_ARGP$ -> ETT.STATE = PILL -> ILL.ROP -> ETT.STATE THEN

  25428 46 015542   200003 471500                    LDP1    @PILL,,AUTO
        46 015543   100000 473500                    LDP3    0,,PR1
        46 015544   300002 474500                    LDP4    2,,PR3
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:528  
        46 015545   000002 475400 45                 LDP5    MVPP+2
        46 015546   500004 220100                    LDX0    4,,PR5
        46 015547   400004 100100                    CMPX0   4,,PR4
        46 015550   015567 601000 46                 TNZ     s:25440

     2717    25429    4              MVPP.ACTION# = %LOP_ROP_ALIAS;

  25429 46 015551   000025 236007                    LDQ     21,DL
        46 015552   000001 756000 45                 STQ     MVPP+1
        46 015553   015567 710000 46                 TRA     s:25440

     2718    25430
     2719    25431    4          CASE(ELSE);

     2720    25432    4            IF PILL -> ILL.LOP -> ETT.STATE > %REF_T AND

  25432 46 015554   200003 471500                    LDP1    @PILL,,AUTO
        46 015555   100000 473500                    LDP3    0,,PR1
        46 015556   300001 474500                    LDP4    1,,PR3
        46 015557   400004 220100                    LDX0    4,,PR4
        46 015560   000005 100003                    CMPX0   5,DU
        46 015561   015567 602000 46                 TNC     s:25440
        46 015562   300002 475500                    LDP5    2,,PR3
        46 015563   500004 100100                    CMPX0   4,,PR5
        46 015564   015567 601000 46                 TNZ     s:25440

     2721    25433    4              PILL -> ILL.LOP -> ETT.STATE = PILL -> ILL.ROP -> ETT.STATE
     2722    25434    4              THEN
     2723    25435    4                MVPP.ACTION# = %LOP_ROP_ALIAS;

  25435 46 015565   000025 236007                    LDQ     21,DL
        46 015566   000001 756000 45                 STQ     MVPP+1

     2724    25436
     2725    25437    4        END; /* DO CASE */

     2726    25438
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:529  
     2727    25439
     2728    25440    3        PCOM.XABS = MVPP_VEC(MVPP.ACTION#);

  25440 46 015567   000001 720000 45                 LXL0    MVPP+1
        46 015570   000011 235010 25                 LDA     MVPP_VEC,X0
        46 015571   200004 471500                    LDP1    @PCOM,,AUTO
        46 015572   100027 755100                    STA     23,,PR1
        46 015573   021307 710000 46                 TRA     s:26924

     2729    25441
     2730    25442    3      CASE(%SECOND_PASS);

     2731    25443
     2732    25444    3        IF POOL_LOP_ARGP THEN

  25444 46 015574   000010 234000 25                 SZN     POOL_LOP_ARGP
        46 015575   015606 605000 46                 TPL     s:25450

     2733    25445    4          DO;

     2734    25446    4            CALL Z8HU$POOL_PRIME(MVPP.LOP_ARGP$);

  25446 46 015576   000100 630400 47                 EPPR0   64
        46 015577   000000 631400 47                 EPPR1   0
        46 015600   000000 701000 xent               TSX1    Z8HU$POOL_PRIME
        46 015601   000000 011000                    NOP     0

     2735    25447    4            CALL Z8HU$POOL(MVPP.LOP_ARGP$);

  25447 46 015602   000100 630400 47                 EPPR0   64
        46 015603   000000 631400 47                 EPPR1   0
        46 015604   000000 701000 xent               TSX1    Z8HU$POOL
        46 015605   000000 011000                    NOP     0

     2736    25448    4          END;

     2737    25449
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:530  
     2738    25450    4        DO CASE(MVPP.ACTION#);

  25450 46 015606   000001 235000 45                 LDA     MVPP+1
        46 015607   000023 115007                    CMPA    19,DL
        46 015610   015612 602005 46                 TNC     s:25450+4,AL
        46 015611   021307 710000 46                 TRA     s:26924
        46 015612   015635 710000 46                 TRA     s:25453
        46 015613   015732 710000 46                 TRA     s:25484
        46 015614   015770 710000 46                 TRA     s:25498
        46 015615   015635 710000 46                 TRA     s:25453
        46 015616   015732 710000 46                 TRA     s:25484
        46 015617   015770 710000 46                 TRA     s:25498
        46 015620   015635 710000 46                 TRA     s:25453
        46 015621   016020 710000 46                 TRA     s:25509
        46 015622   016020 710000 46                 TRA     s:25509
        46 015623   015635 710000 46                 TRA     s:25453
        46 015624   015732 710000 46                 TRA     s:25484
        46 015625   015770 710000 46                 TRA     s:25498
        46 015626   015635 710000 46                 TRA     s:25453
        46 015627   016020 710000 46                 TRA     s:25509
        46 015630   016020 710000 46                 TRA     s:25509
        46 015631   015635 710000 46                 TRA     s:25453
        46 015632   016020 710000 46                 TRA     s:25509
        46 015633   016020 710000 46                 TRA     s:25509
        46 015634   015635 710000 46                 TRA     s:25453

     2739    25451    4          CASE(0,3,6,9,12,15,18);

     2740    25452                   /* relieve the triads from the register just updated */
     2741    25453    4              P$ = RAT.PRIMES(MVPP.LOP_ARGP$ -> ETT.STATE);

  25453 46 015635   000002 470400 45                 LDP0    MVPP+2
        46 015636   000004 220100                    LDX0    4,,PR0
        46 015637   000004 020100                    ADLX0   4,,PR0
        46 015640   000000 636010                    EAQ     0,X0
        46 015641   000021 772000                    QRL     17
        46 015642   000000 236006 12                 LDQ     RAT,QL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:531  
        46 015643   200064 756100                    STQ     P$,,AUTO

     2742    25454
     2743    25455    5              DO WHILE ( P$ ~= ADDR(NIL) );

  25455 46 015644   015700 710000 46                 TRA     s:25468

     2744    25456    5                P2$ = P$ -> PRIME.NEXT;

  25456 46 015645   200064 470500                    LDP0    P$,,AUTO
        46 015646   000003 236100                    LDQ     3,,PR0
        46 015647   200257 756100                    STQ     P2$,,AUTO

     2745    25457
     2746    25458    5                IF P$ -> PRIME.TRIAD ~= MVPP.LOP_ARGP$ THEN

  25458 46 015650   000001 236100                    LDQ     1,,PR0
        46 015651   000002 116000 45                 CMPQ    MVPP+2
        46 015652   015676 600000 46                 TZE     s:25467

     2747    25459    6                  DO;

     2748    25460    6                    CALL Z8HU$POOL_PRIME(P$);

  25460 46 015653   200064 631500                    EPPR1   P$,,AUTO
        46 015654   200302 451500                    STP1    ORG1+1,,AUTO
        46 015655   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 015656   000000 631400 47                 EPPR1   0
        46 015657   000000 701000 xent               TSX1    Z8HU$POOL_PRIME
        46 015660   000000 011000                    NOP     0

     2749    25461    6                    IF P$ -> PRIME.TRIAD -> ETT.ID = %ARGP OR

  25461 46 015661   200064 470500                    LDP0    P$,,AUTO
        46 015662   000001 471500                    LDP1    1,,PR0
        46 015663   100000 220100                    LDX0    0,,PR1
        46 015664   000016 100003                    CMPX0   14,DU
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:532  
        46 015665   015670 600000 46                 TZE     s:25463
        46 015666   000017 100003                    CMPX0   15,DU
        46 015667   015676 601000 46                 TNZ     s:25467

     2750    25462    6                       P$ -> PRIME.TRIAD -> ETT.ID = %ESC THEN
     2751    25463    6                      CALL Z8HU$POOL(P$);

  25463 46 015670   200064 633500                    EPPR3   P$,,AUTO
        46 015671   200302 453500                    STP3    ORG1+1,,AUTO
        46 015672   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 015673   000000 631400 47                 EPPR1   0
        46 015674   000000 701000 xent               TSX1    Z8HU$POOL
        46 015675   000000 011000                    NOP     0

     2752    25464    6                  END;

     2753    25465
     2754    25466
     2755    25467    5                P$ = P2$;

  25467 46 015676   200257 236100                    LDQ     P2$,,AUTO
        46 015677   200064 756100                    STQ     P$,,AUTO

     2756    25468    5              END;

  25468 46 015700   000005 116000 47                 CMPQ    5
        46 015701   015645 601000 46                 TNZ     s:25456

     2757    25469
     2758    25470    4              IF MVPP.ACTION# = 6 THEN

  25470 46 015702   000001 235000 45                 LDA     MVPP+1
        46 015703   000006 115007                    CMPA    6,DL
        46 015704   021307 601000 46                 TNZ     s:26924

     2759    25471    5                DO;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:533  
     2760    25472    5                  REGID = MVPP.LOP_ARGP$ -> ETT.STATE;

  25472 46 015705   000002 470400 45                 LDP0    MVPP+2
        46 015706   000004 236100                    LDQ     4,,PR0
        46 015707   000022 772000                    QRL     18
        46 015710   200006 756100                    STQ     REGID,,AUTO

     2761    25473
     2762    25474    5                  CALL Z8HG$USE_REGISTER(MVPP.ROP_ARGP$, REGID);

  25474 46 015711   200006 631500                    EPPR1   REGID,,AUTO
        46 015712   200303 451500                    STP1    ORG1+2,,AUTO
        46 015713   000101 236000 47                 LDQ     65
        46 015714   200302 756100                    STQ     ORG1+1,,AUTO
        46 015715   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 015716   000013 631400 47                 EPPR1   11
        46 015717   000000 701000 xent               TSX1    Z8HG$USE_REGISTER
        46 015720   000000 011000                    NOP     0

     2763    25475
     2764    25476    5                  IF MVPP.ROP_ARGP$ -> ETT.REF$ = ADDR(NIL) THEN

  25476 46 015721   000003 470400 45                 LDP0    MVPP+3
        46 015722   000003 236100                    LDQ     3,,PR0
        46 015723   000005 116000 47                 CMPQ    5
        46 015724   021307 601000 46                 TNZ     s:26924

     2765    25477    5                    CALL Z8HI$BURST(MVPP.ROP_ARGP$,

  25477 46 015725   000102 630400 47                 EPPR0   66
        46 015726   000013 631400 47                 EPPR1   11
        46 015727   000000 701000 xent               TSX1    Z8HI$BURST
        46 015730   000000 011000                    NOP     0

     2766    25478    5                                    PEPD(%TRIAD));
     2767    25479
     2768    25480    5                END;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:534  

  25480 46 015731   021307 710000 46                 TRA     s:26924

     2769    25481
     2770    25482    4          CASE(1,4,10);

     2771    25483
     2772    25484    4              IF MVPP.ACTION# = 4 THEN

  25484 46 015732   000004 115007                    CMPA    4,DL
        46 015733   015741 601000 46                 TNZ     s:25487

     2773    25485    4                REGID = MVPP.ROP_ARGP$ -> ETT.STATE;

  25485 46 015734   000003 470400 45                 LDP0    MVPP+3
        46 015735   000004 236100                    LDQ     4,,PR0
        46 015736   000022 772000                    QRL     18
        46 015737   200006 756100                    STQ     REGID,,AUTO
        46 015740   015747 710000 46                 TRA     s:25489

     2774    25486    4              ELSE
     2775    25487    4                 REGID = PILL -> ILL.ROP -> ETT.STATE;

  25487 46 015741   200003 470500                    LDP0    @PILL,,AUTO
        46 015742   000000 471500                    LDP1    0,,PR0
        46 015743   100002 473500                    LDP3    2,,PR1
        46 015744   300004 236100                    LDQ     4,,PR3
        46 015745   000022 772000                    QRL     18
        46 015746   200006 756100                    STQ     REGID,,AUTO

     2776    25488
     2777    25489    4              CALL Z8HG$USE_REGISTER(MVPP.LOP_ARGP$, REGID);

  25489 46 015747   200006 630500                    EPPR0   REGID,,AUTO
        46 015750   200303 450500                    STP0    ORG1+2,,AUTO
        46 015751   000100 236000 47                 LDQ     64
        46 015752   200302 756100                    STQ     ORG1+1,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:535  
        46 015753   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 015754   000013 631400 47                 EPPR1   11
        46 015755   000000 701000 xent               TSX1    Z8HG$USE_REGISTER
        46 015756   000000 011000                    NOP     0

     2778    25490
     2779    25491    4              IF MVPP.LOP_ARGP$ -> ETT.REF$ = ADDR(NIL) THEN

  25491 46 015757   000002 470400 45                 LDP0    MVPP+2
        46 015760   000003 236100                    LDQ     3,,PR0
        46 015761   000005 116000 47                 CMPQ    5
        46 015762   021307 601000 46                 TNZ     s:26924

     2780    25492    4                CALL Z8HI$BURST(MVPP.LOP_ARGP$,

  25492 46 015763   000104 630400 47                 EPPR0   68
        46 015764   000013 631400 47                 EPPR1   11
        46 015765   000000 701000 xent               TSX1    Z8HI$BURST
        46 015766   000000 011000                    NOP     0
        46 015767   021307 710000 46                 TRA     s:26924

     2781    25493    4                                PEPD(%TRIAD));
     2782    25494
     2783    25495
     2784    25496    4          CASE(2,5,11);

     2785    25497
     2786    25498    4              IF MVPP.ACTION# = 5 THEN

  25498 46 015770   000005 115007                    CMPA    5,DL
        46 015771   015777 601000 46                 TNZ     s:25501

     2787    25499    4                REGID = MVPP.ROP_ARGP$ -> ETT.STATE;

  25499 46 015772   000003 470400 45                 LDP0    MVPP+3
        46 015773   000004 236100                    LDQ     4,,PR0
        46 015774   000022 772000                    QRL     18
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:536  
        46 015775   200006 756100                    STQ     REGID,,AUTO
        46 015776   016005 710000 46                 TRA     s:25503

     2788    25500    4              ELSE
     2789    25501    4                REGID = PILL -> ILL.ROP -> ETT.STATE;

  25501 46 015777   200003 470500                    LDP0    @PILL,,AUTO
        46 016000   000000 471500                    LDP1    0,,PR0
        46 016001   100002 473500                    LDP3    2,,PR1
        46 016002   300004 236100                    LDQ     4,,PR3
        46 016003   000022 772000                    QRL     18
        46 016004   200006 756100                    STQ     REGID,,AUTO

     2790    25502
     2791    25503    4              CALL Z8HG$USE_REGISTER(PILL -> ILL.LOP, REGID);

  25503 46 016005   200003 470500                    LDP0    @PILL,,AUTO
        46 016006   000000 471500                    LDP1    0,,PR0
        46 016007   200006 633500                    EPPR3   REGID,,AUTO
        46 016010   200303 453500                    STP3    ORG1+2,,AUTO
        46 016011   100001 634500                    EPPR4   1,,PR1
        46 016012   200302 454500                    STP4    ORG1+1,,AUTO
        46 016013   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 016014   000013 631400 47                 EPPR1   11
        46 016015   000000 701000 xent               TSX1    Z8HG$USE_REGISTER
        46 016016   000000 011000                    NOP     0
        46 016017   021307 710000 46                 TRA     s:26924

     2792    25504
     2793    25505    4          CASE(ELSE);

     2794    25506
     2795    25507                   /* ETT.STATE already updated */
     2796    25508
     2797    25509    4        END; /* DO CASE MVPP.ACTION# */

  25509 46 016020   021307 710000 46                 TRA     s:26924
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:537  

     2798    25510
     2799    25511    3      CASE(ELSE);

     2800    25512
     2801    25513              /* Error, there should have been only two passes */
     2802    25514
     2803    25515    3    END; /* DO CASE CASE_PASS */

     2804    25516        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:538  
     2805    25517    2   CASE(%MVT);

     2806    25518
     2807    25519             %IF GCOS;
     2808    25520 C           IF PILL -> ILL.ROP -> ETT.ID = %TRIAD OR
     2809    25521 C               PILL -> ILL.ROP -> ETT.ID = %BASE THEN
     2810    25522 C             PCOM.DABS = 0;
     2811    25523 C           ELSE
     2812    25524 C             PCOM.DABS = 1;
     2813    25525             %ENDIF;
     2814    25526
     2815    25527    2        CALL FREE_REGISTER_CHECK_3 (PILL);

  25527 46 016021   200003 236100                    LDQ     @PILL,,AUTO
        46 016022   200263 756100                    STQ     LOWER$+2,,AUTO
        46 016023   022173 701000 46                 TSX1    FREE_REGISTER_CHECK_3
        46 016024   000000 011000                    NOP     0
        46 016025   021307 710000 46                 TRA     s:26924

     2816    25528
     2817    25529        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:539  
     2818    25530    2   CASE( %OCCHK );

     2819    25531
     2820    25532    2     PCOM.CABS = BITBIN( %GCOS );

  25532 46 016026   200004 473500                    LDP3    @PCOM,,AUTO
        46 016027   300002 450100                    STZ     2,,PR3

     2821    25533    2     PCOM.ZOPND = COMCOM.ESC -> ETT.LOP;

  25533 46 016030   000007 471400 xsym               LDP1    COMCOM+7
        46 016031   100001 236100                    LDQ     1,,PR1
        46 016032   300063 756100                    STQ     51,,PR3
        46 016033   021307 710000 46                 TRA     s:26924

     2822    25534
     2823    25535        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:540  
     2824    25536    2   CASE(%OS_CALL);

     2825    25537
     2826    25538    2        ARGLIST$ = PILL -> ETT.LOP;

  25538 46 016034   100001 236100                    LDQ     1,,PR1
        46 016035   200120 756100                    STQ     ARGLIST$,,AUTO

     2827    25539    2        NUMBER_OF_ARGS = ARGLIST$ -> LTS.N - 1;

  25539 46 016036   200120 473500                    LDP3    ARGLIST$,,AUTO
        46 016037   300000 236100                    LDQ     0,,PR3
        46 016040   777777 376007                    ANQ     -1,DL
        46 016041   000001 136007                    SBLQ    1,DL
        46 016042   200121 756100                    STQ     NUMBER_OF_ARGS,,AUTO

     2828    25540
     2829    25541    3        DO CASE(CASE_PASS);

  25541 46 016043   200005 474500                    LDP4    @CASE_PASS,,AUTO
        46 016044   400000 235100                    LDA     0,,PR4
        46 016045   000002 115007                    CMPA    2,DL
        46 016046   016050 602005 46                 TNC     s:25541+5,AL
        46 016047   021307 710000 46                 TRA     s:26924
        46 016050   016052 710000 46                 TRA     s:25544
        46 016051   016074 710000 46                 TRA     s:25584

     2830    25542    3          CASE(%FIRST_PASS);

     2831    25543
     2832    25544    3            PCOM.OABS = 0;

  25544 46 016052   200004 475500                    LDP5    @PCOM,,AUTO
        46 016053   500016 450100                    STZ     14,,PR5

     2833    25545
     2834    25546    3            PCOM.DABS = NUMBER_OF_ARGS;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:541  

  25546 46 016054   500003 756100                    STQ     3,,PR5

     2835    25547                 %IF GCOS;
     2836    25548 C               PCOM.MABS = NUMBER_OF_ARGS;
     2837    25549 C               PCOM.LABS = -1;
     2838    25550 C               IF PILL -> ILL.CODE = %OP_CALL_ID OR
     2839    25551 C                  PILL -> ILL.CODE = %OP_CANCEL THEN
     2840    25552 C                 PCOM.VABS = 0;                        /* DESC Needed */
     2841    25553 C               ELSE
     2842    25554 C                 PCOM.VABS = 1;                        /* No DESC     */
     2843    25555                 %ENDIF;
     2844    25556
     2845    25557
     2846    25558    4            IF PILL->OS_CALL.ALTRET$ = ADDR(NIL) THEN DO;

  25558 46 016055   000000 471500                    LDP1    0,,PR0
        46 016056   100004 236100                    LDQ     4,,PR1
        46 016057   000005 116000 47                 CMPQ    5
        46 016060   016063 601000 46                 TNZ     s:25565

     2847    25559    4              PCOM.EABS = 0;

  25559 46 016061   500004 450100                    STZ     4,,PR5

     2848    25560                   %IF GCOS;
     2849    25561 C                 PCOM.RABS = 0;
     2850    25562                   %ENDIF;
     2851    25563    4            END;

  25563 46 016062   016065 710000 46                 TRA     s:25578

     2852    25564    4            ELSE DO;

     2853    25565    4              PCOM.EABS = 1;

  25565 46 016063   000001 235007                    LDA     1,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:542  
        46 016064   500004 755100                    STA     4,,PR5

     2854    25566                   %IF GCOS;
     2855    25567 C                 DO CASE (PILL -> ILL.CODE);
     2856    25568 C                   CASE (%OP_DELETE_IND, %OP_DELETE_REL, %OP_REWRITE_IND,
     2857    25569 C                         %OP_REWRITE_REL, %OP_START_IND, %OP_START_REL,
     2858    25570 C                         %OP_WRITE_SEQ, %OP_WRITE_IND, %OP_WRITE_REL);
     2859    25571 C                     PCOM.RABS = 1; /* RETURN$, not ALTRET$ */
     2860    25572 C                   CASE (ELSE);
     2861    25573 C                     PCOM.RABS = 0;
     2862    25574 C                 END; /* CASE */
     2863    25575                   %ENDIF;
     2864    25576    4            END;

     2865    25577
     2866    25578    3            IF NUMBER_OF_ARGS = 0 THEN

  25578 46 016065   200121 235100                    LDA     NUMBER_OF_ARGS,,AUTO
        46 016066   016071 601000 46                 TNZ     s:25581

     2867    25579    3              PCOM.WABS = 0;

  25579 46 016067   500026 450100                    STZ     22,,PR5
        46 016070   021307 710000 46                 TRA     s:26924

     2868    25580    3            ELSE
     2869    25581    3              PCOM.WABS = 1;

  25581 46 016071   000001 236007                    LDQ     1,DL
        46 016072   500026 756100                    STQ     22,,PR5
        46 016073   021307 710000 46                 TRA     s:26924

     2870    25582
     2871    25583    3          CASE(%SECOND_PASS);

     2872    25584    4            DO I = 0 TO NUMBER_OF_ARGS - 1;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:543  
  25584 46 016074   200065 450100                    STZ     I,,AUTO
        46 016075   016112 710000 46                 TRA     s:25586+1

     2873    25585    4              CALL Z8HU$DEC_COUNT(ARGLIST$ -> ARGLIST.ARG$(I),1);

  25585 46 016076   000016 236000 47                 LDQ     14
        46 016077   200303 756100                    STQ     ORG1+2,,AUTO
        46 016100   200065 236100                    LDQ     I,,AUTO
        46 016101   000022 736000                    QLS     18
        46 016102   000001 036003                    ADLQ    1,DU
        46 016103   200120 036100                    ADLQ    ARGLIST$,,AUTO
        46 016104   200302 756100                    STQ     ORG1+1,,AUTO
        46 016105   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 016106   000013 631400 47                 EPPR1   11
        46 016107   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 016110   000000 011000                    NOP     0

     2874    25586    4            END;

  25586 46 016111   200065 054100                    AOS     I,,AUTO
        46 016112   200065 236100                    LDQ     I,,AUTO
        46 016113   200121 116100                    CMPQ    NUMBER_OF_ARGS,,AUTO
        46 016114   016076 604000 46                 TMI     s:25585

     2875    25587
     2876    25588    3        END /* Case */;

  25588 46 016115   021307 710000 46                 TRA     s:26924

     2877    25589        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:544  
     2878    25590    2   CASE( %PINC );                                /*#28298*/

     2879    25591
     2880    25592    2     PCOM.GABS = PILL -> PINC.ROPCON;

  25592 46 016116   100003 235100                    LDA     3,,PR1
        46 016117   200004 473500                    LDP3    @PCOM,,AUTO
        46 016120   300006 755100                    STA     6,,PR3

     2881    25593
     2882    25594    2     IF PILL -> ETT.ROP -> ST.NDSC.TN   THEN

  25594 46 016121   000000 471500                    LDP1    0,,PR0
        46 016122   100002 474500                    LDP4    2,,PR1
        46 016123   400001 236100                    LDQ     1,,PR4
        46 016124   040000 316007                    CANQ    16384,DL
        46 016125   016143 600000 46                 TZE     s:25602

     2883    25595    3       DO;

     2884    25596    3         PCOM.JABS = 1;

  25596 46 016126   000001 235007                    LDA     1,DL
        46 016127   300011 755100                    STA     9,,PR3

     2885    25597    3         PCOM.GABS = PCOM.GABS * 8;

  25597 46 016130   300006 235100                    LDA     6,,PR3
        46 016131   000003 735000                    ALS     3
        46 016132   300006 755100                    STA     6,,PR3

     2886    25598    3         PCOM.GABS = PCOM.GABS + PILL -> ETT.ROP -> ST.NDSC.CN;

  25598 46 016133   000000 471500                    LDP1    0,,PR0
        46 016134   100002 474500                    LDP4    2,,PR1
        46 016135   400001 236100                    LDQ     1,,PR4
        46 016136   000017 772000                    QRL     15
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:545  
        46 016137   000007 376007                    ANQ     7,DL
        46 016140   300006 036100                    ADLQ    6,,PR3
        46 016141   300006 756100                    STQ     6,,PR3

     2887    25599    3       END;

  25599 46 016142   016156 710000 46                 TRA     s:25607

     2888    25600    2     ELSE
     2889    25601    3       DO;

     2890    25602    3         PCOM.JABS = 0;

  25602 46 016143   300011 450100                    STZ     9,,PR3

     2891    25603    3         PCOM.GABS = PCOM.GABS * 4;

  25603 46 016144   300006 235100                    LDA     6,,PR3
        46 016145   000002 735000                    ALS     2
        46 016146   300006 755100                    STA     6,,PR3

     2892    25604    3         PCOM.GABS = PCOM.GABS + PILL -> ETT.ROP -> ST.ADSC.CN;

  25604 46 016147   000000 471500                    LDP1    0,,PR0
        46 016150   100002 474500                    LDP4    2,,PR1
        46 016151   400001 236100                    LDQ     1,,PR4
        46 016152   000020 772000                    QRL     16
        46 016153   000003 376007                    ANQ     3,DL
        46 016154   300006 036100                    ADLQ    6,,PR3
        46 016155   300006 756100                    STQ     6,,PR3

     2893    25605    3       END;

     2894    25606
     2895    25607    2     PILL -> ETT.ROP = ADDR(NIL);

  25607 46 016156   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:546  
        46 016157   000005 236000 47                 LDQ     5
        46 016160   100002 756100                    STQ     2,,PR1
        46 016161   021307 710000 46                 TRA     s:26924

     2896    25608
     2897    25609        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:547  
     2898    25610    2   CASE(%P_A_PRESET);

     2899    25611        /*V*
     2900    25612                      P_A_PRESET
     2901    25613
     2902    25614             Preset a word.  The top half of the word will contain
     2903    25615             the address of the ST item pointed to by P_A_PRESET.LOP.
     2904    25616             The bottom half of the word will be preset to the value of
     2905    25617             P_A_PRESET.ROPCON.  The receiving address will be the
     2906    25618             address of the ST item pointed to by P_A_PRESET.TO_ plus
     2907    25619             P_A_PRESET.OFFSET.
     2908    25620        */
     2909    25621    2        TARGET$ = PILL -> P_A_PRESET.TO_;

  25621 46 016162   100003 236100                    LDQ     3,,PR1
        46 016163   200134 756100                    STQ     TARGET$,,AUTO

     2910    25622    2        SENDING$ = PILL -> P_A_PRESET.LOP;

  25622 46 016164   100001 236100                    LDQ     1,,PR1
        46 016165   200244 756100                    STQ     SENDING$,,AUTO

     2911    25623
     2912    25624    2        CURRENT_SA = TARGET$ -> VARIABLE.SA + PILL -> P_A_PRESET.OFFSET;

  25624 46 016166   100000 236100                    LDQ     0,,PR1
        46 016167   777777 376007                    ANQ     -1,DL
        46 016170   200302 756100                    STQ     ORG1+1,,AUTO
        46 016171   200134 471500                    LDP1    TARGET$,,AUTO
        46 016172   100001 236100                    LDQ     1,,PR1
        46 016173   000022 772000                    QRL     18
        46 016174   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 016175   200242 756100                    STQ     CURRENT_SA,,AUTO

     2913    25625
     2914    25626    2        IF BITS_IN_BUFFER ~= 0 THEN

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:548  
  25626 46 016176   000003 235000 25                 LDA     BITS_IN_BUFFER
        46 016177   016204 600000 46                 TZE     s:25629

     2915    25627    2            CALL FLUSH_BUFFER(OLD_SA);

  25627 46 016200   000040 236000 47                 LDQ     32
        46 016201   200265 756100                    STQ     SEND$+1,,AUTO
        46 016202   021605 701000 46                 TSX1    FLUSH_BUFFER
        46 016203   000000 011000                    NOP     0

     2916    25628
     2917    25629    2        IF PILL -> P_A_PRESET.OFFSET = 0 THEN

  25629 46 016204   200003 470500                    LDP0    @PILL,,AUTO
        46 016205   000000 471500                    LDP1    0,,PR0
        46 016206   100000 720100                    LXL0    0,,PR1
        46 016207   016241 601000 46                 TNZ     s:25667

     2918    25630               %NEW_LAB(@ST$ = TARGET$);

  25648 46 016210   000002 236000 36                 LDQ     OBJ_+2
        46 016211   000002 036007                    ADLQ    2,DL
        46 016212   000003 116000 36                 CMPQ    OBJ_+3
        46 016213   016225 604000 46                 TMI     s:25654

  25650 46 016214   000000 234000 30                 SZN     PAGING_OBJ
        46 016215   016222 605000 46                 TPL     s:25652

  25651 46 016216   000006 630400 47                 EPPR0   6
        46 016217   000000 631400 47                 EPPR1   0
        46 016220   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 016221   000000 011000                    NOP     0

  25652 46 016222   000007 631400 47                 EPPR1   7
        46 016223   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 016224   000000 011000                    NOP     0

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:549  
  25654 46 016225   000002 236000 36                 LDQ     OBJ_+2
        46 016226   000022 736000                    QLS     18
        46 016227   000001 036000 36                 ADLQ    OBJ_+1
        46 016230   000000 756000 29                 STQ     OBJ$

  25655 46 016231   000002 236007                    LDQ     2,DL
        46 016232   000002 056000 36                 ASQ     OBJ_+2

  25656 46 016233   001011 220003                    LDX0    521,DU
        46 016234   000000 470400 29                 LDP0    OBJ$
        46 016235   000000 740100                    STX0    0,,PR0

  25660 46 016236   200134 236100                    LDQ     TARGET$,,AUTO
        46 016237   000000 470400 29                 LDP0    OBJ$
        46 016240   000001 756100                    STQ     1,,PR0

     2919    25666
     2920    25667    2        BOTTOM_HALF = PILL -> P_A_PRESET.ROPCON;

  25667 46 016241   200003 470500                    LDP0    @PILL,,AUTO
        46 016242   000000 471500                    LDP1    0,,PR0
        46 016243   100002 720100                    LXL0    2,,PR1
        46 016244   200141 740100                    STX0    BOTTOM_HALF,,AUTO

     2921    25668
     2922    25669    2        MOD_KEY.KEY = 0;

  25669 46 016245   000000 450000 25                 STZ     MOD_KEY

     2923    25670    2        INST_WORD = '0'O;

  25670 46 016246   200012 450100                    STZ     INST_WORD,,AUTO

     2924    25671    2        INST_WORD.LOW = BINBIT(BOTTOM_HALF,18);

  25671 46 016247   200141 221100                    LDX1    BOTTOM_HALF,,AUTO
        46 016250   200012 441100                    SXL1    INST_WORD,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:550  

     2925    25672
     2926    25673    2        IF SENDING$ ~= ADDR(NIL) THEN

  25673 46 016251   200244 236100                    LDQ     SENDING$,,AUTO
        46 016252   000005 116000 47                 CMPQ    5
        46 016253   016275 600000 46                 TZE     s:25709

     2927    25674    3          DO;

     2928    25675    3            IF SENDING$ -> ST.ID = %CONST AND

  25675 46 016254   200244 473500                    LDP3    SENDING$,,AUTO
        46 016255   300000 222100                    LDX2    0,,PR3
        46 016256   000767 102003                    CMPX2   503,DU
        46 016257   016271 601000 46                 TNZ     s:25682
        46 016260   300003 236100                    LDQ     3,,PR3
        46 016261   020000 316003                    CANQ    8192,DU
        46 016262   016271 601000 46                 TNZ     s:25682

     2929    25676    3              NOT SENDING$ -> CONST.B.ALLOCATED THEN
     2930    25677    4              DO;

     2931    25678    4                SENDING$ -> CONST.B.ALLOCATED = TRUE;

  25678 46 016263   020000 236003                    LDQ     8192,DU
        46 016264   300003 256100                    ORSQ    3,,PR3

     2932    25679    4                SENDING$ -> CONST.ALLOC_LINK = CONST$;

  25679 46 016265   000000 236000 21                 LDQ     CONST$
        46 016266   300005 756100                    STQ     5,,PR3

     2933    25680    4                CONST$ = SENDING$;

  25680 46 016267   200244 236100                    LDQ     SENDING$,,AUTO
        46 016270   000000 756000 21                 STQ     CONST$
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:551  

     2934    25681    4              END;

     2935    25682    3            MOD_KEY.B.HALF_REL = TRUE;

  25682 46 016271   000040 236007                    LDQ     32,DL
        46 016272   000000 256000 25                 ORSQ    MOD_KEY

     2936    25683    3            MOD_KEY.B.RESOLVE_ADDRESS = TRUE;

  25683 46 016273   000020 236007                    LDQ     16,DL
        46 016274   000000 256000 25                 ORSQ    MOD_KEY

     2937    25684    3          END;

     2938    25685
     2939    25686             %NEW_WORD( @OU_WORD = INST_WORD,
     2940    25687                        @KEY = MOD_KEY.KEY,
     2941    25688                        @ST$ = SENDING$,
     2942    25689                        @OFFSET = CURRENT_SA,
     2943    25690                        @ADVANCE_BLOCK_SIZE = NO);

  25709 46 016275   000002 236000 36                 LDQ     OBJ_+2
        46 016276   000004 036007                    ADLQ    4,DL
        46 016277   000003 116000 36                 CMPQ    OBJ_+3
        46 016300   016312 604000 46                 TMI     s:25715

  25711 46 016301   000000 234000 30                 SZN     PAGING_OBJ
        46 016302   016307 605000 46                 TPL     s:25713

  25712 46 016303   000006 630400 47                 EPPR0   6
        46 016304   000000 631400 47                 EPPR1   0
        46 016305   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 016306   000000 011000                    NOP     0

  25713 46 016307   000007 631400 47                 EPPR1   7
        46 016310   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:552  
        46 016311   000000 011000                    NOP     0

  25715 46 016312   000002 236000 36                 LDQ     OBJ_+2
        46 016313   000022 736000                    QLS     18
        46 016314   000001 036000 36                 ADLQ    OBJ_+1
        46 016315   000000 756000 29                 STQ     OBJ$

  25716 46 016316   000004 236007                    LDQ     4,DL
        46 016317   000002 056000 36                 ASQ     OBJ_+2

  25717 46 016320   001012 220003                    LDX0    522,DU
        46 016321   000000 470400 29                 LDP0    OBJ$
        46 016322   000000 740100                    STX0    0,,PR0

  25720 46 016323   200244 236100                    LDQ     SENDING$,,AUTO
        46 016324   000000 470400 29                 LDP0    OBJ$
        46 016325   000002 756100                    STQ     2,,PR0

  25721 46 016326   200242 235100                    LDA     CURRENT_SA,,AUTO
        46 016327   000001 755100                    STA     1,,PR0

  25722 46 016330   000000 236000 25                 LDQ     MOD_KEY
        46 016331   000011 736000                    QLS     9
        46 016332   000000 552110                    STBQ    0,'10'O,PR0

  25724 46 016333   200012 236100                    LDQ     INST_WORD,,AUTO
        46 016334   000000 470400 29                 LDP0    OBJ$
        46 016335   000003 756100                    STQ     3,,PR0

     2944    25737
     2945    25738    2        OLD_SA = CURRENT_SA;

  25738 46 016336   200242 235100                    LDA     CURRENT_SA,,AUTO
        46 016337   000006 755000 25                 STA     OLD_SA
        46 016340   021307 710000 46                 TRA     s:26924

     2946    25739        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:553  
     2947    25740    2   CASE( %P_P_PRESET );

     2948    25741
     2949    25742    2       UPPER$ = PILL -> P_P_PRESET.LOP;

  25742 46 016341   100001 236100                    LDQ     1,,PR1
        46 016342   200260 756100                    STQ     UPPER$,,AUTO

     2950    25743    2       LOWER$ = PILL -> P_P_PRESET.ROP;

  25743 46 016343   100002 236100                    LDQ     2,,PR1
        46 016344   200261 756100                    STQ     LOWER$,,AUTO

     2951    25744    2       TARGET$ = PILL -> P_P_PRESET.TO_;

  25744 46 016345   100003 236100                    LDQ     3,,PR1
        46 016346   200134 756100                    STQ     TARGET$,,AUTO

     2952    25745
     2953    25746    2       CURRENT_SA = TARGET$ -> VARIABLE.SA + PILL -> P_P_PRESET.OFFSET;

  25746 46 016347   100000 236100                    LDQ     0,,PR1
        46 016350   777777 376007                    ANQ     -1,DL
        46 016351   200302 756100                    STQ     ORG1+1,,AUTO
        46 016352   200134 471500                    LDP1    TARGET$,,AUTO
        46 016353   100001 236100                    LDQ     1,,PR1
        46 016354   000022 772000                    QRL     18
        46 016355   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 016356   200242 756100                    STQ     CURRENT_SA,,AUTO

     2954    25747
     2955    25748    2       IF BITS_IN_BUFFER ~= 0    THEN

  25748 46 016357   000003 235000 25                 LDA     BITS_IN_BUFFER
        46 016360   016365 600000 46                 TZE     s:25751

     2956    25749    2         CALL FLUSH_BUFFER( OLD_SA );
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:554  

  25749 46 016361   000040 236000 47                 LDQ     32
        46 016362   200265 756100                    STQ     SEND$+1,,AUTO
        46 016363   021605 701000 46                 TSX1    FLUSH_BUFFER
        46 016364   000000 011000                    NOP     0

     2957    25750
     2958    25751    2       IF PILL -> P_P_PRESET.OFFSET = 0  THEN

  25751 46 016365   200003 470500                    LDP0    @PILL,,AUTO
        46 016366   000000 471500                    LDP1    0,,PR0
        46 016367   100000 720100                    LXL0    0,,PR1
        46 016370   016422 601000 46                 TNZ     s:25790

     2959    25752
     2960    25753              %NEW_LAB( @ST$ = TARGET$);

  25771 46 016371   000002 236000 36                 LDQ     OBJ_+2
        46 016372   000002 036007                    ADLQ    2,DL
        46 016373   000003 116000 36                 CMPQ    OBJ_+3
        46 016374   016406 604000 46                 TMI     s:25777

  25773 46 016375   000000 234000 30                 SZN     PAGING_OBJ
        46 016376   016403 605000 46                 TPL     s:25775

  25774 46 016377   000006 630400 47                 EPPR0   6
        46 016400   000000 631400 47                 EPPR1   0
        46 016401   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 016402   000000 011000                    NOP     0

  25775 46 016403   000007 631400 47                 EPPR1   7
        46 016404   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 016405   000000 011000                    NOP     0

  25777 46 016406   000002 236000 36                 LDQ     OBJ_+2
        46 016407   000022 736000                    QLS     18
        46 016410   000001 036000 36                 ADLQ    OBJ_+1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:555  
        46 016411   000000 756000 29                 STQ     OBJ$

  25778 46 016412   000002 236007                    LDQ     2,DL
        46 016413   000002 056000 36                 ASQ     OBJ_+2

  25779 46 016414   001011 220003                    LDX0    521,DU
        46 016415   000000 470400 29                 LDP0    OBJ$
        46 016416   000000 740100                    STX0    0,,PR0

  25783 46 016417   200134 236100                    LDQ     TARGET$,,AUTO
        46 016420   000000 470400 29                 LDP0    OBJ$
        46 016421   000001 756100                    STQ     1,,PR0

     2961    25789
     2962    25790    2       MOD_KEY.KEY = 0;

  25790 46 016422   000000 450000 25                 STZ     MOD_KEY

     2963    25791    2       MOD_KEY.B.BOTH_REL = TRUE;

  25791 46 016423   000100 236007                    LDQ     64,DL
        46 016424   000000 256000 25                 ORSQ    MOD_KEY

     2964    25792    2       MOD_KEY.B.RESOLVE_ADDRESS = TRUE;

  25792 46 016425   000020 236007                    LDQ     16,DL
        46 016426   000000 256000 25                 ORSQ    MOD_KEY

     2965    25793
     2966    25794            %NEW_WORD( @KEY = MOD_KEY.KEY,
     2967    25795                       @ST$ = UPPER$,
     2968    25796                       @ST2$ = LOWER$,
     2969    25797                       @OFFSET = CURRENT_SA,
     2970    25798                       @ADVANCE_BLOCK_SIZE = NO);

  25817 46 016427   000002 236000 36                 LDQ     OBJ_+2
        46 016430   000004 036007                    ADLQ    4,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:556  
        46 016431   000003 116000 36                 CMPQ    OBJ_+3
        46 016432   016444 604000 46                 TMI     s:25823

  25819 46 016433   000000 234000 30                 SZN     PAGING_OBJ
        46 016434   016441 605000 46                 TPL     s:25821

  25820 46 016435   000006 630400 47                 EPPR0   6
        46 016436   000000 631400 47                 EPPR1   0
        46 016437   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 016440   000000 011000                    NOP     0

  25821 46 016441   000007 631400 47                 EPPR1   7
        46 016442   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 016443   000000 011000                    NOP     0

  25823 46 016444   000002 236000 36                 LDQ     OBJ_+2
        46 016445   000022 736000                    QLS     18
        46 016446   000001 036000 36                 ADLQ    OBJ_+1
        46 016447   000000 756000 29                 STQ     OBJ$

  25824 46 016450   000004 236007                    LDQ     4,DL
        46 016451   000002 056000 36                 ASQ     OBJ_+2

  25825 46 016452   001012 220003                    LDX0    522,DU
        46 016453   000000 470400 29                 LDP0    OBJ$
        46 016454   000000 740100                    STX0    0,,PR0

  25828 46 016455   200260 236100                    LDQ     UPPER$,,AUTO
        46 016456   000000 470400 29                 LDP0    OBJ$
        46 016457   000002 756100                    STQ     2,,PR0

  25829 46 016460   200242 235100                    LDA     CURRENT_SA,,AUTO
        46 016461   000001 755100                    STA     1,,PR0

  25830 46 016462   000000 236000 25                 LDQ     MOD_KEY
        46 016463   000011 736000                    QLS     9
        46 016464   000000 552110                    STBQ    0,'10'O,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:557  

  25834 46 016465   200261 236100                    LDQ     LOWER$,,AUTO
        46 016466   000000 470400 29                 LDP0    OBJ$
        46 016467   000003 756100                    STQ     3,,PR0

  25843 46 016470   021307 710000 46                 TRA     s:26924

     2971    25845
     2972    25846        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:558  
     2973    25847    2   CASE(%PEND);

     2974    25848        /*V*
     2975    25849                     PEND
     2976    25850
     2977    25851             A PEND item marks the end of the preset items for a data
     2978    25852             division.  The PEND item causes the preset BUFFER to be
     2979    25853             flushed.  This is done to prevent writing backward in
     2980    25854             the object unit, as might be necessary if we waited
     2981    25855             until the end of the program to flush the buffer.
     2982    25856        */
     2983    25857
     2984    25858    2        MOD_KEY.B = '0'O;

  25858 46 016471   000000 450000 25                 STZ     MOD_KEY

     2985    25859    2        IF BITS_IN_BUFFER ~= 0 THEN

  25859 46 016472   000003 235000 25                 LDA     BITS_IN_BUFFER
        46 016473   016501 600000 46                 TZE     s:25862

     2986    25860    2            CALL FLUSH_BUFFER(OLD_SA);

  25860 46 016474   000040 236000 47                 LDQ     32
        46 016475   200265 756100                    STQ     SEND$+1,,AUTO
        46 016476   021605 701000 46                 TSX1    FLUSH_BUFFER
        46 016477   000000 011000                    NOP     0
        46 016500   021307 710000 46                 TRA     s:26924

     2987    25861    2        ELSE                                                  /*#31015*/
     2988    25862    2          FLUSH_BLK$ = ADDR(NIL);                             /*#31015*/

  25862 46 016501   000005 236000 47                 LDQ     5
        46 016502   000005 756000 25                 STQ     FLUSH_BLK$
        46 016503   021307 710000 46                 TRA     s:26924

     2989    25863
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:559  
     2990    25864
     2991    25865        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:560  
     2992    25866    2   CASE(%PREOFF);

     2993    25867
     2994    25868    2        MOD_KEY.B = '0'O;

  25868 46 016504   000000 450000 25                 STZ     MOD_KEY

     2995    25869
     2996    25870    2         TARGET$ = PILL -> ETT.LOP;

  25870 46 016505   100001 236100                    LDQ     1,,PR1
        46 016506   200134 756100                    STQ     TARGET$,,AUTO

     2997    25871    2        CURRENT_SA = TARGET$ -> VARIABLE.SA + PILL -> PREOFF.OFFSET;

  25871 46 016507   100000 236100                    LDQ     0,,PR1
        46 016510   777777 376007                    ANQ     -1,DL
        46 016511   200302 756100                    STQ     ORG1+1,,AUTO
        46 016512   200134 471500                    LDP1    TARGET$,,AUTO
        46 016513   100001 236100                    LDQ     1,,PR1
        46 016514   000022 772000                    QRL     18
        46 016515   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 016516   200242 756100                    STQ     CURRENT_SA,,AUTO

     2998    25872
     2999    25873    2        IF OLD_SA ~= CURRENT_SA AND BITS_IN_BUFFER ~= 0 THEN

  25873 46 016517   000006 116000 25                 CMPQ    OLD_SA
        46 016520   016527 600000 46                 TZE     s:25876
        46 016521   000003 235000 25                 LDA     BITS_IN_BUFFER
        46 016522   016527 600000 46                 TZE     s:25876

     3000    25874    2          CALL FLUSH_BUFFER(OLD_SA);

  25874 46 016523   000040 236000 47                 LDQ     32
        46 016524   200265 756100                    STQ     SEND$+1,,AUTO
        46 016525   021605 701000 46                 TSX1    FLUSH_BUFFER
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:561  
        46 016526   000000 011000                    NOP     0

     3001    25875
     3002    25876    2        CONSTANT$ = PILL -> ETT.ROP;

  25876 46 016527   200003 470500                    LDP0    @PILL,,AUTO
        46 016530   000000 471500                    LDP1    0,,PR0
        46 016531   100002 236100                    LDQ     2,,PR1
        46 016532   000001 756000 25                 STQ     CONSTANT$

     3003    25877
     3004    25878             %GET_CONSTANT_ADDRESS (@CONSTANT=CONSTANT$, @STRING=STRING$);

  25880 46 016533   000001 471400 25                 LDP1    CONSTANT$
        46 016534   100003 234100                    SZN     3,,PR1
        46 016535   016542 605000 46                 TPL     s:25883

  25881 46 016536   100010 473500                    LDP3    8,,PR1
        46 016537   300001 634500                    EPPR4   1,,PR3
        46 016540   200133 454500                    STP4    STRING$,,AUTO
        46 016541   016544 710000 46                 TRA     s:25887

  25883 46 016542   000010 036003                    ADLQ    8,DU
        46 016543   200133 756100                    STQ     STRING$,,AUTO

     3005    25886
     3006    25887    2        IF PILL -> PREOFF.OFFSET = 0 THEN

  25887 46 016544   000000 473500                    LDP3    0,,PR0
        46 016545   300000 720100                    LXL0    0,,PR3
        46 016546   016600 601000 46                 TNZ     s:25927

     3007    25888               %NEW_LAB ( @ST$ = TARGET$ );

  25906 46 016547   000002 236000 36                 LDQ     OBJ_+2
        46 016550   000002 036007                    ADLQ    2,DL
        46 016551   000003 116000 36                 CMPQ    OBJ_+3
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:562  
        46 016552   016564 604000 46                 TMI     s:25912

  25908 46 016553   000000 234000 30                 SZN     PAGING_OBJ
        46 016554   016561 605000 46                 TPL     s:25910

  25909 46 016555   000006 630400 47                 EPPR0   6
        46 016556   000000 631400 47                 EPPR1   0
        46 016557   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 016560   000000 011000                    NOP     0

  25910 46 016561   000007 631400 47                 EPPR1   7
        46 016562   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 016563   000000 011000                    NOP     0

  25912 46 016564   000002 236000 36                 LDQ     OBJ_+2
        46 016565   000022 736000                    QLS     18
        46 016566   000001 036000 36                 ADLQ    OBJ_+1
        46 016567   000000 756000 29                 STQ     OBJ$

  25913 46 016570   000002 236007                    LDQ     2,DL
        46 016571   000002 056000 36                 ASQ     OBJ_+2

  25914 46 016572   001011 220003                    LDX0    521,DU
        46 016573   000000 470400 29                 LDP0    OBJ$
        46 016574   000000 740100                    STX0    0,,PR0

  25918 46 016575   200134 236100                    LDQ     TARGET$,,AUTO
        46 016576   000000 470400 29                 LDP0    OBJ$
        46 016577   000001 756100                    STQ     1,,PR0

     3008    25924
     3009    25925             /* ASSUME CN OF 0 */
     3010    25926
     3011    25927    2        SOURCE = 0;

  25927 46 016600   200137 450100                    STZ     SOURCE,,AUTO

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:563  
     3012    25928    2        TOTAL_MOVED = 0;

  25928 46 016601   200136 450100                    STZ     TOTAL_MOVED,,AUTO

     3013    25929    2        TARGET = 0;

  25929 46 016602   000002 450000 25                 STZ     TARGET

     3014    25930
     3015    25931    3        DO WHILE TOTAL_MOVED < PILL -> PREOFF.N;

  25931 46 016603   200003 470500                    LDP0    @PILL,,AUTO
        46 016604   000000 471500                    LDP1    0,,PR0
        46 016605   200136 236100                    LDQ     TOTAL_MOVED,,AUTO
        46 016606   016611 604000 46                 TMI     s:25933
        46 016607   100003 116100                    CMPQ    3,,PR1
        46 016610   016641 603000 46                 TRC     s:25947

     3016    25932
     3017    25933    3          SUBSTR(CHAR_BUFFER,TARGET,1) = SUBSTR(STRING$->CHARS,SOURCE,1);

  25933 46 016611   200133 470500                    LDP0    STRING$,,AUTO
        46 016612   200137 235100                    LDA     SOURCE,,AUTO
        46 016613   000002 236000 25                 LDQ     TARGET
        46 016614   040006 100505                    MLR     fill='040'O
        46 016615   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        46 016616   000004 000001 25                 ADSC9   BUFFER,Q                 cn=0,n=1

     3018    25934
     3019    25935    3          SOURCE = SOURCE + 1;

  25935 46 016617   200137 054100                    AOS     SOURCE,,AUTO

     3020    25936    3          TARGET = TARGET + 1;

  25936 46 016620   000002 054000 25                 AOS     TARGET

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:564  
     3021    25937
     3022    25938    3          IF TARGET = 4 THEN

  25938 46 016621   000002 235000 25                 LDA     TARGET
        46 016622   000004 115007                    CMPA    4,DL
        46 016623   016633 601000 46                 TNZ     s:25945

     3023    25939    4            DO;

     3024    25940    4              CALL FLUSH_BUFFER(CURRENT_SA);

  25940 46 016624   200242 631500                    EPPR1   CURRENT_SA,,AUTO
        46 016625   200265 451500                    STP1    SEND$+1,,AUTO
        46 016626   021605 701000 46                 TSX1    FLUSH_BUFFER
        46 016627   000000 011000                    NOP     0

     3025    25941    4              TARGET = 0;

  25941 46 016630   000002 450000 25                 STZ     TARGET

     3026    25942    4              CURRENT_SA = CURRENT_SA + 1;

  25942 46 016631   200242 054100                    AOS     CURRENT_SA,,AUTO

     3027    25943    4              TOTAL_MOVED = TOTAL_MOVED + 1;

  25943 46 016632   200136 054100                    AOS     TOTAL_MOVED,,AUTO

     3028    25944    4            END;

     3029    25945    3        END;

  25945 46 016633   200003 470500                    LDP0    @PILL,,AUTO
        46 016634   000000 471500                    LDP1    0,,PR0
        46 016635   200136 236100                    LDQ     TOTAL_MOVED,,AUTO
        46 016636   016611 604000 46                 TMI     s:25933
        46 016637   100003 116100                    CMPQ    3,,PR1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:565  
        46 016640   016611 602000 46                 TNC     s:25933

     3030    25946
     3031    25947    2        BITS_IN_BUFFER = TARGET * 9;

  25947 46 016641   000002 236000 25                 LDQ     TARGET
        46 016642   000011 402007                    MPY     9,DL
        46 016643   000003 756000 25                 STQ     BITS_IN_BUFFER

     3032    25948    2        OLD_SA = CURRENT_SA;

  25948 46 016644   200242 235100                    LDA     CURRENT_SA,,AUTO
        46 016645   000006 755000 25                 STA     OLD_SA

     3033    25949    2        IF BITS_IN_BUFFER ~= 0  THEN

  25949 46 016646   000000 116003                    CMPQ    0,DU
        46 016647   021307 600000 46                 TZE     s:26924

     3034    25950    2          FLUSH_BLK$ = CURRENT_BLOCK$;

  25950 46 016650   000000 236000 26                 LDQ     CURRENT_BLOCK$
        46 016651   000005 756000 25                 STQ     FLUSH_BLK$
        46 016652   021307 710000 46                 TRA     s:26924

     3035    25951
     3036    25952        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:566  
     3037    25953    2   CASE(%PRESET);

     3038    25954
     3039    25955    2        MOD_KEY.B = '0'O;

  25955 46 016653   000000 450000 25                 STZ     MOD_KEY

     3040    25956
     3041    25957    2        TARGET$ = PILL -> ETT.LOP;

  25957 46 016654   100001 236100                    LDQ     1,,PR1
        46 016655   200134 756100                    STQ     TARGET$,,AUTO

     3042    25958
     3043    25959    2        CURRENT_SA = TARGET$ -> VARIABLE.SA + PILL -> PRESET.OFFSET;

  25959 46 016656   100000 236100                    LDQ     0,,PR1
        46 016657   777777 376007                    ANQ     -1,DL
        46 016660   200302 756100                    STQ     ORG1+1,,AUTO
        46 016661   200134 471500                    LDP1    TARGET$,,AUTO
        46 016662   100001 236100                    LDQ     1,,PR1
        46 016663   000022 772000                    QRL     18
        46 016664   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 016665   200242 756100                    STQ     CURRENT_SA,,AUTO

     3044    25960
     3045    25961    2        IF (OLD_SA ~= CURRENT_SA  OR  FLUSH_BLK$ ~= CURRENT_BLOCK$) AND BITS_IN_BUFFER
             25961                 ~= 0 THEN

  25961 46 016666   000006 116000 25                 CMPQ    OLD_SA
        46 016667   016673 601000 46                 TNZ     s:25961+5
        46 016670   000005 236000 25                 LDQ     FLUSH_BLK$
        46 016671   000000 116000 26                 CMPQ    CURRENT_BLOCK$
        46 016672   016701 600000 46                 TZE     s:25964
        46 016673   000003 235000 25                 LDA     BITS_IN_BUFFER
        46 016674   016701 600000 46                 TZE     s:25964

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:567  
     3046    25962    2          CALL FLUSH_BUFFER(OLD_SA);

  25962 46 016675   000040 236000 47                 LDQ     32
        46 016676   200265 756100                    STQ     SEND$+1,,AUTO
        46 016677   021605 701000 46                 TSX1    FLUSH_BUFFER
        46 016700   000000 011000                    NOP     0

     3047    25963
     3048    25964    2        CONSTANT$ = PILL -> ETT.ROP;

  25964 46 016701   200003 470500                    LDP0    @PILL,,AUTO
        46 016702   000000 471500                    LDP1    0,,PR0
        46 016703   100002 236100                    LDQ     2,,PR1
        46 016704   000001 756000 25                 STQ     CONSTANT$

     3049    25965
     3050    25966             %GET_CONSTANT_ADDRESS ( @CONSTANT=CONSTANT$, @STRING=STRING$);

  25968 46 016705   000001 471400 25                 LDP1    CONSTANT$
        46 016706   100003 234100                    SZN     3,,PR1
        46 016707   016714 605000 46                 TPL     s:25971

  25969 46 016710   100010 473500                    LDP3    8,,PR1
        46 016711   300001 634500                    EPPR4   1,,PR3
        46 016712   200133 454500                    STP4    STRING$,,AUTO
        46 016713   016716 710000 46                 TRA     s:25993

  25971 46 016714   000010 036003                    ADLQ    8,DU
        46 016715   200133 756100                    STQ     STRING$,,AUTO

     3051    25974
     3052    25975             %NEW_LAB( @ST$ = TARGET$ );

  25993 46 016716   000002 236000 36                 LDQ     OBJ_+2
        46 016717   000002 036007                    ADLQ    2,DL
        46 016720   000003 116000 36                 CMPQ    OBJ_+3
        46 016721   016733 604000 46                 TMI     s:25999
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:568  

  25995 46 016722   000000 234000 30                 SZN     PAGING_OBJ
        46 016723   016730 605000 46                 TPL     s:25997

  25996 46 016724   000006 630400 47                 EPPR0   6
        46 016725   000000 631400 47                 EPPR1   0
        46 016726   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 016727   000000 011000                    NOP     0

  25997 46 016730   000007 631400 47                 EPPR1   7
        46 016731   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 016732   000000 011000                    NOP     0

  25999 46 016733   000002 236000 36                 LDQ     OBJ_+2
        46 016734   000022 736000                    QLS     18
        46 016735   000001 036000 36                 ADLQ    OBJ_+1
        46 016736   000000 756000 29                 STQ     OBJ$

  26000 46 016737   000002 236007                    LDQ     2,DL
        46 016740   000002 056000 36                 ASQ     OBJ_+2

  26001 46 016741   001011 220003                    LDX0    521,DU
        46 016742   000000 470400 29                 LDP0    OBJ$
        46 016743   000000 740100                    STX0    0,,PR0

  26005 46 016744   200134 236100                    LDQ     TARGET$,,AUTO
        46 016745   000000 470400 29                 LDP0    OBJ$
        46 016746   000001 756100                    STQ     1,,PR0

     3053    26011
     3054    26012    3        DO CASE(TARGET$ -> VARIABLE.TYPE);

  26012 46 016747   200134 471500                    LDP1    TARGET$,,AUTO
        46 016750   100002 221100                    LDX1    2,,PR1
        46 016751   000024 101003                    CMPX1   20,DU
        46 016752   016754 602011 46                 TNC     s:26012+5,X1
        46 016753   020061 710000 46                 TRA     s:26297
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:569  
        46 016754   017107 710000 46                 TRA     s:26043
        46 016755   017000 710000 46                 TRA     s:26014
        46 016756   017023 710000 46                 TRA     s:26020
        46 016757   017023 710000 46                 TRA     s:26020
        46 016760   017000 710000 46                 TRA     s:26014
        46 016761   017000 710000 46                 TRA     s:26014
        46 016762   017050 710000 46                 TRA     s:26026
        46 016763   017023 710000 46                 TRA     s:26020
        46 016764   017050 710000 46                 TRA     s:26026
        46 016765   020061 710000 46                 TRA     s:26297
        46 016766   020061 710000 46                 TRA     s:26297
        46 016767   017376 710000 46                 TRA     s:26089
        46 016770   017623 710000 46                 TRA     s:26132
        46 016771   020061 710000 46                 TRA     s:26297
        46 016772   017050 710000 46                 TRA     s:26026
        46 016773   017023 710000 46                 TRA     s:26020
        46 016774   020061 710000 46                 TRA     s:26297
        46 016775   020061 710000 46                 TRA     s:26297
        46 016776   017662 710000 46                 TRA     s:26150
        46 016777   017527 710000 46                 TRA     s:26114

     3055    26013    3          CASE(%TYI,%TYR,%TYQ);

     3056    26014    3            CALL FLUSH(CONSTANT$,STRING$,CURRENT_SA,(CONSTANT$->CONST.NDSC.N/4));

  26014 46 017000   000001 473400 25                 LDP3    CONSTANT$
        46 017001   300001 236100                    LDQ     1,,PR3
        46 017002   000077 376007                    ANQ     63,DL
        46 017003   000002 772000                    QRL     2
        46 017004   200312 756100                    STQ     ORG1+9,,AUTO
        46 017005   200312 634500                    EPPR4   ORG1+9,,AUTO
        46 017006   200272 454500                    STP4    @OPND$+1,,AUTO
        46 017007   200242 635500                    EPPR5   CURRENT_SA,,AUTO
        46 017010   200271 455500                    STP5    @STRING$+1,,AUTO
        46 017011   200133 636500                    EPPR6   STRING$,,AUTO
        46 017012   200270 456500                    STP6    N_OPNDS+1,,AUTO
        46 017013   000106 236000 47                 LDQ     70
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:570  
        46 017014   200267 756100                    STQ     P$+1,,AUTO
        46 017015   021724 701000 46                 TSX1    FLUSH
        46 017016   000000 011000                    NOP     0

     3057    26015
     3058    26016    3            BITS_IN_BUFFER = 0;

  26016 46 017017   000003 450000 25                 STZ     BITS_IN_BUFFER

     3059    26017    3            OLD_SA = CURRENT_SA;

  26017 46 017020   200242 235100                    LDA     CURRENT_SA,,AUTO
        46 017021   000006 755000 25                 STA     OLD_SA
        46 017022   020061 710000 46                 TRA     s:26297

     3060    26018
     3061    26019    3          CASE(%TYO,%TYH,%TYJ,%TYK);

     3062    26020    3            IF PILL -> PRESET.OFFSET = 0   THEN

  26020 46 017023   200003 473500                    LDP3    @PILL,,AUTO
        46 017024   300000 474500                    LDP4    0,,PR3
        46 017025   400000 722100                    LXL2    0,,PR4
        46 017026   017037 601000 46                 TNZ     s:26023

     3063    26021    3                CALL ALPHANUMERIC_PRESET(BINBIT(TARGET$ -> VARIABLE.NDSC.N, 36));

  26021 46 017027   100001 236100                    LDQ     1,,PR1
        46 017030   000077 376007                    ANQ     63,DL
        46 017031   200314 756100                    STQ     ORG1+11,,AUTO
        46 017032   200314 634500                    EPPR4   ORG1+11,,AUTO
        46 017033   200263 454500                    STP4    LOWER$+2,,AUTO
        46 017034   021310 701000 46                 TSX1    ALPHANUMERIC_PRESET
        46 017035   000000 011000                    NOP     0
        46 017036   020061 710000 46                 TRA     s:26297

     3064    26022    3            ELSE
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:571  
     3065    26023    3                CALL ALPHANUMERIC_PRESET(BINBIT(CONSTANT$ -> VARIABLE.NDSC.N,36));

  26023 46 017037   000001 475400 25                 LDP5    CONSTANT$
        46 017040   500001 236100                    LDQ     1,,PR5
        46 017041   000077 376007                    ANQ     63,DL
        46 017042   200316 756100                    STQ     ORG1+13,,AUTO
        46 017043   200316 634500                    EPPR4   ORG1+13,,AUTO
        46 017044   200263 454500                    STP4    LOWER$+2,,AUTO
        46 017045   021310 701000 46                 TSX1    ALPHANUMERIC_PRESET
        46 017046   000000 011000                    NOP     0
        46 017047   020061 710000 46                 TRA     s:26297

     3066    26024
     3067    26025    3          CASE(%TYA, %TYN, %TYE);

     3068    26026    3            IF PILL -> PRESET.OFFSET = 0  THEN

  26026 46 017050   200003 473500                    LDP3    @PILL,,AUTO
        46 017051   300000 474500                    LDP4    0,,PR3
        46 017052   400000 722100                    LXL2    0,,PR4
        46 017053   017076 601000 46                 TNZ     s:26039

     3069    26027                     %GET_ADSC_LEN(ST$ = TARGET$, RTN = TARGET_LENGTH);

  26029 46 017054   100003 236100                    LDQ     3,,PR1
        46 017055   004000 316003                    CANQ    2048,DU
        46 017056   017072 600000 46                 TZE     s:26035

  26030 46 017057   100005 475500                    LDP5    5,,PR1
        46 017060   500000 223100                    LDX3    0,,PR5
        46 017061   001105 103003                    CMPX3   581,DU
        46 017062   017067 601000 46                 TNZ     s:26033

  26031 46 017063   500003 476500                    LDP6    3,,PR5
        46 017064   600001 235100                    LDA     1,,PR6
        46 017065   200140 755100                    STA     TARGET_LENGTH,,AUTO
        46 017066   017102 710000 46                 TRA     s:26040
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:572  

  26033 46 017067   500001 235100                    LDA     1,,PR5
        46 017070   200140 755100                    STA     TARGET_LENGTH,,AUTO
        46 017071   017102 710000 46                 TRA     s:26040

  26035 46 017072   100001 236100                    LDQ     1,,PR1
        46 017073   007777 376007                    ANQ     4095,DL
        46 017074   200140 756100                    STQ     TARGET_LENGTH,,AUTO

  26036 46 017075   017102 710000 46                 TRA     s:26040

     3070    26038    3            ELSE
     3071    26039    3                TARGET_LENGTH = CONSTANT$ -> VARIABLE.ADSC.N;

  26039 46 017076   000001 475400 25                 LDP5    CONSTANT$
        46 017077   500001 236100                    LDQ     1,,PR5
        46 017100   007777 376007                    ANQ     4095,DL
        46 017101   200140 756100                    STQ     TARGET_LENGTH,,AUTO

     3072    26040    3            CALL ALPHANUMERIC_PRESET(TARGET_LENGTH);

  26040 46 017102   200140 634500                    EPPR4   TARGET_LENGTH,,AUTO
        46 017103   200263 454500                    STP4    LOWER$+2,,AUTO
        46 017104   021310 701000 46                 TSX1    ALPHANUMERIC_PRESET
        46 017105   000000 011000                    NOP     0
        46 017106   020061 710000 46                 TRA     s:26297

     3073    26041
     3074    26042    3          CASE(%TYD);

     3075    26043    3            IF NOT TARGET$ -> VARIABLE.B.SUB_CLASS.EDITED THEN

  26043 46 017107   100003 236100                    LDQ     3,,PR1
        46 017110   000004 316007                    CANQ    4,DL
        46 017111   017351 601000 46                 TNZ     s:26083

     3076    26044    4              DO;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:573  

     3077    26045    5                DO I=1 TO 63;

  26045 46 017112   000001 235007                    LDA     1,DL
        46 017113   200065 755100                    STA     I,,AUTO

     3078    26046    5                  MVN_BUFFER(I) = 0;

  26046 46 017114   200065 720100                    LXL0    I,,AUTO
        46 017115   200142 450110                    STZ     MVN_BUFFER,X0,AUTO

     3079    26047    5                END;

  26047 46 017116   200065 054100                    AOS     I,,AUTO
        46 017117   200065 235100                    LDA     I,,AUTO
        46 017120   000077 115007                    CMPA    63,DL
        46 017121   017114 604400 46                 TMOZ    s:26046

     3080    26048    4                MVN_BUFFER(0) = BUFFER;

  26048 46 017122   000004 236000 25                 LDQ     BUFFER
        46 017123   200142 756100                    STQ     MVN_BUFFER,,AUTO

     3081    26049
     3082    26050    4                IF PILL -> PRESET.OFFSET = 0  THEN

  26050 46 017124   200003 470500                    LDP0    @PILL,,AUTO
        46 017125   000000 471500                    LDP1    0,,PR0
        46 017126   100000 720100                    LXL0    0,,PR1
        46 017127   017227 601000 46                 TNZ     s:26064

     3083    26051    5                  DO;

     3084    26052    5                    IF TARGET$ -> VARIABLE.B.P     THEN

  26052 46 017130   200134 473500                    LDP3    TARGET$,,AUTO
        46 017131   300003 236100                    LDQ     3,,PR3
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:574  
        46 017132   000020 316003                    CANQ    16,DU
        46 017133   017155 600000 46                 TZE     s:26055

     3085    26053    5                     CALL Z9AU$MOVE_C3_NUMERIC(CONSTANT$->CONST.NDSC,TARGET$->VARIABLE
             26053                               .NDSC,STRING$,ADDR(MVN_BUFFER));

  26053 46 017134   200142 634500                    EPPR4   MVN_BUFFER,,AUTO
        46 017135   200302 454500                    STP4    ORG1+1,,AUTO
        46 017136   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 017137   200307 451500                    STP1    ORG1+6,,AUTO
        46 017140   200133 635500                    EPPR5   STRING$,,AUTO
        46 017141   200306 455500                    STP5    ORG1+5,,AUTO
        46 017142   200134 236100                    LDQ     TARGET$,,AUTO
        46 017143   000107 036000 47                 ADLQ    71
        46 017144   200305 756100                    STQ     ORG1+4,,AUTO
        46 017145   000001 236000 25                 LDQ     CONSTANT$
        46 017146   000107 036000 47                 ADLQ    71
        46 017147   200304 756100                    STQ     ORG1+3,,AUTO
        46 017150   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 017151   000025 631400 47                 EPPR1   21
        46 017152   000000 701000 xent               TSX1    Z9AU$MOVE_C3_NUMERIC
        46 017153   000000 011000                    NOP     0
        46 017154   017175 710000 46                 TRA     s:26057

     3086    26054    5                    ELSE
     3087    26055    5                      CALL Z9AU$MOVE_NUMERIC(CONSTANT$ -> CONST.NDSC,TARGET$ ->
             26055                               VARIABLE.NDSC,STRING$,ADDR(MVN_BUFFER));

  26055 46 017155   200142 634500                    EPPR4   MVN_BUFFER,,AUTO
        46 017156   200302 454500                    STP4    ORG1+1,,AUTO
        46 017157   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 017160   200307 451500                    STP1    ORG1+6,,AUTO
        46 017161   200133 635500                    EPPR5   STRING$,,AUTO
        46 017162   200306 455500                    STP5    ORG1+5,,AUTO
        46 017163   200134 236100                    LDQ     TARGET$,,AUTO
        46 017164   000107 036000 47                 ADLQ    71
        46 017165   200305 756100                    STQ     ORG1+4,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:575  
        46 017166   000001 236000 25                 LDQ     CONSTANT$
        46 017167   000107 036000 47                 ADLQ    71
        46 017170   200304 756100                    STQ     ORG1+3,,AUTO
        46 017171   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 017172   000025 631400 47                 EPPR1   21
        46 017173   000000 701000 xent               TSX1    Z9AU$MOVE_NUMERIC
        46 017174   000000 011000                    NOP     0

     3088    26056
     3089    26057    5                    IF TARGET$ -> VARIABLE.NDSC.TN = %NDSC4 THEN

  26057 46 017175   200134 470500                    LDP0    TARGET$,,AUTO
        46 017176   000001 236100                    LDQ     1,,PR0
        46 017177   040000 316007                    CANQ    16384,DL
        46 017200   017215 600000 46                 TZE     s:26060

     3090    26058    5                      BITS_IN_BUFFER = ((TARGET$ -> VARIABLE.NDSC.N + TARGET$ ->
             26058                               VARIABLE.NDSC.CN) * 9 + 1) / 2;

  26058 46 017201   000001 236100                    LDQ     1,,PR0
        46 017202   000017 772000                    QRL     15
        46 017203   000007 376007                    ANQ     7,DL
        46 017204   200302 756100                    STQ     ORG1+1,,AUTO
        46 017205   000001 236100                    LDQ     1,,PR0
        46 017206   000077 376007                    ANQ     63,DL
        46 017207   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 017210   000011 402007                    MPY     9,DL
        46 017211   000001 036007                    ADLQ    1,DL
        46 017212   000001 772000                    QRL     1
        46 017213   000003 756000 25                 STQ     BITS_IN_BUFFER
        46 017214   017321 710000 46                 TRA     s:26074

     3091    26059    5                    ELSE
     3092    26060    5                      BITS_IN_BUFFER = ((TARGET$ -> VARIABLE.NDSC.N + TARGET$ ->
             26060                               VARIABLE.ADSC.CN) * 9);

  26060 46 017215   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:576  
        46 017216   000020 772000                    QRL     16
        46 017217   000003 376007                    ANQ     3,DL
        46 017220   200302 756100                    STQ     ORG1+1,,AUTO
        46 017221   000001 236100                    LDQ     1,,PR0
        46 017222   000077 376007                    ANQ     63,DL
        46 017223   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 017224   000011 402007                    MPY     9,DL
        46 017225   000003 756000 25                 STQ     BITS_IN_BUFFER

     3093    26061    5                  END;

  26061 46 017226   017321 710000 46                 TRA     s:26074

     3094    26062    4                ELSE
     3095    26063    5                  DO;

     3096    26064    5                    IF TARGET$ -> VARIABLE.B.P    THEN

  26064 46 017227   200134 473500                    LDP3    TARGET$,,AUTO
        46 017230   300003 236100                    LDQ     3,,PR3
        46 017231   000020 316003                    CANQ    16,DU
        46 017232   017252 600000 46                 TZE     s:26067

     3097    26065    5                      CALL Z9AU$MOVE_C3_NUMERIC(CONSTANT$ -> CONST.NDSC,CONSTANT$ ->
             26065                               VARIABLE.NDSC,STRING$,ADDR(MVN_BUFFER));

  26065 46 017233   200142 634500                    EPPR4   MVN_BUFFER,,AUTO
        46 017234   200302 454500                    STP4    ORG1+1,,AUTO
        46 017235   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 017236   200307 451500                    STP1    ORG1+6,,AUTO
        46 017237   200133 635500                    EPPR5   STRING$,,AUTO
        46 017240   200306 455500                    STP5    ORG1+5,,AUTO
        46 017241   000001 236000 25                 LDQ     CONSTANT$
        46 017242   000107 036000 47                 ADLQ    71
        46 017243   200305 756100                    STQ     ORG1+4,,AUTO
        46 017244   200304 756100                    STQ     ORG1+3,,AUTO
        46 017245   200304 630500                    EPPR0   ORG1+3,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:577  
        46 017246   000025 631400 47                 EPPR1   21
        46 017247   000000 701000 xent               TSX1    Z9AU$MOVE_C3_NUMERIC
        46 017250   000000 011000                    NOP     0
        46 017251   017270 710000 46                 TRA     s:26068

     3098    26066    5                    ELSE
     3099    26067    5                      CALL Z9AU$MOVE_NUMERIC(CONSTANT$ -> CONST.NDSC,CONSTANT$ ->
             26067                               VARIABLE.NDSC,STRING$,ADDR(MVN_BUFFER));

  26067 46 017252   200142 634500                    EPPR4   MVN_BUFFER,,AUTO
        46 017253   200302 454500                    STP4    ORG1+1,,AUTO
        46 017254   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 017255   200307 451500                    STP1    ORG1+6,,AUTO
        46 017256   200133 635500                    EPPR5   STRING$,,AUTO
        46 017257   200306 455500                    STP5    ORG1+5,,AUTO
        46 017260   000001 236000 25                 LDQ     CONSTANT$
        46 017261   000107 036000 47                 ADLQ    71
        46 017262   200305 756100                    STQ     ORG1+4,,AUTO
        46 017263   200304 756100                    STQ     ORG1+3,,AUTO
        46 017264   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 017265   000025 631400 47                 EPPR1   21
        46 017266   000000 701000 xent               TSX1    Z9AU$MOVE_NUMERIC
        46 017267   000000 011000                    NOP     0

     3100    26068    5                    IF CONSTANT$ -> VARIABLE.NDSC.TN = %NDSC4 THEN

  26068 46 017270   000001 470400 25                 LDP0    CONSTANT$
        46 017271   000001 236100                    LDQ     1,,PR0
        46 017272   040000 316007                    CANQ    16384,DL
        46 017273   017310 600000 46                 TZE     s:26071

     3101    26069    5                      BITS_IN_BUFFER = ((CONSTANT$ -> VARIABLE.NDSC.N + CONSTANT$ ->
             26069                               VARIABLE.NDSC.CN) * 9 + 1) / 2;

  26069 46 017274   000001 236100                    LDQ     1,,PR0
        46 017275   000017 772000                    QRL     15
        46 017276   000007 376007                    ANQ     7,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:578  
        46 017277   200302 756100                    STQ     ORG1+1,,AUTO
        46 017300   000001 236100                    LDQ     1,,PR0
        46 017301   000077 376007                    ANQ     63,DL
        46 017302   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 017303   000011 402007                    MPY     9,DL
        46 017304   000001 036007                    ADLQ    1,DL
        46 017305   000001 772000                    QRL     1
        46 017306   000003 756000 25                 STQ     BITS_IN_BUFFER
        46 017307   017321 710000 46                 TRA     s:26074

     3102    26070    5                    ELSE
     3103    26071    5                      BITS_IN_BUFFER = ((CONSTANT$ -> VARIABLE.NDSC.N + CONSTANT$ ->
             26071                               VARIABLE.ADSC.CN) * 9);

  26071 46 017310   000001 236100                    LDQ     1,,PR0
        46 017311   000020 772000                    QRL     16
        46 017312   000003 376007                    ANQ     3,DL
        46 017313   200302 756100                    STQ     ORG1+1,,AUTO
        46 017314   000001 236100                    LDQ     1,,PR0
        46 017315   000077 376007                    ANQ     63,DL
        46 017316   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 017317   000011 402007                    MPY     9,DL
        46 017320   000003 756000 25                 STQ     BITS_IN_BUFFER

     3104    26072    5                  END;

     3105    26073
     3106    26074    4                LENGTH_IN_WORDS = BITS_IN_BUFFER / 36;

  26074 46 017321   000044 506007                    DIV     36,DL
        46 017322   200132 756100                    STQ     LENGTH_IN_WORDS,,AUTO

     3107    26075
     3108    26076    4                CALL FLUSH(CONSTANT$,ADDR(MVN_BUFFER),CURRENT_SA,LENGTH_IN_WORDS);

  26076 46 017323   200142 630500                    EPPR0   MVN_BUFFER,,AUTO
        46 017324   200320 450500                    STP0    ORG1+15,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:579  
        46 017325   200132 631500                    EPPR1   LENGTH_IN_WORDS,,AUTO
        46 017326   200272 451500                    STP1    @OPND$+1,,AUTO
        46 017327   200242 633500                    EPPR3   CURRENT_SA,,AUTO
        46 017330   200271 453500                    STP3    @STRING$+1,,AUTO
        46 017331   200320 634500                    EPPR4   ORG1+15,,AUTO
        46 017332   200270 454500                    STP4    N_OPNDS+1,,AUTO
        46 017333   000106 236000 47                 LDQ     70
        46 017334   200267 756100                    STQ     P$+1,,AUTO
        46 017335   021724 701000 46                 TSX1    FLUSH
        46 017336   000000 011000                    NOP     0

     3109    26077
     3110    26078    4                BUFFER = MVN_BUFFER(LENGTH_IN_WORDS);

  26078 46 017337   200132 720100                    LXL0    LENGTH_IN_WORDS,,AUTO
        46 017340   200142 235110                    LDA     MVN_BUFFER,X0,AUTO
        46 017341   000004 755000 25                 STA     BUFFER

     3111    26079    4                OLD_SA = CURRENT_SA + (LENGTH_IN_WORDS);

  26079 46 017342   200242 236100                    LDQ     CURRENT_SA,,AUTO
        46 017343   200132 036100                    ADLQ    LENGTH_IN_WORDS,,AUTO
        46 017344   000006 756000 25                 STQ     OLD_SA

     3112    26080    4                BITS_IN_BUFFER = MOD(BITS_IN_BUFFER, 36);

  26080 46 017345   000003 236000 25                 LDQ     BITS_IN_BUFFER
        46 017346   000044 506007                    DIV     36,DL
        46 017347   000003 755000 25                 STA     BITS_IN_BUFFER

     3113    26081    4              END;

  26081 46 017350   020061 710000 46                 TRA     s:26297

     3114    26082    3            ELSE
     3115    26083    3              IF PILL -> PRESET.OFFSET = 0  THEN

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:580  
  26083 46 017351   200003 473500                    LDP3    @PILL,,AUTO
        46 017352   300000 474500                    LDP4    0,,PR3
        46 017353   400000 722100                    LXL2    0,,PR4
        46 017354   017365 601000 46                 TNZ     s:26086

     3116    26084    3                  CALL ALPHANUMERIC_PRESET(BINBIT(TARGET$ -> VARIABLE.NDSC.N, 36));

  26084 46 017355   100001 236100                    LDQ     1,,PR1
        46 017356   000077 376007                    ANQ     63,DL
        46 017357   200322 756100                    STQ     ORG1+17,,AUTO
        46 017360   200322 634500                    EPPR4   ORG1+17,,AUTO
        46 017361   200263 454500                    STP4    LOWER$+2,,AUTO
        46 017362   021310 701000 46                 TSX1    ALPHANUMERIC_PRESET
        46 017363   000000 011000                    NOP     0
        46 017364   020061 710000 46                 TRA     s:26297

     3117    26085    3               ELSE
     3118    26086    3                  CALL ALPHANUMERIC_PRESET(BINBIT(CONSTANT$ -> VARIABLE.NDSC.N, 36));

  26086 46 017365   000001 475400 25                 LDP5    CONSTANT$
        46 017366   500001 236100                    LDQ     1,,PR5
        46 017367   000077 376007                    ANQ     63,DL
        46 017370   200324 756100                    STQ     ORG1+19,,AUTO
        46 017371   200324 634500                    EPPR4   ORG1+19,,AUTO
        46 017372   200263 454500                    STP4    LOWER$+2,,AUTO
        46 017373   021310 701000 46                 TSX1    ALPHANUMERIC_PRESET
        46 017374   000000 011000                    NOP     0
        46 017375   020061 710000 46                 TRA     s:26297

     3119    26087
     3120    26088    3          CASE(%TYF); /* Preset EBCDIC numeric */

     3121    26089    4            DO I = 1 TO 63;

  26089 46 017376   000001 235007                    LDA     1,DL
        46 017377   200065 755100                    STA     I,,AUTO

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:581  
     3122    26090    4              MVN_BUFFER(I) = 0;

  26090 46 017400   200065 720100                    LXL0    I,,AUTO
        46 017401   200142 450110                    STZ     MVN_BUFFER,X0,AUTO

     3123    26091    4            END;

  26091 46 017402   200065 054100                    AOS     I,,AUTO
        46 017403   200065 235100                    LDA     I,,AUTO
        46 017404   000077 115007                    CMPA    63,DL
        46 017405   017400 604400 46                 TMOZ    s:26090

     3124    26092    3            MVN_BUFFER(0) = BUFFER;

  26092 46 017406   000004 236000 25                 LDQ     BUFFER
        46 017407   200142 756100                    STQ     MVN_BUFFER,,AUTO

     3125    26093
     3126    26094    3            IF PILL -> PRESET.OFFSET = 0 THEN

  26094 46 017410   200003 470500                    LDP0    @PILL,,AUTO
        46 017411   000000 471500                    LDP1    0,,PR0
        46 017412   100000 720100                    LXL0    0,,PR1
        46 017413   017447 601000 46                 TNZ     s:26101

     3127    26095    4              DO;

     3128    26096    4               CALL Z9AU$MOVE_EBCDIC(CONSTANT$ -> CONST.NDSC, TARGET$ -> VARIABLE.NDSC
             26096                         ,STRING$,ADDR(MVN_BUFFER));

  26096 46 017414   200142 633500                    EPPR3   MVN_BUFFER,,AUTO
        46 017415   200302 453500                    STP3    ORG1+1,,AUTO
        46 017416   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 017417   200307 451500                    STP1    ORG1+6,,AUTO
        46 017420   200133 634500                    EPPR4   STRING$,,AUTO
        46 017421   200306 454500                    STP4    ORG1+5,,AUTO
        46 017422   200134 236100                    LDQ     TARGET$,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:582  
        46 017423   000107 036000 47                 ADLQ    71
        46 017424   200305 756100                    STQ     ORG1+4,,AUTO
        46 017425   000001 236000 25                 LDQ     CONSTANT$
        46 017426   000107 036000 47                 ADLQ    71
        46 017427   200304 756100                    STQ     ORG1+3,,AUTO
        46 017430   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 017431   000025 631400 47                 EPPR1   21
        46 017432   000000 701000 xent               TSX1    Z9AU$MOVE_EBCDIC
        46 017433   000000 011000                    NOP     0

     3129    26097    4                BITS_IN_BUFFER = ((TARGET$ -> VARIABLE.NDSC.N + TARGET$ -> VARIABLE.
             26097                         ADSC.CN) * 9);

  26097 46 017434   200134 470500                    LDP0    TARGET$,,AUTO
        46 017435   000001 236100                    LDQ     1,,PR0
        46 017436   000020 772000                    QRL     16
        46 017437   000003 376007                    ANQ     3,DL
        46 017440   200302 756100                    STQ     ORG1+1,,AUTO
        46 017441   000001 236100                    LDQ     1,,PR0
        46 017442   000077 376007                    ANQ     63,DL
        46 017443   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 017444   000011 402007                    MPY     9,DL
        46 017445   000003 756000 25                 STQ     BITS_IN_BUFFER

     3130    26098    4              END;

  26098 46 017446   017477 710000 46                 TRA     s:26105

     3131    26099    3            ELSE
     3132    26100    4              DO;

     3133    26101    4                CALL Z9AU$MOVE_EBCDIC(CONSTANT$ -> CONST.NDSC,CONSTANT$ -> VARIABLE.
             26101                         NDSC,STRING$,ADDR(MVN_BUFFER));

  26101 46 017447   200142 633500                    EPPR3   MVN_BUFFER,,AUTO
        46 017450   200302 453500                    STP3    ORG1+1,,AUTO
        46 017451   200302 631500                    EPPR1   ORG1+1,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:583  
        46 017452   200307 451500                    STP1    ORG1+6,,AUTO
        46 017453   200133 634500                    EPPR4   STRING$,,AUTO
        46 017454   200306 454500                    STP4    ORG1+5,,AUTO
        46 017455   000001 236000 25                 LDQ     CONSTANT$
        46 017456   000107 036000 47                 ADLQ    71
        46 017457   200305 756100                    STQ     ORG1+4,,AUTO
        46 017460   200304 756100                    STQ     ORG1+3,,AUTO
        46 017461   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 017462   000025 631400 47                 EPPR1   21
        46 017463   000000 701000 xent               TSX1    Z9AU$MOVE_EBCDIC
        46 017464   000000 011000                    NOP     0

     3134    26102    4               BITS_IN_BUFFER = ((CONSTANT$ -> VARIABLE.NDSC.N + CONSTANT$ -> VARIABLE
             26102                         .ADSC.CN) * 9);

  26102 46 017465   000001 470400 25                 LDP0    CONSTANT$
        46 017466   000001 236100                    LDQ     1,,PR0
        46 017467   000020 772000                    QRL     16
        46 017470   000003 376007                    ANQ     3,DL
        46 017471   200302 756100                    STQ     ORG1+1,,AUTO
        46 017472   000001 236100                    LDQ     1,,PR0
        46 017473   000077 376007                    ANQ     63,DL
        46 017474   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 017475   000011 402007                    MPY     9,DL
        46 017476   000003 756000 25                 STQ     BITS_IN_BUFFER

     3135    26103    4              END;

     3136    26104
     3137    26105    3            LENGTH_IN_WORDS = BITS_IN_BUFFER / 36;

  26105 46 017477   000044 506007                    DIV     36,DL
        46 017500   200132 756100                    STQ     LENGTH_IN_WORDS,,AUTO

     3138    26106
     3139    26107    3            CALL FLUSH(CONSTANT$,ADDR(MVN_BUFFER),CURRENT_SA,LENGTH_IN_WORDS);

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:584  
  26107 46 017501   200142 630500                    EPPR0   MVN_BUFFER,,AUTO
        46 017502   200326 450500                    STP0    ORG1+21,,AUTO
        46 017503   200132 631500                    EPPR1   LENGTH_IN_WORDS,,AUTO
        46 017504   200272 451500                    STP1    @OPND$+1,,AUTO
        46 017505   200242 633500                    EPPR3   CURRENT_SA,,AUTO
        46 017506   200271 453500                    STP3    @STRING$+1,,AUTO
        46 017507   200326 634500                    EPPR4   ORG1+21,,AUTO
        46 017510   200270 454500                    STP4    N_OPNDS+1,,AUTO
        46 017511   000106 236000 47                 LDQ     70
        46 017512   200267 756100                    STQ     P$+1,,AUTO
        46 017513   021724 701000 46                 TSX1    FLUSH
        46 017514   000000 011000                    NOP     0

     3140    26108
     3141    26109    3            BUFFER = MVN_BUFFER(LENGTH_IN_WORDS);

  26109 46 017515   200132 720100                    LXL0    LENGTH_IN_WORDS,,AUTO
        46 017516   200142 235110                    LDA     MVN_BUFFER,X0,AUTO
        46 017517   000004 755000 25                 STA     BUFFER

     3142    26110    3            OLD_SA = CURRENT_SA + (LENGTH_IN_WORDS);

  26110 46 017520   200242 236100                    LDQ     CURRENT_SA,,AUTO
        46 017521   200132 036100                    ADLQ    LENGTH_IN_WORDS,,AUTO
        46 017522   000006 756000 25                 STQ     OLD_SA

     3143    26111    3            BITS_IN_BUFFER = MOD(BITS_IN_BUFFER, 36);

  26111 46 017523   000003 236000 25                 LDQ     BITS_IN_BUFFER
        46 017524   000044 506007                    DIV     36,DL
        46 017525   000003 755000 25                 STA     BITS_IN_BUFFER
        46 017526   020061 710000 46                 TRA     s:26297

     3144    26112
     3145    26113    3          CASE(%TYC); /* Preset GBCD numeric */

     3146    26114    4            DO I = 1 TO 63;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:585  

  26114 46 017527   000001 235007                    LDA     1,DL
        46 017530   200065 755100                    STA     I,,AUTO

     3147    26115    4              MVN_BUFFER(I) = 0;

  26115 46 017531   200065 720100                    LXL0    I,,AUTO
        46 017532   200142 450110                    STZ     MVN_BUFFER,X0,AUTO

     3148    26116    4            END;

  26116 46 017533   200065 054100                    AOS     I,,AUTO
        46 017534   200065 235100                    LDA     I,,AUTO
        46 017535   000077 115007                    CMPA    63,DL
        46 017536   017531 604400 46                 TMOZ    s:26115

     3149    26117    3            MVN_BUFFER(0) = BUFFER;

  26117 46 017537   000004 236000 25                 LDQ     BUFFER
        46 017540   200142 756100                    STQ     MVN_BUFFER,,AUTO

     3150    26118
     3151    26119    3            CALL Z9AU$MOVE_GBCD(CONSTANT$ -> CONST.NDSC,TARGET$ -> VARIABLE.NDSC,
             26119                     STRING$,ADDR(MVN_BUFFER));

  26119 46 017541   200142 630500                    EPPR0   MVN_BUFFER,,AUTO
        46 017542   200302 450500                    STP0    ORG1+1,,AUTO
        46 017543   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 017544   200307 451500                    STP1    ORG1+6,,AUTO
        46 017545   200133 633500                    EPPR3   STRING$,,AUTO
        46 017546   200306 453500                    STP3    ORG1+5,,AUTO
        46 017547   200134 236100                    LDQ     TARGET$,,AUTO
        46 017550   000107 036000 47                 ADLQ    71
        46 017551   200305 756100                    STQ     ORG1+4,,AUTO
        46 017552   000001 236000 25                 LDQ     CONSTANT$
        46 017553   000107 036000 47                 ADLQ    71
        46 017554   200304 756100                    STQ     ORG1+3,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:586  
        46 017555   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 017556   000025 631400 47                 EPPR1   21
        46 017557   000000 701000 xent               TSX1    Z9AU$MOVE_GBCD
        46 017560   000000 011000                    NOP     0

     3152    26120
     3153    26121    3           BITS_IN_BUFFER = ((TARGET$ -> VARIABLE.NDSC.N + TARGET$ -> VARIABLE.NDSC.CN
             26121                     ) * 6);

  26121 46 017561   200134 470500                    LDP0    TARGET$,,AUTO
        46 017562   000001 236100                    LDQ     1,,PR0
        46 017563   000017 772000                    QRL     15
        46 017564   000007 376007                    ANQ     7,DL
        46 017565   200302 756100                    STQ     ORG1+1,,AUTO
        46 017566   000001 236100                    LDQ     1,,PR0
        46 017567   000077 376007                    ANQ     63,DL
        46 017570   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 017571   000006 402007                    MPY     6,DL
        46 017572   000003 756000 25                 STQ     BITS_IN_BUFFER

     3154    26122
     3155    26123    3            LENGTH_IN_WORDS = BITS_IN_BUFFER / 36;

  26123 46 017573   000044 506007                    DIV     36,DL
        46 017574   200132 756100                    STQ     LENGTH_IN_WORDS,,AUTO

     3156    26124
     3157    26125    3            CALL FLUSH(CONSTANT$,ADDR(MVN_BUFFER),CURRENT_SA,LENGTH_IN_WORDS);

  26125 46 017575   200142 631500                    EPPR1   MVN_BUFFER,,AUTO
        46 017576   200327 451500                    STP1    ORG1+22,,AUTO
        46 017577   200132 633500                    EPPR3   LENGTH_IN_WORDS,,AUTO
        46 017600   200272 453500                    STP3    @OPND$+1,,AUTO
        46 017601   200242 634500                    EPPR4   CURRENT_SA,,AUTO
        46 017602   200271 454500                    STP4    @STRING$+1,,AUTO
        46 017603   200327 635500                    EPPR5   ORG1+22,,AUTO
        46 017604   200270 455500                    STP5    N_OPNDS+1,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:587  
        46 017605   000106 236000 47                 LDQ     70
        46 017606   200267 756100                    STQ     P$+1,,AUTO
        46 017607   021724 701000 46                 TSX1    FLUSH
        46 017610   000000 011000                    NOP     0

     3158    26126
     3159    26127    3            BUFFER = MVN_BUFFER(LENGTH_IN_WORDS);

  26127 46 017611   200132 720100                    LXL0    LENGTH_IN_WORDS,,AUTO
        46 017612   200142 235110                    LDA     MVN_BUFFER,X0,AUTO
        46 017613   000004 755000 25                 STA     BUFFER

     3160    26128    3            OLD_SA = CURRENT_SA + (LENGTH_IN_WORDS);

  26128 46 017614   200242 236100                    LDQ     CURRENT_SA,,AUTO
        46 017615   200132 036100                    ADLQ    LENGTH_IN_WORDS,,AUTO
        46 017616   000006 756000 25                 STQ     OLD_SA

     3161    26129    3            BITS_IN_BUFFER = MOD(BITS_IN_BUFFER, 36);

  26129 46 017617   000003 236000 25                 LDQ     BITS_IN_BUFFER
        46 017620   000044 506007                    DIV     36,DL
        46 017621   000003 755000 25                 STA     BITS_IN_BUFFER
        46 017622   020061 710000 46                 TRA     s:26297

     3162    26130
     3163    26131    3          CASE(%TYB); /* Preset GBCD */

     3164    26132    3            IF PILL -> PRESET.OFFSET = 0 THEN

  26132 46 017623   200003 473500                    LDP3    @PILL,,AUTO
        46 017624   300000 474500                    LDP4    0,,PR3
        46 017625   400000 722100                    LXL2    0,,PR4
        46 017626   017651 601000 46                 TNZ     s:26145

     3165    26133                   %GET_ADSC_LEN(ST$ = TARGET$, RTN = TARGET_LENGTH);

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:588  
  26135 46 017627   100003 236100                    LDQ     3,,PR1
        46 017630   004000 316003                    CANQ    2048,DU
        46 017631   017645 600000 46                 TZE     s:26141

  26136 46 017632   100005 475500                    LDP5    5,,PR1
        46 017633   500000 223100                    LDX3    0,,PR5
        46 017634   001105 103003                    CMPX3   581,DU
        46 017635   017642 601000 46                 TNZ     s:26139

  26137 46 017636   500003 476500                    LDP6    3,,PR5
        46 017637   600001 235100                    LDA     1,,PR6
        46 017640   200140 755100                    STA     TARGET_LENGTH,,AUTO
        46 017641   017655 710000 46                 TRA     s:26146

  26139 46 017642   500001 235100                    LDA     1,,PR5
        46 017643   200140 755100                    STA     TARGET_LENGTH,,AUTO
        46 017644   017655 710000 46                 TRA     s:26146

  26141 46 017645   100001 236100                    LDQ     1,,PR1
        46 017646   007777 376007                    ANQ     4095,DL
        46 017647   200140 756100                    STQ     TARGET_LENGTH,,AUTO

  26142 46 017650   017655 710000 46                 TRA     s:26146

     3166    26144    3            ELSE
     3167    26145    3              TARGET_LENGTH = CONSTANT$ -> VARIABLE.ADSC.N;

  26145 46 017651   000001 475400 25                 LDP5    CONSTANT$
        46 017652   500001 236100                    LDQ     1,,PR5
        46 017653   007777 376007                    ANQ     4095,DL
        46 017654   200140 756100                    STQ     TARGET_LENGTH,,AUTO

     3168    26146    3            CALL GBCD_PRESET(TARGET_LENGTH);

  26146 46 017655   200140 634500                    EPPR4   TARGET_LENGTH,,AUTO
        46 017656   200263 454500                    STP4    LOWER$+2,,AUTO
        46 017657   021456 701000 46                 TSX1    GBCD_PRESET
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:589  
        46 017660   000000 011000                    NOP     0
        46 017661   020061 710000 46                 TRA     s:26297

     3169    26147
     3170    26148    3          CASE(%TYP);

     3171    26149
     3172    26150    3            IF CONSTANT$ -> ST.ID = %CONST AND

  26150 46 017662   000001 473400 25                 LDP3    CONSTANT$
        46 017663   300000 222100                    LDX2    0,,PR3
        46 017664   000767 102003                    CMPX2   503,DU
        46 017665   017710 601000 46                 TNZ     s:26175
        46 017666   300002 223100                    LDX3    2,,PR3
        46 017667   000001 103003                    CMPX3   1,DU
        46 017670   017710 601000 46                 TNZ     s:26175

     3173    26151    3              CONSTANT$ -> CONST.TYPE = %TYI THEN
     3174    26152    4              DO;

     3175    26153    4                CALL FLUSH(CONSTANT$,STRING$,CURRENT_SA,(CONSTANT$->CONST.NDSC.N/4));

  26153 46 017671   300001 236100                    LDQ     1,,PR3
        46 017672   000077 376007                    ANQ     63,DL
        46 017673   000002 772000                    QRL     2
        46 017674   200330 756100                    STQ     ORG1+23,,AUTO
        46 017675   200330 634500                    EPPR4   ORG1+23,,AUTO
        46 017676   200272 454500                    STP4    @OPND$+1,,AUTO
        46 017677   200242 635500                    EPPR5   CURRENT_SA,,AUTO
        46 017700   200271 455500                    STP5    @STRING$+1,,AUTO
        46 017701   200133 636500                    EPPR6   STRING$,,AUTO
        46 017702   200270 456500                    STP6    N_OPNDS+1,,AUTO
        46 017703   000106 236000 47                 LDQ     70
        46 017704   200267 756100                    STQ     P$+1,,AUTO
        46 017705   021724 701000 46                 TSX1    FLUSH
        46 017706   000000 011000                    NOP     0

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:590  
     3176    26154    4              END;

  26154 46 017707   020056 710000 46                 TRA     s:26293

     3177    26155    3            ELSE
     3178    26156    4              DO;

     3179    26157                     %NEW_ORG ( @ST$ = COMCOM.BLOCK$ );

  26175 46 017710   000002 236000 36                 LDQ     OBJ_+2
        46 017711   000002 036007                    ADLQ    2,DL
        46 017712   000003 116000 36                 CMPQ    OBJ_+3
        46 017713   017725 604000 46                 TMI     s:26181

  26177 46 017714   000000 234000 30                 SZN     PAGING_OBJ
        46 017715   017722 605000 46                 TPL     s:26179

  26178 46 017716   000006 630400 47                 EPPR0   6
        46 017717   000000 631400 47                 EPPR1   0
        46 017720   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 017721   000000 011000                    NOP     0

  26179 46 017722   000007 631400 47                 EPPR1   7
        46 017723   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 017724   000000 011000                    NOP     0

  26181 46 017725   000002 236000 36                 LDQ     OBJ_+2
        46 017726   000022 736000                    QLS     18
        46 017727   000001 036000 36                 ADLQ    OBJ_+1
        46 017730   000000 756000 29                 STQ     OBJ$

  26182 46 017731   000002 236007                    LDQ     2,DL
        46 017732   000002 056000 36                 ASQ     OBJ_+2

  26183 46 017733   001013 220003                    LDX0    523,DU
        46 017734   000000 470400 29                 LDP0    OBJ$
        46 017735   000000 740100                    STX0    0,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:591  

  26187 46 017736   000145 236000 xsym               LDQ     COMCOM+101
        46 017737   000000 470400 29                 LDP0    OBJ$
        46 017740   000001 756100                    STQ     1,,PR0

     3180    26193    4                CURRENT_BLOCK$ = COMCOM.BLOCK$;

  26193 46 017741   000145 236000 xsym               LDQ     COMCOM+101
        46 017742   000000 756000 26                 STQ     CURRENT_BLOCK$

     3181    26194
     3182    26195    4                INST_WORD = '0'O;

  26195 46 017743   200012 450100                    STZ     INST_WORD,,AUTO

     3183    26196
     3184    26197    4                MOD_KEY.KEY = 0;

  26197 46 017744   000000 450000 25                 STZ     MOD_KEY

     3185    26198    4                MOD_KEY.B.WORD_REL = TRUE;

  26198 46 017745   000002 236007                    LDQ     2,DL
        46 017746   000000 256000 25                 ORSQ    MOD_KEY

     3186    26199    4                MOD_KEY.B.RESOLVE_ADDRESS = TRUE;

  26199 46 017747   000020 236007                    LDQ     16,DL
        46 017750   000000 256000 25                 ORSQ    MOD_KEY

     3187    26200
     3188    26201                     %NEW_WORD( @OU_WORD = INST_WORD ,
     3189    26202                                @KEY     = MOD_KEY.KEY ,
     3190    26203                                @ST$     = PILL -> ETT.ROP ,
     3191    26204                                @OFFSET  =
             26204                                   PILL -> ETT.LOP -> VARIABLE.SA + PILL -> PRESET.OFFSET ,
     3192    26205                                @ADVANCE_BLOCK_SIZE = NO);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:592  

  26224 46 017751   000002 236000 36                 LDQ     OBJ_+2
        46 017752   000004 036007                    ADLQ    4,DL
        46 017753   000003 116000 36                 CMPQ    OBJ_+3
        46 017754   017766 604000 46                 TMI     s:26230

  26226 46 017755   000000 234000 30                 SZN     PAGING_OBJ
        46 017756   017763 605000 46                 TPL     s:26228

  26227 46 017757   000006 630400 47                 EPPR0   6
        46 017760   000000 631400 47                 EPPR1   0
        46 017761   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 017762   000000 011000                    NOP     0

  26228 46 017763   000007 631400 47                 EPPR1   7
        46 017764   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 017765   000000 011000                    NOP     0

  26230 46 017766   000002 236000 36                 LDQ     OBJ_+2
        46 017767   000022 736000                    QLS     18
        46 017770   000001 036000 36                 ADLQ    OBJ_+1
        46 017771   000000 756000 29                 STQ     OBJ$

  26231 46 017772   000004 236007                    LDQ     4,DL
        46 017773   000002 056000 36                 ASQ     OBJ_+2

  26232 46 017774   001012 220003                    LDX0    522,DU
        46 017775   000000 470400 29                 LDP0    OBJ$
        46 017776   000000 740100                    STX0    0,,PR0

  26235 46 017777   200003 470500                    LDP0    @PILL,,AUTO
        46 020000   000000 471500                    LDP1    0,,PR0
        46 020001   100002 236100                    LDQ     2,,PR1
        46 020002   000000 473400 29                 LDP3    OBJ$
        46 020003   300002 756100                    STQ     2,,PR3

  26236 46 020004   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:593  
        46 020005   100001 474500                    LDP4    1,,PR1
        46 020006   100000 236100                    LDQ     0,,PR1
        46 020007   777777 376007                    ANQ     -1,DL
        46 020010   200302 756100                    STQ     ORG1+1,,AUTO
        46 020011   400001 236100                    LDQ     1,,PR4
        46 020012   000022 772000                    QRL     18
        46 020013   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 020014   300001 756100                    STQ     1,,PR3

  26237 46 020015   000000 236000 25                 LDQ     MOD_KEY
        46 020016   000011 736000                    QLS     9
        46 020017   300000 552110                    STBQ    0,'10'O,PR3

  26239 46 020020   200012 236100                    LDQ     INST_WORD,,AUTO
        46 020021   000000 471400 29                 LDP1    OBJ$
        46 020022   100003 756100                    STQ     3,,PR1

     3193    26252
     3194    26253                     %NEW_ORG ( @ST$ = "COMCOM.SEGMENT$(%PROC)" );

  26271 46 020023   000002 236000 36                 LDQ     OBJ_+2
        46 020024   000002 036007                    ADLQ    2,DL
        46 020025   000003 116000 36                 CMPQ    OBJ_+3
        46 020026   020040 604000 46                 TMI     s:26277

  26273 46 020027   000000 234000 30                 SZN     PAGING_OBJ
        46 020030   020035 605000 46                 TPL     s:26275

  26274 46 020031   000006 630400 47                 EPPR0   6
        46 020032   000000 631400 47                 EPPR1   0
        46 020033   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 020034   000000 011000                    NOP     0

  26275 46 020035   000007 631400 47                 EPPR1   7
        46 020036   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 020037   000000 011000                    NOP     0

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:594  
  26277 46 020040   000002 236000 36                 LDQ     OBJ_+2
        46 020041   000022 736000                    QLS     18
        46 020042   000001 036000 36                 ADLQ    OBJ_+1
        46 020043   000000 756000 29                 STQ     OBJ$

  26278 46 020044   000002 236007                    LDQ     2,DL
        46 020045   000002 056000 36                 ASQ     OBJ_+2

  26279 46 020046   001013 220003                    LDX0    523,DU
        46 020047   000000 470400 29                 LDP0    OBJ$
        46 020050   000000 740100                    STX0    0,,PR0

  26283 46 020051   000150 236000 xsym               LDQ     COMCOM+104
        46 020052   000000 470400 29                 LDP0    OBJ$
        46 020053   000001 756100                    STQ     1,,PR0

     3195    26289    4                CURRENT_BLOCK$ = COMCOM.SEGMENT$(%PROC);

  26289 46 020054   000150 236000 xsym               LDQ     COMCOM+104
        46 020055   000000 756000 26                 STQ     CURRENT_BLOCK$

     3196    26290
     3197    26291    4             END;

     3198    26292
     3199    26293    3            BITS_IN_BUFFER = 0;

  26293 46 020056   000003 450000 25                 STZ     BITS_IN_BUFFER

     3200    26294    3            OLD_SA = CURRENT_SA;

  26294 46 020057   200242 235100                    LDA     CURRENT_SA,,AUTO
        46 020060   000006 755000 25                 STA     OLD_SA

     3201    26295    3        END /* Case */;

     3202    26296
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:595  
     3203    26297    2        IF BITS_IN_BUFFER = 0 THEN

  26297 46 020061   000003 235000 25                 LDA     BITS_IN_BUFFER
        46 020062   020067 601000 46                 TNZ     s:26303

     3204    26298    3          DO;

     3205    26299    3            FLUSH_BLK$ = ADDR(NIL);

  26299 46 020063   000005 236000 47                 LDQ     5
        46 020064   000005 756000 25                 STQ     FLUSH_BLK$

     3206    26300    3            BUFFER = 0;

  26300 46 020065   000004 450000 25                 STZ     BUFFER

     3207    26301    3          END;

  26301 46 020066   020071 710000 46                 TRA     s:26306

     3208    26302    2        ELSE
     3209    26303    2          FLUSH_BLK$ = CURRENT_BLOCK$;

  26303 46 020067   000000 236000 26                 LDQ     CURRENT_BLOCK$
        46 020070   000005 756000 25                 STQ     FLUSH_BLK$

     3210    26304
     3211    26305
     3212    26306    2        IF TARGET$ -> VARIABLE.B.ARRAY_PRESET THEN

  26306 46 020071   200134 470500                    LDP0    TARGET$,,AUTO
        46 020072   000003 236100                    LDQ     3,,PR0
        46 020073   000020 316007                    CANQ    16,DL
        46 020074   021307 600000 46                 TZE     s:26924

     3213    26307    3            DO;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:596  
     3214    26308    3              TARGET$ -> VARIABLE.QLT$ -> QLT.B.ARRAY_VALUED = TRUE;

  26308 46 020075   000007 471500                    LDP1    7,,PR0
        46 020076   020000 236007                    LDQ     8192,DL
        46 020077   100000 256100                    ORSQ    0,,PR1

     3215    26309
     3216    26310                   %NEW_ARRAY_PRESET_LTS (@CONSTANT$ = CONSTANT$,
     3217    26311                                          @STRING$   = STRING$,
     3218    26312                                          @BITS_LEFT = BITS_IN_BUFFER);

  26391 46 020100   000002 236000 41                 LDQ     LTS_+2
        46 020101   000005 036007                    ADLQ    5,DL
        46 020102   000003 116000 41                 CMPQ    LTS_+3
        46 020103   020114 604000 46                 TMI     s:26393

  26392 46 020104   000035 236000 47                 LDQ     29
        46 020105   200302 756100                    STQ     ORG1+1,,AUTO
        46 020106   200302 631500                    EPPR1   ORG1+1,,AUTO
        46 020107   200303 451500                    STP1    ORG1+2,,AUTO
        46 020110   200303 630500                    EPPR0   ORG1+2,,AUTO
        46 020111   000000 631400 47                 EPPR1   0
        46 020112   000000 701000 xent               TSX1    Z8AR$RESERVER
        46 020113   000000 011000                    NOP     0

  26393 46 020114   000002 236000 41                 LDQ     LTS_+2
        46 020115   000022 736000                    QLS     18
        46 020116   000001 036000 41                 ADLQ    LTS_+1
        46 020117   000000 756000 40                 STQ     LTS$

  26394 46 020120   000005 236007                    LDQ     5,DL
        46 020121   000002 056000 41                 ASQ     LTS_+2

  26395 46 020122   001070 220003                    LDX0    568,DU
        46 020123   000000 470400 40                 LDP0    LTS$
        46 020124   000000 740100                    STX0    0,,PR0

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:597  
  26401 46 020125   000000 470400 40                 LDP0    LTS$
        46 020126   000000 740100                    STX0    0,,PR0

  26402 46 020127   000001 236000 25                 LDQ     CONSTANT$
        46 020130   000000 470400 40                 LDP0    LTS$
        46 020131   000001 756100                    STQ     1,,PR0

  26403 46 020132   200133 236100                    LDQ     STRING$,,AUTO
        46 020133   000002 756100                    STQ     2,,PR0

  26404 46 020134   000004 450100                    STZ     4,,PR0

  26405 46 020135   000003 235000 25                 LDA     BITS_IN_BUFFER
        46 020136   000003 755100                    STA     3,,PR0

     3219    26408
     3220    26409    3              IF BITS_IN_BUFFER = 0 THEN

  26409 46 020137   020144 601000 46                 TNZ     s:26412

     3221    26410    3                LTS$ -> ARRAY_PRESET_LTS.LAST_OFFSET = OBJ$ -> OBJ_WORD.OFFSET;

  26410 46 020140   000000 471400 29                 LDP1    OBJ$
        46 020141   100001 235100                    LDA     1,,PR1
        46 020142   000004 755100                    STA     4,,PR0
        46 020143   020146 710000 46                 TRA     s:26414

     3222    26411    3              ELSE
     3223    26412    3                LTS$ -> ARRAY_PRESET_LTS.LAST_OFFSET = OLD_SA;

  26412 46 020144   000006 235000 25                 LDA     OLD_SA
        46 020145   000004 755100                    STA     4,,PR0

     3224    26413
     3225    26414    3              QLT$ = TARGET$ -> VARIABLE.QLT$;

  26414 46 020146   200134 471500                    LDP1    TARGET$,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:598  
        46 020147   100007 236100                    LDQ     7,,PR1
        46 020150   000000 756000 37                 STQ     QLT$

     3226    26415    3              QLT$ -> QLT.ARRAY_VALUE$ = LTS$;

  26415 46 020151   000000 236000 40                 LDQ     LTS$
        46 020152   000000 473400 37                 LDP3    QLT$
        46 020153   300005 756100                    STQ     5,,PR3

     3227    26416
     3228    26417    4              DO WHILE (QLT$ -> QLT.FATHER ~= ADDR(NIL));

  26417 46 020154   020160 710000 46                 TRA     s:26419

     3229    26418    4                QLT$ = QLT$ -> QLT.FATHER;

  26418 46 020155   000000 470400 37                 LDP0    QLT$
        46 020156   000001 236100                    LDQ     1,,PR0
        46 020157   000000 756000 37                 STQ     QLT$

     3230    26419    4              END;

  26419 46 020160   000000 470400 37                 LDP0    QLT$
        46 020161   000001 236100                    LDQ     1,,PR0
        46 020162   000005 116000 47                 CMPQ    5
        46 020163   020155 601000 46                 TNZ     s:26418

     3231    26420
     3232    26421                /* save the last obj_word address of this data structure
     3233    26422                   on the top QLT of this data structure                 */
     3234    26423
     3235    26424    3              QLT$ -> QLT.ARRAY_VALUE$ = LTS$;

  26424 46 020164   000000 236000 40                 LDQ     LTS$
        46 020165   000005 756100                    STQ     5,,PR0

     3236    26425
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:599  
     3237    26426    3            END;

  26426 46 020166   021307 710000 46                 TRA     s:26924

     3238    26427
     3239    26428
     3240    26429        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:600  
     3241    26430    2   CASE(%PTR_SET);

     3242    26431
     3243    26432    2        IF BITS_IN_BUFFER ~= 0 THEN

  26432 46 020167   000003 235000 25                 LDA     BITS_IN_BUFFER
        46 020170   020175 600000 46                 TZE     s:26435

     3244    26433    2            CALL FLUSH_BUFFER(OLD_SA);

  26433 46 020171   000040 236000 47                 LDQ     32
        46 020172   200265 756100                    STQ     SEND$+1,,AUTO
        46 020173   021605 701000 46                 TSX1    FLUSH_BUFFER
        46 020174   000000 011000                    NOP     0

     3245    26434
     3246    26435    2        TARGET$ = PILL -> ILL.LOP;

  26435 46 020175   200003 470500                    LDP0    @PILL,,AUTO
        46 020176   000000 471500                    LDP1    0,,PR0
        46 020177   100001 236100                    LDQ     1,,PR1
        46 020200   200134 756100                    STQ     TARGET$,,AUTO

     3247    26436    2        SENDING$ = PILL -> ILL.ROP;

  26436 46 020201   100002 236100                    LDQ     2,,PR1
        46 020202   200244 756100                    STQ     SENDING$,,AUTO

     3248    26437
     3249    26438    2        CURRENT_SA = TARGET$ -> VARIABLE.SA + PILL -> PRESET.OFFSET;

  26438 46 020203   100000 236100                    LDQ     0,,PR1
        46 020204   777777 376007                    ANQ     -1,DL
        46 020205   200302 756100                    STQ     ORG1+1,,AUTO
        46 020206   200134 471500                    LDP1    TARGET$,,AUTO
        46 020207   100001 236100                    LDQ     1,,PR1
        46 020210   000022 772000                    QRL     18
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:601  
        46 020211   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 020212   200242 756100                    STQ     CURRENT_SA,,AUTO

     3250    26439
     3251    26440    2        IF PILL -> PRESET.OFFSET = 0 THEN

  26440 46 020213   000000 473500                    LDP3    0,,PR0
        46 020214   300000 720100                    LXL0    0,,PR3
        46 020215   020247 601000 46                 TNZ     s:26479

     3252    26441               %NEW_LAB( @ST$ = TARGET$ );

  26459 46 020216   000002 236000 36                 LDQ     OBJ_+2
        46 020217   000002 036007                    ADLQ    2,DL
        46 020220   000003 116000 36                 CMPQ    OBJ_+3
        46 020221   020233 604000 46                 TMI     s:26465

  26461 46 020222   000000 234000 30                 SZN     PAGING_OBJ
        46 020223   020230 605000 46                 TPL     s:26463

  26462 46 020224   000006 630400 47                 EPPR0   6
        46 020225   000000 631400 47                 EPPR1   0
        46 020226   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 020227   000000 011000                    NOP     0

  26463 46 020230   000007 631400 47                 EPPR1   7
        46 020231   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 020232   000000 011000                    NOP     0

  26465 46 020233   000002 236000 36                 LDQ     OBJ_+2
        46 020234   000022 736000                    QLS     18
        46 020235   000001 036000 36                 ADLQ    OBJ_+1
        46 020236   000000 756000 29                 STQ     OBJ$

  26466 46 020237   000002 236007                    LDQ     2,DL
        46 020240   000002 056000 36                 ASQ     OBJ_+2

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:602  
  26467 46 020241   001011 220003                    LDX0    521,DU
        46 020242   000000 470400 29                 LDP0    OBJ$
        46 020243   000000 740100                    STX0    0,,PR0

  26471 46 020244   200134 236100                    LDQ     TARGET$,,AUTO
        46 020245   000000 470400 29                 LDP0    OBJ$
        46 020246   000001 756100                    STQ     1,,PR0

     3253    26477
     3254    26478
     3255    26479    2        INST_WORD = '0'O;

  26479 46 020247   200012 450100                    STZ     INST_WORD,,AUTO

     3256    26480    2        MOD_KEY.KEY = 0;

  26480 46 020250   000000 450000 25                 STZ     MOD_KEY

     3257    26481
     3258    26482    2        IF SENDING$ = ADDR(NIL) THEN

  26482 46 020251   200244 236100                    LDQ     SENDING$,,AUTO
        46 020252   000005 116000 47                 CMPQ    5
        46 020253   020257 601000 46                 TNZ     s:26485

     3259    26483    2          INST_WORD = BINBIT(BINARY_VALUE_OF_NIL,36);

  26483 46 020254   000012 236000 44                 LDQ     VALUE_OF_NIL
        46 020255   200012 756100                    STQ     INST_WORD,,AUTO
        46 020256   020344 710000 46                 TRA     s:26539

     3260    26484             %IF CP6;
     3261    26485    2        ELSE IF SENDING$ = NIL_EPTR$ THEN

  26485 46 020257   000013 116000 44                 CMPQ    NIL_EPTR
        46 020260   020264 601000 46                 TNZ     s:26490

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:603  
     3262    26486    2          INST_WORD = BINBIT(BINARY_VALUE_OF_NIL_EPTR,36);

  26486 46 020261   000013 236000 44                 LDQ     NIL_EPTR
        46 020262   200012 756100                    STQ     INST_WORD,,AUTO
        46 020263   020344 710000 46                 TRA     s:26539

     3263    26487             %ENDIF;
     3264    26488    2        ELSE
     3265    26489
     3266    26490    2          IF SENDING$ -> ST.ID = %DCB_ THEN

  26490 46 020264   200244 470500                    LDP0    SENDING$,,AUTO
        46 020265   000000 220100                    LDX0    0,,PR0
        46 020266   001007 100003                    CMPX0   519,DU
        46 020267   020273 601000 46                 TNZ     s:26494

     3267    26491    2            MOD_KEY.B.WORD_REL = TRUE;

  26491 46 020270   000002 236007                    LDQ     2,DL
        46 020271   000000 256000 25                 ORSQ    MOD_KEY
        46 020272   020344 710000 46                 TRA     s:26539

     3268    26492    2          ELSE
     3269    26493    3            DO;

     3270    26494    3              MOD_KEY.B.WORD_REL = TRUE;

  26494 46 020273   000002 236007                    LDQ     2,DL
        46 020274   000000 256000 25                 ORSQ    MOD_KEY

     3271    26495    3              MOD_KEY.B.SEGID_REL_LOW = TRUE;

  26495 46 020275   000200 236007                    LDQ     128,DL
        46 020276   000000 256000 25                 ORSQ    MOD_KEY

     3272    26496    3              MOD_KEY.B.RESOLVE_ADDRESS = %TRUE;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:604  
  26496 46 020277   000020 236007                    LDQ     16,DL
        46 020300   000000 256000 25                 ORSQ    MOD_KEY

     3273    26497
     3274    26498                   /* Calculate the Byte/bit portion of the pointer */
     3275    26499    3              IF SENDING$ -> ST.TYPE = %TYD THEN

  26499 46 020301   000002 221100                    LDX1    2,,PR0
        46 020302   020325 601000 46                 TNZ     s:26505

     3276    26500    4                DO;

     3277    26501    4                  INST_WORD.BDSC.C = SENDING$ -> ST.NDSC.CN / 2;

  26501 46 020303   000001 236100                    LDQ     1,,PR0
        46 020304   000017 772000                    QRL     15
        46 020305   000007 376007                    ANQ     7,DL
        46 020306   000001 772000                    QRL     1
        46 020307   000020 736000                    QLS     16
        46 020310   200012 676100                    ERQ     INST_WORD,,AUTO
        46 020311   600000 376007                    ANQ     -65536,DL
        46 020312   200012 656100                    ERSQ    INST_WORD,,AUTO

     3278    26502    4                  INST_WORD.BDSC.B = MOD(SENDING$ -> ST.NDSC.CN,2) * 5;

  26502 46 020313   000001 236100                    LDQ     1,,PR0
        46 020314   000017 772000                    QRL     15
        46 020315   000007 376007                    ANQ     7,DL
        46 020316   000001 376007                    ANQ     1,DL
        46 020317   000005 402007                    MPY     5,DL
        46 020320   000014 736000                    QLS     12
        46 020321   200012 676100                    ERQ     INST_WORD,,AUTO
        46 020322   170000 376007                    ANQ     61440,DL
        46 020323   200012 656100                    ERSQ    INST_WORD,,AUTO

     3279    26503    4                END;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:605  
  26503 46 020324   020331 710000 46                 TRA     s:26507

     3280    26504    3              ELSE
     3281    26505    3                INST_WORD.BDSC.C = SENDING$ -> ST.ADSC.CN;

  26505 46 020325   000001 236100                    LDQ     1,,PR0
        46 020326   200012 676100                    ERQ     INST_WORD,,AUTO
        46 020327   600000 376007                    ANQ     -65536,DL
        46 020330   200012 656100                    ERSQ    INST_WORD,,AUTO

     3282    26506
     3283    26507    3              IF (SENDING$ -> ST.ID = %CONST) AND

  26507 46 020331   000767 100003                    CMPX0   503,DU
        46 020332   020344 601000 46                 TNZ     s:26539
        46 020333   000003 236100                    LDQ     3,,PR0
        46 020334   020000 316003                    CANQ    8192,DU
        46 020335   020344 601000 46                 TNZ     s:26539

     3284    26508    3                  NOT SENDING$ -> CONST.B.ALLOCATED THEN
     3285    26509    4                DO;

     3286    26510    4                  SENDING$ -> CONST.B.ALLOCATED = TRUE;

  26510 46 020336   020000 236003                    LDQ     8192,DU
        46 020337   000003 256100                    ORSQ    3,,PR0

     3287    26511    4                  SENDING$ -> CONST.ALLOC_LINK = CONST$;

  26511 46 020340   000000 236000 21                 LDQ     CONST$
        46 020341   000005 756100                    STQ     5,,PR0

     3288    26512    4                  CONST$ = SENDING$;

  26512 46 020342   200244 236100                    LDQ     SENDING$,,AUTO
        46 020343   000000 756000 21                 STQ     CONST$

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:606  
     3289    26513    4                END;

     3290    26514    3            END;

     3291    26515
     3292    26516             %NEW_WORD(@OU_WORD = INST_WORD,
     3293    26517                       @KEY = MOD_KEY.KEY,
     3294    26518                       @ST$ = SENDING$,
     3295    26519                       @OFFSET = CURRENT_SA,
     3296    26520                       @ADVANCE_BLOCK_SIZE=NO);

  26539 46 020344   000002 236000 36                 LDQ     OBJ_+2
        46 020345   000004 036007                    ADLQ    4,DL
        46 020346   000003 116000 36                 CMPQ    OBJ_+3
        46 020347   020361 604000 46                 TMI     s:26545

  26541 46 020350   000000 234000 30                 SZN     PAGING_OBJ
        46 020351   020356 605000 46                 TPL     s:26543

  26542 46 020352   000006 630400 47                 EPPR0   6
        46 020353   000000 631400 47                 EPPR1   0
        46 020354   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 020355   000000 011000                    NOP     0

  26543 46 020356   000007 631400 47                 EPPR1   7
        46 020357   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 020360   000000 011000                    NOP     0

  26545 46 020361   000002 236000 36                 LDQ     OBJ_+2
        46 020362   000022 736000                    QLS     18
        46 020363   000001 036000 36                 ADLQ    OBJ_+1
        46 020364   000000 756000 29                 STQ     OBJ$

  26546 46 020365   000004 236007                    LDQ     4,DL
        46 020366   000002 056000 36                 ASQ     OBJ_+2

  26547 46 020367   001012 220003                    LDX0    522,DU
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:607  
        46 020370   000000 470400 29                 LDP0    OBJ$
        46 020371   000000 740100                    STX0    0,,PR0

  26550 46 020372   200244 236100                    LDQ     SENDING$,,AUTO
        46 020373   000000 470400 29                 LDP0    OBJ$
        46 020374   000002 756100                    STQ     2,,PR0

  26551 46 020375   200242 235100                    LDA     CURRENT_SA,,AUTO
        46 020376   000001 755100                    STA     1,,PR0

  26552 46 020377   000000 236000 25                 LDQ     MOD_KEY
        46 020400   000011 736000                    QLS     9
        46 020401   000000 552110                    STBQ    0,'10'O,PR0

  26554 46 020402   200012 236100                    LDQ     INST_WORD,,AUTO
        46 020403   000000 470400 29                 LDP0    OBJ$
        46 020404   000003 756100                    STQ     3,,PR0

     3297    26567
     3298    26568    2        OLD_SA = CURRENT_SA;

  26568 46 020405   200242 235100                    LDA     CURRENT_SA,,AUTO
        46 020406   000006 755000 25                 STA     OLD_SA
        46 020407   021307 710000 46                 TRA     s:26924

     3299    26569
     3300    26570        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:608  
     3301    26571    2   CASE(%SCOPE);

     3302    26572        /*V*
     3303    26573                       SCOPE
     3304    26574               Issue an OBJ_SCOPE item if we are entering a new scope and
     3305    26575             the type is %PROGRAM_SCOPE. No action is needed for other types.
     3306    26576             Not all SCOPE ILL items indicate that we are entering a new
     3307    26577             scope.  The first scope comes from COMCOM.FIRST_PROC$.
     3308    26578        */
     3309    26579
     3310    26580    3        DO CASE(PILL -> SCOPE.CODE);

  26580 46 020410   100000 720100                    LXL0    0,,PR1
        46 020411   000001 100003                    CMPX0   1,DU
        46 020412   020414 602010 46                 TNC     s:26580+4,X0
        46 020413   021307 710000 46                 TRA     s:26924
        46 020414   020415 710000 46                 TRA     s:26582

     3311    26581    3          CASE(%PROGRAM_SCOPE);

     3312    26582    3            IF PILL -> SCOPE.PROC$ ~= CURRENT_SCOPE$ THEN

  26582 46 020415   100001 236100                    LDQ     1,,PR1
        46 020416   000000 116000 18                 CMPQ    CURRENT_SCOPE$
        46 020417   020461 600000 46                 TZE     s:26625

     3313    26583    4              DO;

     3314    26584                     %NEW_SCOPE( @PROC$ = PILL -> SCOPE.PROC$ );

  26602 46 020420   000002 236000 36                 LDQ     OBJ_+2
        46 020421   000002 036007                    ADLQ    2,DL
        46 020422   000003 116000 36                 CMPQ    OBJ_+3
        46 020423   020435 604000 46                 TMI     s:26608

  26604 46 020424   000000 234000 30                 SZN     PAGING_OBJ
        46 020425   020432 605000 46                 TPL     s:26606
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:609  

  26605 46 020426   000006 630400 47                 EPPR0   6
        46 020427   000000 631400 47                 EPPR1   0
        46 020430   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 020431   000000 011000                    NOP     0

  26606 46 020432   000007 631400 47                 EPPR1   7
        46 020433   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 020434   000000 011000                    NOP     0

  26608 46 020435   000002 236000 36                 LDQ     OBJ_+2
        46 020436   000022 736000                    QLS     18
        46 020437   000001 036000 36                 ADLQ    OBJ_+1
        46 020440   000000 756000 29                 STQ     OBJ$

  26609 46 020441   000002 236007                    LDQ     2,DL
        46 020442   000002 056000 36                 ASQ     OBJ_+2

  26610 46 020443   001014 220003                    LDX0    524,DU
        46 020444   000000 470400 29                 LDP0    OBJ$
        46 020445   000000 740100                    STX0    0,,PR0

  26614 46 020446   200003 470500                    LDP0    @PILL,,AUTO
        46 020447   000000 471500                    LDP1    0,,PR0
        46 020450   100001 236100                    LDQ     1,,PR1
        46 020451   000000 473400 29                 LDP3    OBJ$
        46 020452   300001 756100                    STQ     1,,PR3

     3315    26620
     3316    26621    4                CURRENT_SCOPE$ = PILL -> SCOPE.PROC$;

  26621 46 020453   000000 471500                    LDP1    0,,PR0
        46 020454   100001 236100                    LDQ     1,,PR1
        46 020455   000000 756000 18                 STQ     CURRENT_SCOPE$

     3317    26622    4                COMCOM.LOGICAL_BLOCK_CNT = COMCOM.LOGICAL_BLOCK_CNT + 1;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:610  
  26622 46 020456   000472 235000 xsym               LDA     COMCOM+314
        46 020457   000001 035007                    ADLA    1,DL
        46 020460   000472 755000 xsym               STA     COMCOM+314

     3318    26623    4              END;

     3319    26624
     3320    26625    3            IF COMCOM.SEGMENT$(%PROC) ~= ROOT_PROC_BLOCK$ THEN

  26625 46 020461   000150 236000 xsym               LDQ     COMCOM+104
        46 020462   000000 116000 27                 CMPQ    ROOT_PROC_BLOCK$
        46 020463   021307 600000 46                 TZE     s:26924

     3321    26626    4              DO;

     3322    26627    4                COMCOM.SEGMENT$ (%PROC) = ROOT_PROC_BLOCK$;

  26627 46 020464   000000 236000 27                 LDQ     ROOT_PROC_BLOCK$
        46 020465   000150 756000 xsym               STQ     COMCOM+104

     3323    26628    4                CURRENT_BLOCK$ = ROOT_PROC_BLOCK$;

  26628 46 020466   000000 756000 26                 STQ     CURRENT_BLOCK$

     3324    26629
     3325    26630                     %NEW_ORG (@ST$ = CURRENT_BLOCK$);

  26648 46 020467   000002 236000 36                 LDQ     OBJ_+2
        46 020470   000002 036007                    ADLQ    2,DL
        46 020471   000003 116000 36                 CMPQ    OBJ_+3
        46 020472   020504 604000 46                 TMI     s:26654

  26650 46 020473   000000 234000 30                 SZN     PAGING_OBJ
        46 020474   020501 605000 46                 TPL     s:26652

  26651 46 020475   000006 630400 47                 EPPR0   6
        46 020476   000000 631400 47                 EPPR1   0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:611  
        46 020477   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 020500   000000 011000                    NOP     0

  26652 46 020501   000007 631400 47                 EPPR1   7
        46 020502   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 020503   000000 011000                    NOP     0

  26654 46 020504   000002 236000 36                 LDQ     OBJ_+2
        46 020505   000022 736000                    QLS     18
        46 020506   000001 036000 36                 ADLQ    OBJ_+1
        46 020507   000000 756000 29                 STQ     OBJ$

  26655 46 020510   000002 236007                    LDQ     2,DL
        46 020511   000002 056000 36                 ASQ     OBJ_+2

  26656 46 020512   001013 220003                    LDX0    523,DU
        46 020513   000000 470400 29                 LDP0    OBJ$
        46 020514   000000 740100                    STX0    0,,PR0

  26660 46 020515   000000 236000 26                 LDQ     CURRENT_BLOCK$
        46 020516   000000 470400 29                 LDP0    OBJ$
        46 020517   000001 756100                    STQ     1,,PR0

     3326    26666    4              END;

  26666 46 020520   021307 710000 46                 TRA     s:26924

     3327    26667    3          CASE(%INIT_SCOPE, %DECLARATIVES_SCOPE);

     3328    26668                  /* NULL */
     3329    26669    3        END; /* Case */

     3330    26670
     3331    26671        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:612  
     3332    26672    2   CASE(%SEARCH);

     3333    26673
     3334    26674    3        DO CASE(CASE_PASS);

  26674 46 020521   200005 473500                    LDP3    @CASE_PASS,,AUTO
        46 020522   300000 235100                    LDA     0,,PR3
        46 020523   000002 115007                    CMPA    2,DL
        46 020524   020526 602005 46                 TNC     s:26674+5,AL
        46 020525   021307 710000 46                 TRA     s:26924
        46 020526   020530 710000 46                 TRA     s:26677
        46 020527   020560 710000 46                 TRA     s:26698

     3335    26675    3           CASE(%FIRST_PASS);

     3336    26676                    /* Was TABLEVAL specified */
     3337    26677    3               IF PILL -> SEARCH_.TABLEVAL = ADDR(NIL) THEN

  26677 46 020530   100004 236100                    LDQ     4,,PR1
        46 020531   000005 116000 47                 CMPQ    5
        46 020532   020537 601000 46                 TNZ     s:26681

     3338    26678    3                 PCOM.TABS = 1;

  26678 46 020533   000001 235007                    LDA     1,DL
        46 020534   200004 474500                    LDP4    @PCOM,,AUTO
        46 020535   400023 755100                    STA     19,,PR4
        46 020536   020544 710000 46                 TRA     s:26686

     3339    26679    3               ELSE
     3340    26680    4                 DO;

     3341    26681    4                   PCOM.TABS = 0;

  26681 46 020537   200004 474500                    LDP4    @PCOM,,AUTO
        46 020540   400023 450100                    STZ     19,,PR4

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:613  
     3342    26682    4                   PCOM.TOPND = PILL -> SEARCH_.TABLEVAL;

  26682 46 020541   000000 471500                    LDP1    0,,PR0
        46 020542   100004 236100                    LDQ     4,,PR1
        46 020543   400055 756100                    STQ     45,,PR4

     3343    26683    4                 END;

     3344    26684
     3345    26685                    /* Was ALTRET specified */
     3346    26686    3               IF PILL -> SEARCH_.ALTRET_ = ADDR(NIL) THEN

  26686 46 020544   000000 471500                    LDP1    0,,PR0
        46 020545   100005 236100                    LDQ     5,,PR1
        46 020546   000005 116000 47                 CMPQ    5
        46 020547   020553 601000 46                 TNZ     s:26690

     3347    26687    3                 PCOM.RABS = 1;

  26687 46 020550   000001 235007                    LDA     1,DL
        46 020551   400021 755100                    STA     17,,PR4
        46 020552   021307 710000 46                 TRA     s:26924

     3348    26688    3               ELSE
     3349    26689    4                 DO;

     3350    26690    4                   PCOM.RABS = 0;

  26690 46 020553   400021 450100                    STZ     17,,PR4

     3351    26691    4                   PCOM.ROPND = PILL -> SEARCH_.ALTRET_;

  26691 46 020554   000000 471500                    LDP1    0,,PR0
        46 020555   100005 236100                    LDQ     5,,PR1
        46 020556   400053 756100                    STQ     43,,PR4

     3352    26692    4                 END;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:614  

  26692 46 020557   021307 710000 46                 TRA     s:26924

     3353    26693
     3354    26694    3           CASE(%SECOND_PASS);

     3355    26695
     3356    26696                    /* Y field of arg may need adjustment if table of
     3357    26697                       TCT instruction is to be put into .PROC. */
     3358    26698    3               IF PILL -> SEARCH_.ROP -> ETT.ID = %TRIAD THEN

  26698 46 020560   100002 474500                    LDP4    2,,PR1
        46 020561   400000 220100                    LDX0    0,,PR4
        46 020562   000015 100003                    CMPX0   13,DU
        46 020563   021307 601000 46                 TNZ     s:26924

     3359    26699    3                 PCOM.GABS = BITBIN('2000000'O);

  26699 46 020564   000017 236000 44                 LDQ     NIL_EPTR+4
        46 020565   000017 772000                    QRL     15
        46 020566   200004 475500                    LDP5    @PCOM,,AUTO
        46 020567   500006 756100                    STQ     6,,PR5

     3360    26700
     3361    26701    3        END; /* CASE */

  26701 46 020570   021307 710000 46                 TRA     s:26924

     3362    26702
     3363    26703        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:615  
     3364    26704    2   CASE(%SIZ, %REFMOD);  /*#28637*/

     3365    26705
     3366    26706    2        IF PILL -> ETT.ROP -> ETT.ID = %TRIAD AND

  26706 46 020571   100002 473500                    LDP3    2,,PR1
        46 020572   300000 220100                    LDX0    0,,PR3
        46 020573   000015 100003                    CMPX0   13,DU
        46 020574   020612 601000 46                 TNZ     s:26711
        46 020575   300001 474500                    LDP4    1,,PR3
        46 020576   400010 235100                    LDA     8,,PR4
        46 020577   000001 115003                    CMPA    1,DU
        46 020600   020612 605000 46                 TPL     s:26711

     3367    26707    2            PILL -> ETT.ROP -> ETT.LOP -> CONST.CONSTI.WORD1 < %#256K THEN
     3368    26708    2          CALL Z8HU$TAG(PILL -> ETT.ROP, FALSE);

  26708 46 020601   000026 236000 47                 LDQ     22
        46 020602   200303 756100                    STQ     ORG1+2,,AUTO
        46 020603   100002 633500                    EPPR3   2,,PR1
        46 020604   200302 453500                    STP3    ORG1+1,,AUTO
        46 020605   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 020606   000013 631400 47                 EPPR1   11
        46 020607   000000 701000 xent               TSX1    Z8HU$TAG
        46 020610   000000 011000                    NOP     0
        46 020611   021307 710000 46                 TRA     s:26924

     3369    26709    2        ELSE
     3370    26710    3          DO;

     3371    26711    3            REF$ = PILL -> ETT.LOP -> ETT.REF$;

  26711 46 020612   100001 474500                    LDP4    1,,PR1
        46 020613   400003 236100                    LDQ     3,,PR4
        46 020614   200116 756100                    STQ     REF$,,AUTO

     3372    26712
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:616  
     3373    26713    3           CALL Z8HU$TAG(PILL -> ETT.ROP, REF$ -> REF.ST$ -> VARIABLE.B.GREATER_256K =
             26713                     TRUE);

  26713 46 020615   200116 475500                    LDP5    REF$,,AUTO
        46 020616   500005 476500                    LDP6    5,,PR5
        46 020617   400000 221003                    LDX1    -131072,DU
        46 020620   600003 236100                    LDQ     3,,PR6
        46 020621   020000 316003                    CANQ    8192,DU
        46 020622   020624 601000 46                 TNZ     s:26713+7
        46 020623   000000 221003                    LDX1    0,DU
        46 020624   000000 636011                    EAQ     0,X1
        46 020625   200302 676100                    ERQ     ORG1+1,,AUTO
        46 020626   400000 376003                    ANQ     -131072,DU
        46 020627   200302 656100                    ERSQ    ORG1+1,,AUTO
        46 020630   200302 633500                    EPPR3   ORG1+1,,AUTO
        46 020631   200305 453500                    STP3    ORG1+4,,AUTO
        46 020632   100002 634500                    EPPR4   2,,PR1
        46 020633   200304 454500                    STP4    ORG1+3,,AUTO
        46 020634   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 020635   000013 631400 47                 EPPR1   11
        46 020636   000000 701000 xent               TSX1    Z8HU$TAG
        46 020637   000000 011000                    NOP     0

     3374    26714    3          END;

  26714 46 020640   021307 710000 46                 TRA     s:26924

     3375    26715
     3376    26716        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:617  
     3377    26717    2   CASE(%SSOP);

     3378    26718
     3379    26719    3    DO CASE(CASE_PASS);

  26719 46 020641   200005 473500                    LDP3    @CASE_PASS,,AUTO
        46 020642   300000 235100                    LDA     0,,PR3
        46 020643   000002 115007                    CMPA    2,DL
        46 020644   020646 602005 46                 TNC     s:26719+5,AL
        46 020645   021307 710000 46                 TRA     s:26924
        46 020646   020650 710000 46                 TRA     s:26721
        46 020647   020701 710000 46                 TRA     s:26729

     3380    26720    3      CASE(%FIRST_PASS);

     3381    26721    3        P$ = PILL -> ILL.ROP;

  26721 46 020650   100002 236100                    LDQ     2,,PR1
        46 020651   200064 756100                    STQ     P$,,AUTO

     3382    26722    4        DO WHILE P$ -> ETT.ID ~= %CVDI AND P$ -> ETT.ID < %FIRST_ST

  26722 46 020652   020656 710000 46                 TRA     s:26725

     3383    26723    4            AND P$ -> ETT.STATE = 0;
     3384    26724    4          P$ = P$ -> ETT.LOP;

  26724 46 020653   200064 470500                    LDP0    P$,,AUTO
        46 020654   000001 236100                    LDQ     1,,PR0
        46 020655   200064 756100                    STQ     P$,,AUTO

     3385    26725    4        END;

  26725 46 020656   200064 470500                    LDP0    P$,,AUTO
        46 020657   000000 220100                    LDX0    0,,PR0
        46 020660   000132 100003                    CMPX0   90,DU
        46 020661   020666 600000 46                 TZE     s:26726
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:618  
        46 020662   000751 100003                    CMPX0   489,DU
        46 020663   020666 603000 46                 TRC     s:26726
        46 020664   000004 221100                    LDX1    4,,PR0
        46 020665   020653 600000 46                 TZE     s:26724

     3386    26726    3        IF P$ -> ETT.ID = %CVDI AND P$ -> ETT.STATE = 0 THEN

  26726 46 020666   000132 100003                    CMPX0   90,DU
        46 020667   021307 601000 46                 TNZ     s:26924
        46 020670   000004 221100                    LDX1    4,,PR0
        46 020671   021307 601000 46                 TNZ     s:26924

     3387    26727    3          CALL Z8HU$WALK (P$);

  26727 46 020672   200064 631500                    EPPR1   P$,,AUTO
        46 020673   200302 451500                    STP1    ORG1+1,,AUTO
        46 020674   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 020675   000000 631400 47                 EPPR1   0
        46 020676   000000 701000 xent               TSX1    Z8HU$WALK
        46 020677   000000 011000                    NOP     0
        46 020700   021307 710000 46                 TRA     s:26924

     3388    26728    3      CASE(%SECOND_PASS);

     3389    26729    3        REF$ = PILL -> ETT.REF$;

  26729 46 020701   100003 236100                    LDQ     3,,PR1
        46 020702   200116 756100                    STQ     REF$,,AUTO

     3390    26730
     3391    26731    3        IF REF$ -> REF.PR_TAG$ ~= ADDR(NIL)

  26731 46 020703   200116 474500                    LDP4    REF$,,AUTO
        46 020704   400004 236100                    LDQ     4,,PR4
        46 020705   000005 116000 47                 CMPQ    5
        46 020706   021051 600000 46                 TZE     s:26761
        46 020707   400001 220100                    LDX0    1,,PR4
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:619  
        46 020710   040000 100003                    CMPX0   16384,DU
        46 020711   020714 605400 46                 TPNZ    s:26735
        46 020712   740000 100003                    CMPX0   -16384,DU
        46 020713   021051 605000 46                 TPL     s:26761

     3392    26732    3            AND (REF$ -> REF.SIGNED_SA >   %#16K
     3393    26733    3                 OR REF$ -> REF.SIGNED_SA < - %#16K) THEN
     3394    26734    4          DO;

     3395    26735    5            DO CASE(PILL -> ETT.LOP -> ETT.OFFSET.TYPE);

  26735 46 020714   100001 475500                    LDP5    1,,PR1
        46 020715   500002 721100                    LXL1    2,,PR5
        46 020716   000007 101003                    CMPX1   7,DU
        46 020717   020721 602011 46                 TNC     s:26735+5,X1
        46 020720   020752 710000 46                 TRA     s:26749
        46 020721   020752 710000 46                 TRA     s:26749
        46 020722   020730 710000 46                 TRA     s:26737
        46 020723   020730 710000 46                 TRA     s:26737
        46 020724   020735 710000 46                 TRA     s:26740
        46 020725   020742 710000 46                 TRA     s:26743
        46 020726   020742 710000 46                 TRA     s:26743
        46 020727   020747 710000 46                 TRA     s:26746

     3396    26736    5              CASE(%NUMERIC4, %ALPHA4);

     3397    26737    5                MKCN.CON = (REF$ -> REF.SIGNED_SA) * 8;

  26737 46 020730   400001 236100                    LDQ     1,,PR4
        46 020731   000017 732000                    QRS     15
        46 020732   000110 376000 47                 ANQ     72
        46 020733   000000 756000 28                 STQ     MKCN
        46 020734   020752 710000 46                 TRA     s:26749

     3398    26738
     3399    26739    5              CASE(%ALPHA6);

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:620  
     3400    26740    5                MKCN.CON = (REF$ -> REF.SIGNED_SA) * 6;

  26740 46 020735   400001 236100                    LDQ     1,,PR4
        46 020736   000022 732000                    QRS     18
        46 020737   000006 402007                    MPY     6,DL
        46 020740   000000 756000 28                 STQ     MKCN
        46 020741   020752 710000 46                 TRA     s:26749

     3401    26741
     3402    26742    5              CASE(%NUMERIC9, %ALPHA9);

     3403    26743    5                MKCN.CON = (REF$ -> REF.SIGNED_SA) * 4;

  26743 46 020742   400001 236100                    LDQ     1,,PR4
        46 020743   000020 732000                    QRS     16
        46 020744   000111 376000 47                 ANQ     73
        46 020745   000000 756000 28                 STQ     MKCN
        46 020746   020752 710000 46                 TRA     s:26749

     3404    26744
     3405    26745    5              CASE(%WORD_);

     3406    26746    5                MKCN.CON = REF$ -> REF.SIGNED_SA;

  26746 46 020747   400001 236100                    LDQ     1,,PR4
        46 020750   000022 732000                    QRS     18
        46 020751   000000 756000 28                 STQ     MKCN

     3407    26747    5            END /* Case */;

     3408    26748
     3409    26749    4            CALL Z8AC$MAKE_CONST(NODE$);

  26749 46 020752   200117 631500                    EPPR1   NODE$,,AUTO
        46 020753   200302 451500                    STP1    ORG1+1,,AUTO
        46 020754   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 020755   000000 631400 47                 EPPR1   0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:621  
        46 020756   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        46 020757   000000 011000                    NOP     0

     3410    26750    4            CALL Z8AF$FORME(%ADI, PILL -> ETT.ROP, NODE$, P$);

  26750 46 020760   200003 470500                    LDP0    @PILL,,AUTO
        46 020761   000000 471500                    LDP1    0,,PR0
        46 020762   200064 633500                    EPPR3   P$,,AUTO
        46 020763   200305 453500                    STP3    ORG1+4,,AUTO
        46 020764   200117 634500                    EPPR4   NODE$,,AUTO
        46 020765   200304 454500                    STP4    ORG1+3,,AUTO
        46 020766   100002 635500                    EPPR5   2,,PR1
        46 020767   200303 455500                    STP5    ORG1+2,,AUTO
        46 020770   000076 236000 47                 LDQ     62
        46 020771   200302 756100                    STQ     ORG1+1,,AUTO
        46 020772   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 020773   000025 631400 47                 EPPR1   21
        46 020774   000000 701000 xent               TSX1    Z8AF$FORME
        46 020775   000000 011000                    NOP     0

     3411    26751
     3412    26752    4            REF$ -> REF.SSOP_TAG$ = P$;

  26752 46 020776   200064 236100                    LDQ     P$,,AUTO
        46 020777   200116 470500                    LDP0    REF$,,AUTO
        46 021000   000002 756100                    STQ     2,,PR0

     3413    26753    4            P$ -> ETT.COUNT = PILL -> ETT.COUNT;

  26753 46 021001   200003 471500                    LDP1    @PILL,,AUTO
        46 021002   100000 473500                    LDP3    0,,PR1
        46 021003   300000 720100                    LXL0    0,,PR3
        46 021004   200064 474500                    LDP4    P$,,AUTO
        46 021005   400000 440100                    SXL0    0,,PR4

     3414    26754    4            REF$ -> REF.SA = 0;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:622  
  26754 46 021006   000000 220003                    LDX0    0,DU
        46 021007   000001 740100                    STX0    1,,PR0

     3415    26755
     3416    26756    4            CALL Z8HU$TAG(P$, REF$ -> REF.ST$ -> VARIABLE.B.GREATER_256K = TRUE);

  26756 46 021010   000005 473500                    LDP3    5,,PR0
        46 021011   400000 221003                    LDX1    -131072,DU
        46 021012   300003 236100                    LDQ     3,,PR3
        46 021013   020000 316003                    CANQ    8192,DU
        46 021014   021016 601000 46                 TNZ     s:26756+6
        46 021015   000000 221003                    LDX1    0,DU
        46 021016   000000 636011                    EAQ     0,X1
        46 021017   200302 676100                    ERQ     ORG1+1,,AUTO
        46 021020   400000 376003                    ANQ     -131072,DU
        46 021021   200302 656100                    ERSQ    ORG1+1,,AUTO
        46 021022   200302 633500                    EPPR3   ORG1+1,,AUTO
        46 021023   200305 453500                    STP3    ORG1+4,,AUTO
        46 021024   200064 634500                    EPPR4   P$,,AUTO
        46 021025   200304 454500                    STP4    ORG1+3,,AUTO
        46 021026   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 021027   000013 631400 47                 EPPR1   11
        46 021030   000000 701000 xent               TSX1    Z8HU$TAG
        46 021031   000000 011000                    NOP     0

     3417    26757
     3418    26758    4            CALL Z8HU$DEC_COUNT(PILL -> ETT.ROP, (PILL -> ETT.COUNT -1));

  26758 46 021032   200003 470500                    LDP0    @PILL,,AUTO
        46 021033   000000 471500                    LDP1    0,,PR0
        46 021034   100000 236100                    LDQ     0,,PR1
        46 021035   777777 376007                    ANQ     -1,DL
        46 021036   000001 136007                    SBLQ    1,DL
        46 021037   200302 756100                    STQ     ORG1+1,,AUTO
        46 021040   200302 633500                    EPPR3   ORG1+1,,AUTO
        46 021041   200305 453500                    STP3    ORG1+4,,AUTO
        46 021042   100002 634500                    EPPR4   2,,PR1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:623  
        46 021043   200304 454500                    STP4    ORG1+3,,AUTO
        46 021044   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 021045   000013 631400 47                 EPPR1   11
        46 021046   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 021047   000000 011000                    NOP     0

     3419    26759    4          END;

  26759 46 021050   021307 710000 46                 TRA     s:26924

     3420    26760    3        ELSE
     3421    26761    3          CALL Z8HU$TAG(PILL -> ETT.ROP, REF$ -> REF.ST$ -> VARIABLE.B.GREATER_256K =
             26761                   TRUE);

  26761 46 021051   400005 475500                    LDP5    5,,PR4
        46 021052   400000 220003                    LDX0    -131072,DU
        46 021053   500003 236100                    LDQ     3,,PR5
        46 021054   020000 316003                    CANQ    8192,DU
        46 021055   021057 601000 46                 TNZ     s:26761+6
        46 021056   000000 220003                    LDX0    0,DU
        46 021057   000000 636010                    EAQ     0,X0
        46 021060   200302 676100                    ERQ     ORG1+1,,AUTO
        46 021061   400000 376003                    ANQ     -131072,DU
        46 021062   200302 656100                    ERSQ    ORG1+1,,AUTO
        46 021063   200302 635500                    EPPR5   ORG1+1,,AUTO
        46 021064   200305 455500                    STP5    ORG1+4,,AUTO
        46 021065   100002 636500                    EPPR6   2,,PR1
        46 021066   200304 456500                    STP6    ORG1+3,,AUTO
        46 021067   200304 630500                    EPPR0   ORG1+3,,AUTO
        46 021070   000013 631400 47                 EPPR1   11
        46 021071   000000 701000 xent               TSX1    Z8HU$TAG
        46 021072   000000 011000                    NOP     0

     3422    26762    3    END; /* CASE */

  26762 46 021073   021307 710000 46                 TRA     s:26924

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:624  
     3423    26763
     3424    26764        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:625  
     3425    26765    2   CASE(%SUB_ENTRY,%SUB_END);

     3426    26766
     3427    26767    2        PCOM.DABS = BITBIN(PILL->ILL.LOP->PARA.B.PFORM_NESTED);

  26767 46 021074   100001 473500                    LDP3    1,,PR1
        46 021075   300003 236100                    LDQ     3,,PR3
        46 021076   000030 772000                    QRL     24
        46 021077   000001 376007                    ANQ     1,DL
        46 021100   200004 474500                    LDP4    @PCOM,,AUTO
        46 021101   400003 756100                    STQ     3,,PR4
        46 021102   021307 710000 46                 TRA     s:26924

     3428    26768
     3429    26769        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:626  
     3430    26770    2   CASE(%USER_CALL);

     3431    26771
     3432    26772    2        ARGLIST$ = PILL -> ETT.LOP;

  26772 46 021103   100001 236100                    LDQ     1,,PR1
        46 021104   200120 756100                    STQ     ARGLIST$,,AUTO

     3433    26773    2        NUMBER_OF_ARGS = ARGLIST$ -> LTS.N - 1;

  26773 46 021105   200120 473500                    LDP3    ARGLIST$,,AUTO
        46 021106   300000 236100                    LDQ     0,,PR3
        46 021107   777777 376007                    ANQ     -1,DL
        46 021110   000001 136007                    SBLQ    1,DL
        46 021111   200121 756100                    STQ     NUMBER_OF_ARGS,,AUTO

     3434    26774
     3435    26775    3        DO CASE(CASE_PASS);

  26775 46 021112   200005 474500                    LDP4    @CASE_PASS,,AUTO
        46 021113   400000 235100                    LDA     0,,PR4
        46 021114   000002 115007                    CMPA    2,DL
        46 021115   021117 602005 46                 TNC     s:26775+5,AL
        46 021116   021307 710000 46                 TRA     s:26924
        46 021117   021121 710000 46                 TRA     s:26778
        46 021120   021143 710000 46                 TRA     s:26794

     3436    26776    3          CASE(%FIRST_PASS);

     3437    26777
     3438    26778    3            PCOM.OABS = 0;

  26778 46 021121   200004 475500                    LDP5    @PCOM,,AUTO
        46 021122   500016 450100                    STZ     14,,PR5

     3439    26779
     3440    26780    3            PCOM.DABS = NUMBER_OF_ARGS;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:627  

  26780 46 021123   500003 756100                    STQ     3,,PR5

     3441    26781
     3442    26782    3            IF PILL -> USER_CALL.ALTRET$ = ADDR(NIL) THEN

  26782 46 021124   000000 471500                    LDP1    0,,PR0
        46 021125   100004 236100                    LDQ     4,,PR1
        46 021126   000005 116000 47                 CMPQ    5
        46 021127   021132 601000 46                 TNZ     s:26785

     3443    26783    3              PCOM.EABS = 0;

  26783 46 021130   500004 450100                    STZ     4,,PR5
        46 021131   021134 710000 46                 TRA     s:26788

     3444    26784    3            ELSE
     3445    26785    3              PCOM.EABS = 1;

  26785 46 021132   000001 235007                    LDA     1,DL
        46 021133   500004 755100                    STA     4,,PR5

     3446    26786
     3447    26787
     3448    26788    3            IF NUMBER_OF_ARGS = 0 THEN

  26788 46 021134   200121 235100                    LDA     NUMBER_OF_ARGS,,AUTO
        46 021135   021140 601000 46                 TNZ     s:26791

     3449    26789    3              PCOM.WABS = 0;

  26789 46 021136   500026 450100                    STZ     22,,PR5
        46 021137   021307 710000 46                 TRA     s:26924

     3450    26790    3            ELSE
     3451    26791    3              PCOM.WABS = 1;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:628  
  26791 46 021140   000001 236007                    LDQ     1,DL
        46 021141   500026 756100                    STQ     22,,PR5
        46 021142   021307 710000 46                 TRA     s:26924

     3452    26792
     3453    26793    3          CASE(%SECOND_PASS);

     3454    26794    4            DO I = 0 TO NUMBER_OF_ARGS - 1;

  26794 46 021143   200065 450100                    STZ     I,,AUTO
        46 021144   021161 710000 46                 TRA     s:26796+1

     3455    26795    4              CALL Z8HU$DEC_COUNT(ARGLIST$ -> ARGLIST.ARG$(I),1);

  26795 46 021145   000016 236000 47                 LDQ     14
        46 021146   200303 756100                    STQ     ORG1+2,,AUTO
        46 021147   200065 236100                    LDQ     I,,AUTO
        46 021150   000022 736000                    QLS     18
        46 021151   000001 036003                    ADLQ    1,DU
        46 021152   200120 036100                    ADLQ    ARGLIST$,,AUTO
        46 021153   200302 756100                    STQ     ORG1+1,,AUTO
        46 021154   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 021155   000013 631400 47                 EPPR1   11
        46 021156   000000 701000 xent               TSX1    Z8HU$DEC_COUNT
        46 021157   000000 011000                    NOP     0

     3456    26796    4            END;

  26796 46 021160   200065 054100                    AOS     I,,AUTO
        46 021161   200065 236100                    LDQ     I,,AUTO
        46 021162   200121 116100                    CMPQ    NUMBER_OF_ARGS,,AUTO
        46 021163   021145 604000 46                 TMI     s:26795

     3457    26797
     3458    26798    3        END /* Case */;

  26798 46 021164   021307 710000 46                 TRA     s:26924
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:629  

     3459    26799        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:630  
     3460    26800    2   CASE(%USE_END);

     3461    26801
     3462    26802    2        PCOM.YOPND = USE_PROC_RETURN;

  26802 46 021165   000000 236000 17                 LDQ     USE_PROC_RETURN
        46 021166   200004 473500                    LDP3    @PCOM,,AUTO
        46 021167   300062 756100                    STQ     50,,PR3

     3463    26803    2        PCOM.NABS = PILL -> ILL.CODE;

  26803 46 021170   000000 471500                    LDP1    0,,PR0
        46 021171   100000 236100                    LDQ     0,,PR1
        46 021172   777777 376007                    ANQ     -1,DL
        46 021173   300015 756100                    STQ     13,,PR3

     3464    26804    2        IF PCOM.NABS >= %USE_GLOBAL THEN /* GLOBAL */

  26804 46 021174   000010 116007                    CMPQ    8,DL
        46 021175   021214 604000 46                 TMI     s:26813

     3465    26805    3          DO;

     3466    26806    3            PCOM.NABS = PCOM.NABS - %USE_GLOBAL;

  26806 46 021176   000010 336007                    LCQ     8,DL
        46 021177   300015 056100                    ASQ     13,,PR3

     3467    26807    3            IF PILL -> ILL.LOP -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.
             26807                     EXIT_PROG_IN_DECL THEN

  26807 46 021200   000000 471500                    LDP1    0,,PR0
        46 021201   100001 474500                    LDP4    1,,PR1
        46 021202   400011 475500                    LDP5    9,,PR4
        46 021203   500001 476500                    LDP6    1,,PR5
        46 021204   600001 236100                    LDQ     1,,PR6
        46 021205   000200 316007                    CANQ    128,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:631  
        46 021206   021212 600000 46                 TZE     s:26810

     3468    26808    3              PCOM.DABS = 1;

  26808 46 021207   000001 235007                    LDA     1,DL
        46 021210   300003 755100                    STA     3,,PR3
        46 021211   021215 710000 46                 TRA     s:26834

     3469    26809    3            ELSE
     3470    26810    3              PCOM.DABS = 0;

  26810 46 021212   300003 450100                    STZ     3,,PR3

     3471    26811    3          END;

  26811 46 021213   021215 710000 46                 TRA     s:26834

     3472    26812    2        ELSE
     3473    26813    2          PCOM.DABS = 0;

  26813 46 021214   300003 450100                    STZ     3,,PR3

     3474    26814
     3475    26815             %IF GCOS;
     3476    26816 C           CURRENT_ENTRY$ = PREV_ENTRY$;
     3477    26817 C
     3478    26818 C
     3479    26819 C           P2$ = PILL -> ILL.LOP ;
     3480    26820 C           IF P2$ ~= ADDR(NIL)  THEN
     3481    26821 C             P2$ = P2$ -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.P2_SAVE$;
     3482    26822 C
     3483    26823 C           IF P2$ ~= ADDR(NIL)  THEN
     3484    26824 C             DO;
     3485    26825 C               PCOM.BABS = %STACK_HEADER_SIZE + %#16K;
     3486    26826 C               PCOM.CABS = 1;
     3487    26827 C               PCOM.JOPND = P2$;
     3488    26828 C               PCOM.MABS = ((NUMBER_OF_ARGS / 2) + 1) / 2;  /* REMOVE DESC & EVEN */
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:632  
     3489    26829 C             END;
     3490    26830 C           ELSE
     3491    26831 C             PCOM.CABS = 0;
     3492    26832             %ENDIF;
     3493    26833             %IF CP6;
     3494    26834    2        IF DML_IA$ = ADDR (NIL) THEN

  26834 46 021215   000007 236000 25                 LDQ     DML_IA$
        46 021216   000005 116000 47                 CMPQ    5
        46 021217   021222 601000 46                 TNZ     s:26838

     3495    26835    2          PCOM.RABS = 0; /* Report writer USE proc */

  26835 46 021220   300021 450100                    STZ     17,,PR3
        46 021221   021307 710000 46                 TRA     s:26924

     3496    26836    2        ELSE
     3497    26837    3          DO;

     3498    26838    3            PCOM.RABS = 1; /* DML USE proc */

  26838 46 021222   000001 235007                    LDA     1,DL
        46 021223   300021 755100                    STA     17,,PR3

     3499    26839    3            PCOM.ROPND = DML_IA$;

  26839 46 021224   300053 756100                    STQ     43,,PR3

     3500    26840    3          END;

  26840 46 021225   021307 710000 46                 TRA     s:26924

     3501    26841             %ENDIF;
     3502    26842
     3503    26843    2   CASE(%USE_ENTRY);

     3504    26844
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:633  
     3505    26845             %IF GCOS;
     3506    26846 C           DO CASE( CASE_PASS );
     3507    26847 C
     3508    26848 C             CASE( %FIRST_PASS );
     3509    26849                 %ENDIF;
     3510    26850    2            PCOM.NABS = PILL -> ILL.CODE;

  26850 46 021226   100000 236100                    LDQ     0,,PR1
        46 021227   777777 376007                    ANQ     -1,DL
        46 021230   200004 473500                    LDP3    @PCOM,,AUTO
        46 021231   300015 756100                    STQ     13,,PR3

     3511    26851    2            IF PCOM.NABS >= %USE_GLOBAL THEN /* GLOBAL */

  26851 46 021232   000010 116007                    CMPQ    8,DL
        46 021233   021255 604000 46                 TMI     s:26864

     3512    26852    3              DO;

     3513    26853    3                PCOM.NABS = PCOM.NABS - %USE_GLOBAL;

  26853 46 021234   000010 336007                    LCQ     8,DL
        46 021235   300015 056100                    ASQ     13,,PR3

     3514    26854    3                IF PILL -> ILL.LOP -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.
             26854                         EXIT_PROG_IN_DECL THEN

  26854 46 021236   000000 471500                    LDP1    0,,PR0
        46 021237   100001 474500                    LDP4    1,,PR1
        46 021240   400011 475500                    LDP5    9,,PR4
        46 021241   500001 476500                    LDP6    1,,PR5
        46 021242   600001 236100                    LDQ     1,,PR6
        46 021243   000200 316007                    CANQ    128,DL
        46 021244   021253 600000 46                 TZE     s:26860

     3515    26855    4                  DO;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:634  
     3516    26856    4                    PCOM.DABS = 1;

  26856 46 021245   000001 235007                    LDA     1,DL
        46 021246   300003 755100                    STA     3,,PR3

     3517    26857    4                    PCOM.POPND = PILL -> ENTRY_ILL.EXIT_PROG$;

  26857 46 021247   000000 471500                    LDP1    0,,PR0
        46 021250   100004 236100                    LDQ     4,,PR1
        46 021251   300051 756100                    STQ     41,,PR3

     3518    26858    4                  END;

  26858 46 021252   021261 710000 46                 TRA     s:26869

     3519    26859    3                ELSE
     3520    26860    3                  PCOM.DABS = 0;

  26860 46 021253   300003 450100                    STZ     3,,PR3

     3521    26861    3              END;

  26861 46 021254   021261 710000 46                 TRA     s:26869

     3522    26862    2            ELSE
     3523    26863    3              DO;

     3524    26864    3                IF PCOM.NABS = %INIT_PROC

  26864 46 021255   000004 116007                    CMPQ    4,DL
        46 021256   021260 601000 46                 TNZ     s:26866

     3525    26865    3                  THEN PCOM.NABS = %USE_PROC;

  26865 46 021257   300015 450100                    STZ     13,,PR3

     3526    26866    3                PCOM.DABS = 0;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:635  

  26866 46 021260   300003 450100                    STZ     3,,PR3

     3527    26867    3              END;

     3528    26868                 %IF CP6;
     3529    26869    2            IF PILL -> ILL.ROPCON = 0 THEN

  26869 46 021261   000000 471500                    LDP1    0,,PR0
        46 021262   100002 235100                    LDA     2,,PR1
        46 021263   021270 601000 46                 TNZ     s:26876

     3530    26870    3              DO;

     3531    26871    3                PCOM.RABS = 0; /* Report writer USE proc */

  26871 46 021264   300021 450100                    STZ     17,,PR3

     3532    26872    3                DML_IA$ = ADDR (NIL);

  26872 46 021265   000005 236000 47                 LDQ     5
        46 021266   000007 756000 25                 STQ     DML_IA$

     3533    26873    3              END;

  26873 46 021267   021275 710000 46                 TRA     s:26908

     3534    26874    2            ELSE
     3535    26875    3              DO;

     3536    26876    3                PCOM.RABS = 1; /* DML USE proc */

  26876 46 021270   000001 236007                    LDQ     1,DL
        46 021271   300021 756100                    STQ     17,,PR3

     3537    26877    3                DML_IA$ = PILL -> ILL.ROP;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:636  
  26877 46 021272   000000 471500                    LDP1    0,,PR0
        46 021273   100002 236100                    LDQ     2,,PR1
        46 021274   000007 756000 25                 STQ     DML_IA$

     3538    26878    3              END;

     3539    26879                 %ENDIF;
     3540    26880                 %IF GCOS;
     3541    26881 C               PCOM.ZOPND = COMCOM.ESC -> ETT.LOP;
     3542    26882 C               PCOM.HABS = COMCOM.ESC -> ETT.ROPCON;
     3543    26883 C               IF COMCOM.OB.MS_DATA   THEN
     3544    26884 C                 PCOM.TABS = 0;
     3545    26885 C               ELSE
     3546    26886 C                 PCOM.TABS = 1;
     3547    26887 C
     3548    26888 C               PREV_ENTRY$ = CURRENT_ENTRY$;
     3549    26889 C               CURRENT_ENTRY$ = PILL;
     3550    26890 C
     3551    26891 C             CASE( %SECOND_PASS );
     3552    26892 C
     3553    26893 C               P2$ = PILL -> ILL.LOP ;
     3554    26894 C               IF P2$ ~= ADDR(NIL) THEN
     3555    26895 C                 P2$ = P2$ -> SYMDEF_.PROC$ -> PROC_.PROC_SUPP$ -> PROC_SUPP.P2_SAVE$;
     3556    26896 C
     3557    26897 C               IF P2$ ~= ADDR(NIL)   THEN
     3558    26898 C                 DO;
     3559    26899 C                   PCOM.BABS = %STACK_HEADER_SIZE + %#16K;
     3560    26900 C                   PCOM.CABS = 1;
     3561    26901 C                   PCOM.JOPND = P2$;
     3562    26902 C                   PCOM.PABS = PILL -> ILL.LOP -> SYMDEF_.PROC$ -> PROC_.B.ARG_COUNT;
     3563    26903 C                   PCOM.PABS = (PCOM.PABS + 1) / 2;      /* LDAQ  &  STAQ */
     3564    26904 C                 END;
     3565    26905 C               ELSE
     3566    26906 C                 PCOM.CABS = 0;
     3567    26907                 %ENDIF;
     3568    26908    2            CALL RESTORE_GLOBAL_REGISTERS;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:637  
  26908 46 021275   022115 701000 46                 TSX1    RESTORE_GLOBAL_REGISTERS
        46 021276   000000 011000                    NOP     0

     3569    26909
     3570    26910    2            USE_PROC_RETURN = PCOM.YOPND;

  26910 46 021277   200004 470500                    LDP0    @PCOM,,AUTO
        46 021300   000062 236100                    LDQ     50,,PR0
        46 021301   000000 756000 17                 STQ     USE_PROC_RETURN
        46 021302   021307 710000 46                 TRA     s:26924

     3571    26911
     3572    26912               %IF GCOS;
     3573    26913 C             CASE( %THIRD_PASS, %FOURTH_PASS );
     3574    26914 C
     3575    26915 C               CALL RESTORE_GLOBAL_REGISTERS;
     3576    26916 C
     3577    26917 C           END; /* CASE_PASS */
     3578    26918             %ENDIF;
     3579    26919
     3580    26920        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:638  
     3581    26921    2   CASE(ELSE);

     3582    26922    2       CALL Z8AE$ERROR(%E$UNEXPECTED_CASE);

  26922 46 021303   000061 630400 47                 EPPR0   49
        46 021304   000000 631400 47                 EPPR1   0
        46 021305   000000 701000 xent               TSX1    Z8AE$ERROR
        46 021306   000000 011000                    NOP     0

     3583    26923        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:639  
     3584    26924    2   END /* Case */;

  26924 46 021307   022724 710000 46                 TRA     s:27623

     3585    26925        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:640  
     3586    26926    1   ALPHANUMERIC_PRESET:PROC(TARGET_LENGTH);

  26926 46 021310   200262 741300       ALPHANUMERI* STX1  ! LOWER$+1,,AUTO

     3587    26927        /*I*
     3588    26928             NAME: ALPHANUMERIC_PRESET
     3589    26929             PURPOSE:
     3590    26930                  Alphanumeric preset.
     3591    26931             CALL:
     3592    26932                  CALL ALPHANUMERIC_PRESET (TARGET_LENGTH);
     3593    26933             PARAMETERS:
     3594    26934                  TARGET_LENGTH - Length in characters of the receiving guy.
     3595    26935             DESCRIPTION:
     3596    26936                  Move one character at a time into the receiving guy.
     3597    26937                  When a word is full, call FLUSH.  If the receiving
     3598    26938                  guy is shorter than the sending guy, then truncate.
     3599    26939                  If the receiving guy is longer than the sending guy
     3600    26940                  and the ALL bit in the sending guy is set, then
     3601    26941                  move as many copies of the sending item in as will fit,
     3602    26942                  maybe with truncation of the last one moved in.  If
     3603    26943                  the receiving guy is shorter and no ALL bit is set
     3604    26944                  then blank fill.
     3605    26945        */
     3606    26946
     3607    26947    2        DCL TARGET_LENGTH       SBIN WORD;
     3608    26948
     3609    26949    2        TOTAL_MOVED = 0;

  26949 46 021311   200136 450100                    STZ     TOTAL_MOVED,,AUTO

     3610    26950    2        SOURCE      = 0;

  26950 46 021312   200137 450100                    STZ     SOURCE,,AUTO

     3611    26951
     3612    26952
     3613    26953    2        TARGET = TARGET$ -> VARIABLE.NDSC.CN / 2;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:641  

  26953 46 021313   200134 470500                    LDP0    TARGET$,,AUTO
        46 021314   000001 236100                    LDQ     1,,PR0
        46 021315   000017 772000                    QRL     15
        46 021316   000007 376007                    ANQ     7,DL
        46 021317   000001 772000                    QRL     1
        46 021320   000002 756000 25                 STQ     TARGET

     3614    26954
     3615    26955    3   LP:  DO WHILE(TOTAL_MOVED < TARGET_LENGTH);

  26955 46 021321   200263 471500       LP           LDP1    @TARGET_LENGTH,,AUTO
        46 021322   200136 236100                    LDQ     TOTAL_MOVED,,AUTO
        46 021323   100000 116100                    CMPQ    0,,PR1
        46 021324   021447 605000 46                 TPL     s:27000

     3616    26956    3          IF SOURCE >= CONSTANT$ -> CONST.ADSC.N THEN

  26956 46 021325   000001 470400 25                 LDP0    CONSTANT$
        46 021326   000001 236100                    LDQ     1,,PR0
        46 021327   007777 376007                    ANQ     4095,DL
        46 021330   200137 116100                    CMPQ    SOURCE,,AUTO
        46 021331   021421 605400 46                 TPNZ    s:26985

     3617    26957    3            IF CONSTANT$ -> CONST.B.ALL THEN

  26957 46 021332   000003 236100                    LDQ     3,,PR0
        46 021333   040000 316003                    CANQ    16384,DU
        46 021334   021337 600000 46                 TZE     s:26961

     3618    26958    3              SOURCE = 0;

  26958 46 021335   200137 450100                    STZ     SOURCE,,AUTO
        46 021336   021421 710000 46                 TRA     s:26985

     3619    26959    3            ELSE
     3620    26960    4              DO;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:642  

     3621    26961    5                DO WHILE(TARGET_LENGTH > TOTAL_MOVED);

  26961 46 021337   200263 471500                    LDP1    @TARGET_LENGTH,,AUTO
        46 021340   100000 236100                    LDQ     0,,PR1
        46 021341   200136 116100                    CMPQ    TOTAL_MOVED,,AUTO
        46 021342   021420 604400 46                 TMOZ    s:26982

     3622    26962    6                  DO CASE (TARGET$ -> SCALAR.TYPE);

  26962 46 021343   200134 470500                    LDP0    TARGET$,,AUTO
        46 021344   000002 236100                    LDQ     2,,PR0
        46 021345   000022 772000                    QRL     18
        46 021346   000006 136007                    SBLQ    6,DL
        46 021347   000011 116007                    CMPQ    9,DL
        46 021350   021352 602006 46                 TNC     s:26962+7,QL
        46 021351   021401 710000 46                 TRA     s:26971
        46 021352   021375 710000 46                 TRA     s:26968
        46 021353   021401 710000 46                 TRA     s:26971
        46 021354   021370 710000 46                 TRA     s:26966
        46 021355   021401 710000 46                 TRA     s:26971
        46 021356   021401 710000 46                 TRA     s:26971
        46 021357   021401 710000 46                 TRA     s:26971
        46 021360   021401 710000 46                 TRA     s:26971
        46 021361   021401 710000 46                 TRA     s:26971
        46 021362   021363 710000 46                 TRA     s:26964

     3623    26963    6                    CASE (%TYN);

     3624    26964    6                      SUBSTR(CHAR_BUFFER,TARGET,1) = %KANJI_SPACE ;

  26964 46 021363   000002 235000 25                 LDA     TARGET
        46 021364   040005 100400                    MLR     fill='040'O
        46 021365   000112 000001 47                 ADSC9   74                       cn=0,n=1
        46 021366   000004 000001 25                 ADSC9   BUFFER,A                 cn=0,n=1
        46 021367   021401 710000 46                 TRA     s:26971

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:643  
     3625    26965    6                    CASE (%TYA);

     3626    26966    6                      SUBSTR(CHAR_BUFFER,TARGET,1) = ' ';

  26966 46 021370   000002 235000 25                 LDA     TARGET
        46 021371   040005 100400                    MLR     fill='040'O
        46 021372   000113 000001 47                 ADSC9   75                       cn=0,n=1
        46 021373   000004 000001 25                 ADSC9   BUFFER,A                 cn=0,n=1
        46 021374   021401 710000 46                 TRA     s:26971

     3627    26967    6                    CASE (%TYE);

     3628    26968    6                      SUBSTR(CHAR_BUFFER,TARGET,1) = BITASC ('100'O);

  26968 46 021375   000002 235000 25                 LDA     TARGET
        46 021376   040005 100400                    MLR     fill='040'O
        46 021377   000114 000001 47                 ADSC9   76                       cn=0,n=1
        46 021400   000004 000001 25                 ADSC9   BUFFER,A                 cn=0,n=1

     3629    26969    6                  END;

     3630    26970
     3631    26971    5                  TARGET = TARGET + 1;

  26971 46 021401   000002 054000 25                 AOS     TARGET

     3632    26972    5                  TOTAL_MOVED = TOTAL_MOVED + 1;

  26972 46 021402   200136 054100                    AOS     TOTAL_MOVED,,AUTO

     3633    26973
     3634    26974    5                  IF TARGET = 4 THEN

  26974 46 021403   000002 235000 25                 LDA     TARGET
        46 021404   000004 115007                    CMPA    4,DL
        46 021405   021414 601000 46                 TNZ     s:26980

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:644  
     3635    26975    6                    DO;

     3636    26976    6                      CALL FLUSH_BUFFER(CURRENT_SA);

  26976 46 021406   200242 631500                    EPPR1   CURRENT_SA,,AUTO
        46 021407   200265 451500                    STP1    SEND$+1,,AUTO
        46 021410   021605 701000 46                 TSX1    FLUSH_BUFFER
        46 021411   000000 011000                    NOP     0

     3637    26977    6                      TARGET = 0;

  26977 46 021412   000002 450000 25                 STZ     TARGET

     3638    26978    6                      CURRENT_SA = CURRENT_SA + 1;

  26978 46 021413   200242 054100                    AOS     CURRENT_SA,,AUTO

     3639    26979    6                    END;

     3640    26980    5                END /* While */;

  26980 46 021414   200263 470500                    LDP0    @TARGET_LENGTH,,AUTO
        46 021415   000000 236100                    LDQ     0,,PR0
        46 021416   200136 116100                    CMPQ    TOTAL_MOVED,,AUTO
        46 021417   021343 605400 46                 TPNZ    s:26962

     3641    26981
     3642    26982    4                EXIT LP;

  26982 46 021420   021447 710000 46                 TRA     s:27000

     3643    26983    4              END;
     3644    26984
     3645    26985    3          SUBSTR(CHAR_BUFFER,TARGET,1) = SUBSTR(STRING$ -> CHARS,SOURCE,1);

  26985 46 021421   200133 471500                    LDP1    STRING$,,AUTO
        46 021422   200137 235100                    LDA     SOURCE,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:645  
        46 021423   000002 236000 25                 LDQ     TARGET
        46 021424   040006 100505                    MLR     fill='040'O
        46 021425   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
        46 021426   000004 000001 25                 ADSC9   BUFFER,Q                 cn=0,n=1

     3646    26986
     3647    26987    3          TOTAL_MOVED = TOTAL_MOVED + 1;

  26987 46 021427   200136 054100                    AOS     TOTAL_MOVED,,AUTO

     3648    26988    3          SOURCE = SOURCE + 1;

  26988 46 021430   200137 054100                    AOS     SOURCE,,AUTO

     3649    26989    3          TARGET = TARGET + 1;

  26989 46 021431   000002 054000 25                 AOS     TARGET

     3650    26990
     3651    26991    3          IF TARGET = 4 THEN

  26991 46 021432   000002 235000 25                 LDA     TARGET
        46 021433   000004 115007                    CMPA    4,DL
        46 021434   021443 601000 46                 TNZ     s:26998

     3652    26992    4            DO;

     3653    26993    4              CALL FLUSH_BUFFER(CURRENT_SA);

  26993 46 021435   200242 630500                    EPPR0   CURRENT_SA,,AUTO
        46 021436   200265 450500                    STP0    SEND$+1,,AUTO
        46 021437   021605 701000 46                 TSX1    FLUSH_BUFFER
        46 021440   000000 011000                    NOP     0

     3654    26994    4              TARGET = 0;

  26994 46 021441   000002 450000 25                 STZ     TARGET
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:646  

     3655    26995    4              CURRENT_SA = CURRENT_SA + 1;

  26995 46 021442   200242 054100                    AOS     CURRENT_SA,,AUTO

     3656    26996    4            END;

     3657    26997
     3658    26998    3        END /* While */;

  26998 46 021443   200263 470500                    LDP0    @TARGET_LENGTH,,AUTO
        46 021444   200136 236100                    LDQ     TOTAL_MOVED,,AUTO
        46 021445   000000 116100                    CMPQ    0,,PR0
        46 021446   021325 604000 46                 TMI     s:26956

     3659    26999
     3660    27000    2        BITS_IN_BUFFER = TARGET * 9;

  27000 46 021447   000002 236000 25                 LDQ     TARGET
        46 021450   000011 402007                    MPY     9,DL
        46 021451   000003 756000 25                 STQ     BITS_IN_BUFFER

     3661    27001    2        OLD_SA = CURRENT_SA;

  27001 46 021452   200242 235100                    LDA     CURRENT_SA,,AUTO
        46 021453   000006 755000 25                 STA     OLD_SA

     3662    27002
     3663    27003
     3664    27004    2   END ALPHANUMERIC_PRESET;

  27004 46 021454   200262 221300                    LDX1  ! LOWER$+1,,AUTO
        46 021455   000001 702211                    TSX2  ! 1,X1

     3665    27005        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:647  
     3666    27006    1   GBCD_PRESET:PROC(TARGET_LENGTH);

  27006 46 021456   200262 741300       GBCD_PRESET  STX1  ! LOWER$+1,,AUTO

     3667    27007        /*I*
     3668    27008             NAME: GBCD_PRESET
     3669    27009             PURPOSE:
     3670    27010                  GBCD preset.
     3671    27011             CALL:
     3672    27012                  CALL GBCD_PRESET (TARGET_LENGTH);
     3673    27013             PARAMETERS:
     3674    27014                  TARGET_LENGTH - Length in characters of the receiving guy.
     3675    27015             DESCRIPTION:
     3676    27016                  Move one character at a time into the receiving guy.
     3677    27017                  When a word is full, call FLUSH.  If the receiving
     3678    27018                  guy is shorter than the sending guy, then truncate.
     3679    27019                  If the receiving guy is longer than the sending guy
     3680    27020                  and the ALL bit in the sending guy is set, then
     3681    27021                  move as many copies of the sending item in as will fit,
     3682    27022                  maybe with truncation of the last one moved in.  If
     3683    27023                  the receiving guy is shorter and no ALL bit is set
     3684    27024                  then blank fill.
     3685    27025        */
     3686    27026
     3687    27027    2        DCL TARGET_LENGTH       SBIN WORD;
     3688    27028
     3689    27029    2        TOTAL_MOVED = 0;

  27029 46 021457   200136 450100                    STZ     TOTAL_MOVED,,AUTO

     3690    27030    2        SOURCE      = 0;

  27030 46 021460   200137 450100                    STZ     SOURCE,,AUTO

     3691    27031
     3692    27032    2        TARGET = TARGET$ -> VARIABLE.NDSC.CN;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:648  
  27032 46 021461   200134 470500                    LDP0    TARGET$,,AUTO
        46 021462   000001 236100                    LDQ     1,,PR0
        46 021463   000017 772000                    QRL     15
        46 021464   000007 376007                    ANQ     7,DL
        46 021465   000002 756000 25                 STQ     TARGET

     3693    27033
     3694    27034    3   LP:  DO WHILE(TOTAL_MOVED < TARGET_LENGTH);

  27034 46 021466   200263 471500       LP           LDP1    @TARGET_LENGTH,,AUTO
        46 021467   200136 236100                    LDQ     TOTAL_MOVED,,AUTO
        46 021470   100000 116100                    CMPQ    0,,PR1
        46 021471   021576 605000 46                 TPL     s:27071

     3695    27035    3          IF SOURCE >= CONSTANT$ -> CONST.ADSC.N THEN

  27035 46 021472   000001 470400 25                 LDP0    CONSTANT$
        46 021473   000001 236100                    LDQ     1,,PR0
        46 021474   007777 376007                    ANQ     4095,DL
        46 021475   200137 116100                    CMPQ    SOURCE,,AUTO
        46 021476   021536 605400 46                 TPNZ    s:27057

     3696    27036    3            IF CONSTANT$ -> CONST.B.ALL THEN

  27036 46 021477   000003 236100                    LDQ     3,,PR0
        46 021500   040000 316003                    CANQ    16384,DU
        46 021501   021504 600000 46                 TZE     s:27040

     3697    27037    3              SOURCE = 0;

  27037 46 021502   200137 450100                    STZ     SOURCE,,AUTO
        46 021503   021536 710000 46                 TRA     s:27057

     3698    27038    3            ELSE
     3699    27039    4              DO;

     3700    27040    5                DO WHILE(TARGET_LENGTH > TOTAL_MOVED);
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:649  

  27040 46 021504   200263 471500                    LDP1    @TARGET_LENGTH,,AUTO
        46 021505   100000 236100                    LDQ     0,,PR1
        46 021506   200136 116100                    CMPQ    TOTAL_MOVED,,AUTO
        46 021507   021535 604400 46                 TMOZ    s:27054

     3701    27041    5                  BCD_BUFFER(TARGET) = '20'O; /* BCD space */

  27041 46 021510   000002 235000 25                 LDA     TARGET
        46 021511   021513 605000 46                 TPL     s:27041+3
        46 021512   000006 035003                    ADLA    6,DU
        46 021513   000005 100400                    MLR     fill='000'O
        46 021514   000115 020001 47                 ADSC6   77                       cn=0,n=1
        46 021515   000004 020001 25                 ADSC6   BUFFER,A                 cn=0,n=1

     3702    27042
     3703    27043    5                  TARGET = TARGET + 1;

  27043 46 021516   000002 054000 25                 AOS     TARGET

     3704    27044    5                  TOTAL_MOVED = TOTAL_MOVED + 1;

  27044 46 021517   200136 054100                    AOS     TOTAL_MOVED,,AUTO

     3705    27045
     3706    27046    5                  IF TARGET = 6 THEN

  27046 46 021520   000002 235000 25                 LDA     TARGET
        46 021521   000006 115007                    CMPA    6,DL
        46 021522   021531 601000 46                 TNZ     s:27052

     3707    27047    6                    DO;

     3708    27048    6                      CALL FLUSH_BUFFER(CURRENT_SA);

  27048 46 021523   200242 630500                    EPPR0   CURRENT_SA,,AUTO
        46 021524   200265 450500                    STP0    SEND$+1,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:650  
        46 021525   021605 701000 46                 TSX1    FLUSH_BUFFER
        46 021526   000000 011000                    NOP     0

     3709    27049    6                      TARGET = 0;

  27049 46 021527   000002 450000 25                 STZ     TARGET

     3710    27050    6                      CURRENT_SA = CURRENT_SA + 1;

  27050 46 021530   200242 054100                    AOS     CURRENT_SA,,AUTO

     3711    27051    6                    END;

     3712    27052    5                END /* While */;

  27052 46 021531   200263 470500                    LDP0    @TARGET_LENGTH,,AUTO
        46 021532   000000 236100                    LDQ     0,,PR0
        46 021533   200136 116100                    CMPQ    TOTAL_MOVED,,AUTO
        46 021534   021510 605400 46                 TPNZ    s:27041

     3713    27053
     3714    27054    4                EXIT LP;

  27054 46 021535   021576 710000 46                 TRA     s:27071

     3715    27055    4              END;
     3716    27056
     3717    27057    3          BCD_BUFFER(TARGET) = STRING$ -> BCD$CHARS(SOURCE);

  27057 46 021536   200137 236100                    LDQ     SOURCE,,AUTO
        46 021537   000006 402007                    MPY     6,DL
        46 021540   000000 116003                    CMPQ    0,DU
        46 021541   021543 605000 46                 TPL     s:27057+5
        46 021542   000044 036003                    ADLQ    36,DU
        46 021543   200302 756100                    STQ     ORG1+1,,AUTO
        46 021544   000002 236000 25                 LDQ     TARGET
        46 021545   000006 402007                    MPY     6,DL
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:651  
        46 021546   000000 116003                    CMPQ    0,DU
        46 021547   021551 605000 46                 TPL     s:27057+11
        46 021550   000044 036003                    ADLQ    36,DU
        46 021551   200133 471500                    LDP1    STRING$,,AUTO
        46 021552   200302 235100                    LDA     ORG1+1,,AUTO
        46 021553   003006 060505                    CSL     bolr='003'O
        46 021554   100000 000006                    BDSC    0,A,PR1                  by=0,bit=0,n=6
        46 021555   000004 000006 25                 BDSC    BUFFER,Q                 by=0,bit=0,n=6

     3718    27058    3          TOTAL_MOVED = TOTAL_MOVED + 1;

  27058 46 021556   200136 054100                    AOS     TOTAL_MOVED,,AUTO

     3719    27059    3          SOURCE = SOURCE + 1;

  27059 46 021557   200137 054100                    AOS     SOURCE,,AUTO

     3720    27060    3          TARGET = TARGET + 1;

  27060 46 021560   000002 054000 25                 AOS     TARGET

     3721    27061
     3722    27062    3          IF TARGET = 6 THEN

  27062 46 021561   000002 235000 25                 LDA     TARGET
        46 021562   000006 115007                    CMPA    6,DL
        46 021563   021572 601000 46                 TNZ     s:27069

     3723    27063    4            DO;

     3724    27064    4              CALL FLUSH_BUFFER(CURRENT_SA);

  27064 46 021564   200242 630500                    EPPR0   CURRENT_SA,,AUTO
        46 021565   200265 450500                    STP0    SEND$+1,,AUTO
        46 021566   021605 701000 46                 TSX1    FLUSH_BUFFER
        46 021567   000000 011000                    NOP     0

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:652  
     3725    27065    4              TARGET = 0;

  27065 46 021570   000002 450000 25                 STZ     TARGET

     3726    27066    4              CURRENT_SA = CURRENT_SA + 1;

  27066 46 021571   200242 054100                    AOS     CURRENT_SA,,AUTO

     3727    27067    4            END;

     3728    27068
     3729    27069    3        END /* While */;

  27069 46 021572   200263 470500                    LDP0    @TARGET_LENGTH,,AUTO
        46 021573   200136 236100                    LDQ     TOTAL_MOVED,,AUTO
        46 021574   000000 116100                    CMPQ    0,,PR0
        46 021575   021472 604000 46                 TMI     s:27035

     3730    27070
     3731    27071    2        BITS_IN_BUFFER = TARGET * 6;

  27071 46 021576   000002 236000 25                 LDQ     TARGET
        46 021577   000006 402007                    MPY     6,DL
        46 021600   000003 756000 25                 STQ     BITS_IN_BUFFER

     3732    27072    2        OLD_SA = CURRENT_SA;

  27072 46 021601   200242 235100                    LDA     CURRENT_SA,,AUTO
        46 021602   000006 755000 25                 STA     OLD_SA

     3733    27073
     3734    27074    2   END GBCD_PRESET;

  27074 46 021603   200262 221300                    LDX1  ! LOWER$+1,,AUTO
        46 021604   000001 702211                    TSX2  ! 1,X1

     3735    27075         %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:653  
     3736    27076    1   FLUSH_BUFFER:PROC(BUFFER_SA);

  27076 46 021605   200264 741300       FLUSH_BUFFER STX1  ! @PILL+1,,AUTO

     3737    27077        /*I*
     3738    27078              NAME:  FLUSH_BUFFER
     3739    27079              PURPOSE:
     3740    27080                     CHECKS TO SEE IF THE BITS IS THE BUFFER ARE FROM
     3741    27081                     THE CURRENT BLOCK
     3742    27082              CALL:
     3743    27083                     CALL FLUSH_BUFFER (BUFFER_SA)
     3744    27084              PARAMETERS:
     3745    27085                     BUFFER_SA - LOCATION TO BE PRESET. IS PASSED TO FLUSH.
     3746    27086              DESCRIPTION:
     3747    27087                     CREATES NEW ORG WHEN NEEDED AND CALLS FLUSH
     3748    27088        */
     3749    27089
     3750    27090    2         DCL BUFFER_SA   PTR;
     3751    27091
     3752    27092    2         IF (FLUSH_BLK$ ~= CURRENT_BLOCK$) AND

  27092 46 021606   000005 236000 25                 LDQ     FLUSH_BLK$
        46 021607   000000 116000 26                 CMPQ    CURRENT_BLOCK$
        46 021610   021644 600000 46                 TZE     s:27131
        46 021611   000005 116000 47                 CMPQ    5
        46 021612   021644 600000 46                 TZE     s:27131

     3753    27093    2                      (FLUSH_BLK$ ~= ADDR(NIL))  THEN
     3754    27094                %NEW_ORG ( @ST$ = FLUSH_BLK$);

  27112 46 021613   000002 236000 36                 LDQ     OBJ_+2
        46 021614   000002 036007                    ADLQ    2,DL
        46 021615   000003 116000 36                 CMPQ    OBJ_+3
        46 021616   021630 604000 46                 TMI     s:27118

  27114 46 021617   000000 234000 30                 SZN     PAGING_OBJ
        46 021620   021625 605000 46                 TPL     s:27116
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:654  

  27115 46 021621   000006 630400 47                 EPPR0   6
        46 021622   000000 631400 47                 EPPR1   0
        46 021623   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 021624   000000 011000                    NOP     0

  27116 46 021625   000007 631400 47                 EPPR1   7
        46 021626   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 021627   000000 011000                    NOP     0

  27118 46 021630   000002 236000 36                 LDQ     OBJ_+2
        46 021631   000022 736000                    QLS     18
        46 021632   000001 036000 36                 ADLQ    OBJ_+1
        46 021633   000000 756000 29                 STQ     OBJ$

  27119 46 021634   000002 236007                    LDQ     2,DL
        46 021635   000002 056000 36                 ASQ     OBJ_+2

  27120 46 021636   001013 220003                    LDX0    523,DU
        46 021637   000000 470400 29                 LDP0    OBJ$
        46 021640   000000 740100                    STX0    0,,PR0

  27124 46 021641   000005 236000 25                 LDQ     FLUSH_BLK$
        46 021642   000000 470400 29                 LDP0    OBJ$
        46 021643   000001 756100                    STQ     1,,PR0

     3755    27130
     3756    27131    2         CALL FLUSH(CONSTANT$,ADDR(CHAR_BUFFER),BUFFER_SA,1);

  27131 46 021644   000116 236000 47                 LDQ     78
        46 021645   200331 756100                    STQ     ORG1+24,,AUTO
        46 021646   000016 236000 47                 LDQ     14
        46 021647   200272 756100                    STQ     @OPND$+1,,AUTO
        46 021650   200265 236100                    LDQ     @BUFFER_SA,,AUTO
        46 021651   200271 756100                    STQ     @STRING$+1,,AUTO
        46 021652   200331 630500                    EPPR0   ORG1+24,,AUTO
        46 021653   200270 450500                    STP0    N_OPNDS+1,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:655  
        46 021654   000106 236000 47                 LDQ     70
        46 021655   200267 756100                    STQ     P$+1,,AUTO
        46 021656   021724 701000 46                 TSX1    FLUSH
        46 021657   000000 011000                    NOP     0

     3757    27132
     3758    27133    2         IF (FLUSH_BLK$ ~= CURRENT_BLOCK$) AND

  27133 46 021660   000005 236000 25                 LDQ     FLUSH_BLK$
        46 021661   000000 116000 26                 CMPQ    CURRENT_BLOCK$
        46 021662   021716 600000 46                 TZE     s:27172
        46 021663   000005 116000 47                 CMPQ    5
        46 021664   021716 600000 46                 TZE     s:27172

     3759    27134    2                      (FLUSH_BLK$ ~= ADDR(NIL))  THEN
     3760    27135                %NEW_ORG ( @ST$ = CURRENT_BLOCK$);

  27153 46 021665   000002 236000 36                 LDQ     OBJ_+2
        46 021666   000002 036007                    ADLQ    2,DL
        46 021667   000003 116000 36                 CMPQ    OBJ_+3
        46 021670   021702 604000 46                 TMI     s:27159

  27155 46 021671   000000 234000 30                 SZN     PAGING_OBJ
        46 021672   021677 605000 46                 TPL     s:27157

  27156 46 021673   000006 630400 47                 EPPR0   6
        46 021674   000000 631400 47                 EPPR1   0
        46 021675   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 021676   000000 011000                    NOP     0

  27157 46 021677   000007 631400 47                 EPPR1   7
        46 021700   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 021701   000000 011000                    NOP     0

  27159 46 021702   000002 236000 36                 LDQ     OBJ_+2
        46 021703   000022 736000                    QLS     18
        46 021704   000001 036000 36                 ADLQ    OBJ_+1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:656  
        46 021705   000000 756000 29                 STQ     OBJ$

  27160 46 021706   000002 236007                    LDQ     2,DL
        46 021707   000002 056000 36                 ASQ     OBJ_+2

  27161 46 021710   001013 220003                    LDX0    523,DU
        46 021711   000000 470400 29                 LDP0    OBJ$
        46 021712   000000 740100                    STX0    0,,PR0

  27165 46 021713   000000 236000 26                 LDQ     CURRENT_BLOCK$
        46 021714   000000 470400 29                 LDP0    OBJ$
        46 021715   000001 756100                    STQ     1,,PR0

     3761    27171
     3762    27172    2         FLUSH_BLK$ = ADDR(NIL);

  27172 46 021716   000005 236000 47                 LDQ     5
        46 021717   000005 756000 25                 STQ     FLUSH_BLK$

     3763    27173    2         BUFFER = 0;

  27173 46 021720   000004 450000 25                 STZ     BUFFER

     3764    27174    2         BITS_IN_BUFFER = 0;

  27174 46 021721   000003 450000 25                 STZ     BITS_IN_BUFFER

     3765    27175
     3766    27176    2   END FLUSH_BUFFER;

  27176 46 021722   200264 221300                    LDX1  ! @PILL+1,,AUTO
        46 021723   000001 702211                    TSX2  ! 1,X1

     3767    27177        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:657  
     3768    27178    1   FLUSH:PROC(CONSTANT$,STRING$,OFFSET,LENGTH);

  27178 46 021724   200266 741300       FLUSH        STX1  ! REC$+1,,AUTO

     3769    27179        /*I*
     3770    27180             NAME: FLUSH
     3771    27181             PURPOSE:
     3772    27182                  Put preset words into the OBJ table.
     3773    27183             CALL:
     3774    27184                  CALL FLUSH (CONSTANT$, STRING$, OFFSET, LENGTH)
     3775    27185             PARAMETERS:
     3776    27186                  CONSTANT$ - ST item of constant from which item was preset
     3777    27187                  STRING$   - String containing words to be put into OBJ.
     3778    27188                  OFFSET    - Location to be preset.
     3779    27189                  LENGTH    - Length in words of item pointed to by STRING$.
     3780    27190             DESCRIPTION:
     3781    27191                  Created OBJ items one word at time for each word in buffer.
     3782    27192        */
     3783    27193
     3784    27194    2        DCL CONSTANT$   PTR;
     3785    27195    2        DCL STRING$  PTR;
     3786    27196    2        DCL OFFSET   SBIN WORD;
     3787    27197    2        DCL LENGTH   SBIN WORD;
     3788    27198    2        DCL I        SBIN WORD;
     3789    27199
     3790    27200    2        DCL 1 STRING ALIGNED BASED(STRING$),
     3791    27201    2               2 WORDS(0:%PAGE_SIZE) BIT(36) UNAL;
     3792    27202
     3793    27203
     3794    27204    3        DO I = 0 TO LENGTH - 1;

  27204 46 021725   200273 450100                    STZ     I,,AUTO
        46 021726   022001 710000 46                 TRA     s:27258+1

     3795    27205               %NEW_WORD( @OU_WORD = "STRING.WORDS(I)" ,
     3796    27206                          @OFFSET  = "OFFSET + I" ,
     3797    27207                          @ST$     = CONSTANT$ ,
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:658  
     3798    27208                          @KEY     = MOD_KEY.KEY ,
     3799    27209                          @ADVANCE_BLOCK_SIZE=NO);

  27228 46 021727   000002 236000 36                 LDQ     OBJ_+2
        46 021730   000004 036007                    ADLQ    4,DL
        46 021731   000003 116000 36                 CMPQ    OBJ_+3
        46 021732   021744 604000 46                 TMI     s:27234

  27230 46 021733   000000 234000 30                 SZN     PAGING_OBJ
        46 021734   021741 605000 46                 TPL     s:27232

  27231 46 021735   000006 630400 47                 EPPR0   6
        46 021736   000000 631400 47                 EPPR1   0
        46 021737   000000 701000 xent               TSX1    Z9HF$WRITE_OBJ_PAGE
        46 021740   000000 011000                    NOP     0

  27232 46 021741   000007 631400 47                 EPPR1   7
        46 021742   000000 701000 xent               TSX1    Z9HF$GET_OBJ_PAGE
        46 021743   000000 011000                    NOP     0

  27234 46 021744   000002 236000 36                 LDQ     OBJ_+2
        46 021745   000022 736000                    QLS     18
        46 021746   000001 036000 36                 ADLQ    OBJ_+1
        46 021747   000000 756000 29                 STQ     OBJ$

  27235 46 021750   000004 236007                    LDQ     4,DL
        46 021751   000002 056000 36                 ASQ     OBJ_+2

  27236 46 021752   001012 220003                    LDX0    522,DU
        46 021753   000000 470400 29                 LDP0    OBJ$
        46 021754   000000 740100                    STX0    0,,PR0

  27239 46 021755   200267 470500                    LDP0    @CONSTANT$,,AUTO
        46 021756   000000 236100                    LDQ     0,,PR0
        46 021757   000000 471400 29                 LDP1    OBJ$
        46 021760   100002 756100                    STQ     2,,PR1

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:659  
  27240 46 021761   200271 473500                    LDP3    @OFFSET,,AUTO
        46 021762   300000 236100                    LDQ     0,,PR3
        46 021763   200273 036100                    ADLQ    I,,AUTO
        46 021764   100001 756100                    STQ     1,,PR1

  27241 46 021765   000000 236000 25                 LDQ     MOD_KEY
        46 021766   000011 736000                    QLS     9
        46 021767   100000 552110                    STBQ    0,'10'O,PR1

  27243 46 021770   200270 471500                    LDP1    @STRING$,,AUTO
        46 021771   100000 474500                    LDP4    0,,PR1
        46 021772   200273 721100                    LXL1    I,,AUTO
        46 021773   400000 236111                    LDQ     0,X1,PR4
        46 021774   000000 475400 29                 LDP5    OBJ$
        46 021775   500003 756100                    STQ     3,,PR5

     3800    27256
     3801    27257    3          MOD_KEY.B.ETC = TRUE;

  27257 46 021776   000010 236007                    LDQ     8,DL
        46 021777   000000 256000 25                 ORSQ    MOD_KEY

     3802    27258    3        END;

  27258 46 022000   200273 054100                    AOS     I,,AUTO
        46 022001   200272 470500                    LDP0    @LENGTH,,AUTO
        46 022002   200273 236100                    LDQ     I,,AUTO
        46 022003   000000 116100                    CMPQ    0,,PR0
        46 022004   021727 604000 46                 TMI     s:27228

     3803    27259
     3804    27260
     3805    27261
     3806    27262    2   END FLUSH;

  27262 46 022005   200266 221300                    LDX1  ! REC$+1,,AUTO
        46 022006   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:660  

     3807    27263        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:661  
     3808    27264        /*I*
     3809    27265             NAME: BUFFER_TOP_SSOPS_AND_SIZS
     3810    27266             PURPOSE:
     3811    27267                  To buffer all unevaluated SSOP and SIZ triads that are directly
     3812    27268                  below the ILL item (top SSOPs and SIZs of total tree).
     3813    27269             CALL:
     3814    27270                  CALL BUFFER_TOP_SSOPS_AND_SIZS(=triad);
     3815    27271             DATA:
     3816    27272                  P$
     3817    27273                       Used to protect the integrity of the passed parameter.
     3818    27274             DESCRIPTION:
     3819    27275                  Slide down the LOP of the sub-tree, collecting all of the
     3820    27276                  SSOP and SIZ triad addresses into SSOP_SIZ_BUFFER until a
     3821    27277                  non-SSOP or non-SIZ triad is encountered.
     3822    27278        */
     3823    27279    1   BUFFER_TOP_SSOPS_AND_SIZS:PROC(TRIAD);

  27279 46 022007   200262 741300       BUFFER_TOP_* STX1  ! LOWER$+1,,AUTO

     3824    27280
     3825    27281    2        DCL TRIAD PTR;
     3826    27282    2        DCL P$ PTR;
     3827    27283
     3828    27284    2        P$ = TRIAD;

  27284 46 022010   200263 470500                    LDP0    @TRIAD,,AUTO
        46 022011   000000 236100                    LDQ     0,,PR0
        46 022012   200264 756100                    STQ     P$,,AUTO

     3829    27285
     3830    27286    3        DO WHILE (P$ -> ETT.ID = %SSOP  /*#28637*/

  27286 46 022013   022026 710000 46                 TRA     s:27298

     3831    27287    3               OR P$ -> ETT.ID = %SIZ
     3832    27288    3               OR P$ -> ETT.ID = %REFMOD);
     3833    27289    3          IF P$ -> ETT.STATE = %UNEVAL_T THEN
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:662  

  27289 46 022014   200264 470500                    LDP0    P$,,AUTO
        46 022015   000004 220100                    LDX0    4,,PR0
        46 022016   022036 601000 46                 TNZ     s:27300

     3834    27290    4            DO;

     3835    27291    4              SSOP_SIZ_BUFFER(SSOP_SIZ_IDX) = P$;

  27291 46 022017   200264 236100                    LDQ     P$,,AUTO
        46 022020   200107 721100                    LXL1    SSOP_SIZ_IDX,,AUTO
        46 022021   200103 756111                    STQ     SSOP_SIZ_BUFFER,X1,AUTO

     3836    27292    4              SSOP_SIZ_IDX = SSOP_SIZ_IDX + 1;

  27292 46 022022   200107 054100                    AOS     SSOP_SIZ_IDX,,AUTO

     3837    27293    4            END;

  27293 46 022023   022024 710000 46                 TRA     s:27297

     3838    27294    3          ELSE
     3839    27295    3            EXIT;
     3840    27296
     3841    27297    3          P$ = P$ -> ETT.LOP;

  27297 46 022024   000001 236100                    LDQ     1,,PR0
        46 022025   200264 756100                    STQ     P$,,AUTO

     3842    27298    3        END;

  27298 46 022026   200264 470500                    LDP0    P$,,AUTO
        46 022027   000000 220100                    LDX0    0,,PR0
        46 022030   000005 100003                    CMPX0   5,DU
        46 022031   022014 600000 46                 TZE     s:27289
        46 022032   000004 100003                    CMPX0   4,DU
        46 022033   022014 600000 46                 TZE     s:27289
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:663  
        46 022034   000012 100003                    CMPX0   10,DU
        46 022035   022014 600000 46                 TZE     s:27289

     3843    27299
     3844    27300    2   END BUFFER_TOP_SSOPS_AND_SIZS;

  27300 46 022036   200262 221300                    LDX1  ! LOWER$+1,,AUTO
        46 022037   000001 702211                    TSX2  ! 1,X1

     3845    27301        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:664  
     3846    27302    1   LOAD_GLOBAL_REGISTERS: PROC;

  27302 46 022040   200262 741300       LOAD_GLOBAL* STX1  ! LOWER$+1,,AUTO

     3847    27303        /*I*
     3848    27304             NAME: LOAD_GLOBAL_REGISTERS
     3849    27305             PURPOSE:
     3850    27306                  LOAD GLOBAL REGISTERS!
     3851    27307             CALL:
     3852    27308                   CALL LOAD_GLOBAL_REGISTERS;
     3853    27309             DATA:
     3854    27310                   COMCOM.ESC_LIST
     3855    27311             DESCRIPTION:
     3856    27312                   Load the registers and mark the registers that are
     3857    27313                   to be assigned global.
     3858    27314        */
     3859    27315
     3860    27316    2       DCL I SBIN WORD;
     3861    27317
     3862    27318            %EQU ESC_LIST_LENGTH = 4;
     3863    27319
     3864    27320    2       I = 0;

  27320 46 022041   200263 450100                    STZ     I,,AUTO

     3865    27321
     3866    27322    3       DO WHILE (I <= %ESC_LIST_LENGTH) AND

  27322 46 022042   022104 710000 46                 TRA     s:27330

     3867    27323    3                           (COMCOM.ESC_LIST.ESC$(I) ~= ADDR(NIL));
     3868    27324    3         COMCOM.ESC_LIST.ESC$(I) -> ETT.COUNT = %DONT_MESS;

  27324 46 022043   200263 235100                    LDA     I,,AUTO
        46 022044   000001 735000                    ALS     1
        46 022045   000545 470405 xsym               LDP0    COMCOM+357,AL
        46 022046   777777 220003                    LDX0    -1,DU
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:665  
        46 022047   000000 440100                    SXL0    0,,PR0

     3869    27325    3         COMCOM.ESC_LIST.ESC$(I) -> ETT.B.PR# = COMCOM.ESC_LIST.PR#(I) - %PR3;

  27325 46 022050   000545 470405 xsym               LDP0    COMCOM+357,AL
        46 022051   000546 236005 xsym               LDQ     COMCOM+358,AL
        46 022052   000022 732000                    QRS     18
        46 022053   000027 136007                    SBLQ    23,DL
        46 022054   000007 736000                    QLS     7
        46 022055   000004 676100                    ERQ     4,,PR0
        46 022056   007600 376007                    ANQ     3968,DL
        46 022057   000004 656100                    ERSQ    4,,PR0

     3870    27326    3         COMCOM.ESC_LIST.ESC$(I) -> ETT.B.OPTION = COMCOM.ESC_LIST.OPTION(I);

  27326 46 022060   000545 470405 xsym               LDP0    COMCOM+357,AL
        46 022061   000546 236005 xsym               LDQ     COMCOM+358,AL
        46 022062   000014 736000                    QLS     12
        46 022063   000004 676100                    ERQ     4,,PR0
        46 022064   370000 376007                    ANQ     126976,DL
        46 022065   000004 656100                    ERSQ    4,,PR0

     3871    27327    3         COMCOM.ESC_LIST.ESC$(I) -> ETT.B.ESC_LIST = %TRUE;

  27327 46 022066   000545 470405 xsym               LDP0    COMCOM+357,AL
        46 022067   400000 236007                    LDQ     -131072,DL
        46 022070   000004 256100                    ORSQ    4,,PR0

     3872    27328    3         CALL Z8HI$BURST(COMCOM.ESC_LIST.ESC$(I),DEP.GDEP);

  27328 46 022071   000117 236000 47                 LDQ     79
        46 022072   200303 756100                    STQ     ORG1+2,,AUTO
        46 022073   200263 236100                    LDQ     I,,AUTO
        46 022074   000023 736000                    QLS     19
        46 022075   000120 036000 47                 ADLQ    80
        46 022076   200302 756100                    STQ     ORG1+1,,AUTO
        46 022077   200302 630500                    EPPR0   ORG1+1,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:666  
        46 022100   000013 631400 47                 EPPR1   11
        46 022101   000000 701000 xent               TSX1    Z8HI$BURST
        46 022102   000000 011000                    NOP     0

     3873    27329    3         I = I + 1;

  27329 46 022103   200263 054100                    AOS     I,,AUTO

     3874    27330    3       END;

  27330 46 022104   200263 235100                    LDA     I,,AUTO
        46 022105   000004 115007                    CMPA    4,DL
        46 022106   022113 605400 46                 TPNZ    s:27332
        46 022107   000001 735000                    ALS     1
        46 022110   000545 236005 xsym               LDQ     COMCOM+357,AL
        46 022111   000005 116000 47                 CMPQ    5
        46 022112   022043 601000 46                 TNZ     s:27324

     3875    27331
     3876    27332    2   END LOAD_GLOBAL_REGISTERS;

  27332 46 022113   200262 221300                    LDX1  ! LOWER$+1,,AUTO
        46 022114   000001 702211                    TSX2  ! 1,X1

     3877    27333        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:667  
     3878    27334    1   RESTORE_GLOBAL_REGISTERS: PROC;

  27334 46 022115   200262 741300       RESTORE_GLO* STX1  ! LOWER$+1,,AUTO

     3879    27335        /*I*
     3880    27336             NAME: RESTORE_GLOBAL_REGISTERS
     3881    27337             PURPOSE:
     3882    27338                  RESTORE GLOBAL REGISTERS!
     3883    27339             CALL:
     3884    27340                   CALL RESTORE_GLOBAL_REGISTERS;
     3885    27341             DATA:
     3886    27342                   COMCOM.ESC_LIST
     3887    27343             DESCRIPTION:
     3888    27344                   Step through COMCOM.ESC_LIST and restore the globally
     3889    27345                   assigned pointer registers.
     3890    27346        */
     3891    27347
     3892    27348    2       DCL I SBIN WORD;
     3893    27349
     3894    27350
     3895    27351    2       I = 0;

  27351 46 022116   200263 450100                    STZ     I,,AUTO

     3896    27352
     3897    27353    3       DO WHILE (I <= %ESC_LIST_LENGTH) AND

  27353 46 022117   022141 710000 46                 TRA     s:27366

     3898    27354    3                (COMCOM.ESC_LIST.ESC$(I) ~= ADDR(NIL));
     3899    27355    3         IF COMCOM.ESC_LIST.ESC$(I) -> ETT.ID ~= %ARGP

  27355 46 022120   200263 235100                    LDA     I,,AUTO
        46 022121   000001 735000                    ALS     1
        46 022122   000545 470405 xsym               LDP0    COMCOM+357,AL
        46 022123   000000 220100                    LDX0    0,,PR0
        46 022124   000016 100003                    CMPX0   14,DU
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:668  
        46 022125   022140 600000 46                 TZE     s:27365

     3900    27356              %IF GCOS;
     3901    27357 C            OR ((PILL -> ETT.ID ~= %USE_ENTRY
     3902    27358 C                 OR PILL -> ETT.CODE ~= %INIT_PROC)
     3903    27359 C                AND (PILL -> ETT.ID ~= %OS_CALL
     3904    27360 C                 OR PILL -> ETT.CODE ~= %OP_CLOSE_CANCEL)
     3905    27361 C            AND CURRENT_ENTRY$ -> ENTRY_ILL.LOP -> ST.ID = %SYMDEF_)
     3906    27362              %ENDIF;
     3907    27363    3         THEN
     3908    27364    3           CALL Z8HI$BURST(COMCOM.ESC_LIST.ESC$(I),DEP.HDEP);

  27364 46 022126   000121 236000 47                 LDQ     81
        46 022127   200303 756100                    STQ     ORG1+2,,AUTO
        46 022130   200263 236100                    LDQ     I,,AUTO
        46 022131   000023 736000                    QLS     19
        46 022132   000120 036000 47                 ADLQ    80
        46 022133   200302 756100                    STQ     ORG1+1,,AUTO
        46 022134   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 022135   000013 631400 47                 EPPR1   11
        46 022136   000000 701000 xent               TSX1    Z8HI$BURST
        46 022137   000000 011000                    NOP     0

     3909    27365    3         I = I + 1;

  27365 46 022140   200263 054100                    AOS     I,,AUTO

     3910    27366    3       END;

  27366 46 022141   200263 235100                    LDA     I,,AUTO
        46 022142   000004 115007                    CMPA    4,DL
        46 022143   022150 605400 46                 TPNZ    s:27368
        46 022144   000001 735000                    ALS     1
        46 022145   000545 236005 xsym               LDQ     COMCOM+357,AL
        46 022146   000005 116000 47                 CMPQ    5
        46 022147   022120 601000 46                 TNZ     s:27355

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:669  
     3911    27367
     3912    27368    2   END RESTORE_GLOBAL_REGISTERS;

  27368 46 022150   200262 221300                    LDX1  ! LOWER$+1,,AUTO
        46 022151   000001 702211                    TSX2  ! 1,X1

     3913    27369        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:670  
     3914    27370        /*-------------------*/
     3915    27371    1     FREE_REGISTER_CHECK: PROC (PILL);

  27371 46 022152   200262 741300       FREE_REGIST* STX1  ! LOWER$+1,,AUTO

     3916    27372        /*-------------------*/
     3917    27373        /*I*
     3918    27374            NAME: FREE_REGISTER_CHECK
     3919    27375            PURPOSE:
     3920    27376                 Check for group MOVE, etc., for possible register purge.
     3921    27377            CALL:
     3922    27378                 CALL FREE_REGISTER_CHECK (PILL);
     3923    27379            DESCRIPTION:
     3924    27380                 Check the LOP of the ILL item pointer to by PILL to see
     3925    27381                 if it is a group or part of REDEFINES or RENAMES. A POINTER
     3926    27382                 will not always have a non-null QLT$ but it will never
     3927    27383                 be associated with a redefinition or a renaming.
     3928    27384        */
     3929    27385    2        DCL PILL  PTR;  /* Pointer to ILL move item         */
     3930    27386    2        DCL SEND$ PTR; /* Pointer to sending operand */
     3931    27387    2        DCL REC$  PTR; /* Pointer to destination operand */
     3932    27388    2        DCL P$    PTR;  /* Pointer to LOP Symbol Table item */
     3933    27389    2        DCL N_OPNDS UBIN;
     3934    27390
     3935    27391    2        REC$ = PILL -> ILL.LOP;

  27391 46 022153   200263 470500                    LDP0    @PILL,,AUTO
        46 022154   000000 471500                    LDP1    0,,PR0
        46 022155   100001 236100                    LDQ     1,,PR1
        46 022156   200265 756100                    STQ     REC$,,AUTO

     3936    27392    3        IF PILL -> ILL.ID ~= %MFILL THEN DO;

  27392 46 022157   000000 471500                    LDP1    0,,PR0
        46 022160   100000 220100                    LDX0    0,,PR1
        46 022161   000270 100003                    CMPX0   184,DU
        46 022162   022170 600000 46                 TZE     s:27396
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:671  

     3937    27393    3          SEND$ = PILL -> ILL.ROP;

  27393 46 022163   100002 236100                    LDQ     2,,PR1
        46 022164   200264 756100                    STQ     SEND$,,AUTO

     3938    27394    3          N_OPNDS = 2;

  27394 46 022165   000002 235007                    LDA     2,DL
        46 022166   200267 755100                    STA     N_OPNDS,,AUTO

     3939    27395    3        END;

  27395 46 022167   022172 710000 46                 TRA     s:27397

     3940    27396    2        ELSE N_OPNDS = 1;

  27396 46 022170   000001 235007                    LDA     1,DL
        46 022171   200267 755100                    STA     N_OPNDS,,AUTO

     3941    27397    2        GOTO COMMON_REG_CHECK;

  27397 46 022172   022205 710000 46                 TRA     COMMON_REG_CHECK

     3942    27398    2   FREE_REGISTER_CHECK_3: ENTRY (PILL);

  27398 46 022173   200262 741300       FREE_REGIST* STX1  ! LOWER$+1,,AUTO

     3943    27399    2        REC$ = PILL -> ILL.TO_;

  27399 46 022174   200263 470500                    LDP0    @PILL,,AUTO
        46 022175   000000 471500                    LDP1    0,,PR0
        46 022176   100003 236100                    LDQ     3,,PR1
        46 022177   200265 756100                    STQ     REC$,,AUTO

     3944    27400    2        SEND$ = PILL -> ILL.LOP;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:672  
  27400 46 022200   000000 471500                    LDP1    0,,PR0
        46 022201   100001 236100                    LDQ     1,,PR1
        46 022202   200264 756100                    STQ     SEND$,,AUTO

     3945    27401    2        N_OPNDS = 3;

  27401 46 022203   000003 235007                    LDA     3,DL
        46 022204   200267 755100                    STA     N_OPNDS,,AUTO

     3946    27402    2   COMMON_REG_CHECK:
     3947    27403    2        CALL Z8AU$TYPE_DESCRIPTOR (REC$, TYPE_DESC);

  27403 46 022205   200110 633500       COMMON_REG_* EPPR3   TYPE_DESC,,AUTO
        46 022206   200303 453500                    STP3    ORG1+2,,AUTO
        46 022207   200265 631500                    EPPR1   REC$,,AUTO
        46 022210   200302 451500                    STP1    ORG1+1,,AUTO
        46 022211   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 022212   000013 631400 47                 EPPR1   11
        46 022213   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        46 022214   000000 011000                    NOP     0

     3948    27404             %FISH (TRIAD = REC$, RTN = P$);

  27406 46 022215   200265 236100                    LDQ     REC$,,AUTO
        46 022216   200266 756100                    STQ     P$,,AUTO

  27407 46 022217   200266 470500                    LDP0    P$,,AUTO
        46 022220   000000 220100                    LDX0    0,,PR0
        46 022221   000751 100003                    CMPX0   489,DU
        46 022222   022232 603000 46                 TRC     s:27412

  27408 46 022223   200266 470500                    LDP0    P$,,AUTO
        46 022224   000001 236100                    LDQ     1,,PR0
        46 022225   200266 756100                    STQ     P$,,AUTO

  27409 46 022226   200266 470500                    LDP0    P$,,AUTO
        46 022227   000000 220100                    LDX0    0,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:673  
        46 022230   000751 100003                    CMPX0   489,DU
        46 022231   022223 602000 46                 TNC     s:27408

     3949    27412    2        IF P$ -> VARIABLE.ID ~= %POINTER

  27412 46 022232   000777 100003                    CMPX0   511,DU
        46 022233   022511 600000 46                 TZE     s:27516
        46 022234   000003 236100                    LDQ     3,,PR0
        46 022235   010000 316003                    CANQ    4096,DU
        46 022236   022255 600000 46                 TZE     s:27412+19
        46 022237   000002 221100                    LDX1    2,,PR0
        46 022240   022255 601000 46                 TNZ     s:27412+19
        46 022241   000001 236100                    LDQ     1,,PR0
        46 022242   040000 316007                    CANQ    16384,DL
        46 022243   022255 600000 46                 TZE     s:27412+19
        46 022244   000003 430100                    FSZN    3,,PR0
        46 022245   022255 604000 46                 TMI     s:27412+19
        46 022246   000003 236100                    LDQ     3,,PR0
        46 022247   000400 316003                    CANQ    256,DU
        46 022250   022255 601000 46                 TNZ     s:27412+19
        46 022251   000007 471500                    LDP1    7,,PR0
        46 022252   100000 236100                    LDQ     0,,PR1
        46 022253   040000 316007                    CANQ    16384,DL
        46 022254   022511 600000 46                 TZE     s:27516
        46 022255   200265 471500                    LDP1    REC$,,AUTO
        46 022256   100000 221100                    LDX1    0,,PR1
        46 022257   000005 101003                    CMPX1   5,DU
        46 022260   022511 600000 46                 TZE     s:27516
        46 022261   000004 101003                    CMPX1   4,DU
        46 022262   022267 601000 46                 TNZ     s:27412+29
        46 022263   100001 473500                    LDP3    1,,PR1
        46 022264   300000 222100                    LDX2    0,,PR3
        46 022265   000005 102003                    CMPX2   5,DU
        46 022266   022511 600000 46                 TZE     s:27516
        46 022267   200263 473500                    LDP3    @PILL,,AUTO
        46 022270   300000 474500                    LDP4    0,,PR3
        46 022271   400000 222100                    LDX2    0,,PR4
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:674  
        46 022272   000270 102003                    CMPX2   184,DU
        46 022273   022307 600000 46                 TZE     s:27428
        46 022274   200267 235100                    LDA     N_OPNDS,,AUTO
        46 022275   000003 115007                    CMPA    3,DL
        46 022276   022307 600000 46                 TZE     s:27428
        46 022277   100004 223100                    LDX3    4,,PR1
        46 022300   200264 475500                    LDP5    SEND$,,AUTO
        46 022301   500004 103100                    CMPX3   4,,PR5
        46 022302   022307 601000 46                 TNZ     s:27428
        46 022303   000000 103003                    CMPX3   0,DU
        46 022304   022307 600000 46                 TZE     s:27428
        46 022305   000004 103003                    CMPX3   4,DU
        46 022306   022511 601000 46                 TNZ     s:27516

     3950    27413    2         AND (NOT P$ -> VARIABLE.B.ELEMENTARY
     3951    27414    2             OR P$ -> VARIABLE.TYPE ~= %TYD
     3952    27415    2             OR P$ -> VARIABLE.NDSC.TN = %NDSC9
     3953    27416    2             OR P$ -> VARIABLE.B.REDEF_SUB
     3954    27417    2             OR P$ -> VARIABLE.B.REDEF_OBJ
     3955    27418    2             OR P$ -> VARIABLE.QLT$ -> QLT.B.RENAMES)
     3956    27419    2         AND REC$ -> ETT.ID ~= %SSOP
     3957    27420    2         AND (REC$ -> ETT.ID ~= %SIZ
     3958    27421    2             OR REC$ -> ETT.LOP -> ETT.ID ~= %SSOP)
     3959    27422    2         AND (PILL -> ILL.ID = %MFILL
     3960    27423    2           OR N_OPNDS = 3
     3961    27424    2           OR REC$ -> ETT.STATE ~= SEND$ -> ETT.STATE
     3962    27425    2           OR REC$ -> ETT.STATE = %UNEVAL_T
     3963    27426    2           OR REC$ -> ETT.STATE = %REF_T) THEN
     3964    27427    3          DO;

     3965    27428    3            J = TYPE_DESC.DESC.SA * 8 + TYPE_DESC.DESC.NDSC.CN;

  27428 46 022307   200111 236100                    LDQ     TYPE_DESC+1,,AUTO
        46 022310   000017 772000                    QRL     15
        46 022311   000007 376007                    ANQ     7,DL
        46 022312   200302 756100                    STQ     ORG1+1,,AUTO
        46 022313   200111 236100                    LDQ     TYPE_DESC+1,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:675  
        46 022314   777777 376003                    ANQ     -1,DU
        46 022315   000017 772000                    QRL     15
        46 022316   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 022317   200066 756100                    STQ     J,,AUTO

     3966    27429    3            IF PILL -> ILL.ID = %MVANO AND

  27429 46 022320   300000 474500                    LDP4    0,,PR3
        46 022321   400000 220100                    LDX0    0,,PR4
        46 022322   000255 100003                    CMPX0   173,DU
        46 022323   022336 601000 46                 TNZ     s:27434
        46 022324   400000 721100                    LXL1    0,,PR4
        46 022325   000001 101003                    CMPX1   1,DU
        46 022326   022331 600000 46                 TZE     s:27429+9
        46 022327   000003 101003                    CMPX1   3,DU
        46 022330   022336 601000 46                 TNZ     s:27434
        46 022331   200111 236100                    LDQ     TYPE_DESC+1,,AUTO
        46 022332   600000 316007                    CANQ    -65536,DL
        46 022333   022336 601000 46                 TNZ     s:27434

     3967    27430    3                (PILL -> ILL.CODE = %MVANO_UPPER_TO_LOWER OR
     3968    27431    3                 PILL -> ILL.CODE = %MVANO_LOWER_TO_LOWER) AND
     3969    27432    3                TYPE_DESC.DESC.ADSC.CN = 0 THEN
     3970    27433    3              J = J + 4;

  27433 46 022334   000004 236007                    LDQ     4,DL
        46 022335   200066 056100                    ASQ     J,,AUTO

     3971    27434    3            IF P$ -> VARIABLE.B.CLASS = %CLASS_NUMERIC THEN

  27434 46 022336   000003 236100                    LDQ     3,,PR0
        46 022337   000007 376007                    ANQ     7,DL
        46 022340   000001 116007                    CMPQ    1,DL
        46 022341   022364 601000 46                 TNZ     s:27447

     3972    27435    4              DO;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:676  
     3973    27436    4                LOP_LEN = P$ -> VARIABLE.NDSC.N;

  27436 46 022342   000001 236100                    LDQ     1,,PR0
        46 022343   000077 376007                    ANQ     63,DL
        46 022344   200077 756100                    STQ     LOP_LEN,,AUTO

     3974    27437    4                IF P$ -> VARIABLE.TYPE = %TYC THEN

  27437 46 022345   000002 220100                    LDX0    2,,PR0
        46 022346   000023 100003                    CMPX0   19,DU
        46 022347   022354 601000 46                 TNZ     s:27439

     3975    27438    4                  LOP_LEN = LOP_LEN * 4 / 3; /* Convert to digits */

  27438 46 022350   000002 736000                    QLS     2
        46 022351   000003 506007                    DIV     3,DL
        46 022352   200077 756100                    STQ     LOP_LEN,,AUTO
        46 022353   022417 710000 46                 TRA     s:27461

     3976    27439    4                ELSE IF P$ -> VARIABLE.TYPE ~= %TYD OR

  27439 46 022354   000000 100003                    CMPX0   0,DU
        46 022355   022361 601000 46                 TNZ     s:27441
        46 022356   000001 236100                    LDQ     1,,PR0
        46 022357   040000 316007                    CANQ    16384,DL
        46 022360   022417 601000 46                 TNZ     s:27461

     3977    27440    4                    P$ -> VARIABLE.NDSC.TN = %NDSC9 THEN
     3978    27441    4                  LOP_LEN = LOP_LEN * 2; /* Convert to digits */

  27441 46 022361   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 022362   200077 056100                    ASQ     LOP_LEN,,AUTO

     3979    27442    4              END;

  27442 46 022363   022417 710000 46                 TRA     s:27461

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:677  
     3980    27443    3            ELSE
     3981    27444    4              DO;

     3982    27445                     %GET_ADSC_LEN (ST$ = P$, RTN = LOP_LEN);

  27447 46 022364   000003 236100                    LDQ     3,,PR0
        46 022365   004000 316003                    CANQ    2048,DU
        46 022366   022402 600000 46                 TZE     s:27453

  27448 46 022367   000005 474500                    LDP4    5,,PR0
        46 022370   400000 220100                    LDX0    0,,PR4
        46 022371   001105 100003                    CMPX0   581,DU
        46 022372   022377 601000 46                 TNZ     s:27451

  27449 46 022373   400003 475500                    LDP5    3,,PR4
        46 022374   500001 235100                    LDA     1,,PR5
        46 022375   200077 755100                    STA     LOP_LEN,,AUTO
        46 022376   022405 710000 46                 TRA     s:27456

  27451 46 022377   400001 235100                    LDA     1,,PR4
        46 022400   200077 755100                    STA     LOP_LEN,,AUTO
        46 022401   022405 710000 46                 TRA     s:27456

  27453 46 022402   000001 236100                    LDQ     1,,PR0
        46 022403   007777 376007                    ANQ     4095,DL
        46 022404   200077 756100                    STQ     LOP_LEN,,AUTO

     3983    27456    4                IF P$ -> VARIABLE.TYPE = %TYB THEN

  27456 46 022405   000002 220100                    LDX0    2,,PR0
        46 022406   000014 100003                    CMPX0   12,DU
        46 022407   022415 601000 46                 TNZ     s:27459

     3984    27457    4                  LOP_LEN = LOP_LEN * 4 / 3; /* Convert to digits */

  27457 46 022410   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 022411   000002 736000                    QLS     2
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:678  
        46 022412   000003 506007                    DIV     3,DL
        46 022413   200077 756100                    STQ     LOP_LEN,,AUTO
        46 022414   022417 710000 46                 TRA     s:27461

     3985    27458    4                ELSE
     3986    27459    4                  LOP_LEN = LOP_LEN * 2;

  27459 46 022415   200077 236100                    LDQ     LOP_LEN,,AUTO
        46 022416   200077 056100                    ASQ     LOP_LEN,,AUTO

     3987    27460    4              END;

     3988    27461    3            IF P$ -> VARIABLE.B.LINKAGE THEN

  27461 46 022417   000003 236100                    LDQ     3,,PR0
        46 022420   000002 316003                    CANQ    2,DU
        46 022421   022467 600000 46                 TZE     s:27511

     3989    27462    4              DO;

     3990    27463    4                QLT$ = P$ -> VARIABLE.QLT$;

  27463 46 022422   000007 236100                    LDQ     7,,PR0
        46 022423   000000 756000 37                 STQ     QLT$

     3991    27464    5                DO WHILE QLT$ -> QLT.LEVEL_NO > 1;

  27464 46 022424   000000 474400 37                 LDP4    QLT$
        46 022425   400000 236100                    LDQ     0,,PR4
        46 022426   000777 376007                    ANQ     511,DL
        46 022427   000002 116007                    CMPQ    2,DL
        46 022430   022441 602000 46                 TNC     s:27469

     3992    27465    5                  QLT$ = QLT$ -> QLT.FATHER;

  27465 46 022431   000000 470400 37                 LDP0    QLT$
        46 022432   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:679  
        46 022433   000000 756000 37                 STQ     QLT$

     3993    27466    5                END; /* BASE_LTS pointer is in level 01 ST item */

  27466 46 022434   000000 470400 37                 LDP0    QLT$
        46 022435   000000 236100                    LDQ     0,,PR0
        46 022436   000777 376007                    ANQ     511,DL
        46 022437   000002 116007                    CMPQ    2,DL
        46 022440   022431 603000 46                 TRC     s:27465

     3994    27467                     %GET_LTS (@ID = %BASE_LTS, @ST$ = QLT$ -> QLT.ST$, @RETURN$ = LTS$$);

  27469 46 022441   000000 470400 37                 LDP0    QLT$
        46 022442   000004 471500                    LDP1    4,,PR0
        46 022443   100005 236100                    LDQ     5,,PR1
        46 022444   000005 116000 47                 CMPQ    5
        46 022445   022455 600000 46                 TZE     s:27503
        46 022446   100005 473500                    LDP3    5,,PR1
        46 022447   300000 220100                    LDX0    0,,PR3
        46 022450   001105 100003                    CMPX0   581,DU
        46 022451   022455 601000 46                 TNZ     s:27503

  27497 46 022452   300010 236100                    LDQ     8,,PR3
        46 022453   200255 756100                    STQ     LTS$$,,AUTO

  27501 46 022454   022467 710000 46                 TRA     s:27511

  27503 46 022455   000005 116000 47                 CMPQ    5
        46 022456   022465 600000 46                 TZE     s:27507
        46 022457   100005 473500                    LDP3    5,,PR1
        46 022460   300000 220100                    LDX0    0,,PR3
        46 022461   001066 100003                    CMPX0   566,DU
        46 022462   022465 601000 46                 TNZ     s:27507

  27505 46 022463   200255 756100                    STQ     LTS$$,,AUTO
        46 022464   022467 710000 46                 TRA     s:27511

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:680  
  27507 46 022465   000005 236000 47                 LDQ     5
        46 022466   200255 756100                    STQ     LTS$$,,AUTO

     3995    27510    4              END;

     3996    27511    4            DO I = %ARA TO %AREAQ;

  27511 46 022467   000005 235007                    LDA     5,DL
        46 022470   200065 755100                    STA     I,,AUTO

     3997    27512    4              CALL FREE_REG_IF_NEED (P$, LOP_LEN, J, LTS$$, I);

  27512 46 022471   200065 630500                    EPPR0   I,,AUTO
        46 022472   200275 450500                    STP0    @BASE_LTS$+1,,AUTO
        46 022473   200255 631500                    EPPR1   LTS$$,,AUTO
        46 022474   200274 451500                    STP1    @ORG+1,,AUTO
        46 022475   200066 633500                    EPPR3   J,,AUTO
        46 022476   200273 453500                    STP3    I,,AUTO
        46 022477   200077 634500                    EPPR4   LOP_LEN,,AUTO
        46 022500   200272 454500                    STP4    @LENGTH,,AUTO
        46 022501   200266 635500                    EPPR5   P$,,AUTO
        46 022502   200271 455500                    STP5    @OFFSET,,AUTO
        46 022503   022513 701000 46                 TSX1    FREE_REG_IF_NEED
        46 022504   000000 011000                    NOP     0

     3998    27513    4            END;

  27513 46 022505   200065 054100                    AOS     I,,AUTO
        46 022506   200065 235100                    LDA     I,,AUTO
        46 022507   000022 115007                    CMPA    18,DL
        46 022510   022471 604400 46                 TMOZ    s:27512

     3999    27514    3          END;

     4000    27515
     4001    27516    2   END FREE_REGISTER_CHECK;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:681  
  27516 46 022511   200262 221300                    LDX1  ! LOWER$+1,,AUTO
        46 022512   000001 702211                    TSX2  ! 1,X1

     4002    27517        %EJECT;
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:682  
     4003    27518        /*----------------*/
     4004    27519    1     FREE_REG_IF_NEED: PROC (OPND$, LEN, ORG, BASE_LTS$, REGISTER);

  27519 46 022513   200270 741300       FREE_REG_IF* STX1  ! @STRING$,,AUTO

     4005    27520        /*----------------*/
     4006    27521        /*I*
     4007    27522            NAME: FREE_REG_IF_NEED
     4008    27523            PURPOSE: Spoil a register if it contains a subfield of the
     4009    27524                     receiving field of a MOVE.
     4010    27525            DESCRIPTION: Check to find out if one of the definitions of a
     4011    27526                         register begins within range of the receiving field
     4012    27527                         of a MOVE. If so then delete that one definition.
     4013    27528        */
     4014    27529    2   DCL OPND$     PTR;
     4015    27530    2   DCL LEN       UBIN;
     4016    27531    2   DCL ORG       UBIN;
     4017    27532    2   DCL BASE_LTS$ PTR;
     4018    27533    2   DCL REGISTER  UBIN;
     4019    27534
     4020    27535    2   DCL PRIME$    PTR;
     4021    27536    2   DCL ST$$      PTR;
     4022    27537    2   DCL LTS$$     PTR;
     4023    27538    2   DCL ORG1      UBIN;
     4024    27539
     4025    27540    2       PRIME$ = RAT.PRIMES (REGISTER);

  27540 46 022514   200275 470500                    LDP0    @REGISTER,,AUTO
        46 022515   000000 235100                    LDA     0,,PR0
        46 022516   000001 735000                    ALS     1
        46 022517   000001 735000                    ALS     1
        46 022520   000000 236005 12                 LDQ     RAT,AL
        46 022521   200276 756100                    STQ     PRIME$,,AUTO

     4026    27541    3       DO WHILE PRIME$ ~= ADDR (NIL);

  27541 46 022522   022720 710000 46                 TRA     s:27620
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:683  

     4027    27542    3         NEXT$ = PRIME$ -> PRIME.NEXT;                        /*#42937*/

  27542 46 022523   200276 470500                    LDP0    PRIME$,,AUTO
        46 022524   000003 236100                    LDQ     3,,PR0
        46 022525   200075 756100                    STQ     NEXT$,,AUTO

     4028    27543    3         IF PRIME$ -> PRIME.TRIAD -> ETT.ID <= %LAST_REFERENCE_TRIAD

  27543 46 022526   000001 471500                    LDP1    1,,PR0
        46 022527   100000 220100                    LDX0    0,,PR1
        46 022530   000020 100003                    CMPX0   16,DU
        46 022531   022534 603000 46                 TRC     s:27543+6
        46 022532   000005 100003                    CMPX0   5,DU
        46 022533   022536 601000 46                 TNZ     s:27547
        46 022534   000115 100003                    CMPX0   77,DU
        46 022535   022716 601000 46                 TNZ     s:27619

     4029    27544    3             AND PRIME$ -> PRIME.TRIAD -> ETT.ID ~= %SSOP OR
     4030    27545    3                 PRIME$ -> PRIME.TRIAD -> ETT.ID = %CVT THEN
     4031    27546    4           DO;

     4032    27547    4             CALL Z8AU$TYPE_DESCRIPTOR (PRIME$ -> PRIME.TRIAD, TYPE_DESC);

  27547 46 022536   200110 633500                    EPPR3   TYPE_DESC,,AUTO
        46 022537   200303 453500                    STP3    ORG1+2,,AUTO
        46 022540   200276 236100                    LDQ     PRIME$,,AUTO
        46 022541   000001 036003                    ADLQ    1,DU
        46 022542   200302 756100                    STQ     ORG1+1,,AUTO
        46 022543   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 022544   000013 631400 47                 EPPR1   11
        46 022545   000000 701000 xent               TSX1    Z8AU$TYPE_DESCRIPTOR
        46 022546   000000 011000                    NOP     0

     4033    27548                  %FISH (TRIAD = PRIME$ -> PRIME.TRIAD, RTN = ST$$);

  27550 46 022547   200276 470500                    LDP0    PRIME$,,AUTO
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:684  
        46 022550   000001 236100                    LDQ     1,,PR0
        46 022551   200277 756100                    STQ     ST$$,,AUTO

  27551 46 022552   200277 471500                    LDP1    ST$$,,AUTO
        46 022553   100000 220100                    LDX0    0,,PR1
        46 022554   000751 100003                    CMPX0   489,DU
        46 022555   022565 603000 46                 TRC     CHECK_PRIME

  27552 46 022556   200277 470500                    LDP0    ST$$,,AUTO
        46 022557   000001 236100                    LDQ     1,,PR0
        46 022560   200277 756100                    STQ     ST$$,,AUTO

  27553 46 022561   200277 470500                    LDP0    ST$$,,AUTO
        46 022562   000000 220100                    LDX0    0,,PR0
        46 022563   000751 100003                    CMPX0   489,DU
        46 022564   022556 602000 46                 TNC     s:27552

     4034    27556    4   CHECK_PRIME:
     4035    27557    5               DO;

  27557 46 022565                       CHECK_PRIME  null
     4036    27558    5                 IF OPND$ -> VARIABLE.B.LINKAGE AND ST$$ -> VARIABLE.B.LINKAGE THEN

  27558 46 022565   200271 470500                    LDP0    @OPND$,,AUTO
        46 022566   000000 471500                    LDP1    0,,PR0
        46 022567   100003 236100                    LDQ     3,,PR1
        46 022570   000002 316003                    CANQ    2,DU
        46 022571   022652 600000 46                 TZE     s:27610
        46 022572   200277 473500                    LDP3    ST$$,,AUTO
        46 022573   300003 236100                    LDQ     3,,PR3
        46 022574   000002 316003                    CANQ    2,DU
        46 022575   022652 600000 46                 TZE     s:27610

     4037    27559    6                   DO;

     4038    27560    6                     QLT$ = ST$$ -> VARIABLE.QLT$;

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:685  
  27560 46 022576   300007 236100                    LDQ     7,,PR3
        46 022577   000000 756000 37                 STQ     QLT$

     4039    27561    7                     DO WHILE QLT$ -> QLT.LEVEL_NO > 1;

  27561 46 022600   000000 471400 37                 LDP1    QLT$
        46 022601   100000 236100                    LDQ     0,,PR1
        46 022602   000777 376007                    ANQ     511,DL
        46 022603   000002 116007                    CMPQ    2,DL
        46 022604   022615 602000 46                 TNC     s:27566

     4040    27562    7                       QLT$ = QLT$ -> QLT.FATHER;

  27562 46 022605   000000 470400 37                 LDP0    QLT$
        46 022606   000001 236100                    LDQ     1,,PR0
        46 022607   000000 756000 37                 STQ     QLT$

     4041    27563    7                     END; /* BASE_LTS pointer is in level 01 ST item */

  27563 46 022610   000000 470400 37                 LDP0    QLT$
        46 022611   000000 236100                    LDQ     0,,PR0
        46 022612   000777 376007                    ANQ     511,DL
        46 022613   000002 116007                    CMPQ    2,DL
        46 022614   022605 603000 46                 TRC     s:27562

     4042    27564                          %GET_LTS (@ID = %BASE_LTS, @ST$ = QLT$ -> QLT.ST$, @RETURN$ =
             27564                              LTS$$);

  27566 46 022615   000000 470400 37                 LDP0    QLT$
        46 022616   000004 471500                    LDP1    4,,PR0
        46 022617   100005 236100                    LDQ     5,,PR1
        46 022620   000005 116000 47                 CMPQ    5
        46 022621   022631 600000 46                 TZE     s:27600
        46 022622   100005 473500                    LDP3    5,,PR1
        46 022623   300000 220100                    LDX0    0,,PR3
        46 022624   001105 100003                    CMPX0   581,DU
        46 022625   022631 601000 46                 TNZ     s:27600
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:686  

  27594 46 022626   300010 236100                    LDQ     8,,PR3
        46 022627   200300 756100                    STQ     LTS$$,,AUTO

  27598 46 022630   022643 710000 46                 TRA     s:27607

  27600 46 022631   000005 116000 47                 CMPQ    5
        46 022632   022641 600000 46                 TZE     s:27604
        46 022633   100005 473500                    LDP3    5,,PR1
        46 022634   300000 220100                    LDX0    0,,PR3
        46 022635   001066 100003                    CMPX0   566,DU
        46 022636   022641 601000 46                 TNZ     s:27604

  27602 46 022637   200300 756100                    STQ     LTS$$,,AUTO
        46 022640   022643 710000 46                 TRA     s:27607

  27604 46 022641   000005 236000 47                 LDQ     5
        46 022642   200300 756100                    STQ     LTS$$,,AUTO

     4043    27607    6                     IF BASE_LTS$ -> BASE_LTS.SEQ# ~= LTS$$ -> BASE_LTS.SEQ# THEN

  27607 46 022643   200274 473500                    LDP3    @BASE_LTS$,,AUTO
        46 022644   300000 474500                    LDP4    0,,PR3
        46 022645   200300 475500                    LDP5    LTS$$,,AUTO
        46 022646   400003 236100                    LDQ     3,,PR4
        46 022647   500003 116100                    CMPQ    3,,PR5
        46 022650   022716 601000 46                 TNZ     s:27619

     4044    27608    6                       EXIT CHECK_PRIME;
     4045    27609    6                   END;

  27609 46 022651   022665 710000 46                 TRA     s:27614

     4046    27610    5                ELSE IF OPND$ -> VARIABLE.B.LINKAGE OR ST$$ -> VARIABLE.B.LINKAGE THEN

  27610 46 022652   100003 236100                    LDQ     3,,PR1
        46 022653   000002 316003                    CANQ    2,DU
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:687  
        46 022654   022716 601000 46                 TNZ     s:27619
        46 022655   200277 473500                    LDP3    ST$$,,AUTO
        46 022656   300003 236100                    LDQ     3,,PR3
        46 022657   000002 316003                    CANQ    2,DU
        46 022660   022716 601000 46                 TNZ     s:27619

     4047    27611    5                   EXIT CHECK_PRIME;
     4048    27612    5                 ELSE IF OPND$ -> VARIABLE.COUNT ~= ST$$ -> VARIABLE.COUNT THEN

  27612 46 022661   100000 236100                    LDQ     0,,PR1
        46 022662   300000 676100                    ERQ     0,,PR3
        46 022663   000777 376007                    ANQ     511,DL
        46 022664   022716 601000 46                 TNZ     s:27619

     4049    27613    5                   EXIT CHECK_PRIME;
     4050    27614    5                 ORG1 = TYPE_DESC.DESC.SA * 8 + TYPE_DESC.DESC.NDSC.CN;

  27614 46 022665   200111 236100                    LDQ     TYPE_DESC+1,,AUTO
        46 022666   000017 772000                    QRL     15
        46 022667   000007 376007                    ANQ     7,DL
        46 022670   200302 756100                    STQ     ORG1+1,,AUTO
        46 022671   200111 236100                    LDQ     TYPE_DESC+1,,AUTO
        46 022672   777777 376003                    ANQ     -1,DU
        46 022673   000017 772000                    QRL     15
        46 022674   200302 036100                    ADLQ    ORG1+1,,AUTO
        46 022675   200301 756100                    STQ     ORG1,,AUTO

     4051    27615    5                 IF ORG1 >= ORG AND ORG1 < ORG + LEN THEN

  27615 46 022676   200273 470500                    LDP0    @ORG,,AUTO
        46 022677   000000 116100                    CMPQ    0,,PR0
        46 022700   022716 602000 46                 TNC     s:27619
        46 022701   200272 471500                    LDP1    @LEN,,AUTO
        46 022702   000000 236100                    LDQ     0,,PR0
        46 022703   100000 036100                    ADLQ    0,,PR1
        46 022704   200301 116100                    CMPQ    ORG1,,AUTO
        46 022705   022716 602000 46                 TNC     s:27619
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:688  
        46 022706   022716 600000 46                 TZE     s:27619

     4052    27616    5                   CALL Z8HU$POOL_PRIME (PRIME$ -> PRIME.TRIAD);

  27616 46 022707   200276 236100                    LDQ     PRIME$,,AUTO
        46 022710   000001 036003                    ADLQ    1,DU
        46 022711   200302 756100                    STQ     ORG1+1,,AUTO
        46 022712   200302 630500                    EPPR0   ORG1+1,,AUTO
        46 022713   000000 631400 47                 EPPR1   0
        46 022714   000000 701000 xent               TSX1    Z8HU$POOL_PRIME
        46 022715   000000 011000                    NOP     0

     4053    27617    5               END; /* CHECK_PRIME */

     4054    27618    4             END;

     4055    27619    3         PRIME$ = NEXT$;                                      /*#42937*/

  27619 46 022716   200075 236100                    LDQ     NEXT$,,AUTO
        46 022717   200276 756100                    STQ     PRIME$,,AUTO

     4056    27620    3       END; /* WHILE PRIME$ ~= ADDR (NIL) */

  27620 46 022720   000005 116000 47                 CMPQ    5
        46 022721   022523 601000 46                 TNZ     s:27542

     4057    27621    2   END FREE_REG_IF_NEED;

  27621 46 022722   200270 221300                    LDX1  ! @STRING$,,AUTO
        46 022723   000001 702211                    TSX2  ! 1,X1

     4058    27622
     4059    27623    1   END Z8HC$SPECIAL_CASES;

  27623 46 022724   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:689  
--  Include file information  --

   Z8A_NOP_OPTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LIBRARY.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_QLT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_OBJ.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8H_OPCODES.:Z8A6TOU  is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DESC.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8H_TEMP.:Z8A6TOU  is referenced.
   Z8H_PASSES.:Z8A6TOU  is referenced.
   Z8H_CODE.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8H_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8H_RAT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8H_DEP.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8H_SUPPORT.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
   Z8H_PCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8HC$SPECIAL_CASES.
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:690  

 **** Variables and constants ****

  ****  Section 000 LblCom ITERATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ITERATION

  ****  Section 001 LblCom SUPP_DATA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC              1 SUPP_DATA

  ****  Section 003 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 004 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILL_

  ****  Section 005 LblCom ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:691  
  ****  Section 006 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HEAD_ETT$

  ****  Section 007 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 008 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ETT_

  ****  Section 009 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 010 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ST_

  ****  Section 011 LblCom DEP

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:692  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC(1728)  r     1 DEP

  ****  Section 012 LblCom RAT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 RAT(0:27)

  ****  Section 013 LblCom NUMBER_OF_PRIMES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 NUMBER_OF_PRIMES

  ****  Section 014 LblCom NUMBER_OF_TEMPS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 NUMBER_OF_TEMPS

  ****  Section 015 LblCom NUMBER_OF_REFS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 NUMBER_OF_REFS

  ****  Section 016 LblCom GENERATING_PTRS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:693  

     0-0-0/b BIT               1 GENERATING_PTRS

  ****  Section 017 LblCom USE_PROC_RETURN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 USE_PROC_RETURN

  ****  Section 018 LblCom CURRENT_SCOPE$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_SCOPE$

  ****  Section 019 LblCom HEAD_REF$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 HEAD_REF$

  ****  Section 020 LblCom HEAD_TEMP$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_TEMP$

  ****  Section 021 LblCom CONST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CONST$
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:694  

  ****  Section 022 LblCom HEAD_PRIMES$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_PRIMES$

  ****  Section 023 LblCom CUR_LOOP_LEVEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 CUR_LOOP_LEVEL

  ****  Section 024 LblCom PEPD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 PEPD(0:1)

  ****  Section 025  Data  Z8HC$SPECIAL_CASES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w BIT (6)     r     1 BCD_BUFFER(0:5)
     3-0-0/w SBIN        r     1 BITS_IN_BUFFER             4-0-0/w SBIN        r     1 BUFFER
     4-0-0/w CHAR(4)     r     1 CHAR_BUFFER                1-0-0/w PTR         r     1 CONSTANT$
     7-0-0/w PTR         r     1 DML_IA$                    5-0-0/w PTR         r     1 FLUSH_BLK$
     0-0-0/b STRC        r     1 MOD_KEY
    11-0-0/w UBIN        r     1 MVPP_VEC(0:21)
     6-0-0/w SBIN        r     1 OLD_SA                    10-0-0/b BIT         r     1 POOL_LOP_ARGP
     2-0-0/w SBIN        r     1 TARGET

  ****  Section 026 LblCom CURRENT_BLOCK$
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:695  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 CURRENT_BLOCK$

  ****  Section 027 LblCom ROOT_PROC_BLOCK$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ROOT_PROC_BLOCK$

  ****  Section 028 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 MKCN

  ****  Section 029 LblCom OBJ$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 OBJ$

  ****  Section 030 LblCom PAGING_OBJ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w BIT         r     1 PAGING_OBJ

  ****  Section 031 LblCom OBJ_PAGE_COUNT

  ****  Scalars and arrays  ****
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:696  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 OBJ_PAGE_COUNT

  ****  Section 032 LblCom OBJ_FINISHED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w BIT               1 OBJ_FINISHED

  ****  Section 033 LblCom OBJ_SEG_SIZE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 OBJ_SEG_SIZE

  ****  Section 034 LblCom OBJ_TOP_NEW_SEG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 OBJ_TOP_NEW_SEG

  ****  Section 035 LblCom OBJ_LAST_REGULAR_PAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 OBJ_LAST_REGULAR_PAGE

  ****  Section 036 LblCom OBJ_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:697  
     0-0-0/w STRC(180)   r     1 OBJ_

  ****  Section 037 LblCom QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 QLT$

  ****  Section 038 LblCom PREV_01_QLT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 PREV_01_QLT$

  ****  Section 039 LblCom QLT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 QLT_

  ****  Section 040 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 041 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 LTS_

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:698  
  ****  Section 042 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 043 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ILS_

  ****  Section 044 RoData Z8HC$SPECIAL_CASES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/w UBIN        r     1 BINARY_VALUE_OF_NIL
    13-0-0/w UBIN        r     1 BINARY_VALUE_OF_NIL_EPTR
    13-0-0/w EPTR        r     1 NIL_EPTR                  13-0-0/w PTR         r     1 NIL_EPTR$
     0-0-0/w SBIN        r     1 TAGS(0:8)                 12-0-0/w PTR         r     1 VALUE_OF_NIL
    11-0-0/w PTR         r     1 ZERO_PTR$                 11-0-0/w SBIN        r     1 ZERO_WORD

  ****  Section 045 LblCom MVPP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 MVPP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:699  
   274-0-0/w PTR         r     1 @BASE_LTS$               265-0-0/w PTR         r     1 @BUFFER_SA
     5-0-0/w PTR         r     1 @CASE_PASS               267-0-0/w PTR         r     1 @CONSTANT$
   272-0-0/w PTR         r     1 @LEN                     272-0-0/w PTR         r     1 @LENGTH
   271-0-0/w PTR         r     1 @OFFSET                  271-0-0/w PTR         r     1 @OPND$
   273-0-0/w PTR         r     1 @ORG                       4-0-0/w PTR         r     1 @PCOM
     3-0-0/w PTR         r     1 @PILL                    263-0-0/w PTR         r     1 @PILL
   275-0-0/w PTR         r     1 @REGISTER                270-0-0/w PTR         r     1 @STRING$
   263-0-0/w PTR         r     1 @TARGET_LENGTH           263-0-0/w PTR         r     1 @TARGET_LENGTH
   263-0-0/w PTR         r     1 @TRIAD                    11-0-0/b BIT               1 AORQ
   120-0-0/w PTR         r     1 ARGLIST$                 254-0-0/w PTR               1 ARGP_LOP$
   246-0-0/w UBIN        r     1 AVOID_DEFLAB              *0-0-0/w PTR         r     1 BASE_LTS$
   141-0-0/w SBIN(18)    r     1 BOTTOM_HALF              125-0-0/w SBIN        r     1 BOUNDS
    *0-0-0/w PTR         r     1 BUFFER_SA                 *0-0-0/w SBIN        r     1 CASE_PASS
    51-0-0/w UBIN        r     1 CN                        *0-0-0/w PTR         r     1 CONSTANT$
   252-0-0/w CHAR        r     1 CURRENCY_SIGN            242-0-0/w SBIN        r     1 CURRENT_SA
   245-0-0/w PTR         r     1 DEF$                      40-0-0/b BIT               1 DEFER
    13-0-0/w STRC(180)         1 DEFER_BUFFER(0:3)
    37-0-0/w SBIN              1 DEFER_BUFFER_IDX          43-0-0/w STRC              1 DESC
   253-0-0/w PTR               1 DEST_PROC$               251-0-0/w PTR         r     1 EVAL$
   122-0-0/w PTR         r     1 GLIST$                   243-0-0/w PTR         r     1 GO_EXPR$
    65-0-0/w SBIN        r     1 I                        273-0-0/w SBIN        r     1 I
   263-0-0/w SBIN        r     1 I                        263-0-0/w SBIN        r     1 I
    12-0-0/b STRC        r     1 INST_WORD                114-0-0/w SBIN              1 ITERS
    66-0-0/w SBIN        r     1 J                         67-0-0/w SBIN        r     1 K
    10-0-0/w UBIN              1 LAST_FREED                 7-0-0/w UBIN              1 LAST_USED
   126-0-0/w SBIN        r     1 LDAQ_OFFSET               *0-0-0/w UBIN        r     1 LEN
    50-0-0/w SBIN        r     1 LENGTH                    *0-0-0/w SBIN        r     1 LENGTH
   132-0-0/w SBIN        r     1 LENGTH_IN_WORDS           77-0-0/w SBIN        r     1 LOP_LEN
   101-0-0/w PTR         r     1 LOP_REF$                 130-0-0/w BIT (2)     r     1 LOP_SIGN
   261-0-0/w PTR         r     1 LOWER$                   255-0-0/w PTR         r     1 LTS$$
   300-0-0/w PTR         r     1 LTS$$
   142-0-0/w SBIN        r     1 MVN_BUFFER(0:63)
   127-0-0/w SBIN        r     1 MVN_OFFSET                53-0-0/w STRC(324)         1 NAME
    75-0-0/w PTR         r     1 NEXT$                    117-0-0/w PTR         r     1 NODE$
    73-0-0/w UBIN        r     1 NODE_ID                  121-0-0/w SBIN        r     1 NUMBER_OF_ARGS
   267-0-0/w UBIN        r     1 N_OPNDS                  135-0-0/w SBIN              1 OFFSET
    *0-0-0/w SBIN        r     1 OFFSET                    41-0-0/w PTR               1 OLD_CURRENT_BLOCK$
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:700  
    *0-0-0/w PTR         r     1 OPND$                    250-0-0/w PTR               1 OPTCONST$
   247-0-0/w UBIN        r     1 OPTWRD                    *0-0-0/w UBIN        r     1 ORG
   301-0-0/w UBIN        r     1 ORG1                      64-0-0/w PTR         r     1 P$
   264-0-0/w PTR         r     1 P$                       266-0-0/w PTR         r     1 P$
   257-0-0/w PTR         r     1 P2$                       *0-0-0/w STRC(1872)  r     1 PCOM
    *0-0-0/w STRC(1872)        1 PCOM_                     *0-0-0/w PTR         r     1 PILL
    *0-0-0/w PTR         r     1 PILL                      76-0-0/w PTR         r     1 PRIME$
   276-0-0/w PTR         r     1 PRIME$                   265-0-0/w PTR         r     1 REC$
   116-0-0/w PTR         r     1 REF$                       6-0-0/w UBIN        r     1 REGID
    74-0-0/w UBIN        r     1 REGISTER                  *0-0-0/w UBIN        r     1 REGISTER
   115-0-0/w SBIN              1 REMAIN                   100-0-0/w SBIN        r     1 ROP_LEN
   102-0-0/w PTR         r     1 ROP_REF$                 131-0-0/w BIT (2)     r     1 ROP_SIGN
    52-0-0/w UBIN        r     1 SA                        47-0-0/w SBIN        r     1 SCALE
    42-0-0/w SBIN              1 SEG_NO#                  264-0-0/w PTR         r     1 SEND$
   244-0-0/w PTR         r     1 SENDING$                  44-0-0/w BIT (2)     r     1 SIGN
   137-0-0/w SBIN        r     1 SOURCE
   103-0-0/w PTR         r     1 SSOP_SIZ_BUFFER(0:3)
   107-0-0/w SBIN        r     1 SSOP_SIZ_IDX             256-0-0/w PTR         r     1 ST$$
   277-0-0/w PTR         r     1 ST$$                     133-0-0/w PTR         r     1 STRING$
    *0-0-0/w PTR         r     1 STRING$                   46-0-0/w BIT (2)     r     1 TA
   134-0-0/w PTR         r     1 TARGET$                  140-0-0/w SBIN        r     1 TARGET_LENGTH
    *0-0-0/w SBIN        r     1 TARGET_LENGTH             *0-0-0/w SBIN        r     1 TARGET_LENGTH
   124-0-0/w PTR         r     1 TEMP$                     70-0-0/c CHAR(12)    r     1 TEMP_CHAR
    45-0-0/w BIT         r     1 TN                       136-0-0/w SBIN        r     1 TOTAL_MOVED
    *0-0-0/w PTR         r     1 TRIAD                    110-0-0/w STRC(144)   r     1 TYPE_DESC
   260-0-0/w PTR         r     1 UPPER$                   123-0-0/w SBIN        r     1 WORDS_FOR_TEMP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM                     0-0-0/w UBIN              1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
     0-0-0/w UBIN              1 LTS_STEP(0:37)
     0-0-0/w UBIN              1 OBJ_STEP(0:4)

PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:701  
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(144)         1 ALTER_LTS                  0-0-0/w STRC(3672)        1 ALT_KEY
     0-0-0/w STRC(36864) r     1 ARGLIST                    0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(180)   r     1 ARRAY_PRESET_LTS           0-0-0/w STRC(288)   r     1 BASE_LTS
     0-0-0/b BIT (6)     r     1 BCD$CHARS(0:63)
     0-0-0/w STRC(108)         1 BINARY_ILL                 0-0-0/w STRC(396)   r     1 BLOCK
     0-0-0/w STRC(144)         1 BRANCH_ILL                 0-0-0/w STRC(144)         1 BT
     0-0-0/w STRC(216)   r     1 CCOSU                      0-0-0/w STRC(396)         1 CD
     0-0-0/w STRC(288)         1 CD_LTS                     0-0-0/w CHAR(4096)  r     1 CHARS
     0-0-0/w STRC(396)         1 CLASS                      0-0-0/w STRC(108)         1 CODED_MOVE
     0-0-0/w STRC(396)         1 CONDITION                  0-0-0/w STRC(396)   r     1 CONST
     0-0-0/w STRC(72)          1 CONT                       0-0-0/w STRC(540)         1 CONTROL_NAME_LTS
     0-0-0/w STRC(1872)        1 COPY_FILE                  0-0-0/w STRC(396)         1 DB
     0-0-0/w STRC(396)         1 DCB_                       0-0-0/w STRC(144)         1 DEFLB
     0-0-0/w STRC(108)         1 DEPENDING_SIZE             0-0-0/w STRC(5472)        1 DIMS
     0-0-0/w STRC(396)         1 DML_ITEM                   0-0-0/w STRC(216)         1 DML_REC
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)   r     1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)   r     1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)        1 FILE_LTS                   0-0-0/w STRC(144)   r     1 GO
     0-0-0/w STRC(180)   r     1 ILL                        0-0-0/w STRC              1 ILL_NO_OPS
     0-0-0/w STRC(180)   r     1 ILS                        0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(396)         1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
     0-0-0/w STRC(396)   r     1 LABEL                      0-0-0/w STRC(36864) r     1 LCNST
     0-0-0/w STRC(108)   r     1 LINOI                      0-0-0/w STRC(72)    r     1 LONG
     0-0-0/w STRC        r     1 LTS                        0-0-0/w STRC(360)   r     1 LTSS
     0-0-0/w STRC(36936) r     1 LTS_PTR_ARRAY              0-0-0N  NULL        r     1 M$UC
     0-0-0/w STRC(72)          1 MFILL                      0-0-0/w STRC(396)         1 MNEMONIC
     0-0-0/w STRC(180)   r     1 MULTI_GO                   0-0-0/w STRC(180)         1 MVEAL
     0-0-0/w STRC(108)   r     1 MVFIL                      0-0-0/w STRC(72)          1 MVIIS
PL6.E3A0      #001=Z8HC$SPECIAL_CASES File=Z8HC.:Z8A6TSI                         TUE 08/26/97 07:51 Page:702  
     0-0-0/w STRC(144)         1 NEL                        0-0-0/w STRC        r     1 NOP
     0-0-0/w STRC        r     1 OBJ                        0-0-0/w STRC(72)    r     1 OBJ_LAB
     0-0-0/w STRC(108)   r     1 OBJ_LINE                   0-0-0/w STRC(72)    r     1 OBJ_ORG
     0-0-0/w STRC(72)    r     1 OBJ_SCOPE                  0-0-0/w STRC(144)   r     1 OBJ_WORD
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(144)         1 OPN
     0-0-0/w STRC(180)   r     1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)   r     1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)   r     1 PINC                       0-0-0/w STRC(144)   r     1 PREOFF
     0-0-0/w STRC(108)   r     1 PRESET                     0-0-0/w STRC(144)   r     1 PRIME
     0-0-0/w STRC(396)   r     1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)   r     1 PROC_SUPP                  0-0-0/w STRC(144)   r     1 P_A_PRESET
     0-0-0/w STRC(144)   r     1 P_P_PRESET                 0-0-0/w STRC(216)   r     1 QLT
     0-0-0/w STRC(396)         1 RD                         0-0-0/w STRC(216)   r     1 REF
     0-0-0/w STRC(144)         1 REMEM                      0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(396)   r     1 SCALAR
     0-0-0/w STRC(144)   r     1 SCOPE                      0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(216)   r     1 SEARCH_                    0-0-0/w STRC(396)         1 SECTION
     0-0-0/w STRC(396)   r     1 SEGMENT                    0-0-0/w STRC(360)         1 SEGMENT_LTS
     0-0-0/w STRC(396)   r     1 ST                         0-0-0/w STRC(72)          1 STP2
     0-0-0/w STRC(36900) r     1 STRING                     0-0-0/w STRC(252)         1 SUM_LTS
     0-0-0/w STRC(396)         1 SWITCH                     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR
     0-0-0/w STRC(396)   r     1 SYMDEF_                    0-0-0/w STRC(396)         1 SYMREF_
     0-0-0/w STRC(396)   r     1 TEMP                       0-0-0/w STRC(144)   r     1 TRINARY_ILL
     0-0-0/w STRC(72)          1 UNARY_ILL                  0-0-0/d STRC(612)         1 USE
     0-0-0/w STRC(216)   r     1 USER_CALL                  0-0-0/w STRC(252)         1 USE_SUPP
     0-0-0/w STRC(108)         1 VAL                        0-0-0/w STRC(108)         1 VAL_END
     0-0-0/w STRC(396)   r     1 VARIABLE                   0-0-0/w STRC(72)          1 WHEN


   Procedure Z8HC$SPECIAL_CASES requires 9685 words for executable code.
   Procedure Z8HC$SPECIAL_CASES requires 218 words of local(AUTO) storage.

    No errors detected in file Z8HC.:Z8A6TSI    .
