VERSION E05

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:1    
        1        1        /*M* Disk Volume Initialization Main Program */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR */
        8        8        /**/
        9        9        IVV$VOLINIT: PROC;
       10       10        /**/
       11       11        /* INCLUDE FILES */
       12       12        /**/
       13       13        %INCLUDE FM$GRAN;
       14       82        %INCLUDE IV$MACROS;
       15      252        %INCLUDE IV_SUBS_C;
       16      315        %INCLUDE NI$TABLES;
       17      531        %INCLUDE CP_6;
       18     6090        %INCLUDE B_ERRORS_C;
       19     7217        %INCLUDE XU_MACRO_C;
       20    10323        %INCLUDE XU_SUBS_C;
       21    10415        /**/
       22    10416        /* SUBSTITUTIONS */
       23    10417        /**/
       24    10418        %SUB NULL="ADDR(NIL)";
       25    10419        /**/
       26    10420        /* Queue-Manipulation Macros */
       27    10421        /**/
       28    10422    1   DCL L#$ PTR BASED;
       29    10423        %MACRO ENQUEUE (P#=NIL,Q#=NIL);
       30    10424         DO INHIBIT; IF Q#=NULL THEN P#.FL$=ADDR(P#);ELSE DO;P#.FL$=Q#->L#$;Q#->L#$=ADDR(P#)
             10424        ;END;Q#=ADDR(P#);END;
       31    10425        %MEND;
       32    10426        /**/
       33    10427        %MACRO DEQUEUE (P#=NIL,Q#=NIL);
       34    10428         DO INHIBIT; P#=Q#->L#$;IF Q#=P# THEN Q#=NULL;ELSE Q#->L#$=P#->L#$;P#->L#$=NULL;END;
       35    10429        %MEND;
       36    10430        /**/
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:2    
       37    10431        /* EXTERNAL REFERENCES */
       38    10432        /**/
       39    10433    1   DCL IVO$BATCH ENTRY ALTRET;
       40    10434    1   DCL IVO$CLEANUP ENTRY ALTRET;
       41    10435    1   DCL IVO$CONT ENTRY (1) ALTRET;
       42    10436    1   DCL IVO$FINDDVT ENTRY (2) ALTRET;
       43    10437    1   DCL IVO$FORMAT ENTRY (1) ALTRET;
       44    10438    1   DCL IVO$FREE ENTRY (1) ALTRET;
       45    10439    1   DCL IVO$GET ENTRY (2) ALTRET;
       46    10440    1   DCL IVO$GETCMD ENTRY(3) ALTRET;
       47    10441    1   DCL IVO$INIT ENTRY (2) ALTRET;
       48    10442    1   DCL IVO$KEYIN ENTRY (1) ALTRET;
       49    10443    1   DCL IVO$PRINT ENTRY (2) ALTRET;
       50    10444    1   DCL IVO$QUEIO ENTRY(1) ALTRET;
       51    10445    1   DCL IVO$READ ENTRY ALTRET;
       52    10446    1   DCL IVO$READ_VID ENTRY (1) ALTRET;
       53    10447    1   DCL IVO$SETPC ENTRY (1) ALTRET;
       54    10448    1   DCL IVO$SWIN ENTRY (1) ALTRET;
       55    10449    1   DCL IVO$SWOUT ENTRY (1) ALTRET;
       56    10450    1   DCL IVO$WAIT ENTRY(1) ALTRET;
       57    10451    1   DCL IVO$VERIFY_FMT ENTRY(1) ALTRET;
       58    10452    1   DCL IVO$WRITE_VID ENTRY (1) ALTRET;
       59    10453    1   DCL IVO$RELDCB ENTRY (1) ALTRET;
       60    10454    1   DCL IV_SYNTAX SBIN SYMREF;
       61    10455    1   DCL IVV$BINDEC ENTRY (4);
       62    10456    1   DCL IVV$ERROR ENTRY (3);
       63    10457    1   DCL DCWBUILD ENTRY (3);
       64    10458    1   DCL IVV$NEXT ENTRY (2) ALTRET;
       65    10459    1   DCL IVV$FMTPAC ENTRY (2) ALTRET;
       66    10460    1   DCL IVZ$CKSUM ENTRY (1) ALTRET;
       67    10461    1   DCL X$PARSE ENTRY (1) ALTRET;
       68    10462        /**/
       69    10463        /* DATA STRUCTURES */
       70    10464        /**/
       71    10465    1   DCL CMDBUF CHAR(1) BASED;
       72    10466        %NI$DVT(NAME=DVT,STCLASS="BASED(DVT$)");
       73    10473        %IV$FMT(NAME=FMT,STCLASS="BASED(FMT$)");
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:3    
       74    10529        %IV$FMT(NAME=ELT,STCLASS="BASED(ELT$)");
       75    10585    1   DCL 1 GVID BASED(VID$) ALIGNED,         /* GCOS VID */
       76    10586    1         2 KEY BIT(36) ALIGNED,            /* PACK KEY */
       77    10587    1         2 * SBIN,
       78    10588    1         2 NUMB SBIN,                      /* PACK NUMBER */
       79    10589    1         2 *(0:124) SBIN,
       80    10590    1         2 OKEY BIT(36) ALIGNED,           /* OLD PACK KEY */
       81    10591    1         2 *(0:1) SBIN,
       82    10592    1         2 ONUMB SBIN;                     /* OLD PACK NUMBER */
       83    10593                %PARSE$OUT;
       84    10638                %PARSE$SYM;
       85    10676        %FM$VID(FM$VID=VID,BASED="BASED(VID$)");
       86    10682        %IV$VIP(NAME=VIP,STCLASS="BASED(VI$)");
       87    10746    1   DCL B$TCB$ PTR SYMREF;
       88    10747        %B$TCB;
       89    10750        %B$ALT;
       90    10758        /**/
       91    10759        /* STATIC DATA */
       92    10760        /**/
       93    10761    1   DCL IV_IO$ PTR SYMREF;
       94    10762        /**/
       95    10763        /* CONSTANTS */
       96    10764        /**/
       97    10765    1   DCL 1 CMD_PROMPT,
       98    10766    1         2 CNT SBIN,
       99    10767    1         2 MSG CHAR(20);
      100    10768    1   DCL B_VERSION CHAR(1) SYMREF;
      101    10769    1   DCL 1 B$VERSIONB BASED,
      102    10770    1         2 C_ UBIN BYTE CALIGNED,
      103    10771    1         2 T_ CHAR(B$VERSIONB.C_) CALIGNED;
      104    10772    1   DCL 1 DTT_PROMPT CONSTANT,
      105    10773    1         2 * SBIN INIT(SIZEC(DTT_PROMPT.MSG)),
      106    10774    1         2 MSG CHAR(0) INIT('AEnter DTT: ');
      107    10775    1   DCL 1 OKREQ CONSTANT,
      108    10776    1         2 * SBIN INIT(SIZEC(OKREQ.MSG)),
      109    10777    1         2 MSG CHAR(0) INIT('@Ok to change VSN   ');
      110    10778    1   DCL 1 STATUS CONSTANT,
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:4    
      111    10779    1         2 * SBIN INIT(SIZEC(STATUS.MSG)),
      112    10780    1         2 MSG CHAR(0) INIT('ADP00 VSN:000000 at CCCC.HH  ');
      113    10781        /**/
      114    10782        /* AUTO STACK */
      115    10783        /**/
      116    10784    1   DCL BLK$ PTR;
      117    10785    1   DCL BB BIT(36);
      118    10786    1   DCL CC SBIN;
      119    10787    1   DCL CC1 SBIN ALIGNED AUTO ;
      120    10788    1   DCL CC2 SBIN ALIGNED AUTO ;
      121    10789    1   DCL DEVID CHAR(4) ALIGNED;
      122    10790    1   DCL DTTX SBIN;
      123    10791    1   DCL DVT$ PTR;
      124    10792    1   DCL FMT$ PTR;
      125    10793    1   DCL FOUNDF BIT(1);
      126    10794    1   DCL DTT_FOUND BIT(1);
      127    10795    1   DCL HH SBIN;
      128    10796    1   DCL HH2 SBIN ALIGNED AUTO ;
      129    10797    1   DCL ERROR_CNT SBIN;
      130    10798    1   DCL I SBIN;
      131    10799    1   DCL J SBIN;
      132    10800    1   DCL K SBIN;
      133    10801    1   DCL LTRACK SBIN;
      134    10802    1   DCL NHW SBIN;
      135    10803    1   DCL NW SBIN;
      136    10804    1   DCL OPT$ PTR;
      137    10805    1   DCL 1 OUT ALIGNED,
      138    10806    1         2 LEN SBIN,
      139    10807    1         2 MSG CHAR(80);
      140    10808        %P$PCB(NAME=PCB);
      141    11009        %P_PCB (NAME=CONSTANT_PCB,STCLASS=CONSTANT);
      142    11208                                           /* Storage structure for MSU050X header */
      143    11209    1   DCL HDR5$ PTR;
      144    11210    1   DCL DATA$ PTR;
      145    11211        %IV$HDR(NAME=CF,STCLASS="BASED(HDR5$)");
      146    11239    1   DCL 1 LOG(0:3071) BASED(DATA$) UNAL,
      147    11240    1         2 CYL UBIN(16) UNAL,
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:5    
      148    11241    1         2 HD UBIN(8) UNAL,
      149    11242    1         2 POS UBIN(16) UNAL,
      150    11243    1         2 LTH UBIN(8) UNAL;
      151    11244    1   DCL LOG_BIT (0:16383) REDEF LOG BIT(9) CALIGNED;
      152    11245
      153    11246        /**/
      154    11247        /* SUBSTITUTIONS
      155    11248        %EQU FORMAT='17'O;                       DISK FORMAT TRACK COMMAND
      156    11249        %EQU WRCMP='33'O;                        DISK WRITE & COMPARE COMMAND
      157    11250        %EQU DP_TDSEEK512='35'O;                 DISK SEEK OF 512 FORMAT COMMAND
      158    11251        %EQU RDHEADER='27'O;                     READ TRACK HEADER COMMAND */
      159    11252        %EQU RDBIN='25'O;                       /* READ ELT DATA IN BINA COMMAND */
      160    11253    1   DCL IVO$READ_ELT ENTRY (1) ALTRET;
      161    11254    1   DCL ELT$ PTR;
      162    11255
      163    11256    1   DCL TRACK UBIN(18);
      164    11257    1   DCL 1 TR REDEF TRACK ALIGNED,
      165    11258    1         2 CYL UBIN(10) UNAL,              /* CYLINDER NUMBER */
      166    11259    1         2 CY REDEF CYL,
      167    11260    1           3 UPR UBIN(2) UNAL,
      168    11261    1           3 LWR UBIN(8) UNAL,
      169    11262    1         2 X UBIN(2) UNAL,
      170    11263    1         2 HD UBIN(6) UNAL;                /* HEAD NUMBER */
      171    11264    1   DCL 1 CYL  ALIGNED,
      172    11265    1         2 * BIT(26) UNAL,
      173    11266    1         2 N UBIN(10) UNAL;
      174    11267    1   DCL 1 HEAD  ALIGNED,
      175    11268    1         2 * BIT(28) UNAL,
      176    11269    1         2 N UBIN(8) UNAL;
      177    11270    1   DCL TRANGE BIT(36);
      178    11271    1   DCL VI$ PTR;
      179    11272    1   DCL VID$ PTR;
      180    11273    1   DCL VIP$ PTR;
      181    11274    1   DCL IV_ONLINE BIT(1) ALIGNED SYMREF READONLY;
      182    11275    1   DCL IV_PROMPT CHAR(1) CONSTANT INIT('*');
      183    11276        %EJECT;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:6    
      184    11277    1           PCB=CONSTANT_PCB;
      185    11278    1           CALL IVO$INIT(PCB);
      186    11279    1           PCB.ROOT$=ADDR(IV_SYNTAX);
      187    11280    1           PCB.U$$=ENTADDR(IVO$CONT);
      188    11281    1           PCB.CMPRS='1'B;
      189    11282    1           PCB.COMMENT.LEAD=' "';
      190    11283    1           PCB.COMMENT.TRAIL=' "';
      191    11284    1           VIP$=NULL;
      192    11285    1           IV_IO$=ADDR(NIL);
      193    11286    1           CALL CONCAT(CMD_PROMPT.MSG,'AVOLINIT ',ADDR(B_VERSION)->B$VERSIONB.T_,
             11286                    ' Here');
      194    11287    1           CMD_PROMPT.CNT = SIZEC(CMD_PROMPT.MSG);
      195    11288    1           CALL IVO$PRINT(CMD_PROMPT,'0'B);
      196    11289    1   NEXT_CMD:
      197    11290    1           CALL IVO$SETPC(IV_PROMPT);
      198    11291    1           IF IV_ONLINE THEN
      199    11292    1              CALL IVO$GETCMD (IV_SYNTAX, BLK$, VECTOR(IV_PROMPT)) ALTRET (
             11292                       WAIT_NEXT_CMD);
      200    11293    1           ELSE
      201    11294    2           DO;
      202    11295    2              CALL IVO$READ ALTRET(WAIT_NEXT_CMD);
      203    11296    2              CALL X$PARSE(PCB) ALTRET(PARSE_ERR);
      204    11297    2              BLK$=PCB.OUT$;
      205    11298    2              END;
      206    11299    2           DO CASE (OUT$BLK.CODE);
      207    11300    2            CASE(#NULL);                   /* [.B] .END */
      208    11301    2              GOTO NEXT_CMD;
      209    11302    2            CASE(#VOLINIT);                /* VOLINIT COMMAND */
      210    11303    2              VI$=VIP$;
      211    11304    3              IF VI$~=NULL THEN DO;
      212    11305    3   NEXT_DP:
      213    11306    3                 VI$=VIP.FL$;
      214    11307    4                 IF VIP.DEVID=OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT THEN DO;
      215    11308    4                    CALL IVV$ERROR(VIP.DEVID,13);
      216    11309    4                    GOTO WAIT_NEXT_CMD;
      217    11310    4                    END;
      218    11311    3                 IF VI$~=VIP$ THEN GOTO NEXT_DP;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:7    
      219    11312    3                 END/* IF VI$ */;
      220    11313    2              CALL IVO$GET(VI$,SIZEW(VIP)) ALTRET(NO_SPACE);
      221    11314    2              VIP='0'B;
      222    11315    2              VIP.FL$=NULL;
      223    11316    2              VIP.DEVID=OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      224    11317    2              CALL DECBIN(OUT$BLK.SUBLK$(1)->OUT$SYM.COUNT,VIP.VSN);
      225    11318    2              VIP.VID$=NULL;
      226    11319    2              VIP.FMT$=NULL;
      227    11320    2              VIP.ELT$=NULL;
      228    11321    2              CALL IVO$FINDDVT(VIP,DVT$) ALTRET(NO_DISK);
      229    11322    2              VIP.DVT$=DVT$;
      230    11323    2              VIP.NSECTS=DVT.SPT;
      231    11324    2              VIP.NHEADS=DVT.CYLSIZE/VIP.NSECTS;
      232    11325    2              VIP.NCYLS=(DVT.PACKSIZE*DVT.GRANSIZE+DVT.GRANSIZE-1)/DVT.CYLSIZE;
      233    11326    2              VIP.T@DCYL=DVT.T@DCYL;
      234    11327    2              VIP.GRANSIZE=DVT.GRANSIZE;
      235    11328    2              VIP.FORMAT='0'B;
      236    11329    2              VIP.VERIFY='0'B;
      237    11330    2              VIP.ALT = '0'B;
      238    11331    2              VIP.SCRATCH='1'B;
      239    11332    3              DO SELECT (VIP.MODEL);
      240    11333    3                 SELECT ('MSU8082 ', 'MSU8092 ', 'MSU3380 ', 'MSU3382 ',
      241    11334    3                   'MSU3390 ', 'MSU3392 ', 'MSU3391 ', 'MSU3393 ',
      242    11335    3                   'MSU3381 ', 'MSU3383 ');
      243    11336    3                 VIP.DTT = #NEW;           /* SET DEFAULTS FOR FIPS & MDS DISCS */
      244    11337    3                 VIP.TEST = '0'B;
      245    11338    3                 SELECT (ELSE);
      246    11339    3              VIP.DTT = #OLD;
      247    11340    3              VIP.TEST = '1'B;
      248    11341    3                 END;
      249    11342    3           DO I=2 TO OUT$BLK.NSUBLKS-1;
      250    11343    3              OPT$=OUT$BLK.SUBLK$(I);
      251    11344    4              DO CASE (OPT$->OUT$BLK.CODE);
      252    11345    4               CASE(#DTT);                 /* DTT PARAMETER */
      253    11346    4                 VIP.DTT=OPT$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
      254    11347    4               CASE(#FORMAT);              /* FORMAT OPTION */
      255    11348    4                 VIP.FORMAT='1'B;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:8    
      256    11349    4               CASE(#NOFORMAT);            /* NOFORMAT OPTION */
      257    11350    4                 VIP.FORMAT='0'B;
      258    11351    4               CASE(#VERIFY);              /* VERIFY OPTION */
      259    11352    4                 VIP.VERIFY='1'B;
      260    11353    4               CASE(#NOVERIFY);            /* NOVERIFY OPTION */
      261    11354    4                 VIP.VERIFY='0'B;
      262    11355    4               CASE(#TEST);                /* TEST OPTION */
      263    11356    4                 VIP.TEST='1'B;
      264    11357    4               CASE(#NOTEST);              /* NOTEST OPTION */
      265    11358    4                 VIP.TEST='0'B;
      266    11359    4               CASE(#SCRATCH);             /* SCRATCH OPTION */
      267    11360    4                 VIP.SCRATCH='1'B;
      268    11361    4               CASE(#NOSCRATCH);           /* NOSCRATCH OPTION */
      269    11362    4                 VIP.SCRATCH='0'B;
      270    11363    4               CASE(#ALT);                 /* ALT OPTION */
      271    11364    4                 VIP.ALT = '1'B;
      272    11365    4               CASE(#NOALT);               /* NOALT OPTION */
      273    11366    4                 VIP.ALT = '0'B;
      274    11367    4               CASE(#NEWDTS);              /* NEWDTS OPTION */
      275    11368    4                 VIP.NEWDTS='1'B;
      276    11369    4               CASE(#RANGE);               /* RANGE PARAMETER */
      277    11370    5                 IF VIP.NRANGES>=64 THEN DO;
      278    11371    5                    CALL IVV$ERROR(VIP.DEVID,5);
      279    11372    5                    GOTO DEL_VI;
      280    11373    5                    END;
      281    11374    4                 CALL DECBIN(OPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT,CC,HH);
      282    11375    5                 IF HH<0 THEN DO;
      283    11376    5                    TRACK=CC*DVT.GRANSIZE/VIP.NSECTS;
      284    11377    5                    TRACK=(TRACK/VIP.NHEADS)*(IV_CYLM-VIP.NHEADS)+TRACK;
      285    11378    6                    IF TRACK>=(VIP.T@DCYL+1)*IV_CYLM THEN DO;
      286    11379    6   CCHH_ERR:
      287    11380    6                       CALL IVV$ERROR(VIP.DEVID,3);
      288    11381    6                       GOTO DEL_VI;
      289    11382    6                       END;
      290    11383    5                    VIP.RANGE.FTRACK(VIP.NRANGES)=TRACK;
      291    11384    5                    END/* IF HH */;
      292    11385    5                 ELSE DO;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:9    
      293    11386    5                    IF CC>=(VIP.T@DCYL+1) OR HH>=VIP.NHEADS THEN GOTO CCHH_ERR;
      294    11387    5                    VIP.RANGE.FTRACK(VIP.NRANGES)=CC*IV_CYLM+HH;
      295    11388    5                    END;
      296    11389    4                 IF OPT$->OUT$BLK.NSUBLKS=2 THEN
      297    11390    4                    VIP.RANGE.LTRACK(VIP.NRANGES)=VIP.T@DCYL*IV_CYLM+VIP.NHEADS-1;
      298    11391    5                 ELSE DO;
      299    11392    5                    IF OPT$->OUT$BLK.NSUBLKS=3 THEN
      300    11393    5                       CALL DECBIN(OPT$->OUT$BLK.SUBLK$(2)->OUT$SYM.COUNT,CC,HH);
      301    11394    6                    IF HH<0 THEN DO;
      302    11395    6                       TRACK=((CC+1)*DVT.GRANSIZE-1)/VIP.NSECTS;
      303    11396    6                       TRACK=(TRACK/VIP.NHEADS)*(IV_CYLM-VIP.NHEADS)+TRACK;
      304    11397    6                       IF TRACK>=(VIP.T@DCYL+1)*IV_CYLM THEN GOTO CCHH_ERR;
      305    11398    6                       VIP.RANGE.LTRACK(VIP.NRANGES)=TRACK;
      306    11399    6                       END;
      307    11400    6                    ELSE DO;
      308    11401    6                       IF CC>VIP.T@DCYL OR HH>=VIP.NHEADS THEN GOTO CCHH_ERR;
      309    11402    6                       VIP.RANGE.LTRACK(VIP.NRANGES)=CC*IV_CYLM+HH;
      310    11403    6                       END;
      311    11404    5                    END/* IF OPT$->OUT$BLK.NSUBLKS=2 ELSE */;
      312    11405    4                 IF VIP.RANGE.LTRACK(VIP.NRANGES)<VIP.RANGE.FTRACK(VIP.NRANGES) THEN
             11405                          GOTO CCHH_ERR;
      313    11406    4                 VIP.NRANGES=VIP.NRANGES+1;
      314    11407    4               END/* CASE OPT$->OUT$BLK.CODE */;
      315    11408    3              END/* DO I */;
      316    11409    3           DO SELECT(VIP.MODEL);
      317    11410    3              SELECT ('MSU8082 ','MSU8092 ','MSU3380 ','MSU3382 ',
      318    11411    3                'MSU3390 ','MSU3392 ','MSU3391 ','MSU3393 ',
      319    11412    3                'MSU3381 ','MSU3383 ');
      320    11413    3              ERROR_CNT = 0;
      321    11414    4              IF VIP.DTT = #OLD OR VIP.DTT = #UPDATE THEN DO;
      322    11415    4                 CALL IVV$ERROR(VIP.DEVID,20); /* DTT=NEW MUST BE  SPECIFIED */
      323    11416    4                 ERROR_CNT = ERROR_CNT +1;
      324    11417    4                 END;
      325    11418    4              IF VIP.FORMAT = '1'B THEN DO;
      326    11419    4                 CALL IVV$ERROR(VIP.DEVID,21);
             11419                          /* FORMAT NOT ALLOWED FOR FIPS OR MDS DISCS */
      327    11420    4                 ERROR_CNT = ERROR_CNT +1;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:10   
      328    11421    4                 END;
      329    11422    4              IF VIP.VERIFY = '1'B THEN DO;
      330    11423    4                 CALL IVV$ERROR(VIP.DEVID,22);
             11423                          /* VERIFY NOT ALLOWED FOR FIPS OR MDS DISCS */
      331    11424    4                 ERROR_CNT = ERROR_CNT +1;
      332    11425    4                 END;
      333    11426    4              IF VIP.TEST = '1'B THEN DO;
      334    11427    4                 CALL IVV$ERROR(VIP.DEVID,23);
             11427                          /* TEST NOT ALLOWED FOR FIPS OR MDS DISCS */
      335    11428    4                 ERROR_CNT = ERROR_CNT +1;
      336    11429    4                 END;
      337    11430    4              IF VIP.SCRATCH = '0'B THEN DO;
      338    11431    4                 CALL IVV$ERROR(VIP.DEVID,24);
             11431                          /* SCRATCH MUST BE SPECIFIED FOR FIPS OR MDS DISCS */
      339    11432    4                 ERROR_CNT = ERROR_CNT +1;
      340    11433    4                 END;
      341    11434    4              IF VIP.NEWDTS = '1'B THEN DO;
      342    11435    4                 CALL IVV$ERROR(VIP.DEVID,25);
             11435                          /* NEWDTS NOT ALLOWED FOR FIPS OR MDS DISCS */
      343    11436    4                 ERROR_CNT = ERROR_CNT +1;
      344    11437    4                 END;
      345    11438    4              IF VIP.NRANGES > 0 THEN DO;
      346    11439    4                 CALL IVV$ERROR(VIP.DEVID,26);
             11439                          /*  RANGE SPECIFICAION NOT ALLOWED FOR FIPS OR MDS DISCS */
      347    11440    4                 ERROR_CNT = ERROR_CNT +1;
      348    11441    4                 END;
      349    11442    4              IF VIP.ALT = '1'B THEN DO;
      350    11443    4                 CALL IVV$ERROR(VIP.DEVID,36);
             11443                          /* ALT NOT ALLOWED  FOR FIPS OR MDS DISCS */
      351    11444    4                 ERROR_CNT = ERROR_CNT + 1;
      352    11445    4                 END;
      353    11446    3              IF ERROR_CNT > 0 THEN GOTO DEL_VI;
      354    11447    3              SELECT ('MSU0501 ','MSU0509 ');
      355    11448    4              IF VIP.FORMAT = '1'B THEN DO;
      356    11449    4                 CALL IVV$ERROR(VIP.DEVID,21); /* FORMAT NOT ALLOWED FOR 501 DISCS */
      357    11450    4                 GOTO NEXT_CMD;
      358    11451    4                 END;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:11   
      359    11452    4              IF VIP.ALT = '1'B AND VIP.FORMAT = '1'B THEN DO;
      360    11453    4                 CALL IVV$ERROR(VIP.DEVID,37);
      361    11454    4                 GOTO NEXT_CMD;
      362    11455    4                 END;
      363    11456    4              IF VIP.ALT = '1'B AND VIP.NEWDTS = '1'B THEN DO;
      364    11457    4                 CALL IVV$ERROR(VIP.DEVID,38);
      365    11458    4                 GOTO NEXT_CMD;
      366    11459    4                 END;
      367    11460    4              IF VIP.ALT = '1'B AND VIP.NRANGES > 0 THEN DO;
      368    11461    4                 CALL IVV$ERROR(VIP.DEVID,39);
      369    11462    4                 GOTO NEXT_CMD;
      370    11463    4                 END;
      371    11464    4              IF VIP.TEST = '0'B THEN DO;
      372    11465    4                 CALL IVV$ERROR(VIP.DEVID,35); /* NOTEST NOT ALLOWED FOR 501 DISCS */
      373    11466    4                 GOTO NEXT_CMD;
      374    11467    4                 END;
      375    11468    3              SELECT (ELSE);               /* 451 DISCS */
      376    11469    4           IF VIP.ALT = '1'B AND VIP.FORMAT = '1'B THEN DO;
      377    11470    4              CALL IVV$ERROR(VIP.DEVID,37);
      378    11471    4              GOTO NEXT_CMD;
      379    11472    4              END;
      380    11473    4           IF VIP.ALT = '1'B AND VIP.NEWDTS = '1'B THEN DO;
      381    11474    4              CALL IVV$ERROR(VIP.DEVID,38);
      382    11475    4              GOTO NEXT_CMD;
      383    11476    4              END;
      384    11477    4           IF VIP.ALT = '1'B AND VIP.NRANGES > 0 THEN DO;
      385    11478    4              CALL IVV$ERROR(VIP.DEVID,39);
      386    11479    4              GOTO NEXT_CMD;
      387    11480    4              END;
      388    11481    4           IF VIP.FORMAT='0'B AND VIP.TEST='0'B THEN DO;
      389    11482    4              CALL IVV$ERROR(,14);         /* PLS SPECIFY FORMAT OR TEST */
      390    11483    4              GOTO NEXT_CMD;
      391    11484    4              END;
      392    11485    3              END;                         /* DO SELECT (VIP.MODEL) */
      393    11486    2           CALL IVO$GET(VID$,1024) ALTRET(NO_SPACE_1);
      394    11487    2           VIP.VID$=VID$;
      395    11488    2           IF VIP.MODEL ~= 'MSU0451 ' THEN
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:12   
      396    11489    2              CALL IVO$VERIFY_FMT(VIP)
      397    11490    3              WHENALTRETURN DO;
      398    11491    3                 IF (IV_ONLINE AND
      399    11492    3                   (B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOSLOTS))
      400    11493    3                 THEN CALL IVV$ERROR(,27);
      401    11494    3                 IF (IV_ONLINE AND
      402    11495    3                   (B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOTAUTH))
      403    11496    3                 THEN CALL IVV$ERROR(,28);
      404    11497    3                 GOTO DEL_VI;
      405    11498    3                 END;
      406    11499    2           CALL IVO$READ_VID(VIP) ALTRET(BAD_VID);
      407    11500    3           IF VID.VSN~=VIP.VSN THEN DO;
      408    11501    3              CALL IVV$ERROR(VIP.DEVID,8,VID.VSN);
      409    11502    3              CALL IVO$BATCH ALTRET(DEL_VI);
      410    11503    3              CALL IVO$PRINT(OKREQ,'0'B);
      411    11504    3              PCB.TEXT$->CMDBUF='N';
      412    11505    3              CALL IVO$SETPC('?');
      413    11506    3              CALL IVO$READ;
      414    11507    3              IF PCB.TEXT$->CMDBUF~='Y' THEN GOTO DEL_VI;
      415    11508    3              VID.VSN=VIP.VSN;
      416    11509    3              END;
      417    11510    3           IF VIP.DTT<=#UPDATE THEN DO;
      418    11511    3              IF VID.ID~='CP6 ' THEN
      419    11512    4                 IF GVID.KEY='305206000000'O/*BCD'H-6000'*/ THEN DO;
      420    11513    4                    VID.ID='CP6 ';
      421    11514    4                    VID.INSTID='0'B;
      422    11515    4                    END;
      423    11516    4                 ELSE IF GVID.OKEY='272520200600'O/*BCD'GE  60'*/ THEN DO;
      424    11517    4                       VID.ID='CP6 ';
      425    11518    4                       VID.INSTID='0'B;
      426    11519    4                       VID.VSN=GVID.ONUMB;
      427    11520    4                       END;
      428    11521    3                    ELSE
      429    11522    3                       GOTO NEW_VID;
      430    11523    3              CALL IVZ$CKSUM(VID.DTT) ALTRET(NO_DTT);
      431    11524    3              DTTX=63;
      432    11525    3              CALL SORT_DTT;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:13   
      433    11526    4              DO WHILE ('0'B);
      434    11527    4   NO_DTT:
      435    11528    4                 DTTX=0;
      436    11529    4                 END;
      437    11530    3              CALL PRINT_DTT;
      438    11531    4              IF VIP.DTT=#UPDATE THEN DO;
      439    11532    5                 DO DTTX=0 TO 62;
      440    11533    5                    IF VID.DTT(DTTX)=BITBIN('777777'O) THEN GOTO DTT_END_FOUND;
      441    11534    5                    END;
      442    11535    4                 DTTX=63;
      443    11536    4   DTT_END_FOUND:
      444    11537    4                 END/* IF VIP.DTT=#UPDATE */;
      445    11538    3              END/* IF VIP.DTT<=#UPDATE */;
      446    11539    3           ELSE DO;
      447    11540    4              DO WHILE ('0'B);
      448    11541    4   BAD_VID:                                /* VID NOT RECOGNIZABLE */
      449    11542    5                 IF IV_ONLINE THEN DO;
      450    11543    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$TDNOPERM THEN
      451    11544    6                    DO;
      452    11545    6                       CALL IVV$ERROR (VIP.DEVID, 18); /* !NODIAG */
      453    11546    6                       GOTO DEL_VI;
      454    11547    6                       END;
      455    11548    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$BREAK THEN
      456    11549    6                    DO;
      457    11550    6                       CALL IVV$ERROR (VIP.DEVID, 19); /* BREAK */
      458    11551    6                       GOTO DEL_VI;
      459    11552    6                       END;
      460    11553    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOSLOTS THEN
      461    11554    6                    DO;
      462    11555    6                       CALL IVV$ERROR(,27); /* NO MORE DCB SLOTS */
      463    11556    6                       GOTO DEL_VI;
      464    11557    6                       END;
      465    11558    5                    END;
      466    11559    4                 CALL IVV$ERROR(VIP.DEVID,12);
      467    11560    4                 END;
      468    11561    3   NEW_VID:
      469    11562    3              VIP.DTT=#NEW;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:14   
      470    11563    3              VID='0'B;
      471    11564    3              VID.ID='CP6 ';
      472    11565    3              VID.INSTID='0'B;
      473    11566    3              VID.VSN=VIP.VSN;
      474    11567    3              VID.PSN=' ';
      475    11568    4              DO DTTX=0 TO 62;
      476    11569    4                 VID.DT(DTTX)='777777777777'O;
      477    11570    4                 END;
      478    11571    3              VID.DTT(63)=1;     /* IVZ$CKSUM WILL PUT IN CHECKSUM CORRECTLY  */
      479    11572    3              CALL IVZ$CKSUM(VID.DTT);
      480    11573    3              DTTX=0;
      481    11574    3              VIP.DTTCH='0'B;
      482    11575    3              END/* IF VIP.DTT>#UPDATE */;
      483    11576    3           DO SELECT (VIP.MODEL);
      484    11577    3              SELECT ('MSU8082 ', 'MSU8092 ', 'MSU3380 ' , 'MSU3382 ',
      485    11578    3                'MSU3390 ', 'MSU3392 ', 'MSU3391 ', 'MSU3393 ',
      486    11579    3                'MSU3381 ', 'MSU3383 ');
      487    11580    3              VIP.DONE = '1'B;
      488    11581                   %ENQUEUE(P#=VIP,Q#=VIP$);
      489    11584    3              GOTO WAIT_NEXT_CMD;
      490    11585    3              SELECT (ELSE);
      491    11586    3              END;
      492    11587    3           IF VIP.DTT>=#UPDATE THEN DO;
      493    11588    3              IF  VIP.ALT
      494    11589    4              THEN DO ;
      495    11590    5                 DO  SELECT ( VIP.MODEL ) ;
      496    11591
      497    11592    5                    SELECT ( 'MSU0451' ) ;
      498    11593    5                    CC1 = 811 ;
      499    11594    5                    CC2 = 813 ;
      500    11595    5                    HH2 = 18 ;
      501    11596
      502    11597    5                    SELECT ( 'MSU0501', 'MSU0509' ) ;
      503    11598    5                    CC1 = 840 ;
      504    11599    5                    CC2 = 840 ;
      505    11600    5                    HH2 = 39 ;
      506    11601    5                    END ;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:15   
      507    11602
      508    11603    5                 DO  CASE ( VIP.DTT ) ;
      509    11604
      510    11605    5                  CASE ( #UPDATE ) ;
      511    11606    6                    DO  CC = CC1 TO CC2 ;
      512    11607    7   HH_ALT_UPD:         DO  HH = 0 TO HH2 ;
      513    11608    7                          TRACK = CC * IV_CYLM + HH ;
      514    11609    8                          DO  I = 0 TO DTTX ;
      515    11610    8                             IF  VID.DTT(I) = TRACK
      516    11611    8                             THEN
      517    11612    8                                EXIT HH_ALT_UPD ;
      518    11613    8                             END ;
      519    11614    7                          IF  DTTX >= 63
      520    11615    7                          THEN
      521    11616    7                             GOTO DTT_OVERFLOW ;
      522    11617    7                          VID.DTT(DTTX) = TRACK ;
      523    11618    7                          DTTX = DTTX + 1 ;
      524    11619    7                          VIP.DTTCH = '1'B ;
      525    11620    7                          END HH_ALT_UPD ;
      526    11621    6                       END ;
      527    11622
      528    11623    5                  CASE ( #NEW ) ;
      529    11624    6                    DO  CC = CC1 TO CC2 ;
      530    11625    7                       DO  HH = 0 TO HH2 ;
      531    11626    7                          VID.DTT(DTTX) = CC * IV_CYLM + HH ;
      532    11627    7                          DTTX = DTTX + 1 ;
      533    11628    7                          IF  DTTX >= 63
      534    11629    7                          THEN
      535    11630    7                             GOTO DTT_OVERFLOW ;
      536    11631    7                          END ;
      537    11632    6                       END ;
      538    11633    5                    VIP.DTTCH = '1'B ;
      539    11634
      540    11635    5                  END ;
      541    11636    4                 END ;
      542    11637    3              CALL IVO$PRINT(DTT_PROMPT,'0'B);
      543    11638    3              CALL IVO$SETPC('^');
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:16   
      544    11639    4              DO WHILE ('0'B);
      545    11640    4   PARSE_ERR_1:                            /* PARSING ERROR ON DT */
      546    11641    4                 CALL IVV$ERROR(VIP.DEVID,1);
      547    11642    4                 END;
      548    11643    3   NEXT_DT:
      549    11644    3              CALL IVO$READ ALTRET(NEXT_DT);
      550    11645    3              CALL X$PARSE(PCB) ALTRET(PARSE_ERR_1);
      551    11646    3              BLK$=PCB.OUT$;
      552    11647    4              DO CASE (OUT$BLK.CODE);
      553    11648    4               CASE(#DT);                  /* DEFECTIVE TRACK SPECIFICATION */
      554    11649    4                 CALL DECBIN(OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT,CC,HH);
      555    11650    5                 IF DTTX>=63 THEN DO;
      556    11651    5   DTT_OVERFLOW:
      557    11652    5                    CALL IVV$ERROR(VIP.DEVID,6);
      558    11653    5                    GOTO NEXT_DT;
      559    11654    5                    END;
      560    11655    5                 IF VIP.NEWDTS AND VIP.NRANGES>=64 THEN DO;
      561    11656    5                    CALL IVV$ERROR(VIP.DEVID,5);
      562    11657    5                    GOTO DEL_VI;
      563    11658    5                    END;
      564    11659    5                 IF HH<0 THEN DO;
      565    11660    5                    TRACK=CC*DVT.GRANSIZE/VIP.NSECTS;
      566    11661    5                    TRACK=(TRACK/VIP.NHEADS)*(IV_CYLM-VIP.NHEADS)+TRACK;
      567    11662    5                    LTRACK=((CC+1)*DVT.GRANSIZE-1)/VIP.NSECTS;
      568    11663    5                    LTRACK=(LTRACK/VIP.NHEADS)*(IV_CYLM-VIP.NHEADS)+LTRACK;
      569    11664    6                    IF LTRACK>=VIP.NCYLS*IV_CYLM THEN DO;
      570    11665    6   DT_ERR:
      571    11666    6                       CALL IVV$ERROR(VIP.DEVID,3);
      572    11667    6                       GOTO NEXT_DT;
      573    11668    6                       END;
      574    11669    5                    VID.DTT(DTTX)=TRACK;
      575    11670    5                    IF VIP.NEWDTS THEN
      576    11671    5                       VIP.RANGE.FTRACK(VIP.NRANGES)=TRACK;
      577    11672    6                    IF LTRACK~=TRACK THEN DO;
      578    11673    6                       DTTX=DTTX+1;
      579    11674    6                       IF DTTX>=63 THEN GOTO DTT_OVERFLOW;
      580    11675    6                       VID.DTT(DTTX)=LTRACK;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:17   
      581    11676    6                       END;
      582    11677    5                    END/* IF HH */;
      583    11678    5                 ELSE DO;
      584    11679    5                    IF CC>=VIP.NCYLS OR HH>=VIP.NHEADS THEN GOTO DT_ERR;
      585    11680    5                    VID.DTT(DTTX)=CC*IV_CYLM+HH;
      586    11681    5                    IF VIP.NEWDTS THEN
      587    11682    5                       VIP.RANGE.FTRACK(VIP.NRANGES)=VID.DTT(DTTX);
      588    11683    5                    END;
      589    11684    5                 IF VIP.NEWDTS THEN DO;
      590    11685    5                    VIP.RANGE.LTRACK(VIP.NRANGES)=VID.DTT(DTTX);
      591    11686    5                    VIP.NRANGES=VIP.NRANGES+1;
      592    11687    5                    END;
      593    11688    4                 DTTX=DTTX+1;
      594    11689    4                 VIP.DTTCH='1'B;
      595    11690    4                 GOTO NEXT_DT;
      596    11691    4               CASE(#DTEND);               /* END OF DEFECTIVE TRACKS */
      597    11692    4                 CALL SORT_DTT;
      598    11693    4               CASE(ELSE);
      599    11694    4                 CALL IVV$ERROR(VIP.DEVID,7); /* MISSING DTEND */
      600    11695    4                 GOTO NEXT_DT;
      601    11696    4               END/* CASE OUT$BLK.CODE */;
      602    11697    3              END/* IF VIP.DTT */;
      603    11698    3           IF VIP.NRANGES=0 THEN DO;
      604    11699    3              VIP.NRANGES=1;
      605    11700    3              IF  VIP.MODEL = 'MSU0451'
      606    11701    3                AND VIP.ALT
      607    11702    4              THEN DO ;
      608    11703    4                 VIP.RANGE.LT.CYL(0) = 810 ;
      609    11704    4                 VIP.RANGE.LT.HD(0)  = 18 ;
      610    11705    4                 END ;
      611    11706    3              ELSE IF  VIP.MODEL = 'MSU0501'
      612    11707    3                   OR  VIP.MODEL = 'MSU0509'
      613    11708    4                 THEN DO ;
      614    11709    4                    IF VIP.ALT
      615    11710    5                    THEN DO ;
      616    11711    5                       VIP.RANGE.LT.CYL(0) = 839 ;
      617    11712    5                       VIP.RANGE.LT.HD(0) = 39 ;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:18   
      618    11713    5                       END ;
      619    11714    5                    ELSE DO ;
      620    11715    5                       VIP.RANGE.LT.CYL(0) = 842 ; /* 842.39 IS CE_DATA_PATTERN */
      621    11716    5                       VIP.RANGE.LT.HD(0) = 39 ;
      622    11717    5                       END ;
      623    11718    4                    END ;
      624    11719    4                 ELSE DO ;
      625    11720    4                    VIP.RANGE.LTRACK(0) = ( VIP.T@DCYL * IV_CYLM ) +
      626    11721    4                      VIP.NHEADS - 1 ;
      627    11722    4                    END ;
      628    11723    3              END;
      629    11724    3           DO I=0 TO VIP.NRANGES-1;
      630    11725    3              K=0;
      631    11726    3              TRACK=VIP.RANGE.FTRACK(I);
      632    11727    3              IF TR.CYL=840 AND TR.HD>=20 THEN GOTO ELT_WK;
      633    11728    4              DO J=I+1 TO VIP.NRANGES-1;
      634    11729    5                 IF TRACK>VIP.RANGE.FTRACK(J) THEN DO;
      635    11730    5                    K=J;
      636    11731    5                    TRACK=VIP.RANGE.FTRACK(J);
      637    11732    5                    END;
      638    11733    4                 END/* DO J */;
      639    11734    4              IF K~=0 THEN DO;
      640    11735    4                 TRANGE=VIP.RANGE(K);
      641    11736    4                 VIP.RANGE(K)=VIP.RANGE(I);
      642    11737    4                 VIP.RANGE(I)=TRANGE;
      643    11738    4                 END;
      644    11739    3              END/* DO I */;
      645    11740    3           DO I=0 TO VIP.NRANGES-2;
      646    11741    3              TRACK=VIP.RANGE.LTRACK(I);
      647    11742    3              TR.HD=MOD(TR.HD+1,VIP.NHEADS);
      648    11743    3              IF TR.HD=0 THEN TR.CYL=TR.CYL+1;
      649    11744    3              IF TR.CYL=840 AND TR.HD>=20 THEN GOTO ELT_WK;
      650    11745    4              IF TRACK>=VIP.RANGE.FTRACK(I+1) THEN DO;
      651    11746    4                 IF VIP.RANGE.LTRACK(I+1)>VIP.RANGE.LTRACK(I) THEN VIP.RANGE.LTRACK(I)=
             11746                          VIP.RANGE.LTRACK(I+1);
      652    11747    5                 DO J=I+1 TO VIP.NRANGES-2;
      653    11748    5                    VIP.RANGE(J)=VIP.RANGE(J+1);
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:19   
      654    11749    5                    END;
      655    11750    4                 VIP.NRANGES=VIP.NRANGES-1;
      656    11751    4                 I=I-1;
      657    11752    4                 END/* IF VIP. */;
      658    11753    3              END/* DO I */;
      659    11754    2           TRACK=VIP.RANGE.LTRACK(VIP.NRANGES-1);
      660    11755    3           IF TR.CYL=840 AND TR.HD>=20 THEN DO;
      661    11756    3   ELT_WK:    CALL IVV$ERROR(VIP.DEVID,16);
      662    11757    3              GOTO DEL_VI;
      663    11758    3              END;
      664    11759    2           CALL IVV$FMTPAC(VIP,FMT$);
      665    11760    2           NHW=SIZEW(FMT.HEADER)+BITBIN(DVT.GRANSIZE=2)*82;
      666    11761    2           NW=BITBIN(VIP.TEST)*VIP.NSECTS*DVT.SECSIZE;
      667    11762    2           VIP.FMT$=FMT$;
      668    11763    3           IF VIP.TEST THEN DO;
      669    11764    3              BB='525252525252'O;
      670    11765    4              DO I=NHW TO NW+NHW-1;
      671    11766    4                 FMT.DATA(I)=BB;
      672    11767    4                 BB=~BB;
      673    11768    4                 END;
      674    11769    3              END;
      675    11770    2           FMT.IDCW='177700700000'O;       /* FORMAT TRACK */
      676    11771    2           FMT.DCW=FMT.HEADER_DCW;
      677    11772    2           VIP.STEP=0;
      678    11773    3           DO SELECT(VIP.MODEL);
      679    11774    3              SELECT('MSU0509 ','MSU0501 ');
      680    11775    3              VIP.CTRACK=VIP.RANGE.FTRACK(0);
      681    11776    3              IF VIP.CTR.CYL=840 AND VIP.CTR.HD>=20 THEN GOTO ELT_WK;
      682    11777    3              CALL IVV$FMTPAC(VIP,ELT$)ALTRET(NO_SPACE_1);
      683    11778    3              VIP.ELT$=ELT$;
      684    11779    3              TR.CYL=840;TR.X=0;TR.HD=20;  /* CYL 840 HEAD 20 IN BINARY FORM */
      685    11780    3              CALL CONVMPC(ELT.SEEK.SECTOR); /* CONVERT CCCC.HH TO MPC FORMAT */
      686    11781    3              ELT.SEEK.Y='1'B;             /* ADD PHYSICAL ADDR MODE BIT */
      687    11782    3              HDR5$=PINCRW(ADDR(ELT.HEADER),6); /* 451 HDR SZ IS 6 */
      688    11783    3              DATA$=PINCRW(ADDR(ELT.HEADER),88); /* 50X HDR SZ IS 88 WORDS */
      689    11784    3              ELT.DCW=ELT.HEADER_DCW;CF='0'B;LOG_BIT='0'B;
      690    11785    3              VIP.LOGX=0;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:20   
      691    11786    3              FMT.SEEK.Y='1'B;             /* ADD PHYSICAL ADDR MODE BIT */
      692    11787
      693    11788    3              CALL IVV$NEXT(VIP,0) ALTRET(DISK_ERR);
      694    11789    3              SELECT(ELSE);
      695    11790    3           FMT.SEEK_IDCW='347700720000'O;
      696    11791    3           FMT.SEEK.SECTOR=( VIP.RANGE.FT.CYL(0)*VIP.NHEADS+
      697    11792    3             VIP.RANGE.FT.HD(0)  ) * VIP.NSECTS;
      698    11793    3           CALL IVV$NEXT(VIP,0) ALTRET(DISK_ERR);
      699    11794    3              END;
      700    11795                %ENQUEUE(P#=VIP,Q#=VIP$);
      701    11798    2            CASE(#STATUS);                 /* STATUS COMMAND */
      702    11799    2              OUT=STATUS;
      703    11800    2              VI$=VIP$;
      704    11801    3              IF VI$~=NULL THEN DO;
      705    11802    3   NEXT_STATUS:
      706    11803    3                 VI$=VIP.FL$;
      707    11804    3                 CALL INSERT(OUT.MSG,1,4,VIP.DEVID);
      708    11805    3                 CALL IVV$BINDEC(VIP.VSN,OUT.MSG,10,6);
      709    11806    4                 DO SELECT(VIP.MODEL);
      710    11807    4                    SELECT('MSU0501 ','MSU0509 ');
      711    11808    4                    CYL='0'B; HEAD='0'B;
      712    11809    4                    CYL.N=VIP.CTR.CYL;
      713    11810    4                    CALL IVV$BINDEC(CYL,OUT.MSG,20,4);
      714    11811    4                    HEAD.N=VIP.CTR.HD;
      715    11812    4                    CALL IVV$BINDEC(HEAD,OUT.MSG,25,2);
      716    11813    4                    SELECT(ELSE);
      717    11814    4                 TRACK=VIP.FMT$->FMT.SEEK.SECTOR/VIP.NSECTS;
      718    11815    4                 CALL IVV$BINDEC(TRACK/VIP.NHEADS,OUT.MSG,20,4);
      719    11816    4                 CALL IVV$BINDEC(MOD(TRACK,VIP.NHEADS),OUT.MSG,25,2);
      720    11817    4                    END;
      721    11818    3              CALL IVO$PRINT(OUT,'0'B);
      722    11819    3              IF VI$~=VIP$ THEN GOTO NEXT_STATUS;
      723    11820    3                 END;
      724    11821    2            CASE(#READ);                   /* READ COMMAND (OFF-LINE ONLY) */
      725    11822    2              DEVID=OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      726    11823    2              CALL IVO$SWIN(DEVID);
      727    11824    2            CASE(#PRINT);                  /* PRINT COMMAND (OFF-LINE ONLY) */
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:21   
      728    11825    2              DEVID=OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      729    11826    2              CALL IVO$SWOUT(DEVID);
      730    11827    2            CASE(#STOP);                   /* STOP COMMAND */
      731    11828    2              VI$=VIP$;
      732    11829    3              IF VI$~=NULL THEN DO;
      733    11830    3                 FOUNDF='0'B;
      734    11831    4   NEXT_STOP:    DO;
      735    11832    4                    VI$=VIP.FL$;
      736    11833    5                    IF OUT$BLK.NSUBLKS=0 OR VIP.DEVID=OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT
             11833                             THEN DO;
      737    11834    5                       VIP.STOP='1'B;
      738    11835    5                       FOUNDF='1'B;
      739    11836    5                       END;
      740    11837    4                    IF VI$~=VIP$ THEN GOTO NEXT_STOP;
      741    11838    4                    END NEXT_STOP;
      742    11839    3                 IF NOT FOUNDF THEN CALL IVV$ERROR(OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,2);
             11839                          /* SPEC'D DISK NOT IN VOLINIT */
      743    11840    3                 END/* IF VI$ */;
      744    11841    2            CASE(#END);                    /* END COMMAND */
      745    11842    2   WAITDONE:
      746    11843    2              CALL CHECKDONE;
      747    11844    3              IF VIP$~=NULL THEN DO;
      748    11845    3                 CALL IVO$WAIT('1'B) ALTRET(NEXT_CMD);
      749    11846    3                 GOTO WAITDONE;
      750    11847    3                 END;
      751    11848    2              CALL IVO$CLEANUP;       /* OFFLINE VOLINIT WONT RETURN FROM THIS */
      752    11849    2              RETURN;
      753    11850    2            CASE(#DELTA,#KEYIN);      /* DELTA, KEYIN COMMANDS (OFF-LINE ONLY) */
      754    11851    2              CALL IVO$KEYIN(BINBIT(OUT$BLK.CODE,36));
      755    11852    2            CASE(ELSE);                    /* DT, DTEND ARE ERRORS */
      756    11853    2              CALL IVV$ERROR(,0);
      757    11854    2            END/* CASE OUT$BLK.CODE */;
      758    11855    2           DO WHILE ('0'B);
      759    11856    2   PARSE_ERR:                              /* PARSING ERROR ON COMMAND */
      760    11857    2              CALL IVV$ERROR('    ',1);
      761    11858    2              END;
      762    11859    2           DO WHILE ('0'B);
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:22   
      763    11860    2   NO_DISK:                                /* DISK NOT FOUND */
      764    11861    2              CALL IVV$ERROR(VIP.DEVID,4);
      765    11862    3              DO WHILE ('0'B);
      766    11863    3   NO_SPACE_1:                             /* NO SPACE FOR VID */
      767    11864    3                 CALL IVV$ERROR(VIP.DEVID,9);
      768    11865    3                 END;
      769    11866    3              DO WHILE ('0'B);
      770    11867    3   DISK_ERR:                               /* DISK I/O ERROR */
      771    11868    3                 CALL IVV$ERROR(VIP.DEVID,10);
      772    11869    3                 END;
      773    11870    2   DEL_VI:                                 /* DELETE VOLINIT TABLE ENTRY */
      774    11871    2              IF VIP.FMT$~=NULL THEN
      775    11872    2                 CALL IVO$FREE(VIP.FMT$);
      776    11873    2              IF VIP.ELT$~=NULL THEN
      777    11874    2                 CALL IVO$FREE(VIP.ELT$);
      778    11875    2              IF VIP.VID$~=NULL THEN
      779    11876    2                 CALL IVO$FREE(VIP.VID$);
      780    11877    2              IF IV_ONLINE THEN
      781    11878    2                 CALL IVO$RELDCB(VIP);
      782    11879    2              CALL IVO$FREE(VI$);
      783    11880    2              END;
      784    11881    2           DO WHILE ('0'B);
      785    11882    2   NO_SPACE:                               /* NO SPACE FOR VIP */
      786    11883    2              CALL IVV$ERROR('    ',9);
      787    11884    2              END;
      788    11885    1   WAIT_NEXT_CMD:
      789    11886    1           CALL CHECKDONE;
      790    11887    1           IF VIP$=NULL THEN GOTO NEXT_CMD;
      791    11888    1           CALL IVO$BATCH ALTRET(NEXT_CMD);
      792    11889    1           CALL IVO$WAIT('1'B) ALTRET(NEXT_CMD);
      793    11890    1           GOTO WAIT_NEXT_CMD;
      794    11891        %EJECT;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:23   
      795    11892        /* CHECK FOR VOLINITS DONE */
      796    11893    1   CHECKDONE: PROC;
      797    11894        /**/
      798    11895        /* CONSTANT DATA */
      799    11896        /**/
      800    11897    2   DCL 1 DONE CONSTANT,
      801    11898    2         2 LEN SBIN,
      802    11899    2         2 MSG CHAR(0) INIT(
             11899             'AVOLINIT of VSN:000000 on DP00 stopped at CCCC.HH, DTT overflow, disk error. '
             11899                  );
      803    11900        /**/
      804    11901        /* AUTO STACK */
      805    11902        /**/
      806    11903    2   DCL PVI$ PTR;
      807    11904        /**/
      808    11905    3           DO WHILE(IV_IO$~=ADDR(NIL));
      809    11906    4              DO INHIBIT;
      810    11907    4                 VI$=IV_IO$;
      811    11908    4                 IV_IO$=VIP.IO$;
      812    11909    4                 END;
      813    11910    3              CALL IVO$QUEIO(VIP) ALTRET(QUE_ERR);
      814    11911    4              DO WHILE('0'B);
      815    11912    5   QUE_ERR:      IF IV_ONLINE THEN DO;
      816    11913    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$TDNOPERM THEN
      817    11914    6                    DO;
      818    11915    6                       CALL IVV$ERROR (VIP.DEVID, 18); /* !NODIAG */
      819    11916    6                       PVI$ = VI$;
      820    11917    6                       GOTO RELEASE_SPACE;
      821    11918    6                       END;
      822    11919    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$BREAK THEN
      823    11920    6                    DO;
      824    11921    6                       CALL IVV$ERROR (VIP.DEVID, 19); /* BREAK */
      825    11922    6                       PVI$ = VI$;
      826    11923    6                       GOTO RELEASE_SPACE;
      827    11924    6                       END;
      828    11925    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOSLOTS THEN
      829    11926    6                    DO;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:24   
      830    11927    6                       CALL IVV$ERROR(,27); /* NO MORE DCB SLOTS */
      831    11928    6                       PVI$ = VI$;
      832    11929    6                       GOTO RELEASE_SPACE;
      833    11930    6                       END;
      834    11931    5                    END;
      835    11932    4                 VIP.STOP='1'B;
      836    11933    4                 VIP.DONE='1'B;
      837    11934    4                 END;
      838    11935    3              END;
      839    11936    2           VI$=VIP$;
      840    11937    3           IF VI$~=NULL THEN DO;
      841    11938    3   CHECK_NEXT:
      842    11939    3              PVI$=VI$;
      843    11940    3   CHECK_NEXT_1:
      844    11941    3              VI$=VIP.FL$;
      845    11942    4              IF VIP.DONE THEN DO;
      846    11943    4                 OUT=DONE;
      847    11944    4                 CALL IVV$BINDEC(VIP.VSN,OUT.MSG,16,6);
      848    11945    4                 CALL INSERT(OUT.MSG,26,4,VIP.DEVID);
      849    11946    5                 IF VIP.STOP THEN DO;
      850    11947    5                    CALL INSERT(OUT.MSG,31,,'stopped at CCCC.HH');
      851    11948    5                    OUT.LEN=49;
      852    11949    6                    DO SELECT(VIP.MODEL);
      853    11950    6                       SELECT('MSU0501 ','MSU0509 ');
      854    11951    6                       CYL='0'B; HEAD='0'B;
      855    11952    6                       CYL.N=VIP.CTR.CYL;
      856    11953    6                       CALL IVV$BINDEC(CYL,OUT.MSG,42,4);
      857    11954    6                       HEAD.N=VIP.CTR.HD;
      858    11955    6                       CALL IVV$BINDEC(HEAD,OUT.MSG,47,2);
      859    11956    6                       SELECT(ELSE);
      860    11957    6                    TRACK=VIP.FMT$->FMT.SEEK.SECTOR/VIP.NSECTS;
      861    11958    6                    CALL IVV$BINDEC(TRACK/VIP.NHEADS,OUT.MSG,42,4);
      862    11959    6                    CALL IVV$BINDEC(MOD(TRACK,VIP.NHEADS),OUT.MSG,47,2);
      863    11960    6                       END;
      864    11961    5                    END/* IF VIP.STOP */;
      865    11962    5                 ELSE DO;
      866    11963    5                    CALL INSERT(OUT.MSG,31,,'completed');
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:25   
      867    11964    5                    OUT.LEN=40;
      868    11965    5                    END;
      869    11966    5                 IF VIP.DTTOVF THEN DO;
      870    11967    5                    CALL INSERT(OUT.MSG,OUT.LEN,,', DTT overflow');
      871    11968    5                    OUT.LEN=OUT.LEN+16;
      872    11969    5                    END;
      873    11970    4                 VID$=VIP.VID$;
      874    11971    5                 IF VIP.DTTCH THEN DO;
      875    11972    5                    DTTX=63;
      876    11973    5                    CALL SORT_DTT;
      877    11974    5                    CALL PRINT_DTT;
      878    11975    5                    END;
      879    11976    4                 VID.SYSDIRDA=VIP.DVT$->DVT.PACKSIZE-1;
      880    11977    5                 DO I=0 TO 62;
      881    11978    6                    IF VID.DTT(I)~=BITBIN('777777'O) THEN DO;
      882    11979    6                       VID.DGT.FGRAN(I)=((VID.DT.CYL(I)*VIP.NHEADS+VID.DT.HD(I))*VIP.
             11979                                NSECTS)/VIP.GRANSIZE;
      883    11980    6                       VID.DGT.LGRAN(I)=((VID.DT.CYL(I)*VIP.NHEADS+VID.DT.HD(I)+1)*VIP.
             11980                                NSECTS-1)/VIP.GRANSIZE;
      884    11981    6                       END;
      885    11982    5                    ELSE VID.DGT(I)='0'B;
      886    11983    5                    END/* DO I */;
      887    11984    4                 VID.DGT(63)='0'B;
      888    11985    4                 VID.MIRROR = '0'B;
      889    11986    5                 IF VIP.SCRATCH THEN DO;
      890    11987    5                    VID.VOLCNT=0;
      891    11988    6                    DO I = 0 TO 25;
      892    11989    6                       VID.SECTSTRT(I) = 0;
      893    11990    6                       END;
      894    11991    5                    END;
      895    11992    4                 CALL IVO$WRITE_VID(VIP) ALTRET(DISK_ERR);
      896    11993    4                 CALL IVO$PRINT(OUT,'0'B);
      897    11994    4                 GOTO RELEASE_SPACE;
      898    11995        /**/
      899    11996    4   DISK_ERR:
      900    11997    4                 IF (IV_ONLINE AND (B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOSLOTS))
      901    11998    5                 THEN DO;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:26   
      902    11999    5                    CALL IVV$ERROR(,27);   /* NO MORE DCB SLOTS */
      903    12000    5                    GOTO RELEASE_SPACE;
      904    12001    5                    END;
      905    12002    4                 IF (IV_ONLINE AND (B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE =  %E$NOTAUTH))
      906    12003    4                 THEN CALL IVV$ERROR(,28); /* INSUFFICIENT PRIV */
      907    12004    4                 ELSE CALL IVV$ERROR(VIP.DEVID, 10);
      908    12005    4   RELEASE_SPACE:
      909    12006    4                 IF VIP.VID$~=NULL THEN
      910    12007    4                    CALL IVO$FREE(VIP.VID$);
      911    12008    4                 IF VIP.ELT$~=NULL THEN
      912    12009    4                    CALL IVO$FREE(VIP.ELT$);
      913    12010    4                 IF VIP.FMT$~=NULL THEN
      914    12011    4                    CALL IVO$FREE(VIP.FMT$);
      915    12012    4                 IF IV_ONLINE THEN
      916    12013    4                    CALL IVO$RELDCB(VIP);
      917    12014                      %DEQUEUE(P#=VI$,Q#=PVI$);
      918    12017    4                 CALL IVO$FREE(VI$);
      919    12018    5                 IF VI$~=VIP$ THEN DO;
      920    12019    5                    VI$=PVI$;
      921    12020    5                    GOTO CHECK_NEXT_1;
      922    12021    5                    END;
      923    12022    4                 VIP$=PVI$;
      924    12023    4                 END/* IF VIP.DONE */;
      925    12024    3              ELSE IF VI$~=VIP$ THEN GOTO CHECK_NEXT;
      926    12025    3              END/* IF VI$ */;
      927    12026    2           RETURN;
      928    12027    2   END CHECKDONE;
      929    12028        %EJECT;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:27   
      930    12029        /* CONVERT DECIMAL STRING TO BINARY */
      931    12030        /**/
      932    12031    1   DECBIN: PROC (D,V1,V2);
      933    12032        /**/
      934    12033        /* PARAMETERS */
      935    12034        /**/
      936    12035    2   DCL 1 D ALIGNED,
      937    12036    2         2 CT UBIN(9) UNAL,
      938    12037    2         2 T CHAR(D.CT) UNAL;
      939    12038    2   DCL V1 SBIN;
      940    12039    2   DCL V2 SBIN;
      941    12040        /**/
      942    12041        /* AUTO STACK */
      943    12042        /**/
      944    12043    2   DCL I SBIN;
      945    12044    2   DCL CH CHAR(1);
      946    12045        /**/
      947    12046        /* PROCEDURE */
      948    12047        /**/
      949    12048    2           I=0;
      950    12049    2           CALL CONVERT(V1);
      951    12050    3           IF ADDR(V2)~=NULL THEN DO;
      952    12051    3              V2=-1;
      953    12052    4              IF I<D.CT AND CH='.' THEN DO;
      954    12053    4                 I=I+1;
      955    12054    4                 CALL CONVERT(V2);
      956    12055    4                 END;
      957    12056    3              END/* IF ADDR(V2) */;
      958    12057    2           RETURN;
      959    12058        /**/
      960    12059    2   CONVERT: PROC (V);
      961    12060    3   DCL V SBIN;
      962    12061        /**/
      963    12062    3           V=0;
      964    12063    4           DO I=I TO D.CT-1;
      965    12064    4              CH=SUBSTR(D.T,I,1);
      966    12065    4              IF CH<'0' OR CH>'9' THEN RETURN;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:28   
      967    12066    4              V=10*V+ASCBIN(CH)-ASCBIN('0');
      968    12067    4              END;
      969    12068    3           I=D.CT;
      970    12069    3           RETURN;
      971    12070    3   END CONVERT;
      972    12071    2   END DECBIN;
      973    12072        %EJECT;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:29   
      974    12073        /* PRINT DEFECTIVE TRACK TABLE */
      975    12074        /**/
      976    12075    1   PRINT_DTT: PROC;
      977    12076        /**/
      978    12077        /* CONSTANTS */
      979    12078        /**/
      980    12079    2   DCL 1 DTTHDR CONSTANT,
      981    12080    2         2 * SBIN INIT(SIZEC(DTTHDR.MSG)),
      982    12081    2         2 MSG CHAR(0) INIT('A Defective track table ');
      983    12082    2   DCL 1 DTTLINE CONSTANT,
      984    12083    2         2 * SBIN INIT(SIZEC(DTTLINE.MSG)),
      985    12084    2         2 MSG CHAR(0) INIT('A     CCCC.HH    GGGGG-GGGGG ');
      986    12085    2   DCL 1 OUTX ALIGNED,
      987    12086    2         2 LEN SBIN,
      988    12087    2         2 MSG CHAR(80);
      989    12088        /**/
      990    12089    2           CALL IVO$PRINT(DTTHDR,'0'B);
      991    12090    2           OUTX=DTTLINE;
      992    12091    3           DO I=0 TO DTTX-1;
      993    12092    4              IF VID.DTT(I)~=BITBIN('777777'O) THEN DO;
      994    12093    4                 CALL IVV$BINDEC(BINBIT(VID.DT.CYL(I),36),OUTX.MSG,6,4);
      995    12094    4                 CALL IVV$BINDEC(BINBIT(VID.DT.HD(I),36),OUTX.MSG,11,2);
      996    12095    4                 CALL IVV$BINDEC(((VID.DT.CYL(I)*VIP.NHEADS+VID.DT.HD(I))*VIP.NSECTS)/
             12095                          VIP.GRANSIZE,OUTX.MSG,16,6);
      997    12096    4                 CALL IVV$BINDEC(((VID.DT.CYL(I)*VIP.NHEADS+VID.DT.HD(I)+1)*VIP.NSECTS-
             12096                          1)/VIP.GRANSIZE,OUTX.MSG,23,6);
      998    12097    4                 CALL IVO$PRINT(OUTX,'0'B);
      999    12098    4                 END;
     1000    12099    3              END/* DO I */;
     1001    12100    2           VIP.DTTCH='0'B;
     1002    12101    2           RETURN;
     1003    12102    2   END PRINT_DTT;
     1004    12103        %EJECT;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:30   
     1005    12104        /* SORT DEFECTIVE TRACK TABLE */
     1006    12105        /**/
     1007    12106    1   SORT_DTT: PROC;
     1008    12107    3           DO I=0 TO DTTX-1;
     1009    12108    3              K=0;
     1010    12109    3              CC=VID.DTT(I);
     1011    12110    4              DO J=I+1 TO DTTX-1;
     1012    12111    5                 IF CC>VID.DTT(J) THEN DO;
     1013    12112    5                    K=J;
     1014    12113    5                    CC=VID.DTT(J);
     1015    12114    5                    END;
     1016    12115    4                 END/* DO J */;
     1017    12116    4              IF K~=0 THEN DO;
     1018    12117    4                 VID.DTT(K)=VID.DTT(I);
     1019    12118    4                 VID.DTT(I)=CC;
     1020    12119    4                 VIP.DTTCH='1'B;
     1021    12120    4                 END;
     1022    12121    3              END/* DO I */;
     1023    12122    3           DO I=1 TO DTTX-1;
     1024    12123    4              IF VID.DTT(I)=VID.DTT(I-1) THEN DO;
     1025    12124    5                 DO J=I+1 TO DTTX-1;
     1026    12125    5                    VID.DTT(J-1)=VID.DTT(J);
     1027    12126    5                    END;
     1028    12127    4                 I=I-1;
     1029    12128    4                 DTTX=DTTX-1;
     1030    12129    4                 VIP.DTTCH='1'B;
     1031    12130    4                 END/* IF VID.DTT(I) */;
     1032    12131    3              END/* DO I */;
     1033    12132    3           DO I=DTTX TO 62;
     1034    12133    3              VID.DT(I)='777777777777'O;
     1035    12134    3              END;
     1036    12135    2           CALL IVZ$CKSUM(VID.DTT);
     1037    12136    2           RETURN;
     1038    12137    2   END SORT_DTT;
     1039    12138
     1040    12139
     1041    12140    1   SORT_LOG: PROC;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:31   
     1042    12141    2   DCL CC UBIN ALIGNED;
     1043    12142    2   DCL HH UBIN ALIGNED;
     1044    12143    2   DCL POS UBIN ALIGNED;
     1045    12144    2   DCL K SBIN ALIGNED;
     1046    12145    2   DCL ITEM BIT(48) DALIGNED;
     1047    12146
     1048    12147    3           DO I=0 TO 3071;
     1049    12148    3              IF LOG(I)='0'B THEN RETURN;
     1050    12149    3              K=0;
     1051    12150    3              CC=LOG.CYL(I); HH=LOG.HD(I); POS=LOG.POS(I);
     1052    12151    4              DO J=I+1 TO 3071;
     1053    12152    4                 IF LOG(J)='0'B THEN RETURN;
     1054    12153    5                 IF CC>LOG.CYL(J) THEN DO;
     1055    12154    5                    K=J;
     1056    12155    5                    CC=LOG.CYL(J); ITEM=LOG(I);
     1057    12156    5                    END;
     1058    12157    5                 ELSE DO;
     1059    12158    6                    IF CC=LOG.CYL(J) THEN DO;
     1060    12159    7                       IF HH>LOG.HD(J) THEN DO;
     1061    12160    7                          K=J;
     1062    12161    7                          HH=LOG.HD(J); ITEM=LOG(I);
     1063    12162    7                          END;
     1064    12163    7                       ELSE DO;
     1065    12164    8                          IF HH=LOG.HD(J) THEN DO;
     1066    12165    9                             IF POS>LOG.POS(J) THEN DO;
     1067    12166    9                                K=J;
     1068    12167    9                                POS=LOG.POS(J); ITEM=LOG(I);
     1069    12168    9                                END;
     1070    12169    8                             END;
     1071    12170    7                          END;
     1072    12171    6                       END;
     1073    12172    5                    END;
     1074    12173    4                 END/* DO J */;
     1075    12174    4              IF K~=0 THEN DO;
     1076    12175    4                 LOG(K)=LOG(I);
     1077    12176    4                 LOG(I)=ITEM;
     1078    12177    4                 END;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:32   
     1079    12178    3              END/* DO I */;
     1080    12179    2   END SORT_LOG;
     1081    12180
     1082    12181
     1083    12182    1   CONVMPC: PROC(SECTOR);
     1084    12183    2   DCL SECTOR BIT(36) ALIGNED;
     1085    12184    2   DCL 1 SEC REDEF SECTOR ALIGNED,
     1086    12185    2         2 * UBIN(20) UNAL,
     1087    12186    2         2 CL UBIN(8) UNAL,
     1088    12187    2         2 CU UBIN(2) UNAL,
     1089    12188    2         2 HD UBIN(6) UNAL;
     1090    12189    2           SEC.CL=TR.CY.LWR;
     1091    12190    2           SEC.CU=TR.CY.UPR;
     1092    12191    2           SEC.HD=TR.HD;
     1093    12192
     1094    12193    2   END CONVMPC;
     1095    12194    1   END IVV$VOLINIT;
     1096    12195        %EOD;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:33   
--  Include file information  --

   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   IV_SUBS_C.:E05TOU  is referenced.
   IV$MACROS.:E05TOU  is referenced.
   FM$GRAN.:E05TOU  is referenced.
      No diagnostics issued in procedure IVV$VOLINIT.

   Procedure IVV$VOLINIT requires 3308 words for executable code.
   Procedure IVV$VOLINIT requires 112 words of local(AUTO) storage.

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:34   

 Object Unit name= IVV$VOLINIT                                File name= IVV$VOLINIT.:E05TOU
 UTS= JUL 29 '97 23:14:38.56 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    121    171  IVV$VOLINIT
    2   Proc  even  none  3308   6354  IVV$VOLINIT
    3  RoData even  none   112    160  IVV$VOLINIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  IVV$VOLINIT
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:35   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 IVO$INIT
 yes     yes           Std       1 IVO$CONT
 yes     yes           Std       2 IVO$PRINT
 yes     yes           Std       0 IVO$BATCH
 yes     yes           Std       1 IVO$FREE
 yes     yes           Std       1 IVO$SWOUT
 yes     yes           Std       1 IVO$SETPC
         yes           Std       3 IVV$ERROR
 yes     yes           Std       2 IVO$GET
 yes     yes           Std       2 IVO$FINDDVT
         yes           Std       4 IVV$BINDEC
 yes     yes           Std       2 IVV$FMTPAC
 yes     yes           Std       2 IVV$NEXT
 yes     yes           Std       1 IVO$RELDCB
 yes     yes           Std       1 IVO$KEYIN
 yes     yes           Std       1 IVO$SWIN
 yes     yes           Std       1 IVO$WAIT
 yes     yes           Std       3 IVO$GETCMD
 yes     yes           Std       0 IVO$CLEANUP
 yes     yes           Std       0 IVO$READ
 yes     yes           Std       1 IVZ$CKSUM
 yes     yes           Std       1 X$PARSE
 yes     yes           Std       1 IVO$VERIFY_FMT
 yes     yes           Std       1 IVO$READ_VID
 yes     yes           Std       1 IVO$QUEIO
 yes     yes           Std       1 IVO$WRITE_VID
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:36   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  IV_SYNTAX                             B$TCB$
     IV_IO$                                B_VERSION                        r    IV_ONLINE
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:37   


        1        1        /*M* Disk Volume Initialization Main Program */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR */
        8        8        /**/
        9        9        IVV$VOLINIT: PROC;

      9  2 000000   000000 700200 xent  IVV$VOLINIT  TSX0  ! X66_AUTO_0
         2 000001   000160 000000                    ZERO    112,0

       10       10        /**/
       11       11        /* INCLUDE FILES */
       12       12        /**/
       13       13        %INCLUDE FM$GRAN;
       14       82        %INCLUDE IV$MACROS;
       15      252        %INCLUDE IV_SUBS_C;
       16      315        %INCLUDE NI$TABLES;
       17      531        %INCLUDE CP_6;
       18     6090        %INCLUDE B_ERRORS_C;
       19     7217        %INCLUDE XU_MACRO_C;
       20    10323        %INCLUDE XU_SUBS_C;
       21    10415        /**/
       22    10416        /* SUBSTITUTIONS */
       23    10417        /**/
       24    10418        %SUB NULL="ADDR(NIL)";
       25    10419        /**/
       26    10420        /* Queue-Manipulation Macros */
       27    10421        /**/
       28    10422    1   DCL L#$ PTR BASED;
       29    10423        %MACRO ENQUEUE (P#=NIL,Q#=NIL);
       30    10424        DO INHIBIT; IF Q#=NULL THEN P#.FL$=ADDR(P#);ELSE DO;P#.FL$=Q#->L#$;Q#->L#$=ADDR(P#)
             10424        ;END;Q#=ADDR(P#);END;
       31    10425        %MEND;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:38   
       32    10426        /**/
       33    10427        %MACRO DEQUEUE (P#=NIL,Q#=NIL);
       34    10428        DO INHIBIT; P#=Q#->L#$;IF Q#=P# THEN Q#=NULL;ELSE Q#->L#$=P#->L#$;P#->L#$=NULL;END;
       35    10429        %MEND;
       36    10430        /**/
       37    10431        /* EXTERNAL REFERENCES */
       38    10432        /**/
       39    10433    1   DCL IVO$BATCH ENTRY ALTRET;
       40    10434    1   DCL IVO$CLEANUP ENTRY ALTRET;
       41    10435    1   DCL IVO$CONT ENTRY (1) ALTRET;
       42    10436    1   DCL IVO$FINDDVT ENTRY (2) ALTRET;
       43    10437    1   DCL IVO$FORMAT ENTRY (1) ALTRET;
       44    10438    1   DCL IVO$FREE ENTRY (1) ALTRET;
       45    10439    1   DCL IVO$GET ENTRY (2) ALTRET;
       46    10440    1   DCL IVO$GETCMD ENTRY(3) ALTRET;
       47    10441    1   DCL IVO$INIT ENTRY (2) ALTRET;
       48    10442    1   DCL IVO$KEYIN ENTRY (1) ALTRET;
       49    10443    1   DCL IVO$PRINT ENTRY (2) ALTRET;
       50    10444    1   DCL IVO$QUEIO ENTRY(1) ALTRET;
       51    10445    1   DCL IVO$READ ENTRY ALTRET;
       52    10446    1   DCL IVO$READ_VID ENTRY (1) ALTRET;
       53    10447    1   DCL IVO$SETPC ENTRY (1) ALTRET;
       54    10448    1   DCL IVO$SWIN ENTRY (1) ALTRET;
       55    10449    1   DCL IVO$SWOUT ENTRY (1) ALTRET;
       56    10450    1   DCL IVO$WAIT ENTRY(1) ALTRET;
       57    10451    1   DCL IVO$VERIFY_FMT ENTRY(1) ALTRET;
       58    10452    1   DCL IVO$WRITE_VID ENTRY (1) ALTRET;
       59    10453    1   DCL IVO$RELDCB ENTRY (1) ALTRET;
       60    10454    1   DCL IV_SYNTAX SBIN SYMREF;
       61    10455    1   DCL IVV$BINDEC ENTRY (4);
       62    10456    1   DCL IVV$ERROR ENTRY (3);
       63    10457    1   DCL DCWBUILD ENTRY (3);
       64    10458    1   DCL IVV$NEXT ENTRY (2) ALTRET;
       65    10459    1   DCL IVV$FMTPAC ENTRY (2) ALTRET;
       66    10460    1   DCL IVZ$CKSUM ENTRY (1) ALTRET;
       67    10461    1   DCL X$PARSE ENTRY (1) ALTRET;
       68    10462        /**/
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:39   
       69    10463        /* DATA STRUCTURES */
       70    10464        /**/
       71    10465    1   DCL CMDBUF CHAR(1) BASED;
       72    10466        %NI$DVT(NAME=DVT,STCLASS="BASED(DVT$)");
       73    10473        %IV$FMT(NAME=FMT,STCLASS="BASED(FMT$)");
       74    10529        %IV$FMT(NAME=ELT,STCLASS="BASED(ELT$)");
       75    10585    1   DCL 1 GVID BASED(VID$) ALIGNED,         /* GCOS VID */
       76    10586    1         2 KEY BIT(36) ALIGNED,            /* PACK KEY */
       77    10587    1         2 * SBIN,
       78    10588    1         2 NUMB SBIN,                      /* PACK NUMBER */
       79    10589    1         2 *(0:124) SBIN,
       80    10590    1         2 OKEY BIT(36) ALIGNED,           /* OLD PACK KEY */
       81    10591    1         2 *(0:1) SBIN,
       82    10592    1         2 ONUMB SBIN;                     /* OLD PACK NUMBER */
       83    10593                %PARSE$OUT;
       84    10638                %PARSE$SYM;
       85    10676        %FM$VID(FM$VID=VID,BASED="BASED(VID$)");
       86    10682        %IV$VIP(NAME=VIP,STCLASS="BASED(VI$)");
       87    10746    1   DCL B$TCB$ PTR SYMREF;
       88    10747        %B$TCB;
       89    10750        %B$ALT;
       90    10758        /**/
       91    10759        /* STATIC DATA */
       92    10760        /**/
       93    10761    1   DCL IV_IO$ PTR SYMREF;
       94    10762        /**/
       95    10763        /* CONSTANTS */
       96    10764        /**/
       97    10765    1   DCL 1 CMD_PROMPT,
       98    10766    1         2 CNT SBIN,
       99    10767    1         2 MSG CHAR(20);
      100    10768    1   DCL B_VERSION CHAR(1) SYMREF;
      101    10769    1   DCL 1 B$VERSIONB BASED,
      102    10770    1         2 C_ UBIN BYTE CALIGNED,
      103    10771    1         2 T_ CHAR(B$VERSIONB.C_) CALIGNED;
      104    10772    1   DCL 1 DTT_PROMPT CONSTANT,
      105    10773    1         2 * SBIN INIT(SIZEC(DTT_PROMPT.MSG)),
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:40   
      106    10774    1         2 MSG CHAR(0) INIT('AEnter DTT: ');
      107    10775    1   DCL 1 OKREQ CONSTANT,
      108    10776    1         2 * SBIN INIT(SIZEC(OKREQ.MSG)),
      109    10777    1         2 MSG CHAR(0) INIT('@Ok to change VSN   ');
      110    10778    1   DCL 1 STATUS CONSTANT,
      111    10779    1         2 * SBIN INIT(SIZEC(STATUS.MSG)),
      112    10780    1         2 MSG CHAR(0) INIT('ADP00 VSN:000000 at CCCC.HH  ');
      113    10781        /**/
      114    10782        /* AUTO STACK */
      115    10783        /**/
      116    10784    1   DCL BLK$ PTR;
      117    10785    1   DCL BB BIT(36);
      118    10786    1   DCL CC SBIN;
      119    10787    1   DCL CC1 SBIN ALIGNED AUTO ;
      120    10788    1   DCL CC2 SBIN ALIGNED AUTO ;
      121    10789    1   DCL DEVID CHAR(4) ALIGNED;
      122    10790    1   DCL DTTX SBIN;
      123    10791    1   DCL DVT$ PTR;
      124    10792    1   DCL FMT$ PTR;
      125    10793    1   DCL FOUNDF BIT(1);
      126    10794    1   DCL DTT_FOUND BIT(1);
      127    10795    1   DCL HH SBIN;
      128    10796    1   DCL HH2 SBIN ALIGNED AUTO ;
      129    10797    1   DCL ERROR_CNT SBIN;
      130    10798    1   DCL I SBIN;
      131    10799    1   DCL J SBIN;
      132    10800    1   DCL K SBIN;
      133    10801    1   DCL LTRACK SBIN;
      134    10802    1   DCL NHW SBIN;
      135    10803    1   DCL NW SBIN;
      136    10804    1   DCL OPT$ PTR;
      137    10805    1   DCL 1 OUT ALIGNED,
      138    10806    1         2 LEN SBIN,
      139    10807    1         2 MSG CHAR(80);
      140    10808        %P$PCB(NAME=PCB);
      141    11009        %P_PCB (NAME=CONSTANT_PCB,STCLASS=CONSTANT);
      142    11208                                           /* Storage structure for MSU050X header */
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:41   
      143    11209    1   DCL HDR5$ PTR;
      144    11210    1   DCL DATA$ PTR;
      145    11211        %IV$HDR(NAME=CF,STCLASS="BASED(HDR5$)");
      146    11239    1   DCL 1 LOG(0:3071) BASED(DATA$) UNAL,
      147    11240    1         2 CYL UBIN(16) UNAL,
      148    11241    1         2 HD UBIN(8) UNAL,
      149    11242    1         2 POS UBIN(16) UNAL,
      150    11243    1         2 LTH UBIN(8) UNAL;
      151    11244    1   DCL LOG_BIT (0:16383) REDEF LOG BIT(9) CALIGNED;
      152    11245
      153    11246        /**/
      154    11247        /* SUBSTITUTIONS
      155    11248        %EQU FORMAT='17'O;                       DISK FORMAT TRACK COMMAND
      156    11249        %EQU WRCMP='33'O;                        DISK WRITE & COMPARE COMMAND
      157    11250        %EQU DP_TDSEEK512='35'O;                 DISK SEEK OF 512 FORMAT COMMAND
      158    11251        %EQU RDHEADER='27'O;                     READ TRACK HEADER COMMAND */
      159    11252        %EQU RDBIN='25'O;                       /* READ ELT DATA IN BINA COMMAND */
      160    11253    1   DCL IVO$READ_ELT ENTRY (1) ALTRET;
      161    11254    1   DCL ELT$ PTR;
      162    11255
      163    11256    1   DCL TRACK UBIN(18);
      164    11257    1   DCL 1 TR REDEF TRACK ALIGNED,
      165    11258    1         2 CYL UBIN(10) UNAL,              /* CYLINDER NUMBER */
      166    11259    1         2 CY REDEF CYL,
      167    11260    1           3 UPR UBIN(2) UNAL,
      168    11261    1           3 LWR UBIN(8) UNAL,
      169    11262    1         2 X UBIN(2) UNAL,
      170    11263    1         2 HD UBIN(6) UNAL;                /* HEAD NUMBER */
      171    11264    1   DCL 1 CYL  ALIGNED,
      172    11265    1         2 * BIT(26) UNAL,
      173    11266    1         2 N UBIN(10) UNAL;
      174    11267    1   DCL 1 HEAD  ALIGNED,
      175    11268    1         2 * BIT(28) UNAL,
      176    11269    1         2 N UBIN(8) UNAL;
      177    11270    1   DCL TRANGE BIT(36);
      178    11271    1   DCL VI$ PTR;
      179    11272    1   DCL VID$ PTR;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:42   
      180    11273    1   DCL VIP$ PTR;
      181    11274    1   DCL IV_ONLINE BIT(1) ALIGNED SYMREF READONLY;
      182    11275    1   DCL IV_PROMPT CHAR(1) CONSTANT INIT('*');
      183    11276        %EJECT;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:43   
      184    11277    1           PCB=CONSTANT_PCB;

  11277  2 000002   000100 100400                    MLR     fill='000'O
         2 000003   000023 000070 1                  ADSC9   CONSTANT_PCB             cn=0,n=56
         2 000004   200063 000070                    ADSC9   PCB,,AUTO                cn=0,n=56

      185    11278    1           CALL IVO$INIT(PCB);

  11278  2 000005   200063 630500                    EPPR0   PCB,,AUTO
         2 000006   200144 450500                    STP0    @V+17,,AUTO
         2 000007   200144 630500                    EPPR0   @V+17,,AUTO
         2 000010   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000011   000000 701000 xent               TSX1    IVO$INIT
         2 000012   000000 011000                    NOP     0

      186    11279    1           PCB.ROOT$=ADDR(IV_SYNTAX);

  11279  2 000013   000000 236000 3                  LDQ     0
         2 000014   200064 756100                    STQ     PCB+1,,AUTO

      187    11280    1           PCB.U$$=ENTADDR(IVO$CONT);

  11280  2 000015   000000 636000 xent               EAQ     IVO$CONT
         2 000016   200067 756100                    STQ     PCB+4,,AUTO

      188    11281    1           PCB.CMPRS='1'B;

  11281  2 000017   400000 236007                    LDQ     -131072,DL
         2 000020   200070 256100                    ORSQ    PCB+5,,AUTO

      189    11282    1           PCB.COMMENT.LEAD=' "';

  11282  2 000021   000107 220000 1                  LDX0    DTTLINE+9
         2 000022   200072 740100                    STX0    PCB+7,,AUTO

      190    11283    1           PCB.COMMENT.TRAIL=' "';

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:44   
  11283  2 000023   200072 440100                    SXL0    PCB+7,,AUTO

      191    11284    1           VIP$=NULL;

  11284  2 000024   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000025   200112 756100                    STQ     VIP$,,AUTO

      192    11285    1           IV_IO$=ADDR(NIL);

  11285  2 000026   000000 756000 xsym               STQ     IV_IO$

      193    11286    1           CALL CONCAT(CMD_PROMPT.MSG,'AVOLINIT ',ADDR(B_VERSION)->B$VERSIONB.T_,
             11286                    ' Here');

  11286  2 000027   000000 236000 xsym               LDQ     B_VERSION
         2 000030   000033 772000                    QRL     27
         2 000031   040100 100400                    MLR     fill='040'O
         2 000032   000110 000011 1                  ADSC9   DTTLINE+10               cn=0,n=9
         2 000033   200004 000011                    ADSC9   CMD_PROMPT+1,,AUTO       cn=0,n=9
         2 000034   000000 621006                    EAX1    0,QL
         2 000035   040100 100440                    MLR     fill='040'O
         2 000036   000000 200011 xsym               ADSC9   B_VERSION                cn=1,n=*X1
         2 000037   200006 200013                    ADSC9   CMD_PROMPT+3,,AUTO       cn=1,n=11
         2 000040   000013 116007                    CMPQ    11,DL
         2 000041   000047 603000 2                  TRC     s:11287
         2 000042   777764 622006                    EAX2    -12,QL
         2 000043   777777 662003                    ERX2    -1,DU
         2 000044   040146 100400                    MLR     fill='040'O
         2 000045   000113 000005 1                  ADSC9   DTTLINE+13               cn=0,n=5
         2 000046   200006 200012                    ADSC9   CMD_PROMPT+3,Q,AUTO      cn=1,n=*X2

      194    11287    1           CMD_PROMPT.CNT = SIZEC(CMD_PROMPT.MSG);

  11287  2 000047   000024 235007                    LDA     20,DL
         2 000050   200003 755100                    STA     CMD_PROMPT,,AUTO

      195    11288    1           CALL IVO$PRINT(CMD_PROMPT,'0'B);
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:45   

  11288  2 000051   000001 236000 3                  LDQ     1
         2 000052   200145 756100                    STQ     @V+18,,AUTO
         2 000053   200003 630500                    EPPR0   CMD_PROMPT,,AUTO
         2 000054   200144 450500                    STP0    @V+17,,AUTO
         2 000055   200144 630500                    EPPR0   @V+17,,AUTO
         2 000056   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000057   000000 701000 xent               TSX1    IVO$PRINT
         2 000060   000000 011000                    NOP     0

      196    11289    1   NEXT_CMD:
      197    11290    1           CALL IVO$SETPC(IV_PROMPT);

  11290  2 000061   000002 630400 3     NEXT_CMD     EPPR0   2
         2 000062   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000063   000000 701000 xent               TSX1    IVO$SETPC
         2 000064   000000 011000                    NOP     0

      198    11291    1           IF IV_ONLINE THEN

  11291  2 000065   000000 234000 xsym               SZN     IV_ONLINE
         2 000066   000102 605000 2                  TPL     s:11295

      199    11292    1              CALL IVO$GETCMD (IV_SYNTAX, BLK$, VECTOR(IV_PROMPT)) ALTRET (
             11292                       WAIT_NEXT_CMD);

  11292  2 000067   000006 236000 3                  LDQ     6
         2 000070   200146 756100                    STQ     @V+19,,AUTO
         2 000071   200011 630500                    EPPR0   BLK$,,AUTO
         2 000072   200145 450500                    STP0    @V+18,,AUTO
         2 000073   000000 236000 3                  LDQ     0
         2 000074   200144 756100                    STQ     @V+17,,AUTO
         2 000075   200144 630500                    EPPR0   @V+17,,AUTO
         2 000076   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000077   000000 701000 xent               TSX1    IVO$GETCMD
         2 000100   004374 702000 2                  TSX2    WAIT_NEXT_CMD
         2 000101   000115 710000 2                  TRA     s:11299
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:46   

      200    11293    1           ELSE
      201    11294    2           DO;

      202    11295    2              CALL IVO$READ ALTRET(WAIT_NEXT_CMD);

  11295  2 000102   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000103   000000 701000 xent               TSX1    IVO$READ
         2 000104   004374 702000 2                  TSX2    WAIT_NEXT_CMD

      203    11296    2              CALL X$PARSE(PCB) ALTRET(PARSE_ERR);

  11296  2 000105   200063 630500                    EPPR0   PCB,,AUTO
         2 000106   200144 450500                    STP0    @V+17,,AUTO
         2 000107   200144 630500                    EPPR0   @V+17,,AUTO
         2 000110   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000111   000000 701000 xent               TSX1    X$PARSE
         2 000112   004250 702000 2                  TSX2    PARSE_ERR

      204    11297    2              BLK$=PCB.OUT$;

  11297  2 000113   200066 236100                    LDQ     PCB+3,,AUTO
         2 000114   200011 756100                    STQ     BLK$,,AUTO

      205    11298    2              END;

      206    11299    2           DO CASE (OUT$BLK.CODE);

  11299  2 000115   200011 470500                    LDP0    BLK$,,AUTO
         2 000116   000000 720100                    LXL0    0,,PR0
         2 000117   000013 100003                    CMPX0   11,DU
         2 000120   000122 602010 2                  TNC     s:11299+5,X0
         2 000121   004240 710000 2                  TRA     s:11853
         2 000122   000136 710000 2                  TRA     s:11303
         2 000123   003702 710000 2                  TRA     s:11799
         2 000124   004102 710000 2                  TRA     s:11822
         2 000125   004120 710000 2                  TRA     s:11825
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:47   
         2 000126   004136 710000 2                  TRA     s:11828
         2 000127   004210 710000 2                  TRA     WAITDONE
         2 000130   004240 710000 2                  TRA     s:11853
         2 000131   004240 710000 2                  TRA     s:11853
         2 000132   004226 710000 2                  TRA     s:11851
         2 000133   004226 710000 2                  TRA     s:11851
         2 000134   000135 710000 2                  TRA     s:11301

      207    11300    2            CASE(#NULL);                   /* [.B] .END */

      208    11301    2              GOTO NEXT_CMD;

  11301  2 000135   000061 710000 2                  TRA     NEXT_CMD

      209    11302    2            CASE(#VOLINIT);                /* VOLINIT COMMAND */

      210    11303    2              VI$=VIP$;

  11303  2 000136   200112 236100                    LDQ     VIP$,,AUTO
         2 000137   200110 756100                    STQ     VI$,,AUTO

      211    11304    3              IF VI$~=NULL THEN DO;

  11304  2 000140   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000141   000174 600000 2                  TZE     s:11313

      212    11305    3   NEXT_DP:
      213    11306    3                 VI$=VIP.FL$;

  11306  2 000142   200110 470500       NEXT_DP      LDP0    VI$,,AUTO
         2 000143   000000 236100                    LDQ     0,,PR0
         2 000144   200110 756100                    STQ     VI$,,AUTO

      214    11307    4                 IF VIP.DEVID=OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT THEN DO;

  11307  2 000145   200011 470500                    LDP0    BLK$,,AUTO
         2 000146   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:48   
         2 000147   100004 236100                    LDQ     4,,PR1
         2 000150   000033 772000                    QRL     27
         2 000151   200110 473500                    LDP3    VI$,,AUTO
         2 000152   000000 620006                    EAX0    0,QL
         2 000153   040140 106500                    CMPC    fill='040'O
         2 000154   300005 000010                    ADSC9   5,,PR3                   cn=0,n=8
         2 000155   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         2 000156   000171 601000 2                  TNZ     s:11311

      215    11308    4                    CALL IVV$ERROR(VIP.DEVID,13);

  11308  2 000157   000010 236000 3                  LDQ     8
         2 000160   200145 756100                    STQ     @V+18,,AUTO
         2 000161   200110 236100                    LDQ     VI$,,AUTO
         2 000162   000005 036003                    ADLQ    5,DU
         2 000163   200144 756100                    STQ     @V+17,,AUTO
         2 000164   200144 630500                    EPPR0   @V+17,,AUTO
         2 000165   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000166   000000 701000 xent               TSX1    IVV$ERROR
         2 000167   000000 011000                    NOP     0

      216    11309    4                    GOTO WAIT_NEXT_CMD;

  11309  2 000170   004374 710000 2                  TRA     WAIT_NEXT_CMD

      217    11310    4                    END;
      218    11311    3                 IF VI$~=VIP$ THEN GOTO NEXT_DP;

  11311  2 000171   200110 236100                    LDQ     VI$,,AUTO
         2 000172   200112 116100                    CMPQ    VIP$,,AUTO
         2 000173   000142 601000 2                  TNZ     NEXT_DP

      219    11312    3                 END/* IF VI$ */;

      220    11313    2              CALL IVO$GET(VI$,SIZEW(VIP)) ALTRET(NO_SPACE);

  11313  2 000174   000012 236000 3                  LDQ     10
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:49   
         2 000175   200145 756100                    STQ     @V+18,,AUTO
         2 000176   200110 631500                    EPPR1   VI$,,AUTO
         2 000177   200144 451500                    STP1    @V+17,,AUTO
         2 000200   200144 630500                    EPPR0   @V+17,,AUTO
         2 000201   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000202   000000 701000 xent               TSX1    IVO$GET
         2 000203   004370 702000 2                  TSX2    NO_SPACE

      221    11314    2              VIP='0'B;

  11314  2 000204   200110 470500                    LDP0    VI$,,AUTO
         2 000205   000100 100400                    MLR     fill='000'O
         2 000206   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000207   000000 000520                    ADSC9   0,,PR0                   cn=0,n=336

      222    11315    2              VIP.FL$=NULL;

  11315  2 000210   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000211   200110 470500                    LDP0    VI$,,AUTO
         2 000212   000000 756100                    STQ     0,,PR0

      223    11316    2              VIP.DEVID=OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  11316  2 000213   200011 470500                    LDP0    BLK$,,AUTO
         2 000214   000003 471500                    LDP1    3,,PR0
         2 000215   100004 236100                    LDQ     4,,PR1
         2 000216   000033 772000                    QRL     27
         2 000217   000000 620006                    EAX0    0,QL
         2 000220   200110 473500                    LDP3    VI$,,AUTO
         2 000221   040100 100540                    MLR     fill='040'O
         2 000222   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         2 000223   300005 000010                    ADSC9   5,,PR3                   cn=0,n=8

      224    11317    2              CALL DECBIN(OUT$BLK.SUBLK$(1)->OUT$SYM.COUNT,VIP.VSN);

  11317  2 000224   200011 470500                    LDP0    BLK$,,AUTO
         2 000225   000004 471500                    LDP1    4,,PR0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:50   
         2 000226   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000227   200117 756100                    STQ     HH+1,,AUTO
         2 000230   200110 236100                    LDQ     VI$,,AUTO
         2 000231   000011 036003                    ADLQ    9,DU
         2 000232   200116 756100                    STQ     @SECTOR+1,,AUTO
         2 000233   100004 633500                    EPPR3   4,,PR1
         2 000234   200115 453500                    STP3    VIP$+3,,AUTO
         2 000235   005331 701000 2                  TSX1    DECBIN
         2 000236   000000 011000                    NOP     0

      225    11318    2              VIP.VID$=NULL;

  11318  2 000237   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000240   200110 470500                    LDP0    VI$,,AUTO
         2 000241   000012 756100                    STQ     10,,PR0

      226    11319    2              VIP.FMT$=NULL;

  11319  2 000242   200110 470500                    LDP0    VI$,,AUTO
         2 000243   000013 756100                    STQ     11,,PR0

      227    11320    2              VIP.ELT$=NULL;

  11320  2 000244   200110 470500                    LDP0    VI$,,AUTO
         2 000245   000003 756100                    STQ     3,,PR0

      228    11321    2              CALL IVO$FINDDVT(VIP,DVT$) ALTRET(NO_DISK);

  11321  2 000246   200020 630500                    EPPR0   DVT$,,AUTO
         2 000247   200145 450500                    STP0    @V+18,,AUTO
         2 000250   200110 236100                    LDQ     VI$,,AUTO
         2 000251   200144 756100                    STQ     @V+17,,AUTO
         2 000252   200144 630500                    EPPR0   @V+17,,AUTO
         2 000253   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000254   000000 701000 xent               TSX1    IVO$FINDDVT
         2 000255   004255 702000 2                  TSX2    NO_DISK

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:51   
      229    11322    2              VIP.DVT$=DVT$;

  11322  2 000256   200020 236100                    LDQ     DVT$,,AUTO
         2 000257   200110 470500                    LDP0    VI$,,AUTO
         2 000260   000002 756100                    STQ     2,,PR0

      230    11323    2              VIP.NSECTS=DVT.SPT;

  11323  2 000261   200020 470500                    LDP0    DVT$,,AUTO
         2 000262   200110 471500                    LDP1    VI$,,AUTO
         2 000263   000053 236100                    LDQ     43,,PR0
         2 000264   000022 736000                    QLS     18
         2 000265   100014 552140                    STBQ    12,'40'O,PR1

      231    11324    2              VIP.NHEADS=DVT.CYLSIZE/VIP.NSECTS;

  11324  2 000266   200110 470500                    LDP0    VI$,,AUTO
         2 000267   000014 236100                    LDQ     12,,PR0
         2 000270   000033 772000                    QRL     27
         2 000271   200144 756100                    STQ     @V+17,,AUTO
         2 000272   200020 471500                    LDP1    DVT$,,AUTO
         2 000273   100055 236100                    LDQ     45,,PR1
         2 000274   000022 772000                    QRL     18
         2 000275   200144 506100                    DIV     @V+17,,AUTO
         2 000276   000022 736000                    QLS     18
         2 000277   000014 552120                    STBQ    12,'20'O,PR0

      232    11325    2              VIP.NCYLS=(DVT.PACKSIZE*DVT.GRANSIZE+DVT.GRANSIZE-1)/DVT.CYLSIZE;

  11325  2 000300   200020 470500                    LDP0    DVT$,,AUTO
         2 000301   000053 236100                    LDQ     43,,PR0
         2 000302   000777 376007                    ANQ     511,DL
         2 000303   000054 402100                    MPY     44,,PR0
         2 000304   200144 756100                    STQ     @V+17,,AUTO
         2 000305   000053 236100                    LDQ     43,,PR0
         2 000306   000777 376007                    ANQ     511,DL
         2 000307   200145 756100                    STQ     @V+18,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:52   
         2 000310   200144 236100                    LDQ     @V+17,,AUTO
         2 000311   200145 036100                    ADLQ    @V+18,,AUTO
         2 000312   200146 756100                    STQ     @V+19,,AUTO
         2 000313   000055 236100                    LDQ     45,,PR0
         2 000314   000022 772000                    QRL     18
         2 000315   200147 756100                    STQ     @V+20,,AUTO
         2 000316   200146 236100                    LDQ     @V+19,,AUTO
         2 000317   000001 136007                    SBLQ    1,DL
         2 000320   200147 506100                    DIV     @V+20,,AUTO
         2 000321   000000 620006                    EAX0    0,QL
         2 000322   200110 471500                    LDP1    VI$,,AUTO
         2 000323   100014 440100                    SXL0    12,,PR1

      233    11326    2              VIP.T@DCYL=DVT.T@DCYL;

  11326  2 000324   200020 470500                    LDP0    DVT$,,AUTO
         2 000325   000055 720100                    LXL0    45,,PR0
         2 000326   200110 471500                    LDP1    VI$,,AUTO
         2 000327   100015 740100                    STX0    13,,PR1

      234    11327    2              VIP.GRANSIZE=DVT.GRANSIZE;

  11327  2 000330   200020 470500                    LDP0    DVT$,,AUTO
         2 000331   200110 471500                    LDP1    VI$,,AUTO
         2 000332   000053 236100                    LDQ     43,,PR0
         2 000333   000022 736000                    QLS     18
         2 000334   100020 552120                    STBQ    16,'20'O,PR1

      235    11328    2              VIP.FORMAT='0'B;

  11328  2 000335   200110 470500                    LDP0    VI$,,AUTO
         2 000336   000013 236000 3                  LDQ     11
         2 000337   000017 356100                    ANSQ    15,,PR0

      236    11329    2              VIP.VERIFY='0'B;

  11329  2 000340   200110 470500                    LDP0    VI$,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:53   
         2 000341   000014 236000 3                  LDQ     12
         2 000342   000017 356100                    ANSQ    15,,PR0

      237    11330    2              VIP.ALT = '0'B;

  11330  2 000343   200110 470500                    LDP0    VI$,,AUTO
         2 000344   000015 236000 3                  LDQ     13
         2 000345   000017 356100                    ANSQ    15,,PR0

      238    11331    2              VIP.SCRATCH='1'B;

  11331  2 000346   200110 470500                    LDP0    VI$,,AUTO
         2 000347   000400 236007                    LDQ     256,DL
         2 000350   000017 256100                    ORSQ    15,,PR0

      239    11332    3              DO SELECT (VIP.MODEL);

  11332  2 000351   200110 470500                    LDP0    VI$,,AUTO
         2 000352   040000 106500                    CMPC    fill='040'O
         2 000353   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 000354   000115 000010 1                  ADSC9   DTTLINE+15               cn=0,n=8
         2 000355   000410 602000 2                  TNC     s:11332+31
         2 000356   000434 600000 2                  TZE     s:11336
         2 000357   040000 106500                    CMPC    fill='040'O
         2 000360   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 000361   000117 000010 1                  ADSC9   DTTLINE+17               cn=0,n=8
         2 000362   000371 602000 2                  TNC     s:11332+16
         2 000363   000434 600000 2                  TZE     s:11336
         2 000364   040000 106500                    CMPC    fill='040'O
         2 000365   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 000366   000121 000010 1                  ADSC9   DTTLINE+19               cn=0,n=8
         2 000367   000444 601000 2                  TNZ     s:11339
         2 000370   000434 710000 2                  TRA     s:11336
         2 000371   040000 106500                    CMPC    fill='040'O
         2 000372   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 000373   000123 000010 1                  ADSC9   DTTLINE+21               cn=0,n=8
         2 000374   000403 602000 2                  TNC     s:11332+26
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:54   
         2 000375   000434 600000 2                  TZE     s:11336
         2 000376   040000 106500                    CMPC    fill='040'O
         2 000377   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 000400   000125 000010 1                  ADSC9   DTTLINE+23               cn=0,n=8
         2 000401   000444 601000 2                  TNZ     s:11339
         2 000402   000434 710000 2                  TRA     s:11336
         2 000403   040000 106500                    CMPC    fill='040'O
         2 000404   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 000405   000127 000010 1                  ADSC9   DTTLINE+25               cn=0,n=8
         2 000406   000444 601000 2                  TNZ     s:11339
         2 000407   000434 710000 2                  TRA     s:11336
         2 000410   040000 106500                    CMPC    fill='040'O
         2 000411   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 000412   000131 000010 1                  ADSC9   DTTLINE+27               cn=0,n=8
         2 000413   000427 602000 2                  TNC     s:11332+46
         2 000414   000434 600000 2                  TZE     s:11336
         2 000415   040000 106500                    CMPC    fill='040'O
         2 000416   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 000417   000133 000010 1                  ADSC9   DTTLINE+29               cn=0,n=8
         2 000420   000444 602000 2                  TNC     s:11339
         2 000421   000434 600000 2                  TZE     s:11336
         2 000422   040000 106500                    CMPC    fill='040'O
         2 000423   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 000424   000135 000010 1                  ADSC9   DTTLINE+31               cn=0,n=8
         2 000425   000444 601000 2                  TNZ     s:11339
         2 000426   000434 710000 2                  TRA     s:11336
         2 000427   040000 106500                    CMPC    fill='040'O
         2 000430   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 000431   000137 000010 1                  ADSC9   DTTLINE+33               cn=0,n=8
         2 000432   000444 601000 2                  TNZ     s:11339
         2 000433   000434 710000 2                  TRA     s:11336

      240    11333    3                 SELECT ('MSU8082 ', 'MSU8092 ', 'MSU3380 ', 'MSU3382 ',

      241    11334    3                   'MSU3390 ', 'MSU3392 ', 'MSU3391 ', 'MSU3393 ',
      242    11335    3                   'MSU3381 ', 'MSU3383 ');
      243    11336    3                 VIP.DTT = #NEW;           /* SET DEFAULTS FOR FIPS & MDS DISCS */
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:55   

  11336  2 000434   000017 236100                    LDQ     15,,PR0
         2 000435   000016 376000 3                  ANQ     14
         2 000436   000002 276003                    ORQ     2,DU
         2 000437   000017 756100                    STQ     15,,PR0

      244    11337    3                 VIP.TEST = '0'B;

  11337  2 000440   200110 470500                    LDP0    VI$,,AUTO
         2 000441   000017 236000 3                  LDQ     15
         2 000442   000017 356100                    ANSQ    15,,PR0
         2 000443   000451 710000 2                  TRA     s:11342

      245    11338    3                 SELECT (ELSE);

      246    11339    3              VIP.DTT = #OLD;

  11339  2 000444   000016 236000 3                  LDQ     14
         2 000445   000017 356100                    ANSQ    15,,PR0

      247    11340    3              VIP.TEST = '1'B;

  11340  2 000446   200110 470500                    LDP0    VI$,,AUTO
         2 000447   100000 236007                    LDQ     32768,DL
         2 000450   000017 256100                    ORSQ    15,,PR0

      248    11341    3                 END;

      249    11342    3           DO I=2 TO OUT$BLK.NSUBLKS-1;

  11342  2 000451   000002 235007                    LDA     2,DL
         2 000452   200027 755100                    STA     I,,AUTO
         2 000453   001116 710000 2                  TRA     s:11408+1

      250    11343    3              OPT$=OUT$BLK.SUBLK$(I);

  11343  2 000454   200011 470500                    LDP0    BLK$,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:56   
         2 000455   200027 720100                    LXL0    I,,AUTO
         2 000456   000003 236110                    LDQ     3,X0,PR0
         2 000457   200035 756100                    STQ     OPT$,,AUTO

      251    11344    4              DO CASE (OPT$->OUT$BLK.CODE);

  11344  2 000460   200035 471500                    LDP1    OPT$,,AUTO
         2 000461   100000 721100                    LXL1    0,,PR1
         2 000462   000017 101003                    CMPX1   15,DU
         2 000463   000465 602011 2                  TNC     s:11344+5,X1
         2 000464   001115 710000 2                  TRA     s:11408
         2 000465   001115 710000 2                  TRA     s:11408
         2 000466   001115 710000 2                  TRA     s:11408
         2 000467   000504 710000 2                  TRA     s:11346
         2 000470   000514 710000 2                  TRA     s:11348
         2 000471   000520 710000 2                  TRA     s:11350
         2 000472   000524 710000 2                  TRA     s:11352
         2 000473   000530 710000 2                  TRA     s:11354
         2 000474   000534 710000 2                  TRA     s:11356
         2 000475   000540 710000 2                  TRA     s:11358
         2 000476   000564 710000 2                  TRA     s:11368
         2 000477   000570 710000 2                  TRA     s:11370
         2 000500   000544 710000 2                  TRA     s:11360
         2 000501   000550 710000 2                  TRA     s:11362
         2 000502   000554 710000 2                  TRA     s:11364
         2 000503   000560 710000 2                  TRA     s:11366

      252    11345    4               CASE(#DTT);                 /* DTT PARAMETER */

      253    11346    4                 VIP.DTT=OPT$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  11346  2 000504   100003 473500                    LDP3    3,,PR1
         2 000505   200110 474500                    LDP4    VI$,,AUTO
         2 000506   300000 236100                    LDQ     0,,PR3
         2 000507   000022 736000                    QLS     18
         2 000510   400017 676100                    ERQ     15,,PR4
         2 000511   000007 376003                    ANQ     7,DU
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:57   
         2 000512   400017 656100                    ERSQ    15,,PR4
         2 000513   001115 710000 2                  TRA     s:11408

      254    11347    4               CASE(#FORMAT);              /* FORMAT OPTION */

      255    11348    4                 VIP.FORMAT='1'B;

  11348  2 000514   200110 473500                    LDP3    VI$,,AUTO
         2 000515   400000 236007                    LDQ     -131072,DL
         2 000516   300017 256100                    ORSQ    15,,PR3
         2 000517   001115 710000 2                  TRA     s:11408

      256    11349    4               CASE(#NOFORMAT);            /* NOFORMAT OPTION */

      257    11350    4                 VIP.FORMAT='0'B;

  11350  2 000520   200110 473500                    LDP3    VI$,,AUTO
         2 000521   000013 236000 3                  LDQ     11
         2 000522   300017 356100                    ANSQ    15,,PR3
         2 000523   001115 710000 2                  TRA     s:11408

      258    11351    4               CASE(#VERIFY);              /* VERIFY OPTION */

      259    11352    4                 VIP.VERIFY='1'B;

  11352  2 000524   200110 473500                    LDP3    VI$,,AUTO
         2 000525   200000 236007                    LDQ     65536,DL
         2 000526   300017 256100                    ORSQ    15,,PR3
         2 000527   001115 710000 2                  TRA     s:11408

      260    11353    4               CASE(#NOVERIFY);            /* NOVERIFY OPTION */

      261    11354    4                 VIP.VERIFY='0'B;

  11354  2 000530   200110 473500                    LDP3    VI$,,AUTO
         2 000531   000014 236000 3                  LDQ     12
         2 000532   300017 356100                    ANSQ    15,,PR3
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:58   
         2 000533   001115 710000 2                  TRA     s:11408

      262    11355    4               CASE(#TEST);                /* TEST OPTION */

      263    11356    4                 VIP.TEST='1'B;

  11356  2 000534   200110 473500                    LDP3    VI$,,AUTO
         2 000535   100000 236007                    LDQ     32768,DL
         2 000536   300017 256100                    ORSQ    15,,PR3
         2 000537   001115 710000 2                  TRA     s:11408

      264    11357    4               CASE(#NOTEST);              /* NOTEST OPTION */

      265    11358    4                 VIP.TEST='0'B;

  11358  2 000540   200110 473500                    LDP3    VI$,,AUTO
         2 000541   000017 236000 3                  LDQ     15
         2 000542   300017 356100                    ANSQ    15,,PR3
         2 000543   001115 710000 2                  TRA     s:11408

      266    11359    4               CASE(#SCRATCH);             /* SCRATCH OPTION */

      267    11360    4                 VIP.SCRATCH='1'B;

  11360  2 000544   200110 473500                    LDP3    VI$,,AUTO
         2 000545   000400 236007                    LDQ     256,DL
         2 000546   300017 256100                    ORSQ    15,,PR3
         2 000547   001115 710000 2                  TRA     s:11408

      268    11361    4               CASE(#NOSCRATCH);           /* NOSCRATCH OPTION */

      269    11362    4                 VIP.SCRATCH='0'B;

  11362  2 000550   200110 473500                    LDP3    VI$,,AUTO
         2 000551   000020 236000 3                  LDQ     16
         2 000552   300017 356100                    ANSQ    15,,PR3
         2 000553   001115 710000 2                  TRA     s:11408
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:59   

      270    11363    4               CASE(#ALT);                 /* ALT OPTION */

      271    11364    4                 VIP.ALT = '1'B;

  11364  2 000554   200110 473500                    LDP3    VI$,,AUTO
         2 000555   000200 236007                    LDQ     128,DL
         2 000556   300017 256100                    ORSQ    15,,PR3
         2 000557   001115 710000 2                  TRA     s:11408

      272    11365    4               CASE(#NOALT);               /* NOALT OPTION */

      273    11366    4                 VIP.ALT = '0'B;

  11366  2 000560   200110 473500                    LDP3    VI$,,AUTO
         2 000561   000015 236000 3                  LDQ     13
         2 000562   300017 356100                    ANSQ    15,,PR3
         2 000563   001115 710000 2                  TRA     s:11408

      274    11367    4               CASE(#NEWDTS);              /* NEWDTS OPTION */

      275    11368    4                 VIP.NEWDTS='1'B;

  11368  2 000564   200110 473500                    LDP3    VI$,,AUTO
         2 000565   040000 236007                    LDQ     16384,DL
         2 000566   300017 256100                    ORSQ    15,,PR3
         2 000567   001115 710000 2                  TRA     s:11408

      276    11369    4               CASE(#RANGE);               /* RANGE PARAMETER */

      277    11370    5                 IF VIP.NRANGES>=64 THEN DO;

  11370  2 000570   200110 473500                    LDP3    VI$,,AUTO
         2 000571   300020 236100                    LDQ     16,,PR3
         2 000572   777000 376003                    ANQ     -512,DU
         2 000573   100000 116003                    CMPQ    32768,DU
         2 000574   000607 602000 2                  TNC     s:11374
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:60   

      278    11371    5                    CALL IVV$ERROR(VIP.DEVID,5);

  11371  2 000575   000021 236000 3                  LDQ     17
         2 000576   200145 756100                    STQ     @V+18,,AUTO
         2 000577   200110 236100                    LDQ     VI$,,AUTO
         2 000600   000005 036003                    ADLQ    5,DU
         2 000601   200144 756100                    STQ     @V+17,,AUTO
         2 000602   200144 630500                    EPPR0   @V+17,,AUTO
         2 000603   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000604   000000 701000 xent               TSX1    IVV$ERROR
         2 000605   000000 011000                    NOP     0

      279    11372    5                    GOTO DEL_VI;

  11372  2 000606   004312 710000 2                  TRA     DEL_VI

      280    11373    5                    END;
      281    11374    4                 CALL DECBIN(OPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT,CC,HH);

  11374  2 000607   100003 474500                    LDP4    3,,PR1
         2 000610   200024 635500                    EPPR5   HH,,AUTO
         2 000611   200117 455500                    STP5    HH+1,,AUTO
         2 000612   200013 636500                    EPPR6   CC,,AUTO
         2 000613   200116 456500                    STP6    @SECTOR+1,,AUTO
         2 000614   400004 637500                    EPPR7   4,,PR4
         2 000615   200115 457500                    STP7    VIP$+3,,AUTO
         2 000616   005331 701000 2                  TSX1    DECBIN
         2 000617   000000 011000                    NOP     0

      282    11375    5                 IF HH<0 THEN DO;

  11375  2 000620   200024 235100                    LDA     HH,,AUTO
         2 000621   000714 605000 2                  TPL     s:11386

      283    11376    5                    TRACK=CC*DVT.GRANSIZE/VIP.NSECTS;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:61   
  11376  2 000622   200020 470500                    LDP0    DVT$,,AUTO
         2 000623   000053 236100                    LDQ     43,,PR0
         2 000624   000777 376007                    ANQ     511,DL
         2 000625   200013 402100                    MPY     CC,,AUTO
         2 000626   200110 471500                    LDP1    VI$,,AUTO
         2 000627   200144 756100                    STQ     @V+17,,AUTO
         2 000630   100014 236100                    LDQ     12,,PR1
         2 000631   000033 772000                    QRL     27
         2 000632   200145 756100                    STQ     @V+18,,AUTO
         2 000633   200144 236100                    LDQ     @V+17,,AUTO
         2 000634   200145 506100                    DIV     @V+18,,AUTO
         2 000635   000000 620006                    EAX0    0,QL
         2 000636   200104 740100                    STX0    TRACK,,AUTO

      284    11377    5                    TRACK=(TRACK/VIP.NHEADS)*(IV_CYLM-VIP.NHEADS)+TRACK;

  11377  2 000637   100014 236100                    LDQ     12,,PR1
         2 000640   000022 772000                    QRL     18
         2 000641   000777 376007                    ANQ     511,DL
         2 000642   200144 756100                    STQ     @V+17,,AUTO
         2 000643   200104 236100                    LDQ     TRACK,,AUTO
         2 000644   000022 772000                    QRL     18
         2 000645   200144 506100                    DIV     @V+17,,AUTO
         2 000646   200145 756100                    STQ     @V+18,,AUTO
         2 000647   100014 236100                    LDQ     12,,PR1
         2 000650   000022 772000                    QRL     18
         2 000651   000777 376007                    ANQ     511,DL
         2 000652   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 000653   000401 036007                    ADLQ    257,DL
         2 000654   200146 756100                    STQ     @V+19,,AUTO
         2 000655   200145 236100                    LDQ     @V+18,,AUTO
         2 000656   200146 402100                    MPY     @V+19,,AUTO
         2 000657   200104 235100                    LDA     TRACK,,AUTO
         2 000660   000022 771000                    ARL     18
         2 000661   200147 755100                    STA     @V+20,,AUTO
         2 000662   200147 036100                    ADLQ    @V+20,,AUTO
         2 000663   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:62   
         2 000664   200104 741100                    STX1    TRACK,,AUTO

      285    11378    6                    IF TRACK>=(VIP.T@DCYL+1)*IV_CYLM THEN DO;

  11378  2 000665   100015 236100                    LDQ     13,,PR1
         2 000666   000012 772000                    QRL     10
         2 000667   000022 376000 3                  ANQ     18
         2 000670   000400 036007                    ADLQ    256,DL
         2 000671   200144 756100                    STQ     @V+17,,AUTO
         2 000672   200104 236100                    LDQ     TRACK,,AUTO
         2 000673   000022 772000                    QRL     18
         2 000674   200144 116100                    CMPQ    @V+17,,AUTO
         2 000675   000710 604000 2                  TMI     s:11383

      286    11379    6   CCHH_ERR:
      287    11380    6                       CALL IVV$ERROR(VIP.DEVID,3);

  11380  2 000676   000023 236000 3     CCHH_ERR     LDQ     19
         2 000677   200145 756100                    STQ     @V+18,,AUTO
         2 000700   200110 236100                    LDQ     VI$,,AUTO
         2 000701   000005 036003                    ADLQ    5,DU
         2 000702   200144 756100                    STQ     @V+17,,AUTO
         2 000703   200144 630500                    EPPR0   @V+17,,AUTO
         2 000704   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000705   000000 701000 xent               TSX1    IVV$ERROR
         2 000706   000000 011000                    NOP     0

      288    11381    6                       GOTO DEL_VI;

  11381  2 000707   004312 710000 2                  TRA     DEL_VI

      289    11382    6                       END;
      290    11383    5                    VIP.RANGE.FTRACK(VIP.NRANGES)=TRACK;

  11383  2 000710   100020 236100                    LDQ     16,,PR1
         2 000711   000033 772000                    QRL     27
         2 000712   100024 741106                    STX1    20,QL,PR1
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:63   

      291    11384    5                    END/* IF HH */;

  11384  2 000713   000736 710000 2                  TRA     s:11389

      292    11385    5                 ELSE DO;

      293    11386    5                    IF CC>=(VIP.T@DCYL+1) OR HH>=VIP.NHEADS THEN GOTO CCHH_ERR;

  11386  2 000714   200110 470500                    LDP0    VI$,,AUTO
         2 000715   000015 236100                    LDQ     13,,PR0
         2 000716   000022 772000                    QRL     18
         2 000717   200013 116100                    CMPQ    CC,,AUTO
         2 000720   000676 604000 2                  TMI     CCHH_ERR
         2 000721   000014 236100                    LDQ     12,,PR0
         2 000722   000022 772000                    QRL     18
         2 000723   000777 376007                    ANQ     511,DL
         2 000724   200024 116100                    CMPQ    HH,,AUTO
         2 000725   000676 604400 2                  TMOZ    CCHH_ERR

      294    11387    5                    VIP.RANGE.FTRACK(VIP.NRANGES)=CC*IV_CYLM+HH;

  11387  2 000726   000020 236100                    LDQ     16,,PR0
         2 000727   000033 772000                    QRL     27
         2 000730   000000 620006                    EAX0    0,QL
         2 000731   200013 236100                    LDQ     CC,,AUTO
         2 000732   000010 736000                    QLS     8
         2 000733   200024 036100                    ADLQ    HH,,AUTO
         2 000734   000000 621006                    EAX1    0,QL
         2 000735   000024 741110                    STX1    20,X0,PR0

      295    11388    5                    END;

      296    11389    4                 IF OPT$->OUT$BLK.NSUBLKS=2 THEN

  11389  2 000736   200035 470500                    LDP0    OPT$,,AUTO
         2 000737   000001 220100                    LDX0    1,,PR0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:64   
         2 000740   000002 100003                    CMPX0   2,DU
         2 000741   000761 601000 2                  TNZ     s:11392

      297    11390    4                    VIP.RANGE.LTRACK(VIP.NRANGES)=VIP.T@DCYL*IV_CYLM+VIP.NHEADS-1;

  11390  2 000742   200110 471500                    LDP1    VI$,,AUTO
         2 000743   100020 236100                    LDQ     16,,PR1
         2 000744   000033 772000                    QRL     27
         2 000745   000000 621006                    EAX1    0,QL
         2 000746   100014 236100                    LDQ     12,,PR1
         2 000747   000022 772000                    QRL     18
         2 000750   000777 376007                    ANQ     511,DL
         2 000751   200144 756100                    STQ     @V+17,,AUTO
         2 000752   100015 236100                    LDQ     13,,PR1
         2 000753   000012 772000                    QRL     10
         2 000754   000022 376000 3                  ANQ     18
         2 000755   200144 036100                    ADLQ    @V+17,,AUTO
         2 000756   777777 620006                    EAX0    -1,QL
         2 000757   100024 440111                    SXL0    20,X1,PR1
         2 000760   001104 710000 2                  TRA     s:11405

      298    11391    5                 ELSE DO;

      299    11392    5                    IF OPT$->OUT$BLK.NSUBLKS=3 THEN

  11392  2 000761   000003 100003                    CMPX0   3,DU
         2 000762   000774 601000 2                  TNZ     s:11394

      300    11393    5                       CALL DECBIN(OPT$->OUT$BLK.SUBLK$(2)->OUT$SYM.COUNT,CC,HH);

  11393  2 000763   000005 471500                    LDP1    5,,PR0
         2 000764   200024 633500                    EPPR3   HH,,AUTO
         2 000765   200117 453500                    STP3    HH+1,,AUTO
         2 000766   200013 634500                    EPPR4   CC,,AUTO
         2 000767   200116 454500                    STP4    @SECTOR+1,,AUTO
         2 000770   100004 635500                    EPPR5   4,,PR1
         2 000771   200115 455500                    STP5    VIP$+3,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:65   
         2 000772   005331 701000 2                  TSX1    DECBIN
         2 000773   000000 011000                    NOP     0

      301    11394    6                    IF HH<0 THEN DO;

  11394  2 000774   200024 235100                    LDA     HH,,AUTO
         2 000775   001062 605000 2                  TPL     s:11401

      302    11395    6                       TRACK=((CC+1)*DVT.GRANSIZE-1)/VIP.NSECTS;

  11395  2 000776   200020 470500                    LDP0    DVT$,,AUTO
         2 000777   000053 236100                    LDQ     43,,PR0
         2 001000   000777 376007                    ANQ     511,DL
         2 001001   200144 756100                    STQ     @V+17,,AUTO
         2 001002   200013 236100                    LDQ     CC,,AUTO
         2 001003   000001 036007                    ADLQ    1,DL
         2 001004   200144 402100                    MPY     @V+17,,AUTO
         2 001005   200110 471500                    LDP1    VI$,,AUTO
         2 001006   200145 756100                    STQ     @V+18,,AUTO
         2 001007   100014 236100                    LDQ     12,,PR1
         2 001010   000033 772000                    QRL     27
         2 001011   200146 756100                    STQ     @V+19,,AUTO
         2 001012   200145 236100                    LDQ     @V+18,,AUTO
         2 001013   000001 136007                    SBLQ    1,DL
         2 001014   200146 506100                    DIV     @V+19,,AUTO
         2 001015   000000 620006                    EAX0    0,QL
         2 001016   200104 740100                    STX0    TRACK,,AUTO

      303    11396    6                       TRACK=(TRACK/VIP.NHEADS)*(IV_CYLM-VIP.NHEADS)+TRACK;

  11396  2 001017   100014 236100                    LDQ     12,,PR1
         2 001020   000022 772000                    QRL     18
         2 001021   000777 376007                    ANQ     511,DL
         2 001022   200144 756100                    STQ     @V+17,,AUTO
         2 001023   200104 236100                    LDQ     TRACK,,AUTO
         2 001024   000022 772000                    QRL     18
         2 001025   200144 506100                    DIV     @V+17,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:66   
         2 001026   200145 756100                    STQ     @V+18,,AUTO
         2 001027   100014 236100                    LDQ     12,,PR1
         2 001030   000022 772000                    QRL     18
         2 001031   000777 376007                    ANQ     511,DL
         2 001032   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 001033   000401 036007                    ADLQ    257,DL
         2 001034   200146 756100                    STQ     @V+19,,AUTO
         2 001035   200145 236100                    LDQ     @V+18,,AUTO
         2 001036   200146 402100                    MPY     @V+19,,AUTO
         2 001037   200104 235100                    LDA     TRACK,,AUTO
         2 001040   000022 771000                    ARL     18
         2 001041   200147 755100                    STA     @V+20,,AUTO
         2 001042   200147 036100                    ADLQ    @V+20,,AUTO
         2 001043   000000 621006                    EAX1    0,QL
         2 001044   200104 741100                    STX1    TRACK,,AUTO

      304    11397    6                       IF TRACK>=(VIP.T@DCYL+1)*IV_CYLM THEN GOTO CCHH_ERR;

  11397  2 001045   100015 236100                    LDQ     13,,PR1
         2 001046   000012 772000                    QRL     10
         2 001047   000022 376000 3                  ANQ     18
         2 001050   000400 036007                    ADLQ    256,DL
         2 001051   200144 756100                    STQ     @V+17,,AUTO
         2 001052   200104 236100                    LDQ     TRACK,,AUTO
         2 001053   000022 772000                    QRL     18
         2 001054   200144 116100                    CMPQ    @V+17,,AUTO
         2 001055   000676 605000 2                  TPL     CCHH_ERR

      305    11398    6                       VIP.RANGE.LTRACK(VIP.NRANGES)=TRACK;

  11398  2 001056   100020 236100                    LDQ     16,,PR1
         2 001057   000033 772000                    QRL     27
         2 001060   100024 441106                    SXL1    20,QL,PR1

      306    11399    6                       END;

  11399  2 001061   001104 710000 2                  TRA     s:11405
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:67   

      307    11400    6                    ELSE DO;

      308    11401    6                       IF CC>VIP.T@DCYL OR HH>=VIP.NHEADS THEN GOTO CCHH_ERR;

  11401  2 001062   200110 470500                    LDP0    VI$,,AUTO
         2 001063   000015 236100                    LDQ     13,,PR0
         2 001064   000022 772000                    QRL     18
         2 001065   200013 116100                    CMPQ    CC,,AUTO
         2 001066   000676 604000 2                  TMI     CCHH_ERR
         2 001067   000014 236100                    LDQ     12,,PR0
         2 001070   000022 772000                    QRL     18
         2 001071   000777 376007                    ANQ     511,DL
         2 001072   200024 116100                    CMPQ    HH,,AUTO
         2 001073   000676 604400 2                  TMOZ    CCHH_ERR

      309    11402    6                       VIP.RANGE.LTRACK(VIP.NRANGES)=CC*IV_CYLM+HH;

  11402  2 001074   000020 236100                    LDQ     16,,PR0
         2 001075   000033 772000                    QRL     27
         2 001076   000000 620006                    EAX0    0,QL
         2 001077   200013 236100                    LDQ     CC,,AUTO
         2 001100   000010 736000                    QLS     8
         2 001101   200024 036100                    ADLQ    HH,,AUTO
         2 001102   000000 621006                    EAX1    0,QL
         2 001103   000024 441110                    SXL1    20,X0,PR0

      310    11403    6                       END;

      311    11404    5                    END/* IF OPT$->OUT$BLK.NSUBLKS=2 ELSE */;

      312    11405    4                 IF VIP.RANGE.LTRACK(VIP.NRANGES)<VIP.RANGE.FTRACK(VIP.NRANGES) THEN
             11405                          GOTO CCHH_ERR;

  11405  2 001104   200110 470500                    LDP0    VI$,,AUTO
         2 001105   000020 236100                    LDQ     16,,PR0
         2 001106   000033 772000                    QRL     27
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:68   
         2 001107   000024 720106                    LXL0    20,QL,PR0
         2 001110   000024 100106                    CMPX0   20,QL,PR0
         2 001111   000676 602000 2                  TNC     CCHH_ERR

      313    11406    4                 VIP.NRANGES=VIP.NRANGES+1;

  11406  2 001112   000020 236100                    LDQ     16,,PR0
         2 001113   001000 036003                    ADLQ    512,DU
         2 001114   000020 552140                    STBQ    16,'40'O,PR0

      314    11407    4               END/* CASE OPT$->OUT$BLK.CODE */;

      315    11408    3              END/* DO I */;

  11408  2 001115   200027 054100                    AOS     I,,AUTO
         2 001116   200011 470500                    LDP0    BLK$,,AUTO
         2 001117   000001 236100                    LDQ     1,,PR0
         2 001120   000022 772000                    QRL     18
         2 001121   200027 116100                    CMPQ    I,,AUTO
         2 001122   000454 605400 2                  TPNZ    s:11343

      316    11409    3           DO SELECT(VIP.MODEL);

  11409  2 001123   200110 471500                    LDP1    VI$,,AUTO
         2 001124   040000 106500                    CMPC    fill='040'O
         2 001125   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         2 001126   000115 000010 1                  ADSC9   DTTLINE+15               cn=0,n=8
         2 001127   001162 602000 2                  TNC     s:11409+31
         2 001130   001220 600000 2                  TZE     s:11413
         2 001131   040000 106500                    CMPC    fill='040'O
         2 001132   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         2 001133   000117 000010 1                  ADSC9   DTTLINE+17               cn=0,n=8
         2 001134   001143 602000 2                  TNC     s:11409+16
         2 001135   001220 600000 2                  TZE     s:11413
         2 001136   040000 106500                    CMPC    fill='040'O
         2 001137   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         2 001140   000121 000010 1                  ADSC9   DTTLINE+19               cn=0,n=8
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:69   
         2 001141   001514 601000 2                  TNZ     s:11469
         2 001142   001220 710000 2                  TRA     s:11413
         2 001143   040000 106500                    CMPC    fill='040'O
         2 001144   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         2 001145   000123 000010 1                  ADSC9   DTTLINE+21               cn=0,n=8
         2 001146   001155 602000 2                  TNC     s:11409+26
         2 001147   001220 600000 2                  TZE     s:11413
         2 001150   040000 106500                    CMPC    fill='040'O
         2 001151   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         2 001152   000125 000010 1                  ADSC9   DTTLINE+23               cn=0,n=8
         2 001153   001514 601000 2                  TNZ     s:11469
         2 001154   001220 710000 2                  TRA     s:11413
         2 001155   040000 106500                    CMPC    fill='040'O
         2 001156   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         2 001157   000127 000010 1                  ADSC9   DTTLINE+25               cn=0,n=8
         2 001160   001514 601000 2                  TNZ     s:11469
         2 001161   001220 710000 2                  TRA     s:11413
         2 001162   040000 106500                    CMPC    fill='040'O
         2 001163   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         2 001164   000131 000010 1                  ADSC9   DTTLINE+27               cn=0,n=8
         2 001165   001201 602000 2                  TNC     s:11409+46
         2 001166   001220 600000 2                  TZE     s:11413
         2 001167   040000 106500                    CMPC    fill='040'O
         2 001170   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         2 001171   000133 000010 1                  ADSC9   DTTLINE+29               cn=0,n=8
         2 001172   001514 602000 2                  TNC     s:11469
         2 001173   001220 600000 2                  TZE     s:11413
         2 001174   040000 106500                    CMPC    fill='040'O
         2 001175   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         2 001176   000135 000010 1                  ADSC9   DTTLINE+31               cn=0,n=8
         2 001177   001514 601000 2                  TNZ     s:11469
         2 001200   001220 710000 2                  TRA     s:11413
         2 001201   040000 106500                    CMPC    fill='040'O
         2 001202   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         2 001203   000141 000010 1                  ADSC9   DTTLINE+35               cn=0,n=8
         2 001204   001213 602000 2                  TNC     s:11409+56
         2 001205   001407 600000 2                  TZE     s:11448
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:70   
         2 001206   040000 106500                    CMPC    fill='040'O
         2 001207   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         2 001210   000137 000010 1                  ADSC9   DTTLINE+33               cn=0,n=8
         2 001211   001514 601000 2                  TNZ     s:11469
         2 001212   001220 710000 2                  TRA     s:11413
         2 001213   040000 106500                    CMPC    fill='040'O
         2 001214   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         2 001215   000143 000010 1                  ADSC9   DTTLINE+37               cn=0,n=8
         2 001216   001514 601000 2                  TNZ     s:11469
         2 001217   001407 710000 2                  TRA     s:11448

      317    11410    3              SELECT ('MSU8082 ','MSU8092 ','MSU3380 ','MSU3382 ',

      318    11411    3                'MSU3390 ','MSU3392 ','MSU3391 ','MSU3393 ',
      319    11412    3                'MSU3381 ','MSU3383 ');
      320    11413    3              ERROR_CNT = 0;

  11413  2 001220   200026 450100                    STZ     ERROR_CNT,,AUTO

      321    11414    4              IF VIP.DTT = #OLD OR VIP.DTT = #UPDATE THEN DO;

  11414  2 001221   100017 236100                    LDQ     15,,PR1
         2 001222   000007 316003                    CANQ    7,DU
         2 001223   001230 600000 2                  TZE     s:11415
         2 001224   100017 236100                    LDQ     15,,PR1
         2 001225   000007 376003                    ANQ     7,DU
         2 001226   000001 116003                    CMPQ    1,DU
         2 001227   001242 601000 2                  TNZ     s:11418

      322    11415    4                 CALL IVV$ERROR(VIP.DEVID,20); /* DTT=NEW MUST BE  SPECIFIED */

  11415  2 001230   000025 236000 3                  LDQ     21
         2 001231   200145 756100                    STQ     @V+18,,AUTO
         2 001232   200110 236100                    LDQ     VI$,,AUTO
         2 001233   000005 036003                    ADLQ    5,DU
         2 001234   200144 756100                    STQ     @V+17,,AUTO
         2 001235   200144 630500                    EPPR0   @V+17,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:71   
         2 001236   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001237   000000 701000 xent               TSX1    IVV$ERROR
         2 001240   000000 011000                    NOP     0

      323    11416    4                 ERROR_CNT = ERROR_CNT +1;

  11416  2 001241   200026 054100                    AOS     ERROR_CNT,,AUTO

      324    11417    4                 END;

      325    11418    4              IF VIP.FORMAT = '1'B THEN DO;

  11418  2 001242   200110 470500                    LDP0    VI$,,AUTO
         2 001243   000017 236100                    LDQ     15,,PR0
         2 001244   400000 316007                    CANQ    -131072,DL
         2 001245   001260 600000 2                  TZE     s:11422

      326    11419    4                 CALL IVV$ERROR(VIP.DEVID,21);
             11419                          /* FORMAT NOT ALLOWED FOR FIPS OR MDS DISCS */

  11419  2 001246   000027 236000 3                  LDQ     23
         2 001247   200145 756100                    STQ     @V+18,,AUTO
         2 001250   200110 236100                    LDQ     VI$,,AUTO
         2 001251   000005 036003                    ADLQ    5,DU
         2 001252   200144 756100                    STQ     @V+17,,AUTO
         2 001253   200144 630500                    EPPR0   @V+17,,AUTO
         2 001254   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001255   000000 701000 xent               TSX1    IVV$ERROR
         2 001256   000000 011000                    NOP     0

      327    11420    4                 ERROR_CNT = ERROR_CNT +1;

  11420  2 001257   200026 054100                    AOS     ERROR_CNT,,AUTO

      328    11421    4                 END;

      329    11422    4              IF VIP.VERIFY = '1'B THEN DO;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:72   

  11422  2 001260   200110 470500                    LDP0    VI$,,AUTO
         2 001261   000017 236100                    LDQ     15,,PR0
         2 001262   200000 316007                    CANQ    65536,DL
         2 001263   001276 600000 2                  TZE     s:11426

      330    11423    4                 CALL IVV$ERROR(VIP.DEVID,22);
             11423                          /* VERIFY NOT ALLOWED FOR FIPS OR MDS DISCS */

  11423  2 001264   000031 236000 3                  LDQ     25
         2 001265   200145 756100                    STQ     @V+18,,AUTO
         2 001266   200110 236100                    LDQ     VI$,,AUTO
         2 001267   000005 036003                    ADLQ    5,DU
         2 001270   200144 756100                    STQ     @V+17,,AUTO
         2 001271   200144 630500                    EPPR0   @V+17,,AUTO
         2 001272   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001273   000000 701000 xent               TSX1    IVV$ERROR
         2 001274   000000 011000                    NOP     0

      331    11424    4                 ERROR_CNT = ERROR_CNT +1;

  11424  2 001275   200026 054100                    AOS     ERROR_CNT,,AUTO

      332    11425    4                 END;

      333    11426    4              IF VIP.TEST = '1'B THEN DO;

  11426  2 001276   200110 470500                    LDP0    VI$,,AUTO
         2 001277   000017 236100                    LDQ     15,,PR0
         2 001300   100000 316007                    CANQ    32768,DL
         2 001301   001314 600000 2                  TZE     s:11430

      334    11427    4                 CALL IVV$ERROR(VIP.DEVID,23);
             11427                          /* TEST NOT ALLOWED FOR FIPS OR MDS DISCS */

  11427  2 001302   000033 236000 3                  LDQ     27
         2 001303   200145 756100                    STQ     @V+18,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:73   
         2 001304   200110 236100                    LDQ     VI$,,AUTO
         2 001305   000005 036003                    ADLQ    5,DU
         2 001306   200144 756100                    STQ     @V+17,,AUTO
         2 001307   200144 630500                    EPPR0   @V+17,,AUTO
         2 001310   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001311   000000 701000 xent               TSX1    IVV$ERROR
         2 001312   000000 011000                    NOP     0

      335    11428    4                 ERROR_CNT = ERROR_CNT +1;

  11428  2 001313   200026 054100                    AOS     ERROR_CNT,,AUTO

      336    11429    4                 END;

      337    11430    4              IF VIP.SCRATCH = '0'B THEN DO;

  11430  2 001314   200110 470500                    LDP0    VI$,,AUTO
         2 001315   000017 236100                    LDQ     15,,PR0
         2 001316   000400 316007                    CANQ    256,DL
         2 001317   001332 601000 2                  TNZ     s:11434

      338    11431    4                 CALL IVV$ERROR(VIP.DEVID,24);
             11431                          /* SCRATCH MUST BE SPECIFIED FOR FIPS OR MDS DISCS */

  11431  2 001320   000035 236000 3                  LDQ     29
         2 001321   200145 756100                    STQ     @V+18,,AUTO
         2 001322   200110 236100                    LDQ     VI$,,AUTO
         2 001323   000005 036003                    ADLQ    5,DU
         2 001324   200144 756100                    STQ     @V+17,,AUTO
         2 001325   200144 630500                    EPPR0   @V+17,,AUTO
         2 001326   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001327   000000 701000 xent               TSX1    IVV$ERROR
         2 001330   000000 011000                    NOP     0

      339    11432    4                 ERROR_CNT = ERROR_CNT +1;

  11432  2 001331   200026 054100                    AOS     ERROR_CNT,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:74   

      340    11433    4                 END;

      341    11434    4              IF VIP.NEWDTS = '1'B THEN DO;

  11434  2 001332   200110 470500                    LDP0    VI$,,AUTO
         2 001333   000017 236100                    LDQ     15,,PR0
         2 001334   040000 316007                    CANQ    16384,DL
         2 001335   001350 600000 2                  TZE     s:11438

      342    11435    4                 CALL IVV$ERROR(VIP.DEVID,25);
             11435                          /* NEWDTS NOT ALLOWED FOR FIPS OR MDS DISCS */

  11435  2 001336   000037 236000 3                  LDQ     31
         2 001337   200145 756100                    STQ     @V+18,,AUTO
         2 001340   200110 236100                    LDQ     VI$,,AUTO
         2 001341   000005 036003                    ADLQ    5,DU
         2 001342   200144 756100                    STQ     @V+17,,AUTO
         2 001343   200144 630500                    EPPR0   @V+17,,AUTO
         2 001344   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001345   000000 701000 xent               TSX1    IVV$ERROR
         2 001346   000000 011000                    NOP     0

      343    11436    4                 ERROR_CNT = ERROR_CNT +1;

  11436  2 001347   200026 054100                    AOS     ERROR_CNT,,AUTO

      344    11437    4                 END;

      345    11438    4              IF VIP.NRANGES > 0 THEN DO;

  11438  2 001350   200110 470500                    LDP0    VI$,,AUTO
         2 001351   000020 236100                    LDQ     16,,PR0
         2 001352   777000 316003                    CANQ    -512,DU
         2 001353   001366 600000 2                  TZE     s:11442

      346    11439    4                 CALL IVV$ERROR(VIP.DEVID,26);
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:75   
             11439                          /*  RANGE SPECIFICAION NOT ALLOWED FOR FIPS OR MDS DISCS */

  11439  2 001354   000041 236000 3                  LDQ     33
         2 001355   200145 756100                    STQ     @V+18,,AUTO
         2 001356   200110 236100                    LDQ     VI$,,AUTO
         2 001357   000005 036003                    ADLQ    5,DU
         2 001360   200144 756100                    STQ     @V+17,,AUTO
         2 001361   200144 630500                    EPPR0   @V+17,,AUTO
         2 001362   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001363   000000 701000 xent               TSX1    IVV$ERROR
         2 001364   000000 011000                    NOP     0

      347    11440    4                 ERROR_CNT = ERROR_CNT +1;

  11440  2 001365   200026 054100                    AOS     ERROR_CNT,,AUTO

      348    11441    4                 END;

      349    11442    4              IF VIP.ALT = '1'B THEN DO;

  11442  2 001366   200110 470500                    LDP0    VI$,,AUTO
         2 001367   000017 236100                    LDQ     15,,PR0
         2 001370   000200 316007                    CANQ    128,DL
         2 001371   001404 600000 2                  TZE     s:11446

      350    11443    4                 CALL IVV$ERROR(VIP.DEVID,36);
             11443                          /* ALT NOT ALLOWED  FOR FIPS OR MDS DISCS */

  11443  2 001372   000043 236000 3                  LDQ     35
         2 001373   200145 756100                    STQ     @V+18,,AUTO
         2 001374   200110 236100                    LDQ     VI$,,AUTO
         2 001375   000005 036003                    ADLQ    5,DU
         2 001376   200144 756100                    STQ     @V+17,,AUTO
         2 001377   200144 630500                    EPPR0   @V+17,,AUTO
         2 001400   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001401   000000 701000 xent               TSX1    IVV$ERROR
         2 001402   000000 011000                    NOP     0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:76   

      351    11444    4                 ERROR_CNT = ERROR_CNT + 1;

  11444  2 001403   200026 054100                    AOS     ERROR_CNT,,AUTO

      352    11445    4                 END;

      353    11446    3              IF ERROR_CNT > 0 THEN GOTO DEL_VI;

  11446  2 001404   200026 235100                    LDA     ERROR_CNT,,AUTO
         2 001405   004312 605400 2                  TPNZ    DEL_VI
         2 001406   001605 710000 2                  TRA     s:11486

      354    11447    3              SELECT ('MSU0501 ','MSU0509 ');

      355    11448    4              IF VIP.FORMAT = '1'B THEN DO;

  11448  2 001407   100017 236100                    LDQ     15,,PR1
         2 001410   400000 316007                    CANQ    -131072,DL
         2 001411   001424 600000 2                  TZE     s:11452

      356    11449    4                 CALL IVV$ERROR(VIP.DEVID,21); /* FORMAT NOT ALLOWED FOR 501 DISCS */

  11449  2 001412   000027 236000 3                  LDQ     23
         2 001413   200145 756100                    STQ     @V+18,,AUTO
         2 001414   200110 236100                    LDQ     VI$,,AUTO
         2 001415   000005 036003                    ADLQ    5,DU
         2 001416   200144 756100                    STQ     @V+17,,AUTO
         2 001417   200144 630500                    EPPR0   @V+17,,AUTO
         2 001420   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001421   000000 701000 xent               TSX1    IVV$ERROR
         2 001422   000000 011000                    NOP     0

      357    11450    4                 GOTO NEXT_CMD;

  11450  2 001423   000061 710000 2                  TRA     NEXT_CMD

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:77   
      358    11451    4                 END;
      359    11452    4              IF VIP.ALT = '1'B AND VIP.FORMAT = '1'B THEN DO;

  11452  2 001424   000200 316007                    CANQ    128,DL
         2 001425   001442 600000 2                  TZE     s:11456
         2 001426   400000 316007                    CANQ    -131072,DL
         2 001427   001442 600000 2                  TZE     s:11456

      360    11453    4                 CALL IVV$ERROR(VIP.DEVID,37);

  11453  2 001430   000045 236000 3                  LDQ     37
         2 001431   200145 756100                    STQ     @V+18,,AUTO
         2 001432   200110 236100                    LDQ     VI$,,AUTO
         2 001433   000005 036003                    ADLQ    5,DU
         2 001434   200144 756100                    STQ     @V+17,,AUTO
         2 001435   200144 630500                    EPPR0   @V+17,,AUTO
         2 001436   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001437   000000 701000 xent               TSX1    IVV$ERROR
         2 001440   000000 011000                    NOP     0

      361    11454    4                 GOTO NEXT_CMD;

  11454  2 001441   000061 710000 2                  TRA     NEXT_CMD

      362    11455    4                 END;
      363    11456    4              IF VIP.ALT = '1'B AND VIP.NEWDTS = '1'B THEN DO;

  11456  2 001442   000200 316007                    CANQ    128,DL
         2 001443   001460 600000 2                  TZE     s:11460
         2 001444   040000 316007                    CANQ    16384,DL
         2 001445   001460 600000 2                  TZE     s:11460

      364    11457    4                 CALL IVV$ERROR(VIP.DEVID,38);

  11457  2 001446   000047 236000 3                  LDQ     39
         2 001447   200145 756100                    STQ     @V+18,,AUTO
         2 001450   200110 236100                    LDQ     VI$,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:78   
         2 001451   000005 036003                    ADLQ    5,DU
         2 001452   200144 756100                    STQ     @V+17,,AUTO
         2 001453   200144 630500                    EPPR0   @V+17,,AUTO
         2 001454   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001455   000000 701000 xent               TSX1    IVV$ERROR
         2 001456   000000 011000                    NOP     0

      365    11458    4                 GOTO NEXT_CMD;

  11458  2 001457   000061 710000 2                  TRA     NEXT_CMD

      366    11459    4                 END;
      367    11460    4              IF VIP.ALT = '1'B AND VIP.NRANGES > 0 THEN DO;

  11460  2 001460   000200 316007                    CANQ    128,DL
         2 001461   001477 600000 2                  TZE     s:11464
         2 001462   100020 236100                    LDQ     16,,PR1
         2 001463   777000 316003                    CANQ    -512,DU
         2 001464   001477 600000 2                  TZE     s:11464

      368    11461    4                 CALL IVV$ERROR(VIP.DEVID,39);

  11461  2 001465   000051 236000 3                  LDQ     41
         2 001466   200145 756100                    STQ     @V+18,,AUTO
         2 001467   200110 236100                    LDQ     VI$,,AUTO
         2 001470   000005 036003                    ADLQ    5,DU
         2 001471   200144 756100                    STQ     @V+17,,AUTO
         2 001472   200144 630500                    EPPR0   @V+17,,AUTO
         2 001473   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001474   000000 701000 xent               TSX1    IVV$ERROR
         2 001475   000000 011000                    NOP     0

      369    11462    4                 GOTO NEXT_CMD;

  11462  2 001476   000061 710000 2                  TRA     NEXT_CMD

      370    11463    4                 END;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:79   
      371    11464    4              IF VIP.TEST = '0'B THEN DO;

  11464  2 001477   100017 236100                    LDQ     15,,PR1
         2 001500   100000 316007                    CANQ    32768,DL
         2 001501   001605 601000 2                  TNZ     s:11486

      372    11465    4                 CALL IVV$ERROR(VIP.DEVID,35); /* NOTEST NOT ALLOWED FOR 501 DISCS */

  11465  2 001502   000053 236000 3                  LDQ     43
         2 001503   200145 756100                    STQ     @V+18,,AUTO
         2 001504   200110 236100                    LDQ     VI$,,AUTO
         2 001505   000005 036003                    ADLQ    5,DU
         2 001506   200144 756100                    STQ     @V+17,,AUTO
         2 001507   200144 630500                    EPPR0   @V+17,,AUTO
         2 001510   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001511   000000 701000 xent               TSX1    IVV$ERROR
         2 001512   000000 011000                    NOP     0

      373    11466    4                 GOTO NEXT_CMD;

  11466  2 001513   000061 710000 2                  TRA     NEXT_CMD

      374    11467    4                 END;
      375    11468    3              SELECT (ELSE);               /* 451 DISCS */

      376    11469    4           IF VIP.ALT = '1'B AND VIP.FORMAT = '1'B THEN DO;

  11469  2 001514   100017 236100                    LDQ     15,,PR1
         2 001515   000200 316007                    CANQ    128,DL
         2 001516   001533 600000 2                  TZE     s:11473
         2 001517   400000 316007                    CANQ    -131072,DL
         2 001520   001533 600000 2                  TZE     s:11473

      377    11470    4              CALL IVV$ERROR(VIP.DEVID,37);

  11470  2 001521   000045 236000 3                  LDQ     37
         2 001522   200145 756100                    STQ     @V+18,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:80   
         2 001523   200110 236100                    LDQ     VI$,,AUTO
         2 001524   000005 036003                    ADLQ    5,DU
         2 001525   200144 756100                    STQ     @V+17,,AUTO
         2 001526   200144 630500                    EPPR0   @V+17,,AUTO
         2 001527   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001530   000000 701000 xent               TSX1    IVV$ERROR
         2 001531   000000 011000                    NOP     0

      378    11471    4              GOTO NEXT_CMD;

  11471  2 001532   000061 710000 2                  TRA     NEXT_CMD

      379    11472    4              END;
      380    11473    4           IF VIP.ALT = '1'B AND VIP.NEWDTS = '1'B THEN DO;

  11473  2 001533   000200 316007                    CANQ    128,DL
         2 001534   001551 600000 2                  TZE     s:11477
         2 001535   040000 316007                    CANQ    16384,DL
         2 001536   001551 600000 2                  TZE     s:11477

      381    11474    4              CALL IVV$ERROR(VIP.DEVID,38);

  11474  2 001537   000047 236000 3                  LDQ     39
         2 001540   200145 756100                    STQ     @V+18,,AUTO
         2 001541   200110 236100                    LDQ     VI$,,AUTO
         2 001542   000005 036003                    ADLQ    5,DU
         2 001543   200144 756100                    STQ     @V+17,,AUTO
         2 001544   200144 630500                    EPPR0   @V+17,,AUTO
         2 001545   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001546   000000 701000 xent               TSX1    IVV$ERROR
         2 001547   000000 011000                    NOP     0

      382    11475    4              GOTO NEXT_CMD;

  11475  2 001550   000061 710000 2                  TRA     NEXT_CMD

      383    11476    4              END;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:81   
      384    11477    4           IF VIP.ALT = '1'B AND VIP.NRANGES > 0 THEN DO;

  11477  2 001551   000200 316007                    CANQ    128,DL
         2 001552   001570 600000 2                  TZE     s:11481
         2 001553   100020 236100                    LDQ     16,,PR1
         2 001554   777000 316003                    CANQ    -512,DU
         2 001555   001570 600000 2                  TZE     s:11481

      385    11478    4              CALL IVV$ERROR(VIP.DEVID,39);

  11478  2 001556   000051 236000 3                  LDQ     41
         2 001557   200145 756100                    STQ     @V+18,,AUTO
         2 001560   200110 236100                    LDQ     VI$,,AUTO
         2 001561   000005 036003                    ADLQ    5,DU
         2 001562   200144 756100                    STQ     @V+17,,AUTO
         2 001563   200144 630500                    EPPR0   @V+17,,AUTO
         2 001564   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001565   000000 701000 xent               TSX1    IVV$ERROR
         2 001566   000000 011000                    NOP     0

      386    11479    4              GOTO NEXT_CMD;

  11479  2 001567   000061 710000 2                  TRA     NEXT_CMD

      387    11480    4              END;
      388    11481    4           IF VIP.FORMAT='0'B AND VIP.TEST='0'B THEN DO;

  11481  2 001570   100017 236100                    LDQ     15,,PR1
         2 001571   400000 316007                    CANQ    -131072,DL
         2 001572   001605 601000 2                  TNZ     s:11486
         2 001573   100000 316007                    CANQ    32768,DL
         2 001574   001605 601000 2                  TNZ     s:11486

      389    11482    4              CALL IVV$ERROR(,14);         /* PLS SPECIFY FORMAT OR TEST */

  11482  2 001575   000055 236000 3                  LDQ     45
         2 001576   000001 235000 xsym               LDA     B_VECTNIL+1
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:82   
         2 001577   200144 757100                    STAQ    @V+17,,AUTO
         2 001600   200144 630500                    EPPR0   @V+17,,AUTO
         2 001601   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001602   000000 701000 xent               TSX1    IVV$ERROR
         2 001603   000000 011000                    NOP     0

      390    11483    4              GOTO NEXT_CMD;

  11483  2 001604   000061 710000 2                  TRA     NEXT_CMD

      391    11484    4              END;
      392    11485    3              END;                         /* DO SELECT (VIP.MODEL) */

      393    11486    2           CALL IVO$GET(VID$,1024) ALTRET(NO_SPACE_1);

  11486  2 001605   000057 236000 3                  LDQ     47
         2 001606   200145 756100                    STQ     @V+18,,AUTO
         2 001607   200111 630500                    EPPR0   VID$,,AUTO
         2 001610   200144 450500                    STP0    @V+17,,AUTO
         2 001611   200144 630500                    EPPR0   @V+17,,AUTO
         2 001612   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001613   000000 701000 xent               TSX1    IVO$GET
         2 001614   004267 702000 2                  TSX2    NO_SPACE_1

      394    11487    2           VIP.VID$=VID$;

  11487  2 001615   200111 236100                    LDQ     VID$,,AUTO
         2 001616   200110 470500                    LDP0    VI$,,AUTO
         2 001617   000012 756100                    STQ     10,,PR0

      395    11488    2           IF VIP.MODEL ~= 'MSU0451 ' THEN

  11488  2 001620   200110 470500                    LDP0    VI$,,AUTO
         2 001621   040000 106500                    CMPC    fill='040'O
         2 001622   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 001623   000145 000010 1                  ADSC9   DTTLINE+39               cn=0,n=8
         2 001624   001671 600000 2                  TZE     s:11499
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:83   

      396    11489    2              CALL IVO$VERIFY_FMT(VIP)

  11489  2 001625   200110 630500                    EPPR0   VI$,,AUTO
         2 001626   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001627   000000 701000 xent               TSX1    IVO$VERIFY_FMT
         2 001630   001632 702000 2                  TSX2    s:11491
         2 001631   001671 710000 2                  TRA     s:11499

      397    11490    3              WHENALTRETURN DO;

      398    11491    3                 IF (IV_ONLINE AND

  11491  2 001632   000000 234000 xsym               SZN     IV_ONLINE
         2 001633   001651 605000 2                  TPL     s:11494
         2 001634   000000 470400 xsym               LDP0    B$TCB$
         2 001635   000000 471500                    LDP1    0,,PR0
         2 001636   100102 236100                    LDQ     66,,PR1
         2 001637   377770 376007                    ANQ     131064,DL
         2 001640   001500 116007                    CMPQ    832,DL
         2 001641   001651 601000 2                  TNZ     s:11494

      399    11492    3                   (B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOSLOTS))
      400    11493    3                 THEN CALL IVV$ERROR(,27);

  11493  2 001642   000061 236000 3                  LDQ     49
         2 001643   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001644   200144 757100                    STAQ    @V+17,,AUTO
         2 001645   200144 630500                    EPPR0   @V+17,,AUTO
         2 001646   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001647   000000 701000 xent               TSX1    IVV$ERROR
         2 001650   000000 011000                    NOP     0

      401    11494    3                 IF (IV_ONLINE AND

  11494  2 001651   000000 234000 xsym               SZN     IV_ONLINE
         2 001652   001670 605000 2                  TPL     s:11497
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:84   
         2 001653   000000 470400 xsym               LDP0    B$TCB$
         2 001654   000000 471500                    LDP1    0,,PR0
         2 001655   100102 236100                    LDQ     66,,PR1
         2 001656   377770 376007                    ANQ     131064,DL
         2 001657   006250 116007                    CMPQ    3240,DL
         2 001660   001670 601000 2                  TNZ     s:11497

      402    11495    3                   (B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOTAUTH))
      403    11496    3                 THEN CALL IVV$ERROR(,28);

  11496  2 001661   000063 236000 3                  LDQ     51
         2 001662   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001663   200144 757100                    STAQ    @V+17,,AUTO
         2 001664   200144 630500                    EPPR0   @V+17,,AUTO
         2 001665   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001666   000000 701000 xent               TSX1    IVV$ERROR
         2 001667   000000 011000                    NOP     0

      404    11497    3                 GOTO DEL_VI;

  11497  2 001670   004312 710000 2                  TRA     DEL_VI

      405    11498    3                 END;
      406    11499    2           CALL IVO$READ_VID(VIP) ALTRET(BAD_VID);

  11499  2 001671   200110 630500                    EPPR0   VI$,,AUTO
         2 001672   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001673   000000 701000 xent               TSX1    IVO$READ_VID
         2 001674   002047 702000 2                  TSX2    BAD_VID

      407    11500    3           IF VID.VSN~=VIP.VSN THEN DO;

  11500  2 001675   200111 470500                    LDP0    VID$,,AUTO
         2 001676   200110 471500                    LDP1    VI$,,AUTO
         2 001677   000002 236100                    LDQ     2,,PR0
         2 001700   100011 116100                    CMPQ    9,,PR1
         2 001701   001751 600000 2                  TZE     s:11510
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:85   

      408    11501    3              CALL IVV$ERROR(VIP.DEVID,8,VID.VSN);

  11501  2 001702   200111 236100                    LDQ     VID$,,AUTO
         2 001703   000002 036003                    ADLQ    2,DU
         2 001704   200146 756100                    STQ     @V+19,,AUTO
         2 001705   000064 236000 3                  LDQ     52
         2 001706   200145 756100                    STQ     @V+18,,AUTO
         2 001707   200110 236100                    LDQ     VI$,,AUTO
         2 001710   000005 036003                    ADLQ    5,DU
         2 001711   200144 756100                    STQ     @V+17,,AUTO
         2 001712   200144 630500                    EPPR0   @V+17,,AUTO
         2 001713   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001714   000000 701000 xent               TSX1    IVV$ERROR
         2 001715   000000 011000                    NOP     0

      409    11502    3              CALL IVO$BATCH ALTRET(DEL_VI);

  11502  2 001716   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001717   000000 701000 xent               TSX1    IVO$BATCH
         2 001720   004312 702000 2                  TSX2    DEL_VI

      410    11503    3              CALL IVO$PRINT(OKREQ,'0'B);

  11503  2 001721   000065 630400 3                  EPPR0   53
         2 001722   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001723   000000 701000 xent               TSX1    IVO$PRINT
         2 001724   000000 011000                    NOP     0

      411    11504    3              PCB.TEXT$->CMDBUF='N';

  11504  2 001725   200063 470500                    LDP0    PCB,,AUTO
         2 001726   040100 100400                    MLR     fill='040'O
         2 001727   000067 000001 3                  ADSC9   55                       cn=0,n=1
         2 001730   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      412    11505    3              CALL IVO$SETPC('?');
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:86   

  11505  2 001731   000071 630400 3                  EPPR0   57
         2 001732   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001733   000000 701000 xent               TSX1    IVO$SETPC
         2 001734   000000 011000                    NOP     0

      413    11506    3              CALL IVO$READ;

  11506  2 001735   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001736   000000 701000 xent               TSX1    IVO$READ
         2 001737   000000 011000                    NOP     0

      414    11507    3              IF PCB.TEXT$->CMDBUF~='Y' THEN GOTO DEL_VI;

  11507  2 001740   200063 470500                    LDP0    PCB,,AUTO
         2 001741   040000 106500                    CMPC    fill='040'O
         2 001742   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 001743   000072 000001 3                  ADSC9   58                       cn=0,n=1
         2 001744   004312 601000 2                  TNZ     DEL_VI

      415    11508    3              VID.VSN=VIP.VSN;

  11508  2 001745   200110 471500                    LDP1    VI$,,AUTO
         2 001746   200111 473500                    LDP3    VID$,,AUTO
         2 001747   100011 235100                    LDA     9,,PR1
         2 001750   300002 755100                    STA     2,,PR3

      416    11509    3              END;

      417    11510    3           IF VIP.DTT<=#UPDATE THEN DO;

  11510  2 001751   200110 470500                    LDP0    VI$,,AUTO
         2 001752   000017 236100                    LDQ     15,,PR0
         2 001753   000007 376003                    ANQ     7,DU
         2 001754   000002 116003                    CMPQ    2,DU
         2 001755   002046 603000 2                  TRC     s:11540

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:87   
      418    11511    3              IF VID.ID~='CP6 ' THEN

  11511  2 001756   200111 471500                    LDP1    VID$,,AUTO
         2 001757   100000 236100                    LDQ     0,,PR1
         2 001760   000147 116000 1                  CMPQ    DTTLINE+41
         2 001761   002005 600000 2                  TZE     s:11523

      419    11512    4                 IF GVID.KEY='305206000000'O/*BCD'H-6000'*/ THEN DO;

  11512  2 001762   100000 236100                    LDQ     0,,PR1
         2 001763   000150 116000 1                  CMPQ    DTTLINE+42
         2 001764   001772 601000 2                  TNZ     s:11516

      420    11513    4                    VID.ID='CP6 ';

  11513  2 001765   000147 236000 1                  LDQ     DTTLINE+41
         2 001766   100000 756100                    STQ     0,,PR1

      421    11514    4                    VID.INSTID='0'B;

  11514  2 001767   200111 470500                    LDP0    VID$,,AUTO
         2 001770   000001 450100                    STZ     1,,PR0

      422    11515    4                    END;

  11515  2 001771   002005 710000 2                  TRA     s:11523

      423    11516    4                 ELSE IF GVID.OKEY='272520200600'O/*BCD'GE  60'*/ THEN DO;

  11516  2 001772   100200 236100                    LDQ     128,,PR1
         2 001773   000151 116000 1                  CMPQ    DTTLINE+43
         2 001774   002130 601000 2                  TNZ     NEW_VID

      424    11517    4                       VID.ID='CP6 ';

  11517  2 001775   000147 236000 1                  LDQ     DTTLINE+41
         2 001776   100000 756100                    STQ     0,,PR1
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:88   

      425    11518    4                       VID.INSTID='0'B;

  11518  2 001777   200111 470500                    LDP0    VID$,,AUTO
         2 002000   000001 450100                    STZ     1,,PR0

      426    11519    4                       VID.VSN=GVID.ONUMB;

  11519  2 002001   200111 470500                    LDP0    VID$,,AUTO
         2 002002   000203 235100                    LDA     131,,PR0
         2 002003   000002 755100                    STA     2,,PR0

      427    11520    4                       END;

  11520  2 002004   002005 710000 2                  TRA     s:11523

      428    11521    3                    ELSE
      429    11522    3                       GOTO NEW_VID;
      430    11523    3              CALL IVZ$CKSUM(VID.DTT) ALTRET(NO_DTT);

  11523  2 002005   200111 236100                    LDQ     VID$,,AUTO
         2 002006   000400 036003                    ADLQ    256,DU
         2 002007   200144 756100                    STQ     @V+17,,AUTO
         2 002010   200144 630500                    EPPR0   @V+17,,AUTO
         2 002011   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002012   000000 701000 xent               TSX1    IVZ$CKSUM
         2 002013   002021 702000 2                  TSX2    NO_DTT

      431    11524    3              DTTX=63;

  11524  2 002014   000077 235007                    LDA     63,DL
         2 002015   200017 755100                    STA     DTTX,,AUTO

      432    11525    3              CALL SORT_DTT;

  11525  2 002016   005667 701000 2                  TSX1    SORT_DTT
         2 002017   000000 011000                    NOP     0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:89   

      433    11526    4              DO WHILE ('0'B);

  11526  2 002020   002022 710000 2                  TRA     s:11530

      434    11527    4   NO_DTT:
      435    11528    4                 DTTX=0;

  11528  2 002021   200017 450100       NO_DTT       STZ     DTTX,,AUTO

      436    11529    4                 END;

      437    11530    3              CALL PRINT_DTT;

  11530  2 002022   005435 701000 2                  TSX1    PRINT_DTT
         2 002023   000000 011000                    NOP     0

      438    11531    4              IF VIP.DTT=#UPDATE THEN DO;

  11531  2 002024   200110 470500                    LDP0    VI$,,AUTO
         2 002025   000017 236100                    LDQ     15,,PR0
         2 002026   000007 376003                    ANQ     7,DU
         2 002027   000001 116003                    CMPQ    1,DU
         2 002030   002206 601000 2                  TNZ     s:11576

      439    11532    5                 DO DTTX=0 TO 62;

  11532  2 002031   200017 450100                    STZ     DTTX,,AUTO

      440    11533    5                    IF VID.DTT(DTTX)=BITBIN('777777'O) THEN GOTO DTT_END_FOUND;

  11533  2 002032   200111 470500                    LDP0    VID$,,AUTO
         2 002033   200017 720100                    LXL0    DTTX,,AUTO
         2 002034   000400 221110                    LDX1    256,X0,PR0
         2 002035   777777 101003                    CMPX1   -1,DU
         2 002036   002045 600000 2                  TZE     DTT_END_FOUND

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:90   
      441    11534    5                    END;

  11534  2 002037   200017 054100                    AOS     DTTX,,AUTO
         2 002040   200017 235100                    LDA     DTTX,,AUTO
         2 002041   000076 115007                    CMPA    62,DL
         2 002042   002032 604400 2                  TMOZ    s:11533

      442    11535    4                 DTTX=63;

  11535  2 002043   000077 236007                    LDQ     63,DL
         2 002044   200017 756100                    STQ     DTTX,,AUTO

      443    11536    4   DTT_END_FOUND:
      444    11537    4                 END/* IF VIP.DTT=#UPDATE */;

  11537  2 002045                       DTT_END_FOU* null
      445    11538    3              END/* IF VIP.DTT<=#UPDATE */;

  11538  2 002045   002206 710000 2                  TRA     s:11576

      446    11539    3           ELSE DO;

      447    11540    4              DO WHILE ('0'B);

  11540  2 002046   002130 710000 2                  TRA     NEW_VID

      448    11541    4   BAD_VID:                                /* VID NOT RECOGNIZABLE */
      449    11542    5                 IF IV_ONLINE THEN DO;

  11542  2 002047   000000 234000 xsym  BAD_VID      SZN     IV_ONLINE
         2 002050   002117 605000 2                  TPL     s:11559

      450    11543    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$TDNOPERM THEN

  11543  2 002051   000000 470400 xsym               LDP0    B$TCB$
         2 002052   000000 471500                    LDP1    0,,PR0
         2 002053   100102 236100                    LDQ     66,,PR1
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:91   
         2 002054   377770 376007                    ANQ     131064,DL
         2 002055   016070 116007                    CMPQ    7224,DL
         2 002056   002071 601000 2                  TNZ     s:11548

      451    11544    6                    DO;

      452    11545    6                       CALL IVV$ERROR (VIP.DEVID, 18); /* !NODIAG */

  11545  2 002057   000074 236000 3                  LDQ     60
         2 002060   200145 756100                    STQ     @V+18,,AUTO
         2 002061   200110 236100                    LDQ     VI$,,AUTO
         2 002062   000005 036003                    ADLQ    5,DU
         2 002063   200144 756100                    STQ     @V+17,,AUTO
         2 002064   200144 630500                    EPPR0   @V+17,,AUTO
         2 002065   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002066   000000 701000 xent               TSX1    IVV$ERROR
         2 002067   000000 011000                    NOP     0

      453    11546    6                       GOTO DEL_VI;

  11546  2 002070   004312 710000 2                  TRA     DEL_VI

      454    11547    6                       END;
      455    11548    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$BREAK THEN

  11548  2 002071   014510 116007                    CMPQ    6472,DL
         2 002072   002105 601000 2                  TNZ     s:11553

      456    11549    6                    DO;

      457    11550    6                       CALL IVV$ERROR (VIP.DEVID, 19); /* BREAK */

  11550  2 002073   000076 236000 3                  LDQ     62
         2 002074   200145 756100                    STQ     @V+18,,AUTO
         2 002075   200110 236100                    LDQ     VI$,,AUTO
         2 002076   000005 036003                    ADLQ    5,DU
         2 002077   200144 756100                    STQ     @V+17,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:92   
         2 002100   200144 630500                    EPPR0   @V+17,,AUTO
         2 002101   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002102   000000 701000 xent               TSX1    IVV$ERROR
         2 002103   000000 011000                    NOP     0

      458    11551    6                       GOTO DEL_VI;

  11551  2 002104   004312 710000 2                  TRA     DEL_VI

      459    11552    6                       END;
      460    11553    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOSLOTS THEN

  11553  2 002105   001500 116007                    CMPQ    832,DL
         2 002106   002117 601000 2                  TNZ     s:11559

      461    11554    6                    DO;

      462    11555    6                       CALL IVV$ERROR(,27); /* NO MORE DCB SLOTS */

  11555  2 002107   000061 236000 3                  LDQ     49
         2 002110   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002111   200144 757100                    STAQ    @V+17,,AUTO
         2 002112   200144 630500                    EPPR0   @V+17,,AUTO
         2 002113   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002114   000000 701000 xent               TSX1    IVV$ERROR
         2 002115   000000 011000                    NOP     0

      463    11556    6                       GOTO DEL_VI;

  11556  2 002116   004312 710000 2                  TRA     DEL_VI

      464    11557    6                       END;
      465    11558    5                    END;
      466    11559    4                 CALL IVV$ERROR(VIP.DEVID,12);

  11559  2 002117   000100 236000 3                  LDQ     64
         2 002120   200145 756100                    STQ     @V+18,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:93   
         2 002121   200110 236100                    LDQ     VI$,,AUTO
         2 002122   000005 036003                    ADLQ    5,DU
         2 002123   200144 756100                    STQ     @V+17,,AUTO
         2 002124   200144 630500                    EPPR0   @V+17,,AUTO
         2 002125   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002126   000000 701000 xent               TSX1    IVV$ERROR
         2 002127   000000 011000                    NOP     0

      467    11560    4                 END;

      468    11561    3   NEW_VID:
      469    11562    3              VIP.DTT=#NEW;

  11562  2 002130   200110 470500       NEW_VID      LDP0    VI$,,AUTO
         2 002131   000017 236100                    LDQ     15,,PR0
         2 002132   000016 376000 3                  ANQ     14
         2 002133   000002 276003                    ORQ     2,DU
         2 002134   000017 756100                    STQ     15,,PR0

      470    11563    3              VID='0'B;

  11563  2 002135   200111 470500                    LDP0    VID$,,AUTO
         2 002136   010000 220003                    LDX0    4096,DU
         2 002137   000140 100400                    MLR     fill='000'O
         2 002140   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 002141   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      471    11564    3              VID.ID='CP6 ';

  11564  2 002142   000147 236000 1                  LDQ     DTTLINE+41
         2 002143   200111 470500                    LDP0    VID$,,AUTO
         2 002144   000000 756100                    STQ     0,,PR0

      472    11565    3              VID.INSTID='0'B;

  11565  2 002145   200111 470500                    LDP0    VID$,,AUTO
         2 002146   000001 450100                    STZ     1,,PR0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:94   

      473    11566    3              VID.VSN=VIP.VSN;

  11566  2 002147   200110 470500                    LDP0    VI$,,AUTO
         2 002150   200111 471500                    LDP1    VID$,,AUTO
         2 002151   000011 235100                    LDA     9,,PR0
         2 002152   100002 755100                    STA     2,,PR1

      474    11567    3              VID.PSN=' ';

  11567  2 002153   200111 470500                    LDP0    VID$,,AUTO
         2 002154   040100 100400                    MLR     fill='040'O
         2 002155   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002156   000003 000006                    ADSC9   3,,PR0                   cn=0,n=6

      475    11568    4              DO DTTX=0 TO 62;

  11568  2 002157   200017 450100                    STZ     DTTX,,AUTO

      476    11569    4                 VID.DT(DTTX)='777777777777'O;

  11569  2 002160   000027 236000 xsym               LDQ     B_VECTNIL+23
         2 002161   200111 470500                    LDP0    VID$,,AUTO
         2 002162   200017 720100                    LXL0    DTTX,,AUTO
         2 002163   000400 756110                    STQ     256,X0,PR0

      477    11570    4                 END;

  11570  2 002164   200017 054100                    AOS     DTTX,,AUTO
         2 002165   200017 235100                    LDA     DTTX,,AUTO
         2 002166   000076 115007                    CMPA    62,DL
         2 002167   002160 604400 2                  TMOZ    s:11569

      478    11571    3              VID.DTT(63)=1;     /* IVZ$CKSUM WILL PUT IN CHECKSUM CORRECTLY  */

  11571  2 002170   000001 220003                    LDX0    1,DU
         2 002171   200111 470500                    LDP0    VID$,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:95   
         2 002172   000477 740100                    STX0    319,,PR0

      479    11572    3              CALL IVZ$CKSUM(VID.DTT);

  11572  2 002173   200111 236100                    LDQ     VID$,,AUTO
         2 002174   000400 036003                    ADLQ    256,DU
         2 002175   200144 756100                    STQ     @V+17,,AUTO
         2 002176   200144 630500                    EPPR0   @V+17,,AUTO
         2 002177   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002200   000000 701000 xent               TSX1    IVZ$CKSUM
         2 002201   000000 011000                    NOP     0

      480    11573    3              DTTX=0;

  11573  2 002202   200017 450100                    STZ     DTTX,,AUTO

      481    11574    3              VIP.DTTCH='0'B;

  11574  2 002203   200110 470500                    LDP0    VI$,,AUTO
         2 002204   000101 236000 3                  LDQ     65
         2 002205   000017 356100                    ANSQ    15,,PR0

      482    11575    3              END/* IF VIP.DTT>#UPDATE */;

      483    11576    3           DO SELECT (VIP.MODEL);

  11576  2 002206   200110 470500                    LDP0    VI$,,AUTO
         2 002207   040000 106500                    CMPC    fill='040'O
         2 002210   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 002211   000115 000010 1                  ADSC9   DTTLINE+15               cn=0,n=8
         2 002212   002245 602000 2                  TNC     s:11576+31
         2 002213   002271 600000 2                  TZE     s:11580
         2 002214   040000 106500                    CMPC    fill='040'O
         2 002215   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 002216   000117 000010 1                  ADSC9   DTTLINE+17               cn=0,n=8
         2 002217   002226 602000 2                  TNC     s:11576+16
         2 002220   002271 600000 2                  TZE     s:11580
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:96   
         2 002221   040000 106500                    CMPC    fill='040'O
         2 002222   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 002223   000121 000010 1                  ADSC9   DTTLINE+19               cn=0,n=8
         2 002224   002313 601000 2                  TNZ     s:11587
         2 002225   002271 710000 2                  TRA     s:11580
         2 002226   040000 106500                    CMPC    fill='040'O
         2 002227   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 002230   000123 000010 1                  ADSC9   DTTLINE+21               cn=0,n=8
         2 002231   002240 602000 2                  TNC     s:11576+26
         2 002232   002271 600000 2                  TZE     s:11580
         2 002233   040000 106500                    CMPC    fill='040'O
         2 002234   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 002235   000125 000010 1                  ADSC9   DTTLINE+23               cn=0,n=8
         2 002236   002313 601000 2                  TNZ     s:11587
         2 002237   002271 710000 2                  TRA     s:11580
         2 002240   040000 106500                    CMPC    fill='040'O
         2 002241   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 002242   000127 000010 1                  ADSC9   DTTLINE+25               cn=0,n=8
         2 002243   002313 601000 2                  TNZ     s:11587
         2 002244   002271 710000 2                  TRA     s:11580
         2 002245   040000 106500                    CMPC    fill='040'O
         2 002246   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 002247   000131 000010 1                  ADSC9   DTTLINE+27               cn=0,n=8
         2 002250   002264 602000 2                  TNC     s:11576+46
         2 002251   002271 600000 2                  TZE     s:11580
         2 002252   040000 106500                    CMPC    fill='040'O
         2 002253   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 002254   000133 000010 1                  ADSC9   DTTLINE+29               cn=0,n=8
         2 002255   002313 602000 2                  TNC     s:11587
         2 002256   002271 600000 2                  TZE     s:11580
         2 002257   040000 106500                    CMPC    fill='040'O
         2 002260   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 002261   000135 000010 1                  ADSC9   DTTLINE+31               cn=0,n=8
         2 002262   002313 601000 2                  TNZ     s:11587
         2 002263   002271 710000 2                  TRA     s:11580
         2 002264   040000 106500                    CMPC    fill='040'O
         2 002265   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:97   
         2 002266   000137 000010 1                  ADSC9   DTTLINE+33               cn=0,n=8
         2 002267   002313 601000 2                  TNZ     s:11587
         2 002270   002271 710000 2                  TRA     s:11580

      484    11577    3              SELECT ('MSU8082 ', 'MSU8092 ', 'MSU3380 ' , 'MSU3382 ',

      485    11578    3                'MSU3390 ', 'MSU3392 ', 'MSU3391 ', 'MSU3393 ',
      486    11579    3                'MSU3381 ', 'MSU3383 ');
      487    11580    3              VIP.DONE = '1'B;

  11580  2 002271   020000 236007                    LDQ     8192,DL
         2 002272   000017 256100                    ORSQ    15,,PR0

      488    11581                   %ENQUEUE(P#=VIP,Q#=VIP$);

  11582  2 002273   200112 236300                    LDQ   ! VIP$,,AUTO
         2 002274   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         2 002275   002302 601200 2                  TNZ   ! s:11582+7

  11582  2 002276   200110 236300                    LDQ   ! VI$,,AUTO
         2 002277   200110 470700                    LDP0  ! VI$,,AUTO
         2 002300   000000 756300                    STQ   ! 0,,PR0
         2 002301   002310 710200 2                  TRA   ! s:11582+13

  11582  2 002302   200112 470700                    LDP0  ! VIP$,,AUTO
         2 002303   000000 236300                    LDQ   ! 0,,PR0
         2 002304   200110 471700                    LDP1  ! VI$,,AUTO
         2 002305   100000 756300                    STQ   ! 0,,PR1

  11582  2 002306   200110 236300                    LDQ   ! VI$,,AUTO
         2 002307   000000 756300                    STQ   ! 0,,PR0

  11582  2 002310   200110 236300                    LDQ   ! VI$,,AUTO
         2 002311   200112 756300                    STQ   ! VIP$,,AUTO

      489    11584    3              GOTO WAIT_NEXT_CMD;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:98   
  11584  2 002312   004374 710000 2                  TRA     WAIT_NEXT_CMD

      490    11585    3              SELECT (ELSE);

      491    11586    3              END;

      492    11587    3           IF VIP.DTT>=#UPDATE THEN DO;

  11587  2 002313   000017 236100                    LDQ     15,,PR0
         2 002314   000007 316003                    CANQ    7,DU
         2 002315   003045 600000 2                  TZE     s:11698

      493    11588    3              IF  VIP.ALT

  11588  2 002316   000200 316007                    CANQ    128,DL
         2 002317   002466 600000 2                  TZE     s:11637

      494    11589    4              THEN DO ;

      495    11590    5                 DO  SELECT ( VIP.MODEL ) ;

  11590  2 002320   040000 106500                    CMPC    fill='040'O
         2 002321   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 002322   000143 000007 1                  ADSC9   DTTLINE+37               cn=0,n=7
         2 002323   002332 602000 2                  TNC     s:11590+10
         2 002324   002346 600000 2                  TZE     s:11598
         2 002325   040000 106500                    CMPC    fill='040'O
         2 002326   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 002327   000141 000007 1                  ADSC9   DTTLINE+35               cn=0,n=7
         2 002330   002353 601000 2                  TNZ     s:11603
         2 002331   002346 710000 2                  TRA     s:11598
         2 002332   040000 106500                    CMPC    fill='040'O
         2 002333   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 002334   000145 000007 1                  ADSC9   DTTLINE+39               cn=0,n=7
         2 002335   002353 601000 2                  TNZ     s:11603
         2 002336   002337 710000 2                  TRA     s:11593

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:99   
      496    11591
      497    11592    5                    SELECT ( 'MSU0451' ) ;

      498    11593    5                    CC1 = 811 ;

  11593  2 002337   001453 235007                    LDA     811,DL
         2 002340   200014 755100                    STA     CC1,,AUTO

      499    11594    5                    CC2 = 813 ;

  11594  2 002341   001455 235007                    LDA     813,DL
         2 002342   200015 755100                    STA     CC2,,AUTO

      500    11595    5                    HH2 = 18 ;

  11595  2 002343   000022 235007                    LDA     18,DL
         2 002344   200025 755100                    STA     HH2,,AUTO
         2 002345   002353 710000 2                  TRA     s:11603

      501    11596
      502    11597    5                    SELECT ( 'MSU0501', 'MSU0509' ) ;

      503    11598    5                    CC1 = 840 ;

  11598  2 002346   001510 235007                    LDA     840,DL
         2 002347   200014 755100                    STA     CC1,,AUTO

      504    11599    5                    CC2 = 840 ;

  11599  2 002350   200015 755100                    STA     CC2,,AUTO

      505    11600    5                    HH2 = 39 ;

  11600  2 002351   000047 235007                    LDA     39,DL
         2 002352   200025 755100                    STA     HH2,,AUTO

      506    11601    5                    END ;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:100  

      507    11602
      508    11603    5                 DO  CASE ( VIP.DTT ) ;

  11603  2 002353   000017 220100                    LDX0    15,,PR0
         2 002354   000007 360003                    ANX0    7,DU
         2 002355   000003 100003                    CMPX0   3,DU
         2 002356   002360 602010 2                  TNC     s:11603+5,X0
         2 002357   002466 710000 2                  TRA     s:11637
         2 002360   002466 710000 2                  TRA     s:11637
         2 002361   002363 710000 2                  TRA     s:11606
         2 002362   002433 710000 2                  TRA     s:11624

      509    11604
      510    11605    5                  CASE ( #UPDATE ) ;

      511    11606    6                    DO  CC = CC1 TO CC2 ;

  11606  2 002363   200014 235100                    LDA     CC1,,AUTO
         2 002364   200013 755100                    STA     CC,,AUTO
         2 002365   002427 710000 2                  TRA     s:11621+1

      512    11607    7   HH_ALT_UPD:         DO  HH = 0 TO HH2 ;

  11607  2 002366   200024 450100       HH_ALT_UPD   STZ     HH,,AUTO
         2 002367   002423 710000 2                  TRA     s:11620+1

      513    11608    7                          TRACK = CC * IV_CYLM + HH ;

  11608  2 002370   200013 236100                    LDQ     CC,,AUTO
         2 002371   000010 736000                    QLS     8
         2 002372   200024 036100                    ADLQ    HH,,AUTO
         2 002373   000000 620006                    EAX0    0,QL
         2 002374   200104 740100                    STX0    TRACK,,AUTO

      514    11609    8                          DO  I = 0 TO DTTX ;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:101  
  11609  2 002375   200027 450100                    STZ     I,,AUTO
         2 002376   002405 710000 2                  TRA     s:11613+1

      515    11610    8                             IF  VID.DTT(I) = TRACK

  11610  2 002377   200111 470500                    LDP0    VID$,,AUTO
         2 002400   200027 720100                    LXL0    I,,AUTO
         2 002401   000400 221110                    LDX1    256,X0,PR0
         2 002402   200104 101100                    CMPX1   TRACK,,AUTO
         2 002403   002426 600000 2                  TZE     s:11621

      516    11611    8                             THEN
      517    11612    8                                EXIT HH_ALT_UPD ;
      518    11613    8                             END ;

  11613  2 002404   200027 054100                    AOS     I,,AUTO
         2 002405   200027 236100                    LDQ     I,,AUTO
         2 002406   200017 116100                    CMPQ    DTTX,,AUTO
         2 002407   002377 604400 2                  TMOZ    s:11610

      519    11614    7                          IF  DTTX >= 63

  11614  2 002410   200017 235100                    LDA     DTTX,,AUTO
         2 002411   000077 115007                    CMPA    63,DL
         2 002412   002550 605000 2                  TPL     DTT_OVERFLOW

      520    11615    7                          THEN
      521    11616    7                             GOTO DTT_OVERFLOW ;
      522    11617    7                          VID.DTT(DTTX) = TRACK ;

  11617  2 002413   200104 220100                    LDX0    TRACK,,AUTO
         2 002414   200111 470500                    LDP0    VID$,,AUTO
         2 002415   000400 740105                    STX0    256,AL,PR0

      523    11618    7                          DTTX = DTTX + 1 ;

  11618  2 002416   200017 054100                    AOS     DTTX,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:102  

      524    11619    7                          VIP.DTTCH = '1'B ;

  11619  2 002417   200110 470500                    LDP0    VI$,,AUTO
         2 002420   004000 236007                    LDQ     2048,DL
         2 002421   000017 256100                    ORSQ    15,,PR0

      525    11620    7                          END HH_ALT_UPD ;

  11620  2 002422   200024 054100                    AOS     HH,,AUTO
         2 002423   200024 236100                    LDQ     HH,,AUTO
         2 002424   200025 116100                    CMPQ    HH2,,AUTO
         2 002425   002370 604400 2                  TMOZ    s:11608

      526    11621    6                       END ;

  11621  2 002426   200013 054100                    AOS     CC,,AUTO
         2 002427   200013 236100                    LDQ     CC,,AUTO
         2 002430   200015 116100                    CMPQ    CC2,,AUTO
         2 002431   002366 604400 2                  TMOZ    HH_ALT_UPD
         2 002432   002466 710000 2                  TRA     s:11637

      527    11622
      528    11623    5                  CASE ( #NEW ) ;

      529    11624    6                    DO  CC = CC1 TO CC2 ;

  11624  2 002433   200014 235100                    LDA     CC1,,AUTO
         2 002434   200013 755100                    STA     CC,,AUTO
         2 002435   002460 710000 2                  TRA     s:11632+1

      530    11625    7                       DO  HH = 0 TO HH2 ;

  11625  2 002436   200024 450100                    STZ     HH,,AUTO
         2 002437   002454 710000 2                  TRA     s:11631+1

      531    11626    7                          VID.DTT(DTTX) = CC * IV_CYLM + HH ;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:103  

  11626  2 002440   200013 236100                    LDQ     CC,,AUTO
         2 002441   000010 736000                    QLS     8
         2 002442   200024 036100                    ADLQ    HH,,AUTO
         2 002443   000000 620006                    EAX0    0,QL
         2 002444   200111 470500                    LDP0    VID$,,AUTO
         2 002445   200017 721100                    LXL1    DTTX,,AUTO
         2 002446   000400 740111                    STX0    256,X1,PR0

      532    11627    7                          DTTX = DTTX + 1 ;

  11627  2 002447   200017 054100                    AOS     DTTX,,AUTO

      533    11628    7                          IF  DTTX >= 63

  11628  2 002450   200017 235100                    LDA     DTTX,,AUTO
         2 002451   000077 115007                    CMPA    63,DL
         2 002452   002550 605000 2                  TPL     DTT_OVERFLOW

      534    11629    7                          THEN
      535    11630    7                             GOTO DTT_OVERFLOW ;
      536    11631    7                          END ;

  11631  2 002453   200024 054100                    AOS     HH,,AUTO
         2 002454   200024 236100                    LDQ     HH,,AUTO
         2 002455   200025 116100                    CMPQ    HH2,,AUTO
         2 002456   002440 604400 2                  TMOZ    s:11626

      537    11632    6                       END ;

  11632  2 002457   200013 054100                    AOS     CC,,AUTO
         2 002460   200013 236100                    LDQ     CC,,AUTO
         2 002461   200015 116100                    CMPQ    CC2,,AUTO
         2 002462   002436 604400 2                  TMOZ    s:11625

      538    11633    5                    VIP.DTTCH = '1'B ;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:104  
  11633  2 002463   200110 470500                    LDP0    VI$,,AUTO
         2 002464   004000 236007                    LDQ     2048,DL
         2 002465   000017 256100                    ORSQ    15,,PR0

      539    11634
      540    11635    5                  END ;

      541    11636    4                 END ;

      542    11637    3              CALL IVO$PRINT(DTT_PROMPT,'0'B);

  11637  2 002466   000102 630400 3                  EPPR0   66
         2 002467   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002470   000000 701000 xent               TSX1    IVO$PRINT
         2 002471   000000 011000                    NOP     0

      543    11638    3              CALL IVO$SETPC('^');

  11638  2 002472   000105 630400 3                  EPPR0   69
         2 002473   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002474   000000 701000 xent               TSX1    IVO$SETPC
         2 002475   000000 011000                    NOP     0

      544    11639    4              DO WHILE ('0'B);

  11639  2 002476   002510 710000 2                  TRA     NEXT_DT

      545    11640    4   PARSE_ERR_1:                            /* PARSING ERROR ON DT */
      546    11641    4                 CALL IVV$ERROR(VIP.DEVID,1);

  11641  2 002477   000106 236000 3     PARSE_ERR_1  LDQ     70
         2 002500   200145 756100                    STQ     @V+18,,AUTO
         2 002501   200110 236100                    LDQ     VI$,,AUTO
         2 002502   000005 036003                    ADLQ    5,DU
         2 002503   200144 756100                    STQ     @V+17,,AUTO
         2 002504   200144 630500                    EPPR0   @V+17,,AUTO
         2 002505   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:105  
         2 002506   000000 701000 xent               TSX1    IVV$ERROR
         2 002507   000000 011000                    NOP     0

      547    11642    4                 END;

      548    11643    3   NEXT_DT:
      549    11644    3              CALL IVO$READ ALTRET(NEXT_DT);

  11644  2 002510   000002 631400 xsym  NEXT_DT      EPPR1   B_VECTNIL+2
         2 002511   000000 701000 xent               TSX1    IVO$READ
         2 002512   002510 702000 2                  TSX2    NEXT_DT

      550    11645    3              CALL X$PARSE(PCB) ALTRET(PARSE_ERR_1);

  11645  2 002513   200063 630500                    EPPR0   PCB,,AUTO
         2 002514   200144 450500                    STP0    @V+17,,AUTO
         2 002515   200144 630500                    EPPR0   @V+17,,AUTO
         2 002516   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002517   000000 701000 xent               TSX1    X$PARSE
         2 002520   002477 702000 2                  TSX2    PARSE_ERR_1

      551    11646    3              BLK$=PCB.OUT$;

  11646  2 002521   200066 236100                    LDQ     PCB+3,,AUTO
         2 002522   200011 756100                    STQ     BLK$,,AUTO

      552    11647    4              DO CASE (OUT$BLK.CODE);

  11647  2 002523   200011 470500                    LDP0    BLK$,,AUTO
         2 002524   000000 236100                    LDQ     0,,PR0
         2 002525   777777 376007                    ANQ     -1,DL
         2 002526   000006 136007                    SBLQ    6,DL
         2 002527   000002 116007                    CMPQ    2,DL
         2 002530   002532 602006 2                  TNC     s:11647+7,QL
         2 002531   003033 710000 2                  TRA     s:11694
         2 002532   002534 710000 2                  TRA     s:11649
         2 002533   003030 710000 2                  TRA     s:11692
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:106  

      553    11648    4               CASE(#DT);                  /* DEFECTIVE TRACK SPECIFICATION */

      554    11649    4                 CALL DECBIN(OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT,CC,HH);

  11649  2 002534   000003 471500                    LDP1    3,,PR0
         2 002535   200024 633500                    EPPR3   HH,,AUTO
         2 002536   200117 453500                    STP3    HH+1,,AUTO
         2 002537   200013 634500                    EPPR4   CC,,AUTO
         2 002540   200116 454500                    STP4    @SECTOR+1,,AUTO
         2 002541   100004 635500                    EPPR5   4,,PR1
         2 002542   200115 455500                    STP5    VIP$+3,,AUTO
         2 002543   005331 701000 2                  TSX1    DECBIN
         2 002544   000000 011000                    NOP     0

      555    11650    5                 IF DTTX>=63 THEN DO;

  11650  2 002545   200017 235100                    LDA     DTTX,,AUTO
         2 002546   000077 115007                    CMPA    63,DL
         2 002547   002562 604000 2                  TMI     s:11655

      556    11651    5   DTT_OVERFLOW:
      557    11652    5                    CALL IVV$ERROR(VIP.DEVID,6);

  11652  2 002550   000107 236000 3     DTT_OVERFLOW LDQ     71
         2 002551   200145 756100                    STQ     @V+18,,AUTO
         2 002552   200110 236100                    LDQ     VI$,,AUTO
         2 002553   000005 036003                    ADLQ    5,DU
         2 002554   200144 756100                    STQ     @V+17,,AUTO
         2 002555   200144 630500                    EPPR0   @V+17,,AUTO
         2 002556   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002557   000000 701000 xent               TSX1    IVV$ERROR
         2 002560   000000 011000                    NOP     0

      558    11653    5                    GOTO NEXT_DT;

  11653  2 002561   002510 710000 2                  TRA     NEXT_DT
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:107  

      559    11654    5                    END;
      560    11655    5                 IF VIP.NEWDTS AND VIP.NRANGES>=64 THEN DO;

  11655  2 002562   200110 470500                    LDP0    VI$,,AUTO
         2 002563   000017 236100                    LDQ     15,,PR0
         2 002564   040000 316007                    CANQ    16384,DL
         2 002565   002604 600000 2                  TZE     s:11659
         2 002566   000020 236100                    LDQ     16,,PR0
         2 002567   777000 376003                    ANQ     -512,DU
         2 002570   100000 116003                    CMPQ    32768,DU
         2 002571   002604 602000 2                  TNC     s:11659

      561    11656    5                    CALL IVV$ERROR(VIP.DEVID,5);

  11656  2 002572   000021 236000 3                  LDQ     17
         2 002573   200145 756100                    STQ     @V+18,,AUTO
         2 002574   200110 236100                    LDQ     VI$,,AUTO
         2 002575   000005 036003                    ADLQ    5,DU
         2 002576   200144 756100                    STQ     @V+17,,AUTO
         2 002577   200144 630500                    EPPR0   @V+17,,AUTO
         2 002600   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002601   000000 701000 xent               TSX1    IVV$ERROR
         2 002602   000000 011000                    NOP     0

      562    11657    5                    GOTO DEL_VI;

  11657  2 002603   004312 710000 2                  TRA     DEL_VI

      563    11658    5                    END;
      564    11659    5                 IF HH<0 THEN DO;

  11659  2 002604   200024 236100                    LDQ     HH,,AUTO
         2 002605   002754 605000 2                  TPL     s:11679

      565    11660    5                    TRACK=CC*DVT.GRANSIZE/VIP.NSECTS;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:108  
  11660  2 002606   200020 471500                    LDP1    DVT$,,AUTO
         2 002607   100053 236100                    LDQ     43,,PR1
         2 002610   000777 376007                    ANQ     511,DL
         2 002611   200013 402100                    MPY     CC,,AUTO
         2 002612   200144 756100                    STQ     @V+17,,AUTO
         2 002613   000014 236100                    LDQ     12,,PR0
         2 002614   000033 772000                    QRL     27
         2 002615   200145 756100                    STQ     @V+18,,AUTO
         2 002616   200144 236100                    LDQ     @V+17,,AUTO
         2 002617   200145 506100                    DIV     @V+18,,AUTO
         2 002620   000000 620006                    EAX0    0,QL
         2 002621   200104 740100                    STX0    TRACK,,AUTO

      566    11661    5                    TRACK=(TRACK/VIP.NHEADS)*(IV_CYLM-VIP.NHEADS)+TRACK;

  11661  2 002622   000014 236100                    LDQ     12,,PR0
         2 002623   000022 772000                    QRL     18
         2 002624   000777 376007                    ANQ     511,DL
         2 002625   200144 756100                    STQ     @V+17,,AUTO
         2 002626   200104 236100                    LDQ     TRACK,,AUTO
         2 002627   000022 772000                    QRL     18
         2 002630   200144 506100                    DIV     @V+17,,AUTO
         2 002631   200145 756100                    STQ     @V+18,,AUTO
         2 002632   000014 236100                    LDQ     12,,PR0
         2 002633   000022 772000                    QRL     18
         2 002634   000777 376007                    ANQ     511,DL
         2 002635   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 002636   000401 036007                    ADLQ    257,DL
         2 002637   200146 756100                    STQ     @V+19,,AUTO
         2 002640   200145 236100                    LDQ     @V+18,,AUTO
         2 002641   200146 402100                    MPY     @V+19,,AUTO
         2 002642   200104 235100                    LDA     TRACK,,AUTO
         2 002643   000022 771000                    ARL     18
         2 002644   200147 755100                    STA     @V+20,,AUTO
         2 002645   200147 036100                    ADLQ    @V+20,,AUTO
         2 002646   000000 621006                    EAX1    0,QL
         2 002647   200104 741100                    STX1    TRACK,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:109  

      567    11662    5                    LTRACK=((CC+1)*DVT.GRANSIZE-1)/VIP.NSECTS;

  11662  2 002650   100053 236100                    LDQ     43,,PR1
         2 002651   000777 376007                    ANQ     511,DL
         2 002652   200144 756100                    STQ     @V+17,,AUTO
         2 002653   200013 236100                    LDQ     CC,,AUTO
         2 002654   000001 036007                    ADLQ    1,DL
         2 002655   200144 402100                    MPY     @V+17,,AUTO
         2 002656   200145 756100                    STQ     @V+18,,AUTO
         2 002657   000014 236100                    LDQ     12,,PR0
         2 002660   000033 772000                    QRL     27
         2 002661   200146 756100                    STQ     @V+19,,AUTO
         2 002662   200145 236100                    LDQ     @V+18,,AUTO
         2 002663   000001 136007                    SBLQ    1,DL
         2 002664   200146 506100                    DIV     @V+19,,AUTO
         2 002665   200032 756100                    STQ     LTRACK,,AUTO

      568    11663    5                    LTRACK=(LTRACK/VIP.NHEADS)*(IV_CYLM-VIP.NHEADS)+LTRACK;

  11663  2 002666   000014 236100                    LDQ     12,,PR0
         2 002667   000022 772000                    QRL     18
         2 002670   000777 376007                    ANQ     511,DL
         2 002671   200144 756100                    STQ     @V+17,,AUTO
         2 002672   200032 236100                    LDQ     LTRACK,,AUTO
         2 002673   200144 506100                    DIV     @V+17,,AUTO
         2 002674   200145 756100                    STQ     @V+18,,AUTO
         2 002675   000014 236100                    LDQ     12,,PR0
         2 002676   000022 772000                    QRL     18
         2 002677   000777 376007                    ANQ     511,DL
         2 002700   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 002701   000401 036007                    ADLQ    257,DL
         2 002702   200146 756100                    STQ     @V+19,,AUTO
         2 002703   200145 236100                    LDQ     @V+18,,AUTO
         2 002704   200146 402100                    MPY     @V+19,,AUTO
         2 002705   200032 036100                    ADLQ    LTRACK,,AUTO
         2 002706   200032 756100                    STQ     LTRACK,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:110  

      569    11664    6                    IF LTRACK>=VIP.NCYLS*IV_CYLM THEN DO;

  11664  2 002707   000014 236100                    LDQ     12,,PR0
         2 002710   000010 736000                    QLS     8
         2 002711   000022 376000 3                  ANQ     18
         2 002712   200032 116100                    CMPQ    LTRACK,,AUTO
         2 002713   002726 605400 2                  TPNZ    s:11669

      570    11665    6   DT_ERR:
      571    11666    6                       CALL IVV$ERROR(VIP.DEVID,3);

  11666  2 002714   000023 236000 3     DT_ERR       LDQ     19
         2 002715   200145 756100                    STQ     @V+18,,AUTO
         2 002716   200110 236100                    LDQ     VI$,,AUTO
         2 002717   000005 036003                    ADLQ    5,DU
         2 002720   200144 756100                    STQ     @V+17,,AUTO
         2 002721   200144 630500                    EPPR0   @V+17,,AUTO
         2 002722   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002723   000000 701000 xent               TSX1    IVV$ERROR
         2 002724   000000 011000                    NOP     0

      572    11667    6                       GOTO NEXT_DT;

  11667  2 002725   002510 710000 2                  TRA     NEXT_DT

      573    11668    6                       END;
      574    11669    5                    VID.DTT(DTTX)=TRACK;

  11669  2 002726   200111 473500                    LDP3    VID$,,AUTO
         2 002727   200017 720100                    LXL0    DTTX,,AUTO
         2 002730   300400 741110                    STX1    256,X0,PR3

      575    11670    5                    IF VIP.NEWDTS THEN

  11670  2 002731   200110 470500                    LDP0    VI$,,AUTO
         2 002732   000017 236100                    LDQ     15,,PR0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:111  
         2 002733   040000 316007                    CANQ    16384,DL
         2 002734   002740 600000 2                  TZE     s:11672

      576    11671    5                       VIP.RANGE.FTRACK(VIP.NRANGES)=TRACK;

  11671  2 002735   000020 236100                    LDQ     16,,PR0
         2 002736   000033 772000                    QRL     27
         2 002737   000024 741106                    STX1    20,QL,PR0

      577    11672    6                    IF LTRACK~=TRACK THEN DO;

  11672  2 002740   200104 236100                    LDQ     TRACK,,AUTO
         2 002741   000022 772000                    QRL     18
         2 002742   200032 116100                    CMPQ    LTRACK,,AUTO
         2 002743   003005 600000 2                  TZE     s:11684

      578    11673    6                       DTTX=DTTX+1;

  11673  2 002744   200017 054100                    AOS     DTTX,,AUTO

      579    11674    6                       IF DTTX>=63 THEN GOTO DTT_OVERFLOW;

  11674  2 002745   200017 235100                    LDA     DTTX,,AUTO
         2 002746   000077 115007                    CMPA    63,DL
         2 002747   002550 605000 2                  TPL     DTT_OVERFLOW

      580    11675    6                       VID.DTT(DTTX)=LTRACK;

  11675  2 002750   200032 720100                    LXL0    LTRACK,,AUTO
         2 002751   200111 470500                    LDP0    VID$,,AUTO
         2 002752   000400 740105                    STX0    256,AL,PR0

      581    11676    6                       END;

      582    11677    5                    END/* IF HH */;

  11677  2 002753   003005 710000 2                  TRA     s:11684
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:112  

      583    11678    5                 ELSE DO;

      584    11679    5                    IF CC>=VIP.NCYLS OR HH>=VIP.NHEADS THEN GOTO DT_ERR;

  11679  2 002754   000014 236100                    LDQ     12,,PR0
         2 002755   777777 376007                    ANQ     -1,DL
         2 002756   200013 116100                    CMPQ    CC,,AUTO
         2 002757   002714 604400 2                  TMOZ    DT_ERR
         2 002760   000014 236100                    LDQ     12,,PR0
         2 002761   000022 772000                    QRL     18
         2 002762   000777 376007                    ANQ     511,DL
         2 002763   200024 116100                    CMPQ    HH,,AUTO
         2 002764   002714 604400 2                  TMOZ    DT_ERR

      585    11680    5                    VID.DTT(DTTX)=CC*IV_CYLM+HH;

  11680  2 002765   200013 236100                    LDQ     CC,,AUTO
         2 002766   000010 736000                    QLS     8
         2 002767   200024 036100                    ADLQ    HH,,AUTO
         2 002770   000000 620006                    EAX0    0,QL
         2 002771   200111 471500                    LDP1    VID$,,AUTO
         2 002772   100400 740105                    STX0    256,AL,PR1

      586    11681    5                    IF VIP.NEWDTS THEN

  11681  2 002773   200110 470500                    LDP0    VI$,,AUTO
         2 002774   000017 236100                    LDQ     15,,PR0
         2 002775   040000 316007                    CANQ    16384,DL
         2 002776   003005 600000 2                  TZE     s:11684

      587    11682    5                       VIP.RANGE.FTRACK(VIP.NRANGES)=VID.DTT(DTTX);

  11682  2 002777   000020 236100                    LDQ     16,,PR0
         2 003000   000033 772000                    QRL     27
         2 003001   200111 471500                    LDP1    VID$,,AUTO
         2 003002   200017 720100                    LXL0    DTTX,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:113  
         2 003003   100400 221110                    LDX1    256,X0,PR1
         2 003004   000024 741106                    STX1    20,QL,PR0

      588    11683    5                    END;

      589    11684    5                 IF VIP.NEWDTS THEN DO;

  11684  2 003005   200110 470500                    LDP0    VI$,,AUTO
         2 003006   000017 236100                    LDQ     15,,PR0
         2 003007   040000 316007                    CANQ    16384,DL
         2 003010   003023 600000 2                  TZE     s:11688

      590    11685    5                    VIP.RANGE.LTRACK(VIP.NRANGES)=VID.DTT(DTTX);

  11685  2 003011   000020 236100                    LDQ     16,,PR0
         2 003012   000033 772000                    QRL     27
         2 003013   200111 471500                    LDP1    VID$,,AUTO
         2 003014   200017 720100                    LXL0    DTTX,,AUTO
         2 003015   100400 221110                    LDX1    256,X0,PR1
         2 003016   000024 441106                    SXL1    20,QL,PR0

      591    11686    5                    VIP.NRANGES=VIP.NRANGES+1;

  11686  2 003017   200110 470500                    LDP0    VI$,,AUTO
         2 003020   000020 236100                    LDQ     16,,PR0
         2 003021   001000 036003                    ADLQ    512,DU
         2 003022   000020 552140                    STBQ    16,'40'O,PR0

      592    11687    5                    END;

      593    11688    4                 DTTX=DTTX+1;

  11688  2 003023   200017 054100                    AOS     DTTX,,AUTO

      594    11689    4                 VIP.DTTCH='1'B;

  11689  2 003024   200110 470500                    LDP0    VI$,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:114  
         2 003025   004000 236007                    LDQ     2048,DL
         2 003026   000017 256100                    ORSQ    15,,PR0

      595    11690    4                 GOTO NEXT_DT;

  11690  2 003027   002510 710000 2                  TRA     NEXT_DT

      596    11691    4               CASE(#DTEND);               /* END OF DEFECTIVE TRACKS */

      597    11692    4                 CALL SORT_DTT;

  11692  2 003030   005667 701000 2                  TSX1    SORT_DTT
         2 003031   000000 011000                    NOP     0
         2 003032   003045 710000 2                  TRA     s:11698

      598    11693    4               CASE(ELSE);

      599    11694    4                 CALL IVV$ERROR(VIP.DEVID,7); /* MISSING DTEND */

  11694  2 003033   000110 236000 3                  LDQ     72
         2 003034   200145 756100                    STQ     @V+18,,AUTO
         2 003035   200110 236100                    LDQ     VI$,,AUTO
         2 003036   000005 036003                    ADLQ    5,DU
         2 003037   200144 756100                    STQ     @V+17,,AUTO
         2 003040   200144 630500                    EPPR0   @V+17,,AUTO
         2 003041   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003042   000000 701000 xent               TSX1    IVV$ERROR
         2 003043   000000 011000                    NOP     0

      600    11695    4                 GOTO NEXT_DT;

  11695  2 003044   002510 710000 2                  TRA     NEXT_DT

      601    11696    4               END/* CASE OUT$BLK.CODE */;

      602    11697    3              END/* IF VIP.DTT */;
      603    11698    3           IF VIP.NRANGES=0 THEN DO;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:115  

  11698  2 003045   200110 470500                    LDP0    VI$,,AUTO
         2 003046   000020 236100                    LDQ     16,,PR0
         2 003047   777000 316003                    CANQ    -512,DU
         2 003050   003146 601000 2                  TNZ     s:11724

      604    11699    3              VIP.NRANGES=1;

  11699  2 003051   001000 236003                    LDQ     512,DU
         2 003052   000020 552140                    STBQ    16,'40'O,PR0

      605    11700    3              IF  VIP.MODEL = 'MSU0451'

  11700  2 003053   200110 470500                    LDP0    VI$,,AUTO
         2 003054   040000 106500                    CMPC    fill='040'O
         2 003055   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 003056   000145 000007 1                  ADSC9   DTTLINE+39               cn=0,n=7
         2 003057   003075 601000 2                  TNZ     s:11706
         2 003060   000017 236100                    LDQ     15,,PR0
         2 003061   000200 316007                    CANQ    128,DL
         2 003062   003075 600000 2                  TZE     s:11706

      606    11701    3                AND VIP.ALT
      607    11702    4              THEN DO ;

      608    11703    4                 VIP.RANGE.LT.CYL(0) = 810 ;

  11703  2 003063   000024 236100                    LDQ     20,,PR0
         2 003064   000111 376000 3                  ANQ     73
         2 003065   625000 276007                    ORQ     -54784,DL
         2 003066   000024 756100                    STQ     20,,PR0

      609    11704    4                 VIP.RANGE.LT.HD(0)  = 18 ;

  11704  2 003067   200110 470500                    LDP0    VI$,,AUTO
         2 003070   000024 236100                    LDQ     20,,PR0
         2 003071   000112 376000 3                  ANQ     74
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:116  
         2 003072   000022 276007                    ORQ     18,DL
         2 003073   000024 756100                    STQ     20,,PR0

      610    11705    4                 END ;

  11705  2 003074   003146 710000 2                  TRA     s:11724

      611    11706    3              ELSE IF  VIP.MODEL = 'MSU0501'

  11706  2 003075   040000 106500                    CMPC    fill='040'O
         2 003076   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 003077   000143 000007 1                  ADSC9   DTTLINE+37               cn=0,n=7
         2 003100   003105 600000 2                  TZE     s:11709
         2 003101   040000 106500                    CMPC    fill='040'O
         2 003102   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 003103   000141 000007 1                  ADSC9   DTTLINE+35               cn=0,n=7
         2 003104   003134 601000 2                  TNZ     s:11720

      612    11707    3                   OR  VIP.MODEL = 'MSU0509'
      613    11708    4                 THEN DO ;

      614    11709    4                    IF VIP.ALT

  11709  2 003105   000017 236100                    LDQ     15,,PR0
         2 003106   000200 316007                    CANQ    128,DL
         2 003107   003122 600000 2                  TZE     s:11715

      615    11710    5                    THEN DO ;

      616    11711    5                       VIP.RANGE.LT.CYL(0) = 839 ;

  11711  2 003110   000024 236100                    LDQ     20,,PR0
         2 003111   000111 376000 3                  ANQ     73
         2 003112   643400 276007                    ORQ     -47360,DL
         2 003113   000024 756100                    STQ     20,,PR0

      617    11712    5                       VIP.RANGE.LT.HD(0) = 39 ;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:117  

  11712  2 003114   200110 470500                    LDP0    VI$,,AUTO
         2 003115   000024 236100                    LDQ     20,,PR0
         2 003116   000112 376000 3                  ANQ     74
         2 003117   000047 276007                    ORQ     39,DL
         2 003120   000024 756100                    STQ     20,,PR0

      618    11713    5                       END ;

  11713  2 003121   003146 710000 2                  TRA     s:11724

      619    11714    5                    ELSE DO ;

      620    11715    5                       VIP.RANGE.LT.CYL(0) = 842 ; /* 842.39 IS CE_DATA_PATTERN */

  11715  2 003122   000024 236100                    LDQ     20,,PR0
         2 003123   000111 376000 3                  ANQ     73
         2 003124   645000 276007                    ORQ     -46592,DL
         2 003125   000024 756100                    STQ     20,,PR0

      621    11716    5                       VIP.RANGE.LT.HD(0) = 39 ;

  11716  2 003126   200110 470500                    LDP0    VI$,,AUTO
         2 003127   000024 236100                    LDQ     20,,PR0
         2 003130   000112 376000 3                  ANQ     74
         2 003131   000047 276007                    ORQ     39,DL
         2 003132   000024 756100                    STQ     20,,PR0

      622    11717    5                       END ;

      623    11718    4                    END ;

  11718  2 003133   003146 710000 2                  TRA     s:11724

      624    11719    4                 ELSE DO ;

      625    11720    4                    VIP.RANGE.LTRACK(0) = ( VIP.T@DCYL * IV_CYLM ) +
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:118  

  11720  2 003134   000014 236100                    LDQ     12,,PR0
         2 003135   000022 772000                    QRL     18
         2 003136   000777 376007                    ANQ     511,DL
         2 003137   200144 756100                    STQ     @V+17,,AUTO
         2 003140   000015 236100                    LDQ     13,,PR0
         2 003141   000012 772000                    QRL     10
         2 003142   000022 376000 3                  ANQ     18
         2 003143   200144 036100                    ADLQ    @V+17,,AUTO
         2 003144   777777 620006                    EAX0    -1,QL
         2 003145   000024 440100                    SXL0    20,,PR0

      626    11721    4                      VIP.NHEADS - 1 ;
      627    11722    4                    END ;

      628    11723    3              END;

      629    11724    3           DO I=0 TO VIP.NRANGES-1;

  11724  2 003146   200027 450100                    STZ     I,,AUTO
         2 003147   003222 710000 2                  TRA     s:11739+1

      630    11725    3              K=0;

  11725  2 003150   200031 450100                    STZ     K,,AUTO

      631    11726    3              TRACK=VIP.RANGE.FTRACK(I);

  11726  2 003151   200110 470500                    LDP0    VI$,,AUTO
         2 003152   200027 720100                    LXL0    I,,AUTO
         2 003153   000024 221110                    LDX1    20,X0,PR0
         2 003154   200104 741100                    STX1    TRACK,,AUTO

      632    11727    3              IF TR.CYL=840 AND TR.HD>=20 THEN GOTO ELT_WK;

  11727  2 003155   200104 236100                    LDQ     TRACK,,AUTO
         2 003156   777400 376003                    ANQ     -256,DU
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:119  
         2 003157   644000 116003                    CMPQ    -47104,DU
         2 003160   003165 601000 2                  TNZ     s:11728
         2 003161   200104 236100                    LDQ     TRACK,,AUTO
         2 003162   000077 376003                    ANQ     63,DU
         2 003163   000024 116003                    CMPQ    20,DU
         2 003164   003356 603000 2                  TRC     ELT_WK

      633    11728    4              DO J=I+1 TO VIP.NRANGES-1;

  11728  2 003165   200027 235100                    LDA     I,,AUTO
         2 003166   000001 035007                    ADLA    1,DL
         2 003167   200030 755100                    STA     J,,AUTO
         2 003170   003202 710000 2                  TRA     s:11733+1

      634    11729    5                 IF TRACK>VIP.RANGE.FTRACK(J) THEN DO;

  11729  2 003171   200110 470500                    LDP0    VI$,,AUTO
         2 003172   200030 720100                    LXL0    J,,AUTO
         2 003173   000024 221110                    LDX1    20,X0,PR0
         2 003174   200104 101100                    CMPX1   TRACK,,AUTO
         2 003175   003201 603000 2                  TRC     s:11733

      635    11730    5                    K=J;

  11730  2 003176   200030 235100                    LDA     J,,AUTO
         2 003177   200031 755100                    STA     K,,AUTO

      636    11731    5                    TRACK=VIP.RANGE.FTRACK(J);

  11731  2 003200   200104 741100                    STX1    TRACK,,AUTO

      637    11732    5                    END;

      638    11733    4                 END/* DO J */;

  11733  2 003201   200030 054100                    AOS     J,,AUTO
         2 003202   000020 236100                    LDQ     16,,PR0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:120  
         2 003203   000033 772000                    QRL     27
         2 003204   200030 116100                    CMPQ    J,,AUTO
         2 003205   003171 605400 2                  TPNZ    s:11729

      639    11734    4              IF K~=0 THEN DO;

  11734  2 003206   200031 235100                    LDA     K,,AUTO
         2 003207   003221 600000 2                  TZE     s:11739

      640    11735    4                 TRANGE=VIP.RANGE(K);

  11735  2 003210   000024 236105                    LDQ     20,AL,PR0
         2 003211   200107 756100                    STQ     TRANGE,,AUTO

      641    11736    4                 VIP.RANGE(K)=VIP.RANGE(I);

  11736  2 003212   200027 720100                    LXL0    I,,AUTO
         2 003213   000024 236110                    LDQ     20,X0,PR0
         2 003214   200031 721100                    LXL1    K,,AUTO
         2 003215   000024 756111                    STQ     20,X1,PR0

      642    11737    4                 VIP.RANGE(I)=TRANGE;

  11737  2 003216   200107 236100                    LDQ     TRANGE,,AUTO
         2 003217   200110 470500                    LDP0    VI$,,AUTO
         2 003220   000024 756110                    STQ     20,X0,PR0

      643    11738    4                 END;

      644    11739    3              END/* DO I */;

  11739  2 003221   200027 054100                    AOS     I,,AUTO
         2 003222   200110 470500                    LDP0    VI$,,AUTO
         2 003223   000020 236100                    LDQ     16,,PR0
         2 003224   000033 772000                    QRL     27
         2 003225   200027 116100                    CMPQ    I,,AUTO
         2 003226   003150 605400 2                  TPNZ    s:11725
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:121  

      645    11740    3           DO I=0 TO VIP.NRANGES-2;

  11740  2 003227   200027 450100                    STZ     I,,AUTO
         2 003230   003334 710000 2                  TRA     s:11753+1

      646    11741    3              TRACK=VIP.RANGE.LTRACK(I);

  11741  2 003231   200110 470500                    LDP0    VI$,,AUTO
         2 003232   200027 720100                    LXL0    I,,AUTO
         2 003233   000024 721110                    LXL1    20,X0,PR0
         2 003234   200104 741100                    STX1    TRACK,,AUTO

      647    11742    3              TR.HD=MOD(TR.HD+1,VIP.NHEADS);

  11742  2 003235   000014 236100                    LDQ     12,,PR0
         2 003236   000022 772000                    QRL     18
         2 003237   000777 376007                    ANQ     511,DL
         2 003240   200144 756100                    STQ     @V+17,,AUTO
         2 003241   200104 236100                    LDQ     TRACK,,AUTO
         2 003242   000022 772000                    QRL     18
         2 003243   000077 376007                    ANQ     63,DL
         2 003244   000001 036007                    ADLQ    1,DL
         2 003245   200144 506100                    DIV     @V+17,,AUTO
         2 003246   000044 733000                    LRS     36
         2 003247   000022 736000                    QLS     18
         2 003250   200104 752110                    STCQ    TRACK,'10'O,AUTO

      648    11743    3              IF TR.HD=0 THEN TR.CYL=TR.CYL+1;

  11743  2 003251   200104 236100                    LDQ     TRACK,,AUTO
         2 003252   000077 316003                    CANQ    63,DU
         2 003253   003263 601000 2                  TNZ     s:11744

  11743  2 003254   200104 236100                    LDQ     TRACK,,AUTO
         2 003255   000032 772000                    QRL     26
         2 003256   000001 036007                    ADLQ    1,DL
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:122  
         2 003257   000032 736000                    QLS     26
         2 003260   200104 676100                    ERQ     TRACK,,AUTO
         2 003261   777400 376003                    ANQ     -256,DU
         2 003262   200104 656100                    ERSQ    TRACK,,AUTO

      649    11744    3              IF TR.CYL=840 AND TR.HD>=20 THEN GOTO ELT_WK;

  11744  2 003263   200104 236100                    LDQ     TRACK,,AUTO
         2 003264   777400 376003                    ANQ     -256,DU
         2 003265   644000 116003                    CMPQ    -47104,DU
         2 003266   003273 601000 2                  TNZ     s:11745
         2 003267   200104 236100                    LDQ     TRACK,,AUTO
         2 003270   000077 376003                    ANQ     63,DU
         2 003271   000024 116003                    CMPQ    20,DU
         2 003272   003356 603000 2                  TRC     ELT_WK

      650    11745    4              IF TRACK>=VIP.RANGE.FTRACK(I+1) THEN DO;

  11745  2 003273   200104 221100                    LDX1    TRACK,,AUTO
         2 003274   000025 101110                    CMPX1   21,X0,PR0
         2 003275   003333 602000 2                  TNC     s:11753

      651    11746    4                IF VIP.RANGE.LTRACK(I+1)>VIP.RANGE.LTRACK(I) THEN VIP.RANGE.LTRACK(I)=
             11746                          VIP.RANGE.LTRACK(I+1);

  11746  2 003276   000025 236110                    LDQ     21,X0,PR0
         2 003277   777777 376007                    ANQ     -1,DL
         2 003300   200144 756100                    STQ     @V+17,,AUTO
         2 003301   000024 236110                    LDQ     20,X0,PR0
         2 003302   777777 376007                    ANQ     -1,DL
         2 003303   200144 116100                    CMPQ    @V+17,,AUTO
         2 003304   003307 605000 2                  TPL     s:11747

  11746  2 003305   000025 722110                    LXL2    21,X0,PR0
         2 003306   000024 442110                    SXL2    20,X0,PR0

      652    11747    5                 DO J=I+1 TO VIP.NRANGES-2;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:123  

  11747  2 003307   200027 235100                    LDA     I,,AUTO
         2 003310   000001 035007                    ADLA    1,DL
         2 003311   200030 755100                    STA     J,,AUTO
         2 003312   003320 710000 2                  TRA     s:11749+1

      653    11748    5                    VIP.RANGE(J)=VIP.RANGE(J+1);

  11748  2 003313   200110 470500                    LDP0    VI$,,AUTO
         2 003314   200030 720100                    LXL0    J,,AUTO
         2 003315   000025 236110                    LDQ     21,X0,PR0
         2 003316   000024 756110                    STQ     20,X0,PR0

      654    11749    5                    END;

  11749  2 003317   200030 054100                    AOS     J,,AUTO
         2 003320   200110 470500                    LDP0    VI$,,AUTO
         2 003321   000020 236100                    LDQ     16,,PR0
         2 003322   000033 772000                    QRL     27
         2 003323   000002 136007                    SBLQ    2,DL
         2 003324   200030 116100                    CMPQ    J,,AUTO
         2 003325   003313 605000 2                  TPL     s:11748

      655    11750    4                 VIP.NRANGES=VIP.NRANGES-1;

  11750  2 003326   000020 236100                    LDQ     16,,PR0
         2 003327   777000 036003                    ADLQ    -512,DU
         2 003330   000020 552140                    STBQ    16,'40'O,PR0

      656    11751    4                 I=I-1;

  11751  2 003331   000001 336007                    LCQ     1,DL
         2 003332   200027 056100                    ASQ     I,,AUTO

      657    11752    4                 END/* IF VIP. */;

      658    11753    3              END/* DO I */;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:124  

  11753  2 003333   200027 054100                    AOS     I,,AUTO
         2 003334   200110 470500                    LDP0    VI$,,AUTO
         2 003335   000020 236100                    LDQ     16,,PR0
         2 003336   000033 772000                    QRL     27
         2 003337   000002 136007                    SBLQ    2,DL
         2 003340   200027 116100                    CMPQ    I,,AUTO
         2 003341   003231 605000 2                  TPL     s:11741

      659    11754    2           TRACK=VIP.RANGE.LTRACK(VIP.NRANGES-1);

  11754  2 003342   000020 236100                    LDQ     16,,PR0
         2 003343   000033 772000                    QRL     27
         2 003344   000023 720106                    LXL0    19,QL,PR0
         2 003345   200104 740100                    STX0    TRACK,,AUTO

      660    11755    3           IF TR.CYL=840 AND TR.HD>=20 THEN DO;

  11755  2 003346   200104 236100                    LDQ     TRACK,,AUTO
         2 003347   777400 376003                    ANQ     -256,DU
         2 003350   644000 116003                    CMPQ    -47104,DU
         2 003351   003370 601000 2                  TNZ     s:11759
         2 003352   200104 236100                    LDQ     TRACK,,AUTO
         2 003353   000077 376003                    ANQ     63,DU
         2 003354   000024 116003                    CMPQ    20,DU
         2 003355   003370 602000 2                  TNC     s:11759

      661    11756    3   ELT_WK:    CALL IVV$ERROR(VIP.DEVID,16);

  11756  2 003356   000114 236000 3     ELT_WK       LDQ     76
         2 003357   200145 756100                    STQ     @V+18,,AUTO
         2 003360   200110 236100                    LDQ     VI$,,AUTO
         2 003361   000005 036003                    ADLQ    5,DU
         2 003362   200144 756100                    STQ     @V+17,,AUTO
         2 003363   200144 630500                    EPPR0   @V+17,,AUTO
         2 003364   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003365   000000 701000 xent               TSX1    IVV$ERROR
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:125  
         2 003366   000000 011000                    NOP     0

      662    11757    3              GOTO DEL_VI;

  11757  2 003367   004312 710000 2                  TRA     DEL_VI

      663    11758    3              END;
      664    11759    2           CALL IVV$FMTPAC(VIP,FMT$);

  11759  2 003370   200021 631500                    EPPR1   FMT$,,AUTO
         2 003371   200145 451500                    STP1    @V+18,,AUTO
         2 003372   200110 236100                    LDQ     VI$,,AUTO
         2 003373   200144 756100                    STQ     @V+17,,AUTO
         2 003374   200144 630500                    EPPR0   @V+17,,AUTO
         2 003375   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003376   000000 701000 xent               TSX1    IVV$FMTPAC
         2 003377   000000 011000                    NOP     0

      665    11760    2           NHW=SIZEW(FMT.HEADER)+BITBIN(DVT.GRANSIZE=2)*82;

  11760  2 003400   400000 220003                    LDX0    -131072,DU
         2 003401   200020 470500                    LDP0    DVT$,,AUTO
         2 003402   000053 236100                    LDQ     43,,PR0
         2 003403   000777 376007                    ANQ     511,DL
         2 003404   000002 116007                    CMPQ    2,DL
         2 003405   003407 600000 2                  TZE     s:11760+7
         2 003406   000000 220003                    LDX0    0,DU
         2 003407   000000 636010                    EAQ     0,X0
         2 003410   000043 772000                    QRL     35
         2 003411   000122 402007                    MPY     82,DL
         2 003412   000006 036007                    ADLQ    6,DL
         2 003413   200033 756100                    STQ     NHW,,AUTO

      666    11761    2           NW=BITBIN(VIP.TEST)*VIP.NSECTS*DVT.SECSIZE;

  11761  2 003414   200110 471500                    LDP1    VI$,,AUTO
         2 003415   100017 236100                    LDQ     15,,PR1
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:126  
         2 003416   000017 772000                    QRL     15
         2 003417   000001 376007                    ANQ     1,DL
         2 003420   200144 756100                    STQ     @V+17,,AUTO
         2 003421   100014 236100                    LDQ     12,,PR1
         2 003422   000033 772000                    QRL     27
         2 003423   200145 756100                    STQ     @V+18,,AUTO
         2 003424   200144 236100                    LDQ     @V+17,,AUTO
         2 003425   200145 402100                    MPY     @V+18,,AUTO
         2 003426   200146 756100                    STQ     @V+19,,AUTO
         2 003427   000056 236100                    LDQ     46,,PR0
         2 003430   000022 772000                    QRL     18
         2 003431   200147 756100                    STQ     @V+20,,AUTO
         2 003432   200146 236100                    LDQ     @V+19,,AUTO
         2 003433   200147 402100                    MPY     @V+20,,AUTO
         2 003434   200034 756100                    STQ     NW,,AUTO

      667    11762    2           VIP.FMT$=FMT$;

  11762  2 003435   200021 236100                    LDQ     FMT$,,AUTO
         2 003436   100013 756100                    STQ     11,,PR1

      668    11763    3           IF VIP.TEST THEN DO;

  11763  2 003437   200110 470500                    LDP0    VI$,,AUTO
         2 003440   000017 236100                    LDQ     15,,PR0
         2 003441   100000 316007                    CANQ    32768,DL
         2 003442   003463 600000 2                  TZE     s:11770

      669    11764    3              BB='525252525252'O;

  11764  2 003443   000152 236000 1                  LDQ     DTTLINE+44
         2 003444   200012 756100                    STQ     BB,,AUTO

      670    11765    4              DO I=NHW TO NW+NHW-1;

  11765  2 003445   200033 235100                    LDA     NHW,,AUTO
         2 003446   200027 755100                    STA     I,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:127  
         2 003447   003457 710000 2                  TRA     s:11768+1

      671    11766    4                 FMT.DATA(I)=BB;

  11766  2 003450   200012 236100                    LDQ     BB,,AUTO
         2 003451   200021 470500                    LDP0    FMT$,,AUTO
         2 003452   200027 720100                    LXL0    I,,AUTO
         2 003453   000021 756110                    STQ     17,X0,PR0

      672    11767    4                 BB=~BB;

  11767  2 003454   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 003455   200012 756100                    STQ     BB,,AUTO

      673    11768    4                 END;

  11768  2 003456   200027 054100                    AOS     I,,AUTO
         2 003457   200034 236100                    LDQ     NW,,AUTO
         2 003460   200033 036100                    ADLQ    NHW,,AUTO
         2 003461   200027 116100                    CMPQ    I,,AUTO
         2 003462   003450 605400 2                  TPNZ    s:11766

      674    11769    3              END;

      675    11770    2           FMT.IDCW='177700700000'O;       /* FORMAT TRACK */

  11770  2 003463   000153 236000 1                  LDQ     DTTLINE+45
         2 003464   200021 470500                    LDP0    FMT$,,AUTO
         2 003465   000002 756100                    STQ     2,,PR0

      676    11771    2           FMT.DCW=FMT.HEADER_DCW;

  11771  2 003466   200021 470500                    LDP0    FMT$,,AUTO
         2 003467   000100 100500                    MLR     fill='000'O
         2 003470   000011 000020                    ADSC9   9,,PR0                   cn=0,n=16
         2 003471   000003 000020                    ADSC9   3,,PR0                   cn=0,n=16

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:128  
      677    11772    2           VIP.STEP=0;

  11772  2 003472   200110 470500                    LDP0    VI$,,AUTO
         2 003473   000115 236000 3                  LDQ     77
         2 003474   000017 356100                    ANSQ    15,,PR0

      678    11773    3           DO SELECT(VIP.MODEL);

  11773  2 003475   200110 470500                    LDP0    VI$,,AUTO
         2 003476   040000 106500                    CMPC    fill='040'O
         2 003477   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 003500   000141 000010 1                  ADSC9   DTTLINE+35               cn=0,n=8
         2 003501   003504 602000 2                  TNC     s:11773+7
         2 003502   003511 600000 2                  TZE     s:11775
         2 003503   003617 710000 2                  TRA     s:11790
         2 003504   040000 106500                    CMPC    fill='040'O
         2 003505   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 003506   000143 000010 1                  ADSC9   DTTLINE+37               cn=0,n=8
         2 003507   003617 601000 2                  TNZ     s:11790
         2 003510   003511 710000 2                  TRA     s:11775

      679    11774    3              SELECT('MSU0509 ','MSU0501 ');

      680    11775    3              VIP.CTRACK=VIP.RANGE.FTRACK(0);

  11775  2 003511   000024 220100                    LDX0    20,,PR0
         2 003512   000016 740100                    STX0    14,,PR0

      681    11776    3              IF VIP.CTR.CYL=840 AND VIP.CTR.HD>=20 THEN GOTO ELT_WK;

  11776  2 003513   200110 470500                    LDP0    VI$,,AUTO
         2 003514   000016 236100                    LDQ     14,,PR0
         2 003515   777400 376003                    ANQ     -256,DU
         2 003516   644000 116003                    CMPQ    -47104,DU
         2 003517   003524 601000 2                  TNZ     s:11777
         2 003520   000016 236100                    LDQ     14,,PR0
         2 003521   000377 376003                    ANQ     255,DU
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:129  
         2 003522   000024 116003                    CMPQ    20,DU
         2 003523   003356 603000 2                  TRC     ELT_WK

      682    11777    3              CALL IVV$FMTPAC(VIP,ELT$)ALTRET(NO_SPACE_1);

  11777  2 003524   200103 631500                    EPPR1   ELT$,,AUTO
         2 003525   200145 451500                    STP1    @V+18,,AUTO
         2 003526   200110 236100                    LDQ     VI$,,AUTO
         2 003527   200144 756100                    STQ     @V+17,,AUTO
         2 003530   200144 630500                    EPPR0   @V+17,,AUTO
         2 003531   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003532   000000 701000 xent               TSX1    IVV$FMTPAC
         2 003533   004267 702000 2                  TSX2    NO_SPACE_1

      683    11778    3              VIP.ELT$=ELT$;

  11778  2 003534   200103 236100                    LDQ     ELT$,,AUTO
         2 003535   200110 470500                    LDP0    VI$,,AUTO
         2 003536   000003 756100                    STQ     3,,PR0

      684    11779    3              TR.CYL=840;TR.X=0;TR.HD=20;  /* CYL 840 HEAD 20 IN BINARY FORM */

  11779  2 003537   200104 236100                    LDQ     TRACK,,AUTO
         2 003540   000116 376000 3                  ANQ     78
         2 003541   644000 276003                    ORQ     -47104,DU
         2 003542   200104 756100                    STQ     TRACK,,AUTO

  11779  2 003543   000117 236000 3                  LDQ     79
         2 003544   200104 356100                    ANSQ    TRACK,,AUTO

  11779  2 003545   000024 236003                    LDQ     20,DU
         2 003546   200104 752110                    STCQ    TRACK,'10'O,AUTO

      685    11780    3              CALL CONVMPC(ELT.SEEK.SECTOR); /* CONVERT CCCC.HH TO MPC FORMAT */

  11780  2 003547   200103 236100                    LDQ     ELT$,,AUTO
         2 003550   000120 036000 3                  ADLQ    80
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:130  
         2 003551   200115 756100                    STQ     VIP$+3,,AUTO
         2 003552   006333 701000 2                  TSX1    CONVMPC
         2 003553   000000 011000                    NOP     0

      686    11781    3              ELT.SEEK.Y='1'B;             /* ADD PHYSICAL ADDR MODE BIT */

  11781  2 003554   200103 470500                    LDP0    ELT$,,AUTO
         2 003555   000010 236003                    LDQ     8,DU
         2 003556   000007 256100                    ORSQ    7,,PR0

      687    11782    3              HDR5$=PINCRW(ADDR(ELT.HEADER),6); /* 451 HDR SZ IS 6 */

  11782  2 003557   200103 236100                    LDQ     ELT$,,AUTO
         2 003560   000027 036003                    ADLQ    23,DU
         2 003561   200101 756100                    STQ     HDR5$,,AUTO

      688    11783    3              DATA$=PINCRW(ADDR(ELT.HEADER),88); /* 50X HDR SZ IS 88 WORDS */

  11783  2 003562   200103 236100                    LDQ     ELT$,,AUTO
         2 003563   000151 036003                    ADLQ    105,DU
         2 003564   200102 756100                    STQ     DATA$,,AUTO

      689    11784    3              ELT.DCW=ELT.HEADER_DCW;CF='0'B;LOG_BIT='0'B;

  11784  2 003565   200103 470500                    LDP0    ELT$,,AUTO
         2 003566   000100 100500                    MLR     fill='000'O
         2 003567   000011 000020                    ADSC9   9,,PR0                   cn=0,n=16
         2 003570   000003 000020                    ADSC9   3,,PR0                   cn=0,n=16

  11784  2 003571   200101 470500                    LDP0    HDR5$,,AUTO
         2 003572   000100 100400                    MLR     fill='000'O
         2 003573   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 003574   000000 000510                    ADSC9   0,,PR0                   cn=0,n=328

  11784  2 003575   200102 471500                    LDP1    DATA$,,AUTO
         2 003576   040000 220003                    LDX0    16384,DU
         2 003577   000140 100400                    MLR     fill='000'O
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:131  
         2 003600   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 003601   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      690    11785    3              VIP.LOGX=0;

  11785  2 003602   200110 473500                    LDP3    VI$,,AUTO
         2 003603   300004 450100                    STZ     4,,PR3

      691    11786    3              FMT.SEEK.Y='1'B;             /* ADD PHYSICAL ADDR MODE BIT */

  11786  2 003604   200021 473500                    LDP3    FMT$,,AUTO
         2 003605   000010 236003                    LDQ     8,DU
         2 003606   300007 256100                    ORSQ    7,,PR3

      692    11787
      693    11788    3              CALL IVV$NEXT(VIP,0) ALTRET(DISK_ERR);

  11788  2 003607   000001 236000 3                  LDQ     1
         2 003610   200110 235100                    LDA     VI$,,AUTO
         2 003611   200144 757100                    STAQ    @V+17,,AUTO
         2 003612   200144 630500                    EPPR0   @V+17,,AUTO
         2 003613   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003614   000000 701000 xent               TSX1    IVV$NEXT
         2 003615   004301 702000 2                  TSX2    DISK_ERR
         2 003616   003662 710000 2                  TRA     s:11796

      694    11789    3              SELECT(ELSE);

      695    11790    3           FMT.SEEK_IDCW='347700720000'O;

  11790  2 003617   000154 236000 1                  LDQ     DTTLINE+46
         2 003620   200021 471500                    LDP1    FMT$,,AUTO
         2 003621   100000 756100                    STQ     0,,PR1

      696    11791    3           FMT.SEEK.SECTOR=( VIP.RANGE.FT.CYL(0)*VIP.NHEADS+

  11791  2 003622   200110 470500                    LDP0    VI$,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:132  
         2 003623   000014 236100                    LDQ     12,,PR0
         2 003624   000022 772000                    QRL     18
         2 003625   000777 376007                    ANQ     511,DL
         2 003626   200144 756100                    STQ     @V+17,,AUTO
         2 003627   000024 236100                    LDQ     20,,PR0
         2 003630   000032 772000                    QRL     26
         2 003631   200144 402100                    MPY     @V+17,,AUTO
         2 003632   200145 756100                    STQ     @V+18,,AUTO
         2 003633   000024 236100                    LDQ     20,,PR0
         2 003634   000022 772000                    QRL     18
         2 003635   000377 376007                    ANQ     255,DL
         2 003636   200146 756100                    STQ     @V+19,,AUTO
         2 003637   200145 236100                    LDQ     @V+18,,AUTO
         2 003640   200146 036100                    ADLQ    @V+19,,AUTO
         2 003641   200147 756100                    STQ     @V+20,,AUTO
         2 003642   000014 236100                    LDQ     12,,PR0
         2 003643   000033 772000                    QRL     27
         2 003644   200150 756100                    STQ     @V+21,,AUTO
         2 003645   200147 236100                    LDQ     @V+20,,AUTO
         2 003646   200150 402100                    MPY     @V+21,,AUTO
         2 003647   200021 471500                    LDP1    FMT$,,AUTO
         2 003650   100007 676100                    ERQ     7,,PR1
         2 003651   000121 376000 3                  ANQ     81
         2 003652   100007 656100                    ERSQ    7,,PR1

      697    11792    3             VIP.RANGE.FT.HD(0)  ) * VIP.NSECTS;
      698    11793    3           CALL IVV$NEXT(VIP,0) ALTRET(DISK_ERR);

  11793  2 003653   000001 236000 3                  LDQ     1
         2 003654   200110 235100                    LDA     VI$,,AUTO
         2 003655   200144 757100                    STAQ    @V+17,,AUTO
         2 003656   200144 630500                    EPPR0   @V+17,,AUTO
         2 003657   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003660   000000 701000 xent               TSX1    IVV$NEXT
         2 003661   004301 702000 2                  TSX2    DISK_ERR

      699    11794    3              END;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:133  

      700    11795                %ENQUEUE(P#=VIP,Q#=VIP$);

  11796  2 003662   200112 236300                    LDQ   ! VIP$,,AUTO
         2 003663   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         2 003664   003671 601200 2                  TNZ   ! s:11796+7

  11796  2 003665   200110 236300                    LDQ   ! VI$,,AUTO
         2 003666   200110 470700                    LDP0  ! VI$,,AUTO
         2 003667   000000 756300                    STQ   ! 0,,PR0
         2 003670   003677 710200 2                  TRA   ! s:11796+13

  11796  2 003671   200112 470700                    LDP0  ! VIP$,,AUTO
         2 003672   000000 236300                    LDQ   ! 0,,PR0
         2 003673   200110 471700                    LDP1  ! VI$,,AUTO
         2 003674   100000 756300                    STQ   ! 0,,PR1

  11796  2 003675   200110 236300                    LDQ   ! VI$,,AUTO
         2 003676   000000 756300                    STQ   ! 0,,PR0

  11796  2 003677   200110 236300                    LDQ   ! VI$,,AUTO
         2 003700   200112 756300                    STQ   ! VIP$,,AUTO

  11796  2 003701   004247 710000 2                  TRA     s:11855

      701    11798    2            CASE(#STATUS);                 /* STATUS COMMAND */

      702    11799    2              OUT=STATUS;

  11799  2 003702   000100 100400                    MLR     fill='000'O
         2 003703   000012 000041 1                  ADSC9   STATUS                   cn=0,n=33
         2 003704   200036 000124                    ADSC9   OUT,,AUTO                cn=0,n=84

      703    11800    2              VI$=VIP$;

  11800  2 003705   200112 236100                    LDQ     VIP$,,AUTO
         2 003706   200110 756100                    STQ     VI$,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:134  

      704    11801    3              IF VI$~=NULL THEN DO;

  11801  2 003707   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003710   004247 600000 2                  TZE     s:11855

      705    11802    3   NEXT_STATUS:
      706    11803    3                 VI$=VIP.FL$;

  11803  2 003711   200110 470500       NEXT_STATUS  LDP0    VI$,,AUTO
         2 003712   000000 236100                    LDQ     0,,PR0
         2 003713   200110 756100                    STQ     VI$,,AUTO

      707    11804    3                 CALL INSERT(OUT.MSG,1,4,VIP.DEVID);

  11804  2 003714   200110 470500                    LDP0    VI$,,AUTO
         2 003715   040100 100500                    MLR     fill='040'O
         2 003716   000005 000004                    ADSC9   5,,PR0                   cn=0,n=4
         2 003717   200037 200004                    ADSC9   OUT+1,,AUTO              cn=1,n=4

      708    11805    3                 CALL IVV$BINDEC(VIP.VSN,OUT.MSG,10,6);

  11805  2 003720   000122 237000 3                  LDAQ    82
         2 003721   200146 757100                    STAQ    @V+19,,AUTO
         2 003722   200037 631500                    EPPR1   OUT+1,,AUTO
         2 003723   200145 451500                    STP1    @V+18,,AUTO
         2 003724   200110 236100                    LDQ     VI$,,AUTO
         2 003725   000011 036003                    ADLQ    9,DU
         2 003726   200144 756100                    STQ     @V+17,,AUTO
         2 003727   200144 630500                    EPPR0   @V+17,,AUTO
         2 003730   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 003731   000000 701000 xent               TSX1    IVV$BINDEC
         2 003732   000000 011000                    NOP     0

      709    11806    4                 DO SELECT(VIP.MODEL);

  11806  2 003733   200110 470500                    LDP0    VI$,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:135  
         2 003734   040000 106500                    CMPC    fill='040'O
         2 003735   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 003736   000143 000010 1                  ADSC9   DTTLINE+37               cn=0,n=8
         2 003737   004010 602000 2                  TNC     s:11814
         2 003740   003746 600000 2                  TZE     s:11808
         2 003741   040000 106500                    CMPC    fill='040'O
         2 003742   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 003743   000141 000010 1                  ADSC9   DTTLINE+35               cn=0,n=8
         2 003744   004010 601000 2                  TNZ     s:11814
         2 003745   003746 710000 2                  TRA     s:11808

      710    11807    4                    SELECT('MSU0501 ','MSU0509 ');

      711    11808    4                    CYL='0'B; HEAD='0'B;

  11808  2 003746   200105 450100                    STZ     CYL,,AUTO

  11808  2 003747   200106 450100                    STZ     HEAD,,AUTO

      712    11809    4                    CYL.N=VIP.CTR.CYL;

  11809  2 003750   000016 236100                    LDQ     14,,PR0
         2 003751   000032 772000                    QRL     26
         2 003752   200105 676100                    ERQ     CYL,,AUTO
         2 003753   001777 376007                    ANQ     1023,DL
         2 003754   200105 656100                    ERSQ    CYL,,AUTO

      713    11810    4                    CALL IVV$BINDEC(CYL,OUT.MSG,20,4);

  11810  2 003755   000124 237000 3                  LDAQ    84
         2 003756   200146 757100                    STAQ    @V+19,,AUTO
         2 003757   200037 631500                    EPPR1   OUT+1,,AUTO
         2 003760   200145 451500                    STP1    @V+18,,AUTO
         2 003761   200105 633500                    EPPR3   CYL,,AUTO
         2 003762   200144 453500                    STP3    @V+17,,AUTO
         2 003763   200144 630500                    EPPR0   @V+17,,AUTO
         2 003764   000022 631400 xsym               EPPR1   B_VECTNIL+18
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:136  
         2 003765   000000 701000 xent               TSX1    IVV$BINDEC
         2 003766   000000 011000                    NOP     0

      714    11811    4                    HEAD.N=VIP.CTR.HD;

  11811  2 003767   200110 470500                    LDP0    VI$,,AUTO
         2 003770   000016 236100                    LDQ     14,,PR0
         2 003771   000022 772000                    QRL     18
         2 003772   200106 676100                    ERQ     HEAD,,AUTO
         2 003773   000377 376007                    ANQ     255,DL
         2 003774   200106 656100                    ERSQ    HEAD,,AUTO

      715    11812    4                    CALL IVV$BINDEC(HEAD,OUT.MSG,25,2);

  11812  2 003775   000126 237000 3                  LDAQ    86
         2 003776   200146 757100                    STAQ    @V+19,,AUTO
         2 003777   200037 631500                    EPPR1   OUT+1,,AUTO
         2 004000   200145 451500                    STP1    @V+18,,AUTO
         2 004001   200106 633500                    EPPR3   HEAD,,AUTO
         2 004002   200144 453500                    STP3    @V+17,,AUTO
         2 004003   200144 630500                    EPPR0   @V+17,,AUTO
         2 004004   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 004005   000000 701000 xent               TSX1    IVV$BINDEC
         2 004006   000000 011000                    NOP     0
         2 004007   004066 710000 2                  TRA     s:11818

      716    11813    4                    SELECT(ELSE);

      717    11814    4                 TRACK=VIP.FMT$->FMT.SEEK.SECTOR/VIP.NSECTS;

  11814  2 004010   000013 471500                    LDP1    11,,PR0
         2 004011   000014 236100                    LDQ     12,,PR0
         2 004012   000033 772000                    QRL     27
         2 004013   200144 756100                    STQ     @V+17,,AUTO
         2 004014   100007 236100                    LDQ     7,,PR1
         2 004015   000121 376000 3                  ANQ     81
         2 004016   200144 506100                    DIV     @V+17,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:137  
         2 004017   000000 620006                    EAX0    0,QL
         2 004020   200104 740100                    STX0    TRACK,,AUTO

      718    11815    4                 CALL IVV$BINDEC(TRACK/VIP.NHEADS,OUT.MSG,20,4);

  11815  2 004021   000014 236100                    LDQ     12,,PR0
         2 004022   000022 772000                    QRL     18
         2 004023   000777 376007                    ANQ     511,DL
         2 004024   200144 756100                    STQ     @V+17,,AUTO
         2 004025   200104 236100                    LDQ     TRACK,,AUTO
         2 004026   000022 772000                    QRL     18
         2 004027   200144 506100                    DIV     @V+17,,AUTO
         2 004030   200145 756100                    STQ     @V+18,,AUTO
         2 004031   000124 237000 3                  LDAQ    84
         2 004032   200150 757100                    STAQ    @V+21,,AUTO
         2 004033   200037 631500                    EPPR1   OUT+1,,AUTO
         2 004034   200147 451500                    STP1    @V+20,,AUTO
         2 004035   200145 633500                    EPPR3   @V+18,,AUTO
         2 004036   200146 453500                    STP3    @V+19,,AUTO
         2 004037   200146 630500                    EPPR0   @V+19,,AUTO
         2 004040   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 004041   000000 701000 xent               TSX1    IVV$BINDEC
         2 004042   000000 011000                    NOP     0

      719    11816    4                 CALL IVV$BINDEC(MOD(TRACK,VIP.NHEADS),OUT.MSG,25,2);

  11816  2 004043   200110 470500                    LDP0    VI$,,AUTO
         2 004044   000014 236100                    LDQ     12,,PR0
         2 004045   000022 772000                    QRL     18
         2 004046   000777 376007                    ANQ     511,DL
         2 004047   200144 756100                    STQ     @V+17,,AUTO
         2 004050   200104 236100                    LDQ     TRACK,,AUTO
         2 004051   000022 772000                    QRL     18
         2 004052   200144 506100                    DIV     @V+17,,AUTO
         2 004053   200145 755100                    STA     @V+18,,AUTO
         2 004054   000126 237000 3                  LDAQ    86
         2 004055   200150 757100                    STAQ    @V+21,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:138  
         2 004056   200037 631500                    EPPR1   OUT+1,,AUTO
         2 004057   200147 451500                    STP1    @V+20,,AUTO
         2 004060   200145 633500                    EPPR3   @V+18,,AUTO
         2 004061   200146 453500                    STP3    @V+19,,AUTO
         2 004062   200146 630500                    EPPR0   @V+19,,AUTO
         2 004063   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 004064   000000 701000 xent               TSX1    IVV$BINDEC
         2 004065   000000 011000                    NOP     0

      720    11817    4                    END;

      721    11818    3              CALL IVO$PRINT(OUT,'0'B);

  11818  2 004066   000001 236000 3                  LDQ     1
         2 004067   200145 756100                    STQ     @V+18,,AUTO
         2 004070   200036 630500                    EPPR0   OUT,,AUTO
         2 004071   200144 450500                    STP0    @V+17,,AUTO
         2 004072   200144 630500                    EPPR0   @V+17,,AUTO
         2 004073   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004074   000000 701000 xent               TSX1    IVO$PRINT
         2 004075   000000 011000                    NOP     0

      722    11819    3              IF VI$~=VIP$ THEN GOTO NEXT_STATUS;

  11819  2 004076   200110 236100                    LDQ     VI$,,AUTO
         2 004077   200112 116100                    CMPQ    VIP$,,AUTO
         2 004100   003711 601000 2                  TNZ     NEXT_STATUS

      723    11820    3                 END;

  11820  2 004101   004247 710000 2                  TRA     s:11855

      724    11821    2            CASE(#READ);                   /* READ COMMAND (OFF-LINE ONLY) */

      725    11822    2              DEVID=OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  11822  2 004102   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:139  
         2 004103   100004 236100                    LDQ     4,,PR1
         2 004104   000033 772000                    QRL     27
         2 004105   000000 621006                    EAX1    0,QL
         2 004106   040100 100540                    MLR     fill='040'O
         2 004107   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 004110   200016 000004                    ADSC9   DEVID,,AUTO              cn=0,n=4

      726    11823    2              CALL IVO$SWIN(DEVID);

  11823  2 004111   200016 631500                    EPPR1   DEVID,,AUTO
         2 004112   200144 451500                    STP1    @V+17,,AUTO
         2 004113   200144 630500                    EPPR0   @V+17,,AUTO
         2 004114   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004115   000000 701000 xent               TSX1    IVO$SWIN
         2 004116   000000 011000                    NOP     0
         2 004117   004247 710000 2                  TRA     s:11855

      727    11824    2            CASE(#PRINT);                  /* PRINT COMMAND (OFF-LINE ONLY) */

      728    11825    2              DEVID=OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  11825  2 004120   000003 471500                    LDP1    3,,PR0
         2 004121   100004 236100                    LDQ     4,,PR1
         2 004122   000033 772000                    QRL     27
         2 004123   000000 621006                    EAX1    0,QL
         2 004124   040100 100540                    MLR     fill='040'O
         2 004125   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 004126   200016 000004                    ADSC9   DEVID,,AUTO              cn=0,n=4

      729    11826    2              CALL IVO$SWOUT(DEVID);

  11826  2 004127   200016 631500                    EPPR1   DEVID,,AUTO
         2 004130   200144 451500                    STP1    @V+17,,AUTO
         2 004131   200144 630500                    EPPR0   @V+17,,AUTO
         2 004132   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004133   000000 701000 xent               TSX1    IVO$SWOUT
         2 004134   000000 011000                    NOP     0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:140  
         2 004135   004247 710000 2                  TRA     s:11855

      730    11827    2            CASE(#STOP);                   /* STOP COMMAND */

      731    11828    2              VI$=VIP$;

  11828  2 004136   200112 236100                    LDQ     VIP$,,AUTO
         2 004137   200110 756100                    STQ     VI$,,AUTO

      732    11829    3              IF VI$~=NULL THEN DO;

  11829  2 004140   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004141   004247 600000 2                  TZE     s:11855

      733    11830    3                 FOUNDF='0'B;

  11830  2 004142   200022 450100                    STZ     FOUNDF,,AUTO

      734    11831    4   NEXT_STOP:    DO;

  11831  2 004143                       NEXT_STOP    null
      735    11832    4                    VI$=VIP.FL$;

  11832  2 004143   200110 470500                    LDP0    VI$,,AUTO
         2 004144   000000 236100                    LDQ     0,,PR0
         2 004145   200110 756100                    STQ     VI$,,AUTO

      736    11833    5                    IF OUT$BLK.NSUBLKS=0 OR VIP.DEVID=OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT
             11833                             THEN DO;

  11833  2 004146   200011 470500                    LDP0    BLK$,,AUTO
         2 004147   000001 220100                    LDX0    1,,PR0
         2 004150   004162 600000 2                  TZE     s:11834
         2 004151   000003 471500                    LDP1    3,,PR0
         2 004152   100004 236100                    LDQ     4,,PR1
         2 004153   000033 772000                    QRL     27
         2 004154   200110 473500                    LDP3    VI$,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:141  
         2 004155   000000 621006                    EAX1    0,QL
         2 004156   040140 106500                    CMPC    fill='040'O
         2 004157   300005 000010                    ADSC9   5,,PR3                   cn=0,n=8
         2 004160   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 004161   004167 601000 2                  TNZ     s:11837

      737    11834    5                       VIP.STOP='1'B;

  11834  2 004162   200110 471500                    LDP1    VI$,,AUTO
         2 004163   010000 236007                    LDQ     4096,DL
         2 004164   100017 256100                    ORSQ    15,,PR1

      738    11835    5                       FOUNDF='1'B;

  11835  2 004165   400000 236003                    LDQ     -131072,DU
         2 004166   200022 756100                    STQ     FOUNDF,,AUTO

      739    11836    5                       END;

      740    11837    4                    IF VI$~=VIP$ THEN GOTO NEXT_STOP;

  11837  2 004167   200110 236100                    LDQ     VI$,,AUTO
         2 004170   200112 116100                    CMPQ    VIP$,,AUTO
         2 004171   004143 601000 2                  TNZ     NEXT_STOP

      741    11838    4                    END NEXT_STOP;

      742    11839    3                 IF NOT FOUNDF THEN CALL IVV$ERROR(OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,2);
             11839                          /* SPEC'D DISK NOT IN VOLINIT */

  11839  2 004172   200022 234100                    SZN     FOUNDF,,AUTO
         2 004173   004247 604000 2                  TMI     s:11855

  11839  2 004174   000003 471500                    LDP1    3,,PR0
         2 004175   000127 236000 3                  LDQ     87
         2 004176   200145 756100                    STQ     @V+18,,AUTO
         2 004177   200146 451500                    STP1    @V+19,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:142  
         2 004200   200146 236100                    LDQ     @V+19,,AUTO
         2 004201   000130 036000 3                  ADLQ    88
         2 004202   200144 756100                    STQ     @V+17,,AUTO
         2 004203   200144 630500                    EPPR0   @V+17,,AUTO
         2 004204   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004205   000000 701000 xent               TSX1    IVV$ERROR
         2 004206   000000 011000                    NOP     0

      743    11840    3                 END/* IF VI$ */;

  11840  2 004207   004247 710000 2                  TRA     s:11855

      744    11841    2            CASE(#END);                    /* END COMMAND */

      745    11842    2   WAITDONE:
      746    11843    2              CALL CHECKDONE;

  11843  2 004210   004411 701000 2     WAITDONE     TSX1    CHECKDONE
         2 004211   000000 011000                    NOP     0

      747    11844    3              IF VIP$~=NULL THEN DO;

  11844  2 004212   200112 236100                    LDQ     VIP$,,AUTO
         2 004213   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004214   004222 600000 2                  TZE     s:11848

      748    11845    3                 CALL IVO$WAIT('1'B) ALTRET(NEXT_CMD);

  11845  2 004215   000131 630400 3                  EPPR0   89
         2 004216   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004217   000000 701000 xent               TSX1    IVO$WAIT
         2 004220   000061 702000 2                  TSX2    NEXT_CMD

      749    11846    3                 GOTO WAITDONE;

  11846  2 004221   004210 710000 2                  TRA     WAITDONE

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:143  
      750    11847    3                 END;
      751    11848    2              CALL IVO$CLEANUP;       /* OFFLINE VOLINIT WONT RETURN FROM THIS */

  11848  2 004222   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004223   000000 701000 xent               TSX1    IVO$CLEANUP
         2 004224   000000 011000                    NOP     0

      752    11849    2              RETURN;

  11849  2 004225   000000 702200 xent               TSX2  ! X66_ARET

      753    11850    2            CASE(#DELTA,#KEYIN);      /* DELTA, KEYIN COMMANDS (OFF-LINE ONLY) */

      754    11851    2              CALL IVO$KEYIN(BINBIT(OUT$BLK.CODE,36));

  11851  2 004226   000000 236100                    LDQ     0,,PR0
         2 004227   777777 376007                    ANQ     -1,DL
         2 004230   200144 756100                    STQ     @V+17,,AUTO
         2 004231   200144 631500                    EPPR1   @V+17,,AUTO
         2 004232   200146 451500                    STP1    @V+19,,AUTO
         2 004233   200146 630500                    EPPR0   @V+19,,AUTO
         2 004234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004235   000000 701000 xent               TSX1    IVO$KEYIN
         2 004236   000000 011000                    NOP     0
         2 004237   004247 710000 2                  TRA     s:11855

      755    11852    2            CASE(ELSE);                    /* DT, DTEND ARE ERRORS */

      756    11853    2              CALL IVV$ERROR(,0);

  11853  2 004240   000001 236000 3                  LDQ     1
         2 004241   000001 235000 xsym               LDA     B_VECTNIL+1
         2 004242   200144 757100                    STAQ    @V+17,,AUTO
         2 004243   200144 630500                    EPPR0   @V+17,,AUTO
         2 004244   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004245   000000 701000 xent               TSX1    IVV$ERROR
         2 004246   000000 011000                    NOP     0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:144  

      757    11854    2            END/* CASE OUT$BLK.CODE */;

      758    11855    2           DO WHILE ('0'B);

  11855  2 004247   004254 710000 2                  TRA     s:11859

      759    11856    2   PARSE_ERR:                              /* PARSING ERROR ON COMMAND */
      760    11857    2              CALL IVV$ERROR('    ',1);

  11857  2 004250   000132 630400 3     PARSE_ERR    EPPR0   90
         2 004251   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004252   000000 701000 xent               TSX1    IVV$ERROR
         2 004253   000000 011000                    NOP     0

      761    11858    2              END;

      762    11859    2           DO WHILE ('0'B);

  11859  2 004254   004367 710000 2                  TRA     s:11881

      763    11860    2   NO_DISK:                                /* DISK NOT FOUND */
      764    11861    2              CALL IVV$ERROR(VIP.DEVID,4);

  11861  2 004255   000125 236000 3     NO_DISK      LDQ     85
         2 004256   200145 756100                    STQ     @V+18,,AUTO
         2 004257   200110 236100                    LDQ     VI$,,AUTO
         2 004260   000005 036003                    ADLQ    5,DU
         2 004261   200144 756100                    STQ     @V+17,,AUTO
         2 004262   200144 630500                    EPPR0   @V+17,,AUTO
         2 004263   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004264   000000 701000 xent               TSX1    IVV$ERROR
         2 004265   000000 011000                    NOP     0

      765    11862    3              DO WHILE ('0'B);

  11862  2 004266   004300 710000 2                  TRA     s:11866
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:145  

      766    11863    3   NO_SPACE_1:                             /* NO SPACE FOR VID */
      767    11864    3                 CALL IVV$ERROR(VIP.DEVID,9);

  11864  2 004267   000134 236000 3     NO_SPACE_1   LDQ     92
         2 004270   200145 756100                    STQ     @V+18,,AUTO
         2 004271   200110 236100                    LDQ     VI$,,AUTO
         2 004272   000005 036003                    ADLQ    5,DU
         2 004273   200144 756100                    STQ     @V+17,,AUTO
         2 004274   200144 630500                    EPPR0   @V+17,,AUTO
         2 004275   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004276   000000 701000 xent               TSX1    IVV$ERROR
         2 004277   000000 011000                    NOP     0

      768    11865    3                 END;

      769    11866    3              DO WHILE ('0'B);

  11866  2 004300   004312 710000 2                  TRA     DEL_VI

      770    11867    3   DISK_ERR:                               /* DISK I/O ERROR */
      771    11868    3                 CALL IVV$ERROR(VIP.DEVID,10);

  11868  2 004301   000122 236000 3     DISK_ERR     LDQ     82
         2 004302   200145 756100                    STQ     @V+18,,AUTO
         2 004303   200110 236100                    LDQ     VI$,,AUTO
         2 004304   000005 036003                    ADLQ    5,DU
         2 004305   200144 756100                    STQ     @V+17,,AUTO
         2 004306   200144 630500                    EPPR0   @V+17,,AUTO
         2 004307   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004310   000000 701000 xent               TSX1    IVV$ERROR
         2 004311   000000 011000                    NOP     0

      772    11869    3                 END;

      773    11870    2   DEL_VI:                                 /* DELETE VOLINIT TABLE ENTRY */
      774    11871    2              IF VIP.FMT$~=NULL THEN
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:146  

  11871  2 004312   200110 470500       DEL_VI       LDP0    VI$,,AUTO
         2 004313   000013 236100                    LDQ     11,,PR0
         2 004314   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004315   004325 600000 2                  TZE     s:11873

      775    11872    2                 CALL IVO$FREE(VIP.FMT$);

  11872  2 004316   200110 236100                    LDQ     VI$,,AUTO
         2 004317   000013 036003                    ADLQ    11,DU
         2 004320   200144 756100                    STQ     @V+17,,AUTO
         2 004321   200144 630500                    EPPR0   @V+17,,AUTO
         2 004322   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004323   000000 701000 xent               TSX1    IVO$FREE
         2 004324   000000 011000                    NOP     0

      776    11873    2              IF VIP.ELT$~=NULL THEN

  11873  2 004325   200110 470500                    LDP0    VI$,,AUTO
         2 004326   000003 236100                    LDQ     3,,PR0
         2 004327   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004330   004340 600000 2                  TZE     s:11875

      777    11874    2                 CALL IVO$FREE(VIP.ELT$);

  11874  2 004331   200110 236100                    LDQ     VI$,,AUTO
         2 004332   000003 036003                    ADLQ    3,DU
         2 004333   200144 756100                    STQ     @V+17,,AUTO
         2 004334   200144 630500                    EPPR0   @V+17,,AUTO
         2 004335   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004336   000000 701000 xent               TSX1    IVO$FREE
         2 004337   000000 011000                    NOP     0

      778    11875    2              IF VIP.VID$~=NULL THEN

  11875  2 004340   200110 470500                    LDP0    VI$,,AUTO
         2 004341   000012 236100                    LDQ     10,,PR0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:147  
         2 004342   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004343   004353 600000 2                  TZE     s:11877

      779    11876    2                 CALL IVO$FREE(VIP.VID$);

  11876  2 004344   200110 236100                    LDQ     VI$,,AUTO
         2 004345   000012 036003                    ADLQ    10,DU
         2 004346   200144 756100                    STQ     @V+17,,AUTO
         2 004347   200144 630500                    EPPR0   @V+17,,AUTO
         2 004350   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004351   000000 701000 xent               TSX1    IVO$FREE
         2 004352   000000 011000                    NOP     0

      780    11877    2              IF IV_ONLINE THEN

  11877  2 004353   000000 234000 xsym               SZN     IV_ONLINE
         2 004354   004361 605000 2                  TPL     s:11879

      781    11878    2                 CALL IVO$RELDCB(VIP);

  11878  2 004355   200110 630500                    EPPR0   VI$,,AUTO
         2 004356   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004357   000000 701000 xent               TSX1    IVO$RELDCB
         2 004360   000000 011000                    NOP     0

      782    11879    2              CALL IVO$FREE(VI$);

  11879  2 004361   200110 630500                    EPPR0   VI$,,AUTO
         2 004362   200144 450500                    STP0    @V+17,,AUTO
         2 004363   200144 630500                    EPPR0   @V+17,,AUTO
         2 004364   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004365   000000 701000 xent               TSX1    IVO$FREE
         2 004366   000000 011000                    NOP     0

      783    11880    2              END;

      784    11881    2           DO WHILE ('0'B);
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:148  

  11881  2 004367   004374 710000 2                  TRA     WAIT_NEXT_CMD

      785    11882    2   NO_SPACE:                               /* NO SPACE FOR VIP */
      786    11883    2              CALL IVV$ERROR('    ',9);

  11883  2 004370   000135 630400 3     NO_SPACE     EPPR0   93
         2 004371   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004372   000000 701000 xent               TSX1    IVV$ERROR
         2 004373   000000 011000                    NOP     0

      787    11884    2              END;

      788    11885    1   WAIT_NEXT_CMD:
      789    11886    1           CALL CHECKDONE;

  11886  2 004374   004411 701000 2     WAIT_NEXT_C* TSX1    CHECKDONE
         2 004375   000000 011000                    NOP     0

      790    11887    1           IF VIP$=NULL THEN GOTO NEXT_CMD;

  11887  2 004376   200112 236100                    LDQ     VIP$,,AUTO
         2 004377   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004400   000061 600000 2                  TZE     NEXT_CMD

      791    11888    1           CALL IVO$BATCH ALTRET(NEXT_CMD);

  11888  2 004401   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 004402   000000 701000 xent               TSX1    IVO$BATCH
         2 004403   000061 702000 2                  TSX2    NEXT_CMD

      792    11889    1           CALL IVO$WAIT('1'B) ALTRET(NEXT_CMD);

  11889  2 004404   000131 630400 3                  EPPR0   89
         2 004405   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004406   000000 701000 xent               TSX1    IVO$WAIT
         2 004407   000061 702000 2                  TSX2    NEXT_CMD
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:149  

      793    11890    1           GOTO WAIT_NEXT_CMD;

  11890  2 004410   004374 710000 2                  TRA     WAIT_NEXT_CMD

      794    11891        %EJECT;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:150  
      795    11892        /* CHECK FOR VOLINITS DONE */
      796    11893    1   CHECKDONE: PROC;

  11893  2 004411   200114 741300       CHECKDONE    STX1  ! VIP$+2,,AUTO

      797    11894        /**/
      798    11895        /* CONSTANT DATA */
      799    11896        /**/
      800    11897    2   DCL 1 DONE CONSTANT,
      801    11898    2         2 LEN SBIN,
      802    11899    2         2 MSG CHAR(0) INIT(
             11899            'AVOLINIT of VSN:000000 on DP00 stopped at CCCC.HH, DTT overflow, disk error. '
             11899                  );
      803    11900        /**/
      804    11901        /* AUTO STACK */
      805    11902        /**/
      806    11903    2   DCL PVI$ PTR;
      807    11904        /**/
      808    11905    3           DO WHILE(IV_IO$~=ADDR(NIL));

  11905  2 004412   004511 710000 2                  TRA     s:11935

      809    11906    4              DO INHIBIT;

      810    11907    4                 VI$=IV_IO$;

  11907  2 004413   000000 236200 xsym               LDQ   ! IV_IO$
         2 004414   200110 756300                    STQ   ! VI$,,AUTO

      811    11908    4                 IV_IO$=VIP.IO$;

  11908  2 004415   200110 470700                    LDP0  ! VI$,,AUTO
         2 004416   000001 236300                    LDQ   ! 1,,PR0
         2 004417   000000 756200 xsym               STQ   ! IV_IO$

      812    11909    4                 END;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:151  
      813    11910    3              CALL IVO$QUEIO(VIP) ALTRET(QUE_ERR);

  11910  2 004420   200110 630500                    EPPR0   VI$,,AUTO
         2 004421   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004422   000000 701000 xent               TSX1    IVO$QUEIO
         2 004423   004425 702000 2                  TSX2    QUE_ERR

      814    11911    4              DO WHILE('0'B);

  11911  2 004424   004511 710000 2                  TRA     s:11935

      815    11912    5   QUE_ERR:      IF IV_ONLINE THEN DO;

  11912  2 004425   000000 234000 xsym  QUE_ERR      SZN     IV_ONLINE
         2 004426   004503 605000 2                  TPL     s:11932

      816    11913    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$TDNOPERM THEN

  11913  2 004427   000000 470400 xsym               LDP0    B$TCB$
         2 004430   000000 471500                    LDP1    0,,PR0
         2 004431   100102 236100                    LDQ     66,,PR1
         2 004432   377770 376007                    ANQ     131064,DL
         2 004433   016070 116007                    CMPQ    7224,DL
         2 004434   004451 601000 2                  TNZ     s:11919

      817    11914    6                    DO;

      818    11915    6                       CALL IVV$ERROR (VIP.DEVID, 18); /* !NODIAG */

  11915  2 004435   000074 236000 3                  LDQ     60
         2 004436   200145 756100                    STQ     @V+18,,AUTO
         2 004437   200110 236100                    LDQ     VI$,,AUTO
         2 004440   000005 036003                    ADLQ    5,DU
         2 004441   200144 756100                    STQ     @V+17,,AUTO
         2 004442   200144 630500                    EPPR0   @V+17,,AUTO
         2 004443   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004444   000000 701000 xent               TSX1    IVV$ERROR
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:152  
         2 004445   000000 011000                    NOP     0

      819    11916    6                       PVI$ = VI$;

  11916  2 004446   200110 236100                    LDQ     VI$,,AUTO
         2 004447   200115 756100                    STQ     PVI$,,AUTO

      820    11917    6                       GOTO RELEASE_SPACE;

  11917  2 004450   005220 710000 2                  TRA     RELEASE_SPACE

      821    11918    6                       END;
      822    11919    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$BREAK THEN

  11919  2 004451   014510 116007                    CMPQ    6472,DL
         2 004452   004467 601000 2                  TNZ     s:11925

      823    11920    6                    DO;

      824    11921    6                       CALL IVV$ERROR (VIP.DEVID, 19); /* BREAK */

  11921  2 004453   000076 236000 3                  LDQ     62
         2 004454   200145 756100                    STQ     @V+18,,AUTO
         2 004455   200110 236100                    LDQ     VI$,,AUTO
         2 004456   000005 036003                    ADLQ    5,DU
         2 004457   200144 756100                    STQ     @V+17,,AUTO
         2 004460   200144 630500                    EPPR0   @V+17,,AUTO
         2 004461   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004462   000000 701000 xent               TSX1    IVV$ERROR
         2 004463   000000 011000                    NOP     0

      825    11922    6                       PVI$ = VI$;

  11922  2 004464   200110 236100                    LDQ     VI$,,AUTO
         2 004465   200115 756100                    STQ     PVI$,,AUTO

      826    11923    6                       GOTO RELEASE_SPACE;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:153  

  11923  2 004466   005220 710000 2                  TRA     RELEASE_SPACE

      827    11924    6                       END;
      828    11925    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOSLOTS THEN

  11925  2 004467   001500 116007                    CMPQ    832,DL
         2 004470   004503 601000 2                  TNZ     s:11932

      829    11926    6                    DO;

      830    11927    6                       CALL IVV$ERROR(,27); /* NO MORE DCB SLOTS */

  11927  2 004471   000061 236000 3                  LDQ     49
         2 004472   000001 235000 xsym               LDA     B_VECTNIL+1
         2 004473   200144 757100                    STAQ    @V+17,,AUTO
         2 004474   200144 630500                    EPPR0   @V+17,,AUTO
         2 004475   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004476   000000 701000 xent               TSX1    IVV$ERROR
         2 004477   000000 011000                    NOP     0

      831    11928    6                       PVI$ = VI$;

  11928  2 004500   200110 236100                    LDQ     VI$,,AUTO
         2 004501   200115 756100                    STQ     PVI$,,AUTO

      832    11929    6                       GOTO RELEASE_SPACE;

  11929  2 004502   005220 710000 2                  TRA     RELEASE_SPACE

      833    11930    6                       END;
      834    11931    5                    END;
      835    11932    4                 VIP.STOP='1'B;

  11932  2 004503   200110 470500                    LDP0    VI$,,AUTO
         2 004504   010000 236007                    LDQ     4096,DL
         2 004505   000017 256100                    ORSQ    15,,PR0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:154  

      836    11933    4                 VIP.DONE='1'B;

  11933  2 004506   200110 470500                    LDP0    VI$,,AUTO
         2 004507   020000 236007                    LDQ     8192,DL
         2 004510   000017 256100                    ORSQ    15,,PR0

      837    11934    4                 END;

      838    11935    3              END;

  11935  2 004511   000000 236000 xsym               LDQ     IV_IO$
         2 004512   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004513   004413 601000 2                  TNZ     s:11907

      839    11936    2           VI$=VIP$;

  11936  2 004514   200112 236100                    LDQ     VIP$,,AUTO
         2 004515   200110 756100                    STQ     VI$,,AUTO

      840    11937    3           IF VI$~=NULL THEN DO;

  11937  2 004516   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 004517   005327 600000 2                  TZE     s:12026

      841    11938    3   CHECK_NEXT:
      842    11939    3              PVI$=VI$;

  11939  2 004520   200110 236100       CHECK_NEXT   LDQ     VI$,,AUTO
         2 004521   200115 756100                    STQ     PVI$,,AUTO

      843    11940    3   CHECK_NEXT_1:
      844    11941    3              VI$=VIP.FL$;

  11941  2 004522   200110 470500       CHECK_NEXT_1 LDP0    VI$,,AUTO
         2 004523   000000 236100                    LDQ     0,,PR0
         2 004524   200110 756100                    STQ     VI$,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:155  

      845    11942    4              IF VIP.DONE THEN DO;

  11942  2 004525   200110 470500                    LDP0    VI$,,AUTO
         2 004526   000017 236100                    LDQ     15,,PR0
         2 004527   020000 316007                    CANQ    8192,DL
         2 004530   005324 600000 2                  TZE     s:12024

      846    11943    4                 OUT=DONE;

  11943  2 004531   000100 100400                    MLR     fill='000'O
         2 004532   000042 000121 1                  ADSC9   DONE                     cn=0,n=81
         2 004533   200036 000124                    ADSC9   OUT,,AUTO                cn=0,n=84

      847    11944    4                 CALL IVV$BINDEC(VIP.VSN,OUT.MSG,16,6);

  11944  2 004534   000140 237000 3                  LDAQ    96
         2 004535   200146 757100                    STAQ    @V+19,,AUTO
         2 004536   200037 631500                    EPPR1   OUT+1,,AUTO
         2 004537   200145 451500                    STP1    @V+18,,AUTO
         2 004540   200110 236100                    LDQ     VI$,,AUTO
         2 004541   000011 036003                    ADLQ    9,DU
         2 004542   200144 756100                    STQ     @V+17,,AUTO
         2 004543   200144 630500                    EPPR0   @V+17,,AUTO
         2 004544   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 004545   000000 701000 xent               TSX1    IVV$BINDEC
         2 004546   000000 011000                    NOP     0

      848    11945    4                 CALL INSERT(OUT.MSG,26,4,VIP.DEVID);

  11945  2 004547   200110 470500                    LDP0    VI$,,AUTO
         2 004550   040100 100500                    MLR     fill='040'O
         2 004551   000005 000004                    ADSC9   5,,PR0                   cn=0,n=4
         2 004552   200045 400004                    ADSC9   OUT+7,,AUTO              cn=2,n=4

      849    11946    5                 IF VIP.STOP THEN DO;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:156  
  11946  2 004553   000017 236100                    LDQ     15,,PR0
         2 004554   010000 316007                    CANQ    4096,DL
         2 004555   004716 600000 2                  TZE     s:11963

      850    11947    5                    CALL INSERT(OUT.MSG,31,,'stopped at CCCC.HH');

  11947  2 004556   040100 100400                    MLR     fill='040'O
         2 004557   000155 000022 1                  ADSC9   DTTLINE+47               cn=0,n=18
         2 004560   200046 600061                    ADSC9   OUT+8,,AUTO              cn=3,n=49

      851    11948    5                    OUT.LEN=49;

  11948  2 004561   000061 235007                    LDA     49,DL
         2 004562   200036 755100                    STA     OUT,,AUTO

      852    11949    6                    DO SELECT(VIP.MODEL);

  11949  2 004563   040000 106500                    CMPC    fill='040'O
         2 004564   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 004565   000143 000010 1                  ADSC9   DTTLINE+37               cn=0,n=8
         2 004566   004637 602000 2                  TNC     s:11957
         2 004567   004575 600000 2                  TZE     s:11951
         2 004570   040000 106500                    CMPC    fill='040'O
         2 004571   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         2 004572   000141 000010 1                  ADSC9   DTTLINE+35               cn=0,n=8
         2 004573   004637 601000 2                  TNZ     s:11957
         2 004574   004575 710000 2                  TRA     s:11951

      853    11950    6                       SELECT('MSU0501 ','MSU0509 ');

      854    11951    6                       CYL='0'B; HEAD='0'B;

  11951  2 004575   200105 450100                    STZ     CYL,,AUTO

  11951  2 004576   200106 450100                    STZ     HEAD,,AUTO

      855    11952    6                       CYL.N=VIP.CTR.CYL;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:157  

  11952  2 004577   000016 236100                    LDQ     14,,PR0
         2 004600   000032 772000                    QRL     26
         2 004601   200105 676100                    ERQ     CYL,,AUTO
         2 004602   001777 376007                    ANQ     1023,DL
         2 004603   200105 656100                    ERSQ    CYL,,AUTO

      856    11953    6                       CALL IVV$BINDEC(CYL,OUT.MSG,42,4);

  11953  2 004604   000144 237000 3                  LDAQ    100
         2 004605   200146 757100                    STAQ    @V+19,,AUTO
         2 004606   200037 631500                    EPPR1   OUT+1,,AUTO
         2 004607   200145 451500                    STP1    @V+18,,AUTO
         2 004610   200105 633500                    EPPR3   CYL,,AUTO
         2 004611   200144 453500                    STP3    @V+17,,AUTO
         2 004612   200144 630500                    EPPR0   @V+17,,AUTO
         2 004613   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 004614   000000 701000 xent               TSX1    IVV$BINDEC
         2 004615   000000 011000                    NOP     0

      857    11954    6                       HEAD.N=VIP.CTR.HD;

  11954  2 004616   200110 470500                    LDP0    VI$,,AUTO
         2 004617   000016 236100                    LDQ     14,,PR0
         2 004620   000022 772000                    QRL     18
         2 004621   200106 676100                    ERQ     HEAD,,AUTO
         2 004622   000377 376007                    ANQ     255,DL
         2 004623   200106 656100                    ERSQ    HEAD,,AUTO

      858    11955    6                       CALL IVV$BINDEC(HEAD,OUT.MSG,47,2);

  11955  2 004624   000146 237000 3                  LDAQ    102
         2 004625   200146 757100                    STAQ    @V+19,,AUTO
         2 004626   200037 631500                    EPPR1   OUT+1,,AUTO
         2 004627   200145 451500                    STP1    @V+18,,AUTO
         2 004630   200106 633500                    EPPR3   HEAD,,AUTO
         2 004631   200144 453500                    STP3    @V+17,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:158  
         2 004632   200144 630500                    EPPR0   @V+17,,AUTO
         2 004633   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 004634   000000 701000 xent               TSX1    IVV$BINDEC
         2 004635   000000 011000                    NOP     0
         2 004636   004723 710000 2                  TRA     s:11966

      859    11956    6                       SELECT(ELSE);

      860    11957    6                    TRACK=VIP.FMT$->FMT.SEEK.SECTOR/VIP.NSECTS;

  11957  2 004637   000013 471500                    LDP1    11,,PR0
         2 004640   000014 236100                    LDQ     12,,PR0
         2 004641   000033 772000                    QRL     27
         2 004642   200144 756100                    STQ     @V+17,,AUTO
         2 004643   100007 236100                    LDQ     7,,PR1
         2 004644   000121 376000 3                  ANQ     81
         2 004645   200144 506100                    DIV     @V+17,,AUTO
         2 004646   000000 620006                    EAX0    0,QL
         2 004647   200104 740100                    STX0    TRACK,,AUTO

      861    11958    6                    CALL IVV$BINDEC(TRACK/VIP.NHEADS,OUT.MSG,42,4);

  11958  2 004650   000014 236100                    LDQ     12,,PR0
         2 004651   000022 772000                    QRL     18
         2 004652   000777 376007                    ANQ     511,DL
         2 004653   200144 756100                    STQ     @V+17,,AUTO
         2 004654   200104 236100                    LDQ     TRACK,,AUTO
         2 004655   000022 772000                    QRL     18
         2 004656   200144 506100                    DIV     @V+17,,AUTO
         2 004657   200145 756100                    STQ     @V+18,,AUTO
         2 004660   000144 237000 3                  LDAQ    100
         2 004661   200150 757100                    STAQ    @V+21,,AUTO
         2 004662   200037 631500                    EPPR1   OUT+1,,AUTO
         2 004663   200147 451500                    STP1    @V+20,,AUTO
         2 004664   200145 633500                    EPPR3   @V+18,,AUTO
         2 004665   200146 453500                    STP3    @V+19,,AUTO
         2 004666   200146 630500                    EPPR0   @V+19,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:159  
         2 004667   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 004670   000000 701000 xent               TSX1    IVV$BINDEC
         2 004671   000000 011000                    NOP     0

      862    11959    6                    CALL IVV$BINDEC(MOD(TRACK,VIP.NHEADS),OUT.MSG,47,2);

  11959  2 004672   200110 470500                    LDP0    VI$,,AUTO
         2 004673   000014 236100                    LDQ     12,,PR0
         2 004674   000022 772000                    QRL     18
         2 004675   000777 376007                    ANQ     511,DL
         2 004676   200144 756100                    STQ     @V+17,,AUTO
         2 004677   200104 236100                    LDQ     TRACK,,AUTO
         2 004700   000022 772000                    QRL     18
         2 004701   200144 506100                    DIV     @V+17,,AUTO
         2 004702   200145 755100                    STA     @V+18,,AUTO
         2 004703   000146 237000 3                  LDAQ    102
         2 004704   200150 757100                    STAQ    @V+21,,AUTO
         2 004705   200037 631500                    EPPR1   OUT+1,,AUTO
         2 004706   200147 451500                    STP1    @V+20,,AUTO
         2 004707   200145 633500                    EPPR3   @V+18,,AUTO
         2 004710   200146 453500                    STP3    @V+19,,AUTO
         2 004711   200146 630500                    EPPR0   @V+19,,AUTO
         2 004712   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 004713   000000 701000 xent               TSX1    IVV$BINDEC
         2 004714   000000 011000                    NOP     0

      863    11960    6                       END;

      864    11961    5                    END/* IF VIP.STOP */;

  11961  2 004715   004723 710000 2                  TRA     s:11966

      865    11962    5                 ELSE DO;

      866    11963    5                    CALL INSERT(OUT.MSG,31,,'completed');

  11963  2 004716   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:160  
         2 004717   000162 000011 1                  ADSC9   DTTLINE+52               cn=0,n=9
         2 004720   200046 600061                    ADSC9   OUT+8,,AUTO              cn=3,n=49

      867    11964    5                    OUT.LEN=40;

  11964  2 004721   000050 235007                    LDA     40,DL
         2 004722   200036 755100                    STA     OUT,,AUTO

      868    11965    5                    END;

      869    11966    5                 IF VIP.DTTOVF THEN DO;

  11966  2 004723   200110 470500                    LDP0    VI$,,AUTO
         2 004724   000017 236100                    LDQ     15,,PR0
         2 004725   002000 316007                    CANQ    1024,DL
         2 004726   004740 600000 2                  TZE     s:11970

      870    11967    5                    CALL INSERT(OUT.MSG,OUT.LEN,,', DTT overflow');

  11967  2 004727   200036 720100                    LXL0    OUT,,AUTO
         2 004730   777657 620010                    EAX0    -81,X0
         2 004731   777777 660003                    ERX0    -1,DU
         2 004732   200036 235100                    LDA     OUT,,AUTO
         2 004733   040145 100400                    MLR     fill='040'O
         2 004734   000165 000016 1                  ADSC9   DTTLINE+55               cn=0,n=14
         2 004735   200037 000010                    ADSC9   OUT+1,A,AUTO             cn=0,n=*X0

      871    11968    5                    OUT.LEN=OUT.LEN+16;

  11968  2 004736   000020 236007                    LDQ     16,DL
         2 004737   200036 056100                    ASQ     OUT,,AUTO

      872    11969    5                    END;

      873    11970    4                 VID$=VIP.VID$;

  11970  2 004740   200110 470500                    LDP0    VI$,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:161  
         2 004741   000012 236100                    LDQ     10,,PR0
         2 004742   200111 756100                    STQ     VID$,,AUTO

      874    11971    5                 IF VIP.DTTCH THEN DO;

  11971  2 004743   000017 236100                    LDQ     15,,PR0
         2 004744   004000 316007                    CANQ    2048,DL
         2 004745   004754 600000 2                  TZE     s:11976

      875    11972    5                    DTTX=63;

  11972  2 004746   000077 235007                    LDA     63,DL
         2 004747   200017 755100                    STA     DTTX,,AUTO

      876    11973    5                    CALL SORT_DTT;

  11973  2 004750   005667 701000 2                  TSX1    SORT_DTT
         2 004751   000000 011000                    NOP     0

      877    11974    5                    CALL PRINT_DTT;

  11974  2 004752   005435 701000 2                  TSX1    PRINT_DTT
         2 004753   000000 011000                    NOP     0

      878    11975    5                    END;

      879    11976    4                 VID.SYSDIRDA=VIP.DVT$->DVT.PACKSIZE-1;

  11976  2 004754   200110 470500                    LDP0    VI$,,AUTO
         2 004755   000002 471500                    LDP1    2,,PR0
         2 004756   200111 473500                    LDP3    VID$,,AUTO
         2 004757   100054 235100                    LDA     44,,PR1
         2 004760   000001 135007                    SBLA    1,DL
         2 004761   300006 755100                    STA     6,,PR3

      880    11977    5                 DO I=0 TO 62;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:162  
  11977  2 004762   200027 450100                    STZ     I,,AUTO

      881    11978    6                    IF VID.DTT(I)~=BITBIN('777777'O) THEN DO;

  11978  2 004763   200111 470500                    LDP0    VID$,,AUTO
         2 004764   200027 720100                    LXL0    I,,AUTO
         2 004765   000400 221110                    LDX1    256,X0,PR0
         2 004766   777777 101003                    CMPX1   -1,DU
         2 004767   005101 600000 2                  TZE     s:11982

      882    11979    6                       VID.DGT.FGRAN(I)=((VID.DT.CYL(I)*VIP.NHEADS+VID.DT.HD(I))*VIP.
             11979                                NSECTS)/VIP.GRANSIZE;

  11979  2 004770   200110 471500                    LDP1    VI$,,AUTO
         2 004771   100014 236100                    LDQ     12,,PR1
         2 004772   000022 772000                    QRL     18
         2 004773   000777 376007                    ANQ     511,DL
         2 004774   200144 756100                    STQ     @V+17,,AUTO
         2 004775   000400 236110                    LDQ     256,X0,PR0
         2 004776   000032 772000                    QRL     26
         2 004777   200144 402100                    MPY     @V+17,,AUTO
         2 005000   200145 756100                    STQ     @V+18,,AUTO
         2 005001   000400 236110                    LDQ     256,X0,PR0
         2 005002   000022 772000                    QRL     18
         2 005003   000377 376007                    ANQ     255,DL
         2 005004   200146 756100                    STQ     @V+19,,AUTO
         2 005005   200145 236100                    LDQ     @V+18,,AUTO
         2 005006   200146 036100                    ADLQ    @V+19,,AUTO
         2 005007   200147 756100                    STQ     @V+20,,AUTO
         2 005010   100014 236100                    LDQ     12,,PR1
         2 005011   000033 772000                    QRL     27
         2 005012   200150 756100                    STQ     @V+21,,AUTO
         2 005013   200147 236100                    LDQ     @V+20,,AUTO
         2 005014   200150 402100                    MPY     @V+21,,AUTO
         2 005015   200151 756100                    STQ     @V+22,,AUTO
         2 005016   100020 236100                    LDQ     16,,PR1
         2 005017   000022 772000                    QRL     18
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:163  
         2 005020   000777 376007                    ANQ     511,DL
         2 005021   200152 756100                    STQ     @V+23,,AUTO
         2 005022   200151 236100                    LDQ     @V+22,,AUTO
         2 005023   005034 605000 2                  TPL     s:11979+36
         2 005024   200152 235100                    LDA     @V+23,,AUTO
         2 005025   000001 405007                    CMG     1,DL
         2 005026   005035 600000 2                  TZE     s:11979+37
         2 005027   000000 235003                    LDA     0,DU
         2 005030   000001 737000                    LLS     1
         2 005031   200152 507100                    DVF     @V+23,,AUTO
         2 005032   000044 733000                    LRS     36
         2 005033   005035 710000 2                  TRA     s:11979+37
         2 005034   200152 506100                    DIV     @V+23,,AUTO
         2 005035   000000 621006                    EAX1    0,QL
         2 005036   000300 741110                    STX1    192,X0,PR0

      883    11980    6                      VID.DGT.LGRAN(I)=((VID.DT.CYL(I)*VIP.NHEADS+VID.DT.HD(I)+1)*VIP.
             11980                                NSECTS-1)/VIP.GRANSIZE;

  11980  2 005037   200110 470500                    LDP0    VI$,,AUTO
         2 005040   000014 236100                    LDQ     12,,PR0
         2 005041   000022 772000                    QRL     18
         2 005042   000777 376007                    ANQ     511,DL
         2 005043   200144 756100                    STQ     @V+17,,AUTO
         2 005044   200111 471500                    LDP1    VID$,,AUTO
         2 005045   100400 236110                    LDQ     256,X0,PR1
         2 005046   000032 772000                    QRL     26
         2 005047   200144 402100                    MPY     @V+17,,AUTO
         2 005050   200145 756100                    STQ     @V+18,,AUTO
         2 005051   100400 236110                    LDQ     256,X0,PR1
         2 005052   000022 772000                    QRL     18
         2 005053   000377 376007                    ANQ     255,DL
         2 005054   200146 756100                    STQ     @V+19,,AUTO
         2 005055   200145 236100                    LDQ     @V+18,,AUTO
         2 005056   200146 036100                    ADLQ    @V+19,,AUTO
         2 005057   200147 756100                    STQ     @V+20,,AUTO
         2 005060   000014 236100                    LDQ     12,,PR0
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:164  
         2 005061   000033 772000                    QRL     27
         2 005062   200150 756100                    STQ     @V+21,,AUTO
         2 005063   200147 236100                    LDQ     @V+20,,AUTO
         2 005064   000001 036007                    ADLQ    1,DL
         2 005065   200150 402100                    MPY     @V+21,,AUTO
         2 005066   200151 756100                    STQ     @V+22,,AUTO
         2 005067   000020 236100                    LDQ     16,,PR0
         2 005070   000022 772000                    QRL     18
         2 005071   000777 376007                    ANQ     511,DL
         2 005072   200152 756100                    STQ     @V+23,,AUTO
         2 005073   200151 236100                    LDQ     @V+22,,AUTO
         2 005074   000001 136007                    SBLQ    1,DL
         2 005075   200152 506100                    DIV     @V+23,,AUTO
         2 005076   000000 621006                    EAX1    0,QL
         2 005077   100300 441110                    SXL1    192,X0,PR1

      884    11981    6                       END;

  11981  2 005100   005102 710000 2                  TRA     s:11983

      885    11982    5                    ELSE VID.DGT(I)='0'B;

  11982  2 005101   000300 450110                    STZ     192,X0,PR0

      886    11983    5                    END/* DO I */;

  11983  2 005102   200027 054100                    AOS     I,,AUTO
         2 005103   200027 235100                    LDA     I,,AUTO
         2 005104   000076 115007                    CMPA    62,DL
         2 005105   004763 604400 2                  TMOZ    s:11978

      887    11984    4                 VID.DGT(63)='0'B;

  11984  2 005106   200111 470500                    LDP0    VID$,,AUTO
         2 005107   000377 450100                    STZ     255,,PR0

      888    11985    4                 VID.MIRROR = '0'B;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:165  

  11985  2 005110   000100 100400                    MLR     fill='000'O
         2 005111   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 005112   000042 000020                    ADSC9   34,,PR0                  cn=0,n=16

      889    11986    5                 IF VIP.SCRATCH THEN DO;

  11986  2 005113   200110 470500                    LDP0    VI$,,AUTO
         2 005114   000017 236100                    LDQ     15,,PR0
         2 005115   000400 316007                    CANQ    256,DL
         2 005116   005132 600000 2                  TZE     s:11992

      890    11987    5                    VID.VOLCNT=0;

  11987  2 005117   000000 220003                    LDX0    0,DU
         2 005120   200111 471500                    LDP1    VID$,,AUTO
         2 005121   100004 440100                    SXL0    4,,PR1

      891    11988    6                    DO I = 0 TO 25;

  11988  2 005122   200027 450100                    STZ     I,,AUTO

      892    11989    6                       VID.SECTSTRT(I) = 0;

  11989  2 005123   200111 470500                    LDP0    VID$,,AUTO
         2 005124   200027 720100                    LXL0    I,,AUTO
         2 005125   000010 450110                    STZ     8,X0,PR0

      893    11990    6                       END;

  11990  2 005126   200027 054100                    AOS     I,,AUTO
         2 005127   200027 235100                    LDA     I,,AUTO
         2 005130   000031 115007                    CMPA    25,DL
         2 005131   005123 604400 2                  TMOZ    s:11989

      894    11991    5                    END;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:166  
      895    11992    4                 CALL IVO$WRITE_VID(VIP) ALTRET(DISK_ERR);

  11992  2 005132   200110 630500                    EPPR0   VI$,,AUTO
         2 005133   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005134   000000 701000 xent               TSX1    IVO$WRITE_VID
         2 005135   005147 702000 2                  TSX2    DISK_ERR

      896    11993    4                 CALL IVO$PRINT(OUT,'0'B);

  11993  2 005136   000001 236000 3                  LDQ     1
         2 005137   200145 756100                    STQ     @V+18,,AUTO
         2 005140   200036 630500                    EPPR0   OUT,,AUTO
         2 005141   200144 450500                    STP0    @V+17,,AUTO
         2 005142   200144 630500                    EPPR0   @V+17,,AUTO
         2 005143   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 005144   000000 701000 xent               TSX1    IVO$PRINT
         2 005145   000000 011000                    NOP     0

      897    11994    4                 GOTO RELEASE_SPACE;

  11994  2 005146   005220 710000 2                  TRA     RELEASE_SPACE

      898    11995        /**/
      899    11996    4   DISK_ERR:
      900    11997    4                 IF (IV_ONLINE AND (B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOSLOTS))

  11997  2 005147   000000 234000 xsym  DISK_ERR     SZN     IV_ONLINE
         2 005150   005167 605000 2                  TPL     s:12002
         2 005151   000000 470400 xsym               LDP0    B$TCB$
         2 005152   000000 471500                    LDP1    0,,PR0
         2 005153   100102 236100                    LDQ     66,,PR1
         2 005154   377770 376007                    ANQ     131064,DL
         2 005155   001500 116007                    CMPQ    832,DL
         2 005156   005167 601000 2                  TNZ     s:12002

      901    11998    5                 THEN DO;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:167  
      902    11999    5                    CALL IVV$ERROR(,27);   /* NO MORE DCB SLOTS */

  11999  2 005157   000061 236000 3                  LDQ     49
         2 005160   000001 235000 xsym               LDA     B_VECTNIL+1
         2 005161   200144 757100                    STAQ    @V+17,,AUTO
         2 005162   200144 630500                    EPPR0   @V+17,,AUTO
         2 005163   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 005164   000000 701000 xent               TSX1    IVV$ERROR
         2 005165   000000 011000                    NOP     0

      903    12000    5                    GOTO RELEASE_SPACE;

  12000  2 005166   005220 710000 2                  TRA     RELEASE_SPACE

      904    12001    5                    END;
      905    12002    4                 IF (IV_ONLINE AND (B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE =  %E$NOTAUTH))

  12002  2 005167   000000 234000 xsym               SZN     IV_ONLINE
         2 005170   005207 605000 2                  TPL     s:12004
         2 005171   000000 470400 xsym               LDP0    B$TCB$
         2 005172   000000 471500                    LDP1    0,,PR0
         2 005173   100102 236100                    LDQ     66,,PR1
         2 005174   377770 376007                    ANQ     131064,DL
         2 005175   006250 116007                    CMPQ    3240,DL
         2 005176   005207 601000 2                  TNZ     s:12004

      906    12003    4                 THEN CALL IVV$ERROR(,28); /* INSUFFICIENT PRIV */

  12003  2 005177   000063 236000 3                  LDQ     51
         2 005200   000001 235000 xsym               LDA     B_VECTNIL+1
         2 005201   200144 757100                    STAQ    @V+17,,AUTO
         2 005202   200144 630500                    EPPR0   @V+17,,AUTO
         2 005203   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 005204   000000 701000 xent               TSX1    IVV$ERROR
         2 005205   000000 011000                    NOP     0
         2 005206   005220 710000 2                  TRA     RELEASE_SPACE

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:168  
      907    12004    4                 ELSE CALL IVV$ERROR(VIP.DEVID, 10);

  12004  2 005207   000122 236000 3                  LDQ     82
         2 005210   200145 756100                    STQ     @V+18,,AUTO
         2 005211   200110 236100                    LDQ     VI$,,AUTO
         2 005212   000005 036003                    ADLQ    5,DU
         2 005213   200144 756100                    STQ     @V+17,,AUTO
         2 005214   200144 630500                    EPPR0   @V+17,,AUTO
         2 005215   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 005216   000000 701000 xent               TSX1    IVV$ERROR
         2 005217   000000 011000                    NOP     0

      908    12005    4   RELEASE_SPACE:
      909    12006    4                 IF VIP.VID$~=NULL THEN

  12006  2 005220   200110 470500       RELEASE_SPA* LDP0    VI$,,AUTO
         2 005221   000012 236100                    LDQ     10,,PR0
         2 005222   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 005223   005233 600000 2                  TZE     s:12008

      910    12007    4                    CALL IVO$FREE(VIP.VID$);

  12007  2 005224   200110 236100                    LDQ     VI$,,AUTO
         2 005225   000012 036003                    ADLQ    10,DU
         2 005226   200144 756100                    STQ     @V+17,,AUTO
         2 005227   200144 630500                    EPPR0   @V+17,,AUTO
         2 005230   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005231   000000 701000 xent               TSX1    IVO$FREE
         2 005232   000000 011000                    NOP     0

      911    12008    4                 IF VIP.ELT$~=NULL THEN

  12008  2 005233   200110 470500                    LDP0    VI$,,AUTO
         2 005234   000003 236100                    LDQ     3,,PR0
         2 005235   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 005236   005246 600000 2                  TZE     s:12010

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:169  
      912    12009    4                    CALL IVO$FREE(VIP.ELT$);

  12009  2 005237   200110 236100                    LDQ     VI$,,AUTO
         2 005240   000003 036003                    ADLQ    3,DU
         2 005241   200144 756100                    STQ     @V+17,,AUTO
         2 005242   200144 630500                    EPPR0   @V+17,,AUTO
         2 005243   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005244   000000 701000 xent               TSX1    IVO$FREE
         2 005245   000000 011000                    NOP     0

      913    12010    4                 IF VIP.FMT$~=NULL THEN

  12010  2 005246   200110 470500                    LDP0    VI$,,AUTO
         2 005247   000013 236100                    LDQ     11,,PR0
         2 005250   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 005251   005261 600000 2                  TZE     s:12012

      914    12011    4                    CALL IVO$FREE(VIP.FMT$);

  12011  2 005252   200110 236100                    LDQ     VI$,,AUTO
         2 005253   000013 036003                    ADLQ    11,DU
         2 005254   200144 756100                    STQ     @V+17,,AUTO
         2 005255   200144 630500                    EPPR0   @V+17,,AUTO
         2 005256   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005257   000000 701000 xent               TSX1    IVO$FREE
         2 005260   000000 011000                    NOP     0

      915    12012    4                 IF IV_ONLINE THEN

  12012  2 005261   000000 234000 xsym               SZN     IV_ONLINE
         2 005262   005267 605000 2                  TPL     s:12015

      916    12013    4                    CALL IVO$RELDCB(VIP);

  12013  2 005263   200110 630500                    EPPR0   VI$,,AUTO
         2 005264   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005265   000000 701000 xent               TSX1    IVO$RELDCB
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:170  
         2 005266   000000 011000                    NOP     0

      917    12014                      %DEQUEUE(P#=VI$,Q#=PVI$);

  12015  2 005267   200115 470700                    LDP0  ! PVI$,,AUTO
         2 005270   000000 236300                    LDQ   ! 0,,PR0
         2 005271   200110 756300                    STQ   ! VI$,,AUTO

  12015  2 005272   200115 116300                    CMPQ  ! PVI$,,AUTO
         2 005273   005277 601200 2                  TNZ   ! s:12015+8

  12015  2 005274   000001 236200 xsym               LDQ   ! B_VECTNIL+1
         2 005275   200115 756300                    STQ   ! PVI$,,AUTO
         2 005276   005302 710200 2                  TRA   ! s:12015+11

  12015  2 005277   200110 471700                    LDP1  ! VI$,,AUTO
         2 005300   100000 236300                    LDQ   ! 0,,PR1
         2 005301   000000 756300                    STQ   ! 0,,PR0

  12015  2 005302   000001 236200 xsym               LDQ   ! B_VECTNIL+1
         2 005303   200110 470700                    LDP0  ! VI$,,AUTO
         2 005304   000000 756300                    STQ   ! 0,,PR0

      918    12017    4                 CALL IVO$FREE(VI$);

  12017  2 005305   200110 630500                    EPPR0   VI$,,AUTO
         2 005306   200144 450500                    STP0    @V+17,,AUTO
         2 005307   200144 630500                    EPPR0   @V+17,,AUTO
         2 005310   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005311   000000 701000 xent               TSX1    IVO$FREE
         2 005312   000000 011000                    NOP     0

      919    12018    5                 IF VI$~=VIP$ THEN DO;

  12018  2 005313   200110 236100                    LDQ     VI$,,AUTO
         2 005314   200112 116100                    CMPQ    VIP$,,AUTO
         2 005315   005321 600000 2                  TZE     s:12022
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:171  

      920    12019    5                    VI$=PVI$;

  12019  2 005316   200115 236100                    LDQ     PVI$,,AUTO
         2 005317   200110 756100                    STQ     VI$,,AUTO

      921    12020    5                    GOTO CHECK_NEXT_1;

  12020  2 005320   004522 710000 2                  TRA     CHECK_NEXT_1

      922    12021    5                    END;
      923    12022    4                 VIP$=PVI$;

  12022  2 005321   200115 236100                    LDQ     PVI$,,AUTO
         2 005322   200112 756100                    STQ     VIP$,,AUTO

      924    12023    4                 END/* IF VIP.DONE */;

  12023  2 005323   005327 710000 2                  TRA     s:12026

      925    12024    3              ELSE IF VI$~=VIP$ THEN GOTO CHECK_NEXT;

  12024  2 005324   200110 236100                    LDQ     VI$,,AUTO
         2 005325   200112 116100                    CMPQ    VIP$,,AUTO
         2 005326   004520 601000 2                  TNZ     CHECK_NEXT

      926    12025    3              END/* IF VI$ */;

      927    12026    2           RETURN;

  12026  2 005327   200114 221300                    LDX1  ! VIP$+2,,AUTO
         2 005330   000001 702211                    TSX2  ! 1,X1

      928    12027    2   END CHECKDONE;
      929    12028        %EJECT;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:172  
      930    12029        /* CONVERT DECIMAL STRING TO BINARY */
      931    12030        /**/
      932    12031    1   DECBIN: PROC (D,V1,V2);

  12031  2 005331   200114 741300       DECBIN       STX1  ! VIP$+2,,AUTO

      933    12032        /**/
      934    12033        /* PARAMETERS */
      935    12034        /**/
      936    12035    2   DCL 1 D ALIGNED,
      937    12036    2         2 CT UBIN(9) UNAL,
      938    12037    2         2 T CHAR(D.CT) UNAL;
      939    12038    2   DCL V1 SBIN;
      940    12039    2   DCL V2 SBIN;
      941    12040        /**/
      942    12041        /* AUTO STACK */
      943    12042        /**/
      944    12043    2   DCL I SBIN;
      945    12044    2   DCL CH CHAR(1);
      946    12045        /**/
      947    12046        /* PROCEDURE */
      948    12047        /**/
      949    12048    2           I=0;

  12048  2 005332   200120 450100                    STZ     I,,AUTO

      950    12049    2           CALL CONVERT(V1);

  12049  2 005333   200116 236100                    LDQ     @V1,,AUTO
         2 005334   200123 756100                    STQ     ITEM+1,,AUTO
         2 005335   005365 701000 2                  TSX1    CONVERT
         2 005336   000000 011000                    NOP     0

      951    12050    3           IF ADDR(V2)~=NULL THEN DO;

  12050  2 005337   200117 236100                    LDQ     @V2,,AUTO
         2 005340   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:173  
         2 005341   005363 600000 2                  TZE     s:12057

      952    12051    3              V2=-1;

  12051  2 005342   000001 335007                    LCA     1,DL
         2 005343   200117 470500                    LDP0    @V2,,AUTO
         2 005344   000000 755100                    STA     0,,PR0

      953    12052    4              IF I<D.CT AND CH='.' THEN DO;

  12052  2 005345   200115 471500                    LDP1    @D,,AUTO
         2 005346   100000 236100                    LDQ     0,,PR1
         2 005347   000033 772000                    QRL     27
         2 005350   200120 116100                    CMPQ    I,,AUTO
         2 005351   005363 604400 2                  TMOZ    s:12057
         2 005352   200121 236100                    LDQ     CH,,AUTO
         2 005353   777000 376003                    ANQ     -512,DU
         2 005354   056000 116003                    CMPQ    23552,DU
         2 005355   005363 601000 2                  TNZ     s:12057

      954    12053    4                 I=I+1;

  12053  2 005356   200120 054100                    AOS     I,,AUTO

      955    12054    4                 CALL CONVERT(V2);

  12054  2 005357   200117 236100                    LDQ     @V2,,AUTO
         2 005360   200123 756100                    STQ     ITEM+1,,AUTO
         2 005361   005365 701000 2                  TSX1    CONVERT
         2 005362   000000 011000                    NOP     0

      956    12055    4                 END;

      957    12056    3              END/* IF ADDR(V2) */;

      958    12057    2           RETURN;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:174  
  12057  2 005363   200114 221300                    LDX1  ! VIP$+2,,AUTO
         2 005364   000001 702211                    TSX2  ! 1,X1

      959    12058        /**/
      960    12059    2   CONVERT: PROC (V);

  12059  2 005365   200122 741300       CONVERT      STX1  ! CH+1,,AUTO

      961    12060    3   DCL V SBIN;
      962    12061        /**/
      963    12062    3           V=0;

  12062  2 005366   200123 470500                    LDP0    @V,,AUTO
         2 005367   000000 450100                    STZ     0,,PR0

      964    12063    4           DO I=I TO D.CT-1;

  12063  2 005370   005425 710000 2                  TRA     s:12067+1

      965    12064    4              CH=SUBSTR(D.T,I,1);

  12064  2 005371   200115 470500                    LDP0    @D,,AUTO
         2 005372   000000 236100                    LDQ     0,,PR0
         2 005373   000033 772000                    QRL     27
         2 005374   200120 235100                    LDA     I,,AUTO
         2 005375   040100 100505                    MLR     fill='040'O
         2 005376   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
         2 005377   200121 000001                    ADSC9   CH,,AUTO                 cn=0,n=1

      966    12065    4              IF CH<'0' OR CH>'9' THEN RETURN;

  12065  2 005400   200121 236100                    LDQ     CH,,AUTO
         2 005401   777000 376003                    ANQ     -512,DU
         2 005402   060000 116003                    CMPQ    24576,DU
         2 005403   005411 602000 2                  TNC     s:12065+9
         2 005404   200121 236100                    LDQ     CH,,AUTO
         2 005405   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:175  
         2 005406   071000 116003                    CMPQ    29184,DU
         2 005407   005413 602000 2                  TNC     s:12066
         2 005410   005413 600000 2                  TZE     s:12066

  12065  2 005411   200122 221300                    LDX1  ! CH+1,,AUTO
         2 005412   000001 702211                    TSX2  ! 1,X1

      967    12066    4              V=10*V+ASCBIN(CH)-ASCBIN('0');

  12066  2 005413   200121 236100                    LDQ     CH,,AUTO
         2 005414   000033 772000                    QRL     27
         2 005415   200144 756100                    STQ     @V+17,,AUTO
         2 005416   200123 471500                    LDP1    @V,,AUTO
         2 005417   100000 236100                    LDQ     0,,PR1
         2 005420   000012 402007                    MPY     10,DL
         2 005421   200144 036100                    ADLQ    @V+17,,AUTO
         2 005422   000060 136007                    SBLQ    48,DL
         2 005423   100000 756100                    STQ     0,,PR1

      968    12067    4              END;

  12067  2 005424   200120 054100                    AOS     I,,AUTO
         2 005425   200115 470500                    LDP0    @D,,AUTO
         2 005426   000000 236100                    LDQ     0,,PR0
         2 005427   000033 772000                    QRL     27
         2 005430   200120 116100                    CMPQ    I,,AUTO
         2 005431   005371 605400 2                  TPNZ    s:12064

      969    12068    3           I=D.CT;

  12068  2 005432   200120 756100                    STQ     I,,AUTO

      970    12069    3           RETURN;

  12069  2 005433   200122 221300                    LDX1  ! CH+1,,AUTO
         2 005434   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:176  
      971    12070    3   END CONVERT;
      972    12071    2   END DECBIN;
      973    12072        %EJECT;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:177  
      974    12073        /* PRINT DEFECTIVE TRACK TABLE */
      975    12074        /**/
      976    12075    1   PRINT_DTT: PROC;

  12075  2 005435   200116 741300       PRINT_DTT    STX1  ! @V1,,AUTO

      977    12076        /**/
      978    12077        /* CONSTANTS */
      979    12078        /**/
      980    12079    2   DCL 1 DTTHDR CONSTANT,
      981    12080    2         2 * SBIN INIT(SIZEC(DTTHDR.MSG)),
      982    12081    2         2 MSG CHAR(0) INIT('A Defective track table ');
      983    12082    2   DCL 1 DTTLINE CONSTANT,
      984    12083    2         2 * SBIN INIT(SIZEC(DTTLINE.MSG)),
      985    12084    2         2 MSG CHAR(0) INIT('A     CCCC.HH    GGGGG-GGGGG ');
      986    12085    2   DCL 1 OUTX ALIGNED,
      987    12086    2         2 LEN SBIN,
      988    12087    2         2 MSG CHAR(80);
      989    12088        /**/
      990    12089    2           CALL IVO$PRINT(DTTHDR,'0'B);

  12089  2 005436   000150 630400 3                  EPPR0   104
         2 005437   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 005440   000000 701000 xent               TSX1    IVO$PRINT
         2 005441   000000 011000                    NOP     0

      991    12090    2           OUTX=DTTLINE;

  12090  2 005442   000100 100400                    MLR     fill='000'O
         2 005443   000076 000041 1                  ADSC9   DTTLINE                  cn=0,n=33
         2 005444   200117 000124                    ADSC9   OUTX,,AUTO               cn=0,n=84

      992    12091    3           DO I=0 TO DTTX-1;

  12091  2 005445   200027 450100                    STZ     I,,AUTO
         2 005446   005657 710000 2                  TRA     s:12099+1

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:178  
      993    12092    4              IF VID.DTT(I)~=BITBIN('777777'O) THEN DO;

  12092  2 005447   200111 470500                    LDP0    VID$,,AUTO
         2 005450   200027 720100                    LXL0    I,,AUTO
         2 005451   000400 221110                    LDX1    256,X0,PR0
         2 005452   777777 101003                    CMPX1   -1,DU
         2 005453   005656 600000 2                  TZE     s:12099

      994    12093    4                 CALL IVV$BINDEC(BINBIT(VID.DT.CYL(I),36),OUTX.MSG,6,4);

  12093  2 005454   000400 236110                    LDQ     256,X0,PR0
         2 005455   000032 772000                    QRL     26
         2 005456   200144 756100                    STQ     @V+17,,AUTO
         2 005457   000152 237000 3                  LDAQ    106
         2 005460   200150 757100                    STAQ    @V+21,,AUTO
         2 005461   200120 631500                    EPPR1   I,,AUTO
         2 005462   200147 451500                    STP1    @V+20,,AUTO
         2 005463   200144 633500                    EPPR3   @V+17,,AUTO
         2 005464   200146 453500                    STP3    @V+19,,AUTO
         2 005465   200146 630500                    EPPR0   @V+19,,AUTO
         2 005466   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 005467   000000 701000 xent               TSX1    IVV$BINDEC
         2 005470   000000 011000                    NOP     0

      995    12094    4                 CALL IVV$BINDEC(BINBIT(VID.DT.HD(I),36),OUTX.MSG,11,2);

  12094  2 005471   200111 470500                    LDP0    VID$,,AUTO
         2 005472   200027 720100                    LXL0    I,,AUTO
         2 005473   000400 236110                    LDQ     256,X0,PR0
         2 005474   000022 772000                    QRL     18
         2 005475   000377 376007                    ANQ     255,DL
         2 005476   200144 756100                    STQ     @V+17,,AUTO
         2 005477   000154 237000 3                  LDAQ    108
         2 005500   200150 757100                    STAQ    @V+21,,AUTO
         2 005501   200120 631500                    EPPR1   I,,AUTO
         2 005502   200147 451500                    STP1    @V+20,,AUTO
         2 005503   200144 633500                    EPPR3   @V+17,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:179  
         2 005504   200146 453500                    STP3    @V+19,,AUTO
         2 005505   200146 630500                    EPPR0   @V+19,,AUTO
         2 005506   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 005507   000000 701000 xent               TSX1    IVV$BINDEC
         2 005510   000000 011000                    NOP     0

      996    12095    4                 CALL IVV$BINDEC(((VID.DT.CYL(I)*VIP.NHEADS+VID.DT.HD(I))*VIP.NSECTS)/
             12095                          VIP.GRANSIZE,OUTX.MSG,16,6);

  12095  2 005511   200110 470500                    LDP0    VI$,,AUTO
         2 005512   000014 236100                    LDQ     12,,PR0
         2 005513   000022 772000                    QRL     18
         2 005514   000777 376007                    ANQ     511,DL
         2 005515   200144 756100                    STQ     @V+17,,AUTO
         2 005516   200111 471500                    LDP1    VID$,,AUTO
         2 005517   200027 720100                    LXL0    I,,AUTO
         2 005520   100400 236110                    LDQ     256,X0,PR1
         2 005521   000032 772000                    QRL     26
         2 005522   200144 402100                    MPY     @V+17,,AUTO
         2 005523   200145 756100                    STQ     @V+18,,AUTO
         2 005524   100400 236110                    LDQ     256,X0,PR1
         2 005525   000022 772000                    QRL     18
         2 005526   000377 376007                    ANQ     255,DL
         2 005527   200146 756100                    STQ     @V+19,,AUTO
         2 005530   200145 236100                    LDQ     @V+18,,AUTO
         2 005531   200146 036100                    ADLQ    @V+19,,AUTO
         2 005532   200147 756100                    STQ     @V+20,,AUTO
         2 005533   000014 236100                    LDQ     12,,PR0
         2 005534   000033 772000                    QRL     27
         2 005535   200150 756100                    STQ     @V+21,,AUTO
         2 005536   200147 236100                    LDQ     @V+20,,AUTO
         2 005537   200150 402100                    MPY     @V+21,,AUTO
         2 005540   200151 756100                    STQ     @V+22,,AUTO
         2 005541   000020 236100                    LDQ     16,,PR0
         2 005542   000022 772000                    QRL     18
         2 005543   000777 376007                    ANQ     511,DL
         2 005544   200152 756100                    STQ     @V+23,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:180  
         2 005545   200151 236100                    LDQ     @V+22,,AUTO
         2 005546   005557 605000 2                  TPL     s:12095+38
         2 005547   200152 235100                    LDA     @V+23,,AUTO
         2 005550   000001 405007                    CMG     1,DL
         2 005551   005560 600000 2                  TZE     s:12095+39
         2 005552   000000 235003                    LDA     0,DU
         2 005553   000001 737000                    LLS     1
         2 005554   200152 507100                    DVF     @V+23,,AUTO
         2 005555   000044 733000                    LRS     36
         2 005556   005560 710000 2                  TRA     s:12095+39
         2 005557   200152 506100                    DIV     @V+23,,AUTO
         2 005560   200153 756100                    STQ     @V+24,,AUTO
         2 005561   000140 237000 3                  LDAQ    96
         2 005562   200156 757100                    STAQ    @V+27,,AUTO
         2 005563   200120 633500                    EPPR3   I,,AUTO
         2 005564   200155 453500                    STP3    @V+26,,AUTO
         2 005565   200153 634500                    EPPR4   @V+24,,AUTO
         2 005566   200154 454500                    STP4    @V+25,,AUTO
         2 005567   200154 630500                    EPPR0   @V+25,,AUTO
         2 005570   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 005571   000000 701000 xent               TSX1    IVV$BINDEC
         2 005572   000000 011000                    NOP     0

      997    12096    4                CALL IVV$BINDEC(((VID.DT.CYL(I)*VIP.NHEADS+VID.DT.HD(I)+1)*VIP.NSECTS-
             12096                          1)/VIP.GRANSIZE,OUTX.MSG,23,6);

  12096  2 005573   200110 470500                    LDP0    VI$,,AUTO
         2 005574   000014 236100                    LDQ     12,,PR0
         2 005575   000022 772000                    QRL     18
         2 005576   000777 376007                    ANQ     511,DL
         2 005577   200144 756100                    STQ     @V+17,,AUTO
         2 005600   200111 471500                    LDP1    VID$,,AUTO
         2 005601   200027 720100                    LXL0    I,,AUTO
         2 005602   100400 236110                    LDQ     256,X0,PR1
         2 005603   000032 772000                    QRL     26
         2 005604   200144 402100                    MPY     @V+17,,AUTO
         2 005605   200145 756100                    STQ     @V+18,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:181  
         2 005606   100400 236110                    LDQ     256,X0,PR1
         2 005607   000022 772000                    QRL     18
         2 005610   000377 376007                    ANQ     255,DL
         2 005611   200146 756100                    STQ     @V+19,,AUTO
         2 005612   200145 236100                    LDQ     @V+18,,AUTO
         2 005613   200146 036100                    ADLQ    @V+19,,AUTO
         2 005614   200147 756100                    STQ     @V+20,,AUTO
         2 005615   000014 236100                    LDQ     12,,PR0
         2 005616   000033 772000                    QRL     27
         2 005617   200150 756100                    STQ     @V+21,,AUTO
         2 005620   200147 236100                    LDQ     @V+20,,AUTO
         2 005621   000001 036007                    ADLQ    1,DL
         2 005622   200150 402100                    MPY     @V+21,,AUTO
         2 005623   200151 756100                    STQ     @V+22,,AUTO
         2 005624   000020 236100                    LDQ     16,,PR0
         2 005625   000022 772000                    QRL     18
         2 005626   000777 376007                    ANQ     511,DL
         2 005627   200152 756100                    STQ     @V+23,,AUTO
         2 005630   200151 236100                    LDQ     @V+22,,AUTO
         2 005631   000001 136007                    SBLQ    1,DL
         2 005632   200152 506100                    DIV     @V+23,,AUTO
         2 005633   200153 756100                    STQ     @V+24,,AUTO
         2 005634   000156 237000 3                  LDAQ    110
         2 005635   200156 757100                    STAQ    @V+27,,AUTO
         2 005636   200120 633500                    EPPR3   I,,AUTO
         2 005637   200155 453500                    STP3    @V+26,,AUTO
         2 005640   200153 634500                    EPPR4   @V+24,,AUTO
         2 005641   200154 454500                    STP4    @V+25,,AUTO
         2 005642   200154 630500                    EPPR0   @V+25,,AUTO
         2 005643   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 005644   000000 701000 xent               TSX1    IVV$BINDEC
         2 005645   000000 011000                    NOP     0

      998    12097    4                 CALL IVO$PRINT(OUTX,'0'B);

  12097  2 005646   000001 236000 3                  LDQ     1
         2 005647   200145 756100                    STQ     @V+18,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:182  
         2 005650   200117 630500                    EPPR0   OUTX,,AUTO
         2 005651   200144 450500                    STP0    @V+17,,AUTO
         2 005652   200144 630500                    EPPR0   @V+17,,AUTO
         2 005653   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 005654   000000 701000 xent               TSX1    IVO$PRINT
         2 005655   000000 011000                    NOP     0

      999    12098    4                 END;

     1000    12099    3              END/* DO I */;

  12099  2 005656   200027 054100                    AOS     I,,AUTO
         2 005657   200027 236100                    LDQ     I,,AUTO
         2 005660   200017 116100                    CMPQ    DTTX,,AUTO
         2 005661   005447 604000 2                  TMI     s:12092

     1001    12100    2           VIP.DTTCH='0'B;

  12100  2 005662   200110 470500                    LDP0    VI$,,AUTO
         2 005663   000101 236000 3                  LDQ     65
         2 005664   000017 356100                    ANSQ    15,,PR0

     1002    12101    2           RETURN;

  12101  2 005665   200116 221300                    LDX1  ! @V1,,AUTO
         2 005666   000001 702211                    TSX2  ! 1,X1

     1003    12102    2   END PRINT_DTT;
     1004    12103        %EJECT;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:183  
     1005    12104        /* SORT DEFECTIVE TRACK TABLE */
     1006    12105        /**/
     1007    12106    1   SORT_DTT: PROC;

  12106  2 005667   200116 741300       SORT_DTT     STX1  ! @V1,,AUTO

     1008    12107    3           DO I=0 TO DTTX-1;

  12107  2 005670   200027 450100                    STZ     I,,AUTO
         2 005671   005735 710000 2                  TRA     s:12121+1

     1009    12108    3              K=0;

  12108  2 005672   200031 450100                    STZ     K,,AUTO

     1010    12109    3              CC=VID.DTT(I);

  12109  2 005673   200111 470500                    LDP0    VID$,,AUTO
         2 005674   200027 720100                    LXL0    I,,AUTO
         2 005675   000400 236110                    LDQ     256,X0,PR0
         2 005676   000022 772000                    QRL     18
         2 005677   200013 756100                    STQ     CC,,AUTO

     1011    12110    4              DO J=I+1 TO DTTX-1;

  12110  2 005700   200027 235100                    LDA     I,,AUTO
         2 005701   000001 035007                    ADLA    1,DL
         2 005702   200030 755100                    STA     J,,AUTO
         2 005703   005716 710000 2                  TRA     s:12115+1

     1012    12111    5                 IF CC>VID.DTT(J) THEN DO;

  12111  2 005704   200111 470500                    LDP0    VID$,,AUTO
         2 005705   200030 720100                    LXL0    J,,AUTO
         2 005706   000400 236110                    LDQ     256,X0,PR0
         2 005707   000022 772000                    QRL     18
         2 005710   200013 116100                    CMPQ    CC,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:184  
         2 005711   005715 605000 2                  TPL     s:12115

     1013    12112    5                    K=J;

  12112  2 005712   200030 235100                    LDA     J,,AUTO
         2 005713   200031 755100                    STA     K,,AUTO

     1014    12113    5                    CC=VID.DTT(J);

  12113  2 005714   200013 756100                    STQ     CC,,AUTO

     1015    12114    5                    END;

     1016    12115    4                 END/* DO J */;

  12115  2 005715   200030 054100                    AOS     J,,AUTO
         2 005716   200030 236100                    LDQ     J,,AUTO
         2 005717   200017 116100                    CMPQ    DTTX,,AUTO
         2 005720   005704 604000 2                  TMI     s:12111

     1017    12116    4              IF K~=0 THEN DO;

  12116  2 005721   200031 235100                    LDA     K,,AUTO
         2 005722   005734 600000 2                  TZE     s:12121

     1018    12117    4                 VID.DTT(K)=VID.DTT(I);

  12117  2 005723   200027 720100                    LXL0    I,,AUTO
         2 005724   000400 221110                    LDX1    256,X0,PR0
         2 005725   000400 741105                    STX1    256,AL,PR0

     1019    12118    4                 VID.DTT(I)=CC;

  12118  2 005726   200013 721100                    LXL1    CC,,AUTO
         2 005727   200111 470500                    LDP0    VID$,,AUTO
         2 005730   000400 741110                    STX1    256,X0,PR0

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:185  
     1020    12119    4                 VIP.DTTCH='1'B;

  12119  2 005731   200110 470500                    LDP0    VI$,,AUTO
         2 005732   004000 236007                    LDQ     2048,DL
         2 005733   000017 256100                    ORSQ    15,,PR0

     1021    12120    4                 END;

     1022    12121    3              END/* DO I */;

  12121  2 005734   200027 054100                    AOS     I,,AUTO
         2 005735   200027 236100                    LDQ     I,,AUTO
         2 005736   200017 116100                    CMPQ    DTTX,,AUTO
         2 005737   005672 604000 2                  TMI     s:12108

     1023    12122    3           DO I=1 TO DTTX-1;

  12122  2 005740   000001 235007                    LDA     1,DL
         2 005741   200027 755100                    STA     I,,AUTO
         2 005742   005773 710000 2                  TRA     s:12131+1

     1024    12123    4              IF VID.DTT(I)=VID.DTT(I-1) THEN DO;

  12123  2 005743   200111 470500                    LDP0    VID$,,AUTO
         2 005744   200027 720100                    LXL0    I,,AUTO
         2 005745   000400 221110                    LDX1    256,X0,PR0
         2 005746   000377 101110                    CMPX1   255,X0,PR0
         2 005747   005772 601000 2                  TNZ     s:12131

     1025    12124    5                 DO J=I+1 TO DTTX-1;

  12124  2 005750   200027 235100                    LDA     I,,AUTO
         2 005751   000001 035007                    ADLA    1,DL
         2 005752   200030 755100                    STA     J,,AUTO
         2 005753   005761 710000 2                  TRA     s:12126+1

     1026    12125    5                    VID.DTT(J-1)=VID.DTT(J);
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:186  

  12125  2 005754   200111 470500                    LDP0    VID$,,AUTO
         2 005755   200030 720100                    LXL0    J,,AUTO
         2 005756   000400 221110                    LDX1    256,X0,PR0
         2 005757   000377 741110                    STX1    255,X0,PR0

     1027    12126    5                    END;

  12126  2 005760   200030 054100                    AOS     J,,AUTO
         2 005761   200030 236100                    LDQ     J,,AUTO
         2 005762   200017 116100                    CMPQ    DTTX,,AUTO
         2 005763   005754 604000 2                  TMI     s:12125

     1028    12127    4                 I=I-1;

  12127  2 005764   000001 336007                    LCQ     1,DL
         2 005765   200027 056100                    ASQ     I,,AUTO

     1029    12128    4                 DTTX=DTTX-1;

  12128  2 005766   200017 056100                    ASQ     DTTX,,AUTO

     1030    12129    4                 VIP.DTTCH='1'B;

  12129  2 005767   200110 470500                    LDP0    VI$,,AUTO
         2 005770   004000 236007                    LDQ     2048,DL
         2 005771   000017 256100                    ORSQ    15,,PR0

     1031    12130    4                 END/* IF VID.DTT(I) */;

     1032    12131    3              END/* DO I */;

  12131  2 005772   200027 054100                    AOS     I,,AUTO
         2 005773   200027 236100                    LDQ     I,,AUTO
         2 005774   200017 116100                    CMPQ    DTTX,,AUTO
         2 005775   005743 604000 2                  TMI     s:12123

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:187  
     1033    12132    3           DO I=DTTX TO 62;

  12132  2 005776   200017 235100                    LDA     DTTX,,AUTO
         2 005777   200027 755100                    STA     I,,AUTO
         2 006000   006006 710000 2                  TRA     s:12134+1

     1034    12133    3              VID.DT(I)='777777777777'O;

  12133  2 006001   000027 236000 xsym               LDQ     B_VECTNIL+23
         2 006002   200111 470500                    LDP0    VID$,,AUTO
         2 006003   200027 720100                    LXL0    I,,AUTO
         2 006004   000400 756110                    STQ     256,X0,PR0

     1035    12134    3              END;

  12134  2 006005   200027 054100                    AOS     I,,AUTO
         2 006006   200027 235100                    LDA     I,,AUTO
         2 006007   000076 115007                    CMPA    62,DL
         2 006010   006001 604400 2                  TMOZ    s:12133

     1036    12135    2           CALL IVZ$CKSUM(VID.DTT);

  12135  2 006011   200111 236100                    LDQ     VID$,,AUTO
         2 006012   000400 036003                    ADLQ    256,DU
         2 006013   200144 756100                    STQ     @V+17,,AUTO
         2 006014   200144 630500                    EPPR0   @V+17,,AUTO
         2 006015   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006016   000000 701000 xent               TSX1    IVZ$CKSUM
         2 006017   000000 011000                    NOP     0

     1037    12136    2           RETURN;

  12136  2 006020   200116 221300                    LDX1  ! @V1,,AUTO
         2 006021   000001 702211                    TSX2  ! 1,X1

     1038    12137    2   END SORT_DTT;
     1039    12138
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:188  
     1040    12139
     1041    12140    1   SORT_LOG: PROC;

  12140  2 006022   200114 741300       SORT_LOG     STX1  ! VIP$+2,,AUTO

     1042    12141    2   DCL CC UBIN ALIGNED;
     1043    12142    2   DCL HH UBIN ALIGNED;
     1044    12143    2   DCL POS UBIN ALIGNED;
     1045    12144    2   DCL K SBIN ALIGNED;
     1046    12145    2   DCL ITEM BIT(48) DALIGNED;
     1047    12146
     1048    12147    3           DO I=0 TO 3071;

  12147  2 006023   200027 450100                    STZ     I,,AUTO

     1049    12148    3              IF LOG(I)='0'B THEN RETURN;

  12148  2 006024   200027 236100                    LDQ     I,,AUTO
         2 006025   000060 402007                    MPY     48,DL
         2 006026   000000 116003                    CMPQ    0,DU
         2 006027   006031 605000 2                  TPL     s:12148+5
         2 006030   000044 036003                    ADLQ    36,DU
         2 006031   200102 470500                    LDP0    DATA$,,AUTO
         2 006032   000000 066506                    CMPB    filb='0'B
         2 006033   000000 000060                    BDSC    0,Q,PR0                  by=0,bit=0,n=48
         2 006034   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 006035   006040 601000 2                  TNZ     s:12149

  12148  2 006036   200114 221300                    LDX1  ! VIP$+2,,AUTO
         2 006037   000001 702211                    TSX2  ! 1,X1

     1050    12149    3              K=0;

  12149  2 006040   200120 450100                    STZ     K,,AUTO

     1051    12150    3              CC=LOG.CYL(I); HH=LOG.HD(I); POS=LOG.POS(I);

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:189  
  12150  2 006041   200027 236100                    LDQ     I,,AUTO
         2 006042   000060 402007                    MPY     48,DL
         2 006043   000000 116003                    CMPQ    0,DU
         2 006044   006046 605000 2                  TPL     s:12150+5
         2 006045   000044 036003                    ADLQ    36,DU
         2 006046   003100 061506                    CSR     bolr='003'O
         2 006047   000000 000020                    BDSC    0,Q,PR0                  by=0,bit=0,n=16
         2 006050   200115 000044                    BDSC    CC,,AUTO                 by=0,bit=0,n=36

  12150  2 006051   200027 236100                    LDQ     I,,AUTO
         2 006052   000060 402007                    MPY     48,DL
         2 006053   000000 116003                    CMPQ    0,DU
         2 006054   006056 605000 2                  TPL     s:12150+13
         2 006055   000044 036003                    ADLQ    36,DU
         2 006056   003100 061506                    CSR     bolr='003'O
         2 006057   000000 270010                    BDSC    0,Q,PR0                  by=1,bit=7,n=8
         2 006060   200116 000044                    BDSC    HH,,AUTO                 by=0,bit=0,n=36

  12150  2 006061   200027 236100                    LDQ     I,,AUTO
         2 006062   000060 402007                    MPY     48,DL
         2 006063   000000 116003                    CMPQ    0,DU
         2 006064   006066 605000 2                  TPL     s:12150+21
         2 006065   000044 036003                    ADLQ    36,DU
         2 006066   003100 061506                    CSR     bolr='003'O
         2 006067   000000 460020                    BDSC    0,Q,PR0                  by=2,bit=6,n=16
         2 006070   200117 000044                    BDSC    POS,,AUTO                by=0,bit=0,n=36

     1052    12151    4              DO J=I+1 TO 3071;

  12151  2 006071   200027 235100                    LDA     I,,AUTO
         2 006072   000001 035007                    ADLA    1,DL
         2 006073   200030 755100                    STA     J,,AUTO
         2 006074   006271 710000 2                  TRA     s:12173+1

     1053    12152    4                 IF LOG(J)='0'B THEN RETURN;

  12152  2 006075   200030 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:190  
         2 006076   000060 402007                    MPY     48,DL
         2 006077   000000 116003                    CMPQ    0,DU
         2 006100   006102 605000 2                  TPL     s:12152+5
         2 006101   000044 036003                    ADLQ    36,DU
         2 006102   200102 470500                    LDP0    DATA$,,AUTO
         2 006103   000000 066506                    CMPB    filb='0'B
         2 006104   000000 000060                    BDSC    0,Q,PR0                  by=0,bit=0,n=48
         2 006105   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 006106   006111 601000 2                  TNZ     s:12153

  12152  2 006107   200114 221300                    LDX1  ! VIP$+2,,AUTO
         2 006110   000001 702211                    TSX2  ! 1,X1

     1054    12153    5                 IF CC>LOG.CYL(J) THEN DO;

  12153  2 006111   200030 236100                    LDQ     J,,AUTO
         2 006112   000060 402007                    MPY     48,DL
         2 006113   000000 116003                    CMPQ    0,DU
         2 006114   006116 605000 2                  TPL     s:12153+5
         2 006115   000044 036003                    ADLQ    36,DU
         2 006116   003100 061506                    CSR     bolr='003'O
         2 006117   000000 000020                    BDSC    0,Q,PR0                  by=0,bit=0,n=16
         2 006120   200144 000044                    BDSC    @V+17,,AUTO              by=0,bit=0,n=36
         2 006121   200144 236100                    LDQ     @V+17,,AUTO
         2 006122   200115 116100                    CMPQ    CC,,AUTO
         2 006123   006147 603000 2                  TRC     s:12158

     1055    12154    5                    K=J;

  12154  2 006124   200030 235100                    LDA     J,,AUTO
         2 006125   200120 755100                    STA     K,,AUTO

     1056    12155    5                    CC=LOG.CYL(J); ITEM=LOG(I);

  12155  2 006126   200030 236100                    LDQ     J,,AUTO
         2 006127   000060 402007                    MPY     48,DL
         2 006130   000000 116003                    CMPQ    0,DU
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:191  
         2 006131   006133 605000 2                  TPL     s:12155+5
         2 006132   000044 036003                    ADLQ    36,DU
         2 006133   003100 061506                    CSR     bolr='003'O
         2 006134   000000 000020                    BDSC    0,Q,PR0                  by=0,bit=0,n=16
         2 006135   200115 000044                    BDSC    CC,,AUTO                 by=0,bit=0,n=36

  12155  2 006136   200027 236100                    LDQ     I,,AUTO
         2 006137   000060 402007                    MPY     48,DL
         2 006140   000000 116003                    CMPQ    0,DU
         2 006141   006143 605000 2                  TPL     s:12155+13
         2 006142   000044 036003                    ADLQ    36,DU
         2 006143   003100 060506                    CSL     bolr='003'O
         2 006144   000000 000060                    BDSC    0,Q,PR0                  by=0,bit=0,n=48
         2 006145   200122 000060                    BDSC    ITEM,,AUTO               by=0,bit=0,n=48

     1057    12156    5                    END;

  12156  2 006146   006270 710000 2                  TRA     s:12173

     1058    12157    5                 ELSE DO;

     1059    12158    6                    IF CC=LOG.CYL(J) THEN DO;

  12158  2 006147   200030 236100                    LDQ     J,,AUTO
         2 006150   000060 402007                    MPY     48,DL
         2 006151   000000 116003                    CMPQ    0,DU
         2 006152   006154 605000 2                  TPL     s:12158+5
         2 006153   000044 036003                    ADLQ    36,DU
         2 006154   003100 061506                    CSR     bolr='003'O
         2 006155   000000 000020                    BDSC    0,Q,PR0                  by=0,bit=0,n=16
         2 006156   200144 000044                    BDSC    @V+17,,AUTO              by=0,bit=0,n=36
         2 006157   200144 236100                    LDQ     @V+17,,AUTO
         2 006160   200115 116100                    CMPQ    CC,,AUTO
         2 006161   006270 601000 2                  TNZ     s:12173

     1060    12159    7                       IF HH>LOG.HD(J) THEN DO;

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:192  
  12159  2 006162   200030 236100                    LDQ     J,,AUTO
         2 006163   000060 402007                    MPY     48,DL
         2 006164   000000 116003                    CMPQ    0,DU
         2 006165   006167 605000 2                  TPL     s:12159+5
         2 006166   000044 036003                    ADLQ    36,DU
         2 006167   003100 061506                    CSR     bolr='003'O
         2 006170   000000 270010                    BDSC    0,Q,PR0                  by=1,bit=7,n=8
         2 006171   200144 000044                    BDSC    @V+17,,AUTO              by=0,bit=0,n=36
         2 006172   200144 236100                    LDQ     @V+17,,AUTO
         2 006173   200116 116100                    CMPQ    HH,,AUTO
         2 006174   006220 603000 2                  TRC     s:12164

     1061    12160    7                          K=J;

  12160  2 006175   200030 235100                    LDA     J,,AUTO
         2 006176   200120 755100                    STA     K,,AUTO

     1062    12161    7                          HH=LOG.HD(J); ITEM=LOG(I);

  12161  2 006177   200030 236100                    LDQ     J,,AUTO
         2 006200   000060 402007                    MPY     48,DL
         2 006201   000000 116003                    CMPQ    0,DU
         2 006202   006204 605000 2                  TPL     s:12161+5
         2 006203   000044 036003                    ADLQ    36,DU
         2 006204   003100 061506                    CSR     bolr='003'O
         2 006205   000000 270010                    BDSC    0,Q,PR0                  by=1,bit=7,n=8
         2 006206   200116 000044                    BDSC    HH,,AUTO                 by=0,bit=0,n=36

  12161  2 006207   200027 236100                    LDQ     I,,AUTO
         2 006210   000060 402007                    MPY     48,DL
         2 006211   000000 116003                    CMPQ    0,DU
         2 006212   006214 605000 2                  TPL     s:12161+13
         2 006213   000044 036003                    ADLQ    36,DU
         2 006214   003100 060506                    CSL     bolr='003'O
         2 006215   000000 000060                    BDSC    0,Q,PR0                  by=0,bit=0,n=48
         2 006216   200122 000060                    BDSC    ITEM,,AUTO               by=0,bit=0,n=48

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:193  
     1063    12162    7                          END;

  12162  2 006217   006270 710000 2                  TRA     s:12173

     1064    12163    7                       ELSE DO;

     1065    12164    8                          IF HH=LOG.HD(J) THEN DO;

  12164  2 006220   200030 236100                    LDQ     J,,AUTO
         2 006221   000060 402007                    MPY     48,DL
         2 006222   000000 116003                    CMPQ    0,DU
         2 006223   006225 605000 2                  TPL     s:12164+5
         2 006224   000044 036003                    ADLQ    36,DU
         2 006225   003100 061506                    CSR     bolr='003'O
         2 006226   000000 270010                    BDSC    0,Q,PR0                  by=1,bit=7,n=8
         2 006227   200144 000044                    BDSC    @V+17,,AUTO              by=0,bit=0,n=36
         2 006230   200144 236100                    LDQ     @V+17,,AUTO
         2 006231   200116 116100                    CMPQ    HH,,AUTO
         2 006232   006270 601000 2                  TNZ     s:12173

     1066    12165    9                             IF POS>LOG.POS(J) THEN DO;

  12165  2 006233   200030 236100                    LDQ     J,,AUTO
         2 006234   000060 402007                    MPY     48,DL
         2 006235   000000 116003                    CMPQ    0,DU
         2 006236   006240 605000 2                  TPL     s:12165+5
         2 006237   000044 036003                    ADLQ    36,DU
         2 006240   003100 061506                    CSR     bolr='003'O
         2 006241   000000 460020                    BDSC    0,Q,PR0                  by=2,bit=6,n=16
         2 006242   200144 000044                    BDSC    @V+17,,AUTO              by=0,bit=0,n=36
         2 006243   200144 236100                    LDQ     @V+17,,AUTO
         2 006244   200117 116100                    CMPQ    POS,,AUTO
         2 006245   006270 603000 2                  TRC     s:12173

     1067    12166    9                                K=J;

  12166  2 006246   200030 235100                    LDA     J,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:194  
         2 006247   200120 755100                    STA     K,,AUTO

     1068    12167    9                                POS=LOG.POS(J); ITEM=LOG(I);

  12167  2 006250   200030 236100                    LDQ     J,,AUTO
         2 006251   000060 402007                    MPY     48,DL
         2 006252   000000 116003                    CMPQ    0,DU
         2 006253   006255 605000 2                  TPL     s:12167+5
         2 006254   000044 036003                    ADLQ    36,DU
         2 006255   003100 061506                    CSR     bolr='003'O
         2 006256   000000 460020                    BDSC    0,Q,PR0                  by=2,bit=6,n=16
         2 006257   200117 000044                    BDSC    POS,,AUTO                by=0,bit=0,n=36

  12167  2 006260   200027 236100                    LDQ     I,,AUTO
         2 006261   000060 402007                    MPY     48,DL
         2 006262   000000 116003                    CMPQ    0,DU
         2 006263   006265 605000 2                  TPL     s:12167+13
         2 006264   000044 036003                    ADLQ    36,DU
         2 006265   003100 060506                    CSL     bolr='003'O
         2 006266   000000 000060                    BDSC    0,Q,PR0                  by=0,bit=0,n=48
         2 006267   200122 000060                    BDSC    ITEM,,AUTO               by=0,bit=0,n=48

     1069    12168    9                                END;

     1070    12169    8                             END;

     1071    12170    7                          END;

     1072    12171    6                       END;

     1073    12172    5                    END;

     1074    12173    4                 END/* DO J */;

  12173  2 006270   200030 054100                    AOS     J,,AUTO
         2 006271   200030 235100                    LDA     J,,AUTO
         2 006272   005777 115007                    CMPA    3071,DL
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:195  
         2 006273   006075 604400 2                  TMOZ    s:12152

     1075    12174    4              IF K~=0 THEN DO;

  12174  2 006274   200120 236100                    LDQ     K,,AUTO
         2 006275   006325 600000 2                  TZE     s:12178

     1076    12175    4                 LOG(K)=LOG(I);

  12175  2 006276   200027 236100                    LDQ     I,,AUTO
         2 006277   000060 402007                    MPY     48,DL
         2 006300   000000 116003                    CMPQ    0,DU
         2 006301   006303 605000 2                  TPL     s:12175+5
         2 006302   000044 036003                    ADLQ    36,DU
         2 006303   200144 756100                    STQ     @V+17,,AUTO
         2 006304   200120 236100                    LDQ     K,,AUTO
         2 006305   000060 402007                    MPY     48,DL
         2 006306   000000 116003                    CMPQ    0,DU
         2 006307   006311 605000 2                  TPL     s:12175+11
         2 006310   000044 036003                    ADLQ    36,DU
         2 006311   200144 235100                    LDA     @V+17,,AUTO
         2 006312   003106 060505                    CSL     bolr='003'O
         2 006313   000000 000060                    BDSC    0,A,PR0                  by=0,bit=0,n=48
         2 006314   000000 000060                    BDSC    0,Q,PR0                  by=0,bit=0,n=48

     1077    12176    4                 LOG(I)=ITEM;

  12176  2 006315   200027 236100                    LDQ     I,,AUTO
         2 006316   000060 402007                    MPY     48,DL
         2 006317   000000 116003                    CMPQ    0,DU
         2 006320   006322 605000 2                  TPL     s:12176+5
         2 006321   000044 036003                    ADLQ    36,DU
         2 006322   003106 060500                    CSL     bolr='003'O
         2 006323   200122 000060                    BDSC    ITEM,,AUTO               by=0,bit=0,n=48
         2 006324   000000 000060                    BDSC    0,Q,PR0                  by=0,bit=0,n=48

     1078    12177    4                 END;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:196  

     1079    12178    3              END/* DO I */;

  12178  2 006325   200027 054100                    AOS     I,,AUTO
         2 006326   200027 235100                    LDA     I,,AUTO
         2 006327   005777 115007                    CMPA    3071,DL
         2 006330   006024 604400 2                  TMOZ    s:12148

     1080    12179    2   END SORT_LOG;

  12179  2 006331   200114 221300                    LDX1  ! VIP$+2,,AUTO
         2 006332   000001 702211                    TSX2  ! 1,X1

     1081    12180
     1082    12181
     1083    12182    1   CONVMPC: PROC(SECTOR);

  12182  2 006333   200114 741300       CONVMPC      STX1  ! VIP$+2,,AUTO

     1084    12183    2   DCL SECTOR BIT(36) ALIGNED;
     1085    12184    2   DCL 1 SEC REDEF SECTOR ALIGNED,
     1086    12185    2         2 * UBIN(20) UNAL,
     1087    12186    2         2 CL UBIN(8) UNAL,
     1088    12187    2         2 CU UBIN(2) UNAL,
     1089    12188    2         2 HD UBIN(6) UNAL;
     1090    12189    2           SEC.CL=TR.CY.LWR;

  12189  2 006334   200115 470500                    LDP0    @SECTOR,,AUTO
         2 006335   200104 236100                    LDQ     TRACK,,AUTO
         2 006336   000022 772000                    QRL     18
         2 006337   000000 676100                    ERQ     0,,PR0
         2 006340   177400 376007                    ANQ     65280,DL
         2 006341   000000 656100                    ERSQ    0,,PR0

     1091    12190    2           SEC.CU=TR.CY.UPR;

  12190  2 006342   200104 236100                    LDQ     TRACK,,AUTO
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:197  
         2 006343   000034 772000                    QRL     28
         2 006344   000000 676100                    ERQ     0,,PR0
         2 006345   000300 376007                    ANQ     192,DL
         2 006346   000000 656100                    ERSQ    0,,PR0

     1092    12191    2           SEC.HD=TR.HD;

  12191  2 006347   200104 236100                    LDQ     TRACK,,AUTO
         2 006350   000022 772000                    QRL     18
         2 006351   000000 752101                    STCQ    0,'01'O,PR0

     1093    12192
     1094    12193    2   END CONVMPC;

  12193  2 006352   200114 221300                    LDX1  ! VIP$+2,,AUTO
         2 006353   000001 702211                    TSX2  ! 1,X1

DTT_PROMPT
 Sect OctLoc
   1     000   000000 000014   101105 156164   145162 040104   124124 072040    ....AEnter DTT:

OKREQ
 Sect OctLoc
   1     004   000000 000024   100117 153040   164157 040143   150141 156147    ....@Ok to chang
   1     010   145040 126123   116040 040040                                    e VSN

STATUS
 Sect OctLoc
   1     012   000000 000035   101104 120060   060040 126123   116072 060060    ....ADP00 VSN:00
   1     016   060060 060060   040141 164040   103103 103103   056110 110040    0000 at CCCC.HH
   1     022   040*** ******                                                     ...

CONSTANT_PCB
 Sect OctLoc
   1     023   000000 006014   000000 006014   000000 006014   000000 006014    ................
   1     027   000000 000000   000000 600000   000000 000000   040042 040042    ............ " "
   1     033   000000 040000   000000 000000   000000 000000   000000 006014    .. .............
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:198  
   1     037   000000 006014   000000 000000                                    ........

IV_PROMPT
 Sect OctLoc
   1     041   052*** ******                                                    *...

DONE
 Sect OctLoc
   1     042   ****** ******   101126 117114   111116 111124   040157 146040    ....AVOLINIT of
   1     046   126123 116072   060060 060060   060060 040157   156040 104120    VSN:000000 on DP
   1     052   060060 040163   164157 160160   145144 040141   164040 103103    00 stopped at CC
   1     056   103103 056110   110054 040104   124124 040157   166145 162146    CC.HH, DTT overf
   1     062   154157 167054   040144 151163   153040 145162   162157 162056    low, disk error.
   1     066   040*** ******                                                     ...

DTTHDR
 Sect OctLoc
   1     067   000000 000030   101040 104145   146145 143164   151166 145040    ....A Defective
   1     073   164162 141143   153040 164141   142154 145040                    track table

DTTLINE
 Sect OctLoc
   1     076   000000 000035   101040 040040   040040 103103   103103 056110    ....A     CCCC.H
   1     102   110040 040040   040107 107107   107107 055107   107107 107107    H    GGGGG-GGGGG
   1     106   040*** ******                                                     ...

(unnamed)
 Sect OctLoc
   1     107   040042 040040   101126 117114   111116 111124   040040 040040     "  AVOLINIT
   1     113   040110 145162   145040 040040   115123 125063   063071 060040     Here   MSU3390
   1     117   115123 125070   060070 062040   115123 125070   060071 062040    MSU8082 MSU8092
   1     123   115123 125063   063071 062040   115123 125063   063071 063040    MSU3392 MSU3393
   1     127   115123 125063   063071 061040   115123 125063   063070 061040    MSU3391 MSU3381
   1     133   115123 125063   063070 062040   115123 125063   063070 063040    MSU3382 MSU3383
   1     137   115123 125063   063070 060040   115123 125060   065060 071040    MSU3380 MSU0509
   1     143   115123 125060   065060 061040   115123 125060   064065 061040    MSU0501 MSU0451
   1     147   103120 066040   305206 000000   272520 200600   525252 525252    CP6 ............
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:199  
   1     153   177700 700000   347700 720000   163164 157160   160145 144040    ........stopped
   1     157   141164 040103   103103 103056   110110 040040   143157 155160    at CCCC.HH  comp
   1     163   154145 164145   144040 040040   054040 104124   124040 157166    leted   , DTT ov
   1     167   145162 146154   157167 040040                                    erflow

(unnamed)
 Sect OctLoc
   3     000   000000 006000   000002 006000   000041 006000   000000 000000    .........!......
   3     004   000000 177640   000041 006000   000004 006000   000000 000015    .....!..........
   3     010   000007 006000   000000 000124   000011 006000   777777 377777    .......T........
   3     014   777777 577777   777777 777577   777770 777777   777777 677777    ................
   3     020   777777 777377   000007 006000   000377 777400   000005 006000    ................
   3     024   000000 000024   000024 006000   000000 000025   000026 006000    ................
   3     030   000000 000026   000030 006000   000000 000027   000032 006000    ................
   3     034   000000 000030   000034 006000   000000 000031   000036 006000    ................
   3     040   000000 000032   000040 006000   000000 000044   000042 006000    ..... .....$."..
   3     044   000000 000045   000044 006000   000000 000046   000046 006000    ...%.$.....&.&..
   3     050   000000 000047   000050 006000   000000 000043   000052 006000    ...'.(.....#.*..
   3     054   000000 000016   000054 006000   000000 002000   000056 006000    .....,..........
   3     060   000000 000033   000060 006000   000000 000034   000062 006000    .....0.......2..
   3     064   000012 006000   000004 006000   000002 006000   116040 040040    ............N
   3     070   077040 040040   000070 006000   131040 040040   000000 000022    ?   .8..Y   ....
   3     074   000073 006000   000000 000023   000075 006000   000000 000014    .;.......=......
   3     100   000077 006000   777777 773777   000000 006000   000002 006000    .?..............
   3     104   136040 040040   000104 006000   000003 006000   000010 006000    ^   .D..........
   3     110   000011 006000   777777 000377   777777 777400   000000 000020    ................
   3     114   000113 006000   777777 777600   000377 777777   777477 777777    .K..............
   3     120   000007 260000   000007 777777   000014 006000   000010 006000    ................
   3     124   000024 006000   000006 006000   000036 006000   000004 006000    ................
   3     130   000004 200000   000030 006000   000112 006000   000003 006000    .........J......
   3     134   000013 006000   000112 006000   000013 006000   000000 000000    .....J..........
   3     140   000113 006000   000010 006000   000000 000052   000000 000057    .K.........*.../
   3     144   000142 006000   000006 006000   000143 006000   000004 006000    .b.......c......
   3     150   000067 006000   000002 006000   000010 006000   000006 006000    .7..............
   3     154   000015 006000   000004 006000   000032 006000   000010 006000    ................
     1095    12194    1   END IVV$VOLINIT;
     1096    12195        %EOD;
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:200  

PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:201  
--  Include file information  --

   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   IV_SUBS_C.:E05TOU  is referenced.
   IV$MACROS.:E05TOU  is referenced.
   FM$GRAN.:E05TOU  is referenced.
      No diagnostics issued in procedure IVV$VOLINIT.
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:202  

 **** Variables and constants ****

  ****  Section 001 RoData IVV$VOLINIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    23-0-0/w STRC(504)   r     1 CONSTANT_PCB              42-0-0/w STRC(729)   r     1 DONE
    67-0-0/w STRC(252)   r     1 DTTHDR                    76-0-0/w STRC(297)   r     1 DTTLINE
     0-0-0/w STRC(144)   r     1 DTT_PROMPT                41-0-0/c CHAR        r     1 IV_PROMPT
     4-0-0/w STRC(216)   r     1 OKREQ                     12-0-0/w STRC(297)   r     1 STATUS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   115-0-0/w PTR         r     1 @D                       115-0-0/w PTR         r     1 @SECTOR
   123-0-0/w PTR         r     1 @V                       116-0-0/w PTR         r     1 @V1
   117-0-0/w PTR         r     1 @V2                       12-0-0/b BIT         r     1 BB
    11-0-0/w PTR         r     1 BLK$                      13-0-0/w SBIN        r     1 CC
   115-0-0/w UBIN        r     1 CC                        14-0-0/w SBIN        r     1 CC1
    15-0-0/w SBIN        r     1 CC2                      121-0-0/c CHAR        r     1 CH
     3-0-0/w STRC(216)   r     1 CMD_PROMPT               105-0-0/w STRC        r     1 CYL
    *0-0-0/w ASTR(9)     r     1 D                        102-0-0/w PTR         r     1 DATA$
    16-0-0/w CHAR(4)     r     1 DEVID                     17-0-0/w SBIN        r     1 DTTX
    20-0-0/w PTR         r     1 DVT$                     103-0-0/w PTR         r     1 ELT$
    26-0-0/w SBIN        r     1 ERROR_CNT                 21-0-0/w PTR         r     1 FMT$
    22-0-0/b BIT         r     1 FOUNDF                   101-0-0/w PTR         r     1 HDR5$
   106-0-0/w STRC        r     1 HEAD                      24-0-0/w SBIN        r     1 HH
   116-0-0/w UBIN        r     1 HH                        25-0-0/w SBIN        r     1 HH2
    27-0-0/w SBIN        r     1 I                        120-0-0/w SBIN        r     1 I
   122-0-0/d BIT (48)    r     1 ITEM                      30-0-0/w SBIN        r     1 J
    31-0-0/w SBIN        r     1 K                        120-0-0/w SBIN        r     1 K
    32-0-0/w SBIN        r     1 LTRACK                    33-0-0/w SBIN        r     1 NHW
    34-0-0/w SBIN        r     1 NW                        35-0-0/w PTR         r     1 OPT$
    36-0-0/w STRC(756)   r     1 OUT                      117-0-0/w STRC(756)   r     1 OUTX
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:203  
    63-0-0/w STRC(504)   r     1 PCB                      117-0-0/w UBIN        r     1 POS
   115-0-0/w PTR         r     1 PVI$                      *0-0-0/w STRC        r     1 SEC
    *0-0-0/w BIT         r     1 SECTOR                   104-0-0/w STRC(18)    r     1 TR
   104-0-0/w UBIN(18)    r     1 TRACK                    107-0-0/b BIT         r     1 TRANGE
    *0-0-0/w SBIN        r     1 V                         *0-0-0/w SBIN        r     1 V1
    *0-0-0/w SBIN        r     1 V2                       110-0-0/w PTR         r     1 VI$
   111-0-0/w PTR         r     1 VID$                     112-0-0/w PTR         r     1 VIP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/c CHAR        r     1 B_VERSION
     0-0-0/w PTR         r     1 IV_IO$                     0-0-0/w BIT         r     1 IV_ONLINE
     0-0-0/w SBIN        r     1 IV_SYNTAX

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/c ASTR(9)     r     1 B$VERSIONB                 0-0-0/d STRC(2952)  r     1 CF
     0-0-0/c CHAR        r     1 CMDBUF                     0-0-0/w STRC(2844)  r     1 DVT
     0-0-0/w STRC(828)   r     1 ELT                        0-0-0/w STRC(828)   r     1 FMT
     0-0-0/w STRC(4752)  r     1 GVID                       0-0-0/w PTR         r     1 L#$
     0-0-0/b STRC(48)    r     1 LOG(0:3071)                0-0-0/c BIT (9)     r     1 LOG_BIT(0:16383)
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(36864) r     1 VID                        0-0-0/w STRC(3024)  r     1 VIP


   Procedure IVV$VOLINIT requires 3308 words for executable code.
   Procedure IVV$VOLINIT requires 112 words of local(AUTO) storage.
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:204  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:205  
          MINI XREF LISTING

B$ALT.CODE
     10752**DCL     10752--REDEF   10753--REDEF   10753--REDEF
B$ALT.ERR.CODE
     10754**DCL     11491>>IF      11494>>IF      11543>>IF      11548>>IF      11553>>IF      11913>>IF
     11919>>IF      11925>>IF      11997>>IF      12002>>IF
B$ALT.ERR.ERR#
     10754**DCL     10754--REDEF
B$ALT.EVID
     10753**DCL     10753--REDEF   10753--REDEF
B$TCB.ALT$
     10748**DCL     11491>>IF      11494>>IF      11543>>IF      11548>>IF      11553>>IF      11913>>IF
     11919>>IF      11925>>IF      11997>>IF      12002>>IF
B$TCB$
     10746**DCL     11491>>IF      11494>>IF      11543>>IF      11548>>IF      11553>>IF      11913>>IF
     11919>>IF      11925>>IF      11997>>IF      12002>>IF
B$VERSIONB.C_
     10770**DCL     10771--IMP-SIZ 11286>>CALLBLT
B$VERSIONB.T_
     10771**DCL     11286>>CALLBLT
BAD_VID
     11542**LABEL   11499--CALLALT
BB
     10785**DCL     11764<<ASSIGN  11766>>ASSIGN  11767<<ASSIGN  11767>>ASSIGN
BLK$
     10784**DCL     10599--IMP-PTR 10645--IMP-PTR 11292<>CALL    11297<<ASSIGN  11299>>DOCASE  11307>>IF
     11307>>IF      11316>>ASSIGN  11316>>ASSIGN  11317>>CALL    11342>>DOINDEX 11343>>ASSIGN  11646<<ASSIGN
     11647>>DOCASE  11649>>CALL    11822>>ASSIGN  11822>>ASSIGN  11825>>ASSIGN  11825>>ASSIGN  11833>>IF
     11833>>IF      11833>>IF      11839>>CALL    11839>>CALL    11851>>CALL
B_VERSION
     10768**DCL     11286--CALLBLT 11286--CALLBLT
CC
     10786**DCL     11374<>CALL    11376>>ASSIGN  11386>>IF      11387>>ASSIGN  11393<>CALL    11395>>ASSIGN
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:206  
     11401>>IF      11402>>ASSIGN  11606<<DOINDEX 11608>>ASSIGN  11624<<DOINDEX 11626>>ASSIGN  11649<>CALL
     11660>>ASSIGN  11662>>ASSIGN  11679>>IF      11680>>ASSIGN  12109<<ASSIGN  12111>>IF      12113<<ASSIGN
     12118>>ASSIGN
CC IN PROCEDURE SORT_LOG
     12141**DCL     12150<<ASSIGN  12153>>IF      12155<<ASSIGN  12158>>IF
CC1
     10787**DCL     11593<<ASSIGN  11598<<ASSIGN  11606>>DOINDEX 11624>>DOINDEX
CC2
     10788**DCL     11594<<ASSIGN  11599<<ASSIGN  11606>>DOINDEX 11624>>DOINDEX
CCHH_ERR
     11380**LABEL   11386--GOTO    11397--GOTO    11401--GOTO    11405--GOTO
CF
     11212**DCL     11784<<ASSIGN
CF.C0.TSKIP
     11223**DCL     11224--REDEF
CH IN PROCEDURE DECBIN
     12044**DCL     12052>>IF      12064<<ASSIGN  12065>>IF      12065>>IF      12066>>ASSIGN
CHECKDONE
     11893**PROC    11843--CALL    11886--CALL
CHECK_NEXT IN PROCEDURE CHECKDONE
     11939**LABEL   12024--GOTO
CHECK_NEXT_1 IN PROCEDURE CHECKDONE
     11941**LABEL   12020--GOTO
CMDBUF
     10465**DCL     11504<<ASSIGN  11507>>IF
CMD_PROMPT
     10765**DCL     11288<>CALL
CMD_PROMPT.CNT
     10766**DCL     11287<<ASSIGN
CMD_PROMPT.MSG
     10767**DCL     11286<<CALLBLT 11287--ASSIGN
CONSTANT_PCB
     11027**DCL     11277>>ASSIGN
CONVERT IN PROCEDURE DECBIN
     12059**PROC    12049--CALL    12054--CALL
CONVMPC
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:207  
     12182**PROC    11780--CALL
CYL
     11264**DCL     11808<<ASSIGN  11810<>CALL    11951<<ASSIGN  11953<>CALL
CYL.N
     11266**DCL     11809<<ASSIGN  11952<<ASSIGN
D IN PROCEDURE DECBIN
     12035**DCL     12031--PROC
D.CT IN PROCEDURE DECBIN
     12036**DCL     12037--IMP-SIZ 12052>>IF      12063>>DOINDEX 12064>>ASSIGN  12068>>ASSIGN
D.T IN PROCEDURE DECBIN
     12037**DCL     12064>>ASSIGN
DATA$
     11210**DCL     11239--IMP-PTR 11244--IMP-PTR 11783<<ASSIGN  11784>>ASSIGN  12148>>IF      12150>>ASSIGN
     12150>>ASSIGN  12150>>ASSIGN  12152>>IF      12153>>IF      12155>>ASSIGN  12155>>ASSIGN  12158>>IF
     12159>>IF      12161>>ASSIGN  12161>>ASSIGN  12164>>IF      12165>>IF      12167>>ASSIGN  12167>>ASSIGN
     12175>>ASSIGN  12175>>ASSIGN  12176>>ASSIGN
DECBIN
     12031**PROC    11317--CALL    11374--CALL    11393--CALL    11649--CALL
DEL_VI
     11871**LABEL   11372--GOTO    11381--GOTO    11446--GOTO    11497--GOTO    11502--CALLALT 11507--GOTO
     11546--GOTO    11551--GOTO    11556--GOTO    11657--GOTO    11757--GOTO
DEVID
     10789**DCL     11822<<ASSIGN  11823<>CALL    11825<<ASSIGN  11826<>CALL
DISK_ERR
     11868**LABEL   11788--CALLALT 11793--CALLALT
DISK_ERR IN PROCEDURE CHECKDONE
     11997**LABEL   11992--CALLALT
DONE IN PROCEDURE CHECKDONE
     11897**DCL     11943>>ASSIGN
DTTHDR IN PROCEDURE PRINT_DTT
     12079**DCL     12089<>CALL
DTTHDR.MSG IN PROCEDURE PRINT_DTT
     12081**DCL     12080--DCLINIT
DTTLINE IN PROCEDURE PRINT_DTT
     12082**DCL     12090>>ASSIGN
DTTLINE.MSG IN PROCEDURE PRINT_DTT
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:208  
     12084**DCL     12083--DCLINIT
DTTX
     10790**DCL     11524<<ASSIGN  11528<<ASSIGN  11532<<DOINDEX 11533>>IF      11535<<ASSIGN  11568<<DOINDEX
     11569>>ASSIGN  11573<<ASSIGN  11609>>DOINDEX 11614>>IF      11617>>ASSIGN  11618<<ASSIGN  11618>>ASSIGN
     11626>>ASSIGN  11627<<ASSIGN  11627>>ASSIGN  11628>>IF      11650>>IF      11669>>ASSIGN  11673<<ASSIGN
     11673>>ASSIGN  11674>>IF      11675>>ASSIGN  11680>>ASSIGN  11682>>ASSIGN  11685>>ASSIGN  11688<<ASSIGN
     11688>>ASSIGN  11972<<ASSIGN  12091>>DOINDEX 12107>>DOINDEX 12110>>DOINDEX 12122>>DOINDEX 12124>>DOINDEX
     12128<<ASSIGN  12128>>ASSIGN  12132>>DOINDEX
DTT_END_FOUND
     11537**LABEL   11533--GOTO
DTT_OVERFLOW
     11652**LABEL   11616--GOTO    11630--GOTO    11674--GOTO
DTT_PROMPT
     10772**DCL     11637<>CALL
DTT_PROMPT.MSG
     10774**DCL     10773--DCLINIT
DT_ERR
     11666**LABEL   11679--GOTO
DVT.CYLSIZE
     10468**DCL     11324>>ASSIGN  11325>>ASSIGN
DVT.GRANSIZE
     10468**DCL     11325>>ASSIGN  11325>>ASSIGN  11327>>ASSIGN  11376>>ASSIGN  11395>>ASSIGN  11660>>ASSIGN
     11662>>ASSIGN  11760>>ASSIGN
DVT.MPC
     10469**DCL     10470--REDEF
DVT.PACKSIZE
     10468**DCL     11325>>ASSIGN  11976>>ASSIGN
DVT.SECSIZE
     10469**DCL     11761>>ASSIGN
DVT.SPT
     10468**DCL     11323>>ASSIGN
DVT.T@DCYL
     10469**DCL     11326>>ASSIGN
DVT$
     10791**DCL     10467--IMP-PTR 11321<>CALL    11322>>ASSIGN  11323>>ASSIGN  11324>>ASSIGN  11325>>ASSIGN
     11325>>ASSIGN  11325>>ASSIGN  11325>>ASSIGN  11326>>ASSIGN  11327>>ASSIGN  11376>>ASSIGN  11395>>ASSIGN
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:209  
     11660>>ASSIGN  11662>>ASSIGN  11760>>ASSIGN  11761>>ASSIGN
ELT.DCW
     10541**DCL     11784<<ASSIGN
ELT.HEADER
     10566**DCL     10582--REDEF   10583--REDEF   11782--ASSIGN  11783--ASSIGN
ELT.HEADER_DCW
     10558**DCL     11784>>ASSIGN
ELT.SEEK.SECTOR
     10550**DCL     10551--REDEF   11780<>CALL
ELT.SEEK.Y
     10549**DCL     11781<<ASSIGN
ELT$
     11254**DCL     10530--IMP-PTR 11777<>CALL    11778>>ASSIGN  11780>>CALL    11781>>ASSIGN  11782>>ASSIGN
     11783>>ASSIGN  11784>>ASSIGN  11784>>ASSIGN
ELT_WK
     11756**LABEL   11727--GOTO    11744--GOTO    11776--GOTO
ERROR_CNT
     10797**DCL     11413<<ASSIGN  11416<<ASSIGN  11416>>ASSIGN  11420<<ASSIGN  11420>>ASSIGN  11424<<ASSIGN
     11424>>ASSIGN  11428<<ASSIGN  11428>>ASSIGN  11432<<ASSIGN  11432>>ASSIGN  11436<<ASSIGN  11436>>ASSIGN
     11440<<ASSIGN  11440>>ASSIGN  11444<<ASSIGN  11444>>ASSIGN  11446>>IF
FMT.DATA
     10527**DCL     11766<<ASSIGN
FMT.DCW
     10485**DCL     11771<<ASSIGN
FMT.HEADER
     10510**DCL     10526--REDEF   10527--REDEF   11760--ASSIGN
FMT.HEADER_DCW
     10502**DCL     11771>>ASSIGN
FMT.IDCW
     10482**DCL     11770<<ASSIGN
FMT.SEEK.SECTOR
     10494**DCL     10495--REDEF   11791<<ASSIGN  11814>>ASSIGN  11957>>ASSIGN
FMT.SEEK.Y
     10493**DCL     11786<<ASSIGN
FMT.SEEK_IDCW
     10475**DCL     11790<<ASSIGN
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:210  
FMT$
     10792**DCL     10474--IMP-PTR 11759<>CALL    11762>>ASSIGN  11766>>ASSIGN  11770>>ASSIGN  11771>>ASSIGN
     11771>>ASSIGN  11786>>ASSIGN  11790>>ASSIGN  11791>>ASSIGN
FOUNDF
     10793**DCL     11830<<ASSIGN  11835<<ASSIGN  11839>>IF
GVID.KEY
     10586**DCL     11512>>IF
GVID.OKEY
     10590**DCL     11516>>IF
GVID.ONUMB
     10592**DCL     11519>>ASSIGN
HDR5$
     11209**DCL     11212--IMP-PTR 11782<<ASSIGN  11784>>ASSIGN
HEAD
     11267**DCL     11808<<ASSIGN  11812<>CALL    11951<<ASSIGN  11955<>CALL
HEAD.N
     11269**DCL     11811<<ASSIGN  11954<<ASSIGN
HH
     10795**DCL     11374<>CALL    11375>>IF      11386>>IF      11387>>ASSIGN  11393<>CALL    11394>>IF
     11401>>IF      11402>>ASSIGN  11607<<DOINDEX 11608>>ASSIGN  11625<<DOINDEX 11626>>ASSIGN  11649<>CALL
     11659>>IF      11679>>IF      11680>>ASSIGN
HH IN PROCEDURE SORT_LOG
     12142**DCL     12150<<ASSIGN  12159>>IF      12161<<ASSIGN  12164>>IF
HH2
     10796**DCL     11595<<ASSIGN  11600<<ASSIGN  11607>>DOINDEX 11625>>DOINDEX
HH_ALT_UPD
     11607**LABEL   11612--EXIT
I
     10798**DCL     11342<<DOINDEX 11343>>ASSIGN  11609<<DOINDEX 11610>>IF      11724<<DOINDEX 11726>>ASSIGN
     11728>>DOINDEX 11736>>ASSIGN  11737>>ASSIGN  11740<<DOINDEX 11741>>ASSIGN  11745>>IF      11746>>IF
     11746>>IF      11746>>ASSIGN  11746>>ASSIGN  11747>>DOINDEX 11751<<ASSIGN  11751>>ASSIGN  11765<<DOINDEX
     11766>>ASSIGN  11977<<DOINDEX 11978>>IF      11979>>ASSIGN  11979>>ASSIGN  11979>>ASSIGN  11980>>ASSIGN
     11980>>ASSIGN  11980>>ASSIGN  11982>>ASSIGN  11988<<DOINDEX 11989>>ASSIGN  12091<<DOINDEX 12092>>IF
     12093>>CALL    12094>>CALL    12095>>CALL    12095>>CALL    12096>>CALL    12096>>CALL    12107<<DOINDEX
     12109>>ASSIGN  12110>>DOINDEX 12117>>ASSIGN  12118>>ASSIGN  12122<<DOINDEX 12123>>IF      12123>>IF
     12124>>DOINDEX 12127<<ASSIGN  12127>>ASSIGN  12132<<DOINDEX 12133>>ASSIGN  12147<<DOINDEX 12148>>IF
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:211  
     12150>>ASSIGN  12150>>ASSIGN  12150>>ASSIGN  12151>>DOINDEX 12155>>ASSIGN  12161>>ASSIGN  12167>>ASSIGN
     12175>>ASSIGN  12176>>ASSIGN
I IN PROCEDURE DECBIN
     12043**DCL     12048<<ASSIGN  12052>>IF      12053<<ASSIGN  12053>>ASSIGN  12063<<DOINDEX 12063>>DOINDEX
     12064>>ASSIGN  12068<<ASSIGN
ITEM IN PROCEDURE SORT_LOG
     12145**DCL     12155<<ASSIGN  12161<<ASSIGN  12167<<ASSIGN  12176>>ASSIGN
IVO$BATCH
     10433**DCL-ENT 11502--CALL    11888--CALL
IVO$CLEANUP
     10434**DCL-ENT 11848--CALL
IVO$CONT
     10435**DCL-ENT 11280--ASSIGN
IVO$FINDDVT
     10436**DCL-ENT 11321--CALL
IVO$FREE
     10438**DCL-ENT 11872--CALL    11874--CALL    11876--CALL    11879--CALL    12007--CALL    12009--CALL
     12011--CALL    12017--CALL
IVO$GET
     10439**DCL-ENT 11313--CALL    11486--CALL
IVO$GETCMD
     10440**DCL-ENT 11292--CALL
IVO$INIT
     10441**DCL-ENT 11278--CALL
IVO$KEYIN
     10442**DCL-ENT 11851--CALL
IVO$PRINT
     10443**DCL-ENT 11288--CALL    11503--CALL    11637--CALL    11818--CALL    11993--CALL    12089--CALL
     12097--CALL
IVO$QUEIO
     10444**DCL-ENT 11910--CALL
IVO$READ
     10445**DCL-ENT 11295--CALL    11506--CALL    11644--CALL
IVO$READ_VID
     10446**DCL-ENT 11499--CALL
IVO$RELDCB
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:212  
     10453**DCL-ENT 11878--CALL    12013--CALL
IVO$SETPC
     10447**DCL-ENT 11290--CALL    11505--CALL    11638--CALL
IVO$SWIN
     10448**DCL-ENT 11823--CALL
IVO$SWOUT
     10449**DCL-ENT 11826--CALL
IVO$VERIFY_FMT
     10451**DCL-ENT 11489--CALL
IVO$WAIT
     10450**DCL-ENT 11845--CALL    11889--CALL
IVO$WRITE_VID
     10452**DCL-ENT 11992--CALL
IVV$BINDEC
     10455**DCL-ENT 11805--CALL    11810--CALL    11812--CALL    11815--CALL    11816--CALL    11944--CALL
     11953--CALL    11955--CALL    11958--CALL    11959--CALL    12093--CALL    12094--CALL    12095--CALL
     12096--CALL
IVV$ERROR
     10456**DCL-ENT 11308--CALL    11371--CALL    11380--CALL    11415--CALL    11419--CALL    11423--CALL
     11427--CALL    11431--CALL    11435--CALL    11439--CALL    11443--CALL    11449--CALL    11453--CALL
     11457--CALL    11461--CALL    11465--CALL    11470--CALL    11474--CALL    11478--CALL    11482--CALL
     11493--CALL    11496--CALL    11501--CALL    11545--CALL    11550--CALL    11555--CALL    11559--CALL
     11641--CALL    11652--CALL    11656--CALL    11666--CALL    11694--CALL    11756--CALL    11839--CALL
     11853--CALL    11857--CALL    11861--CALL    11864--CALL    11868--CALL    11883--CALL    11915--CALL
     11921--CALL    11927--CALL    11999--CALL    12003--CALL    12004--CALL
IVV$FMTPAC
     10459**DCL-ENT 11759--CALL    11777--CALL
IVV$NEXT
     10458**DCL-ENT 11788--CALL    11793--CALL
IVZ$CKSUM
     10460**DCL-ENT 11523--CALL    11572--CALL    12135--CALL
IV_IO$
     10761**DCL     11285<<ASSIGN  11905>>DOWHILE 11907>>ASSIGN  11908<<ASSIGN
IV_ONLINE
     11274**DCL     11291>>IF      11491>>IF      11494>>IF      11542>>IF      11877>>IF      11912>>IF
     11997>>IF      12002>>IF      12012>>IF
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:213  
IV_PROMPT
     11275**DCL     11290<>CALL    11292--CALL
IV_SYNTAX
     10454**DCL     11279--ASSIGN  11292<>CALL
J
     10799**DCL     11728<<DOINDEX 11729>>IF      11730>>ASSIGN  11731>>ASSIGN  11747<<DOINDEX 11748>>ASSIGN
     11748>>ASSIGN  12110<<DOINDEX 12111>>IF      12112>>ASSIGN  12113>>ASSIGN  12124<<DOINDEX 12125>>ASSIGN
     12125>>ASSIGN  12151<<DOINDEX 12152>>IF      12153>>IF      12154>>ASSIGN  12155>>ASSIGN  12158>>IF
     12159>>IF      12160>>ASSIGN  12161>>ASSIGN  12164>>IF      12165>>IF      12166>>ASSIGN  12167>>ASSIGN
K
     10800**DCL     11725<<ASSIGN  11730<<ASSIGN  11734>>IF      11735>>ASSIGN  11736>>ASSIGN  12108<<ASSIGN
     12112<<ASSIGN  12116>>IF      12117>>ASSIGN
K IN PROCEDURE SORT_LOG
     12144**DCL     12149<<ASSIGN  12154<<ASSIGN  12160<<ASSIGN  12166<<ASSIGN  12174>>IF      12175>>ASSIGN
L#$
     10422**DCL     11582>>ASSIGN  11582<<ASSIGN  11796>>ASSIGN  11796<<ASSIGN  12015>>ASSIGN  12015<<ASSIGN
     12015>>ASSIGN  12015<<ASSIGN
LOG
     11239**DCL     11244--REDEF   12148>>IF      12152>>IF      12155>>ASSIGN  12161>>ASSIGN  12167>>ASSIGN
     12175<<ASSIGN  12175>>ASSIGN  12176<<ASSIGN
LOG.CYL
     11240**DCL     12150>>ASSIGN  12153>>IF      12155>>ASSIGN  12158>>IF
LOG.HD
     11241**DCL     12150>>ASSIGN  12159>>IF      12161>>ASSIGN  12164>>IF
LOG.POS
     11242**DCL     12150>>ASSIGN  12165>>IF      12167>>ASSIGN
LOG_BIT
     11244**DCL     11784<<ASSIGN
LTRACK
     10801**DCL     11662<<ASSIGN  11663<<ASSIGN  11663>>ASSIGN  11663>>ASSIGN  11664>>IF      11672>>IF
     11675>>ASSIGN
NEW_VID
     11562**LABEL   11522--GOTO
NEXT_CMD
     11290**LABEL   11301--GOTO    11450--GOTO    11454--GOTO    11458--GOTO    11462--GOTO    11466--GOTO
     11471--GOTO    11475--GOTO    11479--GOTO    11483--GOTO    11845--CALLALT 11887--GOTO    11888--CALLALT
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:214  
     11889--CALLALT
NEXT_DP
     11306**LABEL   11311--GOTO
NEXT_DT
     11644**LABEL   11644--CALLALT 11653--GOTO    11667--GOTO    11690--GOTO    11695--GOTO
NEXT_STATUS
     11803**LABEL   11819--GOTO
NEXT_STOP
     11831**LABEL   11837--GOTO
NHW
     10802**DCL     11760<<ASSIGN  11765>>DOINDEX 11765>>DOINDEX
NO_DISK
     11861**LABEL   11321--CALLALT
NO_DTT
     11528**LABEL   11523--CALLALT
NO_SPACE
     11883**LABEL   11313--CALLALT
NO_SPACE_1
     11864**LABEL   11486--CALLALT 11777--CALLALT
NW
     10803**DCL     11761<<ASSIGN  11765>>DOINDEX
OKREQ
     10775**DCL     11503<>CALL
OKREQ.MSG
     10777**DCL     10776--DCLINIT
OPT$
     10804**DCL     11343<<ASSIGN  11344>>DOCASE  11346>>ASSIGN  11374>>CALL    11389>>IF      11392>>IF
     11393>>CALL
OUT
     10805**DCL     11799<<ASSIGN  11818<>CALL    11943<<ASSIGN  11993<>CALL
OUT.LEN
     10806**DCL     11948<<ASSIGN  11964<<ASSIGN  11967>>CALLBLT 11968<<ASSIGN  11968>>ASSIGN
OUT.MSG
     10807**DCL     11804<<CALLBLT 11805<>CALL    11810<>CALL    11812<>CALL    11815<>CALL    11816<>CALL
     11944<>CALL    11945<<CALLBLT 11947<<CALLBLT 11953<>CALL    11955<>CALL    11958<>CALL    11959<>CALL
     11963<<CALLBLT 11967<<CALLBLT
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:215  
OUT$BLK.CODE
     10607**DCL     11299>>DOCASE  11344>>DOCASE  11346>>ASSIGN  11647>>DOCASE  11851>>CALL
OUT$BLK.NSUBLKS
     10611**DCL     11342>>DOINDEX 11389>>IF      11392>>IF      11833>>IF
OUT$BLK.SUBLK$
     10632**DCL     11307>>IF      11307>>IF      11316>>ASSIGN  11316>>ASSIGN  11317>>CALL    11343>>ASSIGN
     11346>>ASSIGN  11374>>CALL    11393>>CALL    11649>>CALL    11822>>ASSIGN  11822>>ASSIGN  11825>>ASSIGN
     11825>>ASSIGN  11833>>IF      11833>>IF      11839>>CALL    11839>>CALL
OUT$SYM.COUNT
     10668**DCL     10671--IMP-SIZ 11307>>IF      11316>>ASSIGN  11317<>CALL    11374<>CALL    11393<>CALL
     11649<>CALL    11822>>ASSIGN  11825>>ASSIGN  11833>>IF      11839>>CALL
OUT$SYM.TEXT
     10671**DCL     11307>>IF      11316>>ASSIGN  11822>>ASSIGN  11825>>ASSIGN  11833>>IF      11839<>CALL
OUTX IN PROCEDURE PRINT_DTT
     12085**DCL     12090<<ASSIGN  12097<>CALL
OUTX.MSG IN PROCEDURE PRINT_DTT
     12087**DCL     12093<>CALL    12094<>CALL    12095<>CALL    12096<>CALL
PARSE_ERR
     11857**LABEL   11296--CALLALT
PARSE_ERR_1
     11641**LABEL   11645--CALLALT
PCB
     10827**DCL     11277<<ASSIGN  11278<>CALL    11296<>CALL    11645<>CALL
PCB.CMPRS
     10862**DCL     11281<<ASSIGN
PCB.COMMENT.LEAD
     10945**DCL     11282<<ASSIGN
PCB.COMMENT.TRAIL
     10953**DCL     11283<<ASSIGN
PCB.OUT$
     10840**DCL     11297>>ASSIGN  11646>>ASSIGN
PCB.ROOT$
     10832**DCL     11279<<ASSIGN
PCB.TEXT$
     10828**DCL     11504>>ASSIGN  11507>>IF
PCB.U$$
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:216  
     10845**DCL     11280<<ASSIGN
POS IN PROCEDURE SORT_LOG
     12143**DCL     12150<<ASSIGN  12165>>IF      12167<<ASSIGN
PRINT_DTT
     12075**PROC    11530--CALL    11974--CALL
PVI$ IN PROCEDURE CHECKDONE
     11903**DCL     11916<<ASSIGN  11922<<ASSIGN  11928<<ASSIGN  11939<<ASSIGN  12015>>ASSIGN  12015>>IF
     12015<<ASSIGN  12015>>ASSIGN  12019>>ASSIGN  12022>>ASSIGN
QUE_ERR IN PROCEDURE CHECKDONE
     11912**LABEL   11910--CALLALT
RELEASE_SPACE IN PROCEDURE CHECKDONE
     12006**LABEL   11917--GOTO    11923--GOTO    11929--GOTO    11994--GOTO    12000--GOTO
SEC.CL IN PROCEDURE CONVMPC
     12186**DCL     12189<<ASSIGN
SEC.CU IN PROCEDURE CONVMPC
     12187**DCL     12190<<ASSIGN
SEC.HD IN PROCEDURE CONVMPC
     12188**DCL     12191<<ASSIGN
SECTOR IN PROCEDURE CONVMPC
     12183**DCL     12182--PROC    12184--REDEF
SORT_DTT
     12106**PROC    11525--CALL    11692--CALL    11973--CALL
STATUS
     10778**DCL     11799>>ASSIGN
STATUS.MSG
     10780**DCL     10779--DCLINIT
TR.CY.LWR
     11261**DCL     12189>>ASSIGN
TR.CY.UPR
     11260**DCL     12190>>ASSIGN
TR.CYL
     11258**DCL     11259--REDEF   11727>>IF      11743<<ASSIGN  11743>>ASSIGN  11744>>IF      11755>>IF
     11779<<ASSIGN
TR.HD
     11263**DCL     11727>>IF      11742<<ASSIGN  11742>>ASSIGN  11743>>IF      11744>>IF      11755>>IF
     11779<<ASSIGN  12191>>ASSIGN
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:217  
TR.X
     11262**DCL     11779<<ASSIGN
TRACK
     11256**DCL     11257--REDEF   11376<<ASSIGN  11377<<ASSIGN  11377>>ASSIGN  11377>>ASSIGN  11378>>IF
     11383>>ASSIGN  11395<<ASSIGN  11396<<ASSIGN  11396>>ASSIGN  11396>>ASSIGN  11397>>IF      11398>>ASSIGN
     11608<<ASSIGN  11610>>IF      11617>>ASSIGN  11660<<ASSIGN  11661<<ASSIGN  11661>>ASSIGN  11661>>ASSIGN
     11669>>ASSIGN  11671>>ASSIGN  11672>>IF      11726<<ASSIGN  11729>>IF      11731<<ASSIGN  11741<<ASSIGN
     11745>>IF      11754<<ASSIGN  11814<<ASSIGN  11815>>CALL    11816>>CALL    11957<<ASSIGN  11958>>CALL
     11959>>CALL
TRANGE
     11270**DCL     11735<<ASSIGN  11737>>ASSIGN
V IN PROCEDURE CONVERT
     12060**DCL     12059--PROC    12062<<ASSIGN  12066<<ASSIGN  12066>>ASSIGN
V1 IN PROCEDURE DECBIN
     12038**DCL     12031--PROC    12049<>CALL
V2 IN PROCEDURE DECBIN
     12039**DCL     12031--PROC    12050--IF      12051<<ASSIGN  12054<>CALL
VI$
     11271**DCL     10683--IMP-PTR 11303<<ASSIGN  11304>>IF      11306<<ASSIGN  11306>>ASSIGN  11307>>IF
     11308>>CALL    11311>>IF      11313<>CALL    11314>>ASSIGN  11315>>ASSIGN  11316>>ASSIGN  11317>>CALL
     11318>>ASSIGN  11319>>ASSIGN  11320>>ASSIGN  11321>>CALL    11322>>ASSIGN  11323>>ASSIGN  11324>>ASSIGN
     11324>>ASSIGN  11325>>ASSIGN  11326>>ASSIGN  11327>>ASSIGN  11328>>ASSIGN  11329>>ASSIGN  11330>>ASSIGN
     11331>>ASSIGN  11332>>DOSELCT 11336>>ASSIGN  11337>>ASSIGN  11339>>ASSIGN  11340>>ASSIGN  11346>>ASSIGN
     11348>>ASSIGN  11350>>ASSIGN  11352>>ASSIGN  11354>>ASSIGN  11356>>ASSIGN  11358>>ASSIGN  11360>>ASSIGN
     11362>>ASSIGN  11364>>ASSIGN  11366>>ASSIGN  11368>>ASSIGN  11370>>IF      11371>>CALL    11376>>ASSIGN
     11377>>ASSIGN  11377>>ASSIGN  11378>>IF      11380>>CALL    11383>>ASSIGN  11383>>ASSIGN  11386>>IF
     11386>>IF      11387>>ASSIGN  11387>>ASSIGN  11390>>ASSIGN  11390>>ASSIGN  11390>>ASSIGN  11390>>ASSIGN
     11395>>ASSIGN  11396>>ASSIGN  11396>>ASSIGN  11397>>IF      11398>>ASSIGN  11398>>ASSIGN  11401>>IF
     11401>>IF      11402>>ASSIGN  11402>>ASSIGN  11405>>IF      11405>>IF      11405>>IF      11405>>IF
     11406>>ASSIGN  11406>>ASSIGN  11409>>DOSELCT 11414>>IF      11414>>IF      11415>>CALL    11418>>IF
     11419>>CALL    11422>>IF      11423>>CALL    11426>>IF      11427>>CALL    11430>>IF      11431>>CALL
     11434>>IF      11435>>CALL    11438>>IF      11439>>CALL    11442>>IF      11443>>CALL    11448>>IF
     11449>>CALL    11452>>IF      11452>>IF      11453>>CALL    11456>>IF      11456>>IF      11457>>CALL
     11460>>IF      11460>>IF      11461>>CALL    11464>>IF      11465>>CALL    11469>>IF      11469>>IF
     11470>>CALL    11473>>IF      11473>>IF      11474>>CALL    11477>>IF      11477>>IF      11478>>CALL
     11481>>IF      11481>>IF      11487>>ASSIGN  11488>>IF      11489>>CALL    11499>>CALL    11500>>IF
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:218  
     11501>>CALL    11508>>ASSIGN  11510>>IF      11531>>IF      11545>>CALL    11550>>CALL    11559>>CALL
     11562>>ASSIGN  11566>>ASSIGN  11574>>ASSIGN  11576>>DOSELCT 11580>>ASSIGN  11582>>ASSIGN  11582>>ASSIGN
     11582>>ASSIGN  11582>>ASSIGN  11582>>ASSIGN  11587>>IF      11588>>IF      11590>>DOSELCT 11603>>DOCASE
     11619>>ASSIGN  11633>>ASSIGN  11641>>CALL    11652>>CALL    11655>>IF      11655>>IF      11656>>CALL
     11660>>ASSIGN  11661>>ASSIGN  11661>>ASSIGN  11662>>ASSIGN  11663>>ASSIGN  11663>>ASSIGN  11664>>IF
     11666>>CALL    11670>>IF      11671>>ASSIGN  11671>>ASSIGN  11679>>IF      11679>>IF      11681>>IF
     11682>>ASSIGN  11682>>ASSIGN  11684>>IF      11685>>ASSIGN  11685>>ASSIGN  11686>>ASSIGN  11686>>ASSIGN
     11689>>ASSIGN  11694>>CALL    11698>>IF      11699>>ASSIGN  11700>>IF      11700>>IF      11703>>ASSIGN
     11704>>ASSIGN  11706>>IF      11706>>IF      11709>>IF      11711>>ASSIGN  11712>>ASSIGN  11715>>ASSIGN
     11716>>ASSIGN  11720>>ASSIGN  11720>>ASSIGN  11720>>ASSIGN  11724>>DOINDEX 11726>>ASSIGN  11728>>DOINDEX
     11729>>IF      11731>>ASSIGN  11735>>ASSIGN  11736>>ASSIGN  11736>>ASSIGN  11737>>ASSIGN  11740>>DOINDEX
     11741>>ASSIGN  11742>>ASSIGN  11745>>IF      11746>>IF      11746>>IF      11746>>ASSIGN  11746>>ASSIGN
     11747>>DOINDEX 11748>>ASSIGN  11748>>ASSIGN  11750>>ASSIGN  11750>>ASSIGN  11754>>ASSIGN  11754>>ASSIGN
     11756>>CALL    11759>>CALL    11761>>ASSIGN  11761>>ASSIGN  11762>>ASSIGN  11763>>IF      11772>>ASSIGN
     11773>>DOSELCT 11775>>ASSIGN  11775>>ASSIGN  11776>>IF      11776>>IF      11777>>CALL    11778>>ASSIGN
     11785>>ASSIGN  11788>>CALL    11791>>ASSIGN  11791>>ASSIGN  11791>>ASSIGN  11791>>ASSIGN  11793>>CALL
     11796>>ASSIGN  11796>>ASSIGN  11796>>ASSIGN  11796>>ASSIGN  11796>>ASSIGN  11800<<ASSIGN  11801>>IF
     11803<<ASSIGN  11803>>ASSIGN  11804>>CALLBLT 11805>>CALL    11806>>DOSELCT 11809>>ASSIGN  11811>>ASSIGN
     11814>>ASSIGN  11814>>ASSIGN  11815>>CALL    11816>>CALL    11819>>IF      11828<<ASSIGN  11829>>IF
     11832<<ASSIGN  11832>>ASSIGN  11833>>IF      11834>>ASSIGN  11837>>IF      11861>>CALL    11864>>CALL
     11868>>CALL    11871>>IF      11872>>CALL    11873>>IF      11874>>CALL    11875>>IF      11876>>CALL
     11878>>CALL    11879<>CALL    11907<<ASSIGN  11908>>ASSIGN  11910>>CALL    11915>>CALL    11916>>ASSIGN
     11921>>CALL    11922>>ASSIGN  11928>>ASSIGN  11932>>ASSIGN  11933>>ASSIGN  11936<<ASSIGN  11937>>IF
     11939>>ASSIGN  11941<<ASSIGN  11941>>ASSIGN  11942>>IF      11944>>CALL    11945>>CALLBLT 11946>>IF
     11949>>DOSELCT 11952>>ASSIGN  11954>>ASSIGN  11957>>ASSIGN  11957>>ASSIGN  11958>>CALL    11959>>CALL
     11966>>IF      11970>>ASSIGN  11971>>IF      11976>>ASSIGN  11979>>ASSIGN  11979>>ASSIGN  11979>>ASSIGN
     11980>>ASSIGN  11980>>ASSIGN  11980>>ASSIGN  11986>>IF      11992>>CALL    12004>>CALL    12006>>IF
     12007>>CALL    12008>>IF      12009>>CALL    12010>>IF      12011>>CALL    12013>>CALL    12015<<ASSIGN
     12015>>IF      12015>>ASSIGN  12015>>ASSIGN  12017<>CALL    12018>>IF      12019<<ASSIGN  12024>>IF
     12095>>CALL    12095>>CALL    12095>>CALL    12096>>CALL    12096>>CALL    12096>>CALL    12100>>ASSIGN
     12119>>ASSIGN  12129>>ASSIGN
VID
     10677**DCL     11563<<ASSIGN
VID.DGT
     10679**DCL     11982<<ASSIGN  11984<<ASSIGN
VID.DGT.FGRAN
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:219  
     10679**DCL     11979<<ASSIGN
VID.DGT.LGRAN
     10679**DCL     11980<<ASSIGN
VID.DT
     10679**DCL     11569<<ASSIGN  12133<<ASSIGN
VID.DT.CYL
     10679**DCL     11979>>ASSIGN  11980>>ASSIGN  12093>>CALL    12095>>CALL    12096>>CALL
VID.DT.HD
     10680**DCL     11979>>ASSIGN  11980>>ASSIGN  12094>>CALL    12095>>CALL    12096>>CALL
VID.DTT
     10679**DCL     10679--REDEF   11523<>CALL    11533>>IF      11571<<ASSIGN  11572<>CALL    11610>>IF
     11617<<ASSIGN  11626<<ASSIGN  11669<<ASSIGN  11675<<ASSIGN  11680<<ASSIGN  11682>>ASSIGN  11685>>ASSIGN
     11978>>IF      12092>>IF      12109>>ASSIGN  12111>>IF      12113>>ASSIGN  12117<<ASSIGN  12117>>ASSIGN
     12118<<ASSIGN  12123>>IF      12123>>IF      12125<<ASSIGN  12125>>ASSIGN  12135<>CALL
VID.ID
     10677**DCL     11511>>IF      11513<<ASSIGN  11517<<ASSIGN  11564<<ASSIGN
VID.INSTID
     10677**DCL     11514<<ASSIGN  11518<<ASSIGN  11565<<ASSIGN
VID.MIRROR
     10678**DCL     11985<<ASSIGN
VID.PSN
     10677**DCL     11567<<ASSIGN
VID.SECTSTRT
     10678**DCL     11989<<ASSIGN
VID.SYSDIRDA
     10677**DCL     11976<<ASSIGN
VID.VOLCNT
     10677**DCL     11987<<ASSIGN
VID.VSN
     10677**DCL     11500>>IF      11501<>CALL    11508<<ASSIGN  11519<<ASSIGN  11566<<ASSIGN
VID$
     11272**DCL     10585--IMP-PTR 10677--IMP-PTR 11486<>CALL    11487>>ASSIGN  11500>>IF      11501>>CALL
     11508>>ASSIGN  11511>>IF      11512>>IF      11513>>ASSIGN  11514>>ASSIGN  11516>>IF      11517>>ASSIGN
     11518>>ASSIGN  11519>>ASSIGN  11519>>ASSIGN  11523>>CALL    11533>>IF      11563>>ASSIGN  11564>>ASSIGN
     11565>>ASSIGN  11566>>ASSIGN  11567>>ASSIGN  11569>>ASSIGN  11571>>ASSIGN  11572>>CALL    11610>>IF
     11617>>ASSIGN  11626>>ASSIGN  11669>>ASSIGN  11675>>ASSIGN  11680>>ASSIGN  11682>>ASSIGN  11685>>ASSIGN
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:220  
     11970<<ASSIGN  11976>>ASSIGN  11978>>IF      11979>>ASSIGN  11979>>ASSIGN  11979>>ASSIGN  11980>>ASSIGN
     11980>>ASSIGN  11980>>ASSIGN  11982>>ASSIGN  11984>>ASSIGN  11985>>ASSIGN  11987>>ASSIGN  11989>>ASSIGN
     12092>>IF      12093>>CALL    12094>>CALL    12095>>CALL    12095>>CALL    12096>>CALL    12096>>CALL
     12109>>ASSIGN  12111>>IF      12113>>ASSIGN  12117>>ASSIGN  12117>>ASSIGN  12118>>ASSIGN  12123>>IF
     12123>>IF      12125>>ASSIGN  12125>>ASSIGN  12133>>ASSIGN  12135>>CALL
VIP
     10683**DCL     11313--CALL    11314<<ASSIGN  11321<>CALL    11489<>CALL    11499<>CALL    11582--ASSIGN
     11582--ASSIGN  11582--ASSIGN  11759<>CALL    11777<>CALL    11788<>CALL    11793<>CALL    11796--ASSIGN
     11796--ASSIGN  11796--ASSIGN  11878<>CALL    11910<>CALL    11992<>CALL    12013<>CALL
VIP.ALT
     10716**DCL     11330<<ASSIGN  11364<<ASSIGN  11366<<ASSIGN  11442>>IF      11452>>IF      11456>>IF
     11460>>IF      11469>>IF      11473>>IF      11477>>IF      11588>>IF      11700>>IF      11709>>IF
VIP.CTR.CYL
     10701**DCL     11776>>IF      11809>>ASSIGN  11952>>ASSIGN
VIP.CTR.HD
     10702**DCL     11776>>IF      11811>>ASSIGN  11954>>ASSIGN
VIP.CTRACK
     10699**DCL     10700--REDEF   11775<<ASSIGN
VIP.DEVID
     10689**DCL     11307>>IF      11308<>CALL    11316<<ASSIGN  11371<>CALL    11380<>CALL    11415<>CALL
     11419<>CALL    11423<>CALL    11427<>CALL    11431<>CALL    11435<>CALL    11439<>CALL    11443<>CALL
     11449<>CALL    11453<>CALL    11457<>CALL    11461<>CALL    11465<>CALL    11470<>CALL    11474<>CALL
     11478<>CALL    11501<>CALL    11545<>CALL    11550<>CALL    11559<>CALL    11641<>CALL    11652<>CALL
     11656<>CALL    11666<>CALL    11694<>CALL    11756<>CALL    11804>>CALLBLT 11833>>IF      11861<>CALL
     11864<>CALL    11868<>CALL    11915<>CALL    11921<>CALL    11945>>CALLBLT 12004<>CALL
VIP.DONE
     10710**DCL     11580<<ASSIGN  11933<<ASSIGN  11942>>IF
VIP.DTT
     10705**DCL     11336<<ASSIGN  11339<<ASSIGN  11346<<ASSIGN  11414>>IF      11414>>IF      11510>>IF
     11531>>IF      11562<<ASSIGN  11587>>IF      11603>>DOCASE
VIP.DTTCH
     10712**DCL     11574<<ASSIGN  11619<<ASSIGN  11633<<ASSIGN  11689<<ASSIGN  11971>>IF      12100<<ASSIGN
     12119<<ASSIGN  12129<<ASSIGN
VIP.DTTOVF
     10713**DCL     11966>>IF
VIP.DVT$
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:221  
     10686**DCL     11322<<ASSIGN  11976>>ASSIGN
VIP.ELT$
     10687**DCL     11320<<ASSIGN  11778<<ASSIGN  11873>>IF      11874<>CALL    12008>>IF      12009<>CALL
VIP.FL$
     10684**DCL     11306>>ASSIGN  11315<<ASSIGN  11582<<ASSIGN  11582<<ASSIGN  11796<<ASSIGN  11796<<ASSIGN
     11803>>ASSIGN  11832>>ASSIGN  11941>>ASSIGN
VIP.FMT$
     10693**DCL     11319<<ASSIGN  11762<<ASSIGN  11814>>ASSIGN  11871>>IF      11872<>CALL    11957>>ASSIGN
     12010>>IF      12011<>CALL
VIP.FORMAT
     10706**DCL     11328<<ASSIGN  11348<<ASSIGN  11350<<ASSIGN  11418>>IF      11448>>IF      11452>>IF
     11469>>IF      11481>>IF
VIP.GRANSIZE
     10719**DCL     11327<<ASSIGN  11979>>ASSIGN  11980>>ASSIGN  12095>>CALL    12096>>CALL
VIP.IO$
     10685**DCL     11908>>ASSIGN
VIP.LOGX
     10688**DCL     11785<<ASSIGN
VIP.MODEL
     10690**DCL     11332>>DOSELCT 11409>>DOSELCT 11488>>IF      11576>>DOSELCT 11590>>DOSELCT 11700>>IF
     11706>>IF      11706>>IF      11773>>DOSELCT 11806>>DOSELCT 11949>>DOSELCT
VIP.NCYLS
     10696**DCL     11325<<ASSIGN  11664>>IF      11679>>IF
VIP.NEWDTS
     10709**DCL     11368<<ASSIGN  11434>>IF      11456>>IF      11473>>IF      11655>>IF      11670>>IF
     11681>>IF      11684>>IF
VIP.NHEADS
     10695**DCL     11324<<ASSIGN  11377>>ASSIGN  11377>>ASSIGN  11386>>IF      11390>>ASSIGN  11396>>ASSIGN
     11396>>ASSIGN  11401>>IF      11661>>ASSIGN  11661>>ASSIGN  11663>>ASSIGN  11663>>ASSIGN  11679>>IF
     11720>>ASSIGN  11742>>ASSIGN  11791>>ASSIGN  11815>>CALL    11816>>CALL    11958>>CALL    11959>>CALL
     11979>>ASSIGN  11980>>ASSIGN  12095>>CALL    12096>>CALL
VIP.NRANGES
     10718**DCL     11370>>IF      11383>>ASSIGN  11387>>ASSIGN  11390>>ASSIGN  11398>>ASSIGN  11402>>ASSIGN
     11405>>IF      11405>>IF      11406<<ASSIGN  11406>>ASSIGN  11438>>IF      11460>>IF      11477>>IF
     11655>>IF      11671>>ASSIGN  11682>>ASSIGN  11685>>ASSIGN  11686<<ASSIGN  11686>>ASSIGN  11698>>IF
     11699<<ASSIGN  11724>>DOINDEX 11728>>DOINDEX 11740>>DOINDEX 11747>>DOINDEX 11750<<ASSIGN  11750>>ASSIGN
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:222  
     11754>>ASSIGN
VIP.NSECTS
     10694**DCL     11323<<ASSIGN  11324>>ASSIGN  11376>>ASSIGN  11395>>ASSIGN  11660>>ASSIGN  11662>>ASSIGN
     11761>>ASSIGN  11791>>ASSIGN  11814>>ASSIGN  11957>>ASSIGN  11979>>ASSIGN  11980>>ASSIGN  12095>>CALL
     12096>>CALL
VIP.RANGE
     10736**DCL     11735>>ASSIGN  11736<<ASSIGN  11736>>ASSIGN  11737<<ASSIGN  11748<<ASSIGN  11748>>ASSIGN
VIP.RANGE.FT.CYL
     10739**DCL     11791>>ASSIGN
VIP.RANGE.FT.HD
     10740**DCL     11791>>ASSIGN
VIP.RANGE.FTRACK
     10737**DCL     10738--REDEF   11383<<ASSIGN  11387<<ASSIGN  11405>>IF      11671<<ASSIGN  11682<<ASSIGN
     11726>>ASSIGN  11729>>IF      11731>>ASSIGN  11745>>IF      11775>>ASSIGN
VIP.RANGE.LT.CYL
     10743**DCL     11703<<ASSIGN  11711<<ASSIGN  11715<<ASSIGN
VIP.RANGE.LT.HD
     10744**DCL     11704<<ASSIGN  11712<<ASSIGN  11716<<ASSIGN
VIP.RANGE.LTRACK
     10741**DCL     10742--REDEF   11390<<ASSIGN  11398<<ASSIGN  11402<<ASSIGN  11405>>IF      11685<<ASSIGN
     11720<<ASSIGN  11741>>ASSIGN  11746>>IF      11746>>IF      11746<<ASSIGN  11746>>ASSIGN  11754>>ASSIGN
VIP.SCRATCH
     10715**DCL     11331<<ASSIGN  11360<<ASSIGN  11362<<ASSIGN  11430>>IF      11986>>IF
VIP.STEP
     10717**DCL     11772<<ASSIGN
VIP.STOP
     10711**DCL     11834<<ASSIGN  11932<<ASSIGN  11946>>IF
VIP.T@DCYL
     10697**DCL     11326<<ASSIGN  11378>>IF      11386>>IF      11390>>ASSIGN  11397>>IF      11401>>IF
     11720>>ASSIGN
VIP.TEST
     10708**DCL     11337<<ASSIGN  11340<<ASSIGN  11356<<ASSIGN  11358<<ASSIGN  11426>>IF      11464>>IF
     11481>>IF      11761>>ASSIGN  11763>>IF
VIP.VERIFY
     10707**DCL     11329<<ASSIGN  11352<<ASSIGN  11354<<ASSIGN  11422>>IF
VIP.VID$
PL6.E3A0      #001=IVV$VOLINIT File=IVV$VOLINIT.:E05TSI                          TUE 07/29/97 23:14 Page:223  
     10692**DCL     11318<<ASSIGN  11487<<ASSIGN  11875>>IF      11876<>CALL    11970>>ASSIGN  12006>>IF
     12007<>CALL
VIP.VSN
     10691**DCL     11317<>CALL    11500>>IF      11508>>ASSIGN  11566>>ASSIGN  11805<>CALL    11944<>CALL
VIP$
     11273**DCL     11284<<ASSIGN  11303>>ASSIGN  11311>>IF      11582>>IF      11582>>ASSIGN  11582>>ASSIGN
     11582<<ASSIGN  11796>>IF      11796>>ASSIGN  11796>>ASSIGN  11796<<ASSIGN  11800>>ASSIGN  11819>>IF
     11828>>ASSIGN  11837>>IF      11844>>IF      11887>>IF      11936>>ASSIGN  12018>>IF      12022<<ASSIGN
     12024>>IF
WAITDONE
     11843**LABEL   11846--GOTO
WAIT_NEXT_CMD
     11886**LABEL   11292--CALLALT 11295--CALLALT 11309--GOTO    11584--GOTO    11890--GOTO
X$PARSE
     10461**DCL-ENT 11296--CALL    11645--CALL

PL6.E3A0      #002=DCWBUILD File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:18 Page:224  
     1097        1        /*T***********************************************************/
     1098        2        /*T*                                                         */
     1099        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1100        4        /*T*                                                         */
     1101        5        /*T***********************************************************/
     1102        6        %EJECT;
PL6.E3A0      #002=DCWBUILD File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:18 Page:225  
     1103        7        DCWBUILD: PROC (DCW,FWA,TALLY);
     1104        8    1   DCL 1 DCW(0:0) ALIGNED,
     1105        9    1         2 FWA UBIN(18) UNAL,
     1106       10    1         2 * BIT(6) UNAL,
     1107       11    1         2 TALLY UBIN(12) UNAL;
     1108       12    1   DCL FWA SBIN;
     1109       13    1   DCL TALLY SBIN;
     1110       14    1   DCL I SBIN;
     1111       15        /**/
     1112       16    1           I=0;
     1113       17    2           DO WHILE(TALLY-I>4096);
     1114       18    2              DCW(I/4096)='000000010000'O;
     1115       19    2              DCW.FWA(I/4096)=FWA+I;
     1116       20    2              I=I+4096;
     1117       21    2              END;
     1118       22    1           DCW(I/4096)='0'B;
     1119       23    1           DCW.FWA(I/4096)=FWA+I;
     1120       24    1           DCW.TALLY(I/4096)=TALLY;
     1121       25    1           RETURN;
     1122       26    1   END DCWBUILD;
     1123       27        %EOD;

PL6.E3A0      #002=DCWBUILD File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:18 Page:226  
      No diagnostics issued in procedure DCWBUILD.

   Procedure DCWBUILD requires 48 words for executable code.
   Procedure DCWBUILD requires 10 words of local(AUTO) storage.

PL6.E3A0      #002=DCWBUILD File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:18 Page:227  

 Object Unit name= DCWBUILD                                   File name= IVV$VOLINIT.:E05TOU
 UTS= JUL 29 '97 23:18:51.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  DCWBUILD
    1   Proc  even  none    48     60  DCWBUILD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        3  DCWBUILD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
PL6.E3A0      #002=DCWBUILD File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:18 Page:228  


     1097        1        /*T***********************************************************/
     1098        2        /*T*                                                         */
     1099        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1100        4        /*T*                                                         */
     1101        5        /*T***********************************************************/
     1102        6        %EJECT;
PL6.E3A0      #002=DCWBUILD File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:18 Page:229  
     1103        7        DCWBUILD: PROC (DCW,FWA,TALLY);

      7  1 000000   000000 700200 xent  DCWBUILD     TSX0  ! X66_AUTO_3
         1 000001   000012 000003                    ZERO    10,3

     1104        8    1   DCL 1 DCW(0:0) ALIGNED,
     1105        9    1         2 FWA UBIN(18) UNAL,
     1106       10    1         2 * BIT(6) UNAL,
     1107       11    1         2 TALLY UBIN(12) UNAL;
     1108       12    1   DCL FWA SBIN;
     1109       13    1   DCL TALLY SBIN;
     1110       14    1   DCL I SBIN;
     1111       15        /**/
     1112       16    1           I=0;

     16  1 000002   200006 450100                    STZ     I,,AUTO

     1113       17    2           DO WHILE(TALLY-I>4096);

     17  1 000003   000026 710000 1                  TRA     s:21

     1114       18    2              DCW(I/4096)='000000010000'O;

     18  1 000004   200006 236100                    LDQ     I,,AUTO
         1 000005   010000 506007                    DIV     4096,DL
         1 000006   200010 756100                    STQ     I+2,,AUTO
         1 000007   000000 236000 0                  LDQ     0
         1 000010   200003 470500                    LDP0    @DCW,,AUTO
         1 000011   200010 720100                    LXL0    I+2,,AUTO
         1 000012   000000 756110                    STQ     0,X0,PR0

     1115       19    2              DCW.FWA(I/4096)=FWA+I;

     19  1 000013   200006 236100                    LDQ     I,,AUTO
         1 000014   010000 506007                    DIV     4096,DL
         1 000015   200004 471500                    LDP1    @FWA,,AUTO
         1 000016   200010 756100                    STQ     I+2,,AUTO
PL6.E3A0      #002=DCWBUILD File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:18 Page:230  
         1 000017   100000 236100                    LDQ     0,,PR1
         1 000020   200006 036100                    ADLQ    I,,AUTO
         1 000021   000000 620006                    EAX0    0,QL
         1 000022   200010 721100                    LXL1    I+2,,AUTO
         1 000023   000000 740111                    STX0    0,X1,PR0

     1116       20    2              I=I+4096;

     20  1 000024   010000 236007                    LDQ     4096,DL
         1 000025   200006 056100                    ASQ     I,,AUTO

     1117       21    2              END;

     21  1 000026   200005 470500                    LDP0    @TALLY,,AUTO
         1 000027   000000 236100                    LDQ     0,,PR0
         1 000030   200006 136100                    SBLQ    I,,AUTO
         1 000031   010000 116007                    CMPQ    4096,DL
         1 000032   000004 605400 1                  TPNZ    s:18

     1118       22    1           DCW(I/4096)='0'B;

     22  1 000033   200006 236100                    LDQ     I,,AUTO
         1 000034   010000 506007                    DIV     4096,DL
         1 000035   200003 471500                    LDP1    @DCW,,AUTO
         1 000036   100000 450106                    STZ     0,QL,PR1

     1119       23    1           DCW.FWA(I/4096)=FWA+I;

     23  1 000037   200006 236100                    LDQ     I,,AUTO
         1 000040   010000 506007                    DIV     4096,DL
         1 000041   200004 473500                    LDP3    @FWA,,AUTO
         1 000042   200010 756100                    STQ     I+2,,AUTO
         1 000043   300000 236100                    LDQ     0,,PR3
         1 000044   200006 036100                    ADLQ    I,,AUTO
         1 000045   000000 620006                    EAX0    0,QL
         1 000046   200010 721100                    LXL1    I+2,,AUTO
         1 000047   100000 740111                    STX0    0,X1,PR1
PL6.E3A0      #002=DCWBUILD File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:18 Page:231  

     1120       24    1           DCW.TALLY(I/4096)=TALLY;

     24  1 000050   200006 236100                    LDQ     I,,AUTO
         1 000051   010000 506007                    DIV     4096,DL
         1 000052   000000 620006                    EAX0    0,QL
         1 000053   000000 236100                    LDQ     0,,PR0
         1 000054   100000 676110                    ERQ     0,X0,PR1
         1 000055   007777 376007                    ANQ     4095,DL
         1 000056   100000 656110                    ERSQ    0,X0,PR1

     1121       25    1           RETURN;

     25  1 000057   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   0     000   000000 010000                                                    ....
     1122       26    1   END DCWBUILD;
     1123       27        %EOD;

PL6.E3A0      #002=DCWBUILD File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:18 Page:232  
      No diagnostics issued in procedure DCWBUILD.
PL6.E3A0      #002=DCWBUILD File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:18 Page:233  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DCW                       4-0-0/w PTR         r     1 @FWA
     5-0-0/w PTR         r     1 @TALLY                    *0-0-0/w STRC        r     1 DCW(0:0)
    *0-0-0/w SBIN        r     1 FWA                        6-0-0/w SBIN        r     1 I
    *0-0-0/w SBIN        r     1 TALLY


   Procedure DCWBUILD requires 48 words for executable code.
   Procedure DCWBUILD requires 10 words of local(AUTO) storage.
PL6.E3A0      #002=DCWBUILD File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:18 Page:234  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DCWBUILD File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:18 Page:235  
          MINI XREF LISTING

DCW
         8**DCL         7--PROC       18<<ASSIGN     22<<ASSIGN
DCW.FWA
         9**DCL        19<<ASSIGN     23<<ASSIGN
DCW.TALLY
        11**DCL        24<<ASSIGN
FWA
        12**DCL         7--PROC       19>>ASSIGN     23>>ASSIGN
I
        14**DCL        16<<ASSIGN     17>>DOWHILE    18>>ASSIGN     19>>ASSIGN     19>>ASSIGN     20<<ASSIGN
        20>>ASSIGN     22>>ASSIGN     23>>ASSIGN     23>>ASSIGN     24>>ASSIGN
TALLY
        13**DCL         7--PROC       17>>DOWHILE    24>>ASSIGN

PL6.E3A0      #003=IVV$BINDEC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:18 Page:236  
     1124        1        /*T***********************************************************/
     1125        2        /*T*                                                         */
     1126        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1127        4        /*T*                                                         */
     1128        5        /*T***********************************************************/
     1129        6        /* CONVERT BINARY NUMBER TO DECIMAL STRING */
     1130        7        /**/
     1131        8        IVV$BINDEC: PROC (NN,STR,FC,NC);
     1132        9        /**/
     1133       10        /* PARAMETERS */
     1134       11        /**/
     1135       12    1   DCL NN SBIN;                            /* NUMBER TO CONVERT */
     1136       13    1   DCL STR CHAR(99);                       /* OUTPUT STRING */
     1137       14    1   DCL FC SBIN;                            /* FIRST CHARACTER OF DECIMAL STRING */
     1138       15    1   DCL NC SBIN;                            /* NUMBER OF CHARACTERS TO CONVERT */
     1139       16        /**/
     1140       17        /* AUTO STACK */
     1141       18        /**/
     1142       19    1   DCL I SBIN;
     1143       20    1   DCL N SBIN;
     1144       21        /**/
     1145       22    1           N=NN;
     1146       23    1           I=FC+NC-1;
     1147       24    2           DO WHILE (I>=FC);
     1148       25    2              CALL INSERT(STR,I,1,BINASC(ASCBIN('0')+MOD(N,10)));
     1149       26    2              N=N/10;
     1150       27    2              I=I-1;
     1151       28    2              END;
     1152       29    1           RETURN;
     1153       30    1   END IVV$BINDEC;
     1154       31        %EOD;

PL6.E3A0      #003=IVV$BINDEC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:18 Page:237  
      No diagnostics issued in procedure IVV$BINDEC.

   Procedure IVV$BINDEC requires 35 words for executable code.
   Procedure IVV$BINDEC requires 12 words of local(AUTO) storage.

PL6.E3A0      #003=IVV$BINDEC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:18 Page:238  

 Object Unit name= IVV$BINDEC                                 File name= IVV$VOLINIT.:E05TOU
 UTS= JUL 29 '97 23:18:58.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    35     43  IVV$BINDEC
    1  RoData even  none     1      1  IVV$BINDEC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        4  IVV$BINDEC

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET
PL6.E3A0      #003=IVV$BINDEC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:18 Page:239  


     1124        1        /*T***********************************************************/
     1125        2        /*T*                                                         */
     1126        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1127        4        /*T*                                                         */
     1128        5        /*T***********************************************************/
     1129        6        /* CONVERT BINARY NUMBER TO DECIMAL STRING */
     1130        7        /**/
     1131        8        IVV$BINDEC: PROC (NN,STR,FC,NC);

      8  0 000000   000000 700200 xent  IVV$BINDEC   TSX0  ! X66_AUTO_4
         0 000001   000014 000004                    ZERO    12,4

     1132        9        /**/
     1133       10        /* PARAMETERS */
     1134       11        /**/
     1135       12    1   DCL NN SBIN;                            /* NUMBER TO CONVERT */
     1136       13    1   DCL STR CHAR(99);                       /* OUTPUT STRING */
     1137       14    1   DCL FC SBIN;                            /* FIRST CHARACTER OF DECIMAL STRING */
     1138       15    1   DCL NC SBIN;                            /* NUMBER OF CHARACTERS TO CONVERT */
     1139       16        /**/
     1140       17        /* AUTO STACK */
     1141       18        /**/
     1142       19    1   DCL I SBIN;
     1143       20    1   DCL N SBIN;
     1144       21        /**/
     1145       22    1           N=NN;

     22  0 000002   200003 470500                    LDP0    @NN,,AUTO
         0 000003   000000 235100                    LDA     0,,PR0
         0 000004   200010 755100                    STA     N,,AUTO

     1146       23    1           I=FC+NC-1;

     23  0 000005   200005 471500                    LDP1    @FC,,AUTO
         0 000006   200006 473500                    LDP3    @NC,,AUTO
         0 000007   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #003=IVV$BINDEC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:18 Page:240  
         0 000010   300000 036100                    ADLQ    0,,PR3
         0 000011   000001 136007                    SBLQ    1,DL
         0 000012   200007 756100                    STQ     I,,AUTO

     1147       24    2           DO WHILE (I>=FC);

     24  0 000013   100000 116100                    CMPQ    0,,PR1
         0 000014   000042 604000 0                  TMI     s:29

     1148       25    2              CALL INSERT(STR,I,1,BINASC(ASCBIN('0')+MOD(N,10)));

     25  0 000015   200010 236100                    LDQ     N,,AUTO
         0 000016   000012 506007                    DIV     10,DL
         0 000017   000044 733000                    LRS     36
         0 000020   000060 036007                    ADLQ    48,DL
         0 000021   000033 736000                    QLS     27
         0 000022   000000 276000 1                  ORQ     0
         0 000023   200012 756100                    STQ     N+2,,AUTO
         0 000024   200004 470500                    LDP0    @STR,,AUTO
         0 000025   200007 235100                    LDA     I,,AUTO
         0 000026   040105 100500                    MLR     fill='040'O
         0 000027   200012 000004                    ADSC9   N+2,,AUTO                cn=0,n=4
         0 000030   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

     1149       26    2              N=N/10;

     26  0 000031   200010 236100                    LDQ     N,,AUTO
         0 000032   000012 506007                    DIV     10,DL
         0 000033   200010 756100                    STQ     N,,AUTO

     1150       27    2              I=I-1;

     27  0 000034   000001 336007                    LCQ     1,DL
         0 000035   200007 056100                    ASQ     I,,AUTO

     1151       28    2              END;

PL6.E3A0      #003=IVV$BINDEC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:18 Page:241  
     28  0 000036   200005 471500                    LDP1    @FC,,AUTO
         0 000037   200007 236100                    LDQ     I,,AUTO
         0 000040   100000 116100                    CMPQ    0,,PR1
         0 000041   000015 605000 0                  TPL     s:25

     1152       29    1           RETURN;

     29  0 000042   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   000040 040040                                                    .
     1153       30    1   END IVV$BINDEC;
     1154       31        %EOD;

PL6.E3A0      #003=IVV$BINDEC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:18 Page:242  
      No diagnostics issued in procedure IVV$BINDEC.
PL6.E3A0      #003=IVV$BINDEC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:18 Page:243  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @FC                        6-0-0/w PTR         r     1 @NC
     3-0-0/w PTR         r     1 @NN                        4-0-0/w PTR         r     1 @STR
    *0-0-0/w SBIN        r     1 FC                         7-0-0/w SBIN        r     1 I
    10-0-0/w SBIN        r     1 N                         *0-0-0/w SBIN        r     1 NC
    *0-0-0/w SBIN        r     1 NN                        *0-0-0/c CHAR(99)    r     1 STR


   Procedure IVV$BINDEC requires 35 words for executable code.
   Procedure IVV$BINDEC requires 12 words of local(AUTO) storage.
PL6.E3A0      #003=IVV$BINDEC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:18 Page:244  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=IVV$BINDEC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:18 Page:245  
          MINI XREF LISTING

FC
        14**DCL         8--PROC       23>>ASSIGN     24>>DOWHILE
I
        19**DCL        23<<ASSIGN     24>>DOWHILE    25>>CALLBLT    27<<ASSIGN     27>>ASSIGN
N
        20**DCL        22<<ASSIGN     25>>CALLBLT    26<<ASSIGN     26>>ASSIGN
NC
        15**DCL         8--PROC       23>>ASSIGN
NN
        12**DCL         8--PROC       22>>ASSIGN
STR
        13**DCL         8--PROC       25<<CALLBLT

PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:246  
     1155        1        /*T***********************************************************/
     1156        2        /*T*                                                         */
     1157        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1158        4        /*T*                                                         */
     1159        5        /*T***********************************************************/
     1160        6        /* PRINT ERROR MESSAGE */
     1161        7        /**/
     1162        8        IVV$ERROR: PROC (DEVID,ERRNO,VSN);
     1163        9        /**/
     1164       10        /* INCLUDE FILES */
     1165       11        /**/
     1166       12        %INCLUDE IV$MACROS;
     1167      182        /**/
     1168      183        /* PARAMETERS */
     1169      184        /**/
     1170      185    1   DCL DEVID CHAR(4);
     1171      186    1   DCL ERRNO SBIN;
     1172      187    1   DCL VSN SBIN;
     1173      188        /**/
     1174      189        /* SUBSTITUTIONS */
     1175      190        /**/
     1176      191        %SUB NULL="ADDR(NIL)";
     1177      192        /**/
     1178      193        /* EXTERNAL REFERENCES */
     1179      194        /**/
     1180      195    1   DCL IVO$PRINT ENTRY (2) ALTRET;
     1181      196    1   DCL IVV$BINDEC ENTRY (4);
     1182      197        /**/
     1183      198        /* CONSTANT DATA */
     1184      199        /**/
     1185      200    1   DCL 1 ERR(0:39) CONSTANT ALIGNED,
     1186      201    1         2 LEN SBIN INIT(16,19,20,27,45,21,31,19,22,26,20,18,24,10,30,25,
     1187      202    1                       42,49,47,56,52,45,45,43,52,45,58,52,62,50,51,28,60,61,63,45,49,
               202                                40,40,47),
     1188      203    1         2 MSG CHAR(80) INIT(
     1189      204    1           'AIllegal command',
     1190      205    1           'ADPnn command error',
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:247  
     1191      206    1           'ADPnn not in VOLINIT',
     1192      207    1           'ADPnn invalid track address',
     1193      208    1           'ADPnn not there, not disk, or not partitioned',
     1194      209    1           'ADPnn too many ranges',
     1195      210    1           'ADPnn too many defective tracks',
     1196      211    1           'ADPnn missing DTEND',
     1197      212    1           'ADPnn xxxxxx wrong VSN',
     1198      213    1           'ADPnn data space exhausted',
     1199      214    1           'ADPnn disk i/o error',
     1200      215    1           'ACommand i/o error',
     1201      216    1           'ADPnn old VID unreadable',
     1202      217    1           'ADPnn busy',
     1203      218    1           'APlease specify format or test',
     1204      219    1           'ADPnn ELT not recoverable',
     1205      220    1           'ADPnn need MTAR to work on ELT (840.20-39)',
     1206      221    1           'AThat command only allowed during offline VOLINIT',
     1207      222    1           'ADPnn operator won''t let you VOLINIT that drive',
     1208      223    1           'ADPnn break hit while opening drive, VOLINIT not started',
     1209      224    1           'ADPnn DTT=NEW must be specified for this device type',
     1210      225    1           'ADPnn FORMAT not allowed for this device type',
     1211      226    1           'ADPnn VERIFY not allowed for this device type',
     1212      227    1           'ADPnn TEST not allowed for this device type',
     1213      228    1           'ADPnn SCRATCH must be specified for this device type',
     1214      229    1           'ADPnn NEWDTS not allowed for this device type',
     1215      230    1           'ADPnn Range specification not allowed for this device type',
     1216      231    1           'ANo more DCB slots available - I/O operation aborted',
     1217      232    1           'AInsufficient privilege to run VOLINIT - I/O operation aborted',
     1218      233    1           'ADPnn MDS disk not formatted with 512 words/sector',
     1219      234    1           'ADPnn FIPS disk not formatted with 512 words/sector',
     1220      235    1           'ADPnn not a 501N device type',
     1221      236    1           'AUnable to get an I/O request packet - I/O operation aborted',
     1222      237    1           'ADPnn An error occurred when attempting to verify disk format',
     1223      238    1           'ADPnn Device not configured or off-line - I/O operation aborted',
     1224      239    1           'ADPnn NOTEST not allowed for this device type',
     1225      240    1           'ADPnn ALT option not allowed for this device type',
     1226      241    1           'ADPnn FORMAT not allowed with ALT option',
     1227      242    1           'ADPnn NEWDTS not allowed with ALT option',
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:248  
     1228      243    1           'ADPnn Range cannot be specified with ALT option');
     1229      244        /**/
     1230      245        /* AUTO STACK */
     1231      246        /**/
     1232      247    1   DCL 1 OUT ALIGNED,
     1233      248    1         2 LEN SBIN,
     1234      249    1         2 MSG CHAR(80);
     1235      250        /**/
     1236      251        /* FORMAT ERROR MESSAGE AND PRINT IT */
     1237      252        /**/
     1238      253    1           OUT=ERR(ERRNO);
     1239      254    1           IF ADDR(DEVID)~=NULL THEN
     1240      255    1              CALL INSERT(OUT.MSG,1,4,DEVID);
     1241      256    1           IF ADDR(VSN)~=NULL THEN
     1242      257    1              CALL IVV$BINDEC(VSN,OUT.MSG,6,6);
     1243      258    1           CALL IVO$PRINT(OUT,'1'B);
     1244      259    1           RETURN;
     1245      260    1   END IVV$ERROR;
     1246      261        %EOD;

PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:249  
--  Include file information  --

   IV$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure IVV$ERROR.

   Procedure IVV$ERROR requires 38 words for executable code.
   Procedure IVV$ERROR requires 32 words of local(AUTO) storage.

PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:250  

 Object Unit name= IVV$ERROR                                  File name= IVV$VOLINIT.:E05TOU
 UTS= JUL 29 '97 23:19:04.32 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS    840   1510  IVV$ERROR
    1   Proc  even  none    38     46  IVV$ERROR
    2  RoData even  none     3      3  IVV$ERROR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        3  IVV$ERROR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 IVV$BINDEC
 yes     yes           Std       2 IVO$PRINT
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:251  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:252  


     1155        1        /*T***********************************************************/
     1156        2        /*T*                                                         */
     1157        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1158        4        /*T*                                                         */
     1159        5        /*T***********************************************************/
     1160        6        /* PRINT ERROR MESSAGE */
     1161        7        /**/
     1162        8        IVV$ERROR: PROC (DEVID,ERRNO,VSN);

      8  1 000000   000000 700200 xent  IVV$ERROR    TSX0  ! X66_AUTO_3
         1 000001   000040 000003                    ZERO    32,3

     1163        9        /**/
     1164       10        /* INCLUDE FILES */
     1165       11        /**/
     1166       12        %INCLUDE IV$MACROS;
     1167      182        /**/
     1168      183        /* PARAMETERS */
     1169      184        /**/
     1170      185    1   DCL DEVID CHAR(4);
     1171      186    1   DCL ERRNO SBIN;
     1172      187    1   DCL VSN SBIN;
     1173      188        /**/
     1174      189        /* SUBSTITUTIONS */
     1175      190        /**/
     1176      191        %SUB NULL="ADDR(NIL)";
     1177      192        /**/
     1178      193        /* EXTERNAL REFERENCES */
     1179      194        /**/
     1180      195    1   DCL IVO$PRINT ENTRY (2) ALTRET;
     1181      196    1   DCL IVV$BINDEC ENTRY (4);
     1182      197        /**/
     1183      198        /* CONSTANT DATA */
     1184      199        /**/
     1185      200    1   DCL 1 ERR(0:39) CONSTANT ALIGNED,
     1186      201    1         2 LEN SBIN INIT(16,19,20,27,45,21,31,19,22,26,20,18,24,10,30,25,
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:253  
     1187      202    1                       42,49,47,56,52,45,45,43,52,45,58,52,62,50,51,28,60,61,63,45,49,
               202                                40,40,47),
     1188      203    1         2 MSG CHAR(80) INIT(
     1189      204    1           'AIllegal command',
     1190      205    1           'ADPnn command error',
     1191      206    1           'ADPnn not in VOLINIT',
     1192      207    1           'ADPnn invalid track address',
     1193      208    1           'ADPnn not there, not disk, or not partitioned',
     1194      209    1           'ADPnn too many ranges',
     1195      210    1           'ADPnn too many defective tracks',
     1196      211    1           'ADPnn missing DTEND',
     1197      212    1           'ADPnn xxxxxx wrong VSN',
     1198      213    1           'ADPnn data space exhausted',
     1199      214    1           'ADPnn disk i/o error',
     1200      215    1           'ACommand i/o error',
     1201      216    1           'ADPnn old VID unreadable',
     1202      217    1           'ADPnn busy',
     1203      218    1           'APlease specify format or test',
     1204      219    1           'ADPnn ELT not recoverable',
     1205      220    1           'ADPnn need MTAR to work on ELT (840.20-39)',
     1206      221    1           'AThat command only allowed during offline VOLINIT',
     1207      222    1           'ADPnn operator won''t let you VOLINIT that drive',
     1208      223    1           'ADPnn break hit while opening drive, VOLINIT not started',
     1209      224    1           'ADPnn DTT=NEW must be specified for this device type',
     1210      225    1           'ADPnn FORMAT not allowed for this device type',
     1211      226    1           'ADPnn VERIFY not allowed for this device type',
     1212      227    1           'ADPnn TEST not allowed for this device type',
     1213      228    1           'ADPnn SCRATCH must be specified for this device type',
     1214      229    1           'ADPnn NEWDTS not allowed for this device type',
     1215      230    1           'ADPnn Range specification not allowed for this device type',
     1216      231    1           'ANo more DCB slots available - I/O operation aborted',
     1217      232    1           'AInsufficient privilege to run VOLINIT - I/O operation aborted',
     1218      233    1           'ADPnn MDS disk not formatted with 512 words/sector',
     1219      234    1           'ADPnn FIPS disk not formatted with 512 words/sector',
     1220      235    1           'ADPnn not a 501N device type',
     1221      236    1           'AUnable to get an I/O request packet - I/O operation aborted',
     1222      237    1           'ADPnn An error occurred when attempting to verify disk format',
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:254  
     1223      238    1           'ADPnn Device not configured or off-line - I/O operation aborted',
     1224      239    1           'ADPnn NOTEST not allowed for this device type',
     1225      240    1           'ADPnn ALT option not allowed for this device type',
     1226      241    1           'ADPnn FORMAT not allowed with ALT option',
     1227      242    1           'ADPnn NEWDTS not allowed with ALT option',
     1228      243    1           'ADPnn Range cannot be specified with ALT option');
     1229      244        /**/
     1230      245        /* AUTO STACK */
     1231      246        /**/
     1232      247    1   DCL 1 OUT ALIGNED,
     1233      248    1         2 LEN SBIN,
     1234      249    1         2 MSG CHAR(80);
     1235      250        /**/
     1236      251        /* FORMAT ERROR MESSAGE AND PRINT IT */
     1237      252        /**/
     1238      253    1           OUT=ERR(ERRNO);

    253  1 000002   200004 470500                    LDP0    @ERRNO,,AUTO
         1 000003   000000 236100                    LDQ     0,,PR0
         1 000004   000025 402007                    MPY     21,DL
         1 000005   000002 736000                    QLS     2
         1 000006   000100 100406                    MLR     fill='000'O
         1 000007   000000 000124 0                  ADSC9   ERR,Q                    cn=0,n=84
         1 000010   200006 000124                    ADSC9   OUT,,AUTO                cn=0,n=84

     1239      254    1           IF ADDR(DEVID)~=NULL THEN

    254  1 000011   200003 236100                    LDQ     @DEVID,,AUTO
         1 000012   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000013   000020 600000 1                  TZE     s:256

     1240      255    1              CALL INSERT(OUT.MSG,1,4,DEVID);

    255  1 000014   200003 471500                    LDP1    @DEVID,,AUTO
         1 000015   040100 100500                    MLR     fill='040'O
         1 000016   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         1 000017   200007 200004                    ADSC9   OUT+1,,AUTO              cn=1,n=4
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:255  

     1241      256    1           IF ADDR(VSN)~=NULL THEN

    256  1 000020   200005 236100                    LDQ     @VSN,,AUTO
         1 000021   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000022   000035 600000 1                  TZE     s:258

     1242      257    1              CALL IVV$BINDEC(VSN,OUT.MSG,6,6);

    257  1 000023   000000 237000 2                  LDAQ    0
         1 000024   200036 757100                    STAQ    OUT+24,,AUTO
         1 000025   200007 631500                    EPPR1   OUT+1,,AUTO
         1 000026   200035 451500                    STP1    OUT+23,,AUTO
         1 000027   200005 236100                    LDQ     @VSN,,AUTO
         1 000030   200034 756100                    STQ     OUT+22,,AUTO
         1 000031   200034 630500                    EPPR0   OUT+22,,AUTO
         1 000032   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000033   000000 701000 xent               TSX1    IVV$BINDEC
         1 000034   000000 011000                    NOP     0

     1243      258    1           CALL IVO$PRINT(OUT,'1'B);

    258  1 000035   000002 236000 2                  LDQ     2
         1 000036   200035 756100                    STQ     OUT+23,,AUTO
         1 000037   200006 630500                    EPPR0   OUT,,AUTO
         1 000040   200034 450500                    STP0    OUT+22,,AUTO
         1 000041   200034 630500                    EPPR0   OUT+22,,AUTO
         1 000042   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000043   000000 701000 xent               TSX1    IVO$PRINT
         1 000044   000000 011000                    NOP     0

     1244      259    1           RETURN;

    259  1 000045   000000 702200 xent               TSX2  ! X66_ARET

ERR
 Sect OctLoc
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:256  
   0     000   000000 000020   101111 154154   145147 141154   040143 157155    ....AIllegal com
   0     004   155141 156144   040040 040040   040040 040040   040040 040040    mand
   0     010   040040 040040   040040 040040   040040 040040   040040 040040
   0     024*  040040 040040   000000 000023   101104 120156   156040 143157        ....ADPnn co
   0     030   155155 141156   144040 145162   162157 162040   040040 040040    mmand error
   0     034   040040 040040   040040 040040   040040 040040   040040 040040
   0     050*  040040 040040   040040 040040   000000 000024   101104 120156            ....ADPn
   0     054   156040 156157   164040 151156   040126 117114   111116 111124    n not in VOLINIT
   0     060   040040 040040   040040 040040   040040 040040   040040 040040
   0     074*  040040 040040   040040 040040   040040 040040   000000 000033                ....
   0     100   101104 120156   156040 151156   166141 154151   144040 164162    ADPnn invalid tr
   0     104   141143 153040   141144 144162   145163 163040   040040 040040    ack address
   0     110   040040 040040   040040 040040   040040 040040   040040 040040
   0     124*  000000 000055   101104 120156   156040 156157   164040 164150    ...-ADPnn not th
   0     130   145162 145054   040156 157164   040144 151163   153054 040157    ere, not disk, o
   0     134   162040 156157   164040 160141   162164 151164   151157 156145    r not partitione
   0     140   144040 040040   040040 040040   040040 040040   040040 040040    d
   0     144   040040 040040   040040 040040   040040 040040   040040 040040
   0     150   040040 040040   000000 000025   101104 120156   156040 164157        ....ADPnn to
   0     154   157040 155141   156171 040162   141156 147145   163040 040040    o many ranges
   0     160   040040 040040   040040 040040   040040 040040   040040 040040
   0     174*  040040 040040   040040 040040   000000 000037   101104 120156            ....ADPn
   0     200   156040 164157   157040 155141   156171 040144   145146 145143    n too many defec
   0     204   164151 166145   040164 162141   143153 163040   040040 040040    tive tracks
   0     210   040040 040040   040040 040040   040040 040040   040040 040040
   0     220*  040040 040040   040040 040040   040040 040040   000000 000023                ....
   0     224   101104 120156   156040 155151   163163 151156   147040 104124    ADPnn missing DT
   0     230   105116 104040   040040 040040   040040 040040   040040 040040    END
   0     234   040040 040040   040040 040040   040040 040040   040040 040040
   0     250*  000000 000026   101104 120156   156040 170170   170170 170170    ....ADPnn xxxxxx
   0     254   040167 162157   156147 040126   123116 040040   040040 040040     wrong VSN
   0     260   040040 040040   040040 040040   040040 040040   040040 040040
   0     274*  040040 040040   000000 000032   101104 120156   156040 144141        ....ADPnn da
   0     300   164141 040163   160141 143145   040145 170150   141165 163164    ta space exhaust
   0     304   145144 040040   040040 040040   040040 040040   040040 040040    ed
   0     310   040040 040040   040040 040040   040040 040040   040040 040040
   0     320*  040040 040040   040040 040040   000000 000024   101104 120156            ....ADPn
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:257  
   0     324   156040 144151   163153 040151   057157 040145   162162 157162    n disk i/o error
   0     330   040040 040040   040040 040040   040040 040040   040040 040040
   0     344*  040040 040040   040040 040040   040040 040040   000000 000022                ....
   0     350   101103 157155   155141 156144   040151 057157   040145 162162    ACommand i/o err
   0     354   157162 040040   040040 040040   040040 040040   040040 040040    or
   0     360   040040 040040   040040 040040   040040 040040   040040 040040
   0     374*  000000 000030   101104 120156   156040 157154   144040 126111    ....ADPnn old VI
   0     400   104040 165156   162145 141144   141142 154145   040040 040040    D unreadable
   0     404   040040 040040   040040 040040   040040 040040   040040 040040
   0     420*  040040 040040   000000 000012   101104 120156   156040 142165        ....ADPnn bu
   0     424   163171 040040   040040 040040   040040 040040   040040 040040    sy
   0     430   040040 040040   040040 040040   040040 040040   040040 040040
   0     444*  040040 040040   040040 040040   000000 000036   101120 154145            ....APle
   0     450   141163 145040   163160 145143   151146 171040   146157 162155    ase specify form
   0     454   141164 040157   162040 164145   163164 040040   040040 040040    at or test
   0     460   040040 040040   040040 040040   040040 040040   040040 040040
   0     470*  040040 040040   040040 040040   040040 040040   000000 000031                ....
   0     474   101104 120156   156040 105114   124040 156157   164040 162145    ADPnn ELT not re
   0     500   143157 166145   162141 142154   145040 040040   040040 040040    coverable
   0     504   040040 040040   040040 040040   040040 040040   040040 040040
   0     520*  000000 000052   101104 120156   156040 156145   145144 040115    ...*ADPnn need M
   0     524   124101 122040   164157 040167   157162 153040   157156 040105    TAR to work on E
   0     530   114124 040050   070064 060056   062060 055063   071051 040040    LT (840.20-39)
   0     534   040040 040040   040040 040040   040040 040040   040040 040040
   0     544*  040040 040040   000000 000061   101124 150141   164040 143157        ...1AThat co
   0     550   155155 141156   144040 157156   154171 040141   154154 157167    mmand only allow
   0     554   145144 040144   165162 151156   147040 157146   146154 151156    ed during offlin
   0     560   145040 126117   114111 116111   124040 040040   040040 040040    e VOLINIT
   0     564   040040 040040   040040 040040   040040 040040   040040 040040
   0     570   040040 040040   040040 040040   000000 000057   101104 120156            .../ADPn
   0     574   156040 157160   145162 141164   157162 040167   157156 047164    n operator won't
   0     600   040154 145164   040171 157165   040126 117114   111116 111124     let you VOLINIT
   0     604   040164 150141   164040 144162   151166 145040   040040 040040     that drive
   0     610   040040 040040   040040 040040   040040 040040   040040 040040
   0     614   040040 040040   040040 040040   040040 040040   000000 000070                ...8
   0     620   101104 120156   156040 142162   145141 153040   150151 164040    ADPnn break hit
   0     624   167150 151154   145040 157160   145156 151156   147040 144162    while opening dr
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:258  
   0     630   151166 145054   040126 117114   111116 111124   040156 157164    ive, VOLINIT not
   0     634   040163 164141   162164 145144   040040 040040   040040 040040     started
   0     640   040040 040040   040040 040040   040040 040040   040040 040040
   0     644   000000 000064   101104 120156   156040 104124   124075 116105    ...4ADPnn DTT=NE
   0     650   127040 155165   163164 040142   145040 163160   145143 151146    W must be specif
   0     654   151145 144040   146157 162040   164150 151163   040144 145166    ied for this dev
   0     660   151143 145040   164171 160145   040040 040040   040040 040040    ice type
   0     664   040040 040040   040040 040040   040040 040040   040040 040040
   0     670   040040 040040   000000 000055   101104 120156   156040 106117        ...-ADPnn FO
   0     674   122115 101124   040156 157164   040141 154154   157167 145144    RMAT not allowed
   0     700   040146 157162   040164 150151   163040 144145   166151 143145     for this device
   0     704   040164 171160   145040 040040   040040 040040   040040 040040     type
   0     710   040040 040040   040040 040040   040040 040040   040040 040040
   0     714   040040 040040   040040 040040   000000 000055   101104 120156            ...-ADPn
   0     720   156040 126105   122111 106131   040156 157164   040141 154154    n VERIFY not all
   0     724   157167 145144   040146 157162   040164 150151   163040 144145    owed for this de
   0     730   166151 143145   040164 171160   145040 040040   040040 040040    vice type
   0     734   040040 040040   040040 040040   040040 040040   040040 040040
   0     740   040040 040040   040040 040040   040040 040040   000000 000053                ...+
   0     744   101104 120156   156040 124105   123124 040156   157164 040141    ADPnn TEST not a
   0     750   154154 157167   145144 040146   157162 040164   150151 163040    llowed for this
   0     754   144145 166151   143145 040164   171160 145040   040040 040040    device type
   0     760   040040 040040   040040 040040   040040 040040   040040 040040
   0     770*  000000 000064   101104 120156   156040 123103   122101 124103    ...4ADPnn SCRATC
   0     774   110040 155165   163164 040142   145040 163160   145143 151146    H must be specif
   0    1000   151145 144040   146157 162040   164150 151163   040144 145166    ied for this dev
   0    1004   151143 145040   164171 160145   040040 040040   040040 040040    ice type
   0    1010   040040 040040   040040 040040   040040 040040   040040 040040
   0    1014   040040 040040   000000 000055   101104 120156   156040 116105        ...-ADPnn NE
   0    1020   127104 124123   040156 157164   040141 154154   157167 145144    WDTS not allowed
   0    1024   040146 157162   040164 150151   163040 144145   166151 143145     for this device
   0    1030   040164 171160   145040 040040   040040 040040   040040 040040     type
   0    1034   040040 040040   040040 040040   040040 040040   040040 040040
   0    1040   040040 040040   040040 040040   000000 000072   101104 120156            ...:ADPn
   0    1044   156040 122141   156147 145040   163160 145143   151146 151143    n Range specific
   0    1050   141164 151157   156040 156157   164040 141154   154157 167145    ation not allowe
   0    1054   144040 146157   162040 164150   151163 040144   145166 151143    d for this devic
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:259  
   0    1060   145040 164171   160145 040040   040040 040040   040040 040040    e type
   0    1064   040040 040040   040040 040040   040040 040040   000000 000064                ...4
   0    1070   101116 157040   155157 162145   040104 103102   040163 154157    ANo more DCB slo
   0    1074   164163 040141   166141 151154   141142 154145   040055 040111    ts available - I
   0    1100   057117 040157   160145 162141   164151 157156   040141 142157    /O operation abo
   0    1104   162164 145144   040040 040040   040040 040040   040040 040040    rted
   0    1110   040040 040040   040040 040040   040040 040040   040040 040040
   0    1114   000000 000076   101111 156163   165146 146151   143151 145156    ...>AInsufficien
   0    1120   164040 160162   151166 151154   145147 145040   164157 040162    t privilege to r
   0    1124   165156 040126   117114 111116   111124 040055   040111 057117    un VOLINIT - I/O
   0    1130   040157 160145   162141 164151   157156 040141   142157 162164     operation abort
   0    1134   145144 040040   040040 040040   040040 040040   040040 040040    ed
   0    1140   040040 040040   000000 000062   101104 120156   156040 115104        ...2ADPnn MD
   0    1144   123040 144151   163153 040156   157164 040146   157162 155141    S disk not forma
   0    1150   164164 145144   040167 151164   150040 065061   062040 167157    tted with 512 wo
   0    1154   162144 163057   163145 143164   157162 040040   040040 040040    rds/sector
   0    1160   040040 040040   040040 040040   040040 040040   040040 040040
   0    1164   040040 040040   040040 040040   000000 000063   101104 120156            ...3ADPn
   0    1170   156040 106111   120123 040144   151163 153040   156157 164040    n FIPS disk not
   0    1174   146157 162155   141164 164145   144040 167151   164150 040065    formatted with 5
   0    1200   061062 040167   157162 144163   057163 145143   164157 162040    12 words/sector
   0    1204   040040 040040   040040 040040   040040 040040   040040 040040
   0    1210   040040 040040   040040 040040   040040 040040   000000 000034                ....
   0    1214   101104 120156   156040 156157   164040 141040   065060 061116    ADPnn not a 501N
   0    1220   040144 145166   151143 145040   164171 160145   040040 040040     device type
   0    1224   040040 040040   040040 040040   040040 040040   040040 040040
   0    1240*  000000 000074   101125 156141   142154 145040   164157 040147    ...<AUnable to g
   0    1244   145164 040141   156040 111057   117040 162145   161165 145163    et an I/O reques
   0    1250   164040 160141   143153 145164   040055 040111   057117 040157    t packet - I/O o
   0    1254   160145 162141   164151 157156   040141 142157   162164 145144    peration aborted
   0    1260   040040 040040   040040 040040   040040 040040   040040 040040
   0    1264   040040 040040   000000 000075   101104 120156   156040 101156        ...=ADPnn An
   0    1270   040145 162162   157162 040157   143143 165162   162145 144040     error occurred
   0    1274   167150 145156   040141 164164   145155 160164   151156 147040    when attempting
   0    1300   164157 040166   145162 151146   171040 144151   163153 040146    to verify disk f
   0    1304   157162 155141   164040 040040   040040 040040   040040 040040    ormat
   0    1310   040040 040040   040040 040040   000000 000077   101104 120156            ...?ADPn
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:260  
   0    1314   156040 104145   166151 143145   040156 157164   040143 157156    n Device not con
   0    1320   146151 147165   162145 144040   157162 040157   146146 055154    figured or off-l
   0    1324   151156 145040   055040 111057   117040 157160   145162 141164    ine - I/O operat
   0    1330   151157 156040   141142 157162   164145 144040   040040 040040    ion aborted
   0    1334   040040 040040   040040 040040   040040 040040   000000 000055                ...-
   0    1340   101104 120156   156040 116117   124105 123124   040156 157164    ADPnn NOTEST not
   0    1344   040141 154154   157167 145144   040146 157162   040164 150151     allowed for thi
   0    1350   163040 144145   166151 143145   040164 171160   145040 040040    s device type
   0    1354   040040 040040   040040 040040   040040 040040   040040 040040
   0    1364*  000000 000061   101104 120156   156040 101114   124040 157160    ...1ADPnn ALT op
   0    1370   164151 157156   040156 157164   040141 154154   157167 145144    tion not allowed
   0    1374   040146 157162   040164 150151   163040 144145   166151 143145     for this device
   0    1400   040164 171160   145040 040040   040040 040040   040040 040040     type
   0    1404   040040 040040   040040 040040   040040 040040   040040 040040
   0    1410   040040 040040   000000 000050   101104 120156   156040 106117        ...(ADPnn FO
   0    1414   122115 101124   040156 157164   040141 154154   157167 145144    RMAT not allowed
   0    1420   040167 151164   150040 101114   124040 157160   164151 157156     with ALT option
   0    1424   040040 040040   040040 040040   040040 040040   040040 040040
   0    1434*  040040 040040   040040 040040   000000 000050   101104 120156            ...(ADPn
   0    1440   156040 116105   127104 124123   040156 157164   040141 154154    n NEWDTS not all
   0    1444   157167 145144   040167 151164   150040 101114   124040 157160    owed with ALT op
   0    1450   164151 157156   040040 040040   040040 040040   040040 040040    tion
   0    1454   040040 040040   040040 040040   040040 040040   040040 040040
   0    1460   040040 040040   040040 040040   040040 040040   000000 000057                .../
   0    1464   101104 120156   156040 122141   156147 145040   143141 156156    ADPnn Range cann
   0    1470   157164 040142   145040 163160   145143 151146   151145 144040    ot be specified
   0    1474   167151 164150   040101 114124   040157 160164   151157 156040    with ALT option
   0    1500   040040 040040   040040 040040   040040 040040   040040 040040
   0    1504   040040 040040   040040 040040   040040 040040   040040 040040

(unnamed)
 Sect OctLoc
   2     000   000010 006000   000010 006000   000030 006000                    ............
     1245      260    1   END IVV$ERROR;
     1246      261        %EOD;

PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:261  
--  Include file information  --

   IV$MACROS.:E05TOU  is referenced.
      No diagnostics issued in procedure IVV$ERROR.
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:262  

 **** Variables and constants ****

  ****  Section 000 RoData IVV$ERROR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(756)   r     1 ERR(0:39)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DEVID                     4-0-0/w PTR         r     1 @ERRNO
     5-0-0/w PTR         r     1 @VSN                      *0-0-0/c CHAR(4)     r     1 DEVID
    *0-0-0/w SBIN        r     1 ERRNO                      6-0-0/w STRC(756)   r     1 OUT
    *0-0-0/w SBIN        r     1 VSN


   Procedure IVV$ERROR requires 38 words for executable code.
   Procedure IVV$ERROR requires 32 words of local(AUTO) storage.
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:263  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=IVV$ERROR File=IVV$VOLINIT.:E05TSI                            TUE 07/29/97 23:19 Page:264  
          MINI XREF LISTING

DEVID
       185**DCL         8--PROC      254--IF        255>>CALLBLT
ERR
       200**DCL       253>>ASSIGN
ERRNO
       186**DCL         8--PROC      253>>ASSIGN
IVO$PRINT
       195**DCL-ENT   258--CALL
IVV$BINDEC
       196**DCL-ENT   257--CALL
OUT
       247**DCL       253<<ASSIGN    258<>CALL
OUT.MSG
       249**DCL       255<<CALLBLT   257<>CALL
VSN
       187**DCL         8--PROC      256--IF        257<>CALL

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:265  
     1247        1        /*T***********************************************************/
     1248        2        /*T*                                                         */
     1249        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1250        4        /*T*                                                         */
     1251        5        /*T***********************************************************/
     1252        6        /* SET UP TRACK FORMAT HEADER */
     1253        7        /**/
     1254        8        IVV$HEADER: PROC (VIP);
     1255        9        /**/
     1256       10        /* INCLUDE FILES */
     1257       11        /**/
     1258       12        %INCLUDE FM$GRAN;
     1259       81        %INCLUDE IV$MACROS;
     1260      251        /**/
     1261      252        /* PARAMETERS */
     1262      253        /**/
     1263      254        %IV$VIP(NAME=VIP,STCLASS="");
     1264      318        /**/
     1265      319        /* DATA STRUCTURES */
     1266      320        /**/
     1267      321        %IV$FMT(NAME=FMT,STCLASS="BASED(FMT$)");
     1268      377        %FM$VID(FM$VID=VID,BASED="BASED(VID$)");
     1269      383        /**/
     1270      384        /* AUTO STACK */
     1271      385        /**/
     1272      386    1   DCL CK BIT(6);
     1273      387    1   DCL FMT$ PTR;
     1274      388    1   DCL I SBIN;
     1275      389    1   DCL J SBIN;
     1276      390    1   DCL TRACK SBIN;
     1277      391    1   DCL 1 TR REDEF TRACK,
     1278      392    1         2 * BIT(18),
     1279      393    1         2 CYL UBIN(10) UNAL,              /* CYLINDER NUMBER */
     1280      394    1         2 HD UBIN(8) UNAL;                /* HEAD NUMBER */
     1281      395    1   DCL VID$ PTR;
     1282      396    1   DCL HDR5$ PTR;
     1283      397    1   DCL DATA$ PTR;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:266  
     1284      398        %IV$HDR(NAME=CF,STCLASS="BASED(HDR5$)");
     1285      426
     1286      427    1   DCL 1 LOG(0:3071) BASED(DATA$) UNAL,
     1287      428    1         2 * BIT(6) UNAL,
     1288      429    1         2 CYL UBIN(10) UNAL,
     1289      430    1         2 HD UBIN(8) UNAL,
     1290      431    1         2 POS UBIN(16) UNAL,
     1291      432    1         2 LTH UBIN(8) UNAL;
     1292      433
     1293      434    1   DCL 1 SKIP(0:1),
     1294      435    1         2 S BIT(4) UNAL,
     1295      436    1         2 SK UBIN(12) UNAL;
     1296      437
     1297      438    1   DCL TALLY(0:3) SBIN INIT(169,64,2310,81) CONSTANT;
     1298      439    1   DCL DP(0:3) BIT(4)
     1299      440    1            INIT(BINBIT(1),BINBIT(4),BINBIT(8),BINBIT(2)) CONSTANT;
     1300      441    1   DCL RUNBYT SBIN ALIGNED;                /* RUNNING BYTE COUNT IN A TRACK */
     1301      442    1   DCL DPN SBIN ALIGNED;
     1302      443    1   DCL DPSEC SBIN ALIGNED;                 /* NUMBER OF DEFECT POS IN A SECTOR */
     1303      444    1   DCL SKIPLTH SBIN ALIGNED INIT(64) CONSTANT; /* DEFECT SKIP LENGTH */
     1304      445    1   DCL POS(0:3) UBIN(16) ;                 /* DEFECT POSITION IN BYTE COUNT */
     1305      446    1   DCL LTH(0:3) UBIN(8) ;                  /* DEFECT LENGTH */
     1306      447    1   DCL DEFNO SBIN ALIGNED;                 /* DEFECT # IN A TRACK */
     1307      448    1   DCL TPOS UBIN(16) ;
     1308      449    1   DCL PART SBIN ALIGNED;                  /* PARTS IN A SECTOR;
     1309      450                                                    0: G1+C0+32  1: G2
     1310      451                                                    2: DATA+EDAC 3: G3+CN */
     1311      452        /**/
     1312      453        %EJECT;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:267  
     1313      454    1           FMT$=VIP.FMT$;
     1314      455    1           VID$=VIP.VID$;
     1315      456    1           DATA$=PINCRW(VIP.ELT$,SIZEW(FMT)+82); /* ELT ENTRY STARTS  */
     1316      457    2           DO SELECT(VIP.MODEL);
     1317      458    2              SELECT('MSU0501 ','MSU0509 ');
     1318      459    2              CALL INITHDR;
     1319      460    2              CALL HDR5XX;
     1320      461    2              SELECT(ELSE);
     1321      462    2           J=FMT.SEEK.SECTOR/VIP.NSECTS;
     1322      463    2           TR.CYL=J/VIP.NHEADS;
     1323      464    2           TR.HD=MOD(J,VIP.NHEADS);
     1324      465    2           IF VIP.DISKERR THEN GOTO DEFECTIVE;
     1325      466    2           I=0;
     1326      467    3           DO WHILE (I<63 AND VID.DTT(I)~=BITBIN('777777'O));
     1327      468    4              IF TRACK=VID.DTT(I) THEN DO;
     1328      469    4   DEFECTIVE:
     1329      470    4                 FMT.SEEK.TI='11'B;        /* DEFECTIVE TRACK, NO ALTERNATE */
     1330      471    4                 GOTO DTT_FOUND;
     1331      472    4                 END;
     1332      473    3              I=I+1;
     1333      474    3              END/* WHILE I */;
     1334      475    2           FMT.SEEK.TI='00'B;              /* TRACK NOT DEFECTIVE */
     1335      476    2   DTT_FOUND:
     1336      477    2           FMT.HEADER.CYL=TR.CYL;
     1337      478    2           FMT.HEADER.HD=TR.HD;
     1338      479    2           FMT.HEADER.Z=VIP.VERIFY;
     1339      480    2           FMT.HEADER.TI=FMT.SEEK.TI;
     1340      481    2           FMT.HEADER.R0.CYL=FMT.HEADER.CYL;
     1341      482    2           FMT.HEADER.R0.HD=FMT.HEADER.HD;
     1342      483    2           CK='0'B;
     1343      484    3           DO I=0 TO 13;
     1344      485    3              CK=CK & ~FMT.CKBYTES(I) | ~CK & FMT.CKBYTES(I);
     1345      486    3              END/* DO I */;
     1346      487    2           FMT.HEADER.CHECK=CK;
     1347      488    2              END;                         /* SELECT VIP.MODEL */
     1348      489
     1349      490    1           RETURN;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:268  
     1350      491        %EJECT;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:269  
     1351      492    1   INITHDR: PROC;
     1352      493    2           FMT.SEEK.TI='00'B;
     1353      494    2           VIP.FLAG='0'B; VIP.FLAG.F512='1'B; VIP.FLAG.MTAR='1'B;
     1354      495    2           HDR5$=PINCRW(ADDR(FMT.HEADER),6); /* 451 HDR SZ IS 6 */
     1355      496    2           CF='0'B;
     1356      497    2           CF.C0.CYL.LWR=FMT.SEEK.SEC.CL;
     1357      498    2           CF.C0.CYL.UPR=FMT.SEEK.SEC.CU;
     1358      499    2           CF.C0.HD=FMT.SEEK.SEC.HD;
     1359      500    2           CF.C0.FLAG=VIP.FLAG;       /* INIT FLAG, REC, T-SKIP TO GOOD VALUE */
     1360      501    2           CF.C0.REC=128;
     1361      502    2           CF.C0.CONDFLAG='16'O;           /* RIGHT JUSTIFY TO OCTAL CODE 70 */
     1362      503    3           DO I=0 TO 2;
     1363      504    3              CF.C0.TSKP.G(I)=1;
     1364      505    3              END;
     1365      506    2           CF.C.FLAG(0)=VIP.FLAG;
     1366      507    2           CF.C.CYL.LWR(0)=FMT.SEEK.SEC.CL;
     1367      508    2           CF.C.CYL.UPR(0)=FMT.SEEK.SEC.CU;
     1368      509    2           CF.C.HD(0)=FMT.SEEK.SEC.HD;
     1369      510    2           CF.C.REC(0)=129;
     1370      511    2           CF.C.CONDFLAG(0)='16'O;
     1371      512    3           DO I=1 TO VIP.NSECTS-2;
     1372      513    3              CF.C.FLAG(I)=CF.C0.FLAG;
     1373      514    3              CF.C.CYL.LWR(I)=FMT.SEEK.SEC.CL;
     1374      515    3              CF.C.CYL.UPR(I)=FMT.SEEK.SEC.CU;
     1375      516    3              CF.C.HD(I)=FMT.SEEK.SEC.HD;
     1376      517    3              CF.C.REC(I)=CF.C.REC(I-1)+1;
     1377      518    3              CF.C.CONDFLAG(I)='16'O;
     1378      519    3              END;
     1379      520
     1380      521    2   END INITHDR;
     1381      522        %EJECT;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:270  
     1382      523    1   HDR5XX: PROC;
     1383      524
     1384      525    3           DO I=0 TO 3;
     1385      526    3              POS(I)=0; LTH(I)=0;
     1386      527    3              END;
     1387      528    2           DEFNO=0; SKIP='0'B;
     1388      529    2           TR.CYL=VIP.CTR.CYL; TR.HD=VIP.CTR.HD;
     1389      530    3           DO WHILE (LOG(VIP.LOGX)~='0'B AND VIP.LOGX<3072 );
     1390      531
     1391      532    4              DO WHILE ( TR.CYL=LOG.CYL(VIP.LOGX) AND TR.HD=LOG.HD(VIP.LOGX) );
     1392      533    5                 DO WHILE (LOG(VIP.LOGX)=LOG(VIP.LOGX+1) );
     1393      534    5                    VIP.LOGX=VIP.LOGX+1;   /* BYPASS DUPLICATE LOG ENTRY */
     1394      535    5                    END;
     1395      536    4                 POS(DEFNO)=LOG.POS(VIP.LOGX);
     1396      537    4                 LTH(DEFNO)=LOG.LTH(VIP.LOGX);
     1397      538    4                 CALL POS_VALU(POS(DEFNO),LTH(DEFNO));
     1398      539    4                 DEFNO=DEFNO+1;
     1399      540    4                 VIP.LOGX=VIP.LOGX+1;
     1400      541    4                 END;
     1401      542    3              IF ( TR.CYL>LOG.CYL(VIP.LOGX) )OR(  ( TR.CYL=LOG.CYL(VIP.LOGX) )
     1402      543    3                AND( TR.HD>LOG.HD(VIP.LOGX) ) ) THEN
     1403      544    3                 VIP.LOGX =VIP.LOGX+1;
     1404      545    3              ELSE GOTO LOGGED;
     1405      546    3              END;
     1406      547    3   LOGGED: IF DEFNO > 0 THEN DO;
     1407      548    3              IF DEFNO>3 OR LTH(DEFNO-1)=255 THEN
     1408      549    3                 CALL MARKDTT;
     1409      550    3              J=DEFNO-1; I=MOD(J,2);
     1410      551    4              DO UNTIL (J < 0);
     1411      552    5                 IF LTH(J) ~=255 THEN DO;
     1412      553    5                    IF J-1 < 0 THEN CF.C0.TSKIP(2)=POS(0);
     1413      554    5                    ELSE
     1414      555    5                       CF.C0.TSKIP(I)=POS(J)-POS(J-1);
     1415      556    5                    END;
     1416      557    4                 I=I+1;J=J-1;
     1417      558    4                 END;
     1418      559    3              RUNBYT=0; DPSEC=0; DPN=1;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:271  
     1419      560    4              DO PART=0 TO 3;
     1420      561    4                 RUNBYT=RUNBYT+TALLY(PART);
     1421      562    4                 IF POS(DPN-1) <= RUNBYT THEN CALL SKPOS;
     1422      563    4                 IF DPN > DEFNO THEN PART=3;
     1423      564    4                 END;
     1424      565    4              IF DPN > 1 THEN DO;
     1425      566    4                 CF.C0.SKP=SKIP;
     1426      567    4                 SKIP='0'B; DPSEC=0;
     1427      568    4                 END;
     1428      569    3              IF ( DPN > DEFNO ) OR ( VIP.FLAG.TI='11'B ) THEN RETURN;
     1429      570    4              DO J=2 TO VIP.NSECTS;
     1430      571    5                 DO PART=1 TO 3;
     1431      572    5                    RUNBYT=RUNBYT+TALLY(PART);
     1432      573    5                    IF POS(DPN-1) <= RUNBYT THEN CALL SKPOS;
     1433      574    5                    IF DPN > DEFNO THEN PART=3;
     1434      575    5                    END;
     1435      576    4                 CF.C.SKP(J-2)=SKIP;
     1436      577    4                 SKIP='0'B; DPSEC=0;
     1437      578
     1438      579    4                 IF DPN > DEFNO THEN J=VIP.NSECTS;
     1439      580    4                 END;
     1440      581    3              END;                         /* DEFNO ~=0 */
     1441      582    2   END HDR5XX;
     1442      583        %EJECT;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:272  
     1443      584    1   SKPOS:  PROC;
     1444      585
     1445      586    2   DCL REMN SBIN ALIGNED;
     1446      587    2   DCL 1 MPI REDEF REMN,                   /* CORRECTION FOR MPI */
     1447      588    2         2 * BIT(34) UNAL,
     1448      589    2         2 CR BIT(2) UNAL;
     1449      590
     1450      591    3           IF DPSEC < 2 THEN DO;
     1451      592    4              DO CASE(PART);
     1452      593    4               CASE (2);
     1453      594    4                 REMN=POS(DPN-1)-RUNBYT+6; /* EDAC HAS 6 BYTES IN DATA PART */
     1454      595    4                 IF REMN > 0 THEN
     1455      596    4                    SKIP.S(DPSEC)=DP(3);   /* ASSIGN DEFECT TO PART 3 */
     1456      597    5                 ELSE IF (REMN >= -2304) AND (REMN <= -2301) THEN DO;
     1457      598    5                       SKIP.S(DPSEC)=DP(1); /* ASSIGN DEFECT TO PART 1 */
     1458      599    5                       PART=2;
     1459      600    5                       RUNBYT=RUNBYT-TALLY(PART);
     1460      601    5                       END;
     1461      602    5                    ELSE DO;               /* DEFECT IN DATA PART, SPLIT DATA. */
     1462      603    5                       RUNBYT=RUNBYT+2;    /* FOR HEX 19 & SYNC BYTE */
     1463      604    5                       SKIP.S(DPSEC)=DP(2);
     1464      605    5                       MPI.CR='01'B;
     1465      606    5                       SKIP.SK(DPSEC)=REMN; /* REMAIN GOOD DATA BYTES */
     1466      607    5                       END;
     1467      608    4               CASE(ELSE);
     1468      609    4                 SKIP.S(DPSEC)=DP(PART);
     1469      610    4               END;
     1470      611    3              DPSEC=DPSEC+1;
     1471      612    3              RUNBYT=RUNBYT+SKIPLTH;
     1472      613    3              DPN=DPN+1;
     1473      614    3              END;
     1474      615    2           ELSE CALL MARKDTT;
     1475      616    2   END SKPOS;
     1476      617
     1477      618
     1478      619    1   POS_VALU: PROC(POS,LTH);
     1479      620    2   DCL POS UBIN(16);
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:273  
     1480      621    2   DCL LTH UBIN(8);
     1481      622
     1482      623    2           IF LTH=255 THEN POS=0;
     1483      624    3           ELSE DO;
     1484      625    3              IF POS=0 THEN POS=32;
     1485      626    3              ELSE
     1486      627    3                 IF POS >= (19968-32) THEN
     1487      628    3                    POS = 19968-32;        /* TOTAL BYTE PER TRACK IS 19968 */
     1488      629    3              LTH=40;
     1489      630    3              END;
     1490      631    2   END POS_VALU;
     1491      632
     1492      633
     1493      634    1   MARKDTT: PROC;
     1494      635
     1495      636    2           VIP.LOGX=VIP.LOGX-5;       /* BACK OFF 5 ERROR LOG INDEX FOR RETRY */
     1496      637    2           VIP.FLAG.TI='11'B;
     1497      638    2           CF.C0.FLAG=VIP.FLAG;
     1498      639    2           CF.C0.CONDFLAG='0'B;
     1499      640    3           DO I=0 TO VIP.NSECTS-2;
     1500      641    3              CF.C.FLAG(I)='0'B;
     1501      642    3              CF.C.CONDFLAG(I)='0'B;
     1502      643    3              CF.C.REC(I)=0;
     1503      644    3              CF.C.CYL(I)='0'B;
     1504      645    3              CF.C.HD(I)=0;
     1505      646    3              END;
     1506      647    2           FMT.SEEK.TI=VIP.FLAG.TI;
     1507      648    2           VID$=VIP.VID$;
     1508      649    3           DO I=0 TO 62;
     1509      650    4              IF VID.DTT(I)=BITBIN('777777'O) THEN DO;
     1510      651    4                 VID.DTT(I)=VIP.CTRACK;
     1511      652    4                 VIP.DTTCH='1'B;
     1512      653    4                 RETURN;
     1513      654    4                 END;
     1514      655    3              END;
     1515      656    2           VIP.DTTOVF='1'B;
     1516      657    2           VIP.STOP='1'B;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:274  
     1517      658    2           RETURN;
     1518      659    2   END MARKDTT;
     1519      660
     1520      661
     1521      662    1   END IVV$HEADER;
     1522      663        %EOD;

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:275  
--  Include file information  --

   IV$MACROS.:E05TOU  is referenced.
   FM$GRAN.:E05TOU  is referenced.
      No diagnostics issued in procedure IVV$HEADER.

   Procedure IVV$HEADER requires 797 words for executable code.
   Procedure IVV$HEADER requires 42 words of local(AUTO) storage.

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:276  

 Object Unit name= IVV$HEADER                                 File name= IVV$VOLINIT.:E05TOU
 UTS= JUL 29 '97 23:19:21.04 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     10     12  IVV$HEADER
    1   Proc  even  none   797   1435  IVV$HEADER
    2  RoData even  none    14     16  IVV$HEADER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  IVV$HEADER

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:277  


     1247        1        /*T***********************************************************/
     1248        2        /*T*                                                         */
     1249        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1250        4        /*T*                                                         */
     1251        5        /*T***********************************************************/
     1252        6        /* SET UP TRACK FORMAT HEADER */
     1253        7        /**/
     1254        8        IVV$HEADER: PROC (VIP);

      8  1 000000   000000 700200 xent  IVV$HEADER   TSX0  ! X66_AUTO_1
         1 000001   000052 000001                    ZERO    42,1

     1255        9        /**/
     1256       10        /* INCLUDE FILES */
     1257       11        /**/
     1258       12        %INCLUDE FM$GRAN;
     1259       81        %INCLUDE IV$MACROS;
     1260      251        /**/
     1261      252        /* PARAMETERS */
     1262      253        /**/
     1263      254        %IV$VIP(NAME=VIP,STCLASS="");
     1264      318        /**/
     1265      319        /* DATA STRUCTURES */
     1266      320        /**/
     1267      321        %IV$FMT(NAME=FMT,STCLASS="BASED(FMT$)");
     1268      377        %FM$VID(FM$VID=VID,BASED="BASED(VID$)");
     1269      383        /**/
     1270      384        /* AUTO STACK */
     1271      385        /**/
     1272      386    1   DCL CK BIT(6);
     1273      387    1   DCL FMT$ PTR;
     1274      388    1   DCL I SBIN;
     1275      389    1   DCL J SBIN;
     1276      390    1   DCL TRACK SBIN;
     1277      391    1   DCL 1 TR REDEF TRACK,
     1278      392    1         2 * BIT(18),
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:278  
     1279      393    1         2 CYL UBIN(10) UNAL,              /* CYLINDER NUMBER */
     1280      394    1         2 HD UBIN(8) UNAL;                /* HEAD NUMBER */
     1281      395    1   DCL VID$ PTR;
     1282      396    1   DCL HDR5$ PTR;
     1283      397    1   DCL DATA$ PTR;
     1284      398        %IV$HDR(NAME=CF,STCLASS="BASED(HDR5$)");
     1285      426
     1286      427    1   DCL 1 LOG(0:3071) BASED(DATA$) UNAL,
     1287      428    1         2 * BIT(6) UNAL,
     1288      429    1         2 CYL UBIN(10) UNAL,
     1289      430    1         2 HD UBIN(8) UNAL,
     1290      431    1         2 POS UBIN(16) UNAL,
     1291      432    1         2 LTH UBIN(8) UNAL;
     1292      433
     1293      434    1   DCL 1 SKIP(0:1),
     1294      435    1         2 S BIT(4) UNAL,
     1295      436    1         2 SK UBIN(12) UNAL;
     1296      437
     1297      438    1   DCL TALLY(0:3) SBIN INIT(169,64,2310,81) CONSTANT;
     1298      439    1   DCL DP(0:3) BIT(4)
     1299      440    1            INIT(BINBIT(1),BINBIT(4),BINBIT(8),BINBIT(2)) CONSTANT;
     1300      441    1   DCL RUNBYT SBIN ALIGNED;                /* RUNNING BYTE COUNT IN A TRACK */
     1301      442    1   DCL DPN SBIN ALIGNED;
     1302      443    1   DCL DPSEC SBIN ALIGNED;                 /* NUMBER OF DEFECT POS IN A SECTOR */
     1303      444    1   DCL SKIPLTH SBIN ALIGNED INIT(64) CONSTANT; /* DEFECT SKIP LENGTH */
     1304      445    1   DCL POS(0:3) UBIN(16) ;                 /* DEFECT POSITION IN BYTE COUNT */
     1305      446    1   DCL LTH(0:3) UBIN(8) ;                  /* DEFECT LENGTH */
     1306      447    1   DCL DEFNO SBIN ALIGNED;                 /* DEFECT # IN A TRACK */
     1307      448    1   DCL TPOS UBIN(16) ;
     1308      449    1   DCL PART SBIN ALIGNED;                  /* PARTS IN A SECTOR;
     1309      450                                                    0: G1+C0+32  1: G2
     1310      451                                                    2: DATA+EDAC 3: G3+CN */
     1311      452        /**/
     1312      453        %EJECT;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:279  
     1313      454    1           FMT$=VIP.FMT$;

    454  1 000002   200003 470500                    LDP0    @VIP,,AUTO
         1 000003   000013 236100                    LDQ     11,,PR0
         1 000004   200005 756100                    STQ     FMT$,,AUTO

     1314      455    1           VID$=VIP.VID$;

    455  1 000005   000012 236100                    LDQ     10,,PR0
         1 000006   200011 756100                    STQ     VID$,,AUTO

     1315      456    1           DATA$=PINCRW(VIP.ELT$,SIZEW(FMT)+82); /* ELT ENTRY STARTS  */

    456  1 000007   000003 236100                    LDQ     3,,PR0
         1 000010   000151 036003                    ADLQ    105,DU
         1 000011   200013 756100                    STQ     DATA$,,AUTO

     1316      457    2           DO SELECT(VIP.MODEL);

    457  1 000012   040000 106500                    CMPC    fill='040'O
         1 000013   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000014   000006 000010 0                  ADSC9   SKIPLTH+1                cn=0,n=8
         1 000015   000031 602000 1                  TNC     s:462
         1 000016   000024 600000 1                  TZE     s:459
         1 000017   040000 106500                    CMPC    fill='040'O
         1 000020   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000021   000010 000010 0                  ADSC9   SKIPLTH+3                cn=0,n=8
         1 000022   000031 601000 1                  TNZ     s:462
         1 000023   000024 710000 1                  TRA     s:459

     1317      458    2              SELECT('MSU0501 ','MSU0509 ');

     1318      459    2              CALL INITHDR;

    459  1 000024   000222 701000 1                  TSX1    INITHDR
         1 000025   000000 011000                    NOP     0

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:280  
     1319      460    2              CALL HDR5XX;

    460  1 000026   000426 701000 1                  TSX1    HDR5XX
         1 000027   000000 011000                    NOP     0
         1 000030   000221 710000 1                  TRA     s:490

     1320      461    2              SELECT(ELSE);

     1321      462    2           J=FMT.SEEK.SECTOR/VIP.NSECTS;

    462  1 000031   000014 236100                    LDQ     12,,PR0
         1 000032   000033 772000                    QRL     27
         1 000033   200042 756100                    STQ     @LTH+2,,AUTO
         1 000034   200005 471500                    LDP1    FMT$,,AUTO
         1 000035   100007 236100                    LDQ     7,,PR1
         1 000036   000000 376000 2                  ANQ     0
         1 000037   200042 506100                    DIV     @LTH+2,,AUTO
         1 000040   200007 756100                    STQ     J,,AUTO

     1322      463    2           TR.CYL=J/VIP.NHEADS;

    463  1 000041   000014 236100                    LDQ     12,,PR0
         1 000042   000022 772000                    QRL     18
         1 000043   000777 376007                    ANQ     511,DL
         1 000044   200042 756100                    STQ     @LTH+2,,AUTO
         1 000045   200007 236100                    LDQ     J,,AUTO
         1 000046   200042 506100                    DIV     @LTH+2,,AUTO
         1 000047   000010 736000                    QLS     8
         1 000050   200010 676100                    ERQ     TRACK,,AUTO
         1 000051   777400 376007                    ANQ     -256,DL
         1 000052   200010 656100                    ERSQ    TRACK,,AUTO

     1323      464    2           TR.HD=MOD(J,VIP.NHEADS);

    464  1 000053   000014 236100                    LDQ     12,,PR0
         1 000054   000022 772000                    QRL     18
         1 000055   000777 376007                    ANQ     511,DL
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:281  
         1 000056   200042 756100                    STQ     @LTH+2,,AUTO
         1 000057   200007 236100                    LDQ     J,,AUTO
         1 000060   200042 506100                    DIV     @LTH+2,,AUTO
         1 000061   000044 733000                    LRS     36
         1 000062   200010 676100                    ERQ     TRACK,,AUTO
         1 000063   000377 376007                    ANQ     255,DL
         1 000064   200010 656100                    ERSQ    TRACK,,AUTO

     1324      465    2           IF VIP.DISKERR THEN GOTO DEFECTIVE;

    465  1 000065   000017 236100                    LDQ     15,,PR0
         1 000066   001000 316007                    CANQ    512,DL
         1 000067   000100 601000 1                  TNZ     DEFECTIVE

     1325      466    2           I=0;

    466  1 000070   200006 450100                    STZ     I,,AUTO

     1326      467    3           DO WHILE (I<63 AND VID.DTT(I)~=BITBIN('777777'O));

    467  1 000071   000105 710000 1                  TRA     s:474

     1327      468    4              IF TRACK=VID.DTT(I) THEN DO;

    468  1 000072   200011 470500                    LDP0    VID$,,AUTO
         1 000073   200006 720100                    LXL0    I,,AUTO
         1 000074   000400 236110                    LDQ     256,X0,PR0
         1 000075   000022 772000                    QRL     18
         1 000076   200010 116100                    CMPQ    TRACK,,AUTO
         1 000077   000104 601000 1                  TNZ     s:473

     1328      469    4   DEFECTIVE:
     1329      470    4                 FMT.SEEK.TI='11'B;        /* DEFECTIVE TRACK, NO ALTERNATE */

    470  1 000100   200005 470500       DEFECTIVE    LDP0    FMT$,,AUTO
         1 000101   000060 236003                    LDQ     48,DU
         1 000102   000007 256100                    ORSQ    7,,PR0
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:282  

     1330      471    4                 GOTO DTT_FOUND;

    471  1 000103   000117 710000 1                  TRA     DTT_FOUND

     1331      472    4                 END;
     1332      473    3              I=I+1;

    473  1 000104   200006 054100                    AOS     I,,AUTO

     1333      474    3              END/* WHILE I */;

    474  1 000105   200006 235100                    LDA     I,,AUTO
         1 000106   000077 115007                    CMPA    63,DL
         1 000107   000114 605000 1                  TPL     s:475
         1 000110   200011 470500                    LDP0    VID$,,AUTO
         1 000111   000400 220105                    LDX0    256,AL,PR0
         1 000112   777777 100003                    CMPX0   -1,DU
         1 000113   000072 601000 1                  TNZ     s:468

     1334      475    2           FMT.SEEK.TI='00'B;              /* TRACK NOT DEFECTIVE */

    475  1 000114   200005 470500                    LDP0    FMT$,,AUTO
         1 000115   000001 236000 2                  LDQ     1
         1 000116   000007 356100                    ANSQ    7,,PR0

     1335      476    2   DTT_FOUND:
     1336      477    2           FMT.HEADER.CYL=TR.CYL;

    477  1 000117   200010 236100       DTT_FOUND    LDQ     TRACK,,AUTO
         1 000120   777400 376007                    ANQ     -256,DL
         1 000121   000014 736000                    QLS     12
         1 000122   000021 676100                    ERQ     17,,PR0
         1 000123   777774 376003                    ANQ     -4,DU
         1 000124   000021 656100                    ERSQ    17,,PR0

     1337      478    2           FMT.HEADER.HD=TR.HD;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:283  

    478  1 000125   200010 236100                    LDQ     TRACK,,AUTO
         1 000126   000377 376007                    ANQ     255,DL
         1 000127   000004 736000                    QLS     4
         1 000130   000021 676100                    ERQ     17,,PR0
         1 000131   000002 376000 2                  ANQ     2
         1 000132   000021 656100                    ERSQ    17,,PR0

     1338      479    2           FMT.HEADER.Z=VIP.VERIFY;

    479  1 000133   200003 471500                    LDP1    @VIP,,AUTO
         1 000134   100017 236100                    LDQ     15,,PR1
         1 000135   000016 772000                    QRL     14
         1 000136   000021 676100                    ERQ     17,,PR0
         1 000137   000004 376007                    ANQ     4,DL
         1 000140   000021 656100                    ERSQ    17,,PR0

     1339      480    2           FMT.HEADER.TI=FMT.SEEK.TI;

    480  1 000141   000007 236100                    LDQ     7,,PR0
         1 000142   000026 772000                    QRL     22
         1 000143   000021 676100                    ERQ     17,,PR0
         1 000144   000003 376007                    ANQ     3,DL
         1 000145   000021 656100                    ERSQ    17,,PR0

     1340      481    2           FMT.HEADER.R0.CYL=FMT.HEADER.CYL;

    481  1 000146   000021 236100                    LDQ     17,,PR0
         1 000147   000014 772000                    QRL     12
         1 000150   000022 676100                    ERQ     18,,PR0
         1 000151   000003 376000 2                  ANQ     3
         1 000152   000022 656100                    ERSQ    18,,PR0

     1341      482    2           FMT.HEADER.R0.HD=FMT.HEADER.HD;

    482  1 000153   003100 060500                    CSL     bolr='003'O
         1 000154   000021 270020                    BDSC    17,,PR0                  by=1,bit=7,n=16
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:284  
         1 000155   000022 610020                    BDSC    18,,PR0                  by=3,bit=1,n=16

     1342      483    2           CK='0'B;

    483  1 000156   200004 450100                    STZ     CK,,AUTO

     1343      484    3           DO I=0 TO 13;

    484  1 000157   200006 450100                    STZ     I,,AUTO

     1344      485    3              CK=CK & ~FMT.CKBYTES(I) | ~CK & FMT.CKBYTES(I);

    485  1 000160   200006 235100                    LDA     I,,AUTO
         1 000161   000163 605000 1                  TPL     s:485+3
         1 000162   000006 035003                    ADLA    6,DU
         1 000163   200005 470500                    LDP0    FMT$,,AUTO
         1 000164   000100 100505                    MLR     fill='000'O
         1 000165   000021 020001                    ADSC6   17,A,PR0                 cn=0,n=1
         1 000166   200042 020006                    ADSC6   @LTH+2,,AUTO             cn=0,n=6
         1 000167   200042 236100                    LDQ     @LTH+2,,AUTO
         1 000170   770000 676003                    ERQ     -4096,DU
         1 000171   200043 756100                    STQ     @LTH+3,,AUTO
         1 000172   200004 236100                    LDQ     CK,,AUTO
         1 000173   770000 376003                    ANQ     -4096,DU
         1 000174   200043 376100                    ANQ     @LTH+3,,AUTO
         1 000175   200044 756100                    STQ     @LTH+4,,AUTO
         1 000176   200004 236100                    LDQ     CK,,AUTO
         1 000177   770000 376003                    ANQ     -4096,DU
         1 000200   770000 676003                    ERQ     -4096,DU
         1 000201   200006 235100                    LDA     I,,AUTO
         1 000202   000204 605000 1                  TPL     s:485+20
         1 000203   000006 035003                    ADLA    6,DU
         1 000204   000100 100505                    MLR     fill='000'O
         1 000205   000021 020001                    ADSC6   17,A,PR0                 cn=0,n=1
         1 000206   200045 020006                    ADSC6   @LTH+5,,AUTO             cn=0,n=6
         1 000207   200045 376100                    ANQ     @LTH+5,,AUTO
         1 000210   200044 276100                    ORQ     @LTH+4,,AUTO
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:285  
         1 000211   200004 756100                    STQ     CK,,AUTO

     1345      486    3              END/* DO I */;

    486  1 000212   200006 054100                    AOS     I,,AUTO
         1 000213   200006 235100                    LDA     I,,AUTO
         1 000214   000015 115007                    CMPA    13,DL
         1 000215   000160 604400 1                  TMOZ    s:485

     1346      487    2           FMT.HEADER.CHECK=CK;

    487  1 000216   200004 236100                    LDQ     CK,,AUTO
         1 000217   000022 772000                    QRL     18
         1 000220   000023 752104                    STCQ    19,'04'O,PR0

     1347      488    2              END;                         /* SELECT VIP.MODEL */

     1348      489
     1349      490    1           RETURN;

    490  1 000221   000000 702200 xent               TSX2  ! X66_ARET

     1350      491        %EJECT;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:286  
     1351      492    1   INITHDR: PROC;

    492  1 000222   200034 741300       INITHDR      STX1  ! PART+2,,AUTO

     1352      493    2           FMT.SEEK.TI='00'B;

    493  1 000223   200005 470500                    LDP0    FMT$,,AUTO
         1 000224   000001 236000 2                  LDQ     1
         1 000225   000007 356100                    ANSQ    7,,PR0

     1353      494    2           VIP.FLAG='0'B; VIP.FLAG.F512='1'B; VIP.FLAG.MTAR='1'B;

    494  1 000226   200003 471500                    LDP1    @VIP,,AUTO
         1 000227   000004 236000 2                  LDQ     4
         1 000230   100020 356100                    ANSQ    16,,PR1

    494  1 000231   400000 236007                    LDQ     -131072,DL
         1 000232   100020 256100                    ORSQ    16,,PR1

    494  1 000233   200000 236007                    LDQ     65536,DL
         1 000234   100020 256100                    ORSQ    16,,PR1

     1354      495    2           HDR5$=PINCRW(ADDR(FMT.HEADER),6); /* 451 HDR SZ IS 6 */

    495  1 000235   200005 236100                    LDQ     FMT$,,AUTO
         1 000236   000027 036003                    ADLQ    23,DU
         1 000237   200012 756100                    STQ     HDR5$,,AUTO

     1355      496    2           CF='0'B;

    496  1 000240   200012 473500                    LDP3    HDR5$,,AUTO
         1 000241   000100 100400                    MLR     fill='000'O
         1 000242   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000243   300000 000510                    ADSC9   0,,PR3                   cn=0,n=328

     1356      497    2           CF.C0.CYL.LWR=FMT.SEEK.SEC.CL;

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:287  
    497  1 000244   000007 236100                    LDQ     7,,PR0
         1 000245   000014 736000                    QLS     12
         1 000246   300000 676100                    ERQ     0,,PR3
         1 000247   001774 376003                    ANQ     1020,DU
         1 000250   300000 656100                    ERSQ    0,,PR3

     1357      498    2           CF.C0.CYL.UPR=FMT.SEEK.SEC.CU;

    498  1 000251   000007 236100                    LDQ     7,,PR0
         1 000252   000014 736000                    QLS     12
         1 000253   300000 676100                    ERQ     0,,PR3
         1 000254   000003 376003                    ANQ     3,DU
         1 000255   300000 656100                    ERSQ    0,,PR3

     1358      499    2           CF.C0.HD=FMT.SEEK.SEC.HD;

    499  1 000256   000007 236100                    LDQ     7,,PR0
         1 000257   000014 736000                    QLS     12
         1 000260   300000 752104                    STCQ    0,'04'O,PR3

     1359      500    2           CF.C0.FLAG=VIP.FLAG;       /* INIT FLAG, REC, T-SKIP TO GOOD VALUE */

    500  1 000261   100020 236100                    LDQ     16,,PR1
         1 000262   000022 736000                    QLS     18
         1 000263   300000 676100                    ERQ     0,,PR3
         1 000264   776000 376003                    ANQ     -1024,DU
         1 000265   300000 656100                    ERSQ    0,,PR3

     1360      501    2           CF.C0.REC=128;

    501  1 000266   300000 236100                    LDQ     0,,PR3
         1 000267   000005 376000 2                  ANQ     5
         1 000270   004000 276007                    ORQ     2048,DL
         1 000271   300000 756100                    STQ     0,,PR3

     1361      502    2           CF.C0.CONDFLAG='16'O;           /* RIGHT JUSTIFY TO OCTAL CODE 70 */

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:288  
    502  1 000272   300003 236100                    LDQ     3,,PR3
         1 000273   000006 376000 2                  ANQ     6
         1 000274   000070 276007                    ORQ     56,DL
         1 000275   300003 756100                    STQ     3,,PR3

     1362      503    3           DO I=0 TO 2;

    503  1 000276   200006 450100                    STZ     I,,AUTO

     1363      504    3              CF.C0.TSKP.G(I)=1;

    504  1 000277   200006 235100                    LDA     I,,AUTO
         1 000300   000004 735000                    ALS     4
         1 000301   000303 605000 1                  TPL     s:504+4
         1 000302   000044 035003                    ADLA    36,DU
         1 000303   200012 470500                    LDP0    HDR5$,,AUTO
         1 000304   003105 061400                    CSR     bolr='003'O
         1 000305   000003 000044 xsym               BDSC    B_VECTNIL+3              by=0,bit=0,n=36
         1 000306   000002 100001                    BDSC    2,A,PR0                  by=0,bit=8,n=1

     1364      505    3              END;

    505  1 000307   200006 054100                    AOS     I,,AUTO
         1 000310   200006 235100                    LDA     I,,AUTO
         1 000311   000002 115007                    CMPA    2,DL
         1 000312   000277 604400 1                  TMOZ    s:504

     1365      506    2           CF.C.FLAG(0)=VIP.FLAG;

    506  1 000313   200003 471500                    LDP1    @VIP,,AUTO
         1 000314   100020 236100                    LDQ     16,,PR1
         1 000315   000022 736000                    QLS     18
         1 000316   000004 676100                    ERQ     4,,PR0
         1 000317   776000 376003                    ANQ     -1024,DU
         1 000320   000004 656100                    ERSQ    4,,PR0

     1366      507    2           CF.C.CYL.LWR(0)=FMT.SEEK.SEC.CL;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:289  

    507  1 000321   200005 473500                    LDP3    FMT$,,AUTO
         1 000322   300007 236100                    LDQ     7,,PR3
         1 000323   000014 736000                    QLS     12
         1 000324   000004 676100                    ERQ     4,,PR0
         1 000325   001774 376003                    ANQ     1020,DU
         1 000326   000004 656100                    ERSQ    4,,PR0

     1367      508    2           CF.C.CYL.UPR(0)=FMT.SEEK.SEC.CU;

    508  1 000327   300007 236100                    LDQ     7,,PR3
         1 000330   000014 736000                    QLS     12
         1 000331   000004 676100                    ERQ     4,,PR0
         1 000332   000003 376003                    ANQ     3,DU
         1 000333   000004 656100                    ERSQ    4,,PR0

     1368      509    2           CF.C.HD(0)=FMT.SEEK.SEC.HD;

    509  1 000334   300007 236100                    LDQ     7,,PR3
         1 000335   000014 736000                    QLS     12
         1 000336   000004 752104                    STCQ    4,'04'O,PR0

     1369      510    2           CF.C.REC(0)=129;

    510  1 000337   000004 236100                    LDQ     4,,PR0
         1 000340   000005 376000 2                  ANQ     5
         1 000341   004020 276007                    ORQ     2064,DL
         1 000342   000004 756100                    STQ     4,,PR0

     1370      511    2           CF.C.CONDFLAG(0)='16'O;

    511  1 000343   000005 236100                    LDQ     5,,PR0
         1 000344   000006 376000 2                  ANQ     6
         1 000345   000070 276007                    ORQ     56,DL
         1 000346   000005 756100                    STQ     5,,PR0

     1371      512    3           DO I=1 TO VIP.NSECTS-2;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:290  

    512  1 000347   000001 235007                    LDA     1,DL
         1 000350   200006 755100                    STA     I,,AUTO
         1 000351   000416 710000 1                  TRA     s:519+1

     1372      513    3              CF.C.FLAG(I)=CF.C0.FLAG;

    513  1 000352   200006 235100                    LDA     I,,AUTO
         1 000353   000001 735000                    ALS     1
         1 000354   200012 470500                    LDP0    HDR5$,,AUTO
         1 000355   000000 236100                    LDQ     0,,PR0
         1 000356   000004 676105                    ERQ     4,AL,PR0
         1 000357   776000 376003                    ANQ     -1024,DU
         1 000360   000004 656105                    ERSQ    4,AL,PR0

     1373      514    3              CF.C.CYL.LWR(I)=FMT.SEEK.SEC.CL;

    514  1 000361   200005 471500                    LDP1    FMT$,,AUTO
         1 000362   100007 236100                    LDQ     7,,PR1
         1 000363   000014 736000                    QLS     12
         1 000364   000004 676105                    ERQ     4,AL,PR0
         1 000365   001774 376003                    ANQ     1020,DU
         1 000366   000004 656105                    ERSQ    4,AL,PR0

     1374      515    3              CF.C.CYL.UPR(I)=FMT.SEEK.SEC.CU;

    515  1 000367   100007 236100                    LDQ     7,,PR1
         1 000370   000014 736000                    QLS     12
         1 000371   000004 676105                    ERQ     4,AL,PR0
         1 000372   000003 376003                    ANQ     3,DU
         1 000373   000004 656105                    ERSQ    4,AL,PR0

     1375      516    3              CF.C.HD(I)=FMT.SEEK.SEC.HD;

    516  1 000374   100007 236100                    LDQ     7,,PR1
         1 000375   000014 736000                    QLS     12
         1 000376   000004 676105                    ERQ     4,AL,PR0
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:291  
         1 000377   770000 376007                    ANQ     -4096,DL
         1 000400   000004 656105                    ERSQ    4,AL,PR0

     1376      517    3              CF.C.REC(I)=CF.C.REC(I-1)+1;

    517  1 000401   000002 236105                    LDQ     2,AL,PR0
         1 000402   000004 772000                    QRL     4
         1 000403   000377 376007                    ANQ     255,DL
         1 000404   000001 036007                    ADLQ    1,DL
         1 000405   000004 736000                    QLS     4
         1 000406   000004 676105                    ERQ     4,AL,PR0
         1 000407   007760 376007                    ANQ     4080,DL
         1 000410   000004 656105                    ERSQ    4,AL,PR0

     1377      518    3              CF.C.CONDFLAG(I)='16'O;

    518  1 000411   000005 236105                    LDQ     5,AL,PR0
         1 000412   000006 376000 2                  ANQ     6
         1 000413   000070 276007                    ORQ     56,DL
         1 000414   000005 756105                    STQ     5,AL,PR0

     1378      519    3              END;

    519  1 000415   200006 054100                    AOS     I,,AUTO
         1 000416   200003 471500                    LDP1    @VIP,,AUTO
         1 000417   100014 236100                    LDQ     12,,PR1
         1 000420   000033 772000                    QRL     27
         1 000421   000002 136007                    SBLQ    2,DL
         1 000422   200006 116100                    CMPQ    I,,AUTO
         1 000423   000352 605000 1                  TPL     s:513

     1379      520
     1380      521    2   END INITHDR;

    521  1 000424   200034 221300                    LDX1  ! PART+2,,AUTO
         1 000425   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:292  
     1381      522        %EJECT;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:293  
     1382      523    1   HDR5XX: PROC;

    523  1 000426   200034 741300       HDR5XX       STX1  ! PART+2,,AUTO

     1383      524
     1384      525    3           DO I=0 TO 3;

    525  1 000427   200006 450100                    STZ     I,,AUTO

     1385      526    3              POS(I)=0; LTH(I)=0;

    526  1 000430   200006 720100                    LXL0    I,,AUTO
         1 000431   200020 450110                    STZ     POS,X0,AUTO

    526  1 000432   200024 450110                    STZ     LTH,X0,AUTO

     1386      527    3              END;

    527  1 000433   200006 054100                    AOS     I,,AUTO
         1 000434   200006 235100                    LDA     I,,AUTO
         1 000435   000003 115007                    CMPA    3,DL
         1 000436   000430 604400 1                  TMOZ    s:526

     1387      528    2           DEFNO=0; SKIP='0'B;

    528  1 000437   200030 450100                    STZ     DEFNO,,AUTO

    528  1 000440   000017 236007                    LDQ     15,DL
         1 000441   200014 356100                    ANSQ    SKIP,,AUTO

     1388      529    2           TR.CYL=VIP.CTR.CYL; TR.HD=VIP.CTR.HD;

    529  1 000442   200003 470500                    LDP0    @VIP,,AUTO
         1 000443   000016 236100                    LDQ     14,,PR0
         1 000444   000022 772000                    QRL     18
         1 000445   200010 676100                    ERQ     TRACK,,AUTO
         1 000446   777400 376007                    ANQ     -256,DL
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:294  
         1 000447   200010 656100                    ERSQ    TRACK,,AUTO

    529  1 000450   000016 236100                    LDQ     14,,PR0
         1 000451   000022 772000                    QRL     18
         1 000452   200010 676100                    ERQ     TRACK,,AUTO
         1 000453   000377 376007                    ANQ     255,DL
         1 000454   200010 656100                    ERSQ    TRACK,,AUTO

     1389      530    3           DO WHILE (LOG(VIP.LOGX)~='0'B AND VIP.LOGX<3072 );

    530  1 000455   000713 710000 1                  TRA     s:546

     1390      531
     1391      532    4              DO WHILE ( TR.CYL=LOG.CYL(VIP.LOGX) AND TR.HD=LOG.HD(VIP.LOGX) );

    532  1 000456   000602 710000 1                  TRA     s:541

     1392      533    5                 DO WHILE (LOG(VIP.LOGX)=LOG(VIP.LOGX+1) );

    533  1 000457   200003 470500                    LDP0    @VIP,,AUTO
         1 000460   000004 235100                    LDA     4,,PR0
         1 000461   000003 735000                    ALS     3
         1 000462   200042 755100                    STA     @LTH+2,,AUTO
         1 000463   000044 733000                    LRS     36
         1 000464   000006 402007                    MPY     6,DL
         1 000465   000000 116003                    CMPQ    0,DU
         1 000466   000470 605000 1                  TPL     s:533+9
         1 000467   000044 036003                    ADLQ    36,DU
         1 000470   200043 756100                    STQ     @LTH+3,,AUTO
         1 000471   200042 236100                    LDQ     @LTH+2,,AUTO
         1 000472   000006 402007                    MPY     6,DL
         1 000473   000000 116003                    CMPQ    0,DU
         1 000474   000476 605000 1                  TPL     s:533+15
         1 000475   000044 036003                    ADLQ    36,DU
         1 000476   200013 471500                    LDP1    DATA$,,AUTO
         1 000477   200043 235100                    LDA     @LTH+3,,AUTO
         1 000500   000106 066505                    CMPB    filb='0'B
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:295  
         1 000501   100000 000060                    BDSC    0,A,PR1                  by=0,bit=0,n=48
         1 000502   100001 230060                    BDSC    1,Q,PR1                  by=1,bit=3,n=48
         1 000503   000532 601000 1                  TNZ     s:536

     1393      534    5                    VIP.LOGX=VIP.LOGX+1;   /* BYPASS DUPLICATE LOG ENTRY */

    534  1 000504   200003 470500                    LDP0    @VIP,,AUTO
         1 000505   000004 054100                    AOS     4,,PR0

     1394      535    5                    END;

    535  1 000506   000004 235100                    LDA     4,,PR0
         1 000507   000003 735000                    ALS     3
         1 000510   200042 755100                    STA     @LTH+2,,AUTO
         1 000511   000044 733000                    LRS     36
         1 000512   000006 402007                    MPY     6,DL
         1 000513   000000 116003                    CMPQ    0,DU
         1 000514   000516 605000 1                  TPL     s:535+8
         1 000515   000044 036003                    ADLQ    36,DU
         1 000516   200043 756100                    STQ     @LTH+3,,AUTO
         1 000517   200042 236100                    LDQ     @LTH+2,,AUTO
         1 000520   000006 402007                    MPY     6,DL
         1 000521   000000 116003                    CMPQ    0,DU
         1 000522   000524 605000 1                  TPL     s:535+14
         1 000523   000044 036003                    ADLQ    36,DU
         1 000524   200013 471500                    LDP1    DATA$,,AUTO
         1 000525   200043 235100                    LDA     @LTH+3,,AUTO
         1 000526   000106 066505                    CMPB    filb='0'B
         1 000527   100000 000060                    BDSC    0,A,PR1                  by=0,bit=0,n=48
         1 000530   100001 230060                    BDSC    1,Q,PR1                  by=1,bit=3,n=48
         1 000531   000504 600000 1                  TZE     s:534

     1395      536    4                 POS(DEFNO)=LOG.POS(VIP.LOGX);

    536  1 000532   000004 236100                    LDQ     4,,PR0
         1 000533   000060 402007                    MPY     48,DL
         1 000534   000000 116003                    CMPQ    0,DU
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:296  
         1 000535   000537 605000 1                  TPL     s:536+5
         1 000536   000044 036003                    ADLQ    36,DU
         1 000537   200042 756100                    STQ     @LTH+2,,AUTO
         1 000540   200030 236100                    LDQ     DEFNO,,AUTO
         1 000541   000044 402007                    MPY     36,DL
         1 000542   000000 116003                    CMPQ    0,DU
         1 000543   000545 605000 1                  TPL     s:536+11
         1 000544   000044 036003                    ADLQ    36,DU
         1 000545   200042 235100                    LDA     @LTH+2,,AUTO
         1 000546   003106 060505                    CSL     bolr='003'O
         1 000547   100000 460020                    BDSC    0,A,PR1                  by=2,bit=6,n=16
         1 000550   200020 000020                    BDSC    POS,Q,AUTO               by=0,bit=0,n=16

     1396      537    4                 LTH(DEFNO)=LOG.LTH(VIP.LOGX);

    537  1 000551   000004 236100                    LDQ     4,,PR0
         1 000552   000060 402007                    MPY     48,DL
         1 000553   000000 116003                    CMPQ    0,DU
         1 000554   000556 605000 1                  TPL     s:537+5
         1 000555   000044 036003                    ADLQ    36,DU
         1 000556   200042 756100                    STQ     @LTH+2,,AUTO
         1 000557   200030 236100                    LDQ     DEFNO,,AUTO
         1 000560   000044 402007                    MPY     36,DL
         1 000561   000000 116003                    CMPQ    0,DU
         1 000562   000564 605000 1                  TPL     s:537+11
         1 000563   000044 036003                    ADLQ    36,DU
         1 000564   200042 235100                    LDA     @LTH+2,,AUTO
         1 000565   003106 060505                    CSL     bolr='003'O
         1 000566   100001 040010                    BDSC    1,A,PR1                  by=0,bit=4,n=8
         1 000567   200024 000010                    BDSC    LTH,Q,AUTO               by=0,bit=0,n=8

     1397      538    4                 CALL POS_VALU(POS(DEFNO),LTH(DEFNO));

    538  1 000570   200030 720100                    LXL0    DEFNO,,AUTO
         1 000571   200024 633510                    EPPR3   LTH,X0,AUTO
         1 000572   200040 453500                    STP3    @POS+1,,AUTO
         1 000573   200020 634510                    EPPR4   POS,X0,AUTO
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:297  
         1 000574   200037 454500                    STP4    PART+5,,AUTO
         1 000575   001277 701000 1                  TSX1    POS_VALU
         1 000576   000000 011000                    NOP     0

     1398      539    4                 DEFNO=DEFNO+1;

    539  1 000577   200030 054100                    AOS     DEFNO,,AUTO

     1399      540    4                 VIP.LOGX=VIP.LOGX+1;

    540  1 000600   200003 470500                    LDP0    @VIP,,AUTO
         1 000601   000004 054100                    AOS     4,,PR0

     1400      541    4                 END;

    541  1 000602   200003 470500                    LDP0    @VIP,,AUTO
         1 000603   000004 236100                    LDQ     4,,PR0
         1 000604   000060 402007                    MPY     48,DL
         1 000605   000000 116003                    CMPQ    0,DU
         1 000606   000610 605000 1                  TPL     s:541+6
         1 000607   000044 036003                    ADLQ    36,DU
         1 000610   200013 471500                    LDP1    DATA$,,AUTO
         1 000611   003100 061506                    CSR     bolr='003'O
         1 000612   100000 060012                    BDSC    0,Q,PR1                  by=0,bit=6,n=10
         1 000613   200042 000044                    BDSC    @LTH+2,,AUTO             by=0,bit=0,n=36
         1 000614   200010 236100                    LDQ     TRACK,,AUTO
         1 000615   000010 772000                    QRL     8
         1 000616   001777 376007                    ANQ     1023,DL
         1 000617   200042 116100                    CMPQ    @LTH+2,,AUTO
         1 000620   000635 601000 1                  TNZ     s:542
         1 000621   000004 236100                    LDQ     4,,PR0
         1 000622   000060 402007                    MPY     48,DL
         1 000623   000000 116003                    CMPQ    0,DU
         1 000624   000626 605000 1                  TPL     s:541+20
         1 000625   000044 036003                    ADLQ    36,DU
         1 000626   003100 061506                    CSR     bolr='003'O
         1 000627   100000 270010                    BDSC    0,Q,PR1                  by=1,bit=7,n=8
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:298  
         1 000630   200043 000044                    BDSC    @LTH+3,,AUTO             by=0,bit=0,n=36
         1 000631   200010 236100                    LDQ     TRACK,,AUTO
         1 000632   000377 376007                    ANQ     255,DL
         1 000633   200043 116100                    CMPQ    @LTH+3,,AUTO
         1 000634   000457 600000 1                  TZE     s:533

     1401      542    3              IF ( TR.CYL>LOG.CYL(VIP.LOGX) )OR(  ( TR.CYL=LOG.CYL(VIP.LOGX) )

    542  1 000635   000004 236100                    LDQ     4,,PR0
         1 000636   000060 402007                    MPY     48,DL
         1 000637   200042 756100                    STQ     @LTH+2,,AUTO
         1 000640   200010 236100                    LDQ     TRACK,,AUTO
         1 000641   000010 772000                    QRL     8
         1 000642   001777 376007                    ANQ     1023,DL
         1 000643   200043 756100                    STQ     @LTH+3,,AUTO
         1 000644   200042 235100                    LDA     @LTH+2,,AUTO
         1 000645   000647 605000 1                  TPL     s:542+10
         1 000646   000044 035003                    ADLA    36,DU
         1 000647   003100 061505                    CSR     bolr='003'O
         1 000650   100000 060012                    BDSC    0,A,PR1                  by=0,bit=6,n=10
         1 000651   200044 000044                    BDSC    @LTH+4,,AUTO             by=0,bit=0,n=36
         1 000652   200044 236100                    LDQ     @LTH+4,,AUTO
         1 000653   200043 116100                    CMPQ    @LTH+3,,AUTO
         1 000654   000711 604000 1                  TMI     s:544
         1 000655   000004 236100                    LDQ     4,,PR0
         1 000656   000060 402007                    MPY     48,DL
         1 000657   000000 116003                    CMPQ    0,DU
         1 000660   000662 605000 1                  TPL     s:542+21
         1 000661   000044 036003                    ADLQ    36,DU
         1 000662   003100 061506                    CSR     bolr='003'O
         1 000663   100000 060012                    BDSC    0,Q,PR1                  by=0,bit=6,n=10
         1 000664   200045 000044                    BDSC    @LTH+5,,AUTO             by=0,bit=0,n=36
         1 000665   200010 236100                    LDQ     TRACK,,AUTO
         1 000666   000010 772000                    QRL     8
         1 000667   001777 376007                    ANQ     1023,DL
         1 000670   200045 116100                    CMPQ    @LTH+5,,AUTO
         1 000671   000732 601000 1                  TNZ     LOGGED
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:299  
         1 000672   000004 236100                    LDQ     4,,PR0
         1 000673   000060 402007                    MPY     48,DL
         1 000674   200046 756100                    STQ     @LTH+6,,AUTO
         1 000675   200010 236100                    LDQ     TRACK,,AUTO
         1 000676   000377 376007                    ANQ     255,DL
         1 000677   200047 756100                    STQ     @LTH+7,,AUTO
         1 000700   200046 235100                    LDA     @LTH+6,,AUTO
         1 000701   000703 605000 1                  TPL     s:542+38
         1 000702   000044 035003                    ADLA    36,DU
         1 000703   003100 061505                    CSR     bolr='003'O
         1 000704   100000 270010                    BDSC    0,A,PR1                  by=1,bit=7,n=8
         1 000705   200050 000044                    BDSC    @LTH+8,,AUTO             by=0,bit=0,n=36
         1 000706   200050 236100                    LDQ     @LTH+8,,AUTO
         1 000707   200047 116100                    CMPQ    @LTH+7,,AUTO
         1 000710   000732 605000 1                  TPL     LOGGED

     1402      543    3                AND( TR.HD>LOG.HD(VIP.LOGX) ) ) THEN
     1403      544    3                 VIP.LOGX =VIP.LOGX+1;

    544  1 000711   000004 054100                    AOS     4,,PR0
         1 000712   000713 710000 1                  TRA     s:546

     1404      545    3              ELSE GOTO LOGGED;
     1405      546    3              END;

    546  1 000713   000004 235100                    LDA     4,,PR0
         1 000714   000003 735000                    ALS     3
         1 000715   000044 733000                    LRS     36
         1 000716   000006 402007                    MPY     6,DL
         1 000717   000000 116003                    CMPQ    0,DU
         1 000720   000722 605000 1                  TPL     s:546+7
         1 000721   000044 036003                    ADLQ    36,DU
         1 000722   200013 471500                    LDP1    DATA$,,AUTO
         1 000723   000000 066506                    CMPB    filb='0'B
         1 000724   100000 000060                    BDSC    0,Q,PR1                  by=0,bit=0,n=48
         1 000725   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000726   000732 600000 1                  TZE     LOGGED
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:300  
         1 000727   000004 235100                    LDA     4,,PR0
         1 000730   006000 115007                    CMPA    3072,DL
         1 000731   000456 604000 1                  TMI     s:532

     1406      547    3   LOGGED: IF DEFNO > 0 THEN DO;

    547  1 000732   200030 235100       LOGGED       LDA     DEFNO,,AUTO
         1 000733   001153 604400 1                  TMOZ    s:582

     1407      548    3              IF DEFNO>3 OR LTH(DEFNO-1)=255 THEN

    548  1 000734   000003 115007                    CMPA    3,DL
         1 000735   000742 605400 1                  TPNZ    s:549
         1 000736   200023 236105                    LDQ     POS+3,AL,AUTO
         1 000737   776000 376003                    ANQ     -1024,DU
         1 000740   776000 116003                    CMPQ    -1024,DU
         1 000741   000744 601000 1                  TNZ     s:550

     1408      549    3                 CALL MARKDTT;

    549  1 000742   001331 701000 1                  TSX1    MARKDTT
         1 000743   000000 011000                    NOP     0

     1409      550    3              J=DEFNO-1; I=MOD(J,2);

    550  1 000744   200030 235100                    LDA     DEFNO,,AUTO
         1 000745   000001 135007                    SBLA    1,DL
         1 000746   200007 755100                    STA     J,,AUTO

    550  1 000747   200007 236100                    LDQ     J,,AUTO
         1 000750   000002 506007                    DIV     2,DL
         1 000751   200006 755100                    STA     I,,AUTO

     1410      551    4              DO UNTIL (J < 0);

     1411      552    5                 IF LTH(J) ~=255 THEN DO;

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:301  
    552  1 000752   200007 720100                    LXL0    J,,AUTO
         1 000753   200024 236110                    LDQ     LTH,X0,AUTO
         1 000754   776000 376003                    ANQ     -1024,DU
         1 000755   776000 116003                    CMPQ    -1024,DU
         1 000756   001007 600000 1                  TZE     s:557

     1412      553    5                    IF J-1 < 0 THEN CF.C0.TSKIP(2)=POS(0);

    553  1 000757   200007 235100                    LDA     J,,AUTO
         1 000760   000770 605400 1                  TPNZ    s:555

    553  1 000761   200012 470500                    LDP0    HDR5$,,AUTO
         1 000762   200020 236100                    LDQ     POS,,AUTO
         1 000763   000004 772000                    QRL     4
         1 000764   000003 676100                    ERQ     3,,PR0
         1 000765   000007 376000 2                  ANQ     7
         1 000766   000003 656100                    ERSQ    3,,PR0
         1 000767   001007 710000 1                  TRA     s:557

     1413      554    5                    ELSE
     1414      555    5                       CF.C0.TSKIP(I)=POS(J)-POS(J-1);

    555  1 000770   200017 236110                    LDQ     DPSEC,X0,AUTO
         1 000771   000024 772000                    QRL     20
         1 000772   200042 756100                    STQ     @LTH+2,,AUTO
         1 000773   200020 236110                    LDQ     POS,X0,AUTO
         1 000774   000024 772000                    QRL     20
         1 000775   200042 136100                    SBLQ    @LTH+2,,AUTO
         1 000776   200043 756100                    STQ     @LTH+3,,AUTO
         1 000777   200006 235100                    LDA     I,,AUTO
         1 001000   000004 735000                    ALS     4
         1 001001   001003 605000 1                  TPL     s:555+11
         1 001002   000044 035003                    ADLA    36,DU
         1 001003   200012 470500                    LDP0    HDR5$,,AUTO
         1 001004   003105 061500                    CSR     bolr='003'O
         1 001005   200043 000044                    BDSC    @LTH+3,,AUTO             by=0,bit=0,n=36
         1 001006   000002 100020                    BDSC    2,A,PR0                  by=0,bit=8,n=16
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:302  

     1415      556    5                    END;

     1416      557    4                 I=I+1;J=J-1;

    557  1 001007   200006 054100                    AOS     I,,AUTO

    557  1 001010   000001 336007                    LCQ     1,DL
         1 001011   200007 056100                    ASQ     J,,AUTO

     1417      558    4                 END;

    558  1 001012   000752 605000 1                  TPL     s:552

     1418      559    3              RUNBYT=0; DPSEC=0; DPN=1;

    559  1 001013   200015 450100                    STZ     RUNBYT,,AUTO

    559  1 001014   200017 450100                    STZ     DPSEC,,AUTO

    559  1 001015   000001 235007                    LDA     1,DL
         1 001016   200016 755100                    STA     DPN,,AUTO

     1419      560    4              DO PART=0 TO 3;

    560  1 001017   200032 450100                    STZ     PART,,AUTO

     1420      561    4                 RUNBYT=RUNBYT+TALLY(PART);

    561  1 001020   200032 720100                    LXL0    PART,,AUTO
         1 001021   200015 236100                    LDQ     RUNBYT,,AUTO
         1 001022   000000 036010 0                  ADLQ    TALLY,X0
         1 001023   200015 756100                    STQ     RUNBYT,,AUTO

     1421      562    4                 IF POS(DPN-1) <= RUNBYT THEN CALL SKPOS;

    562  1 001024   200016 721100                    LXL1    DPN,,AUTO
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:303  
         1 001025   200017 236111                    LDQ     DPSEC,X1,AUTO
         1 001026   000024 772000                    QRL     20
         1 001027   200015 116100                    CMPQ    RUNBYT,,AUTO
         1 001030   001033 605400 1                  TPNZ    s:563

    562  1 001031   001155 701000 1                  TSX1    SKPOS
         1 001032   000000 011000                    NOP     0

     1422      563    4                 IF DPN > DEFNO THEN PART=3;

    563  1 001033   200016 236100                    LDQ     DPN,,AUTO
         1 001034   200030 116100                    CMPQ    DEFNO,,AUTO
         1 001035   001040 604400 1                  TMOZ    s:564

    563  1 001036   000003 235007                    LDA     3,DL
         1 001037   200032 755100                    STA     PART,,AUTO

     1423      564    4                 END;

    564  1 001040   200032 054100                    AOS     PART,,AUTO
         1 001041   200032 235100                    LDA     PART,,AUTO
         1 001042   000003 115007                    CMPA    3,DL
         1 001043   001020 604400 1                  TMOZ    s:561

     1424      565    4              IF DPN > 1 THEN DO;

    565  1 001044   000001 116007                    CMPQ    1,DL
         1 001045   001055 604400 1                  TMOZ    s:569

     1425      566    4                 CF.C0.SKP=SKIP;

    566  1 001046   200012 470500                    LDP0    HDR5$,,AUTO
         1 001047   003100 060500                    CSL     bolr='003'O
         1 001050   200014 000040                    BDSC    SKIP,,AUTO               by=0,bit=0,n=32
         1 001051   000000 650040                    BDSC    0,,PR0                   by=3,bit=5,n=32

     1426      567    4                 SKIP='0'B; DPSEC=0;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:304  

    567  1 001052   000017 236007                    LDQ     15,DL
         1 001053   200014 356100                    ANSQ    SKIP,,AUTO

    567  1 001054   200017 450100                    STZ     DPSEC,,AUTO

     1427      568    4                 END;

     1428      569    3              IF ( DPN > DEFNO ) OR ( VIP.FLAG.TI='11'B ) THEN RETURN;

    569  1 001055   200016 236100                    LDQ     DPN,,AUTO
         1 001056   200030 116100                    CMPQ    DEFNO,,AUTO
         1 001057   001065 605400 1                  TPNZ    s:569+8
         1 001060   200003 470500                    LDP0    @VIP,,AUTO
         1 001061   000020 236100                    LDQ     16,,PR0
         1 001062   006000 376007                    ANQ     3072,DL
         1 001063   006000 116007                    CMPQ    3072,DL
         1 001064   001067 601000 1                  TNZ     s:570

    569  1 001065   200034 221300                    LDX1  ! PART+2,,AUTO
         1 001066   000001 702211                    TSX2  ! 1,X1

     1429      570    4              DO J=2 TO VIP.NSECTS;

    570  1 001067   000002 236007                    LDQ     2,DL
         1 001070   200007 756100                    STQ     J,,AUTO
         1 001071   001146 710000 1                  TRA     s:580+1

     1430      571    5                 DO PART=1 TO 3;

    571  1 001072   000001 235007                    LDA     1,DL
         1 001073   200032 755100                    STA     PART,,AUTO

     1431      572    5                    RUNBYT=RUNBYT+TALLY(PART);

    572  1 001074   200032 720100                    LXL0    PART,,AUTO
         1 001075   200015 236100                    LDQ     RUNBYT,,AUTO
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:305  
         1 001076   000000 036010 0                  ADLQ    TALLY,X0
         1 001077   200015 756100                    STQ     RUNBYT,,AUTO

     1432      573    5                    IF POS(DPN-1) <= RUNBYT THEN CALL SKPOS;

    573  1 001100   200016 721100                    LXL1    DPN,,AUTO
         1 001101   200017 236111                    LDQ     DPSEC,X1,AUTO
         1 001102   000024 772000                    QRL     20
         1 001103   200015 116100                    CMPQ    RUNBYT,,AUTO
         1 001104   001107 605400 1                  TPNZ    s:574

    573  1 001105   001155 701000 1                  TSX1    SKPOS
         1 001106   000000 011000                    NOP     0

     1433      574    5                    IF DPN > DEFNO THEN PART=3;

    574  1 001107   200016 236100                    LDQ     DPN,,AUTO
         1 001110   200030 116100                    CMPQ    DEFNO,,AUTO
         1 001111   001114 604400 1                  TMOZ    s:575

    574  1 001112   000003 235007                    LDA     3,DL
         1 001113   200032 755100                    STA     PART,,AUTO

     1434      575    5                    END;

    575  1 001114   200032 054100                    AOS     PART,,AUTO
         1 001115   200032 235100                    LDA     PART,,AUTO
         1 001116   000003 115007                    CMPA    3,DL
         1 001117   001074 604400 1                  TMOZ    s:572

     1435      576    4                 CF.C.SKP(J-2)=SKIP;

    576  1 001120   200007 235100                    LDA     J,,AUTO
         1 001121   000001 735000                    ALS     1
         1 001122   000044 733000                    LRS     36
         1 001123   000044 402007                    MPY     36,DL
         1 001124   000000 116003                    CMPQ    0,DU
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:306  
         1 001125   001127 605000 1                  TPL     s:576+7
         1 001126   000044 036003                    ADLQ    36,DU
         1 001127   200012 470500                    LDP0    HDR5$,,AUTO
         1 001130   003106 060500                    CSL     bolr='003'O
         1 001131   200014 000040                    BDSC    SKIP,,AUTO               by=0,bit=0,n=32
         1 001132   000000 650040                    BDSC    0,Q,PR0                  by=3,bit=5,n=32

     1436      577    4                 SKIP='0'B; DPSEC=0;

    577  1 001133   000017 236007                    LDQ     15,DL
         1 001134   200014 356100                    ANSQ    SKIP,,AUTO

    577  1 001135   200017 450100                    STZ     DPSEC,,AUTO

     1437      578
     1438      579    4                 IF DPN > DEFNO THEN J=VIP.NSECTS;

    579  1 001136   200016 236100                    LDQ     DPN,,AUTO
         1 001137   200030 116100                    CMPQ    DEFNO,,AUTO
         1 001140   001145 604400 1                  TMOZ    s:580

    579  1 001141   200003 471500                    LDP1    @VIP,,AUTO
         1 001142   100014 236100                    LDQ     12,,PR1
         1 001143   000033 772000                    QRL     27
         1 001144   200007 756100                    STQ     J,,AUTO

     1439      580    4                 END;

    580  1 001145   200007 054100                    AOS     J,,AUTO
         1 001146   200003 470500                    LDP0    @VIP,,AUTO
         1 001147   000014 236100                    LDQ     12,,PR0
         1 001150   000033 772000                    QRL     27
         1 001151   200007 116100                    CMPQ    J,,AUTO
         1 001152   001072 605000 1                  TPL     s:571

     1440      581    3              END;                         /* DEFNO ~=0 */

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:307  
     1441      582    2   END HDR5XX;

    582  1 001153   200034 221300                    LDX1  ! PART+2,,AUTO
         1 001154   000001 702211                    TSX2  ! 1,X1

     1442      583        %EJECT;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:308  
     1443      584    1   SKPOS:  PROC;

    584  1 001155   200036 741300       SKPOS        STX1  ! PART+4,,AUTO

     1444      585
     1445      586    2   DCL REMN SBIN ALIGNED;
     1446      587    2   DCL 1 MPI REDEF REMN,                   /* CORRECTION FOR MPI */
     1447      588    2         2 * BIT(34) UNAL,
     1448      589    2         2 CR BIT(2) UNAL;
     1449      590
     1450      591    3           IF DPSEC < 2 THEN DO;

    591  1 001156   200017 235100                    LDA     DPSEC,,AUTO
         1 001157   000002 115007                    CMPA    2,DL
         1 001160   001273 605000 1                  TPL     s:615

     1451      592    4              DO CASE(PART);

    592  1 001161   200032 236100                    LDQ     PART,,AUTO
         1 001162   000003 116007                    CMPQ    3,DL
         1 001163   001165 602006 1                  TNC     s:592+4,QL
         1 001164   001252 710000 1                  TRA     s:609
         1 001165   001252 710000 1                  TRA     s:609
         1 001166   001252 710000 1                  TRA     s:609
         1 001167   001170 710000 1                  TRA     s:594

     1452      593    4               CASE (2);

     1453      594    4                 REMN=POS(DPN-1)-RUNBYT+6; /* EDAC HAS 6 BYTES IN DATA PART */

    594  1 001170   200016 720100                    LXL0    DPN,,AUTO
         1 001171   200017 236110                    LDQ     DPSEC,X0,AUTO
         1 001172   000024 772000                    QRL     20
         1 001173   200015 136100                    SBLQ    RUNBYT,,AUTO
         1 001174   000006 036007                    ADLQ    6,DL
         1 001175   200037 756100                    STQ     REMN,,AUTO

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:309  
     1454      595    4                 IF REMN > 0 THEN

    595  1 001176   001206 604400 1                  TMOZ    s:597

     1455      596    4                    SKIP.S(DPSEC)=DP(3);   /* ASSIGN DEFECT TO PART 3 */

    596  1 001177   000004 735000                    ALS     4
         1 001200   001202 605000 1                  TPL     s:596+3
         1 001201   000044 035003                    ADLA    36,DU
         1 001202   003105 060400                    CSL     bolr='003'O
         1 001203   000004 230004 0                  BDSC    DP                       by=1,bit=3,n=4
         1 001204   200014 000004                    BDSC    SKIP,A,AUTO              by=0,bit=0,n=4
         1 001205   001265 710000 1                  TRA     s:611

     1456      597    5                 ELSE IF (REMN >= -2304) AND (REMN <= -2301) THEN DO;

    597  1 001206   000010 116000 2                  CMPQ    8
         1 001207   001226 604000 1                  TMI     s:603
         1 001210   000011 116000 2                  CMPQ    9
         1 001211   001226 605400 1                  TPNZ    s:603

     1457      598    5                       SKIP.S(DPSEC)=DP(1); /* ASSIGN DEFECT TO PART 1 */

    598  1 001212   000004 735000                    ALS     4
         1 001213   001215 605000 1                  TPL     s:598+3
         1 001214   000044 035003                    ADLA    36,DU
         1 001215   003105 060400                    CSL     bolr='003'O
         1 001216   000004 040004 0                  BDSC    DP                       by=0,bit=4,n=4
         1 001217   200014 000004                    BDSC    SKIP,A,AUTO              by=0,bit=0,n=4

     1458      599    5                       PART=2;

    599  1 001220   000002 235007                    LDA     2,DL
         1 001221   200032 755100                    STA     PART,,AUTO

     1459      600    5                       RUNBYT=RUNBYT-TALLY(PART);

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:310  
    600  1 001222   200015 236100                    LDQ     RUNBYT,,AUTO
         1 001223   000000 136005 0                  SBLQ    TALLY,AL
         1 001224   200015 756100                    STQ     RUNBYT,,AUTO

     1460      601    5                       END;

    601  1 001225   001265 710000 1                  TRA     s:611

     1461      602    5                    ELSE DO;               /* DEFECT IN DATA PART, SPLIT DATA. */

     1462      603    5                       RUNBYT=RUNBYT+2;    /* FOR HEX 19 & SYNC BYTE */

    603  1 001226   000002 236007                    LDQ     2,DL
         1 001227   200015 056100                    ASQ     RUNBYT,,AUTO

     1463      604    5                       SKIP.S(DPSEC)=DP(2);

    604  1 001230   000004 735000                    ALS     4
         1 001231   001233 605000 1                  TPL     s:604+3
         1 001232   000044 035003                    ADLA    36,DU
         1 001233   003105 060400                    CSL     bolr='003'O
         1 001234   000004 100004 0                  BDSC    DP                       by=0,bit=8,n=4
         1 001235   200014 000004                    BDSC    SKIP,A,AUTO              by=0,bit=0,n=4

     1464      605    5                       MPI.CR='01'B;

    605  1 001236   200037 236100                    LDQ     REMN,,AUTO
         1 001237   000012 376000 2                  ANQ     10
         1 001240   000001 276007                    ORQ     1,DL
         1 001241   200037 756100                    STQ     REMN,,AUTO

     1465      606    5                       SKIP.SK(DPSEC)=REMN; /* REMAIN GOOD DATA BYTES */

    606  1 001242   200017 235100                    LDA     DPSEC,,AUTO
         1 001243   000004 735000                    ALS     4
         1 001244   001246 605000 1                  TPL     s:606+4
         1 001245   000044 035003                    ADLA    36,DU
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:311  
         1 001246   003105 061500                    CSR     bolr='003'O
         1 001247   200037 000044                    BDSC    REMN,,AUTO               by=0,bit=0,n=36
         1 001250   200014 040014                    BDSC    SKIP,A,AUTO              by=0,bit=4,n=12

     1466      607    5                       END;

    607  1 001251   001265 710000 1                  TRA     s:611

     1467      608    4               CASE(ELSE);

     1468      609    4                 SKIP.S(DPSEC)=DP(PART);

    609  1 001252   200032 235100                    LDA     PART,,AUTO
         1 001253   000002 735000                    ALS     2
         1 001254   001256 605000 1                  TPL     s:609+4
         1 001255   000044 035003                    ADLA    36,DU
         1 001256   200017 236100                    LDQ     DPSEC,,AUTO
         1 001257   000004 736000                    QLS     4
         1 001260   001262 605000 1                  TPL     s:609+8
         1 001261   000044 036003                    ADLQ    36,DU
         1 001262   003106 060405                    CSL     bolr='003'O
         1 001263   000004 000004 0                  BDSC    DP,A                     by=0,bit=0,n=4
         1 001264   200014 000004                    BDSC    SKIP,Q,AUTO              by=0,bit=0,n=4

     1469      610    4               END;

     1470      611    3              DPSEC=DPSEC+1;

    611  1 001265   200017 054100                    AOS     DPSEC,,AUTO

     1471      612    3              RUNBYT=RUNBYT+SKIPLTH;

    612  1 001266   200015 236100                    LDQ     RUNBYT,,AUTO
         1 001267   000005 036000 0                  ADLQ    SKIPLTH
         1 001270   200015 756100                    STQ     RUNBYT,,AUTO

     1472      613    3              DPN=DPN+1;
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:312  

    613  1 001271   200016 054100                    AOS     DPN,,AUTO

     1473      614    3              END;

    614  1 001272   001275 710000 1                  TRA     s:616

     1474      615    2           ELSE CALL MARKDTT;

    615  1 001273   001331 701000 1                  TSX1    MARKDTT
         1 001274   000000 011000                    NOP     0

     1475      616    2   END SKPOS;

    616  1 001275   200036 221300                    LDX1  ! PART+4,,AUTO
         1 001276   000001 702211                    TSX2  ! 1,X1

     1476      617
     1477      618
     1478      619    1   POS_VALU: PROC(POS,LTH);

    619  1 001277   200036 741300       POS_VALU     STX1  ! PART+4,,AUTO

     1479      620    2   DCL POS UBIN(16);
     1480      621    2   DCL LTH UBIN(8);
     1481      622
     1482      623    2           IF LTH=255 THEN POS=0;

    623  1 001300   200040 470500                    LDP0    @LTH,,AUTO
         1 001301   000000 236100                    LDQ     0,,PR0
         1 001302   776000 376003                    ANQ     -1024,DU
         1 001303   776000 116003                    CMPQ    -1024,DU
         1 001304   001310 601000 1                  TNZ     s:625

    623  1 001305   200037 471500                    LDP1    @POS,,AUTO
         1 001306   100000 450100                    STZ     0,,PR1
         1 001307   001327 710000 1                  TRA     s:631
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:313  

     1483      624    3           ELSE DO;

     1484      625    3              IF POS=0 THEN POS=32;

    625  1 001310   200037 471500                    LDP1    @POS,,AUTO
         1 001311   100000 236100                    LDQ     0,,PR1
         1 001312   777774 316003                    CANQ    -4,DU
         1 001313   001317 601000 1                  TNZ     s:627

    625  1 001314   000200 236003                    LDQ     128,DU
         1 001315   100000 756100                    STQ     0,,PR1
         1 001316   001325 710000 1                  TRA     s:629

     1485      626    3              ELSE
     1486      627    3                 IF POS >= (19968-32) THEN

    627  1 001317   100000 236100                    LDQ     0,,PR1
         1 001320   777774 376003                    ANQ     -4,DU
         1 001321   233600 116003                    CMPQ    79744,DU
         1 001322   001325 602000 1                  TNC     s:629

     1487      628    3                    POS = 19968-32;        /* TOTAL BYTE PER TRACK IS 19968 */

    628  1 001323   233600 236003                    LDQ     79744,DU
         1 001324   100000 756100                    STQ     0,,PR1

     1488      629    3              LTH=40;

    629  1 001325   120000 236003                    LDQ     40960,DU
         1 001326   000000 756100                    STQ     0,,PR0

     1489      630    3              END;

     1490      631    2   END POS_VALU;

    631  1 001327   200036 221300                    LDX1  ! PART+4,,AUTO
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:314  
         1 001330   000001 702211                    TSX2  ! 1,X1

     1491      632
     1492      633
     1493      634    1   MARKDTT: PROC;

    634  1 001331   200040 741300       MARKDTT      STX1  ! @LTH,,AUTO

     1494      635
     1495      636    2           VIP.LOGX=VIP.LOGX-5;       /* BACK OFF 5 ERROR LOG INDEX FOR RETRY */

    636  1 001332   200003 470500                    LDP0    @VIP,,AUTO
         1 001333   000005 336007                    LCQ     5,DL
         1 001334   000004 056100                    ASQ     4,,PR0

     1496      637    2           VIP.FLAG.TI='11'B;

    637  1 001335   006000 236007                    LDQ     3072,DL
         1 001336   000020 256100                    ORSQ    16,,PR0

     1497      638    2           CF.C0.FLAG=VIP.FLAG;

    638  1 001337   200012 471500                    LDP1    HDR5$,,AUTO
         1 001340   000020 236100                    LDQ     16,,PR0
         1 001341   000022 736000                    QLS     18
         1 001342   100000 676100                    ERQ     0,,PR1
         1 001343   776000 376003                    ANQ     -1024,DU
         1 001344   100000 656100                    ERSQ    0,,PR1

     1498      639    2           CF.C0.CONDFLAG='0'B;

    639  1 001345   000006 236000 2                  LDQ     6
         1 001346   100003 356100                    ANSQ    3,,PR1

     1499      640    3           DO I=0 TO VIP.NSECTS-2;

    640  1 001347   200006 450100                    STZ     I,,AUTO
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:315  
         1 001350   001367 710000 1                  TRA     s:646+1

     1500      641    3              CF.C.FLAG(I)='0'B;

    641  1 001351   200006 235100                    LDA     I,,AUTO
         1 001352   000001 735000                    ALS     1
         1 001353   200012 470500                    LDP0    HDR5$,,AUTO
         1 001354   000013 236000 2                  LDQ     11
         1 001355   000004 356105                    ANSQ    4,AL,PR0

     1501      642    3              CF.C.CONDFLAG(I)='0'B;

    642  1 001356   000006 236000 2                  LDQ     6
         1 001357   000005 356105                    ANSQ    5,AL,PR0

     1502      643    3              CF.C.REC(I)=0;

    643  1 001360   000005 236000 2                  LDQ     5
         1 001361   000004 356105                    ANSQ    4,AL,PR0

     1503      644    3              CF.C.CYL(I)='0'B;

    644  1 001362   000014 236000 2                  LDQ     12
         1 001363   000004 356105                    ANSQ    4,AL,PR0

     1504      645    3              CF.C.HD(I)=0;

    645  1 001364   000015 236000 2                  LDQ     13
         1 001365   000004 356105                    ANSQ    4,AL,PR0

     1505      646    3              END;

    646  1 001366   200006 054100                    AOS     I,,AUTO
         1 001367   200003 470500                    LDP0    @VIP,,AUTO
         1 001370   000014 236100                    LDQ     12,,PR0
         1 001371   000033 772000                    QRL     27
         1 001372   000002 136007                    SBLQ    2,DL
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:316  
         1 001373   200006 116100                    CMPQ    I,,AUTO
         1 001374   001351 605000 1                  TPL     s:641

     1506      647    2           FMT.SEEK.TI=VIP.FLAG.TI;

    647  1 001375   200005 471500                    LDP1    FMT$,,AUTO
         1 001376   000020 236100                    LDQ     16,,PR0
         1 001377   000014 736000                    QLS     12
         1 001400   100007 676100                    ERQ     7,,PR1
         1 001401   000060 376003                    ANQ     48,DU
         1 001402   100007 656100                    ERSQ    7,,PR1

     1507      648    2           VID$=VIP.VID$;

    648  1 001403   000012 236100                    LDQ     10,,PR0
         1 001404   200011 756100                    STQ     VID$,,AUTO

     1508      649    3           DO I=0 TO 62;

    649  1 001405   200006 450100                    STZ     I,,AUTO

     1509      650    4              IF VID.DTT(I)=BITBIN('777777'O) THEN DO;

    650  1 001406   200011 470500                    LDP0    VID$,,AUTO
         1 001407   200006 720100                    LXL0    I,,AUTO
         1 001410   000400 221110                    LDX1    256,X0,PR0
         1 001411   777777 101003                    CMPX1   -1,DU
         1 001412   001422 601000 1                  TNZ     s:655

     1510      651    4                 VID.DTT(I)=VIP.CTRACK;

    651  1 001413   200003 471500                    LDP1    @VIP,,AUTO
         1 001414   100016 222100                    LDX2    14,,PR1
         1 001415   000400 742110                    STX2    256,X0,PR0

     1511      652    4                 VIP.DTTCH='1'B;

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:317  
    652  1 001416   004000 236007                    LDQ     2048,DL
         1 001417   100017 256100                    ORSQ    15,,PR1

     1512      653    4                 RETURN;

    653  1 001420   200040 221300                    LDX1  ! @LTH,,AUTO
         1 001421   000001 702211                    TSX2  ! 1,X1

     1513      654    4                 END;
     1514      655    3              END;

    655  1 001422   200006 054100                    AOS     I,,AUTO
         1 001423   200006 235100                    LDA     I,,AUTO
         1 001424   000076 115007                    CMPA    62,DL
         1 001425   001406 604400 1                  TMOZ    s:650

     1515      656    2           VIP.DTTOVF='1'B;

    656  1 001426   200003 471500                    LDP1    @VIP,,AUTO
         1 001427   002000 236007                    LDQ     1024,DL
         1 001430   100017 256100                    ORSQ    15,,PR1

     1516      657    2           VIP.STOP='1'B;

    657  1 001431   010000 236007                    LDQ     4096,DL
         1 001432   100017 256100                    ORSQ    15,,PR1

     1517      658    2           RETURN;

    658  1 001433   200040 221300                    LDX1  ! @LTH,,AUTO
         1 001434   000001 702211                    TSX2  ! 1,X1

TALLY
 Sect OctLoc
   0     000   000000 000251   000000 000100   000000 004406   000000 000121    .......@.......Q

DP
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:318  
 Sect OctLoc
   0     004   051010 ******                                                    )...

SKIPLTH
 Sect OctLoc
   0     005   000000 000100                                                    ...@

(unnamed)
 Sect OctLoc
   0     006   115123 125060   065060 061040   115123 125060   065060 071040    MSU0501 MSU0509

(unnamed)
 Sect OctLoc
   2     000   000007 777777   777717 777777   000003 777760   000077 777400    .............?..
   2     004   777777 001777   777777 770017   777777 777400   037777 600000    ................
   2     010   777777 773400   777777 773403   777777 777774   001777 777777    ................
   2     014   776000 777777   777777 007777                                    ........
     1518      659    2   END MARKDTT;
     1519      660
     1520      661
     1521      662    1   END IVV$HEADER;
     1522      663        %EOD;

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:319  
--  Include file information  --

   IV$MACROS.:E05TOU  is referenced.
   FM$GRAN.:E05TOU  is referenced.
      No diagnostics issued in procedure IVV$HEADER.
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:320  

 **** Variables and constants ****

  ****  Section 000 RoData IVV$HEADER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/b BIT (4)     r     1 DP(0:3)                    5-0-0/w SBIN        r     1 SKIPLTH
     0-0-0/w SBIN        r     1 TALLY(0:3)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    40-0-0/w PTR         r     1 @LTH                      37-0-0/w PTR         r     1 @POS
     3-0-0/w PTR         r     1 @VIP                       4-0-0/b BIT (6)     r     1 CK
    13-0-0/w PTR         r     1 DATA$                     30-0-0/w SBIN        r     1 DEFNO
    16-0-0/w SBIN        r     1 DPN                       17-0-0/w SBIN        r     1 DPSEC
     5-0-0/w PTR         r     1 FMT$                      12-0-0/w PTR         r     1 HDR5$
     6-0-0/w SBIN        r     1 I                          7-0-0/w SBIN        r     1 J
    24-0-0/w UBIN(8)     r     1 LTH(0:3)                  *0-0-0/w UBIN(8)     r     1 LTH
    37-0-0/w STRC        r     1 MPI                       32-0-0/w SBIN        r     1 PART
    20-0-0/w UBIN(16)    r     1 POS(0:3)                  *0-0-0/w UBIN(16)    r     1 POS
    37-0-0/w SBIN        r     1 REMN                      15-0-0/w SBIN        r     1 RUNBYT
    14-0-0/b STRC(16)    r     1 SKIP(0:1)                 10-0-0/w STRC        r     1 TR
    10-0-0/w SBIN        r     1 TRACK                     11-0-0/w PTR         r     1 VID$
    *0-0-0/w STRC(3024)  r     1 VIP

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(2952)  r     1 CF                         0-0-0/w STRC(828)   r     1 FMT
     0-0-0/b STRC(48)    r     1 LOG(0:3071)                0-0-0/w STRC(36864) r     1 VID

PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:321  

   Procedure IVV$HEADER requires 797 words for executable code.
   Procedure IVV$HEADER requires 42 words of local(AUTO) storage.
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:322  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:323  
          MINI XREF LISTING

CF
       399**DCL       496<<ASSIGN
CF.C.CONDFLAG
       424**DCL       511<<ASSIGN    518<<ASSIGN    642<<ASSIGN
CF.C.CYL
       418**DCL       644<<ASSIGN
CF.C.CYL.LWR
       419**DCL       507<<ASSIGN    514<<ASSIGN
CF.C.CYL.UPR
       420**DCL       508<<ASSIGN    515<<ASSIGN
CF.C.FLAG
       417**DCL       506<<ASSIGN    513<<ASSIGN    641<<ASSIGN
CF.C.HD
       421**DCL       509<<ASSIGN    516<<ASSIGN    645<<ASSIGN
CF.C.REC
       422**DCL       510<<ASSIGN    517<<ASSIGN    517>>ASSIGN    643<<ASSIGN
CF.C.SKP
       423**DCL       576<<ASSIGN
CF.C0.CONDFLAG
       415**DCL       502<<ASSIGN    639<<ASSIGN
CF.C0.CYL.LWR
       403**DCL       497<<ASSIGN
CF.C0.CYL.UPR
       404**DCL       498<<ASSIGN
CF.C0.FLAG
       401**DCL       500<<ASSIGN    513>>ASSIGN    638<<ASSIGN
CF.C0.HD
       405**DCL       499<<ASSIGN
CF.C0.REC
       406**DCL       501<<ASSIGN
CF.C0.SKP
       407**DCL       566<<ASSIGN
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:324  
CF.C0.TSKIP
       410**DCL       411--REDEF     553<<ASSIGN    555<<ASSIGN
CF.C0.TSKP.G
       412**DCL       504<<ASSIGN
CK
       386**DCL       483<<ASSIGN    485<<ASSIGN    485>>ASSIGN    485>>ASSIGN    487>>ASSIGN
DATA$
       397**DCL       427--IMP-PTR   456<<ASSIGN    530>>DOWHILE   532>>DOWHILE   532>>DOWHILE   533>>DOWHILE
       533>>DOWHILE   536>>ASSIGN    537>>ASSIGN    542>>IF        542>>IF        542>>IF
DEFECTIVE
       470**LABEL     465--GOTO
DEFNO
       447**DCL       528<<ASSIGN    536>>ASSIGN    537>>ASSIGN    538>>CALL      538>>CALL      539<<ASSIGN
       539>>ASSIGN    547>>IF        548>>IF        548>>IF        550>>ASSIGN    563>>IF        569>>IF
       574>>IF        579>>IF
DP
       439**DCL       596>>ASSIGN    598>>ASSIGN    604>>ASSIGN    609>>ASSIGN
DPN
       442**DCL       559<<ASSIGN    562>>IF        563>>IF        565>>IF        569>>IF        573>>IF
       574>>IF        579>>IF        594>>ASSIGN    613<<ASSIGN    613>>ASSIGN
DPSEC
       443**DCL       559<<ASSIGN    567<<ASSIGN    577<<ASSIGN    591>>IF        596>>ASSIGN    598>>ASSIGN
       604>>ASSIGN    606>>ASSIGN    609>>ASSIGN    611<<ASSIGN    611>>ASSIGN
DTT_FOUND
       477**LABEL     471--GOTO
FMT
       322**DCL       456--ASSIGN
FMT.CKBYTES
       374**DCL       485>>ASSIGN    485>>ASSIGN
FMT.HEADER
       358**DCL       374--REDEF     375--REDEF     495--ASSIGN
FMT.HEADER.CHECK
       371**DCL       487<<ASSIGN
FMT.HEADER.CYL
       359**DCL       477<<ASSIGN    481>>ASSIGN
FMT.HEADER.HD
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:325  
       360**DCL       478<<ASSIGN    482>>ASSIGN
FMT.HEADER.R0.CYL
       367**DCL       481<<ASSIGN
FMT.HEADER.R0.HD
       368**DCL       482<<ASSIGN
FMT.HEADER.TI
       363**DCL       480<<ASSIGN
FMT.HEADER.Z
       362**DCL       479<<ASSIGN
FMT.SEEK.SEC.CL
       346**DCL       497>>ASSIGN    507>>ASSIGN    514>>ASSIGN
FMT.SEEK.SEC.CU
       347**DCL       498>>ASSIGN    508>>ASSIGN    515>>ASSIGN
FMT.SEEK.SEC.HD
       348**DCL       499>>ASSIGN    509>>ASSIGN    516>>ASSIGN
FMT.SEEK.SECTOR
       342**DCL       343--REDEF     462>>ASSIGN
FMT.SEEK.TI
       340**DCL       470<<ASSIGN    475<<ASSIGN    480>>ASSIGN    493<<ASSIGN    647<<ASSIGN
FMT$
       387**DCL       322--IMP-PTR   454<<ASSIGN    462>>ASSIGN    470>>ASSIGN    475>>ASSIGN    477>>ASSIGN
       478>>ASSIGN    479>>ASSIGN    480>>ASSIGN    480>>ASSIGN    481>>ASSIGN    481>>ASSIGN    482>>ASSIGN
       482>>ASSIGN    485>>ASSIGN    485>>ASSIGN    487>>ASSIGN    493>>ASSIGN    495>>ASSIGN    497>>ASSIGN
       498>>ASSIGN    499>>ASSIGN    507>>ASSIGN    508>>ASSIGN    509>>ASSIGN    514>>ASSIGN    515>>ASSIGN
       516>>ASSIGN    647>>ASSIGN
HDR5$
       396**DCL       399--IMP-PTR   495<<ASSIGN    496>>ASSIGN    497>>ASSIGN    498>>ASSIGN    499>>ASSIGN
       500>>ASSIGN    501>>ASSIGN    502>>ASSIGN    504>>ASSIGN    506>>ASSIGN    507>>ASSIGN    508>>ASSIGN
       509>>ASSIGN    510>>ASSIGN    511>>ASSIGN    513>>ASSIGN    513>>ASSIGN    514>>ASSIGN    515>>ASSIGN
       516>>ASSIGN    517>>ASSIGN    517>>ASSIGN    518>>ASSIGN    553>>ASSIGN    555>>ASSIGN    566>>ASSIGN
       576>>ASSIGN    638>>ASSIGN    639>>ASSIGN    641>>ASSIGN    642>>ASSIGN    643>>ASSIGN    644>>ASSIGN
       645>>ASSIGN
HDR5XX
       523**PROC      460--CALL
I
       388**DCL       466<<ASSIGN    467>>DOWHILE   467>>DOWHILE   468>>IF        473<<ASSIGN    473>>ASSIGN
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:326  
       484<<DOINDEX   485>>ASSIGN    485>>ASSIGN    503<<DOINDEX   504>>ASSIGN    512<<DOINDEX   513>>ASSIGN
       514>>ASSIGN    515>>ASSIGN    516>>ASSIGN    517>>ASSIGN    517>>ASSIGN    518>>ASSIGN    525<<DOINDEX
       526>>ASSIGN    526>>ASSIGN    550<<ASSIGN    555>>ASSIGN    557<<ASSIGN    557>>ASSIGN    640<<DOINDEX
       641>>ASSIGN    642>>ASSIGN    643>>ASSIGN    644>>ASSIGN    645>>ASSIGN    649<<DOINDEX   650>>IF
       651>>ASSIGN
INITHDR
       492**PROC      459--CALL
J
       389**DCL       462<<ASSIGN    463>>ASSIGN    464>>ASSIGN    550<<ASSIGN    550>>ASSIGN    551>>DOUNTIL
       552>>IF        553>>IF        555>>ASSIGN    555>>ASSIGN    557<<ASSIGN    557>>ASSIGN    570<<DOINDEX
       576>>ASSIGN    579<<ASSIGN
LOG
       427**DCL       530>>DOWHILE   533>>DOWHILE   533>>DOWHILE
LOG.CYL
       429**DCL       532>>DOWHILE   542>>IF        542>>IF
LOG.HD
       430**DCL       532>>DOWHILE   542>>IF
LOG.LTH
       432**DCL       537>>ASSIGN
LOG.POS
       431**DCL       536>>ASSIGN
LOGGED IN PROCEDURE HDR5XX
       547**LABEL     545--GOTO
LTH
       446**DCL       526<<ASSIGN    537<<ASSIGN    538<>CALL      548>>IF        552>>IF
LTH IN PROCEDURE POS_VALU
       621**DCL       619--PROC      623>>IF        629<<ASSIGN
MARKDTT
       634**PROC      549--CALL      615--CALL
MPI.CR IN PROCEDURE SKPOS
       589**DCL       605<<ASSIGN
PART
       449**DCL       560<<DOINDEX   561>>ASSIGN    563<<ASSIGN    571<<DOINDEX   572>>ASSIGN    574<<ASSIGN
       592>>DOCASE    599<<ASSIGN    600>>ASSIGN    609>>ASSIGN
POS
       445**DCL       526<<ASSIGN    536<<ASSIGN    538<>CALL      553>>ASSIGN    555>>ASSIGN    555>>ASSIGN
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:327  
       562>>IF        573>>IF        594>>ASSIGN
POS IN PROCEDURE POS_VALU
       620**DCL       619--PROC      623<<ASSIGN    625>>IF        625<<ASSIGN    627>>IF        628<<ASSIGN
POS_VALU
       619**PROC      538--CALL
REMN IN PROCEDURE SKPOS
       586**DCL       587--REDEF     594<<ASSIGN    595>>IF        597>>IF        597>>IF        606>>ASSIGN
RUNBYT
       441**DCL       559<<ASSIGN    561<<ASSIGN    561>>ASSIGN    562>>IF        572<<ASSIGN    572>>ASSIGN
       573>>IF        594>>ASSIGN    600<<ASSIGN    600>>ASSIGN    603<<ASSIGN    603>>ASSIGN    612<<ASSIGN
       612>>ASSIGN
SKIP
       434**DCL       528<<ASSIGN    566>>ASSIGN    567<<ASSIGN    576>>ASSIGN    577<<ASSIGN
SKIP.S
       435**DCL       596<<ASSIGN    598<<ASSIGN    604<<ASSIGN    609<<ASSIGN
SKIP.SK
       436**DCL       606<<ASSIGN
SKIPLTH
       444**DCL       612>>ASSIGN
SKPOS
       584**PROC      562--CALL      573--CALL
TALLY
       438**DCL       561>>ASSIGN    572>>ASSIGN    600>>ASSIGN
TR.CYL
       393**DCL       463<<ASSIGN    477>>ASSIGN    529<<ASSIGN    532>>DOWHILE   542>>IF        542>>IF
TR.HD
       394**DCL       464<<ASSIGN    478>>ASSIGN    529<<ASSIGN    532>>DOWHILE   542>>IF
TRACK
       390**DCL       391--REDEF     468>>IF
VID.DTT
       380**DCL       380--REDEF     467>>DOWHILE   468>>IF        650>>IF        651<<ASSIGN
VID$
       395**DCL       378--IMP-PTR   455<<ASSIGN    467>>DOWHILE   468>>IF        648<<ASSIGN    650>>IF
       651>>ASSIGN
VIP
       255**DCL         8--PROC
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:328  
VIP.CTR.CYL
       273**DCL       529>>ASSIGN
VIP.CTR.HD
       274**DCL       529>>ASSIGN
VIP.CTRACK
       271**DCL       272--REDEF     651>>ASSIGN
VIP.DISKERR
       286**DCL       465>>IF
VIP.DTTCH
       284**DCL       652<<ASSIGN
VIP.DTTOVF
       285**DCL       656<<ASSIGN
VIP.ELT$
       259**DCL       456>>ASSIGN
VIP.FLAG
       292**DCL       494<<ASSIGN    500>>ASSIGN    506>>ASSIGN    638>>ASSIGN
VIP.FLAG.F512
       293**DCL       494<<ASSIGN
VIP.FLAG.MTAR
       294**DCL       494<<ASSIGN
VIP.FLAG.TI
       297**DCL       569>>IF        637<<ASSIGN    647>>ASSIGN
VIP.FMT$
       265**DCL       454>>ASSIGN
VIP.LOGX
       260**DCL       530>>DOWHILE   530>>DOWHILE   532>>DOWHILE   532>>DOWHILE   533>>DOWHILE   533>>DOWHILE
       534<<ASSIGN    534>>ASSIGN    536>>ASSIGN    537>>ASSIGN    540<<ASSIGN    540>>ASSIGN    542>>IF
       542>>IF        542>>IF        544<<ASSIGN    544>>ASSIGN    636<<ASSIGN    636>>ASSIGN
VIP.MODEL
       262**DCL       457>>DOSELCT
VIP.NHEADS
       267**DCL       463>>ASSIGN    464>>ASSIGN
VIP.NSECTS
       266**DCL       462>>ASSIGN    512>>DOINDEX   570>>DOINDEX   579>>ASSIGN    640>>DOINDEX
VIP.RANGE.FTRACK
       309**DCL       310--REDEF
PL6.E3A0      #005=IVV$HEADER File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:19 Page:329  
VIP.RANGE.LTRACK
       313**DCL       314--REDEF
VIP.STOP
       283**DCL       657<<ASSIGN
VIP.VERIFY
       279**DCL       479>>ASSIGN
VIP.VID$
       264**DCL       455>>ASSIGN    648>>ASSIGN

PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:330  
     1523        1        /*T***********************************************************/
     1524        2        /*T*                                                         */
     1525        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1526        4        /*T*                                                         */
     1527        5        /*T***********************************************************/
     1528        6        /* FORMAT NEXT TRACK */
     1529        7        /**/
     1530        8        IVV$NEXT: PROC (VIP,TYC) ALTRET;
     1531        9        /**/
     1532       10        /* INCLUDE FILES */
     1533       11        /**/
     1534       12        %INCLUDE CP_6_SUBS;
     1535      552        %INCLUDE FM$GRAN;
     1536      621        %INCLUDE IV$MACROS;
     1537      791        %INCLUDE NI$TABLES;
     1538     1007        /**/
     1539     1008                                           /* Storage structure for MSU050X header */
     1540     1009    1   DCL HDR5$ PTR;
     1541     1010    1   DCL DATA$ PTR;
     1542     1011        %IV$HDR(NAME=CF,STCLASS="BASED(HDR5$)");
     1543     1039
     1544     1040    1   DCL 1 SKIP(0:1) UNAL,
     1545     1041    1         2 S BIT(4),
     1546     1042    1         2 SK UBIN(12);
     1547     1043
     1548     1044        /**/
     1549     1045        /* PARAMETERS */
     1550     1046        /**/
     1551     1047        %IV$VIP(NAME=VIP,STCLASS="");
     1552     1111    1   DCL TYC BIT(36) ALIGNED;
     1553     1112        /**/
     1554     1113        /* EXTERNAL REFERENCES */
     1555     1114        /**/
     1556     1115    1   DCL IVV$HEADER ENTRY (1);
     1557     1116    1   DCL IVO$READ_ELT ENTRY (1) ALTRET;
     1558     1117    1   DCL DCWBUILD ENTRY(3);
     1559     1118    1   DCL IVO$GET ENTRY (2) ALTRET;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:331  
     1560     1119    1   DCL IVV$ERROR ENTRY (3);
     1561     1120    1   DCL IVV$FMTPAC ENTRY (2) ALTRET;
     1562     1121    1   DCL IVO$PRINT ENTRY (2) ALTRET;
     1563     1122    1   DCL IVV$BINDEC ENTRY (4);
     1564     1123        /**/
     1565     1124        /* SUBSTITUTIONS */
     1566     1125        %EQU FORMAT='17'O;                      /* DISK FORMAT TRACK COMMAND */
     1567     1126        %EQU WRCMP='33'O;                       /* DISK WRITE & COMPARE COMMAND */
     1568     1127        %EQU WRASC='32'O;                       /* DISK WRITE ASCII COMMAND */
     1569     1128        %EQU DP_TDSEEK512='35'O;                /* DISK SEEK OF 512 FORMAT COMMAND */
     1570     1129        %EQU RDHEADER='27'O;                    /* READ TRACK HEADER COMMAND */
     1571     1130        %EQU RDBIN='25'O;                       /* READ ELT DATA IN BINA COMMAND */
     1572     1131        /* DATA STRUCTURES */
     1573     1132        /**/
     1574     1133        %IV$FMT(NAME=FMT,STCLASS="BASED(FMT$)");
     1575     1189        %IV$FMT(NAME=ELT,STCLASS="BASED(VIP.ELT$)");
     1576     1245        %FM$VID(FM$VID=VID,BASED="BASED(VID$)");
     1577     1251        %NI$DVT(NAME=DVT,STCLASS="BASED(DVT$)");
     1578     1258        /**/
     1579     1259        /* STATIC DATA */
     1580     1260        /**/
     1581     1261    1   DCL IV_IO$ PTR SYMREF;
     1582     1262    1   DCL CEDATA(0:7) BIT(36) INIT('252252252252'O,'252252252252'O,
     1583     1263    1                                '252252377377'O,'377377377377'O,
     1584     1264    1                                '377377252252'O,'252252252252'O,
     1585     1265    1                                '252252377377'O,'377377377377'O) CONSTANT;
     1586     1266        /* 10 BYTE 'A' (1010) @ 143 * ( 8 BYTE 'F' (1111) @ 8 BYTE 'A' )
     1587     1267          @ 6 BYTE 'F' - TOTAL 576 WORD ( 9-BIT BYTE) OR 512 WORD ( 8-BIT ) */
     1588     1268        /**/
     1589     1269        /* AUTO STACK */
     1590     1270        /**/
     1591     1271    1   DCL FMT$ PTR;
     1592     1272    1   DCL DATA(0:575) BIT(36) BASED(DATA$) UNAL;
     1593     1273    1   DCL DVT$ PTR;
     1594     1274    1   DCL I SBIN;
     1595     1275    1   DCL J SBIN;
     1596     1276    1   DCL LOOP BIT(1) ALIGNED;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:332  
     1597     1277    1   DCL TRACK UBIN(18);
     1598     1278    1   DCL 1 TR REDEF TRACK ALIGNED,
     1599     1279    1         2 CYL UBIN(10) UNAL,              /* CYLINDER NUMBER */
     1600     1280    1         2 CY REDEF CYL,
     1601     1281    1           3 UPR UBIN(2) UNAL,
     1602     1282    1           3 LWR UBIN(8) UNAL,
     1603     1283    1         2 X UBIN(2) UNAL,
     1604     1284    1         2 HD UBIN(6) UNAL;                /* HEAD NUMBER */
     1605     1285    1   DCL LTRACK UBIN(18);
     1606     1286    1   DCL VID$ PTR;
     1607     1287        /**/
     1608     1288        /* SUBSTITUTIONS */
     1609     1289        /**/
     1610     1290        %SUB NULL="ADDR(NIL)";
     1611     1291        %SUB IV_BEGIN=0;
     1612     1292        %SUB IV_NEXTTRACK=1;
     1613     1293        %SUB IV_INITFMT=2;
     1614     1294        %SUB IV_COMPFMT=3;
     1615     1295        %SUB IV_INITTEST=4;
     1616     1296        %SUB IV_COMPTEST=5;
     1617     1297        %SUB IV_DONE=6;
     1618     1298        %SUB IV_INITCE=7;
     1619     1299        %SUB IV_COMPCE=8;
     1620     1300        %EJECT;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:333  
     1621     1301    1           IF VIP.STOP THEN VIP.STEP=IV_DONE;
     1622     1302    1           FMT$=VIP.FMT$;
     1623     1303    1           IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN
     1624     1304    2           DO;
     1625     1305    2              DATA$=PINCRW(ADDR(FMT.HEADER),88); /* 50X HDR SZ IS 88 WORDS */
     1626     1306    2              TRACK=VIP.CTRACK;
     1627     1307    2              END;
     1628     1308    1           LOOP='1'B;
     1629     1309    2           DO WHILE(LOOP);
     1630     1310    3              DO CASE(VIP.STEP);
     1631     1311    3               CASE(IV_BEGIN);             /* INITIATE VOLINIT */
     1632     1312    3                 IF VIP.FORMAT THEN
     1633     1313    3                    VIP.STEP=IV_INITFMT;
     1634     1314    3                 ELSE IF VIP.TEST THEN
     1635     1315    3                       VIP.STEP=IV_INITTEST;
     1636     1316    3                    ELSE VIP.STEP=IV_DONE;
     1637     1317    3               CASE(IV_NEXTTRACK);         /* NEXT TRACK */
     1638     1318    3                 VIP.STEP=IV_BEGIN;
     1639     1319    3                 VIP.DISKERR='0'B;
     1640     1320    3                 IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN
     1641     1321    4                 DO;
     1642     1322    5                    IF VIP.CTRACK < VIP.RANGE.LTRACK(VIP.CRANGE) THEN DO;
     1643     1323    5                       IF VIP.CTR.HD < VIP.NHEADS-1 THEN
     1644     1324    5                          VIP.CTR.HD=VIP.CTR.HD+1;
     1645     1325    6                       ELSE DO;
     1646     1326    6                          VIP.CTR.HD=0;
     1647     1327    6                          VIP.CTR.CYL=VIP.CTR.CYL+1;
     1648     1328    6                          END;
     1649     1329    5                       END;
     1650     1330    5                    ELSE DO;
     1651     1331    5                       VIP.CRANGE=VIP.CRANGE+1;
     1652     1332    6                       IF VIP.CRANGE < VIP.NRANGES THEN DO;
     1653     1333    6                          VIP.CTRACK=VIP.RANGE.FTRACK(VIP.CRANGE);
     1654     1334    6                          END;
     1655     1335    5                       ELSE VIP.STEP=IV_DONE;
     1656     1336    5                       END;
     1657     1337    5                    IF VIP.CTR.CYL=840 AND VIP.CTR.HD>=20 THEN DO;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:334  
     1658     1338    5                       VIP.CTR.CYL=841;
     1659     1339    5                       VIP.CTR.HD=0;
     1660     1340    5                       END;
     1661     1341    4                    TRACK=VIP.CTRACK;
     1662     1342    4                    END;
     1663     1343    4                 ELSE DO;
     1664     1344    4                    FMT.SEEK.SECTOR=FMT.SEEK.SECTOR+VIP.NSECTS;
     1665     1345    4                    J=FMT.SEEK.SECTOR/VIP.NSECTS;
     1666     1346    4                    TR.CYL=J/VIP.NHEADS;
     1667     1347    4                    TR.HD=MOD(J,VIP.NHEADS);
     1668     1348    5                    IF TR.CYL=VIP.NCYLS AND TR.HD=0 THEN DO;
     1669     1349    5                       FMT.SEEK.SECTOR=VIP.T@DCYL*VIP.NHEADS*VIP.NSECTS;
     1670     1350    5                       TR.CYL=VIP.T@DCYL;
     1671     1351    5                       TR.HD=0;
     1672     1352    5                       END;
     1673     1353    5                    IF TRACK>VIP.RANGE.LTRACK(VIP.CRANGE) THEN DO;
     1674     1354    5                       VIP.CRANGE=VIP.CRANGE+1;
     1675     1355    5                       IF VIP.CRANGE>=VIP.NRANGES THEN VIP.STEP=IV_DONE;
     1676     1356    6                       ELSE DO;
     1677     1357    6                          FMT.SEEK.SECTOR=(VIP.RANGE.FT.CYL(VIP.CRANGE)*VIP.NHEADS+VIP.
              1357                                   RANGE.FT.HD(VIP.CRANGE))*VIP.NSECTS;
     1678     1358    6                          TRACK=VIP.RANGE.FTRACK(VIP.CRANGE);
     1679     1359    6                          END;
     1680     1360    5                       END;
     1681     1361    5                    IF TR.CYL>=VIP.T@DCYL THEN DO;
     1682     1362    5                       IF VIP.GRANSIZE=2 THEN FMT.SEEK_IDCW='357700720000'O;
     1683     1363    5                       ELSE FMT.SEEK_IDCW='367700720000'O;
     1684     1364    5                       END;
     1685     1365    4                    END;
     1686     1366    3               CASE(IV_INITFMT);           /* INITIALIZE FOR FORMATTING */
     1687     1367    3                 FMT.IDCW.DC=%FORMAT;
     1688     1368    3                 FMT.DCW=FMT.HEADER_DCW;
     1689     1369    3                 IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN
     1690     1370    3                    CALL CONVMPC(FMT.SEEK.SECTOR);
     1691     1371    3                 CALL IVV$HEADER(VIP);
     1692     1372    3                 VIP.STEP=IV_COMPFMT;
     1693     1373    3                 LOOP='0'B;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:335  
     1694     1374    3               CASE(IV_COMPFMT);           /* FORMATTING COMPLETE */
     1695     1375    4                 IF TYC AND NOT VIP.DISKERR THEN DO;
     1696     1376    4                    CALL MARKDT;
     1697     1377    4                    VIP.DISKERR='1'B;
     1698     1378    4                    VIP.STEP=IV_INITFMT;
     1699     1379    4                    END;
     1700     1380    3                 ELSE
     1701     1381    3                    IF VIP.TEST AND NOT VIP.DISKERR THEN
     1702     1382    3                       VIP.STEP=IV_INITTEST;
     1703     1383    3                    ELSE
     1704     1384    3                       IF VIP.MODEL = 'MSU509 ' THEN GOTO M509;
     1705     1385    3                 IF VIP.MODEL='MSU0501 ' THEN
     1706     1386    3                    IF VIP.CTR.CYL=842 AND VIP.CTR.HD=39 THEN VIP.STEP=IV_INITCE;
     1707     1387    3                    ELSE;
     1708     1388    3                 ELSE
     1709     1389    3   M509:            VIP.STEP=IV_NEXTTRACK;
     1710     1390    3               CASE(IV_INITTEST);          /* INITIALIZE FOR SURFACE TEST */
     1711     1391    3                 IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN
     1712     1392    3                    CALL CONVMPC(FMT.SEEK.SECTOR);
     1713     1393    3                 FMT.IDCW.DC=%WRCMP;
     1714     1394    3                 FMT.DCW=FMT.DATA_DCW;
     1715     1395    3                 VIP.STEP=IV_COMPTEST;
     1716     1396    3                 LOOP='0'B;
     1717     1397    3               CASE(IV_COMPTEST);          /* SURFACE TEST COMPLETE */
     1718     1398    4                 IF TYC THEN DO;
     1719     1399    4                    CALL MARKDT;
     1720     1400    5                    IF VIP.FORMAT THEN DO;
     1721     1401    5                       VIP.DISKERR='1'B;
     1722     1402    5                       VIP.STEP=IV_INITFMT;
     1723     1403    5                       END;
     1724     1404    5                    ELSE DO;
     1725     1405    5                       VIP.STEP=IV_NEXTTRACK;
     1726     1406    5                       END;
     1727     1407    4                    END;
     1728     1408    4                 ELSE DO;
     1729     1409    4                    IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN
     1730     1410    4                       IF VIP.CTR.CYL=842 AND VIP.CTR.HD=39 THEN VIP.STEP=IV_INITCE;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:336  
     1731     1411    4                       ELSE
     1732     1412    4                          VIP.STEP=IV_NEXTTRACK;
     1733     1413    4                    ELSE VIP.STEP=IV_NEXTTRACK;
     1734     1414    4                    END;
     1735     1415    3               CASE(IV_INITCE);
     1736     1416    4                 DO I=0 TO 3 BY 1;
     1737     1417    4                    DATA(I)=CEDATA(I);
     1738     1418    4                    END;
     1739     1419    4                 DO I=4 TO 575 BY 4;
     1740     1420    5                    DO J=0 TO 3 BY 1;
     1741     1421    5                       DATA(I+J)=CEDATA(4+J);
     1742     1422    5                       END;
     1743     1423    4                    END;
     1744     1424    3                 FMT.IDCW.DC=%WRASC;
     1745     1425    3                 FMT.DCW=FMT.DATA_DCW;
     1746     1426    3                 FMT.DCW.TALLY(0)=576;
     1747     1427    3                 FMT.SEEK.SCL=0;
     1748     1428    3                 FMT.SEEK.Y='1'B;
     1749     1429    3                 FMT.SEEK.SEC.ELT='1'B;
     1750     1430    3                 VIP.STEP=IV_COMPCE;
     1751     1431    3                 LOOP='0'B;
     1752     1432    3               CASE(IV_COMPCE);
     1753     1433    4                 IF TYC THEN DO;
     1754     1434    4                    CALL MARKDT;
     1755     1435    4                    VIP.STEP=IV_DONE;
     1756     1436    4                    END;
     1757     1437    4                 ELSE DO;
     1758     1438    4                    IF FMT.SEEK.SCL>= 7 THEN VIP.STEP=IV_DONE;
     1759     1439    5                    ELSE DO;
     1760     1440    5                       FMT.SEEK.SCL=FMT.SEEK.SCL+1;
     1761     1441    5                       LOOP='0'B;
     1762     1442    5                       VIP.STEP=IV_COMPCE;
     1763     1443    5                       END;
     1764     1444    4                    END;
     1765     1445    3               CASE(IV_DONE);              /* VOLINIT DONE */
     1766     1446    3                 VIP.DONE='1'B;
     1767     1447    3                 ALTRETURN;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:337  
     1768     1448    3               END;
     1769     1449    2              END;
     1770     1450    2           DO INHIBIT;
     1771     1451    2              VIP.IO$=IV_IO$;
     1772     1452    2              IV_IO$=ADDR(VIP);
     1773     1453    2              END;
     1774     1454    1           RETURN;
     1775     1455        %EJECT;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:338  
     1776     1456    1   MARKDT: PROC;
     1777     1457    2           IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN;
     1778     1458    3           ELSE DO;
     1779     1459    3              J=FMT.SEEK.SECTOR/VIP.NSECTS;
     1780     1460    3              TR.CYL=J/VIP.NHEADS;
     1781     1461    3              TR.HD=MOD(J,VIP.NHEADS);
     1782     1462    3              END;
     1783     1463    2           VID$=VIP.VID$;
     1784     1464    3           DO I=0 TO 62;
     1785     1465    4              IF VID.DTT(I)=BITBIN('777777'O) THEN DO;
     1786     1466    4                 IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN
     1787     1467    4                    VID.DTT(I)=VIP.CTRACK;
     1788     1468    4                 ELSE
     1789     1469    4                    VID.DTT(I)=TRACK;
     1790     1470    4                 VIP.DTTCH='1'B;
     1791     1471    4                 RETURN;
     1792     1472    4                 END;
     1793     1473    3              END;
     1794     1474    2           VIP.DTTOVF='1'B;
     1795     1475    2           VIP.STOP='1'B;
     1796     1476    2           RETURN;
     1797     1477    2   END MARKDT;
     1798     1478
     1799     1479
     1800     1480    1   CONVMPC: PROC(SECTOR);
     1801     1481    2   DCL SECTOR BIT(36) ALIGNED;
     1802     1482    2   DCL 1 SEC REDEF SECTOR ALIGNED,
     1803     1483    2         2 * UBIN(20) UNAL,
     1804     1484    2         2 CL UBIN(8) UNAL,
     1805     1485    2         2 CU UBIN(2) UNAL,
     1806     1486    2         2 HD UBIN(6) UNAL;
     1807     1487    2           SEC.CL=TR.CY.LWR;
     1808     1488    2           SEC.CU=TR.CY.UPR;
     1809     1489    2           SEC.HD=TR.HD;
     1810     1490
     1811     1491    2   END CONVMPC;
     1812     1492    1   END IVV$NEXT;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:339  
     1813     1493        %EOD;

PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:340  
--  Include file information  --

   NI$TABLES.:E05TOU  is referenced.
   IV$MACROS.:E05TOU  is referenced.
   FM$GRAN.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure IVV$NEXT.

   Procedure IVV$NEXT requires 635 words for executable code.
   Procedure IVV$NEXT requires 28 words of local(AUTO) storage.

PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:341  

 Object Unit name= IVV$NEXT                                   File name= IVV$VOLINIT.:E05TOU
 UTS= JUL 29 '97 23:20:14.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     16     20  IVV$NEXT
    1   Proc  even  none   635   1173  IVV$NEXT
    2  RoData even  none     7      7  IVV$NEXT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  IVV$NEXT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 IVV$HEADER
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     IV_IO$                                B_VECTNIL
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:342  


     1523        1        /*T***********************************************************/
     1524        2        /*T*                                                         */
     1525        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1526        4        /*T*                                                         */
     1527        5        /*T***********************************************************/
     1528        6        /* FORMAT NEXT TRACK */
     1529        7        /**/
     1530        8        IVV$NEXT: PROC (VIP,TYC) ALTRET;

      8  1 000000   000000 700200 xent  IVV$NEXT     TSX0  ! X66_AUTO_2
         1 000001   000034 000002                    ZERO    28,2

     1531        9        /**/
     1532       10        /* INCLUDE FILES */
     1533       11        /**/
     1534       12        %INCLUDE CP_6_SUBS;
     1535      552        %INCLUDE FM$GRAN;
     1536      621        %INCLUDE IV$MACROS;
     1537      791        %INCLUDE NI$TABLES;
     1538     1007        /**/
     1539     1008                                           /* Storage structure for MSU050X header */
     1540     1009    1   DCL HDR5$ PTR;
     1541     1010    1   DCL DATA$ PTR;
     1542     1011        %IV$HDR(NAME=CF,STCLASS="BASED(HDR5$)");
     1543     1039
     1544     1040    1   DCL 1 SKIP(0:1) UNAL,
     1545     1041    1         2 S BIT(4),
     1546     1042    1         2 SK UBIN(12);
     1547     1043
     1548     1044        /**/
     1549     1045        /* PARAMETERS */
     1550     1046        /**/
     1551     1047        %IV$VIP(NAME=VIP,STCLASS="");
     1552     1111    1   DCL TYC BIT(36) ALIGNED;
     1553     1112        /**/
     1554     1113        /* EXTERNAL REFERENCES */
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:343  
     1555     1114        /**/
     1556     1115    1   DCL IVV$HEADER ENTRY (1);
     1557     1116    1   DCL IVO$READ_ELT ENTRY (1) ALTRET;
     1558     1117    1   DCL DCWBUILD ENTRY(3);
     1559     1118    1   DCL IVO$GET ENTRY (2) ALTRET;
     1560     1119    1   DCL IVV$ERROR ENTRY (3);
     1561     1120    1   DCL IVV$FMTPAC ENTRY (2) ALTRET;
     1562     1121    1   DCL IVO$PRINT ENTRY (2) ALTRET;
     1563     1122    1   DCL IVV$BINDEC ENTRY (4);
     1564     1123        /**/
     1565     1124        /* SUBSTITUTIONS */
     1566     1125        %EQU FORMAT='17'O;                      /* DISK FORMAT TRACK COMMAND */
     1567     1126        %EQU WRCMP='33'O;                       /* DISK WRITE & COMPARE COMMAND */
     1568     1127        %EQU WRASC='32'O;                       /* DISK WRITE ASCII COMMAND */
     1569     1128        %EQU DP_TDSEEK512='35'O;                /* DISK SEEK OF 512 FORMAT COMMAND */
     1570     1129        %EQU RDHEADER='27'O;                    /* READ TRACK HEADER COMMAND */
     1571     1130        %EQU RDBIN='25'O;                       /* READ ELT DATA IN BINA COMMAND */
     1572     1131        /* DATA STRUCTURES */
     1573     1132        /**/
     1574     1133        %IV$FMT(NAME=FMT,STCLASS="BASED(FMT$)");
     1575     1189        %IV$FMT(NAME=ELT,STCLASS="BASED(VIP.ELT$)");
     1576     1245        %FM$VID(FM$VID=VID,BASED="BASED(VID$)");
     1577     1251        %NI$DVT(NAME=DVT,STCLASS="BASED(DVT$)");
     1578     1258        /**/
     1579     1259        /* STATIC DATA */
     1580     1260        /**/
     1581     1261    1   DCL IV_IO$ PTR SYMREF;
     1582     1262    1   DCL CEDATA(0:7) BIT(36) INIT('252252252252'O,'252252252252'O,
     1583     1263    1                                '252252377377'O,'377377377377'O,
     1584     1264    1                                '377377252252'O,'252252252252'O,
     1585     1265    1                                '252252377377'O,'377377377377'O) CONSTANT;
     1586     1266        /* 10 BYTE 'A' (1010) @ 143 * ( 8 BYTE 'F' (1111) @ 8 BYTE 'A' )
     1587     1267          @ 6 BYTE 'F' - TOTAL 576 WORD ( 9-BIT BYTE) OR 512 WORD ( 8-BIT ) */
     1588     1268        /**/
     1589     1269        /* AUTO STACK */
     1590     1270        /**/
     1591     1271    1   DCL FMT$ PTR;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:344  
     1592     1272    1   DCL DATA(0:575) BIT(36) BASED(DATA$) UNAL;
     1593     1273    1   DCL DVT$ PTR;
     1594     1274    1   DCL I SBIN;
     1595     1275    1   DCL J SBIN;
     1596     1276    1   DCL LOOP BIT(1) ALIGNED;
     1597     1277    1   DCL TRACK UBIN(18);
     1598     1278    1   DCL 1 TR REDEF TRACK ALIGNED,
     1599     1279    1         2 CYL UBIN(10) UNAL,              /* CYLINDER NUMBER */
     1600     1280    1         2 CY REDEF CYL,
     1601     1281    1           3 UPR UBIN(2) UNAL,
     1602     1282    1           3 LWR UBIN(8) UNAL,
     1603     1283    1         2 X UBIN(2) UNAL,
     1604     1284    1         2 HD UBIN(6) UNAL;                /* HEAD NUMBER */
     1605     1285    1   DCL LTRACK UBIN(18);
     1606     1286    1   DCL VID$ PTR;
     1607     1287        /**/
     1608     1288        /* SUBSTITUTIONS */
     1609     1289        /**/
     1610     1290        %SUB NULL="ADDR(NIL)";
     1611     1291        %SUB IV_BEGIN=0;
     1612     1292        %SUB IV_NEXTTRACK=1;
     1613     1293        %SUB IV_INITFMT=2;
     1614     1294        %SUB IV_COMPFMT=3;
     1615     1295        %SUB IV_INITTEST=4;
     1616     1296        %SUB IV_COMPTEST=5;
     1617     1297        %SUB IV_DONE=6;
     1618     1298        %SUB IV_INITCE=7;
     1619     1299        %SUB IV_COMPCE=8;
     1620     1300        %EJECT;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:345  
     1621     1301    1           IF VIP.STOP THEN VIP.STEP=IV_DONE;

   1301  1 000002   200003 470500                    LDP0    @VIP,,AUTO
         1 000003   000017 236100                    LDQ     15,,PR0
         1 000004   010000 316007                    CANQ    4096,DL
         1 000005   000011 600000 1                  TZE     s:1302

   1301  1 000006   000000 376000 2                  ANQ     0
         1 000007   000006 276007                    ORQ     6,DL
         1 000010   000017 756100                    STQ     15,,PR0

     1622     1302    1           FMT$=VIP.FMT$;

   1302  1 000011   000013 236100                    LDQ     11,,PR0
         1 000012   200013 756100                    STQ     FMT$,,AUTO

     1623     1303    1           IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN

   1303  1 000013   040000 106500                    CMPC    fill='040'O
         1 000014   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000015   000010 000010 0                  ADSC9   CEDATA+8                 cn=0,n=8
         1 000016   000023 600000 1                  TZE     s:1305
         1 000017   040000 106500                    CMPC    fill='040'O
         1 000020   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000021   000012 000010 0                  ADSC9   CEDATA+10                cn=0,n=8
         1 000022   000027 601000 1                  TNZ     s:1308

     1624     1304    2           DO;

     1625     1305    2              DATA$=PINCRW(ADDR(FMT.HEADER),88); /* 50X HDR SZ IS 88 WORDS */

   1305  1 000023   000151 036003                    ADLQ    105,DU
         1 000024   200006 756100                    STQ     DATA$,,AUTO

     1626     1306    2              TRACK=VIP.CTRACK;

   1306  1 000025   000016 220100                    LDX0    14,,PR0
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:346  
         1 000026   200020 740100                    STX0    TRACK,,AUTO

     1627     1307    2              END;

     1628     1308    1           LOOP='1'B;

   1308  1 000027   400000 236003                    LDQ     -131072,DU
         1 000030   200017 756100                    STQ     LOOP,,AUTO

     1629     1309    2           DO WHILE(LOOP);

   1309  1 000031   200017 234100                    SZN     LOOP,,AUTO
         1 000032   001032 605000 1                  TPL     s:1451

     1630     1310    3              DO CASE(VIP.STEP);

   1310  1 000033   200003 470500                    LDP0    @VIP,,AUTO
         1 000034   000017 720100                    LXL0    15,,PR0
         1 000035   000177 360003                    ANX0    127,DU
         1 000036   000011 100003                    CMPX0   9,DU
         1 000037   000041 602010 1                  TNC     s:1310+6,X0
         1 000040   001030 710000 1                  TRA     s:1449
         1 000041   000052 710000 1                  TRA     s:1312
         1 000042   000073 710000 1                  TRA     s:1318
         1 000043   000414 710000 1                  TRA     s:1367
         1 000044   000452 710000 1                  TRA     s:1375
         1 000045   000535 710000 1                  TRA     s:1391
         1 000046   000567 710000 1                  TRA     s:1398
         1 000047   001025 710000 1                  TRA     s:1446
         1 000050   000652 710000 1                  TRA     s:1416
         1 000051   000763 710000 1                  TRA     s:1433

     1631     1311    3               CASE(IV_BEGIN);             /* INITIATE VOLINIT */

     1632     1312    3                 IF VIP.FORMAT THEN

   1312  1 000052   000017 236100                    LDQ     15,,PR0
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:347  
         1 000053   400000 316007                    CANQ    -131072,DL
         1 000054   000061 600000 1                  TZE     s:1314

     1633     1313    3                    VIP.STEP=IV_INITFMT;

   1313  1 000055   000000 376000 2                  ANQ     0
         1 000056   000002 276007                    ORQ     2,DL
         1 000057   000017 756100                    STQ     15,,PR0
         1 000060   001030 710000 1                  TRA     s:1449

     1634     1314    3                 ELSE IF VIP.TEST THEN

   1314  1 000061   100000 316007                    CANQ    32768,DL
         1 000062   000067 600000 1                  TZE     s:1316

     1635     1315    3                       VIP.STEP=IV_INITTEST;

   1315  1 000063   000000 376000 2                  ANQ     0
         1 000064   000004 276007                    ORQ     4,DL
         1 000065   000017 756100                    STQ     15,,PR0
         1 000066   001030 710000 1                  TRA     s:1449

     1636     1316    3                    ELSE VIP.STEP=IV_DONE;

   1316  1 000067   000000 376000 2                  ANQ     0
         1 000070   000006 276007                    ORQ     6,DL
         1 000071   000017 756100                    STQ     15,,PR0
         1 000072   001030 710000 1                  TRA     s:1449

     1637     1317    3               CASE(IV_NEXTTRACK);         /* NEXT TRACK */

     1638     1318    3                 VIP.STEP=IV_BEGIN;

   1318  1 000073   000000 236000 2                  LDQ     0
         1 000074   000017 356100                    ANSQ    15,,PR0

     1639     1319    3                 VIP.DISKERR='0'B;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:348  

   1319  1 000075   000001 236000 2                  LDQ     1
         1 000076   000017 356100                    ANSQ    15,,PR0

     1640     1320    3                 IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN

   1320  1 000077   040000 106500                    CMPC    fill='040'O
         1 000100   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000101   000010 000010 0                  ADSC9   CEDATA+8                 cn=0,n=8
         1 000102   000107 600000 1                  TZE     s:1322
         1 000103   040000 106500                    CMPC    fill='040'O
         1 000104   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000105   000012 000010 0                  ADSC9   CEDATA+10                cn=0,n=8
         1 000106   000210 601000 1                  TNZ     s:1344

     1641     1321    4                 DO;

     1642     1322    5                    IF VIP.CTRACK < VIP.RANGE.LTRACK(VIP.CRANGE) THEN DO;

   1322  1 000107   000015 720100                    LXL0    13,,PR0
         1 000110   000024 721110                    LXL1    20,X0,PR0
         1 000111   000016 101100                    CMPX1   14,,PR0
         1 000112   000146 602000 1                  TNC     s:1331
         1 000113   000146 600000 1                  TZE     s:1331

     1643     1323    5                       IF VIP.CTR.HD < VIP.NHEADS-1 THEN

   1323  1 000114   000014 236100                    LDQ     12,,PR0
         1 000115   000022 772000                    QRL     18
         1 000116   000777 376007                    ANQ     511,DL
         1 000117   000001 136007                    SBLQ    1,DL
         1 000120   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000121   000016 236100                    LDQ     14,,PR0
         1 000122   000022 772000                    QRL     18
         1 000123   000377 376007                    ANQ     255,DL
         1 000124   200026 116100                    CMPQ    @SECTOR+1,,AUTO
         1 000125   000134 605000 1                  TPL     s:1326
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:349  

     1644     1324    5                          VIP.CTR.HD=VIP.CTR.HD+1;

   1324  1 000126   000001 036007                    ADLQ    1,DL
         1 000127   000022 736000                    QLS     18
         1 000130   000016 676100                    ERQ     14,,PR0
         1 000131   000377 376003                    ANQ     255,DU
         1 000132   000016 656100                    ERSQ    14,,PR0
         1 000133   000167 710000 1                  TRA     s:1337

     1645     1325    6                       ELSE DO;

     1646     1326    6                          VIP.CTR.HD=0;

   1326  1 000134   000002 236000 2                  LDQ     2
         1 000135   000016 356100                    ANSQ    14,,PR0

     1647     1327    6                          VIP.CTR.CYL=VIP.CTR.CYL+1;

   1327  1 000136   000016 236100                    LDQ     14,,PR0
         1 000137   000032 772000                    QRL     26
         1 000140   000001 036007                    ADLQ    1,DL
         1 000141   000032 736000                    QLS     26
         1 000142   000016 676100                    ERQ     14,,PR0
         1 000143   777400 376003                    ANQ     -256,DU
         1 000144   000016 656100                    ERSQ    14,,PR0

     1648     1328    6                          END;

     1649     1329    5                       END;

   1329  1 000145   000167 710000 1                  TRA     s:1337

     1650     1330    5                    ELSE DO;

     1651     1331    5                       VIP.CRANGE=VIP.CRANGE+1;

PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:350  
   1331  1 000146   000001 622010                    EAX2    1,X0
         1 000147   000015 442100                    SXL2    13,,PR0

     1652     1332    6                       IF VIP.CRANGE < VIP.NRANGES THEN DO;

   1332  1 000150   000020 236100                    LDQ     16,,PR0
         1 000151   000033 772000                    QRL     27
         1 000152   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000153   000015 236100                    LDQ     13,,PR0
         1 000154   777777 376007                    ANQ     -1,DL
         1 000155   200026 116100                    CMPQ    @SECTOR+1,,AUTO
         1 000156   000163 605000 1                  TPL     s:1335

     1653     1333    6                          VIP.CTRACK=VIP.RANGE.FTRACK(VIP.CRANGE);

   1333  1 000157   000015 720100                    LXL0    13,,PR0
         1 000160   000024 221110                    LDX1    20,X0,PR0
         1 000161   000016 741100                    STX1    14,,PR0

     1654     1334    6                          END;

   1334  1 000162   000167 710000 1                  TRA     s:1337

     1655     1335    5                       ELSE VIP.STEP=IV_DONE;

   1335  1 000163   000017 236100                    LDQ     15,,PR0
         1 000164   000000 376000 2                  ANQ     0
         1 000165   000006 276007                    ORQ     6,DL
         1 000166   000017 756100                    STQ     15,,PR0

     1656     1336    5                       END;

     1657     1337    5                    IF VIP.CTR.CYL=840 AND VIP.CTR.HD>=20 THEN DO;

   1337  1 000167   000016 236100                    LDQ     14,,PR0
         1 000170   777400 376003                    ANQ     -256,DU
         1 000171   644000 116003                    CMPQ    -47104,DU
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:351  
         1 000172   000205 601000 1                  TNZ     s:1341
         1 000173   000016 236100                    LDQ     14,,PR0
         1 000174   000377 376003                    ANQ     255,DU
         1 000175   000024 116003                    CMPQ    20,DU
         1 000176   000205 602000 1                  TNC     s:1341

     1658     1338    5                       VIP.CTR.CYL=841;

   1338  1 000177   000016 236100                    LDQ     14,,PR0
         1 000200   000003 376000 2                  ANQ     3
         1 000201   644400 276003                    ORQ     -46848,DU
         1 000202   000016 756100                    STQ     14,,PR0

     1659     1339    5                       VIP.CTR.HD=0;

   1339  1 000203   000002 236000 2                  LDQ     2
         1 000204   000016 356100                    ANSQ    14,,PR0

     1660     1340    5                       END;

     1661     1341    4                    TRACK=VIP.CTRACK;

   1341  1 000205   000016 220100                    LDX0    14,,PR0
         1 000206   200020 740100                    STX0    TRACK,,AUTO

     1662     1342    4                    END;

   1342  1 000207   001030 710000 1                  TRA     s:1449

     1663     1343    4                 ELSE DO;

     1664     1344    4                    FMT.SEEK.SECTOR=FMT.SEEK.SECTOR+VIP.NSECTS;

   1344  1 000210   000014 236100                    LDQ     12,,PR0
         1 000211   000033 772000                    QRL     27
         1 000212   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000213   200013 471500                    LDP1    FMT$,,AUTO
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:352  
         1 000214   100007 236100                    LDQ     7,,PR1
         1 000215   000004 376000 2                  ANQ     4
         1 000216   200026 036100                    ADLQ    @SECTOR+1,,AUTO
         1 000217   100007 676100                    ERQ     7,,PR1
         1 000220   000004 376000 2                  ANQ     4
         1 000221   100007 656100                    ERSQ    7,,PR1

     1665     1345    4                    J=FMT.SEEK.SECTOR/VIP.NSECTS;

   1345  1 000222   000014 236100                    LDQ     12,,PR0
         1 000223   000033 772000                    QRL     27
         1 000224   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000225   100007 236100                    LDQ     7,,PR1
         1 000226   000004 376000 2                  ANQ     4
         1 000227   200026 506100                    DIV     @SECTOR+1,,AUTO
         1 000230   200016 756100                    STQ     J,,AUTO

     1666     1346    4                    TR.CYL=J/VIP.NHEADS;

   1346  1 000231   000014 236100                    LDQ     12,,PR0
         1 000232   000022 772000                    QRL     18
         1 000233   000777 376007                    ANQ     511,DL
         1 000234   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000235   200016 236100                    LDQ     J,,AUTO
         1 000236   200026 506100                    DIV     @SECTOR+1,,AUTO
         1 000237   000032 736000                    QLS     26
         1 000240   200020 676100                    ERQ     TRACK,,AUTO
         1 000241   777400 376003                    ANQ     -256,DU
         1 000242   200020 656100                    ERSQ    TRACK,,AUTO

     1667     1347    4                    TR.HD=MOD(J,VIP.NHEADS);

   1347  1 000243   000014 236100                    LDQ     12,,PR0
         1 000244   000022 772000                    QRL     18
         1 000245   000777 376007                    ANQ     511,DL
         1 000246   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000247   200016 236100                    LDQ     J,,AUTO
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:353  
         1 000250   200026 506100                    DIV     @SECTOR+1,,AUTO
         1 000251   000044 733000                    LRS     36
         1 000252   000022 736000                    QLS     18
         1 000253   200020 752110                    STCQ    TRACK,'10'O,AUTO

     1668     1348    5                    IF TR.CYL=VIP.NCYLS AND TR.HD=0 THEN DO;

   1348  1 000254   000014 236100                    LDQ     12,,PR0
         1 000255   777777 376007                    ANQ     -1,DL
         1 000256   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000257   200020 236100                    LDQ     TRACK,,AUTO
         1 000260   000032 772000                    QRL     26
         1 000261   200026 116100                    CMPQ    @SECTOR+1,,AUTO
         1 000262   000315 601000 1                  TNZ     s:1353
         1 000263   200020 236100                    LDQ     TRACK,,AUTO
         1 000264   000077 316003                    CANQ    63,DU
         1 000265   000315 601000 1                  TNZ     s:1353

     1669     1349    5                       FMT.SEEK.SECTOR=VIP.T@DCYL*VIP.NHEADS*VIP.NSECTS;

   1349  1 000266   000014 236100                    LDQ     12,,PR0
         1 000267   000022 772000                    QRL     18
         1 000270   000777 376007                    ANQ     511,DL
         1 000271   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000272   000015 236100                    LDQ     13,,PR0
         1 000273   000022 772000                    QRL     18
         1 000274   200026 402100                    MPY     @SECTOR+1,,AUTO
         1 000275   200027 756100                    STQ     @SECTOR+2,,AUTO
         1 000276   000014 236100                    LDQ     12,,PR0
         1 000277   000033 772000                    QRL     27
         1 000300   200030 756100                    STQ     @SECTOR+3,,AUTO
         1 000301   200027 236100                    LDQ     @SECTOR+2,,AUTO
         1 000302   200030 402100                    MPY     @SECTOR+3,,AUTO
         1 000303   100007 676100                    ERQ     7,,PR1
         1 000304   000004 376000 2                  ANQ     4
         1 000305   100007 656100                    ERSQ    7,,PR1

PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:354  
     1670     1350    5                       TR.CYL=VIP.T@DCYL;

   1350  1 000306   000015 236100                    LDQ     13,,PR0
         1 000307   000010 736000                    QLS     8
         1 000310   200020 676100                    ERQ     TRACK,,AUTO
         1 000311   777400 376003                    ANQ     -256,DU
         1 000312   200020 656100                    ERSQ    TRACK,,AUTO

     1671     1351    5                       TR.HD=0;

   1351  1 000313   000000 236003                    LDQ     0,DU
         1 000314   200020 752110                    STCQ    TRACK,'10'O,AUTO

     1672     1352    5                       END;

     1673     1353    5                    IF TRACK>VIP.RANGE.LTRACK(VIP.CRANGE) THEN DO;

   1353  1 000315   000015 720100                    LXL0    13,,PR0
         1 000316   000024 721110                    LXL1    20,X0,PR0
         1 000317   200020 101100                    CMPX1   TRACK,,AUTO
         1 000320   000373 603000 1                  TRC     s:1361

     1674     1354    5                       VIP.CRANGE=VIP.CRANGE+1;

   1354  1 000321   000001 622010                    EAX2    1,X0
         1 000322   000015 442100                    SXL2    13,,PR0

     1675     1355    5                       IF VIP.CRANGE>=VIP.NRANGES THEN VIP.STEP=IV_DONE;

   1355  1 000323   000020 236100                    LDQ     16,,PR0
         1 000324   000033 772000                    QRL     27
         1 000325   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000326   000015 236100                    LDQ     13,,PR0
         1 000327   777777 376007                    ANQ     -1,DL
         1 000330   200026 116100                    CMPQ    @SECTOR+1,,AUTO
         1 000331   000337 604000 1                  TMI     s:1357

PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:355  
   1355  1 000332   000017 236100                    LDQ     15,,PR0
         1 000333   000000 376000 2                  ANQ     0
         1 000334   000006 276007                    ORQ     6,DL
         1 000335   000017 756100                    STQ     15,,PR0
         1 000336   000373 710000 1                  TRA     s:1361

     1676     1356    6                       ELSE DO;

     1677     1357    6                         FMT.SEEK.SECTOR=(VIP.RANGE.FT.CYL(VIP.CRANGE)*VIP.NHEADS+VIP.
              1357                                   RANGE.FT.HD(VIP.CRANGE))*VIP.NSECTS;

   1357  1 000337   000015 720100                    LXL0    13,,PR0
         1 000340   000014 236100                    LDQ     12,,PR0
         1 000341   000022 772000                    QRL     18
         1 000342   000777 376007                    ANQ     511,DL
         1 000343   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000344   000024 236110                    LDQ     20,X0,PR0
         1 000345   000032 772000                    QRL     26
         1 000346   200026 402100                    MPY     @SECTOR+1,,AUTO
         1 000347   000015 720100                    LXL0    13,,PR0
         1 000350   200027 756100                    STQ     @SECTOR+2,,AUTO
         1 000351   000024 236110                    LDQ     20,X0,PR0
         1 000352   000022 772000                    QRL     18
         1 000353   000377 376007                    ANQ     255,DL
         1 000354   200030 756100                    STQ     @SECTOR+3,,AUTO
         1 000355   200027 236100                    LDQ     @SECTOR+2,,AUTO
         1 000356   200030 036100                    ADLQ    @SECTOR+3,,AUTO
         1 000357   200031 756100                    STQ     @SECTOR+4,,AUTO
         1 000360   000014 236100                    LDQ     12,,PR0
         1 000361   000033 772000                    QRL     27
         1 000362   200032 756100                    STQ     @SECTOR+5,,AUTO
         1 000363   200031 236100                    LDQ     @SECTOR+4,,AUTO
         1 000364   200032 402100                    MPY     @SECTOR+5,,AUTO
         1 000365   100007 676100                    ERQ     7,,PR1
         1 000366   000004 376000 2                  ANQ     4
         1 000367   100007 656100                    ERSQ    7,,PR1

PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:356  
     1678     1358    6                          TRACK=VIP.RANGE.FTRACK(VIP.CRANGE);

   1358  1 000370   000015 720100                    LXL0    13,,PR0
         1 000371   000024 221110                    LDX1    20,X0,PR0
         1 000372   200020 741100                    STX1    TRACK,,AUTO

     1679     1359    6                          END;

     1680     1360    5                       END;

     1681     1361    5                    IF TR.CYL>=VIP.T@DCYL THEN DO;

   1361  1 000373   000015 236100                    LDQ     13,,PR0
         1 000374   000022 772000                    QRL     18
         1 000375   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000376   200020 236100                    LDQ     TRACK,,AUTO
         1 000377   000032 772000                    QRL     26
         1 000400   200026 116100                    CMPQ    @SECTOR+1,,AUTO
         1 000401   001030 604000 1                  TMI     s:1449

     1682     1362    5                       IF VIP.GRANSIZE=2 THEN FMT.SEEK_IDCW='357700720000'O;

   1362  1 000402   000020 236100                    LDQ     16,,PR0
         1 000403   000777 376003                    ANQ     511,DU
         1 000404   000002 116003                    CMPQ    2,DU
         1 000405   000411 601000 1                  TNZ     s:1363

   1362  1 000406   000014 236000 0                  LDQ     CEDATA+12
         1 000407   100000 756100                    STQ     0,,PR1
         1 000410   001030 710000 1                  TRA     s:1449

     1683     1363    5                       ELSE FMT.SEEK_IDCW='367700720000'O;

   1363  1 000411   000015 236000 0                  LDQ     CEDATA+13
         1 000412   100000 756100                    STQ     0,,PR1

     1684     1364    5                       END;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:357  

     1685     1365    4                    END;

   1365  1 000413   001030 710000 1                  TRA     s:1449

     1686     1366    3               CASE(IV_INITFMT);           /* INITIALIZE FOR FORMATTING */

     1687     1367    3                 FMT.IDCW.DC=%FORMAT;

   1367  1 000414   200013 471500                    LDP1    FMT$,,AUTO
         1 000415   170000 236003                    LDQ     61440,DU
         1 000416   100002 752140                    STCQ    2,'40'O,PR1

     1688     1368    3                 FMT.DCW=FMT.HEADER_DCW;

   1368  1 000417   000100 100500                    MLR     fill='000'O
         1 000420   100011 000020                    ADSC9   9,,PR1                   cn=0,n=16
         1 000421   100003 000020                    ADSC9   3,,PR1                   cn=0,n=16

     1689     1369    3                 IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN

   1369  1 000422   040000 106500                    CMPC    fill='040'O
         1 000423   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000424   000010 000010 0                  ADSC9   CEDATA+8                 cn=0,n=8
         1 000425   000432 600000 1                  TZE     s:1370
         1 000426   040000 106500                    CMPC    fill='040'O
         1 000427   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000430   000012 000010 0                  ADSC9   CEDATA+10                cn=0,n=8
         1 000431   000437 601000 1                  TNZ     s:1371

     1690     1370    3                    CALL CONVMPC(FMT.SEEK.SECTOR);

   1370  1 000432   200013 236100                    LDQ     FMT$,,AUTO
         1 000433   000005 036000 2                  ADLQ    5
         1 000434   200025 756100                    STQ     VID$+3,,AUTO
         1 000435   001152 701000 1                  TSX1    CONVMPC
         1 000436   000000 011000                    NOP     0
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:358  

     1691     1371    3                 CALL IVV$HEADER(VIP);

   1371  1 000437   200003 630500                    EPPR0   @VIP,,AUTO
         1 000440   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000441   000000 701000 xent               TSX1    IVV$HEADER
         1 000442   000000 011000                    NOP     0

     1692     1372    3                 VIP.STEP=IV_COMPFMT;

   1372  1 000443   200003 470500                    LDP0    @VIP,,AUTO
         1 000444   000017 236100                    LDQ     15,,PR0
         1 000445   000000 376000 2                  ANQ     0
         1 000446   000003 276007                    ORQ     3,DL
         1 000447   000017 756100                    STQ     15,,PR0

     1693     1373    3                 LOOP='0'B;

   1373  1 000450   200017 450100                    STZ     LOOP,,AUTO
         1 000451   001030 710000 1                  TRA     s:1449

     1694     1374    3               CASE(IV_COMPFMT);           /* FORMATTING COMPLETE */

     1695     1375    4                 IF TYC AND NOT VIP.DISKERR THEN DO;

   1375  1 000452   200004 471500                    LDP1    @TYC,,AUTO
         1 000453   100000 235100                    LDA     0,,PR1
         1 000454   000472 600000 1                  TZE     s:1381
         1 000455   000017 236100                    LDQ     15,,PR0
         1 000456   001000 316007                    CANQ    512,DL
         1 000457   000472 601000 1                  TNZ     s:1381

     1696     1376    4                    CALL MARKDT;

   1376  1 000460   001040 701000 1                  TSX1    MARKDT
         1 000461   000000 011000                    NOP     0

PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:359  
     1697     1377    4                    VIP.DISKERR='1'B;

   1377  1 000462   200003 470500                    LDP0    @VIP,,AUTO
         1 000463   001000 236007                    LDQ     512,DL
         1 000464   000017 256100                    ORSQ    15,,PR0

     1698     1378    4                    VIP.STEP=IV_INITFMT;

   1378  1 000465   000017 236100                    LDQ     15,,PR0
         1 000466   000000 376000 2                  ANQ     0
         1 000467   000002 276007                    ORQ     2,DL
         1 000470   000017 756100                    STQ     15,,PR0

     1699     1379    4                    END;

   1379  1 000471   000507 710000 1                  TRA     s:1385

     1700     1380    3                 ELSE
     1701     1381    3                    IF VIP.TEST AND NOT VIP.DISKERR THEN

   1381  1 000472   000017 236100                    LDQ     15,,PR0
         1 000473   100000 316007                    CANQ    32768,DL
         1 000474   000503 600000 1                  TZE     s:1384
         1 000475   001000 316007                    CANQ    512,DL
         1 000476   000503 601000 1                  TNZ     s:1384

     1702     1382    3                       VIP.STEP=IV_INITTEST;

   1382  1 000477   000000 376000 2                  ANQ     0
         1 000500   000004 276007                    ORQ     4,DL
         1 000501   000017 756100                    STQ     15,,PR0
         1 000502   000507 710000 1                  TRA     s:1385

     1703     1383    3                    ELSE
     1704     1384    3                       IF VIP.MODEL = 'MSU509 ' THEN GOTO M509;

   1384  1 000503   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:360  
         1 000504   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000505   000016 000007 0                  ADSC9   CEDATA+14                cn=0,n=7
         1 000506   000530 600000 1                  TZE     M509

     1705     1385    3                 IF VIP.MODEL='MSU0501 ' THEN

   1385  1 000507   040000 106500                    CMPC    fill='040'O
         1 000510   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000511   000010 000010 0                  ADSC9   CEDATA+8                 cn=0,n=8
         1 000512   000530 601000 1                  TNZ     M509

     1706     1386    3                    IF VIP.CTR.CYL=842 AND VIP.CTR.HD=39 THEN VIP.STEP=IV_INITCE;

   1386  1 000513   000016 236100                    LDQ     14,,PR0
         1 000514   777400 376003                    ANQ     -256,DU
         1 000515   645000 116003                    CMPQ    -46592,DU
         1 000516   001030 601000 1                  TNZ     s:1449
         1 000517   000016 236100                    LDQ     14,,PR0
         1 000520   000377 376003                    ANQ     255,DU
         1 000521   000047 116003                    CMPQ    39,DU
         1 000522   001030 601000 1                  TNZ     s:1449

   1386  1 000523   000017 236100                    LDQ     15,,PR0
         1 000524   000000 376000 2                  ANQ     0
         1 000525   000007 276007                    ORQ     7,DL
         1 000526   000017 756100                    STQ     15,,PR0
         1 000527   001030 710000 1                  TRA     s:1449

     1707     1387    3                    ELSE;
     1708     1388    3                 ELSE
     1709     1389    3   M509:            VIP.STEP=IV_NEXTTRACK;

   1389  1 000530   000017 236100       M509         LDQ     15,,PR0
         1 000531   000000 376000 2                  ANQ     0
         1 000532   000001 276007                    ORQ     1,DL
         1 000533   000017 756100                    STQ     15,,PR0
         1 000534   001030 710000 1                  TRA     s:1449
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:361  

     1710     1390    3               CASE(IV_INITTEST);          /* INITIALIZE FOR SURFACE TEST */

     1711     1391    3                 IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN

   1391  1 000535   040000 106500                    CMPC    fill='040'O
         1 000536   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000537   000010 000010 0                  ADSC9   CEDATA+8                 cn=0,n=8
         1 000540   000545 600000 1                  TZE     s:1392
         1 000541   040000 106500                    CMPC    fill='040'O
         1 000542   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000543   000012 000010 0                  ADSC9   CEDATA+10                cn=0,n=8
         1 000544   000552 601000 1                  TNZ     s:1393

     1712     1392    3                    CALL CONVMPC(FMT.SEEK.SECTOR);

   1392  1 000545   200013 236100                    LDQ     FMT$,,AUTO
         1 000546   000005 036000 2                  ADLQ    5
         1 000547   200025 756100                    STQ     VID$+3,,AUTO
         1 000550   001152 701000 1                  TSX1    CONVMPC
         1 000551   000000 011000                    NOP     0

     1713     1393    3                 FMT.IDCW.DC=%WRCMP;

   1393  1 000552   200013 470500                    LDP0    FMT$,,AUTO
         1 000553   330000 236003                    LDQ     110592,DU
         1 000554   000002 752140                    STCQ    2,'40'O,PR0

     1714     1394    3                 FMT.DCW=FMT.DATA_DCW;

   1394  1 000555   000100 100500                    MLR     fill='000'O
         1 000556   000015 000020                    ADSC9   13,,PR0                  cn=0,n=16
         1 000557   000003 000020                    ADSC9   3,,PR0                   cn=0,n=16

     1715     1395    3                 VIP.STEP=IV_COMPTEST;

   1395  1 000560   200003 471500                    LDP1    @VIP,,AUTO
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:362  
         1 000561   100017 236100                    LDQ     15,,PR1
         1 000562   000000 376000 2                  ANQ     0
         1 000563   000005 276007                    ORQ     5,DL
         1 000564   100017 756100                    STQ     15,,PR1

     1716     1396    3                 LOOP='0'B;

   1396  1 000565   200017 450100                    STZ     LOOP,,AUTO
         1 000566   001030 710000 1                  TRA     s:1449

     1717     1397    3               CASE(IV_COMPTEST);          /* SURFACE TEST COMPLETE */

     1718     1398    4                 IF TYC THEN DO;

   1398  1 000567   200004 471500                    LDP1    @TYC,,AUTO
         1 000570   100000 235100                    LDA     0,,PR1
         1 000571   000613 600000 1                  TZE     s:1409

     1719     1399    4                    CALL MARKDT;

   1399  1 000572   001040 701000 1                  TSX1    MARKDT
         1 000573   000000 011000                    NOP     0

     1720     1400    5                    IF VIP.FORMAT THEN DO;

   1400  1 000574   200003 470500                    LDP0    @VIP,,AUTO
         1 000575   000017 236100                    LDQ     15,,PR0
         1 000576   400000 316007                    CANQ    -131072,DL
         1 000577   000607 600000 1                  TZE     s:1405

     1721     1401    5                       VIP.DISKERR='1'B;

   1401  1 000600   001000 236007                    LDQ     512,DL
         1 000601   000017 256100                    ORSQ    15,,PR0

     1722     1402    5                       VIP.STEP=IV_INITFMT;

PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:363  
   1402  1 000602   000017 236100                    LDQ     15,,PR0
         1 000603   000000 376000 2                  ANQ     0
         1 000604   000002 276007                    ORQ     2,DL
         1 000605   000017 756100                    STQ     15,,PR0

     1723     1403    5                       END;

   1403  1 000606   001030 710000 1                  TRA     s:1449

     1724     1404    5                    ELSE DO;

     1725     1405    5                       VIP.STEP=IV_NEXTTRACK;

   1405  1 000607   000000 376000 2                  ANQ     0
         1 000610   000001 276007                    ORQ     1,DL
         1 000611   000017 756100                    STQ     15,,PR0

     1726     1406    5                       END;

     1727     1407    4                    END;

   1407  1 000612   001030 710000 1                  TRA     s:1449

     1728     1408    4                 ELSE DO;

     1729     1409    4                    IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN

   1409  1 000613   040000 106500                    CMPC    fill='040'O
         1 000614   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000615   000010 000010 0                  ADSC9   CEDATA+8                 cn=0,n=8
         1 000616   000623 600000 1                  TZE     s:1410
         1 000617   040000 106500                    CMPC    fill='040'O
         1 000620   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 000621   000012 000010 0                  ADSC9   CEDATA+10                cn=0,n=8
         1 000622   000645 601000 1                  TNZ     s:1413

     1730     1410    4                       IF VIP.CTR.CYL=842 AND VIP.CTR.HD=39 THEN VIP.STEP=IV_INITCE;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:364  

   1410  1 000623   000016 236100                    LDQ     14,,PR0
         1 000624   777400 376003                    ANQ     -256,DU
         1 000625   645000 116003                    CMPQ    -46592,DU
         1 000626   000640 601000 1                  TNZ     s:1412
         1 000627   000016 236100                    LDQ     14,,PR0
         1 000630   000377 376003                    ANQ     255,DU
         1 000631   000047 116003                    CMPQ    39,DU
         1 000632   000640 601000 1                  TNZ     s:1412

   1410  1 000633   000017 236100                    LDQ     15,,PR0
         1 000634   000000 376000 2                  ANQ     0
         1 000635   000007 276007                    ORQ     7,DL
         1 000636   000017 756100                    STQ     15,,PR0
         1 000637   001030 710000 1                  TRA     s:1449

     1731     1411    4                       ELSE
     1732     1412    4                          VIP.STEP=IV_NEXTTRACK;

   1412  1 000640   000017 236100                    LDQ     15,,PR0
         1 000641   000000 376000 2                  ANQ     0
         1 000642   000001 276007                    ORQ     1,DL
         1 000643   000017 756100                    STQ     15,,PR0
         1 000644   001030 710000 1                  TRA     s:1449

     1733     1413    4                    ELSE VIP.STEP=IV_NEXTTRACK;

   1413  1 000645   000017 236100                    LDQ     15,,PR0
         1 000646   000000 376000 2                  ANQ     0
         1 000647   000001 276007                    ORQ     1,DL
         1 000650   000017 756100                    STQ     15,,PR0

     1734     1414    4                    END;

   1414  1 000651   001030 710000 1                  TRA     s:1449

     1735     1415    3               CASE(IV_INITCE);
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:365  

     1736     1416    4                 DO I=0 TO 3 BY 1;

   1416  1 000652   200015 450100                    STZ     I,,AUTO

     1737     1417    4                    DATA(I)=CEDATA(I);

   1417  1 000653   200015 236100                    LDQ     I,,AUTO
         1 000654   000044 402007                    MPY     36,DL
         1 000655   000000 116003                    CMPQ    0,DU
         1 000656   000660 605000 1                  TPL     s:1417+5
         1 000657   000044 036003                    ADLQ    36,DU
         1 000660   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000661   200015 236100                    LDQ     I,,AUTO
         1 000662   000044 402007                    MPY     36,DL
         1 000663   000000 116003                    CMPQ    0,DU
         1 000664   000666 605000 1                  TPL     s:1417+11
         1 000665   000044 036003                    ADLQ    36,DU
         1 000666   200026 235100                    LDA     @SECTOR+1,,AUTO
         1 000667   200006 470500                    LDP0    DATA$,,AUTO
         1 000670   003106 060405                    CSL     bolr='003'O
         1 000671   000000 000044 0                  BDSC    CEDATA,A                 by=0,bit=0,n=36
         1 000672   000000 000044                    BDSC    0,Q,PR0                  by=0,bit=0,n=36

     1738     1418    4                    END;

   1418  1 000673   200015 054100                    AOS     I,,AUTO
         1 000674   200015 235100                    LDA     I,,AUTO
         1 000675   000003 115007                    CMPA    3,DL
         1 000676   000653 604400 1                  TMOZ    s:1417

     1739     1419    4                 DO I=4 TO 575 BY 4;

   1419  1 000677   000004 236007                    LDQ     4,DL
         1 000700   200015 756100                    STQ     I,,AUTO

     1740     1420    5                    DO J=0 TO 3 BY 1;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:366  

   1420  1 000701   200016 450100                    STZ     J,,AUTO

     1741     1421    5                       DATA(I+J)=CEDATA(4+J);

   1421  1 000702   200015 236100                    LDQ     I,,AUTO
         1 000703   200016 036100                    ADLQ    J,,AUTO
         1 000704   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 000705   200016 236100                    LDQ     J,,AUTO
         1 000706   000044 402007                    MPY     36,DL
         1 000707   000000 116003                    CMPQ    0,DU
         1 000710   000712 605000 1                  TPL     s:1421+8
         1 000711   000044 036003                    ADLQ    36,DU
         1 000712   200027 756100                    STQ     @SECTOR+2,,AUTO
         1 000713   200026 236100                    LDQ     @SECTOR+1,,AUTO
         1 000714   000044 402007                    MPY     36,DL
         1 000715   000000 116003                    CMPQ    0,DU
         1 000716   000720 605000 1                  TPL     s:1421+14
         1 000717   000044 036003                    ADLQ    36,DU
         1 000720   200027 235100                    LDA     @SECTOR+2,,AUTO
         1 000721   200006 470500                    LDP0    DATA$,,AUTO
         1 000722   003106 060405                    CSL     bolr='003'O
         1 000723   000004 000044 0                  BDSC    CEDATA+4,A               by=0,bit=0,n=36
         1 000724   000000 000044                    BDSC    0,Q,PR0                  by=0,bit=0,n=36

     1742     1422    5                       END;

   1422  1 000725   200016 054100                    AOS     J,,AUTO
         1 000726   200016 235100                    LDA     J,,AUTO
         1 000727   000003 115007                    CMPA    3,DL
         1 000730   000702 604400 1                  TMOZ    s:1421

     1743     1423    4                    END;

   1423  1 000731   000004 236007                    LDQ     4,DL
         1 000732   200015 056100                    ASQ     I,,AUTO
         1 000733   200015 235100                    LDA     I,,AUTO
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:367  
         1 000734   001077 115007                    CMPA    575,DL
         1 000735   000701 604400 1                  TMOZ    s:1420

     1744     1424    3                 FMT.IDCW.DC=%WRASC;

   1424  1 000736   200013 471500                    LDP1    FMT$,,AUTO
         1 000737   320000 236003                    LDQ     106496,DU
         1 000740   100002 752140                    STCQ    2,'40'O,PR1

     1745     1425    3                 FMT.DCW=FMT.DATA_DCW;

   1425  1 000741   000100 100500                    MLR     fill='000'O
         1 000742   100015 000020                    ADSC9   13,,PR1                  cn=0,n=16
         1 000743   100003 000020                    ADSC9   3,,PR1                   cn=0,n=16

     1746     1426    3                 FMT.DCW.TALLY(0)=576;

   1426  1 000744   001100 236007                    LDQ     576,DL
         1 000745   100003 752103                    STCQ    3,'03'O,PR1

     1747     1427    3                 FMT.SEEK.SCL=0;

   1427  1 000746   000006 236000 2                  LDQ     6
         1 000747   100007 356100                    ANSQ    7,,PR1

     1748     1428    3                 FMT.SEEK.Y='1'B;

   1428  1 000750   000010 236003                    LDQ     8,DU
         1 000751   100007 256100                    ORSQ    7,,PR1

     1749     1429    3                 FMT.SEEK.SEC.ELT='1'B;

   1429  1 000752   000004 236003                    LDQ     4,DU
         1 000753   100007 256100                    ORSQ    7,,PR1

     1750     1430    3                 VIP.STEP=IV_COMPCE;

PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:368  
   1430  1 000754   200003 473500                    LDP3    @VIP,,AUTO
         1 000755   300017 236100                    LDQ     15,,PR3
         1 000756   000000 376000 2                  ANQ     0
         1 000757   000010 276007                    ORQ     8,DL
         1 000760   300017 756100                    STQ     15,,PR3

     1751     1431    3                 LOOP='0'B;

   1431  1 000761   200017 450100                    STZ     LOOP,,AUTO
         1 000762   001030 710000 1                  TRA     s:1449

     1752     1432    3               CASE(IV_COMPCE);

     1753     1433    4                 IF TYC THEN DO;

   1433  1 000763   200004 471500                    LDP1    @TYC,,AUTO
         1 000764   100000 235100                    LDA     0,,PR1
         1 000765   000776 600000 1                  TZE     s:1438

     1754     1434    4                    CALL MARKDT;

   1434  1 000766   001040 701000 1                  TSX1    MARKDT
         1 000767   000000 011000                    NOP     0

     1755     1435    4                    VIP.STEP=IV_DONE;

   1435  1 000770   200003 470500                    LDP0    @VIP,,AUTO
         1 000771   000017 236100                    LDQ     15,,PR0
         1 000772   000000 376000 2                  ANQ     0
         1 000773   000006 276007                    ORQ     6,DL
         1 000774   000017 756100                    STQ     15,,PR0

     1756     1436    4                    END;

   1436  1 000775   001030 710000 1                  TRA     s:1449

     1757     1437    4                 ELSE DO;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:369  

     1758     1438    4                    IF FMT.SEEK.SCL>= 7 THEN VIP.STEP=IV_DONE;

   1438  1 000776   200013 473500                    LDP3    FMT$,,AUTO
         1 000777   300007 236100                    LDQ     7,,PR3
         1 001000   776000 376003                    ANQ     -1024,DU
         1 001001   016000 116003                    CMPQ    7168,DU
         1 001002   001010 602000 1                  TNC     s:1440

   1438  1 001003   000017 236100                    LDQ     15,,PR0
         1 001004   000000 376000 2                  ANQ     0
         1 001005   000006 276007                    ORQ     6,DL
         1 001006   000017 756100                    STQ     15,,PR0
         1 001007   001030 710000 1                  TRA     s:1449

     1759     1439    5                    ELSE DO;

     1760     1440    5                       FMT.SEEK.SCL=FMT.SEEK.SCL+1;

   1440  1 001010   300007 236100                    LDQ     7,,PR3
         1 001011   000034 772000                    QRL     28
         1 001012   000001 036007                    ADLQ    1,DL
         1 001013   000034 736000                    QLS     28
         1 001014   300007 676100                    ERQ     7,,PR3
         1 001015   776000 376003                    ANQ     -1024,DU
         1 001016   300007 656100                    ERSQ    7,,PR3

     1761     1441    5                       LOOP='0'B;

   1441  1 001017   200017 450100                    STZ     LOOP,,AUTO

     1762     1442    5                       VIP.STEP=IV_COMPCE;

   1442  1 001020   000017 236100                    LDQ     15,,PR0
         1 001021   000000 376000 2                  ANQ     0
         1 001022   000010 276007                    ORQ     8,DL
         1 001023   000017 756100                    STQ     15,,PR0
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:370  

     1763     1443    5                       END;

     1764     1444    4                    END;

   1444  1 001024   001030 710000 1                  TRA     s:1449

     1765     1445    3               CASE(IV_DONE);              /* VOLINIT DONE */

     1766     1446    3                 VIP.DONE='1'B;

   1446  1 001025   020000 236007                    LDQ     8192,DL
         1 001026   000017 256100                    ORSQ    15,,PR0

     1767     1447    3                 ALTRETURN;

   1447  1 001027   000000 702200 xent               TSX2  ! X66_AALT

     1768     1448    3               END;

     1769     1449    2              END;

   1449  1 001030   200017 234100                    SZN     LOOP,,AUTO
         1 001031   000033 604000 1                  TMI     s:1310

     1770     1450    2           DO INHIBIT;

     1771     1451    2              VIP.IO$=IV_IO$;

   1451  1 001032   000000 236200 xsym               LDQ   ! IV_IO$
         1 001033   200003 470700                    LDP0  ! @VIP,,AUTO
         1 001034   000001 756300                    STQ   ! 1,,PR0

     1772     1452    2              IV_IO$=ADDR(VIP);

   1452  1 001035   200003 236300                    LDQ   ! @VIP,,AUTO
         1 001036   000000 756200 xsym               STQ   ! IV_IO$
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:371  

     1773     1453    2              END;

     1774     1454    1           RETURN;

   1454  1 001037   000000 702200 xent               TSX2  ! X66_ARET

     1775     1455        %EJECT;
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:372  
     1776     1456    1   MARKDT: PROC;

   1456  1 001040   200024 741300       MARKDT       STX1  ! VID$+2,,AUTO

     1777     1457    2           IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN;

   1457  1 001041   200003 470500                    LDP0    @VIP,,AUTO
         1 001042   040000 106500                    CMPC    fill='040'O
         1 001043   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 001044   000010 000010 0                  ADSC9   CEDATA+8                 cn=0,n=8
         1 001045   001105 600000 1                  TZE     s:1463
         1 001046   040000 106500                    CMPC    fill='040'O
         1 001047   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
         1 001050   000012 000010 0                  ADSC9   CEDATA+10                cn=0,n=8
         1 001051   001105 600000 1                  TZE     s:1463

     1778     1458    3           ELSE DO;

     1779     1459    3              J=FMT.SEEK.SECTOR/VIP.NSECTS;

   1459  1 001052   000014 236100                    LDQ     12,,PR0
         1 001053   000033 772000                    QRL     27
         1 001054   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 001055   200013 471500                    LDP1    FMT$,,AUTO
         1 001056   100007 236100                    LDQ     7,,PR1
         1 001057   000004 376000 2                  ANQ     4
         1 001060   200026 506100                    DIV     @SECTOR+1,,AUTO
         1 001061   200016 756100                    STQ     J,,AUTO

     1780     1460    3              TR.CYL=J/VIP.NHEADS;

   1460  1 001062   000014 236100                    LDQ     12,,PR0
         1 001063   000022 772000                    QRL     18
         1 001064   000777 376007                    ANQ     511,DL
         1 001065   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 001066   200016 236100                    LDQ     J,,AUTO
         1 001067   200026 506100                    DIV     @SECTOR+1,,AUTO
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:373  
         1 001070   000032 736000                    QLS     26
         1 001071   200020 676100                    ERQ     TRACK,,AUTO
         1 001072   777400 376003                    ANQ     -256,DU
         1 001073   200020 656100                    ERSQ    TRACK,,AUTO

     1781     1461    3              TR.HD=MOD(J,VIP.NHEADS);

   1461  1 001074   000014 236100                    LDQ     12,,PR0
         1 001075   000022 772000                    QRL     18
         1 001076   000777 376007                    ANQ     511,DL
         1 001077   200026 756100                    STQ     @SECTOR+1,,AUTO
         1 001100   200016 236100                    LDQ     J,,AUTO
         1 001101   200026 506100                    DIV     @SECTOR+1,,AUTO
         1 001102   000044 733000                    LRS     36
         1 001103   000022 736000                    QLS     18
         1 001104   200020 752110                    STCQ    TRACK,'10'O,AUTO

     1782     1462    3              END;

     1783     1463    2           VID$=VIP.VID$;

   1463  1 001105   000012 236100                    LDQ     10,,PR0
         1 001106   200022 756100                    STQ     VID$,,AUTO

     1784     1464    3           DO I=0 TO 62;

   1464  1 001107   200015 450100                    STZ     I,,AUTO

     1785     1465    4              IF VID.DTT(I)=BITBIN('777777'O) THEN DO;

   1465  1 001110   200022 470500                    LDP0    VID$,,AUTO
         1 001111   200015 720100                    LXL0    I,,AUTO
         1 001112   000400 221110                    LDX1    256,X0,PR0
         1 001113   777777 101003                    CMPX1   -1,DU
         1 001114   001137 601000 1                  TNZ     s:1473

     1786     1466    4                 IF VIP.MODEL='MSU0501 ' OR VIP.MODEL='MSU0509 ' THEN
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:374  

   1466  1 001115   200003 471500                    LDP1    @VIP,,AUTO
         1 001116   040000 106500                    CMPC    fill='040'O
         1 001117   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 001120   000010 000010 0                  ADSC9   CEDATA+8                 cn=0,n=8
         1 001121   001126 600000 1                  TZE     s:1467
         1 001122   040000 106500                    CMPC    fill='040'O
         1 001123   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 001124   000012 000010 0                  ADSC9   CEDATA+10                cn=0,n=8
         1 001125   001131 601000 1                  TNZ     s:1469

     1787     1467    4                    VID.DTT(I)=VIP.CTRACK;

   1467  1 001126   100016 222100                    LDX2    14,,PR1
         1 001127   000400 742110                    STX2    256,X0,PR0
         1 001130   001133 710000 1                  TRA     s:1470

     1788     1468    4                 ELSE
     1789     1469    4                    VID.DTT(I)=TRACK;

   1469  1 001131   200020 222100                    LDX2    TRACK,,AUTO
         1 001132   000400 742110                    STX2    256,X0,PR0

     1790     1470    4                 VIP.DTTCH='1'B;

   1470  1 001133   004000 236007                    LDQ     2048,DL
         1 001134   100017 256100                    ORSQ    15,,PR1

     1791     1471    4                 RETURN;

   1471  1 001135   200024 221300                    LDX1  ! VID$+2,,AUTO
         1 001136   000001 702211                    TSX2  ! 1,X1

     1792     1472    4                 END;
     1793     1473    3              END;

   1473  1 001137   200015 054100                    AOS     I,,AUTO
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:375  
         1 001140   200015 235100                    LDA     I,,AUTO
         1 001141   000076 115007                    CMPA    62,DL
         1 001142   001110 604400 1                  TMOZ    s:1465

     1794     1474    2           VIP.DTTOVF='1'B;

   1474  1 001143   200003 471500                    LDP1    @VIP,,AUTO
         1 001144   002000 236007                    LDQ     1024,DL
         1 001145   100017 256100                    ORSQ    15,,PR1

     1795     1475    2           VIP.STOP='1'B;

   1475  1 001146   010000 236007                    LDQ     4096,DL
         1 001147   100017 256100                    ORSQ    15,,PR1

     1796     1476    2           RETURN;

   1476  1 001150   200024 221300                    LDX1  ! VID$+2,,AUTO
         1 001151   000001 702211                    TSX2  ! 1,X1

     1797     1477    2   END MARKDT;
     1798     1478
     1799     1479
     1800     1480    1   CONVMPC: PROC(SECTOR);

   1480  1 001152   200024 741300       CONVMPC      STX1  ! VID$+2,,AUTO

     1801     1481    2   DCL SECTOR BIT(36) ALIGNED;
     1802     1482    2   DCL 1 SEC REDEF SECTOR ALIGNED,
     1803     1483    2         2 * UBIN(20) UNAL,
     1804     1484    2         2 CL UBIN(8) UNAL,
     1805     1485    2         2 CU UBIN(2) UNAL,
     1806     1486    2         2 HD UBIN(6) UNAL;
     1807     1487    2           SEC.CL=TR.CY.LWR;

   1487  1 001153   200025 470500                    LDP0    @SECTOR,,AUTO
         1 001154   200020 236100                    LDQ     TRACK,,AUTO
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:376  
         1 001155   000022 772000                    QRL     18
         1 001156   000000 676100                    ERQ     0,,PR0
         1 001157   177400 376007                    ANQ     65280,DL
         1 001160   000000 656100                    ERSQ    0,,PR0

     1808     1488    2           SEC.CU=TR.CY.UPR;

   1488  1 001161   200020 236100                    LDQ     TRACK,,AUTO
         1 001162   000034 772000                    QRL     28
         1 001163   000000 676100                    ERQ     0,,PR0
         1 001164   000300 376007                    ANQ     192,DL
         1 001165   000000 656100                    ERSQ    0,,PR0

     1809     1489    2           SEC.HD=TR.HD;

   1489  1 001166   200020 236100                    LDQ     TRACK,,AUTO
         1 001167   000022 772000                    QRL     18
         1 001170   000000 752101                    STCQ    0,'01'O,PR0

     1810     1490
     1811     1491    2   END CONVMPC;

   1491  1 001171   200024 221300                    LDX1  ! VID$+2,,AUTO
         1 001172   000001 702211                    TSX2  ! 1,X1

CEDATA
 Sect OctLoc
   0     000   252252 252252   252252 252252   252252 377377   377377 377377    ................
   0     004   377377 252252   252252 252252   252252 377377   377377 377377    ................

(unnamed)
 Sect OctLoc
   0     010   115123 125060   065060 061040   115123 125060   065060 071040    MSU0501 MSU0509
   0     014   357700 720000   367700 720000   115123 125065   060071 040040    ........MSU509

(unnamed)
 Sect OctLoc
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:377  
   2     000   777777 777600   777777 776777   777400 777777   000377 777777    ................
   2     004   000007 777777   000007 260000   001777 777777                    ............
     1812     1492    1   END IVV$NEXT;
     1813     1493        %EOD;

PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:378  
--  Include file information  --

   NI$TABLES.:E05TOU  is referenced.
   IV$MACROS.:E05TOU  is referenced.
   FM$GRAN.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure IVV$NEXT.
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:379  

 **** Variables and constants ****

  ****  Section 000 RoData IVV$NEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 CEDATA(0:7)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    25-0-0/w PTR         r     1 @SECTOR                    4-0-0/w PTR         r     1 @TYC
     3-0-0/w PTR         r     1 @VIP                       6-0-0/w PTR         r     1 DATA$
    14-0-0/w PTR         r     1 DVT$                      13-0-0/w PTR         r     1 FMT$
     5-0-0/w PTR         r     1 HDR5$                     15-0-0/w SBIN        r     1 I
    16-0-0/w SBIN        r     1 J                         17-0-0/w BIT         r     1 LOOP
    *0-0-0/w STRC        r     1 SEC                       *0-0-0/w BIT         r     1 SECTOR
    20-0-0/w STRC(18)    r     1 TR                        20-0-0/w UBIN(18)    r     1 TRACK
    *0-0-0/w BIT         r     1 TYC                       22-0-0/w PTR         r     1 VID$
    *0-0-0/w STRC(3024)  r     1 VIP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 IV_IO$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 DATA(0:575)                0-0-0/w STRC(828)   r     1 FMT
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:380  
     0-0-0/w STRC(36864) r     1 VID


   Procedure IVV$NEXT requires 635 words for executable code.
   Procedure IVV$NEXT requires 28 words of local(AUTO) storage.
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:381  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:382  
          MINI XREF LISTING

CEDATA
      1262**DCL      1417>>ASSIGN   1421>>ASSIGN
CF.C0.TSKIP
      1023**DCL      1024--REDEF
CONVMPC
      1480**PROC     1370--CALL     1392--CALL
DATA
      1272**DCL      1417<<ASSIGN   1421<<ASSIGN
DATA$
      1010**DCL      1272--IMP-PTR  1305<<ASSIGN   1417>>ASSIGN   1421>>ASSIGN
DVT.MPC
      1254**DCL      1255--REDEF
DVT$
      1273**DCL      1252--IMP-PTR
ELT.HEADER
      1226**DCL      1242--REDEF    1243--REDEF
ELT.SEEK.SECTOR
      1210**DCL      1211--REDEF
FMT.DATA_DCW
      1166**DCL      1394>>ASSIGN   1425>>ASSIGN
FMT.DCW
      1145**DCL      1368<<ASSIGN   1394<<ASSIGN   1425<<ASSIGN
FMT.DCW.TALLY
      1148**DCL      1426<<ASSIGN
FMT.HEADER
      1170**DCL      1186--REDEF    1187--REDEF    1305--ASSIGN
FMT.HEADER_DCW
      1162**DCL      1368>>ASSIGN
FMT.IDCW.DC
      1143**DCL      1367<<ASSIGN   1393<<ASSIGN   1424<<ASSIGN
FMT.SEEK.SCL
      1150**DCL      1427<<ASSIGN   1438>>IF       1440<<ASSIGN   1440>>ASSIGN
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:383  
FMT.SEEK.SEC.ELT
      1156**DCL      1429<<ASSIGN
FMT.SEEK.SECTOR
      1154**DCL      1155--REDEF    1344<<ASSIGN   1344>>ASSIGN   1345>>ASSIGN   1349<<ASSIGN   1357<<ASSIGN
      1370<>CALL     1392<>CALL     1459>>ASSIGN
FMT.SEEK.Y
      1153**DCL      1428<<ASSIGN
FMT.SEEK_IDCW
      1135**DCL      1362<<ASSIGN   1363<<ASSIGN
FMT$
      1271**DCL      1134--IMP-PTR  1302<<ASSIGN   1305>>ASSIGN   1344>>ASSIGN   1344>>ASSIGN   1345>>ASSIGN
      1349>>ASSIGN   1357>>ASSIGN   1362>>ASSIGN   1363>>ASSIGN   1367>>ASSIGN   1368>>ASSIGN   1368>>ASSIGN
      1370>>CALL     1392>>CALL     1393>>ASSIGN   1394>>ASSIGN   1394>>ASSIGN   1424>>ASSIGN   1425>>ASSIGN
      1425>>ASSIGN   1426>>ASSIGN   1427>>ASSIGN   1428>>ASSIGN   1429>>ASSIGN   1438>>IF       1440>>ASSIGN
      1440>>ASSIGN   1459>>ASSIGN
HDR5$
      1009**DCL      1012--IMP-PTR
I
      1274**DCL      1416<<DOINDEX  1417>>ASSIGN   1417>>ASSIGN   1419<<DOINDEX  1421>>ASSIGN   1464<<DOINDEX
      1465>>IF       1467>>ASSIGN   1469>>ASSIGN
IVV$HEADER
      1115**DCL-ENT  1371--CALL
IV_IO$
      1261**DCL      1451>>ASSIGN   1452<<ASSIGN
J
      1275**DCL      1345<<ASSIGN   1346>>ASSIGN   1347>>ASSIGN   1420<<DOINDEX  1421>>ASSIGN   1421>>ASSIGN
      1459<<ASSIGN   1460>>ASSIGN   1461>>ASSIGN
LOOP
      1276**DCL      1308<<ASSIGN   1309>>DOWHILE  1373<<ASSIGN   1396<<ASSIGN   1431<<ASSIGN   1441<<ASSIGN
M509
      1389**LABEL    1384--GOTO
MARKDT
      1456**PROC     1376--CALL     1399--CALL     1434--CALL
SEC.CL IN PROCEDURE CONVMPC
      1484**DCL      1487<<ASSIGN
SEC.CU IN PROCEDURE CONVMPC
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:384  
      1485**DCL      1488<<ASSIGN
SEC.HD IN PROCEDURE CONVMPC
      1486**DCL      1489<<ASSIGN
SECTOR IN PROCEDURE CONVMPC
      1481**DCL      1480--PROC     1482--REDEF
TR.CY.LWR
      1282**DCL      1487>>ASSIGN
TR.CY.UPR
      1281**DCL      1488>>ASSIGN
TR.CYL
      1279**DCL      1280--REDEF    1346<<ASSIGN   1348>>IF       1350<<ASSIGN   1361>>IF       1460<<ASSIGN
TR.HD
      1284**DCL      1347<<ASSIGN   1348>>IF       1351<<ASSIGN   1461<<ASSIGN   1489>>ASSIGN
TRACK
      1277**DCL      1278--REDEF    1306<<ASSIGN   1341<<ASSIGN   1353>>IF       1358<<ASSIGN   1469>>ASSIGN
TYC
      1111**DCL         8--PROC     1375>>IF       1398>>IF       1433>>IF
VID.DTT
      1248**DCL      1248--REDEF    1465>>IF       1467<<ASSIGN   1469<<ASSIGN
VID$
      1286**DCL      1246--IMP-PTR  1463<<ASSIGN   1465>>IF       1467>>ASSIGN   1469>>ASSIGN
VIP
      1048**DCL         8--PROC     1371<>CALL     1452--ASSIGN
VIP.CRANGE
      1063**DCL      1322>>IF       1331<<ASSIGN   1331>>ASSIGN   1332>>IF       1333>>ASSIGN   1353>>IF
      1354<<ASSIGN   1354>>ASSIGN   1355>>IF       1357>>ASSIGN   1357>>ASSIGN   1358>>ASSIGN
VIP.CTR.CYL
      1066**DCL      1327<<ASSIGN   1327>>ASSIGN   1337>>IF       1338<<ASSIGN   1386>>IF       1410>>IF
VIP.CTR.HD
      1067**DCL      1323>>IF       1324<<ASSIGN   1324>>ASSIGN   1326<<ASSIGN   1337>>IF       1339<<ASSIGN
      1386>>IF       1410>>IF
VIP.CTRACK
      1064**DCL      1065--REDEF    1306>>ASSIGN   1322>>IF       1333<<ASSIGN   1341>>ASSIGN   1467>>ASSIGN
VIP.DISKERR
      1079**DCL      1319<<ASSIGN   1375>>IF       1377<<ASSIGN   1381>>IF       1401<<ASSIGN
VIP.DONE
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:385  
      1075**DCL      1446<<ASSIGN
VIP.DTTCH
      1077**DCL      1470<<ASSIGN
VIP.DTTOVF
      1078**DCL      1474<<ASSIGN
VIP.ELT$
      1052**DCL      1190--IMP-PTR
VIP.FMT$
      1058**DCL      1302>>ASSIGN
VIP.FORMAT
      1071**DCL      1312>>IF       1400>>IF
VIP.GRANSIZE
      1084**DCL      1362>>IF
VIP.IO$
      1050**DCL      1451<<ASSIGN
VIP.MODEL
      1055**DCL      1303>>IF       1303>>IF       1320>>IF       1320>>IF       1369>>IF       1369>>IF
      1384>>IF       1385>>IF       1391>>IF       1391>>IF       1409>>IF       1409>>IF       1457>>IF
      1457>>IF       1466>>IF       1466>>IF
VIP.NCYLS
      1061**DCL      1348>>IF
VIP.NHEADS
      1060**DCL      1323>>IF       1346>>ASSIGN   1347>>ASSIGN   1349>>ASSIGN   1357>>ASSIGN   1460>>ASSIGN
      1461>>ASSIGN
VIP.NRANGES
      1083**DCL      1332>>IF       1355>>IF
VIP.NSECTS
      1059**DCL      1344>>ASSIGN   1345>>ASSIGN   1349>>ASSIGN   1357>>ASSIGN   1459>>ASSIGN
VIP.RANGE.FT.CYL
      1104**DCL      1357>>ASSIGN
VIP.RANGE.FT.HD
      1105**DCL      1357>>ASSIGN
VIP.RANGE.FTRACK
      1102**DCL      1103--REDEF    1333>>ASSIGN   1358>>ASSIGN
VIP.RANGE.LTRACK
      1106**DCL      1107--REDEF    1322>>IF       1353>>IF
PL6.E3A0      #006=IVV$NEXT File=IVV$VOLINIT.:E05TSI                             TUE 07/29/97 23:20 Page:386  
VIP.STEP
      1082**DCL      1301<<ASSIGN   1310>>DOCASE   1313<<ASSIGN   1315<<ASSIGN   1316<<ASSIGN   1318<<ASSIGN
      1335<<ASSIGN   1355<<ASSIGN   1372<<ASSIGN   1378<<ASSIGN   1382<<ASSIGN   1386<<ASSIGN   1389<<ASSIGN
      1395<<ASSIGN   1402<<ASSIGN   1405<<ASSIGN   1410<<ASSIGN   1412<<ASSIGN   1413<<ASSIGN   1430<<ASSIGN
      1435<<ASSIGN   1438<<ASSIGN   1442<<ASSIGN
VIP.STOP
      1076**DCL      1301>>IF       1475<<ASSIGN
VIP.T@DCYL
      1062**DCL      1349>>ASSIGN   1350>>ASSIGN   1361>>IF
VIP.TEST
      1073**DCL      1314>>IF       1381>>IF
VIP.VID$
      1057**DCL      1463>>ASSIGN

PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:387  
     1814        1        /*T***********************************************************/
     1815        2        /*T*                                                         */
     1816        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1817        4        /*T*                                                         */
     1818        5        /*T***********************************************************/
     1819        6        /* GENERATE FORMAT PACKAGE FOR MSU050X DISK PACK */
     1820        7        IVV$FMTPAC: PROC (VIP,FMT$) ALTRET;
     1821        8
     1822        9        /* INCLUDE FILES */
     1823       10        /**/
     1824       11        %INCLUDE NI$TABLES;
     1825      227        %INCLUDE CP_6_SUBS;
     1826      767        %INCLUDE IV$MACROS;
     1827      937                                           /* Storage structure for MSU050X header */
     1828      938    1   DCL HDR5$ PTR;
     1829      939    1   DCL DATA$ PTR;
     1830      940        %IV$HDR(NAME=CF,STCLASS="BASED(HDR5$)");
     1831      968
     1832      969    1   DCL 1 LOG(0:3071) BASED(DATA$) UNAL,
     1833      970    1         2 CYL UBIN(16) UNAL,
     1834      971    1         2 HD UBIN(8) UNAL,
     1835      972    1         2 POS UBIN(16) UNAL,
     1836      973    1         2 LTH UBIN(8) UNAL;
     1837      974
     1838      975    1   DCL 1 SKIP(0:1) UNAL,
     1839      976    1         2 S BIT(4),
     1840      977    1         2 SK UBIN(12);
     1841      978
     1842      979        /* PARAMETERS */
     1843      980        /**/
     1844      981        %IV$VIP(NAME=VIP,STCLASS="");
     1845     1045        %IV$FMT(NAME=FMT,STCLASS="BASED(FMT$)");
     1846     1101        %NI$DVT(NAME=DVT,STCLASS="BASED(DVT$)");
     1847     1108    1   DCL FMT$ PTR;
     1848     1109    1   DCL DVT$ PTR;
     1849     1110    1   DCL I SBIN;
     1850     1111        /* EXTERNAL REFERENCES */
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:388  
     1851     1112        /**/
     1852     1113    1   DCL DCWBUILD ENTRY(3);
     1853     1114    1   DCL IVO$GET ENTRY (2) ALTRET;
     1854     1115    1   DCL IVV$ERROR ENTRY (3);
     1855     1116        /* SUBSTITUTIONS */
     1856     1117        /**/
     1857     1118        %SUB NULL="ADDR(NIL)";
     1858     1119
     1859     1120        %EJECT;
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:389  
     1860     1121    1           DVT$=VIP.DVT$;
     1861     1122    1           I=SIZEW(FMT)+VIP.NSECTS*DVT.SECSIZE+82; /* 82 WDS FOR C0-C39 */
     1862     1123    1           FMT$=NULL;
     1863     1124    1           CALL IVO$GET(FMT$,I)ALTRET(NO_SPACE_1);
     1864     1125    1           FMT='0'B;
     1865     1126    1           FMT.BOUND=I*4-1;
     1866     1127    1           FMT.SEEK_IDCW='357700720000'O;  /* TDSEEK512=35 OCT. RD_HEADER=27 */
     1867     1128    1           FMT.SEEK_DCW.FWA=POFFW(ADDR(FMT.SEEK),FMT$);
     1868     1129    1           FMT.SEEK_DCW.TALLY=1;
     1869     1130    1           FMT.IDCW='277700702700'O;  /* CHANNEL CMD TO READ ELT BIT24-29=27 */
     1870     1131    1           IF VIP.MODEL='MSU0509 ' OR VIP.MODEL='MSU0501 ' THEN I=24;
     1871     1132    1           ELSE I=5;
     1872     1133    1           CALL DCWBUILD(FMT.HEADER_DCW,SIZEW(FMT)-SIZEW(FMT.HEADER),I);
     1873     1134    1           CALL DCWBUILD(FMT.DATA_DCW,SIZEW(FMT)-SIZEW(FMT.HEADER)+88,
     1874     1135    1             VIP.NSECTS*DVT.SECSIZE);
     1875     1136    1           RETURN;
     1876     1137    2           DO WHILE ('0'B);
     1877     1138    2   NO_SPACE_1:                             /* NO SPACE FOR FMT */
     1878     1139    2              CALL IVV$ERROR(VIP.DEVID,9);
     1879     1140    2              END;
     1880     1141    1           ALTRETURN;
     1881     1142    1   END IVV$FMTPAC;

PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:390  
--  Include file information  --

   IV$MACROS.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
      No diagnostics issued in procedure IVV$FMTPAC.

   Procedure IVV$FMTPAC requires 114 words for executable code.
   Procedure IVV$FMTPAC requires 20 words of local(AUTO) storage.

    No errors detected in file IVV$VOLINIT.:E05TSI    .

PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:391  

 Object Unit name= IVV$FMTPAC                                 File name= IVV$VOLINIT.:E05TOU
 UTS= JUL 29 '97 23:21:08.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      6      6  IVV$FMTPAC
    1   Proc  even  none   114    162  IVV$FMTPAC
    2  RoData even  none     5      5  IVV$FMTPAC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  IVV$FMTPAC

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 IVO$GET
         yes           Std       3 DCWBUILD
         yes           Std       3 IVV$ERROR
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:392  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:393  


     1814        1        /*T***********************************************************/
     1815        2        /*T*                                                         */
     1816        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1817        4        /*T*                                                         */
     1818        5        /*T***********************************************************/
     1819        6        /* GENERATE FORMAT PACKAGE FOR MSU050X DISK PACK */
     1820        7        IVV$FMTPAC: PROC (VIP,FMT$) ALTRET;

      7  1 000000   000000 700200 xent  IVV$FMTPAC   TSX0  ! X66_AUTO_2
         1 000001   000024 000002                    ZERO    20,2

     1821        8
     1822        9        /* INCLUDE FILES */
     1823       10        /**/
     1824       11        %INCLUDE NI$TABLES;
     1825      227        %INCLUDE CP_6_SUBS;
     1826      767        %INCLUDE IV$MACROS;
     1827      937                                           /* Storage structure for MSU050X header */
     1828      938    1   DCL HDR5$ PTR;
     1829      939    1   DCL DATA$ PTR;
     1830      940        %IV$HDR(NAME=CF,STCLASS="BASED(HDR5$)");
     1831      968
     1832      969    1   DCL 1 LOG(0:3071) BASED(DATA$) UNAL,
     1833      970    1         2 CYL UBIN(16) UNAL,
     1834      971    1         2 HD UBIN(8) UNAL,
     1835      972    1         2 POS UBIN(16) UNAL,
     1836      973    1         2 LTH UBIN(8) UNAL;
     1837      974
     1838      975    1   DCL 1 SKIP(0:1) UNAL,
     1839      976    1         2 S BIT(4),
     1840      977    1         2 SK UBIN(12);
     1841      978
     1842      979        /* PARAMETERS */
     1843      980        /**/
     1844      981        %IV$VIP(NAME=VIP,STCLASS="");
     1845     1045        %IV$FMT(NAME=FMT,STCLASS="BASED(FMT$)");
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:394  
     1846     1101        %NI$DVT(NAME=DVT,STCLASS="BASED(DVT$)");
     1847     1108    1   DCL FMT$ PTR;
     1848     1109    1   DCL DVT$ PTR;
     1849     1110    1   DCL I SBIN;
     1850     1111        /* EXTERNAL REFERENCES */
     1851     1112        /**/
     1852     1113    1   DCL DCWBUILD ENTRY(3);
     1853     1114    1   DCL IVO$GET ENTRY (2) ALTRET;
     1854     1115    1   DCL IVV$ERROR ENTRY (3);
     1855     1116        /* SUBSTITUTIONS */
     1856     1117        /**/
     1857     1118        %SUB NULL="ADDR(NIL)";
     1858     1119
     1859     1120        %EJECT;
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:395  
     1860     1121    1           DVT$=VIP.DVT$;

   1121  1 000002   200003 470500                    LDP0    @VIP,,AUTO
         1 000003   000002 236100                    LDQ     2,,PR0
         1 000004   200013 756100                    STQ     DVT$,,AUTO

     1861     1122    1           I=SIZEW(FMT)+VIP.NSECTS*DVT.SECSIZE+82; /* 82 WDS FOR C0-C39 */

   1122  1 000005   200013 471500                    LDP1    DVT$,,AUTO
         1 000006   100056 236100                    LDQ     46,,PR1
         1 000007   000022 772000                    QRL     18
         1 000010   200016 756100                    STQ     I+2,,AUTO
         1 000011   000014 236100                    LDQ     12,,PR0
         1 000012   000033 772000                    QRL     27
         1 000013   200016 402100                    MPY     I+2,,AUTO
         1 000014   000151 036007                    ADLQ    105,DL
         1 000015   200014 756100                    STQ     I,,AUTO

     1862     1123    1           FMT$=NULL;

   1123  1 000016   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000017   200004 473500                    LDP3    @FMT$,,AUTO
         1 000020   300000 756100                    STQ     0,,PR3

     1863     1124    1           CALL IVO$GET(FMT$,I)ALTRET(NO_SPACE_1);

   1124  1 000021   200014 634500                    EPPR4   I,,AUTO
         1 000022   200017 454500                    STP4    I+3,,AUTO
         1 000023   200004 236100                    LDQ     @FMT$,,AUTO
         1 000024   200016 756100                    STQ     I+2,,AUTO
         1 000025   200016 630500                    EPPR0   I+2,,AUTO
         1 000026   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000027   000000 701000 xent               TSX1    IVO$GET
         1 000030   000150 702000 1                  TSX2    NO_SPACE_1

     1864     1125    1           FMT='0'B;

PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:396  
   1125  1 000031   200004 470500                    LDP0    @FMT$,,AUTO
         1 000032   000000 471500                    LDP1    0,,PR0
         1 000033   000100 100400                    MLR     fill='000'O
         1 000034   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000035   100000 000134                    ADSC9   0,,PR1                   cn=0,n=92

     1865     1126    1           FMT.BOUND=I*4-1;

   1126  1 000036   000000 471500                    LDP1    0,,PR0
         1 000037   200014 235100                    LDA     I,,AUTO
         1 000040   000002 735000                    ALS     2
         1 000041   000001 135007                    SBLA    1,DL
         1 000042   100010 755100                    STA     8,,PR1

     1866     1127    1           FMT.SEEK_IDCW='357700720000'O;  /* TDSEEK512=35 OCT. RD_HEADER=27 */

   1127  1 000043   000000 471500                    LDP1    0,,PR0
         1 000044   000000 236000 0                  LDQ     0
         1 000045   100000 756100                    STQ     0,,PR1

     1867     1128    1           FMT.SEEK_DCW.FWA=POFFW(ADDR(FMT.SEEK),FMT$);

   1128  1 000046   000000 471500                    LDP1    0,,PR0
         1 000047   200016 451500                    STP1    I+2,,AUTO
         1 000050   200016 236100                    LDQ     I+2,,AUTO
         1 000051   000007 036003                    ADLQ    7,DU
         1 000052   000022 772000                    QRL     18
         1 000053   200017 756100                    STQ     I+3,,AUTO
         1 000054   000000 236100                    LDQ     0,,PR0
         1 000055   000022 772000                    QRL     18
         1 000056   200020 756100                    STQ     I+4,,AUTO
         1 000057   200017 236100                    LDQ     I+3,,AUTO
         1 000060   200020 136100                    SBLQ    I+4,,AUTO
         1 000061   000000 620006                    EAX0    0,QL
         1 000062   100001 740100                    STX0    1,,PR1

     1868     1129    1           FMT.SEEK_DCW.TALLY=1;
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:397  

   1129  1 000063   000000 471500                    LDP1    0,,PR0
         1 000064   000001 236007                    LDQ     1,DL
         1 000065   100001 752103                    STCQ    1,'03'O,PR1

     1869     1130    1           FMT.IDCW='277700702700'O;  /* CHANNEL CMD TO READ ELT BIT24-29=27 */

   1130  1 000066   000000 471500                    LDP1    0,,PR0
         1 000067   000001 236000 0                  LDQ     1
         1 000070   100002 756100                    STQ     2,,PR1

     1870     1131    1           IF VIP.MODEL='MSU0509 ' OR VIP.MODEL='MSU0501 ' THEN I=24;

   1131  1 000071   200003 471500                    LDP1    @VIP,,AUTO
         1 000072   040000 106500                    CMPC    fill='040'O
         1 000073   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000074   000002 000010 0                  ADSC9   2                        cn=0,n=8
         1 000075   000102 600000 1                  TZE     s:1131+9
         1 000076   040000 106500                    CMPC    fill='040'O
         1 000077   100007 000010                    ADSC9   7,,PR1                   cn=0,n=8
         1 000100   000004 000010 0                  ADSC9   4                        cn=0,n=8
         1 000101   000105 601000 1                  TNZ     s:1132

   1131  1 000102   000030 235007                    LDA     24,DL
         1 000103   200014 755100                    STA     I,,AUTO
         1 000104   000107 710000 1                  TRA     s:1133

     1871     1132    1           ELSE I=5;

   1132  1 000105   000005 235007                    LDA     5,DL
         1 000106   200014 755100                    STA     I,,AUTO

     1872     1133    1           CALL DCWBUILD(FMT.HEADER_DCW,SIZEW(FMT)-SIZEW(FMT.HEADER),I);

   1133  1 000107   000000 473500                    LDP3    0,,PR0
         1 000110   200014 634500                    EPPR4   I,,AUTO
         1 000111   200020 454500                    STP4    I+4,,AUTO
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:398  
         1 000112   000001 236000 2                  LDQ     1
         1 000113   200017 756100                    STQ     I+3,,AUTO
         1 000114   300011 635500                    EPPR5   9,,PR3
         1 000115   200016 455500                    STP5    I+2,,AUTO
         1 000116   200016 630500                    EPPR0   I+2,,AUTO
         1 000117   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000120   000000 701000 xent               TSX1    DCWBUILD
         1 000121   000000 011000                    NOP     0

     1873     1134    1           CALL DCWBUILD(FMT.DATA_DCW,SIZEW(FMT)-SIZEW(FMT.HEADER)+88,

   1134  1 000122   200004 470500                    LDP0    @FMT$,,AUTO
         1 000123   000000 471500                    LDP1    0,,PR0
         1 000124   200013 473500                    LDP3    DVT$,,AUTO
         1 000125   300056 236100                    LDQ     46,,PR3
         1 000126   000022 772000                    QRL     18
         1 000127   200016 756100                    STQ     I+2,,AUTO
         1 000130   200003 474500                    LDP4    @VIP,,AUTO
         1 000131   400014 236100                    LDQ     12,,PR4
         1 000132   000033 772000                    QRL     27
         1 000133   200016 402100                    MPY     I+2,,AUTO
         1 000134   200017 756100                    STQ     I+3,,AUTO
         1 000135   200017 635500                    EPPR5   I+3,,AUTO
         1 000136   200022 455500                    STP5    I+6,,AUTO
         1 000137   000003 236000 2                  LDQ     3
         1 000140   200021 756100                    STQ     I+5,,AUTO
         1 000141   100015 636500                    EPPR6   13,,PR1
         1 000142   200020 456500                    STP6    I+4,,AUTO
         1 000143   200020 630500                    EPPR0   I+4,,AUTO
         1 000144   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000145   000000 701000 xent               TSX1    DCWBUILD
         1 000146   000000 011000                    NOP     0

     1874     1135    1             VIP.NSECTS*DVT.SECSIZE);
     1875     1136    1           RETURN;

   1136  1 000147   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:399  

     1876     1137    2           DO WHILE ('0'B);

     1877     1138    2   NO_SPACE_1:                             /* NO SPACE FOR FMT */
     1878     1139    2              CALL IVV$ERROR(VIP.DEVID,9);

   1139  1 000150   000004 236000 2     NO_SPACE_1   LDQ     4
         1 000151   200017 756100                    STQ     I+3,,AUTO
         1 000152   200003 236100                    LDQ     @VIP,,AUTO
         1 000153   000005 036003                    ADLQ    5,DU
         1 000154   200016 756100                    STQ     I+2,,AUTO
         1 000155   200016 630500                    EPPR0   I+2,,AUTO
         1 000156   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000157   000000 701000 xent               TSX1    IVV$ERROR
         1 000160   000000 011000                    NOP     0

     1879     1140    2              END;

     1880     1141    1           ALTRETURN;

   1141  1 000161   000000 702200 xent               TSX2  ! X66_AALT

(unnamed)
 Sect OctLoc
   0     000   357700 720000   277700 702700   115123 125060   065060 071040    ........MSU0509
   0     004   115123 125060   065060 061040                                    MSU0501

(unnamed)
 Sect OctLoc
   2     000   000000 000021   000000 006000   000000 000151   000002 006000    ...........i....
   2     004   000013 006000                                                    ....
     1881     1142    1   END IVV$FMTPAC;

PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:400  
--  Include file information  --

   IV$MACROS.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
      No diagnostics issued in procedure IVV$FMTPAC.
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:401  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @FMT$                      3-0-0/w PTR         r     1 @VIP
     6-0-0/w PTR         r     1 DATA$                     13-0-0/w PTR         r     1 DVT$
    *0-0-0/w PTR         r     1 FMT$                       5-0-0/w PTR         r     1 HDR5$
    14-0-0/w SBIN        r     1 I                         *0-0-0/w STRC(3024)  r     1 VIP

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2844)  r     1 DVT                        0-0-0/w STRC(828)   r     1 FMT


   Procedure IVV$FMTPAC requires 114 words for executable code.
   Procedure IVV$FMTPAC requires 20 words of local(AUTO) storage.

    No errors detected in file IVV$VOLINIT.:E05TSI    .
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:402  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:403  
          MINI XREF LISTING

CF.C0.TSKIP
       952**DCL       953--REDEF
DATA$
       939**DCL       969--IMP-PTR
DCWBUILD
      1113**DCL-ENT  1133--CALL     1134--CALL
DVT.MPC
      1104**DCL      1105--REDEF
DVT.SECSIZE
      1104**DCL      1122>>ASSIGN   1134>>CALL
DVT$
      1109**DCL      1102--IMP-PTR  1121<<ASSIGN   1122>>ASSIGN   1134>>CALL
FMT
      1046**DCL      1122--ASSIGN   1125<<ASSIGN   1133--CALL     1134--CALL
FMT.BOUND
      1073**DCL      1126<<ASSIGN
FMT.DATA_DCW
      1078**DCL      1134<>CALL
FMT.HEADER
      1082**DCL      1098--REDEF    1099--REDEF    1133--CALL     1134--CALL
FMT.HEADER_DCW
      1074**DCL      1133<>CALL
FMT.IDCW
      1054**DCL      1130<<ASSIGN
FMT.SEEK
      1061**DCL      1128--ASSIGN
FMT.SEEK.SECTOR
      1066**DCL      1067--REDEF
FMT.SEEK_DCW.FWA
      1051**DCL      1128<<ASSIGN
FMT.SEEK_DCW.TALLY
      1053**DCL      1129<<ASSIGN
PL6.E3A0      #007=IVV$FMTPAC File=IVV$VOLINIT.:E05TSI                           TUE 07/29/97 23:21 Page:404  
FMT.SEEK_IDCW
      1047**DCL      1127<<ASSIGN
FMT$
      1108**DCL         7--PROC     1046--IMP-PTR  1123<<ASSIGN   1124<>CALL     1125>>ASSIGN   1126>>ASSIGN
      1127>>ASSIGN   1128>>ASSIGN   1128>>ASSIGN   1128>>ASSIGN   1129>>ASSIGN   1130>>ASSIGN   1133>>CALL
      1134>>CALL
HDR5$
       938**DCL       941--IMP-PTR
I
      1110**DCL      1122<<ASSIGN   1124<>CALL     1126>>ASSIGN   1131<<ASSIGN   1132<<ASSIGN   1133<>CALL
IVO$GET
      1114**DCL-ENT  1124--CALL
IVV$ERROR
      1115**DCL-ENT  1139--CALL
NO_SPACE_1
      1139**LABEL    1124--CALLALT
VIP
       982**DCL         7--PROC
VIP.CTRACK
       998**DCL       999--REDEF
VIP.DEVID
       988**DCL      1139<>CALL
VIP.DVT$
       985**DCL      1121>>ASSIGN
VIP.MODEL
       989**DCL      1131>>IF       1131>>IF
VIP.NSECTS
       993**DCL      1122>>ASSIGN   1134>>CALL
VIP.RANGE.FTRACK
      1036**DCL      1037--REDEF
VIP.RANGE.LTRACK
      1040**DCL      1041--REDEF
