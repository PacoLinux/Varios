VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:1    
        1        1        /*M* ASL$LIST_ALL_LINKDEVS:  routine to handle LIST LINKDEV cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASL$LIST_ALL_LINKDEVS: PROC;
       11       11        /**********************************************************/
       12       12
       13       13        /*D* NAME:     ASL$LIST_ALL_LINKDEVS
       14       14             CALL:     CALL ASL$LIST_ALL_LINKDEVS
       15       15             INPUT:    Nothing is passed.
       16       16             OUTPUT:   Nothing is returned.
       17       17             DESCRIPTION:  ASL$LIST_ALL_LINKDEVS is a subroutine to handle
       18       18                           the LIST LINKDEV command for SUPER.
       19       19                           Link records are stored in the :HLP.:SYS
       20       20                           file and have keys that look like the following:
       21       21                           'xxxxxxxx*' where the x signifies
       22       22                           a character from the alphanumeric character
       23       23                           set plus the special characters ':$*' and
       24       24                           is of length 8 or less.
       25       25                           If the actual link name is less than 8
       26       26                           characters, the key will be blank padded to
       27       27                           8 characters.
       28       28                           The key is not a unique identifier for links
       29       29                           though.  Other types of objects known to
       30       30                           SUPER have the same type of key structure.
       31       31                           The unique identifier for these objects is
       32       32                           the first byte of the actual record, which
       33       33                           contains a value specified by the KLAT_?
       34       34                           EQU's found in KL_SUPER_C.  For links the
       35       35                           EQU is KLAT_LNKLINE# and its value is 6.
       36       36                           This routine will either read a single link
       37       37                           record or it will cycle through all of the :HLP
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:2    
       38       38                           records looking for links and matches
       39       39                           to the selection criteria as input in the
       40       40                           LIST/DISPLAY command.  If a match is found
       41       41                           this routine will then look for the link devices
       42       42                           belonging to the link just found.  It will match
       43       43                           link device names in the link record against the
       44       44                           link device name asked for and if found
       45       45                           it will call the display routine
       46       46                           if the command was a DISPLAY command, or it will
       47       47                           call the formatter with the link name and the
       48       48                           link device name.
       49       49
       50       50                  MEMORY REQUIREMENTS:
       51       51                           For all of the routines that deal with listing/
       52       52                           displaying links:
       53       53
       54       54                            ASL$LIST_ALL_LINKDEVS
       55       55                            ASL$FIND_LINKDEV
       56       56                            ASL$DISP_ONE_LINKDEV
       57       57
       58       58                            The link record will be read into
       59       59                            data segment 1.  The name will be used by the
       60       60                            ASL$LIST_ALL_LINKDEVS, while the other info
       61       61                            will be used by the ASL$DISP_ONE_LINKDEV routine.
       62       62        */
       63       63        /********************************************************************/
       64       64        /*   Include files   include files   include files   include files  */
       65       65        /********************************************************************/
       66       66        %INCLUDE AS_PERR_C;
       67      668        %INCLUDE AS_SUPER_C;
       68     1103        %INCLUDE AS_SUBS_C;
       69     2517        %INCLUDE AS_MAC_C;
       70     2597        %INCLUDE AS_ENTRIES_M;
       71     3647        %INCLUDE OCI_SUBS_C ;
       72     3745        %INCLUDE AS_SSUBS_C;
       73     3837        %INCLUDE B_ERRORS_C;
       74     4964        %INCLUDE CP_6_SUBS;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:3    
       75     5504        %INCLUDE KL_SUPER_C;
       76     8406        %INCLUDE XU_MACRO_C;
       77    11512        %INCLUDE XU_FORMAT_C;
       78    11674        %INCLUDE AS_SUPER_R;
       79    14690        /********************************************************************/
       80    14691        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       81    14692        /********************************************************************/
       82    14693        %ASB$PREC_HLP ;
       83    14696        %ASB$READ_HLP ;
       84    14699        %ASB$READ_HLP_SEQ ;
       85    14702        %ASH$ERROR ;
       86    14705        %ASA$ERROR ;
       87    14708        %ASL$FIND_LINKDEV ;
       88    14711        %ASL$DISP_ONE_LINKDEV ;
       89    14714        %ASB$WILD_MATCH ;
       90    14717    1   DCL X$FORMAT ENTRY(1) ;
       91    14718        /********************************************************************/
       92    14719        /*   Local based     local based     local based     local based    */
       93    14720        /********************************************************************/
       94    14721        %PARSE$OUT     ( NAME = P$B, STCLASS = "BASED(NODE$)",
       95    14722                         NDTYPE = TYPE, NSUBLKS = NSUBLKS);
       96    14767        %PARSE$SYM     ( NAME = P$S, STCLASS = BASED);
       97    14805        %KL_DREC       ( NAME = LINK$DREC,
       98    14806                         STCLASS = "BASED(DSEG1$)",
       99    14807                         LAST = ";");
      100    14920        %KL_LINKDEV    ( NAME = KL$LINKDEV,
      101    14921                         LVL = 1,
      102    14922                         LAST = ";",
      103    14923                         STCLASS = "BASED( LINKDEV$ )" );
      104    15094        /********************************************************************/
      105    15095        /*   Auto data       auto data       auto data       auto data      */
      106    15096        /********************************************************************/
      107    15097    1   DCL ALL_LINKS                BIT(1);
      108    15098    1   DCL 1 BEGIN_KEY ,
      109    15099    1          2 COUNT               UBIN BYTE,
      110    15100    1          2 TEXT                CHAR(8);
      111    15101    1   DCL CURRENT_LINK             CHAR(8);
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:4    
      112    15102    1   DCL DISP                     BIT(1);
      113    15103    1   DCL DISP_LINKDEVS            SBIN;
      114    15104    1   DCL DISP_LINKS               SBIN;
      115    15105    1   DCL 1 END_KEY ,
      116    15106    1          2 COUNT               UBIN BYTE,
      117    15107    1          2 TEXT                CHAR(8);
      118    15108    1   DCL I                        UBIN;
      119    15109    1   DCL J                        UBIN;
      120    15110    1   DCL JCL                      BIT(1);
      121    15111    1   DCL 1 LINK_NAME,
      122    15112    1          2 COUNT               UBIN BYTE UNAL,
      123    15113    1          2 TEXT                CHAR(8) UNAL;
      124    15114    1   DCL 1 LINKDEV_NAME,
      125    15115    1          2 COUNT               UBIN BYTE UNAL,
      126    15116    1          2 TEXT                CHAR(8) UNAL;
      127    15117    1   DCL LINKDEV$                 PTR;
      128    15118    1   DCL NEW_LINK                 BIT(1);
      129    15119    1   DCL WILD_CARD                BIT(1);
      130    15120
      131    15121        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:5    
      132    15122        /********************************************************************/
      133    15123        /*   Constant data   constant data   constant data   constant data  */
      134    15124        /********************************************************************/
      135    15125    1   DCL LINK_STR                 CHAR(0) CONSTANT INIT ('link');
      136    15126    1   DCL LINKS_STR                CHAR(0) CONSTANT INIT ('links');
      137    15127    1   DCL LINKDEV_STR              CHAR(0) CONSTANT INIT ('link device');
      138    15128    1   DCL LINKDEVS_STR             CHAR(0) CONSTANT INIT ('link devices');
      139    15129    1   DCL LIST_STR                 CHAR(0) CONSTANT INIT ('listed');
      140    15130    1   DCL DISPLAY_STR              CHAR(0) CONSTANT INIT ('displayed');
      141    15131    1   DCL FOUND_STR                CHAR(0) CONSTANT INIT ('found');
      142    15132        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:6    
      143    15133        /********************************************************************/
      144    15134        /*   Procedure       procedure       procedure       procedure      */
      145    15135        /********************************************************************/
      146    15136    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;
      147    15137    1   JCL = %NO#;
      148    15138    1   WILD_CARD = %NO#;
      149    15139    1   LINK_NAME.TEXT = '?';
      150    15140    1   LINK_NAME.COUNT = 1;
      151    15141    1   LINKDEV_NAME.TEXT = '?';
      152    15142    1   LINKDEV_NAME.COUNT = 1;
      153    15143    1   DISP_LINKDEVS = 0;
      154    15144    1   DISP_LINKS = 0;
      155    15145
      156    15146    2   DO SELECT (CODE);
      157    15147
      158    15148    2      SELECT (%LIST_ALL_VAL);
      159    15149
      160    15150    2      DISP = %NO#;
      161    15151    2      JCL = %NO#;
      162    15152
      163    15153    2      SELECT (%DISPLAY_ALL_VAL);
      164    15154
      165    15155    2      DISP = %YES#;
      166    15156    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;
      167    15157    3         IF P_PCB.OUT$->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL THEN
      168    15158    3            JCL = %YES#;
      169    15159    4         ELSE IF P_PCB.OUT$->P$B.NSUBLKS = 3 THEN DO;
      170    15160    4               IF P_PCB.OUT$->P$B.SUBLK$(2)->P$B.CODE = %JCL_VAL THEN
      171    15161    4                  JCL = %YES#;
      172    15162    4               END; /*  Nsublks = 3  */
      173    15163    3         END; /*  Nsublks > 1  */
      174    15164
      175    15165    2      SELECT ( %LIST_DEVICE_VAL,
      176    15166    2           %DISPLAY_DEVICE_VAL);
      177    15167
      178    15168    2      DISP = (CODE = %DISPLAY_DEVICE_VAL);
      179    15169    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:7    
      180    15170    4         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %LINK_NAME_WILD_VAL THEN DO;
      181    15171    4            LINK_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      182    15172    4            LINK_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      183    15173    4            END;  /*  Code = LINK_NAME_WILD  */
      184    15174    3         ELSE
      185    15175    4            IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %DEVICE_NAME_WILD_VAL THEN DO;
      186    15176    4               LINKDEV_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      187    15177    4               LINKDEV_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      188    15178    4               END; /*  Code = LINKDEV_NAME_WILD  */
      189    15179    3            ELSE
      190    15180    4               IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %JCL_VAL THEN DO;
      191    15181
      192    15182    4                  JCL = %YES#;
      193    15183
      194    15184    4                  END; /*  Code = JCL_VAL  */
      195    15185
      196    15186    3         END;  /*  Do i  */
      197    15187
      198    15188    2      END;  /*  Do case (code)  */
      199    15189
      200    15190    1   FDS.NVECS# = 0;
      201    15191    2   IF JCL THEN DO;
      202    15192    2      CALL CONCAT (FMT_BUF, '%1/"', LINKDEVS_STR, '%1/');
      203    15193    2      FDS.FMT_.BOUND = LENGTHC (LINKDEVS_STR) + 6;
      204    15194    2      END;   /*  Jcl  */
      205    15195    2   ELSE DO;
      206    15196    2      CALL CONCAT (FMT_BUF, '%1/', LINKDEVS_STR, '%1/');
      207    15197    2      FDS.FMT_.BOUND = LENGTHC (LINKDEVS_STR) + 5;
      208    15198    2      END;   /*  Not jcl  */
      209    15199    1   FDS.TABDFLT# = 10;
      210    15200    1   CALL X$FORMAT (FDS);
      211    15201
      212    15202    1   IF LINK_NAME.TEXT = '?' THEN
      213    15203    1      ALL_LINKS = %YES#;
      214    15204    2   ELSE DO;
      215    15205    2      ALL_LINKS = %NO#;
      216    15206    2      BEGIN_KEY.TEXT = ' ';
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:8    
      217    15207    2      END_KEY.TEXT = ' ';
      218    15208    3      CALL INDEX (I,'?',LINK_NAME.TEXT) WHENRETURN DO;
      219    15209    3         BEGIN_KEY.TEXT = SUBSTR(LINK_NAME.TEXT,0,I);
      220    15210    3         BEGIN_KEY.COUNT = 8;
      221    15211    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(LINK_NAME.TEXT,0,I),'~');
      222    15212    3         END_KEY.COUNT = I + 1;
      223    15213    3         WILD_CARD = %YES#;
      224    15214    3         END;  /*  Whenreturn from index  */
      225    15215    3      WHENALTRETURN DO;
      226    15216    3         WILD_CARD = %NO#;
      227    15217    3         END;  /* Whenaltreturn  */
      228    15218    2      END;  /*  Else  */
      229    15219
      230    15220    1   FDS.NVECS# = 0;
      231    15221
      232    15222    2   IF ALL_LINKS THEN DO;
      233    15223    2      USERS_KEY = '001000'O;     /* To precord to begin of :HLP */
      234    15224    2      END;  /*  ALL_LINKS  */
      235    15225    2   ELSE IF WILD_CARD THEN DO;
      236    15226    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');
      237    15227    2         USERS_KEY.COUNT = 9 ;
      238    15228    2         END; /*  WILD_CARD  */
      239    15229    2      ELSE DO;  /*  Single link and device  */
      240    15230    2         CALL CONCAT (USERS_KEY.TXTC,LINK_NAME.TEXT,'*');
      241    15231    2         USERS_KEY.COUNT = 9 ;
      242    15232    2         I = DSEG1SIZE;
      243    15233    2         CALL ASB$READ_HLP (DSEG1$,I,1)
      244    15234    3         WHENRETURN DO;
      245    15235    4            IF LINK$DREC.ATYP ~= %KLAT_LNKLINE# THEN DO;
      246    15236    4               AS_FIELD1 = LINK_NAME;
      247    15237                    %SCREAM( ERR#=E$NOTLINK , LEVEL=ERROR, MID='L' );
      248    15252    4               RETURN ;
      249    15253    4               END ; /* Then do */
      250    15254    3            I = SIZEW (LINK$DREC) + LINK$DREC.NWINFO;
      251    15255    3            LINKDEV$ = DSEG1$;
      252    15256    3            DISP_LINKS = 1;
      253    15257    3            NEW_LINK = %YES#;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:9    
      254    15258    4            DO FOREVER;
      255    15259    4               CALL ASL$FIND_LINKDEV (DSEG1$, I, LINKDEV_NAME, LINKDEV$) ALTRET (
             15259                        FINISH_UP);
      256    15260    5               IF DISP THEN DO;
      257    15261    6                  IF NOT JCL THEN DO;
      258    15262    6                     CALL CONCAT (FMT_BUF, '%1/   ', LINK_STR, '    ', LINK_NAME.TEXT);
      259    15263    6                     FDS.FMT_.BOUND = LENGTHC(LINK_STR) + 17;
      260    15264    6                     FDS.NVECS# = 0;
      261    15265    6                     CALL X$FORMAT (FDS);
      262    15266    6                     END; /*  Not jcl  */
      263    15267    5                  CALL ASL$DISP_ONE_LINKDEV (LINKDEV$, NEW_LINK, JCL, LINK_NAME.TEXT);
      264    15268    5                  NEW_LINK = %NO#;
      265    15269    5                  END; /*  Disp  */
      266    15270    5               ELSE DO;
      267    15271    5                  FMT_BUF = '%1/   %A  %A  %A  %A';
      268    15272    5                  FDS.FMT_.BOUND = 19;
      269    15273    5                  FDS.NVECS# = 4;
      270    15274    5                  FMT_VEC (0) = VECTOR (LINK_STR);
      271    15275    5                  FMT_VEC (1) = VECTOR (LINK_NAME.TEXT);
      272    15276    5                  FMT_VEC (2) = VECTOR (LINKDEV_STR);
      273    15277    5                  FMT_VEC (3) = VECTOR (KL$LINKDEV.LOGON#);
      274    15278    5                  CALL X$FORMAT (FDS);
      275    15279    5                  END; /*  ~ disp  */
      276    15280    4               DISP_LINKDEVS = DISP_LINKDEVS + 1;
      277    15281    4               END; /*  Forever  */
      278    15282    3            END;  /*  Whenreturn  */
      279    15283    3         WHENALTRETURN DO;
      280    15284    3            IF MERR_CODE.CODE = %E$NOKEY
      281    15285    4            THEN DO;
      282    15286    4               AS_FIELD1 = LINK_NAME;
      283    15287                    %SCREAM( ERR#=E$LINK_NO_EXIST2, MID='L', LEVEL=ERROR );
      284    15302    4               END;  /*  Error = nokey  */
      285    15303    4            ELSE DO;
      286    15304    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      287    15305    4               END;  /* Error ~= nokey */
      288    15306    3            END;  /*  Whenaltreturn  */
      289    15307    2         GOTO FINISH_UP;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:10   
      290    15308    2         END; /*  Else  */
      291    15309    1   CALL ASB$PREC_HLP ;
      292    15310    2   DO FOREVER;
      293    15311
      294    15312    3      DO UNTIL LINK$DREC.ATYP = %KLAT_LNKLINE# ;
      295    15313    3         I = DSEG1SIZE;
      296    15314    3         CALL ASB$READ_HLP_SEQ(DSEG1$,I,1)
      297    15315    4         WHENALTRETURN DO;
      298    15316    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);
      299    15317    4            GOTO FINISH_UP;
      300    15318    4            END;  /*  Whenaltreturn  */
      301    15319    3         END;  /*  Do until we find a link record  */
      302    15320    2      CALL INDEX (I,' ',SUBSTR(USERS_KEY.TXTC,0,8)) ;
      303    15321    2      IF I > 8 THEN I = 8;
      304    15322    2      CURRENT_LINK = SUBSTR(USERS_KEY.TXTC,0,I);
      305    15323    3      IF WILD_CARD THEN DO;
      306    15324    3         J = LINK_NAME.COUNT;
      307    15325    3         CALL ASB$WILD_MATCH (I, CURRENT_LINK, J, LINK_NAME.TEXT)
      308    15326    4         WHENALTRETURN DO;
      309    15327    4            IF CURRENT_LINK > END_KEY.TEXT THEN
      310    15328    4               GOTO FINISH_UP;
      311    15329    4            ELSE
      312    15330    4               GOTO END_FOREVER;
      313    15331    4            END;  /*  Whenaltreturn  */
      314    15332    3         END; /*  WILD_CARD  */
      315    15333    2      DISP_LINKS = DISP_LINKS + 1;
      316    15334    2      I = SIZEW (LINK$DREC) + LINK$DREC.NWINFO;
      317    15335    2      LINKDEV$ = DSEG1$;
      318    15336    2      NEW_LINK = %YES#;
      319    15337    3      DO FOREVER;
      320    15338    3         CALL ASL$FIND_LINKDEV (DSEG1$, I, LINKDEV_NAME, LINKDEV$) ALTRET (END_FOREVER)
             15338                  ;
      321    15339    4         IF DISP THEN DO;
      322    15340    5            IF NEW_LINK AND NOT JCL THEN DO;
      323    15341    5               CALL CONCAT (FMT_BUF, '%1/   ', LINK_STR, '    ', SUBSTR(USERS_KEY.TXTC,
             15341                        0,8));
      324    15342    5               FDS.FMT_.BOUND = LENGTHC(LINK_STR) + 17;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:11   
      325    15343    5               FDS.NVECS# = 0;
      326    15344    5               CALL X$FORMAT (FDS);
      327    15345    5               END;  /*  New link and not jcl */
      328    15346    4            CALL ASL$DISP_ONE_LINKDEV (LINKDEV$, NEW_LINK, JCL, CURRENT_LINK);
      329    15347    4            NEW_LINK = %NO#;
      330    15348    4            END;  /*  Disp  */
      331    15349    4         ELSE DO;
      332    15350    4            FMT_BUF = '%1/   %A  %A  %A  %A';
      333    15351    4            FDS.FMT_.BOUND = 19;
      334    15352    4            FDS.NVECS# = 4;
      335    15353    4            FMT_VEC (0) = VECTOR (LINK_STR);
      336    15354    4            FMT_VEC (1) = VECTOR (CURRENT_LINK);
      337    15355    4            FMT_VEC (2) = VECTOR (LINKDEV_STR);
      338    15356    4            FMT_VEC (3) = VECTOR (KL$LINKDEV.LOGON#);
      339    15357    4            CALL X$FORMAT (FDS);
      340    15358    4            END;  /*  ~ disp  */
      341    15359    3         DISP_LINKDEVS = DISP_LINKDEVS + 1;
      342    15360    3         END;  /*  Forever  */
      343    15361    2   END_FOREVER:
      344    15362    2      END;  /*  Do forever  */
      345    15363    1   FINISH_UP:
      346    15364    2   IF NOT DISP THEN DO;
      347    15365    2      FMT_BUF = '%\%/';
      348    15366    2      FDS.FMT_.BOUND = 3;
      349    15367    2      FDS.NVECS# = 0;
      350    15368    2      CALL X$FORMAT(FDS);
      351    15369    2      END; /*  If not disp  */
      352    15370    2   IF NOT JCL THEN DO;
      353    15371    2      FMT_VEC(0) = VECTOR (DISP_LINKS);
      354    15372    2      IF DISP_LINKS = 1 THEN
      355    15373    3      DO;
      356    15374    3         FMT_VEC(1) = VECTOR (LINK_STR);
      357    15375    3         END; /*  DISP_LINKS = 1  */
      358    15376    3      ELSE DO;
      359    15377    3         FMT_VEC(1) = VECTOR (LINKS_STR);
      360    15378    3         END; /*  DISP_LINKS ~= 1  */
      361    15379    2      FMT_VEC(2) = VECTOR (FOUND_STR);
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:12   
      362    15380    2      FDS.NVECS# = 3;
      363    15381    2      FMT_BUF = '   %5D %A %A.';
      364    15382    2      FDS.FMT_.BOUND = 12;
      365    15383    2      CALL X$FORMAT(FDS);
      366    15384    2      FMT_VEC(0) = VECTOR (DISP_LINKDEVS);
      367    15385    2      IF DISP_LINKDEVS = 1 THEN
      368    15386    3      DO;
      369    15387    3         FMT_VEC(1) = VECTOR (LINKDEV_STR);
      370    15388    3         END; /*  DISP_LINKDEVS = 1  */
      371    15389    3      ELSE DO;
      372    15390    3         FMT_VEC(1) = VECTOR (LINKDEVS_STR);
      373    15391    3         END; /*  DISP_LINKDEVS ~= 1  */
      374    15392    2      IF DISP THEN
      375    15393    3      DO;
      376    15394    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      377    15395    3         END; /*  If disp  */
      378    15396    3      ELSE DO;
      379    15397    3         FMT_VEC(2) = VECTOR (LIST_STR);
      380    15398    3         END; /*  If ~ disp  */
      381    15399    2      FDS.NVECS# = 3;
      382    15400    2      FMT_BUF = '   %5D %A %A.';
      383    15401    2      FDS.FMT_.BOUND = 12;
      384    15402    2      CALL X$FORMAT(FDS);
      385    15403    2      END; /* Not jcl */
      386    15404    1   RETURN;
      387    15405    1   END ASL$LIST_ALL_LINKDEVS;
      388    15406        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:13   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_LINKDEVS.

   Procedure ASL$LIST_ALL_LINKDEVS requires 598 words for executable code.
   Procedure ASL$LIST_ALL_LINKDEVS requires 34 words of local(AUTO) storage.

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:14   

 Object Unit name= ASL$LIST_ALL_LINKDEVS                      File name= ASL$LIST_LINK_DEVICES.:E05TOU
 UTS= JUL 29 '97 10:16:09.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     31     37  ASL$LIST_ALL_LINKDEVS
    2   Proc  even  none   598   1126  ASL$LIST_ALL_LINKDEVS
    3  RoData even  none    34     42  ASL$LIST_ALL_LINKDEVS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  ASL$LIST_ALL_LINKDEVS
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:15   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       2 ASH$ERROR
         yes           Std       4 ASL$DISP_ONE_LINKDEV
         yes           Std       3 ASA$ERROR
 yes     yes           Std       0 ASB$PREC_HLP
 yes     yes           Std       4 ASB$WILD_MATCH
 yes     yes           Std       4 ASL$FIND_LINKDEV
 yes     yes           Std       3 ASB$READ_HLP_SEQ
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             FDS                                   FMT_BUF
     FMT_VEC                               NODE$                                 CODE
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     DSEG1SIZE                             P_PCB                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:16   


        1        1        /*M* ASL$LIST_ALL_LINKDEVS:  routine to handle LIST LINKDEV cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASL$LIST_ALL_LINKDEVS: PROC;

     10  2 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         2 000001   000042 000000                    ZERO    34,0

       11       11        /**********************************************************/
       12       12
       13       13        /*D* NAME:     ASL$LIST_ALL_LINKDEVS
       14       14             CALL:     CALL ASL$LIST_ALL_LINKDEVS
       15       15             INPUT:    Nothing is passed.
       16       16             OUTPUT:   Nothing is returned.
       17       17             DESCRIPTION:  ASL$LIST_ALL_LINKDEVS is a subroutine to handle
       18       18                           the LIST LINKDEV command for SUPER.
       19       19                           Link records are stored in the :HLP.:SYS
       20       20                           file and have keys that look like the following:
       21       21                           'xxxxxxxx*' where the x signifies
       22       22                           a character from the alphanumeric character
       23       23                           set plus the special characters ':$*' and
       24       24                           is of length 8 or less.
       25       25                           If the actual link name is less than 8
       26       26                           characters, the key will be blank padded to
       27       27                           8 characters.
       28       28                           The key is not a unique identifier for links
       29       29                           though.  Other types of objects known to
       30       30                           SUPER have the same type of key structure.
       31       31                           The unique identifier for these objects is
       32       32                           the first byte of the actual record, which
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:17   
       33       33                           contains a value specified by the KLAT_?
       34       34                           EQU's found in KL_SUPER_C.  For links the
       35       35                           EQU is KLAT_LNKLINE# and its value is 6.
       36       36                           This routine will either read a single link
       37       37                           record or it will cycle through all of the :HLP
       38       38                           records looking for links and matches
       39       39                           to the selection criteria as input in the
       40       40                           LIST/DISPLAY command.  If a match is found
       41       41                           this routine will then look for the link devices
       42       42                           belonging to the link just found.  It will match
       43       43                           link device names in the link record against the
       44       44                           link device name asked for and if found
       45       45                           it will call the display routine
       46       46                           if the command was a DISPLAY command, or it will
       47       47                           call the formatter with the link name and the
       48       48                           link device name.
       49       49
       50       50                  MEMORY REQUIREMENTS:
       51       51                           For all of the routines that deal with listing/
       52       52                           displaying links:
       53       53
       54       54                            ASL$LIST_ALL_LINKDEVS
       55       55                            ASL$FIND_LINKDEV
       56       56                            ASL$DISP_ONE_LINKDEV
       57       57
       58       58                            The link record will be read into
       59       59                            data segment 1.  The name will be used by the
       60       60                            ASL$LIST_ALL_LINKDEVS, while the other info
       61       61                            will be used by the ASL$DISP_ONE_LINKDEV routine.
       62       62        */
       63       63        /********************************************************************/
       64       64        /*   Include files   include files   include files   include files  */
       65       65        /********************************************************************/
       66       66        %INCLUDE AS_PERR_C;
       67      668        %INCLUDE AS_SUPER_C;
       68     1103        %INCLUDE AS_SUBS_C;
       69     2517        %INCLUDE AS_MAC_C;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:18   
       70     2597        %INCLUDE AS_ENTRIES_M;
       71     3647        %INCLUDE OCI_SUBS_C ;
       72     3745        %INCLUDE AS_SSUBS_C;
       73     3837        %INCLUDE B_ERRORS_C;
       74     4964        %INCLUDE CP_6_SUBS;
       75     5504        %INCLUDE KL_SUPER_C;
       76     8406        %INCLUDE XU_MACRO_C;
       77    11512        %INCLUDE XU_FORMAT_C;
       78    11674        %INCLUDE AS_SUPER_R;
       79    14690        /********************************************************************/
       80    14691        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       81    14692        /********************************************************************/
       82    14693        %ASB$PREC_HLP ;
       83    14696        %ASB$READ_HLP ;
       84    14699        %ASB$READ_HLP_SEQ ;
       85    14702        %ASH$ERROR ;
       86    14705        %ASA$ERROR ;
       87    14708        %ASL$FIND_LINKDEV ;
       88    14711        %ASL$DISP_ONE_LINKDEV ;
       89    14714        %ASB$WILD_MATCH ;
       90    14717    1   DCL X$FORMAT ENTRY(1) ;
       91    14718        /********************************************************************/
       92    14719        /*   Local based     local based     local based     local based    */
       93    14720        /********************************************************************/
       94    14721        %PARSE$OUT     ( NAME = P$B, STCLASS = "BASED(NODE$)",
       95    14722                         NDTYPE = TYPE, NSUBLKS = NSUBLKS);
       96    14767        %PARSE$SYM     ( NAME = P$S, STCLASS = BASED);
       97    14805        %KL_DREC       ( NAME = LINK$DREC,
       98    14806                         STCLASS = "BASED(DSEG1$)",
       99    14807                         LAST = ";");
      100    14920        %KL_LINKDEV    ( NAME = KL$LINKDEV,
      101    14921                         LVL = 1,
      102    14922                         LAST = ";",
      103    14923                         STCLASS = "BASED( LINKDEV$ )" );
      104    15094        /********************************************************************/
      105    15095        /*   Auto data       auto data       auto data       auto data      */
      106    15096        /********************************************************************/
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:19   
      107    15097    1   DCL ALL_LINKS                BIT(1);
      108    15098    1   DCL 1 BEGIN_KEY ,
      109    15099    1          2 COUNT               UBIN BYTE,
      110    15100    1          2 TEXT                CHAR(8);
      111    15101    1   DCL CURRENT_LINK             CHAR(8);
      112    15102    1   DCL DISP                     BIT(1);
      113    15103    1   DCL DISP_LINKDEVS            SBIN;
      114    15104    1   DCL DISP_LINKS               SBIN;
      115    15105    1   DCL 1 END_KEY ,
      116    15106    1          2 COUNT               UBIN BYTE,
      117    15107    1          2 TEXT                CHAR(8);
      118    15108    1   DCL I                        UBIN;
      119    15109    1   DCL J                        UBIN;
      120    15110    1   DCL JCL                      BIT(1);
      121    15111    1   DCL 1 LINK_NAME,
      122    15112    1          2 COUNT               UBIN BYTE UNAL,
      123    15113    1          2 TEXT                CHAR(8) UNAL;
      124    15114    1   DCL 1 LINKDEV_NAME,
      125    15115    1          2 COUNT               UBIN BYTE UNAL,
      126    15116    1          2 TEXT                CHAR(8) UNAL;
      127    15117    1   DCL LINKDEV$                 PTR;
      128    15118    1   DCL NEW_LINK                 BIT(1);
      129    15119    1   DCL WILD_CARD                BIT(1);
      130    15120
      131    15121        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:20   
      132    15122        /********************************************************************/
      133    15123        /*   Constant data   constant data   constant data   constant data  */
      134    15124        /********************************************************************/
      135    15125    1   DCL LINK_STR                 CHAR(0) CONSTANT INIT ('link');
      136    15126    1   DCL LINKS_STR                CHAR(0) CONSTANT INIT ('links');
      137    15127    1   DCL LINKDEV_STR              CHAR(0) CONSTANT INIT ('link device');
      138    15128    1   DCL LINKDEVS_STR             CHAR(0) CONSTANT INIT ('link devices');
      139    15129    1   DCL LIST_STR                 CHAR(0) CONSTANT INIT ('listed');
      140    15130    1   DCL DISPLAY_STR              CHAR(0) CONSTANT INIT ('displayed');
      141    15131    1   DCL FOUND_STR                CHAR(0) CONSTANT INIT ('found');
      142    15132        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:21   
      143    15133        /********************************************************************/
      144    15134        /*   Procedure       procedure       procedure       procedure      */
      145    15135        /********************************************************************/
      146    15136    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;

  15136  2 000002   000003 470400 xsym               LDP0    P_PCB+3
         2 000003   000003 471500                    LDP1    3,,PR0
         2 000004   100000 236100                    LDQ     0,,PR1
         2 000005   777777 376007                    ANQ     -1,DL
         2 000006   000000 756000 xsym               STQ     CODE

      147    15137    1   JCL = %NO#;

  15137  2 000007   200021 450100                    STZ     JCL,,AUTO

      148    15138    1   WILD_CARD = %NO#;

  15138  2 000010   200032 450100                    STZ     WILD_CARD,,AUTO

      149    15139    1   LINK_NAME.TEXT = '?';

  15139  2 000011   040100 100400                    MLR     fill='040'O
         2 000012   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000013   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8

      150    15140    1   LINK_NAME.COUNT = 1;

  15140  2 000014   001000 236003                    LDQ     512,DU
         2 000015   200022 552140                    STBQ    LINK_NAME,'40'O,AUTO

      151    15141    1   LINKDEV_NAME.TEXT = '?';

  15141  2 000016   040100 100400                    MLR     fill='040'O
         2 000017   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000020   200025 200010                    ADSC9   LINKDEV_NAME,,AUTO       cn=1,n=8

      152    15142    1   LINKDEV_NAME.COUNT = 1;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:22   

  15142  2 000021   200025 552140                    STBQ    LINKDEV_NAME,'40'O,AUTO

      153    15143    1   DISP_LINKDEVS = 0;

  15143  2 000022   200012 450100                    STZ     DISP_LINKDEVS,,AUTO

      154    15144    1   DISP_LINKS = 0;

  15144  2 000023   200013 450100                    STZ     DISP_LINKS,,AUTO

      155    15145
      156    15146    2   DO SELECT (CODE);

  15146  2 000024   000000 236000 xsym               LDQ     CODE
         2 000025   000022 116007                    CMPQ    18,DL
         2 000026   000037 602000 2                  TNC     s:15146+11
         2 000027   000042 600000 2                  TZE     s:15150
         2 000030   000144 116007                    CMPQ    100,DL
         2 000031   000034 602000 2                  TNC     s:15146+8
         2 000032   000045 600000 2                  TZE     s:15155
         2 000033   000151 710000 2                  TRA     s:15190
         2 000034   000125 116007                    CMPQ    85,DL
         2 000035   000151 601000 2                  TNZ     s:15190
         2 000036   000070 710000 2                  TRA     s:15168
         2 000037   000005 116007                    CMPQ    5,DL
         2 000040   000151 601000 2                  TNZ     s:15190
         2 000041   000070 710000 2                  TRA     s:15168

      157    15147
      158    15148    2      SELECT (%LIST_ALL_VAL);

      159    15149
      160    15150    2      DISP = %NO#;

  15150  2 000042   200011 450100                    STZ     DISP,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:23   
      161    15151    2      JCL = %NO#;

  15151  2 000043   200021 450100                    STZ     JCL,,AUTO
         2 000044   000151 710000 2                  TRA     s:15190

      162    15152
      163    15153    2      SELECT (%DISPLAY_ALL_VAL);

      164    15154
      165    15155    2      DISP = %YES#;

  15155  2 000045   400000 236003                    LDQ     -131072,DU
         2 000046   200011 756100                    STQ     DISP,,AUTO

      166    15156    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;

  15156  2 000047   000001 220100                    LDX0    1,,PR0
         2 000050   000002 100003                    CMPX0   2,DU
         2 000051   000151 602000 2                  TNC     s:15190

      167    15157    3         IF P_PCB.OUT$->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL THEN

  15157  2 000052   000004 471500                    LDP1    4,,PR0
         2 000053   100000 721100                    LXL1    0,,PR1
         2 000054   000001 101003                    CMPX1   1,DU
         2 000055   000060 601000 2                  TNZ     s:15159

      168    15158    3            JCL = %YES#;

  15158  2 000056   200021 756100                    STQ     JCL,,AUTO
         2 000057   000151 710000 2                  TRA     s:15190

      169    15159    4         ELSE IF P_PCB.OUT$->P$B.NSUBLKS = 3 THEN DO;

  15159  2 000060   000003 100003                    CMPX0   3,DU
         2 000061   000151 601000 2                  TNZ     s:15190

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:24   
      170    15160    4               IF P_PCB.OUT$->P$B.SUBLK$(2)->P$B.CODE = %JCL_VAL THEN

  15160  2 000062   000005 473500                    LDP3    5,,PR0
         2 000063   300000 722100                    LXL2    0,,PR3
         2 000064   000001 102003                    CMPX2   1,DU
         2 000065   000151 601000 2                  TNZ     s:15190

      171    15161    4                  JCL = %YES#;

  15161  2 000066   200021 756100                    STQ     JCL,,AUTO

      172    15162    4               END; /*  Nsublks = 3  */

      173    15163    3         END; /*  Nsublks > 1  */

  15163  2 000067   000151 710000 2                  TRA     s:15190

      174    15164
      175    15165    2      SELECT ( %LIST_DEVICE_VAL,

      176    15166    2           %DISPLAY_DEVICE_VAL);
      177    15167
      178    15168    2      DISP = (CODE = %DISPLAY_DEVICE_VAL);

  15168  2 000070   400000 220003                    LDX0    -131072,DU
         2 000071   000125 116007                    CMPQ    85,DL
         2 000072   000074 600000 2                  TZE     s:15168+4
         2 000073   000000 220003                    LDX0    0,DU
         2 000074   000000 636010                    EAQ     0,X0
         2 000075   200011 756100                    STQ     DISP,,AUTO

      179    15169    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  15169  2 000076   000001 235007                    LDA     1,DL
         2 000077   200017 755100                    STA     I,,AUTO
         2 000100   000144 710000 2                  TRA     s:15186+3

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:25   
      180    15170    4         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %LINK_NAME_WILD_VAL THEN DO;

  15170  2 000101   000003 470400 xsym               LDP0    P_PCB+3
         2 000102   200017 720100                    LXL0    I,,AUTO
         2 000103   000003 471510                    LDP1    3,X0,PR0
         2 000104   100000 721100                    LXL1    0,,PR1
         2 000105   000355 101003                    CMPX1   237,DU
         2 000106   000121 601000 2                  TNZ     s:15175

      181    15171    4            LINK_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  15171  2 000107   100004 236100                    LDQ     4,,PR1
         2 000110   000033 772000                    QRL     27
         2 000111   000000 622006                    EAX2    0,QL
         2 000112   040100 100540                    MLR     fill='040'O
         2 000113   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 000114   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8

      182    15172    4            LINK_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  15172  2 000115   000003 471510                    LDP1    3,X0,PR0
         2 000116   100004 236100                    LDQ     4,,PR1
         2 000117   200022 552140                    STBQ    LINK_NAME,'40'O,AUTO

      183    15173    4            END;  /*  Code = LINK_NAME_WILD  */

  15173  2 000120   000141 710000 2                  TRA     s:15186

      184    15174    3         ELSE
      185    15175    4            IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %DEVICE_NAME_WILD_VAL THEN DO;

  15175  2 000121   000337 101003                    CMPX1   223,DU
         2 000122   000135 601000 2                  TNZ     s:15180

      186    15176    4               LINKDEV_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  15176  2 000123   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:26   
         2 000124   000033 772000                    QRL     27
         2 000125   000000 622006                    EAX2    0,QL
         2 000126   040100 100540                    MLR     fill='040'O
         2 000127   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 000130   200025 200010                    ADSC9   LINKDEV_NAME,,AUTO       cn=1,n=8

      187    15177    4               LINKDEV_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  15177  2 000131   000003 471510                    LDP1    3,X0,PR0
         2 000132   100004 236100                    LDQ     4,,PR1
         2 000133   200025 552140                    STBQ    LINKDEV_NAME,'40'O,AUTO

      188    15178    4               END; /*  Code = LINKDEV_NAME_WILD  */

  15178  2 000134   000141 710000 2                  TRA     s:15186

      189    15179    3            ELSE
      190    15180    4               IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %JCL_VAL THEN DO;

  15180  2 000135   000001 101003                    CMPX1   1,DU
         2 000136   000141 601000 2                  TNZ     s:15186

      191    15181
      192    15182    4                  JCL = %YES#;

  15182  2 000137   400000 236003                    LDQ     -131072,DU
         2 000140   200021 756100                    STQ     JCL,,AUTO

      193    15183
      194    15184    4                  END; /*  Code = JCL_VAL  */

      195    15185
      196    15186    3         END;  /*  Do i  */

  15186  2 000141   200017 235100                    LDA     I,,AUTO
         2 000142   000001 035007                    ADLA    1,DL
         2 000143   200017 755100                    STA     I,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:27   
         2 000144   000001 236100                    LDQ     1,,PR0
         2 000145   000022 772000                    QRL     18
         2 000146   200017 116100                    CMPQ    I,,AUTO
         2 000147   000151 600000 2                  TZE     s:15190
         2 000150   000101 603000 2                  TRC     s:15170

      197    15187
      198    15188    2      END;  /*  Do case (code)  */

      199    15189
      200    15190    1   FDS.NVECS# = 0;

  15190  2 000151   000011 450000 xsym               STZ     FDS+9

      201    15191    2   IF JCL THEN DO;

  15191  2 000152   200021 234100                    SZN     JCL,,AUTO
         2 000153   000171 605000 2                  TPL     s:15196

      202    15192    2      CALL CONCAT (FMT_BUF, '%1/"', LINKDEVS_STR, '%1/');

  15192  2 000154   000020 236000 1                  LDQ     FOUND_STR+2
         2 000155   000000 756000 xsym               STQ     FMT_BUF
         2 000156   040000 100400                    MLR     fill='040'O
         2 000157   000006 000014 1                  ADSC9   LINKDEVS_STR             cn=0,n=12
         2 000160   000001 000014 xsym               ADSC9   FMT_BUF+1                cn=0,n=12
         2 000161   040000 100400                    MLR     fill='040'O
         2 000162   000020 000003 1                  ADSC9   FOUND_STR+2              cn=0,n=3
         2 000163   000004 000357 xsym               ADSC9   FMT_BUF+4                cn=0,n=239

      203    15193    2      FDS.FMT_.BOUND = LENGTHC (LINKDEVS_STR) + 6;

  15193  2 000164   000000 236000 xsym               LDQ     FDS
         2 000165   177777 376007                    ANQ     65535,DL
         2 000166   000001 276000 3                  ORQ     1
         2 000167   000000 756000 xsym               STQ     FDS

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:28   
      204    15194    2      END;   /*  Jcl  */

  15194  2 000170   000207 710000 2                  TRA     s:15199

      205    15195    2   ELSE DO;

      206    15196    2      CALL CONCAT (FMT_BUF, '%1/', LINKDEVS_STR, '%1/');

  15196  2 000171   000020 236000 1                  LDQ     FOUND_STR+2
         2 000172   000002 376000 3                  ANQ     2
         2 000173   000040 276007                    ORQ     32,DL
         2 000174   000000 756000 xsym               STQ     FMT_BUF
         2 000175   040000 100400                    MLR     fill='040'O
         2 000176   000006 000014 1                  ADSC9   LINKDEVS_STR             cn=0,n=12
         2 000177   000000 600014 xsym               ADSC9   FMT_BUF                  cn=3,n=12
         2 000200   040000 100400                    MLR     fill='040'O
         2 000201   000020 000003 1                  ADSC9   FOUND_STR+2              cn=0,n=3
         2 000202   000003 600360 xsym               ADSC9   FMT_BUF+3                cn=3,n=240

      207    15197    2      FDS.FMT_.BOUND = LENGTHC (LINKDEVS_STR) + 5;

  15197  2 000203   000000 236000 xsym               LDQ     FDS
         2 000204   177777 376007                    ANQ     65535,DL
         2 000205   000003 276000 3                  ORQ     3
         2 000206   000000 756000 xsym               STQ     FDS

      208    15198    2      END;   /*  Not jcl  */

      209    15199    1   FDS.TABDFLT# = 10;

  15199  2 000207   000012 235007                    LDA     10,DL
         2 000210   000017 755000 xsym               STA     FDS+15

      210    15200    1   CALL X$FORMAT (FDS);

  15200  2 000211   000004 630400 3                  EPPR0   4
         2 000212   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:29   
         2 000213   000000 701000 xent               TSX1    X$FORMAT
         2 000214   000000 011000                    NOP     0

      211    15201
      212    15202    1   IF LINK_NAME.TEXT = '?' THEN

  15202  2 000215   040000 106500                    CMPC    fill='040'O
         2 000216   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8
         2 000217   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000220   000224 601000 2                  TNZ     s:15205

      213    15203    1      ALL_LINKS = %YES#;

  15203  2 000221   400000 236003                    LDQ     -131072,DU
         2 000222   200003 756100                    STQ     ALL_LINKS,,AUTO
         2 000223   000272 710000 2                  TRA     s:15220

      214    15204    2   ELSE DO;

      215    15205    2      ALL_LINKS = %NO#;

  15205  2 000224   200003 450100                    STZ     ALL_LINKS,,AUTO

      216    15206    2      BEGIN_KEY.TEXT = ' ';

  15206  2 000225   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000226   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000227   200005 755100                    STA     BEGIN_KEY+1,,AUTO
         2 000230   200006 756100                    STQ     BEGIN_KEY+2,,AUTO

      217    15207    2      END_KEY.TEXT = ' ';

  15207  2 000231   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000232   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000233   200015 755100                    STA     END_KEY+1,,AUTO
         2 000234   200016 756100                    STQ     END_KEY+2,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:30   
      218    15208    3      CALL INDEX (I,'?',LINK_NAME.TEXT) WHENRETURN DO;

  15208  2 000235   000000 124500                    SCM     mask='000'O
         2 000236   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8
         2 000237   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000240   200017 000100                    ARG     I,,AUTO
         2 000241   000271 606400 2                  TTN     s:15216

      219    15209    3         BEGIN_KEY.TEXT = SUBSTR(LINK_NAME.TEXT,0,I);

  15209  2 000242   200017 720100                    LXL0    I,,AUTO
         2 000243   040100 100540                    MLR     fill='040'O
         2 000244   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=*X0
         2 000245   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8

      220    15210    3         BEGIN_KEY.COUNT = 8;

  15210  2 000246   010000 236003                    LDQ     4096,DU
         2 000247   200004 756100                    STQ     BEGIN_KEY,,AUTO

      221    15211    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(LINK_NAME.TEXT,0,I),'~');

  15211  2 000250   040100 100540                    MLR     fill='040'O
         2 000251   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=*X0
         2 000252   200015 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000253   200017 236100                    LDQ     I,,AUTO
         2 000254   000010 116007                    CMPQ    8,DL
         2 000255   000263 603000 2                  TRC     s:15212
         2 000256   777767 621006                    EAX1    -9,QL
         2 000257   777777 661003                    ERX1    -1,DU
         2 000260   040146 100400                    MLR     fill='040'O
         2 000261   000005 000001 3                  ADSC9   5                        cn=0,n=1
         2 000262   200015 000011                    ADSC9   END_KEY+1,Q,AUTO         cn=0,n=*X1

      222    15212    3         END_KEY.COUNT = I + 1;

  15212  2 000263   000001 036007                    ADLQ    1,DL
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:31   
         2 000264   000033 736000                    QLS     27
         2 000265   200014 756100                    STQ     END_KEY,,AUTO

      223    15213    3         WILD_CARD = %YES#;

  15213  2 000266   400000 236003                    LDQ     -131072,DU
         2 000267   200032 756100                    STQ     WILD_CARD,,AUTO

      224    15214    3         END;  /*  Whenreturn from index  */

  15214  2 000270   000272 710000 2                  TRA     s:15220

      225    15215    3      WHENALTRETURN DO;

      226    15216    3         WILD_CARD = %NO#;

  15216  2 000271   200032 450100                    STZ     WILD_CARD,,AUTO

      227    15217    3         END;  /* Whenaltreturn  */

      228    15218    2      END;  /*  Else  */

      229    15219
      230    15220    1   FDS.NVECS# = 0;

  15220  2 000272   000011 450000 xsym               STZ     FDS+9

      231    15221
      232    15222    2   IF ALL_LINKS THEN DO;

  15222  2 000273   200003 234100                    SZN     ALL_LINKS,,AUTO
         2 000274   000301 605000 2                  TPL     s:15225

      233    15223    2      USERS_KEY = '001000'O;     /* To precord to begin of :HLP */

  15223  2 000275   000000 100400                    MLR     fill='000'O
         2 000276   000033 000002 xsym               ADSC9   B_VECTNIL+27             cn=0,n=2
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:32   
         2 000277   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      234    15224    2      END;  /*  ALL_LINKS  */

  15224  2 000300   000534 710000 2                  TRA     s:15309

      235    15225    2   ELSE IF WILD_CARD THEN DO;

  15225  2 000301   200032 234100                    SZN     WILD_CARD,,AUTO
         2 000302   000314 605000 2                  TPL     s:15230

      236    15226    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');

  15226  2 000303   040000 100500                    MLR     fill='040'O
         2 000304   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8
         2 000305   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000306   040000 100400                    MLR     fill='040'O
         2 000307   000006 000001 3                  ADSC9   6                        cn=0,n=1
         2 000310   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      237    15227    2         USERS_KEY.COUNT = 9 ;

  15227  2 000311   011000 236003                    LDQ     4608,DU
         2 000312   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      238    15228    2         END; /*  WILD_CARD  */

  15228  2 000313   000534 710000 2                  TRA     s:15309

      239    15229    2      ELSE DO;  /*  Single link and device  */

      240    15230    2         CALL CONCAT (USERS_KEY.TXTC,LINK_NAME.TEXT,'*');

  15230  2 000314   040000 100500                    MLR     fill='040'O
         2 000315   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8
         2 000316   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000317   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:33   
         2 000320   000006 000001 3                  ADSC9   6                        cn=0,n=1
         2 000321   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      241    15231    2         USERS_KEY.COUNT = 9 ;

  15231  2 000322   011000 236003                    LDQ     4608,DU
         2 000323   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      242    15232    2         I = DSEG1SIZE;

  15232  2 000324   000000 235000 xsym               LDA     DSEG1SIZE
         2 000325   200017 755100                    STA     I,,AUTO

      243    15233    2         CALL ASB$READ_HLP (DSEG1$,I,1)

  15233  2 000326   000007 236000 3                  LDQ     7
         2 000327   200036 756100                    STQ     WILD_CARD+4,,AUTO
         2 000330   200017 630500                    EPPR0   I,,AUTO
         2 000331   200035 450500                    STP0    WILD_CARD+3,,AUTO
         2 000332   000010 236000 3                  LDQ     8
         2 000333   200034 756100                    STQ     WILD_CARD+2,,AUTO
         2 000334   200034 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000335   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000336   000000 701000 xent               TSX1    ASB$READ_HLP
         2 000337   000513 702000 2                  TSX2    s:15284

      244    15234    3         WHENRETURN DO;

      245    15235    4            IF LINK$DREC.ATYP ~= %KLAT_LNKLINE# THEN DO;

  15235  2 000340   000000 470400 xsym               LDP0    DSEG1$
         2 000341   000000 236100                    LDQ     0,,PR0
         2 000342   777000 376003                    ANQ     -512,DU
         2 000343   006000 116003                    CMPQ    3072,DU
         2 000344   000355 600000 2                  TZE     s:15254

      246    15236    4               AS_FIELD1 = LINK_NAME;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:34   

  15236  2 000345   000000 100500                    MLR     fill='000'O
         2 000346   200022 000011                    ADSC9   LINK_NAME,,AUTO          cn=0,n=9
         2 000347   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      247    15237                    %SCREAM( ERR#=E$NOTLINK , LEVEL=ERROR, MID='L' );

  15249  2 000350   000011 630400 3                  EPPR0   9
         2 000351   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000352   000000 701000 xent               TSX1    ASH$ERROR
         2 000353   000000 011000                    NOP     0

      248    15252    4               RETURN ;

  15252  2 000354   000000 702200 xent               TSX2  ! X66_ARET

      249    15253    4               END ; /* Then do */
      250    15254    3            I = SIZEW (LINK$DREC) + LINK$DREC.NWINFO;

  15254  2 000355   000017 235100                    LDA     15,,PR0
         2 000356   000020 035007                    ADLA    16,DL
         2 000357   200017 755100                    STA     I,,AUTO

      251    15255    3            LINKDEV$ = DSEG1$;

  15255  2 000360   000000 236000 xsym               LDQ     DSEG1$
         2 000361   200030 756100                    STQ     LINKDEV$,,AUTO

      252    15256    3            DISP_LINKS = 1;

  15256  2 000362   000001 235007                    LDA     1,DL
         2 000363   200013 755100                    STA     DISP_LINKS,,AUTO

      253    15257    3            NEW_LINK = %YES#;

  15257  2 000364   400000 236003                    LDQ     -131072,DU
         2 000365   200031 756100                    STQ     NEW_LINK,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:35   

      254    15258    4            DO FOREVER;

      255    15259    4               CALL ASL$FIND_LINKDEV (DSEG1$, I, LINKDEV_NAME, LINKDEV$) ALTRET (
             15259                        FINISH_UP);

  15259  2 000366   200030 630500                    EPPR0   LINKDEV$,,AUTO
         2 000367   200037 450500                    STP0    WILD_CARD+5,,AUTO
         2 000370   200025 631500                    EPPR1   LINKDEV_NAME,,AUTO
         2 000371   200036 451500                    STP1    WILD_CARD+4,,AUTO
         2 000372   200017 633500                    EPPR3   I,,AUTO
         2 000373   200035 453500                    STP3    WILD_CARD+3,,AUTO
         2 000374   000010 236000 3                  LDQ     8
         2 000375   200034 756100                    STQ     WILD_CARD+2,,AUTO
         2 000376   200034 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000377   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000400   000000 701000 xent               TSX1    ASL$FIND_LINKDEV
         2 000401   000777 702000 2                  TSX2    FINISH_UP

      256    15260    5               IF DISP THEN DO;

  15260  2 000402   200011 234100                    SZN     DISP,,AUTO
         2 000403   000453 605000 2                  TPL     s:15271

      257    15261    6                  IF NOT JCL THEN DO;

  15261  2 000404   200021 234100                    SZN     JCL,,AUTO
         2 000405   000433 604000 2                  TMI     s:15267

      258    15262    6                     CALL CONCAT (FMT_BUF, '%1/   ', LINK_STR, '   ', LINK_NAME.TEXT);

  15262  2 000406   040000 100400                    MLR     fill='040'O
         2 000407   000022 000006 1                  ADSC9   FOUND_STR+4              cn=0,n=6
         2 000410   000000 000006 xsym               ADSC9   FMT_BUF                  cn=0,n=6
         2 000411   040000 100400                    MLR     fill='040'O
         2 000412   000000 000004 1                  ADSC9   LINK_STR                 cn=0,n=4
         2 000413   000001 400004 xsym               ADSC9   FMT_BUF+1                cn=2,n=4
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:36   
         2 000414   040000 100400                    MLR     fill='040'O
         2 000415   000023 000004 1                  ADSC9   FOUND_STR+5              cn=0,n=4
         2 000416   000002 400004 xsym               ADSC9   FMT_BUF+2                cn=2,n=4
         2 000417   040000 100500                    MLR     fill='040'O
         2 000420   200022 200010                    ADSC9   LINK_NAME,,AUTO          cn=1,n=8
         2 000421   000003 400361 xsym               ADSC9   FMT_BUF+3                cn=2,n=241

      259    15263    6                     FDS.FMT_.BOUND = LENGTHC(LINK_STR) + 17;

  15263  2 000422   000000 236000 xsym               LDQ     FDS
         2 000423   177777 376007                    ANQ     65535,DL
         2 000424   000012 276000 3                  ORQ     10
         2 000425   000000 756000 xsym               STQ     FDS

      260    15264    6                     FDS.NVECS# = 0;

  15264  2 000426   000011 450000 xsym               STZ     FDS+9

      261    15265    6                     CALL X$FORMAT (FDS);

  15265  2 000427   000004 630400 3                  EPPR0   4
         2 000430   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000431   000000 701000 xent               TSX1    X$FORMAT
         2 000432   000000 011000                    NOP     0

      262    15266    6                     END; /*  Not jcl  */

      263    15267    5                  CALL ASL$DISP_ONE_LINKDEV (LINKDEV$, NEW_LINK, JCL, LINK_NAME.TEXT);

  15267  2 000433   200040 452500                    STP2    WILD_CARD+6,,AUTO
         2 000434   200040 236100                    LDQ     WILD_CARD+6,,AUTO
         2 000435   000013 036000 3                  ADLQ    11
         2 000436   200037 756100                    STQ     WILD_CARD+5,,AUTO
         2 000437   200021 630500                    EPPR0   JCL,,AUTO
         2 000440   200036 450500                    STP0    WILD_CARD+4,,AUTO
         2 000441   200031 631500                    EPPR1   NEW_LINK,,AUTO
         2 000442   200035 451500                    STP1    WILD_CARD+3,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:37   
         2 000443   200030 633500                    EPPR3   LINKDEV$,,AUTO
         2 000444   200034 453500                    STP3    WILD_CARD+2,,AUTO
         2 000445   200034 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000446   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000447   000000 701000 xent               TSX1    ASL$DISP_ONE_LINKDEV
         2 000450   000000 011000                    NOP     0

      264    15268    5                  NEW_LINK = %NO#;

  15268  2 000451   200031 450100                    STZ     NEW_LINK,,AUTO

      265    15269    5                  END; /*  Disp  */

  15269  2 000452   000511 710000 2                  TRA     s:15280

      266    15270    5               ELSE DO;

      267    15271    5                  FMT_BUF = '%1/   %A  %A  %A  %A';

  15271  2 000453   040000 100400                    MLR     fill='040'O
         2 000454   000024 000024 1                  ADSC9   FOUND_STR+6              cn=0,n=20
         2 000455   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      268    15272    5                  FDS.FMT_.BOUND = 19;

  15272  2 000456   000000 236000 xsym               LDQ     FDS
         2 000457   177777 376007                    ANQ     65535,DL
         2 000460   000014 276000 3                  ORQ     12
         2 000461   000000 756000 xsym               STQ     FDS

      269    15273    5                  FDS.NVECS# = 4;

  15273  2 000462   000004 235007                    LDA     4,DL
         2 000463   000011 755000 xsym               STA     FDS+9

      270    15274    5                  FMT_VEC (0) = VECTOR (LINK_STR);

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:38   
  15274  2 000464   000016 237000 3                  LDAQ    14
         2 000465   000000 755000 xsym               STA     FMT_VEC
         2 000466   000001 756000 xsym               STQ     FMT_VEC+1

      271    15275    5                  FMT_VEC (1) = VECTOR (LINK_NAME.TEXT);

  15275  2 000467   000015 235000 3                  LDA     13
         2 000470   200034 452500                    STP2    WILD_CARD+2,,AUTO
         2 000471   200034 236100                    LDQ     WILD_CARD+2,,AUTO
         2 000472   000013 036000 3                  ADLQ    11
         2 000473   000002 755000 xsym               STA     FMT_VEC+2
         2 000474   000003 756000 xsym               STQ     FMT_VEC+3

      272    15276    5                  FMT_VEC (2) = VECTOR (LINKDEV_STR);

  15276  2 000475   000020 237000 3                  LDAQ    16
         2 000476   000004 755000 xsym               STA     FMT_VEC+4
         2 000477   000005 756000 xsym               STQ     FMT_VEC+5

      273    15277    5                  FMT_VEC (3) = VECTOR (KL$LINKDEV.LOGON#);

  15277  2 000500   000015 235000 3                  LDA     13
         2 000501   200030 236100                    LDQ     LINKDEV$,,AUTO
         2 000502   000004 036003                    ADLQ    4,DU
         2 000503   000006 755000 xsym               STA     FMT_VEC+6
         2 000504   000007 756000 xsym               STQ     FMT_VEC+7

      274    15278    5                  CALL X$FORMAT (FDS);

  15278  2 000505   000004 630400 3                  EPPR0   4
         2 000506   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000507   000000 701000 xent               TSX1    X$FORMAT
         2 000510   000000 011000                    NOP     0

      275    15279    5                  END; /*  ~ disp  */

      276    15280    4               DISP_LINKDEVS = DISP_LINKDEVS + 1;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:39   

  15280  2 000511   200012 054100                    AOS     DISP_LINKDEVS,,AUTO

      277    15281    4               END; /*  Forever  */

  15281  2 000512   000366 710000 2                  TRA     s:15259

      278    15282    3            END;  /*  Whenreturn  */
      279    15283    3         WHENALTRETURN DO;

      280    15284    3            IF MERR_CODE.CODE = %E$NOKEY

  15284  2 000513   000000 236000 xsym               LDQ     ERR_CODE
         2 000514   377770 376007                    ANQ     131064,DL
         2 000515   001020 116007                    CMPQ    528,DL
         2 000516   000527 601000 2                  TNZ     s:15304

      281    15285    4            THEN DO;

      282    15286    4               AS_FIELD1 = LINK_NAME;

  15286  2 000517   000000 100500                    MLR     fill='000'O
         2 000520   200022 000011                    ADSC9   LINK_NAME,,AUTO          cn=0,n=9
         2 000521   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      283    15287                    %SCREAM( ERR#=E$LINK_NO_EXIST2, MID='L', LEVEL=ERROR );

  15299  2 000522   000022 630400 3                  EPPR0   18
         2 000523   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000524   000000 701000 xent               TSX1    ASH$ERROR
         2 000525   000000 011000                    NOP     0

      284    15302    4               END;  /*  Error = nokey  */

  15302  2 000526   000533 710000 2                  TRA     s:15307

      285    15303    4            ELSE DO;
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:40   

      286    15304    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  15304  2 000527   000024 630400 3                  EPPR0   20
         2 000530   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000531   000000 701000 xent               TSX1    ASA$ERROR
         2 000532   000000 011000                    NOP     0

      287    15305    4               END;  /* Error ~= nokey */

      288    15306    3            END;  /*  Whenaltreturn  */

      289    15307    2         GOTO FINISH_UP;

  15307  2 000533   000777 710000 2                  TRA     FINISH_UP

      290    15308    2         END; /*  Else  */
      291    15309    1   CALL ASB$PREC_HLP ;

  15309  2 000534   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000535   000000 701000 xent               TSX1    ASB$PREC_HLP
         2 000536   000000 011000                    NOP     0

      292    15310    2   DO FOREVER;

      293    15311
      294    15312    3      DO UNTIL LINK$DREC.ATYP = %KLAT_LNKLINE# ;

      295    15313    3         I = DSEG1SIZE;

  15313  2 000537   000000 235000 xsym               LDA     DSEG1SIZE
         2 000540   200017 755100                    STA     I,,AUTO

      296    15314    3         CALL ASB$READ_HLP_SEQ(DSEG1$,I,1)

  15314  2 000541   000007 236000 3                  LDQ     7
         2 000542   200036 756100                    STQ     WILD_CARD+4,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:41   
         2 000543   200017 630500                    EPPR0   I,,AUTO
         2 000544   200035 450500                    STP0    WILD_CARD+3,,AUTO
         2 000545   000010 236000 3                  LDQ     8
         2 000546   200034 756100                    STQ     WILD_CARD+2,,AUTO
         2 000547   200034 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000550   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000551   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         2 000552   000554 702000 2                  TSX2    s:15316
         2 000553   000565 710000 2                  TRA     s:15319

      297    15315    4         WHENALTRETURN DO;

      298    15316    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);

  15316  2 000554   000000 236000 xsym               LDQ     ERR_CODE
         2 000555   377770 376007                    ANQ     131064,DL
         2 000556   000060 116007                    CMPQ    48,DL
         2 000557   000564 600000 2                  TZE     s:15317

  15316  2 000560   000026 630400 3                  EPPR0   22
         2 000561   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000562   000000 701000 xent               TSX1    ASH$ERROR
         2 000563   000000 011000                    NOP     0

      299    15317    4            GOTO FINISH_UP;

  15317  2 000564   000777 710000 2                  TRA     FINISH_UP

      300    15318    4            END;  /*  Whenaltreturn  */
      301    15319    3         END;  /*  Do until we find a link record  */

  15319  2 000565   000000 470400 xsym               LDP0    DSEG1$
         2 000566   000000 236100                    LDQ     0,,PR0
         2 000567   777000 376003                    ANQ     -512,DU
         2 000570   006000 116003                    CMPQ    3072,DU
         2 000571   000537 601000 2                  TNZ     s:15313

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:42   
      302    15320    2      CALL INDEX (I,' ',SUBSTR(USERS_KEY.TXTC,0,8)) ;

  15320  2 000572   000000 124400                    SCM     mask='000'O
         2 000573   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000574   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000575   200017 000100                    ARG     I,,AUTO

      303    15321    2      IF I > 8 THEN I = 8;

  15321  2 000576   200017 235100                    LDA     I,,AUTO
         2 000577   000011 115007                    CMPA    9,DL
         2 000600   000603 602000 2                  TNC     s:15322

  15321  2 000601   000010 236007                    LDQ     8,DL
         2 000602   200017 756100                    STQ     I,,AUTO

      304    15322    2      CURRENT_LINK = SUBSTR(USERS_KEY.TXTC,0,I);

  15322  2 000603   200017 720100                    LXL0    I,,AUTO
         2 000604   040100 100440                    MLR     fill='040'O
         2 000605   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
         2 000606   200007 000010                    ADSC9   CURRENT_LINK,,AUTO       cn=0,n=8

      305    15323    3      IF WILD_CARD THEN DO;

  15323  2 000607   200032 234100                    SZN     WILD_CARD,,AUTO
         2 000610   000640 605000 2                  TPL     s:15333

      306    15324    3         J = LINK_NAME.COUNT;

  15324  2 000611   200022 236100                    LDQ     LINK_NAME,,AUTO
         2 000612   000033 772000                    QRL     27
         2 000613   200020 756100                    STQ     J,,AUTO

      307    15325    3         CALL ASB$WILD_MATCH (I, CURRENT_LINK, J, LINK_NAME.TEXT)

  15325  2 000614   200040 452500                    STP2    WILD_CARD+6,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:43   
         2 000615   200040 236100                    LDQ     WILD_CARD+6,,AUTO
         2 000616   000013 036000 3                  ADLQ    11
         2 000617   200037 756100                    STQ     WILD_CARD+5,,AUTO
         2 000620   200020 631500                    EPPR1   J,,AUTO
         2 000621   200036 451500                    STP1    WILD_CARD+4,,AUTO
         2 000622   200007 633500                    EPPR3   CURRENT_LINK,,AUTO
         2 000623   200035 453500                    STP3    WILD_CARD+3,,AUTO
         2 000624   200017 634500                    EPPR4   I,,AUTO
         2 000625   200034 454500                    STP4    WILD_CARD+2,,AUTO
         2 000626   200034 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000627   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000630   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000631   000633 702000 2                  TSX2    s:15327
         2 000632   000640 710000 2                  TRA     s:15333

      308    15326    4         WHENALTRETURN DO;

      309    15327    4            IF CURRENT_LINK > END_KEY.TEXT THEN

  15327  2 000633   040100 106500                    CMPC    fill='040'O
         2 000634   200015 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000635   200007 000010                    ADSC9   CURRENT_LINK,,AUTO       cn=0,n=8
         2 000636   000777 602000 2                  TNC     FINISH_UP

      310    15328    4               GOTO FINISH_UP;
      311    15329    4            ELSE
      312    15330    4               GOTO END_FOREVER;

  15330  2 000637   000776 710000 2                  TRA     END_FOREVER

      313    15331    4            END;  /*  Whenaltreturn  */
      314    15332    3         END; /*  WILD_CARD  */

      315    15333    2      DISP_LINKS = DISP_LINKS + 1;

  15333  2 000640   200013 054100                    AOS     DISP_LINKS,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:44   
      316    15334    2      I = SIZEW (LINK$DREC) + LINK$DREC.NWINFO;

  15334  2 000641   000000 470400 xsym               LDP0    DSEG1$
         2 000642   000017 235100                    LDA     15,,PR0
         2 000643   000020 035007                    ADLA    16,DL
         2 000644   200017 755100                    STA     I,,AUTO

      317    15335    2      LINKDEV$ = DSEG1$;

  15335  2 000645   000000 236000 xsym               LDQ     DSEG1$
         2 000646   200030 756100                    STQ     LINKDEV$,,AUTO

      318    15336    2      NEW_LINK = %YES#;

  15336  2 000647   400000 236003                    LDQ     -131072,DU
         2 000650   200031 756100                    STQ     NEW_LINK,,AUTO

      319    15337    3      DO FOREVER;

      320    15338    3        CALL ASL$FIND_LINKDEV (DSEG1$, I, LINKDEV_NAME, LINKDEV$) ALTRET (END_FOREVER)
             15338                  ;

  15338  2 000651   200030 630500                    EPPR0   LINKDEV$,,AUTO
         2 000652   200037 450500                    STP0    WILD_CARD+5,,AUTO
         2 000653   200025 631500                    EPPR1   LINKDEV_NAME,,AUTO
         2 000654   200036 451500                    STP1    WILD_CARD+4,,AUTO
         2 000655   200017 633500                    EPPR3   I,,AUTO
         2 000656   200035 453500                    STP3    WILD_CARD+3,,AUTO
         2 000657   000010 236000 3                  LDQ     8
         2 000660   200034 756100                    STQ     WILD_CARD+2,,AUTO
         2 000661   200034 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000662   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000663   000000 701000 xent               TSX1    ASL$FIND_LINKDEV
         2 000664   000776 702000 2                  TSX2    END_FOREVER

      321    15339    4         IF DISP THEN DO;

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:45   
  15339  2 000665   200011 234100                    SZN     DISP,,AUTO
         2 000666   000736 605000 2                  TPL     s:15350

      322    15340    5            IF NEW_LINK AND NOT JCL THEN DO;

  15340  2 000667   200031 234100                    SZN     NEW_LINK,,AUTO
         2 000670   000720 605000 2                  TPL     s:15346
         2 000671   200021 234100                    SZN     JCL,,AUTO
         2 000672   000720 604000 2                  TMI     s:15346

      323    15341    5               CALL CONCAT (FMT_BUF, '%1/   ', LINK_STR, '   ', SUBSTR(USERS_KEY.TXTC,
             15341                        0,8));

  15341  2 000673   040000 100400                    MLR     fill='040'O
         2 000674   000022 000006 1                  ADSC9   FOUND_STR+4              cn=0,n=6
         2 000675   000000 000006 xsym               ADSC9   FMT_BUF                  cn=0,n=6
         2 000676   040000 100400                    MLR     fill='040'O
         2 000677   000000 000004 1                  ADSC9   LINK_STR                 cn=0,n=4
         2 000700   000001 400004 xsym               ADSC9   FMT_BUF+1                cn=2,n=4
         2 000701   040000 100400                    MLR     fill='040'O
         2 000702   000023 000004 1                  ADSC9   FOUND_STR+5              cn=0,n=4
         2 000703   000002 400004 xsym               ADSC9   FMT_BUF+2                cn=2,n=4
         2 000704   040000 100400                    MLR     fill='040'O
         2 000705   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000706   000003 400361 xsym               ADSC9   FMT_BUF+3                cn=2,n=241

      324    15342    5               FDS.FMT_.BOUND = LENGTHC(LINK_STR) + 17;

  15342  2 000707   000000 236000 xsym               LDQ     FDS
         2 000710   177777 376007                    ANQ     65535,DL
         2 000711   000012 276000 3                  ORQ     10
         2 000712   000000 756000 xsym               STQ     FDS

      325    15343    5               FDS.NVECS# = 0;

  15343  2 000713   000011 450000 xsym               STZ     FDS+9

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:46   
      326    15344    5               CALL X$FORMAT (FDS);

  15344  2 000714   000004 630400 3                  EPPR0   4
         2 000715   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000716   000000 701000 xent               TSX1    X$FORMAT
         2 000717   000000 011000                    NOP     0

      327    15345    5               END;  /*  New link and not jcl */

      328    15346    4            CALL ASL$DISP_ONE_LINKDEV (LINKDEV$, NEW_LINK, JCL, CURRENT_LINK);

  15346  2 000720   200007 630500                    EPPR0   CURRENT_LINK,,AUTO
         2 000721   200037 450500                    STP0    WILD_CARD+5,,AUTO
         2 000722   200021 631500                    EPPR1   JCL,,AUTO
         2 000723   200036 451500                    STP1    WILD_CARD+4,,AUTO
         2 000724   200031 633500                    EPPR3   NEW_LINK,,AUTO
         2 000725   200035 453500                    STP3    WILD_CARD+3,,AUTO
         2 000726   200030 634500                    EPPR4   LINKDEV$,,AUTO
         2 000727   200034 454500                    STP4    WILD_CARD+2,,AUTO
         2 000730   200034 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000731   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000732   000000 701000 xent               TSX1    ASL$DISP_ONE_LINKDEV
         2 000733   000000 011000                    NOP     0

      329    15347    4            NEW_LINK = %NO#;

  15347  2 000734   200031 450100                    STZ     NEW_LINK,,AUTO

      330    15348    4            END;  /*  Disp  */

  15348  2 000735   000774 710000 2                  TRA     s:15359

      331    15349    4         ELSE DO;

      332    15350    4            FMT_BUF = '%1/   %A  %A  %A  %A';

  15350  2 000736   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:47   
         2 000737   000024 000024 1                  ADSC9   FOUND_STR+6              cn=0,n=20
         2 000740   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      333    15351    4            FDS.FMT_.BOUND = 19;

  15351  2 000741   000000 236000 xsym               LDQ     FDS
         2 000742   177777 376007                    ANQ     65535,DL
         2 000743   000014 276000 3                  ORQ     12
         2 000744   000000 756000 xsym               STQ     FDS

      334    15352    4            FDS.NVECS# = 4;

  15352  2 000745   000004 235007                    LDA     4,DL
         2 000746   000011 755000 xsym               STA     FDS+9

      335    15353    4            FMT_VEC (0) = VECTOR (LINK_STR);

  15353  2 000747   000016 237000 3                  LDAQ    14
         2 000750   000000 755000 xsym               STA     FMT_VEC
         2 000751   000001 756000 xsym               STQ     FMT_VEC+1

      336    15354    4            FMT_VEC (1) = VECTOR (CURRENT_LINK);

  15354  2 000752   000015 235000 3                  LDA     13
         2 000753   200034 452500                    STP2    WILD_CARD+2,,AUTO
         2 000754   200034 236100                    LDQ     WILD_CARD+2,,AUTO
         2 000755   000007 036003                    ADLQ    7,DU
         2 000756   000002 755000 xsym               STA     FMT_VEC+2
         2 000757   000003 756000 xsym               STQ     FMT_VEC+3

      337    15355    4            FMT_VEC (2) = VECTOR (LINKDEV_STR);

  15355  2 000760   000020 237000 3                  LDAQ    16
         2 000761   000004 755000 xsym               STA     FMT_VEC+4
         2 000762   000005 756000 xsym               STQ     FMT_VEC+5

      338    15356    4            FMT_VEC (3) = VECTOR (KL$LINKDEV.LOGON#);
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:48   

  15356  2 000763   000015 235000 3                  LDA     13
         2 000764   200030 236100                    LDQ     LINKDEV$,,AUTO
         2 000765   000004 036003                    ADLQ    4,DU
         2 000766   000006 755000 xsym               STA     FMT_VEC+6
         2 000767   000007 756000 xsym               STQ     FMT_VEC+7

      339    15357    4            CALL X$FORMAT (FDS);

  15357  2 000770   000004 630400 3                  EPPR0   4
         2 000771   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000772   000000 701000 xent               TSX1    X$FORMAT
         2 000773   000000 011000                    NOP     0

      340    15358    4            END;  /*  ~ disp  */

      341    15359    3         DISP_LINKDEVS = DISP_LINKDEVS + 1;

  15359  2 000774   200012 054100                    AOS     DISP_LINKDEVS,,AUTO

      342    15360    3         END;  /*  Forever  */

  15360  2 000775   000651 710000 2                  TRA     s:15338

      343    15361    2   END_FOREVER:
      344    15362    2      END;  /*  Do forever  */

  15362  2 000776   000537 710000 2     END_FOREVER  TRA     s:15313

      345    15363    1   FINISH_UP:
      346    15364    2   IF NOT DISP THEN DO;

  15364  2 000777   200011 234100       FINISH_UP    SZN     DISP,,AUTO
         2 001000   001015 604000 2                  TMI     s:15370

      347    15365    2      FMT_BUF = '%\%/';

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:49   
  15365  2 001001   040000 100400                    MLR     fill='040'O
         2 001002   000032 000004 1                  ADSC9   FOUND_STR+12             cn=0,n=4
         2 001003   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      348    15366    2      FDS.FMT_.BOUND = 3;

  15366  2 001004   000000 236000 xsym               LDQ     FDS
         2 001005   177777 376007                    ANQ     65535,DL
         2 001006   600000 276007                    ORQ     -65536,DL
         2 001007   000000 756000 xsym               STQ     FDS

      349    15367    2      FDS.NVECS# = 0;

  15367  2 001010   000011 450000 xsym               STZ     FDS+9

      350    15368    2      CALL X$FORMAT(FDS);

  15368  2 001011   000004 630400 3                  EPPR0   4
         2 001012   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001013   000000 701000 xent               TSX1    X$FORMAT
         2 001014   000000 011000                    NOP     0

      351    15369    2      END; /*  If not disp  */

      352    15370    2   IF NOT JCL THEN DO;

  15370  2 001015   200021 234100                    SZN     JCL,,AUTO
         2 001016   001125 604000 2                  TMI     s:15404

      353    15371    2      FMT_VEC(0) = VECTOR (DISP_LINKS);

  15371  2 001017   777640 235007                    LDA     -96,DL
         2 001020   200034 452500                    STP2    WILD_CARD+2,,AUTO
         2 001021   200034 236100                    LDQ     WILD_CARD+2,,AUTO
         2 001022   000013 036003                    ADLQ    11,DU
         2 001023   000000 755000 xsym               STA     FMT_VEC
         2 001024   000001 756000 xsym               STQ     FMT_VEC+1
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:50   

      354    15372    2      IF DISP_LINKS = 1 THEN

  15372  2 001025   200013 235100                    LDA     DISP_LINKS,,AUTO
         2 001026   000001 115007                    CMPA    1,DL
         2 001027   001034 601000 2                  TNZ     s:15377

      355    15373    3      DO;

      356    15374    3         FMT_VEC(1) = VECTOR (LINK_STR);

  15374  2 001030   000016 237000 3                  LDAQ    14
         2 001031   000002 755000 xsym               STA     FMT_VEC+2
         2 001032   000003 756000 xsym               STQ     FMT_VEC+3

      357    15375    3         END; /*  DISP_LINKS = 1  */

  15375  2 001033   001037 710000 2                  TRA     s:15379

      358    15376    3      ELSE DO;

      359    15377    3         FMT_VEC(1) = VECTOR (LINKS_STR);

  15377  2 001034   000030 237000 3                  LDAQ    24
         2 001035   000002 755000 xsym               STA     FMT_VEC+2
         2 001036   000003 756000 xsym               STQ     FMT_VEC+3

      360    15378    3         END; /*  DISP_LINKS ~= 1  */

      361    15379    2      FMT_VEC(2) = VECTOR (FOUND_STR);

  15379  2 001037   000032 237000 3                  LDAQ    26
         2 001040   000004 755000 xsym               STA     FMT_VEC+4
         2 001041   000005 756000 xsym               STQ     FMT_VEC+5

      362    15380    2      FDS.NVECS# = 3;

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:51   
  15380  2 001042   000003 235007                    LDA     3,DL
         2 001043   000011 755000 xsym               STA     FDS+9

      363    15381    2      FMT_BUF = '   %5D %A %A.';

  15381  2 001044   040000 100400                    MLR     fill='040'O
         2 001045   000033 000015 1                  ADSC9   FOUND_STR+13             cn=0,n=13
         2 001046   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      364    15382    2      FDS.FMT_.BOUND = 12;

  15382  2 001047   000000 236000 xsym               LDQ     FDS
         2 001050   177777 376007                    ANQ     65535,DL
         2 001051   000003 276003                    ORQ     3,DU
         2 001052   000000 756000 xsym               STQ     FDS

      365    15383    2      CALL X$FORMAT(FDS);

  15383  2 001053   000004 630400 3                  EPPR0   4
         2 001054   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001055   000000 701000 xent               TSX1    X$FORMAT
         2 001056   000000 011000                    NOP     0

      366    15384    2      FMT_VEC(0) = VECTOR (DISP_LINKDEVS);

  15384  2 001057   777640 235007                    LDA     -96,DL
         2 001060   200034 452500                    STP2    WILD_CARD+2,,AUTO
         2 001061   200034 236100                    LDQ     WILD_CARD+2,,AUTO
         2 001062   000012 036003                    ADLQ    10,DU
         2 001063   000000 755000 xsym               STA     FMT_VEC
         2 001064   000001 756000 xsym               STQ     FMT_VEC+1

      367    15385    2      IF DISP_LINKDEVS = 1 THEN

  15385  2 001065   200012 235100                    LDA     DISP_LINKDEVS,,AUTO
         2 001066   000001 115007                    CMPA    1,DL
         2 001067   001074 601000 2                  TNZ     s:15390
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:52   

      368    15386    3      DO;

      369    15387    3         FMT_VEC(1) = VECTOR (LINKDEV_STR);

  15387  2 001070   000020 237000 3                  LDAQ    16
         2 001071   000002 755000 xsym               STA     FMT_VEC+2
         2 001072   000003 756000 xsym               STQ     FMT_VEC+3

      370    15388    3         END; /*  DISP_LINKDEVS = 1  */

  15388  2 001073   001077 710000 2                  TRA     s:15392

      371    15389    3      ELSE DO;

      372    15390    3         FMT_VEC(1) = VECTOR (LINKDEVS_STR);

  15390  2 001074   000034 237000 3                  LDAQ    28
         2 001075   000002 755000 xsym               STA     FMT_VEC+2
         2 001076   000003 756000 xsym               STQ     FMT_VEC+3

      373    15391    3         END; /*  DISP_LINKDEVS ~= 1  */

      374    15392    2      IF DISP THEN

  15392  2 001077   200011 234100                    SZN     DISP,,AUTO
         2 001100   001105 605000 2                  TPL     s:15397

      375    15393    3      DO;

      376    15394    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  15394  2 001101   000036 237000 3                  LDAQ    30
         2 001102   000004 755000 xsym               STA     FMT_VEC+4
         2 001103   000005 756000 xsym               STQ     FMT_VEC+5

      377    15395    3         END; /*  If disp  */
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:53   

  15395  2 001104   001110 710000 2                  TRA     s:15399

      378    15396    3      ELSE DO;

      379    15397    3         FMT_VEC(2) = VECTOR (LIST_STR);

  15397  2 001105   000040 237000 3                  LDAQ    32
         2 001106   000004 755000 xsym               STA     FMT_VEC+4
         2 001107   000005 756000 xsym               STQ     FMT_VEC+5

      380    15398    3         END; /*  If ~ disp  */

      381    15399    2      FDS.NVECS# = 3;

  15399  2 001110   000003 235007                    LDA     3,DL
         2 001111   000011 755000 xsym               STA     FDS+9

      382    15400    2      FMT_BUF = '   %5D %A %A.';

  15400  2 001112   040000 100400                    MLR     fill='040'O
         2 001113   000033 000015 1                  ADSC9   FOUND_STR+13             cn=0,n=13
         2 001114   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      383    15401    2      FDS.FMT_.BOUND = 12;

  15401  2 001115   000000 236000 xsym               LDQ     FDS
         2 001116   177777 376007                    ANQ     65535,DL
         2 001117   000003 276003                    ORQ     3,DU
         2 001120   000000 756000 xsym               STQ     FDS

      384    15402    2      CALL X$FORMAT(FDS);

  15402  2 001121   000004 630400 3                  EPPR0   4
         2 001122   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001123   000000 701000 xent               TSX1    X$FORMAT
         2 001124   000000 011000                    NOP     0
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:54   

      385    15403    2      END; /* Not jcl */

      386    15404    1   RETURN;

  15404  2 001125   000000 702200 xent               TSX2  ! X66_ARET
      387    15405    1   END ASL$LIST_ALL_LINKDEVS;
      388    15406        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:55   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_LINKDEVS.
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:56   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$LIST_ALL_LINKDEVS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    13-0-0/c CHAR(9)     r     1 DISPLAY_STR               16-0-0/c CHAR(5)     r     1 FOUND_STR
     6-0-0/c CHAR(12)    r     1 LINKDEVS_STR               3-0-0/c CHAR(11)    r     1 LINKDEV_STR
     1-0-0/c CHAR(5)     r     1 LINKS_STR                  0-0-0/c CHAR(4)     r     1 LINK_STR
    11-0-0/c CHAR(6)     r     1 LIST_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 ALL_LINKS                  4-0-0/w STRC(108)   r     1 BEGIN_KEY
     7-0-0/c CHAR(8)     r     1 CURRENT_LINK              11-0-0/b BIT         r     1 DISP
    12-0-0/w SBIN        r     1 DISP_LINKDEVS             13-0-0/w SBIN        r     1 DISP_LINKS
    14-0-0/w STRC(108)   r     1 END_KEY                   17-0-0/w UBIN        r     1 I
    20-0-0/w UBIN        r     1 J                         21-0-0/b BIT         r     1 JCL
    30-0-0/w PTR         r     1 LINKDEV$                  25-0-0/c STRC(81)    r     1 LINKDEV_NAME
    22-0-0/c STRC(81)    r     1 LINK_NAME                 31-0-0/b BIT         r     1 NEW_LINK
    32-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:57   

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(216)   r     1 KL$LINKDEV                 0-0-0/w STRC(576)   r     1 LINK$DREC
     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w ASTR(153)   r     1 P$S


   Procedure ASL$LIST_ALL_LINKDEVS requires 598 words for executable code.
   Procedure ASL$LIST_ALL_LINKDEVS requires 34 words of local(AUTO) storage.
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:58   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:59   
          MINI XREF LISTING

ALL_LINKS
     15097**DCL     15203<<ASSIGN  15205<<ASSIGN  15222>>IF
ASA$ERROR
     14706**DCL-ENT 15304--CALL
ASA_BRKS_LOC
     11838**DCL     11838--REDEF
ASB$PREC_HLP
     14694**DCL-ENT 15309--CALL
ASB$READ_HLP
     14697**DCL-ENT 15233--CALL
ASB$READ_HLP_SEQ
     14700**DCL-ENT 15314--CALL
ASB$WILD_MATCH
     14715**DCL-ENT 15325--CALL
ASH$ERROR
     14703**DCL-ENT 15249--CALL    15299--CALL    15316--CALL
ASL$DISP_ONE_LINKDEV
     14712**DCL-ENT 15267--CALL    15346--CALL
ASL$FIND_LINKDEV
     14709**DCL-ENT 15259--CALL    15338--CALL
AS_DEFAULT.BANNER_PERM
     12531**DCL     12532--REDEF
AS_DEFAULT.BUDGET.MACCT
     12436**DCL     12440--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12449**DCL     12452--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12432**DCL     12434--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12427**DCL     12429--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12547**DCL     12548--REDEF   12549--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:60   
AS_DEFAULT_DREC.PASSWORD
     13801**DCL     13805--REDEF
AS_DEFAULT_DREC.RENAME
     13824**DCL     13825--REDEF
AS_DFLT.BANNER_PERM
     12353**DCL     12354--REDEF
AS_DFLT.BUDGET.MACCT
     12258**DCL     12262--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12271**DCL     12274--REDEF
AS_DFLT.BUDGET.PACCUM
     12254**DCL     12256--REDEF
AS_DFLT.BUDGET.PMAXC
     12249**DCL     12251--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12369**DCL     12370--REDEF   12371--REDEF
AS_FE_MODE
     11704**DCL     11705--REDEF
AS_FIELD1
     11834**DCL     15236<<ASSIGN  15286<<ASSIGN
AS_MODE
     11701**DCL     11703--REDEF
AS_MOD_USER.ACCESS
     14566**DCL     14567--REDEF
AS_MOD_USER.BANNER
     14553**DCL     14554--REDEF
AS_MOD_USER.BANNER_PERM
     14555**DCL     14556--REDEF
AS_MOD_USER.BILL
     14561**DCL     14562--REDEF
AS_MOD_USER.CPROC
     14557**DCL     14558--REDEF
AS_MOD_USER.FEBILL
     14637**DCL     14638--REDEF
AS_MOD_USER.FECXTMEM
     14654**DCL     14655--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:61   
AS_MOD_USER.FEMINTS
     14639**DCL     14640--REDEF
AS_MOD_USER.FEMMEM
     14650**DCL     14651--REDEF
AS_MOD_USER.FEMTIME
     14648**DCL     14649--REDEF
AS_MOD_USER.FEPPRIV
     14645**DCL     14647--REDEF
AS_MOD_USER.FEPRIV
     14642**DCL     14644--REDEF
AS_MOD_USER.FORCE_BIT
     14551**DCL     14552--REDEF
AS_MOD_USER.KEY
     14633**DCL     14635--REDEF
AS_MOD_USER.LASTCPROC
     14559**DCL     14560--REDEF
AS_MOD_USER.LIMITS.DO_
     14607**DCL     14608--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14623**DCL     14624--REDEF
AS_MOD_USER.LIMITS.LO
     14603**DCL     14604--REDEF
AS_MOD_USER.LIMITS.MEM
     14599**DCL     14600--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14627**DCL     14628--REDEF
AS_MOD_USER.LIMITS.PDIS
     14615**DCL     14616--REDEF
AS_MOD_USER.LIMITS.PO
     14611**DCL     14612--REDEF
AS_MOD_USER.LIMITS.TDIS
     14619**DCL     14620--REDEF
AS_MOD_USER.LIMITS.TIME
     14595**DCL     14596--REDEF
AS_MOD_USER.MAXENQ
     14576**DCL     14577--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:62   
AS_MOD_USER.PERM_BIT
     14549**DCL     14550--REDEF
AS_MOD_USER.PPRIV
     14571**DCL     14573--REDEF
AS_MOD_USER.PRIOB
     14578**DCL     14579--REDEF
AS_MOD_USER.PRIV
     14568**DCL     14570--REDEF
AS_MOD_USER.QUAN
     14574**DCL     14575--REDEF
AS_MOD_USER.SETUP
     14547**DCL     14548--REDEF
AS_PROJECT.BANNER_PERM
     12887**DCL     12888--REDEF
AS_PROJECT.BUDGET.MACCT
     12792**DCL     12796--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12805**DCL     12808--REDEF
AS_PROJECT.BUDGET.PACCUM
     12788**DCL     12790--REDEF
AS_PROJECT.BUDGET.PMAXC
     12783**DCL     12785--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12903**DCL     12904--REDEF   12905--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     13065**DCL     13066--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12970**DCL     12974--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12983**DCL     12986--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12966**DCL     12968--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12961**DCL     12963--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13081**DCL     13082--REDEF   13083--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:63   
AS_PROJECT_DFLT_DREC.PASSWORD
     14287**DCL     14291--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     14310**DCL     14311--REDEF
AS_PROJECT_DREC.PASSWORD
     14125**DCL     14129--REDEF
AS_PROJECT_DREC.RENAME
     14148**DCL     14149--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12709**DCL     12710--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12614**DCL     12618--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12627**DCL     12630--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12610**DCL     12612--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12605**DCL     12607--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12725**DCL     12726--REDEF   12727--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13963**DCL     13967--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13986**DCL     13987--REDEF
AS_USERS.BANNER_PERM
     12175**DCL     12176--REDEF
AS_USERS.BUDGET.MACCT
     12080**DCL     12084--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     12093**DCL     12096--REDEF
AS_USERS.BUDGET.PACCUM
     12076**DCL     12078--REDEF
AS_USERS.BUDGET.PMAXC
     12071**DCL     12073--REDEF
AS_USERS.SETUP_CHRA.TXT
     12191**DCL     12192--REDEF   12193--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:64   
AS_USERS_CONSTANT.BANNER_PERM
     13243**DCL     13244--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     13148**DCL     13152--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13161**DCL     13164--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13144**DCL     13146--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13139**DCL     13141--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13259**DCL     13260--REDEF   13261--REDEF
BEGIN_KEY.COUNT
     15099**DCL     15210<<ASSIGN
BEGIN_KEY.TEXT
     15100**DCL     15206<<ASSIGN  15209<<ASSIGN  15226>>CALLBLT
CODE
     11831**DCL     15136<<ASSIGN  15146>>DOSELCT 15168>>ASSIGN
CURRENT_LINK
     15101**DCL     15322<<ASSIGN  15325<>CALL    15327>>IF      15346<>CALL    15354--ASSIGN
DISP
     15102**DCL     15150<<ASSIGN  15155<<ASSIGN  15168<<ASSIGN  15260>>IF      15339>>IF      15364>>IF
     15392>>IF
DISPLAY_STR
     15130**DCL     15394--ASSIGN
DISP_LINKDEVS
     15103**DCL     15143<<ASSIGN  15280<<ASSIGN  15280>>ASSIGN  15359<<ASSIGN  15359>>ASSIGN  15384--ASSIGN
     15385>>IF
DISP_LINKS
     15104**DCL     15144<<ASSIGN  15256<<ASSIGN  15333<<ASSIGN  15333>>ASSIGN  15371--ASSIGN  15372>>IF
DSEG1$
     11839**DCL     14820--IMP-PTR 15233<>CALL    15235>>IF      15254>>ASSIGN  15255>>ASSIGN  15259<>CALL
     15312>>DOUNTIL 15314<>CALL    15334>>ASSIGN  15335>>ASSIGN  15338<>CALL
DSEG1SIZE
     11840**DCL     15232>>ASSIGN  15313>>ASSIGN
END_FOREVER
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:65   
     15362**LABEL   15330--GOTO    15338--CALLALT
END_KEY.COUNT
     15106**DCL     15212<<ASSIGN
END_KEY.TEXT
     15107**DCL     15207<<ASSIGN  15211<<CALLBLT 15327>>IF
ERR_CODE
     11833**DCL     11834--REDEF
FDS
     11730**DCL     15200<>CALL    15265<>CALL    15278<>CALL    15344<>CALL    15357<>CALL    15368<>CALL
     15383<>CALL    15402<>CALL
FDS.FMT_.BOUND
     11735**DCL     15193<<ASSIGN  15197<<ASSIGN  15263<<ASSIGN  15272<<ASSIGN  15342<<ASSIGN  15351<<ASSIGN
     15366<<ASSIGN  15382<<ASSIGN  15401<<ASSIGN
FDS.NVECS#
     11758**DCL     15190<<ASSIGN  15220<<ASSIGN  15264<<ASSIGN  15273<<ASSIGN  15343<<ASSIGN  15352<<ASSIGN
     15367<<ASSIGN  15380<<ASSIGN  15399<<ASSIGN
FDS.TABDFLT#
     11796**DCL     15199<<ASSIGN
FINISH_UP
     15364**LABEL   15259--CALLALT 15307--GOTO    15317--GOTO    15328--GOTO
FMT_BUF
     11829**DCL     15192<<CALLBLT 15196<<CALLBLT 15262<<CALLBLT 15271<<ASSIGN  15341<<CALLBLT 15350<<ASSIGN
     15365<<ASSIGN  15381<<ASSIGN  15400<<ASSIGN
FMT_VEC
     11829**DCL     15274<<ASSIGN  15275<<ASSIGN  15276<<ASSIGN  15277<<ASSIGN  15353<<ASSIGN  15354<<ASSIGN
     15355<<ASSIGN  15356<<ASSIGN  15371<<ASSIGN  15374<<ASSIGN  15377<<ASSIGN  15379<<ASSIGN  15384<<ASSIGN
     15387<<ASSIGN  15390<<ASSIGN  15394<<ASSIGN  15397<<ASSIGN
FOUND_STR
     15131**DCL     15379--ASSIGN
I
     15108**DCL     15169<<DOINDEX 15170>>IF      15171>>ASSIGN  15171>>ASSIGN  15172>>ASSIGN  15175>>IF
     15176>>ASSIGN  15176>>ASSIGN  15177>>ASSIGN  15180>>IF      15208<<CALLBLT 15209>>ASSIGN  15211>>CALLBLT
     15212>>ASSIGN  15232<<ASSIGN  15233<>CALL    15254<<ASSIGN  15259<>CALL    15313<<ASSIGN  15314<>CALL
     15320<<CALLBLT 15321>>IF      15321<<ASSIGN  15322>>ASSIGN  15325<>CALL    15334<<ASSIGN  15338<>CALL
J
     15109**DCL     15324<<ASSIGN  15325<>CALL
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:66   
JCL
     15110**DCL     15137<<ASSIGN  15151<<ASSIGN  15158<<ASSIGN  15161<<ASSIGN  15182<<ASSIGN  15191>>IF
     15261>>IF      15267<>CALL    15340>>IF      15346<>CALL    15370>>IF
KL$LINKDEV.LOGON#
     15092**DCL     15277--ASSIGN  15356--ASSIGN
KL_DEFAULT.PASSWORD
     14449**DCL     14453--REDEF
KL_DEFAULT.RENAME
     14472**DCL     14473--REDEF
KL_DFLT.PASSWORD
     13639**DCL     13643--REDEF
KL_DFLT.RENAME
     13662**DCL     13663--REDEF
KL_DREC.PASSWORD
     13477**DCL     13481--REDEF
KL_DREC.RENAME
     13500**DCL     13501--REDEF
KL_DREC_CNT.PASSWORD
     13364**DCL     13368--REDEF
KL_DREC_CNT.RENAME
     13387**DCL     13388--REDEF
LINK$DREC
     14820**DCL     15254--ASSIGN  15334--ASSIGN
LINK$DREC.ATYP
     14825**DCL     15235>>IF      15312>>DOUNTIL
LINK$DREC.NWINFO
     14918**DCL     15254>>ASSIGN  15334>>ASSIGN
LINK$DREC.PASSWORD
     14878**DCL     14882--REDEF
LINK$DREC.RENAME
     14901**DCL     14902--REDEF
LINKDEV$
     15117**DCL     14940--IMP-PTR 15255<<ASSIGN  15259<>CALL    15267<>CALL    15277>>ASSIGN  15335<<ASSIGN
     15338<>CALL    15346<>CALL    15356>>ASSIGN
LINKDEVS_STR
     15128**DCL     15192>>CALLBLT 15193--ASSIGN  15196>>CALLBLT 15197--ASSIGN  15390--ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:67   
LINKDEV_NAME
     15114**DCL     15259<>CALL    15338<>CALL
LINKDEV_NAME.COUNT
     15115**DCL     15142<<ASSIGN  15177<<ASSIGN
LINKDEV_NAME.TEXT
     15116**DCL     15141<<ASSIGN  15176<<ASSIGN
LINKDEV_STR
     15127**DCL     15276--ASSIGN  15355--ASSIGN  15387--ASSIGN
LINKS_STR
     15126**DCL     15377--ASSIGN
LINK_NAME
     15111**DCL     15236>>ASSIGN  15286>>ASSIGN
LINK_NAME.COUNT
     15112**DCL     15140<<ASSIGN  15172<<ASSIGN  15324>>ASSIGN
LINK_NAME.TEXT
     15113**DCL     15139<<ASSIGN  15171<<ASSIGN  15202>>IF      15208>>CALLBLT 15209>>ASSIGN  15211>>CALLBLT
     15230>>CALLBLT 15262>>CALLBLT 15267<>CALL    15275--ASSIGN  15325<>CALL
LINK_STR
     15125**DCL     15262>>CALLBLT 15263--ASSIGN  15274--ASSIGN  15341>>CALLBLT 15342--ASSIGN  15353--ASSIGN
     15374--ASSIGN
LIST_STR
     15129**DCL     15397--ASSIGN
MERR_CODE
     11834**DCL     15316<>CALL
MERR_CODE.CODE
     11834**DCL     15284>>IF      15316>>IF
NEW_LINK
     15118**DCL     15257<<ASSIGN  15267<>CALL    15268<<ASSIGN  15336<<ASSIGN  15340>>IF      15346<>CALL
     15347<<ASSIGN
NODE$
     11831**DCL     14728--IMP-PTR
P$B.CODE
     14736**DCL     15136>>ASSIGN  15157>>IF      15160>>IF      15170>>IF      15175>>IF      15180>>IF
P$B.NSUBLKS
     14740**DCL     15156>>IF      15159>>IF      15169>>DOINDEX
P$B.SUBLK$
PL6.E3A0      #001=ASL$LIST_ALL_LINKDEVS File=ASL$LIST_LINK_DEVICES.:E05TSI      TUE 07/29/97 10:16 Page:68   
     14761**DCL     15136>>ASSIGN  15157>>IF      15160>>IF      15170>>IF      15171>>ASSIGN  15171>>ASSIGN
     15172>>ASSIGN  15175>>IF      15176>>ASSIGN  15176>>ASSIGN  15177>>ASSIGN  15180>>IF
P$S.COUNT
     14797**DCL     14800--IMP-SIZ 15171>>ASSIGN  15172>>ASSIGN  15176>>ASSIGN  15177>>ASSIGN
P$S.TEXT
     14800**DCL     15171>>ASSIGN  15176>>ASSIGN
PROJ_KEY.TEXT
     11711**DCL     11711--REDEF
PROJ_KEY.TXT.PROJECT
     11711**DCL     11711--REDEF
P_PCB.OUT$
     11879**DCL     15136>>ASSIGN  15156>>IF      15157>>IF      15159>>IF      15160>>IF      15169>>DOINDEX
     15170>>IF      15171>>ASSIGN  15171>>ASSIGN  15172>>ASSIGN  15175>>IF      15176>>ASSIGN  15176>>ASSIGN
     15177>>ASSIGN  15180>>IF
REMEM_VAR
     11837**DCL     11837--REDEF
REM_FCMD
     11837**DCL     11838--REDEF
USERS_KEY
     11708**DCL     15223<<ASSIGN  15304<>CALL
USERS_KEY.COUNT
     11708**DCL     15227<<ASSIGN  15231<<ASSIGN
USERS_KEY.TEXT
     11708**DCL     11709--REDEF   11709--REDEF   11709--REDEF   11710--REDEF
USERS_KEY.TXTC
     11709**DCL     15226<<CALLBLT 15230<<CALLBLT 15320>>CALLBLT 15322>>ASSIGN  15341>>CALLBLT
WILD_CARD
     15119**DCL     15138<<ASSIGN  15213<<ASSIGN  15216<<ASSIGN  15225>>IF      15323>>IF
X$FORMAT
     14717**DCL-ENT 15200--CALL    15265--CALL    15278--CALL    15344--CALL    15357--CALL    15368--CALL
     15383--CALL    15402--CALL

PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:69   
      389        1        /*T***********************************************************/
      390        2        /*T*                                                         */
      391        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      392        4        /*T*                                                         */
      393        5        /*T***********************************************************/
      394        6        %EJECT;
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:70   
      395        7        /*M* ASL$FIND_LINKDEV: Routine to find link devices.*/
      396        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      397        9              ECU=3,CSU=3,SDI=3                                           */
      398       10        ASL$FIND_LINKDEV: PROC (LINK$, SIZE, NAME, LINKDEV$) ALTRET;
      399       11        /**********************************************************/
      400       12
      401       13        /*D* NAME:     ASL$FIND_LINKDEV
      402       14             CALL:     CALL ASL$FIND_LINKDEV (LINK$, SIZE, NAME, LINKDEV$)
      403       15             INPUT:    LINK$  - Pointer to the link record in memory.
      404       16                       SIZE   - The size of the link record in words.
      405       17                       NAME   - The textc name of the sought link device.
      406       18             OUTPUT:   LINKDEV$  - Returned pointer to the link device found.
      407       19             DESCRIPTION:  ASL$FIND_LINKDEV is the routine to handle
      408       20                           the finding of link devices for the link in data
      409       21                           segment 1.  This routine will cycle through the
      410       22                           link devices and vircirs in data segment 1, matching the
      411       23                           link device names against NAME if necessary
      412       24                           and then returning with LINKDEV$ pointing at the
      413       25                           link device found or altreturning with LINKDEV$ set
      414       26                           to NIL.
      415       27        */
      416       28        /********************************************************************/
      417       29        /*   Include files   include files   include files   include files  */
      418       30        /********************************************************************/
      419       31        %INCLUDE AS_PERR_C;
      420      633        %INCLUDE AS_SUPER_C;
      421     1068        %INCLUDE AS_SUBS_C;
      422     2482        %INCLUDE AS_MAC_C;
      423     2562        %INCLUDE AS_ENTRIES_M;
      424     3612        %INCLUDE AS_SSUBS_C;
      425     3704        %INCLUDE B_ERRORS_C;
      426     4831        %INCLUDE CP_6_SUBS;
      427     5371        %INCLUDE KL_SUPER_C;
      428     8273        %INCLUDE XU_MACRO_C;
      429    11379        %INCLUDE XU_FORMAT_C;
      430    11541        %INCLUDE AS_SUPER_R;
      431    14557        /********************************************************************/
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:71   
      432    14558        /*   Parameters      parameters      parameters      parameters     */
      433    14559        /********************************************************************/
      434    14560    1   DCL LINK$                    PTR;
      435    14561    1   DCL LINKDEV$                 PTR;
      436    14562    1   DCL 1 NAME,
      437    14563    1          2 COUNT               UBIN BYTE UNAL,
      438    14564    1          2 TEXT                CHAR(8) CALIGNED;
      439    14565    1   DCL SIZE                     UBIN;
      440    14566        /********************************************************************/
      441    14567        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      442    14568        /********************************************************************/
      443    14569        %ASH$ERROR ;
      444    14572        %ASB$WILD_MATCH ;
      445    14575        /********************************************************************/
      446    14576        /*   Local based     local based     local based     local based    */
      447    14577        /********************************************************************/
      448    14578    1   DCL 1 TEXT$C BASED ALIGNED,
      449    14579    1          2 CNT                      UBIN(9) UNAL ,
      450    14580    1          2 TEXT                     CHAR(TEXT$C.CNT) UNAL;
      451    14581        %KL_DREC        ( NAME    = LINK$DREC,
      452    14582                          STCLASS = "BASED(DSEG1$)",
      453    14583                          LAST    = ",");
      454    14696        %KL_LNK         ( NAME    = LNK,
      455    14697                          LVL     = 2,
      456    14698                          STCLASS = BASED,
      457    14699                          LAST    = ";");
      458    14923        %KL_LINKDEV     ( NAME    = KL$LINKDEV,
      459    14924                          LVL     = 1,
      460    14925                          LAST    = ";",
      461    14926                          STCLASS = "BASED( LINKDEV$ )" );
      462    15097        /********************************************************************/
      463    15098        /*   Auto data       auto data       auto data       auto data      */
      464    15099        /********************************************************************/
      465    15100    1   DCL ALL                      BIT(1);
      466    15101    1   DCL DEV_SIZEW                SBIN WORD ;
      467    15102    1   DCL DEV_START$               PTR ;
      468    15103    1   DCL DEV_STOP$                PTR ;
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:72   
      469    15104    1   DCL I                        UBIN;
      470    15105    1   DCL TEMPVC                   CHAR(2);
      471    15106    1   DCL WILD_CARD                BIT(1);
      472    15107        /********************************************************************/
      473    15108        /*   Constant data   constant data   constant data   constant data  */
      474    15109        /********************************************************************/
      475    15110        %KL_LINKDEV  ( LVL = 1, STCLASS = CONSTANT );
      476    15281        %KL_LNKVC    ( LVL = 1, STCLASS = CONSTANT );
      477    15505        /********************************************************************/
      478    15506        /*   Procedure       procedure       procedure       procedure      */
      479    15507        /********************************************************************/
      480    15508    1   DEV_START$ = PINCRW(ADDR(LINK$DREC.LNK), SIZEW(LINK$DREC.LNK) );
      481    15509    1   DEV_SIZEW = LINK$DREC.NWINFO - POFFW(DEV_START$,ADDR(LINK$DREC.LNK));
      482    15510    1   DEV_STOP$ = PINCRW(DEV_START$, DEV_SIZEW);
      483    15511    1   ALL = %NO#;
      484    15512    1   WILD_CARD = %NO#;
      485    15513    1   IF LINKDEV$ = LINK$ THEN
      486    15514    1      LINKDEV$ = DEV_START$;
      487    15515    1   ELSE
      488    15516    1      LINKDEV$ = PINCRW (LINKDEV$, SIZEW(KL_LINKDEV));
      489    15517    2   IF LINKDEV$ >= DEV_STOP$ THEN DO;
      490    15518    2      LINKDEV$ = ADDR (NIL);
      491    15519    2      ALTRETURN ;
      492    15520    2      END;  /*  LINKDEV$ >= DEV_STOP$  */
      493    15521    1   IF NAME.TEXT = '?' THEN
      494    15522    1      ALL = %YES#;
      495    15523    2   ELSE DO;
      496    15524    2      CALL INDEX (I, '?', NAME.TEXT)
      497    15525    3      WHENRETURN DO;
      498    15526    3         WILD_CARD = %YES#;
      499    15527    3         END; /*  Whenreturn  */
      500    15528    2      END; /*  Else  */
      501    15529                                                  /* Find link device info. */
      502    15530    2   DO WHILE LINKDEV$ < DEV_STOP$;
      503    15531    3      IF KL$LINKDEV.BLKHDR.BLKTYP = %KLTY_LINKDEV# THEN DO;
      504    15532    4         IF WILD_CARD THEN DO;
      505    15533    4            CALL ASB$WILD_MATCH (8, KL$LINKDEV.LOGON#, 8, NAME.TEXT) ALTRET (LOOP_END);
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:73   
      506    15534    4            END;   /*  If WILD_CARD  */
      507    15535    3         ELSE IF NOT WILD_CARD AND NOT ALL THEN
      508    15536    3               IF KL$LINKDEV.LOGON# ~= NAME.TEXT THEN GOTO LOOP_END;
      509    15537    3         RETURN ;
      510    15538    3   LOOP_END:
      511    15539    3         LINKDEV$ = PINCRW (LINKDEV$, SIZEW (KL_LINKDEV));
      512    15540    3         END;  /*  Linkdev  */
      513    15541    2      ELSE
      514    15542    2         LINKDEV$ = PINCRW (LINKDEV$, SIZEW (KL_LNKVC));
      515    15543    2      END; /*  Do while LINKDEV$ < DEV_STOP$  */
      516    15544    1   LINKDEV$ = ADDR(NIL);
      517    15545    1   ALTRETURN ;
      518    15546    1   END ASL$FIND_LINKDEV;
      519    15547        %EOD;

PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:74   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$FIND_LINKDEV.

   Procedure ASL$FIND_LINKDEV requires 103 words for executable code.
   Procedure ASL$FIND_LINKDEV requires 18 words of local(AUTO) storage.

PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:75   

 Object Unit name= ASL$FIND_LINKDEV                           File name= ASL$LIST_LINK_DEVICES.:E05TOU
 UTS= JUL 29 '97 10:17:46.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     18     22  ASL$FIND_LINKDEV
    2   Proc  even  none   103    147  ASL$FIND_LINKDEV
    3  RoData even  none     2      2  ASL$FIND_LINKDEV

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        4  ASL$FIND_LINKDEV

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       4 ASB$WILD_MATCH
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:76   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     ERR_CODE                              REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          DSEG1$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:77   


      389        1        /*T***********************************************************/
      390        2        /*T*                                                         */
      391        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      392        4        /*T*                                                         */
      393        5        /*T***********************************************************/
      394        6        %EJECT;
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:78   
      395        7        /*M* ASL$FIND_LINKDEV: Routine to find link devices.*/
      396        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      397        9              ECU=3,CSU=3,SDI=3                                           */
      398       10        ASL$FIND_LINKDEV: PROC (LINK$, SIZE, NAME, LINKDEV$) ALTRET;

     10  2 000000   000000 700200 xent  ASL$FIND_LI* TSX0  ! X66_AUTO_4
         2 000001   000022 000004                    ZERO    18,4

      399       11        /**********************************************************/
      400       12
      401       13        /*D* NAME:     ASL$FIND_LINKDEV
      402       14             CALL:     CALL ASL$FIND_LINKDEV (LINK$, SIZE, NAME, LINKDEV$)
      403       15             INPUT:    LINK$  - Pointer to the link record in memory.
      404       16                       SIZE   - The size of the link record in words.
      405       17                       NAME   - The textc name of the sought link device.
      406       18             OUTPUT:   LINKDEV$  - Returned pointer to the link device found.
      407       19             DESCRIPTION:  ASL$FIND_LINKDEV is the routine to handle
      408       20                           the finding of link devices for the link in data
      409       21                           segment 1.  This routine will cycle through the
      410       22                           link devices and vircirs in data segment 1, matching the
      411       23                           link device names against NAME if necessary
      412       24                           and then returning with LINKDEV$ pointing at the
      413       25                           link device found or altreturning with LINKDEV$ set
      414       26                           to NIL.
      415       27        */
      416       28        /********************************************************************/
      417       29        /*   Include files   include files   include files   include files  */
      418       30        /********************************************************************/
      419       31        %INCLUDE AS_PERR_C;
      420      633        %INCLUDE AS_SUPER_C;
      421     1068        %INCLUDE AS_SUBS_C;
      422     2482        %INCLUDE AS_MAC_C;
      423     2562        %INCLUDE AS_ENTRIES_M;
      424     3612        %INCLUDE AS_SSUBS_C;
      425     3704        %INCLUDE B_ERRORS_C;
      426     4831        %INCLUDE CP_6_SUBS;
      427     5371        %INCLUDE KL_SUPER_C;
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:79   
      428     8273        %INCLUDE XU_MACRO_C;
      429    11379        %INCLUDE XU_FORMAT_C;
      430    11541        %INCLUDE AS_SUPER_R;
      431    14557        /********************************************************************/
      432    14558        /*   Parameters      parameters      parameters      parameters     */
      433    14559        /********************************************************************/
      434    14560    1   DCL LINK$                    PTR;
      435    14561    1   DCL LINKDEV$                 PTR;
      436    14562    1   DCL 1 NAME,
      437    14563    1          2 COUNT               UBIN BYTE UNAL,
      438    14564    1          2 TEXT                CHAR(8) CALIGNED;
      439    14565    1   DCL SIZE                     UBIN;
      440    14566        /********************************************************************/
      441    14567        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      442    14568        /********************************************************************/
      443    14569        %ASH$ERROR ;
      444    14572        %ASB$WILD_MATCH ;
      445    14575        /********************************************************************/
      446    14576        /*   Local based     local based     local based     local based    */
      447    14577        /********************************************************************/
      448    14578    1   DCL 1 TEXT$C BASED ALIGNED,
      449    14579    1          2 CNT                      UBIN(9) UNAL ,
      450    14580    1          2 TEXT                     CHAR(TEXT$C.CNT) UNAL;
      451    14581        %KL_DREC        ( NAME    = LINK$DREC,
      452    14582                          STCLASS = "BASED(DSEG1$)",
      453    14583                          LAST    = ",");
      454    14696        %KL_LNK         ( NAME    = LNK,
      455    14697                          LVL     = 2,
      456    14698                          STCLASS = BASED,
      457    14699                          LAST    = ";");
      458    14923        %KL_LINKDEV     ( NAME    = KL$LINKDEV,
      459    14924                          LVL     = 1,
      460    14925                          LAST    = ";",
      461    14926                          STCLASS = "BASED( LINKDEV$ )" );
      462    15097        /********************************************************************/
      463    15098        /*   Auto data       auto data       auto data       auto data      */
      464    15099        /********************************************************************/
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:80   
      465    15100    1   DCL ALL                      BIT(1);
      466    15101    1   DCL DEV_SIZEW                SBIN WORD ;
      467    15102    1   DCL DEV_START$               PTR ;
      468    15103    1   DCL DEV_STOP$                PTR ;
      469    15104    1   DCL I                        UBIN;
      470    15105    1   DCL TEMPVC                   CHAR(2);
      471    15106    1   DCL WILD_CARD                BIT(1);
      472    15107        /********************************************************************/
      473    15108        /*   Constant data   constant data   constant data   constant data  */
      474    15109        /********************************************************************/
      475    15110        %KL_LINKDEV  ( LVL = 1, STCLASS = CONSTANT );
      476    15281        %KL_LNKVC    ( LVL = 1, STCLASS = CONSTANT );
      477    15505        /********************************************************************/
      478    15506        /*   Procedure       procedure       procedure       procedure      */
      479    15507        /********************************************************************/
      480    15508    1   DEV_START$ = PINCRW(ADDR(LINK$DREC.LNK), SIZEW(LINK$DREC.LNK) );

  15508  2 000002   000000 236000 xsym               LDQ     DSEG1$
         2 000003   000034 036003                    ADLQ    28,DU
         2 000004   200011 756100                    STQ     DEV_START$,,AUTO

      481    15509    1   DEV_SIZEW = LINK$DREC.NWINFO - POFFW(DEV_START$,ADDR(LINK$DREC.LNK));

  15509  2 000005   000000 236000 xsym               LDQ     DSEG1$
         2 000006   000020 036003                    ADLQ    16,DU
         2 000007   000022 772000                    QRL     18
         2 000010   200016 756100                    STQ     WILD_CARD+1,,AUTO
         2 000011   200011 236100                    LDQ     DEV_START$,,AUTO
         2 000012   000022 772000                    QRL     18
         2 000013   200016 136100                    SBLQ    WILD_CARD+1,,AUTO
         2 000014   200017 756100                    STQ     WILD_CARD+2,,AUTO
         2 000015   000000 470400 xsym               LDP0    DSEG1$
         2 000016   000017 236100                    LDQ     15,,PR0
         2 000017   200017 136100                    SBLQ    WILD_CARD+2,,AUTO
         2 000020   200010 756100                    STQ     DEV_SIZEW,,AUTO

      482    15510    1   DEV_STOP$ = PINCRW(DEV_START$, DEV_SIZEW);
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:81   

  15510  2 000021   000022 736000                    QLS     18
         2 000022   200011 036100                    ADLQ    DEV_START$,,AUTO
         2 000023   200012 756100                    STQ     DEV_STOP$,,AUTO

      483    15511    1   ALL = %NO#;

  15511  2 000024   200007 450100                    STZ     ALL,,AUTO

      484    15512    1   WILD_CARD = %NO#;

  15512  2 000025   200015 450100                    STZ     WILD_CARD,,AUTO

      485    15513    1   IF LINKDEV$ = LINK$ THEN

  15513  2 000026   200006 471500                    LDP1    @LINKDEV$,,AUTO
         2 000027   200003 473500                    LDP3    @LINK$,,AUTO
         2 000030   100000 236100                    LDQ     0,,PR1
         2 000031   300000 116100                    CMPQ    0,,PR3
         2 000032   000036 601000 2                  TNZ     s:15516

      486    15514    1      LINKDEV$ = DEV_START$;

  15514  2 000033   200011 236100                    LDQ     DEV_START$,,AUTO
         2 000034   100000 756100                    STQ     0,,PR1
         2 000035   000040 710000 2                  TRA     s:15517

      487    15515    1   ELSE
      488    15516    1      LINKDEV$ = PINCRW (LINKDEV$, SIZEW(KL_LINKDEV));

  15516  2 000036   000006 036003                    ADLQ    6,DU
         2 000037   100000 756100                    STQ     0,,PR1

      489    15517    2   IF LINKDEV$ >= DEV_STOP$ THEN DO;

  15517  2 000040   200012 116100                    CMPQ    DEV_STOP$,,AUTO
         2 000041   000045 602000 2                  TNC     s:15521
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:82   

      490    15518    2      LINKDEV$ = ADDR (NIL);

  15518  2 000042   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000043   100000 756100                    STQ     0,,PR1

      491    15519    2      ALTRETURN ;

  15519  2 000044   000000 702200 xent               TSX2  ! X66_AALT

      492    15520    2      END;  /*  LINKDEV$ >= DEV_STOP$  */
      493    15521    1   IF NAME.TEXT = '?' THEN

  15521  2 000045   200005 470500                    LDP0    @NAME,,AUTO
         2 000046   040000 106500                    CMPC    fill='040'O
         2 000047   000000 200010                    ADSC9   0,,PR0                   cn=1,n=8
         2 000050   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000051   000055 601000 2                  TNZ     s:15524

      494    15522    1      ALL = %YES#;

  15522  2 000052   400000 236003                    LDQ     -131072,DU
         2 000053   200007 756100                    STQ     ALL,,AUTO
         2 000054   000064 710000 2                  TRA     s:15530

      495    15523    2   ELSE DO;

      496    15524    2      CALL INDEX (I, '?', NAME.TEXT)

  15524  2 000055   000000 124500                    SCM     mask='000'O
         2 000056   000000 200010                    ADSC9   0,,PR0                   cn=1,n=8
         2 000057   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000060   200013 000100                    ARG     I,,AUTO
         2 000061   000064 606400 2                  TTN     s:15530

      497    15525    3      WHENRETURN DO;

PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:83   
      498    15526    3         WILD_CARD = %YES#;

  15526  2 000062   400000 236003                    LDQ     -131072,DU
         2 000063   200015 756100                    STQ     WILD_CARD,,AUTO

      499    15527    3         END; /*  Whenreturn  */

      500    15528    2      END; /*  Else  */

      501    15529                                                  /* Find link device info. */
      502    15530    2   DO WHILE LINKDEV$ < DEV_STOP$;

  15530  2 000064   200006 470500                    LDP0    @LINKDEV$,,AUTO
         2 000065   000000 236100                    LDQ     0,,PR0
         2 000066   200012 116100                    CMPQ    DEV_STOP$,,AUTO
         2 000067   000144 603000 2                  TRC     s:15544

      503    15531    3      IF KL$LINKDEV.BLKHDR.BLKTYP = %KLTY_LINKDEV# THEN DO;

  15531  2 000070   200006 470500                    LDP0    @LINKDEV$,,AUTO
         2 000071   000000 471500                    LDP1    0,,PR0
         2 000072   000100 101500                    MRL     fill='000'O
         2 000073   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         2 000074   200016 000004                    ADSC9   WILD_CARD+1,,AUTO        cn=0,n=4
         2 000075   200016 236100                    LDQ     WILD_CARD+1,,AUTO
         2 000076   000013 116007                    CMPQ    11,DL
         2 000077   000137 601000 2                  TNZ     s:15542

      504    15532    4         IF WILD_CARD THEN DO;

  15532  2 000100   200015 234100                    SZN     WILD_CARD,,AUTO
         2 000101   000120 605000 2                  TPL     s:15535

      505    15533    4           CALL ASB$WILD_MATCH (8, KL$LINKDEV.LOGON#, 8, NAME.TEXT) ALTRET (LOOP_END);

  15533  2 000102   000000 471500                    LDP1    0,,PR0
         2 000103   200005 236100                    LDQ     @NAME,,AUTO
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:84   
         2 000104   200000 036007                    ADLQ    65536,DL
         2 000105   000001 235000 3                  LDA     1
         2 000106   200020 757100                    STAQ    WILD_CARD+3,,AUTO
         2 000107   100004 633500                    EPPR3   4,,PR1
         2 000110   200017 453500                    STP3    WILD_CARD+2,,AUTO
         2 000111   000001 236000 3                  LDQ     1
         2 000112   200016 756100                    STQ     WILD_CARD+1,,AUTO
         2 000113   200016 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000114   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000115   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000116   000132 702000 2                  TSX2    LOOP_END

      506    15534    4            END;   /*  If WILD_CARD  */

  15534  2 000117   000131 710000 2                  TRA     s:15537

      507    15535    3         ELSE IF NOT WILD_CARD AND NOT ALL THEN

  15535  2 000120   000131 604000 2                  TMI     s:15537
         2 000121   200007 234100                    SZN     ALL,,AUTO
         2 000122   000131 604000 2                  TMI     s:15537

      508    15536    3               IF KL$LINKDEV.LOGON# ~= NAME.TEXT THEN GOTO LOOP_END;

  15536  2 000123   000000 471500                    LDP1    0,,PR0
         2 000124   200005 473500                    LDP3    @NAME,,AUTO
         2 000125   040100 106500                    CMPC    fill='040'O
         2 000126   100004 000010                    ADSC9   4,,PR1                   cn=0,n=8
         2 000127   300000 200010                    ADSC9   0,,PR3                   cn=1,n=8
         2 000130   000132 601000 2                  TNZ     LOOP_END

      509    15537    3         RETURN ;

  15537  2 000131   000000 702200 xent               TSX2  ! X66_ARET

      510    15538    3   LOOP_END:
      511    15539    3         LINKDEV$ = PINCRW (LINKDEV$, SIZEW (KL_LINKDEV));
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:85   

  15539  2 000132   200006 470500       LOOP_END     LDP0    @LINKDEV$,,AUTO
         2 000133   000000 236100                    LDQ     0,,PR0
         2 000134   000006 036003                    ADLQ    6,DU
         2 000135   000000 756100                    STQ     0,,PR0

      512    15540    3         END;  /*  Linkdev  */

  15540  2 000136   000142 710000 2                  TRA     s:15543

      513    15541    2      ELSE
      514    15542    2         LINKDEV$ = PINCRW (LINKDEV$, SIZEW (KL_LNKVC));

  15542  2 000137   000000 236100                    LDQ     0,,PR0
         2 000140   000014 036003                    ADLQ    12,DU
         2 000141   000000 756100                    STQ     0,,PR0

      515    15543    2      END; /*  Do while LINKDEV$ < DEV_STOP$  */

  15543  2 000142   200012 116100                    CMPQ    DEV_STOP$,,AUTO
         2 000143   000070 602000 2                  TNC     s:15531

      516    15544    1   LINKDEV$ = ADDR(NIL);

  15544  2 000144   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000145   000000 756100                    STQ     0,,PR0

      517    15545    1   ALTRETURN ;

  15545  2 000146   000000 702200 xent               TSX2  ! X66_AALT
      518    15546    1   END ASL$FIND_LINKDEV;
      519    15547        %EOD;

PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:86   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$FIND_LINKDEV.
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:87   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$FIND_LINKDEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(216)   r     1 KL_LINKDEV                 6-0-0/w STRC(432)   r     1 KL_LNKVC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @LINK$                     6-0-0/w PTR         r     1 @LINKDEV$
     5-0-0/w PTR         r     1 @NAME                      4-0-0/w PTR         r     1 @SIZE
     7-0-0/b BIT         r     1 ALL                       10-0-0/w SBIN        r     1 DEV_SIZEW
    11-0-0/w PTR         r     1 DEV_START$                12-0-0/w PTR         r     1 DEV_STOP$
    13-0-0/w UBIN        r     1 I                         *0-0-0/w PTR         r     1 LINK$
    *0-0-0/w PTR         r     1 LINKDEV$                  *0-0-0/c STRC(81)    r     1 NAME
    *0-0-0/w UBIN        r     1 SIZE                      15-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DSEG1$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(216)   r     1 KL$LINKDEV                 0-0-0/w STRC(1008)  r     1 LINK$DREC
     0-0-0/w ASTR(9)     r     1 TEXT$C

PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:88   

   Procedure ASL$FIND_LINKDEV requires 103 words for executable code.
   Procedure ASL$FIND_LINKDEV requires 18 words of local(AUTO) storage.
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:89   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:90   
          MINI XREF LISTING

ALL
     15100**DCL     15511<<ASSIGN  15522<<ASSIGN  15535>>IF
ASA_BRKS_LOC
     11705**DCL     11705--REDEF
ASB$WILD_MATCH
     14573**DCL-ENT 15533--CALL
AS_DEFAULT.BANNER_PERM
     12398**DCL     12399--REDEF
AS_DEFAULT.BUDGET.MACCT
     12303**DCL     12307--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12316**DCL     12319--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12299**DCL     12301--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12294**DCL     12296--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12414**DCL     12415--REDEF   12416--REDEF
AS_DEFAULT_DREC.PASSWORD
     13668**DCL     13672--REDEF
AS_DEFAULT_DREC.RENAME
     13691**DCL     13692--REDEF
AS_DFLT.BANNER_PERM
     12220**DCL     12221--REDEF
AS_DFLT.BUDGET.MACCT
     12125**DCL     12129--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12138**DCL     12141--REDEF
AS_DFLT.BUDGET.PACCUM
     12121**DCL     12123--REDEF
AS_DFLT.BUDGET.PMAXC
     12116**DCL     12118--REDEF
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:91   
AS_DFLT.SETUP_CHRA.TXT
     12236**DCL     12237--REDEF   12238--REDEF
AS_FE_MODE
     11571**DCL     11572--REDEF
AS_MODE
     11568**DCL     11570--REDEF
AS_MOD_USER.ACCESS
     14433**DCL     14434--REDEF
AS_MOD_USER.BANNER
     14420**DCL     14421--REDEF
AS_MOD_USER.BANNER_PERM
     14422**DCL     14423--REDEF
AS_MOD_USER.BILL
     14428**DCL     14429--REDEF
AS_MOD_USER.CPROC
     14424**DCL     14425--REDEF
AS_MOD_USER.FEBILL
     14504**DCL     14505--REDEF
AS_MOD_USER.FECXTMEM
     14521**DCL     14522--REDEF
AS_MOD_USER.FEMINTS
     14506**DCL     14507--REDEF
AS_MOD_USER.FEMMEM
     14517**DCL     14518--REDEF
AS_MOD_USER.FEMTIME
     14515**DCL     14516--REDEF
AS_MOD_USER.FEPPRIV
     14512**DCL     14514--REDEF
AS_MOD_USER.FEPRIV
     14509**DCL     14511--REDEF
AS_MOD_USER.FORCE_BIT
     14418**DCL     14419--REDEF
AS_MOD_USER.KEY
     14500**DCL     14502--REDEF
AS_MOD_USER.LASTCPROC
     14426**DCL     14427--REDEF
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:92   
AS_MOD_USER.LIMITS.DO_
     14474**DCL     14475--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14490**DCL     14491--REDEF
AS_MOD_USER.LIMITS.LO
     14470**DCL     14471--REDEF
AS_MOD_USER.LIMITS.MEM
     14466**DCL     14467--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14494**DCL     14495--REDEF
AS_MOD_USER.LIMITS.PDIS
     14482**DCL     14483--REDEF
AS_MOD_USER.LIMITS.PO
     14478**DCL     14479--REDEF
AS_MOD_USER.LIMITS.TDIS
     14486**DCL     14487--REDEF
AS_MOD_USER.LIMITS.TIME
     14462**DCL     14463--REDEF
AS_MOD_USER.MAXENQ
     14443**DCL     14444--REDEF
AS_MOD_USER.PERM_BIT
     14416**DCL     14417--REDEF
AS_MOD_USER.PPRIV
     14438**DCL     14440--REDEF
AS_MOD_USER.PRIOB
     14445**DCL     14446--REDEF
AS_MOD_USER.PRIV
     14435**DCL     14437--REDEF
AS_MOD_USER.QUAN
     14441**DCL     14442--REDEF
AS_MOD_USER.SETUP
     14414**DCL     14415--REDEF
AS_PROJECT.BANNER_PERM
     12754**DCL     12755--REDEF
AS_PROJECT.BUDGET.MACCT
     12659**DCL     12663--REDEF
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:93   
AS_PROJECT.BUDGET.MAX_PROJECTS
     12672**DCL     12675--REDEF
AS_PROJECT.BUDGET.PACCUM
     12655**DCL     12657--REDEF
AS_PROJECT.BUDGET.PMAXC
     12650**DCL     12652--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12770**DCL     12771--REDEF   12772--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12932**DCL     12933--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12837**DCL     12841--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12850**DCL     12853--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12833**DCL     12835--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12828**DCL     12830--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12948**DCL     12949--REDEF   12950--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     14154**DCL     14158--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     14177**DCL     14178--REDEF
AS_PROJECT_DREC.PASSWORD
     13992**DCL     13996--REDEF
AS_PROJECT_DREC.RENAME
     14015**DCL     14016--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12576**DCL     12577--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12481**DCL     12485--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12494**DCL     12497--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12477**DCL     12479--REDEF
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:94   
AS_PROJ_ADMIN.BUDGET.PMAXC
     12472**DCL     12474--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12592**DCL     12593--REDEF   12594--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13830**DCL     13834--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13853**DCL     13854--REDEF
AS_USERS.BANNER_PERM
     12042**DCL     12043--REDEF
AS_USERS.BUDGET.MACCT
     11947**DCL     11951--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11960**DCL     11963--REDEF
AS_USERS.BUDGET.PACCUM
     11943**DCL     11945--REDEF
AS_USERS.BUDGET.PMAXC
     11938**DCL     11940--REDEF
AS_USERS.SETUP_CHRA.TXT
     12058**DCL     12059--REDEF   12060--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13110**DCL     13111--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     13015**DCL     13019--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13028**DCL     13031--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13011**DCL     13013--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13006**DCL     13008--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13126**DCL     13127--REDEF   13128--REDEF
DEV_SIZEW
     15101**DCL     15509<<ASSIGN  15510>>ASSIGN
DEV_START$
     15102**DCL     15508<<ASSIGN  15509>>ASSIGN  15510>>ASSIGN  15514>>ASSIGN
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:95   
DEV_STOP$
     15103**DCL     15510<<ASSIGN  15517>>IF      15530>>DOWHILE
DSEG1$
     11706**DCL     14596--IMP-PTR 15508>>ASSIGN  15509>>ASSIGN  15509>>ASSIGN
ERR_CODE
     11700**DCL     11701--REDEF
I
     15104**DCL     15524<<CALLBLT
KL$LINKDEV.BLKHDR.BLKTYP
     15005**DCL     15531>>IF
KL$LINKDEV.LOGON#
     15095**DCL     15533<>CALL    15536>>IF
KL_DEFAULT.PASSWORD
     14316**DCL     14320--REDEF
KL_DEFAULT.RENAME
     14339**DCL     14340--REDEF
KL_DFLT.PASSWORD
     13506**DCL     13510--REDEF
KL_DFLT.RENAME
     13529**DCL     13530--REDEF
KL_DREC.PASSWORD
     13344**DCL     13348--REDEF
KL_DREC.RENAME
     13367**DCL     13368--REDEF
KL_DREC_CNT.PASSWORD
     13231**DCL     13235--REDEF
KL_DREC_CNT.RENAME
     13254**DCL     13255--REDEF
KL_LINKDEV
     15127**DCL     15516--ASSIGN  15539--ASSIGN
KL_LNKVC
     15296**DCL     15542--ASSIGN
KL_LNKVC.CUG
     15395**DCL     15439--REDEF
LINK$
     14560**DCL        10--PROC    15513>>IF
PL6.E3A0      #002=ASL$FIND_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI           TUE 07/29/97 10:17 Page:96   
LINK$DREC.LNK
     14718**DCL     15508--ASSIGN  15508--ASSIGN  15509--ASSIGN
LINK$DREC.NWINFO
     14694**DCL     15509>>ASSIGN
LINK$DREC.PASSWORD
     14654**DCL     14658--REDEF
LINK$DREC.RENAME
     14677**DCL     14678--REDEF
LINKDEV$
     14561**DCL        10--PROC    14943--IMP-PTR 15513>>IF      15514<<ASSIGN  15516<<ASSIGN  15516>>ASSIGN
     15517>>IF      15518<<ASSIGN  15530>>DOWHILE 15531>>IF      15533>>CALL    15536>>IF      15539<<ASSIGN
     15539>>ASSIGN  15542<<ASSIGN  15542>>ASSIGN  15544<<ASSIGN
LOOP_END
     15539**LABEL   15533--CALLALT 15536--GOTO
NAME
     14562**DCL        10--PROC
NAME.TEXT
     14564**DCL     15521>>IF      15524>>CALLBLT 15533<>CALL    15536>>IF
PROJ_KEY.TEXT
     11578**DCL     11578--REDEF
PROJ_KEY.TXT.PROJECT
     11578**DCL     11578--REDEF
REMEM_VAR
     11704**DCL     11704--REDEF
REM_FCMD
     11704**DCL     11705--REDEF
SIZE
     14565**DCL        10--PROC
TEXT$C.CNT
     14579**DCL     14580--IMP-SIZ
USERS_KEY.TEXT
     11575**DCL     11576--REDEF   11576--REDEF   11576--REDEF   11577--REDEF
WILD_CARD
     15106**DCL     15512<<ASSIGN  15526<<ASSIGN  15532>>IF      15535>>IF

PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:97   
      520        1        /*T***********************************************************/
      521        2        /*T*                                                         */
      522        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      523        4        /*T*                                                         */
      524        5        /*T***********************************************************/
      525        6        %EJECT;
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:98   
      526        7        ASL$DISP_ONE_LINKDEV: PROC (LINKDEV$, NEW_LINK, JCL, LINK_NAME);
      527        8        /**********************************************************/
      528        9
      529       10        /*D* NAME:     ASL$DISP_ONE_LINKDEV
      530       11             CALL:     CALL ASL$DISP_ONE_LINKDEV ( LINKDEV$, JCL)
      531       12             INPUT:    LINKDEV$ - Pointer to a kl_controller structure.
      532       13                       NEW_LINK - bit set for header display.
      533       14                       JCL    - bit set for JCL type display.
      534       15                       LINK_NAME - The name of the link to which the
      535       16                                   current linkdevice belongs.
      536       17             OUTPUT:   Nothing is returned.
      537       18             DESCRIPTION:  ASL$DISP_ONE_LINKDEV is the routine to handle
      538       19                           the list/display of a link device pointed at by
      539       20                           LINKDEV$.  The output from this routine will
      540       21                           depend upon the setting of the JCL flag.
      541       22        */
      542       23        /********************************************************************/
      543       24        /*   Include files   include files   include files   include files  */
      544       25        /********************************************************************/
      545       26        %INCLUDE AS_PERR_C;
      546      628        %INCLUDE AS_SUPER_C;
      547     1063        %INCLUDE AS_SUBS_C;
      548     2477        %INCLUDE AS_MAC_C;
      549     2557        %INCLUDE AS_ENTRIES_M;
      550     3607        %INCLUDE AS_SSUBS_C;
      551     3699        %INCLUDE B_ERRORS_C;
      552     4826        %INCLUDE KL_SUPER_C;
      553     7728        %INCLUDE XU_MACRO_C;
      554    10834        %INCLUDE XU_FORMAT_C;
      555    10996        %INCLUDE AS_SUPER_R;
      556    14012        /********************************************************************/
      557    14013        /*   Parameters      parameters      parameters      parameters     */
      558    14014        /********************************************************************/
      559    14015    1   DCL JCL                      BIT(1);
      560    14016    1   DCL LINKDEV$                 PTR;
      561    14017    1   DCL LINK_NAME                CHAR(8);
      562    14018    1   DCL NEW_LINK                 BIT(1);
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:99   
      563    14019        /********************************************************************/
      564    14020        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      565    14021        /********************************************************************/
      566    14022    1   DCL X$FORMAT ENTRY(1) ;
      567    14023        %ASB$WRITE_LO ;
      568    14026        /********************************************************************/
      569    14027        /*   Local based     local based     local based     local based    */
      570    14028        /********************************************************************/
      571    14029        %KL_DREC     ( NAME      = LINK$DREC,
      572    14030                       STCLASS   = "BASED(DSEG1$)",
      573    14031                       LAST      = ",");
      574    14144        %KL_LNK      ( NAME      = LNK,
      575    14145                       LVL       = 2,
      576    14146                       STCLASS   = BASED,
      577    14147                       LAST      = ";");
      578    14371        %KL_LINKDEV  ( NAME      = KL$LINKDEV,
      579    14372                       LVL       = 1,
      580    14373                       LAST      = ";",
      581    14374                       STCLASS   = "BASED( LINKDEV$ )" );
      582    14545        %KL$UBWORD   ( NAME      = KL_UBWORD,
      583    14546                       STCLASS   = AUTO );
      584    14556    1   DCL 1 TEXT$C BASED ALIGNED,
      585    14557    1          2 CNT               UBIN(9) UNAL ,
      586    14558    1          2 TEXT              CHAR(TEXT$C.CNT) UNAL;
      587    14559        /********************************************************************/
      588    14560        /*   Auto data       auto data       auto data       auto data      */
      589    14561        /********************************************************************/
      590    14562    1   DCL ADDRESS(0:13)            CHAR(1) ;
      591    14563    1   DCL ADDR1(0:3)               CHAR(1) ;
      592    14564    1   DCL J                        SBIN WORD ;
      593    14565    1   DCL TEMP_NUMB                UBIN STATIC;
      594    14566    1   DCL VAL                      SBIN ;
      595    14567        /********************************************************************/
      596    14568        /*   Constant data   constant data   constant data   constant data  */
      597    14569        /********************************************************************/
      598    14570    1   DCL BLANK_STR                CHAR(0) CONSTANT INIT (' ');
      599    14571    1   DCL FIXED_STR                CHAR(0) CONSTANT INIT ('FIXED');
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:100  
      600    14572    1   DCL INCOMING_STR             CHAR(0) CONSTANT INIT ('INCOMING');
      601    14573    1   DCL OUTGOING_STR             CHAR(0) CONSTANT INIT ('OUTGOING');
      602    14574    1   DCL LINKDEV_HDR              CHAR(0) CONSTANT INIT
      603    14575    1   ('  NAME      CIRCUITS  PROTOCOL  SUBADDR            MODE' ) ;
      604    14576    1   DCL LINKDEV_FMT              CHAR(0) CONSTANT INIT
      605    14577    1   ('%3-%A%15-%4D%25-%3D%35-%2D%51-%>A');
      606    14578    1   DCL LINKDEV_JCL_CMD          CHAR(0) CONSTANT INIT
      607    14579    1   ('CREATE DEVICE %>A FOR LINK %>A' ) ;
      608    14580    1   DCL LINKDEV_OPT_JCL_FMT      CHAR(0) CONSTANT INIT
      609    14581    1   ('CIRCUITS = %D;     PROTOCOL = %D;    SUBADDR = %D;   MODE = %>A' ) ;
      610    14582        %KL_LINKDEV     ( LVL = 1, STCLASS = CONSTANT );
      611    14753        /********************************************************************/
      612    14754        /*   Procedure       procedure       procedure       procedure      */
      613    14755        /********************************************************************/
      614    14756    2   IF JCL THEN DO;
      615    14757                                         /* List virtual circuit jcl info. */
      616    14758    2      FMT_BUF = LINKDEV_JCL_CMD;
      617    14759    2      FDS.FMT_.BOUND = SIZEV(LINKDEV_JCL_CMD);
      618    14760    2      FDS.NVECS# = 2;
      619    14761    2      FMT_VEC(0) = VECTOR ( LINKDEV$ -> KL$LINKDEV.LOGON# );
      620    14762    2      FMT_VEC(1) = VECTOR ( LINK_NAME );
      621    14763    2      CALL X$FORMAT( FDS );
      622    14764    2      FMT_BUF = LINKDEV_OPT_JCL_FMT;
      623    14765    2      FDS.FMT_.BOUND = SIZEV(LINKDEV_OPT_JCL_FMT);
      624    14766    2      FDS.NVECS# = 4;
      625    14767    2      FMT_VEC(0) = VECTOR( LINKDEV$->KL$LINKDEV.CIRCUITS# );
      626    14768    2      FMT_VEC(1) = VECTOR( LINKDEV$->KL$LINKDEV.PROTOCOL# );
      627    14769    2      FMT_VEC(2) = VECTOR( LINKDEV$->KL$LINKDEV.SUBADDR# );
      628    14770
      629    14771    3      DO SELECT ( LINKDEV$ -> KL$LINKDEV.MODE );
      630    14772
      631    14773    3         SELECT ( %KL_DEVMODE_INCOMING# );
      632    14774
      633    14775    3         FMT_VEC(3) = VECTOR( INCOMING_STR );
      634    14776
      635    14777    3         SELECT ( %KL_DEVMODE_OUTGOING# );
      636    14778
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:101  
      637    14779    3         FMT_VEC(3) = VECTOR( OUTGOING_STR );
      638    14780
      639    14781    3         SELECT ( %KL_DEVMODE_FIXED# );
      640    14782
      641    14783    3         FMT_VEC(3) = VECTOR( FIXED_STR );
      642    14784
      643    14785    3         SELECT ( ELSE );
      644    14786
      645    14787    3      FMT_VEC(3) = VECTOR( BLANK_STR );
      646    14788
      647    14789    3         END;  /*  Do case on .MODE  */
      648    14790    2   CALL X$FORMAT( FDS );
      649    14791    2   CALL ASB$WRITE_LO ('   END',6);
      650    14792    2      END;  /*  Jcl  */
      651    14793    2   ELSE DO;  /*  Not jcl  */
      652    14794                                                  /* List virtual circuit info. */
      653    14795    3      IF NEW_LINK THEN DO;
      654    14796    3         CALL ASB$WRITE_LO( AS_BLANK, 1 );
      655    14797    3         CALL ASB$WRITE_LO( LINKDEV_HDR, LENGTHC(LINKDEV_HDR) );
      656    14798    3         END; /* New link  */
      657    14799    2      FMT_BUF = LINKDEV_FMT;
      658    14800    2      FDS.FMT_.BOUND = SIZEV(LINKDEV_FMT);
      659    14801    2      FDS.NVECS# = 5;
      660    14802    2      FMT_VEC(0) = VECTOR( LINKDEV$ -> KL$LINKDEV.LOGON# );
      661    14803    2      FMT_VEC(1) = VECTOR( LINKDEV$->KL$LINKDEV.CIRCUITS# );
      662    14804    2      FMT_VEC(2) = VECTOR( LINKDEV$->KL$LINKDEV.PROTOCOL# );
      663    14805    2      FMT_VEC(3) = VECTOR( LINKDEV$->KL$LINKDEV.SUBADDR# );
      664    14806
      665    14807    3      DO SELECT ( LINKDEV$ -> KL$LINKDEV.MODE );
      666    14808
      667    14809    3         SELECT ( %KL_DEVMODE_INCOMING# );
      668    14810
      669    14811    3         FMT_VEC(4) = VECTOR( INCOMING_STR );
      670    14812
      671    14813    3         SELECT ( %KL_DEVMODE_OUTGOING# );
      672    14814
      673    14815    3         FMT_VEC(4) = VECTOR( OUTGOING_STR );
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:102  
      674    14816
      675    14817    3         SELECT ( %KL_DEVMODE_FIXED# );
      676    14818
      677    14819    3         FMT_VEC(4) = VECTOR( FIXED_STR );
      678    14820
      679    14821    3         SELECT ( ELSE );
      680    14822
      681    14823    3      FMT_VEC(4) = VECTOR( BLANK_STR );
      682    14824
      683    14825    3         END;  /*  Do case on .MODE  */
      684    14826    2   CALL X$FORMAT( FDS );
      685    14827    2      END;   /*  Not jcl  */
      686    14828    1   FDS.NVECS# = 0; /* reset # vectors in format structure */
      687    14829    1   RETURN;
      688    14830
      689    14831    1   END ASL$DISP_ONE_LINKDEV;

PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:103  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_LINKDEV.

   Procedure ASL$DISP_ONE_LINKDEV requires 203 words for executable code.
   Procedure ASL$DISP_ONE_LINKDEV requires 20 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_LINK_DEVICES.:E05TSI    .

PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:104  

 Object Unit name= ASL$DISP_ONE_LINKDEV                       File name= ASL$LIST_LINK_DEVICES.:E05TOU
 UTS= JUL 29 '97 10:19:08.60 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   Data  even  none     1      1  ASL$DISP_ONE_LINKDEV
    2  RoData even  UTS     62     76  ASL$DISP_ONE_LINKDEV
    3   Proc  even  none   203    313  ASL$DISP_ONE_LINKDEV
    4  RoData even  none    21     25  ASL$DISP_ONE_LINKDEV

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        4  ASL$DISP_ONE_LINKDEV

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$WRITE_LO
         yes           Std       1 X$FORMAT
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:105  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  FDS                                   FMT_BUF
     FMT_VEC                               ERR_CODE                              REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:106  


      520        1        /*T***********************************************************/
      521        2        /*T*                                                         */
      522        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      523        4        /*T*                                                         */
      524        5        /*T***********************************************************/
      525        6        %EJECT;
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:107  
      526        7        ASL$DISP_ONE_LINKDEV: PROC (LINKDEV$, NEW_LINK, JCL, LINK_NAME);

      7  3 000000   000000 700200 xent  ASL$DISP_ON* TSX0  ! X66_AUTO_4
         3 000001   000024 000004                    ZERO    20,4

      527        8        /**********************************************************/
      528        9
      529       10        /*D* NAME:     ASL$DISP_ONE_LINKDEV
      530       11             CALL:     CALL ASL$DISP_ONE_LINKDEV ( LINKDEV$, JCL)
      531       12             INPUT:    LINKDEV$ - Pointer to a kl_controller structure.
      532       13                       NEW_LINK - bit set for header display.
      533       14                       JCL    - bit set for JCL type display.
      534       15                       LINK_NAME - The name of the link to which the
      535       16                                   current linkdevice belongs.
      536       17             OUTPUT:   Nothing is returned.
      537       18             DESCRIPTION:  ASL$DISP_ONE_LINKDEV is the routine to handle
      538       19                           the list/display of a link device pointed at by
      539       20                           LINKDEV$.  The output from this routine will
      540       21                           depend upon the setting of the JCL flag.
      541       22        */
      542       23        /********************************************************************/
      543       24        /*   Include files   include files   include files   include files  */
      544       25        /********************************************************************/
      545       26        %INCLUDE AS_PERR_C;
      546      628        %INCLUDE AS_SUPER_C;
      547     1063        %INCLUDE AS_SUBS_C;
      548     2477        %INCLUDE AS_MAC_C;
      549     2557        %INCLUDE AS_ENTRIES_M;
      550     3607        %INCLUDE AS_SSUBS_C;
      551     3699        %INCLUDE B_ERRORS_C;
      552     4826        %INCLUDE KL_SUPER_C;
      553     7728        %INCLUDE XU_MACRO_C;
      554    10834        %INCLUDE XU_FORMAT_C;
      555    10996        %INCLUDE AS_SUPER_R;
      556    14012        /********************************************************************/
      557    14013        /*   Parameters      parameters      parameters      parameters     */
      558    14014        /********************************************************************/
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:108  
      559    14015    1   DCL JCL                      BIT(1);
      560    14016    1   DCL LINKDEV$                 PTR;
      561    14017    1   DCL LINK_NAME                CHAR(8);
      562    14018    1   DCL NEW_LINK                 BIT(1);
      563    14019        /********************************************************************/
      564    14020        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      565    14021        /********************************************************************/
      566    14022    1   DCL X$FORMAT ENTRY(1) ;
      567    14023        %ASB$WRITE_LO ;
      568    14026        /********************************************************************/
      569    14027        /*   Local based     local based     local based     local based    */
      570    14028        /********************************************************************/
      571    14029        %KL_DREC     ( NAME      = LINK$DREC,
      572    14030                       STCLASS   = "BASED(DSEG1$)",
      573    14031                       LAST      = ",");
      574    14144        %KL_LNK      ( NAME      = LNK,
      575    14145                       LVL       = 2,
      576    14146                       STCLASS   = BASED,
      577    14147                       LAST      = ";");
      578    14371        %KL_LINKDEV  ( NAME      = KL$LINKDEV,
      579    14372                       LVL       = 1,
      580    14373                       LAST      = ";",
      581    14374                       STCLASS   = "BASED( LINKDEV$ )" );
      582    14545        %KL$UBWORD   ( NAME      = KL_UBWORD,
      583    14546                       STCLASS   = AUTO );
      584    14556    1   DCL 1 TEXT$C BASED ALIGNED,
      585    14557    1          2 CNT               UBIN(9) UNAL ,
      586    14558    1          2 TEXT              CHAR(TEXT$C.CNT) UNAL;
      587    14559        /********************************************************************/
      588    14560        /*   Auto data       auto data       auto data       auto data      */
      589    14561        /********************************************************************/
      590    14562    1   DCL ADDRESS(0:13)            CHAR(1) ;
      591    14563    1   DCL ADDR1(0:3)               CHAR(1) ;
      592    14564    1   DCL J                        SBIN WORD ;
      593    14565    1   DCL TEMP_NUMB                UBIN STATIC;
      594    14566    1   DCL VAL                      SBIN ;
      595    14567        /********************************************************************/
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:109  
      596    14568        /*   Constant data   constant data   constant data   constant data  */
      597    14569        /********************************************************************/
      598    14570    1   DCL BLANK_STR                CHAR(0) CONSTANT INIT (' ');
      599    14571    1   DCL FIXED_STR                CHAR(0) CONSTANT INIT ('FIXED');
      600    14572    1   DCL INCOMING_STR             CHAR(0) CONSTANT INIT ('INCOMING');
      601    14573    1   DCL OUTGOING_STR             CHAR(0) CONSTANT INIT ('OUTGOING');
      602    14574    1   DCL LINKDEV_HDR              CHAR(0) CONSTANT INIT
      603    14575    1   ('  NAME      CIRCUITS  PROTOCOL  SUBADDR            MODE' ) ;
      604    14576    1   DCL LINKDEV_FMT              CHAR(0) CONSTANT INIT
      605    14577    1   ('%3-%A%15-%4D%25-%3D%35-%2D%51-%>A');
      606    14578    1   DCL LINKDEV_JCL_CMD          CHAR(0) CONSTANT INIT
      607    14579    1   ('CREATE DEVICE %>A FOR LINK %>A' ) ;
      608    14580    1   DCL LINKDEV_OPT_JCL_FMT      CHAR(0) CONSTANT INIT
      609    14581    1   ('CIRCUITS = %D;     PROTOCOL = %D;    SUBADDR = %D;   MODE = %>A' ) ;
      610    14582        %KL_LINKDEV     ( LVL = 1, STCLASS = CONSTANT );
      611    14753        /********************************************************************/
      612    14754        /*   Procedure       procedure       procedure       procedure      */
      613    14755        /********************************************************************/
      614    14756    2   IF JCL THEN DO;

  14756  3 000002   200005 470500                    LDP0    @JCL,,AUTO
         3 000003   000000 066500                    CMPB    filb='0'B
         3 000004   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         3 000005   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000006   000155 600000 3                  TZE     s:14795

      615    14757                                         /* List virtual circuit jcl info. */
      616    14758    2      FMT_BUF = LINKDEV_JCL_CMD;

  14758  3 000007   040000 100400                    MLR     fill='040'O
         3 000010   000036 000036 2                  ADSC9   LINKDEV_JCL_CMD          cn=0,n=30
         3 000011   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      617    14759    2      FDS.FMT_.BOUND = SIZEV(LINKDEV_JCL_CMD);

  14759  3 000012   000000 236000 xsym               LDQ     FDS
         3 000013   177777 376007                    ANQ     65535,DL
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:110  
         3 000014   000000 276000 4                  ORQ     0
         3 000015   000000 756000 xsym               STQ     FDS

      618    14760    2      FDS.NVECS# = 2;

  14760  3 000016   000002 235007                    LDA     2,DL
         3 000017   000011 755000 xsym               STA     FDS+9

      619    14761    2      FMT_VEC(0) = VECTOR ( LINKDEV$ -> KL$LINKDEV.LOGON# );

  14761  3 000020   200003 471500                    LDP1    @LINKDEV$,,AUTO
         3 000021   100000 473500                    LDP3    0,,PR1
         3 000022   000001 235000 4                  LDA     1
         3 000023   200020 453500                    STP3    @LINK_NAME+10,,AUTO
         3 000024   200020 236100                    LDQ     @LINK_NAME+10,,AUTO
         3 000025   000004 036003                    ADLQ    4,DU
         3 000026   000000 755000 xsym               STA     FMT_VEC
         3 000027   000001 756000 xsym               STQ     FMT_VEC+1

      620    14762    2      FMT_VEC(1) = VECTOR ( LINK_NAME );

  14762  3 000030   000001 235000 4                  LDA     1
         3 000031   200006 236100                    LDQ     @LINK_NAME,,AUTO
         3 000032   000002 755000 xsym               STA     FMT_VEC+2
         3 000033   000003 756000 xsym               STQ     FMT_VEC+3

      621    14763    2      CALL X$FORMAT( FDS );

  14763  3 000034   000002 630400 4                  EPPR0   2
         3 000035   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000036   000000 701000 xent               TSX1    X$FORMAT
         3 000037   000000 011000                    NOP     0

      622    14764    2      FMT_BUF = LINKDEV_OPT_JCL_FMT;

  14764  3 000040   040000 100400                    MLR     fill='040'O
         3 000041   000046 000077 2                  ADSC9   LINKDEV_OPT_JCL_FMT      cn=0,n=63
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:111  
         3 000042   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      623    14765    2      FDS.FMT_.BOUND = SIZEV(LINKDEV_OPT_JCL_FMT);

  14765  3 000043   000000 236000 xsym               LDQ     FDS
         3 000044   177777 376007                    ANQ     65535,DL
         3 000045   000003 276000 4                  ORQ     3
         3 000046   000000 756000 xsym               STQ     FDS

      624    14766    2      FDS.NVECS# = 4;

  14766  3 000047   000004 235007                    LDA     4,DL
         3 000050   000011 755000 xsym               STA     FDS+9

      625    14767    2      FMT_VEC(0) = VECTOR( LINKDEV$->KL$LINKDEV.CIRCUITS# );

  14767  3 000051   200003 470500                    LDP0    @LINKDEV$,,AUTO
         3 000052   000000 471500                    LDP1    0,,PR0
         3 000053   377640 235007                    LDA     130976,DL
         3 000054   200020 451500                    STP1    @LINK_NAME+10,,AUTO
         3 000055   200020 236100                    LDQ     @LINK_NAME+10,,AUTO
         3 000056   000002 036003                    ADLQ    2,DU
         3 000057   000000 755000 xsym               STA     FMT_VEC
         3 000060   000001 756000 xsym               STQ     FMT_VEC+1

      626    14768    2      FMT_VEC(1) = VECTOR( LINKDEV$->KL$LINKDEV.PROTOCOL# );

  14768  3 000061   000000 471500                    LDP1    0,,PR0
         3 000062   177640 235007                    LDA     65440,DL
         3 000063   200020 451500                    STP1    @LINK_NAME+10,,AUTO
         3 000064   200020 236100                    LDQ     @LINK_NAME+10,,AUTO
         3 000065   000004 036000 4                  ADLQ    4
         3 000066   000002 755000 xsym               STA     FMT_VEC+2
         3 000067   000003 756000 xsym               STQ     FMT_VEC+3

      627    14769    2      FMT_VEC(2) = VECTOR( LINKDEV$->KL$LINKDEV.SUBADDR# );

PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:112  
  14769  3 000070   000000 471500                    LDP1    0,,PR0
         3 000071   177640 235007                    LDA     65440,DL
         3 000072   200020 451500                    STP1    @LINK_NAME+10,,AUTO
         3 000073   200020 236100                    LDQ     @LINK_NAME+10,,AUTO
         3 000074   000005 036000 4                  ADLQ    5
         3 000075   000004 755000 xsym               STA     FMT_VEC+4
         3 000076   000005 756000 xsym               STQ     FMT_VEC+5

      628    14770
      629    14771    3      DO SELECT ( LINKDEV$ -> KL$LINKDEV.MODE );

  14771  3 000077   000000 471500                    LDP1    0,,PR0
         3 000100   003100 061500                    CSR     bolr='003'O
         3 000101   100003 010010                    BDSC    3,,PR1                   by=0,bit=1,n=8
         3 000102   200020 000044                    BDSC    @LINK_NAME+10,,AUTO      by=0,bit=0,n=36
         3 000103   200020 236100                    LDQ     @LINK_NAME+10,,AUTO
         3 000104   000002 116007                    CMPQ    2,DL
         3 000105   000116 602000 3                  TNC     s:14771+15
         3 000106   000131 600000 3                  TZE     s:14779
         3 000107   003100 061500                    CSR     bolr='003'O
         3 000110   100003 010010                    BDSC    3,,PR1                   by=0,bit=1,n=8
         3 000111   200021 000044                    BDSC    @LINK_NAME+11,,AUTO      by=0,bit=0,n=36
         3 000112   200021 236100                    LDQ     @LINK_NAME+11,,AUTO
         3 000113   000003 116007                    CMPQ    3,DL
         3 000114   000141 601000 3                  TNZ     s:14787
         3 000115   000135 710000 3                  TRA     s:14783
         3 000116   003100 061500                    CSR     bolr='003'O
         3 000117   100003 010010                    BDSC    3,,PR1                   by=0,bit=1,n=8
         3 000120   200022 000044                    BDSC    @LINK_NAME+12,,AUTO      by=0,bit=0,n=36
         3 000121   200022 236100                    LDQ     @LINK_NAME+12,,AUTO
         3 000122   000001 116007                    CMPQ    1,DL
         3 000123   000141 601000 3                  TNZ     s:14787
         3 000124   000125 710000 3                  TRA     s:14775

      630    14772
      631    14773    3         SELECT ( %KL_DEVMODE_INCOMING# );

PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:113  
      632    14774
      633    14775    3         FMT_VEC(3) = VECTOR( INCOMING_STR );

  14775  3 000125   000006 237000 4                  LDAQ    6
         3 000126   000006 755000 xsym               STA     FMT_VEC+6
         3 000127   000007 756000 xsym               STQ     FMT_VEC+7
         3 000130   000144 710000 3                  TRA     s:14790

      634    14776
      635    14777    3         SELECT ( %KL_DEVMODE_OUTGOING# );

      636    14778
      637    14779    3         FMT_VEC(3) = VECTOR( OUTGOING_STR );

  14779  3 000131   000010 237000 4                  LDAQ    8
         3 000132   000006 755000 xsym               STA     FMT_VEC+6
         3 000133   000007 756000 xsym               STQ     FMT_VEC+7
         3 000134   000144 710000 3                  TRA     s:14790

      638    14780
      639    14781    3         SELECT ( %KL_DEVMODE_FIXED# );

      640    14782
      641    14783    3         FMT_VEC(3) = VECTOR( FIXED_STR );

  14783  3 000135   000012 237000 4                  LDAQ    10
         3 000136   000006 755000 xsym               STA     FMT_VEC+6
         3 000137   000007 756000 xsym               STQ     FMT_VEC+7
         3 000140   000144 710000 3                  TRA     s:14790

      642    14784
      643    14785    3         SELECT ( ELSE );

      644    14786
      645    14787    3      FMT_VEC(3) = VECTOR( BLANK_STR );

  14787  3 000141   000014 237000 4                  LDAQ    12
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:114  
         3 000142   000006 755000 xsym               STA     FMT_VEC+6
         3 000143   000007 756000 xsym               STQ     FMT_VEC+7

      646    14788
      647    14789    3         END;  /*  Do case on .MODE  */

      648    14790    2   CALL X$FORMAT( FDS );

  14790  3 000144   000002 630400 4                  EPPR0   2
         3 000145   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000146   000000 701000 xent               TSX1    X$FORMAT
         3 000147   000000 011000                    NOP     0

      649    14791    2   CALL ASB$WRITE_LO ('   END',6);

  14791  3 000150   000016 630400 4                  EPPR0   14
         3 000151   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000152   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000153   000000 011000                    NOP     0

      650    14792    2      END;  /*  Jcl  */

  14792  3 000154   000311 710000 3                  TRA     s:14828

      651    14793    2   ELSE DO;  /*  Not jcl  */

      652    14794                                                  /* List virtual circuit info. */
      653    14795    3      IF NEW_LINK THEN DO;

  14795  3 000155   200004 471500                    LDP1    @NEW_LINK,,AUTO
         3 000156   000000 066500                    CMPB    filb='0'B
         3 000157   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         3 000160   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000161   000172 600000 3                  TZE     s:14799

      654    14796    3         CALL ASB$WRITE_LO( AS_BLANK, 1 );

PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:115  
  14796  3 000162   000020 630400 4                  EPPR0   16
         3 000163   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000164   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000165   000000 011000                    NOP     0

      655    14797    3         CALL ASB$WRITE_LO( LINKDEV_HDR, LENGTHC(LINKDEV_HDR) );

  14797  3 000166   000023 630400 4                  EPPR0   19
         3 000167   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000170   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 000171   000000 011000                    NOP     0

      656    14798    3         END; /* New link  */

      657    14799    2      FMT_BUF = LINKDEV_FMT;

  14799  3 000172   040000 100400                    MLR     fill='040'O
         3 000173   000025 000041 2                  ADSC9   LINKDEV_FMT              cn=0,n=33
         3 000174   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      658    14800    2      FDS.FMT_.BOUND = SIZEV(LINKDEV_FMT);

  14800  3 000175   000000 236000 xsym               LDQ     FDS
         3 000176   177777 376007                    ANQ     65535,DL
         3 000177   000010 276003                    ORQ     8,DU
         3 000200   000000 756000 xsym               STQ     FDS

      659    14801    2      FDS.NVECS# = 5;

  14801  3 000201   000005 235007                    LDA     5,DL
         3 000202   000011 755000 xsym               STA     FDS+9

      660    14802    2      FMT_VEC(0) = VECTOR( LINKDEV$ -> KL$LINKDEV.LOGON# );

  14802  3 000203   200003 470500                    LDP0    @LINKDEV$,,AUTO
         3 000204   000000 471500                    LDP1    0,,PR0
         3 000205   000001 235000 4                  LDA     1
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:116  
         3 000206   200020 451500                    STP1    @LINK_NAME+10,,AUTO
         3 000207   200020 236100                    LDQ     @LINK_NAME+10,,AUTO
         3 000210   000004 036003                    ADLQ    4,DU
         3 000211   000000 755000 xsym               STA     FMT_VEC
         3 000212   000001 756000 xsym               STQ     FMT_VEC+1

      661    14803    2      FMT_VEC(1) = VECTOR( LINKDEV$->KL$LINKDEV.CIRCUITS# );

  14803  3 000213   000000 471500                    LDP1    0,,PR0
         3 000214   377640 235007                    LDA     130976,DL
         3 000215   200020 451500                    STP1    @LINK_NAME+10,,AUTO
         3 000216   200020 236100                    LDQ     @LINK_NAME+10,,AUTO
         3 000217   000002 036003                    ADLQ    2,DU
         3 000220   000002 755000 xsym               STA     FMT_VEC+2
         3 000221   000003 756000 xsym               STQ     FMT_VEC+3

      662    14804    2      FMT_VEC(2) = VECTOR( LINKDEV$->KL$LINKDEV.PROTOCOL# );

  14804  3 000222   000000 471500                    LDP1    0,,PR0
         3 000223   177640 235007                    LDA     65440,DL
         3 000224   200020 451500                    STP1    @LINK_NAME+10,,AUTO
         3 000225   200020 236100                    LDQ     @LINK_NAME+10,,AUTO
         3 000226   000004 036000 4                  ADLQ    4
         3 000227   000004 755000 xsym               STA     FMT_VEC+4
         3 000230   000005 756000 xsym               STQ     FMT_VEC+5

      663    14805    2      FMT_VEC(3) = VECTOR( LINKDEV$->KL$LINKDEV.SUBADDR# );

  14805  3 000231   000000 471500                    LDP1    0,,PR0
         3 000232   177640 235007                    LDA     65440,DL
         3 000233   200020 451500                    STP1    @LINK_NAME+10,,AUTO
         3 000234   200020 236100                    LDQ     @LINK_NAME+10,,AUTO
         3 000235   000005 036000 4                  ADLQ    5
         3 000236   000006 755000 xsym               STA     FMT_VEC+6
         3 000237   000007 756000 xsym               STQ     FMT_VEC+7

      664    14806
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:117  
      665    14807    3      DO SELECT ( LINKDEV$ -> KL$LINKDEV.MODE );

  14807  3 000240   000000 471500                    LDP1    0,,PR0
         3 000241   003100 061500                    CSR     bolr='003'O
         3 000242   100003 010010                    BDSC    3,,PR1                   by=0,bit=1,n=8
         3 000243   200020 000044                    BDSC    @LINK_NAME+10,,AUTO      by=0,bit=0,n=36
         3 000244   200020 236100                    LDQ     @LINK_NAME+10,,AUTO
         3 000245   000002 116007                    CMPQ    2,DL
         3 000246   000257 602000 3                  TNC     s:14807+15
         3 000247   000272 600000 3                  TZE     s:14815
         3 000250   003100 061500                    CSR     bolr='003'O
         3 000251   100003 010010                    BDSC    3,,PR1                   by=0,bit=1,n=8
         3 000252   200021 000044                    BDSC    @LINK_NAME+11,,AUTO      by=0,bit=0,n=36
         3 000253   200021 236100                    LDQ     @LINK_NAME+11,,AUTO
         3 000254   000003 116007                    CMPQ    3,DL
         3 000255   000302 601000 3                  TNZ     s:14823
         3 000256   000276 710000 3                  TRA     s:14819
         3 000257   003100 061500                    CSR     bolr='003'O
         3 000260   100003 010010                    BDSC    3,,PR1                   by=0,bit=1,n=8
         3 000261   200022 000044                    BDSC    @LINK_NAME+12,,AUTO      by=0,bit=0,n=36
         3 000262   200022 236100                    LDQ     @LINK_NAME+12,,AUTO
         3 000263   000001 116007                    CMPQ    1,DL
         3 000264   000302 601000 3                  TNZ     s:14823
         3 000265   000266 710000 3                  TRA     s:14811

      666    14808
      667    14809    3         SELECT ( %KL_DEVMODE_INCOMING# );

      668    14810
      669    14811    3         FMT_VEC(4) = VECTOR( INCOMING_STR );

  14811  3 000266   000006 237000 4                  LDAQ    6
         3 000267   000010 755000 xsym               STA     FMT_VEC+8
         3 000270   000011 756000 xsym               STQ     FMT_VEC+9
         3 000271   000305 710000 3                  TRA     s:14826

      670    14812
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:118  
      671    14813    3         SELECT ( %KL_DEVMODE_OUTGOING# );

      672    14814
      673    14815    3         FMT_VEC(4) = VECTOR( OUTGOING_STR );

  14815  3 000272   000010 237000 4                  LDAQ    8
         3 000273   000010 755000 xsym               STA     FMT_VEC+8
         3 000274   000011 756000 xsym               STQ     FMT_VEC+9
         3 000275   000305 710000 3                  TRA     s:14826

      674    14816
      675    14817    3         SELECT ( %KL_DEVMODE_FIXED# );

      676    14818
      677    14819    3         FMT_VEC(4) = VECTOR( FIXED_STR );

  14819  3 000276   000012 237000 4                  LDAQ    10
         3 000277   000010 755000 xsym               STA     FMT_VEC+8
         3 000300   000011 756000 xsym               STQ     FMT_VEC+9
         3 000301   000305 710000 3                  TRA     s:14826

      678    14820
      679    14821    3         SELECT ( ELSE );

      680    14822
      681    14823    3      FMT_VEC(4) = VECTOR( BLANK_STR );

  14823  3 000302   000014 237000 4                  LDAQ    12
         3 000303   000010 755000 xsym               STA     FMT_VEC+8
         3 000304   000011 756000 xsym               STQ     FMT_VEC+9

      682    14824
      683    14825    3         END;  /*  Do case on .MODE  */

      684    14826    2   CALL X$FORMAT( FDS );

  14826  3 000305   000002 630400 4                  EPPR0   2
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:119  
         3 000306   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000307   000000 701000 xent               TSX1    X$FORMAT
         3 000310   000000 011000                    NOP     0

      685    14827    2      END;   /*  Not jcl  */

      686    14828    1   FDS.NVECS# = 0; /* reset # vectors in format structure */

  14828  3 000311   000011 450000 xsym               STZ     FDS+9

      687    14829    1   RETURN;

  14829  3 000312   000000 702200 xent               TSX2  ! X66_ARET
      688    14830
      689    14831    1   END ASL$DISP_ONE_LINKDEV;

PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:120  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_LINKDEV.
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:121  

 **** Variables and constants ****

  ****  Section 002 RoData ASL$DISP_ONE_LINKDEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 BLANK_STR                  1-0-0/c CHAR(5)     r     1 FIXED_STR
     3-0-0/c CHAR(8)     r     1 INCOMING_STR              25-0-0/c CHAR(33)    r     1 LINKDEV_FMT
     7-0-0/c CHAR(55)    r     1 LINKDEV_HDR               36-0-0/c CHAR(30)    r     1 LINKDEV_JCL_CMD
    46-0-0/c CHAR(63)    r     1 LINKDEV_OPT_JCL_FMT        5-0-0/c CHAR(8)     r     1 OUTGOING_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @JCL                       3-0-0/w PTR         r     1 @LINKDEV$
     6-0-0/w PTR         r     1 @LINK_NAME                 4-0-0/w PTR         r     1 @NEW_LINK
    *0-0-0/b BIT         r     1 JCL                       *0-0-0/w PTR         r     1 LINKDEV$
    *0-0-0/c CHAR(8)     r     1 LINK_NAME                 *0-0-0/b BIT         r     1 NEW_LINK

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(255)   r     1 FMT_BUF
     0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(216)   r     1 KL$LINKDEV                 0-0-0/w ASTR(9)     r     1 TEXT$C
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:122  


   Procedure ASL$DISP_ONE_LINKDEV requires 203 words for executable code.
   Procedure ASL$DISP_ONE_LINKDEV requires 20 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_LINK_DEVICES.:E05TSI    .
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:123  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:124  
          MINI XREF LISTING

ASA_BRKS_LOC
     11160**DCL     11160--REDEF
ASB$WRITE_LO
     14024**DCL-ENT 14791--CALL    14796--CALL    14797--CALL
AS_BLANK
     11020**DCL     14796<>CALL
AS_DEFAULT.BANNER_PERM
     11853**DCL     11854--REDEF
AS_DEFAULT.BUDGET.MACCT
     11758**DCL     11762--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11771**DCL     11774--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11754**DCL     11756--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11749**DCL     11751--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     11869**DCL     11870--REDEF   11871--REDEF
AS_DEFAULT_DREC.PASSWORD
     13123**DCL     13127--REDEF
AS_DEFAULT_DREC.RENAME
     13146**DCL     13147--REDEF
AS_DFLT.BANNER_PERM
     11675**DCL     11676--REDEF
AS_DFLT.BUDGET.MACCT
     11580**DCL     11584--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11593**DCL     11596--REDEF
AS_DFLT.BUDGET.PACCUM
     11576**DCL     11578--REDEF
AS_DFLT.BUDGET.PMAXC
     11571**DCL     11573--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:125  
AS_DFLT.SETUP_CHRA.TXT
     11691**DCL     11692--REDEF   11693--REDEF
AS_FE_MODE
     11026**DCL     11027--REDEF
AS_MODE
     11023**DCL     11025--REDEF
AS_MOD_USER.ACCESS
     13888**DCL     13889--REDEF
AS_MOD_USER.BANNER
     13875**DCL     13876--REDEF
AS_MOD_USER.BANNER_PERM
     13877**DCL     13878--REDEF
AS_MOD_USER.BILL
     13883**DCL     13884--REDEF
AS_MOD_USER.CPROC
     13879**DCL     13880--REDEF
AS_MOD_USER.FEBILL
     13959**DCL     13960--REDEF
AS_MOD_USER.FECXTMEM
     13976**DCL     13977--REDEF
AS_MOD_USER.FEMINTS
     13961**DCL     13962--REDEF
AS_MOD_USER.FEMMEM
     13972**DCL     13973--REDEF
AS_MOD_USER.FEMTIME
     13970**DCL     13971--REDEF
AS_MOD_USER.FEPPRIV
     13967**DCL     13969--REDEF
AS_MOD_USER.FEPRIV
     13964**DCL     13966--REDEF
AS_MOD_USER.FORCE_BIT
     13873**DCL     13874--REDEF
AS_MOD_USER.KEY
     13955**DCL     13957--REDEF
AS_MOD_USER.LASTCPROC
     13881**DCL     13882--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:126  
AS_MOD_USER.LIMITS.DO_
     13929**DCL     13930--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     13945**DCL     13946--REDEF
AS_MOD_USER.LIMITS.LO
     13925**DCL     13926--REDEF
AS_MOD_USER.LIMITS.MEM
     13921**DCL     13922--REDEF
AS_MOD_USER.LIMITS.MPRIO
     13949**DCL     13950--REDEF
AS_MOD_USER.LIMITS.PDIS
     13937**DCL     13938--REDEF
AS_MOD_USER.LIMITS.PO
     13933**DCL     13934--REDEF
AS_MOD_USER.LIMITS.TDIS
     13941**DCL     13942--REDEF
AS_MOD_USER.LIMITS.TIME
     13917**DCL     13918--REDEF
AS_MOD_USER.MAXENQ
     13898**DCL     13899--REDEF
AS_MOD_USER.PERM_BIT
     13871**DCL     13872--REDEF
AS_MOD_USER.PPRIV
     13893**DCL     13895--REDEF
AS_MOD_USER.PRIOB
     13900**DCL     13901--REDEF
AS_MOD_USER.PRIV
     13890**DCL     13892--REDEF
AS_MOD_USER.QUAN
     13896**DCL     13897--REDEF
AS_MOD_USER.SETUP
     13869**DCL     13870--REDEF
AS_PROJECT.BANNER_PERM
     12209**DCL     12210--REDEF
AS_PROJECT.BUDGET.MACCT
     12114**DCL     12118--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:127  
AS_PROJECT.BUDGET.MAX_PROJECTS
     12127**DCL     12130--REDEF
AS_PROJECT.BUDGET.PACCUM
     12110**DCL     12112--REDEF
AS_PROJECT.BUDGET.PMAXC
     12105**DCL     12107--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12225**DCL     12226--REDEF   12227--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12387**DCL     12388--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12292**DCL     12296--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12305**DCL     12308--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12288**DCL     12290--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12283**DCL     12285--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12403**DCL     12404--REDEF   12405--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13609**DCL     13613--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13632**DCL     13633--REDEF
AS_PROJECT_DREC.PASSWORD
     13447**DCL     13451--REDEF
AS_PROJECT_DREC.RENAME
     13470**DCL     13471--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12031**DCL     12032--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     11936**DCL     11940--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     11949**DCL     11952--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     11932**DCL     11934--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:128  
AS_PROJ_ADMIN.BUDGET.PMAXC
     11927**DCL     11929--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12047**DCL     12048--REDEF   12049--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13285**DCL     13289--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13308**DCL     13309--REDEF
AS_USERS.BANNER_PERM
     11497**DCL     11498--REDEF
AS_USERS.BUDGET.MACCT
     11402**DCL     11406--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11415**DCL     11418--REDEF
AS_USERS.BUDGET.PACCUM
     11398**DCL     11400--REDEF
AS_USERS.BUDGET.PMAXC
     11393**DCL     11395--REDEF
AS_USERS.SETUP_CHRA.TXT
     11513**DCL     11514--REDEF   11515--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12565**DCL     12566--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     12470**DCL     12474--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     12483**DCL     12486--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     12466**DCL     12468--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     12461**DCL     12463--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12581**DCL     12582--REDEF   12583--REDEF
BLANK_STR
     14570**DCL     14787--ASSIGN  14823--ASSIGN
DSEG1$
     11161**DCL     14044--IMP-PTR
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:129  
ERR_CODE
     11155**DCL     11156--REDEF
FDS
     11052**DCL     14763<>CALL    14790<>CALL    14826<>CALL
FDS.FMT_.BOUND
     11057**DCL     14759<<ASSIGN  14765<<ASSIGN  14800<<ASSIGN
FDS.NVECS#
     11080**DCL     14760<<ASSIGN  14766<<ASSIGN  14801<<ASSIGN  14828<<ASSIGN
FIXED_STR
     14571**DCL     14783--ASSIGN  14819--ASSIGN
FMT_BUF
     11151**DCL     14758<<ASSIGN  14764<<ASSIGN  14799<<ASSIGN
FMT_VEC
     11151**DCL     14761<<ASSIGN  14762<<ASSIGN  14767<<ASSIGN  14768<<ASSIGN  14769<<ASSIGN  14775<<ASSIGN
     14779<<ASSIGN  14783<<ASSIGN  14787<<ASSIGN  14802<<ASSIGN  14803<<ASSIGN  14804<<ASSIGN  14805<<ASSIGN
     14811<<ASSIGN  14815<<ASSIGN  14819<<ASSIGN  14823<<ASSIGN
INCOMING_STR
     14572**DCL     14775--ASSIGN  14811--ASSIGN
JCL
     14015**DCL         7--PROC    14756>>IF
KL$LINKDEV.CIRCUITS#
     14509**DCL     14767--ASSIGN  14803--ASSIGN
KL$LINKDEV.LOGON#
     14543**DCL     14761--ASSIGN  14802--ASSIGN
KL$LINKDEV.MODE
     14534**DCL     14771>>DOSELCT 14807>>DOSELCT
KL$LINKDEV.PROTOCOL#
     14515**DCL     14768--ASSIGN  14804--ASSIGN
KL$LINKDEV.SUBADDR#
     14518**DCL     14769--ASSIGN  14805--ASSIGN
KL_DEFAULT.PASSWORD
     13771**DCL     13775--REDEF
KL_DEFAULT.RENAME
     13794**DCL     13795--REDEF
KL_DFLT.PASSWORD
     12961**DCL     12965--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:130  
KL_DFLT.RENAME
     12984**DCL     12985--REDEF
KL_DREC.PASSWORD
     12799**DCL     12803--REDEF
KL_DREC.RENAME
     12822**DCL     12823--REDEF
KL_DREC_CNT.PASSWORD
     12686**DCL     12690--REDEF
KL_DREC_CNT.RENAME
     12709**DCL     12710--REDEF
KL_UBWORD.NUM
     14549**DCL     14550--REDEF
LINK$DREC.PASSWORD
     14102**DCL     14106--REDEF
LINK$DREC.RENAME
     14125**DCL     14126--REDEF
LINKDEV$
     14016**DCL         7--PROC    14391--IMP-PTR 14761>>ASSIGN  14767>>ASSIGN  14768>>ASSIGN  14769>>ASSIGN
     14771>>DOSELCT 14802>>ASSIGN  14803>>ASSIGN  14804>>ASSIGN  14805>>ASSIGN  14807>>DOSELCT
LINKDEV_FMT
     14576**DCL     14799>>ASSIGN  14800--ASSIGN
LINKDEV_HDR
     14574**DCL     14797<>CALL    14797--CALL
LINKDEV_JCL_CMD
     14578**DCL     14758>>ASSIGN  14759--ASSIGN
LINKDEV_OPT_JCL_FMT
     14580**DCL     14764>>ASSIGN  14765--ASSIGN
LINK_NAME
     14017**DCL         7--PROC    14762--ASSIGN
NEW_LINK
     14018**DCL         7--PROC    14795>>IF
OUTGOING_STR
     14573**DCL     14779--ASSIGN  14815--ASSIGN
PROJ_KEY.TEXT
     11033**DCL     11033--REDEF
PROJ_KEY.TXT.PROJECT
PL6.E3A0      #003=ASL$DISP_ONE_LINKDEV File=ASL$LIST_LINK_DEVICES.:E05TSI       TUE 07/29/97 10:19 Page:131  
     11033**DCL     11033--REDEF
REMEM_VAR
     11159**DCL     11159--REDEF
REM_FCMD
     11159**DCL     11160--REDEF
TEXT$C.CNT
     14557**DCL     14558--IMP-SIZ
USERS_KEY.TEXT
     11030**DCL     11031--REDEF   11031--REDEF   11031--REDEF   11032--REDEF
X$FORMAT
     14022**DCL-ENT 14763--CALL    14790--CALL    14826--CALL
