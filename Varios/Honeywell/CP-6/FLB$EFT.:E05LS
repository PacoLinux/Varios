VERSION E05

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:1    
        1        1        /*M* FLB$EFT - CP-6 file maintenance processor */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* THI=1,PLM=3 */
        8        8
        9        9        FLB$EFT: PROC MAIN;
       10       10
       11       11         /***
       12       12          *** INCLUDE
       13       13          ***/
       14       14
       15       15        %INCLUDE CP_6;
       16     5574        %INCLUDE CP_6_SUBS;
       17     6114        %INCLUDE B$JIT;
       18     6717        %INCLUDE B_ERRORS_C;
       19     7844        %INCLUDE FLE_DATA_R;
       20    13795        %INCLUDE FLI_DATA_R;
       21    15209        %INCLUDE FLN_DATA_R;
       22    15946        %INCLUDE FLS_DATA_R;
       23    17746        %INCLUDE FLW_DATA_R;
       24    17760        %INCLUDE FM$FIT;
       25    17981        %INCLUDE FM$GRAN;
       26    18050        %INCLUDE XUD_UTS_M;
       27    18132        %INCLUDE XUH_MACRO_C;
       28    18216        %INCLUDE XUR_ENTRY;
       29    18248        %INCLUDE XU_MACRO_C;
       30    21354        %INCLUDE XU_SUBS_C;
       31    21446
       32    21447         /***
       33    21448          *** ENTRY
       34    21449          ***/
       35    21450
       36    21451    1   DCL FLB$EFT_BRK ENTRY ASYNC;
       37    21452    1   DCL FLC$TAPE_IO_INIT ENTRY;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:2    
       38    21453    1   DCL FLC$TAPE_OPEN_NEXT ENTRY(3) ALTRET;
       39    21454    1   DCL FLC$TAPE_READ_NEXT ENTRY(3) ALTRET;
       40    21455    1   DCL FLE$ESTMOD ENTRY(1);
       41    21456    1   DCL FLH$HELP ENTRY(2);
       42    21457    1   DCL FLH$RPT_ERR ENTRY(3);
       43    21458    1   DCL FLI$ALLOC ENTRY(2);
       44    21459    1   DCL FLI$BUILD_$$EFT ENTRY(1) ALTRET;
       45    21460    1   DCL FLI$DISMNT_TAPES ENTRY(2);
       46    21461    1   DCL FLI$ERROR_SUMMARY ENTRY(1);
       47    21462    1   DCL FLI$INIT ENTRY(1);
       48    21463    1   DCL FLI$NODE_TAPE_OD ENTRY(1) ALTRET;
       49    21464    1   DCL FLI$READY_TAPE_IO ENTRY(6);
       50    21465    1   DCL FLI$RPT_ERR ENTRY(5);
       51    21466    1   DCL FLI$STATS ENTRY;
       52    21467    1   DCL FLI$TSN_USED ENTRY(2) ALTRET;
       53    21468    1   DCL FLM$MOVE ENTRY(1) ALTRET;
       54    21469    1   DCL FLN$DISK_IO_INIT ENTRY;
       55    21470    1   DCL FLN$DISK_NXTA ENTRY;
       56    21471    1   DCL FLN$DISK_OPEN_NEXT ENTRY(5) ALTRET;
       57    21472    1   DCL FLR$REQUALIFY ENTRY;
       58    21473    1   DCL FLS$PROCESS_PRE_RET ENTRY ALTRET;
       59    21474    1   DCL FLS$STOW_FETCH ENTRY(1);
       60    21475    1   DCL FLV$VALIDATE ENTRY(1) ALTRET;
       61    21476    1   DCL FLM$SWITCH_PRIME_DUAL ENTRY ALTRET;
       62    21477    1   DCL FLW$WHERE ENTRY;
       63    21478    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
       64    21479    1   DCL FLS$STATUS ENTRY;
       65    21480        %XUD$UTS_ENTRIES;
       66    21512
       67    21513         /***
       68    21514          *** DCB
       69    21515          ***/
       70    21516
       71    21517    1   DCL M$SI DCB;
       72    21518    1   DCL M$READ_FILE DCB;
       73    21519    1   DCL M$LO DCB;
       74    21520    1   DCL M$DO DCB;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:3    
       75    21521    1   DCL M$TAPE00 DCB;
       76    21522    1   DCL M$CATALOG DCB;
       77    21523
       78    21524         /***
       79    21525          *** SYMREF
       80    21526          ***/
       81    21527
       82    21528    1   DCL EFT_CMD UBIN WORD SYMREF;
       83    21529    1   DCL B_VERSION CHAR(1) SYMREF;
       84    21530
       85    21531         /***
       86    21532          *** SYMDEF
       87    21533          ***/
       88    21534
       89    21535    1   DCL BREAK_COUNT SBIN STATIC SYMDEF;
       90    21536    1   DCL BREAK_CONTINUED BIT(1) STATIC SYMDEF;
       91    21537    1   DCL BREAK_DCB# SBIN STATIC SYMDEF;
       92    21538    1   DCL BREAK_TASK CHAR(18) STATIC SYMDEF;
       93    21539    1   DCL RESTORE_FROM_TAPE BIT(1) STATIC SYMDEF;
       94    21540    1   DCL CHECK_TAPE BIT(1) STATIC SYMDEF;
       95    21541
       96    21542         /***
       97    21543          *** STATIC
       98    21544          ***/
       99    21545
      100    21546    1   DCL CODE SBIN STATIC;
      101    21547    1   DCL COMMAND SBIN STATIC INIT(0);
      102    21548    1   DCL PREV_COMMAND SBIN STATIC INIT(0);
      103    21549    1   DCL DATEUTS UBIN WORD STATIC;
      104    21550    1   DCL 1 ANSDATE STATIC,
      105    21551    1         2 YEAR CHAR(2),
      106    21552    1         2 MONTH CHAR(2),
      107    21553    1         2 DAY CHAR(2),
      108    21554    1         2 HOUR CHAR(2),
      109    21555    1         2 MINUTE CHAR(2),
      110    21556    1         2 SECOND CHAR(2),
      111    21557    1         2 SEC100THS CHAR(2);
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:4    
      112    21558
      113    21559    1   DCL 1 ANSDATEPIECE REDEF ANSDATE,
      114    21560    1         2 YYMMDD CHAR(6),
      115    21561    1         2 HHMMSSSS CHAR(8);
      116    21562    1   DCL ANSDATECHARS REDEF ANSDATE CHAR(14);
      117    21563    1   DCL FIRST_TIME BIT(1) STATIC INIT('1'B);
      118    21564    1   DCL 1 GREETINGS STATIC,
      119    21565    1         2 * CHAR(0) INIT(' EFT '),
      120    21566    1         2 VERSION CHAR(6),
      121    21567    1         2 * CHAR(0) INIT(' '),
      122    21568    1         2 GTIME CHAR(5),
      123    21569    1         2 * CHAR(0) INIT(' '),
      124    21570    1         2 GDAY CHAR(3),
      125    21571    1         2 * CHAR(0) INIT(' '),
      126    21572    1         2 GDATE CHAR(10);
      127    21573    1   DCL 1 TEST_GREETINGS STATIC,
      128    21574    1         2 * CHAR(0) INIT(' EFT TEST-MODE ');
      129    21575    1   DCL I SBIN STATIC;
      130    21576    1   DCL M$READ_FILE$ PTR STATIC;
      131    21577    1   DCL M$SI$ PTR STATIC;
      132    21578    1   DCL M$LO$ PTR STATIC;
      133    21579    1   DCL M$CATALOG$ PTR STATIC;
      134    21580        %VLP_SN( FPTN=MUCK_LIST,
      135    21581                 N=1,
      136    21582                 STCLASS=STATIC );
      137    21595    1   DCL N SBIN STATIC;
      138    21596    1   DCL NBR_DPS SBIN STATIC;
      139    21597    1   DCL NODE$ PTR STATIC;
      140    21598        %VLP_ERRCODE( FPTN=ERR,
      141    21599                      STCLASS="REDEF NODE$" );
      142    21644    1   DCL NOT_SPECIFIED BIT(1) STATIC;
      143    21645    1   DCL SOURCE_TAPE_SNLIST$ PTR STATIC;
      144    21646    1   DCL SUBNODE$ PTR STATIC;
      145    21647    1   DCL SUBNODEX SBIN STATIC;
      146    21648    1   DCL SUBSUBNODE$ PTR STATIC;
      147    21649    1   DCL SUBSUBNODEX SBIN STATIC;
      148    21650    1   DCL SUBSUBSUBNODEX SBIN STATIC;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:5    
      149    21651    1   DCL TEMP SBIN STATIC;
      150    21652    1   DCL TEMP$ PTR STATIC;
      151    21653
      152    21654        %VLP_ACCT( FPTN=PREV_ACCT,
      153    21655                   STCLASS=STATIC );
      154    21668    1   DCL RANGE_SPECIFIED BIT(1) STATIC;
      155    21669    1   DCL SKIP_SPECIFIED BIT(1) STATIC;
      156    21670        %VLP_ACCT( FPTN=FIRST_ACCT_SPECIFIED,
      157    21671                   STCLASS=STATIC );
      158    21684    1   DCL J SBIN STATIC;
      159    21685    1   DCL STATE SBIN STATIC;
      160    21686    1   DCL MODE SBIN STATIC;                   /* OPEN mode - TRANSFER or TRANSPORT  */
      161    21687    1   DCL BACKUP_$$EFT BIT(1) STATIC;
      162    21688    1   DCL SUB_COMMAND SBIN STATIC;
      163    21689    1   DCL 1 OPTION_MAP WALIGNED STATIC SYMDEF,
      164    21690    1         2 ARCHIVE BIT(1),
      165    21691    1         2 QUEUED BIT(1),
      166    21692    1         2 QS BIT(1),
      167    21693    1         2 QF BIT(1),
      168    21694    1         2 ACTIVE BIT(1),
      169    21695    1         2 INACTIVE BIT(1),
      170    21696    1         2 DELF BIT(1);
      171    21697
      172    21698    1   DCL 1 SRCH_BIT STATIC,
      173    21699    1         2 DELF BIT(1),
      174    21700    1         2 QS BIT(1),
      175    21701    1         2 ARCHIVE BIT(1);
      176    21702    1   DCL CHECK_SRCH_BIT BIT(1);
      177    21703
      178    21704        /***
      179    21705         *** CONSTANT
      180    21706         ***/
      181    21707
      182    21708    1   DCL 1 FLERRMSGSYS CONSTANT,
      183    21709    1         2 * UBIN BYTE CALIGNED INIT(LENGTHC(':FLERRMSG.:SYS   ')),
      184    21710    1         2 * CHAR(0) CALIGNED INIT(':FLERRMSG.:SYS   ');
      185    21711
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:6    
      186    21712    1   DCL PROMPT CHAR(0) CONSTANT INIT('+');
      187    21713    1   DCL EFT_PROMPT CHAR(0) CONSTANT INIT('*');
      188    21714
      189    21715         /***
      190    21716          *** EQU
      191    21717          ***/
      192    21718        %XUD_UTS_EQU;
      193    21729
      194    21730         /***
      195    21731          *** BASED
      196    21732          ***/
      197    21733
      198    21734    1   DCL NCHARS CHAR(N) BASED CALIGNED;
      199    21735    1   DCL 1 B$VERSION BASED,
      200    21736    1         2 L# UBIN BYTE CALIGNED,
      201    21737    1         2 NAME# CHAR(B$VERSION.L#) CALIGNED;
      202    21738        %PARSE$OUT( STCLASS=BASED );
      203    21783        %PARSE$SYM( STCLASS=BASED );
      204    21821        %VLP_SN( STCLASS=BASED );
      205    21834        %SNLISTINFO( STCLASS="BASED(LAST_SNLISTINFO$)" );
      206    21837        %F$DCB;
      207    21894        %B$TCB( STCLASS="BASED(B$TCB$)" );
      208    21897        %B$ALT;
      209    21905        %FM$GRAN;
      210    21909
      211    21910
      212    21911         /***
      213    21912          *** FPT
      214    21913          ***/
      215    21914
      216    21915        %FPT_INT( FPTN=FPT_INT,
      217    21916                  UENTRY=FLB$EFT_BRK,
      218    21917                  STCLASS=CONSTANT );
      219    21931
      220    21932        %P_PCB( NAME=EFT_CMD_PCB,
      221    21933                STCLASS=STATIC );
      222    22132
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:7    
      223    22133        %XUR_INIT( NAME=XUR_INIT,
      224    22134                   SYNTAX=YES,
      225    22135                   COMMANDS=YES,
      226    22136                   PCB=EFT_CMD_PCB );
      227    22235
      228    22236        %XUH_PARAM( NAME=XUH_PARAM,
      229    22237                    OUTDCB1=M$DO );
      230    22298
      231    22299        %VLP_ERRCODE( FPTN=VLP_ERRCODE,
      232    22300                      STCLASS=STATIC );
      233    22345
      234    22346    1   DCL 1 FILE STATIC,
      235    22347    1         2 NAME# CHAR(31) CALIGNED,
      236    22348    1         2 L# UBIN BYTE CALIGNED;
      237    22349
      238    22350        %VLP_ACCT( FPTN=ACCT,
      239    22351                   STCLASS=STATIC );
      240    22364
      241    22365    1   DCL 1 START_FILE STATIC,
      242    22366    1         2 NAME# CHAR(31) CALIGNED,
      243    22367    1         2 L# UBIN BYTE CALIGNED;
      244    22368
      245    22369        %VLP_ACCT( FPTN=START_ACCT,
      246    22370                   STCLASS=STATIC );
      247    22383
      248    22384    1   DCL 1 STOP_FILE STATIC,
      249    22385    1         2 NAME# CHAR(31) CALIGNED,
      250    22386    1         2 L# UBIN BYTE CALIGNED;
      251    22387
      252    22388        %VLP_ACCT( FPTN=STOP_ACCT,
      253    22389                   STCLASS=STATIC );
      254    22402
      255    22403        %VLP_SN( FPTN=FILE_SN,
      256    22404                 N=1,
      257    22405                 STCLASS=STATIC );
      258    22418
      259    22419        %VLP_SN( FPTN=DPSN,
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:8    
      260    22420                 N=1,
      261    22421                 STCLASS=STATIC );
      262    22434
      263    22435        %FPT_OPEN( FPTN=CHECK_PACKSET,
      264    22436                   TEST=YES,
      265    22437                   DCB=M$DISK00,
      266    22438                   NXTF=YES,
      267    22439                   NAME=NULL_FILE,
      268    22440                   ACCT=NULL_ACCT,
      269    22441                   ASN=FILE,
      270    22442                   SN=DPSN,
      271    22443                   FUN=IN );
      272    22552
      273    22553        %FPT_DEVICE( FPTN=PAGE_LO_RESET,
      274    22554                     DCB=M$LO,
      275    22555                     PAGE=YES,
      276    22556                     HDR=PAGE_LO_HEADER );
      277    22574
      278    22575        %FPT_DEVICE( FPTN=ERASE_HEADER,
      279    22576                     DCB=M$LO,
      280    22577                     HDR=PAGE_LO_HEADER );
      281    22595
      282    22596        %VLP_HDR( FPTN=PAGE_LO_HEADER,
      283    22597                  RESETPAGE=NO,
      284    22598                  COUNT=76,
      285    22599                  TITLE=' ' );
      286    22615
      287    22616        %FPT_MADMUCK( FPTN=GET_PSN,
      288    22617                      ACCT=OUR_ACCT,
      289    22618                      SN=MUCK_LIST,
      290    22619                      READ=YES );
      291    22635
      292    22636        %VLP_ACCT( FPTN=OUR_ACCT,
      293    22637                   STCLASS=STATIC );
      294    22650
      295    22651        %FPT_TIME( FPTN=GET_ANSDATE_DATEUTS,
      296    22652                   DATE=ANSDATEPIECE.YYMMDD,
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:9    
      297    22653                   TIME=ANSDATEPIECE.HHMMSSSS,
      298    22654                   SOURCE=UTS,
      299    22655                   TSTAMP=DATEUTS,
      300    22656                   DEST=ANS );
      301    22675
      302    22676        %FPT_TIME( FPTN=GET_DATEUTS_ANSDATE,
      303    22677                   DATE=ANSDATEPIECE.YYMMDD,
      304    22678                   TIME=ANSDATEPIECE.HHMMSSSS,
      305    22679                   SOURCE=ANS,
      306    22680                   DEST=UTS,
      307    22681                   TSTAMP=DATEUTS );
      308    22700
      309    22701        %FPT_TIME( FPTN=GET_GREETING_TIME,
      310    22702                   TIME="GREETINGS.GTIME",
      311    22703                   DAY="GREETINGS.GDAY",
      312    22704                   DATE="GREETINGS.GDATE" );
      313    22723
      314    22724        %FPT_WRITE( FPTN=GREET_USER,
      315    22725                    DCB=M$LO,
      316    22726                    BUF=GREETINGS );
      317    22757
      318    22758        %FPT_WRITE( FPTN=GREET_TEST_USER,
      319    22759                    DCB=M$LO,
      320    22760                    BUF=TEST_GREETINGS );
      321    22791
      322    22792        %FPT_PRIV( FPTN=SWITCH_FMSEC,
      323    22793                   PRIV=%PR_FMSEC# );
      324    22808
      325    22809        %FPT_PRIV( FPTN=SWITCH_FMEFT,
      326    22810                   PRIV=%PR_FMEFT# );
      327    22825
      328    22826        %FPT_OPEN( FPTN=OPEN_LO_DO,
      329    22827                   DCB=M$LO,
      330    22828                   ORG=UR,
      331    22829                   CTG=YES,
      332    22830                   FUN=CREATE );
      333    22939
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:10   
      334    22940        %FPT_CLOSE( FPTN=CLOSE_FID,
      335    22941                    DISP=SAVE );
      336    22983
      337    22984        %FPT_OPEN( FPTN=OPEN_SI,
      338    22985                   DCB=M$SI,
      339    22986                   FUN=IN );
      340    23095
      341    23096        %FPT_CLOSE( FPTN=CLOSE_READ_FILE,
      342    23097                    DCB=M$READ_FILE,
      343    23098                    DISP=SAVE );
      344    23140
      345    23141        %FPT_OPEN( FPTN=OPEN_FID,
      346    23142                   SCRUB=YES,
      347    23143                   ACCT=FID_ACCT,
      348    23144                   NAME=FID_NAME,
      349    23145                   PASS=FID_PASS,
      350    23146                   SN=FID_SN,
      351    23147                   WSN=FID_WSN,
      352    23148                   CTG=YES );
      353    23257
      354    23258        %FPT_FID( FPTN=FPT_FID,
      355    23259                  ACCT=FID_ACCT,
      356    23260                  NAME=FID_NAME,
      357    23261                  PASS=FID_PASS,
      358    23262                  RES=OPEN_FID.V.RES#,
      359    23263                  SN=FID_SN,
      360    23264                  WSN=FID_WSN,
      361    23265                  ASN=OPEN_FID.V.ASN#,
      362    23266                  SACCT=YES,
      363    23267                  SNAME=YES,
      364    23268                  SPASS=YES,
      365    23269                  SRES=YES,
      366    23270                  SSN=YES,
      367    23271                  SWSN=YES,
      368    23272                  RESULTS=FPT_FID_RESULTS );
      369    23295
      370    23296        %VLR_FID( FPTN=FPT_FID_RESULTS,
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:11   
      371    23297                  STCLASS="STATIC SYMDEF" );
      372    23316
      373    23317        %VLP_NAME( FPTN=FID_NAME,
      374    23318                   LEN=31 );
      375    23345
      376    23346        %VLP_ACCT( FPTN=FID_ACCT );
      377    23359
      378    23360        %VLP_PASS( FPTN=FID_PASS );
      379    23373
      380    23374        %VLP_SN( FPTN=FID_SN,
      381    23375                 N=10,
      382    23376                 SN=' ' );
      383    23389
      384    23390        %VLP_WSN( FPTN=FID_WSN );
      385    23403
      386    23404        %FPT_OPEN( FPTN=OPEN_DEFAULT_LO,
      387    23405                   DCB=M$LO,
      388    23406                   SCRUB=YES,
      389    23407                   ORG=UR,
      390    23408                   FUN=CREATE,
      391    23409                   ASN=DEVICE,
      392    23410                   RES='ME' );
      393    23519
      394    23520        %FPT_REM( FPTN=FPT_REM );
      395    23534
      396    23535        %FPT_DEVICE( FPTN=PAGE_LO,
      397    23536                     DCB=M$LO,
      398    23537                     PAGE=YES,
      399    23538                     HDR=ERASE );
      400    23556
      401    23557        %VLP_HDR( FPTN=LO_HEADER,
      402    23558                  RESETPAGE=YES,
      403    23559                  COUNT=76,
      404    23560                  TITLE=' ' );
      405    23576
      406    23577        %VLP_NAME( FPTN=RET_CMDS_FNAME,
      407    23578                   NAME='*RET_CMDS' );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:12   
      408    23605        %FPT_OPEN( FPTN=RET_CMDS_OPEN,
      409    23606                   DCB=M$READ_FILE,
      410    23607                   ASN=FILE,
      411    23608                   FUN=IN,
      412    23609                   NAME=RET_CMDS_FNAME );
      413    23718        %FPT_OPEN ( FPTN = BACKUP_CMD_OPEN,
      414    23719                    DCB = M$READ_FILE,
      415    23720                    ASN = FILE,
      416    23721                    FUN = IN,
      417    23722                    NAME = BACKUP_CMD_FNAME );
      418    23831
      419    23832        %FPT_PRIV( FPTN=CHKEFTRUN,
      420    23833                   PRIV=%PPR_EFT#,
      421    23834                   PPRIV=YES );
      422    23849
      423    23850        %FPT_OPEN ( FPTN=SAVE_TAPE_OPEN);
      424    23959
      425    23960        %FPT_OPEN ( FPTN=OPEN_BACKUP_RBLDFILE,
      426    23961                   DCB=M$STATUS,
      427    23962                   ORG=KEYED,
      428    23963                   ACS=DIRECT,
      429    23964                   ASN=FILE,
      430    23965                   CTG=YES,
      431    23966                   FUN=IN,
      432    23967                   NAME=FID_NAME,
      433    23968                   ACCT=FID_ACCT,
      434    23969                   SN=FID_SN,
      435    23970                   SCRUB=YES );
      436    24079
      437    24080        %FPT_OPEN ( FPTN=OPEN_BACKUP_TEMP,
      438    24081                   DCB=M$DISK00,
      439    24082                   ORG=KEYED,
      440    24083                   ACS=DIRECT,
      441    24084                   ASN=FILE,
      442    24085                   CTG=YES,
      443    24086                   FUN=CREATE,
      444    24087                   EXIST=NEWFILE,
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:13   
      445    24088                   NAME=BACKUP_TEMP,
      446    24089                   SN=BACKUP_SN,
      447    24090                   SCRUB=YES );
      448    24199
      449    24200        %VLP_NAME( FPTN=BACKUP_TEMP,
      450    24201                   NAME='*:BACKUP');
      451    24228
      452    24229        %FPT_READ( FPTN=READ_BACKUP_TEMP,
      453    24230                   KEY=STATUS_KEY,
      454    24231                   KEYR=YES,
      455    24232                   KEYS=YES,
      456    24233                   BUF=TSN_USED_BUF,
      457    24234                   DCB=M$DISK00);
      458    24273
      459    24274        %FPT_WRITE( FPTN=WRITE_BACKUP_TEMP,
      460    24275                   BUF=TSN_USED_BUF,
      461    24276                   KEY=STATUS_KEY,
      462    24277                   DCB=M$DISK00);
      463    24308
      464    24309        %FPT_CLOSE( FPTN=CLOSE_BACKUP_TEMP,
      465    24310                    DISP=SAVE,
      466    24311                    DCB=M$DISK00);
      467    24353
      468    24354
      469    24355        /****************************************/
      470    24356
      471    24357    1      M$SI$ = DCBADDR(DCBNUM(M$SI));
      472    24358    1      M$READ_FILE$ = DCBADDR(DCBNUM(M$READ_FILE));
      473    24359    1      M$LO$ = DCBADDR(DCBNUM(M$LO));
      474    24360    1      M$CATALOG$ = DCBADDR(DCBNUM(M$CATALOG));
      475    24361
      476    24362    1      CALL XUR$INIT( XUR_INIT );
      477    24363    1      CALL XUR$SETERRMSG( FLERRMSGSYS )
      478    24364    2       WHENALTRETURN DO;
      479    24365    2         CALL M$XXX;
      480    24366    2         END;
      481    24367
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:14   
      482    24368        /*
      483    24369           CALL M$SPRIV( CHKEFTRUN )
      484    24370            WHENALTRETURN DO;
      485    24371              CALL FLI$RPT_ERR;
      486    24372              CALL FLI$RPT_ERR( E_CANT_RUN_EFT );
      487    24373              CALL M$XXX;
      488    24374              END;
      489    24375        */
      490    24376
      491    24377    1      IF B$JIT.PRIV.JOB & %PR_FMSEC#
      492    24378    1       THEN FMSEC = '1'B;
      493    24379    1       ELSE FMSEC = '0'B;
      494    24380    1      IF NOT FMSEC
      495    24381    1       THEN CALL M$RPRIV( SWITCH_FMSEC ) ALTRET(ERROR_OUT);
      496    24382    1      CALL M$OPEN( OPEN_SI ) ALTRET( ERROR_OUT );
      497    24383    1      OPEN_LO_DO.V.DCB# = DCBNUM(M$LO);
      498    24384    1      CALL M$OPEN( OPEN_LO_DO ) ALTRET( ERROR_OUT );
      499    24385    1      CALL M$DEVICE( PAGE_LO_RESET ) ALTRET( ERROR_OUT );
      500    24386    1      IF NOT DCBADDR(DCBNUM(M$DO))->F$DCB.FCD#
      501    24387    2       THEN DO;             /* When debugging, DELTA might already have it open  */
      502    24388    2         OPEN_LO_DO.V.DCB# = DCBNUM(M$DO);
      503    24389    2         CALL M$OPEN( OPEN_LO_DO ) ALTRET( ERROR_OUT );
      504    24390    2         END;
      505    24391
      506    24392        /***
      507    24393         *** If the appropriate sense switches are set, output a different invocation
      508    24394         *** and set TEST-MODE. If in test mode, miscellaneous info. such as time
      509    24395         *** in heading output, etc. must remain constant for the purpose of running QUAC.
      510    24396         ***/
      511    24397    1      IF B$JIT.SWITCH ~= '124123124000'O   /* Different greeting if in test mode */
      512    24398    2        THEN DO;
      513    24399    2        TEST_MODE = '0'B;
      514    24400    2        GREETINGS.VERSION = ADDR(B_VERSION)->B$VERSION.NAME#;
      515    24401    2      CALL M$TIME( GET_GREETING_TIME );
      516    24402    2      CALL M$WRITE( GREET_USER );
      517    24403    2   END;
      518    24404    2       ELSE DO;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:15   
      519    24405    2         TEST_MODE = '1'B;
      520    24406    2         CALL M$WRITE ( GREET_TEST_USER );
      521    24407    2   END;
      522    24408
      523    24409
      524    24410    1      BREAK_DCB# = 0;
      525    24411    1      BREAK_COUNT = 0;
      526    24412    1      BREAK_CONTINUED = '0'B;
      527    24413    1      BREAK_TASK = 'Initialization!';
      528    24414
      529    24415    1      CATALOG_ON = '0'B;
      530    24416    1      BACKUP_$$EFT = '0'B;
      531    24417
      532    24418    1      CALL M$INT( FPT_INT );
      533    24419
      534    24420         /***
      535    24421          *** Main command parsing loop.
      536    24422          ***/
      537    24423
      538    24424    2      DO WHILE('1'B);
      539    24425
      540    24426        /***
      541    24427         *** If a user does not have FMSEC privilege, then restrict the setting of FMSEC
      542    24428         *** to a set of EFT commands, when the user only has EFT processor priv.
      543    24429         ***/
      544    24430    2         IF NOT FMSEC
      545    24431    2          THEN CALL M$RPRIV( SWITCH_FMSEC )
      546    24432    3             WHENALTRETURN DO;
      547    24433    3               END;
      548    24434    2         BREAK_CONTINUED = '0'B;
      549    24435    2         BREAK_DCB# = 0;
      550    24436    2         BREAK_TASK = 'Getting command!';
      551    24437    2         PREV_COMMAND = COMMAND;           /* Save previous command              */
      552    24438
      553    24439    2         IF FIRST_TIME
      554    24440    3          THEN DO;
      555    24441    3            TEMP = B$JIT.CCARS;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:16   
      556    24442    3            CALL XUR$GETCMD( EFT_CMD, NODE$, VECTOR(EFT_PROMPT), B$JIT.CCBUF, TEMP )
             24442                     ALTRET( TELL_ERROR );
      557    24443    3            END;
      558    24444    2          ELSE CALL XUR$GETCMD( EFT_CMD, NODE$, VECTOR(EFT_PROMPT) ) ALTRET( TELL_ERROR
             24444                   );
      559    24445    2         CALL XUR$ECHOIF( DCBNUM(M$LO) );
      560    24446    2         CALL FLI$INIT;
      561    24447    2         CALL FLB_OPTION_INIT;
      562    24448
      563    24449    2         TRANS_NBR = 0;
      564    24450    2         TOTAL_FILES = 0;
      565    24451    2         TOTAL_GRANS = 0;
      566    24452    2         TAPE_OPTION = '0'B;
      567    24453    2         TSN_SET_NBR = 0;        /* Start each new command from first tape set   */
      568    24454    2         SNLIST_NBR = 0;                   /* Index of current SN list           */
      569    24455    2         BREAK_COUNT = 0;
      570    24456    2         CATALOG_ON = '0'B;
      571    24457    2         COMMAND_ERROR = '0'B;
      572    24458    2         COMMAND = NODE$->OUT$BLK.CODE;
      573    24459    2         OPTION_MAP = '0'B;
      574    24460    2         SRCH_BIT = '111'B;
      575    24461    2         FILE_TYPE = '0'B;
      576    24462    2         CHECK_SRCH_BIT = '0'B;
      577    24463    2         FPT_FID_RESULTS = '0'B;
      578    24464        /***
      579    24465         *** Only the following commands are allowed to be executed by the general
      580    24466         *** user (user without processor privilege %PPR_EFT or FMSEC). Most of the time
      581    24467         *** these commands will be executed by the general user in IBEX. Since
      582    24468         *** there is no way to determine if commands are executed in IBEX or
      583    24469         *** EFT, a minimal set must be allowed. Abort the general user if he
      584    24470         *** tries to execute commands other than the minimal set.
      585    24471        */
      586    24472    2         IF NOT (B$JIT.PPRIV & %PPR_EFT#) AND NOT FMSEC
      587    24473    3          THEN DO;
      588    24474    4            DO CASE ( COMMAND );
      589    24475    4             CASE( %NULL,%FETCH,%UNFETCH,%STOW_ACTIVE,%STOW_INACTIVE,%UNSTOW,
      590    24476    4              %UNARCHIVE,%END );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:17   
      591    24477    4             CASE ( ELSE );
      592    24478    4               CALL FLI$RPT_ERR(E_CANT_RUN_EFT);
      593    24479    4               CALL M$XXX;
      594    24480    4             END;
      595    24481    3            END;
      596    24482
      597    24483    3         DO CASE( COMMAND );
      598    24484
      599    24485    3          CASE( %NULL );
      600    24486    3            FIRST_TIME = '0'B;
      601    24487
      602    24488    3          CASE( %ERROR );
      603    24489    3            BREAK_TASK = 'Error summary!';
      604    24490    3            CALL FLI$ERROR_SUMMARY( '1'B );
      605    24491
      606    24492    3          CASE( %HELP );
      607    24493    3            BREAK_TASK = 'Helping!';
      608    24494    3            XUH_PARAM.HELP$ = NODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXTC$;
      609    24495    3            CALL XUR$HELP( XUH_PARAM );
      610    24496
      611    24497    3          CASE( %MORE_HELP );
      612    24498    3            BREAK_TASK = 'Helping!';
      613    24499    3            CALL XUR$MOREMSG( XUH_PARAM );
      614    24500
      615    24501    3          CASE( %ALL_HELP );
      616    24502    3            BREAK_TASK = 'Helping!';
      617    24503    3            CALL XUR$ALLMSG( XUH_PARAM );
      618    24504
      619    24505    3          CASE( %END );
      620    24506    3            CALL M$EXIT( FPT_EXIT );
      621    24507
      622    24508    3          CASE( %CHECK );
      623    24509    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      624    24510    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      625    24511    3            BREAK_TASK = 'Checking!';
      626    24512    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;
      627    24513    3            CALL FLB_TAPE_NODES;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:18   
      628    24514
      629    24515    3          CASE( %RETRIEVE );
      630    24516    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      631    24517    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      632    24518    3            BREAK_TASK = 'Retrieving!';
      633    24519    3            CALL FLB_TAPE_NODES;
      634    24520
      635    24521    3          CASE( %RESTORE );
      636    24522    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      637    24523    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      638    24524    3            BREAK_TASK = 'Restoring!';
      639    24525    3            CALL FLB_RESTORE_NODES;
      640    24526
      641    24527    3          CASE( %REWIND );
      642    24528    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      643    24529    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      644    24530    3            BREAK_TASK = 'Rewinding!';
      645    24531    3            CALL FLB_TAPE_NODES;
      646    24532
      647    24533    3          CASE( %REMOVE );
      648    24534    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      649    24535    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      650    24536    3            BREAK_TASK = 'Removing!';
      651    24537    3            CALL FLB_TAPE_NODES;
      652    24538
      653    24539    3          CASE( %MOUNT );
      654    24540    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      655    24541    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      656    24542    3            BREAK_TASK = 'Mounting!';
      657    24543    3            CALL FLB_TAPE_NODES;
      658    24544
      659    24545    3          CASE( %SCAN );
      660    24546    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      661    24547    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      662    24548    3            BREAK_TASK = 'Scanning!';
      663    24549    3            CALL FLB_VALIDATE_NODES;
      664    24550
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:19   
      665    24551    3          CASE( %VALIDATE );
      666    24552    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      667    24553    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      668    24554    3            BREAK_TASK = 'Validating!';
      669    24555    3            CALL FLB_VALIDATE_NODES;
      670    24556
      671    24557    3          CASE( %SAVE );
      672    24558    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      673    24559    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      674    24560    3            BREAK_TASK = 'Saving!';
      675    24561    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;
      676    24562    3            CALL FLB_SAVE_NODES;
      677    24563
      678    24564    3          CASE( %DUAL, %DUAL_INCREMENTAL );
      679    24565    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      680    24566    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      681    24567    3            BREAK_TASK = 'Dualing!';
      682    24568    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;
      683    24569    3            CALL FLB_DUAL_NODES;
      684    24570
      685    24571    3          CASE( %BACKUP );
      686    24572    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      687    24573    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      688    24574    3            BREAK_TASK = 'Backing up!';
      689    24575    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;
      690    24576    3            CALL FLB_SAVE_NODES;
      691    24577
      692    24578    3          CASE( %ARCHIVE_CMD );
      693    24579    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      694    24580    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      695    24581    3            BREAK_TASK = 'Archiving!';
      696    24582    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;
      697    24583    3            CALL FLB_SAVE_NODES;
      698    24584
      699    24585    3          CASE( %PURGE );
      700    24586    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      701    24587    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:20   
      702    24588    3            BREAK_TASK = 'Purging!';
      703    24589    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;
      704    24590    3            CALL FLB_SAVE_NODES;
      705    24591
      706    24592    3          CASE( %REQUALIFY, %REQUALIFY_ARCHIVE, %REQUALIFY_BACKUP );
      707    24593    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      708    24594    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      709    24595    3            BREAK_TASK = 'Requalifying!';
      710    24596    3            CALL FLB_REQUALIFY_NODES;
      711    24597
      712    24598    3          CASE( %STOW_ACTIVE, %STOW_INACTIVE );
      713    24599    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      714    24600    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      715    24601    3            BREAK_TASK = 'Stowing!';
      716    24602    3            CALL FLB_STOW_FETCH_NODES;
      717    24603
      718    24604    3          CASE( %FETCH );
      719    24605    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      720    24606    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      721    24607    3            BREAK_TASK = 'Fetching!';
      722    24608    3            CALL FLB_STOW_FETCH_NODES;
      723    24609
      724    24610    3          CASE( %UNFETCH );
      725    24611    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      726    24612    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      727    24613    3            BREAK_TASK = 'Unfetching!';
      728    24614    3            CALL FLB_STOW_FETCH_NODES;
      729    24615
      730    24616    3          CASE( %UNSTOW );
      731    24617    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      732    24618    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      733    24619    3            CALL FLB_STOW_FETCH_NODES;
      734    24620
      735    24621    3          CASE( %UNARCHIVE );
      736    24622    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      737    24623    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      738    24624    3            BREAK_TASK = 'Unarchiving!';
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:21   
      739    24625    3            CALL FLB_STOW_FETCH_NODES;
      740    24626
      741    24627    3          CASE( %READ );
      742    24628    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      743    24629    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      744    24630    3            BREAK_TASK = 'Reading!';
      745    24631    3            CALL FLB_READ_NODES;
      746    24632
      747    24633    3          CASE( %OUTPUT );
      748    24634    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      749    24635    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      750    24636    3            CALL FLB_OUTPUT_NODES;
      751    24637
      752    24638    3          CASE( %CATALOG );
      753    24639    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      754    24640    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      755    24641    3            CALL FLB_OUTPUT_NODES;
      756    24642
      757    24643    3          CASE( %WHERE );
      758    24644    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      759    24645    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      760    24646    3            BREAK_TASK = 'Finding out where!';
      761    24647    3            CALL FLB_WHERE_NODES;
      762    24648
      763    24649    3          CASE( %ESTABLISH );
      764    24650    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      765    24651    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      766    24652    3            BREAK_TASK = 'Establishing!';
      767    24653    3            CALL FLB_ESTMOD_NODES;
      768    24654
      769    24655    3          CASE( %MODIFY );
      770    24656    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      771    24657    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      772    24658    3            BREAK_TASK = 'Modifying!';
      773    24659    3            CALL FLB_ESTMOD_NODES;
      774    24660
      775    24661    3          CASE( %ADD );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:22   
      776    24662    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      777    24663    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      778    24664    3            BREAK_TASK = 'Adding!';
      779    24665    3            CALL FLB_ADDREM_NODES;
      780    24666
      781    24667    3          CASE( %REMOVE_ARC );
      782    24668    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      783    24669    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      784    24670    3            BREAK_TASK = 'Removing!';
      785    24671    3            COMMAND = %REMOVE;
      786    24672    3            CALL FLB_ADDREM_NODES;
      787    24673
      788    24674    3          CASE( %OPEN_UPDATE, %OPEN_CREATE, %OPEN_EXTEND, %OPEN_INPUT );
      789    24675    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      790    24676    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      791    24677    3            BREAK_TASK = 'Opening!';
      792    24678    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;
      793    24679    3            CALL FLB_OPEN_NODES;
      794    24680
      795    24681    3          CASE( %STATUS );
      796    24682    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      797    24683    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      798    24684    3            STAF = '0'B;
      799    24685    3            CALL FLB_STATUS_NODES;
      800    24686
      801    24687    3          CASE( %STATUS_FULL );
      802    24688    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      803    24689    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      804    24690    3            STAF = '1'B;
      805    24691    3            CALL FLB_STATUS_NODES;
      806    24692
      807    24693    3          CASE( %REBUILD );
      808    24694    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#
      809    24695    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */
      810    24696    3            BREAK_TASK = 'Rebuilding!';
      811    24697    3            CALL FLB_REBUILD_NODES;
      812    24698
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:23   
      813    24699    3          CASE( %CLOSE );
      814    24700    3            COMMAND_ERROR = '1'B;
      815    24701    3            CALL FLI$RPT_ERR( E_CLOSE_INVALID );
      816    24702    3            IF FPT_EXIT.V.STEPCC# < %MINOR_ERROR
      817    24703    3             THEN FPT_EXIT.V.STEPCC# = %MINOR_ERROR;
      818    24704
      819    24705    3          END;
      820    24706
      821    24707    2         CALL M$DEVICE( ERASE_HEADER )
      822    24708    3          WHENALTRETURN DO;
      823    24709    3            CALL FLI$RPT_ERR;
      824    24710    3            END;
      825    24711    2         CALL FLI$ERROR_SUMMARY;
      826    24712
      827    24713    3         DO WHILE('0'B);
      828    24714    3   TELL_ERROR: ;
      829    24715    3            CALL XUR$ECHOIF( DCBNUM(M$LO) );
      830    24716    3            IF NOT ERR.MON
      831    24717    4             THEN DO;
      832    24718    4               IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR
      833    24719    4                THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR; /* Syntax error        */
      834    24720    4               IF EFT_CMD_PCB.HI_CHAR > 0
      835    24721    4                THEN CALL XUR$ERRPTR( ,DCBNUM(M$DO) );
      836    24722    4               END;
      837    24723    3            IF ERR.ERR# ~= %E$EOF
      838    24724    4             THEN DO;
      839    24725    4               COMMAND_ERROR = '1'B;
      840    24726    4               CALL XUR$ERRMSG( ERR );
      841    24727    4               END;
      842    24728    4             ELSE DO;
      843    24729    4               IF NOT M$READ_FILE$->F$DCB.FCD#
      844    24730    5                THEN DO;              /* Must be EOF on primary command stream   */
      845    24731    5                  CALL XUR$ERRMSG( ERR );
      846    24732    5                  CALL M$EXIT( FPT_EXIT );
      847    24733    5                  END;
      848    24734    4               BREAK_COUNT = 1;            /* Make > 0 to fool code below        */
      849    24735    4               END;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:24   
      850    24736    3            END;
      851    24737    2         IF COMMAND_ERROR AND B$JIT.MODE ~= %M_INT#
      852    24738    3          THEN DO;
      853    24739    3            CALL FLI$RPT_ERR( E_TRY_AGAIN );
      854    24740    3            CALL M$XXX;
      855    24741    3            END;
      856    24742    2         IF COMMAND_ERROR OR BREAK_COUNT > 0
      857    24743    3          THEN DO;
      858    24744    3            IF M$READ_FILE$->F$DCB.FCD#
      859    24745    3             THEN CALL M$CLOSE( CLOSE_READ_FILE )
      860    24746    4                WHENALTRETURN DO;
      861    24747    4                  END;
      862    24748    3            CALL XUR$SETDCBS( DCBNUM(M$SI), );
      863    24749    3            END;
      864    24750    2         IF FIRST_TIME
      865    24751    2          THEN CALL M$EXIT( FPT_EXIT );
      866    24752    2   END;
      867    24753
      868    24754    1   ERROR_OUT: ;
      869    24755    1      CALL FLI$RPT_ERR;
      870    24756    1      CALL FLI$RPT_ERR( E_TRY_AGAIN );
      871    24757    1      CALL M$XXX;
      872    24758
      873    24759        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:25   
      874    24760    1   FLB_OUTPUT_NODES: PROC;
      875    24761        /*F*  NAME: FLB_OUTPUT_NODES
      876    24762              PURPOSE: Process OUTPUT nodes.
      877    24763        */
      878    24764
      879    24765    2   DCL DCB$ PTR AUTO;
      880    24766    2   DCL DCB# SBIN AUTO;
      881    24767    2   DCL FILE_OPEN BIT(1) AUTO;
      882    24768
      883    24769        /****************************************/
      884    24770
      885    24771        /***
      886    24772         *** Close proper file if it's open.
      887    24773         ***/
      888    24774
      889    24775    2      IF COMMAND = %OUTPUT
      890    24776    3       THEN DO;
      891    24777    3         DCB$ = M$LO$;
      892    24778    3         DCB# = DCBNUM(M$LO);
      893    24779    3         OPEN_FID.V.ORG# = %UR#;
      894    24780    3         OPEN_FID.V.FUN# = %CREATE#;
      895    24781    3         OPEN_FID.V.EXIST# = %OLDFILE#;
      896    24782    3         OPEN_FID.V.TYPE# = ' ';
      897    24783    3         OPEN_FID.V.ACS# = %SEQUEN#;
      898    24784    3         END;
      899    24785    3       ELSE DO;
      900    24786    3         DCB$ = M$CATALOG$;
      901    24787    3         DCB# = DCBNUM(M$CATALOG);
      902    24788    3         OPEN_FID.V.ORG# = %KEYED#;
      903    24789    3         OPEN_FID.V.FUN# = %UPDATE#;
      904    24790    3         OPEN_FID.V.TYPE# = 'CF';
      905    24791    3         OPEN_FID.V.ACS# = %DIRECT#;
      906    24792    3         END;
      907    24793
      908    24794    2      IF NODE$->OUT$BLK.NSUBLKS <= 0
      909    24795    3       THEN DO;                            /* Tell destination if open           */
      910    24796    3         IF DCB$->F$DCB.FCD#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:26   
      911    24797    3          THEN CALL FLI$RPT_ERR( E_FILE_NAME, DCB# );
      912    24798    3          ELSE CALL FLI$RPT_ERR( E_NO_CATALOG ); /* Only catalog will be closed  */
      913    24799    3         RETURN;
      914    24800    3         END;
      915    24801
      916    24802    2      CLOSE_FID.V.DCB# = DCB#;
      917    24803    2      FILE_OPEN = DCB$->F$DCB.FCD#;
      918    24804    2      IF FILE_OPEN
      919    24805    2       THEN CALL M$CLOSE( CLOSE_FID )
      920    24806    3          WHENALTRETURN DO;
      921    24807    3            CALL FLI$RPT_ERR;
      922    24808    3            END;
      923    24809
      924    24810    2      IF COMMAND = %CATALOG
      925    24811    3       THEN DO;
      926    24812    3         IF NODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %OFF_FILE
      927    24813    4          THEN DO;
      928    24814    4            IF NOT FILE_OPEN               /* Request OFF and already off        */
      929    24815    4             THEN CALL FLI$RPT_ERR( E_CAT_OFF );
      930    24816    4            RETURN;
      931    24817    4            END;
      932    24818    4          ELSE DO;
      933    24819    4            IF FILE_OPEN                   /* Request on already on              */
      934    24820    4             THEN CALL FLI$RPT_ERR( E_MUST_CAT_OFF, DCB# );
      935    24821    4            CATALOG_ONTO = '0'B;
      936    24822    4            END;
      937    24823    3         END;
      938    24824
      939    24825    2      OPEN_FID.V.DCB# = DCB#;
      940    24826
      941    24827        /***
      942    24828         *** Get fid and other options.
      943    24829         ***/
      944    24830
      945    24831    3      DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;
      946    24832    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);
      947    24833    4         DO CASE( SUBNODE$->OUT$BLK.CODE );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:27   
      948    24834    4          CASE( %ON_FILE );
      949    24835    4            OPEN_FID.V.FUN# = %CREATE#;
      950    24836    4            OPEN_FID.V.EXIST# = %ERROR#;
      951    24837    4          CASE( %INTO_FILE );
      952    24838    4            OPEN_FID.V.FUN# = %CREATE#;
      953    24839    4            OPEN_FID.V.EXIST# = %OLDFILE#;
      954    24840    4          CASE( %ONTO_FILE );
      955    24841    4            OPEN_FID.V.FUN# = %CREATE#;
      956    24842    4            OPEN_FID.V.EXIST# = %OLDFILE#;
      957    24843    4            CATALOG_ONTO = '1'B;
      958    24844    4          CASE( %OVER_FILE );
      959    24845    4            OPEN_FID.V.FUN# = %CREATE#;
      960    24846    4            OPEN_FID.V.EXIST# = %NEWFILE#;
      961    24847    4          CASE( %IS_FILE );
      962    24848    4            OPEN_FID.V.FUN# = %IN#;
      963    24849    4          CASE( %OFF_FILE );
      964    24850    4            CALL M$OPEN( OPEN_DEFAULT_LO ) ALTRET( GIVE_IT_UP );
      965    24851    4            CALL M$DEVICE( PAGE_LO ) ALTRET( GIVE_IT_UP );
      966    24852    4          CASE( ELSE );
      967    24853    4            FPT_FID.TEXTFID_ = VECTOR(SUBNODE$->OUT$SYM.TEXT );
      968    24854    4            CALL M$FID( FPT_FID ) ALTRET( ALL_ALTRETS );
      969    24855    4            IF COMMAND = %CATALOG
      970    24856    5             THEN DO;
      971    24857    5               IF OPEN_FID.V.ASN# ~= %FILE#
      972    24858    6                THEN DO;
      973    24859    6                  CALL FLI$RPT_ERR( E_MUST_CAT_DISK );
      974    24860    6                  COMMAND_ERROR = '1'B;
      975    24861    6                  RETURN;
      976    24862    6                  END;
      977    24863    5               END;
      978    24864    4          END;
      979    24865    3         END;
      980    24866
      981    24867    2      IF NOT FMSEC
      982    24868    2       THEN CALL M$RPRIV( SWITCH_FMSEC );
      983    24869    2      CALL M$OPEN( OPEN_FID ) ALTRET( ALL_ALTRETS );
      984    24870    2      IF NOT FMSEC
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:28   
      985    24871    2       THEN CALL M$SPRIV( SWITCH_FMSEC );
      986    24872    2      IF COMMAND = %OUTPUT
      987    24873    2       THEN CALL M$DEVICE( PAGE_LO ) ALTRET( ALL_ALTRETS );
      988    24874    3       ELSE DO;
      989    24875    3         IF DCB$->F$DCB.TYPE# ~= 'CF' OR DCB$->F$DCB.ORG# ~= %KEYED#
      990    24876    4          THEN DO;
      991    24877    4            CALL FLI$RPT_ERR( E_MUST_BE_CAT_FILE );
      992    24878    4            CALL M$CLOSE( CLOSE_FID )
      993    24879    5             WHENALTRETURN DO;
      994    24880    5               CALL FLI$RPT_ERR;
      995    24881    5               END;
      996    24882    4            END;
      997    24883    3         END;
      998    24884    2      RETURN;
      999    24885
     1000    24886    2   ALL_ALTRETS: ;
     1001    24887    2      IF NOT FMSEC
     1002    24888    2       THEN CALL M$SPRIV( SWITCH_FMSEC );
     1003    24889    2      COMMAND_ERROR = '1'B;
     1004    24890    2      CALL FLI$RPT_ERR;
     1005    24891    2      IF COMMAND ~= %OUTPUT
     1006    24892    2       THEN RETURN;
     1007    24893    2      CALL M$OPEN( OPEN_DEFAULT_LO ) ALTRET( GIVE_IT_UP );
     1008    24894    2      CALL M$DEVICE( PAGE_LO ) ALTRET( GIVE_IT_UP );
     1009    24895    2      RETURN;
     1010    24896
     1011    24897    2   GIVE_IT_UP: ;
     1012    24898    2      CALL FLI$RPT_ERR;
     1013    24899    2      CALL FLI$RPT_ERR( E_TRY_AGAIN );
     1014    24900    2      CALL M$XXX;
     1015    24901
     1016    24902    2   END FLB_OUTPUT_NODES;
     1017    24903        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:29   
     1018    24904    1   FLB_WHERE_NODES: PROC;
     1019    24905        /*F*  NAME: FLB_WHERE_NODES
     1020    24906              PURPOSE: Process WHERE command.
     1021    24907        */
     1022    24908
     1023    24909        /****************************************/
     1024    24910
     1025    24911    2      CALL FLB_DISK_SPEC(0)
     1026    24912    3       WHENALTRETURN DO;
     1027    24913    3         END;
     1028    24914
     1029    24915    2      IF COMMAND_ERROR THEN RETURN;
     1030    24916
     1031    24917    2      CALL FLW$WHERE;
     1032    24918    2      RETURN;
     1033    24919
     1034    24920    2   END FLB_WHERE_NODES;
     1035    24921        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:30   
     1036    24922    1   FLB_READ_NODES: PROC;
     1037    24923        /*F*  NAME: FLB_READ_NODES
     1038    24924              PURPOSE: Process READ nodes.
     1039    24925        */
     1040    24926
     1041    24927        /****************************************/
     1042    24928
     1043    24929        /***
     1044    24930         *** Close proper file if it's open.
     1045    24931         ***/
     1046    24932
     1047    24933    2      IF M$READ_FILE$->F$DCB.FCD#
     1048    24934    2       THEN CALL M$CLOSE( CLOSE_READ_FILE )
     1049    24935    3          WHENALTRETURN DO;
     1050    24936    3            CALL FLI$RPT_ERR;
     1051    24937    3            END;
     1052    24938    2      OPEN_FID.V.FUN# = %IN#;
     1053    24939    2      OPEN_FID.V.DCB# = DCBNUM(M$READ_FILE);
     1054    24940
     1055    24941        /***
     1056    24942         *** Get fid and other options.
     1057    24943         ***/
     1058    24944
     1059    24945    2      FPT_FID.TEXTFID_ = VECTOR(NODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     1060    24946    2      CALL M$FID( FPT_FID ) ALTRET( ALL_ALTRETS );
     1061    24947
     1062    24948    2      IF NOT FMSEC
     1063    24949    2       THEN CALL M$RPRIV( SWITCH_FMSEC );
     1064    24950    2      CALL M$OPEN( OPEN_FID ) ALTRET( ALL_ALTRETS );
     1065    24951    2      IF NOT FMSEC
     1066    24952    2       THEN CALL M$SPRIV( SWITCH_FMSEC );
     1067    24953    2      CALL XUR$SETDCBS( DCBNUM(M$READ_FILE), );
     1068    24954    2      RETURN;
     1069    24955
     1070    24956    2   ALL_ALTRETS: ;
     1071    24957    2      IF NOT FMSEC
     1072    24958    2       THEN CALL M$SPRIV( SWITCH_FMSEC );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:31   
     1073    24959    2      COMMAND_ERROR = '1'B;
     1074    24960    2      CALL FLI$RPT_ERR;
     1075    24961    2      CALL XUR$SETDCBS( DCBNUM(M$SI), );
     1076    24962    2      RETURN;
     1077    24963
     1078    24964    2   END FLB_READ_NODES;
     1079    24965        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:32   
     1080    24966
     1081    24967    1   FLB_TAPE_NODES: PROC;
     1082    24968        /*F*  NAME: FLB_TAPE_NODES
     1083    24969              PURPOSE: Process tape-related commands.
     1084    24970        */
     1085    24971
     1086    24972    2   DCL DCB$ PTR AUTO;
     1087    24973    2   DCL DCB# UBIN AUTO;
     1088    24974    2   DCL DCB_NUM UBIN AUTO;
     1089    24975    2   DCL NBR_RUNS UBIN AUTO;
     1090    24976    2   DCL TAPE_FSN UBIN AUTO;
     1091    24977    2   DCL TAPE_DENSITY UBIN AUTO;
     1092    24978    2   DCL TAPE_IOERROK BIT(1) AUTO;
     1093    24979    2   DCL NEW_REBUILD BIT(1) AUTO;
     1094    24980        %VLP_VECTOR (FPTN = FIT_,
     1095    24981                     STCLASS = AUTO);
     1096    24996        %VLP_ERRCODE (FPTN = ERR,
     1097    24997                        STCLASS = AUTO);
     1098    25042
     1099    25043        /****************************************/
     1100    25044
     1101    25045    2      IF COMMAND ~= %REBUILD THEN CALL FLB_TAPE_OD_SPEC
     1102    25046    3          WHENRETURN DO;
     1103    25047          /***
     1104    25048           *** The following code "undoes" the initial serial number list
     1105    25049           *** from the tape [destination] list.
     1106    25050           ***/
     1107    25051    3            SOURCE_TAPE_SNLIST$ = SNLISTINFO.SNLIST$;
     1108    25052    3            TVECTOR = VECTOR(SOURCE_TAPE_SNLIST$->VLP_SN);
     1109    25053    3            TVECTOR.W1.VSIZE# = LENGTHV(VLP_SN.NUM#)
     1110    25054    3              + SOURCE_TAPE_SNLIST$->VLP_SN.NUM# * LENGTHC(VLP_SN.SN#(0));
     1111    25055    3            TAPE_OPEN.SN_ = TVECTOR;
     1112    25056    3            LAST_SNLISTINFO$ = ADDR(NIL);
     1113    25057    3            NBR_SNLISTS = 0;
     1114    25058    3            IF COMMAND = %RETRIEVE
     1115    25059        /***
     1116    25060         *** If a file is spec'd for an OD retrieve, create command with FSN spec'd so
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:33   
     1117    25061         *** that only that FSN is opened when retrieving the file. If a
     1118    25062         *** FSN is not used to find a file, then many opens starting at the beginning
     1119    25063         *** of a volume must be executed in order to find the file. File specif. not
     1120    25064        *** permitted for tape retrieves.
     1121    25065        ***/
     1122    25066    4             THEN DO;
     1123    25067    4               IF NODE$->OUT$BLK.NSUBLKS > 1
     1124    25068    4                 AND NODE$->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE = %DISK_FILE_SPEC
     1125    25069    5                THEN DO;
     1126    25070    5                  CALL FLB_CREATE_RETRIEVE_CMNDS;
     1127    25071    5                  RETURN;
     1128    25072    5                  END;
     1129    25073    4               END;
     1130    25074    3            END;
     1131    25075    3          WHENALTRETURN DO;
     1132    25076    3            IF NBR_SNLISTS = 0
     1133    25077    3             THEN IF COMMAND = %CHECK
     1134    25078    4                THEN DO;
     1135    25079    4                  TAPE_OPEN.SN_ = VECTOR(ERASE);
             25079                           /* Didn't find option, but that's okay */
     1136    25080    4                  COMMAND_ERROR = '0'B;
     1137    25081    4                  END;
     1138    25082    3                ELSE IF COMMAND = %RETRIEVE
     1139    25083    4                   THEN DO;
     1140    25084    4                     IF NODE$->OUT$BLK.NSUBLKS > 0 /* Process options , if any   */
     1141    25085    5                      THEN DO;
     1142    25086    6                        DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;
     1143    25087    6                           SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);
     1144    25088    7                           DO CASE( SUBNODE$->OUT$BLK.CODE );
     1145    25089    7                            CASE( %TAPE_OPTIONS );
     1146    25090    8                              DO SUBSUBNODEX = 0 TO SUBNODE$->OUT$BLK.NSUBLKS - 1;
     1147    25091    8                                 SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX);
     1148    25092    9                                 DO CASE( SUBSUBNODE$->OUT$BLK.CODE );
     1149    25093    9                                  CASE( %IOERRORCY );
     1150    25094    9                                    TAPE_OPTION.IOERRORC = '1'B;
     1151    25095    9                                    TAPE_OPEN.V.IOERROK# = '1'B;
     1152    25096    9                                  CASE( %IOERRORCN );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:34   
     1153    25097    9                                    TAPE_OPTION.IOERRORC = '0'B;
     1154    25098    9                                    TAPE_OPEN.V.IOERROK# = '0'B;
     1155    25099    9                                  CASE( %DUPLICATE_TAPESET );
     1156    25100    9                                    CALL FLI$RPT_ERR ( E_DUP_TAPESET );
     1157    25101    9                                    COMMAND_ERROR = '1'B;
     1158    25102    9                                    RETURN;
     1159    25103    9                                  END;
     1160    25104    8                                 END;
     1161    25105    7                            END;
     1162    25106    6                           END;
     1163    25107    5                        END;
     1164    25108    4                     CALL FLB_CREATE_RETRIEVE_CMNDS;
     1165    25109    4                     RETURN;
     1166    25110    4                     END;
     1167    25111    3            END;
     1168    25112
     1169    25113    3      DO CASE( COMMAND );
     1170    25114
     1171    25115    3       CASE( %CHECK, %RESTORE, %RETRIEVE );
     1172    25116    3         CALL FLB_DISK_DEST
     1173    25117    4          WHENRETURN DO;
     1174    25118    4            CALL FLB_DISK_SPEC(0)
     1175    25119    5             WHENRETURN DO;
     1176    25120    5               IF COMMAND_ERROR THEN RETURN;
     1177    25121    5               CALL FLM$MOVE( COMMAND )
     1178    25122    6                WHENALTRETURN DO;
     1179    25123    6                  IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR
     1180    25124    6                   THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;
     1181    25125    6                  END;
     1182    25126    5               CALL FLI$STATS;
     1183    25127    5               END;
     1184    25128    4            END;
     1185    25129
     1186    25130    3       CASE( %REWIND );
     1187    25131    3         IF COMMAND_ERROR THEN RETURN;
     1188    25132    3         CALL FLI$DISMNT_TAPES( SOURCE_TAPE_SNLIST$, %PTV# );
     1189    25133
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:35   
     1190    25134    3       CASE( %REMOVE );
     1191    25135    3         IF COMMAND_ERROR THEN RETURN;
     1192    25136    3         CALL FLI$DISMNT_TAPES( SOURCE_TAPE_SNLIST$, %REM# );
     1193    25137
     1194    25138    3       CASE( %MOUNT );
     1195    25139    3         IF COMMAND_ERROR THEN RETURN;
     1196    25140    3         TAPE_OPEN.V.OPER.MNTONLY# = %YES#;
     1197    25141    3         TAPE_OPEN.V.DCB# = DCBNUM(M$TAPE00);
     1198    25142    3         BREAK_DCB# = DCBNUM(M$TAPE00);
     1199    25143    3         BREAK_CONTINUED = '1'B;
     1200    25144    4         DO WHILE( BREAK_CONTINUED );
     1201    25145    4            BREAK_CONTINUED = '0'B;
     1202    25146    4            CALL M$OPEN( TAPE_OPEN )
     1203    25147    5             WHENALTRETURN DO;
     1204    25148    5               CALL FLI$RPT_ERR;
     1205    25149    5               IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$MNTBRK
     1206    25150    5                 AND BREAK_CONTINUED
     1207    25151    5                THEN ;
     1208    25152    5                ELSE COMMAND_ERROR = '1'B;
     1209    25153    5               END;
     1210    25154    4            END;
     1211    25155    3         TAPE_OPEN.V.INITZ.SCRUB# = '0'B;
     1212    25156
     1213    25157    3       CASE( %REBUILD );
     1214    25158
     1215    25159    3         OVER_FIL = '1'B;
     1216    25160    3         TAPE_OPTION.PROTTYPE = %UNPROTECTED;
     1217    25161    3         DISK_DEST_EXIST = %NEWFILE#;
     1218    25162
     1219    25163        /***
     1220    25164         *** Copy :BACKUP file from the specified tape,fid or packset being restored to
     1221    25165         *** the *:BACKUP file on disk. If non-existant, terminate the rebuild process.
     1222    25166         ***/
     1223    25167    3         CALL FLB_READ_BACKUP ALTRET(REBUILD_ERR10);
     1224    25168    3         TAPE_FSN = 0;
     1225    25169
     1226    25170        /***
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:36   
     1227    25171         *** Determine if this is a rebuild continuation due to an interruption
     1228    25172         *** while a rebuild was in progress (system crash or tape errors), or
     1229    25173         *** a new rebuild. Determination is based upon whether :REBUILD exists in $$EFT.
     1230    25174         *** If a continuation, obtain required data from :REBUILD.
     1231    25175         ***/
     1232    25176    3         OPEN_REBUILD.V.FUN# = %UPDATE#;
     1233    25177    3         CALL M$OPEN( OPEN_REBUILD )
     1234    25178    4          WHENRETURN DO;
     1235    25179    4            NEW_REBUILD = '0'B;            /* Continued rebuild                  */
     1236    25180    4            CALL FLI$RPT_ERR(E_REBUILD_CONTINUE); /* Inform user of continuation */
     1237    25181    4            READ_REBUILD.KEY_ = VECTOR(REBUILD_KEY);
     1238    25182    4            CALL M$READ ( READ_REBUILD ) ALTRET(REBUILD_ERR);
     1239    25183    4            DISK_FILE_SPEC.NBR = 1;
     1240    25184    4            DISK_FILE_SPEC.SPEC.START.ACCT.ACCT#(0) = REBUILD_BUF.START.ACCT.ACCT#;
     1241    25185    4            DISK_FILE_SPEC.SPEC.START.FILE.L#(0) = REBUILD_BUF.START.FILE.L#;
     1242    25186    4            DISK_FILE_SPEC.SPEC.START.FILE.NAME#(0) = REBUILD_BUF.START.FILE.NAME#;
     1243    25187    4            TAPE_OPEN.V.VOL# = REBUILD_BUF.VOLUME;
     1244    25188    4            TAPE_OPEN.V.FSN# = REBUILD_BUF.FSN;
     1245    25189    4            TAPE_FSN = REBUILD_BUF.FSN;
     1246    25190    4            TAPE_OPEN.V.DENSITY# = REBUILD_BUF.DEN;
     1247    25191    4            TAPE_OPEN.V.IOERROK# = REBUILD_BUF.IOERRORC;
     1248    25192    4            DISK_OPTION.PAD = REBUILD_BUF.PAD;
     1249    25193    4            DISK_OPTION.DIR = REBUILD_BUF.DIR;
     1250    25194    4            TAPE_OPTION.IOERRORC = REBUILD_BUF.IOERRORC;
     1251    25195    4            END;
     1252    25196    4          WHENALTRETURN DO;
     1253    25197    4            NEW_REBUILD = '1'B;            /* Brand new rebuild                  */
     1254    25198    4            OPEN_REBUILD.V.EXIST# = %NEWFILE#;
     1255    25199    4            OPEN_REBUILD.V.FUN# = %CREATE#;
     1256    25200    4            OPEN_REBUILD.V.EXPIRE# = %NEVER#;
     1257    25201    4            CALL M$OPEN( OPEN_REBUILD )    /* Create :REBUILD                    */
     1258    25202    5             WHENALTRETURN DO;
     1259    25203    5               IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$NONEWFD
     1260    25204    6                THEN DO;                   /* Create $$EFT account               */
     1261    25205    6                  CALL FLI$BUILD_$$EFT( REBUILD_SN.SN#(0) ) ALTRET(REBUILD_ERR);
     1262    25206    6                  CALL M$OPEN( OPEN_REBUILD ) ALTRET(REBUILD_ERR);
             25206                           /* Create :REBUILD */
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:37   
     1263    25207    6                  END;
     1264    25208    6                ELSE DO;
     1265    25209    6                  GOTO REBUILD_ERR;
     1266    25210    6                  END;
     1267    25211    5               END;
     1268    25212    4            CLOSE_REBUILD.V.DISP# = %SAVE#;
     1269    25213    4            CALL M$CLOSE( CLOSE_REBUILD ) ALTRET(REBUILD_ERR);
     1270    25214    4            OPEN_REBUILD.V.FUN# = %UPDATE#; /* :REBUILD expected to be open      */
     1271    25215    4            CALL M$OPEN( OPEN_REBUILD ) ALTRET(REBUILD_ERR);
     1272    25216    4            END;
     1273    25217
     1274    25218    3         READ_REBUILD.KEY_ = VECTOR(REBUILD_DIR_KEY);
     1275    25219    3         TAPE_DENSITY = TAPE_OPEN.V.DENSITY#; /* Save option setting - DEN       */
     1276    25220    3         TAPE_IOERROK = TAPE_OPEN.V.IOERROK#; /* Save option setting - IOERROK   */
     1277    25221        /***
     1278    25222         *** Read *:BACKUP record 0 to obtain number of runs - save and backups performed.
     1279    25223         ***/
     1280    25224
     1281    25225    3         OPEN_BACKUP_TEMP.V.FUN# = %IN#;
     1282    25226    3         CALL M$OPEN( OPEN_BACKUP_TEMP ) ALTRET(REBUILD_ERR);
     1283    25227    3         READ_BACKUP_TEMP.V.KEYS# = '0'B;
     1284    25228    3         CALL M$READ( READ_BACKUP_TEMP ) ALTRET(REBUILD_ERR);
     1285    25229    3         NBR_RUNS = TSN_USED_BUF.UTS;      /* Number of runs                     */
     1286    25230
     1287    25231        /***
     1288    25232         *** Read *:BACKUP records for each run to obtain tape serial numbers and restore.
     1289    25233         *** Run 1=save run; run 2-n = backup runs.
     1290    25234         ***/
     1291    25235    4         DO I = 1 TO NBR_RUNS;
     1292    25236    4            CALL M$READ( READ_BACKUP_TEMP ) ALTRET(REBUILD_ERR);
     1293    25237    4            IF TSN_USED_BUF.BACKUP_FSN ~= 0 /* Get FSN for last file to process  */
     1294    25238    4             THEN LAST_TAPE_FSN = TSN_USED_BUF.BACKUP_FSN; /* Eliminate test after */
     1295    25239    4             ELSE LAST_TAPE_FSN = TSN_USED_BUF.FSN + 1; /* E03. Should never = 0 */
     1296    25240
     1297    25241    4            CALL FLB_BUILD_SNLIST; /* Create serial number list for current run  */
     1298    25242        /***
     1299    25243         *** Remove :BACKUP file source tape or last tape from previous run if not
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:38   
     1300    25244         *** required as the first tape for this run.
     1301    25245         ***/
     1302    25246    4            IF (SOURCE_TAPE_SNLIST$ ~= ADDR(NIL))
     1303    25247    4              AND (M$TAPE00$->F$DCB.PSN# ~= SNLISTINFO.SNLIST$->VLP_SN.SN#(0))
     1304    25248    5             THEN DO;
     1305    25249    5               FPT_REM.V.DISP# = %REM#;
     1306    25250    5               FPT_REM.V.PSN# = M$TAPE00$->F$DCB.PSN#;
     1307    25251    5               CALL M$REM ( FPT_REM )
     1308    25252    6                WHENALTRETURN DO;
     1309    25253    6                  END;
     1310    25254    5               TAPE_FSN = 0;               /* New tape                           */
     1311    25255    5               CALL FLB_SET_TAPE_DEFAULTS( TAPE_DENSITY,TAPE_FSN ,
     1312    25256    5                 LAST_TAPE_FSN, TAPE_IOERROK );
     1313    25257    5               END;
     1314    25258    5             ELSE DO;
     1315    25259        /***
     1316    25260         *** If :BACKUP was read from tape or fid for 1st run, start with FSN 0 (first
     1317    25261         *** tape to be proc.). Otherwise incr. FSN for processing next tape in sequence
     1318    25262         *** such as for a backup run.
     1319    25263        */
     1320    25264    5               IF (SOURCE_TAPE_SNLIST$ ~= ADDR(NIL))
     1321    25265    6                THEN DO;
     1322    25266    6                  IF I ~= 1
     1323    25267    6                   THEN TAPE_FSN = M$TAPE00$->F$DCB.FSN# + 1; /* Backup run      */
     1324    25268    6                  CALL FLB_SET_TAPE_DEFAULTS( TAPE_DENSITY,TAPE_FSN,
     1325    25269    6                    LAST_TAPE_FSN, TAPE_IOERROK );
     1326    25270    6                  END;
     1327    25271    6                ELSE DO;                   /* :BACKUP read from fid              */
     1328    25272    6                  TAPE_FSN = 0;
     1329    25273    6                  CALL FLB_SET_TAPE_DEFAULTS( TAPE_DENSITY,TAPE_FSN,
     1330    25274    6                    LAST_TAPE_FSN, TAPE_IOERROK );
     1331    25275    6                  END;
     1332    25276    5               END;
     1333    25277    4            SOURCE_TAPE_SNLIST$ = SNLISTINFO.SNLIST$;
     1334    25278    4            TVECTOR = VECTOR(SOURCE_TAPE_SNLIST$->VLP_SN);
     1335    25279    4            TVECTOR.W1.VSIZE# = LENGTHV(VLP_SN.NUM#)
     1336    25280    4              + SOURCE_TAPE_SNLIST$->VLP_SN.NUM# * LENGTHC(VLP_SN.SN#(0));
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:39   
     1337    25281    4            TAPE_OPEN.SN_ = TVECTOR;
     1338    25282    4            LAST_SNLISTINFO$ = ADDR(NIL);
     1339    25283    4            NBR_SNLISTS = 0;
     1340    25284
     1341    25285    4            CALL FLM$MOVE( %REBUILD )      /* Restore current run                */
     1342    25286    5             WHENALTRETURN DO;
     1343    25287    5               IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR
     1344    25288    5                THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;
     1345    25289    5               FPT_REM.V.DISP# = %PTV#;
     1346    25290    5               FPT_REM.V.PSN# = DCBADDR(DCBNUM(M$TAPE00))->F$DCB.PSN#;
     1347    25291    5               CALL M$REM( FPT_REM )
     1348    25292    6                WHENALTRETURN DO;
     1349    25293    6                  END;
     1350    25294    5               CLOSE_BACKUP_TEMP.V.DISP# = %RELEASE#; /* Delete *:BACKUP file    */
     1351    25295    5               CALL M$CLOSE( CLOSE_BACKUP_TEMP ) ALTRET(REBUILD_ERR);
     1352    25296    5               CALL FLI$STATS;
     1353    25297    5               RETURN;                     /* Problem - terminate rebuild        */
     1354    25298    5               END;
     1355    25299
     1356    25300    4            END;                           /* Rebuild loop end                   */
     1357    25301
     1358    25302
     1359    25303    3         FPT_REM.V.DISP# = %REM#;          /* Remove last tape used              */
     1360    25304    3         FPT_REM.V.PSN# = M$TAPE00$->F$DCB.PSN#;
     1361    25305    3         CALL M$REM( FPT_REM )
     1362    25306    4          WHENALTRETURN DO;
     1363    25307    4            END;
     1364    25308
     1365    25309    3         CLOSE_BACKUP_TEMP.V.DISP# = %RELEASE#; /* Delete *:BACKUP file          */
     1366    25310    3         CALL M$CLOSE( CLOSE_BACKUP_TEMP ) ALTRET(REBUILD_ERR);
     1367    25311        /***
     1368    25312         **** Rebuild went to completition, o.k. to delete :REBUILD.$$EFT file.
     1369    25313         ***/
     1370    25314    3         CLOSE_REBUILD.V.DISP# = %RELEASE#;
     1371    25315    3         CALL M$CLOSE( CLOSE_REBUILD ) ALTRET(REBUILD_ERR);
     1372    25316    3         CALL FLI$STATS;
     1373    25317    3         RETURN;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:40   
     1374    25318
     1375    25319    3   REBUILD_ERR:
     1376    25320    3         CALL FLI$RPT_ERR;
     1377    25321    3   REBUILD_ERR10:
     1378    25322    3         IF DCBADDR(DCBNUM(M$DISK00)) -> F$DCB.FCD#
     1379    25323    4          THEN DO;
     1380    25324    4            CLOSE_BACKUP_TEMP.V.DISP# = %RELEASE#; /* Delete *:BACKUP            */
     1381    25325    4            CALL M$CLOSE(CLOSE_BACKUP_TEMP);
     1382    25326    4            END;
     1383    25327    3         IF DCBADDR(DCBNUM(M$REBUILD)) -> F$DCB.FCD#
     1384    25328    4          THEN DO;
     1385    25329    4            IF NEW_REBUILD
     1386    25330    5             THEN DO;
     1387    25331    5               CLOSE_REBUILD.V.DISP# = %RELEASE#;
     1388    25332    5               CALL M$CLOSE( CLOSE_REBUILD );
     1389    25333    5               END;
     1390    25334    5             ELSE DO;
     1391    25335    5               CLOSE_REBUILD.V.DISP# = %SAVE#;
     1392    25336    5               CALL M$CLOSE( CLOSE_REBUILD );
     1393    25337    5               END;
     1394    25338    4            END;
     1395    25339    3         IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR
     1396    25340    3          THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;
     1397    25341    3         COMMAND_ERROR = '1'B;
     1398    25342
     1399    25343    3       END;
     1400    25344
     1401    25345    2   JUSTRET: ;
     1402    25346    2      RETURN;
     1403    25347
     1404    25348
     1405    25349    2   FLB_CREATE_RETRIEVE_CMNDS: PROC;
     1406    25350        /*F*  NAME: FLB_CREATE_RETRIEVE_CMNDS
     1407    25351              PURPOSE: Create RETRIEVE commands for subsequent processing.
     1408    25352        ***/
     1409    25353
     1410    25354        /********************/
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:41   
     1411    25355
     1412    25356    3      COMMAND_ERROR = '0'B;
     1413    25357    3      CALL FLB_DISK_SPEC(0)
     1414    25358    4       WHENRETURN DO;
     1415    25359    4         IF COMMAND_ERROR THEN RETURN;
     1416    25360    4         DISK_SRCHCOND.ANYF# = '0'B;
     1417    25361    4         DISK_SRCHCOND.QS# = '1'B;
     1418    25362    4         DISK_CRIT.DSC = '1'B;
     1419    25363    4         DISK_DESC.FETCH# = '1'B;
     1420    25364    4         DISK_DESC_MASK.FETCH# = '1'B;
     1421    25365    4         CALL FLV$VALIDATE( COMMAND ) ALTRET( JUSTCERET );
     1422    25366    4         CALL FLS$PROCESS_PRE_RET
     1423    25367    5          WHENALTRETURN DO;
     1424    25368    5   JUSTCERET:;
     1425    25369    5            COMMAND_ERROR = '1'B;
     1426    25370    5            RETURN;
     1427    25371    5            END;
     1428    25372    4         CALL M$OPEN( RET_CMDS_OPEN )
     1429    25373    5          WHENALTRETURN DO;
     1430    25374    5            CALL FLI$RPT_ERR;
     1431    25375    5            COMMAND_ERROR = '1'B;
     1432    25376    5            RETURN;
     1433    25377    5            END;
     1434    25378    4         CALL XUR$SETDCBS( DCBNUM(M$READ_FILE) );
     1435    25379    4         END;
     1436    25380    3      RETURN;
     1437    25381
     1438    25382    3   END FLB_CREATE_RETRIEVE_CMNDS;
     1439    25383    2   END FLB_TAPE_NODES;
     1440    25384        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:42   
     1441    25385
     1442    25386    1   FLB_REQUALIFY_NODES: PROC;
     1443    25387        /*F*  NAME: FLB_REQUALIFY_NODES
     1444    25388              PURPOSE: Process REQUALIFY command.
     1445    25389        */
     1446    25390
     1447    25391        /****************************************/
     1448    25392
     1449    25393    2      CALL FLB_DISK_SPEC(0)
     1450    25394    3       WHENALTRETURN DO;
     1451    25395    3         END;
     1452    25396
     1453    25397    2      IF COMMAND_ERROR THEN RETURN;
     1454    25398
     1455    25399    2      NEW_DISK_DESC = '0'B;
     1456    25400    2      IF COMMAND = %REQUALIFY_ARCHIVE
     1457    25401    2       THEN NEW_DISK_DESC.QS# = '1'B;
     1458    25402    2       ELSE NEW_DISK_DESC.BUF# = '1'B;
     1459    25403    2      CALL FLR$REQUALIFY;
     1460    25404    2      CALL FLI$STATS;
     1461    25405    2      RETURN;
     1462    25406
     1463    25407    2   END FLB_REQUALIFY_NODES;
     1464    25408        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:43   
     1465    25409
     1466    25410    1   FLB_STOW_FETCH_NODES: PROC;
     1467    25411        /*F*  NAME: FLB_STOW_FETCH_NODES
     1468    25412              PURPOSE: Process STOW, UNSTOW, FETCH, UNFETCH, UNARCHIVE commands.
     1469    25413        */
     1470    25414
     1471    25415    2   DCL SUBNODEY SBIN;
     1472    25416    2   DCL INCR SBIN;
     1473    25417
     1474    25418        /****************************************/
     1475    25419
     1476    25420    2      SUBNODEY = 0;
     1477    25421    2      INCR = 0;
     1478    25422    3      DO SUBNODEY = 0 TO  NODE$->OUT$BLK.NSUBLKS -1;
     1479    25423
     1480    25424    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEY); /* Break up the fid         */
     1481    25425    3         FPT_FID.TEXTFID_ = VECTOR(SUBNODE$->OUT$SYM.TEXT);
     1482    25426    3         CALL M$FID(FPT_FID)
     1483    25427    4          WHENRETURN DO;
     1484    25428    4            IF FPT_FID_RESULTS.NAME
     1485    25429    5             THEN DO;
     1486    25430    5               CALL FLB_DISK_SPEC(SUBNODEY)
     1487    25431    6                WHENALTRETURN DO;
     1488    25432    6                  END;
     1489    25433
     1490    25434    5               IF COMMAND_ERROR THEN RETURN;
     1491    25435
     1492    25436    5               IF COMMAND = %STOW_INACTIVE
     1493    25437    5                THEN DISK_OPTION.INACTIVATE = '1'B;
     1494    25438
     1495    25439    5               CALL FLS$STOW_FETCH ( COMMAND );
     1496    25440
     1497    25441    5               DPLIST$ = ADDR(ZERO);       /* Reinit. for each fid               */
     1498    25442    5               ACCT.ACCT# = ' ';
     1499    25443    5               PREV_ACCT.ACCT# = ' ';
     1500    25444    5               FIRST_ACCT_SPECIFIED.ACCT# = ' ';
     1501    25445    5               END;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:44   
     1502    25446    5             ELSE DO;
     1503    25447    5               CALL FLI$RPT_ERR (E_NO_FILE );
     1504    25448    5               END;
     1505    25449    4            END;
     1506    25450    4          WHENALTRETURN DO;
     1507    25451    4            CALL FLI$RPT_ERR;
     1508    25452    4            END;
     1509    25453    3         END;
     1510    25454
     1511    25455    2      RETURN;
     1512    25456
     1513    25457    2   END FLB_STOW_FETCH_NODES;
     1514    25458        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:45   
     1515    25459
     1516    25460    1   FLB_VALIDATE_NODES: PROC;
     1517    25461        /*F*  NAME: FLB_VALIDATE_NODES
     1518    25462              PURPOSE: Process VALIDATE command.
     1519    25463        */
     1520    25464
     1521    25465        /****************************************/
     1522    25466
     1523    25467    2      CALL FLB_DISK_SPEC(0)
     1524    25468    3       WHENALTRETURN DO;
     1525    25469    3         END;
     1526    25470
     1527    25471    2      IF COMMAND_ERROR THEN RETURN;
     1528    25472
     1529    25473    2      CALL FLV$VALIDATE( COMMAND );
     1530    25474    2      CALL FLI$STATS;
     1531    25475    2      RETURN;
     1532    25476
     1533    25477    2   END FLB_VALIDATE_NODES;
     1534    25478        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:46   
     1535    25479
     1536    25480    1   FLB_ADDREM_NODES: PROC;
     1537    25481        /*F*  NAME: FLB_ADDREM_NODES
     1538    25482              PURPOSE: Process ADD and REMOVE commands.
     1539    25483        */
     1540    25484
     1541    25485        /****************************************/
     1542    25486
     1543    25487    2      CALL FLB_DISK_SPEC(0)
     1544    25488    3       WHENALTRETURN DO;
     1545    25489    3         END;
     1546    25490    2      CALL FLB_DISK_DEST
     1547    25491    3       WHENALTRETURN DO;
     1548    25492    3         END;
     1549    25493    2      IF COMMAND_ERROR THEN RETURN;
     1550    25494
     1551    25495         /***
     1552    25496          *** Command is fine.  Go for it.
     1553    25497          ***/
     1554    25498
     1555    25499    2      CALL FLE$ESTMOD( COMMAND );
     1556    25500    2      RETURN;
     1557    25501
     1558    25502    2   END FLB_ADDREM_NODES;
     1559    25503        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:47   
     1560    25504
     1561    25505    1   FLB_DUAL_NODES: PROC;
     1562    25506        /*F*  NAME: FLB_DUAL_NODES
     1563    25507              PURPOSE: Process DUAL command.
     1564    25508        */
     1565    25509
     1566    25510        /****************************************/
     1567    25511
     1568    25512    2      CALL FLB_DISK_SPEC(0)
     1569    25513    3       WHENALTRETURN DO;
     1570    25514    3         END;
     1571    25515    2      IF COMMAND_ERROR THEN RETURN;
     1572    25516    2      CALL FLB_DISK_DEST
     1573    25517    3       WHENRETURN DO;
     1574    25518    3         END;
     1575    25519    2      IF COMMAND_ERROR THEN RETURN;
     1576    25520
     1577    25521    2      IF COMMAND = %DUAL_INCREMENTAL
     1578    25522    2       THEN TAPE_OPTION.PROTTYPE = %INCREMENTAL;
     1579    25523
     1580    25524         /***
     1581    25525          *** Command is fine.  Go for it.
     1582    25526          ***/
     1583    25527
     1584    25528        /* To make sure the DUAL pack will have enough space for the DUAL   */
     1585    25529        /* we have to delete from DUAL pack files that were deleted    */
     1586    25530        /* from the PRIME pack since the last DUAL.  Two passes are needed.  */
     1587    25531
     1588    25532    2      IF COMMAND = %DUAL_INCREMENTAL
     1589    25533    3       THEN DO;
     1590    25534    3         TEMP_DISK_SRCHCOND = DISK_SRCHCOND;
     1591    25535    3         DISK_SRCHCOND = '0'B;
     1592    25536    3         DISK_SRCHCOND.DELF# = '1'B;
     1593    25537    3         CALL FLM$MOVE ( %REAL_DUAL )
     1594    25538    4          WHENALTRETURN DO;
     1595    25539    4            IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR
     1596    25540    4             THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:48   
     1597    25541    4            IF DISK_OPTION.SWITCH_IF_ERRORS
     1598    25542    4             THEN CALL FLI$RPT_ERR ( E_TOO_MANY_ERRORS_TO_SWITCH );
     1599    25543    4            RETURN;
     1600    25544    4            END;
     1601    25545    3         DISK_SRCHCOND = TEMP_DISK_SRCHCOND; /* 2nd pass                         */
     1602    25546    3         END;
     1603    25547    2      CALL FLM$MOVE( %REAL_DUAL )
     1604    25548    3       WHENRETURN DO;
     1605    25549    3         IF DISK_OPTION.SWITCH_IF_ERRORS
     1606    25550    4          THEN DO;
     1607    25551    4            IF TOTAL_ERRORS < ERROR_LIMIT OR
     1608    25552    4              ( TOTAL_ERRORS = 0 AND ERROR_LIMIT = 0 )
     1609    25553    5             THEN DO;
     1610    25554    5               CALL FLM$SWITCH_PRIME_DUAL
     1611    25555    6                WHENALTRETURN DO;
     1612    25556    6                  END;
     1613    25557    5               END;
     1614    25558    4             ELSE CALL FLI$RPT_ERR ( E_TOO_MANY_ERRORS_TO_SWITCH );
     1615    25559    4            END;
     1616    25560    3         END;
     1617    25561    3       WHENALTRETURN DO;
     1618    25562    3         IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR
     1619    25563    3          THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;
     1620    25564    3         END;
     1621    25565    2      CALL FLI$STATS;
     1622    25566    2      RETURN;
     1623    25567
     1624    25568    2   END FLB_DUAL_NODES;
     1625    25569        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:49   
     1626    25570
     1627    25571    1   FLB_SAVE_NODES: PROC;
     1628    25572        /*F*  NAME: FLB_SAVE_NODES
     1629    25573              PURPOSE: Process SAVE command.
     1630    25574        */
     1631    25575
     1632    25576        %VLP_SN( FPTN = PREV_TAPE_SN,
     1633    25577                 N = 1,
     1634    25578                 STCLASS = STATIC );
     1635    25591
     1636    25592        /****************************************/
     1637    25593
     1638    25594    2      CALL FLB_DISK_SPEC(0)
     1639    25595    3       WHENALTRETURN DO;
     1640    25596    3         END;
     1641    25597    2      IF COMMAND_ERROR THEN RETURN;
     1642    25598    2      CALL FLB_TAPE_OD_SPEC
     1643    25599    3       WHENRETURN DO;
     1644    25600    3         IF ( COMMAND = %SAVE OR COMMAND = %BACKUP )
     1645    25601    4          THEN DO;
     1646    25602    4            IF NOT TAPE_OPEN.V.XTEND# /* Check if user spec'd or implied extension */
     1647    25603    5             THEN DO;
     1648    25604        /***
     1649    25605         *** If executing consecutive SAVE or consecutive BACKUP commands to the same
     1650    25606         *** tapeset, perform an automatic extension on the current volume (implied
     1651    25607         *** extension). Used to always use the first volume specified on the next
     1652    25608         *** command line which sometimes resulted in the 1st tape being clobbered if
     1653    25609         *** multiple tapes already written or aborting due to lack of resources.
     1654    25610         ***/
     1655    25611    5               IF ( PREV_COMMAND = %SAVE OR PREV_COMMAND = %BACKUP )
     1656    25612    5                 AND SNLISTINFO.SNLIST$->VLP_SN.SN#(0) = PREV_TAPE_SN.SN#(0)
     1657    25613    5                THEN TAPE_OPEN.V.XTEND# = '1'B;
     1658    25614    5                ELSE CT_IMAGE = ' ';       /* No automatic extension             */
     1659    25615    5               END;
     1660    25616    4            END;
     1661    25617    3          ELSE
     1662    25618    3            CT_IMAGE = ' ';                /* No automatic extension             */
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:50   
     1663    25619    3         END;
     1664    25620    3       WHENALTRETURN DO;
     1665    25621    3         IF NBR_SNLISTS = 0 AND
     1666    25622    3           ( COMMAND = %ARCHIVE_CMD OR COMMAND = %PURGE )
     1667    25623    4          THEN DO;
     1668    25624    4            COMMAND_ERROR = '0'B;
     1669    25625    4            DISK_OPTION.DELETE = '0'B;     /* Don't delete file when archiving   */
     1670    25626    4            CALL FLE$ESTMOD(COMMAND);
     1671    25627    4            END;
     1672    25628    3         END;
     1673    25629    2      IF COMMAND_ERROR THEN RETURN;
     1674    25630
     1675    25631        /***
     1676    25632         *** Save SN spec'd for implied extension test on multiple SAVE,BACKUP commands.
     1677    25633         ***/
     1678    25634    2      IF (COMMAND = %SAVE OR COMMAND = %BACKUP)
     1679    25635    2       THEN
     1680    25636    2         PREV_TAPE_SN.SN#(0) = SNLISTINFO.SNLIST$->VLP_SN.SN#(0);
     1681    25637
     1682    25638         /***
     1683    25639          *** Command is fine.  Go for it.
     1684    25640          ***/
     1685    25641
     1686    25642    2      CALL FLM$MOVE( COMMAND )
     1687    25643    3       WHENRETURN DO;
     1688    25644    3         IF ARCHIVE$ ~= ADDR(NIL) AND
     1689    25645    3           ( COMMAND = %ARCHIVE_CMD OR COMMAND = %PURGE )
     1690    25646    3          THEN
     1691    25647    3            CALL FLE$ESTMOD(%ARCHIVED);
     1692    25648    3         ARCHIVE$ = ADDR(NIL);
     1693    25649    3         END;
     1694    25650    3       WHENALTRETURN DO;
     1695    25651    3         IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR
     1696    25652    3          THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;
     1697    25653    3         END;
     1698    25654    2      CALL FLI$STATS;
     1699    25655    2      RETURN;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:51   
     1700    25656
     1701    25657    2   END FLB_SAVE_NODES;
     1702    25658        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:52   
     1703    25659
     1704    25660    1   FLB_ESTMOD_NODES: PROC;
     1705    25661        /*F*  NAME: FLB_ESTMOD_NODES
     1706    25662              PURPOSE: Process ESTABLISH and MODIFY commands.
     1707    25663        */
     1708    25664
     1709    25665        /****************************************/
     1710    25666
     1711    25667    2      CALL FLB_DISK_SPEC(0)
     1712    25668    3       WHENALTRETURN DO;
     1713    25669    3         END;
     1714    25670    2      CALL FLB_TAPE_OD_SPEC
     1715    25671    3       WHENALTRETURN DO;
     1716    25672    3         END;
     1717    25673    2      IF COMMAND_ERROR THEN RETURN;
     1718    25674
     1719    25675         /***
     1720    25676          *** Command is fine.  Go for it.
     1721    25677          ***/
     1722    25678
     1723    25679    2      CALL FLE$ESTMOD( COMMAND );
     1724    25680    2      RETURN;
     1725    25681
     1726    25682    2   END FLB_ESTMOD_NODES;
     1727    25683        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:53   
     1728    25684    1   FLB_OPEN_NODES:PROC;
     1729    25685        /*F*  NAME:FLB_OPEN_NODES
     1730    25686              PURPOSE: Process OPEN command.
     1731    25687        */
     1732    25688
     1733    25689    2   DCL GRAND_TOTAL_FILES SBIN AUTO;
     1734    25690    2   DCL GRAND_TOTAL_GRANS SBIN AUTO;
     1735    25691    2   DCL GRAND_START_UTS UBIN AUTO;
     1736    25692    2   DCL DEST_TAPE_VOL_SAVE SBIN AUTO;
     1737    25693
     1738    25694        /*********************************************/
     1739    25695
     1740    25696    2      CALL FLB_TRANS_TYPE ;
     1741    25697    3      DO CASE( COMMAND );
     1742    25698
     1743    25699    3       CASE(%OPEN_UPDATE);
     1744    25700    3         STATE = %DUAL;
     1745    25701    3       CASE( %OPEN_CREATE,%OPEN_EXTEND);
     1746    25702    3         STATE = COMMAND;
     1747    25703    3         CALL FLB_TAPE_OD_SPEC
     1748    25704    4          WHENALTRETURN DO;
     1749    25705    4            END;
     1750    25706    3         IF COMMAND = %OPEN_EXTEND
     1751    25707    3          THEN TAPE_OPEN.V.XTEND# = '1'B;
     1752    25708    3       CASE( %OPEN_INPUT);
     1753    25709    3         STATE = %RESTORE;
     1754    25710    3         RESTORE_FROM_TAPE = '1'B;
     1755    25711    3         TAPE_OPTION.OPEN_FUNCTION = %OPEN_INPUT;
     1756    25712    3         CALL FLB_TAPE_OD_SPEC
     1757    25713    4          WHENRETURN DO;
     1758    25714    4            SOURCE_TAPE_SNLIST$ = SNLISTINFO.SNLIST$;
     1759    25715    4            TVECTOR = VECTOR(SOURCE_TAPE_SNLIST$->VLP_SN);
     1760    25716    4            TVECTOR.W1.VSIZE# = LENGTHV(VLP_SN.NUM#)
     1761    25717    4              + SOURCE_TAPE_SNLIST$->VLP_SN.NUM# * LENGTHC(VLP_SN.SN#(0));
     1762    25718    4            TAPE_OPEN.SN_ = TVECTOR;
     1763    25719    4            LAST_SNLISTINFO$ = ADDR(NIL);
     1764    25720    4            NBR_SNLISTS = 0;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:54   
     1765    25721    4            END;
     1766    25722    4          WHENALTRETURN DO;
     1767    25723    4            COMMAND_ERROR = '1'B;
     1768    25724    4            END;
     1769    25725    3       END;
     1770    25726    2      IF COMMAND_ERROR THEN RETURN;
     1771    25727
     1772    25728    2      CHECK_TAPE = TAPE_OPTION.CHECK;
     1773    25729    2      TAPE_OPTION.CHECK = '0'B;            /* Must check when all done           */
     1774    25730    2      GRAND_TOTAL_FILES = 0;
     1775    25731    2      GRAND_TOTAL_GRANS = 0;
     1776    25732    2      DEST_TAPE_VOL_SAVE = 0;
     1777    25733    2      CALL M$TIME( GET_NOW_UTS );
     1778    25734    2      GRAND_START_UTS = NOW_UTS;
     1779    25735    2      DISK_FILE_SPEC$ = ADDR(NIL);
     1780    25736
     1781    25737
     1782    25738    3      DO WHILE('1'B);
     1783    25739    3         BREAK_CONTINUED = '0'B;
     1784    25740    3         BREAK_DCB# = 0;
     1785    25741    3         OVER_FIL = '0'B;
     1786    25742    3         IF MODE = %TRANSFER
     1787    25743    3          THEN BREAK_TASK = 'Transferring!';
     1788    25744    3          ELSE BREAK_TASK = 'Transporting!';
     1789    25745    3         CALL XUR$GETCMD(EFT_CMD,NODE$,VECTOR(PROMPT)) ALTRET(TELL_ERROR);
     1790    25746    3         CALL XUR$ECHOIF(DCBNUM(M$LO));
     1791    25747    3         CALL FLI$INIT( '1'B );            /* Partial initialization             */
     1792    25748    3         CALL FLB_OPTION_INIT;
     1793    25749    3         BREAK_COUNT = 0;
     1794    25750    3         COMMAND_ERROR = '0'B;
     1795    25751    3         TSN_SET_NBR = 0;        /* Start each new command from first tape set   */
     1796    25752    3         SUB_COMMAND = NODE$->OUT$BLK.CODE;
     1797    25753    4         DO CASE ( SUB_COMMAND );
     1798    25754    4          CASE( %TRANS_PSN );
     1799    25755    4            TOTAL_FILES = 0;
     1800    25756    4            TOTAL_GRANS = 0;
     1801    25757    4            TRANS_NBR = TRANS_NBR + 1;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:55   
     1802    25758    4            CALL FLB_DISK_DEST
     1803    25759    5             WHENALTRETURN DO;
     1804    25760    5               END;
     1805    25761
     1806    25762    4            CALL FLB_DISK_SPEC(0)
     1807    25763    5             WHENALTRETURN DO;
     1808    25764    5               END;
     1809    25765
     1810    25766    4            IF MODE = %TRANSFER AND TAPE_OPTION.PROTTYPE = %UNPROTECTED
     1811    25767    5             THEN DO;
     1812    25768    5               DISK_OPTION.DELETE = '1'B;
     1813    25769    5               IF COMMAND = %OPEN_UPDATE
     1814    25770    6                THEN DO;
     1815    25771    6                  IF DISK_DEST_SN.SN#(0) = ' '
     1816    25772    7                   THEN DO;
     1817    25773    7                     COMMAND_ERROR = '1'B;
     1818    25774    7                     CALL FLI$RPT_ERR ( E_WIPEOUT_SOURCE );
     1819    25775    7                     RETURN;
     1820    25776    7                     END;
     1821    25777    6                  IF DISK_DEST_SN.SN#(0) = DPLIST.SN#(0)
     1822    25778    6                    AND DISK_SRCHCOND.ANYF#
     1823    25779    6                    AND DISK_OPTION.DIR
     1824    25780    7                   THEN DO;
     1825    25781    7                     IF (DISK_DEST_ACCT.ACCT# = ' ')
     1826    25782    7                       OR (DISK_DEST_ACCT.ACCT# = START_ACCT.ACCT#
     1827    25783    7                       AND DISK_DEST_ACCT.ACCT# = STOP_ACCT.ACCT#)
     1828    25784    8                      THEN DO;
     1829    25785    8                        COMMAND_ERROR = '1'B;
     1830    25786    8                        CALL FLI$RPT_ERR( E_WIPEOUT_SOURCE );
     1831    25787    8                        RETURN;
     1832    25788    8                        END;
     1833    25789    7                     END;
     1834    25790    6                  END;
     1835    25791    5               IF DISK_OPTION.SHARED /* Disallow sharing as file will be deleted */
     1836    25792    6                THEN DO;
     1837    25793    6                  COMMAND_ERROR = '1'B;
     1838    25794    6                  CALL FLI$RPT_ERR ( E_CANT_SPECIFY_SHARED );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:56   
     1839    25795    6                  RETURN;
     1840    25796    6                  END;
     1841    25797    5               END;
     1842    25798        /***
     1843    25799         *** If destination account specified, scrub backup and stow information.
     1844    25800         ***/
     1845    25801    4            IF (COMMAND = %OPEN_UPDATE) AND (DISK_DEST_ACCT.ACCT# ~= ' ')
     1846    25802    5             THEN DO;
     1847    25803    5               DISK_OPTION.SCRUB.BACKUP = '1'B;
     1848    25804    5               DISK_OPTION.SCRUB.STOW = '1'B;
     1849    25805    5               END;
     1850    25806    4            DISK_OPTION.NOUPDATE = '1'B;
     1851    25807    4            DISK_OPTION.XFER = '1'B;
     1852    25808    4            TEMP_DISK_SRCHCOND = DISK_SRCHCOND;
     1853    25809
     1854    25810    4            IF NOT COMMAND_ERROR
     1855    25811    5             THEN DO;
     1856    25812    5               CALL FLM$MOVE(STATE)
     1857    25813    6                WHENALTRETURN DO;
     1858    25814    6                  END;
     1859    25815    5               END;
     1860    25816    4            GRAND_TOTAL_FILES = GRAND_TOTAL_FILES + TOTAL_FILES;
     1861    25817    4            GRAND_TOTAL_GRANS = GRAND_TOTAL_GRANS + TOTAL_GRANS;
     1862    25818    4            CALL FLI$STATS;
     1863    25819
     1864    25820    4            IF CHECK_TAPE AND (COMMAND = %OPEN_CREATE OR COMMAND = %OPEN_EXTEND)
     1865    25821    4              AND NOT COMMAND_ERROR
     1866    25822    5             THEN DO;                      /* Check tape now                     */
     1867    25823        /***
     1868    25824         *** Preserve FPT parameters and FSN (FPT and dcb reinitialized during CHECK).
     1869    25825         *** Note if no files written on last call to FLM$MOVE, dcb unopened so VOL# has
     1870    25826         *** initialization value. Preserve previous volume number (higher value).
     1871    25827         ***/
     1872    25828    5               SAVE_TAPE_OPEN.V = TAPE_OPEN.V; /* Save the OPEN parameters       */
     1873    25829    5               IF TAPE_DCBLIST.DCB$(0)->F$DCB.VOL# > DEST_TAPE_VOL_SAVE
     1874    25830    5                THEN DEST_TAPE_VOL_SAVE = TAPE_DCBLIST.DCB$(0)->F$DCB.VOL#;
     1875    25831    5               CALL FLI$TSN_USED( 1,0 )    /* Files copied?                      */
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:57   
     1876    25832    6                WHENRETURN DO;
     1877    25833    6                  CALL M$CLOSE( CLOSE_TSN_USED ) /* Yep, check them              */
     1878    25834    7                   WHENALTRETURN DO;
     1879    25835    7                     END;
     1880    25836    6                  TAPE_OPEN.SN_ = VECTOR(ERASE);
     1881    25837    6                  DISK_SRCHCOND = '0'B;
     1882    25838    6                  IF TEMP_DISK_SRCHCOND.ANYF#
     1883    25839    6                   THEN DISK_SRCHCOND.ANYF# = '1'B;
     1884    25840    6                  TAPE_OPTION.CHECK = '1'B;
     1885    25841    6                  IF DISK_FILE_SPEC$ ~= ADDR(NIL)
     1886    25842    7                   THEN DO;
     1887    25843    7                     DISK_FILE_SPEC.NBR = 0;
     1888    25844    7                     CALL FLM$MOVE( %CHECK )
     1889    25845    8                      WHENALTRETURN DO;
     1890    25846    8                        END;
     1891    25847    7                     TAPE_OPEN.V = SAVE_TAPE_OPEN.V;
     1892    25848    7                     TAPE_OPEN.V.VOL# = DEST_TAPE_VOL_SAVE;
     1893    25849    7                     TAPE_OPTION.CHECK = '0'B;
     1894    25850    7                     END;
     1895    25851    6                  END;
     1896    25852    6                WHENALTRETURN DO;
     1897    25853    6                  CALL M$CLOSE( CLOSE_TSN_USED )
     1898    25854    7                   WHENALTRETURN DO;
     1899    25855    7                     END;
     1900    25856    6                  END;
     1901    25857    5               END;
     1902    25858
     1903    25859    4          CASE( %NULL);
     1904    25860
     1905    25861    4          CASE( %HELP );
     1906    25862    4            BREAK_TASK = 'Helping!';
     1907    25863    4            XUH_PARAM.HELP$ = NODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXTC$;
     1908    25864    4            CALL XUR$HELP( XUH_PARAM );
     1909    25865
     1910    25866    4          CASE( %MORE_HELP );
     1911    25867    4            BREAK_TASK = 'Helping!';
     1912    25868    4            CALL XUR$MOREMSG( XUH_PARAM );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:58   
     1913    25869
     1914    25870    4          CASE( %ALL_HELP );
     1915    25871    4            BREAK_TASK = 'Helping!';
     1916    25872    4            CALL XUR$ALLMSG( XUH_PARAM );
     1917    25873
     1918    25874    4          CASE( %CLOSE);
     1919    25875    5            DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;
     1920    25876    5               SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);
     1921    25877
     1922    25878    6               DO CASE ( SUBNODE$->OUT$BLK.CODE ) ;
     1923    25879
     1924    25880    6                CASE ( %CLOSE_REMOVE );
     1925    25881    6                  IF TAPE_DCBLIST$ ~= ADDR(NIL)
     1926    25882    6                   THEN
     1927    25883    7                  DO;
     1928    25884    7                     FPT_REM.V.DISP# = %REM#;
     1929    25885    8                     DO I = 0 TO NBR_SNLISTS - 1;
     1930    25886    8                        FPT_REM.V.PSN# = TAPE_DCBLIST.DCB$(I)->F$DCB.PSN#;
     1931    25887    8                        CALL M$REM(FPT_REM)
     1932    25888    9                         WHENALTRETURN DO;
     1933    25889    9                           END;
     1934    25890    8                        END;
     1935    25891    7                     END;
     1936    25892    7                   ELSE DO;
     1937    25893    7                     IF COMMAND = %OPEN_INPUT
     1938    25894    8                      THEN DO;
     1939    25895    8                        FPT_REM.V.PSN# = DCBADDR(DCBNUM(M$TAPE00))->F$DCB.PSN#;
     1940    25896    8                        CALL M$REM( FPT_REM )
     1941    25897    9                         WHENALTRETURN DO;
     1942    25898    9                           END;
     1943    25899    8                        END;
     1944    25900    7                     END;
     1945    25901    6                END;
     1946    25902    5               END;
     1947    25903    4            IF TOTAL_FILES ~= GRAND_TOTAL_FILES
     1948    25904    5             THEN DO;
     1949    25905    5               ACCUMULATED_MOUNT_TIME = 0;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:59   
     1950    25906    5               ACCUMULATED_SPIN_TIME = 0;
     1951    25907    5               ACCUMULATED_BREAK_TIME = 0;
     1952    25908    5               TOTAL_FILES = GRAND_TOTAL_FILES;
     1953    25909    5               TOTAL_GRANS = GRAND_TOTAL_GRANS;
     1954    25910    5               START_UTS = GRAND_START_UTS;
     1955    25911    5               CALL FLI$STATS;
     1956    25912    5               END;
     1957    25913
     1958    25914    4            RETURN;
     1959    25915
     1960    25916    4          CASE (ELSE);
     1961    25917    4            CALL FLI$RPT_ERR(E_RETURN_TO_COMMAND,);
     1962    25918    4          END;
     1963    25919
     1964    25920    4         DO WHILE('0'B);
     1965    25921    4   TELL_ERROR: ;
     1966    25922    4            IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR
     1967    25923    4             THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;
     1968    25924    4            CALL XUR$ECHOIF( DCBNUM(M$LO) );
     1969    25925    4            IF NOT ERR.MON
     1970    25926    5             THEN DO;
     1971    25927    5               IF EFT_CMD_PCB.HI_CHAR > 0
     1972    25928    5                THEN CALL XUR$ERRPTR( ,DCBNUM(M$DO) );
     1973    25929    5               END;
     1974    25930    4            IF ERR.ERR# ~= %E$EOF
     1975    25931    5             THEN DO;
     1976    25932    5               COMMAND_ERROR = '1'B;
     1977    25933    5               CALL XUR$ERRMSG( ERR );
     1978    25934    5               END;
     1979    25935    5             ELSE DO;
     1980    25936    5               IF NOT M$READ_FILE$->F$DCB.FCD#
     1981    25937    6                THEN DO;              /* Must be EOF on primary command stream   */
     1982    25938    6                  CALL XUR$ERRMSG( ERR );
     1983    25939    6                  CALL M$EXIT( FPT_EXIT );
     1984    25940    6                  END;
     1985    25941    5               CALL M$CLOSE( CLOSE_READ_FILE );
     1986    25942    5               CALL XUR$SETDCBS( DCBNUM(M$SI), );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:60   
     1987    25943    5               END;
     1988    25944    4            END;
     1989    25945    3         END;                              /* Subcommand loop                    */
     1990    25946    2   END FLB_OPEN_NODES;
     1991    25947        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:61   
     1992    25948    1   FLB_STATUS_NODES:PROC;
     1993    25949        /*F*  NAME:FLB_STATUS_NODES
     1994    25950              PURPOSE: Process STATUS command.
     1995    25951        */
     1996    25952
     1997    25953
     1998    25954    2      CALL FLB_DISK_SPEC(0)
     1999    25955    3       WHENALTRETURN DO;
     2000    25956    3         RETURN;
     2001    25957    3         END;
     2002    25958
     2003    25959    2      NBR_CONTROL_FILE = 0;
     2004    25960    3      DO SUBNODEX = 0 TO NODE$ -> OUT$BLK.NSUBLKS - 1;
     2005    25961    3         SUBNODE$ = NODE$ -> OUT$BLK.SUBLK$ ( SUBNODEX );
     2006    25962    4         DO CASE ( SUBNODE$ -> OUT$BLK.CODE );
     2007    25963    4          CASE ( %CONTROL_FILE );
     2008    25964    4            NBR_CONTROL_FILE = SUBNODE$ -> OUT$BLK.NSUBLKS;
     2009    25965    5            DO I = 0 TO NBR_CONTROL_FILE - 1;
     2010    25966    5               CONTROL_LIST ( I ) = SUBNODE$ -> OUT$BLK.SUBLK$(I) ->
     2011    25967    5                 OUT$BLK.CODE;
     2012    25968    5               END;
     2013    25969    4          END;
     2014    25970    3         END;
     2015    25971    2      IF NBR_CONTROL_FILE = 0
     2016    25972    3       THEN DO;
     2017    25973    3         CONTROL_LIST ( 0 ) = %BACKUP_FILE;
     2018    25974    3         CONTROL_LIST ( 1 ) = %PRIME_FILE;
     2019    25975    3         CONTROL_LIST ( 2 ) = %DUAL_FILE;
     2020    25976    3         CONTROL_LIST ( 3 ) = %ARCHIVE_FILE;
     2021    25977    3         CONTROL_LIST ( 4 ) = %REBUILD_FILE;
     2022    25978    3         CONTROL_LIST ( 5 ) = %NODATA_FILE;
     2023    25979    3         NBR_CONTROL_FILE = 6;
     2024    25980    3         END;
     2025    25981
     2026    25982         /***
     2027    25983          *** Command is fine.  Go for it.
     2028    25984          ***/
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:62   
     2029    25985
     2030    25986    2      CALL FLS$STATUS;
     2031    25987
     2032    25988    2   END FLB_STATUS_NODES;
     2033    25989        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:63   
     2034    25990    1   FLB_RESTORE_NODES: PROC;
     2035    25991        /*F*  NAME: FLB_RESTORE_NODES
     2036    25992              PURPOSE: Process RESTORE nodes.
     2037    25993        */
     2038    25994
     2039    25995        /****************************************/
     2040    25996
     2041    25997    2      IF NODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %TAPE_SOURCE
     2042    25998    3       THEN DO;
     2043    25999    3         RESTORE_FROM_TAPE = '1'B;
     2044    26000    3         CALL FLB_TAPE_NODES;
     2045    26001    3         END;
     2046    26002    3       ELSE DO;
     2047    26003    3         RESTORE_FROM_TAPE = '0'B;
     2048    26004    3         CALL FLB_DISK_SPEC(0)
     2049    26005    4          WHENALTRETURN DO;
     2050    26006    4            END;
     2051    26007    3         IF COMMAND_ERROR THEN RETURN;
     2052    26008    3         CALL FLB_DISK_DEST
     2053    26009    4          WHENRETURN DO;
     2054    26010    4            END;
     2055    26011    3         IF COMMAND_ERROR THEN RETURN;
     2056    26012    3         CALL FLM$MOVE( %RESTORE )
     2057    26013    4          WHENALTRETURN DO;
     2058    26014    4            IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR
     2059    26015    4             THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;
     2060    26016    4            END;
     2061    26017    3         CALL FLI$STATS;
     2062    26018    3         END;
     2063    26019    2      RETURN;
     2064    26020    2   END FLB_RESTORE_NODES;
     2065    26021        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:64   
     2066    26022    1   FLB_REBUILD_NODES: PROC;
     2067    26023        /*F*  NAME: FLB_REBUILD_NODES
     2068    26024              PURPOSE: Process REBUILD nodes.
     2069    26025        */
     2070    26026
     2071    26027    2   DCL I UBIN AUTO;
     2072    26028    2   DCL FSN_SPECD BIT(1) AUTO;
     2073    26029    2   DCL TEMP$ PTR AUTO;
     2074    26030
     2075    26031
     2076    26032        /****************************************/
     2077    26033
     2078    26034    2      SOURCE_TAPE_SNLIST$ = ADDR(NIL);
     2079    26035    3      DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;
     2080    26036    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);
     2081    26037
     2082    26038    4         DO CASE( SUBNODE$->OUT$BLK.CODE );
     2083    26039
     2084    26040    4          CASE( %REBUILD_DISK_DEST );
     2085    26041    4            CALL FLB_SET_TAPE_DEFAULTS;    /* Set input tape defaults            */
     2086    26042
     2087    26043    4          CASE( %TAPE_SOURCE );            /* :BACKUP is from tape               */
     2088    26044    4            FSN_SPECD = '0'B;              /* Error if FSN was not specified     */
     2089    26045    4            IF SUBNODE$->OUT$BLK.NSUBLKS > 1
     2090    26046    5             THEN DO;
     2091    26047    5               TEMP$ = SUBNODE$->OUT$BLK.SUBLK$(1); /* Tape options              */
     2092    26048    6               DO I=0 TO TEMP$->OUT$BLK.NSUBLKS - 1;
     2093    26049    6                  IF TEMP$->OUT$BLK.SUBLK$(I)->OUT$BLK.CODE = %FSN
     2094    26050    6                   THEN FSN_SPECD = '1'B;
     2095    26051    6                  END;
     2096    26052    5               END;
     2097    26053    4            IF NOT FSN_SPECD
     2098    26054    5             THEN DO;
     2099    26055    5               CALL FLI$RPT_ERR( E_NO_FSN );
     2100    26056    5               COMMAND_ERROR = '1'B;
     2101    26057    5               RETURN;
     2102    26058    5               END;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:65   
     2103    26059
     2104    26060    4            CALL FLB_TAPE_OD_SPEC          /* Process tape options               */
     2105    26061    5             WHENALTRETURN DO;
     2106    26062    5               RETURN;
     2107    26063    5               END;
     2108    26064          /***
     2109    26065           *** The following code "undoes" the initial serial number list
     2110    26066           *** from the tape [destination] list.
     2111    26067           ***/
     2112    26068    4            SOURCE_TAPE_SNLIST$ = SNLISTINFO.SNLIST$;
     2113    26069    4            TVECTOR = VECTOR(SOURCE_TAPE_SNLIST$->VLP_SN);
     2114    26070    4            TVECTOR.W1.VSIZE# = LENGTHV(VLP_SN.NUM#)
     2115    26071    4              + SOURCE_TAPE_SNLIST$->VLP_SN.NUM# * LENGTHC(VLP_SN.SN#(0));
     2116    26072    4            TAPE_OPEN.SN_ = TVECTOR;
     2117    26073    4            LAST_SNLISTINFO$ = ADDR(NIL);
     2118    26074    4            NBR_SNLISTS = 0;
     2119    26075
     2120    26076    4          CASE( %REBUILD_FILE_SOURCE );    /* :BACKUP is from a fid              */
     2121    26077    4            IF SUBNODE$->OUT$BLK.NSUBLKS > 1 /* Process tape options             */
     2122    26078    5             THEN DO;
     2123    26079    5               CALL FLB_REBUILD_OPTION_LIST( SUBNODE$->OUT$BLK.SUBLK$(1) );
     2124    26080    5               IF COMMAND_ERROR THEN RETURN;
     2125    26081    5               END;
     2126    26082
     2127    26083    4          CASE( %REBUILD_TAPE_OPTIONS ); /* :BACKUP is from packset being rebuilt */
     2128    26084    4            CALL FLB_REBUILD_OPTION_LIST( SUBNODE$ );
     2129    26085    4            IF COMMAND_ERROR THEN RETURN;
     2130    26086    4          END;
     2131    26087    3         END;
     2132    26088    2      CALL FLB_DISK_DEST                   /* Process DP#psn                     */
     2133    26089    3       WHENALTRETURN DO;
     2134    26090    3         END;
     2135    26091    2      IF COMMAND_ERROR THEN RETURN;
     2136    26092    2      CALL FLB_DISK_SPEC(0)                /* Process sel_list, set defaults     */
     2137    26093    3       WHENALTRETURN DO;
     2138    26094    3         END;
     2139    26095    2      IF COMMAND_ERROR THEN RETURN;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:66   
     2140    26096
     2141    26097    2      RESTORE_FROM_TAPE = '1'B;
     2142    26098    2      CALL FLB_TAPE_NODES;                 /* Perform rebuild                    */
     2143    26099    2      RETURN;
     2144    26100
     2145    26101
     2146    26102    2   FLB_REBUILD_OPTION_LIST: PROC( SUBNODE$ );
     2147    26103
     2148    26104    3   DCL SUBNODE$ PTR ALIGNED;
     2149    26105    3   DCL SUBSUBNODE$ PTR AUTO;
     2150    26106    3   DCL SUBNODEX SBIN AUTO;
     2151    26107
     2152    26108    4      DO SUBNODEX = 0 TO SUBNODE$->OUT$BLK.NSUBLKS - 1;
     2153    26109    4         SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(SUBNODEX);
     2154    26110
     2155    26111    5         DO CASE( SUBSUBNODE$ -> OUT$BLK.CODE );
     2156    26112    5          CASE( %DENSITY );
     2157    26113    5            TAPE_OPEN.V.DENSITY# = SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     2158    26114    5            TAPE_OPTION.DENSITY = '1'B;
     2159    26115
     2160    26116    5          CASE( %VOL );
     2161    26117    5            CALL CHARBIN( TEMP, SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT );
     2162    26118    5            TAPE_OPEN.V.VOL# = TEMP;
     2163    26119
     2164    26120    5          CASE( %FSN );
     2165    26121    5            CALL CHARBIN( TEMP, SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT );
     2166    26122    5            TAPE_OPEN.V.FSN# = TEMP;
     2167    26123    5            IF SUBSUBNODE$->OUT$BLK.NSUBLKS <= 1
     2168    26124    5             THEN LAST_TAPE_FSN = TEMP;
     2169    26125    5             ELSE CALL CHARBIN( LAST_TAPE_FSN, SUBSUBNODE$->OUT$BLK.SUBLK$(1)->OUT$SYM.
             26125                      TEXT );
     2170    26126    5            IF TAPE_OPEN.V.FSN# > LAST_TAPE_FSN
     2171    26127    6             THEN DO;
     2172    26128    6               COMMAND_ERROR = '1'B;
     2173    26129    6               CALL FLI$RPT_ERR( E_BAD_FSN_RANGE, );
     2174    26130    6               END;
     2175    26131
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:67   
     2176    26132    5          CASE( %TAPE_DIR );
     2177    26133    5            DISK_OPTION.DIR = '1'B;
     2178    26134
     2179    26135    5          CASE( %NPAD );
     2180    26136    5            TAPE_OPTION.NPAD = '1'B;
     2181    26137
     2182    26138    5          CASE( %IOERRORCY );
     2183    26139    5            TAPE_OPTION.IOERRORC = '1'B;
     2184    26140    5            TAPE_OPEN.V.IOERROK# = '1'B;
     2185    26141
     2186    26142    5          CASE( %IOERRORCN );
     2187    26143    5            TAPE_OPTION.IOERRORC = '0'B;
     2188    26144    5            TAPE_OPEN.V.IOERROK# = '0'B;
     2189    26145
     2190    26146    5          END;
     2191    26147    4         END;
     2192    26148    3      RETURN;
     2193    26149
     2194    26150    3   END FLB_REBUILD_OPTION_LIST;
     2195    26151    2   END FLB_REBUILD_NODES;
     2196    26152        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:68   
     2197    26153    1   FLB_TRANS_TYPE: PROC ;
     2198    26154        /*F*  NAME: FLB_TRANS_TYPE
     2199    26155              PURPOSE: Process OPEN nodes.
     2200    26156        */
     2201    26157
     2202    26158        /******************************/
     2203    26159
     2204    26160    3      DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;
     2205    26161    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);
     2206    26162
     2207    26163    4         DO CASE( SUBNODE$->OUT$BLK.CODE );
     2208    26164
     2209    26165    4          CASE( %TRANS );
     2210    26166    4            SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(0);
     2211    26167
     2212    26168    5            DO CASE( SUBSUBNODE$->OUT$BLK.CODE );
     2213    26169
     2214    26170    5             CASE( %TRANSFER );
     2215    26171    5               MODE = %TRANSFER;
     2216    26172    6               DO SUBSUBNODEX = 0 TO SUBSUBNODE$->OUT$BLK.NSUBLKS-1;
     2217    26173    6                  TEMP$ = SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX);
     2218    26174    7                  DO CASE ( TEMP$->OUT$BLK.CODE);
     2219    26175    7                   CASE ( %PROTTYPE ) ;
     2220    26176    7                     TAPE_OPTION.PROTTYPE = TEMP$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     2221    26177    7                   END;
     2222    26178    6                  END;
     2223    26179    5             CASE( %TRANSPORT );
     2224    26180    5               MODE = %TRANSPORT;
     2225    26181    5             END;
     2226    26182    4          END;
     2227    26183    3         END;
     2228    26184    2   END FLB_TRANS_TYPE;
     2229    26185        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:69   
     2230    26186    1   FLB_OPTION_INIT: PROC;
     2231    26187        /*F*  NAME: FLB_OPTION_INIT
     2232    26188              PURPOSE: Initializes options.
     2233    26189        */
     2234    26190
     2235    26191        /****************************************/
     2236    26192
     2237    26193    2      IF NOT OVER_FIL
     2238    26194    3       THEN DO;
     2239    26195    3         DISK_DEST_SN.SN#(0) = ' ';
     2240    26196    3         DISK_DEST_RES.NAME = ' ';
     2241    26197    3         END;
     2242    26198    2      DISK_DEST_ACCT.ACCT# = ' ';
     2243    26199    2      DISK_DEST_EXIST = 0;
     2244    26200
     2245    26201    2      DPLIST$ = ADDR(ZERO);                /* No packset                         */
     2246    26202    2      DPRESLIST$ = ADDR(ZERO);             /* No packset resource list           */
     2247    26203    2      DISK_SRCHCOND = '0'B;                /* ANYFile                            */
     2248    26204    2      DISK_DESC = '0'B;                    /* No particular DESCriptors          */
     2249    26205    2      DISK_DESC_MASK = '0'B;
     2250    26206    2      DISK_OPTION = '0'B;                  /* No other options                   */
     2251    26207    2      DISK_ORGS.NBR = 0;                   /* No organizations                   */
     2252    26208    2      DISK_CRIT = '0'B;
     2253    26209    2      DATE_CRIT = '0'B;
     2254    26210    2      PREV_ACCT.ACCT# = ' ';
     2255    26211    2      RANGE_SPECIFIED = '0'B;
     2256    26212    2      SKIP_SPECIFIED = '0'B;
     2257    26213    2      FIRST_ACCT_SPECIFIED.ACCT# = ' ';
     2258    26214
     2259    26215    3      DO I=0 TO %MAX_DATE;
     2260    26216    3         DISK_BEF_UTS(I) = 0;
     2261    26217    3         DISK_AFT_UTS(I) = 0;
     2262    26218    3         DISK_AND_OP(I) = '0'B;
     2263    26219    3         END;
     2264    26220
     2265    26221    2      DISK_OPEN_NEXT.V.FUN# = %IN#;
     2266    26222    2      DISK_OPEN_NEXT.V.SHARE# = 0;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:70   
     2267    26223
     2268    26224    2      RETURN;
     2269    26225
     2270    26226    2   END FLB_OPTION_INIT;
     2271    26227        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:71   
     2272    26228    1   FLB_DISK_DEST: PROC ALTRET;
     2273    26229        /*F*  NAME: FLB_DISK_DEST
     2274    26230              PURPOSE: Process DISK_DEST nodes, if any.
     2275    26231        */
     2276    26232
     2277    26233        /******************************/
     2278    26234
     2279    26235    3      DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;
     2280    26236    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);
     2281    26237
     2282    26238    4         DO CASE( SUBNODE$->OUT$BLK.CODE );
     2283    26239
     2284    26240    4          CASE( %DISK_DEST );
     2285    26241    5            DO CASE( SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE );
     2286    26242    5             CASE( %ON_FILE );
     2287    26243    5               DISK_DEST_EXIST = %ERROR#;
     2288    26244    5               IF COMMAND = %OPEN_CREATE OR COMMAND = %OPEN_EXTEND
     2289    26245    5                THEN OVER_FIL = '1'B;      /* Set/change packset of origin       */
     2290    26246    5             CASE( %OVER_FILE );
     2291    26247    5               IF COMMAND = %OPEN_CREATE OR COMMAND = %OPEN_INPUT OR COMMAND = %
             26247                        OPEN_EXTEND
     2292    26248    5                THEN OVER_FIL = '1'B;
     2293    26249    6                ELSE DO;
     2294    26250    6                  OVER_FIL = '0'B;
     2295    26251    6                  DISK_DEST_SN.SN#(0) = ' ';
     2296    26252    6                  DISK_DEST_RES.NAME = ' ';
     2297    26253    6                  END;                     /* else do                            */
     2298    26254    5               DISK_DEST_EXIST = %NEWFILE#;
     2299    26255    5             CASE( %INCR_FILE );
     2300    26256    5               TAPE_OPTION.PROTTYPE = %INCREMENTAL;
     2301    26257    5             END;
     2302    26258
     2303    26259    5            DO SUBSUBNODEX = 1 TO SUBNODE$->OUT$BLK.NSUBLKS - 1;
     2304    26260    5               SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX);
     2305    26261
     2306    26262    6               DO CASE( SUBSUBNODE$->OUT$BLK.CODE );
     2307    26263    6                CASE( %PACKSET_NAME );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:72   
     2308    26264    6                  DISK_DEST_RES.NAME = ' ';
     2309    26265    7                  DO SUBSUBNODEX = 0 TO SUBSUBNODE$->OUT$BLK.NSUBLKS - 1; /* DPnn */
     2310    26266    7                     IF SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$BLK.NDTYPE = %
             26266                              DEC#
     2311    26267    8                      THEN DO;
     2312    26268    8                        CALL CONCAT( DISK_DEST_RES.NAME, 'DP', SUBSTR(SUBSUBNODE$->
     2313    26269    8                          OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.TEXT,0,SUBSUBNODE$
     2314    26270    8                          ->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.COUNT ));
     2315    26271    8                        IF SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.TEXT =
             26271                                 '00'
     2316    26272    9                         THEN DO;
     2317    26273    9                           COMMAND_ERROR = '1'B;
     2318    26274    9                           CALL FLI$RPT_ERR( E_BAD_DP_FORMAT );
     2319    26275    9                           END;
     2320    26276    8                        END;
     2321    26277    7                      ELSE DISK_DEST_SN.SN#(0) = SUBSUBNODE$->OUT$BLK.SUBLK$
     2322    26278    7                          (SUBSUBNODEX)->OUT$SYM.TEXT;
     2323    26279    7                     END;
     2324    26280    6                CASE( %ACCOUNT_NAME );
     2325    26281    6                  DISK_DEST_ACCT.ACCT# = SUBSUBNODE$->OUT$SYM.TEXT;
     2326    26282    6                CASE( %PROTTYPE );
     2327    26283    6                  TAPE_OPTION.PROTTYPE = SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     2328    26284    6                END;
     2329    26285    5               END;
     2330    26286    4          CASE( %REBUILD_DISK_DEST );
     2331    26287    4            SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(SUBNODEX);
     2332    26288    5            DO SUBSUBNODEX = 0 TO SUBSUBNODE$->OUT$BLK.NSUBLKS - 1; /* DPnn      */
     2333    26289    5               IF SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$BLK.NDTYPE = %DEC#
     2334    26290    6                THEN DO;
     2335    26291    6                  CALL CONCAT( DISK_DEST_RES.NAME , 'DP', SUBSTR(SUBSUBNODE$->OUT$BLK
     2336    26292    6                    .SUBLK$(SUBSUBNODEX)->OUT$SYM.TEXT, 0, SUBSUBNODE$->OUT$BLK
     2337    26293    6                    .SUBLK$(SUBSUBNODEX)->OUT$SYM.COUNT ));
     2338    26294    6                  IF SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.TEXT = '00'
     2339    26295    7                   THEN DO;
     2340    26296    7                     COMMAND_ERROR = '1'B;
     2341    26297    7                     CALL FLI$RPT_ERR( E_BAD_DP_FORMAT );
     2342    26298    7                     END;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:73   
     2343    26299    6                  END;
     2344    26300    5                ELSE DISK_DEST_SN.SN#(0) = SUBSUBNODE$->OUT$BLK.SUBLK$
     2345    26301    5                    (SUBSUBNODEX)->OUT$SYM.TEXT;
     2346    26302    5               END;
     2347    26303
     2348    26304    4            REBUILD_SN.SN#(0) = DISK_DEST_SN.SN#(0);
     2349    26305    4            OPEN_REBUILD.V.RES# = DISK_DEST_RES.NAME;
     2350    26306
     2351    26307    4            TEMP = LENGTHC(DPLIST.NUM#) + LENGTHC(DPLIST.SN#(0));
     2352    26308    4            TEMP = (TEMP + 3) / 4;
     2353    26309    4            CALL FLI$ALLOC( TEMP, DPLIST$ );
     2354    26310    4            DPLIST.NUM# = 1;
     2355    26311    4            DPLIST.SN#(0) = DISK_DEST_SN.SN#(0);
     2356    26312
     2357    26313    4            TEMP = LENGTHC(DPRESLIST.NBR) + LENGTHC(DPRESLIST.NAME(0));
     2358    26314    4            TEMP = (TEMP + 3) / 4;         /* Number of words in DPRESLIST       */
     2359    26315    4            CALL FLI$ALLOC( TEMP, DPRESLIST$ );
     2360    26316    4            DPRESLIST.NBR = 1;
     2361    26317    4            DPRESLIST.NAME(0) = DISK_DEST_RES.NAME;
     2362    26318    4          END;
     2363    26319    3         END;
     2364    26320
     2365    26321    2      IF DISK_DEST_SN.SN#(0) = ' ' AND DISK_DEST_ACCT.ACCT# ~= ' '
     2366    26322    3       THEN DO;                            /* Find packset                       */
     2367    26323    3         OUR_ACCT.ACCT# = DISK_DEST_ACCT.ACCT#;
     2368    26324    3         CALL M$MADMUCK( GET_PSN )
     2369    26325    4          WHENALTRETURN DO;
     2370    26326    4            CALL FLI$RPT_ERR;
     2371    26327    4            COMMAND_ERROR = '1'B;
     2372    26328    4            ALTRETURN;
     2373    26329    4            END;
     2374    26330    3         DISK_DEST_SN.SN#(0) = MUCK_LIST.SN#(0);
     2375    26331    3         END;
     2376    26332    2      RETURN;
     2377    26333
     2378    26334    2   END FLB_DISK_DEST;
     2379    26335        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:74   
     2380    26336
     2381    26337    1   FLB_DISK_SPEC: PROC(SUBNODEY) ALTRET;
     2382    26338        /*F*  NAME: FLB_DISK_SPEC
     2383    26339              PURPOSE: Process disk specification nodes.
     2384    26340        ***/
     2385    26341
     2386    26342    2   DCL SUBNODEY SBIN;                 /* Subnode at which to start processing    */
     2387    26343
     2388    26344        /****************************************/
     2389    26345
     2390    26346           /***
     2391    26347            *** Process options.
     2392    26348            ***/
     2393    26349
     2394    26350    2   DISK_SPEC_DO:
     2395    26351    3      DO SUBNODEX = SUBNODEY TO NODE$->OUT$BLK.NSUBLKS - 1;
     2396    26352    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);
     2397    26353
     2398    26354    4         DO CASE( SUBNODE$->OUT$BLK.CODE );
     2399    26355
     2400    26356    4          CASE( %DPLIST );
     2401    26357    4            NBR_DPS = SUBNODE$->OUT$BLK.NSUBLKS;
     2402    26358    4            TEMP = LENGTHC(DPLIST.NUM#) + NBR_DPS * LENGTHC(DPLIST.SN#(0));
     2403    26359    4            TEMP = (TEMP + 3) / 4;         /* Number of words in DPLIST          */
     2404    26360    4            CALL FLI$ALLOC( TEMP, DPLIST$ );
     2405    26361
     2406    26362    4            TEMP = LENGTHC(DPRESLIST.NBR) + NBR_DPS * LENGTHC(DPRESLIST.NAME(0));
     2407    26363    4            TEMP = (TEMP+3)/4;             /* Number of words in DPRESLIST       */
     2408    26364    4            CALL FLI$ALLOC( TEMP, DPRESLIST$ );
     2409    26365
     2410    26366    4            DPLIST.NUM# = NBR_DPS;
     2411    26367    4            DPRESLIST.NBR = NBR_DPS;
     2412    26368    5            DO I=0 TO NBR_DPS-1;           /* Move packsets' names into the list */
     2413    26369    5               DPRESLIST.NAME(I) = ' ';
     2414    26370    5               SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(I);
     2415    26371    5               IF SUBSUBNODE$->OUT$BLK.NSUBLKS = 1 /* DPnn# or DP# spec'd?       */
     2416    26372    5                THEN DPLIST.SN#(I) = SUBSUBNODE$->OUT$SYM.TEXT; /* DP#           */
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:75   
     2417    26373    6                ELSE DO;
     2418    26374    7                  DO SUBSUBNODEX = 0 TO SUBSUBNODE$->OUT$BLK.NSUBLKS - 1; /* DPnn# */
     2419    26375    7                     IF SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$BLK.NDTYPE = %
             26375                              DEC#
     2420    26376    8                      THEN DO;
     2421    26377    8                        CALL CONCAT( DPRESLIST.NAME(I), 'DP', SUBSTR(SUBSUBNODE$->
     2422    26378    8                          OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.TEXT, 0, SUBSUBNODE$->
     2423    26379    8                          OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.COUNT ));
     2424    26380    8                        IF SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.TEXT =
             26380                                 '00'
     2425    26381    9                         THEN DO;
     2426    26382    9                           COMMAND_ERROR = '1'B;
     2427    26383    9                           CALL FLI$RPT_ERR( E_BAD_DP_FORMAT );
     2428    26384    9                           END;
     2429    26385    8                        END;
     2430    26386    7                      ELSE DPLIST.SN#(I) = SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->
     2431    26387    7                          OUT$SYM.TEXT;
     2432    26388    7                     END;
     2433    26389    6                  END;
     2434    26390    5               END;
     2435    26391    5            DO I=0 TO NBR_DPS-2;
     2436    26392    6               DO J=I+1 TO NBR_DPS-1;
     2437    26393    6                  IF DPLIST.SN#(I) = DPLIST.SN#(J)
     2438    26394    7                   THEN DO;
     2439    26395    7                     COMMAND_ERROR = '1'B;
     2440    26396    7                     CALL FLI$RPT_ERR( E_DUPLICATE_PSN, );
     2441    26397    7                     END;
     2442    26398    6                  END;
     2443    26399    5               END;
     2444    26400
     2445    26401    4          CASE( %DISK_OPTION_LIST, %ARCHIVE_TOPTION_LIST, %PURGE_TOPTION_LIST,
     2446    26402    4                 %PURGE_SOPTION_LIST, %DUAL_SOPTION_LIST, %DUALI_SOPTION_LIST );
     2447    26403    4            DISK_SRCHCOND = '0'B;
     2448    26404    4            CALL FLB_DISK_OPTION_LIST;
     2449    26405
     2450    26406    4          CASE( %DISK_FILE_SPEC );
     2451    26407    4            TEMP = LENGTHW(DISK_FILE_SPEC.NBR)+LENGTHW(DISK_FILE_SPEC.NBR_LEFT)
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:76   
     2452    26408    4              + LENGTHW(DISK_FILE_SPEC.PASSWORD_SPEC)
     2453    26409    4              + LENGTHW(DISK_FILE_SPEC.PASSWORD#)
     2454    26410    4              + 2 * LENGTHW(DISK_FILE_SPEC.SPEC(0));
     2455    26411    4            CALL FLI$ALLOC( TEMP, DISK_FILE_SPEC$ );
     2456    26412    4            DISK_FILE_SPEC.NBR_LEFT = 2;
     2457    26413    4            DISK_FILE_SPEC.NBR = 0;
     2458    26414
     2459    26415    5            DO SUBSUBNODEX = 0 TO SUBNODE$->OUT$BLK.NSUBLKS - 1;
     2460    26416    5               SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX);
     2461    26417
     2462    26418    6               DO CASE( SUBSUBNODE$->OUT$BLK.CODE );
     2463    26419
     2464    26420    6                CASE( %FID_RANGE );
     2465    26421    6                  CALL FLB_FID_RANGE( SUBSUBNODE$ );
     2466    26422    6                  CALL FLB_NUTHER_FILE_SPEC;
     2467    26423    6                  RANGE_SPECIFIED = '1'B;
     2468    26424
     2469    26425    6                CASE( %FID_SKIP );
     2470    26426    7                  DO I=0 TO SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.NSUBLKS-1;
     2471    26427    7                     CALL FLB_FID_RANGE( SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.
     2472    26428    7                       SUBLK$(I) );
     2473    26429    7                     CALL FLB_NUTHER_FILE_SPEC;
     2474    26430    7                     SKIP_SPECIFIED = '1'B;
     2475    26431    7                     DISK_FILE_SPEC.SPEC.SKIP(DISK_FILE_SPEC.NBR-1) = 1;
     2476    26432                                                /* Skip indicator                     */
     2477    26433    7                     END;
     2478    26434
     2479    26435    6                END;
     2480    26436    5               END;
     2481    26437    4          CASE( %DISK_FID_SPEC );
     2482    26438    4            IF FPT_FID_RESULTS.SN          /* Packset specified?                 */
     2483    26439    5             THEN DO;
     2484    26440    5               NBR_DPS = 1;
     2485    26441    5               TEMP = LENGTHC(DPLIST.NUM#) + NBR_DPS * LENGTHC(DPLIST.SN#(0));
     2486    26442    5               TEMP = (TEMP + 3) / 4;      /* Number of words in DPLIST          */
     2487    26443    5               CALL FLI$ALLOC( TEMP, DPLIST$ );
     2488    26444    5               DPLIST.NUM# = NBR_DPS;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:77   
     2489    26445    5               DPLIST.SN#(0) = FID_SN.SN#(0); /* Move packset's name into the list */
     2490    26446
     2491    26447    5               TEMP = LENGTHC(DPRESLIST.NBR) + LENGTHC(DPRESLIST.NAME(0));
     2492    26448    5               TEMP = (TEMP + 3) / 4;      /* Number of words in DPRESLIST       */
     2493    26449    5               CALL FLI$ALLOC( TEMP, DPRESLIST$ );
     2494    26450    5               DPRESLIST.NBR = 1;
     2495    26451    5               DPRESLIST.NAME(0) = ' ';
     2496    26452    5               END;
     2497    26453
     2498    26454    4            IF FPT_FID_RESULTS.ACCT        /* Account specified?                 */
     2499    26455    4              AND FPT_FID_RESULTS.CLENGTH.ACCT > 0
     2500    26456    5             THEN DO;
     2501    26457    5               START_ACCT = FID_ACCT;
     2502    26458    5               FIRST_ACCT_SPECIFIED.ACCT# = START_ACCT.ACCT#;
     2503    26459    5               END;
     2504    26460    5             ELSE DO;
     2505    26461    5               START_ACCT.ACCT# = B$JIT.FACCN;
     2506    26462    5               FIRST_ACCT_SPECIFIED.ACCT# = B$JIT.FACCN;
     2507    26463    5               END;
     2508    26464    4            STOP_ACCT = START_ACCT;
     2509    26465
     2510    26466    4            TEMP = LENGTHW(DISK_FILE_SPEC.NBR)+LENGTHW(DISK_FILE_SPEC.NBR_LEFT)
     2511    26467    4              + LENGTHW(DISK_FILE_SPEC.PASSWORD_SPEC)
     2512    26468    4              + LENGTHW(DISK_FILE_SPEC.PASSWORD#)
     2513    26469    4              + 2 * LENGTHW(DISK_FILE_SPEC.SPEC(0));
     2514    26470    4            CALL FLI$ALLOC( TEMP, DISK_FILE_SPEC$ );
     2515    26471    4            DISK_FILE_SPEC.NBR_LEFT = 2;
     2516    26472    4            DISK_FILE_SPEC.NBR = 0;
     2517    26473
     2518    26474    4            IF FPT_FID_RESULTS.NAME        /* File specified?                    */
     2519    26475    5             THEN DO;
     2520    26476    5               START_FILE.NAME# = FID_NAME.NAME#;
     2521    26477    5               START_FILE.L# = FID_NAME.L#;
     2522    26478    5               STOP_FILE = START_FILE;
     2523    26479    5               END;
     2524    26480
     2525    26481    4            IF FPT_FID_RESULTS.PASS
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:78   
     2526    26482    4             THEN DISK_FILE_SPEC.PASSWORD_SPEC = '1'B;
     2527    26483    4             ELSE DISK_FILE_SPEC.PASSWORD_SPEC = '0'B;
     2528    26484
     2529    26485    4            CALL FLB_NUTHER_FILE_SPEC;
     2530    26486    4            RANGE_SPECIFIED = '1'B;
     2531    26487
     2532    26488    4            EXIT DISK_SPEC_DO;
     2533    26489    4          END;
     2534    26490    3         END;
     2535    26491
     2536    26492        /***
     2537    26493         *** Make sure that dates don't overlap in such as way that no file
     2538    26494         *** can be selected.
     2539    26495         ***/
     2540    26496
     2541    26497    3      DO I=0 TO %MAX_DATE;
     2542    26498    3         IF DATE_CRIT.BEF(I) AND DATE_CRIT.AFT(I)
     2543    26499    3           AND DISK_AND_OP(I)
     2544    26500    3           AND DISK_BEF_UTS(I) < DISK_AFT_UTS(I)
     2545    26501    4          THEN DO;
     2546    26502    5            DO CASE(I);
     2547    26503    5             CASE(%ACCESSED);
     2548    26504    5               VLP_ERRCODE = E_BAD_ACC;
     2549    26505    5             CASE(%MODIFIED);
     2550    26506    5               VLP_ERRCODE = E_BAD_MOD;
     2551    26507    5             CASE(%CREATED);
     2552    26508    5               VLP_ERRCODE = E_BAD_CRE;
     2553    26509    5             CASE(%BACKED_UP);
     2554    26510    5               VLP_ERRCODE = E_BAD_BAC;
     2555    26511    5             CASE(%ARCHIVED);
     2556    26512    5               VLP_ERRCODE = E_BAD_ARC;
     2557    26513    5             END;
     2558    26514    4            CALL FLI$RPT_ERR( VLP_ERRCODE, );
     2559    26515    4            COMMAND_ERROR = '1'B;
     2560    26516    4            END;
     2561    26517    3         END;
     2562    26518    2      CALL FLB_ORDER_RANGE ALTRET( JUSTALT );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:79   
     2563    26519
     2564    26520        /***
     2565    26521         *** If no packset specified, default to packset of first account
     2566    26522         *** specified.  If no account specified, default to user's FACCN.
     2567    26523         ***/
     2568    26524
     2569    26525    3      DO CASE( COMMAND );
     2570    26526    3       CASE( %CHECK );
     2571    26527    3       CASE( %RESTORE, %OPEN_INPUT, %OPEN_UPDATE, %REBUILD );
     2572    26528    3         IF DISK_DEST_SN.SN#(0) ~= ' ' /* Check destination packset for readiness */
     2573    26529    4          THEN DO;
     2574    26530    4            DPSN.SN#(0) = DISK_DEST_SN.SN#(0);
     2575    26531    4            CHECK_PACKSET.V.RES# = DISK_DEST_RES.NAME;
     2576    26532    4            CALL FLB_CHECK_PACKSET;
     2577    26533    4            END;
     2578    26534    3         IF COMMAND = %OPEN_UPDATE         /* Check source packset for readiness */
     2579    26535    4          THEN DO;
     2580    26536    4            DPSN.SN#(0) = DPLIST.SN#(0);
     2581    26537    4            CHECK_PACKSET.V.RES# = DPRESLIST.NAME(0);
     2582    26538    4            CALL FLB_CHECK_PACKSET;
     2583    26539    4            END;
     2584    26540    3       CASE( ELSE );
     2585    26541    3         IF DPLIST$ = ADDR(ZERO)
     2586    26542    4          THEN DO;
     2587    26543    4            IF FIRST_ACCT_SPECIFIED.ACCT# ~= ' '
             26543                     /* Antique code most likely unnecessary */
     2588    26544    4             THEN OUR_ACCT.ACCT# = FIRST_ACCT_SPECIFIED.ACCT#;
     2589    26545    4             ELSE OUR_ACCT.ACCT# = B$JIT.FACCN;
     2590    26546    4            IF B$JIT.FPSN ~= ' '
     2591    26547    4             THEN DPSN.SN#(0) = B$JIT.FPSN;
     2592    26548    5             ELSE DO;
     2593    26549    5               CALL M$MADMUCK( GET_PSN )
     2594    26550    6                WHENALTRETURN DO;
     2595    26551    6                  CALL FLI$RPT_ERR;
     2596    26552    6                  COMMAND_ERROR = '1'B;
     2597    26553    6                  END;
     2598    26554    5               DPSN.SN#(0) = MUCK_LIST.SN#(0);
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:80   
     2599    26555    5               END;
     2600    26556    4            DPLIST$ = ADDR(DPSN);
     2601    26557    4            END;
     2602    26558    3         IF COMMAND ~= %WHERE
     2603    26559    4          THEN DO;
     2604    26560    5            DO I = 0 TO DPLIST.NUM# - 1;
     2605    26561    5               DPSN.SN#(0) = DPLIST.SN#(I);
     2606    26562    5               CHECK_PACKSET.V.RES# = DPRESLIST.NAME(I);
     2607    26563    5               CALL FLB_CHECK_PACKSET;
     2608    26564    5               END;
     2609    26565    4            END;
     2610    26566    3       END;
     2611    26567
     2612    26568        /***
     2613    26569         *** Supply proper command defaults.
     2614    26570         ***/
     2615    26571
     2616    26572    3      DO CASE( COMMAND );
     2617    26573
     2618    26574    3       CASE( %SAVE, %CHECK );
     2619    26575    3         IF NOT DISK_SRCHCOND
     2620    26576    3          THEN DISK_SRCHCOND.ANYF# = '1'B;
     2621    26577    3         IF NOT DISK_OPTION
     2622    26578    4          THEN DO;
     2623    26579    4            DISK_OPTION.PAD = '1'B;
     2624    26580    4            DISK_OPTION.DIR = '1'B;
     2625    26581    4            DISK_OPTION.DELETED_ACCOUNTS = '1'B;
     2626    26582    4            END;
     2627    26583    3         IF COMMAND = %SAVE
     2628    26584    4          THEN DO;
     2629    26585    4            DISK_OPTION.CLEANUP = '1'B;
     2630    26586    4            DISK_OPTION.SKIP_NO_BACKUP = '1'B;
     2631    26587    4            DISK_OPTION.SAVE_DIR = '1'B;
     2632    26588    4            END;
     2633    26589    3          ELSE DISK_OPTION.CLEANUP = '0'B;
     2634    26590
     2635    26591    3       CASE( %RESTORE, %RETRIEVE );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:81   
     2636    26592    3         IF NOT DISK_SRCHCOND
     2637    26593    3          THEN DISK_SRCHCOND.ANYF# = '1'B;
     2638    26594    3         IF COMMAND = %RESTORE AND TAPE_OPTION.PROTTYPE = 0
     2639    26595    3           AND DISK_DEST_EXIST = 0
     2640    26596    3          THEN TAPE_OPTION.PROTTYPE = %INCREMENTAL;
     2641    26597
     2642    26598    3       CASE( %REBUILD );
     2643    26599    3         DISK_SRCHCOND.ANYF# = '1'B;
     2644    26600    3         IF TAPE_OPTION.NPAD
     2645    26601    3          THEN DISK_OPTION.PAD = '0'B;
     2646    26602    3          ELSE DISK_OPTION.PAD = '1'B;
     2647    26603    3         DISK_OPTION.DELETED_ACCOUNTS = '1'B;
     2648    26604
     2649    26605    3       CASE( %DUAL, %DUAL_INCREMENTAL );
     2650    26606    3         IF NOT DISK_SRCHCOND
     2651    26607    3          THEN DISK_SRCHCOND.ANYF# = '1'B;
     2652    26608    3         DISK_OPTION.DIR = '1'B;
     2653    26609    3         DISK_OPTION.DELETED_ACCOUNTS = '1'B;
     2654    26610    3         DISK_OPTION.PAD = '1'B;
     2655    26611
     2656    26612    3       CASE( %BACKUP );
     2657    26613    3         IF NOT DISK_SRCHCOND
     2658    26614    4          THEN DO;
     2659    26615    4            DISK_SRCHCOND.BUF# = '1'B;
     2660    26616    4            DISK_SRCHCOND.DELF# = '1'B;
     2661    26617    4            DISK_SRCHCOND.ARCHIVE# = '1'B;
     2662    26618    4            FILE_TYPE.DF = '1'B;
     2663    26619    4            FILE_TYPE.BUF = '1'B;
     2664    26620    4            FILE_TYPE.I = '1'B;
     2665    26621    4            END;
     2666    26622    3         DISK_OPTION.PAD = '1'B;
     2667    26623    3         DISK_OPTION.DIR = '1'B;
     2668    26624    3         DISK_OPTION.DELETED_ACCOUNTS = '1'B;
     2669    26625    3         DISK_OPTION.SAVE_DIR = '1'B; /* Save accnt. dir. even though backup of  */
     2670    26626                                                /* files not permitted for the accnt. */
     2671    26627    3         DISK_OPTION.SKIP_NO_BACKUP = '1'B;
     2672    26628    3         IF BACKUP_$$EFT
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:82   
     2673    26629    4          THEN DO;
     2674    26630    4            DISK_SRCHCOND.BUF# = '0'B;
     2675    26631    4            DISK_SRCHCOND.ANYF# = '1'B;
     2676    26632    4            END;
     2677    26633
     2678    26634    3       CASE( %ARCHIVE_CMD );
     2679    26635    3         IF NOT DISK_SRCHCOND
     2680    26636    3          THEN DISK_SRCHCOND.QS# = '1'B;
     2681    26637    3         IF NOT DISK_CRIT.DSC
     2682    26638    4          THEN DO;
     2683    26639    4            DISK_DESC_MASK.FETCH# = '1'B;
     2684    26640    4            DISK_DESC.FETCH# = '0'B;
     2685    26641    4            DISK_CRIT.DSC = '1'B;
     2686    26642    4            END;
     2687    26643
     2688    26644    3       CASE( %PURGE );
     2689    26645    3         DISK_OPTION.DELETE = '1'B;
     2690    26646    3         DISK_OPTION.SKIP_NO_PURGE = '1'B;
     2691    26647    3         IF NOT DISK_CRIT.TIM AND NOT DISK_SRCHCOND
     2692    26648    4          THEN DO;
     2693    26649    4            DISK_CRIT.TIM = '1'B;
     2694    26650    4            DATE_CRIT.EXPD = '1'B;
     2695    26651    4            END;
     2696    26652
     2697    26653    3       CASE( %REQUALIFY, %REQUALIFY_BACKUP, %REQUALIFY_ARCHIVE );
     2698    26654    3         IF NOT DISK_CRIT.TIM
     2699    26655    4          THEN DO;
     2700    26656    4            CALL FLI$RPT_ERR( E_NEED_TIME, );
     2701    26657    4            COMMAND_ERROR = '1'B;
     2702    26658    4            END;
     2703    26659
     2704    26660    3       CASE ( %OPEN_INPUT );
     2705    26661    3         IF NOT DISK_SRCHCOND
     2706    26662    3          THEN DISK_SRCHCOND.ANYF# = '1'B;
     2707    26663
     2708    26664    3       CASE( %OPEN_UPDATE );
     2709    26665    3         DISK_OPTION.OPEN_MODE = MODE;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:83   
     2710    26666
     2711    26667    3       CASE( %UNARCHIVE );
     2712    26668    3         IF NOT DISK_SRCHCOND
     2713    26669    3          THEN DISK_SRCHCOND.ARCHIVE# = '1'B;
     2714    26670
     2715    26671    3       CASE( %STOW_ACTIVE, %STOW_INACTIVE );
     2716    26672
     2717    26673    3       END;
     2718    26674
     2719    26675    2      IF DISK_DEST_EXIST = 0
     2720    26676    2       THEN DISK_DEST_EXIST = %ERROR#;     /* Supply default                     */
     2721    26677    2      IF COMMAND_ERROR THEN ALTRETURN;
     2722    26678
     2723    26679    2      RETURN;
     2724    26680
     2725    26681    2   JUSTALT: ;
     2726    26682    2      ALTRETURN;
     2727    26683
     2728    26684    2   FLB_CHECK_PACKSET: PROC;
     2729    26685
     2730    26686        /********************/
     2731    26687
     2732    26688    3      CALL M$OPEN( CHECK_PACKSET )
     2733    26689    4       WHENALTRETURN DO;
     2734    26690    4         CODE = B$TCB.ALT$->B$ALT.ERR.CODE;
     2735    26691    4         IF CODE = %E$FDEOF OR CODE = %E$NOKEY OR CODE = %E$ADEOF
     2736    26692    4          THEN ;
     2737    26693    5          ELSE DO;                         /* Packset not ready                  */
     2738    26694    5            COMMAND_ERROR = '1'B;
     2739    26695    5            CALL FLI$RPT_ERR;
     2740    26696    5            IF CODE = %E$SETDOWN
     2741    26697    5             THEN FPT_EXIT.V.STEPCC# = %OPER_ERROR;
     2742    26698    5            END;
     2743    26699    4         END;
     2744    26700    3      RETURN;
     2745    26701
     2746    26702    3   END FLB_CHECK_PACKSET;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:84   
     2747    26703
     2748    26704
     2749    26705
     2750    26706    2   FLB_DISK_OPTION_LIST: PROC;
     2751    26707        /*F*  NAME: FLB_DISK_OPTION_LIST
     2752    26708              PURPOSE: Process DISK_OPTION_LIST node.
     2753    26709        ***/
     2754    26710
     2755    26711         /***
     2756    26712          *** STATIC
     2757    26713          ***/
     2758    26714
     2759    26715    3   DCL WHAT_BIT_SHOULD_BE BIT(1) STATIC;
     2760    26716
     2761    26717        /******************************/
     2762    26718
     2763    26719    4      DO SUBSUBNODEX = 0 TO SUBNODE$->OUT$BLK.NSUBLKS - 1;
     2764    26720    4         SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX);
     2765    26721    5         DO CASE( SUBSUBNODE$->OUT$BLK.CODE );
     2766    26722
     2767    26723    5          CASE( %ORG );
     2768    26724    5            DISK_CRIT.ORG = '1'B;
     2769    26725    5            TEMP = SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     2770    26726    5            N = DISK_ORGS.NBR;
     2771    26727    5            DISK_ORGS.ORG(N) = TEMP;
     2772    26728    5            DISK_ORGS.NBR = N + 1;
     2773    26729    6            DO WHILE( N >= 1 );            /* Get rid of new ORG if duplicate    */
     2774    26730    6               N = N - 1;
     2775    26731    6               IF DISK_ORGS.ORG(N) = TEMP
     2776    26732    6                THEN DISK_ORGS.NBR = DISK_ORGS.NBR - 1;
     2777    26733    6               END;
     2778    26734
     2779    26735    5          CASE( %DELF );
     2780    26736                  /* DELF bit is on in DCB for deleted files and inactively archived  */
     2781    26737                            /* files, so it has to be handled twice in order to set   */
     2782    26738                                                /* DISK_SRCHCOND.DELF# right          */
     2783    26739    5            DISK_SRCHCOND.DELF# = '1'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:85   
     2784    26740    5            OPTION_MAP.DELF = '1'B;
     2785    26741    6            DO SELECT( COMMAND );
     2786    26742    6               SELECT( %ARCHIVE_CMD );
     2787    26743    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_DELF, );
     2788    26744    6               COMMAND_ERROR = '1'B;
     2789    26745    6               END;
     2790    26746
     2791    26747    5          CASE(%ANYF);
     2792    26748    5            DISK_SRCHCOND.ANYF# = '1'B;
     2793    26749    6            DO SELECT( COMMAND );
     2794    26750    6               SELECT( %ARCHIVE_CMD );
     2795    26751    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_ANYF, );
     2796    26752    6               COMMAND_ERROR = '1'B;
     2797    26753    6               END;
     2798    26754
     2799    26755    5          CASE( %NOLIST );
     2800    26756    5            DISK_SRCHCOND.NOLIST# = '1'B;
     2801    26757
     2802    26758    5          CASE( %BUF );
     2803    26759    5            DISK_SRCHCOND.BUF# = '1'B;
     2804    26760
     2805    26761    5          CASE( %BAD );
     2806    26762    5            DISK_SRCHCOND.BAD# = '1'B;
     2807    26763
     2808    26764    5          CASE( %ARCHIVE );
     2809    26765    5            OPTION_MAP.ARCHIVE = '1'B;
     2810    26766
     2811    26767    5          CASE( %QUEUED );
     2812    26768    5            OPTION_MAP.QUEUED = '1'B;
     2813    26769
     2814    26770    5          CASE( %QS );
     2815    26771    5            OPTION_MAP.QS = '1'B;
     2816    26772
     2817    26773    5          CASE ( %QF );
     2818    26774    5            OPTION_MAP.QF = '1'B;
     2819    26775    6            DO SELECT ( COMMAND );
     2820    26776    6               SELECT ( %ARCHIVE_CMD );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:86   
     2821    26777    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_QF, );
     2822    26778    6               COMMAND_ERROR = '1'B;
     2823    26779    6               END;
     2824    26780
     2825    26781    5          CASE( %ACTIVE );
     2826    26782    5            OPTION_MAP.ACTIVE = '1'B;
     2827    26783
     2828    26784    5          CASE ( %INACTIVE );
     2829    26785    5            OPTION_MAP.INACTIVE = '1'B;
     2830    26786
     2831    26787    5          CASE( %EXPIRED );
     2832    26788    5            DISK_CRIT.TIM = '1'B;
     2833    26789    5            IF SUBSUBNODE$->OUT$BLK.NSUBLKS > 0
     2834    26790    5             THEN DATE_CRIT.NOT_EXPD = '1'B;
     2835    26791    5             ELSE DATE_CRIT.EXPD = '1'B;
     2836    26792    5            IF DATE_CRIT.EXPD AND DATE_CRIT.NOT_EXPD
     2837    26793    6             THEN DO;
     2838    26794    6               COMMAND_ERROR = '1'B;
     2839    26795    6               CALL FLI$RPT_ERR( E_EXPD_NOT_EXPD, );
     2840    26796    6               END;
     2841    26797
     2842    26798    5          CASE( %DATE_SPEC );
     2843    26799    5            CALL FLB_DATE_SPEC
     2844    26800    6             WHENALTRETURN DO;
     2845    26801    6               END;
     2846    26802
     2847    26803    5          CASE(%DIR);
     2848    26804    5            DISK_OPTION.DIR = '1'B;
     2849    26805    6            DO SELECT( COMMAND );
     2850    26806    6               SELECT( %ARCHIVE_CMD );
     2851    26807    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_DIR, );
     2852    26808    6               COMMAND_ERROR = '1'B;
     2853    26809    6               END;
     2854    26810
     2855    26811    5          CASE(%LEA);
     2856    26812    5            DISK_OPTION.LEA = '1'B;
     2857    26813
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:87   
     2858    26814    5          CASE(%PAD);
     2859    26815    5            DISK_OPTION.PAD = '1'B;
     2860    26816    6            DO SELECT( COMMAND );
     2861    26817    6               SELECT( %ARCHIVE_CMD );
     2862    26818    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_PAD, );
     2863    26819    6               COMMAND_ERROR = '1'B;
     2864    26820    6               END;
     2865    26821
     2866    26822    5          CASE(%NOUPDATE);
     2867    26823    5            DISK_OPTION.NOUPDATE = '1'B;
     2868    26824    5          CASE(%OVERLAP_WARN);
     2869    26825    5            DISK_OPTION.OVERLAP_WARN = '1'B;
     2870    26826
     2871    26827    5          CASE(%DELETED_ACCOUNTS);
     2872    26828    5            DISK_OPTION.DELETED_ACCOUNTS = '1'B;
     2873    26829    6            DO SELECT( COMMAND );
     2874    26830    6               SELECT( %ARCHIVE_CMD );
     2875    26831    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_DEL_ACC, );
     2876    26832    6               COMMAND_ERROR = '1'B;
     2877    26833    6               END;
     2878    26834
     2879    26835    5          CASE(%CLEANUP);
     2880    26836    5            DISK_OPTION.CLEANUP = '1'B;
     2881    26837    6            DO SELECT( COMMAND );
     2882    26838    6               SELECT( %ARCHIVE_CMD );
     2883    26839    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_CLEANUP, );
     2884    26840    6               COMMAND_ERROR = '1'B;
     2885    26841    6               END;
     2886    26842
     2887    26843    5          CASE(%TAPE_CHECK);
     2888    26844    5            TAPE_OPTION.CHECK_SPECD = '1'B;
     2889    26845    5            TAPE_OPTION.CHECK = '1'B;
     2890    26846
     2891    26847    5          CASE(%TAPE_CHECKN);
     2892    26848    5            TAPE_OPTION.CHECK_SPECD = '1'B;
     2893    26849    5            TAPE_OPTION.CHECK = '0'B;
     2894    26850
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:88   
     2895    26851    5          CASE(%ACUP);
     2896    26852    5            DISK_OPTION.ACUP = '1'B;
     2897    26853    6            DO SELECT( COMMAND );
     2898    26854    6               SELECT( %ARCHIVE_CMD );
     2899    26855    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_ACUP, );
     2900    26856    6               END;
     2901    26857
     2902    26858    5          CASE(%SCRUB);
     2903    26859    6            DO SUBSUBSUBNODEX=0 TO SUBSUBNODE$->OUT$BLK.NSUBLKS-1;
     2904    26860    7               DO CASE( SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBSUBNODEX)->OUT$BLK.CODE );
     2905    26861    7                CASE( %BCKUP );
     2906    26862    7                  DISK_OPTION.SCRUB.BACKUP = '1'B;
     2907    26863    7                CASE( %CREATOR );
     2908    26864    7                  DISK_OPTION.SCRUB.CREATOR = '1'B;
     2909    26865    7                CASE( %STW );
     2910    26866    7                  DISK_OPTION.SCRUB.STOW = '1'B;
     2911    26867    7                END;
     2912    26868    6               END;
     2913    26869    6            DO SELECT( COMMAND );
     2914    26870    6               SELECT( %ARCHIVE_CMD );
     2915    26871    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_SCRUB, );
     2916    26872    6               COMMAND_ERROR = '1'B;
     2917    26873    6               END;
     2918    26874
     2919    26875    5          CASE(%IDSS);
     2920    26876    5            DISK_OPTION.IDSS = SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     2921    26877    6            DO SELECT( COMMAND );
     2922    26878    6               SELECT( %ARCHIVE_CMD );
     2923    26879    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_IDS, );
     2924    26880    6               COMMAND_ERROR = '1'B;
     2925    26881    6               END;
     2926    26882
     2927    26883    5          CASE(%SWITCH_IF_ERRORS);
     2928    26884    5            DISK_OPTION.SWITCH_IF_ERRORS = '1'B;
     2929    26885    5            CALL CHARBIN ( ERROR_LIMIT, SUBSUBNODE$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.
             26885                     TEXT );
     2930    26886    5            TOTAL_ERRORS = 0;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:89   
     2931    26887
     2932    26888    5          CASE(%PROTTYPE);
     2933    26889    5            TAPE_OPTION.PROTTYPE = SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     2934    26890
     2935    26891    5          CASE(%IOERRORCY);
     2936    26892    5            TAPE_OPTION.IOERRORC = '1'B;
     2937    26893    5            TAPE_OPTION.IOERRORC_SPECD = '1'B;
     2938    26894    5            TAPE_OPEN.V.IOERROK# = '1'B;
     2939    26895
     2940    26896    5          CASE(%IOERRORCN);
     2941    26897    5            TAPE_OPTION.IOERRORC = '0'B;
     2942    26898    5            TAPE_OPTION.IOERRORC_SPECD = '1'B;
     2943    26899    5            TAPE_OPEN.V.IOERROK# = '0'B;
     2944    26900
     2945    26901    5          CASE(%SHARED);
     2946    26902    5            DISK_OPEN_NEXT.V.FUN# = %UPDATE#;
     2947    26903    5            DISK_OPEN_NEXT.V.SHARE# = %IN#;
     2948    26904    5            DISK_OPTION.SHARED = '1'B;
     2949    26905
     2950    26906
     2951    26907    5          END;
     2952    26908    4         END;
     2953    26909
     2954    26910    3      DISK_DESC = DISK_DESC & DISK_DESC_MASK;
     2955    26911        /* If any of the following options is specified, SRCHCOND has to be   */
     2956    26912        /* constructed in a special way to eliminate possible search criteria */
     2957    26913        /* conflicts.                                                         */
     2958    26914
     2959    26915    3      IF DISK_SRCHCOND.ANYF#               /* ANYF overrides any other option    */
     2960    26916    4       THEN DO;
     2961    26917    4         OPTION_MAP = '0'B;
     2962    26918    4         FILE_TYPE = '0'B;
     2963    26919    4         RETURN;
     2964    26920    4         END;
     2965    26921
     2966    26922        /* Look at OPTION_MAP and translate the combination of these options */
     2967    26923        /* into different FILE_TYPE.                                         */
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:90   
     2968    26924
     2969    26925    3      IF OPTION_MAP.ARCHIVE
     2970    26926    3       THEN IF OPTION_MAP.ACTIVE
     2971    26927    3          THEN FILE_TYPE.A = '1'B;
     2972    26928    3          ELSE IF OPTION_MAP.INACTIVE
     2973    26929    3             THEN FILE_TYPE.I = '1'B;
     2974    26930    4             ELSE DO;
     2975    26931    4               FILE_TYPE.A = '1'B;
     2976    26932    4               FILE_TYPE.I = '1'B;
     2977    26933    4               FILE_TYPE.FA = '1'B;
     2978    26934    4               END;
     2979    26935    3      IF OPTION_MAP.QUEUED
     2980    26936    4       THEN DO;
     2981    26937    4         IF OPTION_MAP.ACTIVE
     2982    26938    4          THEN FILE_TYPE.SA = '1'B;
     2983    26939    4          ELSE IF OPTION_MAP.INACTIVE
     2984    26940    4             THEN FILE_TYPE.SI = '1'B;
     2985    26941    5             ELSE DO;
     2986    26942    5               FILE_TYPE.SA = '1'B;
     2987    26943    5               FILE_TYPE.SI = '1'B;
     2988    26944    5               END;
     2989    26945    4         FILE_TYPE.FA = '1'B;
     2990    26946    4         END;
     2991    26947    3      IF OPTION_MAP.QS
     2992    26948    4       THEN DO;
     2993    26949    4         FILE_TYPE.SA = '1'B;
     2994    26950    4         FILE_TYPE.SI = '1'B;
     2995    26951    4         END;
     2996    26952    3      IF OPTION_MAP.QF
     2997    26953    3       THEN FILE_TYPE.FA = '1'B;
     2998    26954    3      IF OPTION_MAP.ACTIVE
     2999    26955    3       THEN IF OPTION_MAP.ARCHIVE
     3000    26956    3          THEN FILE_TYPE.A = '1'B;
     3001    26957    4          ELSE DO;
     3002    26958    4            IF NOT OPTION_MAP.QUEUED AND NOT OPTION_MAP.QF
     3003    26959    5             THEN DO;
     3004    26960    5               FILE_TYPE.SA = '1'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:91   
     3005    26961    5               FILE_TYPE.A = '1'B;
     3006    26962    5               END;
     3007    26963    4            END;
     3008    26964    3      IF OPTION_MAP.INACTIVE
     3009    26965    3       THEN IF OPTION_MAP.ARCHIVE
     3010    26966    3          THEN FILE_TYPE.I = '1'B;
     3011    26967    4          ELSE DO;
     3012    26968    4            IF NOT OPTION_MAP.QUEUED AND NOT OPTION_MAP.QF
     3013    26969    5             THEN DO;
     3014    26970    5               FILE_TYPE.SI = '1'B;
     3015    26971    5               FILE_TYPE.I = '1'B;
     3016    26972    5               END;
     3017    26973    4            END;
     3018    26974    3      IF OPTION_MAP.DELF
     3019    26975    3       THEN FILE_TYPE.DF = '1'B;
     3020    26976
     3021    26977        /* Basically, these different file types involves the same set of DESC  */
     3022    26978        /* bits.  In order to construct an optimum DISK_SRCHCOND setting, we    */
     3023    26979        /* have to look at 3 of these bits and dicide which can be set as       */
     3024    26980        /* the M$OPEN search criteria                                           */
     3025    26981
     3026    26982    3      IF FILE_TYPE.A
     3027    26983    4       THEN DO;
     3028    26984    4         SRCH_BIT = SRCH_BIT & '001'B;
     3029    26985    4         CHECK_SRCH_BIT = '1'B;
     3030    26986    4         END;
     3031    26987    3      IF FILE_TYPE.I
     3032    26988    4       THEN DO;
     3033    26989    4         SRCH_BIT = SRCH_BIT & '101'B;
     3034    26990    4         CHECK_SRCH_BIT = '1'B;
     3035    26991    4         END;
     3036    26992    3      IF FILE_TYPE.SA OR FILE_TYPE.SI OR FILE_TYPE.FA
     3037    26993    4       THEN DO;
     3038    26994    4         IF NOT FILE_TYPE.A AND NOT FILE_TYPE.I /* Searching for queued files only? */
     3039    26995    4          THEN SRCH_BIT = SRCH_BIT & '010'B;
     3040    26996    4          ELSE SRCH_BIT = SRCH_BIT & '011'B;
     3041    26997    4         CHECK_SRCH_BIT = '1'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:92   
     3042    26998    4         END;
     3043    26999
     3044    27000    3      IF CHECK_SRCH_BIT
     3045    27001    4       THEN DO;
     3046    27002    4         IF SRCH_BIT.DELF THEN DISK_SRCHCOND.DELF# = '1'B;
     3047    27003    4         IF SRCH_BIT.QS THEN DISK_SRCHCOND.QS# = '1'B;
     3048    27004    4         IF SRCH_BIT.ARCHIVE THEN DISK_SRCHCOND.ARCHIVE# = '1'B;
     3049    27005    4         END;
     3050    27006
     3051    27007    3      RETURN;
     3052    27008
     3053    27009    3   FLB_DATE_SPEC: PROC ALTRET;
     3054    27010        /*F*  NAME: FLB_DATE_SPEC
     3055    27011              PURPOSE: Process DATE_SPEC node.
     3056    27012        ***/
     3057    27013
     3058    27014        /***
     3059    27015         *** STATIC
     3060    27016         ***/
     3061    27017
     3062    27018    4   DCL DATE_NODE$ PTR STATIC;
     3063    27019    4   DCL DATEX SBIN STATIC;
     3064    27020    4   DCL DECNODEX SBIN STATIC;
     3065    27021    4   DCL DATENODEX SBIN STATIC;
     3066    27022    4   DCL TIMENODE$ PTR STATIC;
     3067    27023    4   DCL TIME_SPECIFIED BIT(1) STATIC;
     3068    27024    4   DCL TIMEX SBIN STATIC;
     3069    27025    4   DCL DECIMAL$ PTR STATIC;
     3070    27026    4   DCL N_O_T SBIN STATIC;
     3071    27027    4   DCL NOT_SPECIFIED BIT(1) STATIC;
     3072    27028    4   DCL WHAT_DATE SBIN STATIC;
     3073    27029    4   DCL DATE_TYPE SBIN STATIC;
     3074    27030    4   DCL USE_ANSDATE BIT(1) STATIC;
     3075    27031
     3076    27032    4   DCL AFT BIT(1) STATIC;
     3077    27033    4   DCL BEF BIT(1) STATIC;
     3078    27034    4   DCL AFT_DELTA SBIN STATIC;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:93   
     3079    27035    4   DCL BEF_DELTA SBIN STATIC;
     3080    27036    4   DCL DISK_AND BIT(1) STATIC;
     3081    27037
     3082    27038        /***
     3083    27039         *** CONSTANT
     3084    27040         ***/
     3085    27041
     3086    27042    4   DCL 1 DATE_INFO(0:%MAX_DATE_TYPE) CONSTANT,
     3087    27043    4         2 HHMMSSSS CHAR(8) INIT(
     3088    27044    4                   '00000000', '23595999', '00000000', '00000000' ),
     3089    27045    4         2 POSITIVE,
     3090    27046    4           3 AFT BIT(1) INIT( '0'B, '1'B, '1'B, '1'B ),
     3091    27047    4           3 BEF BIT(1) INIT( '1'B, '0'B, '1'B, '0'B ),
     3092    27048    4           3 DISK_AND BIT(1) INIT( '1'B, '1'B, '1'B, '1'B ),
     3093    27049    4           3 AFT_DELTA SBIN INIT( 0, 1, 0, 0 ),
     3094    27050    4           3 BEF_DELTA SBIN INIT( -1, 0, 8639999, 0 ),
     3095    27051    4         2 NEGATIVE,
     3096    27052    4           3 AFT BIT(1) INIT( '1'B, '0'B, '1'B, '0'B ),
     3097    27053    4           3 BEF BIT(1) INIT( '0'B, '1'B, '1'B, '1'B ),
     3098    27054    4           3 DISK_AND BIT(1) INIT( '1'B, '1'B, '0'B, '1'B ),
     3099    27055    4           3 AFT_DELTA SBIN INIT( 0, 0, 8640000, 0 ),
     3100    27056    4           3 BEF_DELTA SBIN INIT( 0, 0, -1, -1 );
     3101    27057
     3102    27058        /****************************************/
     3103    27059
     3104    27060        /***
     3105    27061         *** Initialize.
     3106    27062         ***/
     3107    27063
     3108    27064    4      WHAT_DATE = %MODIFIED;
     3109    27065    4      DATE_TYPE = %SINCE;
     3110    27066    4      TIME_SPECIFIED = '0'B;
     3111    27067    4      NOT_SPECIFIED = '0'B;
     3112    27068    4      USE_ANSDATE = '0'B;
     3113    27069    4      DISK_AND = '1'B;
     3114    27070    4      DISK_CRIT.TIM = '1'B;
     3115    27071
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:94   
     3116    27072    5      DO DATENODEX = 0 TO SUBSUBNODE$->OUT$BLK.NSUBLKS - 1;
     3117    27073    5         DATE_NODE$ = SUBSUBNODE$->OUT$BLK.SUBLK$(DATENODEX);
     3118    27074    6         DO CASE( DATE_NODE$->OUT$BLK.CODE );
     3119    27075
     3120    27076    6          CASE( %N_O_T );
     3121    27077    6            NOT_SPECIFIED = '1'B;
     3122    27078
     3123    27079    6          CASE( %WHAT_DATE );
     3124    27080    6            WHAT_DATE = DATE_NODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     3125    27081
     3126    27082    6          CASE( %DATE_TYPE );
     3127    27083    6            DATE_TYPE = DATE_NODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     3128    27084
     3129    27085    6          CASE( %DELTA );
     3130    27086    6            TIME_SPECIFIED = '1'B;
     3131    27087    6            CALL CHARBIN( TEMP, DATE_NODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT );
     3132    27088    6            CALL XUD$UTS_ADJUST(DATEUTS,NOW_UTS,-(%UTS_CSEC_HOUR#*TEMP));
     3133    27089
     3134    27090    6          CASE( %DATE_N_TIME );
     3135    27091    6            USE_ANSDATE = '1'B;
     3136    27092    6            DATEUTS = NOW_UTS;
     3137    27093    6            CALL M$TIME( GET_ANSDATE_DATEUTS );
     3138    27094    6            DATEX = 0;
     3139    27095    7            DO DECNODEX = 0 TO DATE_NODE$->OUT$BLK.NSUBLKS - 1;
     3140    27096    7               DECIMAL$ = DATE_NODE$->OUT$BLK.SUBLK$(DECNODEX);
     3141    27097    7               IF DECIMAL$->OUT$BLK.CODE = %T_I_M_E
     3142    27098    8                THEN DO;
     3143    27099    8                  ANSDATEPIECE.HHMMSSSS = '00000000';
     3144    27100    8                  TIME_SPECIFIED = '1'B;
     3145    27101    8                  TIMENODE$ = DECIMAL$;
     3146    27102    9                  DO TIMEX=0 TO TIMENODE$->OUT$BLK.NSUBLKS-1;
     3147    27103    9                     DECIMAL$ = TIMENODE$->OUT$BLK.SUBLK$(TIMEX);
     3148    27104   10                     DO CASE(TIMEX);
     3149    27105   10                      CASE(0);
     3150    27106   10                        CALL FLB_SETDATE( ANSDATE.HOUR );
     3151    27107   10                      CASE(1);
     3152    27108   10                        CALL FLB_SETDATE( ANSDATE.MINUTE );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:95   
     3153    27109   10                      CASE(2);
     3154    27110   10                        CALL FLB_SETDATE( ANSDATE.SECOND );
     3155    27111   10                      CASE(3);
     3156    27112   10                        CALL FLB_SETDATE( ANSDATE.SEC100THS );
     3157    27113   10                      END;
     3158    27114    9                     END;
     3159    27115    8                  END;
     3160    27116    8                ELSE DO;
     3161    27117    9                  DO CASE( DATEX );
     3162    27118    9                   CASE(0);
     3163    27119    9                     CALL FLB_SETDATE( ANSDATE.MONTH );
     3164    27120    9                   CASE(1);
     3165    27121    9                     CALL FLB_SETDATE( ANSDATE.DAY );
     3166    27122    9                   CASE(2);
     3167    27123    9                     CALL FLB_SETDATE( ANSDATE.YEAR );
     3168    27124    9                   END;
     3169    27125    8                  DATEX = DATEX + 1;
     3170    27126    8                  END;
     3171    27127    7               END;
     3172    27128    6          END;
     3173    27129    5         END;
     3174    27130
     3175    27131        /***
     3176    27132         *** Set HH:MM:SS.SS default according to type of date specification.
     3177    27133         ***/
     3178    27134
     3179    27135    4      BEF = '0'B;
     3180    27136    4      AFT = '0'B;
     3181    27137    4      IF NOT TIME_SPECIFIED
     3182    27138    4       THEN ANSDATEPIECE.HHMMSSSS = DATE_INFO.HHMMSSSS(DATE_TYPE);
     3183    27139    4      IF NOT_SPECIFIED
     3184    27140    5       THEN DO;
     3185    27141    5         IF DATE_INFO.NEGATIVE.AFT(DATE_TYPE)
     3186    27142    6          THEN DO;
     3187    27143    6            AFT = '1'B;
     3188    27144    6            AFT_DELTA = DATE_INFO.NEGATIVE.AFT_DELTA(DATE_TYPE);
     3189    27145    6            END;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:96   
     3190    27146    5         IF DATE_INFO.NEGATIVE.BEF(DATE_TYPE)
     3191    27147    6          THEN DO;
     3192    27148    6            BEF = '1'B;
     3193    27149    6            BEF_DELTA = DATE_INFO.NEGATIVE.BEF_DELTA(DATE_TYPE);
     3194    27150    6            END;
     3195    27151    5         DISK_AND = DATE_INFO.NEGATIVE.DISK_AND(DATE_TYPE);
     3196    27152    5         END;
     3197    27153    5       ELSE DO;
     3198    27154    5         IF DATE_INFO.POSITIVE.AFT(DATE_TYPE)
     3199    27155    6          THEN DO;
     3200    27156    6            AFT = '1'B;
     3201    27157    6            AFT_DELTA = DATE_INFO.POSITIVE.AFT_DELTA(DATE_TYPE);
     3202    27158    6            END;
     3203    27159    5         IF DATE_INFO.POSITIVE.BEF(DATE_TYPE)
     3204    27160    6          THEN DO;
     3205    27161    6            BEF = '1'B;
     3206    27162    6            BEF_DELTA = DATE_INFO.POSITIVE.BEF_DELTA(DATE_TYPE);
     3207    27163    6            END;
     3208    27164    5         DISK_AND = DATE_INFO.POSITIVE.DISK_AND(DATE_TYPE);
     3209    27165    5         END;
     3210    27166
     3211    27167        /***
     3212    27168         *** Convert ANS format date into UTS.
     3213    27169         ***/
     3214    27170
     3215    27171    4      IF USE_ANSDATE
     3216    27172    5       THEN DO;
     3217    27173    5         CALL M$TIME( GET_DATEUTS_ANSDATE )
     3218    27174    6          WHENALTRETURN DO;
     3219    27175    6            CALL FLI$RPT_ERR( , );
     3220    27176    6            COMMAND_ERROR = '1'B;
     3221    27177    6            ALTRETURN;
     3222    27178    6            END;
     3223    27179    5         END;
     3224    27180
     3225    27181    4      DISK_AND_OP(WHAT_DATE) = DISK_AND;
     3226    27182    4      IF BEF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:97   
     3227    27183    5       THEN DO;
     3228    27184    5         CALL XUD$UTS_ADJUST(DISK_BEF_UTS(WHAT_DATE),DATEUTS,BEF_DELTA);
     3229    27185    5         IF DATE_CRIT.BEF(WHAT_DATE)
     3230    27186    6          THEN DO;                         /* Already specified                  */
     3231    27187    7            DO CASE( WHAT_DATE );
     3232    27188    7             CASE( %ACCESSED );
     3233    27189    7               VLP_ERRCODE = E_DUP_BEF_ACC;
     3234    27190    7             CASE( %MODIFIED );
     3235    27191    7               VLP_ERRCODE = E_DUP_BEF_MOD;
     3236    27192    7             CASE( %CREATED );
     3237    27193    7               VLP_ERRCODE = E_DUP_BEF_CRE;
     3238    27194    7             CASE(%BACKED_UP);
     3239    27195    7               VLP_ERRCODE = E_DUP_BEF_BAC;
     3240    27196    7             CASE(%ARCHIVED);
     3241    27197    7               VLP_ERRCODE = E_DUP_BEF_ARC;
     3242    27198    7             END;
     3243    27199    6            CALL FLI$RPT_ERR( VLP_ERRCODE, );
     3244    27200    6            COMMAND_ERROR = '1'B;
     3245    27201    6            END;
     3246    27202    5         DATE_CRIT.BEF(WHAT_DATE) = '1'B;
     3247    27203    5         END;
     3248    27204    4      IF AFT
     3249    27205    5       THEN DO;
     3250    27206    5         CALL XUD$UTS_ADJUST(DISK_AFT_UTS(WHAT_DATE),DATEUTS,AFT_DELTA);
     3251    27207    5         IF DATE_CRIT.AFT(WHAT_DATE)
     3252    27208    6          THEN DO;                         /* Already specified                  */
     3253    27209    7            DO CASE( WHAT_DATE );
     3254    27210    7             CASE( %ACCESSED );
     3255    27211    7               VLP_ERRCODE = E_DUP_AFT_ACC;
     3256    27212    7             CASE( %MODIFIED );
     3257    27213    7               VLP_ERRCODE = E_DUP_AFT_MOD;
     3258    27214    7             CASE( %CREATED );
     3259    27215    7               VLP_ERRCODE = E_DUP_AFT_CRE;
     3260    27216    7             CASE( %BACKED_UP );
     3261    27217    7               VLP_ERRCODE = E_DUP_AFT_BAC;
     3262    27218    7             CASE( %ARCHIVED );
     3263    27219    7               VLP_ERRCODE = E_DUP_AFT_ARC;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:98   
     3264    27220    7             END;
     3265    27221    6            CALL FLI$RPT_ERR( VLP_ERRCODE, );
     3266    27222    6            COMMAND_ERROR = '1'B;
     3267    27223    6            END;
     3268    27224    5         DATE_CRIT.AFT(WHAT_DATE) = '1'B;
     3269    27225    5         END;
     3270    27226
     3271    27227    4      IF COMMAND = %REQUALIFY
     3272    27228    5       THEN DO;
     3273    27229    6         DO CASE( WHAT_DATE );
     3274    27230    6          CASE( %ARCHIVED );
     3275    27231    6            COMMAND = %REQUALIFY_ARCHIVE;
     3276    27232    6          CASE( ELSE );
     3277    27233    6            COMMAND = %REQUALIFY_BACKUP;
     3278    27234    6          END;
     3279    27235    5         END;
     3280    27236
     3281    27237    4      RETURN;
     3282    27238
     3283    27239    4   FLB_SETDATE: PROC( DATEFIELD );
     3284    27240
     3285    27241    5   DCL DATEFIELD CHAR(2) CALIGNED;
     3286    27242
     3287    27243        /********************/
     3288    27244
     3289    27245    5      CALL CHARBIN( TEMP, DECIMAL$->OUT$SYM.TEXT );
     3290    27246    5      CALL BINCHAR( DATEFIELD, TEMP );
     3291    27247    5      RETURN;
     3292    27248
     3293    27249    5   END FLB_SETDATE;
     3294    27250
     3295    27251
     3296    27252    4   END FLB_DATE_SPEC;
     3297    27253
     3298    27254    3   END FLB_DISK_OPTION_LIST;
     3299    27255        /**********************************************************************/
     3300    27256
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:99   
     3301    27257    2   FLB_NUTHER_FILE_SPEC: PROC;
     3302    27258
     3303    27259    3      DISK_FILE_SPEC.NBR_LEFT = DISK_FILE_SPEC.NBR_LEFT - 1;
     3304    27260    3      IF DISK_FILE_SPEC.NBR_LEFT < 0
     3305    27261    4       THEN DO;                            /* Must allocate more                 */
     3306    27262    4         TEMP = 5 * LENGTHW(DISK_FILE_SPEC.SPEC(0));
     3307    27263    4         CALL FLI$ALLOC( TEMP, TEMP );     /* Allocate 5 more                    */
     3308    27264    4         DISK_FILE_SPEC.NBR_LEFT = DISK_FILE_SPEC.NBR_LEFT + 5;
     3309    27265    4         END;
     3310    27266    3      N = DISK_FILE_SPEC.NBR;
     3311    27267    3      DISK_FILE_SPEC.SPEC.START.ACCT(N) = START_ACCT;
     3312    27268    3      DISK_FILE_SPEC.SPEC.START.FILE(N) = START_FILE;
     3313    27269    3      DISK_FILE_SPEC.SPEC.STOP.ACCT(N) = STOP_ACCT;
     3314    27270    3      DISK_FILE_SPEC.SPEC.STOP.FILE(N) = STOP_FILE;
     3315    27271    3      DISK_FILE_SPEC.SPEC.SKIP(N) = 0;
     3316    27272    3      DISK_FILE_SPEC.NBR = N + 1;
     3317    27273
     3318    27274    3      IF DISK_FILE_SPEC.PASSWORD_SPEC
     3319    27275    3       THEN DISK_FILE_SPEC.PASSWORD# = FID_PASS.PASS#;
     3320    27276    3       ELSE DISK_FILE_SPEC.PASSWORD# = ' ';
     3321    27277    3      RETURN;
     3322    27278
     3323    27279    3   END FLB_NUTHER_FILE_SPEC;
     3324    27280        /**********************************************************************/
     3325    27281
     3326    27282    2   FLB_FID_RANGE: PROC( FID_RANGE$ );
     3327    27283        /*F*  NAME: FLB_FID_RANGE
     3328    27284              PURPOSE: Process FID_RANGE node.
     3329    27285        ***/
     3330    27286
     3331    27287    3   DCL FID_RANGE$ PTR;
     3332    27288
     3333    27289         /***
     3334    27290          *** STATIC
     3335    27291          ***/
     3336    27292
     3337    27293    3   DCL I SBIN STATIC;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:100  
     3338    27294    3   DCL FID_RANGE_SUBLK$ PTR STATIC;
     3339    27295
     3340    27296        %EQU FROM_RANGE@ = 0;
     3341    27297        %EQU TO_RANGE@ = 1;
     3342    27298
     3343    27299        /******************************/
     3344    27300
     3345    27301
     3346    27302
     3347    27303    3      IF ACCT.ACCT# = ' '
     3348    27304    3       THEN ACCT.ACCT# = B$JIT.FACCN;
     3349    27305    3      DISK_FILE_SPEC.PASSWORD_SPEC = '0'B; /* Passwords never spec'd for ranges  */
     3350    27306    3      FID_RANGE_SUBLK$ = FID_RANGE$->OUT$BLK.SUBLK$(0);
     3351    27307    4      DO CASE( FID_RANGE_SUBLK$->OUT$BLK.CODE );
     3352    27308    4       CASE( %ALL_RANGE );
     3353    27309    4         START_ACCT = FIRST_ACCT;
     3354    27310    4         START_FILE = FIRST_FILE;
     3355    27311    4         STOP_ACCT = LAST_ACCT;
     3356    27312    4         STOP_FILE = LAST_FILE;
     3357    27313
     3358    27314    4       CASE( %TO_STOP );
     3359    27315    4         START_ACCT = FIRST_ACCT;
     3360    27316    4         START_FILE = FIRST_FILE;
     3361    27317    4         CALL FLB_FILE_N_ACCOUNT( FID_RANGE_SUBLK$->OUT$BLK.SUBLK$(0),%TO_RANGE@ );
     3362    27318    4         STOP_ACCT = ACCT;
     3363    27319    4         STOP_FILE = FILE;
     3364    27320
     3365    27321    4       CASE( %FROM_START );
     3366    27322    4         CALL FLB_FILE_N_ACCOUNT( FID_RANGE_SUBLK$->OUT$BLK.SUBLK$(0),%FROM_RANGE@ );
     3367    27323    4         START_ACCT = ACCT;
     3368    27324    4         START_FILE = FILE;
     3369    27325    4         STOP_ACCT = LAST_ACCT;
     3370    27326    4         STOP_FILE = LAST_FILE;
     3371    27327
     3372    27328    4       CASE( %FROM_TO );
     3373    27329    4         CALL FLB_FILE_N_ACCOUNT( FID_RANGE_SUBLK$->OUT$BLK.SUBLK$(0),%FROM_RANGE@ );
     3374    27330    4         START_ACCT = ACCT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:101  
     3375    27331    4         START_FILE = FILE;
     3376    27332    4         STOP_ACCT = ACCT;
     3377    27333        /***
     3378    27334         *** If no file specifed, then all files in account are considered.
     3379    27335         ***/
     3380    27336    4         IF FID_RANGE_SUBLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %
             27336                  ACCOUNT_NAME
     3381    27337    4          THEN STOP_FILE = LAST_FILE;
     3382    27338    4          ELSE STOP_FILE = FILE;
     3383    27339
     3384    27340    4       CASE( %START_STOP );
     3385    27341    4         CALL FLB_FILE_N_ACCOUNT( FID_RANGE_SUBLK$->OUT$BLK.SUBLK$(0),%FROM_RANGE@ );
     3386    27342    4         START_ACCT = ACCT;
     3387    27343    4         START_FILE = FILE;
     3388    27344    4         CALL FLB_FILE_N_ACCOUNT( FID_RANGE_SUBLK$->OUT$BLK.SUBLK$(1),%TO_RANGE@ );
     3389    27345    4         STOP_ACCT = ACCT;
     3390    27346    4         STOP_FILE = FILE;
     3391    27347
     3392    27348    4       END;
     3393    27349
     3394    27350    3      IF START_FILE = NO_FILE
     3395    27351    3       THEN START_FILE = FIRST_FILE;
     3396    27352
     3397    27353    3      IF START_ACCT > STOP_ACCT
     3398    27354    3        OR (START_ACCT = STOP_ACCT AND START_FILE > STOP_FILE)
     3399    27355    4       THEN DO;
     3400    27356    4         COMMAND_ERROR = '1'B;
     3401    27357    4         CALL FLI$RPT_ERR( E_BAD_RANGE, );
     3402    27358    4         END;
     3403    27359    3      RETURN;
     3404    27360
     3405    27361    3   FLB_FILE_N_ACCOUNT: PROC( FILE_N_ACCOUNT$,RANGE );
     3406    27362
     3407    27363    4   DCL FILE_N_ACCOUNT$ PTR;
     3408    27364    4   DCL RANGE UBIN;               /* Indicates if processing from or to range     */
     3409    27365
     3410    27366        /********************/
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:102  
     3411    27367
     3412    27368    4      IF FILE_N_ACCOUNT$->OUT$BLK.NSUBLKS = 2
     3413    27369    5       THEN DO;                  /* Second must be account; first must be file   */
     3414    27370    5         ACCT.ACCT# = FILE_N_ACCOUNT$->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;
     3415    27371    5         FILE.L# = FILE_N_ACCOUNT$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT
             27371                  ;
     3416    27372    5         FILE.NAME# = FILE_N_ACCOUNT$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$SYM.
             27372                  TEXT;
     3417    27373    5         END;
     3418    27374    5       ELSE DO;
     3419    27375    5         TEMP$ = FILE_N_ACCOUNT$->OUT$BLK.SUBLK$(0);
     3420    27376    5         IF TEMP$->OUT$BLK.CODE = %ACCOUNT_NAME
     3421    27377    6          THEN DO;
     3422    27378    6            IF RANGE = %FROM_RANGE@   /* Set default file name since none spec'd */
     3423    27379    6             THEN FILE = FIRST_FILE;
     3424    27380    6             ELSE FILE = LAST_FILE;
     3425    27381    6            ACCT.ACCT# = TEMP$->OUT$SYM.TEXT;
     3426    27382    6            END;
     3427    27383    6          ELSE DO;
     3428    27384    6            ACCT.ACCT# = PREV_ACCT.ACCT#;
     3429    27385    6            FILE.L# = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;
     3430    27386    6            FILE.NAME# = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     3431    27387    6            END;
     3432    27388    5         END;
     3433    27389
     3434    27390    4      IF ACCT.ACCT# = ' '
     3435    27391    5       THEN DO;
     3436    27392    5         ACCT.ACCT# = B$JIT.FACCN;
     3437    27393        /*    COMMAND_ERROR = '1'B; */
     3438    27394        /*    CALL FLI$RPT_ERR( E_MUST_ACCT, ); */
     3439    27395    5         END;
     3440    27396    4       ELSE IF FIRST_ACCT_SPECIFIED.ACCT# = ' '
     3441    27397    4          THEN FIRST_ACCT_SPECIFIED.ACCT# = ACCT.ACCT#;
     3442    27398    4      PREV_ACCT = ACCT;
     3443    27399
     3444    27400    4      RETURN;
     3445    27401
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:103  
     3446    27402    4   END FLB_FILE_N_ACCOUNT;
     3447    27403
     3448    27404    3   END FLB_FID_RANGE;
     3449    27405
     3450    27406    2   FLB_ORDER_RANGE: PROC ALTRET;
     3451    27407        /*F*  NAME: FLB_ORDER_RANGE
     3452    27408              PURPOSE: Orders file range/skip specifications.
     3453    27409        ***/
     3454    27410
     3455    27411         /***
     3456    27412          *** STATIC
     3457    27413          ***/
     3458    27414
     3459    27415    3   DCL CX SBIN STATIC;
     3460    27416    3   DCL C SBIN STATIC;
     3461    27417    3   DCL I SBIN STATIC;
     3462    27418    3   DCL J SBIN STATIC;
     3463    27419    3   DCL M SBIN STATIC;
     3464    27420    3   DCL I_SWAP SBIN STATIC;
     3465    27421    3   DCL LAST_RANGEX SBIN STATIC;
     3466    27422    3   DCL RANGE_START$ PTR STATIC;
     3467    27423    3   DCL RANGE_STOP$ PTR STATIC;
     3468    27424    3   DCL SKIP_START$ PTR STATIC;
     3469    27425    3   DCL SKIP_STOP$ PTR STATIC;
     3470    27426    3   DCL 1 TEMP_SPEC CHAR(40) STATIC;
     3471    27427    3   DCL RANGE_FOUND BIT(1) STATIC;
     3472    27428
     3473    27429        /***
     3474    27430         *** BASED
     3475    27431         ***/
     3476    27432
     3477    27433    3   DCL RANGE_START CHAR(40) BASED(RANGE_START$);
     3478    27434    3   DCL RANGE_STOP CHAR(40) BASED(RANGE_STOP$);
     3479    27435    3   DCL SKIP_START CHAR(40) BASED(SKIP_START$);
     3480    27436    3   DCL SKIP_STOP CHAR(40) BASED(SKIP_STOP$);
     3481    27437
     3482    27438        /***
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:104  
     3483    27439         *** CONSTANT
     3484    27440         ***/
     3485    27441
     3486    27442    3   DCL FIRST_LEGAL_CHAR UBIN BYTE CONSTANT INIT(ASCBIN('$'));
     3487    27443    3   DCL LAST_LEGAL_CHAR UBIN BYTE CONSTANT INIT(ASCBIN('z'));
     3488    27444    3   DCL LEGAL_CHAR(0:127) BIT(1) UNAL CONSTANT INIT(
     3489    27445    3    '0'B*32, '0'B*4, '1'B, '0'B*8, '1'B, '0'B*2, '1'B*11,
     3490    27446    3    '0'B*6, '1'B*26, '0'B*4, '1'B, '0'B, '1'B*26, '0'B*5 );
     3491    27447
     3492    27448        /*****************************************/
     3493    27449
     3494    27450        /***
     3495    27451         *** If no range or skip, make default structure.
     3496    27452         ***/
     3497    27453
     3498    27454    3      IF NOT RANGE_SPECIFIED AND NOT SKIP_SPECIFIED
     3499    27455    4       THEN DO;
     3500    27456    4         TEMP = LENGTHW(DISK_FILE_SPEC.NBR)+LENGTHW(DISK_FILE_SPEC.NBR_LEFT)
     3501    27457    4           + LENGTHW(DISK_FILE_SPEC.PASSWORD_SPEC)
     3502    27458    4           + LENGTHW(DISK_FILE_SPEC.PASSWORD#)
     3503    27459    4           + LENGTHW(DISK_FILE_SPEC.SPEC(0)); /* One entry only                  */
     3504    27460    4         CALL FLI$ALLOC( TEMP, DISK_FILE_SPEC$ );
     3505    27461    4         DISK_FILE_SPEC.NBR_LEFT = 1;
     3506    27462    4         DISK_FILE_SPEC.NBR = 0;
     3507    27463    4         END;
     3508    27464
     3509    27465        /***
     3510    27466         *** Supply default range if none specified.
     3511    27467         ***/
     3512    27468
     3513    27469    3      IF NOT RANGE_SPECIFIED
     3514    27470    4       THEN DO;
     3515    27471    4         START_ACCT = FIRST_ACCT;
     3516    27472    4         START_FILE = FIRST_FILE;
     3517    27473    4         STOP_ACCT = LAST_ACCT;
     3518    27474    4         STOP_FILE = LAST_FILE;
     3519    27475    4         CALL FLB_NUTHER_FILE_SPEC;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:105  
     3520    27476    4         END;
     3521    27477
     3522    27478        /***
     3523    27479         *** Order file range specifications.
     3524    27480         ***/
     3525    27481
     3526    27482    3      CALL FLB_SORT_RANGE;
     3527    27483        /***
     3528    27484         *** Check for any range or skip overlaps.
     3529    27485         ***/
     3530    27486
     3531    27487    3      I = 0;
     3532    27488    4      DO WHILE( I <= DISK_FILE_SPEC.NBR - 2 );
     3533    27489    4         J = I + 1;
     3534    27490    4         IF DISK_FILE_SPEC.SPEC.SKIP(I) ~=
     3535    27491    4           DISK_FILE_SPEC.SPEC.SKIP(J)
     3536    27492    4          THEN LAST_RANGEX = I;
     3537    27493    5          ELSE DO;
     3538    27494    5            IF DISK_FILE_SPEC.SPEC.STOPCHARS(I) >= DISK_FILE_SPEC.SPEC.STARTCHARS(J
     3539    27495    5              )
     3540    27496    6             THEN DO;                      /* Out of order                       */
     3541    27497    6               IF DISK_OPTION.OVERLAP_WARN
     3542    27498    7                THEN DO;
     3543    27499    7                  IF DISK_FILE_SPEC.SPEC.SKIP(I) > 0
     3544    27500    7                   THEN CALL FLI$RPT_ERR( E_WARN_OVERLAP_SKIP, );
     3545    27501    7                   ELSE CALL FLI$RPT_ERR( E_WARN_OVERLAP_RANGE, );
     3546    27502    7                  IF DISK_FILE_SPEC.SPEC.STOPCHARS(I) < DISK_FILE_SPEC.SPEC.STOPCHARS(J
             27502                           )
     3547    27503    7                   THEN               /* Change first range's stop to second's   */
     3548    27504    7                     DISK_FILE_SPEC.SPEC.STOPCHARS(I) = DISK_FILE_SPEC.SPEC.STOPCHARS(J
             27504                              );
     3549    27505    8                  DO J=I+2 TO DISK_FILE_SPEC.NBR - 1;
     3550    27506    8                     DISK_FILE_SPEC.SPECCHARS(J-1) = DISK_FILE_SPEC.SPECCHARS(J);
     3551    27507    8                     END;
     3552    27508    7                  I = I - 1;
     3553    27509    7                  DISK_FILE_SPEC.NBR = DISK_FILE_SPEC.NBR - 1;
     3554    27510    7                  END;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:106  
     3555    27511    7                ELSE DO;
     3556    27512    7                  IF DISK_FILE_SPEC.SPEC.SKIP(I) > 0
     3557    27513    7                   THEN CALL FLI$RPT_ERR( E_OVERLAP_SKIP, );
     3558    27514    7                   ELSE CALL FLI$RPT_ERR( E_OVERLAP_RANGE, );
     3559    27515    7                  COMMAND_ERROR = '1'B;
     3560    27516    7                  END;
     3561    27517    6               END;
     3562    27518    5            END;
     3563    27519    4         I = I + 1;
     3564    27520    4         END;
     3565    27521
     3566    27522        /***
     3567    27523         *** Rearrange ranges by eliminating skips.
     3568    27524         ***/
     3569    27525
     3570    27526    3      IF NOT SKIP_SPECIFIED
     3571    27527    4       THEN DO;
     3572    27528    4         IF COMMAND_ERROR
     3573    27529    4          THEN ALTRETURN;
     3574    27530    4          ELSE RETURN;
     3575    27531    4         END;
     3576    27532
     3577    27533    3      M = DISK_FILE_SPEC.NBR - 1;
     3578    27534    4      DO WHILE( M > LAST_RANGEX );         /* For each skip specification        */
     3579    27535
     3580    27536    4         I = 0;
     3581    27537    4         RANGE_FOUND = '0'B;
     3582    27538    5         DO WHILE( I <= LAST_RANGEX AND NOT RANGE_FOUND );
     3583    27539    5            RANGE_STOP$ = ADDR(DISK_FILE_SPEC.SPEC.STOPCHARS(I));
     3584    27540    5            SKIP_START$ = ADDR(DISK_FILE_SPEC.SPEC.STARTCHARS(M));
     3585    27541
     3586    27542    5            IF RANGE_STOP >= SKIP_START
     3587    27543    6             THEN DO;                      /* Skip must be within this range     */
     3588    27544    6               RANGE_FOUND = '1'B;
     3589    27545    6               RANGE_START$ = ADDR(DISK_FILE_SPEC.SPEC.STARTCHARS(I));
     3590    27546    6               SKIP_STOP$ = ADDR(DISK_FILE_SPEC.SPEC.STOPCHARS(M));
     3591    27547    6               IF RANGE_STOP < SKIP_STOP
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:107  
     3592    27548    6                 OR RANGE_START > SKIP_START
     3593    27549    7                THEN DO;         /* Skip is not wholly contained within a range  */
     3594    27550    7                  COMMAND_ERROR = '1'B;
     3595    27551    7                  CALL FLI$RPT_ERR( E_BAD_SKIP_N_RANGE, );
     3596    27552    7                  END;
     3597    27553    7                ELSE DO;
     3598    27554    7                  IF RANGE_START < SKIP_START
     3599    27555    8                   THEN DO;           /* At least one new range should be formed */
     3600    27556    8                     IF RANGE_STOP > SKIP_STOP
     3601    27557    9                      THEN DO;             /* Two new ranges!                    */
     3602    27558    9                        CALL FLB_PREV_SPEC( SKIP_START );
     3603    27559    9                        CALL FLB_NEXT_SPEC( SKIP_STOP );
     3604    27560    9                        TEMP_SPEC = RANGE_STOP;
     3605    27561    9                        RANGE_STOP = SKIP_START;
     3606    27562    9                        SKIP_START = SKIP_STOP;
     3607    27563    9                        SKIP_STOP = TEMP_SPEC;
     3608    27564    9                        DISK_FILE_SPEC.SPEC.SKIP(M) = 0;
     3609    27565                                                /* Use as range instead of skip now   */
     3610    27566    9                        SPECCHARS = DISK_FILE_SPEC.SPECCHARS(M);
     3611    27567   10                        DO J = M DOWNTO I+1 BY -1;
     3612    27568   10                           DISK_FILE_SPEC.SPECCHARS(J) = DISK_FILE_SPEC.SPECCHARS(J-1);
     3613    27569   10                           END;
     3614    27570    9                        DISK_FILE_SPEC.SPECCHARS(I+1) = SPECCHARS;
     3615    27571    9                        LAST_RANGEX = LAST_RANGEX + 1;
     3616    27572    9                        M = M + 1;
     3617    27573    9                        END;
     3618    27574    9                      ELSE DO;             /* Only one new range                 */
     3619    27575    9                        CALL FLB_PREV_SPEC( SKIP_START );
     3620    27576    9                        RANGE_STOP = SKIP_START;
     3621    27577    9                        DISK_FILE_SPEC.NBR = DISK_FILE_SPEC.NBR - 1;
     3622    27578    9                        END;
     3623    27579    8                     END;
     3624    27580    8                   ELSE DO;
     3625    27581    8                     IF RANGE_STOP > SKIP_STOP
     3626    27582    9                      THEN DO;             /* One new range                      */
     3627    27583    9                        CALL FLB_NEXT_SPEC( SKIP_STOP );
     3628    27584    9                        RANGE_START = SKIP_STOP;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:108  
     3629    27585    9                        DISK_FILE_SPEC.NBR = DISK_FILE_SPEC.NBR - 1;
     3630    27586    9                        END;
     3631    27587    9                      ELSE DO;             /* Skip eliminated range              */
     3632    27588    9                        DISK_FILE_SPEC.SPEC.SKIP(I) = 1;
     3633    27589   10                        DO J=I TO M - 2;
     3634    27590   10                           DISK_FILE_SPEC.SPECCHARS(J) = DISK_FILE_SPEC.SPECCHARS(J+1);
     3635    27591   10                           END;
     3636    27592    9                        DISK_FILE_SPEC.NBR = DISK_FILE_SPEC.NBR - 2;
     3637    27593    9                        M = M - 1;
     3638    27594    9                        LAST_RANGEX = LAST_RANGEX - 1;
     3639    27595    9                        END;
     3640    27596    8                     END;
     3641    27597    7                  END;
     3642    27598    6               END;
     3643    27599    5            I = I + 1;
     3644    27600    5            END;
     3645    27601    4         IF NOT RANGE_FOUND
     3646    27602    5          THEN DO;                         /* Skip not within any range          */
     3647    27603    5            COMMAND_ERROR = '1'B;
     3648    27604    5            CALL FLI$RPT_ERR( E_BAD_SKIP_N_RANGE, );
     3649    27605    5            END;
     3650    27606    4         M = M - 1;
     3651    27607    4         END;
     3652    27608
     3653    27609        /***
     3654    27610         *** If no ranges left, no files have been specified.
     3655    27611         ***/
     3656    27612
     3657    27613    3      IF DISK_FILE_SPEC.NBR <= 0
     3658    27614    4       THEN DO;
     3659    27615    4         COMMAND_ERROR = '1'B;
     3660    27616    4         CALL FLI$RPT_ERR( E_NO_RANGE, );
     3661    27617    4         END;
     3662    27618
     3663    27619    3      RETURN;
     3664    27620
     3665    27621    3   FLB_NEXT_SPEC: PROC( SPEC );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:109  
     3666    27622        /*F* NAME: FLB_NEXT_SPEC
     3667    27623             PURPOSE: Calculates next acct/file specification.
     3668    27624        */
     3669    27625
     3670    27626    4   DCL 1 SPEC,
     3671    27627    4         2 ACCT# CHAR(8),
     3672    27628    4         2 ACCTB(0:7) REDEF ACCT# UBIN BYTE CALIGNED,
     3673    27629    4         2 FILE,
     3674    27630    4           3 NAME# CHAR(31) CALIGNED,
     3675    27631    4           3 L# UBIN BYTE CALIGNED;
     3676    27632
     3677    27633        /***
     3678    27634         *** STATIC
     3679    27635         ***/
     3680    27636
     3681    27637    4   DCL N SBIN STATIC;
     3682    27638
     3683    27639        /****************************************/
     3684    27640
     3685    27641    4      N = SPEC.FILE.L#;
     3686    27642    4      CALL FLB_NEXT( SPEC.FILE, N, LENGTHV(SPEC.FILE.NAME#) )
     3687    27643    5       WHENRETURN DO;                      /* Get a next file name               */
     3688    27644    5         SPEC.FILE.L# = N;
     3689    27645    5         END;
     3690    27646    5       WHENALTRETURN DO;
     3691    27647    5         SPEC.FILE.L# = N;
     3692    27648    5         N = LENGTHV(SPEC.ACCT#);
     3693    27649    6         DO WHILE( N >= 0 AND SPEC.ACCTB(N) = ASCBIN(' ') );
     3694    27650    6            N = N - 1;
     3695    27651    6            END;
     3696    27652    5         N = N + 1;
     3697    27653    5         CALL FLB_NEXT( SPEC.ACCT#, N, LENGTHV(SPEC.ACCT#) )
     3698    27654    6          WHENALTRETURN DO;
     3699    27655    6            COMMAND_ERROR = '1'B;
     3700    27656    6            CALL FLI$RPT_ERR( E_NO_NEXT_SPEC, );
     3701    27657    6            END;
     3702    27658    5         END;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:110  
     3703    27659    4      RETURN;
     3704    27660
     3705    27661    4   END FLB_NEXT_SPEC;
     3706    27662        /********************************************************************/
     3707    27663    3   FLB_PREV_SPEC: PROC( SPEC );
     3708    27664        /*F* NAME: FLB_PREV_SPEC
     3709    27665             PURPOSE: Calculates previous acct/file specification.
     3710    27666        */
     3711    27667
     3712    27668    4   DCL 1 SPEC,
     3713    27669    4         2 ACCT# CHAR(8),
     3714    27670    4         2 ACCTB(0:7) REDEF ACCT# UBIN BYTE CALIGNED,
     3715    27671    4         2 FILE,
     3716    27672    4           3 NAME# CHAR(31) CALIGNED,
     3717    27673    4           3 L# UBIN BYTE CALIGNED;
     3718    27674
     3719    27675        /***
     3720    27676         *** STATIC
     3721    27677         ***/
     3722    27678
     3723    27679    4   DCL N SBIN STATIC;
     3724    27680
     3725    27681        /****************************************/
     3726    27682
     3727    27683    4      N = SPEC.FILE.L#;
     3728    27684    4      CALL FLB_PREV( SPEC.FILE, N, LENGTHV(SPEC.FILE.NAME#) )
     3729    27685    5       WHENRETURN DO;                      /* Get a previous file name           */
     3730    27686    5         SPEC.FILE.L# = N;
     3731    27687    5         END;
     3732    27688    5       WHENALTRETURN DO;
     3733    27689    5         SPEC.FILE.L# = N;
     3734    27690    5         N = LENGTHV(SPEC.ACCT#);
     3735    27691    6         DO WHILE( N >= 0 AND SPEC.ACCTB(N) = ASCBIN(' ') );
     3736    27692    6            N = N - 1;
     3737    27693    6            END;
     3738    27694    5         N = N + 1;
     3739    27695    5         CALL FLB_PREV( SPEC.ACCT#, N, LENGTHV(SPEC.ACCT#) )
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:111  
     3740    27696    6          WHENALTRETURN DO;
     3741    27697    6            COMMAND_ERROR = '1'B;
     3742    27698    6            CALL FLI$RPT_ERR( E_NO_PREV_SPEC, );
     3743    27699    6            END;
     3744    27700    5         END;
     3745    27701    4      RETURN;
     3746    27702
     3747    27703    4   END FLB_PREV_SPEC;
     3748    27704        /********************************************************************/
     3749    27705
     3750    27706    3   FLB_NEXT: PROC( NAMEB, N, MAX_NX ) ALTRET;
     3751    27707        /*F* NAME: FLB_NEXT
     3752    27708             PURPOSE: Determine the next valid name.
     3753    27709        */
     3754    27710
     3755    27711    4   DCL NAMEB(0:0) UBIN BYTE CALIGNED;
     3756    27712    4   DCL N SBIN;
     3757    27713    4   DCL MAX_NX SBIN;
     3758    27714
     3759    27715        /****************************************/
     3760    27716
     3761    27717    4      CX = N - 1;                          /* Index of last character            */
     3762    27718
     3763    27719    4      IF CX < MAX_NX
     3764    27720    5       THEN DO;             /* Make legal name by appending first legal char     */
     3765    27721    5         NAMEB(CX+1) = FIRST_LEGAL_CHAR;
     3766    27722    5         N = CX + 2;
     3767    27723    5         RETURN;
     3768    27724    5         END;
     3769    27725
     3770    27726    5      DO WHILE( CX >= 0 );
     3771    27727    5         C = NAMEB(CX);
     3772    27728    5         C = C + 1;
     3773    27729    6         DO WHILE( C <= LAST_LEGAL_CHAR AND NOT LEGAL_CHAR(C) );
     3774    27730    6            C = C + 1;
     3775    27731    6            END;
     3776    27732    5         IF C <= LAST_LEGAL_CHAR
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:112  
     3777    27733    6          THEN DO;                         /* Found subsequent legal character   */
     3778    27734    6            NAMEB(CX) = C;
     3779    27735    6            RETURN;
     3780    27736    6            END;
     3781    27737    5         NAMEB(CX) = ASCBIN(' ');          /* No next legal char                 */
     3782    27738    5         CX = CX - 1;                      /* Find next for adjacent char        */
     3783    27739    5         N = N - 1;
     3784    27740    5         END;
     3785    27741
     3786    27742        /***
     3787    27743         *** No next name.  Set to first and take alternate return.
     3788    27744         ***/
     3789    27745
     3790    27746    4      NAMEB(0) = FIRST_LEGAL_CHAR;
     3791    27747    4      N = 0;
     3792    27748    4      ALTRETURN;
     3793    27749
     3794    27750    4   END FLB_NEXT;
     3795    27751
     3796    27752    3   FLB_PREV: PROC( NAMEB, N, MAX_NX ) ALTRET;
     3797    27753        /*F* NAME: FLB_PREV
     3798    27754             PURPOSE: Determine the previous valid name.
     3799    27755        */
     3800    27756
     3801    27757    4   DCL NAMEB(0:0) UBIN BYTE CALIGNED;
     3802    27758    4   DCL N SBIN;
     3803    27759    4   DCL MAX_NX SBIN;
     3804    27760
     3805    27761        /****************************************/
     3806    27762
     3807    27763    4      CX = N - 1;                          /* Index of last character            */
     3808    27764
     3809    27765    5      DO WHILE( CX >= 0 );
     3810    27766    5         C = NAMEB(CX);
     3811    27767    5         C = C - 1;
     3812    27768    6         DO WHILE( C >= FIRST_LEGAL_CHAR AND NOT LEGAL_CHAR(C) );
     3813    27769    6            C = C - 1;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:113  
     3814    27770    6            END;
     3815    27771    5         IF C >= FIRST_LEGAL_CHAR
     3816    27772    6          THEN DO;                         /* Found previous valid char          */
     3817    27773    6            NAMEB(CX) = C;
     3818    27774    7            DO CX = CX+1 TO MAX_NX;
     3819    27775    7               NAMEB(CX) = LAST_LEGAL_CHAR;
     3820    27776    7               END;
     3821    27777    6            N = MAX_NX + 1;
     3822    27778    6            RETURN;
     3823    27779    6            END;
     3824    27780    5         NAMEB(CX) = ASCBIN(' ');
     3825    27781    5         CX = CX - 1;
     3826    27782    5         END;
     3827    27783
     3828    27784        /***
     3829    27785         *** No previous valid name.
     3830    27786         ***/
     3831    27787
     3832    27788    5      DO CX=0 TO MAX_NX;
     3833    27789    5         NAMEB(CX) = LAST_LEGAL_CHAR;
     3834    27790    5         END;
     3835    27791    4      N = MAX_NX + 1;
     3836    27792    4      ALTRETURN;
     3837    27793
     3838    27794    4   END FLB_PREV;
     3839    27795
     3840    27796    3   FLB_SORT_RANGE: PROC;
     3841    27797
     3842    27798        /********************/
     3843    27799
     3844    27800    4      M = DISK_FILE_SPEC.NBR - 2;
     3845    27801    5      DO WHILE( M >= 0 );
     3846    27802    5         I_SWAP = -1;
     3847    27803    6         DO I = 0 TO M;
     3848    27804    6            J = I + 1;
     3849    27805    6            IF DISK_FILE_SPEC.SPECCHARS(I) > DISK_FILE_SPEC.SPECCHARS(J)
     3850    27806    7             THEN DO;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:114  
     3851    27807    7               I_SWAP = I;
     3852    27808    7               SPECCHARS = DISK_FILE_SPEC.SPECCHARS(I);
     3853    27809    7               DISK_FILE_SPEC.SPECCHARS(I) = DISK_FILE_SPEC.SPECCHARS(J);
     3854    27810    7               DISK_FILE_SPEC.SPECCHARS(J) = SPECCHARS;
     3855    27811    7               END;
     3856    27812    6            END;
     3857    27813    5         M = I_SWAP;
     3858    27814    5         END;
     3859    27815
     3860    27816
     3861    27817    4      RETURN;
     3862    27818
     3863    27819    4   END FLB_SORT_RANGE;
     3864    27820
     3865    27821    3   END FLB_ORDER_RANGE;
     3866    27822
     3867    27823    2   END FLB_DISK_SPEC;
     3868    27824        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:115  
     3869    27825    1   FLB_TAPE_OD_SPEC: PROC ALTRET;
     3870    27826        /*F*  NAME: FLB_TAPE_OD_SPEC
     3871    27827              PURPOSE: Process tape and optical disk specification nodes.
     3872    27828        ***/
     3873    27829
     3874    27830        /***
     3875    27831         *** AUTO
     3876    27832         ***/
     3877    27833
     3878    27834    2   DCL NODE_ERROR BIT(1) AUTO;
     3879    27835
     3880    27836        /****************************************/
     3881    27837
     3882    27838           /***
     3883    27839            *** Process options.
     3884    27840            ***/
     3885    27841
     3886    27842    2      NODE_ERROR = '1'B;
     3887    27843    2      NBR_SNLISTS = 0;
     3888    27844    3      DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;
     3889    27845    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);
     3890    27846
     3891    27847    4         DO CASE( SUBNODE$->OUT$BLK.CODE );
     3892    27848
     3893    27849    4          CASE( %TAPE_DEST, %TAPE_SOURCE, %OD_DEST, %OD_SOURCE );
     3894    27850    4            CALL FLI$NODE_TAPE_OD( SUBNODE$ )
     3895    27851    5             WHENRETURN DO;
     3896    27852    5               NODE_ERROR = '0'B;
     3897    27853    5               END;
     3898    27854    5             WHENALTRETURN DO;
     3899    27855    5               NODE_ERROR = '1'B;
     3900    27856    5               END;
     3901    27857
     3902    27858    4          END;
     3903    27859    3         END;
     3904    27860
     3905    27861    2      IF NODE_ERROR THEN COMMAND_ERROR = '1'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:116  
     3906    27862    2      IF NODE_ERROR THEN ALTRETURN;
     3907    27863
     3908    27864    2      RETURN;
     3909    27865
     3910    27866    2   END FLB_TAPE_OD_SPEC;
     3911    27867
     3912    27868        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:117  
     3913    27869    1   FLB_SET_TAPE_DEFAULTS: PROC( T_DENSITY,T_FSN,LAST_T_FSN,T_IOERROK );
     3914    27870        /*F*  NAME: FLB_SET_TAPE_DEFAULTS
     3915    27871              PURPOSE: Set defaults for reading tape.
     3916    27872        ***/
     3917    27873    2   DCL T_DENSITY UBIN;
     3918    27874    2   DCL T_FSN UBIN;
     3919    27875    2   DCL LAST_T_FSN UBIN;
     3920    27876    2   DCL T_IOERROK BIT(1) ALIGNED;
     3921    27877        /***
     3922    27878         *** AUTO
     3923    27879         ***/
     3924    27880
     3925    27881        /****************************************/
     3926    27882
     3927    27883         /***
     3928    27884          *** Set up defaults.
     3929    27885          ***/
     3930    27886
     3931    27887    2      TAPE_OPEN.V.OPER.MNTONLY# = %NO#;
     3932    27888    2      IF ADDR(T_DENSITY) = ADDR(NIL)
     3933    27889    2       THEN TAPE_OPEN.V.DENSITY# = 0;
     3934    27890    2       ELSE TAPE_OPEN.V.DENSITY# = T_DENSITY;
     3935    27891    2      TAPE_OPEN.V.EXPIRE# = %NEVER#;
     3936    27892    2      TAPE_OPEN.V.XTEND# = '0'B;
     3937    27893    2      TAPE_OPEN.V.VOLACCESS# = 0;
     3938    27894    2      IF ADDR(T_FSN) = ADDR(NIL)
     3939    27895    2       THEN TAPE_OPEN.V.FSN# = 0;
     3940    27896    2       ELSE TAPE_OPEN.V.FSN# = T_FSN;
     3941    27897    2      TAPE_OPEN.V.RES# = 'LT';
     3942    27898    2      IF ADDR(LAST_T_FSN) = ADDR(NIL)
     3943    27899    2       THEN LAST_TAPE_FSN = 9999;
     3944    27900    2       ELSE LAST_TAPE_FSN = LAST_T_FSN;
     3945    27901    2      IF ADDR(T_IOERROK) = ADDR(NIL)
     3946    27902    2       THEN TAPE_OPEN.V.IOERROK# = %NO#;
     3947    27903    2       ELSE TAPE_OPEN.V.IOERROK# = T_IOERROK;
     3948    27904    2      TAPE_OPEN.NAME_ = VECTOR(ERASE);
     3949    27905    2      TAPE_OPEN.V.INITZ.SCRUB# = %YES#;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:118  
     3950    27906    2      TAPE_OPEN.IFPARAM_ = VECTOR(NIL);
     3951    27907    2      TAPE_OPEN.FPARAM_ = VECTOR(NIL);
     3952    27908    2      TAPE_OPEN.V.VOL# = 1;
     3953    27909    2      TAPE_OPEN.V.BLKL# = DEFAULT_GRANS_PER_TAPE_BUF * 4096;
     3954    27910    2      NBR_GRANS_PER_TAPE_BUF = DEFAULT_GRANS_PER_TAPE_BUF;
     3955    27911    2      CT_IMAGE = ' ';                      /* Assume not "controlled" tapeset    */
     3956    27912    2      TAPE_OPEN.V.FUN# = %IN#;
     3957    27913    2      TAPE_OPEN.V.CVOL# = %NO#;
     3958    27914
     3959    27915    2      RETURN;
     3960    27916
     3961    27917    2   END FLB_SET_TAPE_DEFAULTS;
     3962    27918
     3963    27919        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:119  
     3964    27920    1   FLB_BUILD_SNLIST: PROC;
     3965    27921        /*F*  NAME: FLB_BUILD_SNLIST
     3966    27922              PURPOSE: Build serial number list from :BACKUP file in $$EFT account.
     3967    27923        ***/
     3968    27924
     3969    27925        /***
     3970    27926         *** AUTO
     3971    27927         ***/
     3972    27928
     3973    27929    2   DCL N SBIN WORD;
     3974    27930    2   DCL NN SBIN WORD;
     3975    27931    2   DCL SNSIZE UBIN WORD;
     3976    27932    2   DCL SNLIST$ PTR;
     3977    27933    2   DCL SNLISTINFO$ PTR;
     3978    27934    2   DCL 1 CT5FMT AUTO,                      /* CT#xxxxn                           */
     3979    27935    2         2 XXXX CHAR(4),
     3980    27936    2         2 N CHAR(1);
     3981    27937    2   DCL CT5FMTCHARS REDEF CT5FMT CHAR(5);
     3982    27938    2   DCL 1 CT6FMT AUTO,                      /* CT#xxxxnn                          */
     3983    27939    2         2 XXXX CHAR(4),
     3984    27940    2         2 NN CHAR(2);
     3985    27941    2   DCL CT6FMTCHARS REDEF CT6FMT CHAR(6);
     3986    27942
     3987    27943         /***
     3988    27944          *** FPT
     3989    27945          ***/
     3990    27946
     3991    27947        %VLP_SN( FPTN=SNLIST,
     3992    27948                 STCLASS="BASED(SNLIST$)" );
     3993    27961
     3994    27962        /****************************************/
     3995    27963
     3996    27964    2      SNSIZE = (LENGTHC(VLP_SN.NUM#) + STATUS_KEY.TSN_VOL *
     3997    27965    2        LENGTHC(VLP_SN.SN#(0))+3) /4;
     3998    27966    2      CALL FLI$ALLOC( SNSIZE, SNLIST$ );
     3999    27967    2      SNLIST.NUM# = STATUS_KEY.TSN_VOL;
     4000    27968    2      CALL INDEX( N, ' ', TSN_USED_BUF.TSN );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:120  
     4001    27969    2      IF N = LENGTHC('xxxxn')
     4002    27970    3       THEN DO;
     4003    27971    3         CT5FMTCHARS = TSN_USED_BUF.TSN;
     4004    27972    3         CALL CHARBIN( NN, CT5FMT.N );
     4005    27973    4         DO N = SNLIST.NUM# - 1 DOWNTO 0;
     4006    27974    4            CALL BINCHAR( CT5FMT.N, NN );
     4007    27975    4            SNLIST.SN#(N) = CT5FMTCHARS;
     4008    27976    4            NN = NN - 1 ;
     4009    27977    4            END;
     4010    27978    3         END;
     4011    27979    3       ELSE DO;
     4012    27980    3         CT6FMTCHARS = TSN_USED_BUF.TSN;
     4013    27981    3         CALL CHARBIN( NN, CT6FMT.NN );
     4014    27982    4         DO N = SNLIST.NUM# - 1  DOWNTO 0;
     4015    27983    4            CALL BINCHAR( CT6FMT.NN, NN );
     4016    27984    4            SNLIST.SN#(N) = CT6FMTCHARS;
     4017    27985    4            NN = NN - 1;
     4018    27986    4            END;
     4019    27987    3         END;
     4020    27988
     4021    27989    2      CALL FLI$ALLOC( SIZEW(SNLISTINFO), SNLISTINFO$ );
     4022    27990    2      SNLISTINFO$->SNLISTINFO.SNLIST$ = SNLIST$;
     4023    27991    2      SNLISTINFO$->SNLISTINFO.PREVINFO$ = LAST_SNLISTINFO$;
     4024    27992    2      LAST_SNLISTINFO$ = SNLISTINFO$;
     4025    27993
     4026    27994    2      RETURN;
     4027    27995    2   END FLB_BUILD_SNLIST;
     4028    27996        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:121  
     4029    27997    1   FLB_READ_BACKUP: PROC ALTRET;
     4030    27998        /*F*  NAME: FLB_READ_BACKUP
     4031    27999              PURPOSE: Copy :BACKUP file from tape,fid, or packset being restored to
     4032    28000                       *:BACKUP file on disk.
     4033    28001        ***/
     4034    28002
     4035    28003        /***
     4036    28004         *** AUTO
     4037    28005         ***/
     4038    28006    2   DCL DCB# UBIN AUTO;
     4039    28007    2   DCL SOURCE_DCB$ PTR AUTO;
     4040    28008    2   DCL FIRST BIT(1) AUTO;
     4041    28009    2   DCL DISK_OPTION_DIR_SAVE BIT(1) AUTO;
     4042    28010    2   DCL DISK_OPTION_PAD_SAVE BIT(1) AUTO;
     4043    28011    2   DCL 1 FPARAM_ DALIGNED AUTO,
     4044    28012    2         2 BOUND UBIN(20) UNAL,
     4045    28013    2         2 * BIT(16) UNAL,
     4046    28014    2         2 PTR$ PTR;
     4047    28015        %VLP_ERRCODE (FPTN=ERR);
     4048    28060    2   DCL ARS SBIN AUTO;
     4049    28061    2   DCL 1 BUF_ DALIGNED AUTO,
     4050    28062    2         2 * BIT(36),
     4051    28063    2         2 PTR$ PTR;
     4052    28064
     4053    28065        /****************************************/
     4054    28066
     4055    28067
     4056    28068    2      DISK_WRITE.V.WAIT# = '1'B;
     4057    28069    2      DISK_WRITE.V.EVENT# = 0;
     4058    28070    2      DISK_WRITE.V.DCB# = DCBNUM(M$DISK00);
     4059    28071    2      DISK_OPEN.V.DCB# = DCBNUM(M$DISK00);
     4060    28072    2      DISK_OPEN.V.FUN# = %CREATE#;
     4061    28073    2      DISK_OPEN.SN_ = VECTOR(DISK_DEST_SN);
     4062    28074    2      DISK_OPEN.V.RES# = DISK_DEST_RES.NAME;
     4063    28075    2      OUR_ACCT.ACCT# = B$JIT.FACCN;
     4064    28076    2      DISK_OPEN.ACCT_ = VECTOR(OUR_ACCT);
     4065    28077    2      DISK_OPEN.NAME_ = VECTOR(BACKUP_TEMP);
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:122  
     4066    28078    2      DISK_CLOSE.V.DCB# = DCBNUM(M$DISK00);
     4067    28079    2      DISK_CLOSE.SN_ = VECTOR(DISK_DEST_SN);
     4068    28080    2      DISK_CLOSE.V.DISP# = %SAVE#;
     4069    28081    2      CLOSE_BACKUP_TEMP.V.DISP# = %SAVE#;
     4070    28082
     4071    28083    2      IF NODE$->OUT$BLK.NSUBLKS > 1
     4072    28084    2        AND NODE$->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE ~= %REBUILD_TAPE_OPTIONS
     4073    28085    3       THEN DO;
     4074    28086    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(1);
     4075    28087    4         DO CASE( SUBNODE$->OUT$BLK.CODE );
     4076    28088
     4077    28089    4          CASE( %TAPE_SOURCE );            /* Copy :BACKUP file from tape        */
     4078    28090
     4079    28091    4            DISK_OPTION_DIR_SAVE = DISK_OPTION.DIR;
     4080    28092    4            DISK_OPTION.DIR = '0'B;
     4081    28093    4            DISK_OPTION_PAD_SAVE = DISK_OPTION.PAD;
     4082    28094    4            DISK_OPTION.PAD = '0'B;
     4083    28095    4            CALL FLC$TAPE_IO_INIT;
     4084    28096    4   OPEN_BACKUP_FILE:
     4085    28097    4            CALL FLC$TAPE_OPEN_NEXT(SOURCE_DCB$, FPARAM_, ERR)
             28097                     /* Position to :BACKUP */
     4086    28098    5             WHENALTRETURN DO;
     4087    28099        /***
     4088    28100         *** If a block count error as a result of trying to continue after a tape read
     4089    28101         *** or an I/O error was encountered, attempt to skip past the error by
     4090    28102         *** opening the next file.
     4091    28103         ***/
     4092    28104    5               IF (TAPE_OPEN.V.IOERROK# AND ERR.ERR# = %E$BLKCNT)
     4093    28105    5                 OR (TAPE_OPEN.V.IOERROK# AND ERR.ERR# = %E$IO_ERR)
     4094    28106    5                THEN GOTO OPEN_BACKUP_FILE;
     4095    28107
     4096    28108    5               DCB# = DCBNUM(M$TAPE00);
     4097    28109    5               CALL FLI$RPT_ERR( E_CANT_OPEN_TBACKUP, DCB# );
     4098    28110    5               ALTRETURN;
     4099    28111    5               END;
     4100    28112    4            IF SOURCE_DCB$->F$DCB.NAME#.C ~= BACKUP_NAME.NAME# /* Must be :BACKUP */
     4101    28113    5             THEN DO;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:123  
     4102    28114    5               CALL FLI$RPT_ERR( E_BAD_FSN );
     4103    28115    5               GOTO READ_BACKUP_ERR10;
     4104    28116    5               END;
     4105    28117    4            DISK_OPTION.PAD = DISK_OPTION_PAD_SAVE;
     4106    28118    4            DISK_OPTION.DIR = DISK_OPTION_DIR_SAVE;
     4107    28119
     4108    28120    4            DISK_OPEN.IFPARAM_ = FPARAM_;
     4109    28121    4            CALL M$OPEN( DISK_OPEN ) ALTRET(READ_BACKUP_ERR); /* Create *:BACKUP */
     4110    28122    4            DISK_WRITE.KEY_ = VECTOR(NIL);
     4111    28123
     4112    28124    5            DO WHILE ( NOT ERR );
     4113    28125    5               CALL FLC$TAPE_READ_NEXT( BUF_, ARS, ERR ) /* Copy :BACKUP to *:BACKUP */
     4114    28126    6                WHENRETURN DO;
     4115    28127    6                  DISK_WRITE.BUF_ = BUF_;
     4116    28128    6                  DISK_WRITE.BUF_.BOUND = ARS - 1;
     4117    28129    6                  CALL M$WRITE( DISK_WRITE ) ALTRET(READ_BACKUP_ERR);
     4118    28130    6                  END;
     4119    28131    5               END;
     4120    28132
     4121    28133    4            LAST_TAPE_FSN = 9999;
     4122    28134    4            DISK_CLOSE.V.DISP# = %SAVE#;
     4123    28135    4            DISK_CLOSE.V.EFTOPER = '0'B;
     4124    28136    4            CALL M$CLOSE( DISK_CLOSE ) ALTRET(READ_BACKUP_ERR);
     4125    28137    4            DISK_CLOSE.IFPARAM_ = VECTOR(NIL);
     4126    28138    4            DISK_CLOSE.V.DESC = '0'B;
     4127    28139    4            CALL M$CLOSE( TAPE_CLOSE ) ALTRET(READ_BACKUP_ERR);
     4128    28140    4            TAPE_REWIND.V.PSN# = DCBADDR(DCBNUM(M$TAPE00)) -> F$DCB.PSN#;
     4129    28141    4            CALL M$REM ( TAPE_REWIND );
     4130    28142    4            RETURN;
     4131    28143
     4132    28144    4          CASE( %REBUILD_FILE_SOURCE );    /* Copy :BACKUP file from fid         */
     4133    28145
     4134    28146    4            FPT_FID.TEXTFID_ = VECTOR(SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     4135    28147    4            CALL M$FID( FPT_FID ) ALTRET(READ_BACKUP_ERR);
     4136    28148    4            OPEN_BACKUP_RBLDFILE.V.RES# = OPEN_FID.V.RES#;
     4137    28149    4            CALL M$OPEN( OPEN_BACKUP_RBLDFILE) ALTRET(READ_BACKUP_ERR);
     4138    28150    4            IF DCBADDR(DCBNUM(M$STATUS))->F$DCB.ORG# ~= %KEYED# /* Verify if :BACKUP */
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:124  
     4139    28151    5             THEN DO;
     4140    28152    5               DCB# = DCBNUM(M$STATUS);
     4141    28153    5               CALL FLI$RPT_ERR( E_BAD_BKUP_FILE, DCB# );
     4142    28154    5               GOTO READ_BACKUP_ERR10;
     4143    28155    5               END;
     4144    28156
     4145    28157    4            OPEN_BACKUP_TEMP.V.FUN# = %CREATE#;
     4146    28158    4            CALL M$OPEN( OPEN_BACKUP_TEMP ) ALTRET(READ_BACKUP_ERR);
     4147    28159
     4148    28160    4            READ_STATUS.V.KEYS# = '0'B;
     4149    28161    4            FIRST = '1'B;
     4150    28162    4   READ_LOOP:
     4151    28163    5            DO WHILE( '1'B );
     4152    28164    5               CALL M$READ( READ_STATUS )
     4153    28165    6                WHENALTRETURN DO;
     4154    28166    6                  IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$EOF
     4155    28167    6                   THEN GOTO READ_BACKUP_ERR;
     4156    28168    6                  CALL M$CLOSE( CLOSE_STATUS ) ALTRET(READ_BACKUP_ERR);
     4157    28169    6                  CALL M$CLOSE( CLOSE_BACKUP_TEMP ) ALTRET(READ_BACKUP_ERR);
     4158    28170    6                  EXIT READ_LOOP;
     4159    28171    6                  END;
     4160    28172    5               IF FIRST                    /* Verify if a valid :BACKUP file     */
     4161    28173    6                THEN DO;
     4162    28174    6                  IF STATUS_KEY.L ~= LENGTHV( STATUS_KEY )
     4163    28175    6                    OR STATUS_KEY.RUN_NBR ~= 0
     4164    28176    6                    OR STATUS_KEY.TSN_SET_NBR ~= 0
     4165    28177    6                    OR STATUS_KEY.TSN_VOL ~= 0
     4166    28178    7                   THEN DO;
     4167    28179    7                     DCB# = DCBNUM(M$STATUS);
     4168    28180    7                     CALL FLI$RPT_ERR( E_BAD_BKUP_FILE, DCB# );
     4169    28181    7                     GOTO READ_BACKUP_ERR10;
     4170    28182    7                     END;
     4171    28183    6                   ELSE FIRST = '0'B;
     4172    28184    6                  END;
     4173    28185    5               CALL M$WRITE( WRITE_BACKUP_TEMP ) ALTRET(READ_BACKUP_ERR);
     4174    28186    5               END;
     4175    28187
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:125  
     4176    28188    4          END;
     4177    28189    3         END;
     4178    28190    3       ELSE DO;                  /* Copy :BACKUP file from destination packset   */
     4179    28191    3         FID_NAME = BACKUP_NAME;
     4180    28192    3         FID_ACCT = BACKUP_ACCT;
     4181    28193    3         FID_SN.SN#(0) = DISK_DEST_SN.SN#(0);
     4182    28194    3         OPEN_BACKUP_RBLDFILE.V.RES# = DISK_DEST_RES.NAME;
     4183    28195    3         CALL M$OPEN( OPEN_BACKUP_RBLDFILE ) ALTRET(READ_BACKUP_ERR);
     4184    28196
     4185    28197    3         OPEN_BACKUP_TEMP.V.FUN# = %CREATE#;
     4186    28198    3         CALL M$OPEN( OPEN_BACKUP_TEMP ) ALTRET(READ_BACKUP_ERR);
     4187    28199
     4188    28200    3         READ_STATUS.V.KEYS# = '0'B;
     4189    28201    3         END;
     4190    28202    2   READ_LOOP5:
     4191    28203    3      DO WHILE( '1'B );
     4192    28204    3         CALL M$READ( READ_STATUS )
     4193    28205    4          WHENALTRETURN DO;
     4194    28206    4            IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$EOF
     4195    28207    4             THEN GOTO READ_BACKUP_ERR;
     4196    28208    4            CALL M$CLOSE( CLOSE_STATUS ) ALTRET(READ_BACKUP_ERR);
     4197    28209    4            CALL M$CLOSE( CLOSE_BACKUP_TEMP ) ALTRET(READ_BACKUP_ERR);
     4198    28210    4            EXIT READ_LOOP5;
     4199    28211    4            END;
     4200    28212    3         CALL M$WRITE( WRITE_BACKUP_TEMP ) ALTRET(READ_BACKUP_ERR);
     4201    28213    3         END;
     4202    28214    2      RETURN;
     4203    28215
     4204    28216    2   READ_BACKUP_ERR:
     4205    28217    2      CALL FLI$RPT_ERR;
     4206    28218    2   READ_BACKUP_ERR10:
     4207    28219    2      IF DCBADDR(DCBNUM(M$TAPE00)) -> F$DCB.FCD#
     4208    28220    2       THEN CALL M$CLOSE (TAPE_CLOSE);
     4209    28221    2      IF DCBADDR(DCBNUM(M$DISK00)) -> F$DCB.FCD#
     4210    28222    2       THEN CALL M$CLOSE (DISK_CLOSE);
     4211    28223    2      IF DCBADDR(DCBNUM(M$STATUS)) -> F$DCB.FCD#
     4212    28224    2       THEN CALL M$CLOSE (CLOSE_STATUS);
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:126  
     4213    28225    2      ALTRETURN;
     4214    28226    2   END FLB_READ_BACKUP;
     4215    28227    1      END FLB$EFT;
     4216    28228        %EOD;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:127  
--  Include file information  --

   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XUR_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XUD_UTS_M.:E05TOU  is referenced.
   FM$GRAN.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   FLW_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FLN_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLB$EFT.

   Procedure FLB$EFT requires 6760 words for executable code.
   Procedure FLB$EFT requires 40 words of local(AUTO) storage.

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:128  

 Object Unit name= FLB$EFT                                    File name= FLB$EFT.:E05TOU
 UTS= JUL 29 '97 15:33:51.52 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none  1264   2360  FLB$EFT
    3   DCB   even  none     0      0  M$DISK_IN
    4   DCB   even  none     0      0  M$DISK00
    5   DCB   even  none     0      0  M$DISK01
    6   DCB   even  none     0      0  M$DISK02
    7   DCB   even  none     0      0  M$DISK03
    8   DCB   even  none     0      0  M$TSN_USED
    9   DCB   even  none     0      0  M$STATUS
   10   DCB   even  none     0      0  M$REBUILD
   11   DCB   even  none     0      0  M$ARCHIVE
   12   DCB   even  none     0      0  M$NODATA_LIST
   13   DCB   even  none     0      0  M$SI
   14   DCB   even  none     0      0  M$READ_FILE
   15   DCB   even  none     0      0  M$LO
   16   DCB   even  none     0      0  M$DO
   17   DCB   even  none     0      0  M$TAPE00
   18   DCB   even  none     0      0  M$CATALOG
   19  RoData even  UTS    154    232  FLB$EFT
   20   Proc  even  none  6760  15150  FLB$EFT
   21  RoData even  none   150    226  FLB$EFT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    20      0   yes            yes      Main       0  FLB$EFT
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:129  

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    2    154  BREAK_COUNT                        2    155  BREAK_CONTINUED
    2    156  BREAK_DCB#                         2    157  BREAK_TASK
    2    164  RESTORE_FROM_TAPE                  2    165  CHECK_TAPE
    2    253  OPTION_MAP                         2   1346  FPT_FID_RESULTS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          Async      0 FLB$EFT_BRK
 yes     yes           Std       2 XTX$ADAPT
 yes     yes           Std       6 XUR$GETCMD
 yes     yes           Std       1 XUR$MOREMSG
 yes     yes           Std       1 XUR$HELP
 yes     yes           Std       4 XUR$SETDCBS
 yes     yes           Std       1 XUR$ECHOIF
         yes           Std       5 FLI$RPT_ERR
         yes           Std       1 FLI$ERROR_SUMMARY
 yes     yes           Std       1 XUR$ALLMSG
 yes     yes           Std       1 XUR$SETERRMSG
         yes           Std       1 FLI$INIT
 yes     yes           Std       3 XUR$INIT
 yes     yes           Std       2 XUR$ERRPTR
 yes     yes           Std       7 XUR$ERRMSG
         yes           Std       0 FLW$WHERE
 yes     yes           Std       1 FLI$BUILD_$$EFT
         yes           Std       0 FLI$STATS
         yes           Std       2 FLI$DISMNT_TAPES
 yes     yes           Std       1 FLM$MOVE
 yes     yes           Std       1 FLV$VALIDATE
 yes     yes           Std       0 FLS$PROCESS_PRE_RET
         yes           Std       0 FLR$REQUALIFY
         yes           Std       1 FLS$STOW_FETCH
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:130  
         yes           Std       1 FLE$ESTMOD
 yes     yes           Std       0 FLM$SWITCH_PRIME_DUAL
 yes     yes           Std       2 FLI$TSN_USED
         yes           Std       0 FLS$STATUS
         yes           Std       2 FLI$ALLOC
 yes     yes           Std       3 XUD$UTS_ADJUST
 yes     yes           Std       1 FLI$NODE_TAPE_OD
         yes           Std       0 FLC$TAPE_IO_INIT
 yes     yes           Std       3 FLC$TAPE_OPEN_NEXT
 yes     yes           Std       3 FLC$TAPE_READ_NEXT
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    E_OVERLAP_RANGE                  r    E_OVERLAP_SKIP
r    E_WARN_OVERLAP_RANGE             r    E_WARN_OVERLAP_SKIP              r    E_BAD_ACC
r    E_BAD_MOD                        r    E_BAD_CRE                        r    E_BAD_BAC
r    E_BAD_ARC                        r    E_BAD_RANGE                      r    E_BAD_SKIP_N_RANGE
r    E_NO_RANGE                       r    E_EXPD_NOT_EXPD                  r    E_NO_NEXT_SPEC
r    E_NO_PREV_SPEC                   r    E_DUP_BEF_ACC                    r    E_DUP_BEF_MOD
r    E_DUP_BEF_CRE                    r    E_DUP_BEF_BAC                    r    E_DUP_BEF_ARC
r    E_DUP_AFT_ACC                    r    E_DUP_AFT_MOD                    r    E_DUP_AFT_CRE
r    E_DUP_AFT_BAC                    r    E_DUP_AFT_ARC                    r    E_BAD_FSN_RANGE
r    E_DUPLICATE_PSN                  r    E_NEED_TIME                      r    E_TRY_AGAIN
r    E_CAT_OFF                        r    E_MUST_CAT_OFF                   r    E_MUST_CAT_DISK
r    E_NO_CATALOG                     r    E_FILE_NAME                      r    E_MUST_BE_CAT_FILE
r    E_WIPEOUT_SOURCE                 r    E_TOO_MANY_ERRORS_TO_SWITCH      r    E_CANT_SPECIFY_DELF
r    E_CANT_SPECIFY_ANYF              r    E_CANT_SPECIFY_QF                r    E_CANT_SPECIFY_DIR
r    E_CANT_SPECIFY_PAD               r    E_CANT_SPECIFY_DEL_ACC           r    E_CANT_SPECIFY_CLEANUP
r    E_CANT_SPECIFY_ACUP              r    E_CANT_SPECIFY_SCRUB             r    E_CANT_SPECIFY_IDS
r    E_CANT_SPECIFY_SHARED            r    E_RETURN_TO_COMMAND              r    E_CANT_OPEN_TBACKUP
r    E_REBUILD_CONTINUE               r    E_CANT_RUN_EFT                   r    E_BAD_BKUP_FILE
r    E_NO_FSN                         r    E_BAD_FSN                        r    E_NO_FILE
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:131  
r    E_BAD_DP_FORMAT                  r    E_CLOSE_INVALID                  r    E_DUP_TAPESET
     LAST_SNLISTINFO$                      NBR_SNLISTS                           TAPE_DCBLIST$
     FPT_EXIT                              DISK_OPEN                             DISK_WRITE
     DISK_CLOSE                            TAPE_OPEN                             TAPE_CLOSE
     TAPE_REWIND                           SNVECLIST$                            TVECTOR
     B$JIT$                                B$TCB$                                FMSEC
r    ZERO                                  COMMAND_ERROR                         OVER_FIL
     NBR_GRANS_PER_TAPE_BUF                DEFAULT_GRANS_PER_TAPE_BUF            NOW_UTS
     GET_NOW_UTS                           START_UTS                             ACCUMULATED_MOUNT_TIME
     ACCUMULATED_SPIN_TIME                 ACCUMULATED_BREAK_TIME                DPLIST$
     DPRESLIST$                            DISK_FILE_SPEC$                       SPECCHARS
     DISK_SRCHCOND                         TEMP_DISK_SRCHCOND                    DISK_DESC
     DISK_DESC_MASK                        DISK_OPTION                           FILE_TYPE
     DISK_ORGS                             DISK_BEF_UTS                          DISK_AFT_UTS
     DISK_AND_OP                           DISK_CRIT                             DATE_CRIT
     NEW_DISK_DESC                    r    FIRST_ACCT                       r    LAST_ACCT
r    NULL_ACCT                        r    FIRST_FILE                       r    LAST_FILE
r    NO_FILE                          r    NULL_FILE                             DISK_DEST_SN
     DISK_DEST_ACCT                        DISK_DEST_RES                         DISK_DEST_EXIST
     LAST_TAPE_FSN                         EFTWORD                               TAPE_OPTION
     TRANS_NBR                             CT_IMAGE                              TOTAL_FILES
     TOTAL_GRANS                           TOTAL_ERRORS                          ERROR_LIMIT
     STAF                                  NBR_CONTROL_FILE                      CONTROL_LIST
     M$PRE_RET                             RET_CMDS_NAME                         TEST_MODE
     M$DISK_IN                             ARCHIVE$                              M$DISK00
     M$DISK01                              M$DISK02                              M$DISK03
     FROM_DISK_NAME                        FROM_DISK_ACCT                        FROM_DISK_SN
     DISK_OPEN_NEXT                        M$TSN_USED                            M$STATUS
     M$REBUILD                             M$ARCHIVE                             M$NODATA_LIST
     M$TAPE00$                             BLK_TAG$                              BLK_TAG0$
     NBR_BYTES_TO_MOVE                     DISK_GRAN$                            BLOCK_GRAN$
r    EFT_CVOL_FILE                    r    EFT_RESTRICT_FILE                     TSN_SET_NBR
     SNLIST_NBR                            STATUS_KEY                            TSN_USED_BUF
     TSN_USED_NAME                         CLOSE_TSN_USED                        BACKUP_NAME
     BACKUP_SN                             READ_STATUS                           CLOSE_STATUS
r    ARCHIVE_NAME                     r    PRIME_FILE                       r    DUAL_FILE
     OPEN_REBUILD                          REBUILD_NAME                          REBUILD_SN
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:132  
     READ_REBUILD                          CLOSE_REBUILD                         REBUILD_DIR_KEY
     REBUILD_KEY                           REBUILD_BUF                           NODATA_FILE_NAME
     NODATA_KEY                            CAT_KEY                               CATALOG_ON
     CATALOG_ONTO                          M$SI                                  M$READ_FILE
     M$LO                                  M$DO                                  M$TAPE00
     M$CATALOG                             EFT_CMD                               B_VERSION
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:133  


        1        1        /*M* FLB$EFT - CP-6 file maintenance processor */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* THI=1,PLM=3 */
        8        8
        9        9        FLB$EFT: PROC MAIN;

      9 20 000000   000000 700200 xent  FLB$EFT      TSX0  ! X66_MAUTO
        20 000001   000050 000000                    ZERO    40,0

       10       10
       11       11         /***
       12       12          *** INCLUDE
       13       13          ***/
       14       14
       15       15        %INCLUDE CP_6;
       16     5574        %INCLUDE CP_6_SUBS;
       17     6114        %INCLUDE B$JIT;
       18     6717        %INCLUDE B_ERRORS_C;
       19     7844        %INCLUDE FLE_DATA_R;
       20    13795        %INCLUDE FLI_DATA_R;
       21    15209        %INCLUDE FLN_DATA_R;
       22    15946        %INCLUDE FLS_DATA_R;
       23    17746        %INCLUDE FLW_DATA_R;
       24    17760        %INCLUDE FM$FIT;
       25    17981        %INCLUDE FM$GRAN;
       26    18050        %INCLUDE XUD_UTS_M;
       27    18132        %INCLUDE XUH_MACRO_C;
       28    18216        %INCLUDE XUR_ENTRY;
       29    18248        %INCLUDE XU_MACRO_C;
       30    21354        %INCLUDE XU_SUBS_C;
       31    21446
       32    21447         /***
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:134  
       33    21448          *** ENTRY
       34    21449          ***/
       35    21450
       36    21451    1   DCL FLB$EFT_BRK ENTRY ASYNC;
       37    21452    1   DCL FLC$TAPE_IO_INIT ENTRY;
       38    21453    1   DCL FLC$TAPE_OPEN_NEXT ENTRY(3) ALTRET;
       39    21454    1   DCL FLC$TAPE_READ_NEXT ENTRY(3) ALTRET;
       40    21455    1   DCL FLE$ESTMOD ENTRY(1);
       41    21456    1   DCL FLH$HELP ENTRY(2);
       42    21457    1   DCL FLH$RPT_ERR ENTRY(3);
       43    21458    1   DCL FLI$ALLOC ENTRY(2);
       44    21459    1   DCL FLI$BUILD_$$EFT ENTRY(1) ALTRET;
       45    21460    1   DCL FLI$DISMNT_TAPES ENTRY(2);
       46    21461    1   DCL FLI$ERROR_SUMMARY ENTRY(1);
       47    21462    1   DCL FLI$INIT ENTRY(1);
       48    21463    1   DCL FLI$NODE_TAPE_OD ENTRY(1) ALTRET;
       49    21464    1   DCL FLI$READY_TAPE_IO ENTRY(6);
       50    21465    1   DCL FLI$RPT_ERR ENTRY(5);
       51    21466    1   DCL FLI$STATS ENTRY;
       52    21467    1   DCL FLI$TSN_USED ENTRY(2) ALTRET;
       53    21468    1   DCL FLM$MOVE ENTRY(1) ALTRET;
       54    21469    1   DCL FLN$DISK_IO_INIT ENTRY;
       55    21470    1   DCL FLN$DISK_NXTA ENTRY;
       56    21471    1   DCL FLN$DISK_OPEN_NEXT ENTRY(5) ALTRET;
       57    21472    1   DCL FLR$REQUALIFY ENTRY;
       58    21473    1   DCL FLS$PROCESS_PRE_RET ENTRY ALTRET;
       59    21474    1   DCL FLS$STOW_FETCH ENTRY(1);
       60    21475    1   DCL FLV$VALIDATE ENTRY(1) ALTRET;
       61    21476    1   DCL FLM$SWITCH_PRIME_DUAL ENTRY ALTRET;
       62    21477    1   DCL FLW$WHERE ENTRY;
       63    21478    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
       64    21479    1   DCL FLS$STATUS ENTRY;
       65    21480        %XUD$UTS_ENTRIES;
       66    21512
       67    21513         /***
       68    21514          *** DCB
       69    21515          ***/
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:135  
       70    21516
       71    21517    1   DCL M$SI DCB;
       72    21518    1   DCL M$READ_FILE DCB;
       73    21519    1   DCL M$LO DCB;
       74    21520    1   DCL M$DO DCB;
       75    21521    1   DCL M$TAPE00 DCB;
       76    21522    1   DCL M$CATALOG DCB;
       77    21523
       78    21524         /***
       79    21525          *** SYMREF
       80    21526          ***/
       81    21527
       82    21528    1   DCL EFT_CMD UBIN WORD SYMREF;
       83    21529    1   DCL B_VERSION CHAR(1) SYMREF;
       84    21530
       85    21531         /***
       86    21532          *** SYMDEF
       87    21533          ***/
       88    21534
       89    21535    1   DCL BREAK_COUNT SBIN STATIC SYMDEF;
       90    21536    1   DCL BREAK_CONTINUED BIT(1) STATIC SYMDEF;
       91    21537    1   DCL BREAK_DCB# SBIN STATIC SYMDEF;
       92    21538    1   DCL BREAK_TASK CHAR(18) STATIC SYMDEF;
       93    21539    1   DCL RESTORE_FROM_TAPE BIT(1) STATIC SYMDEF;
       94    21540    1   DCL CHECK_TAPE BIT(1) STATIC SYMDEF;
       95    21541
       96    21542         /***
       97    21543          *** STATIC
       98    21544          ***/
       99    21545
      100    21546    1   DCL CODE SBIN STATIC;
      101    21547    1   DCL COMMAND SBIN STATIC INIT(0);
      102    21548    1   DCL PREV_COMMAND SBIN STATIC INIT(0);
      103    21549    1   DCL DATEUTS UBIN WORD STATIC;
      104    21550    1   DCL 1 ANSDATE STATIC,
      105    21551    1         2 YEAR CHAR(2),
      106    21552    1         2 MONTH CHAR(2),
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:136  
      107    21553    1         2 DAY CHAR(2),
      108    21554    1         2 HOUR CHAR(2),
      109    21555    1         2 MINUTE CHAR(2),
      110    21556    1         2 SECOND CHAR(2),
      111    21557    1         2 SEC100THS CHAR(2);
      112    21558
      113    21559    1   DCL 1 ANSDATEPIECE REDEF ANSDATE,
      114    21560    1         2 YYMMDD CHAR(6),
      115    21561    1         2 HHMMSSSS CHAR(8);
      116    21562    1   DCL ANSDATECHARS REDEF ANSDATE CHAR(14);
      117    21563    1   DCL FIRST_TIME BIT(1) STATIC INIT('1'B);
      118    21564    1   DCL 1 GREETINGS STATIC,
      119    21565    1         2 * CHAR(0) INIT(' EFT '),
      120    21566    1         2 VERSION CHAR(6),
      121    21567    1         2 * CHAR(0) INIT(' '),
      122    21568    1         2 GTIME CHAR(5),
      123    21569    1         2 * CHAR(0) INIT(' '),
      124    21570    1         2 GDAY CHAR(3),
      125    21571    1         2 * CHAR(0) INIT(' '),
      126    21572    1         2 GDATE CHAR(10);
      127    21573    1   DCL 1 TEST_GREETINGS STATIC,
      128    21574    1         2 * CHAR(0) INIT(' EFT TEST-MODE ');
      129    21575    1   DCL I SBIN STATIC;
      130    21576    1   DCL M$READ_FILE$ PTR STATIC;
      131    21577    1   DCL M$SI$ PTR STATIC;
      132    21578    1   DCL M$LO$ PTR STATIC;
      133    21579    1   DCL M$CATALOG$ PTR STATIC;
      134    21580        %VLP_SN( FPTN=MUCK_LIST,
      135    21581                 N=1,
      136    21582                 STCLASS=STATIC );
      137    21595    1   DCL N SBIN STATIC;
      138    21596    1   DCL NBR_DPS SBIN STATIC;
      139    21597    1   DCL NODE$ PTR STATIC;
      140    21598        %VLP_ERRCODE( FPTN=ERR,
      141    21599                      STCLASS="REDEF NODE$" );
      142    21644    1   DCL NOT_SPECIFIED BIT(1) STATIC;
      143    21645    1   DCL SOURCE_TAPE_SNLIST$ PTR STATIC;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:137  
      144    21646    1   DCL SUBNODE$ PTR STATIC;
      145    21647    1   DCL SUBNODEX SBIN STATIC;
      146    21648    1   DCL SUBSUBNODE$ PTR STATIC;
      147    21649    1   DCL SUBSUBNODEX SBIN STATIC;
      148    21650    1   DCL SUBSUBSUBNODEX SBIN STATIC;
      149    21651    1   DCL TEMP SBIN STATIC;
      150    21652    1   DCL TEMP$ PTR STATIC;
      151    21653
      152    21654        %VLP_ACCT( FPTN=PREV_ACCT,
      153    21655                   STCLASS=STATIC );
      154    21668    1   DCL RANGE_SPECIFIED BIT(1) STATIC;
      155    21669    1   DCL SKIP_SPECIFIED BIT(1) STATIC;
      156    21670        %VLP_ACCT( FPTN=FIRST_ACCT_SPECIFIED,
      157    21671                   STCLASS=STATIC );
      158    21684    1   DCL J SBIN STATIC;
      159    21685    1   DCL STATE SBIN STATIC;
      160    21686    1   DCL MODE SBIN STATIC;                   /* OPEN mode - TRANSFER or TRANSPORT  */
      161    21687    1   DCL BACKUP_$$EFT BIT(1) STATIC;
      162    21688    1   DCL SUB_COMMAND SBIN STATIC;
      163    21689    1   DCL 1 OPTION_MAP WALIGNED STATIC SYMDEF,
      164    21690    1         2 ARCHIVE BIT(1),
      165    21691    1         2 QUEUED BIT(1),
      166    21692    1         2 QS BIT(1),
      167    21693    1         2 QF BIT(1),
      168    21694    1         2 ACTIVE BIT(1),
      169    21695    1         2 INACTIVE BIT(1),
      170    21696    1         2 DELF BIT(1);
      171    21697
      172    21698    1   DCL 1 SRCH_BIT STATIC,
      173    21699    1         2 DELF BIT(1),
      174    21700    1         2 QS BIT(1),
      175    21701    1         2 ARCHIVE BIT(1);
      176    21702    1   DCL CHECK_SRCH_BIT BIT(1);
      177    21703
      178    21704        /***
      179    21705         *** CONSTANT
      180    21706         ***/
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:138  
      181    21707
      182    21708    1   DCL 1 FLERRMSGSYS CONSTANT,
      183    21709    1         2 * UBIN BYTE CALIGNED INIT(LENGTHC(':FLERRMSG.:SYS   ')),
      184    21710    1         2 * CHAR(0) CALIGNED INIT(':FLERRMSG.:SYS   ');
      185    21711
      186    21712    1   DCL PROMPT CHAR(0) CONSTANT INIT('+');
      187    21713    1   DCL EFT_PROMPT CHAR(0) CONSTANT INIT('*');
      188    21714
      189    21715         /***
      190    21716          *** EQU
      191    21717          ***/
      192    21718        %XUD_UTS_EQU;
      193    21729
      194    21730         /***
      195    21731          *** BASED
      196    21732          ***/
      197    21733
      198    21734    1   DCL NCHARS CHAR(N) BASED CALIGNED;
      199    21735    1   DCL 1 B$VERSION BASED,
      200    21736    1         2 L# UBIN BYTE CALIGNED,
      201    21737    1         2 NAME# CHAR(B$VERSION.L#) CALIGNED;
      202    21738        %PARSE$OUT( STCLASS=BASED );
      203    21783        %PARSE$SYM( STCLASS=BASED );
      204    21821        %VLP_SN( STCLASS=BASED );
      205    21834        %SNLISTINFO( STCLASS="BASED(LAST_SNLISTINFO$)" );
      206    21837        %F$DCB;
      207    21894        %B$TCB( STCLASS="BASED(B$TCB$)" );
      208    21897        %B$ALT;
      209    21905        %FM$GRAN;
      210    21909
      211    21910
      212    21911         /***
      213    21912          *** FPT
      214    21913          ***/
      215    21914
      216    21915        %FPT_INT( FPTN=FPT_INT,
      217    21916                  UENTRY=FLB$EFT_BRK,
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:139  
      218    21917                  STCLASS=CONSTANT );
      219    21931
      220    21932        %P_PCB( NAME=EFT_CMD_PCB,
      221    21933                STCLASS=STATIC );
      222    22132
      223    22133        %XUR_INIT( NAME=XUR_INIT,
      224    22134                   SYNTAX=YES,
      225    22135                   COMMANDS=YES,
      226    22136                   PCB=EFT_CMD_PCB );
      227    22235
      228    22236        %XUH_PARAM( NAME=XUH_PARAM,
      229    22237                    OUTDCB1=M$DO );
      230    22298
      231    22299        %VLP_ERRCODE( FPTN=VLP_ERRCODE,
      232    22300                      STCLASS=STATIC );
      233    22345
      234    22346    1   DCL 1 FILE STATIC,
      235    22347    1         2 NAME# CHAR(31) CALIGNED,
      236    22348    1         2 L# UBIN BYTE CALIGNED;
      237    22349
      238    22350        %VLP_ACCT( FPTN=ACCT,
      239    22351                   STCLASS=STATIC );
      240    22364
      241    22365    1   DCL 1 START_FILE STATIC,
      242    22366    1         2 NAME# CHAR(31) CALIGNED,
      243    22367    1         2 L# UBIN BYTE CALIGNED;
      244    22368
      245    22369        %VLP_ACCT( FPTN=START_ACCT,
      246    22370                   STCLASS=STATIC );
      247    22383
      248    22384    1   DCL 1 STOP_FILE STATIC,
      249    22385    1         2 NAME# CHAR(31) CALIGNED,
      250    22386    1         2 L# UBIN BYTE CALIGNED;
      251    22387
      252    22388        %VLP_ACCT( FPTN=STOP_ACCT,
      253    22389                   STCLASS=STATIC );
      254    22402
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:140  
      255    22403        %VLP_SN( FPTN=FILE_SN,
      256    22404                 N=1,
      257    22405                 STCLASS=STATIC );
      258    22418
      259    22419        %VLP_SN( FPTN=DPSN,
      260    22420                 N=1,
      261    22421                 STCLASS=STATIC );
      262    22434
      263    22435        %FPT_OPEN( FPTN=CHECK_PACKSET,
      264    22436                   TEST=YES,
      265    22437                   DCB=M$DISK00,
      266    22438                   NXTF=YES,
      267    22439                   NAME=NULL_FILE,
      268    22440                   ACCT=NULL_ACCT,
      269    22441                   ASN=FILE,
      270    22442                   SN=DPSN,
      271    22443                   FUN=IN );
      272    22552
      273    22553        %FPT_DEVICE( FPTN=PAGE_LO_RESET,
      274    22554                     DCB=M$LO,
      275    22555                     PAGE=YES,
      276    22556                     HDR=PAGE_LO_HEADER );
      277    22574
      278    22575        %FPT_DEVICE( FPTN=ERASE_HEADER,
      279    22576                     DCB=M$LO,
      280    22577                     HDR=PAGE_LO_HEADER );
      281    22595
      282    22596        %VLP_HDR( FPTN=PAGE_LO_HEADER,
      283    22597                  RESETPAGE=NO,
      284    22598                  COUNT=76,
      285    22599                  TITLE=' ' );
      286    22615
      287    22616        %FPT_MADMUCK( FPTN=GET_PSN,
      288    22617                      ACCT=OUR_ACCT,
      289    22618                      SN=MUCK_LIST,
      290    22619                      READ=YES );
      291    22635
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:141  
      292    22636        %VLP_ACCT( FPTN=OUR_ACCT,
      293    22637                   STCLASS=STATIC );
      294    22650
      295    22651        %FPT_TIME( FPTN=GET_ANSDATE_DATEUTS,
      296    22652                   DATE=ANSDATEPIECE.YYMMDD,
      297    22653                   TIME=ANSDATEPIECE.HHMMSSSS,
      298    22654                   SOURCE=UTS,
      299    22655                   TSTAMP=DATEUTS,
      300    22656                   DEST=ANS );
      301    22675
      302    22676        %FPT_TIME( FPTN=GET_DATEUTS_ANSDATE,
      303    22677                   DATE=ANSDATEPIECE.YYMMDD,
      304    22678                   TIME=ANSDATEPIECE.HHMMSSSS,
      305    22679                   SOURCE=ANS,
      306    22680                   DEST=UTS,
      307    22681                   TSTAMP=DATEUTS );
      308    22700
      309    22701        %FPT_TIME( FPTN=GET_GREETING_TIME,
      310    22702                   TIME="GREETINGS.GTIME",
      311    22703                   DAY="GREETINGS.GDAY",
      312    22704                   DATE="GREETINGS.GDATE" );
      313    22723
      314    22724        %FPT_WRITE( FPTN=GREET_USER,
      315    22725                    DCB=M$LO,
      316    22726                    BUF=GREETINGS );
      317    22757
      318    22758        %FPT_WRITE( FPTN=GREET_TEST_USER,
      319    22759                    DCB=M$LO,
      320    22760                    BUF=TEST_GREETINGS );
      321    22791
      322    22792        %FPT_PRIV( FPTN=SWITCH_FMSEC,
      323    22793                   PRIV=%PR_FMSEC# );
      324    22808
      325    22809        %FPT_PRIV( FPTN=SWITCH_FMEFT,
      326    22810                   PRIV=%PR_FMEFT# );
      327    22825
      328    22826        %FPT_OPEN( FPTN=OPEN_LO_DO,
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:142  
      329    22827                   DCB=M$LO,
      330    22828                   ORG=UR,
      331    22829                   CTG=YES,
      332    22830                   FUN=CREATE );
      333    22939
      334    22940        %FPT_CLOSE( FPTN=CLOSE_FID,
      335    22941                    DISP=SAVE );
      336    22983
      337    22984        %FPT_OPEN( FPTN=OPEN_SI,
      338    22985                   DCB=M$SI,
      339    22986                   FUN=IN );
      340    23095
      341    23096        %FPT_CLOSE( FPTN=CLOSE_READ_FILE,
      342    23097                    DCB=M$READ_FILE,
      343    23098                    DISP=SAVE );
      344    23140
      345    23141        %FPT_OPEN( FPTN=OPEN_FID,
      346    23142                   SCRUB=YES,
      347    23143                   ACCT=FID_ACCT,
      348    23144                   NAME=FID_NAME,
      349    23145                   PASS=FID_PASS,
      350    23146                   SN=FID_SN,
      351    23147                   WSN=FID_WSN,
      352    23148                   CTG=YES );
      353    23257
      354    23258        %FPT_FID( FPTN=FPT_FID,
      355    23259                  ACCT=FID_ACCT,
      356    23260                  NAME=FID_NAME,
      357    23261                  PASS=FID_PASS,
      358    23262                  RES=OPEN_FID.V.RES#,
      359    23263                  SN=FID_SN,
      360    23264                  WSN=FID_WSN,
      361    23265                  ASN=OPEN_FID.V.ASN#,
      362    23266                  SACCT=YES,
      363    23267                  SNAME=YES,
      364    23268                  SPASS=YES,
      365    23269                  SRES=YES,
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:143  
      366    23270                  SSN=YES,
      367    23271                  SWSN=YES,
      368    23272                  RESULTS=FPT_FID_RESULTS );
      369    23295
      370    23296        %VLR_FID( FPTN=FPT_FID_RESULTS,
      371    23297                  STCLASS="STATIC SYMDEF" );
      372    23316
      373    23317        %VLP_NAME( FPTN=FID_NAME,
      374    23318                   LEN=31 );
      375    23345
      376    23346        %VLP_ACCT( FPTN=FID_ACCT );
      377    23359
      378    23360        %VLP_PASS( FPTN=FID_PASS );
      379    23373
      380    23374        %VLP_SN( FPTN=FID_SN,
      381    23375                 N=10,
      382    23376                 SN=' ' );
      383    23389
      384    23390        %VLP_WSN( FPTN=FID_WSN );
      385    23403
      386    23404        %FPT_OPEN( FPTN=OPEN_DEFAULT_LO,
      387    23405                   DCB=M$LO,
      388    23406                   SCRUB=YES,
      389    23407                   ORG=UR,
      390    23408                   FUN=CREATE,
      391    23409                   ASN=DEVICE,
      392    23410                   RES='ME' );
      393    23519
      394    23520        %FPT_REM( FPTN=FPT_REM );
      395    23534
      396    23535        %FPT_DEVICE( FPTN=PAGE_LO,
      397    23536                     DCB=M$LO,
      398    23537                     PAGE=YES,
      399    23538                     HDR=ERASE );
      400    23556
      401    23557        %VLP_HDR( FPTN=LO_HEADER,
      402    23558                  RESETPAGE=YES,
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:144  
      403    23559                  COUNT=76,
      404    23560                  TITLE=' ' );
      405    23576
      406    23577        %VLP_NAME( FPTN=RET_CMDS_FNAME,
      407    23578                   NAME='*RET_CMDS' );
      408    23605        %FPT_OPEN( FPTN=RET_CMDS_OPEN,
      409    23606                   DCB=M$READ_FILE,
      410    23607                   ASN=FILE,
      411    23608                   FUN=IN,
      412    23609                   NAME=RET_CMDS_FNAME );
      413    23718        %FPT_OPEN ( FPTN = BACKUP_CMD_OPEN,
      414    23719                    DCB = M$READ_FILE,
      415    23720                    ASN = FILE,
      416    23721                    FUN = IN,
      417    23722                    NAME = BACKUP_CMD_FNAME );
      418    23831
      419    23832        %FPT_PRIV( FPTN=CHKEFTRUN,
      420    23833                   PRIV=%PPR_EFT#,
      421    23834                   PPRIV=YES );
      422    23849
      423    23850        %FPT_OPEN ( FPTN=SAVE_TAPE_OPEN);
      424    23959
      425    23960        %FPT_OPEN ( FPTN=OPEN_BACKUP_RBLDFILE,
      426    23961                   DCB=M$STATUS,
      427    23962                   ORG=KEYED,
      428    23963                   ACS=DIRECT,
      429    23964                   ASN=FILE,
      430    23965                   CTG=YES,
      431    23966                   FUN=IN,
      432    23967                   NAME=FID_NAME,
      433    23968                   ACCT=FID_ACCT,
      434    23969                   SN=FID_SN,
      435    23970                   SCRUB=YES );
      436    24079
      437    24080        %FPT_OPEN ( FPTN=OPEN_BACKUP_TEMP,
      438    24081                   DCB=M$DISK00,
      439    24082                   ORG=KEYED,
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:145  
      440    24083                   ACS=DIRECT,
      441    24084                   ASN=FILE,
      442    24085                   CTG=YES,
      443    24086                   FUN=CREATE,
      444    24087                   EXIST=NEWFILE,
      445    24088                   NAME=BACKUP_TEMP,
      446    24089                   SN=BACKUP_SN,
      447    24090                   SCRUB=YES );
      448    24199
      449    24200        %VLP_NAME( FPTN=BACKUP_TEMP,
      450    24201                   NAME='*:BACKUP');
      451    24228
      452    24229        %FPT_READ( FPTN=READ_BACKUP_TEMP,
      453    24230                   KEY=STATUS_KEY,
      454    24231                   KEYR=YES,
      455    24232                   KEYS=YES,
      456    24233                   BUF=TSN_USED_BUF,
      457    24234                   DCB=M$DISK00);
      458    24273
      459    24274        %FPT_WRITE( FPTN=WRITE_BACKUP_TEMP,
      460    24275                   BUF=TSN_USED_BUF,
      461    24276                   KEY=STATUS_KEY,
      462    24277                   DCB=M$DISK00);
      463    24308
      464    24309        %FPT_CLOSE( FPTN=CLOSE_BACKUP_TEMP,
      465    24310                    DISP=SAVE,
      466    24311                    DCB=M$DISK00);
      467    24353
      468    24354
      469    24355        /****************************************/
      470    24356
      471    24357    1      M$SI$ = DCBADDR(DCBNUM(M$SI));

  24357 20 000002   000000 236007 xsym               LDQ     M$SI,DL
        20 000003   000000 470400 21                 LDP0    0
        20 000004   000000 471500                    LDP1    0,,PR0
        20 000005   100000 236106                    LDQ     0,QL,PR1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:146  
        20 000006   000215 756000 2                  STQ     M$SI$

      472    24358    1      M$READ_FILE$ = DCBADDR(DCBNUM(M$READ_FILE));

  24358 20 000007   000000 236007 xsym               LDQ     M$READ_FILE,DL
        20 000010   100000 236106                    LDQ     0,QL,PR1
        20 000011   000214 756000 2                  STQ     M$READ_FILE$

      473    24359    1      M$LO$ = DCBADDR(DCBNUM(M$LO));

  24359 20 000012   000000 236007 xsym               LDQ     M$LO,DL
        20 000013   100000 236106                    LDQ     0,QL,PR1
        20 000014   000216 756000 2                  STQ     M$LO$

      474    24360    1      M$CATALOG$ = DCBADDR(DCBNUM(M$CATALOG));

  24360 20 000015   000000 236007 xsym               LDQ     M$CATALOG,DL
        20 000016   100000 236106                    LDQ     0,QL,PR1
        20 000017   000217 756000 2                  STQ     M$CATALOG$

      475    24361
      476    24362    1      CALL XUR$INIT( XUR_INIT );

  24362 20 000020   000001 630400 21                 EPPR0   1
        20 000021   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 000022   000000 701000 xent               TSX1    XUR$INIT
        20 000023   000000 011000                    NOP     0

      477    24363    1      CALL XUR$SETERRMSG( FLERRMSGSYS )

  24363 20 000024   000002 630400 21                 EPPR0   2
        20 000025   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 000026   000000 701000 xent               TSX1    XUR$SETERRMSG
        20 000027   000031 702000 20                 TSX2    s:24365
        20 000030   000033 710000 20                 TRA     s:24377

      478    24364    2       WHENALTRETURN DO;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:147  

      479    24365    2         CALL M$XXX;

  24365 20 000031   000003 713400                    CLIMB   3
        20 000032   000000 401760                    pmme    nvectors=0

      480    24366    2         END;

      481    24367
      482    24368        /*
      483    24369           CALL M$SPRIV( CHKEFTRUN )
      484    24370            WHENALTRETURN DO;
      485    24371              CALL FLI$RPT_ERR;
      486    24372              CALL FLI$RPT_ERR( E_CANT_RUN_EFT );
      487    24373              CALL M$XXX;
      488    24374              END;
      489    24375        */
      490    24376
      491    24377    1      IF B$JIT.PRIV.JOB & %PR_FMSEC#

  24377 20 000033   000000 470400 xsym               LDP0    B$JIT$
        20 000034   000015 236100                    LDQ     13,,PR0
        20 000035   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000036   000042 600000 20                 TZE     s:24379

      492    24378    1       THEN FMSEC = '1'B;

  24378 20 000037   400000 236003                    LDQ     -131072,DU
        20 000040   000000 756000 xsym               STQ     FMSEC
        20 000041   000043 710000 20                 TRA     s:24380

      493    24379    1       ELSE FMSEC = '0'B;

  24379 20 000042   000000 450000 xsym               STZ     FMSEC

      494    24380    1      IF NOT FMSEC

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:148  
  24380 20 000043   000000 234000 xsym               SZN     FMSEC
        20 000044   000051 604000 20                 TMI     s:24382

      495    24381    1       THEN CALL M$RPRIV( SWITCH_FMSEC ) ALTRET(ERROR_OUT);

  24381 20 000045   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000046   420013 713400                    CLIMB   alt,+8203
        20 000047   400000 401760                    pmme    nvectors=1
        20 000050   001616 702000 20                 TSX2    ERROR_OUT

      496    24382    1      CALL M$OPEN( OPEN_SI ) ALTRET( ERROR_OUT );

  24382 20 000051   001074 630400 2                  EPPR0   OPEN_SI
        20 000052   450000 713400                    CLIMB   alt,open
        20 000053   410400 401760                    pmme    nvectors=18
        20 000054   001616 702000 20                 TSX2    ERROR_OUT

      497    24383    1      OPEN_LO_DO.V.DCB# = DCBNUM(M$LO);

  24383 20 000055   000000 236007 xsym               LDQ     M$LO,DL
        20 000056   000000 620006                    EAX0    0,QL
        20 000057   001010 740000 2                  STX0    OPEN_LO_DO+36

      498    24384    1      CALL M$OPEN( OPEN_LO_DO ) ALTRET( ERROR_OUT );

  24384 20 000060   000744 630400 2                  EPPR0   OPEN_LO_DO
        20 000061   450000 713400                    CLIMB   alt,open
        20 000062   410400 401760                    pmme    nvectors=18
        20 000063   001616 702000 20                 TSX2    ERROR_OUT

      499    24385    1      CALL M$DEVICE( PAGE_LO_RESET ) ALTRET( ERROR_OUT );

  24385 20 000064   000600 630400 2                  EPPR0   PAGE_LO_RESET
        20 000065   450006 713400                    CLIMB   alt,+20486
        20 000066   401000 401760                    pmme    nvectors=3
        20 000067   001616 702000 20                 TSX2    ERROR_OUT

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:149  
      500    24386    1      IF NOT DCBADDR(DCBNUM(M$DO))->F$DCB.FCD#

  24386 20 000070   000000 236007 xsym               LDQ     M$DO,DL
        20 000071   000000 470400 21                 LDP0    0
        20 000072   000000 471500                    LDP1    0,,PR0
        20 000073   100000 473506                    LDP3    0,QL,PR1
        20 000074   300031 236100                    LDQ     25,,PR3
        20 000075   020000 316007                    CANQ    8192,DL
        20 000076   000106 601000 20                 TNZ     s:24397

      501    24387    2       THEN DO;             /* When debugging, DELTA might already have it open  */

      502    24388    2         OPEN_LO_DO.V.DCB# = DCBNUM(M$DO);

  24388 20 000077   000000 236007 xsym               LDQ     M$DO,DL
        20 000100   000000 620006                    EAX0    0,QL
        20 000101   001010 740000 2                  STX0    OPEN_LO_DO+36

      503    24389    2         CALL M$OPEN( OPEN_LO_DO ) ALTRET( ERROR_OUT );

  24389 20 000102   000744 630400 2                  EPPR0   OPEN_LO_DO
        20 000103   450000 713400                    CLIMB   alt,open
        20 000104   410400 401760                    pmme    nvectors=18
        20 000105   001616 702000 20                 TSX2    ERROR_OUT

      504    24390    2         END;

      505    24391
      506    24392        /***
      507    24393         *** If the appropriate sense switches are set, output a different invocation
      508    24394         *** and set TEST-MODE. If in test mode, miscellaneous info. such as time
      509    24395         *** in heading output, etc. must remain constant for the purpose of running QUAC.
      510    24396         ***/
      511    24397    1      IF B$JIT.SWITCH ~= '124123124000'O   /* Different greeting if in test mode */

  24397 20 000106   000000 470400 xsym               LDP0    B$JIT$
        20 000107   000031 236100                    LDQ     25,,PR0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:150  
        20 000110   000063 116000 19                 CMPQ    LEGAL_CHAR+5
        20 000111   000130 600000 20                 TZE     s:24405

      512    24398    2        THEN DO;

      513    24399    2        TEST_MODE = '0'B;

  24399 20 000112   000000 450000 xsym               STZ     TEST_MODE

      514    24400    2        GREETINGS.VERSION = ADDR(B_VERSION)->B$VERSION.NAME#;

  24400 20 000113   000000 236000 xsym               LDQ     B_VERSION
        20 000114   000033 772000                    QRL     27
        20 000115   000000 620006                    EAX0    0,QL
        20 000116   040000 100440                    MLR     fill='040'O
        20 000117   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
        20 000120   000200 200006 2                  ADSC9   GREETINGS+1              cn=1,n=6

      515    24401    2      CALL M$TIME( GET_GREETING_TIME );

  24401 20 000121   000670 630400 2                  EPPR0   GET_GREETING_TIME
        20 000122   020004 713400                    CLIMB   8196
        20 000123   402000 401760                    pmme    nvectors=5

      516    24402    2      CALL M$WRITE( GREET_USER );

  24402 20 000124   000704 630400 2                  EPPR0   GREET_USER
        20 000125   040001 713400                    CLIMB   write
        20 000126   401400 401760                    pmme    nvectors=4

      517    24403    2   END;

  24403 20 000127   000135 710000 20                 TRA     s:24410

      518    24404    2       ELSE DO;

      519    24405    2         TEST_MODE = '1'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:151  

  24405 20 000130   400000 236003                    LDQ     -131072,DU
        20 000131   000000 756000 xsym               STQ     TEST_MODE

      520    24406    2         CALL M$WRITE ( GREET_TEST_USER );

  24406 20 000132   000720 630400 2                  EPPR0   GREET_TEST_USER
        20 000133   040001 713400                    CLIMB   write
        20 000134   401400 401760                    pmme    nvectors=4

      521    24407    2   END;

      522    24408
      523    24409
      524    24410    1      BREAK_DCB# = 0;

  24410 20 000135   000156 450000 2                  STZ     BREAK_DCB#

      525    24411    1      BREAK_COUNT = 0;

  24411 20 000136   000154 450000 2                  STZ     BREAK_COUNT

      526    24412    1      BREAK_CONTINUED = '0'B;

  24412 20 000137   000155 450000 2                  STZ     BREAK_CONTINUED

      527    24413    1      BREAK_TASK = 'Initialization!';

  24413 20 000140   040000 100400                    MLR     fill='040'O
        20 000141   000064 000017 19                 ADSC9   LEGAL_CHAR+6             cn=0,n=15
        20 000142   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      528    24414
      529    24415    1      CATALOG_ON = '0'B;

  24415 20 000143   000000 450000 xsym               STZ     CATALOG_ON

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:152  
      530    24416    1      BACKUP_$$EFT = '0'B;

  24416 20 000144   000251 450000 2                  STZ     BACKUP_$$EFT

      531    24417
      532    24418    1      CALL M$INT( FPT_INT );

  24418 20 000145   000010 630400 19                 EPPR0   FPT_INT
        20 000146   010002 713400                    CLIMB   4098
        20 000147   400000 401760                    pmme    nvectors=1

      533    24419
      534    24420         /***
      535    24421          *** Main command parsing loop.
      536    24422          ***/
      537    24423
      538    24424    2      DO WHILE('1'B);

      539    24425
      540    24426        /***
      541    24427         *** If a user does not have FMSEC privilege, then restrict the setting of FMSEC
      542    24428         *** to a set of EFT commands, when the user only has EFT processor priv.
      543    24429         ***/
      544    24430    2         IF NOT FMSEC

  24430 20 000150   000000 234000 xsym               SZN     FMSEC
        20 000151   000157 604000 20                 TMI     s:24434

      545    24431    2          THEN CALL M$RPRIV( SWITCH_FMSEC )

  24431 20 000152   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000153   420013 713400                    CLIMB   alt,+8203
        20 000154   400000 401760                    pmme    nvectors=1
        20 000155   000157 702000 20                 TSX2    s:24434
        20 000156   000157 710000 20                 TRA     s:24434

      546    24432    3             WHENALTRETURN DO;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:153  

      547    24433    3               END;

      548    24434    2         BREAK_CONTINUED = '0'B;

  24434 20 000157   000155 450000 2                  STZ     BREAK_CONTINUED

      549    24435    2         BREAK_DCB# = 0;

  24435 20 000160   000156 450000 2                  STZ     BREAK_DCB#

      550    24436    2         BREAK_TASK = 'Getting command!';

  24436 20 000161   040000 100400                    MLR     fill='040'O
        20 000162   000070 000020 19                 ADSC9   LEGAL_CHAR+10            cn=0,n=16
        20 000163   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      551    24437    2         PREV_COMMAND = COMMAND;           /* Save previous command              */

  24437 20 000164   000167 235000 2                  LDA     COMMAND
        20 000165   000170 755000 2                  STA     PREV_COMMAND

      552    24438
      553    24439    2         IF FIRST_TIME

  24439 20 000166   000176 234000 2                  SZN     FIRST_TIME
        20 000167   000211 605000 20                 TPL     s:24444

      554    24440    3          THEN DO;

      555    24441    3            TEMP = B$JIT.CCARS;

  24441 20 000170   000000 470400 xsym               LDP0    B$JIT$
        20 000171   000032 236100                    LDQ     26,,PR0
        20 000172   000022 732000                    QRS     18
        20 000173   000236 756000 2                  STQ     TEMP

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:154  
      556    24442    3            CALL XUR$GETCMD( EFT_CMD, NODE$, VECTOR(EFT_PROMPT), B$JIT.CCBUF, TEMP )
             24442                     ALTRET( TELL_ERROR );

  24442 20 000174   000006 236000 21                 LDQ     6
        20 000175   200046 756100                    STQ     @MAX_NX+5,,AUTO
        20 000176   000000 236000 xsym               LDQ     B$JIT$
        20 000177   000033 036003                    ADLQ    27,DU
        20 000200   000007 235000 21                 LDA     7
        20 000201   200044 757100                    STAQ    @MAX_NX+3,,AUTO
        20 000202   000010 237000 21                 LDAQ    8
        20 000203   200042 757100                    STAQ    @MAX_NX+1,,AUTO
        20 000204   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 000205   000023 631400 xsym               EPPR1   B_VECTNIL+19
        20 000206   000000 701000 xent               TSX1    XUR$GETCMD
        20 000207   001461 702000 20                 TSX2    TELL_ERROR

      557    24443    3            END;

  24443 20 000210   000215 710000 20                 TRA     s:24445

      558    24444    2         ELSE CALL XUR$GETCMD( EFT_CMD, NODE$, VECTOR(EFT_PROMPT) ) ALTRET( TELL_ERROR
             24444                   );

  24444 20 000211   000012 630400 21                 EPPR0   10
        20 000212   000021 631400 xsym               EPPR1   B_VECTNIL+17
        20 000213   000000 701000 xent               TSX1    XUR$GETCMD
        20 000214   001461 702000 20                 TSX2    TELL_ERROR

      559    24445    2         CALL XUR$ECHOIF( DCBNUM(M$LO) );

  24445 20 000215   000000 236007 xsym               LDQ     M$LO,DL
        20 000216   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 000217   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 000220   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 000221   200043 630500                    EPPR0   @MAX_NX+2,,AUTO
        20 000222   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 000223   000000 701000 xent               TSX1    XUR$ECHOIF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:155  
        20 000224   000000 011000                    NOP     0

      560    24446    2         CALL FLI$INIT;

  24446 20 000225   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 000226   000000 701000 xent               TSX1    FLI$INIT
        20 000227   000000 011000                    NOP     0

      561    24447    2         CALL FLB_OPTION_INIT;

  24447 20 000230   006226 701000 20                 TSX1    FLB_OPTION_INIT
        20 000231   000000 011000                    NOP     0

      562    24448
      563    24449    2         TRANS_NBR = 0;

  24449 20 000232   000000 450000 xsym               STZ     TRANS_NBR

      564    24450    2         TOTAL_FILES = 0;

  24450 20 000233   000000 450000 xsym               STZ     TOTAL_FILES

      565    24451    2         TOTAL_GRANS = 0;

  24451 20 000234   000000 450000 xsym               STZ     TOTAL_GRANS

      566    24452    2         TAPE_OPTION = '0'B;

  24452 20 000235   000000 100400                    MLR     fill='000'O
        20 000236   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        20 000237   000000 000020 xsym               ADSC9   TAPE_OPTION              cn=0,n=16

      567    24453    2         TSN_SET_NBR = 0;        /* Start each new command from first tape set   */

  24453 20 000240   000000 450000 xsym               STZ     TSN_SET_NBR

      568    24454    2         SNLIST_NBR = 0;                   /* Index of current SN list           */
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:156  

  24454 20 000241   000000 450000 xsym               STZ     SNLIST_NBR

      569    24455    2         BREAK_COUNT = 0;

  24455 20 000242   000154 450000 2                  STZ     BREAK_COUNT

      570    24456    2         CATALOG_ON = '0'B;

  24456 20 000243   000000 450000 xsym               STZ     CATALOG_ON

      571    24457    2         COMMAND_ERROR = '0'B;

  24457 20 000244   000000 450000 xsym               STZ     COMMAND_ERROR

      572    24458    2         COMMAND = NODE$->OUT$BLK.CODE;

  24458 20 000245   000226 470400 2                  LDP0    NODE$
        20 000246   000000 236100                    LDQ     0,,PR0
        20 000247   777777 376007                    ANQ     -1,DL
        20 000250   000167 756000 2                  STQ     COMMAND

      573    24459    2         OPTION_MAP = '0'B;

  24459 20 000251   000253 450000 2                  STZ     OPTION_MAP

      574    24460    2         SRCH_BIT = '111'B;

  24460 20 000252   700000 236003                    LDQ     -32768,DU
        20 000253   000254 756000 2                  STQ     SRCH_BIT

      575    24461    2         FILE_TYPE = '0'B;

  24461 20 000254   000000 220003                    LDX0    0,DU
        20 000255   000000 740000 xsym               STX0    FILE_TYPE

      576    24462    2         CHECK_SRCH_BIT = '0'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:157  

  24462 20 000256   200003 450100                    STZ     CHECK_SRCH_BIT,,AUTO

      577    24463    2         FPT_FID_RESULTS = '0'B;

  24463 20 000257   000000 100400                    MLR     fill='000'O
        20 000260   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        20 000261   001346 000044 2                  ADSC9   FPT_FID_RESULTS          cn=0,n=36

      578    24464        /***
      579    24465         *** Only the following commands are allowed to be executed by the general
      580    24466         *** user (user without processor privilege %PPR_EFT or FMSEC). Most of the time
      581    24467         *** these commands will be executed by the general user in IBEX. Since
      582    24468         *** there is no way to determine if commands are executed in IBEX or
      583    24469         *** EFT, a minimal set must be allowed. Abort the general user if he
      584    24470         *** tries to execute commands other than the minimal set.
      585    24471        */
      586    24472    2         IF NOT (B$JIT.PPRIV & %PPR_EFT#) AND NOT FMSEC

  24472 20 000262   000000 471400 xsym               LDP1    B$JIT$
        20 000263   100020 236100                    LDQ     16,,PR1
        20 000264   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000265   000323 601000 20                 TNZ     s:24483
        20 000266   000000 234000 xsym               SZN     FMSEC
        20 000267   000323 604000 20                 TMI     s:24483

      587    24473    3          THEN DO;

      588    24474    4            DO CASE ( COMMAND );

  24474 20 000270   000167 235000 2                  LDA     COMMAND
        20 000271   000007 135007                    SBLA    7,DL
        20 000272   000020 115007                    CMPA    16,DL
        20 000273   000275 602005 20                 TNC     s:24474+5,AL
        20 000274   000315 710000 20                 TRA     s:24478
        20 000275   000323 710000 20                 TRA     s:24483
        20 000276   000315 710000 20                 TRA     s:24478
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:158  
        20 000277   000315 710000 20                 TRA     s:24478
        20 000300   000315 710000 20                 TRA     s:24478
        20 000301   000315 710000 20                 TRA     s:24478
        20 000302   000315 710000 20                 TRA     s:24478
        20 000303   000315 710000 20                 TRA     s:24478
        20 000304   000315 710000 20                 TRA     s:24478
        20 000305   000323 710000 20                 TRA     s:24483
        20 000306   000315 710000 20                 TRA     s:24478
        20 000307   000323 710000 20                 TRA     s:24483
        20 000310   000323 710000 20                 TRA     s:24483
        20 000311   000323 710000 20                 TRA     s:24483
        20 000312   000323 710000 20                 TRA     s:24483
        20 000313   000323 710000 20                 TRA     s:24483
        20 000314   000323 710000 20                 TRA     s:24483

      589    24475    4             CASE( %NULL,%FETCH,%UNFETCH,%STOW_ACTIVE,%STOW_INACTIVE,%UNSTOW,

      590    24476    4              %UNARCHIVE,%END );
      591    24477    4             CASE ( ELSE );

      592    24478    4               CALL FLI$RPT_ERR(E_CANT_RUN_EFT);

  24478 20 000315   000015 630400 21                 EPPR0   13
        20 000316   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 000317   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 000320   000000 011000                    NOP     0

      593    24479    4               CALL M$XXX;

  24479 20 000321   000003 713400                    CLIMB   3
        20 000322   000000 401760                    pmme    nvectors=0

      594    24480    4             END;

      595    24481    3            END;

      596    24482
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:159  
      597    24483    3         DO CASE( COMMAND );

  24483 20 000323   000167 235000 2                  LDA     COMMAND
        20 000324   000057 115007                    CMPA    47,DL
        20 000325   000327 602005 20                 TNC     s:24483+4,AL
        20 000326   001445 710000 20                 TRA     s:24707
        20 000327   000420 710000 20                 TRA     s:24493
        20 000330   000434 710000 20                 TRA     s:24498
        20 000331   000444 710000 20                 TRA     s:24502
        20 000332   000460 710000 20                 TRA     s:24509
        20 000333   000617 710000 20                 TRA     s:24546
        20 000334   000636 710000 20                 TRA     s:24552
        20 000335   000655 710000 20                 TRA     s:24558
        20 000336   000454 710000 20                 TRA     s:24506
        20 000337   000725 710000 20                 TRA     s:24572
        20 000340   000523 710000 20                 TRA     s:24522
        20 000341   001150 710000 20                 TRA     s:24628
        20 000342   001167 710000 20                 TRA     s:24634
        20 000343   000542 710000 20                 TRA     s:24528
        20 000344   000561 710000 20                 TRA     s:24534
        20 000345   000600 710000 20                 TRA     s:24540
        20 000346   000406 710000 20                 TRA     s:24486
        20 000347   000410 710000 20                 TRA     s:24489
        20 000350   001040 710000 20                 TRA     s:24599
        20 000351   001040 710000 20                 TRA     s:24599
        20 000352   001115 710000 20                 TRA     s:24617
        20 000353   001057 710000 20                 TRA     s:24605
        20 000354   001076 710000 20                 TRA     s:24611
        20 000355   001131 710000 20                 TRA     s:24622
        20 000356   000751 710000 20                 TRA     s:24579
        20 000357   000775 710000 20                 TRA     s:24586
        20 000360   001021 710000 20                 TRA     s:24593
        20 000361   001021 710000 20                 TRA     s:24593
        20 000362   001021 710000 20                 TRA     s:24593
        20 000363   000504 710000 20                 TRA     s:24516
        20 000364   001236 710000 20                 TRA     s:24650
        20 000365   001255 710000 20                 TRA     s:24656
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:160  
        20 000366   001274 710000 20                 TRA     s:24662
        20 000367   001313 710000 20                 TRA     s:24668
        20 000370   001203 710000 20                 TRA     s:24639
        20 000371   001217 710000 20                 TRA     s:24644
        20 000372   000701 710000 20                 TRA     s:24565
        20 000373   001334 710000 20                 TRA     s:24675
        20 000374   001334 710000 20                 TRA     s:24675
        20 000375   001334 710000 20                 TRA     s:24675
        20 000376   001334 710000 20                 TRA     s:24675
        20 000377   001445 710000 20                 TRA     s:24707
        20 000400   001432 710000 20                 TRA     s:24700
        20 000401   000701 710000 20                 TRA     s:24565
        20 000402   001360 710000 20                 TRA     s:24682
        20 000403   001375 710000 20                 TRA     s:24688
        20 000404   001445 710000 20                 TRA     s:24707
        20 000405   001413 710000 20                 TRA     s:24694

      598    24484
      599    24485    3          CASE( %NULL );

      600    24486    3            FIRST_TIME = '0'B;

  24486 20 000406   000176 450000 2                  STZ     FIRST_TIME
        20 000407   001445 710000 20                 TRA     s:24707

      601    24487
      602    24488    3          CASE( %ERROR );

      603    24489    3            BREAK_TASK = 'Error summary!';

  24489 20 000410   040000 100400                    MLR     fill='040'O
        20 000411   000074 000016 19                 ADSC9   LEGAL_CHAR+14            cn=0,n=14
        20 000412   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      604    24490    3            CALL FLI$ERROR_SUMMARY( '1'B );

  24490 20 000413   000016 630400 21                 EPPR0   14
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:161  
        20 000414   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 000415   000000 701000 xent               TSX1    FLI$ERROR_SUMMARY
        20 000416   000000 011000                    NOP     0
        20 000417   001445 710000 20                 TRA     s:24707

      605    24491
      606    24492    3          CASE( %HELP );

      607    24493    3            BREAK_TASK = 'Helping!';

  24493 20 000420   040000 100400                    MLR     fill='040'O
        20 000421   000100 000010 19                 ADSC9   LEGAL_CHAR+18            cn=0,n=8
        20 000422   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      608    24494    3            XUH_PARAM.HELP$ = NODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXTC$;

  24494 20 000423   000226 470400 2                  LDP0    NODE$
        20 000424   000003 471500                    LDP1    3,,PR0
        20 000425   100003 236100                    LDQ     3,,PR1
        20 000426   000355 756000 2                  STQ     XUH_PARAM+9

      609    24495    3            CALL XUR$HELP( XUH_PARAM );

  24495 20 000427   000017 630400 21                 EPPR0   15
        20 000430   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 000431   000000 701000 xent               TSX1    XUR$HELP
        20 000432   000000 011000                    NOP     0
        20 000433   001445 710000 20                 TRA     s:24707

      610    24496
      611    24497    3          CASE( %MORE_HELP );

      612    24498    3            BREAK_TASK = 'Helping!';

  24498 20 000434   040000 100400                    MLR     fill='040'O
        20 000435   000100 000010 19                 ADSC9   LEGAL_CHAR+18            cn=0,n=8
        20 000436   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:162  

      613    24499    3            CALL XUR$MOREMSG( XUH_PARAM );

  24499 20 000437   000017 630400 21                 EPPR0   15
        20 000440   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 000441   000000 701000 xent               TSX1    XUR$MOREMSG
        20 000442   000000 011000                    NOP     0
        20 000443   001445 710000 20                 TRA     s:24707

      614    24500
      615    24501    3          CASE( %ALL_HELP );

      616    24502    3            BREAK_TASK = 'Helping!';

  24502 20 000444   040000 100400                    MLR     fill='040'O
        20 000445   000100 000010 19                 ADSC9   LEGAL_CHAR+18            cn=0,n=8
        20 000446   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      617    24503    3            CALL XUR$ALLMSG( XUH_PARAM );

  24503 20 000447   000017 630400 21                 EPPR0   15
        20 000450   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 000451   000000 701000 xent               TSX1    XUR$ALLMSG
        20 000452   000000 011000                    NOP     0
        20 000453   001445 710000 20                 TRA     s:24707

      618    24504
      619    24505    3          CASE( %END );

      620    24506    3            CALL M$EXIT( FPT_EXIT );

  24506 20 000454   000000 630400 xsym               EPPR0   FPT_EXIT
        20 000455   000001 713400                    CLIMB   exit
        20 000456   400400 401760                    pmme    nvectors=2
        20 000457   001445 710000 20                 TRA     s:24707

      621    24507
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:163  
      622    24508    3          CASE( %CHECK );

      623    24509    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24509 20 000460   000000 234000 xsym               SZN     FMSEC
        20 000461   000471 604000 20                 TMI     s:24511
        20 000462   000000 470400 xsym               LDP0    B$JIT$
        20 000463   000020 236100                    LDQ     16,,PR0
        20 000464   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000465   000471 600000 20                 TZE     s:24511

      624    24510    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24510 20 000466   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000467   020012 713400                    CLIMB   8202
        20 000470   400000 401760                    pmme    nvectors=1

      625    24511    3            BREAK_TASK = 'Checking!';

  24511 20 000471   040000 100400                    MLR     fill='040'O
        20 000472   000102 000011 19                 ADSC9   LEGAL_CHAR+20            cn=0,n=9
        20 000473   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      626    24512    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;

  24512 20 000474   000217 470400 2                  LDP0    M$CATALOG$
        20 000475   000031 236100                    LDQ     25,,PR0
        20 000476   000026 736000                    QLS     22
        20 000477   400000 376003                    ANQ     -131072,DU
        20 000500   000000 756000 xsym               STQ     CATALOG_ON

      627    24513    3            CALL FLB_TAPE_NODES;

  24513 20 000501   002402 701000 20                 TSX1    FLB_TAPE_NODES
        20 000502   000000 011000                    NOP     0
        20 000503   001445 710000 20                 TRA     s:24707

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:164  
      628    24514
      629    24515    3          CASE( %RETRIEVE );

      630    24516    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24516 20 000504   000000 234000 xsym               SZN     FMSEC
        20 000505   000515 604000 20                 TMI     s:24518
        20 000506   000000 470400 xsym               LDP0    B$JIT$
        20 000507   000020 236100                    LDQ     16,,PR0
        20 000510   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000511   000515 600000 20                 TZE     s:24518

      631    24517    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24517 20 000512   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000513   020012 713400                    CLIMB   8202
        20 000514   400000 401760                    pmme    nvectors=1

      632    24518    3            BREAK_TASK = 'Retrieving!';

  24518 20 000515   040000 100400                    MLR     fill='040'O
        20 000516   000105 000013 19                 ADSC9   LEGAL_CHAR+23            cn=0,n=11
        20 000517   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      633    24519    3            CALL FLB_TAPE_NODES;

  24519 20 000520   002402 701000 20                 TSX1    FLB_TAPE_NODES
        20 000521   000000 011000                    NOP     0
        20 000522   001445 710000 20                 TRA     s:24707

      634    24520
      635    24521    3          CASE( %RESTORE );

      636    24522    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24522 20 000523   000000 234000 xsym               SZN     FMSEC
        20 000524   000534 604000 20                 TMI     s:24524
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:165  
        20 000525   000000 470400 xsym               LDP0    B$JIT$
        20 000526   000020 236100                    LDQ     16,,PR0
        20 000527   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000530   000534 600000 20                 TZE     s:24524

      637    24523    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24523 20 000531   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000532   020012 713400                    CLIMB   8202
        20 000533   400000 401760                    pmme    nvectors=1

      638    24524    3            BREAK_TASK = 'Restoring!';

  24524 20 000534   040000 100400                    MLR     fill='040'O
        20 000535   000110 000012 19                 ADSC9   LEGAL_CHAR+26            cn=0,n=10
        20 000536   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      639    24525    3            CALL FLB_RESTORE_NODES;

  24525 20 000537   005452 701000 20                 TSX1    FLB_RESTORE_NODES
        20 000540   000000 011000                    NOP     0
        20 000541   001445 710000 20                 TRA     s:24707

      640    24526
      641    24527    3          CASE( %REWIND );

      642    24528    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24528 20 000542   000000 234000 xsym               SZN     FMSEC
        20 000543   000553 604000 20                 TMI     s:24530
        20 000544   000000 470400 xsym               LDP0    B$JIT$
        20 000545   000020 236100                    LDQ     16,,PR0
        20 000546   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000547   000553 600000 20                 TZE     s:24530

      643    24529    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:166  
  24529 20 000550   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000551   020012 713400                    CLIMB   8202
        20 000552   400000 401760                    pmme    nvectors=1

      644    24530    3            BREAK_TASK = 'Rewinding!';

  24530 20 000553   040000 100400                    MLR     fill='040'O
        20 000554   000113 000012 19                 ADSC9   LEGAL_CHAR+29            cn=0,n=10
        20 000555   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      645    24531    3            CALL FLB_TAPE_NODES;

  24531 20 000556   002402 701000 20                 TSX1    FLB_TAPE_NODES
        20 000557   000000 011000                    NOP     0
        20 000560   001445 710000 20                 TRA     s:24707

      646    24532
      647    24533    3          CASE( %REMOVE );

      648    24534    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24534 20 000561   000000 234000 xsym               SZN     FMSEC
        20 000562   000572 604000 20                 TMI     s:24536
        20 000563   000000 470400 xsym               LDP0    B$JIT$
        20 000564   000020 236100                    LDQ     16,,PR0
        20 000565   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000566   000572 600000 20                 TZE     s:24536

      649    24535    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24535 20 000567   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000570   020012 713400                    CLIMB   8202
        20 000571   400000 401760                    pmme    nvectors=1

      650    24536    3            BREAK_TASK = 'Removing!';

  24536 20 000572   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:167  
        20 000573   000116 000011 19                 ADSC9   LEGAL_CHAR+32            cn=0,n=9
        20 000574   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      651    24537    3            CALL FLB_TAPE_NODES;

  24537 20 000575   002402 701000 20                 TSX1    FLB_TAPE_NODES
        20 000576   000000 011000                    NOP     0
        20 000577   001445 710000 20                 TRA     s:24707

      652    24538
      653    24539    3          CASE( %MOUNT );

      654    24540    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24540 20 000600   000000 234000 xsym               SZN     FMSEC
        20 000601   000611 604000 20                 TMI     s:24542
        20 000602   000000 470400 xsym               LDP0    B$JIT$
        20 000603   000020 236100                    LDQ     16,,PR0
        20 000604   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000605   000611 600000 20                 TZE     s:24542

      655    24541    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24541 20 000606   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000607   020012 713400                    CLIMB   8202
        20 000610   400000 401760                    pmme    nvectors=1

      656    24542    3            BREAK_TASK = 'Mounting!';

  24542 20 000611   040000 100400                    MLR     fill='040'O
        20 000612   000121 000011 19                 ADSC9   LEGAL_CHAR+35            cn=0,n=9
        20 000613   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      657    24543    3            CALL FLB_TAPE_NODES;

  24543 20 000614   002402 701000 20                 TSX1    FLB_TAPE_NODES
        20 000615   000000 011000                    NOP     0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:168  
        20 000616   001445 710000 20                 TRA     s:24707

      658    24544
      659    24545    3          CASE( %SCAN );

      660    24546    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24546 20 000617   000000 234000 xsym               SZN     FMSEC
        20 000620   000630 604000 20                 TMI     s:24548
        20 000621   000000 470400 xsym               LDP0    B$JIT$
        20 000622   000020 236100                    LDQ     16,,PR0
        20 000623   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000624   000630 600000 20                 TZE     s:24548

      661    24547    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24547 20 000625   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000626   020012 713400                    CLIMB   8202
        20 000627   400000 401760                    pmme    nvectors=1

      662    24548    3            BREAK_TASK = 'Scanning!';

  24548 20 000630   040000 100400                    MLR     fill='040'O
        20 000631   000124 000011 19                 ADSC9   LEGAL_CHAR+38            cn=0,n=9
        20 000632   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      663    24549    3            CALL FLB_VALIDATE_NODES;

  24549 20 000633   004004 701000 20                 TSX1    FLB_VALIDATE_NODES
        20 000634   000000 011000                    NOP     0
        20 000635   001445 710000 20                 TRA     s:24707

      664    24550
      665    24551    3          CASE( %VALIDATE );

      666    24552    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:169  
  24552 20 000636   000000 234000 xsym               SZN     FMSEC
        20 000637   000647 604000 20                 TMI     s:24554
        20 000640   000000 470400 xsym               LDP0    B$JIT$
        20 000641   000020 236100                    LDQ     16,,PR0
        20 000642   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000643   000647 600000 20                 TZE     s:24554

      667    24553    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24553 20 000644   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000645   020012 713400                    CLIMB   8202
        20 000646   400000 401760                    pmme    nvectors=1

      668    24554    3            BREAK_TASK = 'Validating!';

  24554 20 000647   040000 100400                    MLR     fill='040'O
        20 000650   000127 000013 19                 ADSC9   LEGAL_CHAR+41            cn=0,n=11
        20 000651   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      669    24555    3            CALL FLB_VALIDATE_NODES;

  24555 20 000652   004004 701000 20                 TSX1    FLB_VALIDATE_NODES
        20 000653   000000 011000                    NOP     0
        20 000654   001445 710000 20                 TRA     s:24707

      670    24556
      671    24557    3          CASE( %SAVE );

      672    24558    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24558 20 000655   000000 234000 xsym               SZN     FMSEC
        20 000656   000666 604000 20                 TMI     s:24560
        20 000657   000000 470400 xsym               LDP0    B$JIT$
        20 000660   000020 236100                    LDQ     16,,PR0
        20 000661   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000662   000666 600000 20                 TZE     s:24560

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:170  
      673    24559    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24559 20 000663   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000664   020012 713400                    CLIMB   8202
        20 000665   400000 401760                    pmme    nvectors=1

      674    24560    3            BREAK_TASK = 'Saving!';

  24560 20 000666   040000 100400                    MLR     fill='040'O
        20 000667   000132 000007 19                 ADSC9   LEGAL_CHAR+44            cn=0,n=7
        20 000670   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      675    24561    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;

  24561 20 000671   000217 470400 2                  LDP0    M$CATALOG$
        20 000672   000031 236100                    LDQ     25,,PR0
        20 000673   000026 736000                    QLS     22
        20 000674   400000 376003                    ANQ     -131072,DU
        20 000675   000000 756000 xsym               STQ     CATALOG_ON

      676    24562    3            CALL FLB_SAVE_NODES;

  24562 20 000676   004200 701000 20                 TSX1    FLB_SAVE_NODES
        20 000677   000000 011000                    NOP     0
        20 000700   001445 710000 20                 TRA     s:24707

      677    24563
      678    24564    3          CASE( %DUAL, %DUAL_INCREMENTAL );

      679    24565    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24565 20 000701   000000 234000 xsym               SZN     FMSEC
        20 000702   000712 604000 20                 TMI     s:24567
        20 000703   000000 470400 xsym               LDP0    B$JIT$
        20 000704   000020 236100                    LDQ     16,,PR0
        20 000705   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000706   000712 600000 20                 TZE     s:24567
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:171  

      680    24566    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24566 20 000707   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000710   020012 713400                    CLIMB   8202
        20 000711   400000 401760                    pmme    nvectors=1

      681    24567    3            BREAK_TASK = 'Dualing!';

  24567 20 000712   040000 100400                    MLR     fill='040'O
        20 000713   000134 000010 19                 ADSC9   LEGAL_CHAR+46            cn=0,n=8
        20 000714   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      682    24568    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;

  24568 20 000715   000217 470400 2                  LDP0    M$CATALOG$
        20 000716   000031 236100                    LDQ     25,,PR0
        20 000717   000026 736000                    QLS     22
        20 000720   400000 376003                    ANQ     -131072,DU
        20 000721   000000 756000 xsym               STQ     CATALOG_ON

      683    24569    3            CALL FLB_DUAL_NODES;

  24569 20 000722   004052 701000 20                 TSX1    FLB_DUAL_NODES
        20 000723   000000 011000                    NOP     0
        20 000724   001445 710000 20                 TRA     s:24707

      684    24570
      685    24571    3          CASE( %BACKUP );

      686    24572    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24572 20 000725   000000 234000 xsym               SZN     FMSEC
        20 000726   000736 604000 20                 TMI     s:24574
        20 000727   000000 470400 xsym               LDP0    B$JIT$
        20 000730   000020 236100                    LDQ     16,,PR0
        20 000731   000062 376000 19                 ANQ     LEGAL_CHAR+4
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:172  
        20 000732   000736 600000 20                 TZE     s:24574

      687    24573    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24573 20 000733   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000734   020012 713400                    CLIMB   8202
        20 000735   400000 401760                    pmme    nvectors=1

      688    24574    3            BREAK_TASK = 'Backing up!';

  24574 20 000736   040000 100400                    MLR     fill='040'O
        20 000737   000136 000013 19                 ADSC9   LEGAL_CHAR+48            cn=0,n=11
        20 000740   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      689    24575    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;

  24575 20 000741   000217 470400 2                  LDP0    M$CATALOG$
        20 000742   000031 236100                    LDQ     25,,PR0
        20 000743   000026 736000                    QLS     22
        20 000744   400000 376003                    ANQ     -131072,DU
        20 000745   000000 756000 xsym               STQ     CATALOG_ON

      690    24576    3            CALL FLB_SAVE_NODES;

  24576 20 000746   004200 701000 20                 TSX1    FLB_SAVE_NODES
        20 000747   000000 011000                    NOP     0
        20 000750   001445 710000 20                 TRA     s:24707

      691    24577
      692    24578    3          CASE( %ARCHIVE_CMD );

      693    24579    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24579 20 000751   000000 234000 xsym               SZN     FMSEC
        20 000752   000762 604000 20                 TMI     s:24581
        20 000753   000000 470400 xsym               LDP0    B$JIT$
        20 000754   000020 236100                    LDQ     16,,PR0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:173  
        20 000755   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 000756   000762 600000 20                 TZE     s:24581

      694    24580    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24580 20 000757   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 000760   020012 713400                    CLIMB   8202
        20 000761   400000 401760                    pmme    nvectors=1

      695    24581    3            BREAK_TASK = 'Archiving!';

  24581 20 000762   040000 100400                    MLR     fill='040'O
        20 000763   000141 000012 19                 ADSC9   LEGAL_CHAR+51            cn=0,n=10
        20 000764   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      696    24582    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;

  24582 20 000765   000217 470400 2                  LDP0    M$CATALOG$
        20 000766   000031 236100                    LDQ     25,,PR0
        20 000767   000026 736000                    QLS     22
        20 000770   400000 376003                    ANQ     -131072,DU
        20 000771   000000 756000 xsym               STQ     CATALOG_ON

      697    24583    3            CALL FLB_SAVE_NODES;

  24583 20 000772   004200 701000 20                 TSX1    FLB_SAVE_NODES
        20 000773   000000 011000                    NOP     0
        20 000774   001445 710000 20                 TRA     s:24707

      698    24584
      699    24585    3          CASE( %PURGE );

      700    24586    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24586 20 000775   000000 234000 xsym               SZN     FMSEC
        20 000776   001006 604000 20                 TMI     s:24588
        20 000777   000000 470400 xsym               LDP0    B$JIT$
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:174  
        20 001000   000020 236100                    LDQ     16,,PR0
        20 001001   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001002   001006 600000 20                 TZE     s:24588

      701    24587    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24587 20 001003   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001004   020012 713400                    CLIMB   8202
        20 001005   400000 401760                    pmme    nvectors=1

      702    24588    3            BREAK_TASK = 'Purging!';

  24588 20 001006   040000 100400                    MLR     fill='040'O
        20 001007   000144 000010 19                 ADSC9   LEGAL_CHAR+54            cn=0,n=8
        20 001010   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      703    24589    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;

  24589 20 001011   000217 470400 2                  LDP0    M$CATALOG$
        20 001012   000031 236100                    LDQ     25,,PR0
        20 001013   000026 736000                    QLS     22
        20 001014   400000 376003                    ANQ     -131072,DU
        20 001015   000000 756000 xsym               STQ     CATALOG_ON

      704    24590    3            CALL FLB_SAVE_NODES;

  24590 20 001016   004200 701000 20                 TSX1    FLB_SAVE_NODES
        20 001017   000000 011000                    NOP     0
        20 001020   001445 710000 20                 TRA     s:24707

      705    24591
      706    24592    3          CASE( %REQUALIFY, %REQUALIFY_ARCHIVE, %REQUALIFY_BACKUP );

      707    24593    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24593 20 001021   000000 234000 xsym               SZN     FMSEC
        20 001022   001032 604000 20                 TMI     s:24595
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:175  
        20 001023   000000 470400 xsym               LDP0    B$JIT$
        20 001024   000020 236100                    LDQ     16,,PR0
        20 001025   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001026   001032 600000 20                 TZE     s:24595

      708    24594    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24594 20 001027   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001030   020012 713400                    CLIMB   8202
        20 001031   400000 401760                    pmme    nvectors=1

      709    24595    3            BREAK_TASK = 'Requalifying!';

  24595 20 001032   040000 100400                    MLR     fill='040'O
        20 001033   000146 000015 19                 ADSC9   LEGAL_CHAR+56            cn=0,n=13
        20 001034   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      710    24596    3            CALL FLB_REQUALIFY_NODES;

  24596 20 001035   003642 701000 20                 TSX1    FLB_REQUALIFY_NODES
        20 001036   000000 011000                    NOP     0
        20 001037   001445 710000 20                 TRA     s:24707

      711    24597
      712    24598    3          CASE( %STOW_ACTIVE, %STOW_INACTIVE );

      713    24599    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24599 20 001040   000000 234000 xsym               SZN     FMSEC
        20 001041   001051 604000 20                 TMI     s:24601
        20 001042   000000 470400 xsym               LDP0    B$JIT$
        20 001043   000020 236100                    LDQ     16,,PR0
        20 001044   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001045   001051 600000 20                 TZE     s:24601

      714    24600    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:176  
  24600 20 001046   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001047   020012 713400                    CLIMB   8202
        20 001050   400000 401760                    pmme    nvectors=1

      715    24601    3            BREAK_TASK = 'Stowing!';

  24601 20 001051   040000 100400                    MLR     fill='040'O
        20 001052   000152 000010 19                 ADSC9   LEGAL_CHAR+60            cn=0,n=8
        20 001053   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      716    24602    3            CALL FLB_STOW_FETCH_NODES;

  24602 20 001054   003676 701000 20                 TSX1    FLB_STOW_FETCH_NODES
        20 001055   000000 011000                    NOP     0
        20 001056   001445 710000 20                 TRA     s:24707

      717    24603
      718    24604    3          CASE( %FETCH );

      719    24605    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24605 20 001057   000000 234000 xsym               SZN     FMSEC
        20 001060   001070 604000 20                 TMI     s:24607
        20 001061   000000 470400 xsym               LDP0    B$JIT$
        20 001062   000020 236100                    LDQ     16,,PR0
        20 001063   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001064   001070 600000 20                 TZE     s:24607

      720    24606    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24606 20 001065   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001066   020012 713400                    CLIMB   8202
        20 001067   400000 401760                    pmme    nvectors=1

      721    24607    3            BREAK_TASK = 'Fetching!';

  24607 20 001070   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:177  
        20 001071   000154 000011 19                 ADSC9   LEGAL_CHAR+62            cn=0,n=9
        20 001072   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      722    24608    3            CALL FLB_STOW_FETCH_NODES;

  24608 20 001073   003676 701000 20                 TSX1    FLB_STOW_FETCH_NODES
        20 001074   000000 011000                    NOP     0
        20 001075   001445 710000 20                 TRA     s:24707

      723    24609
      724    24610    3          CASE( %UNFETCH );

      725    24611    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24611 20 001076   000000 234000 xsym               SZN     FMSEC
        20 001077   001107 604000 20                 TMI     s:24613
        20 001100   000000 470400 xsym               LDP0    B$JIT$
        20 001101   000020 236100                    LDQ     16,,PR0
        20 001102   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001103   001107 600000 20                 TZE     s:24613

      726    24612    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24612 20 001104   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001105   020012 713400                    CLIMB   8202
        20 001106   400000 401760                    pmme    nvectors=1

      727    24613    3            BREAK_TASK = 'Unfetching!';

  24613 20 001107   040000 100400                    MLR     fill='040'O
        20 001110   000157 000013 19                 ADSC9   LEGAL_CHAR+65            cn=0,n=11
        20 001111   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      728    24614    3            CALL FLB_STOW_FETCH_NODES;

  24614 20 001112   003676 701000 20                 TSX1    FLB_STOW_FETCH_NODES
        20 001113   000000 011000                    NOP     0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:178  
        20 001114   001445 710000 20                 TRA     s:24707

      729    24615
      730    24616    3          CASE( %UNSTOW );

      731    24617    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24617 20 001115   000000 234000 xsym               SZN     FMSEC
        20 001116   001126 604000 20                 TMI     s:24619
        20 001117   000000 470400 xsym               LDP0    B$JIT$
        20 001120   000020 236100                    LDQ     16,,PR0
        20 001121   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001122   001126 600000 20                 TZE     s:24619

      732    24618    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24618 20 001123   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001124   020012 713400                    CLIMB   8202
        20 001125   400000 401760                    pmme    nvectors=1

      733    24619    3            CALL FLB_STOW_FETCH_NODES;

  24619 20 001126   003676 701000 20                 TSX1    FLB_STOW_FETCH_NODES
        20 001127   000000 011000                    NOP     0
        20 001130   001445 710000 20                 TRA     s:24707

      734    24620
      735    24621    3          CASE( %UNARCHIVE );

      736    24622    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24622 20 001131   000000 234000 xsym               SZN     FMSEC
        20 001132   001142 604000 20                 TMI     s:24624
        20 001133   000000 470400 xsym               LDP0    B$JIT$
        20 001134   000020 236100                    LDQ     16,,PR0
        20 001135   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001136   001142 600000 20                 TZE     s:24624
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:179  

      737    24623    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24623 20 001137   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001140   020012 713400                    CLIMB   8202
        20 001141   400000 401760                    pmme    nvectors=1

      738    24624    3            BREAK_TASK = 'Unarchiving!';

  24624 20 001142   040000 100400                    MLR     fill='040'O
        20 001143   000162 000014 19                 ADSC9   LEGAL_CHAR+68            cn=0,n=12
        20 001144   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      739    24625    3            CALL FLB_STOW_FETCH_NODES;

  24625 20 001145   003676 701000 20                 TSX1    FLB_STOW_FETCH_NODES
        20 001146   000000 011000                    NOP     0
        20 001147   001445 710000 20                 TRA     s:24707

      740    24626
      741    24627    3          CASE( %READ );

      742    24628    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24628 20 001150   000000 234000 xsym               SZN     FMSEC
        20 001151   001161 604000 20                 TMI     s:24630
        20 001152   000000 470400 xsym               LDP0    B$JIT$
        20 001153   000020 236100                    LDQ     16,,PR0
        20 001154   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001155   001161 600000 20                 TZE     s:24630

      743    24629    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24629 20 001156   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001157   020012 713400                    CLIMB   8202
        20 001160   400000 401760                    pmme    nvectors=1

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:180  
      744    24630    3            BREAK_TASK = 'Reading!';

  24630 20 001161   040000 100400                    MLR     fill='040'O
        20 001162   000165 000010 19                 ADSC9   LEGAL_CHAR+71            cn=0,n=8
        20 001163   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      745    24631    3            CALL FLB_READ_NODES;

  24631 20 001164   002266 701000 20                 TSX1    FLB_READ_NODES
        20 001165   000000 011000                    NOP     0
        20 001166   001445 710000 20                 TRA     s:24707

      746    24632
      747    24633    3          CASE( %OUTPUT );

      748    24634    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24634 20 001167   000000 234000 xsym               SZN     FMSEC
        20 001170   001200 604000 20                 TMI     s:24636
        20 001171   000000 470400 xsym               LDP0    B$JIT$
        20 001172   000020 236100                    LDQ     16,,PR0
        20 001173   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001174   001200 600000 20                 TZE     s:24636

      749    24635    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24635 20 001175   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001176   020012 713400                    CLIMB   8202
        20 001177   400000 401760                    pmme    nvectors=1

      750    24636    3            CALL FLB_OUTPUT_NODES;

  24636 20 001200   001630 701000 20                 TSX1    FLB_OUTPUT_NODES
        20 001201   000000 011000                    NOP     0
        20 001202   001445 710000 20                 TRA     s:24707

      751    24637
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:181  
      752    24638    3          CASE( %CATALOG );

      753    24639    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24639 20 001203   000000 234000 xsym               SZN     FMSEC
        20 001204   001214 604000 20                 TMI     s:24641
        20 001205   000000 470400 xsym               LDP0    B$JIT$
        20 001206   000020 236100                    LDQ     16,,PR0
        20 001207   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001210   001214 600000 20                 TZE     s:24641

      754    24640    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24640 20 001211   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001212   020012 713400                    CLIMB   8202
        20 001213   400000 401760                    pmme    nvectors=1

      755    24641    3            CALL FLB_OUTPUT_NODES;

  24641 20 001214   001630 701000 20                 TSX1    FLB_OUTPUT_NODES
        20 001215   000000 011000                    NOP     0
        20 001216   001445 710000 20                 TRA     s:24707

      756    24642
      757    24643    3          CASE( %WHERE );

      758    24644    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24644 20 001217   000000 234000 xsym               SZN     FMSEC
        20 001220   001230 604000 20                 TMI     s:24646
        20 001221   000000 470400 xsym               LDP0    B$JIT$
        20 001222   000020 236100                    LDQ     16,,PR0
        20 001223   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001224   001230 600000 20                 TZE     s:24646

      759    24645    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:182  
  24645 20 001225   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001226   020012 713400                    CLIMB   8202
        20 001227   400000 401760                    pmme    nvectors=1

      760    24646    3            BREAK_TASK = 'Finding out where!';

  24646 20 001230   040000 100400                    MLR     fill='040'O
        20 001231   000167 000022 19                 ADSC9   LEGAL_CHAR+73            cn=0,n=18
        20 001232   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      761    24647    3            CALL FLB_WHERE_NODES;

  24647 20 001233   002247 701000 20                 TSX1    FLB_WHERE_NODES
        20 001234   000000 011000                    NOP     0
        20 001235   001445 710000 20                 TRA     s:24707

      762    24648
      763    24649    3          CASE( %ESTABLISH );

      764    24650    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24650 20 001236   000000 234000 xsym               SZN     FMSEC
        20 001237   001247 604000 20                 TMI     s:24652
        20 001240   000000 470400 xsym               LDP0    B$JIT$
        20 001241   000020 236100                    LDQ     16,,PR0
        20 001242   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001243   001247 600000 20                 TZE     s:24652

      765    24651    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24651 20 001244   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001245   020012 713400                    CLIMB   8202
        20 001246   400000 401760                    pmme    nvectors=1

      766    24652    3            BREAK_TASK = 'Establishing!';

  24652 20 001247   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:183  
        20 001250   000174 000015 19                 ADSC9   LEGAL_CHAR+78            cn=0,n=13
        20 001251   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      767    24653    3            CALL FLB_ESTMOD_NODES;

  24653 20 001252   004343 701000 20                 TSX1    FLB_ESTMOD_NODES
        20 001253   000000 011000                    NOP     0
        20 001254   001445 710000 20                 TRA     s:24707

      768    24654
      769    24655    3          CASE( %MODIFY );

      770    24656    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24656 20 001255   000000 234000 xsym               SZN     FMSEC
        20 001256   001266 604000 20                 TMI     s:24658
        20 001257   000000 470400 xsym               LDP0    B$JIT$
        20 001260   000020 236100                    LDQ     16,,PR0
        20 001261   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001262   001266 600000 20                 TZE     s:24658

      771    24657    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24657 20 001263   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001264   020012 713400                    CLIMB   8202
        20 001265   400000 401760                    pmme    nvectors=1

      772    24658    3            BREAK_TASK = 'Modifying!';

  24658 20 001266   040000 100400                    MLR     fill='040'O
        20 001267   000200 000012 19                 ADSC9   LEGAL_CHAR+82            cn=0,n=10
        20 001270   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      773    24659    3            CALL FLB_ESTMOD_NODES;

  24659 20 001271   004343 701000 20                 TSX1    FLB_ESTMOD_NODES
        20 001272   000000 011000                    NOP     0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:184  
        20 001273   001445 710000 20                 TRA     s:24707

      774    24660
      775    24661    3          CASE( %ADD );

      776    24662    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24662 20 001274   000000 234000 xsym               SZN     FMSEC
        20 001275   001305 604000 20                 TMI     s:24664
        20 001276   000000 470400 xsym               LDP0    B$JIT$
        20 001277   000020 236100                    LDQ     16,,PR0
        20 001300   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001301   001305 600000 20                 TZE     s:24664

      777    24663    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24663 20 001302   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001303   020012 713400                    CLIMB   8202
        20 001304   400000 401760                    pmme    nvectors=1

      778    24664    3            BREAK_TASK = 'Adding!';

  24664 20 001305   040000 100400                    MLR     fill='040'O
        20 001306   000203 000007 19                 ADSC9   LEGAL_CHAR+85            cn=0,n=7
        20 001307   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      779    24665    3            CALL FLB_ADDREM_NODES;

  24665 20 001310   004027 701000 20                 TSX1    FLB_ADDREM_NODES
        20 001311   000000 011000                    NOP     0
        20 001312   001445 710000 20                 TRA     s:24707

      780    24666
      781    24667    3          CASE( %REMOVE_ARC );

      782    24668    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:185  
  24668 20 001313   000000 234000 xsym               SZN     FMSEC
        20 001314   001324 604000 20                 TMI     s:24670
        20 001315   000000 470400 xsym               LDP0    B$JIT$
        20 001316   000020 236100                    LDQ     16,,PR0
        20 001317   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001320   001324 600000 20                 TZE     s:24670

      783    24669    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24669 20 001321   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001322   020012 713400                    CLIMB   8202
        20 001323   400000 401760                    pmme    nvectors=1

      784    24670    3            BREAK_TASK = 'Removing!';

  24670 20 001324   040000 100400                    MLR     fill='040'O
        20 001325   000116 000011 19                 ADSC9   LEGAL_CHAR+32            cn=0,n=9
        20 001326   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      785    24671    3            COMMAND = %REMOVE;

  24671 20 001327   000015 235007                    LDA     13,DL
        20 001330   000167 755000 2                  STA     COMMAND

      786    24672    3            CALL FLB_ADDREM_NODES;

  24672 20 001331   004027 701000 20                 TSX1    FLB_ADDREM_NODES
        20 001332   000000 011000                    NOP     0
        20 001333   001445 710000 20                 TRA     s:24707

      787    24673
      788    24674    3          CASE( %OPEN_UPDATE, %OPEN_CREATE, %OPEN_EXTEND, %OPEN_INPUT );

      789    24675    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24675 20 001334   000000 234000 xsym               SZN     FMSEC
        20 001335   001345 604000 20                 TMI     s:24677
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:186  
        20 001336   000000 470400 xsym               LDP0    B$JIT$
        20 001337   000020 236100                    LDQ     16,,PR0
        20 001340   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001341   001345 600000 20                 TZE     s:24677

      790    24676    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24676 20 001342   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001343   020012 713400                    CLIMB   8202
        20 001344   400000 401760                    pmme    nvectors=1

      791    24677    3            BREAK_TASK = 'Opening!';

  24677 20 001345   040000 100400                    MLR     fill='040'O
        20 001346   000205 000010 19                 ADSC9   LEGAL_CHAR+87            cn=0,n=8
        20 001347   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

      792    24678    3            CATALOG_ON = M$CATALOG$->F$DCB.FCD#;

  24678 20 001350   000217 470400 2                  LDP0    M$CATALOG$
        20 001351   000031 236100                    LDQ     25,,PR0
        20 001352   000026 736000                    QLS     22
        20 001353   400000 376003                    ANQ     -131072,DU
        20 001354   000000 756000 xsym               STQ     CATALOG_ON

      793    24679    3            CALL FLB_OPEN_NODES;

  24679 20 001355   004366 701000 20                 TSX1    FLB_OPEN_NODES
        20 001356   000000 011000                    NOP     0
        20 001357   001445 710000 20                 TRA     s:24707

      794    24680
      795    24681    3          CASE( %STATUS );

      796    24682    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24682 20 001360   000000 234000 xsym               SZN     FMSEC
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:187  
        20 001361   001371 604000 20                 TMI     s:24684
        20 001362   000000 470400 xsym               LDP0    B$JIT$
        20 001363   000020 236100                    LDQ     16,,PR0
        20 001364   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001365   001371 600000 20                 TZE     s:24684

      797    24683    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24683 20 001366   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001367   020012 713400                    CLIMB   8202
        20 001370   400000 401760                    pmme    nvectors=1

      798    24684    3            STAF = '0'B;

  24684 20 001371   000000 450000 xsym               STZ     STAF

      799    24685    3            CALL FLB_STATUS_NODES;

  24685 20 001372   005351 701000 20                 TSX1    FLB_STATUS_NODES
        20 001373   000000 011000                    NOP     0
        20 001374   001445 710000 20                 TRA     s:24707

      800    24686
      801    24687    3          CASE( %STATUS_FULL );

      802    24688    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24688 20 001375   000000 234000 xsym               SZN     FMSEC
        20 001376   001406 604000 20                 TMI     s:24690
        20 001377   000000 470400 xsym               LDP0    B$JIT$
        20 001400   000020 236100                    LDQ     16,,PR0
        20 001401   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001402   001406 600000 20                 TZE     s:24690

      803    24689    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24689 20 001403   000734 630400 2                  EPPR0   SWITCH_FMSEC
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:188  
        20 001404   020012 713400                    CLIMB   8202
        20 001405   400000 401760                    pmme    nvectors=1

      804    24690    3            STAF = '1'B;

  24690 20 001406   400000 236003                    LDQ     -131072,DU
        20 001407   000000 756000 xsym               STQ     STAF

      805    24691    3            CALL FLB_STATUS_NODES;

  24691 20 001410   005351 701000 20                 TSX1    FLB_STATUS_NODES
        20 001411   000000 011000                    NOP     0
        20 001412   001445 710000 20                 TRA     s:24707

      806    24692
      807    24693    3          CASE( %REBUILD );

      808    24694    3            IF NOT FMSEC AND B$JIT.PPRIV & %PPR_EFT#

  24694 20 001413   000000 234000 xsym               SZN     FMSEC
        20 001414   001424 604000 20                 TMI     s:24696
        20 001415   000000 470400 xsym               LDP0    B$JIT$
        20 001416   000020 236100                    LDQ     16,,PR0
        20 001417   000062 376000 19                 ANQ     LEGAL_CHAR+4
        20 001420   001424 600000 20                 TZE     s:24696

      809    24695    3             THEN CALL M$SPRIV( SWITCH_FMSEC ); /* FMSEC on only if EFT proc priv */

  24695 20 001421   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 001422   020012 713400                    CLIMB   8202
        20 001423   400000 401760                    pmme    nvectors=1

      810    24696    3            BREAK_TASK = 'Rebuilding!';

  24696 20 001424   040000 100400                    MLR     fill='040'O
        20 001425   000207 000013 19                 ADSC9   LEGAL_CHAR+89            cn=0,n=11
        20 001426   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:189  

      811    24697    3            CALL FLB_REBUILD_NODES;

  24697 20 001427   005525 701000 20                 TSX1    FLB_REBUILD_NODES
        20 001430   000000 011000                    NOP     0
        20 001431   001445 710000 20                 TRA     s:24707

      812    24698
      813    24699    3          CASE( %CLOSE );

      814    24700    3            COMMAND_ERROR = '1'B;

  24700 20 001432   400000 236003                    LDQ     -131072,DU
        20 001433   000000 756000 xsym               STQ     COMMAND_ERROR

      815    24701    3            CALL FLI$RPT_ERR( E_CLOSE_INVALID );

  24701 20 001434   000020 630400 21                 EPPR0   16
        20 001435   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 001436   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 001437   000000 011000                    NOP     0

      816    24702    3            IF FPT_EXIT.V.STEPCC# < %MINOR_ERROR

  24702 20 001440   000004 236000 xsym               LDQ     FPT_EXIT+4
        20 001441   777000 316003                    CANQ    -512,DU
        20 001442   001445 601000 20                 TNZ     s:24707

      817    24703    3             THEN FPT_EXIT.V.STEPCC# = %MINOR_ERROR;

  24703 20 001443   001000 236003                    LDQ     512,DU
        20 001444   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

      818    24704
      819    24705    3          END;

      820    24706
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:190  
      821    24707    2         CALL M$DEVICE( ERASE_HEADER )

  24707 20 001445   000612 630400 2                  EPPR0   ERASE_HEADER
        20 001446   450006 713400                    CLIMB   alt,+20486
        20 001447   401000 401760                    pmme    nvectors=3
        20 001450   001452 702000 20                 TSX2    s:24709
        20 001451   001455 710000 20                 TRA     s:24711

      822    24708    3          WHENALTRETURN DO;

      823    24709    3            CALL FLI$RPT_ERR;

  24709 20 001452   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 001453   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 001454   000000 011000                    NOP     0

      824    24710    3            END;

      825    24711    2         CALL FLI$ERROR_SUMMARY;

  24711 20 001455   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 001456   000000 701000 xent               TSX1    FLI$ERROR_SUMMARY
        20 001457   000000 011000                    NOP     0

      826    24712
      827    24713    3         DO WHILE('0'B);

  24713 20 001460   001546 710000 20                 TRA     s:24737

  24707 20 001461                       TELL_ERROR   null
      828    24714    3   TELL_ERROR: ;
      829    24715    3            CALL XUR$ECHOIF( DCBNUM(M$LO) );

  24715 20 001461   000000 236007 xsym               LDQ     M$LO,DL
        20 001462   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 001463   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 001464   200043 450500                    STP0    @MAX_NX+2,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:191  
        20 001465   200043 630500                    EPPR0   @MAX_NX+2,,AUTO
        20 001466   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 001467   000000 701000 xent               TSX1    XUR$ECHOIF
        20 001470   000000 011000                    NOP     0

      830    24716    3            IF NOT ERR.MON

  24716 20 001471   000226 236000 2                  LDQ     NODE$
        20 001472   400000 316007                    CANQ    -131072,DL
        20 001473   001516 601000 20                 TNZ     s:24723

      831    24717    4             THEN DO;

      832    24718    4               IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR

  24718 20 001474   000004 236000 xsym               LDQ     FPT_EXIT+4
        20 001475   777000 376003                    ANQ     -512,DU
        20 001476   002000 116003                    CMPQ    1024,DU
        20 001477   001502 603000 20                 TRC     s:24720

      833    24719    4                THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR; /* Syntax error        */

  24719 20 001500   002000 236003                    LDQ     1024,DU
        20 001501   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

      834    24720    4               IF EFT_CMD_PCB.HI_CHAR > 0

  24720 20 001502   000267 235000 2                  LDA     EFT_CMD_PCB+10
        20 001503   001516 600000 20                 TZE     s:24723

      835    24721    4                THEN CALL XUR$ERRPTR( ,DCBNUM(M$DO) );

  24721 20 001504   000000 236007 xsym               LDQ     M$DO,DL
        20 001505   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 001506   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 001507   200045 450500                    STP0    @MAX_NX+4,,AUTO
        20 001510   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:192  
        20 001511   200044 756100                    STQ     @MAX_NX+3,,AUTO
        20 001512   200044 630500                    EPPR0   @MAX_NX+3,,AUTO
        20 001513   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 001514   000000 701000 xent               TSX1    XUR$ERRPTR
        20 001515   000000 011000                    NOP     0

      836    24722    4               END;

      837    24723    3            IF ERR.ERR# ~= %E$EOF

  24723 20 001516   000226 236000 2                  LDQ     NODE$
        20 001517   377770 376007                    ANQ     131064,DL
        20 001520   000060 116007                    CMPQ    48,DL
        20 001521   001531 600000 20                 TZE     s:24729

      838    24724    4             THEN DO;

      839    24725    4               COMMAND_ERROR = '1'B;

  24725 20 001522   400000 236003                    LDQ     -131072,DU
        20 001523   000000 756000 xsym               STQ     COMMAND_ERROR

      840    24726    4               CALL XUR$ERRMSG( ERR );

  24726 20 001524   000011 630400 21                 EPPR0   9
        20 001525   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 001526   000000 701000 xent               TSX1    XUR$ERRMSG
        20 001527   000000 011000                    NOP     0

      841    24727    4               END;

  24727 20 001530   001546 710000 20                 TRA     s:24737

      842    24728    4             ELSE DO;

      843    24729    4               IF NOT M$READ_FILE$->F$DCB.FCD#

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:193  
  24729 20 001531   000214 470400 2                  LDP0    M$READ_FILE$
        20 001532   000031 236100                    LDQ     25,,PR0
        20 001533   020000 316007                    CANQ    8192,DL
        20 001534   001544 601000 20                 TNZ     s:24734

      844    24730    5                THEN DO;              /* Must be EOF on primary command stream   */

      845    24731    5                  CALL XUR$ERRMSG( ERR );

  24731 20 001535   000011 630400 21                 EPPR0   9
        20 001536   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 001537   000000 701000 xent               TSX1    XUR$ERRMSG
        20 001540   000000 011000                    NOP     0

      846    24732    5                  CALL M$EXIT( FPT_EXIT );

  24732 20 001541   000000 630400 xsym               EPPR0   FPT_EXIT
        20 001542   000001 713400                    CLIMB   exit
        20 001543   400400 401760                    pmme    nvectors=2

      847    24733    5                  END;

      848    24734    4               BREAK_COUNT = 1;            /* Make > 0 to fool code below        */

  24734 20 001544   000001 235007                    LDA     1,DL
        20 001545   000154 755000 2                  STA     BREAK_COUNT

      849    24735    4               END;

      850    24736    3            END;

      851    24737    2         IF COMMAND_ERROR AND B$JIT.MODE ~= %M_INT#

  24737 20 001546   000000 234000 xsym               SZN     COMMAND_ERROR
        20 001547   001563 605000 20                 TPL     s:24742
        20 001550   000000 470400 xsym               LDP0    B$JIT$
        20 001551   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:194  
        20 001552   740000 376003                    ANQ     -16384,DU
        20 001553   140000 116003                    CMPQ    49152,DU
        20 001554   001563 600000 20                 TZE     s:24742

      852    24738    3          THEN DO;

      853    24739    3            CALL FLI$RPT_ERR( E_TRY_AGAIN );

  24739 20 001555   000021 630400 21                 EPPR0   17
        20 001556   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 001557   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 001560   000000 011000                    NOP     0

      854    24740    3            CALL M$XXX;

  24740 20 001561   000003 713400                    CLIMB   3
        20 001562   000000 401760                    pmme    nvectors=0

      855    24741    3            END;

      856    24742    2         IF COMMAND_ERROR OR BREAK_COUNT > 0

  24742 20 001563   000000 234000 xsym               SZN     COMMAND_ERROR
        20 001564   001567 604000 20                 TMI     s:24744
        20 001565   000154 235000 2                  LDA     BREAK_COUNT
        20 001566   001610 604400 20                 TMOZ    s:24750

      857    24743    3          THEN DO;

      858    24744    3            IF M$READ_FILE$->F$DCB.FCD#

  24744 20 001567   000214 470400 2                  LDP0    M$READ_FILE$
        20 001570   000031 236100                    LDQ     25,,PR0
        20 001571   020000 316007                    CANQ    8192,DL
        20 001572   001600 600000 20                 TZE     s:24748

      859    24745    3             THEN CALL M$CLOSE( CLOSE_READ_FILE )
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:195  

  24745 20 001573   001166 630400 2                  EPPR0   CLOSE_READ_FILE
        20 001574   450001 713400                    CLIMB   alt,close
        20 001575   406000 401760                    pmme    nvectors=13
        20 001576   001600 702000 20                 TSX2    s:24748
        20 001577   001600 710000 20                 TRA     s:24748

      860    24746    4                WHENALTRETURN DO;

      861    24747    4                  END;

      862    24748    3            CALL XUR$SETDCBS( DCBNUM(M$SI), );

  24748 20 001600   000000 236007 xsym               LDQ     M$SI,DL
        20 001601   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 001602   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 001603   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 001604   200043 630500                    EPPR0   @MAX_NX+2,,AUTO
        20 001605   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 001606   000000 701000 xent               TSX1    XUR$SETDCBS
        20 001607   000000 011000                    NOP     0

      863    24749    3            END;

      864    24750    2         IF FIRST_TIME

  24750 20 001610   000176 234000 2                  SZN     FIRST_TIME
        20 001611   000150 605000 20                 TPL     s:24430

      865    24751    2          THEN CALL M$EXIT( FPT_EXIT );

  24751 20 001612   000000 630400 xsym               EPPR0   FPT_EXIT
        20 001613   000001 713400                    CLIMB   exit
        20 001614   400400 401760                    pmme    nvectors=2

      866    24752    2   END;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:196  
  24752 20 001615   000150 710000 20                 TRA     s:24430

  24748 20 001616                       ERROR_OUT    null
      867    24753
      868    24754    1   ERROR_OUT: ;
      869    24755    1      CALL FLI$RPT_ERR;

  24755 20 001616   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 001617   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 001620   000000 011000                    NOP     0

      870    24756    1      CALL FLI$RPT_ERR( E_TRY_AGAIN );

  24756 20 001621   000021 630400 21                 EPPR0   17
        20 001622   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 001623   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 001624   000000 011000                    NOP     0

      871    24757    1      CALL M$XXX;

  24757 20 001625   000003 713400                    CLIMB   3
        20 001626   000000 401760                    pmme    nvectors=0
        20 001627   015147 710000 20                 TRA     s:28227

      872    24758
      873    24759        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:197  
      874    24760    1   FLB_OUTPUT_NODES: PROC;

  24760 20 001630   200004 741300       FLB_OUTPUT_* STX1  ! CHECK_SRCH_BIT+1,,AUTO

      875    24761        /*F*  NAME: FLB_OUTPUT_NODES
      876    24762              PURPOSE: Process OUTPUT nodes.
      877    24763        */
      878    24764
      879    24765    2   DCL DCB$ PTR AUTO;
      880    24766    2   DCL DCB# SBIN AUTO;
      881    24767    2   DCL FILE_OPEN BIT(1) AUTO;
      882    24768
      883    24769        /****************************************/
      884    24770
      885    24771        /***
      886    24772         *** Close proper file if it's open.
      887    24773         ***/
      888    24774
      889    24775    2      IF COMMAND = %OUTPUT

  24775 20 001631   000167 235000 2                  LDA     COMMAND
        20 001632   000013 115007                    CMPA    11,DL
        20 001633   001655 601000 20                 TNZ     s:24786

      890    24776    3       THEN DO;

      891    24777    3         DCB$ = M$LO$;

  24777 20 001634   000216 236000 2                  LDQ     M$LO$
        20 001635   200005 756100                    STQ     DCB$,,AUTO

      892    24778    3         DCB# = DCBNUM(M$LO);

  24778 20 001636   000000 236007 xsym               LDQ     M$LO,DL
        20 001637   200006 756100                    STQ     DCB#,,AUTO

      893    24779    3         OPEN_FID.V.ORG# = %UR#;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:198  

  24779 20 001640   004000 236007                    LDQ     2048,DL
        20 001641   001272 552010 2                  STBQ    OPEN_FID+38,'10'O

      894    24780    3         OPEN_FID.V.FUN# = %CREATE#;

  24780 20 001642   003000 236007                    LDQ     1536,DL
        20 001643   001271 552010 2                  STBQ    OPEN_FID+37,'10'O

      895    24781    3         OPEN_FID.V.EXIST# = %OLDFILE#;

  24781 20 001644   001270 236000 2                  LDQ     OPEN_FID+36
        20 001645   000022 376000 21                 ANQ     18
        20 001646   000400 276007                    ORQ     256,DL
        20 001647   001270 756000 2                  STQ     OPEN_FID+36

      896    24782    3         OPEN_FID.V.TYPE# = ' ';

  24782 20 001650   040040 220003                    LDX0    16416,DU
        20 001651   001273 740000 2                  STX0    OPEN_FID+39

      897    24783    3         OPEN_FID.V.ACS# = %SEQUEN#;

  24783 20 001652   000001 236007                    LDQ     1,DL
        20 001653   001272 552004 2                  STBQ    OPEN_FID+38,'04'O

      898    24784    3         END;

  24784 20 001654   001671 710000 20                 TRA     s:24794

      899    24785    3       ELSE DO;

      900    24786    3         DCB$ = M$CATALOG$;

  24786 20 001655   000217 236000 2                  LDQ     M$CATALOG$
        20 001656   200005 756100                    STQ     DCB$,,AUTO

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:199  
      901    24787    3         DCB# = DCBNUM(M$CATALOG);

  24787 20 001657   000000 236007 xsym               LDQ     M$CATALOG,DL
        20 001660   200006 756100                    STQ     DCB#,,AUTO

      902    24788    3         OPEN_FID.V.ORG# = %KEYED#;

  24788 20 001661   002000 236007                    LDQ     1024,DL
        20 001662   001272 552010 2                  STBQ    OPEN_FID+38,'10'O

      903    24789    3         OPEN_FID.V.FUN# = %UPDATE#;

  24789 20 001663   001000 236007                    LDQ     512,DL
        20 001664   001271 552010 2                  STBQ    OPEN_FID+37,'10'O

      904    24790    3         OPEN_FID.V.TYPE# = 'CF';

  24790 20 001665   000212 220000 19                 LDX0    LEGAL_CHAR+92
        20 001666   001273 740000 2                  STX0    OPEN_FID+39

      905    24791    3         OPEN_FID.V.ACS# = %DIRECT#;

  24791 20 001667   000002 236007                    LDQ     2,DL
        20 001670   001272 552004 2                  STBQ    OPEN_FID+38,'04'O

      906    24792    3         END;

      907    24793
      908    24794    2      IF NODE$->OUT$BLK.NSUBLKS <= 0

  24794 20 001671   000226 470400 2                  LDP0    NODE$
        20 001672   000001 222100                    LDX2    1,,PR0
        20 001673   001717 601000 20                 TNZ     s:24802

      909    24795    3       THEN DO;                            /* Tell destination if open           */

      910    24796    3         IF DCB$->F$DCB.FCD#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:200  

  24796 20 001674   200005 471500                    LDP1    DCB$,,AUTO
        20 001675   100031 236100                    LDQ     25,,PR1
        20 001676   020000 316007                    CANQ    8192,DL
        20 001677   001711 600000 20                 TZE     s:24798

      911    24797    3          THEN CALL FLI$RPT_ERR( E_FILE_NAME, DCB# );

  24797 20 001700   200006 633500                    EPPR3   DCB#,,AUTO
        20 001701   200043 453500                    STP3    @MAX_NX+2,,AUTO
        20 001702   000023 236000 21                 LDQ     19
        20 001703   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 001704   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 001705   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 001706   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 001707   000000 011000                    NOP     0
        20 001710   001715 710000 20                 TRA     s:24799

      912    24798    3          ELSE CALL FLI$RPT_ERR( E_NO_CATALOG ); /* Only catalog will be closed  */

  24798 20 001711   000024 630400 21                 EPPR0   20
        20 001712   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 001713   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 001714   000000 011000                    NOP     0

      913    24799    3         RETURN;

  24799 20 001715   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 001716   000001 702211                    TSX2  ! 1,X1

      914    24800    3         END;
      915    24801
      916    24802    2      CLOSE_FID.V.DCB# = DCB#;

  24802 20 001717   200006 723100                    LXL3    DCB#,,AUTO
        20 001720   001070 743000 2                  STX3    CLOSE_FID+26

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:201  
      917    24803    2      FILE_OPEN = DCB$->F$DCB.FCD#;

  24803 20 001721   200005 471500                    LDP1    DCB$,,AUTO
        20 001722   100031 236100                    LDQ     25,,PR1
        20 001723   000026 736000                    QLS     22
        20 001724   400000 376003                    ANQ     -131072,DU
        20 001725   200007 756100                    STQ     FILE_OPEN,,AUTO

      918    24804    2      IF FILE_OPEN

  24804 20 001726   200007 234100                    SZN     FILE_OPEN,,AUTO
        20 001727   001740 605000 20                 TPL     s:24810

      919    24805    2       THEN CALL M$CLOSE( CLOSE_FID )

  24805 20 001730   001036 630400 2                  EPPR0   CLOSE_FID
        20 001731   450001 713400                    CLIMB   alt,close
        20 001732   406000 401760                    pmme    nvectors=13
        20 001733   001735 702000 20                 TSX2    s:24807
        20 001734   001740 710000 20                 TRA     s:24810

      920    24806    3          WHENALTRETURN DO;

      921    24807    3            CALL FLI$RPT_ERR;

  24807 20 001735   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 001736   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 001737   000000 011000                    NOP     0

      922    24808    3            END;

      923    24809
      924    24810    2      IF COMMAND = %CATALOG

  24810 20 001740   000167 235000 2                  LDA     COMMAND
        20 001741   000041 115007                    CMPA    33,DL
        20 001742   001773 601000 20                 TNZ     s:24825
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:202  

      925    24811    3       THEN DO;

      926    24812    3         IF NODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %OFF_FILE

  24812 20 001743   000226 470400 2                  LDP0    NODE$
        20 001744   000003 471500                    LDP1    3,,PR0
        20 001745   100000 720100                    LXL0    0,,PR1
        20 001746   000005 100003                    CMPX0   5,DU
        20 001747   001760 601000 20                 TNZ     s:24819

      927    24813    4          THEN DO;

      928    24814    4            IF NOT FILE_OPEN               /* Request OFF and already off        */

  24814 20 001750   200007 234100                    SZN     FILE_OPEN,,AUTO
        20 001751   001756 604000 20                 TMI     s:24816

      929    24815    4             THEN CALL FLI$RPT_ERR( E_CAT_OFF );

  24815 20 001752   000025 630400 21                 EPPR0   21
        20 001753   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 001754   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 001755   000000 011000                    NOP     0

      930    24816    4            RETURN;

  24816 20 001756   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 001757   000001 702211                    TSX2  ! 1,X1

      931    24817    4            END;
      932    24818    4          ELSE DO;

      933    24819    4            IF FILE_OPEN                   /* Request on already on              */

  24819 20 001760   200007 234100                    SZN     FILE_OPEN,,AUTO
        20 001761   001772 605000 20                 TPL     s:24821
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:203  

      934    24820    4             THEN CALL FLI$RPT_ERR( E_MUST_CAT_OFF, DCB# );

  24820 20 001762   200006 633500                    EPPR3   DCB#,,AUTO
        20 001763   200043 453500                    STP3    @MAX_NX+2,,AUTO
        20 001764   000026 236000 21                 LDQ     22
        20 001765   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 001766   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 001767   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 001770   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 001771   000000 011000                    NOP     0

      935    24821    4            CATALOG_ONTO = '0'B;

  24821 20 001772   000000 450000 xsym               STZ     CATALOG_ONTO

      936    24822    4            END;

      937    24823    3         END;

      938    24824
      939    24825    2      OPEN_FID.V.DCB# = DCB#;

  24825 20 001773   200006 720100                    LXL0    DCB#,,AUTO
        20 001774   001270 740000 2                  STX0    OPEN_FID+36

      940    24826
      941    24827        /***
      942    24828         *** Get fid and other options.
      943    24829         ***/
      944    24830
      945    24831    3      DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;

  24831 20 001775   000232 450000 2                  STZ     SUBNODEX
        20 001776   002122 710000 20                 TRA     s:24865+1

      946    24832    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:204  

  24832 20 001777   000226 470400 2                  LDP0    NODE$
        20 002000   000232 720000 2                  LXL0    SUBNODEX
        20 002001   000003 236110                    LDQ     3,X0,PR0
        20 002002   000231 756000 2                  STQ     SUBNODE$

      947    24833    4         DO CASE( SUBNODE$->OUT$BLK.CODE );

  24833 20 002003   000231 471400 2                  LDP1    SUBNODE$
        20 002004   100000 721100                    LXL1    0,,PR1
        20 002005   000007 101003                    CMPX1   7,DU
        20 002006   002010 602011 20                 TNC     s:24833+5,X1
        20 002007   002067 710000 20                 TRA     s:24853
        20 002010   002067 710000 20                 TRA     s:24853
        20 002011   002017 710000 20                 TRA     s:24835
        20 002012   002026 710000 20                 TRA     s:24838
        20 002013   002046 710000 20                 TRA     s:24845
        20 002014   002053 710000 20                 TRA     s:24848
        20 002015   002056 710000 20                 TRA     s:24850
        20 002016   002035 710000 20                 TRA     s:24841

      948    24834    4          CASE( %ON_FILE );

      949    24835    4            OPEN_FID.V.FUN# = %CREATE#;

  24835 20 002017   003000 236007                    LDQ     1536,DL
        20 002020   001271 552010 2                  STBQ    OPEN_FID+37,'10'O

      950    24836    4            OPEN_FID.V.EXIST# = %ERROR#;

  24836 20 002021   001270 236000 2                  LDQ     OPEN_FID+36
        20 002022   000022 376000 21                 ANQ     18
        20 002023   000200 276007                    ORQ     128,DL
        20 002024   001270 756000 2                  STQ     OPEN_FID+36
        20 002025   002121 710000 20                 TRA     s:24865

      951    24837    4          CASE( %INTO_FILE );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:205  

      952    24838    4            OPEN_FID.V.FUN# = %CREATE#;

  24838 20 002026   003000 236007                    LDQ     1536,DL
        20 002027   001271 552010 2                  STBQ    OPEN_FID+37,'10'O

      953    24839    4            OPEN_FID.V.EXIST# = %OLDFILE#;

  24839 20 002030   001270 236000 2                  LDQ     OPEN_FID+36
        20 002031   000022 376000 21                 ANQ     18
        20 002032   000400 276007                    ORQ     256,DL
        20 002033   001270 756000 2                  STQ     OPEN_FID+36
        20 002034   002121 710000 20                 TRA     s:24865

      954    24840    4          CASE( %ONTO_FILE );

      955    24841    4            OPEN_FID.V.FUN# = %CREATE#;

  24841 20 002035   003000 236007                    LDQ     1536,DL
        20 002036   001271 552010 2                  STBQ    OPEN_FID+37,'10'O

      956    24842    4            OPEN_FID.V.EXIST# = %OLDFILE#;

  24842 20 002037   001270 236000 2                  LDQ     OPEN_FID+36
        20 002040   000022 376000 21                 ANQ     18
        20 002041   000400 276007                    ORQ     256,DL
        20 002042   001270 756000 2                  STQ     OPEN_FID+36

      957    24843    4            CATALOG_ONTO = '1'B;

  24843 20 002043   400000 236003                    LDQ     -131072,DU
        20 002044   000000 756000 xsym               STQ     CATALOG_ONTO
        20 002045   002121 710000 20                 TRA     s:24865

      958    24844    4          CASE( %OVER_FILE );

      959    24845    4            OPEN_FID.V.FUN# = %CREATE#;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:206  

  24845 20 002046   003000 236007                    LDQ     1536,DL
        20 002047   001271 552010 2                  STBQ    OPEN_FID+37,'10'O

      960    24846    4            OPEN_FID.V.EXIST# = %NEWFILE#;

  24846 20 002050   000600 236007                    LDQ     384,DL
        20 002051   001270 256000 2                  ORSQ    OPEN_FID+36
        20 002052   002121 710000 20                 TRA     s:24865

      961    24847    4          CASE( %IS_FILE );

      962    24848    4            OPEN_FID.V.FUN# = %IN#;

  24848 20 002053   002000 236007                    LDQ     1024,DL
        20 002054   001271 552010 2                  STBQ    OPEN_FID+37,'10'O
        20 002055   002121 710000 20                 TRA     s:24865

      963    24849    4          CASE( %OFF_FILE );

      964    24850    4            CALL M$OPEN( OPEN_DEFAULT_LO ) ALTRET( GIVE_IT_UP );

  24850 20 002056   001416 630400 2                  EPPR0   OPEN_DEFAULT_LO
        20 002057   450000 713400                    CLIMB   alt,open
        20 002060   410400 401760                    pmme    nvectors=18
        20 002061   002234 702000 20                 TSX2    GIVE_IT_UP

      965    24851    4            CALL M$DEVICE( PAGE_LO ) ALTRET( GIVE_IT_UP );

  24851 20 002062   001514 630400 2                  EPPR0   PAGE_LO
        20 002063   450006 713400                    CLIMB   alt,+20486
        20 002064   401000 401760                    pmme    nvectors=3
        20 002065   002234 702000 20                 TSX2    GIVE_IT_UP
        20 002066   002121 710000 20                 TRA     s:24865

      966    24852    4          CASE( ELSE );

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:207  
      967    24853    4            FPT_FID.TEXTFID_ = VECTOR(SUBNODE$->OUT$SYM.TEXT );

  24853 20 002067   100004 236100                    LDQ     4,,PR1
        20 002070   000033 772000                    QRL     27
        20 002071   000064 737000                    LLS     52
        20 002072   000140 135007                    SBLA    96,DL
        20 002073   000231 236000 2                  LDQ     SUBNODE$
        20 002074   000027 036000 21                 ADLQ    23
        20 002075   001320 757000 2                  STAQ    FPT_FID+2

      968    24854    4            CALL M$FID( FPT_FID ) ALTRET( ALL_ALTRETS );

  24854 20 002076   001316 630400 2                  EPPR0   FPT_FID
        20 002077   420001 713400                    CLIMB   alt,+8193
        20 002100   404400 401760                    pmme    nvectors=10
        20 002101   002203 702000 20                 TSX2    ALL_ALTRETS

      969    24855    4            IF COMMAND = %CATALOG

  24855 20 002102   000167 235000 2                  LDA     COMMAND
        20 002103   000041 115007                    CMPA    33,DL
        20 002104   002121 601000 20                 TNZ     s:24865

      970    24856    5             THEN DO;

      971    24857    5               IF OPEN_FID.V.ASN# ~= %FILE#

  24857 20 002105   001271 236000 2                  LDQ     OPEN_FID+37
        20 002106   000777 376007                    ANQ     511,DL
        20 002107   000001 116007                    CMPQ    1,DL
        20 002110   002121 600000 20                 TZE     s:24865

      972    24858    6                THEN DO;

      973    24859    6                  CALL FLI$RPT_ERR( E_MUST_CAT_DISK );

  24859 20 002111   000030 630400 21                 EPPR0   24
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:208  
        20 002112   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 002113   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 002114   000000 011000                    NOP     0

      974    24860    6                  COMMAND_ERROR = '1'B;

  24860 20 002115   400000 236003                    LDQ     -131072,DU
        20 002116   000000 756000 xsym               STQ     COMMAND_ERROR

      975    24861    6                  RETURN;

  24861 20 002117   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 002120   000001 702211                    TSX2  ! 1,X1

      976    24862    6                  END;
      977    24863    5               END;
      978    24864    4          END;

      979    24865    3         END;

  24865 20 002121   000232 054000 2                  AOS     SUBNODEX
        20 002122   000226 470400 2                  LDP0    NODE$
        20 002123   000001 236100                    LDQ     1,,PR0
        20 002124   000022 772000                    QRL     18
        20 002125   000232 116000 2                  CMPQ    SUBNODEX
        20 002126   001777 605400 20                 TPNZ    s:24832

      980    24866
      981    24867    2      IF NOT FMSEC

  24867 20 002127   000000 234000 xsym               SZN     FMSEC
        20 002130   002134 604000 20                 TMI     s:24869

      982    24868    2       THEN CALL M$RPRIV( SWITCH_FMSEC );

  24868 20 002131   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 002132   020013 713400                    CLIMB   8203
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:209  
        20 002133   400000 401760                    pmme    nvectors=1

      983    24869    2      CALL M$OPEN( OPEN_FID ) ALTRET( ALL_ALTRETS );

  24869 20 002134   001224 630400 2                  EPPR0   OPEN_FID
        20 002135   450000 713400                    CLIMB   alt,open
        20 002136   410400 401760                    pmme    nvectors=18
        20 002137   002203 702000 20                 TSX2    ALL_ALTRETS

      984    24870    2      IF NOT FMSEC

  24870 20 002140   000000 234000 xsym               SZN     FMSEC
        20 002141   002145 604000 20                 TMI     s:24872

      985    24871    2       THEN CALL M$SPRIV( SWITCH_FMSEC );

  24871 20 002142   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 002143   020012 713400                    CLIMB   8202
        20 002144   400000 401760                    pmme    nvectors=1

      986    24872    2      IF COMMAND = %OUTPUT

  24872 20 002145   000167 235000 2                  LDA     COMMAND
        20 002146   000013 115007                    CMPA    11,DL
        20 002147   002155 601000 20                 TNZ     s:24875

      987    24873    2       THEN CALL M$DEVICE( PAGE_LO ) ALTRET( ALL_ALTRETS );

  24873 20 002150   001514 630400 2                  EPPR0   PAGE_LO
        20 002151   450006 713400                    CLIMB   alt,+20486
        20 002152   401000 401760                    pmme    nvectors=3
        20 002153   002203 702000 20                 TSX2    ALL_ALTRETS
        20 002154   002201 710000 20                 TRA     s:24884

      988    24874    3       ELSE DO;

      989    24875    3         IF DCB$->F$DCB.TYPE# ~= 'CF' OR DCB$->F$DCB.ORG# ~= %KEYED#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:210  

  24875 20 002155   200005 470500                    LDP0    DCB$,,AUTO
        20 002156   000025 720100                    LXL0    21,,PR0
        20 002157   000212 100000 19                 CMPX0   LEGAL_CHAR+92
        20 002160   002165 601000 20                 TNZ     s:24877
        20 002161   000032 236100                    LDQ     26,,PR0
        20 002162   777000 376003                    ANQ     -512,DU
        20 002163   002000 116003                    CMPQ    1024,DU
        20 002164   002201 600000 20                 TZE     s:24884

      990    24876    4          THEN DO;

      991    24877    4            CALL FLI$RPT_ERR( E_MUST_BE_CAT_FILE );

  24877 20 002165   000031 630400 21                 EPPR0   25
        20 002166   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 002167   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 002170   000000 011000                    NOP     0

      992    24878    4            CALL M$CLOSE( CLOSE_FID )

  24878 20 002171   001036 630400 2                  EPPR0   CLOSE_FID
        20 002172   450001 713400                    CLIMB   alt,close
        20 002173   406000 401760                    pmme    nvectors=13
        20 002174   002176 702000 20                 TSX2    s:24880
        20 002175   002201 710000 20                 TRA     s:24884

      993    24879    5             WHENALTRETURN DO;

      994    24880    5               CALL FLI$RPT_ERR;

  24880 20 002176   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 002177   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 002200   000000 011000                    NOP     0

      995    24881    5               END;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:211  
      996    24882    4            END;

      997    24883    3         END;

      998    24884    2      RETURN;

  24884 20 002201   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 002202   000001 702211                    TSX2  ! 1,X1

  24880 20 002203                       ALL_ALTRETS  null
      999    24885
     1000    24886    2   ALL_ALTRETS: ;
     1001    24887    2      IF NOT FMSEC

  24887 20 002203   000000 234000 xsym               SZN     FMSEC
        20 002204   002210 604000 20                 TMI     s:24889

     1002    24888    2       THEN CALL M$SPRIV( SWITCH_FMSEC );

  24888 20 002205   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 002206   020012 713400                    CLIMB   8202
        20 002207   400000 401760                    pmme    nvectors=1

     1003    24889    2      COMMAND_ERROR = '1'B;

  24889 20 002210   400000 236003                    LDQ     -131072,DU
        20 002211   000000 756000 xsym               STQ     COMMAND_ERROR

     1004    24890    2      CALL FLI$RPT_ERR;

  24890 20 002212   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 002213   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 002214   000000 011000                    NOP     0

     1005    24891    2      IF COMMAND ~= %OUTPUT

  24891 20 002215   000167 235000 2                  LDA     COMMAND
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:212  
        20 002216   000013 115007                    CMPA    11,DL
        20 002217   002222 600000 20                 TZE     s:24893

     1006    24892    2       THEN RETURN;

  24892 20 002220   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 002221   000001 702211                    TSX2  ! 1,X1

     1007    24893    2      CALL M$OPEN( OPEN_DEFAULT_LO ) ALTRET( GIVE_IT_UP );

  24893 20 002222   001416 630400 2                  EPPR0   OPEN_DEFAULT_LO
        20 002223   450000 713400                    CLIMB   alt,open
        20 002224   410400 401760                    pmme    nvectors=18
        20 002225   002234 702000 20                 TSX2    GIVE_IT_UP

     1008    24894    2      CALL M$DEVICE( PAGE_LO ) ALTRET( GIVE_IT_UP );

  24894 20 002226   001514 630400 2                  EPPR0   PAGE_LO
        20 002227   450006 713400                    CLIMB   alt,+20486
        20 002230   401000 401760                    pmme    nvectors=3
        20 002231   002234 702000 20                 TSX2    GIVE_IT_UP

     1009    24895    2      RETURN;

  24895 20 002232   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 002233   000001 702211                    TSX2  ! 1,X1

  24891 20 002234                       GIVE_IT_UP   null
     1010    24896
     1011    24897    2   GIVE_IT_UP: ;
     1012    24898    2      CALL FLI$RPT_ERR;

  24898 20 002234   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 002235   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 002236   000000 011000                    NOP     0

     1013    24899    2      CALL FLI$RPT_ERR( E_TRY_AGAIN );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:213  

  24899 20 002237   000021 630400 21                 EPPR0   17
        20 002240   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 002241   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 002242   000000 011000                    NOP     0

     1014    24900    2      CALL M$XXX;

  24900 20 002243   000003 713400                    CLIMB   3
        20 002244   000000 401760                    pmme    nvectors=0

     1015    24901
     1016    24902    2   END FLB_OUTPUT_NODES;

  24902 20 002245   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 002246   000001 702211                    TSX2  ! 1,X1

     1017    24903        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:214  
     1018    24904    1   FLB_WHERE_NODES: PROC;

  24904 20 002247   200004 741300       FLB_WHERE_N* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     1019    24905        /*F*  NAME: FLB_WHERE_NODES
     1020    24906              PURPOSE: Process WHERE command.
     1021    24907        */
     1022    24908
     1023    24909        /****************************************/
     1024    24910
     1025    24911    2      CALL FLB_DISK_SPEC(0)

  24911 20 002250   000032 236000 21                 LDQ     26
        20 002251   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 002252   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 002253   002255 702000 20                 TSX2    s:24915
        20 002254   002255 710000 20                 TRA     s:24915

     1026    24912    3       WHENALTRETURN DO;

     1027    24913    3         END;

     1028    24914
     1029    24915    2      IF COMMAND_ERROR THEN RETURN;

  24915 20 002255   000000 234000 xsym               SZN     COMMAND_ERROR
        20 002256   002261 605000 20                 TPL     s:24917

  24915 20 002257   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 002260   000001 702211                    TSX2  ! 1,X1

     1030    24916
     1031    24917    2      CALL FLW$WHERE;

  24917 20 002261   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 002262   000000 701000 xent               TSX1    FLW$WHERE
        20 002263   000000 011000                    NOP     0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:215  

     1032    24918    2      RETURN;

  24918 20 002264   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 002265   000001 702211                    TSX2  ! 1,X1

     1033    24919
     1034    24920    2   END FLB_WHERE_NODES;
     1035    24921        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:216  
     1036    24922    1   FLB_READ_NODES: PROC;

  24922 20 002266   200004 741300       FLB_READ_NO* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     1037    24923        /*F*  NAME: FLB_READ_NODES
     1038    24924              PURPOSE: Process READ nodes.
     1039    24925        */
     1040    24926
     1041    24927        /****************************************/
     1042    24928
     1043    24929        /***
     1044    24930         *** Close proper file if it's open.
     1045    24931         ***/
     1046    24932
     1047    24933    2      IF M$READ_FILE$->F$DCB.FCD#

  24933 20 002267   000214 470400 2                  LDP0    M$READ_FILE$
        20 002270   000031 236100                    LDQ     25,,PR0
        20 002271   020000 316007                    CANQ    8192,DL
        20 002272   002303 600000 20                 TZE     s:24938

     1048    24934    2       THEN CALL M$CLOSE( CLOSE_READ_FILE )

  24934 20 002273   001166 630400 2                  EPPR0   CLOSE_READ_FILE
        20 002274   450001 713400                    CLIMB   alt,close
        20 002275   406000 401760                    pmme    nvectors=13
        20 002276   002300 702000 20                 TSX2    s:24936
        20 002277   002303 710000 20                 TRA     s:24938

     1049    24935    3          WHENALTRETURN DO;

     1050    24936    3            CALL FLI$RPT_ERR;

  24936 20 002300   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 002301   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 002302   000000 011000                    NOP     0

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:217  
     1051    24937    3            END;

     1052    24938    2      OPEN_FID.V.FUN# = %IN#;

  24938 20 002303   002000 236007                    LDQ     1024,DL
        20 002304   001271 552010 2                  STBQ    OPEN_FID+37,'10'O

     1053    24939    2      OPEN_FID.V.DCB# = DCBNUM(M$READ_FILE);

  24939 20 002305   000000 236007 xsym               LDQ     M$READ_FILE,DL
        20 002306   000000 620006                    EAX0    0,QL
        20 002307   001270 740000 2                  STX0    OPEN_FID+36

     1054    24940
     1055    24941        /***
     1056    24942         *** Get fid and other options.
     1057    24943         ***/
     1058    24944
     1059    24945    2      FPT_FID.TEXTFID_ = VECTOR(NODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  24945 20 002310   000226 470400 2                  LDP0    NODE$
        20 002311   000003 471500                    LDP1    3,,PR0
        20 002312   100004 236100                    LDQ     4,,PR1
        20 002313   000033 772000                    QRL     27
        20 002314   000064 737000                    LLS     52
        20 002315   000140 135007                    SBLA    96,DL
        20 002316   200042 451500                    STP1    @MAX_NX+1,,AUTO
        20 002317   200042 236100                    LDQ     @MAX_NX+1,,AUTO
        20 002320   000027 036000 21                 ADLQ    23
        20 002321   001320 757000 2                  STAQ    FPT_FID+2

     1060    24946    2      CALL M$FID( FPT_FID ) ALTRET( ALL_ALTRETS );

  24946 20 002322   001316 630400 2                  EPPR0   FPT_FID
        20 002323   420001 713400                    CLIMB   alt,+8193
        20 002324   404400 401760                    pmme    nvectors=10
        20 002325   002356 702000 20                 TSX2    ALL_ALTRETS
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:218  

     1061    24947
     1062    24948    2      IF NOT FMSEC

  24948 20 002326   000000 234000 xsym               SZN     FMSEC
        20 002327   002333 604000 20                 TMI     s:24950

     1063    24949    2       THEN CALL M$RPRIV( SWITCH_FMSEC );

  24949 20 002330   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 002331   020013 713400                    CLIMB   8203
        20 002332   400000 401760                    pmme    nvectors=1

     1064    24950    2      CALL M$OPEN( OPEN_FID ) ALTRET( ALL_ALTRETS );

  24950 20 002333   001224 630400 2                  EPPR0   OPEN_FID
        20 002334   450000 713400                    CLIMB   alt,open
        20 002335   410400 401760                    pmme    nvectors=18
        20 002336   002356 702000 20                 TSX2    ALL_ALTRETS

     1065    24951    2      IF NOT FMSEC

  24951 20 002337   000000 234000 xsym               SZN     FMSEC
        20 002340   002344 604000 20                 TMI     s:24953

     1066    24952    2       THEN CALL M$SPRIV( SWITCH_FMSEC );

  24952 20 002341   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 002342   020012 713400                    CLIMB   8202
        20 002343   400000 401760                    pmme    nvectors=1

     1067    24953    2      CALL XUR$SETDCBS( DCBNUM(M$READ_FILE), );

  24953 20 002344   000000 236007 xsym               LDQ     M$READ_FILE,DL
        20 002345   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 002346   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 002347   200043 450500                    STP0    @MAX_NX+2,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:219  
        20 002350   200043 630500                    EPPR0   @MAX_NX+2,,AUTO
        20 002351   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 002352   000000 701000 xent               TSX1    XUR$SETDCBS
        20 002353   000000 011000                    NOP     0

     1068    24954    2      RETURN;

  24954 20 002354   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 002355   000001 702211                    TSX2  ! 1,X1

  24951 20 002356                       ALL_ALTRETS  null
     1069    24955
     1070    24956    2   ALL_ALTRETS: ;
     1071    24957    2      IF NOT FMSEC

  24957 20 002356   000000 234000 xsym               SZN     FMSEC
        20 002357   002363 604000 20                 TMI     s:24959

     1072    24958    2       THEN CALL M$SPRIV( SWITCH_FMSEC );

  24958 20 002360   000734 630400 2                  EPPR0   SWITCH_FMSEC
        20 002361   020012 713400                    CLIMB   8202
        20 002362   400000 401760                    pmme    nvectors=1

     1073    24959    2      COMMAND_ERROR = '1'B;

  24959 20 002363   400000 236003                    LDQ     -131072,DU
        20 002364   000000 756000 xsym               STQ     COMMAND_ERROR

     1074    24960    2      CALL FLI$RPT_ERR;

  24960 20 002365   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 002366   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 002367   000000 011000                    NOP     0

     1075    24961    2      CALL XUR$SETDCBS( DCBNUM(M$SI), );

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:220  
  24961 20 002370   000000 236007 xsym               LDQ     M$SI,DL
        20 002371   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 002372   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 002373   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 002374   200043 630500                    EPPR0   @MAX_NX+2,,AUTO
        20 002375   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 002376   000000 701000 xent               TSX1    XUR$SETDCBS
        20 002377   000000 011000                    NOP     0

     1076    24962    2      RETURN;

  24962 20 002400   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 002401   000001 702211                    TSX2  ! 1,X1

     1077    24963
     1078    24964    2   END FLB_READ_NODES;
     1079    24965        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:221  
     1080    24966
     1081    24967    1   FLB_TAPE_NODES: PROC;

  24967 20 002402   200010 741300       FLB_TAPE_NO* STX1  ! TEMP$+1,,AUTO

     1082    24968        /*F*  NAME: FLB_TAPE_NODES
     1083    24969              PURPOSE: Process tape-related commands.
     1084    24970        */
     1085    24971
     1086    24972    2   DCL DCB$ PTR AUTO;
     1087    24973    2   DCL DCB# UBIN AUTO;
     1088    24974    2   DCL DCB_NUM UBIN AUTO;
     1089    24975    2   DCL NBR_RUNS UBIN AUTO;
     1090    24976    2   DCL TAPE_FSN UBIN AUTO;
     1091    24977    2   DCL TAPE_DENSITY UBIN AUTO;
     1092    24978    2   DCL TAPE_IOERROK BIT(1) AUTO;
     1093    24979    2   DCL NEW_REBUILD BIT(1) AUTO;
     1094    24980        %VLP_VECTOR (FPTN = FIT_,
     1095    24981                     STCLASS = AUTO);
     1096    24996        %VLP_ERRCODE (FPTN = ERR,
     1097    24997                        STCLASS = AUTO);
     1098    25042
     1099    25043        /****************************************/
     1100    25044
     1101    25045    2      IF COMMAND ~= %REBUILD THEN CALL FLB_TAPE_OD_SPEC

  25045 20 002403   000167 235000 2                  LDA     COMMAND
        20 002404   000056 115007                    CMPA    46,DL
        20 002405   002575 600000 20                 TZE     s:25113

  25045 20 002406   014004 701000 20                 TSX1    FLB_TAPE_OD_SPEC
        20 002407   002452 702000 20                 TSX2    s:25076

     1102    25046    3          WHENRETURN DO;

     1103    25047          /***
     1104    25048           *** The following code "undoes" the initial serial number list
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:222  
     1105    25049           *** from the tape [destination] list.
     1106    25050           ***/
     1107    25051    3            SOURCE_TAPE_SNLIST$ = SNLISTINFO.SNLIST$;

  25051 20 002410   000000 470400 xsym               LDP0    LAST_SNLISTINFO$
        20 002411   000000 236100                    LDQ     0,,PR0
        20 002412   000230 756000 2                  STQ     SOURCE_TAPE_SNLIST$

     1108    25052    3            TVECTOR = VECTOR(SOURCE_TAPE_SNLIST$->VLP_SN);

  25052 20 002413   000033 235000 21                 LDA     27
        20 002414   000000 757000 xsym               STAQ    TVECTOR

     1109    25053    3            TVECTOR.W1.VSIZE# = LENGTHV(VLP_SN.NUM#)

  25053 20 002415   000230 471400 2                  LDP1    SOURCE_TAPE_SNLIST$
        20 002416   100000 236100                    LDQ     0,,PR1
        20 002417   000006 402007                    MPY     6,DL
        20 002420   000003 036007                    ADLQ    3,DL
        20 002421   000020 736000                    QLS     16
        20 002422   000000 676000 xsym               ERQ     TVECTOR
        20 002423   000034 376000 xsym               ANQ     B_VECTNIL+28
        20 002424   000000 656000 xsym               ERSQ    TVECTOR

     1110    25054    3              + SOURCE_TAPE_SNLIST$->VLP_SN.NUM# * LENGTHC(VLP_SN.SN#(0));
     1111    25055    3            TAPE_OPEN.SN_ = TVECTOR;

  25055 20 002425   000000 237000 xsym               LDAQ    TVECTOR
        20 002426   000002 757000 xsym               STAQ    TAPE_OPEN+2

     1112    25056    3            LAST_SNLISTINFO$ = ADDR(NIL);

  25056 20 002427   000001 236000 xsym               LDQ     B_VECTNIL+1
        20 002430   000000 756000 xsym               STQ     LAST_SNLISTINFO$

     1113    25057    3            NBR_SNLISTS = 0;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:223  
  25057 20 002431   000000 450000 xsym               STZ     NBR_SNLISTS

     1114    25058    3            IF COMMAND = %RETRIEVE

  25058 20 002432   000167 235000 2                  LDA     COMMAND
        20 002433   000034 115007                    CMPA    28,DL
        20 002434   002451 601000 20                 TNZ     s:25071+2

     1115    25059        /***
     1116    25060         *** If a file is spec'd for an OD retrieve, create command with FSN spec'd so
     1117    25061         *** that only that FSN is opened when retrieving the file. If a
     1118    25062         *** FSN is not used to find a file, then many opens starting at the beginning
     1119    25063         *** of a volume must be executed in order to find the file. File specif. not
     1120    25064        *** permitted for tape retrieves.
     1121    25065        ***/
     1122    25066    4             THEN DO;

     1123    25067    4               IF NODE$->OUT$BLK.NSUBLKS > 1

  25067 20 002435   000226 470400 2                  LDP0    NODE$
        20 002436   000001 220100                    LDX0    1,,PR0
        20 002437   000002 100003                    CMPX0   2,DU
        20 002440   002451 602000 20                 TNC     s:25071+2
        20 002441   000004 473500                    LDP3    4,,PR0
        20 002442   300000 721100                    LXL1    0,,PR3
        20 002443   000002 101003                    CMPX1   2,DU
        20 002444   002451 601000 20                 TNZ     s:25071+2

     1124    25068    4                 AND NODE$->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE = %DISK_FILE_SPEC
     1125    25069    5                THEN DO;

     1126    25070    5                  CALL FLB_CREATE_RETRIEVE_CMNDS;

  25070 20 002445   003555 701000 20                 TSX1    FLB_CREATE_RETRIEVE_CMNDS
        20 002446   000000 011000                    NOP     0

     1127    25071    5                  RETURN;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:224  

  25071 20 002447   200010 221300                    LDX1  ! TEMP$+1,,AUTO
        20 002450   000001 702211                    TSX2  ! 1,X1
        20 002451   002575 710000 20                 TRA     s:25113

     1128    25072    5                  END;
     1129    25073    4               END;
     1130    25074    3            END;
     1131    25075    3          WHENALTRETURN DO;

     1132    25076    3            IF NBR_SNLISTS = 0

  25076 20 002452   000000 235000 xsym               LDA     NBR_SNLISTS
        20 002453   002575 601000 20                 TNZ     s:25113

     1133    25077    3             THEN IF COMMAND = %CHECK

  25077 20 002454   000167 236000 2                  LDQ     COMMAND
        20 002455   000003 116007                    CMPQ    3,DL
        20 002456   002463 601000 20                 TNZ     s:25082

     1134    25078    4                THEN DO;

     1135    25079    4                  TAPE_OPEN.SN_ = VECTOR(ERASE);
             25079                           /* Didn't find option, but that's okay */

  25079 20 002457   000034 237000 21                 LDAQ    28
        20 002460   000002 757000 xsym               STAQ    TAPE_OPEN+2

     1136    25080    4                  COMMAND_ERROR = '0'B;

  25080 20 002461   000000 450000 xsym               STZ     COMMAND_ERROR

     1137    25081    4                  END;

  25081 20 002462   002575 710000 20                 TRA     s:25113

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:225  
     1138    25082    3                ELSE IF COMMAND = %RETRIEVE

  25082 20 002463   000034 116007                    CMPQ    28,DL
        20 002464   002575 601000 20                 TNZ     s:25113

     1139    25083    4                   THEN DO;

     1140    25084    4                     IF NODE$->OUT$BLK.NSUBLKS > 0 /* Process options , if any   */

  25084 20 002465   000226 470400 2                  LDP0    NODE$
        20 002466   000001 220100                    LDX0    1,,PR0
        20 002467   002571 600000 20                 TZE     s:25108

     1141    25085    5                      THEN DO;

     1142    25086    6                        DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;

  25086 20 002470   000232 450000 2                  STZ     SUBNODEX
        20 002471   002564 710000 20                 TRA     s:25106+1

     1143    25087    6                           SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);

  25087 20 002472   000226 470400 2                  LDP0    NODE$
        20 002473   000232 720000 2                  LXL0    SUBNODEX
        20 002474   000003 236110                    LDQ     3,X0,PR0
        20 002475   000231 756000 2                  STQ     SUBNODE$

     1144    25088    7                           DO CASE( SUBNODE$->OUT$BLK.CODE );

  25088 20 002476   000231 471400 2                  LDP1    SUBNODE$
        20 002477   100000 721100                    LXL1    0,,PR1
        20 002500   000002 101003                    CMPX1   2,DU
        20 002501   002503 602011 20                 TNC     s:25088+5,X1
        20 002502   002563 710000 20                 TRA     s:25106
        20 002503   002563 710000 20                 TRA     s:25106
        20 002504   002505 710000 20                 TRA     s:25090

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:226  
     1145    25089    7                            CASE( %TAPE_OPTIONS );

     1146    25090    8                              DO SUBSUBNODEX = 0 TO SUBNODE$->OUT$BLK.NSUBLKS - 1;

  25090 20 002505   000234 450000 2                  STZ     SUBSUBNODEX
        20 002506   002556 710000 20                 TRA     s:25104+1

     1147    25091    8                                 SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX);

  25091 20 002507   000231 470400 2                  LDP0    SUBNODE$
        20 002510   000234 720000 2                  LXL0    SUBSUBNODEX
        20 002511   000003 236110                    LDQ     3,X0,PR0
        20 002512   000233 756000 2                  STQ     SUBSUBNODE$

     1148    25092    9                                 DO CASE( SUBSUBNODE$->OUT$BLK.CODE );

  25092 20 002513   000233 471400 2                  LDP1    SUBSUBNODE$
        20 002514   100000 236100                    LDQ     0,,PR1
        20 002515   777777 376007                    ANQ     -1,DL
        20 002516   000034 136007                    SBLQ    28,DL
        20 002517   000007 116007                    CMPQ    7,DL
        20 002520   002522 602006 20                 TNC     s:25092+7,QL
        20 002521   002555 710000 20                 TRA     s:25104
        20 002522   002540 710000 20                 TRA     s:25097
        20 002523   002531 710000 20                 TRA     s:25094
        20 002524   002555 710000 20                 TRA     s:25104
        20 002525   002555 710000 20                 TRA     s:25104
        20 002526   002555 710000 20                 TRA     s:25104
        20 002527   002555 710000 20                 TRA     s:25104
        20 002530   002545 710000 20                 TRA     s:25100

     1149    25093    9                                  CASE( %IOERRORCY );

     1150    25094    9                                    TAPE_OPTION.IOERRORC = '1'B;

  25094 20 002531   010000 236003                    LDQ     4096,DU
        20 002532   000002 256000 xsym               ORSQ    TAPE_OPTION+2
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:227  

     1151    25095    9                                    TAPE_OPEN.V.IOERROK# = '1'B;

  25095 20 002533   000060 236000 xsym               LDQ     TAPE_OPEN+48
        20 002534   000036 376000 21                 ANQ     30
        20 002535   002000 276003                    ORQ     1024,DU
        20 002536   000060 756000 xsym               STQ     TAPE_OPEN+48
        20 002537   002555 710000 20                 TRA     s:25104

     1152    25096    9                                  CASE( %IOERRORCN );

     1153    25097    9                                    TAPE_OPTION.IOERRORC = '0'B;

  25097 20 002540   000037 236000 21                 LDQ     31
        20 002541   000002 356000 xsym               ANSQ    TAPE_OPTION+2

     1154    25098    9                                    TAPE_OPEN.V.IOERROK# = '0'B;

  25098 20 002542   000036 236000 21                 LDQ     30
        20 002543   000060 356000 xsym               ANSQ    TAPE_OPEN+48
        20 002544   002555 710000 20                 TRA     s:25104

     1155    25099    9                                  CASE( %DUPLICATE_TAPESET );

     1156    25100    9                                    CALL FLI$RPT_ERR ( E_DUP_TAPESET );

  25100 20 002545   000040 630400 21                 EPPR0   32
        20 002546   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 002547   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 002550   000000 011000                    NOP     0

     1157    25101    9                                    COMMAND_ERROR = '1'B;

  25101 20 002551   400000 236003                    LDQ     -131072,DU
        20 002552   000000 756000 xsym               STQ     COMMAND_ERROR

     1158    25102    9                                    RETURN;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:228  

  25102 20 002553   200010 221300                    LDX1  ! TEMP$+1,,AUTO
        20 002554   000001 702211                    TSX2  ! 1,X1

     1159    25103    9                                  END;

     1160    25104    8                                 END;

  25104 20 002555   000234 054000 2                  AOS     SUBSUBNODEX
        20 002556   000231 470400 2                  LDP0    SUBNODE$
        20 002557   000001 236100                    LDQ     1,,PR0
        20 002560   000022 772000                    QRL     18
        20 002561   000234 116000 2                  CMPQ    SUBSUBNODEX
        20 002562   002507 605400 20                 TPNZ    s:25091

     1161    25105    7                            END;

     1162    25106    6                           END;

  25106 20 002563   000232 054000 2                  AOS     SUBNODEX
        20 002564   000226 470400 2                  LDP0    NODE$
        20 002565   000001 236100                    LDQ     1,,PR0
        20 002566   000022 772000                    QRL     18
        20 002567   000232 116000 2                  CMPQ    SUBNODEX
        20 002570   002472 605400 20                 TPNZ    s:25087

     1163    25107    5                        END;

     1164    25108    4                     CALL FLB_CREATE_RETRIEVE_CMNDS;

  25108 20 002571   003555 701000 20                 TSX1    FLB_CREATE_RETRIEVE_CMNDS
        20 002572   000000 011000                    NOP     0

     1165    25109    4                     RETURN;

  25109 20 002573   200010 221300                    LDX1  ! TEMP$+1,,AUTO
        20 002574   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:229  

     1166    25110    4                     END;
     1167    25111    3            END;
     1168    25112
     1169    25113    3      DO CASE( COMMAND );

  25113 20 002575   000167 235000 2                  LDA     COMMAND
        20 002576   000057 115007                    CMPA    47,DL
        20 002577   002601 602005 20                 TNC     s:25113+4,AL
        20 002600   003553 710000 20                 TRA     JUSTRET
        20 002601   003553 710000 20                 TRA     JUSTRET
        20 002602   003553 710000 20                 TRA     JUSTRET
        20 002603   003553 710000 20                 TRA     JUSTRET
        20 002604   002660 710000 20                 TRA     s:25116
        20 002605   003553 710000 20                 TRA     JUSTRET
        20 002606   003553 710000 20                 TRA     JUSTRET
        20 002607   003553 710000 20                 TRA     JUSTRET
        20 002610   003553 710000 20                 TRA     JUSTRET
        20 002611   003553 710000 20                 TRA     JUSTRET
        20 002612   002660 710000 20                 TRA     s:25116
        20 002613   003553 710000 20                 TRA     JUSTRET
        20 002614   003553 710000 20                 TRA     JUSTRET
        20 002615   002711 710000 20                 TRA     s:25131
        20 002616   002722 710000 20                 TRA     s:25135
        20 002617   002733 710000 20                 TRA     s:25139
        20 002620   003553 710000 20                 TRA     JUSTRET
        20 002621   003553 710000 20                 TRA     JUSTRET
        20 002622   003553 710000 20                 TRA     JUSTRET
        20 002623   003553 710000 20                 TRA     JUSTRET
        20 002624   003553 710000 20                 TRA     JUSTRET
        20 002625   003553 710000 20                 TRA     JUSTRET
        20 002626   003553 710000 20                 TRA     JUSTRET
        20 002627   003553 710000 20                 TRA     JUSTRET
        20 002630   003553 710000 20                 TRA     JUSTRET
        20 002631   003553 710000 20                 TRA     JUSTRET
        20 002632   003553 710000 20                 TRA     JUSTRET
        20 002633   003553 710000 20                 TRA     JUSTRET
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:230  
        20 002634   003553 710000 20                 TRA     JUSTRET
        20 002635   002660 710000 20                 TRA     s:25116
        20 002636   003553 710000 20                 TRA     JUSTRET
        20 002637   003553 710000 20                 TRA     JUSTRET
        20 002640   003553 710000 20                 TRA     JUSTRET
        20 002641   003553 710000 20                 TRA     JUSTRET
        20 002642   003553 710000 20                 TRA     JUSTRET
        20 002643   003553 710000 20                 TRA     JUSTRET
        20 002644   003553 710000 20                 TRA     JUSTRET
        20 002645   003553 710000 20                 TRA     JUSTRET
        20 002646   003553 710000 20                 TRA     JUSTRET
        20 002647   003553 710000 20                 TRA     JUSTRET
        20 002650   003553 710000 20                 TRA     JUSTRET
        20 002651   003553 710000 20                 TRA     JUSTRET
        20 002652   003553 710000 20                 TRA     JUSTRET
        20 002653   003553 710000 20                 TRA     JUSTRET
        20 002654   003553 710000 20                 TRA     JUSTRET
        20 002655   003553 710000 20                 TRA     JUSTRET
        20 002656   003553 710000 20                 TRA     JUSTRET
        20 002657   003002 710000 20                 TRA     s:25159

     1170    25114
     1171    25115    3       CASE( %CHECK, %RESTORE, %RETRIEVE );

     1172    25116    3         CALL FLB_DISK_DEST

  25116 20 002660   006314 701000 20                 TSX1    FLB_DISK_DEST
        20 002661   002710 702000 20                 TSX2    s:25128

     1173    25117    4          WHENRETURN DO;

     1174    25118    4            CALL FLB_DISK_SPEC(0)

  25118 20 002662   000032 236000 21                 LDQ     26
        20 002663   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 002664   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 002665   002710 702000 20                 TSX2    s:25128
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:231  

     1175    25119    5             WHENRETURN DO;

     1176    25120    5               IF COMMAND_ERROR THEN RETURN;

  25120 20 002666   000000 234000 xsym               SZN     COMMAND_ERROR
        20 002667   002672 605000 20                 TPL     s:25121

  25120 20 002670   200010 221300                    LDX1  ! TEMP$+1,,AUTO
        20 002671   000001 702211                    TSX2  ! 1,X1

     1177    25121    5               CALL FLM$MOVE( COMMAND )

  25121 20 002672   000041 630400 21                 EPPR0   33
        20 002673   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 002674   000000 701000 xent               TSX1    FLM$MOVE
        20 002675   002677 702000 20                 TSX2    s:25123
        20 002676   002705 710000 20                 TRA     s:25126

     1178    25122    6                WHENALTRETURN DO;

     1179    25123    6                  IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR

  25123 20 002677   000004 236000 xsym               LDQ     FPT_EXIT+4
        20 002700   777000 376003                    ANQ     -512,DU
        20 002701   002000 116003                    CMPQ    1024,DU
        20 002702   002705 603000 20                 TRC     s:25126

     1180    25124    6                   THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;

  25124 20 002703   002000 236003                    LDQ     1024,DU
        20 002704   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

     1181    25125    6                  END;

     1182    25126    5               CALL FLI$STATS;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:232  
  25126 20 002705   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 002706   000000 701000 xent               TSX1    FLI$STATS
        20 002707   000000 011000                    NOP     0

     1183    25127    5               END;

     1184    25128    4            END;

  25128 20 002710   003553 710000 20                 TRA     JUSTRET

     1185    25129
     1186    25130    3       CASE( %REWIND );

     1187    25131    3         IF COMMAND_ERROR THEN RETURN;

  25131 20 002711   000000 234000 xsym               SZN     COMMAND_ERROR
        20 002712   002715 605000 20                 TPL     s:25132

  25131 20 002713   200010 221300                    LDX1  ! TEMP$+1,,AUTO
        20 002714   000001 702211                    TSX2  ! 1,X1

     1188    25132    3         CALL FLI$DISMNT_TAPES( SOURCE_TAPE_SNLIST$, %PTV# );

  25132 20 002715   000042 630400 21                 EPPR0   34
        20 002716   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 002717   000000 701000 xent               TSX1    FLI$DISMNT_TAPES
        20 002720   000000 011000                    NOP     0
        20 002721   003553 710000 20                 TRA     JUSTRET

     1189    25133
     1190    25134    3       CASE( %REMOVE );

     1191    25135    3         IF COMMAND_ERROR THEN RETURN;

  25135 20 002722   000000 234000 xsym               SZN     COMMAND_ERROR
        20 002723   002726 605000 20                 TPL     s:25136

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:233  
  25135 20 002724   200010 221300                    LDX1  ! TEMP$+1,,AUTO
        20 002725   000001 702211                    TSX2  ! 1,X1

     1192    25136    3         CALL FLI$DISMNT_TAPES( SOURCE_TAPE_SNLIST$, %REM# );

  25136 20 002726   000044 630400 21                 EPPR0   36
        20 002727   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 002730   000000 701000 xent               TSX1    FLI$DISMNT_TAPES
        20 002731   000000 011000                    NOP     0
        20 002732   003553 710000 20                 TRA     JUSTRET

     1193    25137
     1194    25138    3       CASE( %MOUNT );

     1195    25139    3         IF COMMAND_ERROR THEN RETURN;

  25139 20 002733   000000 234000 xsym               SZN     COMMAND_ERROR
        20 002734   002737 605000 20                 TPL     s:25140

  25139 20 002735   200010 221300                    LDX1  ! TEMP$+1,,AUTO
        20 002736   000001 702211                    TSX2  ! 1,X1

     1196    25140    3         TAPE_OPEN.V.OPER.MNTONLY# = %YES#;

  25140 20 002737   001000 236007                    LDQ     512,DL
        20 002740   000044 256000 xsym               ORSQ    TAPE_OPEN+36

     1197    25141    3         TAPE_OPEN.V.DCB# = DCBNUM(M$TAPE00);

  25141 20 002741   000000 236007 xsym               LDQ     M$TAPE00,DL
        20 002742   000000 620006                    EAX0    0,QL
        20 002743   000044 740000 xsym               STX0    TAPE_OPEN+36

     1198    25142    3         BREAK_DCB# = DCBNUM(M$TAPE00);

  25142 20 002744   000000 236007 xsym               LDQ     M$TAPE00,DL
        20 002745   000156 756000 2                  STQ     BREAK_DCB#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:234  

     1199    25143    3         BREAK_CONTINUED = '1'B;

  25143 20 002746   400000 236003                    LDQ     -131072,DU
        20 002747   000155 756000 2                  STQ     BREAK_CONTINUED

     1200    25144    4         DO WHILE( BREAK_CONTINUED );

  25144 20 002750   000155 234000 2                  SZN     BREAK_CONTINUED
        20 002751   002777 605000 20                 TPL     s:25155

     1201    25145    4            BREAK_CONTINUED = '0'B;

  25145 20 002752   000155 450000 2                  STZ     BREAK_CONTINUED

     1202    25146    4            CALL M$OPEN( TAPE_OPEN )

  25146 20 002753   000000 630400 xsym               EPPR0   TAPE_OPEN
        20 002754   450000 713400                    CLIMB   alt,open
        20 002755   410400 401760                    pmme    nvectors=18
        20 002756   002760 702000 20                 TSX2    s:25148
        20 002757   002775 710000 20                 TRA     s:25154

     1203    25147    5             WHENALTRETURN DO;

     1204    25148    5               CALL FLI$RPT_ERR;

  25148 20 002760   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 002761   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 002762   000000 011000                    NOP     0

     1205    25149    5               IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$MNTBRK

  25149 20 002763   000000 470400 xsym               LDP0    B$TCB$
        20 002764   000000 471500                    LDP1    0,,PR0
        20 002765   100102 236100                    LDQ     66,,PR1
        20 002766   377770 376007                    ANQ     131064,DL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:235  
        20 002767   012200 116007                    CMPQ    5248,DL
        20 002770   002773 601000 20                 TNZ     s:25152
        20 002771   000155 234000 2                  SZN     BREAK_CONTINUED
        20 002772   002775 604000 20                 TMI     s:25154

     1206    25150    5                 AND BREAK_CONTINUED
     1207    25151    5                THEN ;
     1208    25152    5                ELSE COMMAND_ERROR = '1'B;

  25152 20 002773   400000 236003                    LDQ     -131072,DU
        20 002774   000000 756000 xsym               STQ     COMMAND_ERROR

     1209    25153    5               END;

     1210    25154    4            END;

  25154 20 002775   000155 234000 2                  SZN     BREAK_CONTINUED
        20 002776   002752 604000 20                 TMI     s:25145

     1211    25155    3         TAPE_OPEN.V.INITZ.SCRUB# = '0'B;

  25155 20 002777   000046 236000 21                 LDQ     38
        20 003000   000044 356000 xsym               ANSQ    TAPE_OPEN+36
        20 003001   003553 710000 20                 TRA     JUSTRET

     1212    25156
     1213    25157    3       CASE( %REBUILD );

     1214    25158
     1215    25159    3         OVER_FIL = '1'B;

  25159 20 003002   400000 236003                    LDQ     -131072,DU
        20 003003   000000 756000 xsym               STQ     OVER_FIL

     1216    25160    3         TAPE_OPTION.PROTTYPE = %UNPROTECTED;

  25160 20 003004   200000 236003                    LDQ     65536,DU
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:236  
        20 003005   000001 756000 xsym               STQ     TAPE_OPTION+1

     1217    25161    3         DISK_DEST_EXIST = %NEWFILE#;

  25161 20 003006   000003 235007                    LDA     3,DL
        20 003007   000000 755000 xsym               STA     DISK_DEST_EXIST

     1218    25162
     1219    25163        /***
     1220    25164         *** Copy :BACKUP file from the specified tape,fid or packset being restored to
     1221    25165         *** the *:BACKUP file on disk. If non-existant, terminate the rebuild process.
     1222    25166         ***/
     1223    25167    3         CALL FLB_READ_BACKUP ALTRET(REBUILD_ERR10);

  25167 20 003010   014354 701000 20                 TSX1    FLB_READ_BACKUP
        20 003011   003503 702000 20                 TSX2    REBUILD_ERR10

     1224    25168    3         TAPE_FSN = 0;

  25168 20 003012   200015 450100                    STZ     TAPE_FSN,,AUTO

     1225    25169
     1226    25170        /***
     1227    25171         *** Determine if this is a rebuild continuation due to an interruption
     1228    25172         *** while a rebuild was in progress (system crash or tape errors), or
     1229    25173         *** a new rebuild. Determination is based upon whether :REBUILD exists in $$EFT.
     1230    25174         *** If a continuation, obtain required data from :REBUILD.
     1231    25175         ***/
     1232    25176    3         OPEN_REBUILD.V.FUN# = %UPDATE#;

  25176 20 003013   001000 236007                    LDQ     512,DL
        20 003014   000045 552010 xsym               STBQ    OPEN_REBUILD+37,'10'O

     1233    25177    3         CALL M$OPEN( OPEN_REBUILD )

  25177 20 003015   000000 630400 xsym               EPPR0   OPEN_REBUILD
        20 003016   450000 713400                    CLIMB   alt,open
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:237  
        20 003017   410400 401760                    pmme    nvectors=18
        20 003020   003120 702000 20                 TSX2    s:25197

     1234    25178    4          WHENRETURN DO;

     1235    25179    4            NEW_REBUILD = '0'B;            /* Continued rebuild                  */

  25179 20 003021   200020 450100                    STZ     NEW_REBUILD,,AUTO

     1236    25180    4            CALL FLI$RPT_ERR(E_REBUILD_CONTINUE); /* Inform user of continuation */

  25180 20 003022   000047 630400 21                 EPPR0   39
        20 003023   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 003024   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 003025   000000 011000                    NOP     0

     1237    25181    4            READ_REBUILD.KEY_ = VECTOR(REBUILD_KEY);

  25181 20 003026   000000 236000 xsym               LDQ     REBUILD_KEY
        20 003027   000033 772000                    QRL     27
        20 003030   000001 620006                    EAX0    1,QL
        20 003031   000000 635010                    EAA     0,X0
        20 003032   000002 771000                    ARL     2
        20 003033   000140 135007                    SBLA    96,DL
        20 003034   000050 236000 21                 LDQ     40
        20 003035   000002 757000 xsym               STAQ    READ_REBUILD+2

     1238    25182    4            CALL M$READ ( READ_REBUILD ) ALTRET(REBUILD_ERR);

  25182 20 003036   000000 630400 xsym               EPPR0   READ_REBUILD
        20 003037   440000 713400                    CLIMB   alt,read
        20 003040   401400 401760                    pmme    nvectors=4
        20 003041   003500 702000 20                 TSX2    REBUILD_ERR

     1239    25183    4            DISK_FILE_SPEC.NBR = 1;

  25183 20 003042   000001 235007                    LDA     1,DL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:238  
        20 003043   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 003044   000000 755100                    STA     0,,PR0

     1240    25184    4            DISK_FILE_SPEC.SPEC.START.ACCT.ACCT#(0) = REBUILD_BUF.START.ACCT.ACCT#;

  25184 20 003045   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 003046   040100 100400                    MLR     fill='040'O
        20 003047   000000 000010 xsym               ADSC9   REBUILD_BUF              cn=0,n=8
        20 003050   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8

     1241    25185    4            DISK_FILE_SPEC.SPEC.START.FILE.L#(0) = REBUILD_BUF.START.FILE.L#;

  25185 20 003051   000002 236000 xsym               LDQ     REBUILD_BUF+2
        20 003052   000033 772000                    QRL     27
        20 003053   000017 552104                    STBQ    15,'04'O,PR0

     1242    25186    4            DISK_FILE_SPEC.SPEC.START.FILE.NAME#(0) = REBUILD_BUF.START.FILE.NAME#;

  25186 20 003054   040100 100400                    MLR     fill='040'O
        20 003055   000002 200037 xsym               ADSC9   REBUILD_BUF+2            cn=1,n=31
        20 003056   000010 000037                    ADSC9   8,,PR0                   cn=0,n=31

     1243    25187    4            TAPE_OPEN.V.VOL# = REBUILD_BUF.VOLUME;

  25187 20 003057   000014 236000 xsym               LDQ     REBUILD_BUF+12
        20 003060   000061 552040 xsym               STBQ    TAPE_OPEN+49,'40'O

     1244    25188    4            TAPE_OPEN.V.FSN# = REBUILD_BUF.FSN;

  25188 20 003061   000013 720000 xsym               LXL0    REBUILD_BUF+11
        20 003062   000066 740000 xsym               STX0    TAPE_OPEN+54

     1245    25189    4            TAPE_FSN = REBUILD_BUF.FSN;

  25189 20 003063   000013 236000 xsym               LDQ     REBUILD_BUF+11
        20 003064   777777 376007                    ANQ     -1,DL
        20 003065   200015 756100                    STQ     TAPE_FSN,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:239  

     1246    25190    4            TAPE_OPEN.V.DENSITY# = REBUILD_BUF.DEN;

  25190 20 003066   000014 236000 xsym               LDQ     REBUILD_BUF+12
        20 003067   000770 376003                    ANQ     504,DU
        20 003070   000025 772000                    QRL     21
        20 003071   000066 552004 xsym               STBQ    TAPE_OPEN+54,'04'O

     1247    25191    4            TAPE_OPEN.V.IOERROK# = REBUILD_BUF.IOERRORC;

  25191 20 003072   000014 236000 xsym               LDQ     REBUILD_BUF+12
        20 003073   000001 376003                    ANQ     1,DU
        20 003074   000012 736000                    QLS     10
        20 003075   000060 676000 xsym               ERQ     TAPE_OPEN+48
        20 003076   003000 376003                    ANQ     1536,DU
        20 003077   000060 656000 xsym               ERSQ    TAPE_OPEN+48

     1248    25192    4            DISK_OPTION.PAD = REBUILD_BUF.PAD;

  25192 20 003100   000014 236000 xsym               LDQ     REBUILD_BUF+12
        20 003101   000014 736000                    QLS     12
        20 003102   000000 676000 xsym               ERQ     DISK_OPTION
        20 003103   020000 376003                    ANQ     8192,DU
        20 003104   000000 656000 xsym               ERSQ    DISK_OPTION

     1249    25193    4            DISK_OPTION.DIR = REBUILD_BUF.DIR;

  25193 20 003105   000014 236000 xsym               LDQ     REBUILD_BUF+12
        20 003106   000017 736000                    QLS     15
        20 003107   000000 676000 xsym               ERQ     DISK_OPTION
        20 003110   400000 376003                    ANQ     -131072,DU
        20 003111   000000 656000 xsym               ERSQ    DISK_OPTION

     1250    25194    4            TAPE_OPTION.IOERRORC = REBUILD_BUF.IOERRORC;

  25194 20 003112   000014 236000 xsym               LDQ     REBUILD_BUF+12
        20 003113   000014 736000                    QLS     12
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:240  
        20 003114   000002 676000 xsym               ERQ     TAPE_OPTION+2
        20 003115   010000 376003                    ANQ     4096,DU
        20 003116   000002 656000 xsym               ERSQ    TAPE_OPTION+2

     1251    25195    4            END;

  25195 20 003117   003171 710000 20                 TRA     s:25218

     1252    25196    4          WHENALTRETURN DO;

     1253    25197    4            NEW_REBUILD = '1'B;            /* Brand new rebuild                  */

  25197 20 003120   400000 236003                    LDQ     -131072,DU
        20 003121   200020 756100                    STQ     NEW_REBUILD,,AUTO

     1254    25198    4            OPEN_REBUILD.V.EXIST# = %NEWFILE#;

  25198 20 003122   000600 236007                    LDQ     384,DL
        20 003123   000044 256000 xsym               ORSQ    OPEN_REBUILD+36

     1255    25199    4            OPEN_REBUILD.V.FUN# = %CREATE#;

  25199 20 003124   003000 236007                    LDQ     1536,DL
        20 003125   000045 552010 xsym               STBQ    OPEN_REBUILD+37,'10'O

     1256    25200    4            OPEN_REBUILD.V.EXPIRE# = %NEVER#;

  25200 20 003126   000001 335007                    LCA     1,DL
        20 003127   000057 755000 xsym               STA     OPEN_REBUILD+47

     1257    25201    4            CALL M$OPEN( OPEN_REBUILD )    /* Create :REBUILD                    */

  25201 20 003130   000000 630400 xsym               EPPR0   OPEN_REBUILD
        20 003131   450000 713400                    CLIMB   alt,open
        20 003132   410400 401760                    pmme    nvectors=18
        20 003133   003135 702000 20                 TSX2    s:25203
        20 003134   003155 710000 20                 TRA     s:25212
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:241  

     1258    25202    5             WHENALTRETURN DO;

     1259    25203    5               IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$NONEWFD

  25203 20 003135   000000 470400 xsym               LDP0    B$TCB$
        20 003136   000000 471500                    LDP1    0,,PR0
        20 003137   100102 236100                    LDQ     66,,PR1
        20 003140   377770 376007                    ANQ     131064,DL
        20 003141   001760 116007                    CMPQ    1008,DL
        20 003142   003154 601000 20                 TNZ     s:25209

     1260    25204    6                THEN DO;                   /* Create $$EFT account               */

     1261    25205    6                  CALL FLI$BUILD_$$EFT( REBUILD_SN.SN#(0) ) ALTRET(REBUILD_ERR);

  25205 20 003143   000051 630400 21                 EPPR0   41
        20 003144   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 003145   000000 701000 xent               TSX1    FLI$BUILD_$$EFT
        20 003146   003500 702000 20                 TSX2    REBUILD_ERR

     1262    25206    6                  CALL M$OPEN( OPEN_REBUILD ) ALTRET(REBUILD_ERR);
             25206                           /* Create :REBUILD */

  25206 20 003147   000000 630400 xsym               EPPR0   OPEN_REBUILD
        20 003150   450000 713400                    CLIMB   alt,open
        20 003151   410400 401760                    pmme    nvectors=18
        20 003152   003500 702000 20                 TSX2    REBUILD_ERR

     1263    25207    6                  END;

  25207 20 003153   003155 710000 20                 TRA     s:25212

     1264    25208    6                ELSE DO;

     1265    25209    6                  GOTO REBUILD_ERR;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:242  
  25209 20 003154   003500 710000 20                 TRA     REBUILD_ERR

     1266    25210    6                  END;
     1267    25211    5               END;
     1268    25212    4            CLOSE_REBUILD.V.DISP# = %SAVE#;

  25212 20 003155   000002 236007                    LDQ     2,DL
        20 003156   000032 552004 xsym               STBQ    CLOSE_REBUILD+26,'04'O

     1269    25213    4            CALL M$CLOSE( CLOSE_REBUILD ) ALTRET(REBUILD_ERR);

  25213 20 003157   000000 630400 xsym               EPPR0   CLOSE_REBUILD
        20 003160   450001 713400                    CLIMB   alt,close
        20 003161   406000 401760                    pmme    nvectors=13
        20 003162   003500 702000 20                 TSX2    REBUILD_ERR

     1270    25214    4            OPEN_REBUILD.V.FUN# = %UPDATE#; /* :REBUILD expected to be open      */

  25214 20 003163   001000 236007                    LDQ     512,DL
        20 003164   000045 552010 xsym               STBQ    OPEN_REBUILD+37,'10'O

     1271    25215    4            CALL M$OPEN( OPEN_REBUILD ) ALTRET(REBUILD_ERR);

  25215 20 003165   000000 630400 xsym               EPPR0   OPEN_REBUILD
        20 003166   450000 713400                    CLIMB   alt,open
        20 003167   410400 401760                    pmme    nvectors=18
        20 003170   003500 702000 20                 TSX2    REBUILD_ERR

     1272    25216    4            END;

     1273    25217
     1274    25218    3         READ_REBUILD.KEY_ = VECTOR(REBUILD_DIR_KEY);

  25218 20 003171   000000 236000 xsym               LDQ     REBUILD_DIR_KEY
        20 003172   000033 772000                    QRL     27
        20 003173   000001 620006                    EAX0    1,QL
        20 003174   000000 635010                    EAA     0,X0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:243  
        20 003175   000002 771000                    ARL     2
        20 003176   000140 135007                    SBLA    96,DL
        20 003177   000052 236000 21                 LDQ     42
        20 003200   000002 757000 xsym               STAQ    READ_REBUILD+2

     1275    25219    3         TAPE_DENSITY = TAPE_OPEN.V.DENSITY#; /* Save option setting - DEN       */

  25219 20 003201   000066 236000 xsym               LDQ     TAPE_OPEN+54
        20 003202   000777 376007                    ANQ     511,DL
        20 003203   200016 756100                    STQ     TAPE_DENSITY,,AUTO

     1276    25220    3         TAPE_IOERROK = TAPE_OPEN.V.IOERROK#; /* Save option setting - IOERROK   */

  25220 20 003204   000060 236000 xsym               LDQ     TAPE_OPEN+48
        20 003205   000007 736000                    QLS     7
        20 003206   400000 376003                    ANQ     -131072,DU
        20 003207   200017 756100                    STQ     TAPE_IOERROK,,AUTO

     1277    25221        /***
     1278    25222         *** Read *:BACKUP record 0 to obtain number of runs - save and backups performed.
     1279    25223         ***/
     1280    25224
     1281    25225    3         OPEN_BACKUP_TEMP.V.FUN# = %IN#;

  25225 20 003210   002000 236007                    LDQ     1024,DL
        20 003211   002155 552010 2                  STBQ    OPEN_BACKUP_TEMP+37,'10'O

     1282    25226    3         CALL M$OPEN( OPEN_BACKUP_TEMP ) ALTRET(REBUILD_ERR);

  25226 20 003212   002110 630400 2                  EPPR0   OPEN_BACKUP_TEMP
        20 003213   450000 713400                    CLIMB   alt,open
        20 003214   410400 401760                    pmme    nvectors=18
        20 003215   003500 702000 20                 TSX2    REBUILD_ERR

     1283    25227    3         READ_BACKUP_TEMP.V.KEYS# = '0'B;

  25227 20 003216   000053 236000 21                 LDQ     43
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:244  
        20 003217   002216 356000 2                  ANSQ    READ_BACKUP_TEMP+8

     1284    25228    3         CALL M$READ( READ_BACKUP_TEMP ) ALTRET(REBUILD_ERR);

  25228 20 003220   002206 630400 2                  EPPR0   READ_BACKUP_TEMP
        20 003221   440000 713400                    CLIMB   alt,read
        20 003222   401400 401760                    pmme    nvectors=4
        20 003223   003500 702000 20                 TSX2    REBUILD_ERR

     1285    25229    3         NBR_RUNS = TSN_USED_BUF.UTS;      /* Number of runs                     */

  25229 20 003224   000000 235000 xsym               LDA     TSN_USED_BUF
        20 003225   200014 755100                    STA     NBR_RUNS,,AUTO

     1286    25230
     1287    25231        /***
     1288    25232         *** Read *:BACKUP records for each run to obtain tape serial numbers and restore.
     1289    25233         *** Run 1=save run; run 2-n = backup runs.
     1290    25234         ***/
     1291    25235    4         DO I = 1 TO NBR_RUNS;

  25235 20 003226   000001 236007                    LDQ     1,DL
        20 003227   000213 756000 2                  STQ     I
        20 003230   003440 710000 20                 TRA     s:25300+1

     1292    25236    4            CALL M$READ( READ_BACKUP_TEMP ) ALTRET(REBUILD_ERR);

  25236 20 003231   002206 630400 2                  EPPR0   READ_BACKUP_TEMP
        20 003232   440000 713400                    CLIMB   alt,read
        20 003233   401400 401760                    pmme    nvectors=4
        20 003234   003500 702000 20                 TSX2    REBUILD_ERR

     1293    25237    4            IF TSN_USED_BUF.BACKUP_FSN ~= 0 /* Get FSN for last file to process  */

  25237 20 003235   000007 220000 xsym               LDX0    TSN_USED_BUF+7
        20 003236   003243 600000 20                 TZE     s:25239

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:245  
     1294    25238    4             THEN LAST_TAPE_FSN = TSN_USED_BUF.BACKUP_FSN; /* Eliminate test after */

  25238 20 003237   000007 235000 xsym               LDA     TSN_USED_BUF+7
        20 003240   000022 771000                    ARL     18
        20 003241   000000 755000 xsym               STA     LAST_TAPE_FSN
        20 003242   003247 710000 20                 TRA     s:25241

     1295    25239    4             ELSE LAST_TAPE_FSN = TSN_USED_BUF.FSN + 1; /* E03. Should never = 0 */

  25239 20 003243   000006 236000 xsym               LDQ     TSN_USED_BUF+6
        20 003244   777777 376007                    ANQ     -1,DL
        20 003245   000001 036007                    ADLQ    1,DL
        20 003246   000000 756000 xsym               STQ     LAST_TAPE_FSN

     1296    25240
     1297    25241    4            CALL FLB_BUILD_SNLIST; /* Create serial number list for current run  */

  25241 20 003247   014215 701000 20                 TSX1    FLB_BUILD_SNLIST
        20 003250   000000 011000                    NOP     0

     1298    25242        /***
     1299    25243         *** Remove :BACKUP file source tape or last tape from previous run if not
     1300    25244         *** required as the first tape for this run.
     1301    25245         ***/
     1302    25246    4            IF (SOURCE_TAPE_SNLIST$ ~= ADDR(NIL))

  25246 20 003251   000230 236000 2                  LDQ     SOURCE_TAPE_SNLIST$
        20 003252   000001 116000 xsym               CMPQ    B_VECTNIL+1
        20 003253   003311 600000 20                 TZE     s:25264
        20 003254   000000 470400 xsym               LDP0    LAST_SNLISTINFO$
        20 003255   000000 471500                    LDP1    0,,PR0
        20 003256   000000 473400 xsym               LDP3    M$TAPE00$
        20 003257   040100 106500                    CMPC    fill='040'O
        20 003260   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
        20 003261   100001 000006                    ADSC9   1,,PR1                   cn=0,n=6
        20 003262   003311 600000 20                 TZE     s:25264

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:246  
     1303    25247    4              AND (M$TAPE00$->F$DCB.PSN# ~= SNLISTINFO.SNLIST$->VLP_SN.SN#(0))
     1304    25248    5             THEN DO;

     1305    25249    5               FPT_REM.V.DISP# = %REM#;

  25249 20 003263   002000 236003                    LDQ     1024,DU
        20 003264   001512 552040 2                  STBQ    FPT_REM+2,'40'O

     1306    25250    5               FPT_REM.V.PSN# = M$TAPE00$->F$DCB.PSN#;

  25250 20 003265   040000 100500                    MLR     fill='040'O
        20 003266   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
        20 003267   001512 400006 2                  ADSC9   FPT_REM+2                cn=2,n=6

     1307    25251    5               CALL M$REM ( FPT_REM )

  25251 20 003270   001510 630400 2                  EPPR0   FPT_REM
        20 003271   460006 713400                    CLIMB   alt,+24582
        20 003272   400000 401760                    pmme    nvectors=1
        20 003273   003275 702000 20                 TSX2    s:25254
        20 003274   003275 710000 20                 TRA     s:25254

     1308    25252    6                WHENALTRETURN DO;

     1309    25253    6                  END;

     1310    25254    5               TAPE_FSN = 0;               /* New tape                           */

  25254 20 003275   200015 450100                    STZ     TAPE_FSN,,AUTO

     1311    25255    5               CALL FLB_SET_TAPE_DEFAULTS( TAPE_DENSITY,TAPE_FSN ,

  25255 20 003276   200017 630500                    EPPR0   TAPE_IOERROK,,AUTO
        20 003277   200032 450500                    STP0    FIRST+1,,AUTO
        20 003300   000054 236000 21                 LDQ     44
        20 003301   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 003302   200015 631500                    EPPR1   TAPE_FSN,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:247  
        20 003303   200030 451500                    STP1    DCB#+1,,AUTO
        20 003304   200016 633500                    EPPR3   TAPE_DENSITY,,AUTO
        20 003305   200027 453500                    STP3    NEW_REBUILD+7,,AUTO
        20 003306   014101 701000 20                 TSX1    FLB_SET_TAPE_DEFAULTS
        20 003307   000000 011000                    NOP     0

     1312    25256    5                 LAST_TAPE_FSN, TAPE_IOERROK );
     1313    25257    5               END;

  25257 20 003310   003351 710000 20                 TRA     s:25277

     1314    25258    5             ELSE DO;

     1315    25259        /***
     1316    25260         *** If :BACKUP was read from tape or fid for 1st run, start with FSN 0 (first
     1317    25261         *** tape to be proc.). Otherwise incr. FSN for processing next tape in sequence
     1318    25262         *** such as for a backup run.
     1319    25263        */
     1320    25264    5               IF (SOURCE_TAPE_SNLIST$ ~= ADDR(NIL))

  25264 20 003311   000001 116000 xsym               CMPQ    B_VECTNIL+1
        20 003312   003336 600000 20                 TZE     s:25272

     1321    25265    6                THEN DO;

     1322    25266    6                  IF I ~= 1

  25266 20 003313   000213 235000 2                  LDA     I
        20 003314   000001 115007                    CMPA    1,DL
        20 003315   003323 600000 20                 TZE     s:25268

     1323    25267    6                   THEN TAPE_FSN = M$TAPE00$->F$DCB.FSN# + 1; /* Backup run      */

  25267 20 003316   000000 470400 xsym               LDP0    M$TAPE00$
        20 003317   000034 236100                    LDQ     28,,PR0
        20 003320   000022 772000                    QRL     18
        20 003321   000001 036007                    ADLQ    1,DL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:248  
        20 003322   200015 756100                    STQ     TAPE_FSN,,AUTO

     1324    25268    6                  CALL FLB_SET_TAPE_DEFAULTS( TAPE_DENSITY,TAPE_FSN,

  25268 20 003323   200017 630500                    EPPR0   TAPE_IOERROK,,AUTO
        20 003324   200032 450500                    STP0    FIRST+1,,AUTO
        20 003325   000054 236000 21                 LDQ     44
        20 003326   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 003327   200015 631500                    EPPR1   TAPE_FSN,,AUTO
        20 003330   200030 451500                    STP1    DCB#+1,,AUTO
        20 003331   200016 633500                    EPPR3   TAPE_DENSITY,,AUTO
        20 003332   200027 453500                    STP3    NEW_REBUILD+7,,AUTO
        20 003333   014101 701000 20                 TSX1    FLB_SET_TAPE_DEFAULTS
        20 003334   000000 011000                    NOP     0

     1325    25269    6                    LAST_TAPE_FSN, TAPE_IOERROK );
     1326    25270    6                  END;

  25270 20 003335   003351 710000 20                 TRA     s:25277

     1327    25271    6                ELSE DO;                   /* :BACKUP read from fid              */

     1328    25272    6                  TAPE_FSN = 0;

  25272 20 003336   200015 450100                    STZ     TAPE_FSN,,AUTO

     1329    25273    6                  CALL FLB_SET_TAPE_DEFAULTS( TAPE_DENSITY,TAPE_FSN,

  25273 20 003337   200017 630500                    EPPR0   TAPE_IOERROK,,AUTO
        20 003340   200032 450500                    STP0    FIRST+1,,AUTO
        20 003341   000054 236000 21                 LDQ     44
        20 003342   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 003343   200015 631500                    EPPR1   TAPE_FSN,,AUTO
        20 003344   200030 451500                    STP1    DCB#+1,,AUTO
        20 003345   200016 633500                    EPPR3   TAPE_DENSITY,,AUTO
        20 003346   200027 453500                    STP3    NEW_REBUILD+7,,AUTO
        20 003347   014101 701000 20                 TSX1    FLB_SET_TAPE_DEFAULTS
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:249  
        20 003350   000000 011000                    NOP     0

     1330    25274    6                    LAST_TAPE_FSN, TAPE_IOERROK );
     1331    25275    6                  END;

     1332    25276    5               END;

     1333    25277    4            SOURCE_TAPE_SNLIST$ = SNLISTINFO.SNLIST$;

  25277 20 003351   000000 470400 xsym               LDP0    LAST_SNLISTINFO$
        20 003352   000000 236100                    LDQ     0,,PR0
        20 003353   000230 756000 2                  STQ     SOURCE_TAPE_SNLIST$

     1334    25278    4            TVECTOR = VECTOR(SOURCE_TAPE_SNLIST$->VLP_SN);

  25278 20 003354   000033 235000 21                 LDA     27
        20 003355   000000 757000 xsym               STAQ    TVECTOR

     1335    25279    4            TVECTOR.W1.VSIZE# = LENGTHV(VLP_SN.NUM#)

  25279 20 003356   000230 471400 2                  LDP1    SOURCE_TAPE_SNLIST$
        20 003357   100000 236100                    LDQ     0,,PR1
        20 003360   000006 402007                    MPY     6,DL
        20 003361   000003 036007                    ADLQ    3,DL
        20 003362   000020 736000                    QLS     16
        20 003363   000000 676000 xsym               ERQ     TVECTOR
        20 003364   000034 376000 xsym               ANQ     B_VECTNIL+28
        20 003365   000000 656000 xsym               ERSQ    TVECTOR

     1336    25280    4              + SOURCE_TAPE_SNLIST$->VLP_SN.NUM# * LENGTHC(VLP_SN.SN#(0));
     1337    25281    4            TAPE_OPEN.SN_ = TVECTOR;

  25281 20 003366   000000 237000 xsym               LDAQ    TVECTOR
        20 003367   000002 757000 xsym               STAQ    TAPE_OPEN+2

     1338    25282    4            LAST_SNLISTINFO$ = ADDR(NIL);

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:250  
  25282 20 003370   000001 236000 xsym               LDQ     B_VECTNIL+1
        20 003371   000000 756000 xsym               STQ     LAST_SNLISTINFO$

     1339    25283    4            NBR_SNLISTS = 0;

  25283 20 003372   000000 450000 xsym               STZ     NBR_SNLISTS

     1340    25284
     1341    25285    4            CALL FLM$MOVE( %REBUILD )      /* Restore current run                */

  25285 20 003373   000056 630400 21                 EPPR0   46
        20 003374   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 003375   000000 701000 xent               TSX1    FLM$MOVE
        20 003376   003400 702000 20                 TSX2    s:25287
        20 003377   003437 710000 20                 TRA     s:25300

     1342    25286    5             WHENALTRETURN DO;

     1343    25287    5               IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR

  25287 20 003400   000004 236000 xsym               LDQ     FPT_EXIT+4
        20 003401   777000 376003                    ANQ     -512,DU
        20 003402   002000 116003                    CMPQ    1024,DU
        20 003403   003406 603000 20                 TRC     s:25289

     1344    25288    5                THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;

  25288 20 003404   002000 236003                    LDQ     1024,DU
        20 003405   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

     1345    25289    5               FPT_REM.V.DISP# = %PTV#;

  25289 20 003406   004000 236003                    LDQ     2048,DU
        20 003407   001512 552040 2                  STBQ    FPT_REM+2,'40'O

     1346    25290    5               FPT_REM.V.PSN# = DCBADDR(DCBNUM(M$TAPE00))->F$DCB.PSN#;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:251  
  25290 20 003410   000000 236007 xsym               LDQ     M$TAPE00,DL
        20 003411   000000 470400 21                 LDP0    0
        20 003412   000000 471500                    LDP1    0,,PR0
        20 003413   100000 473506                    LDP3    0,QL,PR1
        20 003414   040000 100500                    MLR     fill='040'O
        20 003415   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
        20 003416   001512 400006 2                  ADSC9   FPT_REM+2                cn=2,n=6

     1347    25291    5               CALL M$REM( FPT_REM )

  25291 20 003417   001510 630400 2                  EPPR0   FPT_REM
        20 003420   460006 713400                    CLIMB   alt,+24582
        20 003421   400000 401760                    pmme    nvectors=1
        20 003422   003424 702000 20                 TSX2    s:25294
        20 003423   003424 710000 20                 TRA     s:25294

     1348    25292    6                WHENALTRETURN DO;

     1349    25293    6                  END;

     1350    25294    5               CLOSE_BACKUP_TEMP.V.DISP# = %RELEASE#; /* Delete *:BACKUP file    */

  25294 20 003424   000001 236007                    LDQ     1,DL
        20 003425   002272 552004 2                  STBQ    CLOSE_BACKUP_TEMP+26,'04'O

     1351    25295    5               CALL M$CLOSE( CLOSE_BACKUP_TEMP ) ALTRET(REBUILD_ERR);

  25295 20 003426   002240 630400 2                  EPPR0   CLOSE_BACKUP_TEMP
        20 003427   450001 713400                    CLIMB   alt,close
        20 003430   406000 401760                    pmme    nvectors=13
        20 003431   003500 702000 20                 TSX2    REBUILD_ERR

     1352    25296    5               CALL FLI$STATS;

  25296 20 003432   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 003433   000000 701000 xent               TSX1    FLI$STATS
        20 003434   000000 011000                    NOP     0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:252  

     1353    25297    5               RETURN;                     /* Problem - terminate rebuild        */

  25297 20 003435   200010 221300                    LDX1  ! TEMP$+1,,AUTO
        20 003436   000001 702211                    TSX2  ! 1,X1

     1354    25298    5               END;
     1355    25299
     1356    25300    4            END;                           /* Rebuild loop end                   */

  25300 20 003437   000213 054000 2                  AOS     I
        20 003440   200014 236100                    LDQ     NBR_RUNS,,AUTO
        20 003441   003231 604000 20                 TMI     s:25236
        20 003442   000213 116000 2                  CMPQ    I
        20 003443   003231 605000 20                 TPL     s:25236

     1357    25301
     1358    25302
     1359    25303    3         FPT_REM.V.DISP# = %REM#;          /* Remove last tape used              */

  25303 20 003444   002000 236003                    LDQ     1024,DU
        20 003445   001512 552040 2                  STBQ    FPT_REM+2,'40'O

     1360    25304    3         FPT_REM.V.PSN# = M$TAPE00$->F$DCB.PSN#;

  25304 20 003446   000000 470400 xsym               LDP0    M$TAPE00$
        20 003447   040000 100500                    MLR     fill='040'O
        20 003450   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
        20 003451   001512 400006 2                  ADSC9   FPT_REM+2                cn=2,n=6

     1361    25305    3         CALL M$REM( FPT_REM )

  25305 20 003452   001510 630400 2                  EPPR0   FPT_REM
        20 003453   460006 713400                    CLIMB   alt,+24582
        20 003454   400000 401760                    pmme    nvectors=1
        20 003455   003457 702000 20                 TSX2    s:25309
        20 003456   003457 710000 20                 TRA     s:25309
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:253  

     1362    25306    4          WHENALTRETURN DO;

     1363    25307    4            END;

     1364    25308
     1365    25309    3         CLOSE_BACKUP_TEMP.V.DISP# = %RELEASE#; /* Delete *:BACKUP file          */

  25309 20 003457   000001 236007                    LDQ     1,DL
        20 003460   002272 552004 2                  STBQ    CLOSE_BACKUP_TEMP+26,'04'O

     1366    25310    3         CALL M$CLOSE( CLOSE_BACKUP_TEMP ) ALTRET(REBUILD_ERR);

  25310 20 003461   002240 630400 2                  EPPR0   CLOSE_BACKUP_TEMP
        20 003462   450001 713400                    CLIMB   alt,close
        20 003463   406000 401760                    pmme    nvectors=13
        20 003464   003500 702000 20                 TSX2    REBUILD_ERR

     1367    25311        /***
     1368    25312         **** Rebuild went to completition, o.k. to delete :REBUILD.$$EFT file.
     1369    25313         ***/
     1370    25314    3         CLOSE_REBUILD.V.DISP# = %RELEASE#;

  25314 20 003465   000001 236007                    LDQ     1,DL
        20 003466   000032 552004 xsym               STBQ    CLOSE_REBUILD+26,'04'O

     1371    25315    3         CALL M$CLOSE( CLOSE_REBUILD ) ALTRET(REBUILD_ERR);

  25315 20 003467   000000 630400 xsym               EPPR0   CLOSE_REBUILD
        20 003470   450001 713400                    CLIMB   alt,close
        20 003471   406000 401760                    pmme    nvectors=13
        20 003472   003500 702000 20                 TSX2    REBUILD_ERR

     1372    25316    3         CALL FLI$STATS;

  25316 20 003473   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 003474   000000 701000 xent               TSX1    FLI$STATS
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:254  
        20 003475   000000 011000                    NOP     0

     1373    25317    3         RETURN;

  25317 20 003476   200010 221300                    LDX1  ! TEMP$+1,,AUTO
        20 003477   000001 702211                    TSX2  ! 1,X1

     1374    25318
     1375    25319    3   REBUILD_ERR:
     1376    25320    3         CALL FLI$RPT_ERR;

  25320 20 003500   000002 631400 xsym  REBUILD_ERR  EPPR1   B_VECTNIL+2
        20 003501   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 003502   000000 011000                    NOP     0

     1377    25321    3   REBUILD_ERR10:
     1378    25322    3         IF DCBADDR(DCBNUM(M$DISK00)) -> F$DCB.FCD#

  25322 20 003503   000000 236007 xsym  REBUILD_ERR* LDQ     M$DISK00,DL
        20 003504   000000 470400 21                 LDP0    0
        20 003505   000000 471500                    LDP1    0,,PR0
        20 003506   100000 473506                    LDP3    0,QL,PR1
        20 003507   300031 236100                    LDQ     25,,PR3
        20 003510   020000 316007                    CANQ    8192,DL
        20 003511   003517 600000 20                 TZE     s:25327

     1379    25323    4          THEN DO;

     1380    25324    4            CLOSE_BACKUP_TEMP.V.DISP# = %RELEASE#; /* Delete *:BACKUP            */

  25324 20 003512   000001 236007                    LDQ     1,DL
        20 003513   002272 552004 2                  STBQ    CLOSE_BACKUP_TEMP+26,'04'O

     1381    25325    4            CALL M$CLOSE(CLOSE_BACKUP_TEMP);

  25325 20 003514   002240 630400 2                  EPPR0   CLOSE_BACKUP_TEMP
        20 003515   050001 713400                    CLIMB   close
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:255  
        20 003516   406000 401760                    pmme    nvectors=13

     1382    25326    4            END;

     1383    25327    3         IF DCBADDR(DCBNUM(M$REBUILD)) -> F$DCB.FCD#

  25327 20 003517   000000 236007 xsym               LDQ     M$REBUILD,DL
        20 003520   000000 470400 21                 LDP0    0
        20 003521   000000 471500                    LDP1    0,,PR0
        20 003522   100000 473506                    LDP3    0,QL,PR1
        20 003523   300031 236100                    LDQ     25,,PR3
        20 003524   020000 316007                    CANQ    8192,DL
        20 003525   003543 600000 20                 TZE     s:25339

     1384    25328    4          THEN DO;

     1385    25329    4            IF NEW_REBUILD

  25329 20 003526   200020 234100                    SZN     NEW_REBUILD,,AUTO
        20 003527   003536 605000 20                 TPL     s:25335

     1386    25330    5             THEN DO;

     1387    25331    5               CLOSE_REBUILD.V.DISP# = %RELEASE#;

  25331 20 003530   000001 236007                    LDQ     1,DL
        20 003531   000032 552004 xsym               STBQ    CLOSE_REBUILD+26,'04'O

     1388    25332    5               CALL M$CLOSE( CLOSE_REBUILD );

  25332 20 003532   000000 630400 xsym               EPPR0   CLOSE_REBUILD
        20 003533   050001 713400                    CLIMB   close
        20 003534   406000 401760                    pmme    nvectors=13

     1389    25333    5               END;

  25333 20 003535   003543 710000 20                 TRA     s:25339
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:256  

     1390    25334    5             ELSE DO;

     1391    25335    5               CLOSE_REBUILD.V.DISP# = %SAVE#;

  25335 20 003536   000002 236007                    LDQ     2,DL
        20 003537   000032 552004 xsym               STBQ    CLOSE_REBUILD+26,'04'O

     1392    25336    5               CALL M$CLOSE( CLOSE_REBUILD );

  25336 20 003540   000000 630400 xsym               EPPR0   CLOSE_REBUILD
        20 003541   050001 713400                    CLIMB   close
        20 003542   406000 401760                    pmme    nvectors=13

     1393    25337    5               END;

     1394    25338    4            END;

     1395    25339    3         IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR

  25339 20 003543   000004 236000 xsym               LDQ     FPT_EXIT+4
        20 003544   777000 376003                    ANQ     -512,DU
        20 003545   002000 116003                    CMPQ    1024,DU
        20 003546   003551 603000 20                 TRC     s:25341

     1396    25340    3          THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;

  25340 20 003547   002000 236003                    LDQ     1024,DU
        20 003550   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

     1397    25341    3         COMMAND_ERROR = '1'B;

  25341 20 003551   400000 236003                    LDQ     -131072,DU
        20 003552   000000 756000 xsym               STQ     COMMAND_ERROR

     1398    25342
     1399    25343    3       END;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:257  

  25339 20 003553                       JUSTRET      null
     1400    25344
     1401    25345    2   JUSTRET: ;
     1402    25346    2      RETURN;

  25346 20 003553   200010 221300                    LDX1  ! TEMP$+1,,AUTO
        20 003554   000001 702211                    TSX2  ! 1,X1

     1403    25347
     1404    25348
     1405    25349    2   FLB_CREATE_RETRIEVE_CMNDS: PROC;

  25349 20 003555   200026 741300       FLB_CREATE_* STX1  ! NEW_REBUILD+6,,AUTO

     1406    25350        /*F*  NAME: FLB_CREATE_RETRIEVE_CMNDS
     1407    25351              PURPOSE: Create RETRIEVE commands for subsequent processing.
     1408    25352        ***/
     1409    25353
     1410    25354        /********************/
     1411    25355
     1412    25356    3      COMMAND_ERROR = '0'B;

  25356 20 003556   000000 450000 xsym               STZ     COMMAND_ERROR

     1413    25357    3      CALL FLB_DISK_SPEC(0)

  25357 20 003557   000032 236000 21                 LDQ     26
        20 003560   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 003561   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 003562   003640 702000 20                 TSX2    s:25380

     1414    25358    4       WHENRETURN DO;

     1415    25359    4         IF COMMAND_ERROR THEN RETURN;

  25359 20 003563   000000 234000 xsym               SZN     COMMAND_ERROR
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:258  
        20 003564   003567 605000 20                 TPL     s:25360

  25359 20 003565   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 003566   000001 702211                    TSX2  ! 1,X1

     1416    25360    4         DISK_SRCHCOND.ANYF# = '0'B;

  25360 20 003567   000057 236000 21                 LDQ     47
        20 003570   000000 356000 xsym               ANSQ    DISK_SRCHCOND

     1417    25361    4         DISK_SRCHCOND.QS# = '1'B;

  25361 20 003571   010000 236003                    LDQ     4096,DU
        20 003572   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     1418    25362    4         DISK_CRIT.DSC = '1'B;

  25362 20 003573   400000 236003                    LDQ     -131072,DU
        20 003574   000000 256000 xsym               ORSQ    DISK_CRIT

     1419    25363    4         DISK_DESC.FETCH# = '1'B;

  25363 20 003575   000010 236003                    LDQ     8,DU
        20 003576   000000 256000 xsym               ORSQ    DISK_DESC

     1420    25364    4         DISK_DESC_MASK.FETCH# = '1'B;

  25364 20 003577   000000 256000 xsym               ORSQ    DISK_DESC_MASK

     1421    25365    4         CALL FLV$VALIDATE( COMMAND ) ALTRET( JUSTCERET );

  25365 20 003600   000041 630400 21                 EPPR0   33
        20 003601   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 003602   000000 701000 xent               TSX1    FLV$VALIDATE
        20 003603   003610 702000 20                 TSX2    JUSTCERET

     1422    25366    4         CALL FLS$PROCESS_PRE_RET
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:259  

  25366 20 003604   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 003605   000000 701000 xent               TSX1    FLS$PROCESS_PRE_RET
        20 003606   003610 702000 20                 TSX2    JUSTCERET
        20 003607   003614 710000 20                 TRA     s:25372

     1423    25367    5          WHENALTRETURN DO;

  25360 20 003610                       JUSTCERET    null
     1424    25368    5   JUSTCERET:;
     1425    25369    5            COMMAND_ERROR = '1'B;

  25369 20 003610   400000 236003                    LDQ     -131072,DU
        20 003611   000000 756000 xsym               STQ     COMMAND_ERROR

     1426    25370    5            RETURN;

  25370 20 003612   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 003613   000001 702211                    TSX2  ! 1,X1

     1427    25371    5            END;
     1428    25372    4         CALL M$OPEN( RET_CMDS_OPEN )

  25372 20 003614   001534 630400 2                  EPPR0   RET_CMDS_OPEN
        20 003615   450000 713400                    CLIMB   alt,open
        20 003616   410400 401760                    pmme    nvectors=18
        20 003617   003621 702000 20                 TSX2    s:25374
        20 003620   003630 710000 20                 TRA     s:25378

     1429    25373    5          WHENALTRETURN DO;

     1430    25374    5            CALL FLI$RPT_ERR;

  25374 20 003621   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 003622   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 003623   000000 011000                    NOP     0

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:260  
     1431    25375    5            COMMAND_ERROR = '1'B;

  25375 20 003624   400000 236003                    LDQ     -131072,DU
        20 003625   000000 756000 xsym               STQ     COMMAND_ERROR

     1432    25376    5            RETURN;

  25376 20 003626   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 003627   000001 702211                    TSX2  ! 1,X1

     1433    25377    5            END;
     1434    25378    4         CALL XUR$SETDCBS( DCBNUM(M$READ_FILE) );

  25378 20 003630   000000 236007 xsym               LDQ     M$READ_FILE,DL
        20 003631   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 003632   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 003633   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 003634   200043 630500                    EPPR0   @MAX_NX+2,,AUTO
        20 003635   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 003636   000000 701000 xent               TSX1    XUR$SETDCBS
        20 003637   000000 011000                    NOP     0

     1435    25379    4         END;

     1436    25380    3      RETURN;

  25380 20 003640   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 003641   000001 702211                    TSX2  ! 1,X1

     1437    25381
     1438    25382    3   END FLB_CREATE_RETRIEVE_CMNDS;
     1439    25383    2   END FLB_TAPE_NODES;
     1440    25384        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:261  
     1441    25385
     1442    25386    1   FLB_REQUALIFY_NODES: PROC;

  25386 20 003642   200004 741300       FLB_REQUALI* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     1443    25387        /*F*  NAME: FLB_REQUALIFY_NODES
     1444    25388              PURPOSE: Process REQUALIFY command.
     1445    25389        */
     1446    25390
     1447    25391        /****************************************/
     1448    25392
     1449    25393    2      CALL FLB_DISK_SPEC(0)

  25393 20 003643   000032 236000 21                 LDQ     26
        20 003644   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 003645   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 003646   003650 702000 20                 TSX2    s:25397
        20 003647   003650 710000 20                 TRA     s:25397

     1450    25394    3       WHENALTRETURN DO;

     1451    25395    3         END;

     1452    25396
     1453    25397    2      IF COMMAND_ERROR THEN RETURN;

  25397 20 003650   000000 234000 xsym               SZN     COMMAND_ERROR
        20 003651   003654 605000 20                 TPL     s:25399

  25397 20 003652   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 003653   000001 702211                    TSX2  ! 1,X1

     1454    25398
     1455    25399    2      NEW_DISK_DESC = '0'B;

  25399 20 003654   000000 220003                    LDX0    0,DU
        20 003655   000000 740000 xsym               STX0    NEW_DISK_DESC
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:262  

     1456    25400    2      IF COMMAND = %REQUALIFY_ARCHIVE

  25400 20 003656   000167 235000 2                  LDA     COMMAND
        20 003657   000032 115007                    CMPA    26,DL
        20 003660   003664 601000 20                 TNZ     s:25402

     1457    25401    2       THEN NEW_DISK_DESC.QS# = '1'B;

  25401 20 003661   010000 236003                    LDQ     4096,DU
        20 003662   000000 256000 xsym               ORSQ    NEW_DISK_DESC
        20 003663   003666 710000 20                 TRA     s:25403

     1458    25402    2       ELSE NEW_DISK_DESC.BUF# = '1'B;

  25402 20 003664   100000 236003                    LDQ     32768,DU
        20 003665   000000 256000 xsym               ORSQ    NEW_DISK_DESC

     1459    25403    2      CALL FLR$REQUALIFY;

  25403 20 003666   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 003667   000000 701000 xent               TSX1    FLR$REQUALIFY
        20 003670   000000 011000                    NOP     0

     1460    25404    2      CALL FLI$STATS;

  25404 20 003671   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 003672   000000 701000 xent               TSX1    FLI$STATS
        20 003673   000000 011000                    NOP     0

     1461    25405    2      RETURN;

  25405 20 003674   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 003675   000001 702211                    TSX2  ! 1,X1

     1462    25406
     1463    25407    2   END FLB_REQUALIFY_NODES;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:263  
     1464    25408        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:264  
     1465    25409
     1466    25410    1   FLB_STOW_FETCH_NODES: PROC;

  25410 20 003676   200004 741300       FLB_STOW_FE* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     1467    25411        /*F*  NAME: FLB_STOW_FETCH_NODES
     1468    25412              PURPOSE: Process STOW, UNSTOW, FETCH, UNFETCH, UNARCHIVE commands.
     1469    25413        */
     1470    25414
     1471    25415    2   DCL SUBNODEY SBIN;
     1472    25416    2   DCL INCR SBIN;
     1473    25417
     1474    25418        /****************************************/
     1475    25419
     1476    25420    2      SUBNODEY = 0;

  25420 20 003677   200005 450100                    STZ     SUBNODEY,,AUTO

     1477    25421    2      INCR = 0;

  25421 20 003700   200006 450100                    STZ     INCR,,AUTO

     1478    25422    3      DO SUBNODEY = 0 TO  NODE$->OUT$BLK.NSUBLKS -1;

  25422 20 003701   200005 450100                    STZ     SUBNODEY,,AUTO
        20 003702   003775 710000 20                 TRA     s:25453+1

     1479    25423
     1480    25424    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEY); /* Break up the fid         */

  25424 20 003703   000226 470400 2                  LDP0    NODE$
        20 003704   200005 720100                    LXL0    SUBNODEY,,AUTO
        20 003705   000003 236110                    LDQ     3,X0,PR0
        20 003706   000231 756000 2                  STQ     SUBNODE$

     1481    25425    3         FPT_FID.TEXTFID_ = VECTOR(SUBNODE$->OUT$SYM.TEXT);

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:265  
  25425 20 003707   000231 471400 2                  LDP1    SUBNODE$
        20 003710   100004 236100                    LDQ     4,,PR1
        20 003711   000033 772000                    QRL     27
        20 003712   000064 737000                    LLS     52
        20 003713   000140 135007                    SBLA    96,DL
        20 003714   000231 236000 2                  LDQ     SUBNODE$
        20 003715   000027 036000 21                 ADLQ    23
        20 003716   001320 757000 2                  STAQ    FPT_FID+2

     1482    25426    3         CALL M$FID(FPT_FID)

  25426 20 003717   001316 630400 2                  EPPR0   FPT_FID
        20 003720   420001 713400                    CLIMB   alt,+8193
        20 003721   404400 401760                    pmme    nvectors=10
        20 003722   003771 702000 20                 TSX2    s:25451

     1483    25427    4          WHENRETURN DO;

     1484    25428    4            IF FPT_FID_RESULTS.NAME

  25428 20 003723   001346 234000 2                  SZN     FPT_FID_RESULTS
        20 003724   003764 605000 20                 TPL     s:25447

     1485    25429    5             THEN DO;

     1486    25430    5               CALL FLB_DISK_SPEC(SUBNODEY)

  25430 20 003725   200005 630500                    EPPR0   SUBNODEY,,AUTO
        20 003726   200031 450500                    STP0    SOURCE_DCB$+1,,AUTO
        20 003727   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 003730   003732 702000 20                 TSX2    s:25434
        20 003731   003732 710000 20                 TRA     s:25434

     1487    25431    6                WHENALTRETURN DO;

     1488    25432    6                  END;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:266  
     1489    25433
     1490    25434    5               IF COMMAND_ERROR THEN RETURN;

  25434 20 003732   000000 234000 xsym               SZN     COMMAND_ERROR
        20 003733   003736 605000 20                 TPL     s:25436

  25434 20 003734   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 003735   000001 702211                    TSX2  ! 1,X1

     1491    25435
     1492    25436    5               IF COMMAND = %STOW_INACTIVE

  25436 20 003736   000167 235000 2                  LDA     COMMAND
        20 003737   000022 115007                    CMPA    18,DL
        20 003740   003743 601000 20                 TNZ     s:25439

     1493    25437    5                THEN DISK_OPTION.INACTIVATE = '1'B;

  25437 20 003741   010000 236003                    LDQ     4096,DU
        20 003742   000000 256000 xsym               ORSQ    DISK_OPTION

     1494    25438
     1495    25439    5               CALL FLS$STOW_FETCH ( COMMAND );

  25439 20 003743   000041 630400 21                 EPPR0   33
        20 003744   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 003745   000000 701000 xent               TSX1    FLS$STOW_FETCH
        20 003746   000000 011000                    NOP     0

     1496    25440
     1497    25441    5               DPLIST$ = ADDR(ZERO);       /* Reinit. for each fid               */

  25441 20 003747   000060 236000 21                 LDQ     48
        20 003750   000000 756000 xsym               STQ     DPLIST$

     1498    25442    5               ACCT.ACCT# = ' ';

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:267  
  25442 20 003751   000035 235000 xsym               LDA     B_VECTNIL+29
        20 003752   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 003753   000447 755000 2                  STA     ACCT
        20 003754   000450 756000 2                  STQ     ACCT+1

     1499    25443    5               PREV_ACCT.ACCT# = ' ';

  25443 20 003755   000035 235000 xsym               LDA     B_VECTNIL+29
        20 003756   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 003757   000240 757000 2                  STAQ    PREV_ACCT

     1500    25444    5               FIRST_ACCT_SPECIFIED.ACCT# = ' ';

  25444 20 003760   000035 235000 xsym               LDA     B_VECTNIL+29
        20 003761   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 003762   000244 757000 2                  STAQ    FIRST_ACCT_SPECIFIED

     1501    25445    5               END;

  25445 20 003763   003770 710000 20                 TRA     s:25449

     1502    25446    5             ELSE DO;

     1503    25447    5               CALL FLI$RPT_ERR (E_NO_FILE );

  25447 20 003764   000061 630400 21                 EPPR0   49
        20 003765   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 003766   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 003767   000000 011000                    NOP     0

     1504    25448    5               END;

     1505    25449    4            END;

  25449 20 003770   003774 710000 20                 TRA     s:25453

     1506    25450    4          WHENALTRETURN DO;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:268  

     1507    25451    4            CALL FLI$RPT_ERR;

  25451 20 003771   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 003772   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 003773   000000 011000                    NOP     0

     1508    25452    4            END;

     1509    25453    3         END;

  25453 20 003774   200005 054100                    AOS     SUBNODEY,,AUTO
        20 003775   000226 470400 2                  LDP0    NODE$
        20 003776   000001 236100                    LDQ     1,,PR0
        20 003777   000022 772000                    QRL     18
        20 004000   200005 116100                    CMPQ    SUBNODEY,,AUTO
        20 004001   003703 605400 20                 TPNZ    s:25424

     1510    25454
     1511    25455    2      RETURN;

  25455 20 004002   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004003   000001 702211                    TSX2  ! 1,X1

     1512    25456
     1513    25457    2   END FLB_STOW_FETCH_NODES;
     1514    25458        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:269  
     1515    25459
     1516    25460    1   FLB_VALIDATE_NODES: PROC;

  25460 20 004004   200004 741300       FLB_VALIDAT* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     1517    25461        /*F*  NAME: FLB_VALIDATE_NODES
     1518    25462              PURPOSE: Process VALIDATE command.
     1519    25463        */
     1520    25464
     1521    25465        /****************************************/
     1522    25466
     1523    25467    2      CALL FLB_DISK_SPEC(0)

  25467 20 004005   000032 236000 21                 LDQ     26
        20 004006   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 004007   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 004010   004012 702000 20                 TSX2    s:25471
        20 004011   004012 710000 20                 TRA     s:25471

     1524    25468    3       WHENALTRETURN DO;

     1525    25469    3         END;

     1526    25470
     1527    25471    2      IF COMMAND_ERROR THEN RETURN;

  25471 20 004012   000000 234000 xsym               SZN     COMMAND_ERROR
        20 004013   004016 605000 20                 TPL     s:25473

  25471 20 004014   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004015   000001 702211                    TSX2  ! 1,X1

     1528    25472
     1529    25473    2      CALL FLV$VALIDATE( COMMAND );

  25473 20 004016   000041 630400 21                 EPPR0   33
        20 004017   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:270  
        20 004020   000000 701000 xent               TSX1    FLV$VALIDATE
        20 004021   000000 011000                    NOP     0

     1530    25474    2      CALL FLI$STATS;

  25474 20 004022   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 004023   000000 701000 xent               TSX1    FLI$STATS
        20 004024   000000 011000                    NOP     0

     1531    25475    2      RETURN;

  25475 20 004025   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004026   000001 702211                    TSX2  ! 1,X1

     1532    25476
     1533    25477    2   END FLB_VALIDATE_NODES;
     1534    25478        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:271  
     1535    25479
     1536    25480    1   FLB_ADDREM_NODES: PROC;

  25480 20 004027   200004 741300       FLB_ADDREM_* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     1537    25481        /*F*  NAME: FLB_ADDREM_NODES
     1538    25482              PURPOSE: Process ADD and REMOVE commands.
     1539    25483        */
     1540    25484
     1541    25485        /****************************************/
     1542    25486
     1543    25487    2      CALL FLB_DISK_SPEC(0)

  25487 20 004030   000032 236000 21                 LDQ     26
        20 004031   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 004032   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 004033   004035 702000 20                 TSX2    s:25490
        20 004034   004035 710000 20                 TRA     s:25490

     1544    25488    3       WHENALTRETURN DO;

     1545    25489    3         END;

     1546    25490    2      CALL FLB_DISK_DEST

  25490 20 004035   006314 701000 20                 TSX1    FLB_DISK_DEST
        20 004036   004040 702000 20                 TSX2    s:25493
        20 004037   004040 710000 20                 TRA     s:25493

     1547    25491    3       WHENALTRETURN DO;

     1548    25492    3         END;

     1549    25493    2      IF COMMAND_ERROR THEN RETURN;

  25493 20 004040   000000 234000 xsym               SZN     COMMAND_ERROR
        20 004041   004044 605000 20                 TPL     s:25499
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:272  

  25493 20 004042   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004043   000001 702211                    TSX2  ! 1,X1

     1550    25494
     1551    25495         /***
     1552    25496          *** Command is fine.  Go for it.
     1553    25497          ***/
     1554    25498
     1555    25499    2      CALL FLE$ESTMOD( COMMAND );

  25499 20 004044   000041 630400 21                 EPPR0   33
        20 004045   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004046   000000 701000 xent               TSX1    FLE$ESTMOD
        20 004047   000000 011000                    NOP     0

     1556    25500    2      RETURN;

  25500 20 004050   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004051   000001 702211                    TSX2  ! 1,X1

     1557    25501
     1558    25502    2   END FLB_ADDREM_NODES;
     1559    25503        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:273  
     1560    25504
     1561    25505    1   FLB_DUAL_NODES: PROC;

  25505 20 004052   200004 741300       FLB_DUAL_NO* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     1562    25506        /*F*  NAME: FLB_DUAL_NODES
     1563    25507              PURPOSE: Process DUAL command.
     1564    25508        */
     1565    25509
     1566    25510        /****************************************/
     1567    25511
     1568    25512    2      CALL FLB_DISK_SPEC(0)

  25512 20 004053   000032 236000 21                 LDQ     26
        20 004054   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 004055   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 004056   004060 702000 20                 TSX2    s:25515
        20 004057   004060 710000 20                 TRA     s:25515

     1569    25513    3       WHENALTRETURN DO;

     1570    25514    3         END;

     1571    25515    2      IF COMMAND_ERROR THEN RETURN;

  25515 20 004060   000000 234000 xsym               SZN     COMMAND_ERROR
        20 004061   004064 605000 20                 TPL     s:25516

  25515 20 004062   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004063   000001 702211                    TSX2  ! 1,X1

     1572    25516    2      CALL FLB_DISK_DEST

  25516 20 004064   006314 701000 20                 TSX1    FLB_DISK_DEST
        20 004065   004066 702000 20                 TSX2    s:25519

     1573    25517    3       WHENRETURN DO;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:274  

     1574    25518    3         END;

     1575    25519    2      IF COMMAND_ERROR THEN RETURN;

  25519 20 004066   000000 234000 xsym               SZN     COMMAND_ERROR
        20 004067   004072 605000 20                 TPL     s:25521

  25519 20 004070   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004071   000001 702211                    TSX2  ! 1,X1

     1576    25520
     1577    25521    2      IF COMMAND = %DUAL_INCREMENTAL

  25521 20 004072   000167 235000 2                  LDA     COMMAND
        20 004073   000052 115007                    CMPA    42,DL
        20 004074   004077 601000 20                 TNZ     s:25532

     1578    25522    2       THEN TAPE_OPTION.PROTTYPE = %INCREMENTAL;

  25522 20 004075   300000 236003                    LDQ     98304,DU
        20 004076   000001 756000 xsym               STQ     TAPE_OPTION+1

     1579    25523
     1580    25524         /***
     1581    25525          *** Command is fine.  Go for it.
     1582    25526          ***/
     1583    25527
     1584    25528        /* To make sure the DUAL pack will have enough space for the DUAL   */
     1585    25529        /* we have to delete from DUAL pack files that were deleted    */
     1586    25530        /* from the PRIME pack since the last DUAL.  Two passes are needed.  */
     1587    25531
     1588    25532    2      IF COMMAND = %DUAL_INCREMENTAL

  25532 20 004077   000052 115007                    CMPA    42,DL
        20 004100   004135 601000 20                 TNZ     s:25547

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:275  
     1589    25533    3       THEN DO;

     1590    25534    3         TEMP_DISK_SRCHCOND = DISK_SRCHCOND;

  25534 20 004101   000000 220000 xsym               LDX0    DISK_SRCHCOND
        20 004102   000000 740000 xsym               STX0    TEMP_DISK_SRCHCOND

     1591    25535    3         DISK_SRCHCOND = '0'B;

  25535 20 004103   000000 221003                    LDX1    0,DU
        20 004104   000000 741000 xsym               STX1    DISK_SRCHCOND

     1592    25536    3         DISK_SRCHCOND.DELF# = '1'B;

  25536 20 004105   400000 236003                    LDQ     -131072,DU
        20 004106   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     1593    25537    3         CALL FLM$MOVE ( %REAL_DUAL )

  25537 20 004107   000063 630400 21                 EPPR0   51
        20 004110   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004111   000000 701000 xent               TSX1    FLM$MOVE
        20 004112   004114 702000 20                 TSX2    s:25539
        20 004113   004133 710000 20                 TRA     s:25545

     1594    25538    4          WHENALTRETURN DO;

     1595    25539    4            IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR

  25539 20 004114   000004 236000 xsym               LDQ     FPT_EXIT+4
        20 004115   777000 376003                    ANQ     -512,DU
        20 004116   002000 116003                    CMPQ    1024,DU
        20 004117   004122 603000 20                 TRC     s:25541

     1596    25540    4             THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;

  25540 20 004120   002000 236003                    LDQ     1024,DU
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:276  
        20 004121   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

     1597    25541    4            IF DISK_OPTION.SWITCH_IF_ERRORS

  25541 20 004122   000002 236000 xsym               LDQ     DISK_OPTION+2
        20 004123   010000 316003                    CANQ    4096,DU
        20 004124   004131 600000 20                 TZE     s:25543

     1598    25542    4             THEN CALL FLI$RPT_ERR ( E_TOO_MANY_ERRORS_TO_SWITCH );

  25542 20 004125   000064 630400 21                 EPPR0   52
        20 004126   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004127   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 004130   000000 011000                    NOP     0

     1599    25543    4            RETURN;

  25543 20 004131   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004132   000001 702211                    TSX2  ! 1,X1

     1600    25544    4            END;
     1601    25545    3         DISK_SRCHCOND = TEMP_DISK_SRCHCOND; /* 2nd pass                         */

  25545 20 004133   000000 220000 xsym               LDX0    TEMP_DISK_SRCHCOND
        20 004134   000000 740000 xsym               STX0    DISK_SRCHCOND

     1602    25546    3         END;

     1603    25547    2      CALL FLM$MOVE( %REAL_DUAL )

  25547 20 004135   000063 630400 21                 EPPR0   51
        20 004136   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004137   000000 701000 xent               TSX1    FLM$MOVE
        20 004140   004165 702000 20                 TSX2    s:25562

     1604    25548    3       WHENRETURN DO;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:277  
     1605    25549    3         IF DISK_OPTION.SWITCH_IF_ERRORS

  25549 20 004141   000002 236000 xsym               LDQ     DISK_OPTION+2
        20 004142   010000 316003                    CANQ    4096,DU
        20 004143   004164 600000 20                 TZE     s:25560

     1606    25550    4          THEN DO;

     1607    25551    4            IF TOTAL_ERRORS < ERROR_LIMIT OR

  25551 20 004144   000000 236000 xsym               LDQ     TOTAL_ERRORS
        20 004145   000000 116000 xsym               CMPQ    ERROR_LIMIT
        20 004146   004153 604000 20                 TMI     s:25554
        20 004147   000000 116003                    CMPQ    0,DU
        20 004150   004160 601000 20                 TNZ     s:25558
        20 004151   000000 235000 xsym               LDA     ERROR_LIMIT
        20 004152   004160 601000 20                 TNZ     s:25558

     1608    25552    4              ( TOTAL_ERRORS = 0 AND ERROR_LIMIT = 0 )
     1609    25553    5             THEN DO;

     1610    25554    5               CALL FLM$SWITCH_PRIME_DUAL

  25554 20 004153   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 004154   000000 701000 xent               TSX1    FLM$SWITCH_PRIME_DUAL
        20 004155   004157 702000 20                 TSX2    s:25557
        20 004156   004157 710000 20                 TRA     s:25557

     1611    25555    6                WHENALTRETURN DO;

     1612    25556    6                  END;

     1613    25557    5               END;

  25557 20 004157   004164 710000 20                 TRA     s:25560

     1614    25558    4             ELSE CALL FLI$RPT_ERR ( E_TOO_MANY_ERRORS_TO_SWITCH );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:278  

  25558 20 004160   000064 630400 21                 EPPR0   52
        20 004161   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004162   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 004163   000000 011000                    NOP     0

     1615    25559    4            END;

     1616    25560    3         END;

  25560 20 004164   004173 710000 20                 TRA     s:25565

     1617    25561    3       WHENALTRETURN DO;

     1618    25562    3         IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR

  25562 20 004165   000004 236000 xsym               LDQ     FPT_EXIT+4
        20 004166   777000 376003                    ANQ     -512,DU
        20 004167   002000 116003                    CMPQ    1024,DU
        20 004170   004173 603000 20                 TRC     s:25565

     1619    25563    3          THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;

  25563 20 004171   002000 236003                    LDQ     1024,DU
        20 004172   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

     1620    25564    3         END;

     1621    25565    2      CALL FLI$STATS;

  25565 20 004173   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 004174   000000 701000 xent               TSX1    FLI$STATS
        20 004175   000000 011000                    NOP     0

     1622    25566    2      RETURN;

  25566 20 004176   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:279  
        20 004177   000001 702211                    TSX2  ! 1,X1

     1623    25567
     1624    25568    2   END FLB_DUAL_NODES;
     1625    25569        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:280  
     1626    25570
     1627    25571    1   FLB_SAVE_NODES: PROC;

  25571 20 004200   200004 741300       FLB_SAVE_NO* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     1628    25572        /*F*  NAME: FLB_SAVE_NODES
     1629    25573              PURPOSE: Process SAVE command.
     1630    25574        */
     1631    25575
     1632    25576        %VLP_SN( FPTN = PREV_TAPE_SN,
     1633    25577                 N = 1,
     1634    25578                 STCLASS = STATIC );
     1635    25591
     1636    25592        /****************************************/
     1637    25593
     1638    25594    2      CALL FLB_DISK_SPEC(0)

  25594 20 004201   000032 236000 21                 LDQ     26
        20 004202   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 004203   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 004204   004206 702000 20                 TSX2    s:25597
        20 004205   004206 710000 20                 TRA     s:25597

     1639    25595    3       WHENALTRETURN DO;

     1640    25596    3         END;

     1641    25597    2      IF COMMAND_ERROR THEN RETURN;

  25597 20 004206   000000 234000 xsym               SZN     COMMAND_ERROR
        20 004207   004212 605000 20                 TPL     s:25598

  25597 20 004210   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004211   000001 702211                    TSX2  ! 1,X1

     1642    25598    2      CALL FLB_TAPE_OD_SPEC

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:281  
  25598 20 004212   014004 701000 20                 TSX1    FLB_TAPE_OD_SPEC
        20 004213   004251 702000 20                 TSX2    s:25621

     1643    25599    3       WHENRETURN DO;

     1644    25600    3         IF ( COMMAND = %SAVE OR COMMAND = %BACKUP )

  25600 20 004214   000167 235000 2                  LDA     COMMAND
        20 004215   000006 115007                    CMPA    6,DL
        20 004216   004221 600000 20                 TZE     s:25602
        20 004217   000010 115007                    CMPA    8,DL
        20 004220   004246 601000 20                 TNZ     s:25618

     1645    25601    4          THEN DO;

     1646    25602    4            IF NOT TAPE_OPEN.V.XTEND# /* Check if user spec'd or implied extension */

  25602 20 004221   000060 236000 xsym               LDQ     TAPE_OPEN+48
        20 004222   030000 316003                    CANQ    12288,DU
        20 004223   004250 601000 20                 TNZ     s:25619

     1647    25603    5             THEN DO;

     1648    25604        /***
     1649    25605         *** If executing consecutive SAVE or consecutive BACKUP commands to the same
     1650    25606         *** tapeset, perform an automatic extension on the current volume (implied
     1651    25607         *** extension). Used to always use the first volume specified on the next
     1652    25608         *** command line which sometimes resulted in the 1st tape being clobbered if
     1653    25609         *** multiple tapes already written or aborting due to lack of resources.
     1654    25610         ***/
     1655    25611    5               IF ( PREV_COMMAND = %SAVE OR PREV_COMMAND = %BACKUP )

  25611 20 004224   000170 235000 2                  LDA     PREV_COMMAND
        20 004225   000006 115007                    CMPA    6,DL
        20 004226   004231 600000 20                 TZE     s:25611+5
        20 004227   000010 115007                    CMPA    8,DL
        20 004230   004243 601000 20                 TNZ     s:25614
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:282  
        20 004231   000000 470400 xsym               LDP0    LAST_SNLISTINFO$
        20 004232   000000 471500                    LDP1    0,,PR0
        20 004233   040000 106500                    CMPC    fill='040'O
        20 004234   100001 000006                    ADSC9   1,,PR1                   cn=0,n=6
        20 004235   002277 000006 2                  ADSC9   PREV_TAPE_SN+1           cn=0,n=6
        20 004236   004243 601000 20                 TNZ     s:25614

     1656    25612    5                 AND SNLISTINFO.SNLIST$->VLP_SN.SN#(0) = PREV_TAPE_SN.SN#(0)
     1657    25613    5                THEN TAPE_OPEN.V.XTEND# = '1'B;

  25613 20 004237   000065 376000 21                 ANQ     53
        20 004240   020000 276003                    ORQ     8192,DU
        20 004241   000060 756000 xsym               STQ     TAPE_OPEN+48
        20 004242   004250 710000 20                 TRA     s:25619

     1658    25614    5                ELSE CT_IMAGE = ' ';       /* No automatic extension             */

  25614 20 004243   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 004244   000000 756000 xsym               STQ     CT_IMAGE

     1659    25615    5               END;

     1660    25616    4            END;

  25616 20 004245   004250 710000 20                 TRA     s:25619

     1661    25617    3          ELSE
     1662    25618    3            CT_IMAGE = ' ';                /* No automatic extension             */

  25618 20 004246   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 004247   000000 756000 xsym               STQ     CT_IMAGE

     1663    25619    3         END;

  25619 20 004250   004267 710000 20                 TRA     s:25629

     1664    25620    3       WHENALTRETURN DO;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:283  

     1665    25621    3         IF NBR_SNLISTS = 0 AND

  25621 20 004251   000000 235000 xsym               LDA     NBR_SNLISTS
        20 004252   004267 601000 20                 TNZ     s:25629
        20 004253   000167 236000 2                  LDQ     COMMAND
        20 004254   000027 116007                    CMPQ    23,DL
        20 004255   004260 600000 20                 TZE     s:25624
        20 004256   000030 116007                    CMPQ    24,DL
        20 004257   004267 601000 20                 TNZ     s:25629

     1666    25622    3           ( COMMAND = %ARCHIVE_CMD OR COMMAND = %PURGE )
     1667    25623    4          THEN DO;

     1668    25624    4            COMMAND_ERROR = '0'B;

  25624 20 004260   000000 450000 xsym               STZ     COMMAND_ERROR

     1669    25625    4            DISK_OPTION.DELETE = '0'B;     /* Don't delete file when archiving   */

  25625 20 004261   000066 236000 21                 LDQ     54
        20 004262   000002 356000 xsym               ANSQ    DISK_OPTION+2

     1670    25626    4            CALL FLE$ESTMOD(COMMAND);

  25626 20 004263   000041 630400 21                 EPPR0   33
        20 004264   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004265   000000 701000 xent               TSX1    FLE$ESTMOD
        20 004266   000000 011000                    NOP     0

     1671    25627    4            END;

     1672    25628    3         END;

     1673    25629    2      IF COMMAND_ERROR THEN RETURN;

  25629 20 004267   000000 234000 xsym               SZN     COMMAND_ERROR
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:284  
        20 004270   004273 605000 20                 TPL     s:25634

  25629 20 004271   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004272   000001 702211                    TSX2  ! 1,X1

     1674    25630
     1675    25631        /***
     1676    25632         *** Save SN spec'd for implied extension test on multiple SAVE,BACKUP commands.
     1677    25633         ***/
     1678    25634    2      IF (COMMAND = %SAVE OR COMMAND = %BACKUP)

  25634 20 004273   000167 235000 2                  LDA     COMMAND
        20 004274   000006 115007                    CMPA    6,DL
        20 004275   004300 600000 20                 TZE     s:25636
        20 004276   000010 115007                    CMPA    8,DL
        20 004277   004305 601000 20                 TNZ     s:25642

     1679    25635    2       THEN
     1680    25636    2         PREV_TAPE_SN.SN#(0) = SNLISTINFO.SNLIST$->VLP_SN.SN#(0);

  25636 20 004300   000000 470400 xsym               LDP0    LAST_SNLISTINFO$
        20 004301   000000 471500                    LDP1    0,,PR0
        20 004302   040000 100500                    MLR     fill='040'O
        20 004303   100001 000006                    ADSC9   1,,PR1                   cn=0,n=6
        20 004304   002277 000006 2                  ADSC9   PREV_TAPE_SN+1           cn=0,n=6

     1681    25637
     1682    25638         /***
     1683    25639          *** Command is fine.  Go for it.
     1684    25640          ***/
     1685    25641
     1686    25642    2      CALL FLM$MOVE( COMMAND )

  25642 20 004305   000041 630400 21                 EPPR0   33
        20 004306   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004307   000000 701000 xent               TSX1    FLM$MOVE
        20 004310   004330 702000 20                 TSX2    s:25651
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:285  

     1687    25643    3       WHENRETURN DO;

     1688    25644    3         IF ARCHIVE$ ~= ADDR(NIL) AND

  25644 20 004311   000000 236000 xsym               LDQ     ARCHIVE$
        20 004312   000001 116000 xsym               CMPQ    B_VECTNIL+1
        20 004313   004325 600000 20                 TZE     s:25648
        20 004314   000167 235000 2                  LDA     COMMAND
        20 004315   000027 115007                    CMPA    23,DL
        20 004316   004321 600000 20                 TZE     s:25647
        20 004317   000030 115007                    CMPA    24,DL
        20 004320   004325 601000 20                 TNZ     s:25648

     1689    25645    3           ( COMMAND = %ARCHIVE_CMD OR COMMAND = %PURGE )
     1690    25646    3          THEN
     1691    25647    3            CALL FLE$ESTMOD(%ARCHIVED);

  25647 20 004321   000043 630400 21                 EPPR0   35
        20 004322   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004323   000000 701000 xent               TSX1    FLE$ESTMOD
        20 004324   000000 011000                    NOP     0

     1692    25648    3         ARCHIVE$ = ADDR(NIL);

  25648 20 004325   000001 236000 xsym               LDQ     B_VECTNIL+1
        20 004326   000000 756000 xsym               STQ     ARCHIVE$

     1693    25649    3         END;

  25649 20 004327   004336 710000 20                 TRA     s:25654

     1694    25650    3       WHENALTRETURN DO;

     1695    25651    3         IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR

  25651 20 004330   000004 236000 xsym               LDQ     FPT_EXIT+4
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:286  
        20 004331   777000 376003                    ANQ     -512,DU
        20 004332   002000 116003                    CMPQ    1024,DU
        20 004333   004336 603000 20                 TRC     s:25654

     1696    25652    3          THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;

  25652 20 004334   002000 236003                    LDQ     1024,DU
        20 004335   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

     1697    25653    3         END;

     1698    25654    2      CALL FLI$STATS;

  25654 20 004336   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 004337   000000 701000 xent               TSX1    FLI$STATS
        20 004340   000000 011000                    NOP     0

     1699    25655    2      RETURN;

  25655 20 004341   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004342   000001 702211                    TSX2  ! 1,X1

     1700    25656
     1701    25657    2   END FLB_SAVE_NODES;
     1702    25658        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:287  
     1703    25659
     1704    25660    1   FLB_ESTMOD_NODES: PROC;

  25660 20 004343   200004 741300       FLB_ESTMOD_* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     1705    25661        /*F*  NAME: FLB_ESTMOD_NODES
     1706    25662              PURPOSE: Process ESTABLISH and MODIFY commands.
     1707    25663        */
     1708    25664
     1709    25665        /****************************************/
     1710    25666
     1711    25667    2      CALL FLB_DISK_SPEC(0)

  25667 20 004344   000032 236000 21                 LDQ     26
        20 004345   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 004346   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 004347   004351 702000 20                 TSX2    s:25670
        20 004350   004351 710000 20                 TRA     s:25670

     1712    25668    3       WHENALTRETURN DO;

     1713    25669    3         END;

     1714    25670    2      CALL FLB_TAPE_OD_SPEC

  25670 20 004351   014004 701000 20                 TSX1    FLB_TAPE_OD_SPEC
        20 004352   004354 702000 20                 TSX2    s:25673
        20 004353   004354 710000 20                 TRA     s:25673

     1715    25671    3       WHENALTRETURN DO;

     1716    25672    3         END;

     1717    25673    2      IF COMMAND_ERROR THEN RETURN;

  25673 20 004354   000000 234000 xsym               SZN     COMMAND_ERROR
        20 004355   004360 605000 20                 TPL     s:25679
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:288  

  25673 20 004356   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004357   000001 702211                    TSX2  ! 1,X1

     1718    25674
     1719    25675         /***
     1720    25676          *** Command is fine.  Go for it.
     1721    25677          ***/
     1722    25678
     1723    25679    2      CALL FLE$ESTMOD( COMMAND );

  25679 20 004360   000041 630400 21                 EPPR0   33
        20 004361   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004362   000000 701000 xent               TSX1    FLE$ESTMOD
        20 004363   000000 011000                    NOP     0

     1724    25680    2      RETURN;

  25680 20 004364   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004365   000001 702211                    TSX2  ! 1,X1

     1725    25681
     1726    25682    2   END FLB_ESTMOD_NODES;
     1727    25683        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:289  
     1728    25684    1   FLB_OPEN_NODES:PROC;

  25684 20 004366   200004 741300       FLB_OPEN_NO* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     1729    25685        /*F*  NAME:FLB_OPEN_NODES
     1730    25686              PURPOSE: Process OPEN command.
     1731    25687        */
     1732    25688
     1733    25689    2   DCL GRAND_TOTAL_FILES SBIN AUTO;
     1734    25690    2   DCL GRAND_TOTAL_GRANS SBIN AUTO;
     1735    25691    2   DCL GRAND_START_UTS UBIN AUTO;
     1736    25692    2   DCL DEST_TAPE_VOL_SAVE SBIN AUTO;
     1737    25693
     1738    25694        /*********************************************/
     1739    25695
     1740    25696    2      CALL FLB_TRANS_TYPE ;

  25696 20 004367   006133 701000 20                 TSX1    FLB_TRANS_TYPE
        20 004370   000000 011000                    NOP     0

     1741    25697    3      DO CASE( COMMAND );

  25697 20 004371   000167 235000 2                  LDA     COMMAND
        20 004372   000044 135007                    SBLA    36,DL
        20 004373   000004 115007                    CMPA    4,DL
        20 004374   004376 602005 20                 TNC     s:25697+5,AL
        20 004375   004457 710000 20                 TRA     s:25726
        20 004376   004402 710000 20                 TRA     s:25700
        20 004377   004405 710000 20                 TRA     s:25702
        20 004400   004405 710000 20                 TRA     s:25702
        20 004401   004422 710000 20                 TRA     s:25709

     1742    25698
     1743    25699    3       CASE(%OPEN_UPDATE);

     1744    25700    3         STATE = %DUAL;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:290  
  25700 20 004402   000043 236007                    LDQ     35,DL
        20 004403   000247 756000 2                  STQ     STATE
        20 004404   004457 710000 20                 TRA     s:25726

     1745    25701    3       CASE( %OPEN_CREATE,%OPEN_EXTEND);

     1746    25702    3         STATE = COMMAND;

  25702 20 004405   000167 236000 2                  LDQ     COMMAND
        20 004406   000247 756000 2                  STQ     STATE

     1747    25703    3         CALL FLB_TAPE_OD_SPEC

  25703 20 004407   014004 701000 20                 TSX1    FLB_TAPE_OD_SPEC
        20 004410   004412 702000 20                 TSX2    s:25706
        20 004411   004412 710000 20                 TRA     s:25706

     1748    25704    4          WHENALTRETURN DO;

     1749    25705    4            END;

     1750    25706    3         IF COMMAND = %OPEN_EXTEND

  25706 20 004412   000167 235000 2                  LDA     COMMAND
        20 004413   000046 115007                    CMPA    38,DL
        20 004414   004457 601000 20                 TNZ     s:25726

     1751    25707    3          THEN TAPE_OPEN.V.XTEND# = '1'B;

  25707 20 004415   000060 236000 xsym               LDQ     TAPE_OPEN+48
        20 004416   000065 376000 21                 ANQ     53
        20 004417   020000 276003                    ORQ     8192,DU
        20 004420   000060 756000 xsym               STQ     TAPE_OPEN+48
        20 004421   004457 710000 20                 TRA     s:25726

     1752    25708    3       CASE( %OPEN_INPUT);

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:291  
     1753    25709    3         STATE = %RESTORE;

  25709 20 004422   000011 236007                    LDQ     9,DL
        20 004423   000247 756000 2                  STQ     STATE

     1754    25710    3         RESTORE_FROM_TAPE = '1'B;

  25710 20 004424   400000 236003                    LDQ     -131072,DU
        20 004425   000164 756000 2                  STQ     RESTORE_FROM_TAPE

     1755    25711    3         TAPE_OPTION.OPEN_FUNCTION = %OPEN_INPUT;

  25711 20 004426   047000 236003                    LDQ     19968,DU
        20 004427   000003 756000 xsym               STQ     TAPE_OPTION+3

     1756    25712    3         CALL FLB_TAPE_OD_SPEC

  25712 20 004430   014004 701000 20                 TSX1    FLB_TAPE_OD_SPEC
        20 004431   004455 702000 20                 TSX2    s:25723

     1757    25713    4          WHENRETURN DO;

     1758    25714    4            SOURCE_TAPE_SNLIST$ = SNLISTINFO.SNLIST$;

  25714 20 004432   000000 470400 xsym               LDP0    LAST_SNLISTINFO$
        20 004433   000000 236100                    LDQ     0,,PR0
        20 004434   000230 756000 2                  STQ     SOURCE_TAPE_SNLIST$

     1759    25715    4            TVECTOR = VECTOR(SOURCE_TAPE_SNLIST$->VLP_SN);

  25715 20 004435   000033 235000 21                 LDA     27
        20 004436   000000 757000 xsym               STAQ    TVECTOR

     1760    25716    4            TVECTOR.W1.VSIZE# = LENGTHV(VLP_SN.NUM#)

  25716 20 004437   000230 471400 2                  LDP1    SOURCE_TAPE_SNLIST$
        20 004440   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:292  
        20 004441   000006 402007                    MPY     6,DL
        20 004442   000003 036007                    ADLQ    3,DL
        20 004443   000020 736000                    QLS     16
        20 004444   000000 676000 xsym               ERQ     TVECTOR
        20 004445   000034 376000 xsym               ANQ     B_VECTNIL+28
        20 004446   000000 656000 xsym               ERSQ    TVECTOR

     1761    25717    4              + SOURCE_TAPE_SNLIST$->VLP_SN.NUM# * LENGTHC(VLP_SN.SN#(0));
     1762    25718    4            TAPE_OPEN.SN_ = TVECTOR;

  25718 20 004447   000000 237000 xsym               LDAQ    TVECTOR
        20 004450   000002 757000 xsym               STAQ    TAPE_OPEN+2

     1763    25719    4            LAST_SNLISTINFO$ = ADDR(NIL);

  25719 20 004451   000001 236000 xsym               LDQ     B_VECTNIL+1
        20 004452   000000 756000 xsym               STQ     LAST_SNLISTINFO$

     1764    25720    4            NBR_SNLISTS = 0;

  25720 20 004453   000000 450000 xsym               STZ     NBR_SNLISTS

     1765    25721    4            END;

  25721 20 004454   004457 710000 20                 TRA     s:25726

     1766    25722    4          WHENALTRETURN DO;

     1767    25723    4            COMMAND_ERROR = '1'B;

  25723 20 004455   400000 236003                    LDQ     -131072,DU
        20 004456   000000 756000 xsym               STQ     COMMAND_ERROR

     1768    25724    4            END;

     1769    25725    3       END;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:293  
     1770    25726    2      IF COMMAND_ERROR THEN RETURN;

  25726 20 004457   000000 234000 xsym               SZN     COMMAND_ERROR
        20 004460   004463 605000 20                 TPL     s:25728

  25726 20 004461   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004462   000001 702211                    TSX2  ! 1,X1

     1771    25727
     1772    25728    2      CHECK_TAPE = TAPE_OPTION.CHECK;

  25728 20 004463   000000 236000 xsym               LDQ     TAPE_OPTION
        20 004464   400000 376003                    ANQ     -131072,DU
        20 004465   000165 756000 2                  STQ     CHECK_TAPE

     1773    25729    2      TAPE_OPTION.CHECK = '0'B;            /* Must check when all done           */

  25729 20 004466   000031 236000 xsym               LDQ     B_VECTNIL+25
        20 004467   000000 356000 xsym               ANSQ    TAPE_OPTION

     1774    25730    2      GRAND_TOTAL_FILES = 0;

  25730 20 004470   200005 450100                    STZ     GRAND_TOTAL_FILES,,AUTO

     1775    25731    2      GRAND_TOTAL_GRANS = 0;

  25731 20 004471   200006 450100                    STZ     GRAND_TOTAL_GRANS,,AUTO

     1776    25732    2      DEST_TAPE_VOL_SAVE = 0;

  25732 20 004472   200010 450100                    STZ     DEST_TAPE_VOL_SAVE,,AUTO

     1777    25733    2      CALL M$TIME( GET_NOW_UTS );

  25733 20 004473   000000 630400 xsym               EPPR0   GET_NOW_UTS
        20 004474   020004 713400                    CLIMB   8196
        20 004475   402000 401760                    pmme    nvectors=5
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:294  

     1778    25734    2      GRAND_START_UTS = NOW_UTS;

  25734 20 004476   000000 235000 xsym               LDA     NOW_UTS
        20 004477   200007 755100                    STA     GRAND_START_UTS,,AUTO

     1779    25735    2      DISK_FILE_SPEC$ = ADDR(NIL);

  25735 20 004500   000001 236000 xsym               LDQ     B_VECTNIL+1
        20 004501   000000 756000 xsym               STQ     DISK_FILE_SPEC$

     1780    25736
     1781    25737
     1782    25738    3      DO WHILE('1'B);

     1783    25739    3         BREAK_CONTINUED = '0'B;

  25739 20 004502   000155 450000 2                  STZ     BREAK_CONTINUED

     1784    25740    3         BREAK_DCB# = 0;

  25740 20 004503   000156 450000 2                  STZ     BREAK_DCB#

     1785    25741    3         OVER_FIL = '0'B;

  25741 20 004504   000000 450000 xsym               STZ     OVER_FIL

     1786    25742    3         IF MODE = %TRANSFER

  25742 20 004505   000250 235000 2                  LDA     MODE
        20 004506   004513 601000 20                 TNZ     s:25744

     1787    25743    3          THEN BREAK_TASK = 'Transferring!';

  25743 20 004507   040000 100400                    MLR     fill='040'O
        20 004510   000213 000015 19                 ADSC9   LEGAL_CHAR+93            cn=0,n=13
        20 004511   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:295  
        20 004512   004516 710000 20                 TRA     s:25745

     1788    25744    3          ELSE BREAK_TASK = 'Transporting!';

  25744 20 004513   040000 100400                    MLR     fill='040'O
        20 004514   000217 000015 19                 ADSC9   LEGAL_CHAR+97            cn=0,n=13
        20 004515   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

     1789    25745    3         CALL XUR$GETCMD(EFT_CMD,NODE$,VECTOR(PROMPT)) ALTRET(TELL_ERROR);

  25745 20 004516   000072 630400 21                 EPPR0   58
        20 004517   000021 631400 xsym               EPPR1   B_VECTNIL+17
        20 004520   000000 701000 xent               TSX1    XUR$GETCMD
        20 004521   005252 702000 20                 TSX2    TELL_ERROR

     1790    25746    3         CALL XUR$ECHOIF(DCBNUM(M$LO));

  25746 20 004522   000000 236007 xsym               LDQ     M$LO,DL
        20 004523   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 004524   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 004525   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 004526   200043 630500                    EPPR0   @MAX_NX+2,,AUTO
        20 004527   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004530   000000 701000 xent               TSX1    XUR$ECHOIF
        20 004531   000000 011000                    NOP     0

     1791    25747    3         CALL FLI$INIT( '1'B );            /* Partial initialization             */

  25747 20 004532   000016 630400 21                 EPPR0   14
        20 004533   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004534   000000 701000 xent               TSX1    FLI$INIT
        20 004535   000000 011000                    NOP     0

     1792    25748    3         CALL FLB_OPTION_INIT;

  25748 20 004536   006226 701000 20                 TSX1    FLB_OPTION_INIT
        20 004537   000000 011000                    NOP     0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:296  

     1793    25749    3         BREAK_COUNT = 0;

  25749 20 004540   000154 450000 2                  STZ     BREAK_COUNT

     1794    25750    3         COMMAND_ERROR = '0'B;

  25750 20 004541   000000 450000 xsym               STZ     COMMAND_ERROR

     1795    25751    3         TSN_SET_NBR = 0;        /* Start each new command from first tape set   */

  25751 20 004542   000000 450000 xsym               STZ     TSN_SET_NBR

     1796    25752    3         SUB_COMMAND = NODE$->OUT$BLK.CODE;

  25752 20 004543   000226 470400 2                  LDP0    NODE$
        20 004544   000000 236100                    LDQ     0,,PR0
        20 004545   777777 376007                    ANQ     -1,DL
        20 004546   000252 756000 2                  STQ     SUB_COMMAND

     1797    25753    4         DO CASE ( SUB_COMMAND );

  25753 20 004547   000052 116007                    CMPQ    42,DL
        20 004550   004552 602006 20                 TNC     s:25753+3,QL
        20 004551   005245 710000 20                 TRA     s:25917
        20 004552   005077 710000 20                 TRA     s:25862
        20 004553   005112 710000 20                 TRA     s:25867
        20 004554   005122 710000 20                 TRA     s:25871
        20 004555   005245 710000 20                 TRA     s:25917
        20 004556   005245 710000 20                 TRA     s:25917
        20 004557   005245 710000 20                 TRA     s:25917
        20 004560   005245 710000 20                 TRA     s:25917
        20 004561   005245 710000 20                 TRA     s:25917
        20 004562   005245 710000 20                 TRA     s:25917
        20 004563   005245 710000 20                 TRA     s:25917
        20 004564   005245 710000 20                 TRA     s:25917
        20 004565   005245 710000 20                 TRA     s:25917
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:297  
        20 004566   005245 710000 20                 TRA     s:25917
        20 004567   005245 710000 20                 TRA     s:25917
        20 004570   005245 710000 20                 TRA     s:25917
        20 004571   005251 710000 20                 TRA     s:25920
        20 004572   005245 710000 20                 TRA     s:25917
        20 004573   005245 710000 20                 TRA     s:25917
        20 004574   005245 710000 20                 TRA     s:25917
        20 004575   005245 710000 20                 TRA     s:25917
        20 004576   005245 710000 20                 TRA     s:25917
        20 004577   005245 710000 20                 TRA     s:25917
        20 004600   005245 710000 20                 TRA     s:25917
        20 004601   005245 710000 20                 TRA     s:25917
        20 004602   005245 710000 20                 TRA     s:25917
        20 004603   005245 710000 20                 TRA     s:25917
        20 004604   005245 710000 20                 TRA     s:25917
        20 004605   005245 710000 20                 TRA     s:25917
        20 004606   005245 710000 20                 TRA     s:25917
        20 004607   005245 710000 20                 TRA     s:25917
        20 004610   005245 710000 20                 TRA     s:25917
        20 004611   005245 710000 20                 TRA     s:25917
        20 004612   005245 710000 20                 TRA     s:25917
        20 004613   005245 710000 20                 TRA     s:25917
        20 004614   005245 710000 20                 TRA     s:25917
        20 004615   005245 710000 20                 TRA     s:25917
        20 004616   005245 710000 20                 TRA     s:25917
        20 004617   005245 710000 20                 TRA     s:25917
        20 004620   005245 710000 20                 TRA     s:25917
        20 004621   005245 710000 20                 TRA     s:25917
        20 004622   004624 710000 20                 TRA     s:25755
        20 004623   005132 710000 20                 TRA     s:25875

     1798    25754    4          CASE( %TRANS_PSN );

     1799    25755    4            TOTAL_FILES = 0;

  25755 20 004624   000000 450000 xsym               STZ     TOTAL_FILES

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:298  
     1800    25756    4            TOTAL_GRANS = 0;

  25756 20 004625   000000 450000 xsym               STZ     TOTAL_GRANS

     1801    25757    4            TRANS_NBR = TRANS_NBR + 1;

  25757 20 004626   000000 054000 xsym               AOS     TRANS_NBR

     1802    25758    4            CALL FLB_DISK_DEST

  25758 20 004627   006314 701000 20                 TSX1    FLB_DISK_DEST
        20 004630   004632 702000 20                 TSX2    s:25762
        20 004631   004632 710000 20                 TRA     s:25762

     1803    25759    5             WHENALTRETURN DO;

     1804    25760    5               END;

     1805    25761
     1806    25762    4            CALL FLB_DISK_SPEC(0)

  25762 20 004632   000032 236000 21                 LDQ     26
        20 004633   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 004634   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 004635   004637 702000 20                 TSX2    s:25766
        20 004636   004637 710000 20                 TRA     s:25766

     1807    25763    5             WHENALTRETURN DO;

     1808    25764    5               END;

     1809    25765
     1810    25766    4            IF MODE = %TRANSFER AND TAPE_OPTION.PROTTYPE = %UNPROTECTED

  25766 20 004637   000250 235000 2                  LDA     MODE
        20 004640   004736 601000 20                 TNZ     s:25801
        20 004641   000001 236000 xsym               LDQ     TAPE_OPTION+1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:299  
        20 004642   700000 376003                    ANQ     -32768,DU
        20 004643   200000 116003                    CMPQ    65536,DU
        20 004644   004736 601000 20                 TNZ     s:25801

     1811    25767    5             THEN DO;

     1812    25768    5               DISK_OPTION.DELETE = '1'B;

  25768 20 004645   040000 236003                    LDQ     16384,DU
        20 004646   000002 256000 xsym               ORSQ    DISK_OPTION+2

     1813    25769    5               IF COMMAND = %OPEN_UPDATE

  25769 20 004647   000167 235000 2                  LDA     COMMAND
        20 004650   000044 115007                    CMPA    36,DL
        20 004651   004724 601000 20                 TNZ     s:25791

     1814    25770    6                THEN DO;

     1815    25771    6                  IF DISK_DEST_SN.SN#(0) = ' '

  25771 20 004652   040000 106400                    CMPC    fill='040'O
        20 004653   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6
        20 004654   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        20 004655   004666 601000 20                 TNZ     s:25777

     1816    25772    7                   THEN DO;

     1817    25773    7                     COMMAND_ERROR = '1'B;

  25773 20 004656   400000 236003                    LDQ     -131072,DU
        20 004657   000000 756000 xsym               STQ     COMMAND_ERROR

     1818    25774    7                     CALL FLI$RPT_ERR ( E_WIPEOUT_SOURCE );

  25774 20 004660   000067 630400 21                 EPPR0   55
        20 004661   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:300  
        20 004662   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 004663   000000 011000                    NOP     0

     1819    25775    7                     RETURN;

  25775 20 004664   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004665   000001 702211                    TSX2  ! 1,X1

     1820    25776    7                     END;
     1821    25777    6                  IF DISK_DEST_SN.SN#(0) = DPLIST.SN#(0)

  25777 20 004666   000000 470400 xsym               LDP0    DPLIST$
        20 004667   040100 106400                    CMPC    fill='040'O
        20 004670   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6
        20 004671   000001 000006                    ADSC9   1,,PR0                   cn=0,n=6
        20 004672   004724 601000 20                 TNZ     s:25791
        20 004673   000000 236000 xsym               LDQ     DISK_SRCHCOND
        20 004674   000400 316003                    CANQ    256,DU
        20 004675   004724 600000 20                 TZE     s:25791
        20 004676   000000 234000 xsym               SZN     DISK_OPTION
        20 004677   004724 605000 20                 TPL     s:25791

     1822    25778    6                    AND DISK_SRCHCOND.ANYF#
     1823    25779    6                    AND DISK_OPTION.DIR
     1824    25780    7                   THEN DO;

     1825    25781    7                     IF (DISK_DEST_ACCT.ACCT# = ' ')

  25781 20 004700   040000 106400                    CMPC    fill='040'O
        20 004701   000000 000010 xsym               ADSC9   DISK_DEST_ACCT           cn=0,n=8
        20 004702   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        20 004703   004714 600000 20                 TZE     s:25785
        20 004704   040000 106400                    CMPC    fill='040'O
        20 004705   000000 000010 xsym               ADSC9   DISK_DEST_ACCT           cn=0,n=8
        20 004706   000461 000010 2                  ADSC9   START_ACCT               cn=0,n=8
        20 004707   004724 601000 20                 TNZ     s:25791
        20 004710   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:301  
        20 004711   000000 000010 xsym               ADSC9   DISK_DEST_ACCT           cn=0,n=8
        20 004712   000473 000010 2                  ADSC9   STOP_ACCT                cn=0,n=8
        20 004713   004724 601000 20                 TNZ     s:25791

     1826    25782    7                       OR (DISK_DEST_ACCT.ACCT# = START_ACCT.ACCT#
     1827    25783    7                       AND DISK_DEST_ACCT.ACCT# = STOP_ACCT.ACCT#)
     1828    25784    8                      THEN DO;

     1829    25785    8                        COMMAND_ERROR = '1'B;

  25785 20 004714   400000 236003                    LDQ     -131072,DU
        20 004715   000000 756000 xsym               STQ     COMMAND_ERROR

     1830    25786    8                        CALL FLI$RPT_ERR( E_WIPEOUT_SOURCE );

  25786 20 004716   000067 630400 21                 EPPR0   55
        20 004717   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004720   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 004721   000000 011000                    NOP     0

     1831    25787    8                        RETURN;

  25787 20 004722   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004723   000001 702211                    TSX2  ! 1,X1

     1832    25788    8                        END;
     1833    25789    7                     END;
     1834    25790    6                  END;
     1835    25791    5               IF DISK_OPTION.SHARED /* Disallow sharing as file will be deleted */

  25791 20 004724   000004 234000 xsym               SZN     DISK_OPTION+4
        20 004725   004736 605000 20                 TPL     s:25801

     1836    25792    6                THEN DO;

     1837    25793    6                  COMMAND_ERROR = '1'B;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:302  
  25793 20 004726   400000 236003                    LDQ     -131072,DU
        20 004727   000000 756000 xsym               STQ     COMMAND_ERROR

     1838    25794    6                  CALL FLI$RPT_ERR ( E_CANT_SPECIFY_SHARED );

  25794 20 004730   000075 630400 21                 EPPR0   61
        20 004731   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004732   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 004733   000000 011000                    NOP     0

     1839    25795    6                  RETURN;

  25795 20 004734   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 004735   000001 702211                    TSX2  ! 1,X1

     1840    25796    6                  END;
     1841    25797    5               END;
     1842    25798        /***
     1843    25799         *** If destination account specified, scrub backup and stow information.
     1844    25800         ***/
     1845    25801    4            IF (COMMAND = %OPEN_UPDATE) AND (DISK_DEST_ACCT.ACCT# ~= ' ')

  25801 20 004736   000167 235000 2                  LDA     COMMAND
        20 004737   000044 115007                    CMPA    36,DL
        20 004740   004751 601000 20                 TNZ     s:25806
        20 004741   040000 106400                    CMPC    fill='040'O
        20 004742   000000 000010 xsym               ADSC9   DISK_DEST_ACCT           cn=0,n=8
        20 004743   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        20 004744   004751 600000 20                 TZE     s:25806

     1846    25802    5             THEN DO;

     1847    25803    5               DISK_OPTION.SCRUB.BACKUP = '1'B;

  25803 20 004745   400000 236003                    LDQ     -131072,DU
        20 004746   000002 256000 xsym               ORSQ    DISK_OPTION+2

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:303  
     1848    25804    5               DISK_OPTION.SCRUB.STOW = '1'B;

  25804 20 004747   100000 236003                    LDQ     32768,DU
        20 004750   000002 256000 xsym               ORSQ    DISK_OPTION+2

     1849    25805    5               END;

     1850    25806    4            DISK_OPTION.NOUPDATE = '1'B;

  25806 20 004751   001000 236003                    LDQ     512,DU
        20 004752   000000 256000 xsym               ORSQ    DISK_OPTION

     1851    25807    4            DISK_OPTION.XFER = '1'B;

  25807 20 004753   000400 236003                    LDQ     256,DU
        20 004754   000002 256000 xsym               ORSQ    DISK_OPTION+2

     1852    25808    4            TEMP_DISK_SRCHCOND = DISK_SRCHCOND;

  25808 20 004755   000000 220000 xsym               LDX0    DISK_SRCHCOND
        20 004756   000000 740000 xsym               STX0    TEMP_DISK_SRCHCOND

     1853    25809
     1854    25810    4            IF NOT COMMAND_ERROR

  25810 20 004757   000000 234000 xsym               SZN     COMMAND_ERROR
        20 004760   004766 604000 20                 TMI     s:25816

     1855    25811    5             THEN DO;

     1856    25812    5               CALL FLM$MOVE(STATE)

  25812 20 004761   000076 630400 21                 EPPR0   62
        20 004762   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 004763   000000 701000 xent               TSX1    FLM$MOVE
        20 004764   004766 702000 20                 TSX2    s:25816
        20 004765   004766 710000 20                 TRA     s:25816
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:304  

     1857    25813    6                WHENALTRETURN DO;

     1858    25814    6                  END;

     1859    25815    5               END;

     1860    25816    4            GRAND_TOTAL_FILES = GRAND_TOTAL_FILES + TOTAL_FILES;

  25816 20 004766   200005 236100                    LDQ     GRAND_TOTAL_FILES,,AUTO
        20 004767   000000 036000 xsym               ADLQ    TOTAL_FILES
        20 004770   200005 756100                    STQ     GRAND_TOTAL_FILES,,AUTO

     1861    25817    4            GRAND_TOTAL_GRANS = GRAND_TOTAL_GRANS + TOTAL_GRANS;

  25817 20 004771   200006 236100                    LDQ     GRAND_TOTAL_GRANS,,AUTO
        20 004772   000000 036000 xsym               ADLQ    TOTAL_GRANS
        20 004773   200006 756100                    STQ     GRAND_TOTAL_GRANS,,AUTO

     1862    25818    4            CALL FLI$STATS;

  25818 20 004774   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 004775   000000 701000 xent               TSX1    FLI$STATS
        20 004776   000000 011000                    NOP     0

     1863    25819
     1864    25820    4            IF CHECK_TAPE AND (COMMAND = %OPEN_CREATE OR COMMAND = %OPEN_EXTEND)

  25820 20 004777   000165 234000 2                  SZN     CHECK_TAPE
        20 005000   005251 605000 20                 TPL     s:25920
        20 005001   000167 235000 2                  LDA     COMMAND
        20 005002   000045 115007                    CMPA    37,DL
        20 005003   005006 600000 20                 TZE     s:25820+7
        20 005004   000046 115007                    CMPA    38,DL
        20 005005   005251 601000 20                 TNZ     s:25920
        20 005006   000000 234000 xsym               SZN     COMMAND_ERROR
        20 005007   005251 604000 20                 TMI     s:25920
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:305  

     1865    25821    4              AND NOT COMMAND_ERROR
     1866    25822    5             THEN DO;                      /* Check tape now                     */

     1867    25823        /***
     1868    25824         *** Preserve FPT parameters and FSN (FPT and dcb reinitialized during CHECK).
     1869    25825         *** Note if no files written on last call to FLM$MOVE, dcb unopened so VOL# has
     1870    25826         *** initialization value. Preserve previous volume number (higher value).
     1871    25827         ***/
     1872    25828    5               SAVE_TAPE_OPEN.V = TAPE_OPEN.V; /* Save the OPEN parameters       */

  25828 20 005010   000000 100400                    MLR     fill='000'O
        20 005011   000044 000124 xsym               ADSC9   TAPE_OPEN+36             cn=0,n=84
        20 005012   001770 000124 2                  ADSC9   SAVE_TAPE_OPEN+36        cn=0,n=84

     1873    25829    5               IF TAPE_DCBLIST.DCB$(0)->F$DCB.VOL# > DEST_TAPE_VOL_SAVE

  25829 20 005013   000000 470400 xsym               LDP0    TAPE_DCBLIST$
        20 005014   000001 471500                    LDP1    1,,PR0
        20 005015   100043 236100                    LDQ     35,,PR1
        20 005016   000033 772000                    QRL     27
        20 005017   200010 116100                    CMPQ    DEST_TAPE_VOL_SAVE,,AUTO
        20 005020   005022 604400 20                 TMOZ    s:25831

     1874    25830    5                THEN DEST_TAPE_VOL_SAVE = TAPE_DCBLIST.DCB$(0)->F$DCB.VOL#;

  25830 20 005021   200010 756100                    STQ     DEST_TAPE_VOL_SAVE,,AUTO

     1875    25831    5               CALL FLI$TSN_USED( 1,0 )    /* Files copied?                      */

  25831 20 005022   000077 630400 21                 EPPR0   63
        20 005023   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 005024   000000 701000 xent               TSX1    FLI$TSN_USED
        20 005025   005071 702000 20                 TSX2    s:25853

     1876    25832    6                WHENRETURN DO;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:306  
     1877    25833    6                  CALL M$CLOSE( CLOSE_TSN_USED ) /* Yep, check them              */

  25833 20 005026   000000 630400 xsym               EPPR0   CLOSE_TSN_USED
        20 005027   450001 713400                    CLIMB   alt,close
        20 005030   406000 401760                    pmme    nvectors=13
        20 005031   005033 702000 20                 TSX2    s:25836
        20 005032   005033 710000 20                 TRA     s:25836

     1878    25834    7                   WHENALTRETURN DO;

     1879    25835    7                     END;

     1880    25836    6                  TAPE_OPEN.SN_ = VECTOR(ERASE);

  25836 20 005033   000034 237000 21                 LDAQ    28
        20 005034   000002 757000 xsym               STAQ    TAPE_OPEN+2

     1881    25837    6                  DISK_SRCHCOND = '0'B;

  25837 20 005035   000000 220003                    LDX0    0,DU
        20 005036   000000 740000 xsym               STX0    DISK_SRCHCOND

     1882    25838    6                  IF TEMP_DISK_SRCHCOND.ANYF#

  25838 20 005037   000000 236000 xsym               LDQ     TEMP_DISK_SRCHCOND
        20 005040   000400 316003                    CANQ    256,DU
        20 005041   005044 600000 20                 TZE     s:25840

     1883    25839    6                   THEN DISK_SRCHCOND.ANYF# = '1'B;

  25839 20 005042   000400 236003                    LDQ     256,DU
        20 005043   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     1884    25840    6                  TAPE_OPTION.CHECK = '1'B;

  25840 20 005044   400000 236003                    LDQ     -131072,DU
        20 005045   000000 256000 xsym               ORSQ    TAPE_OPTION
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:307  

     1885    25841    6                  IF DISK_FILE_SPEC$ ~= ADDR(NIL)

  25841 20 005046   000000 236000 xsym               LDQ     DISK_FILE_SPEC$
        20 005047   000001 116000 xsym               CMPQ    B_VECTNIL+1
        20 005050   005070 600000 20                 TZE     s:25851

     1886    25842    7                   THEN DO;

     1887    25843    7                     DISK_FILE_SPEC.NBR = 0;

  25843 20 005051   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 005052   000000 450100                    STZ     0,,PR0

     1888    25844    7                     CALL FLM$MOVE( %CHECK )

  25844 20 005053   000101 630400 21                 EPPR0   65
        20 005054   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 005055   000000 701000 xent               TSX1    FLM$MOVE
        20 005056   005060 702000 20                 TSX2    s:25847
        20 005057   005060 710000 20                 TRA     s:25847

     1889    25845    8                      WHENALTRETURN DO;

     1890    25846    8                        END;

     1891    25847    7                     TAPE_OPEN.V = SAVE_TAPE_OPEN.V;

  25847 20 005060   000000 100400                    MLR     fill='000'O
        20 005061   001770 000124 2                  ADSC9   SAVE_TAPE_OPEN+36        cn=0,n=84
        20 005062   000044 000124 xsym               ADSC9   TAPE_OPEN+36             cn=0,n=84

     1892    25848    7                     TAPE_OPEN.V.VOL# = DEST_TAPE_VOL_SAVE;

  25848 20 005063   200010 236100                    LDQ     DEST_TAPE_VOL_SAVE,,AUTO
        20 005064   000033 736000                    QLS     27
        20 005065   000061 552040 xsym               STBQ    TAPE_OPEN+49,'40'O
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:308  

     1893    25849    7                     TAPE_OPTION.CHECK = '0'B;

  25849 20 005066   000031 236000 xsym               LDQ     B_VECTNIL+25
        20 005067   000000 356000 xsym               ANSQ    TAPE_OPTION

     1894    25850    7                     END;

     1895    25851    6                  END;

  25851 20 005070   005076 710000 20                 TRA     s:25857

     1896    25852    6                WHENALTRETURN DO;

     1897    25853    6                  CALL M$CLOSE( CLOSE_TSN_USED )

  25853 20 005071   000000 630400 xsym               EPPR0   CLOSE_TSN_USED
        20 005072   450001 713400                    CLIMB   alt,close
        20 005073   406000 401760                    pmme    nvectors=13
        20 005074   005076 702000 20                 TSX2    s:25857
        20 005075   005076 710000 20                 TRA     s:25857

     1898    25854    7                   WHENALTRETURN DO;

     1899    25855    7                     END;

     1900    25856    6                  END;

     1901    25857    5               END;

  25857 20 005076   005251 710000 20                 TRA     s:25920

     1902    25858
     1903    25859    4          CASE( %NULL);

     1904    25860
     1905    25861    4          CASE( %HELP );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:309  

     1906    25862    4            BREAK_TASK = 'Helping!';

  25862 20 005077   040000 100400                    MLR     fill='040'O
        20 005100   000100 000010 19                 ADSC9   LEGAL_CHAR+18            cn=0,n=8
        20 005101   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

     1907    25863    4            XUH_PARAM.HELP$ = NODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXTC$;

  25863 20 005102   000003 471500                    LDP1    3,,PR0
        20 005103   100003 236100                    LDQ     3,,PR1
        20 005104   000355 756000 2                  STQ     XUH_PARAM+9

     1908    25864    4            CALL XUR$HELP( XUH_PARAM );

  25864 20 005105   000017 630400 21                 EPPR0   15
        20 005106   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 005107   000000 701000 xent               TSX1    XUR$HELP
        20 005110   000000 011000                    NOP     0
        20 005111   005251 710000 20                 TRA     s:25920

     1909    25865
     1910    25866    4          CASE( %MORE_HELP );

     1911    25867    4            BREAK_TASK = 'Helping!';

  25867 20 005112   040000 100400                    MLR     fill='040'O
        20 005113   000100 000010 19                 ADSC9   LEGAL_CHAR+18            cn=0,n=8
        20 005114   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

     1912    25868    4            CALL XUR$MOREMSG( XUH_PARAM );

  25868 20 005115   000017 630400 21                 EPPR0   15
        20 005116   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 005117   000000 701000 xent               TSX1    XUR$MOREMSG
        20 005120   000000 011000                    NOP     0
        20 005121   005251 710000 20                 TRA     s:25920
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:310  

     1913    25869
     1914    25870    4          CASE( %ALL_HELP );

     1915    25871    4            BREAK_TASK = 'Helping!';

  25871 20 005122   040000 100400                    MLR     fill='040'O
        20 005123   000100 000010 19                 ADSC9   LEGAL_CHAR+18            cn=0,n=8
        20 005124   000157 000022 2                  ADSC9   BREAK_TASK               cn=0,n=18

     1916    25872    4            CALL XUR$ALLMSG( XUH_PARAM );

  25872 20 005125   000017 630400 21                 EPPR0   15
        20 005126   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 005127   000000 701000 xent               TSX1    XUR$ALLMSG
        20 005130   000000 011000                    NOP     0
        20 005131   005251 710000 20                 TRA     s:25920

     1917    25873
     1918    25874    4          CASE( %CLOSE);

     1919    25875    5            DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;

  25875 20 005132   000232 450000 2                  STZ     SUBNODEX
        20 005133   005217 710000 20                 TRA     s:25902+1

     1920    25876    5               SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);

  25876 20 005134   000226 470400 2                  LDP0    NODE$
        20 005135   000232 720000 2                  LXL0    SUBNODEX
        20 005136   000003 236110                    LDQ     3,X0,PR0
        20 005137   000231 756000 2                  STQ     SUBNODE$

     1921    25877
     1922    25878    6               DO CASE ( SUBNODE$->OUT$BLK.CODE ) ;

  25878 20 005140   000231 471400 2                  LDP1    SUBNODE$
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:311  
        20 005141   100000 721100                    LXL1    0,,PR1
        20 005142   000002 101003                    CMPX1   2,DU
        20 005143   005145 602011 20                 TNC     s:25878+5,X1
        20 005144   005216 710000 20                 TRA     s:25902
        20 005145   005216 710000 20                 TRA     s:25902
        20 005146   005147 710000 20                 TRA     s:25881

     1923    25879
     1924    25880    6                CASE ( %CLOSE_REMOVE );

     1925    25881    6                  IF TAPE_DCBLIST$ ~= ADDR(NIL)

  25881 20 005147   000000 236000 xsym               LDQ     TAPE_DCBLIST$
        20 005150   000001 116000 xsym               CMPQ    B_VECTNIL+1
        20 005151   005177 600000 20                 TZE     s:25893

     1926    25882    6                   THEN
     1927    25883    7                  DO;

     1928    25884    7                     FPT_REM.V.DISP# = %REM#;

  25884 20 005152   002000 236003                    LDQ     1024,DU
        20 005153   001512 552040 2                  STBQ    FPT_REM+2,'40'O

     1929    25885    8                     DO I = 0 TO NBR_SNLISTS - 1;

  25885 20 005154   000213 450000 2                  STZ     I
        20 005155   005173 710000 20                 TRA     s:25890+1

     1930    25886    8                        FPT_REM.V.PSN# = TAPE_DCBLIST.DCB$(I)->F$DCB.PSN#;

  25886 20 005156   000213 235000 2                  LDA     I
        20 005157   000001 735000                    ALS     1
        20 005160   000000 470400 xsym               LDP0    TAPE_DCBLIST$
        20 005161   000001 471505                    LDP1    1,AL,PR0
        20 005162   040000 100500                    MLR     fill='040'O
        20 005163   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:312  
        20 005164   001512 400006 2                  ADSC9   FPT_REM+2                cn=2,n=6

     1931    25887    8                        CALL M$REM(FPT_REM)

  25887 20 005165   001510 630400 2                  EPPR0   FPT_REM
        20 005166   460006 713400                    CLIMB   alt,+24582
        20 005167   400000 401760                    pmme    nvectors=1
        20 005170   005172 702000 20                 TSX2    s:25890
        20 005171   005172 710000 20                 TRA     s:25890

     1932    25888    9                         WHENALTRETURN DO;

     1933    25889    9                           END;

     1934    25890    8                        END;

  25890 20 005172   000213 054000 2                  AOS     I
        20 005173   000213 236000 2                  LDQ     I
        20 005174   000000 116000 xsym               CMPQ    NBR_SNLISTS
        20 005175   005156 604000 20                 TMI     s:25886

     1935    25891    7                     END;

  25891 20 005176   005216 710000 20                 TRA     s:25902

     1936    25892    7                   ELSE DO;

     1937    25893    7                     IF COMMAND = %OPEN_INPUT

  25893 20 005177   000167 235000 2                  LDA     COMMAND
        20 005200   000047 115007                    CMPA    39,DL
        20 005201   005216 601000 20                 TNZ     s:25902

     1938    25894    8                      THEN DO;

     1939    25895    8                        FPT_REM.V.PSN# = DCBADDR(DCBNUM(M$TAPE00))->F$DCB.PSN#;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:313  
  25895 20 005202   000000 236007 xsym               LDQ     M$TAPE00,DL
        20 005203   000000 473400 21                 LDP3    0
        20 005204   300000 474500                    LDP4    0,,PR3
        20 005205   400000 475506                    LDP5    0,QL,PR4
        20 005206   040000 100500                    MLR     fill='040'O
        20 005207   500024 000006                    ADSC9   20,,PR5                  cn=0,n=6
        20 005210   001512 400006 2                  ADSC9   FPT_REM+2                cn=2,n=6

     1940    25896    8                        CALL M$REM( FPT_REM )

  25896 20 005211   001510 630400 2                  EPPR0   FPT_REM
        20 005212   460006 713400                    CLIMB   alt,+24582
        20 005213   400000 401760                    pmme    nvectors=1
        20 005214   005216 702000 20                 TSX2    s:25902
        20 005215   005216 710000 20                 TRA     s:25902

     1941    25897    9                         WHENALTRETURN DO;

     1942    25898    9                           END;

     1943    25899    8                        END;

     1944    25900    7                     END;

     1945    25901    6                END;

     1946    25902    5               END;

  25902 20 005216   000232 054000 2                  AOS     SUBNODEX
        20 005217   000226 470400 2                  LDP0    NODE$
        20 005220   000001 236100                    LDQ     1,,PR0
        20 005221   000022 772000                    QRL     18
        20 005222   000232 116000 2                  CMPQ    SUBNODEX
        20 005223   005134 605400 20                 TPNZ    s:25876

     1947    25903    4            IF TOTAL_FILES ~= GRAND_TOTAL_FILES

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:314  
  25903 20 005224   000000 236000 xsym               LDQ     TOTAL_FILES
        20 005225   200005 116100                    CMPQ    GRAND_TOTAL_FILES,,AUTO
        20 005226   005243 600000 20                 TZE     s:25914

     1948    25904    5             THEN DO;

     1949    25905    5               ACCUMULATED_MOUNT_TIME = 0;

  25905 20 005227   000000 450000 xsym               STZ     ACCUMULATED_MOUNT_TIME

     1950    25906    5               ACCUMULATED_SPIN_TIME = 0;

  25906 20 005230   000000 450000 xsym               STZ     ACCUMULATED_SPIN_TIME

     1951    25907    5               ACCUMULATED_BREAK_TIME = 0;

  25907 20 005231   000000 450000 xsym               STZ     ACCUMULATED_BREAK_TIME

     1952    25908    5               TOTAL_FILES = GRAND_TOTAL_FILES;

  25908 20 005232   200005 235100                    LDA     GRAND_TOTAL_FILES,,AUTO
        20 005233   000000 755000 xsym               STA     TOTAL_FILES

     1953    25909    5               TOTAL_GRANS = GRAND_TOTAL_GRANS;

  25909 20 005234   200006 236100                    LDQ     GRAND_TOTAL_GRANS,,AUTO
        20 005235   000000 756000 xsym               STQ     TOTAL_GRANS

     1954    25910    5               START_UTS = GRAND_START_UTS;

  25910 20 005236   200007 235100                    LDA     GRAND_START_UTS,,AUTO
        20 005237   000000 755000 xsym               STA     START_UTS

     1955    25911    5               CALL FLI$STATS;

  25911 20 005240   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 005241   000000 701000 xent               TSX1    FLI$STATS
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:315  
        20 005242   000000 011000                    NOP     0

     1956    25912    5               END;

     1957    25913
     1958    25914    4            RETURN;

  25914 20 005243   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 005244   000001 702211                    TSX2  ! 1,X1

     1959    25915
     1960    25916    4          CASE (ELSE);

     1961    25917    4            CALL FLI$RPT_ERR(E_RETURN_TO_COMMAND,);

  25917 20 005245   000102 630400 21                 EPPR0   66
        20 005246   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 005247   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 005250   000000 011000                    NOP     0

     1962    25918    4          END;

     1963    25919
     1964    25920    4         DO WHILE('0'B);

  25920 20 005251   004502 710000 20                 TRA     s:25739

     1965    25921    4   TELL_ERROR: ;

  25921 20 005252                       TELL_ERROR   null
     1966    25922    4            IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR

  25922 20 005252   000004 236000 xsym               LDQ     FPT_EXIT+4
        20 005253   777000 376003                    ANQ     -512,DU
        20 005254   002000 116003                    CMPQ    1024,DU
        20 005255   005260 603000 20                 TRC     s:25924

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:316  
     1967    25923    4             THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;

  25923 20 005256   002000 236003                    LDQ     1024,DU
        20 005257   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

     1968    25924    4            CALL XUR$ECHOIF( DCBNUM(M$LO) );

  25924 20 005260   000000 236007 xsym               LDQ     M$LO,DL
        20 005261   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 005262   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 005263   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 005264   200043 630500                    EPPR0   @MAX_NX+2,,AUTO
        20 005265   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 005266   000000 701000 xent               TSX1    XUR$ECHOIF
        20 005267   000000 011000                    NOP     0

     1969    25925    4            IF NOT ERR.MON

  25925 20 005270   000226 236000 2                  LDQ     NODE$
        20 005271   400000 316007                    CANQ    -131072,DL
        20 005272   005307 601000 20                 TNZ     s:25930

     1970    25926    5             THEN DO;

     1971    25927    5               IF EFT_CMD_PCB.HI_CHAR > 0

  25927 20 005273   000267 235000 2                  LDA     EFT_CMD_PCB+10
        20 005274   005307 600000 20                 TZE     s:25930

     1972    25928    5                THEN CALL XUR$ERRPTR( ,DCBNUM(M$DO) );

  25928 20 005275   000000 236007 xsym               LDQ     M$DO,DL
        20 005276   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 005277   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 005300   200045 450500                    STP0    @MAX_NX+4,,AUTO
        20 005301   000001 236000 xsym               LDQ     B_VECTNIL+1
        20 005302   200044 756100                    STQ     @MAX_NX+3,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:317  
        20 005303   200044 630500                    EPPR0   @MAX_NX+3,,AUTO
        20 005304   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 005305   000000 701000 xent               TSX1    XUR$ERRPTR
        20 005306   000000 011000                    NOP     0

     1973    25929    5               END;

     1974    25930    4            IF ERR.ERR# ~= %E$EOF

  25930 20 005307   000226 236000 2                  LDQ     NODE$
        20 005310   377770 376007                    ANQ     131064,DL
        20 005311   000060 116007                    CMPQ    48,DL
        20 005312   005322 600000 20                 TZE     s:25936

     1975    25931    5             THEN DO;

     1976    25932    5               COMMAND_ERROR = '1'B;

  25932 20 005313   400000 236003                    LDQ     -131072,DU
        20 005314   000000 756000 xsym               STQ     COMMAND_ERROR

     1977    25933    5               CALL XUR$ERRMSG( ERR );

  25933 20 005315   000011 630400 21                 EPPR0   9
        20 005316   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 005317   000000 701000 xent               TSX1    XUR$ERRMSG
        20 005320   000000 011000                    NOP     0

     1978    25934    5               END;

  25934 20 005321   005350 710000 20                 TRA     s:25945

     1979    25935    5             ELSE DO;

     1980    25936    5               IF NOT M$READ_FILE$->F$DCB.FCD#

  25936 20 005322   000214 470400 2                  LDP0    M$READ_FILE$
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:318  
        20 005323   000031 236100                    LDQ     25,,PR0
        20 005324   020000 316007                    CANQ    8192,DL
        20 005325   005335 601000 20                 TNZ     s:25941

     1981    25937    6                THEN DO;              /* Must be EOF on primary command stream   */

     1982    25938    6                  CALL XUR$ERRMSG( ERR );

  25938 20 005326   000011 630400 21                 EPPR0   9
        20 005327   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 005330   000000 701000 xent               TSX1    XUR$ERRMSG
        20 005331   000000 011000                    NOP     0

     1983    25939    6                  CALL M$EXIT( FPT_EXIT );

  25939 20 005332   000000 630400 xsym               EPPR0   FPT_EXIT
        20 005333   000001 713400                    CLIMB   exit
        20 005334   400400 401760                    pmme    nvectors=2

     1984    25940    6                  END;

     1985    25941    5               CALL M$CLOSE( CLOSE_READ_FILE );

  25941 20 005335   001166 630400 2                  EPPR0   CLOSE_READ_FILE
        20 005336   050001 713400                    CLIMB   close
        20 005337   406000 401760                    pmme    nvectors=13

     1986    25942    5               CALL XUR$SETDCBS( DCBNUM(M$SI), );

  25942 20 005340   000000 236007 xsym               LDQ     M$SI,DL
        20 005341   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 005342   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 005343   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 005344   200043 630500                    EPPR0   @MAX_NX+2,,AUTO
        20 005345   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 005346   000000 701000 xent               TSX1    XUR$SETDCBS
        20 005347   000000 011000                    NOP     0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:319  

     1987    25943    5               END;

     1988    25944    4            END;

     1989    25945    3         END;                              /* Subcommand loop                    */

  25945 20 005350   004502 710000 20                 TRA     s:25739

     1990    25946    2   END FLB_OPEN_NODES;
     1991    25947        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:320  
     1992    25948    1   FLB_STATUS_NODES:PROC;

  25948 20 005351   200004 741300       FLB_STATUS_* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     1993    25949        /*F*  NAME:FLB_STATUS_NODES
     1994    25950              PURPOSE: Process STATUS command.
     1995    25951        */
     1996    25952
     1997    25953
     1998    25954    2      CALL FLB_DISK_SPEC(0)

  25954 20 005352   000032 236000 21                 LDQ     26
        20 005353   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 005354   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 005355   005357 702000 20                 TSX2    s:25956
        20 005356   005361 710000 20                 TRA     s:25959

     1999    25955    3       WHENALTRETURN DO;

     2000    25956    3         RETURN;

  25956 20 005357   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 005360   000001 702211                    TSX2  ! 1,X1

     2001    25957    3         END;
     2002    25958
     2003    25959    2      NBR_CONTROL_FILE = 0;

  25959 20 005361   000000 450000 xsym               STZ     NBR_CONTROL_FILE

     2004    25960    3      DO SUBNODEX = 0 TO NODE$ -> OUT$BLK.NSUBLKS - 1;

  25960 20 005362   000232 450000 2                  STZ     SUBNODEX
        20 005363   005421 710000 20                 TRA     s:25970+1

     2005    25961    3         SUBNODE$ = NODE$ -> OUT$BLK.SUBLK$ ( SUBNODEX );

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:321  
  25961 20 005364   000226 470400 2                  LDP0    NODE$
        20 005365   000232 720000 2                  LXL0    SUBNODEX
        20 005366   000003 236110                    LDQ     3,X0,PR0
        20 005367   000231 756000 2                  STQ     SUBNODE$

     2006    25962    4         DO CASE ( SUBNODE$ -> OUT$BLK.CODE );

  25962 20 005370   000231 471400 2                  LDP1    SUBNODE$
        20 005371   100000 236100                    LDQ     0,,PR1
        20 005372   777777 376007                    ANQ     -1,DL
        20 005373   000011 136007                    SBLQ    9,DL
        20 005374   000001 116007                    CMPQ    1,DL
        20 005375   005377 602006 20                 TNC     s:25962+7,QL
        20 005376   005420 710000 20                 TRA     s:25970
        20 005377   005400 710000 20                 TRA     s:25964

     2007    25963    4          CASE ( %CONTROL_FILE );

     2008    25964    4            NBR_CONTROL_FILE = SUBNODE$ -> OUT$BLK.NSUBLKS;

  25964 20 005400   100001 236100                    LDQ     1,,PR1
        20 005401   000022 772000                    QRL     18
        20 005402   000000 756000 xsym               STQ     NBR_CONTROL_FILE

     2009    25965    5            DO I = 0 TO NBR_CONTROL_FILE - 1;

  25965 20 005403   000213 450000 2                  STZ     I
        20 005404   005414 710000 20                 TRA     s:25968+1

     2010    25966    5               CONTROL_LIST ( I ) = SUBNODE$ -> OUT$BLK.SUBLK$(I) ->

  25966 20 005405   000231 470400 2                  LDP0    SUBNODE$
        20 005406   000213 720000 2                  LXL0    I
        20 005407   000003 471510                    LDP1    3,X0,PR0
        20 005410   100000 236100                    LDQ     0,,PR1
        20 005411   777777 376007                    ANQ     -1,DL
        20 005412   000000 756010 xsym               STQ     CONTROL_LIST,X0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:322  

     2011    25967    5                 OUT$BLK.CODE;
     2012    25968    5               END;

  25968 20 005413   000213 054000 2                  AOS     I
        20 005414   000213 236000 2                  LDQ     I
        20 005415   005405 604000 20                 TMI     s:25966
        20 005416   000000 116000 xsym               CMPQ    NBR_CONTROL_FILE
        20 005417   005405 602000 20                 TNC     s:25966

     2013    25969    4          END;

     2014    25970    3         END;

  25970 20 005420   000232 054000 2                  AOS     SUBNODEX
        20 005421   000226 470400 2                  LDP0    NODE$
        20 005422   000001 236100                    LDQ     1,,PR0
        20 005423   000022 772000                    QRL     18
        20 005424   000232 116000 2                  CMPQ    SUBNODEX
        20 005425   005364 605400 20                 TPNZ    s:25961

     2015    25971    2      IF NBR_CONTROL_FILE = 0

  25971 20 005426   000000 235000 xsym               LDA     NBR_CONTROL_FILE
        20 005427   005445 601000 20                 TNZ     s:25986

     2016    25972    3       THEN DO;

     2017    25973    3         CONTROL_LIST ( 0 ) = %BACKUP_FILE;

  25973 20 005430   000000 450000 xsym               STZ     CONTROL_LIST

     2018    25974    3         CONTROL_LIST ( 1 ) = %PRIME_FILE;

  25974 20 005431   000001 235007                    LDA     1,DL
        20 005432   000001 755000 xsym               STA     CONTROL_LIST+1

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:323  
     2019    25975    3         CONTROL_LIST ( 2 ) = %DUAL_FILE;

  25975 20 005433   000002 236007                    LDQ     2,DL
        20 005434   000002 756000 xsym               STQ     CONTROL_LIST+2

     2020    25976    3         CONTROL_LIST ( 3 ) = %ARCHIVE_FILE;

  25976 20 005435   000003 235007                    LDA     3,DL
        20 005436   000003 755000 xsym               STA     CONTROL_LIST+3

     2021    25977    3         CONTROL_LIST ( 4 ) = %REBUILD_FILE;

  25977 20 005437   000004 235007                    LDA     4,DL
        20 005440   000004 755000 xsym               STA     CONTROL_LIST+4

     2022    25978    3         CONTROL_LIST ( 5 ) = %NODATA_FILE;

  25978 20 005441   000005 235007                    LDA     5,DL
        20 005442   000005 755000 xsym               STA     CONTROL_LIST+5

     2023    25979    3         NBR_CONTROL_FILE = 6;

  25979 20 005443   000006 235007                    LDA     6,DL
        20 005444   000000 755000 xsym               STA     NBR_CONTROL_FILE

     2024    25980    3         END;

     2025    25981
     2026    25982         /***
     2027    25983          *** Command is fine.  Go for it.
     2028    25984          ***/
     2029    25985
     2030    25986    2      CALL FLS$STATUS;

  25986 20 005445   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 005446   000000 701000 xent               TSX1    FLS$STATUS
        20 005447   000000 011000                    NOP     0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:324  

     2031    25987
     2032    25988    2   END FLB_STATUS_NODES;

  25988 20 005450   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 005451   000001 702211                    TSX2  ! 1,X1

     2033    25989        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:325  
     2034    25990    1   FLB_RESTORE_NODES: PROC;

  25990 20 005452   200004 741300       FLB_RESTORE* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     2035    25991        /*F*  NAME: FLB_RESTORE_NODES
     2036    25992              PURPOSE: Process RESTORE nodes.
     2037    25993        */
     2038    25994
     2039    25995        /****************************************/
     2040    25996
     2041    25997    2      IF NODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %TAPE_SOURCE

  25997 20 005453   000226 470400 2                  LDP0    NODE$
        20 005454   000003 471500                    LDP1    3,,PR0
        20 005455   100000 720100                    LXL0    0,,PR1
        20 005456   000004 100003                    CMPX0   4,DU
        20 005457   005465 601000 20                 TNZ     s:26003

     2042    25998    3       THEN DO;

     2043    25999    3         RESTORE_FROM_TAPE = '1'B;

  25999 20 005460   400000 236003                    LDQ     -131072,DU
        20 005461   000164 756000 2                  STQ     RESTORE_FROM_TAPE

     2044    26000    3         CALL FLB_TAPE_NODES;

  26000 20 005462   002402 701000 20                 TSX1    FLB_TAPE_NODES
        20 005463   000000 011000                    NOP     0

     2045    26001    3         END;

  26001 20 005464   005523 710000 20                 TRA     s:26019

     2046    26002    3       ELSE DO;

     2047    26003    3         RESTORE_FROM_TAPE = '0'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:326  

  26003 20 005465   000164 450000 2                  STZ     RESTORE_FROM_TAPE

     2048    26004    3         CALL FLB_DISK_SPEC(0)

  26004 20 005466   000032 236000 21                 LDQ     26
        20 005467   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 005470   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 005471   005473 702000 20                 TSX2    s:26007
        20 005472   005473 710000 20                 TRA     s:26007

     2049    26005    4          WHENALTRETURN DO;

     2050    26006    4            END;

     2051    26007    3         IF COMMAND_ERROR THEN RETURN;

  26007 20 005473   000000 234000 xsym               SZN     COMMAND_ERROR
        20 005474   005477 605000 20                 TPL     s:26008

  26007 20 005475   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 005476   000001 702211                    TSX2  ! 1,X1

     2052    26008    3         CALL FLB_DISK_DEST

  26008 20 005477   006314 701000 20                 TSX1    FLB_DISK_DEST
        20 005500   005501 702000 20                 TSX2    s:26011

     2053    26009    4          WHENRETURN DO;

     2054    26010    4            END;

     2055    26011    3         IF COMMAND_ERROR THEN RETURN;

  26011 20 005501   000000 234000 xsym               SZN     COMMAND_ERROR
        20 005502   005505 605000 20                 TPL     s:26012

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:327  
  26011 20 005503   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 005504   000001 702211                    TSX2  ! 1,X1

     2056    26012    3         CALL FLM$MOVE( %RESTORE )

  26012 20 005505   000103 630400 21                 EPPR0   67
        20 005506   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 005507   000000 701000 xent               TSX1    FLM$MOVE
        20 005510   005512 702000 20                 TSX2    s:26014
        20 005511   005520 710000 20                 TRA     s:26017

     2057    26013    4          WHENALTRETURN DO;

     2058    26014    4            IF FPT_EXIT.V.STEPCC# < %SERIOUS_ERROR

  26014 20 005512   000004 236000 xsym               LDQ     FPT_EXIT+4
        20 005513   777000 376003                    ANQ     -512,DU
        20 005514   002000 116003                    CMPQ    1024,DU
        20 005515   005520 603000 20                 TRC     s:26017

     2059    26015    4             THEN FPT_EXIT.V.STEPCC# = %SERIOUS_ERROR;

  26015 20 005516   002000 236003                    LDQ     1024,DU
        20 005517   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

     2060    26016    4            END;

     2061    26017    3         CALL FLI$STATS;

  26017 20 005520   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 005521   000000 701000 xent               TSX1    FLI$STATS
        20 005522   000000 011000                    NOP     0

     2062    26018    3         END;

     2063    26019    2      RETURN;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:328  
  26019 20 005523   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 005524   000001 702211                    TSX2  ! 1,X1

     2064    26020    2   END FLB_RESTORE_NODES;
     2065    26021        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:329  
     2066    26022    1   FLB_REBUILD_NODES: PROC;

  26022 20 005525   200004 741300       FLB_REBUILD* STX1  ! CHECK_SRCH_BIT+1,,AUTO

     2067    26023        /*F*  NAME: FLB_REBUILD_NODES
     2068    26024              PURPOSE: Process REBUILD nodes.
     2069    26025        */
     2070    26026
     2071    26027    2   DCL I UBIN AUTO;
     2072    26028    2   DCL FSN_SPECD BIT(1) AUTO;
     2073    26029    2   DCL TEMP$ PTR AUTO;
     2074    26030
     2075    26031
     2076    26032        /****************************************/
     2077    26033
     2078    26034    2      SOURCE_TAPE_SNLIST$ = ADDR(NIL);

  26034 20 005526   000001 236000 xsym               LDQ     B_VECTNIL+1
        20 005527   000230 756000 2                  STQ     SOURCE_TAPE_SNLIST$

     2079    26035    3      DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;

  26035 20 005530   000232 450000 2                  STZ     SUBNODEX
        20 005531   005710 710000 20                 TRA     s:26087+1

     2080    26036    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);

  26036 20 005532   000226 470400 2                  LDP0    NODE$
        20 005533   000232 720000 2                  LXL0    SUBNODEX
        20 005534   000003 236110                    LDQ     3,X0,PR0
        20 005535   000231 756000 2                  STQ     SUBNODE$

     2081    26037
     2082    26038    4         DO CASE( SUBNODE$->OUT$BLK.CODE );

  26038 20 005536   000231 471400 2                  LDP1    SUBNODE$
        20 005537   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:330  
        20 005540   777777 376007                    ANQ     -1,DL
        20 005541   000004 136007                    SBLQ    4,DL
        20 005542   000012 116007                    CMPQ    10,DL
        20 005543   005545 602006 20                 TNC     s:26038+7,QL
        20 005544   005707 710000 20                 TRA     s:26087
        20 005545   005570 710000 20                 TRA     s:26044
        20 005546   005707 710000 20                 TRA     s:26087
        20 005547   005707 710000 20                 TRA     s:26087
        20 005550   005707 710000 20                 TRA     s:26087
        20 005551   005707 710000 20                 TRA     s:26087
        20 005552   005707 710000 20                 TRA     s:26087
        20 005553   005707 710000 20                 TRA     s:26087
        20 005554   005557 710000 20                 TRA     s:26041
        20 005555   005663 710000 20                 TRA     s:26077
        20 005556   005677 710000 20                 TRA     s:26084

     2083    26039
     2084    26040    4          CASE( %REBUILD_DISK_DEST );

     2085    26041    4            CALL FLB_SET_TAPE_DEFAULTS;    /* Set input tape defaults            */

  26041 20 005557   000001 236000 xsym               LDQ     B_VECTNIL+1
        20 005560   200032 756100                    STQ     FIRST+1,,AUTO
        20 005561   000001 235000 xsym               LDA     B_VECTNIL+1
        20 005562   200030 757100                    STAQ    DCB#+1,,AUTO
        20 005563   000001 236000 xsym               LDQ     B_VECTNIL+1
        20 005564   200027 756100                    STQ     NEW_REBUILD+7,,AUTO
        20 005565   014101 701000 20                 TSX1    FLB_SET_TAPE_DEFAULTS
        20 005566   000000 011000                    NOP     0
        20 005567   005707 710000 20                 TRA     s:26087

     2086    26042
     2087    26043    4          CASE( %TAPE_SOURCE );            /* :BACKUP is from tape               */

     2088    26044    4            FSN_SPECD = '0'B;              /* Error if FSN was not specified     */

  26044 20 005570   200006 450100                    STZ     FSN_SPECD,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:331  

     2089    26045    4            IF SUBNODE$->OUT$BLK.NSUBLKS > 1

  26045 20 005571   100001 221100                    LDX1    1,,PR1
        20 005572   000002 101003                    CMPX1   2,DU
        20 005573   005621 602000 20                 TNC     s:26053

     2090    26046    5             THEN DO;

     2091    26047    5               TEMP$ = SUBNODE$->OUT$BLK.SUBLK$(1); /* Tape options              */

  26047 20 005574   100004 236100                    LDQ     4,,PR1
        20 005575   200007 756100                    STQ     TEMP$,,AUTO

     2092    26048    6               DO I=0 TO TEMP$->OUT$BLK.NSUBLKS - 1;

  26048 20 005576   200005 450100                    STZ     I,,AUTO
        20 005577   005613 710000 20                 TRA     s:26051+3

     2093    26049    6                  IF TEMP$->OUT$BLK.SUBLK$(I)->OUT$BLK.CODE = %FSN

  26049 20 005600   200007 470500                    LDP0    TEMP$,,AUTO
        20 005601   200005 720100                    LXL0    I,,AUTO
        20 005602   000003 471510                    LDP1    3,X0,PR0
        20 005603   100000 721100                    LXL1    0,,PR1
        20 005604   000002 101003                    CMPX1   2,DU
        20 005605   005610 601000 20                 TNZ     s:26051

     2094    26050    6                   THEN FSN_SPECD = '1'B;

  26050 20 005606   400000 236003                    LDQ     -131072,DU
        20 005607   200006 756100                    STQ     FSN_SPECD,,AUTO

     2095    26051    6                  END;

  26051 20 005610   200005 235100                    LDA     I,,AUTO
        20 005611   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:332  
        20 005612   200005 755100                    STA     I,,AUTO
        20 005613   200007 470500                    LDP0    TEMP$,,AUTO
        20 005614   000001 236100                    LDQ     1,,PR0
        20 005615   000022 772000                    QRL     18
        20 005616   200005 116100                    CMPQ    I,,AUTO
        20 005617   005621 600000 20                 TZE     s:26053
        20 005620   005600 603000 20                 TRC     s:26049

     2096    26052    5               END;

     2097    26053    4            IF NOT FSN_SPECD

  26053 20 005621   200006 234100                    SZN     FSN_SPECD,,AUTO
        20 005622   005633 604000 20                 TMI     s:26060

     2098    26054    5             THEN DO;

     2099    26055    5               CALL FLI$RPT_ERR( E_NO_FSN );

  26055 20 005623   000104 630400 21                 EPPR0   68
        20 005624   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 005625   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 005626   000000 011000                    NOP     0

     2100    26056    5               COMMAND_ERROR = '1'B;

  26056 20 005627   400000 236003                    LDQ     -131072,DU
        20 005630   000000 756000 xsym               STQ     COMMAND_ERROR

     2101    26057    5               RETURN;

  26057 20 005631   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 005632   000001 702211                    TSX2  ! 1,X1

     2102    26058    5               END;
     2103    26059
     2104    26060    4            CALL FLB_TAPE_OD_SPEC          /* Process tape options               */
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:333  

  26060 20 005633   014004 701000 20                 TSX1    FLB_TAPE_OD_SPEC
        20 005634   005636 702000 20                 TSX2    s:26062
        20 005635   005640 710000 20                 TRA     s:26068

     2105    26061    5             WHENALTRETURN DO;

     2106    26062    5               RETURN;

  26062 20 005636   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 005637   000001 702211                    TSX2  ! 1,X1

     2107    26063    5               END;
     2108    26064          /***
     2109    26065           *** The following code "undoes" the initial serial number list
     2110    26066           *** from the tape [destination] list.
     2111    26067           ***/
     2112    26068    4            SOURCE_TAPE_SNLIST$ = SNLISTINFO.SNLIST$;

  26068 20 005640   000000 470400 xsym               LDP0    LAST_SNLISTINFO$
        20 005641   000000 236100                    LDQ     0,,PR0
        20 005642   000230 756000 2                  STQ     SOURCE_TAPE_SNLIST$

     2113    26069    4            TVECTOR = VECTOR(SOURCE_TAPE_SNLIST$->VLP_SN);

  26069 20 005643   000033 235000 21                 LDA     27
        20 005644   000000 757000 xsym               STAQ    TVECTOR

     2114    26070    4            TVECTOR.W1.VSIZE# = LENGTHV(VLP_SN.NUM#)

  26070 20 005645   000230 471400 2                  LDP1    SOURCE_TAPE_SNLIST$
        20 005646   100000 236100                    LDQ     0,,PR1
        20 005647   000006 402007                    MPY     6,DL
        20 005650   000003 036007                    ADLQ    3,DL
        20 005651   000020 736000                    QLS     16
        20 005652   000000 676000 xsym               ERQ     TVECTOR
        20 005653   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:334  
        20 005654   000000 656000 xsym               ERSQ    TVECTOR

     2115    26071    4              + SOURCE_TAPE_SNLIST$->VLP_SN.NUM# * LENGTHC(VLP_SN.SN#(0));
     2116    26072    4            TAPE_OPEN.SN_ = TVECTOR;

  26072 20 005655   000000 237000 xsym               LDAQ    TVECTOR
        20 005656   000002 757000 xsym               STAQ    TAPE_OPEN+2

     2117    26073    4            LAST_SNLISTINFO$ = ADDR(NIL);

  26073 20 005657   000001 236000 xsym               LDQ     B_VECTNIL+1
        20 005660   000000 756000 xsym               STQ     LAST_SNLISTINFO$

     2118    26074    4            NBR_SNLISTS = 0;

  26074 20 005661   000000 450000 xsym               STZ     NBR_SNLISTS
        20 005662   005707 710000 20                 TRA     s:26087

     2119    26075
     2120    26076    4          CASE( %REBUILD_FILE_SOURCE );    /* :BACKUP is from a fid              */

     2121    26077    4            IF SUBNODE$->OUT$BLK.NSUBLKS > 1 /* Process tape options             */

  26077 20 005663   100001 221100                    LDX1    1,,PR1
        20 005664   000002 101003                    CMPX1   2,DU
        20 005665   005707 602000 20                 TNC     s:26087

     2122    26078    5             THEN DO;

     2123    26079    5               CALL FLB_REBUILD_OPTION_LIST( SUBNODE$->OUT$BLK.SUBLK$(1) );

  26079 20 005666   000231 236000 2                  LDQ     SUBNODE$
        20 005667   000004 036003                    ADLQ    4,DU
        20 005670   200011 756100                    STQ     DEST_TAPE_VOL_SAVE+1,,AUTO
        20 005671   005743 701000 20                 TSX1    FLB_REBUILD_OPTION_LIST
        20 005672   000000 011000                    NOP     0

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:335  
     2124    26080    5               IF COMMAND_ERROR THEN RETURN;

  26080 20 005673   000000 234000 xsym               SZN     COMMAND_ERROR
        20 005674   005707 605000 20                 TPL     s:26087

  26080 20 005675   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 005676   000001 702211                    TSX2  ! 1,X1

     2125    26081    5               END;
     2126    26082
     2127    26083    4          CASE( %REBUILD_TAPE_OPTIONS ); /* :BACKUP is from packset being rebuilt */

     2128    26084    4            CALL FLB_REBUILD_OPTION_LIST( SUBNODE$ );

  26084 20 005677   000105 236000 21                 LDQ     69
        20 005700   200011 756100                    STQ     DEST_TAPE_VOL_SAVE+1,,AUTO
        20 005701   005743 701000 20                 TSX1    FLB_REBUILD_OPTION_LIST
        20 005702   000000 011000                    NOP     0

     2129    26085    4            IF COMMAND_ERROR THEN RETURN;

  26085 20 005703   000000 234000 xsym               SZN     COMMAND_ERROR
        20 005704   005707 605000 20                 TPL     s:26087

  26085 20 005705   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 005706   000001 702211                    TSX2  ! 1,X1

     2130    26086    4          END;

     2131    26087    3         END;

  26087 20 005707   000232 054000 2                  AOS     SUBNODEX
        20 005710   000226 470400 2                  LDP0    NODE$
        20 005711   000001 236100                    LDQ     1,,PR0
        20 005712   000022 772000                    QRL     18
        20 005713   000232 116000 2                  CMPQ    SUBNODEX
        20 005714   005532 605400 20                 TPNZ    s:26036
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:336  

     2132    26088    2      CALL FLB_DISK_DEST                   /* Process DP#psn                     */

  26088 20 005715   006314 701000 20                 TSX1    FLB_DISK_DEST
        20 005716   005720 702000 20                 TSX2    s:26091
        20 005717   005720 710000 20                 TRA     s:26091

     2133    26089    3       WHENALTRETURN DO;

     2134    26090    3         END;

     2135    26091    2      IF COMMAND_ERROR THEN RETURN;

  26091 20 005720   000000 234000 xsym               SZN     COMMAND_ERROR
        20 005721   005724 605000 20                 TPL     s:26092

  26091 20 005722   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 005723   000001 702211                    TSX2  ! 1,X1

     2136    26092    2      CALL FLB_DISK_SPEC(0)                /* Process sel_list, set defaults     */

  26092 20 005724   000032 236000 21                 LDQ     26
        20 005725   200031 756100                    STQ     SOURCE_DCB$+1,,AUTO
        20 005726   006734 701000 20                 TSX1    FLB_DISK_SPEC
        20 005727   005731 702000 20                 TSX2    s:26095
        20 005730   005731 710000 20                 TRA     s:26095

     2137    26093    3       WHENALTRETURN DO;

     2138    26094    3         END;

     2139    26095    2      IF COMMAND_ERROR THEN RETURN;

  26095 20 005731   000000 234000 xsym               SZN     COMMAND_ERROR
        20 005732   005735 605000 20                 TPL     s:26097

  26095 20 005733   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:337  
        20 005734   000001 702211                    TSX2  ! 1,X1

     2140    26096
     2141    26097    2      RESTORE_FROM_TAPE = '1'B;

  26097 20 005735   400000 236003                    LDQ     -131072,DU
        20 005736   000164 756000 2                  STQ     RESTORE_FROM_TAPE

     2142    26098    2      CALL FLB_TAPE_NODES;                 /* Perform rebuild                    */

  26098 20 005737   002402 701000 20                 TSX1    FLB_TAPE_NODES
        20 005740   000000 011000                    NOP     0

     2143    26099    2      RETURN;

  26099 20 005741   200004 221300                    LDX1  ! CHECK_SRCH_BIT+1,,AUTO
        20 005742   000001 702211                    TSX2  ! 1,X1

     2144    26100
     2145    26101
     2146    26102    2   FLB_REBUILD_OPTION_LIST: PROC( SUBNODE$ );

  26102 20 005743   200010 741300       FLB_REBUILD* STX1  ! DEST_TAPE_VOL_SAVE,,AUTO

     2147    26103
     2148    26104    3   DCL SUBNODE$ PTR ALIGNED;
     2149    26105    3   DCL SUBSUBNODE$ PTR AUTO;
     2150    26106    3   DCL SUBNODEX SBIN AUTO;
     2151    26107
     2152    26108    4      DO SUBNODEX = 0 TO SUBNODE$->OUT$BLK.NSUBLKS - 1;

  26108 20 005744   200013 450100                    STZ     SUBNODEX,,AUTO
        20 005745   006123 710000 20                 TRA     s:26147+1

     2153    26109    4         SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(SUBNODEX);

  26109 20 005746   200011 470500                    LDP0    @SUBNODE$,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:338  
        20 005747   000000 471500                    LDP1    0,,PR0
        20 005750   200013 720100                    LXL0    SUBNODEX,,AUTO
        20 005751   100003 236110                    LDQ     3,X0,PR1
        20 005752   200012 756100                    STQ     SUBSUBNODE$,,AUTO

     2154    26110
     2155    26111    5         DO CASE( SUBSUBNODE$ -> OUT$BLK.CODE );

  26111 20 005753   200012 473500                    LDP3    SUBSUBNODE$,,AUTO
        20 005754   300000 721100                    LXL1    0,,PR3
        20 005755   000037 101003                    CMPX1   31,DU
        20 005756   005760 602011 20                 TNC     s:26111+5,X1
        20 005757   006122 710000 20                 TRA     s:26147
        20 005760   006017 710000 20                 TRA     s:26113
        20 005761   006025 710000 20                 TRA     s:26117
        20 005762   006040 710000 20                 TRA     s:26121
        20 005763   006122 710000 20                 TRA     s:26147
        20 005764   006122 710000 20                 TRA     s:26147
        20 005765   006122 710000 20                 TRA     s:26147
        20 005766   006122 710000 20                 TRA     s:26147
        20 005767   006122 710000 20                 TRA     s:26147
        20 005770   006122 710000 20                 TRA     s:26147
        20 005771   006122 710000 20                 TRA     s:26147
        20 005772   006122 710000 20                 TRA     s:26147
        20 005773   006122 710000 20                 TRA     s:26147
        20 005774   006122 710000 20                 TRA     s:26147
        20 005775   006104 710000 20                 TRA     s:26136
        20 005776   006122 710000 20                 TRA     s:26147
        20 005777   006122 710000 20                 TRA     s:26147
        20 006000   006122 710000 20                 TRA     s:26147
        20 006001   006122 710000 20                 TRA     s:26147
        20 006002   006122 710000 20                 TRA     s:26147
        20 006003   006122 710000 20                 TRA     s:26147
        20 006004   006122 710000 20                 TRA     s:26147
        20 006005   006122 710000 20                 TRA     s:26147
        20 006006   006122 710000 20                 TRA     s:26147
        20 006007   006122 710000 20                 TRA     s:26147
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:339  
        20 006010   006122 710000 20                 TRA     s:26147
        20 006011   006122 710000 20                 TRA     s:26147
        20 006012   006122 710000 20                 TRA     s:26147
        20 006013   006122 710000 20                 TRA     s:26147
        20 006014   006116 710000 20                 TRA     s:26143
        20 006015   006107 710000 20                 TRA     s:26139
        20 006016   006101 710000 20                 TRA     s:26133

     2156    26112    5          CASE( %DENSITY );

     2157    26113    5            TAPE_OPEN.V.DENSITY# = SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  26113 20 006017   300003 474500                    LDP4    3,,PR3
        20 006020   400000 236100                    LDQ     0,,PR4
        20 006021   000066 552004 xsym               STBQ    TAPE_OPEN+54,'04'O

     2158    26114    5            TAPE_OPTION.DENSITY = '1'B;

  26114 20 006022   400000 236003                    LDQ     -131072,DU
        20 006023   000002 256000 xsym               ORSQ    TAPE_OPTION+2
        20 006024   006122 710000 20                 TRA     s:26147

     2159    26115
     2160    26116    5          CASE( %VOL );

     2161    26117    5            CALL CHARBIN( TEMP, SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT );

  26117 20 006025   300003 474500                    LDP4    3,,PR3
        20 006026   400004 236100                    LDQ     4,,PR4
        20 006027   000033 772000                    QRL     27
        20 006030   000000 622006                    EAX2    0,QL
        20 006031   000000 305540                    DTB
        20 006032   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
        20 006033   000236 000004 2                  NDSC9   TEMP                     cn=0,s=lsgnf,sf=0,n=4

     2162    26118    5            TAPE_OPEN.V.VOL# = TEMP;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:340  
  26118 20 006034   000236 236000 2                  LDQ     TEMP
        20 006035   000033 736000                    QLS     27
        20 006036   000061 552040 xsym               STBQ    TAPE_OPEN+49,'40'O
        20 006037   006122 710000 20                 TRA     s:26147

     2163    26119
     2164    26120    5          CASE( %FSN );

     2165    26121    5            CALL CHARBIN( TEMP, SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT );

  26121 20 006040   300003 474500                    LDP4    3,,PR3
        20 006041   400004 236100                    LDQ     4,,PR4
        20 006042   000033 772000                    QRL     27
        20 006043   000000 622006                    EAX2    0,QL
        20 006044   000000 305540                    DTB
        20 006045   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
        20 006046   000236 000004 2                  NDSC9   TEMP                     cn=0,s=lsgnf,sf=0,n=4

     2166    26122    5            TAPE_OPEN.V.FSN# = TEMP;

  26122 20 006047   000236 721000 2                  LXL1    TEMP
        20 006050   000066 741000 xsym               STX1    TAPE_OPEN+54

     2167    26123    5            IF SUBSUBNODE$->OUT$BLK.NSUBLKS <= 1

  26123 20 006051   300001 222100                    LDX2    1,,PR3
        20 006052   000002 102003                    CMPX2   2,DU
        20 006053   006057 603000 20                 TRC     s:26125

     2168    26124    5             THEN LAST_TAPE_FSN = TEMP;

  26124 20 006054   000236 235000 2                  LDA     TEMP
        20 006055   000000 755000 xsym               STA     LAST_TAPE_FSN
        20 006056   006066 710000 20                 TRA     s:26126

     2169    26125    5            ELSE CALL CHARBIN( LAST_TAPE_FSN, SUBSUBNODE$->OUT$BLK.SUBLK$(1)->OUT$SYM.
             26125                      TEXT );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:341  

  26125 20 006057   300004 471500                    LDP1    4,,PR3
        20 006060   100004 236100                    LDQ     4,,PR1
        20 006061   000033 772000                    QRL     27
        20 006062   000000 623006                    EAX3    0,QL
        20 006063   000000 305540                    DTB
        20 006064   100004 230013                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X3
        20 006065   000000 000004 xsym               NDSC9   LAST_TAPE_FSN            cn=0,s=lsgnf,sf=0,n=4

     2170    26126    5            IF TAPE_OPEN.V.FSN# > LAST_TAPE_FSN

  26126 20 006066   000066 236000 xsym               LDQ     TAPE_OPEN+54
        20 006067   000022 772000                    QRL     18
        20 006070   000000 116000 xsym               CMPQ    LAST_TAPE_FSN
        20 006071   006122 604400 20                 TMOZ    s:26147

     2171    26127    6             THEN DO;

     2172    26128    6               COMMAND_ERROR = '1'B;

  26128 20 006072   400000 236003                    LDQ     -131072,DU
        20 006073   000000 756000 xsym               STQ     COMMAND_ERROR

     2173    26129    6               CALL FLI$RPT_ERR( E_BAD_FSN_RANGE, );

  26129 20 006074   000106 630400 21                 EPPR0   70
        20 006075   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 006076   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 006077   000000 011000                    NOP     0

     2174    26130    6               END;

  26130 20 006100   006122 710000 20                 TRA     s:26147

     2175    26131
     2176    26132    5          CASE( %TAPE_DIR );

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:342  
     2177    26133    5            DISK_OPTION.DIR = '1'B;

  26133 20 006101   400000 236003                    LDQ     -131072,DU
        20 006102   000000 256000 xsym               ORSQ    DISK_OPTION
        20 006103   006122 710000 20                 TRA     s:26147

     2178    26134
     2179    26135    5          CASE( %NPAD );

     2180    26136    5            TAPE_OPTION.NPAD = '1'B;

  26136 20 006104   020000 236003                    LDQ     8192,DU
        20 006105   000002 256000 xsym               ORSQ    TAPE_OPTION+2
        20 006106   006122 710000 20                 TRA     s:26147

     2181    26137
     2182    26138    5          CASE( %IOERRORCY );

     2183    26139    5            TAPE_OPTION.IOERRORC = '1'B;

  26139 20 006107   010000 236003                    LDQ     4096,DU
        20 006110   000002 256000 xsym               ORSQ    TAPE_OPTION+2

     2184    26140    5            TAPE_OPEN.V.IOERROK# = '1'B;

  26140 20 006111   000060 236000 xsym               LDQ     TAPE_OPEN+48
        20 006112   000036 376000 21                 ANQ     30
        20 006113   002000 276003                    ORQ     1024,DU
        20 006114   000060 756000 xsym               STQ     TAPE_OPEN+48
        20 006115   006122 710000 20                 TRA     s:26147

     2185    26141
     2186    26142    5          CASE( %IOERRORCN );

     2187    26143    5            TAPE_OPTION.IOERRORC = '0'B;

  26143 20 006116   000037 236000 21                 LDQ     31
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:343  
        20 006117   000002 356000 xsym               ANSQ    TAPE_OPTION+2

     2188    26144    5            TAPE_OPEN.V.IOERROK# = '0'B;

  26144 20 006120   000036 236000 21                 LDQ     30
        20 006121   000060 356000 xsym               ANSQ    TAPE_OPEN+48

     2189    26145
     2190    26146    5          END;

     2191    26147    4         END;

  26147 20 006122   200013 054100                    AOS     SUBNODEX,,AUTO
        20 006123   200011 470500                    LDP0    @SUBNODE$,,AUTO
        20 006124   000000 471500                    LDP1    0,,PR0
        20 006125   100001 236100                    LDQ     1,,PR1
        20 006126   000022 772000                    QRL     18
        20 006127   200013 116100                    CMPQ    SUBNODEX,,AUTO
        20 006130   005746 605400 20                 TPNZ    s:26109

     2192    26148    3      RETURN;

  26148 20 006131   200010 221300                    LDX1  ! DEST_TAPE_VOL_SAVE,,AUTO
        20 006132   000001 702211                    TSX2  ! 1,X1

     2193    26149
     2194    26150    3   END FLB_REBUILD_OPTION_LIST;
     2195    26151    2   END FLB_REBUILD_NODES;
     2196    26152        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:344  
     2197    26153    1   FLB_TRANS_TYPE: PROC ;

  26153 20 006133   200012 741300       FLB_TRANS_T* STX1  ! SUBSUBNODE$,,AUTO

     2198    26154        /*F*  NAME: FLB_TRANS_TYPE
     2199    26155              PURPOSE: Process OPEN nodes.
     2200    26156        */
     2201    26157
     2202    26158        /******************************/
     2203    26159
     2204    26160    3      DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;

  26160 20 006134   000232 450000 2                  STZ     SUBNODEX
        20 006135   006217 710000 20                 TRA     s:26183+1

     2205    26161    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);

  26161 20 006136   000226 470400 2                  LDP0    NODE$
        20 006137   000232 720000 2                  LXL0    SUBNODEX
        20 006140   000003 236110                    LDQ     3,X0,PR0
        20 006141   000231 756000 2                  STQ     SUBNODE$

     2206    26162
     2207    26163    4         DO CASE( SUBNODE$->OUT$BLK.CODE );

  26163 20 006142   000231 471400 2                  LDP1    SUBNODE$
        20 006143   100000 721100                    LXL1    0,,PR1
        20 006144   000001 101003                    CMPX1   1,DU
        20 006145   006147 602011 20                 TNC     s:26163+5,X1
        20 006146   006216 710000 20                 TRA     s:26183
        20 006147   006150 710000 20                 TRA     s:26166

     2208    26164
     2209    26165    4          CASE( %TRANS );

     2210    26166    4            SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(0);

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:345  
  26166 20 006150   100003 236100                    LDQ     3,,PR1
        20 006151   000233 756000 2                  STQ     SUBSUBNODE$

     2211    26167
     2212    26168    5            DO CASE( SUBSUBNODE$->OUT$BLK.CODE );

  26168 20 006152   000233 473400 2                  LDP3    SUBSUBNODE$
        20 006153   300000 721100                    LXL1    0,,PR3
        20 006154   000002 101003                    CMPX1   2,DU
        20 006155   006157 602011 20                 TNC     s:26168+5,X1
        20 006156   006216 710000 20                 TRA     s:26183
        20 006157   006161 710000 20                 TRA     s:26171
        20 006160   006214 710000 20                 TRA     s:26180

     2213    26169
     2214    26170    5             CASE( %TRANSFER );

     2215    26171    5               MODE = %TRANSFER;

  26171 20 006161   000250 450000 2                  STZ     MODE

     2216    26172    6               DO SUBSUBNODEX = 0 TO SUBSUBNODE$->OUT$BLK.NSUBLKS-1;

  26172 20 006162   000234 450000 2                  STZ     SUBSUBNODEX
        20 006163   006206 710000 20                 TRA     s:26178+1

     2217    26173    6                  TEMP$ = SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX);

  26173 20 006164   000233 470400 2                  LDP0    SUBSUBNODE$
        20 006165   000234 720000 2                  LXL0    SUBSUBNODEX
        20 006166   000003 236110                    LDQ     3,X0,PR0
        20 006167   000237 756000 2                  STQ     TEMP$

     2218    26174    7                  DO CASE ( TEMP$->OUT$BLK.CODE);

  26174 20 006170   000237 471400 2                  LDP1    TEMP$
        20 006171   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:346  
        20 006172   777777 376007                    ANQ     -1,DL
        20 006173   000007 136007                    SBLQ    7,DL
        20 006174   000001 116007                    CMPQ    1,DL
        20 006175   006177 602006 20                 TNC     s:26174+7,QL
        20 006176   006205 710000 20                 TRA     s:26178
        20 006177   006200 710000 20                 TRA     s:26176

     2219    26175    7                   CASE ( %PROTTYPE ) ;

     2220    26176    7                     TAPE_OPTION.PROTTYPE = TEMP$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  26176 20 006200   100003 473500                    LDP3    3,,PR1
        20 006201   300000 236100                    LDQ     0,,PR3
        20 006202   777777 376007                    ANQ     -1,DL
        20 006203   000041 736000                    QLS     33
        20 006204   000001 756000 xsym               STQ     TAPE_OPTION+1

     2221    26177    7                   END;

     2222    26178    6                  END;

  26178 20 006205   000234 054000 2                  AOS     SUBSUBNODEX
        20 006206   000233 470400 2                  LDP0    SUBSUBNODE$
        20 006207   000001 236100                    LDQ     1,,PR0
        20 006210   000022 772000                    QRL     18
        20 006211   000234 116000 2                  CMPQ    SUBSUBNODEX
        20 006212   006164 605400 20                 TPNZ    s:26173
        20 006213   006216 710000 20                 TRA     s:26183

     2223    26179    5             CASE( %TRANSPORT );

     2224    26180    5               MODE = %TRANSPORT;

  26180 20 006214   000001 235007                    LDA     1,DL
        20 006215   000250 755000 2                  STA     MODE

     2225    26181    5             END;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:347  

     2226    26182    4          END;

     2227    26183    3         END;

  26183 20 006216   000232 054000 2                  AOS     SUBNODEX
        20 006217   000226 470400 2                  LDP0    NODE$
        20 006220   000001 236100                    LDQ     1,,PR0
        20 006221   000022 772000                    QRL     18
        20 006222   000232 116000 2                  CMPQ    SUBNODEX
        20 006223   006136 605400 20                 TPNZ    s:26161

     2228    26184    2   END FLB_TRANS_TYPE;

  26184 20 006224   200012 221300                    LDX1  ! SUBSUBNODE$,,AUTO
        20 006225   000001 702211                    TSX2  ! 1,X1

     2229    26185        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:348  
     2230    26186    1   FLB_OPTION_INIT: PROC;

  26186 20 006226   200012 741300       FLB_OPTION_* STX1  ! SUBSUBNODE$,,AUTO

     2231    26187        /*F*  NAME: FLB_OPTION_INIT
     2232    26188              PURPOSE: Initializes options.
     2233    26189        */
     2234    26190
     2235    26191        /****************************************/
     2236    26192
     2237    26193    2      IF NOT OVER_FIL

  26193 20 006227   000000 234000 xsym               SZN     OVER_FIL
        20 006230   006236 604000 20                 TMI     s:26198

     2238    26194    3       THEN DO;

     2239    26195    3         DISK_DEST_SN.SN#(0) = ' ';

  26195 20 006231   040000 100400                    MLR     fill='040'O
        20 006232   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        20 006233   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6

     2240    26196    3         DISK_DEST_RES.NAME = ' ';

  26196 20 006234   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 006235   000001 756000 xsym               STQ     DISK_DEST_RES+1

     2241    26197    3         END;

     2242    26198    2      DISK_DEST_ACCT.ACCT# = ' ';

  26198 20 006236   000035 235000 xsym               LDA     B_VECTNIL+29
        20 006237   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 006240   000000 755000 xsym               STA     DISK_DEST_ACCT
        20 006241   000001 756000 xsym               STQ     DISK_DEST_ACCT+1

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:349  
     2243    26199    2      DISK_DEST_EXIST = 0;

  26199 20 006242   000000 450000 xsym               STZ     DISK_DEST_EXIST

     2244    26200
     2245    26201    2      DPLIST$ = ADDR(ZERO);                /* No packset                         */

  26201 20 006243   000060 236000 21                 LDQ     48
        20 006244   000000 756000 xsym               STQ     DPLIST$

     2246    26202    2      DPRESLIST$ = ADDR(ZERO);             /* No packset resource list           */

  26202 20 006245   000000 756000 xsym               STQ     DPRESLIST$

     2247    26203    2      DISK_SRCHCOND = '0'B;                /* ANYFile                            */

  26203 20 006246   000000 220003                    LDX0    0,DU
        20 006247   000000 740000 xsym               STX0    DISK_SRCHCOND

     2248    26204    2      DISK_DESC = '0'B;                    /* No particular DESCriptors          */

  26204 20 006250   000000 740000 xsym               STX0    DISK_DESC

     2249    26205    2      DISK_DESC_MASK = '0'B;

  26205 20 006251   000000 740000 xsym               STX0    DISK_DESC_MASK

     2250    26206    2      DISK_OPTION = '0'B;                  /* No other options                   */

  26206 20 006252   003000 060400                    CSL     bolr='003'O
        20 006253   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
        20 006254   000000 000221 xsym               BDSC    DISK_OPTION              by=0,bit=0,n=145

     2251    26207    2      DISK_ORGS.NBR = 0;                   /* No organizations                   */

  26207 20 006255   000000 450000 xsym               STZ     DISK_ORGS

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:350  
     2252    26208    2      DISK_CRIT = '0'B;

  26208 20 006256   000000 450000 xsym               STZ     DISK_CRIT

     2253    26209    2      DATE_CRIT = '0'B;

  26209 20 006257   000000 450000 xsym               STZ     DATE_CRIT

     2254    26210    2      PREV_ACCT.ACCT# = ' ';

  26210 20 006260   000035 235000 xsym               LDA     B_VECTNIL+29
        20 006261   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 006262   000240 757000 2                  STAQ    PREV_ACCT

     2255    26211    2      RANGE_SPECIFIED = '0'B;

  26211 20 006263   000242 450000 2                  STZ     RANGE_SPECIFIED

     2256    26212    2      SKIP_SPECIFIED = '0'B;

  26212 20 006264   000243 450000 2                  STZ     SKIP_SPECIFIED

     2257    26213    2      FIRST_ACCT_SPECIFIED.ACCT# = ' ';

  26213 20 006265   000035 235000 xsym               LDA     B_VECTNIL+29
        20 006266   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 006267   000244 757000 2                  STAQ    FIRST_ACCT_SPECIFIED

     2258    26214
     2259    26215    3      DO I=0 TO %MAX_DATE;

  26215 20 006270   000213 450000 2                  STZ     I

     2260    26216    3         DISK_BEF_UTS(I) = 0;

  26216 20 006271   000213 720000 2                  LXL0    I
        20 006272   000000 450010 xsym               STZ     DISK_BEF_UTS,X0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:351  

     2261    26217    3         DISK_AFT_UTS(I) = 0;

  26217 20 006273   000000 450010 xsym               STZ     DISK_AFT_UTS,X0

     2262    26218    3         DISK_AND_OP(I) = '0'B;

  26218 20 006274   000213 235000 2                  LDA     I
        20 006275   006277 605000 20                 TPL     s:26218+3
        20 006276   000044 035003                    ADLA    36,DU
        20 006277   003005 060400                    CSL     bolr='003'O
        20 006300   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
        20 006301   000000 000001 xsym               BDSC    DISK_AND_OP,A            by=0,bit=0,n=1

     2263    26219    3         END;

  26219 20 006302   000213 054000 2                  AOS     I
        20 006303   000213 235000 2                  LDA     I
        20 006304   000004 115007                    CMPA    4,DL
        20 006305   006271 604400 20                 TMOZ    s:26216

     2264    26220
     2265    26221    2      DISK_OPEN_NEXT.V.FUN# = %IN#;

  26221 20 006306   002000 236007                    LDQ     1024,DL
        20 006307   000045 552010 xsym               STBQ    DISK_OPEN_NEXT+37,'10'O

     2266    26222    2      DISK_OPEN_NEXT.V.SHARE# = 0;

  26222 20 006310   000107 236000 21                 LDQ     71
        20 006311   000044 356000 xsym               ANSQ    DISK_OPEN_NEXT+36

     2267    26223
     2268    26224    2      RETURN;

  26224 20 006312   200012 221300                    LDX1  ! SUBSUBNODE$,,AUTO
        20 006313   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:352  

     2269    26225
     2270    26226    2   END FLB_OPTION_INIT;
     2271    26227        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:353  
     2272    26228    1   FLB_DISK_DEST: PROC ALTRET;

  26228 20 006314   200026 741300       FLB_DISK_DE* STX1  ! NEW_REBUILD+6,,AUTO

     2273    26229        /*F*  NAME: FLB_DISK_DEST
     2274    26230              PURPOSE: Process DISK_DEST nodes, if any.
     2275    26231        */
     2276    26232
     2277    26233        /******************************/
     2278    26234
     2279    26235    3      DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;

  26235 20 006315   000232 450000 2                  STZ     SUBNODEX
        20 006316   006673 710000 20                 TRA     s:26319+1

     2280    26236    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);

  26236 20 006317   000226 470400 2                  LDP0    NODE$
        20 006320   000232 720000 2                  LXL0    SUBNODEX
        20 006321   000003 236110                    LDQ     3,X0,PR0
        20 006322   000231 756000 2                  STQ     SUBNODE$

     2281    26237
     2282    26238    4         DO CASE( SUBNODE$->OUT$BLK.CODE );

  26238 20 006323   000231 471400 2                  LDP1    SUBNODE$
        20 006324   100000 236100                    LDQ     0,,PR1
        20 006325   777777 376007                    ANQ     -1,DL
        20 006326   000005 136007                    SBLQ    5,DL
        20 006327   000007 116007                    CMPQ    7,DL
        20 006330   006332 602006 20                 TNC     s:26238+7,QL
        20 006331   006672 710000 20                 TRA     s:26319
        20 006332   006341 710000 20                 TRA     s:26241
        20 006333   006672 710000 20                 TRA     s:26319
        20 006334   006672 710000 20                 TRA     s:26319
        20 006335   006672 710000 20                 TRA     s:26319
        20 006336   006672 710000 20                 TRA     s:26319
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:354  
        20 006337   006672 710000 20                 TRA     s:26319
        20 006340   006545 710000 20                 TRA     s:26287

     2283    26239
     2284    26240    4          CASE( %DISK_DEST );

     2285    26241    5            DO CASE( SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE );

  26241 20 006341   100003 473500                    LDP3    3,,PR1
        20 006342   300000 721100                    LXL1    0,,PR3
        20 006343   000010 101003                    CMPX1   8,DU
        20 006344   006346 602011 20                 TNC     s:26241+5,X1
        20 006345   006415 710000 20                 TRA     s:26259
        20 006346   006415 710000 20                 TRA     s:26259
        20 006347   006356 710000 20                 TRA     s:26243
        20 006350   006415 710000 20                 TRA     s:26259
        20 006351   006370 710000 20                 TRA     s:26247
        20 006352   006415 710000 20                 TRA     s:26259
        20 006353   006415 710000 20                 TRA     s:26259
        20 006354   006415 710000 20                 TRA     s:26259
        20 006355   006413 710000 20                 TRA     s:26256

     2286    26242    5             CASE( %ON_FILE );

     2287    26243    5               DISK_DEST_EXIST = %ERROR#;

  26243 20 006356   000001 235007                    LDA     1,DL
        20 006357   000000 755000 xsym               STA     DISK_DEST_EXIST

     2288    26244    5               IF COMMAND = %OPEN_CREATE OR COMMAND = %OPEN_EXTEND

  26244 20 006360   000167 236000 2                  LDQ     COMMAND
        20 006361   000045 116007                    CMPQ    37,DL
        20 006362   006365 600000 20                 TZE     s:26245
        20 006363   000046 116007                    CMPQ    38,DL
        20 006364   006415 601000 20                 TNZ     s:26259

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:355  
     2289    26245    5                THEN OVER_FIL = '1'B;      /* Set/change packset of origin       */

  26245 20 006365   400000 236003                    LDQ     -131072,DU
        20 006366   000000 756000 xsym               STQ     OVER_FIL
        20 006367   006415 710000 20                 TRA     s:26259

     2290    26246    5             CASE( %OVER_FILE );

     2291    26247    5               IF COMMAND = %OPEN_CREATE OR COMMAND = %OPEN_INPUT OR COMMAND = %
             26247                        OPEN_EXTEND

  26247 20 006370   000167 235000 2                  LDA     COMMAND
        20 006371   000045 115007                    CMPA    37,DL
        20 006372   006377 600000 20                 TZE     s:26248
        20 006373   000047 115007                    CMPA    39,DL
        20 006374   006377 600000 20                 TZE     s:26248
        20 006375   000046 115007                    CMPA    38,DL
        20 006376   006402 601000 20                 TNZ     s:26250

     2292    26248    5                THEN OVER_FIL = '1'B;

  26248 20 006377   400000 236003                    LDQ     -131072,DU
        20 006400   000000 756000 xsym               STQ     OVER_FIL
        20 006401   006410 710000 20                 TRA     s:26254

     2293    26249    6                ELSE DO;

     2294    26250    6                  OVER_FIL = '0'B;

  26250 20 006402   000000 450000 xsym               STZ     OVER_FIL

     2295    26251    6                  DISK_DEST_SN.SN#(0) = ' ';

  26251 20 006403   040000 100400                    MLR     fill='040'O
        20 006404   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        20 006405   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:356  
     2296    26252    6                  DISK_DEST_RES.NAME = ' ';

  26252 20 006406   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 006407   000001 756000 xsym               STQ     DISK_DEST_RES+1

     2297    26253    6                  END;                     /* else do                            */

     2298    26254    5               DISK_DEST_EXIST = %NEWFILE#;

  26254 20 006410   000003 236007                    LDQ     3,DL
        20 006411   000000 756000 xsym               STQ     DISK_DEST_EXIST
        20 006412   006415 710000 20                 TRA     s:26259

     2299    26255    5             CASE( %INCR_FILE );

     2300    26256    5               TAPE_OPTION.PROTTYPE = %INCREMENTAL;

  26256 20 006413   300000 236003                    LDQ     98304,DU
        20 006414   000001 756000 xsym               STQ     TAPE_OPTION+1

     2301    26257    5             END;

     2302    26258
     2303    26259    5            DO SUBSUBNODEX = 1 TO SUBNODE$->OUT$BLK.NSUBLKS - 1;

  26259 20 006415   000001 235007                    LDA     1,DL
        20 006416   000234 755000 2                  STA     SUBSUBNODEX
        20 006417   006537 710000 20                 TRA     s:26285+1

     2304    26260    5               SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX);

  26260 20 006420   000231 470400 2                  LDP0    SUBNODE$
        20 006421   000234 720000 2                  LXL0    SUBSUBNODEX
        20 006422   000003 236110                    LDQ     3,X0,PR0
        20 006423   000233 756000 2                  STQ     SUBSUBNODE$

     2305    26261
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:357  
     2306    26262    6               DO CASE( SUBSUBNODE$->OUT$BLK.CODE );

  26262 20 006424   000233 471400 2                  LDP1    SUBSUBNODE$
        20 006425   100000 721100                    LXL1    0,,PR1
        20 006426   000010 101003                    CMPX1   8,DU
        20 006427   006431 602011 20                 TNC     s:26262+5,X1
        20 006430   006536 710000 20                 TRA     s:26285
        20 006431   006536 710000 20                 TRA     s:26285
        20 006432   006522 710000 20                 TRA     s:26281
        20 006433   006441 710000 20                 TRA     s:26264
        20 006434   006536 710000 20                 TRA     s:26285
        20 006435   006536 710000 20                 TRA     s:26285
        20 006436   006536 710000 20                 TRA     s:26285
        20 006437   006536 710000 20                 TRA     s:26285
        20 006440   006531 710000 20                 TRA     s:26283

     2307    26263    6                CASE( %PACKSET_NAME );

     2308    26264    6                  DISK_DEST_RES.NAME = ' ';

  26264 20 006441   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 006442   000001 756000 xsym               STQ     DISK_DEST_RES+1

     2309    26265    7                  DO SUBSUBNODEX = 0 TO SUBSUBNODE$->OUT$BLK.NSUBLKS - 1; /* DPnn */

  26265 20 006443   000234 450000 2                  STZ     SUBSUBNODEX
        20 006444   006514 710000 20                 TRA     s:26279+1

     2310    26266    7                     IF SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$BLK.NDTYPE = %
             26266                              DEC#

  26266 20 006445   000233 470400 2                  LDP0    SUBSUBNODE$
        20 006446   000234 720000 2                  LXL0    SUBSUBNODEX
        20 006447   000003 471510                    LDP1    3,X0,PR0
        20 006450   100000 236100                    LDQ     0,,PR1
        20 006451   000077 376003                    ANQ     63,DU
        20 006452   000022 116003                    CMPQ    18,DU
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:358  
        20 006453   006505 601000 20                 TNZ     s:26277

     2311    26267    8                      THEN DO;

     2312    26268    8                        CALL CONCAT( DISK_DEST_RES.NAME, 'DP', SUBSTR(SUBSUBNODE$->

  26268 20 006454   100004 236100                    LDQ     4,,PR1
        20 006455   000033 772000                    QRL     27
        20 006456   000223 221000 19                 LDX1    LEGAL_CHAR+101
        20 006457   000001 741000 xsym               STX1    DISK_DEST_RES+1
        20 006460   000000 622006                    EAX2    0,QL
        20 006461   040000 100540                    MLR     fill='040'O
        20 006462   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        20 006463   000001 400002 xsym               ADSC9   DISK_DEST_RES+1          cn=2,n=2

     2313    26269    8                          OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.TEXT,0,SUBSUBNODE$
     2314    26270    8                          ->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.COUNT ));
     2315    26271    8                        IF SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.TEXT =
             26271                                 '00'

  26271 20 006464   000233 470400 2                  LDP0    SUBSUBNODE$
        20 006465   000234 720000 2                  LXL0    SUBSUBNODEX
        20 006466   000003 471510                    LDP1    3,X0,PR0
        20 006467   100004 236100                    LDQ     4,,PR1
        20 006470   000033 772000                    QRL     27
        20 006471   000000 621006                    EAX1    0,QL
        20 006472   040000 106540                    CMPC    fill='040'O
        20 006473   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        20 006474   000224 000002 19                 ADSC9   LEGAL_CHAR+102           cn=0,n=2
        20 006475   006513 601000 20                 TNZ     s:26279

     2316    26272    9                         THEN DO;

     2317    26273    9                           COMMAND_ERROR = '1'B;

  26273 20 006476   400000 236003                    LDQ     -131072,DU
        20 006477   000000 756000 xsym               STQ     COMMAND_ERROR
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:359  

     2318    26274    9                           CALL FLI$RPT_ERR( E_BAD_DP_FORMAT );

  26274 20 006500   000110 630400 21                 EPPR0   72
        20 006501   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 006502   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 006503   000000 011000                    NOP     0

     2319    26275    9                           END;

     2320    26276    8                        END;

  26276 20 006504   006513 710000 20                 TRA     s:26279

     2321    26277    7                      ELSE DISK_DEST_SN.SN#(0) = SUBSUBNODE$->OUT$BLK.SUBLK$

  26277 20 006505   100004 236100                    LDQ     4,,PR1
        20 006506   000033 772000                    QRL     27
        20 006507   000000 621006                    EAX1    0,QL
        20 006510   040000 100540                    MLR     fill='040'O
        20 006511   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        20 006512   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6

     2322    26278    7                          (SUBSUBNODEX)->OUT$SYM.TEXT;
     2323    26279    7                     END;

  26279 20 006513   000234 054000 2                  AOS     SUBSUBNODEX
        20 006514   000233 470400 2                  LDP0    SUBSUBNODE$
        20 006515   000001 236100                    LDQ     1,,PR0
        20 006516   000022 772000                    QRL     18
        20 006517   000234 116000 2                  CMPQ    SUBSUBNODEX
        20 006520   006445 605400 20                 TPNZ    s:26266
        20 006521   006536 710000 20                 TRA     s:26285

     2324    26280    6                CASE( %ACCOUNT_NAME );

     2325    26281    6                  DISK_DEST_ACCT.ACCT# = SUBSUBNODE$->OUT$SYM.TEXT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:360  

  26281 20 006522   100004 236100                    LDQ     4,,PR1
        20 006523   000033 772000                    QRL     27
        20 006524   000000 622006                    EAX2    0,QL
        20 006525   040000 100540                    MLR     fill='040'O
        20 006526   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        20 006527   000000 000010 xsym               ADSC9   DISK_DEST_ACCT           cn=0,n=8
        20 006530   006536 710000 20                 TRA     s:26285

     2326    26282    6                CASE( %PROTTYPE );

     2327    26283    6                  TAPE_OPTION.PROTTYPE = SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  26283 20 006531   100003 473500                    LDP3    3,,PR1
        20 006532   300000 236100                    LDQ     0,,PR3
        20 006533   777777 376007                    ANQ     -1,DL
        20 006534   000041 736000                    QLS     33
        20 006535   000001 756000 xsym               STQ     TAPE_OPTION+1

     2328    26284    6                END;

     2329    26285    5               END;

  26285 20 006536   000234 054000 2                  AOS     SUBSUBNODEX
        20 006537   000231 470400 2                  LDP0    SUBNODE$
        20 006540   000001 236100                    LDQ     1,,PR0
        20 006541   000022 772000                    QRL     18
        20 006542   000234 116000 2                  CMPQ    SUBSUBNODEX
        20 006543   006420 605400 20                 TPNZ    s:26260
        20 006544   006672 710000 20                 TRA     s:26319

     2330    26286    4          CASE( %REBUILD_DISK_DEST );

     2331    26287    4            SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(SUBNODEX);

  26287 20 006545   100003 236110                    LDQ     3,X0,PR1
        20 006546   000233 756000 2                  STQ     SUBSUBNODE$
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:361  

     2332    26288    5            DO SUBSUBNODEX = 0 TO SUBSUBNODE$->OUT$BLK.NSUBLKS - 1; /* DPnn      */

  26288 20 006547   000234 450000 2                  STZ     SUBSUBNODEX
        20 006550   006620 710000 20                 TRA     s:26302+1

     2333    26289    5               IF SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$BLK.NDTYPE = %DEC#

  26289 20 006551   000233 470400 2                  LDP0    SUBSUBNODE$
        20 006552   000234 720000 2                  LXL0    SUBSUBNODEX
        20 006553   000003 471510                    LDP1    3,X0,PR0
        20 006554   100000 236100                    LDQ     0,,PR1
        20 006555   000077 376003                    ANQ     63,DU
        20 006556   000022 116003                    CMPQ    18,DU
        20 006557   006611 601000 20                 TNZ     s:26300

     2334    26290    6                THEN DO;

     2335    26291    6                  CALL CONCAT( DISK_DEST_RES.NAME , 'DP', SUBSTR(SUBSUBNODE$->OUT$BLK

  26291 20 006560   100004 236100                    LDQ     4,,PR1
        20 006561   000033 772000                    QRL     27
        20 006562   000223 221000 19                 LDX1    LEGAL_CHAR+101
        20 006563   000001 741000 xsym               STX1    DISK_DEST_RES+1
        20 006564   000000 622006                    EAX2    0,QL
        20 006565   040000 100540                    MLR     fill='040'O
        20 006566   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        20 006567   000001 400002 xsym               ADSC9   DISK_DEST_RES+1          cn=2,n=2

     2336    26292    6                    .SUBLK$(SUBSUBNODEX)->OUT$SYM.TEXT, 0, SUBSUBNODE$->OUT$BLK
     2337    26293    6                    .SUBLK$(SUBSUBNODEX)->OUT$SYM.COUNT ));
     2338    26294    6                  IF SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.TEXT = '00'

  26294 20 006570   000233 470400 2                  LDP0    SUBSUBNODE$
        20 006571   000234 720000 2                  LXL0    SUBSUBNODEX
        20 006572   000003 471510                    LDP1    3,X0,PR0
        20 006573   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:362  
        20 006574   000033 772000                    QRL     27
        20 006575   000000 621006                    EAX1    0,QL
        20 006576   040000 106540                    CMPC    fill='040'O
        20 006577   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        20 006600   000224 000002 19                 ADSC9   LEGAL_CHAR+102           cn=0,n=2
        20 006601   006617 601000 20                 TNZ     s:26302

     2339    26295    7                   THEN DO;

     2340    26296    7                     COMMAND_ERROR = '1'B;

  26296 20 006602   400000 236003                    LDQ     -131072,DU
        20 006603   000000 756000 xsym               STQ     COMMAND_ERROR

     2341    26297    7                     CALL FLI$RPT_ERR( E_BAD_DP_FORMAT );

  26297 20 006604   000110 630400 21                 EPPR0   72
        20 006605   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 006606   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 006607   000000 011000                    NOP     0

     2342    26298    7                     END;

     2343    26299    6                  END;

  26299 20 006610   006617 710000 20                 TRA     s:26302

     2344    26300    5                ELSE DISK_DEST_SN.SN#(0) = SUBSUBNODE$->OUT$BLK.SUBLK$

  26300 20 006611   100004 236100                    LDQ     4,,PR1
        20 006612   000033 772000                    QRL     27
        20 006613   000000 621006                    EAX1    0,QL
        20 006614   040000 100540                    MLR     fill='040'O
        20 006615   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        20 006616   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6

     2345    26301    5                    (SUBSUBNODEX)->OUT$SYM.TEXT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:363  
     2346    26302    5               END;

  26302 20 006617   000234 054000 2                  AOS     SUBSUBNODEX
        20 006620   000233 470400 2                  LDP0    SUBSUBNODE$
        20 006621   000001 236100                    LDQ     1,,PR0
        20 006622   000022 772000                    QRL     18
        20 006623   000234 116000 2                  CMPQ    SUBSUBNODEX
        20 006624   006551 605400 20                 TPNZ    s:26289

     2347    26303
     2348    26304    4            REBUILD_SN.SN#(0) = DISK_DEST_SN.SN#(0);

  26304 20 006625   040000 100400                    MLR     fill='040'O
        20 006626   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6
        20 006627   000001 000006 xsym               ADSC9   REBUILD_SN+1             cn=0,n=6

     2349    26305    4            OPEN_REBUILD.V.RES# = DISK_DEST_RES.NAME;

  26305 20 006630   000001 236000 xsym               LDQ     DISK_DEST_RES+1
        20 006631   000050 756000 xsym               STQ     OPEN_REBUILD+40

     2350    26306
     2351    26307    4            TEMP = LENGTHC(DPLIST.NUM#) + LENGTHC(DPLIST.SN#(0));

  26307 20 006632   000012 235007                    LDA     10,DL
        20 006633   000236 755000 2                  STA     TEMP

     2352    26308    4            TEMP = (TEMP + 3) / 4;

  26308 20 006634   000236 236000 2                  LDQ     TEMP
        20 006635   000003 036007                    ADLQ    3,DL
        20 006636   000004 506007                    DIV     4,DL
        20 006637   000236 756000 2                  STQ     TEMP

     2353    26309    4            CALL FLI$ALLOC( TEMP, DPLIST$ );

  26309 20 006640   000111 630400 21                 EPPR0   73
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:364  
        20 006641   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 006642   000000 701000 xent               TSX1    FLI$ALLOC
        20 006643   000000 011000                    NOP     0

     2354    26310    4            DPLIST.NUM# = 1;

  26310 20 006644   000001 235007                    LDA     1,DL
        20 006645   000000 470400 xsym               LDP0    DPLIST$
        20 006646   000000 755100                    STA     0,,PR0

     2355    26311    4            DPLIST.SN#(0) = DISK_DEST_SN.SN#(0);

  26311 20 006647   000000 470400 xsym               LDP0    DPLIST$
        20 006650   040100 100400                    MLR     fill='040'O
        20 006651   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6
        20 006652   000001 000006                    ADSC9   1,,PR0                   cn=0,n=6

     2356    26312
     2357    26313    4            TEMP = LENGTHC(DPRESLIST.NBR) + LENGTHC(DPRESLIST.NAME(0));

  26313 20 006653   000010 236007                    LDQ     8,DL
        20 006654   000236 756000 2                  STQ     TEMP

     2358    26314    4            TEMP = (TEMP + 3) / 4;         /* Number of words in DPRESLIST       */

  26314 20 006655   000003 036007                    ADLQ    3,DL
        20 006656   000004 506007                    DIV     4,DL
        20 006657   000236 756000 2                  STQ     TEMP

     2359    26315    4            CALL FLI$ALLOC( TEMP, DPRESLIST$ );

  26315 20 006660   000113 630400 21                 EPPR0   75
        20 006661   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 006662   000000 701000 xent               TSX1    FLI$ALLOC
        20 006663   000000 011000                    NOP     0

     2360    26316    4            DPRESLIST.NBR = 1;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:365  

  26316 20 006664   000001 235007                    LDA     1,DL
        20 006665   000000 470400 xsym               LDP0    DPRESLIST$
        20 006666   000000 755100                    STA     0,,PR0

     2361    26317    4            DPRESLIST.NAME(0) = DISK_DEST_RES.NAME;

  26317 20 006667   000001 236000 xsym               LDQ     DISK_DEST_RES+1
        20 006670   000000 470400 xsym               LDP0    DPRESLIST$
        20 006671   000001 756100                    STQ     1,,PR0

     2362    26318    4          END;

     2363    26319    3         END;

  26319 20 006672   000232 054000 2                  AOS     SUBNODEX
        20 006673   000226 470400 2                  LDP0    NODE$
        20 006674   000001 236100                    LDQ     1,,PR0
        20 006675   000022 772000                    QRL     18
        20 006676   000232 116000 2                  CMPQ    SUBNODEX
        20 006677   006317 605400 20                 TPNZ    s:26236

     2364    26320
     2365    26321    2      IF DISK_DEST_SN.SN#(0) = ' ' AND DISK_DEST_ACCT.ACCT# ~= ' '

  26321 20 006700   040000 106400                    CMPC    fill='040'O
        20 006701   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6
        20 006702   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        20 006703   006732 601000 20                 TNZ     s:26332
        20 006704   040000 106400                    CMPC    fill='040'O
        20 006705   000000 000010 xsym               ADSC9   DISK_DEST_ACCT           cn=0,n=8
        20 006706   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        20 006707   006732 600000 20                 TZE     s:26332

     2366    26322    3       THEN DO;                            /* Find packset                       */

     2367    26323    3         OUR_ACCT.ACCT# = DISK_DEST_ACCT.ACCT#;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:366  

  26323 20 006710   040000 100400                    MLR     fill='040'O
        20 006711   000000 000010 xsym               ADSC9   DISK_DEST_ACCT           cn=0,n=8
        20 006712   000636 000010 2                  ADSC9   OUR_ACCT                 cn=0,n=8

     2368    26324    3         CALL M$MADMUCK( GET_PSN )

  26324 20 006713   000626 630400 2                  EPPR0   GET_PSN
        20 006714   460005 713400                    CLIMB   alt,+24581
        20 006715   401000 401760                    pmme    nvectors=3
        20 006716   006720 702000 20                 TSX2    s:26326
        20 006717   006727 710000 20                 TRA     s:26330

     2369    26325    4          WHENALTRETURN DO;

     2370    26326    4            CALL FLI$RPT_ERR;

  26326 20 006720   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 006721   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 006722   000000 011000                    NOP     0

     2371    26327    4            COMMAND_ERROR = '1'B;

  26327 20 006723   400000 236003                    LDQ     -131072,DU
        20 006724   000000 756000 xsym               STQ     COMMAND_ERROR

     2372    26328    4            ALTRETURN;

  26328 20 006725   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 006726   000000 702211                    TSX2  ! 0,X1

     2373    26329    4            END;
     2374    26330    3         DISK_DEST_SN.SN#(0) = MUCK_LIST.SN#(0);

  26330 20 006727   040000 100400                    MLR     fill='040'O
        20 006730   000221 000006 2                  ADSC9   MUCK_LIST+1              cn=0,n=6
        20 006731   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:367  

     2375    26331    3         END;

     2376    26332    2      RETURN;

  26332 20 006732   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 006733   000001 702211                    TSX2  ! 1,X1

     2377    26333
     2378    26334    2   END FLB_DISK_DEST;
     2379    26335        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:368  
     2380    26336
     2381    26337    1   FLB_DISK_SPEC: PROC(SUBNODEY) ALTRET;

  26337 20 006734   200030 741300       FLB_DISK_SP* STX1  ! DCB#+1,,AUTO

     2382    26338        /*F*  NAME: FLB_DISK_SPEC
     2383    26339              PURPOSE: Process disk specification nodes.
     2384    26340        ***/
     2385    26341
     2386    26342    2   DCL SUBNODEY SBIN;                 /* Subnode at which to start processing    */
     2387    26343
     2388    26344        /****************************************/
     2389    26345
     2390    26346           /***
     2391    26347            *** Process options.
     2392    26348            ***/
     2393    26349
     2394    26350    2   DISK_SPEC_DO:
     2395    26351    3      DO SUBNODEX = SUBNODEY TO NODE$->OUT$BLK.NSUBLKS - 1;

  26351 20 006735   200031 470500       DISK_SPEC_DO LDP0    @SUBNODEY,,AUTO
        20 006736   000000 235100                    LDA     0,,PR0
        20 006737   000232 755000 2                  STA     SUBNODEX
        20 006740   007460 710000 20                 TRA     s:26490+1

     2396    26352    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);

  26352 20 006741   000226 470400 2                  LDP0    NODE$
        20 006742   000232 720000 2                  LXL0    SUBNODEX
        20 006743   000003 236110                    LDQ     3,X0,PR0
        20 006744   000231 756000 2                  STQ     SUBNODE$

     2397    26353
     2398    26354    4         DO CASE( SUBNODE$->OUT$BLK.CODE );

  26354 20 006745   000231 471400 2                  LDP1    SUBNODE$
        20 006746   100000 721100                    LXL1    0,,PR1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:369  
        20 006747   000020 101003                    CMPX1   16,DU
        20 006750   006752 602011 20                 TNC     s:26354+5,X1
        20 006751   007457 710000 20                 TRA     s:26490
        20 006752   006772 710000 20                 TRA     s:26357
        20 006753   007212 710000 20                 TRA     s:26403
        20 006754   007217 710000 20                 TRA     s:26407
        20 006755   007457 710000 20                 TRA     s:26490
        20 006756   007457 710000 20                 TRA     s:26490
        20 006757   007457 710000 20                 TRA     s:26490
        20 006760   007212 710000 20                 TRA     s:26403
        20 006761   007212 710000 20                 TRA     s:26403
        20 006762   007212 710000 20                 TRA     s:26403
        20 006763   007457 710000 20                 TRA     s:26490
        20 006764   007212 710000 20                 TRA     s:26403
        20 006765   007457 710000 20                 TRA     s:26490
        20 006766   007457 710000 20                 TRA     s:26490
        20 006767   007457 710000 20                 TRA     s:26490
        20 006770   007212 710000 20                 TRA     s:26403
        20 006771   007317 710000 20                 TRA     s:26438

     2399    26355
     2400    26356    4          CASE( %DPLIST );

     2401    26357    4            NBR_DPS = SUBNODE$->OUT$BLK.NSUBLKS;

  26357 20 006772   100001 236100                    LDQ     1,,PR1
        20 006773   000022 772000                    QRL     18
        20 006774   000225 756000 2                  STQ     NBR_DPS

     2402    26358    4            TEMP = LENGTHC(DPLIST.NUM#) + NBR_DPS * LENGTHC(DPLIST.SN#(0));

  26358 20 006775   000006 402007                    MPY     6,DL
        20 006776   000004 036007                    ADLQ    4,DL
        20 006777   000236 756000 2                  STQ     TEMP

     2403    26359    4            TEMP = (TEMP + 3) / 4;         /* Number of words in DPLIST          */

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:370  
  26359 20 007000   000003 036007                    ADLQ    3,DL
        20 007001   000004 506007                    DIV     4,DL
        20 007002   000236 756000 2                  STQ     TEMP

     2404    26360    4            CALL FLI$ALLOC( TEMP, DPLIST$ );

  26360 20 007003   000111 630400 21                 EPPR0   73
        20 007004   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 007005   000000 701000 xent               TSX1    FLI$ALLOC
        20 007006   000000 011000                    NOP     0

     2405    26361
     2406    26362    4            TEMP = LENGTHC(DPRESLIST.NBR) + NBR_DPS * LENGTHC(DPRESLIST.NAME(0));

  26362 20 007007   000225 235000 2                  LDA     NBR_DPS
        20 007010   000002 735000                    ALS     2
        20 007011   000004 035007                    ADLA    4,DL
        20 007012   000236 755000 2                  STA     TEMP

     2407    26363    4            TEMP = (TEMP+3)/4;             /* Number of words in DPRESLIST       */

  26363 20 007013   000236 236000 2                  LDQ     TEMP
        20 007014   000003 036007                    ADLQ    3,DL
        20 007015   000004 506007                    DIV     4,DL
        20 007016   000236 756000 2                  STQ     TEMP

     2408    26364    4            CALL FLI$ALLOC( TEMP, DPRESLIST$ );

  26364 20 007017   000113 630400 21                 EPPR0   75
        20 007020   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 007021   000000 701000 xent               TSX1    FLI$ALLOC
        20 007022   000000 011000                    NOP     0

     2409    26365
     2410    26366    4            DPLIST.NUM# = NBR_DPS;

  26366 20 007023   000000 470400 xsym               LDP0    DPLIST$
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:371  
        20 007024   000225 235000 2                  LDA     NBR_DPS
        20 007025   000000 755100                    STA     0,,PR0

     2411    26367    4            DPRESLIST.NBR = NBR_DPS;

  26367 20 007026   000000 470400 xsym               LDP0    DPRESLIST$
        20 007027   000000 755100                    STA     0,,PR0

     2412    26368    5            DO I=0 TO NBR_DPS-1;           /* Move packsets' names into the list */

  26368 20 007030   000213 450000 2                  STZ     I
        20 007031   007146 710000 20                 TRA     s:26390+1

     2413    26369    5               DPRESLIST.NAME(I) = ' ';

  26369 20 007032   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 007033   000000 470400 xsym               LDP0    DPRESLIST$
        20 007034   000213 720000 2                  LXL0    I
        20 007035   000001 756110                    STQ     1,X0,PR0

     2414    26370    5               SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(I);

  26370 20 007036   000231 470400 2                  LDP0    SUBNODE$
        20 007037   000003 236110                    LDQ     3,X0,PR0
        20 007040   000233 756000 2                  STQ     SUBSUBNODE$

     2415    26371    5               IF SUBSUBNODE$->OUT$BLK.NSUBLKS = 1 /* DPnn# or DP# spec'd?       */

  26371 20 007041   000233 471400 2                  LDP1    SUBSUBNODE$
        20 007042   100001 221100                    LDX1    1,,PR1
        20 007043   000001 101003                    CMPX1   1,DU
        20 007044   007057 601000 20                 TNZ     s:26374

     2416    26372    5                THEN DPLIST.SN#(I) = SUBSUBNODE$->OUT$SYM.TEXT; /* DP#           */

  26372 20 007045   100004 236100                    LDQ     4,,PR1
        20 007046   000033 772000                    QRL     27
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:372  
        20 007047   000000 622006                    EAX2    0,QL
        20 007050   000213 236000 2                  LDQ     I
        20 007051   000006 402007                    MPY     6,DL
        20 007052   000000 473400 xsym               LDP3    DPLIST$
        20 007053   040106 100540                    MLR     fill='040'O
        20 007054   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        20 007055   300001 000006                    ADSC9   1,Q,PR3                  cn=0,n=6
        20 007056   007145 710000 20                 TRA     s:26390

     2417    26373    6                ELSE DO;

     2418    26374    7                  DO SUBSUBNODEX = 0 TO SUBSUBNODE$->OUT$BLK.NSUBLKS - 1; /* DPnn# */

  26374 20 007057   000234 450000 2                  STZ     SUBSUBNODEX
        20 007060   007140 710000 20                 TRA     s:26388+1

     2419    26375    7                     IF SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$BLK.NDTYPE = %
             26375                              DEC#

  26375 20 007061   000233 470400 2                  LDP0    SUBSUBNODE$
        20 007062   000234 720000 2                  LXL0    SUBSUBNODEX
        20 007063   000003 471510                    LDP1    3,X0,PR0
        20 007064   100000 236100                    LDQ     0,,PR1
        20 007065   000077 376003                    ANQ     63,DU
        20 007066   000022 116003                    CMPQ    18,DU
        20 007067   007126 601000 20                 TNZ     s:26386

     2420    26376    8                      THEN DO;

     2421    26377    8                        CALL CONCAT( DPRESLIST.NAME(I), 'DP', SUBSTR(SUBSUBNODE$->

  26377 20 007070   100004 236100                    LDQ     4,,PR1
        20 007071   000033 772000                    QRL     27
        20 007072   000223 221000 19                 LDX1    LEGAL_CHAR+101
        20 007073   000000 473400 xsym               LDP3    DPRESLIST$
        20 007074   000213 722000 2                  LXL2    I
        20 007075   300001 741112                    STX1    1,X2,PR3
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:373  
        20 007076   000213 235000 2                  LDA     I
        20 007077   000002 735000                    ALS     2
        20 007100   000000 623006                    EAX3    0,QL
        20 007101   000000 470400 xsym               LDP0    DPRESLIST$
        20 007102   040105 100540                    MLR     fill='040'O
        20 007103   100004 200013                    ADSC9   4,,PR1                   cn=1,n=*X3
        20 007104   000001 400002                    ADSC9   1,A,PR0                  cn=2,n=2

     2422    26378    8                          OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.TEXT, 0, SUBSUBNODE$->
     2423    26379    8                          OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.COUNT ));
     2424    26380    8                        IF SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->OUT$SYM.TEXT =
             26380                                 '00'

  26380 20 007105   000233 470400 2                  LDP0    SUBSUBNODE$
        20 007106   000234 720000 2                  LXL0    SUBSUBNODEX
        20 007107   000003 471510                    LDP1    3,X0,PR0
        20 007110   100004 236100                    LDQ     4,,PR1
        20 007111   000033 772000                    QRL     27
        20 007112   000000 621006                    EAX1    0,QL
        20 007113   040000 106540                    CMPC    fill='040'O
        20 007114   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        20 007115   000224 000002 19                 ADSC9   LEGAL_CHAR+102           cn=0,n=2
        20 007116   007137 601000 20                 TNZ     s:26388

     2425    26381    9                         THEN DO;

     2426    26382    9                           COMMAND_ERROR = '1'B;

  26382 20 007117   400000 236003                    LDQ     -131072,DU
        20 007120   000000 756000 xsym               STQ     COMMAND_ERROR

     2427    26383    9                           CALL FLI$RPT_ERR( E_BAD_DP_FORMAT );

  26383 20 007121   000110 630400 21                 EPPR0   72
        20 007122   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 007123   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 007124   000000 011000                    NOP     0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:374  

     2428    26384    9                           END;

     2429    26385    8                        END;

  26385 20 007125   007137 710000 20                 TRA     s:26388

     2430    26386    7                      ELSE DPLIST.SN#(I) = SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX)->

  26386 20 007126   100004 236100                    LDQ     4,,PR1
        20 007127   000033 772000                    QRL     27
        20 007130   000000 621006                    EAX1    0,QL
        20 007131   000213 236000 2                  LDQ     I
        20 007132   000006 402007                    MPY     6,DL
        20 007133   000000 473400 xsym               LDP3    DPLIST$
        20 007134   040106 100540                    MLR     fill='040'O
        20 007135   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        20 007136   300001 000006                    ADSC9   1,Q,PR3                  cn=0,n=6

     2431    26387    7                          OUT$SYM.TEXT;
     2432    26388    7                     END;

  26388 20 007137   000234 054000 2                  AOS     SUBSUBNODEX
        20 007140   000233 470400 2                  LDP0    SUBSUBNODE$
        20 007141   000001 236100                    LDQ     1,,PR0
        20 007142   000022 772000                    QRL     18
        20 007143   000234 116000 2                  CMPQ    SUBSUBNODEX
        20 007144   007061 605400 20                 TPNZ    s:26375

     2433    26389    6                  END;

     2434    26390    5               END;

  26390 20 007145   000213 054000 2                  AOS     I
        20 007146   000213 236000 2                  LDQ     I
        20 007147   000225 116000 2                  CMPQ    NBR_DPS
        20 007150   007032 604000 20                 TMI     s:26369
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:375  

     2435    26391    5            DO I=0 TO NBR_DPS-2;

  26391 20 007151   000213 450000 2                  STZ     I
        20 007152   007205 710000 20                 TRA     s:26399+1

     2436    26392    6               DO J=I+1 TO NBR_DPS-1;

  26392 20 007153   000213 235000 2                  LDA     I
        20 007154   000001 035007                    ADLA    1,DL
        20 007155   000246 755000 2                  STA     J
        20 007156   007201 710000 20                 TRA     s:26398+1

     2437    26393    6                  IF DPLIST.SN#(I) = DPLIST.SN#(J)

  26393 20 007157   000213 236000 2                  LDQ     I
        20 007160   000006 402007                    MPY     6,DL
        20 007161   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 007162   000246 236000 2                  LDQ     J
        20 007163   000006 402007                    MPY     6,DL
        20 007164   000000 470400 xsym               LDP0    DPLIST$
        20 007165   200042 235100                    LDA     @MAX_NX+1,,AUTO
        20 007166   040106 106505                    CMPC    fill='040'O
        20 007167   000001 000006                    ADSC9   1,A,PR0                  cn=0,n=6
        20 007170   000001 000006                    ADSC9   1,Q,PR0                  cn=0,n=6
        20 007171   007200 601000 20                 TNZ     s:26398

     2438    26394    7                   THEN DO;

     2439    26395    7                     COMMAND_ERROR = '1'B;

  26395 20 007172   400000 236003                    LDQ     -131072,DU
        20 007173   000000 756000 xsym               STQ     COMMAND_ERROR

     2440    26396    7                     CALL FLI$RPT_ERR( E_DUPLICATE_PSN, );

  26396 20 007174   000115 630400 21                 EPPR0   77
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:376  
        20 007175   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 007176   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 007177   000000 011000                    NOP     0

     2441    26397    7                     END;

     2442    26398    6                  END;

  26398 20 007200   000246 054000 2                  AOS     J
        20 007201   000246 236000 2                  LDQ     J
        20 007202   000225 116000 2                  CMPQ    NBR_DPS
        20 007203   007157 604000 20                 TMI     s:26393

     2443    26399    5               END;

  26399 20 007204   000213 054000 2                  AOS     I
        20 007205   000225 236000 2                  LDQ     NBR_DPS
        20 007206   000002 136007                    SBLQ    2,DL
        20 007207   000213 116000 2                  CMPQ    I
        20 007210   007153 605000 20                 TPL     s:26392
        20 007211   007457 710000 20                 TRA     s:26490

     2444    26400
     2445    26401    4          CASE( %DISK_OPTION_LIST, %ARCHIVE_TOPTION_LIST, %PURGE_TOPTION_LIST,

     2446    26402    4                 %PURGE_SOPTION_LIST, %DUAL_SOPTION_LIST, %DUALI_SOPTION_LIST );
     2447    26403    4            DISK_SRCHCOND = '0'B;

  26403 20 007212   000000 222003                    LDX2    0,DU
        20 007213   000000 742000 xsym               STX2    DISK_SRCHCOND

     2448    26404    4            CALL FLB_DISK_OPTION_LIST;

  26404 20 007214   010346 701000 20                 TSX1    FLB_DISK_OPTION_LIST
        20 007215   000000 011000                    NOP     0
        20 007216   007457 710000 20                 TRA     s:26490

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:377  
     2449    26405
     2450    26406    4          CASE( %DISK_FILE_SPEC );

     2451    26407    4            TEMP = LENGTHW(DISK_FILE_SPEC.NBR)+LENGTHW(DISK_FILE_SPEC.NBR_LEFT)

  26407 20 007217   000057 235007                    LDA     47,DL
        20 007220   000236 755000 2                  STA     TEMP

     2452    26408    4              + LENGTHW(DISK_FILE_SPEC.PASSWORD_SPEC)
     2453    26409    4              + LENGTHW(DISK_FILE_SPEC.PASSWORD#)
     2454    26410    4              + 2 * LENGTHW(DISK_FILE_SPEC.SPEC(0));
     2455    26411    4            CALL FLI$ALLOC( TEMP, DISK_FILE_SPEC$ );

  26411 20 007221   000116 630400 21                 EPPR0   78
        20 007222   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 007223   000000 701000 xent               TSX1    FLI$ALLOC
        20 007224   000000 011000                    NOP     0

     2456    26412    4            DISK_FILE_SPEC.NBR_LEFT = 2;

  26412 20 007225   000002 235007                    LDA     2,DL
        20 007226   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 007227   000001 755100                    STA     1,,PR0

     2457    26413    4            DISK_FILE_SPEC.NBR = 0;

  26413 20 007230   000000 450100                    STZ     0,,PR0

     2458    26414
     2459    26415    5            DO SUBSUBNODEX = 0 TO SUBNODE$->OUT$BLK.NSUBLKS - 1;

  26415 20 007231   000234 450000 2                  STZ     SUBSUBNODEX
        20 007232   007311 710000 20                 TRA     s:26436+1

     2460    26416    5               SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX);

  26416 20 007233   000231 470400 2                  LDP0    SUBNODE$
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:378  
        20 007234   000234 720000 2                  LXL0    SUBSUBNODEX
        20 007235   000003 236110                    LDQ     3,X0,PR0
        20 007236   000233 756000 2                  STQ     SUBSUBNODE$

     2461    26417
     2462    26418    6               DO CASE( SUBSUBNODE$->OUT$BLK.CODE );

  26418 20 007237   000233 471400 2                  LDP1    SUBSUBNODE$
        20 007240   100000 721100                    LXL1    0,,PR1
        20 007241   000002 101003                    CMPX1   2,DU
        20 007242   007244 602011 20                 TNC     s:26418+5,X1
        20 007243   007310 710000 20                 TRA     s:26436
        20 007244   007246 710000 20                 TRA     s:26421
        20 007245   007257 710000 20                 TRA     s:26426

     2463    26419
     2464    26420    6                CASE( %FID_RANGE );

     2465    26421    6                  CALL FLB_FID_RANGE( SUBSUBNODE$ );

  26421 20 007246   000120 236000 21                 LDQ     80
        20 007247   200033 756100                    STQ     DISK_OPTION_DIR_SAVE+1,,AUTO
        20 007250   012224 701000 20                 TSX1    FLB_FID_RANGE
        20 007251   000000 011000                    NOP     0

     2466    26422    6                  CALL FLB_NUTHER_FILE_SPEC;

  26422 20 007252   012127 701000 20                 TSX1    FLB_NUTHER_FILE_SPEC
        20 007253   000000 011000                    NOP     0

     2467    26423    6                  RANGE_SPECIFIED = '1'B;

  26423 20 007254   400000 236003                    LDQ     -131072,DU
        20 007255   000242 756000 2                  STQ     RANGE_SPECIFIED
        20 007256   007310 710000 20                 TRA     s:26436

     2468    26424
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:379  
     2469    26425    6                CASE( %FID_SKIP );

     2470    26426    7                  DO I=0 TO SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.NSUBLKS-1;

  26426 20 007257   000213 450000 2                  STZ     I
        20 007260   007302 710000 20                 TRA     s:26433+1

     2471    26427    7                     CALL FLB_FID_RANGE( SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.

  26427 20 007261   000233 470400 2                  LDP0    SUBSUBNODE$
        20 007262   000003 471500                    LDP1    3,,PR0
        20 007263   000213 720000 2                  LXL0    I
        20 007264   100003 633510                    EPPR3   3,X0,PR1
        20 007265   200033 453500                    STP3    DISK_OPTION_DIR_SAVE+1,,AUTO
        20 007266   012224 701000 20                 TSX1    FLB_FID_RANGE
        20 007267   000000 011000                    NOP     0

     2472    26428    7                       SUBLK$(I) );
     2473    26429    7                     CALL FLB_NUTHER_FILE_SPEC;

  26429 20 007270   012127 701000 20                 TSX1    FLB_NUTHER_FILE_SPEC
        20 007271   000000 011000                    NOP     0

     2474    26430    7                     SKIP_SPECIFIED = '1'B;

  26430 20 007272   400000 236003                    LDQ     -131072,DU
        20 007273   000243 756000 2                  STQ     SKIP_SPECIFIED

     2475    26431    7                     DISK_FILE_SPEC.SPEC.SKIP(DISK_FILE_SPEC.NBR-1) = 1;

  26431 20 007274   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 007275   000000 236100                    LDQ     0,,PR0
        20 007276   000025 402007                    MPY     21,DL
        20 007277   000001 235007                    LDA     1,DL
        20 007300   077760 755106                    STA     -16,QL,PR0

     2476    26432                                                /* Skip indicator                     */
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:380  
     2477    26433    7                     END;

  26433 20 007301   000213 054000 2                  AOS     I
        20 007302   000233 470400 2                  LDP0    SUBSUBNODE$
        20 007303   000003 471500                    LDP1    3,,PR0
        20 007304   100001 236100                    LDQ     1,,PR1
        20 007305   000022 772000                    QRL     18
        20 007306   000213 116000 2                  CMPQ    I
        20 007307   007261 605400 20                 TPNZ    s:26427

     2478    26434
     2479    26435    6                END;

     2480    26436    5               END;

  26436 20 007310   000234 054000 2                  AOS     SUBSUBNODEX
        20 007311   000231 470400 2                  LDP0    SUBNODE$
        20 007312   000001 236100                    LDQ     1,,PR0
        20 007313   000022 772000                    QRL     18
        20 007314   000234 116000 2                  CMPQ    SUBSUBNODEX
        20 007315   007233 605400 20                 TPNZ    s:26416
        20 007316   007457 710000 20                 TRA     s:26490

     2481    26437    4          CASE( %DISK_FID_SPEC );

     2482    26438    4            IF FPT_FID_RESULTS.SN          /* Packset specified?                 */

  26438 20 007317   001346 236000 2                  LDQ     FPT_FID_RESULTS
        20 007320   040000 316003                    CANQ    16384,DU
        20 007321   007365 600000 20                 TZE     s:26454

     2483    26439    5             THEN DO;

     2484    26440    5               NBR_DPS = 1;

  26440 20 007322   000001 235007                    LDA     1,DL
        20 007323   000225 755000 2                  STA     NBR_DPS
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:381  

     2485    26441    5               TEMP = LENGTHC(DPLIST.NUM#) + NBR_DPS * LENGTHC(DPLIST.SN#(0));

  26441 20 007324   000225 236000 2                  LDQ     NBR_DPS
        20 007325   000006 402007                    MPY     6,DL
        20 007326   000004 036007                    ADLQ    4,DL
        20 007327   000236 756000 2                  STQ     TEMP

     2486    26442    5               TEMP = (TEMP + 3) / 4;      /* Number of words in DPLIST          */

  26442 20 007330   000003 036007                    ADLQ    3,DL
        20 007331   000004 506007                    DIV     4,DL
        20 007332   000236 756000 2                  STQ     TEMP

     2487    26443    5               CALL FLI$ALLOC( TEMP, DPLIST$ );

  26443 20 007333   000111 630400 21                 EPPR0   73
        20 007334   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 007335   000000 701000 xent               TSX1    FLI$ALLOC
        20 007336   000000 011000                    NOP     0

     2488    26444    5               DPLIST.NUM# = NBR_DPS;

  26444 20 007337   000000 470400 xsym               LDP0    DPLIST$
        20 007340   000225 235000 2                  LDA     NBR_DPS
        20 007341   000000 755100                    STA     0,,PR0

     2489    26445    5               DPLIST.SN#(0) = FID_SN.SN#(0); /* Move packset's name into the list */

  26445 20 007342   000000 470400 xsym               LDP0    DPLIST$
        20 007343   040100 100400                    MLR     fill='040'O
        20 007344   001375 000006 2                  ADSC9   FID_SN+1                 cn=0,n=6
        20 007345   000001 000006                    ADSC9   1,,PR0                   cn=0,n=6

     2490    26446
     2491    26447    5               TEMP = LENGTHC(DPRESLIST.NBR) + LENGTHC(DPRESLIST.NAME(0));

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:382  
  26447 20 007346   000010 236007                    LDQ     8,DL
        20 007347   000236 756000 2                  STQ     TEMP

     2492    26448    5               TEMP = (TEMP + 3) / 4;      /* Number of words in DPRESLIST       */

  26448 20 007350   000003 036007                    ADLQ    3,DL
        20 007351   000004 506007                    DIV     4,DL
        20 007352   000236 756000 2                  STQ     TEMP

     2493    26449    5               CALL FLI$ALLOC( TEMP, DPRESLIST$ );

  26449 20 007353   000113 630400 21                 EPPR0   75
        20 007354   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 007355   000000 701000 xent               TSX1    FLI$ALLOC
        20 007356   000000 011000                    NOP     0

     2494    26450    5               DPRESLIST.NBR = 1;

  26450 20 007357   000001 235007                    LDA     1,DL
        20 007360   000000 470400 xsym               LDP0    DPRESLIST$
        20 007361   000000 755100                    STA     0,,PR0

     2495    26451    5               DPRESLIST.NAME(0) = ' ';

  26451 20 007362   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 007363   000000 470400 xsym               LDP0    DPRESLIST$
        20 007364   000001 756100                    STQ     1,,PR0

     2496    26452    5               END;

     2497    26453
     2498    26454    4            IF FPT_FID_RESULTS.ACCT        /* Account specified?                 */

  26454 20 007365   001346 236000 2                  LDQ     FPT_FID_RESULTS
        20 007366   200000 316003                    CANQ    65536,DU
        20 007367   007402 600000 20                 TZE     s:26461
        20 007370   001353 236000 2                  LDQ     FPT_FID_RESULTS+5
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:383  
        20 007371   000777 316003                    CANQ    511,DU
        20 007372   007402 600000 20                 TZE     s:26461

     2499    26455    4              AND FPT_FID_RESULTS.CLENGTH.ACCT > 0
     2500    26456    5             THEN DO;

     2501    26457    5               START_ACCT = FID_ACCT;

  26457 20 007373   001370 237000 2                  LDAQ    FID_ACCT
        20 007374   000461 755000 2                  STA     START_ACCT
        20 007375   000462 756000 2                  STQ     START_ACCT+1

     2502    26458    5               FIRST_ACCT_SPECIFIED.ACCT# = START_ACCT.ACCT#;

  26458 20 007376   040000 100400                    MLR     fill='040'O
        20 007377   000461 000010 2                  ADSC9   START_ACCT               cn=0,n=8
        20 007400   000244 000010 2                  ADSC9   FIRST_ACCT_SPECIFIED     cn=0,n=8

     2503    26459    5               END;

  26459 20 007401   007410 710000 20                 TRA     s:26464

     2504    26460    5             ELSE DO;

     2505    26461    5               START_ACCT.ACCT# = B$JIT.FACCN;

  26461 20 007402   000000 470400 xsym               LDP0    B$JIT$
        20 007403   000006 237100                    LDAQ    6,,PR0
        20 007404   000461 755000 2                  STA     START_ACCT
        20 007405   000462 756000 2                  STQ     START_ACCT+1

     2506    26462    5               FIRST_ACCT_SPECIFIED.ACCT# = B$JIT.FACCN;

  26462 20 007406   000006 237100                    LDAQ    6,,PR0
        20 007407   000244 757000 2                  STAQ    FIRST_ACCT_SPECIFIED

     2507    26463    5               END;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:384  

     2508    26464    4            STOP_ACCT = START_ACCT;

  26464 20 007410   000000 100400                    MLR     fill='000'O
        20 007411   000461 000010 2                  ADSC9   START_ACCT               cn=0,n=8
        20 007412   000473 000010 2                  ADSC9   STOP_ACCT                cn=0,n=8

     2509    26465
     2510    26466    4            TEMP = LENGTHW(DISK_FILE_SPEC.NBR)+LENGTHW(DISK_FILE_SPEC.NBR_LEFT)

  26466 20 007413   000057 235007                    LDA     47,DL
        20 007414   000236 755000 2                  STA     TEMP

     2511    26467    4              + LENGTHW(DISK_FILE_SPEC.PASSWORD_SPEC)
     2512    26468    4              + LENGTHW(DISK_FILE_SPEC.PASSWORD#)
     2513    26469    4              + 2 * LENGTHW(DISK_FILE_SPEC.SPEC(0));
     2514    26470    4            CALL FLI$ALLOC( TEMP, DISK_FILE_SPEC$ );

  26470 20 007415   000116 630400 21                 EPPR0   78
        20 007416   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 007417   000000 701000 xent               TSX1    FLI$ALLOC
        20 007420   000000 011000                    NOP     0

     2515    26471    4            DISK_FILE_SPEC.NBR_LEFT = 2;

  26471 20 007421   000002 235007                    LDA     2,DL
        20 007422   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 007423   000001 755100                    STA     1,,PR0

     2516    26472    4            DISK_FILE_SPEC.NBR = 0;

  26472 20 007424   000000 450100                    STZ     0,,PR0

     2517    26473
     2518    26474    4            IF FPT_FID_RESULTS.NAME        /* File specified?                    */

  26474 20 007425   001346 234000 2                  SZN     FPT_FID_RESULTS
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:385  
        20 007426   007440 605000 20                 TPL     s:26481

     2519    26475    5             THEN DO;

     2520    26476    5               START_FILE.NAME# = FID_NAME.NAME#;

  26476 20 007427   040000 100400                    MLR     fill='040'O
        20 007430   001360 200037 2                  ADSC9   FID_NAME                 cn=1,n=31
        20 007431   000451 000037 2                  ADSC9   START_FILE               cn=0,n=31

     2521    26477    5               START_FILE.L# = FID_NAME.L#;

  26477 20 007432   001360 236000 2                  LDQ     FID_NAME
        20 007433   000033 772000                    QRL     27
        20 007434   000460 552004 2                  STBQ    START_FILE+7,'04'O

     2522    26478    5               STOP_FILE = START_FILE;

  26478 20 007435   000000 100400                    MLR     fill='000'O
        20 007436   000451 000040 2                  ADSC9   START_FILE               cn=0,n=32
        20 007437   000463 000040 2                  ADSC9   STOP_FILE                cn=0,n=32

     2523    26479    5               END;

     2524    26480
     2525    26481    4            IF FPT_FID_RESULTS.PASS

  26481 20 007440   001346 236000 2                  LDQ     FPT_FID_RESULTS
        20 007441   100000 316003                    CANQ    32768,DU
        20 007442   007447 600000 20                 TZE     s:26483

     2526    26482    4             THEN DISK_FILE_SPEC.PASSWORD_SPEC = '1'B;

  26482 20 007443   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 007444   400000 236003                    LDQ     -131072,DU
        20 007445   000002 256100                    ORSQ    2,,PR0
        20 007446   007452 710000 20                 TRA     s:26485
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:386  

     2527    26483    4             ELSE DISK_FILE_SPEC.PASSWORD_SPEC = '0'B;

  26483 20 007447   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 007450   000031 236000 xsym               LDQ     B_VECTNIL+25
        20 007451   000002 356100                    ANSQ    2,,PR0

     2528    26484
     2529    26485    4            CALL FLB_NUTHER_FILE_SPEC;

  26485 20 007452   012127 701000 20                 TSX1    FLB_NUTHER_FILE_SPEC
        20 007453   000000 011000                    NOP     0

     2530    26486    4            RANGE_SPECIFIED = '1'B;

  26486 20 007454   400000 236003                    LDQ     -131072,DU
        20 007455   000242 756000 2                  STQ     RANGE_SPECIFIED

     2531    26487
     2532    26488    4            EXIT DISK_SPEC_DO;

  26488 20 007456   007465 710000 20                 TRA     s:26497

     2533    26489    4          END;

     2534    26490    3         END;

  26490 20 007457   000232 054000 2                  AOS     SUBNODEX
        20 007460   000226 470400 2                  LDP0    NODE$
        20 007461   000001 236100                    LDQ     1,,PR0
        20 007462   000022 772000                    QRL     18
        20 007463   000232 116000 2                  CMPQ    SUBNODEX
        20 007464   006741 605400 20                 TPNZ    s:26352

     2535    26491
     2536    26492        /***
     2537    26493         *** Make sure that dates don't overlap in such as way that no file
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:387  
     2538    26494         *** can be selected.
     2539    26495         ***/
     2540    26496
     2541    26497    3      DO I=0 TO %MAX_DATE;

  26497 20 007465   000213 450000 2                  STZ     I

     2542    26498    3         IF DATE_CRIT.BEF(I) AND DATE_CRIT.AFT(I)

  26498 20 007466   000213 235000 2                  LDA     I
        20 007467   007471 605000 20                 TPL     s:26498+3
        20 007470   000044 035003                    ADLA    36,DU
        20 007471   000000 066405                    CMPB    filb='2'B
        20 007472   000000 000001 xsym               BDSC    DATE_CRIT,A              by=0,bit=0,n=1
        20 007473   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        20 007474   007554 600000 20                 TZE     s:26517
        20 007475   000213 235000 2                  LDA     I
        20 007476   007500 605000 20                 TPL     s:26498+10
        20 007477   000044 035003                    ADLA    36,DU
        20 007500   000000 066405                    CMPB    filb='2'B
        20 007501   000000 050001 xsym               BDSC    DATE_CRIT,A              by=0,bit=5,n=1
        20 007502   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        20 007503   007554 600000 20                 TZE     s:26517
        20 007504   000213 235000 2                  LDA     I
        20 007505   007507 605000 20                 TPL     s:26498+17
        20 007506   000044 035003                    ADLA    36,DU
        20 007507   000000 066405                    CMPB    filb='2'B
        20 007510   000000 000001 xsym               BDSC    DISK_AND_OP,A            by=0,bit=0,n=1
        20 007511   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        20 007512   007554 600000 20                 TZE     s:26517
        20 007513   000213 720000 2                  LXL0    I
        20 007514   000000 236010 xsym               LDQ     DISK_BEF_UTS,X0
        20 007515   000000 116010 xsym               CMPQ    DISK_AFT_UTS,X0
        20 007516   007554 603000 20                 TRC     s:26517

     2543    26499    3           AND DISK_AND_OP(I)
     2544    26500    3           AND DISK_BEF_UTS(I) < DISK_AFT_UTS(I)
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:388  
     2545    26501    4          THEN DO;

     2546    26502    5            DO CASE(I);

  26502 20 007517   000213 235000 2                  LDA     I
        20 007520   000005 115007                    CMPA    5,DL
        20 007521   007523 602005 20                 TNC     s:26502+4,AL
        20 007522   007546 710000 20                 TRA     s:26514
        20 007523   007530 710000 20                 TRA     s:26504
        20 007524   007533 710000 20                 TRA     s:26506
        20 007525   007536 710000 20                 TRA     s:26508
        20 007526   007541 710000 20                 TRA     s:26510
        20 007527   007544 710000 20                 TRA     s:26512

     2547    26503    5             CASE(%ACCESSED);

     2548    26504    5               VLP_ERRCODE = E_BAD_ACC;

  26504 20 007530   000000 236000 xsym               LDQ     E_BAD_ACC
        20 007531   000436 756000 2                  STQ     VLP_ERRCODE
        20 007532   007546 710000 20                 TRA     s:26514

     2549    26505    5             CASE(%MODIFIED);

     2550    26506    5               VLP_ERRCODE = E_BAD_MOD;

  26506 20 007533   000000 236000 xsym               LDQ     E_BAD_MOD
        20 007534   000436 756000 2                  STQ     VLP_ERRCODE
        20 007535   007546 710000 20                 TRA     s:26514

     2551    26507    5             CASE(%CREATED);

     2552    26508    5               VLP_ERRCODE = E_BAD_CRE;

  26508 20 007536   000000 236000 xsym               LDQ     E_BAD_CRE
        20 007537   000436 756000 2                  STQ     VLP_ERRCODE
        20 007540   007546 710000 20                 TRA     s:26514
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:389  

     2553    26509    5             CASE(%BACKED_UP);

     2554    26510    5               VLP_ERRCODE = E_BAD_BAC;

  26510 20 007541   000000 236000 xsym               LDQ     E_BAD_BAC
        20 007542   000436 756000 2                  STQ     VLP_ERRCODE
        20 007543   007546 710000 20                 TRA     s:26514

     2555    26511    5             CASE(%ARCHIVED);

     2556    26512    5               VLP_ERRCODE = E_BAD_ARC;

  26512 20 007544   000000 236000 xsym               LDQ     E_BAD_ARC
        20 007545   000436 756000 2                  STQ     VLP_ERRCODE

     2557    26513    5             END;

     2558    26514    4            CALL FLI$RPT_ERR( VLP_ERRCODE, );

  26514 20 007546   000121 630400 21                 EPPR0   81
        20 007547   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 007550   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 007551   000000 011000                    NOP     0

     2559    26515    4            COMMAND_ERROR = '1'B;

  26515 20 007552   400000 236003                    LDQ     -131072,DU
        20 007553   000000 756000 xsym               STQ     COMMAND_ERROR

     2560    26516    4            END;

     2561    26517    3         END;

  26517 20 007554   000213 054000 2                  AOS     I
        20 007555   000213 235000 2                  LDA     I
        20 007556   000004 115007                    CMPA    4,DL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:390  
        20 007557   007466 604400 20                 TMOZ    s:26498

     2562    26518    2      CALL FLB_ORDER_RANGE ALTRET( JUSTALT );

  26518 20 007560   012603 701000 20                 TSX1    FLB_ORDER_RANGE
        20 007561   010306 702000 20                 TSX2    JUSTALT

     2563    26519
     2564    26520        /***
     2565    26521         *** If no packset specified, default to packset of first account
     2566    26522         *** specified.  If no account specified, default to user's FACCN.
     2567    26523         ***/
     2568    26524
     2569    26525    3      DO CASE( COMMAND );

  26525 20 007562   000167 235000 2                  LDA     COMMAND
        20 007563   000057 115007                    CMPA    47,DL
        20 007564   007566 602005 20                 TNC     s:26525+4,AL
        20 007565   007675 710000 20                 TRA     s:26541
        20 007566   007675 710000 20                 TRA     s:26541
        20 007567   007675 710000 20                 TRA     s:26541
        20 007570   007675 710000 20                 TRA     s:26541
        20 007571   007767 710000 20                 TRA     s:26572
        20 007572   007675 710000 20                 TRA     s:26541
        20 007573   007675 710000 20                 TRA     s:26541
        20 007574   007675 710000 20                 TRA     s:26541
        20 007575   007675 710000 20                 TRA     s:26541
        20 007576   007675 710000 20                 TRA     s:26541
        20 007577   007645 710000 20                 TRA     s:26528
        20 007600   007675 710000 20                 TRA     s:26541
        20 007601   007675 710000 20                 TRA     s:26541
        20 007602   007675 710000 20                 TRA     s:26541
        20 007603   007675 710000 20                 TRA     s:26541
        20 007604   007675 710000 20                 TRA     s:26541
        20 007605   007675 710000 20                 TRA     s:26541
        20 007606   007675 710000 20                 TRA     s:26541
        20 007607   007675 710000 20                 TRA     s:26541
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:391  
        20 007610   007675 710000 20                 TRA     s:26541
        20 007611   007675 710000 20                 TRA     s:26541
        20 007612   007675 710000 20                 TRA     s:26541
        20 007613   007675 710000 20                 TRA     s:26541
        20 007614   007675 710000 20                 TRA     s:26541
        20 007615   007675 710000 20                 TRA     s:26541
        20 007616   007675 710000 20                 TRA     s:26541
        20 007617   007675 710000 20                 TRA     s:26541
        20 007620   007675 710000 20                 TRA     s:26541
        20 007621   007675 710000 20                 TRA     s:26541
        20 007622   007675 710000 20                 TRA     s:26541
        20 007623   007675 710000 20                 TRA     s:26541
        20 007624   007675 710000 20                 TRA     s:26541
        20 007625   007675 710000 20                 TRA     s:26541
        20 007626   007675 710000 20                 TRA     s:26541
        20 007627   007675 710000 20                 TRA     s:26541
        20 007630   007675 710000 20                 TRA     s:26541
        20 007631   007675 710000 20                 TRA     s:26541
        20 007632   007645 710000 20                 TRA     s:26528
        20 007633   007675 710000 20                 TRA     s:26541
        20 007634   007675 710000 20                 TRA     s:26541
        20 007635   007645 710000 20                 TRA     s:26528
        20 007636   007675 710000 20                 TRA     s:26541
        20 007637   007675 710000 20                 TRA     s:26541
        20 007640   007675 710000 20                 TRA     s:26541
        20 007641   007675 710000 20                 TRA     s:26541
        20 007642   007675 710000 20                 TRA     s:26541
        20 007643   007675 710000 20                 TRA     s:26541
        20 007644   007645 710000 20                 TRA     s:26528

     2570    26526    3       CASE( %CHECK );

     2571    26527    3       CASE( %RESTORE, %OPEN_INPUT, %OPEN_UPDATE, %REBUILD );

     2572    26528    3         IF DISK_DEST_SN.SN#(0) ~= ' ' /* Check destination packset for readiness */

  26528 20 007645   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:392  
        20 007646   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6
        20 007647   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        20 007650   007660 600000 20                 TZE     s:26534

     2573    26529    4          THEN DO;

     2574    26530    4            DPSN.SN#(0) = DISK_DEST_SN.SN#(0);

  26530 20 007651   040000 100400                    MLR     fill='040'O
        20 007652   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6
        20 007653   000503 000006 2                  ADSC9   DPSN+1                   cn=0,n=6

     2575    26531    4            CHECK_PACKSET.V.RES# = DISK_DEST_RES.NAME;

  26531 20 007654   000001 236000 xsym               LDQ     DISK_DEST_RES+1
        20 007655   000556 756000 2                  STQ     CHECK_PACKSET+40

     2576    26532    4            CALL FLB_CHECK_PACKSET;

  26532 20 007656   010310 701000 20                 TSX1    FLB_CHECK_PACKSET
        20 007657   000000 011000                    NOP     0

     2577    26533    4            END;

     2578    26534    3         IF COMMAND = %OPEN_UPDATE         /* Check source packset for readiness */

  26534 20 007660   000167 235000 2                  LDA     COMMAND
        20 007661   000044 115007                    CMPA    36,DL
        20 007662   007767 601000 20                 TNZ     s:26572

     2579    26535    4          THEN DO;

     2580    26536    4            DPSN.SN#(0) = DPLIST.SN#(0);

  26536 20 007663   000000 470400 xsym               LDP0    DPLIST$
        20 007664   040000 100500                    MLR     fill='040'O
        20 007665   000001 000006                    ADSC9   1,,PR0                   cn=0,n=6
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:393  
        20 007666   000503 000006 2                  ADSC9   DPSN+1                   cn=0,n=6

     2581    26537    4            CHECK_PACKSET.V.RES# = DPRESLIST.NAME(0);

  26537 20 007667   000000 471400 xsym               LDP1    DPRESLIST$
        20 007670   100001 236100                    LDQ     1,,PR1
        20 007671   000556 756000 2                  STQ     CHECK_PACKSET+40

     2582    26538    4            CALL FLB_CHECK_PACKSET;

  26538 20 007672   010310 701000 20                 TSX1    FLB_CHECK_PACKSET
        20 007673   000000 011000                    NOP     0

     2583    26539    4            END;

  26539 20 007674   007767 710000 20                 TRA     s:26572

     2584    26540    3       CASE( ELSE );

     2585    26541    3         IF DPLIST$ = ADDR(ZERO)

  26541 20 007675   000060 236000 21                 LDQ     48
        20 007676   000000 116000 xsym               CMPQ    DPLIST$
        20 007677   007741 601000 20                 TNZ     s:26558

     2586    26542    4          THEN DO;

     2587    26543    4            IF FIRST_ACCT_SPECIFIED.ACCT# ~= ' '
             26543                     /* Antique code most likely unnecessary */

  26543 20 007700   000244 237000 2                  LDAQ    FIRST_ACCT_SPECIFIED
        20 007701   000122 117000 21                 CMPAQ   82
        20 007702   007706 600000 20                 TZE     s:26545

     2588    26544    4             THEN OUR_ACCT.ACCT# = FIRST_ACCT_SPECIFIED.ACCT#;

  26544 20 007703   000244 237000 2                  LDAQ    FIRST_ACCT_SPECIFIED
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:394  
        20 007704   000636 757000 2                  STAQ    OUR_ACCT
        20 007705   007711 710000 20                 TRA     s:26546

     2589    26545    4             ELSE OUR_ACCT.ACCT# = B$JIT.FACCN;

  26545 20 007706   000000 470400 xsym               LDP0    B$JIT$
        20 007707   000006 237100                    LDAQ    6,,PR0
        20 007710   000636 757000 2                  STAQ    OUR_ACCT

     2590    26546    4            IF B$JIT.FPSN ~= ' '

  26546 20 007711   000000 470400 xsym               LDP0    B$JIT$
        20 007712   040000 106500                    CMPC    fill='040'O
        20 007713   000021 000006                    ADSC9   17,,PR0                  cn=0,n=6
        20 007714   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        20 007715   007722 600000 20                 TZE     s:26549

     2591    26547    4             THEN DPSN.SN#(0) = B$JIT.FPSN;

  26547 20 007716   040000 100500                    MLR     fill='040'O
        20 007717   000021 000006                    ADSC9   17,,PR0                  cn=0,n=6
        20 007720   000503 000006 2                  ADSC9   DPSN+1                   cn=0,n=6
        20 007721   007737 710000 20                 TRA     s:26556

     2592    26548    5             ELSE DO;

     2593    26549    5               CALL M$MADMUCK( GET_PSN )

  26549 20 007722   000626 630400 2                  EPPR0   GET_PSN
        20 007723   460005 713400                    CLIMB   alt,+24581
        20 007724   401000 401760                    pmme    nvectors=3
        20 007725   007727 702000 20                 TSX2    s:26551
        20 007726   007734 710000 20                 TRA     s:26554

     2594    26550    6                WHENALTRETURN DO;

     2595    26551    6                  CALL FLI$RPT_ERR;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:395  

  26551 20 007727   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 007730   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 007731   000000 011000                    NOP     0

     2596    26552    6                  COMMAND_ERROR = '1'B;

  26552 20 007732   400000 236003                    LDQ     -131072,DU
        20 007733   000000 756000 xsym               STQ     COMMAND_ERROR

     2597    26553    6                  END;

     2598    26554    5               DPSN.SN#(0) = MUCK_LIST.SN#(0);

  26554 20 007734   040000 100400                    MLR     fill='040'O
        20 007735   000221 000006 2                  ADSC9   MUCK_LIST+1              cn=0,n=6
        20 007736   000503 000006 2                  ADSC9   DPSN+1                   cn=0,n=6

     2599    26555    5               END;

     2600    26556    4            DPLIST$ = ADDR(DPSN);

  26556 20 007737   000124 236000 21                 LDQ     84
        20 007740   000000 756000 xsym               STQ     DPLIST$

     2601    26557    4            END;

     2602    26558    3         IF COMMAND ~= %WHERE

  26558 20 007741   000167 235000 2                  LDA     COMMAND
        20 007742   000042 115007                    CMPA    34,DL
        20 007743   007767 600000 20                 TZE     s:26572

     2603    26559    4          THEN DO;

     2604    26560    5            DO I = 0 TO DPLIST.NUM# - 1;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:396  
  26560 20 007744   000213 450000 2                  STZ     I
        20 007745   007763 710000 20                 TRA     s:26564+1

     2605    26561    5               DPSN.SN#(0) = DPLIST.SN#(I);

  26561 20 007746   000213 236000 2                  LDQ     I
        20 007747   000006 402007                    MPY     6,DL
        20 007750   000000 470400 xsym               LDP0    DPLIST$
        20 007751   040000 100506                    MLR     fill='040'O
        20 007752   000001 000006                    ADSC9   1,Q,PR0                  cn=0,n=6
        20 007753   000503 000006 2                  ADSC9   DPSN+1                   cn=0,n=6

     2606    26562    5               CHECK_PACKSET.V.RES# = DPRESLIST.NAME(I);

  26562 20 007754   000000 471400 xsym               LDP1    DPRESLIST$
        20 007755   000213 720000 2                  LXL0    I
        20 007756   100001 236110                    LDQ     1,X0,PR1
        20 007757   000556 756000 2                  STQ     CHECK_PACKSET+40

     2607    26563    5               CALL FLB_CHECK_PACKSET;

  26563 20 007760   010310 701000 20                 TSX1    FLB_CHECK_PACKSET
        20 007761   000000 011000                    NOP     0

     2608    26564    5               END;

  26564 20 007762   000213 054000 2                  AOS     I
        20 007763   000000 470400 xsym               LDP0    DPLIST$
        20 007764   000213 236000 2                  LDQ     I
        20 007765   000000 116100                    CMPQ    0,,PR0
        20 007766   007746 604000 20                 TMI     s:26561

     2609    26565    4            END;

     2610    26566    3       END;

     2611    26567
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:397  
     2612    26568        /***
     2613    26569         *** Supply proper command defaults.
     2614    26570         ***/
     2615    26571
     2616    26572    3      DO CASE( COMMAND );

  26572 20 007767   000167 235000 2                  LDA     COMMAND
        20 007770   000057 115007                    CMPA    47,DL
        20 007771   007773 602005 20                 TNC     s:26572+4,AL
        20 007772   010274 710000 20                 TRA     s:26675
        20 007773   010274 710000 20                 TRA     s:26675
        20 007774   010274 710000 20                 TRA     s:26675
        20 007775   010274 710000 20                 TRA     s:26675
        20 007776   010052 710000 20                 TRA     s:26575
        20 007777   010274 710000 20                 TRA     s:26675
        20 010000   010274 710000 20                 TRA     s:26675
        20 010001   010052 710000 20                 TRA     s:26575
        20 010002   010274 710000 20                 TRA     s:26675
        20 010003   010152 710000 20                 TRA     s:26613
        20 010004   010104 710000 20                 TRA     s:26592
        20 010005   010274 710000 20                 TRA     s:26675
        20 010006   010274 710000 20                 TRA     s:26675
        20 010007   010274 710000 20                 TRA     s:26675
        20 010010   010274 710000 20                 TRA     s:26675
        20 010011   010274 710000 20                 TRA     s:26675
        20 010012   010274 710000 20                 TRA     s:26675
        20 010013   010274 710000 20                 TRA     s:26675
        20 010014   010274 710000 20                 TRA     s:26675
        20 010015   010274 710000 20                 TRA     s:26675
        20 010016   010274 710000 20                 TRA     s:26675
        20 010017   010274 710000 20                 TRA     s:26675
        20 010020   010274 710000 20                 TRA     s:26675
        20 010021   010267 710000 20                 TRA     s:26668
        20 010022   010211 710000 20                 TRA     s:26635
        20 010023   010226 710000 20                 TRA     s:26645
        20 010024   010244 710000 20                 TRA     s:26654
        20 010025   010244 710000 20                 TRA     s:26654
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:398  
        20 010026   010244 710000 20                 TRA     s:26654
        20 010027   010104 710000 20                 TRA     s:26592
        20 010030   010274 710000 20                 TRA     s:26675
        20 010031   010274 710000 20                 TRA     s:26675
        20 010032   010274 710000 20                 TRA     s:26675
        20 010033   010274 710000 20                 TRA     s:26675
        20 010034   010274 710000 20                 TRA     s:26675
        20 010035   010274 710000 20                 TRA     s:26675
        20 010036   010137 710000 20                 TRA     s:26606
        20 010037   010263 710000 20                 TRA     s:26665
        20 010040   010274 710000 20                 TRA     s:26675
        20 010041   010274 710000 20                 TRA     s:26675
        20 010042   010256 710000 20                 TRA     s:26661
        20 010043   010274 710000 20                 TRA     s:26675
        20 010044   010274 710000 20                 TRA     s:26675
        20 010045   010137 710000 20                 TRA     s:26606
        20 010046   010274 710000 20                 TRA     s:26675
        20 010047   010274 710000 20                 TRA     s:26675
        20 010050   010274 710000 20                 TRA     s:26675
        20 010051   010122 710000 20                 TRA     s:26599

     2617    26573
     2618    26574    3       CASE( %SAVE, %CHECK );

     2619    26575    3         IF NOT DISK_SRCHCOND

  26575 20 010052   000000 220000 xsym               LDX0    DISK_SRCHCOND
        20 010053   010056 601000 20                 TNZ     s:26577

     2620    26576    3          THEN DISK_SRCHCOND.ANYF# = '1'B;

  26576 20 010054   000400 236003                    LDQ     256,DU
        20 010055   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     2621    26577    3         IF NOT DISK_OPTION

  26577 20 010056   000000 066400                    CMPB    filb='1'B
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:399  
        20 010057   000000 000221 xsym               BDSC    DISK_OPTION              by=0,bit=0,n=145
        20 010060   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        20 010061   010070 601000 20                 TNZ     s:26583

     2622    26578    4          THEN DO;

     2623    26579    4            DISK_OPTION.PAD = '1'B;

  26579 20 010062   020000 236003                    LDQ     8192,DU
        20 010063   000000 256000 xsym               ORSQ    DISK_OPTION

     2624    26580    4            DISK_OPTION.DIR = '1'B;

  26580 20 010064   400000 236003                    LDQ     -131072,DU
        20 010065   000000 256000 xsym               ORSQ    DISK_OPTION

     2625    26581    4            DISK_OPTION.DELETED_ACCOUNTS = '1'B;

  26581 20 010066   200000 236003                    LDQ     65536,DU
        20 010067   000000 256000 xsym               ORSQ    DISK_OPTION

     2626    26582    4            END;

     2627    26583    3         IF COMMAND = %SAVE

  26583 20 010070   000006 115007                    CMPA    6,DL
        20 010071   010101 601000 20                 TNZ     s:26589

     2628    26584    4          THEN DO;

     2629    26585    4            DISK_OPTION.CLEANUP = '1'B;

  26585 20 010072   100000 236003                    LDQ     32768,DU
        20 010073   000000 256000 xsym               ORSQ    DISK_OPTION

     2630    26586    4            DISK_OPTION.SKIP_NO_BACKUP = '1'B;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:400  
  26586 20 010074   004000 236003                    LDQ     2048,DU
        20 010075   000002 256000 xsym               ORSQ    DISK_OPTION+2

     2631    26587    4            DISK_OPTION.SAVE_DIR = '1'B;

  26587 20 010076   000200 236003                    LDQ     128,DU
        20 010077   000002 256000 xsym               ORSQ    DISK_OPTION+2

     2632    26588    4            END;

  26588 20 010100   010274 710000 20                 TRA     s:26675

     2633    26589    3          ELSE DISK_OPTION.CLEANUP = '0'B;

  26589 20 010101   000125 236000 21                 LDQ     85
        20 010102   000000 356000 xsym               ANSQ    DISK_OPTION
        20 010103   010274 710000 20                 TRA     s:26675

     2634    26590
     2635    26591    3       CASE( %RESTORE, %RETRIEVE );

     2636    26592    3         IF NOT DISK_SRCHCOND

  26592 20 010104   000000 220000 xsym               LDX0    DISK_SRCHCOND
        20 010105   010110 601000 20                 TNZ     s:26594

     2637    26593    3          THEN DISK_SRCHCOND.ANYF# = '1'B;

  26593 20 010106   000400 236003                    LDQ     256,DU
        20 010107   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     2638    26594    3         IF COMMAND = %RESTORE AND TAPE_OPTION.PROTTYPE = 0

  26594 20 010110   000011 115007                    CMPA    9,DL
        20 010111   010274 601000 20                 TNZ     s:26675
        20 010112   000001 236000 xsym               LDQ     TAPE_OPTION+1
        20 010113   700000 316003                    CANQ    -32768,DU
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:401  
        20 010114   010274 601000 20                 TNZ     s:26675
        20 010115   000000 235000 xsym               LDA     DISK_DEST_EXIST
        20 010116   010274 601000 20                 TNZ     s:26675

     2639    26595    3           AND DISK_DEST_EXIST = 0
     2640    26596    3          THEN TAPE_OPTION.PROTTYPE = %INCREMENTAL;

  26596 20 010117   300000 236003                    LDQ     98304,DU
        20 010120   000001 756000 xsym               STQ     TAPE_OPTION+1
        20 010121   010274 710000 20                 TRA     s:26675

     2641    26597
     2642    26598    3       CASE( %REBUILD );

     2643    26599    3         DISK_SRCHCOND.ANYF# = '1'B;

  26599 20 010122   000400 236003                    LDQ     256,DU
        20 010123   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     2644    26600    3         IF TAPE_OPTION.NPAD

  26600 20 010124   000002 236000 xsym               LDQ     TAPE_OPTION+2
        20 010125   020000 316003                    CANQ    8192,DU
        20 010126   010132 600000 20                 TZE     s:26602

     2645    26601    3          THEN DISK_OPTION.PAD = '0'B;

  26601 20 010127   000126 236000 21                 LDQ     86
        20 010130   000000 356000 xsym               ANSQ    DISK_OPTION
        20 010131   010134 710000 20                 TRA     s:26603

     2646    26602    3          ELSE DISK_OPTION.PAD = '1'B;

  26602 20 010132   020000 236003                    LDQ     8192,DU
        20 010133   000000 256000 xsym               ORSQ    DISK_OPTION

     2647    26603    3         DISK_OPTION.DELETED_ACCOUNTS = '1'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:402  

  26603 20 010134   200000 236003                    LDQ     65536,DU
        20 010135   000000 256000 xsym               ORSQ    DISK_OPTION
        20 010136   010274 710000 20                 TRA     s:26675

     2648    26604
     2649    26605    3       CASE( %DUAL, %DUAL_INCREMENTAL );

     2650    26606    3         IF NOT DISK_SRCHCOND

  26606 20 010137   000000 220000 xsym               LDX0    DISK_SRCHCOND
        20 010140   010143 601000 20                 TNZ     s:26608

     2651    26607    3          THEN DISK_SRCHCOND.ANYF# = '1'B;

  26607 20 010141   000400 236003                    LDQ     256,DU
        20 010142   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     2652    26608    3         DISK_OPTION.DIR = '1'B;

  26608 20 010143   400000 236003                    LDQ     -131072,DU
        20 010144   000000 256000 xsym               ORSQ    DISK_OPTION

     2653    26609    3         DISK_OPTION.DELETED_ACCOUNTS = '1'B;

  26609 20 010145   200000 236003                    LDQ     65536,DU
        20 010146   000000 256000 xsym               ORSQ    DISK_OPTION

     2654    26610    3         DISK_OPTION.PAD = '1'B;

  26610 20 010147   020000 236003                    LDQ     8192,DU
        20 010150   000000 256000 xsym               ORSQ    DISK_OPTION
        20 010151   010274 710000 20                 TRA     s:26675

     2655    26611
     2656    26612    3       CASE( %BACKUP );

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:403  
     2657    26613    3         IF NOT DISK_SRCHCOND

  26613 20 010152   000000 220000 xsym               LDX0    DISK_SRCHCOND
        20 010153   010170 601000 20                 TNZ     s:26622

     2658    26614    4          THEN DO;

     2659    26615    4            DISK_SRCHCOND.BUF# = '1'B;

  26615 20 010154   100000 236003                    LDQ     32768,DU
        20 010155   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     2660    26616    4            DISK_SRCHCOND.DELF# = '1'B;

  26616 20 010156   400000 236003                    LDQ     -131072,DU
        20 010157   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     2661    26617    4            DISK_SRCHCOND.ARCHIVE# = '1'B;

  26617 20 010160   001000 236003                    LDQ     512,DU
        20 010161   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     2662    26618    4            FILE_TYPE.DF = '1'B;

  26618 20 010162   004000 236003                    LDQ     2048,DU
        20 010163   000000 256000 xsym               ORSQ    FILE_TYPE

     2663    26619    4            FILE_TYPE.BUF = '1'B;

  26619 20 010164   002000 236003                    LDQ     1024,DU
        20 010165   000000 256000 xsym               ORSQ    FILE_TYPE

     2664    26620    4            FILE_TYPE.I = '1'B;

  26620 20 010166   200000 236003                    LDQ     65536,DU
        20 010167   000000 256000 xsym               ORSQ    FILE_TYPE

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:404  
     2665    26621    4            END;

     2666    26622    3         DISK_OPTION.PAD = '1'B;

  26622 20 010170   020000 236003                    LDQ     8192,DU
        20 010171   000000 256000 xsym               ORSQ    DISK_OPTION

     2667    26623    3         DISK_OPTION.DIR = '1'B;

  26623 20 010172   400000 236003                    LDQ     -131072,DU
        20 010173   000000 256000 xsym               ORSQ    DISK_OPTION

     2668    26624    3         DISK_OPTION.DELETED_ACCOUNTS = '1'B;

  26624 20 010174   200000 236003                    LDQ     65536,DU
        20 010175   000000 256000 xsym               ORSQ    DISK_OPTION

     2669    26625    3         DISK_OPTION.SAVE_DIR = '1'B; /* Save accnt. dir. even though backup of  */

  26625 20 010176   000200 236003                    LDQ     128,DU
        20 010177   000002 256000 xsym               ORSQ    DISK_OPTION+2

     2670    26626                                                /* files not permitted for the accnt. */
     2671    26627    3         DISK_OPTION.SKIP_NO_BACKUP = '1'B;

  26627 20 010200   004000 236003                    LDQ     2048,DU
        20 010201   000002 256000 xsym               ORSQ    DISK_OPTION+2

     2672    26628    3         IF BACKUP_$$EFT

  26628 20 010202   000251 234000 2                  SZN     BACKUP_$$EFT
        20 010203   010274 605000 20                 TPL     s:26675

     2673    26629    4          THEN DO;

     2674    26630    4            DISK_SRCHCOND.BUF# = '0'B;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:405  
  26630 20 010204   000125 236000 21                 LDQ     85
        20 010205   000000 356000 xsym               ANSQ    DISK_SRCHCOND

     2675    26631    4            DISK_SRCHCOND.ANYF# = '1'B;

  26631 20 010206   000400 236003                    LDQ     256,DU
        20 010207   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     2676    26632    4            END;

  26632 20 010210   010274 710000 20                 TRA     s:26675

     2677    26633
     2678    26634    3       CASE( %ARCHIVE_CMD );

     2679    26635    3         IF NOT DISK_SRCHCOND

  26635 20 010211   000000 220000 xsym               LDX0    DISK_SRCHCOND
        20 010212   010215 601000 20                 TNZ     s:26637

     2680    26636    3          THEN DISK_SRCHCOND.QS# = '1'B;

  26636 20 010213   010000 236003                    LDQ     4096,DU
        20 010214   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     2681    26637    3         IF NOT DISK_CRIT.DSC

  26637 20 010215   000000 234000 xsym               SZN     DISK_CRIT
        20 010216   010274 604000 20                 TMI     s:26675

     2682    26638    4          THEN DO;

     2683    26639    4            DISK_DESC_MASK.FETCH# = '1'B;

  26639 20 010217   000010 236003                    LDQ     8,DU
        20 010220   000000 256000 xsym               ORSQ    DISK_DESC_MASK

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:406  
     2684    26640    4            DISK_DESC.FETCH# = '0'B;

  26640 20 010221   000127 236000 21                 LDQ     87
        20 010222   000000 356000 xsym               ANSQ    DISK_DESC

     2685    26641    4            DISK_CRIT.DSC = '1'B;

  26641 20 010223   400000 236003                    LDQ     -131072,DU
        20 010224   000000 256000 xsym               ORSQ    DISK_CRIT

     2686    26642    4            END;

  26642 20 010225   010274 710000 20                 TRA     s:26675

     2687    26643
     2688    26644    3       CASE( %PURGE );

     2689    26645    3         DISK_OPTION.DELETE = '1'B;

  26645 20 010226   040000 236003                    LDQ     16384,DU
        20 010227   000002 256000 xsym               ORSQ    DISK_OPTION+2

     2690    26646    3         DISK_OPTION.SKIP_NO_PURGE = '1'B;

  26646 20 010230   001000 236003                    LDQ     512,DU
        20 010231   000002 256000 xsym               ORSQ    DISK_OPTION+2

     2691    26647    3         IF NOT DISK_CRIT.TIM AND NOT DISK_SRCHCOND

  26647 20 010232   000000 236000 xsym               LDQ     DISK_CRIT
        20 010233   100000 316003                    CANQ    32768,DU
        20 010234   010274 601000 20                 TNZ     s:26675
        20 010235   000000 220000 xsym               LDX0    DISK_SRCHCOND
        20 010236   010274 601000 20                 TNZ     s:26675

     2692    26648    4          THEN DO;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:407  
     2693    26649    4            DISK_CRIT.TIM = '1'B;

  26649 20 010237   100000 236003                    LDQ     32768,DU
        20 010240   000000 256000 xsym               ORSQ    DISK_CRIT

     2694    26650    4            DATE_CRIT.EXPD = '1'B;

  26650 20 010241   000200 236003                    LDQ     128,DU
        20 010242   000000 256000 xsym               ORSQ    DATE_CRIT

     2695    26651    4            END;

  26651 20 010243   010274 710000 20                 TRA     s:26675

     2696    26652
     2697    26653    3       CASE( %REQUALIFY, %REQUALIFY_BACKUP, %REQUALIFY_ARCHIVE );

     2698    26654    3         IF NOT DISK_CRIT.TIM

  26654 20 010244   000000 236000 xsym               LDQ     DISK_CRIT
        20 010245   100000 316003                    CANQ    32768,DU
        20 010246   010274 601000 20                 TNZ     s:26675

     2699    26655    4          THEN DO;

     2700    26656    4            CALL FLI$RPT_ERR( E_NEED_TIME, );

  26656 20 010247   000130 630400 21                 EPPR0   88
        20 010250   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 010251   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 010252   000000 011000                    NOP     0

     2701    26657    4            COMMAND_ERROR = '1'B;

  26657 20 010253   400000 236003                    LDQ     -131072,DU
        20 010254   000000 756000 xsym               STQ     COMMAND_ERROR

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:408  
     2702    26658    4            END;

  26658 20 010255   010274 710000 20                 TRA     s:26675

     2703    26659
     2704    26660    3       CASE ( %OPEN_INPUT );

     2705    26661    3         IF NOT DISK_SRCHCOND

  26661 20 010256   000000 220000 xsym               LDX0    DISK_SRCHCOND
        20 010257   010274 601000 20                 TNZ     s:26675

     2706    26662    3          THEN DISK_SRCHCOND.ANYF# = '1'B;

  26662 20 010260   000400 236003                    LDQ     256,DU
        20 010261   000000 256000 xsym               ORSQ    DISK_SRCHCOND
        20 010262   010274 710000 20                 TRA     s:26675

     2707    26663
     2708    26664    3       CASE( %OPEN_UPDATE );

     2709    26665    3         DISK_OPTION.OPEN_MODE = MODE;

  26665 20 010263   000250 236000 2                  LDQ     MODE
        20 010264   000041 736000                    QLS     33
        20 010265   000003 756000 xsym               STQ     DISK_OPTION+3
        20 010266   010274 710000 20                 TRA     s:26675

     2710    26666
     2711    26667    3       CASE( %UNARCHIVE );

     2712    26668    3         IF NOT DISK_SRCHCOND

  26668 20 010267   000000 220000 xsym               LDX0    DISK_SRCHCOND
        20 010270   010274 601000 20                 TNZ     s:26675

     2713    26669    3          THEN DISK_SRCHCOND.ARCHIVE# = '1'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:409  

  26669 20 010271   001000 236003                    LDQ     512,DU
        20 010272   000000 256000 xsym               ORSQ    DISK_SRCHCOND
        20 010273   010274 710000 20                 TRA     s:26675

     2714    26670
     2715    26671    3       CASE( %STOW_ACTIVE, %STOW_INACTIVE );

     2716    26672
     2717    26673    3       END;

     2718    26674
     2719    26675    2      IF DISK_DEST_EXIST = 0

  26675 20 010274   000000 235000 xsym               LDA     DISK_DEST_EXIST
        20 010275   010300 601000 20                 TNZ     s:26677

     2720    26676    2       THEN DISK_DEST_EXIST = %ERROR#;     /* Supply default                     */

  26676 20 010276   000001 236007                    LDQ     1,DL
        20 010277   000000 756000 xsym               STQ     DISK_DEST_EXIST

     2721    26677    2      IF COMMAND_ERROR THEN ALTRETURN;

  26677 20 010300   000000 234000 xsym               SZN     COMMAND_ERROR
        20 010301   010304 605000 20                 TPL     s:26679

  26677 20 010302   200030 221300                    LDX1  ! DCB#+1,,AUTO
        20 010303   000000 702211                    TSX2  ! 0,X1

     2722    26678
     2723    26679    2      RETURN;

  26679 20 010304   200030 221300                    LDX1  ! DCB#+1,,AUTO
        20 010305   000001 702211                    TSX2  ! 1,X1

  26677 20 010306                       JUSTALT      null
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:410  
     2724    26680
     2725    26681    2   JUSTALT: ;
     2726    26682    2      ALTRETURN;

  26682 20 010306   200030 221300                    LDX1  ! DCB#+1,,AUTO
        20 010307   000000 702211                    TSX2  ! 0,X1

     2727    26683
     2728    26684    2   FLB_CHECK_PACKSET: PROC;

  26684 20 010310   200032 741300       FLB_CHECK_P* STX1  ! FIRST+1,,AUTO

     2729    26685
     2730    26686        /********************/
     2731    26687
     2732    26688    3      CALL M$OPEN( CHECK_PACKSET )

  26688 20 010311   000506 630400 2                  EPPR0   CHECK_PACKSET
        20 010312   450000 713400                    CLIMB   alt,open
        20 010313   410400 401760                    pmme    nvectors=18
        20 010314   010316 702000 20                 TSX2    s:26690
        20 010315   010344 710000 20                 TRA     s:26700

     2733    26689    4       WHENALTRETURN DO;

     2734    26690    4         CODE = B$TCB.ALT$->B$ALT.ERR.CODE;

  26690 20 010316   000000 470400 xsym               LDP0    B$TCB$
        20 010317   000000 471500                    LDP1    0,,PR0
        20 010320   100102 236100                    LDQ     66,,PR1
        20 010321   000003 772000                    QRL     3
        20 010322   037777 376007                    ANQ     16383,DL
        20 010323   000166 756000 2                  STQ     CODE

     2735    26691    4         IF CODE = %E$FDEOF OR CODE = %E$NOKEY OR CODE = %E$ADEOF

  26691 20 010324   000154 116007                    CMPQ    108,DL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:411  
        20 010325   010344 600000 20                 TZE     s:26700
        20 010326   000102 116007                    CMPQ    66,DL
        20 010327   010344 600000 20                 TZE     s:26700
        20 010330   000175 116007                    CMPQ    125,DL
        20 010331   010344 600000 20                 TZE     s:26700

     2736    26692    4          THEN ;
     2737    26693    5          ELSE DO;                         /* Packset not ready                  */

     2738    26694    5            COMMAND_ERROR = '1'B;

  26694 20 010332   400000 236003                    LDQ     -131072,DU
        20 010333   000000 756000 xsym               STQ     COMMAND_ERROR

     2739    26695    5            CALL FLI$RPT_ERR;

  26695 20 010334   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 010335   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 010336   000000 011000                    NOP     0

     2740    26696    5            IF CODE = %E$SETDOWN

  26696 20 010337   000166 235000 2                  LDA     CODE
        20 010340   000220 115007                    CMPA    144,DL
        20 010341   010344 601000 20                 TNZ     s:26700

     2741    26697    5             THEN FPT_EXIT.V.STEPCC# = %OPER_ERROR;

  26697 20 010342   005000 236003                    LDQ     2560,DU
        20 010343   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

     2742    26698    5            END;

     2743    26699    4         END;

     2744    26700    3      RETURN;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:412  
  26700 20 010344   200032 221300                    LDX1  ! FIRST+1,,AUTO
        20 010345   000001 702211                    TSX2  ! 1,X1

     2745    26701
     2746    26702    3   END FLB_CHECK_PACKSET;
     2747    26703
     2748    26704
     2749    26705
     2750    26706    2   FLB_DISK_OPTION_LIST: PROC;

  26706 20 010346   200032 741300       FLB_DISK_OP* STX1  ! FIRST+1,,AUTO

     2751    26707        /*F*  NAME: FLB_DISK_OPTION_LIST
     2752    26708              PURPOSE: Process DISK_OPTION_LIST node.
     2753    26709        ***/
     2754    26710
     2755    26711         /***
     2756    26712          *** STATIC
     2757    26713          ***/
     2758    26714
     2759    26715    3   DCL WHAT_BIT_SHOULD_BE BIT(1) STATIC;
     2760    26716
     2761    26717        /******************************/
     2762    26718
     2763    26719    4      DO SUBSUBNODEX = 0 TO SUBNODE$->OUT$BLK.NSUBLKS - 1;

  26719 20 010347   000234 450000 2                  STZ     SUBSUBNODEX
        20 010350   011071 710000 20                 TRA     s:26908+1

     2764    26720    4         SUBSUBNODE$ = SUBNODE$->OUT$BLK.SUBLK$(SUBSUBNODEX);

  26720 20 010351   000231 470400 2                  LDP0    SUBNODE$
        20 010352   000234 720000 2                  LXL0    SUBSUBNODEX
        20 010353   000003 236110                    LDQ     3,X0,PR0
        20 010354   000233 756000 2                  STQ     SUBSUBNODE$

     2765    26721    5         DO CASE( SUBSUBNODE$->OUT$BLK.CODE );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:413  

  26721 20 010355   000233 471400 2                  LDP1    SUBSUBNODE$
        20 010356   100000 721100                    LXL1    0,,PR1
        20 010357   000042 101003                    CMPX1   34,DU
        20 010360   010362 602011 20                 TNC     s:26721+5,X1
        20 010361   011070 710000 20                 TRA     s:26908
        20 010362   010556 710000 20                 TRA     s:26788
        20 010363   010607 710000 20                 TRA     s:26804
        20 010364   011070 710000 20                 TRA     s:26908
        20 010365   010667 710000 20                 TRA     s:26836
        20 010366   010424 710000 20                 TRA     s:26724
        20 010367   010455 710000 20                 TRA     s:26739
        20 010370   010511 710000 20                 TRA     s:26756
        20 010371   011032 710000 20                 TRA     s:26889
        20 010372   010517 710000 20                 TRA     s:26762
        20 010373   010522 710000 20                 TRA     s:26765
        20 010374   010530 710000 20                 TRA     s:26771
        20 010375   010533 710000 20                 TRA     s:26774
        20 010376   010550 710000 20                 TRA     s:26782
        20 010377   010553 710000 20                 TRA     s:26785
        20 010400   010603 710000 20                 TRA     s:26799
        20 010401   010525 710000 20                 TRA     s:26768
        20 010402   010474 710000 20                 TRA     s:26748
        20 010403   010777 710000 20                 TRA     s:26876
        20 010404   010716 710000 20                 TRA     s:26852
        20 010405   010627 710000 20                 TRA     s:26815
        20 010406   010731 710000 20                 TRA     s:26859
        20 010407   010624 710000 20                 TRA     s:26812
        20 010410   010644 710000 20                 TRA     s:26823
        20 010411   010647 710000 20                 TRA     s:26825
        20 010412   011070 710000 20                 TRA     s:26908
        20 010413   011017 710000 20                 TRA     s:26884
        20 010414   010514 710000 20                 TRA     s:26759
        20 010415   010652 710000 20                 TRA     s:26828
        20 010416   011051 710000 20                 TRA     s:26897
        20 010417   011040 710000 20                 TRA     s:26892
        20 010420   011070 710000 20                 TRA     s:26908
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:414  
        20 010421   010704 710000 20                 TRA     s:26844
        20 010422   010711 710000 20                 TRA     s:26848
        20 010423   011060 710000 20                 TRA     s:26902

     2766    26722
     2767    26723    5          CASE( %ORG );

     2768    26724    5            DISK_CRIT.ORG = '1'B;

  26724 20 010424   200000 236003                    LDQ     65536,DU
        20 010425   000000 256000 xsym               ORSQ    DISK_CRIT

     2769    26725    5            TEMP = SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  26725 20 010426   100003 473500                    LDP3    3,,PR1
        20 010427   300000 236100                    LDQ     0,,PR3
        20 010430   777777 376007                    ANQ     -1,DL
        20 010431   000236 756000 2                  STQ     TEMP

     2770    26726    5            N = DISK_ORGS.NBR;

  26726 20 010432   000000 235000 xsym               LDA     DISK_ORGS
        20 010433   000224 755000 2                  STA     N

     2771    26727    5            DISK_ORGS.ORG(N) = TEMP;

  26727 20 010434   000001 756005 xsym               STQ     DISK_ORGS+1,AL

     2772    26728    5            DISK_ORGS.NBR = N + 1;

  26728 20 010435   000224 235000 2                  LDA     N
        20 010436   000001 035007                    ADLA    1,DL
        20 010437   000000 755000 xsym               STA     DISK_ORGS

     2773    26729    6            DO WHILE( N >= 1 );            /* Get rid of new ORG if duplicate    */

  26729 20 010440   000224 235000 2                  LDA     N
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:415  
        20 010441   011070 604400 20                 TMOZ    s:26908

     2774    26730    6               N = N - 1;

  26730 20 010442   000001 336007                    LCQ     1,DL
        20 010443   000224 056000 2                  ASQ     N

     2775    26731    6               IF DISK_ORGS.ORG(N) = TEMP

  26731 20 010444   000224 720000 2                  LXL0    N
        20 010445   000001 236010 xsym               LDQ     DISK_ORGS+1,X0
        20 010446   000236 116000 2                  CMPQ    TEMP
        20 010447   010452 601000 20                 TNZ     s:26733

     2776    26732    6                THEN DISK_ORGS.NBR = DISK_ORGS.NBR - 1;

  26732 20 010450   000001 336007                    LCQ     1,DL
        20 010451   000000 056000 xsym               ASQ     DISK_ORGS

     2777    26733    6               END;

  26733 20 010452   000224 235000 2                  LDA     N
        20 010453   010442 605400 20                 TPNZ    s:26730
        20 010454   011070 710000 20                 TRA     s:26908

     2778    26734
     2779    26735    5          CASE( %DELF );

     2780    26736                  /* DELF bit is on in DCB for deleted files and inactively archived  */
     2781    26737                            /* files, so it has to be handled twice in order to set   */
     2782    26738                                                /* DISK_SRCHCOND.DELF# right          */
     2783    26739    5            DISK_SRCHCOND.DELF# = '1'B;

  26739 20 010455   400000 236003                    LDQ     -131072,DU
        20 010456   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     2784    26740    5            OPTION_MAP.DELF = '1'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:416  

  26740 20 010457   004000 236003                    LDQ     2048,DU
        20 010460   000253 256000 2                  ORSQ    OPTION_MAP

     2785    26741    6            DO SELECT( COMMAND );

  26741 20 010461   000167 235000 2                  LDA     COMMAND
        20 010462   000027 115007                    CMPA    23,DL
        20 010463   011070 601000 20                 TNZ     s:26908
        20 010464   010465 710000 20                 TRA     s:26743

     2786    26742    6               SELECT( %ARCHIVE_CMD );

     2787    26743    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_DELF, );

  26743 20 010465   000131 630400 21                 EPPR0   89
        20 010466   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 010467   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 010470   000000 011000                    NOP     0

     2788    26744    6               COMMAND_ERROR = '1'B;

  26744 20 010471   400000 236003                    LDQ     -131072,DU
        20 010472   000000 756000 xsym               STQ     COMMAND_ERROR

     2789    26745    6               END;

  26745 20 010473   011070 710000 20                 TRA     s:26908

     2790    26746
     2791    26747    5          CASE(%ANYF);

     2792    26748    5            DISK_SRCHCOND.ANYF# = '1'B;

  26748 20 010474   000400 236003                    LDQ     256,DU
        20 010475   000000 256000 xsym               ORSQ    DISK_SRCHCOND

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:417  
     2793    26749    6            DO SELECT( COMMAND );

  26749 20 010476   000167 235000 2                  LDA     COMMAND
        20 010477   000027 115007                    CMPA    23,DL
        20 010500   011070 601000 20                 TNZ     s:26908
        20 010501   010502 710000 20                 TRA     s:26751

     2794    26750    6               SELECT( %ARCHIVE_CMD );

     2795    26751    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_ANYF, );

  26751 20 010502   000132 630400 21                 EPPR0   90
        20 010503   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 010504   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 010505   000000 011000                    NOP     0

     2796    26752    6               COMMAND_ERROR = '1'B;

  26752 20 010506   400000 236003                    LDQ     -131072,DU
        20 010507   000000 756000 xsym               STQ     COMMAND_ERROR

     2797    26753    6               END;

  26753 20 010510   011070 710000 20                 TRA     s:26908

     2798    26754
     2799    26755    5          CASE( %NOLIST );

     2800    26756    5            DISK_SRCHCOND.NOLIST# = '1'B;

  26756 20 010511   200000 236003                    LDQ     65536,DU
        20 010512   000000 256000 xsym               ORSQ    DISK_SRCHCOND
        20 010513   011070 710000 20                 TRA     s:26908

     2801    26757
     2802    26758    5          CASE( %BUF );

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:418  
     2803    26759    5            DISK_SRCHCOND.BUF# = '1'B;

  26759 20 010514   100000 236003                    LDQ     32768,DU
        20 010515   000000 256000 xsym               ORSQ    DISK_SRCHCOND
        20 010516   011070 710000 20                 TRA     s:26908

     2804    26760
     2805    26761    5          CASE( %BAD );

     2806    26762    5            DISK_SRCHCOND.BAD# = '1'B;

  26762 20 010517   020000 236003                    LDQ     8192,DU
        20 010520   000000 256000 xsym               ORSQ    DISK_SRCHCOND
        20 010521   011070 710000 20                 TRA     s:26908

     2807    26763
     2808    26764    5          CASE( %ARCHIVE );

     2809    26765    5            OPTION_MAP.ARCHIVE = '1'B;

  26765 20 010522   400000 236003                    LDQ     -131072,DU
        20 010523   000253 256000 2                  ORSQ    OPTION_MAP
        20 010524   011070 710000 20                 TRA     s:26908

     2810    26766
     2811    26767    5          CASE( %QUEUED );

     2812    26768    5            OPTION_MAP.QUEUED = '1'B;

  26768 20 010525   200000 236003                    LDQ     65536,DU
        20 010526   000253 256000 2                  ORSQ    OPTION_MAP
        20 010527   011070 710000 20                 TRA     s:26908

     2813    26769
     2814    26770    5          CASE( %QS );

     2815    26771    5            OPTION_MAP.QS = '1'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:419  

  26771 20 010530   100000 236003                    LDQ     32768,DU
        20 010531   000253 256000 2                  ORSQ    OPTION_MAP
        20 010532   011070 710000 20                 TRA     s:26908

     2816    26772
     2817    26773    5          CASE ( %QF );

     2818    26774    5            OPTION_MAP.QF = '1'B;

  26774 20 010533   040000 236003                    LDQ     16384,DU
        20 010534   000253 256000 2                  ORSQ    OPTION_MAP

     2819    26775    6            DO SELECT ( COMMAND );

  26775 20 010535   000167 235000 2                  LDA     COMMAND
        20 010536   000027 115007                    CMPA    23,DL
        20 010537   011070 601000 20                 TNZ     s:26908
        20 010540   010541 710000 20                 TRA     s:26777

     2820    26776    6               SELECT ( %ARCHIVE_CMD );

     2821    26777    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_QF, );

  26777 20 010541   000133 630400 21                 EPPR0   91
        20 010542   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 010543   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 010544   000000 011000                    NOP     0

     2822    26778    6               COMMAND_ERROR = '1'B;

  26778 20 010545   400000 236003                    LDQ     -131072,DU
        20 010546   000000 756000 xsym               STQ     COMMAND_ERROR

     2823    26779    6               END;

  26779 20 010547   011070 710000 20                 TRA     s:26908
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:420  

     2824    26780
     2825    26781    5          CASE( %ACTIVE );

     2826    26782    5            OPTION_MAP.ACTIVE = '1'B;

  26782 20 010550   020000 236003                    LDQ     8192,DU
        20 010551   000253 256000 2                  ORSQ    OPTION_MAP
        20 010552   011070 710000 20                 TRA     s:26908

     2827    26783
     2828    26784    5          CASE ( %INACTIVE );

     2829    26785    5            OPTION_MAP.INACTIVE = '1'B;

  26785 20 010553   010000 236003                    LDQ     4096,DU
        20 010554   000253 256000 2                  ORSQ    OPTION_MAP
        20 010555   011070 710000 20                 TRA     s:26908

     2830    26786
     2831    26787    5          CASE( %EXPIRED );

     2832    26788    5            DISK_CRIT.TIM = '1'B;

  26788 20 010556   100000 236003                    LDQ     32768,DU
        20 010557   000000 256000 xsym               ORSQ    DISK_CRIT

     2833    26789    5            IF SUBSUBNODE$->OUT$BLK.NSUBLKS > 0

  26789 20 010560   100001 222100                    LDX2    1,,PR1
        20 010561   010565 600000 20                 TZE     s:26791

     2834    26790    5             THEN DATE_CRIT.NOT_EXPD = '1'B;

  26790 20 010562   000100 236003                    LDQ     64,DU
        20 010563   000000 256000 xsym               ORSQ    DATE_CRIT
        20 010564   010567 710000 20                 TRA     s:26792
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:421  

     2835    26791    5             ELSE DATE_CRIT.EXPD = '1'B;

  26791 20 010565   000200 236003                    LDQ     128,DU
        20 010566   000000 256000 xsym               ORSQ    DATE_CRIT

     2836    26792    5            IF DATE_CRIT.EXPD AND DATE_CRIT.NOT_EXPD

  26792 20 010567   000000 236000 xsym               LDQ     DATE_CRIT
        20 010570   000200 316003                    CANQ    128,DU
        20 010571   011070 600000 20                 TZE     s:26908
        20 010572   000100 316003                    CANQ    64,DU
        20 010573   011070 600000 20                 TZE     s:26908

     2837    26793    6             THEN DO;

     2838    26794    6               COMMAND_ERROR = '1'B;

  26794 20 010574   400000 236003                    LDQ     -131072,DU
        20 010575   000000 756000 xsym               STQ     COMMAND_ERROR

     2839    26795    6               CALL FLI$RPT_ERR( E_EXPD_NOT_EXPD, );

  26795 20 010576   000134 630400 21                 EPPR0   92
        20 010577   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 010600   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 010601   000000 011000                    NOP     0

     2840    26796    6               END;

  26796 20 010602   011070 710000 20                 TRA     s:26908

     2841    26797
     2842    26798    5          CASE( %DATE_SPEC );

     2843    26799    5            CALL FLB_DATE_SPEC

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:422  
  26799 20 010603   011331 701000 20                 TSX1    FLB_DATE_SPEC
        20 010604   010606 702000 20                 TSX2    s:26801
        20 010605   010606 710000 20                 TRA     s:26801

     2844    26800    6             WHENALTRETURN DO;

     2845    26801    6               END;

  26801 20 010606   011070 710000 20                 TRA     s:26908

     2846    26802
     2847    26803    5          CASE(%DIR);

     2848    26804    5            DISK_OPTION.DIR = '1'B;

  26804 20 010607   400000 236003                    LDQ     -131072,DU
        20 010610   000000 256000 xsym               ORSQ    DISK_OPTION

     2849    26805    6            DO SELECT( COMMAND );

  26805 20 010611   000167 235000 2                  LDA     COMMAND
        20 010612   000027 115007                    CMPA    23,DL
        20 010613   011070 601000 20                 TNZ     s:26908
        20 010614   010615 710000 20                 TRA     s:26807

     2850    26806    6               SELECT( %ARCHIVE_CMD );

     2851    26807    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_DIR, );

  26807 20 010615   000135 630400 21                 EPPR0   93
        20 010616   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 010617   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 010620   000000 011000                    NOP     0

     2852    26808    6               COMMAND_ERROR = '1'B;

  26808 20 010621   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:423  
        20 010622   000000 756000 xsym               STQ     COMMAND_ERROR

     2853    26809    6               END;

  26809 20 010623   011070 710000 20                 TRA     s:26908

     2854    26810
     2855    26811    5          CASE(%LEA);

     2856    26812    5            DISK_OPTION.LEA = '1'B;

  26812 20 010624   040000 236003                    LDQ     16384,DU
        20 010625   000000 256000 xsym               ORSQ    DISK_OPTION
        20 010626   011070 710000 20                 TRA     s:26908

     2857    26813
     2858    26814    5          CASE(%PAD);

     2859    26815    5            DISK_OPTION.PAD = '1'B;

  26815 20 010627   020000 236003                    LDQ     8192,DU
        20 010630   000000 256000 xsym               ORSQ    DISK_OPTION

     2860    26816    6            DO SELECT( COMMAND );

  26816 20 010631   000167 235000 2                  LDA     COMMAND
        20 010632   000027 115007                    CMPA    23,DL
        20 010633   011070 601000 20                 TNZ     s:26908
        20 010634   010635 710000 20                 TRA     s:26818

     2861    26817    6               SELECT( %ARCHIVE_CMD );

     2862    26818    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_PAD, );

  26818 20 010635   000136 630400 21                 EPPR0   94
        20 010636   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 010637   000000 701000 xent               TSX1    FLI$RPT_ERR
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:424  
        20 010640   000000 011000                    NOP     0

     2863    26819    6               COMMAND_ERROR = '1'B;

  26819 20 010641   400000 236003                    LDQ     -131072,DU
        20 010642   000000 756000 xsym               STQ     COMMAND_ERROR

     2864    26820    6               END;

  26820 20 010643   011070 710000 20                 TRA     s:26908

     2865    26821
     2866    26822    5          CASE(%NOUPDATE);

     2867    26823    5            DISK_OPTION.NOUPDATE = '1'B;

  26823 20 010644   001000 236003                    LDQ     512,DU
        20 010645   000000 256000 xsym               ORSQ    DISK_OPTION
        20 010646   011070 710000 20                 TRA     s:26908

     2868    26824    5          CASE(%OVERLAP_WARN);

     2869    26825    5            DISK_OPTION.OVERLAP_WARN = '1'B;

  26825 20 010647   020000 236003                    LDQ     8192,DU
        20 010650   000002 256000 xsym               ORSQ    DISK_OPTION+2
        20 010651   011070 710000 20                 TRA     s:26908

     2870    26826
     2871    26827    5          CASE(%DELETED_ACCOUNTS);

     2872    26828    5            DISK_OPTION.DELETED_ACCOUNTS = '1'B;

  26828 20 010652   200000 236003                    LDQ     65536,DU
        20 010653   000000 256000 xsym               ORSQ    DISK_OPTION

     2873    26829    6            DO SELECT( COMMAND );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:425  

  26829 20 010654   000167 235000 2                  LDA     COMMAND
        20 010655   000027 115007                    CMPA    23,DL
        20 010656   011070 601000 20                 TNZ     s:26908
        20 010657   010660 710000 20                 TRA     s:26831

     2874    26830    6               SELECT( %ARCHIVE_CMD );

     2875    26831    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_DEL_ACC, );

  26831 20 010660   000137 630400 21                 EPPR0   95
        20 010661   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 010662   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 010663   000000 011000                    NOP     0

     2876    26832    6               COMMAND_ERROR = '1'B;

  26832 20 010664   400000 236003                    LDQ     -131072,DU
        20 010665   000000 756000 xsym               STQ     COMMAND_ERROR

     2877    26833    6               END;

  26833 20 010666   011070 710000 20                 TRA     s:26908

     2878    26834
     2879    26835    5          CASE(%CLEANUP);

     2880    26836    5            DISK_OPTION.CLEANUP = '1'B;

  26836 20 010667   100000 236003                    LDQ     32768,DU
        20 010670   000000 256000 xsym               ORSQ    DISK_OPTION

     2881    26837    6            DO SELECT( COMMAND );

  26837 20 010671   000167 235000 2                  LDA     COMMAND
        20 010672   000027 115007                    CMPA    23,DL
        20 010673   011070 601000 20                 TNZ     s:26908
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:426  
        20 010674   010675 710000 20                 TRA     s:26839

     2882    26838    6               SELECT( %ARCHIVE_CMD );

     2883    26839    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_CLEANUP, );

  26839 20 010675   000140 630400 21                 EPPR0   96
        20 010676   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 010677   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 010700   000000 011000                    NOP     0

     2884    26840    6               COMMAND_ERROR = '1'B;

  26840 20 010701   400000 236003                    LDQ     -131072,DU
        20 010702   000000 756000 xsym               STQ     COMMAND_ERROR

     2885    26841    6               END;

  26841 20 010703   011070 710000 20                 TRA     s:26908

     2886    26842
     2887    26843    5          CASE(%TAPE_CHECK);

     2888    26844    5            TAPE_OPTION.CHECK_SPECD = '1'B;

  26844 20 010704   200000 236003                    LDQ     65536,DU
        20 010705   000000 256000 xsym               ORSQ    TAPE_OPTION

     2889    26845    5            TAPE_OPTION.CHECK = '1'B;

  26845 20 010706   400000 236003                    LDQ     -131072,DU
        20 010707   000000 256000 xsym               ORSQ    TAPE_OPTION
        20 010710   011070 710000 20                 TRA     s:26908

     2890    26846
     2891    26847    5          CASE(%TAPE_CHECKN);

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:427  
     2892    26848    5            TAPE_OPTION.CHECK_SPECD = '1'B;

  26848 20 010711   200000 236003                    LDQ     65536,DU
        20 010712   000000 256000 xsym               ORSQ    TAPE_OPTION

     2893    26849    5            TAPE_OPTION.CHECK = '0'B;

  26849 20 010713   000031 236000 xsym               LDQ     B_VECTNIL+25
        20 010714   000000 356000 xsym               ANSQ    TAPE_OPTION
        20 010715   011070 710000 20                 TRA     s:26908

     2894    26850
     2895    26851    5          CASE(%ACUP);

     2896    26852    5            DISK_OPTION.ACUP = '1'B;

  26852 20 010716   004000 236003                    LDQ     2048,DU
        20 010717   000000 256000 xsym               ORSQ    DISK_OPTION

     2897    26853    6            DO SELECT( COMMAND );

  26853 20 010720   000167 235000 2                  LDA     COMMAND
        20 010721   000027 115007                    CMPA    23,DL
        20 010722   011070 601000 20                 TNZ     s:26908
        20 010723   010724 710000 20                 TRA     s:26855

     2898    26854    6               SELECT( %ARCHIVE_CMD );

     2899    26855    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_ACUP, );

  26855 20 010724   000141 630400 21                 EPPR0   97
        20 010725   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 010726   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 010727   000000 011000                    NOP     0

     2900    26856    6               END;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:428  
  26856 20 010730   011070 710000 20                 TRA     s:26908

     2901    26857
     2902    26858    5          CASE(%SCRUB);

     2903    26859    6            DO SUBSUBSUBNODEX=0 TO SUBSUBNODE$->OUT$BLK.NSUBLKS-1;

  26859 20 010731   000235 450000 2                  STZ     SUBSUBSUBNODEX
        20 010732   010757 710000 20                 TRA     s:26868+1

     2904    26860    7               DO CASE( SUBSUBNODE$->OUT$BLK.SUBLK$(SUBSUBSUBNODEX)->OUT$BLK.CODE );

  26860 20 010733   000233 470400 2                  LDP0    SUBSUBNODE$
        20 010734   000235 720000 2                  LXL0    SUBSUBSUBNODEX
        20 010735   000003 471510                    LDP1    3,X0,PR0
        20 010736   100000 721100                    LXL1    0,,PR1
        20 010737   000004 101003                    CMPX1   4,DU
        20 010740   010742 602011 20                 TNC     s:26860+7,X1
        20 010741   010756 710000 20                 TRA     s:26868
        20 010742   010756 710000 20                 TRA     s:26868
        20 010743   010746 710000 20                 TRA     s:26862
        20 010744   010751 710000 20                 TRA     s:26864
        20 010745   010754 710000 20                 TRA     s:26866

     2905    26861    7                CASE( %BCKUP );

     2906    26862    7                  DISK_OPTION.SCRUB.BACKUP = '1'B;

  26862 20 010746   400000 236003                    LDQ     -131072,DU
        20 010747   000002 256000 xsym               ORSQ    DISK_OPTION+2
        20 010750   010756 710000 20                 TRA     s:26868

     2907    26863    7                CASE( %CREATOR );

     2908    26864    7                  DISK_OPTION.SCRUB.CREATOR = '1'B;

  26864 20 010751   200000 236003                    LDQ     65536,DU
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:429  
        20 010752   000002 256000 xsym               ORSQ    DISK_OPTION+2
        20 010753   010756 710000 20                 TRA     s:26868

     2909    26865    7                CASE( %STW );

     2910    26866    7                  DISK_OPTION.SCRUB.STOW = '1'B;

  26866 20 010754   100000 236003                    LDQ     32768,DU
        20 010755   000002 256000 xsym               ORSQ    DISK_OPTION+2

     2911    26867    7                END;

     2912    26868    6               END;

  26868 20 010756   000235 054000 2                  AOS     SUBSUBSUBNODEX
        20 010757   000233 470400 2                  LDP0    SUBSUBNODE$
        20 010760   000001 236100                    LDQ     1,,PR0
        20 010761   000022 772000                    QRL     18
        20 010762   000235 116000 2                  CMPQ    SUBSUBSUBNODEX
        20 010763   010733 605400 20                 TPNZ    s:26860

     2913    26869    6            DO SELECT( COMMAND );

  26869 20 010764   000167 235000 2                  LDA     COMMAND
        20 010765   000027 115007                    CMPA    23,DL
        20 010766   011070 601000 20                 TNZ     s:26908
        20 010767   010770 710000 20                 TRA     s:26871

     2914    26870    6               SELECT( %ARCHIVE_CMD );

     2915    26871    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_SCRUB, );

  26871 20 010770   000142 630400 21                 EPPR0   98
        20 010771   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 010772   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 010773   000000 011000                    NOP     0

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:430  
     2916    26872    6               COMMAND_ERROR = '1'B;

  26872 20 010774   400000 236003                    LDQ     -131072,DU
        20 010775   000000 756000 xsym               STQ     COMMAND_ERROR

     2917    26873    6               END;

  26873 20 010776   011070 710000 20                 TRA     s:26908

     2918    26874
     2919    26875    5          CASE(%IDSS);

     2920    26876    5            DISK_OPTION.IDSS = SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  26876 20 010777   100003 473500                    LDP3    3,,PR1
        20 011000   300000 236100                    LDQ     0,,PR3
        20 011001   777777 376007                    ANQ     -1,DL
        20 011002   000041 736000                    QLS     33
        20 011003   000001 756000 xsym               STQ     DISK_OPTION+1

     2921    26877    6            DO SELECT( COMMAND );

  26877 20 011004   000167 235000 2                  LDA     COMMAND
        20 011005   000027 115007                    CMPA    23,DL
        20 011006   011070 601000 20                 TNZ     s:26908
        20 011007   011010 710000 20                 TRA     s:26879

     2922    26878    6               SELECT( %ARCHIVE_CMD );

     2923    26879    6               CALL FLI$RPT_ERR( E_CANT_SPECIFY_IDS, );

  26879 20 011010   000143 630400 21                 EPPR0   99
        20 011011   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 011012   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 011013   000000 011000                    NOP     0

     2924    26880    6               COMMAND_ERROR = '1'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:431  

  26880 20 011014   400000 236003                    LDQ     -131072,DU
        20 011015   000000 756000 xsym               STQ     COMMAND_ERROR

     2925    26881    6               END;

  26881 20 011016   011070 710000 20                 TRA     s:26908

     2926    26882
     2927    26883    5          CASE(%SWITCH_IF_ERRORS);

     2928    26884    5            DISK_OPTION.SWITCH_IF_ERRORS = '1'B;

  26884 20 011017   010000 236003                    LDQ     4096,DU
        20 011020   000002 256000 xsym               ORSQ    DISK_OPTION+2

     2929    26885    5            CALL CHARBIN ( ERROR_LIMIT, SUBSUBNODE$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.
             26885                     TEXT );

  26885 20 011021   100003 473500                    LDP3    3,,PR1
        20 011022   300004 236100                    LDQ     4,,PR3
        20 011023   000033 772000                    QRL     27
        20 011024   000000 621006                    EAX1    0,QL
        20 011025   000000 305540                    DTB
        20 011026   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
        20 011027   000000 000004 xsym               NDSC9   ERROR_LIMIT              cn=0,s=lsgnf,sf=0,n=4

     2930    26886    5            TOTAL_ERRORS = 0;

  26886 20 011030   000000 450000 xsym               STZ     TOTAL_ERRORS
        20 011031   011070 710000 20                 TRA     s:26908

     2931    26887
     2932    26888    5          CASE(%PROTTYPE);

     2933    26889    5            TAPE_OPTION.PROTTYPE = SUBSUBNODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:432  
  26889 20 011032   100003 473500                    LDP3    3,,PR1
        20 011033   300000 236100                    LDQ     0,,PR3
        20 011034   777777 376007                    ANQ     -1,DL
        20 011035   000041 736000                    QLS     33
        20 011036   000001 756000 xsym               STQ     TAPE_OPTION+1
        20 011037   011070 710000 20                 TRA     s:26908

     2934    26890
     2935    26891    5          CASE(%IOERRORCY);

     2936    26892    5            TAPE_OPTION.IOERRORC = '1'B;

  26892 20 011040   010000 236003                    LDQ     4096,DU
        20 011041   000002 256000 xsym               ORSQ    TAPE_OPTION+2

     2937    26893    5            TAPE_OPTION.IOERRORC_SPECD = '1'B;

  26893 20 011042   004000 236003                    LDQ     2048,DU
        20 011043   000002 256000 xsym               ORSQ    TAPE_OPTION+2

     2938    26894    5            TAPE_OPEN.V.IOERROK# = '1'B;

  26894 20 011044   000060 236000 xsym               LDQ     TAPE_OPEN+48
        20 011045   000036 376000 21                 ANQ     30
        20 011046   002000 276003                    ORQ     1024,DU
        20 011047   000060 756000 xsym               STQ     TAPE_OPEN+48
        20 011050   011070 710000 20                 TRA     s:26908

     2939    26895
     2940    26896    5          CASE(%IOERRORCN);

     2941    26897    5            TAPE_OPTION.IOERRORC = '0'B;

  26897 20 011051   000037 236000 21                 LDQ     31
        20 011052   000002 356000 xsym               ANSQ    TAPE_OPTION+2

     2942    26898    5            TAPE_OPTION.IOERRORC_SPECD = '1'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:433  

  26898 20 011053   004000 236003                    LDQ     2048,DU
        20 011054   000002 256000 xsym               ORSQ    TAPE_OPTION+2

     2943    26899    5            TAPE_OPEN.V.IOERROK# = '0'B;

  26899 20 011055   000036 236000 21                 LDQ     30
        20 011056   000060 356000 xsym               ANSQ    TAPE_OPEN+48
        20 011057   011070 710000 20                 TRA     s:26908

     2944    26900
     2945    26901    5          CASE(%SHARED);

     2946    26902    5            DISK_OPEN_NEXT.V.FUN# = %UPDATE#;

  26902 20 011060   001000 236007                    LDQ     512,DL
        20 011061   000045 552010 xsym               STBQ    DISK_OPEN_NEXT+37,'10'O

     2947    26903    5            DISK_OPEN_NEXT.V.SHARE# = %IN#;

  26903 20 011062   000044 236000 xsym               LDQ     DISK_OPEN_NEXT+36
        20 011063   000107 376000 21                 ANQ     71
        20 011064   000020 276007                    ORQ     16,DL
        20 011065   000044 756000 xsym               STQ     DISK_OPEN_NEXT+36

     2948    26904    5            DISK_OPTION.SHARED = '1'B;

  26904 20 011066   400000 236003                    LDQ     -131072,DU
        20 011067   000004 756000 xsym               STQ     DISK_OPTION+4

     2949    26905
     2950    26906
     2951    26907    5          END;

     2952    26908    4         END;

  26908 20 011070   000234 054000 2                  AOS     SUBSUBNODEX
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:434  
        20 011071   000231 470400 2                  LDP0    SUBNODE$
        20 011072   000001 236100                    LDQ     1,,PR0
        20 011073   000022 772000                    QRL     18
        20 011074   000234 116000 2                  CMPQ    SUBSUBNODEX
        20 011075   010351 605400 20                 TPNZ    s:26720

     2953    26909
     2954    26910    3      DISK_DESC = DISK_DESC & DISK_DESC_MASK;

  26910 20 011076   000000 220000 xsym               LDX0    DISK_DESC
        20 011077   000000 360000 xsym               ANX0    DISK_DESC_MASK
        20 011100   000000 740000 xsym               STX0    DISK_DESC

     2955    26911        /* If any of the following options is specified, SRCHCOND has to be   */
     2956    26912        /* constructed in a special way to eliminate possible search criteria */
     2957    26913        /* conflicts.                                                         */
     2958    26914
     2959    26915    3      IF DISK_SRCHCOND.ANYF#               /* ANYF overrides any other option    */

  26915 20 011101   000000 236000 xsym               LDQ     DISK_SRCHCOND
        20 011102   000400 316003                    CANQ    256,DU
        20 011103   011111 600000 20                 TZE     s:26925

     2960    26916    4       THEN DO;

     2961    26917    4         OPTION_MAP = '0'B;

  26917 20 011104   000253 450000 2                  STZ     OPTION_MAP

     2962    26918    4         FILE_TYPE = '0'B;

  26918 20 011105   000000 221003                    LDX1    0,DU
        20 011106   000000 741000 xsym               STX1    FILE_TYPE

     2963    26919    4         RETURN;

  26919 20 011107   200032 221300                    LDX1  ! FIRST+1,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:435  
        20 011110   000001 702211                    TSX2  ! 1,X1

     2964    26920    4         END;
     2965    26921
     2966    26922        /* Look at OPTION_MAP and translate the combination of these options */
     2967    26923        /* into different FILE_TYPE.                                         */
     2968    26924
     2969    26925    3      IF OPTION_MAP.ARCHIVE

  26925 20 011111   000253 234000 2                  SZN     OPTION_MAP
        20 011112   011134 605000 20                 TPL     s:26935

     2970    26926    3       THEN IF OPTION_MAP.ACTIVE

  26926 20 011113   000253 236000 2                  LDQ     OPTION_MAP
        20 011114   020000 316003                    CANQ    8192,DU
        20 011115   011121 600000 20                 TZE     s:26928

     2971    26927    3          THEN FILE_TYPE.A = '1'B;

  26927 20 011116   400000 236003                    LDQ     -131072,DU
        20 011117   000000 256000 xsym               ORSQ    FILE_TYPE
        20 011120   011134 710000 20                 TRA     s:26935

     2972    26928    3          ELSE IF OPTION_MAP.INACTIVE

  26928 20 011121   010000 316003                    CANQ    4096,DU
        20 011122   011126 600000 20                 TZE     s:26931

     2973    26929    3             THEN FILE_TYPE.I = '1'B;

  26929 20 011123   200000 236003                    LDQ     65536,DU
        20 011124   000000 256000 xsym               ORSQ    FILE_TYPE
        20 011125   011134 710000 20                 TRA     s:26935

     2974    26930    4             ELSE DO;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:436  
     2975    26931    4               FILE_TYPE.A = '1'B;

  26931 20 011126   400000 236003                    LDQ     -131072,DU
        20 011127   000000 256000 xsym               ORSQ    FILE_TYPE

     2976    26932    4               FILE_TYPE.I = '1'B;

  26932 20 011130   200000 236003                    LDQ     65536,DU
        20 011131   000000 256000 xsym               ORSQ    FILE_TYPE

     2977    26933    4               FILE_TYPE.FA = '1'B;

  26933 20 011132   020000 236003                    LDQ     8192,DU
        20 011133   000000 256000 xsym               ORSQ    FILE_TYPE

     2978    26934    4               END;

     2979    26935    3      IF OPTION_MAP.QUEUED

  26935 20 011134   000253 236000 2                  LDQ     OPTION_MAP
        20 011135   200000 316003                    CANQ    65536,DU
        20 011136   011157 600000 20                 TZE     s:26947

     2980    26936    4       THEN DO;

     2981    26937    4         IF OPTION_MAP.ACTIVE

  26937 20 011137   020000 316003                    CANQ    8192,DU
        20 011140   011144 600000 20                 TZE     s:26939

     2982    26938    4          THEN FILE_TYPE.SA = '1'B;

  26938 20 011141   100000 236003                    LDQ     32768,DU
        20 011142   000000 256000 xsym               ORSQ    FILE_TYPE
        20 011143   011155 710000 20                 TRA     s:26945

     2983    26939    4          ELSE IF OPTION_MAP.INACTIVE
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:437  

  26939 20 011144   010000 316003                    CANQ    4096,DU
        20 011145   011151 600000 20                 TZE     s:26942

     2984    26940    4             THEN FILE_TYPE.SI = '1'B;

  26940 20 011146   040000 236003                    LDQ     16384,DU
        20 011147   000000 256000 xsym               ORSQ    FILE_TYPE
        20 011150   011155 710000 20                 TRA     s:26945

     2985    26941    5             ELSE DO;

     2986    26942    5               FILE_TYPE.SA = '1'B;

  26942 20 011151   100000 236003                    LDQ     32768,DU
        20 011152   000000 256000 xsym               ORSQ    FILE_TYPE

     2987    26943    5               FILE_TYPE.SI = '1'B;

  26943 20 011153   040000 236003                    LDQ     16384,DU
        20 011154   000000 256000 xsym               ORSQ    FILE_TYPE

     2988    26944    5               END;

     2989    26945    4         FILE_TYPE.FA = '1'B;

  26945 20 011155   020000 236003                    LDQ     8192,DU
        20 011156   000000 256000 xsym               ORSQ    FILE_TYPE

     2990    26946    4         END;

     2991    26947    3      IF OPTION_MAP.QS

  26947 20 011157   000253 236000 2                  LDQ     OPTION_MAP
        20 011160   100000 316003                    CANQ    32768,DU
        20 011161   011166 600000 20                 TZE     s:26952

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:438  
     2992    26948    4       THEN DO;

     2993    26949    4         FILE_TYPE.SA = '1'B;

  26949 20 011162   100000 236003                    LDQ     32768,DU
        20 011163   000000 256000 xsym               ORSQ    FILE_TYPE

     2994    26950    4         FILE_TYPE.SI = '1'B;

  26950 20 011164   040000 236003                    LDQ     16384,DU
        20 011165   000000 256000 xsym               ORSQ    FILE_TYPE

     2995    26951    4         END;

     2996    26952    3      IF OPTION_MAP.QF

  26952 20 011166   000253 236000 2                  LDQ     OPTION_MAP
        20 011167   040000 316003                    CANQ    16384,DU
        20 011170   011173 600000 20                 TZE     s:26954

     2997    26953    3       THEN FILE_TYPE.FA = '1'B;

  26953 20 011171   020000 236003                    LDQ     8192,DU
        20 011172   000000 256000 xsym               ORSQ    FILE_TYPE

     2998    26954    3      IF OPTION_MAP.ACTIVE

  26954 20 011173   000253 236000 2                  LDQ     OPTION_MAP
        20 011174   020000 316003                    CANQ    8192,DU
        20 011175   011213 600000 20                 TZE     s:26964

     2999    26955    3       THEN IF OPTION_MAP.ARCHIVE

  26955 20 011176   000253 234000 2                  SZN     OPTION_MAP
        20 011177   011203 605000 20                 TPL     s:26958

     3000    26956    3          THEN FILE_TYPE.A = '1'B;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:439  

  26956 20 011200   400000 236003                    LDQ     -131072,DU
        20 011201   000000 256000 xsym               ORSQ    FILE_TYPE
        20 011202   011213 710000 20                 TRA     s:26964

     3001    26957    4          ELSE DO;

     3002    26958    4            IF NOT OPTION_MAP.QUEUED AND NOT OPTION_MAP.QF

  26958 20 011203   200000 316003                    CANQ    65536,DU
        20 011204   011213 601000 20                 TNZ     s:26964
        20 011205   040000 316003                    CANQ    16384,DU
        20 011206   011213 601000 20                 TNZ     s:26964

     3003    26959    5             THEN DO;

     3004    26960    5               FILE_TYPE.SA = '1'B;

  26960 20 011207   100000 236003                    LDQ     32768,DU
        20 011210   000000 256000 xsym               ORSQ    FILE_TYPE

     3005    26961    5               FILE_TYPE.A = '1'B;

  26961 20 011211   400000 236003                    LDQ     -131072,DU
        20 011212   000000 256000 xsym               ORSQ    FILE_TYPE

     3006    26962    5               END;

     3007    26963    4            END;

     3008    26964    3      IF OPTION_MAP.INACTIVE

  26964 20 011213   000253 236000 2                  LDQ     OPTION_MAP
        20 011214   010000 316003                    CANQ    4096,DU
        20 011215   011233 600000 20                 TZE     s:26974

     3009    26965    3       THEN IF OPTION_MAP.ARCHIVE
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:440  

  26965 20 011216   000253 234000 2                  SZN     OPTION_MAP
        20 011217   011223 605000 20                 TPL     s:26968

     3010    26966    3          THEN FILE_TYPE.I = '1'B;

  26966 20 011220   200000 236003                    LDQ     65536,DU
        20 011221   000000 256000 xsym               ORSQ    FILE_TYPE
        20 011222   011233 710000 20                 TRA     s:26974

     3011    26967    4          ELSE DO;

     3012    26968    4            IF NOT OPTION_MAP.QUEUED AND NOT OPTION_MAP.QF

  26968 20 011223   200000 316003                    CANQ    65536,DU
        20 011224   011233 601000 20                 TNZ     s:26974
        20 011225   040000 316003                    CANQ    16384,DU
        20 011226   011233 601000 20                 TNZ     s:26974

     3013    26969    5             THEN DO;

     3014    26970    5               FILE_TYPE.SI = '1'B;

  26970 20 011227   040000 236003                    LDQ     16384,DU
        20 011230   000000 256000 xsym               ORSQ    FILE_TYPE

     3015    26971    5               FILE_TYPE.I = '1'B;

  26971 20 011231   200000 236003                    LDQ     65536,DU
        20 011232   000000 256000 xsym               ORSQ    FILE_TYPE

     3016    26972    5               END;

     3017    26973    4            END;

     3018    26974    3      IF OPTION_MAP.DELF

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:441  
  26974 20 011233   000253 236000 2                  LDQ     OPTION_MAP
        20 011234   004000 316003                    CANQ    2048,DU
        20 011235   011240 600000 20                 TZE     s:26982

     3019    26975    3       THEN FILE_TYPE.DF = '1'B;

  26975 20 011236   004000 236003                    LDQ     2048,DU
        20 011237   000000 256000 xsym               ORSQ    FILE_TYPE

     3020    26976
     3021    26977        /* Basically, these different file types involves the same set of DESC  */
     3022    26978        /* bits.  In order to construct an optimum DISK_SRCHCOND setting, we    */
     3023    26979        /* have to look at 3 of these bits and dicide which can be set as       */
     3024    26980        /* the M$OPEN search criteria                                           */
     3025    26981
     3026    26982    3      IF FILE_TYPE.A

  26982 20 011240   000000 234000 xsym               SZN     FILE_TYPE
        20 011241   011250 605000 20                 TPL     s:26987

     3027    26983    4       THEN DO;

     3028    26984    4         SRCH_BIT = SRCH_BIT & '001'B;

  26984 20 011242   000254 236000 2                  LDQ     SRCH_BIT
        20 011243   700000 376003                    ANQ     -32768,DU
        20 011244   100000 376003                    ANQ     32768,DU
        20 011245   000254 756000 2                  STQ     SRCH_BIT

     3029    26985    4         CHECK_SRCH_BIT = '1'B;

  26985 20 011246   400000 236003                    LDQ     -131072,DU
        20 011247   200003 756100                    STQ     CHECK_SRCH_BIT,,AUTO

     3030    26986    4         END;

     3031    26987    3      IF FILE_TYPE.I
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:442  

  26987 20 011250   000000 236000 xsym               LDQ     FILE_TYPE
        20 011251   200000 316003                    CANQ    65536,DU
        20 011252   011261 600000 20                 TZE     s:26992

     3032    26988    4       THEN DO;

     3033    26989    4         SRCH_BIT = SRCH_BIT & '101'B;

  26989 20 011253   000254 236000 2                  LDQ     SRCH_BIT
        20 011254   700000 376003                    ANQ     -32768,DU
        20 011255   500000 376003                    ANQ     -98304,DU
        20 011256   000254 756000 2                  STQ     SRCH_BIT

     3034    26990    4         CHECK_SRCH_BIT = '1'B;

  26990 20 011257   400000 236003                    LDQ     -131072,DU
        20 011260   200003 756100                    STQ     CHECK_SRCH_BIT,,AUTO

     3035    26991    4         END;

     3036    26992    3      IF FILE_TYPE.SA OR FILE_TYPE.SI OR FILE_TYPE.FA

  26992 20 011261   000000 236000 xsym               LDQ     FILE_TYPE
        20 011262   100000 316003                    CANQ    32768,DU
        20 011263   011270 601000 20                 TNZ     s:26994
        20 011264   040000 316003                    CANQ    16384,DU
        20 011265   011270 601000 20                 TNZ     s:26994
        20 011266   020000 316003                    CANQ    8192,DU
        20 011267   011307 600000 20                 TZE     s:27000

     3037    26993    4       THEN DO;

     3038    26994    4         IF NOT FILE_TYPE.A AND NOT FILE_TYPE.I /* Searching for queued files only? */

  26994 20 011270   000000 234000 xsym               SZN     FILE_TYPE
        20 011271   011301 604000 20                 TMI     s:26996
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:443  
        20 011272   200000 316003                    CANQ    65536,DU
        20 011273   011301 601000 20                 TNZ     s:26996

     3039    26995    4          THEN SRCH_BIT = SRCH_BIT & '010'B;

  26995 20 011274   000254 236000 2                  LDQ     SRCH_BIT
        20 011275   700000 376003                    ANQ     -32768,DU
        20 011276   200000 376003                    ANQ     65536,DU
        20 011277   000254 756000 2                  STQ     SRCH_BIT
        20 011300   011305 710000 20                 TRA     s:26997

     3040    26996    4          ELSE SRCH_BIT = SRCH_BIT & '011'B;

  26996 20 011301   000254 236000 2                  LDQ     SRCH_BIT
        20 011302   700000 376003                    ANQ     -32768,DU
        20 011303   300000 376003                    ANQ     98304,DU
        20 011304   000254 756000 2                  STQ     SRCH_BIT

     3041    26997    4         CHECK_SRCH_BIT = '1'B;

  26997 20 011305   400000 236003                    LDQ     -131072,DU
        20 011306   200003 756100                    STQ     CHECK_SRCH_BIT,,AUTO

     3042    26998    4         END;

     3043    26999
     3044    27000    3      IF CHECK_SRCH_BIT

  27000 20 011307   200003 234100                    SZN     CHECK_SRCH_BIT,,AUTO
        20 011310   011327 605000 20                 TPL     s:27007

     3045    27001    4       THEN DO;

     3046    27002    4         IF SRCH_BIT.DELF THEN DISK_SRCHCOND.DELF# = '1'B;

  27002 20 011311   000254 234000 2                  SZN     SRCH_BIT
        20 011312   011315 605000 20                 TPL     s:27003
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:444  

  27002 20 011313   400000 236003                    LDQ     -131072,DU
        20 011314   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     3047    27003    4         IF SRCH_BIT.QS THEN DISK_SRCHCOND.QS# = '1'B;

  27003 20 011315   000254 236000 2                  LDQ     SRCH_BIT
        20 011316   200000 316003                    CANQ    65536,DU
        20 011317   011322 600000 20                 TZE     s:27004

  27003 20 011320   010000 236003                    LDQ     4096,DU
        20 011321   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     3048    27004    4         IF SRCH_BIT.ARCHIVE THEN DISK_SRCHCOND.ARCHIVE# = '1'B;

  27004 20 011322   000254 236000 2                  LDQ     SRCH_BIT
        20 011323   100000 316003                    CANQ    32768,DU
        20 011324   011327 600000 20                 TZE     s:27007

  27004 20 011325   001000 236003                    LDQ     512,DU
        20 011326   000000 256000 xsym               ORSQ    DISK_SRCHCOND

     3049    27005    4         END;

     3050    27006
     3051    27007    3      RETURN;

  27007 20 011327   200032 221300                    LDX1  ! FIRST+1,,AUTO
        20 011330   000001 702211                    TSX2  ! 1,X1

     3052    27008
     3053    27009    3   FLB_DATE_SPEC: PROC ALTRET;

  27009 20 011331   200034 741300       FLB_DATE_SP* STX1  ! DISK_OPTION_PAD_SAVE+1,,AUTO

     3054    27010        /*F*  NAME: FLB_DATE_SPEC
     3055    27011              PURPOSE: Process DATE_SPEC node.
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:445  
     3056    27012        ***/
     3057    27013
     3058    27014        /***
     3059    27015         *** STATIC
     3060    27016         ***/
     3061    27017
     3062    27018    4   DCL DATE_NODE$ PTR STATIC;
     3063    27019    4   DCL DATEX SBIN STATIC;
     3064    27020    4   DCL DECNODEX SBIN STATIC;
     3065    27021    4   DCL DATENODEX SBIN STATIC;
     3066    27022    4   DCL TIMENODE$ PTR STATIC;
     3067    27023    4   DCL TIME_SPECIFIED BIT(1) STATIC;
     3068    27024    4   DCL TIMEX SBIN STATIC;
     3069    27025    4   DCL DECIMAL$ PTR STATIC;
     3070    27026    4   DCL N_O_T SBIN STATIC;
     3071    27027    4   DCL NOT_SPECIFIED BIT(1) STATIC;
     3072    27028    4   DCL WHAT_DATE SBIN STATIC;
     3073    27029    4   DCL DATE_TYPE SBIN STATIC;
     3074    27030    4   DCL USE_ANSDATE BIT(1) STATIC;
     3075    27031
     3076    27032    4   DCL AFT BIT(1) STATIC;
     3077    27033    4   DCL BEF BIT(1) STATIC;
     3078    27034    4   DCL AFT_DELTA SBIN STATIC;
     3079    27035    4   DCL BEF_DELTA SBIN STATIC;
     3080    27036    4   DCL DISK_AND BIT(1) STATIC;
     3081    27037
     3082    27038        /***
     3083    27039         *** CONSTANT
     3084    27040         ***/
     3085    27041
     3086    27042    4   DCL 1 DATE_INFO(0:%MAX_DATE_TYPE) CONSTANT,
     3087    27043    4         2 HHMMSSSS CHAR(8) INIT(
     3088    27044    4                   '00000000', '23595999', '00000000', '00000000' ),
     3089    27045    4         2 POSITIVE,
     3090    27046    4           3 AFT BIT(1) INIT( '0'B, '1'B, '1'B, '1'B ),
     3091    27047    4           3 BEF BIT(1) INIT( '1'B, '0'B, '1'B, '0'B ),
     3092    27048    4           3 DISK_AND BIT(1) INIT( '1'B, '1'B, '1'B, '1'B ),
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:446  
     3093    27049    4           3 AFT_DELTA SBIN INIT( 0, 1, 0, 0 ),
     3094    27050    4           3 BEF_DELTA SBIN INIT( -1, 0, 8639999, 0 ),
     3095    27051    4         2 NEGATIVE,
     3096    27052    4           3 AFT BIT(1) INIT( '1'B, '0'B, '1'B, '0'B ),
     3097    27053    4           3 BEF BIT(1) INIT( '0'B, '1'B, '1'B, '1'B ),
     3098    27054    4           3 DISK_AND BIT(1) INIT( '1'B, '1'B, '0'B, '1'B ),
     3099    27055    4           3 AFT_DELTA SBIN INIT( 0, 0, 8640000, 0 ),
     3100    27056    4           3 BEF_DELTA SBIN INIT( 0, 0, -1, -1 );
     3101    27057
     3102    27058        /****************************************/
     3103    27059
     3104    27060        /***
     3105    27061         *** Initialize.
     3106    27062         ***/
     3107    27063
     3108    27064    4      WHAT_DATE = %MODIFIED;

  27064 20 011332   000001 235007                    LDA     1,DL
        20 011333   002315 755000 2                  STA     WHAT_DATE

     3109    27065    4      DATE_TYPE = %SINCE;

  27065 20 011334   000003 236007                    LDQ     3,DL
        20 011335   002316 756000 2                  STQ     DATE_TYPE

     3110    27066    4      TIME_SPECIFIED = '0'B;

  27066 20 011336   002310 450000 2                  STZ     TIME_SPECIFIED

     3111    27067    4      NOT_SPECIFIED = '0'B;

  27067 20 011337   002314 450000 2                  STZ     NOT_SPECIFIED

     3112    27068    4      USE_ANSDATE = '0'B;

  27068 20 011340   002317 450000 2                  STZ     USE_ANSDATE

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:447  
     3113    27069    4      DISK_AND = '1'B;

  27069 20 011341   400000 236003                    LDQ     -131072,DU
        20 011342   002324 756000 2                  STQ     DISK_AND

     3114    27070    4      DISK_CRIT.TIM = '1'B;

  27070 20 011343   100000 236003                    LDQ     32768,DU
        20 011344   000000 256000 xsym               ORSQ    DISK_CRIT

     3115    27071
     3116    27072    5      DO DATENODEX = 0 TO SUBSUBNODE$->OUT$BLK.NSUBLKS - 1;

  27072 20 011345   002306 450000 2                  STZ     DATENODEX
        20 011346   011570 710000 20                 TRA     s:27129+1

     3117    27073    5         DATE_NODE$ = SUBSUBNODE$->OUT$BLK.SUBLK$(DATENODEX);

  27073 20 011347   000233 470400 2                  LDP0    SUBSUBNODE$
        20 011350   002306 720000 2                  LXL0    DATENODEX
        20 011351   000003 236110                    LDQ     3,X0,PR0
        20 011352   002303 756000 2                  STQ     DATE_NODE$

     3118    27074    6         DO CASE( DATE_NODE$->OUT$BLK.CODE );

  27074 20 011353   002303 471400 2                  LDP1    DATE_NODE$
        20 011354   100000 721100                    LXL1    0,,PR1
        20 011355   000005 101003                    CMPX1   5,DU
        20 011356   011360 602011 20                 TNC     s:27074+5,X1
        20 011357   011567 710000 20                 TRA     s:27129
        20 011360   011365 710000 20                 TRA     s:27077
        20 011361   011370 710000 20                 TRA     s:27080
        20 011362   011375 710000 20                 TRA     s:27083
        20 011363   011402 710000 20                 TRA     s:27086
        20 011364   011432 710000 20                 TRA     s:27091

     3119    27075
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:448  
     3120    27076    6          CASE( %N_O_T );

     3121    27077    6            NOT_SPECIFIED = '1'B;

  27077 20 011365   400000 236003                    LDQ     -131072,DU
        20 011366   002314 756000 2                  STQ     NOT_SPECIFIED
        20 011367   011567 710000 20                 TRA     s:27129

     3122    27078
     3123    27079    6          CASE( %WHAT_DATE );

     3124    27080    6            WHAT_DATE = DATE_NODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  27080 20 011370   100003 473500                    LDP3    3,,PR1
        20 011371   300000 236100                    LDQ     0,,PR3
        20 011372   777777 376007                    ANQ     -1,DL
        20 011373   002315 756000 2                  STQ     WHAT_DATE
        20 011374   011567 710000 20                 TRA     s:27129

     3125    27081
     3126    27082    6          CASE( %DATE_TYPE );

     3127    27083    6            DATE_TYPE = DATE_NODE$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  27083 20 011375   100003 473500                    LDP3    3,,PR1
        20 011376   300000 236100                    LDQ     0,,PR3
        20 011377   777777 376007                    ANQ     -1,DL
        20 011400   002316 756000 2                  STQ     DATE_TYPE
        20 011401   011567 710000 20                 TRA     s:27129

     3128    27084
     3129    27085    6          CASE( %DELTA );

     3130    27086    6            TIME_SPECIFIED = '1'B;

  27086 20 011402   400000 236003                    LDQ     -131072,DU
        20 011403   002310 756000 2                  STQ     TIME_SPECIFIED
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:449  

     3131    27087    6            CALL CHARBIN( TEMP, DATE_NODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT );

  27087 20 011404   100003 473500                    LDP3    3,,PR1
        20 011405   300004 236100                    LDQ     4,,PR3
        20 011406   000033 772000                    QRL     27
        20 011407   000000 622006                    EAX2    0,QL
        20 011410   000000 305540                    DTB
        20 011411   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
        20 011412   000236 000004 2                  NDSC9   TEMP                     cn=0,s=lsgnf,sf=0,n=4

     3132    27088    6            CALL XUD$UTS_ADJUST(DATEUTS,NOW_UTS,-(%UTS_CSEC_HOUR#*TEMP));

  27088 20 011413   000000 236003                    LDQ     0,DU
        20 011414   000236 136000 2                  SBLQ    TEMP
        20 011415   000144 402000 21                 MPY     100
        20 011416   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 011417   200042 633500                    EPPR3   @MAX_NX+1,,AUTO
        20 011420   200045 453500                    STP3    @MAX_NX+4,,AUTO
        20 011421   000145 236000 21                 LDQ     101
        20 011422   200044 756100                    STQ     @MAX_NX+3,,AUTO
        20 011423   000146 236000 21                 LDQ     102
        20 011424   200043 756100                    STQ     @MAX_NX+2,,AUTO
        20 011425   200043 630500                    EPPR0   @MAX_NX+2,,AUTO
        20 011426   000021 631400 xsym               EPPR1   B_VECTNIL+17
        20 011427   000000 701000 xent               TSX1    XUD$UTS_ADJUST
        20 011430   000000 011000                    NOP     0
        20 011431   011567 710000 20                 TRA     s:27129

     3133    27089
     3134    27090    6          CASE( %DATE_N_TIME );

     3135    27091    6            USE_ANSDATE = '1'B;

  27091 20 011432   400000 236003                    LDQ     -131072,DU
        20 011433   002317 756000 2                  STQ     USE_ANSDATE

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:450  
     3136    27092    6            DATEUTS = NOW_UTS;

  27092 20 011434   000000 235000 xsym               LDA     NOW_UTS
        20 011435   000171 755000 2                  STA     DATEUTS

     3137    27093    6            CALL M$TIME( GET_ANSDATE_DATEUTS );

  27093 20 011436   000640 630400 2                  EPPR0   GET_ANSDATE_DATEUTS
        20 011437   020004 713400                    CLIMB   8196
        20 011440   402000 401760                    pmme    nvectors=5

     3138    27094    6            DATEX = 0;

  27094 20 011441   002304 450000 2                  STZ     DATEX

     3139    27095    7            DO DECNODEX = 0 TO DATE_NODE$->OUT$BLK.NSUBLKS - 1;

  27095 20 011442   002305 450000 2                  STZ     DECNODEX
        20 011443   011562 710000 20                 TRA     s:27127+1

     3140    27096    7               DECIMAL$ = DATE_NODE$->OUT$BLK.SUBLK$(DECNODEX);

  27096 20 011444   002303 470400 2                  LDP0    DATE_NODE$
        20 011445   002305 720000 2                  LXL0    DECNODEX
        20 011446   000003 236110                    LDQ     3,X0,PR0
        20 011447   002312 756000 2                  STQ     DECIMAL$

     3141    27097    7               IF DECIMAL$->OUT$BLK.CODE = %T_I_M_E

  27097 20 011450   002312 471400 2                  LDP1    DECIMAL$
        20 011451   100000 721100                    LXL1    0,,PR1
        20 011452   000001 101003                    CMPX1   1,DU
        20 011453   011533 601000 20                 TNZ     s:27117

     3142    27098    8                THEN DO;

     3143    27099    8                  ANSDATEPIECE.HHMMSSSS = '00000000';
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:451  

  27099 20 011454   040000 100400                    MLR     fill='040'O
        20 011455   000225 000010 19                 ADSC9   LEGAL_CHAR+103           cn=0,n=8
        20 011456   000173 400010 2                  ADSC9   ANSDATE+1                cn=2,n=8

     3144    27100    8                  TIME_SPECIFIED = '1'B;

  27100 20 011457   400000 236003                    LDQ     -131072,DU
        20 011460   002310 756000 2                  STQ     TIME_SPECIFIED

     3145    27101    8                  TIMENODE$ = DECIMAL$;

  27101 20 011461   002312 236000 2                  LDQ     DECIMAL$
        20 011462   002307 756000 2                  STQ     TIMENODE$

     3146    27102    9                  DO TIMEX=0 TO TIMENODE$->OUT$BLK.NSUBLKS-1;

  27102 20 011463   002311 450000 2                  STZ     TIMEX
        20 011464   011525 710000 20                 TRA     s:27114+1

     3147    27103    9                     DECIMAL$ = TIMENODE$->OUT$BLK.SUBLK$(TIMEX);

  27103 20 011465   002307 470400 2                  LDP0    TIMENODE$
        20 011466   002311 720000 2                  LXL0    TIMEX
        20 011467   000003 236110                    LDQ     3,X0,PR0
        20 011470   002312 756000 2                  STQ     DECIMAL$

     3148    27104   10                     DO CASE(TIMEX);

  27104 20 011471   002311 235000 2                  LDA     TIMEX
        20 011472   000004 115007                    CMPA    4,DL
        20 011473   011475 602005 20                 TNC     s:27104+4,AL
        20 011474   011524 710000 20                 TRA     s:27114
        20 011475   011501 710000 20                 TRA     s:27106
        20 011476   011506 710000 20                 TRA     s:27108
        20 011477   011513 710000 20                 TRA     s:27110
        20 011500   011520 710000 20                 TRA     s:27112
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:452  

     3149    27105   10                      CASE(0);

     3150    27106   10                        CALL FLB_SETDATE( ANSDATE.HOUR );

  27106 20 011501   000147 236000 21                 LDQ     103
        20 011502   200037 756100                    STQ     ARS+1,,AUTO
        20 011503   012111 701000 20                 TSX1    FLB_SETDATE
        20 011504   000000 011000                    NOP     0
        20 011505   011524 710000 20                 TRA     s:27114

     3151    27107   10                      CASE(1);

     3152    27108   10                        CALL FLB_SETDATE( ANSDATE.MINUTE );

  27108 20 011506   000150 236000 21                 LDQ     104
        20 011507   200037 756100                    STQ     ARS+1,,AUTO
        20 011510   012111 701000 20                 TSX1    FLB_SETDATE
        20 011511   000000 011000                    NOP     0
        20 011512   011524 710000 20                 TRA     s:27114

     3153    27109   10                      CASE(2);

     3154    27110   10                        CALL FLB_SETDATE( ANSDATE.SECOND );

  27110 20 011513   000151 236000 21                 LDQ     105
        20 011514   200037 756100                    STQ     ARS+1,,AUTO
        20 011515   012111 701000 20                 TSX1    FLB_SETDATE
        20 011516   000000 011000                    NOP     0
        20 011517   011524 710000 20                 TRA     s:27114

     3155    27111   10                      CASE(3);

     3156    27112   10                        CALL FLB_SETDATE( ANSDATE.SEC100THS );

  27112 20 011520   000152 236000 21                 LDQ     106
        20 011521   200037 756100                    STQ     ARS+1,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:453  
        20 011522   012111 701000 20                 TSX1    FLB_SETDATE
        20 011523   000000 011000                    NOP     0

     3157    27113   10                      END;

     3158    27114    9                     END;

  27114 20 011524   002311 054000 2                  AOS     TIMEX
        20 011525   002307 470400 2                  LDP0    TIMENODE$
        20 011526   000001 236100                    LDQ     1,,PR0
        20 011527   000022 772000                    QRL     18
        20 011530   002311 116000 2                  CMPQ    TIMEX
        20 011531   011465 605400 20                 TPNZ    s:27103

     3159    27115    8                  END;

  27115 20 011532   011561 710000 20                 TRA     s:27127

     3160    27116    8                ELSE DO;

     3161    27117    9                  DO CASE( DATEX );

  27117 20 011533   002304 235000 2                  LDA     DATEX
        20 011534   000003 115007                    CMPA    3,DL
        20 011535   011537 602005 20                 TNC     s:27117+4,AL
        20 011536   011560 710000 20                 TRA     s:27125
        20 011537   011542 710000 20                 TRA     s:27119
        20 011540   011547 710000 20                 TRA     s:27121
        20 011541   011554 710000 20                 TRA     s:27123

     3162    27118    9                   CASE(0);

     3163    27119    9                     CALL FLB_SETDATE( ANSDATE.MONTH );

  27119 20 011542   000153 236000 21                 LDQ     107
        20 011543   200037 756100                    STQ     ARS+1,,AUTO
        20 011544   012111 701000 20                 TSX1    FLB_SETDATE
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:454  
        20 011545   000000 011000                    NOP     0
        20 011546   011560 710000 20                 TRA     s:27125

     3164    27120    9                   CASE(1);

     3165    27121    9                     CALL FLB_SETDATE( ANSDATE.DAY );

  27121 20 011547   000154 236000 21                 LDQ     108
        20 011550   200037 756100                    STQ     ARS+1,,AUTO
        20 011551   012111 701000 20                 TSX1    FLB_SETDATE
        20 011552   000000 011000                    NOP     0
        20 011553   011560 710000 20                 TRA     s:27125

     3166    27122    9                   CASE(2);

     3167    27123    9                     CALL FLB_SETDATE( ANSDATE.YEAR );

  27123 20 011554   000155 236000 21                 LDQ     109
        20 011555   200037 756100                    STQ     ARS+1,,AUTO
        20 011556   012111 701000 20                 TSX1    FLB_SETDATE
        20 011557   000000 011000                    NOP     0

     3168    27124    9                   END;

     3169    27125    8                  DATEX = DATEX + 1;

  27125 20 011560   002304 054000 2                  AOS     DATEX

     3170    27126    8                  END;

     3171    27127    7               END;

  27127 20 011561   002305 054000 2                  AOS     DECNODEX
        20 011562   002303 470400 2                  LDP0    DATE_NODE$
        20 011563   000001 236100                    LDQ     1,,PR0
        20 011564   000022 772000                    QRL     18
        20 011565   002305 116000 2                  CMPQ    DECNODEX
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:455  
        20 011566   011444 605400 20                 TPNZ    s:27096

     3172    27128    6          END;

     3173    27129    5         END;

  27129 20 011567   002306 054000 2                  AOS     DATENODEX
        20 011570   000233 470400 2                  LDP0    SUBSUBNODE$
        20 011571   000001 236100                    LDQ     1,,PR0
        20 011572   000022 772000                    QRL     18
        20 011573   002306 116000 2                  CMPQ    DATENODEX
        20 011574   011347 605400 20                 TPNZ    s:27073

     3174    27130
     3175    27131        /***
     3176    27132         *** Set HH:MM:SS.SS default according to type of date specification.
     3177    27133         ***/
     3178    27134
     3179    27135    4      BEF = '0'B;

  27135 20 011575   002321 450000 2                  STZ     BEF

     3180    27136    4      AFT = '0'B;

  27136 20 011576   002320 450000 2                  STZ     AFT

     3181    27137    4      IF NOT TIME_SPECIFIED

  27137 20 011577   002310 234000 2                  SZN     TIME_SPECIFIED
        20 011600   011606 604000 20                 TMI     s:27139

     3182    27138    4       THEN ANSDATEPIECE.HHMMSSSS = DATE_INFO.HHMMSSSS(DATE_TYPE);

  27138 20 011601   002316 235000 2                  LDA     DATE_TYPE
        20 011602   000005 735000                    ALS     5
        20 011603   040000 100405                    MLR     fill='040'O
        20 011604   000014 000010 19                 ADSC9   DATE_INFO,A              cn=0,n=8
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:456  
        20 011605   000173 400010 2                  ADSC9   ANSDATE+1                cn=2,n=8

     3183    27139    4      IF NOT_SPECIFIED

  27139 20 011606   002314 234000 2                  SZN     NOT_SPECIFIED
        20 011607   011640 605000 20                 TPL     s:27154

     3184    27140    5       THEN DO;

     3185    27141    5         IF DATE_INFO.NEGATIVE.AFT(DATE_TYPE)

  27141 20 011610   002316 235000 2                  LDA     DATE_TYPE
        20 011611   000003 735000                    ALS     3
        20 011612   000021 234005 19                 SZN     DATE_INFO+5,AL
        20 011613   011620 605000 20                 TPL     s:27146

     3186    27142    6          THEN DO;

     3187    27143    6            AFT = '1'B;

  27143 20 011614   400000 236003                    LDQ     -131072,DU
        20 011615   002320 756000 2                  STQ     AFT

     3188    27144    6            AFT_DELTA = DATE_INFO.NEGATIVE.AFT_DELTA(DATE_TYPE);

  27144 20 011616   000022 235005 19                 LDA     DATE_INFO+6,AL
        20 011617   002322 755000 2                  STA     AFT_DELTA

     3189    27145    6            END;

     3190    27146    5         IF DATE_INFO.NEGATIVE.BEF(DATE_TYPE)

  27146 20 011620   002316 235000 2                  LDA     DATE_TYPE
        20 011621   000003 735000                    ALS     3
        20 011622   000021 236005 19                 LDQ     DATE_INFO+5,AL
        20 011623   200000 316003                    CANQ    65536,DU
        20 011624   011631 600000 20                 TZE     s:27151
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:457  

     3191    27147    6          THEN DO;

     3192    27148    6            BEF = '1'B;

  27148 20 011625   400000 236003                    LDQ     -131072,DU
        20 011626   002321 756000 2                  STQ     BEF

     3193    27149    6            BEF_DELTA = DATE_INFO.NEGATIVE.BEF_DELTA(DATE_TYPE);

  27149 20 011627   000023 235005 19                 LDA     DATE_INFO+7,AL
        20 011630   002323 755000 2                  STA     BEF_DELTA

     3194    27150    6            END;

     3195    27151    5         DISK_AND = DATE_INFO.NEGATIVE.DISK_AND(DATE_TYPE);

  27151 20 011631   002316 235000 2                  LDA     DATE_TYPE
        20 011632   000003 735000                    ALS     3
        20 011633   000021 236005 19                 LDQ     DATE_INFO+5,AL
        20 011634   000002 736000                    QLS     2
        20 011635   400000 376003                    ANQ     -131072,DU
        20 011636   002324 756000 2                  STQ     DISK_AND

     3196    27152    5         END;

  27152 20 011637   011667 710000 20                 TRA     s:27171

     3197    27153    5       ELSE DO;

     3198    27154    5         IF DATE_INFO.POSITIVE.AFT(DATE_TYPE)

  27154 20 011640   002316 235000 2                  LDA     DATE_TYPE
        20 011641   000003 735000                    ALS     3
        20 011642   000016 234005 19                 SZN     DATE_INFO+2,AL
        20 011643   011650 605000 20                 TPL     s:27159

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:458  
     3199    27155    6          THEN DO;

     3200    27156    6            AFT = '1'B;

  27156 20 011644   400000 236003                    LDQ     -131072,DU
        20 011645   002320 756000 2                  STQ     AFT

     3201    27157    6            AFT_DELTA = DATE_INFO.POSITIVE.AFT_DELTA(DATE_TYPE);

  27157 20 011646   000017 235005 19                 LDA     DATE_INFO+3,AL
        20 011647   002322 755000 2                  STA     AFT_DELTA

     3202    27158    6            END;

     3203    27159    5         IF DATE_INFO.POSITIVE.BEF(DATE_TYPE)

  27159 20 011650   002316 235000 2                  LDA     DATE_TYPE
        20 011651   000003 735000                    ALS     3
        20 011652   000016 236005 19                 LDQ     DATE_INFO+2,AL
        20 011653   200000 316003                    CANQ    65536,DU
        20 011654   011661 600000 20                 TZE     s:27164

     3204    27160    6          THEN DO;

     3205    27161    6            BEF = '1'B;

  27161 20 011655   400000 236003                    LDQ     -131072,DU
        20 011656   002321 756000 2                  STQ     BEF

     3206    27162    6            BEF_DELTA = DATE_INFO.POSITIVE.BEF_DELTA(DATE_TYPE);

  27162 20 011657   000020 235005 19                 LDA     DATE_INFO+4,AL
        20 011660   002323 755000 2                  STA     BEF_DELTA

     3207    27163    6            END;

     3208    27164    5         DISK_AND = DATE_INFO.POSITIVE.DISK_AND(DATE_TYPE);
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:459  

  27164 20 011661   002316 235000 2                  LDA     DATE_TYPE
        20 011662   000003 735000                    ALS     3
        20 011663   000016 236005 19                 LDQ     DATE_INFO+2,AL
        20 011664   000002 736000                    QLS     2
        20 011665   400000 376003                    ANQ     -131072,DU
        20 011666   002324 756000 2                  STQ     DISK_AND

     3209    27165    5         END;

     3210    27166
     3211    27167        /***
     3212    27168         *** Convert ANS format date into UTS.
     3213    27169         ***/
     3214    27170
     3215    27171    4      IF USE_ANSDATE

  27171 20 011667   002317 234000 2                  SZN     USE_ANSDATE
        20 011670   011705 605000 20                 TPL     s:27181

     3216    27172    5       THEN DO;

     3217    27173    5         CALL M$TIME( GET_DATEUTS_ANSDATE )

  27173 20 011671   000654 630400 2                  EPPR0   GET_DATEUTS_ANSDATE
        20 011672   420004 713400                    CLIMB   alt,+8196
        20 011673   402000 401760                    pmme    nvectors=5
        20 011674   011676 702000 20                 TSX2    s:27175
        20 011675   011705 710000 20                 TRA     s:27181

     3218    27174    6          WHENALTRETURN DO;

     3219    27175    6            CALL FLI$RPT_ERR( , );

  27175 20 011676   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 011677   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 011700   000000 011000                    NOP     0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:460  

     3220    27176    6            COMMAND_ERROR = '1'B;

  27176 20 011701   400000 236003                    LDQ     -131072,DU
        20 011702   000000 756000 xsym               STQ     COMMAND_ERROR

     3221    27177    6            ALTRETURN;

  27177 20 011703   200034 221300                    LDX1  ! DISK_OPTION_PAD_SAVE+1,,AUTO
        20 011704   000000 702211                    TSX2  ! 0,X1

     3222    27178    6            END;
     3223    27179    5         END;

     3224    27180
     3225    27181    4      DISK_AND_OP(WHAT_DATE) = DISK_AND;

  27181 20 011705   002315 235000 2                  LDA     WHAT_DATE
        20 011706   011710 605000 20                 TPL     s:27181+3
        20 011707   000044 035003                    ADLA    36,DU
        20 011710   003005 060400                    CSL     bolr='003'O
        20 011711   002324 000001 2                  BDSC    DISK_AND                 by=0,bit=0,n=1
        20 011712   000000 000001 xsym               BDSC    DISK_AND_OP,A            by=0,bit=0,n=1

     3226    27182    4      IF BEF

  27182 20 011713   002321 234000 2                  SZN     BEF
        20 011714   012002 605000 20                 TPL     s:27204

     3227    27183    5       THEN DO;

     3228    27184    5         CALL XUD$UTS_ADJUST(DISK_BEF_UTS(WHAT_DATE),DATEUTS,BEF_DELTA);

  27184 20 011715   000156 236000 21                 LDQ     110
        20 011716   200044 756100                    STQ     @MAX_NX+3,,AUTO
        20 011717   000146 236000 21                 LDQ     102
        20 011720   200043 756100                    STQ     @MAX_NX+2,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:461  
        20 011721   002315 720000 2                  LXL0    WHAT_DATE
        20 011722   000000 630410 xsym               EPPR0   DISK_BEF_UTS,X0
        20 011723   200042 450500                    STP0    @MAX_NX+1,,AUTO
        20 011724   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 011725   000021 631400 xsym               EPPR1   B_VECTNIL+17
        20 011726   000000 701000 xent               TSX1    XUD$UTS_ADJUST
        20 011727   000000 011000                    NOP     0

     3229    27185    5         IF DATE_CRIT.BEF(WHAT_DATE)

  27185 20 011730   002315 235000 2                  LDA     WHAT_DATE
        20 011731   011733 605000 20                 TPL     s:27185+3
        20 011732   000044 035003                    ADLA    36,DU
        20 011733   000000 066405                    CMPB    filb='0'B
        20 011734   000000 000001 xsym               BDSC    DATE_CRIT,A              by=0,bit=0,n=1
        20 011735   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        20 011736   011774 600000 20                 TZE     s:27202

     3230    27186    6          THEN DO;                         /* Already specified                  */

     3231    27187    7            DO CASE( WHAT_DATE );

  27187 20 011737   002315 235000 2                  LDA     WHAT_DATE
        20 011740   000005 115007                    CMPA    5,DL
        20 011741   011743 602005 20                 TNC     s:27187+4,AL
        20 011742   011766 710000 20                 TRA     s:27199
        20 011743   011750 710000 20                 TRA     s:27189
        20 011744   011753 710000 20                 TRA     s:27191
        20 011745   011756 710000 20                 TRA     s:27193
        20 011746   011761 710000 20                 TRA     s:27195
        20 011747   011764 710000 20                 TRA     s:27197

     3232    27188    7             CASE( %ACCESSED );

     3233    27189    7               VLP_ERRCODE = E_DUP_BEF_ACC;

  27189 20 011750   000000 236000 xsym               LDQ     E_DUP_BEF_ACC
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:462  
        20 011751   000436 756000 2                  STQ     VLP_ERRCODE
        20 011752   011766 710000 20                 TRA     s:27199

     3234    27190    7             CASE( %MODIFIED );

     3235    27191    7               VLP_ERRCODE = E_DUP_BEF_MOD;

  27191 20 011753   000000 236000 xsym               LDQ     E_DUP_BEF_MOD
        20 011754   000436 756000 2                  STQ     VLP_ERRCODE
        20 011755   011766 710000 20                 TRA     s:27199

     3236    27192    7             CASE( %CREATED );

     3237    27193    7               VLP_ERRCODE = E_DUP_BEF_CRE;

  27193 20 011756   000000 236000 xsym               LDQ     E_DUP_BEF_CRE
        20 011757   000436 756000 2                  STQ     VLP_ERRCODE
        20 011760   011766 710000 20                 TRA     s:27199

     3238    27194    7             CASE(%BACKED_UP);

     3239    27195    7               VLP_ERRCODE = E_DUP_BEF_BAC;

  27195 20 011761   000000 236000 xsym               LDQ     E_DUP_BEF_BAC
        20 011762   000436 756000 2                  STQ     VLP_ERRCODE
        20 011763   011766 710000 20                 TRA     s:27199

     3240    27196    7             CASE(%ARCHIVED);

     3241    27197    7               VLP_ERRCODE = E_DUP_BEF_ARC;

  27197 20 011764   000000 236000 xsym               LDQ     E_DUP_BEF_ARC
        20 011765   000436 756000 2                  STQ     VLP_ERRCODE

     3242    27198    7             END;

     3243    27199    6            CALL FLI$RPT_ERR( VLP_ERRCODE, );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:463  

  27199 20 011766   000121 630400 21                 EPPR0   81
        20 011767   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 011770   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 011771   000000 011000                    NOP     0

     3244    27200    6            COMMAND_ERROR = '1'B;

  27200 20 011772   400000 236003                    LDQ     -131072,DU
        20 011773   000000 756000 xsym               STQ     COMMAND_ERROR

     3245    27201    6            END;

     3246    27202    5         DATE_CRIT.BEF(WHAT_DATE) = '1'B;

  27202 20 011774   002315 235000 2                  LDA     WHAT_DATE
        20 011775   011777 605000 20                 TPL     s:27202+3
        20 011776   000044 035003                    ADLA    36,DU
        20 011777   003005 060400                    CSL     bolr='003'O
        20 012000   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
        20 012001   000000 000001 xsym               BDSC    DATE_CRIT,A              by=0,bit=0,n=1

     3247    27203    5         END;

     3248    27204    4      IF AFT

  27204 20 012002   002320 234000 2                  SZN     AFT
        20 012003   012071 605000 20                 TPL     s:27227

     3249    27205    5       THEN DO;

     3250    27206    5         CALL XUD$UTS_ADJUST(DISK_AFT_UTS(WHAT_DATE),DATEUTS,AFT_DELTA);

  27206 20 012004   000157 236000 21                 LDQ     111
        20 012005   200044 756100                    STQ     @MAX_NX+3,,AUTO
        20 012006   000146 236000 21                 LDQ     102
        20 012007   200043 756100                    STQ     @MAX_NX+2,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:464  
        20 012010   002315 720000 2                  LXL0    WHAT_DATE
        20 012011   000000 630410 xsym               EPPR0   DISK_AFT_UTS,X0
        20 012012   200042 450500                    STP0    @MAX_NX+1,,AUTO
        20 012013   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 012014   000021 631400 xsym               EPPR1   B_VECTNIL+17
        20 012015   000000 701000 xent               TSX1    XUD$UTS_ADJUST
        20 012016   000000 011000                    NOP     0

     3251    27207    5         IF DATE_CRIT.AFT(WHAT_DATE)

  27207 20 012017   002315 235000 2                  LDA     WHAT_DATE
        20 012020   012022 605000 20                 TPL     s:27207+3
        20 012021   000044 035003                    ADLA    36,DU
        20 012022   000000 066405                    CMPB    filb='0'B
        20 012023   000000 050001 xsym               BDSC    DATE_CRIT,A              by=0,bit=5,n=1
        20 012024   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        20 012025   012063 600000 20                 TZE     s:27224

     3252    27208    6          THEN DO;                         /* Already specified                  */

     3253    27209    7            DO CASE( WHAT_DATE );

  27209 20 012026   002315 235000 2                  LDA     WHAT_DATE
        20 012027   000005 115007                    CMPA    5,DL
        20 012030   012032 602005 20                 TNC     s:27209+4,AL
        20 012031   012055 710000 20                 TRA     s:27221
        20 012032   012037 710000 20                 TRA     s:27211
        20 012033   012042 710000 20                 TRA     s:27213
        20 012034   012045 710000 20                 TRA     s:27215
        20 012035   012050 710000 20                 TRA     s:27217
        20 012036   012053 710000 20                 TRA     s:27219

     3254    27210    7             CASE( %ACCESSED );

     3255    27211    7               VLP_ERRCODE = E_DUP_AFT_ACC;

  27211 20 012037   000000 236000 xsym               LDQ     E_DUP_AFT_ACC
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:465  
        20 012040   000436 756000 2                  STQ     VLP_ERRCODE
        20 012041   012055 710000 20                 TRA     s:27221

     3256    27212    7             CASE( %MODIFIED );

     3257    27213    7               VLP_ERRCODE = E_DUP_AFT_MOD;

  27213 20 012042   000000 236000 xsym               LDQ     E_DUP_AFT_MOD
        20 012043   000436 756000 2                  STQ     VLP_ERRCODE
        20 012044   012055 710000 20                 TRA     s:27221

     3258    27214    7             CASE( %CREATED );

     3259    27215    7               VLP_ERRCODE = E_DUP_AFT_CRE;

  27215 20 012045   000000 236000 xsym               LDQ     E_DUP_AFT_CRE
        20 012046   000436 756000 2                  STQ     VLP_ERRCODE
        20 012047   012055 710000 20                 TRA     s:27221

     3260    27216    7             CASE( %BACKED_UP );

     3261    27217    7               VLP_ERRCODE = E_DUP_AFT_BAC;

  27217 20 012050   000000 236000 xsym               LDQ     E_DUP_AFT_BAC
        20 012051   000436 756000 2                  STQ     VLP_ERRCODE
        20 012052   012055 710000 20                 TRA     s:27221

     3262    27218    7             CASE( %ARCHIVED );

     3263    27219    7               VLP_ERRCODE = E_DUP_AFT_ARC;

  27219 20 012053   000000 236000 xsym               LDQ     E_DUP_AFT_ARC
        20 012054   000436 756000 2                  STQ     VLP_ERRCODE

     3264    27220    7             END;

     3265    27221    6            CALL FLI$RPT_ERR( VLP_ERRCODE, );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:466  

  27221 20 012055   000121 630400 21                 EPPR0   81
        20 012056   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 012057   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 012060   000000 011000                    NOP     0

     3266    27222    6            COMMAND_ERROR = '1'B;

  27222 20 012061   400000 236003                    LDQ     -131072,DU
        20 012062   000000 756000 xsym               STQ     COMMAND_ERROR

     3267    27223    6            END;

     3268    27224    5         DATE_CRIT.AFT(WHAT_DATE) = '1'B;

  27224 20 012063   002315 235000 2                  LDA     WHAT_DATE
        20 012064   012066 605000 20                 TPL     s:27224+3
        20 012065   000044 035003                    ADLA    36,DU
        20 012066   003005 060400                    CSL     bolr='003'O
        20 012067   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
        20 012070   000000 050001 xsym               BDSC    DATE_CRIT,A              by=0,bit=5,n=1

     3269    27225    5         END;

     3270    27226
     3271    27227    4      IF COMMAND = %REQUALIFY

  27227 20 012071   000167 235000 2                  LDA     COMMAND
        20 012072   000033 115007                    CMPA    27,DL
        20 012073   012107 601000 20                 TNZ     s:27237

     3272    27228    5       THEN DO;

     3273    27229    6         DO CASE( WHAT_DATE );

  27229 20 012074   002315 236000 2                  LDQ     WHAT_DATE
        20 012075   000004 136007                    SBLQ    4,DL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:467  
        20 012076   000001 116007                    CMPQ    1,DL
        20 012077   012101 602006 20                 TNC     s:27229+5,QL
        20 012100   012105 710000 20                 TRA     s:27233
        20 012101   012102 710000 20                 TRA     s:27231

     3274    27230    6          CASE( %ARCHIVED );

     3275    27231    6            COMMAND = %REQUALIFY_ARCHIVE;

  27231 20 012102   000032 235007                    LDA     26,DL
        20 012103   000167 755000 2                  STA     COMMAND
        20 012104   012107 710000 20                 TRA     s:27237

     3276    27232    6          CASE( ELSE );

     3277    27233    6            COMMAND = %REQUALIFY_BACKUP;

  27233 20 012105   000031 235007                    LDA     25,DL
        20 012106   000167 755000 2                  STA     COMMAND

     3278    27234    6          END;

     3279    27235    5         END;

     3280    27236
     3281    27237    4      RETURN;

  27237 20 012107   200034 221300                    LDX1  ! DISK_OPTION_PAD_SAVE+1,,AUTO
        20 012110   000001 702211                    TSX2  ! 1,X1

     3282    27238
     3283    27239    4   FLB_SETDATE: PROC( DATEFIELD );

  27239 20 012111   200036 741300       FLB_SETDATE  STX1  ! @SPEC+1,,AUTO

     3284    27240
     3285    27241    5   DCL DATEFIELD CHAR(2) CALIGNED;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:468  
     3286    27242
     3287    27243        /********************/
     3288    27244
     3289    27245    5      CALL CHARBIN( TEMP, DECIMAL$->OUT$SYM.TEXT );

  27245 20 012112   002312 470400 2                  LDP0    DECIMAL$
        20 012113   000004 236100                    LDQ     4,,PR0
        20 012114   000033 772000                    QRL     27
        20 012115   000000 620006                    EAX0    0,QL
        20 012116   000000 305540                    DTB
        20 012117   000004 230010                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=*X0
        20 012120   000236 000004 2                  NDSC9   TEMP                     cn=0,s=lsgnf,sf=0,n=4

     3290    27246    5      CALL BINCHAR( DATEFIELD, TEMP );

  27246 20 012121   200037 471500                    LDP1    @DATEFIELD,,AUTO
        20 012122   000100 301400                    BTD
        20 012123   000236 000004 2                  NDSC9   TEMP                     cn=0,s=lsgnf,sf=0,n=4
        20 012124   100000 030002                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=2

     3291    27247    5      RETURN;

  27247 20 012125   200036 221300                    LDX1  ! @SPEC+1,,AUTO
        20 012126   000001 702211                    TSX2  ! 1,X1

     3292    27248
     3293    27249    5   END FLB_SETDATE;
     3294    27250
     3295    27251
     3296    27252    4   END FLB_DATE_SPEC;
     3297    27253
     3298    27254    3   END FLB_DISK_OPTION_LIST;
     3299    27255        /**********************************************************************/
     3300    27256
     3301    27257    2   FLB_NUTHER_FILE_SPEC: PROC;

  27257 20 012127   200034 741300       FLB_NUTHER_* STX1  ! DISK_OPTION_PAD_SAVE+1,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:469  

     3302    27258
     3303    27259    3      DISK_FILE_SPEC.NBR_LEFT = DISK_FILE_SPEC.NBR_LEFT - 1;

  27259 20 012130   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 012131   000001 336007                    LCQ     1,DL
        20 012132   000001 056100                    ASQ     1,,PR0

     3304    27260    3      IF DISK_FILE_SPEC.NBR_LEFT < 0

  27260 20 012133   012145 605000 20                 TPL     s:27266

     3305    27261    4       THEN DO;                            /* Must allocate more                 */

     3306    27262    4         TEMP = 5 * LENGTHW(DISK_FILE_SPEC.SPEC(0));

  27262 20 012134   000151 235007                    LDA     105,DL
        20 012135   000236 755000 2                  STA     TEMP

     3307    27263    4         CALL FLI$ALLOC( TEMP, TEMP );     /* Allocate 5 more                    */

  27263 20 012136   000160 630400 21                 EPPR0   112
        20 012137   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 012140   000000 701000 xent               TSX1    FLI$ALLOC
        20 012141   000000 011000                    NOP     0

     3308    27264    4         DISK_FILE_SPEC.NBR_LEFT = DISK_FILE_SPEC.NBR_LEFT + 5;

  27264 20 012142   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 012143   000005 236007                    LDQ     5,DL
        20 012144   000001 056100                    ASQ     1,,PR0

     3309    27265    4         END;

     3310    27266    3      N = DISK_FILE_SPEC.NBR;

  27266 20 012145   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:470  
        20 012146   000224 755000 2                  STA     N

     3311    27267    3      DISK_FILE_SPEC.SPEC.START.ACCT(N) = START_ACCT;

  27267 20 012147   000224 236000 2                  LDQ     N
        20 012150   000025 402007                    MPY     21,DL
        20 012151   000002 736000                    QLS     2
        20 012152   000106 100400                    MLR     fill='000'O
        20 012153   000461 000010 2                  ADSC9   START_ACCT               cn=0,n=8
        20 012154   000006 000010                    ADSC9   6,Q,PR0                  cn=0,n=8

     3312    27268    3      DISK_FILE_SPEC.SPEC.START.FILE(N) = START_FILE;

  27268 20 012155   000224 236000 2                  LDQ     N
        20 012156   000124 402007                    MPY     84,DL
        20 012157   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 012160   000106 100400                    MLR     fill='000'O
        20 012161   000451 000040 2                  ADSC9   START_FILE               cn=0,n=32
        20 012162   000010 000040                    ADSC9   8,Q,PR0                  cn=0,n=32

     3313    27269    3      DISK_FILE_SPEC.SPEC.STOP.ACCT(N) = STOP_ACCT;

  27269 20 012163   000224 236000 2                  LDQ     N
        20 012164   000025 402007                    MPY     21,DL
        20 012165   000002 736000                    QLS     2
        20 012166   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 012167   000106 100400                    MLR     fill='000'O
        20 012170   000473 000010 2                  ADSC9   STOP_ACCT                cn=0,n=8
        20 012171   000020 000010                    ADSC9   16,Q,PR0                 cn=0,n=8

     3314    27270    3      DISK_FILE_SPEC.SPEC.STOP.FILE(N) = STOP_FILE;

  27270 20 012172   000224 236000 2                  LDQ     N
        20 012173   000124 402007                    MPY     84,DL
        20 012174   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 012175   000106 100400                    MLR     fill='000'O
        20 012176   000463 000040 2                  ADSC9   STOP_FILE                cn=0,n=32
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:471  
        20 012177   000022 000040                    ADSC9   18,Q,PR0                 cn=0,n=32

     3315    27271    3      DISK_FILE_SPEC.SPEC.SKIP(N) = 0;

  27271 20 012200   000224 236000 2                  LDQ     N
        20 012201   000025 402007                    MPY     21,DL
        20 012202   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 012203   000005 450106                    STZ     5,QL,PR0

     3316    27272    3      DISK_FILE_SPEC.NBR = N + 1;

  27272 20 012204   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 012205   000224 235000 2                  LDA     N
        20 012206   000001 035007                    ADLA    1,DL
        20 012207   000000 755100                    STA     0,,PR0

     3317    27273
     3318    27274    3      IF DISK_FILE_SPEC.PASSWORD_SPEC

  27274 20 012210   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 012211   000002 234100                    SZN     2,,PR0
        20 012212   012217 605000 20                 TPL     s:27276

     3319    27275    3       THEN DISK_FILE_SPEC.PASSWORD# = FID_PASS.PASS#;

  27275 20 012213   040100 100400                    MLR     fill='040'O
        20 012214   001372 000010 2                  ADSC9   FID_PASS                 cn=0,n=8
        20 012215   000002 200010                    ADSC9   2,,PR0                   cn=1,n=8
        20 012216   012222 710000 20                 TRA     s:27277

     3320    27276    3       ELSE DISK_FILE_SPEC.PASSWORD# = ' ';

  27276 20 012217   040100 100400                    MLR     fill='040'O
        20 012220   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        20 012221   000002 200010                    ADSC9   2,,PR0                   cn=1,n=8

     3321    27277    3      RETURN;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:472  

  27277 20 012222   200034 221300                    LDX1  ! DISK_OPTION_PAD_SAVE+1,,AUTO
        20 012223   000001 702211                    TSX2  ! 1,X1

     3322    27278
     3323    27279    3   END FLB_NUTHER_FILE_SPEC;
     3324    27280        /**********************************************************************/
     3325    27281
     3326    27282    2   FLB_FID_RANGE: PROC( FID_RANGE$ );

  27282 20 012224   200032 741300       FLB_FID_RAN* STX1  ! FIRST+1,,AUTO

     3327    27283        /*F*  NAME: FLB_FID_RANGE
     3328    27284              PURPOSE: Process FID_RANGE node.
     3329    27285        ***/
     3330    27286
     3331    27287    3   DCL FID_RANGE$ PTR;
     3332    27288
     3333    27289         /***
     3334    27290          *** STATIC
     3335    27291          ***/
     3336    27292
     3337    27293    3   DCL I SBIN STATIC;
     3338    27294    3   DCL FID_RANGE_SUBLK$ PTR STATIC;
     3339    27295
     3340    27296        %EQU FROM_RANGE@ = 0;
     3341    27297        %EQU TO_RANGE@ = 1;
     3342    27298
     3343    27299        /******************************/
     3344    27300
     3345    27301
     3346    27302
     3347    27303    3      IF ACCT.ACCT# = ' '

  27303 20 012225   040000 106400                    CMPC    fill='040'O
        20 012226   000447 000010 2                  ADSC9   ACCT                     cn=0,n=8
        20 012227   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:473  
        20 012230   012235 601000 20                 TNZ     s:27305

     3348    27304    3       THEN ACCT.ACCT# = B$JIT.FACCN;

  27304 20 012231   000000 470400 xsym               LDP0    B$JIT$
        20 012232   000006 237100                    LDAQ    6,,PR0
        20 012233   000447 755000 2                  STA     ACCT
        20 012234   000450 756000 2                  STQ     ACCT+1

     3349    27305    3      DISK_FILE_SPEC.PASSWORD_SPEC = '0'B; /* Passwords never spec'd for ranges  */

  27305 20 012235   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 012236   000031 236000 xsym               LDQ     B_VECTNIL+25
        20 012237   000002 356100                    ANSQ    2,,PR0

     3350    27306    3      FID_RANGE_SUBLK$ = FID_RANGE$->OUT$BLK.SUBLK$(0);

  27306 20 012240   200033 471500                    LDP1    @FID_RANGE$,,AUTO
        20 012241   100000 473500                    LDP3    0,,PR1
        20 012242   300003 236100                    LDQ     3,,PR3
        20 012243   002326 756000 2                  STQ     FID_RANGE_SUBLK$

     3351    27307    4      DO CASE( FID_RANGE_SUBLK$->OUT$BLK.CODE );

  27307 20 012244   002326 474400 2                  LDP4    FID_RANGE_SUBLK$
        20 012245   400000 720100                    LXL0    0,,PR4
        20 012246   000005 100003                    CMPX0   5,DU
        20 012247   012251 602010 20                 TNC     s:27307+5,X0
        20 012250   012433 710000 20                 TRA     s:27350
        20 012251   012273 710000 20                 TRA     s:27315
        20 012252   012256 710000 20                 TRA     s:27309
        20 012253   012401 710000 20                 TRA     s:27341
        20 012254   012317 710000 20                 TRA     s:27322
        20 012255   012343 710000 20                 TRA     s:27329

     3352    27308    4       CASE( %ALL_RANGE );

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:474  
     3353    27309    4         START_ACCT = FIRST_ACCT;

  27309 20 012256   000000 100400                    MLR     fill='000'O
        20 012257   000000 000010 xsym               ADSC9   FIRST_ACCT               cn=0,n=8
        20 012260   000461 000010 2                  ADSC9   START_ACCT               cn=0,n=8

     3354    27310    4         START_FILE = FIRST_FILE;

  27310 20 012261   000000 100400                    MLR     fill='000'O
        20 012262   000000 000040 xsym               ADSC9   FIRST_FILE               cn=0,n=32
        20 012263   000451 000040 2                  ADSC9   START_FILE               cn=0,n=32

     3355    27311    4         STOP_ACCT = LAST_ACCT;

  27311 20 012264   000000 100400                    MLR     fill='000'O
        20 012265   000000 000010 xsym               ADSC9   LAST_ACCT                cn=0,n=8
        20 012266   000473 000010 2                  ADSC9   STOP_ACCT                cn=0,n=8

     3356    27312    4         STOP_FILE = LAST_FILE;

  27312 20 012267   000000 100400                    MLR     fill='000'O
        20 012270   000000 000040 xsym               ADSC9   LAST_FILE                cn=0,n=32
        20 012271   000463 000040 2                  ADSC9   STOP_FILE                cn=0,n=32
        20 012272   012433 710000 20                 TRA     s:27350

     3357    27313
     3358    27314    4       CASE( %TO_STOP );

     3359    27315    4         START_ACCT = FIRST_ACCT;

  27315 20 012273   000000 100400                    MLR     fill='000'O
        20 012274   000000 000010 xsym               ADSC9   FIRST_ACCT               cn=0,n=8
        20 012275   000461 000010 2                  ADSC9   START_ACCT               cn=0,n=8

     3360    27316    4         START_FILE = FIRST_FILE;

  27316 20 012276   000000 100400                    MLR     fill='000'O
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:475  
        20 012277   000000 000040 xsym               ADSC9   FIRST_FILE               cn=0,n=32
        20 012300   000451 000040 2                  ADSC9   START_FILE               cn=0,n=32

     3361    27317    4         CALL FLB_FILE_N_ACCOUNT( FID_RANGE_SUBLK$->OUT$BLK.SUBLK$(0),%TO_RANGE@ );

  27317 20 012301   000077 236000 21                 LDQ     63
        20 012302   200036 756100                    STQ     @SPEC+1,,AUTO
        20 012303   002326 236000 2                  LDQ     FID_RANGE_SUBLK$
        20 012304   000003 036003                    ADLQ    3,DU
        20 012305   200035 756100                    STQ     FPARAM_+1,,AUTO
        20 012306   012463 701000 20                 TSX1    FLB_FILE_N_ACCOUNT
        20 012307   000000 011000                    NOP     0

     3362    27318    4         STOP_ACCT = ACCT;

  27318 20 012310   000000 100400                    MLR     fill='000'O
        20 012311   000447 000010 2                  ADSC9   ACCT                     cn=0,n=8
        20 012312   000473 000010 2                  ADSC9   STOP_ACCT                cn=0,n=8

     3363    27319    4         STOP_FILE = FILE;

  27319 20 012313   000000 100400                    MLR     fill='000'O
        20 012314   000437 000040 2                  ADSC9   FILE                     cn=0,n=32
        20 012315   000463 000040 2                  ADSC9   STOP_FILE                cn=0,n=32
        20 012316   012433 710000 20                 TRA     s:27350

     3364    27320
     3365    27321    4       CASE( %FROM_START );

     3366    27322    4         CALL FLB_FILE_N_ACCOUNT( FID_RANGE_SUBLK$->OUT$BLK.SUBLK$(0),%FROM_RANGE@ );

  27322 20 012317   000032 236000 21                 LDQ     26
        20 012320   200036 756100                    STQ     @SPEC+1,,AUTO
        20 012321   002326 236000 2                  LDQ     FID_RANGE_SUBLK$
        20 012322   000003 036003                    ADLQ    3,DU
        20 012323   200035 756100                    STQ     FPARAM_+1,,AUTO
        20 012324   012463 701000 20                 TSX1    FLB_FILE_N_ACCOUNT
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:476  
        20 012325   000000 011000                    NOP     0

     3367    27323    4         START_ACCT = ACCT;

  27323 20 012326   000000 100400                    MLR     fill='000'O
        20 012327   000447 000010 2                  ADSC9   ACCT                     cn=0,n=8
        20 012330   000461 000010 2                  ADSC9   START_ACCT               cn=0,n=8

     3368    27324    4         START_FILE = FILE;

  27324 20 012331   000000 100400                    MLR     fill='000'O
        20 012332   000437 000040 2                  ADSC9   FILE                     cn=0,n=32
        20 012333   000451 000040 2                  ADSC9   START_FILE               cn=0,n=32

     3369    27325    4         STOP_ACCT = LAST_ACCT;

  27325 20 012334   000000 100400                    MLR     fill='000'O
        20 012335   000000 000010 xsym               ADSC9   LAST_ACCT                cn=0,n=8
        20 012336   000473 000010 2                  ADSC9   STOP_ACCT                cn=0,n=8

     3370    27326    4         STOP_FILE = LAST_FILE;

  27326 20 012337   000000 100400                    MLR     fill='000'O
        20 012340   000000 000040 xsym               ADSC9   LAST_FILE                cn=0,n=32
        20 012341   000463 000040 2                  ADSC9   STOP_FILE                cn=0,n=32
        20 012342   012433 710000 20                 TRA     s:27350

     3371    27327
     3372    27328    4       CASE( %FROM_TO );

     3373    27329    4         CALL FLB_FILE_N_ACCOUNT( FID_RANGE_SUBLK$->OUT$BLK.SUBLK$(0),%FROM_RANGE@ );

  27329 20 012343   000032 236000 21                 LDQ     26
        20 012344   200036 756100                    STQ     @SPEC+1,,AUTO
        20 012345   002326 236000 2                  LDQ     FID_RANGE_SUBLK$
        20 012346   000003 036003                    ADLQ    3,DU
        20 012347   200035 756100                    STQ     FPARAM_+1,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:477  
        20 012350   012463 701000 20                 TSX1    FLB_FILE_N_ACCOUNT
        20 012351   000000 011000                    NOP     0

     3374    27330    4         START_ACCT = ACCT;

  27330 20 012352   000000 100400                    MLR     fill='000'O
        20 012353   000447 000010 2                  ADSC9   ACCT                     cn=0,n=8
        20 012354   000461 000010 2                  ADSC9   START_ACCT               cn=0,n=8

     3375    27331    4         START_FILE = FILE;

  27331 20 012355   000000 100400                    MLR     fill='000'O
        20 012356   000437 000040 2                  ADSC9   FILE                     cn=0,n=32
        20 012357   000451 000040 2                  ADSC9   START_FILE               cn=0,n=32

     3376    27332    4         STOP_ACCT = ACCT;

  27332 20 012360   000000 100400                    MLR     fill='000'O
        20 012361   000447 000010 2                  ADSC9   ACCT                     cn=0,n=8
        20 012362   000473 000010 2                  ADSC9   STOP_ACCT                cn=0,n=8

     3377    27333        /***
     3378    27334         *** If no file specifed, then all files in account are considered.
     3379    27335         ***/
     3380    27336    4         IF FID_RANGE_SUBLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %
             27336                  ACCOUNT_NAME

  27336 20 012363   002326 470400 2                  LDP0    FID_RANGE_SUBLK$
        20 012364   000003 471500                    LDP1    3,,PR0
        20 012365   100003 473500                    LDP3    3,,PR1
        20 012366   300000 720100                    LXL0    0,,PR3
        20 012367   000001 100003                    CMPX0   1,DU
        20 012370   012375 601000 20                 TNZ     s:27338

     3381    27337    4          THEN STOP_FILE = LAST_FILE;

  27337 20 012371   000000 100400                    MLR     fill='000'O
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:478  
        20 012372   000000 000040 xsym               ADSC9   LAST_FILE                cn=0,n=32
        20 012373   000463 000040 2                  ADSC9   STOP_FILE                cn=0,n=32
        20 012374   012433 710000 20                 TRA     s:27350

     3382    27338    4          ELSE STOP_FILE = FILE;

  27338 20 012375   000000 100400                    MLR     fill='000'O
        20 012376   000437 000040 2                  ADSC9   FILE                     cn=0,n=32
        20 012377   000463 000040 2                  ADSC9   STOP_FILE                cn=0,n=32
        20 012400   012433 710000 20                 TRA     s:27350

     3383    27339
     3384    27340    4       CASE( %START_STOP );

     3385    27341    4         CALL FLB_FILE_N_ACCOUNT( FID_RANGE_SUBLK$->OUT$BLK.SUBLK$(0),%FROM_RANGE@ );

  27341 20 012401   000032 236000 21                 LDQ     26
        20 012402   200036 756100                    STQ     @SPEC+1,,AUTO
        20 012403   002326 236000 2                  LDQ     FID_RANGE_SUBLK$
        20 012404   000003 036003                    ADLQ    3,DU
        20 012405   200035 756100                    STQ     FPARAM_+1,,AUTO
        20 012406   012463 701000 20                 TSX1    FLB_FILE_N_ACCOUNT
        20 012407   000000 011000                    NOP     0

     3386    27342    4         START_ACCT = ACCT;

  27342 20 012410   000000 100400                    MLR     fill='000'O
        20 012411   000447 000010 2                  ADSC9   ACCT                     cn=0,n=8
        20 012412   000461 000010 2                  ADSC9   START_ACCT               cn=0,n=8

     3387    27343    4         START_FILE = FILE;

  27343 20 012413   000000 100400                    MLR     fill='000'O
        20 012414   000437 000040 2                  ADSC9   FILE                     cn=0,n=32
        20 012415   000451 000040 2                  ADSC9   START_FILE               cn=0,n=32

     3388    27344    4         CALL FLB_FILE_N_ACCOUNT( FID_RANGE_SUBLK$->OUT$BLK.SUBLK$(1),%TO_RANGE@ );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:479  

  27344 20 012416   000077 236000 21                 LDQ     63
        20 012417   200036 756100                    STQ     @SPEC+1,,AUTO
        20 012420   002326 236000 2                  LDQ     FID_RANGE_SUBLK$
        20 012421   000004 036003                    ADLQ    4,DU
        20 012422   200035 756100                    STQ     FPARAM_+1,,AUTO
        20 012423   012463 701000 20                 TSX1    FLB_FILE_N_ACCOUNT
        20 012424   000000 011000                    NOP     0

     3389    27345    4         STOP_ACCT = ACCT;

  27345 20 012425   000000 100400                    MLR     fill='000'O
        20 012426   000447 000010 2                  ADSC9   ACCT                     cn=0,n=8
        20 012427   000473 000010 2                  ADSC9   STOP_ACCT                cn=0,n=8

     3390    27346    4         STOP_FILE = FILE;

  27346 20 012430   000000 100400                    MLR     fill='000'O
        20 012431   000437 000040 2                  ADSC9   FILE                     cn=0,n=32
        20 012432   000463 000040 2                  ADSC9   STOP_FILE                cn=0,n=32

     3391    27347
     3392    27348    4       END;

     3393    27349
     3394    27350    3      IF START_FILE = NO_FILE

  27350 20 012433   000000 106400                    CMPC    fill='000'O
        20 012434   000451 000040 2                  ADSC9   START_FILE               cn=0,n=32
        20 012435   000000 000040 xsym               ADSC9   NO_FILE                  cn=0,n=32
        20 012436   012442 601000 20                 TNZ     s:27353

     3395    27351    3       THEN START_FILE = FIRST_FILE;

  27351 20 012437   000000 100400                    MLR     fill='000'O
        20 012440   000000 000040 xsym               ADSC9   FIRST_FILE               cn=0,n=32
        20 012441   000451 000040 2                  ADSC9   START_FILE               cn=0,n=32
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:480  

     3396    27352
     3397    27353    3      IF START_ACCT > STOP_ACCT

  27353 20 012442   000000 106400                    CMPC    fill='000'O
        20 012443   000473 000010 2                  ADSC9   STOP_ACCT                cn=0,n=8
        20 012444   000461 000010 2                  ADSC9   START_ACCT               cn=0,n=8
        20 012445   012453 602000 20                 TNC     s:27356
        20 012446   012461 601000 20                 TNZ     s:27359
        20 012447   000000 106400                    CMPC    fill='000'O
        20 012450   000463 000040 2                  ADSC9   STOP_FILE                cn=0,n=32
        20 012451   000451 000040 2                  ADSC9   START_FILE               cn=0,n=32
        20 012452   012461 603000 20                 TRC     s:27359

     3398    27354    3        OR (START_ACCT = STOP_ACCT AND START_FILE > STOP_FILE)
     3399    27355    4       THEN DO;

     3400    27356    4         COMMAND_ERROR = '1'B;

  27356 20 012453   400000 236003                    LDQ     -131072,DU
        20 012454   000000 756000 xsym               STQ     COMMAND_ERROR

     3401    27357    4         CALL FLI$RPT_ERR( E_BAD_RANGE, );

  27357 20 012455   000162 630400 21                 EPPR0   114
        20 012456   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 012457   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 012460   000000 011000                    NOP     0

     3402    27358    4         END;

     3403    27359    3      RETURN;

  27359 20 012461   200032 221300                    LDX1  ! FIRST+1,,AUTO
        20 012462   000001 702211                    TSX2  ! 1,X1

     3404    27360
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:481  
     3405    27361    3   FLB_FILE_N_ACCOUNT: PROC( FILE_N_ACCOUNT$,RANGE );

  27361 20 012463   200034 741300       FLB_FILE_N_* STX1  ! DISK_OPTION_PAD_SAVE+1,,AUTO

     3406    27362
     3407    27363    4   DCL FILE_N_ACCOUNT$ PTR;
     3408    27364    4   DCL RANGE UBIN;               /* Indicates if processing from or to range     */
     3409    27365
     3410    27366        /********************/
     3411    27367
     3412    27368    4      IF FILE_N_ACCOUNT$->OUT$BLK.NSUBLKS = 2

  27368 20 012464   200035 470500                    LDP0    @FILE_N_ACCOUNT$,,AUTO
        20 012465   000000 471500                    LDP1    0,,PR0
        20 012466   100001 220100                    LDX0    1,,PR1
        20 012467   000002 100003                    CMPX0   2,DU
        20 012470   012514 601000 20                 TNZ     s:27375

     3413    27369    5       THEN DO;                  /* Second must be account; first must be file   */

     3414    27370    5         ACCT.ACCT# = FILE_N_ACCOUNT$->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;

  27370 20 012471   100004 473500                    LDP3    4,,PR1
        20 012472   300004 236100                    LDQ     4,,PR3
        20 012473   000033 772000                    QRL     27
        20 012474   000000 622006                    EAX2    0,QL
        20 012475   040000 100540                    MLR     fill='040'O
        20 012476   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
        20 012477   000447 000010 2                  ADSC9   ACCT                     cn=0,n=8

     3415    27371    5        FILE.L# = FILE_N_ACCOUNT$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT
             27371                  ;

  27371 20 012500   100003 474500                    LDP4    3,,PR1
        20 012501   400003 475500                    LDP5    3,,PR4
        20 012502   500004 236100                    LDQ     4,,PR5
        20 012503   000033 772000                    QRL     27
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:482  
        20 012504   000446 552004 2                  STBQ    FILE+7,'04'O

     3416    27372    5         FILE.NAME# = FILE_N_ACCOUNT$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$SYM.
             27372                  TEXT;

  27372 20 012505   500004 236100                    LDQ     4,,PR5
        20 012506   000033 772000                    QRL     27
        20 012507   000000 623006                    EAX3    0,QL
        20 012510   040000 100540                    MLR     fill='040'O
        20 012511   500004 200013                    ADSC9   4,,PR5                   cn=1,n=*X3
        20 012512   000437 000037 2                  ADSC9   FILE                     cn=0,n=31

     3417    27373    5         END;

  27373 20 012513   012560 710000 20                 TRA     s:27390

     3418    27374    5       ELSE DO;

     3419    27375    5         TEMP$ = FILE_N_ACCOUNT$->OUT$BLK.SUBLK$(0);

  27375 20 012514   100003 236100                    LDQ     3,,PR1
        20 012515   000237 756000 2                  STQ     TEMP$

     3420    27376    5         IF TEMP$->OUT$BLK.CODE = %ACCOUNT_NAME

  27376 20 012516   000237 473400 2                  LDP3    TEMP$
        20 012517   300000 722100                    LXL2    0,,PR3
        20 012520   000001 102003                    CMPX2   1,DU
        20 012521   012543 601000 20                 TNZ     s:27384

     3421    27377    6          THEN DO;

     3422    27378    6            IF RANGE = %FROM_RANGE@   /* Set default file name since none spec'd */

  27378 20 012522   200036 474500                    LDP4    @RANGE,,AUTO
        20 012523   400000 235100                    LDA     0,,PR4
        20 012524   012531 601000 20                 TNZ     s:27380
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:483  

     3423    27379    6             THEN FILE = FIRST_FILE;

  27379 20 012525   000000 100400                    MLR     fill='000'O
        20 012526   000000 000040 xsym               ADSC9   FIRST_FILE               cn=0,n=32
        20 012527   000437 000040 2                  ADSC9   FILE                     cn=0,n=32
        20 012530   012534 710000 20                 TRA     s:27381

     3424    27380    6             ELSE FILE = LAST_FILE;

  27380 20 012531   000000 100400                    MLR     fill='000'O
        20 012532   000000 000040 xsym               ADSC9   LAST_FILE                cn=0,n=32
        20 012533   000437 000040 2                  ADSC9   FILE                     cn=0,n=32

     3425    27381    6            ACCT.ACCT# = TEMP$->OUT$SYM.TEXT;

  27381 20 012534   300004 236100                    LDQ     4,,PR3
        20 012535   000033 772000                    QRL     27
        20 012536   000000 623006                    EAX3    0,QL
        20 012537   040000 100540                    MLR     fill='040'O
        20 012540   300004 200013                    ADSC9   4,,PR3                   cn=1,n=*X3
        20 012541   000447 000010 2                  ADSC9   ACCT                     cn=0,n=8

     3426    27382    6            END;

  27382 20 012542   012560 710000 20                 TRA     s:27390

     3427    27383    6          ELSE DO;

     3428    27384    6            ACCT.ACCT# = PREV_ACCT.ACCT#;

  27384 20 012543   000240 237000 2                  LDAQ    PREV_ACCT
        20 012544   000447 755000 2                  STA     ACCT
        20 012545   000450 756000 2                  STQ     ACCT+1

     3429    27385    6            FILE.L# = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:484  
  27385 20 012546   300003 474500                    LDP4    3,,PR3
        20 012547   400004 236100                    LDQ     4,,PR4
        20 012550   000033 772000                    QRL     27
        20 012551   000446 552004 2                  STBQ    FILE+7,'04'O

     3430    27386    6            FILE.NAME# = TEMP$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  27386 20 012552   400004 236100                    LDQ     4,,PR4
        20 012553   000033 772000                    QRL     27
        20 012554   000000 623006                    EAX3    0,QL
        20 012555   040000 100540                    MLR     fill='040'O
        20 012556   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
        20 012557   000437 000037 2                  ADSC9   FILE                     cn=0,n=31

     3431    27387    6            END;

     3432    27388    5         END;

     3433    27389
     3434    27390    4      IF ACCT.ACCT# = ' '

  27390 20 012560   040000 106400                    CMPC    fill='040'O
        20 012561   000447 000010 2                  ADSC9   ACCT                     cn=0,n=8
        20 012562   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        20 012563   012571 601000 20                 TNZ     s:27396

     3435    27391    5       THEN DO;

     3436    27392    5         ACCT.ACCT# = B$JIT.FACCN;

  27392 20 012564   000000 473400 xsym               LDP3    B$JIT$
        20 012565   300006 237100                    LDAQ    6,,PR3
        20 012566   000447 755000 2                  STA     ACCT
        20 012567   000450 756000 2                  STQ     ACCT+1

     3437    27393        /*    COMMAND_ERROR = '1'B; */
     3438    27394        /*    CALL FLI$RPT_ERR( E_MUST_ACCT, ); */
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:485  
     3439    27395    5         END;

  27395 20 012570   012577 710000 20                 TRA     s:27398

     3440    27396    4       ELSE IF FIRST_ACCT_SPECIFIED.ACCT# = ' '

  27396 20 012571   000244 237000 2                  LDAQ    FIRST_ACCT_SPECIFIED
        20 012572   000122 117000 21                 CMPAQ   82
        20 012573   012577 601000 20                 TNZ     s:27398

     3441    27397    4          THEN FIRST_ACCT_SPECIFIED.ACCT# = ACCT.ACCT#;

  27397 20 012574   040000 100400                    MLR     fill='040'O
        20 012575   000447 000010 2                  ADSC9   ACCT                     cn=0,n=8
        20 012576   000244 000010 2                  ADSC9   FIRST_ACCT_SPECIFIED     cn=0,n=8

     3442    27398    4      PREV_ACCT = ACCT;

  27398 20 012577   000000 100400                    MLR     fill='000'O
        20 012600   000447 000010 2                  ADSC9   ACCT                     cn=0,n=8
        20 012601   000240 000010 2                  ADSC9   PREV_ACCT                cn=0,n=8

     3443    27399
     3444    27400    4      RETURN;

  27400 20 012602   000001 702211                    TSX2  ! 1,X1

     3445    27401
     3446    27402    4   END FLB_FILE_N_ACCOUNT;
     3447    27403
     3448    27404    3   END FLB_FID_RANGE;
     3449    27405
     3450    27406    2   FLB_ORDER_RANGE: PROC ALTRET;

  27406 20 012603   200032 741300       FLB_ORDER_R* STX1  ! FIRST+1,,AUTO

     3451    27407        /*F*  NAME: FLB_ORDER_RANGE
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:486  
     3452    27408              PURPOSE: Orders file range/skip specifications.
     3453    27409        ***/
     3454    27410
     3455    27411         /***
     3456    27412          *** STATIC
     3457    27413          ***/
     3458    27414
     3459    27415    3   DCL CX SBIN STATIC;
     3460    27416    3   DCL C SBIN STATIC;
     3461    27417    3   DCL I SBIN STATIC;
     3462    27418    3   DCL J SBIN STATIC;
     3463    27419    3   DCL M SBIN STATIC;
     3464    27420    3   DCL I_SWAP SBIN STATIC;
     3465    27421    3   DCL LAST_RANGEX SBIN STATIC;
     3466    27422    3   DCL RANGE_START$ PTR STATIC;
     3467    27423    3   DCL RANGE_STOP$ PTR STATIC;
     3468    27424    3   DCL SKIP_START$ PTR STATIC;
     3469    27425    3   DCL SKIP_STOP$ PTR STATIC;
     3470    27426    3   DCL 1 TEMP_SPEC CHAR(40) STATIC;
     3471    27427    3   DCL RANGE_FOUND BIT(1) STATIC;
     3472    27428
     3473    27429        /***
     3474    27430         *** BASED
     3475    27431         ***/
     3476    27432
     3477    27433    3   DCL RANGE_START CHAR(40) BASED(RANGE_START$);
     3478    27434    3   DCL RANGE_STOP CHAR(40) BASED(RANGE_STOP$);
     3479    27435    3   DCL SKIP_START CHAR(40) BASED(SKIP_START$);
     3480    27436    3   DCL SKIP_STOP CHAR(40) BASED(SKIP_STOP$);
     3481    27437
     3482    27438        /***
     3483    27439         *** CONSTANT
     3484    27440         ***/
     3485    27441
     3486    27442    3   DCL FIRST_LEGAL_CHAR UBIN BYTE CONSTANT INIT(ASCBIN('$'));
     3487    27443    3   DCL LAST_LEGAL_CHAR UBIN BYTE CONSTANT INIT(ASCBIN('z'));
     3488    27444    3   DCL LEGAL_CHAR(0:127) BIT(1) UNAL CONSTANT INIT(
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:487  
     3489    27445    3    '0'B*32, '0'B*4, '1'B, '0'B*8, '1'B, '0'B*2, '1'B*11,
     3490    27446    3    '0'B*6, '1'B*26, '0'B*4, '1'B, '0'B, '1'B*26, '0'B*5 );
     3491    27447
     3492    27448        /*****************************************/
     3493    27449
     3494    27450        /***
     3495    27451         *** If no range or skip, make default structure.
     3496    27452         ***/
     3497    27453
     3498    27454    3      IF NOT RANGE_SPECIFIED AND NOT SKIP_SPECIFIED

  27454 20 012604   000242 234000 2                  SZN     RANGE_SPECIFIED
        20 012605   012622 604000 20                 TMI     s:27469
        20 012606   000243 234000 2                  SZN     SKIP_SPECIFIED
        20 012607   012622 604000 20                 TMI     s:27469

     3499    27455    4       THEN DO;

     3500    27456    4         TEMP = LENGTHW(DISK_FILE_SPEC.NBR)+LENGTHW(DISK_FILE_SPEC.NBR_LEFT)

  27456 20 012610   000032 235007                    LDA     26,DL
        20 012611   000236 755000 2                  STA     TEMP

     3501    27457    4           + LENGTHW(DISK_FILE_SPEC.PASSWORD_SPEC)
     3502    27458    4           + LENGTHW(DISK_FILE_SPEC.PASSWORD#)
     3503    27459    4           + LENGTHW(DISK_FILE_SPEC.SPEC(0)); /* One entry only                  */
     3504    27460    4         CALL FLI$ALLOC( TEMP, DISK_FILE_SPEC$ );

  27460 20 012612   000116 630400 21                 EPPR0   78
        20 012613   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 012614   000000 701000 xent               TSX1    FLI$ALLOC
        20 012615   000000 011000                    NOP     0

     3505    27461    4         DISK_FILE_SPEC.NBR_LEFT = 1;

  27461 20 012616   000001 235007                    LDA     1,DL
        20 012617   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:488  
        20 012620   000001 755100                    STA     1,,PR0

     3506    27462    4         DISK_FILE_SPEC.NBR = 0;

  27462 20 012621   000000 450100                    STZ     0,,PR0

     3507    27463    4         END;

     3508    27464
     3509    27465        /***
     3510    27466         *** Supply default range if none specified.
     3511    27467         ***/
     3512    27468
     3513    27469    3      IF NOT RANGE_SPECIFIED

  27469 20 012622   000242 234000 2                  SZN     RANGE_SPECIFIED
        20 012623   012642 604000 20                 TMI     s:27482

     3514    27470    4       THEN DO;

     3515    27471    4         START_ACCT = FIRST_ACCT;

  27471 20 012624   000000 100400                    MLR     fill='000'O
        20 012625   000000 000010 xsym               ADSC9   FIRST_ACCT               cn=0,n=8
        20 012626   000461 000010 2                  ADSC9   START_ACCT               cn=0,n=8

     3516    27472    4         START_FILE = FIRST_FILE;

  27472 20 012627   000000 100400                    MLR     fill='000'O
        20 012630   000000 000040 xsym               ADSC9   FIRST_FILE               cn=0,n=32
        20 012631   000451 000040 2                  ADSC9   START_FILE               cn=0,n=32

     3517    27473    4         STOP_ACCT = LAST_ACCT;

  27473 20 012632   000000 100400                    MLR     fill='000'O
        20 012633   000000 000010 xsym               ADSC9   LAST_ACCT                cn=0,n=8
        20 012634   000473 000010 2                  ADSC9   STOP_ACCT                cn=0,n=8
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:489  

     3518    27474    4         STOP_FILE = LAST_FILE;

  27474 20 012635   000000 100400                    MLR     fill='000'O
        20 012636   000000 000040 xsym               ADSC9   LAST_FILE                cn=0,n=32
        20 012637   000463 000040 2                  ADSC9   STOP_FILE                cn=0,n=32

     3519    27475    4         CALL FLB_NUTHER_FILE_SPEC;

  27475 20 012640   012127 701000 20                 TSX1    FLB_NUTHER_FILE_SPEC
        20 012641   000000 011000                    NOP     0

     3520    27476    4         END;

     3521    27477
     3522    27478        /***
     3523    27479         *** Order file range specifications.
     3524    27480         ***/
     3525    27481
     3526    27482    3      CALL FLB_SORT_RANGE;

  27482 20 012642   013717 701000 20                 TSX1    FLB_SORT_RANGE
        20 012643   000000 011000                    NOP     0

     3527    27483        /***
     3528    27484         *** Check for any range or skip overlaps.
     3529    27485         ***/
     3530    27486
     3531    27487    3      I = 0;

  27487 20 012644   002331 450000 2                  STZ     I

     3532    27488    4      DO WHILE( I <= DISK_FILE_SPEC.NBR - 2 );

  27488 20 012645   013004 710000 20                 TRA     s:27520

     3533    27489    4         J = I + 1;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:490  

  27489 20 012646   002331 235000 2                  LDA     I
        20 012647   000001 035007                    ADLA    1,DL
        20 012650   002332 755000 2                  STA     J

     3534    27490    4         IF DISK_FILE_SPEC.SPEC.SKIP(I) ~=

  27490 20 012651   002332 236000 2                  LDQ     J
        20 012652   000025 402007                    MPY     21,DL
        20 012653   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 012654   000000 620006                    EAX0    0,QL
        20 012655   002331 236000 2                  LDQ     I
        20 012656   000025 402007                    MPY     21,DL
        20 012657   000005 236106                    LDQ     5,QL,PR0
        20 012660   000005 116110                    CMPQ    5,X0,PR0
        20 012661   012665 600000 20                 TZE     s:27494

     3535    27491    4           DISK_FILE_SPEC.SPEC.SKIP(J)
     3536    27492    4          THEN LAST_RANGEX = I;

  27492 20 012662   002331 235000 2                  LDA     I
        20 012663   002335 755000 2                  STA     LAST_RANGEX
        20 012664   013003 710000 20                 TRA     s:27519

     3537    27493    5          ELSE DO;

     3538    27494    5            IF DISK_FILE_SPEC.SPEC.STOPCHARS(I) >= DISK_FILE_SPEC.SPEC.STARTCHARS(J

  27494 20 012665   002331 236000 2                  LDQ     I
        20 012666   000124 402007                    MPY     84,DL
        20 012667   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 012670   002332 236000 2                  LDQ     J
        20 012671   000124 402007                    MPY     84,DL
        20 012672   200042 235100                    LDA     @MAX_NX+1,,AUTO
        20 012673   040106 106505                    CMPC    fill='040'O
        20 012674   000020 000050                    ADSC9   16,A,PR0                 cn=0,n=40
        20 012675   000006 000050                    ADSC9   6,Q,PR0                  cn=0,n=40
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:491  
        20 012676   013003 602000 20                 TNC     s:27519

     3539    27495    5              )
     3540    27496    6             THEN DO;                      /* Out of order                       */

     3541    27497    6               IF DISK_OPTION.OVERLAP_WARN

  27497 20 012677   000002 236000 xsym               LDQ     DISK_OPTION+2
        20 012700   020000 316003                    CANQ    8192,DU
        20 012701   012764 600000 20                 TZE     s:27512

     3542    27498    7                THEN DO;

     3543    27499    7                  IF DISK_FILE_SPEC.SPEC.SKIP(I) > 0

  27499 20 012702   002331 236000 2                  LDQ     I
        20 012703   000025 402007                    MPY     21,DL
        20 012704   000005 235106                    LDA     5,QL,PR0
        20 012705   012713 604400 20                 TMOZ    s:27501

     3544    27500    7                   THEN CALL FLI$RPT_ERR( E_WARN_OVERLAP_SKIP, );

  27500 20 012706   000163 630400 21                 EPPR0   115
        20 012707   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 012710   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 012711   000000 011000                    NOP     0
        20 012712   012717 710000 20                 TRA     s:27502

     3545    27501    7                   ELSE CALL FLI$RPT_ERR( E_WARN_OVERLAP_RANGE, );

  27501 20 012713   000164 630400 21                 EPPR0   116
        20 012714   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 012715   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 012716   000000 011000                    NOP     0

     3546    27502    7                 IF DISK_FILE_SPEC.SPEC.STOPCHARS(I) < DISK_FILE_SPEC.SPEC.STOPCHARS(J
             27502                           )
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:492  

  27502 20 012717   002331 236000 2                  LDQ     I
        20 012720   000124 402007                    MPY     84,DL
        20 012721   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 012722   002332 236000 2                  LDQ     J
        20 012723   000124 402007                    MPY     84,DL
        20 012724   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 012725   200042 235100                    LDA     @MAX_NX+1,,AUTO
        20 012726   040106 106505                    CMPC    fill='040'O
        20 012727   000020 000050                    ADSC9   16,A,PR0                 cn=0,n=40
        20 012730   000020 000050                    ADSC9   16,Q,PR0                 cn=0,n=40
        20 012731   012741 603000 20                 TRC     s:27505

     3547    27503    7                   THEN               /* Change first range's stop to second's   */
     3548    27504    7                    DISK_FILE_SPEC.SPEC.STOPCHARS(I) = DISK_FILE_SPEC.SPEC.STOPCHARS(J
             27504                              );

  27504 20 012732   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 012733   002331 236000 2                  LDQ     I
        20 012734   000124 402007                    MPY     84,DL
        20 012735   200042 235100                    LDA     @MAX_NX+1,,AUTO
        20 012736   040106 100505                    MLR     fill='040'O
        20 012737   000020 000050                    ADSC9   16,A,PR0                 cn=0,n=40
        20 012740   000020 000050                    ADSC9   16,Q,PR0                 cn=0,n=40

     3549    27505    8                  DO J=I+2 TO DISK_FILE_SPEC.NBR - 1;

  27505 20 012741   002331 235000 2                  LDA     I
        20 012742   000002 035007                    ADLA    2,DL
        20 012743   002332 755000 2                  STA     J
        20 012744   012754 710000 20                 TRA     s:27507+1

     3550    27506    8                     DISK_FILE_SPEC.SPECCHARS(J-1) = DISK_FILE_SPEC.SPECCHARS(J);

  27506 20 012745   002332 236000 2                  LDQ     J
        20 012746   000124 402007                    MPY     84,DL
        20 012747   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:493  
        20 012750   040106 100506                    MLR     fill='040'O
        20 012751   000005 000124                    ADSC9   5,Q,PR0                  cn=0,n=84
        20 012752   077760 000124                    ADSC9   -16,Q,PR0                cn=0,n=84

     3551    27507    8                     END;

  27507 20 012753   002332 054000 2                  AOS     J
        20 012754   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 012755   002332 236000 2                  LDQ     J
        20 012756   000000 116100                    CMPQ    0,,PR0
        20 012757   012745 604000 20                 TMI     s:27506

     3552    27508    7                  I = I - 1;

  27508 20 012760   000001 336007                    LCQ     1,DL
        20 012761   002331 056000 2                  ASQ     I

     3553    27509    7                  DISK_FILE_SPEC.NBR = DISK_FILE_SPEC.NBR - 1;

  27509 20 012762   000000 056100                    ASQ     0,,PR0

     3554    27510    7                  END;

  27510 20 012763   013003 710000 20                 TRA     s:27519

     3555    27511    7                ELSE DO;

     3556    27512    7                  IF DISK_FILE_SPEC.SPEC.SKIP(I) > 0

  27512 20 012764   002331 236000 2                  LDQ     I
        20 012765   000025 402007                    MPY     21,DL
        20 012766   000005 235106                    LDA     5,QL,PR0
        20 012767   012775 604400 20                 TMOZ    s:27514

     3557    27513    7                   THEN CALL FLI$RPT_ERR( E_OVERLAP_SKIP, );

  27513 20 012770   000165 630400 21                 EPPR0   117
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:494  
        20 012771   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 012772   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 012773   000000 011000                    NOP     0
        20 012774   013001 710000 20                 TRA     s:27515

     3558    27514    7                   ELSE CALL FLI$RPT_ERR( E_OVERLAP_RANGE, );

  27514 20 012775   000166 630400 21                 EPPR0   118
        20 012776   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 012777   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 013000   000000 011000                    NOP     0

     3559    27515    7                  COMMAND_ERROR = '1'B;

  27515 20 013001   400000 236003                    LDQ     -131072,DU
        20 013002   000000 756000 xsym               STQ     COMMAND_ERROR

     3560    27516    7                  END;

     3561    27517    6               END;

     3562    27518    5            END;

     3563    27519    4         I = I + 1;

  27519 20 013003   002331 054000 2                  AOS     I

     3564    27520    4         END;

  27520 20 013004   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 013005   000000 236100                    LDQ     0,,PR0
        20 013006   000002 136007                    SBLQ    2,DL
        20 013007   002331 116000 2                  CMPQ    I
        20 013010   012646 605000 20                 TPL     s:27489

     3565    27521
     3566    27522        /***
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:495  
     3567    27523         *** Rearrange ranges by eliminating skips.
     3568    27524         ***/
     3569    27525
     3570    27526    3      IF NOT SKIP_SPECIFIED

  27526 20 013011   000243 234000 2                  SZN     SKIP_SPECIFIED
        20 013012   013021 604000 20                 TMI     s:27533

     3571    27527    4       THEN DO;

     3572    27528    4         IF COMMAND_ERROR

  27528 20 013013   000000 234000 xsym               SZN     COMMAND_ERROR
        20 013014   013017 605000 20                 TPL     s:27530

     3573    27529    4          THEN ALTRETURN;

  27529 20 013015   200032 221300                    LDX1  ! FIRST+1,,AUTO
        20 013016   000000 702211                    TSX2  ! 0,X1

     3574    27530    4          ELSE RETURN;

  27530 20 013017   200032 221300                    LDX1  ! FIRST+1,,AUTO
        20 013020   000001 702211                    TSX2  ! 1,X1

     3575    27531    4         END;
     3576    27532
     3577    27533    3      M = DISK_FILE_SPEC.NBR - 1;

  27533 20 013021   000000 235100                    LDA     0,,PR0
        20 013022   000001 135007                    SBLA    1,DL
        20 013023   002333 755000 2                  STA     M

     3578    27534    4      DO WHILE( M > LAST_RANGEX );         /* For each skip specification        */

  27534 20 013024   002333 236000 2                  LDQ     M
        20 013025   002335 116000 2                  CMPQ    LAST_RANGEX
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:496  
        20 013026   013316 604400 20                 TMOZ    s:27613

     3579    27535
     3580    27536    4         I = 0;

  27536 20 013027   002331 450000 2                  STZ     I

     3581    27537    4         RANGE_FOUND = '0'B;

  27537 20 013030   002354 450000 2                  STZ     RANGE_FOUND

     3582    27538    5         DO WHILE( I <= LAST_RANGEX AND NOT RANGE_FOUND );

  27538 20 013031   013274 710000 20                 TRA     s:27600

     3583    27539    5            RANGE_STOP$ = ADDR(DISK_FILE_SPEC.SPEC.STOPCHARS(I));

  27539 20 013032   002331 236000 2                  LDQ     I
        20 013033   000025 402003                    MPY     21,DU
        20 013034   000020 036003                    ADLQ    16,DU
        20 013035   000000 036000 xsym               ADLQ    DISK_FILE_SPEC$
        20 013036   002337 756000 2                  STQ     RANGE_STOP$

     3584    27540    5            SKIP_START$ = ADDR(DISK_FILE_SPEC.SPEC.STARTCHARS(M));

  27540 20 013037   002333 236000 2                  LDQ     M
        20 013040   000025 402003                    MPY     21,DU
        20 013041   000006 036003                    ADLQ    6,DU
        20 013042   000000 036000 xsym               ADLQ    DISK_FILE_SPEC$
        20 013043   002340 756000 2                  STQ     SKIP_START$

     3585    27541
     3586    27542    5            IF RANGE_STOP >= SKIP_START

  27542 20 013044   002337 470400 2                  LDP0    RANGE_STOP$
        20 013045   002340 471400 2                  LDP1    SKIP_START$
        20 013046   040100 106500                    CMPC    fill='040'O
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:497  
        20 013047   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40
        20 013050   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40
        20 013051   013273 602000 20                 TNC     s:27599

     3587    27543    6             THEN DO;                      /* Skip must be within this range     */

     3588    27544    6               RANGE_FOUND = '1'B;

  27544 20 013052   400000 236003                    LDQ     -131072,DU
        20 013053   002354 756000 2                  STQ     RANGE_FOUND

     3589    27545    6               RANGE_START$ = ADDR(DISK_FILE_SPEC.SPEC.STARTCHARS(I));

  27545 20 013054   002331 236000 2                  LDQ     I
        20 013055   000025 402003                    MPY     21,DU
        20 013056   000006 036003                    ADLQ    6,DU
        20 013057   000000 036000 xsym               ADLQ    DISK_FILE_SPEC$
        20 013060   002336 756000 2                  STQ     RANGE_START$

     3590    27546    6               SKIP_STOP$ = ADDR(DISK_FILE_SPEC.SPEC.STOPCHARS(M));

  27546 20 013061   002333 236000 2                  LDQ     M
        20 013062   000025 402003                    MPY     21,DU
        20 013063   000020 036003                    ADLQ    16,DU
        20 013064   000000 036000 xsym               ADLQ    DISK_FILE_SPEC$
        20 013065   002341 756000 2                  STQ     SKIP_STOP$

     3591    27547    6               IF RANGE_STOP < SKIP_STOP

  27547 20 013066   002341 473400 2                  LDP3    SKIP_STOP$
        20 013067   040100 106500                    CMPC    fill='040'O
        20 013070   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40
        20 013071   300000 000050                    ADSC9   0,,PR3                   cn=0,n=40
        20 013072   013100 602000 20                 TNC     s:27550
        20 013073   002336 474400 2                  LDP4    RANGE_START$
        20 013074   040100 106500                    CMPC    fill='040'O
        20 013075   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:498  
        20 013076   400000 000050                    ADSC9   0,,PR4                   cn=0,n=40
        20 013077   013107 603000 20                 TRC     s:27554

     3592    27548    6                 OR RANGE_START > SKIP_START
     3593    27549    7                THEN DO;         /* Skip is not wholly contained within a range  */

     3594    27550    7                  COMMAND_ERROR = '1'B;

  27550 20 013100   400000 236003                    LDQ     -131072,DU
        20 013101   000000 756000 xsym               STQ     COMMAND_ERROR

     3595    27551    7                  CALL FLI$RPT_ERR( E_BAD_SKIP_N_RANGE, );

  27551 20 013102   000167 630400 21                 EPPR0   119
        20 013103   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 013104   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 013105   000000 011000                    NOP     0

     3596    27552    7                  END;

  27552 20 013106   013273 710000 20                 TRA     s:27599

     3597    27553    7                ELSE DO;

     3598    27554    7                  IF RANGE_START < SKIP_START

  27554 20 013107   013222 602000 20                 TNC     s:27581
        20 013110   013222 600000 20                 TZE     s:27581

     3599    27555    8                   THEN DO;           /* At least one new range should be formed */

     3600    27556    8                     IF RANGE_STOP > SKIP_STOP

  27556 20 013111   040100 106500                    CMPC    fill='040'O
        20 013112   300000 000050                    ADSC9   0,,PR3                   cn=0,n=40
        20 013113   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40
        20 013114   013205 603000 20                 TRC     s:27575
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:499  

     3601    27557    9                      THEN DO;             /* Two new ranges!                    */

     3602    27558    9                        CALL FLB_PREV_SPEC( SKIP_START );

  27558 20 013115   002340 236000 2                  LDQ     SKIP_START$
        20 013116   200035 756100                    STQ     @FILE_N_ACCOUNT$,,AUTO
        20 013117   013414 701000 20                 TSX1    FLB_PREV_SPEC
        20 013120   000000 011000                    NOP     0

     3603    27559    9                        CALL FLB_NEXT_SPEC( SKIP_STOP );

  27559 20 013121   002341 236000 2                  LDQ     SKIP_STOP$
        20 013122   200035 756100                    STQ     @FILE_N_ACCOUNT$,,AUTO
        20 013123   013331 701000 20                 TSX1    FLB_NEXT_SPEC
        20 013124   000000 011000                    NOP     0

     3604    27560    9                        TEMP_SPEC = RANGE_STOP;

  27560 20 013125   002337 470400 2                  LDP0    RANGE_STOP$
        20 013126   040000 100500                    MLR     fill='040'O
        20 013127   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40
        20 013130   002342 000050 2                  ADSC9   TEMP_SPEC                cn=0,n=40

     3605    27561    9                        RANGE_STOP = SKIP_START;

  27561 20 013131   002340 471400 2                  LDP1    SKIP_START$
        20 013132   040100 100500                    MLR     fill='040'O
        20 013133   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40
        20 013134   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40

     3606    27562    9                        SKIP_START = SKIP_STOP;

  27562 20 013135   002341 473400 2                  LDP3    SKIP_STOP$
        20 013136   040100 100500                    MLR     fill='040'O
        20 013137   300000 000050                    ADSC9   0,,PR3                   cn=0,n=40
        20 013140   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:500  

     3607    27563    9                        SKIP_STOP = TEMP_SPEC;

  27563 20 013141   040100 100400                    MLR     fill='040'O
        20 013142   002342 000050 2                  ADSC9   TEMP_SPEC                cn=0,n=40
        20 013143   300000 000050                    ADSC9   0,,PR3                   cn=0,n=40

     3608    27564    9                        DISK_FILE_SPEC.SPEC.SKIP(M) = 0;

  27564 20 013144   002333 236000 2                  LDQ     M
        20 013145   000025 402007                    MPY     21,DL
        20 013146   000000 474400 xsym               LDP4    DISK_FILE_SPEC$
        20 013147   400005 450106                    STZ     5,QL,PR4

     3609    27565                                                /* Use as range instead of skip now   */
     3610    27566    9                        SPECCHARS = DISK_FILE_SPEC.SPECCHARS(M);

  27566 20 013150   002333 236000 2                  LDQ     M
        20 013151   000124 402007                    MPY     84,DL
        20 013152   000000 474400 xsym               LDP4    DISK_FILE_SPEC$
        20 013153   040000 100506                    MLR     fill='040'O
        20 013154   400005 000124                    ADSC9   5,Q,PR4                  cn=0,n=84
        20 013155   000000 000124 xsym               ADSC9   SPECCHARS                cn=0,n=84

     3611    27567   10                        DO J = M DOWNTO I+1 BY -1;

  27567 20 013156   002333 235000 2                  LDA     M
        20 013157   002332 755000 2                  STA     J
        20 013160   013171 710000 20                 TRA     s:27569+2

     3612    27568   10                          DISK_FILE_SPEC.SPECCHARS(J) = DISK_FILE_SPEC.SPECCHARS(J-1);

  27568 20 013161   002332 236000 2                  LDQ     J
        20 013162   000124 402007                    MPY     84,DL
        20 013163   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 013164   040106 100506                    MLR     fill='040'O
        20 013165   077760 000124                    ADSC9   -16,Q,PR0                cn=0,n=84
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:501  
        20 013166   000005 000124                    ADSC9   5,Q,PR0                  cn=0,n=84

     3613    27569   10                           END;

  27569 20 013167   000001 336007                    LCQ     1,DL
        20 013170   002332 056000 2                  ASQ     J
        20 013171   002332 236000 2                  LDQ     J
        20 013172   002331 116000 2                  CMPQ    I
        20 013173   013161 605400 20                 TPNZ    s:27568

     3614    27570    9                        DISK_FILE_SPEC.SPECCHARS(I+1) = SPECCHARS;

  27570 20 013174   002331 236000 2                  LDQ     I
        20 013175   000124 402007                    MPY     84,DL
        20 013176   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 013177   040106 100400                    MLR     fill='040'O
        20 013200   000000 000124 xsym               ADSC9   SPECCHARS                cn=0,n=84
        20 013201   000032 000124                    ADSC9   26,Q,PR0                 cn=0,n=84

     3615    27571    9                        LAST_RANGEX = LAST_RANGEX + 1;

  27571 20 013202   002335 054000 2                  AOS     LAST_RANGEX

     3616    27572    9                        M = M + 1;

  27572 20 013203   002333 054000 2                  AOS     M

     3617    27573    9                        END;

  27573 20 013204   013273 710000 20                 TRA     s:27599

     3618    27574    9                      ELSE DO;             /* Only one new range                 */

     3619    27575    9                        CALL FLB_PREV_SPEC( SKIP_START );

  27575 20 013205   002340 236000 2                  LDQ     SKIP_START$
        20 013206   200035 756100                    STQ     @FILE_N_ACCOUNT$,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:502  
        20 013207   013414 701000 20                 TSX1    FLB_PREV_SPEC
        20 013210   000000 011000                    NOP     0

     3620    27576    9                        RANGE_STOP = SKIP_START;

  27576 20 013211   002340 470400 2                  LDP0    SKIP_START$
        20 013212   002337 471400 2                  LDP1    RANGE_STOP$
        20 013213   040100 100500                    MLR     fill='040'O
        20 013214   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40
        20 013215   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

     3621    27577    9                        DISK_FILE_SPEC.NBR = DISK_FILE_SPEC.NBR - 1;

  27577 20 013216   000000 473400 xsym               LDP3    DISK_FILE_SPEC$
        20 013217   000001 336007                    LCQ     1,DL
        20 013220   300000 056100                    ASQ     0,,PR3

     3622    27578    9                        END;

     3623    27579    8                     END;

  27579 20 013221   013273 710000 20                 TRA     s:27599

     3624    27580    8                   ELSE DO;

     3625    27581    8                     IF RANGE_STOP > SKIP_STOP

  27581 20 013222   040100 106500                    CMPC    fill='040'O
        20 013223   300000 000050                    ADSC9   0,,PR3                   cn=0,n=40
        20 013224   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40
        20 013225   013242 603000 20                 TRC     s:27588

     3626    27582    9                      THEN DO;             /* One new range                      */

     3627    27583    9                        CALL FLB_NEXT_SPEC( SKIP_STOP );

  27583 20 013226   200035 756100                    STQ     @FILE_N_ACCOUNT$,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:503  
        20 013227   013331 701000 20                 TSX1    FLB_NEXT_SPEC
        20 013230   000000 011000                    NOP     0

     3628    27584    9                        RANGE_START = SKIP_STOP;

  27584 20 013231   002341 470400 2                  LDP0    SKIP_STOP$
        20 013232   002336 471400 2                  LDP1    RANGE_START$
        20 013233   040100 100500                    MLR     fill='040'O
        20 013234   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40
        20 013235   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

     3629    27585    9                        DISK_FILE_SPEC.NBR = DISK_FILE_SPEC.NBR - 1;

  27585 20 013236   000000 473400 xsym               LDP3    DISK_FILE_SPEC$
        20 013237   000001 336007                    LCQ     1,DL
        20 013240   300000 056100                    ASQ     0,,PR3

     3630    27586    9                        END;

  27586 20 013241   013273 710000 20                 TRA     s:27599

     3631    27587    9                      ELSE DO;             /* Skip eliminated range              */

     3632    27588    9                        DISK_FILE_SPEC.SPEC.SKIP(I) = 1;

  27588 20 013242   002331 236000 2                  LDQ     I
        20 013243   000025 402007                    MPY     21,DL
        20 013244   000001 235007                    LDA     1,DL
        20 013245   000000 475400 xsym               LDP5    DISK_FILE_SPEC$
        20 013246   500005 755106                    STA     5,QL,PR5

     3633    27589   10                        DO J=I TO M - 2;

  27589 20 013247   002331 235000 2                  LDA     I
        20 013250   002332 755000 2                  STA     J
        20 013251   013261 710000 20                 TRA     s:27591+1

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:504  
     3634    27590   10                          DISK_FILE_SPEC.SPECCHARS(J) = DISK_FILE_SPEC.SPECCHARS(J+1);

  27590 20 013252   002332 236000 2                  LDQ     J
        20 013253   000124 402007                    MPY     84,DL
        20 013254   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 013255   040106 100506                    MLR     fill='040'O
        20 013256   000032 000124                    ADSC9   26,Q,PR0                 cn=0,n=84
        20 013257   000005 000124                    ADSC9   5,Q,PR0                  cn=0,n=84

     3635    27591   10                           END;

  27591 20 013260   002332 054000 2                  AOS     J
        20 013261   002333 236000 2                  LDQ     M
        20 013262   000002 136007                    SBLQ    2,DL
        20 013263   002332 116000 2                  CMPQ    J
        20 013264   013252 605000 20                 TPL     s:27590

     3636    27592    9                        DISK_FILE_SPEC.NBR = DISK_FILE_SPEC.NBR - 2;

  27592 20 013265   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 013266   000002 336007                    LCQ     2,DL
        20 013267   000000 056100                    ASQ     0,,PR0

     3637    27593    9                        M = M - 1;

  27593 20 013270   000001 336007                    LCQ     1,DL
        20 013271   002333 056000 2                  ASQ     M

     3638    27594    9                        LAST_RANGEX = LAST_RANGEX - 1;

  27594 20 013272   002335 056000 2                  ASQ     LAST_RANGEX

     3639    27595    9                        END;

     3640    27596    8                     END;

     3641    27597    7                  END;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:505  

     3642    27598    6               END;

     3643    27599    5            I = I + 1;

  27599 20 013273   002331 054000 2                  AOS     I

     3644    27600    5            END;

  27600 20 013274   002331 236000 2                  LDQ     I
        20 013275   002335 116000 2                  CMPQ    LAST_RANGEX
        20 013276   013301 605400 20                 TPNZ    s:27601
        20 013277   002354 234000 2                  SZN     RANGE_FOUND
        20 013300   013032 605000 20                 TPL     s:27539

     3645    27601    4         IF NOT RANGE_FOUND

  27601 20 013301   002354 234000 2                  SZN     RANGE_FOUND
        20 013302   013311 604000 20                 TMI     s:27606

     3646    27602    5          THEN DO;                         /* Skip not within any range          */

     3647    27603    5            COMMAND_ERROR = '1'B;

  27603 20 013303   400000 236003                    LDQ     -131072,DU
        20 013304   000000 756000 xsym               STQ     COMMAND_ERROR

     3648    27604    5            CALL FLI$RPT_ERR( E_BAD_SKIP_N_RANGE, );

  27604 20 013305   000167 630400 21                 EPPR0   119
        20 013306   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 013307   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 013310   000000 011000                    NOP     0

     3649    27605    5            END;

     3650    27606    4         M = M - 1;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:506  

  27606 20 013311   000001 336007                    LCQ     1,DL
        20 013312   002333 056000 2                  ASQ     M

     3651    27607    4         END;

  27607 20 013313   002333 236000 2                  LDQ     M
        20 013314   002335 116000 2                  CMPQ    LAST_RANGEX
        20 013315   013027 605400 20                 TPNZ    s:27536

     3652    27608
     3653    27609        /***
     3654    27610         *** If no ranges left, no files have been specified.
     3655    27611         ***/
     3656    27612
     3657    27613    3      IF DISK_FILE_SPEC.NBR <= 0

  27613 20 013316   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 013317   000000 235100                    LDA     0,,PR0
        20 013320   013327 605400 20                 TPNZ    s:27619

     3658    27614    4       THEN DO;

     3659    27615    4         COMMAND_ERROR = '1'B;

  27615 20 013321   400000 236003                    LDQ     -131072,DU
        20 013322   000000 756000 xsym               STQ     COMMAND_ERROR

     3660    27616    4         CALL FLI$RPT_ERR( E_NO_RANGE, );

  27616 20 013323   000170 630400 21                 EPPR0   120
        20 013324   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 013325   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 013326   000000 011000                    NOP     0

     3661    27617    4         END;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:507  
     3662    27618
     3663    27619    3      RETURN;

  27619 20 013327   200032 221300                    LDX1  ! FIRST+1,,AUTO
        20 013330   000001 702211                    TSX2  ! 1,X1

     3664    27620
     3665    27621    3   FLB_NEXT_SPEC: PROC( SPEC );

  27621 20 013331   200034 741300       FLB_NEXT_SP* STX1  ! DISK_OPTION_PAD_SAVE+1,,AUTO

     3666    27622        /*F* NAME: FLB_NEXT_SPEC
     3667    27623             PURPOSE: Calculates next acct/file specification.
     3668    27624        */
     3669    27625
     3670    27626    4   DCL 1 SPEC,
     3671    27627    4         2 ACCT# CHAR(8),
     3672    27628    4         2 ACCTB(0:7) REDEF ACCT# UBIN BYTE CALIGNED,
     3673    27629    4         2 FILE,
     3674    27630    4           3 NAME# CHAR(31) CALIGNED,
     3675    27631    4           3 L# UBIN BYTE CALIGNED;
     3676    27632
     3677    27633        /***
     3678    27634         *** STATIC
     3679    27635         ***/
     3680    27636
     3681    27637    4   DCL N SBIN STATIC;
     3682    27638
     3683    27639        /****************************************/
     3684    27640
     3685    27641    4      N = SPEC.FILE.L#;

  27641 20 013332   200035 470500                    LDP0    @SPEC,,AUTO
        20 013333   000000 101500                    MRL     fill='000'O
        20 013334   000011 600001                    ADSC9   9,,PR0                   cn=3,n=1
        20 013335   002355 000004 2                  ADSC9   N                        cn=0,n=4

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:508  
     3686    27642    4      CALL FLB_NEXT( SPEC.FILE, N, LENGTHV(SPEC.FILE.NAME#) )

  27642 20 013336   000172 237000 21                 LDAQ    122
        20 013337   200040 757100                    STAQ    @NAMEB+1,,AUTO
        20 013340   200035 236100                    LDQ     @SPEC,,AUTO
        20 013341   000002 036003                    ADLQ    2,DU
        20 013342   200037 756100                    STQ     @DATEFIELD,,AUTO
        20 013343   013477 701000 20                 TSX1    FLB_NEXT
        20 013344   013352 702000 20                 TSX2    s:27647

     3687    27643    5       WHENRETURN DO;                      /* Get a next file name               */

     3688    27644    5         SPEC.FILE.L# = N;

  27644 20 013345   200035 470500                    LDP0    @SPEC,,AUTO
        20 013346   000100 101400                    MRL     fill='000'O
        20 013347   002355 000004 2                  ADSC9   N                        cn=0,n=4
        20 013350   000011 600001                    ADSC9   9,,PR0                   cn=3,n=1

     3689    27645    5         END;

  27645 20 013351   013412 710000 20                 TRA     s:27659

     3690    27646    5       WHENALTRETURN DO;

     3691    27647    5         SPEC.FILE.L# = N;

  27647 20 013352   200035 470500                    LDP0    @SPEC,,AUTO
        20 013353   000100 101400                    MRL     fill='000'O
        20 013354   002355 000004 2                  ADSC9   N                        cn=0,n=4
        20 013355   000011 600001                    ADSC9   9,,PR0                   cn=3,n=1

     3692    27648    5         N = LENGTHV(SPEC.ACCT#);

  27648 20 013356   000007 235007                    LDA     7,DL
        20 013357   002355 755000 2                  STA     N

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:509  
     3693    27649    6         DO WHILE( N >= 0 AND SPEC.ACCTB(N) = ASCBIN(' ') );

  27649 20 013360   013363 710000 20                 TRA     s:27651

     3694    27650    6            N = N - 1;

  27650 20 013361   000001 336007                    LCQ     1,DL
        20 013362   002355 056000 2                  ASQ     N

     3695    27651    6            END;

  27651 20 013363   002355 235000 2                  LDA     N
        20 013364   013374 604000 20                 TMI     s:27652
        20 013365   200035 470500                    LDP0    @SPEC,,AUTO
        20 013366   000100 101505                    MRL     fill='000'O
        20 013367   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        20 013370   200042 000004                    ADSC9   @MAX_NX+1,,AUTO          cn=0,n=4
        20 013371   200042 236100                    LDQ     @MAX_NX+1,,AUTO
        20 013372   000040 116007                    CMPQ    32,DL
        20 013373   013361 600000 20                 TZE     s:27650

     3696    27652    5         N = N + 1;

  27652 20 013374   002355 054000 2                  AOS     N

     3697    27653    5         CALL FLB_NEXT( SPEC.ACCT#, N, LENGTHV(SPEC.ACCT#) )

  27653 20 013375   000174 237000 21                 LDAQ    124
        20 013376   200040 757100                    STAQ    @NAMEB+1,,AUTO
        20 013377   200035 236100                    LDQ     @SPEC,,AUTO
        20 013400   200037 756100                    STQ     @DATEFIELD,,AUTO
        20 013401   013477 701000 20                 TSX1    FLB_NEXT
        20 013402   013404 702000 20                 TSX2    s:27655
        20 013403   013412 710000 20                 TRA     s:27659

     3698    27654    6          WHENALTRETURN DO;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:510  
     3699    27655    6            COMMAND_ERROR = '1'B;

  27655 20 013404   400000 236003                    LDQ     -131072,DU
        20 013405   000000 756000 xsym               STQ     COMMAND_ERROR

     3700    27656    6            CALL FLI$RPT_ERR( E_NO_NEXT_SPEC, );

  27656 20 013406   000176 630400 21                 EPPR0   126
        20 013407   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 013410   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 013411   000000 011000                    NOP     0

     3701    27657    6            END;

     3702    27658    5         END;

     3703    27659    4      RETURN;

  27659 20 013412   200034 221300                    LDX1  ! DISK_OPTION_PAD_SAVE+1,,AUTO
        20 013413   000001 702211                    TSX2  ! 1,X1

     3704    27660
     3705    27661    4   END FLB_NEXT_SPEC;
     3706    27662        /********************************************************************/
     3707    27663    3   FLB_PREV_SPEC: PROC( SPEC );

  27663 20 013414   200034 741300       FLB_PREV_SP* STX1  ! DISK_OPTION_PAD_SAVE+1,,AUTO

     3708    27664        /*F* NAME: FLB_PREV_SPEC
     3709    27665             PURPOSE: Calculates previous acct/file specification.
     3710    27666        */
     3711    27667
     3712    27668    4   DCL 1 SPEC,
     3713    27669    4         2 ACCT# CHAR(8),
     3714    27670    4         2 ACCTB(0:7) REDEF ACCT# UBIN BYTE CALIGNED,
     3715    27671    4         2 FILE,
     3716    27672    4           3 NAME# CHAR(31) CALIGNED,
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:511  
     3717    27673    4           3 L# UBIN BYTE CALIGNED;
     3718    27674
     3719    27675        /***
     3720    27676         *** STATIC
     3721    27677         ***/
     3722    27678
     3723    27679    4   DCL N SBIN STATIC;
     3724    27680
     3725    27681        /****************************************/
     3726    27682
     3727    27683    4      N = SPEC.FILE.L#;

  27683 20 013415   200035 470500                    LDP0    @SPEC,,AUTO
        20 013416   000000 101500                    MRL     fill='000'O
        20 013417   000011 600001                    ADSC9   9,,PR0                   cn=3,n=1
        20 013420   002356 000004 2                  ADSC9   N                        cn=0,n=4

     3728    27684    4      CALL FLB_PREV( SPEC.FILE, N, LENGTHV(SPEC.FILE.NAME#) )

  27684 20 013421   000200 237000 21                 LDAQ    128
        20 013422   200040 757100                    STAQ    @NAMEB+1,,AUTO
        20 013423   200035 236100                    LDQ     @SPEC,,AUTO
        20 013424   000002 036003                    ADLQ    2,DU
        20 013425   200037 756100                    STQ     @DATEFIELD,,AUTO
        20 013426   013601 701000 20                 TSX1    FLB_PREV
        20 013427   013435 702000 20                 TSX2    s:27689

     3729    27685    5       WHENRETURN DO;                      /* Get a previous file name           */

     3730    27686    5         SPEC.FILE.L# = N;

  27686 20 013430   200035 470500                    LDP0    @SPEC,,AUTO
        20 013431   000100 101400                    MRL     fill='000'O
        20 013432   002356 000004 2                  ADSC9   N                        cn=0,n=4
        20 013433   000011 600001                    ADSC9   9,,PR0                   cn=3,n=1

     3731    27687    5         END;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:512  

  27687 20 013434   013475 710000 20                 TRA     s:27701

     3732    27688    5       WHENALTRETURN DO;

     3733    27689    5         SPEC.FILE.L# = N;

  27689 20 013435   200035 470500                    LDP0    @SPEC,,AUTO
        20 013436   000100 101400                    MRL     fill='000'O
        20 013437   002356 000004 2                  ADSC9   N                        cn=0,n=4
        20 013440   000011 600001                    ADSC9   9,,PR0                   cn=3,n=1

     3734    27690    5         N = LENGTHV(SPEC.ACCT#);

  27690 20 013441   000007 235007                    LDA     7,DL
        20 013442   002356 755000 2                  STA     N

     3735    27691    6         DO WHILE( N >= 0 AND SPEC.ACCTB(N) = ASCBIN(' ') );

  27691 20 013443   013446 710000 20                 TRA     s:27693

     3736    27692    6            N = N - 1;

  27692 20 013444   000001 336007                    LCQ     1,DL
        20 013445   002356 056000 2                  ASQ     N

     3737    27693    6            END;

  27693 20 013446   002356 235000 2                  LDA     N
        20 013447   013457 604000 20                 TMI     s:27694
        20 013450   200035 470500                    LDP0    @SPEC,,AUTO
        20 013451   000100 101505                    MRL     fill='000'O
        20 013452   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        20 013453   200042 000004                    ADSC9   @MAX_NX+1,,AUTO          cn=0,n=4
        20 013454   200042 236100                    LDQ     @MAX_NX+1,,AUTO
        20 013455   000040 116007                    CMPQ    32,DL
        20 013456   013444 600000 20                 TZE     s:27692
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:513  

     3738    27694    5         N = N + 1;

  27694 20 013457   002356 054000 2                  AOS     N

     3739    27695    5         CALL FLB_PREV( SPEC.ACCT#, N, LENGTHV(SPEC.ACCT#) )

  27695 20 013460   000202 237000 21                 LDAQ    130
        20 013461   200040 757100                    STAQ    @NAMEB+1,,AUTO
        20 013462   200035 236100                    LDQ     @SPEC,,AUTO
        20 013463   200037 756100                    STQ     @DATEFIELD,,AUTO
        20 013464   013601 701000 20                 TSX1    FLB_PREV
        20 013465   013467 702000 20                 TSX2    s:27697
        20 013466   013475 710000 20                 TRA     s:27701

     3740    27696    6          WHENALTRETURN DO;

     3741    27697    6            COMMAND_ERROR = '1'B;

  27697 20 013467   400000 236003                    LDQ     -131072,DU
        20 013470   000000 756000 xsym               STQ     COMMAND_ERROR

     3742    27698    6            CALL FLI$RPT_ERR( E_NO_PREV_SPEC, );

  27698 20 013471   000204 630400 21                 EPPR0   132
        20 013472   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 013473   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 013474   000000 011000                    NOP     0

     3743    27699    6            END;

     3744    27700    5         END;

     3745    27701    4      RETURN;

  27701 20 013475   200034 221300                    LDX1  ! DISK_OPTION_PAD_SAVE+1,,AUTO
        20 013476   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:514  

     3746    27702
     3747    27703    4   END FLB_PREV_SPEC;
     3748    27704        /********************************************************************/
     3749    27705
     3750    27706    3   FLB_NEXT: PROC( NAMEB, N, MAX_NX ) ALTRET;

  27706 20 013477   200036 741300       FLB_NEXT     STX1  ! @RANGE,,AUTO

     3751    27707        /*F* NAME: FLB_NEXT
     3752    27708             PURPOSE: Determine the next valid name.
     3753    27709        */
     3754    27710
     3755    27711    4   DCL NAMEB(0:0) UBIN BYTE CALIGNED;
     3756    27712    4   DCL N SBIN;
     3757    27713    4   DCL MAX_NX SBIN;
     3758    27714
     3759    27715        /****************************************/
     3760    27716
     3761    27717    4      CX = N - 1;                          /* Index of last character            */

  27717 20 013500   200040 470500                    LDP0    @N,,AUTO
        20 013501   000000 235100                    LDA     0,,PR0
        20 013502   000001 135007                    SBLA    1,DL
        20 013503   002327 755000 2                  STA     CX

     3762    27718
     3763    27719    4      IF CX < MAX_NX

  27719 20 013504   200041 471500                    LDP1    @MAX_NX,,AUTO
        20 013505   002327 236000 2                  LDQ     CX
        20 013506   100000 116100                    CMPQ    0,,PR1
        20 013507   013520 605000 20                 TPL     s:27726

     3764    27720    5       THEN DO;             /* Make legal name by appending first legal char     */

     3765    27721    5         NAMEB(CX+1) = FIRST_LEGAL_CHAR;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:515  

  27721 20 013510   200037 473500                    LDP3    @NAMEB,,AUTO
        20 013511   000106 100400                    MLR     fill='000'O
        20 013512   000054 000001 19                 ADSC9   FIRST_LEGAL_CHAR         cn=0,n=1
        20 013513   300000 200001                    ADSC9   0,Q,PR3                  cn=1,n=1

     3766    27722    5         N = CX + 2;

  27722 20 013514   000002 036007                    ADLQ    2,DL
        20 013515   000000 756100                    STQ     0,,PR0

     3767    27723    5         RETURN;

  27723 20 013516   200036 221300                    LDX1  ! @RANGE,,AUTO
        20 013517   000001 702211                    TSX2  ! 1,X1

     3768    27724    5         END;
     3769    27725
     3770    27726    5      DO WHILE( CX >= 0 );

  27726 20 013520   000000 116003                    CMPQ    0,DU
        20 013521   013571 604000 20                 TMI     s:27746

     3771    27727    5         C = NAMEB(CX);

  27727 20 013522   200037 470500                    LDP0    @NAMEB,,AUTO
        20 013523   002327 235000 2                  LDA     CX
        20 013524   000000 101505                    MRL     fill='000'O
        20 013525   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        20 013526   002330 000004 2                  ADSC9   C                        cn=0,n=4

     3772    27728    5         C = C + 1;

  27728 20 013527   002330 054000 2                  AOS     C

     3773    27729    6         DO WHILE( C <= LAST_LEGAL_CHAR AND NOT LEGAL_CHAR(C) );

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:516  
  27729 20 013530   013532 710000 20                 TRA     s:27731

     3774    27730    6            C = C + 1;

  27730 20 013531   002330 054000 2                  AOS     C

     3775    27731    6            END;

  27731 20 013532   000055 236000 19                 LDQ     LAST_LEGAL_CHAR
        20 013533   000033 772000                    QRL     27
        20 013534   002330 116000 2                  CMPQ    C
        20 013535   013545 604000 20                 TMI     s:27732
        20 013536   002330 235000 2                  LDA     C
        20 013537   013541 605000 20                 TPL     s:27731+7
        20 013540   000044 035003                    ADLA    36,DU
        20 013541   000000 066405                    CMPB    filb='0'B
        20 013542   000056 000001 19                 BDSC    LEGAL_CHAR,A             by=0,bit=0,n=1
        20 013543   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        20 013544   013531 600000 20                 TZE     s:27730

     3776    27732    5         IF C <= LAST_LEGAL_CHAR

  27732 20 013545   002330 116000 2                  CMPQ    C
        20 013546   013556 604000 20                 TMI     s:27737

     3777    27733    6          THEN DO;                         /* Found subsequent legal character   */

     3778    27734    6            NAMEB(CX) = C;

  27734 20 013547   200037 470500                    LDP0    @NAMEB,,AUTO
        20 013550   002327 235000 2                  LDA     CX
        20 013551   000105 101400                    MRL     fill='000'O
        20 013552   002330 000004 2                  ADSC9   C                        cn=0,n=4
        20 013553   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

     3779    27735    6            RETURN;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:517  
  27735 20 013554   200036 221300                    LDX1  ! @RANGE,,AUTO
        20 013555   000001 702211                    TSX2  ! 1,X1

     3780    27736    6            END;
     3781    27737    5         NAMEB(CX) = ASCBIN(' ');          /* No next legal char                 */

  27737 20 013556   200037 470500                    LDP0    @NAMEB,,AUTO
        20 013557   002327 235000 2                  LDA     CX
        20 013560   000105 101400                    MRL     fill='000'O
        20 013561   000205 000004 21                 ADSC9   133                      cn=0,n=4
        20 013562   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

     3782    27738    5         CX = CX - 1;                      /* Find next for adjacent char        */

  27738 20 013563   000001 336007                    LCQ     1,DL
        20 013564   002327 056000 2                  ASQ     CX

     3783    27739    5         N = N - 1;

  27739 20 013565   200040 471500                    LDP1    @N,,AUTO
        20 013566   100000 056100                    ASQ     0,,PR1

     3784    27740    5         END;

  27740 20 013567   002327 235000 2                  LDA     CX
        20 013570   013522 605000 20                 TPL     s:27727

     3785    27741
     3786    27742        /***
     3787    27743         *** No next name.  Set to first and take alternate return.
     3788    27744         ***/
     3789    27745
     3790    27746    4      NAMEB(0) = FIRST_LEGAL_CHAR;

  27746 20 013571   200037 470500                    LDP0    @NAMEB,,AUTO
        20 013572   000100 100400                    MLR     fill='000'O
        20 013573   000054 000001 19                 ADSC9   FIRST_LEGAL_CHAR         cn=0,n=1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:518  
        20 013574   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     3791    27747    4      N = 0;

  27747 20 013575   200040 471500                    LDP1    @N,,AUTO
        20 013576   100000 450100                    STZ     0,,PR1

     3792    27748    4      ALTRETURN;

  27748 20 013577   200036 221300                    LDX1  ! @RANGE,,AUTO
        20 013600   000000 702211                    TSX2  ! 0,X1

     3793    27749
     3794    27750    4   END FLB_NEXT;
     3795    27751
     3796    27752    3   FLB_PREV: PROC( NAMEB, N, MAX_NX ) ALTRET;

  27752 20 013601   200036 741300       FLB_PREV     STX1  ! @RANGE,,AUTO

     3797    27753        /*F* NAME: FLB_PREV
     3798    27754             PURPOSE: Determine the previous valid name.
     3799    27755        */
     3800    27756
     3801    27757    4   DCL NAMEB(0:0) UBIN BYTE CALIGNED;
     3802    27758    4   DCL N SBIN;
     3803    27759    4   DCL MAX_NX SBIN;
     3804    27760
     3805    27761        /****************************************/
     3806    27762
     3807    27763    4      CX = N - 1;                          /* Index of last character            */

  27763 20 013602   200040 470500                    LDP0    @N,,AUTO
        20 013603   000000 235100                    LDA     0,,PR0
        20 013604   000001 135007                    SBLA    1,DL
        20 013605   002327 755000 2                  STA     CX

     3808    27764
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:519  
     3809    27765    5      DO WHILE( CX >= 0 );

  27765 20 013606   013675 604000 20                 TMI     s:27788

     3810    27766    5         C = NAMEB(CX);

  27766 20 013607   200037 470500                    LDP0    @NAMEB,,AUTO
        20 013610   002327 235000 2                  LDA     CX
        20 013611   000000 101505                    MRL     fill='000'O
        20 013612   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        20 013613   002330 000004 2                  ADSC9   C                        cn=0,n=4

     3811    27767    5         C = C - 1;

  27767 20 013614   000001 336007                    LCQ     1,DL
        20 013615   002330 056000 2                  ASQ     C

     3812    27768    6         DO WHILE( C >= FIRST_LEGAL_CHAR AND NOT LEGAL_CHAR(C) );

  27768 20 013616   013621 710000 20                 TRA     s:27770

     3813    27769    6            C = C - 1;

  27769 20 013617   000001 336007                    LCQ     1,DL
        20 013620   002330 056000 2                  ASQ     C

     3814    27770    6            END;

  27770 20 013621   000054 236000 19                 LDQ     FIRST_LEGAL_CHAR
        20 013622   000033 772000                    QRL     27
        20 013623   002330 116000 2                  CMPQ    C
        20 013624   013634 605400 20                 TPNZ    s:27771
        20 013625   002330 235000 2                  LDA     C
        20 013626   013630 605000 20                 TPL     s:27770+7
        20 013627   000044 035003                    ADLA    36,DU
        20 013630   000000 066405                    CMPB    filb='0'B
        20 013631   000056 000001 19                 BDSC    LEGAL_CHAR,A             by=0,bit=0,n=1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:520  
        20 013632   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        20 013633   013617 600000 20                 TZE     s:27769

     3815    27771    5         IF C >= FIRST_LEGAL_CHAR

  27771 20 013634   002330 116000 2                  CMPQ    C
        20 013635   013665 605400 20                 TPNZ    s:27780

     3816    27772    6          THEN DO;                         /* Found previous valid char          */

     3817    27773    6            NAMEB(CX) = C;

  27773 20 013636   200037 470500                    LDP0    @NAMEB,,AUTO
        20 013637   002327 235000 2                  LDA     CX
        20 013640   000105 101400                    MRL     fill='000'O
        20 013641   002330 000004 2                  ADSC9   C                        cn=0,n=4
        20 013642   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

     3818    27774    7            DO CX = CX+1 TO MAX_NX;

  27774 20 013643   002327 054000 2                  AOS     CX
        20 013644   013653 710000 20                 TRA     s:27776+1

     3819    27775    7               NAMEB(CX) = LAST_LEGAL_CHAR;

  27775 20 013645   200037 470500                    LDP0    @NAMEB,,AUTO
        20 013646   002327 235000 2                  LDA     CX
        20 013647   000105 100400                    MLR     fill='000'O
        20 013650   000055 000001 19                 ADSC9   LAST_LEGAL_CHAR          cn=0,n=1
        20 013651   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

     3820    27776    7               END;

  27776 20 013652   002327 054000 2                  AOS     CX
        20 013653   200041 471500                    LDP1    @MAX_NX,,AUTO
        20 013654   002327 236000 2                  LDQ     CX
        20 013655   100000 116100                    CMPQ    0,,PR1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:521  
        20 013656   013645 604400 20                 TMOZ    s:27775

     3821    27777    6            N = MAX_NX + 1;

  27777 20 013657   200040 473500                    LDP3    @N,,AUTO
        20 013660   100000 235100                    LDA     0,,PR1
        20 013661   000001 035007                    ADLA    1,DL
        20 013662   300000 755100                    STA     0,,PR3

     3822    27778    6            RETURN;

  27778 20 013663   200036 221300                    LDX1  ! @RANGE,,AUTO
        20 013664   000001 702211                    TSX2  ! 1,X1

     3823    27779    6            END;
     3824    27780    5         NAMEB(CX) = ASCBIN(' ');

  27780 20 013665   200037 470500                    LDP0    @NAMEB,,AUTO
        20 013666   002327 235000 2                  LDA     CX
        20 013667   000105 101400                    MRL     fill='000'O
        20 013670   000205 000004 21                 ADSC9   133                      cn=0,n=4
        20 013671   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

     3825    27781    5         CX = CX - 1;

  27781 20 013672   000001 336007                    LCQ     1,DL
        20 013673   002327 056000 2                  ASQ     CX

     3826    27782    5         END;

  27782 20 013674   013607 605000 20                 TPL     s:27766

     3827    27783
     3828    27784        /***
     3829    27785         *** No previous valid name.
     3830    27786         ***/
     3831    27787
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:522  
     3832    27788    5      DO CX=0 TO MAX_NX;

  27788 20 013675   002327 450000 2                  STZ     CX
        20 013676   013705 710000 20                 TRA     s:27790+1

     3833    27789    5         NAMEB(CX) = LAST_LEGAL_CHAR;

  27789 20 013677   200037 470500                    LDP0    @NAMEB,,AUTO
        20 013700   002327 235000 2                  LDA     CX
        20 013701   000105 100400                    MLR     fill='000'O
        20 013702   000055 000001 19                 ADSC9   LAST_LEGAL_CHAR          cn=0,n=1
        20 013703   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

     3834    27790    5         END;

  27790 20 013704   002327 054000 2                  AOS     CX
        20 013705   200041 470500                    LDP0    @MAX_NX,,AUTO
        20 013706   002327 236000 2                  LDQ     CX
        20 013707   000000 116100                    CMPQ    0,,PR0
        20 013710   013677 604400 20                 TMOZ    s:27789

     3835    27791    4      N = MAX_NX + 1;

  27791 20 013711   200040 471500                    LDP1    @N,,AUTO
        20 013712   000000 235100                    LDA     0,,PR0
        20 013713   000001 035007                    ADLA    1,DL
        20 013714   100000 755100                    STA     0,,PR1

     3836    27792    4      ALTRETURN;

  27792 20 013715   200036 221300                    LDX1  ! @RANGE,,AUTO
        20 013716   000000 702211                    TSX2  ! 0,X1

     3837    27793
     3838    27794    4   END FLB_PREV;
     3839    27795
     3840    27796    3   FLB_SORT_RANGE: PROC;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:523  

  27796 20 013717   200034 741300       FLB_SORT_RA* STX1  ! DISK_OPTION_PAD_SAVE+1,,AUTO

     3841    27797
     3842    27798        /********************/
     3843    27799
     3844    27800    4      M = DISK_FILE_SPEC.NBR - 2;

  27800 20 013720   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 013721   000000 235100                    LDA     0,,PR0
        20 013722   000002 135007                    SBLA    2,DL
        20 013723   002333 755000 2                  STA     M

     3845    27801    5      DO WHILE( M >= 0 );

  27801 20 013724   014002 604000 20                 TMI     s:27817

     3846    27802    5         I_SWAP = -1;

  27802 20 013725   000001 335007                    LCA     1,DL
        20 013726   002334 755000 2                  STA     I_SWAP

     3847    27803    6         DO I = 0 TO M;

  27803 20 013727   002331 450000 2                  STZ     I
        20 013730   013774 710000 20                 TRA     s:27812+1

     3848    27804    6            J = I + 1;

  27804 20 013731   002331 235000 2                  LDA     I
        20 013732   000001 035007                    ADLA    1,DL
        20 013733   002332 755000 2                  STA     J

     3849    27805    6            IF DISK_FILE_SPEC.SPECCHARS(I) > DISK_FILE_SPEC.SPECCHARS(J)

  27805 20 013734   002332 236000 2                  LDQ     J
        20 013735   000124 402007                    MPY     84,DL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:524  
        20 013736   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 013737   002331 236000 2                  LDQ     I
        20 013740   000124 402007                    MPY     84,DL
        20 013741   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 013742   200042 235100                    LDA     @MAX_NX+1,,AUTO
        20 013743   040106 106505                    CMPC    fill='040'O
        20 013744   000005 000124                    ADSC9   5,A,PR0                  cn=0,n=84
        20 013745   000005 000124                    ADSC9   5,Q,PR0                  cn=0,n=84
        20 013746   013773 603000 20                 TRC     s:27812

     3850    27806    7             THEN DO;

     3851    27807    7               I_SWAP = I;

  27807 20 013747   002331 235000 2                  LDA     I
        20 013750   002334 755000 2                  STA     I_SWAP

     3852    27808    7               SPECCHARS = DISK_FILE_SPEC.SPECCHARS(I);

  27808 20 013751   040000 100506                    MLR     fill='040'O
        20 013752   000005 000124                    ADSC9   5,Q,PR0                  cn=0,n=84
        20 013753   000000 000124 xsym               ADSC9   SPECCHARS                cn=0,n=84

     3853    27809    7               DISK_FILE_SPEC.SPECCHARS(I) = DISK_FILE_SPEC.SPECCHARS(J);

  27809 20 013754   002332 236000 2                  LDQ     J
        20 013755   000124 402007                    MPY     84,DL
        20 013756   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 013757   002331 236000 2                  LDQ     I
        20 013760   000124 402007                    MPY     84,DL
        20 013761   200042 235100                    LDA     @MAX_NX+1,,AUTO
        20 013762   040106 100505                    MLR     fill='040'O
        20 013763   000005 000124                    ADSC9   5,A,PR0                  cn=0,n=84
        20 013764   000005 000124                    ADSC9   5,Q,PR0                  cn=0,n=84

     3854    27810    7               DISK_FILE_SPEC.SPECCHARS(J) = SPECCHARS;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:525  
  27810 20 013765   002332 236000 2                  LDQ     J
        20 013766   000124 402007                    MPY     84,DL
        20 013767   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
        20 013770   040106 100400                    MLR     fill='040'O
        20 013771   000000 000124 xsym               ADSC9   SPECCHARS                cn=0,n=84
        20 013772   000005 000124                    ADSC9   5,Q,PR0                  cn=0,n=84

     3855    27811    7               END;

     3856    27812    6            END;

  27812 20 013773   002331 054000 2                  AOS     I
        20 013774   002331 236000 2                  LDQ     I
        20 013775   002333 116000 2                  CMPQ    M
        20 013776   013731 604400 20                 TMOZ    s:27804

     3857    27813    5         M = I_SWAP;

  27813 20 013777   002334 235000 2                  LDA     I_SWAP
        20 014000   002333 755000 2                  STA     M

     3858    27814    5         END;

  27814 20 014001   013725 605000 20                 TPL     s:27802

     3859    27815
     3860    27816
     3861    27817    4      RETURN;

  27817 20 014002   200034 221300                    LDX1  ! DISK_OPTION_PAD_SAVE+1,,AUTO
        20 014003   000001 702211                    TSX2  ! 1,X1

     3862    27818
     3863    27819    4   END FLB_SORT_RANGE;
     3864    27820
     3865    27821    3   END FLB_ORDER_RANGE;
     3866    27822
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:526  
     3867    27823    2   END FLB_DISK_SPEC;
     3868    27824        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:527  
     3869    27825    1   FLB_TAPE_OD_SPEC: PROC ALTRET;

  27825 20 014004   200026 741300       FLB_TAPE_OD* STX1  ! NEW_REBUILD+6,,AUTO

     3870    27826        /*F*  NAME: FLB_TAPE_OD_SPEC
     3871    27827              PURPOSE: Process tape and optical disk specification nodes.
     3872    27828        ***/
     3873    27829
     3874    27830        /***
     3875    27831         *** AUTO
     3876    27832         ***/
     3877    27833
     3878    27834    2   DCL NODE_ERROR BIT(1) AUTO;
     3879    27835
     3880    27836        /****************************************/
     3881    27837
     3882    27838           /***
     3883    27839            *** Process options.
     3884    27840            ***/
     3885    27841
     3886    27842    2      NODE_ERROR = '1'B;

  27842 20 014005   400000 236003                    LDQ     -131072,DU
        20 014006   200027 756100                    STQ     NODE_ERROR,,AUTO

     3887    27843    2      NBR_SNLISTS = 0;

  27843 20 014007   000000 450000 xsym               STZ     NBR_SNLISTS

     3888    27844    3      DO SUBNODEX = 0 TO NODE$->OUT$BLK.NSUBLKS - 1;

  27844 20 014010   000232 450000 2                  STZ     SUBNODEX
        20 014011   014062 710000 20                 TRA     s:27859+1

     3889    27845    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(SUBNODEX);

  27845 20 014012   000226 470400 2                  LDP0    NODE$
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:528  
        20 014013   000232 720000 2                  LXL0    SUBNODEX
        20 014014   000003 236110                    LDQ     3,X0,PR0
        20 014015   000231 756000 2                  STQ     SUBNODE$

     3890    27846
     3891    27847    4         DO CASE( SUBNODE$->OUT$BLK.CODE );

  27847 20 014016   000231 471400 2                  LDP1    SUBNODE$
        20 014017   100000 721100                    LXL1    0,,PR1
        20 014020   000026 101003                    CMPX1   22,DU
        20 014021   014023 602011 20                 TNC     s:27847+5,X1
        20 014022   014061 710000 20                 TRA     s:27859
        20 014023   014061 710000 20                 TRA     s:27859
        20 014024   014061 710000 20                 TRA     s:27859
        20 014025   014061 710000 20                 TRA     s:27859
        20 014026   014051 710000 20                 TRA     s:27850
        20 014027   014051 710000 20                 TRA     s:27850
        20 014030   014061 710000 20                 TRA     s:27859
        20 014031   014061 710000 20                 TRA     s:27859
        20 014032   014061 710000 20                 TRA     s:27859
        20 014033   014061 710000 20                 TRA     s:27859
        20 014034   014061 710000 20                 TRA     s:27859
        20 014035   014061 710000 20                 TRA     s:27859
        20 014036   014061 710000 20                 TRA     s:27859
        20 014037   014061 710000 20                 TRA     s:27859
        20 014040   014061 710000 20                 TRA     s:27859
        20 014041   014061 710000 20                 TRA     s:27859
        20 014042   014061 710000 20                 TRA     s:27859
        20 014043   014051 710000 20                 TRA     s:27850
        20 014044   014061 710000 20                 TRA     s:27859
        20 014045   014061 710000 20                 TRA     s:27859
        20 014046   014061 710000 20                 TRA     s:27859
        20 014047   014061 710000 20                 TRA     s:27859
        20 014050   014051 710000 20                 TRA     s:27850

     3892    27848
     3893    27849    4          CASE( %TAPE_DEST, %TAPE_SOURCE, %OD_DEST, %OD_SOURCE );
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:529  

     3894    27850    4            CALL FLI$NODE_TAPE_OD( SUBNODE$ )

  27850 20 014051   000105 630400 21                 EPPR0   69
        20 014052   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 014053   000000 701000 xent               TSX1    FLI$NODE_TAPE_OD
        20 014054   014057 702000 20                 TSX2    s:27855

     3895    27851    5             WHENRETURN DO;

     3896    27852    5               NODE_ERROR = '0'B;

  27852 20 014055   200027 450100                    STZ     NODE_ERROR,,AUTO

     3897    27853    5               END;

  27853 20 014056   014061 710000 20                 TRA     s:27859

     3898    27854    5             WHENALTRETURN DO;

     3899    27855    5               NODE_ERROR = '1'B;

  27855 20 014057   400000 236003                    LDQ     -131072,DU
        20 014060   200027 756100                    STQ     NODE_ERROR,,AUTO

     3900    27856    5               END;

     3901    27857
     3902    27858    4          END;

     3903    27859    3         END;

  27859 20 014061   000232 054000 2                  AOS     SUBNODEX
        20 014062   000226 470400 2                  LDP0    NODE$
        20 014063   000001 236100                    LDQ     1,,PR0
        20 014064   000022 772000                    QRL     18
        20 014065   000232 116000 2                  CMPQ    SUBNODEX
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:530  
        20 014066   014012 605400 20                 TPNZ    s:27845

     3904    27860
     3905    27861    2      IF NODE_ERROR THEN COMMAND_ERROR = '1'B;

  27861 20 014067   200027 234100                    SZN     NODE_ERROR,,AUTO
        20 014070   014073 605000 20                 TPL     s:27862

  27861 20 014071   400000 236003                    LDQ     -131072,DU
        20 014072   000000 756000 xsym               STQ     COMMAND_ERROR

     3906    27862    2      IF NODE_ERROR THEN ALTRETURN;

  27862 20 014073   200027 234100                    SZN     NODE_ERROR,,AUTO
        20 014074   014077 605000 20                 TPL     s:27864

  27862 20 014075   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 014076   000000 702211                    TSX2  ! 0,X1

     3907    27863
     3908    27864    2      RETURN;

  27864 20 014077   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 014100   000001 702211                    TSX2  ! 1,X1

     3909    27865
     3910    27866    2   END FLB_TAPE_OD_SPEC;
     3911    27867
     3912    27868        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:531  
     3913    27869    1   FLB_SET_TAPE_DEFAULTS: PROC( T_DENSITY,T_FSN,LAST_T_FSN,T_IOERROK );

  27869 20 014101   200026 741300       FLB_SET_TAP* STX1  ! NEW_REBUILD+6,,AUTO

     3914    27870        /*F*  NAME: FLB_SET_TAPE_DEFAULTS
     3915    27871              PURPOSE: Set defaults for reading tape.
     3916    27872        ***/
     3917    27873    2   DCL T_DENSITY UBIN;
     3918    27874    2   DCL T_FSN UBIN;
     3919    27875    2   DCL LAST_T_FSN UBIN;
     3920    27876    2   DCL T_IOERROK BIT(1) ALIGNED;
     3921    27877        /***
     3922    27878         *** AUTO
     3923    27879         ***/
     3924    27880
     3925    27881        /****************************************/
     3926    27882
     3927    27883         /***
     3928    27884          *** Set up defaults.
     3929    27885          ***/
     3930    27886
     3931    27887    2      TAPE_OPEN.V.OPER.MNTONLY# = %NO#;

  27887 20 014102   000206 236000 21                 LDQ     134
        20 014103   000044 356000 xsym               ANSQ    TAPE_OPEN+36

     3932    27888    2      IF ADDR(T_DENSITY) = ADDR(NIL)

  27888 20 014104   200027 236100                    LDQ     @T_DENSITY,,AUTO
        20 014105   000001 116000 xsym               CMPQ    B_VECTNIL+1
        20 014106   014112 601000 20                 TNZ     s:27890

     3933    27889    2       THEN TAPE_OPEN.V.DENSITY# = 0;

  27889 20 014107   000000 236003                    LDQ     0,DU
        20 014110   000066 552004 xsym               STBQ    TAPE_OPEN+54,'04'O
        20 014111   014115 710000 20                 TRA     s:27891
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:532  

     3934    27890    2       ELSE TAPE_OPEN.V.DENSITY# = T_DENSITY;

  27890 20 014112   200027 470500                    LDP0    @T_DENSITY,,AUTO
        20 014113   000000 236100                    LDQ     0,,PR0
        20 014114   000066 552004 xsym               STBQ    TAPE_OPEN+54,'04'O

     3935    27891    2      TAPE_OPEN.V.EXPIRE# = %NEVER#;

  27891 20 014115   000001 335007                    LCA     1,DL
        20 014116   000057 755000 xsym               STA     TAPE_OPEN+47

     3936    27892    2      TAPE_OPEN.V.XTEND# = '0'B;

  27892 20 014117   000065 236000 21                 LDQ     53
        20 014120   000060 356000 xsym               ANSQ    TAPE_OPEN+48

     3937    27893    2      TAPE_OPEN.V.VOLACCESS# = 0;

  27893 20 014121   000207 236000 21                 LDQ     135
        20 014122   000063 356000 xsym               ANSQ    TAPE_OPEN+51

     3938    27894    2      IF ADDR(T_FSN) = ADDR(NIL)

  27894 20 014123   200030 236100                    LDQ     @T_FSN,,AUTO
        20 014124   000001 116000 xsym               CMPQ    B_VECTNIL+1
        20 014125   014131 601000 20                 TNZ     s:27896

     3939    27895    2       THEN TAPE_OPEN.V.FSN# = 0;

  27895 20 014126   000000 220003                    LDX0    0,DU
        20 014127   000066 740000 xsym               STX0    TAPE_OPEN+54
        20 014130   014134 710000 20                 TRA     s:27897

     3940    27896    2       ELSE TAPE_OPEN.V.FSN# = T_FSN;

  27896 20 014131   200030 470500                    LDP0    @T_FSN,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:533  
        20 014132   000000 720100                    LXL0    0,,PR0
        20 014133   000066 740000 xsym               STX0    TAPE_OPEN+54

     3941    27897    2      TAPE_OPEN.V.RES# = 'LT';

  27897 20 014134   000227 236000 19                 LDQ     LEGAL_CHAR+105
        20 014135   777777 376003                    ANQ     -1,DU
        20 014136   040040 276007                    ORQ     16416,DL
        20 014137   000050 756000 xsym               STQ     TAPE_OPEN+40

     3942    27898    2      IF ADDR(LAST_T_FSN) = ADDR(NIL)

  27898 20 014140   200031 236100                    LDQ     @LAST_T_FSN,,AUTO
        20 014141   000001 116000 xsym               CMPQ    B_VECTNIL+1
        20 014142   014146 601000 20                 TNZ     s:27900

     3943    27899    2       THEN LAST_TAPE_FSN = 9999;

  27899 20 014143   023417 235007                    LDA     9999,DL
        20 014144   000000 755000 xsym               STA     LAST_TAPE_FSN
        20 014145   014151 710000 20                 TRA     s:27901

     3944    27900    2       ELSE LAST_TAPE_FSN = LAST_T_FSN;

  27900 20 014146   200031 470500                    LDP0    @LAST_T_FSN,,AUTO
        20 014147   000000 235100                    LDA     0,,PR0
        20 014150   000000 755000 xsym               STA     LAST_TAPE_FSN

     3945    27901    2      IF ADDR(T_IOERROK) = ADDR(NIL)

  27901 20 014151   200032 236100                    LDQ     @T_IOERROK,,AUTO
        20 014152   000001 116000 xsym               CMPQ    B_VECTNIL+1
        20 014153   014157 601000 20                 TNZ     s:27903

     3946    27902    2       THEN TAPE_OPEN.V.IOERROK# = %NO#;

  27902 20 014154   000036 236000 21                 LDQ     30
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:534  
        20 014155   000060 356000 xsym               ANSQ    TAPE_OPEN+48
        20 014156   014166 710000 20                 TRA     s:27904

     3947    27903    2       ELSE TAPE_OPEN.V.IOERROK# = T_IOERROK;

  27903 20 014157   200032 470500                    LDP0    @T_IOERROK,,AUTO
        20 014160   000000 236100                    LDQ     0,,PR0
        20 014161   400000 376003                    ANQ     -131072,DU
        20 014162   000007 772000                    QRL     7
        20 014163   000060 676000 xsym               ERQ     TAPE_OPEN+48
        20 014164   003000 376003                    ANQ     1536,DU
        20 014165   000060 656000 xsym               ERSQ    TAPE_OPEN+48

     3948    27904    2      TAPE_OPEN.NAME_ = VECTOR(ERASE);

  27904 20 014166   000034 237000 21                 LDAQ    28
        20 014167   000006 757000 xsym               STAQ    TAPE_OPEN+6

     3949    27905    2      TAPE_OPEN.V.INITZ.SCRUB# = %YES#;

  27905 20 014170   400000 236007                    LDQ     -131072,DL
        20 014171   000044 256000 xsym               ORSQ    TAPE_OPEN+36

     3950    27906    2      TAPE_OPEN.IFPARAM_ = VECTOR(NIL);

  27906 20 014172   000210 237000 21                 LDAQ    136
        20 014173   000026 757000 xsym               STAQ    TAPE_OPEN+22

     3951    27907    2      TAPE_OPEN.FPARAM_ = VECTOR(NIL);

  27907 20 014174   000210 237000 21                 LDAQ    136
        20 014175   000030 757000 xsym               STAQ    TAPE_OPEN+24

     3952    27908    2      TAPE_OPEN.V.VOL# = 1;

  27908 20 014176   001000 236003                    LDQ     512,DU
        20 014177   000061 552040 xsym               STBQ    TAPE_OPEN+49,'40'O
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:535  

     3953    27909    2      TAPE_OPEN.V.BLKL# = DEFAULT_GRANS_PER_TAPE_BUF * 4096;

  27909 20 014200   000000 235000 xsym               LDA     DEFAULT_GRANS_PER_TAPE_BUF
        20 014201   000014 735000                    ALS     12
        20 014202   000000 622005                    EAX2    0,AL
        20 014203   000052 742000 xsym               STX2    TAPE_OPEN+42

     3954    27910    2      NBR_GRANS_PER_TAPE_BUF = DEFAULT_GRANS_PER_TAPE_BUF;

  27910 20 014204   000000 235000 xsym               LDA     DEFAULT_GRANS_PER_TAPE_BUF
        20 014205   000000 755000 xsym               STA     NBR_GRANS_PER_TAPE_BUF

     3955    27911    2      CT_IMAGE = ' ';                      /* Assume not "controlled" tapeset    */

  27911 20 014206   000035 236000 xsym               LDQ     B_VECTNIL+29
        20 014207   000000 756000 xsym               STQ     CT_IMAGE

     3956    27912    2      TAPE_OPEN.V.FUN# = %IN#;

  27912 20 014210   002000 236007                    LDQ     1024,DL
        20 014211   000045 552010 xsym               STBQ    TAPE_OPEN+37,'10'O

     3957    27913    2      TAPE_OPEN.V.CVOL# = %NO#;

  27913 20 014212   000212 236000 21                 LDQ     138
        20 014213   000044 356000 xsym               ANSQ    TAPE_OPEN+36

     3958    27914
     3959    27915    2      RETURN;

  27915 20 014214   000001 702211                    TSX2  ! 1,X1

     3960    27916
     3961    27917    2   END FLB_SET_TAPE_DEFAULTS;
     3962    27918
     3963    27919        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:536  
     3964    27920    1   FLB_BUILD_SNLIST: PROC;

  27920 20 014215   200026 741300       FLB_BUILD_S* STX1  ! NEW_REBUILD+6,,AUTO

     3965    27921        /*F*  NAME: FLB_BUILD_SNLIST
     3966    27922              PURPOSE: Build serial number list from :BACKUP file in $$EFT account.
     3967    27923        ***/
     3968    27924
     3969    27925        /***
     3970    27926         *** AUTO
     3971    27927         ***/
     3972    27928
     3973    27929    2   DCL N SBIN WORD;
     3974    27930    2   DCL NN SBIN WORD;
     3975    27931    2   DCL SNSIZE UBIN WORD;
     3976    27932    2   DCL SNLIST$ PTR;
     3977    27933    2   DCL SNLISTINFO$ PTR;
     3978    27934    2   DCL 1 CT5FMT AUTO,                      /* CT#xxxxn                           */
     3979    27935    2         2 XXXX CHAR(4),
     3980    27936    2         2 N CHAR(1);
     3981    27937    2   DCL CT5FMTCHARS REDEF CT5FMT CHAR(5);
     3982    27938    2   DCL 1 CT6FMT AUTO,                      /* CT#xxxxnn                          */
     3983    27939    2         2 XXXX CHAR(4),
     3984    27940    2         2 NN CHAR(2);
     3985    27941    2   DCL CT6FMTCHARS REDEF CT6FMT CHAR(6);
     3986    27942
     3987    27943         /***
     3988    27944          *** FPT
     3989    27945          ***/
     3990    27946
     3991    27947        %VLP_SN( FPTN=SNLIST,
     3992    27948                 STCLASS="BASED(SNLIST$)" );
     3993    27961
     3994    27962        /****************************************/
     3995    27963
     3996    27964    2      SNSIZE = (LENGTHC(VLP_SN.NUM#) + STATUS_KEY.TSN_VOL *

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:537  
  27964 20 014216   000000 236000 xsym               LDQ     STATUS_KEY
        20 014217   000777 376007                    ANQ     511,DL
        20 014220   000006 402007                    MPY     6,DL
        20 014221   000007 036007                    ADLQ    7,DL
        20 014222   000002 772000                    QRL     2
        20 014223   200031 756100                    STQ     SNSIZE,,AUTO

     3997    27965    2        LENGTHC(VLP_SN.SN#(0))+3) /4;
     3998    27966    2      CALL FLI$ALLOC( SNSIZE, SNLIST$ );

  27966 20 014224   200032 630500                    EPPR0   SNLIST$,,AUTO
        20 014225   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 014226   200031 631500                    EPPR1   SNSIZE,,AUTO
        20 014227   200042 451500                    STP1    @MAX_NX+1,,AUTO
        20 014230   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 014231   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 014232   000000 701000 xent               TSX1    FLI$ALLOC
        20 014233   000000 011000                    NOP     0

     3999    27967    2      SNLIST.NUM# = STATUS_KEY.TSN_VOL;

  27967 20 014234   000000 236000 xsym               LDQ     STATUS_KEY
        20 014235   000777 376007                    ANQ     511,DL
        20 014236   200032 470500                    LDP0    SNLIST$,,AUTO
        20 014237   000000 756100                    STQ     0,,PR0

     4000    27968    2      CALL INDEX( N, ' ', TSN_USED_BUF.TSN );

  27968 20 014240   000000 124400                    SCM     mask='000'O
        20 014241   000005 000006 xsym               ADSC9   TSN_USED_BUF+5           cn=0,n=6
        20 014242   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        20 014243   200027 000100                    ARG     N,,AUTO

     4001    27969    2      IF N = LENGTHC('xxxxn')

  27969 20 014244   200027 235100                    LDA     N,,AUTO
        20 014245   000005 115007                    CMPA    5,DL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:538  
        20 014246   014301 601000 20                 TNZ     s:27980

     4002    27970    3       THEN DO;

     4003    27971    3         CT5FMTCHARS = TSN_USED_BUF.TSN;

  27971 20 014247   040100 100400                    MLR     fill='040'O
        20 014250   000005 000005 xsym               ADSC9   TSN_USED_BUF+5           cn=0,n=5
        20 014251   200034 000005                    ADSC9   CT5FMT,,AUTO             cn=0,n=5

     4004    27972    3         CALL CHARBIN( NN, CT5FMT.N );

  27972 20 014252   000100 305500                    DTB
        20 014253   200035 030001                    NDSC9   @SPEC,,AUTO              cn=0,s=nosgn,sf=0,n=1
        20 014254   200030 000004                    NDSC9   NN,,AUTO                 cn=0,s=lsgnf,sf=0,n=4

     4005    27973    4         DO N = SNLIST.NUM# - 1 DOWNTO 0;

  27973 20 014255   200032 470500                    LDP0    SNLIST$,,AUTO
        20 014256   000000 235100                    LDA     0,,PR0
        20 014257   000001 135007                    SBLA    1,DL
        20 014260   200027 755100                    STA     N,,AUTO
        20 014261   014276 710000 20                 TRA     s:27977+1

     4006    27974    4            CALL BINCHAR( CT5FMT.N, NN );

  27974 20 014262   000100 301500                    BTD
        20 014263   200030 000004                    NDSC9   NN,,AUTO                 cn=0,s=lsgnf,sf=0,n=4
        20 014264   200035 030001                    NDSC9   @SPEC,,AUTO              cn=0,s=nosgn,sf=0,n=1

     4007    27975    4            SNLIST.SN#(N) = CT5FMTCHARS;

  27975 20 014265   200027 236100                    LDQ     N,,AUTO
        20 014266   000006 402007                    MPY     6,DL
        20 014267   200032 470500                    LDP0    SNLIST$,,AUTO
        20 014270   040106 100500                    MLR     fill='040'O
        20 014271   200034 000005                    ADSC9   CT5FMT,,AUTO             cn=0,n=5
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:539  
        20 014272   000001 000006                    ADSC9   1,Q,PR0                  cn=0,n=6

     4008    27976    4            NN = NN - 1 ;

  27976 20 014273   000001 336007                    LCQ     1,DL
        20 014274   200030 056100                    ASQ     NN,,AUTO

     4009    27977    4            END;

  27977 20 014275   200027 056100                    ASQ     N,,AUTO
        20 014276   200027 235100                    LDA     N,,AUTO
        20 014277   014262 605000 20                 TPL     s:27974

     4010    27978    3         END;

  27978 20 014300   014332 710000 20                 TRA     s:27989

     4011    27979    3       ELSE DO;

     4012    27980    3         CT6FMTCHARS = TSN_USED_BUF.TSN;

  27980 20 014301   040100 100400                    MLR     fill='040'O
        20 014302   000005 000006 xsym               ADSC9   TSN_USED_BUF+5           cn=0,n=6
        20 014303   200036 000006                    ADSC9   CT6FMT,,AUTO             cn=0,n=6

     4013    27981    3         CALL CHARBIN( NN, CT6FMT.NN );

  27981 20 014304   000100 305500                    DTB
        20 014305   200037 030002                    NDSC9   @NAMEB,,AUTO             cn=0,s=nosgn,sf=0,n=2
        20 014306   200030 000004                    NDSC9   NN,,AUTO                 cn=0,s=lsgnf,sf=0,n=4

     4014    27982    4         DO N = SNLIST.NUM# - 1  DOWNTO 0;

  27982 20 014307   200032 470500                    LDP0    SNLIST$,,AUTO
        20 014310   000000 235100                    LDA     0,,PR0
        20 014311   000001 135007                    SBLA    1,DL
        20 014312   200027 755100                    STA     N,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:540  
        20 014313   014330 710000 20                 TRA     s:27986+1

     4015    27983    4            CALL BINCHAR( CT6FMT.NN, NN );

  27983 20 014314   000100 301500                    BTD
        20 014315   200030 000004                    NDSC9   NN,,AUTO                 cn=0,s=lsgnf,sf=0,n=4
        20 014316   200037 030002                    NDSC9   @NAMEB,,AUTO             cn=0,s=nosgn,sf=0,n=2

     4016    27984    4            SNLIST.SN#(N) = CT6FMTCHARS;

  27984 20 014317   200027 236100                    LDQ     N,,AUTO
        20 014320   000006 402007                    MPY     6,DL
        20 014321   200032 470500                    LDP0    SNLIST$,,AUTO
        20 014322   040106 100500                    MLR     fill='040'O
        20 014323   200036 000006                    ADSC9   CT6FMT,,AUTO             cn=0,n=6
        20 014324   000001 000006                    ADSC9   1,Q,PR0                  cn=0,n=6

     4017    27985    4            NN = NN - 1;

  27985 20 014325   000001 336007                    LCQ     1,DL
        20 014326   200030 056100                    ASQ     NN,,AUTO

     4018    27986    4            END;

  27986 20 014327   200027 056100                    ASQ     N,,AUTO
        20 014330   200027 235100                    LDA     N,,AUTO
        20 014331   014314 605000 20                 TPL     s:27983

     4019    27987    3         END;

     4020    27988
     4021    27989    2      CALL FLI$ALLOC( SIZEW(SNLISTINFO), SNLISTINFO$ );

  27989 20 014332   200033 630500                    EPPR0   SNLISTINFO$,,AUTO
        20 014333   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 014334   000045 236000 21                 LDQ     37
        20 014335   200042 756100                    STQ     @MAX_NX+1,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:541  
        20 014336   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 014337   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 014340   000000 701000 xent               TSX1    FLI$ALLOC
        20 014341   000000 011000                    NOP     0

     4022    27990    2      SNLISTINFO$->SNLISTINFO.SNLIST$ = SNLIST$;

  27990 20 014342   200032 236100                    LDQ     SNLIST$,,AUTO
        20 014343   200033 470500                    LDP0    SNLISTINFO$,,AUTO
        20 014344   000000 756100                    STQ     0,,PR0

     4023    27991    2      SNLISTINFO$->SNLISTINFO.PREVINFO$ = LAST_SNLISTINFO$;

  27991 20 014345   000000 236000 xsym               LDQ     LAST_SNLISTINFO$
        20 014346   200033 470500                    LDP0    SNLISTINFO$,,AUTO
        20 014347   000001 756100                    STQ     1,,PR0

     4024    27992    2      LAST_SNLISTINFO$ = SNLISTINFO$;

  27992 20 014350   200033 236100                    LDQ     SNLISTINFO$,,AUTO
        20 014351   000000 756000 xsym               STQ     LAST_SNLISTINFO$

     4025    27993
     4026    27994    2      RETURN;

  27994 20 014352   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 014353   000001 702211                    TSX2  ! 1,X1

     4027    27995    2   END FLB_BUILD_SNLIST;
     4028    27996        %EJECT;
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:542  
     4029    27997    1   FLB_READ_BACKUP: PROC ALTRET;

  27997 20 014354   200026 741300       FLB_READ_BA* STX1  ! NEW_REBUILD+6,,AUTO

     4030    27998        /*F*  NAME: FLB_READ_BACKUP
     4031    27999              PURPOSE: Copy :BACKUP file from tape,fid, or packset being restored to
     4032    28000                       *:BACKUP file on disk.
     4033    28001        ***/
     4034    28002
     4035    28003        /***
     4036    28004         *** AUTO
     4037    28005         ***/
     4038    28006    2   DCL DCB# UBIN AUTO;
     4039    28007    2   DCL SOURCE_DCB$ PTR AUTO;
     4040    28008    2   DCL FIRST BIT(1) AUTO;
     4041    28009    2   DCL DISK_OPTION_DIR_SAVE BIT(1) AUTO;
     4042    28010    2   DCL DISK_OPTION_PAD_SAVE BIT(1) AUTO;
     4043    28011    2   DCL 1 FPARAM_ DALIGNED AUTO,
     4044    28012    2         2 BOUND UBIN(20) UNAL,
     4045    28013    2         2 * BIT(16) UNAL,
     4046    28014    2         2 PTR$ PTR;
     4047    28015        %VLP_ERRCODE (FPTN=ERR);
     4048    28060    2   DCL ARS SBIN AUTO;
     4049    28061    2   DCL 1 BUF_ DALIGNED AUTO,
     4050    28062    2         2 * BIT(36),
     4051    28063    2         2 PTR$ PTR;
     4052    28064
     4053    28065        /****************************************/
     4054    28066
     4055    28067
     4056    28068    2      DISK_WRITE.V.WAIT# = '1'B;

  28068 20 014355   400000 236007                    LDQ     -131072,DL
        20 014356   000010 256000 xsym               ORSQ    DISK_WRITE+8

     4057    28069    2      DISK_WRITE.V.EVENT# = 0;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:543  
  28069 20 014357   000011 450000 xsym               STZ     DISK_WRITE+9

     4058    28070    2      DISK_WRITE.V.DCB# = DCBNUM(M$DISK00);

  28070 20 014360   000000 236007 xsym               LDQ     M$DISK00,DL
        20 014361   000000 620006                    EAX0    0,QL
        20 014362   000010 740000 xsym               STX0    DISK_WRITE+8

     4059    28071    2      DISK_OPEN.V.DCB# = DCBNUM(M$DISK00);

  28071 20 014363   000000 236007 xsym               LDQ     M$DISK00,DL
        20 014364   000000 622006                    EAX2    0,QL
        20 014365   000044 742000 xsym               STX2    DISK_OPEN+36

     4060    28072    2      DISK_OPEN.V.FUN# = %CREATE#;

  28072 20 014366   003000 236007                    LDQ     1536,DL
        20 014367   000045 552010 xsym               STBQ    DISK_OPEN+37,'10'O

     4061    28073    2      DISK_OPEN.SN_ = VECTOR(DISK_DEST_SN);

  28073 20 014370   000214 237000 21                 LDAQ    140
        20 014371   000002 757000 xsym               STAQ    DISK_OPEN+2

     4062    28074    2      DISK_OPEN.V.RES# = DISK_DEST_RES.NAME;

  28074 20 014372   000001 236000 xsym               LDQ     DISK_DEST_RES+1
        20 014373   000050 756000 xsym               STQ     DISK_OPEN+40

     4063    28075    2      OUR_ACCT.ACCT# = B$JIT.FACCN;

  28075 20 014374   000000 470400 xsym               LDP0    B$JIT$
        20 014375   000006 237100                    LDAQ    6,,PR0
        20 014376   000636 757000 2                  STAQ    OUR_ACCT

     4064    28076    2      DISK_OPEN.ACCT_ = VECTOR(OUR_ACCT);

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:544  
  28076 20 014377   000216 237000 21                 LDAQ    142
        20 014400   000024 757000 xsym               STAQ    DISK_OPEN+20

     4065    28077    2      DISK_OPEN.NAME_ = VECTOR(BACKUP_TEMP);

  28077 20 014401   000220 237000 21                 LDAQ    144
        20 014402   000006 757000 xsym               STAQ    DISK_OPEN+6

     4066    28078    2      DISK_CLOSE.V.DCB# = DCBNUM(M$DISK00);

  28078 20 014403   000000 236007 xsym               LDQ     M$DISK00,DL
        20 014404   000000 623006                    EAX3    0,QL
        20 014405   000032 743000 xsym               STX3    DISK_CLOSE+26

     4067    28079    2      DISK_CLOSE.SN_ = VECTOR(DISK_DEST_SN);

  28079 20 014406   000214 237000 21                 LDAQ    140
        20 014407   000002 757000 xsym               STAQ    DISK_CLOSE+2

     4068    28080    2      DISK_CLOSE.V.DISP# = %SAVE#;

  28080 20 014410   000002 236007                    LDQ     2,DL
        20 014411   000032 552004 xsym               STBQ    DISK_CLOSE+26,'04'O

     4069    28081    2      CLOSE_BACKUP_TEMP.V.DISP# = %SAVE#;

  28081 20 014412   002272 552004 2                  STBQ    CLOSE_BACKUP_TEMP+26,'04'O

     4070    28082
     4071    28083    2      IF NODE$->OUT$BLK.NSUBLKS > 1

  28083 20 014413   000226 471400 2                  LDP1    NODE$
        20 014414   100001 223100                    LDX3    1,,PR1
        20 014415   000002 103003                    CMPX3   2,DU
        20 014416   015020 602000 20                 TNC     s:28191
        20 014417   100004 473500                    LDP3    4,,PR1
        20 014420   300000 724100                    LXL4    0,,PR3
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:545  
        20 014421   000015 104003                    CMPX4   13,DU
        20 014422   015020 600000 20                 TZE     s:28191

     4072    28084    2        AND NODE$->OUT$BLK.SUBLK$(1)->OUT$BLK.CODE ~= %REBUILD_TAPE_OPTIONS
     4073    28085    3       THEN DO;

     4074    28086    3         SUBNODE$ = NODE$->OUT$BLK.SUBLK$(1);

  28086 20 014423   100004 236100                    LDQ     4,,PR1
        20 014424   000231 756000 2                  STQ     SUBNODE$

     4075    28087    4         DO CASE( SUBNODE$->OUT$BLK.CODE );

  28087 20 014425   000231 473400 2                  LDP3    SUBNODE$
        20 014426   300000 236100                    LDQ     0,,PR3
        20 014427   777777 376007                    ANQ     -1,DL
        20 014430   000004 136007                    SBLQ    4,DL
        20 014431   000011 116007                    CMPQ    9,DL
        20 014432   014434 602006 20                 TNC     s:28087+7,QL
        20 014433   015051 710000 20                 TRA     READ_LOOP5
        20 014434   014445 710000 20                 TRA     s:28091
        20 014435   015017 710000 20                 TRA     s:28189
        20 014436   015017 710000 20                 TRA     s:28189
        20 014437   015017 710000 20                 TRA     s:28189
        20 014440   015017 710000 20                 TRA     s:28189
        20 014441   015017 710000 20                 TRA     s:28189
        20 014442   015017 710000 20                 TRA     s:28189
        20 014443   015017 710000 20                 TRA     s:28189
        20 014444   014655 710000 20                 TRA     s:28146

     4076    28088
     4077    28089    4          CASE( %TAPE_SOURCE );            /* Copy :BACKUP file from tape        */

     4078    28090
     4079    28091    4            DISK_OPTION_DIR_SAVE = DISK_OPTION.DIR;

  28091 20 014445   000000 236000 xsym               LDQ     DISK_OPTION
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:546  
        20 014446   400000 376003                    ANQ     -131072,DU
        20 014447   200032 756100                    STQ     DISK_OPTION_DIR_SAVE,,AUTO

     4080    28092    4            DISK_OPTION.DIR = '0'B;

  28092 20 014450   000031 236000 xsym               LDQ     B_VECTNIL+25
        20 014451   000000 356000 xsym               ANSQ    DISK_OPTION

     4081    28093    4            DISK_OPTION_PAD_SAVE = DISK_OPTION.PAD;

  28093 20 014452   000000 236000 xsym               LDQ     DISK_OPTION
        20 014453   000004 736000                    QLS     4
        20 014454   400000 376003                    ANQ     -131072,DU
        20 014455   200033 756100                    STQ     DISK_OPTION_PAD_SAVE,,AUTO

     4082    28094    4            DISK_OPTION.PAD = '0'B;

  28094 20 014456   000126 236000 21                 LDQ     86
        20 014457   000000 356000 xsym               ANSQ    DISK_OPTION

     4083    28095    4            CALL FLC$TAPE_IO_INIT;

  28095 20 014460   000002 631400 xsym               EPPR1   B_VECTNIL+2
        20 014461   000000 701000 xent               TSX1    FLC$TAPE_IO_INIT
        20 014462   000000 011000                    NOP     0

     4084    28096    4   OPEN_BACKUP_FILE:
     4085    28097    4            CALL FLC$TAPE_OPEN_NEXT(SOURCE_DCB$, FPARAM_, ERR)
             28097                     /* Position to :BACKUP */

  28097 20 014463   000213 236000 21    OPEN_BACKUP* LDQ     139
        20 014464   200044 756100                    STQ     @MAX_NX+3,,AUTO
        20 014465   200034 630500                    EPPR0   FPARAM_,,AUTO
        20 014466   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 014467   200030 631500                    EPPR1   SOURCE_DCB$,,AUTO
        20 014470   200042 451500                    STP1    @MAX_NX+1,,AUTO
        20 014471   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:547  
        20 014472   000021 631400 xsym               EPPR1   B_VECTNIL+17
        20 014473   000000 701000 xent               TSX1    FLC$TAPE_OPEN_NEXT
        20 014474   014476 702000 20                 TSX2    s:28104
        20 014475   014530 710000 20                 TRA     s:28112

     4086    28098    5             WHENALTRETURN DO;

     4087    28099        /***
     4088    28100         *** If a block count error as a result of trying to continue after a tape read
     4089    28101         *** or an I/O error was encountered, attempt to skip past the error by
     4090    28102         *** opening the next file.
     4091    28103         ***/
     4092    28104    5               IF (TAPE_OPEN.V.IOERROK# AND ERR.ERR# = %E$BLKCNT)

  28104 20 014476   000060 236000 xsym               LDQ     TAPE_OPEN+48
        20 014477   003000 316003                    CANQ    1536,DU
        20 014500   014505 600000 20                 TZE     s:28104+7
        20 014501   002357 236000 2                  LDQ     ERR
        20 014502   377770 376007                    ANQ     131064,DL
        20 014503   013250 116007                    CMPQ    5800,DL
        20 014504   014463 600000 20                 TZE     OPEN_BACKUP_FILE
        20 014505   000060 236000 xsym               LDQ     TAPE_OPEN+48
        20 014506   003000 316003                    CANQ    1536,DU
        20 014507   014514 600000 20                 TZE     s:28108
        20 014510   002357 236000 2                  LDQ     ERR
        20 014511   377770 376007                    ANQ     131064,DL
        20 014512   000100 116007                    CMPQ    64,DL
        20 014513   014463 600000 20                 TZE     OPEN_BACKUP_FILE

     4093    28105    5                 OR (TAPE_OPEN.V.IOERROK# AND ERR.ERR# = %E$IO_ERR)
     4094    28106    5                THEN GOTO OPEN_BACKUP_FILE;
     4095    28107
     4096    28108    5               DCB# = DCBNUM(M$TAPE00);

  28108 20 014514   000000 236007 xsym               LDQ     M$TAPE00,DL
        20 014515   200027 756100                    STQ     DCB#,,AUTO

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:548  
     4097    28109    5               CALL FLI$RPT_ERR( E_CANT_OPEN_TBACKUP, DCB# );

  28109 20 014516   200027 630500                    EPPR0   DCB#,,AUTO
        20 014517   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 014520   000222 236000 21                 LDQ     146
        20 014521   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 014522   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 014523   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 014524   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 014525   000000 011000                    NOP     0

     4098    28110    5               ALTRETURN;

  28110 20 014526   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 014527   000000 702211                    TSX2  ! 0,X1

     4099    28111    5               END;
     4100    28112    4            IF SOURCE_DCB$->F$DCB.NAME#.C ~= BACKUP_NAME.NAME# /* Must be :BACKUP */

  28112 20 014530   000000 236000 xsym               LDQ     BACKUP_NAME
        20 014531   000033 772000                    QRL     27
        20 014532   200030 470500                    LDP0    SOURCE_DCB$,,AUTO
        20 014533   000000 620006                    EAX0    0,QL
        20 014534   040040 106500                    CMPC    fill='040'O
        20 014535   000010 200037                    ADSC9   8,,PR0                   cn=1,n=31
        20 014536   000000 200010 xsym               ADSC9   BACKUP_NAME              cn=1,n=*X0
        20 014537   014545 600000 20                 TZE     s:28117

     4101    28113    5             THEN DO;

     4102    28114    5               CALL FLI$RPT_ERR( E_BAD_FSN );

  28114 20 014540   000223 630400 21                 EPPR0   147
        20 014541   000017 631400 xsym               EPPR1   B_VECTNIL+15
        20 014542   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 014543   000000 011000                    NOP     0

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:549  
     4103    28115    5               GOTO READ_BACKUP_ERR10;

  28115 20 014544   015107 710000 20                 TRA     READ_BACKUP_ERR10

     4104    28116    5               END;
     4105    28117    4            DISK_OPTION.PAD = DISK_OPTION_PAD_SAVE;

  28117 20 014545   200033 236100                    LDQ     DISK_OPTION_PAD_SAVE,,AUTO
        20 014546   000004 772000                    QRL     4
        20 014547   000000 676000 xsym               ERQ     DISK_OPTION
        20 014550   020000 376003                    ANQ     8192,DU
        20 014551   000000 656000 xsym               ERSQ    DISK_OPTION

     4106    28118    4            DISK_OPTION.DIR = DISK_OPTION_DIR_SAVE;

  28118 20 014552   200032 236100                    LDQ     DISK_OPTION_DIR_SAVE,,AUTO
        20 014553   000000 676000 xsym               ERQ     DISK_OPTION
        20 014554   400000 376003                    ANQ     -131072,DU
        20 014555   000000 656000 xsym               ERSQ    DISK_OPTION

     4107    28119
     4108    28120    4            DISK_OPEN.IFPARAM_ = FPARAM_;

  28120 20 014556   200034 237100                    LDAQ    FPARAM_,,AUTO
        20 014557   000026 757000 xsym               STAQ    DISK_OPEN+22

     4109    28121    4            CALL M$OPEN( DISK_OPEN ) ALTRET(READ_BACKUP_ERR); /* Create *:BACKUP */

  28121 20 014560   000000 630400 xsym               EPPR0   DISK_OPEN
        20 014561   450000 713400                    CLIMB   alt,open
        20 014562   410400 401760                    pmme    nvectors=18
        20 014563   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4110    28122    4            DISK_WRITE.KEY_ = VECTOR(NIL);

  28122 20 014564   000210 237000 21                 LDAQ    136
        20 014565   000002 757000 xsym               STAQ    DISK_WRITE+2
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:550  

     4111    28123
     4112    28124    5            DO WHILE ( NOT ERR );

  28124 20 014566   014615 710000 20                 TRA     s:28131

     4113    28125    5              CALL FLC$TAPE_READ_NEXT( BUF_, ARS, ERR ) /* Copy :BACKUP to *:BACKUP */

  28125 20 014567   000213 236000 21                 LDQ     139
        20 014570   200044 756100                    STQ     @MAX_NX+3,,AUTO
        20 014571   200036 630500                    EPPR0   ARS,,AUTO
        20 014572   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 014573   200040 631500                    EPPR1   BUF_,,AUTO
        20 014574   200042 451500                    STP1    @MAX_NX+1,,AUTO
        20 014575   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 014576   000021 631400 xsym               EPPR1   B_VECTNIL+17
        20 014577   000000 701000 xent               TSX1    FLC$TAPE_READ_NEXT
        20 014600   014615 702000 20                 TSX2    s:28131

     4114    28126    6                WHENRETURN DO;

     4115    28127    6                  DISK_WRITE.BUF_ = BUF_;

  28127 20 014601   200040 237100                    LDAQ    BUF_,,AUTO
        20 014602   000004 757000 xsym               STAQ    DISK_WRITE+4

     4116    28128    6                  DISK_WRITE.BUF_.BOUND = ARS - 1;

  28128 20 014603   200036 236100                    LDQ     ARS,,AUTO
        20 014604   000001 136007                    SBLQ    1,DL
        20 014605   000020 736000                    QLS     16
        20 014606   000004 676000 xsym               ERQ     DISK_WRITE+4
        20 014607   000034 376000 xsym               ANQ     B_VECTNIL+28
        20 014610   000004 656000 xsym               ERSQ    DISK_WRITE+4

     4117    28129    6                  CALL M$WRITE( DISK_WRITE ) ALTRET(READ_BACKUP_ERR);

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:551  
  28129 20 014611   000000 630400 xsym               EPPR0   DISK_WRITE
        20 014612   440001 713400                    CLIMB   alt,write
        20 014613   401400 401760                    pmme    nvectors=4
        20 014614   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4118    28130    6                  END;

     4119    28131    5               END;

  28131 20 014615   002357 235000 2                  LDA     ERR
        20 014616   014567 600000 20                 TZE     s:28125

     4120    28132
     4121    28133    4            LAST_TAPE_FSN = 9999;

  28133 20 014617   023417 236007                    LDQ     9999,DL
        20 014620   000000 756000 xsym               STQ     LAST_TAPE_FSN

     4122    28134    4            DISK_CLOSE.V.DISP# = %SAVE#;

  28134 20 014621   000002 236007                    LDQ     2,DL
        20 014622   000032 552004 xsym               STBQ    DISK_CLOSE+26,'04'O

     4123    28135    4            DISK_CLOSE.V.EFTOPER = '0'B;

  28135 20 014623   000224 236000 21                 LDQ     148
        20 014624   000032 356000 xsym               ANSQ    DISK_CLOSE+26

     4124    28136    4            CALL M$CLOSE( DISK_CLOSE ) ALTRET(READ_BACKUP_ERR);

  28136 20 014625   000000 630400 xsym               EPPR0   DISK_CLOSE
        20 014626   450001 713400                    CLIMB   alt,close
        20 014627   406000 401760                    pmme    nvectors=13
        20 014630   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4125    28137    4            DISK_CLOSE.IFPARAM_ = VECTOR(NIL);

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:552  
  28137 20 014631   000210 237000 21                 LDAQ    136
        20 014632   000026 757000 xsym               STAQ    DISK_CLOSE+22

     4126    28138    4            DISK_CLOSE.V.DESC = '0'B;

  28138 20 014633   000000 220003                    LDX0    0,DU
        20 014634   000033 740000 xsym               STX0    DISK_CLOSE+27

     4127    28139    4            CALL M$CLOSE( TAPE_CLOSE ) ALTRET(READ_BACKUP_ERR);

  28139 20 014635   000000 630400 xsym               EPPR0   TAPE_CLOSE
        20 014636   450001 713400                    CLIMB   alt,close
        20 014637   406000 401760                    pmme    nvectors=13
        20 014640   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4128    28140    4            TAPE_REWIND.V.PSN# = DCBADDR(DCBNUM(M$TAPE00)) -> F$DCB.PSN#;

  28140 20 014641   000000 236007 xsym               LDQ     M$TAPE00,DL
        20 014642   000000 470400 21                 LDP0    0
        20 014643   000000 471500                    LDP1    0,,PR0
        20 014644   100000 473506                    LDP3    0,QL,PR1
        20 014645   040000 100500                    MLR     fill='040'O
        20 014646   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
        20 014647   000002 400006 xsym               ADSC9   TAPE_REWIND+2            cn=2,n=6

     4129    28141    4            CALL M$REM ( TAPE_REWIND );

  28141 20 014650   000000 630400 xsym               EPPR0   TAPE_REWIND
        20 014651   060006 713400                    CLIMB   24582
        20 014652   400000 401760                    pmme    nvectors=1

     4130    28142    4            RETURN;

  28142 20 014653   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 014654   000001 702211                    TSX2  ! 1,X1

     4131    28143
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:553  
     4132    28144    4          CASE( %REBUILD_FILE_SOURCE );    /* Copy :BACKUP file from fid         */

     4133    28145
     4134    28146    4            FPT_FID.TEXTFID_ = VECTOR(SUBNODE$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  28146 20 014655   300003 474500                    LDP4    3,,PR3
        20 014656   400004 236100                    LDQ     4,,PR4
        20 014657   000033 772000                    QRL     27
        20 014660   000064 737000                    LLS     52
        20 014661   000140 135007                    SBLA    96,DL
        20 014662   200042 454500                    STP4    @MAX_NX+1,,AUTO
        20 014663   200042 236100                    LDQ     @MAX_NX+1,,AUTO
        20 014664   000027 036000 21                 ADLQ    23
        20 014665   001320 757000 2                  STAQ    FPT_FID+2

     4135    28147    4            CALL M$FID( FPT_FID ) ALTRET(READ_BACKUP_ERR);

  28147 20 014666   001316 630400 2                  EPPR0   FPT_FID
        20 014667   420001 713400                    CLIMB   alt,+8193
        20 014670   404400 401760                    pmme    nvectors=10
        20 014671   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4136    28148    4            OPEN_BACKUP_RBLDFILE.V.RES# = OPEN_FID.V.RES#;

  28148 20 014672   001274 236000 2                  LDQ     OPEN_FID+40
        20 014673   002066 756000 2                  STQ     OPEN_BACKUP_RBLDFILE+40

     4137    28149    4            CALL M$OPEN( OPEN_BACKUP_RBLDFILE) ALTRET(READ_BACKUP_ERR);

  28149 20 014674   002016 630400 2                  EPPR0   OPEN_BACKUP_RBLDFILE
        20 014675   450000 713400                    CLIMB   alt,open
        20 014676   410400 401760                    pmme    nvectors=18
        20 014677   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4138    28150    4           IF DCBADDR(DCBNUM(M$STATUS))->F$DCB.ORG# ~= %KEYED# /* Verify if :BACKUP */

  28150 20 014700   000000 236007 xsym               LDQ     M$STATUS,DL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:554  
        20 014701   000000 470400 21                 LDP0    0
        20 014702   000000 471500                    LDP1    0,,PR0
        20 014703   100000 473506                    LDP3    0,QL,PR1
        20 014704   300032 236100                    LDQ     26,,PR3
        20 014705   777000 376003                    ANQ     -512,DU
        20 014706   002000 116003                    CMPQ    1024,DU
        20 014707   014723 600000 20                 TZE     s:28157

     4139    28151    5             THEN DO;

     4140    28152    5               DCB# = DCBNUM(M$STATUS);

  28152 20 014710   000000 236007 xsym               LDQ     M$STATUS,DL
        20 014711   200027 756100                    STQ     DCB#,,AUTO

     4141    28153    5               CALL FLI$RPT_ERR( E_BAD_BKUP_FILE, DCB# );

  28153 20 014712   200027 633500                    EPPR3   DCB#,,AUTO
        20 014713   200043 453500                    STP3    @MAX_NX+2,,AUTO
        20 014714   000225 236000 21                 LDQ     149
        20 014715   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 014716   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 014717   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 014720   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 014721   000000 011000                    NOP     0

     4142    28154    5               GOTO READ_BACKUP_ERR10;

  28154 20 014722   015107 710000 20                 TRA     READ_BACKUP_ERR10

     4143    28155    5               END;
     4144    28156
     4145    28157    4            OPEN_BACKUP_TEMP.V.FUN# = %CREATE#;

  28157 20 014723   003000 236007                    LDQ     1536,DL
        20 014724   002155 552010 2                  STBQ    OPEN_BACKUP_TEMP+37,'10'O

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:555  
     4146    28158    4            CALL M$OPEN( OPEN_BACKUP_TEMP ) ALTRET(READ_BACKUP_ERR);

  28158 20 014725   002110 630400 2                  EPPR0   OPEN_BACKUP_TEMP
        20 014726   450000 713400                    CLIMB   alt,open
        20 014727   410400 401760                    pmme    nvectors=18
        20 014730   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4147    28159
     4148    28160    4            READ_STATUS.V.KEYS# = '0'B;

  28160 20 014731   000053 236000 21                 LDQ     43
        20 014732   000010 356000 xsym               ANSQ    READ_STATUS+8

     4149    28161    4            FIRST = '1'B;

  28161 20 014733   400000 236003                    LDQ     -131072,DU
        20 014734   200031 756100                    STQ     FIRST,,AUTO

     4150    28162    4   READ_LOOP:
     4151    28163    5            DO WHILE( '1'B );

  28163 20 014735                       READ_LOOP    null
     4152    28164    5               CALL M$READ( READ_STATUS )

  28164 20 014735   000000 630400 xsym               EPPR0   READ_STATUS
        20 014736   440000 713400                    CLIMB   alt,read
        20 014737   401400 401760                    pmme    nvectors=4
        20 014740   014742 702000 20                 TSX2    s:28166
        20 014741   014761 710000 20                 TRA     s:28172

     4153    28165    6                WHENALTRETURN DO;

     4154    28166    6                  IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$EOF

  28166 20 014742   000000 470400 xsym               LDP0    B$TCB$
        20 014743   000000 471500                    LDP1    0,,PR0
        20 014744   100102 236100                    LDQ     66,,PR1
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:556  
        20 014745   377770 376007                    ANQ     131064,DL
        20 014746   000060 116007                    CMPQ    48,DL
        20 014747   015104 601000 20                 TNZ     READ_BACKUP_ERR

     4155    28167    6                   THEN GOTO READ_BACKUP_ERR;
     4156    28168    6                  CALL M$CLOSE( CLOSE_STATUS ) ALTRET(READ_BACKUP_ERR);

  28168 20 014750   000000 630400 xsym               EPPR0   CLOSE_STATUS
        20 014751   450001 713400                    CLIMB   alt,close
        20 014752   406000 401760                    pmme    nvectors=13
        20 014753   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4157    28169    6                  CALL M$CLOSE( CLOSE_BACKUP_TEMP ) ALTRET(READ_BACKUP_ERR);

  28169 20 014754   002240 630400 2                  EPPR0   CLOSE_BACKUP_TEMP
        20 014755   450001 713400                    CLIMB   alt,close
        20 014756   406000 401760                    pmme    nvectors=13
        20 014757   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4158    28170    6                  EXIT READ_LOOP;

  28170 20 014760   015017 710000 20                 TRA     s:28189

     4159    28171    6                  END;
     4160    28172    5               IF FIRST                    /* Verify if a valid :BACKUP file     */

  28172 20 014761   200031 234100                    SZN     FIRST,,AUTO
        20 014762   015012 605000 20                 TPL     s:28185

     4161    28173    6                THEN DO;

     4162    28174    6                  IF STATUS_KEY.L ~= LENGTHV( STATUS_KEY )

  28174 20 014763   000000 236000 xsym               LDQ     STATUS_KEY
        20 014764   777000 376003                    ANQ     -512,DU
        20 014765   003000 116003                    CMPQ    1536,DU
        20 014766   014776 601000 20                 TNZ     s:28179
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:557  
        20 014767   000000 236000 xsym               LDQ     STATUS_KEY
        20 014770   000777 316003                    CANQ    511,DU
        20 014771   014776 601000 20                 TNZ     s:28179
        20 014772   777000 316007                    CANQ    -512,DL
        20 014773   014776 601000 20                 TNZ     s:28179
        20 014774   000777 316007                    CANQ    511,DL
        20 014775   015011 600000 20                 TZE     s:28183

     4163    28175    6                    OR STATUS_KEY.RUN_NBR ~= 0
     4164    28176    6                    OR STATUS_KEY.TSN_SET_NBR ~= 0
     4165    28177    6                    OR STATUS_KEY.TSN_VOL ~= 0
     4166    28178    7                   THEN DO;

     4167    28179    7                     DCB# = DCBNUM(M$STATUS);

  28179 20 014776   000000 236007 xsym               LDQ     M$STATUS,DL
        20 014777   200027 756100                    STQ     DCB#,,AUTO

     4168    28180    7                     CALL FLI$RPT_ERR( E_BAD_BKUP_FILE, DCB# );

  28180 20 015000   200027 630500                    EPPR0   DCB#,,AUTO
        20 015001   200043 450500                    STP0    @MAX_NX+2,,AUTO
        20 015002   000225 236000 21                 LDQ     149
        20 015003   200042 756100                    STQ     @MAX_NX+1,,AUTO
        20 015004   200042 630500                    EPPR0   @MAX_NX+1,,AUTO
        20 015005   000020 631400 xsym               EPPR1   B_VECTNIL+16
        20 015006   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 015007   000000 011000                    NOP     0

     4169    28181    7                     GOTO READ_BACKUP_ERR10;

  28181 20 015010   015107 710000 20                 TRA     READ_BACKUP_ERR10

     4170    28182    7                     END;
     4171    28183    6                   ELSE FIRST = '0'B;

  28183 20 015011   200031 450100                    STZ     FIRST,,AUTO
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:558  

     4172    28184    6                  END;

     4173    28185    5               CALL M$WRITE( WRITE_BACKUP_TEMP ) ALTRET(READ_BACKUP_ERR);

  28185 20 015012   002224 630400 2                  EPPR0   WRITE_BACKUP_TEMP
        20 015013   440001 713400                    CLIMB   alt,write
        20 015014   401400 401760                    pmme    nvectors=4
        20 015015   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4174    28186    5               END;

  28186 20 015016   014735 710000 20                 TRA     READ_LOOP

     4175    28187
     4176    28188    4          END;

     4177    28189    3         END;

  28189 20 015017   015051 710000 20                 TRA     READ_LOOP5

     4178    28190    3       ELSE DO;                  /* Copy :BACKUP file from destination packset   */

     4179    28191    3         FID_NAME = BACKUP_NAME;

  28191 20 015020   000000 236000 xsym               LDQ     BACKUP_NAME
        20 015021   000033 772000                    QRL     27
        20 015022   000001 624006                    EAX4    1,QL
        20 015023   000000 100440                    MLR     fill='000'O
        20 015024   000000 000014 xsym               ADSC9   BACKUP_NAME              cn=0,n=*X4
        20 015025   001360 000040 2                  ADSC9   FID_NAME                 cn=0,n=32

     4180    28192    3         FID_ACCT = BACKUP_ACCT;

  28192 20 015026   000140 237000 2                  LDAQ    BACKUP_ACCT
        20 015027   001370 757000 2                  STAQ    FID_ACCT

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:559  
     4181    28193    3         FID_SN.SN#(0) = DISK_DEST_SN.SN#(0);

  28193 20 015030   040000 100400                    MLR     fill='040'O
        20 015031   000001 000006 xsym               ADSC9   DISK_DEST_SN+1           cn=0,n=6
        20 015032   001375 000006 2                  ADSC9   FID_SN+1                 cn=0,n=6

     4182    28194    3         OPEN_BACKUP_RBLDFILE.V.RES# = DISK_DEST_RES.NAME;

  28194 20 015033   000001 236000 xsym               LDQ     DISK_DEST_RES+1
        20 015034   002066 756000 2                  STQ     OPEN_BACKUP_RBLDFILE+40

     4183    28195    3         CALL M$OPEN( OPEN_BACKUP_RBLDFILE ) ALTRET(READ_BACKUP_ERR);

  28195 20 015035   002016 630400 2                  EPPR0   OPEN_BACKUP_RBLDFILE
        20 015036   450000 713400                    CLIMB   alt,open
        20 015037   410400 401760                    pmme    nvectors=18
        20 015040   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4184    28196
     4185    28197    3         OPEN_BACKUP_TEMP.V.FUN# = %CREATE#;

  28197 20 015041   003000 236007                    LDQ     1536,DL
        20 015042   002155 552010 2                  STBQ    OPEN_BACKUP_TEMP+37,'10'O

     4186    28198    3         CALL M$OPEN( OPEN_BACKUP_TEMP ) ALTRET(READ_BACKUP_ERR);

  28198 20 015043   002110 630400 2                  EPPR0   OPEN_BACKUP_TEMP
        20 015044   450000 713400                    CLIMB   alt,open
        20 015045   410400 401760                    pmme    nvectors=18
        20 015046   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4187    28199
     4188    28200    3         READ_STATUS.V.KEYS# = '0'B;

  28200 20 015047   000053 236000 21                 LDQ     43
        20 015050   000010 356000 xsym               ANSQ    READ_STATUS+8

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:560  
     4189    28201    3         END;

     4190    28202    2   READ_LOOP5:
     4191    28203    3      DO WHILE( '1'B );

  28203 20 015051                       READ_LOOP5   null
     4192    28204    3         CALL M$READ( READ_STATUS )

  28204 20 015051   000000 630400 xsym               EPPR0   READ_STATUS
        20 015052   440000 713400                    CLIMB   alt,read
        20 015053   401400 401760                    pmme    nvectors=4
        20 015054   015056 702000 20                 TSX2    s:28206
        20 015055   015075 710000 20                 TRA     s:28212

     4193    28205    4          WHENALTRETURN DO;

     4194    28206    4            IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$EOF

  28206 20 015056   000000 470400 xsym               LDP0    B$TCB$
        20 015057   000000 471500                    LDP1    0,,PR0
        20 015060   100102 236100                    LDQ     66,,PR1
        20 015061   377770 376007                    ANQ     131064,DL
        20 015062   000060 116007                    CMPQ    48,DL
        20 015063   015104 601000 20                 TNZ     READ_BACKUP_ERR

     4195    28207    4             THEN GOTO READ_BACKUP_ERR;
     4196    28208    4            CALL M$CLOSE( CLOSE_STATUS ) ALTRET(READ_BACKUP_ERR);

  28208 20 015064   000000 630400 xsym               EPPR0   CLOSE_STATUS
        20 015065   450001 713400                    CLIMB   alt,close
        20 015066   406000 401760                    pmme    nvectors=13
        20 015067   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4197    28209    4            CALL M$CLOSE( CLOSE_BACKUP_TEMP ) ALTRET(READ_BACKUP_ERR);

  28209 20 015070   002240 630400 2                  EPPR0   CLOSE_BACKUP_TEMP
        20 015071   450001 713400                    CLIMB   alt,close
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:561  
        20 015072   406000 401760                    pmme    nvectors=13
        20 015073   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4198    28210    4            EXIT READ_LOOP5;

  28210 20 015074   015102 710000 20                 TRA     s:28214

     4199    28211    4            END;
     4200    28212    3         CALL M$WRITE( WRITE_BACKUP_TEMP ) ALTRET(READ_BACKUP_ERR);

  28212 20 015075   002224 630400 2                  EPPR0   WRITE_BACKUP_TEMP
        20 015076   440001 713400                    CLIMB   alt,write
        20 015077   401400 401760                    pmme    nvectors=4
        20 015100   015104 702000 20                 TSX2    READ_BACKUP_ERR

     4201    28213    3         END;

  28213 20 015101   015051 710000 20                 TRA     READ_LOOP5

     4202    28214    2      RETURN;

  28214 20 015102   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 015103   000001 702211                    TSX2  ! 1,X1

     4203    28215
     4204    28216    2   READ_BACKUP_ERR:
     4205    28217    2      CALL FLI$RPT_ERR;

  28217 20 015104   000002 631400 xsym  READ_BACKUP* EPPR1   B_VECTNIL+2
        20 015105   000000 701000 xent               TSX1    FLI$RPT_ERR
        20 015106   000000 011000                    NOP     0

     4206    28218    2   READ_BACKUP_ERR10:
     4207    28219    2      IF DCBADDR(DCBNUM(M$TAPE00)) -> F$DCB.FCD#

  28219 20 015107   000000 236007 xsym  READ_BACKUP* LDQ     M$TAPE00,DL
        20 015110   000000 470400 21                 LDP0    0
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:562  
        20 015111   000000 471500                    LDP1    0,,PR0
        20 015112   100000 473506                    LDP3    0,QL,PR1
        20 015113   300031 236100                    LDQ     25,,PR3
        20 015114   020000 316007                    CANQ    8192,DL
        20 015115   015121 600000 20                 TZE     s:28221

     4208    28220    2       THEN CALL M$CLOSE (TAPE_CLOSE);

  28220 20 015116   000000 630400 xsym               EPPR0   TAPE_CLOSE
        20 015117   050001 713400                    CLIMB   close
        20 015120   406000 401760                    pmme    nvectors=13

     4209    28221    2      IF DCBADDR(DCBNUM(M$DISK00)) -> F$DCB.FCD#

  28221 20 015121   000000 236007 xsym               LDQ     M$DISK00,DL
        20 015122   000000 470400 21                 LDP0    0
        20 015123   000000 471500                    LDP1    0,,PR0
        20 015124   100000 473506                    LDP3    0,QL,PR1
        20 015125   300031 236100                    LDQ     25,,PR3
        20 015126   020000 316007                    CANQ    8192,DL
        20 015127   015133 600000 20                 TZE     s:28223

     4210    28222    2       THEN CALL M$CLOSE (DISK_CLOSE);

  28222 20 015130   000000 630400 xsym               EPPR0   DISK_CLOSE
        20 015131   050001 713400                    CLIMB   close
        20 015132   406000 401760                    pmme    nvectors=13

     4211    28223    2      IF DCBADDR(DCBNUM(M$STATUS)) -> F$DCB.FCD#

  28223 20 015133   000000 236007 xsym               LDQ     M$STATUS,DL
        20 015134   000000 470400 21                 LDP0    0
        20 015135   000000 471500                    LDP1    0,,PR0
        20 015136   100000 473506                    LDP3    0,QL,PR1
        20 015137   300031 236100                    LDQ     25,,PR3
        20 015140   020000 316007                    CANQ    8192,DL
        20 015141   015145 600000 20                 TZE     s:28225
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:563  

     4212    28224    2       THEN CALL M$CLOSE (CLOSE_STATUS);

  28224 20 015142   000000 630400 xsym               EPPR0   CLOSE_STATUS
        20 015143   050001 713400                    CLIMB   close
        20 015144   406000 401760                    pmme    nvectors=13

     4213    28225    2      ALTRETURN;

  28225 20 015145   200026 221300                    LDX1  ! NEW_REBUILD+6,,AUTO
        20 015146   000000 702211                    TSX2  ! 0,X1

     4214    28226    2   END FLB_READ_BACKUP;
     4215    28227    1      END FLB$EFT;

  28227 20 015147   000000 702200 xent               TSX2  ! X66_MARET
     4216    28228        %EOD;

PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:564  
--  Include file information  --

   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XUR_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XUD_UTS_M.:E05TOU  is referenced.
   FM$GRAN.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   FLW_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FLN_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLB$EFT.
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:565  

 **** Variables and constants ****

  ****  Section 002  Data  FLB$EFT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   447-0-0/c STRC(72)    r     1 ACCT                    2320-0-0/b BIT         r     1 AFT
  2322-0-0/w SBIN        r     1 AFT_DELTA                172-0-0/c STRC(126)   r     1 ANSDATE
   172-0-0/c STRC(126)   r     1 ANSDATEPIECE             251-0-0/b BIT         r     1 BACKUP_$$EFT
   140-0-0/c STRC(72)    r     1 BACKUP_ACCT                3-0-0/c STRC(108)   r     1 BACKUP_CMD_FNAME
  1626-0-0/d STRC(2088)  r     1 BACKUP_CMD_OPEN         2202-0-0/c STRC(81)    r     1 BACKUP_TEMP
  2321-0-0/b BIT         r     1 BEF                     2323-0-0/w SBIN        r     1 BEF_DELTA
   155-0-0/b BIT         r     1 BREAK_CONTINUED          154-0-0/w SBIN        r     1 BREAK_COUNT
   156-0-0/w SBIN        r     1 BREAK_DCB#               157-0-0/c CHAR(18)    r     1 BREAK_TASK
  2330-0-0/w SBIN        r     1 C                        506-0-0/d STRC(2088)  r     1 CHECK_PACKSET
   165-0-0/b BIT         r     1 CHECK_TAPE              1720-0-0/d STRC(144)   r     1 CHKEFTRUN
  2240-0-0/d STRC(1080)  r     1 CLOSE_BACKUP_TEMP        100-0-0/d STRC(1080)  r     1 CLOSE_BLOCK_FILE
  1036-0-0/d STRC(1080)  r     1 CLOSE_FID               1166-0-0/d STRC(1080)  r     1 CLOSE_READ_FILE
   166-0-0/w SBIN        r     1 CODE                     167-0-0/w SBIN        r     1 COMMAND
  2327-0-0/w SBIN        r     1 CX                      2306-0-0/w SBIN        r     1 DATENODEX
   171-0-0/w UBIN        r     1 DATEUTS                 2304-0-0/w SBIN        r     1 DATEX
  2303-0-0/w PTR         r     1 DATE_NODE$              2316-0-0/w SBIN        r     1 DATE_TYPE
  2312-0-0/w PTR         r     1 DECIMAL$                2305-0-0/w SBIN        r     1 DECNODEX
   142-0-0/d STRC(360)   r     1 DEL_NODATA_REC          2324-0-0/b BIT         r     1 DISK_AND
   502-0-0/d STRC(90)    r     1 DPSN                     255-0-0/w STRC(504)   r     1 EFT_CMD_PCB
   612-0-0/d STRC(360)   r     1 ERASE_HEADER             226-0-0/w STRC        r     1 ERR
  2357-0-0/w STRC        r     1 ERR                     1370-0-0/c STRC(72)    r     1 FID_ACCT
  1360-0-0/c STRC(288)   r     1 FID_NAME                1372-0-0/c STRC(72)    r     1 FID_PASS
  2326-0-0/w PTR         r     1 FID_RANGE_SUBLK$        1374-0-0/d STRC(576)   r     1 FID_SN
  1414-0-0/c STRC(72)    r     1 FID_WSN                  437-0-0/c STRC(288)   r     1 FILE
   244-0-0/c STRC(72)    r     1 FIRST_ACCT_SPECIFIED     176-0-0/b BIT         r     1 FIRST_TIME
  1316-0-0/d STRC(864)   r     1 FPT_FID                 1346-0-0/d STRC(324)   r     1 FPT_FID_RESULTS
  1510-0-0/d STRC(144)   r     1 FPT_REM                  640-0-0/d STRC(432)   r     1 GET_ANSDATE_DATEUTS
   654-0-0/d STRC(432)   r     1 GET_DATEUTS_ANSDATE      670-0-0/d STRC(432)   r     1 GET_GREETING_TIME
   626-0-0/d STRC(288)   r     1 GET_PSN                  177-0-0/c STRC(288)   r     1 GREETINGS
   720-0-0/d STRC(432)   r     1 GREET_TEST_USER          704-0-0/d STRC(432)   r     1 GREET_USER
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:566  
   213-0-0/w SBIN        r     1 I                       2331-0-0/w SBIN        r     1 I
  2334-0-0/w SBIN        r     1 I_SWAP                   246-0-0/w SBIN        r     1 J
  2332-0-0/w SBIN        r     1 J                       2335-0-0/w SBIN        r     1 LAST_RANGEX
  2333-0-0/w SBIN        r     1 M                        217-0-0/w PTR         r     1 M$CATALOG$
   216-0-0/w PTR         r     1 M$LO$                    214-0-0/w PTR         r     1 M$READ_FILE$
   215-0-0/w PTR         r     1 M$SI$                    250-0-0/w SBIN        r     1 MODE
   220-0-0/d STRC(90)    r     1 MUCK_LIST                224-0-0/w SBIN        r     1 N
  2355-0-0/w SBIN        r     1 N                       2356-0-0/w SBIN        r     1 N
   225-0-0/w SBIN        r     1 NBR_DPS                  226-0-0/w PTR         r     1 NODE$
  2314-0-0/b BIT         r     1 NOT_SPECIFIED           2016-0-0/d STRC(2088)  r     1 OPEN_BACKUP_RBLDFILE
  2110-0-0/d STRC(2088)  r     1 OPEN_BACKUP_TEMP           6-0-0/d STRC(2088)  r     1 OPEN_BLOCK_FILE
  1416-0-0/d STRC(2088)  r     1 OPEN_DEFAULT_LO         1224-0-0/d STRC(2088)  r     1 OPEN_FID
   744-0-0/d STRC(2088)  r     1 OPEN_LO_DO              1074-0-0/d STRC(2088)  r     1 OPEN_SI
   253-0-0/w STRC(7)     r     1 OPTION_MAP               636-0-0/c STRC(72)    r     1 OUR_ACCT
  1514-0-0/d STRC(360)   r     1 PAGE_LO                  624-0-0/w STRC(54)    r     1 PAGE_LO_HEADER
   600-0-0/d STRC(360)   r     1 PAGE_LO_RESET            240-0-0/c STRC(72)    r     1 PREV_ACCT
   170-0-0/w SBIN        r     1 PREV_COMMAND            2276-0-0/d STRC(90)    r     1 PREV_TAPE_SN
  2354-0-0/b BIT         r     1 RANGE_FOUND              242-0-0/b BIT         r     1 RANGE_SPECIFIED
  2336-0-0/w PTR         r     1 RANGE_START$            2337-0-0/w PTR         r     1 RANGE_STOP$
  2206-0-0/d STRC(504)   r     1 READ_BACKUP_TEMP         164-0-0/b BIT         r     1 RESTORE_FROM_TAPE
  1530-0-0/c STRC(90)    r     1 RET_CMDS_FNAME          1534-0-0/d STRC(2088)  r     1 RET_CMDS_OPEN
  1724-0-0/d STRC(2088)  r     1 SAVE_TAPE_OPEN           243-0-0/b BIT         r     1 SKIP_SPECIFIED
  2340-0-0/w PTR         r     1 SKIP_START$             2341-0-0/w PTR         r     1 SKIP_STOP$
   230-0-0/w PTR         r     1 SOURCE_TAPE_SNLIST$      254-0-0/b STRC(3)     r     1 SRCH_BIT
   461-0-0/c STRC(72)    r     1 START_ACCT               451-0-0/c STRC(288)   r     1 START_FILE
   247-0-0/w SBIN        r     1 STATE                    473-0-0/c STRC(72)    r     1 STOP_ACCT
   463-0-0/c STRC(288)   r     1 STOP_FILE                231-0-0/w PTR         r     1 SUBNODE$
   232-0-0/w SBIN        r     1 SUBNODEX                 233-0-0/w PTR         r     1 SUBSUBNODE$
   234-0-0/w SBIN        r     1 SUBSUBNODEX              235-0-0/w SBIN        r     1 SUBSUBSUBNODEX
   252-0-0/w SBIN        r     1 SUB_COMMAND              740-0-0/d STRC(144)   r     1 SWITCH_FMEFT
   734-0-0/d STRC(144)   r     1 SWITCH_FMSEC             236-0-0/w SBIN        r     1 TEMP
   237-0-0/w PTR         r     1 TEMP$                   2342-0-0/c CHAR(40)    r     1 TEMP_SPEC
   207-0-0/c STRC(135)   r     1 TEST_GREETINGS          2307-0-0/w PTR         r     1 TIMENODE$
  2311-0-0/w SBIN        r     1 TIMEX                   2310-0-0/b BIT         r     1 TIME_SPECIFIED
  2317-0-0/b BIT         r     1 USE_ANSDATE              436-0-0/w STRC        r     1 VLP_ERRCODE
  2315-0-0/w SBIN        r     1 WHAT_DATE               2224-0-0/d STRC(432)   r     1 WRITE_BACKUP_TEMP
   344-0-0/d STRC(2052)  r     1 XUH_PARAM                274-0-0/d STRC(1404)  r     1 XUR_INIT
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:567  

  ****  Section 019 RoData FLB$EFT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    14-0-0/w STRC(288)   r     1 DATE_INFO(0:3)
     6-0-0/c CHAR        r     1 EFT_PROMPT                54-0-0/w UBIN(9)     r     1 FIRST_LEGAL_CHAR
     0-0-0/c STRC(162)   r     1 FLERRMSGSYS               10-0-0/d STRC(144)   r     1 FPT_INT
    55-0-0/w UBIN(9)     r     1 LAST_LEGAL_CHAR
    56-0-0/b BIT         r     1 LEGAL_CHAR(0:127)
     5-0-0/c CHAR        r     1 PROMPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    37-0-0/w PTR         r     1 @DATEFIELD                33-0-0/w PTR         r     1 @FID_RANGE$
    35-0-0/w PTR         r     1 @FILE_N_ACCOUNT$          31-0-0/w PTR         r     1 @LAST_T_FSN
    41-0-0/w PTR         r     1 @MAX_NX                   41-0-0/w PTR         r     1 @MAX_NX
    40-0-0/w PTR         r     1 @N                        40-0-0/w PTR         r     1 @N
    37-0-0/w PTR         r     1 @NAMEB                    37-0-0/w PTR         r     1 @NAMEB
    36-0-0/w PTR         r     1 @RANGE                    35-0-0/w PTR         r     1 @SPEC
    35-0-0/w PTR         r     1 @SPEC                     11-0-0/w PTR         r     1 @SUBNODE$
    31-0-0/w PTR         r     1 @SUBNODEY                 27-0-0/w PTR         r     1 @T_DENSITY
    30-0-0/w PTR         r     1 @T_FSN                    32-0-0/w PTR         r     1 @T_IOERROK
    36-0-0/w SBIN        r     1 ARS                       40-0-0/d STRC(72)    r     1 BUF_
     3-0-0/b BIT         r     1 CHECK_SRCH_BIT            34-0-0/c STRC(45)    r     1 CT5FMT
    34-0-0/c CHAR(5)     r     1 CT5FMTCHARS               36-0-0/c STRC(54)    r     1 CT6FMT
    36-0-0/c CHAR(6)     r     1 CT6FMTCHARS               *0-0-0/c CHAR(2)     r     1 DATEFIELD
     6-0-0/w SBIN        r     1 DCB#                      27-0-0/w UBIN        r     1 DCB#
     5-0-0/w PTR         r     1 DCB$                      10-0-0/w SBIN        r     1 DEST_TAPE_VOL_SAVE
    32-0-0/b BIT         r     1 DISK_OPTION_DIR_SAVE      33-0-0/b BIT         r     1 DISK_OPTION_PAD_SAVE
    *0-0-0/w PTR         r     1 FID_RANGE$                *0-0-0/w PTR         r     1 FILE_N_ACCOUNT$
     7-0-0/b BIT         r     1 FILE_OPEN                 31-0-0/b BIT         r     1 FIRST
    34-0-0/d STRC(72)    r     1 FPARAM_                    6-0-0/b BIT         r     1 FSN_SPECD
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:568  
     7-0-0/w UBIN        r     1 GRAND_START_UTS            5-0-0/w SBIN        r     1 GRAND_TOTAL_FILES
     6-0-0/w SBIN        r     1 GRAND_TOTAL_GRANS          5-0-0/w UBIN        r     1 I
     6-0-0/w SBIN        r     1 INCR                      *0-0-0/w UBIN        r     1 LAST_T_FSN
    *0-0-0/w SBIN        r     1 MAX_NX                    *0-0-0/w SBIN        r     1 MAX_NX
    *0-0-0/w SBIN        r     1 N                         *0-0-0/w SBIN        r     1 N
    27-0-0/w SBIN        r     1 N                         *0-0-0/c UBIN(9)     r     1 NAMEB(0:0)
    *0-0-0/c UBIN(9)     r     1 NAMEB(0:0)                14-0-0/w UBIN        r     1 NBR_RUNS
    20-0-0/b BIT         r     1 NEW_REBUILD               30-0-0/w SBIN        r     1 NN
    27-0-0/b BIT         r     1 NODE_ERROR                *0-0-0/w UBIN        r     1 RANGE
    32-0-0/w PTR         r     1 SNLIST$                   33-0-0/w PTR         r     1 SNLISTINFO$
    31-0-0/w UBIN        r     1 SNSIZE                    30-0-0/w PTR         r     1 SOURCE_DCB$
    *0-0-0/c STRC(360)   r     1 SPEC                      *0-0-0/c STRC(360)   r     1 SPEC
    *0-0-0/w PTR         r     1 SUBNODE$                  13-0-0/w SBIN        r     1 SUBNODEX
     5-0-0/w SBIN        r     1 SUBNODEY                  *0-0-0/w SBIN        r     1 SUBNODEY
    12-0-0/w PTR         r     1 SUBSUBNODE$               16-0-0/w UBIN        r     1 TAPE_DENSITY
    15-0-0/w UBIN        r     1 TAPE_FSN                  17-0-0/b BIT         r     1 TAPE_IOERROK
     7-0-0/w PTR         r     1 TEMP$                     *0-0-0/w UBIN        r     1 T_DENSITY
    *0-0-0/w UBIN        r     1 T_FSN                     *0-0-0/w BIT         r     1 T_IOERROK

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 ACCUMULATED_BREAK_TIME
     0-0-0/w UBIN        r     1 ACCUMULATED_MOUNT_TIME
     0-0-0/w UBIN        r     1 ACCUMULATED_SPIN_TIME
     0-0-0/w PTR         r     1 ARCHIVE$                   0-0-0/c ASTR(9)     r     1 ARCHIVE_NAME
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c ASTR(9)     r     1 BACKUP_NAME                0-0-0/d STRC(90)    r     1 BACKUP_SN
     0-0-0/w PTR         r     1 BLK_TAG$                   0-0-0/w PTR         r     1 BLK_TAG0$
     0-0-0/w PTR         r     1 BLOCK_GRAN$                0-0-0/c CHAR        r     1 B_VERSION
     0-0-0/b BIT         r     1 CATALOG_ON                 0-0-0/b BIT         r     1 CATALOG_ONTO
     0-0-0/d STRC(1080)  r     1 CLOSE_REBUILD              0-0-0/d STRC(1080)  r     1 CLOSE_STATUS
     0-0-0/d STRC(1080)  r     1 CLOSE_TSN_USED             0-0-0/b BIT         r     1 COMMAND_ERROR
     0-0-0/w UBIN        r     1 CONTROL_LIST(0:5)
     0-0-0/c CHAR(4)     r     1 CT_IMAGE                   0-0-0/b STRC(12)    r     1 DATE_CRIT
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:569  
     0-0-0/w SBIN        r     1 DEFAULT_GRANS_PER_TAPE_BUF
     0-0-0/w UBIN        r     1 DISK_AFT_UTS(0:8191)
     0-0-0/b BIT         r     1 DISK_AND_OP(0:8191)
     0-0-0/w UBIN        r     1 DISK_BEF_UTS(0:8191)
     0-0-0/d STRC(1080)  r     1 DISK_CLOSE                 0-0-0/b STRC(3)     r     1 DISK_CRIT
     0-0-0/b STRC(18)    r     1 DISK_DESC                  0-0-0/b STRC(18)    r     1 DISK_DESC_MASK
     0-0-0/c STRC(72)    r     1 DISK_DEST_ACCT             0-0-0/w SBIN        r     1 DISK_DEST_EXIST
     0-0-0/w STRC(72)    r     1 DISK_DEST_RES              0-0-0/d STRC(90)    r     1 DISK_DEST_SN
     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/w PTR         r     1 DISK_GRAN$
     0-0-0/d STRC(2088)  r     1 DISK_OPEN                  0-0-0/d STRC(2088)  r     1 DISK_OPEN_NEXT
     0-0-0/w STRC(145)   r     1 DISK_OPTION                0-0-0/w STRC(792)   r     1 DISK_ORGS
     0-0-0/b STRC(18)    r     1 DISK_SRCHCOND              0-0-0/d STRC(432)   r     1 DISK_WRITE
     0-0-0/w PTR         r     1 DPLIST$                    0-0-0/w PTR         r     1 DPRESLIST$
     0-0-0/c ASTR(9)     r     1 DUAL_FILE                  0-0-0/w UBIN        r     1 EFT_CMD
     0-0-0/c ASTR(9)     r     1 EFT_CVOL_FILE              0-0-0/c ASTR(9)     r     1 EFT_RESTRICT_FILE
     0-0-0/w SBIN        r     1 ERROR_LIMIT                0-0-0/w STRC        r     1 E_BAD_ACC
     0-0-0/w STRC        r     1 E_BAD_ARC                  0-0-0/w STRC        r     1 E_BAD_BAC
     0-0-0/w STRC        r     1 E_BAD_BKUP_FILE            0-0-0/w STRC        r     1 E_BAD_CRE
     0-0-0/w STRC        r     1 E_BAD_DP_FORMAT            0-0-0/w STRC        r     1 E_BAD_FSN
     0-0-0/w STRC        r     1 E_BAD_FSN_RANGE            0-0-0/w STRC        r     1 E_BAD_MOD
     0-0-0/w STRC        r     1 E_BAD_RANGE                0-0-0/w STRC        r     1 E_BAD_SKIP_N_RANGE
     0-0-0/w STRC        r     1 E_CANT_OPEN_TBACKUP        0-0-0/w STRC        r     1 E_CANT_RUN_EFT
     0-0-0/w STRC        r     1 E_CANT_SPECIFY_ACUP        0-0-0/w STRC        r     1 E_CANT_SPECIFY_ANYF
     0-0-0/w STRC        r     1 E_CANT_SPECIFY_CLEANUP
     0-0-0/w STRC        r     1 E_CANT_SPECIFY_DELF
     0-0-0/w STRC        r     1 E_CANT_SPECIFY_DEL_ACC
     0-0-0/w STRC        r     1 E_CANT_SPECIFY_DIR         0-0-0/w STRC        r     1 E_CANT_SPECIFY_IDS
     0-0-0/w STRC        r     1 E_CANT_SPECIFY_PAD         0-0-0/w STRC        r     1 E_CANT_SPECIFY_QF
     0-0-0/w STRC        r     1 E_CANT_SPECIFY_SCRUB
     0-0-0/w STRC        r     1 E_CANT_SPECIFY_SHARED
     0-0-0/w STRC        r     1 E_CAT_OFF                  0-0-0/w STRC        r     1 E_CLOSE_INVALID
     0-0-0/w STRC        r     1 E_DUPLICATE_PSN            0-0-0/w STRC        r     1 E_DUP_AFT_ACC
     0-0-0/w STRC        r     1 E_DUP_AFT_ARC              0-0-0/w STRC        r     1 E_DUP_AFT_BAC
     0-0-0/w STRC        r     1 E_DUP_AFT_CRE              0-0-0/w STRC        r     1 E_DUP_AFT_MOD
     0-0-0/w STRC        r     1 E_DUP_BEF_ACC              0-0-0/w STRC        r     1 E_DUP_BEF_ARC
     0-0-0/w STRC        r     1 E_DUP_BEF_BAC              0-0-0/w STRC        r     1 E_DUP_BEF_CRE
     0-0-0/w STRC        r     1 E_DUP_BEF_MOD              0-0-0/w STRC        r     1 E_DUP_TAPESET
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:570  
     0-0-0/w STRC        r     1 E_EXPD_NOT_EXPD            0-0-0/w STRC        r     1 E_FILE_NAME
     0-0-0/w STRC        r     1 E_MUST_BE_CAT_FILE         0-0-0/w STRC        r     1 E_MUST_CAT_DISK
     0-0-0/w STRC        r     1 E_MUST_CAT_OFF             0-0-0/w STRC        r     1 E_NEED_TIME
     0-0-0/w STRC        r     1 E_NO_CATALOG               0-0-0/w STRC        r     1 E_NO_FILE
     0-0-0/w STRC        r     1 E_NO_FSN                   0-0-0/w STRC        r     1 E_NO_NEXT_SPEC
     0-0-0/w STRC        r     1 E_NO_PREV_SPEC             0-0-0/w STRC        r     1 E_NO_RANGE
     0-0-0/w STRC        r     1 E_OVERLAP_RANGE            0-0-0/w STRC        r     1 E_OVERLAP_SKIP
     0-0-0/w STRC        r     1 E_REBUILD_CONTINUE         0-0-0/w STRC        r     1 E_RETURN_TO_COMMAND
     0-0-0/w STRC        r     1 E_TOO_MANY_ERRORS_TO_SWITCH
     0-0-0/w STRC        r     1 E_TRY_AGAIN                0-0-0/w STRC        r     1 E_WARN_OVERLAP_RANGE
     0-0-0/w STRC        r     1 E_WARN_OVERLAP_SKIP        0-0-0/w STRC        r     1 E_WIPEOUT_SOURCE
     0-0-0/w STRC(18)    r     1 FILE_TYPE                  0-0-0/c STRC(72)    r     1 FIRST_ACCT
     0-0-0/c STRC(288)   r     1 FIRST_FILE                 0-0-0/b BIT         r     1 FMSEC
     0-0-0/d STRC(216)   r     1 FPT_EXIT                   0-0-0/c STRC(72)    r     1 FROM_DISK_ACCT
     0-0-0/c STRC(288)   r     1 FROM_DISK_NAME             0-0-0/d STRC(90)    r     1 FROM_DISK_SN
     0-0-0/d STRC(432)   r     1 GET_NOW_UTS                0-0-0/c STRC(72)    r     1 LAST_ACCT
     0-0-0/c STRC(288)   r     1 LAST_FILE                  0-0-0/w PTR         r     1 LAST_SNLISTINFO$
     0-0-0/w SBIN        r     1 LAST_TAPE_FSN              0-0-0/w PTR         r     1 M$TAPE00$
     0-0-0/w SBIN        r     1 NBR_BYTES_TO_MOVE          0-0-0/w UBIN        r     1 NBR_CONTROL_FILE
     0-0-0/w SBIN        r     1 NBR_GRANS_PER_TAPE_BUF
     0-0-0/w SBIN        r     1 NBR_SNLISTS                0-0-0/b STRC(18)    r     1 NEW_DISK_DESC
     0-0-0/c ASTR(9)     r     1 NODATA_FILE_NAME           0-0-0/c STRC(369)   r     1 NODATA_KEY
     0-0-0/w UBIN        r     1 NOW_UTS                    0-0-0/c STRC(288)   r     1 NO_FILE
     0-0-0/c STRC(72)    r     1 NULL_ACCT                  0-0-0/c STRC(288)   r     1 NULL_FILE
     0-0-0/d STRC(2088)  r     1 OPEN_REBUILD               0-0-0/b BIT         r     1 OVER_FIL
     0-0-0/c ASTR(9)     r     1 PRIME_FILE                 0-0-0/d STRC(504)   r     1 READ_REBUILD
     0-0-0/d STRC(504)   r     1 READ_STATUS                0-0-0/h STRC(450)   r     1 REBUILD_BUF
     0-0-0/c ASTR(9)     r     1 REBUILD_DIR_KEY            0-0-0/c ASTR(9)     r     1 REBUILD_KEY
     0-0-0/c ASTR(9)     r     1 REBUILD_NAME               0-0-0/d STRC(90)    r     1 REBUILD_SN
     0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME              0-0-0/w SBIN        r     1 SNLIST_NBR
     0-0-0/w PTR         r     1 SNVECLIST$                 0-0-0/w CHAR(84)    r     1 SPECCHARS
     0-0-0/b BIT         r     1 STAF                       0-0-0/w UBIN        r     1 START_UTS
     0-0-0/c STRC        r     1 STATUS_KEY                 0-0-0/d STRC(1080)  r     1 TAPE_CLOSE
     0-0-0/w PTR         r     1 TAPE_DCBLIST$              0-0-0/d STRC(2088)  r     1 TAPE_OPEN
     0-0-0/w STRC(144)   r     1 TAPE_OPTION                0-0-0/d STRC(144)   r     1 TAPE_REWIND
     0-0-0/b STRC(18)    r     1 TEMP_DISK_SRCHCOND         0-0-0/b BIT         r     1 TEST_MODE
     0-0-0/w SBIN        r     1 TOTAL_ERRORS               0-0-0/w SBIN        r     1 TOTAL_FILES
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:571  
     0-0-0/w SBIN        r     1 TOTAL_GRANS                0-0-0/w SBIN        r     1 TRANS_NBR
     0-0-0/w SBIN        r     1 TSN_SET_NBR                0-0-0/w STRC(270)   r     1 TSN_USED_BUF
     0-0-0/c ASTR(9)     r     1 TSN_USED_NAME              0-0-0/d STRC(72)    r     1 TVECTOR
     0-0-0/w UBIN        r     1 ZERO

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ASTR(9)     r     1 B$VERSION
     0-0-0/w STRC(936)   r     1 DISK_FILE_SPEC             0-0-0/d STRC(90)    r     1 DPLIST
     0-0-0/w STRC(72)    r     1 DPRESLIST                  0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$CATALOG                  0-0-0N  NULL        r     1 M$DISK00
     0-0-0N  NULL        r     1 M$DISK_IN                  0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$NODATA_LIST
     0-0-0N  NULL        r     1 M$READ_FILE                0-0-0N  NULL        r     1 M$REBUILD
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$STATUS
     0-0-0N  NULL        r     1 M$TAPE00                   0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/c CHAR(40)    r     1 RANGE_START
     0-0-0/c CHAR(40)    r     1 RANGE_STOP                 0-0-0/c CHAR(40)    r     1 SKIP_START
     0-0-0/c CHAR(40)    r     1 SKIP_STOP                  0-0-0/d STRC(90)    r     1 SNLIST
     0-0-0/w STRC(72)    r     1 SNLISTINFO
     0-0-0/w STRC(72)    r     1 TAPE_DCBLIST(0:0)
     0-0-0/d STRC(90)    r     1 VLP_SN


   Procedure FLB$EFT requires 6760 words for executable code.
   Procedure FLB$EFT requires 40 words of local(AUTO) storage.
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:572  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:573  
          MINI XREF LISTING

ACCT
     22362**DCL     27318>>ASSIGN  27323>>ASSIGN  27330>>ASSIGN  27332>>ASSIGN  27342>>ASSIGN  27345>>ASSIGN
     27398>>ASSIGN
ACCT.ACCT#
     22362**DCL     25442<<ASSIGN  27303>>IF      27304<<ASSIGN  27370<<ASSIGN  27381<<ASSIGN  27384<<ASSIGN
     27390>>IF      27392<<ASSIGN  27397>>ASSIGN
ACCUMULATED_BREAK_TIME
     14755**DCL     25907<<ASSIGN
ACCUMULATED_MOUNT_TIME
     14755**DCL     25905<<ASSIGN
ACCUMULATED_SPIN_TIME
     14755**DCL     25906<<ASSIGN
AFT IN PROCEDURE FLB_DATE_SPEC
     27032**DCL     27136<<ASSIGN  27143<<ASSIGN  27156<<ASSIGN  27204>>IF
AFT_DELTA IN PROCEDURE FLB_DATE_SPEC
     27034**DCL     27144<<ASSIGN  27157<<ASSIGN  27206<>CALL
ALL_ALTRETS IN PROCEDURE FLB_OUTPUT_NODES
     24880**LABEL   24854--CALLALT 24869--CALLALT 24873--CALLALT
ALL_ALTRETS IN PROCEDURE FLB_READ_NODES
     24951**LABEL   24946--CALLALT 24950--CALLALT
ANSDATE
     21550**DCL     21559--REDEF   21562--REDEF
ANSDATE.DAY
     21553**DCL     27121<>CALL
ANSDATE.HOUR
     21554**DCL     27106<>CALL
ANSDATE.MINUTE
     21555**DCL     27108<>CALL
ANSDATE.MONTH
     21552**DCL     27119<>CALL
ANSDATE.SEC100THS
     21557**DCL     27112<>CALL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:574  
ANSDATE.SECOND
     21556**DCL     27110<>CALL
ANSDATE.YEAR
     21551**DCL     27123<>CALL
ANSDATEPIECE.HHMMSSSS
     21561**DCL     22669--DCLINIT 22670--DCLINIT 22694--DCLINIT 22695--DCLINIT 27099<<ASSIGN  27138<<ASSIGN
ANSDATEPIECE.YYMMDD
     21560**DCL     22667--DCLINIT 22668--DCLINIT 22692--DCLINIT 22693--DCLINIT
ARCHIVE$
     15219**DCL     25644>>IF      25648<<ASSIGN
ARCHIVE_NAME.L#
     16838**DCL     16838--IMP-SIZ
ARS IN PROCEDURE FLB_READ_BACKUP
     28060**DCL     28125<>CALL    28128>>ASSIGN
B$ALT.CODE
     21899**DCL     21899--REDEF   21900--REDEF   21900--REDEF
B$ALT.ERR.CODE
     21901**DCL     25149>>IF      25203>>IF      26690>>ASSIGN  28166>>IF      28206>>IF
B$ALT.ERR.ERR#
     21901**DCL     21901--REDEF
B$ALT.EVID
     21900**DCL     21900--REDEF   21900--REDEF
B$JIT.CCARS
      6529**DCL     24441>>ASSIGN
B$JIT.CCBUF
      6529**DCL     24442<>CALL
B$JIT.CPFLAGS1.SLEAZE
      6535**DCL      6535--REDEF
B$JIT.ERR.MID
      6442**DCL      6442--REDEF
B$JIT.FACCN
      6441**DCL     26461>>ASSIGN  26462>>ASSIGN  26545>>ASSIGN  27304>>ASSIGN  27392>>ASSIGN  28075>>ASSIGN
B$JIT.FPSN
      6522**DCL     26546>>IF      26547>>ASSIGN
B$JIT.JRESPEAK
      6603**DCL      6604--REDEF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:575  
B$JIT.MODE
      6436**DCL     24737>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
      6712**DCL      6712--REDEF    6713--REDEF
B$JIT.PNR
      6616**DCL      6616--REDEF
B$JIT.PPRIV
      6497**DCL     24472>>IF      24509>>IF      24516>>IF      24522>>IF      24528>>IF      24534>>IF
     24540>>IF      24546>>IF      24552>>IF      24558>>IF      24565>>IF      24572>>IF      24579>>IF
     24586>>IF      24593>>IF      24599>>IF      24605>>IF      24611>>IF      24617>>IF      24622>>IF
     24628>>IF      24634>>IF      24639>>IF      24644>>IF      24650>>IF      24656>>IF      24662>>IF
     24668>>IF      24675>>IF      24682>>IF      24688>>IF      24694>>IF
B$JIT.PRIV.JOB
      6485**DCL     24377>>IF
B$JIT.SWITCH
      6529**DCL     24397>>IF
B$JIT.TSLINE
      6710**DCL      6711--REDEF
B$JIT$
     14726**DCL      6436--IMP-PTR 24377>>IF      24397>>IF      24441>>ASSIGN  24442>>CALL    24472>>IF
     24509>>IF      24516>>IF      24522>>IF      24528>>IF      24534>>IF      24540>>IF      24546>>IF
     24552>>IF      24558>>IF      24565>>IF      24572>>IF      24579>>IF      24586>>IF      24593>>IF
     24599>>IF      24605>>IF      24611>>IF      24617>>IF      24622>>IF      24628>>IF      24634>>IF
     24639>>IF      24644>>IF      24650>>IF      24656>>IF      24662>>IF      24668>>IF      24675>>IF
     24682>>IF      24688>>IF      24694>>IF      24737>>IF      26461>>ASSIGN  26462>>ASSIGN  26545>>ASSIGN
     26546>>IF      26547>>ASSIGN  27304>>ASSIGN  27392>>ASSIGN  28075>>ASSIGN
B$TCB.ALT$
     21895**DCL     25149>>IF      25203>>IF      26690>>ASSIGN  28166>>IF      28206>>IF
B$TCB$
     14726**DCL     21895--IMP-PTR 25149>>IF      25203>>IF      26690>>ASSIGN  28166>>IF      28206>>IF
B$VERSION.L#
     21736**DCL     21737--IMP-SIZ 24400>>ASSIGN
B$VERSION.NAME#
     21737**DCL     24400>>ASSIGN
BACKUP_$$EFT
     21687**DCL     24416<<ASSIGN  26628>>IF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:576  
BACKUP_ACCT
     16495**DCL     28192>>ASSIGN
BACKUP_CMD_FNAME
     15205**DCL     23788--DCLINIT
BACKUP_CMD_OPEN.ACSVEH_
     23789**DCL     23790--REDEF
BACKUP_CMD_OPEN.ALTKEYS_
     23795**DCL     23796--REDEF   23796--REDEF
BACKUP_CMD_OPEN.HDR_
     23794**DCL     23795--REDEF
BACKUP_CMD_OPEN.TAB_
     23793**DCL     23794--REDEF
BACKUP_CMD_OPEN.UHL_
     23787**DCL     23788--REDEF   23788--REDEF
BACKUP_CMD_OPEN.V
     23796**DCL     23787--DCLINIT
BACKUP_CMD_OPEN.V.FSN#
     23827**DCL     23827--REDEF   23827--REDEF
BACKUP_CMD_OPEN.WSN_
     23793**DCL     23793--REDEF
BACKUP_NAME
     16482**DCL     28191>>ASSIGN
BACKUP_NAME.L#
     16482**DCL     16482--IMP-SIZ 28112>>IF      28191>>ASSIGN
BACKUP_NAME.NAME#
     16482**DCL     28112>>IF
BACKUP_SN
     16508**DCL     24155--DCLINIT
BACKUP_TEMP
     24226**DCL     24156--DCLINIT 28077--ASSIGN
BEF IN PROCEDURE FLB_DATE_SPEC
     27033**DCL     27135<<ASSIGN  27148<<ASSIGN  27161<<ASSIGN  27182>>IF
BEF_DELTA IN PROCEDURE FLB_DATE_SPEC
     27035**DCL     27149<<ASSIGN  27162<<ASSIGN  27184<>CALL
BLK_TAG.NAME
     15974**DCL     15974--REDEF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:577  
BLK_TAG$
     15971**DCL     15971--IMP-PTR
BLK_TAG0.NAME
     15980**DCL     15980--REDEF
BLK_TAG0$
     15977**DCL     15977--IMP-PTR
BLOCK_GRAN$
     15984**DCL     15985--IMP-PTR
BREAK_CONTINUED
     21536**DCL     24412<<ASSIGN  24434<<ASSIGN  25143<<ASSIGN  25144>>DOWHILE 25145<<ASSIGN  25149>>IF
     25739<<ASSIGN
BREAK_COUNT
     21535**DCL     24411<<ASSIGN  24455<<ASSIGN  24734<<ASSIGN  24742>>IF      25749<<ASSIGN
BREAK_DCB#
     21537**DCL     24410<<ASSIGN  24435<<ASSIGN  25142<<ASSIGN  25740<<ASSIGN
BREAK_TASK
     21538**DCL     24413<<ASSIGN  24436<<ASSIGN  24489<<ASSIGN  24493<<ASSIGN  24498<<ASSIGN  24502<<ASSIGN
     24511<<ASSIGN  24518<<ASSIGN  24524<<ASSIGN  24530<<ASSIGN  24536<<ASSIGN  24542<<ASSIGN  24548<<ASSIGN
     24554<<ASSIGN  24560<<ASSIGN  24567<<ASSIGN  24574<<ASSIGN  24581<<ASSIGN  24588<<ASSIGN  24595<<ASSIGN
     24601<<ASSIGN  24607<<ASSIGN  24613<<ASSIGN  24624<<ASSIGN  24630<<ASSIGN  24646<<ASSIGN  24652<<ASSIGN
     24658<<ASSIGN  24664<<ASSIGN  24670<<ASSIGN  24677<<ASSIGN  24696<<ASSIGN  25743<<ASSIGN  25744<<ASSIGN
     25862<<ASSIGN  25867<<ASSIGN  25871<<ASSIGN
BUF_ IN PROCEDURE FLB_READ_BACKUP
     28061**DCL     28125<>CALL    28127>>ASSIGN
B_VERSION
     21529**DCL     24400--ASSIGN  24400--ASSIGN
C IN PROCEDURE FLB_ORDER_RANGE
     27416**DCL     27727<<ASSIGN  27728<<ASSIGN  27728>>ASSIGN  27729>>DOWHILE 27729>>DOWHILE 27730<<ASSIGN
     27730>>ASSIGN  27732>>IF      27734>>ASSIGN  27766<<ASSIGN  27767<<ASSIGN  27767>>ASSIGN  27768>>DOWHILE
     27768>>DOWHILE 27769<<ASSIGN  27769>>ASSIGN  27771>>IF      27773>>ASSIGN
CATALOG_ON
     17759**DCL     24415<<ASSIGN  24456<<ASSIGN  24512<<ASSIGN  24561<<ASSIGN  24568<<ASSIGN  24575<<ASSIGN
     24582<<ASSIGN  24589<<ASSIGN  24678<<ASSIGN
CATALOG_ONTO
     17759**DCL     24821<<ASSIGN  24843<<ASSIGN
CAT_KEY
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:578  
     17753**DCL     17754--REDEF   17755--REDEF
CAT_REC.LT
     17756**DCL     17756--REDEF
CHECK_PACKSET
     22508**DCL     26688<>CALL
CHECK_PACKSET.ACSVEH_
     22510**DCL     22511--REDEF
CHECK_PACKSET.ALTKEYS_
     22516**DCL     22517--REDEF   22517--REDEF
CHECK_PACKSET.HDR_
     22515**DCL     22516--REDEF
CHECK_PACKSET.TAB_
     22514**DCL     22515--REDEF
CHECK_PACKSET.UHL_
     22508**DCL     22509--REDEF   22509--REDEF
CHECK_PACKSET.V
     22517**DCL     22508--DCLINIT
CHECK_PACKSET.V.FSN#
     22548**DCL     22548--REDEF   22548--REDEF
CHECK_PACKSET.V.RES#
     22532**DCL     26531<<ASSIGN  26537<<ASSIGN  26562<<ASSIGN
CHECK_PACKSET.WSN_
     22514**DCL     22514--REDEF
CHECK_SRCH_BIT
     21702**DCL     24462<<ASSIGN  26985<<ASSIGN  26990<<ASSIGN  26997<<ASSIGN  27000>>IF
CHECK_TAPE
     21540**DCL     25728<<ASSIGN  25820>>IF
CHKEFTRUN.V
     23845**DCL     23845--DCLINIT
CLOSE_BACKUP_TEMP
     24334**DCL     25295<>CALL    25310<>CALL    25325<>CALL    28169<>CALL    28209<>CALL
CLOSE_BACKUP_TEMP.SN_
     24334**DCL     24334--REDEF
CLOSE_BACKUP_TEMP.UTL_
     24335**DCL     24335--REDEF
CLOSE_BACKUP_TEMP.V
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:579  
     24339**DCL     24334--DCLINIT
CLOSE_BACKUP_TEMP.V.DISP#
     24343**DCL     25294<<ASSIGN  25309<<ASSIGN  25324<<ASSIGN  28081<<ASSIGN
CLOSE_BACKUP_TEMP.V.EXPIRE#
     24349**DCL     24349--REDEF
CLOSE_BACKUP_TEMP.V.TYPE#
     24347**DCL     24347--REDEF
CLOSE_BACKUP_TEMP.V.XTNSIZE#
     24344**DCL     24344--REDEF   24346--REDEF
CLOSE_BLOCK_FILE.SN_
     15888**DCL     15888--REDEF
CLOSE_BLOCK_FILE.UTL_
     15889**DCL     15889--REDEF
CLOSE_BLOCK_FILE.V
     15893**DCL     15888--DCLINIT
CLOSE_BLOCK_FILE.V.EXPIRE#
     15903**DCL     15903--REDEF
CLOSE_BLOCK_FILE.V.TYPE#
     15901**DCL     15901--REDEF
CLOSE_BLOCK_FILE.V.XTNSIZE#
     15898**DCL     15898--REDEF   15900--REDEF
CLOSE_FID
     22964**DCL     24805<>CALL    24878<>CALL
CLOSE_FID.SN_
     22964**DCL     22964--REDEF
CLOSE_FID.UTL_
     22965**DCL     22965--REDEF
CLOSE_FID.V
     22969**DCL     22964--DCLINIT
CLOSE_FID.V.DCB#
     22970**DCL     24802<<ASSIGN
CLOSE_FID.V.EXPIRE#
     22979**DCL     22979--REDEF
CLOSE_FID.V.TYPE#
     22977**DCL     22977--REDEF
CLOSE_FID.V.XTNSIZE#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:580  
     22974**DCL     22974--REDEF   22976--REDEF
CLOSE_NODATA_LIST.SN_
     17636**DCL     17636--REDEF
CLOSE_NODATA_LIST.UTL_
     17637**DCL     17637--REDEF
CLOSE_NODATA_LIST.V.EXPIRE#
     17651**DCL     17651--REDEF
CLOSE_NODATA_LIST.V.TYPE#
     17649**DCL     17649--REDEF
CLOSE_NODATA_LIST.V.XTNSIZE#
     17646**DCL     17646--REDEF   17648--REDEF
CLOSE_PRIME_DUAL.SN_
     17113**DCL     17113--REDEF
CLOSE_PRIME_DUAL.UTL_
     17114**DCL     17114--REDEF
CLOSE_PRIME_DUAL.V.EXPIRE#
     17128**DCL     17128--REDEF
CLOSE_PRIME_DUAL.V.TYPE#
     17126**DCL     17126--REDEF
CLOSE_PRIME_DUAL.V.XTNSIZE#
     17123**DCL     17123--REDEF   17125--REDEF
CLOSE_READ_FILE
     23121**DCL     24745<>CALL    24934<>CALL    25941<>CALL
CLOSE_READ_FILE.SN_
     23121**DCL     23121--REDEF
CLOSE_READ_FILE.UTL_
     23122**DCL     23122--REDEF
CLOSE_READ_FILE.V
     23126**DCL     23121--DCLINIT
CLOSE_READ_FILE.V.EXPIRE#
     23136**DCL     23136--REDEF
CLOSE_READ_FILE.V.TYPE#
     23134**DCL     23134--REDEF
CLOSE_READ_FILE.V.XTNSIZE#
     23131**DCL     23131--REDEF   23133--REDEF
CLOSE_REBUILD
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:581  
     17388**DCL     25213<>CALL    25315<>CALL    25332<>CALL    25336<>CALL
CLOSE_REBUILD.SN_
     17388**DCL     17388--REDEF
CLOSE_REBUILD.UTL_
     17389**DCL     17389--REDEF
CLOSE_REBUILD.V.DISP#
     17397**DCL     25212<<ASSIGN  25314<<ASSIGN  25331<<ASSIGN  25335<<ASSIGN
CLOSE_REBUILD.V.EXPIRE#
     17403**DCL     17403--REDEF
CLOSE_REBUILD.V.TYPE#
     17401**DCL     17401--REDEF
CLOSE_REBUILD.V.XTNSIZE#
     17398**DCL     17398--REDEF   17400--REDEF
CLOSE_STATUS
     16603**DCL     28168<>CALL    28208<>CALL    28224<>CALL
CLOSE_STATUS.SN_
     16603**DCL     16603--REDEF
CLOSE_STATUS.UTL_
     16604**DCL     16604--REDEF
CLOSE_STATUS.V.EXPIRE#
     16618**DCL     16618--REDEF
CLOSE_STATUS.V.TYPE#
     16616**DCL     16616--REDEF
CLOSE_STATUS.V.XTNSIZE#
     16613**DCL     16613--REDEF   16615--REDEF
CLOSE_TSN_USED
     16313**DCL     25833<>CALL    25853<>CALL
CLOSE_TSN_USED.SN_
     16313**DCL     16313--REDEF
CLOSE_TSN_USED.UTL_
     16314**DCL     16314--REDEF
CLOSE_TSN_USED.V.EXPIRE#
     16328**DCL     16328--REDEF
CLOSE_TSN_USED.V.TYPE#
     16326**DCL     16326--REDEF
CLOSE_TSN_USED.V.XTNSIZE#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:582  
     16323**DCL     16323--REDEF   16325--REDEF
CODE
     21546**DCL     26690<<ASSIGN  26691>>IF      26691>>IF      26691>>IF      26696>>IF
COMMAND
     21547**DCL     24437>>ASSIGN  24458<<ASSIGN  24474>>DOCASE  24483>>DOCASE  24671<<ASSIGN  24775>>IF
     24810>>IF      24855>>IF      24872>>IF      24891>>IF      25045>>IF      25058>>IF      25077>>IF
     25082>>IF      25113>>DOCASE  25121<>CALL    25365<>CALL    25400>>IF      25436>>IF      25439<>CALL
     25473<>CALL    25499<>CALL    25521>>IF      25532>>IF      25600>>IF      25600>>IF      25621>>IF
     25621>>IF      25626<>CALL    25634>>IF      25634>>IF      25642<>CALL    25644>>IF      25644>>IF
     25679<>CALL    25697>>DOCASE  25702>>ASSIGN  25706>>IF      25769>>IF      25801>>IF      25820>>IF
     25820>>IF      25893>>IF      26244>>IF      26244>>IF      26247>>IF      26247>>IF      26247>>IF
     26525>>DOCASE  26534>>IF      26558>>IF      26572>>DOCASE  26583>>IF      26594>>IF      26741>>DOSELCT
     26749>>DOSELCT 26775>>DOSELCT 26805>>DOSELCT 26816>>DOSELCT 26829>>DOSELCT 26837>>DOSELCT 26853>>DOSELCT
     26869>>DOSELCT 26877>>DOSELCT 27227>>IF      27231<<ASSIGN  27233<<ASSIGN
COMMAND_ERROR
     14726**DCL     24457<<ASSIGN  24700<<ASSIGN  24725<<ASSIGN  24737>>IF      24742>>IF      24860<<ASSIGN
     24889<<ASSIGN  24915>>IF      24959<<ASSIGN  25080<<ASSIGN  25101<<ASSIGN  25120>>IF      25131>>IF
     25135>>IF      25139>>IF      25152<<ASSIGN  25341<<ASSIGN  25356<<ASSIGN  25359>>IF      25369<<ASSIGN
     25375<<ASSIGN  25397>>IF      25434>>IF      25471>>IF      25493>>IF      25515>>IF      25519>>IF
     25597>>IF      25624<<ASSIGN  25629>>IF      25673>>IF      25723<<ASSIGN  25726>>IF      25750<<ASSIGN
     25773<<ASSIGN  25785<<ASSIGN  25793<<ASSIGN  25810>>IF      25820>>IF      25932<<ASSIGN  26007>>IF
     26011>>IF      26056<<ASSIGN  26080>>IF      26085>>IF      26091>>IF      26095>>IF      26128<<ASSIGN
     26273<<ASSIGN  26296<<ASSIGN  26327<<ASSIGN  26382<<ASSIGN  26395<<ASSIGN  26515<<ASSIGN  26552<<ASSIGN
     26657<<ASSIGN  26677>>IF      26694<<ASSIGN  26744<<ASSIGN  26752<<ASSIGN  26778<<ASSIGN  26794<<ASSIGN
     26808<<ASSIGN  26819<<ASSIGN  26832<<ASSIGN  26840<<ASSIGN  26872<<ASSIGN  26880<<ASSIGN  27176<<ASSIGN
     27200<<ASSIGN  27222<<ASSIGN  27356<<ASSIGN  27515<<ASSIGN  27528>>IF      27550<<ASSIGN  27603<<ASSIGN
     27615<<ASSIGN  27655<<ASSIGN  27697<<ASSIGN  27861<<ASSIGN
CONTROL_LIST
     14897**DCL     25966<<ASSIGN  25973<<ASSIGN  25974<<ASSIGN  25975<<ASSIGN  25976<<ASSIGN  25977<<ASSIGN
     25978<<ASSIGN
CON_CLOSE_ARCHIVE.SN_
     16645**DCL     16645--REDEF
CON_CLOSE_ARCHIVE.UTL_
     16646**DCL     16646--REDEF
CON_CLOSE_ARCHIVE.V.EXPIRE#
     16660**DCL     16660--REDEF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:583  
CON_CLOSE_ARCHIVE.V.TYPE#
     16658**DCL     16658--REDEF
CON_CLOSE_ARCHIVE.V.XTNSIZE#
     16655**DCL     16655--REDEF   16657--REDEF
CON_OPEN_ARCHIVE_FILE.ACSVEH_
     16732**DCL     16733--REDEF
CON_OPEN_ARCHIVE_FILE.ALTKEYS_
     16738**DCL     16739--REDEF   16739--REDEF
CON_OPEN_ARCHIVE_FILE.HDR_
     16737**DCL     16738--REDEF
CON_OPEN_ARCHIVE_FILE.TAB_
     16736**DCL     16737--REDEF
CON_OPEN_ARCHIVE_FILE.UHL_
     16730**DCL     16731--REDEF   16731--REDEF
CON_OPEN_ARCHIVE_FILE.V.FSN#
     16770**DCL     16770--REDEF   16770--REDEF
CON_OPEN_ARCHIVE_FILE.WSN_
     16736**DCL     16736--REDEF
CON_READ_ARCHIVE_FILE.STATION_
     16794**DCL     16795--REDEF
CON_READ_ARCHIVE_FILE.V.DVBYTE.REREAD#
     16806**DCL     16806--REDEF
CON_READ_ARCHIVE_FILE.V.INDX#
     16804**DCL     16804--REDEF
CT5FMT IN PROCEDURE FLB_BUILD_SNLIST
     27934**DCL     27937--REDEF
CT5FMT.N IN PROCEDURE FLB_BUILD_SNLIST
     27936**DCL     27972>>CALLBLT 27974<<CALLBLT
CT5FMTCHARS IN PROCEDURE FLB_BUILD_SNLIST
     27937**DCL     27971<<ASSIGN  27975>>ASSIGN
CT6FMT IN PROCEDURE FLB_BUILD_SNLIST
     27938**DCL     27941--REDEF
CT6FMT.NN IN PROCEDURE FLB_BUILD_SNLIST
     27940**DCL     27981>>CALLBLT 27983<<CALLBLT
CT6FMTCHARS IN PROCEDURE FLB_BUILD_SNLIST
     27941**DCL     27980<<ASSIGN  27984>>ASSIGN
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:584  
CT_IMAGE
     14896**DCL     25614<<ASSIGN  25618<<ASSIGN  27911<<ASSIGN
CVOL_UTL.ULBL#
     16073**DCL     16073--REDEF
CX IN PROCEDURE FLB_ORDER_RANGE
     27415**DCL     27717<<ASSIGN  27719>>IF      27721>>ASSIGN  27722>>ASSIGN  27726>>DOWHILE 27727>>ASSIGN
     27734>>ASSIGN  27737>>ASSIGN  27738<<ASSIGN  27738>>ASSIGN  27763<<ASSIGN  27765>>DOWHILE 27766>>ASSIGN
     27773>>ASSIGN  27774<<DOINDEX 27774>>DOINDEX 27775>>ASSIGN  27780>>ASSIGN  27781<<ASSIGN  27781>>ASSIGN
     27788<<DOINDEX 27789>>ASSIGN
DATEFIELD IN PROCEDURE FLB_SETDATE
     27241**DCL     27239--PROC    27246<<CALLBLT
DATENODEX IN PROCEDURE FLB_DATE_SPEC
     27021**DCL     27072<<DOINDEX 27073>>ASSIGN
DATEUTS
     21549**DCL     22671--DCLINIT 22696--DCLINIT 27088<>CALL    27092<<ASSIGN  27184<>CALL    27206<>CALL
DATEX IN PROCEDURE FLB_DATE_SPEC
     27019**DCL     27094<<ASSIGN  27117>>DOCASE  27125<<ASSIGN  27125>>ASSIGN
DATE_CRIT
     14789**DCL     26209<<ASSIGN
DATE_CRIT.AFT
     14789**DCL     26498>>IF      27207>>IF      27224<<ASSIGN
DATE_CRIT.BEF
     14789**DCL     26498>>IF      27185>>IF      27202<<ASSIGN
DATE_CRIT.EXPD
     14790**DCL     26650<<ASSIGN  26791<<ASSIGN  26792>>IF
DATE_CRIT.NOT_EXPD
     14790**DCL     26790<<ASSIGN  26792>>IF
DATE_INFO.HHMMSSSS IN PROCEDURE FLB_DATE_SPEC
     27043**DCL     27138>>ASSIGN
DATE_INFO.NEGATIVE.AFT IN PROCEDURE FLB_DATE_SPEC
     27052**DCL     27141>>IF
DATE_INFO.NEGATIVE.AFT_DELTA IN PROCEDURE FLB_DATE_SPEC
     27055**DCL     27144>>ASSIGN
DATE_INFO.NEGATIVE.BEF IN PROCEDURE FLB_DATE_SPEC
     27053**DCL     27146>>IF
DATE_INFO.NEGATIVE.BEF_DELTA IN PROCEDURE FLB_DATE_SPEC
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:585  
     27056**DCL     27149>>ASSIGN
DATE_INFO.NEGATIVE.DISK_AND IN PROCEDURE FLB_DATE_SPEC
     27054**DCL     27151>>ASSIGN
DATE_INFO.POSITIVE.AFT IN PROCEDURE FLB_DATE_SPEC
     27046**DCL     27154>>IF
DATE_INFO.POSITIVE.AFT_DELTA IN PROCEDURE FLB_DATE_SPEC
     27049**DCL     27157>>ASSIGN
DATE_INFO.POSITIVE.BEF IN PROCEDURE FLB_DATE_SPEC
     27047**DCL     27159>>IF
DATE_INFO.POSITIVE.BEF_DELTA IN PROCEDURE FLB_DATE_SPEC
     27050**DCL     27162>>ASSIGN
DATE_INFO.POSITIVE.DISK_AND IN PROCEDURE FLB_DATE_SPEC
     27048**DCL     27164>>ASSIGN
DATE_NODE$ IN PROCEDURE FLB_DATE_SPEC
     27018**DCL     27073<<ASSIGN  27074>>DOCASE  27080>>ASSIGN  27083>>ASSIGN  27087>>CALLBLT 27087>>CALLBLT
     27095>>DOINDEX 27096>>ASSIGN
DATE_TYPE IN PROCEDURE FLB_DATE_SPEC
     27029**DCL     27065<<ASSIGN  27083<<ASSIGN  27138>>ASSIGN  27141>>IF      27144>>ASSIGN  27146>>IF
     27149>>ASSIGN  27151>>ASSIGN  27154>>IF      27157>>ASSIGN  27159>>IF      27162>>ASSIGN  27164>>ASSIGN
DCB# IN PROCEDURE FLB_OUTPUT_NODES
     24766**DCL     24778<<ASSIGN  24787<<ASSIGN  24797<>CALL    24802>>ASSIGN  24820<>CALL    24825>>ASSIGN
DCB# IN PROCEDURE FLB_READ_BACKUP
     28006**DCL     28108<<ASSIGN  28109<>CALL    28152<<ASSIGN  28153<>CALL    28179<<ASSIGN  28180<>CALL
DCB$ IN PROCEDURE FLB_OUTPUT_NODES
     24765**DCL     24777<<ASSIGN  24786<<ASSIGN  24796>>IF      24803>>ASSIGN  24875>>IF      24875>>IF
DECIMAL$ IN PROCEDURE FLB_DATE_SPEC
     27025**DCL     27096<<ASSIGN  27097>>IF      27101>>ASSIGN  27103<<ASSIGN  27245>>CALLBLT 27245>>CALLBLT
DECNODEX IN PROCEDURE FLB_DATE_SPEC
     27020**DCL     27095<<DOINDEX 27096>>ASSIGN
DEFAULT_GRANS_PER_TAPE_BUF
     14729**DCL     27909>>ASSIGN  27910>>ASSIGN
DEL_NODATA_REC.V
     17739**DCL     17736--DCLINIT
DEST_TAPE_VOL_SAVE IN PROCEDURE FLB_OPEN_NODES
     25692**DCL     25732<<ASSIGN  25829>>IF      25830<<ASSIGN  25848>>ASSIGN
DISK_AFT_UTS
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:586  
     14788**DCL     26217<<ASSIGN  26498>>IF      27206<>CALL
DISK_AND IN PROCEDURE FLB_DATE_SPEC
     27036**DCL     27069<<ASSIGN  27151<<ASSIGN  27164<<ASSIGN  27181>>ASSIGN
DISK_AND_OP
     14788**DCL     26218<<ASSIGN  26498>>IF      27181<<ASSIGN
DISK_BEF_UTS
     14788**DCL     26216<<ASSIGN  26498>>IF      27184<>CALL
DISK_CLOSE
     14406**DCL     28136<>CALL    28222<>CALL
DISK_CLOSE.IFPARAM_
     14411**DCL     28137<<ASSIGN
DISK_CLOSE.SN_
     14406**DCL     14406--REDEF   28079<<ASSIGN
DISK_CLOSE.UTL_
     14407**DCL     14407--REDEF
DISK_CLOSE.V.DCB#
     14412**DCL     28078<<ASSIGN
DISK_CLOSE.V.DESC
     14416**DCL     28138<<ASSIGN
DISK_CLOSE.V.DISP#
     14415**DCL     28080<<ASSIGN  28134<<ASSIGN
DISK_CLOSE.V.EFTOPER
     14413**DCL     28135<<ASSIGN
DISK_CLOSE.V.EXPIRE#
     14421**DCL     14421--REDEF
DISK_CLOSE.V.TYPE#
     14419**DCL     14419--REDEF
DISK_CLOSE.V.XTNSIZE#
     14416**DCL     14416--REDEF   14418--REDEF
DISK_CLOSE_NEXT.SN_
     15585**DCL     15585--REDEF
DISK_CLOSE_NEXT.UTL_
     15586**DCL     15586--REDEF
DISK_CLOSE_NEXT.V.EXPIRE#
     15600**DCL     15600--REDEF
DISK_CLOSE_NEXT.V.TYPE#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:587  
     15598**DCL     15598--REDEF
DISK_CLOSE_NEXT.V.XTNSIZE#
     15595**DCL     15595--REDEF   15597--REDEF
DISK_CLOSE_ORDINARY.SN_
     15627**DCL     15627--REDEF
DISK_CLOSE_ORDINARY.UTL_
     15628**DCL     15628--REDEF
DISK_CLOSE_ORDINARY.V.EXPIRE#
     15642**DCL     15642--REDEF
DISK_CLOSE_ORDINARY.V.TYPE#
     15640**DCL     15640--REDEF
DISK_CLOSE_ORDINARY.V.XTNSIZE#
     15637**DCL     15637--REDEF   15639--REDEF
DISK_CRIT
     14789**DCL     26208<<ASSIGN
DISK_CRIT.DSC
     14789**DCL     25362<<ASSIGN  26637>>IF      26641<<ASSIGN
DISK_CRIT.ORG
     14789**DCL     26724<<ASSIGN
DISK_CRIT.TIM
     14789**DCL     26647>>IF      26649<<ASSIGN  26654>>IF      26788<<ASSIGN  27070<<ASSIGN
DISK_DESC
     14779**DCL     26204<<ASSIGN  26910<<ASSIGN  26910>>ASSIGN
DISK_DESC.FETCH#
     14781**DCL     25363<<ASSIGN  26640<<ASSIGN
DISK_DESC_MASK
     14781**DCL     26205<<ASSIGN  26910>>ASSIGN
DISK_DESC_MASK.FETCH#
     14783**DCL     25364<<ASSIGN  26639<<ASSIGN
DISK_DEST_ACCT.ACCT#
     14888**DCL     25781>>IF      25781>>IF      25781>>IF      25801>>IF      26198<<ASSIGN  26281<<ASSIGN
     26321>>IF      26323>>ASSIGN
DISK_DEST_EXIST
     14890**DCL     25161<<ASSIGN  26199<<ASSIGN  26243<<ASSIGN  26254<<ASSIGN  26594>>IF      26675>>IF
     26676<<ASSIGN
DISK_DEST_RES.NAME
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:588  
     14890**DCL     26196<<ASSIGN  26252<<ASSIGN  26264<<ASSIGN  26268<<CALLBLT 26291<<CALLBLT 26305>>ASSIGN
     26317>>ASSIGN  26531>>ASSIGN  28074>>ASSIGN  28194>>ASSIGN
DISK_DEST_SN
     14875**DCL     28073--ASSIGN  28079--ASSIGN
DISK_DEST_SN.SN#
     14875**DCL     25771>>IF      25777>>IF      26195<<ASSIGN  26251<<ASSIGN  26277<<ASSIGN  26300<<ASSIGN
     26304>>ASSIGN  26311>>ASSIGN  26321>>IF      26330<<ASSIGN  26528>>IF      26530>>ASSIGN  28193>>ASSIGN
DISK_FILE_SPEC.NBR
     14771**DCL     25183<<ASSIGN  25843<<ASSIGN  26407--ASSIGN  26413<<ASSIGN  26431>>ASSIGN  26466--ASSIGN
     26472<<ASSIGN  27266>>ASSIGN  27272<<ASSIGN  27456--ASSIGN  27462<<ASSIGN  27488>>DOWHILE 27505>>DOINDEX
     27509<<ASSIGN  27509>>ASSIGN  27533>>ASSIGN  27577<<ASSIGN  27577>>ASSIGN  27585<<ASSIGN  27585>>ASSIGN
     27592<<ASSIGN  27592>>ASSIGN  27613>>IF      27800>>ASSIGN
DISK_FILE_SPEC.NBR_LEFT
     14771**DCL     26407--ASSIGN  26412<<ASSIGN  26466--ASSIGN  26471<<ASSIGN  27259<<ASSIGN  27259>>ASSIGN
     27260>>IF      27264<<ASSIGN  27264>>ASSIGN  27456--ASSIGN  27461<<ASSIGN
DISK_FILE_SPEC.PASSWORD#
     14771**DCL     26407--ASSIGN  26466--ASSIGN  27275<<ASSIGN  27276<<ASSIGN  27456--ASSIGN
DISK_FILE_SPEC.PASSWORD_SPEC
     14771**DCL     26407--ASSIGN  26466--ASSIGN  26482<<ASSIGN  26483<<ASSIGN  27274>>IF      27305<<ASSIGN
     27456--ASSIGN
DISK_FILE_SPEC.SPEC
     14771**DCL     14773--REDEF   26407--ASSIGN  26466--ASSIGN  27262--ASSIGN  27456--ASSIGN
DISK_FILE_SPEC.SPEC.SKIP
     14772**DCL     26431<<ASSIGN  27271<<ASSIGN  27490>>IF      27490>>IF      27499>>IF      27512>>IF
     27564<<ASSIGN  27588<<ASSIGN
DISK_FILE_SPEC.SPEC.START
     14772**DCL     14772--REDEF
DISK_FILE_SPEC.SPEC.START.ACCT
     14772**DCL     27267<<ASSIGN
DISK_FILE_SPEC.SPEC.START.ACCT.ACCT#
     14772**DCL     25184<<ASSIGN
DISK_FILE_SPEC.SPEC.START.FILE
     14772**DCL     27268<<ASSIGN
DISK_FILE_SPEC.SPEC.START.FILE.L#
     14772**DCL     25185<<ASSIGN
DISK_FILE_SPEC.SPEC.START.FILE.NAME#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:589  
     14772**DCL     25186<<ASSIGN
DISK_FILE_SPEC.SPEC.STARTCHARS
     14772**DCL     27494>>IF      27540--ASSIGN  27545--ASSIGN
DISK_FILE_SPEC.SPEC.STOP
     14773**DCL     14773--REDEF
DISK_FILE_SPEC.SPEC.STOP.ACCT
     14773**DCL     27269<<ASSIGN
DISK_FILE_SPEC.SPEC.STOP.FILE
     14773**DCL     27270<<ASSIGN
DISK_FILE_SPEC.SPEC.STOPCHARS
     14773**DCL     27494>>IF      27502>>IF      27502>>IF      27504<<ASSIGN  27504>>ASSIGN  27539--ASSIGN
     27546--ASSIGN
DISK_FILE_SPEC.SPECCHARS
     14773**DCL     27506<<ASSIGN  27506>>ASSIGN  27566>>ASSIGN  27568<<ASSIGN  27568>>ASSIGN  27570<<ASSIGN
     27590<<ASSIGN  27590>>ASSIGN  27805>>IF      27805>>IF      27808>>ASSIGN  27809<<ASSIGN  27809>>ASSIGN
     27810<<ASSIGN
DISK_FILE_SPEC$
     14770**DCL     14771--IMP-PTR 25183>>ASSIGN  25184>>ASSIGN  25185>>ASSIGN  25186>>ASSIGN  25735<<ASSIGN
     25841>>IF      25843>>ASSIGN  26411<>CALL    26412>>ASSIGN  26413>>ASSIGN  26431>>ASSIGN  26431>>ASSIGN
     26470<>CALL    26471>>ASSIGN  26472>>ASSIGN  26482>>ASSIGN  26483>>ASSIGN  27259>>ASSIGN  27259>>ASSIGN
     27260>>IF      27264>>ASSIGN  27264>>ASSIGN  27266>>ASSIGN  27267>>ASSIGN  27268>>ASSIGN  27269>>ASSIGN
     27270>>ASSIGN  27271>>ASSIGN  27272>>ASSIGN  27274>>IF      27275>>ASSIGN  27276>>ASSIGN  27305>>ASSIGN
     27460<>CALL    27461>>ASSIGN  27462>>ASSIGN  27488>>DOWHILE 27490>>IF      27490>>IF      27494>>IF
     27494>>IF      27499>>IF      27502>>IF      27502>>IF      27504>>ASSIGN  27504>>ASSIGN  27505>>DOINDEX
     27506>>ASSIGN  27506>>ASSIGN  27509>>ASSIGN  27509>>ASSIGN  27512>>IF      27533>>ASSIGN  27539>>ASSIGN
     27540>>ASSIGN  27545>>ASSIGN  27546>>ASSIGN  27564>>ASSIGN  27566>>ASSIGN  27568>>ASSIGN  27568>>ASSIGN
     27570>>ASSIGN  27577>>ASSIGN  27577>>ASSIGN  27585>>ASSIGN  27585>>ASSIGN  27588>>ASSIGN  27590>>ASSIGN
     27590>>ASSIGN  27592>>ASSIGN  27592>>ASSIGN  27613>>IF      27800>>ASSIGN  27805>>IF      27805>>IF
     27808>>ASSIGN  27809>>ASSIGN  27809>>ASSIGN  27810>>ASSIGN
DISK_GRAN$
     15984**DCL     15984--IMP-PTR
DISK_OPEN
     14269**DCL     28121<>CALL
DISK_OPEN.ACCT_
     14273**DCL     28076<<ASSIGN
DISK_OPEN.ACSVEH_
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:590  
     14271**DCL     14272--REDEF
DISK_OPEN.ALTKEYS_
     14277**DCL     14278--REDEF   14278--REDEF
DISK_OPEN.HDR_
     14276**DCL     14277--REDEF
DISK_OPEN.IFPARAM_
     14274**DCL     28120<<ASSIGN
DISK_OPEN.NAME_
     14270**DCL     28077<<ASSIGN
DISK_OPEN.SN_
     14269**DCL     28073<<ASSIGN
DISK_OPEN.TAB_
     14275**DCL     14276--REDEF
DISK_OPEN.UHL_
     14269**DCL     14270--REDEF   14270--REDEF
DISK_OPEN.V.DCB#
     14278**DCL     28071<<ASSIGN
DISK_OPEN.V.FSN#
     14309**DCL     14309--REDEF   14309--REDEF
DISK_OPEN.V.FUN#
     14288**DCL     28072<<ASSIGN
DISK_OPEN.V.RES#
     14293**DCL     28074<<ASSIGN
DISK_OPEN.WSN_
     14275**DCL     14275--REDEF
DISK_OPEN_NEXT.ACSVEH_
     15411**DCL     15412--REDEF
DISK_OPEN_NEXT.ALTKEYS_
     15417**DCL     15418--REDEF   15418--REDEF
DISK_OPEN_NEXT.HDR_
     15416**DCL     15417--REDEF
DISK_OPEN_NEXT.TAB_
     15415**DCL     15416--REDEF
DISK_OPEN_NEXT.UHL_
     15409**DCL     15410--REDEF   15410--REDEF
DISK_OPEN_NEXT.V.FSN#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:591  
     15449**DCL     15449--REDEF   15449--REDEF
DISK_OPEN_NEXT.V.FUN#
     15428**DCL     26221<<ASSIGN  26902<<ASSIGN
DISK_OPEN_NEXT.V.SHARE#
     15423**DCL     26222<<ASSIGN  26903<<ASSIGN
DISK_OPEN_NEXT.WSN_
     15415**DCL     15415--REDEF
DISK_OPEN_ORDINARY.ACSVEH_
     15520**DCL     15521--REDEF
DISK_OPEN_ORDINARY.ALTKEYS_
     15526**DCL     15527--REDEF   15527--REDEF
DISK_OPEN_ORDINARY.HDR_
     15525**DCL     15526--REDEF
DISK_OPEN_ORDINARY.TAB_
     15524**DCL     15525--REDEF
DISK_OPEN_ORDINARY.UHL_
     15518**DCL     15519--REDEF   15519--REDEF
DISK_OPEN_ORDINARY.V.FSN#
     15558**DCL     15558--REDEF   15558--REDEF
DISK_OPEN_ORDINARY.WSN_
     15524**DCL     15524--REDEF
DISK_OPTION
     14783**DCL     26206<<ASSIGN  26577>>IF
DISK_OPTION.ACUP
     14784**DCL     26852<<ASSIGN
DISK_OPTION.CLEANUP
     14783**DCL     26585<<ASSIGN  26589<<ASSIGN  26836<<ASSIGN
DISK_OPTION.DELETE
     14785**DCL     25625<<ASSIGN  25768<<ASSIGN  26645<<ASSIGN
DISK_OPTION.DELETED_ACCOUNTS
     14783**DCL     26581<<ASSIGN  26603<<ASSIGN  26609<<ASSIGN  26624<<ASSIGN  26828<<ASSIGN
DISK_OPTION.DIR
     14783**DCL     25193<<ASSIGN  25777>>IF      26133<<ASSIGN  26580<<ASSIGN  26608<<ASSIGN  26623<<ASSIGN
     26804<<ASSIGN  28091>>ASSIGN  28092<<ASSIGN  28118<<ASSIGN
DISK_OPTION.IDSS
     14784**DCL     26876<<ASSIGN
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:592  
DISK_OPTION.INACTIVATE
     14784**DCL     25437<<ASSIGN
DISK_OPTION.LEA
     14783**DCL     26812<<ASSIGN
DISK_OPTION.NOUPDATE
     14784**DCL     25806<<ASSIGN  26823<<ASSIGN
DISK_OPTION.OPEN_MODE
     14786**DCL     26665<<ASSIGN
DISK_OPTION.OVERLAP_WARN
     14785**DCL     26825<<ASSIGN  27497>>IF
DISK_OPTION.PAD
     14784**DCL     25192<<ASSIGN  26579<<ASSIGN  26601<<ASSIGN  26602<<ASSIGN  26610<<ASSIGN  26622<<ASSIGN
     26815<<ASSIGN  28093>>ASSIGN  28094<<ASSIGN  28117<<ASSIGN
DISK_OPTION.SAVE_DIR
     14786**DCL     26587<<ASSIGN  26625<<ASSIGN
DISK_OPTION.SCRUB.BACKUP
     14784**DCL     25803<<ASSIGN  26862<<ASSIGN
DISK_OPTION.SCRUB.CREATOR
     14784**DCL     26864<<ASSIGN
DISK_OPTION.SCRUB.STOW
     14785**DCL     25804<<ASSIGN  26866<<ASSIGN
DISK_OPTION.SHARED
     14786**DCL     25791>>IF      26904<<ASSIGN
DISK_OPTION.SKIP_NO_BACKUP
     14785**DCL     26586<<ASSIGN  26627<<ASSIGN
DISK_OPTION.SKIP_NO_PURGE
     14786**DCL     26646<<ASSIGN
DISK_OPTION.SWITCH_IF_ERRORS
     14785**DCL     25541>>IF      25549>>IF      26884<<ASSIGN
DISK_OPTION.XFER
     14786**DCL     25807<<ASSIGN
DISK_OPTION_DIR_SAVE IN PROCEDURE FLB_READ_BACKUP
     28009**DCL     28091<<ASSIGN  28118>>ASSIGN
DISK_OPTION_PAD_SAVE IN PROCEDURE FLB_READ_BACKUP
     28010**DCL     28093<<ASSIGN  28117>>ASSIGN
DISK_ORGS.NBR
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:593  
     14787**DCL     26207<<ASSIGN  26726>>ASSIGN  26728<<ASSIGN  26732<<ASSIGN  26732>>ASSIGN
DISK_ORGS.ORG
     14788**DCL     26727<<ASSIGN  26731>>IF
DISK_READ.STATION_
     14333**DCL     14334--REDEF
DISK_READ.V.DVBYTE.REREAD#
     14345**DCL     14345--REDEF
DISK_READ.V.INDX#
     14343**DCL     14343--REDEF
DISK_SPEC_DO IN PROCEDURE FLB_DISK_SPEC
     26351**LABEL   26488--EXIT
DISK_SRCHCOND
     14776**DCL     25534>>ASSIGN  25535<<ASSIGN  25545<<ASSIGN  25808>>ASSIGN  25837<<ASSIGN  26203<<ASSIGN
     26403<<ASSIGN  26575>>IF      26592>>IF      26606>>IF      26613>>IF      26635>>IF      26647>>IF
     26661>>IF      26668>>IF
DISK_SRCHCOND.ANYF#
     14777**DCL     25360<<ASSIGN  25777>>IF      25839<<ASSIGN  26576<<ASSIGN  26593<<ASSIGN  26599<<ASSIGN
     26607<<ASSIGN  26631<<ASSIGN  26662<<ASSIGN  26748<<ASSIGN  26915>>IF
DISK_SRCHCOND.ARCHIVE#
     14777**DCL     26617<<ASSIGN  26669<<ASSIGN  27004<<ASSIGN
DISK_SRCHCOND.BAD#
     14777**DCL     26762<<ASSIGN
DISK_SRCHCOND.BUF#
     14777**DCL     26615<<ASSIGN  26630<<ASSIGN  26759<<ASSIGN
DISK_SRCHCOND.DELF#
     14776**DCL     25536<<ASSIGN  26616<<ASSIGN  26739<<ASSIGN  27002<<ASSIGN
DISK_SRCHCOND.NOLIST#
     14776**DCL     26756<<ASSIGN
DISK_SRCHCOND.QS#
     14777**DCL     25361<<ASSIGN  26636<<ASSIGN  27003<<ASSIGN
DISK_WRITE
     14369**DCL     28129<>CALL
DISK_WRITE.BUF_
     14369**DCL     28127<<ASSIGN
DISK_WRITE.BUF_.BOUND
     14369**DCL     28128<<ASSIGN
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:594  
DISK_WRITE.KEY_
     14369**DCL     28122<<ASSIGN
DISK_WRITE.STATION_
     14371**DCL     14371--REDEF
DISK_WRITE.V.DCB#
     14372**DCL     28070<<ASSIGN
DISK_WRITE.V.DVBYTE.VFC#
     14378**DCL     14378--REDEF
DISK_WRITE.V.EVENT#
     14377**DCL     28069<<ASSIGN
DISK_WRITE.V.WAIT#
     14372**DCL     28068<<ASSIGN
DPLIST.NUM#
     14768**DCL     26307--ASSIGN  26310<<ASSIGN  26358--ASSIGN  26366<<ASSIGN  26441--ASSIGN  26444<<ASSIGN
     26560>>DOINDEX
DPLIST.SN#
     14768**DCL     25777>>IF      26307--ASSIGN  26311<<ASSIGN  26358--ASSIGN  26372<<ASSIGN  26386<<ASSIGN
     26393>>IF      26393>>IF      26441--ASSIGN  26445<<ASSIGN  26536>>ASSIGN  26561>>ASSIGN
DPLIST$
     14756**DCL     14768--IMP-PTR 25441<<ASSIGN  25777>>IF      26201<<ASSIGN  26309<>CALL    26310>>ASSIGN
     26311>>ASSIGN  26360<>CALL    26366>>ASSIGN  26372>>ASSIGN  26386>>ASSIGN  26393>>IF      26393>>IF
     26443<>CALL    26444>>ASSIGN  26445>>ASSIGN  26536>>ASSIGN  26541>>IF      26556<<ASSIGN  26560>>DOINDEX
     26561>>ASSIGN
DPRESLIST.NAME
     14770**DCL     26313--ASSIGN  26317<<ASSIGN  26362--ASSIGN  26369<<ASSIGN  26377<<CALLBLT 26447--ASSIGN
     26451<<ASSIGN  26537>>ASSIGN  26562>>ASSIGN
DPRESLIST.NBR
     14770**DCL     26313--ASSIGN  26316<<ASSIGN  26362--ASSIGN  26367<<ASSIGN  26447--ASSIGN  26450<<ASSIGN
DPRESLIST$
     14770**DCL     14770--IMP-PTR 26202<<ASSIGN  26315<>CALL    26316>>ASSIGN  26317>>ASSIGN  26364<>CALL
     26367>>ASSIGN  26369>>ASSIGN  26377>>CALLBLT 26449<>CALL    26450>>ASSIGN  26451>>ASSIGN  26537>>ASSIGN
     26562>>ASSIGN
DPSN
     22432**DCL     22508--DCLINIT 26556--ASSIGN
DPSN.SN#
     22432**DCL     26530<<ASSIGN  26536<<ASSIGN  26547<<ASSIGN  26554<<ASSIGN  26561<<ASSIGN
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:595  
DUAL_FILE.L#
     16909**DCL     16909--IMP-SIZ
EFTWORD
     14891**DCL     14891--REDEF
EFT_CMD
     21528**DCL     24442<>CALL    24444<>CALL    25745<>CALL
EFT_CMD_PCB
     21951**DCL     22171--DCLINIT
EFT_CMD_PCB.HI_CHAR
     22102**DCL     24720>>IF      25927>>IF
EFT_CVOL_FILE.L#
     16033**DCL     16033--IMP-SIZ
EFT_PROMPT
     21713**DCL     24442--CALL    24444--CALL
EFT_RESTRICT_FILE.L#
     16060**DCL     16060--IMP-SIZ
ERASE_HEADER
     22588**DCL     24707<>CALL
ERASE_HEADER.V
     22589**DCL     22588--DCLINIT
ERR
     21611**DCL     24726<>CALL    24731<>CALL    25933<>CALL    25938<>CALL
ERR.ERR#
     21641**DCL     24723>>IF      25930>>IF
ERR.MON
     21640**DCL     24716>>IF      25925>>IF
ERR IN PROCEDURE FLB_READ_BACKUP
     28027**DCL     28097<>CALL    28124>>DOWHILE 28125<>CALL
ERR.ERR# IN PROCEDURE FLB_READ_BACKUP
     28057**DCL     28104>>IF      28104>>IF
ERROR_LIMIT
     14897**DCL     25551>>IF      25551>>IF      26885<<CALLBLT
ERROR_OUT
     24748**LABEL   24381--CALLALT 24382--CALLALT 24384--CALLALT 24385--CALLALT 24389--CALLALT
E_BAD_ACC
      8316**DCL     26504>>ASSIGN
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:596  
E_BAD_ARC
      8496**DCL     26512>>ASSIGN
E_BAD_BAC
      8451**DCL     26510>>ASSIGN
E_BAD_BKUP_FILE
     12907**DCL     28153<>CALL    28180<>CALL
E_BAD_CRE
      8406**DCL     26508>>ASSIGN
E_BAD_DP_FORMAT
     13492**DCL     26274<>CALL    26297<>CALL    26383<>CALL
E_BAD_FSN
     12997**DCL     28114<>CALL
E_BAD_FSN_RANGE
      9306**DCL     26129<>CALL
E_BAD_MOD
      8361**DCL     26506>>ASSIGN
E_BAD_RANGE
      8541**DCL     27357<>CALL
E_BAD_SKIP_N_RANGE
      8586**DCL     27551<>CALL    27604<>CALL
E_CANT_OPEN_TBACKUP
     12457**DCL     28109<>CALL
E_CANT_RUN_EFT
     12772**DCL     24478<>CALL
E_CANT_SPECIFY_ACUP
     12097**DCL     26855<>CALL
E_CANT_SPECIFY_ANYF
     11827**DCL     26751<>CALL
E_CANT_SPECIFY_CLEANUP
     12052**DCL     26839<>CALL
E_CANT_SPECIFY_DELF
     11782**DCL     26743<>CALL
E_CANT_SPECIFY_DEL_ACC
     12007**DCL     26831<>CALL
E_CANT_SPECIFY_DIR
     11917**DCL     26807<>CALL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:597  
E_CANT_SPECIFY_IDS
     12187**DCL     26879<>CALL
E_CANT_SPECIFY_PAD
     11962**DCL     26818<>CALL
E_CANT_SPECIFY_QF
     11872**DCL     26777<>CALL
E_CANT_SPECIFY_SCRUB
     12142**DCL     26871<>CALL
E_CANT_SPECIFY_SHARED
     12322**DCL     25794<>CALL
E_CAT_OFF
     10791**DCL     24815<>CALL
E_CLOSE_INVALID
     13582**DCL     24701<>CALL
E_DUPLICATE_PSN
      9396**DCL     26396<>CALL
E_DUP_AFT_ACC
      9081**DCL     27211>>ASSIGN
E_DUP_AFT_ARC
      9261**DCL     27219>>ASSIGN
E_DUP_AFT_BAC
      9216**DCL     27217>>ASSIGN
E_DUP_AFT_CRE
      9171**DCL     27215>>ASSIGN
E_DUP_AFT_MOD
      9126**DCL     27213>>ASSIGN
E_DUP_BEF_ACC
      8856**DCL     27189>>ASSIGN
E_DUP_BEF_ARC
      9036**DCL     27197>>ASSIGN
E_DUP_BEF_BAC
      8991**DCL     27195>>ASSIGN
E_DUP_BEF_CRE
      8946**DCL     27193>>ASSIGN
E_DUP_BEF_MOD
      8901**DCL     27191>>ASSIGN
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:598  
E_DUP_TAPESET
     13717**DCL     25100<>CALL
E_EXPD_NOT_EXPD
      8721**DCL     26795<>CALL
E_FILE_NAME
     11061**DCL     24797<>CALL
E_MUST_BE_CAT_FILE
     11106**DCL     24877<>CALL
E_MUST_CAT_DISK
     10881**DCL     24859<>CALL
E_MUST_CAT_OFF
     10836**DCL     24820<>CALL
E_NEED_TIME
     10701**DCL     26656<>CALL
E_NO_CATALOG
     10926**DCL     24798<>CALL
E_NO_FILE
     13087**DCL     25447<>CALL
E_NO_FSN
     12952**DCL     26055<>CALL
E_NO_NEXT_SPEC
      8766**DCL     27656<>CALL
E_NO_PREV_SPEC
      8811**DCL     27698<>CALL
E_NO_RANGE
      8676**DCL     27616<>CALL
E_OVERLAP_RANGE
      8136**DCL     27514<>CALL
E_OVERLAP_SKIP
      8181**DCL     27513<>CALL
E_REBUILD_CONTINUE
     12502**DCL     25180<>CALL
E_RETURN_TO_COMMAND
     12367**DCL     25917<>CALL
E_TOO_MANY_ERRORS_TO_SWITCH
     11647**DCL     25542<>CALL    25558<>CALL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:599  
E_TRY_AGAIN
     10746**DCL     24739<>CALL    24756<>CALL    24899<>CALL
E_WARN_OVERLAP_RANGE
      8226**DCL     27501<>CALL
E_WARN_OVERLAP_SKIP
      8271**DCL     27500<>CALL
E_WIPEOUT_SOURCE
     11601**DCL     25774<>CALL    25786<>CALL
F$DCB.ACTPOS
     21870**DCL     21870--REDEF
F$DCB.ARS#
     21844**DCL     21844--REDEF
F$DCB.ATTR
     21863**DCL     21864--REDEF
F$DCB.BORROW
     21878**DCL     21878--REDEF   21878--REDEF   21878--REDEF
F$DCB.DCBNAME.L
     21892**DCL     21892--IMP-SIZ
F$DCB.EOMCHAR#
     21848**DCL     21848--REDEF
F$DCB.FCD#
     21857**DCL     24386>>IF      24512>>ASSIGN  24561>>ASSIGN  24568>>ASSIGN  24575>>ASSIGN  24582>>ASSIGN
     24589>>ASSIGN  24678>>ASSIGN  24729>>IF      24744>>IF      24796>>IF      24803>>ASSIGN  24933>>IF
     25322>>IF      25327>>IF      25936>>IF      28219>>IF      28221>>IF      28223>>IF
F$DCB.FLDID
     21873**DCL     21873--REDEF
F$DCB.FORM$
     21867**DCL     21867--REDEF
F$DCB.FSECT
     21883**DCL     21883--REDEF
F$DCB.FSN#
     21860**DCL     21860--REDEF   21860--REDEF   21861--REDEF   25267>>ASSIGN
F$DCB.HEADER$
     21866**DCL     21866--REDEF
F$DCB.IXTNSIZE#
     21864**DCL     21864--REDEF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:600  
F$DCB.LASTSTA$
     21853**DCL     21853--REDEF
F$DCB.LVL
     21879**DCL     21879--REDEF
F$DCB.NAME#.C
     21854**DCL     21854--REDEF   28112>>IF
F$DCB.NOEOF
     21876**DCL     21876--REDEF
F$DCB.NRECS#
     21865**DCL     21865--REDEF
F$DCB.NRECX
     21884**DCL     21884--REDEF
F$DCB.OHDR
     21876**DCL     21876--REDEF
F$DCB.ORG#
     21859**DCL     21859--REDEF   24875>>IF      28150>>IF
F$DCB.PRECNO
     21882**DCL     21882--REDEF
F$DCB.PSN#
     21854**DCL     25246>>IF      25250>>ASSIGN  25290>>ASSIGN  25304>>ASSIGN  25886>>ASSIGN  25895>>ASSIGN
     28140>>ASSIGN
F$DCB.RCSZ
     21888**DCL     21888--REDEF
F$DCB.RES#
     21855**DCL     21855--REDEF
F$DCB.SETX
     21867**DCL     21867--REDEF
F$DCB.TAB$
     21867**DCL     21867--REDEF
F$DCB.TDA
     21881**DCL     21882--REDEF
F$DCB.TYPE#
     21855**DCL     24875>>IF
F$DCB.VOL#
     21865**DCL     25829>>IF      25830>>ASSIGN
F$DCB.WSN#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:601  
     21855**DCL     21855--REDEF
FID_ACCT
     23357**DCL     23218--DCLINIT 23284--DCLINIT 24040--DCLINIT 26457>>ASSIGN  28192<<ASSIGN
FID_NAME
     23343**DCL     23214--DCLINIT 23284--DCLINIT 24036--DCLINIT 28191<<ASSIGN
FID_NAME.L#
     23343**DCL     26477>>ASSIGN
FID_NAME.NAME#
     23343**DCL     26476>>ASSIGN
FID_PASS
     23371**DCL     23215--DCLINIT 23285--DCLINIT
FID_PASS.PASS#
     23371**DCL     27275>>ASSIGN
FID_RANGE$ IN PROCEDURE FLB_FID_RANGE
     27287**DCL     27282--PROC    27306>>ASSIGN
FID_RANGE_SUBLK$ IN PROCEDURE FLB_FID_RANGE
     27294**DCL     27306<<ASSIGN  27307>>DOCASE  27317>>CALL    27322>>CALL    27329>>CALL    27336>>IF
     27341>>CALL    27344>>CALL
FID_SN
     23387**DCL     23213--DCLINIT 23285--DCLINIT 24035--DCLINIT
FID_SN.SN#
     23387**DCL     26445>>ASSIGN  28193<<ASSIGN
FID_WSN
     23401**DCL     23219--DCLINIT 23285--DCLINIT
FILE
     22346**DCL     27319>>ASSIGN  27324>>ASSIGN  27331>>ASSIGN  27338>>ASSIGN  27343>>ASSIGN  27346>>ASSIGN
     27379<<ASSIGN  27380<<ASSIGN
FILE.L#
     22348**DCL     27371<<ASSIGN  27385<<ASSIGN
FILE.NAME#
     22347**DCL     27372<<ASSIGN  27386<<ASSIGN
FILE_N_ACCOUNT$ IN PROCEDURE FLB_FILE_N_ACCOUNT
     27363**DCL     27361--PROC    27368>>IF      27370>>ASSIGN  27370>>ASSIGN  27371>>ASSIGN  27372>>ASSIGN
     27372>>ASSIGN  27375>>ASSIGN
FILE_OPEN IN PROCEDURE FLB_OUTPUT_NODES
     24767**DCL     24803<<ASSIGN  24804>>IF      24814>>IF      24819>>IF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:602  
FILE_TYPE
     14786**DCL     24461<<ASSIGN  26918<<ASSIGN
FILE_TYPE.A
     14786**DCL     26927<<ASSIGN  26931<<ASSIGN  26956<<ASSIGN  26961<<ASSIGN  26982>>IF      26994>>IF
FILE_TYPE.BUF
     14787**DCL     26619<<ASSIGN
FILE_TYPE.DF
     14787**DCL     26618<<ASSIGN  26975<<ASSIGN
FILE_TYPE.FA
     14787**DCL     26933<<ASSIGN  26945<<ASSIGN  26953<<ASSIGN  26992>>IF
FILE_TYPE.I
     14787**DCL     26620<<ASSIGN  26929<<ASSIGN  26932<<ASSIGN  26966<<ASSIGN  26971<<ASSIGN  26987>>IF
     26994>>IF
FILE_TYPE.SA
     14787**DCL     26938<<ASSIGN  26942<<ASSIGN  26949<<ASSIGN  26960<<ASSIGN  26992>>IF
FILE_TYPE.SI
     14787**DCL     26940<<ASSIGN  26943<<ASSIGN  26950<<ASSIGN  26970<<ASSIGN  26992>>IF
FIRST IN PROCEDURE FLB_READ_BACKUP
     28008**DCL     28161<<ASSIGN  28172>>IF      28183<<ASSIGN
FIRST_ACCT
     14806**DCL     27309>>ASSIGN  27315>>ASSIGN  27471>>ASSIGN
FIRST_ACCT_SPECIFIED.ACCT#
     21682**DCL     25444<<ASSIGN  26213<<ASSIGN  26458<<ASSIGN  26462<<ASSIGN  26543>>IF      26544>>ASSIGN
     27396>>IF      27397<<ASSIGN
FIRST_FILE
     14847**DCL     27310>>ASSIGN  27316>>ASSIGN  27351>>ASSIGN  27379>>ASSIGN  27472>>ASSIGN
FIRST_LEGAL_CHAR IN PROCEDURE FLB_ORDER_RANGE
     27442**DCL     27721>>ASSIGN  27746>>ASSIGN  27768>>DOWHILE 27771>>IF
FIRST_TIME
     21563**DCL     24439>>IF      24486<<ASSIGN  24750>>IF
FIT_.W2 IN PROCEDURE FLB_TAPE_NODES
     24993**DCL     24994--REDEF
FIT_AREA.W2
     16344**DCL     16345--REDEF
FLB$EFT_BRK
     21451**DCL-ENT 21928--DCLINIT
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:603  
FLB_ADDREM_NODES
     25480**PROC    24665--CALL    24672--CALL
FLB_BUILD_SNLIST
     27920**PROC    25241--CALL
FLB_CHECK_PACKSET IN PROCEDURE FLB_DISK_SPEC
     26684**PROC    26532--CALL    26538--CALL    26563--CALL
FLB_CREATE_RETRIEVE_CMNDS IN PROCEDURE FLB_TAPE_NODES
     25349**PROC    25070--CALL    25108--CALL
FLB_DATE_SPEC IN PROCEDURE FLB_DISK_OPTION_LIST
     27009**PROC    26799--CALL
FLB_DISK_DEST
     26228**PROC    25116--CALL    25490--CALL    25516--CALL    25758--CALL    26008--CALL    26088--CALL
FLB_DISK_OPTION_LIST IN PROCEDURE FLB_DISK_SPEC
     26706**PROC    26404--CALL
FLB_DISK_SPEC
     26337**PROC    24911--CALL    25118--CALL    25357--CALL    25393--CALL    25430--CALL    25467--CALL
     25487--CALL    25512--CALL    25594--CALL    25667--CALL    25762--CALL    25954--CALL    26004--CALL
     26092--CALL
FLB_DUAL_NODES
     25505**PROC    24569--CALL
FLB_ESTMOD_NODES
     25660**PROC    24653--CALL    24659--CALL
FLB_FID_RANGE IN PROCEDURE FLB_DISK_SPEC
     27282**PROC    26421--CALL    26427--CALL
FLB_FILE_N_ACCOUNT IN PROCEDURE FLB_FID_RANGE
     27361**PROC    27317--CALL    27322--CALL    27329--CALL    27341--CALL    27344--CALL
FLB_NEXT IN PROCEDURE FLB_ORDER_RANGE
     27706**PROC    27642--CALL    27653--CALL
FLB_NEXT_SPEC IN PROCEDURE FLB_ORDER_RANGE
     27621**PROC    27559--CALL    27583--CALL
FLB_NUTHER_FILE_SPEC IN PROCEDURE FLB_DISK_SPEC
     27257**PROC    26422--CALL    26429--CALL    26485--CALL    27475--CALL
FLB_OPEN_NODES
     25684**PROC    24679--CALL
FLB_OPTION_INIT
     26186**PROC    24447--CALL    25748--CALL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:604  
FLB_ORDER_RANGE IN PROCEDURE FLB_DISK_SPEC
     27406**PROC    26518--CALL
FLB_OUTPUT_NODES
     24760**PROC    24636--CALL    24641--CALL
FLB_PREV IN PROCEDURE FLB_ORDER_RANGE
     27752**PROC    27684--CALL    27695--CALL
FLB_PREV_SPEC IN PROCEDURE FLB_ORDER_RANGE
     27663**PROC    27558--CALL    27575--CALL
FLB_READ_BACKUP
     27997**PROC    25167--CALL
FLB_READ_NODES
     24922**PROC    24631--CALL
FLB_REBUILD_NODES
     26022**PROC    24697--CALL
FLB_REBUILD_OPTION_LIST IN PROCEDURE FLB_REBUILD_NODES
     26102**PROC    26079--CALL    26084--CALL
FLB_REQUALIFY_NODES
     25386**PROC    24596--CALL
FLB_RESTORE_NODES
     25990**PROC    24525--CALL
FLB_SAVE_NODES
     25571**PROC    24562--CALL    24576--CALL    24583--CALL    24590--CALL
FLB_SETDATE IN PROCEDURE FLB_DATE_SPEC
     27239**PROC    27106--CALL    27108--CALL    27110--CALL    27112--CALL    27119--CALL    27121--CALL
     27123--CALL
FLB_SET_TAPE_DEFAULTS
     27869**PROC    25255--CALL    25268--CALL    25273--CALL    26041--CALL
FLB_SORT_RANGE IN PROCEDURE FLB_ORDER_RANGE
     27796**PROC    27482--CALL
FLB_STATUS_NODES
     25948**PROC    24685--CALL    24691--CALL
FLB_STOW_FETCH_NODES
     25410**PROC    24602--CALL    24608--CALL    24614--CALL    24619--CALL    24625--CALL
FLB_TAPE_NODES
     24967**PROC    24513--CALL    24519--CALL    24531--CALL    24537--CALL    24543--CALL    26000--CALL
     26098--CALL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:605  
FLB_TAPE_OD_SPEC
     27825**PROC    25045--CALL    25598--CALL    25670--CALL    25703--CALL    25712--CALL    26060--CALL
FLB_TRANS_TYPE
     26153**PROC    25696--CALL
FLB_VALIDATE_NODES
     25460**PROC    24549--CALL    24555--CALL
FLB_WHERE_NODES
     24904**PROC    24647--CALL
FLC$TAPE_IO_INIT
     21452**DCL-ENT 28095--CALL
FLC$TAPE_OPEN_NEXT
     21453**DCL-ENT 28097--CALL
FLC$TAPE_READ_NEXT
     21454**DCL-ENT 28125--CALL
FLE$ESTMOD
     21455**DCL-ENT 25499--CALL    25626--CALL    25647--CALL    25679--CALL
FLERRMSGSYS
     21708**DCL     24363<>CALL
FLI$ALLOC
     21458**DCL-ENT 26309--CALL    26315--CALL    26360--CALL    26364--CALL    26411--CALL    26443--CALL
     26449--CALL    26470--CALL    27263--CALL    27460--CALL    27966--CALL    27989--CALL
FLI$BUILD_$$EFT
     21459**DCL-ENT 25205--CALL
FLI$DISMNT_TAPES
     21460**DCL-ENT 25132--CALL    25136--CALL
FLI$ERROR_SUMMARY
     21461**DCL-ENT 24490--CALL    24711--CALL
FLI$INIT
     21462**DCL-ENT 24446--CALL    25747--CALL
FLI$NODE_TAPE_OD
     21463**DCL-ENT 27850--CALL
FLI$RPT_ERR
     21465**DCL-ENT 24478--CALL    24701--CALL    24709--CALL    24739--CALL    24755--CALL    24756--CALL
     24797--CALL    24798--CALL    24807--CALL    24815--CALL    24820--CALL    24859--CALL    24877--CALL
     24880--CALL    24890--CALL    24898--CALL    24899--CALL    24936--CALL    24960--CALL    25100--CALL
     25148--CALL    25180--CALL    25320--CALL    25374--CALL    25447--CALL    25451--CALL    25542--CALL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:606  
     25558--CALL    25774--CALL    25786--CALL    25794--CALL    25917--CALL    26055--CALL    26129--CALL
     26274--CALL    26297--CALL    26326--CALL    26383--CALL    26396--CALL    26514--CALL    26551--CALL
     26656--CALL    26695--CALL    26743--CALL    26751--CALL    26777--CALL    26795--CALL    26807--CALL
     26818--CALL    26831--CALL    26839--CALL    26855--CALL    26871--CALL    26879--CALL    27175--CALL
     27199--CALL    27221--CALL    27357--CALL    27500--CALL    27501--CALL    27513--CALL    27514--CALL
     27551--CALL    27604--CALL    27616--CALL    27656--CALL    27698--CALL    28109--CALL    28114--CALL
     28153--CALL    28180--CALL    28217--CALL
FLI$STATS
     21466**DCL-ENT 25126--CALL    25296--CALL    25316--CALL    25404--CALL    25474--CALL    25565--CALL
     25654--CALL    25818--CALL    25911--CALL    26017--CALL
FLI$TSN_USED
     21467**DCL-ENT 25831--CALL
FLM$MOVE
     21468**DCL-ENT 25121--CALL    25285--CALL    25537--CALL    25547--CALL    25642--CALL    25812--CALL
     25844--CALL    26012--CALL
FLM$SWITCH_PRIME_DUAL
     21476**DCL-ENT 25554--CALL
FLR$REQUALIFY
     21472**DCL-ENT 25403--CALL
FLS$PROCESS_PRE_RET
     21473**DCL-ENT 25366--CALL
FLS$STATUS
     21479**DCL-ENT 25986--CALL
FLS$STOW_FETCH
     21474**DCL-ENT 25439--CALL
FLV$VALIDATE
     21475**DCL-ENT 25365--CALL    25473--CALL
FLW$WHERE
     21477**DCL-ENT 24917--CALL
FMSEC
     14726**DCL     24378<<ASSIGN  24379<<ASSIGN  24380>>IF      24430>>IF      24472>>IF      24509>>IF
     24516>>IF      24522>>IF      24528>>IF      24534>>IF      24540>>IF      24546>>IF      24552>>IF
     24558>>IF      24565>>IF      24572>>IF      24579>>IF      24586>>IF      24593>>IF      24599>>IF
     24605>>IF      24611>>IF      24617>>IF      24622>>IF      24628>>IF      24634>>IF      24639>>IF
     24644>>IF      24650>>IF      24656>>IF      24662>>IF      24668>>IF      24675>>IF      24682>>IF
     24688>>IF      24694>>IF      24867>>IF      24870>>IF      24887>>IF      24948>>IF      24951>>IF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:607  
     24957>>IF
FPARAM_ IN PROCEDURE FLB_READ_BACKUP
     28011**DCL     28097<>CALL    28120>>ASSIGN
FPT_EXIT
     14195**DCL     24506<>CALL    24732<>CALL    24751<>CALL    25939<>CALL
FPT_EXIT.V.STEPCC#
     14196**DCL     14196--REDEF   24702>>IF      24703<<ASSIGN  24718>>IF      24719<<ASSIGN  25123>>IF
     25124<<ASSIGN  25287>>IF      25288<<ASSIGN  25339>>IF      25340<<ASSIGN  25539>>IF      25540<<ASSIGN
     25562>>IF      25563<<ASSIGN  25651>>IF      25652<<ASSIGN  25922>>IF      25923<<ASSIGN  26014>>IF
     26015<<ASSIGN  26697<<ASSIGN
FPT_FID
     23283**DCL     24854<>CALL    24946<>CALL    25426<>CALL    28147<>CALL
FPT_FID.TEXTFID_
     23283**DCL     24853<<ASSIGN  24945<<ASSIGN  25425<<ASSIGN  28146<<ASSIGN
FPT_FID.V
     23287**DCL     23283--DCLINIT
FPT_FID_RESULTS
     23308**DCL     23287--DCLINIT 24463<<ASSIGN
FPT_FID_RESULTS.ACCT
     23308**DCL     26454>>IF
FPT_FID_RESULTS.CLENGTH.ACCT
     23313**DCL     26454>>IF
FPT_FID_RESULTS.NAME
     23308**DCL     25428>>IF      26474>>IF
FPT_FID_RESULTS.PASS
     23308**DCL     26481>>IF
FPT_FID_RESULTS.SN
     23308**DCL     26438>>IF
FPT_INT
     21928**DCL     24418<>CALL
FPT_INT.V
     21928**DCL     21928--DCLINIT
FPT_REM
     23531**DCL     25251<>CALL    25291<>CALL    25305<>CALL    25887<>CALL    25896<>CALL
FPT_REM.V
     23531**DCL     23531--DCLINIT
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:608  
FPT_REM.V.DISP#
     23531**DCL     25249<<ASSIGN  25289<<ASSIGN  25303<<ASSIGN  25884<<ASSIGN
FPT_REM.V.PSN#
     23532**DCL     25250<<ASSIGN  25290<<ASSIGN  25304<<ASSIGN  25886<<ASSIGN  25895<<ASSIGN
FROM_DISK_ACCT
     15302**DCL     15826--DCLINIT
FROM_DISK_NAME
     15276**DCL     15822--DCLINIT
FROM_DISK_SN
     15328**DCL     15821--DCLINIT
FSN_SPECD IN PROCEDURE FLB_REBUILD_NODES
     26028**DCL     26044<<ASSIGN  26050<<ASSIGN  26053>>IF
GET_ANSDATE_DATEUTS
     22667**DCL     27093<>CALL
GET_ANSDATE_DATEUTS.V
     22671**DCL     22667--DCLINIT
GET_DATEUTS_ANSDATE
     22692**DCL     27173<>CALL
GET_DATEUTS_ANSDATE.V
     22696**DCL     22692--DCLINIT
GET_GREETING_TIME
     22715**DCL     24401<>CALL
GET_GREETING_TIME.V
     22719**DCL     22715--DCLINIT
GET_NOW_UTS
     14747**DCL     25733<>CALL
GET_PSN
     22630**DCL     26324<>CALL    26549<>CALL
GET_PSN.V
     22631**DCL     22630--DCLINIT
GIVE_IT_UP IN PROCEDURE FLB_OUTPUT_NODES
     24891**LABEL   24850--CALLALT 24851--CALLALT 24893--CALLALT 24894--CALLALT
GRAND_START_UTS IN PROCEDURE FLB_OPEN_NODES
     25691**DCL     25734<<ASSIGN  25910>>ASSIGN
GRAND_TOTAL_FILES IN PROCEDURE FLB_OPEN_NODES
     25689**DCL     25730<<ASSIGN  25816<<ASSIGN  25816>>ASSIGN  25903>>IF      25908>>ASSIGN
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:609  
GRAND_TOTAL_GRANS IN PROCEDURE FLB_OPEN_NODES
     25690**DCL     25731<<ASSIGN  25817<<ASSIGN  25817>>ASSIGN  25909>>ASSIGN
GREETINGS
     21564**DCL     22744--DCLINIT 22745--DCLINIT
GREETINGS.GDATE
     21572**DCL     22715--DCLINIT 22716--DCLINIT
GREETINGS.GDAY
     21570**DCL     22718--DCLINIT
GREETINGS.GTIME
     21568**DCL     22717--DCLINIT 22718--DCLINIT
GREETINGS.VERSION
     21566**DCL     24400<<ASSIGN
GREET_TEST_USER
     22777**DCL     24406<>CALL
GREET_TEST_USER.STATION_
     22779**DCL     22779--REDEF
GREET_TEST_USER.V
     22780**DCL     22777--DCLINIT
GREET_TEST_USER.V.DVBYTE.VFC#
     22786**DCL     22786--REDEF
GREET_USER
     22743**DCL     24402<>CALL
GREET_USER.STATION_
     22745**DCL     22745--REDEF
GREET_USER.V
     22746**DCL     22743--DCLINIT
GREET_USER.V.DVBYTE.VFC#
     22752**DCL     22752--REDEF
I
     21575**DCL     25235<<DOINDEX 25266>>IF      25885<<DOINDEX 25886>>ASSIGN  25965<<DOINDEX 25966>>ASSIGN
     25966>>ASSIGN  26215<<DOINDEX 26216>>ASSIGN  26217>>ASSIGN  26218>>ASSIGN  26368<<DOINDEX 26369>>ASSIGN
     26370>>ASSIGN  26372>>ASSIGN  26377>>CALLBLT 26386>>ASSIGN  26391<<DOINDEX 26392>>DOINDEX 26393>>IF
     26426<<DOINDEX 26427>>CALL    26497<<DOINDEX 26498>>IF      26498>>IF      26498>>IF      26498>>IF
     26498>>IF      26502>>DOCASE  26560<<DOINDEX 26561>>ASSIGN  26562>>ASSIGN
I IN PROCEDURE FLB_ORDER_RANGE
     27417**DCL     27487<<ASSIGN  27488>>DOWHILE 27489>>ASSIGN  27490>>IF      27492>>ASSIGN  27494>>IF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:610  
     27499>>IF      27502>>IF      27504>>ASSIGN  27505>>DOINDEX 27508<<ASSIGN  27508>>ASSIGN  27512>>IF
     27519<<ASSIGN  27519>>ASSIGN  27536<<ASSIGN  27538>>DOWHILE 27539>>ASSIGN  27545>>ASSIGN  27567>>DOINDEX
     27570>>ASSIGN  27588>>ASSIGN  27589>>DOINDEX 27599<<ASSIGN  27599>>ASSIGN  27803<<DOINDEX 27804>>ASSIGN
     27805>>IF      27807>>ASSIGN  27808>>ASSIGN  27809>>ASSIGN
I IN PROCEDURE FLB_REBUILD_NODES
     26027**DCL     26048<<DOINDEX 26049>>IF
INCR IN PROCEDURE FLB_STOW_FETCH_NODES
     25416**DCL     25421<<ASSIGN
I_SWAP IN PROCEDURE FLB_ORDER_RANGE
     27420**DCL     27802<<ASSIGN  27807<<ASSIGN  27813>>ASSIGN
J
     21684**DCL     26392<<DOINDEX 26393>>IF
J IN PROCEDURE FLB_ORDER_RANGE
     27418**DCL     27489<<ASSIGN  27490>>IF      27494>>IF      27502>>IF      27504>>ASSIGN  27505<<DOINDEX
     27506>>ASSIGN  27506>>ASSIGN  27567<<DOINDEX 27568>>ASSIGN  27568>>ASSIGN  27589<<DOINDEX 27590>>ASSIGN
     27590>>ASSIGN  27804<<ASSIGN  27805>>IF      27809>>ASSIGN  27810>>ASSIGN
JUSTALT IN PROCEDURE FLB_DISK_SPEC
     26677**LABEL   26518--CALLALT
JUSTCERET IN PROCEDURE FLB_CREATE_RETRIEVE_CMNDS
     25360**LABEL   25365--CALLALT
LAST_ACCT
     14819**DCL     27311>>ASSIGN  27325>>ASSIGN  27473>>ASSIGN
LAST_FILE
     14847**DCL     27312>>ASSIGN  27326>>ASSIGN  27337>>ASSIGN  27380>>ASSIGN  27474>>ASSIGN
LAST_LEGAL_CHAR IN PROCEDURE FLB_ORDER_RANGE
     27443**DCL     27729>>DOWHILE 27732>>IF      27775>>ASSIGN  27789>>ASSIGN
LAST_RANGEX IN PROCEDURE FLB_ORDER_RANGE
     27421**DCL     27492<<ASSIGN  27534>>DOWHILE 27538>>DOWHILE 27571<<ASSIGN  27571>>ASSIGN  27594<<ASSIGN
     27594>>ASSIGN
LAST_SNLISTINFO$
     14179**DCL     21835--IMP-PTR 25051>>ASSIGN  25056<<ASSIGN  25246>>IF      25277>>ASSIGN  25282<<ASSIGN
     25611>>IF      25636>>ASSIGN  25714>>ASSIGN  25719<<ASSIGN  26068>>ASSIGN  26073<<ASSIGN  27991>>ASSIGN
     27992<<ASSIGN
LAST_TAPE_FSN
     14890**DCL     25238<<ASSIGN  25239<<ASSIGN  25255<>CALL    25268<>CALL    25273<>CALL    26124<<ASSIGN
     26125<<CALLBLT 26126>>IF      27899<<ASSIGN  27900<<ASSIGN  28133<<ASSIGN
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:611  
LAST_T_FSN IN PROCEDURE FLB_SET_TAPE_DEFAULTS
     27875**DCL     27869--PROC    27898--IF      27900>>ASSIGN
LEGAL_CHAR IN PROCEDURE FLB_ORDER_RANGE
     27444**DCL     27729>>DOWHILE 27768>>DOWHILE
M IN PROCEDURE FLB_ORDER_RANGE
     27419**DCL     27533<<ASSIGN  27534>>DOWHILE 27540>>ASSIGN  27546>>ASSIGN  27564>>ASSIGN  27566>>ASSIGN
     27567>>DOINDEX 27572<<ASSIGN  27572>>ASSIGN  27589>>DOINDEX 27593<<ASSIGN  27593>>ASSIGN  27606<<ASSIGN
     27606>>ASSIGN  27800<<ASSIGN  27801>>DOWHILE 27803>>DOINDEX 27813<<ASSIGN
M$CATALOG
     21522**DCL     24360--ASSIGN  24787>>ASSIGN
M$CATALOG$
     21579**DCL     24360<<ASSIGN  24512>>ASSIGN  24561>>ASSIGN  24568>>ASSIGN  24575>>ASSIGN  24582>>ASSIGN
     24589>>ASSIGN  24678>>ASSIGN  24786>>ASSIGN
M$CLOSE
      5502**DCL-ENT 24745--CALL    24805--CALL    24878--CALL    24934--CALL    25213--CALL    25295--CALL
     25310--CALL    25315--CALL    25325--CALL    25332--CALL    25336--CALL    25833--CALL    25853--CALL
     25941--CALL    28136--CALL    28139--CALL    28168--CALL    28169--CALL    28208--CALL    28209--CALL
     28220--CALL    28222--CALL    28224--CALL
M$DEVICE
      5506**DCL-ENT 24385--CALL    24707--CALL    24851--CALL    24873--CALL    24894--CALL
M$DISK00
     15219**DCL     25322--IF      28070>>ASSIGN  28071>>ASSIGN  28078>>ASSIGN  28221--IF
M$DO
     21520**DCL     24386--IF      24388>>ASSIGN  24721<>CALL    25928<>CALL
M$EXIT
      5514**DCL-ENT 24506--CALL    24732--CALL    24751--CALL    25939--CALL
M$FID
      5565**DCL-ENT 24854--CALL    24946--CALL    25426--CALL    28147--CALL
M$INT
      5557**DCL-ENT 24418--CALL
M$LO
     21519**DCL     24359--ASSIGN  24383>>ASSIGN  24445<>CALL    24715<>CALL    24778>>ASSIGN  25746<>CALL
     25924<>CALL
M$LO$
     21578**DCL     24359<<ASSIGN  24777>>ASSIGN
M$MADMUCK
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:612  
      5510**DCL-ENT 26324--CALL    26549--CALL
M$OPEN
      5502**DCL-ENT 24382--CALL    24384--CALL    24389--CALL    24850--CALL    24869--CALL    24893--CALL
     24950--CALL    25146--CALL    25177--CALL    25201--CALL    25206--CALL    25215--CALL    25226--CALL
     25372--CALL    26688--CALL    28121--CALL    28149--CALL    28158--CALL    28195--CALL    28198--CALL
M$READ
      5503**DCL-ENT 25182--CALL    25228--CALL    25236--CALL    28164--CALL    28204--CALL
M$READ_FILE
     21518**DCL     24358--ASSIGN  24939>>ASSIGN  24953<>CALL    25378<>CALL
M$READ_FILE$
     21576**DCL     24358<<ASSIGN  24729>>IF      24744>>IF      24933>>IF      25936>>IF
M$REBUILD
     15954**DCL     25327--IF
M$REM
      5511**DCL-ENT 25251--CALL    25291--CALL    25305--CALL    25887--CALL    25896--CALL    28141--CALL
M$RPRIV
      5561**DCL-ENT 24381--CALL    24431--CALL    24868--CALL    24949--CALL
M$SI
     21517**DCL     24357--ASSIGN  24748<>CALL    24961<>CALL    25942<>CALL
M$SI$
     21577**DCL     24357<<ASSIGN
M$SPRIV
      5561**DCL-ENT 24510--CALL    24517--CALL    24523--CALL    24529--CALL    24535--CALL    24541--CALL
     24547--CALL    24553--CALL    24559--CALL    24566--CALL    24573--CALL    24580--CALL    24587--CALL
     24594--CALL    24600--CALL    24606--CALL    24612--CALL    24618--CALL    24623--CALL    24629--CALL
     24635--CALL    24640--CALL    24645--CALL    24651--CALL    24657--CALL    24663--CALL    24669--CALL
     24676--CALL    24683--CALL    24689--CALL    24695--CALL    24871--CALL    24888--CALL    24952--CALL
     24958--CALL
M$STATUS
     15954**DCL     28150--IF      28152>>ASSIGN  28179>>ASSIGN  28223--IF
M$TAPE00
     21521**DCL     25141>>ASSIGN  25142>>ASSIGN  25290--ASSIGN  25895--ASSIGN  28108>>ASSIGN  28140--ASSIGN
     28219--IF
M$TAPE00$
     15970**DCL     25246>>IF      25250>>ASSIGN  25267>>ASSIGN  25304>>ASSIGN
M$TIME
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:613  
      5569**DCL-ENT 24401--CALL    25733--CALL    27093--CALL    27173--CALL
M$WRITE
      5503**DCL-ENT 24402--CALL    24406--CALL    28129--CALL    28185--CALL    28212--CALL
M$XXX
      5514**DCL-ENT 24365--CALL    24479--CALL    24740--CALL    24757--CALL    24900--CALL
MAX_NX IN PROCEDURE FLB_NEXT
     27713**DCL     27706--PROC    27719>>IF
MAX_NX IN PROCEDURE FLB_PREV
     27759**DCL     27752--PROC    27774>>DOINDEX 27777>>ASSIGN  27788>>DOINDEX 27791>>ASSIGN
MODE
     21686**DCL     25742>>IF      25766>>IF      26171<<ASSIGN  26180<<ASSIGN  26665>>ASSIGN
MUCK_LIST
     21593**DCL     22631--DCLINIT
MUCK_LIST.SN#
     21593**DCL     26330>>ASSIGN  26554>>ASSIGN
N
     21595**DCL     21734--IMP-SIZ 26726<<ASSIGN  26727>>ASSIGN  26728>>ASSIGN  26729>>DOWHILE 26730<<ASSIGN
     26730>>ASSIGN  26731>>IF      27266<<ASSIGN  27267>>ASSIGN  27268>>ASSIGN  27269>>ASSIGN  27270>>ASSIGN
     27271>>ASSIGN  27272>>ASSIGN
N IN PROCEDURE FLB_BUILD_SNLIST
     27929**DCL     27968<<CALLBLT 27969>>IF      27973<<DOINDEX 27975>>ASSIGN  27982<<DOINDEX 27984>>ASSIGN
N IN PROCEDURE FLB_NEXT
     27712**DCL     27706--PROC    27717>>ASSIGN  27722<<ASSIGN  27739<<ASSIGN  27739>>ASSIGN  27747<<ASSIGN
N IN PROCEDURE FLB_NEXT_SPEC
     27637**DCL     27641<<ASSIGN  27642<>CALL    27644>>ASSIGN  27647>>ASSIGN  27648<<ASSIGN  27649>>DOWHILE
     27649>>DOWHILE 27650<<ASSIGN  27650>>ASSIGN  27652<<ASSIGN  27652>>ASSIGN  27653<>CALL
N IN PROCEDURE FLB_PREV
     27758**DCL     27752--PROC    27763>>ASSIGN  27777<<ASSIGN  27791<<ASSIGN
N IN PROCEDURE FLB_PREV_SPEC
     27679**DCL     27683<<ASSIGN  27684<>CALL    27686>>ASSIGN  27689>>ASSIGN  27690<<ASSIGN  27691>>DOWHILE
     27691>>DOWHILE 27692<<ASSIGN  27692>>ASSIGN  27694<<ASSIGN  27694>>ASSIGN  27695<>CALL
NAMEB IN PROCEDURE FLB_NEXT
     27711**DCL     27706--PROC    27721<<ASSIGN  27727>>ASSIGN  27734<<ASSIGN  27737<<ASSIGN  27746<<ASSIGN
NAMEB IN PROCEDURE FLB_PREV
     27757**DCL     27752--PROC    27766>>ASSIGN  27773<<ASSIGN  27775<<ASSIGN  27780<<ASSIGN  27789<<ASSIGN
NBR_BYTES_TO_MOVE
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:614  
     15983**DCL     15984--IMP-SIZ 15985--IMP-SIZ
NBR_CONTROL_FILE
     14897**DCL     25959<<ASSIGN  25964<<ASSIGN  25965>>DOINDEX 25971>>IF      25979<<ASSIGN
NBR_DPS
     21596**DCL     26357<<ASSIGN  26358>>ASSIGN  26362>>ASSIGN  26366>>ASSIGN  26367>>ASSIGN  26368>>DOINDEX
     26391>>DOINDEX 26392>>DOINDEX 26440<<ASSIGN  26441>>ASSIGN  26444>>ASSIGN
NBR_GRANS_PER_TAPE_BUF
     14729**DCL     27910<<ASSIGN
NBR_RUNS IN PROCEDURE FLB_TAPE_NODES
     24975**DCL     25229<<ASSIGN  25235>>DOINDEX
NBR_SNLISTS
     14183**DCL     25057<<ASSIGN  25076>>IF      25283<<ASSIGN  25621>>IF      25720<<ASSIGN  25885>>DOINDEX
     26074<<ASSIGN  27843<<ASSIGN
NEW_DISK_DESC
     14790**DCL     25399<<ASSIGN
NEW_DISK_DESC.BUF#
     14790**DCL     25402<<ASSIGN
NEW_DISK_DESC.QS#
     14791**DCL     25401<<ASSIGN
NEW_REBUILD IN PROCEDURE FLB_TAPE_NODES
     24979**DCL     25179<<ASSIGN  25197<<ASSIGN  25329>>IF
NN IN PROCEDURE FLB_BUILD_SNLIST
     27930**DCL     27972<<CALLBLT 27974>>CALLBLT 27976<<ASSIGN  27976>>ASSIGN  27981<<CALLBLT 27983>>CALLBLT
     27985<<ASSIGN  27985>>ASSIGN
NODATA_FILE_NAME.L#
     17598**DCL     17598--IMP-SIZ
NODATA_KEY
     17744**DCL     17736--DCLINIT 17737--DCLINIT
NODE$
     21597**DCL     21611--REDEF   24442<>CALL    24444<>CALL    24458>>ASSIGN  24494>>ASSIGN  24794>>IF
     24812>>IF      24831>>DOINDEX 24832>>ASSIGN  24945>>ASSIGN  24945>>ASSIGN  25067>>IF      25067>>IF
     25084>>IF      25086>>DOINDEX 25087>>ASSIGN  25422>>DOINDEX 25424>>ASSIGN  25745<>CALL    25752>>ASSIGN
     25863>>ASSIGN  25875>>DOINDEX 25876>>ASSIGN  25960>>DOINDEX 25961>>ASSIGN  25997>>IF      26035>>DOINDEX
     26036>>ASSIGN  26160>>DOINDEX 26161>>ASSIGN  26235>>DOINDEX 26236>>ASSIGN  26351>>DOINDEX 26352>>ASSIGN
     27844>>DOINDEX 27845>>ASSIGN  28083>>IF      28083>>IF      28086>>ASSIGN
NODE_ERROR IN PROCEDURE FLB_TAPE_OD_SPEC
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:615  
     27834**DCL     27842<<ASSIGN  27852<<ASSIGN  27855<<ASSIGN  27861>>IF      27862>>IF
NOT_SPECIFIED IN PROCEDURE FLB_DATE_SPEC
     27027**DCL     27067<<ASSIGN  27077<<ASSIGN  27139>>IF
NOW_UTS
     14735**DCL     25734>>ASSIGN  27088<>CALL    27092>>ASSIGN
NO_FILE
     14848**DCL     27350>>IF
NULL_ACCT
     14845**DCL     22513--DCLINIT
NULL_FILE
     14848**DCL     22509--DCLINIT
OPEN_BACKUP_FILE IN PROCEDURE FLB_READ_BACKUP
     28097**LABEL   28106--GOTO
OPEN_BACKUP_RBLDFILE
     24035**DCL     28149<>CALL    28195<>CALL
OPEN_BACKUP_RBLDFILE.ACSVEH_
     24037**DCL     24038--REDEF
OPEN_BACKUP_RBLDFILE.ALTKEYS_
     24043**DCL     24044--REDEF   24044--REDEF
OPEN_BACKUP_RBLDFILE.HDR_
     24042**DCL     24043--REDEF
OPEN_BACKUP_RBLDFILE.TAB_
     24041**DCL     24042--REDEF
OPEN_BACKUP_RBLDFILE.UHL_
     24035**DCL     24036--REDEF   24036--REDEF
OPEN_BACKUP_RBLDFILE.V
     24044**DCL     24035--DCLINIT
OPEN_BACKUP_RBLDFILE.V.FSN#
     24075**DCL     24075--REDEF   24075--REDEF
OPEN_BACKUP_RBLDFILE.V.RES#
     24059**DCL     28148<<ASSIGN  28194<<ASSIGN
OPEN_BACKUP_RBLDFILE.WSN_
     24041**DCL     24041--REDEF
OPEN_BACKUP_TEMP
     24155**DCL     25226<>CALL    28158<>CALL    28198<>CALL
OPEN_BACKUP_TEMP.ACSVEH_
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:616  
     24157**DCL     24158--REDEF
OPEN_BACKUP_TEMP.ALTKEYS_
     24163**DCL     24164--REDEF   24164--REDEF
OPEN_BACKUP_TEMP.HDR_
     24162**DCL     24163--REDEF
OPEN_BACKUP_TEMP.TAB_
     24161**DCL     24162--REDEF
OPEN_BACKUP_TEMP.UHL_
     24155**DCL     24156--REDEF   24156--REDEF
OPEN_BACKUP_TEMP.V
     24164**DCL     24155--DCLINIT
OPEN_BACKUP_TEMP.V.FSN#
     24195**DCL     24195--REDEF   24195--REDEF
OPEN_BACKUP_TEMP.V.FUN#
     24174**DCL     25225<<ASSIGN  28157<<ASSIGN  28197<<ASSIGN
OPEN_BACKUP_TEMP.WSN_
     24161**DCL     24161--REDEF
OPEN_BLOCK_FILE.ACSVEH_
     15823**DCL     15824--REDEF
OPEN_BLOCK_FILE.ALTKEYS_
     15829**DCL     15830--REDEF   15830--REDEF
OPEN_BLOCK_FILE.HDR_
     15828**DCL     15829--REDEF
OPEN_BLOCK_FILE.TAB_
     15827**DCL     15828--REDEF
OPEN_BLOCK_FILE.UHL_
     15821**DCL     15822--REDEF   15822--REDEF
OPEN_BLOCK_FILE.V
     15830**DCL     15821--DCLINIT
OPEN_BLOCK_FILE.V.FSN#
     15861**DCL     15861--REDEF   15861--REDEF
OPEN_BLOCK_FILE.WSN_
     15827**DCL     15827--REDEF
OPEN_DEFAULT_LO
     23475**DCL     24850<>CALL    24893<>CALL
OPEN_DEFAULT_LO.ACSVEH_
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:617  
     23477**DCL     23478--REDEF
OPEN_DEFAULT_LO.ALTKEYS_
     23483**DCL     23484--REDEF   23484--REDEF
OPEN_DEFAULT_LO.HDR_
     23482**DCL     23483--REDEF
OPEN_DEFAULT_LO.TAB_
     23481**DCL     23482--REDEF
OPEN_DEFAULT_LO.UHL_
     23475**DCL     23476--REDEF   23476--REDEF
OPEN_DEFAULT_LO.V
     23484**DCL     23475--DCLINIT
OPEN_DEFAULT_LO.V.FSN#
     23515**DCL     23515--REDEF   23515--REDEF
OPEN_DEFAULT_LO.WSN_
     23481**DCL     23481--REDEF
OPEN_FID
     23213**DCL     24869<>CALL    24950<>CALL
OPEN_FID.ACSVEH_
     23215**DCL     23216--REDEF
OPEN_FID.ALTKEYS_
     23221**DCL     23222--REDEF   23222--REDEF
OPEN_FID.HDR_
     23220**DCL     23221--REDEF
OPEN_FID.TAB_
     23219**DCL     23220--REDEF
OPEN_FID.UHL_
     23213**DCL     23214--REDEF   23214--REDEF
OPEN_FID.V
     23222**DCL     23213--DCLINIT
OPEN_FID.V.ACS#
     23233**DCL     24783<<ASSIGN  24791<<ASSIGN
OPEN_FID.V.ASN#
     23232**DCL     23286--DCLINIT 24857>>IF
OPEN_FID.V.DCB#
     23222**DCL     24825<<ASSIGN  24939<<ASSIGN
OPEN_FID.V.EXIST#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:618  
     23226**DCL     24781<<ASSIGN  24836<<ASSIGN  24839<<ASSIGN  24842<<ASSIGN  24846<<ASSIGN
OPEN_FID.V.FSN#
     23253**DCL     23253--REDEF   23253--REDEF
OPEN_FID.V.FUN#
     23232**DCL     24780<<ASSIGN  24789<<ASSIGN  24835<<ASSIGN  24838<<ASSIGN  24841<<ASSIGN  24845<<ASSIGN
     24848<<ASSIGN  24938<<ASSIGN
OPEN_FID.V.ORG#
     23233**DCL     24779<<ASSIGN  24788<<ASSIGN
OPEN_FID.V.RES#
     23237**DCL     23286--DCLINIT 28148>>ASSIGN
OPEN_FID.V.TYPE#
     23234**DCL     24782<<ASSIGN  24790<<ASSIGN
OPEN_FID.WSN_
     23219**DCL     23219--REDEF
OPEN_LO_DO
     22895**DCL     24384<>CALL    24389<>CALL
OPEN_LO_DO.ACSVEH_
     22897**DCL     22898--REDEF
OPEN_LO_DO.ALTKEYS_
     22903**DCL     22904--REDEF   22904--REDEF
OPEN_LO_DO.HDR_
     22902**DCL     22903--REDEF
OPEN_LO_DO.TAB_
     22901**DCL     22902--REDEF
OPEN_LO_DO.UHL_
     22895**DCL     22896--REDEF   22896--REDEF
OPEN_LO_DO.V
     22904**DCL     22895--DCLINIT
OPEN_LO_DO.V.DCB#
     22904**DCL     24383<<ASSIGN  24388<<ASSIGN
OPEN_LO_DO.V.FSN#
     22935**DCL     22935--REDEF   22935--REDEF
OPEN_LO_DO.WSN_
     22901**DCL     22901--REDEF
OPEN_NODATA_LIST.ACSVEH_
     17531**DCL     17532--REDEF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:619  
OPEN_NODATA_LIST.ALTKEYS_
     17537**DCL     17538--REDEF   17538--REDEF
OPEN_NODATA_LIST.HDR_
     17536**DCL     17537--REDEF
OPEN_NODATA_LIST.TAB_
     17535**DCL     17536--REDEF
OPEN_NODATA_LIST.UHL_
     17529**DCL     17530--REDEF   17530--REDEF
OPEN_NODATA_LIST.V.FSN#
     17569**DCL     17569--REDEF   17569--REDEF
OPEN_NODATA_LIST.WSN_
     17535**DCL     17535--REDEF
OPEN_PRIME_DUAL.ACSVEH_
     16978**DCL     16979--REDEF
OPEN_PRIME_DUAL.ALTKEYS_
     16984**DCL     16985--REDEF   16985--REDEF
OPEN_PRIME_DUAL.HDR_
     16983**DCL     16984--REDEF
OPEN_PRIME_DUAL.TAB_
     16982**DCL     16983--REDEF
OPEN_PRIME_DUAL.UHL_
     16976**DCL     16977--REDEF   16977--REDEF
OPEN_PRIME_DUAL.V.FSN#
     17016**DCL     17016--REDEF   17016--REDEF
OPEN_PRIME_DUAL.WSN_
     16982**DCL     16982--REDEF
OPEN_REBUILD
     17211**DCL     25177<>CALL    25201<>CALL    25206<>CALL    25215<>CALL
OPEN_REBUILD.ACSVEH_
     17213**DCL     17214--REDEF
OPEN_REBUILD.ALTKEYS_
     17219**DCL     17220--REDEF   17220--REDEF
OPEN_REBUILD.HDR_
     17218**DCL     17219--REDEF
OPEN_REBUILD.TAB_
     17217**DCL     17218--REDEF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:620  
OPEN_REBUILD.UHL_
     17211**DCL     17212--REDEF   17212--REDEF
OPEN_REBUILD.V.EXIST#
     17224**DCL     25198<<ASSIGN
OPEN_REBUILD.V.EXPIRE#
     17240**DCL     25200<<ASSIGN
OPEN_REBUILD.V.FSN#
     17251**DCL     17251--REDEF   17251--REDEF
OPEN_REBUILD.V.FUN#
     17230**DCL     25176<<ASSIGN  25199<<ASSIGN  25214<<ASSIGN
OPEN_REBUILD.V.RES#
     17235**DCL     26305<<ASSIGN
OPEN_REBUILD.WSN_
     17217**DCL     17217--REDEF
OPEN_SI
     23051**DCL     24382<>CALL
OPEN_SI.ACSVEH_
     23053**DCL     23054--REDEF
OPEN_SI.ALTKEYS_
     23059**DCL     23060--REDEF   23060--REDEF
OPEN_SI.HDR_
     23058**DCL     23059--REDEF
OPEN_SI.TAB_
     23057**DCL     23058--REDEF
OPEN_SI.UHL_
     23051**DCL     23052--REDEF   23052--REDEF
OPEN_SI.V
     23060**DCL     23051--DCLINIT
OPEN_SI.V.FSN#
     23091**DCL     23091--REDEF   23091--REDEF
OPEN_SI.WSN_
     23057**DCL     23057--REDEF
OPEN_STATUS.ACSVEH_
     16415**DCL     16416--REDEF
OPEN_STATUS.ALTKEYS_
     16421**DCL     16422--REDEF   16422--REDEF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:621  
OPEN_STATUS.HDR_
     16420**DCL     16421--REDEF
OPEN_STATUS.TAB_
     16419**DCL     16420--REDEF
OPEN_STATUS.UHL_
     16413**DCL     16414--REDEF   16414--REDEF
OPEN_STATUS.V.FSN#
     16453**DCL     16453--REDEF   16453--REDEF
OPEN_STATUS.WSN_
     16419**DCL     16419--REDEF
OPEN_TSN_USED.ACSVEH_
     16151**DCL     16152--REDEF
OPEN_TSN_USED.ALTKEYS_
     16157**DCL     16158--REDEF   16158--REDEF
OPEN_TSN_USED.HDR_
     16156**DCL     16157--REDEF
OPEN_TSN_USED.TAB_
     16155**DCL     16156--REDEF
OPEN_TSN_USED.UHL_
     16149**DCL     16150--REDEF   16150--REDEF
OPEN_TSN_USED.V.FSN#
     16189**DCL     16189--REDEF   16189--REDEF
OPEN_TSN_USED.WSN_
     16155**DCL     16155--REDEF
OPTION_MAP
     21689**DCL     24459<<ASSIGN  26917<<ASSIGN
OPTION_MAP.ACTIVE
     21694**DCL     26782<<ASSIGN  26926>>IF      26937>>IF      26954>>IF
OPTION_MAP.ARCHIVE
     21690**DCL     26765<<ASSIGN  26925>>IF      26955>>IF      26965>>IF
OPTION_MAP.DELF
     21696**DCL     26740<<ASSIGN  26974>>IF
OPTION_MAP.INACTIVE
     21695**DCL     26785<<ASSIGN  26928>>IF      26939>>IF      26964>>IF
OPTION_MAP.QF
     21693**DCL     26774<<ASSIGN  26952>>IF      26958>>IF      26968>>IF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:622  
OPTION_MAP.QS
     21692**DCL     26771<<ASSIGN  26947>>IF
OPTION_MAP.QUEUED
     21691**DCL     26768<<ASSIGN  26935>>IF      26958>>IF      26968>>IF
OUR_ACCT
     22648**DCL     22630--DCLINIT 28076--ASSIGN
OUR_ACCT.ACCT#
     22648**DCL     26323<<ASSIGN  26544<<ASSIGN  26545<<ASSIGN  28075<<ASSIGN
OUT$BLK.CODE
     21752**DCL     24458>>ASSIGN  24812>>IF      24833>>DOCASE  25067>>IF      25088>>DOCASE  25092>>DOCASE
     25752>>ASSIGN  25878>>DOCASE  25962>>DOCASE  25966>>ASSIGN  25997>>IF      26038>>DOCASE  26049>>IF
     26111>>DOCASE  26113>>ASSIGN  26163>>DOCASE  26168>>DOCASE  26174>>DOCASE  26176>>ASSIGN  26238>>DOCASE
     26241>>DOCASE  26262>>DOCASE  26283>>ASSIGN  26354>>DOCASE  26418>>DOCASE  26721>>DOCASE  26725>>ASSIGN
     26860>>DOCASE  26876>>ASSIGN  26889>>ASSIGN  27074>>DOCASE  27080>>ASSIGN  27083>>ASSIGN  27097>>IF
     27307>>DOCASE  27336>>IF      27376>>IF      27847>>DOCASE  28083>>IF      28087>>DOCASE
OUT$BLK.NDTYPE
     21747**DCL     26266>>IF      26289>>IF      26375>>IF
OUT$BLK.NSUBLKS
     21756**DCL     24794>>IF      24831>>DOINDEX 25067>>IF      25084>>IF      25086>>DOINDEX 25090>>DOINDEX
     25422>>DOINDEX 25875>>DOINDEX 25960>>DOINDEX 25964>>ASSIGN  26035>>DOINDEX 26045>>IF      26048>>DOINDEX
     26077>>IF      26108>>DOINDEX 26123>>IF      26160>>DOINDEX 26172>>DOINDEX 26235>>DOINDEX 26259>>DOINDEX
     26265>>DOINDEX 26288>>DOINDEX 26351>>DOINDEX 26357>>ASSIGN  26371>>IF      26374>>DOINDEX 26415>>DOINDEX
     26426>>DOINDEX 26719>>DOINDEX 26789>>IF      26859>>DOINDEX 27072>>DOINDEX 27095>>DOINDEX 27102>>DOINDEX
     27368>>IF      27844>>DOINDEX 28083>>IF
OUT$BLK.SUBLK$
     21777**DCL     24494>>ASSIGN  24812>>IF      24832>>ASSIGN  24945>>ASSIGN  24945>>ASSIGN  25067>>IF
     25087>>ASSIGN  25091>>ASSIGN  25424>>ASSIGN  25863>>ASSIGN  25876>>ASSIGN  25961>>ASSIGN  25966>>ASSIGN
     25997>>IF      26036>>ASSIGN  26047>>ASSIGN  26049>>IF      26079<>CALL    26109>>ASSIGN  26113>>ASSIGN
     26117>>CALLBLT 26117>>CALLBLT 26121>>CALLBLT 26121>>CALLBLT 26125>>CALLBLT 26125>>CALLBLT 26161>>ASSIGN
     26166>>ASSIGN  26173>>ASSIGN  26176>>ASSIGN  26236>>ASSIGN  26241>>DOCASE  26260>>ASSIGN  26266>>IF
     26268>>CALLBLT 26268>>CALLBLT 26268>>CALLBLT 26271>>IF      26271>>IF      26277>>ASSIGN  26277>>ASSIGN
     26283>>ASSIGN  26287>>ASSIGN  26289>>IF      26291>>CALLBLT 26291>>CALLBLT 26291>>CALLBLT 26294>>IF
     26294>>IF      26300>>ASSIGN  26300>>ASSIGN  26352>>ASSIGN  26370>>ASSIGN  26375>>IF      26377>>CALLBLT
     26377>>CALLBLT 26377>>CALLBLT 26380>>IF      26380>>IF      26386>>ASSIGN  26386>>ASSIGN  26416>>ASSIGN
     26426>>DOINDEX 26427>>CALL    26427<>CALL    26720>>ASSIGN  26725>>ASSIGN  26860>>DOCASE  26876>>ASSIGN
     26885>>CALLBLT 26885>>CALLBLT 26889>>ASSIGN  27073>>ASSIGN  27080>>ASSIGN  27083>>ASSIGN  27087>>CALLBLT
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:623  
     27087>>CALLBLT 27096>>ASSIGN  27103>>ASSIGN  27306>>ASSIGN  27317<>CALL    27322<>CALL    27329<>CALL
     27336>>IF      27336>>IF      27341<>CALL    27344<>CALL    27370>>ASSIGN  27370>>ASSIGN  27371>>ASSIGN
     27371>>ASSIGN  27372>>ASSIGN  27372>>ASSIGN  27372>>ASSIGN  27372>>ASSIGN  27375>>ASSIGN  27385>>ASSIGN
     27386>>ASSIGN  27386>>ASSIGN  27845>>ASSIGN  28083>>IF      28086>>ASSIGN  28146>>ASSIGN  28146>>ASSIGN
OUT$SYM.COUNT
     21813**DCL     21816--IMP-SIZ 24853>>ASSIGN  24945>>ASSIGN  25425>>ASSIGN  26117>>CALLBLT 26121>>CALLBLT
     26125>>CALLBLT 26268>>CALLBLT 26268>>CALLBLT 26271>>IF      26277>>ASSIGN  26281>>ASSIGN  26291>>CALLBLT
     26291>>CALLBLT 26294>>IF      26300>>ASSIGN  26372>>ASSIGN  26377>>CALLBLT 26377>>CALLBLT 26380>>IF
     26386>>ASSIGN  26885>>CALLBLT 27087>>CALLBLT 27245>>CALLBLT 27370>>ASSIGN  27371>>ASSIGN  27372>>ASSIGN
     27381>>ASSIGN  27385>>ASSIGN  27386>>ASSIGN  28146>>ASSIGN
OUT$SYM.TEXT
     21816**DCL     24853--ASSIGN  24945--ASSIGN  25425--ASSIGN  26117>>CALLBLT 26121>>CALLBLT 26125>>CALLBLT
     26268>>CALLBLT 26271>>IF      26277>>ASSIGN  26281>>ASSIGN  26291>>CALLBLT 26294>>IF      26300>>ASSIGN
     26372>>ASSIGN  26377>>CALLBLT 26380>>IF      26386>>ASSIGN  26885>>CALLBLT 27087>>CALLBLT 27245>>CALLBLT
     27370>>ASSIGN  27372>>ASSIGN  27381>>ASSIGN  27386>>ASSIGN  28146--ASSIGN
OUT$SYM.TEXTC$
     21808**DCL     24494>>ASSIGN  25863>>ASSIGN
OVER_FIL
     14727**DCL     25159<<ASSIGN  25741<<ASSIGN  26193>>IF      26245<<ASSIGN  26248<<ASSIGN  26250<<ASSIGN
PAGE_LO
     23549**DCL     24851<>CALL    24873<>CALL    24894<>CALL
PAGE_LO.V
     23550**DCL     23549--DCLINIT
PAGE_LO_HEADER
     22610**DCL     22568--DCLINIT 22589--DCLINIT
PAGE_LO_RESET
     22567**DCL     24385<>CALL
PAGE_LO_RESET.V
     22568**DCL     22567--DCLINIT
PREV_ACCT
     21666**DCL     27398<<ASSIGN
PREV_ACCT.ACCT#
     21666**DCL     25443<<ASSIGN  26210<<ASSIGN  27384>>ASSIGN
PREV_COMMAND
     21548**DCL     24437<<ASSIGN  25611>>IF      25611>>IF
PREV_TAPE_SN.SN# IN PROCEDURE FLB_SAVE_NODES
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:624  
     25589**DCL     25611>>IF      25636<<ASSIGN
PRE_RET_CLOSE.SN_
     15134**DCL     15134--REDEF
PRE_RET_CLOSE.UTL_
     15135**DCL     15135--REDEF
PRE_RET_CLOSE.V.EXPIRE#
     15149**DCL     15149--REDEF
PRE_RET_CLOSE.V.TYPE#
     15147**DCL     15147--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
     15144**DCL     15144--REDEF   15146--REDEF
PRE_RET_OPEN.ACSVEH_
     15069**DCL     15070--REDEF
PRE_RET_OPEN.ALTKEYS_
     15075**DCL     15076--REDEF   15076--REDEF
PRE_RET_OPEN.HDR_
     15074**DCL     15075--REDEF
PRE_RET_OPEN.TAB_
     15073**DCL     15074--REDEF
PRE_RET_OPEN.UHL_
     15067**DCL     15068--REDEF   15068--REDEF
PRE_RET_OPEN.V.FSN#
     15107**DCL     15107--REDEF   15107--REDEF
PRE_RET_OPEN.WSN_
     15073**DCL     15073--REDEF
PRE_RET_READ.STATION_
     14924**DCL     14925--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
     14936**DCL     14936--REDEF
PRE_RET_READ.V.INDX#
     14934**DCL     14934--REDEF
PRE_RET_WRITE.STATION_
     14962**DCL     14962--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
     14969**DCL     14969--REDEF
PRIME_FILE.L#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:625  
     16882**DCL     16882--IMP-SIZ
PROMPT
     21712**DCL     25745--CALL
RANGE IN PROCEDURE FLB_FILE_N_ACCOUNT
     27364**DCL     27361--PROC    27378>>IF
RANGE_FOUND IN PROCEDURE FLB_ORDER_RANGE
     27427**DCL     27537<<ASSIGN  27538>>DOWHILE 27544<<ASSIGN  27601>>IF
RANGE_SPECIFIED
     21668**DCL     26211<<ASSIGN  26423<<ASSIGN  26486<<ASSIGN  27454>>IF      27469>>IF
RANGE_START IN PROCEDURE FLB_ORDER_RANGE
     27433**DCL     27547>>IF      27554>>IF      27584<<ASSIGN
RANGE_START$ IN PROCEDURE FLB_ORDER_RANGE
     27422**DCL     27433--IMP-PTR 27545<<ASSIGN  27547>>IF      27554>>IF      27584>>ASSIGN
RANGE_STOP IN PROCEDURE FLB_ORDER_RANGE
     27434**DCL     27542>>IF      27547>>IF      27556>>IF      27560>>ASSIGN  27561<<ASSIGN  27576<<ASSIGN
     27581>>IF
RANGE_STOP$ IN PROCEDURE FLB_ORDER_RANGE
     27423**DCL     27434--IMP-PTR 27539<<ASSIGN  27542>>IF      27547>>IF      27556>>IF      27560>>ASSIGN
     27561>>ASSIGN  27576>>ASSIGN  27581>>IF
READ_AD_OR_FD.ACSVEH_
     15713**DCL     15714--REDEF
READ_AD_OR_FD.ALTKEYS_
     15719**DCL     15720--REDEF   15720--REDEF
READ_AD_OR_FD.HDR_
     15718**DCL     15719--REDEF
READ_AD_OR_FD.TAB_
     15717**DCL     15718--REDEF
READ_AD_OR_FD.UHL_
     15711**DCL     15712--REDEF   15712--REDEF
READ_AD_OR_FD.V.FSN#
     15751**DCL     15751--REDEF   15751--REDEF
READ_AD_OR_FD.WSN_
     15717**DCL     15717--REDEF
READ_BACKUP_ERR IN PROCEDURE FLB_READ_BACKUP
     28217**LABEL   28121--CALLALT 28129--CALLALT 28136--CALLALT 28139--CALLALT 28147--CALLALT 28149--CALLALT
     28158--CALLALT 28167--GOTO    28168--CALLALT 28169--CALLALT 28185--CALLALT 28195--CALLALT 28198--CALLALT
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:626  
     28207--GOTO    28208--CALLALT 28209--CALLALT 28212--CALLALT
READ_BACKUP_ERR10 IN PROCEDURE FLB_READ_BACKUP
     28219**LABEL   28115--GOTO    28154--GOTO    28181--GOTO
READ_BACKUP_TEMP
     24251**DCL     25228<>CALL    25236<>CALL
READ_BACKUP_TEMP.STATION_
     24254**DCL     24255--REDEF
READ_BACKUP_TEMP.V
     24255**DCL     24251--DCLINIT
READ_BACKUP_TEMP.V.DVBYTE.REREAD#
     24266**DCL     24266--REDEF
READ_BACKUP_TEMP.V.INDX#
     24264**DCL     24264--REDEF
READ_BACKUP_TEMP.V.KEYS#
     24256**DCL     25227<<ASSIGN
READ_LOOP IN PROCEDURE FLB_READ_BACKUP
     28163**LABEL   28170--EXIT
READ_LOOP5 IN PROCEDURE FLB_READ_BACKUP
     28203**LABEL   28210--EXIT
READ_NODATA_LIST.STATION_
     17675**DCL     17676--REDEF
READ_NODATA_LIST.V.DVBYTE.REREAD#
     17687**DCL     17687--REDEF
READ_NODATA_LIST.V.INDX#
     17685**DCL     17685--REDEF
READ_PRIME_DUAL.STATION_
     17040**DCL     17041--REDEF
READ_PRIME_DUAL.V.DVBYTE.REREAD#
     17052**DCL     17052--REDEF
READ_PRIME_DUAL.V.INDX#
     17050**DCL     17050--REDEF
READ_REBUILD
     17343**DCL     25182<>CALL
READ_REBUILD.KEY_
     17343**DCL     25181<<ASSIGN  25218<<ASSIGN
READ_REBUILD.STATION_
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:627  
     17346**DCL     17347--REDEF
READ_REBUILD.V.DVBYTE.REREAD#
     17358**DCL     17358--REDEF
READ_REBUILD.V.INDX#
     17356**DCL     17356--REDEF
READ_STATUS
     16558**DCL     28164<>CALL    28204<>CALL
READ_STATUS.STATION_
     16561**DCL     16562--REDEF
READ_STATUS.V.DVBYTE.REREAD#
     16573**DCL     16573--REDEF
READ_STATUS.V.INDX#
     16571**DCL     16571--REDEF
READ_STATUS.V.KEYS#
     16563**DCL     28160<<ASSIGN  28200<<ASSIGN
READ_TSN_USED.STATION_
     16271**DCL     16272--REDEF
READ_TSN_USED.V.DVBYTE.REREAD#
     16283**DCL     16283--REDEF
READ_TSN_USED.V.INDX#
     16281**DCL     16281--REDEF
REBUILD_BUF.DEN
     17462**DCL     25190>>ASSIGN
REBUILD_BUF.DIR
     17462**DCL     25193>>ASSIGN
REBUILD_BUF.FSN
     17462**DCL     25188>>ASSIGN  25189>>ASSIGN
REBUILD_BUF.IOERRORC
     17462**DCL     25191>>ASSIGN  25194>>ASSIGN
REBUILD_BUF.PAD
     17462**DCL     25192>>ASSIGN
REBUILD_BUF.START.ACCT.ACCT#
     17461**DCL     25184>>ASSIGN
REBUILD_BUF.START.FILE.L#
     17461**DCL     25185>>ASSIGN
REBUILD_BUF.START.FILE.NAME#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:628  
     17461**DCL     25186>>ASSIGN
REBUILD_BUF.VOLUME
     17462**DCL     25187>>ASSIGN
REBUILD_DIR_KEY
     17432**DCL     25218--ASSIGN
REBUILD_DIR_KEY.L#
     17432**DCL     17432--IMP-SIZ 25218>>ASSIGN
REBUILD_ERR IN PROCEDURE FLB_TAPE_NODES
     25320**LABEL   25182--CALLALT 25205--CALLALT 25206--CALLALT 25209--GOTO    25213--CALLALT 25215--CALLALT
     25226--CALLALT 25228--CALLALT 25236--CALLALT 25295--CALLALT 25310--CALLALT 25315--CALLALT
REBUILD_ERR10 IN PROCEDURE FLB_TAPE_NODES
     25322**LABEL   25167--CALLALT
REBUILD_KEY
     17459**DCL     25181--ASSIGN
REBUILD_KEY.L#
     17459**DCL     17459--IMP-SIZ 25181>>ASSIGN
REBUILD_NAME.L#
     17280**DCL     17280--IMP-SIZ
REBUILD_SN.SN#
     17293**DCL     25205<>CALL    26304<<ASSIGN
RESTORE_FROM_TAPE
     21539**DCL     25710<<ASSIGN  25999<<ASSIGN  26003<<ASSIGN  26097<<ASSIGN
RET_CMDS_FNAME
     23603**DCL     23675--DCLINIT
RET_CMDS_NAME.L#
     15178**DCL     15178--IMP-SIZ
RET_CMDS_OPEN
     23674**DCL     25372<>CALL
RET_CMDS_OPEN.ACSVEH_
     23676**DCL     23677--REDEF
RET_CMDS_OPEN.ALTKEYS_
     23682**DCL     23683--REDEF   23683--REDEF
RET_CMDS_OPEN.HDR_
     23681**DCL     23682--REDEF
RET_CMDS_OPEN.TAB_
     23680**DCL     23681--REDEF
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:629  
RET_CMDS_OPEN.UHL_
     23674**DCL     23675--REDEF   23675--REDEF
RET_CMDS_OPEN.V
     23683**DCL     23674--DCLINIT
RET_CMDS_OPEN.V.FSN#
     23714**DCL     23714--REDEF   23714--REDEF
RET_CMDS_OPEN.WSN_
     23680**DCL     23680--REDEF
SAVE_TAPE_OPEN.ACSVEH_
     23917**DCL     23918--REDEF
SAVE_TAPE_OPEN.ALTKEYS_
     23923**DCL     23924--REDEF   23924--REDEF
SAVE_TAPE_OPEN.HDR_
     23922**DCL     23923--REDEF
SAVE_TAPE_OPEN.TAB_
     23921**DCL     23922--REDEF
SAVE_TAPE_OPEN.UHL_
     23915**DCL     23916--REDEF   23916--REDEF
SAVE_TAPE_OPEN.V
     23924**DCL     23915--DCLINIT 25828<<ASSIGN  25847>>ASSIGN
SAVE_TAPE_OPEN.V.FSN#
     23955**DCL     23955--REDEF   23955--REDEF
SAVE_TAPE_OPEN.WSN_
     23921**DCL     23921--REDEF
SKIP_SPECIFIED
     21669**DCL     26212<<ASSIGN  26430<<ASSIGN  27454>>IF      27526>>IF
SKIP_START IN PROCEDURE FLB_ORDER_RANGE
     27435**DCL     27542>>IF      27547>>IF      27554>>IF      27558<>CALL    27561>>ASSIGN  27562<<ASSIGN
     27575<>CALL    27576>>ASSIGN
SKIP_START$ IN PROCEDURE FLB_ORDER_RANGE
     27424**DCL     27435--IMP-PTR 27540<<ASSIGN  27542>>IF      27547>>IF      27554>>IF      27558>>CALL
     27561>>ASSIGN  27562>>ASSIGN  27575>>CALL    27576>>ASSIGN
SKIP_STOP IN PROCEDURE FLB_ORDER_RANGE
     27436**DCL     27547>>IF      27556>>IF      27559<>CALL    27562>>ASSIGN  27563<<ASSIGN  27581>>IF
     27583<>CALL    27584>>ASSIGN
SKIP_STOP$ IN PROCEDURE FLB_ORDER_RANGE
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:630  
     27425**DCL     27436--IMP-PTR 27546<<ASSIGN  27547>>IF      27556>>IF      27559>>CALL    27562>>ASSIGN
     27563>>ASSIGN  27581>>IF      27583>>CALL    27584>>ASSIGN
SNLIST.NUM# IN PROCEDURE FLB_BUILD_SNLIST
     27959**DCL     27967<<ASSIGN  27973>>DOINDEX 27982>>DOINDEX
SNLIST.SN# IN PROCEDURE FLB_BUILD_SNLIST
     27959**DCL     27975<<ASSIGN  27984<<ASSIGN
SNLIST$ IN PROCEDURE FLB_BUILD_SNLIST
     27932**DCL     27959--IMP-PTR 27966<>CALL    27967>>ASSIGN  27973>>DOINDEX 27975>>ASSIGN  27982>>DOINDEX
     27984>>ASSIGN  27990>>ASSIGN
SNLISTINFO
     21835**DCL     27989--CALL
SNLISTINFO.PREVINFO$
     21835**DCL     27991<<ASSIGN
SNLISTINFO.SNLIST$
     21835**DCL     25051>>ASSIGN  25246>>IF      25277>>ASSIGN  25611>>IF      25636>>ASSIGN  25714>>ASSIGN
     26068>>ASSIGN  27990<<ASSIGN
SNLISTINFO$ IN PROCEDURE FLB_BUILD_SNLIST
     27933**DCL     27989<>CALL    27990>>ASSIGN  27991>>ASSIGN  27992>>ASSIGN
SNLIST_NBR
     16078**DCL     24454<<ASSIGN
SNSIZE IN PROCEDURE FLB_BUILD_SNLIST
     27931**DCL     27964<<ASSIGN  27966<>CALL
SNVECLIST$
     14710**DCL     14710--IMP-PTR
SOURCE_DCB$ IN PROCEDURE FLB_READ_BACKUP
     28007**DCL     28097<>CALL    28112>>IF
SOURCE_TAPE_SNLIST$
     21645**DCL     25051<<ASSIGN  25052>>ASSIGN  25053>>ASSIGN  25132<>CALL    25136<>CALL    25246>>IF
     25264>>IF      25277<<ASSIGN  25278>>ASSIGN  25279>>ASSIGN  25714<<ASSIGN  25715>>ASSIGN  25716>>ASSIGN
     26034<<ASSIGN  26068<<ASSIGN  26069>>ASSIGN  26070>>ASSIGN
SPEC.START
     14774**DCL     14775--REDEF
SPEC.STOP
     14775**DCL     14776--REDEF
SPEC IN PROCEDURE FLB_NEXT_SPEC
     27626**DCL     27621--PROC
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:631  
SPEC.ACCT# IN PROCEDURE FLB_NEXT_SPEC
     27627**DCL     27628--REDEF   27648--ASSIGN  27653<>CALL    27653--CALL
SPEC.ACCTB IN PROCEDURE FLB_NEXT_SPEC
     27628**DCL     27649>>DOWHILE
SPEC.FILE IN PROCEDURE FLB_NEXT_SPEC
     27629**DCL     27642<>CALL
SPEC.FILE.L# IN PROCEDURE FLB_NEXT_SPEC
     27631**DCL     27641>>ASSIGN  27644<<ASSIGN  27647<<ASSIGN
SPEC.FILE.NAME# IN PROCEDURE FLB_NEXT_SPEC
     27630**DCL     27642--CALL
SPEC IN PROCEDURE FLB_PREV_SPEC
     27668**DCL     27663--PROC
SPEC.ACCT# IN PROCEDURE FLB_PREV_SPEC
     27669**DCL     27670--REDEF   27690--ASSIGN  27695<>CALL    27695--CALL
SPEC.ACCTB IN PROCEDURE FLB_PREV_SPEC
     27670**DCL     27691>>DOWHILE
SPEC.FILE IN PROCEDURE FLB_PREV_SPEC
     27671**DCL     27684<>CALL
SPEC.FILE.L# IN PROCEDURE FLB_PREV_SPEC
     27673**DCL     27683>>ASSIGN  27686<<ASSIGN  27689<<ASSIGN
SPEC.FILE.NAME# IN PROCEDURE FLB_PREV_SPEC
     27672**DCL     27684--CALL
SPECCHARS
     14774**DCL     14774--REDEF   27566<<ASSIGN  27570>>ASSIGN  27808<<ASSIGN  27810>>ASSIGN
SRCH_BIT
     21698**DCL     24460<<ASSIGN  26984<<ASSIGN  26984>>ASSIGN  26989<<ASSIGN  26989>>ASSIGN  26995<<ASSIGN
     26995>>ASSIGN  26996<<ASSIGN  26996>>ASSIGN
SRCH_BIT.ARCHIVE
     21701**DCL     27004>>IF
SRCH_BIT.DELF
     21699**DCL     27002>>IF
SRCH_BIT.QS
     21700**DCL     27003>>IF
STAF
     14897**DCL     24684<<ASSIGN  24690<<ASSIGN
START_ACCT
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:632  
     22381**DCL     26457<<ASSIGN  26464>>ASSIGN  27267>>ASSIGN  27309<<ASSIGN  27315<<ASSIGN  27323<<ASSIGN
     27330<<ASSIGN  27342<<ASSIGN  27353>>IF      27353>>IF      27471<<ASSIGN
START_ACCT.ACCT#
     22381**DCL     25781>>IF      26458>>ASSIGN  26461<<ASSIGN
START_FILE
     22365**DCL     26478>>ASSIGN  27268>>ASSIGN  27310<<ASSIGN  27316<<ASSIGN  27324<<ASSIGN  27331<<ASSIGN
     27343<<ASSIGN  27350>>IF      27351<<ASSIGN  27353>>IF      27472<<ASSIGN
START_FILE.L#
     22367**DCL     26477<<ASSIGN
START_FILE.NAME#
     22366**DCL     26476<<ASSIGN
START_UTS
     14755**DCL     25910<<ASSIGN
STATE
     21685**DCL     25700<<ASSIGN  25702<<ASSIGN  25709<<ASSIGN  25812<>CALL
STATUS_KEY
     16079**DCL     24251--DCLINIT 24252--DCLINIT 24294--DCLINIT 28174--IF
STATUS_KEY.L
     16079**DCL     28174>>IF
STATUS_KEY.RUN_NBR
     16080**DCL     28174>>IF
STATUS_KEY.TSN_SET_NBR
     16080**DCL     28174>>IF
STATUS_KEY.TSN_VOL
     16080**DCL     27964>>ASSIGN  27967>>ASSIGN  28174>>IF
STOP_ACCT
     22400**DCL     26464<<ASSIGN  27269>>ASSIGN  27311<<ASSIGN  27318<<ASSIGN  27325<<ASSIGN  27332<<ASSIGN
     27345<<ASSIGN  27353>>IF      27353>>IF      27473<<ASSIGN
STOP_ACCT.ACCT#
     22400**DCL     25781>>IF
STOP_FILE
     22384**DCL     26478<<ASSIGN  27270>>ASSIGN  27312<<ASSIGN  27319<<ASSIGN  27326<<ASSIGN  27337<<ASSIGN
     27338<<ASSIGN  27346<<ASSIGN  27353>>IF      27474<<ASSIGN
SUBNODE$
     21646**DCL     24832<<ASSIGN  24833>>DOCASE  24853>>ASSIGN  24853>>ASSIGN  25087<<ASSIGN  25088>>DOCASE
     25090>>DOINDEX 25091>>ASSIGN  25424<<ASSIGN  25425>>ASSIGN  25425>>ASSIGN  25876<<ASSIGN  25878>>DOCASE
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:633  
     25961<<ASSIGN  25962>>DOCASE  25964>>ASSIGN  25966>>ASSIGN  26036<<ASSIGN  26038>>DOCASE  26045>>IF
     26047>>ASSIGN  26077>>IF      26079>>CALL    26084<>CALL    26161<<ASSIGN  26163>>DOCASE  26166>>ASSIGN
     26236<<ASSIGN  26238>>DOCASE  26241>>DOCASE  26259>>DOINDEX 26260>>ASSIGN  26287>>ASSIGN  26352<<ASSIGN
     26354>>DOCASE  26357>>ASSIGN  26370>>ASSIGN  26415>>DOINDEX 26416>>ASSIGN  26719>>DOINDEX 26720>>ASSIGN
     27845<<ASSIGN  27847>>DOCASE  27850<>CALL    28086<<ASSIGN  28087>>DOCASE  28146>>ASSIGN  28146>>ASSIGN
SUBNODE$ IN PROCEDURE FLB_REBUILD_OPTION_LIST
     26104**DCL     26102--PROC    26108>>DOINDEX 26109>>ASSIGN
SUBNODEX
     21647**DCL     24831<<DOINDEX 24832>>ASSIGN  25086<<DOINDEX 25087>>ASSIGN  25875<<DOINDEX 25876>>ASSIGN
     25960<<DOINDEX 25961>>ASSIGN  26035<<DOINDEX 26036>>ASSIGN  26160<<DOINDEX 26161>>ASSIGN  26235<<DOINDEX
     26236>>ASSIGN  26287>>ASSIGN  26351<<DOINDEX 26352>>ASSIGN  27844<<DOINDEX 27845>>ASSIGN
SUBNODEX IN PROCEDURE FLB_REBUILD_OPTION_LIST
     26106**DCL     26108<<DOINDEX 26109>>ASSIGN
SUBNODEY IN PROCEDURE FLB_DISK_SPEC
     26342**DCL     26337--PROC    26351>>DOINDEX
SUBNODEY IN PROCEDURE FLB_STOW_FETCH_NODES
     25415**DCL     25420<<ASSIGN  25422<<DOINDEX 25424>>ASSIGN  25430<>CALL
SUBSUBNODE$
     21648**DCL     25091<<ASSIGN  25092>>DOCASE  26166<<ASSIGN  26168>>DOCASE  26172>>DOINDEX 26173>>ASSIGN
     26260<<ASSIGN  26262>>DOCASE  26265>>DOINDEX 26266>>IF      26268>>CALLBLT 26268>>CALLBLT 26268>>CALLBLT
     26271>>IF      26271>>IF      26277>>ASSIGN  26277>>ASSIGN  26281>>ASSIGN  26281>>ASSIGN  26283>>ASSIGN
     26287<<ASSIGN  26288>>DOINDEX 26289>>IF      26291>>CALLBLT 26291>>CALLBLT 26291>>CALLBLT 26294>>IF
     26294>>IF      26300>>ASSIGN  26300>>ASSIGN  26370<<ASSIGN  26371>>IF      26372>>ASSIGN  26372>>ASSIGN
     26374>>DOINDEX 26375>>IF      26377>>CALLBLT 26377>>CALLBLT 26377>>CALLBLT 26380>>IF      26380>>IF
     26386>>ASSIGN  26386>>ASSIGN  26416<<ASSIGN  26418>>DOCASE  26421<>CALL    26426>>DOINDEX 26427>>CALL
     26720<<ASSIGN  26721>>DOCASE  26725>>ASSIGN  26789>>IF      26859>>DOINDEX 26860>>DOCASE  26876>>ASSIGN
     26885>>CALLBLT 26885>>CALLBLT 26889>>ASSIGN  27072>>DOINDEX 27073>>ASSIGN
SUBSUBNODE$ IN PROCEDURE FLB_REBUILD_OPTION_LIST
     26105**DCL     26109<<ASSIGN  26111>>DOCASE  26113>>ASSIGN  26117>>CALLBLT 26117>>CALLBLT 26121>>CALLBLT
     26121>>CALLBLT 26123>>IF      26125>>CALLBLT 26125>>CALLBLT
SUBSUBNODEX
     21649**DCL     25090<<DOINDEX 25091>>ASSIGN  26172<<DOINDEX 26173>>ASSIGN  26259<<DOINDEX 26260>>ASSIGN
     26265<<DOINDEX 26266>>IF      26268>>CALLBLT 26268>>CALLBLT 26268>>CALLBLT 26271>>IF      26271>>IF
     26277>>ASSIGN  26277>>ASSIGN  26288<<DOINDEX 26289>>IF      26291>>CALLBLT 26291>>CALLBLT 26291>>CALLBLT
     26294>>IF      26294>>IF      26300>>ASSIGN  26300>>ASSIGN  26374<<DOINDEX 26375>>IF      26377>>CALLBLT
     26377>>CALLBLT 26377>>CALLBLT 26380>>IF      26380>>IF      26386>>ASSIGN  26386>>ASSIGN  26415<<DOINDEX
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:634  
     26416>>ASSIGN  26719<<DOINDEX 26720>>ASSIGN
SUBSUBSUBNODEX
     21650**DCL     26859<<DOINDEX 26860>>DOCASE
SUB_COMMAND
     21688**DCL     25752<<ASSIGN  25753>>DOCASE
SWITCH_FMEFT.V
     22821**DCL     22821--DCLINIT
SWITCH_FMSEC
     22804**DCL     24381<>CALL    24431<>CALL    24510<>CALL    24517<>CALL    24523<>CALL    24529<>CALL
     24535<>CALL    24541<>CALL    24547<>CALL    24553<>CALL    24559<>CALL    24566<>CALL    24573<>CALL
     24580<>CALL    24587<>CALL    24594<>CALL    24600<>CALL    24606<>CALL    24612<>CALL    24618<>CALL
     24623<>CALL    24629<>CALL    24635<>CALL    24640<>CALL    24645<>CALL    24651<>CALL    24657<>CALL
     24663<>CALL    24669<>CALL    24676<>CALL    24683<>CALL    24689<>CALL    24695<>CALL    24868<>CALL
     24871<>CALL    24888<>CALL    24949<>CALL    24952<>CALL    24958<>CALL
SWITCH_FMSEC.V
     22804**DCL     22804--DCLINIT
TAPE_BLOCK_.W2
     15999**DCL     16000--REDEF
TAPE_CLOSE
     14627**DCL     28139<>CALL    28220<>CALL
TAPE_CLOSE.SN_
     14627**DCL     14627--REDEF
TAPE_CLOSE.UTL_
     14628**DCL     14628--REDEF
TAPE_CLOSE.V.EXPIRE#
     14642**DCL     14642--REDEF
TAPE_CLOSE.V.TYPE#
     14640**DCL     14640--REDEF
TAPE_CLOSE.V.XTNSIZE#
     14637**DCL     14637--REDEF   14639--REDEF
TAPE_DCBLIST.DCB$
     14183**DCL     25829>>IF      25830>>ASSIGN  25886>>ASSIGN
TAPE_DCBLIST$
     14183**DCL     14183--IMP-PTR 25829>>IF      25830>>ASSIGN  25881>>IF      25886>>ASSIGN
TAPE_DENSITY IN PROCEDURE FLB_TAPE_NODES
     24977**DCL     25219<<ASSIGN  25255<>CALL    25268<>CALL    25273<>CALL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:635  
TAPE_FSN IN PROCEDURE FLB_TAPE_NODES
     24976**DCL     25168<<ASSIGN  25189<<ASSIGN  25254<<ASSIGN  25255<>CALL    25267<<ASSIGN  25268<>CALL
     25272<<ASSIGN  25273<>CALL
TAPE_IOERROK IN PROCEDURE FLB_TAPE_NODES
     24978**DCL     25220<<ASSIGN  25255<>CALL    25268<>CALL    25273<>CALL
TAPE_OPEN
     14490**DCL     25146<>CALL
TAPE_OPEN.ACSVEH_
     14492**DCL     14493--REDEF
TAPE_OPEN.ALTKEYS_
     14498**DCL     14499--REDEF   14499--REDEF
TAPE_OPEN.FPARAM_
     14495**DCL     27907<<ASSIGN
TAPE_OPEN.HDR_
     14497**DCL     14498--REDEF
TAPE_OPEN.IFPARAM_
     14495**DCL     27906<<ASSIGN
TAPE_OPEN.NAME_
     14491**DCL     27904<<ASSIGN
TAPE_OPEN.SN_
     14490**DCL     25055<<ASSIGN  25079<<ASSIGN  25281<<ASSIGN  25718<<ASSIGN  25836<<ASSIGN  26072<<ASSIGN
TAPE_OPEN.TAB_
     14496**DCL     14497--REDEF
TAPE_OPEN.UHL_
     14490**DCL     14491--REDEF   14491--REDEF
TAPE_OPEN.V
     14499**DCL     25828>>ASSIGN  25847<<ASSIGN
TAPE_OPEN.V.BLKL#
     14516**DCL     27909<<ASSIGN
TAPE_OPEN.V.CVOL#
     14504**DCL     27913<<ASSIGN
TAPE_OPEN.V.DCB#
     14499**DCL     25141<<ASSIGN
TAPE_OPEN.V.DENSITY#
     14531**DCL     25190<<ASSIGN  25219>>ASSIGN  26113<<ASSIGN  27889<<ASSIGN  27890<<ASSIGN
TAPE_OPEN.V.EXPIRE#
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:636  
     14519**DCL     27891<<ASSIGN
TAPE_OPEN.V.FSN#
     14530**DCL     14530--REDEF   14530--REDEF   25188<<ASSIGN  26122<<ASSIGN  26126>>IF      27895<<ASSIGN
     27896<<ASSIGN
TAPE_OPEN.V.FUN#
     14509**DCL     27912<<ASSIGN
TAPE_OPEN.V.INITZ.SCRUB#
     14500**DCL     25155<<ASSIGN  27905<<ASSIGN
TAPE_OPEN.V.IOERROK#
     14521**DCL     25095<<ASSIGN  25098<<ASSIGN  25191<<ASSIGN  25220>>ASSIGN  26140<<ASSIGN  26144<<ASSIGN
     26894<<ASSIGN  26899<<ASSIGN  27902<<ASSIGN  27903<<ASSIGN  28104>>IF      28104>>IF
TAPE_OPEN.V.OPER.MNTONLY#
     14503**DCL     25140<<ASSIGN  27887<<ASSIGN
TAPE_OPEN.V.RES#
     14514**DCL     27897<<ASSIGN
TAPE_OPEN.V.VOL#
     14524**DCL     25187<<ASSIGN  25848<<ASSIGN  26118<<ASSIGN  27908<<ASSIGN
TAPE_OPEN.V.VOLACCESS#
     14528**DCL     27893<<ASSIGN
TAPE_OPEN.V.XTEND#
     14520**DCL     25602>>IF      25613<<ASSIGN  25707<<ASSIGN  27892<<ASSIGN
TAPE_OPEN.WSN_
     14496**DCL     14496--REDEF
TAPE_OPTION
     14894**DCL     24452<<ASSIGN
TAPE_OPTION.CHECK
     14894**DCL     25728>>ASSIGN  25729<<ASSIGN  25840<<ASSIGN  25849<<ASSIGN  26845<<ASSIGN  26849<<ASSIGN
TAPE_OPTION.CHECK_SPECD
     14894**DCL     26844<<ASSIGN  26848<<ASSIGN
TAPE_OPTION.DENSITY
     14894**DCL     26114<<ASSIGN
TAPE_OPTION.IOERRORC
     14895**DCL     25094<<ASSIGN  25097<<ASSIGN  25194<<ASSIGN  26139<<ASSIGN  26143<<ASSIGN  26892<<ASSIGN
     26897<<ASSIGN
TAPE_OPTION.IOERRORC_SPECD
     14895**DCL     26893<<ASSIGN  26898<<ASSIGN
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:637  
TAPE_OPTION.NPAD
     14895**DCL     26136<<ASSIGN  26600>>IF
TAPE_OPTION.OPEN_FUNCTION
     14895**DCL     25711<<ASSIGN
TAPE_OPTION.PROTTYPE
     14894**DCL     25160<<ASSIGN  25522<<ASSIGN  25766>>IF      26176<<ASSIGN  26256<<ASSIGN  26283<<ASSIGN
     26594>>IF      26596<<ASSIGN  26889<<ASSIGN
TAPE_READ.STATION_
     14554**DCL     14555--REDEF
TAPE_READ.V.DVBYTE.REREAD#
     14566**DCL     14566--REDEF
TAPE_READ.V.INDX#
     14564**DCL     14564--REDEF
TAPE_REWIND
     14657**DCL     28141<>CALL
TAPE_REWIND.V.PSN#
     14658**DCL     28140<<ASSIGN
TAPE_WRITE.STATION_
     14592**DCL     14592--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
     14599**DCL     14599--REDEF
TELL_ERROR
     24707**LABEL   24442--CALLALT 24444--CALLALT
TELL_ERROR IN PROCEDURE FLB_OPEN_NODES
     25921**LABEL   25745--CALLALT
TEMP
     21651**DCL     24441<<ASSIGN  24442<>CALL    26117<<CALLBLT 26118>>ASSIGN  26121<<CALLBLT 26122>>ASSIGN
     26124>>ASSIGN  26307<<ASSIGN  26308<<ASSIGN  26308>>ASSIGN  26309<>CALL    26313<<ASSIGN  26314<<ASSIGN
     26314>>ASSIGN  26315<>CALL    26358<<ASSIGN  26359<<ASSIGN  26359>>ASSIGN  26360<>CALL    26362<<ASSIGN
     26363<<ASSIGN  26363>>ASSIGN  26364<>CALL    26407<<ASSIGN  26411<>CALL    26441<<ASSIGN  26442<<ASSIGN
     26442>>ASSIGN  26443<>CALL    26447<<ASSIGN  26448<<ASSIGN  26448>>ASSIGN  26449<>CALL    26466<<ASSIGN
     26470<>CALL    26725<<ASSIGN  26727>>ASSIGN  26731>>IF      27087<<CALLBLT 27088>>CALL    27245<<CALLBLT
     27246>>CALLBLT 27262<<ASSIGN  27263<>CALL    27263<>CALL    27456<<ASSIGN  27460<>CALL
TEMP$
     21652**DCL     26173<<ASSIGN  26174>>DOCASE  26176>>ASSIGN  27375<<ASSIGN  27376>>IF      27381>>ASSIGN
     27381>>ASSIGN  27385>>ASSIGN  27386>>ASSIGN  27386>>ASSIGN
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:638  
TEMP$ IN PROCEDURE FLB_REBUILD_NODES
     26029**DCL     26047<<ASSIGN  26048>>DOINDEX 26049>>IF
TEMP_DISK_SRCHCOND
     14777**DCL     25534<<ASSIGN  25545>>ASSIGN  25808<<ASSIGN
TEMP_DISK_SRCHCOND.ANYF#
     14779**DCL     25838>>IF
TEMP_SPEC IN PROCEDURE FLB_ORDER_RANGE
     27426**DCL     27560<<ASSIGN  27563>>ASSIGN
TEST_GREETINGS
     21573**DCL     22778--DCLINIT 22779--DCLINIT
TEST_MODE
     15208**DCL     24399<<ASSIGN  24405<<ASSIGN
TIMENODE$ IN PROCEDURE FLB_DATE_SPEC
     27022**DCL     27101<<ASSIGN  27102>>DOINDEX 27103>>ASSIGN
TIMEX IN PROCEDURE FLB_DATE_SPEC
     27024**DCL     27102<<DOINDEX 27103>>ASSIGN  27104>>DOCASE
TIME_SPECIFIED IN PROCEDURE FLB_DATE_SPEC
     27023**DCL     27066<<ASSIGN  27086<<ASSIGN  27100<<ASSIGN  27137>>IF
TOTAL_ERRORS
     14896**DCL     25551>>IF      25551>>IF      26886<<ASSIGN
TOTAL_FILES
     14896**DCL     24450<<ASSIGN  25755<<ASSIGN  25816>>ASSIGN  25903>>IF      25908<<ASSIGN
TOTAL_GRANS
     14896**DCL     24451<<ASSIGN  25756<<ASSIGN  25817>>ASSIGN  25909<<ASSIGN
TRANS_NBR
     14895**DCL     24449<<ASSIGN  25757<<ASSIGN  25757>>ASSIGN
TSN_SET_NBR
     16077**DCL     24453<<ASSIGN  25751<<ASSIGN
TSN_USED_BUF
     16080**DCL     24253--DCLINIT 24254--DCLINIT 24295--DCLINIT 24296--DCLINIT
TSN_USED_BUF.BACKUP_FSN
     16081**DCL     25237>>IF      25238>>ASSIGN
TSN_USED_BUF.FSN
     16081**DCL     25239>>ASSIGN
TSN_USED_BUF.TSN
     16081**DCL     27968>>CALLBLT 27971>>ASSIGN  27980>>ASSIGN
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:639  
TSN_USED_BUF.UTS
     16081**DCL     25229>>ASSIGN
TSN_USED_NAME.L#
     16218**DCL     16218--IMP-SIZ
TVECTOR
     14722**DCL     25052<<ASSIGN  25055>>ASSIGN  25278<<ASSIGN  25281>>ASSIGN  25715<<ASSIGN  25718>>ASSIGN
     26069<<ASSIGN  26072>>ASSIGN
TVECTOR.W1.VSIZE#
     14722**DCL     25053<<ASSIGN  25279<<ASSIGN  25716<<ASSIGN  26070<<ASSIGN
TVECTOR.W2
     14723**DCL     14724--REDEF
T_DENSITY IN PROCEDURE FLB_SET_TAPE_DEFAULTS
     27873**DCL     27869--PROC    27888--IF      27890>>ASSIGN
T_FSN IN PROCEDURE FLB_SET_TAPE_DEFAULTS
     27874**DCL     27869--PROC    27894--IF      27896>>ASSIGN
T_IOERROK IN PROCEDURE FLB_SET_TAPE_DEFAULTS
     27876**DCL     27869--PROC    27901--IF      27903>>ASSIGN
USE_ANSDATE IN PROCEDURE FLB_DATE_SPEC
     27030**DCL     27068<<ASSIGN  27091<<ASSIGN  27171>>IF
VLP_ERRCODE
     22312**DCL     26504<<ASSIGN  26506<<ASSIGN  26508<<ASSIGN  26510<<ASSIGN  26512<<ASSIGN  26514<>CALL
     27189<<ASSIGN  27191<<ASSIGN  27193<<ASSIGN  27195<<ASSIGN  27197<<ASSIGN  27199<>CALL    27211<<ASSIGN
     27213<<ASSIGN  27215<<ASSIGN  27217<<ASSIGN  27219<<ASSIGN  27221<>CALL
VLP_SN
     21832**DCL     25052--ASSIGN  25278--ASSIGN  25715--ASSIGN  26069--ASSIGN
VLP_SN.NUM#
     21832**DCL     25053>>ASSIGN  25053--ASSIGN  25279>>ASSIGN  25279--ASSIGN  25716>>ASSIGN  25716--ASSIGN
     26070>>ASSIGN  26070--ASSIGN  27964--ASSIGN
VLP_SN.SN#
     21832**DCL     25053--ASSIGN  25246>>IF      25279--ASSIGN  25611>>IF      25636>>ASSIGN  25716--ASSIGN
     26070--ASSIGN  27964--ASSIGN
WHAT_DATE IN PROCEDURE FLB_DATE_SPEC
     27028**DCL     27064<<ASSIGN  27080<<ASSIGN  27181>>ASSIGN  27184>>CALL    27185>>IF      27187>>DOCASE
     27202>>ASSIGN  27206>>CALL    27207>>IF      27209>>DOCASE  27224>>ASSIGN  27229>>DOCASE
WRITE_BACKUP_TEMP
     24294**DCL     28185<>CALL    28212<>CALL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:640  
WRITE_BACKUP_TEMP.STATION_
     24296**DCL     24296--REDEF
WRITE_BACKUP_TEMP.V
     24297**DCL     24294--DCLINIT
WRITE_BACKUP_TEMP.V.DVBYTE.VFC#
     24303**DCL     24303--REDEF
WRITE_NODATA_LIST.STATION_
     17713**DCL     17713--REDEF
WRITE_NODATA_LIST.V.DVBYTE.VFC#
     17720**DCL     17720--REDEF
WRITE_PRIME_DUAL.STATION_
     17078**DCL     17078--REDEF
WRITE_PRIME_DUAL.V.DVBYTE.VFC#
     17085**DCL     17085--REDEF
WRITE_REBUILD.STATION_
     17314**DCL     17314--REDEF
WRITE_REBUILD.V.DVBYTE.VFC#
     17321**DCL     17321--REDEF
WRITE_STATUS.STATION_
     16529**DCL     16529--REDEF
WRITE_STATUS.V.DVBYTE.VFC#
     16536**DCL     16536--REDEF
WRITE_TSN_USED.STATION_
     16239**DCL     16239--REDEF
WRITE_TSN_USED.V.DVBYTE.VFC#
     16246**DCL     16246--REDEF
XTX$ADAPT
     22153**DCL-ENT 22232--DCLINIT
XUD$UTS_ADJUST
     21499**DCL-ENT 27088--CALL    27184--CALL    27206--CALL
XUH_PARAM
     22257**DCL     24495<>CALL    24499<>CALL    24503<>CALL    25864<>CALL    25868<>CALL    25872<>CALL
XUH_PARAM.HELP$
     22267**DCL     24494<<ASSIGN  25863<<ASSIGN
XUR$ALLMSG
     18242**DCL-ENT 24503--CALL    25872--CALL
PL6.E3A0      #001=FLB$EFT File=FLB$EFT.:E05TSI                                  TUE 07/29/97 15:33 Page:641  
XUR$ECHOIF
     18225**DCL-ENT 24445--CALL    24715--CALL    25746--CALL    25924--CALL
XUR$ERRMSG
     18231**DCL-ENT 24726--CALL    24731--CALL    25933--CALL    25938--CALL
XUR$ERRPTR
     18224**DCL-ENT 24721--CALL    25928--CALL
XUR$GETCMD
     18223**DCL-ENT 24442--CALL    24444--CALL    25745--CALL
XUR$HELP
     18240**DCL-ENT 24495--CALL    25864--CALL
XUR$INIT
     18228**DCL-ENT 24362--CALL
XUR$MOREMSG
     18241**DCL-ENT 24499--CALL    25868--CALL
XUR$SETDCBS
     18227**DCL-ENT 24748--CALL    24953--CALL    24961--CALL    25378--CALL    25942--CALL
XUR$SETERRMSG
     18233**DCL-ENT 24363--CALL
XUR_INIT
     22158**DCL     24362<>CALL
XUR_INIT.WORKR_
     22172**DCL     22173--REDEF
ZERO
     14726**DCL     25441--ASSIGN  26201--ASSIGN  26202--ASSIGN  26541--IF

PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:642  
     4217        1        /*T***********************************************************/
     4218        2        /*T*                                                         */
     4219        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     4220        4        /*T*                                                         */
     4221        5        /*T***********************************************************/
     4222        6        FLB$EFT_BRK: PROC ASYNC;
     4223        7        /*F*  NAME: FLB$EFT_BRK
     4224        8              PURPOSE: Break handling routine.
     4225        9        */
     4226       10
     4227       11         /***
     4228       12          *** INCLUDE
     4229       13          ***/
     4230       14
     4231       15        %INCLUDE CP_6;
     4232     5574        %INCLUDE FLI_DATA_R;
     4233     6988        %INCLUDE XUD_UTS_M;
     4234     7070
     4235     7071         /***
     4236     7072          *** DCB
     4237     7073          ***/
     4238     7074
     4239     7075    1   DCL M$ME DCB;
     4240     7076
     4241     7077        /***
     4242     7078         *** ENTRY
     4243     7079         ***/
     4244     7080
     4245     7081    1   DCL FLI$RPT_ERR ENTRY(5);
     4246     7082        %XUD$UTS_ENTRIES;
     4247     7114
     4248     7115         /***
     4249     7116          *** SYMREF
     4250     7117          ***/
     4251     7118
     4252     7119    1   DCL BREAK_CONTINUED BIT(1) SYMREF;
     4253     7120    1   DCL BREAK_COUNT SBIN SYMREF;
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:643  
     4254     7121    1   DCL BREAK_DCB# SBIN SYMREF;
     4255     7122    1   DCL BREAK_TASK CHAR(18) SYMREF;
     4256     7123
     4257     7124         /***
     4258     7125          *** STATIC
     4259     7126          ***/
     4260     7127
     4261     7128    1   DCL NBR_BREAK_TASK_CHARS SBIN STATIC;
     4262     7129    1   DCL NBR_UNFIDCHARS SBIN STATIC;
     4263     7130    1   DCL BRK_MSG CHAR(100) STATIC;
     4264     7131    1   DCL UNFIDCHARS CHAR(50) STATIC;
     4265     7132    1   DCL ANSWER CHAR(4) STATIC;
     4266     7133    1   DCL BREAK_DURING_BREAK BIT(1) STATIC INIT('0'B);
     4267     7134    1   DCL BREAK_UTS UBIN WORD STATIC;
     4268     7135    1   DCL X_TO_ABORT BIT(1) STATIC;
     4269     7136
     4270     7137        /***
     4271     7138         *** CONSTANT
     4272     7139         ***/
     4273     7140
     4274     7141    1   DCL X_PROMPT CHAR(1) CONSTANT INIT('-');
     4275     7142    1   DCL ASTERISK CHAR(0) CONSTANT INIT('*');
     4276     7143
     4277     7144        /***
     4278     7145         *** AUTO
     4279     7146         ***/
     4280     7147
     4281     7148    1   DCL TEMP_CENTISECS SBIN AUTO;
     4282     7149
     4283     7150         /***
     4284     7151          *** FPT
     4285     7152          ***/
     4286     7153
     4287     7154        %FPT_TRMPRG(FPTN = FPT_TRMPRG,
     4288     7155                    RSTBRK = YES,
     4289     7156                    STCLASS=CONSTANT );
     4290     7185
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:644  
     4291     7186        %FPT_READ( FPTN=GET_ANSWER,
     4292     7187                   DCB=M$ME,
     4293     7188                   BUF=ANSWER );
     4294     7227
     4295     7228        %FPT_UNFID( FPTN=BREAK_FILE,
     4296     7229                    TEXTFID=UNFIDCHARS );
     4297     7247
     4298     7248        %FPT_WRITE( FPTN=TELL_BREAK,
     4299     7249                    DCB=M$ME,
     4300     7250                    BUF=BRK_MSG,
     4301     7251                    VFC=YES );
     4302     7282
     4303     7283        %FPT_PROMPT( FPTN=SET_X_PROMPT,
     4304     7284                     PROMPT=X_PROMPT );
     4305     7312
     4306     7313        %FPT_PROMPT( FPTN=SET_PROMPT,
     4307     7314                     PROMPT=ASTERISK );
     4308     7342
     4309     7343        /****************************************/
     4310     7344
     4311     7345    2      DO INHIBIT;
     4312     7346    2         IF BREAK_DURING_BREAK
     4313     7347    3          THEN DO;
     4314     7348    3            X_TO_ABORT = '1'B;
     4315     7349    3            CALL M$CLRSTK
     4316     7350    4             WHENALTRETURN DO;
     4317     7351    4               CALL FLI$RPT_ERR;
     4318     7352    4               CALL M$EXIT;
     4319     7353    4               END;
     4320     7354    3            END;
     4321     7355    3          ELSE DO;
     4322     7356    3            BREAK_DURING_BREAK = '1'B;
     4323     7357    3            X_TO_ABORT = '0'B;
     4324     7358    3            CALL M$TIME( GET_NOW_UTS );
     4325     7359    3            BREAK_UTS = NOW_UTS;
     4326     7360    3            END;
     4327     7361    2         END;
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:645  
     4328     7362
     4329     7363    1      IF BREAK_DCB# ~= 0
     4330     7364    2       THEN DO;
     4331     7365    2         BREAK_FILE.V.DCB# = BREAK_DCB#;
     4332     7366    2         CALL M$UNFID( BREAK_FILE )
     4333     7367    3          WHENALTRETURN DO;
     4334     7368    3            UNFIDCHARS = ' ';
     4335     7369    3            END;
     4336     7370    2         END;
     4337     7371    2       ELSE DO;
     4338     7372    2         UNFIDCHARS = ' ';
     4339     7373    2         END;
     4340     7374
     4341     7375    1      CALL INDEX( NBR_BREAK_TASK_CHARS, '!', BREAK_TASK );
     4342     7376    1      CALL INDEX( NBR_UNFIDCHARS, ' ', UNFIDCHARS );
     4343     7377
     4344     7378    1      IF BREAK_COUNT <= 0
     4345     7379    2       THEN DO;
     4346     7380    2         IF X_TO_ABORT
     4347     7381    3          THEN DO;
     4348     7382    3            BRK_MSG = '@ X to abort';
     4349     7383    3            TELL_BREAK.BUF_.BOUND = LENGTHV('@ X to abort');
     4350     7384    3            END;
     4351     7385    3          ELSE DO;
     4352     7386    3            CALL CONCAT( BRK_MSG, '@...', SUBSTR(BREAK_TASK,0,NBR_BREAK_TASK_CHARS),
     4353     7387    3              ' ', SUBSTR(UNFIDCHARS,0,NBR_UNFIDCHARS), '  X to abort' );
     4354     7388    3            TELL_BREAK.BUF_.BOUND = 4 + NBR_BREAK_TASK_CHARS + 1 +
     4355     7389    3              NBR_UNFIDCHARS + LENGTHV('  X TO ABORT');
     4356     7390    3            END;
     4357     7391    2         END;
     4358     7392    2       ELSE DO;
     4359     7393    2         CALL CONCAT( BRK_MSG, '@...', SUBSTR(BREAK_TASK,0,NBR_BREAK_TASK_CHARS),
     4360     7394    2           ' ', SUBSTR(UNFIDCHARS,0,NBR_UNFIDCHARS), '  ... will break when possible' )
              7394                    ;
     4361     7395    2         TELL_BREAK.BUF_.BOUND = 4 + NBR_BREAK_TASK_CHARS + 1 +
     4362     7396    2           NBR_UNFIDCHARS + LENGTHV('  ... will break when possible' );
     4363     7397    2         END;
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:646  
     4364     7398
     4365     7399    1      CALL M$TRMPRG(FPT_TRMPRG);
     4366     7400    1      CALL M$WRITE( TELL_BREAK );
     4367     7401
     4368     7402    1      IF BREAK_COUNT <= 0
     4369     7403    2       THEN DO;
     4370     7404
     4371     7405        /*    CALL M$PROMPT( SET_X_PROMPT );*/
     4372     7406    2         ANSWER = ' ';
     4373     7407    2         CALL M$READ( GET_ANSWER );
     4374     7408        /*    CALL M$PROMPT( SET_PROMPT );*/
     4375     7409
     4376     7410    2         IF ANSWER = 'X' OR ANSWER = 'x'
     4377     7411    3          THEN DO;
     4378     7412    3            BREAK_COUNT = BREAK_COUNT + 1;
     4379     7413    3            BREAK_CONTINUED = '0'B;
     4380     7414    3            END;
     4381     7415    2          ELSE BREAK_CONTINUED = '1'B;
     4382     7416
     4383     7417    2         CALL M$TIME( GET_NOW_UTS );
     4384     7418    2         CALL XUD$UTS_DIFF(TEMP_CENTISECS,NOW_UTS,BREAK_UTS);
     4385     7419    2         ACCUMULATED_BREAK_TIME = ACCUMULATED_BREAK_TIME + TEMP_CENTISECS;
     4386     7420    2         END;
     4387     7421    2      DO INHIBIT;
     4388     7422    2         BREAK_DURING_BREAK = '0'B;
     4389     7423    2         RETURN;
     4390     7424    2         END;
     4391     7425
     4392     7426    1   END FLB$EFT_BRK;

PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:647  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLB$EFT_BRK.

   Procedure FLB$EFT_BRK requires 185 words for executable code.
   Procedure FLB$EFT_BRK requires 8 words of local(AUTO) storage.

    No errors detected in file FLB$EFT.:E05TSI    .

PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:648  

 Object Unit name= FLB$EFT_BRK                                File name= FLB$EFT.:E05TOU
 UTS= JUL 29 '97 15:37:06.12 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none   118    166  FLB$EFT_BRK
    3   DCB   even  none     0      0  M$ME
    4  RoData even  UTS     28     34  FLB$EFT_BRK
    5   Proc  even  none   185    271  FLB$EFT_BRK
    6  RoData even  none     6      6  FLB$EFT_BRK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes     Async       0  FLB$EFT_BRK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 FLI$RPT_ERR
 yes     yes           Std       3 XUD$UTS_DIFF
                       nStd      0 X66_AAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AARET
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:649  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TAPE_DCBLIST$                         SNVECLIST$
     NOW_UTS                               GET_NOW_UTS                           ACCUMULATED_BREAK_TIME
     DPLIST$                               DPRESLIST$                            DISK_FILE_SPEC$
     SPECCHARS                             EFTWORD                               M$PRE_RET
     RET_CMDS_NAME                         M$ME                                  BREAK_CONTINUED
     BREAK_COUNT                           BREAK_DCB#                            BREAK_TASK
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:650  


     4217        1        /*T***********************************************************/
     4218        2        /*T*                                                         */
     4219        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     4220        4        /*T*                                                         */
     4221        5        /*T***********************************************************/
     4222        6        FLB$EFT_BRK: PROC ASYNC;

      6  5 000000   000000 700200 xent  FLB$EFT_BRK  TSX0  ! X66_AAUTO
         5 000001   000010 000000                    ZERO    8,0

     4223        7        /*F*  NAME: FLB$EFT_BRK
     4224        8              PURPOSE: Break handling routine.
     4225        9        */
     4226       10
     4227       11         /***
     4228       12          *** INCLUDE
     4229       13          ***/
     4230       14
     4231       15        %INCLUDE CP_6;
     4232     5574        %INCLUDE FLI_DATA_R;
     4233     6988        %INCLUDE XUD_UTS_M;
     4234     7070
     4235     7071         /***
     4236     7072          *** DCB
     4237     7073          ***/
     4238     7074
     4239     7075    1   DCL M$ME DCB;
     4240     7076
     4241     7077        /***
     4242     7078         *** ENTRY
     4243     7079         ***/
     4244     7080
     4245     7081    1   DCL FLI$RPT_ERR ENTRY(5);
     4246     7082        %XUD$UTS_ENTRIES;
     4247     7114
     4248     7115         /***
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:651  
     4249     7116          *** SYMREF
     4250     7117          ***/
     4251     7118
     4252     7119    1   DCL BREAK_CONTINUED BIT(1) SYMREF;
     4253     7120    1   DCL BREAK_COUNT SBIN SYMREF;
     4254     7121    1   DCL BREAK_DCB# SBIN SYMREF;
     4255     7122    1   DCL BREAK_TASK CHAR(18) SYMREF;
     4256     7123
     4257     7124         /***
     4258     7125          *** STATIC
     4259     7126          ***/
     4260     7127
     4261     7128    1   DCL NBR_BREAK_TASK_CHARS SBIN STATIC;
     4262     7129    1   DCL NBR_UNFIDCHARS SBIN STATIC;
     4263     7130    1   DCL BRK_MSG CHAR(100) STATIC;
     4264     7131    1   DCL UNFIDCHARS CHAR(50) STATIC;
     4265     7132    1   DCL ANSWER CHAR(4) STATIC;
     4266     7133    1   DCL BREAK_DURING_BREAK BIT(1) STATIC INIT('0'B);
     4267     7134    1   DCL BREAK_UTS UBIN WORD STATIC;
     4268     7135    1   DCL X_TO_ABORT BIT(1) STATIC;
     4269     7136
     4270     7137        /***
     4271     7138         *** CONSTANT
     4272     7139         ***/
     4273     7140
     4274     7141    1   DCL X_PROMPT CHAR(1) CONSTANT INIT('-');
     4275     7142    1   DCL ASTERISK CHAR(0) CONSTANT INIT('*');
     4276     7143
     4277     7144        /***
     4278     7145         *** AUTO
     4279     7146         ***/
     4280     7147
     4281     7148    1   DCL TEMP_CENTISECS SBIN AUTO;
     4282     7149
     4283     7150         /***
     4284     7151          *** FPT
     4285     7152          ***/
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:652  
     4286     7153
     4287     7154        %FPT_TRMPRG(FPTN = FPT_TRMPRG,
     4288     7155                    RSTBRK = YES,
     4289     7156                    STCLASS=CONSTANT );
     4290     7185
     4291     7186        %FPT_READ( FPTN=GET_ANSWER,
     4292     7187                   DCB=M$ME,
     4293     7188                   BUF=ANSWER );
     4294     7227
     4295     7228        %FPT_UNFID( FPTN=BREAK_FILE,
     4296     7229                    TEXTFID=UNFIDCHARS );
     4297     7247
     4298     7248        %FPT_WRITE( FPTN=TELL_BREAK,
     4299     7249                    DCB=M$ME,
     4300     7250                    BUF=BRK_MSG,
     4301     7251                    VFC=YES );
     4302     7282
     4303     7283        %FPT_PROMPT( FPTN=SET_X_PROMPT,
     4304     7284                     PROMPT=X_PROMPT );
     4305     7312
     4306     7313        %FPT_PROMPT( FPTN=SET_PROMPT,
     4307     7314                     PROMPT=ASTERISK );
     4308     7342
     4309     7343        /****************************************/
     4310     7344
     4311     7345    2      DO INHIBIT;

     4312     7346    2         IF BREAK_DURING_BREAK

   7346  5 000002   000057 234200 2                  SZN   ! BREAK_DURING_BREAK
         5 000003   000020 605200 5                  TPL   ! s:7356

     4313     7347    3          THEN DO;

     4314     7348    3            X_TO_ABORT = '1'B;

   7348  5 000004   400000 236203                    LDQ   ! -131072,DU
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:653  
         5 000005   000061 756200 2                  STQ   ! X_TO_ABORT

     4315     7349    3            CALL M$CLRSTK

   7349  5 000006   410013 713600                    CLIMB ! alt,+4107
         5 000007   000000 401760                    pmme    nvectors=0
         5 000010   000012 702200 5                  TSX2  ! s:7351
         5 000011   000017 710200 5                  TRA   ! s:7354

     4316     7350    4             WHENALTRETURN DO;

     4317     7351    4               CALL FLI$RPT_ERR;

   7351  5 000012   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         5 000013   000000 701200 xent               TSX1  ! FLI$RPT_ERR
         5 000014   000000 011200                    NOP   ! 0

     4318     7352    4               CALL M$EXIT;

   7352  5 000015   000001 713600                    CLIMB ! exit
         5 000016   000000 401760                    pmme    nvectors=0

     4319     7353    4               END;

     4320     7354    3            END;

   7354  5 000017   000030 710200 5                  TRA   ! s:7363

     4321     7355    3          ELSE DO;

     4322     7356    3            BREAK_DURING_BREAK = '1'B;

   7356  5 000020   400000 236203                    LDQ   ! -131072,DU
         5 000021   000057 756200 2                  STQ   ! BREAK_DURING_BREAK

     4323     7357    3            X_TO_ABORT = '0'B;

PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:654  
   7357  5 000022   000061 450200 2                  STZ   ! X_TO_ABORT

     4324     7358    3            CALL M$TIME( GET_NOW_UTS );

   7358  5 000023   000000 630600 xsym               EPPR0 ! GET_NOW_UTS
         5 000024   020004 713600                    CLIMB ! 8196
         5 000025   402000 401760                    pmme    nvectors=5

     4325     7359    3            BREAK_UTS = NOW_UTS;

   7359  5 000026   000000 235200 xsym               LDA   ! NOW_UTS
         5 000027   000060 755200 2                  STA   ! BREAK_UTS

     4326     7360    3            END;

     4327     7361    2         END;

     4328     7362
     4329     7363    1      IF BREAK_DCB# ~= 0

   7363  5 000030   000000 235000 xsym               LDA     BREAK_DCB#
         5 000031   000045 600000 5                  TZE     s:7372

     4330     7364    2       THEN DO;

     4331     7365    2         BREAK_FILE.V.DCB# = BREAK_DCB#;

   7365  5 000032   000000 620005                    EAX0    0,AL
         5 000033   000124 740000 2                  STX0    BREAK_FILE+20

     4332     7366    2         CALL M$UNFID( BREAK_FILE )

   7366  5 000034   000100 630400 2                  EPPR0   BREAK_FILE
         5 000035   420021 713400                    CLIMB   alt,+8209
         5 000036   404400 401760                    pmme    nvectors=10
         5 000037   000041 702000 5                  TSX2    s:7368
         5 000040   000044 710000 5                  TRA     s:7370
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:655  

     4333     7367    3          WHENALTRETURN DO;

     4334     7368    3            UNFIDCHARS = ' ';

   7368  5 000041   040000 100400                    MLR     fill='040'O
         5 000042   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000043   000041 000062 2                  ADSC9   UNFIDCHARS               cn=0,n=50

     4335     7369    3            END;

     4336     7370    2         END;

   7370  5 000044   000050 710000 5                  TRA     s:7375

     4337     7371    2       ELSE DO;

     4338     7372    2         UNFIDCHARS = ' ';

   7372  5 000045   040000 100400                    MLR     fill='040'O
         5 000046   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000047   000041 000062 2                  ADSC9   UNFIDCHARS               cn=0,n=50

     4339     7373    2         END;

     4340     7374
     4341     7375    1      CALL INDEX( NBR_BREAK_TASK_CHARS, '!', BREAK_TASK );

   7375  5 000050   000000 124400                    SCM     mask='000'O
         5 000051   000000 000022 xsym               ADSC9   BREAK_TASK               cn=0,n=18
         5 000052   000000 000001 6                  ADSC9   0                        cn=0,n=1
         5 000053   000006 000000 2                  ARG     NBR_BREAK_TASK_CHARS

     4342     7376    1      CALL INDEX( NBR_UNFIDCHARS, ' ', UNFIDCHARS );

   7376  5 000054   000000 124400                    SCM     mask='000'O
         5 000055   000041 000062 2                  ADSC9   UNFIDCHARS               cn=0,n=50
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:656  
         5 000056   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000057   000007 000000 2                  ARG     NBR_UNFIDCHARS

     4343     7377
     4344     7378    1      IF BREAK_COUNT <= 0

   7378  5 000060   000000 235000 xsym               LDA     BREAK_COUNT
         5 000061   000146 605400 5                  TPNZ    s:7393

     4345     7379    2       THEN DO;

     4346     7380    2         IF X_TO_ABORT

   7380  5 000062   000061 234000 2                  SZN     X_TO_ABORT
         5 000063   000074 605000 5                  TPL     s:7386

     4347     7381    3          THEN DO;

     4348     7382    3            BRK_MSG = '@ X to abort';

   7382  5 000064   040000 100400                    MLR     fill='040'O
         5 000065   000012 000014 4                  ADSC9   FPT_TRMPRG+8             cn=0,n=12
         5 000066   000010 000144 2                  ADSC9   BRK_MSG                  cn=0,n=100

     4349     7383    3            TELL_BREAK.BUF_.BOUND = LENGTHV('@ X to abort');

   7383  5 000067   000132 236000 2                  LDQ     TELL_BREAK+4
         5 000070   177777 376007                    ANQ     65535,DL
         5 000071   000001 276000 6                  ORQ     1
         5 000072   000132 756000 2                  STQ     TELL_BREAK+4

     4350     7384    3            END;

   7384  5 000073   000217 710000 5                  TRA     s:7399

     4351     7385    3          ELSE DO;

PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:657  
     4352     7386    3            CALL CONCAT( BRK_MSG, '@...', SUBSTR(BREAK_TASK,0,NBR_BREAK_TASK_CHARS),

   7386  5 000074   000015 236000 4                  LDQ     FPT_TRMPRG+11
         5 000075   000010 756000 2                  STQ     BRK_MSG
         5 000076   000006 720000 2                  LXL0    NBR_BREAK_TASK_CHARS
         5 000077   040000 100440                    MLR     fill='040'O
         5 000100   000000 000010 xsym               ADSC9   BREAK_TASK               cn=0,n=*X0
         5 000101   000011 000140 2                  ADSC9   BRK_MSG+1                cn=0,n=96
         5 000102   000006 236000 2                  LDQ     NBR_BREAK_TASK_CHARS
         5 000103   000140 116007                    CMPQ    96,DL
         5 000104   000136 605000 5                  TPL     s:7388
         5 000105   777637 621006                    EAX1    -97,QL
         5 000106   777777 661003                    ERX1    -1,DU
         5 000107   040046 100400                    MLR     fill='040'O
         5 000110   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000111   000011 000011 2                  ADSC9   BRK_MSG+1,Q              cn=0,n=*X1
         5 000112   000137 116007                    CMPQ    95,DL
         5 000113   000136 605000 5                  TPL     s:7388
         5 000114   777640 622006                    EAX2    -96,QL
         5 000115   777777 662003                    ERX2    -1,DU
         5 000116   000007 723000 2                  LXL3    NBR_UNFIDCHARS
         5 000117   040046 100440                    MLR     fill='040'O
         5 000120   000041 000013 2                  ADSC9   UNFIDCHARS               cn=0,n=*X3
         5 000121   000011 200012 2                  ADSC9   BRK_MSG+1,Q              cn=1,n=*X2
         5 000122   000007 036000 2                  ADLQ    NBR_UNFIDCHARS
         5 000123   000137 116007                    CMPQ    95,DL
         5 000124   000136 605000 5                  TPL     s:7388
         5 000125   200004 756100                    STQ     TEMP_CENTISECS+1,,AUTO
         5 000126   000006 236000 2                  LDQ     NBR_BREAK_TASK_CHARS
         5 000127   000007 036000 2                  ADLQ    NBR_UNFIDCHARS
         5 000130   200004 724100                    LXL4    TEMP_CENTISECS+1,,AUTO
         5 000131   777640 624014                    EAX4    -96,X4
         5 000132   777777 664003                    ERX4    -1,DU
         5 000133   040046 100400                    MLR     fill='040'O
         5 000134   000016 000014 4                  ADSC9   FPT_TRMPRG+12            cn=0,n=12
         5 000135   000011 200014 2                  ADSC9   BRK_MSG+1,Q              cn=1,n=*X4

PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:658  
     4353     7387    3              ' ', SUBSTR(UNFIDCHARS,0,NBR_UNFIDCHARS), '  X to abort' );
     4354     7388    3            TELL_BREAK.BUF_.BOUND = 4 + NBR_BREAK_TASK_CHARS + 1 +

   7388  5 000136   000006 236000 2                  LDQ     NBR_BREAK_TASK_CHARS
         5 000137   000007 036000 2                  ADLQ    NBR_UNFIDCHARS
         5 000140   000020 036007                    ADLQ    16,DL
         5 000141   000020 736000                    QLS     16
         5 000142   000132 676000 2                  ERQ     TELL_BREAK+4
         5 000143   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000144   000132 656000 2                  ERSQ    TELL_BREAK+4

     4355     7389    3              NBR_UNFIDCHARS + LENGTHV('  X TO ABORT');
     4356     7390    3            END;

     4357     7391    2         END;

   7391  5 000145   000217 710000 5                  TRA     s:7399

     4358     7392    2       ELSE DO;

     4359     7393    2         CALL CONCAT( BRK_MSG, '@...', SUBSTR(BREAK_TASK,0,NBR_BREAK_TASK_CHARS),

   7393  5 000146   000015 236000 4                  LDQ     FPT_TRMPRG+11
         5 000147   000010 756000 2                  STQ     BRK_MSG
         5 000150   000006 720000 2                  LXL0    NBR_BREAK_TASK_CHARS
         5 000151   040000 100440                    MLR     fill='040'O
         5 000152   000000 000010 xsym               ADSC9   BREAK_TASK               cn=0,n=*X0
         5 000153   000011 000140 2                  ADSC9   BRK_MSG+1                cn=0,n=96
         5 000154   000006 236000 2                  LDQ     NBR_BREAK_TASK_CHARS
         5 000155   000140 116007                    CMPQ    96,DL
         5 000156   000210 605000 5                  TPL     s:7395
         5 000157   777637 621006                    EAX1    -97,QL
         5 000160   777777 661003                    ERX1    -1,DU
         5 000161   040046 100400                    MLR     fill='040'O
         5 000162   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000163   000011 000011 2                  ADSC9   BRK_MSG+1,Q              cn=0,n=*X1
         5 000164   000137 116007                    CMPQ    95,DL
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:659  
         5 000165   000210 605000 5                  TPL     s:7395
         5 000166   777640 622006                    EAX2    -96,QL
         5 000167   777777 662003                    ERX2    -1,DU
         5 000170   000007 723000 2                  LXL3    NBR_UNFIDCHARS
         5 000171   040046 100440                    MLR     fill='040'O
         5 000172   000041 000013 2                  ADSC9   UNFIDCHARS               cn=0,n=*X3
         5 000173   000011 200012 2                  ADSC9   BRK_MSG+1,Q              cn=1,n=*X2
         5 000174   000007 036000 2                  ADLQ    NBR_UNFIDCHARS
         5 000175   000137 116007                    CMPQ    95,DL
         5 000176   000210 605000 5                  TPL     s:7395
         5 000177   200004 756100                    STQ     TEMP_CENTISECS+1,,AUTO
         5 000200   000006 236000 2                  LDQ     NBR_BREAK_TASK_CHARS
         5 000201   000007 036000 2                  ADLQ    NBR_UNFIDCHARS
         5 000202   200004 724100                    LXL4    TEMP_CENTISECS+1,,AUTO
         5 000203   777640 624014                    EAX4    -96,X4
         5 000204   777777 664003                    ERX4    -1,DU
         5 000205   040046 100400                    MLR     fill='040'O
         5 000206   000024 000036 4                  ADSC9   FPT_TRMPRG+18            cn=0,n=30
         5 000207   000011 200014 2                  ADSC9   BRK_MSG+1,Q              cn=1,n=*X4

     4360     7394    2           ' ', SUBSTR(UNFIDCHARS,0,NBR_UNFIDCHARS), ' ... will break when possible' )
              7394                    ;
     4361     7395    2         TELL_BREAK.BUF_.BOUND = 4 + NBR_BREAK_TASK_CHARS + 1 +

   7395  5 000210   000006 236000 2                  LDQ     NBR_BREAK_TASK_CHARS
         5 000211   000007 036000 2                  ADLQ    NBR_UNFIDCHARS
         5 000212   000042 036007                    ADLQ    34,DL
         5 000213   000020 736000                    QLS     16
         5 000214   000132 676000 2                  ERQ     TELL_BREAK+4
         5 000215   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000216   000132 656000 2                  ERSQ    TELL_BREAK+4

     4362     7396    2           NBR_UNFIDCHARS + LENGTHV('  ... will break when possible' );
     4363     7397    2         END;

     4364     7398
     4365     7399    1      CALL M$TRMPRG(FPT_TRMPRG);
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:660  

   7399  5 000217   000002 630400 4                  EPPR0   FPT_TRMPRG
         5 000220   160004 713400                    CLIMB   57348
         5 000221   400400 401760                    pmme    nvectors=2

     4366     7400    1      CALL M$WRITE( TELL_BREAK );

   7400  5 000222   000126 630400 2                  EPPR0   TELL_BREAK
         5 000223   040001 713400                    CLIMB   write
         5 000224   401400 401760                    pmme    nvectors=4

     4367     7401
     4368     7402    1      IF BREAK_COUNT <= 0

   7402  5 000225   000000 235000 xsym               LDA     BREAK_COUNT
         5 000226   000266 605400 5                  TPNZ    s:7422

     4369     7403    2       THEN DO;

     4370     7404
     4371     7405        /*    CALL M$PROMPT( SET_X_PROMPT );*/
     4372     7406    2         ANSWER = ' ';

   7406  5 000227   000035 236000 xsym               LDQ     B_VECTNIL+29
         5 000230   000056 756000 2                  STQ     ANSWER

     4373     7407    2         CALL M$READ( GET_ANSWER );

   7407  5 000231   000062 630400 2                  EPPR0   GET_ANSWER
         5 000232   040000 713400                    CLIMB   read
         5 000233   401400 401760                    pmme    nvectors=4

     4374     7408        /*    CALL M$PROMPT( SET_PROMPT );*/
     4375     7409
     4376     7410    2         IF ANSWER = 'X' OR ANSWER = 'x'

   7410  5 000234   000056 236000 2                  LDQ     ANSWER
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:661  
         5 000235   000002 116000 6                  CMPQ    2
         5 000236   000241 600000 5                  TZE     s:7412
         5 000237   000003 116000 6                  CMPQ    3
         5 000240   000244 601000 5                  TNZ     s:7415

     4377     7411    3          THEN DO;

     4378     7412    3            BREAK_COUNT = BREAK_COUNT + 1;

   7412  5 000241   000000 054000 xsym               AOS     BREAK_COUNT

     4379     7413    3            BREAK_CONTINUED = '0'B;

   7413  5 000242   000000 450000 xsym               STZ     BREAK_CONTINUED

     4380     7414    3            END;

   7414  5 000243   000246 710000 5                  TRA     s:7417

     4381     7415    2          ELSE BREAK_CONTINUED = '1'B;

   7415  5 000244   400000 236003                    LDQ     -131072,DU
         5 000245   000000 756000 xsym               STQ     BREAK_CONTINUED

     4382     7416
     4383     7417    2         CALL M$TIME( GET_NOW_UTS );

   7417  5 000246   000000 630400 xsym               EPPR0   GET_NOW_UTS
         5 000247   020004 713400                    CLIMB   8196
         5 000250   402000 401760                    pmme    nvectors=5

     4384     7418    2         CALL XUD$UTS_DIFF(TEMP_CENTISECS,NOW_UTS,BREAK_UTS);

   7418  5 000251   000004 236000 6                  LDQ     4
         5 000252   200006 756100                    STQ     TEMP_CENTISECS+3,,AUTO
         5 000253   000005 236000 6                  LDQ     5
         5 000254   200005 756100                    STQ     TEMP_CENTISECS+2,,AUTO
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:662  
         5 000255   200003 630500                    EPPR0   TEMP_CENTISECS,,AUTO
         5 000256   200004 450500                    STP0    TEMP_CENTISECS+1,,AUTO
         5 000257   200004 630500                    EPPR0   TEMP_CENTISECS+1,,AUTO
         5 000260   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000261   000000 701000 xent               TSX1    XUD$UTS_DIFF
         5 000262   000000 011000                    NOP     0

     4385     7419    2         ACCUMULATED_BREAK_TIME = ACCUMULATED_BREAK_TIME + TEMP_CENTISECS;

   7419  5 000263   000000 236000 xsym               LDQ     ACCUMULATED_BREAK_TIME
         5 000264   200003 036100                    ADLQ    TEMP_CENTISECS,,AUTO
         5 000265   000000 756000 xsym               STQ     ACCUMULATED_BREAK_TIME

     4386     7420    2         END;

     4387     7421    2      DO INHIBIT;

     4388     7422    2         BREAK_DURING_BREAK = '0'B;

   7422  5 000266   000057 450200 2                  STZ   ! BREAK_DURING_BREAK

     4389     7423    2         RETURN;

   7423  5 000267   000000 702200 xent               TSX2  ! X66_AARET

     4390     7424    2         END;

     4391     7425
     4392     7426    1   END FLB$EFT_BRK;

   7426  5 000270   000000 702200 xent               TSX2  ! X66_AARET

PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:663  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLB$EFT_BRK.
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:664  

 **** Variables and constants ****

  ****  Section 002  Data  FLB$EFT_BRK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    56-0-0/c CHAR(4)     r     1 ANSWER                    57-0-0/b BIT         r     1 BREAK_DURING_BREAK
   100-0-0/d STRC(792)   r     1 BREAK_FILE                60-0-0/w UBIN        r     1 BREAK_UTS
    10-0-0/c CHAR(100)   r     1 BRK_MSG                   62-0-0/d STRC(504)   r     1 GET_ANSWER
     6-0-0/w SBIN        r     1 NBR_BREAK_TASK_CHARS       7-0-0/w SBIN        r     1 NBR_UNFIDCHARS
   154-0-0/d STRC(360)   r     1 SET_PROMPT               142-0-0/d STRC(360)   r     1 SET_X_PROMPT
   126-0-0/d STRC(432)   r     1 TELL_BREAK                41-0-0/c CHAR(50)    r     1 UNFIDCHARS
    61-0-0/b BIT         r     1 X_TO_ABORT

  ****  Section 004 RoData FLB$EFT_BRK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/c CHAR        r     1 ASTERISK                   2-0-0/d STRC(288)   r     1 FPT_TRMPRG
     0-0-0/c CHAR        r     1 X_PROMPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w SBIN        r     1 TEMP_CENTISECS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 ACCUMULATED_BREAK_TIME
     0-0-0/b BIT         r     1 BREAK_CONTINUED            0-0-0/w SBIN        r     1 BREAK_COUNT
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:665  
     0-0-0/w SBIN        r     1 BREAK_DCB#                 0-0-0/c CHAR(18)    r     1 BREAK_TASK
     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/w PTR         r     1 DPLIST$
     0-0-0/w PTR         r     1 DPRESLIST$                 0-0-0/d STRC(432)   r     1 GET_NOW_UTS
     0-0-0/w UBIN        r     1 NOW_UTS                    0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME
     0-0-0/w PTR         r     1 SNVECLIST$                 0-0-0/w PTR         r     1 TAPE_DCBLIST$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$ME                       0-0-0N  NULL        r     1 M$UC


   Procedure FLB$EFT_BRK requires 185 words for executable code.
   Procedure FLB$EFT_BRK requires 8 words of local(AUTO) storage.

    No errors detected in file FLB$EFT.:E05TSI    .
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:666  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:667  
          MINI XREF LISTING

ACCUMULATED_BREAK_TIME
      6534**DCL      7419<<ASSIGN   7419>>ASSIGN
ANSWER
      7132**DCL      7207--DCLINIT  7208--DCLINIT  7406<<ASSIGN   7410>>IF       7410>>IF
ASTERISK
      7142**DCL      7336--DCLINIT
BREAK_CONTINUED
      7119**DCL      7413<<ASSIGN   7415<<ASSIGN
BREAK_COUNT
      7120**DCL      7378>>IF       7402>>IF       7412<<ASSIGN   7412>>ASSIGN
BREAK_DCB#
      7121**DCL      7363>>IF       7365>>ASSIGN
BREAK_DURING_BREAK
      7133**DCL      7346>>IF       7356<<ASSIGN   7422<<ASSIGN
BREAK_FILE
      7240**DCL      7366<>CALL
BREAK_FILE.V
      7244**DCL      7240--DCLINIT
BREAK_FILE.V.DCB#
      7244**DCL      7365<<ASSIGN
BREAK_TASK
      7122**DCL      7375>>CALLBLT  7386>>CALLBLT  7393>>CALLBLT
BREAK_UTS
      7134**DCL      7359<<ASSIGN   7418<>CALL
BRK_MSG
      7130**DCL      7269--DCLINIT  7270--DCLINIT  7382<<ASSIGN   7386<<CALLBLT  7393<<CALLBLT
DISK_CLOSE.SN_
      6185**DCL      6185--REDEF
DISK_CLOSE.UTL_
      6186**DCL      6186--REDEF
DISK_CLOSE.V.EXPIRE#
      6200**DCL      6200--REDEF
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:668  
DISK_CLOSE.V.TYPE#
      6198**DCL      6198--REDEF
DISK_CLOSE.V.XTNSIZE#
      6195**DCL      6195--REDEF    6197--REDEF
DISK_FILE_SPEC.SPEC
      6550**DCL      6552--REDEF
DISK_FILE_SPEC.SPEC.START
      6551**DCL      6551--REDEF
DISK_FILE_SPEC.SPEC.STOP
      6552**DCL      6552--REDEF
DISK_FILE_SPEC$
      6549**DCL      6550--IMP-PTR
DISK_OPEN.ACSVEH_
      6050**DCL      6051--REDEF
DISK_OPEN.ALTKEYS_
      6056**DCL      6057--REDEF    6057--REDEF
DISK_OPEN.HDR_
      6055**DCL      6056--REDEF
DISK_OPEN.TAB_
      6054**DCL      6055--REDEF
DISK_OPEN.UHL_
      6048**DCL      6049--REDEF    6049--REDEF
DISK_OPEN.V.FSN#
      6088**DCL      6088--REDEF    6088--REDEF
DISK_OPEN.WSN_
      6054**DCL      6054--REDEF
DISK_READ.STATION_
      6112**DCL      6113--REDEF
DISK_READ.V.DVBYTE.REREAD#
      6124**DCL      6124--REDEF
DISK_READ.V.INDX#
      6122**DCL      6122--REDEF
DISK_WRITE.STATION_
      6150**DCL      6150--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      6157**DCL      6157--REDEF
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:669  
DPLIST$
      6535**DCL      6547--IMP-PTR
DPRESLIST$
      6549**DCL      6549--IMP-PTR
EFTWORD
      6670**DCL      6670--REDEF
FLI$RPT_ERR
      7081**DCL-ENT  7351--CALL
FPT_EXIT.V.STEPCC#
      5975**DCL      5975--REDEF
FPT_TRMPRG
      7172**DCL      7399<>CALL
FPT_TRMPRG.V
      7179**DCL      7174--DCLINIT
FPT_TRMPRG.V.CTLFLG.RSTBRK#
      7180**DCL      7181--REDEF
GET_ANSWER
      7205**DCL      7407<>CALL
GET_ANSWER.STATION_
      7208**DCL      7209--REDEF
GET_ANSWER.V
      7209**DCL      7205--DCLINIT
GET_ANSWER.V.DVBYTE.REREAD#
      7220**DCL      7220--REDEF
GET_ANSWER.V.INDX#
      7218**DCL      7218--REDEF
GET_NOW_UTS
      6526**DCL      7358<>CALL     7417<>CALL
M$CLRSTK
      5560**DCL-ENT  7349--CALL
M$EXIT
      5514**DCL-ENT  7352--CALL
M$READ
      5503**DCL-ENT  7407--CALL
M$TIME
      5569**DCL-ENT  7358--CALL     7417--CALL
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:670  
M$TRMPRG
      5527**DCL-ENT  7399--CALL
M$UNFID
      5565**DCL-ENT  7366--CALL
M$WRITE
      5503**DCL-ENT  7400--CALL
NBR_BREAK_TASK_CHARS
      7128**DCL      7375<<CALLBLT  7386>>CALLBLT  7388>>ASSIGN   7393>>CALLBLT  7395>>ASSIGN
NBR_UNFIDCHARS
      7129**DCL      7376<<CALLBLT  7386>>CALLBLT  7388>>ASSIGN   7393>>CALLBLT  7395>>ASSIGN
NOW_UTS
      6514**DCL      7359>>ASSIGN   7418<>CALL
PRE_RET_CLOSE.SN_
      6913**DCL      6913--REDEF
PRE_RET_CLOSE.UTL_
      6914**DCL      6914--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      6928**DCL      6928--REDEF
PRE_RET_CLOSE.V.TYPE#
      6926**DCL      6926--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      6923**DCL      6923--REDEF    6925--REDEF
PRE_RET_OPEN.ACSVEH_
      6848**DCL      6849--REDEF
PRE_RET_OPEN.ALTKEYS_
      6854**DCL      6855--REDEF    6855--REDEF
PRE_RET_OPEN.HDR_
      6853**DCL      6854--REDEF
PRE_RET_OPEN.TAB_
      6852**DCL      6853--REDEF
PRE_RET_OPEN.UHL_
      6846**DCL      6847--REDEF    6847--REDEF
PRE_RET_OPEN.V.FSN#
      6886**DCL      6886--REDEF    6886--REDEF
PRE_RET_OPEN.WSN_
      6852**DCL      6852--REDEF
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:671  
PRE_RET_READ.STATION_
      6703**DCL      6704--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      6715**DCL      6715--REDEF
PRE_RET_READ.V.INDX#
      6713**DCL      6713--REDEF
PRE_RET_WRITE.STATION_
      6741**DCL      6741--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
      6748**DCL      6748--REDEF
RET_CMDS_NAME.L#
      6957**DCL      6957--IMP-SIZ
SET_PROMPT.V
      7338**DCL      7332--DCLINIT
SET_X_PROMPT.V
      7308**DCL      7302--DCLINIT
SNVECLIST$
      6489**DCL      6489--IMP-PTR
SPEC.START
      6553**DCL      6554--REDEF
SPEC.STOP
      6554**DCL      6555--REDEF
SPECCHARS
      6553**DCL      6553--REDEF
TAPE_CLOSE.SN_
      6406**DCL      6406--REDEF
TAPE_CLOSE.UTL_
      6407**DCL      6407--REDEF
TAPE_CLOSE.V.EXPIRE#
      6421**DCL      6421--REDEF
TAPE_CLOSE.V.TYPE#
      6419**DCL      6419--REDEF
TAPE_CLOSE.V.XTNSIZE#
      6416**DCL      6416--REDEF    6418--REDEF
TAPE_DCBLIST$
      5962**DCL      5962--IMP-PTR
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:672  
TAPE_OPEN.ACSVEH_
      6271**DCL      6272--REDEF
TAPE_OPEN.ALTKEYS_
      6277**DCL      6278--REDEF    6278--REDEF
TAPE_OPEN.HDR_
      6276**DCL      6277--REDEF
TAPE_OPEN.TAB_
      6275**DCL      6276--REDEF
TAPE_OPEN.UHL_
      6269**DCL      6270--REDEF    6270--REDEF
TAPE_OPEN.V.FSN#
      6309**DCL      6309--REDEF    6309--REDEF
TAPE_OPEN.WSN_
      6275**DCL      6275--REDEF
TAPE_READ.STATION_
      6333**DCL      6334--REDEF
TAPE_READ.V.DVBYTE.REREAD#
      6345**DCL      6345--REDEF
TAPE_READ.V.INDX#
      6343**DCL      6343--REDEF
TAPE_WRITE.STATION_
      6371**DCL      6371--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      6378**DCL      6378--REDEF
TELL_BREAK
      7268**DCL      7400<>CALL
TELL_BREAK.BUF_.BOUND
      7268**DCL      7383<<ASSIGN   7388<<ASSIGN   7395<<ASSIGN
TELL_BREAK.STATION_
      7270**DCL      7270--REDEF
TELL_BREAK.V
      7271**DCL      7268--DCLINIT
TELL_BREAK.V.DVBYTE.VFC#
      7277**DCL      7277--REDEF
TEMP_CENTISECS
      7148**DCL      7418<>CALL     7419>>ASSIGN
PL6.E3A0      #002=FLB$EFT_BRK File=FLB$EFT.:E05TSI                              TUE 07/29/97 15:37 Page:673  
TVECTOR.W2
      6502**DCL      6503--REDEF
UNFIDCHARS
      7131**DCL      7240--DCLINIT  7368<<ASSIGN   7372<<ASSIGN   7376>>CALLBLT  7386>>CALLBLT  7393>>CALLBLT
XUD$UTS_DIFF
      7083**DCL-ENT  7418--CALL
X_PROMPT
      7141**DCL      7306--DCLINIT
X_TO_ABORT
      7135**DCL      7348<<ASSIGN   7357<<ASSIGN   7380>>IF
