VERSION E05

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:1    
        1        1        /*M* IAA$GOOSE  Goose's main program  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CCC=YES,DMR,PLM=5,IND=5,CTI=5,SDI=4,MCL=10,CSI=0,ECI=0,DTI=2 */
        8        8        %SET LISTSUB = '1'B;
        9        9        IAA$GOOSE: PROC MAIN;
       10       10                                                /* */
       11       11        /*P*      NAME: GOOSE
       12       12                  PURPOSE: Automatically schedules ghost jobs and keyins
       13       13                  DESCRIPTION: Goose allows the automatic scheduling of
       14       14                                 ghost jobs, operator keyins, and operator
       15       15                                 messages. The commands for GOOSE are contained
       16       16                                 in a file GOOSE_EGG the resides in :SYS.
       17       17                                                           */
       18       18        /*D*      NAME: IAA$GOOSE
       19       19                  CALL: None - main program
       20       20                  INTERFACE: IAA$EVENT, IAA$ABORT_CMD, IAE$ERROR
       21       21                  DESCRIPTION: This is the main program for the GOOSE
       22       22                                 processor. If it is running as
       23       23                                 a ghost program it will build the time
       24       24                                 table and then calculate how many minutes
       25       25                                 it must wait until something needs to be
       26       26                                 done or ten mintues which ever is less. It
       27       27                                 then checks to see if GOOSE_EGG file has
       28       28                                 been changed and rebuilds the time table if
       29       29                                 it has. Then it will do any commands that
       30       30                                 it is time to do and go back to sleep. When
       31       31                                 the program first starts it opens and issues
       32       32                                 a read to CSCG to receive commands from
       33       33                                 KEYIN or an online GOOSE job. IAA$EVENT
       34       34                                 will handle the event completion of the read.
       35       35                                 If GOOSE is run online it uses XUG$GETCMD
       36       36                                 to read and parse commands.
       37       37                                 These commands can: turn on and off
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:2    
       38       38                                 auto scheduling or auto scheduling message,
       39       39                                 tell ghost GOOSE that GOOSE_EGG has been
       40       40                                 changed, do a keyin from online, start a
       41       41                                 ghost job, or update the GOOSE_EGG file.
       42       42              */
       43       43                                                /* */
       44       44
       45       45        %INCLUDE CP_6;
       46      126        %INCLUDE CP_6_SUBS;
       47      666        %INCLUDE IA_SUBS_C;
       48      736        %INCLUDE XUH_MACRO_C;
       49      820        %INCLUDE XU_MACRO_C;
       50     3926        %INCLUDE F$DCB;
       51     3975        %INCLUDE OC_SUBS_C;
       52     4706        %INCLUDE FM$FIT;
       53     4927        %INCLUDE B_ERRORS_C;
       54     6054        %INCLUDE B$JIT;
       55     6344        %INCLUDE OC_MESSHD_C;
       56     6397        %INCLUDE IA_DAT_R;
       57     6415        %INCLUDE IA_PERR_C;
       58     6456        %INCLUDE IA_MACRO_C;
       59     6512        %INCLUDE JG_EVID_C;
       60     6737        %INCLUDE JG_GHOSTS_C ;
       61     6827        %INCLUDE XUG_ENTRY;
       62     6858        %INCLUDE XU_PERR_C;
       63     7049        %INCLUDE XU_SUBS_C;
       64     7141                                                /* */
       65     7142        %B$TCB;
       66     7145        %B$ALT;
       67     7153        %PARSE$OUT (NAME=OUT$BLK,STCLASS=BASED);
       68     7198        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
       69     7236
       70     7237
       71     7238        %XUG_INIT (NAME=ONLINE_INIT,
       72     7239                   ABORT=IAA$ABORT_CMD,
       73     7240                   BRKMSG=NIL,
       74     7241                   CONTINUE=NIL,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:3    
       75     7242                   COMMANDS=YES,
       76     7243                   ECHO=HONOR_FLAG,
       77     7244                   GOODCMD=YES,
       78     7245                   PASS=BLANK,
       79     7246                   POST_EXEC=NIL,
       80     7247                   PRE_EXEC=NIL,
       81     7248                   PROCNAME=HELP_NAME,
       82     7249                   SPELLING=YES,
       83     7250                   SYNTAX=YES,
       84     7251                   WORK=NIL);
       85     7664                                                /**/
       86     7665        %XUG_INIT (NAME=GHOST_INIT,
       87     7666                   ABORT=NIL,
       88     7667                   BRKMSG=NIL,
       89     7668                   CONTINUE=NIL,
       90     7669                   COMMANDS=NO,
       91     7670                   ECHO=NEVER_ECHO,
       92     7671                   GOODCMD=NO,
       93     7672                   PASS=BLANK,
       94     7673                   POST_EXEC=NIL,
       95     7674                   PRE_EXEC=NIL,
       96     7675                   PREPROCESS=NO,
       97     7676                   PROCNAME=HELP_NAME,
       98     7677                   SPELLING=NO,
       99     7678                   SYNTAX=NO,
      100     7679                   WORK=NIL);
      101     8092                                                /**/
      102     8093        %XUG_INIT (NAME=UPDATE_INIT,
      103     8094                   ABORT=NIL,
      104     8095                   BRKMSG=NIL,
      105     8096                   CONTINUE=NIL,
      106     8097                   COMMANDS=NO,
      107     8098                   ECHO=NEVER_ECHO,
      108     8099                   GOODCMD=NO,
      109     8100                   PASS=LEAVE,
      110     8101        /*           PCB=ONLINE_PCB,*/
      111     8102                   POST_EXEC=NIL,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:4    
      112     8103                   PRE_EXEC=NIL,
      113     8104                   PREPROCESS=NO,
      114     8105                   PROCNAME=HELP_NAME,
      115     8106                   SPELLING=NO,
      116     8107                   SYNTAX=NO,
      117     8108                   WORK=NIL);
      118     8521                                                /**/
      119     8522        %XUG_GETCMD (NAME = ONLINE_GETCMD,
      120     8523                     ALWAYS_SET_PROMPT = NO,
      121     8524                     CONTINUE_OK = YES,
      122     8525                     DCB2_PARAM = M$DO,
      123     8526                     DCB_PARAM = M$LO,
      124     8527                     INDCB = M$SI,              /* M$SI */
      125     8528                     NODES = NIL,               /* set at run time */
      126     8529                     OUTDCB = M$LO,
      127     8530                     PROMPT = OPROMPT,
      128     8531                     PROMPT_VFC = NO,
      129     8532                     READR = NIL,
      130     8533                     RPROMPT = NIL);
      131     8871                                                /**/
      132     8872        %XUG_GETCMD (NAME = EGG_GETCMD,
      133     8873                     ALWAYS_SET_PROMPT = NO,
      134     8874                     CONTINUE_OK = YES,
      135     8875                     DCB2_PARAM = M$DO,
      136     8876                     DCB_PARAM = NIL,
      137     8877                     INDCB = NIL,               /* set at run time */
      138     8878                     NODES = GOOSE_NODES,
      139     8879                     OUTDCB = NIL,
      140     8880                     PROMPT = NIL,
      141     8881                     PROMPT_VFC = NO,
      142     8882                     READR = NIL,
      143     8883                     USE_EPOS = YES,
      144     8884                     RPROMPT = NIL);
      145     9222                                                /**/
      146     9223
      147     9224        %XUG_PARAMS;
      148     9668
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:5    
      149     9669        %XUG_RLT (NAME=RLT,STCLASS="BASED(RLT$)");
      150     9676
      151     9677    1   DCL M$SI DCB;
      152     9678    1   DCL M$DO DCB;
      153     9679    1   DCL M$SCHED DCB;
      154     9680    1   DCL M$LL DCB;
      155     9681    1   DCL M$LO DCB;
      156     9682    1   DCL M$CSCG DCB;
      157     9683    1   DCL M$TEMP DCB;
      158     9684    1   DCL M$TABLE DCB;
      159     9685                                                /**/
      160     9686    1   DCL IAD$DATE ENTRY ALTRET;
      161     9687    1   DCL IAM$LEAP ENTRY;
      162     9688    1   DCL IAE$ERROR ENTRY(5);
      163     9689    1   DCL IAE$CSCG_ERROR ENTRY(3);
      164     9690    1   DCL IAE$ONLINE_ERROR ENTRY(2);
      165     9691    1   DCL IAA$EVENT ENTRY ASYNC;
      166     9692    1   DCL IAA$ABORT_CMD ENTRY;
      167     9693    1   DCL IAM$CYCLE ENTRY;
      168     9694    1   DCL XSF$LOCCODP ENTRY (2) ALTRET;
      169     9695
      170     9696        %OC_MESSHD_W   (NAME=TELL_CONSOLES,     /* Template to tell console */
      171     9697                            ATR=M_SYS,          /* Tell system consoles */
      172     9698                            FUNC=WR,
      173     9699                            NPARMS = 4,
      174     9700                            MSG=GOOSE_EMSG#);
      175     9713    1        2 * (0:3) UBIN BYTE CALIGNED INIT(1,4,80,20),
      176     9714    1             2 KEY UBIN BYTE CALIGNED,
      177     9715    1             2 ERROR BIT(36) CALIGNED,
      178     9716    1             2 MESS CHAR(80) CALIGNED,
      179     9717    1             2 FID CHAR(20) CALIGNED;
      180     9718        %OC_MESSHD_W (NAME=SEND_KEYIN,          /* Keyin in template */
      181     9719                       ATR=M_SYS,
      182     9720                       FUNC=IKI,
      183     9721                       NPARMS=1);
      184     9734    1        2 SIZE UBIN BYTE CALIGNED,
      185     9735    1             2 KEYIN CHAR(80);
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:6    
      186     9736                                                /**/
      187     9737        /*  Symdef's and symref's  */
      188     9738                                                /**/
      189     9739    1   DCL B$TCB$ PTR SYMREF;
      190     9740    1   DCL B$JIT$ PTR SYMREF;
      191     9741    1   DCL GOOSE_ERR BIT(36) STATIC SYMDEF;
      192     9742    1   DCL GOOSE_NODES PTR SYMREF;
      193     9743    1   DCL GOOSE_ONODES PTR SYMREF;            /* Gooses online nodes */
      194     9744    1   DCL GOOSE_ONODES2 PTR SYMREF;
      195     9745
      196     9746
      197     9747    1   DCL GOOSE_READ_FLAG BIT(1) STATIC SYMDEF INIT('0'B);
      198     9748    1   DCL GOOSE_OUT$ PTR STATIC SYMDEF;
      199     9749                                                /**/
      200     9750        /*  Static variables  */
      201     9751                                                /**/
      202     9752    1   DCL CSCG_BUF CHAR(140) STATIC CALIGNED INIT (' ');
      203     9753    1   DCL CURR_DATE_JULIAN UBIN WORD STATIC ALIGNED INIT (0);
      204     9754    1   DCL CURR_TIME_HOLD UBIN WORD STATIC ALIGNED;
      205     9755    1   DCL CURR_TIME SBIN WORD STATIC;         /* Current time */
      206     9756    1   DCL DO_ACCT CHAR (8) STATIC;
      207     9757    1   DCL DO_CMD CHAR(256) STATIC;
      208     9758    1   DCL 1 DO_DATE STATIC,
      209     9759    1           2 YY CHAR(2),
      210     9760    1           2 MM CHAR(2) CALIGNED,
      211     9761    1           2 ERROR UBIN CALIGNED,
      212     9762    1           2 DD CHAR(2) CALIGNED;
      213     9763    1   DCL 1 DO_DATER REDEF DO_DATE,
      214     9764    1           2 Y1 CHAR(1),
      215     9765    1           2 Y2 CHAR(1),
      216     9766    1           2 M1 CHAR(1),
      217     9767    1           2 M2 CHAR(1),
      218     9768    1           2 * UBIN CALIGNED,
      219     9769    1           2 D1 CHAR(1),
      220     9770    1           2 D2 CHAR(1);
      221     9771    1   DCL DO_PASS CHAR (8) STATIC;
      222     9772    1   DCL 1 EDIT_CMD STATIC,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:7    
      223     9773    1           2 * UBIN BYTE CALIGNED INIT(11),
      224     9774    1           2 * CHAR(0) INIT ('EDIT *GOOSE');
      225     9775    1   DCL 1 EDIT_KEY STATIC,                  /* Used to right edit keys */
      226     9776    1           2 * UBIN BYTE CALIGNED INIT(3),
      227     9777    1           2 NUM UBIN(27) CALIGNED;
      228     9778    1   DCL ELAPSED_MINS SBIN WORD STATIC INIT(0);
      229     9779    1   DCL FPARAM(0:1023) UBIN WORD STATIC;
      230     9780    1   DCL 1 GOOSE_OFF_M STATIC,
      231     9781    1           2 * UBIN BYTE CALIGNED INIT(0),
      232     9782    1           2 * UBIN BYTE CALIGNED INIT(2 /* KEY_GOOSEOFF# */),
      233     9783    1           2 * BIT(18)  CALIGNED INIT ('777777'O);
      234     9784    1   DCL GOOSE_ON BIT(1) STATIC INIT('1'B);  /* Goose on flag */
      235     9785    1   DCL 1 GOOSE_ON_M STATIC,
      236     9786    1           2 * UBIN BYTE CALIGNED INIT(0),
      237     9787    1           2 * UBIN BYTE CALIGNED INIT(1 /* KEY_GOOSEON# */),
      238     9788    1           2 * BIT(18)  CALIGNED INIT ('777777'O);
      239     9789    1   DCL GOOSE_UPD BIT(1) STATIC INIT ('0'B);/* Set when keyin indicated upd */
      240     9790    1   DCL 1 GOOSE_UPD_M STATIC,
      241     9791    1           2 * UBIN BYTE CALIGNED INIT(0),
      242     9792    1           2 * UBIN BYTE CALIGNED INIT(3 /* KEY_GOOSEUPD# */),
      243     9793    1           2 * BIT(18)  CALIGNED INIT ('777777'O);
      244     9794    1   DCL 1 GOOSEM_OFF_M STATIC,
      245     9795    1           2 * UBIN BYTE CALIGNED INIT(0),
      246     9796    1           2 * UBIN BYTE CALIGNED INIT(5 /* KEY_GOOSEMOFF# */),
      247     9797    1           2 * BIT(18)  CALIGNED INIT ('777777'O);
      248     9798    1   DCL GOOSEM_ON BIT(1) STATIC INIT('1'B); /* Goose on flag */
      249     9799    1   DCL 1 GOOSEM_ON_M STATIC,
      250     9800    1           2 * UBIN BYTE CALIGNED INIT(0),
      251     9801    1           2 * UBIN BYTE CALIGNED INIT(4 /* KEY_GOOSEMON# */),
      252     9802    1           2 * BIT(18)  CALIGNED INIT ('777777'O);
      253     9803    1   DCL GREEN_LIGHT BIT(1) STATIC UNAL INIT ('0'B);
      254     9804    1   DCL IA_LOWPRIV BIT(1) STATIC INIT('1'B);
      255     9805    1   DCL INBUF CHAR(1024) STATIC;
      256     9806    1   DCL 1 LAST_DATE STATIC,
      257     9807    1           2 YR CHAR(2) CALIGNED,
      258     9808    1           2 MON CHAR(2) CALIGNED,
      259     9809    1           2 DAY CHAR(2) CALIGNED,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:8    
      260     9810    1           2 * CHAR(2) CALIGNED;
      261     9811    1   DCL LAST_DATE_JULIAN UBIN WORD STATIC ALIGNED INIT (0);
      262     9812    1   DCL LAST_TIME SBIN HALF STATIC INIT(-1); /* Time last checked */
      263     9813    1   DCL LEGAL_DAYS CHAR(21) STATIC INIT ('SUNMONTUEWEDTHUFRISAT');
      264     9814    1   DCL 1 LIST_CMD STATIC,
      265     9815    1           2 * UBIN BYTE CALIGNED INIT(24),
      266     9816    1           2 * CHAR(0) INIT ('C GOOSE_EGG.:SYS OVER ME');
      267     9817    1   DCL MORE_INFO BIT(1) STATIC UNAL INIT ('1'B);
      268     9818    1   DCL NUM_DAYS SBIN WORD STATIC ALIGNED INIT (0);
      269     9819    1   DCL ON_LINE BIT(1) ALIGNED STATIC INIT('0'B); /* 0 = ghost 1 = online */
      270     9820    1   DCL 1 OPROMPT  CONSTANT CALIGNED,
      271     9821    1           2 COUNT UBIN BYTE INIT(1) CALIGNED,
      272     9822    1           2 TEXT CHAR(1) INIT(':');
      273     9823    1   DCL OUR_TIME_ESTIMATE UBIN WORD STATIC ALIGNED INIT (0);
      274     9824    1   DCL OUT$ PTR STATIC;
      275     9825    1   DCL PARSE_WK (0:200) UBIN WORD STATIC;
      276     9826    1   DCL 1 PCL_CMD STATIC,
      277     9827    1           2 * UBIN BYTE CALIGNED INIT(40),
      278     9828    1           2 * CHAR(0) INIT ('C GOOSE_EGG.:SYS OVER GOOSE_EGG.:SYS(LN)');
      279     9829    1   DCL START_TIME SBIN WORD STATIC INIT (9999);
      280     9830    1   DCL START_UP BIT(1) STATIC INIT ('0'B);
      281     9831    1   DCL SYSID CHAR(6) STATIC INIT (' ');
      282     9832    1   DCL 1 TEXT_DATE STATIC,                 /* Used to get current date */
      283     9833    1           2 YR CHAR(2) CALIGNED,
      284     9834    1           2 MON CHAR(2) CALIGNED,
      285     9835    1           2 DAY CHAR(2) CALIGNED,
      286     9836    1           2 * CHAR(2);
      287     9837    1   DCL 1 TEXT_DATER REDEF TEXT_DATE,
      288     9838    1           2 TEXT CHAR(6) CALIGNED,
      289     9839    1           2 * CHAR(2) CALIGNED;
      290     9840    1   DCL TEXT_DAY CHAR(3) STATIC;            /* Current day */
      291     9841    1   DCL 1 TEXT_TIME STATIC,                 /* Used to get current time */
      292     9842    1           2 HR_MIN CHAR(4) CALIGNED,
      293     9843    1           2 SEC CHAR(2) CALIGNED,
      294     9844    1           2 * CHAR(2) CALIGNED;
      295     9845    1   DCL TIME_ENTRY$ PTR STATIC;
      296     9846    1   DCL TIME_HEAD$ PTR STATIC INIT(ADDR(NIL)); /* Pointer to table head */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:9    
      297     9847    1   DCL TIME_LEFT SBIN WORD STATIC;         /* Time left in wait */
      298     9848    1   DCL TIME_WARP BIT(1) UNAL STATIC INIT ('0'B);
      299     9849    1   DCL TP_FLAG BIT(1) STATIC INIT ('0'B);
      300     9850    1   DCL B_VERSION CHAR(1) SYMREF;
      301     9851    1   DCL 1 B$VERSIONB BASED,
      302     9852    1           2 C_ UBIN BYTE CALIGNED,
      303     9853    1           2 T_ CHAR (B$VERSIONB.C_) CALIGNED;
      304     9854
      305     9855                                                /**/
      306     9856        /*  Based variables  */
      307     9857                                                /**/
      308     9858    1   DCL CMD_BUFFER CHAR(255) BASED;
      309     9859    1   DCL 1 CSCG_KEYIN BASED,
      310     9860    1           2 * UBIN BYTE CALIGNED,
      311     9861    1           2  KEY UBIN BYTE CALIGNED,
      312     9862    1           2 CADDR BIT(18) HALIGNED,
      313     9863    1           2 TPNAME CHAR (8) CALIGNED,
      314     9864    1           2 * CHAR(128) CALIGNED;
      315     9865    1   DCL 1 TIME_TABLE BASED (TIME_ENTRY$),   /* Structure for entries */
      316     9866    1           2 TIME UBIN HALF,               /* Do time */
      317     9867    1           2 GHOST_FID,
      318     9868    1               3 SIZE UBIN BYTE CALIGNED,
      319     9869    1               3 TEXT CHAR(19) CALIGNED,
      320     9870    1           2 ACCT CHAR (8) CALIGNED,
      321     9871    1           2 PASS CHAR (8) CALIGNED,
      322     9872    1           2 TYPE UBIN BYTE CALIGNED, /* Type of command 0=KEYIN,1=GJOB,2=MES */
      323     9873    1           2 SIZE UBIN BYTE CALIGNED,      /* Size of command */
      324     9874    1           2 COMMAND CHAR(256) CALIGNED,   /* Keyin or command */
      325     9875    1           2 NEXT$ PTR;                    /* Pointer to next entry */
      326     9876                                                /**/
      327     9877        /*  Auto variables  */
      328     9878                                                /**/
      329     9879    1   DCL DO_CMD_SIZE UBIN BYTE;
      330     9880    1   DCL DO_DAY(0:6) CHAR(3);
      331     9881    1   DCL DO_EVERY SBIN WORD;
      332     9882    1   DCL 1 DO_FID,
      333     9883    1           2 SIZE UBIN BYTE CALIGNED,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:10   
      334     9884    1           2 TEXT CHAR(19) CALIGNED;
      335     9885    1   DCL DO_FROM SBIN WORD;
      336     9886    1   DCL DO_HOUR SBIN WORD;                  /* DO_ variable contain the */
      337     9887    1   DCL DO_OFFSET SBIN WORD;
      338     9888    1   DCL DO_TMIN SBIN WORD;                  /* Parse command items */
      339     9889    1   DCL DO_TYPE UBIN BYTE;
      340     9890    1   DCL DO_UMIN SBIN WORD;
      341     9891    1   DCL DO_UNTIL SBIN WORD;
      342     9892    1   DCL ERROR_FLAG BIT(1);
      343     9893    1   DCL GOOSE_ERROR UBIN;
      344     9894    1   DCL I SBIN WORD;
      345     9895    1   DCL MODIFY_DATE UBIN(36);
      346     9896    1   DCL PTR$ PTR;
      347     9897    1   DCL RLT$ PTR;
      348     9898    1   DCL TEMP$ PTR;
      349     9899    1   DCL XUG$  PTR;
      350     9900    1   DCL XUG_P$ PTR;
      351     9901                                                /**/
      352     9902                                                /**/
      353     9903                                      /* Generate template for all cscg
      354     9904                                         messages passed to goose (with
      355     9905                                         the exception of keyins). */
      356     9906                                                /**/
      357     9907        %IA_CITE       (FPTN=CSCG_EVENT,
      358     9908                            STCLASS=BASED);
      359     9934                                                /**/
      360     9935                                                /**/
      361     9936                                                /**/
      362     9937        %FPT_GDS (FPTN=GET_ENTRY,               /* Get an entry of TIME_TABLE */
      363     9938                       RESULTS=SEG_VLP,
      364     9939                       SEGSIZE = "SIZEW(TIME_TABLE)",
      365     9940                       FREE=NO);
      366     9956                                                /**/
      367     9957        %FPT_FDS (FPTN=FREE_DATA,               /* Free dynamic segment */
      368     9958                       SEGSIZE="BITBIN('777777'O)",
      369     9959                       RESULTS=SEG_VLP);
      370     9974                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:11   
      371     9975        %VLP_VECTOR (FPTN=SEG_VLP);
      372     9990                                                /**/
      373     9991        %FPT_ERRMSG (FPTN=CSCG_ERR,
      374     9992                            BUF=MESS_BUF,
      375     9993                            CODE=ERROR,
      376     9994                            DCB=M$CSCG,
      377     9995                            OUTDCB1=M$DO);
      378    10022                                                /**/
      379    10023        %FPT_OPEN (FPTN=CREATE_EGG,             /* Create goose egg file */
      380    10024                       DCB=M$SCHED,
      381    10025                       FUN=CREATE,
      382    10026                       ACS=SEQUEN,
      383    10027                       ORG=KEYED,
      384    10028                       ACSVEH=ACS_VEH,
      385    10029                       ACCESS=ACS_ACCT);
      386    10138                                                /**/
      387    10139                                                /**/
      388    10140        %VLP_ATTR (FPTN=ACS_ACCT);              /* Access for accounts */
      389    10154        %VLP_ACCESS (NOLIST=YES,EXEC=YES,ACCT='?',LAST=";");
      390    10171                                                /**/
      391    10172                                                /**/
      392    10173        %VLP_ATTR (FPTN=ACS_VEH);
      393    10187        %VLP_ACSVEH (READ=YES,UPD=YES,DELR=YES,WNEW=YES,VEHICLE='GOOSE');
      394    10204        %VLP_ACSVEH (READ=YES,UPD=YES,DELR=YES,WNEW=YES,VEHICLE='GOOSE_TEST',LAST=";");
      395    10221        %FPT_OPEN (FPTN=OPEN_S,
      396    10222                       FPARAM=FPARAM,
      397    10223                       DCB = M$SCHED,
      398    10224                       ASN=FILE,
      399    10225                       NAME=NAME,
      400    10226                       ACCT=SYSACCT,
      401    10227                       FUN=IN,
      402    10228                       SHARE=IN);
      403    10337                                                /**/
      404    10338        %VLP_NAME (FPTN=NAME,NAME='GOOSE_EGG');
      405    10365        %VLP_NAME (FPTN=CSCGNM,                 /* Name of cscg for open */
      406    10366                       NAME='CSCG');
      407    10393                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:12   
      408    10394        %FPT_READ (FPTN=READ_S,
      409    10395                            DCB=M$SCHED,
      410    10396                            BUF=INBUF,
      411    10397                            WAIT=YES);
      412    10436                                                /**/
      413    10437        %FPT_READ (FPTN=READ_CMD,
      414    10438                       DCB=M$SCHED,
      415    10439                       BUF=DO_CMD,
      416    10440                       WAIT=YES);
      417    10479                                                /**/
      418    10480                                                /**/
      419    10481        %FPT_CLOSE (FPTN=CLOSE_S,               /* Close schedule file */
      420    10482                    DISP=SAVE,
      421    10483                    DCB=M$SCHED);
      422    10525                                                /**/
      423    10526        %VLP_ERRCODE (FPTN=ERROR);
      424    10571                                                /**/
      425    10572        %FPT_WRITE (FPTN=OUT_MESS,
      426    10573                       DCB=M$DO,
      427    10574                       BUF=MESS_BUF,
      428    10575                       WAIT=YES);
      429    10606                                                /**/
      430    10607        %FPT_TIME (FPTN=GET_DAY,
      431    10608                       DAY=TEXT_DAY,
      432    10609                       DEST=LOCAL);
      433    10628                                                /**/
      434    10629        %FPT_TIME (FPTN=GET_CURR,               /* Used to get current time */
      435    10630                       DATE=TEXT_DATER.TEXT,
      436    10631                       TIME=TEXT_TIME,
      437    10632                       DEST=ANS);
      438    10651                                                /**/
      439    10652        %FPT_WAIT (FPTN=MAIN_WAIT);             /* Main wait */
      440    10666                                                /**/
      441    10667        %FPT_WAIT (FPTN=FIVE_SECOND,            /* Wait for five second */
      442    10668                   UNITS=5);
      443    10682                                                /**/
      444    10683        %FPT_READ (FPTN=READ_SI,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:13   
      445    10684                       BUF=INBUF,
      446    10685                       WAIT=YES,
      447    10686                       DCB=M$SI);
      448    10725                                                /**/
      449    10726        %FPT_OPEN (FPTN=OPEN_OCSCG,
      450    10727                   DCB=M$CSCG,
      451    10728                   SCRUB=YES,
      452    10729                   SETSTA=OGOOSE_SET,
      453    10730                   FUN=UPDATE,
      454    10731                   ASN=COMGROUP,
      455    10732                   NAME=CSCGNM,
      456    10733                   ACCT=SYSACCT,
      457    10734                   SHARE=ALL);
      458    10843                                                /**/
      459    10844        %VLP_SETSTA (FPTN=OGOOSE_SET,
      460    10845                       MYSTATION='OGOOSE');
      461    10873                                                /**/
      462    10874        %FPT_CLOSE (FPTN=CLOSE_OCSCG,           /* Used to close cscg */
      463    10875                    DISP=SAVE,
      464    10876                    DCB=M$CSCG);
      465    10918                                                /**/
      466    10919                                                /**/
      467    10920        %FPT_WRITE (FPTN=GOOSE_ON_WR,           /* Use to turn goose on */
      468    10921                       DCB=M$CSCG,
      469    10922                       STATION=GOOSE,
      470    10923                       BUF=GOOSE_ON_M,
      471    10924                       WAIT=YES);
      472    10955                                                /**/
      473    10956        %FPT_WRITE (FPTN=GOOSE_OFF,             /* Use to turn goose off */
      474    10957                       DCB=M$CSCG,
      475    10958                       STATION=GOOSE,
      476    10959                       BUF=GOOSE_OFF_M,
      477    10960                       WAIT=YES);
      478    10991                                                /**/
      479    10992        %FPT_WRITE (FPTN=GOOSEM_ON_WR,          /* Use to turn goose messages on */
      480    10993                       DCB=M$CSCG,
      481    10994                       STATION=GOOSE,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:14   
      482    10995                       BUF=GOOSEM_ON_M,
      483    10996                       WAIT=YES);
      484    11027                                                /**/
      485    11028        %FPT_WRITE (FPTN=GOOSEM_OFF,            /* Use to turn goose messages off */
      486    11029                       DCB=M$CSCG,
      487    11030                       STATION=GOOSE,
      488    11031                       BUF=GOOSEM_OFF_M,
      489    11032                       WAIT=YES);
      490    11063                                                /**/
      491    11064        %FPT_WRITE (FPTN=WGOOSE_UPD,            /* Use to turn goose upd */
      492    11065                       DCB=M$CSCG,
      493    11066                       STATION=GOOSE,
      494    11067                       BUF=GOOSE_UPD_M,
      495    11068                       WAIT=YES);
      496    11099                                                /**/
      497    11100        %FPT_WRITE (FPTN=TELL_CSCG,             /* Tell consoles error */
      498    11101                       DCB=M$CSCG,
      499    11102                       STATION=STA_KEYIN,
      500    11103                       BUF=TELL_CONSOLES,
      501    11104                       WAIT=YES);
      502    11135                                                /**/
      503    11136        %FPT_WRITE (FPTN=KEYIN_CSCG,            /* Tell consoles error */
      504    11137                       DCB=M$CSCG,
      505    11138                       BUF=SEND_KEYIN,
      506    11139                       STATION=STA_KEYIN,
      507    11140                       WAIT=YES);
      508    11171                                                /**/
      509    11172        %VLP_STATION (FPTN=GOOSE,STATION='GOOSE'); /* Goose station */
      510    11199                                                /**/
      511    11200        %VLP_STATION (FPTN=OGOOSE,STATION='OGOOSE'); /* Ogoose station */
      512    11227                                                /**/
      513    11228        %VLP_STATION (FPTN=STA_KEYIN,
      514    11229                      STATION='KEYIN');
      515    11256                                                /**/
      516    11257        %FPT_OPEN (FPTN=OPEN_CSCG,              /* Open cscg to keyin */
      517    11258                   DCB=M$CSCG,
      518    11259                   FUN=UPDATE,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:15   
      519    11260                   ASN=COMGROUP,
      520    11261                   SETSTA=GOOSE_SET,
      521    11262                   NAME=CSCGNM,
      522    11263                   SCRUB=YES,
      523    11264                   SHARE=ALL);
      524    11373                                                /**/
      525    11374                                                /**/
      526    11375        %VLP_SETSTA (FPTN=GOOSE_SET,
      527    11376                       MYSTATION='GOOSE');
      528    11404                                                /**/
      529    11405        %FPT_READ (FPTN=READ_CSCG,              /* Use for asyn reads of cscg */
      530    11406                   DCB=M$CSCG,
      531    11407                   BUF=CSCG_BUF,
      532    11408                   EVENT=1,
      533    11409                   WAIT=NO);
      534    11448                                                /**/
      535    11449        %FPT_EVENT (FPTN=DO_EVENT,UENTRY=IAA$EVENT);
      536    11463                                                /**/
      537    11464        %FPT_LINK (FPTN=LINK_EDIT,
      538    11465                       CMD=EDIT_CMD,
      539    11466                       NAME=EDIT_NAME,
      540    11467                       ACCT=SYSACCT);
      541    11485                                                /**/
      542    11486        %VLP_NAME (FPTN=EDIT_NAME,
      543    11487                       NAME='EDIT');
      544    11514                                                /**/
      545    11515        %VLP_ACCT (FPTN=SYSACCT,
      546    11516                   ACCT=':SYS');
      547    11529                                                /**/
      548    11530        %FPT_LINK (FPTN=LINK_PCL,
      549    11531                       CMD=PCL_CMD,
      550    11532                       NAME=PCL_NAME,
      551    11533                       ACCT=SYSACCT);
      552    11551                                                /**/
      553    11552        %VLP_NAME (FPTN=PCL_NAME,
      554    11553                       NAME='PCL');
      555    11580                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:16   
      556    11581        %FPT_LINK (FPTN=LINK_LIST,
      557    11582                       CMD=LIST_CMD,
      558    11583                       NAME=PCL_NAME,
      559    11584                       ACCT=SYSACCT);
      560    11602                                                /**/
      561    11603        %FPT_OPEN (FPTN=OPEN_TEMP,              /* Used for update function */
      562    11604                       DCB=M$TEMP,
      563    11605                       NAME=TEMP_NAME,
      564    11606                       ACS=SEQUEN,
      565    11607                       ORG=KEYED,
      566    11608                       FUN=CREATE,
      567    11609                       EXIST=NEWFILE,
      568    11610                       ASN=FILE);
      569    11719                                                /**/
      570    11720        %VLP_NAME (FPTN=TEMP_NAME,
      571    11721                       NAME='*GOOSE');
      572    11748                                                /**/
      573    11749        %FPT_OPEN (FPTN=OPEN_S_OUT,             /* Open schedule out */
      574    11750                       DCB=M$SCHED,
      575    11751                       ACS=SEQUEN,
      576    11752                       ORG=CONSEC,
      577    11753                       EXIST=NEWFILE,
      578    11754                       SCRUB=NO,
      579    11755                       ACSVEH=ACS_VEH,
      580    11756                       ACCESS=ACS_ACCT,
      581    11757                       FUN=CREATE);
      582    11866                                                /**/
      583    11867        %FPT_OPEN (FPTN=OPEN_TEMP_IN,
      584    11868                       DCB=M$TEMP,
      585    11869                       SCRUB=NO,
      586    11870                       FUN=IN);
      587    11979                                                /**/
      588    11980        %FPT_CLOSE (FPTN=CLOSE_SCHED_REL,       /* Do not save new schedule file */
      589    11981                    DCB=M$SCHED,
      590    11982                    DISP=RELEASE);
      591    12024                                                /**/
      592    12025        %FPT_READ (FPTN=READ_TEMP,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:17   
      593    12026                       BUF=INBUF,
      594    12027                       DCB=M$TEMP,
      595    12028                       WAIT=YES);
      596    12067                                                /**/
      597    12068        %FPT_CLOSE (FPTN=CLOSE_TEMP,
      598    12069                    DCB=M$TEMP,
      599    12070                    DISP=SAVE);
      600    12112                                                /**/
      601    12113        %FPT_CLOSE (FPTN=CLOSE_TEMP_REL,
      602    12114                    DCB=M$TEMP,
      603    12115                    DISP=RELEASE);
      604    12157                                                /**/
      605    12158        %FPT_WRITE (FPTN=WRITE_TEMP,
      606    12159                       BUF=INBUF,
      607    12160                       DCB=M$TEMP,
      608    12161                       KEY=EDIT_KEY,
      609    12162                       WAIT=YES);
      610    12193                                                /**/
      611    12194        %FPT_WRITE (FPTN=WRITE_SCHED,
      612    12195                       BUF=INBUF,
      613    12196                       DCB=M$SCHED,
      614    12197                       KEY=EDIT_KEY,
      615    12198                       WAIT=YES);
      616    12229                                                /**/
      617    12230        %FPT_GJOB (FPTN=START_GJOB,
      618    12231                       CCBUF=DO_CMD,
      619    12232                       NAME=GJOB_NAME,
      620    12233                       ACCT=GJOB_ACCT,
      621    12234                       RESULTS=GJOB_RESULTS);
      622    12251                                                /**/
      623    12252        %VLP_NAME (FPTN=GJOB_NAME);
      624    12279                                                /**/
      625    12280        %VLP_ACCT (FPTN=GJOB_ACCT);
      626    12293                                                /**/
      627    12294        %VLP_PASS (FPTN=GJOB_PASS);
      628    12307
      629    12308        %VLR_GJOB (FPTN=GJOB_RESULTS);
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:18   
      630    12321                                                /**/
      631    12322        %FPT_OPEN (FPTN=OPEN_TEST,
      632    12323                       DCB=M$SCHED,
      633    12324                       TEST=YES,
      634    12325                       FPARAM=FPARAM);
      635    12434                                                /**/
      636    12435        %CODE04 ;
      637    12443                                                /**/
      638    12444                                                /**/
      639    12445        %FPT_CORRES (FPTN=CHECK_SIUC,
      640    12446                       DCB1=M$SI,
      641    12447                       DCB2=M$UC);
      642    12461                                                /**/
      643    12462        %FPT_PRIV (FPTN=GET_OPRIV,
      644    12463                   AUTH=YES,
      645    12464                   PRIV=%PR_MSYS#);
      646    12479
      647    12480        %FPT_PRIV (FPTN=RESET_FMSEC,
      648    12481                       PRIV=%PR_FMSEC#);
      649    12496                                                /**/
      650    12497        %VLP_NAME (FPTN=HELP_NAME,
      651    12498                       NAME='GOOSE');
      652    12525                                                /**/
      653    12526        %VLP_ACCT (FPTN=HELP_ACCT,
      654    12527                       ACCT=':SYS');
      655    12540                                                /**/
      656    12541        %FPT_INT(FPTN=FPT_INT,
      657    12542                 UENTRY=XUG$BREAK,
      658    12543                 STCLASS=CONSTANT);
      659    12557        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:19   
      660    12558        /* Begin main program */
      661    12559
      662    12560    1        IF B$JIT$ -> B$JIT.SYSID = 10/*JG_GOOSE#   */
             12560                 /* Is this the goose ming ghost?  */
      663    12561    1        THEN
      664    12562    2          DO;                              /* Do ghost main */
      665    12563                                                /**/
      666    12564    3               CALL M$OPEN(OPEN_CSCG) WHENALTRETURN DO; /* Open cscg */
      667    12565    3                      CALL M$XXX;
      668    12566    3                    END;                   /* Whenaltret from M$OPEN  */
      669    12567    2               CALL M$EVENT(DO_EVENT);     /* Set event for read */
      670    12568    2               CALL M$READ(READ_CSCG);     /* Start read */
      671    12569    2               START_UP = %YES#;
      672    12570                                                /**/
      673    12571                                      /* Halt activity until slug gives
      674    12572                                         us the green light (ok to start) */
      675    12573                                                /**/
      676    12574    3               DO WHILE (%YES#);
      677    12575    3                    IF GOOSE_READ_FLAG
      678    12576    3                    THEN
      679    12577    3                         CALL DO$EVENT;
      680    12578    3                    IF GREEN_LIGHT
      681    12579    3                    THEN
      682    12580    3                         GOTO ADJUST_TIME;
      683    12581    3                    ELSE
      684    12582    3                         CALL M$WAIT (FIVE_SECOND);
      685    12583    3                  END;
      686    12584
      687    12585    2   ADJUST_TIME:;
      688    12586                                                /* */
      689    12587    2               CALL M$TIME(GET_CURR);
      690    12588    2               CALL M$TIME (GET_DAY);
      691    12589    2               CALL CHARBIN(CURR_TIME,TEXT_TIME.HR_MIN);
      692    12590    2               CURR_TIME = CURR_TIME / 100 * 60 + MOD(CURR_TIME,100);
      693    12591                                                /**/
      694    12592                                      /* If the time or date was changed
      695    12593                                         from an operators console, and
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:20   
      696    12594                                         goose notices the discrepancy
      697    12595                                         (i.e. if it is > 5 mins) then
      698    12596                                         we have to adjust the time
      699    12597                                         and num of days count accordingly */
      700    12598                                                /**/
      701    12599    2               IF TIME_WARP
      702    12600    2               THEN
      703    12601    3                 DO;
      704    12602    3                      LAST_TIME = -1;
      705    12603    3                      IF (CYCLE_DAYS_LAST = CYCLE_DAYS_CURRENT)
      706    12604    3                           AND
      707    12605    3                           (CURR_TIME_HOLD <= OUR_TIME_ESTIMATE)
      708    12606    3                      THEN
      709    12607    4                        DO;
      710    12608    4                             START_TIME = CURR_TIME;
      711    12609    4                           END;
      712    12610                                                /**/
      713    12611    3                      IF CYCLE_DAYS_LAST < CYCLE_DAYS_CURRENT
      714    12612    3                      THEN
      715    12613    4                        DO;
      716    12614                                           /* Don't muck with the elapsed
      717    12615                                              day tally
      718    12616                               NUM_DAYS = NUM_DAYS + (CYCLE_DAYS_CURRENT - CYCLE_DAYS_LAST);
      719    12617                                           */
      720    12618    4                           END;
      721    12619                                                /**/
      722    12620    3                      IF CYCLE_DAYS_LAST > CYCLE_DAYS_CURRENT
      723    12621    3                      THEN
      724    12622    4                        DO;
      725    12623                                           /* Don't muck with the elapsed
      726    12624                                              day tally
      727    12625                               NUM_DAYS = NUM_DAYS - (CYCLE_DAYS_LAST - CYCLE_DAYS_CURRENT);
      728    12626                                           */
      729    12627    4                             START_TIME = CURR_TIME;
      730    12628    4                           END;
      731    12629                                                /**/
      732    12630    3                      IF NUM_DAYS < 0
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:21   
      733    12631    3                      THEN
      734    12632    4                        DO;
      735    12633    4                             NUM_DAYS = 0;
      736    12634    4                           END;
      737    12635                                                /**/
      738    12636                                      /* Get the current time again so
      739    12637                                         the START_TIME reassigned in this
      740    12638                                         section will preceed the current
      741    12639                                         time, thus filtering out the
      742    12640                                         GOOSE_EGG startup commands. */
      743    12641                                                /**/
      744    12642    3                      CALL M$TIME (GET_CURR);
      745    12643    3                      CALL M$TIME (GET_DAY);
      746    12644    3                      CALL CHARBIN (CURR_TIME,TEXT_TIME.HR_MIN);
      747    12645    3                      CURR_TIME = CURR_TIME / 100 * 60 + MOD(CURR_TIME,100);
      748    12646    3                      IF START_TIME = CURR_TIME
      749    12647    3                      THEN
      750    12648    3                           START_TIME = START_TIME - 1;
      751    12649    3                    END;
      752    12650    2               ELSE
      753    12651    3                 DO;
      754    12652    3                      START_TIME = CURR_TIME;
      755    12653    3                    END;
      756    12654                                                /**/
      757    12655    2               CALL BUILD$TIME;
      758    12656    2               IF START_UP
      759    12657    2               THEN
      760    12658    2                    START_UP = %NO#;
      761    12659    2               TIME_WARP = %NO#;
      762    12660        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:22   
      763    12661                                                /**/
      764    12662                                                /**/
      765    12663                                                /**/
      766    12664                                                /**/
      767    12665    3               DO WHILE (%YES#);           /* Do main loop forever */
      768    12666    3   MAIN_LOOP:       CALL M$TIME (GET_CURR); /* Get current time  */
      769    12667    3                    CALL M$TIME(GET_DAY);
      770    12668    3                    CALL CHARBIN(CURR_TIME,TEXT_TIME.HR_MIN);
      771    12669    3                    CURR_TIME = CURR_TIME / 100 * 60 + MOD(CURR_TIME,100);
      772    12670    3                    CALL TIME_WARP$CHECK;
      773    12671                                                /**/
      774    12672                                      /* Allow 5 minute discrepency between
      775    12673                                         actual wake-up time, & the time goose
      776    12674                                         thinks it is at wake-up */
      777    12675                                                /**/
      778    12676    3                    IF TIME_DIFF > (15 * 60)
      779    12677    3                    THEN
      780    12678    4                      DO;
      781    12679    4                           TIME_WARP = %YES#;
      782    12680    4                           GOTO ADJUST_TIME;
      783    12681    4                         END;
      784    12682                                                /**/
      785    12683    3                    IF LAST_TIME > CURR_TIME /* Check if we went past 23:59 */
      786    12684    3                    THEN
      787    12685    4                      DO;
      788    12686    4                           IF ELAPSED_MINS < 100
      789    12687    4                           THEN
      790    12688    4                                ELAPSED_MINS = ELAPSED_MINS + (1439 - LAST_TIME) +
             12688                                         CURR_TIME;
      791    12689    4                           CALL CHECK$TIME (1439); /* Check until midnight */
      792    12690    4                           LAST_TIME = -1;
      793    12691    4                           NUM_DAYS = NUM_DAYS + 1; /* Been up over a day */
      794    12692    4                           CURR_TIME = 0;
      795    12693    4                           CALL BUILD$TIME; /* Rebuild time for new day */
      796    12694    4                           CALL M$TIME (GET_DAY);
      797    12695    4                         END;
      798    12696    3                    ELSE
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:23   
      799    12697    4                      DO;
      800    12698    4                           IF ELAPSED_MINS < 100 AND LAST_TIME ~= -1
      801    12699    4                           THEN
      802    12700    4                                ELAPSED_MINS = ELAPSED_MINS + (CURR_TIME - LAST_TIME);
      803    12701    4                         END;
      804    12702    3                    CALL CHECK$TIME(CURR_TIME); /* Check for current time */
      805    12703    3                    LAST_TIME = CURR_TIME;
      806    12704    3                    LAST_DATE = TEXT_DATE;
      807    12705                                                /**/
      808    12706                                                /**/
      809    12707                                      /* Get time again because some time
      810    12708                                         has elapsed since the the last
      811    12709                                         M$TIME call. The reason for
      812    12710                                         the elapse is the call to
      813    12711                                         CHECK$TIME */
      814    12712                                                /**/
      815    12713    3                    CALL M$TIME(GET_CURR); /* Get actual time */
      816    12714    3                    CALL M$TIME (GET_DAY);
      817    12715    3                    CALL CHARBIN(CURR_TIME,TEXT_TIME.HR_MIN);
      818    12716    3                    CURR_TIME = CURR_TIME / 100 * 60 + MOD(CURR_TIME,100);
      819    12717                                                /**/
      820    12718                                      /* Set MAIN_WAIT.V.UNITS# to 0 so
      821    12719                                         TIME_WARP$CHECK will check against
      822    12720                                         LAST_TIME. */
      823    12721                                                /**/
      824    12722    3                    MAIN_WAIT.V.UNITS# = 0;
      825    12723    3                    CALL TIME_WARP$CHECK;
      826    12724                                                /**/
      827    12725                                      /* Allow 10 minutes for possible rebuild
      828    12726                                         and execution of scheduled events */
      829    12727                                                /**/
      830    12728    3                    IF TIME_DIFF > (10 * 60)
      831    12729    3                    THEN
      832    12730    4                      DO;
      833    12731    4                           TIME_WARP = %YES#;
      834    12732    4                           GOTO ADJUST_TIME;
      835    12733    4                         END;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:24   
      836    12734                                                /**/
      837    12735                                                /* Check for changes to GOOSE_EGG. */
      838    12736                                      /* This check should follow a time call
      839    12737                                         so the events that were just executed
      840    12738                                         by CHECK$TIME will be filtered out
      841    12739                                         of the new internal time table.  It
      842    12740                                         should also let the code bypass it
      843    12741                                         at midnight so the regular midnight
      844    12742                                         conditions in this loop can process
      845    12743                                         midnight events, and rebuild the
      846    12744                                         internal time table.   */
      847    12745                                                /**/
      848    12746    3                    IF ~ (CURR_TIME < LAST_TIME)
      849    12747    3                    THEN
      850    12748    4                      DO;
      851    12749    4                           CALL M$OPEN (OPEN_TEST) ALTRET (SKIP_TEST);
      852    12750    4                           PTR$ = ADDR (FPARAM);
      853    12751    4                           CALL XSF$LOCCODP (PTR$,4) ALTRET (SKIP_TEST);
      854    12752                                                /* Look for dates */
      855    12753    4                           IF PTR$ -> CODE04.MODIFY.TIME ~= MODIFY_DATE
      856    12754    4                           THEN
      857    12755    5                             DO;
      858    12756    5                                  CALL BUILD$TIME;
      859    12757    5                                  LAST_TIME = CURR_TIME;
      860    12758    5                                  LAST_DATE = TEXT_DATE;
      861    12759    5                                  GOTO MAIN_LOOP;
      862    12760    5                                END;
      863    12761    4                         END;
      864    12762    3   SKIP_TEST:       ;
      865    12763                                                /**/
      866    12764    3                    IF CURR_TIME < LAST_TIME /* Past midnight */
      867    12765    3                    THEN
      868    12766    3                         TIME_LEFT = -1;   /* Override the wait */
      869    12767    3                    ELSE
      870    12768    4                      DO;
      871    12769    4                           CALL CHARBIN(TIME_LEFT,TEXT_TIME.SEC); /* Get seconds */
      872    12770    4                           TIME_LEFT = CURR_TIME * 60 + TIME_LEFT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:25   
             12770                                    /* Seconds from midnight */
      873    12771    4                           IF TIME_HEAD$ = ADDR(NIL) /* No entries left */
      874    12772    4                           THEN
      875    12773    4                                TIME_LEFT = 1440 * 60 - TIME_LEFT;
             12773                                         /* Wait till midnight */
      876    12774    4                           ELSE
      877    12775    4                                TIME_LEFT = TIME_HEAD$ -> TIME_TABLE.TIME * 60 -
             12775                                         TIME_LEFT;
      878    12776    4                           IF TIME_LEFT > 0
      879    12777    4                           THEN
      880    12778    4                                MAIN_WAIT.V.UNITS# = TIME_LEFT;
      881    12779    4                           ELSE
      882    12780    4                                MAIN_WAIT.V.UNITS# = 0;
      883    12781    4                           IF MAIN_WAIT.V.UNITS# > 600 /* Greater than ten minutes */
      884    12782    4                           THEN
      885    12783    4                                MAIN_WAIT.V.UNITS# = 600;
             12783                                         /* Wait a maximum of ten mins */
      886    12784    4                         END;              /* End not past midnight */
      887    12785    4                    DO INHIBIT;            /* No interuptions please */
      888    12786    4                         IF ~GOOSE_READ_FLAG AND TIME_LEFT > 0
      889    12787    4                         THEN
      890    12788    5                           DO;
      891    12789    5                                IF ELAPSED_MINS < 100
      892    12790    5                                THEN
      893    12791    5                                     ELAPSED_MINS = ELAPSED_MINS + (CURR_TIME -
             12791                                              LAST_TIME);
      894    12792    5                                LAST_TIME = CURR_TIME;
      895    12793    5                                LAST_DATE = TEXT_DATE;
      896    12794    5                                CALL M$WAIT(MAIN_WAIT); /* Wait till next item */
      897    12795    5                              END;
      898    12796    4                       END;                /* End inhibit */
      899    12797    3                    IF GOOSE_READ_FLAG
      900    12798    3                    THEN
      901    12799    3                         CALL DO$EVENT;    /* Process event on cscg */
      902    12800    3                  END;                     /* Main loop end */
      903    12801    2             END;                          /* End do ghost */
      904    12802        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:26   
      905    12803    1        ELSE
      906    12804    1   DO_ONLINE:;
      907    12805    2        DO;                                /* Do online main program */
      908    12806    2             REMEMBER DO_ONLINE IN ABORT_CMD;
      909    12807    2             CALL M$TIME (GET_CURR);
      910    12808                                           /* This handles the online goose commands */
      911    12809    2             CALL M$RPRIV (RESET_FMSEC);
      912    12810                                                /**/
      913    12811    2             CALL M$INT (FPT_INT);
      914    12812    2             ONLINE_GETCMD.NODES$ = ADDR(GOOSE_ONODES2);
      915    12813
      916    12814        /*        If (B$JIT$ -> B$JIT.PRIV.ACTIVE & %PR_MSYS#) ~= %PR_MSYS#  */
      917    12815        /*        Then do;                      {* msys priv not active */
      918    12816
      919    12817    2             CALL M$SPRIV (GET_OPRIV)
      920    12818    3             WHENRETURN DO;
      921    12819    3                    ONLINE_GETCMD.NODES$ = ADDR(GOOSE_ONODES);
      922    12820    3                  END;                     /* Whenreturn */
      923    12821        /*             End;                     {* If msys priv is not active */
      924    12822
      925    12823    2             ON_LINE = %YES#;              /* Set on line flag */
      926    12824    2             CALL CONCAT(MESS_BUF,'Goose ',ADDR(B_VERSION)->
      927    12825    2                  B$VERSIONB.T_,' here');
      928    12826    2             CALL M$WRITE(OUT_MESS);       /* Say hello */
      929    12827    2             REMEMBER MAIN_OLOOP IN ABORT_CMD;
      930    12828    3             DO WHILE (%YES#);             /* Main command loop */
      931    12829    3   MAIN_OLOOP:    ;
      932    12830                                                /**/
      933    12831                                                /**/
      934    12832                                                /**/
      935    12833                                      /* This section sets up and has the
      936    12834                                         parsing done by the XUG$ library
      937    12835                                         services.  It then continues on
      938    12836                                         to process the individual commands.
      939    12837                                      */
      940    12838                                                /**/
      941    12839    3                  CALL XUG$INIT (ONLINE_GETCMD, ONLINE_INIT)
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:27   
      942    12840    4                  WHENALTRETURN DO;        /* we bombed out */
      943    12841    4                         CALL IAE$ONLINE_ERROR (0,ONLINE_GETCMD.ERR#);
      944    12842    4                         CALL M$XXX;
      945    12843    4                       END;                /* Whenaltreturn */
      946    12844    3                  REMEMBER READ_OLOOP IN ABORT_CMD;
      947    12845    3   READ_OLOOP:    ;
      948    12846    3                  CALL XUG$GETCMD (ONLINE_GETCMD)
      949    12847    4                  WHENALTRETURN DO;
      950    12848    4                         IF ONLINE_GETCMD.ERR#.CODE# = %E$EOF THEN
      951    12849    4                              GOTO CHECK_END;
      952    12850    5                         ELSE DO;
      953    12851    5                                CALL IAE$ONLINE_ERROR (0,ONLINE_GETCMD.ERR#);
      954    12852    5                                IF ONLINE_GETCMD.ERR#.CODE# = %E$NOFILE THEN
      955    12853    5                                     CALL M$XXX;
      956    12854    5                                ELSE
      957    12855    5                                     GOTO READ_OLOOP;
      958    12856    5                              END;         /*  Not eof  */
      959    12857    4                       END;                /* Whenaltreturn */
      960    12858
      961    12859    4                  DO CASE (ONLINE_GETCMD.OUT$ -> OUT$BLK.CODE);
      962    12860                                                /**/
      963    12861                                                /**/
      964    12862    4                  CASE (%IA_CMD_LIST#);    /* List command */
      965    12863    5                     CALL M$LINK(LINK_LIST) WHENALTRETURN DO; END;
      966    12864
      967    12865    4                  CASE (%IA_CMD_EVAL#);
      968    12866    4                     GOOSE_OUT$ = ONLINE_GETCMD.OUT$;
      969    12867    4                     CALL IAD$DATE
      970    12868    5                     WHENALTRETURN DO;
      971    12869    5                            CALL IAE$ONLINE_ERROR (%E$IA_DATE_ERR#,0);
      972    12870    5                          END;             /*  Whenaltreturn */
      973    12871                                                /**/
      974    12872    4                  CASE (%IA_CMD_END#);     /* All done */
      975    12873    4   CHECK_END:        ;
      976    12874    4                     CALL M$EXIT;          /* Good bye */
      977    12875                                                /**/
      978    12876                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:28   
      979    12877    4                  CASE (%IA_CMD_GJOB#);
      980    12878    4                     DO_CMD = ' ';
      981    12879    4                     GJOB_ACCT.ACCT# = B$JIT$ -> B$JIT.ACCN;
      982    12880    4                     START_GJOB.CCBUF_ = VECTOR (NIL);
      983    12881    4                     DO_ACCT = ' ';
      984    12882    4                     DO_PASS = ' ';
      985    12883    4                     DO_FID.SIZE = 0;
      986    12884
      987    12885    4                     IF ONLINE_GETCMD.OUT$ -> OUT$BLK.NSUBLKS > 0
      988    12886    4                     THEN
      989    12887    5                       DO I = 0 TO ONLINE_GETCMD.OUT$ -> OUT$BLK.NSUBLKS - 1;
      990    12888
      991    12889    5                            PTR$ = ONLINE_GETCMD.OUT$ -> OUT$BLK.SUBLK$(I);
      992    12890
      993    12891
      994    12892    6                            DO CASE (PTR$ -> OUT$BLK.CODE);
      995    12893
      996    12894    6                            CASE (%IA_GKEY_UNAME#);
      997    12895    6                               DO_FID.TEXT = PTR$ -> OUT$SYM.TEXT;
      998    12896    6                               DO_FID.SIZE = PTR$ -> OUT$SYM.COUNT;
      999    12897
     1000    12898    6                            CASE (%IA_GKEY_ACCT#); /* Account specified */
     1001    12899    6                               DO_ACCT = PTR$ -> OUT$SYM.TEXT;
     1002    12900                                                /**/
     1003    12901    6                            CASE (%IA_GKEY_PASS#);
     1004    12902    6                               DO_PASS = PTR$ -> OUT$SYM.TEXT;
     1005    12903
     1006    12904    6                            CASE (%IA_GKEY_CMD#);
     1007    12905    6                               DO_CMD = PTR$ -> OUT$SYM.TEXT;
     1008    12906
     1009    12907    6                            END;           /* End cases */
     1010    12908    5                          END;             /* End do i */
     1011    12909
     1012    12910
     1013    12911    4                     DO_TYPE = %IA_CMD_START#;
     1014    12912    4                     CALL DO$COMMAND(DO_FID, DO_CMD, DO_TYPE, 0, DO_ACCT, DO_PASS);
     1015    12913                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:29   
     1016    12914                                                /**/
     1017    12915    4                  CASE (%IA_CMD_GOOSEON#); /* Want to turn goose on */
     1018    12916    4                     CALL M$OPEN(OPEN_OCSCG) ALTRET(NO_CAN_DO);
     1019    12917    4                     CALL M$WRITE(GOOSE_ON_WR) ALTRET(NO_CAN_DO_1);
     1020    12918    4                     CALL M$CLOSE(CLOSE_OCSCG);
     1021    12919    4                     CALL IAE$ONLINE_ERROR (%E$IA_SCHED_ON#,0);
     1022    12920                                                /**/
     1023    12921                                                /**/
     1024    12922    4                  CASE (%IA_CMD_GOOSEOFF#); /* Want to turn goose off */
     1025    12923    4                     CALL M$OPEN(OPEN_OCSCG) ALTRET(NO_CAN_DO);
     1026    12924    4                     CALL M$WRITE(GOOSE_OFF) ALTRET(NO_CAN_DO_1);
     1027    12925    4                     CALL M$CLOSE(CLOSE_OCSCG);
     1028    12926    4                     CALL IAE$ONLINE_ERROR (%E$IA_SCHED_OFF#,0);
     1029    12927                                                /**/
     1030    12928                                                /**/
     1031    12929                                                /**/
     1032    12930    4                  CASE (%IA_CMD_GOOSEMON#); /* Want to turn goose on */
     1033    12931    4                     CALL M$OPEN(OPEN_OCSCG) ALTRET(NO_CAN_DO);
     1034    12932    4                     CALL M$WRITE(GOOSEM_ON_WR) ALTRET(NO_CAN_DO_1);
     1035    12933    4                     CALL M$CLOSE(CLOSE_OCSCG);
     1036    12934    4                     CALL IAE$ONLINE_ERROR (%E$IA_SCHED_MSG_ON#,0);
     1037    12935                                                /**/
     1038    12936                                                /**/
     1039    12937    4                  CASE (%IA_CMD_GOOSEMOFF#); /* Want to turn goose off */
     1040    12938    4                     CALL M$OPEN(OPEN_OCSCG) ALTRET(NO_CAN_DO);
     1041    12939    4                     CALL M$WRITE(GOOSEM_OFF) ALTRET(NO_CAN_DO_1);
     1042    12940    4                     CALL M$CLOSE(CLOSE_OCSCG);
     1043    12941    4                     CALL IAE$ONLINE_ERROR (%E$IA_SCHED_MSG_OFF#,0);
     1044    12942                                                /**/
     1045    12943                                                /**/
     1046    12944    4                  CASE (%IA_CMD_GOOSEUPD#); /* Goose egg updated */
     1047    12945    4                     CALL M$OPEN(OPEN_OCSCG) ALTRET(NO_CAN_DO);
     1048    12946    4   GOOSE_UPDATE:     ;
     1049    12947    4                     CALL M$WRITE(WGOOSE_UPD) ALTRET(NO_CAN_DO_1);
     1050    12948    4                     CALL M$CLOSE(CLOSE_OCSCG);
     1051    12949    4                     CALL IAE$ONLINE_ERROR (%E$IA_SCHED_UPD#,0);
     1052    12950                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:30   
     1053    12951                                                /**/
     1054    12952                            /*  The next section of code will allow the user to
     1055    12953                                 update the GOOSE_EGG file. The first thing
     1056    12954                                 done is copying the file to a star file for
     1057    12955                                 the user to update and then linking to edit
     1058    12956                                 for the user to do the actual updating. On
     1059    12957                                 return the program parses all the commands in
     1060    12958                                 the file and if there are syntax errors the
     1061    12959                                 user is asked if he would like to update it
     1062    12960                                 again. If there are no errors the file is
     1063    12961                                 copied over GOOSE_EGG */
     1064    12962                                                /**/
     1065    12963                                                /**/
     1066    12964    4                  CASE (%IA_CMD_UPDATE#);  /* Wants to update goose egg */
     1067    12965    4                     REMEMBER CLOSE_FILES IN ABORT_CMD;
     1068    12966    4                     CALL M$OPEN(OPEN_OCSCG) ALTRET(NO_CAN_DO); /* Locks other users */
     1069    12967    4                     CALL M$OPEN(OPEN_S)
     1070    12968    5                     WHENALTRETURN DO;
     1071    12969    5                            ERROR = %SYSTEM_ERROR;
     1072    12970    5                            CALL IAE$ONLINE_ERROR (%E$IA_EGG_OPEN_ERR#, ERROR);
     1073    12971    5                            GOTO READ_OLOOP;
     1074    12972    5                          END;             /* Whenaltreturn */
     1075    12973    4                     CALL M$OPEN(OPEN_TEMP)
     1076    12974    5                     WHENALTRETURN DO;
     1077    12975    5                            ERROR = %SYSTEM_ERROR;
     1078    12976    5                            CALL IAE$ONLINE_ERROR (%E$IA_TEMP_OPEN_ERR#, ERROR);
     1079    12977    5                            CALL M$CLOSE (CLOSE_S);
     1080    12978    5                            GOTO READ_OLOOP;
     1081    12979    5                          END;             /* Whenaltreturn */
     1082    12980    4                     EDIT_KEY.NUM = 0;
     1083    12981                                                /**/
     1084    12982                                                /**/
     1085    12983    5   COPY_FILE:        DO WHILE (%YES#);     /* Copy file */
     1086    12984    5                          CALL M$READ(READ_S)
     1087    12985    6                          WHENALTRETURN DO;
     1088    12986    6                                 GOOSE_ERROR = %E$IA_EGG_RD_ERR#;
     1089    12987    6                                 EXIT COPY_FILE;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:31   
     1090    12988    6                               END;        /* Whenaltreturn */
     1091    12989    5                          WRITE_TEMP.BUF_.BOUND = DCBADDR(DCBNUM(M$SCHED)) -> F$DCB.ARS
             12989                                   - 1;
     1092    12990    5                          EDIT_KEY.NUM = EDIT_KEY.NUM + 1000;
     1093    12991    5                          CALL M$WRITE(WRITE_TEMP)
     1094    12992    6                          WHENALTRETURN DO;
     1095    12993    6                                 GOOSE_ERROR = %E$IA_TEMP_WR_ERR#;
     1096    12994    6                                 EXIT COPY_FILE;
     1097    12995    6                               END;        /* Whenaltreturn */
     1098    12996    5                        END COPY_FILE;     /* End copying forever */
     1099    12997                                                /**/
     1100    12998                                                /**/
     1101    12999    4                     ERROR = %SYSTEM_ERROR;
     1102    13000    4                     CALL M$CLOSE (CLOSE_S);
     1103    13001    4                     CALL M$CLOSE (CLOSE_TEMP);
     1104    13002    4                     IF ERROR.ERR# ~= %E$EOF
     1105    13003    5                     THEN DO;
     1106    13004    5                            CALL IAE$ONLINE_ERROR (GOOSE_ERROR, ERROR);
     1107    13005    5                            CALL M$CLOSE (CLOSE_OCSCG);
     1108    13006    5                            GOTO READ_OLOOP;
     1109    13007    5                          END;             /* Error not eof */
     1110    13008                                                /**/
     1111    13009                                                /**/
     1112    13010                                                /**/
     1113    13011    4   EDIT_AGAIN:       ;
     1114    13012    4                     CALL M$LINK(LINK_EDIT)
     1115    13013    5                     WHENALTRETURN DO;
     1116    13014    5                            ERROR = %SYSTEM_ERROR;
     1117    13015    5                            CALL IAE$ONLINE_ERROR (%E$IA_LINK_ERR#,ERROR);
     1118    13016    5                            CALL M$CLOSE(CLOSE_OCSCG);
     1119    13017    5                            GOTO READ_OLOOP;
     1120    13018    5                          END;             /* whenaltreturn */
     1121    13019                                      /* Now we must check the file he just edited */
     1122    13020    4                     ERROR_FLAG = %NO#;    /* No error flag */
     1123    13021    4                     CALL M$SPRIV (RESET_FMSEC);
     1124    13022    4                     CALL M$OPEN (OPEN_S_OUT)
     1125    13023    5                     WHENALTRETURN DO;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:32   
     1126    13024    5                            ERROR = %SYSTEM_ERROR;
     1127    13025    5                            CALL IAE$ONLINE_ERROR (%E$IA_EGG_OPEN_ERR#, ERROR);
     1128    13026    5                            GOTO READ_OLOOP;
     1129    13027    5                          END;             /*  Whenaltreturn */
     1130    13028    4                     CALL M$RPRIV (RESET_FMSEC);
     1131    13029    4                     CALL M$OPEN(OPEN_TEMP_IN)
     1132    13030    5                     WHENALTRETURN DO;
     1133    13031    5                            ERROR = %SYSTEM_ERROR;
     1134    13032    5                            CALL IAE$ONLINE_ERROR (%E$IA_TEMP_OPEN_ERR#, ERROR);
     1135    13033    5                            CALL M$CLOSE (CLOSE_S);
     1136    13034    5                            GOTO READ_OLOOP;
     1137    13035    5                          END;             /* Whenaltreturn */
     1138    13036                                                /**/
     1139    13037        /* setup for XUG$ to read and parse the temporary GOOSE_EGG.
     1140    13038           call PARSE$COMMAND which calls XUG$ and does any necessary
     1141    13039           error reporting.
     1142    13040           Upon return from PARSE$COMMAND, if no error, echo the command
     1143    13041           to the permanent GOOSE_EGG, and contine processing.
     1144    13042           If the error was a syntax error continue processing.
     1145    13043           If any other type of error, quit processing the file.
     1146    13044        */
     1147    13045    4                     EGG_GETCMD.INDCB# = DCBNUM ( M$TEMP );
     1148    13046    4                     CALL XUG$INIT (EGG_GETCMD, UPDATE_INIT)
     1149    13047    5                     WHENALTRETURN DO;     /* we bombed out */
     1150    13048    5                            CALL IAE$ONLINE_ERROR (0,ONLINE_GETCMD.ERR#);
     1151    13049    5                            GOTO MAIN_OLOOP;
     1152    13050    5                          END;             /* Whenaltreturn */
     1153    13051
     1154    13052    4                     EDIT_KEY.NUM = 0;
     1155    13053    4                     XUG$ = UPDATE_INIT.PARAMS$;
     1156    13054
     1157    13055    5                     DO WHILE (%YES#);     /* do forever */
     1158    13056    5   READ_TEMP_LP:          ;
     1159    13057    5                          CALL PARSE$COMMAND
     1160    13058    6                          WHENRETURN DO;
     1161    13059    6                                 TEMP$ = VBASE(XUG.BUFVEC);
     1162    13060    6                                 RLT$ = VBASE(XUG.RLTVEC);
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:33   
     1163    13061
     1164    13062    7                                 DO I = 1 TO XUG.NLINES;
     1165    13063    7                                      SUBSTR(INBUF, 0, RLT(I)) = SUBSTR (TEMP$->
             13063                                               CMD_BUFFER,0,RLT(I));
     1166    13064    7                                      WRITE_SCHED.BUF_.BOUND = RLT(I) - 1;
     1167    13065    7                                      IF I ~= XUG.NLINES
     1168    13066    8                                      THEN DO;
     1169    13067    8                                             SUBSTR(INBUF, RLT(I)-1,1) = ';';
     1170    13068    8                                           END;
     1171    13069    7                                      EDIT_KEY.NUM = EDIT_KEY.NUM + 1000;
     1172    13070    8                                      CALL M$WRITE (WRITE_SCHED) WHENALTRETURN DO;
     1173    13071    8                                             ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     1174    13072    8                                             CALL IAE$ONLINE_ERROR (%E$IA_EGG_WR_ERR#,
             13072                                                      ERROR);
     1175    13073    8                                             GOTO CLOSE_REL_S_AND_TEMP;
     1176    13074    8                                           END; /* Whenaltreturn from M$WRITE */
     1177    13075    7                                      TEMP$ = PINCRC(TEMP$,RLT(I));
     1178    13076    7                                    END;
     1179    13077
     1180    13078    6                               END;        /* Whenreturn from PARSE$COMMAND */
     1181    13079    6                          WHENALTRETURN DO;
     1182    13080    6                                 IF ERROR.ERR# = %E$EOF
     1183    13081    7                                 THEN DO;
     1184    13082    7                                        IF ERROR_FLAG /* See if there was an error */
     1185    13083    8                                        THEN DO;
     1186    13084    9                                               DO WHILE (%YES#);
     1187    13085    9                                                    CALL IAE$ONLINE_ERROR (%E$IA_EDIT#,
             13085                                                             0);
     1188    13086    9                                                    INBUF = '  ';
     1189    13087    9                                                    CALL M$READ(READ_SI) ALTRET(
             13087                                                             CHECK_END);
     1190    13088    9                                                    IF INBUF = 'YES'
     1191    13089   10                                                    THEN DO;
     1192    13090   10                                                           CALL M$CLOSE(CLOSE_SCHED_REL
             13090                                                                    );
     1193    13091   10                                                           CALL M$CLOSE(CLOSE_TEMP);
     1194    13092   10                                                           GOTO EDIT_AGAIN;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:34   
     1195    13093   10                                                         END; /*  buf = yes */
     1196    13094    9                                                    IF INBUF = 'NO'
     1197    13095    9                                                    THEN
     1198    13096    9                                                         GOTO CLOSE_REL_S_AND_TEMP;
     1199    13097    9                                                  END; /* End while forever */
     1200    13098    8                                             END; /*  if error_flag  */
     1201    13099    8                                        ELSE DO;
     1202    13100    8                                               CALL M$CLOSE (CLOSE_S);
     1203    13101    8                                               CALL M$CLOSE(CLOSE_TEMP_REL);
     1204    13102    8                                               CALL M$LINK (LINK_PCL);
     1205    13103    8                                               CALL IAE$ONLINE_ERROR(%E$IA_EGG_UPD#,0);
     1206    13104    8                                               GOTO GOOSE_UPDATE;
     1207    13105    8                                             END; /* Else ERROR_FLAG */
     1208    13106    7                                      END; /* If E$EOF */
     1209    13107    6                                 ELSE IF ERROR.ERR# = %E$SYNERR /* Syntax error */
     1210    13108    7                                      THEN DO;
     1211    13109    7                                             ERROR_FLAG = %YES#;
     1212    13110    7                                             EGG_GETCMD.DCB_PARAM# = DCBNUM ( M$LO );
     1213    13111    7                                             EGG_GETCMD.DCB2_PARAM# = DCBNUM ( M$DO );
     1214    13112    7                                             CALL XUG$ECHOIF (EGG_GETCMD);
     1215    13113    7                                             IF NOT EGG_GETCMD.CONTINUED# THEN
     1216    13114    7                                                  CALL XUG$ERRPTR (EGG_GETCMD);
     1217    13115    7                                           END; /* error is syntax */
     1218    13116    7                                      ELSE DO;
     1219    13117    7                                             GOTO CLOSE_REL_S_AND_TEMP;
     1220    13118    7                                           END; /* Else error ~ syntax */
     1221    13119    6                               END;        /*  Whenaltreturn  */
     1222    13120    5                        END;               /* do forever */
     1223    13121                                                /**/
     1224    13122                                                /**/
     1225    13123    4                  END;                     /* Do case OUT$BLK.CODE */
     1226    13124    3                END;                       /* Do forever READ_OLOOP */
     1227    13125    2           END;                            /* Else do ON_LINE */
     1228    13126    1   NO_CAN_DO_1: ;
     1229    13127    1        CALL M$CLOSE(CLOSE_OCSCG);         /* Close cscg */
     1230    13128    1   NO_CAN_DO: ;
     1231    13129    1        ERROR = %SYSTEM_ERROR;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:35   
     1232    13130    1        CALL IAE$ONLINE_ERROR (0,ERROR);
     1233    13131    1        GOTO READ_OLOOP;
     1234    13132                                                /**/
     1235    13133                                                /**/
     1236    13134    1   CLOSE_REL_S_AND_TEMP:
     1237    13135    1        CLOSE_S.V.DISP# = %RELEASE#;
     1238    13136    1   CLOSE_REL_TEMP:
     1239    13137    1        CLOSE_TEMP.V.DISP# = %RELEASE#;
     1240    13138    1   CLOSE_FILES:
     1241    13139    1        CALL M$CLOSE (CLOSE_OCSCG);
     1242    13140    1        CALL M$CLOSE (CLOSE_TEMP);
     1243    13141    1        CALL M$CLOSE (CLOSE_S);
     1244    13142    1        CLOSE_S.V.DISP# = %SAVE#;
     1245    13143    1        CLOSE_TEMP.V.DISP# = %SAVE#;
     1246    13144    1        GOTO MAIN_OLOOP;
     1247    13145                                                /**/
     1248    13146                                                /**/
     1249    13147        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:36   
     1250    13148        /*I*      NAME: TIME_WARP$CHECK
     1251    13149                  PURPOSE: Checks radical time differences.
     1252    13150                  CALL: CALL TIME_WARP$CHECK;
     1253    13151                  DESCRIPTION: If an operator issues a TIME or DATE
     1254    13152                               keyin, GOOSE must check to
     1255    13153                               determine if the time change will
     1256    13154                               require a call to BUILD$TIME.
     1257    13155                                      */
     1258    13156    1   TIME_WARP$CHECK: PROC;
     1259    13157                                                /**/
     1260    13158    2        IF LAST_TIME = -1
     1261    13159    2        THEN
     1262    13160    3          DO;
     1263    13161    3               TIME_DIFF = 0;
     1264    13162    3               RETURN;
     1265    13163    3             END;
     1266    13164                                                /**/
     1267    13165                                      /* OUR_TIME_ESTIMATE represents
     1268    13166                                         (in minutes) where we think
     1269    13167                                         we should be. */
     1270    13168    2        OUR_TIME_ESTIMATE = (LAST_TIME * 60) + MAIN_WAIT.V.UNITS#;
     1271    13169                                                /**/
     1272    13170    2        CALL CHARBIN (TEMP_SEC, TEXT_TIME.SEC);
     1273    13171    2        CURR_TIME_HOLD = TEMP_SEC + (CURR_TIME * 60);
     1274    13172                                                /**/
     1275    13173    2        CALL CHARBIN (TEMP_YEARS, TEXT_DATE.YR);
     1276    13174    2        CALL CHARBIN (TEMP_MONTHS, TEXT_DATE.MON);
     1277    13175    2        CALL CHARBIN (TEMP_DAYS, TEXT_DATE.DAY);
     1278    13176    2        IF TEMP_YEARS >= 78                /* Range 1978 - 1999, 2000 - 20?? */
     1279    13177    2        THEN
     1280    13178    2             TEMP_YEARS = TEMP_YEARS + 1900;
     1281    13179    2        ELSE
     1282    13180    2             TEMP_YEARS = TEMP_YEARS + 2000;
     1283    13181    2        CALL IAM$LEAP;
     1284    13182    2        CALL IAM$CYCLE;
     1285    13183    2        CYCLE_DAYS_CURRENT = TOTAL_DAYS;
     1286    13184                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:37   
     1287    13185    2        CALL CHARBIN (TEMP_YEARS, LAST_DATE.YR);
     1288    13186    2        CALL CHARBIN (TEMP_MONTHS, LAST_DATE.MON);
     1289    13187    2        CALL CHARBIN (TEMP_DAYS, LAST_DATE.DAY);
     1290    13188    2        IF TEMP_YEARS >= 78                /* Range 1978 - 1999, 2000 - 20?? */
     1291    13189    2        THEN
     1292    13190    2             TEMP_YEARS = TEMP_YEARS + 1900;
     1293    13191    2        ELSE
     1294    13192    2             TEMP_YEARS = TEMP_YEARS + 2000;
     1295    13193    2        CALL IAM$LEAP;
     1296    13194    2        CALL IAM$CYCLE;
     1297    13195    2        CYCLE_DAYS_LAST = TOTAL_DAYS;
     1298    13196                                                /**/
     1299    13197    2        IF CYCLE_DAYS_LAST = CYCLE_DAYS_CURRENT
     1300    13198    2        THEN
     1301    13199    3          DO;
     1302    13200    3               IF CURR_TIME_HOLD < OUR_TIME_ESTIMATE
     1303    13201    3               THEN
     1304    13202    4                 DO;
     1305    13203    4                      TIME_DIFF = OUR_TIME_ESTIMATE - CURR_TIME_HOLD;
     1306    13204    4                    END;
     1307    13205    3               ELSE
     1308    13206    4                 DO;
     1309    13207    4                      TIME_DIFF = CURR_TIME_HOLD - OUR_TIME_ESTIMATE;
     1310    13208    4                    END;
     1311    13209    3             END;
     1312    13210    2        ELSE
     1313    13211    3          DO;
     1314    13212    3               IF CYCLE_DAYS_LAST < CYCLE_DAYS_CURRENT
     1315    13213    3               THEN
     1316    13214    4                 DO;
     1317    13215    4                      TIME_DIFF = ((1440 * 60) - OUR_TIME_ESTIMATE)
     1318    13216    4                           + CURR_TIME_HOLD
     1319    13217    4                           + (((CYCLE_DAYS_CURRENT - CYCLE_DAYS_LAST) - 1) * (1440 * 60
             13217                                    ));
     1320    13218    4                    END;
     1321    13219    3               ELSE
     1322    13220    4                 DO;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:38   
     1323    13221    4                      TIME_DIFF = ((1440 * 60) - CURR_TIME_HOLD)
     1324    13222    4                           + OUR_TIME_ESTIMATE
     1325    13223    4                           + (((CYCLE_DAYS_LAST - CYCLE_DAYS_CURRENT) - 1) * (1440 * 60
             13223                                    ));
     1326    13224    4                    END;
     1327    13225    3             END;
     1328    13226                                                /**/
     1329    13227    2   END TIME_WARP$CHECK;
     1330    13228        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:39   
     1331    13229        /*I*      NAME: CHECK$TIME
     1332    13230                  PURPOSE: Checks the time table to see if there is anything to be done.
     1333    13231                  CALL: CALL CHECK$TIME(TIME);
     1334    13232                  DATA: TIME is the time to check in minutes since  midnight
     1335    13233                  DESCRIPTION: This routine will go through the time table
     1336    13234                                 checking each entry to see if it is time
     1337    13235                                 to do it. If it is time it will call DO$COMMAND
     1338    13236                                 to actually do it and then delink the entry.
     1339    13237                             */
     1340    13238    1   CHECK$TIME: PROC(TIME);                      /* Routine to check entries
     1341    13239                                                        to see if is their time */
     1342    13240    2   DCL TIME UBIN WORD;                     /* Time to check against */
     1343    13241                                                /**/
     1344    13242    2        TIME_ENTRY$ = TIME_HEAD$;          /* Point entry to current */
     1345    13243    2        IF TIME_ENTRY$ = ADDR(NIL)         /* No time yet */
     1346    13244    2        THEN
     1347    13245    2             RETURN;
     1348    13246    3        DO WHILE (TIME_ENTRY$ ~= ADDR(NIL)); /* Do until end of chain */
     1349    13247    3             IF TIME_TABLE.TIME <= TIME    /* Time to do it */
     1350    13248    3             THEN
     1351    13249    4               DO;
     1352    13250    4                    IF GOOSE_ON
     1353    13251    4                    THEN
     1354    13252    4                         CALL DO$COMMAND (TIME_TABLE.GHOST_FID,TIME_TABLE.COMMAND,
     1355    13253    4                              TIME_TABLE.TYPE,TIME_TABLE.SIZE,TIME_TABLE.ACCT,
             13253                                       TIME_TABLE.PASS);
     1356    13254    4                    TIME_HEAD$ = TIME_TABLE.NEXT$; /* Clear entry */
     1357    13255    4                    TIME_ENTRY$ = TIME_HEAD$;
     1358    13256    4                  END;                     /* End time to do */
     1359    13257    3             ELSE
     1360    13258    3                  RETURN;                  /* All done */
     1361    13259    3           END;                            /* End forever */
     1362    13260    2   END CHECK$TIME;
     1363    13261        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:40   
     1364    13262        /*I*      NAME: BUILD$TIME
     1365    13263                  PURPOSE: Builds the time table
     1366    13264                  CALL: CALL BUILD$TIME
     1367    13265                  DESCRIPTION: This routine opens the GOOSE_EGG file and
     1368    13266                                then calls XUG$INIT, and PARSE$COMMAND.
     1369    13267                                PARSE$COMMAND calls XUG$GETCMD to read
     1370    13268                                and parse the commands in the GOOSE_EGG.
     1371    13269                                It also sets the 'DO_ ' variables used
     1372    13270                                here and elsewhere.  Upon return from
     1373    13271                               PARSE$COMMAND, this routine calls MAKE$ENTRY
     1374    13272                               with the times that the current command
     1375    13273                               is to be executed.  Upon altreturn from
     1376    13274                               PARSE$COMMAND this routine checks the error.
     1377    13275                               If the error was EOF it quits.  If the
     1378    13276                               error was a syntax error, it continues
     1379    13277                               processing.  Any other error causes the
     1380    13278                               GOOSE_EGG to be closed and a return to
     1381    13279                               be taken.
     1382    13280                                 */
     1383    13281    1   BUILD$TIME: PROC;             /* Routine to build the internal time table */
     1384    13282                                                /**/
     1385    13283    2   DCL I SBIN WORD;
     1386    13284    2   DCL J SBIN WORD;
     1387    13285    2   DCL TIME SBIN WORD;
     1388    13286    2   DCL DUMP_TABLE BIT(1);
     1389    13287    2   DCL TEMP_TIME  CHAR(6);
     1390    13288    2   DCL OUTBUF     CHAR(80);
     1391    13289    2   DCL BUF_START  SBIN;
     1392    13290    2   DCL NO_GHOST   CHAR(12)  CONSTANT INIT ('NO GHOST FID');
     1393    13291
     1394    13292        %FPT_OPEN (FPTN = GOOSE_TABLE_OPEN,
     1395    13293                   DCB  = M$TABLE,
     1396    13294                   CTG  = YES,
     1397    13295                   NAME = GOOSE_TABLE,
     1398    13296                   FUN  = CREATE,
     1399    13297                   DISP = NAMED,
     1400    13298                   ORG  = CONSEC,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:41   
     1401    13299                   ACS  = SEQUEN,
     1402    13300                   ACCT = SYSACCT,
     1403    13301                   ASN  = FILE,
     1404    13302                   EXIST= NEWFILE);
     1405    13411
     1406    13412        %FPT_CLOSE (FPTN = GOOSE_TABLE_CLOSE,
     1407    13413                    DCB  = M$TABLE,
     1408    13414                    NAME = GOOSE_TABLE);
     1409    13456
     1410    13457        %FPT_WRITE (FPTN = GOOSE_TABLE_WRITE,
     1411    13458                    DCB  = M$TABLE);
     1412    13489
     1413    13490        %VLP_NAME (FPTN = GOOSE_TABLE,
     1414    13491                   NAME = 'GOOSE_TABLE');
     1415    13518
     1416    13519                                                /**/
     1417    13520                                                /**/
     1418    13521    2        DUMP_TABLE = %NO#;
     1419    13522    2        TIME_HEAD$ = ADDR(NIL);
     1420    13523    2        FREE_DATA.V.SEGSIZE# = (SEG_VLP.W1.VSIZE# + 1 ) / 4;
     1421    13524    2        CALL M$FDS (FREE_DATA) ;           /* Free data */
     1422    13525    2   TRY_OPEN:;
     1423    13526    2        CALL M$OPEN (OPEN_S)               /* Open schedule */
     1424    13527    3        WHENALTRETURN DO;
     1425    13528    3               ERROR = %SYSTEM_ERROR;
     1426    13529    3               IF ERROR.ERR# = %E$FILEBUSY /* Someone is updating it */
     1427    13530    4               THEN DO;
     1428    13531    4                      CALL M$WAIT(FIVE_SECOND);
     1429    13532    4                      GOTO TRY_OPEN;
     1430    13533    4                    END;                   /*  Error = file busy  */
     1431    13534    3               IF ERROR.ERR# = %E$NOFILE   /* File does not exist */
     1432    13535    4               THEN DO;
     1433    13536    4                      CALL M$SPRIV (RESET_FMSEC);
     1434    13537    4                      CALL M$OPEN(CREATE_EGG)
     1435    13538    5                      WHENRETURN DO;
     1436    13539    5                             CALL M$RPRIV (RESET_FMSEC);
     1437    13540    5                             CALL M$CLOSE(CLOSE_S)
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:42   
     1438    13541    6                             WHENRETURN DO;
     1439    13542    6                                    CALL M$RETRY; /* Should work now */
     1440    13543    6                                  END;     /*  Whenreturn on M$CLOSE  */
     1441    13544    5                           END;            /*  Whenreturn on M$OPEN (2)  */
     1442    13545    4                      CALL M$RPRIV (RESET_FMSEC);
     1443    13546    4                      ERROR = %SYSTEM_ERROR;
     1444    13547    4                    END;                   /*  Error = nofile  */
     1445    13548    3               CALL IAE$CSCG_ERROR (%IA_KEY_EGG_ERR#, ERROR);
     1446    13549    3               CALL M$XXX;
     1447    13550    3             END;                          /*  Whenaltreturn on M$OPEN  */
     1448    13551    2        PTR$ = ADDR(FPARAM);
     1449    13552    2        CALL XSF$LOCCODP(PTR$,4)
     1450    13553    3        WHENRETURN DO;
     1451    13554    3               MODIFY_DATE = PTR$ -> CODE04.MODIFY.TIME;
     1452    13555    3             END;                          /*  Whenreturn on XSF$LOCCODP  */
     1453    13556    2        CALL XUG$INIT (EGG_GETCMD,GHOST_INIT)
     1454    13557    3        WHENALTRETURN DO;
     1455    13558    3               CALL IAE$CSCG_ERROR (%IA_KEY_EGG_ERR#,EGG_GETCMD.ERR#);
     1456    13559    3               CALL M$XXX;
     1457    13560    3             END;                          /*  Whenaltreturn on XUG$INIT  */
     1458    13561
     1459    13562    2        EGG_GETCMD.INDCB# = DCBNUM (M$SCHED);
     1460    13563
     1461    13564    2   PARSE_COMMANDS:
     1462    13565    3        DO WHILE (%YES#);                  /* parse commands until error */
     1463    13566
     1464    13567    3             CALL PARSE$COMMAND
     1465    13568    4             WHENRETURN DO;
     1466    13569    4                    IF DO_TYPE = %IA_CMD_TESTMODE# THEN
     1467    13570    4                         DUMP_TABLE = %YES#;
     1468    13571    5                    ELSE DO;
     1469    13572    5                           IF DO_EVERY = -1 AND DO_UMIN = -1 /* Must be startup */
     1470    13573    5                           THEN
     1471    13574    5                                IF NUM_DAYS = 0
     1472    13575    5                                THEN
     1473    13576    6                                  DO;
     1474    13577    6                                       DO_HOUR = START_TIME / 60;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:43   
     1475    13578    6                                       DO_TMIN = MOD(START_TIME,60) / 10;
             13578                                                /* Ten minutes */
     1476    13579    6                                       DO_UMIN = START_TIME - DO_HOUR * 60 - DO_TMIN *
             13579                                                10; /* Units */
     1477    13580    6                                       IF TIME_WARP AND (DO_OFFSET > 0)
     1478    13581    6                                            AND (ELAPSED_MINS <= DO_OFFSET)
     1479    13582    6                                       THEN
     1480    13583    7                                         DO;
     1481    13584    7                                              DO_OFFSET = DO_OFFSET - ELAPSED_MINS;
     1482    13585    7                                            END;
     1483    13586    6                                       ELSE
     1484    13587    7                                         DO;
     1485    13588    7                                              IF TIME_WARP
     1486    13589    7                                              THEN
     1487    13590    8                                                DO;
     1488    13591    8                                                     DO_DAY (0) = 'NEV';
     1489    13592    8                                                   END;
     1490    13593    7                                            END;
     1491    13594    6                                     END;
     1492    13595    5                                ELSE
     1493    13596    5                                     DO_DAY (0) = 'NEV';
             13596                                              /* Prevents startup on all other days */
     1494    13597                                                /**/
     1495    13598                                                /**/
     1496    13599    5                           IF DO_FROM = -1 AND (DO_DAY(0) ~= '  ' OR DO_DATE.MM ~= '?'
     1497    13600    5                                OR DO_DATE.DD ~= '?' OR DO_DATE.YY ~= '?')
     1498    13601    5                           THEN            /* Day or date specified */
     1499    13602    5                                DO_FROM = 0; /* Interval from midnight */
     1500    13603                                                /**/
     1501    13604                                                /**/
     1502    13605    5                           IF (DO_DATE.MM = '?' OR DO_DATE.MM = TEXT_DATE.MON) AND
     1503    13606    5                                (DO_DATE.DD = '?' OR DO_DATE.DD = TEXT_DATE.DAY) AND
     1504    13607    5                                (DO_DATE.YY = '?' OR DO_DATE.YY = TEXT_DATE.YR) AND
     1505    13608    5                                (DO_DAY(0) = '   ' OR
     1506    13609    5                                DO_DAY(0) = TEXT_DAY OR DO_DAY(1) = TEXT_DAY OR
     1507    13610    5                                DO_DAY(2) = TEXT_DAY OR DO_DAY(3) = TEXT_DAY OR
     1508    13611    5                                DO_DAY(4) = TEXT_DAY OR DO_DAY(5) = TEXT_DAY OR
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:44   
     1509    13612    5                                DO_DAY(6) = TEXT_DAY)
     1510    13613    5                                AND (DO_DAY(0) ~= 'NEV')
     1511    13614    5                           THEN
     1512    13615    5                                IF DO_EVERY = -1
     1513    13616    5                                THEN
     1514    13617    5                                     IF DO_HOUR = -1
     1515    13618    5                                     THEN
     1516    13619    6                                       DO I = CURR_TIME / 60 TO 23;
             13619                                                /* Make entry  for every hour */
     1517    13620    6                                            IF DO_TMIN = -1
     1518    13621    6                                            THEN
     1519    13622    7                                              DO J = 0 TO 5; /* Wild carded tens */
     1520    13623    7                                                   TIME = I * 60 + J * 10 + DO_UMIN;
     1521    13624    7                                                   CALL MAKE$ENTRY(TIME) ALTRET(
             13624                                                            NO_MORE_MEM);
     1522    13625    7                                                 END;
     1523    13626    6                                            ELSE
     1524    13627    7                                              DO;
     1525    13628    7                                                   TIME = I * 60 + DO_TMIN * 10 +
             13628                                                            DO_UMIN;
     1526    13629    7                                                   CALL MAKE$ENTRY(TIME) ALTRET(
             13629                                                            NO_MORE_MEM);
             13629                                                            /* Make the entry */
     1527    13630    7                                                 END; /* End do no wild tens */
     1528    13631    6                                          END; /* End if wild carded hour */
     1529    13632    5                                     ELSE
     1530    13633    5                                          IF DO_TMIN = -1
     1531    13634    5                                          THEN
     1532    13635    6                                            DO J = 0 TO 5; /* Wild tens */
     1533    13636    6                                                 TIME = DO_HOUR * 60 + J * 10 + DO_UMIN
             13636                                                          ;
     1534    13637    6                                                 CALL MAKE$ENTRY(TIME) ALTRET(
             13637                                                          NO_MORE_MEM);
     1535    13638    6                                               END;
     1536    13639    5                                          ELSE
     1537    13640    5                                               CALL MAKE$ENTRY(DO_HOUR*60 + DO_TMIN*10
     1538    13641    5                                                    + DO_UMIN + DO_OFFSET) ALTRET (
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:45   
             13641                                                             NO_MORE_MEM); /* Only one */
     1539    13642    5                                ELSE       /* Every case */
     1540    13643    6                                  DO;
     1541    13644    6                                       IF DO_FROM = -1
     1542    13645    6                                       THEN
     1543    13646    7                                         DO;
     1544    13647    7                                              TIME = CURR_TIME ;
     1545    13648    7                                              IF NUM_DAYS = 0 AND START_UP
     1546    13649    7                                              THEN
     1547    13650    7                                                   DO_FROM = START_TIME + DO_EVERY;
     1548    13651    7                                              ELSE
     1549    13652    7                                                   DO_FROM = TIME + MOD(1440 * NUM_DAYS
     1550    13653    7                                                        + TIME - START_TIME,DO_EVERY);
     1551    13654    7                                            END; /* End if DO_EVERY = -1 */
     1552    13655    7                                       DO I = DO_FROM TO DO_UNTIL BY DO_EVERY;
     1553    13656    7                                            CALL MAKE$ENTRY(I) ALTRET(NO_MORE_MEM);
     1554    13657    7                                          END;
     1555    13658    6                                     END;  /* End every */
     1556    13659    5                         END;              /*  Else testmode  */
     1557    13660    4                  END;                     /*  Whenreturn from PARSE$COMMAND  */
     1558    13661                                                /**/
     1559    13662    4             WHENALTRETURN DO;
     1560    13663    4                    EXIT PARSE_COMMANDS;
     1561    13664    4                  END;                     /*  Whenaltreturn on PARSE$COMMAND  */
     1562    13665    3           END PARSE_COMMANDS;             /* Do while forever  */
     1563    13666                                                /**/
     1564    13667                                                /**/
     1565    13668    2   NO_MORE_MEM:;
     1566    13669    2        CALL M$CLOSE(CLOSE_S);             /* Close schedule file */
     1567    13670    2        IF DUMP_TABLE THEN
     1568    13671    3          DO;
     1569    13672    3               CALL M$SPRIV (RESET_FMSEC);
     1570    13673    3               CALL M$OPEN (GOOSE_TABLE_OPEN) WHENRETURN
     1571    13674    4                 DO;
     1572    13675    4                      TIME_ENTRY$ = TIME_HEAD$;
     1573    13676    5                      DO WHILE TIME_ENTRY$ ~= ADDR(NIL);
     1574    13677    5                           BUF_START = 0;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:46   
     1575    13678
     1576    13679    6                           DO CASE (TIME_TABLE.TYPE);
     1577    13680
     1578    13681    6                           CASE (%IA_CMD_DO#);
     1579    13682    6                              SUBSTR (OUTBUF,BUF_START,8) = '  KEYIN ';
     1580    13683
     1581    13684    6                           CASE (%IA_CMD_MESS#);
     1582    13685    6                              SUBSTR (OUTBUF,BUF_START,8) = 'MESSAGE ';
     1583    13686
     1584    13687    6                           CASE (%IA_CMD_START#);
     1585    13688    6                              SUBSTR (OUTBUF,BUF_START,8) = '  START ';
     1586    13689
     1587    13690    6                           CASE (ELSE);
     1588    13691    6                              SUBSTR (OUTBUF,BUF_START,8) = '  ERROR ';
     1589    13692    6                           END;            /*  Do case type  */
     1590    13693
     1591    13694    5                           BUF_START = 8;
     1592    13695    5                           CALL BINCHAR (TEMP_TIME, TIME_TABLE.TIME);
     1593    13696    5                           SUBSTR (OUTBUF,BUF_START,LENGTHC(TEMP_TIME)) = TEMP_TIME;
     1594    13697    5                           BUF_START = BUF_START + LENGTHC(TEMP_TIME);
     1595    13698    5                           SUBSTR (OUTBUF,BUF_START,1) = ' ';
     1596    13699    5                           BUF_START = BUF_START + 1;
     1597    13700
     1598    13701    5                           IF TIME_TABLE.GHOST_FID.SIZE = 0 THEN
     1599    13702    6                             DO;
     1600    13703    6                                  SUBSTR(OUTBUF,BUF_START,37) = NO_GHOST;
     1601    13704    6                                  BUF_START = BUF_START + 37;
     1602    13705    6                                END;
     1603    13706    6                           ELSE DO;
     1604    13707    6                                  SUBSTR (OUTBUF,BUF_START,TIME_TABLE.GHOST_FID.SIZE) =
             13707                                           TIME_TABLE.GHOST_FID.TEXT;
     1605    13708    6                                  BUF_START = BUF_START + TIME_TABLE.GHOST_FID.SIZE;
     1606    13709    6                                  SUBSTR (OUTBUF,BUF_START,1) = '.';
     1607    13710    6                                  BUF_START = BUF_START + 1;
     1608    13711    7                                  IF TIME_TABLE.ACCT ~= ' ' THEN DO;
     1609    13712    7                                         SUBSTR (OUTBUF,BUF_START,LENGTHC(TIME_TABLE.
             13712                                                  ACCT)) = TIME_TABLE.ACCT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:47   
     1610    13713    7                                         BUF_START = BUF_START + LENGTHC(TIME_TABLE.
             13713                                                  ACCT);
     1611    13714    7                                       END;
     1612    13715    6                                  SUBSTR (OUTBUF,BUF_START,1) = '.';
     1613    13716    6                                  BUF_START = BUF_START + 1;
     1614    13717    7                                  IF TIME_TABLE.PASS ~= ' ' THEN DO;
     1615    13718    7                                         SUBSTR (OUTBUF,BUF_START,LENGTHC(TIME_TABLE.
             13718                                                  PASS)) = TIME_TABLE.PASS;
     1616    13719    7                                         BUF_START = BUF_START + LENGTHC(TIME_TABLE.
             13719                                                  PASS);
     1617    13720    7                                       END;
     1618    13721
     1619    13722    6                                END;       /*  Else  */
     1620    13723
     1621    13724    5                           GOOSE_TABLE_WRITE.BUF_.BUF$ = ADDR(OUTBUF);
     1622    13725    5                           GOOSE_TABLE_WRITE.BUF_.BOUND = BUF_START - 1;
     1623    13726    5                           CALL M$WRITE (GOOSE_TABLE_WRITE) WHENALTRETURN
     1624    13727    6                             DO;
     1625    13728    6                                  RETURN;
     1626    13729    6                                END;       /*  Whenaltreturn on M$WRITE  */
     1627    13730
     1628    13731    5                           IF TIME_TABLE.SIZE > 0 THEN
     1629    13732    6                             DO;
     1630    13733    6                                  GOOSE_TABLE_WRITE.BUF_.BUF$ = ADDR(TIME_TABLE.COMMAND
             13733                                           );
     1631    13734    6                                  GOOSE_TABLE_WRITE.BUF_.BOUND = TIME_TABLE.SIZE - 1;
     1632    13735    6                                  CALL M$WRITE (GOOSE_TABLE_WRITE) WHENALTRETURN
     1633    13736    7                                    DO;
     1634    13737    7                                         RETURN;
     1635    13738    7                                       END; /*  Whenaltreturn on M$WRITE  */
     1636    13739    6                                END;
     1637    13740    5                           TIME_ENTRY$ = TIME_TABLE.NEXT$;
     1638    13741    5                         END;              /*  Do while  */
     1639    13742
     1640    13743    4                      CALL M$CLOSE (GOOSE_TABLE_CLOSE) WHENALTRETURN
     1641    13744    5                        DO;
     1642    13745    5                             RETURN;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:48   
     1643    13746    5                           END;            /*  Whenaltreturn on M$WRITE  */
     1644    13747    4                      CALL M$RPRIV (RESET_FMSEC);
     1645    13748    4                    END;                   /*  Whenreturn on M$OPEN  */
     1646    13749    4               WHENALTRETURN DO;
     1647    13750    4                    END;                   /*  Whenaltreturn on M$OPEN  */
     1648    13751    3             END;                          /*  If DUMP_TABLE  */
     1649    13752    2        RETURN;
     1650    13753                                                /**/
     1651    13754                                                /**/
     1652    13755                                                /**/
     1653    13756    2   END BUILD$TIME;
     1654    13757        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:49   
     1655    13758        /*I*      NAME: PARSE$COMMAND
     1656    13759                  PURPOSE: Parses the command from GOOSE_EGG
     1657    13760                  CALL: CALL PARSE$COMMAND ALTRET( BAD_PARSE);
     1658    13761                  DESCRIPTION: This routine calls XUG$GETCMD to read and
     1659    13762                                 actually parse a single command.  It then
     1660    13763                                 interpets ths blocks it gets back and stores
     1661    13764                                 the infomation in 'DO_   ' variables. The
     1662    13765                                 routine will ALTRETURN if there is an error
     1663    13766                                 in the command, or if XUG altreturns.
     1664    13767                             */
     1665    13768    1   PARSE$COMMAND: PROC ALTRET;
     1666    13769    2   DCL I SBIN WORD;
     1667    13770    2   DCL J SBIN WORD;
     1668    13771    2   DCL K SBIN WORD;
     1669    13772    2   DCL SIZE UBIN WORD;
     1670    13773    2   DCL SYN_ERR UBIN WORD;
     1671    13774    2   DCL BTEXT CHAR(SIZE) BASED;
     1672    13775    2   DCL 1 DO_BEGIN_RANGE,
     1673    13776    2           2 YY CHAR(2),
     1674    13777    2           2 MM CHAR(2) CALIGNED,
     1675    13778    2           2 ERROR UBIN CALIGNED,
     1676    13779    2           2 DD CHAR(2) CALIGNED;
     1677    13780    2   DCL 1 DO_BEGIN_SINGLE REDEF DO_BEGIN_RANGE,
     1678    13781    2           2 Y1 CHAR(1),
     1679    13782    2           2 Y2 CHAR(1),
     1680    13783    2           2 M1 CHAR(1),
     1681    13784    2           2 M2 CHAR(1),
     1682    13785    2           2 * UBIN CALIGNED,
     1683    13786    2           2 D1 CHAR(1),
     1684    13787    2           2 D2 CHAR(1);
     1685    13788    2   DCL 1 DO_END_RANGE,
     1686    13789    2           2 YY CHAR(2),
     1687    13790    2           2 MM CHAR(2) CALIGNED,
     1688    13791    2           2 ERROR UBIN CALIGNED,
     1689    13792    2           2 DD CHAR(2) CALIGNED;
     1690    13793    2   DCL 1 DO_END_SINGLE REDEF DO_END_RANGE,
     1691    13794    2           2 Y1 CHAR(1),
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:50   
     1692    13795    2           2 Y2 CHAR(1),
     1693    13796    2           2 M1 CHAR(1),
     1694    13797    2           2 M2 CHAR(1),
     1695    13798    2           2 * UBIN CALIGNED,
     1696    13799    2           2 D1 CHAR(1),
     1697    13800    2           2 D2 CHAR(1);
     1698    13801
     1699    13802    2   DCL CONV_YR         UBIN;
     1700    13803    2   DCL CONV_MO         UBIN;
     1701    13804    2   DCL CONV_DY         UBIN;
     1702    13805    2   DCL CONV_BEGIN      UBIN;
     1703    13806    2   DCL CONV_END        UBIN;
     1704    13807    2   DCL CONV_CURRENT    UBIN;
     1705    13808
     1706    13809                                                /**/
     1707    13810                                                /**/
     1708    13811    2        CALL XUG$GETCMD (EGG_GETCMD)
     1709    13812    3        WHENALTRETURN DO;
     1710    13813    3               ERROR = EGG_GETCMD.ERR#;
     1711    13814    3               IF ERROR.ERR# ~= %E$EOF
     1712    13815    4               THEN DO;
     1713    13816    4                      IF ERROR.ERR# = %E$SYNERR
     1714    13817    4                      THEN
     1715    13818    4                           CALL IAE$ERROR(ON_LINE,%E$IA_SYN_ERR#,ERROR,%
             13818                                    IA_KEY_SYNTAX_ERR#,EGG_GETCMD.PCB$);
     1716    13819    4                      ELSE
     1717    13820    4                           CALL IAE$ERROR(ON_LINE,0,ERROR,%IA_KEY_EGG_ERR#,EGG_GETCMD.
             13820                                    PCB$);
     1718    13821    4                    END;                   /*  If not eof  */
     1719    13822    3               ALTRETURN;
     1720    13823    3             END;                          /*  Whenaltreturn on XUG$GETCMD  */
     1721    13824    2        DO_ACCT = B$JIT$ -> B$JIT.ACCN;
     1722    13825    2        DO_PASS = ' ';
     1723    13826    2        DO_CMD_SIZE = 0;
     1724    13827    2        DO_HOUR = -1;
     1725    13828    2        DO_TMIN = -1;
     1726    13829    2        DO_UMIN = -1;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:51   
     1727    13830    2        DO_OFFSET = 0;
     1728    13831    2        DO_EVERY = -1;
     1729    13832    2        DO_DATE.MM = '?';
     1730    13833    2        DO_DATE.DD = '?';
     1731    13834    2        DO_DATE.YY = '?';
     1732    13835    2        DO_DAY(0) = '   ';
     1733    13836    2        DO_DAY(1) = '   ';
     1734    13837    2        DO_DAY(2) = '   ';
     1735    13838    2        DO_DAY(3) = '   ';
     1736    13839    2        DO_DAY(4) = '   ';
     1737    13840    2        DO_DAY(5) = '   ';
     1738    13841    2        DO_DAY(6) = '   ';
     1739    13842    2        DO_FID.TEXT = '   ';
     1740    13843    2        DO_FID.SIZE = 0;
     1741    13844    2        DO_CMD = '   ';
     1742    13845    2        DO_FROM = -1;
     1743    13846    2        DO_UNTIL = 1439;                   /* Default from 00:00 to 23:59 */
     1744    13847                                                /**/
     1745    13848                                                /**/
     1746    13849    2        DO_TYPE = EGG_GETCMD.OUT$ -> OUT$BLK.CODE; /* Save message type */
     1747    13850    3        DO I = 0 TO EGG_GETCMD.OUT$ -> OUT$BLK.NSUBLKS - 1;
     1748    13851    3             PTR$ = EGG_GETCMD.OUT$ ->  OUT$BLK.SUBLK$(I);
     1749    13852    4             DO CASE (PTR$ -> OUT$BLK.CODE);
     1750    13853                                                /**/
     1751    13854                                                /**/
     1752    13855    4             CASE (%IA_GKEY_EVERY#);
     1753    13856    4                CALL CONCAT(MESS_BUF, '+', %SUB_BLOCK(0)->OUT$SYM.TEXT);
     1754    13857    4                SIZE = %SUB_BLOCK (0) -> OUT$SYM.COUNT + 1;
     1755    13858    4                CALL XCHARBIN(DO_EVERY,ADDR(MESS_BUF)->BTEXT);
     1756    13859    4                IF %SUB_BLOCK (1) -> OUT$SYM.CODE = 2
     1757    13860    4                THEN
     1758    13861    4                     DO_EVERY = DO_EVERY * 60;
     1759    13862                                                /**/
     1760    13863                                                /**/
     1761    13864    4             CASE (%IA_GKEY_AT#);
     1762    13865    4                IF %SUB_BLOCK(0) -> OUT$SYM.CODE ~= 3 /* Start up */
     1763    13866    4                THEN
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:52   
     1764    13867    5                  DO;
     1765    13868    5                       CALL INDEX(J, '?', %SUB_BLOCK(0)->OUT$SYM.TEXT)
     1766    13869    6                       WHENRETURN DO;
     1767    13870    6                              IF %SUB_BLOCK(0) -> OUT$SYM.COUNT = 2 AND
     1768    13871    6                                   %SUB_BLOCK(0)->OUT$SYM.TEXT ~= '??'
     1769    13872    6                              THEN
     1770    13873    6                                   GOTO SYN_TIME_ERR;
     1771    13874    6                            END;           /* '?' found in hour */
     1772    13875    6                       WHENALTRETURN DO;
     1773    13876    6                              CALL CHARBIN(DO_HOUR,%SUB_BLOCK(0) -> OUT$SYM.TEXT);
     1774    13877    6                            END;           /* no '?' in hour */
     1775    13878    5                       DO_UMIN = ASCBIN(SUBSTR(%SUB_BLOCK(1)->OUT$SYM.TEXT,0,1)) -
             13878                                ASCBIN('0');
     1776    13879    5                       IF %SUB_BLOCK(1) -> OUT$SYM.COUNT = 2
     1777    13880    6                       THEN DO;
     1778    13881    6                              IF DO_UMIN <= 9
     1779    13882    6                              THEN         /* not a '?' */
     1780    13883    6                                   DO_TMIN = DO_UMIN;
     1781    13884    6                              DO_UMIN = ASCBIN(SUBSTR(%SUB_BLOCK(1)->OUT$SYM.TEXT,1,1))
             13884                                       - ASCBIN('0');
     1782    13885    6                            END;           /* 2 digits in minutes */
     1783    13886    5                       IF DO_UMIN > 9
     1784    13887    5                       THEN
     1785    13888    5                            GOTO SYN_TIME_ERR; /* '?' in units found */
     1786    13889    5                       IF DO_HOUR > 23 OR DO_TMIN > 5
     1787    13890    5                       THEN
     1788    13891    5                            GOTO SYN_TIME_ERR;
     1789    13892    5                     END;                  /* End not startup */
     1790    13893    4                ELSE
     1791    13894    5                  DO;
     1792    13895    5                       IF %SUB_BLOCK(0) -> OUT$BLK.NSUBLKS > 0
     1793    13896    5                       THEN
     1794    13897    5                            CALL CHARBIN (DO_OFFSET, %SUB_BLOCK(0)
     1795    13898    5                                 -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
     1796    13899    5                     END;
     1797    13900                                                /**/
     1798    13901                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:53   
     1799    13902    4             CASE (%IA_GKEY_DAYS#) ;
     1800    13903    5                DO J = 0 TO PTR$ -> OUT$BLK.NSUBLKS - 1;
     1801    13904    6                     DO CASE (%SUB_BLOCK(J) -> OUT$SYM.CODE);
     1802    13905    6                     CASE (%IA_MONDAY#);
     1803    13906    6                        DO_DAY(J) = 'MON';
     1804    13907    6                     CASE (%IA_TUESDAY#);
     1805    13908    6                        DO_DAY(J) = 'TUE';
     1806    13909    6                     CASE (%IA_WEDNESDAY#);
     1807    13910    6                        DO_DAY(J) = 'WED';
     1808    13911    6                     CASE (%IA_THURSDAY#);
     1809    13912    6                        DO_DAY(J) = 'THU';
     1810    13913    6                     CASE (%IA_FRIDAY#);
     1811    13914    6                        DO_DAY(J) = 'FRI';
     1812    13915    6                     CASE (%IA_SATURDAY#);
     1813    13916    6                        DO_DAY(J) = 'SAT';
     1814    13917    6                     CASE (%IA_SUNDAY#);
     1815    13918    6                        DO_DAY(J) = 'SUN';
     1816    13919    6                     END;                  /* End case */
     1817    13920    5                   END;
     1818    13921                                                /**/
     1819    13922                                                /**/
     1820    13923    4             CASE (%IA_GKEY_DATE#) ;
     1821    13924    4                IF %SUB_BLOCK (2) -> OUT$SYM.COUNT = 1
     1822    13925    4                THEN
     1823    13926    4                     CALL CONCAT(DO_DATE.YY,'0',%SUB_BLOCK(2) -> OUT$SYM.TEXT);
     1824    13927    4                ELSE
     1825    13928    4                     DO_DATE.YY = %SUB_BLOCK(2) -> OUT$SYM.TEXT;
     1826    13929    4                IF DO_DATE.YY = '0?' OR DO_DATE.YY = '??'
     1827    13930    4                THEN
     1828    13931    4                     DO_DATE.YY = '?';
     1829    13932    4                IF (DO_DATER.Y1 = '?' AND DO_DATER.Y2 ~= ' ')
     1830    13933    4                     OR DO_DATER.Y2 = '?'
     1831    13934    4                THEN
     1832    13935    4                     GOTO SYN_YEAR_ERR;
     1833    13936    4                IF %SUB_BLOCK (0) -> OUT$SYM.COUNT = 1
     1834    13937    4                THEN
     1835    13938    4                     CALL CONCAT(DO_DATE.MM,'0',%SUB_BLOCK(0) -> OUT$SYM.TEXT);
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:54   
     1836    13939    4                ELSE
     1837    13940    4                     DO_DATE.MM = %SUB_BLOCK(0) -> OUT$SYM.TEXT;
     1838    13941    4                IF DO_DATE.MM = '0?' OR DO_DATE.MM = '??'
     1839    13942    4                THEN
     1840    13943    4                     DO_DATE.MM = '?';
     1841    13944    4                ELSE
     1842    13945    4                     IF DO_DATE.MM > '12' OR DO_DATE.MM < '01'
     1843    13946    4                     THEN
     1844    13947    4                          GOTO SYN_MONTH_ERR;
     1845    13948    4                IF (DO_DATER.M1 = '?' AND DO_DATER.M2 ~= ' ')
     1846    13949    4                     OR DO_DATER.M2 = '?'
     1847    13950    4                THEN
     1848    13951    4                     GOTO SYN_MONTH_ERR;
     1849    13952    4                IF %SUB_BLOCK (1) -> OUT$SYM.COUNT = 1
     1850    13953    4                THEN
     1851    13954    4                     CALL CONCAT(DO_DATE.DD,'0',%SUB_BLOCK(1) -> OUT$SYM.TEXT);
     1852    13955    4                ELSE
     1853    13956    4                     DO_DATE.DD = %SUB_BLOCK(1) -> OUT$SYM.TEXT;
     1854    13957    4                IF DO_DATE.DD = '0?' OR DO_DATE.DD = '??'
     1855    13958    4                THEN
     1856    13959    4                     DO_DATE.DD = '?';
     1857    13960    4                ELSE
     1858    13961    5                  DO;
     1859    13962    5                       IF DO_DATER.D1 = '?' OR DO_DATER.D2 = '?'
     1860    13963    5                       THEN
     1861    13964    5                            GOTO SYN_DAY_ERR;
     1862    13965    5                       IF DO_DATE.DD > '31' OR DO_DATE.DD < '01'
     1863    13966    5                       THEN
     1864    13967    5                            GOTO SYN_DAY_ERR;
     1865    13968    5                       IF DO_DATE.MM = '04' OR
     1866    13969    5                            DO_DATE.MM = '06' OR
     1867    13970    5                            DO_DATE.MM = '09' OR
     1868    13971    5                            DO_DATE.MM = '11'
     1869    13972    5                       THEN                /* 30 day month */
     1870    13973    5                            IF DO_DATE.DD > '30'
     1871    13974    5                            THEN
     1872    13975    5                                 GOTO SYN_DAY_ERR;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:55   
     1873    13976    5                       IF DO_DATE.YY ~= '?'
     1874    13977    5                       THEN
     1875    13978    5                            CALL CHARBIN(J,DO_DATE.YY); /* Convert year */
     1876    13979    5                       ELSE
     1877    13980    5                            J = 0;
     1878    13981    5                       IF DO_DATE.MM = '02' /* Febuary */
     1879    13982    5                       THEN
     1880    13983    5                            IF MOD(J,4) = 0
     1881    13984    6                            THEN DO;
     1882    13985    6                                   IF DO_DATE.MM > '29'
     1883    13986    6                                   THEN
     1884    13987    6                                        GOTO SYN_DAY_ERR;
     1885    13988    6                                 END;      /*  Leap year  */
     1886    13989    5                            ELSE
     1887    13990    5                                 IF DO_DATE.MM > '28'
     1888    13991    5                                 THEN
     1889    13992    5                                      GOTO SYN_DAY_ERR;
     1890    13993    5                     END;                  /*  Wildcarded date */
     1891    13994                                                /**/
     1892    13995                                                /**/
     1893    13996    4             CASE (%IA_GKEY_DATES#) ;
     1894    13997    4                IF %SUB_BLOCK (2) -> OUT$SYM.COUNT = 1
     1895    13998    4                THEN
     1896    13999    4                     GOTO SYN_YEAR_ERR;
     1897    14000    4                ELSE
     1898    14001    4                     DO_BEGIN_RANGE.YY = %SUB_BLOCK(2) -> OUT$SYM.TEXT;
     1899    14002    4                IF (DO_BEGIN_SINGLE.Y1 = '?') OR (DO_BEGIN_SINGLE.Y2 = '?')
     1900    14003    4                THEN
     1901    14004    4                     GOTO SYN_NO_WILD_ERR;
     1902    14005    4                IF %SUB_BLOCK (0) -> OUT$SYM.COUNT = 1
     1903    14006    4                THEN
     1904    14007    4                     CALL CONCAT(DO_BEGIN_RANGE.MM,'0',%SUB_BLOCK(0) -> OUT$SYM.TEXT);
     1905    14008    4                ELSE
     1906    14009    4                     DO_BEGIN_RANGE.MM = %SUB_BLOCK(0) -> OUT$SYM.TEXT;
     1907    14010    4                IF DO_BEGIN_RANGE.MM > '12' OR DO_BEGIN_RANGE.MM < '01'
     1908    14011    4                THEN
     1909    14012    4                     GOTO SYN_MONTH_ERR;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:56   
     1910    14013    4                IF (DO_BEGIN_SINGLE.M1 = '?') OR (DO_BEGIN_SINGLE.M2 = '?')
     1911    14014    4                THEN
     1912    14015    4                     GOTO SYN_NO_WILD_ERR;
     1913    14016    4                IF %SUB_BLOCK (1) -> OUT$SYM.COUNT = 1
     1914    14017    4                THEN
     1915    14018    4                     CALL CONCAT(DO_BEGIN_RANGE.DD,'0',%SUB_BLOCK(1) -> OUT$SYM.TEXT);
     1916    14019    4                ELSE
     1917    14020    4                     DO_BEGIN_RANGE.DD = %SUB_BLOCK(1) -> OUT$SYM.TEXT;
     1918    14021    4                IF DO_BEGIN_SINGLE.D1 = '?' OR DO_BEGIN_SINGLE.D2 = '?'
     1919    14022    4                THEN
     1920    14023    4                     GOTO SYN_NO_WILD_ERR;
     1921    14024    4                IF DO_BEGIN_RANGE.DD > '31' OR DO_BEGIN_RANGE.DD < '01'
     1922    14025    4                THEN
     1923    14026    4                     GOTO SYN_DAY_ERR;
     1924    14027    4                IF DO_BEGIN_RANGE.MM = '04' OR
     1925    14028    4                     DO_BEGIN_RANGE.MM = '06' OR
     1926    14029    4                     DO_BEGIN_RANGE.MM = '09' OR
     1927    14030    4                     DO_BEGIN_RANGE.MM = '11'
     1928    14031    4                THEN                       /* 30 day month */
     1929    14032    4                     IF DO_BEGIN_RANGE.DD > '30'
     1930    14033    4                     THEN
     1931    14034    4                          GOTO SYN_DAY_ERR;
     1932    14035
     1933    14036    4                CALL CHARBIN(J,DO_BEGIN_RANGE.YY); /* Convert year */
     1934    14037    4                IF DO_BEGIN_RANGE.MM = '02' /* Febuary */
     1935    14038    4                THEN
     1936    14039    4                     IF MOD(J,4) = 0
     1937    14040    5                     THEN DO;
     1938    14041    5                            IF DO_BEGIN_RANGE.MM > '29'
     1939    14042    5                            THEN
     1940    14043    5                                 GOTO SYN_DAY_ERR;
     1941    14044    5                          END;             /*  Leap year  */
     1942    14045    4                     ELSE
     1943    14046    4                          IF DO_BEGIN_RANGE.MM > '28'
     1944    14047    4                          THEN
     1945    14048    4                               GOTO SYN_DAY_ERR;
     1946    14049                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:57   
     1947    14050    4                IF %SUB_BLOCK (5) -> OUT$SYM.COUNT = 1
     1948    14051    4                THEN
     1949    14052    4                     GOTO SYN_YEAR_ERR;
     1950    14053    4                ELSE
     1951    14054    4                     DO_END_RANGE.YY = %SUB_BLOCK(5) -> OUT$SYM.TEXT;
     1952    14055    4                IF (DO_END_SINGLE.Y1 = '?') OR (DO_END_SINGLE.Y2 = '?')
     1953    14056    4                THEN
     1954    14057    4                     GOTO SYN_NO_WILD_ERR;
     1955    14058    4                IF %SUB_BLOCK (3) -> OUT$SYM.COUNT = 1
     1956    14059    4                THEN
     1957    14060    4                     CALL CONCAT(DO_END_RANGE.MM,'0',%SUB_BLOCK(3) -> OUT$SYM.TEXT);
     1958    14061    4                ELSE
     1959    14062    4                     DO_END_RANGE.MM = %SUB_BLOCK(3) -> OUT$SYM.TEXT;
     1960    14063    4                IF DO_END_RANGE.MM > '12' OR DO_END_RANGE.MM < '01'
     1961    14064    4                THEN
     1962    14065    4                     GOTO SYN_MONTH_ERR;
     1963    14066    4                IF (DO_END_SINGLE.M1 = '?') OR (DO_END_SINGLE.M2 = '?')
     1964    14067    4                THEN
     1965    14068    4                     GOTO SYN_NO_WILD_ERR;
     1966    14069    4                IF %SUB_BLOCK (4) -> OUT$SYM.COUNT = 1
     1967    14070    4                THEN
     1968    14071    4                     CALL CONCAT(DO_END_RANGE.DD,'0',%SUB_BLOCK(4) -> OUT$SYM.TEXT);
     1969    14072    4                ELSE
     1970    14073    4                     DO_END_RANGE.DD = %SUB_BLOCK(4) -> OUT$SYM.TEXT;
     1971    14074    4                IF DO_END_SINGLE.D1 = '?' OR DO_END_SINGLE.D2 = '?'
     1972    14075    4                THEN
     1973    14076    4                     GOTO SYN_NO_WILD_ERR;
     1974    14077    4                IF DO_END_RANGE.DD > '31' OR DO_END_RANGE.DD < '01'
     1975    14078    4                THEN
     1976    14079    4                     GOTO SYN_DAY_ERR;
     1977    14080    4                IF DO_END_RANGE.MM = '04' OR
     1978    14081    4                     DO_END_RANGE.MM = '06' OR
     1979    14082    4                     DO_END_RANGE.MM = '09' OR
     1980    14083    4                     DO_END_RANGE.MM = '11'
     1981    14084    4                THEN                       /* 30 day month */
     1982    14085    4                     IF DO_END_RANGE.DD > '30'
     1983    14086    4                     THEN
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:58   
     1984    14087    4                          GOTO SYN_DAY_ERR;
     1985    14088
     1986    14089    4                CALL CHARBIN(J,DO_END_RANGE.YY); /* Convert year */
     1987    14090    4                IF DO_END_RANGE.MM = '02'  /* Febuary */
     1988    14091    4                THEN
     1989    14092    4                     IF MOD(J,4) = 0
     1990    14093    4                     THEN
     1991    14094    5                       DO;
     1992    14095    5                            IF DO_END_RANGE.MM > '29'
     1993    14096    5                            THEN
     1994    14097    5                                 GOTO SYN_DAY_ERR;
     1995    14098    5                          END;             /*  Leap year  */
     1996    14099    4                     ELSE
     1997    14100    4                          IF DO_END_RANGE.MM > '28'
     1998    14101    4                          THEN
     1999    14102    4                               GOTO SYN_DAY_ERR;
     2000    14103                                                /**/
     2001    14104                            /*  Convert the two dates to a form easier to
     2002    14105                                compare.             */
     2003    14106    4                CALL CHARBIN (CONV_YR, DO_BEGIN_RANGE.YY);
     2004    14107    4                CALL CHARBIN (CONV_MO, DO_BEGIN_RANGE.MM);
     2005    14108    4                CALL CHARBIN (CONV_DY, DO_BEGIN_RANGE.DD);
     2006    14109                            /*  Check for year 2000 (i.e., yr >= 0 and <= 21)
     2007    14110                                                      */
     2008    14111    4                IF CONV_YR <= 21
     2009    14112    4                THEN CONV_YR = CONV_YR + 100;
     2010    14113                            /*  Add 100 if century is 2000
     2011    14114                                                      */
     2012    14115    4                CONV_BEGIN = (CONV_YR * 10000) + (CONV_MO * 100) + CONV_DY;
     2013    14116    4                CALL CHARBIN (CONV_YR, DO_END_RANGE.YY);
     2014    14117    4                CALL CHARBIN (CONV_MO, DO_END_RANGE.MM);
     2015    14118    4                CALL CHARBIN (CONV_DY, DO_END_RANGE.DD);
     2016    14119                            /*  Check for year 2000 (i.e., yr >= 0 and <= 21)
     2017    14120                                                      */
     2018    14121    4                IF CONV_YR <= 21
     2019    14122    4                THEN CONV_YR = CONV_YR + 100;
     2020    14123                            /*  Add 100 if century is 2000
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:59   
     2021    14124                                                      */
     2022    14125    4                CONV_END = (CONV_YR * 10000) + (CONV_MO * 100) + CONV_DY;
     2023    14126                                 /* Now make sure that the end date is after
     2024    14127                                      the begin date */
     2025    14128    4                IF CONV_BEGIN > CONV_END
     2026    14129    4                THEN
     2027    14130    4                     GOTO SYN_DATE_RANGE_ERR;
     2028    14131                                                /**/
     2029    14132                                      /*
     2030    14133                                           The range is set up correctly.
     2031    14134                                           Now determine if the current date
     2032    14135                                           falls within the range.
     2033    14136                                      */
     2034    14137                                      /*
     2035    14138                                           First convert the current date
     2036    14139                                           to the same format we have already
     2037    14140                                           converted the range dates to.
     2038    14141                                           Then check current date against
     2039    14142                                           beginning of range.  If it is less
     2040    14143                                           than, issue warning, and set up
     2041    14144                                           DO_DATE = to beginning of range.
     2042    14145                                      */
     2043    14146    4                CALL CHARBIN (CONV_YR, TEXT_DATE.YR);
     2044    14147    4                CALL CHARBIN (CONV_MO, TEXT_DATE.MON);
     2045    14148    4                CALL CHARBIN (CONV_DY, TEXT_DATE.DAY);
     2046    14149                            /*  Check for year 2000 (i.e., yr >= 0 and <= 21)
     2047    14150                                                      */
     2048    14151    4                IF CONV_YR <= 21
     2049    14152    4                THEN CONV_YR = CONV_YR + 100;
     2050    14153                            /*  Add 100 if century is 2000
     2051    14154                                                      */
     2052    14155    4                CONV_CURRENT = (CONV_YR * 10000) + (CONV_MO * 100) + CONV_DY;
     2053    14156    4                IF CONV_CURRENT < CONV_BEGIN
     2054    14157    5                THEN DO;
     2055    14158    5                       CALL IAE$ERROR (ON_LINE,%E$IA_BEFORE_RANGE_WARN#,0,%
             14158                                IA_KEY_DATE_WARN#,EGG_GETCMD.PCB$);
     2056    14159    5                       ERROR.ERR# = %E$SYNERR;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:60   
     2057    14160    5                       DO_DATE = DO_BEGIN_RANGE;
     2058    14161    5                       DO_DATE.ERROR = 0;
     2059    14162    5                       RETURN;
     2060    14163    5                     END;
     2061    14164                                      /*
     2062    14165                                           Now check current date against
     2063    14166                                           end of range.  If it is greater
     2064    14167                                           than, issue warning, and set up
     2065    14168                                           DO_DATE = to end of range.
     2066    14169                                      */
     2067    14170    4                IF CONV_CURRENT > CONV_END
     2068    14171    5                THEN DO;
     2069    14172    5                       CALL IAE$ERROR (ON_LINE,%E$IA_AFTER_RANGE_WARN#,0,%
             14172                                IA_KEY_DATE_WARN#,EGG_GETCMD.PCB$);
     2070    14173    5                       ERROR.ERR# = %E$SYNERR;
     2071    14174    5                       DO_DATE = DO_END_RANGE;
     2072    14175    5                       DO_DATE.ERROR = 0;
     2073    14176    5                       RETURN;
     2074    14177    5                     END;
     2075    14178                                      /*
     2076    14179                                           Everything is copeasetic.
     2077    14180                                           set up current date in DO_DATE.
     2078    14181                                      */
     2079    14182    4                DO_DATE.YY = TEXT_DATE.YR;
     2080    14183    4                DO_DATE.MM = TEXT_DATE.MON;
     2081    14184    4                DO_DATE.DD = TEXT_DATE.DAY;
     2082    14185    4                DO_DATE.ERROR = 0;
     2083    14186                                                /**/
     2084    14187                                                /**/
     2085    14188    4             CASE (%IA_GKEY_CMD#);
     2086    14189    4                DO_CMD = PTR$ -> OUT$SYM.TEXT;
     2087    14190    4                DO_CMD_SIZE = PTR$ -> OUT$SYM.COUNT;
     2088    14191    4                IF DO_TYPE = %IA_CMD_DO# /* Keyin node */ THEN
     2089    14192    5                     IF DO_CMD_SIZE > 80 THEN DO;
     2090    14193    5                            CALL IAE$ERROR (ON_LINE,%E$IA_CMD_TOO_BIG_ERR#,0,%
             14193                                     IA_KEY_SYNTAX_ERR#,EGG_GETCMD.PCB$);
     2091    14194    5                            ERROR.ERR# = %E$SYNERR;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:61   
     2092    14195    5                            DO_CMD_SIZE = 80;
     2093    14196    5                          END;             /* Size > 80 */
     2094    14197    4                     ELSE ;
     2095    14198    5                ELSE IF DO_CMD_SIZE > 256 THEN DO;
     2096    14199    5                            CALL IAE$ERROR (ON_LINE,%E$IA_CMD_TOO_BIG_ERR#,0,%
             14199                                     IA_KEY_SYNTAX_ERR#,EGG_GETCMD.PCB$);
     2097    14200    5                            ERROR.ERR# = %E$SYNERR;
     2098    14201    5                            DO_CMD_SIZE = 256;
     2099    14202    5                          END;             /* Size > 256 */
     2100    14203                                                /**/
     2101    14204                                                /**/
     2102    14205    4             CASE (%IA_GKEY_UNAME#);
     2103    14206    4                DO_FID.TEXT = PTR$ -> OUT$SYM.TEXT;
     2104    14207    4                DO_FID.SIZE = PTR$ -> OUT$SYM.COUNT;
     2105    14208                                                /**/
     2106    14209                                                /**/
     2107    14210    4             CASE (%IA_GKEY_ACCT#);        /* Account specified */
     2108    14211    4                DO_ACCT = PTR$ -> OUT$SYM.TEXT;
     2109    14212
     2110    14213                                                /**/
     2111    14214                                                /* Password specified */
     2112    14215                                                /**/
     2113    14216    4             CASE (%IA_GKEY_PASS#);
     2114    14217    4                DO_PASS = PTR$ -> OUT$SYM.TEXT;
     2115    14218
     2116    14219    4             CASE (%IA_GKEY_FROM#);        /* From specifed */
     2117    14220    4                CALL CHARBIN(DO_FROM,%SUB_BLOCK(0) -> OUT$SYM.TEXT);
     2118    14221    4                CALL CHARBIN(K,%SUB_BLOCK(1) -> OUT$SYM.TEXT);
     2119    14222    4                IF DO_FROM > 23 THEN GOTO SYN_TIME_ERR; /* Bad hour */
     2120    14223    4                IF K > 59 THEN GOTO SYN_TIME_ERR; /* Bad minutes */
     2121    14224    4                DO_FROM = DO_FROM * 60 + K; /* Calculate start min */
     2122    14225                                                /**/
     2123    14226                                                /**/
     2124    14227                                                /**/
     2125    14228                                                /**/
     2126    14229    4             CASE (%IA_GKEY_UNTIL#);       /* Until specifed */
     2127    14230    4                CALL CHARBIN(DO_UNTIL,%SUB_BLOCK(0) -> OUT$SYM.TEXT);
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:62   
     2128    14231    4                CALL CHARBIN(K,%SUB_BLOCK(1) -> OUT$SYM.TEXT);
     2129    14232    4                IF DO_UNTIL > 23 THEN GOTO SYN_TIME_ERR; /* Bad hour */
     2130    14233    4                IF K > 59 THEN GOTO SYN_TIME_ERR; /* Bad minutes */
     2131    14234    4                DO_UNTIL = DO_UNTIL * 60 + K; /* Calculate end min */
     2132    14235    4                IF DO_UNTIL < DO_FROM THEN GOTO SYN_TIME_RANGE_ERR;
     2133    14236                                                /**/
     2134    14237                                                /**/
     2135    14238    4             CASE ( %IA_GKEY_TESTMODE#);
     2136    14239
     2137    14240                                                /*  Do nothing  */
     2138    14241                                           /*  The table is necessarily complete yet  */
     2139    14242
     2140    14243                                                /**/
     2141    14244                                                /**/
     2142    14245    4             END;                          /* End cases */
     2143    14246    3           END;                            /* End sub command */
     2144    14247    2        RETURN;                            /* Command is parsed */
     2145    14248                                                /**/
     2146    14249    2   SYN_TIME_ERR: SYN_ERR = %E$IA_TIME_ERR#; GOTO RPT_SYN;
     2147    14250    2   SYN_TIME_RANGE_ERR: SYN_ERR = %E$IA_TIME_RANGE_ERR#; GOTO RPT_SYN;
     2148    14251    2   SYN_YEAR_ERR: SYN_ERR = %E$IA_YEAR_ERR#; GOTO RPT_SYN;
     2149    14252    2   SYN_MONTH_ERR: SYN_ERR = %E$IA_MONTH_ERR#; GOTO RPT_SYN;
     2150    14253    2   SYN_DAY_ERR: SYN_ERR = %E$IA_DAY_ERR#; GOTO RPT_SYN;
     2151    14254    2   SYN_NO_WILD_ERR: SYN_ERR = %E$IA_NO_WILD_ERR#; GOTO RPT_SYN;
     2152    14255    2   SYN_DATE_RANGE_ERR: SYN_ERR = %E$IA_DATE_RANGE_ERR#; GOTO RPT_SYN;
     2153    14256    2   RPT_SYN:
     2154    14257    2        CALL IAE$ERROR (ON_LINE,SYN_ERR,0,%IA_KEY_SYNTAX_ERR#,EGG_GETCMD.PCB$);
     2155    14258    2        ERROR.ERR# = %E$SYNERR;
     2156    14259    2        ALTRETURN;
     2157    14260                                                /**/
     2158    14261    2   END PARSE$COMMAND;
     2159    14262        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:63   
     2160    14263        /*I*      NAME: MAKE$ENTRY
     2161    14264                  PURPOSE: Puts an entry into the time table.
     2162    14265                  CALL: CALL MAKE$ENTRY (TIME);
     2163    14266                  DATA: TIME is in minutes from midnight
     2164    14267                  DESCRIPTION: This routine puts entries into the time table.
     2165    14268                                 It first finds the places the entry should
     2166    14269                                 be by searching the chain until the TIME is
     2167    14270                                 sorted. It then gets memory for this entry
     2168    14271                                 and stores it.
     2169    14272                             */
     2170    14273    1   MAKE$ENTRY: PROC (TIME) ALTRET;         /* Makes entry for a command */
     2171    14274                                                /**/
     2172    14275    2   DCL TIME SBIN WORD;
     2173    14276                                                /**/
     2174    14277    2   DCL LAST_ENTRY$ PTR;
     2175    14278    2   DCL SAVE_ENTRY$ PTR;
     2176    14279    2   DCL NEW_ENTRY$ PTR;
     2177    14280    2        LAST_ENTRY$ = ADDR(NIL);
     2178    14281    2        SAVE_ENTRY$ = ADDR(NIL);
     2179    14282    2        TIME_ENTRY$ = TIME_HEAD$;          /* Point to begining */
     2180    14283    2        IF TIME < DO_FROM OR TIME > DO_UNTIL /* Do not make entry */
     2181    14284    2        THEN
     2182    14285    2             RETURN;
     2183    14286    2        IF TIME < CURR_TIME OR TIME <= LAST_TIME
     2184    14287    2        THEN
     2185    14288    2             RETURN;
     2186    14289    2        IF TIME_HEAD$ ~= ADDR(NIL)         /* No entries yet */
     2187    14290    2        THEN
     2188    14291    3          DO WHILE(TIME > TIME_TABLE.TIME);
     2189    14292    3               LAST_ENTRY$ = TIME_ENTRY$;  /* Point to this entry */
     2190    14293    3               TIME_ENTRY$ = TIME_TABLE.NEXT$;
     2191    14294    3               IF TIME_ENTRY$ = ADDR(NIL)  /* End of table */
     2192    14295    3               THEN
     2193    14296    3                    EXIT;
     2194    14297    3             END;                          /*  Do while new time > table time  */
     2195    14298    2        NEW_ENTRY$ = PINCRW(SEG_VLP.PTR$ ,(SEG_VLP.W1.VSIZE#+1)/4);
     2196    14299    2        SEG_VLP.W1.VSIZE# = SIZEW(TIME_TABLE);
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:64   
     2197    14300    2        CALL M$GDS(GET_ENTRY)
     2198    14301    3        WHENALTRETURN DO;
     2199    14302    3               CALL IAE$CSCG_ERROR (%IA_KEY_SYNTAX_ERR#,%E$IA_NO_MEM#,EGG_GETCMD.PCB$);
     2200    14303    3               ALTRETURN;
     2201    14304    3             END;                          /*  Whenaltret on M$GDS  */
     2202    14305    2        IF NEW_ENTRY$ = ADDR(NIL)
     2203    14306    2        THEN
     2204    14307    2             NEW_ENTRY$ = SEG_VLP.PTR$;
     2205    14308    2        SAVE_ENTRY$ = TIME_ENTRY$;
     2206    14309    2        TIME_ENTRY$ =  NEW_ENTRY$;
     2207    14310    2        TIME_TABLE.NEXT$ = SAVE_ENTRY$;
     2208    14311    2        TIME_TABLE.TIME = TIME;            /* Save do time */
     2209    14312    2        TIME_TABLE.TYPE = DO_TYPE;         /* Save command type */
     2210    14313    2        TIME_TABLE.COMMAND = DO_CMD;       /* Save command */
     2211    14314    2        TIME_TABLE.SIZE = DO_CMD_SIZE;
     2212    14315    2        TIME_TABLE.GHOST_FID = DO_FID;     /* Save ghost fid */
     2213    14316    2        TIME_TABLE.ACCT = DO_ACCT;
     2214    14317    2        TIME_TABLE.PASS = DO_PASS;
     2215    14318    2        TIME_ENTRY$ = LAST_ENTRY$;         /* Update next in previous */
     2216    14319    2        IF LAST_ENTRY$ = ADDR(NIL)         /* Must be first entry */
     2217    14320    2        THEN
     2218    14321    2             TIME_HEAD$ = NEW_ENTRY$;
     2219    14322    2        ELSE
     2220    14323    2             TIME_TABLE.NEXT$ = NEW_ENTRY$;
     2221    14324    2        RETURN;
     2222    14325    2   END MAKE$ENTRY;
     2223    14326        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:65   
     2224    14327        /*I*      NAME: DO$COMMAND
     2225    14328                  PURPOSE: To perform the command.
     2226    14329                  CALL: CALL DO$COMMAND(FID,COMMAND,TYPE,SIZE);
     2227    14330                  DATA: FID - GHOST NAME
     2228    14331                        COMMAND - FIRST COMMAND or KEYIN
     2229    14332                        TYPE - Type of command
     2230    14333                        SIZE - Size of COMMAND in charactes
     2231    14334                  DESCRIPTION: This routine performs the actual command. It
     2232    14335                                 determines the type and then either
     2233    14336                                 sends a message to the OC, does a keyin,
     2234    14337                                 or starts a ghost job. The operator is told
     2235    14338                                 about the action if the auto scheduling message
     2236    14339                                 is on.
     2237    14340                        */
     2238    14341    1   DO$COMMAND: PROC (FID, COMMAND, TYPE, SIZE, ACCOUNT, PASS);
     2239    14342                                                /**/
     2240    14343    2   DCL ACCOUNT CHAR (8) CALIGNED;
     2241    14344    2   DCL PASS CHAR (8) CALIGNED;
     2242    14345    2   DCL 1 FID,
     2243    14346    2           2 SIZE UBIN BYTE CALIGNED,
     2244    14347    2           2 TEXT CHAR(FID.SIZE) CALIGNED;
     2245    14348    2   DCL COMMAND CHAR(256) CALIGNED;
     2246    14349    2   DCL TYPE UBIN BYTE CALIGNED;
     2247    14350    2   DCL SIZE UBIN BYTE CALIGNED;
     2248    14351    2   DCL SAVE_ACCN CHAR (8);
     2249    14352                                                /**/
     2250    14353    3        DO CASE (TYPE);                    /* Do command */
     2251    14354                                                /**/
     2252    14355
     2253    14356                                                /**/
     2254    14357    3        CASE (%IA_CMD_MESS#);
     2255    14358    3           TELL_CONSOLES.MESS = COMMAND;
     2256    14359    3           TELL_CONSOLES.KEY = %IA_KEY_MSG_MSG#; /* Message type */
     2257    14360    3           CALL M$WRITE(TELL_CSCG);
     2258    14361                                                /**/
     2259    14362                                                /**/
     2260    14363    3        CASE (%IA_CMD_START#);             /* Do gjob */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:66   
     2261    14364    3           TELL_CONSOLES.MESS = COMMAND;   /* Put command in mess */
     2262    14365    3           CALL CONCAT(TELL_CONSOLES.FID,SUBSTR(FID.TEXT,0,FID.SIZE),'.',ACCOUNT);
     2263    14366    3           TELL_CONSOLES.KEY = %IA_KEY_START_MSG#;
     2264    14367    3           IF ~ON_LINE AND GOOSEM_ON
     2265    14368    3           THEN
     2266    14369        /*O*      MESSAGE: GOOSE Gjob: xxxx using command
     2267    14370                  ACTION: Information only
     2268    14371                  MEANING: GOOSE has started ghost job xxxx with the command.
     2269    14372                             */
     2270    14373    3                CALL M$WRITE(TELL_CSCG) ;
     2271    14374                                                /**/
     2272    14375    3           IF FID.SIZE = 0
     2273    14376    3           THEN
     2274    14377    3                START_GJOB.NAME_ = VECTOR (NIL);
     2275    14378    3           ELSE
     2276    14379    4             DO;
     2277    14380    4                  START_GJOB.NAME_ = VECTOR (GJOB_NAME);
     2278    14381    4                  GJOB_NAME.NAME# = FID.TEXT;
     2279    14382    4                  GJOB_NAME.L# = FID.SIZE;
     2280    14383    4                END;
     2281    14384
     2282    14385    3           IF ACCOUNT = ' '
     2283    14386    3           THEN
     2284    14387    3                START_GJOB.ACCT_ = VECTOR (NIL);
     2285    14388    3           ELSE
     2286    14389    4             DO;
     2287    14390    4                  START_GJOB.ACCT_ = VECTOR (GJOB_ACCT);
     2288    14391    4                  GJOB_ACCT.ACCT# = ACCOUNT;
     2289    14392    4                END;
     2290    14393
     2291    14394                                                /**/
     2292    14395    3           IF PASS ~= ' '
     2293    14396    3           THEN
     2294    14397    4             DO;
     2295    14398    4                  GJOB_PASS.PASS# = PASS;
     2296    14399    4                  START_GJOB.PASS_ = VECTOR (GJOB_PASS);
     2297    14400    4                END;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:67   
     2298    14401    3           ELSE
     2299    14402    3                START_GJOB.PASS_ = VECTOR (NIL);
     2300    14403                                                /**/
     2301    14404    3           IF COMMAND ~= ' '
     2302    14405    3           THEN
     2303    14406    3                START_GJOB.CCBUF_ = VECTOR (COMMAND);
     2304    14407    3           ELSE
     2305    14408    3                START_GJOB.CCBUF_ = VECTOR (NIL);
     2306    14409                                                /**/
     2307    14410    3           CALL M$GJOB (START_GJOB)
     2308    14411    4           WHENALTRETURN DO;
     2309    14412    4                  ERROR = %SYSTEM_ERROR;
     2310    14413    4                  IF ON_LINE
     2311    14414    4                  THEN
     2312    14415    4                       CALL IAE$ERROR (ON_LINE,%E$IA_GJOB_ERR#,ERROR,%IA_KEY_START_ERR#
             14415                                ,EGG_GETCMD.PCB$);
     2313    14416    4                  ELSE
     2314    14417    4                       CALL IAE$ERROR (ON_LINE,0,ERROR,%IA_KEY_START_ERR#,EGG_GETCMD.
             14417                                PCB$);
     2315    14418    4                  RETURN;
     2316    14419    4                END;                       /*  Whenaltreturn  */
     2317    14420                                                /**/
     2318    14421    3           IF ON_LINE
     2319    14422    3           THEN
     2320    14423    4             DO;
     2321    14424    4                  CALL BINCHAR (SYSID, GJOB_RESULTS.SYSID);
     2322    14425    4                  CALL CONCAT (MESS_BUF,
     2323    14426    4                       'Ghost started with sysid: ',
     2324    14427    4                       SYSID);
     2325    14428    4                  CALL M$WRITE (OUT_MESS) ;
     2326    14429    4                END;
     2327    14430                                                /**/
     2328    14431                                                /**/
     2329    14432    3        CASE (%IA_CMD_DO#);                /* Wants to do a keyin */
     2330    14433    3           TELL_CONSOLES.KEY = %IA_KEY_KEYIN_MSG#; /* Keyin message */
     2331    14434    3           TELL_CONSOLES.MESS = COMMAND;
     2332    14435    3           IF GOOSEM_ON                    /* Check if messages on */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:68   
     2333    14436    3           THEN
     2334    14437        /*O*      MESSAGE: GOOSE Keyin: xxxx
     2335    14438                  ACTION: Information only
     2336    14439                  MEANING: GOOSE is doing the keyin xxxx
     2337    14440                   */
     2338    14441    3                CALL M$WRITE(TELL_CSCG) ;
     2339    14442    3           SEND_KEYIN.KEYIN = COMMAND;     /* Put keyin in buffer */
     2340    14443    3           SEND_KEYIN.SIZE = SIZE;         /* Length of keyin */
     2341    14444    3           CALL M$WRITE(KEYIN_CSCG) ;
     2342    14445    3        END;                               /* End cases */
     2343    14446    2        RETURN;
     2344    14447    2   END DO$COMMAND;
     2345    14448        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:69   
     2346    14449        /*I*      NAME: DO$EVENT
     2347    14450                  PURPOSE: To do the appopiate event received from CSCG
     2348    14451                  CALL: CALL  DO$EVENT
     2349    14452                  DESCRIPTION: This routine handles an event that came in
     2350    14453                            from CSCG. When the event took place GOOSE_READ_FLAG
     2351    14454                            was set indicating an event occured and the
     2352    14455                            type of event is in CSCG_BUF. The routine does
     2353    14456                            the indicated action and then issues another
     2354    14457                            read from CSCG.
     2355    14458                             */
     2356    14459    1   DO$EVENT: PROC ;
     2357    14460                                                /*  */
     2358    14461        %OC_MESSHD_W    (NAME=TELL_CONSOLES,    /* Used to tell consoles */
     2359    14462                        ATR=M_SYS,              /* Tell system consoles */
     2360    14463                       MSG=GOOSE_SMSG#,
     2361    14464                       NPARMS = 1,
     2362    14465                       FUNC=WR);
     2363    14478    2        2 * UBIN BYTE INIT(1) CALIGNED,
     2364    14479    2             2 TYPE UBIN BYTE CALIGNED;
     2365    14480        %FPT_WRITE (FPTN=WR_CSCG,               /* Write to consoles */
     2366    14481                       BUF=TELL_CONSOLES,       /* Message buffer */
     2367    14482                       STATION=STA_KEYIN,       /* Write to keyin */
     2368    14483                       WAIT=YES,                /* Wait for completion */
     2369    14484                       DCB=M$CSCG);
     2370    14515                                                /**/
     2371    14516        /* Begin main program */
     2372    14517    2        IF NOT GOOSE_ERR                   /* No error on read */
     2373    14518    2        THEN
     2374    14519                                                /**/
     2375    14520                                           /* Got the green light to start from slug */
     2376    14521    3          DO CASE (ADDR (CSCG_BUF) -> CSCG_KEYIN.KEY);
     2377    14522                                                /**/
     2378    14523                                                /**/
     2379    14524    3          CASE (1 /* KEY_GOOSEON# */);
     2380    14525    3             IF GOOSE_ON
     2381    14526    3             THEN
     2382    14527    4               DO;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:70   
     2383    14528    4                    TELL_CONSOLES.CADDR = ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR;
             14528                             /* Error */
     2384    14529    4                    TELL_CONSOLES.TYPE = 0; /* Allready on */
     2385    14530    4                    IF ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR ~= '777777'O
             14530                             /* From online */
     2386    14531    4                    THEN
     2387    14532    4                         CALL M$WRITE(WR_CSCG) ;
     2388    14533    4                  END;
     2389    14534    3             ELSE
     2390    14535    4               DO;
     2391    14536    4                    TELL_CONSOLES.CADDR = '200000'O /* M_SYS  */;
     2392    14537    4                    TELL_CONSOLES.TYPE = 1;
     2393    14538    4                    CALL M$WRITE(WR_CSCG)
     2394    14539    5                    WHENRETURN DO;
     2395    14540    5                           GOOSE_ON = %YES#;
     2396    14541    5                         END;              /* Whenreturn */
     2397    14542    4                  END;
     2398    14543                                                /**/
     2399    14544    3          CASE (2 /* KEY_GOOSEOFF# */);
     2400    14545    3             IF ~GOOSE_ON
     2401    14546    3             THEN
     2402    14547    4               DO;
     2403    14548    4                    TELL_CONSOLES.CADDR = ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR;
             14548                             /* Error */
     2404    14549    4                    TELL_CONSOLES.TYPE = 2; /* Allready off */
     2405    14550    4                    IF ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR ~= '777777'O
             14550                             /* From online */
     2406    14551    4                    THEN
     2407    14552    4                         CALL M$WRITE(WR_CSCG) ;
     2408    14553    4                  END;
     2409    14554    3             ELSE
     2410    14555    4               DO;
     2411    14556    4                    TELL_CONSOLES.CADDR = '200000'O /* M_SYS  */;
     2412    14557    4                    TELL_CONSOLES.TYPE = 3;
     2413    14558    4                    CALL M$WRITE(WR_CSCG)
     2414    14559    5                    WHENRETURN DO;
     2415    14560    5                           GOOSE_ON = %NO#;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:71   
     2416    14561    5                         END;              /* Whenreturn */
     2417    14562    4                  END;
     2418    14563                                                /**/
     2419    14564    3          CASE (4 /* KEY_GOOSEMON# */);
     2420    14565    3             IF GOOSEM_ON
     2421    14566    3             THEN
     2422    14567    4               DO;
     2423    14568    4                    TELL_CONSOLES.CADDR = ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR;
             14568                             /* Error */
     2424    14569    4                    TELL_CONSOLES.TYPE = 8; /* Allready on */
     2425    14570    4                    IF ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR ~= '777777'O
             14570                             /* From online */
     2426    14571    4                    THEN
     2427    14572    4                         CALL M$WRITE(WR_CSCG) ;
     2428    14573    4                  END;
     2429    14574    3             ELSE
     2430    14575    4               DO;
     2431    14576    4                    TELL_CONSOLES.CADDR = '200000'O /* M_SYS  */;
     2432    14577    4                    TELL_CONSOLES.TYPE = 7;
     2433    14578    4                    CALL M$WRITE(WR_CSCG)
     2434    14579    5                    WHENRETURN DO;
     2435    14580    5                           GOOSEM_ON = %YES#;
     2436    14581    5                         END;              /* Whenreturn */
     2437    14582    4                  END;
     2438    14583                                                /**/
     2439    14584    3          CASE (5 /* KEY_GOOSEMOFF# */);
     2440    14585    3             IF ~GOOSEM_ON
     2441    14586    3             THEN
     2442    14587    4               DO;
     2443    14588    4                    TELL_CONSOLES.CADDR = ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR;
             14588                             /* Error */
     2444    14589    4                    TELL_CONSOLES.TYPE = 6; /* Allready off */
     2445    14590    4                    IF ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR ~= '777777'O
             14590                             /* From online */
     2446    14591    4                    THEN
     2447    14592    4                         CALL M$WRITE(WR_CSCG) ;
     2448    14593    4                  END;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:72   
     2449    14594    3             ELSE
     2450    14595    4               DO;
     2451    14596    4                    TELL_CONSOLES.CADDR = '200000'O /* M_SYS  */;
     2452    14597    4                    TELL_CONSOLES.TYPE = 5;
     2453    14598    4                    CALL M$WRITE(WR_CSCG)
     2454    14599    5                    WHENRETURN DO;
     2455    14600    5                           GOOSEM_ON = %NO#;
     2456    14601    5                         END;              /* Whenreturn */
     2457    14602    4                  END;
     2458    14603                                                /**/
     2459    14604    3          CASE (3 /* KEY_GOOSEUPD# */);            /* Want an update */
     2460    14605    3             TELL_CONSOLES.CADDR = '200000'O /* M_SYS  */;  /* Tell system consoles */
     2461    14606    3             TELL_CONSOLES.TYPE=4;         /* Update message */
     2462    14607    3             CALL M$WRITE(WR_CSCG) ;
     2463    14608    3             MODIFY_DATE = 0;              /* Forces update */
     2464    14609
     2465    14610    3          CASE (ELSE);
     2466    14611
     2467    14612                                                /**/
     2468    14613                                      /* Have yet to receive ok to start
     2469    14614                                         from slug. */
     2470    14615                                                /**/
     2471    14616    4             DO CASE (ADDR (CSCG_BUF) -> CSCG_EVENT.CODE);
     2472    14617                                                /**/
     2473    14618                                      /* SUSR# (start user) is a message
     2474    14619                                         from slug which means goose can
     2475    14620                                         now build and execute the time
     2476    14621                                         table.         */
     2477    14622                                                /**/
     2478    14623    4             CASE (1 /* SUSR# */);
     2479    14624    4                GREEN_LIGHT = %YES#;
     2480    14625    4             END;
     2481    14626    3          END;                             /* End cases */
     2482    14627    2        GOOSE_READ_FLAG = %NO#;
     2483    14628    2        CALL M$READ(READ_CSCG);            /* Read from cscg */
     2484    14629    2   END DO$EVENT;
     2485    14630        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:73   
     2486    14631    1   END IAA$GOOSE;
     2487    14632        %EOD;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:74   
--  Include file information  --

   XU_SUBS_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XUG_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   JG_EVID_C.:E05TOU  is referenced.
   IA_MACRO_C.:E05TOU  is referenced.
   IA_PERR_C.:E05TOU  is referenced.
   IA_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   IA_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure IAA$GOOSE.

   Procedure IAA$GOOSE requires 2958 words for executable code.
   Procedure IAA$GOOSE requires 84 words of local(AUTO) storage.

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:75   

 Object Unit name= IAA$GOOSE                                  File name= IAA$MAIN.:E05TOU
 UTS= JUL 29 '97 22:25:19.60 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none  3080   6010  IAA$GOOSE
    2   DCB   even  none     0      0  M$SI
    3   DCB   even  none     0      0  M$DO
    4   DCB   even  none     0      0  M$SCHED
    5   DCB   even  none     0      0  M$LL
    6   DCB   even  none     0      0  M$LO
    7   DCB   even  none     0      0  M$CSCG
    8   DCB   even  none     0      0  M$TEMP
    9   DCB   even  none     0      0  M$TABLE
   10  RoData even  UTS     52     64  IAA$GOOSE
   11   Proc  even  none  2958   5616  IAA$GOOSE
   12  RoData even  none   114    162  IAA$GOOSE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    11      0   yes            yes      Main       0  IAA$GOOSE

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1    373  GOOSE_ERR                          1    374  GOOSE_READ_FLAG
    1    375  GOOSE_OUT$
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:76   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 IAA$ABORT_CMD
 yes     yes           Std       0 IAD$DATE
 yes     yes           Std       2 XTX$ADAPT
 yes     yes           Std       2 XSF$LOCCODP
 yes     yes           Std       1 XUG$ECHOIF
         yes          Async      0 IAA$EVENT
         yes          Async      0 XUG$BREAK
 yes     yes           Std       1 XUG$GETCMD
         yes           Std       2 IAE$ONLINE_ERROR
 yes     yes           Std       2 XUG$INIT
 yes     yes           Std       1 XUG$ERRPTR
         yes           Std       0 IAM$LEAP
         yes           Std       0 IAM$CYCLE
         yes           Std       3 IAE$CSCG_ERROR
         yes           Std       5 IAE$ERROR
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  MESS_BUF                              TIME_DIFF
     TEMP_SEC                              TEMP_DAYS                             TEMP_MONTHS
     TEMP_YEARS                            CYCLE_DAYS_LAST                       CYCLE_DAYS_CURRENT
     TOTAL_DAYS                            ABORT_CMD                             M$SI
     M$DO                                  M$SCHED                               M$LL
     M$LO                                  M$CSCG                                M$TEMP
     M$TABLE                               B$TCB$                                B$JIT$
     GOOSE_NODES                           GOOSE_ONODES                          GOOSE_ONODES2
     B_VERSION                             B_VECTNIL
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:77   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:78   


        1        1        /*M* IAA$GOOSE  Goose's main program  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CCC=YES,DMR,PLM=5,IND=5,CTI=5,SDI=4,MCL=10,CSI=0,ECI=0,DTI=2 */
        8        8        %SET LISTSUB = '1'B;
        9        9        IAA$GOOSE: PROC MAIN;

      9 11 000000   000000 700200 xent  IAA$GOOSE    TSX0  ! X66_MAUTO
        11 000001   000124 000000                    ZERO    84,0

       10       10                                                /* */
       11       11        /*P*      NAME: GOOSE
       12       12                  PURPOSE: Automatically schedules ghost jobs and keyins
       13       13                  DESCRIPTION: Goose allows the automatic scheduling of
       14       14                                 ghost jobs, operator keyins, and operator
       15       15                                 messages. The commands for GOOSE are contained
       16       16                                 in a file GOOSE_EGG the resides in :SYS.
       17       17                                                           */
       18       18        /*D*      NAME: IAA$GOOSE
       19       19                  CALL: None - main program
       20       20                  INTERFACE: IAA$EVENT, IAA$ABORT_CMD, IAE$ERROR
       21       21                  DESCRIPTION: This is the main program for the GOOSE
       22       22                                 processor. If it is running as
       23       23                                 a ghost program it will build the time
       24       24                                 table and then calculate how many minutes
       25       25                                 it must wait until something needs to be
       26       26                                 done or ten mintues which ever is less. It
       27       27                                 then checks to see if GOOSE_EGG file has
       28       28                                 been changed and rebuilds the time table if
       29       29                                 it has. Then it will do any commands that
       30       30                                 it is time to do and go back to sleep. When
       31       31                                 the program first starts it opens and issues
       32       32                                 a read to CSCG to receive commands from
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:79   
       33       33                                 KEYIN or an online GOOSE job. IAA$EVENT
       34       34                                 will handle the event completion of the read.
       35       35                                 If GOOSE is run online it uses XUG$GETCMD
       36       36                                 to read and parse commands.
       37       37                                 These commands can: turn on and off
       38       38                                 auto scheduling or auto scheduling message,
       39       39                                 tell ghost GOOSE that GOOSE_EGG has been
       40       40                                 changed, do a keyin from online, start a
       41       41                                 ghost job, or update the GOOSE_EGG file.
       42       42              */
       43       43                                                /* */
       44       44
       45       45        %INCLUDE CP_6;
       46      126        %INCLUDE CP_6_SUBS;
       47      666        %INCLUDE IA_SUBS_C;
       48      736        %INCLUDE XUH_MACRO_C;
       49      820        %INCLUDE XU_MACRO_C;
       50     3926        %INCLUDE F$DCB;
       51     3975        %INCLUDE OC_SUBS_C;
       52     4706        %INCLUDE FM$FIT;
       53     4927        %INCLUDE B_ERRORS_C;
       54     6054        %INCLUDE B$JIT;
       55     6344        %INCLUDE OC_MESSHD_C;
       56     6397        %INCLUDE IA_DAT_R;
       57     6415        %INCLUDE IA_PERR_C;
       58     6456        %INCLUDE IA_MACRO_C;
       59     6512        %INCLUDE JG_EVID_C;
       60     6737        %INCLUDE JG_GHOSTS_C ;
       61     6827        %INCLUDE XUG_ENTRY;
       62     6858        %INCLUDE XU_PERR_C;
       63     7049        %INCLUDE XU_SUBS_C;
       64     7141                                                /* */
       65     7142        %B$TCB;
       66     7145        %B$ALT;
       67     7153        %PARSE$OUT (NAME=OUT$BLK,STCLASS=BASED);
       68     7198        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
       69     7236
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:80   
       70     7237
       71     7238        %XUG_INIT (NAME=ONLINE_INIT,
       72     7239                   ABORT=IAA$ABORT_CMD,
       73     7240                   BRKMSG=NIL,
       74     7241                   CONTINUE=NIL,
       75     7242                   COMMANDS=YES,
       76     7243                   ECHO=HONOR_FLAG,
       77     7244                   GOODCMD=YES,
       78     7245                   PASS=BLANK,
       79     7246                   POST_EXEC=NIL,
       80     7247                   PRE_EXEC=NIL,
       81     7248                   PROCNAME=HELP_NAME,
       82     7249                   SPELLING=YES,
       83     7250                   SYNTAX=YES,
       84     7251                   WORK=NIL);
       85     7664                                                /**/
       86     7665        %XUG_INIT (NAME=GHOST_INIT,
       87     7666                   ABORT=NIL,
       88     7667                   BRKMSG=NIL,
       89     7668                   CONTINUE=NIL,
       90     7669                   COMMANDS=NO,
       91     7670                   ECHO=NEVER_ECHO,
       92     7671                   GOODCMD=NO,
       93     7672                   PASS=BLANK,
       94     7673                   POST_EXEC=NIL,
       95     7674                   PRE_EXEC=NIL,
       96     7675                   PREPROCESS=NO,
       97     7676                   PROCNAME=HELP_NAME,
       98     7677                   SPELLING=NO,
       99     7678                   SYNTAX=NO,
      100     7679                   WORK=NIL);
      101     8092                                                /**/
      102     8093        %XUG_INIT (NAME=UPDATE_INIT,
      103     8094                   ABORT=NIL,
      104     8095                   BRKMSG=NIL,
      105     8096                   CONTINUE=NIL,
      106     8097                   COMMANDS=NO,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:81   
      107     8098                   ECHO=NEVER_ECHO,
      108     8099                   GOODCMD=NO,
      109     8100                   PASS=LEAVE,
      110     8101        /*           PCB=ONLINE_PCB,*/
      111     8102                   POST_EXEC=NIL,
      112     8103                   PRE_EXEC=NIL,
      113     8104                   PREPROCESS=NO,
      114     8105                   PROCNAME=HELP_NAME,
      115     8106                   SPELLING=NO,
      116     8107                   SYNTAX=NO,
      117     8108                   WORK=NIL);
      118     8521                                                /**/
      119     8522        %XUG_GETCMD (NAME = ONLINE_GETCMD,
      120     8523                     ALWAYS_SET_PROMPT = NO,
      121     8524                     CONTINUE_OK = YES,
      122     8525                     DCB2_PARAM = M$DO,
      123     8526                     DCB_PARAM = M$LO,
      124     8527                     INDCB = M$SI,              /* M$SI */
      125     8528                     NODES = NIL,               /* set at run time */
      126     8529                     OUTDCB = M$LO,
      127     8530                     PROMPT = OPROMPT,
      128     8531                     PROMPT_VFC = NO,
      129     8532                     READR = NIL,
      130     8533                     RPROMPT = NIL);
      131     8871                                                /**/
      132     8872        %XUG_GETCMD (NAME = EGG_GETCMD,
      133     8873                     ALWAYS_SET_PROMPT = NO,
      134     8874                     CONTINUE_OK = YES,
      135     8875                     DCB2_PARAM = M$DO,
      136     8876                     DCB_PARAM = NIL,
      137     8877                     INDCB = NIL,               /* set at run time */
      138     8878                     NODES = GOOSE_NODES,
      139     8879                     OUTDCB = NIL,
      140     8880                     PROMPT = NIL,
      141     8881                     PROMPT_VFC = NO,
      142     8882                     READR = NIL,
      143     8883                     USE_EPOS = YES,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:82   
      144     8884                     RPROMPT = NIL);
      145     9222                                                /**/
      146     9223
      147     9224        %XUG_PARAMS;
      148     9668
      149     9669        %XUG_RLT (NAME=RLT,STCLASS="BASED(RLT$)");
      150     9676
      151     9677    1   DCL M$SI DCB;
      152     9678    1   DCL M$DO DCB;
      153     9679    1   DCL M$SCHED DCB;
      154     9680    1   DCL M$LL DCB;
      155     9681    1   DCL M$LO DCB;
      156     9682    1   DCL M$CSCG DCB;
      157     9683    1   DCL M$TEMP DCB;
      158     9684    1   DCL M$TABLE DCB;
      159     9685                                                /**/
      160     9686    1   DCL IAD$DATE ENTRY ALTRET;
      161     9687    1   DCL IAM$LEAP ENTRY;
      162     9688    1   DCL IAE$ERROR ENTRY(5);
      163     9689    1   DCL IAE$CSCG_ERROR ENTRY(3);
      164     9690    1   DCL IAE$ONLINE_ERROR ENTRY(2);
      165     9691    1   DCL IAA$EVENT ENTRY ASYNC;
      166     9692    1   DCL IAA$ABORT_CMD ENTRY;
      167     9693    1   DCL IAM$CYCLE ENTRY;
      168     9694    1   DCL XSF$LOCCODP ENTRY (2) ALTRET;
      169     9695
      170     9696        %OC_MESSHD_W   (NAME=TELL_CONSOLES,     /* Template to tell console */
      171     9697                            ATR=M_SYS,          /* Tell system consoles */
      172     9698                            FUNC=WR,
      173     9699                            NPARMS = 4,
      174     9700                            MSG=GOOSE_EMSG#);
      175     9713    1        2 * (0:3) UBIN BYTE CALIGNED INIT(1,4,80,20),
      176     9714    1             2 KEY UBIN BYTE CALIGNED,
      177     9715    1             2 ERROR BIT(36) CALIGNED,
      178     9716    1             2 MESS CHAR(80) CALIGNED,
      179     9717    1             2 FID CHAR(20) CALIGNED;
      180     9718        %OC_MESSHD_W (NAME=SEND_KEYIN,          /* Keyin in template */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:83   
      181     9719                       ATR=M_SYS,
      182     9720                       FUNC=IKI,
      183     9721                       NPARMS=1);
      184     9734    1        2 SIZE UBIN BYTE CALIGNED,
      185     9735    1             2 KEYIN CHAR(80);
      186     9736                                                /**/
      187     9737        /*  Symdef's and symref's  */
      188     9738                                                /**/
      189     9739    1   DCL B$TCB$ PTR SYMREF;
      190     9740    1   DCL B$JIT$ PTR SYMREF;
      191     9741    1   DCL GOOSE_ERR BIT(36) STATIC SYMDEF;
      192     9742    1   DCL GOOSE_NODES PTR SYMREF;
      193     9743    1   DCL GOOSE_ONODES PTR SYMREF;            /* Gooses online nodes */
      194     9744    1   DCL GOOSE_ONODES2 PTR SYMREF;
      195     9745
      196     9746
      197     9747    1   DCL GOOSE_READ_FLAG BIT(1) STATIC SYMDEF INIT('0'B);
      198     9748    1   DCL GOOSE_OUT$ PTR STATIC SYMDEF;
      199     9749                                                /**/
      200     9750        /*  Static variables  */
      201     9751                                                /**/
      202     9752    1   DCL CSCG_BUF CHAR(140) STATIC CALIGNED INIT (' ');
      203     9753    1   DCL CURR_DATE_JULIAN UBIN WORD STATIC ALIGNED INIT (0);
      204     9754    1   DCL CURR_TIME_HOLD UBIN WORD STATIC ALIGNED;
      205     9755    1   DCL CURR_TIME SBIN WORD STATIC;         /* Current time */
      206     9756    1   DCL DO_ACCT CHAR (8) STATIC;
      207     9757    1   DCL DO_CMD CHAR(256) STATIC;
      208     9758    1   DCL 1 DO_DATE STATIC,
      209     9759    1           2 YY CHAR(2),
      210     9760    1           2 MM CHAR(2) CALIGNED,
      211     9761    1           2 ERROR UBIN CALIGNED,
      212     9762    1           2 DD CHAR(2) CALIGNED;
      213     9763    1   DCL 1 DO_DATER REDEF DO_DATE,
      214     9764    1           2 Y1 CHAR(1),
      215     9765    1           2 Y2 CHAR(1),
      216     9766    1           2 M1 CHAR(1),
      217     9767    1           2 M2 CHAR(1),
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:84   
      218     9768    1           2 * UBIN CALIGNED,
      219     9769    1           2 D1 CHAR(1),
      220     9770    1           2 D2 CHAR(1);
      221     9771    1   DCL DO_PASS CHAR (8) STATIC;
      222     9772    1   DCL 1 EDIT_CMD STATIC,
      223     9773    1           2 * UBIN BYTE CALIGNED INIT(11),
      224     9774    1           2 * CHAR(0) INIT ('EDIT *GOOSE');
      225     9775    1   DCL 1 EDIT_KEY STATIC,                  /* Used to right edit keys */
      226     9776    1           2 * UBIN BYTE CALIGNED INIT(3),
      227     9777    1           2 NUM UBIN(27) CALIGNED;
      228     9778    1   DCL ELAPSED_MINS SBIN WORD STATIC INIT(0);
      229     9779    1   DCL FPARAM(0:1023) UBIN WORD STATIC;
      230     9780    1   DCL 1 GOOSE_OFF_M STATIC,
      231     9781    1           2 * UBIN BYTE CALIGNED INIT(0),
      232     9782    1           2 * UBIN BYTE CALIGNED INIT(2 /* KEY_GOOSEOFF# */),
      233     9783    1           2 * BIT(18)  CALIGNED INIT ('777777'O);
      234     9784    1   DCL GOOSE_ON BIT(1) STATIC INIT('1'B);  /* Goose on flag */
      235     9785    1   DCL 1 GOOSE_ON_M STATIC,
      236     9786    1           2 * UBIN BYTE CALIGNED INIT(0),
      237     9787    1           2 * UBIN BYTE CALIGNED INIT(1 /* KEY_GOOSEON# */),
      238     9788    1           2 * BIT(18)  CALIGNED INIT ('777777'O);
      239     9789    1   DCL GOOSE_UPD BIT(1) STATIC INIT ('0'B);/* Set when keyin indicated upd */
      240     9790    1   DCL 1 GOOSE_UPD_M STATIC,
      241     9791    1           2 * UBIN BYTE CALIGNED INIT(0),
      242     9792    1           2 * UBIN BYTE CALIGNED INIT(3 /* KEY_GOOSEUPD# */),
      243     9793    1           2 * BIT(18)  CALIGNED INIT ('777777'O);
      244     9794    1   DCL 1 GOOSEM_OFF_M STATIC,
      245     9795    1           2 * UBIN BYTE CALIGNED INIT(0),
      246     9796    1           2 * UBIN BYTE CALIGNED INIT(5 /* KEY_GOOSEMOFF# */),
      247     9797    1           2 * BIT(18)  CALIGNED INIT ('777777'O);
      248     9798    1   DCL GOOSEM_ON BIT(1) STATIC INIT('1'B); /* Goose on flag */
      249     9799    1   DCL 1 GOOSEM_ON_M STATIC,
      250     9800    1           2 * UBIN BYTE CALIGNED INIT(0),
      251     9801    1           2 * UBIN BYTE CALIGNED INIT(4 /* KEY_GOOSEMON# */),
      252     9802    1           2 * BIT(18)  CALIGNED INIT ('777777'O);
      253     9803    1   DCL GREEN_LIGHT BIT(1) STATIC UNAL INIT ('0'B);
      254     9804    1   DCL IA_LOWPRIV BIT(1) STATIC INIT('1'B);
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:85   
      255     9805    1   DCL INBUF CHAR(1024) STATIC;
      256     9806    1   DCL 1 LAST_DATE STATIC,
      257     9807    1           2 YR CHAR(2) CALIGNED,
      258     9808    1           2 MON CHAR(2) CALIGNED,
      259     9809    1           2 DAY CHAR(2) CALIGNED,
      260     9810    1           2 * CHAR(2) CALIGNED;
      261     9811    1   DCL LAST_DATE_JULIAN UBIN WORD STATIC ALIGNED INIT (0);
      262     9812    1   DCL LAST_TIME SBIN HALF STATIC INIT(-1); /* Time last checked */
      263     9813    1   DCL LEGAL_DAYS CHAR(21) STATIC INIT ('SUNMONTUEWEDTHUFRISAT');
      264     9814    1   DCL 1 LIST_CMD STATIC,
      265     9815    1           2 * UBIN BYTE CALIGNED INIT(24),
      266     9816    1           2 * CHAR(0) INIT ('C GOOSE_EGG.:SYS OVER ME');
      267     9817    1   DCL MORE_INFO BIT(1) STATIC UNAL INIT ('1'B);
      268     9818    1   DCL NUM_DAYS SBIN WORD STATIC ALIGNED INIT (0);
      269     9819    1   DCL ON_LINE BIT(1) ALIGNED STATIC INIT('0'B); /* 0 = ghost 1 = online */
      270     9820    1   DCL 1 OPROMPT  CONSTANT CALIGNED,
      271     9821    1           2 COUNT UBIN BYTE INIT(1) CALIGNED,
      272     9822    1           2 TEXT CHAR(1) INIT(':');
      273     9823    1   DCL OUR_TIME_ESTIMATE UBIN WORD STATIC ALIGNED INIT (0);
      274     9824    1   DCL OUT$ PTR STATIC;
      275     9825    1   DCL PARSE_WK (0:200) UBIN WORD STATIC;
      276     9826    1   DCL 1 PCL_CMD STATIC,
      277     9827    1           2 * UBIN BYTE CALIGNED INIT(40),
      278     9828    1           2 * CHAR(0) INIT ('C GOOSE_EGG.:SYS OVER GOOSE_EGG.:SYS(LN)');
      279     9829    1   DCL START_TIME SBIN WORD STATIC INIT (9999);
      280     9830    1   DCL START_UP BIT(1) STATIC INIT ('0'B);
      281     9831    1   DCL SYSID CHAR(6) STATIC INIT (' ');
      282     9832    1   DCL 1 TEXT_DATE STATIC,                 /* Used to get current date */
      283     9833    1           2 YR CHAR(2) CALIGNED,
      284     9834    1           2 MON CHAR(2) CALIGNED,
      285     9835    1           2 DAY CHAR(2) CALIGNED,
      286     9836    1           2 * CHAR(2);
      287     9837    1   DCL 1 TEXT_DATER REDEF TEXT_DATE,
      288     9838    1           2 TEXT CHAR(6) CALIGNED,
      289     9839    1           2 * CHAR(2) CALIGNED;
      290     9840    1   DCL TEXT_DAY CHAR(3) STATIC;            /* Current day */
      291     9841    1   DCL 1 TEXT_TIME STATIC,                 /* Used to get current time */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:86   
      292     9842    1           2 HR_MIN CHAR(4) CALIGNED,
      293     9843    1           2 SEC CHAR(2) CALIGNED,
      294     9844    1           2 * CHAR(2) CALIGNED;
      295     9845    1   DCL TIME_ENTRY$ PTR STATIC;
      296     9846    1   DCL TIME_HEAD$ PTR STATIC INIT(ADDR(NIL)); /* Pointer to table head */
      297     9847    1   DCL TIME_LEFT SBIN WORD STATIC;         /* Time left in wait */
      298     9848    1   DCL TIME_WARP BIT(1) UNAL STATIC INIT ('0'B);
      299     9849    1   DCL TP_FLAG BIT(1) STATIC INIT ('0'B);
      300     9850    1   DCL B_VERSION CHAR(1) SYMREF;
      301     9851    1   DCL 1 B$VERSIONB BASED,
      302     9852    1           2 C_ UBIN BYTE CALIGNED,
      303     9853    1           2 T_ CHAR (B$VERSIONB.C_) CALIGNED;
      304     9854
      305     9855                                                /**/
      306     9856        /*  Based variables  */
      307     9857                                                /**/
      308     9858    1   DCL CMD_BUFFER CHAR(255) BASED;
      309     9859    1   DCL 1 CSCG_KEYIN BASED,
      310     9860    1           2 * UBIN BYTE CALIGNED,
      311     9861    1           2  KEY UBIN BYTE CALIGNED,
      312     9862    1           2 CADDR BIT(18) HALIGNED,
      313     9863    1           2 TPNAME CHAR (8) CALIGNED,
      314     9864    1           2 * CHAR(128) CALIGNED;
      315     9865    1   DCL 1 TIME_TABLE BASED (TIME_ENTRY$),   /* Structure for entries */
      316     9866    1           2 TIME UBIN HALF,               /* Do time */
      317     9867    1           2 GHOST_FID,
      318     9868    1               3 SIZE UBIN BYTE CALIGNED,
      319     9869    1               3 TEXT CHAR(19) CALIGNED,
      320     9870    1           2 ACCT CHAR (8) CALIGNED,
      321     9871    1           2 PASS CHAR (8) CALIGNED,
      322     9872    1           2 TYPE UBIN BYTE CALIGNED, /* Type of command 0=KEYIN,1=GJOB,2=MES */
      323     9873    1           2 SIZE UBIN BYTE CALIGNED,      /* Size of command */
      324     9874    1           2 COMMAND CHAR(256) CALIGNED,   /* Keyin or command */
      325     9875    1           2 NEXT$ PTR;                    /* Pointer to next entry */
      326     9876                                                /**/
      327     9877        /*  Auto variables  */
      328     9878                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:87   
      329     9879    1   DCL DO_CMD_SIZE UBIN BYTE;
      330     9880    1   DCL DO_DAY(0:6) CHAR(3);
      331     9881    1   DCL DO_EVERY SBIN WORD;
      332     9882    1   DCL 1 DO_FID,
      333     9883    1           2 SIZE UBIN BYTE CALIGNED,
      334     9884    1           2 TEXT CHAR(19) CALIGNED;
      335     9885    1   DCL DO_FROM SBIN WORD;
      336     9886    1   DCL DO_HOUR SBIN WORD;                  /* DO_ variable contain the */
      337     9887    1   DCL DO_OFFSET SBIN WORD;
      338     9888    1   DCL DO_TMIN SBIN WORD;                  /* Parse command items */
      339     9889    1   DCL DO_TYPE UBIN BYTE;
      340     9890    1   DCL DO_UMIN SBIN WORD;
      341     9891    1   DCL DO_UNTIL SBIN WORD;
      342     9892    1   DCL ERROR_FLAG BIT(1);
      343     9893    1   DCL GOOSE_ERROR UBIN;
      344     9894    1   DCL I SBIN WORD;
      345     9895    1   DCL MODIFY_DATE UBIN(36);
      346     9896    1   DCL PTR$ PTR;
      347     9897    1   DCL RLT$ PTR;
      348     9898    1   DCL TEMP$ PTR;
      349     9899    1   DCL XUG$  PTR;
      350     9900    1   DCL XUG_P$ PTR;
      351     9901                                                /**/
      352     9902                                                /**/
      353     9903                                      /* Generate template for all cscg
      354     9904                                         messages passed to goose (with
      355     9905                                         the exception of keyins). */
      356     9906                                                /**/
      357     9907        %IA_CITE       (FPTN=CSCG_EVENT,
      358     9908                            STCLASS=BASED);
      359     9934                                                /**/
      360     9935                                                /**/
      361     9936                                                /**/
      362     9937        %FPT_GDS (FPTN=GET_ENTRY,               /* Get an entry of TIME_TABLE */
      363     9938                       RESULTS=SEG_VLP,
      364     9939                       SEGSIZE = "SIZEW(TIME_TABLE)",
      365     9940                       FREE=NO);
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:88   
      366     9956                                                /**/
      367     9957        %FPT_FDS (FPTN=FREE_DATA,               /* Free dynamic segment */
      368     9958                       SEGSIZE="BITBIN('777777'O)",
      369     9959                       RESULTS=SEG_VLP);
      370     9974                                                /**/
      371     9975        %VLP_VECTOR (FPTN=SEG_VLP);
      372     9990                                                /**/
      373     9991        %FPT_ERRMSG (FPTN=CSCG_ERR,
      374     9992                            BUF=MESS_BUF,
      375     9993                            CODE=ERROR,
      376     9994                            DCB=M$CSCG,
      377     9995                            OUTDCB1=M$DO);
      378    10022                                                /**/
      379    10023        %FPT_OPEN (FPTN=CREATE_EGG,             /* Create goose egg file */
      380    10024                       DCB=M$SCHED,
      381    10025                       FUN=CREATE,
      382    10026                       ACS=SEQUEN,
      383    10027                       ORG=KEYED,
      384    10028                       ACSVEH=ACS_VEH,
      385    10029                       ACCESS=ACS_ACCT);
      386    10138                                                /**/
      387    10139                                                /**/
      388    10140        %VLP_ATTR (FPTN=ACS_ACCT);              /* Access for accounts */
      389    10154        %VLP_ACCESS (NOLIST=YES,EXEC=YES,ACCT='?',LAST=";");
      390    10171                                                /**/
      391    10172                                                /**/
      392    10173        %VLP_ATTR (FPTN=ACS_VEH);
      393    10187        %VLP_ACSVEH (READ=YES,UPD=YES,DELR=YES,WNEW=YES,VEHICLE='GOOSE');
      394    10204        %VLP_ACSVEH (READ=YES,UPD=YES,DELR=YES,WNEW=YES,VEHICLE='GOOSE_TEST',LAST=";");
      395    10221        %FPT_OPEN (FPTN=OPEN_S,
      396    10222                       FPARAM=FPARAM,
      397    10223                       DCB = M$SCHED,
      398    10224                       ASN=FILE,
      399    10225                       NAME=NAME,
      400    10226                       ACCT=SYSACCT,
      401    10227                       FUN=IN,
      402    10228                       SHARE=IN);
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:89   
      403    10337                                                /**/
      404    10338        %VLP_NAME (FPTN=NAME,NAME='GOOSE_EGG');
      405    10365        %VLP_NAME (FPTN=CSCGNM,                 /* Name of cscg for open */
      406    10366                       NAME='CSCG');
      407    10393                                                /**/
      408    10394        %FPT_READ (FPTN=READ_S,
      409    10395                            DCB=M$SCHED,
      410    10396                            BUF=INBUF,
      411    10397                            WAIT=YES);
      412    10436                                                /**/
      413    10437        %FPT_READ (FPTN=READ_CMD,
      414    10438                       DCB=M$SCHED,
      415    10439                       BUF=DO_CMD,
      416    10440                       WAIT=YES);
      417    10479                                                /**/
      418    10480                                                /**/
      419    10481        %FPT_CLOSE (FPTN=CLOSE_S,               /* Close schedule file */
      420    10482                    DISP=SAVE,
      421    10483                    DCB=M$SCHED);
      422    10525                                                /**/
      423    10526        %VLP_ERRCODE (FPTN=ERROR);
      424    10571                                                /**/
      425    10572        %FPT_WRITE (FPTN=OUT_MESS,
      426    10573                       DCB=M$DO,
      427    10574                       BUF=MESS_BUF,
      428    10575                       WAIT=YES);
      429    10606                                                /**/
      430    10607        %FPT_TIME (FPTN=GET_DAY,
      431    10608                       DAY=TEXT_DAY,
      432    10609                       DEST=LOCAL);
      433    10628                                                /**/
      434    10629        %FPT_TIME (FPTN=GET_CURR,               /* Used to get current time */
      435    10630                       DATE=TEXT_DATER.TEXT,
      436    10631                       TIME=TEXT_TIME,
      437    10632                       DEST=ANS);
      438    10651                                                /**/
      439    10652        %FPT_WAIT (FPTN=MAIN_WAIT);             /* Main wait */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:90   
      440    10666                                                /**/
      441    10667        %FPT_WAIT (FPTN=FIVE_SECOND,            /* Wait for five second */
      442    10668                   UNITS=5);
      443    10682                                                /**/
      444    10683        %FPT_READ (FPTN=READ_SI,
      445    10684                       BUF=INBUF,
      446    10685                       WAIT=YES,
      447    10686                       DCB=M$SI);
      448    10725                                                /**/
      449    10726        %FPT_OPEN (FPTN=OPEN_OCSCG,
      450    10727                   DCB=M$CSCG,
      451    10728                   SCRUB=YES,
      452    10729                   SETSTA=OGOOSE_SET,
      453    10730                   FUN=UPDATE,
      454    10731                   ASN=COMGROUP,
      455    10732                   NAME=CSCGNM,
      456    10733                   ACCT=SYSACCT,
      457    10734                   SHARE=ALL);
      458    10843                                                /**/
      459    10844        %VLP_SETSTA (FPTN=OGOOSE_SET,
      460    10845                       MYSTATION='OGOOSE');
      461    10873                                                /**/
      462    10874        %FPT_CLOSE (FPTN=CLOSE_OCSCG,           /* Used to close cscg */
      463    10875                    DISP=SAVE,
      464    10876                    DCB=M$CSCG);
      465    10918                                                /**/
      466    10919                                                /**/
      467    10920        %FPT_WRITE (FPTN=GOOSE_ON_WR,           /* Use to turn goose on */
      468    10921                       DCB=M$CSCG,
      469    10922                       STATION=GOOSE,
      470    10923                       BUF=GOOSE_ON_M,
      471    10924                       WAIT=YES);
      472    10955                                                /**/
      473    10956        %FPT_WRITE (FPTN=GOOSE_OFF,             /* Use to turn goose off */
      474    10957                       DCB=M$CSCG,
      475    10958                       STATION=GOOSE,
      476    10959                       BUF=GOOSE_OFF_M,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:91   
      477    10960                       WAIT=YES);
      478    10991                                                /**/
      479    10992        %FPT_WRITE (FPTN=GOOSEM_ON_WR,          /* Use to turn goose messages on */
      480    10993                       DCB=M$CSCG,
      481    10994                       STATION=GOOSE,
      482    10995                       BUF=GOOSEM_ON_M,
      483    10996                       WAIT=YES);
      484    11027                                                /**/
      485    11028        %FPT_WRITE (FPTN=GOOSEM_OFF,            /* Use to turn goose messages off */
      486    11029                       DCB=M$CSCG,
      487    11030                       STATION=GOOSE,
      488    11031                       BUF=GOOSEM_OFF_M,
      489    11032                       WAIT=YES);
      490    11063                                                /**/
      491    11064        %FPT_WRITE (FPTN=WGOOSE_UPD,            /* Use to turn goose upd */
      492    11065                       DCB=M$CSCG,
      493    11066                       STATION=GOOSE,
      494    11067                       BUF=GOOSE_UPD_M,
      495    11068                       WAIT=YES);
      496    11099                                                /**/
      497    11100        %FPT_WRITE (FPTN=TELL_CSCG,             /* Tell consoles error */
      498    11101                       DCB=M$CSCG,
      499    11102                       STATION=STA_KEYIN,
      500    11103                       BUF=TELL_CONSOLES,
      501    11104                       WAIT=YES);
      502    11135                                                /**/
      503    11136        %FPT_WRITE (FPTN=KEYIN_CSCG,            /* Tell consoles error */
      504    11137                       DCB=M$CSCG,
      505    11138                       BUF=SEND_KEYIN,
      506    11139                       STATION=STA_KEYIN,
      507    11140                       WAIT=YES);
      508    11171                                                /**/
      509    11172        %VLP_STATION (FPTN=GOOSE,STATION='GOOSE'); /* Goose station */
      510    11199                                                /**/
      511    11200        %VLP_STATION (FPTN=OGOOSE,STATION='OGOOSE'); /* Ogoose station */
      512    11227                                                /**/
      513    11228        %VLP_STATION (FPTN=STA_KEYIN,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:92   
      514    11229                      STATION='KEYIN');
      515    11256                                                /**/
      516    11257        %FPT_OPEN (FPTN=OPEN_CSCG,              /* Open cscg to keyin */
      517    11258                   DCB=M$CSCG,
      518    11259                   FUN=UPDATE,
      519    11260                   ASN=COMGROUP,
      520    11261                   SETSTA=GOOSE_SET,
      521    11262                   NAME=CSCGNM,
      522    11263                   SCRUB=YES,
      523    11264                   SHARE=ALL);
      524    11373                                                /**/
      525    11374                                                /**/
      526    11375        %VLP_SETSTA (FPTN=GOOSE_SET,
      527    11376                       MYSTATION='GOOSE');
      528    11404                                                /**/
      529    11405        %FPT_READ (FPTN=READ_CSCG,              /* Use for asyn reads of cscg */
      530    11406                   DCB=M$CSCG,
      531    11407                   BUF=CSCG_BUF,
      532    11408                   EVENT=1,
      533    11409                   WAIT=NO);
      534    11448                                                /**/
      535    11449        %FPT_EVENT (FPTN=DO_EVENT,UENTRY=IAA$EVENT);
      536    11463                                                /**/
      537    11464        %FPT_LINK (FPTN=LINK_EDIT,
      538    11465                       CMD=EDIT_CMD,
      539    11466                       NAME=EDIT_NAME,
      540    11467                       ACCT=SYSACCT);
      541    11485                                                /**/
      542    11486        %VLP_NAME (FPTN=EDIT_NAME,
      543    11487                       NAME='EDIT');
      544    11514                                                /**/
      545    11515        %VLP_ACCT (FPTN=SYSACCT,
      546    11516                   ACCT=':SYS');
      547    11529                                                /**/
      548    11530        %FPT_LINK (FPTN=LINK_PCL,
      549    11531                       CMD=PCL_CMD,
      550    11532                       NAME=PCL_NAME,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:93   
      551    11533                       ACCT=SYSACCT);
      552    11551                                                /**/
      553    11552        %VLP_NAME (FPTN=PCL_NAME,
      554    11553                       NAME='PCL');
      555    11580                                                /**/
      556    11581        %FPT_LINK (FPTN=LINK_LIST,
      557    11582                       CMD=LIST_CMD,
      558    11583                       NAME=PCL_NAME,
      559    11584                       ACCT=SYSACCT);
      560    11602                                                /**/
      561    11603        %FPT_OPEN (FPTN=OPEN_TEMP,              /* Used for update function */
      562    11604                       DCB=M$TEMP,
      563    11605                       NAME=TEMP_NAME,
      564    11606                       ACS=SEQUEN,
      565    11607                       ORG=KEYED,
      566    11608                       FUN=CREATE,
      567    11609                       EXIST=NEWFILE,
      568    11610                       ASN=FILE);
      569    11719                                                /**/
      570    11720        %VLP_NAME (FPTN=TEMP_NAME,
      571    11721                       NAME='*GOOSE');
      572    11748                                                /**/
      573    11749        %FPT_OPEN (FPTN=OPEN_S_OUT,             /* Open schedule out */
      574    11750                       DCB=M$SCHED,
      575    11751                       ACS=SEQUEN,
      576    11752                       ORG=CONSEC,
      577    11753                       EXIST=NEWFILE,
      578    11754                       SCRUB=NO,
      579    11755                       ACSVEH=ACS_VEH,
      580    11756                       ACCESS=ACS_ACCT,
      581    11757                       FUN=CREATE);
      582    11866                                                /**/
      583    11867        %FPT_OPEN (FPTN=OPEN_TEMP_IN,
      584    11868                       DCB=M$TEMP,
      585    11869                       SCRUB=NO,
      586    11870                       FUN=IN);
      587    11979                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:94   
      588    11980        %FPT_CLOSE (FPTN=CLOSE_SCHED_REL,       /* Do not save new schedule file */
      589    11981                    DCB=M$SCHED,
      590    11982                    DISP=RELEASE);
      591    12024                                                /**/
      592    12025        %FPT_READ (FPTN=READ_TEMP,
      593    12026                       BUF=INBUF,
      594    12027                       DCB=M$TEMP,
      595    12028                       WAIT=YES);
      596    12067                                                /**/
      597    12068        %FPT_CLOSE (FPTN=CLOSE_TEMP,
      598    12069                    DCB=M$TEMP,
      599    12070                    DISP=SAVE);
      600    12112                                                /**/
      601    12113        %FPT_CLOSE (FPTN=CLOSE_TEMP_REL,
      602    12114                    DCB=M$TEMP,
      603    12115                    DISP=RELEASE);
      604    12157                                                /**/
      605    12158        %FPT_WRITE (FPTN=WRITE_TEMP,
      606    12159                       BUF=INBUF,
      607    12160                       DCB=M$TEMP,
      608    12161                       KEY=EDIT_KEY,
      609    12162                       WAIT=YES);
      610    12193                                                /**/
      611    12194        %FPT_WRITE (FPTN=WRITE_SCHED,
      612    12195                       BUF=INBUF,
      613    12196                       DCB=M$SCHED,
      614    12197                       KEY=EDIT_KEY,
      615    12198                       WAIT=YES);
      616    12229                                                /**/
      617    12230        %FPT_GJOB (FPTN=START_GJOB,
      618    12231                       CCBUF=DO_CMD,
      619    12232                       NAME=GJOB_NAME,
      620    12233                       ACCT=GJOB_ACCT,
      621    12234                       RESULTS=GJOB_RESULTS);
      622    12251                                                /**/
      623    12252        %VLP_NAME (FPTN=GJOB_NAME);
      624    12279                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:95   
      625    12280        %VLP_ACCT (FPTN=GJOB_ACCT);
      626    12293                                                /**/
      627    12294        %VLP_PASS (FPTN=GJOB_PASS);
      628    12307
      629    12308        %VLR_GJOB (FPTN=GJOB_RESULTS);
      630    12321                                                /**/
      631    12322        %FPT_OPEN (FPTN=OPEN_TEST,
      632    12323                       DCB=M$SCHED,
      633    12324                       TEST=YES,
      634    12325                       FPARAM=FPARAM);
      635    12434                                                /**/
      636    12435        %CODE04 ;
      637    12443                                                /**/
      638    12444                                                /**/
      639    12445        %FPT_CORRES (FPTN=CHECK_SIUC,
      640    12446                       DCB1=M$SI,
      641    12447                       DCB2=M$UC);
      642    12461                                                /**/
      643    12462        %FPT_PRIV (FPTN=GET_OPRIV,
      644    12463                   AUTH=YES,
      645    12464                   PRIV=%PR_MSYS#);
      646    12479
      647    12480        %FPT_PRIV (FPTN=RESET_FMSEC,
      648    12481                       PRIV=%PR_FMSEC#);
      649    12496                                                /**/
      650    12497        %VLP_NAME (FPTN=HELP_NAME,
      651    12498                       NAME='GOOSE');
      652    12525                                                /**/
      653    12526        %VLP_ACCT (FPTN=HELP_ACCT,
      654    12527                       ACCT=':SYS');
      655    12540                                                /**/
      656    12541        %FPT_INT(FPTN=FPT_INT,
      657    12542                 UENTRY=XUG$BREAK,
      658    12543                 STCLASS=CONSTANT);
      659    12557        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:96   
      660    12558        /* Begin main program */
      661    12559
      662    12560    1        IF B$JIT$ -> B$JIT.SYSID = 10/*JG_GOOSE#   */
             12560                 /* Is this the goose ming ghost?  */

  12560 11 000002   000000 470400 xsym               LDP0    B$JIT$
        11 000003   000000 720100                    LXL0    0,,PR0
        11 000004   000012 100003                    CMPX0   10,DU
        11 000005   000463 601000 11                 TNZ     DO_ONLINE

      663    12561    1        THEN
      664    12562    2          DO;                              /* Do ghost main */

      665    12563                                                /**/
      666    12564    3               CALL M$OPEN(OPEN_CSCG) WHENALTRETURN DO; /* Open cscg */

  12564 11 000006   004552 630400 1                  EPPR0   OPEN_CSCG
        11 000007   450000 713400                    CLIMB   alt,open
        11 000010   410400 401760                    pmme    nvectors=18
        11 000011   000013 702000 11                 TSX2    s:12565
        11 000012   000015 710000 11                 TRA     s:12567

      667    12565    3                      CALL M$XXX;

  12565 11 000013   000003 713400                    CLIMB   3
        11 000014   000000 401760                    pmme    nvectors=0

      668    12566    3                    END;                   /* Whenaltret from M$OPEN  */

      669    12567    2               CALL M$EVENT(DO_EVENT);     /* Set event for read */

  12567 11 000015   004676 630400 1                  EPPR0   DO_EVENT
        11 000016   010001 713400                    CLIMB   4097
        11 000017   400000 401760                    pmme    nvectors=1

      670    12568    2               CALL M$READ(READ_CSCG);     /* Start read */

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:97   
  12568 11 000020   004660 630400 1                  EPPR0   READ_CSCG
        11 000021   040000 713400                    CLIMB   read
        11 000022   401400 401760                    pmme    nvectors=4

      671    12569    2               START_UP = %YES#;

  12569 11 000023   400000 236003                    LDQ     -131072,DU
        11 000024   003545 756000 1                  STQ     START_UP

      672    12570                                                /**/
      673    12571                                      /* Halt activity until slug gives
      674    12572                                         us the green light (ok to start) */
      675    12573                                                /**/
      676    12574    3               DO WHILE (%YES#);

      677    12575    3                    IF GOOSE_READ_FLAG

  12575 11 000025   000374 234000 1                  SZN     GOOSE_READ_FLAG
        11 000026   000031 605000 11                 TPL     s:12578

      678    12576    3                    THEN
      679    12577    3                         CALL DO$EVENT;

  12577 11 000027   005412 701000 11                 TSX1    DO$EVENT
        11 000030   000000 011000                    NOP     0

      680    12578    3                    IF GREEN_LIGHT

  12578 11 000031   002570 234000 1                  SZN     GREEN_LIGHT
        11 000032   000037 604000 11                 TMI     ADJUST_TIME

      681    12579    3                    THEN
      682    12580    3                         GOTO ADJUST_TIME;
      683    12581    3                    ELSE
      684    12582    3                         CALL M$WAIT (FIVE_SECOND);

  12582 11 000033   004206 630400 1                  EPPR0   FIVE_SECOND
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:98   
        11 000034   020006 713400                    CLIMB   8198
        11 000035   400400 401760                    pmme    nvectors=2

      685    12583    3                  END;

  12583 11 000036   000025 710000 11                 TRA     s:12575

  12574 11 000037                       ADJUST_TIME  null
      686    12584
      687    12585    2   ADJUST_TIME:;
      688    12586                                                /* */
      689    12587    2               CALL M$TIME(GET_CURR);

  12587 11 000037   004164 630400 1                  EPPR0   GET_CURR
        11 000040   020004 713400                    CLIMB   8196
        11 000041   402000 401760                    pmme    nvectors=5

      690    12588    2               CALL M$TIME (GET_DAY);

  12588 11 000042   004150 630400 1                  EPPR0   GET_DAY
        11 000043   020004 713400                    CLIMB   8196
        11 000044   402000 401760                    pmme    nvectors=5

      691    12589    2               CALL CHARBIN(CURR_TIME,TEXT_TIME.HR_MIN);

  12589 11 000045   000000 305400                    DTB
        11 000046   003553 030004 1                  NDSC9   TEXT_TIME                cn=0,s=nosgn,sf=0,n=4
        11 000047   000443 000004 1                  NDSC9   CURR_TIME                cn=0,s=lsgnf,sf=0,n=4

      692    12590    2               CURR_TIME = CURR_TIME / 100 * 60 + MOD(CURR_TIME,100);

  12590 11 000050   000443 236000 1                  LDQ     CURR_TIME
        11 000051   000144 506007                    DIV     100,DL
        11 000052   200116 756100                    STQ     CONV_CURRENT+1,,AUTO
        11 000053   000443 236000 1                  LDQ     CURR_TIME
        11 000054   000144 506007                    DIV     100,DL
        11 000055   200117 755100                    STA     CONV_CURRENT+2,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:99   
        11 000056   200116 236100                    LDQ     CONV_CURRENT+1,,AUTO
        11 000057   000074 402007                    MPY     60,DL
        11 000060   200117 036100                    ADLQ    CONV_CURRENT+2,,AUTO
        11 000061   000443 756000 1                  STQ     CURR_TIME

      693    12591                                                /**/
      694    12592                                      /* If the time or date was changed
      695    12593                                         from an operators console, and
      696    12594                                         goose notices the discrepancy
      697    12595                                         (i.e. if it is > 5 mins) then
      698    12596                                         we have to adjust the time
      699    12597                                         and num of days count accordingly */
      700    12598                                                /**/
      701    12599    2               IF TIME_WARP

  12599 11 000062   003560 234000 1                  SZN     TIME_WARP
        11 000063   000140 605000 11                 TPL     s:12652

      702    12600    2               THEN
      703    12601    3                 DO;

      704    12602    3                      LAST_TIME = -1;

  12602 11 000064   777777 220003                    LDX0    -1,DU
        11 000065   003175 740000 1                  STX0    LAST_TIME

      705    12603    3                      IF (CYCLE_DAYS_LAST = CYCLE_DAYS_CURRENT)

  12603 11 000066   000000 236000 xsym               LDQ     CYCLE_DAYS_LAST
        11 000067   000000 116000 xsym               CMPQ    CYCLE_DAYS_CURRENT
        11 000070   000076 601000 11                 TNZ     s:12611
        11 000071   003216 236000 1                  LDQ     OUR_TIME_ESTIMATE
        11 000072   000442 116000 1                  CMPQ    CURR_TIME_HOLD
        11 000073   000076 602000 11                 TNC     s:12611

      706    12604    3                           AND
      707    12605    3                           (CURR_TIME_HOLD <= OUR_TIME_ESTIMATE)
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:100  
      708    12606    3                      THEN
      709    12607    4                        DO;

      710    12608    4                             START_TIME = CURR_TIME;

  12608 11 000074   000443 235000 1                  LDA     CURR_TIME
        11 000075   003544 755000 1                  STA     START_TIME

      711    12609    4                           END;

      712    12610                                                /**/
      713    12611    3                      IF CYCLE_DAYS_LAST < CYCLE_DAYS_CURRENT

  12611 11 000076   000000 236000 xsym               LDQ     CYCLE_DAYS_LAST
        11 000077   000000 116000 xsym               CMPQ    CYCLE_DAYS_CURRENT
        11 000100   000101 603000 11                 TRC     s:12620

      714    12612    3                      THEN
      715    12613    4                        DO;

      716    12614                                           /* Don't muck with the elapsed
      717    12615                                              day tally
      718    12616                              NUM_DAYS = NUM_DAYS + (CYCLE_DAYS_CURRENT - CYCLE_DAYS_LAST);
      719    12617                                           */
      720    12618    4                           END;

      721    12619                                                /**/
      722    12620    3                      IF CYCLE_DAYS_LAST > CYCLE_DAYS_CURRENT

  12620 11 000101   000105 602000 11                 TNC     s:12630
        11 000102   000105 600000 11                 TZE     s:12630

      723    12621    3                      THEN
      724    12622    4                        DO;

      725    12623                                           /* Don't muck with the elapsed
      726    12624                                              day tally
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:101  
      727    12625                              NUM_DAYS = NUM_DAYS - (CYCLE_DAYS_LAST - CYCLE_DAYS_CURRENT);
      728    12626                                           */
      729    12627    4                             START_TIME = CURR_TIME;

  12627 11 000103   000443 235000 1                  LDA     CURR_TIME
        11 000104   003544 755000 1                  STA     START_TIME

      730    12628    4                           END;

      731    12629                                                /**/
      732    12630    3                      IF NUM_DAYS < 0

  12630 11 000105   003214 235000 1                  LDA     NUM_DAYS
        11 000106   000110 605000 11                 TPL     s:12642

      733    12631    3                      THEN
      734    12632    4                        DO;

      735    12633    4                             NUM_DAYS = 0;

  12633 11 000107   003214 450000 1                  STZ     NUM_DAYS

      736    12634    4                           END;

      737    12635                                                /**/
      738    12636                                      /* Get the current time again so
      739    12637                                         the START_TIME reassigned in this
      740    12638                                         section will preceed the current
      741    12639                                         time, thus filtering out the
      742    12640                                         GOOSE_EGG startup commands. */
      743    12641                                                /**/
      744    12642    3                      CALL M$TIME (GET_CURR);

  12642 11 000110   004164 630400 1                  EPPR0   GET_CURR
        11 000111   020004 713400                    CLIMB   8196
        11 000112   402000 401760                    pmme    nvectors=5

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:102  
      745    12643    3                      CALL M$TIME (GET_DAY);

  12643 11 000113   004150 630400 1                  EPPR0   GET_DAY
        11 000114   020004 713400                    CLIMB   8196
        11 000115   402000 401760                    pmme    nvectors=5

      746    12644    3                      CALL CHARBIN (CURR_TIME,TEXT_TIME.HR_MIN);

  12644 11 000116   000000 305400                    DTB
        11 000117   003553 030004 1                  NDSC9   TEXT_TIME                cn=0,s=nosgn,sf=0,n=4
        11 000120   000443 000004 1                  NDSC9   CURR_TIME                cn=0,s=lsgnf,sf=0,n=4

      747    12645    3                      CURR_TIME = CURR_TIME / 100 * 60 + MOD(CURR_TIME,100);

  12645 11 000121   000443 236000 1                  LDQ     CURR_TIME
        11 000122   000144 506007                    DIV     100,DL
        11 000123   200116 756100                    STQ     CONV_CURRENT+1,,AUTO
        11 000124   000443 236000 1                  LDQ     CURR_TIME
        11 000125   000144 506007                    DIV     100,DL
        11 000126   200117 755100                    STA     CONV_CURRENT+2,,AUTO
        11 000127   200116 236100                    LDQ     CONV_CURRENT+1,,AUTO
        11 000130   000074 402007                    MPY     60,DL
        11 000131   200117 036100                    ADLQ    CONV_CURRENT+2,,AUTO
        11 000132   000443 756000 1                  STQ     CURR_TIME

      748    12646    3                      IF START_TIME = CURR_TIME

  12646 11 000133   003544 116000 1                  CMPQ    START_TIME
        11 000134   000141 601000 11                 TNZ     s:12655

      749    12647    3                      THEN
      750    12648    3                           START_TIME = START_TIME - 1;

  12648 11 000135   000001 336007                    LCQ     1,DL
        11 000136   003544 056000 1                  ASQ     START_TIME

      751    12649    3                    END;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:103  

  12649 11 000137   000141 710000 11                 TRA     s:12655

      752    12650    2               ELSE
      753    12651    3                 DO;

      754    12652    3                      START_TIME = CURR_TIME;

  12652 11 000140   003544 756000 1                  STQ     START_TIME

      755    12653    3                    END;

      756    12654                                                /**/
      757    12655    2               CALL BUILD$TIME;

  12655 11 000141   002077 701000 11                 TSX1    BUILD$TIME
        11 000142   000000 011000                    NOP     0

      758    12656    2               IF START_UP

  12656 11 000143   003545 234000 1                  SZN     START_UP
        11 000144   000146 605000 11                 TPL     s:12659

      759    12657    2               THEN
      760    12658    2                    START_UP = %NO#;

  12658 11 000145   003545 450000 1                  STZ     START_UP

      761    12659    2               TIME_WARP = %NO#;

  12659 11 000146   003560 450000 1                  STZ     TIME_WARP

      762    12660        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:104  
      763    12661                                                /**/
      764    12662                                                /**/
      765    12663                                                /**/
      766    12664                                                /**/
      767    12665    3               DO WHILE (%YES#);           /* Do main loop forever */

      768    12666    3   MAIN_LOOP:       CALL M$TIME (GET_CURR); /* Get current time  */

  12666 11 000147   004164 630400 1     MAIN_LOOP    EPPR0   GET_CURR
        11 000150   020004 713400                    CLIMB   8196
        11 000151   402000 401760                    pmme    nvectors=5

      769    12667    3                    CALL M$TIME(GET_DAY);

  12667 11 000152   004150 630400 1                  EPPR0   GET_DAY
        11 000153   020004 713400                    CLIMB   8196
        11 000154   402000 401760                    pmme    nvectors=5

      770    12668    3                    CALL CHARBIN(CURR_TIME,TEXT_TIME.HR_MIN);

  12668 11 000155   000000 305400                    DTB
        11 000156   003553 030004 1                  NDSC9   TEXT_TIME                cn=0,s=nosgn,sf=0,n=4
        11 000157   000443 000004 1                  NDSC9   CURR_TIME                cn=0,s=lsgnf,sf=0,n=4

      771    12669    3                    CURR_TIME = CURR_TIME / 100 * 60 + MOD(CURR_TIME,100);

  12669 11 000160   000443 236000 1                  LDQ     CURR_TIME
        11 000161   000144 506007                    DIV     100,DL
        11 000162   200116 756100                    STQ     CONV_CURRENT+1,,AUTO
        11 000163   000443 236000 1                  LDQ     CURR_TIME
        11 000164   000144 506007                    DIV     100,DL
        11 000165   200117 755100                    STA     CONV_CURRENT+2,,AUTO
        11 000166   200116 236100                    LDQ     CONV_CURRENT+1,,AUTO
        11 000167   000074 402007                    MPY     60,DL
        11 000170   200117 036100                    ADLQ    CONV_CURRENT+2,,AUTO
        11 000171   000443 756000 1                  STQ     CURR_TIME

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:105  
      772    12670    3                    CALL TIME_WARP$CHECK;

  12670 11 000172   001650 701000 11                 TSX1    TIME_WARP$CHECK
        11 000173   000000 011000                    NOP     0

      773    12671                                                /**/
      774    12672                                      /* Allow 5 minute discrepency between
      775    12673                                         actual wake-up time, & the time goose
      776    12674                                         thinks it is at wake-up */
      777    12675                                                /**/
      778    12676    3                    IF TIME_DIFF > (15 * 60)

  12676 11 000174   000000 235000 xsym               LDA     TIME_DIFF
        11 000175   001605 115007                    CMPA    901,DL
        11 000176   000202 602000 11                 TNC     s:12683

      779    12677    3                    THEN
      780    12678    4                      DO;

      781    12679    4                           TIME_WARP = %YES#;

  12679 11 000177   400000 236003                    LDQ     -131072,DU
        11 000200   003560 756000 1                  STQ     TIME_WARP

      782    12680    4                           GOTO ADJUST_TIME;

  12680 11 000201   000037 710000 11                 TRA     ADJUST_TIME

      783    12681    4                         END;
      784    12682                                                /**/
      785    12683    3                    IF LAST_TIME > CURR_TIME /* Check if we went past 23:59 */

  12683 11 000202   003175 236000 1                  LDQ     LAST_TIME
        11 000203   000022 732000                    QRS     18
        11 000204   000443 116000 1                  CMPQ    CURR_TIME
        11 000205   000235 604400 11                 TMOZ    s:12698

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:106  
      786    12684    3                    THEN
      787    12685    4                      DO;

      788    12686    4                           IF ELAPSED_MINS < 100

  12686 11 000206   000557 235000 1                  LDA     ELAPSED_MINS
        11 000207   000144 115007                    CMPA    100,DL
        11 000210   000217 605000 11                 TPL     s:12689

      789    12687    4                           THEN
      790    12688    4                                ELAPSED_MINS = ELAPSED_MINS + (1439 - LAST_TIME) +
             12688                                         CURR_TIME;

  12688 11 000211   200116 756100                    STQ     CONV_CURRENT+1,,AUTO
        11 000212   000557 236000 1                  LDQ     ELAPSED_MINS
        11 000213   200116 136100                    SBLQ    CONV_CURRENT+1,,AUTO
        11 000214   000443 036000 1                  ADLQ    CURR_TIME
        11 000215   002637 036007                    ADLQ    1439,DL
        11 000216   000557 756000 1                  STQ     ELAPSED_MINS

      791    12689    4                           CALL CHECK$TIME (1439); /* Check until midnight */

  12689 11 000217   000001 236000 12                 LDQ     1
        11 000220   200041 756100                    STQ     XUG$+3,,AUTO
        11 000221   002020 701000 11                 TSX1    CHECK$TIME
        11 000222   000000 011000                    NOP     0

      792    12690    4                           LAST_TIME = -1;

  12690 11 000223   777777 220003                    LDX0    -1,DU
        11 000224   003175 740000 1                  STX0    LAST_TIME

      793    12691    4                           NUM_DAYS = NUM_DAYS + 1; /* Been up over a day */

  12691 11 000225   003214 054000 1                  AOS     NUM_DAYS

      794    12692    4                           CURR_TIME = 0;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:107  

  12692 11 000226   000443 450000 1                  STZ     CURR_TIME

      795    12693    4                           CALL BUILD$TIME; /* Rebuild time for new day */

  12693 11 000227   002077 701000 11                 TSX1    BUILD$TIME
        11 000230   000000 011000                    NOP     0

      796    12694    4                           CALL M$TIME (GET_DAY);

  12694 11 000231   004150 630400 1                  EPPR0   GET_DAY
        11 000232   020004 713400                    CLIMB   8196
        11 000233   402000 401760                    pmme    nvectors=5

      797    12695    4                         END;

  12695 11 000234   000252 710000 11                 TRA     s:12702

      798    12696    3                    ELSE
      799    12697    4                      DO;

      800    12698    4                           IF ELAPSED_MINS < 100 AND LAST_TIME ~= -1

  12698 11 000235   000557 235000 1                  LDA     ELAPSED_MINS
        11 000236   000144 115007                    CMPA    100,DL
        11 000237   000252 605000 11                 TPL     s:12702
        11 000240   000000 620006                    EAX0    0,QL
        11 000241   777777 100003                    CMPX0   -1,DU
        11 000242   000252 600000 11                 TZE     s:12702

      801    12699    4                           THEN
      802    12700    4                                ELAPSED_MINS = ELAPSED_MINS + (CURR_TIME - LAST_TIME);

  12700 11 000243   003175 236000 1                  LDQ     LAST_TIME
        11 000244   000022 732000                    QRS     18
        11 000245   200116 756100                    STQ     CONV_CURRENT+1,,AUTO
        11 000246   000443 236000 1                  LDQ     CURR_TIME
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:108  
        11 000247   200116 136100                    SBLQ    CONV_CURRENT+1,,AUTO
        11 000250   000557 036000 1                  ADLQ    ELAPSED_MINS
        11 000251   000557 756000 1                  STQ     ELAPSED_MINS

      803    12701    4                         END;

      804    12702    3                    CALL CHECK$TIME(CURR_TIME); /* Check for current time */

  12702 11 000252   000002 236000 12                 LDQ     2
        11 000253   200041 756100                    STQ     XUG$+3,,AUTO
        11 000254   002020 701000 11                 TSX1    CHECK$TIME
        11 000255   000000 011000                    NOP     0

      805    12703    3                    LAST_TIME = CURR_TIME;

  12703 11 000256   000443 720000 1                  LXL0    CURR_TIME
        11 000257   003175 740000 1                  STX0    LAST_TIME

      806    12704    3                    LAST_DATE = TEXT_DATE;

  12704 11 000260   003550 237000 1                  LDAQ    TEXT_DATE
        11 000261   003172 757000 1                  STAQ    LAST_DATE

      807    12705                                                /**/
      808    12706                                                /**/
      809    12707                                      /* Get time again because some time
      810    12708                                         has elapsed since the the last
      811    12709                                         M$TIME call. The reason for
      812    12710                                         the elapse is the call to
      813    12711                                         CHECK$TIME */
      814    12712                                                /**/
      815    12713    3                    CALL M$TIME(GET_CURR); /* Get actual time */

  12713 11 000262   004164 630400 1                  EPPR0   GET_CURR
        11 000263   020004 713400                    CLIMB   8196
        11 000264   402000 401760                    pmme    nvectors=5

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:109  
      816    12714    3                    CALL M$TIME (GET_DAY);

  12714 11 000265   004150 630400 1                  EPPR0   GET_DAY
        11 000266   020004 713400                    CLIMB   8196
        11 000267   402000 401760                    pmme    nvectors=5

      817    12715    3                    CALL CHARBIN(CURR_TIME,TEXT_TIME.HR_MIN);

  12715 11 000270   000000 305400                    DTB
        11 000271   003553 030004 1                  NDSC9   TEXT_TIME                cn=0,s=nosgn,sf=0,n=4
        11 000272   000443 000004 1                  NDSC9   CURR_TIME                cn=0,s=lsgnf,sf=0,n=4

      818    12716    3                    CURR_TIME = CURR_TIME / 100 * 60 + MOD(CURR_TIME,100);

  12716 11 000273   000443 236000 1                  LDQ     CURR_TIME
        11 000274   000144 506007                    DIV     100,DL
        11 000275   200116 756100                    STQ     CONV_CURRENT+1,,AUTO
        11 000276   000443 236000 1                  LDQ     CURR_TIME
        11 000277   000144 506007                    DIV     100,DL
        11 000300   200117 755100                    STA     CONV_CURRENT+2,,AUTO
        11 000301   200116 236100                    LDQ     CONV_CURRENT+1,,AUTO
        11 000302   000074 402007                    MPY     60,DL
        11 000303   200117 036100                    ADLQ    CONV_CURRENT+2,,AUTO
        11 000304   000443 756000 1                  STQ     CURR_TIME

      819    12717                                                /**/
      820    12718                                      /* Set MAIN_WAIT.V.UNITS# to 0 so
      821    12719                                         TIME_WARP$CHECK will check against
      822    12720                                         LAST_TIME. */
      823    12721                                                /**/
      824    12722    3                    MAIN_WAIT.V.UNITS# = 0;

  12722 11 000305   004204 450000 1                  STZ     MAIN_WAIT+4

      825    12723    3                    CALL TIME_WARP$CHECK;

  12723 11 000306   001650 701000 11                 TSX1    TIME_WARP$CHECK
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:110  
        11 000307   000000 011000                    NOP     0

      826    12724                                                /**/
      827    12725                                      /* Allow 10 minutes for possible rebuild
      828    12726                                         and execution of scheduled events */
      829    12727                                                /**/
      830    12728    3                    IF TIME_DIFF > (10 * 60)

  12728 11 000310   000000 235000 xsym               LDA     TIME_DIFF
        11 000311   001131 115007                    CMPA    601,DL
        11 000312   000316 602000 11                 TNC     s:12746

      831    12729    3                    THEN
      832    12730    4                      DO;

      833    12731    4                           TIME_WARP = %YES#;

  12731 11 000313   400000 236003                    LDQ     -131072,DU
        11 000314   003560 756000 1                  STQ     TIME_WARP

      834    12732    4                           GOTO ADJUST_TIME;

  12732 11 000315   000037 710000 11                 TRA     ADJUST_TIME

      835    12733    4                         END;
      836    12734                                                /**/
      837    12735                                                /* Check for changes to GOOSE_EGG. */
      838    12736                                      /* This check should follow a time call
      839    12737                                         so the events that were just executed
      840    12738                                         by CHECK$TIME will be filtered out
      841    12739                                         of the new internal time table.  It
      842    12740                                         should also let the code bypass it
      843    12741                                         at midnight so the regular midnight
      844    12742                                         conditions in this loop can process
      845    12743                                         midnight events, and rebuild the
      846    12744                                         internal time table.   */
      847    12745                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:111  
      848    12746    3                    IF ~ (CURR_TIME < LAST_TIME)

  12746 11 000316   400000 220003                    LDX0    -131072,DU
        11 000317   003175 236000 1                  LDQ     LAST_TIME
        11 000320   000022 732000                    QRS     18
        11 000321   000443 116000 1                  CMPQ    CURR_TIME
        11 000322   000324 605400 11                 TPNZ    s:12746+6
        11 000323   000000 220003                    LDX0    0,DU
        11 000324   000000 636010                    EAQ     0,X0
        11 000325   400000 676003                    ERQ     -131072,DU
        11 000326   000360 600000 11                 TZE     SKIP_TEST

      849    12747    3                    THEN
      850    12748    4                      DO;

      851    12749    4                           CALL M$OPEN (OPEN_TEST) ALTRET (SKIP_TEST);

  12749 11 000327   005504 630400 1                  EPPR0   OPEN_TEST
        11 000330   450000 713400                    CLIMB   alt,open
        11 000331   410400 401760                    pmme    nvectors=18
        11 000332   000360 702000 11                 TSX2    SKIP_TEST

      852    12750    4                           PTR$ = ADDR (FPARAM);

  12750 11 000333   000003 236000 12                 LDQ     3
        11 000334   200033 756100                    STQ     PTR$,,AUTO

      853    12751    4                           CALL XSF$LOCCODP (PTR$,4) ALTRET (SKIP_TEST);

  12751 11 000335   000004 236000 12                 LDQ     4
        11 000336   200117 756100                    STQ     CONV_CURRENT+2,,AUTO
        11 000337   200033 630500                    EPPR0   PTR$,,AUTO
        11 000340   200116 450500                    STP0    CONV_CURRENT+1,,AUTO
        11 000341   200116 630500                    EPPR0   CONV_CURRENT+1,,AUTO
        11 000342   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000343   000000 701000 xent               TSX1    XSF$LOCCODP
        11 000344   000360 702000 11                 TSX2    SKIP_TEST
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:112  

      854    12752                                                /* Look for dates */
      855    12753    4                           IF PTR$ -> CODE04.MODIFY.TIME ~= MODIFY_DATE

  12753 11 000345   200033 470500                    LDP0    PTR$,,AUTO
        11 000346   000001 236100                    LDQ     1,,PR0
        11 000347   200032 116100                    CMPQ    MODIFY_DATE,,AUTO
        11 000350   000360 600000 11                 TZE     SKIP_TEST

      856    12754    4                           THEN
      857    12755    5                             DO;

      858    12756    5                                  CALL BUILD$TIME;

  12756 11 000351   002077 701000 11                 TSX1    BUILD$TIME
        11 000352   000000 011000                    NOP     0

      859    12757    5                                  LAST_TIME = CURR_TIME;

  12757 11 000353   000443 720000 1                  LXL0    CURR_TIME
        11 000354   003175 740000 1                  STX0    LAST_TIME

      860    12758    5                                  LAST_DATE = TEXT_DATE;

  12758 11 000355   003550 237000 1                  LDAQ    TEXT_DATE
        11 000356   003172 757000 1                  STAQ    LAST_DATE

      861    12759    5                                  GOTO MAIN_LOOP;

  12759 11 000357   000147 710000 11                 TRA     MAIN_LOOP

  12756 11 000360                       SKIP_TEST    null
      862    12760    5                                END;
      863    12761    4                         END;
      864    12762    3   SKIP_TEST:       ;
      865    12763                                                /**/
      866    12764    3                    IF CURR_TIME < LAST_TIME /* Past midnight */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:113  

  12764 11 000360   003175 236000 1                  LDQ     LAST_TIME
        11 000361   000022 732000                    QRS     18
        11 000362   000443 116000 1                  CMPQ    CURR_TIME
        11 000363   000367 604400 11                 TMOZ    s:12769

      867    12765    3                    THEN
      868    12766    3                         TIME_LEFT = -1;   /* Override the wait */

  12766 11 000364   000001 335007                    LCA     1,DL
        11 000365   003557 755000 1                  STA     TIME_LEFT
        11 000366   000427 710000 11                 TRA     s:12786

      869    12767    3                    ELSE
      870    12768    4                      DO;

      871    12769    4                           CALL CHARBIN(TIME_LEFT,TEXT_TIME.SEC); /* Get seconds */

  12769 11 000367   000000 305400                    DTB
        11 000370   003554 030002 1                  NDSC9   TEXT_TIME+1              cn=0,s=nosgn,sf=0,n=2
        11 000371   003557 000004 1                  NDSC9   TIME_LEFT                cn=0,s=lsgnf,sf=0,n=4

      872    12770    4                           TIME_LEFT = CURR_TIME * 60 + TIME_LEFT;
             12770                                    /* Seconds from midnight */

  12770 11 000372   000443 236000 1                  LDQ     CURR_TIME
        11 000373   000074 402007                    MPY     60,DL
        11 000374   003557 036000 1                  ADLQ    TIME_LEFT
        11 000375   003557 756000 1                  STQ     TIME_LEFT

      873    12771    4                           IF TIME_HEAD$ = ADDR(NIL) /* No entries left */

  12771 11 000376   003556 236000 1                  LDQ     TIME_HEAD$
        11 000377   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 000400   000405 601000 11                 TNZ     s:12775

      874    12772    4                           THEN
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:114  
      875    12773    4                                TIME_LEFT = 1440 * 60 - TIME_LEFT;
             12773                                         /* Wait till midnight */

  12773 11 000401   250600 235007                    LDA     86400,DL
        11 000402   003557 135000 1                  SBLA    TIME_LEFT
        11 000403   003557 755000 1                  STA     TIME_LEFT
        11 000404   000415 710000 11                 TRA     s:12776

      876    12774    4                           ELSE
      877    12775    4                                TIME_LEFT = TIME_HEAD$ -> TIME_TABLE.TIME * 60 -
             12775                                         TIME_LEFT;

  12775 11 000405   003556 470400 1                  LDP0    TIME_HEAD$
        11 000406   000000 236100                    LDQ     0,,PR0
        11 000407   000022 772000                    QRL     18
        11 000410   000005 402000 12                 MPY     5
        11 000411   003557 036000 1                  ADLQ    TIME_LEFT
        11 000412   000027 676000 xsym               ERQ     B_VECTNIL+23
        11 000413   000001 036007                    ADLQ    1,DL
        11 000414   003557 756000 1                  STQ     TIME_LEFT

      878    12776    4                           IF TIME_LEFT > 0

  12776 11 000415   003557 235000 1                  LDA     TIME_LEFT
        11 000416   000421 604400 11                 TMOZ    s:12780

      879    12777    4                           THEN
      880    12778    4                                MAIN_WAIT.V.UNITS# = TIME_LEFT;

  12778 11 000417   004204 755000 1                  STA     MAIN_WAIT+4
        11 000420   000422 710000 11                 TRA     s:12781

      881    12779    4                           ELSE
      882    12780    4                                MAIN_WAIT.V.UNITS# = 0;

  12780 11 000421   004204 450000 1                  STZ     MAIN_WAIT+4

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:115  
      883    12781    4                           IF MAIN_WAIT.V.UNITS# > 600 /* Greater than ten minutes */

  12781 11 000422   004204 236000 1                  LDQ     MAIN_WAIT+4
        11 000423   001131 116007                    CMPQ    601,DL
        11 000424   000427 602000 11                 TNC     s:12786

      884    12782    4                           THEN
      885    12783    4                                MAIN_WAIT.V.UNITS# = 600;
             12783                                         /* Wait a maximum of ten mins */

  12783 11 000425   001130 235007                    LDA     600,DL
        11 000426   004204 755000 1                  STA     MAIN_WAIT+4

      886    12784    4                         END;              /* End not past midnight */

      887    12785    4                    DO INHIBIT;            /* No interuptions please */

      888    12786    4                         IF ~GOOSE_READ_FLAG AND TIME_LEFT > 0

  12786 11 000427   000374 236200 1                  LDQ   ! GOOSE_READ_FLAG
        11 000430   400000 376203                    ANQ   ! -131072,DU
        11 000431   400000 676203                    ERQ   ! -131072,DU
        11 000432   000456 600200 11                 TZE   ! s:12797
        11 000433   003557 235200 1                  LDA   ! TIME_LEFT
        11 000434   000456 604600 11                 TMOZ  ! s:12797

      889    12787    4                         THEN
      890    12788    5                           DO;

      891    12789    5                                IF ELAPSED_MINS < 100

  12789 11 000435   000557 236200 1                  LDQ   ! ELAPSED_MINS
        11 000436   000144 116207                    CMPQ  ! 100,DL
        11 000437   000447 605200 11                 TPL   ! s:12792

      892    12790    5                                THEN
      893    12791    5                                     ELAPSED_MINS = ELAPSED_MINS + (CURR_TIME -
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:116  
             12791                                              LAST_TIME);

  12791 11 000440   003175 235200 1                  LDA   ! LAST_TIME
        11 000441   000022 731200                    ARS   ! 18
        11 000442   200116 755300                    STA   ! CONV_CURRENT+1,,AUTO
        11 000443   000443 236200 1                  LDQ   ! CURR_TIME
        11 000444   200116 136300                    SBLQ  ! CONV_CURRENT+1,,AUTO
        11 000445   000557 036200 1                  ADLQ  ! ELAPSED_MINS
        11 000446   000557 756200 1                  STQ   ! ELAPSED_MINS

      894    12792    5                                LAST_TIME = CURR_TIME;

  12792 11 000447   000443 720200 1                  LXL0  ! CURR_TIME
        11 000450   003175 740200 1                  STX0  ! LAST_TIME

      895    12793    5                                LAST_DATE = TEXT_DATE;

  12793 11 000451   003550 237200 1                  LDAQ  ! TEXT_DATE
        11 000452   003172 757200 1                  STAQ  ! LAST_DATE

      896    12794    5                                CALL M$WAIT(MAIN_WAIT); /* Wait till next item */

  12794 11 000453   004200 630600 1                  EPPR0 ! MAIN_WAIT
        11 000454   020006 713600                    CLIMB ! 8198
        11 000455   400400 401760                    pmme    nvectors=2

      897    12795    5                              END;

      898    12796    4                       END;                /* End inhibit */

      899    12797    3                    IF GOOSE_READ_FLAG

  12797 11 000456   000374 234000 1                  SZN     GOOSE_READ_FLAG
        11 000457   000147 605000 11                 TPL     MAIN_LOOP

      900    12798    3                    THEN
      901    12799    3                         CALL DO$EVENT;    /* Process event on cscg */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:117  

  12799 11 000460   005412 701000 11                 TSX1    DO$EVENT
        11 000461   000000 011000                    NOP     0

      902    12800    3                  END;                     /* Main loop end */

  12800 11 000462   000147 710000 11                 TRA     MAIN_LOOP

      903    12801    2             END;                          /* End do ghost */
      904    12802        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:118  
      905    12803    1        ELSE
      906    12804    1   DO_ONLINE:;

  12804 11 000463                       DO_ONLINE    null
      907    12805    2        DO;                                /* Do online main program */

      908    12806    2             REMEMBER DO_ONLINE IN ABORT_CMD;

  12806 11 000463   000463 635000 11                 EAA     DO_ONLINE
        11 000464   000000 452400 xsym               STP2    ABORT_CMD
        11 000465   000001 755000 xsym               STA     ABORT_CMD+1

      909    12807    2             CALL M$TIME (GET_CURR);

  12807 11 000466   004164 630400 1                  EPPR0   GET_CURR
        11 000467   020004 713400                    CLIMB   8196
        11 000470   402000 401760                    pmme    nvectors=5

      910    12808                                           /* This handles the online goose commands */
      911    12809    2             CALL M$RPRIV (RESET_FMSEC);

  12809 11 000471   005606 630400 1                  EPPR0   RESET_FMSEC
        11 000472   020013 713400                    CLIMB   8203
        11 000473   400000 401760                    pmme    nvectors=1

      912    12810                                                /**/
      913    12811    2             CALL M$INT (FPT_INT);

  12811 11 000474   000002 630400 10                 EPPR0   FPT_INT
        11 000475   010002 713400                    CLIMB   4098
        11 000476   400000 401760                    pmme    nvectors=1

      914    12812    2             ONLINE_GETCMD.NODES$ = ADDR(GOOSE_ONODES2);

  12812 11 000477   000006 236000 12                 LDQ     6
        11 000500   000154 756000 1                  STQ     ONLINE_GETCMD

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:119  
      915    12813
      916    12814        /*        If (B$JIT$ -> B$JIT.PRIV.ACTIVE & %PR_MSYS#) ~= %PR_MSYS#  */
      917    12815        /*        Then do;                      {* msys priv not active */
      918    12816
      919    12817    2             CALL M$SPRIV (GET_OPRIV)

  12817 11 000501   005602 630400 1                  EPPR0   GET_OPRIV
        11 000502   420012 713400                    CLIMB   alt,+8202
        11 000503   400000 401760                    pmme    nvectors=1
        11 000504   000507 702000 11                 TSX2    s:12823

      920    12818    3             WHENRETURN DO;

      921    12819    3                    ONLINE_GETCMD.NODES$ = ADDR(GOOSE_ONODES);

  12819 11 000505   000007 236000 12                 LDQ     7
        11 000506   000154 756000 1                  STQ     ONLINE_GETCMD

      922    12820    3                  END;                     /* Whenreturn */

      923    12821        /*             End;                     {* If msys priv is not active */
      924    12822
      925    12823    2             ON_LINE = %YES#;              /* Set on line flag */

  12823 11 000507   400000 236003                    LDQ     -131072,DU
        11 000510   003215 756000 1                  STQ     ON_LINE

      926    12824    2             CALL CONCAT(MESS_BUF,'Goose ',ADDR(B_VERSION)->

  12824 11 000511   000000 236000 xsym               LDQ     B_VERSION
        11 000512   000033 772000                    QRL     27
        11 000513   040000 100400                    MLR     fill='040'O
        11 000514   000011 000006 10                 ADSC9   NO_GHOST+3               cn=0,n=6
        11 000515   000000 000006 xsym               ADSC9   MESS_BUF                 cn=0,n=6
        11 000516   000000 620006                    EAX0    0,QL
        11 000517   040000 100440                    MLR     fill='040'O
        11 000520   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:120  
        11 000521   000001 400372 xsym               ADSC9   MESS_BUF+1               cn=2,n=250
        11 000522   000372 116007                    CMPQ    250,DL
        11 000523   000531 603000 11                 TRC     s:12826
        11 000524   777405 621006                    EAX1    -251,QL
        11 000525   777777 661003                    ERX1    -1,DU
        11 000526   040046 100400                    MLR     fill='040'O
        11 000527   000013 000005 10                 ADSC9   NO_GHOST+5               cn=0,n=5
        11 000530   000001 400011 xsym               ADSC9   MESS_BUF+1,Q             cn=2,n=*X1

      927    12825    2                  B$VERSIONB.T_,' here');
      928    12826    2             CALL M$WRITE(OUT_MESS);       /* Say hello */

  12826 11 000531   004134 630400 1                  EPPR0   OUT_MESS
        11 000532   040001 713400                    CLIMB   write
        11 000533   401400 401760                    pmme    nvectors=4

      929    12827    2             REMEMBER MAIN_OLOOP IN ABORT_CMD;

  12827 11 000534   000537 635000 11                 EAA     MAIN_OLOOP
        11 000535   000000 452400 xsym               STP2    ABORT_CMD
        11 000536   000001 755000 xsym               STA     ABORT_CMD+1

      930    12828    3             DO WHILE (%YES#);             /* Main command loop */

  12826 11 000537                       MAIN_OLOOP   null
      931    12829    3   MAIN_OLOOP:    ;
      932    12830                                                /**/
      933    12831                                                /**/
      934    12832                                                /**/
      935    12833                                      /* This section sets up and has the
      936    12834                                         parsing done by the XUG$ library
      937    12835                                         services.  It then continues on
      938    12836                                         to process the individual commands.
      939    12837                                      */
      940    12838                                                /**/
      941    12839    3                  CALL XUG$INIT (ONLINE_GETCMD, ONLINE_INIT)

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:121  
  12839 11 000537   000010 630400 12                 EPPR0   8
        11 000540   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000541   000000 701000 xent               TSX1    XUG$INIT
        11 000542   000544 702000 11                 TSX2    s:12841
        11 000543   000552 710000 11                 TRA     s:12844

      942    12840    4                  WHENALTRETURN DO;        /* we bombed out */

      943    12841    4                         CALL IAE$ONLINE_ERROR (0,ONLINE_GETCMD.ERR#);

  12841 11 000544   000012 630400 12                 EPPR0   10
        11 000545   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000546   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 000547   000000 011000                    NOP     0

      944    12842    4                         CALL M$XXX;

  12842 11 000550   000003 713400                    CLIMB   3
        11 000551   000000 401760                    pmme    nvectors=0

      945    12843    4                       END;                /* Whenaltreturn */

      946    12844    3                  REMEMBER READ_OLOOP IN ABORT_CMD;

  12844 11 000552   000555 635000 11                 EAA     READ_OLOOP
        11 000553   000000 452400 xsym               STP2    ABORT_CMD
        11 000554   000001 755000 xsym               STA     ABORT_CMD+1

  12827 11 000555                       READ_OLOOP   null
      947    12845    3   READ_OLOOP:    ;
      948    12846    3                  CALL XUG$GETCMD (ONLINE_GETCMD)

  12846 11 000555   000010 630400 12                 EPPR0   8
        11 000556   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 000557   000000 701000 xent               TSX1    XUG$GETCMD
        11 000560   000562 702000 11                 TSX2    s:12848
        11 000561   000601 710000 11                 TRA     s:12859
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:122  

      949    12847    4                  WHENALTRETURN DO;

      950    12848    4                         IF ONLINE_GETCMD.ERR#.CODE# = %E$EOF THEN

  12848 11 000562   000155 236000 1                  LDQ     ONLINE_GETCMD+1
        11 000563   377770 376007                    ANQ     131064,DL
        11 000564   000060 116007                    CMPQ    48,DL
        11 000565   000650 600000 11                 TZE     CHECK_END

      951    12849    4                              GOTO CHECK_END;
      952    12850    5                         ELSE DO;

      953    12851    5                                CALL IAE$ONLINE_ERROR (0,ONLINE_GETCMD.ERR#);

  12851 11 000566   000012 630400 12                 EPPR0   10
        11 000567   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000570   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 000571   000000 011000                    NOP     0

      954    12852    5                                IF ONLINE_GETCMD.ERR#.CODE# = %E$NOFILE THEN

  12852 11 000572   000155 236000 1                  LDQ     ONLINE_GETCMD+1
        11 000573   377770 376007                    ANQ     131064,DL
        11 000574   001610 116007                    CMPQ    904,DL
        11 000575   000555 601000 11                 TNZ     READ_OLOOP

      955    12853    5                                     CALL M$XXX;

  12853 11 000576   000003 713400                    CLIMB   3
        11 000577   000000 401760                    pmme    nvectors=0
        11 000600   000601 710000 11                 TRA     s:12859

      956    12854    5                                ELSE
      957    12855    5                                     GOTO READ_OLOOP;
      958    12856    5                              END;         /*  Not eof  */
      959    12857    4                       END;                /* Whenaltreturn */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:123  
      960    12858
      961    12859    4                  DO CASE (ONLINE_GETCMD.OUT$ -> OUT$BLK.CODE);

  12859 11 000601   000155 470400 1                  LDP0    ONLINE_GETCMD+1
        11 000602   000000 720100                    LXL0    0,,PR0
        11 000603   000021 100003                    CMPX0   17,DU
        11 000604   000606 602010 11                 TNC     s:12859+5,X0
        11 000605   000537 710000 11                 TRA     MAIN_OLOOP
        11 000606   001003 710000 11                 TRA     s:12916
        11 000607   001023 710000 11                 TRA     s:12923
        11 000610   001103 710000 11                 TRA     s:12945
        11 000611   000650 710000 11                 TRA     CHECK_END
        11 000612   001123 710000 11                 TRA     s:12965
        11 000613   000653 710000 11                 TRA     s:12878
        11 000614   001043 710000 11                 TRA     s:12931
        11 000615   001063 710000 11                 TRA     s:12938
        11 000616   001613 710000 11                 TRA     s:13124
        11 000617   001613 710000 11                 TRA     s:13124
        11 000620   001613 710000 11                 TRA     s:13124
        11 000621   000627 710000 11                 TRA     s:12863
        11 000622   001613 710000 11                 TRA     s:13124
        11 000623   001613 710000 11                 TRA     s:13124
        11 000624   001613 710000 11                 TRA     s:13124
        11 000625   001613 710000 11                 TRA     s:13124
        11 000626   000635 710000 11                 TRA     s:12866

      962    12860                                                /**/
      963    12861                                                /**/
      964    12862    4                  CASE (%IA_CMD_LIST#);    /* List command */

      965    12863    5                     CALL M$LINK(LINK_LIST) WHENALTRETURN DO; END;

  12863 11 000627   004750 630400 1                  EPPR0   LINK_LIST
        11 000630   400005 713400                    CLIMB   alt,+5
        11 000631   403000 401760                    pmme    nvectors=7
        11 000632   000634 702000 11                 TSX2    s:12863+5
        11 000633   000634 710000 11                 TRA     s:12863+5
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:124  

  12863 11 000634   000537 710000 11                 TRA     MAIN_OLOOP

      966    12864
      967    12865    4                  CASE (%IA_CMD_EVAL#);

      968    12866    4                     GOOSE_OUT$ = ONLINE_GETCMD.OUT$;

  12866 11 000635   000155 236000 1                  LDQ     ONLINE_GETCMD+1
        11 000636   000375 756000 1                  STQ     GOOSE_OUT$

      969    12867    4                     CALL IAD$DATE

  12867 11 000637   000002 631400 xsym               EPPR1   B_VECTNIL+2
        11 000640   000000 701000 xent               TSX1    IAD$DATE
        11 000641   000643 702000 11                 TSX2    s:12869
        11 000642   000647 710000 11                 TRA     s:12870

      970    12868    5                     WHENALTRETURN DO;

      971    12869    5                            CALL IAE$ONLINE_ERROR (%E$IA_DATE_ERR#,0);

  12869 11 000643   000014 630400 12                 EPPR0   12
        11 000644   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000645   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 000646   000000 011000                    NOP     0

      972    12870    5                          END;             /*  Whenaltreturn */

  12870 11 000647   000537 710000 11                 TRA     MAIN_OLOOP

      973    12871                                                /**/
      974    12872    4                  CASE (%IA_CMD_END#);     /* All done */

  12866 11 000650                       CHECK_END    null
      975    12873    4   CHECK_END:        ;
      976    12874    4                     CALL M$EXIT;          /* Good bye */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:125  

  12874 11 000650   000001 713400                    CLIMB   exit
        11 000651   000000 401760                    pmme    nvectors=0
        11 000652   000537 710000 11                 TRA     MAIN_OLOOP

      977    12875                                                /**/
      978    12876                                                /**/
      979    12877    4                  CASE (%IA_CMD_GJOB#);

      980    12878    4                     DO_CMD = ' ';

  12878 11 000653   040000 100400                    MLR     fill='040'O
        11 000654   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 000655   000446 000400 1                  ADSC9   DO_CMD                   cn=0,n=256

      981    12879    4                     GJOB_ACCT.ACCT# = B$JIT$ -> B$JIT.ACCN;

  12879 11 000656   000000 471400 xsym               LDP1    B$JIT$
        11 000657   040000 100500                    MLR     fill='040'O
        11 000660   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
        11 000661   005476 000010 1                  ADSC9   GJOB_ACCT                cn=0,n=8

      982    12880    4                     START_GJOB.CCBUF_ = VECTOR (NIL);

  12880 11 000662   000016 237000 12                 LDAQ    14
        11 000663   005460 757000 1                  STAQ    START_GJOB+8

      983    12881    4                     DO_ACCT = ' ';

  12881 11 000664   000035 235000 xsym               LDA     B_VECTNIL+29
        11 000665   000035 236000 xsym               LDQ     B_VECTNIL+29
        11 000666   000444 757000 1                  STAQ    DO_ACCT

      984    12882    4                     DO_PASS = ' ';

  12882 11 000667   000035 235000 xsym               LDA     B_VECTNIL+29
        11 000670   000035 236000 xsym               LDQ     B_VECTNIL+29
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:126  
        11 000671   000551 755000 1                  STA     DO_PASS
        11 000672   000552 756000 1                  STQ     DO_PASS+1

      985    12883    4                     DO_FID.SIZE = 0;

  12883 11 000673   000000 236003                    LDQ     0,DU
        11 000674   200013 552140                    STBQ    DO_FID,'40'O,AUTO

      986    12884
      987    12885    4                     IF ONLINE_GETCMD.OUT$ -> OUT$BLK.NSUBLKS > 0

  12885 11 000675   000001 220100                    LDX0    1,,PR0
        11 000676   000764 600000 11                 TZE     s:12911

      988    12886    4                     THEN
      989    12887    5                       DO I = 0 TO ONLINE_GETCMD.OUT$ -> OUT$BLK.NSUBLKS - 1;

  12887 11 000677   200031 450100                    STZ     I,,AUTO
        11 000700   000760 710000 11                 TRA     s:12908+1

      990    12888
      991    12889    5                            PTR$ = ONLINE_GETCMD.OUT$ -> OUT$BLK.SUBLK$(I);

  12889 11 000701   000155 470400 1                  LDP0    ONLINE_GETCMD+1
        11 000702   200031 720100                    LXL0    I,,AUTO
        11 000703   000003 236110                    LDQ     3,X0,PR0
        11 000704   200033 756100                    STQ     PTR$,,AUTO

      992    12890
      993    12891
      994    12892    6                            DO CASE (PTR$ -> OUT$BLK.CODE);

  12892 11 000705   200033 471500                    LDP1    PTR$,,AUTO
        11 000706   100000 236100                    LDQ     0,,PR1
        11 000707   777777 376007                    ANQ     -1,DL
        11 000710   000005 136007                    SBLQ    5,DL
        11 000711   000006 116007                    CMPQ    6,DL
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:127  
        11 000712   000714 602006 11                 TNC     s:12892+7,QL
        11 000713   000757 710000 11                 TRA     s:12908
        11 000714   000751 710000 11                 TRA     s:12905
        11 000715   000722 710000 11                 TRA     s:12895
        11 000716   000757 710000 11                 TRA     s:12908
        11 000717   000757 710000 11                 TRA     s:12908
        11 000720   000733 710000 11                 TRA     s:12899
        11 000721   000742 710000 11                 TRA     s:12902

      995    12893
      996    12894    6                            CASE (%IA_GKEY_UNAME#);

      997    12895    6                               DO_FID.TEXT = PTR$ -> OUT$SYM.TEXT;

  12895 11 000722   100004 236100                    LDQ     4,,PR1
        11 000723   000033 772000                    QRL     27
        11 000724   000000 621006                    EAX1    0,QL
        11 000725   040100 100540                    MLR     fill='040'O
        11 000726   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        11 000727   200013 200023                    ADSC9   DO_FID,,AUTO             cn=1,n=19

      998    12896    6                               DO_FID.SIZE = PTR$ -> OUT$SYM.COUNT;

  12896 11 000730   100004 236100                    LDQ     4,,PR1
        11 000731   200013 552140                    STBQ    DO_FID,'40'O,AUTO
        11 000732   000757 710000 11                 TRA     s:12908

      999    12897
     1000    12898    6                            CASE (%IA_GKEY_ACCT#); /* Account specified */

     1001    12899    6                               DO_ACCT = PTR$ -> OUT$SYM.TEXT;

  12899 11 000733   100004 236100                    LDQ     4,,PR1
        11 000734   000033 772000                    QRL     27
        11 000735   000000 621006                    EAX1    0,QL
        11 000736   040000 100540                    MLR     fill='040'O
        11 000737   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:128  
        11 000740   000444 000010 1                  ADSC9   DO_ACCT                  cn=0,n=8
        11 000741   000757 710000 11                 TRA     s:12908

     1002    12900                                                /**/
     1003    12901    6                            CASE (%IA_GKEY_PASS#);

     1004    12902    6                               DO_PASS = PTR$ -> OUT$SYM.TEXT;

  12902 11 000742   100004 236100                    LDQ     4,,PR1
        11 000743   000033 772000                    QRL     27
        11 000744   000000 621006                    EAX1    0,QL
        11 000745   040000 100540                    MLR     fill='040'O
        11 000746   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        11 000747   000551 000010 1                  ADSC9   DO_PASS                  cn=0,n=8
        11 000750   000757 710000 11                 TRA     s:12908

     1005    12903
     1006    12904    6                            CASE (%IA_GKEY_CMD#);

     1007    12905    6                               DO_CMD = PTR$ -> OUT$SYM.TEXT;

  12905 11 000751   100004 236100                    LDQ     4,,PR1
        11 000752   000033 772000                    QRL     27
        11 000753   000000 621006                    EAX1    0,QL
        11 000754   040000 100540                    MLR     fill='040'O
        11 000755   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        11 000756   000446 000400 1                  ADSC9   DO_CMD                   cn=0,n=256

     1008    12906
     1009    12907    6                            END;           /* End cases */

     1010    12908    5                          END;             /* End do i */

  12908 11 000757   200031 054100                    AOS     I,,AUTO
        11 000760   000001 236100                    LDQ     1,,PR0
        11 000761   000022 772000                    QRL     18
        11 000762   200031 116100                    CMPQ    I,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:129  
        11 000763   000701 605400 11                 TPNZ    s:12889

     1011    12909
     1012    12910
     1013    12911    4                     DO_TYPE = %IA_CMD_START#;

  12911 11 000764   003000 236003                    LDQ     1536,DU
        11 000765   200024 756100                    STQ     DO_TYPE,,AUTO

     1014    12912    4                     CALL DO$COMMAND(DO_FID, DO_CMD, DO_TYPE, 0, DO_ACCT, DO_PASS);

  12912 11 000766   000020 236000 12                 LDQ     16
        11 000767   200050 756100                    STQ     @ACCOUNT+1,,AUTO
        11 000770   000022 237000 12                 LDAQ    18
        11 000771   200046 757100                    STAQ    @TYPE+1,,AUTO
        11 000772   200024 631500                    EPPR1   DO_TYPE,,AUTO
        11 000773   200045 451500                    STP1    @COMMAND+1,,AUTO
        11 000774   000024 236000 12                 LDQ     20
        11 000775   200044 756100                    STQ     @FID+1,,AUTO
        11 000776   200013 633500                    EPPR3   DO_FID,,AUTO
        11 000777   200043 453500                    STP3    J+1,,AUTO
        11 001000   005106 701000 11                 TSX1    DO$COMMAND
        11 001001   000000 011000                    NOP     0
        11 001002   000537 710000 11                 TRA     MAIN_OLOOP

     1015    12913                                                /**/
     1016    12914                                                /**/
     1017    12915    4                  CASE (%IA_CMD_GOOSEON#); /* Want to turn goose on */

     1018    12916    4                     CALL M$OPEN(OPEN_OCSCG) ALTRET(NO_CAN_DO);

  12916 11 001003   004232 630400 1                  EPPR0   OPEN_OCSCG
        11 001004   450000 713400                    CLIMB   alt,open
        11 001005   410400 401760                    pmme    nvectors=18
        11 001006   001617 702000 11                 TSX2    NO_CAN_DO

     1019    12917    4                     CALL M$WRITE(GOOSE_ON_WR) ALTRET(NO_CAN_DO_1);
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:130  

  12917 11 001007   004376 630400 1                  EPPR0   GOOSE_ON_WR
        11 001010   440001 713400                    CLIMB   alt,write
        11 001011   401400 401760                    pmme    nvectors=4
        11 001012   001614 702000 11                 TSX2    NO_CAN_DO_1

     1020    12918    4                     CALL M$CLOSE(CLOSE_OCSCG);

  12918 11 001013   004340 630400 1                  EPPR0   CLOSE_OCSCG
        11 001014   050001 713400                    CLIMB   close
        11 001015   406000 401760                    pmme    nvectors=13

     1021    12919    4                     CALL IAE$ONLINE_ERROR (%E$IA_SCHED_ON#,0);

  12919 11 001016   000021 630400 12                 EPPR0   17
        11 001017   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001020   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001021   000000 011000                    NOP     0
        11 001022   000537 710000 11                 TRA     MAIN_OLOOP

     1022    12920                                                /**/
     1023    12921                                                /**/
     1024    12922    4                  CASE (%IA_CMD_GOOSEOFF#); /* Want to turn goose off */

     1025    12923    4                     CALL M$OPEN(OPEN_OCSCG) ALTRET(NO_CAN_DO);

  12923 11 001023   004232 630400 1                  EPPR0   OPEN_OCSCG
        11 001024   450000 713400                    CLIMB   alt,open
        11 001025   410400 401760                    pmme    nvectors=18
        11 001026   001617 702000 11                 TSX2    NO_CAN_DO

     1026    12924    4                     CALL M$WRITE(GOOSE_OFF) ALTRET(NO_CAN_DO_1);

  12924 11 001027   004412 630400 1                  EPPR0   GOOSE_OFF
        11 001030   440001 713400                    CLIMB   alt,write
        11 001031   401400 401760                    pmme    nvectors=4
        11 001032   001614 702000 11                 TSX2    NO_CAN_DO_1
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:131  

     1027    12925    4                     CALL M$CLOSE(CLOSE_OCSCG);

  12925 11 001033   004340 630400 1                  EPPR0   CLOSE_OCSCG
        11 001034   050001 713400                    CLIMB   close
        11 001035   406000 401760                    pmme    nvectors=13

     1028    12926    4                     CALL IAE$ONLINE_ERROR (%E$IA_SCHED_OFF#,0);

  12926 11 001036   000025 630400 12                 EPPR0   21
        11 001037   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001040   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001041   000000 011000                    NOP     0
        11 001042   000537 710000 11                 TRA     MAIN_OLOOP

     1029    12927                                                /**/
     1030    12928                                                /**/
     1031    12929                                                /**/
     1032    12930    4                  CASE (%IA_CMD_GOOSEMON#); /* Want to turn goose on */

     1033    12931    4                     CALL M$OPEN(OPEN_OCSCG) ALTRET(NO_CAN_DO);

  12931 11 001043   004232 630400 1                  EPPR0   OPEN_OCSCG
        11 001044   450000 713400                    CLIMB   alt,open
        11 001045   410400 401760                    pmme    nvectors=18
        11 001046   001617 702000 11                 TSX2    NO_CAN_DO

     1034    12932    4                     CALL M$WRITE(GOOSEM_ON_WR) ALTRET(NO_CAN_DO_1);

  12932 11 001047   004426 630400 1                  EPPR0   GOOSEM_ON_WR
        11 001050   440001 713400                    CLIMB   alt,write
        11 001051   401400 401760                    pmme    nvectors=4
        11 001052   001614 702000 11                 TSX2    NO_CAN_DO_1

     1035    12933    4                     CALL M$CLOSE(CLOSE_OCSCG);

  12933 11 001053   004340 630400 1                  EPPR0   CLOSE_OCSCG
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:132  
        11 001054   050001 713400                    CLIMB   close
        11 001055   406000 401760                    pmme    nvectors=13

     1036    12934    4                     CALL IAE$ONLINE_ERROR (%E$IA_SCHED_MSG_ON#,0);

  12934 11 001056   000027 630400 12                 EPPR0   23
        11 001057   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001060   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001061   000000 011000                    NOP     0
        11 001062   000537 710000 11                 TRA     MAIN_OLOOP

     1037    12935                                                /**/
     1038    12936                                                /**/
     1039    12937    4                  CASE (%IA_CMD_GOOSEMOFF#); /* Want to turn goose off */

     1040    12938    4                     CALL M$OPEN(OPEN_OCSCG) ALTRET(NO_CAN_DO);

  12938 11 001063   004232 630400 1                  EPPR0   OPEN_OCSCG
        11 001064   450000 713400                    CLIMB   alt,open
        11 001065   410400 401760                    pmme    nvectors=18
        11 001066   001617 702000 11                 TSX2    NO_CAN_DO

     1041    12939    4                     CALL M$WRITE(GOOSEM_OFF) ALTRET(NO_CAN_DO_1);

  12939 11 001067   004442 630400 1                  EPPR0   GOOSEM_OFF
        11 001070   440001 713400                    CLIMB   alt,write
        11 001071   401400 401760                    pmme    nvectors=4
        11 001072   001614 702000 11                 TSX2    NO_CAN_DO_1

     1042    12940    4                     CALL M$CLOSE(CLOSE_OCSCG);

  12940 11 001073   004340 630400 1                  EPPR0   CLOSE_OCSCG
        11 001074   050001 713400                    CLIMB   close
        11 001075   406000 401760                    pmme    nvectors=13

     1043    12941    4                     CALL IAE$ONLINE_ERROR (%E$IA_SCHED_MSG_OFF#,0);

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:133  
  12941 11 001076   000031 630400 12                 EPPR0   25
        11 001077   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001100   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001101   000000 011000                    NOP     0
        11 001102   000537 710000 11                 TRA     MAIN_OLOOP

     1044    12942                                                /**/
     1045    12943                                                /**/
     1046    12944    4                  CASE (%IA_CMD_GOOSEUPD#); /* Goose egg updated */

     1047    12945    4                     CALL M$OPEN(OPEN_OCSCG) ALTRET(NO_CAN_DO);

  12945 11 001103   004232 630400 1                  EPPR0   OPEN_OCSCG
        11 001104   450000 713400                    CLIMB   alt,open
        11 001105   410400 401760                    pmme    nvectors=18
        11 001106   001617 702000 11                 TSX2    NO_CAN_DO

  12945 11 001107                       GOOSE_UPDATE null
     1048    12946    4   GOOSE_UPDATE:     ;
     1049    12947    4                     CALL M$WRITE(WGOOSE_UPD) ALTRET(NO_CAN_DO_1);

  12947 11 001107   004456 630400 1                  EPPR0   WGOOSE_UPD
        11 001110   440001 713400                    CLIMB   alt,write
        11 001111   401400 401760                    pmme    nvectors=4
        11 001112   001614 702000 11                 TSX2    NO_CAN_DO_1

     1050    12948    4                     CALL M$CLOSE(CLOSE_OCSCG);

  12948 11 001113   004340 630400 1                  EPPR0   CLOSE_OCSCG
        11 001114   050001 713400                    CLIMB   close
        11 001115   406000 401760                    pmme    nvectors=13

     1051    12949    4                     CALL IAE$ONLINE_ERROR (%E$IA_SCHED_UPD#,0);

  12949 11 001116   000033 630400 12                 EPPR0   27
        11 001117   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001120   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:134  
        11 001121   000000 011000                    NOP     0
        11 001122   000537 710000 11                 TRA     MAIN_OLOOP

     1052    12950                                                /**/
     1053    12951                                                /**/
     1054    12952                            /*  The next section of code will allow the user to
     1055    12953                                 update the GOOSE_EGG file. The first thing
     1056    12954                                 done is copying the file to a star file for
     1057    12955                                 the user to update and then linking to edit
     1058    12956                                 for the user to do the actual updating. On
     1059    12957                                 return the program parses all the commands in
     1060    12958                                 the file and if there are syntax errors the
     1061    12959                                 user is asked if he would like to update it
     1062    12960                                 again. If there are no errors the file is
     1063    12961                                 copied over GOOSE_EGG */
     1064    12962                                                /**/
     1065    12963                                                /**/
     1066    12964    4                  CASE (%IA_CMD_UPDATE#);  /* Wants to update goose egg */

     1067    12965    4                     REMEMBER CLOSE_FILES IN ABORT_CMD;

  12965 11 001123   001633 635000 11                 EAA     CLOSE_FILES
        11 001124   000000 452400 xsym               STP2    ABORT_CMD
        11 001125   000001 755000 xsym               STA     ABORT_CMD+1

     1068    12966    4                    CALL M$OPEN(OPEN_OCSCG) ALTRET(NO_CAN_DO); /* Locks other users */

  12966 11 001126   004232 630400 1                  EPPR0   OPEN_OCSCG
        11 001127   450000 713400                    CLIMB   alt,open
        11 001130   410400 401760                    pmme    nvectors=18
        11 001131   001617 702000 11                 TSX2    NO_CAN_DO

     1069    12967    4                     CALL M$OPEN(OPEN_S)

  12967 11 001132   003740 630400 1                  EPPR0   OPEN_S
        11 001133   450000 713400                    CLIMB   alt,open
        11 001134   410400 401760                    pmme    nvectors=18
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:135  
        11 001135   001137 702000 11                 TSX2    s:12969
        11 001136   001150 710000 11                 TRA     s:12973

     1070    12968    5                     WHENALTRETURN DO;

     1071    12969    5                            ERROR = %SYSTEM_ERROR;

  12969 11 001137   000000 470400 xsym               LDP0    B$TCB$
        11 001140   000000 471500                    LDP1    0,,PR0
        11 001141   100102 236100                    LDQ     66,,PR1
        11 001142   004132 756000 1                  STQ     ERROR

     1072    12970    5                            CALL IAE$ONLINE_ERROR (%E$IA_EGG_OPEN_ERR#, ERROR);

  12970 11 001143   000036 630400 12                 EPPR0   30
        11 001144   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001145   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001146   000000 011000                    NOP     0

     1073    12971    5                            GOTO READ_OLOOP;

  12971 11 001147   000555 710000 11                 TRA     READ_OLOOP

     1074    12972    5                          END;             /* Whenaltreturn */
     1075    12973    4                     CALL M$OPEN(OPEN_TEMP)

  12973 11 001150   004770 630400 1                  EPPR0   OPEN_TEMP
        11 001151   450000 713400                    CLIMB   alt,open
        11 001152   410400 401760                    pmme    nvectors=18
        11 001153   001155 702000 11                 TSX2    s:12975
        11 001154   001171 710000 11                 TRA     s:12980

     1076    12974    5                     WHENALTRETURN DO;

     1077    12975    5                            ERROR = %SYSTEM_ERROR;

  12975 11 001155   000000 470400 xsym               LDP0    B$TCB$
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:136  
        11 001156   000000 471500                    LDP1    0,,PR0
        11 001157   100102 236100                    LDQ     66,,PR1
        11 001160   004132 756000 1                  STQ     ERROR

     1078    12976    5                            CALL IAE$ONLINE_ERROR (%E$IA_TEMP_OPEN_ERR#, ERROR);

  12976 11 001161   000041 630400 12                 EPPR0   33
        11 001162   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001163   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001164   000000 011000                    NOP     0

     1079    12977    5                            CALL M$CLOSE (CLOSE_S);

  12977 11 001165   004074 630400 1                  EPPR0   CLOSE_S
        11 001166   050001 713400                    CLIMB   close
        11 001167   406000 401760                    pmme    nvectors=13

     1080    12978    5                            GOTO READ_OLOOP;

  12978 11 001170   000555 710000 11                 TRA     READ_OLOOP

     1081    12979    5                          END;             /* Whenaltreturn */
     1082    12980    4                     EDIT_KEY.NUM = 0;

  12980 11 001171   000000 236003                    LDQ     0,DU
        11 001172   000556 552034 1                  STBQ    EDIT_KEY,'34'O

     1083    12981                                                /**/
     1084    12982                                                /**/
     1085    12983    5   COPY_FILE:        DO WHILE (%YES#);     /* Copy file */

  12983 11 001173                       COPY_FILE    null
     1086    12984    5                          CALL M$READ(READ_S)

  12984 11 001173   004040 630400 1                  EPPR0   READ_S
        11 001174   440000 713400                    CLIMB   alt,read
        11 001175   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:137  
        11 001176   001200 702000 11                 TSX2    s:12986
        11 001177   001203 710000 11                 TRA     s:12989

     1087    12985    6                          WHENALTRETURN DO;

     1088    12986    6                                 GOOSE_ERROR = %E$IA_EGG_RD_ERR#;

  12986 11 001200   000017 235007                    LDA     15,DL
        11 001201   200030 755100                    STA     GOOSE_ERROR,,AUTO

     1089    12987    6                                 EXIT COPY_FILE;

  12987 11 001202   001231 710000 11                 TRA     s:12999

     1090    12988    6                               END;        /* Whenaltreturn */
     1091    12989    5                         WRITE_TEMP.BUF_.BOUND = DCBADDR(DCBNUM(M$SCHED)) -> F$DCB.ARS
             12989                                   - 1;

  12989 11 001203   000000 236007 xsym               LDQ     M$SCHED,DL
        11 001204   000043 470400 12                 LDP0    35
        11 001205   000000 471500                    LDP1    0,,PR0
        11 001206   100000 473506                    LDP3    0,QL,PR1
        11 001207   300000 236100                    LDQ     0,,PR3
        11 001210   000001 136007                    SBLQ    1,DL
        11 001211   000020 736000                    QLS     16
        11 001212   005424 676000 1                  ERQ     WRITE_TEMP+4
        11 001213   000034 376000 xsym               ANQ     B_VECTNIL+28
        11 001214   005424 656000 1                  ERSQ    WRITE_TEMP+4

     1092    12990    5                          EDIT_KEY.NUM = EDIT_KEY.NUM + 1000;

  12990 11 001215   000556 236000 1                  LDQ     EDIT_KEY
        11 001216   001750 036007                    ADLQ    1000,DL
        11 001217   000556 552034 1                  STBQ    EDIT_KEY,'34'O

     1093    12991    5                          CALL M$WRITE(WRITE_TEMP)

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:138  
  12991 11 001220   005420 630400 1                  EPPR0   WRITE_TEMP
        11 001221   440001 713400                    CLIMB   alt,write
        11 001222   401400 401760                    pmme    nvectors=4
        11 001223   001225 702000 11                 TSX2    s:12993
        11 001224   001230 710000 11                 TRA     s:12996

     1094    12992    6                          WHENALTRETURN DO;

     1095    12993    6                                 GOOSE_ERROR = %E$IA_TEMP_WR_ERR#;

  12993 11 001225   000023 235007                    LDA     19,DL
        11 001226   200030 755100                    STA     GOOSE_ERROR,,AUTO

     1096    12994    6                                 EXIT COPY_FILE;

  12994 11 001227   001231 710000 11                 TRA     s:12999

     1097    12995    6                               END;        /* Whenaltreturn */
     1098    12996    5                        END COPY_FILE;     /* End copying forever */

  12996 11 001230   001173 710000 11                 TRA     COPY_FILE

     1099    12997                                                /**/
     1100    12998                                                /**/
     1101    12999    4                     ERROR = %SYSTEM_ERROR;

  12999 11 001231   000000 470400 xsym               LDP0    B$TCB$
        11 001232   000000 471500                    LDP1    0,,PR0
        11 001233   100102 236100                    LDQ     66,,PR1
        11 001234   004132 756000 1                  STQ     ERROR

     1102    13000    4                     CALL M$CLOSE (CLOSE_S);

  13000 11 001235   004074 630400 1                  EPPR0   CLOSE_S
        11 001236   050001 713400                    CLIMB   close
        11 001237   406000 401760                    pmme    nvectors=13

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:139  
     1103    13001    4                     CALL M$CLOSE (CLOSE_TEMP);

  13001 11 001240   005324 630400 1                  EPPR0   CLOSE_TEMP
        11 001241   050001 713400                    CLIMB   close
        11 001242   406000 401760                    pmme    nvectors=13

     1104    13002    4                     IF ERROR.ERR# ~= %E$EOF

  13002 11 001243   004132 236000 1                  LDQ     ERROR
        11 001244   377770 376007                    ANQ     131064,DL
        11 001245   000060 116007                    CMPQ    48,DL
        11 001246   001263 600000 11                 TZE     EDIT_AGAIN

     1105    13003    5                     THEN DO;

     1106    13004    5                            CALL IAE$ONLINE_ERROR (GOOSE_ERROR, ERROR);

  13004 11 001247   000037 236000 12                 LDQ     31
        11 001250   200117 756100                    STQ     CONV_CURRENT+2,,AUTO
        11 001251   200030 630500                    EPPR0   GOOSE_ERROR,,AUTO
        11 001252   200116 450500                    STP0    CONV_CURRENT+1,,AUTO
        11 001253   200116 630500                    EPPR0   CONV_CURRENT+1,,AUTO
        11 001254   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001255   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001256   000000 011000                    NOP     0

     1107    13005    5                            CALL M$CLOSE (CLOSE_OCSCG);

  13005 11 001257   004340 630400 1                  EPPR0   CLOSE_OCSCG
        11 001260   050001 713400                    CLIMB   close
        11 001261   406000 401760                    pmme    nvectors=13

     1108    13006    5                            GOTO READ_OLOOP;

  13006 11 001262   000555 710000 11                 TRA     READ_OLOOP

  13002 11 001263                       EDIT_AGAIN   null
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:140  
     1109    13007    5                          END;             /* Error not eof */
     1110    13008                                                /**/
     1111    13009                                                /**/
     1112    13010                                                /**/
     1113    13011    4   EDIT_AGAIN:       ;
     1114    13012    4                     CALL M$LINK(LINK_EDIT)

  13012 11 001263   004702 630400 1                  EPPR0   LINK_EDIT
        11 001264   400005 713400                    CLIMB   alt,+5
        11 001265   403000 401760                    pmme    nvectors=7
        11 001266   001270 702000 11                 TSX2    s:13014
        11 001267   001304 710000 11                 TRA     s:13020

     1115    13013    5                     WHENALTRETURN DO;

     1116    13014    5                            ERROR = %SYSTEM_ERROR;

  13014 11 001270   000000 470400 xsym               LDP0    B$TCB$
        11 001271   000000 471500                    LDP1    0,,PR0
        11 001272   100102 236100                    LDQ     66,,PR1
        11 001273   004132 756000 1                  STQ     ERROR

     1117    13015    5                            CALL IAE$ONLINE_ERROR (%E$IA_LINK_ERR#,ERROR);

  13015 11 001274   000045 630400 12                 EPPR0   37
        11 001275   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001276   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001277   000000 011000                    NOP     0

     1118    13016    5                            CALL M$CLOSE(CLOSE_OCSCG);

  13016 11 001300   004340 630400 1                  EPPR0   CLOSE_OCSCG
        11 001301   050001 713400                    CLIMB   close
        11 001302   406000 401760                    pmme    nvectors=13

     1119    13017    5                            GOTO READ_OLOOP;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:141  
  13017 11 001303   000555 710000 11                 TRA     READ_OLOOP

     1120    13018    5                          END;             /* whenaltreturn */
     1121    13019                                      /* Now we must check the file he just edited */
     1122    13020    4                     ERROR_FLAG = %NO#;    /* No error flag */

  13020 11 001304   200027 450100                    STZ     ERROR_FLAG,,AUTO

     1123    13021    4                     CALL M$SPRIV (RESET_FMSEC);

  13021 11 001305   005606 630400 1                  EPPR0   RESET_FMSEC
        11 001306   020012 713400                    CLIMB   8202
        11 001307   400000 401760                    pmme    nvectors=1

     1124    13022    4                     CALL M$OPEN (OPEN_S_OUT)

  13022 11 001310   005064 630400 1                  EPPR0   OPEN_S_OUT
        11 001311   450000 713400                    CLIMB   alt,open
        11 001312   410400 401760                    pmme    nvectors=18
        11 001313   001315 702000 11                 TSX2    s:13024
        11 001314   001326 710000 11                 TRA     s:13028

     1125    13023    5                     WHENALTRETURN DO;

     1126    13024    5                            ERROR = %SYSTEM_ERROR;

  13024 11 001315   000000 470400 xsym               LDP0    B$TCB$
        11 001316   000000 471500                    LDP1    0,,PR0
        11 001317   100102 236100                    LDQ     66,,PR1
        11 001320   004132 756000 1                  STQ     ERROR

     1127    13025    5                            CALL IAE$ONLINE_ERROR (%E$IA_EGG_OPEN_ERR#, ERROR);

  13025 11 001321   000036 630400 12                 EPPR0   30
        11 001322   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001323   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001324   000000 011000                    NOP     0
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:142  

     1128    13026    5                            GOTO READ_OLOOP;

  13026 11 001325   000555 710000 11                 TRA     READ_OLOOP

     1129    13027    5                          END;             /*  Whenaltreturn */
     1130    13028    4                     CALL M$RPRIV (RESET_FMSEC);

  13028 11 001326   005606 630400 1                  EPPR0   RESET_FMSEC
        11 001327   020013 713400                    CLIMB   8203
        11 001330   400000 401760                    pmme    nvectors=1

     1131    13029    4                     CALL M$OPEN(OPEN_TEMP_IN)

  13029 11 001331   005156 630400 1                  EPPR0   OPEN_TEMP_IN
        11 001332   450000 713400                    CLIMB   alt,open
        11 001333   410400 401760                    pmme    nvectors=18
        11 001334   001336 702000 11                 TSX2    s:13031
        11 001335   001352 710000 11                 TRA     s:13045

     1132    13030    5                     WHENALTRETURN DO;

     1133    13031    5                            ERROR = %SYSTEM_ERROR;

  13031 11 001336   000000 470400 xsym               LDP0    B$TCB$
        11 001337   000000 471500                    LDP1    0,,PR0
        11 001340   100102 236100                    LDQ     66,,PR1
        11 001341   004132 756000 1                  STQ     ERROR

     1134    13032    5                            CALL IAE$ONLINE_ERROR (%E$IA_TEMP_OPEN_ERR#, ERROR);

  13032 11 001342   000041 630400 12                 EPPR0   33
        11 001343   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001344   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001345   000000 011000                    NOP     0

     1135    13033    5                            CALL M$CLOSE (CLOSE_S);
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:143  

  13033 11 001346   004074 630400 1                  EPPR0   CLOSE_S
        11 001347   050001 713400                    CLIMB   close
        11 001350   406000 401760                    pmme    nvectors=13

     1136    13034    5                            GOTO READ_OLOOP;

  13034 11 001351   000555 710000 11                 TRA     READ_OLOOP

     1137    13035    5                          END;             /* Whenaltreturn */
     1138    13036                                                /**/
     1139    13037        /* setup for XUG$ to read and parse the temporary GOOSE_EGG.
     1140    13038           call PARSE$COMMAND which calls XUG$ and does any necessary
     1141    13039           error reporting.
     1142    13040           Upon return from PARSE$COMMAND, if no error, echo the command
     1143    13041           to the permanent GOOSE_EGG, and contine processing.
     1144    13042           If the error was a syntax error continue processing.
     1145    13043           If any other type of error, quit processing the file.
     1146    13044        */
     1147    13045    4                     EGG_GETCMD.INDCB# = DCBNUM ( M$TEMP );

  13045 11 001352   000000 236007 xsym               LDQ     M$TEMP,DL
        11 001353   000240 756000 1                  STQ     EGG_GETCMD+10

     1148    13046    4                     CALL XUG$INIT (EGG_GETCMD, UPDATE_INIT)

  13046 11 001354   000047 630400 12                 EPPR0   39
        11 001355   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001356   000000 701000 xent               TSX1    XUG$INIT
        11 001357   001361 702000 11                 TSX2    s:13048
        11 001360   001366 710000 11                 TRA     s:13052

     1149    13047    5                     WHENALTRETURN DO;     /* we bombed out */

     1150    13048    5                            CALL IAE$ONLINE_ERROR (0,ONLINE_GETCMD.ERR#);

  13048 11 001361   000012 630400 12                 EPPR0   10
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:144  
        11 001362   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001363   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001364   000000 011000                    NOP     0

     1151    13049    5                            GOTO MAIN_OLOOP;

  13049 11 001365   000537 710000 11                 TRA     MAIN_OLOOP

     1152    13050    5                          END;             /* Whenaltreturn */
     1153    13051
     1154    13052    4                     EDIT_KEY.NUM = 0;

  13052 11 001366   000000 236003                    LDQ     0,DU
        11 001367   000556 552034 1                  STBQ    EDIT_KEY,'34'O

     1155    13053    4                     XUG$ = UPDATE_INIT.PARAMS$;

  13053 11 001370   000124 236000 1                  LDQ     UPDATE_INIT+12
        11 001371   200036 756100                    STQ     XUG$,,AUTO

     1156    13054
     1157    13055    5                     DO WHILE (%YES#);     /* do forever */

  13046 11 001372                       READ_TEMP_LP null
     1158    13056    5   READ_TEMP_LP:          ;
     1159    13057    5                          CALL PARSE$COMMAND

  13057 11 001372   003050 701000 11                 TSX1    PARSE$COMMAND
        11 001373   001506 702000 11                 TSX2    s:13080

     1160    13058    6                          WHENRETURN DO;

     1161    13059    6                                 TEMP$ = VBASE(XUG.BUFVEC);

  13059 11 001374   200036 470500                    LDP0    XUG$,,AUTO
        11 001375   000001 236100                    LDQ     1,,PR0
        11 001376   200035 756100                    STQ     TEMP$,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:145  

     1162    13060    6                                 RLT$ = VBASE(XUG.RLTVEC);

  13060 11 001377   000013 236100                    LDQ     11,,PR0
        11 001400   200034 756100                    STQ     RLT$,,AUTO

     1163    13061
     1164    13062    7                                 DO I = 1 TO XUG.NLINES;

  13062 11 001401   000001 235007                    LDA     1,DL
        11 001402   200031 755100                    STA     I,,AUTO
        11 001403   001501 710000 11                 TRA     s:13076+1

     1165    13063    7                                      SUBSTR(INBUF, 0, RLT(I)) = SUBSTR (TEMP$->
             13063                                               CMD_BUFFER,0,RLT(I));

  13063 11 001404   200034 470500                    LDP0    RLT$,,AUTO
        11 001405   200031 235100                    LDA     I,,AUTO
        11 001406   000100 101505                    MRL     fill='000'O
        11 001407   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        11 001410   200116 000002                    ADSC9   CONV_CURRENT+1,,AUTO     cn=0,n=2
        11 001411   200116 220100                    LDX0    CONV_CURRENT+1,,AUTO
        11 001412   000100 101505                    MRL     fill='000'O
        11 001413   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        11 001414   200117 000002                    ADSC9   CONV_CURRENT+2,,AUTO     cn=0,n=2
        11 001415   200117 221100                    LDX1    CONV_CURRENT+2,,AUTO
        11 001416   200035 471500                    LDP1    TEMP$,,AUTO
        11 001417   040040 100540                    MLR     fill='040'O
        11 001420   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        11 001421   002572 000010 1                  ADSC9   INBUF                    cn=0,n=*X0

     1166    13064    7                                      WRITE_SCHED.BUF_.BOUND = RLT(I) - 1;

  13064 11 001422   000100 101505                    MRL     fill='000'O
        11 001423   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        11 001424   200116 000004                    ADSC9   CONV_CURRENT+1,,AUTO     cn=0,n=4
        11 001425   200116 236100                    LDQ     CONV_CURRENT+1,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:146  
        11 001426   000001 136007                    SBLQ    1,DL
        11 001427   000020 736000                    QLS     16
        11 001430   005440 676000 1                  ERQ     WRITE_SCHED+4
        11 001431   000034 376000 xsym               ANQ     B_VECTNIL+28
        11 001432   005440 656000 1                  ERSQ    WRITE_SCHED+4

     1167    13065    7                                      IF I ~= XUG.NLINES

  13065 11 001433   200036 473500                    LDP3    XUG$,,AUTO
        11 001434   200031 236100                    LDQ     I,,AUTO
        11 001435   300106 116100                    CMPQ    70,,PR3
        11 001436   001446 600000 11                 TZE     s:13069

     1168    13066    8                                      THEN DO;

     1169    13067    8                                             SUBSTR(INBUF, RLT(I)-1,1) = ';';

  13067 11 001437   000100 101506                    MRL     fill='000'O
        11 001440   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
        11 001441   200116 000004                    ADSC9   CONV_CURRENT+1,,AUTO     cn=0,n=4
        11 001442   200116 236100                    LDQ     CONV_CURRENT+1,,AUTO
        11 001443   040006 100400                    MLR     fill='040'O
        11 001444   000051 000001 12                 ADSC9   41                       cn=0,n=1
        11 001445   002571 600001 1                  ADSC9   GREEN_LIGHT+1,Q          cn=3,n=1

     1170    13068    8                                           END;

     1171    13069    7                                      EDIT_KEY.NUM = EDIT_KEY.NUM + 1000;

  13069 11 001446   000556 236000 1                  LDQ     EDIT_KEY
        11 001447   001750 036007                    ADLQ    1000,DL
        11 001450   000556 552034 1                  STBQ    EDIT_KEY,'34'O

     1172    13070    8                                      CALL M$WRITE (WRITE_SCHED) WHENALTRETURN DO;

  13070 11 001451   005434 630400 1                  EPPR0   WRITE_SCHED
        11 001452   440001 713400                    CLIMB   alt,write
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:147  
        11 001453   401400 401760                    pmme    nvectors=4
        11 001454   001456 702000 11                 TSX2    s:13071
        11 001455   001467 710000 11                 TRA     s:13075

     1173    13071    8                                            ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  13071 11 001456   000000 470400 xsym               LDP0    B$TCB$
        11 001457   000000 471500                    LDP1    0,,PR0
        11 001460   100102 236100                    LDQ     66,,PR1
        11 001461   004132 756000 1                  STQ     ERROR

     1174    13072    8                                             CALL IAE$ONLINE_ERROR (%E$IA_EGG_WR_ERR#,
             13072                                                      ERROR);

  13072 11 001462   000053 630400 12                 EPPR0   43
        11 001463   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001464   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001465   000000 011000                    NOP     0

     1175    13073    8                                             GOTO CLOSE_REL_S_AND_TEMP;

  13073 11 001466   001630 710000 11                 TRA     CLOSE_REL_S_AND_TEMP

     1176    13074    8                                           END; /* Whenaltreturn from M$WRITE */
     1177    13075    7                                      TEMP$ = PINCRC(TEMP$,RLT(I));

  13075 11 001467   200034 470500                    LDP0    RLT$,,AUTO
        11 001470   200031 235100                    LDA     I,,AUTO
        11 001471   000100 101505                    MRL     fill='000'O
        11 001472   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
        11 001473   200116 000004                    ADSC9   CONV_CURRENT+1,,AUTO     cn=0,n=4
        11 001474   200116 236100                    LDQ     CONV_CURRENT+1,,AUTO
        11 001475   000020 736000                    QLS     16
        11 001476   200035 036100                    ADLQ    TEMP$,,AUTO
        11 001477   200035 756100                    STQ     TEMP$,,AUTO

     1178    13076    7                                    END;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:148  

  13076 11 001500   200031 054100                    AOS     I,,AUTO
        11 001501   200036 470500                    LDP0    XUG$,,AUTO
        11 001502   200031 236100                    LDQ     I,,AUTO
        11 001503   000106 116100                    CMPQ    70,,PR0
        11 001504   001404 604400 11                 TMOZ    s:13063

     1179    13077
     1180    13078    6                               END;        /* Whenreturn from PARSE$COMMAND */

  13078 11 001505   001612 710000 11                 TRA     s:13120

     1181    13079    6                          WHENALTRETURN DO;

     1182    13080    6                                 IF ERROR.ERR# = %E$EOF

  13080 11 001506   004132 236000 1                  LDQ     ERROR
        11 001507   377770 376007                    ANQ     131064,DL
        11 001510   000060 116007                    CMPQ    48,DL
        11 001511   001565 601000 11                 TNZ     s:13107

     1183    13081    7                                 THEN DO;

     1184    13082    7                                        IF ERROR_FLAG /* See if there was an error */

  13082 11 001512   200027 234100                    SZN     ERROR_FLAG,,AUTO
        11 001513   001547 605000 11                 TPL     s:13100

     1185    13083    8                                        THEN DO;

     1186    13084    9                                               DO WHILE (%YES#);

     1187    13085    9                                                   CALL IAE$ONLINE_ERROR (%E$IA_EDIT#,
             13085                                                             0);

  13085 11 001514   000055 630400 12                 EPPR0   45
        11 001515   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:149  
        11 001516   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001517   000000 011000                    NOP     0

     1188    13086    9                                                    INBUF = '  ';

  13086 11 001520   040000 100400                    MLR     fill='040'O
        11 001521   000015 000002 10                 ADSC9   NO_GHOST+7               cn=0,n=2
        11 001522   002572 002000 1                  ADSC9   INBUF                    cn=0,n=1024

     1189    13087    9                                                    CALL M$READ(READ_SI) ALTRET(
             13087                                                             CHECK_END);

  13087 11 001523   004214 630400 1                  EPPR0   READ_SI
        11 001524   440000 713400                    CLIMB   alt,read
        11 001525   401400 401760                    pmme    nvectors=4
        11 001526   000650 702000 11                 TSX2    CHECK_END

     1190    13088    9                                                    IF INBUF = 'YES'

  13088 11 001527   040000 106400                    CMPC    fill='040'O
        11 001530   002572 002000 1                  ADSC9   INBUF                    cn=0,n=1024
        11 001531   000016 000003 10                 ADSC9   NO_GHOST+8               cn=0,n=3
        11 001532   001542 601000 11                 TNZ     s:13094

     1191    13089   10                                                    THEN DO;

     1192    13090   10                                                          CALL M$CLOSE(CLOSE_SCHED_REL
             13090                                                                    );

  13090 11 001533   005250 630400 1                  EPPR0   CLOSE_SCHED_REL
        11 001534   050001 713400                    CLIMB   close
        11 001535   406000 401760                    pmme    nvectors=13

     1193    13091   10                                                           CALL M$CLOSE(CLOSE_TEMP);

  13091 11 001536   005324 630400 1                  EPPR0   CLOSE_TEMP
        11 001537   050001 713400                    CLIMB   close
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:150  
        11 001540   406000 401760                    pmme    nvectors=13

     1194    13092   10                                                           GOTO EDIT_AGAIN;

  13092 11 001541   001263 710000 11                 TRA     EDIT_AGAIN

     1195    13093   10                                                         END; /*  buf = yes */
     1196    13094    9                                                    IF INBUF = 'NO'

  13094 11 001542   040000 106400                    CMPC    fill='040'O
        11 001543   002572 002000 1                  ADSC9   INBUF                    cn=0,n=1024
        11 001544   000017 000002 10                 ADSC9   NO_GHOST+9               cn=0,n=2
        11 001545   001630 600000 11                 TZE     CLOSE_REL_S_AND_TEMP

     1197    13095    9                                                    THEN
     1198    13096    9                                                         GOTO CLOSE_REL_S_AND_TEMP;
     1199    13097    9                                                  END; /* End while forever */

  13097 11 001546   001514 710000 11                 TRA     s:13085

     1200    13098    8                                             END; /*  if error_flag  */
     1201    13099    8                                        ELSE DO;

     1202    13100    8                                               CALL M$CLOSE (CLOSE_S);

  13100 11 001547   004074 630400 1                  EPPR0   CLOSE_S
        11 001550   050001 713400                    CLIMB   close
        11 001551   406000 401760                    pmme    nvectors=13

     1203    13101    8                                               CALL M$CLOSE(CLOSE_TEMP_REL);

  13101 11 001552   005362 630400 1                  EPPR0   CLOSE_TEMP_REL
        11 001553   050001 713400                    CLIMB   close
        11 001554   406000 401760                    pmme    nvectors=13

     1204    13102    8                                               CALL M$LINK (LINK_PCL);

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:151  
  13102 11 001555   004726 630400 1                  EPPR0   LINK_PCL
        11 001556   000005 713400                    CLIMB   5
        11 001557   403000 401760                    pmme    nvectors=7

     1205    13103    8                                              CALL IAE$ONLINE_ERROR(%E$IA_EGG_UPD#,0);

  13103 11 001560   000057 630400 12                 EPPR0   47
        11 001561   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001562   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001563   000000 011000                    NOP     0

     1206    13104    8                                               GOTO GOOSE_UPDATE;

  13104 11 001564   001107 710000 11                 TRA     GOOSE_UPDATE

     1207    13105    8                                             END; /* Else ERROR_FLAG */
     1208    13106    7                                      END; /* If E$EOF */
     1209    13107    6                                 ELSE IF ERROR.ERR# = %E$SYNERR /* Syntax error */

  13107 11 001565   000010 116007                    CMPQ    8,DL
        11 001566   001611 601000 11                 TNZ     s:13117

     1210    13108    7                                      THEN DO;

     1211    13109    7                                             ERROR_FLAG = %YES#;

  13109 11 001567   400000 236003                    LDQ     -131072,DU
        11 001570   200027 756100                    STQ     ERROR_FLAG,,AUTO

     1212    13110    7                                             EGG_GETCMD.DCB_PARAM# = DCBNUM ( M$LO );

  13110 11 001571   000000 236007 xsym               LDQ     M$LO,DL
        11 001572   000242 756000 1                  STQ     EGG_GETCMD+12

     1213    13111    7                                             EGG_GETCMD.DCB2_PARAM# = DCBNUM ( M$DO );

  13111 11 001573   000000 236007 xsym               LDQ     M$DO,DL
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:152  
        11 001574   000243 756000 1                  STQ     EGG_GETCMD+13

     1214    13112    7                                             CALL XUG$ECHOIF (EGG_GETCMD);

  13112 11 001575   000047 630400 12                 EPPR0   39
        11 001576   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 001577   000000 701000 xent               TSX1    XUG$ECHOIF
        11 001600   000000 011000                    NOP     0

     1215    13113    7                                             IF NOT EGG_GETCMD.CONTINUED# THEN

  13113 11 001601   000234 236000 1                  LDQ     EGG_GETCMD+6
        11 001602   100000 316003                    CANQ    32768,DU
        11 001603   001612 601000 11                 TNZ     s:13120

     1216    13114    7                                                  CALL XUG$ERRPTR (EGG_GETCMD);

  13114 11 001604   000047 630400 12                 EPPR0   39
        11 001605   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 001606   000000 701000 xent               TSX1    XUG$ERRPTR
        11 001607   000000 011000                    NOP     0

     1217    13115    7                                           END; /* error is syntax */

  13115 11 001610   001612 710000 11                 TRA     s:13120

     1218    13116    7                                      ELSE DO;

     1219    13117    7                                             GOTO CLOSE_REL_S_AND_TEMP;

  13117 11 001611   001630 710000 11                 TRA     CLOSE_REL_S_AND_TEMP

     1220    13118    7                                           END; /* Else error ~ syntax */
     1221    13119    6                               END;        /*  Whenaltreturn  */
     1222    13120    5                        END;               /* do forever */

  13120 11 001612   001372 710000 11                 TRA     READ_TEMP_LP
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:153  

     1223    13121                                                /**/
     1224    13122                                                /**/
     1225    13123    4                  END;                     /* Do case OUT$BLK.CODE */

     1226    13124    3                END;                       /* Do forever READ_OLOOP */

  13124 11 001613   000537 710000 11                 TRA     MAIN_OLOOP

     1227    13125    2           END;                            /* Else do ON_LINE */
     1228    13126    1   NO_CAN_DO_1: ;

  13126 11 001614                       NO_CAN_DO_1  null
     1229    13127    1        CALL M$CLOSE(CLOSE_OCSCG);         /* Close cscg */

  13127 11 001614   004340 630400 1                  EPPR0   CLOSE_OCSCG
        11 001615   050001 713400                    CLIMB   close
        11 001616   406000 401760                    pmme    nvectors=13

  13126 11 001617                       NO_CAN_DO    null
     1230    13128    1   NO_CAN_DO: ;
     1231    13129    1        ERROR = %SYSTEM_ERROR;

  13129 11 001617   000000 470400 xsym               LDP0    B$TCB$
        11 001620   000000 471500                    LDP1    0,,PR0
        11 001621   100102 236100                    LDQ     66,,PR1
        11 001622   004132 756000 1                  STQ     ERROR

     1232    13130    1        CALL IAE$ONLINE_ERROR (0,ERROR);

  13130 11 001623   000061 630400 12                 EPPR0   49
        11 001624   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 001625   000000 701000 xent               TSX1    IAE$ONLINE_ERROR
        11 001626   000000 011000                    NOP     0

     1233    13131    1        GOTO READ_OLOOP;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:154  
  13131 11 001627   000555 710000 11                 TRA     READ_OLOOP

     1234    13132                                                /**/
     1235    13133                                                /**/
     1236    13134    1   CLOSE_REL_S_AND_TEMP:
     1237    13135    1        CLOSE_S.V.DISP# = %RELEASE#;

  13135 11 001630   000001 236007       CLOSE_REL_S* LDQ     1,DL
        11 001631   004126 552004 1                  STBQ    CLOSE_S+26,'04'O

     1238    13136    1   CLOSE_REL_TEMP:
     1239    13137    1        CLOSE_TEMP.V.DISP# = %RELEASE#;

  13137 11 001632   005356 552004 1     CLOSE_REL_T* STBQ    CLOSE_TEMP+26,'04'O

     1240    13138    1   CLOSE_FILES:
     1241    13139    1        CALL M$CLOSE (CLOSE_OCSCG);

  13139 11 001633   004340 630400 1     CLOSE_FILES  EPPR0   CLOSE_OCSCG
        11 001634   050001 713400                    CLIMB   close
        11 001635   406000 401760                    pmme    nvectors=13

     1242    13140    1        CALL M$CLOSE (CLOSE_TEMP);

  13140 11 001636   005324 630400 1                  EPPR0   CLOSE_TEMP
        11 001637   050001 713400                    CLIMB   close
        11 001640   406000 401760                    pmme    nvectors=13

     1243    13141    1        CALL M$CLOSE (CLOSE_S);

  13141 11 001641   004074 630400 1                  EPPR0   CLOSE_S
        11 001642   050001 713400                    CLIMB   close
        11 001643   406000 401760                    pmme    nvectors=13

     1244    13142    1        CLOSE_S.V.DISP# = %SAVE#;

  13142 11 001644   000002 236007                    LDQ     2,DL
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:155  
        11 001645   004126 552004 1                  STBQ    CLOSE_S+26,'04'O

     1245    13143    1        CLOSE_TEMP.V.DISP# = %SAVE#;

  13143 11 001646   005356 552004 1                  STBQ    CLOSE_TEMP+26,'04'O

     1246    13144    1        GOTO MAIN_OLOOP;

  13144 11 001647   000537 710000 11                 TRA     MAIN_OLOOP

     1247    13145                                                /**/
     1248    13146                                                /**/
     1249    13147        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:156  
     1250    13148        /*I*      NAME: TIME_WARP$CHECK
     1251    13149                  PURPOSE: Checks radical time differences.
     1252    13150                  CALL: CALL TIME_WARP$CHECK;
     1253    13151                  DESCRIPTION: If an operator issues a TIME or DATE
     1254    13152                               keyin, GOOSE must check to
     1255    13153                               determine if the time change will
     1256    13154                               require a call to BUILD$TIME.
     1257    13155                                      */
     1258    13156    1   TIME_WARP$CHECK: PROC;

  13156 11 001650   200040 741300       TIME_WARP$C* STX1  ! XUG$+2,,AUTO

     1259    13157                                                /**/
     1260    13158    2        IF LAST_TIME = -1

  13158 11 001651   003175 220000 1                  LDX0    LAST_TIME
        11 001652   777777 100003                    CMPX0   -1,DU
        11 001653   001656 601000 11                 TNZ     s:13168

     1261    13159    2        THEN
     1262    13160    3          DO;

     1263    13161    3               TIME_DIFF = 0;

  13161 11 001654   000000 450000 xsym               STZ     TIME_DIFF

     1264    13162    3               RETURN;

  13162 11 001655   000001 702211                    TSX2  ! 1,X1

     1265    13163    3             END;
     1266    13164                                                /**/
     1267    13165                                      /* OUR_TIME_ESTIMATE represents
     1268    13166                                         (in minutes) where we think
     1269    13167                                         we should be. */
     1270    13168    2        OUR_TIME_ESTIMATE = (LAST_TIME * 60) + MAIN_WAIT.V.UNITS#;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:157  
  13168 11 001656   003175 236000 1                  LDQ     LAST_TIME
        11 001657   000022 732000                    QRS     18
        11 001660   000074 402007                    MPY     60,DL
        11 001661   004204 036000 1                  ADLQ    MAIN_WAIT+4
        11 001662   003216 756000 1                  STQ     OUR_TIME_ESTIMATE

     1271    13169                                                /**/
     1272    13170    2        CALL CHARBIN (TEMP_SEC, TEXT_TIME.SEC);

  13170 11 001663   000000 305400                    DTB
        11 001664   003554 030002 1                  NDSC9   TEXT_TIME+1              cn=0,s=nosgn,sf=0,n=2
        11 001665   000000 000004 xsym               NDSC9   TEMP_SEC                 cn=0,s=lsgnf,sf=0,n=4

     1273    13171    2        CURR_TIME_HOLD = TEMP_SEC + (CURR_TIME * 60);

  13171 11 001666   000443 236000 1                  LDQ     CURR_TIME
        11 001667   000074 402007                    MPY     60,DL
        11 001670   000000 036000 xsym               ADLQ    TEMP_SEC
        11 001671   000442 756000 1                  STQ     CURR_TIME_HOLD

     1274    13172                                                /**/
     1275    13173    2        CALL CHARBIN (TEMP_YEARS, TEXT_DATE.YR);

  13173 11 001672   000000 305400                    DTB
        11 001673   003550 030002 1                  NDSC9   TEXT_DATE                cn=0,s=nosgn,sf=0,n=2
        11 001674   000000 000004 xsym               NDSC9   TEMP_YEARS               cn=0,s=lsgnf,sf=0,n=4

     1276    13174    2        CALL CHARBIN (TEMP_MONTHS, TEXT_DATE.MON);

  13174 11 001675   000000 305400                    DTB
        11 001676   003550 430002 1                  NDSC9   TEXT_DATE                cn=2,s=nosgn,sf=0,n=2
        11 001677   000000 000004 xsym               NDSC9   TEMP_MONTHS              cn=0,s=lsgnf,sf=0,n=4

     1277    13175    2        CALL CHARBIN (TEMP_DAYS, TEXT_DATE.DAY);

  13175 11 001700   000000 305400                    DTB
        11 001701   003551 030002 1                  NDSC9   TEXT_DATE+1              cn=0,s=nosgn,sf=0,n=2
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:158  
        11 001702   000000 000004 xsym               NDSC9   TEMP_DAYS                cn=0,s=lsgnf,sf=0,n=4

     1278    13176    2        IF TEMP_YEARS >= 78                /* Range 1978 - 1999, 2000 - 20?? */

  13176 11 001703   000000 235000 xsym               LDA     TEMP_YEARS
        11 001704   000116 115007                    CMPA    78,DL
        11 001705   001711 604000 11                 TMI     s:13180

     1279    13177    2        THEN
     1280    13178    2             TEMP_YEARS = TEMP_YEARS + 1900;

  13178 11 001706   003554 236007                    LDQ     1900,DL
        11 001707   000000 056000 xsym               ASQ     TEMP_YEARS
        11 001710   001713 710000 11                 TRA     s:13181

     1281    13179    2        ELSE
     1282    13180    2             TEMP_YEARS = TEMP_YEARS + 2000;

  13180 11 001711   003720 236007                    LDQ     2000,DL
        11 001712   000000 056000 xsym               ASQ     TEMP_YEARS

     1283    13181    2        CALL IAM$LEAP;

  13181 11 001713   000002 631400 xsym               EPPR1   B_VECTNIL+2
        11 001714   000000 701000 xent               TSX1    IAM$LEAP
        11 001715   000000 011000                    NOP     0

     1284    13182    2        CALL IAM$CYCLE;

  13182 11 001716   000002 631400 xsym               EPPR1   B_VECTNIL+2
        11 001717   000000 701000 xent               TSX1    IAM$CYCLE
        11 001720   000000 011000                    NOP     0

     1285    13183    2        CYCLE_DAYS_CURRENT = TOTAL_DAYS;

  13183 11 001721   000000 235000 xsym               LDA     TOTAL_DAYS
        11 001722   000000 755000 xsym               STA     CYCLE_DAYS_CURRENT
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:159  

     1286    13184                                                /**/
     1287    13185    2        CALL CHARBIN (TEMP_YEARS, LAST_DATE.YR);

  13185 11 001723   000000 305400                    DTB
        11 001724   003172 030002 1                  NDSC9   LAST_DATE                cn=0,s=nosgn,sf=0,n=2
        11 001725   000000 000004 xsym               NDSC9   TEMP_YEARS               cn=0,s=lsgnf,sf=0,n=4

     1288    13186    2        CALL CHARBIN (TEMP_MONTHS, LAST_DATE.MON);

  13186 11 001726   000000 305400                    DTB
        11 001727   003172 430002 1                  NDSC9   LAST_DATE                cn=2,s=nosgn,sf=0,n=2
        11 001730   000000 000004 xsym               NDSC9   TEMP_MONTHS              cn=0,s=lsgnf,sf=0,n=4

     1289    13187    2        CALL CHARBIN (TEMP_DAYS, LAST_DATE.DAY);

  13187 11 001731   000000 305400                    DTB
        11 001732   003173 030002 1                  NDSC9   LAST_DATE+1              cn=0,s=nosgn,sf=0,n=2
        11 001733   000000 000004 xsym               NDSC9   TEMP_DAYS                cn=0,s=lsgnf,sf=0,n=4

     1290    13188    2        IF TEMP_YEARS >= 78                /* Range 1978 - 1999, 2000 - 20?? */

  13188 11 001734   000000 236000 xsym               LDQ     TEMP_YEARS
        11 001735   000116 116007                    CMPQ    78,DL
        11 001736   001742 604000 11                 TMI     s:13192

     1291    13189    2        THEN
     1292    13190    2             TEMP_YEARS = TEMP_YEARS + 1900;

  13190 11 001737   003554 236007                    LDQ     1900,DL
        11 001740   000000 056000 xsym               ASQ     TEMP_YEARS
        11 001741   001744 710000 11                 TRA     s:13193

     1293    13191    2        ELSE
     1294    13192    2             TEMP_YEARS = TEMP_YEARS + 2000;

  13192 11 001742   003720 236007                    LDQ     2000,DL
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:160  
        11 001743   000000 056000 xsym               ASQ     TEMP_YEARS

     1295    13193    2        CALL IAM$LEAP;

  13193 11 001744   000002 631400 xsym               EPPR1   B_VECTNIL+2
        11 001745   000000 701000 xent               TSX1    IAM$LEAP
        11 001746   000000 011000                    NOP     0

     1296    13194    2        CALL IAM$CYCLE;

  13194 11 001747   000002 631400 xsym               EPPR1   B_VECTNIL+2
        11 001750   000000 701000 xent               TSX1    IAM$CYCLE
        11 001751   000000 011000                    NOP     0

     1297    13195    2        CYCLE_DAYS_LAST = TOTAL_DAYS;

  13195 11 001752   000000 235000 xsym               LDA     TOTAL_DAYS
        11 001753   000000 755000 xsym               STA     CYCLE_DAYS_LAST

     1298    13196                                                /**/
     1299    13197    2        IF CYCLE_DAYS_LAST = CYCLE_DAYS_CURRENT

  13197 11 001754   000000 236000 xsym               LDQ     CYCLE_DAYS_LAST
        11 001755   000000 116000 xsym               CMPQ    CYCLE_DAYS_CURRENT
        11 001756   001771 601000 11                 TNZ     s:13212

     1300    13198    2        THEN
     1301    13199    3          DO;

     1302    13200    3               IF CURR_TIME_HOLD < OUR_TIME_ESTIMATE

  13200 11 001757   000442 236000 1                  LDQ     CURR_TIME_HOLD
        11 001760   003216 116000 1                  CMPQ    OUR_TIME_ESTIMATE
        11 001761   001766 603000 11                 TRC     s:13207

     1303    13201    3               THEN
     1304    13202    4                 DO;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:161  

     1305    13203    4                      TIME_DIFF = OUR_TIME_ESTIMATE - CURR_TIME_HOLD;

  13203 11 001762   003216 236000 1                  LDQ     OUR_TIME_ESTIMATE
        11 001763   000442 136000 1                  SBLQ    CURR_TIME_HOLD
        11 001764   000000 756000 xsym               STQ     TIME_DIFF

     1306    13204    4                    END;

  13204 11 001765   002016 710000 11                 TRA     s:13227

     1307    13205    3               ELSE
     1308    13206    4                 DO;

     1309    13207    4                      TIME_DIFF = CURR_TIME_HOLD - OUR_TIME_ESTIMATE;

  13207 11 001766   003216 136000 1                  SBLQ    OUR_TIME_ESTIMATE
        11 001767   000000 756000 xsym               STQ     TIME_DIFF

     1310    13208    4                    END;

     1311    13209    3             END;

  13209 11 001770   002016 710000 11                 TRA     s:13227

     1312    13210    2        ELSE
     1313    13211    3          DO;

     1314    13212    3               IF CYCLE_DAYS_LAST < CYCLE_DAYS_CURRENT

  13212 11 001771   002005 603000 11                 TRC     s:13221

     1315    13213    3               THEN
     1316    13214    4                 DO;

     1317    13215    4                      TIME_DIFF = ((1440 * 60) - OUR_TIME_ESTIMATE)

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:162  
  13215 11 001772   000000 236000 xsym               LDQ     CYCLE_DAYS_CURRENT
        11 001773   000000 136000 xsym               SBLQ    CYCLE_DAYS_LAST
        11 001774   200116 756100                    STQ     CONV_CURRENT+1,,AUTO
        11 001775   000442 236000 1                  LDQ     CURR_TIME_HOLD
        11 001776   003216 136000 1                  SBLQ    OUR_TIME_ESTIMATE
        11 001777   200117 756100                    STQ     CONV_CURRENT+2,,AUTO
        11 002000   200116 236100                    LDQ     CONV_CURRENT+1,,AUTO
        11 002001   250600 402007                    MPY     86400,DL
        11 002002   200117 036100                    ADLQ    CONV_CURRENT+2,,AUTO
        11 002003   000000 756000 xsym               STQ     TIME_DIFF

     1318    13216    4                           + CURR_TIME_HOLD
     1319    13217    4                          + (((CYCLE_DAYS_CURRENT - CYCLE_DAYS_LAST) - 1) * (1440 * 60
             13217                                    ));
     1320    13218    4                    END;

  13218 11 002004   002016 710000 11                 TRA     s:13227

     1321    13219    3               ELSE
     1322    13220    4                 DO;

     1323    13221    4                      TIME_DIFF = ((1440 * 60) - CURR_TIME_HOLD)

  13221 11 002005   000000 136000 xsym               SBLQ    CYCLE_DAYS_CURRENT
        11 002006   200116 756100                    STQ     CONV_CURRENT+1,,AUTO
        11 002007   003216 236000 1                  LDQ     OUR_TIME_ESTIMATE
        11 002010   000442 136000 1                  SBLQ    CURR_TIME_HOLD
        11 002011   200117 756100                    STQ     CONV_CURRENT+2,,AUTO
        11 002012   200116 236100                    LDQ     CONV_CURRENT+1,,AUTO
        11 002013   250600 402007                    MPY     86400,DL
        11 002014   200117 036100                    ADLQ    CONV_CURRENT+2,,AUTO
        11 002015   000000 756000 xsym               STQ     TIME_DIFF

     1324    13222    4                           + OUR_TIME_ESTIMATE
     1325    13223    4                          + (((CYCLE_DAYS_LAST - CYCLE_DAYS_CURRENT) - 1) * (1440 * 60
             13223                                    ));
     1326    13224    4                    END;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:163  

     1327    13225    3             END;

     1328    13226                                                /**/
     1329    13227    2   END TIME_WARP$CHECK;

  13227 11 002016   200040 221300                    LDX1  ! XUG$+2,,AUTO
        11 002017   000001 702211                    TSX2  ! 1,X1

     1330    13228        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:164  
     1331    13229        /*I*      NAME: CHECK$TIME
     1332    13230                  PURPOSE: Checks the time table to see if there is anything to be done.
     1333    13231                  CALL: CALL CHECK$TIME(TIME);
     1334    13232                  DATA: TIME is the time to check in minutes since  midnight
     1335    13233                  DESCRIPTION: This routine will go through the time table
     1336    13234                                 checking each entry to see if it is time
     1337    13235                                 to do it. If it is time it will call DO$COMMAND
     1338    13236                                 to actually do it and then delink the entry.
     1339    13237                             */
     1340    13238    1   CHECK$TIME: PROC(TIME);                      /* Routine to check entries

  13238 11 002020   200040 741300       CHECK$TIME   STX1  ! XUG$+2,,AUTO

     1341    13239                                                        to see if is their time */
     1342    13240    2   DCL TIME UBIN WORD;                     /* Time to check against */
     1343    13241                                                /**/
     1344    13242    2        TIME_ENTRY$ = TIME_HEAD$;          /* Point entry to current */

  13242 11 002021   003556 236000 1                  LDQ     TIME_HEAD$
        11 002022   003555 756000 1                  STQ     TIME_ENTRY$

     1345    13243    2        IF TIME_ENTRY$ = ADDR(NIL)         /* No time yet */

  13243 11 002023   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 002024   002026 601000 11                 TNZ     s:13246

     1346    13244    2        THEN
     1347    13245    2             RETURN;

  13245 11 002025   000001 702211                    TSX2  ! 1,X1

     1348    13246    3        DO WHILE (TIME_ENTRY$ ~= ADDR(NIL)); /* Do until end of chain */

  13246 11 002026   002073 710000 11                 TRA     s:13259

     1349    13247    3             IF TIME_TABLE.TIME <= TIME    /* Time to do it */

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:165  
  13247 11 002027   200041 470500                    LDP0    @TIME,,AUTO
        11 002030   003555 471400 1                  LDP1    TIME_ENTRY$
        11 002031   100000 236100                    LDQ     0,,PR1
        11 002032   000022 772000                    QRL     18
        11 002033   000000 116100                    CMPQ    0,,PR0
        11 002034   002036 600000 11                 TZE     s:13250
        11 002035   002071 603000 11                 TRC     s:13258

     1350    13248    3             THEN
     1351    13249    4               DO;

     1352    13250    4                    IF GOOSE_ON

  13250 11 002036   002561 234000 1                  SZN     GOOSE_ON
        11 002037   002064 605000 11                 TPL     s:13254

     1353    13251    4                    THEN
     1354    13252    4                         CALL DO$COMMAND (TIME_TABLE.GHOST_FID,TIME_TABLE.COMMAND,

  13252 11 002040   003555 236000 1                  LDQ     TIME_ENTRY$
        11 002041   000010 036003                    ADLQ    8,DU
        11 002042   200050 756100                    STQ     @ACCOUNT+1,,AUTO
        11 002043   003555 236000 1                  LDQ     TIME_ENTRY$
        11 002044   000006 036003                    ADLQ    6,DU
        11 002045   200047 756100                    STQ     @SIZE+1,,AUTO
        11 002046   003555 236000 1                  LDQ     TIME_ENTRY$
        11 002047   000063 036000 12                 ADLQ    51
        11 002050   200046 756100                    STQ     @TYPE+1,,AUTO
        11 002051   003555 236000 1                  LDQ     TIME_ENTRY$
        11 002052   000012 036003                    ADLQ    10,DU
        11 002053   200045 756100                    STQ     @COMMAND+1,,AUTO
        11 002054   003555 236000 1                  LDQ     TIME_ENTRY$
        11 002055   000064 036000 12                 ADLQ    52
        11 002056   200044 756100                    STQ     @FID+1,,AUTO
        11 002057   003555 236000 1                  LDQ     TIME_ENTRY$
        11 002060   000001 036003                    ADLQ    1,DU
        11 002061   200043 756100                    STQ     J+1,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:166  
        11 002062   005106 701000 11                 TSX1    DO$COMMAND
        11 002063   000000 011000                    NOP     0

     1355    13253    4                              TIME_TABLE.TYPE,TIME_TABLE.SIZE,TIME_TABLE.ACCT,
             13253                                       TIME_TABLE.PASS);
     1356    13254    4                    TIME_HEAD$ = TIME_TABLE.NEXT$; /* Clear entry */

  13254 11 002064   003555 470400 1                  LDP0    TIME_ENTRY$
        11 002065   000113 236100                    LDQ     75,,PR0
        11 002066   003556 756000 1                  STQ     TIME_HEAD$

     1357    13255    4                    TIME_ENTRY$ = TIME_HEAD$;

  13255 11 002067   003555 756000 1                  STQ     TIME_ENTRY$

     1358    13256    4                  END;                     /* End time to do */

  13256 11 002070   002073 710000 11                 TRA     s:13259

     1359    13257    3             ELSE
     1360    13258    3                  RETURN;                  /* All done */

  13258 11 002071   200040 221300                    LDX1  ! XUG$+2,,AUTO
        11 002072   000001 702211                    TSX2  ! 1,X1

     1361    13259    3           END;                            /* End forever */

  13259 11 002073   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 002074   002027 601000 11                 TNZ     s:13247

     1362    13260    2   END CHECK$TIME;

  13260 11 002075   200040 221300                    LDX1  ! XUG$+2,,AUTO
        11 002076   000001 702211                    TSX2  ! 1,X1

     1363    13261        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:167  
     1364    13262        /*I*      NAME: BUILD$TIME
     1365    13263                  PURPOSE: Builds the time table
     1366    13264                  CALL: CALL BUILD$TIME
     1367    13265                  DESCRIPTION: This routine opens the GOOSE_EGG file and
     1368    13266                                then calls XUG$INIT, and PARSE$COMMAND.
     1369    13267                                PARSE$COMMAND calls XUG$GETCMD to read
     1370    13268                                and parse the commands in the GOOSE_EGG.
     1371    13269                                It also sets the 'DO_ ' variables used
     1372    13270                                here and elsewhere.  Upon return from
     1373    13271                               PARSE$COMMAND, this routine calls MAKE$ENTRY
     1374    13272                               with the times that the current command
     1375    13273                               is to be executed.  Upon altreturn from
     1376    13274                               PARSE$COMMAND this routine checks the error.
     1377    13275                               If the error was EOF it quits.  If the
     1378    13276                               error was a syntax error, it continues
     1379    13277                               processing.  Any other error causes the
     1380    13278                               GOOSE_EGG to be closed and a return to
     1381    13279                               be taken.
     1382    13280                                 */
     1383    13281    1   BUILD$TIME: PROC;             /* Routine to build the internal time table */

  13281 11 002077   200040 741300       BUILD$TIME   STX1  ! XUG$+2,,AUTO

     1384    13282                                                /**/
     1385    13283    2   DCL I SBIN WORD;
     1386    13284    2   DCL J SBIN WORD;
     1387    13285    2   DCL TIME SBIN WORD;
     1388    13286    2   DCL DUMP_TABLE BIT(1);
     1389    13287    2   DCL TEMP_TIME  CHAR(6);
     1390    13288    2   DCL OUTBUF     CHAR(80);
     1391    13289    2   DCL BUF_START  SBIN;
     1392    13290    2   DCL NO_GHOST   CHAR(12)  CONSTANT INIT ('NO GHOST FID');
     1393    13291
     1394    13292        %FPT_OPEN (FPTN = GOOSE_TABLE_OPEN,
     1395    13293                   DCB  = M$TABLE,
     1396    13294                   CTG  = YES,
     1397    13295                   NAME = GOOSE_TABLE,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:168  
     1398    13296                   FUN  = CREATE,
     1399    13297                   DISP = NAMED,
     1400    13298                   ORG  = CONSEC,
     1401    13299                   ACS  = SEQUEN,
     1402    13300                   ACCT = SYSACCT,
     1403    13301                   ASN  = FILE,
     1404    13302                   EXIST= NEWFILE);
     1405    13411
     1406    13412        %FPT_CLOSE (FPTN = GOOSE_TABLE_CLOSE,
     1407    13413                    DCB  = M$TABLE,
     1408    13414                    NAME = GOOSE_TABLE);
     1409    13456
     1410    13457        %FPT_WRITE (FPTN = GOOSE_TABLE_WRITE,
     1411    13458                    DCB  = M$TABLE);
     1412    13489
     1413    13490        %VLP_NAME (FPTN = GOOSE_TABLE,
     1414    13491                   NAME = 'GOOSE_TABLE');
     1415    13518
     1416    13519                                                /**/
     1417    13520                                                /**/
     1418    13521    2        DUMP_TABLE = %NO#;

  13521 11 002100   200044 450100                    STZ     DUMP_TABLE,,AUTO

     1419    13522    2        TIME_HEAD$ = ADDR(NIL);

  13522 11 002101   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 002102   003556 756000 1                  STQ     TIME_HEAD$

     1420    13523    2        FREE_DATA.V.SEGSIZE# = (SEG_VLP.W1.VSIZE# + 1 ) / 4;

  13523 11 002103   003576 236000 1                  LDQ     SEG_VLP
        11 002104   000020 772000                    QRL     16
        11 002105   000001 036007                    ADLQ    1,DL
        11 002106   000002 772000                    QRL     2
        11 002107   000000 620006                    EAX0    0,QL
        11 002110   003574 440000 1                  SXL0    FREE_DATA+4
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:169  

     1421    13524    2        CALL M$FDS (FREE_DATA) ;           /* Free data */

  13524 11 002111   003570 630400 1                  EPPR0   FREE_DATA
        11 002112   030002 713400                    CLIMB   fds
        11 002113   400400 401760                    pmme    nvectors=2

  13523 11 002114                       TRY_OPEN     null
     1422    13525    2   TRY_OPEN:;
     1423    13526    2        CALL M$OPEN (OPEN_S)               /* Open schedule */

  13526 11 002114   003740 630400 1                  EPPR0   OPEN_S
        11 002115   450000 713400                    CLIMB   alt,open
        11 002116   410400 401760                    pmme    nvectors=18
        11 002117   002121 702000 11                 TSX2    s:13528
        11 002120   002174 710000 11                 TRA     s:13551

     1424    13527    3        WHENALTRETURN DO;

     1425    13528    3               ERROR = %SYSTEM_ERROR;

  13528 11 002121   000000 470400 xsym               LDP0    B$TCB$
        11 002122   000000 471500                    LDP1    0,,PR0
        11 002123   100102 236100                    LDQ     66,,PR1
        11 002124   004132 756000 1                  STQ     ERROR

     1426    13529    3               IF ERROR.ERR# = %E$FILEBUSY /* Someone is updating it */

  13529 11 002125   004132 236000 1                  LDQ     ERROR
        11 002126   377770 376007                    ANQ     131064,DL
        11 002127   001550 116007                    CMPQ    872,DL
        11 002130   002135 601000 11                 TNZ     s:13534

     1427    13530    4               THEN DO;

     1428    13531    4                      CALL M$WAIT(FIVE_SECOND);

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:170  
  13531 11 002131   004206 630400 1                  EPPR0   FIVE_SECOND
        11 002132   020006 713400                    CLIMB   8198
        11 002133   400400 401760                    pmme    nvectors=2

     1429    13532    4                      GOTO TRY_OPEN;

  13532 11 002134   002114 710000 11                 TRA     TRY_OPEN

     1430    13533    4                    END;                   /*  Error = file busy  */
     1431    13534    3               IF ERROR.ERR# = %E$NOFILE   /* File does not exist */

  13534 11 002135   001610 116007                    CMPQ    904,DL
        11 002136   002166 601000 11                 TNZ     s:13548

     1432    13535    4               THEN DO;

     1433    13536    4                      CALL M$SPRIV (RESET_FMSEC);

  13536 11 002137   005606 630400 1                  EPPR0   RESET_FMSEC
        11 002140   020012 713400                    CLIMB   8202
        11 002141   400000 401760                    pmme    nvectors=1

     1434    13537    4                      CALL M$OPEN(CREATE_EGG)

  13537 11 002142   003632 630400 1                  EPPR0   CREATE_EGG
        11 002143   450000 713400                    CLIMB   alt,open
        11 002144   410400 401760                    pmme    nvectors=18
        11 002145   002157 702000 11                 TSX2    s:13545

     1435    13538    5                      WHENRETURN DO;

     1436    13539    5                             CALL M$RPRIV (RESET_FMSEC);

  13539 11 002146   005606 630400 1                  EPPR0   RESET_FMSEC
        11 002147   020013 713400                    CLIMB   8203
        11 002150   400000 401760                    pmme    nvectors=1

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:171  
     1437    13540    5                             CALL M$CLOSE(CLOSE_S)

  13540 11 002151   004074 630400 1                  EPPR0   CLOSE_S
        11 002152   450001 713400                    CLIMB   alt,close
        11 002153   406000 401760                    pmme    nvectors=13
        11 002154   002157 702000 11                 TSX2    s:13545

     1438    13541    6                             WHENRETURN DO;

     1439    13542    6                                    CALL M$RETRY; /* Should work now */

  13542 11 002155   010010 713400                    CLIMB   4104
        11 002156   000000 401760                    pmme    nvectors=0

     1440    13543    6                                  END;     /*  Whenreturn on M$CLOSE  */

     1441    13544    5                           END;            /*  Whenreturn on M$OPEN (2)  */

     1442    13545    4                      CALL M$RPRIV (RESET_FMSEC);

  13545 11 002157   005606 630400 1                  EPPR0   RESET_FMSEC
        11 002160   020013 713400                    CLIMB   8203
        11 002161   400000 401760                    pmme    nvectors=1

     1443    13546    4                      ERROR = %SYSTEM_ERROR;

  13546 11 002162   000000 470400 xsym               LDP0    B$TCB$
        11 002163   000000 471500                    LDP1    0,,PR0
        11 002164   100102 236100                    LDQ     66,,PR1
        11 002165   004132 756000 1                  STQ     ERROR

     1444    13547    4                    END;                   /*  Error = nofile  */

     1445    13548    3               CALL IAE$CSCG_ERROR (%IA_KEY_EGG_ERR#, ERROR);

  13548 11 002166   000065 630400 12                 EPPR0   53
        11 002167   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:172  
        11 002170   000000 701000 xent               TSX1    IAE$CSCG_ERROR
        11 002171   000000 011000                    NOP     0

     1446    13549    3               CALL M$XXX;

  13549 11 002172   000003 713400                    CLIMB   3
        11 002173   000000 401760                    pmme    nvectors=0

     1447    13550    3             END;                          /*  Whenaltreturn on M$OPEN  */

     1448    13551    2        PTR$ = ADDR(FPARAM);

  13551 11 002174   000003 236000 12                 LDQ     3
        11 002175   200033 756100                    STQ     PTR$,,AUTO

     1449    13552    2        CALL XSF$LOCCODP(PTR$,4)

  13552 11 002176   000004 236000 12                 LDQ     4
        11 002177   200117 756100                    STQ     CONV_CURRENT+2,,AUTO
        11 002200   200033 630500                    EPPR0   PTR$,,AUTO
        11 002201   200116 450500                    STP0    CONV_CURRENT+1,,AUTO
        11 002202   200116 630500                    EPPR0   CONV_CURRENT+1,,AUTO
        11 002203   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 002204   000000 701000 xent               TSX1    XSF$LOCCODP
        11 002205   002211 702000 11                 TSX2    s:13556

     1450    13553    3        WHENRETURN DO;

     1451    13554    3               MODIFY_DATE = PTR$ -> CODE04.MODIFY.TIME;

  13554 11 002206   200033 470500                    LDP0    PTR$,,AUTO
        11 002207   000001 235100                    LDA     1,,PR0
        11 002210   200032 755100                    STA     MODIFY_DATE,,AUTO

     1452    13555    3             END;                          /*  Whenreturn on XSF$LOCCODP  */

     1453    13556    2        CALL XUG$INIT (EGG_GETCMD,GHOST_INIT)
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:173  

  13556 11 002211   000067 630400 12                 EPPR0   55
        11 002212   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 002213   000000 701000 xent               TSX1    XUG$INIT
        11 002214   002216 702000 11                 TSX2    s:13558
        11 002215   002224 710000 11                 TRA     s:13562

     1454    13557    3        WHENALTRETURN DO;

     1455    13558    3               CALL IAE$CSCG_ERROR (%IA_KEY_EGG_ERR#,EGG_GETCMD.ERR#);

  13558 11 002216   000071 630400 12                 EPPR0   57
        11 002217   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 002220   000000 701000 xent               TSX1    IAE$CSCG_ERROR
        11 002221   000000 011000                    NOP     0

     1456    13559    3               CALL M$XXX;

  13559 11 002222   000003 713400                    CLIMB   3
        11 002223   000000 401760                    pmme    nvectors=0

     1457    13560    3             END;                          /*  Whenaltreturn on XUG$INIT  */

     1458    13561
     1459    13562    2        EGG_GETCMD.INDCB# = DCBNUM (M$SCHED);

  13562 11 002224   000000 236007 xsym               LDQ     M$SCHED,DL
        11 002225   000240 756000 1                  STQ     EGG_GETCMD+10

     1460    13563
     1461    13564    2   PARSE_COMMANDS:
     1462    13565    3        DO WHILE (%YES#);                  /* parse commands until error */

  13565 11 002226                       PARSE_COMMA* null
     1463    13566
     1464    13567    3             CALL PARSE$COMMAND

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:174  
  13567 11 002226   003050 701000 11                 TSX1    PARSE$COMMAND
        11 002227   002574 702000 11                 TSX2    s:13663

     1465    13568    4             WHENRETURN DO;

     1466    13569    4                    IF DO_TYPE = %IA_CMD_TESTMODE# THEN

  13569 11 002230   200024 236100                    LDQ     DO_TYPE,,AUTO
        11 002231   777000 376003                    ANQ     -512,DU
        11 002232   004000 116003                    CMPQ    2048,DU
        11 002233   002237 601000 11                 TNZ     s:13572

     1467    13570    4                         DUMP_TABLE = %YES#;

  13570 11 002234   400000 236003                    LDQ     -131072,DU
        11 002235   200044 756100                    STQ     DUMP_TABLE,,AUTO
        11 002236   002573 710000 11                 TRA     s:13660

     1468    13571    5                    ELSE DO;

     1469    13572    5                           IF DO_EVERY = -1 AND DO_UMIN = -1 /* Must be startup */

  13572 11 002237   200012 235100                    LDA     DO_EVERY,,AUTO
        11 002240   000027 115000 xsym               CMPA    B_VECTNIL+23
        11 002241   002313 601000 11                 TNZ     s:13599
        11 002242   200025 235100                    LDA     DO_UMIN,,AUTO
        11 002243   000027 115000 xsym               CMPA    B_VECTNIL+23
        11 002244   002313 601000 11                 TNZ     s:13599

     1470    13573    5                           THEN
     1471    13574    5                                IF NUM_DAYS = 0

  13574 11 002245   003214 235000 1                  LDA     NUM_DAYS
        11 002246   002311 601000 11                 TNZ     s:13596

     1472    13575    5                                THEN
     1473    13576    6                                  DO;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:175  

     1474    13577    6                                       DO_HOUR = START_TIME / 60;

  13577 11 002247   003544 236000 1                  LDQ     START_TIME
        11 002250   000074 506007                    DIV     60,DL
        11 002251   200021 756100                    STQ     DO_HOUR,,AUTO

     1475    13578    6                                       DO_TMIN = MOD(START_TIME,60) / 10;
             13578                                                /* Ten minutes */

  13578 11 002252   003544 236000 1                  LDQ     START_TIME
        11 002253   000074 506007                    DIV     60,DL
        11 002254   000044 733000                    LRS     36
        11 002255   000012 506007                    DIV     10,DL
        11 002256   200023 756100                    STQ     DO_TMIN,,AUTO

     1476    13579    6                                       DO_UMIN = START_TIME - DO_HOUR * 60 - DO_TMIN *
             13579                                                10; /* Units */

  13579 11 002257   000000 236003                    LDQ     0,DU
        11 002260   200021 136100                    SBLQ    DO_HOUR,,AUTO
        11 002261   000074 402007                    MPY     60,DL
        11 002262   003544 036000 1                  ADLQ    START_TIME
        11 002263   200116 756100                    STQ     CONV_CURRENT+1,,AUTO
        11 002264   000000 236003                    LDQ     0,DU
        11 002265   200023 136100                    SBLQ    DO_TMIN,,AUTO
        11 002266   000012 402007                    MPY     10,DL
        11 002267   200116 036100                    ADLQ    CONV_CURRENT+1,,AUTO
        11 002270   200025 756100                    STQ     DO_UMIN,,AUTO

     1477    13580    6                                       IF TIME_WARP AND (DO_OFFSET > 0)

  13580 11 002271   003560 234000 1                  SZN     TIME_WARP
        11 002272   002304 605000 11                 TPL     s:13588
        11 002273   200022 235100                    LDA     DO_OFFSET,,AUTO
        11 002274   002304 604400 11                 TMOZ    s:13588
        11 002275   000557 236000 1                  LDQ     ELAPSED_MINS
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:176  
        11 002276   200022 116100                    CMPQ    DO_OFFSET,,AUTO
        11 002277   002304 605400 11                 TPNZ    s:13588

     1478    13581    6                                            AND (ELAPSED_MINS <= DO_OFFSET)
     1479    13582    6                                       THEN
     1480    13583    7                                         DO;

     1481    13584    7                                              DO_OFFSET = DO_OFFSET - ELAPSED_MINS;

  13584 11 002300   200022 236100                    LDQ     DO_OFFSET,,AUTO
        11 002301   000557 136000 1                  SBLQ    ELAPSED_MINS
        11 002302   200022 756100                    STQ     DO_OFFSET,,AUTO

     1482    13585    7                                            END;

  13585 11 002303   002313 710000 11                 TRA     s:13599

     1483    13586    6                                       ELSE
     1484    13587    7                                         DO;

     1485    13588    7                                              IF TIME_WARP

  13588 11 002304   003560 234000 1                  SZN     TIME_WARP
        11 002305   002313 605000 11                 TPL     s:13599

     1486    13589    7                                              THEN
     1487    13590    8                                                DO;

     1488    13591    8                                                     DO_DAY (0) = 'NEV';

  13591 11 002306   000020 236000 10                 LDQ     NO_GHOST+10
        11 002307   200004 552170                    STBQ    DO_DAY,'70'O,AUTO

     1489    13592    8                                                   END;

     1490    13593    7                                            END;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:177  
     1491    13594    6                                     END;

  13594 11 002310   002313 710000 11                 TRA     s:13599

     1492    13595    5                                ELSE
     1493    13596    5                                     DO_DAY (0) = 'NEV';
             13596                                              /* Prevents startup on all other days */

  13596 11 002311   000020 236000 10                 LDQ     NO_GHOST+10
        11 002312   200004 552170                    STBQ    DO_DAY,'70'O,AUTO

     1494    13597                                                /**/
     1495    13598                                                /**/
     1496    13599    5                           IF DO_FROM = -1 AND (DO_DAY(0) ~= '  ' OR DO_DATE.MM ~= '?'

  13599 11 002313   200020 235100                    LDA     DO_FROM,,AUTO
        11 002314   000027 115000 xsym               CMPA    B_VECTNIL+23
        11 002315   002334 601000 11                 TNZ     s:13605
        11 002316   040000 106500                    CMPC    fill='040'O
        11 002317   200004 000003                    ADSC9   DO_DAY,,AUTO             cn=0,n=3
        11 002320   000015 000002 10                 ADSC9   NO_GHOST+7               cn=0,n=2
        11 002321   002333 601000 11                 TNZ     s:13602
        11 002322   000546 720000 1                  LXL0    DO_DATE
        11 002323   077040 100003                    CMPX0   32288,DU
        11 002324   002333 601000 11                 TNZ     s:13602
        11 002325   000550 221000 1                  LDX1    DO_DATE+2
        11 002326   077040 101003                    CMPX1   32288,DU
        11 002327   002333 601000 11                 TNZ     s:13602
        11 002330   000546 222000 1                  LDX2    DO_DATE
        11 002331   077040 102003                    CMPX2   32288,DU
        11 002332   002334 600000 11                 TZE     s:13605

     1497    13600    5                                OR DO_DATE.DD ~= '?' OR DO_DATE.YY ~= '?')
     1498    13601    5                           THEN            /* Day or date specified */
     1499    13602    5                                DO_FROM = 0; /* Interval from midnight */

  13602 11 002333   200020 450100                    STZ     DO_FROM,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:178  

     1500    13603                                                /**/
     1501    13604                                                /**/
     1502    13605    5                           IF (DO_DATE.MM = '?' OR DO_DATE.MM = TEXT_DATE.MON) AND

  13605 11 002334   000546 720000 1                  LXL0    DO_DATE
        11 002335   077040 100003                    CMPX0   32288,DU
        11 002336   002343 600000 11                 TZE     s:13605+7
        11 002337   000546 236000 1                  LDQ     DO_DATE
        11 002340   003550 676000 1                  ERQ     TEXT_DATE
        11 002341   777777 376007                    ANQ     -1,DL
        11 002342   002573 601000 11                 TNZ     s:13660
        11 002343   000550 221000 1                  LDX1    DO_DATE+2
        11 002344   077040 101003                    CMPX1   32288,DU
        11 002345   002350 600000 11                 TZE     s:13605+12
        11 002346   003551 101000 1                  CMPX1   TEXT_DATE+1
        11 002347   002573 601000 11                 TNZ     s:13660
        11 002350   000546 222000 1                  LDX2    DO_DATE
        11 002351   077040 102003                    CMPX2   32288,DU
        11 002352   002355 600000 11                 TZE     s:13605+17
        11 002353   003550 102000 1                  CMPX2   TEXT_DATE
        11 002354   002573 601000 11                 TNZ     s:13660
        11 002355   200004 236100                    LDQ     DO_DAY,,AUTO
        11 002356   000015 676000 10                 ERQ     NO_GHOST+7
        11 002357   000073 376000 12                 ANQ     59
        11 002360   002415 600000 11                 TZE     s:13605+49
        11 002361   200004 236100                    LDQ     DO_DAY,,AUTO
        11 002362   003552 676000 1                  ERQ     TEXT_DAY
        11 002363   000073 376000 12                 ANQ     59
        11 002364   002415 600000 11                 TZE     s:13605+49
        11 002365   040000 106500                    CMPC    fill='040'O
        11 002366   200004 600003                    ADSC9   DO_DAY,,AUTO             cn=3,n=3
        11 002367   003552 000003 1                  ADSC9   TEXT_DAY                 cn=0,n=3
        11 002370   002415 600000 11                 TZE     s:13605+49
        11 002371   040000 106500                    CMPC    fill='040'O
        11 002372   200005 400003                    ADSC9   DO_DAY+1,,AUTO           cn=2,n=3
        11 002373   003552 000003 1                  ADSC9   TEXT_DAY                 cn=0,n=3
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:179  
        11 002374   002415 600000 11                 TZE     s:13605+49
        11 002375   040000 106500                    CMPC    fill='040'O
        11 002376   200006 200003                    ADSC9   DO_DAY+2,,AUTO           cn=1,n=3
        11 002377   003552 000003 1                  ADSC9   TEXT_DAY                 cn=0,n=3
        11 002400   002415 600000 11                 TZE     s:13605+49
        11 002401   200007 236100                    LDQ     DO_DAY+3,,AUTO
        11 002402   003552 676000 1                  ERQ     TEXT_DAY
        11 002403   000073 376000 12                 ANQ     59
        11 002404   002415 600000 11                 TZE     s:13605+49
        11 002405   040000 106500                    CMPC    fill='040'O
        11 002406   200007 600003                    ADSC9   DO_DAY+3,,AUTO           cn=3,n=3
        11 002407   003552 000003 1                  ADSC9   TEXT_DAY                 cn=0,n=3
        11 002410   002415 600000 11                 TZE     s:13605+49
        11 002411   040000 106500                    CMPC    fill='040'O
        11 002412   200010 400003                    ADSC9   DO_DAY+4,,AUTO           cn=2,n=3
        11 002413   003552 000003 1                  ADSC9   TEXT_DAY                 cn=0,n=3
        11 002414   002573 601000 11                 TNZ     s:13660
        11 002415   200004 236100                    LDQ     DO_DAY,,AUTO
        11 002416   000020 676000 10                 ERQ     NO_GHOST+10
        11 002417   000073 376000 12                 ANQ     59
        11 002420   002573 600000 11                 TZE     s:13660

     1503    13606    5                                (DO_DATE.DD = '?' OR DO_DATE.DD = TEXT_DATE.DAY) AND
     1504    13607    5                                (DO_DATE.YY = '?' OR DO_DATE.YY = TEXT_DATE.YR) AND
     1505    13608    5                                (DO_DAY(0) = '   ' OR
     1506    13609    5                                DO_DAY(0) = TEXT_DAY OR DO_DAY(1) = TEXT_DAY OR
     1507    13610    5                                DO_DAY(2) = TEXT_DAY OR DO_DAY(3) = TEXT_DAY OR
     1508    13611    5                                DO_DAY(4) = TEXT_DAY OR DO_DAY(5) = TEXT_DAY OR
     1509    13612    5                                DO_DAY(6) = TEXT_DAY)
     1510    13613    5                                AND (DO_DAY(0) ~= 'NEV')
     1511    13614    5                           THEN
     1512    13615    5                                IF DO_EVERY = -1

  13615 11 002421   200012 235100                    LDA     DO_EVERY,,AUTO
        11 002422   000027 115000 xsym               CMPA    B_VECTNIL+23
        11 002423   002533 601000 11                 TNZ     s:13644

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:180  
     1513    13616    5                                THEN
     1514    13617    5                                     IF DO_HOUR = -1

  13617 11 002424   200021 236100                    LDQ     DO_HOUR,,AUTO
        11 002425   000027 116000 xsym               CMPQ    B_VECTNIL+23
        11 002426   002475 601000 11                 TNZ     s:13633

     1515    13618    5                                     THEN
     1516    13619    6                                       DO I = CURR_TIME / 60 TO 23;
             13619                                                /* Make entry  for every hour */

  13619 11 002427   000443 236000 1                  LDQ     CURR_TIME
        11 002430   000074 506007                    DIV     60,DL
        11 002431   200041 756100                    STQ     I,,AUTO
        11 002432   002471 710000 11                 TRA     s:13631+1

     1517    13620    6                                            IF DO_TMIN = -1

  13620 11 002433   200023 235100                    LDA     DO_TMIN,,AUTO
        11 002434   000027 115000 xsym               CMPA    B_VECTNIL+23
        11 002435   002456 601000 11                 TNZ     s:13628

     1518    13621    6                                            THEN
     1519    13622    7                                              DO J = 0 TO 5; /* Wild carded tens */

  13622 11 002436   200042 450100                    STZ     J,,AUTO

     1520    13623    7                                                   TIME = I * 60 + J * 10 + DO_UMIN;

  13623 11 002437   200041 236100                    LDQ     I,,AUTO
        11 002440   000006 402007                    MPY     6,DL
        11 002441   200042 036100                    ADLQ    J,,AUTO
        11 002442   000012 402007                    MPY     10,DL
        11 002443   200025 036100                    ADLQ    DO_UMIN,,AUTO
        11 002444   200043 756100                    STQ     TIME,,AUTO

     1521    13624    7                                                   CALL MAKE$ENTRY(TIME) ALTRET(
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:181  
             13624                                                            NO_MORE_MEM);

  13624 11 002445   200043 630500                    EPPR0   TIME,,AUTO
        11 002446   200075 450500                    STP0    BUF_START+2,,AUTO
        11 002447   004733 701000 11                 TSX1    MAKE$ENTRY
        11 002450   002576 702000 11                 TSX2    NO_MORE_MEM

     1522    13625    7                                                 END;

  13625 11 002451   200042 054100                    AOS     J,,AUTO
        11 002452   200042 235100                    LDA     J,,AUTO
        11 002453   000005 115007                    CMPA    5,DL
        11 002454   002437 604400 11                 TMOZ    s:13623
        11 002455   002470 710000 11                 TRA     s:13631

     1523    13626    6                                            ELSE
     1524    13627    7                                              DO;

     1525    13628    7                                                   TIME = I * 60 + DO_TMIN * 10 +
             13628                                                            DO_UMIN;

  13628 11 002456   200041 236100                    LDQ     I,,AUTO
        11 002457   000006 402007                    MPY     6,DL
        11 002460   200023 036100                    ADLQ    DO_TMIN,,AUTO
        11 002461   000012 402007                    MPY     10,DL
        11 002462   200025 036100                    ADLQ    DO_UMIN,,AUTO
        11 002463   200043 756100                    STQ     TIME,,AUTO

     1526    13629    7                                                   CALL MAKE$ENTRY(TIME) ALTRET(
             13629                                                            NO_MORE_MEM);
             13629                                                            /* Make the entry */

  13629 11 002464   200043 630500                    EPPR0   TIME,,AUTO
        11 002465   200075 450500                    STP0    BUF_START+2,,AUTO
        11 002466   004733 701000 11                 TSX1    MAKE$ENTRY
        11 002467   002576 702000 11                 TSX2    NO_MORE_MEM

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:182  
     1527    13630    7                                                 END; /* End do no wild tens */

     1528    13631    6                                          END; /* End if wild carded hour */

  13631 11 002470   200041 054100                    AOS     I,,AUTO
        11 002471   200041 235100                    LDA     I,,AUTO
        11 002472   000027 115007                    CMPA    23,DL
        11 002473   002433 604400 11                 TMOZ    s:13620
        11 002474   002573 710000 11                 TRA     s:13660

     1529    13632    5                                     ELSE
     1530    13633    5                                          IF DO_TMIN = -1

  13633 11 002475   200023 235100                    LDA     DO_TMIN,,AUTO
        11 002476   000027 115000 xsym               CMPA    B_VECTNIL+23
        11 002477   002520 601000 11                 TNZ     s:13640

     1531    13634    5                                          THEN
     1532    13635    6                                            DO J = 0 TO 5; /* Wild tens */

  13635 11 002500   200042 450100                    STZ     J,,AUTO

     1533    13636    6                                                TIME = DO_HOUR * 60 + J * 10 + DO_UMIN
             13636                                                          ;

  13636 11 002501   200021 236100                    LDQ     DO_HOUR,,AUTO
        11 002502   000006 402007                    MPY     6,DL
        11 002503   200042 036100                    ADLQ    J,,AUTO
        11 002504   000012 402007                    MPY     10,DL
        11 002505   200025 036100                    ADLQ    DO_UMIN,,AUTO
        11 002506   200043 756100                    STQ     TIME,,AUTO

     1534    13637    6                                                 CALL MAKE$ENTRY(TIME) ALTRET(
             13637                                                          NO_MORE_MEM);

  13637 11 002507   200043 630500                    EPPR0   TIME,,AUTO
        11 002510   200075 450500                    STP0    BUF_START+2,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:183  
        11 002511   004733 701000 11                 TSX1    MAKE$ENTRY
        11 002512   002576 702000 11                 TSX2    NO_MORE_MEM

     1535    13638    6                                               END;

  13638 11 002513   200042 054100                    AOS     J,,AUTO
        11 002514   200042 235100                    LDA     J,,AUTO
        11 002515   000005 115007                    CMPA    5,DL
        11 002516   002501 604400 11                 TMOZ    s:13636
        11 002517   002573 710000 11                 TRA     s:13660

     1536    13639    5                                          ELSE
     1537    13640    5                                               CALL MAKE$ENTRY(DO_HOUR*60 + DO_TMIN*10

  13640 11 002520   000006 402007                    MPY     6,DL
        11 002521   200023 036100                    ADLQ    DO_TMIN,,AUTO
        11 002522   000012 402007                    MPY     10,DL
        11 002523   200025 036100                    ADLQ    DO_UMIN,,AUTO
        11 002524   200022 036100                    ADLQ    DO_OFFSET,,AUTO
        11 002525   200123 756100                    STQ     CONV_CURRENT+6,,AUTO
        11 002526   200123 630500                    EPPR0   CONV_CURRENT+6,,AUTO
        11 002527   200075 450500                    STP0    BUF_START+2,,AUTO
        11 002530   004733 701000 11                 TSX1    MAKE$ENTRY
        11 002531   002576 702000 11                 TSX2    NO_MORE_MEM
        11 002532   002573 710000 11                 TRA     s:13660

     1538    13641    5                                                    + DO_UMIN + DO_OFFSET) ALTRET (
             13641                                                             NO_MORE_MEM); /* Only one */
     1539    13642    5                                ELSE       /* Every case */
     1540    13643    6                                  DO;

     1541    13644    6                                       IF DO_FROM = -1

  13644 11 002533   200020 236100                    LDQ     DO_FROM,,AUTO
        11 002534   000027 116000 xsym               CMPQ    B_VECTNIL+23
        11 002535   002560 601000 11                 TNZ     s:13655

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:184  
     1542    13645    6                                       THEN
     1543    13646    7                                         DO;

     1544    13647    7                                              TIME = CURR_TIME ;

  13647 11 002536   000443 235000 1                  LDA     CURR_TIME
        11 002537   200043 755100                    STA     TIME,,AUTO

     1545    13648    7                                              IF NUM_DAYS = 0 AND START_UP

  13648 11 002540   003214 235000 1                  LDA     NUM_DAYS
        11 002541   002550 601000 11                 TNZ     s:13652
        11 002542   003545 234000 1                  SZN     START_UP
        11 002543   002550 605000 11                 TPL     s:13652

     1546    13649    7                                              THEN
     1547    13650    7                                                   DO_FROM = START_TIME + DO_EVERY;

  13650 11 002544   003544 236000 1                  LDQ     START_TIME
        11 002545   200012 036100                    ADLQ    DO_EVERY,,AUTO
        11 002546   200020 756100                    STQ     DO_FROM,,AUTO
        11 002547   002560 710000 11                 TRA     s:13655

     1548    13651    7                                              ELSE
     1549    13652    7                                                  DO_FROM = TIME + MOD(1440 * NUM_DAYS

  13652 11 002550   003214 236000 1                  LDQ     NUM_DAYS
        11 002551   002640 402007                    MPY     1440,DL
        11 002552   200043 036100                    ADLQ    TIME,,AUTO
        11 002553   003544 136000 1                  SBLQ    START_TIME
        11 002554   200012 506100                    DIV     DO_EVERY,,AUTO
        11 002555   000044 733000                    LRS     36
        11 002556   200043 036100                    ADLQ    TIME,,AUTO
        11 002557   200020 756100                    STQ     DO_FROM,,AUTO

     1550    13653    7                                                        + TIME - START_TIME,DO_EVERY);
     1551    13654    7                                            END; /* End if DO_EVERY = -1 */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:185  

     1552    13655    7                                       DO I = DO_FROM TO DO_UNTIL BY DO_EVERY;

  13655 11 002560   200041 756100                    STQ     I,,AUTO
        11 002561   002571 710000 11                 TRA     s:13657+3

     1553    13656    7                                            CALL MAKE$ENTRY(I) ALTRET(NO_MORE_MEM);

  13656 11 002562   200041 630500                    EPPR0   I,,AUTO
        11 002563   200075 450500                    STP0    BUF_START+2,,AUTO
        11 002564   004733 701000 11                 TSX1    MAKE$ENTRY
        11 002565   002576 702000 11                 TSX2    NO_MORE_MEM

     1554    13657    7                                          END;

  13657 11 002566   200012 236100                    LDQ     DO_EVERY,,AUTO
        11 002567   200041 036100                    ADLQ    I,,AUTO
        11 002570   200041 756100                    STQ     I,,AUTO
        11 002571   200026 116100                    CMPQ    DO_UNTIL,,AUTO
        11 002572   002562 604400 11                 TMOZ    s:13656

     1555    13658    6                                     END;  /* End every */

     1556    13659    5                         END;              /*  Else testmode  */

     1557    13660    4                  END;                     /*  Whenreturn from PARSE$COMMAND  */

  13660 11 002573   002575 710000 11                 TRA     s:13665

     1558    13661                                                /**/
     1559    13662    4             WHENALTRETURN DO;

     1560    13663    4                    EXIT PARSE_COMMANDS;

  13663 11 002574   002576 710000 11                 TRA     NO_MORE_MEM

     1561    13664    4                  END;                     /*  Whenaltreturn on PARSE$COMMAND  */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:186  
     1562    13665    3           END PARSE_COMMANDS;             /* Do while forever  */

  13665 11 002575   002226 710000 11                 TRA     PARSE_COMMANDS

  13663 11 002576                       NO_MORE_MEM  null
     1563    13666                                                /**/
     1564    13667                                                /**/
     1565    13668    2   NO_MORE_MEM:;
     1566    13669    2        CALL M$CLOSE(CLOSE_S);             /* Close schedule file */

  13669 11 002576   004074 630400 1                  EPPR0   CLOSE_S
        11 002577   050001 713400                    CLIMB   close
        11 002600   406000 401760                    pmme    nvectors=13

     1567    13670    2        IF DUMP_TABLE THEN

  13670 11 002601   200044 234100                    SZN     DUMP_TABLE,,AUTO
        11 002602   003046 605000 11                 TPL     s:13752

     1568    13671    3          DO;

     1569    13672    3               CALL M$SPRIV (RESET_FMSEC);

  13672 11 002603   005606 630400 1                  EPPR0   RESET_FMSEC
        11 002604   020012 713400                    CLIMB   8202
        11 002605   400000 401760                    pmme    nvectors=1

     1570    13673    3               CALL M$OPEN (GOOSE_TABLE_OPEN) WHENRETURN

  13673 11 002606   005616 630400 1                  EPPR0   GOOSE_TABLE_OPEN
        11 002607   450000 713400                    CLIMB   alt,open
        11 002610   410400 401760                    pmme    nvectors=18
        11 002611   003046 702000 11                 TSX2    s:13752

     1571    13674    4                 DO;

     1572    13675    4                      TIME_ENTRY$ = TIME_HEAD$;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:187  

  13675 11 002612   003556 236000 1                  LDQ     TIME_HEAD$
        11 002613   003555 756000 1                  STQ     TIME_ENTRY$

     1573    13676    5                      DO WHILE TIME_ENTRY$ ~= ADDR(NIL);

  13676 11 002614   003031 710000 11                 TRA     s:13741

     1574    13677    5                           BUF_START = 0;

  13677 11 002615   200073 450100                    STZ     BUF_START,,AUTO

     1575    13678
     1576    13679    6                           DO CASE (TIME_TABLE.TYPE);

  13679 11 002616   003555 470400 1                  LDP0    TIME_ENTRY$
        11 002617   000012 236100                    LDQ     10,,PR0
        11 002620   000033 772000                    QRL     27
        11 002621   000004 116007                    CMPQ    4,DL
        11 002622   002624 602006 11                 TNC     s:13679+6,QL
        11 002623   002647 710000 11                 TRA     s:13691
        11 002624   002630 710000 11                 TRA     s:13682
        11 002625   002647 710000 11                 TRA     s:13691
        11 002626   002635 710000 11                 TRA     s:13685
        11 002627   002642 710000 11                 TRA     s:13688

     1577    13680
     1578    13681    6                           CASE (%IA_CMD_DO#);

     1579    13682    6                              SUBSTR (OUTBUF,BUF_START,8) = '  KEYIN ';

  13682 11 002630   200073 235100                    LDA     BUF_START,,AUTO
        11 002631   040105 100400                    MLR     fill='040'O
        11 002632   000021 000010 10                 ADSC9   NO_GHOST+11              cn=0,n=8
        11 002633   200047 000010                    ADSC9   OUTBUF,A,AUTO            cn=0,n=8
        11 002634   002653 710000 11                 TRA     s:13694

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:188  
     1580    13683
     1581    13684    6                           CASE (%IA_CMD_MESS#);

     1582    13685    6                              SUBSTR (OUTBUF,BUF_START,8) = 'MESSAGE ';

  13685 11 002635   200073 235100                    LDA     BUF_START,,AUTO
        11 002636   040105 100400                    MLR     fill='040'O
        11 002637   000023 000010 10                 ADSC9   NO_GHOST+13              cn=0,n=8
        11 002640   200047 000010                    ADSC9   OUTBUF,A,AUTO            cn=0,n=8
        11 002641   002653 710000 11                 TRA     s:13694

     1583    13686
     1584    13687    6                           CASE (%IA_CMD_START#);

     1585    13688    6                              SUBSTR (OUTBUF,BUF_START,8) = '  START ';

  13688 11 002642   200073 235100                    LDA     BUF_START,,AUTO
        11 002643   040105 100400                    MLR     fill='040'O
        11 002644   000025 000010 10                 ADSC9   NO_GHOST+15              cn=0,n=8
        11 002645   200047 000010                    ADSC9   OUTBUF,A,AUTO            cn=0,n=8
        11 002646   002653 710000 11                 TRA     s:13694

     1586    13689
     1587    13690    6                           CASE (ELSE);

     1588    13691    6                              SUBSTR (OUTBUF,BUF_START,8) = '  ERROR ';

  13691 11 002647   200073 235100                    LDA     BUF_START,,AUTO
        11 002650   040105 100400                    MLR     fill='040'O
        11 002651   000027 000010 10                 ADSC9   NO_GHOST+17              cn=0,n=8
        11 002652   200047 000010                    ADSC9   OUTBUF,A,AUTO            cn=0,n=8

     1589    13692    6                           END;            /*  Do case type  */

     1590    13693
     1591    13694    5                           BUF_START = 8;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:189  
  13694 11 002653   000010 236007                    LDQ     8,DL
        11 002654   200073 756100                    STQ     BUF_START,,AUTO

     1592    13695    5                           CALL BINCHAR (TEMP_TIME, TIME_TABLE.TIME);

  13695 11 002655   000000 236100                    LDQ     0,,PR0
        11 002656   000022 772000                    QRL     18
        11 002657   000000 235003                    LDA     0,DU
        11 002660   200116 757100                    STAQ    CONV_CURRENT+1,,AUTO
        11 002661   000100 301500                    BTD
        11 002662   200116 000010                    NDSC9   CONV_CURRENT+1,,AUTO     cn=0,s=lsgnf,sf=0,n=8
        11 002663   200045 030006                    NDSC9   TEMP_TIME,,AUTO          cn=0,s=nosgn,sf=0,n=6

     1593    13696    5                           SUBSTR (OUTBUF,BUF_START,LENGTHC(TEMP_TIME)) = TEMP_TIME;

  13696 11 002664   200073 236100                    LDQ     BUF_START,,AUTO
        11 002665   040106 100500                    MLR     fill='040'O
        11 002666   200045 000006                    ADSC9   TEMP_TIME,,AUTO          cn=0,n=6
        11 002667   200047 000006                    ADSC9   OUTBUF,Q,AUTO            cn=0,n=6

     1594    13697    5                           BUF_START = BUF_START + LENGTHC(TEMP_TIME);

  13697 11 002670   000006 236007                    LDQ     6,DL
        11 002671   200073 056100                    ASQ     BUF_START,,AUTO

     1595    13698    5                           SUBSTR (OUTBUF,BUF_START,1) = ' ';

  13698 11 002672   200073 235100                    LDA     BUF_START,,AUTO
        11 002673   040105 100400                    MLR     fill='040'O
        11 002674   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 002675   200047 000001                    ADSC9   OUTBUF,A,AUTO            cn=0,n=1

     1596    13699    5                           BUF_START = BUF_START + 1;

  13699 11 002676   200073 054100                    AOS     BUF_START,,AUTO

     1597    13700
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:190  
     1598    13701    5                           IF TIME_TABLE.GHOST_FID.SIZE = 0 THEN

  13701 11 002677   000001 236100                    LDQ     1,,PR0
        11 002700   777000 316003                    CANQ    -512,DU
        11 002701   002711 601000 11                 TNZ     s:13707

     1599    13702    6                             DO;

     1600    13703    6                                  SUBSTR(OUTBUF,BUF_START,37) = NO_GHOST;

  13703 11 002702   200073 235100                    LDA     BUF_START,,AUTO
        11 002703   040105 100400                    MLR     fill='040'O
        11 002704   000006 000014 10                 ADSC9   NO_GHOST                 cn=0,n=12
        11 002705   200047 000045                    ADSC9   OUTBUF,A,AUTO            cn=0,n=37

     1601    13704    6                                  BUF_START = BUF_START + 37;

  13704 11 002706   000045 236007                    LDQ     37,DL
        11 002707   200073 056100                    ASQ     BUF_START,,AUTO

     1602    13705    6                                END;

  13705 11 002710   002761 710000 11                 TRA     s:13724

     1603    13706    6                           ELSE DO;

     1604    13707    6                                 SUBSTR (OUTBUF,BUF_START,TIME_TABLE.GHOST_FID.SIZE) =
             13707                                           TIME_TABLE.GHOST_FID.TEXT;

  13707 11 002711   000001 236100                    LDQ     1,,PR0
        11 002712   000033 772000                    QRL     27
        11 002713   000000 620006                    EAX0    0,QL
        11 002714   200073 235100                    LDA     BUF_START,,AUTO
        11 002715   040145 100500                    MLR     fill='040'O
        11 002716   000001 200023                    ADSC9   1,,PR0                   cn=1,n=19
        11 002717   200047 000010                    ADSC9   OUTBUF,A,AUTO            cn=0,n=*X0

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:191  
     1605    13708    6                                  BUF_START = BUF_START + TIME_TABLE.GHOST_FID.SIZE;

  13708 11 002720   000001 236100                    LDQ     1,,PR0
        11 002721   000033 772000                    QRL     27
        11 002722   200073 036100                    ADLQ    BUF_START,,AUTO
        11 002723   200073 756100                    STQ     BUF_START,,AUTO

     1606    13709    6                                  SUBSTR (OUTBUF,BUF_START,1) = '.';

  13709 11 002724   040106 100400                    MLR     fill='040'O
        11 002725   000074 000001 12                 ADSC9   60                       cn=0,n=1
        11 002726   200047 000001                    ADSC9   OUTBUF,Q,AUTO            cn=0,n=1

     1607    13710    6                                  BUF_START = BUF_START + 1;

  13710 11 002727   200073 054100                    AOS     BUF_START,,AUTO

     1608    13711    7                                  IF TIME_TABLE.ACCT ~= ' ' THEN DO;

  13711 11 002730   040000 106500                    CMPC    fill='040'O
        11 002731   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
        11 002732   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 002733   002742 600000 11                 TZE     s:13715

     1609    13712    7                                         SUBSTR (OUTBUF,BUF_START,LENGTHC(TIME_TABLE.
             13712                                                  ACCT)) = TIME_TABLE.ACCT;

  13712 11 002734   200073 235100                    LDA     BUF_START,,AUTO
        11 002735   040105 100500                    MLR     fill='040'O
        11 002736   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
        11 002737   200047 000010                    ADSC9   OUTBUF,A,AUTO            cn=0,n=8

     1610    13713    7                                         BUF_START = BUF_START + LENGTHC(TIME_TABLE.
             13713                                                  ACCT);

  13713 11 002740   000010 236007                    LDQ     8,DL
        11 002741   200073 056100                    ASQ     BUF_START,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:192  

     1611    13714    7                                       END;

     1612    13715    6                                  SUBSTR (OUTBUF,BUF_START,1) = '.';

  13715 11 002742   200073 235100                    LDA     BUF_START,,AUTO
        11 002743   040105 100400                    MLR     fill='040'O
        11 002744   000074 000001 12                 ADSC9   60                       cn=0,n=1
        11 002745   200047 000001                    ADSC9   OUTBUF,A,AUTO            cn=0,n=1

     1613    13716    6                                  BUF_START = BUF_START + 1;

  13716 11 002746   200073 054100                    AOS     BUF_START,,AUTO

     1614    13717    7                                  IF TIME_TABLE.PASS ~= ' ' THEN DO;

  13717 11 002747   040000 106500                    CMPC    fill='040'O
        11 002750   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
        11 002751   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 002752   002761 600000 11                 TZE     s:13724

     1615    13718    7                                         SUBSTR (OUTBUF,BUF_START,LENGTHC(TIME_TABLE.
             13718                                                  PASS)) = TIME_TABLE.PASS;

  13718 11 002753   200073 235100                    LDA     BUF_START,,AUTO
        11 002754   040105 100500                    MLR     fill='040'O
        11 002755   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
        11 002756   200047 000010                    ADSC9   OUTBUF,A,AUTO            cn=0,n=8

     1616    13719    7                                         BUF_START = BUF_START + LENGTHC(TIME_TABLE.
             13719                                                  PASS);

  13719 11 002757   000010 236007                    LDQ     8,DL
        11 002760   200073 056100                    ASQ     BUF_START,,AUTO

     1617    13720    7                                       END;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:193  
     1618    13721
     1619    13722    6                                END;       /*  Else  */

     1620    13723
     1621    13724    5                           GOOSE_TABLE_WRITE.BUF_.BUF$ = ADDR(OUTBUF);

  13724 11 002761   200047 631500                    EPPR1   OUTBUF,,AUTO
        11 002762   005753 451400 1                  STP1    GOOSE_TABLE_WRITE+5

     1622    13725    5                           GOOSE_TABLE_WRITE.BUF_.BOUND = BUF_START - 1;

  13725 11 002763   200073 236100                    LDQ     BUF_START,,AUTO
        11 002764   000001 136007                    SBLQ    1,DL
        11 002765   000020 736000                    QLS     16
        11 002766   005752 676000 1                  ERQ     GOOSE_TABLE_WRITE+4
        11 002767   000034 376000 xsym               ANQ     B_VECTNIL+28
        11 002770   005752 656000 1                  ERSQ    GOOSE_TABLE_WRITE+4

     1623    13726    5                           CALL M$WRITE (GOOSE_TABLE_WRITE) WHENALTRETURN

  13726 11 002771   005746 630400 1                  EPPR0   GOOSE_TABLE_WRITE
        11 002772   440001 713400                    CLIMB   alt,write
        11 002773   401400 401760                    pmme    nvectors=4
        11 002774   002776 702000 11                 TSX2    s:13728
        11 002775   003000 710000 11                 TRA     s:13731

     1624    13727    6                             DO;

     1625    13728    6                                  RETURN;

  13728 11 002776   200040 221300                    LDX1  ! XUG$+2,,AUTO
        11 002777   000001 702211                    TSX2  ! 1,X1

     1626    13729    6                                END;       /*  Whenaltreturn on M$WRITE  */
     1627    13730
     1628    13731    5                           IF TIME_TABLE.SIZE > 0 THEN

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:194  
  13731 11 003000   003555 470400 1                  LDP0    TIME_ENTRY$
        11 003001   000012 236100                    LDQ     10,,PR0
        11 003002   000777 316003                    CANQ    511,DU
        11 003003   003026 600000 11                 TZE     s:13740

     1629    13732    6                             DO;

     1630    13733    6                                 GOOSE_TABLE_WRITE.BUF_.BUF$ = ADDR(TIME_TABLE.COMMAND
             13733                                           );

  13733 11 003004   003555 236000 1                  LDQ     TIME_ENTRY$
        11 003005   000064 036000 12                 ADLQ    52
        11 003006   005753 756000 1                  STQ     GOOSE_TABLE_WRITE+5

     1631    13734    6                                  GOOSE_TABLE_WRITE.BUF_.BOUND = TIME_TABLE.SIZE - 1;

  13734 11 003007   000012 236100                    LDQ     10,,PR0
        11 003010   000022 772000                    QRL     18
        11 003011   000777 376007                    ANQ     511,DL
        11 003012   000001 136007                    SBLQ    1,DL
        11 003013   000020 736000                    QLS     16
        11 003014   005752 676000 1                  ERQ     GOOSE_TABLE_WRITE+4
        11 003015   000034 376000 xsym               ANQ     B_VECTNIL+28
        11 003016   005752 656000 1                  ERSQ    GOOSE_TABLE_WRITE+4

     1632    13735    6                                  CALL M$WRITE (GOOSE_TABLE_WRITE) WHENALTRETURN

  13735 11 003017   005746 630400 1                  EPPR0   GOOSE_TABLE_WRITE
        11 003020   440001 713400                    CLIMB   alt,write
        11 003021   401400 401760                    pmme    nvectors=4
        11 003022   003024 702000 11                 TSX2    s:13737
        11 003023   003026 710000 11                 TRA     s:13740

     1633    13736    7                                    DO;

     1634    13737    7                                         RETURN;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:195  
  13737 11 003024   200040 221300                    LDX1  ! XUG$+2,,AUTO
        11 003025   000001 702211                    TSX2  ! 1,X1

     1635    13738    7                                       END; /*  Whenaltreturn on M$WRITE  */
     1636    13739    6                                END;

     1637    13740    5                           TIME_ENTRY$ = TIME_TABLE.NEXT$;

  13740 11 003026   003555 470400 1                  LDP0    TIME_ENTRY$
        11 003027   000113 236100                    LDQ     75,,PR0
        11 003030   003555 756000 1                  STQ     TIME_ENTRY$

     1638    13741    5                         END;              /*  Do while  */

  13741 11 003031   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 003032   002615 601000 11                 TNZ     s:13677

     1639    13742
     1640    13743    4                      CALL M$CLOSE (GOOSE_TABLE_CLOSE) WHENALTRETURN

  13743 11 003033   005710 630400 1                  EPPR0   GOOSE_TABLE_CLOSE
        11 003034   450001 713400                    CLIMB   alt,close
        11 003035   406000 401760                    pmme    nvectors=13
        11 003036   003040 702000 11                 TSX2    s:13745
        11 003037   003042 710000 11                 TRA     s:13747

     1641    13744    5                        DO;

     1642    13745    5                             RETURN;

  13745 11 003040   200040 221300                    LDX1  ! XUG$+2,,AUTO
        11 003041   000001 702211                    TSX2  ! 1,X1

     1643    13746    5                           END;            /*  Whenaltreturn on M$WRITE  */
     1644    13747    4                      CALL M$RPRIV (RESET_FMSEC);

  13747 11 003042   005606 630400 1                  EPPR0   RESET_FMSEC
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:196  
        11 003043   020013 713400                    CLIMB   8203
        11 003044   400000 401760                    pmme    nvectors=1

     1645    13748    4                    END;                   /*  Whenreturn on M$OPEN  */

  13748 11 003045   003046 710000 11                 TRA     s:13752

     1646    13749    4               WHENALTRETURN DO;

     1647    13750    4                    END;                   /*  Whenaltreturn on M$OPEN  */

     1648    13751    3             END;                          /*  If DUMP_TABLE  */

     1649    13752    2        RETURN;

  13752 11 003046   200040 221300                    LDX1  ! XUG$+2,,AUTO
        11 003047   000001 702211                    TSX2  ! 1,X1

     1650    13753                                                /**/
     1651    13754                                                /**/
     1652    13755                                                /**/
     1653    13756    2   END BUILD$TIME;
     1654    13757        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:197  
     1655    13758        /*I*      NAME: PARSE$COMMAND
     1656    13759                  PURPOSE: Parses the command from GOOSE_EGG
     1657    13760                  CALL: CALL PARSE$COMMAND ALTRET( BAD_PARSE);
     1658    13761                  DESCRIPTION: This routine calls XUG$GETCMD to read and
     1659    13762                                 actually parse a single command.  It then
     1660    13763                                 interpets ths blocks it gets back and stores
     1661    13764                                 the infomation in 'DO_   ' variables. The
     1662    13765                                 routine will ALTRETURN if there is an error
     1663    13766                                 in the command, or if XUG altreturns.
     1664    13767                             */
     1665    13768    1   PARSE$COMMAND: PROC ALTRET;

  13768 11 003050   200074 741300       PARSE$COMMA* STX1  ! BUF_START+1,,AUTO

     1666    13769    2   DCL I SBIN WORD;
     1667    13770    2   DCL J SBIN WORD;
     1668    13771    2   DCL K SBIN WORD;
     1669    13772    2   DCL SIZE UBIN WORD;
     1670    13773    2   DCL SYN_ERR UBIN WORD;
     1671    13774    2   DCL BTEXT CHAR(SIZE) BASED;
     1672    13775    2   DCL 1 DO_BEGIN_RANGE,
     1673    13776    2           2 YY CHAR(2),
     1674    13777    2           2 MM CHAR(2) CALIGNED,
     1675    13778    2           2 ERROR UBIN CALIGNED,
     1676    13779    2           2 DD CHAR(2) CALIGNED;
     1677    13780    2   DCL 1 DO_BEGIN_SINGLE REDEF DO_BEGIN_RANGE,
     1678    13781    2           2 Y1 CHAR(1),
     1679    13782    2           2 Y2 CHAR(1),
     1680    13783    2           2 M1 CHAR(1),
     1681    13784    2           2 M2 CHAR(1),
     1682    13785    2           2 * UBIN CALIGNED,
     1683    13786    2           2 D1 CHAR(1),
     1684    13787    2           2 D2 CHAR(1);
     1685    13788    2   DCL 1 DO_END_RANGE,
     1686    13789    2           2 YY CHAR(2),
     1687    13790    2           2 MM CHAR(2) CALIGNED,
     1688    13791    2           2 ERROR UBIN CALIGNED,
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:198  
     1689    13792    2           2 DD CHAR(2) CALIGNED;
     1690    13793    2   DCL 1 DO_END_SINGLE REDEF DO_END_RANGE,
     1691    13794    2           2 Y1 CHAR(1),
     1692    13795    2           2 Y2 CHAR(1),
     1693    13796    2           2 M1 CHAR(1),
     1694    13797    2           2 M2 CHAR(1),
     1695    13798    2           2 * UBIN CALIGNED,
     1696    13799    2           2 D1 CHAR(1),
     1697    13800    2           2 D2 CHAR(1);
     1698    13801
     1699    13802    2   DCL CONV_YR         UBIN;
     1700    13803    2   DCL CONV_MO         UBIN;
     1701    13804    2   DCL CONV_DY         UBIN;
     1702    13805    2   DCL CONV_BEGIN      UBIN;
     1703    13806    2   DCL CONV_END        UBIN;
     1704    13807    2   DCL CONV_CURRENT    UBIN;
     1705    13808
     1706    13809                                                /**/
     1707    13810                                                /**/
     1708    13811    2        CALL XUG$GETCMD (EGG_GETCMD)

  13811 11 003051   000047 630400 12                 EPPR0   39
        11 003052   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 003053   000000 701000 xent               TSX1    XUG$GETCMD
        11 003054   003056 702000 11                 TSX2    s:13813
        11 003055   003101 710000 11                 TRA     s:13824

     1709    13812    3        WHENALTRETURN DO;

     1710    13813    3               ERROR = EGG_GETCMD.ERR#;

  13813 11 003056   000227 236000 1                  LDQ     EGG_GETCMD+1
        11 003057   004132 756000 1                  STQ     ERROR

     1711    13814    3               IF ERROR.ERR# ~= %E$EOF

  13814 11 003060   004132 236000 1                  LDQ     ERROR
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:199  
        11 003061   377770 376007                    ANQ     131064,DL
        11 003062   000060 116007                    CMPQ    48,DL
        11 003063   003077 600000 11                 TZE     s:13822

     1712    13815    4               THEN DO;

     1713    13816    4                      IF ERROR.ERR# = %E$SYNERR

  13816 11 003064   000010 116007                    CMPQ    8,DL
        11 003065   003073 601000 11                 TNZ     s:13820

     1714    13817    4                      THEN
     1715    13818    4                           CALL IAE$ERROR(ON_LINE,%E$IA_SYN_ERR#,ERROR,%
             13818                                    IA_KEY_SYNTAX_ERR#,EGG_GETCMD.PCB$);

  13818 11 003066   000075 630400 12                 EPPR0   61
        11 003067   000023 631400 xsym               EPPR1   B_VECTNIL+19
        11 003070   000000 701000 xent               TSX1    IAE$ERROR
        11 003071   000000 011000                    NOP     0
        11 003072   003077 710000 11                 TRA     s:13822

     1716    13819    4                      ELSE
     1717    13820    4                           CALL IAE$ERROR(ON_LINE,0,ERROR,%IA_KEY_EGG_ERR#,EGG_GETCMD.
             13820                                    PCB$);

  13820 11 003073   000102 630400 12                 EPPR0   66
        11 003074   000023 631400 xsym               EPPR1   B_VECTNIL+19
        11 003075   000000 701000 xent               TSX1    IAE$ERROR
        11 003076   000000 011000                    NOP     0

     1718    13821    4                    END;                   /*  If not eof  */

     1719    13822    3               ALTRETURN;

  13822 11 003077   200074 221300                    LDX1  ! BUF_START+1,,AUTO
        11 003100   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:200  
     1720    13823    3             END;                          /*  Whenaltreturn on XUG$GETCMD  */
     1721    13824    2        DO_ACCT = B$JIT$ -> B$JIT.ACCN;

  13824 11 003101   000000 470400 xsym               LDP0    B$JIT$
        11 003102   040000 100500                    MLR     fill='040'O
        11 003103   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        11 003104   000444 000010 1                  ADSC9   DO_ACCT                  cn=0,n=8

     1722    13825    2        DO_PASS = ' ';

  13825 11 003105   000035 235000 xsym               LDA     B_VECTNIL+29
        11 003106   000035 236000 xsym               LDQ     B_VECTNIL+29
        11 003107   000551 755000 1                  STA     DO_PASS
        11 003110   000552 756000 1                  STQ     DO_PASS+1

     1723    13826    2        DO_CMD_SIZE = 0;

  13826 11 003111   200003 450100                    STZ     DO_CMD_SIZE,,AUTO

     1724    13827    2        DO_HOUR = -1;

  13827 11 003112   000001 335007                    LCA     1,DL
        11 003113   200021 755100                    STA     DO_HOUR,,AUTO

     1725    13828    2        DO_TMIN = -1;

  13828 11 003114   200023 755100                    STA     DO_TMIN,,AUTO

     1726    13829    2        DO_UMIN = -1;

  13829 11 003115   200025 755100                    STA     DO_UMIN,,AUTO

     1727    13830    2        DO_OFFSET = 0;

  13830 11 003116   200022 450100                    STZ     DO_OFFSET,,AUTO

     1728    13831    2        DO_EVERY = -1;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:201  

  13831 11 003117   200012 755100                    STA     DO_EVERY,,AUTO

     1729    13832    2        DO_DATE.MM = '?';

  13832 11 003120   077040 220003                    LDX0    32288,DU
        11 003121   000546 440000 1                  SXL0    DO_DATE

     1730    13833    2        DO_DATE.DD = '?';

  13833 11 003122   000550 740000 1                  STX0    DO_DATE+2

     1731    13834    2        DO_DATE.YY = '?';

  13834 11 003123   000546 740000 1                  STX0    DO_DATE

     1732    13835    2        DO_DAY(0) = '   ';

  13835 11 003124   000015 236000 10                 LDQ     NO_GHOST+7
        11 003125   200004 552170                    STBQ    DO_DAY,'70'O,AUTO

     1733    13836    2        DO_DAY(1) = '   ';

  13836 11 003126   040100 100400                    MLR     fill='040'O
        11 003127   000015 000003 10                 ADSC9   NO_GHOST+7               cn=0,n=3
        11 003130   200004 600003                    ADSC9   DO_DAY,,AUTO             cn=3,n=3

     1734    13837    2        DO_DAY(2) = '   ';

  13837 11 003131   040100 100400                    MLR     fill='040'O
        11 003132   000015 000003 10                 ADSC9   NO_GHOST+7               cn=0,n=3
        11 003133   200005 400003                    ADSC9   DO_DAY+1,,AUTO           cn=2,n=3

     1735    13838    2        DO_DAY(3) = '   ';

  13838 11 003134   000011 772000                    QRL     9
        11 003135   200006 552134                    STBQ    DO_DAY+2,'34'O,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:202  

     1736    13839    2        DO_DAY(4) = '   ';

  13839 11 003136   000015 236000 10                 LDQ     NO_GHOST+7
        11 003137   200007 552170                    STBQ    DO_DAY+3,'70'O,AUTO

     1737    13840    2        DO_DAY(5) = '   ';

  13840 11 003140   040100 100400                    MLR     fill='040'O
        11 003141   000015 000003 10                 ADSC9   NO_GHOST+7               cn=0,n=3
        11 003142   200007 600003                    ADSC9   DO_DAY+3,,AUTO           cn=3,n=3

     1738    13841    2        DO_DAY(6) = '   ';

  13841 11 003143   040100 100400                    MLR     fill='040'O
        11 003144   000015 000003 10                 ADSC9   NO_GHOST+7               cn=0,n=3
        11 003145   200010 400003                    ADSC9   DO_DAY+4,,AUTO           cn=2,n=3

     1739    13842    2        DO_FID.TEXT = '   ';

  13842 11 003146   040100 100400                    MLR     fill='040'O
        11 003147   000015 000003 10                 ADSC9   NO_GHOST+7               cn=0,n=3
        11 003150   200013 200023                    ADSC9   DO_FID,,AUTO             cn=1,n=19

     1740    13843    2        DO_FID.SIZE = 0;

  13843 11 003151   000000 236003                    LDQ     0,DU
        11 003152   200013 552140                    STBQ    DO_FID,'40'O,AUTO

     1741    13844    2        DO_CMD = '   ';

  13844 11 003153   040000 100400                    MLR     fill='040'O
        11 003154   000015 000003 10                 ADSC9   NO_GHOST+7               cn=0,n=3
        11 003155   000446 000400 1                  ADSC9   DO_CMD                   cn=0,n=256

     1742    13845    2        DO_FROM = -1;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:203  
  13845 11 003156   200020 755100                    STA     DO_FROM,,AUTO

     1743    13846    2        DO_UNTIL = 1439;                   /* Default from 00:00 to 23:59 */

  13846 11 003157   002637 235007                    LDA     1439,DL
        11 003160   200026 755100                    STA     DO_UNTIL,,AUTO

     1744    13847                                                /**/
     1745    13848                                                /**/
     1746    13849    2        DO_TYPE = EGG_GETCMD.OUT$ -> OUT$BLK.CODE; /* Save message type */

  13849 11 003161   000227 471400 1                  LDP1    EGG_GETCMD+1
        11 003162   100000 236100                    LDQ     0,,PR1
        11 003163   777777 376007                    ANQ     -1,DL
        11 003164   000033 736000                    QLS     27
        11 003165   200024 756100                    STQ     DO_TYPE,,AUTO

     1747    13850    3        DO I = 0 TO EGG_GETCMD.OUT$ -> OUT$BLK.NSUBLKS - 1;

  13850 11 003166   200075 450100                    STZ     I,,AUTO
        11 003167   004655 710000 11                 TRA     s:14246+1

     1748    13851    3             PTR$ = EGG_GETCMD.OUT$ ->  OUT$BLK.SUBLK$(I);

  13851 11 003170   000227 470400 1                  LDP0    EGG_GETCMD+1
        11 003171   200075 720100                    LXL0    I,,AUTO
        11 003172   000003 236110                    LDQ     3,X0,PR0
        11 003173   200033 756100                    STQ     PTR$,,AUTO

     1749    13852    4             DO CASE (PTR$ -> OUT$BLK.CODE);

  13852 11 003174   200033 471500                    LDP1    PTR$,,AUTO
        11 003175   100000 721100                    LXL1    0,,PR1
        11 003176   000014 101003                    CMPX1   12,DU
        11 003177   003201 602011 11                 TNC     s:13852+5,X1
        11 003200   004654 710000 11                 TRA     s:14246
        11 003201   004654 710000 11                 TRA     s:14246
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:204  
        11 003202   003250 710000 11                 TRA     s:13865
        11 003203   003215 710000 11                 TRA     s:13856
        11 003204   003360 710000 11                 TRA     s:13903
        11 003205   003460 710000 11                 TRA     s:13924
        11 003206   004466 710000 11                 TRA     s:14189
        11 003207   004541 710000 11                 TRA     s:14206
        11 003210   004570 710000 11                 TRA     s:14220
        11 003211   004621 710000 11                 TRA     s:14230
        11 003212   004552 710000 11                 TRA     s:14211
        11 003213   004561 710000 11                 TRA     s:14217
        11 003214   003722 710000 11                 TRA     s:13997

     1750    13853                                                /**/
     1751    13854                                                /**/
     1752    13855    4             CASE (%IA_GKEY_EVERY#);

     1753    13856    4                CALL CONCAT(MESS_BUF, '+', %SUB_BLOCK(0)->OUT$SYM.TEXT);

  13856 11 003215   100003 473500                    LDP3    3,,PR1
        11 003216   300004 236100                    LDQ     4,,PR3
        11 003217   000033 772000                    QRL     27
        11 003220   000000 622006                    EAX2    0,QL
        11 003221   053000 236003                    LDQ     22016,DU
        11 003222   000000 552040 xsym               STBQ    MESS_BUF,'40'O
        11 003223   040000 100540                    MLR     fill='040'O
        11 003224   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
        11 003225   000000 200377 xsym               ADSC9   MESS_BUF                 cn=1,n=255

     1754    13857    4                SIZE = %SUB_BLOCK (0) -> OUT$SYM.COUNT + 1;

  13857 11 003226   200033 470500                    LDP0    PTR$,,AUTO
        11 003227   000003 471500                    LDP1    3,,PR0
        11 003230   100004 236100                    LDQ     4,,PR1
        11 003231   000033 772000                    QRL     27
        11 003232   000001 036007                    ADLQ    1,DL
        11 003233   200100 756100                    STQ     SIZE,,AUTO

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:205  
     1755    13858    4                CALL XCHARBIN(DO_EVERY,ADDR(MESS_BUF)->BTEXT);

  13858 11 003234   000000 620006                    EAX0    0,QL
        11 003235   000100 305440                    DTB
        11 003236   000000 010010 xsym               NDSC9   MESS_BUF                 cn=0,s=lsgns,sf=0,n=*X0
        11 003237   200012 000004                    NDSC9   DO_EVERY,,AUTO           cn=0,s=lsgnf,sf=0,n=4

     1756    13859    4                IF %SUB_BLOCK (1) -> OUT$SYM.CODE = 2

  13859 11 003240   000004 473500                    LDP3    4,,PR0
        11 003241   300000 720100                    LXL0    0,,PR3
        11 003242   000002 100003                    CMPX0   2,DU
        11 003243   004654 601000 11                 TNZ     s:14246

     1757    13860    4                THEN
     1758    13861    4                     DO_EVERY = DO_EVERY * 60;

  13861 11 003244   200012 236100                    LDQ     DO_EVERY,,AUTO
        11 003245   000074 402007                    MPY     60,DL
        11 003246   200012 756100                    STQ     DO_EVERY,,AUTO
        11 003247   004654 710000 11                 TRA     s:14246

     1759    13862                                                /**/
     1760    13863                                                /**/
     1761    13864    4             CASE (%IA_GKEY_AT#);

     1762    13865    4                IF %SUB_BLOCK(0) -> OUT$SYM.CODE ~= 3 /* Start up */

  13865 11 003250   100003 473500                    LDP3    3,,PR1
        11 003251   300000 722100                    LXL2    0,,PR3
        11 003252   000003 102003                    CMPX2   3,DU
        11 003253   003346 600000 11                 TZE     s:13895

     1763    13866    4                THEN
     1764    13867    5                  DO;

     1765    13868    5                       CALL INDEX(J, '?', %SUB_BLOCK(0)->OUT$SYM.TEXT)
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:206  

  13868 11 003254   300004 236100                    LDQ     4,,PR3
        11 003255   000033 772000                    QRL     27
        11 003256   000000 623006                    EAX3    0,QL
        11 003257   000000 124540                    SCM     mask='000'O
        11 003260   300004 200013                    ADSC9   4,,PR3                   cn=1,n=*X3
        11 003261   000107 000001 12                 ADSC9   71                       cn=0,n=1
        11 003262   200076 000100                    ARG     J,,AUTO
        11 003263   003274 606400 11                 TTN     s:13876

     1766    13869    6                       WHENRETURN DO;

     1767    13870    6                              IF %SUB_BLOCK(0) -> OUT$SYM.COUNT = 2 AND

  13870 11 003264   000033 736000                    QLS     27
        11 003265   002000 116003                    CMPQ    1024,DU
        11 003266   003273 601000 11                 TNZ     s:13874
        11 003267   040000 106540                    CMPC    fill='040'O
        11 003270   300004 200013                    ADSC9   4,,PR3                   cn=1,n=*X3
        11 003271   000031 000002 10                 ADSC9   NO_GHOST+19              cn=0,n=2
        11 003272   004664 601000 11                 TNZ     SYN_TIME_ERR

     1768    13871    6                                   %SUB_BLOCK(0)->OUT$SYM.TEXT ~= '??'
     1769    13872    6                              THEN
     1770    13873    6                                   GOTO SYN_TIME_ERR;
     1771    13874    6                            END;           /* '?' found in hour */

  13874 11 003273   003304 710000 11                 TRA     s:13878

     1772    13875    6                       WHENALTRETURN DO;

     1773    13876    6                              CALL CHARBIN(DO_HOUR,%SUB_BLOCK(0) -> OUT$SYM.TEXT);

  13876 11 003274   200033 470500                    LDP0    PTR$,,AUTO
        11 003275   000003 471500                    LDP1    3,,PR0
        11 003276   100004 236100                    LDQ     4,,PR1
        11 003277   000033 772000                    QRL     27
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:207  
        11 003300   000000 620006                    EAX0    0,QL
        11 003301   000100 305540                    DTB
        11 003302   100004 230010                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X0
        11 003303   200021 000004                    NDSC9   DO_HOUR,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     1774    13877    6                            END;           /* no '?' in hour */

     1775    13878    5                       DO_UMIN = ASCBIN(SUBSTR(%SUB_BLOCK(1)->OUT$SYM.TEXT,0,1)) -
             13878                                ASCBIN('0');

  13878 11 003304   200033 470500                    LDP0    PTR$,,AUTO
        11 003305   000004 471500                    LDP1    4,,PR0
        11 003306   100004 236100                    LDQ     4,,PR1
        11 003307   000033 772000                    QRL     27
        11 003310   100004 236100                    LDQ     4,,PR1
        11 003311   000022 772000                    QRL     18
        11 003312   000777 376007                    ANQ     511,DL
        11 003313   000060 136007                    SBLQ    48,DL
        11 003314   200025 756100                    STQ     DO_UMIN,,AUTO

     1776    13879    5                       IF %SUB_BLOCK(1) -> OUT$SYM.COUNT = 2

  13879 11 003315   100004 236100                    LDQ     4,,PR1
        11 003316   777000 376003                    ANQ     -512,DU
        11 003317   002000 116003                    CMPQ    1024,DU
        11 003320   003334 601000 11                 TNZ     s:13886

     1777    13880    6                       THEN DO;

     1778    13881    6                              IF DO_UMIN <= 9

  13881 11 003321   200025 235100                    LDA     DO_UMIN,,AUTO
        11 003322   000011 115007                    CMPA    9,DL
        11 003323   003325 605400 11                 TPNZ    s:13884

     1779    13882    6                              THEN         /* not a '?' */
     1780    13883    6                                   DO_TMIN = DO_UMIN;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:208  

  13883 11 003324   200023 755100                    STA     DO_TMIN,,AUTO

     1781    13884    6                             DO_UMIN = ASCBIN(SUBSTR(%SUB_BLOCK(1)->OUT$SYM.TEXT,1,1))
             13884                                       - ASCBIN('0');

  13884 11 003325   100004 236100                    LDQ     4,,PR1
        11 003326   000033 772000                    QRL     27
        11 003327   100004 236100                    LDQ     4,,PR1
        11 003330   000011 772000                    QRL     9
        11 003331   000777 376007                    ANQ     511,DL
        11 003332   000060 136007                    SBLQ    48,DL
        11 003333   200025 756100                    STQ     DO_UMIN,,AUTO

     1782    13885    6                            END;           /* 2 digits in minutes */

     1783    13886    5                       IF DO_UMIN > 9

  13886 11 003334   200025 235100                    LDA     DO_UMIN,,AUTO
        11 003335   000011 115007                    CMPA    9,DL
        11 003336   004664 605400 11                 TPNZ    SYN_TIME_ERR

     1784    13887    5                       THEN
     1785    13888    5                            GOTO SYN_TIME_ERR; /* '?' in units found */
     1786    13889    5                       IF DO_HOUR > 23 OR DO_TMIN > 5

  13889 11 003337   200021 236100                    LDQ     DO_HOUR,,AUTO
        11 003340   000027 116007                    CMPQ    23,DL
        11 003341   004664 605400 11                 TPNZ    SYN_TIME_ERR
        11 003342   200023 235100                    LDA     DO_TMIN,,AUTO
        11 003343   000005 115007                    CMPA    5,DL
        11 003344   004664 605400 11                 TPNZ    SYN_TIME_ERR

     1787    13890    5                       THEN
     1788    13891    5                            GOTO SYN_TIME_ERR;
     1789    13892    5                     END;                  /* End not startup */

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:209  
  13892 11 003345   004654 710000 11                 TRA     s:14246

     1790    13893    4                ELSE
     1791    13894    5                  DO;

     1792    13895    5                       IF %SUB_BLOCK(0) -> OUT$BLK.NSUBLKS > 0

  13895 11 003346   300001 223100                    LDX3    1,,PR3
        11 003347   004654 600000 11                 TZE     s:14246

     1793    13896    5                       THEN
     1794    13897    5                            CALL CHARBIN (DO_OFFSET, %SUB_BLOCK(0)

  13897 11 003350   300003 474500                    LDP4    3,,PR3
        11 003351   400004 236100                    LDQ     4,,PR4
        11 003352   000033 772000                    QRL     27
        11 003353   000000 624006                    EAX4    0,QL
        11 003354   000100 305540                    DTB
        11 003355   400004 230014                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X4
        11 003356   200022 000004                    NDSC9   DO_OFFSET,,AUTO          cn=0,s=lsgnf,sf=0,n=4

     1795    13898    5                                 -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
     1796    13899    5                     END;

  13899 11 003357   004654 710000 11                 TRA     s:14246

     1797    13900                                                /**/
     1798    13901                                                /**/
     1799    13902    4             CASE (%IA_GKEY_DAYS#) ;

     1800    13903    5                DO J = 0 TO PTR$ -> OUT$BLK.NSUBLKS - 1;

  13903 11 003360   200076 450100                    STZ     J,,AUTO
        11 003361   003452 710000 11                 TRA     s:13920+1

     1801    13904    6                     DO CASE (%SUB_BLOCK(J) -> OUT$SYM.CODE);

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:210  
  13904 11 003362   200033 470500                    LDP0    PTR$,,AUTO
        11 003363   200076 720100                    LXL0    J,,AUTO
        11 003364   000003 471510                    LDP1    3,X0,PR0
        11 003365   100000 721100                    LXL1    0,,PR1
        11 003366   000007 101003                    CMPX1   7,DU
        11 003367   003371 602011 11                 TNC     s:13904+7,X1
        11 003370   003451 710000 11                 TRA     s:13920
        11 003371   003400 710000 11                 TRA     s:13906
        11 003372   003406 710000 11                 TRA     s:13908
        11 003373   003414 710000 11                 TRA     s:13910
        11 003374   003422 710000 11                 TRA     s:13912
        11 003375   003430 710000 11                 TRA     s:13914
        11 003376   003436 710000 11                 TRA     s:13916
        11 003377   003444 710000 11                 TRA     s:13918

     1802    13905    6                     CASE (%IA_MONDAY#);

     1803    13906    6                        DO_DAY(J) = 'MON';

  13906 11 003400   200076 236100                    LDQ     J,,AUTO
        11 003401   000003 402007                    MPY     3,DL
        11 003402   040106 100400                    MLR     fill='040'O
        11 003403   000032 000003 10                 ADSC9   NO_GHOST+20              cn=0,n=3
        11 003404   200004 000003                    ADSC9   DO_DAY,Q,AUTO            cn=0,n=3
        11 003405   003451 710000 11                 TRA     s:13920

     1804    13907    6                     CASE (%IA_TUESDAY#);

     1805    13908    6                        DO_DAY(J) = 'TUE';

  13908 11 003406   200076 236100                    LDQ     J,,AUTO
        11 003407   000003 402007                    MPY     3,DL
        11 003410   040106 100400                    MLR     fill='040'O
        11 003411   000033 000003 10                 ADSC9   NO_GHOST+21              cn=0,n=3
        11 003412   200004 000003                    ADSC9   DO_DAY,Q,AUTO            cn=0,n=3
        11 003413   003451 710000 11                 TRA     s:13920

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:211  
     1806    13909    6                     CASE (%IA_WEDNESDAY#);

     1807    13910    6                        DO_DAY(J) = 'WED';

  13910 11 003414   200076 236100                    LDQ     J,,AUTO
        11 003415   000003 402007                    MPY     3,DL
        11 003416   040106 100400                    MLR     fill='040'O
        11 003417   000034 000003 10                 ADSC9   NO_GHOST+22              cn=0,n=3
        11 003420   200004 000003                    ADSC9   DO_DAY,Q,AUTO            cn=0,n=3
        11 003421   003451 710000 11                 TRA     s:13920

     1808    13911    6                     CASE (%IA_THURSDAY#);

     1809    13912    6                        DO_DAY(J) = 'THU';

  13912 11 003422   200076 236100                    LDQ     J,,AUTO
        11 003423   000003 402007                    MPY     3,DL
        11 003424   040106 100400                    MLR     fill='040'O
        11 003425   000035 000003 10                 ADSC9   NO_GHOST+23              cn=0,n=3
        11 003426   200004 000003                    ADSC9   DO_DAY,Q,AUTO            cn=0,n=3
        11 003427   003451 710000 11                 TRA     s:13920

     1810    13913    6                     CASE (%IA_FRIDAY#);

     1811    13914    6                        DO_DAY(J) = 'FRI';

  13914 11 003430   200076 236100                    LDQ     J,,AUTO
        11 003431   000003 402007                    MPY     3,DL
        11 003432   040106 100400                    MLR     fill='040'O
        11 003433   000036 000003 10                 ADSC9   NO_GHOST+24              cn=0,n=3
        11 003434   200004 000003                    ADSC9   DO_DAY,Q,AUTO            cn=0,n=3
        11 003435   003451 710000 11                 TRA     s:13920

     1812    13915    6                     CASE (%IA_SATURDAY#);

     1813    13916    6                        DO_DAY(J) = 'SAT';

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:212  
  13916 11 003436   200076 236100                    LDQ     J,,AUTO
        11 003437   000003 402007                    MPY     3,DL
        11 003440   040106 100400                    MLR     fill='040'O
        11 003441   000037 000003 10                 ADSC9   NO_GHOST+25              cn=0,n=3
        11 003442   200004 000003                    ADSC9   DO_DAY,Q,AUTO            cn=0,n=3
        11 003443   003451 710000 11                 TRA     s:13920

     1814    13917    6                     CASE (%IA_SUNDAY#);

     1815    13918    6                        DO_DAY(J) = 'SUN';

  13918 11 003444   200076 236100                    LDQ     J,,AUTO
        11 003445   000003 402007                    MPY     3,DL
        11 003446   040106 100400                    MLR     fill='040'O
        11 003447   000040 000003 10                 ADSC9   NO_GHOST+26              cn=0,n=3
        11 003450   200004 000003                    ADSC9   DO_DAY,Q,AUTO            cn=0,n=3

     1816    13919    6                     END;                  /* End case */

     1817    13920    5                   END;

  13920 11 003451   200076 054100                    AOS     J,,AUTO
        11 003452   200033 470500                    LDP0    PTR$,,AUTO
        11 003453   000001 236100                    LDQ     1,,PR0
        11 003454   000022 772000                    QRL     18
        11 003455   200076 116100                    CMPQ    J,,AUTO
        11 003456   003362 605400 11                 TPNZ    s:13904
        11 003457   004654 710000 11                 TRA     s:14246

     1818    13921                                                /**/
     1819    13922                                                /**/
     1820    13923    4             CASE (%IA_GKEY_DATE#) ;

     1821    13924    4                IF %SUB_BLOCK (2) -> OUT$SYM.COUNT = 1

  13924 11 003460   100005 473500                    LDP3    5,,PR1
        11 003461   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:213  
        11 003462   777000 376003                    ANQ     -512,DU
        11 003463   001000 116003                    CMPQ    512,DU
        11 003464   003476 601000 11                 TNZ     s:13928

     1822    13925    4                THEN
     1823    13926    4                     CALL CONCAT(DO_DATE.YY,'0',%SUB_BLOCK(2) -> OUT$SYM.TEXT);

  13926 11 003465   300004 236100                    LDQ     4,,PR3
        11 003466   000033 772000                    QRL     27
        11 003467   000000 622006                    EAX2    0,QL
        11 003470   060000 236003                    LDQ     24576,DU
        11 003471   000546 552040 1                  STBQ    DO_DATE,'40'O
        11 003472   040000 100540                    MLR     fill='040'O
        11 003473   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
        11 003474   000546 200001 1                  ADSC9   DO_DATE                  cn=1,n=1
        11 003475   003504 710000 11                 TRA     s:13929

     1824    13927    4                ELSE
     1825    13928    4                     DO_DATE.YY = %SUB_BLOCK(2) -> OUT$SYM.TEXT;

  13928 11 003476   300004 236100                    LDQ     4,,PR3
        11 003477   000033 772000                    QRL     27
        11 003500   000000 622006                    EAX2    0,QL
        11 003501   040000 100540                    MLR     fill='040'O
        11 003502   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
        11 003503   000546 000002 1                  ADSC9   DO_DATE                  cn=0,n=2

     1826    13929    4                IF DO_DATE.YY = '0?' OR DO_DATE.YY = '??'

  13929 11 003504   000546 220000 1                  LDX0    DO_DATE
        11 003505   000041 100000 10                 CMPX0   NO_GHOST+27
        11 003506   003511 600000 11                 TZE     s:13931
        11 003507   000031 100000 10                 CMPX0   NO_GHOST+19
        11 003510   003513 601000 11                 TNZ     s:13932

     1827    13930    4                THEN
     1828    13931    4                     DO_DATE.YY = '?';
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:214  

  13931 11 003511   077040 221003                    LDX1    32288,DU
        11 003512   000546 741000 1                  STX1    DO_DATE

     1829    13932    4                IF (DO_DATER.Y1 = '?' AND DO_DATER.Y2 ~= ' ')

  13932 11 003513   000546 236000 1                  LDQ     DO_DATE
        11 003514   777000 376003                    ANQ     -512,DU
        11 003515   077000 116003                    CMPQ    32256,DU
        11 003516   003523 601000 11                 TNZ     s:13932+8
        11 003517   000546 236000 1                  LDQ     DO_DATE
        11 003520   000777 376003                    ANQ     511,DU
        11 003521   000040 116003                    CMPQ    32,DU
        11 003522   004672 601000 11                 TNZ     SYN_YEAR_ERR
        11 003523   000546 236000 1                  LDQ     DO_DATE
        11 003524   000777 376003                    ANQ     511,DU
        11 003525   000077 116003                    CMPQ    63,DU
        11 003526   004672 600000 11                 TZE     SYN_YEAR_ERR

     1830    13933    4                     OR DO_DATER.Y2 = '?'
     1831    13934    4                THEN
     1832    13935    4                     GOTO SYN_YEAR_ERR;
     1833    13936    4                IF %SUB_BLOCK (0) -> OUT$SYM.COUNT = 1

  13936 11 003527   200033 470500                    LDP0    PTR$,,AUTO
        11 003530   000003 471500                    LDP1    3,,PR0
        11 003531   100004 236100                    LDQ     4,,PR1
        11 003532   777000 376003                    ANQ     -512,DU
        11 003533   001000 116003                    CMPQ    512,DU
        11 003534   003546 601000 11                 TNZ     s:13940

     1834    13937    4                THEN
     1835    13938    4                     CALL CONCAT(DO_DATE.MM,'0',%SUB_BLOCK(0) -> OUT$SYM.TEXT);

  13938 11 003535   100004 236100                    LDQ     4,,PR1
        11 003536   000033 772000                    QRL     27
        11 003537   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:215  
        11 003540   060000 236007                    LDQ     24576,DL
        11 003541   000546 552010 1                  STBQ    DO_DATE,'10'O
        11 003542   040000 100540                    MLR     fill='040'O
        11 003543   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        11 003544   000546 600001 1                  ADSC9   DO_DATE                  cn=3,n=1
        11 003545   003554 710000 11                 TRA     s:13941

     1836    13939    4                ELSE
     1837    13940    4                     DO_DATE.MM = %SUB_BLOCK(0) -> OUT$SYM.TEXT;

  13940 11 003546   100004 236100                    LDQ     4,,PR1
        11 003547   000033 772000                    QRL     27
        11 003550   000000 620006                    EAX0    0,QL
        11 003551   040000 100540                    MLR     fill='040'O
        11 003552   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        11 003553   000546 400002 1                  ADSC9   DO_DATE                  cn=2,n=2

     1838    13941    4                IF DO_DATE.MM = '0?' OR DO_DATE.MM = '??'

  13941 11 003554   000546 720000 1                  LXL0    DO_DATE
        11 003555   000041 100000 10                 CMPX0   NO_GHOST+27
        11 003556   003561 600000 11                 TZE     s:13943
        11 003557   000031 100000 10                 CMPX0   NO_GHOST+19
        11 003560   003564 601000 11                 TNZ     s:13945

     1839    13942    4                THEN
     1840    13943    4                     DO_DATE.MM = '?';

  13943 11 003561   077040 221003                    LDX1    32288,DU
        11 003562   000546 441000 1                  SXL1    DO_DATE
        11 003563   003571 710000 11                 TRA     s:13948

     1841    13944    4                ELSE
     1842    13945    4                     IF DO_DATE.MM > '12' OR DO_DATE.MM < '01'

  13945 11 003564   000042 100000 10                 CMPX0   NO_GHOST+28
        11 003565   003567 600000 11                 TZE     s:13945+3
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:216  
        11 003566   004675 603000 11                 TRC     SYN_MONTH_ERR
        11 003567   000043 100000 10                 CMPX0   NO_GHOST+29
        11 003570   004675 602000 11                 TNC     SYN_MONTH_ERR

     1843    13946    4                     THEN
     1844    13947    4                          GOTO SYN_MONTH_ERR;
     1845    13948    4                IF (DO_DATER.M1 = '?' AND DO_DATER.M2 ~= ' ')

  13948 11 003571   000546 236000 1                  LDQ     DO_DATE
        11 003572   777000 376007                    ANQ     -512,DL
        11 003573   077000 116007                    CMPQ    32256,DL
        11 003574   003601 601000 11                 TNZ     s:13948+8
        11 003575   000546 236000 1                  LDQ     DO_DATE
        11 003576   000777 376007                    ANQ     511,DL
        11 003577   000040 116007                    CMPQ    32,DL
        11 003600   004675 601000 11                 TNZ     SYN_MONTH_ERR
        11 003601   000546 236000 1                  LDQ     DO_DATE
        11 003602   000777 376007                    ANQ     511,DL
        11 003603   000077 116007                    CMPQ    63,DL
        11 003604   004675 600000 11                 TZE     SYN_MONTH_ERR

     1846    13949    4                     OR DO_DATER.M2 = '?'
     1847    13950    4                THEN
     1848    13951    4                     GOTO SYN_MONTH_ERR;
     1849    13952    4                IF %SUB_BLOCK (1) -> OUT$SYM.COUNT = 1

  13952 11 003605   200033 470500                    LDP0    PTR$,,AUTO
        11 003606   000004 471500                    LDP1    4,,PR0
        11 003607   100004 236100                    LDQ     4,,PR1
        11 003610   777000 376003                    ANQ     -512,DU
        11 003611   001000 116003                    CMPQ    512,DU
        11 003612   003624 601000 11                 TNZ     s:13956

     1850    13953    4                THEN
     1851    13954    4                     CALL CONCAT(DO_DATE.DD,'0',%SUB_BLOCK(1) -> OUT$SYM.TEXT);

  13954 11 003613   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:217  
        11 003614   000033 772000                    QRL     27
        11 003615   000000 620006                    EAX0    0,QL
        11 003616   060000 236003                    LDQ     24576,DU
        11 003617   000550 552040 1                  STBQ    DO_DATE+2,'40'O
        11 003620   040000 100540                    MLR     fill='040'O
        11 003621   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        11 003622   000550 200001 1                  ADSC9   DO_DATE+2                cn=1,n=1
        11 003623   003632 710000 11                 TRA     s:13957

     1852    13955    4                ELSE
     1853    13956    4                     DO_DATE.DD = %SUB_BLOCK(1) -> OUT$SYM.TEXT;

  13956 11 003624   100004 236100                    LDQ     4,,PR1
        11 003625   000033 772000                    QRL     27
        11 003626   000000 620006                    EAX0    0,QL
        11 003627   040000 100540                    MLR     fill='040'O
        11 003630   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        11 003631   000550 000002 1                  ADSC9   DO_DATE+2                cn=0,n=2

     1854    13957    4                IF DO_DATE.DD = '0?' OR DO_DATE.DD = '??'

  13957 11 003632   000550 220000 1                  LDX0    DO_DATE+2
        11 003633   000041 100000 10                 CMPX0   NO_GHOST+27
        11 003634   003637 600000 11                 TZE     s:13959
        11 003635   000031 100000 10                 CMPX0   NO_GHOST+19
        11 003636   003642 601000 11                 TNZ     s:13962

     1855    13958    4                THEN
     1856    13959    4                     DO_DATE.DD = '?';

  13959 11 003637   077040 221003                    LDX1    32288,DU
        11 003640   000550 741000 1                  STX1    DO_DATE+2
        11 003641   004654 710000 11                 TRA     s:14246

     1857    13960    4                ELSE
     1858    13961    5                  DO;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:218  
     1859    13962    5                       IF DO_DATER.D1 = '?' OR DO_DATER.D2 = '?'

  13962 11 003642   000550 236000 1                  LDQ     DO_DATE+2
        11 003643   777000 376003                    ANQ     -512,DU
        11 003644   077000 116003                    CMPQ    32256,DU
        11 003645   004700 600000 11                 TZE     SYN_DAY_ERR
        11 003646   000550 236000 1                  LDQ     DO_DATE+2
        11 003647   000777 376003                    ANQ     511,DU
        11 003650   000077 116003                    CMPQ    63,DU
        11 003651   004700 600000 11                 TZE     SYN_DAY_ERR

     1860    13963    5                       THEN
     1861    13964    5                            GOTO SYN_DAY_ERR;
     1862    13965    5                       IF DO_DATE.DD > '31' OR DO_DATE.DD < '01'

  13965 11 003652   000044 221000 10                 LDX1    NO_GHOST+30
        11 003653   000550 101000 1                  CMPX1   DO_DATE+2
        11 003654   004700 602000 11                 TNC     SYN_DAY_ERR
        11 003655   000043 100000 10                 CMPX0   NO_GHOST+29
        11 003656   004700 602000 11                 TNC     SYN_DAY_ERR

     1863    13966    5                       THEN
     1864    13967    5                            GOTO SYN_DAY_ERR;
     1865    13968    5                       IF DO_DATE.MM = '04' OR

  13968 11 003657   000546 722000 1                  LXL2    DO_DATE
        11 003660   000045 102000 10                 CMPX2   NO_GHOST+31
        11 003661   003670 600000 11                 TZE     s:13973
        11 003662   000046 102000 10                 CMPX2   NO_GHOST+32
        11 003663   003670 600000 11                 TZE     s:13973
        11 003664   000047 102000 10                 CMPX2   NO_GHOST+33
        11 003665   003670 600000 11                 TZE     s:13973
        11 003666   000050 102000 10                 CMPX2   NO_GHOST+34
        11 003667   003673 601000 11                 TNZ     s:13976

     1866    13969    5                            DO_DATE.MM = '06' OR
     1867    13970    5                            DO_DATE.MM = '09' OR
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:219  
     1868    13971    5                            DO_DATE.MM = '11'
     1869    13972    5                       THEN                /* 30 day month */
     1870    13973    5                            IF DO_DATE.DD > '30'

  13973 11 003670   000051 223000 10                 LDX3    NO_GHOST+35
        11 003671   000550 103000 1                  CMPX3   DO_DATE+2
        11 003672   004700 602000 11                 TNC     SYN_DAY_ERR

     1871    13974    5                            THEN
     1872    13975    5                                 GOTO SYN_DAY_ERR;
     1873    13976    5                       IF DO_DATE.YY ~= '?'

  13976 11 003673   000546 223000 1                  LDX3    DO_DATE
        11 003674   077040 103003                    CMPX3   32288,DU
        11 003675   003702 600000 11                 TZE     s:13980

     1874    13977    5                       THEN
     1875    13978    5                            CALL CHARBIN(J,DO_DATE.YY); /* Convert year */

  13978 11 003676   000100 305400                    DTB
        11 003677   000546 030002 1                  NDSC9   DO_DATE                  cn=0,s=nosgn,sf=0,n=2
        11 003700   200076 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
        11 003701   003703 710000 11                 TRA     s:13981

     1876    13979    5                       ELSE
     1877    13980    5                            J = 0;

  13980 11 003702   200076 450100                    STZ     J,,AUTO

     1878    13981    5                       IF DO_DATE.MM = '02' /* Febuary */

  13981 11 003703   000052 102000 10                 CMPX2   NO_GHOST+36
        11 003704   004654 601000 11                 TNZ     s:14246

     1879    13982    5                       THEN
     1880    13983    5                            IF MOD(J,4) = 0

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:220  
  13983 11 003705   200076 236100                    LDQ     J,,AUTO
        11 003706   000004 506007                    DIV     4,DL
        11 003707   000044 733000                    LRS     36
        11 003710   000000 116003                    CMPQ    0,DU
        11 003711   003716 601000 11                 TNZ     s:13990

     1881    13984    6                            THEN DO;

     1882    13985    6                                   IF DO_DATE.MM > '29'

  13985 11 003712   000053 102000 10                 CMPX2   NO_GHOST+37
        11 003713   003715 600000 11                 TZE     s:13988
        11 003714   004700 603000 11                 TRC     SYN_DAY_ERR

     1883    13986    6                                   THEN
     1884    13987    6                                        GOTO SYN_DAY_ERR;
     1885    13988    6                                 END;      /*  Leap year  */

  13988 11 003715   004654 710000 11                 TRA     s:14246

     1886    13989    5                            ELSE
     1887    13990    5                                 IF DO_DATE.MM > '28'

  13990 11 003716   000054 102000 10                 CMPX2   NO_GHOST+38
        11 003717   003721 600000 11                 TZE     s:13993
        11 003720   004700 603000 11                 TRC     SYN_DAY_ERR

     1888    13991    5                                 THEN
     1889    13992    5                                      GOTO SYN_DAY_ERR;
     1890    13993    5                     END;                  /*  Wildcarded date */

  13993 11 003721   004654 710000 11                 TRA     s:14246

     1891    13994                                                /**/
     1892    13995                                                /**/
     1893    13996    4             CASE (%IA_GKEY_DATES#) ;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:221  
     1894    13997    4                IF %SUB_BLOCK (2) -> OUT$SYM.COUNT = 1

  13997 11 003722   100005 473500                    LDP3    5,,PR1
        11 003723   300004 236100                    LDQ     4,,PR3
        11 003724   777000 376003                    ANQ     -512,DU
        11 003725   001000 116003                    CMPQ    512,DU
        11 003726   004672 600000 11                 TZE     SYN_YEAR_ERR

     1895    13998    4                THEN
     1896    13999    4                     GOTO SYN_YEAR_ERR;
     1897    14000    4                ELSE
     1898    14001    4                     DO_BEGIN_RANGE.YY = %SUB_BLOCK(2) -> OUT$SYM.TEXT;

  14001 11 003727   300004 236100                    LDQ     4,,PR3
        11 003730   000033 772000                    QRL     27
        11 003731   000000 622006                    EAX2    0,QL
        11 003732   040100 100540                    MLR     fill='040'O
        11 003733   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
        11 003734   200102 000002                    ADSC9   DO_BEGIN_RANGE,,AUTO     cn=0,n=2

     1899    14002    4                IF (DO_BEGIN_SINGLE.Y1 = '?') OR (DO_BEGIN_SINGLE.Y2 = '?')

  14002 11 003735   200102 236100                    LDQ     DO_BEGIN_RANGE,,AUTO
        11 003736   777000 376003                    ANQ     -512,DU
        11 003737   077000 116003                    CMPQ    32256,DU
        11 003740   004703 600000 11                 TZE     SYN_NO_WILD_ERR
        11 003741   200102 236100                    LDQ     DO_BEGIN_RANGE,,AUTO
        11 003742   000777 376003                    ANQ     511,DU
        11 003743   000077 116003                    CMPQ    63,DU
        11 003744   004703 600000 11                 TZE     SYN_NO_WILD_ERR

     1900    14003    4                THEN
     1901    14004    4                     GOTO SYN_NO_WILD_ERR;
     1902    14005    4                IF %SUB_BLOCK (0) -> OUT$SYM.COUNT = 1

  14005 11 003745   100003 474500                    LDP4    3,,PR1
        11 003746   400004 236100                    LDQ     4,,PR4
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:222  
        11 003747   777000 376003                    ANQ     -512,DU
        11 003750   001000 116003                    CMPQ    512,DU
        11 003751   003763 601000 11                 TNZ     s:14009

     1903    14006    4                THEN
     1904    14007    4                     CALL CONCAT(DO_BEGIN_RANGE.MM,'0',%SUB_BLOCK(0) -> OUT$SYM.TEXT);

  14007 11 003752   400004 236100                    LDQ     4,,PR4
        11 003753   000033 772000                    QRL     27
        11 003754   000000 623006                    EAX3    0,QL
        11 003755   060000 236007                    LDQ     24576,DL
        11 003756   200102 552110                    STBQ    DO_BEGIN_RANGE,'10'O,AUTO
        11 003757   040100 100540                    MLR     fill='040'O
        11 003760   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
        11 003761   200102 600001                    ADSC9   DO_BEGIN_RANGE,,AUTO     cn=3,n=1
        11 003762   003771 710000 11                 TRA     s:14010

     1905    14008    4                ELSE
     1906    14009    4                     DO_BEGIN_RANGE.MM = %SUB_BLOCK(0) -> OUT$SYM.TEXT;

  14009 11 003763   400004 236100                    LDQ     4,,PR4
        11 003764   000033 772000                    QRL     27
        11 003765   000000 623006                    EAX3    0,QL
        11 003766   040100 100540                    MLR     fill='040'O
        11 003767   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
        11 003770   200102 400002                    ADSC9   DO_BEGIN_RANGE,,AUTO     cn=2,n=2

     1907    14010    4                IF DO_BEGIN_RANGE.MM > '12' OR DO_BEGIN_RANGE.MM < '01'

  14010 11 003771   200102 720100                    LXL0    DO_BEGIN_RANGE,,AUTO
        11 003772   000042 100000 10                 CMPX0   NO_GHOST+28
        11 003773   003775 600000 11                 TZE     s:14010+4
        11 003774   004675 603000 11                 TRC     SYN_MONTH_ERR
        11 003775   000043 100000 10                 CMPX0   NO_GHOST+29
        11 003776   004675 602000 11                 TNC     SYN_MONTH_ERR

     1908    14011    4                THEN
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:223  
     1909    14012    4                     GOTO SYN_MONTH_ERR;
     1910    14013    4                IF (DO_BEGIN_SINGLE.M1 = '?') OR (DO_BEGIN_SINGLE.M2 = '?')

  14013 11 003777   200102 236100                    LDQ     DO_BEGIN_RANGE,,AUTO
        11 004000   777000 376007                    ANQ     -512,DL
        11 004001   077000 116007                    CMPQ    32256,DL
        11 004002   004703 600000 11                 TZE     SYN_NO_WILD_ERR
        11 004003   200102 236100                    LDQ     DO_BEGIN_RANGE,,AUTO
        11 004004   000777 376007                    ANQ     511,DL
        11 004005   000077 116007                    CMPQ    63,DL
        11 004006   004703 600000 11                 TZE     SYN_NO_WILD_ERR

     1911    14014    4                THEN
     1912    14015    4                     GOTO SYN_NO_WILD_ERR;
     1913    14016    4                IF %SUB_BLOCK (1) -> OUT$SYM.COUNT = 1

  14016 11 004007   200033 470500                    LDP0    PTR$,,AUTO
        11 004010   000004 471500                    LDP1    4,,PR0
        11 004011   100004 236100                    LDQ     4,,PR1
        11 004012   777000 376003                    ANQ     -512,DU
        11 004013   001000 116003                    CMPQ    512,DU
        11 004014   004026 601000 11                 TNZ     s:14020

     1914    14017    4                THEN
     1915    14018    4                     CALL CONCAT(DO_BEGIN_RANGE.DD,'0',%SUB_BLOCK(1) -> OUT$SYM.TEXT);

  14018 11 004015   100004 236100                    LDQ     4,,PR1
        11 004016   000033 772000                    QRL     27
        11 004017   000000 621006                    EAX1    0,QL
        11 004020   060000 236003                    LDQ     24576,DU
        11 004021   200104 552140                    STBQ    DO_BEGIN_RANGE+2,'40'O,AUTO
        11 004022   040100 100540                    MLR     fill='040'O
        11 004023   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        11 004024   200104 200001                    ADSC9   DO_BEGIN_RANGE+2,,AUTO   cn=1,n=1
        11 004025   004034 710000 11                 TRA     s:14021

     1916    14019    4                ELSE
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:224  
     1917    14020    4                     DO_BEGIN_RANGE.DD = %SUB_BLOCK(1) -> OUT$SYM.TEXT;

  14020 11 004026   100004 236100                    LDQ     4,,PR1
        11 004027   000033 772000                    QRL     27
        11 004030   000000 621006                    EAX1    0,QL
        11 004031   040100 100540                    MLR     fill='040'O
        11 004032   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        11 004033   200104 000002                    ADSC9   DO_BEGIN_RANGE+2,,AUTO   cn=0,n=2

     1918    14021    4                IF DO_BEGIN_SINGLE.D1 = '?' OR DO_BEGIN_SINGLE.D2 = '?'

  14021 11 004034   200104 236100                    LDQ     DO_BEGIN_RANGE+2,,AUTO
        11 004035   777000 376003                    ANQ     -512,DU
        11 004036   077000 116003                    CMPQ    32256,DU
        11 004037   004703 600000 11                 TZE     SYN_NO_WILD_ERR
        11 004040   200104 236100                    LDQ     DO_BEGIN_RANGE+2,,AUTO
        11 004041   000777 376003                    ANQ     511,DU
        11 004042   000077 116003                    CMPQ    63,DU
        11 004043   004703 600000 11                 TZE     SYN_NO_WILD_ERR

     1919    14022    4                THEN
     1920    14023    4                     GOTO SYN_NO_WILD_ERR;
     1921    14024    4                IF DO_BEGIN_RANGE.DD > '31' OR DO_BEGIN_RANGE.DD < '01'

  14024 11 004044   000044 220000 10                 LDX0    NO_GHOST+30
        11 004045   200104 100100                    CMPX0   DO_BEGIN_RANGE+2,,AUTO
        11 004046   004700 602000 11                 TNC     SYN_DAY_ERR
        11 004047   200104 221100                    LDX1    DO_BEGIN_RANGE+2,,AUTO
        11 004050   000043 101000 10                 CMPX1   NO_GHOST+29
        11 004051   004700 602000 11                 TNC     SYN_DAY_ERR

     1922    14025    4                THEN
     1923    14026    4                     GOTO SYN_DAY_ERR;
     1924    14027    4                IF DO_BEGIN_RANGE.MM = '04' OR

  14027 11 004052   200102 722100                    LXL2    DO_BEGIN_RANGE,,AUTO
        11 004053   000045 102000 10                 CMPX2   NO_GHOST+31
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:225  
        11 004054   004063 600000 11                 TZE     s:14032
        11 004055   000046 102000 10                 CMPX2   NO_GHOST+32
        11 004056   004063 600000 11                 TZE     s:14032
        11 004057   000047 102000 10                 CMPX2   NO_GHOST+33
        11 004060   004063 600000 11                 TZE     s:14032
        11 004061   000050 102000 10                 CMPX2   NO_GHOST+34
        11 004062   004066 601000 11                 TNZ     s:14036

     1925    14028    4                     DO_BEGIN_RANGE.MM = '06' OR
     1926    14029    4                     DO_BEGIN_RANGE.MM = '09' OR
     1927    14030    4                     DO_BEGIN_RANGE.MM = '11'
     1928    14031    4                THEN                       /* 30 day month */
     1929    14032    4                     IF DO_BEGIN_RANGE.DD > '30'

  14032 11 004063   000051 223000 10                 LDX3    NO_GHOST+35
        11 004064   200104 103100                    CMPX3   DO_BEGIN_RANGE+2,,AUTO
        11 004065   004700 602000 11                 TNC     SYN_DAY_ERR

     1930    14033    4                     THEN
     1931    14034    4                          GOTO SYN_DAY_ERR;
     1932    14035
     1933    14036    4                CALL CHARBIN(J,DO_BEGIN_RANGE.YY); /* Convert year */

  14036 11 004066   000100 305500                    DTB
        11 004067   200102 030002                    NDSC9   DO_BEGIN_RANGE,,AUTO     cn=0,s=nosgn,sf=0,n=2
        11 004070   200076 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

     1934    14037    4                IF DO_BEGIN_RANGE.MM = '02' /* Febuary */

  14037 11 004071   000052 102000 10                 CMPX2   NO_GHOST+36
        11 004072   004107 601000 11                 TNZ     s:14050

     1935    14038    4                THEN
     1936    14039    4                     IF MOD(J,4) = 0

  14039 11 004073   200076 236100                    LDQ     J,,AUTO
        11 004074   000004 506007                    DIV     4,DL
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:226  
        11 004075   000044 733000                    LRS     36
        11 004076   000000 116003                    CMPQ    0,DU
        11 004077   004104 601000 11                 TNZ     s:14046

     1937    14040    5                     THEN DO;

     1938    14041    5                            IF DO_BEGIN_RANGE.MM > '29'

  14041 11 004100   000053 102000 10                 CMPX2   NO_GHOST+37
        11 004101   004103 600000 11                 TZE     s:14044
        11 004102   004700 603000 11                 TRC     SYN_DAY_ERR

     1939    14042    5                            THEN
     1940    14043    5                                 GOTO SYN_DAY_ERR;
     1941    14044    5                          END;             /*  Leap year  */

  14044 11 004103   004107 710000 11                 TRA     s:14050

     1942    14045    4                     ELSE
     1943    14046    4                          IF DO_BEGIN_RANGE.MM > '28'

  14046 11 004104   000054 102000 10                 CMPX2   NO_GHOST+38
        11 004105   004107 600000 11                 TZE     s:14050
        11 004106   004700 603000 11                 TRC     SYN_DAY_ERR

     1944    14047    4                          THEN
     1945    14048    4                               GOTO SYN_DAY_ERR;
     1946    14049                                                /**/
     1947    14050    4                IF %SUB_BLOCK (5) -> OUT$SYM.COUNT = 1

  14050 11 004107   200033 470500                    LDP0    PTR$,,AUTO
        11 004110   000010 471500                    LDP1    8,,PR0
        11 004111   100004 236100                    LDQ     4,,PR1
        11 004112   777000 376003                    ANQ     -512,DU
        11 004113   001000 116003                    CMPQ    512,DU
        11 004114   004672 600000 11                 TZE     SYN_YEAR_ERR

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:227  
     1948    14051    4                THEN
     1949    14052    4                     GOTO SYN_YEAR_ERR;
     1950    14053    4                ELSE
     1951    14054    4                     DO_END_RANGE.YY = %SUB_BLOCK(5) -> OUT$SYM.TEXT;

  14054 11 004115   100004 236100                    LDQ     4,,PR1
        11 004116   000033 772000                    QRL     27
        11 004117   000000 623006                    EAX3    0,QL
        11 004120   040100 100540                    MLR     fill='040'O
        11 004121   100004 200013                    ADSC9   4,,PR1                   cn=1,n=*X3
        11 004122   200105 000002                    ADSC9   DO_END_RANGE,,AUTO       cn=0,n=2

     1952    14055    4                IF (DO_END_SINGLE.Y1 = '?') OR (DO_END_SINGLE.Y2 = '?')

  14055 11 004123   200105 236100                    LDQ     DO_END_RANGE,,AUTO
        11 004124   777000 376003                    ANQ     -512,DU
        11 004125   077000 116003                    CMPQ    32256,DU
        11 004126   004703 600000 11                 TZE     SYN_NO_WILD_ERR
        11 004127   200105 236100                    LDQ     DO_END_RANGE,,AUTO
        11 004130   000777 376003                    ANQ     511,DU
        11 004131   000077 116003                    CMPQ    63,DU
        11 004132   004703 600000 11                 TZE     SYN_NO_WILD_ERR

     1953    14056    4                THEN
     1954    14057    4                     GOTO SYN_NO_WILD_ERR;
     1955    14058    4                IF %SUB_BLOCK (3) -> OUT$SYM.COUNT = 1

  14058 11 004133   000006 473500                    LDP3    6,,PR0
        11 004134   300004 236100                    LDQ     4,,PR3
        11 004135   777000 376003                    ANQ     -512,DU
        11 004136   001000 116003                    CMPQ    512,DU
        11 004137   004151 601000 11                 TNZ     s:14062

     1956    14059    4                THEN
     1957    14060    4                     CALL CONCAT(DO_END_RANGE.MM,'0',%SUB_BLOCK(3) -> OUT$SYM.TEXT);

  14060 11 004140   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:228  
        11 004141   000033 772000                    QRL     27
        11 004142   000000 624006                    EAX4    0,QL
        11 004143   060000 236007                    LDQ     24576,DL
        11 004144   200105 552110                    STBQ    DO_END_RANGE,'10'O,AUTO
        11 004145   040100 100540                    MLR     fill='040'O
        11 004146   300004 200014                    ADSC9   4,,PR3                   cn=1,n=*X4
        11 004147   200105 600001                    ADSC9   DO_END_RANGE,,AUTO       cn=3,n=1
        11 004150   004157 710000 11                 TRA     s:14063

     1958    14061    4                ELSE
     1959    14062    4                     DO_END_RANGE.MM = %SUB_BLOCK(3) -> OUT$SYM.TEXT;

  14062 11 004151   300004 236100                    LDQ     4,,PR3
        11 004152   000033 772000                    QRL     27
        11 004153   000000 624006                    EAX4    0,QL
        11 004154   040100 100540                    MLR     fill='040'O
        11 004155   300004 200014                    ADSC9   4,,PR3                   cn=1,n=*X4
        11 004156   200105 400002                    ADSC9   DO_END_RANGE,,AUTO       cn=2,n=2

     1960    14063    4                IF DO_END_RANGE.MM > '12' OR DO_END_RANGE.MM < '01'

  14063 11 004157   200105 720100                    LXL0    DO_END_RANGE,,AUTO
        11 004160   000042 100000 10                 CMPX0   NO_GHOST+28
        11 004161   004163 600000 11                 TZE     s:14063+4
        11 004162   004675 603000 11                 TRC     SYN_MONTH_ERR
        11 004163   000043 100000 10                 CMPX0   NO_GHOST+29
        11 004164   004675 602000 11                 TNC     SYN_MONTH_ERR

     1961    14064    4                THEN
     1962    14065    4                     GOTO SYN_MONTH_ERR;
     1963    14066    4                IF (DO_END_SINGLE.M1 = '?') OR (DO_END_SINGLE.M2 = '?')

  14066 11 004165   200105 236100                    LDQ     DO_END_RANGE,,AUTO
        11 004166   777000 376007                    ANQ     -512,DL
        11 004167   077000 116007                    CMPQ    32256,DL
        11 004170   004703 600000 11                 TZE     SYN_NO_WILD_ERR
        11 004171   200105 236100                    LDQ     DO_END_RANGE,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:229  
        11 004172   000777 376007                    ANQ     511,DL
        11 004173   000077 116007                    CMPQ    63,DL
        11 004174   004703 600000 11                 TZE     SYN_NO_WILD_ERR

     1964    14067    4                THEN
     1965    14068    4                     GOTO SYN_NO_WILD_ERR;
     1966    14069    4                IF %SUB_BLOCK (4) -> OUT$SYM.COUNT = 1

  14069 11 004175   200033 470500                    LDP0    PTR$,,AUTO
        11 004176   000007 471500                    LDP1    7,,PR0
        11 004177   100004 236100                    LDQ     4,,PR1
        11 004200   777000 376003                    ANQ     -512,DU
        11 004201   001000 116003                    CMPQ    512,DU
        11 004202   004214 601000 11                 TNZ     s:14073

     1967    14070    4                THEN
     1968    14071    4                     CALL CONCAT(DO_END_RANGE.DD,'0',%SUB_BLOCK(4) -> OUT$SYM.TEXT);

  14071 11 004203   100004 236100                    LDQ     4,,PR1
        11 004204   000033 772000                    QRL     27
        11 004205   000000 621006                    EAX1    0,QL
        11 004206   060000 236003                    LDQ     24576,DU
        11 004207   200107 552140                    STBQ    DO_END_RANGE+2,'40'O,AUTO
        11 004210   040100 100540                    MLR     fill='040'O
        11 004211   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        11 004212   200107 200001                    ADSC9   DO_END_RANGE+2,,AUTO     cn=1,n=1
        11 004213   004222 710000 11                 TRA     s:14074

     1969    14072    4                ELSE
     1970    14073    4                     DO_END_RANGE.DD = %SUB_BLOCK(4) -> OUT$SYM.TEXT;

  14073 11 004214   100004 236100                    LDQ     4,,PR1
        11 004215   000033 772000                    QRL     27
        11 004216   000000 621006                    EAX1    0,QL
        11 004217   040100 100540                    MLR     fill='040'O
        11 004220   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        11 004221   200107 000002                    ADSC9   DO_END_RANGE+2,,AUTO     cn=0,n=2
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:230  

     1971    14074    4                IF DO_END_SINGLE.D1 = '?' OR DO_END_SINGLE.D2 = '?'

  14074 11 004222   200107 236100                    LDQ     DO_END_RANGE+2,,AUTO
        11 004223   777000 376003                    ANQ     -512,DU
        11 004224   077000 116003                    CMPQ    32256,DU
        11 004225   004703 600000 11                 TZE     SYN_NO_WILD_ERR
        11 004226   200107 236100                    LDQ     DO_END_RANGE+2,,AUTO
        11 004227   000777 376003                    ANQ     511,DU
        11 004230   000077 116003                    CMPQ    63,DU
        11 004231   004703 600000 11                 TZE     SYN_NO_WILD_ERR

     1972    14075    4                THEN
     1973    14076    4                     GOTO SYN_NO_WILD_ERR;
     1974    14077    4                IF DO_END_RANGE.DD > '31' OR DO_END_RANGE.DD < '01'

  14077 11 004232   000044 220000 10                 LDX0    NO_GHOST+30
        11 004233   200107 100100                    CMPX0   DO_END_RANGE+2,,AUTO
        11 004234   004700 602000 11                 TNC     SYN_DAY_ERR
        11 004235   200107 221100                    LDX1    DO_END_RANGE+2,,AUTO
        11 004236   000043 101000 10                 CMPX1   NO_GHOST+29
        11 004237   004700 602000 11                 TNC     SYN_DAY_ERR

     1975    14078    4                THEN
     1976    14079    4                     GOTO SYN_DAY_ERR;
     1977    14080    4                IF DO_END_RANGE.MM = '04' OR

  14080 11 004240   200105 722100                    LXL2    DO_END_RANGE,,AUTO
        11 004241   000045 102000 10                 CMPX2   NO_GHOST+31
        11 004242   004251 600000 11                 TZE     s:14085
        11 004243   000046 102000 10                 CMPX2   NO_GHOST+32
        11 004244   004251 600000 11                 TZE     s:14085
        11 004245   000047 102000 10                 CMPX2   NO_GHOST+33
        11 004246   004251 600000 11                 TZE     s:14085
        11 004247   000050 102000 10                 CMPX2   NO_GHOST+34
        11 004250   004254 601000 11                 TNZ     s:14089

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:231  
     1978    14081    4                     DO_END_RANGE.MM = '06' OR
     1979    14082    4                     DO_END_RANGE.MM = '09' OR
     1980    14083    4                     DO_END_RANGE.MM = '11'
     1981    14084    4                THEN                       /* 30 day month */
     1982    14085    4                     IF DO_END_RANGE.DD > '30'

  14085 11 004251   000051 223000 10                 LDX3    NO_GHOST+35
        11 004252   200107 103100                    CMPX3   DO_END_RANGE+2,,AUTO
        11 004253   004700 602000 11                 TNC     SYN_DAY_ERR

     1983    14086    4                     THEN
     1984    14087    4                          GOTO SYN_DAY_ERR;
     1985    14088
     1986    14089    4                CALL CHARBIN(J,DO_END_RANGE.YY); /* Convert year */

  14089 11 004254   000100 305500                    DTB
        11 004255   200105 030002                    NDSC9   DO_END_RANGE,,AUTO       cn=0,s=nosgn,sf=0,n=2
        11 004256   200076 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

     1987    14090    4                IF DO_END_RANGE.MM = '02'  /* Febuary */

  14090 11 004257   000052 102000 10                 CMPX2   NO_GHOST+36
        11 004260   004275 601000 11                 TNZ     s:14106

     1988    14091    4                THEN
     1989    14092    4                     IF MOD(J,4) = 0

  14092 11 004261   200076 236100                    LDQ     J,,AUTO
        11 004262   000004 506007                    DIV     4,DL
        11 004263   000044 733000                    LRS     36
        11 004264   000000 116003                    CMPQ    0,DU
        11 004265   004272 601000 11                 TNZ     s:14100

     1990    14093    4                     THEN
     1991    14094    5                       DO;

     1992    14095    5                            IF DO_END_RANGE.MM > '29'
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:232  

  14095 11 004266   000053 102000 10                 CMPX2   NO_GHOST+37
        11 004267   004271 600000 11                 TZE     s:14098
        11 004270   004700 603000 11                 TRC     SYN_DAY_ERR

     1993    14096    5                            THEN
     1994    14097    5                                 GOTO SYN_DAY_ERR;
     1995    14098    5                          END;             /*  Leap year  */

  14098 11 004271   004275 710000 11                 TRA     s:14106

     1996    14099    4                     ELSE
     1997    14100    4                          IF DO_END_RANGE.MM > '28'

  14100 11 004272   000054 102000 10                 CMPX2   NO_GHOST+38
        11 004273   004275 600000 11                 TZE     s:14106
        11 004274   004700 603000 11                 TRC     SYN_DAY_ERR

     1998    14101    4                          THEN
     1999    14102    4                               GOTO SYN_DAY_ERR;
     2000    14103                                                /**/
     2001    14104                            /*  Convert the two dates to a form easier to
     2002    14105                                compare.             */
     2003    14106    4                CALL CHARBIN (CONV_YR, DO_BEGIN_RANGE.YY);

  14106 11 004275   000100 305500                    DTB
        11 004276   200102 030002                    NDSC9   DO_BEGIN_RANGE,,AUTO     cn=0,s=nosgn,sf=0,n=2
        11 004277   200116 000010                    NDSC9   CONV_CURRENT+1,,AUTO     cn=0,s=lsgnf,sf=0,n=8
        11 004300   200117 235100                    LDA     CONV_CURRENT+2,,AUTO
        11 004301   200110 755100                    STA     CONV_YR,,AUTO

     2004    14107    4                CALL CHARBIN (CONV_MO, DO_BEGIN_RANGE.MM);

  14107 11 004302   000100 305500                    DTB
        11 004303   200102 430002                    NDSC9   DO_BEGIN_RANGE,,AUTO     cn=2,s=nosgn,sf=0,n=2
        11 004304   200116 000010                    NDSC9   CONV_CURRENT+1,,AUTO     cn=0,s=lsgnf,sf=0,n=8
        11 004305   200117 236100                    LDQ     CONV_CURRENT+2,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:233  
        11 004306   200111 756100                    STQ     CONV_MO,,AUTO

     2005    14108    4                CALL CHARBIN (CONV_DY, DO_BEGIN_RANGE.DD);

  14108 11 004307   000100 305500                    DTB
        11 004310   200104 030002                    NDSC9   DO_BEGIN_RANGE+2,,AUTO   cn=0,s=nosgn,sf=0,n=2
        11 004311   200116 000010                    NDSC9   CONV_CURRENT+1,,AUTO     cn=0,s=lsgnf,sf=0,n=8
        11 004312   200117 235100                    LDA     CONV_CURRENT+2,,AUTO
        11 004313   200112 755100                    STA     CONV_DY,,AUTO

     2006    14109                            /*  Check for year 2000 (i.e., yr >= 0 and <= 21)
     2007    14110                                                      */
     2008    14111    4                IF CONV_YR <= 21

  14111 11 004314   200110 235100                    LDA     CONV_YR,,AUTO
        11 004315   000026 115007                    CMPA    22,DL
        11 004316   004321 603000 11                 TRC     s:14115

     2009    14112    4                THEN CONV_YR = CONV_YR + 100;

  14112 11 004317   000144 035007                    ADLA    100,DL
        11 004320   200110 755100                    STA     CONV_YR,,AUTO

     2010    14113                            /*  Add 100 if century is 2000
     2011    14114                                                      */
     2012    14115    4                CONV_BEGIN = (CONV_YR * 10000) + (CONV_MO * 100) + CONV_DY;

  14115 11 004321   200110 236100                    LDQ     CONV_YR,,AUTO
        11 004322   000144 402007                    MPY     100,DL
        11 004323   200111 036100                    ADLQ    CONV_MO,,AUTO
        11 004324   000144 402007                    MPY     100,DL
        11 004325   200112 036100                    ADLQ    CONV_DY,,AUTO
        11 004326   200113 756100                    STQ     CONV_BEGIN,,AUTO

     2013    14116    4                CALL CHARBIN (CONV_YR, DO_END_RANGE.YY);

  14116 11 004327   000100 305500                    DTB
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:234  
        11 004330   200105 030002                    NDSC9   DO_END_RANGE,,AUTO       cn=0,s=nosgn,sf=0,n=2
        11 004331   200116 000010                    NDSC9   CONV_CURRENT+1,,AUTO     cn=0,s=lsgnf,sf=0,n=8
        11 004332   200117 235100                    LDA     CONV_CURRENT+2,,AUTO
        11 004333   200110 755100                    STA     CONV_YR,,AUTO

     2014    14117    4                CALL CHARBIN (CONV_MO, DO_END_RANGE.MM);

  14117 11 004334   000100 305500                    DTB
        11 004335   200105 430002                    NDSC9   DO_END_RANGE,,AUTO       cn=2,s=nosgn,sf=0,n=2
        11 004336   200116 000010                    NDSC9   CONV_CURRENT+1,,AUTO     cn=0,s=lsgnf,sf=0,n=8
        11 004337   200117 235100                    LDA     CONV_CURRENT+2,,AUTO
        11 004340   200111 755100                    STA     CONV_MO,,AUTO

     2015    14118    4                CALL CHARBIN (CONV_DY, DO_END_RANGE.DD);

  14118 11 004341   000100 305500                    DTB
        11 004342   200107 030002                    NDSC9   DO_END_RANGE+2,,AUTO     cn=0,s=nosgn,sf=0,n=2
        11 004343   200116 000010                    NDSC9   CONV_CURRENT+1,,AUTO     cn=0,s=lsgnf,sf=0,n=8
        11 004344   200117 235100                    LDA     CONV_CURRENT+2,,AUTO
        11 004345   200112 755100                    STA     CONV_DY,,AUTO

     2016    14119                            /*  Check for year 2000 (i.e., yr >= 0 and <= 21)
     2017    14120                                                      */
     2018    14121    4                IF CONV_YR <= 21

  14121 11 004346   200110 235100                    LDA     CONV_YR,,AUTO
        11 004347   000026 115007                    CMPA    22,DL
        11 004350   004353 603000 11                 TRC     s:14125

     2019    14122    4                THEN CONV_YR = CONV_YR + 100;

  14122 11 004351   000144 035007                    ADLA    100,DL
        11 004352   200110 755100                    STA     CONV_YR,,AUTO

     2020    14123                            /*  Add 100 if century is 2000
     2021    14124                                                      */
     2022    14125    4                CONV_END = (CONV_YR * 10000) + (CONV_MO * 100) + CONV_DY;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:235  

  14125 11 004353   200110 236100                    LDQ     CONV_YR,,AUTO
        11 004354   000144 402007                    MPY     100,DL
        11 004355   200111 036100                    ADLQ    CONV_MO,,AUTO
        11 004356   000144 402007                    MPY     100,DL
        11 004357   200112 036100                    ADLQ    CONV_DY,,AUTO
        11 004360   200114 756100                    STQ     CONV_END,,AUTO

     2023    14126                                 /* Now make sure that the end date is after
     2024    14127                                      the begin date */
     2025    14128    4                IF CONV_BEGIN > CONV_END

  14128 11 004361   200113 116100                    CMPQ    CONV_BEGIN,,AUTO
        11 004362   004706 602000 11                 TNC     SYN_DATE_RANGE_ERR

     2026    14129    4                THEN
     2027    14130    4                     GOTO SYN_DATE_RANGE_ERR;
     2028    14131                                                /**/
     2029    14132                                      /*
     2030    14133                                           The range is set up correctly.
     2031    14134                                           Now determine if the current date
     2032    14135                                           falls within the range.
     2033    14136                                      */
     2034    14137                                      /*
     2035    14138                                           First convert the current date
     2036    14139                                           to the same format we have already
     2037    14140                                           converted the range dates to.
     2038    14141                                           Then check current date against
     2039    14142                                           beginning of range.  If it is less
     2040    14143                                           than, issue warning, and set up
     2041    14144                                           DO_DATE = to beginning of range.
     2042    14145                                      */
     2043    14146    4                CALL CHARBIN (CONV_YR, TEXT_DATE.YR);

  14146 11 004363   000100 305400                    DTB
        11 004364   003550 030002 1                  NDSC9   TEXT_DATE                cn=0,s=nosgn,sf=0,n=2
        11 004365   200116 000010                    NDSC9   CONV_CURRENT+1,,AUTO     cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:236  
        11 004366   200117 235100                    LDA     CONV_CURRENT+2,,AUTO
        11 004367   200110 755100                    STA     CONV_YR,,AUTO

     2044    14147    4                CALL CHARBIN (CONV_MO, TEXT_DATE.MON);

  14147 11 004370   000100 305400                    DTB
        11 004371   003550 430002 1                  NDSC9   TEXT_DATE                cn=2,s=nosgn,sf=0,n=2
        11 004372   200116 000010                    NDSC9   CONV_CURRENT+1,,AUTO     cn=0,s=lsgnf,sf=0,n=8
        11 004373   200117 235100                    LDA     CONV_CURRENT+2,,AUTO
        11 004374   200111 755100                    STA     CONV_MO,,AUTO

     2045    14148    4                CALL CHARBIN (CONV_DY, TEXT_DATE.DAY);

  14148 11 004375   000100 305400                    DTB
        11 004376   003551 030002 1                  NDSC9   TEXT_DATE+1              cn=0,s=nosgn,sf=0,n=2
        11 004377   200116 000010                    NDSC9   CONV_CURRENT+1,,AUTO     cn=0,s=lsgnf,sf=0,n=8
        11 004400   200117 235100                    LDA     CONV_CURRENT+2,,AUTO
        11 004401   200112 755100                    STA     CONV_DY,,AUTO

     2046    14149                            /*  Check for year 2000 (i.e., yr >= 0 and <= 21)
     2047    14150                                                      */
     2048    14151    4                IF CONV_YR <= 21

  14151 11 004402   200110 235100                    LDA     CONV_YR,,AUTO
        11 004403   000026 115007                    CMPA    22,DL
        11 004404   004407 603000 11                 TRC     s:14155

     2049    14152    4                THEN CONV_YR = CONV_YR + 100;

  14152 11 004405   000144 035007                    ADLA    100,DL
        11 004406   200110 755100                    STA     CONV_YR,,AUTO

     2050    14153                            /*  Add 100 if century is 2000
     2051    14154                                                      */
     2052    14155    4                CONV_CURRENT = (CONV_YR * 10000) + (CONV_MO * 100) + CONV_DY;

  14155 11 004407   200110 236100                    LDQ     CONV_YR,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:237  
        11 004410   000144 402007                    MPY     100,DL
        11 004411   200111 036100                    ADLQ    CONV_MO,,AUTO
        11 004412   000144 402007                    MPY     100,DL
        11 004413   200112 036100                    ADLQ    CONV_DY,,AUTO
        11 004414   200115 756100                    STQ     CONV_CURRENT,,AUTO

     2053    14156    4                IF CONV_CURRENT < CONV_BEGIN

  14156 11 004415   200113 116100                    CMPQ    CONV_BEGIN,,AUTO
        11 004416   004435 603000 11                 TRC     s:14170

     2054    14157    5                THEN DO;

     2055    14158    5                       CALL IAE$ERROR (ON_LINE,%E$IA_BEFORE_RANGE_WARN#,0,%
             14158                                IA_KEY_DATE_WARN#,EGG_GETCMD.PCB$);

  14158 11 004417   000111 630400 12                 EPPR0   73
        11 004420   000023 631400 xsym               EPPR1   B_VECTNIL+19
        11 004421   000000 701000 xent               TSX1    IAE$ERROR
        11 004422   000000 011000                    NOP     0

     2056    14159    5                       ERROR.ERR# = %E$SYNERR;

  14159 11 004423   004132 236000 1                  LDQ     ERROR
        11 004424   000116 376000 12                 ANQ     78
        11 004425   000010 276007                    ORQ     8,DL
        11 004426   004132 756000 1                  STQ     ERROR

     2057    14160    5                       DO_DATE = DO_BEGIN_RANGE;

  14160 11 004427   000000 100500                    MLR     fill='000'O
        11 004430   200102 000012                    ADSC9   DO_BEGIN_RANGE,,AUTO     cn=0,n=10
        11 004431   000546 000012 1                  ADSC9   DO_DATE                  cn=0,n=10

     2058    14161    5                       DO_DATE.ERROR = 0;

  14161 11 004432   000547 450000 1                  STZ     DO_DATE+1
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:238  

     2059    14162    5                       RETURN;

  14162 11 004433   200074 221300                    LDX1  ! BUF_START+1,,AUTO
        11 004434   000001 702211                    TSX2  ! 1,X1

     2060    14163    5                     END;
     2061    14164                                      /*
     2062    14165                                           Now check current date against
     2063    14166                                           end of range.  If it is greater
     2064    14167                                           than, issue warning, and set up
     2065    14168                                           DO_DATE = to end of range.
     2066    14169                                      */
     2067    14170    4                IF CONV_CURRENT > CONV_END

  14170 11 004435   200114 116100                    CMPQ    CONV_END,,AUTO
        11 004436   004456 602000 11                 TNC     s:14182
        11 004437   004456 600000 11                 TZE     s:14182

     2068    14171    5                THEN DO;

     2069    14172    5                       CALL IAE$ERROR (ON_LINE,%E$IA_AFTER_RANGE_WARN#,0,%
             14172                                IA_KEY_DATE_WARN#,EGG_GETCMD.PCB$);

  14172 11 004440   000120 630400 12                 EPPR0   80
        11 004441   000023 631400 xsym               EPPR1   B_VECTNIL+19
        11 004442   000000 701000 xent               TSX1    IAE$ERROR
        11 004443   000000 011000                    NOP     0

     2070    14173    5                       ERROR.ERR# = %E$SYNERR;

  14173 11 004444   004132 236000 1                  LDQ     ERROR
        11 004445   000116 376000 12                 ANQ     78
        11 004446   000010 276007                    ORQ     8,DL
        11 004447   004132 756000 1                  STQ     ERROR

     2071    14174    5                       DO_DATE = DO_END_RANGE;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:239  

  14174 11 004450   000000 100500                    MLR     fill='000'O
        11 004451   200105 000012                    ADSC9   DO_END_RANGE,,AUTO       cn=0,n=10
        11 004452   000546 000012 1                  ADSC9   DO_DATE                  cn=0,n=10

     2072    14175    5                       DO_DATE.ERROR = 0;

  14175 11 004453   000547 450000 1                  STZ     DO_DATE+1

     2073    14176    5                       RETURN;

  14176 11 004454   200074 221300                    LDX1  ! BUF_START+1,,AUTO
        11 004455   000001 702211                    TSX2  ! 1,X1

     2074    14177    5                     END;
     2075    14178                                      /*
     2076    14179                                           Everything is copeasetic.
     2077    14180                                           set up current date in DO_DATE.
     2078    14181                                      */
     2079    14182    4                DO_DATE.YY = TEXT_DATE.YR;

  14182 11 004456   003550 223000 1                  LDX3    TEXT_DATE
        11 004457   000546 743000 1                  STX3    DO_DATE

     2080    14183    4                DO_DATE.MM = TEXT_DATE.MON;

  14183 11 004460   003550 724000 1                  LXL4    TEXT_DATE
        11 004461   000546 444000 1                  SXL4    DO_DATE

     2081    14184    4                DO_DATE.DD = TEXT_DATE.DAY;

  14184 11 004462   003551 225000 1                  LDX5    TEXT_DATE+1
        11 004463   000550 745000 1                  STX5    DO_DATE+2

     2082    14185    4                DO_DATE.ERROR = 0;

  14185 11 004464   000547 450000 1                  STZ     DO_DATE+1
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:240  
        11 004465   004654 710000 11                 TRA     s:14246

     2083    14186                                                /**/
     2084    14187                                                /**/
     2085    14188    4             CASE (%IA_GKEY_CMD#);

     2086    14189    4                DO_CMD = PTR$ -> OUT$SYM.TEXT;

  14189 11 004466   100004 236100                    LDQ     4,,PR1
        11 004467   000033 772000                    QRL     27
        11 004470   000000 622006                    EAX2    0,QL
        11 004471   040000 100540                    MLR     fill='040'O
        11 004472   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        11 004473   000446 000400 1                  ADSC9   DO_CMD                   cn=0,n=256

     2087    14190    4                DO_CMD_SIZE = PTR$ -> OUT$SYM.COUNT;

  14190 11 004474   100004 236100                    LDQ     4,,PR1
        11 004475   000033 772000                    QRL     27
        11 004476   000033 736000                    QLS     27
        11 004477   200003 756100                    STQ     DO_CMD_SIZE,,AUTO

     2088    14191    4                IF DO_TYPE = %IA_CMD_DO# /* Keyin node */ THEN

  14191 11 004500   200024 236100                    LDQ     DO_TYPE,,AUTO
        11 004501   777000 316003                    CANQ    -512,DU
        11 004502   004522 601000 11                 TNZ     s:14198

     2089    14192    5                     IF DO_CMD_SIZE > 80 THEN DO;

  14192 11 004503   200003 236100                    LDQ     DO_CMD_SIZE,,AUTO
        11 004504   777000 376003                    ANQ     -512,DU
        11 004505   121000 116003                    CMPQ    41472,DU
        11 004506   004654 602000 11                 TNC     s:14246

     2090    14193    5                            CALL IAE$ERROR (ON_LINE,%E$IA_CMD_TOO_BIG_ERR#,0,%
             14193                                     IA_KEY_SYNTAX_ERR#,EGG_GETCMD.PCB$);
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:241  

  14193 11 004507   000126 630400 12                 EPPR0   86
        11 004510   000023 631400 xsym               EPPR1   B_VECTNIL+19
        11 004511   000000 701000 xent               TSX1    IAE$ERROR
        11 004512   000000 011000                    NOP     0

     2091    14194    5                            ERROR.ERR# = %E$SYNERR;

  14194 11 004513   004132 236000 1                  LDQ     ERROR
        11 004514   000116 376000 12                 ANQ     78
        11 004515   000010 276007                    ORQ     8,DL
        11 004516   004132 756000 1                  STQ     ERROR

     2092    14195    5                            DO_CMD_SIZE = 80;

  14195 11 004517   120000 236003                    LDQ     40960,DU
        11 004520   200003 756100                    STQ     DO_CMD_SIZE,,AUTO

     2093    14196    5                          END;             /* Size > 80 */

  14196 11 004521   004654 710000 11                 TRA     s:14246

     2094    14197    4                     ELSE ;
     2095    14198    5                ELSE IF DO_CMD_SIZE > 256 THEN DO;

  14198 11 004522   200003 236100                    LDQ     DO_CMD_SIZE,,AUTO
        11 004523   777000 376003                    ANQ     -512,DU
        11 004524   401000 116003                    CMPQ    -130560,DU
        11 004525   004654 602000 11                 TNC     s:14246

     2096    14199    5                            CALL IAE$ERROR (ON_LINE,%E$IA_CMD_TOO_BIG_ERR#,0,%
             14199                                     IA_KEY_SYNTAX_ERR#,EGG_GETCMD.PCB$);

  14199 11 004526   000126 630400 12                 EPPR0   86
        11 004527   000023 631400 xsym               EPPR1   B_VECTNIL+19
        11 004530   000000 701000 xent               TSX1    IAE$ERROR
        11 004531   000000 011000                    NOP     0
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:242  

     2097    14200    5                            ERROR.ERR# = %E$SYNERR;

  14200 11 004532   004132 236000 1                  LDQ     ERROR
        11 004533   000116 376000 12                 ANQ     78
        11 004534   000010 276007                    ORQ     8,DL
        11 004535   004132 756000 1                  STQ     ERROR

     2098    14201    5                            DO_CMD_SIZE = 256;

  14201 11 004536   400000 236003                    LDQ     -131072,DU
        11 004537   200003 756100                    STQ     DO_CMD_SIZE,,AUTO

     2099    14202    5                          END;             /* Size > 256 */

  14202 11 004540   004654 710000 11                 TRA     s:14246

     2100    14203                                                /**/
     2101    14204                                                /**/
     2102    14205    4             CASE (%IA_GKEY_UNAME#);

     2103    14206    4                DO_FID.TEXT = PTR$ -> OUT$SYM.TEXT;

  14206 11 004541   100004 236100                    LDQ     4,,PR1
        11 004542   000033 772000                    QRL     27
        11 004543   000000 622006                    EAX2    0,QL
        11 004544   040100 100540                    MLR     fill='040'O
        11 004545   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        11 004546   200013 200023                    ADSC9   DO_FID,,AUTO             cn=1,n=19

     2104    14207    4                DO_FID.SIZE = PTR$ -> OUT$SYM.COUNT;

  14207 11 004547   100004 236100                    LDQ     4,,PR1
        11 004550   200013 552140                    STBQ    DO_FID,'40'O,AUTO
        11 004551   004654 710000 11                 TRA     s:14246

     2105    14208                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:243  
     2106    14209                                                /**/
     2107    14210    4             CASE (%IA_GKEY_ACCT#);        /* Account specified */

     2108    14211    4                DO_ACCT = PTR$ -> OUT$SYM.TEXT;

  14211 11 004552   100004 236100                    LDQ     4,,PR1
        11 004553   000033 772000                    QRL     27
        11 004554   000000 622006                    EAX2    0,QL
        11 004555   040000 100540                    MLR     fill='040'O
        11 004556   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        11 004557   000444 000010 1                  ADSC9   DO_ACCT                  cn=0,n=8
        11 004560   004654 710000 11                 TRA     s:14246

     2109    14212
     2110    14213                                                /**/
     2111    14214                                                /* Password specified */
     2112    14215                                                /**/
     2113    14216    4             CASE (%IA_GKEY_PASS#);

     2114    14217    4                DO_PASS = PTR$ -> OUT$SYM.TEXT;

  14217 11 004561   100004 236100                    LDQ     4,,PR1
        11 004562   000033 772000                    QRL     27
        11 004563   000000 622006                    EAX2    0,QL
        11 004564   040000 100540                    MLR     fill='040'O
        11 004565   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        11 004566   000551 000010 1                  ADSC9   DO_PASS                  cn=0,n=8
        11 004567   004654 710000 11                 TRA     s:14246

     2115    14218
     2116    14219    4             CASE (%IA_GKEY_FROM#);        /* From specifed */

     2117    14220    4                CALL CHARBIN(DO_FROM,%SUB_BLOCK(0) -> OUT$SYM.TEXT);

  14220 11 004570   100003 473500                    LDP3    3,,PR1
        11 004571   300004 236100                    LDQ     4,,PR3
        11 004572   000033 772000                    QRL     27
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:244  
        11 004573   000000 622006                    EAX2    0,QL
        11 004574   000100 305540                    DTB
        11 004575   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
        11 004576   200020 000004                    NDSC9   DO_FROM,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     2118    14221    4                CALL CHARBIN(K,%SUB_BLOCK(1) -> OUT$SYM.TEXT);

  14221 11 004577   100004 474500                    LDP4    4,,PR1
        11 004600   400004 236100                    LDQ     4,,PR4
        11 004601   000033 772000                    QRL     27
        11 004602   000000 623006                    EAX3    0,QL
        11 004603   000100 305540                    DTB
        11 004604   400004 230013                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X3
        11 004605   200077 000004                    NDSC9   K,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

     2119    14222    4                IF DO_FROM > 23 THEN GOTO SYN_TIME_ERR; /* Bad hour */

  14222 11 004606   200020 235100                    LDA     DO_FROM,,AUTO
        11 004607   000027 115007                    CMPA    23,DL
        11 004610   004664 605400 11                 TPNZ    SYN_TIME_ERR

     2120    14223    4                IF K > 59 THEN GOTO SYN_TIME_ERR; /* Bad minutes */

  14223 11 004611   200077 235100                    LDA     K,,AUTO
        11 004612   000073 115007                    CMPA    59,DL
        11 004613   004664 605400 11                 TPNZ    SYN_TIME_ERR

     2121    14224    4                DO_FROM = DO_FROM * 60 + K; /* Calculate start min */

  14224 11 004614   200020 236100                    LDQ     DO_FROM,,AUTO
        11 004615   000074 402007                    MPY     60,DL
        11 004616   200077 036100                    ADLQ    K,,AUTO
        11 004617   200020 756100                    STQ     DO_FROM,,AUTO
        11 004620   004654 710000 11                 TRA     s:14246

     2122    14225                                                /**/
     2123    14226                                                /**/
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:245  
     2124    14227                                                /**/
     2125    14228                                                /**/
     2126    14229    4             CASE (%IA_GKEY_UNTIL#);       /* Until specifed */

     2127    14230    4                CALL CHARBIN(DO_UNTIL,%SUB_BLOCK(0) -> OUT$SYM.TEXT);

  14230 11 004621   100003 473500                    LDP3    3,,PR1
        11 004622   300004 236100                    LDQ     4,,PR3
        11 004623   000033 772000                    QRL     27
        11 004624   000000 622006                    EAX2    0,QL
        11 004625   000100 305540                    DTB
        11 004626   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
        11 004627   200026 000004                    NDSC9   DO_UNTIL,,AUTO           cn=0,s=lsgnf,sf=0,n=4

     2128    14231    4                CALL CHARBIN(K,%SUB_BLOCK(1) -> OUT$SYM.TEXT);

  14231 11 004630   100004 474500                    LDP4    4,,PR1
        11 004631   400004 236100                    LDQ     4,,PR4
        11 004632   000033 772000                    QRL     27
        11 004633   000000 623006                    EAX3    0,QL
        11 004634   000100 305540                    DTB
        11 004635   400004 230013                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X3
        11 004636   200077 000004                    NDSC9   K,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

     2129    14232    4                IF DO_UNTIL > 23 THEN GOTO SYN_TIME_ERR; /* Bad hour */

  14232 11 004637   200026 235100                    LDA     DO_UNTIL,,AUTO
        11 004640   000027 115007                    CMPA    23,DL
        11 004641   004664 605400 11                 TPNZ    SYN_TIME_ERR

     2130    14233    4                IF K > 59 THEN GOTO SYN_TIME_ERR; /* Bad minutes */

  14233 11 004642   200077 235100                    LDA     K,,AUTO
        11 004643   000073 115007                    CMPA    59,DL
        11 004644   004664 605400 11                 TPNZ    SYN_TIME_ERR

     2131    14234    4                DO_UNTIL = DO_UNTIL * 60 + K; /* Calculate end min */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:246  

  14234 11 004645   200026 236100                    LDQ     DO_UNTIL,,AUTO
        11 004646   000074 402007                    MPY     60,DL
        11 004647   200077 036100                    ADLQ    K,,AUTO
        11 004650   200026 756100                    STQ     DO_UNTIL,,AUTO

     2132    14235    4                IF DO_UNTIL < DO_FROM THEN GOTO SYN_TIME_RANGE_ERR;

  14235 11 004651   200020 116100                    CMPQ    DO_FROM,,AUTO
        11 004652   004667 604000 11                 TMI     SYN_TIME_RANGE_ERR
        11 004653   004654 710000 11                 TRA     s:14246

     2133    14236                                                /**/
     2134    14237                                                /**/
     2135    14238    4             CASE ( %IA_GKEY_TESTMODE#);

     2136    14239
     2137    14240                                                /*  Do nothing  */
     2138    14241                                           /*  The table is necessarily complete yet  */
     2139    14242
     2140    14243                                                /**/
     2141    14244                                                /**/
     2142    14245    4             END;                          /* End cases */

     2143    14246    3           END;                            /* End sub command */

  14246 11 004654   200075 054100                    AOS     I,,AUTO
        11 004655   000227 470400 1                  LDP0    EGG_GETCMD+1
        11 004656   000001 236100                    LDQ     1,,PR0
        11 004657   000022 772000                    QRL     18
        11 004660   200075 116100                    CMPQ    I,,AUTO
        11 004661   003170 605400 11                 TPNZ    s:13851

     2144    14247    2        RETURN;                            /* Command is parsed */

  14247 11 004662   200074 221300                    LDX1  ! BUF_START+1,,AUTO
        11 004663   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:247  

     2145    14248                                                /**/
     2146    14249    2   SYN_TIME_ERR: SYN_ERR = %E$IA_TIME_ERR#; GOTO RPT_SYN;

  14249 11 004664   000012 235007       SYN_TIME_ERR LDA     10,DL
        11 004665   200101 755100                    STA     SYN_ERR,,AUTO

  14249 11 004666   004711 710000 11                 TRA     RPT_SYN

     2147    14250    2   SYN_TIME_RANGE_ERR: SYN_ERR = %E$IA_TIME_RANGE_ERR#; GOTO RPT_SYN;

  14250 11 004667   000042 235007       SYN_TIME_RA* LDA     34,DL
        11 004670   200101 755100                    STA     SYN_ERR,,AUTO

  14250 11 004671   004711 710000 11                 TRA     RPT_SYN

     2148    14251    2   SYN_YEAR_ERR: SYN_ERR = %E$IA_YEAR_ERR#; GOTO RPT_SYN;

  14251 11 004672   000033 235007       SYN_YEAR_ERR LDA     27,DL
        11 004673   200101 755100                    STA     SYN_ERR,,AUTO

  14251 11 004674   004711 710000 11                 TRA     RPT_SYN

     2149    14252    2   SYN_MONTH_ERR: SYN_ERR = %E$IA_MONTH_ERR#; GOTO RPT_SYN;

  14252 11 004675   000034 235007       SYN_MONTH_E* LDA     28,DL
        11 004676   200101 755100                    STA     SYN_ERR,,AUTO

  14252 11 004677   004711 710000 11                 TRA     RPT_SYN

     2150    14253    2   SYN_DAY_ERR: SYN_ERR = %E$IA_DAY_ERR#; GOTO RPT_SYN;

  14253 11 004700   000035 235007       SYN_DAY_ERR  LDA     29,DL
        11 004701   200101 755100                    STA     SYN_ERR,,AUTO

  14253 11 004702   004711 710000 11                 TRA     RPT_SYN

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:248  
     2151    14254    2   SYN_NO_WILD_ERR: SYN_ERR = %E$IA_NO_WILD_ERR#; GOTO RPT_SYN;

  14254 11 004703   000036 235007       SYN_NO_WILD* LDA     30,DL
        11 004704   200101 755100                    STA     SYN_ERR,,AUTO

  14254 11 004705   004711 710000 11                 TRA     RPT_SYN

     2152    14255    2   SYN_DATE_RANGE_ERR: SYN_ERR = %E$IA_DATE_RANGE_ERR#; GOTO RPT_SYN;

  14255 11 004706   000037 235007       SYN_DATE_RA* LDA     31,DL
        11 004707   200101 755100                    STA     SYN_ERR,,AUTO

  14255 11 004710   004711 710000 11                 TRA     RPT_SYN

     2153    14256    2   RPT_SYN:
     2154    14257    2        CALL IAE$ERROR (ON_LINE,SYN_ERR,0,%IA_KEY_SYNTAX_ERR#,EGG_GETCMD.PCB$);

  14257 11 004711   000101 236000 12    RPT_SYN      LDQ     65
        11 004712   200122 756100                    STQ     CONV_CURRENT+5,,AUTO
        11 004713   000026 237000 12                 LDAQ    22
        11 004714   200120 757100                    STAQ    CONV_CURRENT+3,,AUTO
        11 004715   200101 630500                    EPPR0   SYN_ERR,,AUTO
        11 004716   200117 450500                    STP0    CONV_CURRENT+2,,AUTO
        11 004717   000075 236000 12                 LDQ     61
        11 004720   200116 756100                    STQ     CONV_CURRENT+1,,AUTO
        11 004721   200116 630500                    EPPR0   CONV_CURRENT+1,,AUTO
        11 004722   000023 631400 xsym               EPPR1   B_VECTNIL+19
        11 004723   000000 701000 xent               TSX1    IAE$ERROR
        11 004724   000000 011000                    NOP     0

     2155    14258    2        ERROR.ERR# = %E$SYNERR;

  14258 11 004725   004132 236000 1                  LDQ     ERROR
        11 004726   000116 376000 12                 ANQ     78
        11 004727   000010 276007                    ORQ     8,DL
        11 004730   004132 756000 1                  STQ     ERROR

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:249  
     2156    14259    2        ALTRETURN;

  14259 11 004731   200074 221300                    LDX1  ! BUF_START+1,,AUTO
        11 004732   000000 702211                    TSX2  ! 0,X1

     2157    14260                                                /**/
     2158    14261    2   END PARSE$COMMAND;
     2159    14262        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:250  
     2160    14263        /*I*      NAME: MAKE$ENTRY
     2161    14264                  PURPOSE: Puts an entry into the time table.
     2162    14265                  CALL: CALL MAKE$ENTRY (TIME);
     2163    14266                  DATA: TIME is in minutes from midnight
     2164    14267                  DESCRIPTION: This routine puts entries into the time table.
     2165    14268                                 It first finds the places the entry should
     2166    14269                                 be by searching the chain until the TIME is
     2167    14270                                 sorted. It then gets memory for this entry
     2168    14271                                 and stores it.
     2169    14272                             */
     2170    14273    1   MAKE$ENTRY: PROC (TIME) ALTRET;         /* Makes entry for a command */

  14273 11 004733   200074 741300       MAKE$ENTRY   STX1  ! BUF_START+1,,AUTO

     2171    14274                                                /**/
     2172    14275    2   DCL TIME SBIN WORD;
     2173    14276                                                /**/
     2174    14277    2   DCL LAST_ENTRY$ PTR;
     2175    14278    2   DCL SAVE_ENTRY$ PTR;
     2176    14279    2   DCL NEW_ENTRY$ PTR;
     2177    14280    2        LAST_ENTRY$ = ADDR(NIL);

  14280 11 004734   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 004735   200076 756100                    STQ     LAST_ENTRY$,,AUTO

     2178    14281    2        SAVE_ENTRY$ = ADDR(NIL);

  14281 11 004736   200077 756100                    STQ     SAVE_ENTRY$,,AUTO

     2179    14282    2        TIME_ENTRY$ = TIME_HEAD$;          /* Point to begining */

  14282 11 004737   003556 236000 1                  LDQ     TIME_HEAD$
        11 004740   003555 756000 1                  STQ     TIME_ENTRY$

     2180    14283    2        IF TIME < DO_FROM OR TIME > DO_UNTIL /* Do not make entry */

  14283 11 004741   200075 470500                    LDP0    @TIME,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:251  
        11 004742   000000 236100                    LDQ     0,,PR0
        11 004743   200020 116100                    CMPQ    DO_FROM,,AUTO
        11 004744   004747 604000 11                 TMI     s:14285
        11 004745   200026 116100                    CMPQ    DO_UNTIL,,AUTO
        11 004746   004750 604400 11                 TMOZ    s:14286

     2181    14284    2        THEN
     2182    14285    2             RETURN;

  14285 11 004747   000001 702211                    TSX2  ! 1,X1

     2183    14286    2        IF TIME < CURR_TIME OR TIME <= LAST_TIME

  14286 11 004750   000443 116000 1                  CMPQ    CURR_TIME
        11 004751   004756 604000 11                 TMI     s:14288
        11 004752   003175 236000 1                  LDQ     LAST_TIME
        11 004753   000022 732000                    QRS     18
        11 004754   000000 116100                    CMPQ    0,,PR0
        11 004755   004757 604000 11                 TMI     s:14289

     2184    14287    2        THEN
     2185    14288    2             RETURN;

  14288 11 004756   000001 702211                    TSX2  ! 1,X1

     2186    14289    2        IF TIME_HEAD$ ~= ADDR(NIL)         /* No entries yet */

  14289 11 004757   003556 236000 1                  LDQ     TIME_HEAD$
        11 004760   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 004761   005004 600000 11                 TZE     s:14298

     2187    14290    2        THEN
     2188    14291    3          DO WHILE(TIME > TIME_TABLE.TIME);

  14291 11 004762   003555 471400 1                  LDP1    TIME_ENTRY$
        11 004763   100000 236100                    LDQ     0,,PR1
        11 004764   000022 772000                    QRL     18
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:252  
        11 004765   000000 116100                    CMPQ    0,,PR0
        11 004766   005004 605000 11                 TPL     s:14298

     2189    14292    3               LAST_ENTRY$ = TIME_ENTRY$;  /* Point to this entry */

  14292 11 004767   003555 236000 1                  LDQ     TIME_ENTRY$
        11 004770   200076 756100                    STQ     LAST_ENTRY$,,AUTO

     2190    14293    3               TIME_ENTRY$ = TIME_TABLE.NEXT$;

  14293 11 004771   003555 470400 1                  LDP0    TIME_ENTRY$
        11 004772   000113 236100                    LDQ     75,,PR0
        11 004773   003555 756000 1                  STQ     TIME_ENTRY$

     2191    14294    3               IF TIME_ENTRY$ = ADDR(NIL)  /* End of table */

  14294 11 004774   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 004775   005004 600000 11                 TZE     s:14298

     2192    14295    3               THEN
     2193    14296    3                    EXIT;
     2194    14297    3             END;                          /*  Do while new time > table time  */

  14297 11 004776   200075 470500                    LDP0    @TIME,,AUTO
        11 004777   003555 471400 1                  LDP1    TIME_ENTRY$
        11 005000   100000 236100                    LDQ     0,,PR1
        11 005001   000022 772000                    QRL     18
        11 005002   000000 116100                    CMPQ    0,,PR0
        11 005003   004767 604000 11                 TMI     s:14292

     2195    14298    2        NEW_ENTRY$ = PINCRW(SEG_VLP.PTR$ ,(SEG_VLP.W1.VSIZE#+1)/4);

  14298 11 005004   003576 236000 1                  LDQ     SEG_VLP
        11 005005   000020 772000                    QRL     16
        11 005006   000001 036007                    ADLQ    1,DL
        11 005007   000002 772000                    QRL     2
        11 005010   000022 736000                    QLS     18
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:253  
        11 005011   003577 036000 1                  ADLQ    SEG_VLP+1
        11 005012   200100 756100                    STQ     NEW_ENTRY$,,AUTO

     2196    14299    2        SEG_VLP.W1.VSIZE# = SIZEW(TIME_TABLE);

  14299 11 005013   003576 236000 1                  LDQ     SEG_VLP
        11 005014   177777 376007                    ANQ     65535,DL
        11 005015   000023 276003                    ORQ     19,DU
        11 005016   003576 756000 1                  STQ     SEG_VLP

     2197    14300    2        CALL M$GDS(GET_ENTRY)

  14300 11 005017   003562 630400 1                  EPPR0   GET_ENTRY
        11 005020   430001 713400                    CLIMB   alt,gds
        11 005021   400400 401760                    pmme    nvectors=2
        11 005022   005024 702000 11                 TSX2    s:14302
        11 005023   005032 710000 11                 TRA     s:14305

     2198    14301    3        WHENALTRETURN DO;

     2199    14302    3              CALL IAE$CSCG_ERROR (%IA_KEY_SYNTAX_ERR#,%E$IA_NO_MEM#,EGG_GETCMD.PCB$);

  14302 11 005024   000134 630400 12                 EPPR0   92
        11 005025   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 005026   000000 701000 xent               TSX1    IAE$CSCG_ERROR
        11 005027   000000 011000                    NOP     0

     2200    14303    3               ALTRETURN;

  14303 11 005030   200074 221300                    LDX1  ! BUF_START+1,,AUTO
        11 005031   000000 702211                    TSX2  ! 0,X1

     2201    14304    3             END;                          /*  Whenaltret on M$GDS  */
     2202    14305    2        IF NEW_ENTRY$ = ADDR(NIL)

  14305 11 005032   200100 236100                    LDQ     NEW_ENTRY$,,AUTO
        11 005033   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:254  
        11 005034   005037 601000 11                 TNZ     s:14308

     2203    14306    2        THEN
     2204    14307    2             NEW_ENTRY$ = SEG_VLP.PTR$;

  14307 11 005035   003577 236000 1                  LDQ     SEG_VLP+1
        11 005036   200100 756100                    STQ     NEW_ENTRY$,,AUTO

     2205    14308    2        SAVE_ENTRY$ = TIME_ENTRY$;

  14308 11 005037   003555 236000 1                  LDQ     TIME_ENTRY$
        11 005040   200077 756100                    STQ     SAVE_ENTRY$,,AUTO

     2206    14309    2        TIME_ENTRY$ =  NEW_ENTRY$;

  14309 11 005041   200100 236100                    LDQ     NEW_ENTRY$,,AUTO
        11 005042   003555 756000 1                  STQ     TIME_ENTRY$

     2207    14310    2        TIME_TABLE.NEXT$ = SAVE_ENTRY$;

  14310 11 005043   200077 236100                    LDQ     SAVE_ENTRY$,,AUTO
        11 005044   003555 470400 1                  LDP0    TIME_ENTRY$
        11 005045   000113 756100                    STQ     75,,PR0

     2208    14311    2        TIME_TABLE.TIME = TIME;            /* Save do time */

  14311 11 005046   200075 471500                    LDP1    @TIME,,AUTO
        11 005047   100000 720100                    LXL0    0,,PR1
        11 005050   000000 740100                    STX0    0,,PR0

     2209    14312    2        TIME_TABLE.TYPE = DO_TYPE;         /* Save command type */

  14312 11 005051   200024 236100                    LDQ     DO_TYPE,,AUTO
        11 005052   000012 552140                    STBQ    10,'40'O,PR0

     2210    14313    2        TIME_TABLE.COMMAND = DO_CMD;       /* Save command */

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:255  
  14313 11 005053   040100 100400                    MLR     fill='040'O
        11 005054   000446 000400 1                  ADSC9   DO_CMD                   cn=0,n=256
        11 005055   000012 400400                    ADSC9   10,,PR0                  cn=2,n=256

     2211    14314    2        TIME_TABLE.SIZE = DO_CMD_SIZE;

  14314 11 005056   200003 236100                    LDQ     DO_CMD_SIZE,,AUTO
        11 005057   000011 772000                    QRL     9
        11 005060   000012 552120                    STBQ    10,'20'O,PR0

     2212    14315    2        TIME_TABLE.GHOST_FID = DO_FID;     /* Save ghost fid */

  14315 11 005061   000100 100500                    MLR     fill='000'O
        11 005062   200013 000024                    ADSC9   DO_FID,,AUTO             cn=0,n=20
        11 005063   000001 000024                    ADSC9   1,,PR0                   cn=0,n=20

     2213    14316    2        TIME_TABLE.ACCT = DO_ACCT;

  14316 11 005064   000444 237000 1                  LDAQ    DO_ACCT
        11 005065   000006 755100                    STA     6,,PR0
        11 005066   000007 756100                    STQ     7,,PR0

     2214    14317    2        TIME_TABLE.PASS = DO_PASS;

  14317 11 005067   040100 100400                    MLR     fill='040'O
        11 005070   000551 000010 1                  ADSC9   DO_PASS                  cn=0,n=8
        11 005071   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8

     2215    14318    2        TIME_ENTRY$ = LAST_ENTRY$;         /* Update next in previous */

  14318 11 005072   200076 236100                    LDQ     LAST_ENTRY$,,AUTO
        11 005073   003555 756000 1                  STQ     TIME_ENTRY$

     2216    14319    2        IF LAST_ENTRY$ = ADDR(NIL)         /* Must be first entry */

  14319 11 005074   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 005075   005101 601000 11                 TNZ     s:14323
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:256  

     2217    14320    2        THEN
     2218    14321    2             TIME_HEAD$ = NEW_ENTRY$;

  14321 11 005076   200100 236100                    LDQ     NEW_ENTRY$,,AUTO
        11 005077   003556 756000 1                  STQ     TIME_HEAD$
        11 005100   005104 710000 11                 TRA     s:14324

     2219    14322    2        ELSE
     2220    14323    2             TIME_TABLE.NEXT$ = NEW_ENTRY$;

  14323 11 005101   200100 236100                    LDQ     NEW_ENTRY$,,AUTO
        11 005102   003555 470400 1                  LDP0    TIME_ENTRY$
        11 005103   000113 756100                    STQ     75,,PR0

     2221    14324    2        RETURN;

  14324 11 005104   200074 221300                    LDX1  ! BUF_START+1,,AUTO
        11 005105   000001 702211                    TSX2  ! 1,X1

     2222    14325    2   END MAKE$ENTRY;
     2223    14326        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:257  
     2224    14327        /*I*      NAME: DO$COMMAND
     2225    14328                  PURPOSE: To perform the command.
     2226    14329                  CALL: CALL DO$COMMAND(FID,COMMAND,TYPE,SIZE);
     2227    14330                  DATA: FID - GHOST NAME
     2228    14331                        COMMAND - FIRST COMMAND or KEYIN
     2229    14332                        TYPE - Type of command
     2230    14333                        SIZE - Size of COMMAND in charactes
     2231    14334                  DESCRIPTION: This routine performs the actual command. It
     2232    14335                                 determines the type and then either
     2233    14336                                 sends a message to the OC, does a keyin,
     2234    14337                                 or starts a ghost job. The operator is told
     2235    14338                                 about the action if the auto scheduling message
     2236    14339                                 is on.
     2237    14340                        */
     2238    14341    1   DO$COMMAND: PROC (FID, COMMAND, TYPE, SIZE, ACCOUNT, PASS);

  14341 11 005106   200042 741300       DO$COMMAND   STX1  ! J,,AUTO

     2239    14342                                                /**/
     2240    14343    2   DCL ACCOUNT CHAR (8) CALIGNED;
     2241    14344    2   DCL PASS CHAR (8) CALIGNED;
     2242    14345    2   DCL 1 FID,
     2243    14346    2           2 SIZE UBIN BYTE CALIGNED,
     2244    14347    2           2 TEXT CHAR(FID.SIZE) CALIGNED;
     2245    14348    2   DCL COMMAND CHAR(256) CALIGNED;
     2246    14349    2   DCL TYPE UBIN BYTE CALIGNED;
     2247    14350    2   DCL SIZE UBIN BYTE CALIGNED;
     2248    14351    2   DCL SAVE_ACCN CHAR (8);
     2249    14352                                                /**/
     2250    14353    3        DO CASE (TYPE);                    /* Do command */

  14353 11 005107   200045 470500                    LDP0    @TYPE,,AUTO
        11 005110   000100 101500                    MRL     fill='000'O
        11 005111   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        11 005112   200116 000002                    ADSC9   CONV_CURRENT+1,,AUTO     cn=0,n=2
        11 005113   200116 220100                    LDX0    CONV_CURRENT+1,,AUTO
        11 005114   000004 100003                    CMPX0   4,DU
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:258  
        11 005115   005117 602010 11                 TNC     s:14353+8,X0
        11 005116   005410 710000 11                 TRA     s:14446
        11 005117   005362 710000 11                 TRA     s:14433
        11 005120   005410 710000 11                 TRA     s:14446
        11 005121   005123 710000 11                 TRA     s:14358
        11 005122   005135 710000 11                 TRA     s:14364

     2251    14354                                                /**/
     2252    14355
     2253    14356                                                /**/
     2254    14357    3        CASE (%IA_CMD_MESS#);

     2255    14358    3           TELL_CONSOLES.MESS = COMMAND;

  14358 11 005123   200044 471500                    LDP1    @COMMAND,,AUTO
        11 005124   040000 100500                    MLR     fill='040'O
        11 005125   100000 000120                    ADSC9   0,,PR1                   cn=0,n=80
        11 005126   000307 200120 1                  ADSC9   TELL_CONSOLES+7          cn=1,n=80

     2256    14359    3           TELL_CONSOLES.KEY = %IA_KEY_MSG_MSG#; /* Message type */

  14359 11 005127   002000 236003                    LDQ     1024,DU
        11 005130   000306 552040 1                  STBQ    TELL_CONSOLES+6,'40'O

     2257    14360    3           CALL M$WRITE(TELL_CSCG);

  14360 11 005131   004472 630400 1                  EPPR0   TELL_CSCG
        11 005132   040001 713400                    CLIMB   write
        11 005133   401400 401760                    pmme    nvectors=4
        11 005134   005410 710000 11                 TRA     s:14446

     2258    14361                                                /**/
     2259    14362                                                /**/
     2260    14363    3        CASE (%IA_CMD_START#);             /* Do gjob */

     2261    14364    3           TELL_CONSOLES.MESS = COMMAND;   /* Put command in mess */

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:259  
  14364 11 005135   200044 471500                    LDP1    @COMMAND,,AUTO
        11 005136   040000 100500                    MLR     fill='040'O
        11 005137   100000 000120                    ADSC9   0,,PR1                   cn=0,n=80
        11 005140   000307 200120 1                  ADSC9   TELL_CONSOLES+7          cn=1,n=80

     2262    14365    3           CALL CONCAT(TELL_CONSOLES.FID,SUBSTR(FID.TEXT,0,FID.SIZE),'.',ACCOUNT);

  14365 11 005141   200043 473500                    LDP3    @FID,,AUTO
        11 005142   000100 101500                    MRL     fill='000'O
        11 005143   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        11 005144   200116 000002                    ADSC9   CONV_CURRENT+1,,AUTO     cn=0,n=2
        11 005145   200116 220100                    LDX0    CONV_CURRENT+1,,AUTO
        11 005146   000100 101500                    MRL     fill='000'O
        11 005147   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        11 005150   200117 000002                    ADSC9   CONV_CURRENT+2,,AUTO     cn=0,n=2
        11 005151   200117 222100                    LDX2    CONV_CURRENT+2,,AUTO
        11 005152   040000 100540                    MLR     fill='040'O
        11 005153   300000 200012                    ADSC9   0,,PR3                   cn=1,n=*X2
        11 005154   000333 200024 1                  ADSC9   TELL_CONSOLES+27         cn=1,n=20
        11 005155   000000 636012                    EAQ     0,X2
        11 005156   000022 772000                    QRL     18
        11 005157   000024 116007                    CMPQ    20,DL
        11 005160   005203 603000 11                 TRC     s:14366
        11 005161   200120 742100                    STX2    CONV_CURRENT+3,,AUTO
        11 005162   777753 622012                    EAX2    -21,X2
        11 005163   777777 662003                    ERX2    -1,DU
        11 005164   200120 235100                    LDA     CONV_CURRENT+3,,AUTO
        11 005165   000022 771000                    ARL     18
        11 005166   040045 100400                    MLR     fill='040'O
        11 005167   000074 000001 12                 ADSC9   60                       cn=0,n=1
        11 005170   000333 200012 1                  ADSC9   TELL_CONSOLES+27,A       cn=1,n=*X2
        11 005171   200120 236100                    LDQ     CONV_CURRENT+3,,AUTO
        11 005172   000022 772000                    QRL     18
        11 005173   000023 116007                    CMPQ    19,DL
        11 005174   005203 603000 11                 TRC     s:14366
        11 005175   777754 622006                    EAX2    -20,QL
        11 005176   777777 662003                    ERX2    -1,DU
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:260  
        11 005177   200047 474500                    LDP4    @ACCOUNT,,AUTO
        11 005200   040046 100500                    MLR     fill='040'O
        11 005201   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8
        11 005202   000333 400012 1                  ADSC9   TELL_CONSOLES+27,Q       cn=2,n=*X2

     2263    14366    3           TELL_CONSOLES.KEY = %IA_KEY_START_MSG#;

  14366 11 005203   001000 236003                    LDQ     512,DU
        11 005204   000306 552040 1                  STBQ    TELL_CONSOLES+6,'40'O

     2264    14367    3           IF ~ON_LINE AND GOOSEM_ON

  14367 11 005205   003215 236000 1                  LDQ     ON_LINE
        11 005206   400000 376003                    ANQ     -131072,DU
        11 005207   400000 676003                    ERQ     -131072,DU
        11 005210   005216 600000 11                 TZE     s:14375
        11 005211   002566 234000 1                  SZN     GOOSEM_ON
        11 005212   005216 605000 11                 TPL     s:14375

     2265    14368    3           THEN
     2266    14369        /*O*      MESSAGE: GOOSE Gjob: xxxx using command
     2267    14370                  ACTION: Information only
     2268    14371                  MEANING: GOOSE has started ghost job xxxx with the command.
     2269    14372                             */
     2270    14373    3                CALL M$WRITE(TELL_CSCG) ;

  14373 11 005213   004472 630400 1                  EPPR0   TELL_CSCG
        11 005214   040001 713400                    CLIMB   write
        11 005215   401400 401760                    pmme    nvectors=4

     2271    14374                                                /**/
     2272    14375    3           IF FID.SIZE = 0

  14375 11 005216   200043 470500                    LDP0    @FID,,AUTO
        11 005217   000100 101500                    MRL     fill='000'O
        11 005220   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        11 005221   200116 000004                    ADSC9   CONV_CURRENT+1,,AUTO     cn=0,n=4
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:261  
        11 005222   200116 236100                    LDQ     CONV_CURRENT+1,,AUTO
        11 005223   000000 116003                    CMPQ    0,DU
        11 005224   005230 601000 11                 TNZ     s:14380

     2273    14376    3           THEN
     2274    14377    3                START_GJOB.NAME_ = VECTOR (NIL);

  14377 11 005225   000016 237000 12                 LDAQ    14
        11 005226   005454 757000 1                  STAQ    START_GJOB+4
        11 005227   005244 710000 11                 TRA     s:14385

     2275    14378    3           ELSE
     2276    14379    4             DO;

     2277    14380    4                  START_GJOB.NAME_ = VECTOR (GJOB_NAME);

  14380 11 005230   000140 237000 12                 LDAQ    96
        11 005231   005454 757000 1                  STAQ    START_GJOB+4

     2278    14381    4                  GJOB_NAME.NAME# = FID.TEXT;

  14381 11 005232   000100 101500                    MRL     fill='000'O
        11 005233   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        11 005234   200116 000002                    ADSC9   CONV_CURRENT+1,,AUTO     cn=0,n=2
        11 005235   200116 220100                    LDX0    CONV_CURRENT+1,,AUTO
        11 005236   040000 100540                    MLR     fill='040'O
        11 005237   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        11 005240   005466 200037 1                  ADSC9   GJOB_NAME                cn=1,n=31

     2279    14382    4                  GJOB_NAME.L# = FID.SIZE;

  14382 11 005241   000000 100500                    MLR     fill='000'O
        11 005242   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        11 005243   005466 000001 1                  ADSC9   GJOB_NAME                cn=0,n=1

     2280    14383    4                END;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:262  
     2281    14384
     2282    14385    3           IF ACCOUNT = ' '

  14385 11 005244   200047 471500                    LDP1    @ACCOUNT,,AUTO
        11 005245   040000 106500                    CMPC    fill='040'O
        11 005246   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
        11 005247   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 005250   005254 601000 11                 TNZ     s:14390

     2283    14386    3           THEN
     2284    14387    3                START_GJOB.ACCT_ = VECTOR (NIL);

  14387 11 005251   000016 237000 12                 LDAQ    14
        11 005252   005452 757000 1                  STAQ    START_GJOB+2
        11 005253   005261 710000 11                 TRA     s:14395

     2285    14388    3           ELSE
     2286    14389    4             DO;

     2287    14390    4                  START_GJOB.ACCT_ = VECTOR (GJOB_ACCT);

  14390 11 005254   000142 237000 12                 LDAQ    98
        11 005255   005452 757000 1                  STAQ    START_GJOB+2

     2288    14391    4                  GJOB_ACCT.ACCT# = ACCOUNT;

  14391 11 005256   040000 100500                    MLR     fill='040'O
        11 005257   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
        11 005260   005476 000010 1                  ADSC9   GJOB_ACCT                cn=0,n=8

     2289    14392    4                END;

     2290    14393
     2291    14394                                                /**/
     2292    14395    3           IF PASS ~= ' '

  14395 11 005261   200050 473500                    LDP3    @PASS,,AUTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:263  
        11 005262   040000 106500                    CMPC    fill='040'O
        11 005263   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
        11 005264   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 005265   005274 600000 11                 TZE     s:14402

     2293    14396    3           THEN
     2294    14397    4             DO;

     2295    14398    4                  GJOB_PASS.PASS# = PASS;

  14398 11 005266   040000 100500                    MLR     fill='040'O
        11 005267   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
        11 005270   005500 000010 1                  ADSC9   GJOB_PASS                cn=0,n=8

     2296    14399    4                  START_GJOB.PASS_ = VECTOR (GJOB_PASS);

  14399 11 005271   000144 237000 12                 LDAQ    100
        11 005272   005456 757000 1                  STAQ    START_GJOB+6

     2297    14400    4                END;

  14400 11 005273   005276 710000 11                 TRA     s:14404

     2298    14401    3           ELSE
     2299    14402    3                START_GJOB.PASS_ = VECTOR (NIL);

  14402 11 005274   000016 237000 12                 LDAQ    14
        11 005275   005456 757000 1                  STAQ    START_GJOB+6

     2300    14403                                                /**/
     2301    14404    3           IF COMMAND ~= ' '

  14404 11 005276   200044 474500                    LDP4    @COMMAND,,AUTO
        11 005277   040000 106500                    CMPC    fill='040'O
        11 005300   400000 000400                    ADSC9   0,,PR4                   cn=0,n=256
        11 005301   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 005302   005307 600000 11                 TZE     s:14408
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:264  

     2302    14405    3           THEN
     2303    14406    3                START_GJOB.CCBUF_ = VECTOR (COMMAND);

  14406 11 005303   000146 235000 12                 LDA     102
        11 005304   200044 236100                    LDQ     @COMMAND,,AUTO
        11 005305   005460 757000 1                  STAQ    START_GJOB+8
        11 005306   005311 710000 11                 TRA     s:14410

     2304    14407    3           ELSE
     2305    14408    3                START_GJOB.CCBUF_ = VECTOR (NIL);

  14408 11 005307   000016 237000 12                 LDAQ    14
        11 005310   005460 757000 1                  STAQ    START_GJOB+8

     2306    14409                                                /**/
     2307    14410    3           CALL M$GJOB (START_GJOB)

  14410 11 005311   005450 630400 1                  EPPR0   START_GJOB
        11 005312   420022 713400                    CLIMB   alt,+8210
        11 005313   402400 401760                    pmme    nvectors=6
        11 005314   005316 702000 11                 TSX2    s:14412
        11 005315   005337 710000 11                 TRA     s:14421

     2308    14411    4           WHENALTRETURN DO;

     2309    14412    4                  ERROR = %SYSTEM_ERROR;

  14412 11 005316   000000 470400 xsym               LDP0    B$TCB$
        11 005317   000000 471500                    LDP1    0,,PR0
        11 005320   100102 236100                    LDQ     66,,PR1
        11 005321   004132 756000 1                  STQ     ERROR

     2310    14413    4                  IF ON_LINE

  14413 11 005322   003215 234000 1                  SZN     ON_LINE
        11 005323   005331 605000 11                 TPL     s:14417
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:265  

     2311    14414    4                  THEN
     2312    14415    4                      CALL IAE$ERROR (ON_LINE,%E$IA_GJOB_ERR#,ERROR,%IA_KEY_START_ERR#
             14415                                ,EGG_GETCMD.PCB$);

  14415 11 005324   000150 630400 12                 EPPR0   104
        11 005325   000023 631400 xsym               EPPR1   B_VECTNIL+19
        11 005326   000000 701000 xent               TSX1    IAE$ERROR
        11 005327   000000 011000                    NOP     0
        11 005330   005335 710000 11                 TRA     s:14418

     2313    14416    4                  ELSE
     2314    14417    4                       CALL IAE$ERROR (ON_LINE,0,ERROR,%IA_KEY_START_ERR#,EGG_GETCMD.
             14417                                PCB$);

  14417 11 005331   000155 630400 12                 EPPR0   109
        11 005332   000023 631400 xsym               EPPR1   B_VECTNIL+19
        11 005333   000000 701000 xent               TSX1    IAE$ERROR
        11 005334   000000 011000                    NOP     0

     2315    14418    4                  RETURN;

  14418 11 005335   200042 221300                    LDX1  ! J,,AUTO
        11 005336   000001 702211                    TSX2  ! 1,X1

     2316    14419    4                END;                       /*  Whenaltreturn  */
     2317    14420                                                /**/
     2318    14421    3           IF ON_LINE

  14421 11 005337   003215 234000 1                  SZN     ON_LINE
        11 005340   005410 605000 11                 TPL     s:14446

     2319    14422    3           THEN
     2320    14423    4             DO;

     2321    14424    4                  CALL BINCHAR (SYSID, GJOB_RESULTS.SYSID);

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:266  
  14424 11 005341   005502 235000 1                  LDA     GJOB_RESULTS
        11 005342   000022 771000                    ARL     18
        11 005343   000044 773000                    LRL     36
        11 005344   200116 757100                    STAQ    CONV_CURRENT+1,,AUTO
        11 005345   000000 301500                    BTD
        11 005346   200116 000010                    NDSC9   CONV_CURRENT+1,,AUTO     cn=0,s=lsgnf,sf=0,n=8
        11 005347   003546 030006 1                  NDSC9   SYSID                    cn=0,s=nosgn,sf=0,n=6

     2322    14425    4                  CALL CONCAT (MESS_BUF,

  14425 11 005350   040000 100400                    MLR     fill='040'O
        11 005351   000055 000032 10                 ADSC9   NO_GHOST+39              cn=0,n=26
        11 005352   000000 000032 xsym               ADSC9   MESS_BUF                 cn=0,n=26
        11 005353   040000 100400                    MLR     fill='040'O
        11 005354   003546 000006 1                  ADSC9   SYSID                    cn=0,n=6
        11 005355   000006 400346 xsym               ADSC9   MESS_BUF+6               cn=2,n=230

     2323    14426    4                       'Ghost started with sysid: ',
     2324    14427    4                       SYSID);
     2325    14428    4                  CALL M$WRITE (OUT_MESS) ;

  14428 11 005356   004134 630400 1                  EPPR0   OUT_MESS
        11 005357   040001 713400                    CLIMB   write
        11 005360   401400 401760                    pmme    nvectors=4

     2326    14429    4                END;

  14429 11 005361   005410 710000 11                 TRA     s:14446

     2327    14430                                                /**/
     2328    14431                                                /**/
     2329    14432    3        CASE (%IA_CMD_DO#);                /* Wants to do a keyin */

     2330    14433    3           TELL_CONSOLES.KEY = %IA_KEY_KEYIN_MSG#; /* Keyin message */

  14433 11 005362   000000 236003                    LDQ     0,DU
        11 005363   000306 552040 1                  STBQ    TELL_CONSOLES+6,'40'O
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:267  

     2331    14434    3           TELL_CONSOLES.MESS = COMMAND;

  14434 11 005364   200044 471500                    LDP1    @COMMAND,,AUTO
        11 005365   040000 100500                    MLR     fill='040'O
        11 005366   100000 000120                    ADSC9   0,,PR1                   cn=0,n=80
        11 005367   000307 200120 1                  ADSC9   TELL_CONSOLES+7          cn=1,n=80

     2332    14435    3           IF GOOSEM_ON                    /* Check if messages on */

  14435 11 005370   002566 234000 1                  SZN     GOOSEM_ON
        11 005371   005375 605000 11                 TPL     s:14442

     2333    14436    3           THEN
     2334    14437        /*O*      MESSAGE: GOOSE Keyin: xxxx
     2335    14438                  ACTION: Information only
     2336    14439                  MEANING: GOOSE is doing the keyin xxxx
     2337    14440                   */
     2338    14441    3                CALL M$WRITE(TELL_CSCG) ;

  14441 11 005372   004472 630400 1                  EPPR0   TELL_CSCG
        11 005373   040001 713400                    CLIMB   write
        11 005374   401400 401760                    pmme    nvectors=4

     2339    14442    3           SEND_KEYIN.KEYIN = COMMAND;     /* Put keyin in buffer */

  14442 11 005375   200044 470500                    LDP0    @COMMAND,,AUTO
        11 005376   040000 100500                    MLR     fill='040'O
        11 005377   000000 000120                    ADSC9   0,,PR0                   cn=0,n=80
        11 005400   000346 200120 1                  ADSC9   SEND_KEYIN+5             cn=1,n=80

     2340    14443    3           SEND_KEYIN.SIZE = SIZE;         /* Length of keyin */

  14443 11 005401   200046 471500                    LDP1    @SIZE,,AUTO
        11 005402   000000 100500                    MLR     fill='000'O
        11 005403   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        11 005404   000346 000001 1                  ADSC9   SEND_KEYIN+5             cn=0,n=1
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:268  

     2341    14444    3           CALL M$WRITE(KEYIN_CSCG) ;

  14444 11 005405   004506 630400 1                  EPPR0   KEYIN_CSCG
        11 005406   040001 713400                    CLIMB   write
        11 005407   401400 401760                    pmme    nvectors=4

     2342    14445    3        END;                               /* End cases */

     2343    14446    2        RETURN;

  14446 11 005410   200042 221300                    LDX1  ! J,,AUTO
        11 005411   000001 702211                    TSX2  ! 1,X1

     2344    14447    2   END DO$COMMAND;
     2345    14448        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:269  
     2346    14449        /*I*      NAME: DO$EVENT
     2347    14450                  PURPOSE: To do the appopiate event received from CSCG
     2348    14451                  CALL: CALL  DO$EVENT
     2349    14452                  DESCRIPTION: This routine handles an event that came in
     2350    14453                            from CSCG. When the event took place GOOSE_READ_FLAG
     2351    14454                            was set indicating an event occured and the
     2352    14455                            type of event is in CSCG_BUF. The routine does
     2353    14456                            the indicated action and then issues another
     2354    14457                            read from CSCG.
     2355    14458                             */
     2356    14459    1   DO$EVENT: PROC ;

  14459 11 005412   200040 741300       DO$EVENT     STX1  ! XUG$+2,,AUTO

     2357    14460                                                /*  */
     2358    14461        %OC_MESSHD_W    (NAME=TELL_CONSOLES,    /* Used to tell consoles */
     2359    14462                        ATR=M_SYS,              /* Tell system consoles */
     2360    14463                       MSG=GOOSE_SMSG#,
     2361    14464                       NPARMS = 1,
     2362    14465                       FUNC=WR);
     2363    14478    2        2 * UBIN BYTE INIT(1) CALIGNED,
     2364    14479    2             2 TYPE UBIN BYTE CALIGNED;
     2365    14480        %FPT_WRITE (FPTN=WR_CSCG,               /* Write to consoles */
     2366    14481                       BUF=TELL_CONSOLES,       /* Message buffer */
     2367    14482                       STATION=STA_KEYIN,       /* Write to keyin */
     2368    14483                       WAIT=YES,                /* Wait for completion */
     2369    14484                       DCB=M$CSCG);
     2370    14515                                                /**/
     2371    14516        /* Begin main program */
     2372    14517    2        IF NOT GOOSE_ERR                   /* No error on read */

  14517 11 005413   000373 235000 1                  LDA     GOOSE_ERR
        11 005414   005610 601000 11                 TNZ     s:14627

     2373    14518    2        THEN
     2374    14519                                                /**/
     2375    14520                                           /* Got the green light to start from slug */
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:270  
     2376    14521    3          DO CASE (ADDR (CSCG_BUF) -> CSCG_KEYIN.KEY);

  14521 11 005415   000376 220000 1                  LDX0    CSCG_BUF
        11 005416   000777 360003                    ANX0    511,DU
        11 005417   000006 100003                    CMPX0   6,DU
        11 005420   005422 602010 11                 TNC     s:14521+5,X0
        11 005421   005577 710000 11                 TRA     s:14616
        11 005422   005577 710000 11                 TRA     s:14616
        11 005423   005430 710000 11                 TRA     s:14525
        11 005424   005457 710000 11                 TRA     s:14545
        11 005425   005566 710000 11                 TRA     s:14605
        11 005426   005507 710000 11                 TRA     s:14565
        11 005427   005536 710000 11                 TRA     s:14585

     2377    14522                                                /**/
     2378    14523                                                /**/
     2379    14524    3          CASE (1 /* KEY_GOOSEON# */);

     2380    14525    3             IF GOOSE_ON

  14525 11 005430   002561 234000 1                  SZN     GOOSE_ON
        11 005431   005444 605000 11                 TPL     s:14536

     2381    14526    3             THEN
     2382    14527    4               DO;

     2383    14528    4                    TELL_CONSOLES.CADDR = ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR;
             14528                             /* Error */

  14528 11 005432   000376 722000 1                  LXL2    CSCG_BUF
        11 005433   005765 742000 1                  STX2    TELL_CONSOLES

     2384    14529    4                    TELL_CONSOLES.TYPE = 0; /* Allready on */

  14529 11 005434   000000 236003                    LDQ     0,DU
        11 005435   005772 552020 1                  STBQ    TELL_CONSOLES+5,'20'O

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:271  
     2385    14530    4                    IF ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR ~= '777777'O
             14530                             /* From online */

  14530 11 005436   777777 102003                    CMPX2   -1,DU
        11 005437   005610 600000 11                 TZE     s:14627

     2386    14531    4                    THEN
     2387    14532    4                         CALL M$WRITE(WR_CSCG) ;

  14532 11 005440   005774 630400 1                  EPPR0   WR_CSCG
        11 005441   040001 713400                    CLIMB   write
        11 005442   401400 401760                    pmme    nvectors=4

     2388    14533    4                  END;

  14533 11 005443   005610 710000 11                 TRA     s:14627

     2389    14534    3             ELSE
     2390    14535    4               DO;

     2391    14536    4                    TELL_CONSOLES.CADDR = '200000'O /* M_SYS  */;

  14536 11 005444   200000 222003                    LDX2    65536,DU
        11 005445   005765 742000 1                  STX2    TELL_CONSOLES

     2392    14537    4                    TELL_CONSOLES.TYPE = 1;

  14537 11 005446   000001 236003                    LDQ     1,DU
        11 005447   005772 552020 1                  STBQ    TELL_CONSOLES+5,'20'O

     2393    14538    4                    CALL M$WRITE(WR_CSCG)

  14538 11 005450   005774 630400 1                  EPPR0   WR_CSCG
        11 005451   440001 713400                    CLIMB   alt,write
        11 005452   401400 401760                    pmme    nvectors=4
        11 005453   005456 702000 11                 TSX2    s:14542

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:272  
     2394    14539    5                    WHENRETURN DO;

     2395    14540    5                           GOOSE_ON = %YES#;

  14540 11 005454   400000 236003                    LDQ     -131072,DU
        11 005455   002561 756000 1                  STQ     GOOSE_ON

     2396    14541    5                         END;              /* Whenreturn */

     2397    14542    4                  END;

  14542 11 005456   005610 710000 11                 TRA     s:14627

     2398    14543                                                /**/
     2399    14544    3          CASE (2 /* KEY_GOOSEOFF# */);

     2400    14545    3             IF ~GOOSE_ON

  14545 11 005457   002561 236000 1                  LDQ     GOOSE_ON
        11 005460   400000 376003                    ANQ     -131072,DU
        11 005461   400000 676003                    ERQ     -131072,DU
        11 005462   005475 600000 11                 TZE     s:14556

     2401    14546    3             THEN
     2402    14547    4               DO;

     2403    14548    4                    TELL_CONSOLES.CADDR = ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR;
             14548                             /* Error */

  14548 11 005463   000376 722000 1                  LXL2    CSCG_BUF
        11 005464   005765 742000 1                  STX2    TELL_CONSOLES

     2404    14549    4                    TELL_CONSOLES.TYPE = 2; /* Allready off */

  14549 11 005465   000002 236003                    LDQ     2,DU
        11 005466   005772 552020 1                  STBQ    TELL_CONSOLES+5,'20'O

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:273  
     2405    14550    4                    IF ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR ~= '777777'O
             14550                             /* From online */

  14550 11 005467   777777 102003                    CMPX2   -1,DU
        11 005470   005610 600000 11                 TZE     s:14627

     2406    14551    4                    THEN
     2407    14552    4                         CALL M$WRITE(WR_CSCG) ;

  14552 11 005471   005774 630400 1                  EPPR0   WR_CSCG
        11 005472   040001 713400                    CLIMB   write
        11 005473   401400 401760                    pmme    nvectors=4

     2408    14553    4                  END;

  14553 11 005474   005610 710000 11                 TRA     s:14627

     2409    14554    3             ELSE
     2410    14555    4               DO;

     2411    14556    4                    TELL_CONSOLES.CADDR = '200000'O /* M_SYS  */;

  14556 11 005475   200000 222003                    LDX2    65536,DU
        11 005476   005765 742000 1                  STX2    TELL_CONSOLES

     2412    14557    4                    TELL_CONSOLES.TYPE = 3;

  14557 11 005477   000003 236003                    LDQ     3,DU
        11 005500   005772 552020 1                  STBQ    TELL_CONSOLES+5,'20'O

     2413    14558    4                    CALL M$WRITE(WR_CSCG)

  14558 11 005501   005774 630400 1                  EPPR0   WR_CSCG
        11 005502   440001 713400                    CLIMB   alt,write
        11 005503   401400 401760                    pmme    nvectors=4
        11 005504   005506 702000 11                 TSX2    s:14562

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:274  
     2414    14559    5                    WHENRETURN DO;

     2415    14560    5                           GOOSE_ON = %NO#;

  14560 11 005505   002561 450000 1                  STZ     GOOSE_ON

     2416    14561    5                         END;              /* Whenreturn */

     2417    14562    4                  END;

  14562 11 005506   005610 710000 11                 TRA     s:14627

     2418    14563                                                /**/
     2419    14564    3          CASE (4 /* KEY_GOOSEMON# */);

     2420    14565    3             IF GOOSEM_ON

  14565 11 005507   002566 234000 1                  SZN     GOOSEM_ON
        11 005510   005523 605000 11                 TPL     s:14576

     2421    14566    3             THEN
     2422    14567    4               DO;

     2423    14568    4                    TELL_CONSOLES.CADDR = ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR;
             14568                             /* Error */

  14568 11 005511   000376 722000 1                  LXL2    CSCG_BUF
        11 005512   005765 742000 1                  STX2    TELL_CONSOLES

     2424    14569    4                    TELL_CONSOLES.TYPE = 8; /* Allready on */

  14569 11 005513   000010 236003                    LDQ     8,DU
        11 005514   005772 552020 1                  STBQ    TELL_CONSOLES+5,'20'O

     2425    14570    4                    IF ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR ~= '777777'O
             14570                             /* From online */

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:275  
  14570 11 005515   777777 102003                    CMPX2   -1,DU
        11 005516   005610 600000 11                 TZE     s:14627

     2426    14571    4                    THEN
     2427    14572    4                         CALL M$WRITE(WR_CSCG) ;

  14572 11 005517   005774 630400 1                  EPPR0   WR_CSCG
        11 005520   040001 713400                    CLIMB   write
        11 005521   401400 401760                    pmme    nvectors=4

     2428    14573    4                  END;

  14573 11 005522   005610 710000 11                 TRA     s:14627

     2429    14574    3             ELSE
     2430    14575    4               DO;

     2431    14576    4                    TELL_CONSOLES.CADDR = '200000'O /* M_SYS  */;

  14576 11 005523   200000 222003                    LDX2    65536,DU
        11 005524   005765 742000 1                  STX2    TELL_CONSOLES

     2432    14577    4                    TELL_CONSOLES.TYPE = 7;

  14577 11 005525   000007 236003                    LDQ     7,DU
        11 005526   005772 552020 1                  STBQ    TELL_CONSOLES+5,'20'O

     2433    14578    4                    CALL M$WRITE(WR_CSCG)

  14578 11 005527   005774 630400 1                  EPPR0   WR_CSCG
        11 005530   440001 713400                    CLIMB   alt,write
        11 005531   401400 401760                    pmme    nvectors=4
        11 005532   005535 702000 11                 TSX2    s:14582

     2434    14579    5                    WHENRETURN DO;

     2435    14580    5                           GOOSEM_ON = %YES#;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:276  

  14580 11 005533   400000 236003                    LDQ     -131072,DU
        11 005534   002566 756000 1                  STQ     GOOSEM_ON

     2436    14581    5                         END;              /* Whenreturn */

     2437    14582    4                  END;

  14582 11 005535   005610 710000 11                 TRA     s:14627

     2438    14583                                                /**/
     2439    14584    3          CASE (5 /* KEY_GOOSEMOFF# */);

     2440    14585    3             IF ~GOOSEM_ON

  14585 11 005536   002566 236000 1                  LDQ     GOOSEM_ON
        11 005537   400000 376003                    ANQ     -131072,DU
        11 005540   400000 676003                    ERQ     -131072,DU
        11 005541   005554 600000 11                 TZE     s:14596

     2441    14586    3             THEN
     2442    14587    4               DO;

     2443    14588    4                    TELL_CONSOLES.CADDR = ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR;
             14588                             /* Error */

  14588 11 005542   000376 722000 1                  LXL2    CSCG_BUF
        11 005543   005765 742000 1                  STX2    TELL_CONSOLES

     2444    14589    4                    TELL_CONSOLES.TYPE = 6; /* Allready off */

  14589 11 005544   000006 236003                    LDQ     6,DU
        11 005545   005772 552020 1                  STBQ    TELL_CONSOLES+5,'20'O

     2445    14590    4                    IF ADDR (CSCG_BUF) -> CSCG_KEYIN.CADDR ~= '777777'O
             14590                             /* From online */

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:277  
  14590 11 005546   777777 102003                    CMPX2   -1,DU
        11 005547   005610 600000 11                 TZE     s:14627

     2446    14591    4                    THEN
     2447    14592    4                         CALL M$WRITE(WR_CSCG) ;

  14592 11 005550   005774 630400 1                  EPPR0   WR_CSCG
        11 005551   040001 713400                    CLIMB   write
        11 005552   401400 401760                    pmme    nvectors=4

     2448    14593    4                  END;

  14593 11 005553   005610 710000 11                 TRA     s:14627

     2449    14594    3             ELSE
     2450    14595    4               DO;

     2451    14596    4                    TELL_CONSOLES.CADDR = '200000'O /* M_SYS  */;

  14596 11 005554   200000 222003                    LDX2    65536,DU
        11 005555   005765 742000 1                  STX2    TELL_CONSOLES

     2452    14597    4                    TELL_CONSOLES.TYPE = 5;

  14597 11 005556   000005 236003                    LDQ     5,DU
        11 005557   005772 552020 1                  STBQ    TELL_CONSOLES+5,'20'O

     2453    14598    4                    CALL M$WRITE(WR_CSCG)

  14598 11 005560   005774 630400 1                  EPPR0   WR_CSCG
        11 005561   440001 713400                    CLIMB   alt,write
        11 005562   401400 401760                    pmme    nvectors=4
        11 005563   005565 702000 11                 TSX2    s:14602

     2454    14599    5                    WHENRETURN DO;

     2455    14600    5                           GOOSEM_ON = %NO#;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:278  

  14600 11 005564   002566 450000 1                  STZ     GOOSEM_ON

     2456    14601    5                         END;              /* Whenreturn */

     2457    14602    4                  END;

  14602 11 005565   005610 710000 11                 TRA     s:14627

     2458    14603                                                /**/
     2459    14604    3          CASE (3 /* KEY_GOOSEUPD# */);            /* Want an update */

     2460    14605    3             TELL_CONSOLES.CADDR = '200000'O /* M_SYS  */;  /* Tell system consoles */

  14605 11 005566   200000 222003                    LDX2    65536,DU
        11 005567   005765 742000 1                  STX2    TELL_CONSOLES

     2461    14606    3             TELL_CONSOLES.TYPE=4;         /* Update message */

  14606 11 005570   000004 236003                    LDQ     4,DU
        11 005571   005772 552020 1                  STBQ    TELL_CONSOLES+5,'20'O

     2462    14607    3             CALL M$WRITE(WR_CSCG) ;

  14607 11 005572   005774 630400 1                  EPPR0   WR_CSCG
        11 005573   040001 713400                    CLIMB   write
        11 005574   401400 401760                    pmme    nvectors=4

     2463    14608    3             MODIFY_DATE = 0;              /* Forces update */

  14608 11 005575   200032 450100                    STZ     MODIFY_DATE,,AUTO
        11 005576   005610 710000 11                 TRA     s:14627

     2464    14609
     2465    14610    3          CASE (ELSE);

     2466    14611
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:279  
     2467    14612                                                /**/
     2468    14613                                      /* Have yet to receive ok to start
     2469    14614                                         from slug. */
     2470    14615                                                /**/
     2471    14616    4             DO CASE (ADDR (CSCG_BUF) -> CSCG_EVENT.CODE);

  14616 11 005577   000376 236000 1                  LDQ     CSCG_BUF
        11 005600   000033 772000                    QRL     27
        11 005601   000002 116007                    CMPQ    2,DL
        11 005602   005604 602006 11                 TNC     s:14616+5,QL
        11 005603   005610 710000 11                 TRA     s:14627
        11 005604   005610 710000 11                 TRA     s:14627
        11 005605   005606 710000 11                 TRA     s:14624

     2472    14617                                                /**/
     2473    14618                                      /* SUSR# (start user) is a message
     2474    14619                                         from slug which means goose can
     2475    14620                                         now build and execute the time
     2476    14621                                         table.         */
     2477    14622                                                /**/
     2478    14623    4             CASE (1 /* SUSR# */);

     2479    14624    4                GREEN_LIGHT = %YES#;

  14624 11 005606   400000 236003                    LDQ     -131072,DU
        11 005607   002570 756000 1                  STQ     GREEN_LIGHT

     2480    14625    4             END;

     2481    14626    3          END;                             /* End cases */

     2482    14627    2        GOOSE_READ_FLAG = %NO#;

  14627 11 005610   000374 450000 1                  STZ     GOOSE_READ_FLAG

     2483    14628    2        CALL M$READ(READ_CSCG);            /* Read from cscg */

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:280  
  14628 11 005611   004660 630400 1                  EPPR0   READ_CSCG
        11 005612   040000 713400                    CLIMB   read
        11 005613   401400 401760                    pmme    nvectors=4

     2484    14629    2   END DO$EVENT;

  14629 11 005614   200040 221300                    LDX1  ! XUG$+2,,AUTO
        11 005615   000001 702211                    TSX2  ! 1,X1
     2485    14630        %EJECT;
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:281  
     2486    14631    1   END IAA$GOOSE;
     2487    14632        %EOD;

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:282  
--  Include file information  --

   XU_SUBS_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XUG_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   JG_EVID_C.:E05TOU  is referenced.
   IA_MACRO_C.:E05TOU  is referenced.
   IA_PERR_C.:E05TOU  is referenced.
   IA_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   IA_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure IAA$GOOSE.
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:283  

 **** Variables and constants ****

  ****  Section 001  Data  IAA$GOOSE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  3724-0-0/w STRC(126)   r     1 ACS_ACCT                3730-0-0/w STRC(225)   r     1 ACS_VEH
  5576-0-0/d STRC(144)   r     1 CHECK_SIUC              4340-0-0/d STRC(1080)  r     1 CLOSE_OCSCG
  4074-0-0/d STRC(1080)  r     1 CLOSE_S                 5250-0-0/d STRC(1080)  r     1 CLOSE_SCHED_REL
  5324-0-0/d STRC(1080)  r     1 CLOSE_TEMP              5362-0-0/d STRC(1080)  r     1 CLOSE_TEMP_REL
  3632-0-0/d STRC(2088)  r     1 CREATE_EGG              4035-0-0/c STRC(45)    r     1 CSCGNM
   376-0-0/c CHAR(140)   r     1 CSCG_BUF                3600-0-0/d STRC(936)   r     1 CSCG_ERR
   443-0-0/w SBIN        r     1 CURR_TIME                442-0-0/w UBIN        r     1 CURR_TIME_HOLD
   444-0-0/c CHAR(8)     r     1 DO_ACCT                  446-0-0/c CHAR(256)   r     1 DO_CMD
   546-0-0/c STRC(90)    r     1 DO_DATE                  546-0-0/c STRC(90)    r     1 DO_DATER
  4676-0-0/d STRC(144)   r     1 DO_EVENT                 551-0-0/c CHAR(8)     r     1 DO_PASS
   553-0-0/c STRC(108)   r     1 EDIT_CMD                 556-0-0/c STRC        r     1 EDIT_KEY
  4722-0-0/c STRC(45)    r     1 EDIT_NAME                226-0-0/d STRC(1512)  r     1 EGG_GETCMD
   557-0-0/w SBIN        r     1 ELAPSED_MINS            4132-0-0/w STRC        r     1 ERROR
  4206-0-0/d STRC(216)   r     1 FIVE_SECOND              560-0-0/w UBIN        r     1 FPARAM(0:1023)
  3570-0-0/d STRC(216)   r     1 FREE_DATA               4164-0-0/d STRC(432)   r     1 GET_CURR
  4150-0-0/d STRC(432)   r     1 GET_DAY                 3562-0-0/d STRC(216)   r     1 GET_ENTRY
  5602-0-0/d STRC(144)   r     1 GET_OPRIV                 44-0-0/d STRC(1296)  r     1 GHOST_INIT
  5476-0-0/c STRC(72)    r     1 GJOB_ACCT               5466-0-0/c STRC(288)   r     1 GJOB_NAME
  5500-0-0/c STRC(72)    r     1 GJOB_PASS               5502-0-0/d STRC(72)    r     1 GJOB_RESULTS
  4522-0-0/w STRC(288)   r     1 GOOSE                   4442-0-0/d STRC(432)   r     1 GOOSEM_OFF
  2565-0-0/c STRC        r     1 GOOSEM_OFF_M            2566-0-0/b BIT         r     1 GOOSEM_ON
  2567-0-0/c STRC        r     1 GOOSEM_ON_M             4426-0-0/d STRC(432)   r     1 GOOSEM_ON_WR
   373-0-0/b BIT         r     1 GOOSE_ERR               4412-0-0/d STRC(432)   r     1 GOOSE_OFF
  2560-0-0/c STRC        r     1 GOOSE_OFF_M             2561-0-0/b BIT         r     1 GOOSE_ON
  2562-0-0/c STRC        r     1 GOOSE_ON_M              4376-0-0/d STRC(432)   r     1 GOOSE_ON_WR
   375-0-0/w PTR         r     1 GOOSE_OUT$               374-0-0/b BIT         r     1 GOOSE_READ_FLAG
  4644-0-0/w STRC(432)   r     1 GOOSE_SET               5762-0-0/c STRC(108)   r     1 GOOSE_TABLE
  5710-0-0/d STRC(1080)  r     1 GOOSE_TABLE_CLOSE       5616-0-0/d STRC(2088)  r     1 GOOSE_TABLE_OPEN
  5746-0-0/d STRC(432)   r     1 GOOSE_TABLE_WRITE       2564-0-0/c STRC        r     1 GOOSE_UPD_M
  2570-0-0/b BIT         r     1 GREEN_LIGHT             5612-0-0/c STRC(54)    r     1 HELP_NAME
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:284  
  2572-0-0/c CHAR(1024)  r     1 INBUF                   4506-0-0/d STRC(432)   r     1 KEYIN_CSCG
  3172-0-0/c STRC(72)    r     1 LAST_DATE               3175-0-0/w SBIN(18)    r     1 LAST_TIME
  4702-0-0/d STRC(576)   r     1 LINK_EDIT               4750-0-0/d STRC(576)   r     1 LINK_LIST
  4726-0-0/d STRC(576)   r     1 LINK_PCL                3204-0-0/c STRC(225)   r     1 LIST_CMD
  4200-0-0/d STRC(216)   r     1 MAIN_WAIT               4032-0-0/c STRC(90)    r     1 NAME
  3214-0-0/w SBIN        r     1 NUM_DAYS                4324-0-0/w STRC(432)   r     1 OGOOSE_SET
   154-0-0/d STRC(1512)  r     1 ONLINE_GETCMD              0-0-0/d STRC(1296)  r     1 ONLINE_INIT
  3215-0-0/w BIT         r     1 ON_LINE                 4552-0-0/d STRC(2088)  r     1 OPEN_CSCG
  4232-0-0/d STRC(2088)  r     1 OPEN_OCSCG              3740-0-0/d STRC(2088)  r     1 OPEN_S
  5064-0-0/d STRC(2088)  r     1 OPEN_S_OUT              4770-0-0/d STRC(2088)  r     1 OPEN_TEMP
  5156-0-0/d STRC(2088)  r     1 OPEN_TEMP_IN            5504-0-0/d STRC(2088)  r     1 OPEN_TEST
  3216-0-0/w UBIN        r     1 OUR_TIME_ESTIMATE       4134-0-0/d STRC(432)   r     1 OUT_MESS
  3531-0-0/c STRC(369)   r     1 PCL_CMD                 4746-0-0/c STRC        r     1 PCL_NAME
  4056-0-0/d STRC(504)   r     1 READ_CMD                4660-0-0/d STRC(504)   r     1 READ_CSCG
  4040-0-0/d STRC(504)   r     1 READ_S                  4214-0-0/d STRC(504)   r     1 READ_SI
  5306-0-0/d STRC(504)   r     1 READ_TEMP               5606-0-0/d STRC(144)   r     1 RESET_FMSEC
  3576-0-0/d STRC(72)    r     1 SEG_VLP                  341-0-0/c STRC(909)   r     1 SEND_KEYIN
  5450-0-0/d STRC(504)   r     1 START_GJOB              3544-0-0/w SBIN        r     1 START_TIME
  3545-0-0/b BIT         r     1 START_UP                4542-0-0/w STRC(288)   r     1 STA_KEYIN
  4724-0-0/c STRC(72)    r     1 SYSACCT                 3546-0-0/c CHAR(6)     r     1 SYSID
   300-0-0/c STRC(1161)  r     1 TELL_CONSOLES           5765-0-0/c STRC(198)   r     1 TELL_CONSOLES
  4472-0-0/d STRC(432)   r     1 TELL_CSCG               5062-0-0/c STRC(63)    r     1 TEMP_NAME
  3550-0-0/c STRC(72)    r     1 TEXT_DATE               3550-0-0/c STRC(72)    r     1 TEXT_DATER
  3552-0-0/c CHAR(3)     r     1 TEXT_DAY                3553-0-0/c STRC(72)    r     1 TEXT_TIME
  3555-0-0/w PTR         r     1 TIME_ENTRY$             3556-0-0/w PTR         r     1 TIME_HEAD$
  3557-0-0/w SBIN        r     1 TIME_LEFT               3560-0-0/b BIT         r     1 TIME_WARP
   110-0-0/d STRC(1296)  r     1 UPDATE_INIT             4456-0-0/d STRC(432)   r     1 WGOOSE_UPD
  5434-0-0/d STRC(432)   r     1 WRITE_SCHED             5420-0-0/d STRC(432)   r     1 WRITE_TEMP
  5774-0-0/d STRC(432)   r     1 WR_CSCG

  ****  Section 010 RoData IAA$GOOSE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/d STRC(144)   r     1 FPT_INT                    6-0-0/c CHAR(12)    r     1 NO_GHOST
     0-0-0/c STRC(18)    r     1 OPROMPT
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:285  

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    47-0-0/w PTR         r     1 @ACCOUNT                  44-0-0/w PTR         r     1 @COMMAND
    43-0-0/w PTR         r     1 @FID                      50-0-0/w PTR         r     1 @PASS
    46-0-0/w PTR         r     1 @SIZE                     41-0-0/w PTR         r     1 @TIME
    75-0-0/w PTR         r     1 @TIME                     45-0-0/w PTR         r     1 @TYPE
    *0-0-0/c CHAR(8)     r     1 ACCOUNT                   73-0-0/w SBIN        r     1 BUF_START
    *0-0-0/c CHAR(256)   r     1 COMMAND                  113-0-0/w UBIN        r     1 CONV_BEGIN
   115-0-0/w UBIN        r     1 CONV_CURRENT             112-0-0/w UBIN        r     1 CONV_DY
   114-0-0/w UBIN        r     1 CONV_END                 111-0-0/w UBIN        r     1 CONV_MO
   110-0-0/w UBIN        r     1 CONV_YR                  102-0-0/c STRC(90)    r     1 DO_BEGIN_RANGE
   102-0-0/c STRC(90)    r     1 DO_BEGIN_SINGLE            3-0-0/w UBIN(9)     r     1 DO_CMD_SIZE
     4-0-0/c CHAR(3)     r     1 DO_DAY(0:6)              105-0-0/c STRC(90)    r     1 DO_END_RANGE
   105-0-0/c STRC(90)    r     1 DO_END_SINGLE             12-0-0/w SBIN        r     1 DO_EVERY
    13-0-0/c STRC(180)   r     1 DO_FID                    20-0-0/w SBIN        r     1 DO_FROM
    21-0-0/w SBIN        r     1 DO_HOUR                   22-0-0/w SBIN        r     1 DO_OFFSET
    23-0-0/w SBIN        r     1 DO_TMIN                   24-0-0/w UBIN(9)     r     1 DO_TYPE
    25-0-0/w SBIN        r     1 DO_UMIN                   26-0-0/w SBIN        r     1 DO_UNTIL
    44-0-0/b BIT         r     1 DUMP_TABLE                27-0-0/b BIT         r     1 ERROR_FLAG
    *0-0-0/c ASTR(9)     r     1 FID                       30-0-0/w UBIN        r     1 GOOSE_ERROR
    31-0-0/w SBIN        r     1 I                         41-0-0/w SBIN        r     1 I
    75-0-0/w SBIN        r     1 I                         42-0-0/w SBIN        r     1 J
    76-0-0/w SBIN        r     1 J                         77-0-0/w SBIN        r     1 K
    76-0-0/w PTR         r     1 LAST_ENTRY$               32-0-0/w UBIN        r     1 MODIFY_DATE
   100-0-0/w PTR         r     1 NEW_ENTRY$                47-0-0/c CHAR(80)    r     1 OUTBUF
    *0-0-0/c CHAR(8)     r     1 PASS                      33-0-0/w PTR         r     1 PTR$
    34-0-0/w PTR         r     1 RLT$                      77-0-0/w PTR         r     1 SAVE_ENTRY$
   100-0-0/w UBIN        r     1 SIZE                      *0-0-0/c UBIN(9)     r     1 SIZE
   101-0-0/w UBIN        r     1 SYN_ERR                   35-0-0/w PTR         r     1 TEMP$
    45-0-0/c CHAR(6)     r     1 TEMP_TIME                 *0-0-0/w UBIN        r     1 TIME
    43-0-0/w SBIN        r     1 TIME                      *0-0-0/w SBIN        r     1 TIME
    *0-0-0/c UBIN(9)     r     1 TYPE                      36-0-0/w PTR         r     1 XUG$

PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:286  
  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w REMB        r     1 ABORT_CMD                  0-0-0/w PTR         r     1 B$JIT$
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/c CHAR        r     1 B_VERSION
     0-0-0/w UBIN        r     1 CYCLE_DAYS_CURRENT         0-0-0/w UBIN        r     1 CYCLE_DAYS_LAST
     0-0-0/w PTR         r     1 GOOSE_NODES                0-0-0/w PTR         r     1 GOOSE_ONODES
     0-0-0/w PTR         r     1 GOOSE_ONODES2              0-0-0/c CHAR(256)   r     1 MESS_BUF
     0-0-0/w SBIN        r     1 TEMP_DAYS                  0-0-0/w SBIN        r     1 TEMP_MONTHS
     0-0-0/w SBIN        r     1 TEMP_SEC                   0-0-0/w SBIN        r     1 TEMP_YEARS
     0-0-0/w UBIN        r     1 TIME_DIFF                  0-0-0/w SBIN        r     1 TOTAL_DAYS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ASTR(9)     r     1 B$VERSIONB
     0-0-0/c ACHR        r     1 BTEXT                      0-0-0/c CHAR(255)   r     1 CMD_BUFFER
     0-0-0/w STRC(396)   r     1 CODE04                     0-0-0/w STRC(27)    r     1 CSCG_EVENT
     0-0-0/h STRC(1260)  r     1 CSCG_KEYIN                 0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$CSCG                     0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$SCHED
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$TABLE
     0-0-0N  NULL        r     1 M$TEMP                     0-0-0N  NULL        r     1 M$UC
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/c UBIN(9)     r     1 RLT(0:0)                   0-0-0/w STRC(2736)  r     1 TIME_TABLE
     0-0-0/d STRC(9612)  r     1 XUG


   Procedure IAA$GOOSE requires 2958 words for executable code.
   Procedure IAA$GOOSE requires 84 words of local(AUTO) storage.
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:287  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:288  
          MINI XREF LISTING

ABORT_CMD
      6414**DCL     12806<<REMEMBR 12827<<REMEMBR 12844<<REMEMBR 12965<<REMEMBR
ACCOUNT IN PROCEDURE DO$COMMAND
     14343**DCL     14341--PROC    14365>>CALLBLT 14385>>IF      14391>>ASSIGN
ACS_ACCT
     10151**DCL     10096--DCLINIT 11824--DCLINIT
ACS_ACCT.Q
     10152**DCL     10151--DCLINIT
ACS_VEH
     10184**DCL     10097--DCLINIT 11825--DCLINIT
ACS_VEH.Q
     10185**DCL     10184--DCLINIT
ADJUST_TIME
     12574**LABEL   12580--GOTO    12680--GOTO    12732--GOTO
B$ALT.CODE
      7147**DCL      7147--REDEF    7148--REDEF    7148--REDEF
B$ALT.ERR
      7148**DCL     12969>>ASSIGN  12975>>ASSIGN  12999>>ASSIGN  13014>>ASSIGN  13024>>ASSIGN  13031>>ASSIGN
     13071>>ASSIGN  13129>>ASSIGN  13528>>ASSIGN  13546>>ASSIGN  14412>>ASSIGN
B$ALT.ERR.ERR#
      7149**DCL      7149--REDEF
B$ALT.EVID
      7148**DCL      7148--REDEF    7148--REDEF
B$JIT.ACCN
      6068**DCL     12879>>ASSIGN  13824>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      6162**DCL      6162--REDEF
B$JIT.ERR.MID
      6069**DCL      6069--REDEF
B$JIT.JRESPEAK
      6230**DCL      6231--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:289  
      6339**DCL      6339--REDEF    6340--REDEF
B$JIT.PNR
      6243**DCL      6243--REDEF
B$JIT.SYSID
      6068**DCL     12560>>IF
B$JIT.TSLINE
      6337**DCL      6338--REDEF
B$JIT$
      9740**DCL      6063--IMP-PTR 12560>>IF      12879>>ASSIGN  13824>>ASSIGN
B$TCB.ALT$
      7143**DCL     12969>>ASSIGN  12975>>ASSIGN  12999>>ASSIGN  13014>>ASSIGN  13024>>ASSIGN  13031>>ASSIGN
     13071>>ASSIGN  13129>>ASSIGN  13528>>ASSIGN  13546>>ASSIGN  14412>>ASSIGN
B$TCB$
      9739**DCL     12969>>ASSIGN  12975>>ASSIGN  12999>>ASSIGN  13014>>ASSIGN  13024>>ASSIGN  13031>>ASSIGN
     13071>>ASSIGN  13129>>ASSIGN  13528>>ASSIGN  13546>>ASSIGN  14412>>ASSIGN
B$VERSIONB.C_
      9852**DCL      9853--IMP-SIZ 12824>>CALLBLT
B$VERSIONB.T_
      9853**DCL     12824>>CALLBLT
BTEXT IN PROCEDURE PARSE$COMMAND
     13774**DCL     13858>>CALLBLT
BUF_START IN PROCEDURE BUILD$TIME
     13289**DCL     13677<<ASSIGN  13682>>ASSIGN  13685>>ASSIGN  13688>>ASSIGN  13691>>ASSIGN  13694<<ASSIGN
     13696>>ASSIGN  13697<<ASSIGN  13697>>ASSIGN  13698>>ASSIGN  13699<<ASSIGN  13699>>ASSIGN  13703>>ASSIGN
     13704<<ASSIGN  13704>>ASSIGN  13707>>ASSIGN  13708<<ASSIGN  13708>>ASSIGN  13709>>ASSIGN  13710<<ASSIGN
     13710>>ASSIGN  13712>>ASSIGN  13713<<ASSIGN  13713>>ASSIGN  13715>>ASSIGN  13716<<ASSIGN  13716>>ASSIGN
     13718>>ASSIGN  13719<<ASSIGN  13719>>ASSIGN  13725>>ASSIGN
BUILD$TIME
     13281**PROC    12655--CALL    12693--CALL    12756--CALL
B_VERSION
      9850**DCL     12824--CALLBLT 12824--CALLBLT
CHECK$TIME
     13238**PROC    12689--CALL    12702--CALL
CHECK_END
     12866**LABEL   12849--GOTO    13087--CALLALT
CHECK_SIUC.V
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:290  
     12458**DCL     12458--DCLINIT
CLOSE_FILES
     13139**LABEL   12965--REMEMBR
CLOSE_OCSCG
     10899**DCL     12918<>CALL    12925<>CALL    12933<>CALL    12940<>CALL    12948<>CALL    13005<>CALL
     13016<>CALL    13127<>CALL    13139<>CALL
CLOSE_OCSCG.SN_
     10899**DCL     10899--REDEF
CLOSE_OCSCG.UTL_
     10900**DCL     10900--REDEF
CLOSE_OCSCG.V
     10904**DCL     10899--DCLINIT
CLOSE_OCSCG.V.EXPIRE#
     10914**DCL     10914--REDEF
CLOSE_OCSCG.V.TYPE#
     10912**DCL     10912--REDEF
CLOSE_OCSCG.V.XTNSIZE#
     10909**DCL     10909--REDEF   10911--REDEF
CLOSE_REL_S_AND_TEMP
     13135**LABEL   13073--GOTO    13096--GOTO    13117--GOTO
CLOSE_S
     10506**DCL     12977<>CALL    13000<>CALL    13033<>CALL    13100<>CALL    13141<>CALL    13540<>CALL
     13669<>CALL
CLOSE_S.SN_
     10506**DCL     10506--REDEF
CLOSE_S.UTL_
     10507**DCL     10507--REDEF
CLOSE_S.V
     10511**DCL     10506--DCLINIT
CLOSE_S.V.DISP#
     10515**DCL     13135<<ASSIGN  13142<<ASSIGN
CLOSE_S.V.EXPIRE#
     10521**DCL     10521--REDEF
CLOSE_S.V.TYPE#
     10519**DCL     10519--REDEF
CLOSE_S.V.XTNSIZE#
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:291  
     10516**DCL     10516--REDEF   10518--REDEF
CLOSE_SCHED_REL
     12005**DCL     13090<>CALL
CLOSE_SCHED_REL.SN_
     12005**DCL     12005--REDEF
CLOSE_SCHED_REL.UTL_
     12006**DCL     12006--REDEF
CLOSE_SCHED_REL.V
     12010**DCL     12005--DCLINIT
CLOSE_SCHED_REL.V.EXPIRE#
     12020**DCL     12020--REDEF
CLOSE_SCHED_REL.V.TYPE#
     12018**DCL     12018--REDEF
CLOSE_SCHED_REL.V.XTNSIZE#
     12015**DCL     12015--REDEF   12017--REDEF
CLOSE_TEMP
     12093**DCL     13001<>CALL    13091<>CALL    13140<>CALL
CLOSE_TEMP.SN_
     12093**DCL     12093--REDEF
CLOSE_TEMP.UTL_
     12094**DCL     12094--REDEF
CLOSE_TEMP.V
     12098**DCL     12093--DCLINIT
CLOSE_TEMP.V.DISP#
     12102**DCL     13137<<ASSIGN  13143<<ASSIGN
CLOSE_TEMP.V.EXPIRE#
     12108**DCL     12108--REDEF
CLOSE_TEMP.V.TYPE#
     12106**DCL     12106--REDEF
CLOSE_TEMP.V.XTNSIZE#
     12103**DCL     12103--REDEF   12105--REDEF
CLOSE_TEMP_REL
     12138**DCL     13101<>CALL
CLOSE_TEMP_REL.SN_
     12138**DCL     12138--REDEF
CLOSE_TEMP_REL.UTL_
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:292  
     12139**DCL     12139--REDEF
CLOSE_TEMP_REL.V
     12143**DCL     12138--DCLINIT
CLOSE_TEMP_REL.V.EXPIRE#
     12153**DCL     12153--REDEF
CLOSE_TEMP_REL.V.TYPE#
     12151**DCL     12151--REDEF
CLOSE_TEMP_REL.V.XTNSIZE#
     12148**DCL     12148--REDEF   12150--REDEF
CMD_BUFFER
      9858**DCL     13063>>ASSIGN
CODE04.MODIFY.TIME
     12440**DCL     12753>>IF      13554>>ASSIGN
COMMAND IN PROCEDURE DO$COMMAND
     14348**DCL     14341--PROC    14358>>ASSIGN  14364>>ASSIGN  14404>>IF      14406--ASSIGN  14434>>ASSIGN
     14442>>ASSIGN
CONV_BEGIN IN PROCEDURE PARSE$COMMAND
     13805**DCL     14115<<ASSIGN  14128>>IF      14156>>IF
CONV_CURRENT IN PROCEDURE PARSE$COMMAND
     13807**DCL     14155<<ASSIGN  14156>>IF      14170>>IF
CONV_DY IN PROCEDURE PARSE$COMMAND
     13804**DCL     14108<<CALLBLT 14115>>ASSIGN  14118<<CALLBLT 14125>>ASSIGN  14148<<CALLBLT 14155>>ASSIGN
CONV_END IN PROCEDURE PARSE$COMMAND
     13806**DCL     14125<<ASSIGN  14128>>IF      14170>>IF
CONV_MO IN PROCEDURE PARSE$COMMAND
     13803**DCL     14107<<CALLBLT 14115>>ASSIGN  14117<<CALLBLT 14125>>ASSIGN  14147<<CALLBLT 14155>>ASSIGN
CONV_YR IN PROCEDURE PARSE$COMMAND
     13802**DCL     14106<<CALLBLT 14111>>IF      14112<<ASSIGN  14112>>ASSIGN  14115>>ASSIGN  14116<<CALLBLT
     14121>>IF      14122<<ASSIGN  14122>>ASSIGN  14125>>ASSIGN  14146<<CALLBLT 14151>>IF      14152<<ASSIGN
     14152>>ASSIGN  14155>>ASSIGN
COPY_FILE
     12983**LABEL   12987--EXIT    12994--EXIT
CREATE_EGG
     10094**DCL     13537<>CALL
CREATE_EGG.ACSVEH_
     10096**DCL     10097--REDEF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:293  
CREATE_EGG.ALTKEYS_
     10102**DCL     10103--REDEF   10103--REDEF
CREATE_EGG.HDR_
     10101**DCL     10102--REDEF
CREATE_EGG.TAB_
     10100**DCL     10101--REDEF
CREATE_EGG.UHL_
     10094**DCL     10095--REDEF   10095--REDEF
CREATE_EGG.V
     10103**DCL     10094--DCLINIT
CREATE_EGG.V.FSN#
     10134**DCL     10134--REDEF   10134--REDEF
CREATE_EGG.WSN_
     10100**DCL     10100--REDEF
CSCGNM
     10391**DCL     10800--DCLINIT 11330--DCLINIT
CSCG_BUF
      9752**DCL     11428--DCLINIT 11429--DCLINIT 14521--DOCASE  14528--ASSIGN  14530--IF      14548--ASSIGN
     14550--IF      14568--ASSIGN  14570--IF      14588--ASSIGN  14590--IF      14616--DOCASE
CSCG_ERR.V
     10010**DCL     10006--DCLINIT
CSCG_EVENT.CODE
      9926**DCL     14616>>DOCASE
CSCG_KEYIN.CADDR
      9862**DCL     14528>>ASSIGN  14530>>IF      14548>>ASSIGN  14550>>IF      14568>>ASSIGN  14570>>IF
     14588>>ASSIGN  14590>>IF
CSCG_KEYIN.KEY
      9861**DCL     14521>>DOCASE
CURR_TIME
      9755**DCL     12589<<CALLBLT 12590<<ASSIGN  12590>>ASSIGN  12590>>ASSIGN  12608>>ASSIGN  12627>>ASSIGN
     12644<<CALLBLT 12645<<ASSIGN  12645>>ASSIGN  12645>>ASSIGN  12646>>IF      12652>>ASSIGN  12668<<CALLBLT
     12669<<ASSIGN  12669>>ASSIGN  12669>>ASSIGN  12683>>IF      12688>>ASSIGN  12692<<ASSIGN  12700>>ASSIGN
     12702<>CALL    12703>>ASSIGN  12715<<CALLBLT 12716<<ASSIGN  12716>>ASSIGN  12716>>ASSIGN  12746>>IF
     12757>>ASSIGN  12764>>IF      12770>>ASSIGN  12791>>ASSIGN  12792>>ASSIGN  13171>>ASSIGN  13619>>DOINDEX
     13647>>ASSIGN  14286>>IF
CURR_TIME_HOLD
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:294  
      9754**DCL     12603>>IF      13171<<ASSIGN  13200>>IF      13203>>ASSIGN  13207>>ASSIGN  13215>>ASSIGN
     13221>>ASSIGN
CYCLE_DAYS_CURRENT
      6410**DCL     12603>>IF      12611>>IF      12620>>IF      13183<<ASSIGN  13197>>IF      13212>>IF
     13215>>ASSIGN  13221>>ASSIGN
CYCLE_DAYS_LAST
      6410**DCL     12603>>IF      12611>>IF      12620>>IF      13195<<ASSIGN  13197>>IF      13212>>IF
     13215>>ASSIGN  13221>>ASSIGN
DO$COMMAND
     14341**PROC    12912--CALL    13252--CALL
DO$EVENT
     14459**PROC    12577--CALL    12799--CALL
DO_ACCT
      9756**DCL     12881<<ASSIGN  12899<<ASSIGN  12912<>CALL    13824<<ASSIGN  14211<<ASSIGN  14316>>ASSIGN
DO_BEGIN_RANGE IN PROCEDURE PARSE$COMMAND
     13775**DCL     13780--REDEF   14160>>ASSIGN
DO_BEGIN_RANGE.DD IN PROCEDURE PARSE$COMMAND
     13779**DCL     14018<<CALLBLT 14020<<ASSIGN  14024>>IF      14024>>IF      14032>>IF      14108>>CALLBLT
DO_BEGIN_RANGE.MM IN PROCEDURE PARSE$COMMAND
     13777**DCL     14007<<CALLBLT 14009<<ASSIGN  14010>>IF      14010>>IF      14027>>IF      14027>>IF
     14027>>IF      14027>>IF      14037>>IF      14041>>IF      14046>>IF      14107>>CALLBLT
DO_BEGIN_RANGE.YY IN PROCEDURE PARSE$COMMAND
     13776**DCL     14001<<ASSIGN  14036>>CALLBLT 14106>>CALLBLT
DO_BEGIN_SINGLE.D1 IN PROCEDURE PARSE$COMMAND
     13786**DCL     14021>>IF
DO_BEGIN_SINGLE.D2 IN PROCEDURE PARSE$COMMAND
     13787**DCL     14021>>IF
DO_BEGIN_SINGLE.M1 IN PROCEDURE PARSE$COMMAND
     13783**DCL     14013>>IF
DO_BEGIN_SINGLE.M2 IN PROCEDURE PARSE$COMMAND
     13784**DCL     14013>>IF
DO_BEGIN_SINGLE.Y1 IN PROCEDURE PARSE$COMMAND
     13781**DCL     14002>>IF
DO_BEGIN_SINGLE.Y2 IN PROCEDURE PARSE$COMMAND
     13782**DCL     14002>>IF
DO_CMD
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:295  
      9757**DCL     10459--DCLINIT 10460--DCLINIT 12246--DCLINIT 12878<<ASSIGN  12905<<ASSIGN  12912<>CALL
     13844<<ASSIGN  14189<<ASSIGN  14313>>ASSIGN
DO_CMD_SIZE
      9879**DCL     13826<<ASSIGN  14190<<ASSIGN  14192>>IF      14195<<ASSIGN  14198>>IF      14201<<ASSIGN
     14314>>ASSIGN
DO_DATE
      9758**DCL      9763--REDEF   14160<<ASSIGN  14174<<ASSIGN
DO_DATE.DD
      9762**DCL     13599>>IF      13605>>IF      13605>>IF      13833<<ASSIGN  13954<<CALLBLT 13956<<ASSIGN
     13957>>IF      13957>>IF      13959<<ASSIGN  13965>>IF      13965>>IF      13973>>IF      14184<<ASSIGN
DO_DATE.ERROR
      9761**DCL     14161<<ASSIGN  14175<<ASSIGN  14185<<ASSIGN
DO_DATE.MM
      9760**DCL     13599>>IF      13605>>IF      13605>>IF      13832<<ASSIGN  13938<<CALLBLT 13940<<ASSIGN
     13941>>IF      13941>>IF      13943<<ASSIGN  13945>>IF      13945>>IF      13968>>IF      13968>>IF
     13968>>IF      13968>>IF      13981>>IF      13985>>IF      13990>>IF      14183<<ASSIGN
DO_DATE.YY
      9759**DCL     13599>>IF      13605>>IF      13605>>IF      13834<<ASSIGN  13926<<CALLBLT 13928<<ASSIGN
     13929>>IF      13929>>IF      13931<<ASSIGN  13976>>IF      13978>>CALLBLT 14182<<ASSIGN
DO_DATER.D1
      9769**DCL     13962>>IF
DO_DATER.D2
      9770**DCL     13962>>IF
DO_DATER.M1
      9766**DCL     13948>>IF
DO_DATER.M2
      9767**DCL     13948>>IF      13948>>IF
DO_DATER.Y1
      9764**DCL     13932>>IF
DO_DATER.Y2
      9765**DCL     13932>>IF      13932>>IF
DO_DAY
      9880**DCL     13591<<ASSIGN  13596<<ASSIGN  13599>>IF      13605>>IF      13605>>IF      13605>>IF
     13605>>IF      13605>>IF      13605>>IF      13605>>IF      13605>>IF      13605>>IF      13835<<ASSIGN
     13836<<ASSIGN  13837<<ASSIGN  13838<<ASSIGN  13839<<ASSIGN  13840<<ASSIGN  13841<<ASSIGN  13906<<ASSIGN
     13908<<ASSIGN  13910<<ASSIGN  13912<<ASSIGN  13914<<ASSIGN  13916<<ASSIGN  13918<<ASSIGN
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:296  
DO_END_RANGE IN PROCEDURE PARSE$COMMAND
     13788**DCL     13793--REDEF   14174>>ASSIGN
DO_END_RANGE.DD IN PROCEDURE PARSE$COMMAND
     13792**DCL     14071<<CALLBLT 14073<<ASSIGN  14077>>IF      14077>>IF      14085>>IF      14118>>CALLBLT
DO_END_RANGE.MM IN PROCEDURE PARSE$COMMAND
     13790**DCL     14060<<CALLBLT 14062<<ASSIGN  14063>>IF      14063>>IF      14080>>IF      14080>>IF
     14080>>IF      14080>>IF      14090>>IF      14095>>IF      14100>>IF      14117>>CALLBLT
DO_END_RANGE.YY IN PROCEDURE PARSE$COMMAND
     13789**DCL     14054<<ASSIGN  14089>>CALLBLT 14116>>CALLBLT
DO_END_SINGLE.D1 IN PROCEDURE PARSE$COMMAND
     13799**DCL     14074>>IF
DO_END_SINGLE.D2 IN PROCEDURE PARSE$COMMAND
     13800**DCL     14074>>IF
DO_END_SINGLE.M1 IN PROCEDURE PARSE$COMMAND
     13796**DCL     14066>>IF
DO_END_SINGLE.M2 IN PROCEDURE PARSE$COMMAND
     13797**DCL     14066>>IF
DO_END_SINGLE.Y1 IN PROCEDURE PARSE$COMMAND
     13794**DCL     14055>>IF
DO_END_SINGLE.Y2 IN PROCEDURE PARSE$COMMAND
     13795**DCL     14055>>IF
DO_EVENT
     11460**DCL     12567<>CALL
DO_EVENT.V
     11460**DCL     11460--DCLINIT
DO_EVERY
      9881**DCL     13572>>IF      13615>>IF      13650>>ASSIGN  13652>>ASSIGN  13655>>DOINDEX 13831<<ASSIGN
     13858<<CALLBLT 13861<<ASSIGN  13861>>ASSIGN
DO_FID
      9882**DCL     12912<>CALL    14315>>ASSIGN
DO_FID.SIZE
      9883**DCL     12883<<ASSIGN  12896<<ASSIGN  13843<<ASSIGN  14207<<ASSIGN
DO_FID.TEXT
      9884**DCL     12895<<ASSIGN  13842<<ASSIGN  14206<<ASSIGN
DO_FROM
      9885**DCL     13599>>IF      13602<<ASSIGN  13644>>IF      13650<<ASSIGN  13652<<ASSIGN  13655>>DOINDEX
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:297  
     13845<<ASSIGN  14220<<CALLBLT 14222>>IF      14224<<ASSIGN  14224>>ASSIGN  14235>>IF      14283>>IF
DO_HOUR
      9886**DCL     13577<<ASSIGN  13579>>ASSIGN  13617>>IF      13636>>ASSIGN  13640>>CALL    13827<<ASSIGN
     13876<<CALLBLT 13889>>IF
DO_OFFSET
      9887**DCL     13580>>IF      13580>>IF      13584<<ASSIGN  13584>>ASSIGN  13640>>CALL    13830<<ASSIGN
     13897<<CALLBLT
DO_ONLINE
     12804**LABEL   12806--REMEMBR
DO_PASS
      9771**DCL     12882<<ASSIGN  12902<<ASSIGN  12912<>CALL    13825<<ASSIGN  14217<<ASSIGN  14317>>ASSIGN
DO_TMIN
      9888**DCL     13578<<ASSIGN  13579>>ASSIGN  13620>>IF      13628>>ASSIGN  13633>>IF      13640>>CALL
     13828<<ASSIGN  13883<<ASSIGN  13889>>IF
DO_TYPE
      9889**DCL     12911<<ASSIGN  12912<>CALL    13569>>IF      13849<<ASSIGN  14191>>IF      14312>>ASSIGN
DO_UMIN
      9890**DCL     13572>>IF      13579<<ASSIGN  13623>>ASSIGN  13628>>ASSIGN  13636>>ASSIGN  13640>>CALL
     13829<<ASSIGN  13878<<ASSIGN  13881>>IF      13883>>ASSIGN  13884<<ASSIGN  13886>>IF
DO_UNTIL
      9891**DCL     13655>>DOINDEX 13846<<ASSIGN  14230<<CALLBLT 14232>>IF      14234<<ASSIGN  14234>>ASSIGN
     14235>>IF      14283>>IF
DUMP_TABLE IN PROCEDURE BUILD$TIME
     13286**DCL     13521<<ASSIGN  13570<<ASSIGN  13670>>IF
EDIT_AGAIN
     13002**LABEL   13092--GOTO
EDIT_CMD
      9772**DCL     11481--DCLINIT
EDIT_KEY
      9775**DCL     12179--DCLINIT 12215--DCLINIT
EDIT_KEY.NUM
      9777**DCL     12980<<ASSIGN  12990<<ASSIGN  12990>>ASSIGN  13052<<ASSIGN  13069<<ASSIGN  13069>>ASSIGN
EDIT_NAME
     11512**DCL     11480--DCLINIT
EGG_GETCMD
      8897**DCL     13046<>CALL    13112<>CALL    13114<>CALL    13556<>CALL    13811<>CALL
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:298  
EGG_GETCMD.CONTINUED#
      8957**DCL     13113>>IF
EGG_GETCMD.DCB2_PARAM#
      9082**DCL     13111<<ASSIGN
EGG_GETCMD.DCB_PARAM#
      9077**DCL     13110<<ASSIGN
EGG_GETCMD.ERR#
      8908**DCL     13558<>CALL    13813>>ASSIGN
EGG_GETCMD.INDCB#
      9068**DCL     13045<<ASSIGN  13562<<ASSIGN
EGG_GETCMD.OUT$
      8902**DCL      8908--REDEF   13849>>ASSIGN  13850>>DOINDEX 13851>>ASSIGN
EGG_GETCMD.PCB$
      8922**DCL     13818<>CALL    13820<>CALL    14158<>CALL    14172<>CALL    14193<>CALL    14199<>CALL
     14257<>CALL    14302<>CALL    14415<>CALL    14417<>CALL
ELAPSED_MINS
      9778**DCL     12686>>IF      12688<<ASSIGN  12688>>ASSIGN  12698>>IF      12700<<ASSIGN  12700>>ASSIGN
     12789>>IF      12791<<ASSIGN  12791>>ASSIGN  13580>>IF      13584>>ASSIGN
ERROR
     10538**DCL     10006--DCLINIT 12969<<ASSIGN  12970<>CALL    12975<<ASSIGN  12976<>CALL    12999<<ASSIGN
     13004<>CALL    13014<<ASSIGN  13015<>CALL    13024<<ASSIGN  13025<>CALL    13031<<ASSIGN  13032<>CALL
     13071<<ASSIGN  13072<>CALL    13129<<ASSIGN  13130<>CALL    13528<<ASSIGN  13546<<ASSIGN  13548<>CALL
     13813<<ASSIGN  13818<>CALL    13820<>CALL    14412<<ASSIGN  14415<>CALL    14417<>CALL
ERROR.ERR#
     10568**DCL     13002>>IF      13080>>IF      13107>>IF      13529>>IF      13534>>IF      13814>>IF
     13816>>IF      14159<<ASSIGN  14173<<ASSIGN  14194<<ASSIGN  14200<<ASSIGN  14258<<ASSIGN
ERROR_FLAG
      9892**DCL     13020<<ASSIGN  13082>>IF      13109<<ASSIGN
F$DCB.ACTPOS
      3952**DCL      3952--REDEF
F$DCB.ARS
      3927**DCL      3927--REDEF   12989>>ASSIGN
F$DCB.ATTR
      3945**DCL      3946--REDEF
F$DCB.BORROW
      3960**DCL      3960--REDEF    3960--REDEF    3960--REDEF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:299  
F$DCB.DCBNAME.L
      3974**DCL      3974--IMP-SIZ
F$DCB.EOMCHAR
      3931**DCL      3931--REDEF
F$DCB.FLDID
      3955**DCL      3955--REDEF
F$DCB.FORM$
      3949**DCL      3949--REDEF
F$DCB.FSECT
      3965**DCL      3965--REDEF
F$DCB.FSN
      3942**DCL      3942--REDEF    3942--REDEF    3943--REDEF
F$DCB.HEADER$
      3948**DCL      3948--REDEF
F$DCB.IXTNSIZE
      3946**DCL      3946--REDEF
F$DCB.LASTSTA$
      3936**DCL      3936--REDEF
F$DCB.LVL
      3961**DCL      3961--REDEF
F$DCB.NAME.C
      3936**DCL      3936--REDEF
F$DCB.NOEOF
      3957**DCL      3957--REDEF
F$DCB.NRECS
      3947**DCL      3947--REDEF
F$DCB.NRECX
      3966**DCL      3966--REDEF
F$DCB.OHDR
      3958**DCL      3958--REDEF
F$DCB.ORG
      3941**DCL      3941--REDEF
F$DCB.PRECNO
      3964**DCL      3964--REDEF
F$DCB.RCSZ
      3969**DCL      3969--REDEF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:300  
F$DCB.RES
      3937**DCL      3937--REDEF
F$DCB.SETX
      3949**DCL      3949--REDEF
F$DCB.TAB$
      3948**DCL      3949--REDEF
F$DCB.TDA
      3963**DCL      3963--REDEF
F$DCB.WSN
      3938**DCL      3938--REDEF
FID IN PROCEDURE DO$COMMAND
     14345**DCL     14341--PROC
FID.SIZE IN PROCEDURE DO$COMMAND
     14346**DCL     14347--IMP-SIZ 14365>>CALLBLT 14365>>CALLBLT 14375>>IF      14381>>ASSIGN  14382>>ASSIGN
FID.TEXT IN PROCEDURE DO$COMMAND
     14347**DCL     14365>>CALLBLT 14381>>ASSIGN
FIVE_SECOND
     10679**DCL     12582<>CALL    13531<>CALL
FIVE_SECOND.V
     10680**DCL     10679--DCLINIT
FPARAM
      9779**DCL     10298--DCLINIT 12395--DCLINIT 12750--ASSIGN  13551--ASSIGN
FPT_INT
     12554**DCL     12811<>CALL
FPT_INT.V
     12554**DCL     12554--DCLINIT
FREE_DATA
      9970**DCL     13524<>CALL
FREE_DATA.V
      9970**DCL      9970--DCLINIT
FREE_DATA.V.SEGSIZE#
      9972**DCL     13523<<ASSIGN
GET_CURR
     10643**DCL     12587<>CALL    12642<>CALL    12666<>CALL    12713<>CALL    12807<>CALL
GET_CURR.V
     10647**DCL     10643--DCLINIT
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:301  
GET_DAY
     10620**DCL     12588<>CALL    12643<>CALL    12667<>CALL    12694<>CALL    12714<>CALL
GET_DAY.V
     10624**DCL     10620--DCLINIT
GET_ENTRY
      9951**DCL     14300<>CALL
GET_ENTRY.V
      9951**DCL      9951--DCLINIT
GET_OPRIV
     12475**DCL     12817<>CALL
GET_OPRIV.V
     12475**DCL     12475--DCLINIT
GHOST_INIT
      7701**DCL     13556<>CALL
GJOB_ACCT
     12291**DCL     12245--DCLINIT 14390--ASSIGN
GJOB_ACCT.ACCT#
     12291**DCL     12879<<ASSIGN  14391<<ASSIGN
GJOB_NAME
     12277**DCL     12246--DCLINIT 14380--ASSIGN
GJOB_NAME.L#
     12277**DCL     14382<<ASSIGN
GJOB_NAME.NAME#
     12277**DCL     14381<<ASSIGN
GJOB_PASS
     12305**DCL     14399--ASSIGN
GJOB_PASS.PASS#
     12305**DCL     14398<<ASSIGN
GJOB_RESULTS
     12319**DCL     12247--DCLINIT
GJOB_RESULTS.SYSID
     12319**DCL     14424>>CALLBLT
GOOSE
     11184**DCL     10943--DCLINIT 10979--DCLINIT 11015--DCLINIT 11051--DCLINIT 11087--DCLINIT
GOOSE.MSGIDXT
     11194**DCL     11197--REDEF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:302  
GOOSEM_OFF
     11049**DCL     12939<>CALL
GOOSEM_OFF.STATION_
     11051**DCL     11051--REDEF
GOOSEM_OFF.V
     11052**DCL     11049--DCLINIT
GOOSEM_OFF.V.DVBYTE.VFC#
     11058**DCL     11058--REDEF
GOOSEM_OFF_M
      9794**DCL     11050--DCLINIT 11051--DCLINIT
GOOSEM_ON
      9798**DCL     14367>>IF      14435>>IF      14565>>IF      14580<<ASSIGN  14585>>IF      14600<<ASSIGN
GOOSEM_ON_M
      9799**DCL     11014--DCLINIT 11015--DCLINIT
GOOSEM_ON_WR
     11013**DCL     12932<>CALL
GOOSEM_ON_WR.STATION_
     11015**DCL     11015--REDEF
GOOSEM_ON_WR.V
     11016**DCL     11013--DCLINIT
GOOSEM_ON_WR.V.DVBYTE.VFC#
     11022**DCL     11022--REDEF
GOOSE_ERR
      9741**DCL     14517>>IF
GOOSE_ERROR
      9893**DCL     12986<<ASSIGN  12993<<ASSIGN  13004<>CALL
GOOSE_NODES
      9742**DCL      8898--DCLINIT
GOOSE_OFF
     10977**DCL     12924<>CALL
GOOSE_OFF.STATION_
     10979**DCL     10979--REDEF
GOOSE_OFF.V
     10980**DCL     10977--DCLINIT
GOOSE_OFF.V.DVBYTE.VFC#
     10986**DCL     10986--REDEF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:303  
GOOSE_OFF_M
      9780**DCL     10978--DCLINIT 10979--DCLINIT
GOOSE_ON
      9784**DCL     13250>>IF      14525>>IF      14540<<ASSIGN  14545>>IF      14560<<ASSIGN
GOOSE_ONODES
      9743**DCL     12819--ASSIGN
GOOSE_ONODES2
      9744**DCL     12812--ASSIGN
GOOSE_ON_M
      9785**DCL     10942--DCLINIT 10943--DCLINIT
GOOSE_ON_WR
     10941**DCL     12917<>CALL
GOOSE_ON_WR.STATION_
     10943**DCL     10943--REDEF
GOOSE_ON_WR.V
     10944**DCL     10941--DCLINIT
GOOSE_ON_WR.V.DVBYTE.VFC#
     10950**DCL     10950--REDEF
GOOSE_OUT$
      9748**DCL     12866<<ASSIGN
GOOSE_READ_FLAG
      9747**DCL     12575>>IF      12786>>IF      12797>>IF      14627<<ASSIGN
GOOSE_SET
     11388**DCL     11330--DCLINIT
GOOSE_TABLE IN PROCEDURE BUILD$TIME
     13516**DCL     13368--DCLINIT 13439--DCLINIT
GOOSE_TABLE_CLOSE IN PROCEDURE BUILD$TIME
     13437**DCL     13743<>CALL
GOOSE_TABLE_CLOSE.SN_ IN PROCEDURE BUILD$TIME
     13437**DCL     13437--REDEF
GOOSE_TABLE_CLOSE.UTL_ IN PROCEDURE BUILD$TIME
     13438**DCL     13438--REDEF
GOOSE_TABLE_CLOSE.V IN PROCEDURE BUILD$TIME
     13442**DCL     13437--DCLINIT
GOOSE_TABLE_CLOSE.V.EXPIRE# IN PROCEDURE BUILD$TIME
     13452**DCL     13452--REDEF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:304  
GOOSE_TABLE_CLOSE.V.TYPE# IN PROCEDURE BUILD$TIME
     13450**DCL     13450--REDEF
GOOSE_TABLE_CLOSE.V.XTNSIZE# IN PROCEDURE BUILD$TIME
     13447**DCL     13447--REDEF   13449--REDEF
GOOSE_TABLE_OPEN IN PROCEDURE BUILD$TIME
     13367**DCL     13673<>CALL
GOOSE_TABLE_OPEN.ACSVEH_ IN PROCEDURE BUILD$TIME
     13369**DCL     13370--REDEF
GOOSE_TABLE_OPEN.ALTKEYS_ IN PROCEDURE BUILD$TIME
     13375**DCL     13376--REDEF   13376--REDEF
GOOSE_TABLE_OPEN.HDR_ IN PROCEDURE BUILD$TIME
     13374**DCL     13375--REDEF
GOOSE_TABLE_OPEN.TAB_ IN PROCEDURE BUILD$TIME
     13373**DCL     13374--REDEF
GOOSE_TABLE_OPEN.UHL_ IN PROCEDURE BUILD$TIME
     13367**DCL     13368--REDEF   13368--REDEF
GOOSE_TABLE_OPEN.V IN PROCEDURE BUILD$TIME
     13376**DCL     13367--DCLINIT
GOOSE_TABLE_OPEN.V.FSN# IN PROCEDURE BUILD$TIME
     13407**DCL     13407--REDEF   13407--REDEF
GOOSE_TABLE_OPEN.WSN_ IN PROCEDURE BUILD$TIME
     13373**DCL     13373--REDEF
GOOSE_TABLE_WRITE IN PROCEDURE BUILD$TIME
     13475**DCL     13726<>CALL    13735<>CALL
GOOSE_TABLE_WRITE.BUF_.BOUND IN PROCEDURE BUILD$TIME
     13475**DCL     13725<<ASSIGN  13734<<ASSIGN
GOOSE_TABLE_WRITE.BUF_.BUF$ IN PROCEDURE BUILD$TIME
     13477**DCL     13724<<ASSIGN  13733<<ASSIGN
GOOSE_TABLE_WRITE.STATION_ IN PROCEDURE BUILD$TIME
     13477**DCL     13477--REDEF
GOOSE_TABLE_WRITE.V IN PROCEDURE BUILD$TIME
     13478**DCL     13475--DCLINIT
GOOSE_TABLE_WRITE.V.DVBYTE.VFC# IN PROCEDURE BUILD$TIME
     13484**DCL     13484--REDEF
GOOSE_UPDATE
     12945**LABEL   13104--GOTO
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:305  
GOOSE_UPD_M
      9790**DCL     11086--DCLINIT 11087--DCLINIT
GREEN_LIGHT
      9803**DCL     12578>>IF      14624<<ASSIGN
HELP_NAME
     12523**DCL      7378--DCLINIT  7806--DCLINIT  8235--DCLINIT
I
      9894**DCL     12887<<DOINDEX 12889>>ASSIGN  13062<<DOINDEX 13063>>ASSIGN  13063>>ASSIGN  13064>>ASSIGN
     13065>>IF      13067>>ASSIGN  13075>>ASSIGN
I IN PROCEDURE BUILD$TIME
     13283**DCL     13619<<DOINDEX 13623>>ASSIGN  13628>>ASSIGN  13655<<DOINDEX 13656<>CALL
I IN PROCEDURE PARSE$COMMAND
     13769**DCL     13850<<DOINDEX 13851>>ASSIGN
IAA$ABORT_CMD
      9692**DCL-ENT  7274--DCLINIT
IAA$EVENT
      9691**DCL-ENT 11460--DCLINIT
IAD$DATE
      9686**DCL-ENT 12867--CALL
IAE$CSCG_ERROR
      9689**DCL-ENT 13548--CALL    13558--CALL    14302--CALL
IAE$ERROR
      9688**DCL-ENT 13818--CALL    13820--CALL    14158--CALL    14172--CALL    14193--CALL    14199--CALL
     14257--CALL    14415--CALL    14417--CALL
IAE$ONLINE_ERROR
      9690**DCL-ENT 12841--CALL    12851--CALL    12869--CALL    12919--CALL    12926--CALL    12934--CALL
     12941--CALL    12949--CALL    12970--CALL    12976--CALL    13004--CALL    13015--CALL    13025--CALL
     13032--CALL    13048--CALL    13072--CALL    13085--CALL    13103--CALL    13130--CALL
IAM$CYCLE
      9693**DCL-ENT 13182--CALL    13194--CALL
IAM$LEAP
      9687**DCL-ENT 13181--CALL    13193--CALL
INBUF
      9805**DCL     10416--DCLINIT 10417--DCLINIT 10705--DCLINIT 10706--DCLINIT 12047--DCLINIT 12048--DCLINIT
     12180--DCLINIT 12181--DCLINIT 12216--DCLINIT 12217--DCLINIT 13063<<ASSIGN  13067<<ASSIGN  13086<<ASSIGN
     13088>>IF      13094>>IF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:306  
J IN PROCEDURE BUILD$TIME
     13284**DCL     13622<<DOINDEX 13623>>ASSIGN  13635<<DOINDEX 13636>>ASSIGN
J IN PROCEDURE PARSE$COMMAND
     13770**DCL     13868<<CALLBLT 13903<<DOINDEX 13904>>DOCASE  13906>>ASSIGN  13908>>ASSIGN  13910>>ASSIGN
     13912>>ASSIGN  13914>>ASSIGN  13916>>ASSIGN  13918>>ASSIGN  13978<<CALLBLT 13980<<ASSIGN  13983>>IF
     14036<<CALLBLT 14039>>IF      14089<<CALLBLT 14092>>IF
K IN PROCEDURE PARSE$COMMAND
     13771**DCL     14221<<CALLBLT 14223>>IF      14224>>ASSIGN  14231<<CALLBLT 14233>>IF      14234>>ASSIGN
KEYIN_CSCG
     11157**DCL     14444<>CALL
KEYIN_CSCG.STATION_
     11159**DCL     11159--REDEF
KEYIN_CSCG.V
     11160**DCL     11157--DCLINIT
KEYIN_CSCG.V.DVBYTE.VFC#
     11166**DCL     11166--REDEF
LAST_DATE
      9806**DCL     12704<<ASSIGN  12758<<ASSIGN  12793<<ASSIGN
LAST_DATE.DAY
      9809**DCL     13187>>CALLBLT
LAST_DATE.MON
      9808**DCL     13186>>CALLBLT
LAST_DATE.YR
      9807**DCL     13185>>CALLBLT
LAST_ENTRY$ IN PROCEDURE MAKE$ENTRY
     14277**DCL     14280<<ASSIGN  14292<<ASSIGN  14318>>ASSIGN  14319>>IF
LAST_TIME
      9812**DCL     12602<<ASSIGN  12683>>IF      12688>>ASSIGN  12690<<ASSIGN  12698>>IF      12700>>ASSIGN
     12703<<ASSIGN  12746>>IF      12757<<ASSIGN  12764>>IF      12791>>ASSIGN  12792<<ASSIGN  13158>>IF
     13168>>ASSIGN  14286>>IF
LINK_EDIT
     11480**DCL     13012<>CALL
LINK_EDIT.V
     11482**DCL     11482--DCLINIT
LINK_LIST
     11597**DCL     12863<>CALL
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:307  
LINK_LIST.V
     11599**DCL     11599--DCLINIT
LINK_PCL
     11546**DCL     13102<>CALL
LINK_PCL.V
     11548**DCL     11548--DCLINIT
LIST_CMD
      9814**DCL     11598--DCLINIT
M$CLOSE
        54**DCL-ENT 12918--CALL    12925--CALL    12933--CALL    12940--CALL    12948--CALL    12977--CALL
     13000--CALL    13001--CALL    13005--CALL    13016--CALL    13033--CALL    13090--CALL    13091--CALL
     13100--CALL    13101--CALL    13127--CALL    13139--CALL    13140--CALL    13141--CALL    13540--CALL
     13669--CALL    13743--CALL
M$DO
      9678**DCL     13111>>ASSIGN
M$EVENT
       109**DCL-ENT 12567--CALL
M$EXIT
        66**DCL-ENT 12874--CALL
M$FDS
        89**DCL-ENT 13524--CALL
M$GDS
        89**DCL-ENT 14300--CALL
M$GJOB
       119**DCL-ENT 14410--CALL
M$INT
       109**DCL-ENT 12811--CALL
M$LINK
        66**DCL-ENT 12863--CALL    13012--CALL    13102--CALL
M$LO
      9681**DCL     13110>>ASSIGN
M$OPEN
        54**DCL-ENT 12564--CALL    12749--CALL    12916--CALL    12923--CALL    12931--CALL    12938--CALL
     12945--CALL    12966--CALL    12967--CALL    12973--CALL    13022--CALL    13029--CALL    13526--CALL
     13537--CALL    13673--CALL
M$READ
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:308  
        55**DCL-ENT 12568--CALL    12984--CALL    13087--CALL    14628--CALL
M$RETRY
       111**DCL-ENT 13542--CALL
M$RPRIV
       113**DCL-ENT 12809--CALL    13028--CALL    13539--CALL    13545--CALL    13747--CALL
M$SCHED
      9679**DCL     12989--ASSIGN  13562>>ASSIGN
M$SPRIV
       113**DCL-ENT 12817--CALL    13021--CALL    13536--CALL    13672--CALL
M$TEMP
      9683**DCL     13045>>ASSIGN
M$TIME
       121**DCL-ENT 12587--CALL    12588--CALL    12642--CALL    12643--CALL    12666--CALL    12667--CALL
     12694--CALL    12713--CALL    12714--CALL    12807--CALL
M$WAIT
       112**DCL-ENT 12582--CALL    12794--CALL    13531--CALL
M$WRITE
        55**DCL-ENT 12826--CALL    12917--CALL    12924--CALL    12932--CALL    12939--CALL    12947--CALL
     12991--CALL    13070--CALL    13726--CALL    13735--CALL    14360--CALL    14373--CALL    14428--CALL
     14441--CALL    14444--CALL    14532--CALL    14538--CALL    14552--CALL    14558--CALL    14572--CALL
     14578--CALL    14592--CALL    14598--CALL    14607--CALL
M$XXX
        66**DCL-ENT 12565--CALL    12842--CALL    12853--CALL    13549--CALL    13559--CALL
MAIN_LOOP
     12666**LABEL   12759--GOTO
MAIN_OLOOP
     12826**LABEL   12827--REMEMBR 13049--GOTO    13144--GOTO
MAIN_WAIT
     10663**DCL     12794<>CALL
MAIN_WAIT.V
     10664**DCL     10663--DCLINIT
MAIN_WAIT.V.UNITS#
     10664**DCL     12722<<ASSIGN  12778<<ASSIGN  12780<<ASSIGN  12781>>IF      12783<<ASSIGN  13168>>ASSIGN
MAKE$ENTRY
     14273**PROC    13624--CALL    13629--CALL    13637--CALL    13640--CALL    13656--CALL
MESS_BUF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:309  
      6406**DCL      6406--REDEF   10007--DCLINIT 10593--DCLINIT 10594--DCLINIT 12824<<CALLBLT 13856<<CALLBLT
     13858--CALLBLT 14425<<CALLBLT
MODIFY_DATE
      9895**DCL     12753>>IF      13554<<ASSIGN  14608<<ASSIGN
NAME
     10363**DCL     10294--DCLINIT
NEW_ENTRY$ IN PROCEDURE MAKE$ENTRY
     14279**DCL     14298<<ASSIGN  14305>>IF      14307<<ASSIGN  14309>>ASSIGN  14321>>ASSIGN  14323>>ASSIGN
NO_CAN_DO
     13126**LABEL   12916--CALLALT 12923--CALLALT 12931--CALLALT 12938--CALLALT 12945--CALLALT 12966--CALLALT
NO_CAN_DO_1
     13126**LABEL   12917--CALLALT 12924--CALLALT 12932--CALLALT 12939--CALLALT 12947--CALLALT
NO_GHOST IN PROCEDURE BUILD$TIME
     13290**DCL     13703>>ASSIGN
NO_MORE_MEM IN PROCEDURE BUILD$TIME
     13663**LABEL   13624--CALLALT 13629--CALLALT 13637--CALLALT 13640--CALLALT 13656--CALLALT
NUM_DAYS
      9818**DCL     12630>>IF      12633<<ASSIGN  12691<<ASSIGN  12691>>ASSIGN  13574>>IF      13648>>IF
     13652>>ASSIGN
OGOOSE.MSGIDXT
     11222**DCL     11225--REDEF
OGOOSE_SET
     10857**DCL     10800--DCLINIT
ONLINE_GETCMD
      8546**DCL     12839<>CALL    12846<>CALL
ONLINE_GETCMD.ERR#
      8557**DCL     12841<>CALL    12851<>CALL    13048<>CALL
ONLINE_GETCMD.ERR#.CODE#
      8560**DCL     12848>>IF      12852>>IF
ONLINE_GETCMD.NODES$
      8547**DCL     12812<<ASSIGN  12819<<ASSIGN
ONLINE_GETCMD.OUT$
      8551**DCL      8557--REDEF   12859>>DOCASE  12866>>ASSIGN  12885>>IF      12887>>DOINDEX 12889>>ASSIGN
ONLINE_INIT
      7273**DCL     12839<>CALL
ON_LINE
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:310  
      9819**DCL     12823<<ASSIGN  13818<>CALL    13820<>CALL    14158<>CALL    14172<>CALL    14193<>CALL
     14199<>CALL    14257<>CALL    14367>>IF      14413>>IF      14415<>CALL    14417<>CALL    14421>>IF
OPEN_CSCG
     11329**DCL     12564<>CALL
OPEN_CSCG.ACSVEH_
     11331**DCL     11332--REDEF
OPEN_CSCG.ALTKEYS_
     11337**DCL     11338--REDEF   11338--REDEF
OPEN_CSCG.HDR_
     11336**DCL     11337--REDEF
OPEN_CSCG.TAB_
     11335**DCL     11336--REDEF
OPEN_CSCG.UHL_
     11329**DCL     11330--REDEF   11330--REDEF
OPEN_CSCG.V
     11338**DCL     11329--DCLINIT
OPEN_CSCG.V.FSN#
     11369**DCL     11369--REDEF   11369--REDEF
OPEN_CSCG.WSN_
     11335**DCL     11335--REDEF
OPEN_OCSCG
     10799**DCL     12916<>CALL    12923<>CALL    12931<>CALL    12938<>CALL    12945<>CALL    12966<>CALL
OPEN_OCSCG.ACSVEH_
     10801**DCL     10802--REDEF
OPEN_OCSCG.ALTKEYS_
     10807**DCL     10808--REDEF   10808--REDEF
OPEN_OCSCG.HDR_
     10806**DCL     10807--REDEF
OPEN_OCSCG.TAB_
     10805**DCL     10806--REDEF
OPEN_OCSCG.UHL_
     10799**DCL     10800--REDEF   10800--REDEF
OPEN_OCSCG.V
     10808**DCL     10799--DCLINIT
OPEN_OCSCG.V.FSN#
     10839**DCL     10839--REDEF   10839--REDEF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:311  
OPEN_OCSCG.WSN_
     10805**DCL     10805--REDEF
OPEN_S
     10293**DCL     12967<>CALL    13526<>CALL
OPEN_S.ACSVEH_
     10295**DCL     10296--REDEF
OPEN_S.ALTKEYS_
     10301**DCL     10302--REDEF   10302--REDEF
OPEN_S.HDR_
     10300**DCL     10301--REDEF
OPEN_S.TAB_
     10299**DCL     10300--REDEF
OPEN_S.UHL_
     10293**DCL     10294--REDEF   10294--REDEF
OPEN_S.V
     10302**DCL     10293--DCLINIT
OPEN_S.V.FSN#
     10333**DCL     10333--REDEF   10333--REDEF
OPEN_S.WSN_
     10299**DCL     10299--REDEF
OPEN_S_OUT
     11822**DCL     13022<>CALL
OPEN_S_OUT.ACSVEH_
     11824**DCL     11825--REDEF
OPEN_S_OUT.ALTKEYS_
     11830**DCL     11831--REDEF   11831--REDEF
OPEN_S_OUT.HDR_
     11829**DCL     11830--REDEF
OPEN_S_OUT.TAB_
     11828**DCL     11829--REDEF
OPEN_S_OUT.UHL_
     11822**DCL     11823--REDEF   11823--REDEF
OPEN_S_OUT.V
     11831**DCL     11822--DCLINIT
OPEN_S_OUT.V.FSN#
     11862**DCL     11862--REDEF   11862--REDEF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:312  
OPEN_S_OUT.WSN_
     11828**DCL     11828--REDEF
OPEN_TEMP
     11675**DCL     12973<>CALL
OPEN_TEMP.ACSVEH_
     11677**DCL     11678--REDEF
OPEN_TEMP.ALTKEYS_
     11683**DCL     11684--REDEF   11684--REDEF
OPEN_TEMP.HDR_
     11682**DCL     11683--REDEF
OPEN_TEMP.TAB_
     11681**DCL     11682--REDEF
OPEN_TEMP.UHL_
     11675**DCL     11676--REDEF   11676--REDEF
OPEN_TEMP.V
     11684**DCL     11675--DCLINIT
OPEN_TEMP.V.FSN#
     11715**DCL     11715--REDEF   11715--REDEF
OPEN_TEMP.WSN_
     11681**DCL     11681--REDEF
OPEN_TEMP_IN
     11935**DCL     13029<>CALL
OPEN_TEMP_IN.ACSVEH_
     11937**DCL     11938--REDEF
OPEN_TEMP_IN.ALTKEYS_
     11943**DCL     11944--REDEF   11944--REDEF
OPEN_TEMP_IN.HDR_
     11942**DCL     11943--REDEF
OPEN_TEMP_IN.TAB_
     11941**DCL     11942--REDEF
OPEN_TEMP_IN.UHL_
     11935**DCL     11936--REDEF   11936--REDEF
OPEN_TEMP_IN.V
     11944**DCL     11935--DCLINIT
OPEN_TEMP_IN.V.FSN#
     11975**DCL     11975--REDEF   11975--REDEF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:313  
OPEN_TEMP_IN.WSN_
     11941**DCL     11941--REDEF
OPEN_TEST
     12390**DCL     12749<>CALL
OPEN_TEST.ACSVEH_
     12392**DCL     12393--REDEF
OPEN_TEST.ALTKEYS_
     12398**DCL     12399--REDEF   12399--REDEF
OPEN_TEST.HDR_
     12397**DCL     12398--REDEF
OPEN_TEST.TAB_
     12396**DCL     12397--REDEF
OPEN_TEST.UHL_
     12390**DCL     12391--REDEF   12391--REDEF
OPEN_TEST.V
     12399**DCL     12390--DCLINIT
OPEN_TEST.V.FSN#
     12430**DCL     12430--REDEF   12430--REDEF
OPEN_TEST.WSN_
     12396**DCL     12396--REDEF
OPROMPT
      9820**DCL      8755--DCLINIT
OUR_TIME_ESTIMATE
      9823**DCL     12603>>IF      13168<<ASSIGN  13200>>IF      13203>>ASSIGN  13207>>ASSIGN  13215>>ASSIGN
     13221>>ASSIGN
OUT$BLK.CODE
      7167**DCL     12859>>DOCASE  12892>>DOCASE  13849>>ASSIGN  13852>>DOCASE
OUT$BLK.NSUBLKS
      7171**DCL     12885>>IF      12887>>DOINDEX 13850>>DOINDEX 13895>>IF      13903>>DOINDEX
OUT$BLK.SUBLK$
      7192**DCL     12889>>ASSIGN  13851>>ASSIGN  13856>>CALLBLT 13856>>CALLBLT 13857>>ASSIGN  13859>>IF
     13865>>IF      13868>>CALLBLT 13868>>CALLBLT 13870>>IF      13870>>IF      13870>>IF      13876>>CALLBLT
     13876>>CALLBLT 13878>>ASSIGN  13878>>ASSIGN  13879>>IF      13884>>ASSIGN  13884>>ASSIGN  13895>>IF
     13897>>CALLBLT 13897>>CALLBLT 13897>>CALLBLT 13897>>CALLBLT 13904>>DOCASE  13924>>IF      13926>>CALLBLT
     13926>>CALLBLT 13928>>ASSIGN  13928>>ASSIGN  13936>>IF      13938>>CALLBLT 13938>>CALLBLT 13940>>ASSIGN
     13940>>ASSIGN  13952>>IF      13954>>CALLBLT 13954>>CALLBLT 13956>>ASSIGN  13956>>ASSIGN  13997>>IF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:314  
     14001>>ASSIGN  14001>>ASSIGN  14005>>IF      14007>>CALLBLT 14007>>CALLBLT 14009>>ASSIGN  14009>>ASSIGN
     14016>>IF      14018>>CALLBLT 14018>>CALLBLT 14020>>ASSIGN  14020>>ASSIGN  14050>>IF      14054>>ASSIGN
     14054>>ASSIGN  14058>>IF      14060>>CALLBLT 14060>>CALLBLT 14062>>ASSIGN  14062>>ASSIGN  14069>>IF
     14071>>CALLBLT 14071>>CALLBLT 14073>>ASSIGN  14073>>ASSIGN  14220>>CALLBLT 14220>>CALLBLT 14221>>CALLBLT
     14221>>CALLBLT 14230>>CALLBLT 14230>>CALLBLT 14231>>CALLBLT 14231>>CALLBLT
OUT$SYM.CODE
      7211**DCL     13859>>IF      13865>>IF      13904>>DOCASE
OUT$SYM.COUNT
      7228**DCL      7231--IMP-SIZ 12895>>ASSIGN  12896>>ASSIGN  12899>>ASSIGN  12902>>ASSIGN  12905>>ASSIGN
     13856>>CALLBLT 13857>>ASSIGN  13868>>CALLBLT 13870>>IF      13870>>IF      13876>>CALLBLT 13878>>ASSIGN
     13879>>IF      13884>>ASSIGN  13897>>CALLBLT 13924>>IF      13926>>CALLBLT 13928>>ASSIGN  13936>>IF
     13938>>CALLBLT 13940>>ASSIGN  13952>>IF      13954>>CALLBLT 13956>>ASSIGN  13997>>IF      14001>>ASSIGN
     14005>>IF      14007>>CALLBLT 14009>>ASSIGN  14016>>IF      14018>>CALLBLT 14020>>ASSIGN  14050>>IF
     14054>>ASSIGN  14058>>IF      14060>>CALLBLT 14062>>ASSIGN  14069>>IF      14071>>CALLBLT 14073>>ASSIGN
     14189>>ASSIGN  14190>>ASSIGN  14206>>ASSIGN  14207>>ASSIGN  14211>>ASSIGN  14217>>ASSIGN  14220>>CALLBLT
     14221>>CALLBLT 14230>>CALLBLT 14231>>CALLBLT
OUT$SYM.TEXT
      7231**DCL     12895>>ASSIGN  12899>>ASSIGN  12902>>ASSIGN  12905>>ASSIGN  13856>>CALLBLT 13868>>CALLBLT
     13870>>IF      13876>>CALLBLT 13878>>ASSIGN  13884>>ASSIGN  13897>>CALLBLT 13926>>CALLBLT 13928>>ASSIGN
     13938>>CALLBLT 13940>>ASSIGN  13954>>CALLBLT 13956>>ASSIGN  14001>>ASSIGN  14007>>CALLBLT 14009>>ASSIGN
     14018>>CALLBLT 14020>>ASSIGN  14054>>ASSIGN  14060>>CALLBLT 14062>>ASSIGN  14071>>CALLBLT 14073>>ASSIGN
     14189>>ASSIGN  14206>>ASSIGN  14211>>ASSIGN  14217>>ASSIGN  14220>>CALLBLT 14221>>CALLBLT 14230>>CALLBLT
     14231>>CALLBLT
OUTBUF IN PROCEDURE BUILD$TIME
     13288**DCL     13682<<ASSIGN  13685<<ASSIGN  13688<<ASSIGN  13691<<ASSIGN  13696<<ASSIGN  13698<<ASSIGN
     13703<<ASSIGN  13707<<ASSIGN  13709<<ASSIGN  13712<<ASSIGN  13715<<ASSIGN  13718<<ASSIGN  13724--ASSIGN
OUT_MESS
     10592**DCL     12826<>CALL    14428<>CALL
OUT_MESS.STATION_
     10594**DCL     10594--REDEF
OUT_MESS.V
     10595**DCL     10592--DCLINIT
OUT_MESS.V.DVBYTE.VFC#
     10601**DCL     10601--REDEF
PARSE$COMMAND
     13768**PROC    13057--CALL    13567--CALL
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:315  
PARSE_COMMANDS IN PROCEDURE BUILD$TIME
     13565**LABEL   13663--EXIT
PASS IN PROCEDURE DO$COMMAND
     14344**DCL     14341--PROC    14395>>IF      14398>>ASSIGN
PCL_CMD
      9826**DCL     11547--DCLINIT
PCL_NAME
     11578**DCL     11546--DCLINIT 11597--DCLINIT
PTR$
      9896**DCL     12750<<ASSIGN  12751<>CALL    12753>>IF      12889<<ASSIGN  12892>>DOCASE  12895>>ASSIGN
     12895>>ASSIGN  12896>>ASSIGN  12899>>ASSIGN  12899>>ASSIGN  12902>>ASSIGN  12902>>ASSIGN  12905>>ASSIGN
     12905>>ASSIGN  13551<<ASSIGN  13552<>CALL    13554>>ASSIGN  13851<<ASSIGN  13852>>DOCASE  13856>>CALLBLT
     13856>>CALLBLT 13857>>ASSIGN  13859>>IF      13865>>IF      13868>>CALLBLT 13868>>CALLBLT 13870>>IF
     13870>>IF      13870>>IF      13876>>CALLBLT 13876>>CALLBLT 13878>>ASSIGN  13878>>ASSIGN  13879>>IF
     13884>>ASSIGN  13884>>ASSIGN  13895>>IF      13897>>CALLBLT 13897>>CALLBLT 13903>>DOINDEX 13904>>DOCASE
     13924>>IF      13926>>CALLBLT 13926>>CALLBLT 13928>>ASSIGN  13928>>ASSIGN  13936>>IF      13938>>CALLBLT
     13938>>CALLBLT 13940>>ASSIGN  13940>>ASSIGN  13952>>IF      13954>>CALLBLT 13954>>CALLBLT 13956>>ASSIGN
     13956>>ASSIGN  13997>>IF      14001>>ASSIGN  14001>>ASSIGN  14005>>IF      14007>>CALLBLT 14007>>CALLBLT
     14009>>ASSIGN  14009>>ASSIGN  14016>>IF      14018>>CALLBLT 14018>>CALLBLT 14020>>ASSIGN  14020>>ASSIGN
     14050>>IF      14054>>ASSIGN  14054>>ASSIGN  14058>>IF      14060>>CALLBLT 14060>>CALLBLT 14062>>ASSIGN
     14062>>ASSIGN  14069>>IF      14071>>CALLBLT 14071>>CALLBLT 14073>>ASSIGN  14073>>ASSIGN  14189>>ASSIGN
     14189>>ASSIGN  14190>>ASSIGN  14206>>ASSIGN  14206>>ASSIGN  14207>>ASSIGN  14211>>ASSIGN  14211>>ASSIGN
     14217>>ASSIGN  14217>>ASSIGN  14220>>CALLBLT 14220>>CALLBLT 14221>>CALLBLT 14221>>CALLBLT 14230>>CALLBLT
     14230>>CALLBLT 14231>>CALLBLT 14231>>CALLBLT
READ_CMD.STATION_
     10460**DCL     10461--REDEF
READ_CMD.V
     10461**DCL     10457--DCLINIT
READ_CMD.V.DVBYTE.REREAD#
     10472**DCL     10472--REDEF
READ_CMD.V.INDX#
     10470**DCL     10470--REDEF
READ_CSCG
     11426**DCL     12568<>CALL    14628<>CALL
READ_CSCG.STATION_
     11429**DCL     11430--REDEF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:316  
READ_CSCG.V
     11430**DCL     11426--DCLINIT
READ_CSCG.V.DVBYTE.REREAD#
     11441**DCL     11441--REDEF
READ_CSCG.V.INDX#
     11439**DCL     11439--REDEF
READ_OLOOP
     12827**LABEL   12844--REMEMBR 12855--GOTO    12971--GOTO    12978--GOTO    13006--GOTO    13017--GOTO
     13026--GOTO    13034--GOTO    13131--GOTO
READ_S
     10414**DCL     12984<>CALL
READ_S.STATION_
     10417**DCL     10418--REDEF
READ_S.V
     10418**DCL     10414--DCLINIT
READ_S.V.DVBYTE.REREAD#
     10429**DCL     10429--REDEF
READ_S.V.INDX#
     10427**DCL     10427--REDEF
READ_SI
     10703**DCL     13087<>CALL
READ_SI.STATION_
     10706**DCL     10707--REDEF
READ_SI.V
     10707**DCL     10703--DCLINIT
READ_SI.V.DVBYTE.REREAD#
     10718**DCL     10718--REDEF
READ_SI.V.INDX#
     10716**DCL     10716--REDEF
READ_TEMP.STATION_
     12048**DCL     12049--REDEF
READ_TEMP.V
     12049**DCL     12045--DCLINIT
READ_TEMP.V.DVBYTE.REREAD#
     12060**DCL     12060--REDEF
READ_TEMP.V.INDX#
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:317  
     12058**DCL     12058--REDEF
RESET_FMSEC
     12492**DCL     12809<>CALL    13021<>CALL    13028<>CALL    13536<>CALL    13539<>CALL    13545<>CALL
     13672<>CALL    13747<>CALL
RESET_FMSEC.V
     12492**DCL     12492--DCLINIT
RLT
      9672**DCL     13063>>ASSIGN  13063>>ASSIGN  13064>>ASSIGN  13067>>ASSIGN  13075>>ASSIGN
RLT$
      9897**DCL      9672--IMP-PTR 13060<<ASSIGN  13063>>ASSIGN  13063>>ASSIGN  13064>>ASSIGN  13067>>ASSIGN
     13075>>ASSIGN
RPT_SYN IN PROCEDURE PARSE$COMMAND
     14257**LABEL   14249--GOTO    14250--GOTO    14251--GOTO    14252--GOTO    14253--GOTO    14254--GOTO
     14255--GOTO
SAVE_ENTRY$ IN PROCEDURE MAKE$ENTRY
     14278**DCL     14281<<ASSIGN  14308<<ASSIGN  14310>>ASSIGN
SEG_VLP
      9986**DCL      9951--DCLINIT  9970--DCLINIT
SEG_VLP.PTR$
      9988**DCL     14298>>ASSIGN  14307>>ASSIGN
SEG_VLP.W1.VSIZE#
      9986**DCL     13523>>ASSIGN  14298>>ASSIGN  14299<<ASSIGN
SEG_VLP.W2
      9987**DCL      9988--REDEF
SEND_KEYIN
      9722**DCL     11158--DCLINIT 11159--DCLINIT
SEND_KEYIN.FLAGS
      9729**DCL      9730--REDEF
SEND_KEYIN.KEYIN
      9735**DCL     14442<<ASSIGN
SEND_KEYIN.MSGID
      9725**DCL      9726--REDEF
SEND_KEYIN.SIZE
      9734**DCL     14443<<ASSIGN
SIZE IN PROCEDURE DO$COMMAND
     14350**DCL     14341--PROC    14443>>ASSIGN
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:318  
SIZE IN PROCEDURE PARSE$COMMAND
     13772**DCL     13774--IMP-SIZ 13857<<ASSIGN  13858>>CALLBLT
SKIP_TEST
     12756**LABEL   12749--CALLALT 12751--CALLALT
START_GJOB
     12245**DCL     14410<>CALL
START_GJOB.ACCT_
     12245**DCL     14387<<ASSIGN  14390<<ASSIGN
START_GJOB.CCBUF_
     12246**DCL     12880<<ASSIGN  14406<<ASSIGN  14408<<ASSIGN
START_GJOB.NAME_
     12245**DCL     14377<<ASSIGN  14380<<ASSIGN
START_GJOB.PASS_
     12246**DCL     14399<<ASSIGN  14402<<ASSIGN
START_GJOB.V
     12247**DCL     12245--DCLINIT
START_TIME
      9829**DCL     12608<<ASSIGN  12627<<ASSIGN  12646>>IF      12648<<ASSIGN  12648>>ASSIGN  12652<<ASSIGN
     13577>>ASSIGN  13578>>ASSIGN  13579>>ASSIGN  13650>>ASSIGN  13652>>ASSIGN
START_UP
      9830**DCL     12569<<ASSIGN  12656>>IF      12658<<ASSIGN  13648>>IF
STA_KEYIN
     11241**DCL     11123--DCLINIT 11159--DCLINIT 14503--DCLINIT
STA_KEYIN.MSGIDXT
     11251**DCL     11254--REDEF
SYN_DATE_RANGE_ERR IN PROCEDURE PARSE$COMMAND
     14255**LABEL   14130--GOTO
SYN_DAY_ERR IN PROCEDURE PARSE$COMMAND
     14253**LABEL   13964--GOTO    13967--GOTO    13975--GOTO    13987--GOTO    13992--GOTO    14026--GOTO
     14034--GOTO    14043--GOTO    14048--GOTO    14079--GOTO    14087--GOTO    14097--GOTO    14102--GOTO
SYN_ERR IN PROCEDURE PARSE$COMMAND
     13773**DCL     14249<<ASSIGN  14250<<ASSIGN  14251<<ASSIGN  14252<<ASSIGN  14253<<ASSIGN  14254<<ASSIGN
     14255<<ASSIGN  14257<>CALL
SYN_MONTH_ERR IN PROCEDURE PARSE$COMMAND
     14252**LABEL   13947--GOTO    13951--GOTO    14012--GOTO    14065--GOTO
SYN_NO_WILD_ERR IN PROCEDURE PARSE$COMMAND
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:319  
     14254**LABEL   14004--GOTO    14015--GOTO    14023--GOTO    14057--GOTO    14068--GOTO    14076--GOTO
SYN_TIME_ERR IN PROCEDURE PARSE$COMMAND
     14249**LABEL   13873--GOTO    13888--GOTO    13891--GOTO    14222--GOTO    14223--GOTO    14232--GOTO
     14233--GOTO
SYN_TIME_RANGE_ERR IN PROCEDURE PARSE$COMMAND
     14250**LABEL   14235--GOTO
SYN_YEAR_ERR IN PROCEDURE PARSE$COMMAND
     14251**LABEL   13935--GOTO    13999--GOTO    14052--GOTO
SYSACCT
     11527**DCL     10298--DCLINIT 10804--DCLINIT 11480--DCLINIT 11546--DCLINIT 11597--DCLINIT 13372--DCLINIT
SYSID
      9831**DCL     14424<<CALLBLT 14425>>CALLBLT
TELL_CONSOLES
      9701**DCL     11122--DCLINIT 11123--DCLINIT
TELL_CONSOLES.FID
      9717**DCL     14365<<CALLBLT
TELL_CONSOLES.FLAGS
      9708**DCL      9709--REDEF
TELL_CONSOLES.KEY
      9714**DCL     14359<<ASSIGN  14366<<ASSIGN  14433<<ASSIGN
TELL_CONSOLES.MESS
      9716**DCL     14358<<ASSIGN  14364<<ASSIGN  14434<<ASSIGN
TELL_CONSOLES.MSGID
      9704**DCL      9705--REDEF
TELL_CONSOLES IN PROCEDURE DO$EVENT
     14466**DCL     14502--DCLINIT 14503--DCLINIT
TELL_CONSOLES.CADDR IN PROCEDURE DO$EVENT
     14467**DCL     14528<<ASSIGN  14536<<ASSIGN  14548<<ASSIGN  14556<<ASSIGN  14568<<ASSIGN  14576<<ASSIGN
     14588<<ASSIGN  14596<<ASSIGN  14605<<ASSIGN
TELL_CONSOLES.FLAGS IN PROCEDURE DO$EVENT
     14473**DCL     14474--REDEF
TELL_CONSOLES.MSGID IN PROCEDURE DO$EVENT
     14469**DCL     14470--REDEF
TELL_CONSOLES.TYPE IN PROCEDURE DO$EVENT
     14479**DCL     14529<<ASSIGN  14537<<ASSIGN  14549<<ASSIGN  14557<<ASSIGN  14569<<ASSIGN  14577<<ASSIGN
     14589<<ASSIGN  14597<<ASSIGN  14606<<ASSIGN
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:320  
TELL_CSCG
     11121**DCL     14360<>CALL    14373<>CALL    14441<>CALL
TELL_CSCG.STATION_
     11123**DCL     11123--REDEF
TELL_CSCG.V
     11124**DCL     11121--DCLINIT
TELL_CSCG.V.DVBYTE.VFC#
     11130**DCL     11130--REDEF
TEMP$
      9898**DCL     13059<<ASSIGN  13063>>ASSIGN  13075<<ASSIGN  13075>>ASSIGN
TEMP_DAYS
      6407**DCL     13175<<CALLBLT 13187<<CALLBLT
TEMP_MONTHS
      6407**DCL     13174<<CALLBLT 13186<<CALLBLT
TEMP_NAME
     11746**DCL     11676--DCLINIT
TEMP_SEC
      6407**DCL     13170<<CALLBLT 13171>>ASSIGN
TEMP_TIME IN PROCEDURE BUILD$TIME
     13287**DCL     13695<<CALLBLT 13696--ASSIGN  13696>>ASSIGN  13697--ASSIGN
TEMP_YEARS
      6408**DCL     13173<<CALLBLT 13176>>IF      13178<<ASSIGN  13178>>ASSIGN  13180<<ASSIGN  13180>>ASSIGN
     13185<<CALLBLT 13188>>IF      13190<<ASSIGN  13190>>ASSIGN  13192<<ASSIGN  13192>>ASSIGN
TEXT_DATE
      9832**DCL      9837--REDEF   12704>>ASSIGN  12758>>ASSIGN  12793>>ASSIGN
TEXT_DATE.DAY
      9835**DCL     13175>>CALLBLT 13605>>IF      14148>>CALLBLT 14184>>ASSIGN
TEXT_DATE.MON
      9834**DCL     13174>>CALLBLT 13605>>IF      14147>>CALLBLT 14183>>ASSIGN
TEXT_DATE.YR
      9833**DCL     13173>>CALLBLT 13605>>IF      14146>>CALLBLT 14182>>ASSIGN
TEXT_DATER.TEXT
      9838**DCL     10643--DCLINIT 10644--DCLINIT
TEXT_DAY
      9840**DCL     10623--DCLINIT 13605>>IF      13605>>IF      13605>>IF      13605>>IF      13605>>IF
     13605>>IF      13605>>IF
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:321  
TEXT_TIME
      9841**DCL     10645--DCLINIT 10646--DCLINIT
TEXT_TIME.HR_MIN
      9842**DCL     12589>>CALLBLT 12644>>CALLBLT 12668>>CALLBLT 12715>>CALLBLT
TEXT_TIME.SEC
      9843**DCL     12769>>CALLBLT 13170>>CALLBLT
TIME IN PROCEDURE BUILD$TIME
     13285**DCL     13623<<ASSIGN  13624<>CALL    13628<<ASSIGN  13629<>CALL    13636<<ASSIGN  13637<>CALL
     13647<<ASSIGN  13652>>ASSIGN  13652>>ASSIGN
TIME IN PROCEDURE CHECK$TIME
     13240**DCL     13238--PROC    13247>>IF
TIME IN PROCEDURE MAKE$ENTRY
     14275**DCL     14273--PROC    14283>>IF      14283>>IF      14286>>IF      14286>>IF      14291>>DOWHILE
     14311>>ASSIGN
TIME_DIFF
      6406**DCL     12676>>IF      12728>>IF      13161<<ASSIGN  13203<<ASSIGN  13207<<ASSIGN  13215<<ASSIGN
     13221<<ASSIGN
TIME_ENTRY$
      9845**DCL      9865--IMP-PTR 13242<<ASSIGN  13243>>IF      13246>>DOWHILE 13247>>IF      13252>>CALL
     13252>>CALL    13252>>CALL    13252>>CALL    13252>>CALL    13252>>CALL    13254>>ASSIGN  13255<<ASSIGN
     13675<<ASSIGN  13676>>DOWHILE 13679>>DOCASE  13695>>CALLBLT 13701>>IF      13707>>ASSIGN  13707>>ASSIGN
     13708>>ASSIGN  13711>>IF      13712>>ASSIGN  13717>>IF      13718>>ASSIGN  13731>>IF      13733>>ASSIGN
     13734>>ASSIGN  13740<<ASSIGN  13740>>ASSIGN  14282<<ASSIGN  14291>>DOWHILE 14292>>ASSIGN  14293<<ASSIGN
     14293>>ASSIGN  14294>>IF      14308>>ASSIGN  14309<<ASSIGN  14310>>ASSIGN  14311>>ASSIGN  14312>>ASSIGN
     14313>>ASSIGN  14314>>ASSIGN  14315>>ASSIGN  14316>>ASSIGN  14317>>ASSIGN  14318<<ASSIGN  14323>>ASSIGN
TIME_HEAD$
      9846**DCL     12771>>IF      12775>>ASSIGN  13242>>ASSIGN  13254<<ASSIGN  13255>>ASSIGN  13522<<ASSIGN
     13675>>ASSIGN  14282>>ASSIGN  14289>>IF      14321<<ASSIGN
TIME_LEFT
      9847**DCL     12766<<ASSIGN  12769<<CALLBLT 12770<<ASSIGN  12770>>ASSIGN  12773<<ASSIGN  12773>>ASSIGN
     12775<<ASSIGN  12775>>ASSIGN  12776>>IF      12778>>ASSIGN  12786>>IF
TIME_TABLE
      9865**DCL      9954--DCLINIT 14299--ASSIGN
TIME_TABLE.ACCT
      9870**DCL     13252<>CALL    13711>>IF      13712--ASSIGN  13712>>ASSIGN  13713--ASSIGN  14316<<ASSIGN
TIME_TABLE.COMMAND
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:322  
      9874**DCL     13252<>CALL    13733--ASSIGN  14313<<ASSIGN
TIME_TABLE.GHOST_FID
      9867**DCL     13252<>CALL    14315<<ASSIGN
TIME_TABLE.GHOST_FID.SIZE
      9868**DCL     13701>>IF      13707>>ASSIGN  13708>>ASSIGN
TIME_TABLE.GHOST_FID.TEXT
      9869**DCL     13707>>ASSIGN
TIME_TABLE.NEXT$
      9875**DCL     13254>>ASSIGN  13740>>ASSIGN  14293>>ASSIGN  14310<<ASSIGN  14323<<ASSIGN
TIME_TABLE.PASS
      9871**DCL     13252<>CALL    13717>>IF      13718--ASSIGN  13718>>ASSIGN  13719--ASSIGN  14317<<ASSIGN
TIME_TABLE.SIZE
      9873**DCL     13252<>CALL    13731>>IF      13734>>ASSIGN  14314<<ASSIGN
TIME_TABLE.TIME
      9866**DCL     12775>>ASSIGN  13247>>IF      13695>>CALLBLT 14291>>DOWHILE 14311<<ASSIGN
TIME_TABLE.TYPE
      9872**DCL     13252<>CALL    13679>>DOCASE  14312<<ASSIGN
TIME_WARP
      9848**DCL     12599>>IF      12659<<ASSIGN  12679<<ASSIGN  12731<<ASSIGN  13580>>IF      13588>>IF
TIME_WARP$CHECK
     13156**PROC    12670--CALL    12723--CALL
TOTAL_DAYS
      6411**DCL     13183>>ASSIGN  13195>>ASSIGN
TRY_OPEN IN PROCEDURE BUILD$TIME
     13523**LABEL   13532--GOTO
TYPE IN PROCEDURE DO$COMMAND
     14349**DCL     14341--PROC    14353>>DOCASE
UPDATE_INIT
      8130**DCL     13046<>CALL
UPDATE_INIT.PARAMS$
      8246**DCL     13053>>ASSIGN
WGOOSE_UPD
     11085**DCL     12947<>CALL
WGOOSE_UPD.STATION_
     11087**DCL     11087--REDEF
WGOOSE_UPD.V
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:323  
     11088**DCL     11085--DCLINIT
WGOOSE_UPD.V.DVBYTE.VFC#
     11094**DCL     11094--REDEF
WRITE_SCHED
     12215**DCL     13070<>CALL
WRITE_SCHED.BUF_.BOUND
     12215**DCL     13064<<ASSIGN
WRITE_SCHED.STATION_
     12217**DCL     12217--REDEF
WRITE_SCHED.V
     12218**DCL     12215--DCLINIT
WRITE_SCHED.V.DVBYTE.VFC#
     12224**DCL     12224--REDEF
WRITE_TEMP
     12179**DCL     12991<>CALL
WRITE_TEMP.BUF_.BOUND
     12179**DCL     12989<<ASSIGN
WRITE_TEMP.STATION_
     12181**DCL     12181--REDEF
WRITE_TEMP.V
     12182**DCL     12179--DCLINIT
WRITE_TEMP.V.DVBYTE.VFC#
     12188**DCL     12188--REDEF
WR_CSCG IN PROCEDURE DO$EVENT
     14501**DCL     14532<>CALL    14538<>CALL    14552<>CALL    14558<>CALL    14572<>CALL    14578<>CALL
     14592<>CALL    14598<>CALL    14607<>CALL
WR_CSCG.STATION_ IN PROCEDURE DO$EVENT
     14503**DCL     14503--REDEF
WR_CSCG.V IN PROCEDURE DO$EVENT
     14504**DCL     14501--DCLINIT
WR_CSCG.V.DVBYTE.VFC# IN PROCEDURE DO$EVENT
     14510**DCL     14510--REDEF
XSF$LOCCODP
      9694**DCL-ENT 12751--CALL    13552--CALL
XTX$ADAPT
      7268**DCL-ENT  7584--DCLINIT  8012--DCLINIT  8441--DCLINIT
PL6.E3A0      #001=IAA$GOOSE File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:25 Page:324  
XUG.BUF
      9663**DCL      9666--REDEF
XUG.BUFVEC
      9228**DCL     13059>>ASSIGN
XUG.NLINES
      9502**DCL     13062>>DOINDEX 13065>>IF
XUG.RLTVEC
      9245**DCL     13060>>ASSIGN
XUG$
      9899**DCL      9227--IMP-PTR 13053<<ASSIGN  13059>>ASSIGN  13060>>ASSIGN  13062>>DOINDEX 13065>>IF
XUG$BREAK
      6844**DCL-ENT 12554--DCLINIT
XUG$ECHOIF
      6836**DCL-ENT 13112--CALL
XUG$ERRPTR
      6835**DCL-ENT 13114--CALL
XUG$GETCMD
      6834**DCL-ENT 12846--CALL    13811--CALL
XUG$INIT
      6838**DCL-ENT 12839--CALL    13046--CALL    13556--CALL

PL6.E3A0      #002=IAA$EVENT File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:31 Page:325  
     2488        1        /*M* IAA$EVENT           HANDLES READS FROM CSCG */
     2489        2        /*T***********************************************************/
     2490        3        /*T*                                                         */
     2491        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2492        5        /*T*                                                         */
     2493        6        /*T***********************************************************/
     2494        7
     2495        8        IAA$EVENT: PROC ASYNC;
     2496        9                                                /*  */
     2497       10                       /*
     2498       11             PURPOSE: This routine will handle the completion of a read
     2499       12                       event from ccscg                                      */
     2500       13        %INCLUDE CP_6;
     2501       94        %INCLUDE CP_6_SUBS;
     2502      634        %B$NWIO(STCLASS="BASED");
     2503      719        %B$TCB;
     2504      722                                                /*  */
     2505      723    1   DCL DET_RENV UBIN WORD;
     2506      724    1   DCL B$TCB$ PTR SYMREF;
     2507      725    1   DCL GOOSE_ERR BIT(36) SYMREF;
     2508      726    1   DCL GOOSE_READ_FLAG BIT(1) SYMREF;
     2509      727        /* Begin main program */
     2510      728    1        GOOSE_ERR = B$TCB$ -> B$TCB.STK$ -> B$NWIO.ERR;
     2511      729    1        GOOSE_READ_FLAG = %YES#;
     2512      730    1        RETURN;
     2513      731    1   END IAA$EVENT;
     2514      732        %EOD;

PL6.E3A0      #002=IAA$EVENT File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:31 Page:326  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure IAA$EVENT.

   Procedure IAA$EVENT requires 9 words for executable code.
   Procedure IAA$EVENT requires 4 words of local(AUTO) storage.

PL6.E3A0      #002=IAA$EVENT File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:31 Page:327  

 Object Unit name= IAA$EVENT                                  File name= IAA$MAIN.:E05TOU
 UTS= JUL 29 '97 22:31:34.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none     9     11  IAA$EVENT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes     Async       0  IAA$EVENT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AAUTO
                       nStd      0 X66_AARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$                                GOOSE_ERR
     GOOSE_READ_FLAG
PL6.E3A0      #002=IAA$EVENT File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:31 Page:328  


     2488        1        /*M* IAA$EVENT           HANDLES READS FROM CSCG */
     2489        2        /*T***********************************************************/
     2490        3        /*T*                                                         */
     2491        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2492        5        /*T*                                                         */
     2493        6        /*T***********************************************************/
     2494        7
     2495        8        IAA$EVENT: PROC ASYNC;

      8  1 000000   000000 700200 xent  IAA$EVENT    TSX0  ! X66_AAUTO
         1 000001   000004 000000                    ZERO    4,0

     2496        9                                                /*  */
     2497       10                       /*
     2498       11             PURPOSE: This routine will handle the completion of a read
     2499       12                       event from ccscg                                      */
     2500       13        %INCLUDE CP_6;
     2501       94        %INCLUDE CP_6_SUBS;
     2502      634        %B$NWIO(STCLASS="BASED");
     2503      719        %B$TCB;
     2504      722                                                /*  */
     2505      723    1   DCL DET_RENV UBIN WORD;
     2506      724    1   DCL B$TCB$ PTR SYMREF;
     2507      725    1   DCL GOOSE_ERR BIT(36) SYMREF;
     2508      726    1   DCL GOOSE_READ_FLAG BIT(1) SYMREF;
     2509      727        /* Begin main program */
     2510      728    1        GOOSE_ERR = B$TCB$ -> B$TCB.STK$ -> B$NWIO.ERR;

    728  1 000002   000000 470400 xsym               LDP0    B$TCB$
         1 000003   000001 471500                    LDP1    1,,PR0
         1 000004   100102 236100                    LDQ     66,,PR1
         1 000005   000000 756000 xsym               STQ     GOOSE_ERR

     2511      729    1        GOOSE_READ_FLAG = %YES#;

    729  1 000006   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #002=IAA$EVENT File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:31 Page:329  
         1 000007   000000 756000 xsym               STQ     GOOSE_READ_FLAG

     2512      730    1        RETURN;

    730  1 000010   000000 702200 xent               TSX2  ! X66_AARET
     2513      731    1   END IAA$EVENT;
     2514      732        %EOD;

PL6.E3A0      #002=IAA$EVENT File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:31 Page:330  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure IAA$EVENT.
PL6.E3A0      #002=IAA$EVENT File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:31 Page:331  

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/b BIT         r     1 GOOSE_ERR
     0-0-0/b BIT         r     1 GOOSE_READ_FLAG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2880)  r     1 B$NWIO                     0-0-0/w STRC(144)   r     1 B$TCB


   Procedure IAA$EVENT requires 9 words for executable code.
   Procedure IAA$EVENT requires 4 words of local(AUTO) storage.
PL6.E3A0      #002=IAA$EVENT File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:31 Page:332  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=IAA$EVENT File=IAA$MAIN.:E05TSI                               TUE 07/29/97 22:31 Page:333  
          MINI XREF LISTING

B$NWIO.CGPARM.MSGIDXT
       668**DCL       671--REDEF
B$NWIO.CODE
       637**DCL       637--REDEF     638--REDEF     638--REDEF
B$NWIO.ERR
       638**DCL       728>>ASSIGN
B$NWIO.ERR.ERR#
       639**DCL       639--REDEF
B$NWIO.EVID
       638**DCL       638--REDEF     638--REDEF
B$TCB.STK$
       720**DCL       728>>ASSIGN
B$TCB$
       724**DCL       728>>ASSIGN
GOOSE_ERR
       725**DCL       728<<ASSIGN
GOOSE_READ_FLAG
       726**DCL       729<<ASSIGN

PL6.E3A0      #003=IAA$ABORT_CMD File=IAA$MAIN.:E05TSI                           TUE 07/29/97 22:31 Page:334  
     2515        1        /*M* IAA$ABORT_CMD       HANDLES BREAKS FROM XUG$ */
     2516        2        /*T***********************************************************/
     2517        3        /*T*                                                         */
     2518        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2519        5        /*T*                                                         */
     2520        6        /*T***********************************************************/
     2521        7
     2522        8        IAA$ABORT_CMD: PROC ;
     2523        9                                                /*  */
     2524       10                       /*
     2525       11             PURPOSE: This routine will handle the return to processing
     2526       12                       necessitated by receiving a break interrupt from
     2527       13                       the user. This routine will be call from XUG$BREAK.
     2528       14                       The remember variable is setup in the MAIN_OLOOP
     2529       15                       or online portion of IAA$MAIN.                    */
     2530       16        %INCLUDE CP_6;
     2531       97        %INCLUDE IA_DAT_R;
     2532      115                                                /*  */
     2533      116
     2534      117        /* Begin main program */
     2535      118
     2536      119    1        UNWIND TO ABORT_CMD;
     2537      120    1   END IAA$ABORT_CMD;

PL6.E3A0      #003=IAA$ABORT_CMD File=IAA$MAIN.:E05TSI                           TUE 07/29/97 22:31 Page:335  
--  Include file information  --

   IA_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure IAA$ABORT_CMD.

   Procedure IAA$ABORT_CMD requires 8 words for executable code.
   Procedure IAA$ABORT_CMD requires 6 words of local(AUTO) storage.

    No errors detected in file IAA$MAIN.:E05TSI    .

PL6.E3A0      #003=IAA$ABORT_CMD File=IAA$MAIN.:E05TSI                           TUE 07/29/97 22:31 Page:336  

 Object Unit name= IAA$ABORT_CMD                              File name= IAA$MAIN.:E05TOU
 UTS= JUL 29 '97 22:31:52.00 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none     8     10  IAA$ABORT_CMD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  IAA$ABORT_CMD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_AUNWIND

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  MESS_BUF                              ABORT_CMD
PL6.E3A0      #003=IAA$ABORT_CMD File=IAA$MAIN.:E05TSI                           TUE 07/29/97 22:31 Page:337  


     2515        1        /*M* IAA$ABORT_CMD       HANDLES BREAKS FROM XUG$ */
     2516        2        /*T***********************************************************/
     2517        3        /*T*                                                         */
     2518        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2519        5        /*T*                                                         */
     2520        6        /*T***********************************************************/
     2521        7
     2522        8        IAA$ABORT_CMD: PROC ;

      8  1 000000   000000 700200 xent  IAA$ABORT_C* TSX0  ! X66_AUTO_0
         1 000001   000006 000000                    ZERO    6,0

     2523        9                                                /*  */
     2524       10                       /*
     2525       11             PURPOSE: This routine will handle the return to processing
     2526       12                       necessitated by receiving a break interrupt from
     2527       13                       the user. This routine will be call from XUG$BREAK.
     2528       14                       The remember variable is setup in the MAIN_OLOOP
     2529       15                       or online portion of IAA$MAIN.                    */
     2530       16        %INCLUDE CP_6;
     2531       97        %INCLUDE IA_DAT_R;
     2532      115                                                /*  */
     2533      116
     2534      117        /* Begin main program */
     2535      118
     2536      119    1        UNWIND TO ABORT_CMD;

    119  1 000002   000100 100600                    MLR   ! fill='000'O
         1 000003   000000 000010 xsym               ADSC9   ABORT_CMD                cn=0,n=8
         1 000004   200004 000010                    ADSC9   4,,AUTO                  cn=0,n=8
         1 000005   200004 237300                    LDAQ  ! 4,,AUTO
         1 000006   000000 700200 xent               TSX0  ! X66_AUNWIND
         1 000007   000000 000200                    ZERO    0,128
     2537      120    1   END IAA$ABORT_CMD;

PL6.E3A0      #003=IAA$ABORT_CMD File=IAA$MAIN.:E05TSI                           TUE 07/29/97 22:31 Page:338  
--  Include file information  --

   IA_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure IAA$ABORT_CMD.
PL6.E3A0      #003=IAA$ABORT_CMD File=IAA$MAIN.:E05TSI                           TUE 07/29/97 22:31 Page:339  

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w REMB        r     1 ABORT_CMD


   Procedure IAA$ABORT_CMD requires 8 words for executable code.
   Procedure IAA$ABORT_CMD requires 6 words of local(AUTO) storage.

    No errors detected in file IAA$MAIN.:E05TSI    .
PL6.E3A0      #003=IAA$ABORT_CMD File=IAA$MAIN.:E05TSI                           TUE 07/29/97 22:31 Page:340  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=IAA$ABORT_CMD File=IAA$MAIN.:E05TSI                           TUE 07/29/97 22:31 Page:341  
          MINI XREF LISTING

ABORT_CMD
       114**DCL       119>>UNWIND
MESS_BUF
       106**DCL       106--REDEF
