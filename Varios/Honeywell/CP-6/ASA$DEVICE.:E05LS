VERSION E05

PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:1    
        1        1        /*M*  ASA$DEVICE - Processes CREATE and MODIFY for DEVICE. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        /**/
       10       10        /*   ASA$DEVICE : This module consists of procedures:
       11       11                             ASA$DEVICE
       12       12                             ASA$DEV_OPTS
       13       13                                                                */
       14       14        /*P*   NAME: ASA$DEVICE
       15       15               PURPOSE:  This module  of SUPER processes the 'CREATE DEVICE'
       16       16                         and the 'MODIFY DEVICE' commands.  It calls
       17       17                         ASA$DEV_OPTS to process the options.
       18       18        */
       19       19        ASA$DEVICE: PROC ;
       20       20                                                       /**/
       21       21        %SET LISTSUB = '1'B ;
       22       22        /*********************************************************************/
       23       23        /*   Include files   include files   include files   include files   */
       24       24        /*********************************************************************/
       25       25                                                                                    /**/
       26       26              %INCLUDE  AS_ENTRIES_M ;
       27     1076              %INCLUDE  AS_PERR_C    ;
       28     1678              %INCLUDE  AS_SSUBS_C   ;
       29     1770              %INCLUDE  AS_SUBS_C    ;
       30     3184              %INCLUDE  KL_SUPER_C   ;
       31     6086              %INCLUDE  XU_FORMAT_C  ;
       32     6248              %INCLUDE  XU_MACRO_C   ;
       33     9354              %INCLUDE  AS_SUPER_C   ;
       34     9789              %INCLUDE  AS_MAC_C     ;
       35     9869              %INCLUDE  AS_SUPER_R   ;
       36    12885              %INCLUDE  CP_6         ;
       37    12966              %INCLUDE  B_MACROS_C   ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:2    
       38    13077              %INCLUDE  KC$CGBLK     ;
       39    13125        %EJECT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:3    
       40    13126        /*********************************************************************/
       41    13127        /*   Auto data       auto data       auto data       auto data       */
       42    13128        /*********************************************************************/
       43    13129                                                                                    /**/
       44    13130    1   DCL CREATE BIT(1) ALIGNED;
       45    13131    1   DCL TYPE CHAR(2) ;
       46    13132    1   DCL KLDREC CHAR(4096) ;
       47    13133    1   DCL SNAME CHAR(8);
       48    13134    1   DCL TWSNC CHAR(4) ;
       49    13135    1   DCL TWSN# UBIN WORD ;
       50    13136    1   DCL TWSN_INDEX UBIN WORD ;
       51    13137    1   DCL DEV_ARS UBIN WORD ;
       52    13138    1   DCL TWSN_ARS UBIN WORD ;
       53    13139    1   DCL ARS UBIN WORD ;
       54    13140    1   DCL I UBIN WORD ALIGNED;
       55    13141    1   DCL 1 TP_DEV BASED (DSEG3$),
       56    13142    1          2 DEV_TYPE UBIN WORD,
       57    13143    1          2 SNAME CHAR (8);
       58    13144    1   DCL ACCT CHAR (8) ALIGNED;
       59    13145    1   DCL UNAME CHAR (12) ALIGNED;
       60    13146    1   DCL SUBNODES UBIN WORD;
       61    13147    1   DCL UNAME_LEN UBIN;
       62    13148    1   DCL BLK$ PTR ;
       63    13149    1   DCL TREC$ PTR ;
       64    13150    1   DCL DREC$ PTR ;
       65    13151    1   DCL PRO$ PTR ;
       66    13152    1   DCL TWSNR$ PTR ;
       67    13153    1   DCL 1 DEV_NAME,
       68    13154    1          2 COUNT UBIN BYTE UNAL,
       69    13155    1          2 TEXT CHAR(8) UNAL;
       70    13156        %KL_TWSNREC( NAME=TWSN_REC, STCLASS=AUTO );
       71    13181        %EJECT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:4    
       72    13182        /*********************************************************************/
       73    13183        /*   Symref's        symref's        symref's        symref's        */
       74    13184        /*********************************************************************/
       75    13185                                                                                    /**/
       76    13186    1   DCL DEVICE_CMD SYMREF UBIN WORD ;
       77    13187    1   DCL TP_DEVICE_CMD SYMREF UBIN WORD ;
       78    13188        %EJECT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:5    
       79    13189        /*********************************************************************/
       80    13190        /*   Static data     static data     static data     static data     */
       81    13191        /*********************************************************************/
       82    13192                                                                                    /**/
       83    13193    1   DCL 1 DEV_KEY ALIGNED STATIC ,
       84    13194    1          2 CNT UBIN BYTE UNAL INIT( 9 ),
       85    13195    1          2 TXT UNAL ,
       86    13196    1             3 ACCT CHAR(8) UNAL INIT(' ') ,
       87    13197    1             3 UNAME CHAR(12) UNAL INIT(' ') ;
       88    13198        %EJECT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:6    
       89    13199        /********************************************************************/
       90    13200        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       91    13201        /*********************************************************************/
       92    13202                                                                                    /**/
       93    13203    1   DCL X$PARSE ENTRY(1) ALTRET ;
       94    13204        %ASA$DEV_OPTS ;
       95    13207        %ASB$FIND_TWSN_INDEX ;
       96    13210        %ASB$ENQ_HLP ;
       97    13213        %ASB$DEQ_HLP ;
       98    13216        %ASB$READ_HLP ;
       99    13219        %ASB$WRITE_HLP ;
      100    13222        %ASB$GETSEG ;
      101    13225        %ASH$ERROR ;
      102    13228        %ASH$WARN ;
      103    13231        %ASB$WRITE_LO ;
      104    13234        %ASB$CHECK_TYPE ;
      105    13237        %EJECT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:7    
      106    13238        /*********************************************************************/
      107    13239        /*   Local based     local based     local based     local based     */
      108    13240        /*********************************************************************/
      109    13241                                                                                    /**/
      110    13242            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      111    13243                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
      112    13288              %PARSE$SYM( NAME = OUT$SYM ,
      113    13289                          STCLASS="BASED(BLK$)") ;
      114    13327              %KL_DREC ( NAME = KL$TREC , LAST=";", STCLASS="BASED( TREC$ )" ) ;
      115    13440              %KL_DREC( NAME=KL$DREC, STCLASS="BASED( DREC$ )", LAST="," ) ;
      116    13553              %KC$CGID(FPTN=KC$CGID,
      117    13554                        LVL = 2 ,
      118    13555                        LAST = ";" );
      119    13581              %KL_TWSNREC(  NAME = KL$TWSNREC ,
      120    13582                            STCLASS="BASED( TWSNR$ )") ;
      121    13607        %EJECT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:8    
      122    13608        /*********************************************************************/
      123    13609        /*   Procedure       procedure       procedure       procedure       */
      124    13610        /*********************************************************************/
      125    13611                                                                                    /**/
      126    13612        /*
      127    13613            ***            Begin procedure                    ***
      128    13614        */
      129    13615    1   IF NOT DSEG_FLG
      130    13616    2   THEN DO;   /* Get the data segments since we will actually use a word */
      131    13617    2      CALL ASB$GETSEG
      132    13618    3      WHENALTRETURN DO;
      133    13619              %SCREAM( ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='A' ) ;
      134    13634    3         RETURN ;
      135    13635    3         END; /*  Whenaltreturn  */
      136    13636                                                                    /**/
      137    13637    2      END;
      138    13638    1   P_PCB.ROOT$ = ADDR( DEVICE_CMD ) ;
      139    13639    1   CALL X$PARSE( P_PCB )
      140    13640    2   WHENRETURN DO;
      141    13641    2      TP_DEV.DEV_TYPE = 0;
      142    13642                                                                                    /**/
      143    13643    2      NODE$ = P_PCB.OUT$ ;
      144    13644    2      IF P$NODE.CODE = 38 /* CR_DEVICE */
      145    13645    2      THEN
      146    13646    2         CREATE = AS_TRUE ;
      147    13647    2      ELSE
      148    13648    2         CREATE = AS_FALSE ;
      149    13649                                                /* Did we get data SEG.?              */
      150    13650                                                /* Pick up acct.                      */
      151    13651    2      BLK$ = P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;
      152    13652    3      IF OUT$SYM.COUNT > 8 THEN DO;
      153    13653        /*E*  ERROR:    ASA-E$DNAMETOOBIG-C
      154    13654              MESSAGE:  Device name too long.
      155    13655              MESSAGE1: Device names can be at most 8 characters.
      156    13656        */
      157    13657              %SCREAM( ERR#=E$DNAMETOOBIG , LEVEL=ERROR, MID='A' );
      158    13672    3         RETURN ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:9    
      159    13673    3         END ; /* Then do */
      160    13674    2      DEV_NAME.COUNT = OUT$SYM.COUNT;
      161    13675    2      DEV_NAME.TEXT = OUT$SYM.TEXT;
      162    13676    2      DEV_KEY.TXT.UNAME = '*';
      163    13677    2      DEV_KEY.TXT.ACCT = DEV_NAME.TEXT;
      164    13678    2      DEV_KEY.CNT = 9;
      165    13679    2      SUBNODES = 2;
      166    13680    2      USERS_KEY = DEV_KEY;
      167    13681
      168    13682    2      END;
      169    13683    2   WHENALTRETURN DO;
      170    13684        /* There are 2 forms of the special cr tp command.  The first is-
      171    13685           cr tp account (this will be refered to as type 1).
      172    13686           the second is ct tp account,uname (this will be called type 2).
      173    13687
      174    13688           If the user specifies cr tp as opposed to cr dev then the following
      175    13689           will happen.
      176    13690
      177    13691           We set the DEV_TYPE to 1 (0 is used for the regular cr dev command)
      178    13692           we create the key 'account (padded to 8 chars) *'.
      179    13693           we see if a comma was used (this will denote type 2)
      180    13694           if comma then set DEV_TYPE to 2, put the uname into the sname field
      181    13695            and make the key 'account (to 8 chars) uname'.
      182    13696
      183    13697           Data segment 3 (DSEG3) is used to pass the dev_type and sname
      184    13698           fields to the DEV_OPTS routine.  DEV_OPTS will check the DEV_TYPE,
      185    13699           if it's > 0 then use=tp will be simulated.  If the DEV_TYPE is 2
      186    13700           then the sname=uname option will be simulated.
      187    13701        */
      188    13702    2      P_PCB.ROOT$ = ADDR (TP_DEVICE_CMD);
      189    13703    2      CALL X$PARSE (P_PCB)
      190    13704    3      WHENALTRETURN DO;
      191    13705    3         CALL ASH$ERROR( P_PCB.ERROR ) ;
      192    13706    3         RETURN ;
      193    13707    3         END; /*  Whenaltreturn  */
      194    13708                                                                    /**/
      195    13709    2      SUBNODES = 3;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:10   
      196    13710    2      NODE$ = P_PCB.OUT$;
      197    13711    2      IF P$NODE.CODE = 38 /* CR_DEVICE */
      198    13712    2      THEN
      199    13713    2         CREATE = AS_TRUE ;
      200    13714    2      ELSE
      201    13715    2         CREATE = AS_FALSE ;
      202    13716    2      TP_DEV.DEV_TYPE = 1;
      203    13717    2      ACCT = NODE$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(0)->OUT$SYM.TEXT;
      204    13718    2      DEV_KEY.TXT.ACCT = ACCT;
      205    13719    2      DEV_KEY.TXT.UNAME = '*';
      206    13720    2      DEV_KEY.CNT = 9;
      207    13721    2      IF P$NODE.SUBNODES > 1
      208    13722    3      THEN DO;
      209    13723    3         IF P$NODE.SUBLK$(1)->P$NODE.CODE = 56 /* TPDEV_ACCT2_VAL */
      210    13724    4         THEN DO;
      211    13725    4            SUBNODES = 3;
      212    13726    4            TP_DEV.DEV_TYPE = 2;
      213    13727    4            UNAME = NODE$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->OUT$SYM.TEXT;
      214    13728    4            UNAME_LEN = NODE$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->OUT$SYM.COUNT;
      215    13729    4            DEV_KEY.CNT = 8 + UNAME_LEN;
      216    13730    4            IF UNAME_LEN > 8
      217    13731    5            THEN DO;
      218    13732        /*E*    ERROR: ASA-E$TPDEVSNAMETOOBIG-C
      219    13733              MESSAGE: Max size of a TP SNAME is 8 characters, UNAME will be truncated to 8.
      220    13734                MESSAGE1: The UNAME is used as the SNAME also, there is an 8 character
      221    13735                         limit on the SNAME which will cause truncation of the
      222    13736                         UNAME to 8 characters.
      223    13737        */
      224    13738                    %SCREAM (ERR#=E$TPDEVSNAMETOOBIG, LEVEL=WARN, MID='A');
      225    13753    5               UNAME_LEN = 8;
      226    13754    5               END;
      227    13755    4            IF (SUBSTR( UNAME, 1, 2) = '$$')
      228    13756    5            THEN DO;
      229    13757        /*      ERROR: ASA-E$NO$$ONSNAME-0
      230    13758                MESSAGE1: The sname of a cg type device cannot start with '$$'.
      231    13759                MESSAGE2: Comgroups do not allow '$$' as the first 2 characters
      232    13760                          of a name.
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:11   
      233    13761                DESCRIPTION: You tried to specify an sname with '$$' as the
      234    13762                         first two characters, this is a no-no!
      235    13763        */
      236    13764                    %SCREAM (ERR#=E$NO$$ONSNAME, LEVEL=ERROR, MID='A');
      237    13779    5               RETURN;
      238    13780    5               END;
      239    13781    4            TP_DEV.SNAME = UNAME;
      240    13782    4            DEV_KEY.TXT.UNAME = UNAME;
      241    13783    4            END;
      242    13784    4         ELSE DO; /* No uname specified */
      243    13785    4            UNAME_LEN = 1;
      244    13786    4            UNAME = '*';
      245    13787    4            DEV_KEY.CNT = 9;
      246    13788    4            END;
      247    13789    3         END;
      248    13790    2      USERS_KEY.COUNT = DEV_KEY.CNT;
      249    13791    2      CALL CONCAT (USERS_KEY.TXTC, ACCT, UNAME);
      250    13792    2      DEV_NAME = USERS_KEY;
      251    13793    2      END;
      252    13794    1   DREC$ = ADDR( KLDREC ) ;
      253    13795    1   ARS = LENGTHC( KLDREC ) ;
      254    13796    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR2 ) ;
      255    13797    1   CALL ASB$READ_HLP( DREC$, ARS )
      256    13798    2   WHENRETURN DO;
      257    13799                                              /* Device exists                      */
      258    13800    2      CALL ASB$CHECK_TYPE(DREC$,ARS, 11 /* CG DEVICE */, CREATE, DEV_NAME) ALTRET(EXIT#
             13800               );
      259    13801    3      IF CREATE THEN DO ;
      260    13802           /*E*  ERROR:    ASA-E$DEVEXISTS-C
      261    13803                 MESSAGE:  Device exists.
      262    13804                 MESSAGE1: Device %"%U1" %already exists.
      263    13805           */
      264    13806    3         AS_FIELD1 = DEV_NAME;
      265    13807              %SCREAM( ERR#=E$DEVEXISTS, LEVEL=ERROR, MID='A' ) ;
      266    13822    3         RETURN ;
      267    13823    3         END ;                        /* Then do                            */
      268    13824    2      DEV_ARS = ARS ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:12   
      269    13825    2      END; /*  Whenreturn  */
      270    13826    2   WHENALTRETURN DO;
      271    13827                                                                    /**/
      272    13828    3      IF NOT CREATE THEN DO;       /* If create then ok as is     */
      273    13829           /*E*  ERROR:    ASA-E$DEVSWITCH-C
      274    13830                 MESSAGE:  ** Device does not exist. Switching to CREATE mode.
      275    13831           */
      276    13832              %SCREAM( ERR#=E$DEVSWITCH, LEVEL=ERROR, MID='A' ) ;
      277    13847    3         CREATE = AS_TRUE ;
      278    13848    3         END; /*  If not create  */
      279    13849    2      END; /*  Whenaltreturn  */
      280    13850                                                              /* Check to see if
      281    13851                                                                 'FOR' was specified. */
      282    13852    1   IF P$NODE.SUBNODES > SUBNODES
      283    13853    1   THEN                            /* Yes it was                         */
      284    13854    2   DO ;
      285    13855    2      BLK$ = P$NODE.SUBLK$(SUBNODES-1) -> P$NODE.SUBLK$(0) ;
      286    13856    2      IF OUT$SYM.COUNT > 8
      287    13857    2      THEN
      288    13858    3      DO ;
      289    13859              %SCREAM( ERR#=E$DNAMETOOBIG, MID='A', LEVEL=ERROR );
      290    13874    3         RETURN ;
      291    13875    3         END ;                     /* Then do                            */
      292    13876    2      SNAME = OUT$SYM.TEXT ;
      293    13877    3      IF NOT CREATE AND KL$DREC.SNAME ~= SNAME THEN DO;
      294    13878    4         IF KL$DREC.SNAME = ' *NOTRM*' THEN DO;
      295    13879        /*E*  ERROR:  ASA-E$TERM_NOT_MEANINGFUL-C
      296    13880        MESSAGE: FOR TERMINAL or STATION is not meaningful for USE=CG or USE=TP devices.
      297    13881        MESSAGE1: USE=CG or USE=TP devices are not created for a terminal or a station.
      298    13882        */
      299    13883                 %SCREAM( ERR#=E$TERM_NOT_MEANINGFUL, LEVEL=WARN, MID='A' );
      300    13898    4            END;
      301    13899    4         ELSE DO;
      302    13900        /*E* ERROR:   ASA-E$DEV_FOR_WRONG-C
      303    13901             MESSAGE: Warning:  Device %U1 was created for %U2, not %U3.
      304    13902        */
      305    13903    4            AS_FIELD1 = DEV_NAME;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:13   
      306    13904    4            CALL INDEX( I, AS_BLANK, KL$DREC.SNAME );
      307    13905    4            AS_FIELD2.COUNT = I;
      308    13906    4            AS_FIELD2.TEXT  = KL$DREC.SNAME ;
      309    13907    4            AS_FIELD3.COUNT = OUT$SYM.COUNT ;
      310    13908    4            AS_FIELD3.TEXT  = OUT$SYM.TEXT ;
      311    13909                 %SCREAM( ERR#=E$DEV_FOR_WRONG, MID='A', LEVEL=WARN );
      312    13924    4            END;
      313    13925    3         SNAME = KL$DREC.SNAME;
      314    13926    3         END;
      315    13927    2      END ;                        /* Then do                            */
      316    13928    1   ELSE                            /* No it wasn't                       */
      317    13929    1      IF CREATE
      318    13930    1      THEN SNAME = 'LOCAL';
      319    13931    1      ELSE SNAME = KL$DREC.SNAME ;
      320    13932    2   IF SNAME = ' *NOTRM*' THEN DO;
      321    13933    2      TWSN_INDEX = 0;
      322    13934    2      TWSNR$ = ADDR(TWSN_REC);
      323    13935    2      END;
      324    13936    2   ELSE DO;
      325    13937    2      CALL CONCAT( USERS_KEY.TXTC, SNAME, 'STATION' );
      326    13938    2      USERS_KEY.COUNT = 15;
      327    13939                                                /* Pick up terminal record            */
      328    13940    2      TREC$ = DSEG1$ ;
      329    13941    2      ARS = DSEG1SIZE ;
      330    13942    2      CALL ASB$READ_HLP( TREC$, ARS )
      331    13943    3      WHENALTRETURN DO;
      332    13944    3         AS_FIELD1 = USERS_KEY;
      333    13945              %SCREAM( ERR#=E$TERMINAL_NOEXIST, MID='A', LEVEL=ERROR ) ;
      334    13960    3         RETURN ;
      335    13961    3         END; /*  Whenaltreturn  */
      336    13962                                                                    /**/
      337    13963                                                /* Get twsn number                    */
      338    13964    2      TWSNC = KL$TREC.TWSN# ;
      339    13965    2      CALL CHARBIN( TWSN#, TWSNC ) ;
      340    13966                                                /* Pick up twsn record                */
      341    13967    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;
      342    13968    2      USERS_KEY.COUNT = 8 ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:14   
      343    13969    2      TWSNR$ = DSEG2$ ;
      344    13970    2      TWSN_ARS = DSEG2SIZE ;
      345    13971    2      CALL ASB$ENQ_HLP ALTRET( ENQ_ERR2 ) ;
      346    13972    2      CALL ASB$READ_HLP( TWSNR$, TWSN_ARS )
      347    13973    3      WHENALTRETURN DO;
      348    13974    3         AS_FIELD1 = USERS_KEY ;
      349    13975              %SCREAM( ERR#=E$TERM_NO_EXIST, LEVEL=ERROR, MID='A' ) ;
      350    13990    3         RETURN ;
      351    13991    3         END; /*  Whenaltreturn  */
      352    13992                                                                    /**/
      353    13993                                                /* Get twsn record index for device */
      354    13994    2      IF CREATE THEN
      355    13995    2         TWSN_INDEX = KL$TWSNREC.NDEV ;
      356    13996    2      ELSE
      357    13997    2         CALL ASB$FIND_TWSN_INDEX( TREC$, DREC$, TWSNR$, AS_FALSE, DEV_KEY.TXT.ACCT,
             13997                  TWSN_INDEX ) ALTRET(EXIT#) ;
      358    13998    2      END;
      359    13999
      360    14000                                                /* Do options                         */
      361    14001    1   FROM_KEY.TEXT = DEV_KEY.TXT.ACCT ;
      362    14002    1   CALL ASA$DEV_OPTS(DREC$, TWSNR$, TWSNC, CREATE, '0'B, '    ', TWSN_INDEX)
      363    14003    2   WHENRETURN DO;
      364    14004    2      IF KL$DREC.SUPER = 5 /* INSYM DEVICE */ OR KL$DREC.SUPER = 6 /* OUTSYM DEVICE */
      365    14005    3           OR KL$DREC.SUPER = 12 /* RES DEVICE */ THEN DO ;
      366    14006    4         IF CREATE THEN DO ;
      367    14007    4            KL$TWSNREC.NDEV = TWSN_INDEX + 1 ;
      368    14008    4            TWSN_ARS = TWSN_ARS + LENGTHC(KL$TWSNREC.DEVS(0)) ;
      369    14009    4            END ;
      370    14010                                                /* Write twsn record                 */
      371    14011    3         CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;
      372    14012    3         USERS_KEY.COUNT = 8 ;
      373    14013    3         CALL ASB$WRITE_HLP( TWSNR$, TWSN_ARS ) ALTRET( WRITE_TWSNR_ERR ) ;
      374    14014    3         IF CREATE THEN KL$DREC.SNAME = SNAME ;
      375    14015    3         END;
      376    14016    2      ELSE
      377    14017    2         IF CREATE THEN KL$DREC.SNAME = ' *NOTRM*';
      378    14018    2   WRITE_DEV_REC: ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:15   
      379    14019                                                                                    /**/
      380    14020    2      DEV_ARS = LENGTHC( KL_DREC_CNT ) + KL$DREC.NWINFO*4 ;
      381    14021    2      USERS_KEY = DEV_KEY ;
      382    14022    2      CALL ASB$ENQ_HLP ALTRET( ENQ_ERR2 ) ;
      383    14023    2      CALL ASB$WRITE_HLP( DREC$, DEV_ARS ) ALTRET( WRITE_TWSNR_ERR ) ;
      384    14024    2      CALL ASB$DEQ_HLP ALTRET( DEQ_ERR2 ) ;
      385    14025                                                                                    /**/
      386    14026    2      IF CREATE THEN
      387    14027    2         CALL ASB$WRITE_LO( AS_CREATED_TEXT, LENGTHC(AS_CREATED_TEXT) ) ;
      388    14028
      389    14029    2      RETURN ;
      390    14030    2      END; /* Whenreturn */
      391    14031
      392    14032                                                /* Errors                             */
      393    14033    1   ENQ_ERR2: ;
      394    14034
      395    14035    1   DEQ_ERR2: ;
      396    14036    1   EXIT#: ;
      397    14037                                                                                    /**/
      398    14038    1   RETURN ;
      399    14039                                                                                    /**/
      400    14040    1   WRITE_TWSNR_ERR: ;
      401    14041    1   CALL ASH$ERROR( ERR_CODE ) ;
      402    14042    1   RETURN ;
      403    14043                                                                                    /**/
      404    14044                                                                                    /**/
      405    14045    1   END   ASA$DEVICE ;
      406    14046        %EOD;

PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:16   
--  Include file information  --

   KC$CGBLK.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$DEVICE.

   Procedure ASA$DEVICE requires 515 words for executable code.
   Procedure ASA$DEVICE requires 1078 words of local(AUTO) storage.

PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:17   

 Object Unit name= ASA$DEVICE                                 File name= ASA$DEVICE.:E05TOU
 UTS= JUL 29 '97 08:34:04.92 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   DCB   even  none     0      0  M$UC
    2   Data  even  none     6      6  ASA$DEVICE
    3  RoData even  UTS     19     23  ASA$DEVICE
    4   Proc  even  none   515   1003  ASA$DEVICE
    5  RoData even  none    24     30  ASA$DEVICE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  ASA$DEVICE
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:18   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       6 ASB$FIND_TWSN_INDEX
 yes     yes           Std       2 ASB$WRITE_HLP
         yes           Std       2 ASB$WRITE_LO
 yes     yes           Std       0 ASB$GETSEG
         yes           Std       2 ASH$ERROR
 yes     yes           Std       0 ASB$ENQ_HLP
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       2 ASH$WARN
 yes     yes           Std       0 ASB$DEQ_HLP
 yes     yes           Std       1 X$PARSE
 yes     yes           Std       9 ASA$DEV_OPTS
 yes     yes           Std       5 ASB$CHECK_TYPE
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_TRUE                          r    AS_FALSE
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             AS_CREATED_TEXT                       FROM_KEY
     NODE$                                 ERR_CODE                              AS_FIELD1
     AS_FIELD2                             AS_FIELD3                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG_FLG
     DSEG1$                                DSEG1SIZE                             DSEG2$
     DSEG2SIZE                             DSEG3$                                P_PCB
     KL_DREC_CNT                           M$UC                                  DEVICE_CMD
     TP_DEVICE_CMD                         B_VECTNIL
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:19   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:20   


        1        1        /*M*  ASA$DEVICE - Processes CREATE and MODIFY for DEVICE. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        /**/
       10       10        /*   ASA$DEVICE : This module consists of procedures:
       11       11                             ASA$DEVICE
       12       12                             ASA$DEV_OPTS
       13       13                                                                */
       14       14        /*P*   NAME: ASA$DEVICE
       15       15               PURPOSE:  This module  of SUPER processes the 'CREATE DEVICE'
       16       16                         and the 'MODIFY DEVICE' commands.  It calls
       17       17                         ASA$DEV_OPTS to process the options.
       18       18        */
       19       19        ASA$DEVICE: PROC ;

     19  4 000000   000000 700200 xent  ASA$DEVICE   TSX0  ! X66_AUTO_0
         4 000001   002066 000000                    ZERO    1078,0

       20       20                                                       /**/
       21       21        %SET LISTSUB = '1'B ;
       22       22        /*********************************************************************/
       23       23        /*   Include files   include files   include files   include files   */
       24       24        /*********************************************************************/
       25       25                                                                                    /**/
       26       26              %INCLUDE  AS_ENTRIES_M ;
       27     1076              %INCLUDE  AS_PERR_C    ;
       28     1678              %INCLUDE  AS_SSUBS_C   ;
       29     1770              %INCLUDE  AS_SUBS_C    ;
       30     3184              %INCLUDE  KL_SUPER_C   ;
       31     6086              %INCLUDE  XU_FORMAT_C  ;
       32     6248              %INCLUDE  XU_MACRO_C   ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:21   
       33     9354              %INCLUDE  AS_SUPER_C   ;
       34     9789              %INCLUDE  AS_MAC_C     ;
       35     9869              %INCLUDE  AS_SUPER_R   ;
       36    12885              %INCLUDE  CP_6         ;
       37    12966              %INCLUDE  B_MACROS_C   ;
       38    13077              %INCLUDE  KC$CGBLK     ;
       39    13125        %EJECT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:22   
       40    13126        /*********************************************************************/
       41    13127        /*   Auto data       auto data       auto data       auto data       */
       42    13128        /*********************************************************************/
       43    13129                                                                                    /**/
       44    13130    1   DCL CREATE BIT(1) ALIGNED;
       45    13131    1   DCL TYPE CHAR(2) ;
       46    13132    1   DCL KLDREC CHAR(4096) ;
       47    13133    1   DCL SNAME CHAR(8);
       48    13134    1   DCL TWSNC CHAR(4) ;
       49    13135    1   DCL TWSN# UBIN WORD ;
       50    13136    1   DCL TWSN_INDEX UBIN WORD ;
       51    13137    1   DCL DEV_ARS UBIN WORD ;
       52    13138    1   DCL TWSN_ARS UBIN WORD ;
       53    13139    1   DCL ARS UBIN WORD ;
       54    13140    1   DCL I UBIN WORD ALIGNED;
       55    13141    1   DCL 1 TP_DEV BASED (DSEG3$),
       56    13142    1          2 DEV_TYPE UBIN WORD,
       57    13143    1          2 SNAME CHAR (8);
       58    13144    1   DCL ACCT CHAR (8) ALIGNED;
       59    13145    1   DCL UNAME CHAR (12) ALIGNED;
       60    13146    1   DCL SUBNODES UBIN WORD;
       61    13147    1   DCL UNAME_LEN UBIN;
       62    13148    1   DCL BLK$ PTR ;
       63    13149    1   DCL TREC$ PTR ;
       64    13150    1   DCL DREC$ PTR ;
       65    13151    1   DCL PRO$ PTR ;
       66    13152    1   DCL TWSNR$ PTR ;
       67    13153    1   DCL 1 DEV_NAME,
       68    13154    1          2 COUNT UBIN BYTE UNAL,
       69    13155    1          2 TEXT CHAR(8) UNAL;
       70    13156        %KL_TWSNREC( NAME=TWSN_REC, STCLASS=AUTO );
       71    13181        %EJECT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:23   
       72    13182        /*********************************************************************/
       73    13183        /*   Symref's        symref's        symref's        symref's        */
       74    13184        /*********************************************************************/
       75    13185                                                                                    /**/
       76    13186    1   DCL DEVICE_CMD SYMREF UBIN WORD ;
       77    13187    1   DCL TP_DEVICE_CMD SYMREF UBIN WORD ;
       78    13188        %EJECT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:24   
       79    13189        /*********************************************************************/
       80    13190        /*   Static data     static data     static data     static data     */
       81    13191        /*********************************************************************/
       82    13192                                                                                    /**/
       83    13193    1   DCL 1 DEV_KEY ALIGNED STATIC ,
       84    13194    1          2 CNT UBIN BYTE UNAL INIT( 9 ),
       85    13195    1          2 TXT UNAL ,
       86    13196    1             3 ACCT CHAR(8) UNAL INIT(' ') ,
       87    13197    1             3 UNAME CHAR(12) UNAL INIT(' ') ;
       88    13198        %EJECT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:25   
       89    13199        /********************************************************************/
       90    13200        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       91    13201        /*********************************************************************/
       92    13202                                                                                    /**/
       93    13203    1   DCL X$PARSE ENTRY(1) ALTRET ;
       94    13204        %ASA$DEV_OPTS ;
       95    13207        %ASB$FIND_TWSN_INDEX ;
       96    13210        %ASB$ENQ_HLP ;
       97    13213        %ASB$DEQ_HLP ;
       98    13216        %ASB$READ_HLP ;
       99    13219        %ASB$WRITE_HLP ;
      100    13222        %ASB$GETSEG ;
      101    13225        %ASH$ERROR ;
      102    13228        %ASH$WARN ;
      103    13231        %ASB$WRITE_LO ;
      104    13234        %ASB$CHECK_TYPE ;
      105    13237        %EJECT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:26   
      106    13238        /*********************************************************************/
      107    13239        /*   Local based     local based     local based     local based     */
      108    13240        /*********************************************************************/
      109    13241                                                                                    /**/
      110    13242            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      111    13243                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
      112    13288              %PARSE$SYM( NAME = OUT$SYM ,
      113    13289                          STCLASS="BASED(BLK$)") ;
      114    13327              %KL_DREC ( NAME = KL$TREC , LAST=";", STCLASS="BASED( TREC$ )" ) ;
      115    13440              %KL_DREC( NAME=KL$DREC, STCLASS="BASED( DREC$ )", LAST="," ) ;
      116    13553              %KC$CGID(FPTN=KC$CGID,
      117    13554                        LVL = 2 ,
      118    13555                        LAST = ";" );
      119    13581              %KL_TWSNREC(  NAME = KL$TWSNREC ,
      120    13582                            STCLASS="BASED( TWSNR$ )") ;
      121    13607        %EJECT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:27   
      122    13608        /*********************************************************************/
      123    13609        /*   Procedure       procedure       procedure       procedure       */
      124    13610        /*********************************************************************/
      125    13611                                                                                    /**/
      126    13612        /*
      127    13613            ***            Begin procedure                    ***
      128    13614        */
      129    13615    1   IF NOT DSEG_FLG

  13615  4 000002   000000 234000 xsym               SZN     DSEG_FLG
         4 000003   000015 604000 4                  TMI     s:13638

      130    13616    2   THEN DO;   /* Get the data segments since we will actually use a word */

      131    13617    2      CALL ASB$GETSEG

  13617  4 000004   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000005   000000 701000 xent               TSX1    ASB$GETSEG
         4 000006   000010 702000 4                  TSX2    s:13631
         4 000007   000015 710000 4                  TRA     s:13638

      132    13618    3      WHENALTRETURN DO;

      133    13619              %SCREAM( ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='A' ) ;

  13631  4 000010   000000 630400 5                  EPPR0   0
         4 000011   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000012   000000 701000 xent               TSX1    ASH$ERROR
         4 000013   000000 011000                    NOP     0

      134    13634    3         RETURN ;

  13634  4 000014   000000 702200 xent               TSX2  ! X66_ARET

      135    13635    3         END; /*  Whenaltreturn  */
      136    13636                                                                    /**/
      137    13637    2      END;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:28   

      138    13638    1   P_PCB.ROOT$ = ADDR( DEVICE_CMD ) ;

  13638  4 000015   000001 236000 5                  LDQ     1
         4 000016   000001 756000 xsym               STQ     P_PCB+1

      139    13639    1   CALL X$PARSE( P_PCB )

  13639  4 000017   000002 630400 5                  EPPR0   2
         4 000020   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000021   000000 701000 xent               TSX1    X$PARSE
         4 000022   000105 702000 4                  TSX2    s:13702

      140    13640    2   WHENRETURN DO;

      141    13641    2      TP_DEV.DEV_TYPE = 0;

  13641  4 000023   000000 470400 xsym               LDP0    DSEG3$
         4 000024   000000 450100                    STZ     0,,PR0

      142    13642                                                                                    /**/
      143    13643    2      NODE$ = P_PCB.OUT$ ;

  13643  4 000025   000003 236000 xsym               LDQ     P_PCB+3
         4 000026   000000 756000 xsym               STQ     NODE$

      144    13644    2      IF P$NODE.CODE = 38 /* CR_DEVICE */

  13644  4 000027   000000 470400 xsym               LDP0    NODE$
         4 000030   000000 720100                    LXL0    0,,PR0
         4 000031   000046 100003                    CMPX0   38,DU
         4 000032   000037 601000 4                  TNZ     s:13648

      145    13645    2      THEN
      146    13646    2         CREATE = AS_TRUE ;

  13646  4 000033   000000 236000 xsym               LDQ     AS_TRUE
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:29   
         4 000034   400000 376003                    ANQ     -131072,DU
         4 000035   200003 756100                    STQ     CREATE,,AUTO
         4 000036   000042 710000 4                  TRA     s:13651

      147    13647    2      ELSE
      148    13648    2         CREATE = AS_FALSE ;

  13648  4 000037   000000 236000 xsym               LDQ     AS_FALSE
         4 000040   400000 376003                    ANQ     -131072,DU
         4 000041   200003 756100                    STQ     CREATE,,AUTO

      149    13649                                                /* Did we get data SEG.?              */
      150    13650                                                /* Pick up acct.                      */
      151    13651    2      BLK$ = P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;

  13651  4 000042   000003 471500                    LDP1    3,,PR0
         4 000043   100003 236100                    LDQ     3,,PR1
         4 000044   202025 756100                    STQ     BLK$,,AUTO

      152    13652    3      IF OUT$SYM.COUNT > 8 THEN DO;

  13652  4 000045   202025 473500                    LDP3    BLK$,,AUTO
         4 000046   300004 236100                    LDQ     4,,PR3
         4 000047   777000 376003                    ANQ     -512,DU
         4 000050   011000 116003                    CMPQ    4608,DU
         4 000051   000057 602000 4                  TNC     s:13674

      153    13653        /*E*  ERROR:    ASA-E$DNAMETOOBIG-C
      154    13654              MESSAGE:  Device name too long.
      155    13655              MESSAGE1: Device names can be at most 8 characters.
      156    13656        */
      157    13657              %SCREAM( ERR#=E$DNAMETOOBIG , LEVEL=ERROR, MID='A' );

  13669  4 000052   000003 630400 5                  EPPR0   3
         4 000053   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000054   000000 701000 xent               TSX1    ASH$ERROR
         4 000055   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:30   

      158    13672    3         RETURN ;

  13672  4 000056   000000 702200 xent               TSX2  ! X66_ARET

      159    13673    3         END ; /* Then do */
      160    13674    2      DEV_NAME.COUNT = OUT$SYM.COUNT;

  13674  4 000057   300004 236100                    LDQ     4,,PR3
         4 000060   202032 552140                    STBQ    DEV_NAME,'40'O,AUTO

      161    13675    2      DEV_NAME.TEXT = OUT$SYM.TEXT;

  13675  4 000061   300004 236100                    LDQ     4,,PR3
         4 000062   000033 772000                    QRL     27
         4 000063   000000 620006                    EAX0    0,QL
         4 000064   040100 100540                    MLR     fill='040'O
         4 000065   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000066   202032 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8

      162    13676    2      DEV_KEY.TXT.UNAME = '*';

  13676  4 000067   040000 100400                    MLR     fill='040'O
         4 000070   000004 000001 5                  ADSC9   4                        cn=0,n=1
         4 000071   000002 200014 2                  ADSC9   DEV_KEY+2                cn=1,n=12

      163    13677    2      DEV_KEY.TXT.ACCT = DEV_NAME.TEXT;

  13677  4 000072   040000 100500                    MLR     fill='040'O
         4 000073   202032 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 000074   000000 200010 2                  ADSC9   DEV_KEY                  cn=1,n=8

      164    13678    2      DEV_KEY.CNT = 9;

  13678  4 000075   011000 236003                    LDQ     4608,DU
         4 000076   000000 552040 2                  STBQ    DEV_KEY,'40'O

PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:31   
      165    13679    2      SUBNODES = 2;

  13679  4 000077   000002 235007                    LDA     2,DL
         4 000100   202023 755100                    STA     SUBNODES,,AUTO

      166    13680    2      USERS_KEY = DEV_KEY;

  13680  4 000101   000000 100400                    MLR     fill='000'O
         4 000102   000000 000025 2                  ADSC9   DEV_KEY                  cn=0,n=21
         4 000103   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      167    13681
      168    13682    2      END;

  13682  4 000104   000267 710000 4                  TRA     s:13794

      169    13683    2   WHENALTRETURN DO;

      170    13684        /* There are 2 forms of the special cr tp command.  The first is-
      171    13685           cr tp account (this will be refered to as type 1).
      172    13686           the second is ct tp account,uname (this will be called type 2).
      173    13687
      174    13688           If the user specifies cr tp as opposed to cr dev then the following
      175    13689           will happen.
      176    13690
      177    13691           We set the DEV_TYPE to 1 (0 is used for the regular cr dev command)
      178    13692           we create the key 'account (padded to 8 chars) *'.
      179    13693           we see if a comma was used (this will denote type 2)
      180    13694           if comma then set DEV_TYPE to 2, put the uname into the sname field
      181    13695            and make the key 'account (to 8 chars) uname'.
      182    13696
      183    13697           Data segment 3 (DSEG3) is used to pass the dev_type and sname
      184    13698           fields to the DEV_OPTS routine.  DEV_OPTS will check the DEV_TYPE,
      185    13699           if it's > 0 then use=tp will be simulated.  If the DEV_TYPE is 2
      186    13700           then the sname=uname option will be simulated.
      187    13701        */
      188    13702    2      P_PCB.ROOT$ = ADDR (TP_DEVICE_CMD);
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:32   

  13702  4 000105   000005 236000 5                  LDQ     5
         4 000106   000001 756000 xsym               STQ     P_PCB+1

      189    13703    2      CALL X$PARSE (P_PCB)

  13703  4 000107   000002 630400 5                  EPPR0   2
         4 000110   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000111   000000 701000 xent               TSX1    X$PARSE
         4 000112   000114 702000 4                  TSX2    s:13705
         4 000113   000121 710000 4                  TRA     s:13709

      190    13704    3      WHENALTRETURN DO;

      191    13705    3         CALL ASH$ERROR( P_PCB.ERROR ) ;

  13705  4 000114   000006 630400 5                  EPPR0   6
         4 000115   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000116   000000 701000 xent               TSX1    ASH$ERROR
         4 000117   000000 011000                    NOP     0

      192    13706    3         RETURN ;

  13706  4 000120   000000 702200 xent               TSX2  ! X66_ARET

      193    13707    3         END; /*  Whenaltreturn  */
      194    13708                                                                    /**/
      195    13709    2      SUBNODES = 3;

  13709  4 000121   000003 235007                    LDA     3,DL
         4 000122   202023 755100                    STA     SUBNODES,,AUTO

      196    13710    2      NODE$ = P_PCB.OUT$;

  13710  4 000123   000003 236000 xsym               LDQ     P_PCB+3
         4 000124   000000 756000 xsym               STQ     NODE$

PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:33   
      197    13711    2      IF P$NODE.CODE = 38 /* CR_DEVICE */

  13711  4 000125   000000 470400 xsym               LDP0    NODE$
         4 000126   000000 720100                    LXL0    0,,PR0
         4 000127   000046 100003                    CMPX0   38,DU
         4 000130   000135 601000 4                  TNZ     s:13715

      198    13712    2      THEN
      199    13713    2         CREATE = AS_TRUE ;

  13713  4 000131   000000 236000 xsym               LDQ     AS_TRUE
         4 000132   400000 376003                    ANQ     -131072,DU
         4 000133   200003 756100                    STQ     CREATE,,AUTO
         4 000134   000140 710000 4                  TRA     s:13716

      200    13714    2      ELSE
      201    13715    2         CREATE = AS_FALSE ;

  13715  4 000135   000000 236000 xsym               LDQ     AS_FALSE
         4 000136   400000 376003                    ANQ     -131072,DU
         4 000137   200003 756100                    STQ     CREATE,,AUTO

      202    13716    2      TP_DEV.DEV_TYPE = 1;

  13716  4 000140   000001 235007                    LDA     1,DL
         4 000141   000000 471400 xsym               LDP1    DSEG3$
         4 000142   100000 755100                    STA     0,,PR1

      203    13717    2      ACCT = NODE$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(0)->OUT$SYM.TEXT;

  13717  4 000143   000000 470400 xsym               LDP0    NODE$
         4 000144   000003 471500                    LDP1    3,,PR0
         4 000145   100003 473500                    LDP3    3,,PR1
         4 000146   300004 236100                    LDQ     4,,PR3
         4 000147   000033 772000                    QRL     27
         4 000150   000000 620006                    EAX0    0,QL
         4 000151   040100 100540                    MLR     fill='040'O
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:34   
         4 000152   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000153   202016 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8

      204    13718    2      DEV_KEY.TXT.ACCT = ACCT;

  13718  4 000154   040000 100500                    MLR     fill='040'O
         4 000155   202016 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
         4 000156   000000 200010 2                  ADSC9   DEV_KEY                  cn=1,n=8

      205    13719    2      DEV_KEY.TXT.UNAME = '*';

  13719  4 000157   040000 100400                    MLR     fill='040'O
         4 000160   000004 000001 5                  ADSC9   4                        cn=0,n=1
         4 000161   000002 200014 2                  ADSC9   DEV_KEY+2                cn=1,n=12

      206    13720    2      DEV_KEY.CNT = 9;

  13720  4 000162   011000 236003                    LDQ     4608,DU
         4 000163   000000 552040 2                  STBQ    DEV_KEY,'40'O

      207    13721    2      IF P$NODE.SUBNODES > 1

  13721  4 000164   000001 220100                    LDX0    1,,PR0
         4 000165   000002 100003                    CMPX0   2,DU
         4 000166   000254 602000 4                  TNC     s:13790

      208    13722    3      THEN DO;

      209    13723    3         IF P$NODE.SUBLK$(1)->P$NODE.CODE = 56 /* TPDEV_ACCT2_VAL */

  13723  4 000167   000004 471500                    LDP1    4,,PR0
         4 000170   100000 721100                    LXL1    0,,PR1
         4 000171   000070 101003                    CMPX1   56,DU
         4 000172   000247 601000 4                  TNZ     s:13785

      210    13724    4         THEN DO;

PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:35   
      211    13725    4            SUBNODES = 3;

  13725  4 000173   000003 235007                    LDA     3,DL
         4 000174   202023 755100                    STA     SUBNODES,,AUTO

      212    13726    4            TP_DEV.DEV_TYPE = 2;

  13726  4 000175   000002 235007                    LDA     2,DL
         4 000176   000000 473400 xsym               LDP3    DSEG3$
         4 000177   300000 755100                    STA     0,,PR3

      213    13727    4            UNAME = NODE$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->OUT$SYM.TEXT;

  13727  4 000200   000000 470400 xsym               LDP0    NODE$
         4 000201   000004 471500                    LDP1    4,,PR0
         4 000202   100003 473500                    LDP3    3,,PR1
         4 000203   300004 236100                    LDQ     4,,PR3
         4 000204   000033 772000                    QRL     27
         4 000205   000000 620006                    EAX0    0,QL
         4 000206   040100 100540                    MLR     fill='040'O
         4 000207   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000210   202020 000014                    ADSC9   UNAME,,AUTO              cn=0,n=12

      214    13728    4            UNAME_LEN = NODE$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->OUT$SYM.COUNT;

  13728  4 000211   202024 756100                    STQ     UNAME_LEN,,AUTO

      215    13729    4            DEV_KEY.CNT = 8 + UNAME_LEN;

  13729  4 000212   000010 036007                    ADLQ    8,DL
         4 000213   000033 736000                    QLS     27
         4 000214   000000 552040 2                  STBQ    DEV_KEY,'40'O

      216    13730    4            IF UNAME_LEN > 8

  13730  4 000215   202024 236100                    LDQ     UNAME_LEN,,AUTO
         4 000216   000011 116007                    CMPQ    9,DL
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:36   
         4 000217   000226 602000 4                  TNC     s:13755

      217    13731    5            THEN DO;

      218    13732        /*E*    ERROR: ASA-E$TPDEVSNAMETOOBIG-C
      219    13733             MESSAGE: Max size of a TP SNAME is 8 characters, UNAME will be truncated to 8.
      220    13734                MESSAGE1: The UNAME is used as the SNAME also, there is an 8 character
      221    13735                         limit on the SNAME which will cause truncation of the
      222    13736                         UNAME to 8 characters.
      223    13737        */
      224    13738                    %SCREAM (ERR#=E$TPDEVSNAMETOOBIG, LEVEL=WARN, MID='A');

  13748  4 000220   000007 630400 5                  EPPR0   7
         4 000221   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000222   000000 701000 xent               TSX1    ASH$WARN
         4 000223   000000 011000                    NOP     0

      225    13753    5               UNAME_LEN = 8;

  13753  4 000224   000010 235007                    LDA     8,DL
         4 000225   202024 755100                    STA     UNAME_LEN,,AUTO

      226    13754    5               END;

      227    13755    4            IF (SUBSTR( UNAME, 1, 2) = '$$')

  13755  4 000226   040000 106500                    CMPC    fill='040'O
         4 000227   202020 200002                    ADSC9   UNAME,,AUTO              cn=1,n=2
         4 000230   000003 000002 3                  ADSC9   3                        cn=0,n=2
         4 000231   000237 601000 4                  TNZ     s:13781

      228    13756    5            THEN DO;

      229    13757        /*      ERROR: ASA-E$NO$$ONSNAME-0
      230    13758                MESSAGE1: The sname of a cg type device cannot start with '$$'.
      231    13759                MESSAGE2: Comgroups do not allow '$$' as the first 2 characters
      232    13760                          of a name.
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:37   
      233    13761                DESCRIPTION: You tried to specify an sname with '$$' as the
      234    13762                         first two characters, this is a no-no!
      235    13763        */
      236    13764                    %SCREAM (ERR#=E$NO$$ONSNAME, LEVEL=ERROR, MID='A');

  13776  4 000232   000010 630400 5                  EPPR0   8
         4 000233   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000234   000000 701000 xent               TSX1    ASH$ERROR
         4 000235   000000 011000                    NOP     0

      237    13779    5               RETURN;

  13779  4 000236   000000 702200 xent               TSX2  ! X66_ARET

      238    13780    5               END;
      239    13781    4            TP_DEV.SNAME = UNAME;

  13781  4 000237   000000 470400 xsym               LDP0    DSEG3$
         4 000240   202020 237100                    LDAQ    UNAME,,AUTO
         4 000241   000001 755100                    STA     1,,PR0
         4 000242   000002 756100                    STQ     2,,PR0

      240    13782    4            DEV_KEY.TXT.UNAME = UNAME;

  13782  4 000243   040000 100500                    MLR     fill='040'O
         4 000244   202020 000014                    ADSC9   UNAME,,AUTO              cn=0,n=12
         4 000245   000002 200014 2                  ADSC9   DEV_KEY+2                cn=1,n=12

      241    13783    4            END;

  13783  4 000246   000254 710000 4                  TRA     s:13790

      242    13784    4         ELSE DO; /* No uname specified */

      243    13785    4            UNAME_LEN = 1;

  13785  4 000247   202024 755100                    STA     UNAME_LEN,,AUTO
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:38   

      244    13786    4            UNAME = '*';

  13786  4 000250   040100 100400                    MLR     fill='040'O
         4 000251   000004 000001 5                  ADSC9   4                        cn=0,n=1
         4 000252   202020 000014                    ADSC9   UNAME,,AUTO              cn=0,n=12

      245    13787    4            DEV_KEY.CNT = 9;

  13787  4 000253   000000 552040 2                  STBQ    DEV_KEY,'40'O

      246    13788    4            END;

      247    13789    3         END;

      248    13790    2      USERS_KEY.COUNT = DEV_KEY.CNT;

  13790  4 000254   000000 236000 2                  LDQ     DEV_KEY
         4 000255   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      249    13791    2      CALL CONCAT (USERS_KEY.TXTC, ACCT, UNAME);

  13791  4 000256   040000 100500                    MLR     fill='040'O
         4 000257   202016 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
         4 000260   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 000261   040000 100500                    MLR     fill='040'O
         4 000262   202020 000014                    ADSC9   UNAME,,AUTO              cn=0,n=12
         4 000263   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      250    13792    2      DEV_NAME = USERS_KEY;

  13792  4 000264   000100 100400                    MLR     fill='000'O
         4 000265   000000 000011 xsym               ADSC9   USERS_KEY                cn=0,n=9
         4 000266   202032 000011                    ADSC9   DEV_NAME,,AUTO           cn=0,n=9

      251    13793    2      END;

PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:39   
      252    13794    1   DREC$ = ADDR( KLDREC ) ;

  13794  4 000267   200005 630500                    EPPR0   KLDREC,,AUTO
         4 000270   202027 450500                    STP0    DREC$,,AUTO

      253    13795    1   ARS = LENGTHC( KLDREC ) ;

  13795  4 000271   010000 235007                    LDA     4096,DL
         4 000272   202014 755100                    STA     ARS,,AUTO

      254    13796    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR2 ) ;

  13796  4 000273   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000274   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 000275   000775 702000 4                  TSX2    ENQ_ERR2

      255    13797    1   CALL ASB$READ_HLP( DREC$, ARS )

  13797  4 000276   202014 630500                    EPPR0   ARS,,AUTO
         4 000277   202057 450500                    STP0    TWSN_REC+18,,AUTO
         4 000300   202027 631500                    EPPR1   DREC$,,AUTO
         4 000301   202056 451500                    STP1    TWSN_REC+17,,AUTO
         4 000302   202056 630500                    EPPR0   TWSN_REC+17,,AUTO
         4 000303   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000304   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000305   000341 702000 4                  TSX2    s:13828

      256    13798    2   WHENRETURN DO;

      257    13799                                              /* Device exists                      */
      258    13800    2     CALL ASB$CHECK_TYPE(DREC$,ARS, 11 /* CG DEVICE */, CREATE, DEV_NAME) ALTRET(EXIT#
             13800               );

  13800  4 000306   202032 630500                    EPPR0   DEV_NAME,,AUTO
         4 000307   202062 450500                    STP0    TWSN_REC+21,,AUTO
         4 000310   200003 631500                    EPPR1   CREATE,,AUTO
         4 000311   202061 451500                    STP1    TWSN_REC+20,,AUTO
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:40   
         4 000312   000011 236000 5                  LDQ     9
         4 000313   202060 756100                    STQ     TWSN_REC+19,,AUTO
         4 000314   202014 633500                    EPPR3   ARS,,AUTO
         4 000315   202057 453500                    STP3    TWSN_REC+18,,AUTO
         4 000316   202027 634500                    EPPR4   DREC$,,AUTO
         4 000317   202056 454500                    STP4    TWSN_REC+17,,AUTO
         4 000320   202056 630500                    EPPR0   TWSN_REC+17,,AUTO
         4 000321   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 000322   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 000323   000775 702000 4                  TSX2    ENQ_ERR2

      259    13801    3      IF CREATE THEN DO ;

  13801  4 000324   200003 234100                    SZN     CREATE,,AUTO
         4 000325   000336 605000 4                  TPL     s:13824

      260    13802           /*E*  ERROR:    ASA-E$DEVEXISTS-C
      261    13803                 MESSAGE:  Device exists.
      262    13804                 MESSAGE1: Device %"%U1" %already exists.
      263    13805           */
      264    13806    3         AS_FIELD1 = DEV_NAME;

  13806  4 000326   000000 100500                    MLR     fill='000'O
         4 000327   202032 000011                    ADSC9   DEV_NAME,,AUTO           cn=0,n=9
         4 000330   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      265    13807              %SCREAM( ERR#=E$DEVEXISTS, LEVEL=ERROR, MID='A' ) ;

  13819  4 000331   000012 630400 5                  EPPR0   10
         4 000332   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000333   000000 701000 xent               TSX1    ASH$ERROR
         4 000334   000000 011000                    NOP     0

      266    13822    3         RETURN ;

  13822  4 000335   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:41   
      267    13823    3         END ;                        /* Then do                            */
      268    13824    2      DEV_ARS = ARS ;

  13824  4 000336   202014 235100                    LDA     ARS,,AUTO
         4 000337   202012 755100                    STA     DEV_ARS,,AUTO

      269    13825    2      END; /*  Whenreturn  */

  13825  4 000340   000352 710000 4                  TRA     s:13852

      270    13826    2   WHENALTRETURN DO;

      271    13827                                                                    /**/
      272    13828    3      IF NOT CREATE THEN DO;       /* If create then ok as is     */

  13828  4 000341   200003 234100                    SZN     CREATE,,AUTO
         4 000342   000352 604000 4                  TMI     s:13852

      273    13829           /*E*  ERROR:    ASA-E$DEVSWITCH-C
      274    13830                 MESSAGE:  ** Device does not exist. Switching to CREATE mode.
      275    13831           */
      276    13832              %SCREAM( ERR#=E$DEVSWITCH, LEVEL=ERROR, MID='A' ) ;

  13844  4 000343   000013 630400 5                  EPPR0   11
         4 000344   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000345   000000 701000 xent               TSX1    ASH$ERROR
         4 000346   000000 011000                    NOP     0

      277    13847    3         CREATE = AS_TRUE ;

  13847  4 000347   000000 236000 xsym               LDQ     AS_TRUE
         4 000350   400000 376003                    ANQ     -131072,DU
         4 000351   200003 756100                    STQ     CREATE,,AUTO

      278    13848    3         END; /*  If not create  */

      279    13849    2      END; /*  Whenaltreturn  */
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:42   

      280    13850                                                              /* Check to see if
      281    13851                                                                 'FOR' was specified. */
      282    13852    1   IF P$NODE.SUBNODES > SUBNODES

  13852  4 000352   000000 470400 xsym               LDP0    NODE$
         4 000353   000001 236100                    LDQ     1,,PR0
         4 000354   000022 772000                    QRL     18
         4 000355   202023 116100                    CMPQ    SUBNODES,,AUTO
         4 000356   000462 602000 4                  TNC     s:13929
         4 000357   000462 600000 4                  TZE     s:13929

      283    13853    1   THEN                            /* Yes it was                         */
      284    13854    2   DO ;

      285    13855    2      BLK$ = P$NODE.SUBLK$(SUBNODES-1) -> P$NODE.SUBLK$(0) ;

  13855  4 000360   202023 720100                    LXL0    SUBNODES,,AUTO
         4 000361   000002 471510                    LDP1    2,X0,PR0
         4 000362   100003 236100                    LDQ     3,,PR1
         4 000363   202025 756100                    STQ     BLK$,,AUTO

      286    13856    2      IF OUT$SYM.COUNT > 8

  13856  4 000364   202025 473500                    LDP3    BLK$,,AUTO
         4 000365   300004 236100                    LDQ     4,,PR3
         4 000366   777000 376003                    ANQ     -512,DU
         4 000367   011000 116003                    CMPQ    4608,DU
         4 000370   000376 602000 4                  TNC     s:13876

      287    13857    2      THEN
      288    13858    3      DO ;

      289    13859              %SCREAM( ERR#=E$DNAMETOOBIG, MID='A', LEVEL=ERROR );

  13871  4 000371   000003 630400 5                  EPPR0   3
         4 000372   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:43   
         4 000373   000000 701000 xent               TSX1    ASH$ERROR
         4 000374   000000 011000                    NOP     0

      290    13874    3         RETURN ;

  13874  4 000375   000000 702200 xent               TSX2  ! X66_ARET

      291    13875    3         END ;                     /* Then do                            */
      292    13876    2      SNAME = OUT$SYM.TEXT ;

  13876  4 000376   300004 236100                    LDQ     4,,PR3
         4 000377   000033 772000                    QRL     27
         4 000400   000000 621006                    EAX1    0,QL
         4 000401   040100 100540                    MLR     fill='040'O
         4 000402   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 000403   202005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8

      293    13877    3      IF NOT CREATE AND KL$DREC.SNAME ~= SNAME THEN DO;

  13877  4 000404   200003 234100                    SZN     CREATE,,AUTO
         4 000405   000474 604000 4                  TMI     s:13932
         4 000406   202027 474500                    LDP4    DREC$,,AUTO
         4 000407   040100 106500                    CMPC    fill='040'O
         4 000410   400015 000010                    ADSC9   13,,PR4                  cn=0,n=8
         4 000411   202005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000412   000474 600000 4                  TZE     s:13932

      294    13878    4         IF KL$DREC.SNAME = ' *NOTRM*' THEN DO;

  13878  4 000413   040000 106500                    CMPC    fill='040'O
         4 000414   400015 000010                    ADSC9   13,,PR4                  cn=0,n=8
         4 000415   000007 000010 3                  ADSC9   7                        cn=0,n=8
         4 000416   000424 601000 4                  TNZ     s:13903

      295    13879        /*E*  ERROR:  ASA-E$TERM_NOT_MEANINGFUL-C
      296    13880        MESSAGE: FOR TERMINAL or STATION is not meaningful for USE=CG or USE=TP devices.
      297    13881        MESSAGE1: USE=CG or USE=TP devices are not created for a terminal or a station.
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:44   
      298    13882        */
      299    13883                 %SCREAM( ERR#=E$TERM_NOT_MEANINGFUL, LEVEL=WARN, MID='A' );

  13893  4 000417   000014 630400 5                  EPPR0   12
         4 000420   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000421   000000 701000 xent               TSX1    ASH$WARN
         4 000422   000000 011000                    NOP     0

      300    13898    4            END;

  13898  4 000423   000455 710000 4                  TRA     s:13925

      301    13899    4         ELSE DO;

      302    13900        /*E* ERROR:   ASA-E$DEV_FOR_WRONG-C
      303    13901             MESSAGE: Warning:  Device %U1 was created for %U2, not %U3.
      304    13902        */
      305    13903    4            AS_FIELD1 = DEV_NAME;

  13903  4 000424   000000 100500                    MLR     fill='000'O
         4 000425   202032 000011                    ADSC9   DEV_NAME,,AUTO           cn=0,n=9
         4 000426   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      306    13904    4            CALL INDEX( I, AS_BLANK, KL$DREC.SNAME );

  13904  4 000427   000000 124500                    SCM     mask='000'O
         4 000430   400015 000010                    ADSC9   13,,PR4                  cn=0,n=8
         4 000431   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000432   202015 000100                    ARG     I,,AUTO

      307    13905    4            AS_FIELD2.COUNT = I;

  13905  4 000433   202015 236100                    LDQ     I,,AUTO
         4 000434   000033 736000                    QLS     27
         4 000435   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      308    13906    4            AS_FIELD2.TEXT  = KL$DREC.SNAME ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:45   

  13906  4 000436   040000 100500                    MLR     fill='040'O
         4 000437   400015 000010                    ADSC9   13,,PR4                  cn=0,n=8
         4 000440   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      309    13907    4            AS_FIELD3.COUNT = OUT$SYM.COUNT ;

  13907  4 000441   300004 236100                    LDQ     4,,PR3
         4 000442   000000 552040 xsym               STBQ    AS_FIELD3,'40'O

      310    13908    4            AS_FIELD3.TEXT  = OUT$SYM.TEXT ;

  13908  4 000443   300004 236100                    LDQ     4,,PR3
         4 000444   000033 772000                    QRL     27
         4 000445   000000 621006                    EAX1    0,QL
         4 000446   040000 100540                    MLR     fill='040'O
         4 000447   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 000450   000000 200050 xsym               ADSC9   AS_FIELD3                cn=1,n=40

      311    13909                 %SCREAM( ERR#=E$DEV_FOR_WRONG, MID='A', LEVEL=WARN );

  13919  4 000451   000015 630400 5                  EPPR0   13
         4 000452   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000453   000000 701000 xent               TSX1    ASH$WARN
         4 000454   000000 011000                    NOP     0

      312    13924    4            END;

      313    13925    3         SNAME = KL$DREC.SNAME;

  13925  4 000455   202027 470500                    LDP0    DREC$,,AUTO
         4 000456   040100 100500                    MLR     fill='040'O
         4 000457   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         4 000460   202005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8

      314    13926    3         END;

PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:46   
      315    13927    2      END ;                        /* Then do                            */

  13927  4 000461   000474 710000 4                  TRA     s:13932

      316    13928    1   ELSE                            /* No it wasn't                       */
      317    13929    1      IF CREATE

  13929  4 000462   200003 234100                    SZN     CREATE,,AUTO
         4 000463   000470 605000 4                  TPL     s:13931

      318    13930    1      THEN SNAME = 'LOCAL';

  13930  4 000464   040100 100400                    MLR     fill='040'O
         4 000465   000013 000005 3                  ADSC9   11                       cn=0,n=5
         4 000466   202005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000467   000474 710000 4                  TRA     s:13932

      319    13931    1      ELSE SNAME = KL$DREC.SNAME ;

  13931  4 000470   202027 471500                    LDP1    DREC$,,AUTO
         4 000471   040100 100500                    MLR     fill='040'O
         4 000472   100015 000010                    ADSC9   13,,PR1                  cn=0,n=8
         4 000473   202005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8

      320    13932    2   IF SNAME = ' *NOTRM*' THEN DO;

  13932  4 000474   040000 106500                    CMPC    fill='040'O
         4 000475   202005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000476   000007 000010 3                  ADSC9   7                        cn=0,n=8
         4 000477   000504 601000 4                  TNZ     s:13937

      321    13933    2      TWSN_INDEX = 0;

  13933  4 000500   202011 450100                    STZ     TWSN_INDEX,,AUTO

      322    13934    2      TWSNR$ = ADDR(TWSN_REC);

PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:47   
  13934  4 000501   202035 630500                    EPPR0   TWSN_REC,,AUTO
         4 000502   202031 450500                    STP0    TWSNR$,,AUTO

      323    13935    2      END;

  13935  4 000503   000637 710000 4                  TRA     s:14001

      324    13936    2   ELSE DO;

      325    13937    2      CALL CONCAT( USERS_KEY.TXTC, SNAME, 'STATION' );

  13937  4 000504   040000 100500                    MLR     fill='040'O
         4 000505   202005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000506   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 000507   040000 100400                    MLR     fill='040'O
         4 000510   000015 000007 3                  ADSC9   13                       cn=0,n=7
         4 000511   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      326    13938    2      USERS_KEY.COUNT = 15;

  13938  4 000512   017000 236003                    LDQ     7680,DU
         4 000513   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      327    13939                                                /* Pick up terminal record            */
      328    13940    2      TREC$ = DSEG1$ ;

  13940  4 000514   000000 236000 xsym               LDQ     DSEG1$
         4 000515   202026 756100                    STQ     TREC$,,AUTO

      329    13941    2      ARS = DSEG1SIZE ;

  13941  4 000516   000000 235000 xsym               LDA     DSEG1SIZE
         4 000517   202014 755100                    STA     ARS,,AUTO

      330    13942    2      CALL ASB$READ_HLP( TREC$, ARS )

  13942  4 000520   202014 630500                    EPPR0   ARS,,AUTO
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:48   
         4 000521   202057 450500                    STP0    TWSN_REC+18,,AUTO
         4 000522   202026 631500                    EPPR1   TREC$,,AUTO
         4 000523   202056 451500                    STP1    TWSN_REC+17,,AUTO
         4 000524   202056 630500                    EPPR0   TWSN_REC+17,,AUTO
         4 000525   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000526   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000527   000531 702000 4                  TSX2    s:13944
         4 000530   000541 710000 4                  TRA     s:13964

      331    13943    3      WHENALTRETURN DO;

      332    13944    3         AS_FIELD1 = USERS_KEY;

  13944  4 000531   000000 100400                    MLR     fill='000'O
         4 000532   000000 000051 xsym               ADSC9   USERS_KEY                cn=0,n=41
         4 000533   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      333    13945              %SCREAM( ERR#=E$TERMINAL_NOEXIST, MID='A', LEVEL=ERROR ) ;

  13957  4 000534   000016 630400 5                  EPPR0   14
         4 000535   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000536   000000 701000 xent               TSX1    ASH$ERROR
         4 000537   000000 011000                    NOP     0

      334    13960    3         RETURN ;

  13960  4 000540   000000 702200 xent               TSX2  ! X66_ARET

      335    13961    3         END; /*  Whenaltreturn  */
      336    13962                                                                    /**/
      337    13963                                                /* Get twsn number                    */
      338    13964    2      TWSNC = KL$TREC.TWSN# ;

  13964  4 000541   202026 470500                    LDP0    TREC$,,AUTO
         4 000542   000001 236100                    LDQ     1,,PR0
         4 000543   202007 756100                    STQ     TWSNC,,AUTO

PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:49   
      339    13965    2      CALL CHARBIN( TWSN#, TWSNC ) ;

  13965  4 000544   000100 305500                    DTB
         4 000545   202007 030004                    NDSC9   TWSNC,,AUTO              cn=0,s=nosgn,sf=0,n=4
         4 000546   202056 000010                    NDSC9   TWSN_REC+17,,AUTO        cn=0,s=lsgnf,sf=0,n=8
         4 000547   202057 235100                    LDA     TWSN_REC+18,,AUTO
         4 000550   202010 755100                    STA     TWSN#,,AUTO

      340    13966                                                /* Pick up twsn record                */
      341    13967    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;

  13967  4 000551   040000 100400                    MLR     fill='040'O
         4 000552   000020 000004 3                  ADSC9   16                       cn=0,n=4
         4 000553   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 000554   040000 100500                    MLR     fill='040'O
         4 000555   202007 000004                    ADSC9   TWSNC,,AUTO              cn=0,n=4
         4 000556   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      342    13968    2      USERS_KEY.COUNT = 8 ;

  13968  4 000557   010000 236003                    LDQ     4096,DU
         4 000560   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      343    13969    2      TWSNR$ = DSEG2$ ;

  13969  4 000561   000000 236000 xsym               LDQ     DSEG2$
         4 000562   202031 756100                    STQ     TWSNR$,,AUTO

      344    13970    2      TWSN_ARS = DSEG2SIZE ;

  13970  4 000563   000000 235000 xsym               LDA     DSEG2SIZE
         4 000564   202013 755100                    STA     TWSN_ARS,,AUTO

      345    13971    2      CALL ASB$ENQ_HLP ALTRET( ENQ_ERR2 ) ;

  13971  4 000565   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000566   000000 701000 xent               TSX1    ASB$ENQ_HLP
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:50   
         4 000567   000775 702000 4                  TSX2    ENQ_ERR2

      346    13972    2      CALL ASB$READ_HLP( TWSNR$, TWSN_ARS )

  13972  4 000570   202013 630500                    EPPR0   TWSN_ARS,,AUTO
         4 000571   202057 450500                    STP0    TWSN_REC+18,,AUTO
         4 000572   202031 631500                    EPPR1   TWSNR$,,AUTO
         4 000573   202056 451500                    STP1    TWSN_REC+17,,AUTO
         4 000574   202056 630500                    EPPR0   TWSN_REC+17,,AUTO
         4 000575   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000576   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000577   000601 702000 4                  TSX2    s:13974
         4 000600   000611 710000 4                  TRA     s:13994

      347    13973    3      WHENALTRETURN DO;

      348    13974    3         AS_FIELD1 = USERS_KEY ;

  13974  4 000601   000000 100400                    MLR     fill='000'O
         4 000602   000000 000051 xsym               ADSC9   USERS_KEY                cn=0,n=41
         4 000603   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      349    13975              %SCREAM( ERR#=E$TERM_NO_EXIST, LEVEL=ERROR, MID='A' ) ;

  13987  4 000604   000017 630400 5                  EPPR0   15
         4 000605   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000606   000000 701000 xent               TSX1    ASH$ERROR
         4 000607   000000 011000                    NOP     0

      350    13990    3         RETURN ;

  13990  4 000610   000000 702200 xent               TSX2  ! X66_ARET

      351    13991    3         END; /*  Whenaltreturn  */
      352    13992                                                                    /**/
      353    13993                                                /* Get twsn record index for device */
      354    13994    2      IF CREATE THEN
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:51   

  13994  4 000611   200003 234100                    SZN     CREATE,,AUTO
         4 000612   000617 605000 4                  TPL     s:13997

      355    13995    2         TWSN_INDEX = KL$TWSNREC.NDEV ;

  13995  4 000613   202031 470500                    LDP0    TWSNR$,,AUTO
         4 000614   000004 235100                    LDA     4,,PR0
         4 000615   202011 755100                    STA     TWSN_INDEX,,AUTO
         4 000616   000637 710000 4                  TRA     s:14001

      356    13996    2      ELSE
      357    13997    2         CALL ASB$FIND_TWSN_INDEX( TREC$, DREC$, TWSNR$, AS_FALSE, DEV_KEY.TXT.ACCT,
             13997                  TWSN_INDEX ) ALTRET(EXIT#) ;

  13997  4 000617   202011 630500                    EPPR0   TWSN_INDEX,,AUTO
         4 000620   202063 450500                    STP0    TWSN_REC+22,,AUTO
         4 000621   000020 236000 5                  LDQ     16
         4 000622   202062 756100                    STQ     TWSN_REC+21,,AUTO
         4 000623   000021 236000 5                  LDQ     17
         4 000624   202061 756100                    STQ     TWSN_REC+20,,AUTO
         4 000625   202031 631500                    EPPR1   TWSNR$,,AUTO
         4 000626   202060 451500                    STP1    TWSN_REC+19,,AUTO
         4 000627   202027 633500                    EPPR3   DREC$,,AUTO
         4 000630   202057 453500                    STP3    TWSN_REC+18,,AUTO
         4 000631   202026 634500                    EPPR4   TREC$,,AUTO
         4 000632   202056 454500                    STP4    TWSN_REC+17,,AUTO
         4 000633   202056 630500                    EPPR0   TWSN_REC+17,,AUTO
         4 000634   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 000635   000000 701000 xent               TSX1    ASB$FIND_TWSN_INDEX
         4 000636   000775 702000 4                  TSX2    ENQ_ERR2

      358    13998    2      END;

      359    13999
      360    14000                                                /* Do options                         */
      361    14001    1   FROM_KEY.TEXT = DEV_KEY.TXT.ACCT ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:52   

  14001  4 000637   040000 100400                    MLR     fill='040'O
         4 000640   000000 200010 2                  ADSC9   DEV_KEY                  cn=1,n=8
         4 000641   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20

      362    14002    1   CALL ASA$DEV_OPTS(DREC$, TWSNR$, TWSNC, CREATE, '0'B, '    ', TWSN_INDEX)

  14002  4 000642   202011 630500                    EPPR0   TWSN_INDEX,,AUTO
         4 000643   202064 450500                    STP0    TWSN_REC+23,,AUTO
         4 000644   000022 237000 5                  LDAQ    18
         4 000645   202062 757100                    STAQ    TWSN_REC+21,,AUTO
         4 000646   200003 631500                    EPPR1   CREATE,,AUTO
         4 000647   202061 451500                    STP1    TWSN_REC+20,,AUTO
         4 000650   202007 633500                    EPPR3   TWSNC,,AUTO
         4 000651   202060 453500                    STP3    TWSN_REC+19,,AUTO
         4 000652   202031 634500                    EPPR4   TWSNR$,,AUTO
         4 000653   202057 454500                    STP4    TWSN_REC+18,,AUTO
         4 000654   202027 635500                    EPPR5   DREC$,,AUTO
         4 000655   202056 455500                    STP5    TWSN_REC+17,,AUTO
         4 000656   202056 630500                    EPPR0   TWSN_REC+17,,AUTO
         4 000657   000025 631400 xsym               EPPR1   B_VECTNIL+21
         4 000660   000000 701000 xent               TSX1    ASA$DEV_OPTS
         4 000661   000775 702000 4                  TSX2    ENQ_ERR2

      363    14003    2   WHENRETURN DO;

      364    14004    2      IF KL$DREC.SUPER = 5 /* INSYM DEVICE */ OR KL$DREC.SUPER = 6 /* OUTSYM DEVICE */

  14004  4 000662   202027 470500                    LDP0    DREC$,,AUTO
         4 000663   000000 236100                    LDQ     0,,PR0
         4 000664   000777 376007                    ANQ     511,DL
         4 000665   000005 116007                    CMPQ    5,DL
         4 000666   000673 600000 4                  TZE     s:14006
         4 000667   000006 116007                    CMPQ    6,DL
         4 000670   000673 600000 4                  TZE     s:14006
         4 000671   000014 116007                    CMPQ    12,DL
         4 000672   000733 601000 4                  TNZ     s:14017
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:53   

      365    14005    3           OR KL$DREC.SUPER = 12 /* RES DEVICE */ THEN DO ;

      366    14006    4         IF CREATE THEN DO ;

  14006  4 000673   200003 234100                    SZN     CREATE,,AUTO
         4 000674   000704 605000 4                  TPL     s:14011

      367    14007    4            KL$TWSNREC.NDEV = TWSN_INDEX + 1 ;

  14007  4 000675   202031 471500                    LDP1    TWSNR$,,AUTO
         4 000676   202011 235100                    LDA     TWSN_INDEX,,AUTO
         4 000677   000001 035007                    ADLA    1,DL
         4 000700   100004 755100                    STA     4,,PR1

      368    14008    4            TWSN_ARS = TWSN_ARS + LENGTHC(KL$TWSNREC.DEVS(0)) ;

  14008  4 000701   202013 235100                    LDA     TWSN_ARS,,AUTO
         4 000702   000054 035007                    ADLA    44,DL
         4 000703   202013 755100                    STA     TWSN_ARS,,AUTO

      369    14009    4            END ;

      370    14010                                                /* Write twsn record                 */
      371    14011    3         CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;

  14011  4 000704   040000 100400                    MLR     fill='040'O
         4 000705   000020 000004 3                  ADSC9   16                       cn=0,n=4
         4 000706   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 000707   040000 100500                    MLR     fill='040'O
         4 000710   202007 000004                    ADSC9   TWSNC,,AUTO              cn=0,n=4
         4 000711   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      372    14012    3         USERS_KEY.COUNT = 8 ;

  14012  4 000712   010000 236003                    LDQ     4096,DU
         4 000713   000000 552040 xsym               STBQ    USERS_KEY,'40'O
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:54   

      373    14013    3         CALL ASB$WRITE_HLP( TWSNR$, TWSN_ARS ) ALTRET( WRITE_TWSNR_ERR ) ;

  14013  4 000714   202013 630500                    EPPR0   TWSN_ARS,,AUTO
         4 000715   202057 450500                    STP0    TWSN_REC+18,,AUTO
         4 000716   202031 631500                    EPPR1   TWSNR$,,AUTO
         4 000717   202056 451500                    STP1    TWSN_REC+17,,AUTO
         4 000720   202056 630500                    EPPR0   TWSN_REC+17,,AUTO
         4 000721   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000722   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 000723   000776 702000 4                  TSX2    WRITE_TWSNR_ERR

      374    14014    3         IF CREATE THEN KL$DREC.SNAME = SNAME ;

  14014  4 000724   200003 234100                    SZN     CREATE,,AUTO
         4 000725   000740 605000 4                  TPL     WRITE_DEV_REC

  14014  4 000726   202027 470500                    LDP0    DREC$,,AUTO
         4 000727   040100 100500                    MLR     fill='040'O
         4 000730   202005 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000731   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8

      375    14015    3         END;

  14015  4 000732   000740 710000 4                  TRA     WRITE_DEV_REC

      376    14016    2      ELSE
      377    14017    2         IF CREATE THEN KL$DREC.SNAME = ' *NOTRM*';

  14017  4 000733   200003 234100                    SZN     CREATE,,AUTO
         4 000734   000740 605000 4                  TPL     WRITE_DEV_REC

  14017  4 000735   040100 100400                    MLR     fill='040'O
         4 000736   000007 000010 3                  ADSC9   7                        cn=0,n=8
         4 000737   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8

  14013  4 000740                       WRITE_DEV_R* null
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:55   
      378    14018    2   WRITE_DEV_REC: ;
      379    14019                                                                                    /**/
      380    14020    2      DEV_ARS = LENGTHC( KL_DREC_CNT ) + KL$DREC.NWINFO*4 ;

  14020  4 000740   202027 470500                    LDP0    DREC$,,AUTO
         4 000741   000017 235100                    LDA     15,,PR0
         4 000742   000002 735000                    ALS     2
         4 000743   000100 035007                    ADLA    64,DL
         4 000744   202012 755100                    STA     DEV_ARS,,AUTO

      381    14021    2      USERS_KEY = DEV_KEY ;

  14021  4 000745   000000 100400                    MLR     fill='000'O
         4 000746   000000 000025 2                  ADSC9   DEV_KEY                  cn=0,n=21
         4 000747   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      382    14022    2      CALL ASB$ENQ_HLP ALTRET( ENQ_ERR2 ) ;

  14022  4 000750   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000751   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 000752   000775 702000 4                  TSX2    ENQ_ERR2

      383    14023    2      CALL ASB$WRITE_HLP( DREC$, DEV_ARS ) ALTRET( WRITE_TWSNR_ERR ) ;

  14023  4 000753   202012 630500                    EPPR0   DEV_ARS,,AUTO
         4 000754   202057 450500                    STP0    TWSN_REC+18,,AUTO
         4 000755   202027 631500                    EPPR1   DREC$,,AUTO
         4 000756   202056 451500                    STP1    TWSN_REC+17,,AUTO
         4 000757   202056 630500                    EPPR0   TWSN_REC+17,,AUTO
         4 000760   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000761   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 000762   000776 702000 4                  TSX2    WRITE_TWSNR_ERR

      384    14024    2      CALL ASB$DEQ_HLP ALTRET( DEQ_ERR2 ) ;

  14024  4 000763   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000764   000000 701000 xent               TSX1    ASB$DEQ_HLP
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:56   
         4 000765   000775 702000 4                  TSX2    ENQ_ERR2

      385    14025                                                                                    /**/
      386    14026    2      IF CREATE THEN

  14026  4 000766   200003 234100                    SZN     CREATE,,AUTO
         4 000767   000774 605000 4                  TPL     s:14029

      387    14027    2         CALL ASB$WRITE_LO( AS_CREATED_TEXT, LENGTHC(AS_CREATED_TEXT) ) ;

  14027  4 000770   000025 630400 5                  EPPR0   21
         4 000771   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000772   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 000773   000000 011000                    NOP     0

      388    14028
      389    14029    2      RETURN ;

  14029  4 000774   000000 702200 xent               TSX2  ! X66_ARET

  14022  4 000775                       ENQ_ERR2     null
  14022  4 000775                       DEQ_ERR2     null
  14022  4 000775                       EXIT#        null
      390    14030    2      END; /* Whenreturn */
      391    14031
      392    14032                                                /* Errors                             */
      393    14033    1   ENQ_ERR2: ;
      394    14034
      395    14035    1   DEQ_ERR2: ;
      396    14036    1   EXIT#: ;
      397    14037                                                                                    /**/
      398    14038    1   RETURN ;

  14038  4 000775   000000 702200 xent               TSX2  ! X66_ARET

      399    14039                                                                                    /**/
      400    14040    1   WRITE_TWSNR_ERR: ;
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:57   

  14040  4 000776                       WRITE_TWSNR* null
      401    14041    1   CALL ASH$ERROR( ERR_CODE ) ;

  14041  4 000776   000027 630400 5                  EPPR0   23
         4 000777   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001000   000000 701000 xent               TSX1    ASH$ERROR
         4 001001   000000 011000                    NOP     0

      402    14042    1   RETURN ;

  14042  4 001002   000000 702200 xent               TSX2  ! X66_ARET
      403    14043                                                                                    /**/
      404    14044                                                                                    /**/
      405    14045    1   END   ASA$DEVICE ;
      406    14046        %EOD;

PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:58   
--  Include file information  --

   KC$CGBLK.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$DEVICE.
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:59   

 **** Variables and constants ****

  ****  Section 002  Data  ASA$DEVICE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(189)   r     1 DEV_KEY

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  2016-0-0/w CHAR(8)     r     1 ACCT                    2014-0-0/w UBIN        r     1 ARS
  2025-0-0/w PTR         r     1 BLK$                       3-0-0/w BIT         r     1 CREATE
  2012-0-0/w UBIN        r     1 DEV_ARS                 2032-0-0/c STRC(81)    r     1 DEV_NAME
  2027-0-0/w PTR         r     1 DREC$                   2015-0-0/w UBIN        r     1 I
     5-0-0/c CHAR(4096)  r     1 KLDREC                  2005-0-0/c CHAR(8)     r     1 SNAME
  2023-0-0/w UBIN        r     1 SUBNODES                2026-0-0/w PTR         r     1 TREC$
  2010-0-0/w UBIN        r     1 TWSN#                   2007-0-0/c CHAR(4)     r     1 TWSNC
  2031-0-0/w PTR         r     1 TWSNR$                  2013-0-0/w UBIN        r     1 TWSN_ARS
  2011-0-0/w UBIN        r     1 TWSN_INDEX              2035-0-0/w STRC(576)   r     1 TWSN_REC
  2020-0-0/w CHAR(12)    r     1 UNAME                   2024-0-0/w UBIN        r     1 UNAME_LEN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/c CHAR(20)    r     1 AS_CREATED_TEXT
     0-0-0/b BIT         r     1 AS_FALSE                   0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/w STRC(369)   r     1 AS_FIELD2                  0-0-0/w STRC(369)   r     1 AS_FIELD3
     0-0-0/b BIT         r     1 AS_TRUE                    0-0-0/w UBIN        r     1 DEVICE_CMD
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/w UBIN        r     1 DSEG2SIZE
     0-0-0/w PTR         r     1 DSEG3$                     0-0-0/b BIT         r     1 DSEG_FLG
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:60   
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/c STRC(189)   r     1 FROM_KEY
     0-0-0/w STRC(576)   r     1 KL_DREC_CNT                0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/w UBIN        r     1 TP_DEVICE_CMD
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1008)  r     1 KL$DREC                    0-0-0/w STRC(576)   r     1 KL$TREC
     0-0-0/w STRC(576)   r     1 KL$TWSNREC                 0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 P$NODE                     0-0-0/w STRC(108)   r     1 TP_DEV


   Procedure ASA$DEVICE requires 515 words for executable code.
   Procedure ASA$DEVICE requires 1078 words of local(AUTO) storage.
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:61   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:62   
          MINI XREF LISTING

ACCT
     13144**DCL     13717<<ASSIGN  13718>>ASSIGN  13791>>CALLBLT
ARS
     13139**DCL     13795<<ASSIGN  13797<>CALL    13800<>CALL    13824>>ASSIGN  13941<<ASSIGN  13942<>CALL
ASA$DEV_OPTS
     13205**DCL-ENT 14002--CALL
ASA_BRKS_LOC
     10033**DCL     10033--REDEF
ASB$CHECK_TYPE
     13235**DCL-ENT 13800--CALL
ASB$DEQ_HLP
     13214**DCL-ENT 14024--CALL
ASB$ENQ_HLP
     13211**DCL-ENT 13796--CALL    13971--CALL    14022--CALL
ASB$FIND_TWSN_INDEX
     13208**DCL-ENT 13997--CALL
ASB$GETSEG
     13223**DCL-ENT 13617--CALL
ASB$READ_HLP
     13217**DCL-ENT 13797--CALL    13942--CALL    13972--CALL
ASB$WRITE_HLP
     13220**DCL-ENT 14013--CALL    14023--CALL
ASB$WRITE_LO
     13232**DCL-ENT 14027--CALL
ASH$ERROR
     13226**DCL-ENT 13631--CALL    13669--CALL    13705--CALL    13776--CALL    13819--CALL    13844--CALL
     13871--CALL    13957--CALL    13987--CALL    14041--CALL
ASH$WARN
     13229**DCL-ENT 13748--CALL    13893--CALL    13919--CALL
AS_BLANK
      9893**DCL     13904>>CALLBLT
AS_CREATED_TEXT
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:63   
      9907**DCL     14027<>CALL    14027--CALL
AS_DEFAULT.BANNER_PERM
     10726**DCL     10727--REDEF
AS_DEFAULT.BUDGET.MACCT
     10631**DCL     10635--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10644**DCL     10647--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10627**DCL     10629--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10622**DCL     10624--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10742**DCL     10743--REDEF   10744--REDEF
AS_DEFAULT_DREC.PASSWORD
     11996**DCL     12000--REDEF
AS_DEFAULT_DREC.RENAME
     12019**DCL     12020--REDEF
AS_DFLT.BANNER_PERM
     10548**DCL     10549--REDEF
AS_DFLT.BUDGET.MACCT
     10453**DCL     10457--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10466**DCL     10469--REDEF
AS_DFLT.BUDGET.PACCUM
     10449**DCL     10451--REDEF
AS_DFLT.BUDGET.PMAXC
     10444**DCL     10446--REDEF
AS_DFLT.SETUP_CHRA.TXT
     10564**DCL     10565--REDEF   10566--REDEF
AS_FALSE
      9893**DCL     13648>>ASSIGN  13715>>ASSIGN  13997<>CALL
AS_FE_MODE
      9899**DCL      9900--REDEF
AS_FIELD1
     10029**DCL     13806<<ASSIGN  13903<<ASSIGN  13944<<ASSIGN  13974<<ASSIGN
AS_FIELD2.COUNT
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:64   
     10030**DCL     13905<<ASSIGN
AS_FIELD2.TEXT
     10030**DCL     13906<<ASSIGN
AS_FIELD3.COUNT
     10031**DCL     13907<<ASSIGN
AS_FIELD3.TEXT
     10031**DCL     13908<<ASSIGN
AS_MODE
      9896**DCL      9898--REDEF
AS_MOD_USER.ACCESS
     12761**DCL     12762--REDEF
AS_MOD_USER.BANNER
     12748**DCL     12749--REDEF
AS_MOD_USER.BANNER_PERM
     12750**DCL     12751--REDEF
AS_MOD_USER.BILL
     12756**DCL     12757--REDEF
AS_MOD_USER.CPROC
     12752**DCL     12753--REDEF
AS_MOD_USER.FEBILL
     12832**DCL     12833--REDEF
AS_MOD_USER.FECXTMEM
     12849**DCL     12850--REDEF
AS_MOD_USER.FEMINTS
     12834**DCL     12835--REDEF
AS_MOD_USER.FEMMEM
     12845**DCL     12846--REDEF
AS_MOD_USER.FEMTIME
     12843**DCL     12844--REDEF
AS_MOD_USER.FEPPRIV
     12840**DCL     12842--REDEF
AS_MOD_USER.FEPRIV
     12837**DCL     12839--REDEF
AS_MOD_USER.FORCE_BIT
     12746**DCL     12747--REDEF
AS_MOD_USER.KEY
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:65   
     12828**DCL     12830--REDEF
AS_MOD_USER.LASTCPROC
     12754**DCL     12755--REDEF
AS_MOD_USER.LIMITS.DO_
     12802**DCL     12803--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12818**DCL     12819--REDEF
AS_MOD_USER.LIMITS.LO
     12798**DCL     12799--REDEF
AS_MOD_USER.LIMITS.MEM
     12794**DCL     12795--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12822**DCL     12823--REDEF
AS_MOD_USER.LIMITS.PDIS
     12810**DCL     12811--REDEF
AS_MOD_USER.LIMITS.PO
     12806**DCL     12807--REDEF
AS_MOD_USER.LIMITS.TDIS
     12814**DCL     12815--REDEF
AS_MOD_USER.LIMITS.TIME
     12790**DCL     12791--REDEF
AS_MOD_USER.MAXENQ
     12771**DCL     12772--REDEF
AS_MOD_USER.PERM_BIT
     12744**DCL     12745--REDEF
AS_MOD_USER.PPRIV
     12766**DCL     12768--REDEF
AS_MOD_USER.PRIOB
     12773**DCL     12774--REDEF
AS_MOD_USER.PRIV
     12763**DCL     12765--REDEF
AS_MOD_USER.QUAN
     12769**DCL     12770--REDEF
AS_MOD_USER.SETUP
     12742**DCL     12743--REDEF
AS_PROJECT.BANNER_PERM
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:66   
     11082**DCL     11083--REDEF
AS_PROJECT.BUDGET.MACCT
     10987**DCL     10991--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     11000**DCL     11003--REDEF
AS_PROJECT.BUDGET.PACCUM
     10983**DCL     10985--REDEF
AS_PROJECT.BUDGET.PMAXC
     10978**DCL     10980--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11098**DCL     11099--REDEF   11100--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11260**DCL     11261--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11165**DCL     11169--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11178**DCL     11181--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11161**DCL     11163--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11156**DCL     11158--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11276**DCL     11277--REDEF   11278--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12482**DCL     12486--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12505**DCL     12506--REDEF
AS_PROJECT_DREC.PASSWORD
     12320**DCL     12324--REDEF
AS_PROJECT_DREC.RENAME
     12343**DCL     12344--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10904**DCL     10905--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10809**DCL     10813--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:67   
     10822**DCL     10825--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     10805**DCL     10807--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10800**DCL     10802--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10920**DCL     10921--REDEF   10922--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12158**DCL     12162--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12181**DCL     12182--REDEF
AS_TRUE
      9893**DCL     13646>>ASSIGN  13713>>ASSIGN  13847>>ASSIGN
AS_USERS.BANNER_PERM
     10370**DCL     10371--REDEF
AS_USERS.BUDGET.MACCT
     10275**DCL     10279--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10288**DCL     10291--REDEF
AS_USERS.BUDGET.PACCUM
     10271**DCL     10273--REDEF
AS_USERS.BUDGET.PMAXC
     10266**DCL     10268--REDEF
AS_USERS.SETUP_CHRA.TXT
     10386**DCL     10387--REDEF   10388--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11438**DCL     11439--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11343**DCL     11347--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11356**DCL     11359--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11339**DCL     11341--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11334**DCL     11336--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:68   
     11454**DCL     11455--REDEF   11456--REDEF
BLK$
     13148**DCL     13296--IMP-PTR 13651<<ASSIGN  13652>>IF      13674>>ASSIGN  13675>>ASSIGN  13675>>ASSIGN
     13855<<ASSIGN  13856>>IF      13876>>ASSIGN  13876>>ASSIGN  13907>>ASSIGN  13908>>ASSIGN  13908>>ASSIGN
CREATE
     13130**DCL     13646<<ASSIGN  13648<<ASSIGN  13713<<ASSIGN  13715<<ASSIGN  13800<>CALL    13801>>IF
     13828>>IF      13847<<ASSIGN  13877>>IF      13929>>IF      13994>>IF      14002<>CALL    14006>>IF
     14014>>IF      14017>>IF      14026>>IF
DEQ_ERR2
     14022**LABEL   14024--CALLALT
DEVICE_CMD
     13186**DCL     13638--ASSIGN
DEV_ARS
     13137**DCL     13824<<ASSIGN  14020<<ASSIGN  14023<>CALL
DEV_KEY
     13193**DCL     13680>>ASSIGN  14021>>ASSIGN
DEV_KEY.CNT
     13194**DCL     13678<<ASSIGN  13720<<ASSIGN  13729<<ASSIGN  13787<<ASSIGN  13790>>ASSIGN
DEV_KEY.TXT.ACCT
     13196**DCL     13677<<ASSIGN  13718<<ASSIGN  13997<>CALL    14001>>ASSIGN
DEV_KEY.TXT.UNAME
     13197**DCL     13676<<ASSIGN  13719<<ASSIGN  13782<<ASSIGN
DEV_NAME
     13153**DCL     13792<<ASSIGN  13800<>CALL    13806>>ASSIGN  13903>>ASSIGN
DEV_NAME.COUNT
     13154**DCL     13674<<ASSIGN
DEV_NAME.TEXT
     13155**DCL     13675<<ASSIGN  13677>>ASSIGN
DREC$
     13150**DCL     13453--IMP-PTR 13794<<ASSIGN  13797<>CALL    13800<>CALL    13877>>IF      13878>>IF
     13904>>CALLBLT 13906>>ASSIGN  13925>>ASSIGN  13931>>ASSIGN  13997<>CALL    14002<>CALL    14004>>IF
     14004>>IF      14004>>IF      14014>>ASSIGN  14017>>ASSIGN  14020>>ASSIGN  14023<>CALL
DSEG1$
     10034**DCL     13940>>ASSIGN
DSEG1SIZE
     10035**DCL     13941>>ASSIGN
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:69   
DSEG2$
     10035**DCL     13969>>ASSIGN
DSEG2SIZE
     10035**DCL     13970>>ASSIGN
DSEG3$
     10035**DCL     13141--IMP-PTR 13641>>ASSIGN  13716>>ASSIGN  13726>>ASSIGN  13781>>ASSIGN
DSEG_FLG
     10034**DCL     13615>>IF
ENQ_ERR2
     14022**LABEL   13796--CALLALT 13971--CALLALT 14022--CALLALT
ERR_CODE
     10028**DCL     10029--REDEF   14041<>CALL
EXIT#
     14022**LABEL   13800--CALLALT 13997--CALLALT
FROM_KEY.TEXT
      9907**DCL     14001<<ASSIGN
I
     13140**DCL     13904<<CALLBLT 13905>>ASSIGN
KL$DREC.NWINFO
     13551**DCL     14020>>ASSIGN
KL$DREC.PASSWORD
     13511**DCL     13515--REDEF
KL$DREC.RENAME
     13534**DCL     13535--REDEF
KL$DREC.SNAME
     13548**DCL     13877>>IF      13878>>IF      13904>>CALLBLT 13906>>ASSIGN  13925>>ASSIGN  13931>>ASSIGN
     14014<<ASSIGN  14017<<ASSIGN
KL$DREC.SUPER
     13505**DCL     14004>>IF      14004>>IF      14004>>IF
KL$TREC.PASSWORD
     13398**DCL     13402--REDEF
KL$TREC.RENAME
     13421**DCL     13422--REDEF
KL$TREC.TWSN#
     13395**DCL     13964>>ASSIGN
KL$TWSNREC.DEVS
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:70   
     13587**DCL     14008--ASSIGN
KL$TWSNREC.NDEV
     13586**DCL     13995>>ASSIGN  14007<<ASSIGN
KLDREC
     13132**DCL     13794--ASSIGN  13795--ASSIGN
KL_DEFAULT.PASSWORD
     12644**DCL     12648--REDEF
KL_DEFAULT.RENAME
     12667**DCL     12668--REDEF
KL_DFLT.PASSWORD
     11834**DCL     11838--REDEF
KL_DFLT.RENAME
     11857**DCL     11858--REDEF
KL_DREC.PASSWORD
     11672**DCL     11676--REDEF
KL_DREC.RENAME
     11695**DCL     11696--REDEF
KL_DREC_CNT
     11501**DCL     14020--ASSIGN
KL_DREC_CNT.PASSWORD
     11559**DCL     11563--REDEF
KL_DREC_CNT.RENAME
     11582**DCL     11583--REDEF
NODE$
     10026**DCL     13249--IMP-PTR 13643<<ASSIGN  13644>>IF      13651>>ASSIGN  13710<<ASSIGN  13711>>IF
     13717>>ASSIGN  13717>>ASSIGN  13721>>IF      13723>>IF      13727>>ASSIGN  13727>>ASSIGN  13728>>ASSIGN
     13852>>IF      13855>>ASSIGN
OUT$SYM.COUNT
     13319**DCL     13322--IMP-SIZ 13652>>IF      13674>>ASSIGN  13675>>ASSIGN  13717>>ASSIGN  13727>>ASSIGN
     13728>>ASSIGN  13856>>IF      13876>>ASSIGN  13907>>ASSIGN  13908>>ASSIGN
OUT$SYM.TEXT
     13322**DCL     13675>>ASSIGN  13717>>ASSIGN  13727>>ASSIGN  13876>>ASSIGN  13908>>ASSIGN
P$NODE.CODE
     13257**DCL     13644>>IF      13711>>IF      13723>>IF
P$NODE.SUBLK$
     13282**DCL     13651>>ASSIGN  13651>>ASSIGN  13717>>ASSIGN  13717>>ASSIGN  13717>>ASSIGN  13717>>ASSIGN
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:71   
     13723>>IF      13727>>ASSIGN  13727>>ASSIGN  13727>>ASSIGN  13727>>ASSIGN  13728>>ASSIGN  13728>>ASSIGN
     13855>>ASSIGN  13855>>ASSIGN
P$NODE.SUBNODES
     13261**DCL     13721>>IF      13852>>IF
PROJ_KEY.TEXT
      9906**DCL      9906--REDEF
PROJ_KEY.TXT.PROJECT
      9906**DCL      9906--REDEF
P_PCB
     10061**DCL     13639<>CALL    13703<>CALL
P_PCB.ERROR
     10165**DCL     13705<>CALL
P_PCB.OUT$
     10074**DCL     13643>>ASSIGN  13710>>ASSIGN
P_PCB.ROOT$
     10066**DCL     13638<<ASSIGN  13702<<ASSIGN
REMEM_VAR
     10032**DCL     10032--REDEF
REM_FCMD
     10032**DCL     10033--REDEF
SNAME
     13133**DCL     13876<<ASSIGN  13877>>IF      13925<<ASSIGN  13930<<ASSIGN  13931<<ASSIGN  13932>>IF
     13937>>CALLBLT 14014>>ASSIGN
SUBNODES
     13146**DCL     13679<<ASSIGN  13709<<ASSIGN  13725<<ASSIGN  13852>>IF      13855>>ASSIGN
TP_DEV.DEV_TYPE
     13142**DCL     13641<<ASSIGN  13716<<ASSIGN  13726<<ASSIGN
TP_DEV.SNAME
     13143**DCL     13781<<ASSIGN
TP_DEVICE_CMD
     13187**DCL     13702--ASSIGN
TREC$
     13149**DCL     13340--IMP-PTR 13940<<ASSIGN  13942<>CALL    13964>>ASSIGN  13997<>CALL
TWSN#
     13135**DCL     13965<<CALLBLT
TWSNC
PL6.E3A0      #001=ASA$DEVICE File=ASA$DEVICE.:E05TSI                            TUE 07/29/97 08:34 Page:72   
     13134**DCL     13964<<ASSIGN  13965>>CALLBLT 13967>>CALLBLT 14002<>CALL    14011>>CALLBLT
TWSNR$
     13152**DCL     13583--IMP-PTR 13934<<ASSIGN  13969<<ASSIGN  13972<>CALL    13995>>ASSIGN  13997<>CALL
     14002<>CALL    14007>>ASSIGN  14013<>CALL
TWSN_ARS
     13138**DCL     13970<<ASSIGN  13972<>CALL    14008<<ASSIGN  14008>>ASSIGN  14013<>CALL
TWSN_INDEX
     13136**DCL     13933<<ASSIGN  13995<<ASSIGN  13997<>CALL    14002<>CALL    14007>>ASSIGN
TWSN_REC
     13157**DCL     13934--ASSIGN
UNAME
     13145**DCL     13727<<ASSIGN  13755>>IF      13781>>ASSIGN  13782>>ASSIGN  13786<<ASSIGN  13791>>CALLBLT
UNAME_LEN
     13147**DCL     13728<<ASSIGN  13729>>ASSIGN  13730>>IF      13753<<ASSIGN  13785<<ASSIGN
USERS_KEY
      9903**DCL     13680<<ASSIGN  13792>>ASSIGN  13944>>ASSIGN  13974>>ASSIGN  14021<<ASSIGN
USERS_KEY.COUNT
      9903**DCL     13790<<ASSIGN  13938<<ASSIGN  13968<<ASSIGN  14012<<ASSIGN
USERS_KEY.TEXT
      9903**DCL      9904--REDEF    9904--REDEF    9904--REDEF    9905--REDEF
USERS_KEY.TXTC
      9904**DCL     13791<<CALLBLT 13937<<CALLBLT 13967<<CALLBLT 14011<<CALLBLT
WRITE_TWSNR_ERR
     14040**LABEL   14013--CALLALT 14023--CALLALT
X$PARSE
     13203**DCL-ENT 13639--CALL    13703--CALL

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:73   
      407        1        /*T***********************************************************/
      408        2        /*T*                                                         */
      409        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      410        4        /*T*                                                         */
      411        5        /*T***********************************************************/
      412        6        /*P*    NAME:  ASA$DEV_OPTS
      413        7                PURPOSE: This module of SUPER processes the options of the
      414        8                         'CREATE DEVICE' command and the sub-options of
      415        9                         the 'CREATE TERMINAL' command, 'DEVICE' option.
      416       10                         It is called from ASA$DEVICE or ASA$TERMINAL.
      417       11                          The parameters are:
      418       12
      419       13                TREC$    A pointer to the device record (KL$DREC).
      420       14                TWSNR$   A pointer to the TWSN record.
      421       15                TWSNC    The terminal number, in text.
      422       16                CREATE   A bit that signifies if we are creating this device
      423       17                SUB      A bit that signifies that we are being called
      424       18                         from ASA$TERMINAL.
      425       19                TERM_T   The terminal type, used to set the default PROFILE.
      426       20                TWSN_INDEX    The TWSN record index for the device.
      427       21                              Valid only if CREATE=false.
      428       22                SS        A terminal sign-on structure for a terminal device.
      429       23                          Valid only if SUB=true.
      430       24                DADR$    A pointer to the place where the KL_DADR for this
      431       25                         subdevice is supposed to go.
      432       26        Note that this routine DOES NOT write the resulting device record.
      433       27        */
      434       28        ASA$DEV_OPTS: PROC(TREC$,TWSNR$,TWSNC,CREATE,SUB,TERM_T,TWSN_INDEX,SS,DADR$) ALTRET;
      435       29                                                                                    /**/
      436       30        %SET LISTSUB = '1'B ;
      437       31        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:74   
      438       32        /*********************************************************************/
      439       33        /*   Include files   include files   include files   include files   */
      440       34        /*********************************************************************/
      441       35                                                                                    /**/
      442       36        %INCLUDE  AS_ENTRIES_M  ;
      443     1086        %INCLUDE  AS_PERR_C     ;
      444     1688        %INCLUDE  AS_SSUBS_C    ;
      445     1780        %INCLUDE  AS_SUBS_C     ;
      446     3194        %INCLUDE  AS_SUPER_C    ;
      447     3629        %INCLUDE  KL_SUPER_C    ;
      448     6531        %INCLUDE  XU_FORMAT_C   ;
      449     6693        %INCLUDE  XU_MACRO_C    ;
      450     9799        %INCLUDE  AS_MAC_C      ;
      451     9879        %INCLUDE  AS_SUPER_R    ;
      452    12895        %INCLUDE  B_ERRORS_C    ;
      453    14022        %INCLUDE  B_MACROS_C    ;
      454    14133        %INCLUDE  CP_6          ;
      455    14214        %INCLUDE  CP_6_SUBS     ;
      456    14754        %INCLUDE  FI_MAC_C      ;
      457    15124        %INCLUDE  FOO_MAC_C     ;
      458    15872        %INCLUDE  KC$CGBLK      ;
      459    15920        %INCLUDE  QQ_SUPER_C    ;
      460    15975        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:75   
      461    15976        /*********************************************************************/
      462    15977        /*   Parameters      parameters      parameters      paramaters      */
      463    15978        /*********************************************************************/
      464    15979                                                                                    /**/
      465    15980    1   DCL TREC$ PTR ;
      466    15981    1   DCL TWSNR$ PTR ;
      467    15982    1   DCL TWSNC CHAR(4) ;
      468    15983    1   DCL CREATE BIT(1) ALIGNED;
      469    15984    1   DCL SUB BIT(1) ALIGNED;
      470    15985    1   DCL TERM_T CHAR(7) ;
      471    15986    1   DCL TWSN_INDEX SBIN ;
      472    15987        %KL_SS (NAME=SS,STCLASS=PARAM);
      473    16022    1   DCL DADR$  PTR;
      474    16023
      475    16024        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:76   
      476    16025        /*********************************************************************/
      477    16026        /*   Auto data       auto data       auto data       auto data       */
      478    16027        /*********************************************************************/
      479    16028                                                                                    /**/
      480    16029    1   DCL ARS UBIN WORD ;
      481    16030    1   DCL BLK$ PTR ;
      482    16031    1   DCL CG_FLAG BIT(1) ;
      483    16032    1   DCL CNT UBIN WORD ;
      484    16033    1   DCL CODE2 UBIN WORD ;
      485    16034    1   DCL COMMAND CHAR(80);
      486    16035    1   DCL DDEV BIT(9);
      487    16036    1   DCL DEVCTL_SET BIT(1);
      488    16037    1   DCL DEVNUM_SET BIT(1);
      489    16038    1   DCL DEV_USE UBIN;
      490    16039    1   DCL FORM$ PTR;
      491    16040    1   DCL FORM_ARS UBIN WORD;
      492    16041    1   DCL FORM_BUF CHAR(3400);
      493    16042    1   DCL GROUP_FLAG BIT(1) ;
      494    16043    1   DCL HEX(0:255) UBIN BYTE UNAL;
      495    16044    1   DCL I UBIN WORD ;
      496    16045    1   DCL INSTANCE_FLAG BIT(1) ;
      497    16046    1   DCL 1 IO,
      498    16047    1          2 INPUT BIT(1),
      499    16048    1          2 OUTPUT BIT(1);
      500    16049    1   DCL J UBIN WORD ;
      501    16050    1   DCL K UBIN WORD ;
      502    16051    1   DCL L UBIN WORD ;
      503    16052    1   DCL MORE BIT(1) ;
      504    16053    1   DCL NUM CHAR(2) ;
      505    16054    1   DCL 1 OPTION,
      506    16055    1          2 COUNT UBIN BYTE CALIGNED,
      507    16056    1          2 TEXT  CHAR(31)  CALIGNED;
      508    16057    1   DCL PACKSET_NAME CHAR(6);
      509    16058    1   DCL PATTR BIT(18) ;
      510    16059    1   DCL PRO$ PTR ;
      511    16060    1   DCL PRO_BUF CHAR(1024 /* AS_PRO_BUF_SIZEC */);
      512    16061    1   DCL PRO_FLAG BIT(1) ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:77   
      513    16062    1   DCL PTR$ PTR ;
      514    16063    1   DCL P$ PTR;
      515    16064    1   DCL ROOT$ PTR;
      516    16065    1   DCL SNAME_FLG BIT(1) ;
      517    16066    1   DCL 1 SPLIT ,
      518    16067    1          2 * UBIN(1) UNAL ,
      519    16068    1          2 T UBIN(8) UNAL ,
      520    16069    1          2 * UBIN(1) UNAL ,
      521    16070    1          2 B UBIN(8) UNAL ;
      522    16071    1   DCL TEMP   UBIN WORD;
      523    16072    1   DCL TEMP$  PTR;
      524    16073    1   DCL TEMP_TYPE CHAR(4) ;
      525    16074    1   DCL TP_FLAG BIT(1) ;
      526    16075    1   DCL T_NODE$ PTR;
      527    16076    1   DCL WKSZ UBIN;
      528    16077    1   DCL WK_USED UBIN;
      529    16078    1   DCL WORK$ PTR;
      530    16079    1   DCL YES_NO_FLG BIT(1);
      531    16080        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:78   
      532    16081        /*********************************************************************/
      533    16082        /*   Symref's        symref's        symref's        symref's        */
      534    16083        /*********************************************************************/
      535    16084                                                                                    /**/
      536    16085    1   DCL DEVICE_OPTS_LIST SYMREF UBIN WORD ;
      537    16086        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:79   
      538    16087        /*********************************************************************/
      539    16088        /*   Static data     static data     static data     static data     */
      540    16089        /*********************************************************************/
      541    16090                                                                                    /**/
      542    16091    1   DCL DEV_IN_VAL UBIN CONSTANT INIT(1   /*  YES_VAL  */);
      543    16092    1   DCL DEV_OUT_VAL UBIN CONSTANT INIT(2   /*  NO_VAL  */);
      544    16093    1   DCL TYPE STATIC SYMDEF CHAR(2) ;
      545    16094              %KL_DREC( NAME = KL_CREC ,
      546    16095                        STCLASS = CONSTANT ,
      547    16096                        TYP = %KLAT_CG# ,
      548    16097                      RN = '1'B ,
      549    16098                      LAST = ","  );
      550    16211              %KC$CGID ( FPTN = KC$CGID ,
      551    16212                      STCLASS=CONSTANT,
      552    16213                      LVL = 2  ,
      553    16214                      LAST = "," ) ;
      554    16240              %FI_CONINFO(FPTN = ISINFO,
      555    16241                      STCLASS=CONSTANT,
      556    16242                      LVL = 2 ,
      557    16243                      LAST = "," ) ;
      558    16287              %FO_CONINFO (FPTN = OSINFO ,
      559    16288                      STCLASS = CONSTANT,
      560    16289                      LVL = 2 ,
      561    16290                      LAST = "," ) ;
      562    16321              %QQ$LOGON(FPTN = QQ_LOGON,
      563    16322                      STCLASS=CONSTANT,
      564    16323                      LVL = 2 ,
      565    16324                      LAST = "," ) ;
      566    16360              %KL_RES_CL_DEV (NAME = RES_DEV,
      567    16361                              STCLASS = CONSTANT,
      568    16362                              LAST=",",
      569    16363                              LVL= 2);
      570    16423              %B$CGAUINFO(FPTN = B_CGAUINFO,
      571    16424                          STCLASS=CONSTANT,
      572    16425                          LVL = 2 ) ;
      573    16445        %KL_DADR ( NAME = KL_DADR ,
      574    16446                   STCLASS=CONSTANT,
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:80   
      575    16447                   LVL = 1  ,
      576    16448                   LAST = ";" ) ;
      577    16496        %VLR_FID ( FPTN = FID_VLR  ) ;
      578    16515        %VLP_NAME(FPTN=NAMEVLP ) ;
      579    16542        %VLP_ACCT(FPTN=ACCTVLP);
      580    16555        %VLP_SN(FPTN=SNVLP);
      581    16568        %FPT_FID (FPTN=FIDFPT,
      582    16569                  NAME=NAMEVLP,
      583    16570                  ACCT=ACCTVLP,
      584    16571                  SN=SNVLP,
      585    16572                  RES=RES_AREA,
      586    16573                  ASN=ASN_VAL,
      587    16574                  RESULTS=FID_VLR ) ;
      588    16597    1   DCL RES_AREA CHAR(2) STATIC ALIGNED INIT(' ') ;
      589    16598    1   DCL ASN_VAL UBIN BYTE ALIGNED STATIC INIT( 0 );
      590    16599    1   DCL Z_ACCT(0:1) UBIN WORD CONSTANT INIT(0*0);
      591    16600    1   DCL ZERO_ACCNT REDEF Z_ACCT CHAR(8) UNAL;
      592    16601        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:81   
      593    16602        /********************************************************************/
      594    16603        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      595    16604        /*********************************************************************/
      596    16605                                                                                    /**/
      597    16606    1   DCL X$PARSE ENTRY(1) ALTRET ;
      598    16607        %ASB$SET_PROMPT ;
      599    16610        %ASB$READ_SI ;
      600    16613        %ASB$FIND_NUM ;
      601    16616        %ASD$READ_PRO ;
      602    16619        %ASF$READ_FORM ;
      603    16622        %ASH$ERROR ;
      604    16625        %ASH$WARN ;
      605    16628        %ASZ$SCRAMBLE ;
      606    16631        %ASH$HELP ;
      607    16634        %ASH$QUEST ;
      608    16637        %ASH$DQUEST ;
      609    16640        %ASB$GET_HEX_VAL ;
      610    16643        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:82   
      611    16644        /*********************************************************************/
      612    16645        /*   Local based     local based     local based     local based     */
      613    16646        /*********************************************************************/
      614    16647                                                                                    /**/
      615    16648            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      616    16649                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
      617    16694              %PARSE$SYM( NAME = OUT$SYM ,
      618    16695                          STCLASS="BASED(BLK$)") ;
      619    16733              %KL_DREC (NAME = KL$TREC ,
      620    16734                      STCLASS="BASED( TREC$ )",
      621    16735                      LAST = "," ) ;
      622    16848              %KC$CGID(FPTN=KC$CGID,
      623    16849                      STCLASS=STCLASS,
      624    16850                      LVL = 2 ,
      625    16851                      LAST = "," );
      626    16877              %FI_CONINFO(FPTN = ISINFO,
      627    16878                      STCLASS=STCLASS,
      628    16879                      LVL = 2 ,
      629    16880                      LAST = "," ) ;
      630    16924              %FO_CONINFO (FPTN = OSINFO ,
      631    16925                      STCLASS=STCLASS,
      632    16926                      LVL = 2 ,
      633    16927                      LAST = "," ) ;
      634    16958              %QQ$LOGON(FPTN = QQ_LOGON,
      635    16959                      LVL = 2 ,
      636    16960                      LAST = "," ) ;
      637    16996              %KL_RES_CL_DEV (NAME = RES_DEV,
      638    16997                              STCLASS = STCLASS,
      639    16998                              LAST=",",
      640    16999                              LVL= 2);
      641    17059              %B$CGAUINFO(FPTN = B_CGAUINFO,
      642    17060                          STCLASS=STCLASS,
      643    17061                          LVL = 2 ) ;
      644    17081        %KL_DADR ( NAME = KL$DADR,
      645    17082                   STCLASS="BASED(DADR$)",
      646    17083                   LVL = 1 ,
      647    17084                   LAST = ";" );
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:83   
      648    17132              %KL_TWSNREC(  NAME = KL$TWSNREC ,
      649    17133                            STCLASS="BASED( TWSNR$ )") ;
      650    17158              %KL_PHDR ( NAME = KL$PHDR  ,
      651    17159                        STCLASS="BASED( PRO$ )") ;
      652    17200        /*
      653    17201                  Template for a use=out device
      654    17202        */
      655    17203              %KL_DREC( NAME=OUT$DEV, STCLASS="BASED( TREC$ )", LAST="," );
      656    17316              %KC$CGID( FPTN=KC$CGID, STCLASS=STCLASS, LVL=2, LAST="," );
      657    17342              %FO_CONINFO( FPTN=OSINFO, STCLASS=STCLASS, LVL=2, LAST=";" );
      658    17373        /*
      659    17374                  Template for a use=cg device
      660    17375        */
      661    17376              %KL_DREC( NAME=CG$DEV, STCLASS="BASED( TREC$ )", LAST="," );
      662    17489              %KC$CGID( FPTN=KC$CGID, STCLASS=STCLASS, LVL=2, LAST="," );
      663    17515              %B$CGAUINFO( FPTN=B_CGAUINFO, STCLASS=STCLASS, LVL=2 );
      664    17535        /*
      665    17536                  Template for a use=tp device
      666    17537        */
      667    17538              %KL_DREC( NAME=TP$DEV, STCLASS="BASED( TREC$ )", LAST="," );
      668    17651              %KC$CGID( FPTN=KC$CGID, STCLASS=STCLASS, LVL=2, LAST="," );
      669    17677              %QQ$LOGON( FPTN=QQ_LOGON, STCLASS=STCLASS, LVL=2, LAST=";" );
      670    17713        /*
      671    17714                  Template for a use=in device
      672    17715        */
      673    17716              %KL_DREC( NAME=IN$DEV, STCLASS="BASED( TREC$ )", LAST="," );
      674    17829              %KC$CGID( FPTN=KC$CGID, STCLASS=STCLASS, LVL=2, LAST="," );
      675    17855              %FO_CONINFO( FPTN=ISINFO, STCLASS=STCLASS, LVL=2, LAST=";" );
      676    17886        /*
      677    17887                  Template for a use=res and type=cl device
      678    17888        */
      679    17889              %KL_DREC( NAME=RES$DEV, STCLASS="BASED( TREC$ )", LAST="," );
      680    18002              %KL_RES_CL_DEV( NAME=RES_DEV, STCLASS=STCLASS, LVL=2, LAST=";" );
      681    18062
      682    18063    1   DCL ACHAR          CHAR(1) BASED;
      683    18064    1   DCL 1 TP_DEV BASED (DSEG3$),
      684    18065    1          2 DEV_TYPE UBIN WORD,
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:84   
      685    18066    1          2 SNAME CHAR (8);
      686    18067        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:85   
      687    18068        /*********************************************************************/
      688    18069        /*   Procedure       procedure       procedure       procedure       */
      689    18070        /*********************************************************************/
      690    18071                                                                                    /**/
      691    18072        /*
      692    18073            ***            Begin procedure                    ***
      693    18074        */
      694    18075    1   WORK$ = P_PCB.WORK$ ;
      695    18076    1   WKSZ = P_PCB.WKSZ ;
      696    18077    1   WK_USED = P_PCB.WK_USED ;
      697    18078    1   ROOT$ = P_PCB.ROOT$ ;
      698    18079                                                /* Bump past area used.               */
      699    18080    1   P_PCB.WORK$ = PINCRW( WORK$, P_PCB.WK_USED ) ;
      700    18081    1   P_PCB.WKSZ = WKSZ - P_PCB.WK_USED ;
      701    18082                                                /* Save NODE$                         */
      702    18083    1   T_NODE$ = NODE$ ;
      703    18084    1   MORE = AS_TRUE ;
      704    18085                                                                                    /**/
      705    18086    1   NUM = AS_BLANK;
      706    18087    1   TYPE = AS_BLANK;
      707    18088    1   TP_FLAG = AS_FALSE ;
      708    18089    1   CG_FLAG = AS_FALSE ;
      709    18090    1   GROUP_FLAG = AS_FALSE ;
      710    18091    1   PRO_FLAG = AS_FALSE ;
      711    18092    1   INSTANCE_FLAG = AS_FALSE ;
      712    18093    1   SNAME_FLG = AS_FALSE ;
      713    18094    1   DEV_USE = 0;
      714    18095    2   IF CREATE THEN DO;
      715    18096    2      KL$TREC = KL_CREC;
      716    18097    2      IO='11'B;
      717    18098    2      PATTR='0'B;
      718    18099    2      DDEV='0'B;
      719    18100    2      KL$TREC.PNAME.CNT = 0;
      720    18101    2      KL$TREC.PNAME.TXT = ' ' ;
      721    18102    2      CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD );
      722    18103    2      KL$TREC.KC$CGID.NAME#.CNT = 0 ;
      723    18104    2      KL$TREC.FLAGS.RNME = AS_TRUE;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:86   
      724    18105    2      KL$TREC.RENAME=' ';
      725    18106    2      KL$TREC.TWSN# = TWSNC;
      726    18107    2      KL$TREC.OSINFO.TNAME = KL$TWSNREC.STATION ;
      727    18108    2      KL$TREC.ISINFO.TNAME = KL$TWSNREC.STATION ;
      728    18109    2      IF ( (TP_DEV.DEV_TYPE > 0) AND (~ SUB) )
      729    18110    3      THEN DO;
      730    18111    4         IF NOT CREATE THEN DO ;
      731    18112    4            KL$TREC.KC$CGID = KL_CREC.KC$CGID ;
      732    18113    4            KL$TREC.KC$CGID.NAME#.CNT = 0 ;
      733    18114    4            KL$TREC.QQ_LOGON = KL_CREC.QQ_LOGON ;
      734    18115    4            END;
      735    18116    3         TYPE = 'CG';
      736    18117    3         TP_FLAG = AS_TRUE;
      737    18118    3         KL$TREC.FLAGS.RNME = AS_FALSE ;
      738    18119    3         KL$TREC.FLAGS.USETP = AS_TRUE ;
      739    18120    3         KL$TREC.SUPER = 7 /* TP DEVICE */;
      740    18121    3         DEV_USE = 48 /* TP */;
      741    18122    3         IF TP_DEV.DEV_TYPE = 2
      742    18123    4         THEN DO; /* We will use the default sname */
      743    18124    4            SNAME_FLG = AS_TRUE;
      744    18125    4            KL$TREC.FLAGS.RNME = AS_TRUE;
      745    18126    4            KL$TREC.RENAME = TP_DEV.SNAME;
      746    18127    4            END;
      747    18128    3         END;
      748    18129    2      END;
      749    18130    2   ELSE DO;
      750    18131    2      TWSNC = KL$TREC.TWSN#;
      751    18132    3      DO SELECT( KL$TREC.SUPER );
      752    18133    3         SELECT( 5 /* INSYM DEVICE */ );                   /* Use=in device */
      753    18134    3         DEV_USE = DEV_IN_VAL ;
      754    18135    3         SELECT( 6 /* OUTSYM DEVICE */ );                  /* Use=out device */
      755    18136    3         DEV_USE = DEV_OUT_VAL ;
      756    18137    3         KL$TREC.OSINFO = OUT$DEV.OSINFO ;
      757    18138    3         SELECT( 12 /* RES DEVICE */ );                   /* Use=res device */
      758    18139    3         DEV_USE = 47 /* RESOURCE */ ;
      759    18140    3         IF SUBSTR(KL$TREC.RENAME,0,2) = 'CL' THEN
      760    18141    3            KL$TREC.RES_DEV = RES$DEV.RES_DEV;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:87   
      761    18142    3         SELECT( 7 /* TP DEVICE */ );                   /* Use=tp device */
      762    18143    3         IF SUB THEN PRO_FLAG = AS_TRUE ;
      763    18144    3         ELSE TYPE = 'CG';
      764    18145    3         DEV_USE = 48 /* TP */ ;
      765    18146    3         TP_FLAG = AS_TRUE ;
      766    18147    3         INSTANCE_FLAG = AS_TRUE ;
      767    18148    3         KL$TREC.QQ_LOGON = TP$DEV.QQ_LOGON ;
      768    18149    3         SELECT( 11 /* CG DEVICE */ );                   /* Use=cg device */
      769    18150    3         IF SUB THEN PRO_FLAG = AS_TRUE ;
      770    18151    3         ELSE TYPE = 'CG';
      771    18152    3         DEV_USE = 49 /* COM GROUP  */ ;
      772    18153    3         CG_FLAG = AS_TRUE ;
      773    18154    3         GROUP_FLAG = AS_TRUE ;
      774    18155    3         KL$TREC.B_CGAUINFO = CG$DEV.B_CGAUINFO ;
      775    18156    3         END ;
      776    18157    3      IF TYPE ~= 'CG' THEN DO;
      777    18158    3         TYPE = KL$TWSNREC.DEVS.TYP(TWSN_INDEX) ;
      778    18159    3         NUM  = KL$TWSNREC.DEVS.NUM(TWSN_INDEX) ;
      779    18160    3         PATTR= KL$TWSNREC.DEVS.ATTR(TWSN_INDEX) ;
      780    18161    3         IO   = KL$TWSNREC.DEVS.IO(TWSN_INDEX) ;
      781    18162    3         DDEV = KL$TWSNREC.DEVS.DDEV(TWSN_INDEX) ;
      782    18163    3         IF SUB THEN FROM_KEY.TEXT = KL$TWSNREC.DEVS.ACCT(TWSN_INDEX) ;
      783    18164    3         END;
      784    18165    2      END;
      785    18166    1   KL$TWSNREC.DEVS(TWSN_INDEX) = '0'B ;
      786    18167    1   P_PCB.ROOT$ = ADDR( DEVICE_OPTS_LIST ) ;
      787    18168                                                /* Set prompt                         */
      788    18169    2   IF SUB THEN DO;
      789    18170    2      CALL ASB$SET_PROMPT ( %PROMPT_SUB );
      790    18171    2      END;
      791    18172    2   ELSE DO;
      792    18173    2      CALL ASB$SET_PROMPT ( %PROMPT_OPT ) ;
      793    18174    2      END;
      794    18175    1   REMEMBER DEV_LOOP IN REMEM_VAR ;
      795    18176    1   DEV_LOOP:
      796    18177                                                                                    /**/
      797    18178    2   DO WHILE( MORE ) ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:88   
      798    18179                                                /* Read input                         */
      799    18180    2      CALL ASB$READ_SI( IN_BUF, ARS ) ;
      800    18181    2      P_PCB.NCHARS = ARS ;
      801    18182    2      CALL X$PARSE( P_PCB )
      802    18183    3      WHENALTRETURN DO;
      803    18184    3         CALL ASH$ERROR( P_PCB.ERROR ) ;
      804    18185    3         GOTO DEV_LOOP ;
      805    18186    3         END; /*  Whenaltreturn  */
      806    18187                                                                      /**/
      807    18188    2      NODE$ = P_PCB.OUT$ ;
      808    18189    3      DO I = 0 TO P$NODE.SUBNODES-1 ;
      809    18190    3         PTR$ = P$NODE.SUBLK$(I) ;
      810    18191    3         CODE = PTR$ -> P$NODE.CODE ;
      811    18192    4         DO SELECT ( CODE ) ;
      812    18193                                                                                    /**/
      813    18194    4            SELECT ( 45 /* TCD_PRO_VAL */ ) ;
      814    18195                                                /* Profile                            */
      815    18196    5            IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE = 7   /*  NONE_VAL  */ THEN DO;
      816    18197    5               KL$TREC.PNAME.CNT=0;
      817    18198    5               KL$TREC.PNAME.TXT=' ';
      818    18199    5               GOTO END_OPTION;
      819    18200    5               END;  /*  Profile = none  */
      820    18201    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
      821    18202    4            CNT = OUT$SYM.COUNT ;
      822    18203    4            IF CNT > 11
      823    18204    4            THEN
      824    18205    5            DO ;
      825    18206                    %SCREAM( ERR#=E$PRO_TOO_LONG, LEVEL=ERROR, MID='A' );
      826    18221    5               GOTO END_OPTION ;
      827    18222    5               END ;               /* Then do                            */
      828    18223                                                /* Check if profile exists            */
      829    18224    4            PRO$ = ADDR(PRO_BUF);
      830    18225    4            ARS=LENGTHC(PRO_BUF);
      831    18226    4            USERS_KEY.COUNT = OUT$SYM.COUNT ;
      832    18227    4            USERS_KEY.TXTC = OUT$SYM.TEXT ;
      833    18228    4            CALL ASD$READ_PRO( USERS_KEY, KL$PHDR, ARS )
      834    18229    5            WHENALTRETURN DO;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:89   
      835    18230                                                                     /**/
      836    18231    5               CALL INDEX( I, AS_BLANK, USERS_KEY.TXTC );
      837    18232    5               AS_FIELD1.COUNT = I ;
      838    18233    5               AS_FIELD1.TEXT = USERS_KEY.TXTC ;
      839    18234                    %SCREAM( ERR#=E$PRO_NO_EXIST, LEVEL=ERROR, MID='A' );
      840    18249    5               GOTO END_OPTION ;
      841    18250    5               END; /*  Whenaltreturn  */
      842    18251                                                                     /**/
      843    18252                                                /* It exists                          */
      844    18253    5            IF SUB AND KL$PHDR.TTYP ~= %KLTY_SDEV# THEN DO;
      845    18254        /*E* ERROR: ASA-E$DEVPROTYPE-0
      846    18255             MESSAGE: Profile must be of terminal-device type.
      847    18256             MESSAGE1: The profile be one that describes a terminal-device
      848    18257                       For example, IRBTLP or 2780CR.
      849    18258        */
      850    18259                    %SCREAM( ERR#=E$DEVPROTYPE, LEVEL=ERROR, MID='A' );
      851    18274    5               GOTO END_OPTION;
      852    18275    5               END;
      853    18276    4            IF NOT SUB AND (KL$PHDR.TTYP~=%KLTY_TTY# AND KL$PHDR.TTYP~=%KLTY_LINEDEV#)
      854    18277    4                 AND  KL$PHDR.TTYP ~= %KLTY_URP#
      855    18278    5            THEN DO;
      856    18279        /*E* ERROR: ASA-E$ASYNCPROTYPE-0
      857    18280             MESSAGE: Profile must describe an ASYNC (TTY) type device.
      858    18281        */
      859    18282                    %SCREAM( ERR#=E$ASYNCPROTYPE, LEVEL=ERROR, MID='A' );
      860    18297    5               GOTO END_OPTION;
      861    18298    5               END;
      862    18299    4            PATTR = KL$PHDR.ATTR ;
      863    18300    4            IO=KL$PHDR.IO;
      864    18301    4            DDEV=KL$PHDR.DDEV;
      865    18302    4            KL$TREC.PNAME = USERS_KEY ;
      866    18303    4            PRO_FLAG = AS_TRUE ;
      867    18304                                                                                    /**/
      868    18305    4            SELECT ( 16   /*  EOL_VAL  */ ) ;
      869    18306                                                                                    /**/
      870    18307    4            SELECT ( 302 /* HELP_VAL */ ) ;
      871    18308    4            CALL ASH$HELP ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:90   
      872    18309                                                              /**/
      873    18310    4            SELECT ( 301 /* QUESTION_VAL */ ) ;
      874    18311    4            CALL ASH$QUEST ;
      875    18312                                                              /**/
      876    18313    4            SELECT ( 300 /* DQUESTION_VAL */ ) ;
      877    18314    4            CALL ASH$DQUEST ;
      878    18315                                                              /**/
      879    18316    4            SELECT ( 12   /*  END_VAL  */ ,
      880    18317    4                 26   /*  BLANK_LINE_VAL */ ) ;
      881    18318                                                /* Done                               */
      882    18319    4            MORE = AS_FALSE ;
      883    18320                                                                                    /**/
      884    18321    4            SELECT ( 33 /* TERM_PASS */ ) ;
      885    18322                                                /* Password                           */
      886    18323    5            IF SUB THEN DO;
      887    18324        /*E* ERROR: ASA-E$DEVSUBPASS-0
      888    18325             MESSAGE: The PASS option is not legal.
      889    18326             MESSAGE1: Passwords don't make sense for devices that can't log on.
      890    18327        */
      891    18328                    %SCREAM( ERR#=E$DEVSUBPASS, LEVEL=ERROR, MID='A' );
      892    18343    5               GOTO END_OPTION;
      893    18344    5               END;
      894    18345    4            CODE2 = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      895    18346    5            DO SELECT( CODE2 ) ;
      896    18347                                                                                    /**/
      897    18348    5               SELECT( 7   /*  NONE_VAL  */ ) ;
      898    18349    5               KL$TREC.PASSWORD = AS_BLANK ;
      899    18350    5               CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;
      900    18351                                                                                    /**/
      901    18352    5               SELECT( 43 /* TERM_PW */ ) ;
      902    18353    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
      903    18354    5               CNT =  OUT$SYM.COUNT ;
      904    18355    6               IF CNT > 8 THEN DO;
      905    18356                       %SCREAM( ERR#=E$PASSW_TOO_LONG, LEVEL=ERROR, MID='A');
      906    18371    6                  GOTO END_OPTION ;
      907    18372    6                  END ;            /* Then do                            */
      908    18373    5               KL$TREC.PASSWORD = OUT$SYM.TEXT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:91   
      909    18374    5               CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;
      910    18375                                                                                    /**/
      911    18376    5               SELECT( 47   /*  OCT_PASS_VAL */ ) ;
      912    18377    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);
      913    18378    5               CNT = OUT$SYM.COUNT;
      914    18379    5               IF CNT ~= 24
      915    18380    6               THEN DO;
      916    18381        /*E*  ERROR:    AS-E$OCTAL_PASSWORD_LENGTH_ERR-C
      917    18382              MESSAGE: PASSWORD not the right size.
      918    18383              MESSAGE1: PASSWORD in octal form must be 24 characters long.
      919    18384        */
      920    18385                       %SCREAM(ERR#=E$OCTAL_PASSWORD_LENGTH_ERR,LEVEL=ERROR,MID='A');
      921    18400    6                  END; /*  Length error  */
      922    18401    6               ELSE DO;
      923    18402    6                  P$ = ADDR ( OUT$SYM.TEXT );
      924    18403    6                  PTR$ = PINCRC (P$,24);
      925    18404    6                  TEMP$ = ADDR (KL$TREC.PASSWORD);
      926    18405    7                  DO WHILE P$ < PTR$ ;
      927    18406    7                     CALL CHARBIN (L, P$->ACHAR);
      928    18407    7                     P$ = PINCRC (P$,1);
      929    18408    7                     CALL CHARBIN (J, P$-> ACHAR);
      930    18409    7                     P$ = PINCRC (P$,1);
      931    18410    7                     CALL CHARBIN (K, P$->ACHAR);
      932    18411    7                     TEMP = L * 64 + J * 8 + K;
      933    18412    7                     P$ = PINCRC (P$, 1);
      934    18413    7                     TEMP$ -> ACHAR = BINASC ( TEMP );
      935    18414    7                     TEMP$ = PINCRC (TEMP$, 1);
      936    18415    7                     END; /*  Do while P$ < PTR$  */
      937    18416    6                  END; /*  Length ok  */
      938    18417    5               END ;                 /* Do case( CODE2 )                   */
      939    18418        /**/
      940    18419    4            SELECT (25 /*DEV USE */);
      941    18420    4            CODE2 = PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE;
      942    18421    5            DO SELECT (CODE2) ;
      943    18422    5               SELECT ( 1   /*  YES_VAL  */) ;
      944    18423    6               IF NOT CREATE AND DEV_USE ~= CODE2 THEN DO ;
      945    18424    6                  IF TYPE = 'CG' THEN TYPE = AS_BLANK;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:92   
      946    18425    6                  KL$TREC.ISINFO = KL_CREC.ISINFO ;
      947    18426    7                  IF TP_FLAG THEN DO ;
      948    18427    7                     KL$TREC.FLAGS.USETP = AS_FALSE ;
      949    18428    7                     TP_FLAG = AS_FALSE ;
      950    18429    7                     INSTANCE_FLAG = AS_FALSE ;
      951    18430    7                     END ;
      952    18431    7                  ELSE IF CG_FLAG THEN DO;
      953    18432    7                        CG_FLAG = AS_FALSE;
      954    18433    7                        GROUP_FLAG = AS_FALSE;
      955    18434    7                        END ;
      956    18435    6                  SNAME_FLG = AS_FALSE ;
      957    18436    6                  END ;
      958    18437    5               KL$TREC.KC$CGID.NAME#.CNT = 4;
      959    18438    5               KL$TREC.KC$CGID.NAME#.TXT = 'ISCG';
      960    18439    5               KL$TREC.KC$CGID.ACCT# = ':SYS' ;
      961    18440    5               KL$TREC.KC$CGID.PSN# = AS_BLANK ;
      962    18441    5               KL$TREC.ISINFO.NCTLOK=AS_TRUE;
      963    18442    5               KL$TREC.ISINFO.NCACCT = ':NCTL' ;
      964    18443    5               KL$TREC.ISINFO.MXPRI=%KLIS_DFPRI;
      965    18444    5               KL$TREC.ISINFO.DFLTPRI=%KLIS_DFPRI;
      966    18445    5               KL$TREC.SUPER = 5 /* INSYM DEVICE */;
      967    18446    5               SELECT ( 2   /*  NO_VAL  */ ) ;
      968    18447    6               IF NOT CREATE AND DEV_USE ~= CODE2 THEN DO ;
      969    18448    6                  KL$TREC.OSINFO = KL_CREC.OSINFO ;
      970    18449    6                  IF TYPE = 'CG' THEN TYPE = AS_BLANK;
      971    18450    7                  IF TP_FLAG THEN DO ;
      972    18451    7                     KL$TREC.FLAGS.USETP = AS_FALSE ;
      973    18452    7                     TP_FLAG = AS_FALSE ;
      974    18453    7                     INSTANCE_FLAG = AS_FALSE ;
      975    18454    7                     END ;
      976    18455    7                  ELSE IF CG_FLAG THEN DO;
      977    18456    7                        CG_FLAG = AS_FALSE;
      978    18457    7                        GROUP_FLAG = AS_FALSE;
      979    18458    7                        END ;
      980    18459    6                  SNAME_FLG = AS_FALSE ;
      981    18460    6                  END ;
      982    18461    5               KL$TREC.KC$CGID.NAME#.CNT = 4;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:93   
      983    18462    5               KL$TREC.KC$CGID.NAME#.TXT = 'OSCG' ;
      984    18463    5               KL$TREC.KC$CGID.ACCT# = ':SYS' ;
      985    18464    5               KL$TREC.KC$CGID.PSN# = AS_BLANK ;
      986    18465    5               IF SUBSTR(KL$TREC.RENAME,0,2)='LP' THEN
      987    18466    5                  KL$TREC.OSINFO.FNAME=%KLOS_DFFMLP;
      988    18467    5               ELSE
      989    18468    5                  KL$TREC.OSINFO.FNAME=%KLOS_DFFMXX;
      990    18469    5               KL$TREC.SUPER = 6 /* OUTSYM DEVICE */;
      991    18470    5               SELECT ( 47 /* RESOURCE */ ) ;
      992    18471    6               IF NOT CREATE AND DEV_USE ~= CODE2 THEN DO ;
      993    18472    6                  IF TYPE = 'CG' THEN TYPE = AS_BLANK;
      994    18473    7                  IF TP_FLAG THEN DO ;
      995    18474    7                     KL$TREC.FLAGS.USETP = AS_FALSE ;
      996    18475    7                     TP_FLAG = AS_FALSE ;
      997    18476    7                     INSTANCE_FLAG = AS_FALSE ;
      998    18477    7                     END ;
      999    18478    7                  ELSE IF CG_FLAG THEN DO;
     1000    18479    7                        CG_FLAG = AS_FALSE;
     1001    18480    7                        GROUP_FLAG = AS_FALSE;
     1002    18481    7                        END ;
     1003    18482    6                  SNAME_FLG = AS_FALSE ;
     1004    18483    6                  END ;
     1005    18484    6               IF CREATE THEN DO ;
     1006    18485    6                  KL$TREC.FLAGS = '0'B ;
     1007    18486    6                  KL$TREC.FLAGS.RNME = AS_TRUE ;
     1008    18487    6                  END ;
     1009    18488    5               KL$TREC.ATYP = %KLAT_RES# ;
     1010    18489    5               KL$TREC.SUPER = 12 /* RES DEVICE */;
     1011    18490    5               SELECT (48 /* TP */ ) ;
     1012    18491                                           /* Use can't be tp if
     1013    18492                                              type has been set  */
     1014    18493    5               IF TYPE~=AS_BLANK THEN
     1015    18494    6                  IF KL$TREC.SUPER ~= 7 /* TP DEVICE */ THEN DO ;
     1016    18495        /*E*  ERROR: ASA-E$TPILLEGAL-C
     1017    18496              MESSAGE: Can't specify USE=TP since TYPE has been specified
     1018    18497        */
     1019    18498                          %SCREAM( ERR#=E$TPILLEGAL, LEVEL=ERROR, MID='A' );
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:94   
     1020    18513    6                     GOTO END_OPTION;
     1021    18514    6                     END;
     1022    18515    6               IF NOT CREATE AND DEV_USE ~= CODE2 THEN DO ;
     1023    18516    6                  KL$TREC.KC$CGID = KL_CREC.KC$CGID ;
     1024    18517    6                  KL$TREC.KC$CGID.NAME#.CNT = 0 ;
     1025    18518    6                  KL$TREC.QQ_LOGON = KL_CREC.QQ_LOGON ;
     1026    18519    7                  IF CG_FLAG THEN DO ;
     1027    18520    7                     CG_FLAG = AS_FALSE ;
     1028    18521    7                     GROUP_FLAG = AS_FALSE ;
     1029    18522    7                     SNAME_FLG = AS_FALSE ;
     1030    18523    7                     END ;
     1031    18524    6                  END ;
     1032    18525    5               TYPE= 'CG' ;
     1033    18526    5               TP_FLAG = AS_TRUE ;
     1034    18527    6               IF SUB THEN DO;
     1035    18528    6                  CALL ASB$FIND_NUM(TWSNR$,TYPE,NUM) ALTRET(FIND_NUM_ERR) ;
     1036    18529    6                  CALL CONCAT(KL$TREC.RENAME,TYPE,NUM,KL$TREC.TWSN#) ;
     1037    18530    6                  FROM_KEY.TEXT = KL$TREC.RENAME ;
     1038    18531    6                  FROM_KEY.CNT = 8 ;
     1039    18532    6                  END;   /* Do  */
     1040    18533    5               KL$TREC.FLAGS.RNME = AS_FALSE ;
     1041    18534    5               KL$TREC.FLAGS.USETP = AS_TRUE ;
     1042    18535    5               KL$TREC.SUPER = 7 /* TP DEVICE */;
     1043    18536                                                /**/
     1044    18537    5               SELECT (49 /* COM GROUP  */ ) ;
     1045    18538                                           /* Use can't be cg if
     1046    18539                                              type has been set  */
     1047    18540    5               IF TYPE~=AS_BLANK THEN
     1048    18541    6                  IF KL$TREC.SUPER ~= 11 /* CG DEVICE */ THEN DO ;
     1049    18542        /*E*  ERROR: ASA-E$CGILLEGAL-0
     1050    18543              MESSAGE: Can't specify USE=CG since TYPE has been specified
     1051    18544        */
     1052    18545                          %SCREAM( ERR#=E$CGILLEGAL, LEVEL=ERROR, MID='A' );
     1053    18560    6                     GOTO END_OPTION;
     1054    18561    6                     END;
     1055    18562    6               IF NOT CREATE AND DEV_USE ~= CODE2 THEN DO ;
     1056    18563    6                  KL$TREC.KC$CGID = KL_CREC.KC$CGID ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:95   
     1057    18564    6                  KL$TREC.KC$CGID.NAME#.CNT = 0 ;
     1058    18565    6                  KL$TREC.B_CGAUINFO = KL_CREC.B_CGAUINFO ;
     1059    18566    7                  IF TP_FLAG THEN DO ;
     1060    18567    7                     KL$TREC.FLAGS.USETP = AS_FALSE ;
     1061    18568    7                     TP_FLAG = AS_FALSE ;
     1062    18569    7                     INSTANCE_FLAG = AS_FALSE ;
     1063    18570    7                     SNAME_FLG = AS_FALSE ;
     1064    18571    7                     END ;
     1065    18572    6                  END ;
     1066    18573    5               TYPE='CG';
     1067    18574    5               CG_FLAG = AS_TRUE ;
     1068    18575    6               IF SUB THEN DO;
     1069    18576    6                  CALL ASB$FIND_NUM(TWSNR$,TYPE,NUM) ALTRET(FIND_NUM_ERR) ;
     1070    18577    6                  CALL CONCAT(KL$TREC.RENAME,TYPE,NUM,KL$TREC.TWSN#) ;
     1071    18578    6                  FROM_KEY.TEXT = KL$TREC.RENAME ;
     1072    18579    6                  FROM_KEY.CNT= 8 ;
     1073    18580    6                  END;   /* Do  */
     1074    18581    5               KL$TREC.FLAGS.RNME =AS_FALSE ;
     1075    18582    5               KL$TREC.SUPER = 11 /* CG DEVICE */;
     1076    18583    5               END;   /* Do case (CODE2)  */
     1077    18584    4            DEV_USE = CODE2 ;
     1078    18585        /**/
     1079    18586    4            SELECT ( 24 /* DEV_TYPE */);
     1080    18587
     1081    18588    5            IF DEV_USE = 48 /* TP */ OR DEV_USE=49 /* COM GROUP  */ THEN DO;
     1082    18589                     /*E* ERROR:  ASA-E$TYPEILLEGAL-0
     1083    18590                          MESSAGE: TYPE legal only if USE=IN, USE=OUT or USE=RES
     1084    18591               MESSAGE1: Specify USE=IN, USE=OUT or USE=RES unless you want USE=CG or USE=TP
     1085    18592                     */
     1086    18593                    %SCREAM( ERR#=E$TYPEILLEGAL, LEVEL=ERROR, MID='A' );
     1087    18608    5               GOTO END_OPTION;
     1088    18609    5               END;
     1089    18610    4            BLK$=PTR$->P$NODE.SUBLK$(0);
     1090    18611    4            TEMP_TYPE=OUT$SYM.TEXT;
     1091    18612    5            IF OUT$SYM.COUNT ~=2 THEN DO;
     1092    18613        /*E* ERROR:   ASA-E$DEV_TYPE_LEN_ERR-C
     1093    18614             MESSAGE: TYPE must be 2 characters long.
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:96   
     1094    18615        */
     1095    18616                    %SCREAM( ERR#=E$DEV_TYPE_LEN_ERR, LEVEL=ERROR, MID='A' );
     1096    18631    5               GOTO END_OPTION;
     1097    18632    5               END;
     1098    18633    5            DO J = 0 TO 1 ;
     1099    18634    5               CALL INDEX( K, SUBSTR(TEMP_TYPE,J,1), AS_VALID_DEVICE_TYPE_CHARS )
             18634                        ALTRET( BAD_DEVICE_TYPE ) ;
     1100    18635    6               IF '0'B THEN DO ;
     1101    18636    6   BAD_DEVICE_TYPE:
     1102    18637        /*    ERROR:  ASA-E$INVALID_DEV_TYPE_CHAR-C
     1103    18638        MESSAGE: "%U1" is an invalid character for a device type.
     1104    18639        MESSAGE1: The character set for a device type consists of uppercase
     1105    18640                        letters (a-z) and digits (0-9).
     1106    18641        */
     1107    18642    6                  AS_FIELD1.COUNT = 1 ;
     1108    18643    6                  AS_FIELD1.TEXT = SUBSTR( TEMP_TYPE, J, 1 ) ;
     1109    18644                       %SCREAM( ERR#=E$INVALID_DEV_TYPE_CHAR, LEVEL=ERROR, MID='A') ;
     1110    18659    6                  GOTO END_OPTION ;
     1111    18660    6                  END ; /* Then do */
     1112    18661    5               END ;
     1113    18662    4            IF NOT CREATE THEN
     1114    18663    5               IF TEMP_TYPE~=SUBSTR(KL$TREC.RENAME,0,2) THEN DO;
     1115    18664        /*E* ERROR: ASA-E$DEVTCHANGE-0
     1116    18665             MESSAGE: You can't modify a devices TYPE.
     1117    18666             MESSAGE1: The TYPE option of a device can not be modified.
     1118    18667                  You might try removing the device and re-creating it.
     1119    18668        */
     1120    18669                       %SCREAM( ERR#=E$DEVTCHANGE, LEVEL=ERROR, MID='A' );
     1121    18684    5                  GOTO END_OPTION;
     1122    18685    5                  END;
     1123    18686    4               ELSE GOTO END_OPTION;
     1124    18687    4            TYPE = TEMP_TYPE ;
     1125    18688    4            CALL ASB$FIND_NUM(TWSNR$,TYPE,NUM) ALTRET(FIND_NUM_ERR);
     1126    18689    4            CALL CONCAT(KL$TREC.RENAME,TYPE,NUM,KL$TREC.TWSN#);
     1127    18690    4            IF SUB THEN
     1128    18691    5            DO ;
     1129    18692    5               FROM_KEY.TEXT = KL$TREC.RENAME ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:97   
     1130    18693    5               FROM_KEY.CNT= 8 ;
     1131    18694    6               IF CREATE THEN DO;
     1132    18695    7                  IF NOT DEVNUM_SET THEN DO;
     1133    18696    8                     IF TERM_T = 'STDHASP' THEN DO;
     1134    18697    8                        IF TYPE = 'CP' THEN
     1135    18698    8                           KL$DADR.DEVNUM# = %KLDN_HASPCP#;
     1136    18699    8                        IF TYPE = 'CR' THEN
     1137    18700    8                           KL$DADR.DEVNUM# = %KLDN_HASPCR#;
     1138    18701    8                        IF TYPE = 'LP' THEN
     1139    18702    8                           KL$DADR.DEVNUM# = %KLDN_HASPLP#;
     1140    18703    8                        IF TYPE = 'LI' THEN
     1141    18704    8                           KL$DADR.DEVNUM# = %KLDN_HASPLP2#;
     1142    18705    8                        IF TYPE = 'JE' THEN
     1143    18706    8                           KL$DADR.DEVNUM# = %KLDN_HASPCP#;
     1144    18707    8                        END; /*  Term type is stdhasp  */
     1145    18708    7                     ELSE
     1146    18709    8                        IF TERM_T = 'STD2780' THEN DO;
     1147    18710    8                           IF TYPE = 'CP' THEN
     1148    18711    8                              KL$DADR.DEVNUM# = %KLDN_2780CP#;
     1149    18712    8                           IF TYPE = 'CR' THEN
     1150    18713    8                              KL$DADR.DEVNUM# = %KLDN_2780CR#;
     1151    18714    8                           IF TYPE = 'LI' OR TYPE = 'LP' THEN
     1152    18715    8                              KL$DADR.DEVNUM# = %KLDN_2780LP#;
     1153    18716    8                           END; /*  Term type is STD2780  */
     1154    18717    7                        ELSE
     1155    18718    8                           IF TERM_T = 'STD3780' THEN DO;
     1156    18719    8                              IF TYPE = 'CP' THEN
     1157    18720    8                                 KL$DADR.DEVNUM# = %KLDN_3780CP#;
     1158    18721    8                              IF TYPE = 'CR' THEN
     1159    18722    8                                 KL$DADR.DEVNUM# = %KLDN_3780CR#;
     1160    18723    8                              IF TYPE = 'LI' OR TYPE = 'LP' THEN
     1161    18724    8                                 KL$DADR.DEVNUM# = %KLDN_3780LP#;
     1162    18725    8                              END; /*  Term type is STD3780  */
     1163    18726    7                     END; /*  Not DEVNUM_SET  */
     1164    18727    7                  IF NOT DEVCTL_SET THEN DO;
     1165    18728    8                     IF TERM_T = 'STDHASP' THEN DO;
     1166    18729    9                        IF TYPE = 'CP' OR TYPE = 'CR' THEN DO;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:98   
     1167    18730    9                           KL$DADR.DEVCTL.B = %KLDCB_HASPCP#;
     1168    18731    9                           KL$DADR.DEVCTL.T = '0'B;
     1169    18732    9                           END; /*  Type 'CP' or 'CR'  */
     1170    18733    9                        ELSE IF TYPE = 'LI' OR TYPE = 'LP' THEN DO;
     1171    18734    9                              KL$DADR.DEVCTL.T = %KLDCT_HASPLP#;
     1172    18735    9                              KL$DADR.DEVCTL.B = '0'B;
     1173    18736    9                              END; /*  Type 'LI' or 'LP'  */
     1174    18737    8                        END; /*  Term type is stdhasp  */
     1175    18738    7                     END; /*  Not DEVCTL_SET  */
     1176    18739    6                  END; /*  Create  */
     1177    18740    5               END;   /* Do  */
     1178    18741    5            IF SUB AND KL$TREC.PNAME.TXT=' ' THEN DO;
     1179    18742    5               CALL CONCAT(KL$TREC.PNAME.TXT,TERM_T,TYPE);
     1180    18743    5               KL$TREC.PNAME.CNT=6;
     1181    18744    5               END;
     1182    18745                                                                                    /**/
     1183    18746    4            SELECT ( 30 /*DEV_MXPRIO*/ ) ;
     1184    18747    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR ;
     1185    18748    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
     1186    18749    4            CALL CHARBIN( CNT, OUT$SYM.TEXT ) ;
     1187    18750    4            IF CNT > 15
     1188    18751    5            THEN DO ;
     1189    18752        /*   ERROR:  ASA-E$MAXPRIO_TOO_BIG-C
     1190    18753             MESSAGE: Maxprio too large.
     1191    18754             MESSAGE: Maxprio may not exceed 15.
     1192    18755        */
     1193    18756                    %SCREAM( ERR#=E$MAXPRIO_TOO_BIG, LEVEL=ERROR, MID='A' );
     1194    18771    5               GOTO END_OPTION ;
     1195    18772    5               END ;               /* Then do                            */
     1196    18773    4            KL$TREC.ISINFO.MXPRI=CNT;
     1197    18774                                                                                    /**/
     1198    18775    4            SELECT ( 39  /* DEVICE WSN   */ );
     1199    18776
     1200    18777    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR;
     1201    18778    4            IF PTR$ -> P$NODE.CODE = 7   /*  NONE_VAL  */ THEN
     1202    18779    4               KL$TREC.ISINFO.WSN = ' ';
     1203    18780    5            ELSE DO;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:99   
     1204    18781    5               BLK$ = PTR$->P$NODE.SUBLK$(0) ;
     1205    18782    5               IF OUT$SYM.COUNT > 8
     1206    18783    6               THEN DO;
     1207    18784                       %SCREAM (ERR#=E$WSNNAMETOOBIG, MID='A', LEVEL=ERROR );
     1208    18799    6                  END;
     1209    18800    6               ELSE DO;
     1210    18801    6                  KL$TREC.ISINFO.WSN = OUT$SYM.TEXT;
     1211    18802    6                  END;
     1212    18803    5               END;   /*  Not none  */
     1213    18804
     1214    18805    4            SELECT  ( 40 /* DEVICE MCT  */ ) ;
     1215    18806    4            IF TP_FLAG = AS_FALSE THEN
     1216    18807    5            DO ;
     1217    18808        /*E*  ERROR: ASA-E$MCTILLEGAL-0
     1218    18809              MESSAGE: MCT legal only for USE=TP
     1219    18810        */
     1220    18811                    %SCREAM( ERR#=E$MCTILLEGAL, LEVEL=ERROR, MID='A' );
     1221    18826    5               GOTO END_OPTION;
     1222    18827    5               END;
     1223    18828    4            CODE2=PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE ;
     1224    18829    5            DO SELECT (CODE2) ;
     1225    18830    5               SELECT(1   /*  YES_VAL  */ ) ;
     1226    18831    5               KL$TREC.QQ_LOGON.MCT=AS_TRUE ;
     1227    18832    5               KL$TREC.QQ_LOGON.MCTCMD = AS_TRUE ;
     1228    18833    5               KL$TREC.QQ_LOGON.MCTD = AS_FALSE ;
     1229    18834    5               SELECT ( 2   /*  NO_VAL  */) ;
     1230    18835    5               KL$TREC.QQ_LOGON.MCT = AS_FALSE ;
     1231    18836    5               KL$TREC.QQ_LOGON.MCTCMD = AS_FALSE ;
     1232    18837    5               KL$TREC.QQ_LOGON.MCTD = AS_FALSE ;
     1233    18838    5               SELECT ( 46 /* COMMAND */ ) ;
     1234    18839    5               KL$TREC.QQ_LOGON.MCT = AS_FALSE ;
     1235    18840    5               KL$TREC.QQ_LOGON.MCTCMD = AS_TRUE ;
     1236    18841    5               KL$TREC.QQ_LOGON.MCTD = AS_FALSE ;
     1237    18842    5               SELECT ( 25 /* DISPLAY */ ) ;
     1238    18843    5               KL$TREC.QQ_LOGON.MCT = AS_FALSE ;
     1239    18844    5               KL$TREC.QQ_LOGON.MCTCMD = AS_FALSE ;
     1240    18845    5               KL$TREC.QQ_LOGON.MCTD = AS_TRUE ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:100  
     1241    18846    5               END;   /* Do CODE2 */
     1242    18847
     1243    18848    4            SELECT  ( 41  /* DEVICE SNAME  */ ) ;
     1244    18849    4            IF TYPE ~= 'CG' THEN
     1245    18850    5            DO;
     1246    18851        /*E*  ERROR:  ASA-E$SNAMEILLEGAL-0
     1247    18852              MESSAGE:  SNAME legal only for USE=CG or USE=TP
     1248    18853        */
     1249    18854                    %SCREAM( ERR#=E$SNAMEILLEGAL, LEVEL=ERROR, MID='A' );
     1250    18869    5               GOTO END_OPTION;
     1251    18870    5               END;
     1252    18871    5            IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE = 7   /*  NONE_VAL  */ THEN DO;
     1253    18872    5               KL$TREC.RENAME = ' '; /* clear out rename buffer */
     1254    18873    5               KL$TREC.FLAGS.RNME = AS_FALSE; /* re-init the rename flg */
     1255    18874    5               GOTO END_OPTION;
     1256    18875    5               END;  /*  None  */
     1257    18876    4            KL$TREC.FLAGS.RNME = AS_TRUE ;
     1258    18877    4            BLK$ = PTR$ ->P$NODE.SUBLK$(0);
     1259    18878    4            IF (SUBSTR(OUT$SYM.TEXT,0,2) = '$$')
     1260    18879    5            THEN DO;
     1261    18880        /*E*  ERROR: ASA-E$NO$$ONSNAME-0
     1262    18881              MESSAGE1: The SNAME of a CG type device cannot start with '$$'.
     1263    18882              MESSAGE2: Comgroups do not allow '$$' as the first 2 characters
     1264    18883                        of a name.
     1265    18884              MESSAGE: You tried to specify an SNAME with '$$' as the
     1266    18885                       first two characters, this is a no-no!
     1267    18886        */
     1268    18887                    %SCREAM (ERR#=E$NO$$ONSNAME, LEVEL=ERROR, MID='A');
     1269    18902    5               GOTO END_OPTION;
     1270    18903    5               END;
     1271    18904    4            KL$TREC.RENAME = OUT$SYM.TEXT ;
     1272    18905    4            SNAME_FLG = AS_TRUE ;
     1273    18906
     1274    18907    4            SELECT  ( 42  /* DEVICE PRIORITY  */ ) ;
     1275    18908    4            IF DEV_USE ~= 48 /* TP */ THEN
     1276    18909    5            DO ;
     1277    18910        /*E*  ERROR:  ASA-E$ILLEGALPRIO-0
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:101  
     1278    18911              MESSAGE: PRIORITY legal only if USE=TP
     1279    18912        */
     1280    18913                    %SCREAM( ERR#=E$ILLEGALPRIO, LEVEL=ERROR, MID='A' );
     1281    18928    5               GOTO END_OPTION;
     1282    18929    5               END;
     1283    18930    4            BLK$=PTR$->P$NODE.SUBLK$(0) ;
     1284    18931    4            CALL CHARBIN (CNT,OUT$SYM.TEXT) ;
     1285    18932    5            IF CNT > 500 THEN DO;
     1286    18933        /*E*  ERROR:  ASA-E$PRIOTOOLARGE-0
     1287    18934              MESSAGE: PRIORITY too large
     1288    18935              MESSAGE1: Maximum PRIORITY is 500
     1289    18936        */
     1290    18937                    %SCREAM( ERR#=E$PRIOTOOLARGE, LEVEL=ERROR, MID='A' );
     1291    18952    5               END;
     1292    18953    4            ELSE KL$TREC.QQ_LOGON.PRIO = CNT ;
     1293    18954
     1294    18955    4            SELECT  ( 38  /* DEVICE INSTANCE  */ ) ;
     1295    18956    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
     1296    18957    4            IF TP_FLAG = AS_FALSE THEN
     1297    18958    5            DO;
     1298    18959        /*E*  ERROR:  ASA-E$ILLEGALINSTANCE-0
     1299    18960              MESSAGE:  INSTANCE legal only if USE=TP
     1300    18961        */
     1301    18962                    %SCREAM( ERR#=E$ILLEGALINSTANCE, LEVEL=ERROR, MID='A' );
     1302    18977    5               GOTO END_OPTION;
     1303    18978    5               END;
     1304    18979    5            IF OUT$SYM.CODE = 1 /* PACKSET_VAL */ THEN DO;
     1305    18980    5               PACKSET_NAME = OUT$SYM.TEXT;
     1306    18981    5               BLK$ = PTR$ -> P$NODE.SUBLK$(1);
     1307    18982    5               END;
     1308    18983    4            ELSE PACKSET_NAME = AS_BLANK ;
     1309    18984    5            IF OUT$SYM.COUNT > 8 THEN DO;
     1310    18985        /*E*  ERROR: ASA-E$INSTANCE_TOO_LONG-C
     1311    18986              MESSAGE: INSTANCE too long.
     1312    18987              MESSAGE1: INSTANCE can be at most 8 characters long.
     1313    18988        */
     1314    18989                    %SCREAM( ERR#=E$INSTANCE_TOO_LONG, MID='A', LEVEL=ERROR );
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:102  
     1315    19004    5               GOTO END_OPTION;
     1316    19005    5               END;
     1317    19006    4            KL$TREC.KC$CGID.ACCT# = OUT$SYM.TEXT ;
     1318    19007    4            KL$TREC.KC$CGID.NAME#.TXT = OUT$SYM.TEXT ;
     1319    19008    4            KL$TREC.KC$CGID.NAME#.CNT = OUT$SYM.COUNT ;
     1320    19009    4            INSTANCE_FLAG = AS_TRUE ;
     1321    19010    4            KL$TREC.KC$CGID.PSN# = PACKSET_NAME;
     1322    19011
     1323    19012    4            SELECT  ( 37  /* DEVICE COMMAND */ ) ;
     1324    19013    4            IF TYPE ~='CG'
     1325    19014    4            THEN
     1326    19015    5            DO ;
     1327    19016        /*E*  ERROR:  ASA-E$CMDILLEGAL-C
     1328    19017              MESSAGE: CMD legal only if USE=TP OR USE=CG
     1329    19018        */
     1330    19019                    %SCREAM( ERR#=E$CMDILLEGAL, LEVEL=ERROR, MID='A' );
     1331    19034    5               GOTO END_OPTION;
     1332    19035    5               END;
     1333    19036    4            BLK$ = PTR$->P$NODE.SUBLK$(0) ;
     1334    19037    4            IF BLK$ -> OUT$SYM.CODE = 7   /*  NONE_VAL  */
     1335    19038    5            THEN DO;
     1336    19039    5               CNT = 0;
     1337    19040    5               COMMAND = ' ';
     1338    19041    5               END;
     1339    19042    5            ELSE DO;
     1340    19043    5               CNT =OUT$SYM.COUNT ;
     1341    19044    5               COMMAND = OUT$SYM.TEXT;
     1342    19045    5               END;
     1343    19046    4            IF CNT>80 THEN
     1344    19047    5            DO ;
     1345    19048        /*E*  ERROR: ASA-E$CMDTOOBIG-C
     1346    19049              MESSAGE: Command is too long.
     1347    19050              MESSAGE1: Command is limited to 80 characters
     1348    19051        */
     1349    19052                    %SCREAM( ERR#=E$CMDTOOBIG , LEVEL=ERROR, MID='A' );
     1350    19067    5               GOTO END_OPTION ;
     1351    19068    5               END ;            /* Then do                            */
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:103  
     1352    19069    4            IF DEV_USE = 48 /* TP */ THEN
     1353    19070    5            DO ;
     1354    19071    5               KL$TREC.QQ_LOGON.CMD = COMMAND;
     1355    19072    5               KL$TREC.QQ_LOGON.CMDCNT = CNT;
     1356    19073    5               END; /*  Do  */
     1357    19074    4            ELSE
     1358    19075    4               IF DEV_USE = 49 /* COM GROUP  */ THEN
     1359    19076    5               DO ;
     1360    19077    5                  KL$TREC.B_CGAUINFO.UCMD = COMMAND;
     1361    19078    5                  KL$TREC.B_CGAUINFO.UCMDCNT = CNT;
     1362    19079    5                  END ; /*  Do  */
     1363    19080
     1364    19081
     1365    19082    4            SELECT  (44  /* DEVICE COMGROUP  */ ) ;
     1366    19083    4            BLK$ = PTR$->P$NODE.SUBLK$(0) ;
     1367    19084    4            FIDFPT.TEXTFID_ = VECTOR(OUT$SYM.TEXT) ;
     1368    19085    4            CALL M$FID(FIDFPT) ALTRET(BAD_FID) ;
     1369    19086    4            IF ASN_VAL ~= %COMGROUP# THEN GOTO BAD_FID ;
     1370    19087    4            GROUP_FLAG = AS_TRUE ;
     1371    19088    4            KL$TREC.KC$CGID.NAME#.CNT = NAMEVLP.L# ;
     1372    19089    4            KL$TREC.KC$CGID.NAME#.TXT = NAMEVLP.NAME# ;
     1373    19090    4            IF (FID_VLR.ACCT=AS_FALSE) OR (ACCTVLP.ACCT#=' ') THEN
     1374    19091    4               KL$TREC.KC$CGID.ACCT# = ':SYS' ;
     1375    19092    4            ELSE
     1376    19093    4               KL$TREC.KC$CGID.ACCT# = ACCTVLP.ACCT# ;
     1377    19094    4            IF NOT FID_VLR.SN THEN
     1378    19095    4               KL$TREC.KC$CGID.PSN# = AS_BLANK ;
     1379    19096    4            ELSE KL$TREC.KC$CGID.PSN# = SNVLP.SN#(0) ;
     1380    19097    4            GOTO END_OPTION ;
     1381    19098    4   BAD_FID : ;
     1382    19099        /*E*  ERROR:  ASA-E$BADCGFID-0
     1383    19100              MESSAGE:  Bad or illegal fid.
     1384    19101              MESSAGE1: Syntax: CG [#psn] [/ [name] [. [account] [. [password]]]]
     1385    19102        */
     1386    19103                 %SCREAM( ERR#=E$BADCGFID, LEVEL=ERROR, MID='A' );
     1387    19118    4            GOTO END_OPTION;
     1388    19119
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:104  
     1389    19120    4            SELECT (50  /* DEVICE USER1  */,
     1390    19121    4                 51  /* DEVICE USER2  */,
     1391    19122    4                 52  /* DEVICE USER3  */,
     1392    19123    4                 53  /* DEVICE USER4  */ ) ;
     1393    19124                                                   /**/
     1394    19125    4            BLK$ = PTR$->P$NODE.SUBLK$(0) ;
     1395    19126    4            CALL CHARBIN(CNT,OUT$SYM.TEXT) ;
     1396    19127    4            CODE2 = CODE ;
     1397    19128    5            DO SELECT (CODE2);
     1398    19129    5               SELECT(50  /* DEVICE USER1  */) ;
     1399    19130    5               KL$TREC.B_CGAUINFO.USER1 = CNT ;
     1400    19131    5               SELECT(51  /* DEVICE USER2  */) ;
     1401    19132    5               KL$TREC.B_CGAUINFO.USER2 = CNT ;
     1402    19133    5               SELECT(52  /* DEVICE USER3  */) ;
     1403    19134    5               KL$TREC.B_CGAUINFO.USER3 = CNT ;
     1404    19135    5               SELECT(53  /* DEVICE USER4  */) ;
     1405    19136    5               KL$TREC.B_CGAUINFO.USER4 = CNT ;
     1406    19137    5               END; /*  Do CODE2  */
     1407    19138
     1408    19139    4            SELECT ( 29 /*DEV_DFPRIO*/ );
     1409    19140    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR ;
     1410    19141    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
     1411    19142    4            CALL CHARBIN( CNT, OUT$SYM.TEXT ) ;
     1412    19143    4            IF CNT > 15
     1413    19144    4            THEN
     1414    19145    5            DO ;
     1415    19146        /*E*  ERROR:    ASA-E$DEVDPRIO-C
     1416    19147              MESSAGE:  DEFPRIO too big.
     1417    19148              MESSAGE1: DEFPRIO cannot exceed 15.
     1418    19149        */
     1419    19150                    %SCREAM( ERR#=E$DEVDPRIO , LEVEL=ERROR, MID='A' );
     1420    19165    5               GOTO END_OPTION ;
     1421    19166    5               END ;               /* Then do                            */
     1422    19167    4            KL$TREC.ISINFO.DFLTPRI=CNT;
     1423    19168
     1424    19169    4            SELECT ( 54 /* DEVICE NO CG */ ) ;
     1425    19170    4            IF TYPE ~='CG'
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:105  
     1426    19171    4            THEN
     1427    19172    5            DO ;
     1428    19173        /*E*  ERROR:   ASA-E$NOCGILLEGAL-C
     1429    19174              MESSAGE: NOCG legal only if USE=TP or USE=CG
     1430    19175        */
     1431    19176                    %SCREAM( ERR#=E$NOCGILLEGAL, LEVEL=ERROR, MID='A' );
     1432    19191    5               GOTO END_OPTION;
     1433    19192    5               END;
     1434    19193    4            CODE2 = PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE ;
     1435    19194    5            DO SELECT ( CODE2 ) ;
     1436    19195    5               SELECT( 1 /* REJECT VALUE */ ) ;
     1437    19196    5               KL$TREC.FLAGS.NOCGREJ = '1'B;
     1438    19197    5               KL$TREC.FLAGS.NOCGINF = '0'B;
     1439    19198    5               SELECT ( 2 /* INFORM VALUE */ ) ;
     1440    19199    5               KL$TREC.FLAGS.NOCGINF = '1'B;
     1441    19200    5               KL$TREC.FLAGS.NOCGREJ = '0'B;
     1442    19201    5               SELECT ( 3 /* OK VALUE */) ;
     1443    19202    5               KL$TREC.FLAGS.NOCGINF = '0'B;
     1444    19203    5               KL$TREC.FLAGS.NOCGREJ = '0'B;
     1445    19204    5               END; /* Do CODE2  */
     1446    19205                                                                                    /**/
     1447    19206    4            SELECT ( 31 /*DEV_NCTL*/);
     1448    19207    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR ;
     1449    19208    4            IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE=1   /*  YES_VAL  */ THEN
     1450    19209    4               KL$TREC.ISINFO.NCTL=AS_TRUE;
     1451    19210    5            ELSE DO;
     1452    19211    5               KL$TREC.ISINFO.NCTL = AS_FALSE;
     1453    19212    5               KL$TREC.ISINFO.NCTLFID = AS_FALSE;
     1454    19213    5               KL$TREC.ISINFO.NFID = ' ';
     1455    19214    5               END;
     1456    19215
     1457    19216    4            SELECT  (32 /*DEV_NCOK*/ );
     1458    19217    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR ;
     1459    19218    4            IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE=1   /*  YES_VAL  */ THEN
     1460    19219    4               KL$TREC.ISINFO.NCTLOK=AS_TRUE;
     1461    19220    4            ELSE
     1462    19221    4               KL$TREC.ISINFO.NCTLOK=AS_FALSE;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:106  
     1463    19222
     1464    19223    4            SELECT (35 /*DEV_NCACCT*/);
     1465    19224    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR ;
     1466    19225    4            BLK$=PTR$->P$NODE.SUBLK$(0);
     1467    19226    5            IF OUT$SYM.COUNT > 8 THEN DO;
     1468    19227        /*E* ERROR:   ASA-E$NCACCT_TOO_LONG-C
     1469    19228             MESSAGE: NCACCT name is too long.
     1470    19229             MESSAGE1: NCACCT name can be at most 8 characters long.
     1471    19230        */
     1472    19231                    %SCREAM( ERR#=E$NCACCT_TOO_LONG, LEVEL=ERROR, MID='A' );
     1473    19246    5               GOTO END_OPTION;
     1474    19247    5               END;
     1475    19248    4            KL$TREC.ISINFO.NCACCT=OUT$SYM.TEXT ;
     1476    19249
     1477    19250    4            SELECT (34 /*DEV_NCFID_VAL*/);
     1478    19251
     1479    19252    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR ;
     1480    19253    5            IF PTR$->P$NODE.CODE = 7   /*  NONE_VAL  */ THEN DO;
     1481    19254    5               KL$TREC.ISINFO.NFID = ' ';
     1482    19255    5               KL$TREC.ISINFO.NCTLFID = %NO#;
     1483    19256    5               GOTO END_OPTION;
     1484    19257    5               END;  /*  None  */
     1485    19258    4            BLK$=PTR$->P$NODE.SUBLK$(0);
     1486    19259    5            IF OUT$SYM.COUNT > 80 THEN DO;
     1487    19260        /*E* ERROR:   ASA-E$NCFID_TOO_LONG-C
     1488    19261             MESSAGE: NCFID name is too long.
     1489    19262             MESSAGE1: NCFID name can be at most 80 characters long.
     1490    19263        */
     1491    19264                    %SCREAM( ERR#=E$NCFID_TOO_LONG, LEVEL=ERROR, MID='A' );
     1492    19279    5               GOTO END_OPTION;
     1493    19280    5               END;
     1494    19281    4            KL$TREC.ISINFO.NFID=OUT$SYM.TEXT;
     1495    19282    4            KL$TREC.ISINFO.NCTLFID = %YES#;
     1496    19283
     1497    19284    4            SELECT (27 /*DEV_UPL*/);
     1498    19285        /*E* ERROR: ASA-E$DEVONLYOUT-0
     1499    19286             MESSAGE: UPLOCKED is legal only if USE=OUTSYM
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:107  
     1500    19287        */
     1501    19288    5            IF DEV_USE ~= DEV_OUT_VAL THEN DO;
     1502    19289                    %SCREAM( ERR#=E$DEVONLYOUT, LEVEL=ERROR, MID='A' );
     1503    19304    5               GOTO END_OPTION;
     1504    19305    5               END;
     1505    19306    4            IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE=1   /*  YES_VAL  */ THEN
     1506    19307    4               KL$TREC.OSINFO.UPLOCKED = AS_TRUE;
     1507    19308    4            ELSE
     1508    19309    4               KL$TREC.OSINFO.UPLOCKED = AS_FALSE;
     1509    19310
     1510    19311    4            SELECT (28 /*DEV_FORM*/);
     1511    19312    5            IF DEV_USE ~= DEV_OUT_VAL THEN DO;
     1512    19313        /*E* ERROR: ASA-E$FORMONLYOUT-0
     1513    19314             MESSAGE: FORM is only legal if USE=OUTSYM.
     1514    19315             MESSAGE1: To specify a FORM, the USE parameter must = OUTSYM.
     1515    19316        */
     1516    19317                    %SCREAM( ERR#=E$FORMONLYOUT, LEVEL=ERROR, MID='A' );
     1517    19332    5               GOTO END_OPTION;
     1518    19333    5               END;
     1519    19334    4            BLK$=PTR$->P$NODE.SUBLK$(0);
     1520    19335    5            IF OUT$SYM.COUNT > 6 THEN DO;
     1521    19336        /*E* ERROR:   ASA-E$FORM_NAME_TOO_LONG-C
     1522    19337             MESSAGE: FORM name is too long.
     1523    19338             MESSAGE1: FORM name can be at most 6 characters long.
     1524    19339        */
     1525    19340                    %SCREAM( ERR#=E$FORM_NAME_TOO_LONG, LEVEL=ERROR, MID='A');
     1526    19355    5               GOTO END_OPTION;
     1527    19356    5               END;
     1528    19357    4            IF OUT$SYM.TEXT = 'NONE' THEN
     1529    19358    4               KL$TREC.OSINFO.FNAME=ZERO_ACCNT;
     1530    19359    4            ELSE
     1531    19360    4               KL$TREC.OSINFO.FNAME=OUT$SYM.TEXT;
     1532    19361    4            FORM$ = ADDR(FORM_BUF);
     1533    19362    4            USERS_KEY.COUNT=6;
     1534    19363    4            USERS_KEY.TXTC = OUT$SYM.TEXT;
     1535    19364    4            FORM_ARS = LENGTHC(FORM_BUF);
     1536    19365    4            CALL ASF$READ_FORM(USERS_KEY,FORM$,FORM_ARS)
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:108  
     1537    19366    5            WHENALTRETURN DO;
     1538    19367    5               IF MERR_CODE.CODE = %E$NOKEY
     1539    19368    6               THEN DO;
     1540    19369                       /*E*  ERROR: ASA-E$FNOEXIST-0
     1541    19370                             MESSAGE: Warning: Form %%U1 %does not exist.
     1542    19371                       */
     1543    19372    6                  CALL INDEX( I, AS_BLANK, USERS_KEY.TXTC );
     1544    19373    6                  AS_FIELD1.COUNT = I ;
     1545    19374    6                  AS_FIELD1.TEXT = USERS_KEY.TXTC ;
     1546    19375                       %SCREAM( ERR#=E$FNOEXIST, LEVEL=WARN, MID='A' );
     1547    19390    6                  END;  /*  Error is no key  */
     1548    19391    5               GOTO END_OPTION ;
     1549    19392    5               END; /*  Whenaltreturn  */
     1550    19393
     1551    19394    4            SELECT ( %DEV_DEVNUM_VAL ) ;
     1552    19395
     1553    19396    5            IF NOT SUB THEN DO;
     1554    19397                    %SCREAM (ERR#=%E$DEVNUMNOTLEGL,LEVEL=ERROR,MID='A');
     1555    19412    5               GOTO END_OPTION;
     1556    19413    5               END; /*  Not sub  */
     1557    19414
     1558    19415    5            DO SELECT( PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE ) ;
     1559    19416
     1560    19417    5               SELECT( %PD_2780LP_VAL ) ;
     1561    19418    5               KL$DADR.DEVNUM# = %KLDN_2780LP# ;
     1562    19419
     1563    19420    5               SELECT( %PD_2780CR_VAL ) ;
     1564    19421    5               KL$DADR.DEVNUM# = %KLDN_2780CR# ;
     1565    19422
     1566    19423    5               SELECT( %PD_2780CP_VAL ) ;
     1567    19424    5               KL$DADR.DEVNUM# = %KLDN_2780CP# ;
     1568    19425
     1569    19426    5               SELECT( %PD_3780LP_VAL ) ;
     1570    19427    5               KL$DADR.DEVNUM# = %KLDN_3780LP# ;
     1571    19428
     1572    19429    5               SELECT( %PD_3780CR_VAL ) ;
     1573    19430    5               KL$DADR.DEVNUM# = %KLDN_3780CR# ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:109  
     1574    19431
     1575    19432    5               SELECT( %PD_3780CP_VAL ) ;
     1576    19433    5               KL$DADR.DEVNUM# = %KLDN_3780CP# ;
     1577    19434
     1578    19435    5               SELECT( %PD_HASPOC_VAL ) ;
     1579    19436    5               KL$DADR.DEVNUM# = %KLDN_HASPOC# ;
     1580    19437    5               KL$DADR.SDNUM# = %KLDN_HASPOCS# ;
     1581    19438    5               KL$DADR.DEVCTL.T = '0'B ;
     1582    19439    5               KL$DADR.DEVCTL.B = %KLDCB_HASPOC# ;
     1583    19440
     1584    19441    5               SELECT( %PD_HASPLP_VAL ) ;
     1585    19442    5               KL$DADR.DEVNUM#  = %KLDN_HASPLP# ;
     1586    19443    5               KL$DADR.DEVCTL.T = %KLDCT_HASPLP# ;
     1587    19444    5               KL$DADR.DEVCTL.B ='0'B ;
     1588    19445
     1589    19446    5               SELECT( %PD_HASPCR_VAL ) ;
     1590    19447    5               KL$DADR.DEVNUM# = %KLDN_HASPCR# ;
     1591    19448    5               KL$DADR.DEVCTL.T = '0'B ;
     1592    19449    5               KL$DADR.DEVCTL.B = %KLDCB_HASPCR# ;
     1593    19450
     1594    19451    5               SELECT( %PD_HASPCP_VAL ) ;
     1595    19452    5               KL$DADR.DEVNUM# = %KLDN_HASPCP# ;
     1596    19453    5               KL$DADR.DEVCTL.T = '0'B ;
     1597    19454    5               KL$DADR.DEVCTL.B = %KLDCB_HASPCP# ;
     1598    19455
     1599    19456    5               SELECT( %PD_HASPLP2_VAL ) ;
     1600    19457    5               KL$DADR.DEVNUM#  = %KLDN_HASPLP2# ;
     1601    19458    5               KL$DADR.DEVCTL.T = %KLDCT_HASPLP2# ;
     1602    19459    5               KL$DADR.DEVCTL.B ='0'B ;
     1603    19460
     1604    19461    5               SELECT( %PD_HASPLP3_VAL ) ;
     1605    19462    5               KL$DADR.DEVNUM# = %KLDN_HASPLP3# ;
     1606    19463    5               KL$DADR.DEVCTL.T = %KLDCT_HASPLP3# ;
     1607    19464    5               KL$DADR.DEVCTL.B = '0'B ;
     1608    19465
     1609    19466    5               SELECT( %PD_IBMCR_VAL ) ;
     1610    19467    5               KL$DADR.DEVNUM# = %KLDN_IBMCR# ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:110  
     1611    19468    5               KL$DADR.DEVCTL.T = %KLDCT_IBMCR# ;
     1612    19469    5               KL$DADR.DEVCTL.B = '0'B ;
     1613    19470
     1614    19471    5               SELECT( 22 /* HEX */ ) ;
     1615    19472    5               OPTION.COUNT = 7;
     1616    19473    5               OPTION.TEXT = 'DEVNUM ';
     1617    19474    5               CALL ASB$GET_HEX_VAL( 1, HEX, PTR$, OPTION ) ALTRET( END_OPTION );
     1618    19475    5               KL$DADR.DEVNUM# = BINBIT( HEX(1), 9 );
     1619    19476
     1620    19477    5               END ; /* Do case( CODE2 ) */
     1621    19478    4            DEVNUM_SET = %YES#;
     1622    19479
     1623    19480    4            SELECT ( %DEV_SDNUM_VAL ) ;
     1624    19481    5            IF NOT SUB THEN DO;
     1625    19482                    %SCREAM (ERR#=%E$SDNUMNOTLEGL,LEVEL=ERROR,MID='A');
     1626    19497    5               GOTO END_OPTION;
     1627    19498    5               END; /*  Not sub  */
     1628    19499
     1629    19500    4            OPTION.COUNT = 6;
     1630    19501    4            OPTION.TEXT = 'SDNUM ';
     1631    19502    4            CALL ASB$GET_HEX_VAL( 1, HEX, PTR$, OPTION ) ALTRET( END_OPTION );
     1632    19503    4            KL$DADR.SDNUM# = BINBIT( HEX(1), 9 );
     1633    19504
     1634    19505    4            SELECT ( %DEV_DEVCTL_VAL ) ;
     1635    19506    5            IF NOT SUB THEN DO;
     1636    19507                    %SCREAM (ERR#=%E$SDNUMNOTLEGL,LEVEL=ERROR,MID='A');
     1637    19522    5               GOTO END_OPTION;
     1638    19523    5               END; /*  Not sub  */
     1639    19524
     1640    19525    4            OPTION.TEXT = 'DEVCTL ';
     1641    19526    4            OPTION.COUNT = 7;
     1642    19527    4            CALL ASB$GET_HEX_VAL ( 1, HEX, PTR$, OPTION ) ALTRET( END_OPTION );
     1643    19528    4            SPLIT.T = HEX(1);
     1644    19529    4            SPLIT.B = HEX(2);
     1645    19530    4            KL$DADR.DEVCTL = SPLIT;
     1646    19531    4            DEVCTL_SET = %YES#;
     1647    19532
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:111  
     1648    19533    4            SELECT ( %DEV_MODE_VAL ) ;
     1649    19534    5            IF NOT (DEV_USE = 47 /* RESOURCE */ OR TYPE = 'CL') THEN DO;
     1650    19535        /*E*  ERROR:  ASA-E$MODE_NOTLEGAL-0
     1651    19536             MESSAGE:  The MODE option is not legal here.
     1652    19537             MESSAGE1:  Mode is legal only for a resource CL device.
     1653    19538        */
     1654    19539                    %SCREAM (ERR#=%E$MODE_NOTLEGAL,LEVEL=ERROR,MID='A');
     1655    19554    5               GOTO END_OPTION;
     1656    19555    5               END; /* Not res device, type cl  */
     1657    19556
     1658    19557    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
     1659    19558    4            KL$TREC.RES_DEV.MODE = BLK$ -> P$NODE.CODE;
     1660    19559
     1661    19560    4            SELECT ( %DEV_RNAME_VAL ) ;
     1662    19561    5            IF NOT (DEV_USE = 47 /* RESOURCE */ AND TYPE = 'CL') THEN DO;
     1663    19562        /*E*  ERROR:  ASA-E$RNAME_NOTLEGAL-0
     1664    19563             MESSAGE:  The RNAME option is not legal here.
     1665    19564             MESSAGE1:  Rname is legal only for a resource CL device.
     1666    19565        */
     1667    19566                    %SCREAM (ERR#=%E$RNAME_NOTLEGAL,LEVEL=ERROR,MID='A');
     1668    19581    5               GOTO END_OPTION;
     1669    19582    5               END; /*  Not res device, type cl  */
     1670    19583
     1671    19584    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
     1672    19585    4            KL$TREC.RES_DEV.RNAME = OUT$SYM.TEXT ;
     1673    19586
     1674    19587    4            SELECT ( %DEV_AUACCOUNT_VAL ) ;
     1675    19588    5            IF NOT (DEV_USE = 47 /* RESOURCE */ AND TYPE = 'CL') THEN DO;
     1676    19589        /*E*  ERROR:  ASA-E$AUACCT_NOTLEGAL-0
     1677    19590             MESSAGE:  The AUACCT option is not legal here.
     1678    19591             MESSAGE1:  Auacct is legal only for a resource CL device.
     1679    19592        */
     1680    19593                    %SCREAM (ERR#=%E$AUACCT_NOTLEGAL,LEVEL=ERROR,MID='A');
     1681    19608    5               GOTO END_OPTION;
     1682    19609    5               END; /*  Not res device, type cl  */
     1683    19610
     1684    19611    4            BLK$ = PTR$ ->P$NODE.SUBLK$(0);
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:112  
     1685    19612    4            KL$TREC.RES_DEV.AUACCOUNT = OUT$SYM.TEXT ;
     1686    19613
     1687    19614    4            SELECT ( %DEV_ATTR_VAL ) ;
     1688    19615    5            IF NOT (DEV_USE = 47 /* RESOURCE */ AND TYPE = 'CL') THEN DO;
     1689    19616        /*E*  ERROR:  ASA-E$ATTR_NOTLEGAL-0
     1690    19617             MESSAGE:  The %U1 option is not legal here.
     1691    19618             MESSAGE1:  %U1 is legal only for a resource CL device.
     1692    19619        */
     1693    19620                    %SCREAM (ERR#=%E$ATTR_NOTLEGAL,LEVEL=ERROR,MID='A');
     1694    19635    5               GOTO END_OPTION;
     1695    19636    5               END; /*  Not res device, type cl  */
     1696    19637
     1697    19638    4            PTR$ = PTR$ -> P$NODE.SUBLK$(0) ;
     1698    19639    4            CODE = PTR$ -> P$NODE.CODE ;
     1699    19640    4            IF PTR$ -> P$NODE.SUBNODES = 0 THEN
     1700    19641    4               YES_NO_FLG = %YES#;
     1701    19642    5            ELSE DO;
     1702    19643    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
     1703    19644    5               IF BLK$ -> P$NODE.CODE = 1   /*  YES_VAL  */ THEN
     1704    19645    5                  YES_NO_FLG = %YES#;
     1705    19646    5               ELSE
     1706    19647    5                  YES_NO_FLG = %NO#;
     1707    19648    5               END;                     /*Else do*/
     1708    19649    5            DO SELECT ( CODE ) ;
     1709    19650
     1710    19651    5               SELECT (%DEV_B300_VAL);
     1711    19652
     1712    19653    5               KL$TREC.RES_DEV.ATTR.B300# = YES_NO_FLG;
     1713    19654
     1714    19655    5               SELECT (%DEV_B1200_VAL);
     1715    19656
     1716    19657    5               KL$TREC.RES_DEV.ATTR.B1200# = YES_NO_FLG;
     1717    19658
     1718    19659    5               SELECT (%DEV_B2400_VAL);
     1719    19660
     1720    19661    5               KL$TREC.RES_DEV.ATTR.B2400# = YES_NO_FLG;
     1721    19662
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:113  
     1722    19663    5               SELECT (%DEV_HAYES_VAL);
     1723    19664
     1724    19665    5               KL$TREC.RES_DEV.ATTR.HAYES# = YES_NO_FLG;
     1725    19666
     1726    19667    5               SELECT (%DEV_X28_VAL);
     1727    19668
     1728    19669    5               KL$TREC.RES_DEV.ATTR.X28# = YES_NO_FLG;
     1729    19670
     1730    19671    5               SELECT (%DEV_RFU1_VAL);
     1731    19672
     1732    19673    5               KL$TREC.RES_DEV.ATTR.RFU1# = YES_NO_FLG;
     1733    19674
     1734    19675    5               SELECT (%DEV_RFU2_VAL);
     1735    19676
     1736    19677    5               KL$TREC.RES_DEV.ATTR.RFU2# = YES_NO_FLG;
     1737    19678
     1738    19679    5               SELECT (%DEV_RFU3_VAL);
     1739    19680
     1740    19681    5               KL$TREC.RES_DEV.ATTR.RFU3# = YES_NO_FLG;
     1741    19682
     1742    19683    5               SELECT (%DEV_RFU4_VAL);
     1743    19684
     1744    19685    5               KL$TREC.RES_DEV.ATTR.RFU4# = YES_NO_FLG;
     1745    19686
     1746    19687    5               SELECT (%DEV_RFU5_VAL);
     1747    19688
     1748    19689    5               KL$TREC.RES_DEV.ATTR.RFU5# = YES_NO_FLG;
     1749    19690
     1750    19691    5               SELECT (%DEV_RFU6_VAL);
     1751    19692
     1752    19693    5               KL$TREC.RES_DEV.ATTR.RFU6# = YES_NO_FLG;
     1753    19694
     1754    19695    5               SELECT (%DEV_RFU7_VAL);
     1755    19696
     1756    19697    5               KL$TREC.RES_DEV.ATTR.RFU7# = YES_NO_FLG;
     1757    19698
     1758    19699    5               SELECT (%DEV_RFU8_VAL);
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:114  
     1759    19700
     1760    19701    5               KL$TREC.RES_DEV.ATTR.RFU8# = YES_NO_FLG;
     1761    19702
     1762    19703    5               SELECT (%DEV_RFU9_VAL);
     1763    19704
     1764    19705    5               KL$TREC.RES_DEV.ATTR.RFU9# = YES_NO_FLG;
     1765    19706
     1766    19707    5               SELECT (%DEV_RFU10_VAL);
     1767    19708
     1768    19709    5               KL$TREC.RES_DEV.ATTR.RFU10# = YES_NO_FLG;
     1769    19710
     1770    19711    5               SELECT (%DEV_RFU11_VAL);
     1771    19712
     1772    19713    5               KL$TREC.RES_DEV.ATTR.RFU11# = YES_NO_FLG;
     1773    19714
     1774    19715    5               SELECT (%DEV_TCPIP_VAL);
     1775    19716
     1776    19717    5               KL$TREC.RES_DEV.ATTR.TCPIP# = YES_NO_FLG;
     1777    19718
     1778    19719    5               SELECT (%DEV_RFU13_VAL);
     1779    19720
     1780    19721    5               KL$TREC.RES_DEV.ATTR.RFU13# = YES_NO_FLG;
     1781    19722
     1782    19723    5               END;                     /*Do case code  */
     1783    19724    4            END;                     /*Do case*/
     1784    19725    3   END_OPTION: ;
     1785    19726    3         END;                      /* Do i                               */
     1786    19727    2      END DEV_LOOP ;               /* Do while                           */
     1787    19728
     1788    19729    1   KL$TWSNREC.DEVS.PNAME(TWSN_INDEX) = KL$TREC.PNAME;
             19729            /* Put profile into twsn record */
     1789    19730
     1790    19731    1   IF TYPE = AS_BLANK OR DEV_USE = 0 THEN
     1791    19732    2   DO ;
     1792    19733        /*E* ERROR: ASA-E$DEVMIN-0
     1793    19734             MESSAGE: Required parameters missing.
     1794    19735             MESSAGE1: You must specify USE and TYPE.
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:115  
     1795    19736             MESSAGE2: Device not created.
     1796    19737        */
     1797    19738           %SCREAM( ERR#=E$DEVMIN, LEVEL=ERROR, MID='A' );
     1798    19753    2      MORE=AS_TRUE;
     1799    19754    2      ALTRETURN;
     1800    19755    2      END;
     1801    19756    1   IF SUB AND (TYPE='CG') AND (NOT PRO_FLAG) THEN
     1802    19757    2   DO ;
     1803    19758        /*E*  ERROR: ASA-E$NOPROFILE
     1804    19759              MESSAGE:  A PROFILE must be specified for this TERMINAL DEVICE.
     1805    19760              MESSAGE1: There is no default PROFILE for this TERMINAL DEVICE.
     1806    19761              MESSAGE2: Device not created.
     1807    19762        */
     1808    19763           %SCREAM( ERR#=E$NOPROFILE, LEVEL=ERROR, MID='A' );
     1809    19778    2      MORE=AS_TRUE ;
     1810    19779    2      ALTRETURN;
     1811    19780    2      END;
     1812    19781    1   IF TP_FLAG AND NOT INSTANCE_FLAG THEN
     1813    19782    2   DO ;
     1814    19783        /*E*  ERROR:  ASA-E$NEEDINSTANCE-0
     1815    19784              MESSAGE:  You must specify INSTANCE if USE=TP
     1816    19785              MESSAGE1:  Device not created.
     1817    19786        */
     1818    19787           %SCREAM( ERR#=E$NEEDINSTANCE, LEVEL=ERROR, MID='A' );
     1819    19802    2      MORE=AS_TRUE ;
     1820    19803    2      ALTRETURN;
     1821    19804    2      END;
     1822    19805    1   IF CG_FLAG AND NOT GROUP_FLAG THEN
     1823    19806    2   DO;
     1824    19807        /*E*  ERROR:  ASA-E$NEEDCOMGROUP-0
     1825    19808              MESSAGE:  You must specify COMGROUP if USE=CG
     1826    19809              MESSAGE1:  Device not created.
     1827    19810        */
     1828    19811           %SCREAM( ERR#=E$NEEDCOMGROUP, LEVEL=ERROR, MID='A' );
     1829    19826    2      MORE=AS_TRUE ;
     1830    19827    2      ALTRETURN;
     1831    19828    2      END;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:116  
     1832    19829    2   IF SUB AND KL$TREC.PNAME.TXT ~= ' ' THEN DO;
     1833    19830    2      PRO$ = ADDR(PRO_BUF);
     1834    19831    2      ARS=LENGTHC(PRO_BUF);
     1835    19832    2      USERS_KEY.COUNT=KL$TREC.PNAME.CNT;
     1836    19833    2      USERS_KEY.TXTC=KL$TREC.PNAME.TXT;
     1837    19834    2      CALL ASD$READ_PRO (USERS_KEY,KL$PHDR,ARS)
     1838    19835    3      WHENALTRETURN DO;
     1839    19836        /*E* ERROR: ASA-E$MUSTPRO-0
     1840    19837             MESSAGE: You must specify a profile name for this device
     1841    19838             MESSAGE1: Device not created.
     1842    19839        */
     1843    19840              %SCREAM( ERR#=E$MUSTPRO, LEVEL=ERROR, MID='A' );
     1844    19855    3         MORE=AS_TRUE;
     1845    19856    3         ALTRETURN;
     1846    19857    3         END; /*  Whenaltreturn  */
     1847    19858    3      IF KL$PHDR.TTYP ~= %KLTY_SDEV# THEN DO;
     1848    19859              %SCREAM( ERR#=E$DEVPROTYPE, LEVEL=ERROR, MID='A' );
     1849    19874    3         MORE=AS_TRUE;
     1850    19875    3         GOTO DEV_LOOP;
     1851    19876    3         END;
     1852    19877    2      PATTR=KL$PHDR.ATTR;
     1853    19878    2      IO=KL$PHDR.IO;
     1854    19879    2      DDEV=KL$PHDR.DDEV;
     1855    19880    2      END;
     1856    19881                                                /* Restore P_PCB                      */
     1857    19882    1   P_PCB.WORK$ = WORK$ ;
     1858    19883    1   P_PCB.WKSZ = WKSZ ;
     1859    19884    1   P_PCB.WK_USED = WK_USED ;
     1860    19885    1   P_PCB.ROOT$ = ROOT$ ;
     1861    19886                                                /* Restore NODE$                      */
     1862    19887    1   NODE$ = T_NODE$ ;
     1863    19888                                                                                    /**/
     1864    19889    2   IF SUB OR TYPE ~= 'CG' THEN DO;       /* Build twsn record entry */
     1865    19890    2      KL$TWSNREC.DEVS.TYP(TWSN_INDEX)  = TYPE ;
     1866    19891    2      KL$TWSNREC.DEVS.NUM(TWSN_INDEX)  = NUM   ;
     1867    19892    2      KL$TWSNREC.DEVS.ATTR(TWSN_INDEX) = PATTR ;
     1868    19893    2      KL$TWSNREC.DEVS.IO(TWSN_INDEX)   = IO;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:117  
     1869    19894    2      KL$TWSNREC.DEVS.DDEV(TWSN_INDEX) = DDEV;
     1870    19895    2      KL$TWSNREC.DEVS.ACCT(TWSN_INDEX) = FROM_KEY.TEXT ;
     1871    19896    2      KL$TWSNREC.DEVS.TDEV(TWSN_INDEX) = '0'B;
     1872    19897    2      IF SUB THEN
     1873    19898    2         KL$TWSNREC.DEVS.TDEV(TWSN_INDEX) = '1'B;
     1874    19899    2      IF KL$TREC.SUPER = 6 /* OUTSYM DEVICE */ THEN
     1875    19900    2         KL$TWSNREC.DEVS.FNAME(TWSN_INDEX) = KL$TREC.OSINFO.FNAME;
     1876    19901    2      ELSE
     1877    19902    2         KL$TWSNREC.DEVS.FNAME(TWSN_INDEX) = ' ';
     1878    19903    2      KL$TWSNREC.DEVS.TERM(TWSN_INDEX) = ' ';
     1879    19904    2      END;
     1880    19905                                                  /* Build KL_TSS for terminal device */
     1881    19906    2   IF SUB THEN DO;
     1882    19907    2      SS.SGN.PNAME = KL$TREC.PNAME.TXT;
     1883    19908    2      SS.SGN.TYPE = TYPE;
     1884    19909    2      SS.SGN.NUM  = NUM;
     1885    19910    2      SS.SGN.TWSN = TWSNC;
     1886    19911    2      END;
     1887    19912    1   KL$TREC.NWINFO = LENGTHW(KL$TREC.KC$CGID) ;
     1888    19913    2   DO SELECT( DEV_USE );
     1889    19914    2      SELECT( 1   /*  YES_VAL  */ ) ;
     1890    19915    2      KL$TREC.NWINFO = KL$TREC.NWINFO+LENGTHW(KL$TREC.ISINFO);
     1891    19916
     1892    19917    2      SELECT( 2   /*  NO_VAL  */ ) ;
     1893    19918    2      KL$TREC.NWINFO = KL$TREC.NWINFO + LENGTHW(KL$TREC.OSINFO);
     1894    19919    2      OUT$DEV.OSINFO = KL$TREC.OSINFO;
     1895    19920
     1896    19921    2      SELECT( 47 /* RESOURCE */ ) ;
     1897    19922    3      IF DEV_USE = 47 /* RESOURCE */ AND SUBSTR (RES$DEV.RENAME,0,2) = 'CL' THEN DO;
     1898    19923    3         KL$TREC.NWINFO = LENGTHW (RES$DEV.RES_DEV);
     1899    19924    3         RES$DEV.RES_DEV = KL$TREC.RES_DEV;
     1900    19925    3         END;   /*  Res cl device  */
     1901    19926    2      ELSE
     1902    19927    2         KL$TREC.NWINFO = 0;
     1903    19928
     1904    19929    2      SELECT( 48 /* TP */ );
     1905    19930    2      KL$TREC.NWINFO = KL$TREC.NWINFO + LENGTHW(KL$TREC.QQ_LOGON) ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:118  
     1906    19931    2      TP$DEV.QQ_LOGON = KL$TREC.QQ_LOGON;
     1907    19932
     1908    19933    2      SELECT( 49 /* COM GROUP  */ );
     1909    19934    2      KL$TREC.NWINFO = KL$TREC.NWINFO + LENGTHW(KL$TREC.B_CGAUINFO) ;
     1910    19935    2      CG$DEV.B_CGAUINFO = KL$TREC.B_CGAUINFO ;
     1911    19936
     1912    19937    2      END ;   /* Do case( DEV_USE ); */
     1913    19938
     1914    19939    1   IF CREATE THEN
     1915    19940    2      IF SNAME_FLG THEN DO ;
     1916    19941    2         CALL INDEX( I, AS_BLANK, KL$TREC.RENAME ) ;
     1917    19942    2         CALL CONCAT( AS_CREATED_TEXT,'  ', SUBSTR(KL$TREC.RENAME,0,I), ' created.' ) ;
     1918    19943    2         END ;
     1919    19944    2      ELSE DO ;
     1920    19945    2         IF SUB OR DEV_USE < 48 /* TP */ THEN
     1921    19946    2            CALL CONCAT( AS_CREATED_TEXT, '  ', TYPE, NUM, ' created.' );
     1922    19947    3         ELSE DO ;
     1923    19948    3            CALL INDEX( I, AS_BLANK, SUBSTR(FROM_KEY.TEXT,0,8) ) ;
     1924    19949    3            CALL CONCAT( AS_CREATED_TEXT, '  ', SUBSTR(FROM_KEY.TEXT,0,I),
     1925    19950    3                 ' created.' ) ;
     1926    19951    3            END ;
     1927    19952    2         END ;
     1928    19953
     1929    19954    1   RETURN;
     1930    19955
     1931    19956
     1932    19957    1   DEV_IN_ERR: ;
     1933    19958        /*E* ERROR: ASA-E$DEVONLYIN-0
     1934    19959             MESSAGE: This option is legal only if USE=IN.
     1935    19960        */
     1936    19961        %SCREAM( ERR#=E$DEVONLYIN, LEVEL=ERROR, MID='A' );
     1937    19976    1   GOTO DEV_LOOP;
     1938    19977
     1939    19978                                                                                    /**/
     1940    19979    1   FIND_NUM_ERR: ;
     1941    19980    1   RETURN ;
     1942    19981
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:119  
     1943    19982    1   END ASA$DEV_OPTS;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:120  
--  Include file information  --

   QQ_SUPER_C.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   FI_MAC_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$DEV_OPTS.

   Procedure ASA$DEV_OPTS requires 3173 words for executable code.
   Procedure ASA$DEV_OPTS requires 1254 words of local(AUTO) storage.

    No errors detected in file ASA$DEVICE.:E05TSI    .

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:121  

 Object Unit name= ASA$DEV_OPTS                               File name= ASA$DEVICE.:E05TOU
 UTS= JUL 29 '97 08:35:54.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   DCB   even  none     0      0  M$UC
    2  RoData even  UTS    204    314  ASA$DEV_OPTS
    3   Data  even  none    52     64  ASA$DEV_OPTS
    4   Proc  even  none  3173   6145  ASA$DEV_OPTS
    5  RoData even  none    78    116  ASA$DEV_OPTS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        9  ASA$DEV_OPTS

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    3      0  TYPE
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:122  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$READ_SI
 yes     yes           Std       3 ASF$READ_FORM
         yes           Std       1 ASZ$SCRAMBLE
         yes           Std       2 ASH$ERROR
 yes     yes           Std       3 ASD$READ_PRO
         yes           Std       0 ASH$HELP
         yes           Std       0 ASH$QUEST
 yes     yes           Std       3 ASB$FIND_NUM
 yes     yes           Std       3 ASB$SET_PROMPT
 yes     yes           Std       1 X$PARSE
         yes           Std       0 ASH$DQUEST
         yes           Std       2 ASH$WARN
 yes     yes           Std       4 ASB$GET_HEX_VAL
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_TRUE                          r    AS_FALSE
r    AS_VALID_DEVICE_TYPE_CHARS       r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             AS_CREATED_TEXT
     FROM_KEY                              IN_BUF                                NODE$
     CODE                                  ERR_CODE                              AS_FIELD1
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     DSEG3$                                P_PCB                                 M$UC
     DEVICE_OPTS_LIST                      B_VECTNIL
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:123  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:124  


      407        1        /*T***********************************************************/
      408        2        /*T*                                                         */
      409        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      410        4        /*T*                                                         */
      411        5        /*T***********************************************************/
      412        6        /*P*    NAME:  ASA$DEV_OPTS
      413        7                PURPOSE: This module of SUPER processes the options of the
      414        8                         'CREATE DEVICE' command and the sub-options of
      415        9                         the 'CREATE TERMINAL' command, 'DEVICE' option.
      416       10                         It is called from ASA$DEVICE or ASA$TERMINAL.
      417       11                          The parameters are:
      418       12
      419       13                TREC$    A pointer to the device record (KL$DREC).
      420       14                TWSNR$   A pointer to the TWSN record.
      421       15                TWSNC    The terminal number, in text.
      422       16                CREATE   A bit that signifies if we are creating this device
      423       17                SUB      A bit that signifies that we are being called
      424       18                         from ASA$TERMINAL.
      425       19                TERM_T   The terminal type, used to set the default PROFILE.
      426       20                TWSN_INDEX    The TWSN record index for the device.
      427       21                              Valid only if CREATE=false.
      428       22                SS        A terminal sign-on structure for a terminal device.
      429       23                          Valid only if SUB=true.
      430       24                DADR$    A pointer to the place where the KL_DADR for this
      431       25                         subdevice is supposed to go.
      432       26        Note that this routine DOES NOT write the resulting device record.
      433       27        */
      434       28       ASA$DEV_OPTS: PROC(TREC$,TWSNR$,TWSNC,CREATE,SUB,TERM_T,TWSN_INDEX,SS,DADR$) ALTRET;

     28  4 000000   000000 700200 xent  ASA$DEV_OPTS TSX0  ! X66_AUTO_N
         4 000001   002346 000011                    ZERO    1254,9

      435       29                                                                                    /**/
      436       30        %SET LISTSUB = '1'B ;
      437       31        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:125  
      438       32        /*********************************************************************/
      439       33        /*   Include files   include files   include files   include files   */
      440       34        /*********************************************************************/
      441       35                                                                                    /**/
      442       36        %INCLUDE  AS_ENTRIES_M  ;
      443     1086        %INCLUDE  AS_PERR_C     ;
      444     1688        %INCLUDE  AS_SSUBS_C    ;
      445     1780        %INCLUDE  AS_SUBS_C     ;
      446     3194        %INCLUDE  AS_SUPER_C    ;
      447     3629        %INCLUDE  KL_SUPER_C    ;
      448     6531        %INCLUDE  XU_FORMAT_C   ;
      449     6693        %INCLUDE  XU_MACRO_C    ;
      450     9799        %INCLUDE  AS_MAC_C      ;
      451     9879        %INCLUDE  AS_SUPER_R    ;
      452    12895        %INCLUDE  B_ERRORS_C    ;
      453    14022        %INCLUDE  B_MACROS_C    ;
      454    14133        %INCLUDE  CP_6          ;
      455    14214        %INCLUDE  CP_6_SUBS     ;
      456    14754        %INCLUDE  FI_MAC_C      ;
      457    15124        %INCLUDE  FOO_MAC_C     ;
      458    15872        %INCLUDE  KC$CGBLK      ;
      459    15920        %INCLUDE  QQ_SUPER_C    ;
      460    15975        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:126  
      461    15976        /*********************************************************************/
      462    15977        /*   Parameters      parameters      parameters      paramaters      */
      463    15978        /*********************************************************************/
      464    15979                                                                                    /**/
      465    15980    1   DCL TREC$ PTR ;
      466    15981    1   DCL TWSNR$ PTR ;
      467    15982    1   DCL TWSNC CHAR(4) ;
      468    15983    1   DCL CREATE BIT(1) ALIGNED;
      469    15984    1   DCL SUB BIT(1) ALIGNED;
      470    15985    1   DCL TERM_T CHAR(7) ;
      471    15986    1   DCL TWSN_INDEX SBIN ;
      472    15987        %KL_SS (NAME=SS,STCLASS=PARAM);
      473    16022    1   DCL DADR$  PTR;
      474    16023
      475    16024        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:127  
      476    16025        /*********************************************************************/
      477    16026        /*   Auto data       auto data       auto data       auto data       */
      478    16027        /*********************************************************************/
      479    16028                                                                                    /**/
      480    16029    1   DCL ARS UBIN WORD ;
      481    16030    1   DCL BLK$ PTR ;
      482    16031    1   DCL CG_FLAG BIT(1) ;
      483    16032    1   DCL CNT UBIN WORD ;
      484    16033    1   DCL CODE2 UBIN WORD ;
      485    16034    1   DCL COMMAND CHAR(80);
      486    16035    1   DCL DDEV BIT(9);
      487    16036    1   DCL DEVCTL_SET BIT(1);
      488    16037    1   DCL DEVNUM_SET BIT(1);
      489    16038    1   DCL DEV_USE UBIN;
      490    16039    1   DCL FORM$ PTR;
      491    16040    1   DCL FORM_ARS UBIN WORD;
      492    16041    1   DCL FORM_BUF CHAR(3400);
      493    16042    1   DCL GROUP_FLAG BIT(1) ;
      494    16043    1   DCL HEX(0:255) UBIN BYTE UNAL;
      495    16044    1   DCL I UBIN WORD ;
      496    16045    1   DCL INSTANCE_FLAG BIT(1) ;
      497    16046    1   DCL 1 IO,
      498    16047    1          2 INPUT BIT(1),
      499    16048    1          2 OUTPUT BIT(1);
      500    16049    1   DCL J UBIN WORD ;
      501    16050    1   DCL K UBIN WORD ;
      502    16051    1   DCL L UBIN WORD ;
      503    16052    1   DCL MORE BIT(1) ;
      504    16053    1   DCL NUM CHAR(2) ;
      505    16054    1   DCL 1 OPTION,
      506    16055    1          2 COUNT UBIN BYTE CALIGNED,
      507    16056    1          2 TEXT  CHAR(31)  CALIGNED;
      508    16057    1   DCL PACKSET_NAME CHAR(6);
      509    16058    1   DCL PATTR BIT(18) ;
      510    16059    1   DCL PRO$ PTR ;
      511    16060    1   DCL PRO_BUF CHAR(1024 /* AS_PRO_BUF_SIZEC */);
      512    16061    1   DCL PRO_FLAG BIT(1) ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:128  
      513    16062    1   DCL PTR$ PTR ;
      514    16063    1   DCL P$ PTR;
      515    16064    1   DCL ROOT$ PTR;
      516    16065    1   DCL SNAME_FLG BIT(1) ;
      517    16066    1   DCL 1 SPLIT ,
      518    16067    1          2 * UBIN(1) UNAL ,
      519    16068    1          2 T UBIN(8) UNAL ,
      520    16069    1          2 * UBIN(1) UNAL ,
      521    16070    1          2 B UBIN(8) UNAL ;
      522    16071    1   DCL TEMP   UBIN WORD;
      523    16072    1   DCL TEMP$  PTR;
      524    16073    1   DCL TEMP_TYPE CHAR(4) ;
      525    16074    1   DCL TP_FLAG BIT(1) ;
      526    16075    1   DCL T_NODE$ PTR;
      527    16076    1   DCL WKSZ UBIN;
      528    16077    1   DCL WK_USED UBIN;
      529    16078    1   DCL WORK$ PTR;
      530    16079    1   DCL YES_NO_FLG BIT(1);
      531    16080        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:129  
      532    16081        /*********************************************************************/
      533    16082        /*   Symref's        symref's        symref's        symref's        */
      534    16083        /*********************************************************************/
      535    16084                                                                                    /**/
      536    16085    1   DCL DEVICE_OPTS_LIST SYMREF UBIN WORD ;
      537    16086        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:130  
      538    16087        /*********************************************************************/
      539    16088        /*   Static data     static data     static data     static data     */
      540    16089        /*********************************************************************/
      541    16090                                                                                    /**/
      542    16091    1   DCL DEV_IN_VAL UBIN CONSTANT INIT(1   /*  YES_VAL  */);
      543    16092    1   DCL DEV_OUT_VAL UBIN CONSTANT INIT(2   /*  NO_VAL  */);
      544    16093    1   DCL TYPE STATIC SYMDEF CHAR(2) ;
      545    16094              %KL_DREC( NAME = KL_CREC ,
      546    16095                        STCLASS = CONSTANT ,
      547    16096                        TYP = %KLAT_CG# ,
      548    16097                      RN = '1'B ,
      549    16098                      LAST = ","  );
      550    16211              %KC$CGID ( FPTN = KC$CGID ,
      551    16212                      STCLASS=CONSTANT,
      552    16213                      LVL = 2  ,
      553    16214                      LAST = "," ) ;
      554    16240              %FI_CONINFO(FPTN = ISINFO,
      555    16241                      STCLASS=CONSTANT,
      556    16242                      LVL = 2 ,
      557    16243                      LAST = "," ) ;
      558    16287              %FO_CONINFO (FPTN = OSINFO ,
      559    16288                      STCLASS = CONSTANT,
      560    16289                      LVL = 2 ,
      561    16290                      LAST = "," ) ;
      562    16321              %QQ$LOGON(FPTN = QQ_LOGON,
      563    16322                      STCLASS=CONSTANT,
      564    16323                      LVL = 2 ,
      565    16324                      LAST = "," ) ;
      566    16360              %KL_RES_CL_DEV (NAME = RES_DEV,
      567    16361                              STCLASS = CONSTANT,
      568    16362                              LAST=",",
      569    16363                              LVL= 2);
      570    16423              %B$CGAUINFO(FPTN = B_CGAUINFO,
      571    16424                          STCLASS=CONSTANT,
      572    16425                          LVL = 2 ) ;
      573    16445        %KL_DADR ( NAME = KL_DADR ,
      574    16446                   STCLASS=CONSTANT,
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:131  
      575    16447                   LVL = 1  ,
      576    16448                   LAST = ";" ) ;
      577    16496        %VLR_FID ( FPTN = FID_VLR  ) ;
      578    16515        %VLP_NAME(FPTN=NAMEVLP ) ;
      579    16542        %VLP_ACCT(FPTN=ACCTVLP);
      580    16555        %VLP_SN(FPTN=SNVLP);
      581    16568        %FPT_FID (FPTN=FIDFPT,
      582    16569                  NAME=NAMEVLP,
      583    16570                  ACCT=ACCTVLP,
      584    16571                  SN=SNVLP,
      585    16572                  RES=RES_AREA,
      586    16573                  ASN=ASN_VAL,
      587    16574                  RESULTS=FID_VLR ) ;
      588    16597    1   DCL RES_AREA CHAR(2) STATIC ALIGNED INIT(' ') ;
      589    16598    1   DCL ASN_VAL UBIN BYTE ALIGNED STATIC INIT( 0 );
      590    16599    1   DCL Z_ACCT(0:1) UBIN WORD CONSTANT INIT(0*0);
      591    16600    1   DCL ZERO_ACCNT REDEF Z_ACCT CHAR(8) UNAL;
      592    16601        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:132  
      593    16602        /********************************************************************/
      594    16603        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      595    16604        /*********************************************************************/
      596    16605                                                                                    /**/
      597    16606    1   DCL X$PARSE ENTRY(1) ALTRET ;
      598    16607        %ASB$SET_PROMPT ;
      599    16610        %ASB$READ_SI ;
      600    16613        %ASB$FIND_NUM ;
      601    16616        %ASD$READ_PRO ;
      602    16619        %ASF$READ_FORM ;
      603    16622        %ASH$ERROR ;
      604    16625        %ASH$WARN ;
      605    16628        %ASZ$SCRAMBLE ;
      606    16631        %ASH$HELP ;
      607    16634        %ASH$QUEST ;
      608    16637        %ASH$DQUEST ;
      609    16640        %ASB$GET_HEX_VAL ;
      610    16643        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:133  
      611    16644        /*********************************************************************/
      612    16645        /*   Local based     local based     local based     local based     */
      613    16646        /*********************************************************************/
      614    16647                                                                                    /**/
      615    16648            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      616    16649                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
      617    16694              %PARSE$SYM( NAME = OUT$SYM ,
      618    16695                          STCLASS="BASED(BLK$)") ;
      619    16733              %KL_DREC (NAME = KL$TREC ,
      620    16734                      STCLASS="BASED( TREC$ )",
      621    16735                      LAST = "," ) ;
      622    16848              %KC$CGID(FPTN=KC$CGID,
      623    16849                      STCLASS=STCLASS,
      624    16850                      LVL = 2 ,
      625    16851                      LAST = "," );
      626    16877              %FI_CONINFO(FPTN = ISINFO,
      627    16878                      STCLASS=STCLASS,
      628    16879                      LVL = 2 ,
      629    16880                      LAST = "," ) ;
      630    16924              %FO_CONINFO (FPTN = OSINFO ,
      631    16925                      STCLASS=STCLASS,
      632    16926                      LVL = 2 ,
      633    16927                      LAST = "," ) ;
      634    16958              %QQ$LOGON(FPTN = QQ_LOGON,
      635    16959                      LVL = 2 ,
      636    16960                      LAST = "," ) ;
      637    16996              %KL_RES_CL_DEV (NAME = RES_DEV,
      638    16997                              STCLASS = STCLASS,
      639    16998                              LAST=",",
      640    16999                              LVL= 2);
      641    17059              %B$CGAUINFO(FPTN = B_CGAUINFO,
      642    17060                          STCLASS=STCLASS,
      643    17061                          LVL = 2 ) ;
      644    17081        %KL_DADR ( NAME = KL$DADR,
      645    17082                   STCLASS="BASED(DADR$)",
      646    17083                   LVL = 1 ,
      647    17084                   LAST = ";" );
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:134  
      648    17132              %KL_TWSNREC(  NAME = KL$TWSNREC ,
      649    17133                            STCLASS="BASED( TWSNR$ )") ;
      650    17158              %KL_PHDR ( NAME = KL$PHDR  ,
      651    17159                        STCLASS="BASED( PRO$ )") ;
      652    17200        /*
      653    17201                  Template for a use=out device
      654    17202        */
      655    17203              %KL_DREC( NAME=OUT$DEV, STCLASS="BASED( TREC$ )", LAST="," );
      656    17316              %KC$CGID( FPTN=KC$CGID, STCLASS=STCLASS, LVL=2, LAST="," );
      657    17342              %FO_CONINFO( FPTN=OSINFO, STCLASS=STCLASS, LVL=2, LAST=";" );
      658    17373        /*
      659    17374                  Template for a use=cg device
      660    17375        */
      661    17376              %KL_DREC( NAME=CG$DEV, STCLASS="BASED( TREC$ )", LAST="," );
      662    17489              %KC$CGID( FPTN=KC$CGID, STCLASS=STCLASS, LVL=2, LAST="," );
      663    17515              %B$CGAUINFO( FPTN=B_CGAUINFO, STCLASS=STCLASS, LVL=2 );
      664    17535        /*
      665    17536                  Template for a use=tp device
      666    17537        */
      667    17538              %KL_DREC( NAME=TP$DEV, STCLASS="BASED( TREC$ )", LAST="," );
      668    17651              %KC$CGID( FPTN=KC$CGID, STCLASS=STCLASS, LVL=2, LAST="," );
      669    17677              %QQ$LOGON( FPTN=QQ_LOGON, STCLASS=STCLASS, LVL=2, LAST=";" );
      670    17713        /*
      671    17714                  Template for a use=in device
      672    17715        */
      673    17716              %KL_DREC( NAME=IN$DEV, STCLASS="BASED( TREC$ )", LAST="," );
      674    17829              %KC$CGID( FPTN=KC$CGID, STCLASS=STCLASS, LVL=2, LAST="," );
      675    17855              %FO_CONINFO( FPTN=ISINFO, STCLASS=STCLASS, LVL=2, LAST=";" );
      676    17886        /*
      677    17887                  Template for a use=res and type=cl device
      678    17888        */
      679    17889              %KL_DREC( NAME=RES$DEV, STCLASS="BASED( TREC$ )", LAST="," );
      680    18002              %KL_RES_CL_DEV( NAME=RES_DEV, STCLASS=STCLASS, LVL=2, LAST=";" );
      681    18062
      682    18063    1   DCL ACHAR          CHAR(1) BASED;
      683    18064    1   DCL 1 TP_DEV BASED (DSEG3$),
      684    18065    1          2 DEV_TYPE UBIN WORD,
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:135  
      685    18066    1          2 SNAME CHAR (8);
      686    18067        %EJECT ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:136  
      687    18068        /*********************************************************************/
      688    18069        /*   Procedure       procedure       procedure       procedure       */
      689    18070        /*********************************************************************/
      690    18071                                                                                    /**/
      691    18072        /*
      692    18073            ***            Begin procedure                    ***
      693    18074        */
      694    18075    1   WORK$ = P_PCB.WORK$ ;

  18075  4 000002   000002 236000 xsym               LDQ     P_PCB+2
         4 000003   202337 756100                    STQ     WORK$,,AUTO

      695    18076    1   WKSZ = P_PCB.WKSZ ;

  18076  4 000004   000005 235000 xsym               LDA     P_PCB+5
         4 000005   000022 771000                    ARL     18
         4 000006   202335 755100                    STA     WKSZ,,AUTO

      696    18077    1   WK_USED = P_PCB.WK_USED ;

  18077  4 000007   000010 235000 xsym               LDA     P_PCB+8
         4 000010   000022 771000                    ARL     18
         4 000011   202336 755100                    STA     WK_USED,,AUTO

      697    18078    1   ROOT$ = P_PCB.ROOT$ ;

  18078  4 000012   000001 236000 xsym               LDQ     P_PCB+1
         4 000013   202325 756100                    STQ     ROOT$,,AUTO

      698    18079                                                /* Bump past area used.               */
      699    18080    1   P_PCB.WORK$ = PINCRW( WORK$, P_PCB.WK_USED ) ;

  18080  4 000014   000010 236000 xsym               LDQ     P_PCB+8
         4 000015   777777 376003                    ANQ     -1,DU
         4 000016   202337 036100                    ADLQ    WORK$,,AUTO
         4 000017   000002 756000 xsym               STQ     P_PCB+2

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:137  
      700    18081    1   P_PCB.WKSZ = WKSZ - P_PCB.WK_USED ;

  18081  4 000020   202342 755100                    STA     YES_NO_FLG+2,,AUTO
         4 000021   202335 236100                    LDQ     WKSZ,,AUTO
         4 000022   202342 136100                    SBLQ    YES_NO_FLG+2,,AUTO
         4 000023   000000 620006                    EAX0    0,QL
         4 000024   000005 740000 xsym               STX0    P_PCB+5

      701    18082                                                /* Save NODE$                         */
      702    18083    1   T_NODE$ = NODE$ ;

  18083  4 000025   000000 236000 xsym               LDQ     NODE$
         4 000026   202334 756100                    STQ     T_NODE$,,AUTO

      703    18084    1   MORE = AS_TRUE ;

  18084  4 000027   000000 236000 xsym               LDQ     AS_TRUE
         4 000030   400000 376003                    ANQ     -131072,DU
         4 000031   201704 756100                    STQ     MORE,,AUTO

      704    18085                                                                                    /**/
      705    18086    1   NUM = AS_BLANK;

  18086  4 000032   040100 100400                    MLR     fill='040'O
         4 000033   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000034   202342 000004                    ADSC9   YES_NO_FLG+2,,AUTO       cn=0,n=4
         4 000035   202342 221100                    LDX1    YES_NO_FLG+2,,AUTO
         4 000036   201705 741100                    STX1    NUM,,AUTO

      706    18087    1   TYPE = AS_BLANK;

  18087  4 000037   040100 100400                    MLR     fill='040'O
         4 000040   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000041   202342 000004                    ADSC9   YES_NO_FLG+2,,AUTO       cn=0,n=4
         4 000042   202342 222100                    LDX2    YES_NO_FLG+2,,AUTO
         4 000043   000000 742000 3                  STX2    TYPE

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:138  
      707    18088    1   TP_FLAG = AS_FALSE ;

  18088  4 000044   000000 236000 xsym               LDQ     AS_FALSE
         4 000045   400000 376003                    ANQ     -131072,DU
         4 000046   202333 756100                    STQ     TP_FLAG,,AUTO

      708    18089    1   CG_FLAG = AS_FALSE ;

  18089  4 000047   200016 756100                    STQ     CG_FLAG,,AUTO

      709    18090    1   GROUP_FLAG = AS_FALSE ;

  18090  4 000050   201575 756100                    STQ     GROUP_FLAG,,AUTO

      710    18091    1   PRO_FLAG = AS_FALSE ;

  18091  4 000051   202322 756100                    STQ     PRO_FLAG,,AUTO

      711    18092    1   INSTANCE_FLAG = AS_FALSE ;

  18092  4 000052   201677 756100                    STQ     INSTANCE_FLAG,,AUTO

      712    18093    1   SNAME_FLG = AS_FALSE ;

  18093  4 000053   202326 756100                    STQ     SNAME_FLG,,AUTO

      713    18094    1   DEV_USE = 0;

  18094  4 000054   200050 450100                    STZ     DEV_USE,,AUTO

      714    18095    2   IF CREATE THEN DO;

  18095  4 000055   200006 470500                    LDP0    @CREATE,,AUTO
         4 000056   000000 234100                    SZN     0,,PR0
         4 000057   000246 605000 4                  TPL     s:18131

      715    18096    2      KL$TREC = KL_CREC;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:139  

  18096  4 000060   200003 471500                    LDP1    @TREC$,,AUTO
         4 000061   100000 473500                    LDP3    0,,PR1
         4 000062   000100 100400                    MLR     fill='000'O
         4 000063   000002 000740 2                  ADSC9   KL_CREC                  cn=0,n=480
         4 000064   300000 000740                    ADSC9   0,,PR3                   cn=0,n=480

      716    18097    2      IO='11'B;

  18097  4 000065   600000 236003                    LDQ     -65536,DU
         4 000066   201700 756100                    STQ     IO,,AUTO

      717    18098    2      PATTR='0'B;

  18098  4 000067   000000 220003                    LDX0    0,DU
         4 000070   201720 740100                    STX0    PATTR,,AUTO

      718    18099    2      DDEV='0'B;

  18099  4 000071   200045 450100                    STZ     DDEV,,AUTO

      719    18100    2      KL$TREC.PNAME.CNT = 0;

  18100  4 000072   100000 473500                    LDP3    0,,PR1
         4 000073   000000 236003                    LDQ     0,DU
         4 000074   300004 552140                    STBQ    4,'40'O,PR3

      720    18101    2      KL$TREC.PNAME.TXT = ' ' ;

  18101  4 000075   100000 473500                    LDP3    0,,PR1
         4 000076   040100 100400                    MLR     fill='040'O
         4 000077   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000100   300004 200013                    ADSC9   4,,PR3                   cn=1,n=11

      721    18102    2      CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD );

  18102  4 000101   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:140  
         4 000102   300002 634500                    EPPR4   2,,PR3
         4 000103   202342 454500                    STP4    YES_NO_FLG+2,,AUTO
         4 000104   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 000105   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000106   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         4 000107   000000 011000                    NOP     0

      722    18103    2      KL$TREC.KC$CGID.NAME#.CNT = 0 ;

  18103  4 000110   200003 470500                    LDP0    @TREC$,,AUTO
         4 000111   000000 471500                    LDP1    0,,PR0
         4 000112   000000 236003                    LDQ     0,DU
         4 000113   100024 552140                    STBQ    20,'40'O,PR1

      723    18104    2      KL$TREC.FLAGS.RNME = AS_TRUE;

  18104  4 000114   000000 471500                    LDP1    0,,PR0
         4 000115   000000 236000 xsym               LDQ     AS_TRUE
         4 000116   000011 772000                    QRL     9
         4 000117   100000 676100                    ERQ     0,,PR1
         4 000120   000400 376003                    ANQ     256,DU
         4 000121   100000 656100                    ERSQ    0,,PR1

      724    18105    2      KL$TREC.RENAME=' ';

  18105  4 000122   000000 471500                    LDP1    0,,PR0
         4 000123   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000124   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000125   100011 755100                    STA     9,,PR1
         4 000126   100012 756100                    STQ     10,,PR1

      725    18106    2      KL$TREC.TWSN# = TWSNC;

  18106  4 000127   000000 471500                    LDP1    0,,PR0
         4 000130   200005 473500                    LDP3    @TWSNC,,AUTO
         4 000131   040100 100500                    MLR     fill='040'O
         4 000132   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:141  
         4 000133   100001 000004                    ADSC9   1,,PR1                   cn=0,n=4

      726    18107    2      KL$TREC.OSINFO.TNAME = KL$TWSNREC.STATION ;

  18107  4 000134   000000 471500                    LDP1    0,,PR0
         4 000135   200004 474500                    LDP4    @TWSNR$,,AUTO
         4 000136   400000 475500                    LDP5    0,,PR4
         4 000137   040100 100500                    MLR     fill='040'O
         4 000140   500002 000010                    ADSC9   2,,PR5                   cn=0,n=8
         4 000141   100072 000010                    ADSC9   58,,PR1                  cn=0,n=8

      727    18108    2      KL$TREC.ISINFO.TNAME = KL$TWSNREC.STATION ;

  18108  4 000142   000000 471500                    LDP1    0,,PR0
         4 000143   400000 475500                    LDP5    0,,PR4
         4 000144   040100 100500                    MLR     fill='040'O
         4 000145   500002 000010                    ADSC9   2,,PR5                   cn=0,n=8
         4 000146   100063 000010                    ADSC9   51,,PR1                  cn=0,n=8

      728    18109    2      IF ( (TP_DEV.DEV_TYPE > 0) AND (~ SUB) )

  18109  4 000147   000000 471400 xsym               LDP1    DSEG3$
         4 000150   100000 235100                    LDA     0,,PR1
         4 000151   000440 600000 4                  TZE     s:18166
         4 000152   200007 475500                    LDP5    @SUB,,AUTO
         4 000153   500000 236100                    LDQ     0,,PR5
         4 000154   400000 376003                    ANQ     -131072,DU
         4 000155   400000 676003                    ERQ     -131072,DU
         4 000156   000440 600000 4                  TZE     s:18166

      729    18110    3      THEN DO;

      730    18111    4         IF NOT CREATE THEN DO ;

  18111  4 000157   200006 476500                    LDP6    @CREATE,,AUTO
         4 000160   600000 234100                    SZN     0,,PR6
         4 000161   000175 604000 4                  TMI     s:18116
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:142  

      731    18112    4            KL$TREC.KC$CGID = KL_CREC.KC$CGID ;

  18112  4 000162   000000 477500                    LDP7    0,,PR0
         4 000163   000100 100400                    MLR     fill='000'O
         4 000164   000022 000060 2                  ADSC9   KL_CREC+16               cn=0,n=48
         4 000165   700020 000060                    ADSC9   16,,PR7                  cn=0,n=48

      732    18113    4            KL$TREC.KC$CGID.NAME#.CNT = 0 ;

  18113  4 000166   000000 477500                    LDP7    0,,PR0
         4 000167   000000 236003                    LDQ     0,DU
         4 000170   700024 552140                    STBQ    20,'40'O,PR7

      733    18114    4            KL$TREC.QQ_LOGON = KL_CREC.QQ_LOGON ;

  18114  4 000171   000000 477500                    LDP7    0,,PR0
         4 000172   000100 100400                    MLR     fill='000'O
         4 000173   000076 000170 2                  ADSC9   KL_CREC+60               cn=0,n=120
         4 000174   700074 000170                    ADSC9   60,,PR7                  cn=0,n=120

      734    18115    4            END;

      735    18116    3         TYPE = 'CG';

  18116  4 000175   000175 220000 2                  LDX0    Z_ACCT+2
         4 000176   000000 740000 3                  STX0    TYPE

      736    18117    3         TP_FLAG = AS_TRUE;

  18117  4 000177   000000 236000 xsym               LDQ     AS_TRUE
         4 000200   400000 376003                    ANQ     -131072,DU
         4 000201   202333 756100                    STQ     TP_FLAG,,AUTO

      737    18118    3         KL$TREC.FLAGS.RNME = AS_FALSE ;

  18118  4 000202   000000 477500                    LDP7    0,,PR0
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:143  
         4 000203   000000 236000 xsym               LDQ     AS_FALSE
         4 000204   000011 772000                    QRL     9
         4 000205   700000 676100                    ERQ     0,,PR7
         4 000206   000400 376003                    ANQ     256,DU
         4 000207   700000 656100                    ERSQ    0,,PR7

      738    18119    3         KL$TREC.FLAGS.USETP = AS_TRUE ;

  18119  4 000210   000000 471500                    LDP1    0,,PR0
         4 000211   000000 236000 xsym               LDQ     AS_TRUE
         4 000212   000016 772000                    QRL     14
         4 000213   100000 676100                    ERQ     0,,PR1
         4 000214   000010 376003                    ANQ     8,DU
         4 000215   100000 656100                    ERSQ    0,,PR1

      739    18120    3         KL$TREC.SUPER = 7 /* TP DEVICE */;

  18120  4 000216   000000 471500                    LDP1    0,,PR0
         4 000217   000007 236007                    LDQ     7,DL
         4 000220   100000 552104                    STBQ    0,'04'O,PR1

      740    18121    3         DEV_USE = 48 /* TP */;

  18121  4 000221   000060 235007                    LDA     48,DL
         4 000222   200050 755100                    STA     DEV_USE,,AUTO

      741    18122    3         IF TP_DEV.DEV_TYPE = 2

  18122  4 000223   000000 471400 xsym               LDP1    DSEG3$
         4 000224   100000 235100                    LDA     0,,PR1
         4 000225   000002 115007                    CMPA    2,DL
         4 000226   000440 601000 4                  TNZ     s:18166

      742    18123    4         THEN DO; /* We will use the default sname */

      743    18124    4            SNAME_FLG = AS_TRUE;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:144  
  18124  4 000227   000000 236000 xsym               LDQ     AS_TRUE
         4 000230   400000 376003                    ANQ     -131072,DU
         4 000231   202326 756100                    STQ     SNAME_FLG,,AUTO

      744    18125    4            KL$TREC.FLAGS.RNME = AS_TRUE;

  18125  4 000232   000000 477500                    LDP7    0,,PR0
         4 000233   000000 236000 xsym               LDQ     AS_TRUE
         4 000234   000011 772000                    QRL     9
         4 000235   700000 676100                    ERQ     0,,PR7
         4 000236   000400 376003                    ANQ     256,DU
         4 000237   700000 656100                    ERSQ    0,,PR7

      745    18126    4            KL$TREC.RENAME = TP_DEV.SNAME;

  18126  4 000240   000000 471500                    LDP1    0,,PR0
         4 000241   000000 477400 xsym               LDP7    DSEG3$
         4 000242   040100 100500                    MLR     fill='040'O
         4 000243   700001 000010                    ADSC9   1,,PR7                   cn=0,n=8
         4 000244   100011 000010                    ADSC9   9,,PR1                   cn=0,n=8

      746    18127    4            END;

      747    18128    3         END;

      748    18129    2      END;

  18129  4 000245   000440 710000 4                  TRA     s:18166

      749    18130    2   ELSE DO;

      750    18131    2      TWSNC = KL$TREC.TWSN#;

  18131  4 000246   200003 471500                    LDP1    @TREC$,,AUTO
         4 000247   100000 473500                    LDP3    0,,PR1
         4 000250   200005 474500                    LDP4    @TWSNC,,AUTO
         4 000251   040100 100500                    MLR     fill='040'O
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:145  
         4 000252   300001 000004                    ADSC9   1,,PR3                   cn=0,n=4
         4 000253   400000 000004                    ADSC9   0,,PR4                   cn=0,n=4

      751    18132    3      DO SELECT( KL$TREC.SUPER );

  18132  4 000254   100000 473500                    LDP3    0,,PR1
         4 000255   300000 236100                    LDQ     0,,PR3
         4 000256   000777 376007                    ANQ     511,DL
         4 000257   000006 116007                    CMPQ    6,DL
         4 000260   000273 602000 4                  TNC     s:18132+15
         4 000261   000301 600000 4                  TZE     s:18136
         4 000262   000013 116007                    CMPQ    11,DL
         4 000263   000270 602000 4                  TNC     s:18132+12
         4 000264   000344 600000 4                  TZE     s:18150
         4 000265   000014 116007                    CMPQ    12,DL
         4 000266   000367 601000 4                  TNZ     s:18157
         4 000267   000307 710000 4                  TRA     s:18139
         4 000270   000007 116007                    CMPQ    7,DL
         4 000271   000367 601000 4                  TNZ     s:18157
         4 000272   000320 710000 4                  TRA     s:18143
         4 000273   000005 116007                    CMPQ    5,DL
         4 000274   000367 601000 4                  TNZ     s:18157
         4 000275   000276 710000 4                  TRA     s:18134

      752    18133    3         SELECT( 5 /* INSYM DEVICE */ );                   /* Use=in device */

      753    18134    3         DEV_USE = DEV_IN_VAL ;

  18134  4 000276   000000 235000 2                  LDA     DEV_IN_VAL
         4 000277   200050 755100                    STA     DEV_USE,,AUTO
         4 000300   000367 710000 4                  TRA     s:18157

      754    18135    3         SELECT( 6 /* OUTSYM DEVICE */ );                  /* Use=out device */

      755    18136    3         DEV_USE = DEV_OUT_VAL ;

  18136  4 000301   000001 235000 2                  LDA     DEV_OUT_VAL
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:146  
         4 000302   200050 755100                    STA     DEV_USE,,AUTO

      756    18137    3         KL$TREC.OSINFO = OUT$DEV.OSINFO ;

  18137  4 000303   000100 100500                    MLR     fill='000'O
         4 000304   300034 000024                    ADSC9   28,,PR3                  cn=0,n=20
         4 000305   300067 000024                    ADSC9   55,,PR3                  cn=0,n=20
         4 000306   000367 710000 4                  TRA     s:18157

      757    18138    3         SELECT( 12 /* RES DEVICE */ );                   /* Use=res device */

      758    18139    3         DEV_USE = 47 /* RESOURCE */ ;

  18139  4 000307   000057 235007                    LDA     47,DL
         4 000310   200050 755100                    STA     DEV_USE,,AUTO

      759    18140    3         IF SUBSTR(KL$TREC.RENAME,0,2) = 'CL' THEN

  18140  4 000311   300011 220100                    LDX0    9,,PR3
         4 000312   000176 100000 2                  CMPX0   Z_ACCT+3
         4 000313   000367 601000 4                  TNZ     s:18157

      760    18141    3            KL$TREC.RES_DEV = RES$DEV.RES_DEV;

  18141  4 000314   000100 100500                    MLR     fill='000'O
         4 000315   300020 000021                    ADSC9   16,,PR3                  cn=0,n=17
         4 000316   300132 000021                    ADSC9   90,,PR3                  cn=0,n=17
         4 000317   000367 710000 4                  TRA     s:18157

      761    18142    3         SELECT( 7 /* TP DEVICE */ );                   /* Use=tp device */

      762    18143    3         IF SUB THEN PRO_FLAG = AS_TRUE ;

  18143  4 000320   200007 475500                    LDP5    @SUB,,AUTO
         4 000321   500000 234100                    SZN     0,,PR5
         4 000322   000327 605000 4                  TPL     s:18144

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:147  
  18143  4 000323   000000 236000 xsym               LDQ     AS_TRUE
         4 000324   400000 376003                    ANQ     -131072,DU
         4 000325   202322 756100                    STQ     PRO_FLAG,,AUTO
         4 000326   000331 710000 4                  TRA     s:18145

      763    18144    3         ELSE TYPE = 'CG';

  18144  4 000327   000175 220000 2                  LDX0    Z_ACCT+2
         4 000330   000000 740000 3                  STX0    TYPE

      764    18145    3         DEV_USE = 48 /* TP */ ;

  18145  4 000331   000060 236007                    LDQ     48,DL
         4 000332   200050 756100                    STQ     DEV_USE,,AUTO

      765    18146    3         TP_FLAG = AS_TRUE ;

  18146  4 000333   000000 236000 xsym               LDQ     AS_TRUE
         4 000334   400000 376003                    ANQ     -131072,DU
         4 000335   202333 756100                    STQ     TP_FLAG,,AUTO

      766    18147    3         INSTANCE_FLAG = AS_TRUE ;

  18147  4 000336   201677 756100                    STQ     INSTANCE_FLAG,,AUTO

      767    18148    3         KL$TREC.QQ_LOGON = TP$DEV.QQ_LOGON ;

  18148  4 000337   100000 473500                    LDP3    0,,PR1
         4 000340   000100 100500                    MLR     fill='000'O
         4 000341   300034 000170                    ADSC9   28,,PR3                  cn=0,n=120
         4 000342   300074 000170                    ADSC9   60,,PR3                  cn=0,n=120
         4 000343   000367 710000 4                  TRA     s:18157

      768    18149    3         SELECT( 11 /* CG DEVICE */ );                   /* Use=cg device */

      769    18150    3         IF SUB THEN PRO_FLAG = AS_TRUE ;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:148  
  18150  4 000344   200007 475500                    LDP5    @SUB,,AUTO
         4 000345   500000 234100                    SZN     0,,PR5
         4 000346   000353 605000 4                  TPL     s:18151

  18150  4 000347   000000 236000 xsym               LDQ     AS_TRUE
         4 000350   400000 376003                    ANQ     -131072,DU
         4 000351   202322 756100                    STQ     PRO_FLAG,,AUTO
         4 000352   000355 710000 4                  TRA     s:18152

      770    18151    3         ELSE TYPE = 'CG';

  18151  4 000353   000175 220000 2                  LDX0    Z_ACCT+2
         4 000354   000000 740000 3                  STX0    TYPE

      771    18152    3         DEV_USE = 49 /* COM GROUP  */ ;

  18152  4 000355   000061 236007                    LDQ     49,DL
         4 000356   200050 756100                    STQ     DEV_USE,,AUTO

      772    18153    3         CG_FLAG = AS_TRUE ;

  18153  4 000357   000000 236000 xsym               LDQ     AS_TRUE
         4 000360   400000 376003                    ANQ     -131072,DU
         4 000361   200016 756100                    STQ     CG_FLAG,,AUTO

      773    18154    3         GROUP_FLAG = AS_TRUE ;

  18154  4 000362   201575 756100                    STQ     GROUP_FLAG,,AUTO

      774    18155    3         KL$TREC.B_CGAUINFO = CG$DEV.B_CGAUINFO ;

  18155  4 000363   100000 473500                    LDP3    0,,PR1
         4 000364   000100 100500                    MLR     fill='000'O
         4 000365   300034 000144                    ADSC9   28,,PR3                  cn=0,n=100
         4 000366   300137 000144                    ADSC9   95,,PR3                  cn=0,n=100

      775    18156    3         END ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:149  

      776    18157    3      IF TYPE ~= 'CG' THEN DO;

  18157  4 000367   000000 220000 3                  LDX0    TYPE
         4 000370   000175 100000 2                  CMPX0   Z_ACCT+2
         4 000371   000440 600000 4                  TZE     s:18166

      777    18158    3         TYPE = KL$TWSNREC.DEVS.TYP(TWSN_INDEX) ;

  18158  4 000372   200004 473500                    LDP3    @TWSNR$,,AUTO
         4 000373   300000 475500                    LDP5    0,,PR3
         4 000374   200011 476500                    LDP6    @TWSN_INDEX,,AUTO
         4 000375   600000 236100                    LDQ     0,,PR6
         4 000376   000013 402007                    MPY     11,DL
         4 000377   500005 221106                    LDX1    5,QL,PR5
         4 000400   000000 741000 3                  STX1    TYPE

      778    18159    3         NUM  = KL$TWSNREC.DEVS.NUM(TWSN_INDEX) ;

  18159  4 000401   300000 475500                    LDP5    0,,PR3
         4 000402   600000 236100                    LDQ     0,,PR6
         4 000403   000013 402007                    MPY     11,DL
         4 000404   500005 720106                    LXL0    5,QL,PR5
         4 000405   201705 740100                    STX0    NUM,,AUTO

      779    18160    3         PATTR= KL$TWSNREC.DEVS.ATTR(TWSN_INDEX) ;

  18160  4 000406   300000 475500                    LDP5    0,,PR3
         4 000407   600000 236100                    LDQ     0,,PR6
         4 000410   000013 402007                    MPY     11,DL
         4 000411   500006 222106                    LDX2    6,QL,PR5
         4 000412   201720 742100                    STX2    PATTR,,AUTO

      780    18161    3         IO   = KL$TWSNREC.DEVS.IO(TWSN_INDEX) ;

  18161  4 000413   600000 236100                    LDQ     0,,PR6
         4 000414   000013 402007                    MPY     11,DL
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:150  
         4 000415   500006 236106                    LDQ     6,QL,PR5
         4 000416   000033 736000                    QLS     27
         4 000417   600000 376003                    ANQ     -65536,DU
         4 000420   201700 756100                    STQ     IO,,AUTO

      781    18162    3         DDEV = KL$TWSNREC.DEVS.DDEV(TWSN_INDEX) ;

  18162  4 000421   600000 236100                    LDQ     0,,PR6
         4 000422   000013 402007                    MPY     11,DL
         4 000423   500006 236106                    LDQ     6,QL,PR5
         4 000424   000022 736000                    QLS     18
         4 000425   777000 376003                    ANQ     -512,DU
         4 000426   200045 756100                    STQ     DDEV,,AUTO

      782    18163    3         IF SUB THEN FROM_KEY.TEXT = KL$TWSNREC.DEVS.ACCT(TWSN_INDEX) ;

  18163  4 000427   200007 477500                    LDP7    @SUB,,AUTO
         4 000430   700000 234100                    SZN     0,,PR7
         4 000431   000440 605000 4                  TPL     s:18166

  18163  4 000432   600000 236100                    LDQ     0,,PR6
         4 000433   000013 402007                    MPY     11,DL
         4 000434   000002 736000                    QLS     2
         4 000435   040000 100506                    MLR     fill='040'O
         4 000436   500011 000010                    ADSC9   9,Q,PR5                  cn=0,n=8
         4 000437   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20

      783    18164    3         END;

      784    18165    2      END;

      785    18166    1   KL$TWSNREC.DEVS(TWSN_INDEX) = '0'B ;

  18166  4 000440   200004 470500                    LDP0    @TWSNR$,,AUTO
         4 000441   000000 471500                    LDP1    0,,PR0
         4 000442   200011 473500                    LDP3    @TWSN_INDEX,,AUTO
         4 000443   300000 236100                    LDQ     0,,PR3
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:151  
         4 000444   000013 402007                    MPY     11,DL
         4 000445   000002 736000                    QLS     2
         4 000446   000106 100400                    MLR     fill='000'O
         4 000447   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000450   100005 000054                    ADSC9   5,Q,PR1                  cn=0,n=44

      786    18167    1   P_PCB.ROOT$ = ADDR( DEVICE_OPTS_LIST ) ;

  18167  4 000451   000000 236000 5                  LDQ     0
         4 000452   000001 756000 xsym               STQ     P_PCB+1

      787    18168                                                /* Set prompt                         */
      788    18169    2   IF SUB THEN DO;

  18169  4 000453   200007 471500                    LDP1    @SUB,,AUTO
         4 000454   100000 234100                    SZN     0,,PR1
         4 000455   000463 605000 4                  TPL     s:18173

      789    18170    2      CALL ASB$SET_PROMPT ( %PROMPT_SUB );

  18170  4 000456   000001 630400 5                  EPPR0   1
         4 000457   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000460   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 000461   000000 011000                    NOP     0

      790    18171    2      END;

  18171  4 000462   000467 710000 4                  TRA     s:18175

      791    18172    2   ELSE DO;

      792    18173    2      CALL ASB$SET_PROMPT ( %PROMPT_OPT ) ;

  18173  4 000463   000002 630400 5                  EPPR0   2
         4 000464   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000465   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 000466   000000 011000                    NOP     0
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:152  

      793    18174    2      END;

      794    18175    1   REMEMBER DEV_LOOP IN REMEM_VAR ;

  18175  4 000467   000472 635000 4                  EAA     DEV_LOOP
         4 000470   000000 452400 xsym               STP2    REMEM_VAR
         4 000471   000001 755000 xsym               STA     REMEM_VAR+1

      795    18176    1   DEV_LOOP:
      796    18177                                                                                    /**/
      797    18178    2   DO WHILE( MORE ) ;

  18178  4 000472   201704 234100       DEV_LOOP     SZN     MORE,,AUTO
         4 000473   005356 605000 4                  TPL     s:19729

      798    18179                                                /* Read input                         */
      799    18180    2      CALL ASB$READ_SI( IN_BUF, ARS ) ;

  18180  4 000474   200014 630500                    EPPR0   ARS,,AUTO
         4 000475   202343 450500                    STP0    YES_NO_FLG+3,,AUTO
         4 000476   000003 236000 5                  LDQ     3
         4 000477   202342 756100                    STQ     YES_NO_FLG+2,,AUTO
         4 000500   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 000501   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000502   000000 701000 xent               TSX1    ASB$READ_SI
         4 000503   000000 011000                    NOP     0

      800    18181    2      P_PCB.NCHARS = ARS ;

  18181  4 000504   200014 235100                    LDA     ARS,,AUTO
         4 000505   000011 755000 xsym               STA     P_PCB+9

      801    18182    2      CALL X$PARSE( P_PCB )

  18182  4 000506   000004 630400 5                  EPPR0   4
         4 000507   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:153  
         4 000510   000000 701000 xent               TSX1    X$PARSE
         4 000511   000513 702000 4                  TSX2    s:18184
         4 000512   000520 710000 4                  TRA     s:18188

      802    18183    3      WHENALTRETURN DO;

      803    18184    3         CALL ASH$ERROR( P_PCB.ERROR ) ;

  18184  4 000513   000005 630400 5                  EPPR0   5
         4 000514   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000515   000000 701000 xent               TSX1    ASH$ERROR
         4 000516   000000 011000                    NOP     0

      804    18185    3         GOTO DEV_LOOP ;

  18185  4 000517   000472 710000 4                  TRA     DEV_LOOP

      805    18186    3         END; /*  Whenaltreturn  */
      806    18187                                                                      /**/
      807    18188    2      NODE$ = P_PCB.OUT$ ;

  18188  4 000520   000003 236000 xsym               LDQ     P_PCB+3
         4 000521   000000 756000 xsym               STQ     NODE$

      808    18189    3      DO I = 0 TO P$NODE.SUBNODES-1 ;

  18189  4 000522   201676 450100                    STZ     I,,AUTO
         4 000523   005346 710000 4                  TRA     END_OPTION+3

      809    18190    3         PTR$ = P$NODE.SUBLK$(I) ;

  18190  4 000524   000000 470400 xsym               LDP0    NODE$
         4 000525   201676 720100                    LXL0    I,,AUTO
         4 000526   000003 236110                    LDQ     3,X0,PR0
         4 000527   202323 756100                    STQ     PTR$,,AUTO

      810    18191    3         CODE = PTR$ -> P$NODE.CODE ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:154  

  18191  4 000530   202323 471500                    LDP1    PTR$,,AUTO
         4 000531   100000 236100                    LDQ     0,,PR1
         4 000532   777777 376007                    ANQ     -1,DL
         4 000533   000000 756000 xsym               STQ     CODE

      811    18192    4         DO SELECT ( CODE ) ;

  18192  4 000534   000051 116007                    CMPQ    41,DL
         4 000535   000625 602000 4                  TNC     s:18192+57
         4 000536   003036 600000 4                  TZE     s:18849
         4 000537   000073 116007                    CMPQ    59,DL
         4 000540   000567 602000 4                  TNC     s:18192+27
         4 000541   004552 600000 4                  TZE     s:19481
         4 000542   000454 116007                    CMPQ    300,DL
         4 000543   000553 602000 4                  TNC     s:18192+15
         4 000544   001131 600000 4                  TZE     s:18314
         4 000545   000455 116007                    CMPQ    301,DL
         4 000546   005343 602000 4                  TNC     END_OPTION
         4 000547   001125 600000 4                  TZE     s:18311
         4 000550   000456 116007                    CMPQ    302,DL
         4 000551   005343 601000 4                  TNZ     END_OPTION
         4 000552   001121 710000 4                  TRA     s:18308
         4 000553   000075 116007                    CMPQ    61,DL
         4 000554   000564 602000 4                  TNC     s:18192+24
         4 000555   004715 600000 4                  TZE     s:19561
         4 000556   000076 116007                    CMPQ    62,DL
         4 000557   005343 602000 4                  TNC     END_OPTION
         4 000560   004744 600000 4                  TZE     s:19588
         4 000561   000077 116007                    CMPQ    63,DL
         4 000562   005343 601000 4                  TNZ     END_OPTION
         4 000563   004773 710000 4                  TRA     s:19615
         4 000564   000074 116007                    CMPQ    60,DL
         4 000565   005343 601000 4                  TNZ     END_OPTION
         4 000566   004671 710000 4                  TRA     s:19534
         4 000567   000063 116007                    CMPQ    51,DL
         4 000570   000611 602000 4                  TNC     s:18192+45
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:155  
         4 000571   003454 600000 4                  TZE     s:19125
         4 000572   000071 116007                    CMPQ    57,DL
         4 000573   000600 602000 4                  TNC     s:18192+36
         4 000574   004204 600000 4                  TZE     s:19396
         4 000575   000072 116007                    CMPQ    58,DL
         4 000576   005343 601000 4                  TNZ     END_OPTION
         4 000577   004616 710000 4                  TRA     s:19506
         4 000600   000065 116007                    CMPQ    53,DL
         4 000601   000606 602000 4                  TNC     s:18192+42
         4 000602   003454 600000 4                  TZE     s:19125
         4 000603   000066 116007                    CMPQ    54,DL
         4 000604   005343 601000 4                  TNZ     END_OPTION
         4 000605   003561 710000 4                  TRA     s:19170
         4 000606   000064 116007                    CMPQ    52,DL
         4 000607   005343 601000 4                  TNZ     END_OPTION
         4 000610   003454 710000 4                  TRA     s:19125
         4 000611   000055 116007                    CMPQ    45,DL
         4 000612   000617 602000 4                  TNC     s:18192+51
         4 000613   000724 600000 4                  TZE     s:18196
         4 000614   000062 116007                    CMPQ    50,DL
         4 000615   005343 601000 4                  TNZ     END_OPTION
         4 000616   003454 710000 4                  TRA     s:19125
         4 000617   000052 116007                    CMPQ    42,DL
         4 000620   005343 602000 4                  TNC     END_OPTION
         4 000621   003126 600000 4                  TZE     s:18908
         4 000622   000054 116007                    CMPQ    44,DL
         4 000623   005343 601000 4                  TNZ     END_OPTION
         4 000624   003355 710000 4                  TRA     s:19083
         4 000625   000036 116007                    CMPQ    30,DL
         4 000626   000667 602000 4                  TNC     s:18192+91
         4 000627   002572 600000 4                  TZE     s:18747
         4 000630   000045 116007                    CMPQ    37,DL
         4 000631   000645 602000 4                  TNC     s:18192+73
         4 000632   003265 600000 4                  TZE     s:19013
         4 000633   000047 116007                    CMPQ    39,DL
         4 000634   000641 602000 4                  TNC     s:18192+69
         4 000635   002624 600000 4                  TZE     s:18777
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:156  
         4 000636   000050 116007                    CMPQ    40,DL
         4 000637   005343 601000 4                  TNZ     END_OPTION
         4 000640   002667 710000 4                  TRA     s:18806
         4 000641   000000 235000 xsym               LDA     CODE
         4 000642   000046 115007                    CMPA    38,DL
         4 000643   005343 601000 4                  TNZ     END_OPTION
         4 000644   003165 710000 4                  TRA     s:18956
         4 000645   000000 236000 xsym               LDQ     CODE
         4 000646   000040 116007                    CMPQ    32,DL
         4 000647   000663 602000 4                  TNC     s:18192+87
         4 000650   003676 600000 4                  TZE     s:19217
         4 000651   000042 116007                    CMPQ    34,DL
         4 000652   000657 602000 4                  TNC     s:18192+83
         4 000653   003757 600000 4                  TZE     s:19252
         4 000654   000043 116007                    CMPQ    35,DL
         4 000655   005343 601000 4                  TNZ     END_OPTION
         4 000656   003726 710000 4                  TRA     s:19224
         4 000657   000000 235000 xsym               LDA     CODE
         4 000660   000041 115007                    CMPA    33,DL
         4 000661   005343 601000 4                  TNZ     END_OPTION
         4 000662   001141 710000 4                  TRA     s:18323
         4 000663   000000 235000 xsym               LDA     CODE
         4 000664   000037 115007                    CMPA    31,DL
         4 000665   005343 601000 4                  TNZ     END_OPTION
         4 000666   003636 710000 4                  TRA     s:19207
         4 000667   000000 236000 xsym               LDQ     CODE
         4 000670   000031 116007                    CMPQ    25,DL
         4 000671   000712 602000 4                  TNC     s:18192+110
         4 000672   001341 600000 4                  TZE     s:18420
         4 000673   000033 116007                    CMPQ    27,DL
         4 000674   000706 602000 4                  TNC     s:18192+106
         4 000675   004027 600000 4                  TZE     s:19288
         4 000676   000035 116007                    CMPQ    29,DL
         4 000677   000702 602000 4                  TNC     s:18192+102
         4 000700   003525 600000 4                  TZE     s:19140
         4 000701   005343 710000 4                  TRA     END_OPTION
         4 000702   000000 235000 xsym               LDA     CODE
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:157  
         4 000703   000034 115007                    CMPA    28,DL
         4 000704   005343 601000 4                  TNZ     END_OPTION
         4 000705   004062 710000 4                  TRA     s:19312
         4 000706   000000 235000 xsym               LDA     CODE
         4 000707   000032 115007                    CMPA    26,DL
         4 000710   005343 601000 4                  TNZ     END_OPTION
         4 000711   001135 710000 4                  TRA     s:18319
         4 000712   000000 236000 xsym               LDQ     CODE
         4 000713   000020 116007                    CMPQ    16,DL
         4 000714   000721 602000 4                  TNC     s:18192+117
         4 000715   001120 600000 4                  TZE     s:18305
         4 000716   000030 116007                    CMPQ    24,DL
         4 000717   005343 601000 4                  TNZ     END_OPTION
         4 000720   002164 710000 4                  TRA     s:18588
         4 000721   000014 116007                    CMPQ    12,DL
         4 000722   005343 601000 4                  TNZ     END_OPTION
         4 000723   001135 710000 4                  TRA     s:18319

      812    18193                                                                                    /**/
      813    18194    4            SELECT ( 45 /* TCD_PRO_VAL */ ) ;

      814    18195                                                /* Profile                            */
      815    18196    5            IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE = 7   /*  NONE_VAL  */ THEN DO;

  18196  4 000724   202323 470500                    LDP0    PTR$,,AUTO
         4 000725   000003 471500                    LDP1    3,,PR0
         4 000726   100000 720100                    LXL0    0,,PR1
         4 000727   000007 100003                    CMPX0   7,DU
         4 000730   000742 601000 4                  TNZ     s:18201

      816    18197    5               KL$TREC.PNAME.CNT=0;

  18197  4 000731   200003 473500                    LDP3    @TREC$,,AUTO
         4 000732   300000 474500                    LDP4    0,,PR3
         4 000733   000000 236003                    LDQ     0,DU
         4 000734   400004 552140                    STBQ    4,'40'O,PR4

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:158  
      817    18198    5               KL$TREC.PNAME.TXT=' ';

  18198  4 000735   300000 470500                    LDP0    0,,PR3
         4 000736   040100 100400                    MLR     fill='040'O
         4 000737   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000740   000004 200013                    ADSC9   4,,PR0                   cn=1,n=11

      818    18199    5               GOTO END_OPTION;

  18199  4 000741   005343 710000 4                  TRA     END_OPTION

      819    18200    5               END;  /*  Profile = none  */
      820    18201    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  18201  4 000742   000003 236100                    LDQ     3,,PR0
         4 000743   200015 756100                    STQ     BLK$,,AUTO

      821    18202    4            CNT = OUT$SYM.COUNT ;

  18202  4 000744   200015 473500                    LDP3    BLK$,,AUTO
         4 000745   300004 236100                    LDQ     4,,PR3
         4 000746   000033 772000                    QRL     27
         4 000747   200017 756100                    STQ     CNT,,AUTO

      822    18203    4            IF CNT > 11

  18203  4 000750   000014 116007                    CMPQ    12,DL
         4 000751   000757 602000 4                  TNC     s:18224

      823    18204    4            THEN
      824    18205    5            DO ;

      825    18206                    %SCREAM( ERR#=E$PRO_TOO_LONG, LEVEL=ERROR, MID='A' );

  18218  4 000752   000006 630400 5                  EPPR0   6
         4 000753   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000754   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:159  
         4 000755   000000 011000                    NOP     0

      826    18221    5               GOTO END_OPTION ;

  18221  4 000756   005343 710000 4                  TRA     END_OPTION

      827    18222    5               END ;               /* Then do                            */
      828    18223                                                /* Check if profile exists            */
      829    18224    4            PRO$ = ADDR(PRO_BUF);

  18224  4 000757   201722 634500                    EPPR4   PRO_BUF,,AUTO
         4 000760   201721 454500                    STP4    PRO$,,AUTO

      830    18225    4            ARS=LENGTHC(PRO_BUF);

  18225  4 000761   002000 235007                    LDA     1024,DL
         4 000762   200014 755100                    STA     ARS,,AUTO

      831    18226    4            USERS_KEY.COUNT = OUT$SYM.COUNT ;

  18226  4 000763   300004 236100                    LDQ     4,,PR3
         4 000764   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      832    18227    4            USERS_KEY.TXTC = OUT$SYM.TEXT ;

  18227  4 000765   300004 236100                    LDQ     4,,PR3
         4 000766   000033 772000                    QRL     27
         4 000767   000000 620006                    EAX0    0,QL
         4 000770   040000 100540                    MLR     fill='040'O
         4 000771   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000772   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      833    18228    4            CALL ASD$READ_PRO( USERS_KEY, KL$PHDR, ARS )

  18228  4 000773   200014 631500                    EPPR1   ARS,,AUTO
         4 000774   202344 451500                    STP1    YES_NO_FLG+4,,AUTO
         4 000775   201721 236100                    LDQ     PRO$,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:160  
         4 000776   000007 235000 5                  LDA     7
         4 000777   202342 757100                    STAQ    YES_NO_FLG+2,,AUTO
         4 001000   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 001001   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001002   000000 701000 xent               TSX1    ASD$READ_PRO
         4 001003   001005 702000 4                  TSX2    s:18231
         4 001004   001024 710000 4                  TRA     s:18253

      834    18229    5            WHENALTRETURN DO;

      835    18230                                                                     /**/
      836    18231    5               CALL INDEX( I, AS_BLANK, USERS_KEY.TXTC );

  18231  4 001005   000000 124400                    SCM     mask='000'O
         4 001006   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         4 001007   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 001010   201676 000100                    ARG     I,,AUTO

      837    18232    5               AS_FIELD1.COUNT = I ;

  18232  4 001011   201676 236100                    LDQ     I,,AUTO
         4 001012   000033 736000                    QLS     27
         4 001013   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      838    18233    5               AS_FIELD1.TEXT = USERS_KEY.TXTC ;

  18233  4 001014   040000 100400                    MLR     fill='040'O
         4 001015   000000 200050 xsym               ADSC9   USERS_KEY                cn=1,n=40
         4 001016   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      839    18234                    %SCREAM( ERR#=E$PRO_NO_EXIST, LEVEL=ERROR, MID='A' );

  18246  4 001017   000010 630400 5                  EPPR0   8
         4 001020   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001021   000000 701000 xent               TSX1    ASH$ERROR
         4 001022   000000 011000                    NOP     0

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:161  
      840    18249    5               GOTO END_OPTION ;

  18249  4 001023   005343 710000 4                  TRA     END_OPTION

      841    18250    5               END; /*  Whenaltreturn  */
      842    18251                                                                     /**/
      843    18252                                                /* It exists                          */
      844    18253    5            IF SUB AND KL$PHDR.TTYP ~= %KLTY_SDEV# THEN DO;

  18253  4 001024   200007 470500                    LDP0    @SUB,,AUTO
         4 001025   000000 234100                    SZN     0,,PR0
         4 001026   001043 605000 4                  TPL     s:18276
         4 001027   201721 471500                    LDP1    PRO$,,AUTO
         4 001030   000100 101500                    MRL     fill='000'O
         4 001031   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         4 001032   202342 000004                    ADSC9   YES_NO_FLG+2,,AUTO       cn=0,n=4
         4 001033   202342 236100                    LDQ     YES_NO_FLG+2,,AUTO
         4 001034   000001 116007                    CMPQ    1,DL
         4 001035   001043 600000 4                  TZE     s:18276

      845    18254        /*E* ERROR: ASA-E$DEVPROTYPE-0
      846    18255             MESSAGE: Profile must be of terminal-device type.
      847    18256             MESSAGE1: The profile be one that describes a terminal-device
      848    18257                       For example, IRBTLP or 2780CR.
      849    18258        */
      850    18259                    %SCREAM( ERR#=E$DEVPROTYPE, LEVEL=ERROR, MID='A' );

  18271  4 001036   000011 630400 5                  EPPR0   9
         4 001037   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001040   000000 701000 xent               TSX1    ASH$ERROR
         4 001041   000000 011000                    NOP     0

      851    18274    5               GOTO END_OPTION;

  18274  4 001042   005343 710000 4                  TRA     END_OPTION

      852    18275    5               END;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:162  
      853    18276    4            IF NOT SUB AND (KL$PHDR.TTYP~=%KLTY_TTY# AND KL$PHDR.TTYP~=%KLTY_LINEDEV#)

  18276  4 001043   000000 234100                    SZN     0,,PR0
         4 001044   001075 604000 4                  TMI     s:18299
         4 001045   201721 471500                    LDP1    PRO$,,AUTO
         4 001046   000100 101500                    MRL     fill='000'O
         4 001047   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         4 001050   202342 000004                    ADSC9   YES_NO_FLG+2,,AUTO       cn=0,n=4
         4 001051   202342 236100                    LDQ     YES_NO_FLG+2,,AUTO
         4 001052   000002 116007                    CMPQ    2,DL
         4 001053   001075 600000 4                  TZE     s:18299
         4 001054   000100 101500                    MRL     fill='000'O
         4 001055   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         4 001056   202343 000004                    ADSC9   YES_NO_FLG+3,,AUTO       cn=0,n=4
         4 001057   202343 236100                    LDQ     YES_NO_FLG+3,,AUTO
         4 001060   000012 116007                    CMPQ    10,DL
         4 001061   001075 600000 4                  TZE     s:18299
         4 001062   000100 101500                    MRL     fill='000'O
         4 001063   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         4 001064   202344 000004                    ADSC9   YES_NO_FLG+4,,AUTO       cn=0,n=4
         4 001065   202344 236100                    LDQ     YES_NO_FLG+4,,AUTO
         4 001066   000006 116007                    CMPQ    6,DL
         4 001067   001075 600000 4                  TZE     s:18299

      854    18277    4                 AND  KL$PHDR.TTYP ~= %KLTY_URP#
      855    18278    5            THEN DO;

      856    18279        /*E* ERROR: ASA-E$ASYNCPROTYPE-0
      857    18280             MESSAGE: Profile must describe an ASYNC (TTY) type device.
      858    18281        */
      859    18282                    %SCREAM( ERR#=E$ASYNCPROTYPE, LEVEL=ERROR, MID='A' );

  18294  4 001070   000012 630400 5                  EPPR0   10
         4 001071   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001072   000000 701000 xent               TSX1    ASH$ERROR
         4 001073   000000 011000                    NOP     0

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:163  
      860    18297    5               GOTO END_OPTION;

  18297  4 001074   005343 710000 4                  TRA     END_OPTION

      861    18298    5               END;
      862    18299    4            PATTR = KL$PHDR.ATTR ;

  18299  4 001075   201721 471500                    LDP1    PRO$,,AUTO
         4 001076   000100 100500                    MLR     fill='000'O
         4 001077   100001 000002                    ADSC9   1,,PR1                   cn=0,n=2
         4 001100   201720 000002                    ADSC9   PATTR,,AUTO              cn=0,n=2

      863    18300    4            IO=KL$PHDR.IO;

  18300  4 001101   003100 060500                    CSL     bolr='003'O
         4 001102   100001 400002                    BDSC    1,,PR1                   by=2,bit=0,n=2
         4 001103   201700 000002                    BDSC    IO,,AUTO                 by=0,bit=0,n=2

      864    18301    4            DDEV=KL$PHDR.DDEV;

  18301  4 001104   000100 100500                    MLR     fill='000'O
         4 001105   100001 600001                    ADSC9   1,,PR1                   cn=3,n=1
         4 001106   200045 000001                    ADSC9   DDEV,,AUTO               cn=0,n=1

      865    18302    4            KL$TREC.PNAME = USERS_KEY ;

  18302  4 001107   200003 473500                    LDP3    @TREC$,,AUTO
         4 001110   300000 474500                    LDP4    0,,PR3
         4 001111   000100 100400                    MLR     fill='000'O
         4 001112   000000 000014 xsym               ADSC9   USERS_KEY                cn=0,n=12
         4 001113   400004 000014                    ADSC9   4,,PR4                   cn=0,n=12

      866    18303    4            PRO_FLAG = AS_TRUE ;

  18303  4 001114   000000 236000 xsym               LDQ     AS_TRUE
         4 001115   400000 376003                    ANQ     -131072,DU
         4 001116   202322 756100                    STQ     PRO_FLAG,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:164  
         4 001117   005343 710000 4                  TRA     END_OPTION

      867    18304                                                                                    /**/
      868    18305    4            SELECT ( 16   /*  EOL_VAL  */ ) ;

  18305  4 001120   005343 710000 4                  TRA     END_OPTION

      869    18306                                                                                    /**/
      870    18307    4            SELECT ( 302 /* HELP_VAL */ ) ;

      871    18308    4            CALL ASH$HELP ;

  18308  4 001121   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001122   000000 701000 xent               TSX1    ASH$HELP
         4 001123   000000 011000                    NOP     0
         4 001124   005343 710000 4                  TRA     END_OPTION

      872    18309                                                              /**/
      873    18310    4            SELECT ( 301 /* QUESTION_VAL */ ) ;

      874    18311    4            CALL ASH$QUEST ;

  18311  4 001125   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001126   000000 701000 xent               TSX1    ASH$QUEST
         4 001127   000000 011000                    NOP     0
         4 001130   005343 710000 4                  TRA     END_OPTION

      875    18312                                                              /**/
      876    18313    4            SELECT ( 300 /* DQUESTION_VAL */ ) ;

      877    18314    4            CALL ASH$DQUEST ;

  18314  4 001131   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001132   000000 701000 xent               TSX1    ASH$DQUEST
         4 001133   000000 011000                    NOP     0
         4 001134   005343 710000 4                  TRA     END_OPTION

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:165  
      878    18315                                                              /**/
      879    18316    4            SELECT ( 12   /*  END_VAL  */ ,

      880    18317    4                 26   /*  BLANK_LINE_VAL */ ) ;
      881    18318                                                /* Done                               */
      882    18319    4            MORE = AS_FALSE ;

  18319  4 001135   000000 236000 xsym               LDQ     AS_FALSE
         4 001136   400000 376003                    ANQ     -131072,DU
         4 001137   201704 756100                    STQ     MORE,,AUTO
         4 001140   005343 710000 4                  TRA     END_OPTION

      883    18320                                                                                    /**/
      884    18321    4            SELECT ( 33 /* TERM_PASS */ ) ;

      885    18322                                                /* Password                           */
      886    18323    5            IF SUB THEN DO;

  18323  4 001141   200007 470500                    LDP0    @SUB,,AUTO
         4 001142   000000 234100                    SZN     0,,PR0
         4 001143   001151 605000 4                  TPL     s:18345

      887    18324        /*E* ERROR: ASA-E$DEVSUBPASS-0
      888    18325             MESSAGE: The PASS option is not legal.
      889    18326             MESSAGE1: Passwords don't make sense for devices that can't log on.
      890    18327        */
      891    18328                    %SCREAM( ERR#=E$DEVSUBPASS, LEVEL=ERROR, MID='A' );

  18340  4 001144   000013 630400 5                  EPPR0   11
         4 001145   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001146   000000 701000 xent               TSX1    ASH$ERROR
         4 001147   000000 011000                    NOP     0

      892    18343    5               GOTO END_OPTION;

  18343  4 001150   005343 710000 4                  TRA     END_OPTION

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:166  
      893    18344    5               END;
      894    18345    4            CODE2 = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  18345  4 001151   202323 471500                    LDP1    PTR$,,AUTO
         4 001152   100003 473500                    LDP3    3,,PR1
         4 001153   300000 236100                    LDQ     0,,PR3
         4 001154   777777 376007                    ANQ     -1,DL
         4 001155   200020 756100                    STQ     CODE2,,AUTO

      895    18346    5            DO SELECT( CODE2 ) ;

  18346  4 001156   000053 116007                    CMPQ    43,DL
         4 001157   001164 602000 4                  TNC     s:18346+6
         4 001160   001204 600000 4                  TZE     s:18353
         4 001161   000057 116007                    CMPQ    47,DL
         4 001162   005343 601000 4                  TNZ     END_OPTION
         4 001163   001237 710000 4                  TRA     s:18377
         4 001164   000007 116007                    CMPQ    7,DL
         4 001165   005343 601000 4                  TNZ     END_OPTION
         4 001166   001167 710000 4                  TRA     s:18349

      896    18347                                                                                    /**/
      897    18348    5               SELECT( 7   /*  NONE_VAL  */ ) ;

      898    18349    5               KL$TREC.PASSWORD = AS_BLANK ;

  18349  4 001167   200003 474500                    LDP4    @TREC$,,AUTO
         4 001170   400000 475500                    LDP5    0,,PR4
         4 001171   040100 100400                    MLR     fill='040'O
         4 001172   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 001173   500002 000010                    ADSC9   2,,PR5                   cn=0,n=8

      899    18350    5               CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;

  18350  4 001174   400000 471500                    LDP1    0,,PR4
         4 001175   100002 633500                    EPPR3   2,,PR1
         4 001176   202342 453500                    STP3    YES_NO_FLG+2,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:167  
         4 001177   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 001200   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001201   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         4 001202   000000 011000                    NOP     0
         4 001203   005343 710000 4                  TRA     END_OPTION

      900    18351                                                                                    /**/
      901    18352    5               SELECT( 43 /* TERM_PW */ ) ;

      902    18353    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  18353  4 001204   100003 236100                    LDQ     3,,PR1
         4 001205   200015 756100                    STQ     BLK$,,AUTO

      903    18354    5               CNT =  OUT$SYM.COUNT ;

  18354  4 001206   200015 474500                    LDP4    BLK$,,AUTO
         4 001207   400004 236100                    LDQ     4,,PR4
         4 001210   000033 772000                    QRL     27
         4 001211   200017 756100                    STQ     CNT,,AUTO

      904    18355    6               IF CNT > 8 THEN DO;

  18355  4 001212   000011 116007                    CMPQ    9,DL
         4 001213   001221 602000 4                  TNC     s:18373

      905    18356                       %SCREAM( ERR#=E$PASSW_TOO_LONG, LEVEL=ERROR, MID='A');

  18368  4 001214   000014 630400 5                  EPPR0   12
         4 001215   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001216   000000 701000 xent               TSX1    ASH$ERROR
         4 001217   000000 011000                    NOP     0

      906    18371    6                  GOTO END_OPTION ;

  18371  4 001220   005343 710000 4                  TRA     END_OPTION

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:168  
      907    18372    6                  END ;            /* Then do                            */
      908    18373    5               KL$TREC.PASSWORD = OUT$SYM.TEXT ;

  18373  4 001221   200003 475500                    LDP5    @TREC$,,AUTO
         4 001222   500000 476500                    LDP6    0,,PR5
         4 001223   000000 620006                    EAX0    0,QL
         4 001224   040100 100540                    MLR     fill='040'O
         4 001225   400004 200010                    ADSC9   4,,PR4                   cn=1,n=*X0
         4 001226   600002 000010                    ADSC9   2,,PR6                   cn=0,n=8

      909    18374    5               CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;

  18374  4 001227   500000 471500                    LDP1    0,,PR5
         4 001230   100002 633500                    EPPR3   2,,PR1
         4 001231   202342 453500                    STP3    YES_NO_FLG+2,,AUTO
         4 001232   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 001233   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001234   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         4 001235   000000 011000                    NOP     0
         4 001236   005343 710000 4                  TRA     END_OPTION

      910    18375                                                                                    /**/
      911    18376    5               SELECT( 47   /*  OCT_PASS_VAL */ ) ;

      912    18377    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);

  18377  4 001237   300003 236100                    LDQ     3,,PR3
         4 001240   200015 756100                    STQ     BLK$,,AUTO

      913    18378    5               CNT = OUT$SYM.COUNT;

  18378  4 001241   200015 474500                    LDP4    BLK$,,AUTO
         4 001242   400004 236100                    LDQ     4,,PR4
         4 001243   000033 772000                    QRL     27
         4 001244   200017 756100                    STQ     CNT,,AUTO

      914    18379    5               IF CNT ~= 24
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:169  

  18379  4 001245   000030 116007                    CMPQ    24,DL
         4 001246   001254 600000 4                  TZE     s:18402

      915    18380    6               THEN DO;

      916    18381        /*E*  ERROR:    AS-E$OCTAL_PASSWORD_LENGTH_ERR-C
      917    18382              MESSAGE: PASSWORD not the right size.
      918    18383              MESSAGE1: PASSWORD in octal form must be 24 characters long.
      919    18384        */
      920    18385                       %SCREAM(ERR#=E$OCTAL_PASSWORD_LENGTH_ERR,LEVEL=ERROR,MID='A');

  18397  4 001247   000015 630400 5                  EPPR0   13
         4 001250   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001251   000000 701000 xent               TSX1    ASH$ERROR
         4 001252   000000 011000                    NOP     0

      921    18400    6                  END; /*  Length error  */

  18400  4 001253   005343 710000 4                  TRA     END_OPTION

      922    18401    6               ELSE DO;

      923    18402    6                  P$ = ADDR ( OUT$SYM.TEXT );

  18402  4 001254   200015 236100                    LDQ     BLK$,,AUTO
         4 001255   000016 036000 5                  ADLQ    14
         4 001256   202324 756100                    STQ     P$,,AUTO

      924    18403    6                  PTR$ = PINCRC (P$,24);

  18403  4 001257   000006 036003                    ADLQ    6,DU
         4 001260   202323 756100                    STQ     PTR$,,AUTO

      925    18404    6                  TEMP$ = ADDR (KL$TREC.PASSWORD);

  18404  4 001261   200003 471500                    LDP1    @TREC$,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:170  
         4 001262   100000 473500                    LDP3    0,,PR1
         4 001263   300002 635500                    EPPR5   2,,PR3
         4 001264   202331 455500                    STP5    TEMP$,,AUTO

      926    18405    7                  DO WHILE P$ < PTR$ ;

  18405  4 001265   202324 116100                    CMPQ    P$,,AUTO
         4 001266   005343 602000 4                  TNC     END_OPTION
         4 001267   005343 600000 4                  TZE     END_OPTION

      927    18406    7                     CALL CHARBIN (L, P$->ACHAR);

  18406  4 001270   202324 470500                    LDP0    P$,,AUTO
         4 001271   000100 305500                    DTB
         4 001272   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1
         4 001273   201703 000004                    NDSC9   L,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      928    18407    7                     P$ = PINCRC (P$,1);

  18407  4 001274   202324 236100                    LDQ     P$,,AUTO
         4 001275   200000 036007                    ADLQ    65536,DL
         4 001276   202324 756100                    STQ     P$,,AUTO

      929    18408    7                     CALL CHARBIN (J, P$-> ACHAR);

  18408  4 001277   202324 470500                    LDP0    P$,,AUTO
         4 001300   000100 305500                    DTB
         4 001301   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1
         4 001302   201701 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      930    18409    7                     P$ = PINCRC (P$,1);

  18409  4 001303   200000 036007                    ADLQ    65536,DL
         4 001304   202324 756100                    STQ     P$,,AUTO

      931    18410    7                     CALL CHARBIN (K, P$->ACHAR);

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:171  
  18410  4 001305   202324 470500                    LDP0    P$,,AUTO
         4 001306   000100 305500                    DTB
         4 001307   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1
         4 001310   201702 000004                    NDSC9   K,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      932    18411    7                     TEMP = L * 64 + J * 8 + K;

  18411  4 001311   201703 236100                    LDQ     L,,AUTO
         4 001312   000003 736000                    QLS     3
         4 001313   201701 036100                    ADLQ    J,,AUTO
         4 001314   000003 736000                    QLS     3
         4 001315   201702 036100                    ADLQ    K,,AUTO
         4 001316   202330 756100                    STQ     TEMP,,AUTO

      933    18412    7                     P$ = PINCRC (P$, 1);

  18412  4 001317   202324 236100                    LDQ     P$,,AUTO
         4 001320   200000 036007                    ADLQ    65536,DL
         4 001321   202324 756100                    STQ     P$,,AUTO

      934    18413    7                     TEMP$ -> ACHAR = BINASC ( TEMP );

  18413  4 001322   202330 236100                    LDQ     TEMP,,AUTO
         4 001323   000033 736000                    QLS     27
         4 001324   000017 276000 5                  ORQ     15
         4 001325   202342 756100                    STQ     YES_NO_FLG+2,,AUTO
         4 001326   202331 470500                    LDP0    TEMP$,,AUTO
         4 001327   040100 100500                    MLR     fill='040'O
         4 001330   202342 000004                    ADSC9   YES_NO_FLG+2,,AUTO       cn=0,n=4
         4 001331   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      935    18414    7                     TEMP$ = PINCRC (TEMP$, 1);

  18414  4 001332   202331 236100                    LDQ     TEMP$,,AUTO
         4 001333   200000 036007                    ADLQ    65536,DL
         4 001334   202331 756100                    STQ     TEMP$,,AUTO

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:172  
      936    18415    7                     END; /*  Do while P$ < PTR$  */

  18415  4 001335   202324 236100                    LDQ     P$,,AUTO
         4 001336   202323 116100                    CMPQ    PTR$,,AUTO
         4 001337   001270 602000 4                  TNC     s:18406

      937    18416    6                  END; /*  Length ok  */

      938    18417    5               END ;                 /* Do case( CODE2 )                   */

  18417  4 001340   005343 710000 4                  TRA     END_OPTION

      939    18418        /**/
      940    18419    4            SELECT (25 /*DEV USE */);

      941    18420    4            CODE2 = PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE;

  18420  4 001341   202323 470500                    LDP0    PTR$,,AUTO
         4 001342   000003 471500                    LDP1    3,,PR0
         4 001343   100000 236100                    LDQ     0,,PR1
         4 001344   777777 376007                    ANQ     -1,DL
         4 001345   200020 756100                    STQ     CODE2,,AUTO

      942    18421    5            DO SELECT (CODE2) ;

  18421  4 001346   000002 116007                    CMPQ    2,DL
         4 001347   001362 602000 4                  TNC     s:18421+12
         4 001350   001501 600000 4                  TZE     s:18447
         4 001351   000060 116007                    CMPQ    48,DL
         4 001352   001357 602000 4                  TNC     s:18421+9
         4 001353   001700 600000 4                  TZE     s:18493
         4 001354   000061 116007                    CMPQ    49,DL
         4 001355   002161 601000 4                  TNZ     s:18584
         4 001356   002031 710000 4                  TRA     s:18540
         4 001357   000057 116007                    CMPQ    47,DL
         4 001360   002161 601000 4                  TNZ     s:18584
         4 001361   001610 710000 4                  TRA     s:18471
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:173  
         4 001362   000001 116007                    CMPQ    1,DL
         4 001363   002161 601000 4                  TNZ     s:18584
         4 001364   001365 710000 4                  TRA     s:18423

      943    18422    5               SELECT ( 1   /*  YES_VAL  */) ;

      944    18423    6               IF NOT CREATE AND DEV_USE ~= CODE2 THEN DO ;

  18423  4 001365   200006 473500                    LDP3    @CREATE,,AUTO
         4 001366   300000 234100                    SZN     0,,PR3
         4 001367   001435 604000 4                  TMI     s:18437
         4 001370   200050 116100                    CMPQ    DEV_USE,,AUTO
         4 001371   001435 600000 4                  TZE     s:18437

      945    18424    6                  IF TYPE = 'CG' THEN TYPE = AS_BLANK;

  18424  4 001372   000000 220000 3                  LDX0    TYPE
         4 001373   000175 100000 2                  CMPX0   Z_ACCT+2
         4 001374   001402 601000 4                  TNZ     s:18425

  18424  4 001375   040100 100400                    MLR     fill='040'O
         4 001376   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 001377   202342 000004                    ADSC9   YES_NO_FLG+2,,AUTO       cn=0,n=4
         4 001400   202342 221100                    LDX1    YES_NO_FLG+2,,AUTO
         4 001401   000000 741000 3                  STX1    TYPE

      946    18425    6                  KL$TREC.ISINFO = KL_CREC.ISINFO ;

  18425  4 001402   200003 470500                    LDP0    @TREC$,,AUTO
         4 001403   000000 471500                    LDP1    0,,PR0
         4 001404   000100 100400                    MLR     fill='000'O
         4 001405   000036 000154 2                  ADSC9   KL_CREC+28               cn=0,n=108
         4 001406   100034 000154                    ADSC9   28,,PR1                  cn=0,n=108

      947    18426    7                  IF TP_FLAG THEN DO ;

  18426  4 001407   202333 234100                    SZN     TP_FLAG,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:174  
         4 001410   001424 605000 4                  TPL     s:18431

      948    18427    7                     KL$TREC.FLAGS.USETP = AS_FALSE ;

  18427  4 001411   000000 471500                    LDP1    0,,PR0
         4 001412   000000 236000 xsym               LDQ     AS_FALSE
         4 001413   000016 772000                    QRL     14
         4 001414   100000 676100                    ERQ     0,,PR1
         4 001415   000010 376003                    ANQ     8,DU
         4 001416   100000 656100                    ERSQ    0,,PR1

      949    18428    7                     TP_FLAG = AS_FALSE ;

  18428  4 001417   000000 236000 xsym               LDQ     AS_FALSE
         4 001420   400000 376003                    ANQ     -131072,DU
         4 001421   202333 756100                    STQ     TP_FLAG,,AUTO

      950    18429    7                     INSTANCE_FLAG = AS_FALSE ;

  18429  4 001422   201677 756100                    STQ     INSTANCE_FLAG,,AUTO

      951    18430    7                     END ;

  18430  4 001423   001432 710000 4                  TRA     s:18435

      952    18431    7                  ELSE IF CG_FLAG THEN DO;

  18431  4 001424   200016 234100                    SZN     CG_FLAG,,AUTO
         4 001425   001432 605000 4                  TPL     s:18435

      953    18432    7                        CG_FLAG = AS_FALSE;

  18432  4 001426   000000 236000 xsym               LDQ     AS_FALSE
         4 001427   400000 376003                    ANQ     -131072,DU
         4 001430   200016 756100                    STQ     CG_FLAG,,AUTO

      954    18433    7                        GROUP_FLAG = AS_FALSE;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:175  

  18433  4 001431   201575 756100                    STQ     GROUP_FLAG,,AUTO

      955    18434    7                        END ;

      956    18435    6                  SNAME_FLG = AS_FALSE ;

  18435  4 001432   000000 236000 xsym               LDQ     AS_FALSE
         4 001433   400000 376003                    ANQ     -131072,DU
         4 001434   202326 756100                    STQ     SNAME_FLG,,AUTO

      957    18436    6                  END ;

      958    18437    5               KL$TREC.KC$CGID.NAME#.CNT = 4;

  18437  4 001435   200003 470500                    LDP0    @TREC$,,AUTO
         4 001436   000000 471500                    LDP1    0,,PR0
         4 001437   004000 236003                    LDQ     2048,DU
         4 001440   100024 552140                    STBQ    20,'40'O,PR1

      959    18438    5               KL$TREC.KC$CGID.NAME#.TXT = 'ISCG';

  18438  4 001441   000000 471500                    LDP1    0,,PR0
         4 001442   040100 100400                    MLR     fill='040'O
         4 001443   000206 000004 2                  ADSC9   Z_ACCT+11                cn=0,n=4
         4 001444   100024 200037                    ADSC9   20,,PR1                  cn=1,n=31

      960    18439    5               KL$TREC.KC$CGID.ACCT# = ':SYS' ;

  18439  4 001445   000000 471500                    LDP1    0,,PR0
         4 001446   040100 100400                    MLR     fill='040'O
         4 001447   000207 000004 2                  ADSC9   Z_ACCT+12                cn=0,n=4
         4 001450   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8

      961    18440    5               KL$TREC.KC$CGID.PSN# = AS_BLANK ;

  18440  4 001451   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:176  
         4 001452   040100 100400                    MLR     fill='040'O
         4 001453   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 001454   100022 000006                    ADSC9   18,,PR1                  cn=0,n=6

      962    18441    5               KL$TREC.ISINFO.NCTLOK=AS_TRUE;

  18441  4 001455   000000 471500                    LDP1    0,,PR0
         4 001456   000000 236000 xsym               LDQ     AS_TRUE
         4 001457   000001 772000                    QRL     1
         4 001460   100034 676100                    ERQ     28,,PR1
         4 001461   200000 376003                    ANQ     65536,DU
         4 001462   100034 656100                    ERSQ    28,,PR1

      963    18442    5               KL$TREC.ISINFO.NCACCT = ':NCTL' ;

  18442  4 001463   000000 471500                    LDP1    0,,PR0
         4 001464   040100 100400                    MLR     fill='040'O
         4 001465   000210 000005 2                  ADSC9   Z_ACCT+13                cn=0,n=5
         4 001466   100035 000010                    ADSC9   29,,PR1                  cn=0,n=8

      964    18443    5               KL$TREC.ISINFO.MXPRI=%KLIS_DFPRI;

  18443  4 001467   000000 471500                    LDP1    0,,PR0
         4 001470   000777 236007                    LDQ     511,DL
         4 001471   100034 552104                    STBQ    28,'04'O,PR1

      965    18444    5               KL$TREC.ISINFO.DFLTPRI=%KLIS_DFPRI;

  18444  4 001472   000000 471500                    LDP1    0,,PR0
         4 001473   777000 236007                    LDQ     -512,DL
         4 001474   100034 552110                    STBQ    28,'10'O,PR1

      966    18445    5               KL$TREC.SUPER = 5 /* INSYM DEVICE */;

  18445  4 001475   000000 471500                    LDP1    0,,PR0
         4 001476   000005 236007                    LDQ     5,DL
         4 001477   100000 552104                    STBQ    0,'04'O,PR1
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:177  
         4 001500   002161 710000 4                  TRA     s:18584

      967    18446    5               SELECT ( 2   /*  NO_VAL  */ ) ;

      968    18447    6               IF NOT CREATE AND DEV_USE ~= CODE2 THEN DO ;

  18447  4 001501   200006 473500                    LDP3    @CREATE,,AUTO
         4 001502   300000 234100                    SZN     0,,PR3
         4 001503   001551 604000 4                  TMI     s:18461
         4 001504   200050 116100                    CMPQ    DEV_USE,,AUTO
         4 001505   001551 600000 4                  TZE     s:18461

      969    18448    6                  KL$TREC.OSINFO = KL_CREC.OSINFO ;

  18448  4 001506   200003 474500                    LDP4    @TREC$,,AUTO
         4 001507   400000 475500                    LDP5    0,,PR4
         4 001510   000100 100400                    MLR     fill='000'O
         4 001511   000071 000024 2                  ADSC9   KL_CREC+55               cn=0,n=20
         4 001512   500067 000024                    ADSC9   55,,PR5                  cn=0,n=20

      970    18449    6                  IF TYPE = 'CG' THEN TYPE = AS_BLANK;

  18449  4 001513   000000 220000 3                  LDX0    TYPE
         4 001514   000175 100000 2                  CMPX0   Z_ACCT+2
         4 001515   001523 601000 4                  TNZ     s:18450

  18449  4 001516   040100 100400                    MLR     fill='040'O
         4 001517   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 001520   202342 000004                    ADSC9   YES_NO_FLG+2,,AUTO       cn=0,n=4
         4 001521   202342 221100                    LDX1    YES_NO_FLG+2,,AUTO
         4 001522   000000 741000 3                  STX1    TYPE

      971    18450    7                  IF TP_FLAG THEN DO ;

  18450  4 001523   202333 234100                    SZN     TP_FLAG,,AUTO
         4 001524   001540 605000 4                  TPL     s:18455

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:178  
      972    18451    7                     KL$TREC.FLAGS.USETP = AS_FALSE ;

  18451  4 001525   400000 470500                    LDP0    0,,PR4
         4 001526   000000 236000 xsym               LDQ     AS_FALSE
         4 001527   000016 772000                    QRL     14
         4 001530   000000 676100                    ERQ     0,,PR0
         4 001531   000010 376003                    ANQ     8,DU
         4 001532   000000 656100                    ERSQ    0,,PR0

      973    18452    7                     TP_FLAG = AS_FALSE ;

  18452  4 001533   000000 236000 xsym               LDQ     AS_FALSE
         4 001534   400000 376003                    ANQ     -131072,DU
         4 001535   202333 756100                    STQ     TP_FLAG,,AUTO

      974    18453    7                     INSTANCE_FLAG = AS_FALSE ;

  18453  4 001536   201677 756100                    STQ     INSTANCE_FLAG,,AUTO

      975    18454    7                     END ;

  18454  4 001537   001546 710000 4                  TRA     s:18459

      976    18455    7                  ELSE IF CG_FLAG THEN DO;

  18455  4 001540   200016 234100                    SZN     CG_FLAG,,AUTO
         4 001541   001546 605000 4                  TPL     s:18459

      977    18456    7                        CG_FLAG = AS_FALSE;

  18456  4 001542   000000 236000 xsym               LDQ     AS_FALSE
         4 001543   400000 376003                    ANQ     -131072,DU
         4 001544   200016 756100                    STQ     CG_FLAG,,AUTO

      978    18457    7                        GROUP_FLAG = AS_FALSE;

  18457  4 001545   201575 756100                    STQ     GROUP_FLAG,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:179  

      979    18458    7                        END ;

      980    18459    6                  SNAME_FLG = AS_FALSE ;

  18459  4 001546   000000 236000 xsym               LDQ     AS_FALSE
         4 001547   400000 376003                    ANQ     -131072,DU
         4 001550   202326 756100                    STQ     SNAME_FLG,,AUTO

      981    18460    6                  END ;

      982    18461    5               KL$TREC.KC$CGID.NAME#.CNT = 4;

  18461  4 001551   200003 470500                    LDP0    @TREC$,,AUTO
         4 001552   000000 471500                    LDP1    0,,PR0
         4 001553   004000 236003                    LDQ     2048,DU
         4 001554   100024 552140                    STBQ    20,'40'O,PR1

      983    18462    5               KL$TREC.KC$CGID.NAME#.TXT = 'OSCG' ;

  18462  4 001555   000000 471500                    LDP1    0,,PR0
         4 001556   040100 100400                    MLR     fill='040'O
         4 001557   000212 000004 2                  ADSC9   Z_ACCT+15                cn=0,n=4
         4 001560   100024 200037                    ADSC9   20,,PR1                  cn=1,n=31

      984    18463    5               KL$TREC.KC$CGID.ACCT# = ':SYS' ;

  18463  4 001561   000000 471500                    LDP1    0,,PR0
         4 001562   040100 100400                    MLR     fill='040'O
         4 001563   000207 000004 2                  ADSC9   Z_ACCT+12                cn=0,n=4
         4 001564   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8

      985    18464    5               KL$TREC.KC$CGID.PSN# = AS_BLANK ;

  18464  4 001565   000000 471500                    LDP1    0,,PR0
         4 001566   040100 100400                    MLR     fill='040'O
         4 001567   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:180  
         4 001570   100022 000006                    ADSC9   18,,PR1                  cn=0,n=6

      986    18465    5               IF SUBSTR(KL$TREC.RENAME,0,2)='LP' THEN

  18465  4 001571   000000 471500                    LDP1    0,,PR0
         4 001572   100011 220100                    LDX0    9,,PR1
         4 001573   000213 100000 2                  CMPX0   Z_ACCT+16
         4 001574   001601 601000 4                  TNZ     s:18468

      987    18466    5                  KL$TREC.OSINFO.FNAME=%KLOS_DFFMLP;

  18466  4 001575   040100 100400                    MLR     fill='040'O
         4 001576   000214 000005 2                  ADSC9   Z_ACCT+17                cn=0,n=5
         4 001577   100070 000006                    ADSC9   56,,PR1                  cn=0,n=6
         4 001600   001604 710000 4                  TRA     s:18469

      988    18467    5               ELSE
      989    18468    5                  KL$TREC.OSINFO.FNAME=%KLOS_DFFMXX;

  18468  4 001601   040100 100400                    MLR     fill='040'O
         4 001602   000216 000005 2                  ADSC9   Z_ACCT+19                cn=0,n=5
         4 001603   100070 000006                    ADSC9   56,,PR1                  cn=0,n=6

      990    18469    5               KL$TREC.SUPER = 6 /* OUTSYM DEVICE */;

  18469  4 001604   000000 471500                    LDP1    0,,PR0
         4 001605   000006 236007                    LDQ     6,DL
         4 001606   100000 552104                    STBQ    0,'04'O,PR1
         4 001607   002161 710000 4                  TRA     s:18584

      991    18470    5               SELECT ( 47 /* RESOURCE */ ) ;

      992    18471    6               IF NOT CREATE AND DEV_USE ~= CODE2 THEN DO ;

  18471  4 001610   200006 473500                    LDP3    @CREATE,,AUTO
         4 001611   300000 234100                    SZN     0,,PR3
         4 001612   001654 604000 4                  TMI     s:18484
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:181  
         4 001613   200050 116100                    CMPQ    DEV_USE,,AUTO
         4 001614   001654 600000 4                  TZE     s:18484

      993    18472    6                  IF TYPE = 'CG' THEN TYPE = AS_BLANK;

  18472  4 001615   000000 220000 3                  LDX0    TYPE
         4 001616   000175 100000 2                  CMPX0   Z_ACCT+2
         4 001617   001625 601000 4                  TNZ     s:18473

  18472  4 001620   040100 100400                    MLR     fill='040'O
         4 001621   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 001622   202342 000004                    ADSC9   YES_NO_FLG+2,,AUTO       cn=0,n=4
         4 001623   202342 221100                    LDX1    YES_NO_FLG+2,,AUTO
         4 001624   000000 741000 3                  STX1    TYPE

      994    18473    7                  IF TP_FLAG THEN DO ;

  18473  4 001625   202333 234100                    SZN     TP_FLAG,,AUTO
         4 001626   001643 605000 4                  TPL     s:18478

      995    18474    7                     KL$TREC.FLAGS.USETP = AS_FALSE ;

  18474  4 001627   200003 471500                    LDP1    @TREC$,,AUTO
         4 001630   100000 474500                    LDP4    0,,PR1
         4 001631   000000 236000 xsym               LDQ     AS_FALSE
         4 001632   000016 772000                    QRL     14
         4 001633   400000 676100                    ERQ     0,,PR4
         4 001634   000010 376003                    ANQ     8,DU
         4 001635   400000 656100                    ERSQ    0,,PR4

      996    18475    7                     TP_FLAG = AS_FALSE ;

  18475  4 001636   000000 236000 xsym               LDQ     AS_FALSE
         4 001637   400000 376003                    ANQ     -131072,DU
         4 001640   202333 756100                    STQ     TP_FLAG,,AUTO

      997    18476    7                     INSTANCE_FLAG = AS_FALSE ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:182  

  18476  4 001641   201677 756100                    STQ     INSTANCE_FLAG,,AUTO

      998    18477    7                     END ;

  18477  4 001642   001651 710000 4                  TRA     s:18482

      999    18478    7                  ELSE IF CG_FLAG THEN DO;

  18478  4 001643   200016 234100                    SZN     CG_FLAG,,AUTO
         4 001644   001651 605000 4                  TPL     s:18482

     1000    18479    7                        CG_FLAG = AS_FALSE;

  18479  4 001645   000000 236000 xsym               LDQ     AS_FALSE
         4 001646   400000 376003                    ANQ     -131072,DU
         4 001647   200016 756100                    STQ     CG_FLAG,,AUTO

     1001    18480    7                        GROUP_FLAG = AS_FALSE;

  18480  4 001650   201575 756100                    STQ     GROUP_FLAG,,AUTO

     1002    18481    7                        END ;

     1003    18482    6                  SNAME_FLG = AS_FALSE ;

  18482  4 001651   000000 236000 xsym               LDQ     AS_FALSE
         4 001652   400000 376003                    ANQ     -131072,DU
         4 001653   202326 756100                    STQ     SNAME_FLG,,AUTO

     1004    18483    6                  END ;

     1005    18484    6               IF CREATE THEN DO ;

  18484  4 001654   300000 234100                    SZN     0,,PR3
         4 001655   001670 605000 4                  TPL     s:18488

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:183  
     1006    18485    6                  KL$TREC.FLAGS = '0'B ;

  18485  4 001656   200003 470500                    LDP0    @TREC$,,AUTO
         4 001657   000000 471500                    LDP1    0,,PR0
         4 001660   000020 236000 5                  LDQ     16
         4 001661   100000 356100                    ANSQ    0,,PR1

     1007    18486    6                  KL$TREC.FLAGS.RNME = AS_TRUE ;

  18486  4 001662   000000 471500                    LDP1    0,,PR0
         4 001663   000000 236000 xsym               LDQ     AS_TRUE
         4 001664   000011 772000                    QRL     9
         4 001665   100000 676100                    ERQ     0,,PR1
         4 001666   000400 376003                    ANQ     256,DU
         4 001667   100000 656100                    ERSQ    0,,PR1

     1008    18487    6                  END ;

     1009    18488    5               KL$TREC.ATYP = %KLAT_RES# ;

  18488  4 001670   200003 470500                    LDP0    @TREC$,,AUTO
         4 001671   000000 471500                    LDP1    0,,PR0
         4 001672   003000 236003                    LDQ     1536,DU
         4 001673   100000 552140                    STBQ    0,'40'O,PR1

     1010    18489    5               KL$TREC.SUPER = 12 /* RES DEVICE */;

  18489  4 001674   000000 471500                    LDP1    0,,PR0
         4 001675   000014 236007                    LDQ     12,DL
         4 001676   100000 552104                    STBQ    0,'04'O,PR1
         4 001677   002161 710000 4                  TRA     s:18584

     1011    18490    5               SELECT (48 /* TP */ ) ;

     1012    18491                                           /* Use can't be tp if
     1013    18492                                              type has been set  */
     1014    18493    5               IF TYPE~=AS_BLANK THEN
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:184  

  18493  4 001700   040000 106400                    CMPC    fill='040'O
         4 001701   000000 000002 3                  ADSC9   TYPE                     cn=0,n=2
         4 001702   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 001703   001717 600000 4                  TZE     s:18515

     1015    18494    6                  IF KL$TREC.SUPER ~= 7 /* TP DEVICE */ THEN DO ;

  18494  4 001704   200003 473500                    LDP3    @TREC$,,AUTO
         4 001705   300000 474500                    LDP4    0,,PR3
         4 001706   400000 236100                    LDQ     0,,PR4
         4 001707   000777 376007                    ANQ     511,DL
         4 001710   000007 116007                    CMPQ    7,DL
         4 001711   001717 600000 4                  TZE     s:18515

     1016    18495        /*E*  ERROR: ASA-E$TPILLEGAL-C
     1017    18496              MESSAGE: Can't specify USE=TP since TYPE has been specified
     1018    18497        */
     1019    18498                          %SCREAM( ERR#=E$TPILLEGAL, LEVEL=ERROR, MID='A' );

  18510  4 001712   000021 630400 5                  EPPR0   17
         4 001713   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001714   000000 701000 xent               TSX1    ASH$ERROR
         4 001715   000000 011000                    NOP     0

     1020    18513    6                     GOTO END_OPTION;

  18513  4 001716   005343 710000 4                  TRA     END_OPTION

     1021    18514    6                     END;
     1022    18515    6               IF NOT CREATE AND DEV_USE ~= CODE2 THEN DO ;

  18515  4 001717   200006 473500                    LDP3    @CREATE,,AUTO
         4 001720   300000 234100                    SZN     0,,PR3
         4 001721   001750 604000 4                  TMI     s:18525
         4 001722   200050 236100                    LDQ     DEV_USE,,AUTO
         4 001723   200020 116100                    CMPQ    CODE2,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:185  
         4 001724   001750 600000 4                  TZE     s:18525

     1023    18516    6                  KL$TREC.KC$CGID = KL_CREC.KC$CGID ;

  18516  4 001725   200003 474500                    LDP4    @TREC$,,AUTO
         4 001726   400000 475500                    LDP5    0,,PR4
         4 001727   000100 100400                    MLR     fill='000'O
         4 001730   000022 000060 2                  ADSC9   KL_CREC+16               cn=0,n=48
         4 001731   500020 000060                    ADSC9   16,,PR5                  cn=0,n=48

     1024    18517    6                  KL$TREC.KC$CGID.NAME#.CNT = 0 ;

  18517  4 001732   400000 470500                    LDP0    0,,PR4
         4 001733   000000 236003                    LDQ     0,DU
         4 001734   000024 552140                    STBQ    20,'40'O,PR0

     1025    18518    6                  KL$TREC.QQ_LOGON = KL_CREC.QQ_LOGON ;

  18518  4 001735   400000 470500                    LDP0    0,,PR4
         4 001736   000100 100400                    MLR     fill='000'O
         4 001737   000076 000170 2                  ADSC9   KL_CREC+60               cn=0,n=120
         4 001740   000074 000170                    ADSC9   60,,PR0                  cn=0,n=120

     1026    18519    7                  IF CG_FLAG THEN DO ;

  18519  4 001741   200016 234100                    SZN     CG_FLAG,,AUTO
         4 001742   001750 605000 4                  TPL     s:18525

     1027    18520    7                     CG_FLAG = AS_FALSE ;

  18520  4 001743   000000 236000 xsym               LDQ     AS_FALSE
         4 001744   400000 376003                    ANQ     -131072,DU
         4 001745   200016 756100                    STQ     CG_FLAG,,AUTO

     1028    18521    7                     GROUP_FLAG = AS_FALSE ;

  18521  4 001746   201575 756100                    STQ     GROUP_FLAG,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:186  

     1029    18522    7                     SNAME_FLG = AS_FALSE ;

  18522  4 001747   202326 756100                    STQ     SNAME_FLG,,AUTO

     1030    18523    7                     END ;

     1031    18524    6                  END ;

     1032    18525    5               TYPE= 'CG' ;

  18525  4 001750   000175 220000 2                  LDX0    Z_ACCT+2
         4 001751   000000 740000 3                  STX0    TYPE

     1033    18526    5               TP_FLAG = AS_TRUE ;

  18526  4 001752   000000 236000 xsym               LDQ     AS_TRUE
         4 001753   400000 376003                    ANQ     -131072,DU
         4 001754   202333 756100                    STQ     TP_FLAG,,AUTO

     1034    18527    6               IF SUB THEN DO;

  18527  4 001755   200007 470500                    LDP0    @SUB,,AUTO
         4 001756   000000 234100                    SZN     0,,PR0
         4 001757   002010 605000 4                  TPL     s:18533

     1035    18528    6                  CALL ASB$FIND_NUM(TWSNR$,TYPE,NUM) ALTRET(FIND_NUM_ERR) ;

  18528  4 001760   201705 631500                    EPPR1   NUM,,AUTO
         4 001761   202344 451500                    STP1    YES_NO_FLG+4,,AUTO
         4 001762   000022 236000 5                  LDQ     18
         4 001763   200004 235100                    LDA     @TWSNR$,,AUTO
         4 001764   202342 757100                    STAQ    YES_NO_FLG+2,,AUTO
         4 001765   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 001766   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001767   000000 701000 xent               TSX1    ASB$FIND_NUM
         4 001770   006144 702000 4                  TSX2    FIND_NUM_ERR
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:187  

     1036    18529    6                  CALL CONCAT(KL$TREC.RENAME,TYPE,NUM,KL$TREC.TWSN#) ;

  18529  4 001771   200003 470500                    LDP0    @TREC$,,AUTO
         4 001772   000000 471500                    LDP1    0,,PR0
         4 001773   000000 220000 3                  LDX0    TYPE
         4 001774   100011 740100                    STX0    9,,PR1
         4 001775   201705 221100                    LDX1    NUM,,AUTO
         4 001776   100011 441100                    SXL1    9,,PR1
         4 001777   100001 236100                    LDQ     1,,PR1
         4 002000   100012 756100                    STQ     10,,PR1

     1037    18530    6                  FROM_KEY.TEXT = KL$TREC.RENAME ;

  18530  4 002001   200003 470500                    LDP0    @TREC$,,AUTO
         4 002002   000000 471500                    LDP1    0,,PR0
         4 002003   040000 100500                    MLR     fill='040'O
         4 002004   100011 000010                    ADSC9   9,,PR1                   cn=0,n=8
         4 002005   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20

     1038    18531    6                  FROM_KEY.CNT = 8 ;

  18531  4 002006   010000 236003                    LDQ     4096,DU
         4 002007   000000 552040 xsym               STBQ    FROM_KEY,'40'O

     1039    18532    6                  END;   /* Do  */

     1040    18533    5               KL$TREC.FLAGS.RNME = AS_FALSE ;

  18533  4 002010   200003 470500                    LDP0    @TREC$,,AUTO
         4 002011   000000 471500                    LDP1    0,,PR0
         4 002012   000000 236000 xsym               LDQ     AS_FALSE
         4 002013   000011 772000                    QRL     9
         4 002014   100000 676100                    ERQ     0,,PR1
         4 002015   000400 376003                    ANQ     256,DU
         4 002016   100000 656100                    ERSQ    0,,PR1

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:188  
     1041    18534    5               KL$TREC.FLAGS.USETP = AS_TRUE ;

  18534  4 002017   000000 471500                    LDP1    0,,PR0
         4 002020   000000 236000 xsym               LDQ     AS_TRUE
         4 002021   000016 772000                    QRL     14
         4 002022   100000 676100                    ERQ     0,,PR1
         4 002023   000010 376003                    ANQ     8,DU
         4 002024   100000 656100                    ERSQ    0,,PR1

     1042    18535    5               KL$TREC.SUPER = 7 /* TP DEVICE */;

  18535  4 002025   000000 471500                    LDP1    0,,PR0
         4 002026   000007 236007                    LDQ     7,DL
         4 002027   100000 552104                    STBQ    0,'04'O,PR1
         4 002030   002161 710000 4                  TRA     s:18584

     1043    18536                                                /**/
     1044    18537    5               SELECT (49 /* COM GROUP  */ ) ;

     1045    18538                                           /* Use can't be cg if
     1046    18539                                              type has been set  */
     1047    18540    5               IF TYPE~=AS_BLANK THEN

  18540  4 002031   040000 106400                    CMPC    fill='040'O
         4 002032   000000 000002 3                  ADSC9   TYPE                     cn=0,n=2
         4 002033   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 002034   002050 600000 4                  TZE     s:18562

     1048    18541    6                  IF KL$TREC.SUPER ~= 11 /* CG DEVICE */ THEN DO ;

  18541  4 002035   200003 470500                    LDP0    @TREC$,,AUTO
         4 002036   000000 471500                    LDP1    0,,PR0
         4 002037   100000 236100                    LDQ     0,,PR1
         4 002040   000777 376007                    ANQ     511,DL
         4 002041   000013 116007                    CMPQ    11,DL
         4 002042   002050 600000 4                  TZE     s:18562

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:189  
     1049    18542        /*E*  ERROR: ASA-E$CGILLEGAL-0
     1050    18543              MESSAGE: Can't specify USE=CG since TYPE has been specified
     1051    18544        */
     1052    18545                          %SCREAM( ERR#=E$CGILLEGAL, LEVEL=ERROR, MID='A' );

  18557  4 002043   000023 630400 5                  EPPR0   19
         4 002044   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002045   000000 701000 xent               TSX1    ASH$ERROR
         4 002046   000000 011000                    NOP     0

     1053    18560    6                     GOTO END_OPTION;

  18560  4 002047   005343 710000 4                  TRA     END_OPTION

     1054    18561    6                     END;
     1055    18562    6               IF NOT CREATE AND DEV_USE ~= CODE2 THEN DO ;

  18562  4 002050   200006 470500                    LDP0    @CREATE,,AUTO
         4 002051   000000 234100                    SZN     0,,PR0
         4 002052   002107 604000 4                  TMI     s:18573
         4 002053   200050 236100                    LDQ     DEV_USE,,AUTO
         4 002054   200020 116100                    CMPQ    CODE2,,AUTO
         4 002055   002107 600000 4                  TZE     s:18573

     1056    18563    6                  KL$TREC.KC$CGID = KL_CREC.KC$CGID ;

  18563  4 002056   200003 471500                    LDP1    @TREC$,,AUTO
         4 002057   100000 473500                    LDP3    0,,PR1
         4 002060   000100 100400                    MLR     fill='000'O
         4 002061   000022 000060 2                  ADSC9   KL_CREC+16               cn=0,n=48
         4 002062   300020 000060                    ADSC9   16,,PR3                  cn=0,n=48

     1057    18564    6                  KL$TREC.KC$CGID.NAME#.CNT = 0 ;

  18564  4 002063   100000 473500                    LDP3    0,,PR1
         4 002064   000000 236003                    LDQ     0,DU
         4 002065   300024 552140                    STBQ    20,'40'O,PR3
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:190  

     1058    18565    6                  KL$TREC.B_CGAUINFO = KL_CREC.B_CGAUINFO ;

  18565  4 002066   100000 473500                    LDP3    0,,PR1
         4 002067   000100 100400                    MLR     fill='000'O
         4 002070   000141 000144 2                  ADSC9   KL_CREC+95               cn=0,n=100
         4 002071   300137 000144                    ADSC9   95,,PR3                  cn=0,n=100

     1059    18566    7                  IF TP_FLAG THEN DO ;

  18566  4 002072   202333 234100                    SZN     TP_FLAG,,AUTO
         4 002073   002107 605000 4                  TPL     s:18573

     1060    18567    7                     KL$TREC.FLAGS.USETP = AS_FALSE ;

  18567  4 002074   100000 473500                    LDP3    0,,PR1
         4 002075   000000 236000 xsym               LDQ     AS_FALSE
         4 002076   000016 772000                    QRL     14
         4 002077   300000 676100                    ERQ     0,,PR3
         4 002100   000010 376003                    ANQ     8,DU
         4 002101   300000 656100                    ERSQ    0,,PR3

     1061    18568    7                     TP_FLAG = AS_FALSE ;

  18568  4 002102   000000 236000 xsym               LDQ     AS_FALSE
         4 002103   400000 376003                    ANQ     -131072,DU
         4 002104   202333 756100                    STQ     TP_FLAG,,AUTO

     1062    18569    7                     INSTANCE_FLAG = AS_FALSE ;

  18569  4 002105   201677 756100                    STQ     INSTANCE_FLAG,,AUTO

     1063    18570    7                     SNAME_FLG = AS_FALSE ;

  18570  4 002106   202326 756100                    STQ     SNAME_FLG,,AUTO

     1064    18571    7                     END ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:191  

     1065    18572    6                  END ;

     1066    18573    5               TYPE='CG';

  18573  4 002107   000175 220000 2                  LDX0    Z_ACCT+2
         4 002110   000000 740000 3                  STX0    TYPE

     1067    18574    5               CG_FLAG = AS_TRUE ;

  18574  4 002111   000000 236000 xsym               LDQ     AS_TRUE
         4 002112   400000 376003                    ANQ     -131072,DU
         4 002113   200016 756100                    STQ     CG_FLAG,,AUTO

     1068    18575    6               IF SUB THEN DO;

  18575  4 002114   200007 471500                    LDP1    @SUB,,AUTO
         4 002115   100000 234100                    SZN     0,,PR1
         4 002116   002147 605000 4                  TPL     s:18581

     1069    18576    6                  CALL ASB$FIND_NUM(TWSNR$,TYPE,NUM) ALTRET(FIND_NUM_ERR) ;

  18576  4 002117   201705 633500                    EPPR3   NUM,,AUTO
         4 002120   202344 453500                    STP3    YES_NO_FLG+4,,AUTO
         4 002121   000022 236000 5                  LDQ     18
         4 002122   200004 235100                    LDA     @TWSNR$,,AUTO
         4 002123   202342 757100                    STAQ    YES_NO_FLG+2,,AUTO
         4 002124   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 002125   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002126   000000 701000 xent               TSX1    ASB$FIND_NUM
         4 002127   006144 702000 4                  TSX2    FIND_NUM_ERR

     1070    18577    6                  CALL CONCAT(KL$TREC.RENAME,TYPE,NUM,KL$TREC.TWSN#) ;

  18577  4 002130   200003 470500                    LDP0    @TREC$,,AUTO
         4 002131   000000 471500                    LDP1    0,,PR0
         4 002132   000000 220000 3                  LDX0    TYPE
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:192  
         4 002133   100011 740100                    STX0    9,,PR1
         4 002134   201705 221100                    LDX1    NUM,,AUTO
         4 002135   100011 441100                    SXL1    9,,PR1
         4 002136   100001 236100                    LDQ     1,,PR1
         4 002137   100012 756100                    STQ     10,,PR1

     1071    18578    6                  FROM_KEY.TEXT = KL$TREC.RENAME ;

  18578  4 002140   200003 470500                    LDP0    @TREC$,,AUTO
         4 002141   000000 471500                    LDP1    0,,PR0
         4 002142   040000 100500                    MLR     fill='040'O
         4 002143   100011 000010                    ADSC9   9,,PR1                   cn=0,n=8
         4 002144   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20

     1072    18579    6                  FROM_KEY.CNT= 8 ;

  18579  4 002145   010000 236003                    LDQ     4096,DU
         4 002146   000000 552040 xsym               STBQ    FROM_KEY,'40'O

     1073    18580    6                  END;   /* Do  */

     1074    18581    5               KL$TREC.FLAGS.RNME =AS_FALSE ;

  18581  4 002147   200003 470500                    LDP0    @TREC$,,AUTO
         4 002150   000000 471500                    LDP1    0,,PR0
         4 002151   000000 236000 xsym               LDQ     AS_FALSE
         4 002152   000011 772000                    QRL     9
         4 002153   100000 676100                    ERQ     0,,PR1
         4 002154   000400 376003                    ANQ     256,DU
         4 002155   100000 656100                    ERSQ    0,,PR1

     1075    18582    5               KL$TREC.SUPER = 11 /* CG DEVICE */;

  18582  4 002156   000000 471500                    LDP1    0,,PR0
         4 002157   000013 236007                    LDQ     11,DL
         4 002160   100000 552104                    STBQ    0,'04'O,PR1

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:193  
     1076    18583    5               END;   /* Do case (CODE2)  */

     1077    18584    4            DEV_USE = CODE2 ;

  18584  4 002161   200020 235100                    LDA     CODE2,,AUTO
         4 002162   200050 755100                    STA     DEV_USE,,AUTO
         4 002163   005343 710000 4                  TRA     END_OPTION

     1078    18585        /**/
     1079    18586    4            SELECT ( 24 /* DEV_TYPE */);

     1080    18587
     1081    18588    5            IF DEV_USE = 48 /* TP */ OR DEV_USE=49 /* COM GROUP  */ THEN DO;

  18588  4 002164   200050 235100                    LDA     DEV_USE,,AUTO
         4 002165   000060 115007                    CMPA    48,DL
         4 002166   002171 600000 4                  TZE     s:18605
         4 002167   000061 115007                    CMPA    49,DL
         4 002170   002176 601000 4                  TNZ     s:18610

     1082    18589                     /*E* ERROR:  ASA-E$TYPEILLEGAL-0
     1083    18590                          MESSAGE: TYPE legal only if USE=IN, USE=OUT or USE=RES
     1084    18591              MESSAGE1: Specify USE=IN, USE=OUT or USE=RES unless you want USE=CG or USE=TP
     1085    18592                     */
     1086    18593                    %SCREAM( ERR#=E$TYPEILLEGAL, LEVEL=ERROR, MID='A' );

  18605  4 002171   000024 630400 5                  EPPR0   20
         4 002172   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002173   000000 701000 xent               TSX1    ASH$ERROR
         4 002174   000000 011000                    NOP     0

     1087    18608    5               GOTO END_OPTION;

  18608  4 002175   005343 710000 4                  TRA     END_OPTION

     1088    18609    5               END;
     1089    18610    4            BLK$=PTR$->P$NODE.SUBLK$(0);
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:194  

  18610  4 002176   202323 470500                    LDP0    PTR$,,AUTO
         4 002177   000003 236100                    LDQ     3,,PR0
         4 002200   200015 756100                    STQ     BLK$,,AUTO

     1090    18611    4            TEMP_TYPE=OUT$SYM.TEXT;

  18611  4 002201   200015 471500                    LDP1    BLK$,,AUTO
         4 002202   100004 236100                    LDQ     4,,PR1
         4 002203   000033 772000                    QRL     27
         4 002204   000000 620006                    EAX0    0,QL
         4 002205   040100 100540                    MLR     fill='040'O
         4 002206   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 002207   202332 000004                    ADSC9   TEMP_TYPE,,AUTO          cn=0,n=4

     1091    18612    5            IF OUT$SYM.COUNT ~=2 THEN DO;

  18612  4 002210   000033 736000                    QLS     27
         4 002211   002000 116003                    CMPQ    1024,DU
         4 002212   002220 600000 4                  TZE     s:18633

     1092    18613        /*E* ERROR:   ASA-E$DEV_TYPE_LEN_ERR-C
     1093    18614             MESSAGE: TYPE must be 2 characters long.
     1094    18615        */
     1095    18616                    %SCREAM( ERR#=E$DEV_TYPE_LEN_ERR, LEVEL=ERROR, MID='A' );

  18628  4 002213   000025 630400 5                  EPPR0   21
         4 002214   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002215   000000 701000 xent               TSX1    ASH$ERROR
         4 002216   000000 011000                    NOP     0

     1096    18631    5               GOTO END_OPTION;

  18631  4 002217   005343 710000 4                  TRA     END_OPTION

     1097    18632    5               END;
     1098    18633    5            DO J = 0 TO 1 ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:195  

  18633  4 002220   201701 450100                    STZ     J,,AUTO

     1099    18634    5               CALL INDEX( K, SUBSTR(TEMP_TYPE,J,1), AS_VALID_DEVICE_TYPE_CHARS )
             18634                        ALTRET( BAD_DEVICE_TYPE ) ;

  18634  4 002221   201701 235100                    LDA     J,,AUTO
         4 002222   000105 124400                    SCM     mask='000'O
         4 002223   000000 000044 xsym               ADSC9   AS_VALID_DEVICE_TYPE_CHARS cn=0,n=36
         4 002224   202332 000001                    ADSC9   TEMP_TYPE,A,AUTO         cn=0,n=1
         4 002225   201702 000100                    ARG     K,,AUTO
         4 002226   002230 606400 4                  TTN     BAD_DEVICE_TYPE

     1100    18635    6               IF '0'B THEN DO ;

  18635  4 002227   002243 710000 4                  TRA     s:18661

     1101    18636    6   BAD_DEVICE_TYPE:
     1102    18637        /*    ERROR:  ASA-E$INVALID_DEV_TYPE_CHAR-C
     1103    18638        MESSAGE: "%U1" is an invalid character for a device type.
     1104    18639        MESSAGE1: The character set for a device type consists of uppercase
     1105    18640                        letters (a-z) and digits (0-9).
     1106    18641        */
     1107    18642    6                  AS_FIELD1.COUNT = 1 ;

  18642  4 002230   001000 236003       BAD_DEVICE_* LDQ     512,DU
         4 002231   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     1108    18643    6                  AS_FIELD1.TEXT = SUBSTR( TEMP_TYPE, J, 1 ) ;

  18643  4 002232   201701 235100                    LDA     J,,AUTO
         4 002233   040000 100505                    MLR     fill='040'O
         4 002234   202332 000001                    ADSC9   TEMP_TYPE,A,AUTO         cn=0,n=1
         4 002235   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     1109    18644                       %SCREAM( ERR#=E$INVALID_DEV_TYPE_CHAR, LEVEL=ERROR, MID='A') ;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:196  
  18656  4 002236   000026 630400 5                  EPPR0   22
         4 002237   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002240   000000 701000 xent               TSX1    ASH$ERROR
         4 002241   000000 011000                    NOP     0

     1110    18659    6                  GOTO END_OPTION ;

  18659  4 002242   005343 710000 4                  TRA     END_OPTION

     1111    18660    6                  END ; /* Then do */
     1112    18661    5               END ;

  18661  4 002243   000001 035007                    ADLA    1,DL
         4 002244   201701 755100                    STA     J,,AUTO
         4 002245   000002 115007                    CMPA    2,DL
         4 002246   002221 602000 4                  TNC     s:18634

     1113    18662    4            IF NOT CREATE THEN

  18662  4 002247   200006 470500                    LDP0    @CREATE,,AUTO
         4 002250   000000 234100                    SZN     0,,PR0
         4 002251   002265 604000 4                  TMI     s:18687

     1114    18663    5               IF TEMP_TYPE~=SUBSTR(KL$TREC.RENAME,0,2) THEN DO;

  18663  4 002252   200003 471500                    LDP1    @TREC$,,AUTO
         4 002253   100000 473500                    LDP3    0,,PR1
         4 002254   040100 106500                    CMPC    fill='040'O
         4 002255   202332 000004                    ADSC9   TEMP_TYPE,,AUTO          cn=0,n=4
         4 002256   300011 000002                    ADSC9   9,,PR3                   cn=0,n=2
         4 002257   005343 600000 4                  TZE     END_OPTION

     1115    18664        /*E* ERROR: ASA-E$DEVTCHANGE-0
     1116    18665             MESSAGE: You can't modify a devices TYPE.
     1117    18666             MESSAGE1: The TYPE option of a device can not be modified.
     1118    18667                  You might try removing the device and re-creating it.
     1119    18668        */
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:197  
     1120    18669                       %SCREAM( ERR#=E$DEVTCHANGE, LEVEL=ERROR, MID='A' );

  18681  4 002260   000027 630400 5                  EPPR0   23
         4 002261   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002262   000000 701000 xent               TSX1    ASH$ERROR
         4 002263   000000 011000                    NOP     0

     1121    18684    5                  GOTO END_OPTION;

  18684  4 002264   005343 710000 4                  TRA     END_OPTION

     1122    18685    5                  END;
     1123    18686    4               ELSE GOTO END_OPTION;
     1124    18687    4            TYPE = TEMP_TYPE ;

  18687  4 002265   202332 220100                    LDX0    TEMP_TYPE,,AUTO
         4 002266   000000 740000 3                  STX0    TYPE

     1125    18688    4            CALL ASB$FIND_NUM(TWSNR$,TYPE,NUM) ALTRET(FIND_NUM_ERR);

  18688  4 002267   201705 631500                    EPPR1   NUM,,AUTO
         4 002270   202344 451500                    STP1    YES_NO_FLG+4,,AUTO
         4 002271   000022 236000 5                  LDQ     18
         4 002272   200004 235100                    LDA     @TWSNR$,,AUTO
         4 002273   202342 757100                    STAQ    YES_NO_FLG+2,,AUTO
         4 002274   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 002275   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002276   000000 701000 xent               TSX1    ASB$FIND_NUM
         4 002277   006144 702000 4                  TSX2    FIND_NUM_ERR

     1126    18689    4            CALL CONCAT(KL$TREC.RENAME,TYPE,NUM,KL$TREC.TWSN#);

  18689  4 002300   200003 470500                    LDP0    @TREC$,,AUTO
         4 002301   000000 471500                    LDP1    0,,PR0
         4 002302   000000 220000 3                  LDX0    TYPE
         4 002303   100011 740100                    STX0    9,,PR1
         4 002304   201705 221100                    LDX1    NUM,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:198  
         4 002305   100011 441100                    SXL1    9,,PR1
         4 002306   100001 236100                    LDQ     1,,PR1
         4 002307   100012 756100                    STQ     10,,PR1

     1127    18690    4            IF SUB THEN

  18690  4 002310   200007 470500                    LDP0    @SUB,,AUTO
         4 002311   000000 234100                    SZN     0,,PR0
         4 002312   002545 605000 4                  TPL     s:18741

     1128    18691    5            DO ;

     1129    18692    5               FROM_KEY.TEXT = KL$TREC.RENAME ;

  18692  4 002313   200003 471500                    LDP1    @TREC$,,AUTO
         4 002314   100000 473500                    LDP3    0,,PR1
         4 002315   040000 100500                    MLR     fill='040'O
         4 002316   300011 000010                    ADSC9   9,,PR3                   cn=0,n=8
         4 002317   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20

     1130    18693    5               FROM_KEY.CNT= 8 ;

  18693  4 002320   010000 236003                    LDQ     4096,DU
         4 002321   000000 552040 xsym               STBQ    FROM_KEY,'40'O

     1131    18694    6               IF CREATE THEN DO;

  18694  4 002322   200006 473500                    LDP3    @CREATE,,AUTO
         4 002323   300000 234100                    SZN     0,,PR3
         4 002324   002545 605000 4                  TPL     s:18741

     1132    18695    7                  IF NOT DEVNUM_SET THEN DO;

  18695  4 002325   200047 234100                    SZN     DEVNUM_SET,,AUTO
         4 002326   002502 604000 4                  TMI     s:18727

     1133    18696    8                     IF TERM_T = 'STDHASP' THEN DO;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:199  

  18696  4 002327   200010 474500                    LDP4    @TERM_T,,AUTO
         4 002330   040000 106500                    CMPC    fill='040'O
         4 002331   400000 000007                    ADSC9   0,,PR4                   cn=0,n=7
         4 002332   000226 000007 2                  ADSC9   Z_ACCT+27                cn=0,n=7
         4 002333   002405 601000 4                  TNZ     s:18709

     1134    18697    8                        IF TYPE = 'CP' THEN

  18697  4 002334   000000 220000 3                  LDX0    TYPE
         4 002335   000230 100000 2                  CMPX0   Z_ACCT+29
         4 002336   002344 601000 4                  TNZ     s:18699

     1135    18698    8                           KL$DADR.DEVNUM# = %KLDN_HASPCP#;

  18698  4 002337   200013 475500                    LDP5    @DADR$,,AUTO
         4 002340   500000 476500                    LDP6    0,,PR5
         4 002341   003100 060400                    CSL     bolr='003'O
         4 002342   000030 000011 5                  BDSC    24                       by=0,bit=0,n=9
         4 002343   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1136    18699    8                        IF TYPE = 'CR' THEN

  18699  4 002344   000000 220000 3                  LDX0    TYPE
         4 002345   000231 100000 2                  CMPX0   Z_ACCT+30
         4 002346   002354 601000 4                  TNZ     s:18701

     1137    18700    8                           KL$DADR.DEVNUM# = %KLDN_HASPCR#;

  18700  4 002347   200013 475500                    LDP5    @DADR$,,AUTO
         4 002350   500000 476500                    LDP6    0,,PR5
         4 002351   003100 060400                    CSL     bolr='003'O
         4 002352   000031 000011 5                  BDSC    25                       by=0,bit=0,n=9
         4 002353   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1138    18701    8                        IF TYPE = 'LP' THEN

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:200  
  18701  4 002354   000000 220000 3                  LDX0    TYPE
         4 002355   000213 100000 2                  CMPX0   Z_ACCT+16
         4 002356   002364 601000 4                  TNZ     s:18703

     1139    18702    8                           KL$DADR.DEVNUM# = %KLDN_HASPLP#;

  18702  4 002357   200013 475500                    LDP5    @DADR$,,AUTO
         4 002360   500000 476500                    LDP6    0,,PR5
         4 002361   003100 060400                    CSL     bolr='003'O
         4 002362   000032 000011 5                  BDSC    26                       by=0,bit=0,n=9
         4 002363   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1140    18703    8                        IF TYPE = 'LI' THEN

  18703  4 002364   000000 220000 3                  LDX0    TYPE
         4 002365   000232 100000 2                  CMPX0   Z_ACCT+31
         4 002366   002374 601000 4                  TNZ     s:18705

     1141    18704    8                           KL$DADR.DEVNUM# = %KLDN_HASPLP2#;

  18704  4 002367   200013 475500                    LDP5    @DADR$,,AUTO
         4 002370   500000 476500                    LDP6    0,,PR5
         4 002371   003100 060400                    CSL     bolr='003'O
         4 002372   000033 000011 5                  BDSC    27                       by=0,bit=0,n=9
         4 002373   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1142    18705    8                        IF TYPE = 'JE' THEN

  18705  4 002374   000000 220000 3                  LDX0    TYPE
         4 002375   000233 100000 2                  CMPX0   Z_ACCT+32
         4 002376   002502 601000 4                  TNZ     s:18727

     1143    18706    8                           KL$DADR.DEVNUM# = %KLDN_HASPCP#;

  18706  4 002377   200013 475500                    LDP5    @DADR$,,AUTO
         4 002400   500000 476500                    LDP6    0,,PR5
         4 002401   003100 060400                    CSL     bolr='003'O
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:201  
         4 002402   000030 000011 5                  BDSC    24                       by=0,bit=0,n=9
         4 002403   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1144    18707    8                        END; /*  Term type is stdhasp  */

  18707  4 002404   002502 710000 4                  TRA     s:18727

     1145    18708    7                     ELSE
     1146    18709    8                        IF TERM_T = 'STD2780' THEN DO;

  18709  4 002405   040000 106500                    CMPC    fill='040'O
         4 002406   400000 000007                    ADSC9   0,,PR4                   cn=0,n=7
         4 002407   000234 000007 2                  ADSC9   Z_ACCT+33                cn=0,n=7
         4 002410   002444 601000 4                  TNZ     s:18718

     1147    18710    8                           IF TYPE = 'CP' THEN

  18710  4 002411   000000 220000 3                  LDX0    TYPE
         4 002412   000230 100000 2                  CMPX0   Z_ACCT+29
         4 002413   002421 601000 4                  TNZ     s:18712

     1148    18711    8                              KL$DADR.DEVNUM# = %KLDN_2780CP#;

  18711  4 002414   200013 475500                    LDP5    @DADR$,,AUTO
         4 002415   500000 476500                    LDP6    0,,PR5
         4 002416   003100 060400                    CSL     bolr='003'O
         4 002417   000034 000011 5                  BDSC    28                       by=0,bit=0,n=9
         4 002420   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1149    18712    8                           IF TYPE = 'CR' THEN

  18712  4 002421   000000 220000 3                  LDX0    TYPE
         4 002422   000231 100000 2                  CMPX0   Z_ACCT+30
         4 002423   002431 601000 4                  TNZ     s:18714

     1150    18713    8                              KL$DADR.DEVNUM# = %KLDN_2780CR#;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:202  
  18713  4 002424   200013 475500                    LDP5    @DADR$,,AUTO
         4 002425   500000 476500                    LDP6    0,,PR5
         4 002426   003100 060400                    CSL     bolr='003'O
         4 002427   000035 000011 5                  BDSC    29                       by=0,bit=0,n=9
         4 002430   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1151    18714    8                           IF TYPE = 'LI' OR TYPE = 'LP' THEN

  18714  4 002431   000000 220000 3                  LDX0    TYPE
         4 002432   000232 100000 2                  CMPX0   Z_ACCT+31
         4 002433   002436 600000 4                  TZE     s:18715
         4 002434   000213 100000 2                  CMPX0   Z_ACCT+16
         4 002435   002502 601000 4                  TNZ     s:18727

     1152    18715    8                              KL$DADR.DEVNUM# = %KLDN_2780LP#;

  18715  4 002436   200013 475500                    LDP5    @DADR$,,AUTO
         4 002437   500000 476500                    LDP6    0,,PR5
         4 002440   003100 060400                    CSL     bolr='003'O
         4 002441   000036 000011 5                  BDSC    30                       by=0,bit=0,n=9
         4 002442   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1153    18716    8                           END; /*  Term type is STD2780  */

  18716  4 002443   002502 710000 4                  TRA     s:18727

     1154    18717    7                        ELSE
     1155    18718    8                           IF TERM_T = 'STD3780' THEN DO;

  18718  4 002444   040000 106500                    CMPC    fill='040'O
         4 002445   400000 000007                    ADSC9   0,,PR4                   cn=0,n=7
         4 002446   000236 000007 2                  ADSC9   Z_ACCT+35                cn=0,n=7
         4 002447   002502 601000 4                  TNZ     s:18727

     1156    18719    8                              IF TYPE = 'CP' THEN

  18719  4 002450   000000 220000 3                  LDX0    TYPE
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:203  
         4 002451   000230 100000 2                  CMPX0   Z_ACCT+29
         4 002452   002460 601000 4                  TNZ     s:18721

     1157    18720    8                                 KL$DADR.DEVNUM# = %KLDN_3780CP#;

  18720  4 002453   200013 475500                    LDP5    @DADR$,,AUTO
         4 002454   500000 476500                    LDP6    0,,PR5
         4 002455   003100 060400                    CSL     bolr='003'O
         4 002456   000037 000011 5                  BDSC    31                       by=0,bit=0,n=9
         4 002457   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1158    18721    8                              IF TYPE = 'CR' THEN

  18721  4 002460   000000 220000 3                  LDX0    TYPE
         4 002461   000231 100000 2                  CMPX0   Z_ACCT+30
         4 002462   002470 601000 4                  TNZ     s:18723

     1159    18722    8                                 KL$DADR.DEVNUM# = %KLDN_3780CR#;

  18722  4 002463   200013 475500                    LDP5    @DADR$,,AUTO
         4 002464   500000 476500                    LDP6    0,,PR5
         4 002465   003100 060400                    CSL     bolr='003'O
         4 002466   000002 000011 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=9
         4 002467   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1160    18723    8                              IF TYPE = 'LI' OR TYPE = 'LP' THEN

  18723  4 002470   000000 220000 3                  LDX0    TYPE
         4 002471   000232 100000 2                  CMPX0   Z_ACCT+31
         4 002472   002475 600000 4                  TZE     s:18724
         4 002473   000213 100000 2                  CMPX0   Z_ACCT+16
         4 002474   002502 601000 4                  TNZ     s:18727

     1161    18724    8                                 KL$DADR.DEVNUM# = %KLDN_3780LP#;

  18724  4 002475   200013 475500                    LDP5    @DADR$,,AUTO
         4 002476   500000 476500                    LDP6    0,,PR5
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:204  
         4 002477   003100 060400                    CSL     bolr='003'O
         4 002500   000040 000011 5                  BDSC    32                       by=0,bit=0,n=9
         4 002501   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1162    18725    8                              END; /*  Term type is STD3780  */

     1163    18726    7                     END; /*  Not DEVNUM_SET  */

     1164    18727    7                  IF NOT DEVCTL_SET THEN DO;

  18727  4 002502   200046 234100                    SZN     DEVCTL_SET,,AUTO
         4 002503   002545 604000 4                  TMI     s:18741

     1165    18728    8                     IF TERM_T = 'STDHASP' THEN DO;

  18728  4 002504   200010 474500                    LDP4    @TERM_T,,AUTO
         4 002505   040000 106500                    CMPC    fill='040'O
         4 002506   400000 000007                    ADSC9   0,,PR4                   cn=0,n=7
         4 002507   000226 000007 2                  ADSC9   Z_ACCT+27                cn=0,n=7
         4 002510   002545 601000 4                  TNZ     s:18741

     1166    18729    9                        IF TYPE = 'CP' OR TYPE = 'CR' THEN DO;

  18729  4 002511   000000 220000 3                  LDX0    TYPE
         4 002512   000230 100000 2                  CMPX0   Z_ACCT+29
         4 002513   002516 600000 4                  TZE     s:18730
         4 002514   000231 100000 2                  CMPX0   Z_ACCT+30
         4 002515   002530 601000 4                  TNZ     s:18733

     1167    18730    9                           KL$DADR.DEVCTL.B = %KLDCB_HASPCP#;

  18730  4 002516   200013 475500                    LDP5    @DADR$,,AUTO
         4 002517   500000 476500                    LDP6    0,,PR5
         4 002520   003100 060400                    CSL     bolr='003'O
         4 002521   000041 000010 5                  BDSC    33                       by=0,bit=0,n=8
         4 002522   600000 610010                    BDSC    0,,PR6                   by=3,bit=1,n=8

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:205  
     1168    18731    9                           KL$DADR.DEVCTL.T = '0'B;

  18731  4 002523   500000 476500                    LDP6    0,,PR5
         4 002524   003100 060400                    CSL     bolr='003'O
         4 002525   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         4 002526   600000 410010                    BDSC    0,,PR6                   by=2,bit=1,n=8

     1169    18732    9                           END; /*  Type 'CP' or 'CR'  */

  18732  4 002527   002545 710000 4                  TRA     s:18741

     1170    18733    9                        ELSE IF TYPE = 'LI' OR TYPE = 'LP' THEN DO;

  18733  4 002530   000232 100000 2                  CMPX0   Z_ACCT+31
         4 002531   002534 600000 4                  TZE     s:18734
         4 002532   000213 100000 2                  CMPX0   Z_ACCT+16
         4 002533   002545 601000 4                  TNZ     s:18741

     1171    18734    9                              KL$DADR.DEVCTL.T = %KLDCT_HASPLP#;

  18734  4 002534   200013 475500                    LDP5    @DADR$,,AUTO
         4 002535   500000 476500                    LDP6    0,,PR5
         4 002536   003100 060400                    CSL     bolr='003'O
         4 002537   000042 000010 5                  BDSC    34                       by=0,bit=0,n=8
         4 002540   600000 410010                    BDSC    0,,PR6                   by=2,bit=1,n=8

     1172    18735    9                              KL$DADR.DEVCTL.B = '0'B;

  18735  4 002541   500000 476500                    LDP6    0,,PR5
         4 002542   003100 060400                    CSL     bolr='003'O
         4 002543   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         4 002544   600000 610010                    BDSC    0,,PR6                   by=3,bit=1,n=8

     1173    18736    9                              END; /*  Type 'LI' or 'LP'  */

     1174    18737    8                        END; /*  Term type is stdhasp  */

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:206  
     1175    18738    7                     END; /*  Not DEVCTL_SET  */

     1176    18739    6                  END; /*  Create  */

     1177    18740    5               END;   /* Do  */

     1178    18741    5            IF SUB AND KL$TREC.PNAME.TXT=' ' THEN DO;

  18741  4 002545   000000 234100                    SZN     0,,PR0
         4 002546   005343 605000 4                  TPL     END_OPTION
         4 002547   200003 471500                    LDP1    @TREC$,,AUTO
         4 002550   100000 473500                    LDP3    0,,PR1
         4 002551   040000 106500                    CMPC    fill='040'O
         4 002552   300004 200013                    ADSC9   4,,PR3                   cn=1,n=11
         4 002553   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002554   005343 601000 4                  TNZ     END_OPTION

     1179    18742    5               CALL CONCAT(KL$TREC.PNAME.TXT,TERM_T,TYPE);

  18742  4 002555   200010 474500                    LDP4    @TERM_T,,AUTO
         4 002556   040100 100500                    MLR     fill='040'O
         4 002557   400000 000007                    ADSC9   0,,PR4                   cn=0,n=7
         4 002560   300004 200007                    ADSC9   4,,PR3                   cn=1,n=7
         4 002561   000000 236000 3                  LDQ     TYPE
         4 002562   777777 376003                    ANQ     -1,DU
         4 002563   040040 276007                    ORQ     16416,DL
         4 002564   300006 756100                    STQ     6,,PR3

     1180    18743    5               KL$TREC.PNAME.CNT=6;

  18743  4 002565   200003 470500                    LDP0    @TREC$,,AUTO
         4 002566   000000 471500                    LDP1    0,,PR0
         4 002567   006000 236003                    LDQ     3072,DU
         4 002570   100004 552140                    STBQ    4,'40'O,PR1

     1181    18744    5               END;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:207  
  18744  4 002571   005343 710000 4                  TRA     END_OPTION

     1182    18745                                                                                    /**/
     1183    18746    4            SELECT ( 30 /*DEV_MXPRIO*/ ) ;

     1184    18747    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR ;

  18747  4 002572   200050 236100                    LDQ     DEV_USE,,AUTO
         4 002573   000000 116000 2                  CMPQ    DEV_IN_VAL
         4 002574   006137 601000 4                  TNZ     DEV_IN_ERR

     1185    18748    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  18748  4 002575   100003 236100                    LDQ     3,,PR1
         4 002576   200015 756100                    STQ     BLK$,,AUTO

     1186    18749    4            CALL CHARBIN( CNT, OUT$SYM.TEXT ) ;

  18749  4 002577   200015 473500                    LDP3    BLK$,,AUTO
         4 002600   300004 236100                    LDQ     4,,PR3
         4 002601   000033 772000                    QRL     27
         4 002602   000000 621006                    EAX1    0,QL
         4 002603   000100 305540                    DTB
         4 002604   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         4 002605   202342 000010                    NDSC9   YES_NO_FLG+2,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         4 002606   202343 235100                    LDA     YES_NO_FLG+3,,AUTO
         4 002607   200017 755100                    STA     CNT,,AUTO

     1187    18750    4            IF CNT > 15

  18750  4 002610   000020 115007                    CMPA    16,DL
         4 002611   002617 602000 4                  TNC     s:18773

     1188    18751    5            THEN DO ;

     1189    18752        /*   ERROR:  ASA-E$MAXPRIO_TOO_BIG-C
     1190    18753             MESSAGE: Maxprio too large.
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:208  
     1191    18754             MESSAGE: Maxprio may not exceed 15.
     1192    18755        */
     1193    18756                    %SCREAM( ERR#=E$MAXPRIO_TOO_BIG, LEVEL=ERROR, MID='A' );

  18768  4 002612   000043 630400 5                  EPPR0   35
         4 002613   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002614   000000 701000 xent               TSX1    ASH$ERROR
         4 002615   000000 011000                    NOP     0

     1194    18771    5               GOTO END_OPTION ;

  18771  4 002616   005343 710000 4                  TRA     END_OPTION

     1195    18772    5               END ;               /* Then do                            */
     1196    18773    4            KL$TREC.ISINFO.MXPRI=CNT;

  18773  4 002617   200003 474500                    LDP4    @TREC$,,AUTO
         4 002620   400000 475500                    LDP5    0,,PR4
         4 002621   200017 236100                    LDQ     CNT,,AUTO
         4 002622   500034 552104                    STBQ    28,'04'O,PR5
         4 002623   005343 710000 4                  TRA     END_OPTION

     1197    18774                                                                                    /**/
     1198    18775    4            SELECT ( 39  /* DEVICE WSN   */ );

     1199    18776
     1200    18777    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR;

  18777  4 002624   200050 236100                    LDQ     DEV_USE,,AUTO
         4 002625   000000 116000 2                  CMPQ    DEV_IN_VAL
         4 002626   006137 601000 4                  TNZ     DEV_IN_ERR

     1201    18778    4            IF PTR$ -> P$NODE.CODE = 7   /*  NONE_VAL  */ THEN

  18778  4 002627   202323 470500                    LDP0    PTR$,,AUTO
         4 002630   000000 720100                    LXL0    0,,PR0
         4 002631   000007 100003                    CMPX0   7,DU
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:209  
         4 002632   002642 601000 4                  TNZ     s:18781

     1202    18779    4               KL$TREC.ISINFO.WSN = ' ';

  18779  4 002633   200003 471500                    LDP1    @TREC$,,AUTO
         4 002634   100000 473500                    LDP3    0,,PR1
         4 002635   000035 235000 xsym               LDA     B_VECTNIL+29
         4 002636   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 002637   300065 755100                    STA     53,,PR3
         4 002640   300066 756100                    STQ     54,,PR3
         4 002641   005343 710000 4                  TRA     END_OPTION

     1203    18780    5            ELSE DO;

     1204    18781    5               BLK$ = PTR$->P$NODE.SUBLK$(0) ;

  18781  4 002642   000003 236100                    LDQ     3,,PR0
         4 002643   200015 756100                    STQ     BLK$,,AUTO

     1205    18782    5               IF OUT$SYM.COUNT > 8

  18782  4 002644   200015 471500                    LDP1    BLK$,,AUTO
         4 002645   100004 236100                    LDQ     4,,PR1
         4 002646   777000 376003                    ANQ     -512,DU
         4 002647   011000 116003                    CMPQ    4608,DU
         4 002650   002656 602000 4                  TNC     s:18801

     1206    18783    6               THEN DO;

     1207    18784                       %SCREAM (ERR#=E$WSNNAMETOOBIG, MID='A', LEVEL=ERROR );

  18796  4 002651   000044 630400 5                  EPPR0   36
         4 002652   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002653   000000 701000 xent               TSX1    ASH$ERROR
         4 002654   000000 011000                    NOP     0

     1208    18799    6                  END;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:210  

  18799  4 002655   005343 710000 4                  TRA     END_OPTION

     1209    18800    6               ELSE DO;

     1210    18801    6                  KL$TREC.ISINFO.WSN = OUT$SYM.TEXT;

  18801  4 002656   200003 473500                    LDP3    @TREC$,,AUTO
         4 002657   300000 474500                    LDP4    0,,PR3
         4 002660   100004 236100                    LDQ     4,,PR1
         4 002661   000033 772000                    QRL     27
         4 002662   000000 621006                    EAX1    0,QL
         4 002663   040100 100540                    MLR     fill='040'O
         4 002664   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 002665   400065 000010                    ADSC9   53,,PR4                  cn=0,n=8

     1211    18802    6                  END;

     1212    18803    5               END;   /*  Not none  */

  18803  4 002666   005343 710000 4                  TRA     END_OPTION

     1213    18804
     1214    18805    4            SELECT  ( 40 /* DEVICE MCT  */ ) ;

     1215    18806    4            IF TP_FLAG = AS_FALSE THEN

  18806  4 002667   202333 236100                    LDQ     TP_FLAG,,AUTO
         4 002670   000000 676000 xsym               ERQ     AS_FALSE
         4 002671   400000 376003                    ANQ     -131072,DU
         4 002672   002700 601000 4                  TNZ     s:18828

     1216    18807    5            DO ;

     1217    18808        /*E*  ERROR: ASA-E$MCTILLEGAL-0
     1218    18809              MESSAGE: MCT legal only for USE=TP
     1219    18810        */
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:211  
     1220    18811                    %SCREAM( ERR#=E$MCTILLEGAL, LEVEL=ERROR, MID='A' );

  18823  4 002673   000045 630400 5                  EPPR0   37
         4 002674   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002675   000000 701000 xent               TSX1    ASH$ERROR
         4 002676   000000 011000                    NOP     0

     1221    18826    5               GOTO END_OPTION;

  18826  4 002677   005343 710000 4                  TRA     END_OPTION

     1222    18827    5               END;
     1223    18828    4            CODE2=PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE ;

  18828  4 002700   202323 470500                    LDP0    PTR$,,AUTO
         4 002701   000003 471500                    LDP1    3,,PR0
         4 002702   100000 236100                    LDQ     0,,PR1
         4 002703   777777 376007                    ANQ     -1,DL
         4 002704   200020 756100                    STQ     CODE2,,AUTO

     1224    18829    5            DO SELECT (CODE2) ;

  18829  4 002705   000002 116007                    CMPQ    2,DL
         4 002706   002717 602000 4                  TNC     s:18829+10
         4 002707   002745 600000 4                  TZE     s:18835
         4 002710   000056 116007                    CMPQ    46,DL
         4 002711   002714 602000 4                  TNC     s:18829+7
         4 002712   002770 600000 4                  TZE     s:18839
         4 002713   005343 710000 4                  TRA     END_OPTION
         4 002714   000031 116007                    CMPQ    25,DL
         4 002715   005343 601000 4                  TNZ     END_OPTION
         4 002716   003013 710000 4                  TRA     s:18843
         4 002717   000001 116007                    CMPQ    1,DL
         4 002720   005343 601000 4                  TNZ     END_OPTION
         4 002721   002722 710000 4                  TRA     s:18831

     1225    18830    5               SELECT(1   /*  YES_VAL  */ ) ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:212  

     1226    18831    5               KL$TREC.QQ_LOGON.MCT=AS_TRUE ;

  18831  4 002722   200003 473500                    LDP3    @TREC$,,AUTO
         4 002723   300000 474500                    LDP4    0,,PR3
         4 002724   000000 236000 xsym               LDQ     AS_TRUE
         4 002725   400074 676100                    ERQ     60,,PR4
         4 002726   400000 376003                    ANQ     -131072,DU
         4 002727   400074 656100                    ERSQ    60,,PR4

     1227    18832    5               KL$TREC.QQ_LOGON.MCTCMD = AS_TRUE ;

  18832  4 002730   300000 470500                    LDP0    0,,PR3
         4 002731   000000 236000 xsym               LDQ     AS_TRUE
         4 002732   000001 772000                    QRL     1
         4 002733   000074 676100                    ERQ     60,,PR0
         4 002734   200000 376003                    ANQ     65536,DU
         4 002735   000074 656100                    ERSQ    60,,PR0

     1228    18833    5               KL$TREC.QQ_LOGON.MCTD = AS_FALSE ;

  18833  4 002736   300000 470500                    LDP0    0,,PR3
         4 002737   000000 236000 xsym               LDQ     AS_FALSE
         4 002740   000002 772000                    QRL     2
         4 002741   000074 676100                    ERQ     60,,PR0
         4 002742   100000 376003                    ANQ     32768,DU
         4 002743   000074 656100                    ERSQ    60,,PR0
         4 002744   005343 710000 4                  TRA     END_OPTION

     1229    18834    5               SELECT ( 2   /*  NO_VAL  */) ;

     1230    18835    5               KL$TREC.QQ_LOGON.MCT = AS_FALSE ;

  18835  4 002745   200003 473500                    LDP3    @TREC$,,AUTO
         4 002746   300000 474500                    LDP4    0,,PR3
         4 002747   000000 236000 xsym               LDQ     AS_FALSE
         4 002750   400074 676100                    ERQ     60,,PR4
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:213  
         4 002751   400000 376003                    ANQ     -131072,DU
         4 002752   400074 656100                    ERSQ    60,,PR4

     1231    18836    5               KL$TREC.QQ_LOGON.MCTCMD = AS_FALSE ;

  18836  4 002753   300000 470500                    LDP0    0,,PR3
         4 002754   000000 236000 xsym               LDQ     AS_FALSE
         4 002755   000001 772000                    QRL     1
         4 002756   000074 676100                    ERQ     60,,PR0
         4 002757   200000 376003                    ANQ     65536,DU
         4 002760   000074 656100                    ERSQ    60,,PR0

     1232    18837    5               KL$TREC.QQ_LOGON.MCTD = AS_FALSE ;

  18837  4 002761   300000 470500                    LDP0    0,,PR3
         4 002762   000000 236000 xsym               LDQ     AS_FALSE
         4 002763   000002 772000                    QRL     2
         4 002764   000074 676100                    ERQ     60,,PR0
         4 002765   100000 376003                    ANQ     32768,DU
         4 002766   000074 656100                    ERSQ    60,,PR0
         4 002767   005343 710000 4                  TRA     END_OPTION

     1233    18838    5               SELECT ( 46 /* COMMAND */ ) ;

     1234    18839    5               KL$TREC.QQ_LOGON.MCT = AS_FALSE ;

  18839  4 002770   200003 473500                    LDP3    @TREC$,,AUTO
         4 002771   300000 474500                    LDP4    0,,PR3
         4 002772   000000 236000 xsym               LDQ     AS_FALSE
         4 002773   400074 676100                    ERQ     60,,PR4
         4 002774   400000 376003                    ANQ     -131072,DU
         4 002775   400074 656100                    ERSQ    60,,PR4

     1235    18840    5               KL$TREC.QQ_LOGON.MCTCMD = AS_TRUE ;

  18840  4 002776   300000 470500                    LDP0    0,,PR3
         4 002777   000000 236000 xsym               LDQ     AS_TRUE
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:214  
         4 003000   000001 772000                    QRL     1
         4 003001   000074 676100                    ERQ     60,,PR0
         4 003002   200000 376003                    ANQ     65536,DU
         4 003003   000074 656100                    ERSQ    60,,PR0

     1236    18841    5               KL$TREC.QQ_LOGON.MCTD = AS_FALSE ;

  18841  4 003004   300000 470500                    LDP0    0,,PR3
         4 003005   000000 236000 xsym               LDQ     AS_FALSE
         4 003006   000002 772000                    QRL     2
         4 003007   000074 676100                    ERQ     60,,PR0
         4 003010   100000 376003                    ANQ     32768,DU
         4 003011   000074 656100                    ERSQ    60,,PR0
         4 003012   005343 710000 4                  TRA     END_OPTION

     1237    18842    5               SELECT ( 25 /* DISPLAY */ ) ;

     1238    18843    5               KL$TREC.QQ_LOGON.MCT = AS_FALSE ;

  18843  4 003013   200003 473500                    LDP3    @TREC$,,AUTO
         4 003014   300000 474500                    LDP4    0,,PR3
         4 003015   000000 236000 xsym               LDQ     AS_FALSE
         4 003016   400074 676100                    ERQ     60,,PR4
         4 003017   400000 376003                    ANQ     -131072,DU
         4 003020   400074 656100                    ERSQ    60,,PR4

     1239    18844    5               KL$TREC.QQ_LOGON.MCTCMD = AS_FALSE ;

  18844  4 003021   300000 470500                    LDP0    0,,PR3
         4 003022   000000 236000 xsym               LDQ     AS_FALSE
         4 003023   000001 772000                    QRL     1
         4 003024   000074 676100                    ERQ     60,,PR0
         4 003025   200000 376003                    ANQ     65536,DU
         4 003026   000074 656100                    ERSQ    60,,PR0

     1240    18845    5               KL$TREC.QQ_LOGON.MCTD = AS_TRUE ;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:215  
  18845  4 003027   300000 470500                    LDP0    0,,PR3
         4 003030   000000 236000 xsym               LDQ     AS_TRUE
         4 003031   000002 772000                    QRL     2
         4 003032   000074 676100                    ERQ     60,,PR0
         4 003033   100000 376003                    ANQ     32768,DU
         4 003034   000074 656100                    ERSQ    60,,PR0

     1241    18846    5               END;   /* Do CODE2 */

  18846  4 003035   005343 710000 4                  TRA     END_OPTION

     1242    18847
     1243    18848    4            SELECT  ( 41  /* DEVICE SNAME  */ ) ;

     1244    18849    4            IF TYPE ~= 'CG' THEN

  18849  4 003036   000000 221000 3                  LDX1    TYPE
         4 003037   000175 101000 2                  CMPX1   Z_ACCT+2
         4 003040   003046 600000 4                  TZE     s:18871

     1245    18850    5            DO;

     1246    18851        /*E*  ERROR:  ASA-E$SNAMEILLEGAL-0
     1247    18852              MESSAGE:  SNAME legal only for USE=CG or USE=TP
     1248    18853        */
     1249    18854                    %SCREAM( ERR#=E$SNAMEILLEGAL, LEVEL=ERROR, MID='A' );

  18866  4 003041   000046 630400 5                  EPPR0   38
         4 003042   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003043   000000 701000 xent               TSX1    ASH$ERROR
         4 003044   000000 011000                    NOP     0

     1250    18869    5               GOTO END_OPTION;

  18869  4 003045   005343 710000 4                  TRA     END_OPTION

     1251    18870    5               END;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:216  
     1252    18871    5            IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE = 7   /*  NONE_VAL  */ THEN DO;

  18871  4 003046   100003 473500                    LDP3    3,,PR1
         4 003047   300000 722100                    LXL2    0,,PR3
         4 003050   000007 102003                    CMPX2   7,DU
         4 003051   003067 601000 4                  TNZ     s:18876

     1253    18872    5               KL$TREC.RENAME = ' '; /* clear out rename buffer */

  18872  4 003052   200003 474500                    LDP4    @TREC$,,AUTO
         4 003053   400000 475500                    LDP5    0,,PR4
         4 003054   000035 235000 xsym               LDA     B_VECTNIL+29
         4 003055   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 003056   500011 755100                    STA     9,,PR5
         4 003057   500012 756100                    STQ     10,,PR5

     1254    18873    5               KL$TREC.FLAGS.RNME = AS_FALSE; /* re-init the rename flg */

  18873  4 003060   400000 471500                    LDP1    0,,PR4
         4 003061   000000 236000 xsym               LDQ     AS_FALSE
         4 003062   000011 772000                    QRL     9
         4 003063   100000 676100                    ERQ     0,,PR1
         4 003064   000400 376003                    ANQ     256,DU
         4 003065   100000 656100                    ERSQ    0,,PR1

     1255    18874    5               GOTO END_OPTION;

  18874  4 003066   005343 710000 4                  TRA     END_OPTION

     1256    18875    5               END;  /*  None  */
     1257    18876    4            KL$TREC.FLAGS.RNME = AS_TRUE ;

  18876  4 003067   200003 474500                    LDP4    @TREC$,,AUTO
         4 003070   400000 475500                    LDP5    0,,PR4
         4 003071   000000 236000 xsym               LDQ     AS_TRUE
         4 003072   000011 772000                    QRL     9
         4 003073   500000 676100                    ERQ     0,,PR5
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:217  
         4 003074   000400 376003                    ANQ     256,DU
         4 003075   500000 656100                    ERSQ    0,,PR5

     1258    18877    4            BLK$ = PTR$ ->P$NODE.SUBLK$(0);

  18877  4 003076   202323 470500                    LDP0    PTR$,,AUTO
         4 003077   000003 236100                    LDQ     3,,PR0
         4 003100   200015 756100                    STQ     BLK$,,AUTO

     1259    18878    4            IF (SUBSTR(OUT$SYM.TEXT,0,2) = '$$')

  18878  4 003101   200015 471500                    LDP1    BLK$,,AUTO
         4 003102   100004 236100                    LDQ     4,,PR1
         4 003103   000033 772000                    QRL     27
         4 003104   040000 106500                    CMPC    fill='040'O
         4 003105   100004 200002                    ADSC9   4,,PR1                   cn=1,n=2
         4 003106   000244 000002 2                  ADSC9   Z_ACCT+41                cn=0,n=2
         4 003107   003115 601000 4                  TNZ     s:18904

     1260    18879    5            THEN DO;

     1261    18880        /*E*  ERROR: ASA-E$NO$$ONSNAME-0
     1262    18881              MESSAGE1: The SNAME of a CG type device cannot start with '$$'.
     1263    18882              MESSAGE2: Comgroups do not allow '$$' as the first 2 characters
     1264    18883                        of a name.
     1265    18884              MESSAGE: You tried to specify an SNAME with '$$' as the
     1266    18885                       first two characters, this is a no-no!
     1267    18886        */
     1268    18887                    %SCREAM (ERR#=E$NO$$ONSNAME, LEVEL=ERROR, MID='A');

  18899  4 003110   000047 630400 5                  EPPR0   39
         4 003111   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003112   000000 701000 xent               TSX1    ASH$ERROR
         4 003113   000000 011000                    NOP     0

     1269    18902    5               GOTO END_OPTION;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:218  
  18902  4 003114   005343 710000 4                  TRA     END_OPTION

     1270    18903    5               END;
     1271    18904    4            KL$TREC.RENAME = OUT$SYM.TEXT ;

  18904  4 003115   400000 473500                    LDP3    0,,PR4
         4 003116   000000 621006                    EAX1    0,QL
         4 003117   040100 100540                    MLR     fill='040'O
         4 003120   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 003121   300011 000010                    ADSC9   9,,PR3                   cn=0,n=8

     1272    18905    4            SNAME_FLG = AS_TRUE ;

  18905  4 003122   000000 236000 xsym               LDQ     AS_TRUE
         4 003123   400000 376003                    ANQ     -131072,DU
         4 003124   202326 756100                    STQ     SNAME_FLG,,AUTO
         4 003125   005343 710000 4                  TRA     END_OPTION

     1273    18906
     1274    18907    4            SELECT  ( 42  /* DEVICE PRIORITY  */ ) ;

     1275    18908    4            IF DEV_USE ~= 48 /* TP */ THEN

  18908  4 003126   200050 235100                    LDA     DEV_USE,,AUTO
         4 003127   000060 115007                    CMPA    48,DL
         4 003130   003136 600000 4                  TZE     s:18930

     1276    18909    5            DO ;

     1277    18910        /*E*  ERROR:  ASA-E$ILLEGALPRIO-0
     1278    18911              MESSAGE: PRIORITY legal only if USE=TP
     1279    18912        */
     1280    18913                    %SCREAM( ERR#=E$ILLEGALPRIO, LEVEL=ERROR, MID='A' );

  18925  4 003131   000050 630400 5                  EPPR0   40
         4 003132   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003133   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:219  
         4 003134   000000 011000                    NOP     0

     1281    18928    5               GOTO END_OPTION;

  18928  4 003135   005343 710000 4                  TRA     END_OPTION

     1282    18929    5               END;
     1283    18930    4            BLK$=PTR$->P$NODE.SUBLK$(0) ;

  18930  4 003136   100003 236100                    LDQ     3,,PR1
         4 003137   200015 756100                    STQ     BLK$,,AUTO

     1284    18931    4            CALL CHARBIN (CNT,OUT$SYM.TEXT) ;

  18931  4 003140   200015 473500                    LDP3    BLK$,,AUTO
         4 003141   300004 236100                    LDQ     4,,PR3
         4 003142   000033 772000                    QRL     27
         4 003143   000000 621006                    EAX1    0,QL
         4 003144   000100 305540                    DTB
         4 003145   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         4 003146   202342 000010                    NDSC9   YES_NO_FLG+2,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         4 003147   202343 236100                    LDQ     YES_NO_FLG+3,,AUTO
         4 003150   200017 756100                    STQ     CNT,,AUTO

     1285    18932    5            IF CNT > 500 THEN DO;

  18932  4 003151   000765 116007                    CMPQ    501,DL
         4 003152   003160 602000 4                  TNC     s:18953

     1286    18933        /*E*  ERROR:  ASA-E$PRIOTOOLARGE-0
     1287    18934              MESSAGE: PRIORITY too large
     1288    18935              MESSAGE1: Maximum PRIORITY is 500
     1289    18936        */
     1290    18937                    %SCREAM( ERR#=E$PRIOTOOLARGE, LEVEL=ERROR, MID='A' );

  18949  4 003153   000051 630400 5                  EPPR0   41
         4 003154   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:220  
         4 003155   000000 701000 xent               TSX1    ASH$ERROR
         4 003156   000000 011000                    NOP     0

     1291    18952    5               END;

  18952  4 003157   005343 710000 4                  TRA     END_OPTION

     1292    18953    4            ELSE KL$TREC.QQ_LOGON.PRIO = CNT ;

  18953  4 003160   200003 474500                    LDP4    @TREC$,,AUTO
         4 003161   400000 475500                    LDP5    0,,PR4
         4 003162   000011 736000                    QLS     9
         4 003163   500074 552110                    STBQ    60,'10'O,PR5
         4 003164   005343 710000 4                  TRA     END_OPTION

     1293    18954
     1294    18955    4            SELECT  ( 38  /* DEVICE INSTANCE  */ ) ;

     1295    18956    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  18956  4 003165   202323 470500                    LDP0    PTR$,,AUTO
         4 003166   000003 236100                    LDQ     3,,PR0
         4 003167   200015 756100                    STQ     BLK$,,AUTO

     1296    18957    4            IF TP_FLAG = AS_FALSE THEN

  18957  4 003170   202333 236100                    LDQ     TP_FLAG,,AUTO
         4 003171   000000 676000 xsym               ERQ     AS_FALSE
         4 003172   400000 376003                    ANQ     -131072,DU
         4 003173   003201 601000 4                  TNZ     s:18979

     1297    18958    5            DO;

     1298    18959        /*E*  ERROR:  ASA-E$ILLEGALINSTANCE-0
     1299    18960              MESSAGE:  INSTANCE legal only if USE=TP
     1300    18961        */
     1301    18962                    %SCREAM( ERR#=E$ILLEGALINSTANCE, LEVEL=ERROR, MID='A' );
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:221  

  18974  4 003174   000052 630400 5                  EPPR0   42
         4 003175   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003176   000000 701000 xent               TSX1    ASH$ERROR
         4 003177   000000 011000                    NOP     0

     1302    18977    5               GOTO END_OPTION;

  18977  4 003200   005343 710000 4                  TRA     END_OPTION

     1303    18978    5               END;
     1304    18979    5            IF OUT$SYM.CODE = 1 /* PACKSET_VAL */ THEN DO;

  18979  4 003201   200015 471500                    LDP1    BLK$,,AUTO
         4 003202   100000 720100                    LXL0    0,,PR1
         4 003203   000001 100003                    CMPX0   1,DU
         4 003204   003216 601000 4                  TNZ     s:18983

     1305    18980    5               PACKSET_NAME = OUT$SYM.TEXT;

  18980  4 003205   100004 236100                    LDQ     4,,PR1
         4 003206   000033 772000                    QRL     27
         4 003207   000000 621006                    EAX1    0,QL
         4 003210   040100 100540                    MLR     fill='040'O
         4 003211   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 003212   201716 000006                    ADSC9   PACKSET_NAME,,AUTO       cn=0,n=6

     1306    18981    5               BLK$ = PTR$ -> P$NODE.SUBLK$(1);

  18981  4 003213   000004 236100                    LDQ     4,,PR0
         4 003214   200015 756100                    STQ     BLK$,,AUTO

     1307    18982    5               END;

  18982  4 003215   003221 710000 4                  TRA     s:18984

     1308    18983    4            ELSE PACKSET_NAME = AS_BLANK ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:222  

  18983  4 003216   040100 100400                    MLR     fill='040'O
         4 003217   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 003220   201716 000006                    ADSC9   PACKSET_NAME,,AUTO       cn=0,n=6

     1309    18984    5            IF OUT$SYM.COUNT > 8 THEN DO;

  18984  4 003221   200015 471500                    LDP1    BLK$,,AUTO
         4 003222   100004 236100                    LDQ     4,,PR1
         4 003223   777000 376003                    ANQ     -512,DU
         4 003224   011000 116003                    CMPQ    4608,DU
         4 003225   003233 602000 4                  TNC     s:19006

     1310    18985        /*E*  ERROR: ASA-E$INSTANCE_TOO_LONG-C
     1311    18986              MESSAGE: INSTANCE too long.
     1312    18987              MESSAGE1: INSTANCE can be at most 8 characters long.
     1313    18988        */
     1314    18989                    %SCREAM( ERR#=E$INSTANCE_TOO_LONG, MID='A', LEVEL=ERROR );

  19001  4 003226   000053 630400 5                  EPPR0   43
         4 003227   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003230   000000 701000 xent               TSX1    ASH$ERROR
         4 003231   000000 011000                    NOP     0

     1315    19004    5               GOTO END_OPTION;

  19004  4 003232   005343 710000 4                  TRA     END_OPTION

     1316    19005    5               END;
     1317    19006    4            KL$TREC.KC$CGID.ACCT# = OUT$SYM.TEXT ;

  19006  4 003233   200003 473500                    LDP3    @TREC$,,AUTO
         4 003234   300000 474500                    LDP4    0,,PR3
         4 003235   100004 236100                    LDQ     4,,PR1
         4 003236   000033 772000                    QRL     27
         4 003237   000000 620006                    EAX0    0,QL
         4 003240   040100 100540                    MLR     fill='040'O
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:223  
         4 003241   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 003242   400020 000010                    ADSC9   16,,PR4                  cn=0,n=8

     1318    19007    4            KL$TREC.KC$CGID.NAME#.TXT = OUT$SYM.TEXT ;

  19007  4 003243   300000 470500                    LDP0    0,,PR3
         4 003244   100004 236100                    LDQ     4,,PR1
         4 003245   000033 772000                    QRL     27
         4 003246   000000 620006                    EAX0    0,QL
         4 003247   040100 100540                    MLR     fill='040'O
         4 003250   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 003251   000024 200037                    ADSC9   20,,PR0                  cn=1,n=31

     1319    19008    4            KL$TREC.KC$CGID.NAME#.CNT = OUT$SYM.COUNT ;

  19008  4 003252   300000 470500                    LDP0    0,,PR3
         4 003253   100004 236100                    LDQ     4,,PR1
         4 003254   000024 552140                    STBQ    20,'40'O,PR0

     1320    19009    4            INSTANCE_FLAG = AS_TRUE ;

  19009  4 003255   000000 236000 xsym               LDQ     AS_TRUE
         4 003256   400000 376003                    ANQ     -131072,DU
         4 003257   201677 756100                    STQ     INSTANCE_FLAG,,AUTO

     1321    19010    4            KL$TREC.KC$CGID.PSN# = PACKSET_NAME;

  19010  4 003260   300000 470500                    LDP0    0,,PR3
         4 003261   040100 100500                    MLR     fill='040'O
         4 003262   201716 000006                    ADSC9   PACKSET_NAME,,AUTO       cn=0,n=6
         4 003263   000022 000006                    ADSC9   18,,PR0                  cn=0,n=6
         4 003264   005343 710000 4                  TRA     END_OPTION

     1322    19011
     1323    19012    4            SELECT  ( 37  /* DEVICE COMMAND */ ) ;

     1324    19013    4            IF TYPE ~='CG'
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:224  

  19013  4 003265   000000 220000 3                  LDX0    TYPE
         4 003266   000175 100000 2                  CMPX0   Z_ACCT+2
         4 003267   003275 600000 4                  TZE     s:19036

     1325    19014    4            THEN
     1326    19015    5            DO ;

     1327    19016        /*E*  ERROR:  ASA-E$CMDILLEGAL-C
     1328    19017              MESSAGE: CMD legal only if USE=TP OR USE=CG
     1329    19018        */
     1330    19019                    %SCREAM( ERR#=E$CMDILLEGAL, LEVEL=ERROR, MID='A' );

  19031  4 003270   000054 630400 5                  EPPR0   44
         4 003271   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003272   000000 701000 xent               TSX1    ASH$ERROR
         4 003273   000000 011000                    NOP     0

     1331    19034    5               GOTO END_OPTION;

  19034  4 003274   005343 710000 4                  TRA     END_OPTION

     1332    19035    5               END;
     1333    19036    4            BLK$ = PTR$->P$NODE.SUBLK$(0) ;

  19036  4 003275   202323 470500                    LDP0    PTR$,,AUTO
         4 003276   000003 236100                    LDQ     3,,PR0
         4 003277   200015 756100                    STQ     BLK$,,AUTO

     1334    19037    4            IF BLK$ -> OUT$SYM.CODE = 7   /*  NONE_VAL  */

  19037  4 003300   200015 471500                    LDP1    BLK$,,AUTO
         4 003301   100000 721100                    LXL1    0,,PR1
         4 003302   000007 101003                    CMPX1   7,DU
         4 003303   003311 601000 4                  TNZ     s:19043

     1335    19038    5            THEN DO;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:225  

     1336    19039    5               CNT = 0;

  19039  4 003304   200017 450100                    STZ     CNT,,AUTO

     1337    19040    5               COMMAND = ' ';

  19040  4 003305   040100 100400                    MLR     fill='040'O
         4 003306   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 003307   200021 000120                    ADSC9   COMMAND,,AUTO            cn=0,n=80

     1338    19041    5               END;

  19041  4 003310   003320 710000 4                  TRA     s:19046

     1339    19042    5            ELSE DO;

     1340    19043    5               CNT =OUT$SYM.COUNT ;

  19043  4 003311   100004 236100                    LDQ     4,,PR1
         4 003312   000033 772000                    QRL     27
         4 003313   200017 756100                    STQ     CNT,,AUTO

     1341    19044    5               COMMAND = OUT$SYM.TEXT;

  19044  4 003314   000000 622006                    EAX2    0,QL
         4 003315   040100 100540                    MLR     fill='040'O
         4 003316   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         4 003317   200021 000120                    ADSC9   COMMAND,,AUTO            cn=0,n=80

     1342    19045    5               END;

     1343    19046    4            IF CNT>80 THEN

  19046  4 003320   200017 235100                    LDA     CNT,,AUTO
         4 003321   000121 115007                    CMPA    81,DL
         4 003322   003330 602000 4                  TNC     s:19069
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:226  

     1344    19047    5            DO ;

     1345    19048        /*E*  ERROR: ASA-E$CMDTOOBIG-C
     1346    19049              MESSAGE: Command is too long.
     1347    19050              MESSAGE1: Command is limited to 80 characters
     1348    19051        */
     1349    19052                    %SCREAM( ERR#=E$CMDTOOBIG , LEVEL=ERROR, MID='A' );

  19064  4 003323   000055 630400 5                  EPPR0   45
         4 003324   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003325   000000 701000 xent               TSX1    ASH$ERROR
         4 003326   000000 011000                    NOP     0

     1350    19067    5               GOTO END_OPTION ;

  19067  4 003327   005343 710000 4                  TRA     END_OPTION

     1351    19068    5               END ;            /* Then do                            */
     1352    19069    4            IF DEV_USE = 48 /* TP */ THEN

  19069  4 003330   200050 236100                    LDQ     DEV_USE,,AUTO
         4 003331   000060 116007                    CMPQ    48,DL
         4 003332   003343 601000 4                  TNZ     s:19075

     1353    19070    5            DO ;

     1354    19071    5               KL$TREC.QQ_LOGON.CMD = COMMAND;

  19071  4 003333   200003 473500                    LDP3    @TREC$,,AUTO
         4 003334   300000 474500                    LDP4    0,,PR3
         4 003335   040100 100500                    MLR     fill='040'O
         4 003336   200021 000120                    ADSC9   COMMAND,,AUTO            cn=0,n=80
         4 003337   400106 000120                    ADSC9   70,,PR4                  cn=0,n=80

     1355    19072    5               KL$TREC.QQ_LOGON.CMDCNT = CNT;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:227  
  19072  4 003340   300000 470500                    LDP0    0,,PR3
         4 003341   000105 755100                    STA     69,,PR0

     1356    19073    5               END; /*  Do  */

  19073  4 003342   005343 710000 4                  TRA     END_OPTION

     1357    19074    4            ELSE
     1358    19075    4               IF DEV_USE = 49 /* COM GROUP  */ THEN

  19075  4 003343   000061 116007                    CMPQ    49,DL
         4 003344   005343 601000 4                  TNZ     END_OPTION

     1359    19076    5               DO ;

     1360    19077    5                  KL$TREC.B_CGAUINFO.UCMD = COMMAND;

  19077  4 003345   200003 473500                    LDP3    @TREC$,,AUTO
         4 003346   300000 474500                    LDP4    0,,PR3
         4 003347   040100 100500                    MLR     fill='040'O
         4 003350   200021 000120                    ADSC9   COMMAND,,AUTO            cn=0,n=80
         4 003351   400144 000120                    ADSC9   100,,PR4                 cn=0,n=80

     1361    19078    5                  KL$TREC.B_CGAUINFO.UCMDCNT = CNT;

  19078  4 003352   300000 470500                    LDP0    0,,PR3
         4 003353   000143 755100                    STA     99,,PR0

     1362    19079    5                  END ; /*  Do  */

  19079  4 003354   005343 710000 4                  TRA     END_OPTION

     1363    19080
     1364    19081
     1365    19082    4            SELECT  (44  /* DEVICE COMGROUP  */ ) ;

     1366    19083    4            BLK$ = PTR$->P$NODE.SUBLK$(0) ;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:228  

  19083  4 003355   100003 236100                    LDQ     3,,PR1
         4 003356   200015 756100                    STQ     BLK$,,AUTO

     1367    19084    4            FIDFPT.TEXTFID_ = VECTOR(OUT$SYM.TEXT) ;

  19084  4 003357   200015 473500                    LDP3    BLK$,,AUTO
         4 003360   300004 236100                    LDQ     4,,PR3
         4 003361   000033 772000                    QRL     27
         4 003362   000064 737000                    LLS     52
         4 003363   000140 135007                    SBLA    96,DL
         4 003364   200015 236100                    LDQ     BLK$,,AUTO
         4 003365   000016 036000 5                  ADLQ    14
         4 003366   000034 757000 3                  STAQ    FIDFPT+2

     1368    19085    4            CALL M$FID(FIDFPT) ALTRET(BAD_FID) ;

  19085  4 003367   000032 630400 3                  EPPR0   FIDFPT
         4 003370   420001 713400                    CLIMB   alt,+8193
         4 003371   404400 401760                    pmme    nvectors=10
         4 003372   003447 702000 4                  TSX2    BAD_FID

     1369    19086    4            IF ASN_VAL ~= %COMGROUP# THEN GOTO BAD_FID ;

  19086  4 003373   000063 236000 3                  LDQ     ASN_VAL
         4 003374   777000 376003                    ANQ     -512,DU
         4 003375   004000 116003                    CMPQ    2048,DU
         4 003376   003447 601000 4                  TNZ     BAD_FID

     1370    19087    4            GROUP_FLAG = AS_TRUE ;

  19087  4 003377   000000 236000 xsym               LDQ     AS_TRUE
         4 003400   400000 376003                    ANQ     -131072,DU
         4 003401   201575 756100                    STQ     GROUP_FLAG,,AUTO

     1371    19088    4            KL$TREC.KC$CGID.NAME#.CNT = NAMEVLP.L# ;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:229  
  19088  4 003402   200003 470500                    LDP0    @TREC$,,AUTO
         4 003403   000000 471500                    LDP1    0,,PR0
         4 003404   000014 236000 3                  LDQ     NAMEVLP
         4 003405   100024 552140                    STBQ    20,'40'O,PR1

     1372    19089    4            KL$TREC.KC$CGID.NAME#.TXT = NAMEVLP.NAME# ;

  19089  4 003406   000000 471500                    LDP1    0,,PR0
         4 003407   040100 100400                    MLR     fill='040'O
         4 003410   000014 200037 3                  ADSC9   NAMEVLP                  cn=1,n=31
         4 003411   100024 200037                    ADSC9   20,,PR1                  cn=1,n=31

     1373    19090    4            IF (FID_VLR.ACCT=AS_FALSE) OR (ACCTVLP.ACCT#=' ') THEN

  19090  4 003412   000000 066400                    CMPB    filb='0'B
         4 003413   000002 010001 3                  BDSC    FID_VLR                  by=0,bit=1,n=1
         4 003414   000000 000001 xsym               BDSC    AS_FALSE                 by=0,bit=0,n=1
         4 003415   003421 600000 4                  TZE     s:19091
         4 003416   000024 237000 3                  LDAQ    ACCTVLP
         4 003417   000056 117000 5                  CMPAQ   46
         4 003420   003426 601000 4                  TNZ     s:19093

     1374    19091    4               KL$TREC.KC$CGID.ACCT# = ':SYS' ;

  19091  4 003421   000000 471500                    LDP1    0,,PR0
         4 003422   040100 100400                    MLR     fill='040'O
         4 003423   000207 000004 2                  ADSC9   Z_ACCT+12                cn=0,n=4
         4 003424   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8
         4 003425   003432 710000 4                  TRA     s:19094

     1375    19092    4            ELSE
     1376    19093    4               KL$TREC.KC$CGID.ACCT# = ACCTVLP.ACCT# ;

  19093  4 003426   000000 471500                    LDP1    0,,PR0
         4 003427   000024 237000 3                  LDAQ    ACCTVLP
         4 003430   100020 755100                    STA     16,,PR1
         4 003431   100021 756100                    STQ     17,,PR1
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:230  

     1377    19094    4            IF NOT FID_VLR.SN THEN

  19094  4 003432   000002 236000 3                  LDQ     FID_VLR
         4 003433   040000 316003                    CANQ    16384,DU
         4 003434   003442 601000 4                  TNZ     s:19096

     1378    19095    4               KL$TREC.KC$CGID.PSN# = AS_BLANK ;

  19095  4 003435   000000 471500                    LDP1    0,,PR0
         4 003436   040100 100400                    MLR     fill='040'O
         4 003437   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 003440   100022 000006                    ADSC9   18,,PR1                  cn=0,n=6
         4 003441   003446 710000 4                  TRA     s:19097

     1379    19096    4            ELSE KL$TREC.KC$CGID.PSN# = SNVLP.SN#(0) ;

  19096  4 003442   000000 471500                    LDP1    0,,PR0
         4 003443   040100 100400                    MLR     fill='040'O
         4 003444   000027 000006 3                  ADSC9   SNVLP+1                  cn=0,n=6
         4 003445   100022 000006                    ADSC9   18,,PR1                  cn=0,n=6

     1380    19097    4            GOTO END_OPTION ;

  19097  4 003446   005343 710000 4                  TRA     END_OPTION

  19094  4 003447                       BAD_FID      null
     1381    19098    4   BAD_FID : ;
     1382    19099        /*E*  ERROR:  ASA-E$BADCGFID-0
     1383    19100              MESSAGE:  Bad or illegal fid.
     1384    19101              MESSAGE1: Syntax: CG [#psn] [/ [name] [. [account] [. [password]]]]
     1385    19102        */
     1386    19103                 %SCREAM( ERR#=E$BADCGFID, LEVEL=ERROR, MID='A' );

  19115  4 003447   000060 630400 5                  EPPR0   48
         4 003450   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003451   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:231  
         4 003452   000000 011000                    NOP     0

     1387    19118    4            GOTO END_OPTION;

  19118  4 003453   005343 710000 4                  TRA     END_OPTION

     1388    19119
     1389    19120    4            SELECT (50  /* DEVICE USER1  */,

     1390    19121    4                 51  /* DEVICE USER2  */,
     1391    19122    4                 52  /* DEVICE USER3  */,
     1392    19123    4                 53  /* DEVICE USER4  */ ) ;
     1393    19124                                                   /**/
     1394    19125    4            BLK$ = PTR$->P$NODE.SUBLK$(0) ;

  19125  4 003454   100003 236100                    LDQ     3,,PR1
         4 003455   200015 756100                    STQ     BLK$,,AUTO

     1395    19126    4            CALL CHARBIN(CNT,OUT$SYM.TEXT) ;

  19126  4 003456   200015 473500                    LDP3    BLK$,,AUTO
         4 003457   300004 236100                    LDQ     4,,PR3
         4 003460   000033 772000                    QRL     27
         4 003461   000000 621006                    EAX1    0,QL
         4 003462   000100 305540                    DTB
         4 003463   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         4 003464   202342 000010                    NDSC9   YES_NO_FLG+2,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         4 003465   202343 235100                    LDA     YES_NO_FLG+3,,AUTO
         4 003466   200017 755100                    STA     CNT,,AUTO

     1396    19127    4            CODE2 = CODE ;

  19127  4 003467   000000 236000 xsym               LDQ     CODE
         4 003470   200020 756100                    STQ     CODE2,,AUTO

     1397    19128    5            DO SELECT (CODE2);

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:232  
  19128  4 003471   000063 116007                    CMPQ    51,DL
         4 003472   003502 602000 4                  TNC     s:19128+9
         4 003473   003511 600000 4                  TZE     s:19132
         4 003474   000064 116007                    CMPQ    52,DL
         4 003475   005343 602000 4                  TNC     END_OPTION
         4 003476   003515 600000 4                  TZE     s:19134
         4 003477   000065 116007                    CMPQ    53,DL
         4 003500   005343 601000 4                  TNZ     END_OPTION
         4 003501   003521 710000 4                  TRA     s:19136
         4 003502   000062 116007                    CMPQ    50,DL
         4 003503   005343 601000 4                  TNZ     END_OPTION
         4 003504   003505 710000 4                  TRA     s:19130

     1398    19129    5               SELECT(50  /* DEVICE USER1  */) ;

     1399    19130    5               KL$TREC.B_CGAUINFO.USER1 = CNT ;

  19130  4 003505   200003 474500                    LDP4    @TREC$,,AUTO
         4 003506   400000 475500                    LDP5    0,,PR4
         4 003507   500137 755100                    STA     95,,PR5
         4 003510   005343 710000 4                  TRA     END_OPTION

     1400    19131    5               SELECT(51  /* DEVICE USER2  */) ;

     1401    19132    5               KL$TREC.B_CGAUINFO.USER2 = CNT ;

  19132  4 003511   200003 474500                    LDP4    @TREC$,,AUTO
         4 003512   400000 475500                    LDP5    0,,PR4
         4 003513   500140 755100                    STA     96,,PR5
         4 003514   005343 710000 4                  TRA     END_OPTION

     1402    19133    5               SELECT(52  /* DEVICE USER3  */) ;

     1403    19134    5               KL$TREC.B_CGAUINFO.USER3 = CNT ;

  19134  4 003515   200003 474500                    LDP4    @TREC$,,AUTO
         4 003516   400000 475500                    LDP5    0,,PR4
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:233  
         4 003517   500141 755100                    STA     97,,PR5
         4 003520   005343 710000 4                  TRA     END_OPTION

     1404    19135    5               SELECT(53  /* DEVICE USER4  */) ;

     1405    19136    5               KL$TREC.B_CGAUINFO.USER4 = CNT ;

  19136  4 003521   200003 474500                    LDP4    @TREC$,,AUTO
         4 003522   400000 475500                    LDP5    0,,PR4
         4 003523   500142 755100                    STA     98,,PR5

     1406    19137    5               END; /*  Do CODE2  */

  19137  4 003524   005343 710000 4                  TRA     END_OPTION

     1407    19138
     1408    19139    4            SELECT ( 29 /*DEV_DFPRIO*/ );

     1409    19140    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR ;

  19140  4 003525   200050 236100                    LDQ     DEV_USE,,AUTO
         4 003526   000000 116000 2                  CMPQ    DEV_IN_VAL
         4 003527   006137 601000 4                  TNZ     DEV_IN_ERR

     1410    19141    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  19141  4 003530   202323 470500                    LDP0    PTR$,,AUTO
         4 003531   000003 236100                    LDQ     3,,PR0
         4 003532   200015 756100                    STQ     BLK$,,AUTO

     1411    19142    4            CALL CHARBIN( CNT, OUT$SYM.TEXT ) ;

  19142  4 003533   200015 471500                    LDP1    BLK$,,AUTO
         4 003534   100004 236100                    LDQ     4,,PR1
         4 003535   000033 772000                    QRL     27
         4 003536   000000 620006                    EAX0    0,QL
         4 003537   000100 305540                    DTB
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:234  
         4 003540   100004 230010                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X0
         4 003541   202342 000010                    NDSC9   YES_NO_FLG+2,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         4 003542   202343 235100                    LDA     YES_NO_FLG+3,,AUTO
         4 003543   200017 755100                    STA     CNT,,AUTO

     1412    19143    4            IF CNT > 15

  19143  4 003544   000020 115007                    CMPA    16,DL
         4 003545   003553 602000 4                  TNC     s:19167

     1413    19144    4            THEN
     1414    19145    5            DO ;

     1415    19146        /*E*  ERROR:    ASA-E$DEVDPRIO-C
     1416    19147              MESSAGE:  DEFPRIO too big.
     1417    19148              MESSAGE1: DEFPRIO cannot exceed 15.
     1418    19149        */
     1419    19150                    %SCREAM( ERR#=E$DEVDPRIO , LEVEL=ERROR, MID='A' );

  19162  4 003546   000061 630400 5                  EPPR0   49
         4 003547   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003550   000000 701000 xent               TSX1    ASH$ERROR
         4 003551   000000 011000                    NOP     0

     1420    19165    5               GOTO END_OPTION ;

  19165  4 003552   005343 710000 4                  TRA     END_OPTION

     1421    19166    5               END ;               /* Then do                            */
     1422    19167    4            KL$TREC.ISINFO.DFLTPRI=CNT;

  19167  4 003553   200003 473500                    LDP3    @TREC$,,AUTO
         4 003554   300000 474500                    LDP4    0,,PR3
         4 003555   200017 236100                    LDQ     CNT,,AUTO
         4 003556   000011 736000                    QLS     9
         4 003557   400034 552110                    STBQ    28,'10'O,PR4
         4 003560   005343 710000 4                  TRA     END_OPTION
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:235  

     1423    19168
     1424    19169    4            SELECT ( 54 /* DEVICE NO CG */ ) ;

     1425    19170    4            IF TYPE ~='CG'

  19170  4 003561   000000 221000 3                  LDX1    TYPE
         4 003562   000175 101000 2                  CMPX1   Z_ACCT+2
         4 003563   003571 600000 4                  TZE     s:19193

     1426    19171    4            THEN
     1427    19172    5            DO ;

     1428    19173        /*E*  ERROR:   ASA-E$NOCGILLEGAL-C
     1429    19174              MESSAGE: NOCG legal only if USE=TP or USE=CG
     1430    19175        */
     1431    19176                    %SCREAM( ERR#=E$NOCGILLEGAL, LEVEL=ERROR, MID='A' );

  19188  4 003564   000062 630400 5                  EPPR0   50
         4 003565   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003566   000000 701000 xent               TSX1    ASH$ERROR
         4 003567   000000 011000                    NOP     0

     1432    19191    5               GOTO END_OPTION;

  19191  4 003570   005343 710000 4                  TRA     END_OPTION

     1433    19192    5               END;
     1434    19193    4            CODE2 = PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE ;

  19193  4 003571   100003 473500                    LDP3    3,,PR1
         4 003572   300000 236100                    LDQ     0,,PR3
         4 003573   777777 376007                    ANQ     -1,DL
         4 003574   200020 756100                    STQ     CODE2,,AUTO

     1435    19194    5            DO SELECT ( CODE2 ) ;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:236  
  19194  4 003575   000002 116007                    CMPQ    2,DL
         4 003576   003603 602000 4                  TNC     s:19194+6
         4 003577   003616 600000 4                  TZE     s:19199
         4 003600   000003 116007                    CMPQ    3,DL
         4 003601   005343 601000 4                  TNZ     END_OPTION
         4 003602   003626 710000 4                  TRA     s:19202
         4 003603   000001 116007                    CMPQ    1,DL
         4 003604   005343 601000 4                  TNZ     END_OPTION
         4 003605   003606 710000 4                  TRA     s:19196

     1436    19195    5               SELECT( 1 /* REJECT VALUE */ ) ;

     1437    19196    5               KL$TREC.FLAGS.NOCGREJ = '1'B;

  19196  4 003606   200003 474500                    LDP4    @TREC$,,AUTO
         4 003607   400000 475500                    LDP5    0,,PR4
         4 003610   000004 236003                    LDQ     4,DU
         4 003611   500000 256100                    ORSQ    0,,PR5

     1438    19197    5               KL$TREC.FLAGS.NOCGINF = '0'B;

  19197  4 003612   400000 470500                    LDP0    0,,PR4
         4 003613   000063 236000 5                  LDQ     51
         4 003614   000000 356100                    ANSQ    0,,PR0
         4 003615   005343 710000 4                  TRA     END_OPTION

     1439    19198    5               SELECT ( 2 /* INFORM VALUE */ ) ;

     1440    19199    5               KL$TREC.FLAGS.NOCGINF = '1'B;

  19199  4 003616   200003 474500                    LDP4    @TREC$,,AUTO
         4 003617   400000 475500                    LDP5    0,,PR4
         4 003620   000002 236003                    LDQ     2,DU
         4 003621   500000 256100                    ORSQ    0,,PR5

     1441    19200    5               KL$TREC.FLAGS.NOCGREJ = '0'B;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:237  
  19200  4 003622   400000 470500                    LDP0    0,,PR4
         4 003623   000064 236000 5                  LDQ     52
         4 003624   000000 356100                    ANSQ    0,,PR0
         4 003625   005343 710000 4                  TRA     END_OPTION

     1442    19201    5               SELECT ( 3 /* OK VALUE */) ;

     1443    19202    5               KL$TREC.FLAGS.NOCGINF = '0'B;

  19202  4 003626   200003 474500                    LDP4    @TREC$,,AUTO
         4 003627   400000 475500                    LDP5    0,,PR4
         4 003630   000063 236000 5                  LDQ     51
         4 003631   500000 356100                    ANSQ    0,,PR5

     1444    19203    5               KL$TREC.FLAGS.NOCGREJ = '0'B;

  19203  4 003632   400000 470500                    LDP0    0,,PR4
         4 003633   000064 236000 5                  LDQ     52
         4 003634   000000 356100                    ANSQ    0,,PR0

     1445    19204    5               END; /* Do CODE2  */

  19204  4 003635   005343 710000 4                  TRA     END_OPTION

     1446    19205                                                                                    /**/
     1447    19206    4            SELECT ( 31 /*DEV_NCTL*/);

     1448    19207    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR ;

  19207  4 003636   200050 236100                    LDQ     DEV_USE,,AUTO
         4 003637   000000 116000 2                  CMPQ    DEV_IN_VAL
         4 003640   006137 601000 4                  TNZ     DEV_IN_ERR

     1449    19208    4            IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE=1   /*  YES_VAL  */ THEN

  19208  4 003641   202323 470500                    LDP0    PTR$,,AUTO
         4 003642   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:238  
         4 003643   100000 720100                    LXL0    0,,PR1
         4 003644   000001 100003                    CMPX0   1,DU
         4 003645   003655 601000 4                  TNZ     s:19211

     1450    19209    4               KL$TREC.ISINFO.NCTL=AS_TRUE;

  19209  4 003646   200003 473500                    LDP3    @TREC$,,AUTO
         4 003647   300000 474500                    LDP4    0,,PR3
         4 003650   000000 236000 xsym               LDQ     AS_TRUE
         4 003651   400034 676100                    ERQ     28,,PR4
         4 003652   400000 376003                    ANQ     -131072,DU
         4 003653   400034 656100                    ERSQ    28,,PR4
         4 003654   005343 710000 4                  TRA     END_OPTION

     1451    19210    5            ELSE DO;

     1452    19211    5               KL$TREC.ISINFO.NCTL = AS_FALSE;

  19211  4 003655   200003 473500                    LDP3    @TREC$,,AUTO
         4 003656   300000 474500                    LDP4    0,,PR3
         4 003657   000000 236000 xsym               LDQ     AS_FALSE
         4 003660   400034 676100                    ERQ     28,,PR4
         4 003661   400000 376003                    ANQ     -131072,DU
         4 003662   400034 656100                    ERSQ    28,,PR4

     1453    19212    5               KL$TREC.ISINFO.NCTLFID = AS_FALSE;

  19212  4 003663   300000 470500                    LDP0    0,,PR3
         4 003664   000000 236000 xsym               LDQ     AS_FALSE
         4 003665   000002 772000                    QRL     2
         4 003666   000034 676100                    ERQ     28,,PR0
         4 003667   100000 376003                    ANQ     32768,DU
         4 003670   000034 656100                    ERSQ    28,,PR0

     1454    19213    5               KL$TREC.ISINFO.NFID = ' ';

  19213  4 003671   300000 470500                    LDP0    0,,PR3
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:239  
         4 003672   040100 100400                    MLR     fill='040'O
         4 003673   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 003674   000037 000120                    ADSC9   31,,PR0                  cn=0,n=80

     1455    19214    5               END;

  19214  4 003675   005343 710000 4                  TRA     END_OPTION

     1456    19215
     1457    19216    4            SELECT  (32 /*DEV_NCOK*/ );

     1458    19217    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR ;

  19217  4 003676   200050 236100                    LDQ     DEV_USE,,AUTO
         4 003677   000000 116000 2                  CMPQ    DEV_IN_VAL
         4 003700   006137 601000 4                  TNZ     DEV_IN_ERR

     1459    19218    4            IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE=1   /*  YES_VAL  */ THEN

  19218  4 003701   202323 470500                    LDP0    PTR$,,AUTO
         4 003702   000003 471500                    LDP1    3,,PR0
         4 003703   100000 720100                    LXL0    0,,PR1
         4 003704   000001 100003                    CMPX0   1,DU
         4 003705   003716 601000 4                  TNZ     s:19221

     1460    19219    4               KL$TREC.ISINFO.NCTLOK=AS_TRUE;

  19219  4 003706   200003 473500                    LDP3    @TREC$,,AUTO
         4 003707   300000 474500                    LDP4    0,,PR3
         4 003710   000000 236000 xsym               LDQ     AS_TRUE
         4 003711   000001 772000                    QRL     1
         4 003712   400034 676100                    ERQ     28,,PR4
         4 003713   200000 376003                    ANQ     65536,DU
         4 003714   400034 656100                    ERSQ    28,,PR4
         4 003715   005343 710000 4                  TRA     END_OPTION

     1461    19220    4            ELSE
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:240  
     1462    19221    4               KL$TREC.ISINFO.NCTLOK=AS_FALSE;

  19221  4 003716   200003 473500                    LDP3    @TREC$,,AUTO
         4 003717   300000 474500                    LDP4    0,,PR3
         4 003720   000000 236000 xsym               LDQ     AS_FALSE
         4 003721   000001 772000                    QRL     1
         4 003722   400034 676100                    ERQ     28,,PR4
         4 003723   200000 376003                    ANQ     65536,DU
         4 003724   400034 656100                    ERSQ    28,,PR4
         4 003725   005343 710000 4                  TRA     END_OPTION

     1463    19222
     1464    19223    4            SELECT (35 /*DEV_NCACCT*/);

     1465    19224    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR ;

  19224  4 003726   200050 236100                    LDQ     DEV_USE,,AUTO
         4 003727   000000 116000 2                  CMPQ    DEV_IN_VAL
         4 003730   006137 601000 4                  TNZ     DEV_IN_ERR

     1466    19225    4            BLK$=PTR$->P$NODE.SUBLK$(0);

  19225  4 003731   202323 470500                    LDP0    PTR$,,AUTO
         4 003732   000003 236100                    LDQ     3,,PR0
         4 003733   200015 756100                    STQ     BLK$,,AUTO

     1467    19226    5            IF OUT$SYM.COUNT > 8 THEN DO;

  19226  4 003734   200015 471500                    LDP1    BLK$,,AUTO
         4 003735   100004 236100                    LDQ     4,,PR1
         4 003736   777000 376003                    ANQ     -512,DU
         4 003737   011000 116003                    CMPQ    4608,DU
         4 003740   003746 602000 4                  TNC     s:19248

     1468    19227        /*E* ERROR:   ASA-E$NCACCT_TOO_LONG-C
     1469    19228             MESSAGE: NCACCT name is too long.
     1470    19229             MESSAGE1: NCACCT name can be at most 8 characters long.
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:241  
     1471    19230        */
     1472    19231                    %SCREAM( ERR#=E$NCACCT_TOO_LONG, LEVEL=ERROR, MID='A' );

  19243  4 003741   000065 630400 5                  EPPR0   53
         4 003742   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003743   000000 701000 xent               TSX1    ASH$ERROR
         4 003744   000000 011000                    NOP     0

     1473    19246    5               GOTO END_OPTION;

  19246  4 003745   005343 710000 4                  TRA     END_OPTION

     1474    19247    5               END;
     1475    19248    4            KL$TREC.ISINFO.NCACCT=OUT$SYM.TEXT ;

  19248  4 003746   200003 473500                    LDP3    @TREC$,,AUTO
         4 003747   300000 474500                    LDP4    0,,PR3
         4 003750   100004 236100                    LDQ     4,,PR1
         4 003751   000033 772000                    QRL     27
         4 003752   000000 620006                    EAX0    0,QL
         4 003753   040100 100540                    MLR     fill='040'O
         4 003754   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 003755   400035 000010                    ADSC9   29,,PR4                  cn=0,n=8
         4 003756   005343 710000 4                  TRA     END_OPTION

     1476    19249
     1477    19250    4            SELECT (34 /*DEV_NCFID_VAL*/);

     1478    19251
     1479    19252    4            IF DEV_USE ~= DEV_IN_VAL THEN GOTO DEV_IN_ERR ;

  19252  4 003757   200050 236100                    LDQ     DEV_USE,,AUTO
         4 003760   000000 116000 2                  CMPQ    DEV_IN_VAL
         4 003761   006137 601000 4                  TNZ     DEV_IN_ERR

     1480    19253    5            IF PTR$->P$NODE.CODE = 7   /*  NONE_VAL  */ THEN DO;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:242  
  19253  4 003762   202323 470500                    LDP0    PTR$,,AUTO
         4 003763   000000 720100                    LXL0    0,,PR0
         4 003764   000007 100003                    CMPX0   7,DU
         4 003765   003777 601000 4                  TNZ     s:19258

     1481    19254    5               KL$TREC.ISINFO.NFID = ' ';

  19254  4 003766   200003 471500                    LDP1    @TREC$,,AUTO
         4 003767   100000 473500                    LDP3    0,,PR1
         4 003770   040100 100400                    MLR     fill='040'O
         4 003771   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 003772   300037 000120                    ADSC9   31,,PR3                  cn=0,n=80

     1482    19255    5               KL$TREC.ISINFO.NCTLFID = %NO#;

  19255  4 003773   100000 470500                    LDP0    0,,PR1
         4 003774   000066 236000 5                  LDQ     54
         4 003775   000034 356100                    ANSQ    28,,PR0

     1483    19256    5               GOTO END_OPTION;

  19256  4 003776   005343 710000 4                  TRA     END_OPTION

     1484    19257    5               END;  /*  None  */
     1485    19258    4            BLK$=PTR$->P$NODE.SUBLK$(0);

  19258  4 003777   000003 236100                    LDQ     3,,PR0
         4 004000   200015 756100                    STQ     BLK$,,AUTO

     1486    19259    5            IF OUT$SYM.COUNT > 80 THEN DO;

  19259  4 004001   200015 471500                    LDP1    BLK$,,AUTO
         4 004002   100004 236100                    LDQ     4,,PR1
         4 004003   777000 376003                    ANQ     -512,DU
         4 004004   121000 116003                    CMPQ    41472,DU
         4 004005   004013 602000 4                  TNC     s:19281

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:243  
     1487    19260        /*E* ERROR:   ASA-E$NCFID_TOO_LONG-C
     1488    19261             MESSAGE: NCFID name is too long.
     1489    19262             MESSAGE1: NCFID name can be at most 80 characters long.
     1490    19263        */
     1491    19264                    %SCREAM( ERR#=E$NCFID_TOO_LONG, LEVEL=ERROR, MID='A' );

  19276  4 004006   000067 630400 5                  EPPR0   55
         4 004007   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004010   000000 701000 xent               TSX1    ASH$ERROR
         4 004011   000000 011000                    NOP     0

     1492    19279    5               GOTO END_OPTION;

  19279  4 004012   005343 710000 4                  TRA     END_OPTION

     1493    19280    5               END;
     1494    19281    4            KL$TREC.ISINFO.NFID=OUT$SYM.TEXT;

  19281  4 004013   200003 473500                    LDP3    @TREC$,,AUTO
         4 004014   300000 474500                    LDP4    0,,PR3
         4 004015   100004 236100                    LDQ     4,,PR1
         4 004016   000033 772000                    QRL     27
         4 004017   000000 621006                    EAX1    0,QL
         4 004020   040100 100540                    MLR     fill='040'O
         4 004021   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 004022   400037 000120                    ADSC9   31,,PR4                  cn=0,n=80

     1495    19282    4            KL$TREC.ISINFO.NCTLFID = %YES#;

  19282  4 004023   300000 470500                    LDP0    0,,PR3
         4 004024   100000 236003                    LDQ     32768,DU
         4 004025   000034 256100                    ORSQ    28,,PR0
         4 004026   005343 710000 4                  TRA     END_OPTION

     1496    19283
     1497    19284    4            SELECT (27 /*DEV_UPL*/);

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:244  
     1498    19285        /*E* ERROR: ASA-E$DEVONLYOUT-0
     1499    19286             MESSAGE: UPLOCKED is legal only if USE=OUTSYM
     1500    19287        */
     1501    19288    5            IF DEV_USE ~= DEV_OUT_VAL THEN DO;

  19288  4 004027   200050 236100                    LDQ     DEV_USE,,AUTO
         4 004030   000001 116000 2                  CMPQ    DEV_OUT_VAL
         4 004031   004037 600000 4                  TZE     s:19306

     1502    19289                    %SCREAM( ERR#=E$DEVONLYOUT, LEVEL=ERROR, MID='A' );

  19301  4 004032   000070 630400 5                  EPPR0   56
         4 004033   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004034   000000 701000 xent               TSX1    ASH$ERROR
         4 004035   000000 011000                    NOP     0

     1503    19304    5               GOTO END_OPTION;

  19304  4 004036   005343 710000 4                  TRA     END_OPTION

     1504    19305    5               END;
     1505    19306    4            IF PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE=1   /*  YES_VAL  */ THEN

  19306  4 004037   202323 470500                    LDP0    PTR$,,AUTO
         4 004040   000003 471500                    LDP1    3,,PR0
         4 004041   100000 720100                    LXL0    0,,PR1
         4 004042   000001 100003                    CMPX0   1,DU
         4 004043   004053 601000 4                  TNZ     s:19309

     1506    19307    4               KL$TREC.OSINFO.UPLOCKED = AS_TRUE;

  19307  4 004044   200003 473500                    LDP3    @TREC$,,AUTO
         4 004045   300000 474500                    LDP4    0,,PR3
         4 004046   000000 236000 xsym               LDQ     AS_TRUE
         4 004047   400067 676100                    ERQ     55,,PR4
         4 004050   400000 376003                    ANQ     -131072,DU
         4 004051   400067 656100                    ERSQ    55,,PR4
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:245  
         4 004052   005343 710000 4                  TRA     END_OPTION

     1507    19308    4            ELSE
     1508    19309    4               KL$TREC.OSINFO.UPLOCKED = AS_FALSE;

  19309  4 004053   200003 473500                    LDP3    @TREC$,,AUTO
         4 004054   300000 474500                    LDP4    0,,PR3
         4 004055   000000 236000 xsym               LDQ     AS_FALSE
         4 004056   400067 676100                    ERQ     55,,PR4
         4 004057   400000 376003                    ANQ     -131072,DU
         4 004060   400067 656100                    ERSQ    55,,PR4
         4 004061   005343 710000 4                  TRA     END_OPTION

     1509    19310
     1510    19311    4            SELECT (28 /*DEV_FORM*/);

     1511    19312    5            IF DEV_USE ~= DEV_OUT_VAL THEN DO;

  19312  4 004062   200050 236100                    LDQ     DEV_USE,,AUTO
         4 004063   000001 116000 2                  CMPQ    DEV_OUT_VAL
         4 004064   004072 600000 4                  TZE     s:19334

     1512    19313        /*E* ERROR: ASA-E$FORMONLYOUT-0
     1513    19314             MESSAGE: FORM is only legal if USE=OUTSYM.
     1514    19315             MESSAGE1: To specify a FORM, the USE parameter must = OUTSYM.
     1515    19316        */
     1516    19317                    %SCREAM( ERR#=E$FORMONLYOUT, LEVEL=ERROR, MID='A' );

  19329  4 004065   000071 630400 5                  EPPR0   57
         4 004066   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004067   000000 701000 xent               TSX1    ASH$ERROR
         4 004070   000000 011000                    NOP     0

     1517    19332    5               GOTO END_OPTION;

  19332  4 004071   005343 710000 4                  TRA     END_OPTION

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:246  
     1518    19333    5               END;
     1519    19334    4            BLK$=PTR$->P$NODE.SUBLK$(0);

  19334  4 004072   202323 470500                    LDP0    PTR$,,AUTO
         4 004073   000003 236100                    LDQ     3,,PR0
         4 004074   200015 756100                    STQ     BLK$,,AUTO

     1520    19335    5            IF OUT$SYM.COUNT > 6 THEN DO;

  19335  4 004075   200015 471500                    LDP1    BLK$,,AUTO
         4 004076   100004 236100                    LDQ     4,,PR1
         4 004077   777000 376003                    ANQ     -512,DU
         4 004100   007000 116003                    CMPQ    3584,DU
         4 004101   004107 602000 4                  TNC     s:19357

     1521    19336        /*E* ERROR:   ASA-E$FORM_NAME_TOO_LONG-C
     1522    19337             MESSAGE: FORM name is too long.
     1523    19338             MESSAGE1: FORM name can be at most 6 characters long.
     1524    19339        */
     1525    19340                    %SCREAM( ERR#=E$FORM_NAME_TOO_LONG, LEVEL=ERROR, MID='A');

  19352  4 004102   000072 630400 5                  EPPR0   58
         4 004103   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004104   000000 701000 xent               TSX1    ASH$ERROR
         4 004105   000000 011000                    NOP     0

     1526    19355    5               GOTO END_OPTION;

  19355  4 004106   005343 710000 4                  TRA     END_OPTION

     1527    19356    5               END;
     1528    19357    4            IF OUT$SYM.TEXT = 'NONE' THEN

  19357  4 004107   100004 236100                    LDQ     4,,PR1
         4 004110   000033 772000                    QRL     27
         4 004111   000000 620006                    EAX0    0,QL
         4 004112   040000 106540                    CMPC    fill='040'O
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:247  
         4 004113   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 004114   000264 000004 2                  ADSC9   Z_ACCT+57                cn=0,n=4
         4 004115   004124 601000 4                  TNZ     s:19360

     1529    19358    4               KL$TREC.OSINFO.FNAME=ZERO_ACCNT;

  19358  4 004116   200003 473500                    LDP3    @TREC$,,AUTO
         4 004117   300000 474500                    LDP4    0,,PR3
         4 004120   040100 100400                    MLR     fill='040'O
         4 004121   000173 000006 2                  ADSC9   Z_ACCT                   cn=0,n=6
         4 004122   400070 000006                    ADSC9   56,,PR4                  cn=0,n=6
         4 004123   004131 710000 4                  TRA     s:19361

     1530    19359    4            ELSE
     1531    19360    4               KL$TREC.OSINFO.FNAME=OUT$SYM.TEXT;

  19360  4 004124   200003 473500                    LDP3    @TREC$,,AUTO
         4 004125   300000 474500                    LDP4    0,,PR3
         4 004126   040100 100540                    MLR     fill='040'O
         4 004127   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 004130   400070 000006                    ADSC9   56,,PR4                  cn=0,n=6

     1532    19361    4            FORM$ = ADDR(FORM_BUF);

  19361  4 004131   200053 630500                    EPPR0   FORM_BUF,,AUTO
         4 004132   200051 450500                    STP0    FORM$,,AUTO

     1533    19362    4            USERS_KEY.COUNT=6;

  19362  4 004133   006000 236003                    LDQ     3072,DU
         4 004134   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1534    19363    4            USERS_KEY.TXTC = OUT$SYM.TEXT;

  19363  4 004135   100004 236100                    LDQ     4,,PR1
         4 004136   000033 772000                    QRL     27
         4 004137   000000 620006                    EAX0    0,QL
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:248  
         4 004140   040000 100540                    MLR     fill='040'O
         4 004141   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 004142   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

     1535    19364    4            FORM_ARS = LENGTHC(FORM_BUF);

  19364  4 004143   006510 235007                    LDA     3400,DL
         4 004144   200052 755100                    STA     FORM_ARS,,AUTO

     1536    19365    4            CALL ASF$READ_FORM(USERS_KEY,FORM$,FORM_ARS)

  19365  4 004145   200052 634500                    EPPR4   FORM_ARS,,AUTO
         4 004146   202344 454500                    STP4    YES_NO_FLG+4,,AUTO
         4 004147   200051 635500                    EPPR5   FORM$,,AUTO
         4 004150   202343 455500                    STP5    YES_NO_FLG+3,,AUTO
         4 004151   000007 236000 5                  LDQ     7
         4 004152   202342 756100                    STQ     YES_NO_FLG+2,,AUTO
         4 004153   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 004154   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 004155   000000 701000 xent               TSX1    ASF$READ_FORM
         4 004156   004160 702000 4                  TSX2    s:19367
         4 004157   004203 710000 4                  TRA     s:19391+1

     1537    19366    5            WHENALTRETURN DO;

     1538    19367    5               IF MERR_CODE.CODE = %E$NOKEY

  19367  4 004160   000000 236000 xsym               LDQ     ERR_CODE
         4 004161   377770 376007                    ANQ     131064,DL
         4 004162   001020 116007                    CMPQ    528,DL
         4 004163   004202 601000 4                  TNZ     s:19391

     1539    19368    6               THEN DO;

     1540    19369                       /*E*  ERROR: ASA-E$FNOEXIST-0
     1541    19370                             MESSAGE: Warning: Form %%U1 %does not exist.
     1542    19371                       */
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:249  
     1543    19372    6                  CALL INDEX( I, AS_BLANK, USERS_KEY.TXTC );

  19372  4 004164   000000 124400                    SCM     mask='000'O
         4 004165   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         4 004166   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 004167   201676 000100                    ARG     I,,AUTO

     1544    19373    6                  AS_FIELD1.COUNT = I ;

  19373  4 004170   201676 236100                    LDQ     I,,AUTO
         4 004171   000033 736000                    QLS     27
         4 004172   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     1545    19374    6                  AS_FIELD1.TEXT = USERS_KEY.TXTC ;

  19374  4 004173   040000 100400                    MLR     fill='040'O
         4 004174   000000 200050 xsym               ADSC9   USERS_KEY                cn=1,n=40
         4 004175   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     1546    19375                       %SCREAM( ERR#=E$FNOEXIST, LEVEL=WARN, MID='A' );

  19385  4 004176   000073 630400 5                  EPPR0   59
         4 004177   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004200   000000 701000 xent               TSX1    ASH$WARN
         4 004201   000000 011000                    NOP     0

     1547    19390    6                  END;  /*  Error is no key  */

     1548    19391    5               GOTO END_OPTION ;

  19391  4 004202   005343 710000 4                  TRA     END_OPTION
         4 004203   005343 710000 4                  TRA     END_OPTION

     1549    19392    5               END; /*  Whenaltreturn  */
     1550    19393
     1551    19394    4            SELECT ( %DEV_DEVNUM_VAL ) ;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:250  
     1552    19395
     1553    19396    5            IF NOT SUB THEN DO;

  19396  4 004204   200007 473500                    LDP3    @SUB,,AUTO
         4 004205   300000 234100                    SZN     0,,PR3
         4 004206   004214 604000 4                  TMI     s:19415

     1554    19397                    %SCREAM (ERR#=%E$DEVNUMNOTLEGL,LEVEL=ERROR,MID='A');

  19409  4 004207   000074 630400 5                  EPPR0   60
         4 004210   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004211   000000 701000 xent               TSX1    ASH$ERROR
         4 004212   000000 011000                    NOP     0

     1555    19412    5               GOTO END_OPTION;

  19412  4 004213   005343 710000 4                  TRA     END_OPTION

     1556    19413    5               END; /*  Not sub  */
     1557    19414
     1558    19415    5            DO SELECT( PTR$->P$NODE.SUBLK$(0)->P$NODE.CODE ) ;

  19415  4 004214   100003 474500                    LDP4    3,,PR1
         4 004215   400000 236100                    LDQ     0,,PR4
         4 004216   777777 376007                    ANQ     -1,DL
         4 004217   000010 116007                    CMPQ    8,DL
         4 004220   004247 602000 4                  TNC     s:19415+27
         4 004221   004370 600000 4                  TZE     s:19442
         4 004222   000013 116007                    CMPQ    11,DL
         4 004223   004240 602000 4                  TNC     s:19415+20
         4 004224   004406 600000 4                  TZE     s:19447
         4 004225   000015 116007                    CMPQ    13,DL
         4 004226   004234 602000 4                  TNC     s:19415+16
         4 004227   004476 600000 4                  TZE     s:19467
         4 004230   400000 721100                    LXL1    0,,PR4
         4 004231   000026 101003                    CMPX1   22,DU
         4 004232   004547 601000 4                  TNZ     s:19478
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:251  
         4 004233   004514 710000 4                  TRA     s:19472
         4 004234   400000 721100                    LXL1    0,,PR4
         4 004235   000014 101003                    CMPX1   12,DU
         4 004236   004547 601000 4                  TNZ     s:19478
         4 004237   004424 710000 4                  TRA     s:19452
         4 004240   000011 116007                    CMPQ    9,DL
         4 004241   004547 602000 4                  TNC     s:19478
         4 004242   004442 600000 4                  TZE     s:19457
         4 004243   400000 721100                    LXL1    0,,PR4
         4 004244   000012 101003                    CMPX1   10,DU
         4 004245   004547 601000 4                  TNZ     s:19478
         4 004246   004460 710000 4                  TRA     s:19462
         4 004247   000004 116007                    CMPQ    4,DL
         4 004250   004265 602000 4                  TNC     s:19415+41
         4 004251   004324 600000 4                  TZE     s:19427
         4 004252   000006 116007                    CMPQ    6,DL
         4 004253   004261 602000 4                  TNC     s:19415+37
         4 004254   004340 600000 4                  TZE     s:19433
         4 004255   400000 721100                    LXL1    0,,PR4
         4 004256   000007 101003                    CMPX1   7,DU
         4 004257   004547 601000 4                  TNZ     s:19478
         4 004260   004346 710000 4                  TRA     s:19436
         4 004261   400000 720100                    LXL0    0,,PR4
         4 004262   000005 100003                    CMPX0   5,DU
         4 004263   004547 601000 4                  TNZ     s:19478
         4 004264   004332 710000 4                  TRA     s:19430
         4 004265   400000 236100                    LDQ     0,,PR4
         4 004266   777777 376007                    ANQ     -1,DL
         4 004267   000002 116007                    CMPQ    2,DL
         4 004270   004276 602000 4                  TNC     s:19415+50
         4 004271   004310 600000 4                  TZE     s:19421
         4 004272   400000 720100                    LXL0    0,,PR4
         4 004273   000003 100003                    CMPX0   3,DU
         4 004274   004547 601000 4                  TNZ     s:19478
         4 004275   004316 710000 4                  TRA     s:19424
         4 004276   400000 720100                    LXL0    0,,PR4
         4 004277   000001 100003                    CMPX0   1,DU
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:252  
         4 004300   004547 601000 4                  TNZ     s:19478
         4 004301   004302 710000 4                  TRA     s:19418

     1559    19416
     1560    19417    5               SELECT( %PD_2780LP_VAL ) ;

     1561    19418    5               KL$DADR.DEVNUM# = %KLDN_2780LP# ;

  19418  4 004302   200013 470500                    LDP0    @DADR$,,AUTO
         4 004303   000000 471500                    LDP1    0,,PR0
         4 004304   003100 060400                    CSL     bolr='003'O
         4 004305   000036 000011 5                  BDSC    30                       by=0,bit=0,n=9
         4 004306   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9
         4 004307   004547 710000 4                  TRA     s:19478

     1562    19419
     1563    19420    5               SELECT( %PD_2780CR_VAL ) ;

     1564    19421    5               KL$DADR.DEVNUM# = %KLDN_2780CR# ;

  19421  4 004310   200013 470500                    LDP0    @DADR$,,AUTO
         4 004311   000000 471500                    LDP1    0,,PR0
         4 004312   003100 060400                    CSL     bolr='003'O
         4 004313   000035 000011 5                  BDSC    29                       by=0,bit=0,n=9
         4 004314   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9
         4 004315   004547 710000 4                  TRA     s:19478

     1565    19422
     1566    19423    5               SELECT( %PD_2780CP_VAL ) ;

     1567    19424    5               KL$DADR.DEVNUM# = %KLDN_2780CP# ;

  19424  4 004316   200013 470500                    LDP0    @DADR$,,AUTO
         4 004317   000000 471500                    LDP1    0,,PR0
         4 004320   003100 060400                    CSL     bolr='003'O
         4 004321   000034 000011 5                  BDSC    28                       by=0,bit=0,n=9
         4 004322   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:253  
         4 004323   004547 710000 4                  TRA     s:19478

     1568    19425
     1569    19426    5               SELECT( %PD_3780LP_VAL ) ;

     1570    19427    5               KL$DADR.DEVNUM# = %KLDN_3780LP# ;

  19427  4 004324   200013 470500                    LDP0    @DADR$,,AUTO
         4 004325   000000 471500                    LDP1    0,,PR0
         4 004326   003100 060400                    CSL     bolr='003'O
         4 004327   000040 000011 5                  BDSC    32                       by=0,bit=0,n=9
         4 004330   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9
         4 004331   004547 710000 4                  TRA     s:19478

     1571    19428
     1572    19429    5               SELECT( %PD_3780CR_VAL ) ;

     1573    19430    5               KL$DADR.DEVNUM# = %KLDN_3780CR# ;

  19430  4 004332   200013 470500                    LDP0    @DADR$,,AUTO
         4 004333   000000 471500                    LDP1    0,,PR0
         4 004334   003100 060400                    CSL     bolr='003'O
         4 004335   000002 000011 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=9
         4 004336   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9
         4 004337   004547 710000 4                  TRA     s:19478

     1574    19431
     1575    19432    5               SELECT( %PD_3780CP_VAL ) ;

     1576    19433    5               KL$DADR.DEVNUM# = %KLDN_3780CP# ;

  19433  4 004340   200013 470500                    LDP0    @DADR$,,AUTO
         4 004341   000000 471500                    LDP1    0,,PR0
         4 004342   003100 060400                    CSL     bolr='003'O
         4 004343   000037 000011 5                  BDSC    31                       by=0,bit=0,n=9
         4 004344   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9
         4 004345   004547 710000 4                  TRA     s:19478
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:254  

     1577    19434
     1578    19435    5               SELECT( %PD_HASPOC_VAL ) ;

     1579    19436    5               KL$DADR.DEVNUM# = %KLDN_HASPOC# ;

  19436  4 004346   200013 470500                    LDP0    @DADR$,,AUTO
         4 004347   000000 471500                    LDP1    0,,PR0
         4 004350   003100 060400                    CSL     bolr='003'O
         4 004351   000075 000011 5                  BDSC    61                       by=0,bit=0,n=9
         4 004352   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9

     1580    19437    5               KL$DADR.SDNUM# = %KLDN_HASPOCS# ;

  19437  4 004353   000000 471500                    LDP1    0,,PR0
         4 004354   003100 060400                    CSL     bolr='003'O
         4 004355   000076 000011 5                  BDSC    62                       by=0,bit=0,n=9
         4 004356   100000 200011                    BDSC    0,,PR1                   by=1,bit=0,n=9

     1581    19438    5               KL$DADR.DEVCTL.T = '0'B ;

  19438  4 004357   000000 471500                    LDP1    0,,PR0
         4 004360   003100 060400                    CSL     bolr='003'O
         4 004361   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         4 004362   100000 410010                    BDSC    0,,PR1                   by=2,bit=1,n=8

     1582    19439    5               KL$DADR.DEVCTL.B = %KLDCB_HASPOC# ;

  19439  4 004363   000000 471500                    LDP1    0,,PR0
         4 004364   003100 060400                    CSL     bolr='003'O
         4 004365   000077 000010 5                  BDSC    63                       by=0,bit=0,n=8
         4 004366   100000 610010                    BDSC    0,,PR1                   by=3,bit=1,n=8
         4 004367   004547 710000 4                  TRA     s:19478

     1583    19440
     1584    19441    5               SELECT( %PD_HASPLP_VAL ) ;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:255  
     1585    19442    5               KL$DADR.DEVNUM#  = %KLDN_HASPLP# ;

  19442  4 004370   200013 475500                    LDP5    @DADR$,,AUTO
         4 004371   500000 476500                    LDP6    0,,PR5
         4 004372   003100 060400                    CSL     bolr='003'O
         4 004373   000032 000011 5                  BDSC    26                       by=0,bit=0,n=9
         4 004374   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1586    19443    5               KL$DADR.DEVCTL.T = %KLDCT_HASPLP# ;

  19443  4 004375   500000 470500                    LDP0    0,,PR5
         4 004376   003100 060400                    CSL     bolr='003'O
         4 004377   000042 000010 5                  BDSC    34                       by=0,bit=0,n=8
         4 004400   000000 410010                    BDSC    0,,PR0                   by=2,bit=1,n=8

     1587    19444    5               KL$DADR.DEVCTL.B ='0'B ;

  19444  4 004401   500000 470500                    LDP0    0,,PR5
         4 004402   003100 060400                    CSL     bolr='003'O
         4 004403   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         4 004404   000000 610010                    BDSC    0,,PR0                   by=3,bit=1,n=8
         4 004405   004547 710000 4                  TRA     s:19478

     1588    19445
     1589    19446    5               SELECT( %PD_HASPCR_VAL ) ;

     1590    19447    5               KL$DADR.DEVNUM# = %KLDN_HASPCR# ;

  19447  4 004406   200013 475500                    LDP5    @DADR$,,AUTO
         4 004407   500000 476500                    LDP6    0,,PR5
         4 004410   003100 060400                    CSL     bolr='003'O
         4 004411   000031 000011 5                  BDSC    25                       by=0,bit=0,n=9
         4 004412   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1591    19448    5               KL$DADR.DEVCTL.T = '0'B ;

  19448  4 004413   500000 470500                    LDP0    0,,PR5
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:256  
         4 004414   003100 060400                    CSL     bolr='003'O
         4 004415   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         4 004416   000000 410010                    BDSC    0,,PR0                   by=2,bit=1,n=8

     1592    19449    5               KL$DADR.DEVCTL.B = %KLDCB_HASPCR# ;

  19449  4 004417   500000 470500                    LDP0    0,,PR5
         4 004420   003100 060400                    CSL     bolr='003'O
         4 004421   000041 000010 5                  BDSC    33                       by=0,bit=0,n=8
         4 004422   000000 610010                    BDSC    0,,PR0                   by=3,bit=1,n=8
         4 004423   004547 710000 4                  TRA     s:19478

     1593    19450
     1594    19451    5               SELECT( %PD_HASPCP_VAL ) ;

     1595    19452    5               KL$DADR.DEVNUM# = %KLDN_HASPCP# ;

  19452  4 004424   200013 475500                    LDP5    @DADR$,,AUTO
         4 004425   500000 476500                    LDP6    0,,PR5
         4 004426   003100 060400                    CSL     bolr='003'O
         4 004427   000030 000011 5                  BDSC    24                       by=0,bit=0,n=9
         4 004430   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1596    19453    5               KL$DADR.DEVCTL.T = '0'B ;

  19453  4 004431   500000 470500                    LDP0    0,,PR5
         4 004432   003100 060400                    CSL     bolr='003'O
         4 004433   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         4 004434   000000 410010                    BDSC    0,,PR0                   by=2,bit=1,n=8

     1597    19454    5               KL$DADR.DEVCTL.B = %KLDCB_HASPCP# ;

  19454  4 004435   500000 470500                    LDP0    0,,PR5
         4 004436   003100 060400                    CSL     bolr='003'O
         4 004437   000041 000010 5                  BDSC    33                       by=0,bit=0,n=8
         4 004440   000000 610010                    BDSC    0,,PR0                   by=3,bit=1,n=8
         4 004441   004547 710000 4                  TRA     s:19478
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:257  

     1598    19455
     1599    19456    5               SELECT( %PD_HASPLP2_VAL ) ;

     1600    19457    5               KL$DADR.DEVNUM#  = %KLDN_HASPLP2# ;

  19457  4 004442   200013 475500                    LDP5    @DADR$,,AUTO
         4 004443   500000 476500                    LDP6    0,,PR5
         4 004444   003100 060400                    CSL     bolr='003'O
         4 004445   000033 000011 5                  BDSC    27                       by=0,bit=0,n=9
         4 004446   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1601    19458    5               KL$DADR.DEVCTL.T = %KLDCT_HASPLP2# ;

  19458  4 004447   500000 470500                    LDP0    0,,PR5
         4 004450   003100 060400                    CSL     bolr='003'O
         4 004451   000100 000010 5                  BDSC    64                       by=0,bit=0,n=8
         4 004452   000000 410010                    BDSC    0,,PR0                   by=2,bit=1,n=8

     1602    19459    5               KL$DADR.DEVCTL.B ='0'B ;

  19459  4 004453   500000 470500                    LDP0    0,,PR5
         4 004454   003100 060400                    CSL     bolr='003'O
         4 004455   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         4 004456   000000 610010                    BDSC    0,,PR0                   by=3,bit=1,n=8
         4 004457   004547 710000 4                  TRA     s:19478

     1603    19460
     1604    19461    5               SELECT( %PD_HASPLP3_VAL ) ;

     1605    19462    5               KL$DADR.DEVNUM# = %KLDN_HASPLP3# ;

  19462  4 004460   200013 475500                    LDP5    @DADR$,,AUTO
         4 004461   500000 476500                    LDP6    0,,PR5
         4 004462   003100 060400                    CSL     bolr='003'O
         4 004463   000101 000011 5                  BDSC    65                       by=0,bit=0,n=9
         4 004464   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:258  

     1606    19463    5               KL$DADR.DEVCTL.T = %KLDCT_HASPLP3# ;

  19463  4 004465   500000 470500                    LDP0    0,,PR5
         4 004466   003100 060400                    CSL     bolr='003'O
         4 004467   000034 000010 5                  BDSC    28                       by=0,bit=0,n=8
         4 004470   000000 410010                    BDSC    0,,PR0                   by=2,bit=1,n=8

     1607    19464    5               KL$DADR.DEVCTL.B = '0'B ;

  19464  4 004471   500000 470500                    LDP0    0,,PR5
         4 004472   003100 060400                    CSL     bolr='003'O
         4 004473   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         4 004474   000000 610010                    BDSC    0,,PR0                   by=3,bit=1,n=8
         4 004475   004547 710000 4                  TRA     s:19478

     1608    19465
     1609    19466    5               SELECT( %PD_IBMCR_VAL ) ;

     1610    19467    5               KL$DADR.DEVNUM# = %KLDN_IBMCR# ;

  19467  4 004476   200013 475500                    LDP5    @DADR$,,AUTO
         4 004477   500000 476500                    LDP6    0,,PR5
         4 004500   003100 060400                    CSL     bolr='003'O
         4 004501   000031 000011 5                  BDSC    25                       by=0,bit=0,n=9
         4 004502   600000 000011                    BDSC    0,,PR6                   by=0,bit=0,n=9

     1611    19468    5               KL$DADR.DEVCTL.T = %KLDCT_IBMCR# ;

  19468  4 004503   500000 470500                    LDP0    0,,PR5
         4 004504   003100 060400                    CSL     bolr='003'O
         4 004505   000042 000010 5                  BDSC    34                       by=0,bit=0,n=8
         4 004506   000000 410010                    BDSC    0,,PR0                   by=2,bit=1,n=8

     1612    19469    5               KL$DADR.DEVCTL.B = '0'B ;

  19469  4 004507   500000 470500                    LDP0    0,,PR5
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:259  
         4 004510   003100 060400                    CSL     bolr='003'O
         4 004511   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         4 004512   000000 610010                    BDSC    0,,PR0                   by=3,bit=1,n=8
         4 004513   004547 710000 4                  TRA     s:19478

     1613    19470
     1614    19471    5               SELECT( 22 /* HEX */ ) ;

     1615    19472    5               OPTION.COUNT = 7;

  19472  4 004514   007000 236003                    LDQ     3584,DU
         4 004515   201706 552140                    STBQ    OPTION,'40'O,AUTO

     1616    19473    5               OPTION.TEXT = 'DEVNUM ';

  19473  4 004516   040100 100400                    MLR     fill='040'O
         4 004517   000267 000007 2                  ADSC9   Z_ACCT+60                cn=0,n=7
         4 004520   201706 200037                    ADSC9   OPTION,,AUTO             cn=1,n=31

     1617    19474    5               CALL ASB$GET_HEX_VAL( 1, HEX, PTR$, OPTION ) ALTRET( END_OPTION );

  19474  4 004521   201706 634500                    EPPR4   OPTION,,AUTO
         4 004522   202345 454500                    STP4    YES_NO_FLG+5,,AUTO
         4 004523   202323 635500                    EPPR5   PTR$,,AUTO
         4 004524   202344 455500                    STP5    YES_NO_FLG+4,,AUTO
         4 004525   201576 636500                    EPPR6   HEX,,AUTO
         4 004526   202343 456500                    STP6    YES_NO_FLG+3,,AUTO
         4 004527   000002 236000 5                  LDQ     2
         4 004530   202342 756100                    STQ     YES_NO_FLG+2,,AUTO
         4 004531   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 004532   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 004533   000000 701000 xent               TSX1    ASB$GET_HEX_VAL
         4 004534   005343 702000 4                  TSX2    END_OPTION

     1618    19475    5               KL$DADR.DEVNUM# = BINBIT( HEX(1), 9 );

  19475  4 004535   200013 470500                    LDP0    @DADR$,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:260  
         4 004536   000000 471500                    LDP1    0,,PR0
         4 004537   201576 236100                    LDQ     HEX,,AUTO
         4 004540   000022 772000                    QRL     18
         4 004541   000777 376007                    ANQ     511,DL
         4 004542   000033 736000                    QLS     27
         4 004543   202342 756100                    STQ     YES_NO_FLG+2,,AUTO
         4 004544   003100 060500                    CSL     bolr='003'O
         4 004545   202342 000044                    BDSC    YES_NO_FLG+2,,AUTO       by=0,bit=0,n=36
         4 004546   100000 000011                    BDSC    0,,PR1                   by=0,bit=0,n=9

     1619    19476
     1620    19477    5               END ; /* Do case( CODE2 ) */

     1621    19478    4            DEVNUM_SET = %YES#;

  19478  4 004547   400000 236003                    LDQ     -131072,DU
         4 004550   200047 756100                    STQ     DEVNUM_SET,,AUTO
         4 004551   005343 710000 4                  TRA     END_OPTION

     1622    19479
     1623    19480    4            SELECT ( %DEV_SDNUM_VAL ) ;

     1624    19481    5            IF NOT SUB THEN DO;

  19481  4 004552   200007 473500                    LDP3    @SUB,,AUTO
         4 004553   300000 234100                    SZN     0,,PR3
         4 004554   004562 604000 4                  TMI     s:19500

     1625    19482                    %SCREAM (ERR#=%E$SDNUMNOTLEGL,LEVEL=ERROR,MID='A');

  19494  4 004555   000102 630400 5                  EPPR0   66
         4 004556   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004557   000000 701000 xent               TSX1    ASH$ERROR
         4 004560   000000 011000                    NOP     0

     1626    19497    5               GOTO END_OPTION;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:261  
  19497  4 004561   005343 710000 4                  TRA     END_OPTION

     1627    19498    5               END; /*  Not sub  */
     1628    19499
     1629    19500    4            OPTION.COUNT = 6;

  19500  4 004562   006000 236003                    LDQ     3072,DU
         4 004563   201706 552140                    STBQ    OPTION,'40'O,AUTO

     1630    19501    4            OPTION.TEXT = 'SDNUM ';

  19501  4 004564   040100 100400                    MLR     fill='040'O
         4 004565   000272 000006 2                  ADSC9   Z_ACCT+63                cn=0,n=6
         4 004566   201706 200037                    ADSC9   OPTION,,AUTO             cn=1,n=31

     1631    19502    4            CALL ASB$GET_HEX_VAL( 1, HEX, PTR$, OPTION ) ALTRET( END_OPTION );

  19502  4 004567   201706 634500                    EPPR4   OPTION,,AUTO
         4 004570   202345 454500                    STP4    YES_NO_FLG+5,,AUTO
         4 004571   202323 635500                    EPPR5   PTR$,,AUTO
         4 004572   202344 455500                    STP5    YES_NO_FLG+4,,AUTO
         4 004573   201576 636500                    EPPR6   HEX,,AUTO
         4 004574   202343 456500                    STP6    YES_NO_FLG+3,,AUTO
         4 004575   000002 236000 5                  LDQ     2
         4 004576   202342 756100                    STQ     YES_NO_FLG+2,,AUTO
         4 004577   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 004600   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 004601   000000 701000 xent               TSX1    ASB$GET_HEX_VAL
         4 004602   005343 702000 4                  TSX2    END_OPTION

     1632    19503    4            KL$DADR.SDNUM# = BINBIT( HEX(1), 9 );

  19503  4 004603   200013 470500                    LDP0    @DADR$,,AUTO
         4 004604   000000 471500                    LDP1    0,,PR0
         4 004605   201576 236100                    LDQ     HEX,,AUTO
         4 004606   000022 772000                    QRL     18
         4 004607   000777 376007                    ANQ     511,DL
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:262  
         4 004610   000033 736000                    QLS     27
         4 004611   202342 756100                    STQ     YES_NO_FLG+2,,AUTO
         4 004612   003100 060500                    CSL     bolr='003'O
         4 004613   202342 000044                    BDSC    YES_NO_FLG+2,,AUTO       by=0,bit=0,n=36
         4 004614   100000 200011                    BDSC    0,,PR1                   by=1,bit=0,n=9
         4 004615   005343 710000 4                  TRA     END_OPTION

     1633    19504
     1634    19505    4            SELECT ( %DEV_DEVCTL_VAL ) ;

     1635    19506    5            IF NOT SUB THEN DO;

  19506  4 004616   200007 473500                    LDP3    @SUB,,AUTO
         4 004617   300000 234100                    SZN     0,,PR3
         4 004620   004626 604000 4                  TMI     s:19525

     1636    19507                    %SCREAM (ERR#=%E$SDNUMNOTLEGL,LEVEL=ERROR,MID='A');

  19519  4 004621   000102 630400 5                  EPPR0   66
         4 004622   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004623   000000 701000 xent               TSX1    ASH$ERROR
         4 004624   000000 011000                    NOP     0

     1637    19522    5               GOTO END_OPTION;

  19522  4 004625   005343 710000 4                  TRA     END_OPTION

     1638    19523    5               END; /*  Not sub  */
     1639    19524
     1640    19525    4            OPTION.TEXT = 'DEVCTL ';

  19525  4 004626   040100 100400                    MLR     fill='040'O
         4 004627   000274 000007 2                  ADSC9   Z_ACCT+65                cn=0,n=7
         4 004630   201706 200037                    ADSC9   OPTION,,AUTO             cn=1,n=31

     1641    19526    4            OPTION.COUNT = 7;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:263  
  19526  4 004631   007000 236003                    LDQ     3584,DU
         4 004632   201706 552140                    STBQ    OPTION,'40'O,AUTO

     1642    19527    4            CALL ASB$GET_HEX_VAL ( 1, HEX, PTR$, OPTION ) ALTRET( END_OPTION );

  19527  4 004633   201706 634500                    EPPR4   OPTION,,AUTO
         4 004634   202345 454500                    STP4    YES_NO_FLG+5,,AUTO
         4 004635   202323 635500                    EPPR5   PTR$,,AUTO
         4 004636   202344 455500                    STP5    YES_NO_FLG+4,,AUTO
         4 004637   201576 636500                    EPPR6   HEX,,AUTO
         4 004640   202343 456500                    STP6    YES_NO_FLG+3,,AUTO
         4 004641   000002 236000 5                  LDQ     2
         4 004642   202342 756100                    STQ     YES_NO_FLG+2,,AUTO
         4 004643   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 004644   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 004645   000000 701000 xent               TSX1    ASB$GET_HEX_VAL
         4 004646   005343 702000 4                  TSX2    END_OPTION

     1643    19528    4            SPLIT.T = HEX(1);

  19528  4 004647   201576 236100                    LDQ     HEX,,AUTO
         4 004650   000011 736000                    QLS     9
         4 004651   202327 676100                    ERQ     SPLIT,,AUTO
         4 004652   377000 376003                    ANQ     130560,DU
         4 004653   202327 656100                    ERSQ    SPLIT,,AUTO

     1644    19529    4            SPLIT.B = HEX(2);

  19529  4 004654   201576 236100                    LDQ     HEX,,AUTO
         4 004655   000011 736000                    QLS     9
         4 004656   202327 676100                    ERQ     SPLIT,,AUTO
         4 004657   000377 376003                    ANQ     255,DU
         4 004660   202327 656100                    ERSQ    SPLIT,,AUTO

     1645    19530    4            KL$DADR.DEVCTL = SPLIT;

  19530  4 004661   200013 470500                    LDP0    @DADR$,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:264  
         4 004662   000000 471500                    LDP1    0,,PR0
         4 004663   003100 060500                    CSL     bolr='003'O
         4 004664   202327 000022                    BDSC    SPLIT,,AUTO              by=0,bit=0,n=18
         4 004665   100000 400022                    BDSC    0,,PR1                   by=2,bit=0,n=18

     1646    19531    4            DEVCTL_SET = %YES#;

  19531  4 004666   400000 236003                    LDQ     -131072,DU
         4 004667   200046 756100                    STQ     DEVCTL_SET,,AUTO
         4 004670   005343 710000 4                  TRA     END_OPTION

     1647    19532
     1648    19533    4            SELECT ( %DEV_MODE_VAL ) ;

     1649    19534    5            IF NOT (DEV_USE = 47 /* RESOURCE */ OR TYPE = 'CL') THEN DO;

  19534  4 004671   200050 235100                    LDA     DEV_USE,,AUTO
         4 004672   000057 115007                    CMPA    47,DL
         4 004673   004704 600000 4                  TZE     s:19557
         4 004674   000000 221000 3                  LDX1    TYPE
         4 004675   000176 101000 2                  CMPX1   Z_ACCT+3
         4 004676   004704 600000 4                  TZE     s:19557

     1650    19535        /*E*  ERROR:  ASA-E$MODE_NOTLEGAL-0
     1651    19536             MESSAGE:  The MODE option is not legal here.
     1652    19537             MESSAGE1:  Mode is legal only for a resource CL device.
     1653    19538        */
     1654    19539                    %SCREAM (ERR#=%E$MODE_NOTLEGAL,LEVEL=ERROR,MID='A');

  19551  4 004677   000103 630400 5                  EPPR0   67
         4 004700   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004701   000000 701000 xent               TSX1    ASH$ERROR
         4 004702   000000 011000                    NOP     0

     1655    19554    5               GOTO END_OPTION;

  19554  4 004703   005343 710000 4                  TRA     END_OPTION
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:265  

     1656    19555    5               END; /* Not res device, type cl  */
     1657    19556
     1658    19557    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  19557  4 004704   100003 236100                    LDQ     3,,PR1
         4 004705   200015 756100                    STQ     BLK$,,AUTO

     1659    19558    4            KL$TREC.RES_DEV.MODE = BLK$ -> P$NODE.CODE;

  19558  4 004706   200003 473500                    LDP3    @TREC$,,AUTO
         4 004707   300000 474500                    LDP4    0,,PR3
         4 004710   200015 475500                    LDP5    BLK$,,AUTO
         4 004711   500000 236100                    LDQ     0,,PR5
         4 004712   000033 736000                    QLS     27
         4 004713   400132 552140                    STBQ    90,'40'O,PR4
         4 004714   005343 710000 4                  TRA     END_OPTION

     1660    19559
     1661    19560    4            SELECT ( %DEV_RNAME_VAL ) ;

     1662    19561    5            IF NOT (DEV_USE = 47 /* RESOURCE */ AND TYPE = 'CL') THEN DO;

  19561  4 004715   200050 235100                    LDA     DEV_USE,,AUTO
         4 004716   000057 115007                    CMPA    47,DL
         4 004717   004723 601000 4                  TNZ     s:19578
         4 004720   000000 221000 3                  LDX1    TYPE
         4 004721   000176 101000 2                  CMPX1   Z_ACCT+3
         4 004722   004730 600000 4                  TZE     s:19584

     1663    19562        /*E*  ERROR:  ASA-E$RNAME_NOTLEGAL-0
     1664    19563             MESSAGE:  The RNAME option is not legal here.
     1665    19564             MESSAGE1:  Rname is legal only for a resource CL device.
     1666    19565        */
     1667    19566                    %SCREAM (ERR#=%E$RNAME_NOTLEGAL,LEVEL=ERROR,MID='A');

  19578  4 004723   000104 630400 5                  EPPR0   68
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:266  
         4 004724   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004725   000000 701000 xent               TSX1    ASH$ERROR
         4 004726   000000 011000                    NOP     0

     1668    19581    5               GOTO END_OPTION;

  19581  4 004727   005343 710000 4                  TRA     END_OPTION

     1669    19582    5               END; /*  Not res device, type cl  */
     1670    19583
     1671    19584    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  19584  4 004730   100003 236100                    LDQ     3,,PR1
         4 004731   200015 756100                    STQ     BLK$,,AUTO

     1672    19585    4            KL$TREC.RES_DEV.RNAME = OUT$SYM.TEXT ;

  19585  4 004732   200003 473500                    LDP3    @TREC$,,AUTO
         4 004733   300000 474500                    LDP4    0,,PR3
         4 004734   200015 475500                    LDP5    BLK$,,AUTO
         4 004735   500004 236100                    LDQ     4,,PR5
         4 004736   000033 772000                    QRL     27
         4 004737   000000 622006                    EAX2    0,QL
         4 004740   040100 100540                    MLR     fill='040'O
         4 004741   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         4 004742   400132 600006                    ADSC9   90,,PR4                  cn=3,n=6
         4 004743   005343 710000 4                  TRA     END_OPTION

     1673    19586
     1674    19587    4            SELECT ( %DEV_AUACCOUNT_VAL ) ;

     1675    19588    5            IF NOT (DEV_USE = 47 /* RESOURCE */ AND TYPE = 'CL') THEN DO;

  19588  4 004744   200050 235100                    LDA     DEV_USE,,AUTO
         4 004745   000057 115007                    CMPA    47,DL
         4 004746   004752 601000 4                  TNZ     s:19605
         4 004747   000000 221000 3                  LDX1    TYPE
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:267  
         4 004750   000176 101000 2                  CMPX1   Z_ACCT+3
         4 004751   004757 600000 4                  TZE     s:19611

     1676    19589        /*E*  ERROR:  ASA-E$AUACCT_NOTLEGAL-0
     1677    19590             MESSAGE:  The AUACCT option is not legal here.
     1678    19591             MESSAGE1:  Auacct is legal only for a resource CL device.
     1679    19592        */
     1680    19593                    %SCREAM (ERR#=%E$AUACCT_NOTLEGAL,LEVEL=ERROR,MID='A');

  19605  4 004752   000105 630400 5                  EPPR0   69
         4 004753   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004754   000000 701000 xent               TSX1    ASH$ERROR
         4 004755   000000 011000                    NOP     0

     1681    19608    5               GOTO END_OPTION;

  19608  4 004756   005343 710000 4                  TRA     END_OPTION

     1682    19609    5               END; /*  Not res device, type cl  */
     1683    19610
     1684    19611    4            BLK$ = PTR$ ->P$NODE.SUBLK$(0);

  19611  4 004757   100003 236100                    LDQ     3,,PR1
         4 004760   200015 756100                    STQ     BLK$,,AUTO

     1685    19612    4            KL$TREC.RES_DEV.AUACCOUNT = OUT$SYM.TEXT ;

  19612  4 004761   200003 473500                    LDP3    @TREC$,,AUTO
         4 004762   300000 474500                    LDP4    0,,PR3
         4 004763   200015 475500                    LDP5    BLK$,,AUTO
         4 004764   500004 236100                    LDQ     4,,PR5
         4 004765   000033 772000                    QRL     27
         4 004766   000000 622006                    EAX2    0,QL
         4 004767   040100 100540                    MLR     fill='040'O
         4 004770   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         4 004771   400134 200010                    ADSC9   92,,PR4                  cn=1,n=8
         4 004772   005343 710000 4                  TRA     END_OPTION
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:268  

     1686    19613
     1687    19614    4            SELECT ( %DEV_ATTR_VAL ) ;

     1688    19615    5            IF NOT (DEV_USE = 47 /* RESOURCE */ AND TYPE = 'CL') THEN DO;

  19615  4 004773   200050 235100                    LDA     DEV_USE,,AUTO
         4 004774   000057 115007                    CMPA    47,DL
         4 004775   005001 601000 4                  TNZ     s:19632
         4 004776   000000 221000 3                  LDX1    TYPE
         4 004777   000176 101000 2                  CMPX1   Z_ACCT+3
         4 005000   005006 600000 4                  TZE     s:19638

     1689    19616        /*E*  ERROR:  ASA-E$ATTR_NOTLEGAL-0
     1690    19617             MESSAGE:  The %U1 option is not legal here.
     1691    19618             MESSAGE1:  %U1 is legal only for a resource CL device.
     1692    19619        */
     1693    19620                    %SCREAM (ERR#=%E$ATTR_NOTLEGAL,LEVEL=ERROR,MID='A');

  19632  4 005001   000106 630400 5                  EPPR0   70
         4 005002   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005003   000000 701000 xent               TSX1    ASH$ERROR
         4 005004   000000 011000                    NOP     0

     1694    19635    5               GOTO END_OPTION;

  19635  4 005005   005343 710000 4                  TRA     END_OPTION

     1695    19636    5               END; /*  Not res device, type cl  */
     1696    19637
     1697    19638    4            PTR$ = PTR$ -> P$NODE.SUBLK$(0) ;

  19638  4 005006   100003 236100                    LDQ     3,,PR1
         4 005007   202323 756100                    STQ     PTR$,,AUTO

     1698    19639    4            CODE = PTR$ -> P$NODE.CODE ;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:269  
  19639  4 005010   202323 471500                    LDP1    PTR$,,AUTO
         4 005011   100000 236100                    LDQ     0,,PR1
         4 005012   777777 376007                    ANQ     -1,DL
         4 005013   000000 756000 xsym               STQ     CODE

     1699    19640    4            IF PTR$ -> P$NODE.SUBNODES = 0 THEN

  19640  4 005014   100001 222100                    LDX2    1,,PR1
         4 005015   005021 601000 4                  TNZ     s:19643

     1700    19641    4               YES_NO_FLG = %YES#;

  19641  4 005016   400000 236003                    LDQ     -131072,DU
         4 005017   202340 756100                    STQ     YES_NO_FLG,,AUTO
         4 005020   005033 710000 4                  TRA     s:19649

     1701    19642    5            ELSE DO;

     1702    19643    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  19643  4 005021   100003 236100                    LDQ     3,,PR1
         4 005022   200015 756100                    STQ     BLK$,,AUTO

     1703    19644    5               IF BLK$ -> P$NODE.CODE = 1   /*  YES_VAL  */ THEN

  19644  4 005023   200015 473500                    LDP3    BLK$,,AUTO
         4 005024   300000 723100                    LXL3    0,,PR3
         4 005025   000001 103003                    CMPX3   1,DU
         4 005026   005032 601000 4                  TNZ     s:19647

     1704    19645    5                  YES_NO_FLG = %YES#;

  19645  4 005027   400000 236003                    LDQ     -131072,DU
         4 005030   202340 756100                    STQ     YES_NO_FLG,,AUTO
         4 005031   005033 710000 4                  TRA     s:19649

     1705    19646    5               ELSE
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:270  
     1706    19647    5                  YES_NO_FLG = %NO#;

  19647  4 005032   202340 450100                    STZ     YES_NO_FLG,,AUTO

     1707    19648    5               END;                     /*Else do*/

     1708    19649    5            DO SELECT ( CODE ) ;

  19649  4 005033   000000 236000 xsym               LDQ     CODE
         4 005034   000107 116007                    CMPQ    71,DL
         4 005035   005075 602000 4                  TNC     s:19649+34
         4 005036   005214 600000 4                  TZE     s:19681
         4 005037   000113 116007                    CMPQ    75,DL
         4 005040   005064 602000 4                  TNC     s:19649+25
         4 005041   005254 600000 4                  TZE     s:19697
         4 005042   000117 116007                    CMPQ    79,DL
         4 005043   005053 602000 4                  TNC     s:19649+16
         4 005044   005314 600000 4                  TZE     s:19713
         4 005045   000120 116007                    CMPQ    80,DL
         4 005046   005343 602000 4                  TNC     END_OPTION
         4 005047   005324 600000 4                  TZE     s:19717
         4 005050   000121 116007                    CMPQ    81,DL
         4 005051   005343 601000 4                  TNZ     END_OPTION
         4 005052   005334 710000 4                  TRA     s:19721
         4 005053   000115 116007                    CMPQ    77,DL
         4 005054   005061 602000 4                  TNC     s:19649+22
         4 005055   005274 600000 4                  TZE     s:19705
         4 005056   000116 116007                    CMPQ    78,DL
         4 005057   005343 601000 4                  TNZ     END_OPTION
         4 005060   005304 710000 4                  TRA     s:19709
         4 005061   000114 116007                    CMPQ    76,DL
         4 005062   005343 601000 4                  TNZ     END_OPTION
         4 005063   005264 710000 4                  TRA     s:19701
         4 005064   000111 116007                    CMPQ    73,DL
         4 005065   005072 602000 4                  TNC     s:19649+31
         4 005066   005234 600000 4                  TZE     s:19689
         4 005067   000112 116007                    CMPQ    74,DL
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:271  
         4 005070   005343 601000 4                  TNZ     END_OPTION
         4 005071   005244 710000 4                  TRA     s:19693
         4 005072   000110 116007                    CMPQ    72,DL
         4 005073   005343 601000 4                  TNZ     END_OPTION
         4 005074   005224 710000 4                  TRA     s:19685
         4 005075   000103 116007                    CMPQ    67,DL
         4 005076   005112 602000 4                  TNC     s:19649+47
         4 005077   005154 600000 4                  TZE     s:19665
         4 005100   000105 116007                    CMPQ    69,DL
         4 005101   005106 602000 4                  TNC     s:19649+43
         4 005102   005174 600000 4                  TZE     s:19673
         4 005103   000106 116007                    CMPQ    70,DL
         4 005104   005343 601000 4                  TNZ     END_OPTION
         4 005105   005204 710000 4                  TRA     s:19677
         4 005106   000000 235000 xsym               LDA     CODE
         4 005107   000104 115007                    CMPA    68,DL
         4 005110   005343 601000 4                  TNZ     END_OPTION
         4 005111   005164 710000 4                  TRA     s:19669
         4 005112   000000 236000 xsym               LDQ     CODE
         4 005113   000101 116007                    CMPQ    65,DL
         4 005114   005121 602000 4                  TNC     s:19649+54
         4 005115   005134 600000 4                  TZE     s:19657
         4 005116   000102 116007                    CMPQ    66,DL
         4 005117   005343 601000 4                  TNZ     END_OPTION
         4 005120   005144 710000 4                  TRA     s:19661
         4 005121   000100 116007                    CMPQ    64,DL
         4 005122   005343 601000 4                  TNZ     END_OPTION
         4 005123   005124 710000 4                  TRA     s:19653

     1709    19650
     1710    19651    5               SELECT (%DEV_B300_VAL);

     1711    19652
     1712    19653    5               KL$TREC.RES_DEV.ATTR.B300# = YES_NO_FLG;

  19653  4 005124   200003 470500                    LDP0    @TREC$,,AUTO
         4 005125   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:272  
         4 005126   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005127   000011 772000                    QRL     9
         4 005130   100132 676100                    ERQ     90,,PR1
         4 005131   000400 376003                    ANQ     256,DU
         4 005132   100132 656100                    ERSQ    90,,PR1
         4 005133   005343 710000 4                  TRA     END_OPTION

     1713    19654
     1714    19655    5               SELECT (%DEV_B1200_VAL);

     1715    19656
     1716    19657    5               KL$TREC.RES_DEV.ATTR.B1200# = YES_NO_FLG;

  19657  4 005134   200003 470500                    LDP0    @TREC$,,AUTO
         4 005135   000000 471500                    LDP1    0,,PR0
         4 005136   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005137   000012 772000                    QRL     10
         4 005140   100132 676100                    ERQ     90,,PR1
         4 005141   000200 376003                    ANQ     128,DU
         4 005142   100132 656100                    ERSQ    90,,PR1
         4 005143   005343 710000 4                  TRA     END_OPTION

     1717    19658
     1718    19659    5               SELECT (%DEV_B2400_VAL);

     1719    19660
     1720    19661    5               KL$TREC.RES_DEV.ATTR.B2400# = YES_NO_FLG;

  19661  4 005144   200003 470500                    LDP0    @TREC$,,AUTO
         4 005145   000000 471500                    LDP1    0,,PR0
         4 005146   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005147   000013 772000                    QRL     11
         4 005150   100132 676100                    ERQ     90,,PR1
         4 005151   000100 376003                    ANQ     64,DU
         4 005152   100132 656100                    ERSQ    90,,PR1
         4 005153   005343 710000 4                  TRA     END_OPTION

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:273  
     1721    19662
     1722    19663    5               SELECT (%DEV_HAYES_VAL);

     1723    19664
     1724    19665    5               KL$TREC.RES_DEV.ATTR.HAYES# = YES_NO_FLG;

  19665  4 005154   200003 470500                    LDP0    @TREC$,,AUTO
         4 005155   000000 471500                    LDP1    0,,PR0
         4 005156   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005157   000014 772000                    QRL     12
         4 005160   100132 676100                    ERQ     90,,PR1
         4 005161   000040 376003                    ANQ     32,DU
         4 005162   100132 656100                    ERSQ    90,,PR1
         4 005163   005343 710000 4                  TRA     END_OPTION

     1725    19666
     1726    19667    5               SELECT (%DEV_X28_VAL);

     1727    19668
     1728    19669    5               KL$TREC.RES_DEV.ATTR.X28# = YES_NO_FLG;

  19669  4 005164   200003 470500                    LDP0    @TREC$,,AUTO
         4 005165   000000 471500                    LDP1    0,,PR0
         4 005166   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005167   000015 772000                    QRL     13
         4 005170   100132 676100                    ERQ     90,,PR1
         4 005171   000020 376003                    ANQ     16,DU
         4 005172   100132 656100                    ERSQ    90,,PR1
         4 005173   005343 710000 4                  TRA     END_OPTION

     1729    19670
     1730    19671    5               SELECT (%DEV_RFU1_VAL);

     1731    19672
     1732    19673    5               KL$TREC.RES_DEV.ATTR.RFU1# = YES_NO_FLG;

  19673  4 005174   200003 470500                    LDP0    @TREC$,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:274  
         4 005175   000000 471500                    LDP1    0,,PR0
         4 005176   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005177   000032 772000                    QRL     26
         4 005200   100132 676100                    ERQ     90,,PR1
         4 005201   001000 376007                    ANQ     512,DL
         4 005202   100132 656100                    ERSQ    90,,PR1
         4 005203   005343 710000 4                  TRA     END_OPTION

     1733    19674
     1734    19675    5               SELECT (%DEV_RFU2_VAL);

     1735    19676
     1736    19677    5               KL$TREC.RES_DEV.ATTR.RFU2# = YES_NO_FLG;

  19677  4 005204   200003 470500                    LDP0    @TREC$,,AUTO
         4 005205   000000 471500                    LDP1    0,,PR0
         4 005206   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005207   000031 772000                    QRL     25
         4 005210   100132 676100                    ERQ     90,,PR1
         4 005211   002000 376007                    ANQ     1024,DL
         4 005212   100132 656100                    ERSQ    90,,PR1
         4 005213   005343 710000 4                  TRA     END_OPTION

     1737    19678
     1738    19679    5               SELECT (%DEV_RFU3_VAL);

     1739    19680
     1740    19681    5               KL$TREC.RES_DEV.ATTR.RFU3# = YES_NO_FLG;

  19681  4 005214   200003 473500                    LDP3    @TREC$,,AUTO
         4 005215   300000 474500                    LDP4    0,,PR3
         4 005216   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005217   000030 772000                    QRL     24
         4 005220   400132 676100                    ERQ     90,,PR4
         4 005221   004000 376007                    ANQ     2048,DL
         4 005222   400132 656100                    ERSQ    90,,PR4
         4 005223   005343 710000 4                  TRA     END_OPTION
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:275  

     1741    19682
     1742    19683    5               SELECT (%DEV_RFU4_VAL);

     1743    19684
     1744    19685    5               KL$TREC.RES_DEV.ATTR.RFU4# = YES_NO_FLG;

  19685  4 005224   200003 473500                    LDP3    @TREC$,,AUTO
         4 005225   300000 474500                    LDP4    0,,PR3
         4 005226   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005227   000027 772000                    QRL     23
         4 005230   400132 676100                    ERQ     90,,PR4
         4 005231   010000 376007                    ANQ     4096,DL
         4 005232   400132 656100                    ERSQ    90,,PR4
         4 005233   005343 710000 4                  TRA     END_OPTION

     1745    19686
     1746    19687    5               SELECT (%DEV_RFU5_VAL);

     1747    19688
     1748    19689    5               KL$TREC.RES_DEV.ATTR.RFU5# = YES_NO_FLG;

  19689  4 005234   200003 473500                    LDP3    @TREC$,,AUTO
         4 005235   300000 474500                    LDP4    0,,PR3
         4 005236   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005237   000026 772000                    QRL     22
         4 005240   400132 676100                    ERQ     90,,PR4
         4 005241   020000 376007                    ANQ     8192,DL
         4 005242   400132 656100                    ERSQ    90,,PR4
         4 005243   005343 710000 4                  TRA     END_OPTION

     1749    19690
     1750    19691    5               SELECT (%DEV_RFU6_VAL);

     1751    19692
     1752    19693    5               KL$TREC.RES_DEV.ATTR.RFU6# = YES_NO_FLG;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:276  
  19693  4 005244   200003 473500                    LDP3    @TREC$,,AUTO
         4 005245   300000 474500                    LDP4    0,,PR3
         4 005246   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005247   000025 772000                    QRL     21
         4 005250   400132 676100                    ERQ     90,,PR4
         4 005251   040000 376007                    ANQ     16384,DL
         4 005252   400132 656100                    ERSQ    90,,PR4
         4 005253   005343 710000 4                  TRA     END_OPTION

     1753    19694
     1754    19695    5               SELECT (%DEV_RFU7_VAL);

     1755    19696
     1756    19697    5               KL$TREC.RES_DEV.ATTR.RFU7# = YES_NO_FLG;

  19697  4 005254   200003 473500                    LDP3    @TREC$,,AUTO
         4 005255   300000 474500                    LDP4    0,,PR3
         4 005256   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005257   000024 772000                    QRL     20
         4 005260   400132 676100                    ERQ     90,,PR4
         4 005261   100000 376007                    ANQ     32768,DL
         4 005262   400132 656100                    ERSQ    90,,PR4
         4 005263   005343 710000 4                  TRA     END_OPTION

     1757    19698
     1758    19699    5               SELECT (%DEV_RFU8_VAL);

     1759    19700
     1760    19701    5               KL$TREC.RES_DEV.ATTR.RFU8# = YES_NO_FLG;

  19701  4 005264   200003 473500                    LDP3    @TREC$,,AUTO
         4 005265   300000 474500                    LDP4    0,,PR3
         4 005266   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005267   000023 772000                    QRL     19
         4 005270   400132 676100                    ERQ     90,,PR4
         4 005271   200000 376007                    ANQ     65536,DL
         4 005272   400132 656100                    ERSQ    90,,PR4
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:277  
         4 005273   005343 710000 4                  TRA     END_OPTION

     1761    19702
     1762    19703    5               SELECT (%DEV_RFU9_VAL);

     1763    19704
     1764    19705    5               KL$TREC.RES_DEV.ATTR.RFU9# = YES_NO_FLG;

  19705  4 005274   200003 473500                    LDP3    @TREC$,,AUTO
         4 005275   300000 474500                    LDP4    0,,PR3
         4 005276   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005277   000022 772000                    QRL     18
         4 005300   400132 676100                    ERQ     90,,PR4
         4 005301   400000 376007                    ANQ     -131072,DL
         4 005302   400132 656100                    ERSQ    90,,PR4
         4 005303   005343 710000 4                  TRA     END_OPTION

     1765    19706
     1766    19707    5               SELECT (%DEV_RFU10_VAL);

     1767    19708
     1768    19709    5               KL$TREC.RES_DEV.ATTR.RFU10# = YES_NO_FLG;

  19709  4 005304   200003 473500                    LDP3    @TREC$,,AUTO
         4 005305   300000 474500                    LDP4    0,,PR3
         4 005306   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005307   000021 772000                    QRL     17
         4 005310   400132 676100                    ERQ     90,,PR4
         4 005311   000001 376003                    ANQ     1,DU
         4 005312   400132 656100                    ERSQ    90,,PR4
         4 005313   005343 710000 4                  TRA     END_OPTION

     1769    19710
     1770    19711    5               SELECT (%DEV_RFU11_VAL);

     1771    19712
     1772    19713    5               KL$TREC.RES_DEV.ATTR.RFU11# = YES_NO_FLG;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:278  

  19713  4 005314   200003 473500                    LDP3    @TREC$,,AUTO
         4 005315   300000 474500                    LDP4    0,,PR3
         4 005316   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005317   000020 772000                    QRL     16
         4 005320   400132 676100                    ERQ     90,,PR4
         4 005321   000002 376003                    ANQ     2,DU
         4 005322   400132 656100                    ERSQ    90,,PR4
         4 005323   005343 710000 4                  TRA     END_OPTION

     1773    19714
     1774    19715    5               SELECT (%DEV_TCPIP_VAL);

     1775    19716
     1776    19717    5               KL$TREC.RES_DEV.ATTR.TCPIP# = YES_NO_FLG;

  19717  4 005324   200003 473500                    LDP3    @TREC$,,AUTO
         4 005325   300000 474500                    LDP4    0,,PR3
         4 005326   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005327   000017 772000                    QRL     15
         4 005330   400132 676100                    ERQ     90,,PR4
         4 005331   000004 376003                    ANQ     4,DU
         4 005332   400132 656100                    ERSQ    90,,PR4
         4 005333   005343 710000 4                  TRA     END_OPTION

     1777    19718
     1778    19719    5               SELECT (%DEV_RFU13_VAL);

     1779    19720
     1780    19721    5               KL$TREC.RES_DEV.ATTR.RFU13# = YES_NO_FLG;

  19721  4 005334   200003 473500                    LDP3    @TREC$,,AUTO
         4 005335   300000 474500                    LDP4    0,,PR3
         4 005336   202340 236100                    LDQ     YES_NO_FLG,,AUTO
         4 005337   000016 772000                    QRL     14
         4 005340   400132 676100                    ERQ     90,,PR4
         4 005341   000010 376003                    ANQ     8,DU
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:279  
         4 005342   400132 656100                    ERSQ    90,,PR4

     1781    19722
     1782    19723    5               END;                     /*Do case code  */

     1783    19724    4            END;                     /*Do case*/

  19721  4 005343                       END_OPTION   null
     1784    19725    3   END_OPTION: ;
     1785    19726    3         END;                      /* Do i                               */

  19726  4 005343   201676 235100                    LDA     I,,AUTO
         4 005344   000001 035007                    ADLA    1,DL
         4 005345   201676 755100                    STA     I,,AUTO
         4 005346   000000 470400 xsym               LDP0    NODE$
         4 005347   000001 236100                    LDQ     1,,PR0
         4 005350   000022 772000                    QRL     18
         4 005351   201676 116100                    CMPQ    I,,AUTO
         4 005352   005354 600000 4                  TZE     s:19727
         4 005353   000524 603000 4                  TRC     s:18190

     1786    19727    2      END DEV_LOOP ;               /* Do while                           */

  19727  4 005354   201704 234100                    SZN     MORE,,AUTO
         4 005355   000474 604000 4                  TMI     s:18180

     1787    19728
     1788    19729    1   KL$TWSNREC.DEVS.PNAME(TWSN_INDEX) = KL$TREC.PNAME;
             19729            /* Put profile into twsn record */

  19729  4 005356   200004 470500                    LDP0    @TWSNR$,,AUTO
         4 005357   000000 471500                    LDP1    0,,PR0
         4 005360   200011 473500                    LDP3    @TWSN_INDEX,,AUTO
         4 005361   300000 236100                    LDQ     0,,PR3
         4 005362   000013 402007                    MPY     11,DL
         4 005363   200003 474500                    LDP4    @TREC$,,AUTO
         4 005364   400000 475500                    LDP5    0,,PR4
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:280  
         4 005365   000002 736000                    QLS     2
         4 005366   000106 100500                    MLR     fill='000'O
         4 005367   500004 000014                    ADSC9   4,,PR5                   cn=0,n=12
         4 005370   100015 000014                    ADSC9   13,Q,PR1                 cn=0,n=12

     1789    19730
     1790    19731    1   IF TYPE = AS_BLANK OR DEV_USE = 0 THEN

  19731  4 005371   040000 106400                    CMPC    fill='040'O
         4 005372   000000 000002 3                  ADSC9   TYPE                     cn=0,n=2
         4 005373   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 005374   005377 600000 4                  TZE     s:19750
         4 005375   200050 235100                    LDA     DEV_USE,,AUTO
         4 005376   005407 601000 4                  TNZ     s:19756

     1791    19732    2   DO ;

     1792    19733        /*E* ERROR: ASA-E$DEVMIN-0
     1793    19734             MESSAGE: Required parameters missing.
     1794    19735             MESSAGE1: You must specify USE and TYPE.
     1795    19736             MESSAGE2: Device not created.
     1796    19737        */
     1797    19738           %SCREAM( ERR#=E$DEVMIN, LEVEL=ERROR, MID='A' );

  19750  4 005377   000107 630400 5                  EPPR0   71
         4 005400   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005401   000000 701000 xent               TSX1    ASH$ERROR
         4 005402   000000 011000                    NOP     0

     1798    19753    2      MORE=AS_TRUE;

  19753  4 005403   000000 236000 xsym               LDQ     AS_TRUE
         4 005404   400000 376003                    ANQ     -131072,DU
         4 005405   201704 756100                    STQ     MORE,,AUTO

     1799    19754    2      ALTRETURN;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:281  
  19754  4 005406   000000 702200 xent               TSX2  ! X66_AALT

     1800    19755    2      END;
     1801    19756    1   IF SUB AND (TYPE='CG') AND (NOT PRO_FLAG) THEN

  19756  4 005407   200007 471500                    LDP1    @SUB,,AUTO
         4 005410   100000 234100                    SZN     0,,PR1
         4 005411   005427 605000 4                  TPL     s:19781
         4 005412   000000 220000 3                  LDX0    TYPE
         4 005413   000175 100000 2                  CMPX0   Z_ACCT+2
         4 005414   005427 601000 4                  TNZ     s:19781
         4 005415   202322 234100                    SZN     PRO_FLAG,,AUTO
         4 005416   005427 604000 4                  TMI     s:19781

     1802    19757    2   DO ;

     1803    19758        /*E*  ERROR: ASA-E$NOPROFILE
     1804    19759              MESSAGE:  A PROFILE must be specified for this TERMINAL DEVICE.
     1805    19760              MESSAGE1: There is no default PROFILE for this TERMINAL DEVICE.
     1806    19761              MESSAGE2: Device not created.
     1807    19762        */
     1808    19763           %SCREAM( ERR#=E$NOPROFILE, LEVEL=ERROR, MID='A' );

  19775  4 005417   000110 630400 5                  EPPR0   72
         4 005420   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005421   000000 701000 xent               TSX1    ASH$ERROR
         4 005422   000000 011000                    NOP     0

     1809    19778    2      MORE=AS_TRUE ;

  19778  4 005423   000000 236000 xsym               LDQ     AS_TRUE
         4 005424   400000 376003                    ANQ     -131072,DU
         4 005425   201704 756100                    STQ     MORE,,AUTO

     1810    19779    2      ALTRETURN;

  19779  4 005426   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:282  

     1811    19780    2      END;
     1812    19781    1   IF TP_FLAG AND NOT INSTANCE_FLAG THEN

  19781  4 005427   202333 234100                    SZN     TP_FLAG,,AUTO
         4 005430   005443 605000 4                  TPL     s:19805
         4 005431   201677 234100                    SZN     INSTANCE_FLAG,,AUTO
         4 005432   005443 604000 4                  TMI     s:19805

     1813    19782    2   DO ;

     1814    19783        /*E*  ERROR:  ASA-E$NEEDINSTANCE-0
     1815    19784              MESSAGE:  You must specify INSTANCE if USE=TP
     1816    19785              MESSAGE1:  Device not created.
     1817    19786        */
     1818    19787           %SCREAM( ERR#=E$NEEDINSTANCE, LEVEL=ERROR, MID='A' );

  19799  4 005433   000111 630400 5                  EPPR0   73
         4 005434   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005435   000000 701000 xent               TSX1    ASH$ERROR
         4 005436   000000 011000                    NOP     0

     1819    19802    2      MORE=AS_TRUE ;

  19802  4 005437   000000 236000 xsym               LDQ     AS_TRUE
         4 005440   400000 376003                    ANQ     -131072,DU
         4 005441   201704 756100                    STQ     MORE,,AUTO

     1820    19803    2      ALTRETURN;

  19803  4 005442   000000 702200 xent               TSX2  ! X66_AALT

     1821    19804    2      END;
     1822    19805    1   IF CG_FLAG AND NOT GROUP_FLAG THEN

  19805  4 005443   200016 234100                    SZN     CG_FLAG,,AUTO
         4 005444   005457 605000 4                  TPL     s:19829
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:283  
         4 005445   201575 234100                    SZN     GROUP_FLAG,,AUTO
         4 005446   005457 604000 4                  TMI     s:19829

     1823    19806    2   DO;

     1824    19807        /*E*  ERROR:  ASA-E$NEEDCOMGROUP-0
     1825    19808              MESSAGE:  You must specify COMGROUP if USE=CG
     1826    19809              MESSAGE1:  Device not created.
     1827    19810        */
     1828    19811           %SCREAM( ERR#=E$NEEDCOMGROUP, LEVEL=ERROR, MID='A' );

  19823  4 005447   000112 630400 5                  EPPR0   74
         4 005450   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005451   000000 701000 xent               TSX1    ASH$ERROR
         4 005452   000000 011000                    NOP     0

     1829    19826    2      MORE=AS_TRUE ;

  19826  4 005453   000000 236000 xsym               LDQ     AS_TRUE
         4 005454   400000 376003                    ANQ     -131072,DU
         4 005455   201704 756100                    STQ     MORE,,AUTO

     1830    19827    2      ALTRETURN;

  19827  4 005456   000000 702200 xent               TSX2  ! X66_AALT

     1831    19828    2      END;
     1832    19829    2   IF SUB AND KL$TREC.PNAME.TXT ~= ' ' THEN DO;

  19829  4 005457   100000 234100                    SZN     0,,PR1
         4 005460   005553 605000 4                  TPL     s:19882
         4 005461   400000 475500                    LDP5    0,,PR4
         4 005462   040000 106500                    CMPC    fill='040'O
         4 005463   500004 200013                    ADSC9   4,,PR5                   cn=1,n=11
         4 005464   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 005465   005553 600000 4                  TZE     s:19882

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:284  
     1833    19830    2      PRO$ = ADDR(PRO_BUF);

  19830  4 005466   201722 636500                    EPPR6   PRO_BUF,,AUTO
         4 005467   201721 456500                    STP6    PRO$,,AUTO

     1834    19831    2      ARS=LENGTHC(PRO_BUF);

  19831  4 005470   002000 236007                    LDQ     1024,DL
         4 005471   200014 756100                    STQ     ARS,,AUTO

     1835    19832    2      USERS_KEY.COUNT=KL$TREC.PNAME.CNT;

  19832  4 005472   400000 475500                    LDP5    0,,PR4
         4 005473   500004 236100                    LDQ     4,,PR5
         4 005474   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1836    19833    2      USERS_KEY.TXTC=KL$TREC.PNAME.TXT;

  19833  4 005475   400000 475500                    LDP5    0,,PR4
         4 005476   040000 100500                    MLR     fill='040'O
         4 005477   500004 200013                    ADSC9   4,,PR5                   cn=1,n=11
         4 005500   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

     1837    19834    2      CALL ASD$READ_PRO (USERS_KEY,KL$PHDR,ARS)

  19834  4 005501   200014 635500                    EPPR5   ARS,,AUTO
         4 005502   202344 455500                    STP5    YES_NO_FLG+4,,AUTO
         4 005503   201721 236100                    LDQ     PRO$,,AUTO
         4 005504   000007 235000 5                  LDA     7
         4 005505   202342 757100                    STAQ    YES_NO_FLG+2,,AUTO
         4 005506   202342 630500                    EPPR0   YES_NO_FLG+2,,AUTO
         4 005507   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 005510   000000 701000 xent               TSX1    ASD$READ_PRO
         4 005511   005513 702000 4                  TSX2    s:19852
         4 005512   005523 710000 4                  TRA     s:19858

     1838    19835    3      WHENALTRETURN DO;
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:285  

     1839    19836        /*E* ERROR: ASA-E$MUSTPRO-0
     1840    19837             MESSAGE: You must specify a profile name for this device
     1841    19838             MESSAGE1: Device not created.
     1842    19839        */
     1843    19840              %SCREAM( ERR#=E$MUSTPRO, LEVEL=ERROR, MID='A' );

  19852  4 005513   000113 630400 5                  EPPR0   75
         4 005514   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005515   000000 701000 xent               TSX1    ASH$ERROR
         4 005516   000000 011000                    NOP     0

     1844    19855    3         MORE=AS_TRUE;

  19855  4 005517   000000 236000 xsym               LDQ     AS_TRUE
         4 005520   400000 376003                    ANQ     -131072,DU
         4 005521   201704 756100                    STQ     MORE,,AUTO

     1845    19856    3         ALTRETURN;

  19856  4 005522   000000 702200 xent               TSX2  ! X66_AALT

     1846    19857    3         END; /*  Whenaltreturn  */
     1847    19858    3      IF KL$PHDR.TTYP ~= %KLTY_SDEV# THEN DO;

  19858  4 005523   201721 470500                    LDP0    PRO$,,AUTO
         4 005524   000100 101500                    MRL     fill='000'O
         4 005525   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 005526   202342 000004                    ADSC9   YES_NO_FLG+2,,AUTO       cn=0,n=4
         4 005527   202342 236100                    LDQ     YES_NO_FLG+2,,AUTO
         4 005530   000001 116007                    CMPQ    1,DL
         4 005531   005542 600000 4                  TZE     s:19877

     1848    19859              %SCREAM( ERR#=E$DEVPROTYPE, LEVEL=ERROR, MID='A' );

  19871  4 005532   000011 630400 5                  EPPR0   9
         4 005533   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:286  
         4 005534   000000 701000 xent               TSX1    ASH$ERROR
         4 005535   000000 011000                    NOP     0

     1849    19874    3         MORE=AS_TRUE;

  19874  4 005536   000000 236000 xsym               LDQ     AS_TRUE
         4 005537   400000 376003                    ANQ     -131072,DU
         4 005540   201704 756100                    STQ     MORE,,AUTO

     1850    19875    3         GOTO DEV_LOOP;

  19875  4 005541   000472 710000 4                  TRA     DEV_LOOP

     1851    19876    3         END;
     1852    19877    2      PATTR=KL$PHDR.ATTR;

  19877  4 005542   000100 100500                    MLR     fill='000'O
         4 005543   000001 000002                    ADSC9   1,,PR0                   cn=0,n=2
         4 005544   201720 000002                    ADSC9   PATTR,,AUTO              cn=0,n=2

     1853    19878    2      IO=KL$PHDR.IO;

  19878  4 005545   003100 060500                    CSL     bolr='003'O
         4 005546   000001 400002                    BDSC    1,,PR0                   by=2,bit=0,n=2
         4 005547   201700 000002                    BDSC    IO,,AUTO                 by=0,bit=0,n=2

     1854    19879    2      DDEV=KL$PHDR.DDEV;

  19879  4 005550   000100 100500                    MLR     fill='000'O
         4 005551   000001 600001                    ADSC9   1,,PR0                   cn=3,n=1
         4 005552   200045 000001                    ADSC9   DDEV,,AUTO               cn=0,n=1

     1855    19880    2      END;

     1856    19881                                                /* Restore P_PCB                      */
     1857    19882    1   P_PCB.WORK$ = WORK$ ;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:287  
  19882  4 005553   202337 236100                    LDQ     WORK$,,AUTO
         4 005554   000002 756000 xsym               STQ     P_PCB+2

     1858    19883    1   P_PCB.WKSZ = WKSZ ;

  19883  4 005555   202335 720100                    LXL0    WKSZ,,AUTO
         4 005556   000005 740000 xsym               STX0    P_PCB+5

     1859    19884    1   P_PCB.WK_USED = WK_USED ;

  19884  4 005557   202336 721100                    LXL1    WK_USED,,AUTO
         4 005560   000010 741000 xsym               STX1    P_PCB+8

     1860    19885    1   P_PCB.ROOT$ = ROOT$ ;

  19885  4 005561   202325 236100                    LDQ     ROOT$,,AUTO
         4 005562   000001 756000 xsym               STQ     P_PCB+1

     1861    19886                                                /* Restore NODE$                      */
     1862    19887    1   NODE$ = T_NODE$ ;

  19887  4 005563   202334 236100                    LDQ     T_NODE$,,AUTO
         4 005564   000000 756000 xsym               STQ     NODE$

     1863    19888                                                                                    /**/
     1864    19889    2   IF SUB OR TYPE ~= 'CG' THEN DO;       /* Build twsn record entry */

  19889  4 005565   200007 470500                    LDP0    @SUB,,AUTO
         4 005566   000000 234100                    SZN     0,,PR0
         4 005567   005573 604000 4                  TMI     s:19890
         4 005570   000000 222000 3                  LDX2    TYPE
         4 005571   000175 102000 2                  CMPX2   Z_ACCT+2
         4 005572   005721 600000 4                  TZE     s:19906

     1865    19890    2      KL$TWSNREC.DEVS.TYP(TWSN_INDEX)  = TYPE ;

  19890  4 005573   200004 471500                    LDP1    @TWSNR$,,AUTO
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:288  
         4 005574   100000 473500                    LDP3    0,,PR1
         4 005575   200011 474500                    LDP4    @TWSN_INDEX,,AUTO
         4 005576   400000 236100                    LDQ     0,,PR4
         4 005577   000013 402007                    MPY     11,DL
         4 005600   000000 222000 3                  LDX2    TYPE
         4 005601   300005 742106                    STX2    5,QL,PR3

     1866    19891    2      KL$TWSNREC.DEVS.NUM(TWSN_INDEX)  = NUM   ;

  19891  4 005602   100000 473500                    LDP3    0,,PR1
         4 005603   400000 236100                    LDQ     0,,PR4
         4 005604   000013 402007                    MPY     11,DL
         4 005605   201705 222100                    LDX2    NUM,,AUTO
         4 005606   300005 442106                    SXL2    5,QL,PR3

     1867    19892    2      KL$TWSNREC.DEVS.ATTR(TWSN_INDEX) = PATTR ;

  19892  4 005607   100000 473500                    LDP3    0,,PR1
         4 005610   400000 236100                    LDQ     0,,PR4
         4 005611   000013 402007                    MPY     11,DL
         4 005612   201720 222100                    LDX2    PATTR,,AUTO
         4 005613   300006 742106                    STX2    6,QL,PR3

     1868    19893    2      KL$TWSNREC.DEVS.IO(TWSN_INDEX)   = IO;

  19893  4 005614   100000 473500                    LDP3    0,,PR1
         4 005615   400000 236100                    LDQ     0,,PR4
         4 005616   000013 402007                    MPY     11,DL
         4 005617   000000 623006                    EAX3    0,QL
         4 005620   201700 236100                    LDQ     IO,,AUTO
         4 005621   000033 772000                    QRL     27
         4 005622   300006 676113                    ERQ     6,X3,PR3
         4 005623   000600 376007                    ANQ     384,DL
         4 005624   300006 656113                    ERSQ    6,X3,PR3

     1869    19894    2      KL$TWSNREC.DEVS.DDEV(TWSN_INDEX) = DDEV;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:289  
  19894  4 005625   100000 473500                    LDP3    0,,PR1
         4 005626   400000 236100                    LDQ     0,,PR4
         4 005627   000013 402007                    MPY     11,DL
         4 005630   000000 623006                    EAX3    0,QL
         4 005631   200045 236100                    LDQ     DDEV,,AUTO
         4 005632   000022 772000                    QRL     18
         4 005633   300006 676113                    ERQ     6,X3,PR3
         4 005634   777000 376007                    ANQ     -512,DL
         4 005635   300006 656113                    ERSQ    6,X3,PR3

     1870    19895    2      KL$TWSNREC.DEVS.ACCT(TWSN_INDEX) = FROM_KEY.TEXT ;

  19895  4 005636   100000 473500                    LDP3    0,,PR1
         4 005637   400000 236100                    LDQ     0,,PR4
         4 005640   000013 402007                    MPY     11,DL
         4 005641   000002 736000                    QLS     2
         4 005642   040106 100400                    MLR     fill='040'O
         4 005643   000000 200010 xsym               ADSC9   FROM_KEY                 cn=1,n=8
         4 005644   300011 000010                    ADSC9   9,Q,PR3                  cn=0,n=8

     1871    19896    2      KL$TWSNREC.DEVS.TDEV(TWSN_INDEX) = '0'B;

  19896  4 005645   100000 473500                    LDP3    0,,PR1
         4 005646   400000 236100                    LDQ     0,,PR4
         4 005647   000013 402007                    MPY     11,DL
         4 005650   000000 623006                    EAX3    0,QL
         4 005651   000114 236000 5                  LDQ     76
         4 005652   300006 356113                    ANSQ    6,X3,PR3

     1872    19897    2      IF SUB THEN

  19897  4 005653   000000 234100                    SZN     0,,PR0
         4 005654   005663 605000 4                  TPL     s:19899

     1873    19898    2         KL$TWSNREC.DEVS.TDEV(TWSN_INDEX) = '1'B;

  19898  4 005655   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:290  
         4 005656   400000 236100                    LDQ     0,,PR4
         4 005657   000013 402007                    MPY     11,DL
         4 005660   000000 623006                    EAX3    0,QL
         4 005661   000100 236007                    LDQ     64,DL
         4 005662   300006 256113                    ORSQ    6,X3,PR3

     1874    19899    2      IF KL$TREC.SUPER = 6 /* OUTSYM DEVICE */ THEN

  19899  4 005663   200003 473500                    LDP3    @TREC$,,AUTO
         4 005664   300000 475500                    LDP5    0,,PR3
         4 005665   500000 236100                    LDQ     0,,PR5
         4 005666   000777 376007                    ANQ     511,DL
         4 005667   000006 116007                    CMPQ    6,DL
         4 005670   005701 601000 4                  TNZ     s:19902

     1875    19900    2         KL$TWSNREC.DEVS.FNAME(TWSN_INDEX) = KL$TREC.OSINFO.FNAME;

  19900  4 005671   100000 476500                    LDP6    0,,PR1
         4 005672   400000 236100                    LDQ     0,,PR4
         4 005673   000013 402007                    MPY     11,DL
         4 005674   000002 736000                    QLS     2
         4 005675   040106 100500                    MLR     fill='040'O
         4 005676   500070 000006                    ADSC9   56,,PR5                  cn=0,n=6
         4 005677   600007 000006                    ADSC9   7,Q,PR6                  cn=0,n=6
         4 005700   005710 710000 4                  TRA     s:19903

     1876    19901    2      ELSE
     1877    19902    2         KL$TWSNREC.DEVS.FNAME(TWSN_INDEX) = ' ';

  19902  4 005701   100000 476500                    LDP6    0,,PR1
         4 005702   400000 236100                    LDQ     0,,PR4
         4 005703   000013 402007                    MPY     11,DL
         4 005704   000002 736000                    QLS     2
         4 005705   040106 100400                    MLR     fill='040'O
         4 005706   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 005707   600007 000006                    ADSC9   7,Q,PR6                  cn=0,n=6

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:291  
     1878    19903    2      KL$TWSNREC.DEVS.TERM(TWSN_INDEX) = ' ';

  19903  4 005710   100000 475500                    LDP5    0,,PR1
         4 005711   400000 236100                    LDQ     0,,PR4
         4 005712   000013 402007                    MPY     11,DL
         4 005713   000000 623006                    EAX3    0,QL
         4 005714   000000 624006                    EAX4    0,QL
         4 005715   000035 235000 xsym               LDA     B_VECTNIL+29
         4 005716   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 005717   500013 755113                    STA     11,X3,PR5
         4 005720   500014 756114                    STQ     12,X4,PR5

     1879    19904    2      END;

     1880    19905                                                  /* Build KL_TSS for terminal device */
     1881    19906    2   IF SUB THEN DO;

  19906  4 005721   000000 234100                    SZN     0,,PR0
         4 005722   005743 605000 4                  TPL     s:19912

     1882    19907    2      SS.SGN.PNAME = KL$TREC.PNAME.TXT;

  19907  4 005723   200003 471500                    LDP1    @TREC$,,AUTO
         4 005724   100000 473500                    LDP3    0,,PR1
         4 005725   200012 474500                    LDP4    @SS,,AUTO
         4 005726   040100 100500                    MLR     fill='040'O
         4 005727   300004 200013                    ADSC9   4,,PR3                   cn=1,n=11
         4 005730   400004 000013                    ADSC9   4,,PR4                   cn=0,n=11

     1883    19908    2      SS.SGN.TYPE = TYPE;

  19908  4 005731   040100 100400                    MLR     fill='040'O
         4 005732   000000 000002 3                  ADSC9   TYPE                     cn=0,n=2
         4 005733   400000 200002                    ADSC9   0,,PR4                   cn=1,n=2

     1884    19909    2      SS.SGN.NUM  = NUM;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:292  
  19909  4 005734   040100 100500                    MLR     fill='040'O
         4 005735   201705 000002                    ADSC9   NUM,,AUTO                cn=0,n=2
         4 005736   400000 600002                    ADSC9   0,,PR4                   cn=3,n=2

     1885    19910    2      SS.SGN.TWSN = TWSNC;

  19910  4 005737   200005 473500                    LDP3    @TWSNC,,AUTO
         4 005740   040100 100500                    MLR     fill='040'O
         4 005741   300000 000004                    ADSC9   0,,PR3                   cn=0,n=4
         4 005742   400001 200004                    ADSC9   1,,PR4                   cn=1,n=4

     1886    19911    2      END;

     1887    19912    1   KL$TREC.NWINFO = LENGTHW(KL$TREC.KC$CGID) ;

  19912  4 005743   200003 471500                    LDP1    @TREC$,,AUTO
         4 005744   100000 473500                    LDP3    0,,PR1
         4 005745   000014 235007                    LDA     12,DL
         4 005746   300017 755100                    STA     15,,PR3

     1888    19913    2   DO SELECT( DEV_USE );

  19913  4 005747   200050 236100                    LDQ     DEV_USE,,AUTO
         4 005750   000002 116007                    CMPQ    2,DL
         4 005751   005764 602000 4                  TNC     s:19913+13
         4 005752   005774 600000 4                  TZE     s:19918
         4 005753   000060 116007                    CMPQ    48,DL
         4 005754   005761 602000 4                  TNC     s:19913+10
         4 005755   006024 600000 4                  TZE     s:19930
         4 005756   000061 116007                    CMPQ    49,DL
         4 005757   006045 601000 4                  TNZ     s:19939
         4 005760   006035 710000 4                  TRA     s:19934
         4 005761   000057 116007                    CMPQ    47,DL
         4 005762   006045 601000 4                  TNZ     s:19939
         4 005763   006005 710000 4                  TRA     s:19922
         4 005764   000001 116007                    CMPQ    1,DL
         4 005765   006045 601000 4                  TNZ     s:19939
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:293  
         4 005766   005767 710000 4                  TRA     s:19915

     1889    19914    2      SELECT( 1   /*  YES_VAL  */ ) ;

     1890    19915    2      KL$TREC.NWINFO = KL$TREC.NWINFO+LENGTHW(KL$TREC.ISINFO);

  19915  4 005767   100000 473500                    LDP3    0,,PR1
         4 005770   300017 235100                    LDA     15,,PR3
         4 005771   000033 035007                    ADLA    27,DL
         4 005772   300017 755100                    STA     15,,PR3
         4 005773   006045 710000 4                  TRA     s:19939

     1891    19916
     1892    19917    2      SELECT( 2   /*  NO_VAL  */ ) ;

     1893    19918    2      KL$TREC.NWINFO = KL$TREC.NWINFO + LENGTHW(KL$TREC.OSINFO);

  19918  4 005774   100000 473500                    LDP3    0,,PR1
         4 005775   300017 235100                    LDA     15,,PR3
         4 005776   000005 035007                    ADLA    5,DL
         4 005777   300017 755100                    STA     15,,PR3

     1894    19919    2      OUT$DEV.OSINFO = KL$TREC.OSINFO;

  19919  4 006000   100000 473500                    LDP3    0,,PR1
         4 006001   000100 100500                    MLR     fill='000'O
         4 006002   300067 000024                    ADSC9   55,,PR3                  cn=0,n=20
         4 006003   300034 000024                    ADSC9   28,,PR3                  cn=0,n=20
         4 006004   006045 710000 4                  TRA     s:19939

     1895    19920
     1896    19921    2      SELECT( 47 /* RESOURCE */ ) ;

     1897    19922    3      IF DEV_USE = 47 /* RESOURCE */ AND SUBSTR (RES$DEV.RENAME,0,2) = 'CL' THEN DO;

  19922  4 006005   006021 601000 4                  TNZ     s:19927
         4 006006   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:294  
         4 006007   300011 222100                    LDX2    9,,PR3
         4 006010   000176 102000 2                  CMPX2   Z_ACCT+3
         4 006011   006021 601000 4                  TNZ     s:19927

     1898    19923    3         KL$TREC.NWINFO = LENGTHW (RES$DEV.RES_DEV);

  19923  4 006012   000005 235007                    LDA     5,DL
         4 006013   300017 755100                    STA     15,,PR3

     1899    19924    3         RES$DEV.RES_DEV = KL$TREC.RES_DEV;

  19924  4 006014   100000 473500                    LDP3    0,,PR1
         4 006015   000100 100500                    MLR     fill='000'O
         4 006016   300132 000021                    ADSC9   90,,PR3                  cn=0,n=17
         4 006017   300020 000021                    ADSC9   16,,PR3                  cn=0,n=17

     1900    19925    3         END;   /*  Res cl device  */

  19925  4 006020   006045 710000 4                  TRA     s:19939

     1901    19926    2      ELSE
     1902    19927    2         KL$TREC.NWINFO = 0;

  19927  4 006021   100000 473500                    LDP3    0,,PR1
         4 006022   300017 450100                    STZ     15,,PR3
         4 006023   006045 710000 4                  TRA     s:19939

     1903    19928
     1904    19929    2      SELECT( 48 /* TP */ );

     1905    19930    2      KL$TREC.NWINFO = KL$TREC.NWINFO + LENGTHW(KL$TREC.QQ_LOGON) ;

  19930  4 006024   100000 473500                    LDP3    0,,PR1
         4 006025   300017 235100                    LDA     15,,PR3
         4 006026   000036 035007                    ADLA    30,DL
         4 006027   300017 755100                    STA     15,,PR3

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:295  
     1906    19931    2      TP$DEV.QQ_LOGON = KL$TREC.QQ_LOGON;

  19931  4 006030   100000 473500                    LDP3    0,,PR1
         4 006031   000100 100500                    MLR     fill='000'O
         4 006032   300074 000170                    ADSC9   60,,PR3                  cn=0,n=120
         4 006033   300034 000170                    ADSC9   28,,PR3                  cn=0,n=120
         4 006034   006045 710000 4                  TRA     s:19939

     1907    19932
     1908    19933    2      SELECT( 49 /* COM GROUP  */ );

     1909    19934    2      KL$TREC.NWINFO = KL$TREC.NWINFO + LENGTHW(KL$TREC.B_CGAUINFO) ;

  19934  4 006035   100000 473500                    LDP3    0,,PR1
         4 006036   300017 235100                    LDA     15,,PR3
         4 006037   000031 035007                    ADLA    25,DL
         4 006040   300017 755100                    STA     15,,PR3

     1910    19935    2      CG$DEV.B_CGAUINFO = KL$TREC.B_CGAUINFO ;

  19935  4 006041   100000 473500                    LDP3    0,,PR1
         4 006042   000100 100500                    MLR     fill='000'O
         4 006043   300137 000144                    ADSC9   95,,PR3                  cn=0,n=100
         4 006044   300034 000144                    ADSC9   28,,PR3                  cn=0,n=100

     1911    19936
     1912    19937    2      END ;   /* Do case( DEV_USE ); */

     1913    19938
     1914    19939    1   IF CREATE THEN

  19939  4 006045   200006 473500                    LDP3    @CREATE,,AUTO
         4 006046   300000 234100                    SZN     0,,PR3
         4 006047   006136 605000 4                  TPL     s:19954

     1915    19940    2      IF SNAME_FLG THEN DO ;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:296  
  19940  4 006050   202326 234100                    SZN     SNAME_FLG,,AUTO
         4 006051   006076 605000 4                  TPL     s:19945

     1916    19941    2         CALL INDEX( I, AS_BLANK, KL$TREC.RENAME ) ;

  19941  4 006052   100000 474500                    LDP4    0,,PR1
         4 006053   000000 124500                    SCM     mask='000'O
         4 006054   400011 000010                    ADSC9   9,,PR4                   cn=0,n=8
         4 006055   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 006056   201676 000100                    ARG     I,,AUTO

     1917    19942    2         CALL CONCAT( AS_CREATED_TEXT,' ', SUBSTR(KL$TREC.RENAME,0,I), ' created.' ) ;

  19942  4 006057   000307 222000 2                  LDX2    Z_ACCT+76
         4 006060   000000 742000 xsym               STX2    AS_CREATED_TEXT
         4 006061   201676 723100                    LXL3    I,,AUTO
         4 006062   040000 100540                    MLR     fill='040'O
         4 006063   400011 000013                    ADSC9   9,,PR4                   cn=0,n=*X3
         4 006064   000000 400022 xsym               ADSC9   AS_CREATED_TEXT          cn=2,n=18
         4 006065   201676 236100                    LDQ     I,,AUTO
         4 006066   000022 116007                    CMPQ    18,DL
         4 006067   006075 603000 4                  TRC     s:19943
         4 006070   777755 624006                    EAX4    -19,QL
         4 006071   777777 664003                    ERX4    -1,DU
         4 006072   040046 100400                    MLR     fill='040'O
         4 006073   000310 000011 2                  ADSC9   Z_ACCT+77                cn=0,n=9
         4 006074   000000 400014 xsym               ADSC9   AS_CREATED_TEXT,Q        cn=2,n=*X4

     1918    19943    2         END ;

  19943  4 006075   006136 710000 4                  TRA     s:19954

     1919    19944    2      ELSE DO ;

     1920    19945    2         IF SUB OR DEV_USE < 48 /* TP */ THEN

  19945  4 006076   000000 234100                    SZN     0,,PR0
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:297  
         4 006077   006102 604000 4                  TMI     s:19946
         4 006100   000060 116007                    CMPQ    48,DL
         4 006101   006114 603000 4                  TRC     s:19948

     1921    19946    2            CALL CONCAT( AS_CREATED_TEXT, '  ', TYPE, NUM, ' created.' );

  19946  4 006102   000307 222000 2                  LDX2    Z_ACCT+76
         4 006103   000000 742000 xsym               STX2    AS_CREATED_TEXT
         4 006104   000000 223000 3                  LDX3    TYPE
         4 006105   000000 443000 xsym               SXL3    AS_CREATED_TEXT
         4 006106   201705 224100                    LDX4    NUM,,AUTO
         4 006107   000001 744000 xsym               STX4    AS_CREATED_TEXT+1
         4 006110   040000 100400                    MLR     fill='040'O
         4 006111   000310 000011 2                  ADSC9   Z_ACCT+77                cn=0,n=9
         4 006112   000001 400016 xsym               ADSC9   AS_CREATED_TEXT+1        cn=2,n=14
         4 006113   006136 710000 4                  TRA     s:19954

     1922    19947    3         ELSE DO ;

     1923    19948    3            CALL INDEX( I, AS_BLANK, SUBSTR(FROM_KEY.TEXT,0,8) ) ;

  19948  4 006114   000000 124400                    SCM     mask='000'O
         4 006115   000000 200010 xsym               ADSC9   FROM_KEY                 cn=1,n=8
         4 006116   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 006117   201676 000100                    ARG     I,,AUTO

     1924    19949    3            CALL CONCAT( AS_CREATED_TEXT, '  ', SUBSTR(FROM_KEY.TEXT,0,I),

  19949  4 006120   000307 222000 2                  LDX2    Z_ACCT+76
         4 006121   000000 742000 xsym               STX2    AS_CREATED_TEXT
         4 006122   201676 723100                    LXL3    I,,AUTO
         4 006123   040000 100440                    MLR     fill='040'O
         4 006124   000000 200013 xsym               ADSC9   FROM_KEY                 cn=1,n=*X3
         4 006125   000000 400022 xsym               ADSC9   AS_CREATED_TEXT          cn=2,n=18
         4 006126   201676 236100                    LDQ     I,,AUTO
         4 006127   000022 116007                    CMPQ    18,DL
         4 006130   006136 603000 4                  TRC     s:19954
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:298  
         4 006131   777755 624006                    EAX4    -19,QL
         4 006132   777777 664003                    ERX4    -1,DU
         4 006133   040046 100400                    MLR     fill='040'O
         4 006134   000310 000011 2                  ADSC9   Z_ACCT+77                cn=0,n=9
         4 006135   000000 400014 xsym               ADSC9   AS_CREATED_TEXT,Q        cn=2,n=*X4

     1925    19950    3                 ' created.' ) ;
     1926    19951    3            END ;

     1927    19952    2         END ;

     1928    19953
     1929    19954    1   RETURN;

  19954  4 006136   000000 702200 xent               TSX2  ! X66_ARET

  19949  4 006137                       DEV_IN_ERR   null
     1930    19955
     1931    19956
     1932    19957    1   DEV_IN_ERR: ;
     1933    19958        /*E* ERROR: ASA-E$DEVONLYIN-0
     1934    19959             MESSAGE: This option is legal only if USE=IN.
     1935    19960        */
     1936    19961        %SCREAM( ERR#=E$DEVONLYIN, LEVEL=ERROR, MID='A' );

  19973  4 006137   000115 630400 5                  EPPR0   77
         4 006140   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 006141   000000 701000 xent               TSX1    ASH$ERROR
         4 006142   000000 011000                    NOP     0

     1937    19976    1   GOTO DEV_LOOP;

  19976  4 006143   000472 710000 4                  TRA     DEV_LOOP

  19949  4 006144                       FIND_NUM_ERR null
     1938    19977
     1939    19978                                                                                    /**/
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:299  
     1940    19979    1   FIND_NUM_ERR: ;
     1941    19980    1   RETURN ;

  19980  4 006144   000000 702200 xent               TSX2  ! X66_ARET
     1942    19981
     1943    19982    1   END ASA$DEV_OPTS;

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:300  
--  Include file information  --

   QQ_SUPER_C.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   FI_MAC_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$DEV_OPTS.
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:301  

 **** Variables and constants ****

  ****  Section 002 RoData ASA$DEV_OPTS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 DEV_IN_VAL                 1-0-0/w UBIN        r     1 DEV_OUT_VAL
     2-0-0/w STRC(4320)  r     1 KL_CREC                  173-0-0/w CHAR(8)     r     1 ZERO_ACCNT
   173-0-0/w UBIN        r     1 Z_ACCT(0:1)

  ****  Section 003  Data  ASA$DEV_OPTS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    24-0-0/c STRC(72)    r     1 ACCTVLP                   63-0-0/w UBIN(9)     r     1 ASN_VAL
    32-0-0/d STRC(864)   r     1 FIDFPT                     2-0-0/d STRC(324)   r     1 FID_VLR
    14-0-0/c STRC(288)   r     1 NAMEVLP                   62-0-0/w CHAR(2)     r     1 RES_AREA
    26-0-0/d STRC(90)    r     1 SNVLP                      0-0-0/c CHAR(2)     r     1 TYPE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @CREATE                   13-0-0/w PTR         r     1 @DADR$
    12-0-0/w PTR         r     1 @SS                        7-0-0/w PTR         r     1 @SUB
    10-0-0/w PTR         r     1 @TERM_T                    3-0-0/w PTR         r     1 @TREC$
     5-0-0/w PTR         r     1 @TWSNC                     4-0-0/w PTR         r     1 @TWSNR$
    11-0-0/w PTR         r     1 @TWSN_INDEX               14-0-0/w UBIN        r     1 ARS
    15-0-0/w PTR         r     1 BLK$                      16-0-0/b BIT         r     1 CG_FLAG
    17-0-0/w UBIN        r     1 CNT                       20-0-0/w UBIN        r     1 CODE2
    21-0-0/c CHAR(80)    r     1 COMMAND                   *0-0-0/w BIT         r     1 CREATE
    *0-0-0/w PTR         r     1 DADR$                     45-0-0/b BIT (9)     r     1 DDEV
    46-0-0/b BIT         r     1 DEVCTL_SET                47-0-0/b BIT         r     1 DEVNUM_SET
    50-0-0/w UBIN        r     1 DEV_USE                   51-0-0/w PTR         r     1 FORM$
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:302  
    52-0-0/w UBIN        r     1 FORM_ARS                  53-0-0/c CHAR(3400)  r     1 FORM_BUF
  1575-0-0/b BIT         r     1 GROUP_FLAG              1576-0-0/b UBIN(9)     r     1 HEX(0:255)
  1676-0-0/w UBIN        r     1 I                       1677-0-0/b BIT         r     1 INSTANCE_FLAG
  1700-0-0/b STRC(2)     r     1 IO                      1701-0-0/w UBIN        r     1 J
  1702-0-0/w UBIN        r     1 K                       1703-0-0/w UBIN        r     1 L
  1704-0-0/b BIT         r     1 MORE                    1705-0-0/c CHAR(2)     r     1 NUM
  1706-0-0/c STRC(288)   r     1 OPTION                  2324-0-0/w PTR         r     1 P$
  1716-0-0/c CHAR(6)     r     1 PACKSET_NAME            1720-0-0/b BIT (18)    r     1 PATTR
  1721-0-0/w PTR         r     1 PRO$                    1722-0-0/c CHAR(1024)  r     1 PRO_BUF
  2322-0-0/b BIT         r     1 PRO_FLAG                2323-0-0/w PTR         r     1 PTR$
  2325-0-0/w PTR         r     1 ROOT$                   2326-0-0/b BIT         r     1 SNAME_FLG
  2327-0-0/b STRC(18)    r     1 SPLIT                     *0-0-0/c STRC(243)   r     1 SS
    *0-0-0/w BIT         r     1 SUB                     2330-0-0/w UBIN        r     1 TEMP
  2331-0-0/w PTR         r     1 TEMP$                   2332-0-0/c CHAR(4)     r     1 TEMP_TYPE
    *0-0-0/c CHAR(7)     r     1 TERM_T                  2333-0-0/b BIT         r     1 TP_FLAG
    *0-0-0/w PTR         r     1 TREC$                     *0-0-0/c CHAR(4)     r     1 TWSNC
    *0-0-0/w PTR         r     1 TWSNR$                    *0-0-0/w SBIN        r     1 TWSN_INDEX
  2334-0-0/w PTR         r     1 T_NODE$                 2335-0-0/w UBIN        r     1 WKSZ
  2336-0-0/w UBIN        r     1 WK_USED                 2337-0-0/w PTR         r     1 WORK$
  2340-0-0/b BIT         r     1 YES_NO_FLG

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/c CHAR(20)    r     1 AS_CREATED_TEXT
     0-0-0/b BIT         r     1 AS_FALSE                   0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/b BIT         r     1 AS_TRUE
     0-0-0/c CHAR        r     1 AS_VALID_DEVICE_TYPE_CHARS
     0-0-0/w UBIN        r     1 CODE                       0-0-0/w UBIN        r     1 DEVICE_OPTS_LIST
     0-0-0/w PTR         r     1 DSEG3$                     0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/c STRC(189)   r     1 FROM_KEY                   0-0-0/c CHAR(255)   r     1 IN_BUF
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/d REMB        r     1 REMEM_VAR
     0-0-0/c STRC(378)   r     1 USERS_KEY

PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:303  
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 ACHAR                      0-0-0/w STRC(1908)  r     1 CG$DEV
     0-0-0/b STRC        r     1 KL$DADR                    0-0-0/c STRC(720)   r     1 KL$PHDR
     0-0-0/w STRC(4320)  r     1 KL$TREC                    0-0-0/w STRC(576)   r     1 KL$TWSNREC
     0-0-0/w STRC(1188)  r     1 OUT$DEV                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 P$NODE                     0-0-0/w STRC(729)   r     1 RES$DEV
     0-0-0/w STRC(2088)  r     1 TP$DEV                     0-0-0/w STRC(108)   r     1 TP_DEV


   Procedure ASA$DEV_OPTS requires 3173 words for executable code.
   Procedure ASA$DEV_OPTS requires 1254 words of local(AUTO) storage.

    No errors detected in file ASA$DEVICE.:E05TSI    .
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:304  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:305  
          MINI XREF LISTING

ACCTVLP
     16553**DCL     16586--DCLINIT
ACCTVLP.ACCT#
     16553**DCL     19090>>IF      19093>>ASSIGN
ACHAR
     18063**DCL     18406>>CALLBLT 18408>>CALLBLT 18410>>CALLBLT 18413<<ASSIGN
ARS
     16029**DCL     18180<>CALL    18181>>ASSIGN  18225<<ASSIGN  18228<>CALL    19831<<ASSIGN  19834<>CALL
ASA_BRKS_LOC
     10043**DCL     10043--REDEF
ASB$FIND_NUM
     16614**DCL-ENT 18528--CALL    18576--CALL    18688--CALL
ASB$GET_HEX_VAL
     16641**DCL-ENT 19474--CALL    19502--CALL    19527--CALL
ASB$READ_SI
     16611**DCL-ENT 18180--CALL
ASB$SET_PROMPT
     16608**DCL-ENT 18170--CALL    18173--CALL
ASD$READ_PRO
     16617**DCL-ENT 18228--CALL    19834--CALL
ASF$READ_FORM
     16620**DCL-ENT 19365--CALL
ASH$DQUEST
     16638**DCL-ENT 18314--CALL
ASH$ERROR
     16623**DCL-ENT 18184--CALL    18218--CALL    18246--CALL    18271--CALL    18294--CALL    18340--CALL
     18368--CALL    18397--CALL    18510--CALL    18557--CALL    18605--CALL    18628--CALL    18656--CALL
     18681--CALL    18768--CALL    18796--CALL    18823--CALL    18866--CALL    18899--CALL    18925--CALL
     18949--CALL    18974--CALL    19001--CALL    19031--CALL    19064--CALL    19115--CALL    19162--CALL
     19188--CALL    19243--CALL    19276--CALL    19301--CALL    19329--CALL    19352--CALL    19409--CALL
     19494--CALL    19519--CALL    19551--CALL    19578--CALL    19605--CALL    19632--CALL    19750--CALL
     19775--CALL    19799--CALL    19823--CALL    19852--CALL    19871--CALL    19973--CALL
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:306  
ASH$HELP
     16632**DCL-ENT 18308--CALL
ASH$QUEST
     16635**DCL-ENT 18311--CALL
ASH$WARN
     16626**DCL-ENT 19385--CALL
ASN_VAL
     16598**DCL     16588--DCLINIT 19086>>IF
ASZ$SCRAMBLE
     16629**DCL-ENT 18102--CALL    18350--CALL    18374--CALL
AS_BLANK
      9903**DCL     18086>>ASSIGN  18087>>ASSIGN  18231>>CALLBLT 18349>>ASSIGN  18424>>ASSIGN  18440>>ASSIGN
     18449>>ASSIGN  18464>>ASSIGN  18472>>ASSIGN  18493>>IF      18540>>IF      18983>>ASSIGN  19095>>ASSIGN
     19372>>CALLBLT 19731>>IF      19941>>CALLBLT 19948>>CALLBLT
AS_CREATED_TEXT
      9917**DCL     19942<<CALLBLT 19946<<CALLBLT 19949<<CALLBLT
AS_DEFAULT.BANNER_PERM
     10736**DCL     10737--REDEF
AS_DEFAULT.BUDGET.MACCT
     10641**DCL     10645--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10654**DCL     10657--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10637**DCL     10639--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10632**DCL     10634--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10752**DCL     10753--REDEF   10754--REDEF
AS_DEFAULT_DREC.PASSWORD
     12006**DCL     12010--REDEF
AS_DEFAULT_DREC.RENAME
     12029**DCL     12030--REDEF
AS_DFLT.BANNER_PERM
     10558**DCL     10559--REDEF
AS_DFLT.BUDGET.MACCT
     10463**DCL     10467--REDEF
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:307  
AS_DFLT.BUDGET.MAX_PROJECTS
     10476**DCL     10479--REDEF
AS_DFLT.BUDGET.PACCUM
     10459**DCL     10461--REDEF
AS_DFLT.BUDGET.PMAXC
     10454**DCL     10456--REDEF
AS_DFLT.SETUP_CHRA.TXT
     10574**DCL     10575--REDEF   10576--REDEF
AS_FALSE
      9903**DCL     18088>>ASSIGN  18089>>ASSIGN  18090>>ASSIGN  18091>>ASSIGN  18092>>ASSIGN  18093>>ASSIGN
     18118>>ASSIGN  18319>>ASSIGN  18427>>ASSIGN  18428>>ASSIGN  18429>>ASSIGN  18432>>ASSIGN  18433>>ASSIGN
     18435>>ASSIGN  18451>>ASSIGN  18452>>ASSIGN  18453>>ASSIGN  18456>>ASSIGN  18457>>ASSIGN  18459>>ASSIGN
     18474>>ASSIGN  18475>>ASSIGN  18476>>ASSIGN  18479>>ASSIGN  18480>>ASSIGN  18482>>ASSIGN  18520>>ASSIGN
     18521>>ASSIGN  18522>>ASSIGN  18533>>ASSIGN  18567>>ASSIGN  18568>>ASSIGN  18569>>ASSIGN  18570>>ASSIGN
     18581>>ASSIGN  18806>>IF      18833>>ASSIGN  18835>>ASSIGN  18836>>ASSIGN  18837>>ASSIGN  18839>>ASSIGN
     18841>>ASSIGN  18843>>ASSIGN  18844>>ASSIGN  18873>>ASSIGN  18957>>IF      19090>>IF      19211>>ASSIGN
     19212>>ASSIGN  19221>>ASSIGN  19309>>ASSIGN
AS_FE_MODE
      9909**DCL      9910--REDEF
AS_FIELD1.COUNT
     10040**DCL     18232<<ASSIGN  18642<<ASSIGN  19373<<ASSIGN
AS_FIELD1.TEXT
     10040**DCL     18233<<ASSIGN  18643<<ASSIGN  19374<<ASSIGN
AS_MODE
      9906**DCL      9908--REDEF
AS_MOD_USER.ACCESS
     12771**DCL     12772--REDEF
AS_MOD_USER.BANNER
     12758**DCL     12759--REDEF
AS_MOD_USER.BANNER_PERM
     12760**DCL     12761--REDEF
AS_MOD_USER.BILL
     12766**DCL     12767--REDEF
AS_MOD_USER.CPROC
     12762**DCL     12763--REDEF
AS_MOD_USER.FEBILL
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:308  
     12842**DCL     12843--REDEF
AS_MOD_USER.FECXTMEM
     12859**DCL     12860--REDEF
AS_MOD_USER.FEMINTS
     12844**DCL     12845--REDEF
AS_MOD_USER.FEMMEM
     12855**DCL     12856--REDEF
AS_MOD_USER.FEMTIME
     12853**DCL     12854--REDEF
AS_MOD_USER.FEPPRIV
     12850**DCL     12852--REDEF
AS_MOD_USER.FEPRIV
     12847**DCL     12849--REDEF
AS_MOD_USER.FORCE_BIT
     12756**DCL     12757--REDEF
AS_MOD_USER.KEY
     12838**DCL     12840--REDEF
AS_MOD_USER.LASTCPROC
     12764**DCL     12765--REDEF
AS_MOD_USER.LIMITS.DO_
     12812**DCL     12813--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12828**DCL     12829--REDEF
AS_MOD_USER.LIMITS.LO
     12808**DCL     12809--REDEF
AS_MOD_USER.LIMITS.MEM
     12804**DCL     12805--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12832**DCL     12833--REDEF
AS_MOD_USER.LIMITS.PDIS
     12820**DCL     12821--REDEF
AS_MOD_USER.LIMITS.PO
     12816**DCL     12817--REDEF
AS_MOD_USER.LIMITS.TDIS
     12824**DCL     12825--REDEF
AS_MOD_USER.LIMITS.TIME
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:309  
     12800**DCL     12801--REDEF
AS_MOD_USER.MAXENQ
     12781**DCL     12782--REDEF
AS_MOD_USER.PERM_BIT
     12754**DCL     12755--REDEF
AS_MOD_USER.PPRIV
     12776**DCL     12778--REDEF
AS_MOD_USER.PRIOB
     12783**DCL     12784--REDEF
AS_MOD_USER.PRIV
     12773**DCL     12775--REDEF
AS_MOD_USER.QUAN
     12779**DCL     12780--REDEF
AS_MOD_USER.SETUP
     12752**DCL     12753--REDEF
AS_PROJECT.BANNER_PERM
     11092**DCL     11093--REDEF
AS_PROJECT.BUDGET.MACCT
     10997**DCL     11001--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     11010**DCL     11013--REDEF
AS_PROJECT.BUDGET.PACCUM
     10993**DCL     10995--REDEF
AS_PROJECT.BUDGET.PMAXC
     10988**DCL     10990--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11108**DCL     11109--REDEF   11110--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11270**DCL     11271--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11175**DCL     11179--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11188**DCL     11191--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11171**DCL     11173--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:310  
     11166**DCL     11168--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11286**DCL     11287--REDEF   11288--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12492**DCL     12496--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12515**DCL     12516--REDEF
AS_PROJECT_DREC.PASSWORD
     12330**DCL     12334--REDEF
AS_PROJECT_DREC.RENAME
     12353**DCL     12354--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10914**DCL     10915--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10819**DCL     10823--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10832**DCL     10835--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     10815**DCL     10817--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10810**DCL     10812--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10930**DCL     10931--REDEF   10932--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12168**DCL     12172--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12191**DCL     12192--REDEF
AS_TRUE
      9903**DCL     18084>>ASSIGN  18104>>ASSIGN  18117>>ASSIGN  18119>>ASSIGN  18124>>ASSIGN  18125>>ASSIGN
     18143>>ASSIGN  18146>>ASSIGN  18147>>ASSIGN  18150>>ASSIGN  18153>>ASSIGN  18154>>ASSIGN  18303>>ASSIGN
     18441>>ASSIGN  18486>>ASSIGN  18526>>ASSIGN  18534>>ASSIGN  18574>>ASSIGN  18831>>ASSIGN  18832>>ASSIGN
     18840>>ASSIGN  18845>>ASSIGN  18876>>ASSIGN  18905>>ASSIGN  19009>>ASSIGN  19087>>ASSIGN  19209>>ASSIGN
     19219>>ASSIGN  19307>>ASSIGN  19753>>ASSIGN  19778>>ASSIGN  19802>>ASSIGN  19826>>ASSIGN  19855>>ASSIGN
     19874>>ASSIGN
AS_USERS.BANNER_PERM
     10380**DCL     10381--REDEF
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:311  
AS_USERS.BUDGET.MACCT
     10285**DCL     10289--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10298**DCL     10301--REDEF
AS_USERS.BUDGET.PACCUM
     10281**DCL     10283--REDEF
AS_USERS.BUDGET.PMAXC
     10276**DCL     10278--REDEF
AS_USERS.SETUP_CHRA.TXT
     10396**DCL     10397--REDEF   10398--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11448**DCL     11449--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11353**DCL     11357--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11366**DCL     11369--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11349**DCL     11351--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11344**DCL     11346--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11464**DCL     11465--REDEF   11466--REDEF
AS_VALID_DEVICE_TYPE_CHARS
      9904**DCL     18634>>CALLBLT
BAD_DEVICE_TYPE
     18642**LABEL   18634--CALLALT
BAD_FID
     19094**LABEL   19085--CALLALT 19086--GOTO
BLK$
     16030**DCL     16702--IMP-PTR 18201<<ASSIGN  18202>>ASSIGN  18226>>ASSIGN  18227>>ASSIGN  18227>>ASSIGN
     18353<<ASSIGN  18354>>ASSIGN  18373>>ASSIGN  18373>>ASSIGN  18377<<ASSIGN  18378>>ASSIGN  18402>>ASSIGN
     18610<<ASSIGN  18611>>ASSIGN  18611>>ASSIGN  18612>>IF      18748<<ASSIGN  18749>>CALLBLT 18749>>CALLBLT
     18781<<ASSIGN  18782>>IF      18801>>ASSIGN  18801>>ASSIGN  18877<<ASSIGN  18878>>IF      18878>>IF
     18904>>ASSIGN  18904>>ASSIGN  18930<<ASSIGN  18931>>CALLBLT 18931>>CALLBLT 18956<<ASSIGN  18979>>IF
     18980>>ASSIGN  18980>>ASSIGN  18981<<ASSIGN  18984>>IF      19006>>ASSIGN  19006>>ASSIGN  19007>>ASSIGN
     19007>>ASSIGN  19008>>ASSIGN  19036<<ASSIGN  19037>>IF      19043>>ASSIGN  19044>>ASSIGN  19044>>ASSIGN
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:312  
     19083<<ASSIGN  19084>>ASSIGN  19084>>ASSIGN  19125<<ASSIGN  19126>>CALLBLT 19126>>CALLBLT 19141<<ASSIGN
     19142>>CALLBLT 19142>>CALLBLT 19225<<ASSIGN  19226>>IF      19248>>ASSIGN  19248>>ASSIGN  19258<<ASSIGN
     19259>>IF      19281>>ASSIGN  19281>>ASSIGN  19334<<ASSIGN  19335>>IF      19357>>IF      19357>>IF
     19360>>ASSIGN  19360>>ASSIGN  19363>>ASSIGN  19363>>ASSIGN  19557<<ASSIGN  19558>>ASSIGN  19584<<ASSIGN
     19585>>ASSIGN  19585>>ASSIGN  19611<<ASSIGN  19612>>ASSIGN  19612>>ASSIGN  19643<<ASSIGN  19644>>IF
CG$DEV.B_CGAUINFO
     17529**DCL     18155>>ASSIGN  19935<<ASSIGN
CG$DEV.PASSWORD
     17447**DCL     17451--REDEF
CG$DEV.RENAME
     17470**DCL     17471--REDEF
CG_FLAG
     16031**DCL     18089<<ASSIGN  18153<<ASSIGN  18431>>IF      18432<<ASSIGN  18455>>IF      18456<<ASSIGN
     18478>>IF      18479<<ASSIGN  18519>>IF      18520<<ASSIGN  18574<<ASSIGN  19805>>IF
CNT
     16032**DCL     18202<<ASSIGN  18203>>IF      18354<<ASSIGN  18355>>IF      18378<<ASSIGN  18379>>IF
     18749<<CALLBLT 18750>>IF      18773>>ASSIGN  18931<<CALLBLT 18932>>IF      18953>>ASSIGN  19039<<ASSIGN
     19043<<ASSIGN  19046>>IF      19072>>ASSIGN  19078>>ASSIGN  19126<<CALLBLT 19130>>ASSIGN  19132>>ASSIGN
     19134>>ASSIGN  19136>>ASSIGN  19142<<CALLBLT 19143>>IF      19167>>ASSIGN
CODE
     10036**DCL     18191<<ASSIGN  18192>>DOSELCT 19127>>ASSIGN  19639<<ASSIGN  19649>>DOSELCT
CODE2
     16033**DCL     18345<<ASSIGN  18346>>DOSELCT 18420<<ASSIGN  18421>>DOSELCT 18423>>IF      18447>>IF
     18471>>IF      18515>>IF      18562>>IF      18584>>ASSIGN  18828<<ASSIGN  18829>>DOSELCT 19127<<ASSIGN
     19128>>DOSELCT 19193<<ASSIGN  19194>>DOSELCT
COMMAND
     16034**DCL     19040<<ASSIGN  19044<<ASSIGN  19071>>ASSIGN  19077>>ASSIGN
CREATE
     15983**DCL        28--PROC    18095>>IF      18111>>IF      18423>>IF      18447>>IF      18471>>IF
     18484>>IF      18515>>IF      18562>>IF      18662>>IF      18694>>IF      19939>>IF
DADR$
     16022**DCL        28--PROC    17098--IMP-PTR 18698>>ASSIGN  18700>>ASSIGN  18702>>ASSIGN  18704>>ASSIGN
     18706>>ASSIGN  18711>>ASSIGN  18713>>ASSIGN  18715>>ASSIGN  18720>>ASSIGN  18722>>ASSIGN  18724>>ASSIGN
     18730>>ASSIGN  18731>>ASSIGN  18734>>ASSIGN  18735>>ASSIGN  19418>>ASSIGN  19421>>ASSIGN  19424>>ASSIGN
     19427>>ASSIGN  19430>>ASSIGN  19433>>ASSIGN  19436>>ASSIGN  19437>>ASSIGN  19438>>ASSIGN  19439>>ASSIGN
     19442>>ASSIGN  19443>>ASSIGN  19444>>ASSIGN  19447>>ASSIGN  19448>>ASSIGN  19449>>ASSIGN  19452>>ASSIGN
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:313  
     19453>>ASSIGN  19454>>ASSIGN  19457>>ASSIGN  19458>>ASSIGN  19459>>ASSIGN  19462>>ASSIGN  19463>>ASSIGN
     19464>>ASSIGN  19467>>ASSIGN  19468>>ASSIGN  19469>>ASSIGN  19475>>ASSIGN  19503>>ASSIGN  19530>>ASSIGN
DDEV
     16035**DCL     18099<<ASSIGN  18162<<ASSIGN  18301<<ASSIGN  19879<<ASSIGN  19894>>ASSIGN
DEVCTL_SET
     16036**DCL     18727>>IF      19531<<ASSIGN
DEVICE_OPTS_LIST
     16085**DCL     18167--ASSIGN
DEVNUM_SET
     16037**DCL     18695>>IF      19478<<ASSIGN
DEV_IN_ERR
     19949**LABEL   18747--GOTO    18777--GOTO    19140--GOTO    19207--GOTO    19217--GOTO    19224--GOTO
     19252--GOTO
DEV_IN_VAL
     16091**DCL     18134>>ASSIGN  18747>>IF      18777>>IF      19140>>IF      19207>>IF      19217>>IF
     19224>>IF      19252>>IF
DEV_LOOP
     18178**LABEL   18175--REMEMBR 18185--GOTO    19875--GOTO    19976--GOTO
DEV_OUT_VAL
     16092**DCL     18136>>ASSIGN  19288>>IF      19312>>IF
DEV_USE
     16038**DCL     18094<<ASSIGN  18121<<ASSIGN  18134<<ASSIGN  18136<<ASSIGN  18139<<ASSIGN  18145<<ASSIGN
     18152<<ASSIGN  18423>>IF      18447>>IF      18471>>IF      18515>>IF      18562>>IF      18584<<ASSIGN
     18588>>IF      18588>>IF      18747>>IF      18777>>IF      18908>>IF      19069>>IF      19075>>IF
     19140>>IF      19207>>IF      19217>>IF      19224>>IF      19252>>IF      19288>>IF      19312>>IF
     19534>>IF      19561>>IF      19588>>IF      19615>>IF      19731>>IF      19913>>DOSELCT 19922>>IF
     19945>>IF
DSEG3$
     10045**DCL     18064--IMP-PTR 18109>>IF      18122>>IF      18126>>ASSIGN
END_OPTION
     19721**LABEL   18199--GOTO    18221--GOTO    18249--GOTO    18274--GOTO    18297--GOTO    18343--GOTO
     18371--GOTO    18513--GOTO    18560--GOTO    18608--GOTO    18631--GOTO    18659--GOTO    18684--GOTO
     18686--GOTO    18771--GOTO    18826--GOTO    18869--GOTO    18874--GOTO    18902--GOTO    18928--GOTO
     18977--GOTO    19004--GOTO    19034--GOTO    19067--GOTO    19097--GOTO    19118--GOTO    19165--GOTO
     19191--GOTO    19246--GOTO    19256--GOTO    19279--GOTO    19304--GOTO    19332--GOTO    19355--GOTO
     19391--GOTO    19412--GOTO    19474--CALLALT 19497--GOTO    19502--CALLALT 19522--GOTO    19527--CALLALT
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:314  
     19554--GOTO    19581--GOTO    19608--GOTO    19635--GOTO
ERR_CODE
     10038**DCL     10039--REDEF
FIDFPT
     16585**DCL     19085<>CALL
FIDFPT.TEXTFID_
     16585**DCL     19084<<ASSIGN
FIDFPT.V
     16589**DCL     16585--DCLINIT
FID_VLR
     16507**DCL     16589--DCLINIT
FID_VLR.ACCT
     16507**DCL     19090>>IF
FID_VLR.SN
     16507**DCL     19094>>IF
FIND_NUM_ERR
     19949**LABEL   18528--CALLALT 18576--CALLALT 18688--CALLALT
FORM$
     16039**DCL     19361<<ASSIGN  19365<>CALL
FORM_ARS
     16040**DCL     19364<<ASSIGN  19365<>CALL
FORM_BUF
     16041**DCL     19361--ASSIGN  19364--ASSIGN
FROM_KEY.CNT
      9917**DCL     18531<<ASSIGN  18579<<ASSIGN  18693<<ASSIGN
FROM_KEY.TEXT
      9917**DCL     18163<<ASSIGN  18530<<ASSIGN  18578<<ASSIGN  18692<<ASSIGN  19895>>ASSIGN  19948>>CALLBLT
     19949>>CALLBLT
GROUP_FLAG
     16042**DCL     18090<<ASSIGN  18154<<ASSIGN  18433<<ASSIGN  18457<<ASSIGN  18480<<ASSIGN  18521<<ASSIGN
     19087<<ASSIGN  19805>>IF
HEX
     16043**DCL     19474<>CALL    19475>>ASSIGN  19502<>CALL    19503>>ASSIGN  19527<>CALL    19528>>ASSIGN
     19529>>ASSIGN
I
     16044**DCL     18189<<DOINDEX 18190>>ASSIGN  18231<<CALLBLT 18232>>ASSIGN  19372<<CALLBLT 19373>>ASSIGN
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:315  
     19941<<CALLBLT 19942>>CALLBLT 19948<<CALLBLT 19949>>CALLBLT
IN$DEV.ISINFO.FNAME
     17878**DCL     17881--REDEF   17882--REDEF
IN$DEV.PASSWORD
     17787**DCL     17791--REDEF
IN$DEV.RENAME
     17810**DCL     17811--REDEF
INSTANCE_FLAG
     16045**DCL     18092<<ASSIGN  18147<<ASSIGN  18429<<ASSIGN  18453<<ASSIGN  18476<<ASSIGN  18569<<ASSIGN
     19009<<ASSIGN  19781>>IF
IN_BUF
     10034**DCL     18180<>CALL
IO
     16046**DCL     18097<<ASSIGN  18161<<ASSIGN  18300<<ASSIGN  19878<<ASSIGN  19893>>ASSIGN
J
     16049**DCL     18408<<CALLBLT 18411>>ASSIGN  18633<<DOINDEX 18634>>CALLBLT 18643>>ASSIGN
K
     16050**DCL     18410<<CALLBLT 18411>>ASSIGN  18634<<CALLBLT
KL$DADR.DEVCTL
     17118**DCL     19530<<ASSIGN
KL$DADR.DEVCTL.B
     17127**DCL     18730<<ASSIGN  18735<<ASSIGN  19439<<ASSIGN  19444<<ASSIGN  19449<<ASSIGN  19454<<ASSIGN
     19459<<ASSIGN  19464<<ASSIGN  19469<<ASSIGN
KL$DADR.DEVCTL.T
     17125**DCL     18731<<ASSIGN  18734<<ASSIGN  19438<<ASSIGN  19443<<ASSIGN  19448<<ASSIGN  19453<<ASSIGN
     19458<<ASSIGN  19463<<ASSIGN  19468<<ASSIGN
KL$DADR.DEVNUM#
     17109**DCL     18698<<ASSIGN  18700<<ASSIGN  18702<<ASSIGN  18704<<ASSIGN  18706<<ASSIGN  18711<<ASSIGN
     18713<<ASSIGN  18715<<ASSIGN  18720<<ASSIGN  18722<<ASSIGN  18724<<ASSIGN  19418<<ASSIGN  19421<<ASSIGN
     19424<<ASSIGN  19427<<ASSIGN  19430<<ASSIGN  19433<<ASSIGN  19436<<ASSIGN  19442<<ASSIGN  19447<<ASSIGN
     19452<<ASSIGN  19457<<ASSIGN  19462<<ASSIGN  19467<<ASSIGN  19475<<ASSIGN
KL$DADR.SDNUM#
     17116**DCL     19437<<ASSIGN  19503<<ASSIGN
KL$PHDR
     17172**DCL     18228<>CALL    19834<>CALL
KL$PHDR.ATTR
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:316  
     17176**DCL     18299>>ASSIGN  19877>>ASSIGN
KL$PHDR.DDEV
     17191**DCL     18301>>ASSIGN  19879>>ASSIGN
KL$PHDR.IO
     17187**DCL     18300>>ASSIGN  19878>>ASSIGN
KL$PHDR.TTYP
     17173**DCL     18253>>IF      18276>>IF      18276>>IF      18276>>IF      19858>>IF
KL$TREC
     16748**DCL     18096<<ASSIGN
KL$TREC.ATYP
     16753**DCL     18488<<ASSIGN
KL$TREC.B_CGAUINFO
     17075**DCL     18155<<ASSIGN  18565<<ASSIGN  19934--ASSIGN  19935>>ASSIGN
KL$TREC.B_CGAUINFO.UCMD
     17079**DCL     19077<<ASSIGN
KL$TREC.B_CGAUINFO.UCMDCNT
     17078**DCL     19078<<ASSIGN
KL$TREC.B_CGAUINFO.USER1
     17077**DCL     19130<<ASSIGN
KL$TREC.B_CGAUINFO.USER2
     17077**DCL     19132<<ASSIGN
KL$TREC.B_CGAUINFO.USER3
     17077**DCL     19134<<ASSIGN
KL$TREC.B_CGAUINFO.USER4
     17078**DCL     19136<<ASSIGN
KL$TREC.FLAGS
     16756**DCL     18485<<ASSIGN
KL$TREC.FLAGS.NOCGINF
     16787**DCL     19197<<ASSIGN  19199<<ASSIGN  19202<<ASSIGN
KL$TREC.FLAGS.NOCGREJ
     16782**DCL     19196<<ASSIGN  19200<<ASSIGN  19203<<ASSIGN
KL$TREC.FLAGS.RNME
     16759**DCL     18104<<ASSIGN  18118<<ASSIGN  18125<<ASSIGN  18486<<ASSIGN  18533<<ASSIGN  18581<<ASSIGN
     18873<<ASSIGN  18876<<ASSIGN
KL$TREC.FLAGS.USETP
     16777**DCL     18119<<ASSIGN  18427<<ASSIGN  18451<<ASSIGN  18474<<ASSIGN  18534<<ASSIGN  18567<<ASSIGN
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:317  
KL$TREC.ISINFO
     16897**DCL     18425<<ASSIGN  19915--ASSIGN
KL$TREC.ISINFO.DFLTPRI
     16909**DCL     16910--REDEF   18444<<ASSIGN  19167<<ASSIGN
KL$TREC.ISINFO.MXPRI
     16911**DCL     18443<<ASSIGN  18773<<ASSIGN
KL$TREC.ISINFO.NCACCT
     16913**DCL     18442<<ASSIGN  19248<<ASSIGN
KL$TREC.ISINFO.NCTL
     16900**DCL     19209<<ASSIGN  19211<<ASSIGN
KL$TREC.ISINFO.NCTLFID
     16904**DCL     19212<<ASSIGN  19255<<ASSIGN  19282<<ASSIGN
KL$TREC.ISINFO.NCTLOK
     16902**DCL     18441<<ASSIGN  19219<<ASSIGN  19221<<ASSIGN
KL$TREC.ISINFO.NFID
     16916**DCL     19213<<ASSIGN  19254<<ASSIGN  19281<<ASSIGN
KL$TREC.ISINFO.TNAME
     16919**DCL     18108<<ASSIGN
KL$TREC.ISINFO.WSN
     16921**DCL     18779<<ASSIGN  18801<<ASSIGN
KL$TREC.KC$CGID
     16868**DCL     18112<<ASSIGN  18516<<ASSIGN  18563<<ASSIGN  19912--ASSIGN
KL$TREC.KC$CGID.ACCT#
     16870**DCL     18439<<ASSIGN  18463<<ASSIGN  19006<<ASSIGN  19091<<ASSIGN  19093<<ASSIGN
KL$TREC.KC$CGID.NAME#.CNT
     16874**DCL     18103<<ASSIGN  18113<<ASSIGN  18437<<ASSIGN  18461<<ASSIGN  18517<<ASSIGN  18564<<ASSIGN
     19008<<ASSIGN  19088<<ASSIGN
KL$TREC.KC$CGID.NAME#.TXT
     16875**DCL     18438<<ASSIGN  18462<<ASSIGN  19007<<ASSIGN  19089<<ASSIGN
KL$TREC.KC$CGID.PSN#
     16871**DCL     18440<<ASSIGN  18464<<ASSIGN  19010<<ASSIGN  19095<<ASSIGN  19096<<ASSIGN
KL$TREC.NWINFO
     16846**DCL     19912<<ASSIGN  19915<<ASSIGN  19915>>ASSIGN  19918<<ASSIGN  19918>>ASSIGN  19923<<ASSIGN
     19927<<ASSIGN  19930<<ASSIGN  19930>>ASSIGN  19934<<ASSIGN  19934>>ASSIGN
KL$TREC.OSINFO
     16944**DCL     18137<<ASSIGN  18448<<ASSIGN  19918--ASSIGN  19919>>ASSIGN
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:318  
KL$TREC.OSINFO.FNAME
     16950**DCL     16953--REDEF   16954--REDEF   18466<<ASSIGN  18468<<ASSIGN  19358<<ASSIGN  19360<<ASSIGN
     19900>>ASSIGN
KL$TREC.OSINFO.TNAME
     16956**DCL     18107<<ASSIGN
KL$TREC.OSINFO.UPLOCKED
     16947**DCL     19307<<ASSIGN  19309<<ASSIGN
KL$TREC.PASSWORD
     16806**DCL     16810--REDEF   18102<>CALL    18349<<ASSIGN  18350<>CALL    18373<<ASSIGN  18374<>CALL
     18404--ASSIGN
KL$TREC.PNAME
     16812**DCL     18302<<ASSIGN  19729>>ASSIGN
KL$TREC.PNAME.CNT
     16820**DCL     18100<<ASSIGN  18197<<ASSIGN  18743<<ASSIGN  19832>>ASSIGN
KL$TREC.PNAME.TXT
     16823**DCL     18101<<ASSIGN  18198<<ASSIGN  18741>>IF      18742<<CALLBLT 19829>>IF      19833>>ASSIGN
     19907>>ASSIGN
KL$TREC.QQ_LOGON
     16976**DCL     18114<<ASSIGN  18148<<ASSIGN  18518<<ASSIGN  19930--ASSIGN  19931>>ASSIGN
KL$TREC.QQ_LOGON.CMD
     16993**DCL     19071<<ASSIGN
KL$TREC.QQ_LOGON.CMDCNT
     16991**DCL     19072<<ASSIGN
KL$TREC.QQ_LOGON.MCT
     16978**DCL     18831<<ASSIGN  18835<<ASSIGN  18839<<ASSIGN  18843<<ASSIGN
KL$TREC.QQ_LOGON.MCTCMD
     16980**DCL     18832<<ASSIGN  18836<<ASSIGN  18840<<ASSIGN  18844<<ASSIGN
KL$TREC.QQ_LOGON.MCTD
     16982**DCL     18833<<ASSIGN  18837<<ASSIGN  18841<<ASSIGN  18845<<ASSIGN
KL$TREC.QQ_LOGON.PRIO
     16985**DCL     18953<<ASSIGN
KL$TREC.RENAME
     16829**DCL     16830--REDEF   18105<<ASSIGN  18126<<ASSIGN  18140>>IF      18465>>IF      18529<<CALLBLT
     18530>>ASSIGN  18577<<CALLBLT 18578>>ASSIGN  18663>>IF      18689<<CALLBLT 18692>>ASSIGN  18872<<ASSIGN
     18904<<ASSIGN  19941>>CALLBLT 19942>>CALLBLT
KL$TREC.RES_DEV
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:319  
     17017**DCL     18141<<ASSIGN  19924>>ASSIGN
KL$TREC.RES_DEV.ATTR.B1200#
     17035**DCL     19657<<ASSIGN
KL$TREC.RES_DEV.ATTR.B2400#
     17036**DCL     19661<<ASSIGN
KL$TREC.RES_DEV.ATTR.B300#
     17034**DCL     19653<<ASSIGN
KL$TREC.RES_DEV.ATTR.HAYES#
     17037**DCL     19665<<ASSIGN
KL$TREC.RES_DEV.ATTR.RFU1#
     17051**DCL     19673<<ASSIGN
KL$TREC.RES_DEV.ATTR.RFU10#
     17042**DCL     19709<<ASSIGN
KL$TREC.RES_DEV.ATTR.RFU11#
     17041**DCL     19713<<ASSIGN
KL$TREC.RES_DEV.ATTR.RFU13#
     17039**DCL     19721<<ASSIGN
KL$TREC.RES_DEV.ATTR.RFU2#
     17050**DCL     19677<<ASSIGN
KL$TREC.RES_DEV.ATTR.RFU3#
     17049**DCL     19681<<ASSIGN
KL$TREC.RES_DEV.ATTR.RFU4#
     17048**DCL     19685<<ASSIGN
KL$TREC.RES_DEV.ATTR.RFU5#
     17047**DCL     19689<<ASSIGN
KL$TREC.RES_DEV.ATTR.RFU6#
     17046**DCL     19693<<ASSIGN
KL$TREC.RES_DEV.ATTR.RFU7#
     17045**DCL     19697<<ASSIGN
KL$TREC.RES_DEV.ATTR.RFU8#
     17044**DCL     19701<<ASSIGN
KL$TREC.RES_DEV.ATTR.RFU9#
     17043**DCL     19705<<ASSIGN
KL$TREC.RES_DEV.ATTR.TCPIP#
     17040**DCL     19717<<ASSIGN
KL$TREC.RES_DEV.ATTR.X28#
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:320  
     17038**DCL     19669<<ASSIGN
KL$TREC.RES_DEV.AUACCOUNT
     17057**DCL     19612<<ASSIGN
KL$TREC.RES_DEV.MODE
     17030**DCL     19558<<ASSIGN
KL$TREC.RES_DEV.RNAME
     17054**DCL     19585<<ASSIGN
KL$TREC.SUPER
     16800**DCL     18120<<ASSIGN  18132>>DOSELCT 18445<<ASSIGN  18469<<ASSIGN  18489<<ASSIGN  18494>>IF
     18535<<ASSIGN  18541>>IF      18582<<ASSIGN  19899>>IF
KL$TREC.TWSN#
     16803**DCL     18106<<ASSIGN  18131>>ASSIGN  18529>>CALLBLT 18577>>CALLBLT 18689>>CALLBLT
KL$TWSNREC.DEVS
     17138**DCL     18166<<ASSIGN
KL$TWSNREC.DEVS.ACCT
     17152**DCL     18163>>ASSIGN  19895<<ASSIGN
KL$TWSNREC.DEVS.ATTR
     17141**DCL     18160>>ASSIGN  19892<<ASSIGN
KL$TWSNREC.DEVS.DDEV
     17142**DCL     18162>>ASSIGN  19894<<ASSIGN
KL$TWSNREC.DEVS.FNAME
     17150**DCL     19900<<ASSIGN  19902<<ASSIGN
KL$TWSNREC.DEVS.IO
     17143**DCL     18161>>ASSIGN  19893<<ASSIGN
KL$TWSNREC.DEVS.NUM
     17140**DCL     18159>>ASSIGN  19891<<ASSIGN
KL$TWSNREC.DEVS.PNAME
     17154**DCL     19729<<ASSIGN
KL$TWSNREC.DEVS.TDEV
     17146**DCL     19896<<ASSIGN  19898<<ASSIGN
KL$TWSNREC.DEVS.TERM
     17153**DCL     19903<<ASSIGN
KL$TWSNREC.DEVS.TYP
     17139**DCL     18158>>ASSIGN  19890<<ASSIGN
KL$TWSNREC.STATION
     17136**DCL     18107>>ASSIGN  18108>>ASSIGN
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:321  
KL_CREC
     16111**DCL     18096>>ASSIGN
KL_CREC.B_CGAUINFO
     16439**DCL     18565>>ASSIGN
KL_CREC.ISINFO
     16260**DCL     18425>>ASSIGN
KL_CREC.ISINFO.DFLTPRI
     16272**DCL     16273--REDEF
KL_CREC.KC$CGID
     16231**DCL     18112>>ASSIGN  18516>>ASSIGN  18563>>ASSIGN
KL_CREC.OSINFO
     16307**DCL     18448>>ASSIGN
KL_CREC.OSINFO.FNAME
     16313**DCL     16316--REDEF   16317--REDEF
KL_CREC.PASSWORD
     16169**DCL     16173--REDEF
KL_CREC.QQ_LOGON
     16340**DCL     18114>>ASSIGN  18518>>ASSIGN
KL_CREC.RENAME
     16192**DCL     16193--REDEF
KL_DEFAULT.PASSWORD
     12654**DCL     12658--REDEF
KL_DEFAULT.RENAME
     12677**DCL     12678--REDEF
KL_DFLT.PASSWORD
     11844**DCL     11848--REDEF
KL_DFLT.RENAME
     11867**DCL     11868--REDEF
KL_DREC.PASSWORD
     11682**DCL     11686--REDEF
KL_DREC.RENAME
     11705**DCL     11706--REDEF
KL_DREC_CNT.PASSWORD
     11569**DCL     11573--REDEF
KL_DREC_CNT.RENAME
     11592**DCL     11593--REDEF
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:322  
L
     16051**DCL     18406<<CALLBLT 18411>>ASSIGN
M$FID
     14205**DCL-ENT 19085--CALL
MERR_CODE.CODE
     10039**DCL     19367>>IF
MORE
     16052**DCL     18084<<ASSIGN  18178>>DOWHILE 18319<<ASSIGN  19753<<ASSIGN  19778<<ASSIGN  19802<<ASSIGN
     19826<<ASSIGN  19855<<ASSIGN  19874<<ASSIGN
NAMEVLP
     16540**DCL     16586--DCLINIT
NAMEVLP.L#
     16540**DCL     19088>>ASSIGN
NAMEVLP.NAME#
     16540**DCL     19089>>ASSIGN
NODE$
     10036**DCL     16655--IMP-PTR 18083>>ASSIGN  18188<<ASSIGN  18189>>DOINDEX 18190>>ASSIGN  19887<<ASSIGN
NUM
     16053**DCL     18086<<ASSIGN  18159<<ASSIGN  18528<>CALL    18529>>CALLBLT 18576<>CALL    18577>>CALLBLT
     18688<>CALL    18689>>CALLBLT 19891>>ASSIGN  19909>>ASSIGN  19946>>CALLBLT
OPTION
     16054**DCL     19474<>CALL    19502<>CALL    19527<>CALL
OPTION.COUNT
     16055**DCL     19472<<ASSIGN  19500<<ASSIGN  19526<<ASSIGN
OPTION.TEXT
     16056**DCL     19473<<ASSIGN  19501<<ASSIGN  19525<<ASSIGN
OUT$DEV.OSINFO
     17359**DCL     18137>>ASSIGN  19919<<ASSIGN
OUT$DEV.OSINFO.FNAME
     17365**DCL     17368--REDEF   17369--REDEF
OUT$DEV.PASSWORD
     17274**DCL     17278--REDEF
OUT$DEV.RENAME
     17297**DCL     17298--REDEF
OUT$SYM.CODE
     16708**DCL     18979>>IF      19037>>IF
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:323  
OUT$SYM.COUNT
     16725**DCL     16728--IMP-SIZ 18202>>ASSIGN  18226>>ASSIGN  18227>>ASSIGN  18354>>ASSIGN  18373>>ASSIGN
     18378>>ASSIGN  18611>>ASSIGN  18612>>IF      18749>>CALLBLT 18782>>IF      18801>>ASSIGN  18878>>IF
     18904>>ASSIGN  18931>>CALLBLT 18980>>ASSIGN  18984>>IF      19006>>ASSIGN  19007>>ASSIGN  19008>>ASSIGN
     19043>>ASSIGN  19044>>ASSIGN  19084>>ASSIGN  19126>>CALLBLT 19142>>CALLBLT 19226>>IF      19248>>ASSIGN
     19259>>IF      19281>>ASSIGN  19335>>IF      19357>>IF      19360>>ASSIGN  19363>>ASSIGN  19585>>ASSIGN
     19612>>ASSIGN
OUT$SYM.TEXT
     16728**DCL     18227>>ASSIGN  18373>>ASSIGN  18402--ASSIGN  18611>>ASSIGN  18749>>CALLBLT 18801>>ASSIGN
     18878>>IF      18904>>ASSIGN  18931>>CALLBLT 18980>>ASSIGN  19006>>ASSIGN  19007>>ASSIGN  19044>>ASSIGN
     19084--ASSIGN  19126>>CALLBLT 19142>>CALLBLT 19248>>ASSIGN  19281>>ASSIGN  19357>>IF      19360>>ASSIGN
     19363>>ASSIGN  19585>>ASSIGN  19612>>ASSIGN
P$
     16063**DCL     18402<<ASSIGN  18403>>ASSIGN  18405>>DOWHILE 18406>>CALLBLT 18407<<ASSIGN  18407>>ASSIGN
     18408>>CALLBLT 18409<<ASSIGN  18409>>ASSIGN  18410>>CALLBLT 18412<<ASSIGN  18412>>ASSIGN
P$NODE.CODE
     16663**DCL     18191>>ASSIGN  18196>>IF      18345>>ASSIGN  18420>>ASSIGN  18778>>IF      18828>>ASSIGN
     18871>>IF      19193>>ASSIGN  19208>>IF      19218>>IF      19253>>IF      19306>>IF      19415>>DOSELCT
     19558>>ASSIGN  19639>>ASSIGN  19644>>IF
P$NODE.SUBLK$
     16688**DCL     18190>>ASSIGN  18196>>IF      18201>>ASSIGN  18345>>ASSIGN  18353>>ASSIGN  18377>>ASSIGN
     18377>>ASSIGN  18420>>ASSIGN  18610>>ASSIGN  18748>>ASSIGN  18781>>ASSIGN  18828>>ASSIGN  18871>>IF
     18877>>ASSIGN  18930>>ASSIGN  18956>>ASSIGN  18981>>ASSIGN  19036>>ASSIGN  19083>>ASSIGN  19125>>ASSIGN
     19141>>ASSIGN  19193>>ASSIGN  19208>>IF      19218>>IF      19225>>ASSIGN  19258>>ASSIGN  19306>>IF
     19334>>ASSIGN  19415>>DOSELCT 19557>>ASSIGN  19584>>ASSIGN  19611>>ASSIGN  19638>>ASSIGN  19643>>ASSIGN
P$NODE.SUBNODES
     16667**DCL     18189>>DOINDEX 19640>>IF
PACKSET_NAME
     16057**DCL     18980<<ASSIGN  18983<<ASSIGN  19010>>ASSIGN
PATTR
     16058**DCL     18098<<ASSIGN  18160<<ASSIGN  18299<<ASSIGN  19877<<ASSIGN  19892>>ASSIGN
PRO$
     16059**DCL     17172--IMP-PTR 18224<<ASSIGN  18228>>CALL    18253>>IF      18276>>IF      18276>>IF
     18276>>IF      18299>>ASSIGN  18300>>ASSIGN  18301>>ASSIGN  19830<<ASSIGN  19834>>CALL    19858>>IF
     19877>>ASSIGN  19878>>ASSIGN  19879>>ASSIGN
PROJ_KEY.TEXT
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:324  
      9916**DCL      9916--REDEF
PROJ_KEY.TXT.PROJECT
      9916**DCL      9916--REDEF
PRO_BUF
     16060**DCL     18224--ASSIGN  18225--ASSIGN  19830--ASSIGN  19831--ASSIGN
PRO_FLAG
     16061**DCL     18091<<ASSIGN  18143<<ASSIGN  18150<<ASSIGN  18303<<ASSIGN  19756>>IF
PTR$
     16062**DCL     18190<<ASSIGN  18191>>ASSIGN  18196>>IF      18201>>ASSIGN  18345>>ASSIGN  18353>>ASSIGN
     18377>>ASSIGN  18403<<ASSIGN  18405>>DOWHILE 18420>>ASSIGN  18610>>ASSIGN  18748>>ASSIGN  18778>>IF
     18781>>ASSIGN  18828>>ASSIGN  18871>>IF      18877>>ASSIGN  18930>>ASSIGN  18956>>ASSIGN  18981>>ASSIGN
     19036>>ASSIGN  19083>>ASSIGN  19125>>ASSIGN  19141>>ASSIGN  19193>>ASSIGN  19208>>IF      19218>>IF
     19225>>ASSIGN  19253>>IF      19258>>ASSIGN  19306>>IF      19334>>ASSIGN  19415>>DOSELCT 19474<>CALL
     19502<>CALL    19527<>CALL    19557>>ASSIGN  19584>>ASSIGN  19611>>ASSIGN  19638<<ASSIGN  19638>>ASSIGN
     19639>>ASSIGN  19640>>IF      19643>>ASSIGN
P_PCB
     10071**DCL     18182<>CALL
P_PCB.ERROR
     10175**DCL     18184<>CALL
P_PCB.NCHARS
     10218**DCL     18181<<ASSIGN
P_PCB.OUT$
     10084**DCL     18188>>ASSIGN
P_PCB.ROOT$
     10076**DCL     18078>>ASSIGN  18167<<ASSIGN  19885<<ASSIGN
P_PCB.WKSZ
     10101**DCL     18076>>ASSIGN  18081<<ASSIGN  19883<<ASSIGN
P_PCB.WK_USED
     10204**DCL     18077>>ASSIGN  18080>>ASSIGN  18081>>ASSIGN  19884<<ASSIGN
P_PCB.WORK$
     10080**DCL     18075>>ASSIGN  18080<<ASSIGN  19882<<ASSIGN
REMEM_VAR
     10042**DCL     10042--REDEF   18175<<REMEMBR
REM_FCMD
     10042**DCL     10043--REDEF
RES$DEV.PASSWORD
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:325  
     17960**DCL     17964--REDEF
RES$DEV.RENAME
     17983**DCL     17984--REDEF   19922>>IF
RES$DEV.RES_DEV
     18020**DCL     18141>>ASSIGN  19923--ASSIGN  19924<<ASSIGN
RES_AREA
     16597**DCL     16588--DCLINIT
ROOT$
     16064**DCL     18078<<ASSIGN  19885>>ASSIGN
SNAME_FLG
     16065**DCL     18093<<ASSIGN  18124<<ASSIGN  18435<<ASSIGN  18459<<ASSIGN  18482<<ASSIGN  18522<<ASSIGN
     18570<<ASSIGN  18905<<ASSIGN  19940>>IF
SNVLP
     16566**DCL     16587--DCLINIT
SNVLP.SN#
     16566**DCL     19096>>ASSIGN
SPLIT
     16066**DCL     19530>>ASSIGN
SPLIT.B
     16070**DCL     19529<<ASSIGN
SPLIT.T
     16068**DCL     19528<<ASSIGN
SS
     16006**DCL        28--PROC
SS.SGN
     16011**DCL     16020--REDEF
SS.SGN.NUM
     16013**DCL     19909<<ASSIGN
SS.SGN.PNAME
     16019**DCL     19907<<ASSIGN
SS.SGN.TWSN
     16014**DCL     19910<<ASSIGN
SS.SGN.TYPE
     16012**DCL     19908<<ASSIGN
SUB
     15984**DCL        28--PROC    18109>>IF      18143>>IF      18150>>IF      18163>>IF      18169>>IF
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:326  
     18253>>IF      18276>>IF      18323>>IF      18527>>IF      18575>>IF      18690>>IF      18741>>IF
     19396>>IF      19481>>IF      19506>>IF      19756>>IF      19829>>IF      19889>>IF      19897>>IF
     19906>>IF      19945>>IF
TEMP
     16071**DCL     18411<<ASSIGN  18413>>ASSIGN
TEMP$
     16072**DCL     18404<<ASSIGN  18413>>ASSIGN  18414<<ASSIGN  18414>>ASSIGN
TEMP_TYPE
     16073**DCL     18611<<ASSIGN  18634>>CALLBLT 18643>>ASSIGN  18663>>IF      18687>>ASSIGN
TERM_T
     15985**DCL        28--PROC    18696>>IF      18709>>IF      18718>>IF      18728>>IF      18742>>CALLBLT
TP$DEV.PASSWORD
     17609**DCL     17613--REDEF
TP$DEV.QQ_LOGON
     17693**DCL     18148>>ASSIGN  19931<<ASSIGN
TP$DEV.RENAME
     17632**DCL     17633--REDEF
TP_DEV.DEV_TYPE
     18065**DCL     18109>>IF      18122>>IF
TP_DEV.SNAME
     18066**DCL     18126>>ASSIGN
TP_FLAG
     16074**DCL     18088<<ASSIGN  18117<<ASSIGN  18146<<ASSIGN  18426>>IF      18428<<ASSIGN  18450>>IF
     18452<<ASSIGN  18473>>IF      18475<<ASSIGN  18526<<ASSIGN  18566>>IF      18568<<ASSIGN  18806>>IF
     18957>>IF      19781>>IF
TREC$
     15980**DCL        28--PROC    16748--IMP-PTR 17216--IMP-PTR 17389--IMP-PTR 17551--IMP-PTR 17729--IMP-PTR
     17902--IMP-PTR 18096>>ASSIGN  18100>>ASSIGN  18101>>ASSIGN  18102>>CALL    18103>>ASSIGN  18104>>ASSIGN
     18105>>ASSIGN  18106>>ASSIGN  18107>>ASSIGN  18108>>ASSIGN  18112>>ASSIGN  18113>>ASSIGN  18114>>ASSIGN
     18118>>ASSIGN  18119>>ASSIGN  18120>>ASSIGN  18125>>ASSIGN  18126>>ASSIGN  18131>>ASSIGN  18132>>DOSELCT
     18137>>ASSIGN  18137>>ASSIGN  18140>>IF      18141>>ASSIGN  18141>>ASSIGN  18148>>ASSIGN  18148>>ASSIGN
     18155>>ASSIGN  18155>>ASSIGN  18197>>ASSIGN  18198>>ASSIGN  18302>>ASSIGN  18349>>ASSIGN  18350>>CALL
     18373>>ASSIGN  18374>>CALL    18404>>ASSIGN  18425>>ASSIGN  18427>>ASSIGN  18437>>ASSIGN  18438>>ASSIGN
     18439>>ASSIGN  18440>>ASSIGN  18441>>ASSIGN  18442>>ASSIGN  18443>>ASSIGN  18444>>ASSIGN  18445>>ASSIGN
     18448>>ASSIGN  18451>>ASSIGN  18461>>ASSIGN  18462>>ASSIGN  18463>>ASSIGN  18464>>ASSIGN  18465>>IF
     18466>>ASSIGN  18468>>ASSIGN  18469>>ASSIGN  18474>>ASSIGN  18485>>ASSIGN  18486>>ASSIGN  18488>>ASSIGN
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:327  
     18489>>ASSIGN  18494>>IF      18516>>ASSIGN  18517>>ASSIGN  18518>>ASSIGN  18529>>CALLBLT 18529>>CALLBLT
     18530>>ASSIGN  18533>>ASSIGN  18534>>ASSIGN  18535>>ASSIGN  18541>>IF      18563>>ASSIGN  18564>>ASSIGN
     18565>>ASSIGN  18567>>ASSIGN  18577>>CALLBLT 18577>>CALLBLT 18578>>ASSIGN  18581>>ASSIGN  18582>>ASSIGN
     18663>>IF      18689>>CALLBLT 18689>>CALLBLT 18692>>ASSIGN  18741>>IF      18742>>CALLBLT 18743>>ASSIGN
     18773>>ASSIGN  18779>>ASSIGN  18801>>ASSIGN  18831>>ASSIGN  18832>>ASSIGN  18833>>ASSIGN  18835>>ASSIGN
     18836>>ASSIGN  18837>>ASSIGN  18839>>ASSIGN  18840>>ASSIGN  18841>>ASSIGN  18843>>ASSIGN  18844>>ASSIGN
     18845>>ASSIGN  18872>>ASSIGN  18873>>ASSIGN  18876>>ASSIGN  18904>>ASSIGN  18953>>ASSIGN  19006>>ASSIGN
     19007>>ASSIGN  19008>>ASSIGN  19010>>ASSIGN  19071>>ASSIGN  19072>>ASSIGN  19077>>ASSIGN  19078>>ASSIGN
     19088>>ASSIGN  19089>>ASSIGN  19091>>ASSIGN  19093>>ASSIGN  19095>>ASSIGN  19096>>ASSIGN  19130>>ASSIGN
     19132>>ASSIGN  19134>>ASSIGN  19136>>ASSIGN  19167>>ASSIGN  19196>>ASSIGN  19197>>ASSIGN  19199>>ASSIGN
     19200>>ASSIGN  19202>>ASSIGN  19203>>ASSIGN  19209>>ASSIGN  19211>>ASSIGN  19212>>ASSIGN  19213>>ASSIGN
     19219>>ASSIGN  19221>>ASSIGN  19248>>ASSIGN  19254>>ASSIGN  19255>>ASSIGN  19281>>ASSIGN  19282>>ASSIGN
     19307>>ASSIGN  19309>>ASSIGN  19358>>ASSIGN  19360>>ASSIGN  19558>>ASSIGN  19585>>ASSIGN  19612>>ASSIGN
     19653>>ASSIGN  19657>>ASSIGN  19661>>ASSIGN  19665>>ASSIGN  19669>>ASSIGN  19673>>ASSIGN  19677>>ASSIGN
     19681>>ASSIGN  19685>>ASSIGN  19689>>ASSIGN  19693>>ASSIGN  19697>>ASSIGN  19701>>ASSIGN  19705>>ASSIGN
     19709>>ASSIGN  19713>>ASSIGN  19717>>ASSIGN  19721>>ASSIGN  19729>>ASSIGN  19829>>IF      19832>>ASSIGN
     19833>>ASSIGN  19899>>IF      19900>>ASSIGN  19907>>ASSIGN  19912>>ASSIGN  19915>>ASSIGN  19915>>ASSIGN
     19918>>ASSIGN  19918>>ASSIGN  19919>>ASSIGN  19919>>ASSIGN  19922>>IF      19923>>ASSIGN  19924>>ASSIGN
     19924>>ASSIGN  19927>>ASSIGN  19930>>ASSIGN  19930>>ASSIGN  19931>>ASSIGN  19931>>ASSIGN  19934>>ASSIGN
     19934>>ASSIGN  19935>>ASSIGN  19935>>ASSIGN  19941>>CALLBLT 19942>>CALLBLT
TWSNC
     15982**DCL        28--PROC    18106>>ASSIGN  18131<<ASSIGN  19910>>ASSIGN
TWSNR$
     15981**DCL        28--PROC    17134--IMP-PTR 18107>>ASSIGN  18108>>ASSIGN  18158>>ASSIGN  18159>>ASSIGN
     18160>>ASSIGN  18161>>ASSIGN  18162>>ASSIGN  18163>>ASSIGN  18166>>ASSIGN  18528<>CALL    18576<>CALL
     18688<>CALL    19729>>ASSIGN  19890>>ASSIGN  19891>>ASSIGN  19892>>ASSIGN  19893>>ASSIGN  19894>>ASSIGN
     19895>>ASSIGN  19896>>ASSIGN  19898>>ASSIGN  19900>>ASSIGN  19902>>ASSIGN  19903>>ASSIGN
TWSN_INDEX
     15986**DCL        28--PROC    18158>>ASSIGN  18159>>ASSIGN  18160>>ASSIGN  18161>>ASSIGN  18162>>ASSIGN
     18163>>ASSIGN  18166>>ASSIGN  19729>>ASSIGN  19890>>ASSIGN  19891>>ASSIGN  19892>>ASSIGN  19893>>ASSIGN
     19894>>ASSIGN  19895>>ASSIGN  19896>>ASSIGN  19898>>ASSIGN  19900>>ASSIGN  19902>>ASSIGN  19903>>ASSIGN
TYPE
     16093**DCL     18087<<ASSIGN  18116<<ASSIGN  18144<<ASSIGN  18151<<ASSIGN  18157>>IF      18158<<ASSIGN
     18424>>IF      18424<<ASSIGN  18449>>IF      18449<<ASSIGN  18472>>IF      18472<<ASSIGN  18493>>IF
     18525<<ASSIGN  18528<>CALL    18529>>CALLBLT 18540>>IF      18573<<ASSIGN  18576<>CALL    18577>>CALLBLT
     18687<<ASSIGN  18688<>CALL    18689>>CALLBLT 18697>>IF      18699>>IF      18701>>IF      18703>>IF
PL6.E3A0      #002=ASA$DEV_OPTS File=ASA$DEVICE.:E05TSI                          TUE 07/29/97 08:35 Page:328  
     18705>>IF      18710>>IF      18712>>IF      18714>>IF      18714>>IF      18719>>IF      18721>>IF
     18723>>IF      18723>>IF      18729>>IF      18729>>IF      18733>>IF      18733>>IF      18742>>CALLBLT
     18849>>IF      19013>>IF      19170>>IF      19534>>IF      19561>>IF      19588>>IF      19615>>IF
     19731>>IF      19756>>IF      19889>>IF      19890>>ASSIGN  19908>>ASSIGN  19946>>CALLBLT
T_NODE$
     16075**DCL     18083<<ASSIGN  19887>>ASSIGN
USERS_KEY
      9913**DCL     18228<>CALL    18302>>ASSIGN  19365<>CALL    19834<>CALL
USERS_KEY.COUNT
      9913**DCL     18226<<ASSIGN  19362<<ASSIGN  19832<<ASSIGN
USERS_KEY.TEXT
      9913**DCL      9914--REDEF    9914--REDEF    9914--REDEF    9915--REDEF
USERS_KEY.TXTC
      9914**DCL     18227<<ASSIGN  18231>>CALLBLT 18233>>ASSIGN  19363<<ASSIGN  19372>>CALLBLT 19374>>ASSIGN
     19833<<ASSIGN
WKSZ
     16076**DCL     18076<<ASSIGN  18081>>ASSIGN  19883>>ASSIGN
WK_USED
     16077**DCL     18077<<ASSIGN  19884>>ASSIGN
WORK$
     16078**DCL     18075<<ASSIGN  18080>>ASSIGN  19882>>ASSIGN
X$PARSE
     16606**DCL-ENT 18182--CALL
YES_NO_FLG
     16079**DCL     19641<<ASSIGN  19645<<ASSIGN  19647<<ASSIGN  19653>>ASSIGN  19657>>ASSIGN  19661>>ASSIGN
     19665>>ASSIGN  19669>>ASSIGN  19673>>ASSIGN  19677>>ASSIGN  19681>>ASSIGN  19685>>ASSIGN  19689>>ASSIGN
     19693>>ASSIGN  19697>>ASSIGN  19701>>ASSIGN  19705>>ASSIGN  19709>>ASSIGN  19713>>ASSIGN  19717>>ASSIGN
     19721>>ASSIGN
ZERO_ACCNT
     16600**DCL     19358>>ASSIGN
Z_ACCT
     16599**DCL     16600--REDEF
